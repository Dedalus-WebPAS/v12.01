.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.01.00"
.-------------------------------------------------------
. V9.04.01  19.04.2005 Peter Vela CAR 59696
.           Recompiled for SINTMPDF
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
KEY4A     DIM       4
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN11
.   Function      :   Period Date Range Maintenance           
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       SINCONFD/INC
          INC       SINPERFD/INC
          INC       SINTMPDF/INC
.=========================
.Local Variable Definition
.-------------------------
FINYEAR   DIM       4 * Scr 00 Fld     1
FD01      DIM       8 * Scr 00 Fld    14
FD02      DIM       8 * Scr 00 Fld    15
FD03      DIM       8 * Scr 00 Fld    16
FD04      DIM       8 * Scr 00 Fld    17
FD05      DIM       8 * Scr 00 Fld    18
FD06      DIM       8 * Scr 00 Fld    19
FD07      DIM       8 * Scr 00 Fld    20
FD08      DIM       8 * Scr 00 Fld    21
FD09      DIM       8 * Scr 00 Fld    22
FD10      DIM       8 * Scr 00 Fld    23
FD11      DIM       8 * Scr 00 Fld    24
FD12      DIM       8 * Scr 00 Fld    25
TD01      DIM       8 * Scr 00 Fld    26
TD02      DIM       8 * Scr 00 Fld    27
TD03      DIM       8 * Scr 00 Fld    28
TD04      DIM       8 * Scr 00 Fld    29
TD05      DIM       8 * Scr 00 Fld    30
TD06      DIM       8 * Scr 00 Fld    31
TD07      DIM       8 * Scr 00 Fld    32
TD08      DIM       8 * Scr 00 Fld    33
TD09      DIM       8 * Scr 00 Fld    34
TD10      DIM       8 * Scr 00 Fld    35
TD11      DIM       8 * Scr 00 Fld    36
TD12      DIM       8 * Scr 00 Fld    37
LP01      FORM      1 * Scr 00 Fld    38
LP02      FORM      1 * Scr 00 Fld    39
LP03      FORM      1 * Scr 00 Fld    40
LP04      FORM      1 * Scr 00 Fld    41
LP05      FORM      1 * Scr 00 Fld    42
LP06      FORM      1 * Scr 00 Fld    43
LP07      FORM      1 * Scr 00 Fld    44
LP08      FORM      1 * Scr 00 Fld    45
LP09      FORM      1 * Scr 00 Fld    46
LP10      FORM      1 * Scr 00 Fld    47
LP11      FORM      1 * Scr 00 Fld    48
LP12      FORM      1 * Scr 00 Fld    49
FD13      DIM       8 * Scr 00 Fld    54
TD13      DIM       8 * Scr 00 Fld    55
LP13      FORM      1 * Scr 00 Fld    56
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN11"
PRGNAM    INIT      "Period Date Range Maintenance           "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA1,"sinperaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA2,"sinperaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Period Maintenance                 
          ENDIF
          RETURN
.--------------------------------
. Screen - Period Maintenance                 
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   50",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      RINPECON
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Period Maintenance                 
.-------------------------------------------------------
CF00L000
          MOVE      SP70,FINYEAR 
          MOVE      SP70,HAPER1  
          MOVE      SP70,HAPER2  
          MOVE      SP70,HAPER3  
          MOVE      SP70,HAPER4  
          MOVE      SP70,HAPER5  
          MOVE      SP70,HAPER6  
          MOVE      SP70,HAPER7  
          MOVE      SP70,HAPER8  
          MOVE      SP70,HAPER9  
          MOVE      SP70,HAPER10 
          MOVE      SP70,HAPER11 
          MOVE      SP70,HAPER12 
          MOVE      SP70,FD01    
          MOVE      SP70,FD02    
          MOVE      SP70,FD03    
          MOVE      SP70,FD04    
          MOVE      SP70,FD05    
          MOVE      SP70,FD06    
          MOVE      SP70,FD07    
          MOVE      SP70,FD08    
          MOVE      SP70,FD09    
          MOVE      SP70,FD10    
          MOVE      SP70,FD11    
          MOVE      SP70,FD12    
          MOVE      SP70,TD01    
          MOVE      SP70,TD02    
          MOVE      SP70,TD03    
          MOVE      SP70,TD04    
          MOVE      SP70,TD05    
          MOVE      SP70,TD06    
          MOVE      SP70,TD07    
          MOVE      SP70,TD08    
          MOVE      SP70,TD09    
          MOVE      SP70,TD10    
          MOVE      SP70,TD11    
          MOVE      SP70,TD12    
          MOVE      ZERO,LP01    
          MOVE      ZERO,LP02    
          MOVE      ZERO,LP03    
          MOVE      ZERO,LP04    
          MOVE      ZERO,LP05    
          MOVE      ZERO,LP06    
          MOVE      ZERO,LP07    
          MOVE      ZERO,LP08    
          MOVE      ZERO,LP09    
          MOVE      ZERO,LP10    
          MOVE      ZERO,LP11    
          MOVE      ZERO,LP12    
          MOVE      SP70,HAPER13 
          MOVE      SP70,FD13    
          MOVE      SP70,TD13    
          MOVE      ZERO,LP13    
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Period Maintenance                 
.--------------------------------------------------------
KY00L000
.
KY00L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EYEAR000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      FINYEAR,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Period Maintenance                 
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Period Maintenance                 
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Period Maintenance                 
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Period Maintenance                 
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L104,PS00L105,PS00L106,PS00L107:
                            PS00L108,PS00L109,PS00L110,PS00L111:
                            PS00L112,PS00L113,PS00L114,PS00L115:
                            PS00L116,PS00L117,PS00L118,PS00L119:
                            PS00L120,PS00L121,PS00L122,PS00L123:
                            PS00L124,PS00L125,PS00L126,PS00L127:
                            PS00L128,PS00L129,PS00L130,PS00L131:
                            PS00L132,PS00L133,PS00L134,PS00L135:
                            PS00L136,PS00L137,PS00L138,PS00L139:
                            PS00L140,PS00L141,PS00L142,PS00L143:
                            PS00L144,PS00L145,PS00L146,PS00L147:
                            PS00L148,PS00L999,PS00L999,PS00L999:
                            PS00L149,PS00L150,PS00L151,PS00L152:
                            PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      HAPER1,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      HAPER2,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      HAPER3,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      HAPER4,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      HAPER5,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      HAPER6,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      HAPER7,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      HAPER8,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      HAPER9,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      HAPER10,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      HAPER11,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      HAPER12,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          UNPACK    FD01,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          UNPACK    FD02,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          UNPACK    FD03,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          UNPACK    FD04,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          UNPACK    FD05,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          UNPACK    FD06,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          UNPACK    FD07,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          UNPACK    FD08,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          UNPACK    FD09,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          UNPACK    FD10,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          UNPACK    FD11,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          UNPACK    FD12,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          UNPACK    TD01,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          UNPACK    TD02,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          UNPACK    TD03,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          UNPACK    TD04,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L129
          UNPACK    TD05,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L130
          UNPACK    TD06,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L131
          UNPACK    TD07,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L132
          UNPACK    TD08,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L133
          UNPACK    TD09,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L134
          UNPACK    TD10,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L135
          UNPACK    TD11,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L136
          UNPACK    TD12,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L137
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LP01,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L138
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LP02,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L139
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LP03,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L140
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LP04,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L141
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LP05,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LP06,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LP07,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L144
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LP08,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L145
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LP09,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L146
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LP10,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L147
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LP11,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L148
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LP12,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L149
          MOVE      HAPER13,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L150
          UNPACK    FD13,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L151
          UNPACK    TD13,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L152
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      LP13,FORM2       
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Period Maintenance                 
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L107:
                            SF00L108,SF00L109,SF00L110,SF00L111:
                            SF00L112,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L113,SF00L114:
                            SF00L006,SF00L115,SF00L006,SF00L006:
                            SF00L116
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L107:
                            SF00L108,SF00L109,SF00L110,SF00L111:
                            SF00L112,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L115,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPER0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L101
            ENDIF
            BRANCH    EXIT,SF00L101,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          UNPACK    FD01,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L102
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPER0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L102
            ENDIF
            BRANCH    EXIT,SF00L102,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          UNPACK    FD02,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPER0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L103
            ENDIF
            BRANCH    EXIT,SF00L103,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          UNPACK    FD03,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPER0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
            BRANCH    EXIT,SF00L104,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          UNPACK    FD04,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPER0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L105
            ENDIF
            BRANCH    EXIT,SF00L105,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          UNPACK    FD05,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPER0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L106
            ENDIF
            BRANCH    EXIT,SF00L106,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          UNPACK    FD06,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPER0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
            BRANCH    EXIT,SF00L107,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          UNPACK    FD07,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPER0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L108
            ENDIF
            BRANCH    EXIT,SF00L108,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          UNPACK    FD08,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L109
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPER0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L109
            ENDIF
            BRANCH    EXIT,SF00L109,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          UNPACK    FD09,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L110
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPER0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L110
            ENDIF
            BRANCH    EXIT,SF00L110,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          UNPACK    FD10,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L111
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPER0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L111
            ENDIF
            BRANCH    EXIT,SF00L111,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          UNPACK    FD11,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L112
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPER0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L112
            ENDIF
            BRANCH    EXIT,SF00L112,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          UNPACK    FD12,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L113
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L114
          CALL      POST0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L115
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPER0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L115
            ENDIF
            BRANCH    EXIT,SF00L115,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          UNPACK    FD13,CCENT,CYEAR,CMON,CDAY              
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L116
          CALL      COPY0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.@@@@@ Function Restart Point @@@@@
EYEAR000  MOVE      SIPECYR,FINYEAR
          KEYIN     *PCCOL:CVERT,*V2LON,*JR,FINYEAR
          ENDSET    FINYEAR
          APPEND    SP70,FINYEAR
          RESET     FINYEAR
.
          MATCH     SP70,FINYEAR
          GOTO      EYEAR990 IF EQUAL
          PACK      KEY4,SP3,EXITCHAR
          MATCH     KEY4,FINYEAR
          GOTO      EYEAR990 IF EQUAL
.
          TYPE      FINYEAR
          GOTO      EYEAR050 IF EQUAL
.
          BEEP
          MOVE      "Invalid Financial Year - ",DISPMSG
          CALL      MESSAGE1
          GOTO      EYEAR000
.
EYEAR050  MOVE      FINYEAR,SIPEYF4
          IF        SIPEYF4<100
            SQUEEZE   FINYEAR
            MOVE      FINYEAR,F2
            PACK      FINYEAR,CCC,F2,SP70
            REP       " 0",FINYEAR
          ENDIF
.
          MOVE      "    1",FLDID
          MOVE      FINYEAR,VAR
          CALL      DISPITEM
.
          PACK      KEY6,FINYEAR,ZERO,ONE
          CALL      RDSIPE1
          IF        OVRCD=1
            MOVE      SP70,DISPMSG
            CALL      MESSAGE2
            KEYIN     *P1:24,*EL,*B,"Financial Year Does NOT Exist. ":
                      "Do You Want to Create it (",*V2LON,"Y",*HOFF,"/":
                      *V2LON,"N",*HOFF,") ? ",*V2LON,ANS
            CALL      MESSAGE3
            REP       UPPLOW,ANS
            MATCH     "Y",ANS
            GOTO      EYEAR000 IF NOT EQUAL
          ENDIF
.
          MOVE      Z70,KEY6                 * get last year on file
          CALL      RSSIPE1
          CALL      RPSIPE1
          IF        OVRCD=1
            MOVE      ZERO,OPTIONR
          ELSE
            MOVE      SIPEYEAR,OPTIONR
            MOVE      FINYEAR,F4
            ASSIGN    F4-OPTIONR,SECTOR     * Offset
          ENDIF
.
          MOVE      ONE,ACCEPT
          MOVE      ZERO,F2
.
EYEAR100  ADD       ONE,F2
          IF        F2>SIPENUM
            GOTO      EYEAR900
          ENDIF
          PACK      KEY6,FINYEAR,F2
          REP       " 0",KEY6
          CALL      RDSIPE1
          IF        OVRCD=0
            MOVE      ZERO,ACCEPT
          ELSE
            PACK      KEY6,OPTIONR,F2,SP70
            REP       " 0",KEY6
            CALL      RDSIPE1
            IF        OVRCD=0
               UNPACK    SIPESDT,CCENT,CYEAR,CMON,CDAY
               PACK      KEY4,CCENT,CYEAR
               MOVE      KEY4,SIPEYF4
               ADD       SECTOR,SIPEYF4
               PACK      SIPESDT,SIPEYF4,CMON,CDAY
.
               UNPACK    SIPEEDT,CCENT,CYEAR,CMON,CDAY
               PACK      KEY4,CCENT,CYEAR
               MOVE      KEY4,SIPEYF4
               ADD       SECTOR,SIPEYF4
               PACK      SIPEEDT,SIPEYF4,CMON,CDAY
            ELSE
              PACK      SIPESDT,CCC,CYY,CMM,SP1,ONE
              PACK      SIPEEDT,CCC,CYY,CMM,CDD
            ENDIF
            REP       " 0",SIPESDT
            REP       " 0",SIPEEDT
            MOVE      ZERO,SIPELOC
          ENDIF
.
          STORE     SIPESDT,F2,FD01,FD02,FD03,FD04:
                               FD05,FD06,FD07,FD08:
                               FD09,FD10,FD11,FD12,FD13
          STORE     SIPEEDT,F2,TD01,TD02,TD03,TD04:
                               TD05,TD06,TD07,TD08:
                               TD09,TD10,TD11,TD12,TD13
          STORE     SIPELOC,F2,LP01,LP02,LP03,LP04:
                               LP05,LP06,LP07,LP08:
                               LP09,LP10,LP11,LP12,LP13
          GOTO      EYEAR100
.
EYEAR900  MOVE      ACCEPT,OVRCD
          IF        ACCEPT=1
            MOVE      ZERO,ACCEPT
            CALL      DF00L000
            MOVE      "    1",FLDID
            CALL      GETPOSIT
            MOVE      ONE,ACCEPT
          ENDIF
          GOTO      EYEAR999
EYEAR990  MOVE      TWO,EXIT
EYEAR999  RETURN
KPER0000
          MOVE      SCSLITM,SECTOR
          MOVE      SECTOR,F2
          IF        SECTOR=54
            MOVE      "13",F2
          ELSE
            SUB       "13",F2
          ENDIF
          LOAD      SIPESDT,F2,FD01,FD02,FD03,FD04:
                               FD05,FD06,FD07,FD08:
                               FD09,FD10,FD11,FD12,FD13
          LOAD      SIPEEDT,F2,TD01,TD02,TD03,TD04:
                               TD05,TD06,TD07,TD08:
                               TD09,TD10,TD11,TD12,TD13
          LOAD      SIPELOC,F2,LP01,LP02,LP03,LP04:
                               LP05,LP06,LP07,LP08:
                               LP09,LP10,LP11,LP12,LP13
.
          UNPACK    SIPESDT,CCENT,CYEAR,CMON,CDAY
          CALL      KEYDATE
          PACK      SIPESDT,CCENT,CYEAR,CMON,CDAY
          REP       " 0",SIPESDT
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
.
          MOVE      SCSLITM,SECTOR
          IF        SECTOR=54
            MOVE      "55",SECTOR
          ELSE
            ADD       "12",SECTOR
          ENDIF
          MOVE      SECTOR,FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            PACK      KEY8,CCC,CYY,CMM,CDD
            REP       " 0",KEY8
            REP       " 0",SIPEEDT
            MATCH     SIPEEDT,KEY8
            IF        @EQUAL
              UNPACK    SIPESDT,CCENT,CYEAR,CMON,CDAY
            ELSE
              UNPACK    SIPEEDT,CCENT,CYEAR,CMON,CDAY
            ENDIF
.
            CALL      KEYDATE
            PACK      SIPEEDT,CCENT,CYEAR,CMON,CDAY
            REP       " 0",SIPEEDT
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      SCSLITM,SECTOR
          IF        SECTOR=54
            MOVE      "56",SECTOR
          ELSE
            ADD       "24",SECTOR
          ENDIF
          MOVE      SECTOR,FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ANSY,DEFYESNO
            CALL      YORN0000
            MOVE      FYESNO,SIPELOC
            MOVE      NO,YESNO
            MOVE      SIPELOC,FORM2
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      SCSLITM,SECTOR
          MOVE      SECTOR,FLDID
          CALL      GETPOSIT
.
          MOVE      SCSLITM,SECTOR
          MOVE      SECTOR,F2
          IF        SECTOR=54
            MOVE      "13",F2
          ELSE
            SUB       "13",F2
          ENDIF
.
          STORE     SIPESDT,F2,FD01,FD02,FD03,FD04:
                               FD05,FD06,FD07,FD08:
                               FD09,FD10,FD11,FD12,FD13
          STORE     SIPEEDT,F2,TD01,TD02,TD03,TD04:
                               TD05,TD06,TD07,TD08:
                               TD09,TD10,TD11,TD12,TD13
          STORE     SIPELOC,F2,LP01,LP02,LP03,LP04:
                               LP05,LP06,LP07,LP08:
                               LP09,LP10,LP11,LP12,LP13
.
KPER9999  RETURN
POST0000  MOVE      ZERO,F2
.
POSTL100  ADD       ONE,F2
          IF        F2>SIPENUM
            GOTO      POSTL900
          ENDIF
          MOVE      FINYEAR,SIPEYEAR
          MOVE      F2,SIPEPER
          REP       " 0",SIPEPER
          REP       " 0",SIPEYEAR
          LOAD      SIPESDT,F2,FD01,FD02,FD03,FD04,FD05,FD06,FD07,FD08:
                               FD09,FD10,FD11,FD12,FD13
          LOAD      SIPEEDT,F2,TD01,TD02,TD03,TD04,TD05,TD06,TD07,TD08:
                               TD09,TD10,TD11,TD12,TD13
          LOAD      SIPELOC,F2,LP01,LP02,LP03,LP04,LP05,LP06,LP07,LP08:
                               LP09,LP10,LP11,LP12,LP13
          PACK      KEY6,SIPEYEAR,SIPEPER
          CALL      RASIPE1
          IF        OVRCD=0
            CALL      UPSIPE1
          ELSE
            CALL      WRSIPE1
          ENDIF
          GOTO      POSTL100
.
POSTL900  RETURN
COPY0000  KEYIN     *P1:24,*EL,"Copy from Year : ",*JR,*ZF,*DE,KEY4
.
          MOVE      FINYEAR,F4
          MOVE      F4,SECTOR
          MOVE      KEY4,F4
          SUB       F4,SECTOR  * Offset
.
          PACK      KEY6,KEY4,SP70
          CALL      RSSIPE1
COPY1000
          CALL      RKSIPE1
          BRANCH    OVRCD,COPY9999
          MATCH     SIPEYEAR,KEY4
          GOTO      COPY9999 IF NOT EQUAL
.
          UNPACK    SIPESDT,CCENT,CYEAR,CMON,CDAY
          PACK      KEY4A,CCENT,CYEAR
          MOVE      KEY4A,SIPEYF4
          ADD       SECTOR,SIPEYF4
          PACK      SIPESDT,SIPEYF4,CMON,CDAY
.
          UNPACK    SIPEEDT,CCENT,CYEAR,CMON,CDAY
          PACK      KEY4A,CCENT,CYEAR
          MOVE      KEY4A,SIPEYF4
          ADD       SECTOR,SIPEYF4
          PACK      SIPEEDT,SIPEYF4,CMON,CDAY
.
          MOVE      FINYEAR,SIPEYEAR
          PACK      KEY6,SIPEYEAR,SIPEPER
          CALL      RASIPE1
          IF        OVRCD=0
            CALL      UPSIPE1
          ELSE
            CALL      WRSIPE1
          ENDIF
          PACK      KEY6,KEY4,SIPEPER
          CALL      RDSIPE1
          GOTO      COPY1000
.
COPY9999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       SINPERCD    
          INC       SINPERIO/INC
.
          INC       STDGENCD
.
