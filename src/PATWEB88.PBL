.-------------------------------------------------------------------------
. Program       : PATWEB88
.
. Function      : General Table Maintenance
.
. Modifications : 
.
.-------------------------------------------------------------------------
.V11.05.02 27/03/2025  Davin           TSK 0956210
.          Added DRG Version 12 in PDRG0900 
.V11.05.01 17/03/2025  Davin           TSK 0956210
.          Added options 42,43 : ICD10 Ed.13 routines and variables
.          PTDK13PR,PTOK13PR,PATIX3TM,ICDX3P00,ICDX3D00,PTICD035,PTICO034
.          Added PTICD036 for Cluster Allocation Required
.V11.04.01 26/02/2024  Thanh T         TSK 0923560
.          Changed SURFAV00 for hospital ID changes 
.V11.03.04 20.06.2023  DA Sarkies      TSK 0927738
.          Moved the counter for the hospital list into the fhir check.
.          Changed JSON printout to include phone and fax into single telecom
.V11.03.03 17/05/2023  Nikitha B       TSK 0932643
.          Added new label HSPD6800 for FLDITNO 68.
.V11.03.02 17/01/2023  Thanh T.        TSK 0924686
.          Recompiled for PATO12FD/PATO12IO change           
.V11.03.01 19/12/2022  Bella Turco     TSK 0921957
.          Recompiled for PATPRDTM
.V11.02.08 13/09/2022  Ebon Clements   TSK 0924038
.          Added unplanned return to theatre to ICD10 ED.12 operations
.          PTICO033 and PT0OURTH stored in the spare PTOSPR12
.V11.02.07 23/08/2022  Bella Turco     TSK 0906597
.          Read PTCNUABF from CONTROLF & added PMCID007
.V11.02.06 13/07/2022  Bella Turco     TSK 0921957
.          Added NOMORE00 - Display "No more records" at end of list
.          Added PTCNNRTD - Displays number of rows set by parameter value
.V11.02.05 27/04/2022  Ebon Clements   TSK 0906597
.          Added clear of contract close off date - CLPCTR00
.V11.02.04 21/04/2022  Davin           TSK 0917793 (0882260)
.          Added DRG Version 11 in PDRG0900 
.V11.02.03 05/04/2022  Davin           TSK 0917793
.          Added tags for options 40,41 (profld00)
.V11.02.02 29/03/2022  Davin           TSK 0917793
.          Added options 40,41 : ICD10 Ed.12 routines and variables
.          PTDK12PR,PTOK12PR,PATIX2TM,ICDX2P00,ICDX2D00,PTICD034,PTICO032
.V11.02.01 02/02/2022  Alina Bhari     TSK 0903886
.          Recompiled for PATIKIPR- Made users able to be search
.                                   by long description.
.V11.01.01 04/03/2021  J.Tan           TSK 0863287
.          Added PMCIPINV to pmscidaf file
.V11.00.05 25/05/2020  Sunny           TSK 0887740
.          Added ICOC6100 for ICD 10 Ed.11 Procedure maintenance 
.          mapping list
.V11.00.04 09/04/2020  J.Tan          TSK 0838262
.          Fixed displaying Inactive MBS items
.V11.00.03 25/03/2020  J.Tan          TSK 0838262
.          Removed New MBS item file
.V11.00.02 13/03/2020  J.Tan          TSK 0838262
.          Validate MBS effective date
.V11.00.01 24/02/2020  J.Tan          TSK 0838262
.          Added Effective from and to date to MBS Item file
.V10.15.01 23/01/2020  Thanh T         TSK 0871644
.          Added MAIN1390 for Surgical Preference/Favourite Item Global
.          functions  
.V10.14.09 02/10/2019  Thanh T         TSK 0882260
.          Added DRG Version 11 in PDRG0900 
.V10.14.08 09/09/2019  J.Tan           TSK 0857392
.          Recompiled for ABF invoice
.V10.14.07 03/07/2019  Don Nguyen     TSK 0877611
.          Recompiled for PATIX1TM - Corrected Edition Number and added opens
.          for index 2 of files (PATD11A2 & PATO11A2).
.V10.14.06 07/05/2019  Richa Phogat   TSK 0857392
.          Added PTDWDRGT under CLRDRG00
.V10.14.05 01/04/2019  J.Tan          TSK 0857392
.          Added Clinical Coding system Mapping to ICD 10 Ed 10 & 11
.V10.14.04 26/03/2019  J.Tan          TSK 0857392
.          Added DRG Partition to patdgwaf
.V10.14.03 19/03/2019  Don Nguyen     TSK 0869412
.          Added clear of ICD10 Ed.11 Operation Code flag (DPT0OVX1)
.V10.14.02 14/03/2019  Don Nguyen     TSK 0869412
.          Added ICD10 ED11 Procedures & Diagnosis Maintenance reports (37 & 38)
.          and associated tag output code.
.          28/02/2019  Richa Phogat   TSK 0870439
.          Added DRG Version 10.0 in PDRG0900
.V10.14.01 13/02/2019  Ebon Clements  TSK 0862664
.          Added PTICD032 Meth. related to ICD10 ED10 diagnosis maintenance
.-------------------------------------------------------------------------
.V10.13.05 06/12/2018  Ebon Clements  TSK 0866481
.          Removed XMLHED00 and XMLEND00 calls from REMCMC00
.V10.13.04 03/10/2018  Don Nguyen     TSK 0863831
.          Added the ability to use the selected Hospital ID for Registers
.          (REGSLT00, CDSLTN00, REGCRS00).
.          Modified code for 'Credit Card Surcharge' Register (REGCRS00)
.          to only output valid selections for the user's hospital.
.          Added new output tags for 'Default Claim Type', 'Register Selection
.          List - Patient Billing', 'Cash Drawer Selection List' and
.          'Register Selection List - Credit Card Surcharge'.
.V10.13.03 02/08/2018  Don Nguyen     TSK 0851002
.          Modified REMPRD00 (Get Provisional DRG for MBS Item) to bypass
.          validation for blank values in the Provisional DRG record.
.V10.13.02 31/07/2018  Don Nguyen     TSK 0851002
.          Recompiled for PATPRDTM - Modified DRGMBS00 to ignore blank values
.V10.13.01 24/07/2018  Don Nguyen     TSK 0851002
.          Opened patprdaf second index with separate IO Trap
.-------------------------------------------------------------------------
.V10.12.03 20/07/2018  Don Nguyen     TSK 0851002
.          Added Report 36 - Remote Scripting
.          Added Report 35 - Provisional DRG via CMBS Item Code (patprdaf)
.V10.12.02 10/05/2018  Richa Phogat   TSK 0848449
.          Recomplied for PATK8DPR.PBL,PATK8OPR.PBL,PATK9DPR.PBL, PATK9OPR.PBL
.          PATKXDPR.PBL, PATKXOPR.PBL
.V10.12.01 21/03/2018  Tracey Nguyen  TSK 0852793
.          Added DRG Version 9.0 in PDRG0900
.-------------------------------------------------------------------------
.V10.11.02 28.08.2017  B.G.Ackland    TSK 0835482 
.          FHIR Output Change to Patient Reference ID to strip spaces
.          FHIR Change Extension Naming
.V10.11.01 17.08.2017  B.G.Ackland    TSK 0835482 
.          FHIR Output Include physcialType in Location Resource for ClinicalAide
.-------------------------------------------------------------------------
.V10.10.05 12.05.2017  B.G.Ackland    TSK 0835482 
.           FHIR Output Resolve Testing Issues Incorporate Version Control
.V10.10.04 08.05.2017  B.G.Ackland    TSK 0835482 
.           FHIR Output Resolve Testing Issues Incorporate Version Control
.V10.10.03  27/04/2017  B.G.Ackland      TSK 0835482 
.           FHIR Location Resource for Hospitals
.V10.10.02  21/01/2017  B.G.Ackland      TSK 0835482 
.           FHIR Location Resource for Hospitals
.V10.10.01  13/03/2017  Davin            TSK 0833093     HDP 2017/2018
.           Add ICD10 Ed.10 (PTCNGDVX) routines PATKXOPR, PATKXDPR & PAT10XMN
.           + vars PTICO030 & PTICD031
.-------------------------------------------------------------------------
.V10.09.01  14/12/2016  Don Nguyen       TSK 0323730
.           Added PTHSP056 & PTHSP057 (STHSP056 & STHSP057)
.           07/12/2016  Jill Parkinson   TSK 0822329
.           Added PTHSP055 - Default ACC Treatment Provider
.           07/12/2016  Davin            TSK 0814742
.           Added PTHSP058/PTHSMAPH - Maximum age for Paediatric Hydration
.V10.08.03  11/10/2016  J.Tan            TSK 0321309
.           Added option to upload items from XML file
.V10.08.02  03/08/2016  Don Nguyen       TSK 0312570
.           Added PTHSP054 (PTHSHSST) - Hospital State for Default DRG
.           26/07/2016  J.Tan            TSK 0813090
.           Added PTITTACB to MBS Item maintenance
.V10.08.01  24/03/2016  Steve Armstrong  TSK 0813090
.           Added PTITTACB to CLRMBS00
.-------------------------------------------------------------------------
.V10.06.02  29/05/2015  Ebon Clements   CAR 317094
.           Add DRG8 functionality
.V10.06.01  17/03/2015  Davin           CAR 311669      HDP 2015/16
.           Add ICD10 Ed.9 (PTCNGDV9) routines PATK9OPR, PATK9DPR & PAT109MN
.           + vars PTICO029 & PTICD030
.-------------------------------------------------------------------------
.V10.05.03  26.09.2014 Patrick Adair CAR 306450
.           Corrected DRG update/delete coding to function correctly
.V10.05.02  11/09/2014  Don Nguyen      CAR 302792
.           Added edit "W" for PT0DACRQ (DISSAV00)
.V10.05.01  14/08/2014  Don Nguyen      CAR 303877
.           Added PTHSP052 & PTHSP053
.V10.04.03  31.03.2014  B.G.Ackland     CAR 299363
.           Replace META Tag Redirect with Javascript in Common RDIREC00
.           Routine
.V10.04.02  12/03/2014  Don Nguyen      CAR 294888
.           Added PTHSCFST - 3M Codefinder SYS Tag Value
.           05/02/2014  Ebon Clements   CAR 291879
.           Added NEHTA functionality
.           Added report 40 - Hospital/Unit HPIO maintenance
.           13/02/2013  Patrick Adair CAR 273419
.           Amended ICD Search displays to show 200/70 char descriptions
.V10.04.01  15/01/2013  Peter Vela      CAR 291826
.           Added active teams linked to unit tag TABL0000
.-------------------------------------------------------------------------
.V10.03.10  19/11/2013  Peter Vela      CAR 291826
.           Added validation for inactive Units in CHKUN000
.V10.03.09  19/08/2013  Ebon Clements   CAR 290410                   
.           Fixed .2 ward code tag for nursing station maintenance - WSEL0000
.V10.03.08  23/05/2013  Davin           CAR 284669 HDP 2013 DRG 7.0
.           Added DRG Version 7.0 (PDRG0900)
.V10.03.07  23/04/2013  Davin           CAR 284420      HDP 2013/14
.           Add ICD10 Ed.8 (PTCNGDV8) routines PATK8OPR, PATK8DPR & PAT108MN
.           + vars PTICO028 & PTICD029
.           Includes new long description fields PT0DDSC2/PT0ODSC2
.V10.03.06  05/11/2012  Mike Laming       CAR 270133
.           Added PTHSP049 (PTHSDCDT) - Default MR Coding Destination
.V10.03.05  19/09/2012  Patrick Adair     CAR 273332
.           Added Grouper Version Selection list to PDRG0900 and corrected 
.           Grouper version to display in n.n format
.V10.03.04  04/07/2012  Don Nguyen      CAR 264561
.           Added PTHSP048 (PTHSHBID) - BPAY Identifier
.V10.03.03  02/02/2012  J.Tan           CAR 246107
.           Mods checking for Inactive Cash drawers
.V10.03.02  02/02/2012  J.Tan           CAR 246107
.           Mods checking for Inactive Cash drawers
.V10.03.01  22/11/2011  Mike Laming     CAR 253821
.           Added PT0DSAC2 wherever PT0DSACD is written (changed between ICD10.3
.           & ICD10.4)
.V10.02.09  14/10/2011  Mike Laming     CAR 251645
.           Removed CLRHSP00 and changed to use new CLPATHSP clear routine
.           Added PTHSRCOP (also PTHSEMAL & PTHSERSR)
.V10.02.08  22/09/2011  J.Tan           CAR 244159
.           Added PTHSCRSR - Register for Credit Card surcharge
.V10.02.07  12/07/2011  Peter McMullen   CAR 246389
.           Increase size of nursing station telephone number 
.V10.02.06  08/07/2011  Davin            CAR 240723
.           Added option 27 - Hospital Divisions Maintenance
.V10.02.05  24/06/2011  Peter McMullen  CAR 240725
.           change ward selectioon list to sort by name, not code
.V10.02.04  22/06/2011  Mike Laming      CAR 240724
.           Mods for MR Hospital/Location - add Default Hospital Id & MSEL000
.V10.02.03  06/05/2011  Mike Laming     CAR 240716
.           Added PTHSTORD - MRT Tracking Sort Order to Hospital Maintenance    
.V10.02.02  21/04/2011  Peter McMullen  CAR 239549
.           Added short hosp name PTHSSNAM to hospital maintenance            
.V10.02.01  31/03/2011  Davin           CAR 233033
.           Added array to stop duplicate lines in contract id keyword search
.           (ccon0000)
.           Added 'effective from date' to contract id keyword search
.V10.01.04  01/03/2011  Davin           CAR 233033
.           Adjust enddte of previous contract based on startdte of new contract
.V10.01.03  25/02/2011  Davin           CAR 233033
.           Only allow inactivate contract ids that are not in use (option 26)
.V10.01.02  14/01/2011  Peter Vela      CAR 233034
.           Added DFrame Keyword Search tag for Contract ID
.V10.01.01  17/12/2010  Davin           CAR 233033
.           Added option 26 - contract ID maintenance
.V10.00.04  30/08/2010  Davin           CAR 228299
.           Added PTIILWRD to patitm maintenance
.V10.00.03  22/07/2010  Peter Vela      CAR 226692
.           Added PTIIECEQ and PTITECTS to patitm maintenance
.V10.00.02  18/06/2010  Mike Laming     CAR 224240      
.           Re-conpile for PATKCDIO & PATKCOIO - ICD10 Ed.7 fix
.V10.00.01  06/04/2010  Mike Laming     CAR 219246      HDP 2010
.           Add ICD10 Ed.7 (PTCNGDV7) routines PATK7OPR, PATK7DPR & PAT107MN
.           + vars PTICO027 & PTICD028
. V9.12.01  23/02/2010  Jill Parkinson CAR 204945
.           Added update of PTHSCFCD - Cancer facility
. V9.11.05  03/04/2009  Peter Vela     CAR 183976
.           Added PTHSERRE, PTHSERCD, PTHSERCA to PATHSPFD maintenance
. V9.11.04  05/01/2009  Ebon Clements  CAR 183976
.           Added DVA service code to patitemn
. V9.11.03  21/11/2008  Ebon Clements  CAR 183976
.           Added complex/simple flag to patitemn
. V9.11.02  21/11/2008  Ebon Clements  CAR 183976
.           Added Eclipse fields to the hospital file
. V9.11.01  06/11/2008  Peter McMullen CAR 174725
.           convert internal javascript to W3C standards
. V9.10.03  25/09/2008  J.Tan         CAR 166690
.           Added Orginasation ID to pathspaf file
. V9.10.02  06/06/2008  Jill Habasque CAR 166095
.           Changed PTICO002 to allow 100 characters
. V9.10.01  07/05/2008  J.Tan         CAR 166690
.           Added Orginasation ID to pathspaf file
. V9.09.04  20/03/2008  Mike Laming   CAR 163918     HDP 2008 
.           Mods to PAT106MN.PBL for ICD10 Ed.6     
. V9.09.03  20/03/2008  Mike Laming   CAR 163918     HDP 2008 
.           Add PTCNGDV6 for ICD10 Ed.6 Go-live, add Search Routines PATK6OPR &
.           PATK6DPR, ICD10 Maintenance routine PAT106MN 
. V9.09.02  30/10/2007  Jill Habasque CAR 151947
.           Added PTICO025 - PT0ODTMN Procedure Date/Time non-mandatory (1=Yes)
. V9.09.01  25/07/2007  Mike Laming   CAR 145525
.           Re-compiled for PATDICPR - correct CLEAR000
. V9.08.07  15/05/2007  J.Tan        CAR 140282
.           Mods PTHSUFMS - Use Other FMS
. V9.08.06  08/05/2007  Mike Laming  CAR 137125 HDP 2007 DRG 5.2
.           Mods to PATDGWFD - Add field PTDWDRGV (add to Keys)
. V9.08.05  18/04/2007  Peter Vela    CAR 135210
.           Added PTITMSCH - Misc. Service Charge Indicator
. V9.08.04  20/03/2007  Mike Laming   CAR 125462
.           Added PATHSPFD.PTHSEDIP and PTHSP029                         
. V9.08.03  17/11/2006  Peter Vela    CAR 124538
.           Added display and submit functionality for PATITMFD.PTITTCER
.           Type of Certificate for SJOG Development
. V9.08.02  16/11/2006  J.Tan         CAR 120003  
.           Added Long Item description (ptitdesc) for NZ Private
. V9.08.01  13/11/2006  Davin         CAR 123200  
.           Added option 20 & 21 - ICD9 Diag & Proc Maintenance
. V9.07.01  24/08/2006  Ebon Clements CAR 111005  
.           Added PTHSSPID - SACS Processing ID
. V9.06.01  15/05/2006  Mike Laming   CAR 105244      2006 HDP
.           Add PTCNGDV5 for ICD10 Ed.5 Go-live and Search Routines for CGI
.           variables PTICD026 & PTICO024 - and all the other bits
. V9.05.02  06/04/2006  J.Tan         CAR 101054
.           Added Patient and Priv.Prac G/L Interface to Hospital file
. V9.05.01  09/03/2006  Ebon Clements CAR 78533
.           Mods for PATCODTM - Hospital specific category codes
. V9.05.B03 30/01/2006  Ebon Clements CAR 93186
.           Mods for REDIRECT length change. Recompiled for IBAWEBDF
. V9.05.B02 06/01/2006  Mike Laming   CAR 76341
.           Added PTHSHSID & PTHSHCEN (PTHSP025 & PTHSP026) for SACS Referrals
. V9.04.07 11/11/2005  J.Tan   CAR 55176
.          Added catchment code list by LGA/Postcode
. V9.04.06 19/07/2005  Jill Habasque   CAR 61192
.          Removed squeeze from PATCM001
. V9.04.05 07/10/2004  Lina Vo CAR 54165        
.          Added PTHSABNN to hospital maintenance
. V9.04.04 01/10/2004  J.Tan   CAR 53909        
.          Added PTHSUFMS - Use FMS system
. V9.04.03 27/09/2004  Lina Vo CAR 53798        
.          Added PTHSDCLM & PTHSAPPR to hospital maintenance
.          24/09/2004  Davin   CAR 53266        
.          Added PTHSHLOC,PTHSRCTY,PTHSVOLM,PTHSSTAT to hospital maintenance
.          21/09/2004  Lina Vo CAR 53660        
.          Added new field PTHSTFEE to hospital maintenance
.          10/09/2004  J.Tan   CAR 53252        
.          Clear PTHSHOSP in CLRHSP00.
. V9.04.02 27/08/2004  J.Tan   CAR 52830        
.          Added variable 'Print MBS code on invoice' to pathspaf file
. V9.04.01 18/08/2004  J.Tan   CAR 52830        
.          Added Hospital file maintenance
. V9.03.09 07/06/2004  Henry Son       CAR 49037
.          Add ICD Edition 4 file.
.          New Report numbers 15 and 16 for ICD10 V4 Procedure and Diagnosis
.          Codes Maintenance.
. V9.03.08 22/04/2004  Lina Vo         CAR 48824
.          Fixed MBS Item Maintenance Lock Web Flag (PTCNWITM).
. V9.03.07 16/04/2004  Lina Vo         CAR 48824
.          Mods to MBS Item Maintenance to Lock Web Flag (PTCNWITM) when 
.          entering Global Maintenance template.  
.          Also changed to lock using userid. 
. V9.03.06 15/04/2004  Lina Vo         CAR 48917
.          Changed MBS Upload ascii file to move file to unix drive.        
. V9.03.05 08/01/2004  Sylvek Litewka  CAR 46373
.          Added variables WARNFLAG, WARNTEXT and procedure WEBWAR00 to fix 
.          the warning message for MBS Linked items.
. V9.03.04 17/11/2003  Sylvek Litewka  CAR 20222
.          Added report numbers 13 and 14 for ICD10 V3 Procedure and Diagnosis
.          Codes Maintenance.
. V9.03.03 09/10/2003  Lina Vo         CAR 41778
.          Changed CMCRW000 to display both description lines in list screen.
. V9.03.02 13/08/2003  Sylvek Litewka  CAR 41293
.          Removed WEBSCHFD and WEBSCHIO includes. These are now included in 
.          IBAWEBDF.PBL and IBAWEBCD.PBL.
. V9.03.01 14/07/2003  Lina Vo       CAR 40305
.          Added Regenerate Casemix code job schedule option.
.          19/06/2003  Lina Vo       CAR 36485
.          Added GST to MBS Item Maintenance.
.          Added new file search & maintenance to MBS Item Maintenance.
.          Added Global MBS/Item functionality from IBAPAT14. 
. V9.02.10 03/02/2003  J.Tan  SRF 33496
.          Added DRG Maintenance
.
.          20/02/2003  Tracey Nguyen SRF 36425
.          Fixed Active indicator (PTITM023) and Linked item code (PTITM024)
.          validation to display a warning message
.               "Warning Linked Item exists for an inactive item" 
.          when an attempt is made to inactivate an active MBS item with a 
.          linked item code present, or when a linked item is added to a
.          non-active MBS item.
.
. V9.02.09 08/08/2002  Pat Dirito                SRF 18475,19661
.          Fixed ICD10 Keyword Search to now use patkcoaf & patkcdaf            
. V9.02.08 29/05/2002 Dean Cramer   
.          Recompile after changes to PATCMCFD   
. V9.02.07 14/05/2002 Dean Cramer   
.          Include Key Word Search for Case Mix  
. V9.02.06 01/02/2002 J Habasque    
.          Removed mandatory check for alpha key 
. V9.02.05 23/01/2002 J.Tan         
.          Added daycase suggested classification
. V9.02.04 05/11/2001 Pat Dirito    
.          Header Codes were not working for Disease Code
.          Maintenance 
. V9.02.03 02/11/2001 Ebon Clements 
.          Added update of cancer code details to report 3
. V9.02.02 24/10/2001 J.Tan
.          Mods to use QIAMT instead of IAMT
. V9.00.01 28.06.2001 B.G.Ackland
.          Remove Heading from Table for Option 11
.-------------------------------------------------------------------------
.                 V5.09.02 29.12.2000 Bronko Sosic
.                          Added option 11 Casemix Codes Table 
.-------------------------------------------------------------------------
.                 V5.08.09 26.06.2000 Bronko Sosic
.                          Added option 6 LGA Codes Maintanence
.                          Added option 7 Nursing Station Maintanence
.                          Added option 8 Period Dates Maintanence
.                          Added option 9 LGA Post Codes Maintanence
.                          Added option 10 Catchment Codes Maintanence
.                 V5.08.08 23.03.2000 Bronko Sosic
.                          Added startkey for GOTO button
.                 V5.07.07 03.03.2000 Pat Dirito                   
.                          Fixed save of MBS Amount 
.                          Was   MOVE  PTITM004,QIAMT is PTITM004,IAMT
.                 V5.07.06 24.02.2000 Pat Dirito                   
.                          Added Report instance to ShowDetail, updateParent &
.                          showICD 
.                 V5.07.05 20.12.1999 Katie Nelson                 
.                          Recompiled for IBAWEBDF/IBAWEBCD      
.                 V5.07.04 03.11.1999 Katie Nelson                 
.                          Recompile for WEBDATCD/ DAYOFWEK      
.                 V5.07.03 27.09.1999 Katie Nelson - AT TARANAKI
.                          Changed table cell bgcolor to class
.                 V5.07.02 17.09.1999 Pat Dirito 
.                          Added Report 3 - Hospital File Maintenance  
.                          12.07.1999 B.G.Ackland
.                          Change Open on Key Word Tables to ICD9 Tables
.                 V5.07.01 09.07.1999 B.G.Ackland
.                          Removed MBS Audit Update Not Required (NZ)
.                 V5.07.00 28/06/1999 Nicole Harrington
.                          Ported from 6.06 - 5.07
.----------------------------------------------------------------------
.                 V6.06.00 26.05.1999 Pat Dirito
.                          Created Program
.
.----------------------------------------------------------------------
          INC       IBAWEBDF    
          INC       WEBDATDF
          INC       RSHWEBDF
    
          INC       IBAGSTFD/INC      * GST master file
          INC       MRTLOCFD/INC      * MRT Locations file
          INC       PATCONFD/INC      * Control file
          INC       PATHOSFD/INC      * Hospital File
          INC       PATICOFD/INC      * ICD-9CM &(ICD10) OPERATION FILE 
          INC       PATICDFD/INC      * ICD-9CM &(ICD10) DISEASES FILE  
          INC       PATCMCFD/INC      * Casemix Codes Table FD  
          INC       PATCMXFD/INC      * Casemix Funding Table
          INC       PATDGWFD/INC      * DRG Codes Table FD
          INC       PATITMFD/INC      * Patient Item File
          INC       PATIKIFD/INC      * patitemn MBS Key Words   
          INC       PATNURFD/INC      * Nursing Station FD
          INC       PATLGAFD/INC      * LGA Code FD
          INC       PATLG1FD/INC      * LGA  post Code FD
          INC       PATCT1FD/INC      * Catchment Codes FD
          INC       PMSCIDFD/INC      * Contract ID FD    
          INC       PMSIHUFD/INC      * Hospital/Unit HPI-O Details
          INC       PMSIHUTD/INC      * Hospital/Unit HPI-O Details CGI vars
          INC       PATKCOFD/INC      * ICD10 Procedure Key Words 
          INC       PATKCDFD/INC      * ICD10 Diagnosis Key Words 
          INC       PATKCMFD/INC      * Casemix Codes Key Words 
          INC       PATDICFD/INC      * ICD9 Diagnosis Key Words 
          INC       PATOICFD/INC      * ICD9 Procedure Key Words 
          INC       PATWR1FD/INC      * Patient Ward/Bed File
          INC       RCPCONFD/INC
          INC       RCPREGFD/INC
          INC       RCPCIDFD/INC
          INC       FMSCHQFD/INC
.
          INC       PMSVMTFD/INC
          INC       PMSVMTTD/INC
          INC       PMSVSTFD/INC
          INC       PMSVSTTD/INC
.
          INC       WEBHDPFD/INC      * Hospital Data File Locations
          INC       MLTSECFD/INC      * Multi Hospital Security Table
          INC       PATCANFD/INC      * Cancer code file
          INC       PATCLSFD/INC      * Clinical specialty file
          INC       PATHSPFD/INC      * Hospital details file
          INC       PATLCNFD/INC      * Eclipse Location
          INC       PMSCKIFD/INC      * Contract ID key words
          INC       PMSDCAFD/INC      * Deleted Contracts Audit
          INC       PMSHCPFD/INC      *                               *I-251645
          INC       PMSTEMFD/INC
          INC       PATLSDFD/INC
          INC       PATASDFD/INC
          INC       PATHLFFD/INC
          INC       PATLDFFD/INC
          INC       PATHDFFD/INC
          INC       PATAFEFD/INC
          INC       PMSDIVFD/INC
          INC       PMSDIVTD/INC
          INC       PATPRDFD/INC       * Provisional DRG via CMBS Item Code
          INC       PATPRDTD/INC       * Provisional DRG cgi variables
.
.----------------------------------------------------------------------
. CGI Parameters
.----------------------------------------------------------------------
NEXTPAGE  DIM       1
UPDTTYPE  DIM       1     * Update Type
STARTKEY  DIM       10    * Starting Key
FILEFLAG  DIM       1     * C=Current file N=New file
COPYFLAG  DIM       1                                     
.
MBSITEMN  DIM       9     * ITEM NUMBER
MBSEFFDT  DIM       8     * EFFECTIVE FROMDATE
PTITM001  DIM       9     * ITEM NUMBER
PTITM002  DIM       6     * ITEM ALPHA KEY
PTITM003  DIM       40    * ITEM DESCRIPTION
PTITM004  FORM      12.2  * MBS AMOUNT
PTITM005  DIM       3     * MISCELLANEOUS GROUP (CAT FI)
PTITM006  DIM       3     * SUGGESTED CLASS (CAT A )
PTITM007  DIM       3     * THEATRE CLASS 1 (CAT TB)
PTITM008  DIM       3     * THEATRE CLASS 2 (CAT TB)
PTITM009  DIM       3     * THEATRE CLASS 3 (CAT TB)
PTITM010  DIM       3     * THEATRE CLASS 4 (CAT TB)
PTITM011  DIM       3     * THEATRE CLASS 5 (CAT TB)
PTITM012  DIM       3     * THEATRE CLASS 6 (CAT TB)
PTITM013  DIM       3     * THEATRE CLASS 7 (CAT TB)
PTITM014  DIM       3     * THEATRE CLASS 8 (CAT TB)
PTITM015  DIM       3     * THEATRE CLASS 9 (CAT TB)
PTITM016  DIM       3     * THEATRE CLASS 10(CAT TB)
PTITM017  DIM       3     * THEATRE CLASS 11(CAT TB)
PTITM018  DIM       3     * THEATRE CLASS 12(CAT TB)
PTITM019  DIM       3     * THEATRE CLASS 13(CAT TB)
PTITM020  DIM       3     * THEATRE CLASS 14(CAT TB)
PTITM021  DIM       3     * THEATRE CLASS 15(CAT TB)
PTITM022  DIM       3     * THEATRE CLASS 16(CAT TB)
PTITM023  DIM       1     * Active indicator " " = Active, "I" = Inactive
PTITM024  DIM       9     * Linked item code (inactive items only).
PTITM025  FORM      2     * Exclusion list item ? 1 = Yes 2 = No
PTITM026  DIM       1     * Warning to enter a Prosthetic
PTITM027  DIM       3     * Daycase suggested classification
PTITM028  FORM      1     * GST Applicable? 0=GST Free 1=GST Payable 2=Either
PTITM029  DIM       6     * GST Payable Code              
PTITM030  DIM       60    * Long Item Description
PTITM031  DIM       3     * Type of Certificate (cr)
PTITM032  DIM       1     * Misc Ser Charge Indicator
PTITM033  DIM       1     * Theatre Category Code
PTITM034  DIM       9     * DVA Service Code
PTITM035  DIM       11    * Eclipse Equivalent
PTITM036  DIM       2     * Eclipse Type of Service
PTITM037  DIM       1     * Eclipse Labour Ward Item (Blank or 0 = No, 1 = Yes)
PTITM038  DIM       3     * Theatre Average Calc. Band (Cat TB)
PTITM039  DIM       8     * Effective From date (CCYYMMDD)
PTITM040  DIM       8     * Effective To date (CCYYMMDD)
.
. ICD10 Procedures
.
PTICO001  DIM       9     * ICD10 Procedure Code
PTICO002  DIM       200   * Description
PTICO003  DIM       1     * Validity of code
PTICO004  DIM       4     * Block Number
PTICO005  DIM       1     * Age group edit 
PTICO006  FORM      3     * Age low limit 
PTICO007  FORM      3     * Age high limit
PTICO008  DIM       1     * 2nd Age group edit 
PTICO009  FORM      3     * 2nd Age low limit
PTICO010  FORM      3     * 2nd Age high limit
PTICO011  DIM       1     * Sex edit
PTICO012  DIM       1     * Asterisk/Dagger type
PTICO013  DIM       9     * Suggested Asterisk Code
PTICO014  DIM       1     * Dagger & asterisk edit
PTICO015  DIM       1     * Area edit
PTICO016  DIM       9     * Mapped ICD9 Operation Code
PTICO017  DIM       1     * Complex mappings format
PTICO018  FORM      1     * Valid ICD10 Version 1 Code 0=No 1=Yes
PTICO019  FORM      1     * Valid ICD10 Version 2 Code 0=No 1=Yes
PTICO020  DIM       9     * ICD10 version 1 map code               
PTICO021  FORM      1     * Valid ICD10 Version 3 Code 0=No 1=Yes
PTICO022  DIM       9     * ICD10 version 2 map code               
PTICO023  FORM      1     * Valid ICD10 Edition 4 Code 0=No 1=Yes      *I-49037
PTICO024  FORM      1     * Valid ICD10 Edition 5 Code 0=No 1=Yes     *I-105244
PTICO025  DIM       1     * Procedure Date/Time mandatory 1=Yes
PTICO026  FORM      1     * Valid ICD10 Edition 6 Code 0=No 1=Yes     *I-163918
PTICO027  FORM      1     * Valid ICD10 Edition 7 Code 0=No 1=Yes     *I-219246
PTICO028  FORM      1     * Valid ICD10 Edition 8 Code 0=No 1=Yes     *I-284420
PTICO029  FORM      1     * Valid ICD10 Edition 9 Code 0=No 1=Yes     *I-311669
PTICO030  FORM      1     * Valid ICD10 Edition 10 Code 0=No 1=Yes    *I-0833093
PTICO031  FORM      1     * Valid ICD10 Edition 11 Code 0=No 1=Yes
PTICO032  FORM      1     * Valid ICD10 Edition 12 Code 0=No 1=Yes    *I-0917793
PTICO033  DIM       1     * Unplanned Return to Theatre Flag
PTICO034  FORM      1     * Valid ICD10 Edition 13 Code 0=No 1=Yes    *I-0956210
.
. Cancer Code Details
.
PTCAN001  FORM     1      * Cancer Code 1=Yes 0 =No
PTCAN002  FORM     1      * Input Laterality 1=Yes 0=No
CANCERCD  FORM     1      * Cancer code 1=Yes 0=No
.
. ICD10 Diagnosis
.
PTICD001  DIM       9     * ICD10 Diagnosis Code
PTICD002  DIM       200   * Description
PTICD003  DIM       1     * Validity of code
PTICD004  DIM       1     * Age group edit 
PTICD005  FORM      3     * Age low limit 
PTICD006  FORM      3     * Age high limit
PTICD007  DIM       1     * 2nd Age group edit 
PTICD008  FORM      3     * 2nd Age low limit
PTICD009  FORM      3     * 2nd Age high limit
PTICD010  DIM       1     * Sex edit
PTICD011  DIM       1     * Asterisk/Dagger type
PTICD012  DIM       9     * Suggested Asterisk Code
PTICD013  DIM       1     * Dagger & asterisk edit
PTICD014  DIM       1     * Area edit
PTICD015  DIM       1     * Code Practices edit 
PTICD016  DIM       2     * Additional code requirements edit
PTICD017  DIM       9     * Mapped ICD9 Operation Code
PTICD018  DIM       1     * Complex mappings format
PTICD019  FORM      1     * Valid ICD10 Version 1 Code 0=No 1=Yes
PTICD020  FORM      1     * Valid ICD10 Version 2 Code 0=No 1=Yes
PTICD021  DIM       9     * ICD10 version 1 map code               
PTICD022  FORM      1     * Valid ICD10 Version 3 Code 0=No 1=Yes
PTICD023  DIM       9     * ICD10 version 2 map code               
PTICD024  FORM      1     * Valid ICD10 Edition 4 Code 0=No 1=Yes      *I-49037
PTICD025  FORM      2     * Diag. Code Prefix                          *I-49037
PTICD026  FORM      1     * Valid ICD10 Edition 5 Code 0=No 1=Yes     *I-105244
PTICD027  FORM      1     * Valid ICD10 Edition 6 Code 0=No 1=Yes     *I-163918
PTICD028  FORM      1     * Valid ICD10 Edition 7 Code 0=No 1=Yes     *I-219246
PTICD029  FORM      1     * Valid ICD10 Edition 8 Code 0=No 1=Yes     *I-284420
PTICD030  FORM      1     * Valid ICD10 Edition 9 Code 0=No 1=Yes     *I-311669
PTICD031  FORM      1     * Valid ICD10 Edition 10 Code 0=No 1=Yes    *I-0833093
PTICD032  DIM       1     * Methamphetamine Related
PTICD033  FORM      1     * Valid ICD10 Edition 11 Code 0=No 1=Yes
PTICD034  FORM      1     * Valid ICD10 Edition 12 Code 0=No 1=Yes    *I-0917793
PTICD035  FORM      1     * Valid ICD10 Edition 13 Code 0=No 1=Yes    *I-0956210
PTICD036  DIM       1     * Cluster Allocation Required
.
.  Hospital File Maintenance
.
PTHOS001  DIM       4     * Hospital Code 
PTHOS002  DIM       2     * Unique Identifier (1-20)  
PTHOS003  DIM       30    * Hospital Descprition
PTHOS004  DIM       30    * RUN COMMAND (Unique Ports)
PTHOS005  DIM       30    * RUN COMMAND (Batch recording)
PTHOS006  DIM       1     * Active/Inactive indicator " " = active I = inactive 
PTHOS007  DIM       20    * RUN COMMAND for Patient Billing MRT21
.
.  Hospital Data File Locations
.
PTLOC001  DIM       2     * Hospital Unique ID
PTLOC002  DIM       8     * File Name
PTLOC003  DIM       60    * Path To Open
.
.
.  LGA Post Code File Maintenance
.
PTLGP001  DIM       8     * LGA Post Code
PTLGP002  DIM       4     * LGA Code    
.
.
.  LGA Code File Maintenance
.
PTLGA001  DIM       4     * LGA Code
PTLGA002  DIM       20    * LGA Description
.
.  Nursing Station Maintenance
.
PTNUR001  DIM       3     * Nursing Station Number
PTNUR002  DIM       3     * Nursing Ward Number
PTNUR003  DIM       30    * Nursing Station Description
PTNUR004  DIM       30    * Sister in Charge
PTNUR005  DIM       20    * Nursing Extension Number
.
.  Catchment Code Maintenance
.
PTCTC001  DIM       8     * Postcode              
PTCTC002  DIM       3     * Catchment Code              
PTCTC003  DIM       4     * LGA Code              
.
.  Casemix Code Table Maintenance
.
PATCM001  DIM       9     * Casemix Code  
PATCM002  DIM       30    * Description 1   
PATCM003  DIM       30    * Description 2   
PATCM004  FORM      4     * Expected Length of stay  
PATCM005  FORM      1     * Active (1=Yes)  
.
.  DRG Code Table Maintenance
.
DRGCODES  DIM       4     * DRG Number
PTDRG001  DIM       4     * DRG Number
PTDRG002  DIM       4     * MDC Number
PTDRG003  DIM       60    * DRG Description
PTDRG004  FORM      3.2   * Low Trim
PTDRG005  FORM      3.2   * High Trim
PTDRG006  FORM      3.6   * Resource Weight
PTDRG007  DIM       2     * Clincal Speciality
PTDRG008  DIM       3     * DRG Version
PTDRG009  DIM       3     * DRG Version
PTDRG010  DIM       3     * DRG Partition (DRG Type)
.
.  Global MBS Item Maintenance
.
GMBS0001  DIM       60    *            
GMBS0002  DIM       8     *
GMBS0003  DIM       8     * 
GMBS0004  DIM       8     * 
GMBS0005  DIM       8     *
.
.  Global BS Item Maintenance
.
FVGRP001  DIM       3     * Hospital ID (pathspaf)
FVGRP002  DIM       3     * User Occupational Group (Cat w0)
FVGRP003  DIM       10    * Web User (websecaf) blank for all
FVGRP004  DIM       3     * Favourite Group (Cat w4)
FVGRP005  DIM       9     * Item code to be replaced - favourite item
FVGRP006  DIM       9     * New item code - favourite item
FVGRP007  DIM       15    * Item code to be replaced - preference tray
FVGRP008  DIM       15    * New item code - preference tray
.
.  Hospital details Maintenance
.
PTHSP001  DIM       3     * Hospital ID
PTHSP002  DIM       50    * Hospital name
PTHSP003  DIM       35    * Hospital address line 1
PTHSP004  DIM       35    * Hospital address line 2
PTHSP005  DIM       35    * Hospital address line 3
PTHSP006  DIM       35    * Hospital address line 4
PTHSP007  DIM       8     * Post code
PTHSP008  DIM       20    * Telephone number
PTHSP009  DIM       20    * Fax number
PTHSP010  DIM       5     * Unit
PTHSP011  DIM       8     * Health department code
PTHSP012  DIM       3     * Medical record request printer
PTHSP013  DIM       12    * Posting account
PTHSP014  FORM      2     * Hospital number
PTHSP015  DIM       1     * Print MBS code on invoice Y/N
PTHSP016  DIM       1     * Using theatre fees file (pattfees) ? 
PTHSP017  DIM       4     * Default MR home location
PTHSP018  DIM       3     * Default MR record type
PTHSP019  FORM      2     * Default MR volume
PTHSP020  DIM       3     * Default MR Record Status
PTHSP021  DIM       3     * Default Claim Code         
PTHSP022  DIM       10    * Approval Number         
PTHSP023  DIM       1     * Use FMS
PTHSP024  DIM       11    * Hospital ABN Number
PTHSP025  DIM       5     * Health Service Identifier
PTHSP026  DIM       3     * Health Care Establishment Number
PTHSP027  DIM       1     * Patient G/L Interface
PTHSP028  DIM       1     * SACS Processing ID
PTHSP029  DIM       2     * EDI File Prefix    
PTHSP030  DIM       8     * Organisation ID
PTHSP031  DIM       1     * Using Morgue Management
PTHSP032  DIM       1     * Capture HouseKeeping on Transfer
PTHSP033  DIM       1     * Capture HouseKeeping on Discharge
PTHSP034  DIM       1     * Hospital Type
PTHSP035  DIM       1     * Using DVA Eclipe Claiming
PTHSP036  DIM       8     * Eclipse Location
PTHSP037  DIM       3     * Eclipse Remittance Release Register
PTHSP038  DIM       6     * Eclipse Remittance Release Cash Register
PTHSP039  DIM       15    * Eclipse Remittance Release Chq Account
PTHSP040  DIM       6     * Cancer Facility code
PTHSP041  DIM       10    * Short Hospital Name 
PTHSP042  DIM       1     * Tracking Sort Order (MRT)
PTHSP043  DIM       3     * Default MR home hospital id               *I-240724
PTHSP044  DIM       3     * Register for Credit Card surcharge
PTHSP045  DIM       80    * Email address
PTHSP046  DIM       3     * Eclipse Remittance Suspense Register
PTHSP047  DIM       10    * Resp.Clinician Dflt Code for Organ Procurement
PTHSP048  DIM       4     * BPAY Identifier (1-4 digits)
PTHSP049  DIM       4     * Default MR Coding Destination (PTHSDCDT)
PTHSP050  DIM       20    * HPI-O Number
PTHSP051  DIM       3     * 3M Codefinder SYS Tag Value
PTHSP052  DIM       3     * District Health Board (Cat dh)
PTHSP053  DIM       3     * Health Agency (Cat HA)
PTHSP054  DIM       1     * Hospital State for Default DRG
PTHSP055  DIM       10    * Default ACC Treatment Provider
PTHSP056  DIM       3     * Lowest Age Limit Yrs (Must be >= 0)
PTHSP057  DIM       3     * Highest Age Limit Yrs (Must be < 200)
PTHSP058  DIM       2     * Maximum age for Paediatric Hydration
.
. Contract ID maintenance
.
PMCID001  DIM       6     * Contract ID
PMCID002  DIM       8     * Effective From Date
PMCID003  DIM       8     * Effective To Date
PMCID004  DIM       80    * Description
PMCID005  DIM       1     * Active 1=No 0=Yes
PMCID006  DIM       1     * Using Patient Only invoices 1=Yes
PMCID007  DIM       8     * Close Off Date (CCYYMMDD)
.
.----------------------------------------------------------------------
. Program Variables
.----------------------------------------------------------------------
XMLFILE   FILE      ASCII, FIXED=4000
MBSFILE   FILE      ASCII, FIXED=256
PATIAUD   FILE      ASCII, FIXED=256
ACTION    DIM       1
ADD       DIM       2
AMM       DIM       2
AYY       DIM       2
ACC       DIM       2
CIDARRAY  DIM       6[200]     * Contract ids displayed in search results
CIDAREND  FORM      3          * Number of contract ids in CIDARRAY[]
CIDSDESC  DIM       80
CIDEDESC  DIM       80
CIDEDATE  DATE      8
CIDSDATE  DIM       8                       * CID start effective date
CMDMV     INIT      "mv "
CURRDATE  DIM       8          * Current Date
DFLTWARD  DIM       3        * ward marked as pre-selected in ward select list
DIM3      DIM       3
DIM11     DIM       11
DIM60     DIM       60
DISPDAT1  DIM       11
DISPDAT2  DIM       11
DRGVERZ   DIM       3                                                 *I-137125
FORM1P1   FORM      1.1                                             * Car 273332
FORM2P1   FORM      2.1
FORM3     FORM      3                                               * Car 273332    
HOSPCODE  DIM       4    * Hospital Code
HOSPINDX  FORM      2    * Unique Hospital Identifier 
ICD10EDN  FORM      1    * ICD10 Edition No.                          *I-253821
JAVCDESC  DIM       80
LNK2PRT   FORM      1
MBSUPLFL  INIT      "mbsitems"
MRCNHMTY  DIM       3    * Type Code for Home Location
MRCNCFST  DIM       3    * Codefinder SYS Tag Value
OLDCONTR  DIM       6
OPERCODE  DIM       4
REMOTENO  FORM      2    * Remote Scripting number
SCATACTI  FORM      1
SAVKEY6   DIM       6
SAVKEY14  DIM       14
SAVKEY18  DIM       18
SAVKEY21  DIM       21
SAVKEY24  DIM       24
SAVKEY9   DIM       9 
SAVWBHOS  DIM       3    * Saved web user Hospital ID
SEC1      FORM      "00001"
DSCITEM   DIM       30
UNIQID    DIM       2    * Unique Hospital Index
USEPTHSP  DIM       1    * Using the selected Hospital ID
VALDTYPE  FORM      1    * Validation Type
VALDCODE  DIM       10   * Validation Code
VALDNAME  DIM       40   * Validation Name
VALFDATE  DIM       8
VALTDATE  DIM       8
WARNFLAG  FORM      1    * Warning Flag (0 = No warning, 1 = Warning)
WARNTEXT  DIM       80   * Warning message
WORKDATE  DATE      8
.
.----------------------------------------------------------------------
PRGID     INIT      "PATWEB88"
VERSION   INIT      "V12.01.00"
PRGNAM    INIT      "General Table Maintenance"
.----------------------------------------------------------------------
.
          CALL      WEBINT00       * Initialise Fifo Etc.
          CALL      INIT0000       * Open Files
.
MAIN1000  CALL      WEBRED00       * Read Fifo WEBPID and USERID
.
          COMPARE   "999",REPORTNO * End Server Process on Report Option 999
          GOTO      MAIN9999 IF EQUAL
.
          MOVE      ZERO,ICD10EDN                                     *I-253821^
.
MAIN1002  BRANCH    REPORTNO,MAIN1010,MAIN1020,MAIN1030,MAIN1040,MAIN1050:
                             MAIN1060,MAIN1070,MAIN1080,MAIN1090,MAIN1100:  * 10
                             MAIN1110,MAIN1120,MAIN1130,MAIN1140,MAIN1150:
                             MAIN1160,MAIN1170,MAIN1180,MAIN1190,MAIN1200:  * 20
                             MAIN1210,MAIN1220,MAIN1230,MAIN1240,MAIN1250:
                             MAIN1260,MAIN1270,MAIN1280,MAIN1290,MAIN1300:  * 30
                             MAIN1310,MAIN1320,MAIN1330,MAIN1340,MAIN1350:
                             MAIN1360,MAIN1370,MAIN1380,MAIN1390,MAIN1400:  * 40
                             MAIN1410,MAIN1420,MAIN1430
.
          PACK      WEBTITLE,PRGID,SP1,VERSION,SP1,PRGNAM,SP70
          MOVE      "Invalid Option",WEBTITLE
          CALL      WEBERR00   * Create Output File and Write HTML Page Header
          GOTO      MAIN1000
.
MAIN1010  CALL      PMBSGR00        * MBS Item Code Maintenance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1020  CALL      PICDGR00  * ICD10 Procedure Maintenance & Key Word Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1030  CALL      PICDDI00  * ICD10 Diagnosis Maintenance & Key Word Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1040  CALL      HOSFIL00  * Hospital File Maintenance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1050  CALL      HOSLOC00  * Hospital Data File Locations
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1060  CALL      PATLGA00  * LGA Code Maintanance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1070  CALL      PATNUR00  * Nursing Station Maintanance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1080  CALL      PATWAR00  * Nursing Ward Maintanance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1090  CALL      PATLGP00  * LGA Post Code Maintanance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1100  CALL      PATCTC00  * Catchment Code Maintanance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1110  CALL      PATCMC00   * Casemix Codes Table Maintenance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1120  CALL      PATDRG00        * DRG Code Maintenance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1130  CALL      ICD3OP00  * ICD10 V3 Procedure Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1140  CALL      ICD3DI00  * ICD10 V3 Diagnosis Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.                                                                      *I-49037
MAIN1150  CALL      ICD4OP00  * ICD10 Ed4 Procedure Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.                                                                      *I-49037
MAIN1160  CALL      ICD4DI00  * ICD10 Ed4 Diagnosis Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1170  CALL      HOSDET00  * Hospital Details Maintenance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
.                                             start of addition       *I-105244
MAIN1180  CALL      ICD5OP00  * ICD10 Ed5 Procedure Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.                                       
MAIN1190  CALL      ICD5DI00  * ICD10 Ed5 Diagnosis Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.                                               end of addition       *I105244
.
MAIN1200  CALL      IC99OP00  * ICD9 Procedure Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1210  CALL      IC99DI00  * ICD9 Diagnosis Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000                                      
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
.******************************************** start of addition       *I-163918
MAIN1220  CALL      ICD6OP00  * ICD10 Ed6 Procedure Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1230  CALL      ICD6DI00  * ICD10 Ed6 Diagnosis Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.********************************************   end of addition       *I-163918
.
.                                                         * start     *I-219246
MAIN1240  CALL      ICD7OP00  * ICD10 Ed7 Procedure Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1250  CALL      ICD7DI00  * ICD10 Ed7 Diagnosis Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.                                                         * end       *I-219246
MAIN1260  CALL      PMSCID00     * Contract ID Table Maintenance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1270  CALL      PMSDIV00     * Divisions Maintenance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.                                                                     *I-284420
MAIN1280  CALL      ICD8OP00  * ICD10 Ed8 Procedure Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1290  CALL      ICD8DI00  * ICD10 Ed8 Diagnosis Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1300  CALL      PMSIHU00     * Hospital Unit HPIO Maintenance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.                                                                     *I-311669
MAIN1310  CALL      ICD9OP00  * ICD10 Ed9 Procedure Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1320  CALL      ICD9DI00  * ICD10 Ed9 Diagnosis Maintenance & KeyWord Search
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.                                                                     *I-0833093
MAIN1330  CALL      ICDXOP00  * ICD10 Ed10 Procedure Maintenance & KeyWord Srch
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1340  CALL      ICDXDI00  * ICD10 Ed10 Diagnosis Maintenance & KeyWord Srch
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.                                       
MAIN1350  CALL      PRVDRG00           * Privisional DRG By CMBS Item Code
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.                                       
MAIN1360  CALL      REMOTE00           * Remote Scripting
          GOTO      MAIN1000
.
MAIN1370  CALL      ICDX1P00  * ICD10 Ed11 Procedure Maintenance & KeyWord Srch
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1380  CALL      ICDX1D00  * ICD10 Ed11 Diagnosis Maintenance & KeyWord Srch
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1390  CALL      SURFAV00          * Surgical Pref/Fav Item Global Func
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.                                                                     *I-0917793
MAIN1400  CALL      ICDX2P00  * ICD10 Ed12 Procedure Maintenance & KeyWord Srch
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1410  CALL      ICDX2D00  * ICD10 Ed12 Diagnosis Maintenance & KeyWord Srch
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.                                                                     *I-0956210
MAIN1420  CALL      ICDX3P00  * ICD10 Ed13 Procedure Maintenance & KeyWord Srch
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1430  CALL      ICDX3D00  * ICD10 Ed13 Diagnosis Maintenance & KeyWord Srch
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN9999  MOVE      "SERVER SHUTDOWN COMPLETE",WEBTITLE
          CALL      WEBERR00
          STOP
.------------------------------------------------------------
. Output Next Page Based on CGI Parameter nextpage
.------------------------------------------------------------
NXTPAG00  MOVE      ZERO,F1
          MOVE      NEXTPAGE,F1
          BRANCH    F1,NXTPAG10,NXTPAG20,NXTPAG30,NXTPAG40
.
          CALL      WINCLS00
          GOTO      NXTPAG99
.
NXTPAG10  CALL      RDIREC00
          GOTO      NXTPAG99
.
NXTPAG20  CALL      GOBACK00
          GOTO      NXTPAG99
.
NXTPAG30  CALL      GOBACK00
          GOTO      NXTPAG99
.
NXTPAG40  CALL      GOBACK00
          GOTO      NXTPAG99
.
NXTPAG99  RETURN
.-------------------------------------------------------------------------------
.  Goes back x number of pages
.-------------------------------------------------------------------------------
GOBACK00  CALL      OPENHTML
          BRANCH    EXIT,GOBACK99
          MOVE      NEXTPAGE,F1
          SUB       TWO,F1
          WRITE     HTMLFILE;"<script type=#"text/javascript#"> {":
                             "    alert(#"",WEBTITLE,"#");":
.                            "    self.close();":
                             "    window.history.go(-",F1,");":
                             "}":
                             "</script>"
          CALL      CLOSHTML
GOBACK99  RETURN
.------------------------------------------------------------
. Open Files and Initialize Variables
.------------------------------------------------------------
INIT0000  OPEN      CONTROLF,"controlf"
          OPEN      IBAGSTA1,"ibagstaf"
          OPEN      MLTSECA1,"mltsecaf"
          OPEN      MRTLOCA1,"mrtlocaf"
          OPEN      PATCODE1,"patcodes"
          OPEN      PATCODE2,"patcodes" 
          OPEN      PATHOSP1,"pathospf"
          OPEN      PATHOSP2,"pathospf"
          OPEN      WEBHDPA1,"webhdpaf"
          OPEN      PATITEM1,"patitemn"
          OPEN      PATITEM2,"patitemn"  
          OPEN      PATIKIA1,"patikiaf"
          OPEN      PATLGAA1,"patlgaaf"
          OPEN      PATLG1A1,"patlg1af"
          OPEN      PATCT1C1,"patct1cf"   * Read Catchmnet Codes
          OPEN      PATCT1C2,"patct1cf"   * Read Catchmnet Codes
          OPEN      PATCT1C3,"patct1cf"   * Read Catchmnet Codes
          OPEN      PMSCIDA1,"pmscidaf"   * Contract ID
          OPEN      PATCLSA1,"patclsaf"   * Read Clinical specialty
          OPEN      PATDGWA1,"patdgwaf"   * DRG file
          OPEN      PATNURS1,"patnursm"   * Read Nurses Station
          OPEN      PATHSPA1,"pathspaf"   * Hospital details
          OPEN      PATWR1A7,"patwr1af"
          OPEN      PATWR1A1,"patwr1af"
          OPEN      PMSHCPA1,"pmshcpaf"                               *I-251645
          OPEN      PMSIHUA1,"pmsihuaf"
.
...          OPEN      PATIAUD,"patiaud"  
.
          OPEN      PATICDO1,"paticdof"   * Read ICD9 Operations  
          OPEN      PATI10O1,"pati10of"   * Read ICD10 Operations
          OPEN      PATI13O1,"pat10o3f"   * Read ICD10 V3 Operations
          OPEN      PATI14O1,"pat10o4f"   * Read ICD10 Ed4 Operations  *I-49037
          OPEN      PATI15O1,"pat10o5f"   * Read ICD10 Ed5 Operations *I-105244
          OPEN      PATICDD1,"paticddf"   * Read ICD9 Diseases 
          OPEN      PATI10D1,"pati10df"   * Read ICD10 Diseases 
          OPEN      PATI13D1,"pat10d3f"   * Read ICD10 V3 Diseases 
          OPEN      PATI14D1,"pat10d4f"   * Read ICD10 Ed4 Diseases    *I-49037
          OPEN      PATI15D1,"pat10d5f"   * Read ICD10 Ed5 Diseases   *I-105244
.   
.                                                     * ICD10 ed.6    *I-163918
.                   OPENs for "pat10o6f" and "pat10d6f" now in PAT106MN.PBL
.                   OPENs for "pat10o7f" and "pat10d7f" now in PAT107MN.PBL
.
..          MOVE      "00000000",PTCNI10D   * Read ICD10 IO
.
          OPEN      PATKCOA1,"patkcoaf"   * ICD10 Key Word Procedure
          OPEN      PATKCOA2,"patkcoaf"   * ICD10 Key Word Procedure
          OPEN      PATK3OA1,"patkco3f"   * ICD10 V3 Key Word Procedure
          OPEN      PATK3OA2,"patkco3f"   * ICD10 V3 Key Word Procedure
          OPEN      PATK4OA1,"patkco4f"   * ICD10 Ed4Key Word Procedure*I-49037
          OPEN      PATK4OA2,"patkco4f"   * ICD10 Ed4Key Word Procedure*I-49037
          OPEN      PATK5OA1,"patkco5f"   * ICD10 Ed5 Key Word Proc.  *I-105244 
          OPEN      PATK5OA2,"patkco5f"   * ICD10 Ed5 Key Word Proc.  *I-105244 
          OPEN      PATKCDA1,"patkcdaf"   * ICD10 Key Word Diagnosis 
          OPEN      PATKCDA2,"patkcdaf"   * ICD10 Key Word Diagnosis
          OPEN      PATK3DA1,"patkcd3f"   * ICD10 V3 Key Word Diagnosis 
          OPEN      PATK3DA2,"patkcd3f"   * ICD10 V3 Key Word Diagnosis
          OPEN      PATK4DA1,"patkcd4f"   * ICD10 Ed4Key Word Diagnosis*I-49037
          OPEN      PATK4DA2,"patkcd4f"   * ICD10 Ed4Key Word Diagnosis*I-49037
          OPEN      PATK5DA1,"patkcd5f"   * ICD10 Ed5 Key Word Diag.  *I-105244 
          OPEN      PATK5DA2,"patkcd5f"   * ICD10 Ed5 Key Word Diag.  *I-105244
. 
.                                                     * ICD10 ed.6    *I-163918
.                   OPENs for "patkco6f" and "patkcd6f" now in PAT106MN.PBL
.                   OPENs for "patkco7f" and "patkcd7f" now in PAT107MN.PBL
.
          OPEN      PATOICA1,"patoicaf"   * ICD9 Key Word Procedure
          OPEN      PATOICA2,"patoicaf"   * ICD9 Key Word Procedure
          OPEN      PATDICA1,"patdicaf"   * ICD9 Key Word Diagnosis 
          OPEN      PATDICA2,"patdicaf"   * ICD9 Key Word Diagnosis
          OPEN      PATCMCA1,"patcmcaf"   
          OPEN      PATCMXA1,"patcmxaf"   * Casemix Funding Table
          OPEN      PATKCMA1,"patkcmaf"   * Casemix Codes Key Words   
          OPEN      PATKCMA2,"patkcmaf"   * Casemix Codes Key Words  
...        OPEN      PATAUDCA,"pataudca"   *Audit file ... needs to be added 
          OPEN      PATCANA1,"patcanaf"   * Cancer code file
          OPEN      RCPREGA4,"rcpregaf"
          OPEN      RCPCIDA1,"rcpcidaf"
          OPEN      FMSCHQA1,"fmschqaf"
          OPEN      WEBSECA3,"websecaf"   * Web user security file
          OPEN      PATLCNA1,"patlcnaf"
          OPEN      PMSCKIA1,"pmsckiaf"
          OPEN      PMSCKIA2,"pmsckiaf"
          OPEN      PMSDCAA1,"pmsdcaaf"
          OPEN      PMSTEMA1,"pmstemaf"
          OPEN      PATLSDA1,"patlsdaf"
          OPEN      PATASDA1,"patasdaf"
          OPEN      PATHLFA1,"pathlfaf"
          OPEN      PATLDFA1,"patldfaf"
          OPEN      PATHDFA1,"pathdfaf"
          OPEN      PATAFEA1,"patafeaf"
          OPEN      PMSDIVA1,"pmsdivaf"
          OPEN      PMSDIVA2,"pmsdivaf"
.
          OPEN      PMSVMTA1,"pmsvmtaf"
          OPEN      PMSVSTA1,"pmsvstaf"
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      PATPRDA1,"patprdaf"     * CMBS Item and Provisional DRG
          TRAPCLR   IO
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      PATPRDA2,"patprdaf"     * CMBS Item and Provisional DRG
          TRAPCLR   IO
.
          READ      CONTROLF,ZERO;*43,IBCNMHOS
          READ      CONTROLF,HUND05;*158,PTCNDGPV
          READ      CONTROLF,TEN9;*212,CFEETYP
          READ      CONTROLF,HUND25;*238,PTCNNRTD
          READ      CONTROLF,HUND28;*105,PTCNUABF
.
          IF        IBCNMHOS=1
            OPEN      MLTCODA1,"mltcodaf"
            OPEN      MLTCODA2,"mltcodaf"
          ENDIF
.
          MOVE      ZERO,F2
          MOVE      PTCNNRTD,F2
          IF        F2 = 0
            MOVE      "10",PTCNNRTD
          ENDIF
.
          RETURN
.------------------------------------------------------------
. Clear Parameters
.------------------------------------------------------------
CLRPAR00  MOVE      ZERO,REPORTNO
          MOVE      SP70,TEMPLATE
          MOVE      ZERO,NORECORD
          MOVE      ZERO,STARTNUM
          MOVE      SP70,NEXTPAGE
          PACK      REDIRECT,SP70,SP70,SP70,SP70
          MOVE      SP70,STARTKEY
          MOVE      SP70,MBSITEMN
          MOVE      SP70,MBSEFFDT
          MOVE      SP70,UPDTTYPE
          MOVE      ZERO,VALDTYPE
          MOVE      SP70,VALDCODE
          MOVE      SP70,VALDNAME
          MOVE      SP70,KEYWORDS
          MOVE      SP70,FILEFLAG
          MOVE      SP70,COPYFLAG
          MOVE      SP70,CIDSDATE
          MOVE      SP70,HOSPCODE
.
          MOVE      SP70,PTITM001
          MOVE      SP70,PTITM002
          MOVE      SP70,PTITM003
          MOVE      SP70,PTITM002
          MOVE      SP70,PTITM003
          MOVE      ZERO,PTITM004
          MOVE      SP70,PTITM005
          MOVE      SP70,PTITM006
          MOVE      SP70,PTITM007
          MOVE      SP70,PTITM008
          MOVE      SP70,PTITM009
          MOVE      SP70,PTITM010
          MOVE      SP70,PTITM011
          MOVE      SP70,PTITM012
          MOVE      SP70,PTITM013
          MOVE      SP70,PTITM014
          MOVE      SP70,PTITM015
          MOVE      SP70,PTITM016
          MOVE      SP70,PTITM017
          MOVE      SP70,PTITM018
          MOVE      SP70,PTITM019
          MOVE      SP70,PTITM020
          MOVE      SP70,PTITM021
          MOVE      SP70,PTITM022
          MOVE      SP70,PTITM023
          MOVE      SP70,PTITM024
          MOVE      ZERO,PTITM025
          MOVE      SP70,PTITM026
          MOVE      SP70,PTITM027
          MOVE      ZERO,PTITM028
          MOVE      SP70,PTITM029
          MOVE      SP70,PTITM030
          MOVE      SP70,PTITM031
          MOVE      SP70,PTITM032
          MOVE      SP70,PTITM033
          MOVE      SP70,PTITM034
          MOVE      SP70,PTITM035
          MOVE      SP70,PTITM036
          MOVE      SP70,PTITM037
          MOVE      SP70,PTITM038
          MOVE      SP70,PTITM039
          MOVE      SP70,PTITM040
.
          MOVE      SP70,PTICO001
          PACK      PTICO002,SP70,SP70,SP70
          MOVE      SP70,PTICO003
          MOVE      SP70,PTICO004
          MOVE      SP70,PTICO005
          MOVE      ZERO,PTICO006
          MOVE      ZERO,PTICO007
          MOVE      SP70,PTICO008
          MOVE      ZERO,PTICO009
          MOVE      ZERO,PTICO010
          MOVE      SP70,PTICO011
          MOVE      SP70,PTICO012
          MOVE      SP70,PTICO013
          MOVE      SP70,PTICO014
          MOVE      SP70,PTICO015
          MOVE      SP70,PTICO016
          MOVE      SP70,PTICO017
          MOVE      ZERO,PTICO018
          MOVE      ZERO,PTICO019
          MOVE      SP70,PTICO020
          MOVE      ZERO,PTICO021
          MOVE      SP70,PTICO022
          MOVE      ZERO,PTICO023                                      *I-49037
          MOVE      ZERO,PTICO024                                     *I-105244
          MOVE      SP70,PTICO025
          MOVE      ZERO,PTICO026                                     *I-163918
          MOVE      ZERO,PTICO027                                     *I-219246
          MOVE      ZERO,PTICO028                                     *I-284420
          MOVE      ZERO,PTICO029                                     *I-311669
          MOVE      ZERO,PTICO030                                     *I-0833093
          MOVE      ZERO,PTICO031
          MOVE      ZERO,PTICO032                                     *I-0917793
          MOVE      SP70,PTICO033
          MOVE      ZERO,PTICO034                                     *I-0956210
.
          MOVE      SP70,PTICD001
          PACK      PTICD002,SP70,SP70,SP70
          MOVE      SP70,PTICD003
          MOVE      SP70,PTICD004
          MOVE      ZERO,PTICD005
          MOVE      ZERO,PTICD006
          MOVE      SP70,PTICD007
          MOVE      ZERO,PTICD008
          MOVE      ZERO,PTICD009
          MOVE      SP70,PTICD010
          MOVE      SP70,PTICD011
          MOVE      SP70,PTICD012
          MOVE      SP70,PTICD013
          MOVE      SP70,PTICD014
          MOVE      SP70,PTICD015
          MOVE      SP70,PTICD016
          MOVE      SP70,PTICD017
          MOVE      SP70,PTICD018
          MOVE      ZERO,PTICD019
          MOVE      ZERO,PTICD020
          MOVE      SP70,PTICD021
          MOVE      ZERO,PTICD022
          MOVE      SP70,PTICD023
          MOVE      ZERO,PTICD024                                      *I-49037
          MOVE      ZERO,PTICD025                                      *I-49037
          MOVE      ZERO,PTICD026                                     *I-105244
          MOVE      ZERO,PTICD027                                     *I-163918
          MOVE      ZERO,PTICD028                                     *I-219246
          MOVE      ZERO,PTICD029                                     *I-284420
          MOVE      ZERO,PTICD030                                     *I-311669
          MOVE      ZERO,PTICD031                                     *I-0833093
          MOVE      SP70,PTICD032
          MOVE      ZERO,PTICD033
          MOVE      ZERO,PTICD034                                     *I-0917793
          MOVE      ZERO,PTICD035                                     *I-0956210
          MOVE      SP70,PTICD036
.
          MOVE      SP70,PTHOS001  
          MOVE      SP70,PTHOS002  
          MOVE      SP70,PTHOS003  
          MOVE      SP70,PTHOS004  
          MOVE      SP70,PTHOS005  
          MOVE      SP70,PTHOS006  
          MOVE      SP70,PTHOS007  
.
          MOVE      SP70,PTLOC001  
          MOVE      SP70,PTLOC002  
          MOVE      SP70,PTLOC003  
.
          MOVE      SP70,PTLGA001
          MOVE      SP70,PTLGA002
.
          MOVE      SP70,PTLGP001
          MOVE      SP70,PTLGP002
.
          MOVE      SP70,PTNUR001
          MOVE      SP70,PTNUR002
          MOVE      SP70,PTNUR003
          MOVE      SP70,PTNUR004
          MOVE      SP70,PTNUR005
.
          MOVE      SP70,PTCTC001
          MOVE      SP70,PTCTC002
          MOVE      SP70,PTCTC003
.
          MOVE      SP70,PATCM001
          MOVE      SP70,PATCM002                                       
          MOVE      SP70,PATCM003                                        
          MOVE      ZERO,PATCM004                             
          MOVE      ZERO,PATCM005      
.
          MOVE      ZERO,PTCAN001
          MOVE      ZERO,PTCAN002
.
          MOVE      SP70,DRGCODES
          MOVE      SP70,PTDRG001 
          MOVE      SP70,PTDRG002 
          MOVE      SP70,PTDRG003 
          MOVE      ZERO,PTDRG004
          MOVE      ZERO,PTDRG005
          MOVE      ZERO,PTDRG006
          MOVE      SP70,PTDRG007
          MOVE      SP70,PTDRG008
          MOVE      SP70,PTDRG009
          MOVE      SP70,PTDRG010
.
          MOVE      SP70,GMBS0001
          MOVE      SP70,GMBS0002
          MOVE      SP70,GMBS0003
          MOVE      SP70,GMBS0004
          MOVE      SP70,GMBS0005
.
          MOVE      SP70,FVGRP001
          MOVE      SP70,FVGRP002
          MOVE      SP70,FVGRP003
          MOVE      SP70,FVGRP004
          MOVE      SP70,FVGRP005
          MOVE      SP70,FVGRP006
          MOVE      SP70,FVGRP007
          MOVE      SP70,FVGRP008
.
          MOVE      SP70,PTHSP001
          MOVE      SP70,PTHSP002
          MOVE      SP70,PTHSP003
          MOVE      SP70,PTHSP004
          MOVE      SP70,PTHSP005
          MOVE      SP70,PTHSP006
          MOVE      SP70,PTHSP007
          MOVE      SP70,PTHSP008
          MOVE      SP70,PTHSP009
          MOVE      SP70,PTHSP010
          MOVE      SP70,PTHSP011
          MOVE      SP70,PTHSP012
          MOVE      SP70,PTHSP013
          MOVE      ZERO,PTHSP014
          MOVE      SP70,PTHSP015
          MOVE      SP70,PTHSP016
          MOVE      SP70,PTHSP017
          MOVE      SP70,PTHSP018
          MOVE      ZERO,PTHSP019
          MOVE      SP70,PTHSP020
          MOVE      SP70,PTHSP021
          MOVE      SP70,PTHSP022
          MOVE      SP70,PTHSP023
          MOVE      SP70,PTHSP024
          MOVE      SP70,PTHSP025
          MOVE      SP70,PTHSP026
          MOVE      SP70,PTHSP027
          MOVE      SP70,PTHSP028
          MOVE      SP70,PTHSP029
          MOVE      SP70,PTHSP030
          MOVE      SP70,PTHSP031
          MOVE      SP70,PTHSP032
          MOVE      SP70,PTHSP033
          MOVE      SP70,PTHSP034
          MOVE      SP70,PTHSP035
          MOVE      SP70,PTHSP036
          MOVE      SP70,PTHSP037
          MOVE      SP70,PTHSP038
          MOVE      SP70,PTHSP039
          MOVE      SP70,PTHSP040
          MOVE      SP70,PTHSP041
          MOVE      SP70,PTHSP042
          MOVE      SP70,PTHSP043
          MOVE      SP70,PTHSP044
          PACK      PTHSP045,SP70,SP30
          MOVE      SP70,PTHSP046
          MOVE      SP70,PTHSP047
          MOVE      SP70,PTHSP048
          MOVE      SP70,PTHSP049
          MOVE      SP70,PTHSP050
          MOVE      SP70,PTHSP051
          MOVE      SP70,PTHSP052
          MOVE      SP70,PTHSP053
          MOVE      SP70,PTHSP054
          MOVE      SP70,PTHSP055
          MOVE      SP70,PTHSP056
          MOVE      SP70,PTHSP057
          MOVE      SP70,PTHSP058
.
          MOVE      Z70,PMCID001
          MOVE      Z70,PMCID002
          MOVE      Z70,PMCID003
          MOVE      Z70,PMCID004
          MOVE      Z70,PMCID005
          MOVE      Z70,PMCID006
          MOVE      Z70,PMCID007
          MOVE      SP70,OLDCONTR
.
          CALL      CPPMDI00                * divisions
          CALL      CPPMIU00                * HPI-O
.
          MOVE      ZERO,REMOTENO
.
CLRPAR99  RETURN
+
.------------------------------------------------------------
. Set Parameters
.------------------------------------------------------------
SETPAR00  MATCH     "reportno=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,REPORTNO
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "template=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,TEMPLATE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "nextpage=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,NEXTPAGE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "redirect=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,REDIRECT
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "startkey=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,STARTKEY
            PACK      STARTKEY,STARTKEY,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "norecord=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,NORECORD
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "startnum=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,STARTNUM
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "updttype=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,UPDTTYPE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "valdtype=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,VALDTYPE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "valdcode=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,VALDCODE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "valdname=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,VALDNAME
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "mbsitemn=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,MBSITEMN
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "mbseffdt=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,MBSEFFDT
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "keywords=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,KEYWORDS
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "fileflag=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,FILEFLAG
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "copyflag=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,COPYFLAG
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "hospcode=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,HOSPCODE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptitm",QRYNAME
          IF        @EQUAL
            CALL      STMBS000
            COMPARE   ZERO,EXIT
            GOTO      SETPAR99 IF EQUAL
          ENDIF
.
          MATCH     "ptico",QRYNAME
          IF        @EQUAL
            CALL      SICDS000
            COMPARE   ZERO,EXIT
            GOTO      SETPAR99 IF EQUAL
          ENDIF
.
          MATCH     "pticd",QRYNAME
          IF        @EQUAL
            CALL      SICDD000
            COMPARE   ZERO,EXIT
            GOTO      SETPAR99 IF EQUAL
          ENDIF
.
          MATCH     "pthos",QRYNAME
          IF        @EQUAL
            CALL      STHOS000
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptloc",QRYNAME
          IF        @EQUAL
            CALL      STLOC000
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptlga",QRYNAME
          IF        @EQUAL
            CALL      STLGA000
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptlgp",QRYNAME
          IF        @EQUAL
            CALL      STLGP000
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptnur",QRYNAME
          IF        @EQUAL
            CALL      STNUR000
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptctc",QRYNAME
          IF        @EQUAL
            CALL      STCTC000
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "patcm",QRYNAME
          IF        @EQUAL
            CALL      STCMC000
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptcan",QRYNAME
          IF        @EQUAL
            CALL      STCAN000
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "drgcodes=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,DRGCODES
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "drgversn=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,DRGVERZ 
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptdrg",QRYNAME
          IF        @EQUAL
            CALL      STDRG000
            COMPARE   ZERO,EXIT
            GOTO      SETPAR99 IF EQUAL
          ENDIF
.
          MATCH     "gmbs",QRYNAME
          IF        @EQUAL
            CALL      SGMBS000
            COMPARE   ZERO,EXIT
            GOTO      SETPAR99 IF EQUAL
          ENDIF
.
          MATCH     "fvgrp",QRYNAME
          IF        @EQUAL
            CALL      STFGP000
            COMPARE   ZERO,EXIT
            GOTO      SETPAR99 IF EQUAL
          ENDIF
.
          MATCH     "pthsp",QRYNAME
          IF        @EQUAL
            CALL      STHSP000
            COMPARE   ZERO,EXIT
            GOTO      SETPAR99 IF EQUAL
          ENDIF
.
          MATCH     "pmcid",QRYNAME
          IF        @EQUAL
            CALL      STCTR000
            COMPARE   ZERO,EXIT
            GOTO      SETPAR99 IF EQUAL
          ENDIF
.
          MATCH     "cidsdate=",QRYNAME
          IF        @EQUAL
            UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
            CALL      SETMTH00                *Set CMON from MTHNAM3
            PACK      CIDSDATE,CCENT,CYEAR,CMON,CDAY
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "oldcontr=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,OLDCONTR
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "pmdiv",QRYNAME
          IF        @EQUAL
            CALL      SPPMD000              * divisions
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "pmihu",QRYNAME
          IF        @EQUAL
            CALL      SPMIU000              * divisions
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptprd",QRYNAME
          IF        @EQUAL
            CALL      SPTPD000    * Provisional DRG & Weighted Value for CMBS
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "remoteno=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,REMOTENO
            GOTO      SETPAR99
          ENDIF
.
SETPAR99  RETURN
.-------------------------------------------------------------------------------
. Set Parameters for MBS Item Maintenance 
.-------------------------------------------------------------------------------
STMBS000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STMBS001,STMBS002,STMBS003,STMBS004,STMBS005:
                       STMBS006,STMBS007,STMBS008,STMBS009,STMBS010:
                       STMBS011,STMBS012,STMBS013,STMBS014,STMBS015:
                       STMBS016,STMBS017,STMBS018,STMBS019,STMBS020:
                       STMBS021,STMBS022,STMBS023,STMBS024,STMBS025:
                       STMBS026,STMBS027,STMBS028,STMBS029,STMBS030:
                       STMBS031,STMBS032,STMBS033,STMBS034,STMBS035:
                       STMBS036,STMBS037,STMBS038,STMBS039,STMBS040
.
          MOVE      ONE,EXIT
          GOTO      STMBS999
.
STMBS001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PTITM001
          PACK      PTITM001,PTITM001,SP70
          GOTO      STMBS999
STMBS002  MOVE      QRYDATA,PTITM002
          GOTO      STMBS999
STMBS003  MOVE      QRYDATA,PTITM003
          GOTO      STMBS999
STMBS004  MOVE      QRYDATA,PTITM004
          GOTO      STMBS999
STMBS005  MOVE      QRYDATA,PTITM005
          GOTO      STMBS999
STMBS006  MOVE      QRYDATA,PTITM006
          GOTO      STMBS999
STMBS007  MOVE      QRYDATA,PTITM007
          GOTO      STMBS999
STMBS008  MOVE      QRYDATA,PTITM008
          GOTO      STMBS999
STMBS009  MOVE      QRYDATA,PTITM009
          GOTO      STMBS999
STMBS010  MOVE      QRYDATA,PTITM010
          GOTO      STMBS999
STMBS011  MOVE      QRYDATA,PTITM011
          GOTO      STMBS999
STMBS012  MOVE      QRYDATA,PTITM012
          GOTO      STMBS999
STMBS013  MOVE      QRYDATA,PTITM013
          GOTO      STMBS999
STMBS014  MOVE      QRYDATA,PTITM014
          GOTO      STMBS999
STMBS015  MOVE      QRYDATA,PTITM015
          GOTO      STMBS999
STMBS016  MOVE      QRYDATA,PTITM016
          GOTO      STMBS999
STMBS017  MOVE      QRYDATA,PTITM017
          GOTO      STMBS999
STMBS018  MOVE      QRYDATA,PTITM018
          GOTO      STMBS999
STMBS019  MOVE      QRYDATA,PTITM019
          GOTO      STMBS999
STMBS020  MOVE      QRYDATA,PTITM020
          GOTO      STMBS999
STMBS021  MOVE      QRYDATA,PTITM021
          GOTO      STMBS999
STMBS022  MOVE      QRYDATA,PTITM022
          GOTO      STMBS999
STMBS023  MOVE      QRYDATA,PTITM023
          GOTO      STMBS999
STMBS024  MOVE      QRYDATA,PTITM024
          GOTO      STMBS999
STMBS025  MOVE      QRYDATA,PTITM025
          GOTO      STMBS999
STMBS026  MOVE      QRYDATA,PTITM026
          GOTO      STMBS999
STMBS027  MOVE      QRYDATA,PTITM027
          GOTO      STMBS999
STMBS028  MOVE      QRYDATA,PTITM028
          GOTO      STMBS999
STMBS029  MOVE      QRYDATA,PTITM029
          GOTO      STMBS999
STMBS030  MOVE      QRYDATA,PTITM030
          GOTO      STMBS999
STMBS031  MOVE      QRYDATA,PTITM031
          GOTO      STMBS999
STMBS032  MOVE      QRYDATA,PTITM032
          GOTO      STMBS999
STMBS033  MOVE      QRYDATA,PTITM033
          GOTO      STMBS999
STMBS034  MOVE      QRYDATA,PTITM034
          GOTO      STMBS999
STMBS035  MOVE      QRYDATA,PTITM035
          GOTO      STMBS999
STMBS036  MOVE      QRYDATA,PTITM036
          GOTO      STMBS999
STMBS037  MOVE      QRYDATA,PTITM037
          GOTO      STMBS999
STMBS038  MOVE      QRYDATA,PTITM038
          GOTO      STMBS999
STMBS039  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00            * Set CMON from MTHNAM3
          PACK      PTITM039,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,PTITM039
          IF        !@EQUAL
            REP       " 0",PTITM039
          ENDIF
          GOTO      STMBS999
STMBS040  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00            * Set CMON from MTHNAM3
          PACK      PTITM040,CCENT,CYEAR,CMON,CDAY
          MATCH     SP70,PTITM040
          IF        !@EQUAL
            REP       " 0",PTITM040
          ENDIF
          GOTO      STMBS999
.
STMBS999  RETURN
.-------------------------------------------------------------------------------
. Set Parameters for Global MBS Item Maintenance 
.-------------------------------------------------------------------------------
SGMBS000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SGMBS001,SGMBS002,SGMBS003,SGMBS004,SGMBS005
.
          MOVE      ONE,EXIT
          GOTO      STMBS999
.
SGMBS001  MOVE      QRYDATA,GMBS0001
          GOTO      SGMBS999
SGMBS002  MOVE      QRYDATA,GMBS0002
          GOTO      SGMBS999
SGMBS003  MOVE      QRYDATA,GMBS0003
          GOTO      SGMBS999
SGMBS004  MOVE      QRYDATA,GMBS0004
          GOTO      SGMBS999
SGMBS005  MOVE      QRYDATA,GMBS0005
          GOTO      SGMBS999
SGMBS999  RETURN
.
.------------------------------------------------------------------------------
. Set Parameters for global update function of preference tray and favourite
. charge item
.------------------------------------------------------------------------------
STFGP000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
.
          BRANCH    F3,STFGP001,STFGP002,STFGP003,STFGP004,STFGP005:
                       STFGP006,STFGP007,STFGP008
.
          MOVE      ONE,EXIT
          GOTO      STFGP999
.
STFGP001  MOVE      QRYDATA,FVGRP001
          PACK      FVGRP001,FVGRP001,SP70
          GOTO      STFGP999
.
STFGP002  MOVE      QRYDATA,FVGRP002
          PACK      FVGRP002,FVGRP002,SP70
          GOTO      STFGP999
.
STFGP003  MOVE      QRYDATA,FVGRP003
          PACK      FVGRP003,FVGRP003,SP70
          GOTO      STFGP999
.
STFGP004  MOVE      QRYDATA,FVGRP004
          PACK      FVGRP004,FVGRP004,SP70
          GOTO      STFGP999
.
STFGP005  MOVE      QRYDATA,FVGRP005
          PACK      FVGRP005,FVGRP005,SP70
          GOTO      STFGP999
.
STFGP006  MOVE      QRYDATA,FVGRP006
          PACK      FVGRP006,FVGRP006,SP70
          GOTO      STFGP999
.
STFGP007  MOVE      QRYDATA,FVGRP007
          PACK      FVGRP007,FVGRP007,SP70
          GOTO      STFGP999
.
STFGP008  MOVE      QRYDATA,FVGRP008
          PACK      FVGRP008,FVGRP008,SP70
          GOTO      STFGP999
.
STFGP999  RETURN
.
.-------------------------------------------------------------------------------
. Set Parameters for Hospital details Maintenance 
.-------------------------------------------------------------------------------
STHSP000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STHSP001,STHSP002,STHSP003,STHSP004,STHSP005:
                       STHSP006,STHSP007,STHSP008,STHSP009,STHSP010:
                       STHSP011,STHSP012,STHSP013,STHSP014,STHSP015:
                       STHSP016,STHSP017,STHSP018,STHSP019,STHSP020:
                       STHSP021,STHSP022,STHSP023,STHSP024,STHSP025:
                       STHSP026,STHSP027,STHSP028,STHSP029,STHSP030:
                       STHSP031,STHSP032,STHSP033,STHSP034,STHSP035:
                       STHSP036,STHSP037,STHSP038,STHSP039,STHSP040:
                       STHSP041,STHSP042,STHSP043,STHSP044,STHSP045:
                       STHSP046,STHSP047,STHSP048,STHSP049,STHSP050:
                       STHSP051,STHSP052,STHSP053,STHSP054,STHSP055:
                       STHSP056,STHSP057,STHSP058
.
          MOVE      ONE,EXIT
          GOTO      STHSP999
.
STHSP001  MOVE      QRYDATA,PTHSP001
          GOTO      STHSP999
.
STHSP002  MOVE      QRYDATA,PTHSP002
          GOTO      STHSP999
.
STHSP003  MOVE      QRYDATA,PTHSP003
          GOTO      STHSP999
.
STHSP004  MOVE      QRYDATA,PTHSP004
          GOTO      STHSP999
.
STHSP005  MOVE      QRYDATA,PTHSP005
          GOTO      STHSP999
.
STHSP006  MOVE      QRYDATA,PTHSP006
          GOTO      STHSP999
.
STHSP007  MOVE      QRYDATA,PTHSP007
          GOTO      STHSP999
.
STHSP008  MOVE      QRYDATA,PTHSP008
          GOTO      STHSP999
.
STHSP009  MOVE      QRYDATA,PTHSP009
          GOTO      STHSP999
.
STHSP010  MOVE      QRYDATA,PTHSP010
          GOTO      STHSP999
.
STHSP011  MOVE      QRYDATA,PTHSP011
          GOTO      STHSP999
.
STHSP012  MOVE      QRYDATA,PTHSP012
          GOTO      STHSP999
.
STHSP013  MOVE      QRYDATA,PTHSP013
          GOTO      STHSP999
.
STHSP014  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PTHSP014
          GOTO      STHSP999
.
STHSP015  MOVE      QRYDATA,PTHSP015
          GOTO      STHSP999
.
STHSP016  MOVE      QRYDATA,PTHSP016
          GOTO      STHSP999
.
STHSP017  MOVE      QRYDATA,PTHSP017
          GOTO      STHSP999
.
STHSP018  MOVE      QRYDATA,PTHSP018
          GOTO      STHSP999
.
STHSP019  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PTHSP019
          GOTO      STHSP999
.
STHSP020  MOVE      QRYDATA,PTHSP020
          GOTO      STHSP999
.
STHSP021  MOVE      QRYDATA,PTHSP021
          GOTO      STHSP999
.
STHSP022  MOVE      QRYDATA,PTHSP022
          GOTO      STHSP999
.
STHSP023  MOVE      QRYDATA,PTHSP023
          GOTO      STHSP999
.
STHSP024  MOVE      QRYDATA,PTHSP024
          GOTO      STHSP999
.
STHSP025  MOVE      QRYDATA,PTHSP025
          GOTO      STHSP999
.
STHSP026  MOVE      QRYDATA,PTHSP026
          GOTO      STHSP999
.
STHSP027  MOVE      QRYDATA,PTHSP027
          GOTO      STHSP999
.
STHSP028  MOVE      QRYDATA,PTHSP028
          GOTO      STHSP999
.
STHSP029  MOVE      QRYDATA,PTHSP029
          GOTO      STHSP999
.
STHSP030  MOVE      QRYDATA,PTHSP030
          GOTO      STHSP999
.
STHSP031  MOVE      QRYDATA,PTHSP031
          GOTO      STHSP999
.
STHSP032  MOVE      QRYDATA,PTHSP032
          GOTO      STHSP999
.
STHSP033  MOVE      QRYDATA,PTHSP033
          GOTO      STHSP999
.
STHSP034  MOVE      QRYDATA,PTHSP034
          GOTO      STHSP999
.
STHSP035  MOVE      QRYDATA,PTHSP035
          GOTO      STHSP999
.
STHSP036  MOVE      QRYDATA,PTHSP036
          GOTO      STHSP999
.
STHSP037  MOVE      QRYDATA,PTHSP037
          GOTO      STHSP999
.
STHSP038  MOVE      QRYDATA,PTHSP038
          GOTO      STHSP999
.
STHSP039  MOVE      QRYDATA,PTHSP039
          GOTO      STHSP999
.
STHSP040  MOVE      QRYDATA,PTHSP040
          GOTO      STHSP999
.
STHSP041  MOVE      QRYDATA,PTHSP041
          GOTO      STHSP999
.
STHSP042  MOVE      QRYDATA,PTHSP042
          GOTO      STHSP999
.
STHSP043  MOVE      QRYDATA,PTHSP043
          GOTO      STHSP999
.
STHSP044  MOVE      QRYDATA,PTHSP044
          GOTO      STHSP999
.
STHSP045  MOVE      QRYDATA,PTHSP045
          GOTO      STHSP999
.
STHSP046  MOVE      QRYDATA,PTHSP046
          GOTO      STHSP999
.
STHSP047  MOVE      QRYDATA,PTHSP047
          GOTO      STHSP999
.
STHSP048  MOVE      QRYDATA,PTHSP048
          GOTO      STHSP999
.
STHSP049  MOVE      QRYDATA,PTHSP049
          GOTO      STHSP999
.
STHSP050  MOVE      QRYDATA,PTHSP050
          GOTO      STHSP999
.
STHSP051  MOVE      QRYDATA,PTHSP051
          GOTO      STHSP999
.
STHSP052  MOVE      QRYDATA,PTHSP052
          GOTO      STHSP999
.
STHSP053  MOVE      QRYDATA,PTHSP053
          GOTO      STHSP999
.
STHSP054  MOVE      QRYDATA,PTHSP054
          GOTO      STHSP999
.
STHSP055  MOVE      QRYDATA,PTHSP055
          GOTO      STHSP999
.
STHSP056  MOVE      QRYDATA,PTHSP056
          GOTO      STHSP999
.
STHSP057  MOVE      QRYDATA,PTHSP057
          GOTO      STHSP999
.
STHSP058  MOVE      QRYDATA,PTHSP058
          GOTO      STHSP999
.
STHSP999  RETURN
.
.-------------------------------------------------------------------------------
. Set Parameters for ICD10 Operaitions/Procedure Maintenance 
.-------------------------------------------------------------------------------
SICDS000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SICDS001,SICDS002,SICDS003,SICDS004,SICDS005:
                       SICDS006,SICDS007,SICDS008,SICDS009,SICDS010:
                       SICDS011,SICDS012,SICDS013,SICDS014,SICDS015:
                       SICDS016,SICDS017,SICDS018,SICDS019,SICDS020:
                       SICDS021,SICDS022,SICDS023,SICDS024,SICDS025:
                       SICDS026,SICDS027,SICDS028,SICDS029,SICDS030:  *C-0833093
                       SICDS031,SICDS032,SICDS033,SICDS034            *C-0956210
.
          MOVE      ONE,EXIT
          GOTO      SICDS999
.
SICDS001  SQUEEZE   QRYDATA
          RESET     QRYDATA
          MATCH     SP70,QRYDATA
          GOTO      SICDS999 IF EQUAL   * Code is blank 
          MOVE      QRYDATA,PTICO001
          PACK      PTICO001,PTICO001,SP70
. Check for ICD9
          MATCH     "999",PTCNDGPV
          GOTO      SICDS999 IF EQUAL
.
          SCAN      "-",PTICO001
          GOTO      SICDS999 IF EQUAL   * Code already formated 
          MOVE      "-",KEY1
          UNPACK    PTICO001,KEY5,KEY4
          PACK      PTICO001,KEY5,KEY1,KEY4
          RESET     PTICO001
          GOTO      SICDS999
SICDS002  MOVE      QRYDATA,PTICO002
          GOTO      SICDS999
SICDS003  MOVE      QRYDATA,PTICO003
          GOTO      SICDS999
SICDS004  MOVE      QRYDATA,PTICO004
          GOTO      SICDS999
SICDS005  MOVE      QRYDATA,PTICO005
          GOTO      SICDS999
SICDS006  MOVE      QRYDATA,PTICO006
          GOTO      SICDS999
SICDS007  MOVE      QRYDATA,PTICO007
          GOTO      SICDS999
SICDS008  MOVE      QRYDATA,PTICO008
          GOTO      SICDS999
SICDS009  MOVE      QRYDATA,PTICO009
          GOTO      SICDS999
SICDS010  MOVE      QRYDATA,PTICO010
          GOTO      SICDS999
SICDS011  MOVE      QRYDATA,PTICO011
          GOTO      SICDS999
SICDS012  MOVE      QRYDATA,PTICO012
          GOTO      SICDS999
SICDS013  MOVE      QRYDATA,PTICO013
          GOTO      SICDS999
SICDS014  MOVE      QRYDATA,PTICO014
          GOTO      SICDS999
SICDS015  MOVE      QRYDATA,PTICO015
          GOTO      SICDS999
SICDS016  MOVE      QRYDATA,PTICO016
          GOTO      SICDS999
SICDS017  MOVE      QRYDATA,PTICO017
          GOTO      SICDS999
SICDS018  MOVE      QRYDATA,PTICO018
          GOTO      SICDS999
SICDS019  MOVE      QRYDATA,PTICO019
          GOTO      SICDS999
SICDS020  MOVE      QRYDATA,PTICO020
          GOTO      SICDS999
SICDS021  MOVE      QRYDATA,PTICO021
          GOTO      SICDS999
SICDS022  MOVE      QRYDATA,PTICO022
          GOTO      SICDS999
SICDS023  MOVE      QRYDATA,PTICO023                                   *I-49037
          GOTO      SICDS999                                           *I-49037
SICDS024  MOVE      QRYDATA,PTICO024                                  *I-105244
          GOTO      SICDS999                                          *I-105244
SICDS025  MOVE      QRYDATA,PTICO025
          GOTO      SICDS999
SICDS026  MOVE      QRYDATA,PTICO026                                  *I-163918
          GOTO      SICDS999
SICDS027  MOVE      QRYDATA,PTICO027                                  *I-219246
          GOTO      SICDS999
SICDS028  MOVE      QRYDATA,PTICO028                                  *I-284420
          GOTO      SICDS999
SICDS029  MOVE      QRYDATA,PTICO029                                  *I-311669
          GOTO      SICDS999
SICDS030  MOVE      QRYDATA,PTICO030                                  *I-0833093
          GOTO      SICDS999
SICDS031  MOVE      QRYDATA,PTICO031
          GOTO      SICDS999
SICDS032  MOVE      QRYDATA,PTICO032                                  *I-0917793
          GOTO      SICDS999
SICDS033  MOVE      QRYDATA,PTICO033
          GOTO      SICDS999
SICDS034  MOVE      QRYDATA,PTICO034                                  *I-0956210
          GOTO      SICDS999
.
SICDS999  RETURN
.-------------------------------------------------------------------------------
. Set Parameters for ICD10 Diagnosis/Diseases Maintenance 
.-------------------------------------------------------------------------------
SICDD000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SICDD001,SICDD002,SICDD003,SICDD004,SICDD005:
                       SICDD006,SICDD007,SICDD008,SICDD009,SICDD010:
                       SICDD011,SICDD012,SICDD013,SICDD014,SICDD015:
                       SICDD016,SICDD017,SICDD018,SICDD019,SICDD020:
                       SICDD021,SICDD022,SICDD023,SICDD024,SICDD025:   *C-49037
                       SICDD026,SICDD027,SICDD028,SICDD029,SICDD030:  *C-311669
                       SICDD031,SICDD032,SICDD033,SICDD034,SICDD035:  *C-0956210
                       SICDD036
.
          MOVE      ONE,EXIT
          GOTO      SICDD999
.
SICDD001  SQUEEZE   QRYDATA
          RESET     QRYDATA
          MATCH     SP70,QRYDATA
          GOTO      SICDD100 IF EQUAL   * Code is blank 
.
          MOVE      QRYDATA,PTICD001
          PACK      PTICD001,PTICD001,SP70          
          REP       UPPLOW,PTICD001
          SCAN      DOT,PTICD001
          GOTO      SICDD100 IF EQUAL       * Code already formatted
.
          SCAN      "/",PTICD001
          GOTO      SICDD100 IF EQUAL       * Code already formatted
.
. Check for ICD9
          MATCH     "999",PTCNDGPV
          GOTO      SICDD100 IF EQUAL
.
          UNPACK    PTICD001,KEY3,KEY6
          MATCH     SP6,KEY6
          GOTO      SICDD100 IF EQUAL       * Header code, dont format
.
          MOVE      PTICD001,KEY9
          UNPACK    PTICD001,KEY1,KEY8
          TYPE      KEY1
          IF        @EQUAL
            STRIP     KEY9
            MOVELPTR  KEY9,FORM2
            IF        FORM2>=5
              MOVE      "/",KEY1
              UNPACK    PTICD001,KEY4,KEY5
              PACK      PTICD001,ANSM,KEY4,KEY1,KEY5
            ENDIF
          ELSE
            STRIP     KEY9
            MOVELPTR  KEY9,FORM2
            IF        FORM2>=6
              MOVE      "/",KEY1
              UNPACK    PTICD001,KEY5,KEY4
              PACK      PTICD001,KEY5,KEY1,KEY4
            ELSE
              UNPACK    PTICD001,KEY3,KEY6
              PACK      PTICD001,KEY3,DOT,KEY6
            ENDIF
          ENDIF
.
SICDD100  RESET     PTICD001         
          GOTO      SICDD999
SICDD002  MOVE      QRYDATA,PTICD002
          GOTO      SICDD999
SICDD003  MOVE      QRYDATA,PTICD003
          GOTO      SICDD999
SICDD004  MOVE      QRYDATA,PTICD004
          GOTO      SICDD999
SICDD005  MOVE      QRYDATA,PTICD005
          GOTO      SICDD999
SICDD006  MOVE      QRYDATA,PTICD006
          GOTO      SICDD999
SICDD007  MOVE      QRYDATA,PTICD007
          GOTO      SICDD999
SICDD008  MOVE      QRYDATA,PTICD008
          GOTO      SICDD999
SICDD009  MOVE      QRYDATA,PTICD009
          GOTO      SICDD999
SICDD010  MOVE      QRYDATA,PTICD010
          GOTO      SICDD999
SICDD011  MOVE      QRYDATA,PTICD011
          GOTO      SICDD999
SICDD012  MOVE      QRYDATA,PTICD012
          GOTO      SICDD999
SICDD013  MOVE      QRYDATA,PTICD013
          GOTO      SICDD999
SICDD014  MOVE      QRYDATA,PTICD014
          GOTO      SICDD999
SICDD015  MOVE      QRYDATA,PTICD015
          GOTO      SICDD999
SICDD016  MOVE      QRYDATA,PTICD016
          GOTO      SICDD999
SICDD017  MOVE      QRYDATA,PTICD017
          GOTO      SICDD999
SICDD018  MOVE      QRYDATA,PTICD018
          GOTO      SICDD999
SICDD019  MOVE      QRYDATA,PTICD019
          GOTO      SICDD999
SICDD020  MOVE      QRYDATA,PTICD020
          GOTO      SICDD999
SICDD021  MOVE      QRYDATA,PTICD021
          GOTO      SICDD999
SICDD022  MOVE      QRYDATA,PTICD022
          GOTO      SICDD999
SICDD023  MOVE      QRYDATA,PTICD023
          GOTO      SICDD999
SICDD024  MOVE      QRYDATA,PTICD024                                   *I-49037
          GOTO      SICDD999                                           *I-49037
SICDD025  MOVE      QRYDATA,PTICD025                                   *I-49037
          GOTO      SICDD999                                           *I-49037
SICDD026  MOVE      QRYDATA,PTICD026                                  *I-105244
          GOTO      SICDD999
SICDD027  MOVE      QRYDATA,PTICD027                                  *I-163918
          GOTO      SICDD999
SICDD028  MOVE      QRYDATA,PTICD028                                  *I-219246
          GOTO      SICDD999
SICDD029  MOVE      QRYDATA,PTICD029                                  *I-284420
          GOTO      SICDD999
SICDD030  MOVE      QRYDATA,PTICD030                                  *I-311669
          GOTO      SICDD999
SICDD031  MOVE      QRYDATA,PTICD031                                  *I-0833093
          GOTO      SICDD999
SICDD032  MOVE      QRYDATA,PTICD032
          GOTO      SICDD999
SICDD033  MOVE      QRYDATA,PTICD033
          GOTO      SICDD999
SICDD034  MOVE      QRYDATA,PTICD034                                  *I-0917793
          GOTO      SICDD999
SICDD035  MOVE      QRYDATA,PTICD035                                  *I-0956210
          GOTO      SICDD999
SICDD036  MOVE      QRYDATA,PTICD036
          GOTO      SICDD999
.
SICDD999  RETURN
.-------------------------------------------------------------------------------
. Option 4 : Set Parameters for Hospital File Maintenance 
.-------------------------------------------------------------------------------
STHOS000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STHOS001,STHOS002,STHOS003,STHOS004,STHOS005,STHOS006:
                       STHOS007
.
          MOVE      ONE,EXIT
          GOTO      STHOS999
.
STHOS001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PTHOS001
          PACK      PTHOS001,PTHOS001,SP70
          GOTO      STHOS999
STHOS002  MOVE      QRYDATA,PTHOS002
          GOTO      STHOS999
STHOS003  MOVE      QRYDATA,PTHOS003
          GOTO      STHOS999
STHOS004  MOVE      QRYDATA,PTHOS004
          GOTO      STHOS999
STHOS005  MOVE      QRYDATA,PTHOS005
          GOTO      STHOS999
STHOS006  MOVE      QRYDATA,PTHOS006
          GOTO      STHOS999
STHOS007  MOVE      QRYDATA,PTHOS007
          GOTO      STHOS999
.
STHOS999  RETURN
.-------------------------------------------------------------------------------
. Option 5 : Set Parameters for Hospital Data File Locations   
.-------------------------------------------------------------------------------
STLOC000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STLOC001,STLOC002,STLOC003
.
          MOVE      ONE,EXIT
          GOTO      STLOC999
.
STLOC001  MOVE      QRYDATA,PTLOC001
          GOTO      STLOC999
STLOC002  MOVE      QRYDATA,PTLOC002
          GOTO      STLOC999
STLOC003  MOVE      QRYDATA,PTLOC003
          GOTO      STLOC999
.
STLOC999  RETURN
.-------------------------------------------------------------------------------
. Option 6 : Set Parameters for LGA Code Maintanance
.-------------------------------------------------------------------------------
STLGA000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STLGA001,STLGA002
.
          MOVE      ONE,EXIT
          GOTO      STLGA999
.
STLGA001  MOVE      QRYDATA,PTLGA001
          GOTO      STLGA999
.
STLGA002  MOVE      QRYDATA,PTLGA002
          GOTO      STLGA999
.
STLGA999  RETURN
.-------------------------------------------------------------------------------
. Option 7 : Set Parameters for Nursing Station Maintanance
.-------------------------------------------------------------------------------
STNUR000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STNUR001,STNUR002,STNUR003,STNUR004,STNUR005
.
          MOVE      ONE,EXIT
          GOTO      STNUR999
.
STNUR001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PTNUR001
          PACK      PTNUR001,PTNUR001,SP70
          GOTO      STNUR999
STNUR002  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PTNUR002
          PACK      PTNUR002,PTNUR002,SP70
          GOTO      STNUR999
STNUR003  MOVE      QRYDATA,PTNUR003
          GOTO      STNUR999
STNUR004  MOVE      QRYDATA,PTNUR004
          GOTO      STNUR999
STNUR005  MOVE      QRYDATA,PTNUR005
          GOTO      STNUR999
.
STNUR999  RETURN
.-------------------------------------------------------------------------------
. Option 9 : Set Parameters for LGA Post Code Maintanance
.-------------------------------------------------------------------------------
STLGP000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STLGP001,STLGP002
.
          MOVE      ONE,EXIT
          GOTO      STLGP999
.
STLGP001  MOVE      QRYDATA,PTLGP001
          PACK      PTLGP001,PTLGP001,SP70
          GOTO      STLGP999
.
STLGP002  MOVE      QRYDATA,PTLGP002
          PACK      PTLGP002,PTLGP002,SP70
          GOTO      STLGP999
.
STLGP999  RETURN
.-------------------------------------------------------------------------------
. Option 10 : Set Parameters for Catchment Code Maintanance
.-------------------------------------------------------------------------------
STCTC000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STCTC001,STCTC002,STCTC003
.
          MOVE      ONE,EXIT
          GOTO      STCTC999
.
STCTC001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PTCTC001
          PACK      PTCTC001,PTCTC001,SP70
          GOTO      STCTC999
.
STCTC002  MOVE      QRYDATA,PTCTC002
          GOTO      STCTC999
.
STCTC003  MOVE      QRYDATA,PTCTC003
          GOTO      STCTC999
.
STCTC999  RETURN
.-------------------------------------------------------------------------------
. Option 11 : Set Parameters for Casemix Code Table Maintanance
.-------------------------------------------------------------------------------
STCMC000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STCMC001,STCMC002,STCMC003,STCMC004,STCMC005
.
          MOVE      ONE,EXIT
          GOTO      STCTC999
.
STCMC001  MOVE      QRYDATA,PATCM001
          PACK      PATCM001,PATCM001,SP70
          GOTO      STCMC999
.
STCMC002  MOVE      QRYDATA,PATCM002
          GOTO      STCMC999
.
STCMC003  MOVE      QRYDATA,PATCM003
          GOTO      STCMC999
.
STCMC004  MOVE      QRYDATA,PATCM004
          GOTO      STCMC999
.
STCMC005  MOVE      QRYDATA,PATCM005
          GOTO      STCMC999
.
STCMC999  RETURN
.
.-------------------------------------------------------------------------------
. Option 12 : Set Parameters for DRG Code Table Maintanance
.-------------------------------------------------------------------------------
STDRG000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STDRG001,STDRG002,STDRG003,STDRG004,STDRG005:
                       STDRG006,STDRG007,STDRG008,STDRG009,STDRG010
.
          MOVE      ONE,EXIT
          GOTO      STDRG999
.
STDRG001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PTDRG001
          PACK      PTDRG001,PTDRG001,SP70
          GOTO      STDRG999
.
STDRG002  MOVE      QRYDATA,PTDRG002
          GOTO      STDRG999
.
STDRG003  MOVE      QRYDATA,PTDRG003
          GOTO      STDRG999
.
STDRG004  MOVE      QRYDATA,PTDRG004
          GOTO      STDRG999
.
STDRG005  MOVE      QRYDATA,PTDRG005
          GOTO      STDRG999
.
STDRG006  MOVE      QRYDATA,PTDRG006
          GOTO      STDRG999
.
STDRG007  MOVE      QRYDATA,PTDRG007
          GOTO      STDRG999
.
STDRG008  MOVE      QRYDATA,PTDRG008
          GOTO      STDRG999
.
STDRG009  MOVE      QRYDATA,PTDRG009
          GOTO      STDRG999
.
STDRG010  MOVE      QRYDATA,PTDRG010
          GOTO      STDRG999
.
STDRG999  RETURN
.
.-------------------------------------------------------------------------------
. Option 26 : Set Parameters for Contract ID Maintanance
.-------------------------------------------------------------------------------
STCTR000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STCTR001,STCTR002,STCTR003,STCTR004,STCTR005:
                       STCTR006,STCTR007
.
          MOVE      ONE,EXIT
          GOTO      STCTR999
.
STCTR001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PMCID001
          PACK      PMCID001,PMCID001,SP70
          GOTO      STCTR999
.
STCTR002  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMCID002,CCENT,CYEAR,CMON,CDAY
          GOTO      STCTR999
.
STCTR003  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMCID003,CCENT,CYEAR,CMON,CDAY
          GOTO      STCTR999
.
STCTR004  MOVE      QRYDATA,PMCID004
          GOTO      STCTR999
.
STCTR005  MOVE      QRYDATA,PMCID005
          GOTO      STCTR999
.
STCTR006  MOVE      QRYDATA,PMCID006
          GOTO      STCTR999
.
STCTR007  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      PMCID007,CCENT,CYEAR,CMON,CDAY
          GOTO      STCTR999
.
STCTR999  RETURN
+
.------------------------------------------------------------
. MBS Item Coding Maintenance: Display,Add,Update,Delete
.------------------------------------------------------------
PMBSGR00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      PMBSGR40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      PMBSGR10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      PMBSGR20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      PMBSGR30 IF EQUAL
.
          MATCH     "C",UPDTTYPE    * Global Create New MBS/Item file         
          GOTO      PMBSGR50 IF EQUAL
.
          MATCH     "P",UPDTTYPE    * Global Percentage increase of Fees
          GOTO      PMBSGR50 IF EQUAL
.
          MATCH     "M",UPDTTYPE    * Global Allocate Misc Item Group   
          GOTO      PMBSGR50 IF EQUAL
.
          MATCH     "S",UPDTTYPE    * Global Allocate Suggested Class.  
          GOTO      PMBSGR50 IF EQUAL
.
          MATCH     "T",UPDTTYPE    * Global Allocate Theatre Class.  
          GOTO      PMBSGR50 IF EQUAL
.
          MATCH     "B",UPDTTYPE    * Global Duplicate Theatre Class. Banding
          GOTO      PMBSGR50 IF EQUAL
.
          MATCH     "X",UPDTTYPE    * Global Update MBS/Item file            
          GOTO      PMBSGR50 IF EQUAL
.
          MATCH     "R",UPDTTYPE    * Global Regenerating MBS Keywords       
          GOTO      PMBSGR50 IF EQUAL
.
          MATCH     "L",UPDTTYPE    * Global Load MBS/Item from ASCII file   
          GOTO      PMBSGR50 IF EQUAL
.
          MATCH     "E",UPDTTYPE    * Global Load MBS/Item from XML file
          GOTO      PMBSGR50 IF EQUAL
.
          GOTO      PMBSGR93
.
PMBSGR10  CALL      CHKMBS00  * Checks mandatory fields & checks for blank
          BRANCH    EXIT,PMBSGR99
.
          PACK      VALFDATE,PTITM039,SP70
          PACK      VALTDATE,PTITM040,SP70
          PACK      KEY17,PTITM001,PTITM039,SP70
          CALL      VIDT0000               * Validate effective dates
          BRANCH    EXIT,PMBSGR95
.
          PACK      KEY17,PTITM001,PTITM039,SP70  * ADD FORMACTION
          CALL      RDITEM1        * read patitemn
          COMPARE   ZERO,OVRCD
          GOTO      PMBSGR92 IF EQUAL
          CALL      MBSSAV00       * Moves input variables to file variables
.
          CALL      IBACLOCK
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          MOVE      CURRDATE,PTITCDAT       * date record created
          MOVE      CTIMEIS,PTITCTIM        * time record created
          MOVE      USERID,PTITCUID         * web user created
.
          CALL      WRITEM1        * Writes away the data to patitemn
          PROC      PATIKIUP       * Update Keyword table
.
          CALL      EDAT0000       * Auto populate prev item end date
.
...          BRANCH    CAUDI,PMBSGR15  * 1 = Audits not required
...          MOVE      "A",ACTION    * ACTION variable  
...          CALL      UPIAUD
.
          COMPARE   ONE,WARNFLAG
          IF        @EQUAL
            CALL      WEBWAR00         * Display Warning
          ENDIF
.
PMBSGR15  MOVE      ZERO,EXIT
          GOTO      PMBSGR99
.
PMBSGR20  PACK      VALFDATE,PTITM039,SP70
          PACK      VALTDATE,PTITM040,SP70
          PACK      KEY17,PTITM001,PTITM039,SP70
          CALL      VIDT0000               * Validate effective dates
          BRANCH    EXIT,PMBSGR95
.
          PACK      KEY17,PTITM001,PTITM039,SP70  * UPDATE FORMACTION
          CALL      RDITEM1        * read patitemn
          BRANCH    OVRCD,PMBSGR91
          CALL      CHKMBS00      * Checks mandatory fields
          BRANCH    EXIT,PMBSGR99
          CALL      MBSSAV00      * Moves input variables to file variables
.
          CALL      IBACLOCK
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          MOVE      CURRDATE,PTITUDAT       * date record updated
          MOVE      CTIMEIS,PTITUTIM        * time record updated
          MOVE      USERID,PTITUUID         * web user updated
.
          CALL      UPITEM1       * Writes away the data
          PROC      PATIKIUP      * Update Key word Table
.
...          BRANCH    CAUDI,PMBSGR25 * 1 = Audits not required
...          MOVE      "B",ACTION    * Before changes 
...          CALL      UPIAUDX
...          MOVE      "C",ACTION    * ACTION variable after changes
...          CALL      UPIAUD
.
          COMPARE   ONE,WARNFLAG
          IF        @EQUAL
            CALL      WEBWAR00         * Display Warning
          ENDIF
.
PMBSGR25  MOVE      ZERO,EXIT
          GOTO      PMBSGR99
.
PMBSGR30  PACK      KEY17,PTITM001,PTITM039,SP70   * DELETE FORMACTION
          CALL      RDITEM1        * read patitemn
          BRANCH    OVRCD,PMBSGR91
          CALL      DEITEM1       * Deletes the data
.         PROC      PATIKIUP      * Update Key word Table
...          BRANCH    CAUDI,PMBSGR35 * 1 = Audits not required
...          MOVE      "D",ACTION    * ACTION variable after delete 
...          CALL      UPIAUD
.
PMBSGR35  MOVE      ZERO,EXIT
          GOTO      PMBSGR99
.
.      Display
.
PMBSGR40  MOVE      ZERO,EXIT
          MATCH     "5",TEMPLATE
          IF        @EQUAL
            CALL      LCKMB000               * check if locked
            BRANCH    EXIT,PMBSGR99
          ENDIF
.
          PACK      PTITM001,MBSITEMN,SP70 * CGI parameter from table  
          PACK      PTITM039,MBSEFFDT,SP70 * Effective from date
          PACK      KEY17,PTITM001,PTITM039,SP70
          CALL      RDITEM1
          IF        OVRCD=1
            CALL      CLRMBS00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          IF        CFEETYP=5
            APPEND    "Procedure Item Maintenance",WEBTITLE
          ELSE
            APPEND    "MBS Item Maintenance",WEBTITLE
          ENDIF
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PMBSGR99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      PMBSGR99
.
PMBSGR50  CALL      GLMBS000
          GOTO      PMBSGR99
.
PMBSGR91  MOVE      "Item No. does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PMBSGR99
.
PMBSGR92  MOVE      "Item No. exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PMBSGR99
.
PMBSGR93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PMBSGR99
.
PMBSGR95  MOVE      "Invalid Effective From/To Date (Overlap).",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PMBSGR99
.
PMBSGR99  RETURN
+
.-----------------------------------------------------------------
. Auto populate the previous misc items effective to date if blank
.-----------------------------------------------------------------
EDAT0000  PACK      KEY17,PTITM001,PTITM039,SP70  * ADD FORMACTION
          CALL      RDSITEM1
          CALL      RDPITEM1
          BRANCH    OVRCD,EDAT9999
.
          MATCH     PTITM001,ITEMNO
          GOTO      EDAT9999 IF NOT EQUAL
.
          MATCH     SP70,PTITETDT                * Exit if effective to date is
          GOTO      EDAT9999 IF NOT EQUAL        * already populated
.
          MOVE      PTITM039,WORKDATE
          SUB       ONE,WORKDATE
          MOVE      WORKDATE,PTITETDT
.
          CALL      IBACLOCK
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          MOVE      CURRDATE,PTITUDAT       * date record updated
          MOVE      CTIMEIS,PTITUTIM        * time record updated
          MOVE      USERID,PTITUUID         * web user updated
.
          CALL      UPITEM1
.
EDAT9999  RETURN
+
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRMBS00  MOVE      SP70,ITEMNO  
          MOVE      SP70,IALPHA    
          MOVE      SP70,IDESC     
          MOVE      ZERO,QIAMT   
          MOVE      SP70,IMISGRP    
          MOVE      SP70,ICLSS      
          MOVE      SP70,IBAND1     
          MOVE      SP70,IBAND2     
          MOVE      SP70,IBAND3     
          MOVE      SP70,IBAND4    
          MOVE      SP70,IBAND5    
          MOVE      SP70,IBAND6    
          MOVE      SP70,IBAND7    
          MOVE      SP70,IBAND8    
          MOVE      SP70,IBAND9    
          MOVE      SP70,IBAND10   
          MOVE      SP70,IBAND11   
          MOVE      SP70,IBAND12  
          MOVE      SP70,IBAND13   
          MOVE      SP70,IBAND14  
          MOVE      SP70,IBAND15   
          MOVE      SP70,IBAND16   
          MOVE      SP70,PTITACTV  
          MOVE      SP70,PTITLINK  
          MOVE      ZERO,PTITEXCL  
          MOVE      SP70,PTITIWRN  
          MOVE      SP70,PTITDCSC
          MOVE      ZERO,PTITGSTA
          MOVE      SP70,PTITGSTC
          MOVE      SP70,PTITDESC
          MOVE      SP70,PTITTCER
          MOVE      SP70,PTITMSCH
          MOVE      SP70,PTITTCCD
          MOVE      SP70,PTITSERV
          MOVE      SP70,PTITECEQ
          MOVE      SP70,PTITECTS
          MOVE      SP70,PTITLWRD
          MOVE      SP70,PTITTACB
          MOVE      SP70,PTITEFDT   * Effective from Date (CCYYMMDD)
          MOVE      SP70,PTITETDT   * Effective to Date (CCYYMMDD)
          MOVE      SP70,PTITCDAT   * Date record created (CCYYMMDD)
          MOVE      SP70,PTITCTIM   * Time record created (hh:mm:ss)
          MOVE      SP70,PTITCUID   * Record created by (websecaf)
          MOVE      SP70,PTITUDAT   * Date record updated (CCYYMMDD)
          MOVE      SP70,PTITUTIM   * Time record updated (hh:mm:ss)
          MOVE      SP70,PTITUUID   * Record updated by (websecaf)
          MOVE      SP70,PTITSPAR
. Spare Variables 
          MOVE      SP70,SITEMNO  
          MOVE      SP70,SIALPHA    
          MOVE      SP70,SIDESC     
          MOVE      ZERO,SIAMT   
          MOVE      SP70,SIMISGRP    
          MOVE      SP70,SICLSS      
          MOVE      SP70,SIBAND1     
          MOVE      SP70,SIBAND2     
          MOVE      SP70,SIBAND3     
          MOVE      SP70,SIBAND4    
          MOVE      SP70,SIBAND5    
          MOVE      SP70,SIBAND6    
          MOVE      SP70,SIBAND7    
          MOVE      SP70,SIBAND8    
          MOVE      SP70,SIBAND9    
          MOVE      SP70,SIBAND10   
          MOVE      SP70,SIBAND11   
          MOVE      SP70,SIBAND12  
          MOVE      SP70,SIBAND13   
          MOVE      SP70,SIBAND14  
          MOVE      SP70,SIBAND15   
          MOVE      SP70,SIBAND16   
          MOVE      SP70,SPTITACT  
          MOVE      SP70,SPTITLIN  
          MOVE      ZERO,SPTITEXC  
          MOVE      SP70,SPTITIWR  
          MOVE      ZERO,IAMT 
.
CLRMBS99  RETURN
.------------------------------------------------------------
. Moves cgi variables into file variables
.------------------------------------------------------------
MBSSAV00  PACK      KEY17,PTITM001,PTITM039
          MOVE      PTITM001,KEY9
          SQUEEZE   KEY9
          PACK      KEY9,KEY9,SP70
          MOVE      KEY9,ITEMNO
          MOVE      PTITM002,KEY6
          SQUEEZE   KEY6
          MOVE      KEY6,IALPHA
          MOVE      PTITM005,IMISGRP
          MATCH     SP70,PTITM023
          IF        @EQUAL
            MOVE      "I",PTITACTV
          ELSE
            MOVE      " ",PTITACTV
          ENDIF
          MOVE      PTITM030,IDESC
          MOVE      PTITM030,PTITDESC
          MOVE      PTITM039,PTITEFDT       * Effective fromdate
          MOVE      PTITM040,PTITETDT       * Effective todate
.
          COMPARE   FIVE,CFEETYP            * NZ Private billing
          GOTO      MBSSAV99 IF EQUAL
.
          PACK      IDESC,PTITM003,SP70
          PACK      PTITDESC,PTITM003,SP70
          MOVE      PTITM004,QIAMT         
          MOVE      PTITM006,ICLSS
          MOVE      PTITM007,IBAND1
          MOVE      PTITM008,IBAND2  
          MOVE      PTITM009,IBAND3
          MOVE      PTITM010,IBAND4
          MOVE      PTITM011,IBAND5
          MOVE      PTITM012,IBAND6
          MOVE      PTITM013,IBAND7
          MOVE      PTITM014,IBAND8
          MOVE      PTITM015,IBAND9
          MOVE      PTITM016,IBAND10
          MOVE      PTITM017,IBAND11
          MOVE      PTITM018,IBAND12
          MOVE      PTITM019,IBAND13
          MOVE      PTITM020,IBAND14
          MOVE      PTITM021,IBAND15
          MOVE      PTITM022,IBAND16
.
          MOVE      PTITM024,PTITLINK

          COMPARE   ZERO,PTITM025
          IF        @EQUAL
            MOVE      "2",PTITEXCL
          ELSE
            MOVE    PTITM025,PTITEXCL
          ENDIF
.
          MATCH     SP70,PTITM026
          IF        @EQUAL
            MOVE      "2",PTITIWRN
          ELSE
            MOVE    PTITM026,PTITIWRN
          ENDIF
.
          MOVE      PTITM027,PTITDCSC
          MOVE      PTITM028,PTITGSTA
          MOVE      PTITM029,PTITGSTC
          MOVE      PTITM031,PTITTCER
          MOVE      PTITM032,PTITMSCH
          MOVE      PTITM033,PTITTCCD
          MOVE      PTITM034,PTITSERV
          PACK      PTITECEQ,PTITM035,SP70
          PACK      PTITECTS,PTITM036,SP70
          MOVE      PTITM037,PTITLWRD
          MOVE      PTITM038,PTITTACB
          MOVE      PTITM039,PTITEFDT
          MOVE      PTITM040,PTITETDT
.
. Spare Variables 
          MOVE      SP70,SITEMNO  
          MOVE      SP70,SIALPHA    
          MOVE      SP70,SIDESC     
          MOVE      ZERO,SIAMT   
          MOVE      SP70,SIMISGRP    
          MOVE      SP70,SICLSS      
          MOVE      SP70,SIBAND1     
          MOVE      SP70,SIBAND2     
          MOVE      SP70,SIBAND3     
          MOVE      SP70,SIBAND4    
          MOVE      SP70,SIBAND5    
          MOVE      SP70,SIBAND6    
          MOVE      SP70,SIBAND7    
          MOVE      SP70,SIBAND8    
          MOVE      SP70,SIBAND9    
          MOVE      SP70,SIBAND10   
          MOVE      SP70,SIBAND11   
          MOVE      SP70,SIBAND12  
          MOVE      SP70,SIBAND13   
          MOVE      SP70,SIBAND14  
          MOVE      SP70,SIBAND15   
          MOVE      SP70,SIBAND16   
          MOVE      SP70,SPTITACT  
          MOVE      SP70,SPTITLIN  
          MOVE      ZERO,SPTITEXC  
          MOVE      SP70,SPTITIWR  
.
MBSSAV99  RETURN
.------------------------------------------------------------------
. * Checks mandatory fields and checks for blank
.------------------------------------------------------------------
CHKMBS00  MOVE      ZERO,WARNFLAG           * Initialize Warning variables
          PACK      WARNTEXT,SP70,SP70
.
          RESET     PTITM001
          MATCH     SP70,PTITM001
          GOTO      CHKMBS90 IF EQUAL
.
.          RESET     PTITM002
.          MATCH     SP70,PTITM002
.          GOTO      CHKMBS91 IF EQUAL
.
          MATCH     SP70,PTITM039           * Effective Fromdate
          GOTO      CHKMBS94 IF EQUAL
.
          RESET     PTITM003
          MATCH     SP70,PTITM003
          IF        @EQUAL
            MATCH     SP70,PTITM030
            GOTO      CHKMBS92 IF EQUAL
          ENDIF
.
          RESET     PTITM023
          MATCH     SP70,PTITM023
          IF        @EQUAL
            RESET     PTITM024
            MATCH     SP70,PTITM024
            GOTO      CHKMBS93 IF NOT EQUAL
          ENDIF
.
          GOTO      CHKMBS98
.
CHKMBS90  MOVE      "MBS Item No. is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKMBS99
.
CHKMBS91  MOVE      "MBS Alpha Key is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKMBS99
.
CHKMBS92  MOVE      "Description is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKMBS99
.
CHKMBS93  MOVE      "Warning Linked item exists for an inactive item!",WARNTEXT
          MOVE      ONE,WARNFLAG
          GOTO      CHKMBS98
.
CHKMBS94  MOVE      "Effective From Date is mandatory!",WARNTEXT
          MOVE      ONE,WARNFLAG
          GOTO      CHKMBS98
.
CHKMBS98  MOVE      ZERO,EXIT
CHKMBS99  RETURN
.------------------------------------------------------------
. Global MBS Maintenance                                        
.------------------------------------------------------------
GLMBS000  MOVE      ZERO,EXIT
          PACK      SCHDDATE,CCC,CYY,CMM,CDD
          REP       " 0",SCHDDATE
          CLOCK     TIME,SCHDTIME
.
          MATCH     "R",UPDTTYPE    * Global Regenerate MBS Keyword Index
          GOTO      GLMBS160 IF EQUAL
.
          MATCH     "L",UPDTTYPE    * Global Load MBS/Item from ASCII file
          GOTO      GLMBS180 IF EQUAL
.
          MATCH     "E",UPDTTYPE    * Global Load MBS/Item from XML file
          GOTO      GLMBS190 IF EQUAL
.
          GOTO      GLMBS920
.
GLMBS160  MOVE      "IBAPAT14",SCHDPGID
          CALL      MBSREG00
          GOTO      GLMBS500
.
GLMBS180  MOVE      "IBAPAT14",SCHDPGID
          CALL      MBSLAF00
          BRANCH    EXIT,GLMBS999
          GOTO      GLMBS500
.
GLMBS190  MOVE      "IBAPAT14",SCHDPGID
          CALL      MBSLAF00
          BRANCH    EXIT,GLMBS999
          GOTO      GLMBS500
.
GLMBS500  CALL      SCHPRO00                * Schedule Extract
          GOTO      GLMBS999
.
GLMBS920  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      GLMBS999
.
GLMBS999  RETURN
+
.--------------------------------------------------------------------------
. Check if Locked - MBS Item Maintenance
.--------------------------------------------------------------------------
LCKMB000  READ      CONTROLF,SEVENTY9;*21,PTCNITMM
          READ      CONTROLF,HUND10;*51,PTCNWITM
.
          MATCH     SP10,PTCNWITM             * check if web locked
          GOTO      LCKMB990 IF EQUAL
.
          PACK      KEY10,PTCNWITM,SP10
          CALL      RDWBSE1
          BRANCH    OVRCD,LCKMB100
          GOTO      LCKMB200 
.
LCKMB100  MOVE      "Unknown User",WBSENAM
.
LCKMB200  SQUEEZE   PTCNWITM
          CLEAR     FORMATNM
          APPEND    PTCNWITM,FORMATNM
          APPEND    " - ",FORMATNM
          APPEND    WBSENAM,FORMATNM
          RESET     FORMATNM
.
          CLEAR     WEBTITLE
          APPEND    "MBS Item Maintanence locked by ",WEBTITLE
          APPEND    FORMATNM,WEBTITLE
          RESET     WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      LCKMB999
.
LCKMB990  MOVE      ZERO,EXIT
          PACK      PTCNWITM,USERID,SP10
          WRITAB    CONTROLF,HUND10;*51,PTCNWITM
.
LCKMB999  RETURN
.----------------------------------------------------------------------
.------------------------------------------------------------
. Keyin for MBS Global Regenerate of MBS Keyword Index
. either IBAPAT14 for Current file
.------------------------------------------------------------
MBSREG00  CLEAR     SCHDDESC           
          APPEND    "Global Regenerate MBS Keyword Index",SCHDDESC
.
          MOVE      TEN9,KEYSTARR[1]       * Option
          MOVE      SP10,KEYSTARR[2]       * Enter                 
          MOVE      TWO,KEYSTCNT           * Number of Keyins
          RESET     SCHDDESC
.
MBSREG99  RETURN
.
.--------------------------------------------------------------------------
. Keyin for Load MBS Item from ASCII File (IBAPAT14) 
.--------------------------------------------------------------------------
MBSLAF00  MATCH     "E",UPDTTYPE    * Global Load MBS/Item from XML file
          IF        @EQUAL
            MOVE      "Load MBS item from XML file",SCHDDESC
          ELSE
            MOVE      "Load MBS item from ASCII file",SCHDDESC
          ENDIF
.
..          PACK      GMBS0001,GMBS0001,SP70
.
. Get the Import File and Move to a Schedule Based Directory
. but keep original file name - Return KEY60 with File Name
.
          READ      CONTROLF,HUND02;*7,RSCNRCD
          STRIP     RSCNRCD
          PACK      KEY60,RSCNRCD,MBSUPLFL,SP70
          PACK      DIM127,CMDMV,GMBS0001,SP1,KEY60,SP70
          EXECUTE   DIM127,TASKID
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          MATCH     "E",UPDTTYPE    * Global Load MBS/Item from XML file
          IF        @EQUAL
            OPEN      XMLFILE,KEY60            * open file
          ELSE
            OPEN      MBSFILE,KEY60            * open file
          ENDIF
          TRAPCLR   IO
          BRANCH    OVRCD,MBSLAF90

          MATCH     "E",UPDTTYPE    * Global Load MBS/Item from XML file
          IF        @EQUAL
            MOVE      "21",KEYSTARR[1]       * Option 21 Upload from XML file
          ELSE
            MOVE      "20",KEYSTARR[1]       * Option 20 Upload from ASCCI file
          ENDIF
          MOVE      KEY60,KEYSTARR[2]        * Upload File    
          MOVE      SP10,KEYSTARR[3]         * Enter
          MOVE      THREE,KEYSTCNT           * Number of Keyins
.
          GOTO      MBSLAF99
.
MBSLAF90  MOVE      "File not found.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      MBSLAF99
.
MBSLAF99  RETURN
.
.------------------------------------------------------------
. ICD10 Operation Coding Maintenance: Display,Add,Update,Delete
.------------------------------------------------------------
PICDGR00  RESET     PTICO001 
          MOVE      "0",ICD10EDN
          RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      PICDGR40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      PICDGR10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      PICDGR20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      PICDGR30 IF EQUAL
.
          MATCH     "V",UPDTTYPE    * Validate formaction
          IF        @EQUAL  
            CALL      VALCOD00 
            GOTO      PICDGR99
          ENDIF
.
          GOTO      PICDGR93
.
PICDGR10  CALL      CHKICD00  * Checks mandatory fields & checks for blank
          BRANCH    EXIT,PICDGR99
          PACK      KEY9,PTICO001,SP70  * ADD FORMACTION
          CALL      RDPT10O1
          COMPARE   ZERO,OVRCD
          GOTO      PICDGR92 IF EQUAL
          CALL      ICDSAV00      * Moves input variables to file variables
          CALL      WRPT10O1      * Writes away the data
          PROC      PATKCOUP      * Update Keyword table
          MOVE      ZERO,EXIT
          GOTO      PICDGR99
.
PICDGR20  PACK      KEY9,PTICO001,SP70  * UPDATE FORMACTION
          CALL      RDPT10O1
          BRANCH    OVRCD,PICDGR91
          CALL      CHKICD00      * Checks mandatory fields
          BRANCH    EXIT,PICDGR99
          CALL      ICDSAV00      * Moves input variables to file variables
          CALL      UPPT10O1      * Writes away the data
          PROC      PATKCOUP      * Update Key word Table
          MOVE      ZERO,EXIT
          GOTO      PICDGR99
.
PICDGR30  PACK      KEY9,PTICO001,SP70   * DELETE FORMACTION
          CALL      RDPT10O1
          BRANCH    OVRCD,PICDGR91
          CALL      DEPT10O1      * Deletes the data
          PROC      PATKCOUP      * Update Key word Table
          MOVE      ZERO,EXIT
          GOTO      PICDGR99
.
PICDGR40  PACK      KEY9,PTICO001,SP70  
          CALL      RDPT10O1
          IF        OVRCD=1
            CALL      CLRICD00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "ICD10 Procedure Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PICDGR99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      PICDGR99
.
PICDGR91  MOVE      "ICD10 Procedure Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PICDGR99
.
PICDGR92  MOVE      "ICD10 Procedure Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PICDGR99
.
PICDGR93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PICDGR99
.
PICDGR99  RETURN
.------------------------------------------------------------------------------
. ICD10 Version 3 Operation Coding Maintenance: Display,Add,Update,Delete
.------------------------------------------------------------------------------
ICD3OP00  RESET     PTICO001
          MOVE      "3",ICD10EDN
          RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      ICD3OP40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      ICD3OP10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      ICD3OP20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      ICD3OP30 IF EQUAL
.
          MATCH     "V",UPDTTYPE    * Validate formaction
          IF        @EQUAL
            CALL      VAL3CD00
            GOTO      ICD3OP99
          ENDIF
.
          GOTO      ICD3OP93
.
ICD3OP10  CALL      CHKICD00  * Checks mandatory fields & checks for blank
          BRANCH    EXIT,ICD3OP99
          PACK      KEY9,PTICO001,SP70  * ADD FORMACTION
          CALL      RDPT13O1
          COMPARE   ZERO,OVRCD
          GOTO      ICD3OP92 IF EQUAL
          CALL      ICDSAV00      * Moves input variables to file variables
          CALL      WRPT13O1      * Writes away the data
          PROC      PATK3OUP      * Update Keyword table
          MOVE      ZERO,EXIT
          GOTO      ICD3OP99
.
ICD3OP20  PACK      KEY9,PTICO001,SP70  * UPDATE FORMACTION
          CALL      RDPT13O1
          BRANCH    OVRCD,ICD3OP91
          CALL      CHKICD00      * Checks mandatory fields
          BRANCH    EXIT,ICD3OP99
          CALL      ICDSAV00      * Moves input variables to file variables
          CALL      UPPT13O1      * Writes away the data
          PROC      PATK3OUP      * Update Key word Table
          MOVE      ZERO,EXIT
          GOTO      ICD3OP99
.
ICD3OP30  PACK      KEY9,PTICO001,SP70   * DELETE FORMACTION
          CALL      RDPT13O1
          BRANCH    OVRCD,ICD3OP91
          CALL      DEPT13O1      * Deletes the data
          PROC      PATK3OUP      * Update Key word Table
          MOVE      ZERO,EXIT
          GOTO      ICD3OP99
.
ICD3OP40  PACK      KEY9,PTICO001,SP70
          CALL      RDPT13O1
          IF        OVRCD=1
            CALL      CLRICD00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "ICD10 V3 Procedure Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,ICD3OP99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      ICD3OP99
.
ICD3OP91  MOVE      "ICD10 V3 Procedure Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ICD3OP99
.
ICD3OP92  MOVE      "ICD10 V3 Procedure Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ICD3OP99
.
ICD3OP93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ICD3OP99
.
ICD3OP99  RETURN
.                                                                      *I-49037
.------------------------------------------------------------------------------
. ICD10 Edition 4 Operation Coding Maintenance: Display,Add,Update,Delete
.------------------------------------------------------------------------------
ICD4OP00  RESET     PTICO001
          MOVE      "4",ICD10EDN
          RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      ICD4OP40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      ICD4OP10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      ICD4OP20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      ICD4OP30 IF EQUAL
.
          MATCH     "V",UPDTTYPE    * Validate formaction
          IF        @EQUAL
            CALL      VAL4CD00
            GOTO      ICD4OP99
          ENDIF
.
          GOTO      ICD4OP93
.
ICD4OP10  CALL      CHKICD00  * Checks mandatory fields & checks for blank
          BRANCH    EXIT,ICD4OP99
          PACK      KEY9,PTICO001,SP70  * ADD FORMACTION
          CALL      RDPT14O1
          COMPARE   ZERO,OVRCD
          GOTO      ICD4OP92 IF EQUAL
          CALL      ICDSAV00      * Moves input variables to file variables
          CALL      WRPT14O1      * Writes away the data
          PROC      PATK4OUP      * Update Keyword table
          MOVE      ZERO,EXIT
          GOTO      ICD4OP99
.
ICD4OP20  PACK      KEY9,PTICO001,SP70  * UPDATE FORMACTION
          CALL      RDPT14O1
          BRANCH    OVRCD,ICD4OP91
          CALL      CHKICD00      * Checks mandatory fields
          BRANCH    EXIT,ICD4OP99
          CALL      ICDSAV00      * Moves input variables to file variables
          CALL      UPPT14O1      * Writes away the data
          PROC      PATK4OUP      * Update Key word Table
          MOVE      ZERO,EXIT
          GOTO      ICD4OP99
.
ICD4OP30  PACK      KEY9,PTICO001,SP70   * DELETE FORMACTION
          CALL      RDPT14O1
          BRANCH    OVRCD,ICD4OP91
          CALL      DEPT14O1      * Deletes the data
          PROC      PATK4OUP      * Update Key word Table
          MOVE      ZERO,EXIT
          GOTO      ICD4OP99
.
ICD4OP40  PACK      KEY9,PTICO001,SP70
          CALL      RDPT14O1
          IF        OVRCD=1
            CALL      CLRICD00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "ICD10 Edition 4 Procedure Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,ICD4OP99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      ICD4OP99
.
ICD4OP91  MOVE      "ICD10 Edition 4 Procedure Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ICD4OP99
.
ICD4OP92  MOVE      "ICD10 Edition 4 Procedure Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ICD4OP99
.
ICD4OP93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ICD4OP99
.
ICD4OP99  RETURN
.
.------------------------------------------------------------------------------
. ICD9 Operation Coding Maintenance: Display,Add,Update,Delete
.------------------------------------------------------------------------------
IC99OP00  RESET     PTICO001
          RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      IC99OP40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      IC99OP10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      IC99OP20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      IC99OP30 IF EQUAL
.
          MATCH     "V",UPDTTYPE    * Validate formaction
          IF        @EQUAL
            CALL      VA99CD00
            GOTO      IC99OP99
          ENDIF
.
          GOTO      IC99OP93
.
IC99OP10  CALL      CHKICD00  * Checks mandatory fields & checks for blank
          BRANCH    EXIT,IC99OP99
          PACK      KEY9,PTICO001,SP70  * ADD FORMACTION
          CALL      RD10T9O1
          COMPARE   ZERO,OVRCD
          GOTO      IC99OP92 IF EQUAL
          CALL      ICDSAV00      * Moves input variables to file variables
          CALL      WR10T9O1      * Writes away the data
          PROC      PATOICUP      * Update Keyword table
          MOVE      ZERO,EXIT
          GOTO      IC99OP99
.
IC99OP20  PACK      KEY9,PTICO001,SP70  * UPDATE FORMACTION
          CALL      RD10T9O1
          BRANCH    OVRCD,IC99OP91
          CALL      CHKICD00      * Checks mandatory fields
          BRANCH    EXIT,IC99OP99
          CALL      ICDSAV00      * Moves input variables to file variables
          CALL      UP10T9O1      * Writes away the data
          PROC      PATOICUP      * Update Key word Table
          MOVE      ZERO,EXIT
          GOTO      IC99OP99
.
IC99OP30  PACK      KEY9,PTICO001,SP70   * DELETE FORMACTION
          CALL      RD10T9O1
          BRANCH    OVRCD,IC99OP91
          CALL      DE10T9O1      * Deletes the data
          PROC      PATOICUP      * Update Key word Table
          MOVE      ZERO,EXIT
          GOTO      IC99OP99
.
IC99OP40  PACK      KEY9,PTICO001,SP70
          CALL      RD10T9O1
          IF        OVRCD=1
            CALL      CLRICD00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "ICD9 Procedure Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,IC99OP99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      IC99OP99
.
IC99OP91  MOVE      "ICD9 Procedure Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      IC99OP99
.
IC99OP92  MOVE      "ICD9 Procedure Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      IC99OP99
.
IC99OP93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      IC99OP99
.
IC99OP99  RETURN
+
.-----------------------------------------------------------
. Initialize's file data (Operation Codes)
.-----------------------------------------------------------
CLRICD00  MOVE      SP70,OPCODE
          MOVE      SP70,ODESC
          MOVE      SP70,PT0ODESC
          PACK      PT0ODSC2,SP70,SP70,SP70
          MOVE      SP70,OFLAG
          MOVE      SP70,PT0OBLKN
          MOVE      SP70,OAGEGP
          MOVE      ZERO,OLOW
          MOVE      ZERO,OHIGH
          MOVE      SP70,PT0O2AGP
          MOVE      ZERO,PT0O2ALL
          MOVE      ZERO,PT0O2AHL
          MOVE      SP70,OSEX
          MOVE      SP70,PT0OADTP
          MOVE      SP70,PT0OSACD
          MOVE      SP70,ODAGGER
          MOVE      SP70,OAREA
          MOVE      SP70,PT0OMI9C
          MOVE      ZERO,PT0OCMFT
          MOVE      SP70,DPT0OV1C    * Valid ICD10 version 1 code
          MOVE      SP70,DPT0OV2C    * Valid ICD10 version 2 code
          MOVE      SP70,PT0OV1MP    * Valid ICD10 version 1 Map Code
          MOVE      SP70,DPT0OV3C    * Valid ICD10 version 3 code
          MOVE      SP70,PT0OV2MP    * Valid ICD10 version 2 Map Code
          MOVE      SP70,DPT0OV4C    * Valid ICD10 Ed. 4 code          *I-49037
          MOVE      SP70,DPT0OV5C    * Valid ICD10 Ed. 5 code         *I-105244
          MOVE      SP70,DPT0OV6C    * Valid ICD10 Ed. 6 code         *I-163918
          MOVE      SP70,DPT0OV7C    * Valid ICD10 Ed. 7 code         *I-219246
          MOVE      SP70,DPT0OV8C    * Valid ICD10 Ed. 8 code         *I-284420
          MOVE      SP70,DPT0OV9C    * Valid ICD10 Ed. 9 code         *I-311669
          MOVE      SP70,DPT0OVXC    * Valid ICD10 Ed.10 code         *I-0833093
          MOVE      SP70,DPT0OVX1    * Valid ICD10 Ed.11 code
          MOVE      SP70,DPT0OVX2    * Valid ICD10 Ed.12 code         *I-0917793
          MOVE      SP70,DPT0OVX3    * Valid ICD10 Ed.13 code         *I-0956210
          MOVE      SP70,PT0OURTH  
          MOVE      SP70,PT0OSPAR      
.
CLRICD99  RETURN
.------------------------------------------------------------
. Moves cgi variables into file variables
.------------------------------------------------------------
ICDSAV00  MOVE      PTICO001,OPCODE
          RESET     OPCODE           
.
          MOVE      PTICO002,ODESC
          MOVE      PTICO002,PT0ODESC
          MOVE      PTICO002,PT0ODSC2
          MATCH     "0",PTICO003         
          IF        @EQUAL
            MOVE      "P",OFLAG
          ELSE
            MOVE      "H",OFLAG
          ENDIF
          MOVE      PTICO004,PT0OBLKN
.
          MATCH     "0",PTICO005
          IF        @EQUAL
            MOVE      SP70,OAGEGP
          ELSE
            MOVE      PTICO005,OAGEGP
          ENDIF
.
          MOVE      PTICO006,OLOW
          MOVE      PTICO006,PTXOALL1
          MOVE      PTICO007,OHIGH
          MOVE      PTICO007,PTXOAHL1
.
          MATCH     "0",PTICO008
          IF        @EQUAL
            MOVE      SP70,PT0O2AGP
          ELSE
            MOVE      PTICO008,PT0O2AGP  
          ENDIF
          MOVE      PTICO009,PT0O2ALL
          MOVE      PTICO009,PTXOALL2
          MOVE      PTICO010,PT0O2AHL
          MOVE      PTICO010,PTXOAHL2
.
          MATCH     "0",PTICO011
          IF        @EQUAL
            MOVE      SP70,OSEX
          ELSE
            MOVE      PTICO011,OSEX
          ENDIF
.
          MOVE      PTICO012,F1        * Asterisk/dagger type
          BRANCH    F1,ICDSAV10,ICDSAV20
.
          MOVE      SP70,PT0OADTP
          GOTO      ICDSAV30   
ICDSAV10  MOVE      "A",PT0OADTP 
          GOTO      ICDSAV30   
ICDSAV20  MOVE      "D",PT0OADTP          
          GOTO      ICDSAV30   
.
ICDSAV30  MOVE      PTICO013,PT0OSACD
.
          MATCH     "0",PTICO014
          IF        @EQUAL
            MOVE      SP70,ODAGGER
          ELSE
            MOVE      PTICO014,ODAGGER
          ENDIF
.
          MATCH     "0",PTICO015
          IF        @EQUAL
            MOVE      SP70,OAREA
          ELSE
            MOVE      PTICO015,OAREA
          ENDIF
          MOVE      PTICO016,PT0OMI9C
.
          MOVE      PTICO017,PT0OCMFT
          MOVE      PTICO018,PT0OV1CD    * Valid ICD10 version 1 code
          MOVE      PTICO019,PT0OV2CD    * Valid ICD10 version 2 code
          MOVE      PTICO020,PT0OV1MP    * Valid ICD10 version 1 Map Code
          MOVE      PTICO021,PT0OV3CD    * Valid ICD10 version 3 code
          MOVE      PTICO022,PT0OV2MP    * Valid ICD10 version 2 Map Code
          MOVE      PTICO023,PT0OV4CD    * Valid ICD10 Ed. 4 code      *I-49037
          MOVE      PTICO024,PT0OV5CD    * Valid ICD10 Ed. 5 code     *I-105244
          MOVE      PTICO025,PT0ODTMN    * Date/Time non-Mandatory (1=yes)
          MOVE      PTICO026,PT0OV6CD    * Valid ICD10 Ed. 6 code     *I-163918
          MOVE      PTICO027,PT0OV7CD    * Valid ICD10 Ed. 7 code     *I-219246
          MOVE      PTICO028,PT0OV8CD    * Valid ICD10 Ed. 8 code     *I-284420
          MOVE      PTICO029,PT0OV9CD    * Valid ICD10 Ed. 9 code     *I-311669
          MOVE      PTICO030,PT0OVXCD    * Valid ICD10 Ed.10 code     *I-0833093
          MOVE      PTICO031,PT0OVX1C    * Valid ICD10 Ed.11 code
          MOVE      PTICO032,PT0OVX2C    * Valid ICD10 Ed.12 code     *I-0917793
          MOVE      PTICO033,PT0OURTH    * Unplanned Return to Theatre Flag
          MOVE      PTICO034,PT0OVX3C    * Valid ICD10 Ed.13 code     *I-0956210
.
          MOVE      SP70,PT0OSPAR      
.
ICDSAV99  RETURN
.------------------------------------------------------------------
. * Checks mandatory fields and checks for blank
.------------------------------------------------------------------
CHKICD00  RESET     PTICO001
          MATCH     SP70,PTICO001
          GOTO      CHKICD90 IF EQUAL
.
          RESET     PTICO002
          MATCH     SP70,PTICO002
          GOTO      CHKICD91 IF EQUAL
.
          GOTO      CHKICD98
.
CHKICD90  MOVE      "ICD10 Procedure Code is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKICD99
.
CHKICD91  MOVE      "ICD10 Procedure Description is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKICD99
.
CHKICD98  MOVE      ZERO,EXIT
CHKICD99  RETURN
.------------------------------------------------------------
. ICD10 Diagnosis Coding Maintenance: Display,Add,Update,Delete
.------------------------------------------------------------
PICDDI00  RESET     PTICD001 
          MOVE      "0",ICD10EDN
          RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      PICDDI40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      PICDDI10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      PICDDI20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      PICDDI30 IF EQUAL
.
          MATCH     "V",UPDTTYPE    * Validate Formaction
          IF        @EQUAL  
            CALL      VALCOD00 
            GOTO      PICDDI99
          ENDIF
.
          GOTO      PICDDI93
.
PICDDI10  CALL      CHKDIS00  * Checks mandatory fields & checks for blank
          BRANCH    EXIT,PICDDI99
          PACK      KEY9,PTICD001,SP70  * ADD FORMACTION
          CALL      RDPT10D1
          COMPARE   ZERO,OVRCD
          GOTO      PICDDI92 IF EQUAL
          CALL      DISSAV00      * Moves input variables to file variables
          CALL      WRPT10D1      * Writes away the data
          PROC      PATKCDUP      * Update Keyword table
.
          CALL      ADDCAN00      * Add Cancer Code Record
.
          MOVE      ZERO,EXIT
          GOTO      PICDDI99
.
PICDDI20  PACK      KEY9,PTICD001,SP70  * UPDATE FORMACTION
          CALL      RDPT10D1
          BRANCH    OVRCD,PICDDI91
          CALL      CHKDIS00      * Checks mandatory fields
          BRANCH    EXIT,PICDDI99
          CALL      DISSAV00      * Moves input variables to file variables
          CALL      UPPT10D1      * Writes away the data
          PROC      PATKCDUP      * Update Key word Table
.
          CALL      UPDCAN00      * Update Cancer Code Record
.
          MOVE      ZERO,EXIT
          GOTO      PICDDI99
.
PICDDI30  PACK      KEY9,PTICD001,SP70   * DELETE FORMACTION
          CALL      RDPT10D1
          BRANCH    OVRCD,PICDDI91
          CALL      DEPT10D1      * Deletes the data
          PROC      PATKCDUP      * Update Key word Table
.
          CALL      DELCAN00      * Delete Cancer Code Record
.
          MOVE      ZERO,EXIT
          GOTO      PICDDI99
.
PICDDI40  PACK      KEY9,PTICD001,SP70  
          CALL      RDPT10D1
          IF        OVRCD=1
            CALL      CLRDIS00    * Clear all the file variables
          ENDIF
.
          MOVE      ONE,CANCERCD
          PACK      KEY9,PTICD001,SP70  
          CALL      RDPTCAN1
          IF        OVRCD=1
            MOVE     ZERO,CANCERCD
            MOVE     ZERO,PTCCLATR
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "ICD10 Diagnosis Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PICDDI99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      PICDDI99
.
PICDDI91  MOVE      "ICD10 Diagnosis Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PICDDI99
.
PICDDI92  MOVE      "ICD10 Diagnosis Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PICDDI99
.
PICDDI93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PICDDI99
.
PICDDI99  RETURN
.------------------------------------------------------------------------------
. ICD10 Version 3 Diagnosis Coding Maintenance: Display,Add,Update,Delete
.------------------------------------------------------------------------------
ICD3DI00  RESET     PTICD001
          MOVE      "3",ICD10EDN
          RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      ICD3DI40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      ICD3DI10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      ICD3DI20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      ICD3DI30 IF EQUAL
.
          MATCH     "V",UPDTTYPE    * Validate Formaction
          IF        @EQUAL
            CALL      VAL3CD00
            GOTO      ICD3DI99
          ENDIF
.
          GOTO      ICD3DI93
.
ICD3DI10  CALL      CHKDIS00  * Checks mandatory fields & checks for blank
          BRANCH    EXIT,ICD3DI99
          PACK      KEY9,PTICD001,SP70  * ADD FORMACTION
          CALL      RDPT13D1
          COMPARE   ZERO,OVRCD
          GOTO      ICD3DI92 IF EQUAL
          CALL      DISSAV00      * Moves input variables to file variables
          CALL      WRPT13D1      * Writes away the data
          PROC      PATK3DUP      * Update Keyword table
.
          CALL      ADDCAN00      * Add Cancer Code Record
.
          MOVE      ZERO,EXIT
          GOTO      ICD3DI99
.
ICD3DI20  PACK      KEY9,PTICD001,SP70  * UPDATE FORMACTION
          CALL      RDPT13D1
          BRANCH    OVRCD,ICD3DI91
          CALL      CHKDIS00      * Checks mandatory fields
          BRANCH    EXIT,ICD3DI99
          CALL      DISSAV00      * Moves input variables to file variables
          CALL      UPPT13D1      * Writes away the data
          PROC      PATK3DUP      * Update Key word Table
.
          CALL      UPDCAN00      * Update Cancer Code Record
.
          MOVE      ZERO,EXIT
          GOTO      ICD3DI99
.
ICD3DI30  PACK      KEY9,PTICD001,SP70   * DELETE FORMACTION
          CALL      RDPT13D1
          BRANCH    OVRCD,ICD3DI91
          CALL      DEPT13D1      * Deletes the data
          PROC      PATK3DUP      * Update Key word Table
.
          CALL      DELCAN00      * Delete Cancer Code Record
.
          MOVE      ZERO,EXIT
          GOTO      ICD3DI99
.
ICD3DI40  PACK      KEY9,PTICD001,SP70
          CALL      RDPT13D1
          IF        OVRCD=1
            CALL      CLRDIS00    * Clear all the file variables
          ENDIF
.
          MOVE      ONE,CANCERCD
          PACK      KEY9,PTICD001,SP70
          CALL      RDPTCAN1
          IF        OVRCD=1
            MOVE     ZERO,CANCERCD
            MOVE     ZERO,PTCCLATR
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "ICD10 V3 Diagnosis Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,ICD3DI99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      ICD3DI99
.
ICD3DI91  MOVE      "ICD10 V3 Diagnosis Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ICD3DI99
.
ICD3DI92  MOVE      "ICD10 V3 Diagnosis Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ICD3DI99
.
ICD3DI93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ICD3DI99
.
ICD3DI99  RETURN
.                                                                      *I-49037
.------------------------------------------------------------------------------
. ICD10 Edition 4 Diagnosis Coding Maintenance: Display,Add,Update,Delete
.------------------------------------------------------------------------------
ICD4DI00  RESET     PTICD001
          MOVE      "4",ICD10EDN
          RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      ICD4DI40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      ICD4DI10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      ICD4DI20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      ICD4DI30 IF EQUAL
.
          MATCH     "V",UPDTTYPE    * Validate Formaction
          IF        @EQUAL
            CALL      VAL4CD00
            GOTO      ICD4DI99
          ENDIF
.
          GOTO      ICD4DI93
.
ICD4DI10  CALL      CHKDIS00  * Checks mandatory fields & checks for blank
          BRANCH    EXIT,ICD4DI99
          PACK      KEY9,PTICD001,SP70  * ADD FORMACTION
          CALL      RDPT14D1
          COMPARE   ZERO,OVRCD
          GOTO      ICD4DI92 IF EQUAL
          CALL      DISSAV00      * Moves input variables to file variables
          CALL      WRPT14D1      * Writes away the data
          PROC      PATK4DUP      * Update Keyword table
.
          CALL      ADDCAN00      * Add Cancer Code Record
.
          MOVE      ZERO,EXIT
          GOTO      ICD4DI99
.
ICD4DI20  PACK      KEY9,PTICD001,SP70  * UPDATE FORMACTION
          CALL      RDPT14D1
          BRANCH    OVRCD,ICD4DI91
          CALL      CHKDIS00      * Checks mandatory fields
          BRANCH    EXIT,ICD4DI99
          CALL      DISSAV00      * Moves input variables to file variables
          CALL      UPPT14D1      * Writes away the data
          PROC      PATK4DUP      * Update Key word Table
.
          CALL      UPDCAN00      * Update Cancer Code Record
.
          MOVE      ZERO,EXIT
          GOTO      ICD4DI99
.
ICD4DI30  PACK      KEY9,PTICD001,SP70   * DELETE FORMACTION
          CALL      RDPT14D1
          BRANCH    OVRCD,ICD4DI91
          CALL      DEPT14D1      * Deletes the data
          PROC      PATK4DUP      * Update Key word Table
.
          CALL      DELCAN00      * Delete Cancer Code Record
.
          MOVE      ZERO,EXIT
          GOTO      ICD4DI99
.
ICD4DI40  PACK      KEY9,PTICD001,SP70
          CALL      RDPT14D1
          IF        OVRCD=1
            CALL      CLRDIS00    * Clear all the file variables
          ENDIF
.
          MOVE      ONE,CANCERCD
          PACK      KEY9,PTICD001,SP70
          CALL      RDPTCAN1
          IF        OVRCD=1
            MOVE     ZERO,CANCERCD
            MOVE     ZERO,PTCCLATR
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "ICD10 Edition 4 Diagnosis Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,ICD4DI99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      ICD4DI99
.
ICD4DI91  MOVE      "ICD10 Edition 4 Diagnosis Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ICD4DI99
.
ICD4DI92  MOVE      "ICD10 Edition 4 Diagnosis Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ICD4DI99
.
ICD4DI93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      ICD4DI99
.
ICD4DI99  RETURN
.
.------------------------------------------------------------------------------
. ICD9 Diagnosis Coding Maintenance: Display,Add,Update,Delete
.------------------------------------------------------------------------------
IC99DI00  RESET     PTICD001
          RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      IC99DI40 IF EQUAL
.         
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      IC99DI10 IF EQUAL 
.         
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      IC99DI20 IF EQUAL 
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      IC99DI30 IF EQUAL
.
          MATCH     "V",UPDTTYPE    * Validate Formaction
          IF        @EQUAL
            CALL      VA99CD00
            GOTO      IC99DI99
          ENDIF
.
          GOTO      IC99DI93
.
IC99DI10  CALL      CHKDIS00  * Checks mandatory fields & checks for blank
          BRANCH    EXIT,IC99DI99
          PACK      KEY9,PTICD001,SP70  * ADD FORMACTION
          CALL      RD10T9D1
          COMPARE   ZERO,OVRCD
          GOTO      IC99DI92 IF EQUAL
          CALL      DISSAV00      * Moves input variables to file variables
          CALL      WR10T9D1      * Writes away the data
          PROC      PATDICUP      * Update Keyword table
.
          CALL      ADDCAN00      * Add Cancer Code Record
.
          MOVE      ZERO,EXIT
          GOTO      IC99DI99
.
IC99DI20  PACK      KEY9,PTICD001,SP70  * UPDATE FORMACTION
          CALL      RD10T9D1
          BRANCH    OVRCD,IC99DI91
          CALL      CHKDIS00      * Checks mandatory fields
          BRANCH    EXIT,IC99DI99
          CALL      DISSAV00      * Moves input variables to file variables
          CALL      UP10T9D1      * Writes away the data
          PROC      PATDICUP      * Update Key word Table
.
          CALL      UPDCAN00      * Update Cancer Code Record
.
          MOVE      ZERO,EXIT
          GOTO      IC99DI99
.
IC99DI30  PACK      KEY9,PTICD001,SP70   * DELETE FORMACTION
          CALL      RD10T9D1
          BRANCH    OVRCD,IC99DI91
          CALL      DE10T9D1      * Deletes the data
          PROC      PATDICUP      * Update Key word Table
.
          CALL      DELCAN00      * Delete Cancer Code Record
.
          MOVE      ZERO,EXIT
          GOTO      IC99DI99
.
IC99DI40  PACK      KEY9,PTICD001,SP70
          CALL      RD10T9D1
          IF        OVRCD=1
            CALL      CLRDIS00    * Clear all the file variables
          ENDIF
.
          MOVE      ONE,CANCERCD
          PACK      KEY9,PTICD001,SP70
          CALL      RDPTCAN1
          IF        OVRCD=1
            MOVE     ZERO,CANCERCD
            MOVE     ZERO,PTCCLATR
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "ICD9 Diagnosis Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,IC99DI99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      IC99DI99
.
IC99DI91  MOVE      "ICD9 Diagnosis Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      IC99DI99
.
IC99DI92  MOVE      "ICD9 Diagnosis Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      IC99DI99
.
IC99DI93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      IC99DI99
.
IC99DI99  RETURN
+
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRDIS00  MOVE      SP70,DPCODE
          MOVE      SP70,DDESC
          PACK      PT0DDSC2,SP70,SP70,SP70
          MOVE      SP70,DFLAG
          MOVE      SP70,DAGEGP
          MOVE      ZERO,DLOW
          MOVE      ZERO,DHIGH
          MOVE      SP70,PT0D2AGP
          MOVE      ZERO,PT0D2ALL
          MOVE      ZERO,PT0D2AHL
          MOVE      SP70,DSEX
          MOVE      SP70,PT0DADTP
          MOVE      SP70,PT0DSACD
          MOVE      SP70,PT0DSAC2    * shorter version of PT0DSACD    *I-253821
          MOVE      SP70,DDAGGER
          MOVE      SP70,DAREA
          MOVE      SP70,PT0DCPRA 
          MOVE      SP70,PT0DACRQ
          MOVE      SP70,PT0DMI9C
          MOVE      ZERO,PT0DCMFT
          MOVE      SP70,DPT0DV1C    * Valid ICD10 version 1 code
          MOVE      SP70,DPT0DV2C    * Valid ICD10 version 2 code
          MOVE      SP70,PT0DV1MP    * Valid ICD10 version 1 Map Code
          MOVE      SP70,DPT0DV3C    * Valid ICD10 version 3 code
          MOVE      SP70,PT0DV2MP    * Valid ICD10 version 2 Map Code
          MOVE      SP70,DPT0DV4C    * Valid ICD10 Ed. 4 code          *I-49037
          MOVE      SP70,DPT0DV5C    * Valid ICD10 Ed. 5 code         *I-105244
          MOVE      SP70,DPT0DV6C    * Valid ICD10 Ed. 6 code         *I-163918
          MOVE      SP70,DPT0DV7C    * Valid ICD10 Ed. 7 code         *I-219246
          MOVE      SP70,DPT0DV8C    * Valid ICD10 Ed. 8 code         *I-284420
          MOVE      SP70,DPT0DV9C    * Valid ICD10 Ed. 9 code         *I-311669
          MOVE      SP70,DPT0DVXC    * Valid ICD10 Ed.10 code         *I-0833093
          MOVE      SP70,PTODMETH    * Methamphetamine Related
          MOVE      SP70,DPT0DVX1    * Valid ICD10 Ed.11 code
          MOVE      SP70,DPT0DVX2    * Valid ICD10 Ed.12 code         *I-0917793
          MOVE      SP70,DPT0DVX3    * Valid ICD10 Ed.13 code         *I-0956210
          MOVE      SP70,PT0DCARQ
          MOVE      SP70,PT0DSPAR      
.
CLRDIS99  RETURN
.------------------------------------------------------------
. Moves cgi variables into file variables
.------------------------------------------------------------
DISSAV00  MOVE      PTICD001,DPCODE
          RESET     DPCODE           
          MOVE      PTICD002,DDESC
          MOVE      PTICD002,PT0DDESC
          MOVE      PTICD002,PT0DDSC2
.
          MATCH     "0",PTICD003         
          IF        @EQUAL
            MOVE      "P",DFLAG
          ELSE
            MOVE      "H",DFLAG
          ENDIF
.
          MATCH     "0",PTICD004
          IF        @EQUAL
            MOVE      SP70,DAGEGP
          ELSE
            MOVE      PTICD004,DAGEGP
          ENDIF
.
          MOVE      PTICD005,DLOW
          MOVE      PTICD005,PTXDALL1
          MOVE      PTICD006,DHIGH
          MOVE      PTICD006,PTXDAHL1
.
          MATCH     "0",PTICD007
          IF        @EQUAL
            MOVE      SP70,PT0D2AGP
          ELSE
            MOVE      PTICD007,PT0D2AGP  
          ENDIF
          MOVE      PTICD008,PT0D2ALL
          MOVE      PTICD008,PTXDALL2
          MOVE      PTICD009,PT0D2AHL
          MOVE      PTICD009,PTXDAHL2
.
          MATCH     "0",PTICD010
          IF        @EQUAL
            MOVE      SP70,DSEX
          ELSE
            MOVE      PTICD010,DSEX
          ENDIF
.
          MOVE      ZERO,F1
          MOVE      PTICD011,F1        * Asterisk/dagger type
          BRANCH    F1,DISSAV10,DISSAV20
.
          MOVE      SP70,PT0DADTP
          GOTO      DISSAV30   
.
DISSAV10  MOVE      "A",PT0DADTP 
          GOTO      DISSAV30   
DISSAV20  MOVE      "D",PT0DADTP          
          GOTO      DISSAV30   
.
.                                           * use PT0DSACD or PT0DSAC2 C-253821
DISSAV30  IF        ICD10EDN < 4
            MOVE      PTICD012,PT0DSACD
          ELSE
            MOVE      PTICD012,PT0DSAC2     * short vers of PT0DSACD  *I-253821
          ENDIF
.
          MATCH     "0",PTICD013
          IF        @EQUAL
            MOVE      SP70,DDAGGER
          ELSE
            MOVE      PTICD013,DDAGGER
          ENDIF
.
          MATCH     "0",PTICD014
          IF        @EQUAL
            MOVE      SP70,DAREA
          ELSE
            MOVE      PTICD014,DAREA
          ENDIF
.
          MATCH     "0",PTICD015
          IF        @EQUAL
            MOVE      SP70,PT0DCPRA
          ELSE
            MOVE      PTICD015,PT0DCPRA
          ENDIF
.
.  * Save Additional Code Requirements Edit
.
DISSAVXX  MOVE      ZERO,F2
          MOVE      PTICD016,F2     
          BRANCH    F2,DISSAV40,DISSAV40,DISSAV40,DISSAV40,DISSAV40:
                       DISSAV40,DISSAV40,DISSAV40,DISSAV50,DISSAV60:
                       DISSAV70
.
          MOVE      SP70,PT0DACRQ
          GOTO      DISSAV90
.         
DISSAV40  MOVE      PTICD016,PT0DACRQ   * Numbers 1-8 on html
          GOTO      DISSAV90
DISSAV50  MOVE      "P",PT0DACRQ        * Number 9 on html
          GOTO      DISSAV90
DISSAV60  MOVE      "A",PT0DACRQ        * Number 10 on html
          GOTO      DISSAV90
DISSAV70  MOVE      "W",PT0DACRQ        * Number 11 on html
          GOTO      DISSAV90
.
DISSAV90  MOVE      PTICD017,PT0DMI9C
          MOVE      PTICD018,PT0DCMFT
          MOVE      PTICD019,PT0DV1CD    * Valid ICD10 version 1 code
          MOVE      PTICD020,PT0DV2CD    * Valid ICD10 version 2 code
          MOVE      PTICD021,PT0DV1MP    * Valid ICD10 version 1 Map Code
          MOVE      PTICD022,PT0DV3CD    * Valid ICD10 version 3 code
          MOVE      PTICD023,PT0DV2MP    * Valid ICD10 version 2 Map Code
          MOVE      PTICD024,PT0DV4CD    * Valid ICD10 Ed. 4 code      *I-49037
          MOVE      PTICD025,PT0DPRFX    * Diag. code Prefix           *I-49037
          MOVE      PTICD026,PT0DV5CD    * Valid ICD10 Ed. 5 code     *I-105244
          MOVE      PTICD027,PT0DV6CD    * Valid ICD10 Ed. 6 code     *I-163918
          MOVE      PTICD028,PT0DV7CD    * Valid ICD10 Ed. 7 code     *I-219246
          MOVE      PTICD029,PT0DV8CD    * Valid ICD10 Ed. 8 code     *I-284420
          MOVE      PTICD030,PT0DV9CD    * Valid ICD10 Ed. 9 code     *I-311669
          MOVE      PTICD031,PT0DVXCD    * Valid ICD10 Ed.10 code     *I-0833093
          MOVE      PTICD032,PTODMETH    * Methamphetamine Related
          MOVE      PTICD033,PT0DVX1C    * Valid ICD10 Ed.11 code
          MOVE      PTICD034,PT0DVX2C    * Valid ICD10 Ed.12 code     *I-0917793
          MOVE      PTICD035,PT0DVX3C    * Valid ICD10 Ed.13 code     *I-0956210
          MOVE      PTICD036,PT0DCARQ    * Cluster Allocation Required
          MOVE      SP70,PT0DSPAR      
.
DISSAV99  RETURN
.------------------------------------------------------------------
. * Checks mandatory fields and checks for blank
.------------------------------------------------------------------
CHKDIS00  RESET     PTICD001
          MATCH     SP70,PTICD001
          GOTO      CHKDIS90 IF EQUAL
.
          RESET     PTICD002
          MATCH     SP70,PTICD002
          GOTO      CHKDIS91 IF EQUAL
.
          GOTO      CHKDIS98
.
CHKDIS90  MOVE      "ICD10 Diagnosis Code is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKDIS99
.
CHKDIS91  MOVE      "ICD10 Diagnosis Description is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKDIS99
.
CHKDIS98  MOVE      ZERO,EXIT
CHKDIS99  RETURN
.------------------------------------------------------------
. Onlne Code Validation
.------------------------------------------------------------
VALCOD00  MOVE      SP70,VALDNAME
          MATCH     SP70,VALDCODE
          GOTO      VALCOD90 IF EQUAL
.
          MOVE      "Invalid Code Entered",VALDNAME
          BRANCH    VALDTYPE,VALCOD10,VALCOD20
          MOVE      "Invalid Validation Type",VALDNAME
          GOTO      VALCOD90
.
VALCOD10  MOVE      VALDCODE,KEY9
          CALL      RDPT10O1
          IF        OVRCD=0
            MOVE      ODESC,VALDNAME
          ENDIF
          GOTO      VALCOD90
.
VALCOD20  MOVE      VALDCODE,KEY9
          CALL      RDPT10D1
          IF        OVRCD=0
            MOVE      DDESC,VALDNAME
          ENDIF
          GOTO      VALCOD90
.
VALCOD90  CALL      OPENHTML
          BRANCH    EXIT,VALCOD99
          WRITE     HTMLFILE;"<h3 align=center>Checking Database</h3>":
                             "<script type=#"text/javascript#">":
                             "{ opener.ValidateName.value=#"",VALDNAME,"#";":
                             "  opener.ValidateCode.value=#"",VALDCODE,"#";"
.
          MATCH     "Invalid",VALDNAME
          IF        @EQUAL
            WRITE     HTMLFILE;"  alert(#"Invalid Code Entered#");";
          ENDIF
.
          WRITE     HTMLFILE;"  close(); } </script>"
          CALL      CLOSHTML
.
VALCOD99  RETURN
.
.------------------------------------------------------------------------------
. Online ICD10 Version 3 Code Validation 
.------------------------------------------------------------------------------
VAL3CD00  MOVE      SP70,VALDNAME
          MATCH     SP70,VALDCODE
          GOTO      VAL3CD90 IF EQUAL
.
          MOVE      "Invalid Code Entered",VALDNAME
          BRANCH    VALDTYPE,VAL3CD10,VAL3CD20
          MOVE      "Invalid Validation Type",VALDNAME
          GOTO      VAL3CD90
.
VAL3CD10  MOVE      VALDCODE,KEY9
          CALL      RDPT13O1
          IF        OVRCD=0
            MOVE      ODESC,VALDNAME
          ENDIF
          GOTO      VAL3CD90
.
VAL3CD20  MOVE      VALDCODE,KEY9
          CALL      RDPT13D1
          IF        OVRCD=0
            MOVE      DDESC,VALDNAME
          ENDIF
          GOTO      VAL3CD90
.
VAL3CD90  CALL      OPENHTML
          BRANCH    EXIT,VAL3CD99
          WRITE     HTMLFILE;"<h3 align=center>Checking Database</h3>":
                             "<script type=#"text/javascript#">":
                             "{ opener.ValidateName.value=#"",VALDNAME,"#";":
                             "  opener.ValidateCode.value=#"",VALDCODE,"#";"
.
          MATCH     "Invalid",VALDNAME
          IF        @EQUAL
            WRITE     HTMLFILE;"  alert(#"Invalid Code Entered#");";
          ENDIF
.
          WRITE     HTMLFILE;"  close(); } </script>"
          CALL      CLOSHTML
.
VAL3CD99  RETURN
.                                                                      *I-49037
.------------------------------------------------------------------------------
. Online ICD10 Edition 4 Code Validation 
.------------------------------------------------------------------------------
VAL4CD00  MOVE      SP70,VALDNAME
          MATCH     SP70,VALDCODE
          GOTO      VAL4CD90 IF EQUAL
.
          MOVE      "Invalid Code Entered",VALDNAME
          BRANCH    VALDTYPE,VAL4CD10,VAL4CD20
          MOVE      "Invalid Validation Type",VALDNAME
          GOTO      VAL4CD90
.
VAL4CD10  MOVE      VALDCODE,KEY9
          CALL      RDPT14O1
          IF        OVRCD=0
            MOVE      ODESC,VALDNAME
          ENDIF
          GOTO      VAL4CD90
.
VAL4CD20  MOVE      VALDCODE,KEY9
          CALL      RDPT14D1
          IF        OVRCD=0
            MOVE      DDESC,VALDNAME
          ENDIF
          GOTO      VAL4CD90
.
VAL4CD90  CALL      OPENHTML
          BRANCH    EXIT,VAL4CD99
          WRITE     HTMLFILE;"<h3 align=center>Checking Database</h3>":
                             "<script type=#"text/javascript#">":
                             "{ opener.ValidateName.value=#"",VALDNAME,"#";":
                             "  opener.ValidateCode.value=#"",VALDCODE,"#";"
.
          MATCH     "Invalid",VALDNAME
          IF        @EQUAL
            WRITE     HTMLFILE;"  alert(#"Invalid Code Entered#");";
          ENDIF
.
          WRITE     HTMLFILE;"  close(); } </script>"
          CALL      CLOSHTML
.
VAL4CD99  RETURN
.
.------------------------------------------------------------------------------
. Online ICD9 Code Validation
.------------------------------------------------------------------------------
VA99CD00  MOVE      SP70,VALDNAME
          MATCH     SP70,VALDCODE
          GOTO      VA99CD90 IF EQUAL
.
          MOVE      "Invalid Code Entered",VALDNAME
          BRANCH    VALDTYPE,VA99CD10,VA99CD20
          MOVE      "Invalid Validation Type",VALDNAME
          GOTO      VA99CD90
.
VA99CD10  MOVE      VALDCODE,KEY9
          CALL      RD10T9O1
          IF        OVRCD=0
            MOVE      ODESC,VALDNAME
          ENDIF
          GOTO      VA99CD90
.
VA99CD20  MOVE      VALDCODE,KEY9
          CALL      RD10T9D1
          IF        OVRCD=0
            MOVE      DDESC,VALDNAME
          ENDIF
          GOTO      VA99CD90
.
VA99CD90  CALL      OPENHTML
          BRANCH    EXIT,VA99CD99
          WRITE     HTMLFILE;"<h3 align=center>Checking Database</h3>":
                             "<script type=#"text/javascript#">":
                             "{ opener.ValidateName.value=#"",VALDNAME,"#";":
                             "  opener.ValidateCode.value=#"",VALDCODE,"#";"
.
          MATCH     "Invalid",VALDNAME
          IF        @EQUAL
            WRITE     HTMLFILE;"  alert(#"Invalid Code Entered#");";
          ENDIF
.
          WRITE     HTMLFILE;"  close(); } </script>"
          CALL      CLOSHTML
.
VA99CD99  RETURN
+
.------------------------------------------------------------
. Hospital File Maintenance: Display,Add,Update,Delete
.------------------------------------------------------------
HOSFIL00  RESET     PTHOS001 
          RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      HOSFIL40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      HOSFIL10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      HOSFIL20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      HOSFIL30 IF EQUAL
.
          GOTO      HOSFIL93
.
.         ************ ADD FORMACTION **************
.
HOSFIL10  CALL      CHKFIL00  * Checks mandatory fields & checks for blank
          BRANCH    EXIT,HOSFIL99
          PACK      KEY4,PTHOS001,SP70  
          CALL      RDHOSP1 
          COMPARE   ZERO,OVRCD
          GOTO      HOSFIL92 IF EQUAL
          CALL      UNIQ0000      * Get next available unique Hosp Identifier
          CALL      FILSAV00      * Moves input variables to file variables
          CALL      WRHOSP1       * Writes away the data
          MOVE      ZERO,EXIT
          GOTO      HOSFIL99
.
.         ************ UPDATE FORMACTION ************
.
HOSFIL20  PACK      KEY4,PTHOS001,SP70  
          CALL      RDHOSP1 
          BRANCH    OVRCD,HOSFIL91
          CALL      CHKFIL00      * Checks mandatory fields
          BRANCH    EXIT,HOSFIL99
          CALL      RLHOSP1       * Read Lock Record
          CALL      FILSAV00      * Moves input variables to file variables
          CALL      UPHOSP1       * Update Record 
          CALL      ULHOSP1       * Unlock Record 
          MOVE      ZERO,EXIT
          GOTO      HOSFIL99
.
.         ************ DELETE FORMACTION **********
.
HOSFIL30  PACK      KEY4,PTHOS001,SP70   
          CALL      RDHOSP1 
          BRANCH    OVRCD,HOSFIL91
.
          PACK      KEY10,DHOSINDX,SP70
          CALL      RSWBHD1
HOSFIL31  CALL      RKWBHD1
          BRANCH    OVRCD,HOSFIL32 
          MATCH     DHOSINDX,WBHDHID
          GOTO      HOSFIL32 IF NOT EQUAL 
          PACK      KEY10,WBHDHID,WBHDFIL,SP70
          CALL      DEWBHD1
          GOTO      HOSFIL31
.
HOSFIL32  PACK      KEY4,PTHOS001,SP70
          CALL      DEHOSP1       * Deletes the data
          MOVE      ZERO,EXIT
          GOTO      HOSFIL99
.
.         ************ DISPLAY FORMACTION ********
.
HOSFIL40  PACK      KEY4,PTHOS001,SP70  
          CALL      RDHOSP1 
          IF        OVRCD=1
            MATCH     SP70,KEY4
            IF        !@EQUAL
              BRANCH    FHIRTYPE,HOSFIL91
            ENDIF
            CALL      CLRFIL00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Hospital File Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,HOSFIL99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      HOSFIL99
.
HOSFIL91  MOVE      "Hospital Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      HOSFIL99
.
HOSFIL92  MOVE      "Hospital Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      HOSFIL99
.
HOSFIL93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      HOSFIL99
.
HOSFIL99  RETURN
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRFIL00  MOVE      SP70,HOSCODE    * HOSPITAL CODE
          MOVE      SP70,DHOSINDX   * UNIQUE IDENTIFIER (1 to 20)
          MOVE      SP70,HOSDESC    * HOSIPTAL DESCRIPTION
          MOVE      SP70,HOSRUN     * RUN COMMAND (Unique Ports)
          MOVE      SP70,HOSRUNR    * RUN COMMAND (Batch recording)
          MOVE      SP70,PTHOACTV   * " "=active "I"= inactive
          MOVE      SP70,PTHORUNB   * RUN COMMNAD for Patient Billing MRT21
          MOVE      SP70,HOSSPAR    * SPARE VARIABLE
.
CLRFIL99  RETURN
.-----------------------------------------------------------------------
.                        UNIQ0000                                      - 
.      get the next available unique identifier                        -
.-----------------------------------------------------------------------
UNIQ0000  MOVE      ZERO,EXIT 
          MOVE      ZERO,HOSPINDX            * initialise identifier
.
UNIQ1000  ADD       ONE,HOSPINDX             * Try the next identifier
          COMPARE   HOSPINDX,TWENTY          * Have we checked all values ?
          GOTO      UNIQ9000 IF LESS         * Yes. Exit with error status
.
          MOVE      HOSPINDX,KEY2            * Check 2nd index
          CALL      RDAHOSP2                 * Is this value in use ?
          BRANCH    OVRCD,UNIQ8000           * No. Found an identifier, exit!
.
          GOTO      UNIQ1000                 * Already in use. Try next one.
.
UNIQ8000  MOVE      HOSPINDX,PTHOS002    * Moved into cgi parameter for save
          GOTO      UNIQ9999             * routine
.
UNIQ9000  MOVE      "Cannot have more than 20 hospitals on file!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      UNIQ9999
.
UNIQ9999  RETURN
.------------------------------------------------------------
. Moves cgi variables into file variables
.------------------------------------------------------------
FILSAV00  MOVE      PTHOS001,HOSCODE
          MOVE      PTHOS002,HOSINDX
          MOVE      PTHOS003,HOSDESC
          MOVE      PTHOS004,HOSRUN
          MOVE      PTHOS005,HOSRUNR
.
          MATCH     "B",PTHOS006
          IF        @EQUAL
            MOVE      " ",PTHOACTV
          ELSE
            MOVE      "I",PTHOACTV
          ENDIF
.
          MOVE      PTHOS007,PTHORUNB
          MOVE      SP70,HOSSPAR    
.
FILSAV99  RETURN
.------------------------------------------------------------------
. * Checks mandatory fields and checks for blank
.------------------------------------------------------------------
CHKFIL00  RESET     PTHOS001
          MATCH     SP70,PTHOS001
          GOTO      CHKFIL90 IF EQUAL
.
          RESET     PTHOS003
          MATCH     SP70,PTHOS003
          GOTO      CHKFIL91 IF EQUAL
.
          GOTO      CHKFIL98
.
CHKFIL90  MOVE      "Hospital Code is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKFIL99
.
CHKFIL91  MOVE      "Description is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKFIL99
.
CHKFIL98  MOVE      ZERO,EXIT
CHKFIL99  RETURN
.--------------------------------------------------------------------
. Hospital Data File Locations Maintenance: Display,Add,Update,Delete
.--------------------------------------------------------------------
HOSLOC00  RESET     PTHOS001 
          RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      HOSLOC40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      HOSLOC10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      HOSLOC20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      HOSLOC30 IF EQUAL
.
          GOTO      HOSLOC93
.
.         ************ ADD FORMACTION **************
.
HOSLOC10  CALL      CHKLOC00  * Checks mandatory fields & checks for blank
          BRANCH    EXIT,HOSLOC99
          PACK      KEY10,PTLOC001,PTLOC002,SP70  
          CALL      RDWBHD1 
          COMPARE   ZERO,OVRCD
          GOTO      HOSLOC92 IF EQUAL
          CALL      LOCSAV00      * Moves input variables to file variables
          CALL      WRWBHD1       * Writes away the data
          MOVE      ZERO,EXIT
          GOTO      HOSLOC99
.
.         ************ UPDATE FORMACTION ************
.
HOSLOC20  PACK      KEY10,PTLOC001,PTLOC002,SP70  
          CALL      RDWBHD1 
          BRANCH    OVRCD,HOSLOC91
          CALL      CHKLOC00      * Checks mandatory fields
          BRANCH    EXIT,HOSLOC99
          CALL      RLWBHD1       * Read Lock Record
          CALL      LOCSAV00      * Moves input variables to file variables
          CALL      UPWBHD1       * Update Record 
          CALL      UUWBHD1       * Unlock Record 
          MOVE      ZERO,EXIT
          GOTO      HOSLOC99
.
.         ************ DELETE FORMACTION **********
.
HOSLOC30  PACK      KEY10,PTLOC001,PTLOC002,SP70   
          CALL      RDWBHD1 
          BRANCH    OVRCD,HOSLOC91
          CALL      DEWBHD1       * Deletes the data
          MOVE      ZERO,EXIT
          GOTO      HOSLOC99
.
.         ************ DISPLAY FORMACTION ********
.
HOSLOC40  PACK      KEY4,PTHOS001,SP70   * Read Hospital File (Parent) 
          CALL      RDHOSP1 
          BRANCH    OVRCD,HOSLOC94 
          MOVE      HOSCODE,HOSPCODE
          MOVE      DHOSINDX,UNIQID      * Hospital Unique ID
.
          PACK      KEY10,PTLOC001,PTLOC002,SP70 * Read Location File (Child)
          CALL      RDWBHD1    
          IF        OVRCD=1
            CALL      CLRLOC00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Hospital Data File Location Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,HOSLOC99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      HOSLOC99
.
HOSLOC91  MOVE      "File Name does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      HOSLOC99
.
HOSLOC92  MOVE      "File Name exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      HOSLOC99
.
HOSLOC93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      HOSLOC99
.
HOSLOC94  MOVE      "Invalid Hospital!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      HOSLOC99
.
HOSLOC99  RETURN
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRLOC00  MOVE      SP70,WBHDHID    * Hospital Unique ID 
          MOVE      SP70,WBHDFIL    * File name                  
          MOVE      SP70,WBHDPATH   * Path to Open                          
          MOVE      SP70,WBHDSPA    * spare variable
.
CLRLOC99  RETURN
.------------------------------------------------------------
. Moves cgi variables into file variables
.------------------------------------------------------------
LOCSAV00  MOVE      PTLOC001,WBHDHID    * Hospital Unique ID 
          MOVE      PTLOC002,WBHDFIL    * File name                  
          MOVE      PTLOC003,WBHDPATH   * Path to Open                          
          MOVE      SP70,WBHDSPA        * spare variable
.
LOCSAV99  RETURN
.------------------------------------------------------------------
. * Checks mandatory fields and checks for blank
.------------------------------------------------------------------
CHKLOC00  RESET     PTLOC002
          MATCH     SP70,PTLOC002
          GOTO      CHKLOC90 IF EQUAL
.
          RESET     PTLOC003
          MATCH     SP70,PTLOC003
          GOTO      CHKLOC91 IF EQUAL
.
          GOTO      CHKLOC98
.
CHKLOC90  MOVE      "File Name is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKLOC99
.
CHKLOC91  MOVE      "Path to Open is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKLOC99
.
CHKLOC98  MOVE      ZERO,EXIT
CHKLOC99  RETURN
.------------------------------------------------------------
. LGA Code Maintenance
.------------------------------------------------------------
PATLGA00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      PATLGA40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      PATLGA10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      PATLGA20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      PATLGA30 IF EQUAL
.
          GOTO      PATLGA93
.
.
.         ************ 2ADD FORMACTION ***********
.
PATLGA10  CALL      CHKLGA00      * Checks mandatory fields
          BRANCH    EXIT,PATLGA99
          PACK      KEY4,PTLGA001,SP70
          CALL      RDLGAA1 
          COMPARE   ZERO,OVRCD
          GOTO      PATLGA92 IF EQUAL
.
          CALL      LGASAV00      * Moves input variables to file variables
          PACK      KEY4,PTLGA001,SP70
          CALL      WRLGAA1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      PATLGA99
.
.         ************ UPDATE FORMACTION **********
.
PATLGA20  PACK      KEY4,PTLGA001,SP70
          CALL      RDLGAA1 
          BRANCH    OVRCD,PATLGA91
          CALL      CHKLGA00      * Checks mandatory fields
          BRANCH    EXIT,PATLGA99
.
          CALL      LGASAV00      * Moves input variables to file variables
          PACK      KEY4,PTLGA001,SP70
          CALL      UPLGAA1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      PATLGA99
.
.         ************ DELETE FORMACTION **********
.
PATLGA30  PACK      KEY4,PTLGA001,SP70
          CALL      RDLGAA1 
          BRANCH    OVRCD,PATLGA91
          CALL      DELGAA1 
.
          MOVE      ZERO,EXIT
          GOTO      PATLGA99
.
.         ************ DISPLAY FORMACTION **********
.
PATLGA40  PACK      KEY4,PTLGA001,SP70
          CALL      RDLGAA1 
          IF        OVRCD=1
            CALL      CLRLGA00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "LGA Code Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PATLGA99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      PATLGA99
.
PATLGA91  MOVE      "LGA Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATLGA99
.
PATLGA92  MOVE      "LGA Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATLGA99
.
PATLGA93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATLGA99
.
PATLGA99  RETURN
.-----------------------------------------------------------
. Initialize's file data (LGA Code Maintenance)
.-----------------------------------------------------------
CLRLGA00  MOVE      SP70,LGACODE 
          MOVE      SP70,LGADESC 
.
CLRLGA99  RETURN
.-----------------------------------------------------------------
. Moves cgi variables into file variables (LGA Code Maintenance)
.-----------------------------------------------------------------
LGASAV00  MOVE      PTLGA001,LGACODE 
          MOVE      PTLGA002,LGADESC 
.
LGASAV99  RETURN
.------------------------------------------------------------
. Checks mandatory fields (LGA Code Maintenance)
.------------------------------------------------------------
CHKLGA00  RESET     PTLGA001
          MATCH     SP70,PTLGA001
          GOTO      CHKLGA90 IF EQUAL
.
          GOTO      CHKLGA98
.
CHKLGA90  MOVE      "LGA Code is mandatory",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKLGA99
.
CHKLGA98  MOVE      ZERO,EXIT
CHKLGA99  RETURN
.------------------------------------------------------------
. Nursing Station Maintenance
.------------------------------------------------------------
PATNUR00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      PATNUR40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      PATNUR10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      PATNUR20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      PATNUR30 IF EQUAL
.
          GOTO      PATNUR93
.
.
.         ************ ADD FORMACTION ***********
.
PATNUR10  CALL      CHKNUR00      * Checks mandatory fields
          BRANCH    EXIT,PATNUR99
          PACK      KEY6,PTNUR001,PTNUR002,SP70
          CALL      RDNURS1
          COMPARE   ZERO,OVRCD
          GOTO      PATNUR92 IF EQUAL
.
          CALL      NURSAV00      * Moves input variables to file variables
          PACK      KEY5,PTNUR001,PTNUR002,SP70
          MOVE      SP70,NWARD    * Moves space into because parent record
          CALL      WRNURS1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      PATNUR99
.
.         ************ UPDATE FORMACTION **********
.
PATNUR20  PACK      KEY6,PTNUR001,PTNUR002,SP70
          CALL      RDNURS1
          BRANCH    OVRCD,PATNUR91
          CALL      CHKNUR00      * Checks mandatory fields
          BRANCH    EXIT,PATNUR99
.
          PACK      KEY5,PTNUR001,PTNUR002,SP70
          CALL      NURSAV00      * Moves input variables to file variables
          CALL      UPNURS1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      PATNUR99
.
.         ************ DELETE FORMACTION **********
.
PATNUR30  PACK      KEY6,PTNUR001,PTNUR002,SP70
          CALL      RDNURS1
          BRANCH    OVRCD,PATNUR91
          CALL      DENURS1
.
          MOVE      ZERO,EXIT
          GOTO      PATNUR99
.
.         ************ DISPLAY FORMACTION **********
.
PATNUR40  PACK      KEY6,PTNUR001,PTNUR002,SP70
          CALL      RDNURS1
          IF        OVRCD=1
            CALL      CLRNUR00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Nursing Station Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PATNUR99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      PATNUR99
.
PATNUR91  MOVE      "Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATNUR99
.
PATNUR92  MOVE      "Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATNUR99
.
PATNUR93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATNUR99
.
PATNUR99  RETURN
.-----------------------------------------------------------
. Initialize's file data (Nursing Station Maintenance)
.-----------------------------------------------------------
CLRNUR00  MOVE      SP70,NSTAT
          MOVE      SP70,NWARD
          MOVE      SP70,NSDESC
          MOVE      SP70,NSIST
          MOVE      SP70,NSEXTN
.
CLRNUR99  RETURN
.-----------------------------------------------------------------
. Moves cgi variables into file variables (Nursing Station Maintenance)
.-----------------------------------------------------------------
NURSAV00  MOVE      PTNUR001,NSTAT
          MOVE      PTNUR002,NWARD
          MOVE      PTNUR003,NSDESC
          MOVE      PTNUR004,NSIST
          MOVE      PTNUR005,NSEXTN
NURSAV99  RETURN
.------------------------------------------------------------
. * Checks mandatory fields (Nursing Station Maintenance)
.------------------------------------------------------------
CHKNUR00  RESET     PTNUR001
          MATCH     SP70,PTNUR001
          GOTO      CHKNUR90 IF EQUAL
.
          GOTO      CHKNUR98
.
CHKNUR90  MOVE      "Station Number is mandatory",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKNUR99
.
CHKNUR98  MOVE      ZERO,EXIT
CHKNUR99  RETURN
.------------------------------------------------------------
. Nursing Ward Maintenance
.------------------------------------------------------------
PATWAR00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      PATWAR40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      PATWAR10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      PATWAR20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      PATWAR30 IF EQUAL
.
          GOTO      PATWAR93
.
.
.         ************ ADD FORMACTION ***********
.
PATWAR10  CALL      CHKWAR00      * Checks mandatory fields
          BRANCH    EXIT,PATWAR99
          PACK      KEY6,PTNUR001,PTNUR002,SP70
          CALL      RDNURS1
          COMPARE   ZERO,OVRCD
          GOTO      PATWAR92 IF EQUAL
.
          CALL      NURSAV00      * Moves input variables to file variables
          PACK      KEY5,PTNUR001,PTNUR002,SP70
          CALL      WRNURS1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      PATWAR99
.
.         ************ UPDATE FORMACTION **********
.
PATWAR20  PACK      KEY6,PTNUR001,PTNUR002,SP70
          CALL      RDNURS1
          BRANCH    OVRCD,PATWAR91
          CALL      CHKWAR00      * Checks mandatory fields
          BRANCH    EXIT,PATWAR99
.
          PACK      KEY5,PTNUR001,PTNUR002,SP70
          CALL      NURSAV00      * Moves input variables to file variables
          CALL      UPNURS1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      PATWAR99
.
.         ************ DELETE FORMACTION **********
.
PATWAR30  PACK      KEY6,PTNUR001,PTNUR002,SP70
          CALL      RDNURS1
          BRANCH    OVRCD,PATWAR91
          CALL      DENURS1
.
          MOVE      ZERO,EXIT
          GOTO      PATWAR99
.
.         ************ DISPLAY FORMACTION **********
.
PATWAR40  PACK      KEY6,PTNUR001,PTNUR002,SP70
          CALL      RDNURS1
          IF        OVRCD=1
            CALL      CLRNUR00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Nursing Ward Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PATWAR99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      PATWAR99
.
PATWAR91  MOVE      "Ward does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATWAR99
.
PATWAR92  MOVE      "Ward exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATWAR99
.
PATWAR93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATWAR99
.
PATWAR99  RETURN
.------------------------------------------------------------
. * Checks mandatory fields (Nursing Ward Maintenance)
.------------------------------------------------------------
CHKWAR00  RESET     PTNUR002
          MATCH     SP70,PTNUR002
          GOTO      CHKWAR90 IF EQUAL
.
          GOTO      CHKWAR98
.
CHKWAR90  MOVE      "Ward Number is mandatory",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKWAR99
.
CHKWAR98  MOVE      ZERO,EXIT
CHKWAR99  RETURN
.------------------------------------------------------------
. LGA Post Code Maintenance
.------------------------------------------------------------
PATLGP00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      PATLGP40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      PATLGP10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      PATLGP20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      PATLGP30 IF EQUAL
.
          GOTO      PATLGP93
.
.
.         ************ ADD FORMACTION ***********
.
PATLGP10  CALL      CHKLGP00      * Checks mandatory fields
          BRANCH    EXIT,PATLGP99
          PACK      KEY12,PTLGP001,PTLGP002,SP70
          CALL      RDPTLGP1
          COMPARE   ZERO,OVRCD
          GOTO      PATLGP92 IF EQUAL
.
          CALL      LGPSAV00      * Moves input variables to file variables
          PACK      KEY12,PTLGP001,PTLGP002,SP70
          CALL      WRPTLGP1      * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      PATLGP99
.
.         ************ UPDATE FORMACTION **********
.
PATLGP20  PACK      KEY12,PTLGP001,PTLGP002,SP70
          CALL      RDPTLGP1
          BRANCH    OVRCD,PATLGP91
          CALL      CHKLGP00      * Checks mandatory fields
          BRANCH    EXIT,PATLGP99
.
          CALL      LGPSAV00      * Moves input variables to file variables
          PACK      KEY12,PTLGP001,PTLGP002,SP70
          CALL      UPPTLGP1      * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      PATLGP99
.
.         ************ DELETE FORMACTION **********
.
PATLGP30  PACK      KEY12,PTLGP001,PTLGP002,SP70
          CALL      RDPTLGP1
          BRANCH    OVRCD,PATLGP91
          CALL      DEPTLGP1
.
          MOVE      ZERO,EXIT
          GOTO      PATLGP99
.
.         ************ DISPLAY FORMACTION **********
.
PATLGP40  PACK      KEY4,PTLGP002,SP70
          CALL      RDLGAA1
.
          PACK      KEY12,PTLGP001,PTLGP002,SP70
          CALL      RDPTLGP1
          IF        OVRCD=1
            CALL      CLRLGP00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "LGA Post Code Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PATLGP99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      PATLGP99
.
PATLGP91  MOVE      "LGA Post Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATLGP99
.
PATLGP92  MOVE      "LGA Post Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATLGP99
.
PATLGP93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATLGP99
.
PATLGP99  RETURN
.-----------------------------------------------------------
. Initialize's file data (LGA Post Code Maintenance)
.-----------------------------------------------------------
CLRLGP00  MOVE      SP70,PTLGPOST 
          MOVE      SP70,PTLGLGAC 
.
CLRLGP99  RETURN
.-----------------------------------------------------------------
. Moves cgi variables into file variables (LGA Post Code Maintenance)
.-----------------------------------------------------------------
LGPSAV00  MOVE      PTLGP001,PTLGPOST 
          MOVE      PTLGP002,PTLGLGAC 
.
LGPSAV99  RETURN
.------------------------------------------------------------
. Checks mandatory fields (LGA Post Code Maintenance)
.------------------------------------------------------------
CHKLGP00  RESET     PTLGP001
          MATCH     SP70,PTLGP001
          GOTO      CHKLGP90 IF EQUAL
.
          RESET     PTLGP002
          MATCH     SP70,PTLGP002
          GOTO      CHKLGP91 IF EQUAL

          GOTO      CHKLGP98
.
CHKLGP90  MOVE      "LGA Post Code is mandatory",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKLGP99
.
CHKLGP91  MOVE      "LGA Code is mandatory",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKLGP99
.
CHKLGP98  MOVE      ZERO,EXIT
CHKLGP99  RETURN
.------------------------------------------------------------
. Catchment Code Maintenance
.------------------------------------------------------------
PATCTC00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      PATCTC40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      PATCTC10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      PATCTC20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      PATCTC30 IF EQUAL
.
          GOTO      PATCTC93
.
.
.         ************ ADD FORMACTION ***********
.
PATCTC10  CALL      CHKCTC00      * Checks mandatory fields
          BRANCH    EXIT,PATCTC99
          PACK      KEY8,PTCTC001,SP70
          CALL      RDCATC1 
          COMPARE   ZERO,OVRCD
          GOTO      PATCTC92 IF EQUAL
.
          CALL      CTCSAV00      * Moves input variables to file variables
          PACK      KEY8,PTCTC001,SP70
          CALL      WRCATC1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      PATCTC99
.
.         ************ UPDATE FORMACTION **********
.
PATCTC20  PACK      KEY8,PTCTC001,SP70
          CALL      RDCATC1 
          BRANCH    OVRCD,PATCTC91
          CALL      CHKCTC00      * Checks mandatory fields
          BRANCH    EXIT,PATCTC99
.
          CALL      CTCSAV00      * Moves input variables to file variables
          PACK      KEY8,PTCTC001,SP70
          CALL      UPCATC1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      PATCTC99
.
.         ************ DELETE FORMACTION **********
.
PATCTC30  PACK      KEY8,PTCTC001,SP70
          CALL      RDCATC1 
          BRANCH    OVRCD,PATCTC91
          CALL      DECATC1 
.
          MOVE      ZERO,EXIT
          GOTO      PATCTC99
.
.         ************ DISPLAY FORMACTION **********
.
PATCTC40  PACK      KEY8,PTCTC001,SP70
          CALL      RDCATC1 
          IF        OVRCD=1
            CALL      CLRCTC00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Catchment Code Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PATCTC99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      PATCTC99
.
PATCTC91  MOVE      "Catchment Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATCTC99
.
PATCTC92  MOVE      "Catchment Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATCTC99
.
PATCTC93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATCTC99
.
PATCTC99  RETURN
.-----------------------------------------------------------
. Initialize's file data (Catchment Code Maintenance)
.-----------------------------------------------------------
CLRCTC00  MOVE      SP70,CTCPOST  
          MOVE      SP70,CTCCODE  
          MOVE      SP70,CTCLGA   
.
CLRCTC99  RETURN
.-----------------------------------------------------------------
. Moves cgi variables into file variables (Catchment Code Maintenance)
.-----------------------------------------------------------------
CTCSAV00  MOVE      PTCTC001,CTCPOST  
          MOVE      PTCTC002,CTCCODE  
          MOVE      PTCTC003,CTCLGA   
.
CTCSAV99  RETURN
.------------------------------------------------------------
. Checks mandatory fields (Catchment Code Maintenance)
.------------------------------------------------------------
CHKCTC00  RESET     PTCTC001
          MATCH     SP70,PTCTC001
          GOTO      CHKCTC90 IF EQUAL

          GOTO      CHKCTC98
.
CHKCTC90  MOVE      "Post Code is mandatory",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKCTC99
.
CHKCTC98  MOVE      ZERO,EXIT
CHKCTC99  RETURN
.----------------------------------------------------------------
. Casemix Code Table Maintenance: Display,Add,Update,Delete
.----------------------------------------------------------------
PATCMC00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      PATCMC40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      PATCMC10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      PATCMC20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      PATCMC30 IF EQUAL
.
          MATCH     "R",UPDTTYPE    * Regenerate keyword index
          GOTO      PATCMC50 IF EQUAL
.
          GOTO      PATCMC93
.
.         ************ ADD FORMACTION ***********
.
PATCMC10  CALL      CHKCMC00      * Checks mandatory fields
          BRANCH    EXIT,PATCMC99
          PACK      KEY9,PATCM001,SP70
          CALL      RDPTCMC1
          COMPARE   ZERO,OVRCD
          GOTO      PATCMC92 IF EQUAL
.
          CALL      SAVCMC00      * Moves input variables to file variables
          PACK      KEY9,PATCM001,SP70
          CALL      WRPTCMC1      * Writes away the data
          PROC      PATKCMUP
.
.          MOVE      "A",KEY1      * Set Add Parameter for SEMAUD00
.          CALL      CMCAUD00      * Write Audit File if Needed
.
          MOVE      ZERO,EXIT
          GOTO      PATCMC99
.
.         ************ UPDATE FORMACTION **********
.
PATCMC20  PACK      KEY9,PATCM001,SP70
          CALL      RDPTCMC1
          BRANCH    OVRCD,PATCMC91
          CALL      CHKCMC00      * Checks mandatory fields
          BRANCH    EXIT,PATCMC99
.
.          MOVE      "B",KEY1      * Set Before Changes Parameter for SEMAUD00
.          CALL      CMCAUD00      * Write Audit File if Needed
.
          CALL      SAVCMC00      * Moves input variables to file variables
          PACK      KEY9,PATCM001,SP70
          CALL      UPPTCMC1      * Writes away the data
          PROC      PATKCMUP
.
.          MOVE      "C",KEY1      * Set After Changes Parameter for SEMAUD00
.          CALL      CMCAUD00      * Write Audit File if Needed
.
          MOVE      ZERO,EXIT
          GOTO      PATCMC99
.
.         ************ DELETE FORMACTION **********
.
PATCMC30  PACK      KEY9,PATCM001,SP70
          CALL      RDPTCMC1
          BRANCH    OVRCD,PATCMC91
.
          CALL      DEPTCMC1
          PROC      PATKCMUP
.
.          MOVE      "D",KEY1      * Set Delete Parameter for SEMAUD00
.          CALL      CMCAUD00      * Write Audit File if Needed
.
          MOVE      ZERO,EXIT
          GOTO      PATCMC99
.
.         ************ DISPLAY FORMACTION **********
.
PATCMC40  PACK      KEY9,PATCM001,SP70
          CALL      RDPTCMC1
          IF        OVRCD=1
            CALL      CLRCMC00  * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Casemix Codes Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PATCMC99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      PATCMC99
.
.         ************ SCHEDULE REGENERATE KEYWORD INDEX **********
.
PATCMC50  MOVE      ZERO,EXIT
          PACK      SCHDDATE,CCC,CYY,CMM,CDD
          REP       " 0",SCHDDATE
          CLOCK     TIME,SCHDTIME
.
          MOVE      "GENERCMC",SCHDPGID
          MOVE      "Regenerate Casemix Codes",SCHDDESC
          MOVE      "Y",KEYSTARR[1]         * Option
          MOVE      ONE,KEYSTCNT            * Number of Keyins

          CALL      SCHPRO00                * Schedule Extract
          GOTO      PATCMC99
.
PATCMC91  MOVE      "record does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATCMC99
.
PATCMC92  MOVE      "record exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATCMC99
.
PATCMC93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATCMC99
.
PATCMC99  RETURN
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRCMC00  MOVE      SP70,PTCACODE    * Casemix Code
          MOVE      SP70,PTCADES1    * Description 1
          MOVE      SP70,PTCADES2    * Description 2
          MOVE      ZERO,PTCAELOS    * Expected Length of stay
          MOVE      ZERO,PTCAACTV    * Status   1 = Active 0 = Inactive
          MOVE      SP70,PTCSPARE    * Spare
.
CLRCMC99  RETURN
.-----------------------------------------------------------
. Save routine - move cgi parameters into file variables
.-----------------------------------------------------------
SAVCMC00  MOVE      PATCM001,PTCACODE    * Casemix Code
          MOVE      PATCM002,PTCADES1    * Description 1
          MOVE      PATCM003,PTCADES2    * Description 2
          MOVE      PATCM004,PTCAELOS    * Expected Length of stay
.
          COMPARE   TWO,PATCM005         * Status 1 = Active 0 = Non-Active
          IF        @EQUAL
            MOVE      ONE,PTCAACTV
          ELSE
            MOVE      ZERO,PTCAACTV
          ENDIF
.
          MOVE      SP70,PTCSPARE        * Spare
.
SAVCMC99  RETURN
.------------------------------------------------------------
. * Checks mandatory fields
.------------------------------------------------------------
CHKCMC00  RESET     PATCM001
          MATCH     SP70,PATCM001
          GOTO      CHKCMC90 IF EQUAL
.
          GOTO      CHKCMC98
.
CHKCMC90  MOVE      "Casmix Code is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKCMC99
.
CHKCMC98  MOVE      ZERO,EXIT
CHKCMC99  RETURN
.---------------------------------------------------------------------
. Writes Casemix Codes Table - Schedule Audit
.    Parameters :   KEY1 - Set Record Type
.---------------------------------------------------------------------
.CMCAUD00  BRANCH    OPCNAUDM,SEMAUD99  * Check if audit needs to be written
.          CALL      IBACLOCK
.          PACK      PTCAAUDD,CCC,CYY,CMM,CDD     * Date
.          REP       " 0",PTCAAUDD
.          MOVE      CTIMEIS,PTCAAUDT
.          MOVE      PORT,PTCAAUDP                * Port
.          MOVE      KEY1,PTCAAUDR                * Record Type
.          MOVE      ONE,PTCAAUDS                 * Not Printed
.          MOVE      PASSCODE,PTCAAUDO            * Operator
.
.          PACK      KEY19,PTCAAUDD,PTCAAUDT,PTCAAUDP,PTCAAUDR
.          CALL      AWPTCMC                      * Write Audit File
.
.CMCAUD99  RETURN
.
.------------------------------------------------------------
. DRG Code Maintenance: Display,Add,Update,Delete
.------------------------------------------------------------
PATDRG00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      PATDRG40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      PATDRG10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      PATDRG20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      PATDRG30 IF EQUAL
.
          GOTO      PATDRG93
.
PATDRG10  CALL      CHKDRG00  * Checks mandatory fields & checks for blank
          BRANCH    EXIT,PATDRG99
          PACK      KEY7,PTDRG001,PTDRG008,SP70  * ADD FORMACTION     *C-137125
          PACK      PTDRG009,PTDRG008,SP70
          CALL      RDPTDGW1
          COMPARE   ZERO,OVRCD
          GOTO      PATDRG92 IF EQUAL
          CALL      DRGSAV00      * Moves input variables to file variables
          CALL      WRPTDGW1      * Writes away the data
          PROC      PATKDRUP      * Update Keyword table
          MOVE      ZERO,EXIT
          GOTO      PATDRG99
.
PATDRG20  PACK      KEY7,PTDRG001,PTDRG009,SP70  * UPDATE FORMACTION  *C-137125
          CALL      RDPTDGW1
          BRANCH    OVRCD,PATDRG91
          CALL      CHKDRG00      * Checks mandatory fields
          BRANCH    EXIT,PATDRG99
          CALL      DRGSAV00      * Moves input variables to file variables
          CALL      UPPTDGW1      * Writes away the data
          PROC      PATKDRUP      * Update Key word Table
          MOVE      ZERO,EXIT
          GOTO      PATDRG99
.
PATDRG30  PACK      KEY7,PTDRG001,PTDRG009,SP70   * DELETE FORMACTION *C-137125
          CALL      RDPTDGW1
          BRANCH    OVRCD,PATDRG91
          CALL      DEPTDGW1      * Deletes the data
          PROC      PATKDRUP      * Update Key word Table
          MOVE      ZERO,EXIT
          GOTO      PATDRG99
.
PATDRG40  PACK      PTDRG001,DRGCODES,SP70 * CGI parameter from table  
          PACK      PTDRG008,DRGVERZ,SP70                             *I-137125
          PACK      KEY7,PTDRG001,PTDRG008,SP70                       *I-137125
          CALL      RDPTDGW1
          IF        OVRCD=1
            CALL      CLRDRG00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "DRG Code Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PATDRG99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      PATDRG99
.
PATDRG91  MOVE      "DRG Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATDRG99
.
PATDRG92  MOVE      "DRG Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATDRG99
.
PATDRG93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATDRG99
.
PATDRG99  RETURN
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRDRG00  MOVE      SP70,PTDWDRGC
          MOVE      SP70,PTDWMDCC
          MOVE      SP70,PTDWDESC
          MOVE      ZERO,PTDWLOWT
          MOVE      ZERO,PTDWHIGH
          MOVE      ZERO,PTDWRWGT
          MOVE      SP70,PTDWCLSP
          MOVE      SP70,PTDWDRGV
          MOVE      SP70,PTDWDRGT
          MOVE      SP70,PTDWSPAR
.
CLRDRG99  RETURN
.------------------------------------------------------------
. Moves cgi variables into file variables
.------------------------------------------------------------
DRGSAV00  MOVE      PTDRG001,KEY4
          SQUEEZE   KEY4
          MOVE      KEY4,PTDWDRGC
          MOVE      PTDRG002,KEY4
          SQUEEZE   KEY4
          MOVE      KEY4,PTDWMDCC
          MOVE      PTDRG003,PTDWDESC
          MOVE      PTDRG004,PTDWLOWT
          MOVE      PTDRG005,PTDWHIGH
          MOVE      PTDRG006,PTDWRWGT
          MOVE      PTDRG007,PTDWCLSP
          MOVE      PTDRG009,KEY3
          SQUEEZE   KEY3
          MOVE      KEY3,PTDWDRGV
          MOVE      PTDRG010,PTDWDRGT
.
DRGSAV99  RETURN
.------------------------------------------------------------------
. * Checks mandatory fields and checks for blank
.------------------------------------------------------------------
CHKDRG00  RESET     PTDRG001
          MATCH     SP70,PTDRG001
          GOTO      CHKDRG90 IF EQUAL
.
          RESET     PTDRG002
          MATCH     SP70,PTDRG002
          GOTO      CHKDRG91 IF EQUAL
.
          RESET     PTDRG003
          MATCH     SP70,PTDRG003
          GOTO      CHKDRG92 IF EQUAL
.
          RESET     PTDRG008
          MATCH     SP70,PTDRG008
          GOTO      CHKDRG93 IF EQUAL
.
          GOTO      CHKDRG98
.
CHKDRG90  MOVE      "DRG Code is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKDRG99
.
CHKDRG91  MOVE      "MDC Code is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKDRG99
.
CHKDRG92  MOVE      "Description is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKDRG99
.
CHKDRG93  MOVE      "DRG Version is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKDRG99
.
CHKDRG98  MOVE      ZERO,EXIT
CHKDRG99  RETURN
+
.------------------------------------------------------------
. Hospital details Maintenance
.------------------------------------------------------------
HOSDET00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      HOSDET40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      HOSDET10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      HOSDET20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      HOSDET30 IF EQUAL
.
          GOTO      HOSDET93
.
.
.         ************ ADD FORMACTION ***********
.
HOSDET10  CALL      CHKHSP00      * Checks mandatory fields
          BRANCH    EXIT,HOSDET99
          PACK      KEY3,PTHSP001,SP70
          CALL      RDPTHSP1
          COMPARE   ZERO,OVRCD
          GOTO      HOSDET92 IF EQUAL
.
          CALL      HSPSAV00      * Moves input variables to file variables
          PACK      KEY3,PTHSP001,SP70
          PACK      PTHSSPAR,SP70,SP70
          CALL      WRPTHSP1      * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      HOSDET99
.
.         ************ UPDATE FORMACTION **********
.
HOSDET20  PACK      KEY3,PTHSP001,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,HOSDET91
          CALL      CHKHSP00      * Checks mandatory fields
          BRANCH    EXIT,HOSDET99
.
          PACK      KEY3,PTHSP001,SP70
          CALL      HSPSAV00      * Moves input variables to file variables
          CALL      UPPTHSP1      * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      HOSDET99
.
.         ************ DELETE FORMACTION **********
.
HOSDET30  PACK      KEY3,PTHSP001,SP70
          CALL      RDPTHSP1
          BRANCH    OVRCD,HOSDET91
          CALL      DEPTHSP1
.
          MOVE      ZERO,EXIT
          GOTO      HOSDET99
.
.         ************ DISPLAY FORMACTION **********
.
HOSDET40  PACK      KEY3,PTHSP001,SP70
          CALL      RDPTHSP1
          IF        OVRCD=1
            MATCH     SP70,KEY3
            IF        !@EQUAL
              BRANCH    FHIRTYPE,HOSDET91
            ENDIF
            CALL      CLPATHSP    * Clear all the file variables      *C-251645
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Hospital Details Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,HOSDET99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      HOSDET99
.
HOSDET91  MOVE      "Hospital ID does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      HOSDET99
.
HOSDET92  MOVE      "Hospital ID exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      HOSDET99
.
HOSDET93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      HOSDET99
.
HOSDET99  RETURN
.-----------------------------------------------------------------------
. Moves cgi variables into file variables (Hospital details Maintenance)
.-----------------------------------------------------------------------
HSPSAV00  MOVE      PTHSP001,PTHSHOSP
          MOVE      PTHSP002,PTHSNAME
          MOVE      PTHSP003,PTHSADD1
          MOVE      PTHSP004,PTHSADD2
          MOVE      PTHSP005,PTHSADD3
          MOVE      PTHSP006,PTHSADD4
          MOVE      PTHSP007,PTHSPCOD
          MOVE      PTHSP008,PTHSTELE
          MOVE      PTHSP009,PTHSFAXN
          MOVE      PTHSP010,PTHSUNIT
          MOVE      PTHSP011,PTHSHDPC
          MOVE      PTHSP012,PTHSMRPR
          MOVE      PTHSP013,PTHSPACT
          MOVE      PTHSP014,PTHSNUMB
          MOVE      PTHSP015,PTHSPMBS
          MOVE      PTHSP016,PTHSTFEE
          MOVE      PTHSP017,PTHSHLOC
          MOVE      PTHSP018,PTHSRCTY
          MOVE      PTHSP019,PTHSVOLM
          MOVE      PTHSP020,PTHSSTAT
          MOVE      PTHSP021,PTHSDCLM
          MOVE      PTHSP022,PTHSAPPR
          MOVE      PTHSP023,PTHSUFMS
          MOVE      PTHSP024,PTHSABNN
          MOVE      PTHSP025,PTHSHSID
          MOVE      PTHSP026,PTHSHCEN
          MOVE      PTHSP027,PTHSPTIN
          MOVE      PTHSP028,PTHSSPID
          MOVE      PTHSP029,PTHSEDIP
          MOVE      PTHSP030,PTHSORID
          MOVE      PTHSP031,PTHSMORG
          MOVE      PTHSP032,PTHSCHOT
          MOVE      PTHSP033,PTHSCHOD
          MOVE      PTHSP034,PTHSHOST
          MOVE      PTHSP035,PTHSUDVA
          MOVE      PTHSP036,PTHSLOCN
          MOVE      PTHSP037,PTHSERRE
          MOVE      PTHSP038,PTHSERCD
          MOVE      PTHSP039,PTHSERCA
          MOVE      PTHSP040,PTHSCFCD
          MOVE      PTHSP041,PTHSSNAM
          MOVE      PTHSP042,PTHSTORD
          MOVE      PTHSP043,PTHSHHOS
          PACK      PTHSCRSR,PTHSP044,SP10
          MOVE      PTHSP045,PTHSEMAL                          (added)
          MOVE      PTHSP046,PTHSERSR                          (added)
          PACK      PTHSRCOP,PTHSP047,SP10                            *I-251645
          PACK      PTHSHBID,PTHSP048,SP10
          PACK      PTHSDCDT,PTHSP049,SP10
          PACK      PTHSHPIO,PTHSP050,SP70
          MOVE      PTHSP051,PTHSCFST
          MOVE      PTHSP052,PTHSHDHB
          MOVE      PTHSP053,PTHSAGNC
          MOVE      PTHSP054,PTHSHSST
          MOVE      PTHSP055,PTHSACTR
          MOVE      PTHSP056,PTHSAGEL
          MOVE      PTHSP057,PTHSAGEH
          MOVE      PTHSP058,PTHSMAPH
.
HSPSAV99  RETURN
.------------------------------------------------------------
. * Checks mandatory fields (Hospital details Maintenance)
.------------------------------------------------------------
CHKHSP00  RESET     PTHSP001
          MATCH     SP70,PTHSP001
          GOTO      CHKHSP90 IF EQUAL
.
          GOTO      CHKHSP98
.
CHKHSP90  MOVE      "Hospital ID is mandatory",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKHSP99
.
CHKHSP98  MOVE      ZERO,EXIT
CHKHSP99  RETURN
+
.------------------------------------------------------------
. Process Fields 
.------------------------------------------------------------
PROFLD00  BRANCH    REPORTNO,PROFLD05,PROFLD10,PROFLD15,PROFLD20,PROFLD25:
                             PROFLD30,PROFLD35,PROFLD40,PROFLD45,PROFLD50:  * 10
                             PROFLD55,PROFLD60,PROFLD10,PROFLD15,PROFLD10:   
                             PROFLD15,PROFLD65,PROFLD10,PROFLD15,PROFLD10:  * 20
                             PROFLD15,PROFLD10,PROFLD15,PROFLD10,PROFLD15:
                             PROFLD70,PROFLD75,PROFLD10,PROFLD15,PROFLD80:  * 30
                             PROFLD10,PROFLD15,PROFLD10,PROFLD15,PROFLD84:
                             PROFLD99,PROFLD10,PROFLD15,PROFL390,PROFLD10:  * 40
                             PROFLD15,PROFLD10,PROFLD15
          GOTO      PROFLD99
.
PROFLD05  CALL      PMBS0000    * MBS ITEM Maintenance
          GOTO      PROFLD99 
.
PROFLD10  CALL      ICOC0000    * ICD10 Procedure Maintenance
          GOTO      PROFLD99 
.
PROFLD15  CALL      ICDC0000    * ICD10 Diagnosis Maintenance
          GOTO      PROFLD99 
.
PROFLD20  CALL      HOSP0000    * Hospital File Maintenance   
          GOTO      PROFLD99 
.
PROFLD25  BRANCH    FLDSETNO,PROFLD26,PROFLD27
          GOTO      PROFLD99 
.
PROFLD26  CALL      HOSP0000    * Hospital File Maintenance   
          GOTO      PROFLD99 
.
PROFLD27  CALL      HOSL0000    * Hospital Data File Location Maintenance   
          GOTO      PROFLD99 
.
PROFLD30  CALL      PATL0000    * LGA Code Maintenance
          GOTO      PROFLD99
.
PROFLD35  CALL      PATN0000    * Nursing Station Maintenance
          GOTO      PROFLD99
.
PROFLD40  BRANCH    FLDSETNO,PROFLD41,PROFLD42
          GOTO      PROFLD99
.
PROFLD41  CALL      PATN0000    * Nursing Station Maintenance
          GOTO      PROFLD99
.
PROFLD42  CALL      PATW0000    * Nursing Ward Maintenance
          GOTO      PROFLD99
.
PROFLD45  BRANCH    FLDSETNO,PROFLD46,PROFLD47
          GOTO      PROFLD99
.
PROFLD46  CALL      PATL0000    * LGA Code Maintenance
          GOTO      PROFLD99
.
PROFLD47  CALL      PATP0000    * LGA Post Code Maintenance
          GOTO      PROFLD99
.
PROFLD50  CALL      PATC0000    * Catchment Code Maintenance
          GOTO      PROFLD99
.
PROFLD55  CALL      PATM0000    * Casemix Code Table Maintenance
          GOTO      PROFLD99 
.
PROFLD60  CALL      PDRG0000    * DRG Code Table Maintenance
          GOTO      PROFLD99 
.
PROFLD65  CALL      HSPD0000    * Hospital Details Maintenance
          GOTO      PROFLD99
.
PROFLD70  CALL      PMCI0000    * Contract ID Maintenance tags
          GOTO      PROFLD99
.
PROFLD75  BRANCH    FLDSETNO,PROFLD76,PROFLD77,PROFLD78
          GOTO      PROFLD99
.
PROFLD76  CALL      PMDI0000    * Division Maintenance tags
          GOTO      PROFLD99
.
PROFLD77  CALL      TABL0000    * General Table tags
          GOTO      PROFLD99
.
PROFLD78  CALL      HSPD0000    * Hospital Details Maintenance
          GOTO      PROFLD99
.
PROFLD80  BRANCH    FLDSETNO,PROFLD81,PROFLD82,PROFLD83
          GOTO      PROFLD99
.
PROFLD81  CALL      PMIH0000    * Hospital Unit HPI-O tags
          GOTO      PROFLD99
.
PROFLD82  CALL      TABL0000    * General Table tags
          GOTO      PROFLD99
.
PROFLD83  CALL      HSPD0000    * Hospital Details Maintenance
          GOTO      PROFLD99
.
PROFLD84  CALL      PTPD0000    * Provisional DRG via CMBS Item Code tags
          GOTO      PROFLD99
.
PROFL390  BRANCH    FLDSETNO,PROFL391
          GOTO      PROFLD99
.
PROFL391  CALL      FVGP0000
          GOTO      PROFLD99
.
PROFLD99  RETURN
.------------------------------------------------------------
. MBS Code Search Server
.------------------------------------------------------------
PMBS0000  BRANCH    FLDITMNO,PMBS0100,PMBS0200,PMBS0300,PMBS0400,PMBS0500:
                             PMBS0600,PMBS0700,PMBS0800,PMBS0900,PMBS1000:
                             PMBS1100,PMBS1200,PMBS1300,PMBS1400,PMBS1500:
                             PMBS1600,PMBS1700,PMBS1800,PMBS1900,PMBS2000:
                             PMBS2100,PMBS2200,PMBS2300,PMBS2400,PMBS2500:
                             PMBS2600,PMBS2700,PMBS2800,PMBS2900,PMBS3000:
                             PMBS3100,PMBS3200,PMBS3300,PMBS3400,PMBS3500:
                             PMBS3600,PMBS3700,PMBS3800,PMBS3900,PMBS4000:
                             PMBS4100,PMBS4200,PMBS4300
          GOTO      PMBS9999
.
PMBS0100  WRITE     HTMLFILE;ITEMNO;
          GOTO      PMBS9999
.
PMBS0200  MATCH     SP70,IALPHA
          GOTO      PMBS9999 IF EQUAL 
          WRITE     HTMLFILE;IALPHA;
          GOTO      PMBS9999
.
PMBS0300  MATCH     SP70,IDESC
          GOTO      PMBS9999 IF EQUAL 
          WRITE     HTMLFILE;IDESC;
          GOTO      PMBS9999
.
PMBS0400  COMPARE   ZERO,QIAMT 
          GOTO      PMBS9999 IF EQUAL 
          WRITE     HTMLFILE;QIAMT;
          GOTO      PMBS9999
.
PMBS0500  MOVE      "FI",CATEGORY
          MOVE      IMISGRP,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS0600  MOVE      "A ",CATEGORY
          MOVE      ICLSS,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS0700  MOVE      "TB",CATEGORY
          MOVE      IBAND1,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS0800  MOVE      "TB",CATEGORY
          MOVE      IBAND2,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS0900  MOVE      "TB",CATEGORY
          MOVE      IBAND3,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS1000  MOVE      "TB",CATEGORY
          MOVE      IBAND4,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS1100  MOVE      "TB",CATEGORY
          MOVE      IBAND5,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS1200  MOVE      "TB",CATEGORY
          MOVE      IBAND6,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS1300  MOVE      "TB",CATEGORY
          MOVE      IBAND7,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS1400  MOVE      "TB",CATEGORY
          MOVE      IBAND8,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS1500  MOVE      "TB",CATEGORY
          MOVE      IBAND9,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS1600  MOVE      "TB",CATEGORY
          MOVE      IBAND10,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS1700  MOVE      "TB",CATEGORY
          MOVE      IBAND11,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS1800  MOVE      "TB",CATEGORY
          MOVE      IBAND12,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS1900  MOVE      "TB",CATEGORY
          MOVE      IBAND13,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS2000  MOVE      "TB",CATEGORY
          MOVE      IBAND14,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS2100  MOVE      "TB",CATEGORY
          MOVE      IBAND15,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS2200  MOVE      "TB",CATEGORY
          MOVE      IBAND16,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS2300  MATCH     SP70,PTITACTV
          IF        @EQUAL 
            WRITE     HTMLFILE;"A";    
          ELSE 
            WRITE     HTMLFILE;PTITACTV;  
          ENDIF 
          GOTO      PMBS9999
.
PMBS2400  WRITE     HTMLFILE;PTITLINK;
          GOTO      PMBS9999
.
PMBS2500  WRITE     HTMLFILE;PTITEXCL;
          GOTO      PMBS9999
.
PMBS2600  WRITE     HTMLFILE;PTITIWRN; 
          GOTO      PMBS9999
.
PMBS2700  CALL      CODIDX00
          GOTO      PMBS9999
.
PMBS2800  MOVE      "A ",CATEGORY
          MOVE      PTITDCSC,CODE
          CALL      CODITM00 
          GOTO      PMBS9999
.
PMBS2900  WRITE     HTMLFILE;PTITGSTA; 
          GOTO      PMBS9999
.
PMBS3000  CALL      CODGST00
          GOTO      PMBS9999
.
PMBS3100  WRITE     HTMLFILE;FILEFLAG; 
          GOTO      PMBS9999
.
PMBS3200  READ      CONTROLF,HUND05;*68,PTCNMBSC 
          WRITE     HTMLFILE;PTCNMBSC;           * Load MBS Items from ascii
          GOTO      PMBS9999
.
PMBS3300  MATCH     SP70,PTITDESC
          GOTO      PMBS9999 IF EQUAL 
          WRITE     HTMLFILE;PTITDESC;
          GOTO      PMBS9999
.
PMBS3400  MOVE      "cr",CATEGORY
          MOVE      PTITTCER,CODE
          CALL      CODITM00
          GOTO      PMBS9999
.
PMBS3500  WRITE     HTMLFILE;PTITMSCH;
          GOTO      PMBS9999
.
PMBS3600  WRITE     HTMLFILE;PTITTCCD;
          GOTO      PMBS9999
.
PMBS3700  WRITE     HTMLFILE;PTITSERV;
          GOTO      PMBS9999
.
PMBS3800  WRITE     HTMLFILE;PTITECEQ;
          GOTO      PMBS9999
.
PMBS3900  WRITE     HTMLFILE;PTITECTS;
          GOTO      PMBS9999
.
PMBS4000  WRITE     HTMLFILE;PTITLWRD;
          GOTO      PMBS9999
.
PMBS4100  MOVE      "TB",CATEGORY
          MOVE      PTITTACB,CODE
          CALL      CODITM00
          GOTO      PMBS9999
.
PMBS4200  MATCH     SP70,PTITEFDT;          * Effective date CCYYMMDD
          GOTO      PMBS9999 IF EQUAL
          UNPACK    PTITEFDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMBS9999
.
PMBS4300  MATCH     SP70,PTITETDT;          * Effective To date CCYYMMDD
          GOTO      PMBS9999 IF EQUAL
          UNPACK    PTITETDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMBS9999
.
PMBS9999  RETURN
.------------------------------------------------------------
. Code Index Page Lookup
.------------------------------------------------------------
CODIDX00  MOVE      "TB",CATEGORY
          PACK      KEY5,CATEGORY,SP70
          CALL      RDSCODE1
CODIDX10  CALL      RDKCODE1
          BRANCH    OVRCD,CODIDX99
          MATCH     CATEGORY,TCODE
          GOTO      CODIDX99 IF NOT EQUAL
          MATCH     SP70,ACODE
          GOTO      CODIDX10 IF EQUAL
          MATCH     "A",PTCOACTV
          GOTO      CODIDX10 IF NOT EQUAL
          PACK      KEY10,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10
          PACK      KEY15,QUOTE,ACODE,KEY10,QUOTE
          STRIP     TDESC
          MOVELPTR  TDESC,LENGTH
          SFORMAT   VAR,LENGTH
          MOVE      TDESC,VAR
          WRITE     HTMLFILE;"<tr><td>":
                             "<img src=../images/SelectItem.gif":
                             " border=0 align=absmiddle hspace=4":
                             " onClick='updateParent01(#"":
                             ACODE,"#",#"",VAR,"#");'>":
                             VAR,"(",ACODE,")</td></tr>"
          SFORMAT   VAR,127
          GOTO      CODIDX10
.
CODIDX99  RETURN
.------------------------------------------------------------
. GST Code Selection List
.------------------------------------------------------------
CODGST00  PACK      KEY6,SP70
          CALL      RSIBGS1
CODGST10  CALL      RKIBGS1
          BRANCH    OVRCD,CODGST99
          COMPARE   "1",IBGSACTV
          GOTO      CODGST10 IF EQUAL
.
          MATCH     PTITGSTC,IBGSCODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",IBGSCODE," selected>":
                               IBGSDESC,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",IBGSCODE,">":
                               IBGSDESC,"</option>"
          ENDIF
.
          GOTO      CODGST10
.
CODGST99  RETURN
.------------------------------------------------------------
. ICD10 Procedure Search Server
.------------------------------------------------------------
ICOC0000  BRANCH    FLDITMNO,ICOC0100,ICOC0200,ICOC0300,ICOC0400,ICOC0500:
                             ICOC0600,ICOC0700,ICOC0800,ICOC0900,ICOC1000:
                             ICOC1100,ICOC1200,ICOC1300,ICOC1400,ICOC1500:
                             ICOC1600,ICOC1700,ICOC1800,ICOC1900,ICOC2000:
                             ICOC2100,ICOC2200,ICOC2300,ICOC2400,ICOC2500:
                             ICOC2600,ICOC2700,ICOC2800,ICOC2900,ICOC3000:
                             ICOC3100,ICOC3200,ICOC3300,ICOC3400,ICOC3500:
                             ICOC3600,ICOC3700,ICOC3800,ICOC3900,ICOC4000:
                             ICOC4100,ICOC4200,ICOC4300,ICOC4400,ICOC4500:
                             ICOC4600,ICOC4700,ICOC4800,ICOC4900,ICOC5000:
                             ICOC5100,ICOC5200,ICOC5300,ICOC5400,ICOC5500:
                             ICOC5600,ICOC5700,ICOC5800,ICOC5900,ICOC6000:
                             ICOC6100,ICOC6200,ICOC6300,ICOC6400,ICOC6500:
                             ICOC6600,ICOC6700,ICOC6800
.                                                                     *C-0956210
.
          GOTO      ICOC9999
.
ICOC0100  CALL      NEXTGR00
          GOTO      ICOC9999
.
ICOC0200  CALL      PREVGR00
          GOTO      ICOC9999
.
ICOC0300  MOVE      ONE,LNK2PRT  * display row with link to detail
          CALL      SPTCOA00   * ICD10 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC0400  WRITE     HTMLFILE;OPCODE;
          GOTO      ICOC9999
.
ICOC0500  WRITE     HTMLFILE;ODESC;
          GOTO      ICOC9999
.
ICOC0600  MATCH     "P",OFLAG 
          IF        @EQUAL
            WRITE     HTMLFILE;"0";  
          ELSE
            WRITE     HTMLFILE;"1";
          ENDIF 
          GOTO      ICOC9999
.
ICOC0700  MATCH     SP70,PT0OBLKN
          GOTO      ICOC9999 IF EQUAL 
          WRITE     HTMLFILE;PT0OBLKN;
          GOTO      ICOC9999
.
ICOC0800  MOVE      OAGEGP,F2
          MATCH     SP70,OAGEGP
          IF        @EQUAL 
            MOVE      ZERO,F2
          ENDIF
          MATCH     "A",OAGEGP
          IF        @EQUAL
            MOVE      "10",F2
          ENDIF
          MATCH     "B",OAGEGP
          IF        @EQUAL
            MOVE      "11",F2
          ENDIF
          MATCH     "C",OAGEGP
          IF        @EQUAL
            MOVE      "12",F2
          ENDIF
          WRITE     HTMLFILE;F2;
          GOTO      ICOC9999
.
ICOC0900  COMPARE   ZERO,OLOW 
          GOTO      ICOC9999 IF EQUAL 
          WRITE     HTMLFILE;OLOW;
          GOTO      ICOC9999
.
ICOC1000  COMPARE   ZERO,OHIGH
          GOTO      ICOC9999 IF EQUAL 
          WRITE     HTMLFILE;OHIGH;
          GOTO      ICOC9999
.
ICOC1100  MOVE      PT0O2AGP,F2
          MATCH     SP70,PT0O2AGP
          IF        @EQUAL
            MOVE      ZERO,F2
          ENDIF
          MATCH     "A",PT0O2AGP
          IF        @EQUAL
            MOVE      "10",F2
          ENDIF
          MATCH     "B",PT0O2AGP
          IF        @EQUAL
            MOVE      "11",F2
          ENDIF
          MATCH     "C",PT0O2AGP
          IF        @EQUAL
            MOVE      "12",F2
          ENDIF
          WRITE     HTMLFILE;F2;
          GOTO      ICOC9999
.
ICOC1200  COMPARE   ZERO,PT0O2ALL
          GOTO      ICOC9999 IF EQUAL 
          WRITE     HTMLFILE;PT0O2ALL;
          GOTO      ICOC9999
.
ICOC1300  COMPARE   ZERO,PT0O2AHL
          GOTO      ICOC9999 IF EQUAL 
          WRITE     HTMLFILE;PT0O2AHL;
          GOTO      ICOC9999
.
ICOC1400  MATCH     SP70,OSEX
          IF        @EQUAL 
            WRITE     HTMLFILE;"0";          
          ELSE
            WRITE     HTMLFILE;OSEX;
          ENDIF
          GOTO      ICOC9999
.
ICOC1500  MATCH     " ",PT0OADTP 
          IF        @EQUAL 
            WRITE     HTMLFILE;"0";          
            GOTO      ICOC9999
          ENDIF
          MATCH     "A",PT0OADTP            
          IF        @EQUAL
            WRITE     HTMLFILE;"1";
          ELSE
            WRITE     HTMLFILE;"2";
          ENDIF
          GOTO      ICOC9999
.
ICOC1600  MATCH     SP70,PT0OSACD
          GOTO      ICOC9999 IF EQUAL 
          WRITE     HTMLFILE;PT0OSACD;
          GOTO      ICOC9999
.
ICOC1700  MATCH     SP70,ODAGGER
          IF        @EQUAL 
            WRITE     HTMLFILE;"0";          
          ELSE
            WRITE     HTMLFILE;ODAGGER;
          ENDIF 
          GOTO      ICOC9999
.
ICOC1800  MATCH     SP70,OAREA
          IF        @EQUAL 
            WRITE     HTMLFILE;"0";          
          ELSE
            WRITE     HTMLFILE;OAREA;
          ENDIF
          GOTO      ICOC9999
.
ICOC1900  MATCH     SP70,PT0OMI9C
          GOTO      ICOC9999 IF EQUAL 
          WRITE     HTMLFILE;PT0OMI9C;
          GOTO      ICOC9999
.
ICOC2000  WRITE     HTMLFILE;PT0OCMFT;
          GOTO      ICOC9999
.
ICOC2100  MOVE      TWO,LNK2PRT  * display row with update parent
          CALL      SPTCOA00   * ICD10 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC2200  WRITE     HTMLFILE;DPT0OV1C;   * Valid ICD10 version 1 code
          GOTO      ICOC9999
.
ICOC2300  WRITE     HTMLFILE;DPT0OV2C;   * Valid ICD10 version 2 code
          GOTO      ICOC9999
.
ICOC2400  WRITE     HTMLFILE;PT0OV1MP;   * ICD10 version 1 map code
          GOTO      ICOC9999
.
ICOC2500  WRITE     HTMLFILE;DPT0OV3C;   * Valid ICD10 version 3 code
          GOTO      ICOC9999
.
ICOC2600  WRITE     HTMLFILE;PT0OV2MP;   * ICD10 version 2 map code
          GOTO      ICOC9999
.
ICOC2700  MOVE      ONE,LNK2PRT  * Display row with link to detail
          CALL      SPT3OA00     * ICD10 V3 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC2800  MOVE      TWO,LNK2PRT  * Display row with update parent
          CALL      SPT3OA00     * ICD10 V3 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC2900  WRITE     HTMLFILE;DPT0OV4C;   * Valid ICD10 Edition 4       *I-49037
          GOTO      ICOC9999
.
ICOC3000  MOVE      ONE,LNK2PRT  * Display row with link to detail     *I-49037
          CALL      SPT4OA00     * ICD10 Ed4 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC3100  MOVE      TWO,LNK2PRT  * Display row with update parent      *I-49037
          CALL      SPT4OA00     * ICD10 Ed4 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC3200  WRITE     HTMLFILE;DPT0OV5C;   * Valid ICD10 Edition 5      *I-105244
          GOTO      ICOC9999
.
ICOC3300  MOVE      ONE,LNK2PRT  * Display row with link to detail    *I-105244
          CALL      SPT5OA00     * ICD10 Ed5 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC3400  MOVE      TWO,LNK2PRT  * Display row with update parent     *I-105244
          CALL      SPT5OA00     * ICD10 Ed5 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC3500  MOVE      ONE,LNK2PRT  * Display row with link to detail
          CALL      SP99OA00     * ICD9 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC3600  MOVE      TWO,LNK2PRT  * Display row with update parent
          CALL      SP99OA00     * ICD9 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC3700  WRITE     HTMLFILE;PT0ODTMN;   * Proc Date/Time non-mandatory (1=Yes)
          GOTO      ICOC9999
.
.                                        * start ICD10 Ed.6           *I-163918
ICOC3800  WRITE     HTMLFILE;DPT0OV6C;   * Valid ICD10 Edition 6
          GOTO      ICOC9999
.
ICOC3900  MOVE      ONE,LNK2PRT  * Display row with link to detail
          CALL      SPT6OA00     * ICD10 Ed6 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC4000  MOVE      TWO,LNK2PRT  * Display row with update parent
          CALL      SPT6OA00     * ICD10 Ed6 Procedure Code: Search Table
          GOTO      ICOC9999             * end                        *I-163918
.
ICOC4100  WRITE     HTMLFILE;PT0ODSC2;
          GOTO      ICOC9999
.
.                                        * start ICD10 Ed.7           *I-219246
ICOC4200  WRITE     HTMLFILE;DPT0OV7C;   * Valid ICD10 Edition 7
          GOTO      ICOC9999
.
ICOC4300  MOVE      ONE,LNK2PRT  * Display row with link to detail
          CALL      SPT7OA00     * ICD10 Ed.7 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC4400  MOVE      TWO,LNK2PRT  * Display row with update parent
          CALL      SPT7OA00     * ICD10 Ed.7 Procedure Code: Search Table
          GOTO      ICOC9999             * end                        *I-219246
.
.                                        * start ICD10 Ed.8           *I-284420
ICOC4500  WRITE     HTMLFILE;DPT0OV8C;   * Valid ICD10 Edition 8
          GOTO      ICOC9999
.
ICOC4600  MOVE      ONE,LNK2PRT  * Display row with link to detail
          CALL      SPT8OA00     * ICD10 Ed.8 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC4700  MOVE      TWO,LNK2PRT  * Display row with update parent
          CALL      SPT8OA00     * ICD10 Ed.8 Procedure Code: Search Table
          GOTO      ICOC9999             * end                        *I-284420
.
.                                        * start ICD10 Ed.9           *I-311669
ICOC4800  WRITE     HTMLFILE;DPT0OV9C;   * Valid ICD10 Edition 9
          GOTO      ICOC9999
.
ICOC4900  MOVE      ONE,LNK2PRT  * Display row with link to detail
          CALL      SPT9OA00     * ICD10 Ed.9 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC5000  MOVE      TWO,LNK2PRT  * Display row with update parent
          CALL      SPT9OA00     * ICD10 Ed.9 Procedure Code: Search Table
          GOTO      ICOC9999             * end                        *I-311669
.
.                                        * start ICD10 Ed.10          *I-0833093
ICOC5100  WRITE     HTMLFILE;DPT0OVXC;   * Valid ICD10 Edition 10
          GOTO      ICOC9999
.
ICOC5200  MOVE      ONE,LNK2PRT  * Display row with link to detail
          CALL      SPTXOA00     * ICD10 Ed.10 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC5300  MOVE      TWO,LNK2PRT  * Display row with update parent
          CALL      SPTXOA00     * ICD10 Ed.10 Procedure Code: Search Table
          GOTO      ICOC9999             * end                        *I-0833093
.
ICOC5400  COMPARE   ZERO,PTXOALL1
          GOTO      ICOC9999 IF EQUAL 
          WRITE     HTMLFILE;PTXOALL1;
          GOTO      ICOC9999
.
ICOC5500  COMPARE   ZERO,PTXOAHL1
          GOTO      ICOC9999 IF EQUAL 
          WRITE     HTMLFILE;PTXOAHL1;
          GOTO      ICOC9999
.
ICOC5600  COMPARE   ZERO,PTXOALL2
          GOTO      ICOC9999 IF EQUAL 
          WRITE     HTMLFILE;PTXOALL2;
          GOTO      ICOC9999
.
ICOC5700  COMPARE   ZERO,PTXOAHL2
          GOTO      ICOC9999 IF EQUAL 
          WRITE     HTMLFILE;PTXOAHL2;
          GOTO      ICOC9999
.
ICOC5800  MOVE      ONE,LNK2PRT  * Display row with link to detail
          CALL      SRHX1P00     * ICD10 Ed.11 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC5900  MOVE      TWO,LNK2PRT  * Display row with update parent
          CALL      SRHX1P00     * ICD10 Ed.11 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC6000  WRITE     HTMLFILE;DPT0OVX1;   * Valid ICD10 Edition 11
          GOTO      ICOC9999
.
ICOC6100  MOVE      PTICO001,MAPTBIND
          CALL      VMTTAB00      * Clinical Coding System Mappings Table
          GOTO      ICOC9999
.                                        * start ICD10 Ed.12          *I-0917793
ICOC6200  MOVE      ONE,LNK2PRT  * Display row with link to detail
          CALL      SRHX2P00     * ICD10 Ed.12 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC6300  MOVE      TWO,LNK2PRT  * Display row with update parent
          CALL      SRHX2P00     * ICD10 Ed.12 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC6400  WRITE     HTMLFILE;DPT0OVX2;   * Valid ICD10 Edition 12
          GOTO      ICOC9999             * end                        *I-0917793
.
ICOC6500  WRITE     HTMLFILE;PT0OURTH;   * Unplanned Return to Theatre Flag
          GOTO      ICOC9999
.                                        * start ICD10 Ed.13          *I-0956210
ICOC6600  MOVE      ONE,LNK2PRT  * Display row with link to detail
          CALL      SRHX3P00     * ICD10 Ed.13 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC6700  MOVE      TWO,LNK2PRT  * Display row with update parent
          CALL      SRHX3P00     * ICD10 Ed.13 Procedure Code: Search Table
          GOTO      ICOC9999
.
ICOC6800  WRITE     HTMLFILE;DPT0OVX3;   * Valid ICD10 Edition 13
          GOTO      ICOC9999             * end                        *I-0956210
.
ICOC9999  RETURN
.------------------------------------------------------------
. ICD10 Diagnosis Search Server
.------------------------------------------------------------
ICDC0000  BRANCH    FLDITMNO,ICDC0100,ICDC0200,ICDC0300,ICDC0400,ICDC0500:
                             ICDC0600,ICDC0700,ICDC0800,ICDC0900,ICDC1000:
                             ICDC1100,ICDC1200,ICDC1300,ICDC1400,ICDC1500:
                             ICDC1600,ICDC1700,ICDC1800,ICDC1900,ICDC2000:
                             ICDC2100,ICDC2200,ICDC2300,ICDC2400,ICDC2500:
                             ICDC2600,ICDC2700,ICDC2800,ICDC2900,ICDC3000:
                             ICDC3100,ICDC3200,ICDC3300,ICDC3400,ICDC3500:     
                             ICDC3600,ICDC3700,ICDC3800,ICDC3900,ICDC4000:
                             ICDC4100,ICDC4200,ICDC4300,ICDC4400,ICDC4500:
                             ICDC4600,ICDC4700,ICDC4800,ICDC4900,ICDC5000:
                             ICDC5100,ICDC5200,ICDC5300,ICDC5400,ICDC5500:
                             ICDC5600,ICDC5700,ICDC5800,ICDC5900,ICDC6000:
                             ICDC6100,ICDC6200,ICDC6300,ICDC6400,ICDC6500:
                             ICDC6600,ICDC6700,ICDC6800,ICDC6900,ICDC7000:
                             ICDC7100,ICDC7200
.                                                                  *C-0956210
          GOTO      ICDC9999
.
ICDC0100  CALL      NEXTGR00
          GOTO      ICDC9999
.
ICDC0200  CALL      PREVGR00
          GOTO      ICDC9999
.
ICDC0300  MOVE      ONE,LNK2PRT  * display row with link
          CALL      SPTCDA00   * ICD10 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC0400  WRITE     HTMLFILE;DPCODE;
          GOTO      ICDC9999
.
ICDC0500  WRITE     HTMLFILE;DDESC;
          GOTO      ICDC9999
.
ICDC0600  MATCH     "P",DFLAG 
          IF        @EQUAL
            WRITE     HTMLFILE;"0";  
          ELSE
            WRITE     HTMLFILE;"1";
          ENDIF 
          GOTO      ICDC9999
.
ICDC0700  MOVE      DAGEGP,F2
          MATCH     SP70,DAGEGP
          IF        @EQUAL
            MOVE      ZERO,F2
          ENDIF
          MATCH     "A",DAGEGP
          IF        @EQUAL
            MOVE      "10",F2
          ENDIF
          MATCH     "B",DAGEGP
          IF        @EQUAL
            MOVE      "11",F2
          ENDIF
          MATCH     "C",DAGEGP
          IF        @EQUAL
            MOVE      "12",F2
          ENDIF
          WRITE     HTMLFILE;F2;
          GOTO      ICDC9999
.
ICDC0800  COMPARE   ZERO,DLOW 
          GOTO      ICDC9999 IF EQUAL 
          WRITE     HTMLFILE;DLOW;
          GOTO      ICDC9999
.
ICDC0900  COMPARE   ZERO,DHIGH
          GOTO      ICDC9999 IF EQUAL 
          WRITE     HTMLFILE;DHIGH;
          GOTO      ICDC9999
.
ICDC1000  MOVE      PT0D2AGP,F2
          MATCH     SP70,PT0D2AGP
          IF        @EQUAL 
            MOVE      ZERO,F2
          ENDIF
          MATCH     "A",PT0D2AGP
          IF        @EQUAL
            MOVE      "10",F2
          ENDIF
          MATCH     "B",PT0D2AGP
          IF        @EQUAL
            MOVE      "11",F2
          ENDIF
          MATCH     "C",PT0D2AGP
          IF        @EQUAL
            MOVE      "12",F2
          ENDIF
          WRITE     HTMLFILE;F2;
          GOTO      ICDC9999
.
ICDC1100  COMPARE   ZERO,PT0D2ALL
          GOTO      ICDC9999 IF EQUAL 
          WRITE     HTMLFILE;PT0D2ALL;
          GOTO      ICDC9999
.
ICDC1200  COMPARE   ZERO,PT0D2AHL
          GOTO      ICDC9999 IF EQUAL 
          WRITE     HTMLFILE;PT0D2AHL;
          GOTO      ICDC9999
.
ICDC1300  MATCH     SP70,DSEX
          IF        @EQUAL 
            WRITE     HTMLFILE;"0";          
          ELSE
            WRITE     HTMLFILE;DSEX;
          ENDIF
          GOTO      ICDC9999
.
ICDC1400  MATCH     " ",PT0DADTP 
          IF        @EQUAL 
            WRITE     HTMLFILE;"0";          
            GOTO      ICDC9999
          ENDIF
          MATCH     "A",PT0DADTP            
          IF        @EQUAL
            WRITE     HTMLFILE;"1";   
          ELSE
            WRITE     HTMLFILE;"2";
          ENDIF
          GOTO      ICDC9999
.
.                                           * use PT0DSACD or PT0DSAC2 C-253821
ICDC1500  IF        ICD10EDN < 4
            MATCH     SP70,PT0DSACD
            GOTO      ICDC9999 IF EQUAL
            WRITE     HTMLFILE;PT0DSACD;
          ELSE                              * Code is ICD10 Ed.4 or greater
            MATCH     SP70,PT0DSAC2
            GOTO      ICDC9999 IF EQUAL
            WRITE     HTMLFILE;PT0DSAC2;
          ENDIF
          GOTO      ICDC9999
.
ICDC1600  MATCH     SP70,DDAGGER
          IF        @EQUAL 
            WRITE     HTMLFILE;"0";          
          ELSE
            WRITE     HTMLFILE;DDAGGER;
          ENDIF 
          GOTO      ICDC9999
.
ICDC1700  MATCH     SP70,DAREA
          IF        @EQUAL 
            WRITE     HTMLFILE;"0";          
          ELSE
            WRITE     HTMLFILE;DAREA;
          ENDIF
          GOTO      ICDC9999
.
ICDC1800  MATCH     SP70,PT0DCPRA
          IF        @EQUAL
            WRITE     HTMLFILE;"0";
          ELSE
            WRITE     HTMLFILE;PT0DCPRA;
          ENDIF
          GOTO      ICDC9999
.
ICDC1900  MATCH     SP70,PT0DACRQ
          IF        @EQUAL
            WRITE     HTMLFILE;"0";
          ELSE
            MATCH     "P",PT0DACRQ
            IF        @EQUAL 
              WRITE     HTMLFILE;NINE;
              GOTO      ICDC9999
            ENDIF
            MATCH     "A",PT0DACRQ
            IF        @EQUAL 
              WRITE     HTMLFILE;TEN;
              GOTO      ICDC9999
            ENDIF
            MATCH     "W",PT0DACRQ
            IF        @EQUAL 
              WRITE     HTMLFILE;TEN1;
              GOTO      ICDC9999
            ENDIF
            WRITE     HTMLFILE;PT0DACRQ;
          ENDIF
          GOTO      ICDC9999
.
ICDC2000  MATCH     SP70,PT0DMI9C
          GOTO      ICDC9999 IF EQUAL 
          WRITE     HTMLFILE;PT0DMI9C;
          GOTO      ICDC9999
.
ICDC2100  WRITE     HTMLFILE;PT0DCMFT;
          GOTO      ICDC9999
.
ICDC2200  MOVE      TWO,LNK2PRT  * display row with update parent
          CALL      SPTCDA00   * ICD10 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC2300  WRITE     HTMLFILE;CANCERCD;
          GOTO      ICDC9999
.
ICDC2400  WRITE     HTMLFILE;PTCCLATR;
          GOTO      ICDC9999
.
ICDC2500  WRITE     HTMLFILE;DPT0DV1C;   * Valid ICD10 version 1 code
          GOTO      ICDC9999
.
ICDC2600  WRITE     HTMLFILE;DPT0DV2C;   * Valid ICD10 version 2 code
          GOTO      ICDC9999
.
ICDC2700  WRITE     HTMLFILE;PT0DV1MP;   * ICD10 version 1 map code
          GOTO      ICDC9999
.
ICDC2800  WRITE     HTMLFILE;DPT0DV3C;   * Valid ICD10 version 3 code
          GOTO      ICDC9999
.
ICDC2900  WRITE     HTMLFILE;PT0DV2MP;   * ICD10 version 2 map code
          GOTO      ICDC9999
.
ICDC3000  MOVE      ONE,LNK2PRT  * Display row with link
          CALL      SPT3DA00     * ICD10 V3 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC3100  WRITE     HTMLFILE;DPT0DV4C;   * ICD10 Edition 4 map code    *I-49037
          GOTO      ICDC9999
.
ICDC3200  MOVE      ONE,LNK2PRT  * Display row with link               *I-49037
          CALL      SPT4DA00     * ICD10 Ed4 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC3300  MOVE      TWO,LNK2PRT  * Display row with link               *I-49037
          CALL      SPT4DA00     * ICD10 Ed4 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC3400  MATCH     SP70,PT0DPRFX                                      *I-49037
          IF        @EQUAL
            WRITE     HTMLFILE;"0";                                    *I-49037
          ELSE                                                         *I-49037
            WRITE     HTMLFILE;PT0DPRFX; * Diag. code prefix           *I-49037
          ENDIF                                                        *I-49037
          GOTO      ICDC9999                                           *I-49037
.
ICDC3500  WRITE     HTMLFILE;DPT0DV5C;   * ICD10 Edition 5 map code   *I-105244
          GOTO      ICDC9999
.
ICDC3600  MOVE      ONE,LNK2PRT  * Display row with link              *I-105244
          CALL      SPT5DA00     * ICD10 Ed5 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC3700  MOVE      TWO,LNK2PRT  * Display row with link              *I-105244
          CALL      SPT5DA00     * ICD10 Ed5 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC3800  MOVE      ONE,LNK2PRT  * Display row with link
          CALL      SP99DA00     * ICD9 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC3900  MOVE      TWO,LNK2PRT  * Display row with link
          CALL      SP99DA00     * ICD9 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
.                                                          * start    *I-163918
ICDC4000  WRITE     HTMLFILE;DPT0DV6C;   * ICD10 Edition 6 map code 
          GOTO      ICDC9999
.
ICDC4100  MOVE      ONE,LNK2PRT  * Display row with link
          CALL      SPT6DA00     * ICD10 Ed.6 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC4200  MOVE      TWO,LNK2PRT  * Display row with link 
          CALL      SPT6DA00     * ICD10 Ed.6 Diagnosis Code: Search Table
          GOTO      ICDC9999                               * end      *I-163918
.
ICDC4300  WRITE     HTMLFILE;PT0DDSC2;
          GOTO      ICDC9999
.                                                          * start    *I-219246
ICDC4400  WRITE     HTMLFILE;DPT0DV7C;   * ICD10 Edition 7 map code 
          GOTO      ICDC9999
.
ICDC4500  MOVE      ONE,LNK2PRT  * Display row with link
          CALL      SPT7DA00     * ICD10 Ed.7 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC4600  MOVE      TWO,LNK2PRT  * Display row with link 
          CALL      SPT7DA00     * ICD10 Ed.7 Diagnosis Code: Search Table
          GOTO      ICDC9999                               * end      *I-219246
.
ICDC4700  MATCH     SP70,PT0DSAC2     * Code is ICD10 Ed.4 or greater *I-253821
          GOTO      ICDC9999 IF EQUAL
          WRITE     HTMLFILE;PT0DSAC2;
          GOTO      ICDC9999
.                                                          * start    *I-284420
ICDC4800  WRITE     HTMLFILE;DPT0DV8C;   * ICD10 Edition 8 map code
          GOTO      ICDC9999
.
ICDC4900  MOVE      ONE,LNK2PRT  * Display row with link
          CALL      SPT8DA00     * ICD10 Ed.8 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC5000  MOVE      TWO,LNK2PRT  * Display row with link
          CALL      SPT8DA00     * ICD10 Ed.8 Diagnosis Code: Search Table
          GOTO      ICDC9999                               * end      *I-284420
.                                                          * start    *I-311669
ICDC5100  WRITE     HTMLFILE;DPT0DV9C;   * ICD10 Edition 9 map code
          GOTO      ICDC9999
.
ICDC5200  MOVE      ONE,LNK2PRT  * Display row with link
          CALL      SPT9DA00     * ICD10 Ed.9 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC5300  MOVE      TWO,LNK2PRT  * Display row with link
          CALL      SPT9DA00     * ICD10 Ed.9 Diagnosis Code: Search Table
          GOTO      ICDC9999                               * end      *I-311669
.                                                          * start    *I-0833093
ICDC5400  WRITE     HTMLFILE;DPT0DVXC;   * ICD10 Edition 10 map code
          GOTO      ICDC9999
.
ICDC5500  MOVE      ONE,LNK2PRT  * Display row with link
          CALL      SPTXDA00     * ICD10 Ed.10 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC5600  MOVE      TWO,LNK2PRT  * Display row with link
          CALL      SPTXDA00     * ICD10 Ed.10 Diagnosis Code: Search Table
          GOTO      ICDC9999                               * end      *I-0833093
.
ICDC5700  COMPARE   ZERO,PTXDALL1
          GOTO      ICDC9999 IF EQUAL
          WRITE     HTMLFILE;PTXDALL1;
          GOTO      ICDC9999
.
ICDC5800  COMPARE   ZERO,PTXDAHL1
          GOTO      ICDC9999 IF EQUAL
          WRITE     HTMLFILE;PTXDAHL1;
          GOTO      ICDC9999
.
ICDC5900  COMPARE   ZERO,PTXDALL2
          GOTO      ICDC9999 IF EQUAL
          WRITE     HTMLFILE;PTXDALL2;
          GOTO      ICDC9999
.
ICDC6000  COMPARE   ZERO,PTXDAHL2
          GOTO      ICDC9999 IF EQUAL
          WRITE     HTMLFILE;PTXDAHL2;
          GOTO      ICDC9999
.
ICDC6100  WRITE     HTMLFILE;PTODMETH;           * Methamphetamine Related
          GOTO      ICDC9999
.
ICDC6200  MOVE      ONE,LNK2PRT  * Display row with link
          CALL      SRHX1D00     * ICD10 Ed.11 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC6300  MOVE      TWO,LNK2PRT  * Display row with link
          CALL      SRHX1D00     * ICD10 Ed.11 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC6400  WRITE     HTMLFILE;DPT0DVX1;   * ICD10 Edition 11 map code
          GOTO      ICDC9999
.
ICDC6500  MOVE      PTICD001,MAPTBIND
          CALL      VMTTAB00      * Clinical Coding System Mappings Table
          GOTO      ICDC9999
.                                                          * start    *I-0917793
ICDC6600  MOVE      ONE,LNK2PRT  * Display row with link
          CALL      SRHX2D00     * ICD10 Ed.12 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC6700  MOVE      TWO,LNK2PRT  * Display row with link
          CALL      SRHX2D00     * ICD10 Ed.12 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC6800  WRITE     HTMLFILE;DPT0DVX2;   * ICD10 Edition 12 map code
          GOTO      ICDC9999                               * end      *I-0917793
.                                                          * start    *I-0956210
ICDC6900  MOVE      ONE,LNK2PRT  * Display row with link
          CALL      SRHX3D00     * ICD10 Ed.13 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC7000  MOVE      TWO,LNK2PRT  * Display row with link
          CALL      SRHX3D00     * ICD10 Ed.13 Diagnosis Code: Search Table
          GOTO      ICDC9999
.
ICDC7100  WRITE     HTMLFILE;DPT0DVX3;   * ICD10 Edition 13 map code
          GOTO      ICDC9999                               * end      *I-0956210
.
ICDC7200  MATCH     SP70,PT0DCARQ
          IF        @EQUAL
            WRITE     HTMLFILE;"0";
          ELSE
            WRITE     HTMLFILE;PT0DCARQ;         * Cluster Allocation Required
          ENDIF
          GOTO      ICDC9999
.
ICDC9999  RETURN
.------------------------------------------------------------
. Option 4 : Hospital File Maintenance    
.------------------------------------------------------------
HOSP0000  BRANCH    FLDITMNO,HOSP0100,HOSP0200,HOSP0300,HOSP0400,HOSP0500:
                             HOSP0600,HOSP0700,HOSP0800,HOSP0900,HOSP1000 
          GOTO      HOSP9999
.
HOSP0100  WRITE     HTMLFILE;HOSCODE;   
          GOTO      HOSP9999
.
HOSP0200  WRITE     HTMLFILE;DHOSINDX; 
          GOTO      HOSP9999
.
HOSP0300  WRITE     HTMLFILE;HOSDESC;
          GOTO      HOSP9999
.
HOSP0400  MATCH     SP70,HOSRUN
          GOTO      HOSP9999 IF EQUAL
          WRITE     HTMLFILE;HOSRUN;   
          GOTO      HOSP9999
.
HOSP0500  MATCH     SP70,HOSRUNR
          GOTO      HOSP9999 IF EQUAL
          WRITE     HTMLFILE;HOSRUNR;   
          GOTO      HOSP9999
.
HOSP0600  MATCH     SP70,PTHOACTV
          IF        @EQUAL
            MOVE      "B",KEY1
            WRITE     HTMLFILE;KEY1;
          ELSE
            MOVE      "I",KEY1
            WRITE     HTMLFILE;KEY1;
          ENDIF 
          GOTO      HOSP9999
.
HOSP0700  MATCH     SP70,PTHORUNB
          GOTO      HOSP9999 IF EQUAL
          WRITE     HTMLFILE;PTHORUNB;   
          GOTO      HOSP9999
.
HOSP0800  CALL      HOSTB000    * Table of Hospital Codes
          GOTO      HOSP9999
.
HOSP0900  CALL      NEXTHP00    * Next set of Hospital Codes
          GOTO      HOSP9999
.
HOSP1000  CALL      PREVHP00    * Prev set of Hospital Codes
          GOTO      HOSP9999
.
HOSP9999  RETURN
.------------------------------------------------------------
. Option 5 : Hospital Data File Location Maintenance    
.------------------------------------------------------------
HOSL0000  BRANCH    FLDITMNO,HOSL0100,HOSL0200,HOSL0300,HOSL0400,HOSL0500:
                             HOSL0600
          GOTO      HOSL9999
.
HOSL0100  WRITE     HTMLFILE;WBHDHID;   
          GOTO      HOSL9999
.
HOSL0200  WRITE     HTMLFILE;WBHDFIL; 
          GOTO      HOSL9999
.
HOSL0300  WRITE     HTMLFILE;WBHDPATH;   
          GOTO      HOSL9999
.
HOSL0400  CALL      LOCTB000    * Table of Hospital Data File Locations 
          GOTO      HOSL9999
.
HOSL0500  CALL      NEXTHP00    * Next set of Hospital Codes
          GOTO      HOSL9999
.
HOSL0600  CALL      PREVHP00    * Prev set of Hospital Codes
          GOTO      HOSL9999
.
HOSL9999  RETURN
.------------------------------------------------------------
. Option 6 : LGA Code Maintenance
.------------------------------------------------------------
PATL0000  BRANCH    FLDITMNO,PATL0100,PATL0200,PATL0300,PATL0400,PATL0500
          GOTO      PATL9999
.
PATL0100  WRITE     HTMLFILE;LGACODE;
          GOTO      PATL9999
.
PATL0200  WRITE     HTMLFILE;LGADESC;
          GOTO      PATL9999
.
PATL0300  CALL      LGATB000    * Table of LGA Code Maintenance
          GOTO      PATL9999
.
PATL0400  CALL      NEXTGR00    * Next set of Codes
          GOTO      PATL9999
.
PATL0500  CALL      PREVGR00    * Prev set of Codes
          GOTO      PATL9999
.
PATL9999  RETURN
.------------------------------------------------------------
. Option 7 : Nursing Station Maintenance
.------------------------------------------------------------
PATN0000  BRANCH    FLDITMNO,PATN0100,PATN0200,PATN0300,PATN0400,PATN0500:
                             PATN0600,PATN0700
          GOTO      PATN9999
.
PATN0100  WRITE     HTMLFILE;NSTAT;
          GOTO      PATN9999
.
PATN0200  WRITE     HTMLFILE;NSDESC;
          GOTO      PATN9999
.
PATN0300  WRITE     HTMLFILE;NSIST;
          GOTO      PATN9999
.
PATN0400  WRITE     HTMLFILE;NSEXTN;
          GOTO      PATN9999
.
PATN0500  CALL      NURTB000    * Table of Nursing Station Maintenance
          GOTO      PATN9999
.
PATN0600  CALL      NEXTGR00    * Next set of Codes
          GOTO      PATN9999
.
PATN0700  CALL      PREVGR00    * Prev set of Codes
          GOTO      PATN9999
.
PATN9999  RETURN
.------------------------------------------------------------
. Option 8 : Nursing Ward Maintenance
.------------------------------------------------------------
PATW0000  BRANCH    FLDITMNO,PATW0100,PATW0200,PATW0300,PATW0400,PATW0500:
                             PATW0600
          GOTO      PATN9999
.
PATW0100  WRITE     HTMLFILE;PTNUR001;
          GOTO      PATN9999
.
PATW0200  CALL      WSEL0000
          GOTO      PATN9999
.
PATW0300  CALL      WARTB000    * Table of Nursing Ward Maintenance
          GOTO      PATN9999
.
PATW0400  CALL      NEXTWR00    * Next set of Codes
          GOTO      PATN9999
.
PATW0500  CALL      PREVWR00    * Prev set of Codes
          GOTO      PATN9999
.
PATW0600  CALL      NSEL0000
          GOTO      PATN9999
.
PATW9999  RETURN
.------------------------------------------------------------
. Ward selection
.------------------------------------------------------------
WSEL0000  UNPACK    DIM127,D1,ANS,DIM127
          MOVE      ANS,F1
          BRANCH    F1,WSEL0050,WSEL0200
.
WSEL0050  PACK      KEY29,SP70                                     
          IF        IBCNMHOS = 1
            PACK      KEY29,SP3,WBSEHOSP,SP70
          ENDIF
          CALL      RDSWARD7
WSEL0100  CALL      RDKWARD7
          BRANCH    OVRCD,WSEL9999
.
.                         if we have a bed number we have passed all the ward
.                         master records, so exit
          MATCH     SP70,WBED
          GOTO      WSEL9999 IF NOT EQUAL
.
          COMPARE   WACTIVE,ZERO                 *List only active wards
          GOTO      WSEL0100 IF NOT EQUAL
.
          IF        IBCNMHOS = 1
            MATCH      SP3,WBSEHOSP
            IF        !@EQUAL
              MATCH     WBSEHOSP,PTWDHOSN
              GOTO      WSEL9999 IF NOT EQUAL
            ENDIF
          ENDIF
.
.                       write the select option.
          WRITE     HTMLFILE;"<option value=#"",WWARD,"#"";
          MATCH     DFLTWARD,WWARD
          IF        @EQUAL
            WRITE     HTMLFILE;" selected";
          ENDIF
          WRITE     HTMLFILE;">",WBDESC;
.
          IF        IBCNMHOS = 1
            MATCH      SP3,WBSEHOSP
            IF        @EQUAL
              WRITE     HTMLFILE;" - ",PTWDHOSN;
            ENDIF
          ENDIF
.
          WRITE     HTMLFILE;"</option>"
          GOTO      WSEL0100
.                                                                                                                                                  
WSEL0200  WRITE     HTMLFILE;NWARD;
          GOTO      WSEL9999
.
WSEL9999  RETURN 
.
.------------------------------------------------------------
. Nursing Station selection
.------------------------------------------------------------
NSEL0000  PACK      KEY6,SP70
          CALL      RDSNURS1
NSEL1000  CALL      RDKNURS1
          BRANCH    OVRCD,NSEL9999
          MATCH     SP70,NWARD
          GOTO      NSEL1000 IF NOT EQUAL
          PACK      KEY5,QUOTE,NSTAT,QUOTE
          WRITE     HTMLFILE;"<option value=",KEY5,">",NSDESC,"   (",NSTAT:
                             ")</option>";
          GOTO      NSEL1000
.
NSEL9999  RETURN
.------------------------------------------------------------
. Option 9 : LGA Post Code Maintenance
.------------------------------------------------------------
PATP0000  BRANCH    FLDITMNO,PATP0100,PATP0200,PATP0300,PATP0400,PATP0500
          GOTO      PATP9999
.
PATP0100  WRITE     HTMLFILE;PTLGPOST;
          GOTO      PATP9999
.
PATP0200  WRITE     HTMLFILE;PTLGLGAC;
          GOTO      PATP9999
.
PATP0300  CALL      LGPTB000    * Table of LGA Post Code Maintenance
          GOTO      PATP9999
.
PATP0400  CALL      NEXTGR00    * Next set of Codes
          GOTO      PATP9999
.
PATP0500  CALL      PREVGR00    * Prev set of Codes
          GOTO      PATP9999
.
PATP9999  RETURN
.------------------------------------------------------------
. Option 10 : Catchment Code Maintenance
.------------------------------------------------------------
PATC0000  BRANCH    FLDITMNO,PATC0100,PATC0200,PATC0300,PATC0400,PATC0500:
                             PATC0600,PATC0700,PATC0800
          GOTO      PATP9999
.
PATC0100  WRITE     HTMLFILE;CTCPOST;
          GOTO      PATC9999
.
PATC0200  MOVE      "CH",CATEGORY
          MOVE      CTCCODE,CODE
          CALL      CODITM00
          GOTO      PATC9999
.
PATC0300  UNPACK    DIM127,D1,ANS,DIM127
          MOVE      ANS,F1
          BRANCH    F1,PATC0310
          WRITE     HTMLFILE;CTCLGA;
          GOTO      PATC9999
.
PATC0310  PACK      KEY4,CTCLGA,SP70
          CALL      RDLGAA1
          BRANCH    OVRCD,PATC9999
          WRITE     HTMLFILE;LGADESC;
          GOTO      PATC9999
.
PATC0400  MOVE      ZERO,LNK2PRT
          CALL      CTCTB000    * Table of Catchment Code by postcode (default)
          GOTO      PATC9999
.
PATC0500  CALL      NEXTGR00    * Next set of Codes
          GOTO      PATC9999
.
PATC0600  CALL      PREVGR00    * Prev set of Codes
          GOTO      PATC9999
.
PATC0700  MOVE      ONE,LNK2PRT
          CALL      CTCTB000    * Table of Catchment Code by code
          GOTO      PATC9999
.
PATC0800  MOVE      TWO,LNK2PRT
          CALL      CTCTB000    * Table of Catchment Code by LGA 
          GOTO      PATC9999
.
PATC9999  RETURN
.------------------------------------------------------------
. Option 11 : Casemix Code Table Maintenance
.------------------------------------------------------------
PATM0000  BRANCH    FLDITMNO,PATM0100,PATM0200,PATM0300,PATM0400,PATM0500:
                             PATM0600,PATM0700,PATM0800,PATM0900
          GOTO      PATP9999
.
PATM0100  WRITE     HTMLFILE;PTCACODE;
          GOTO      PATM9999
.
PATM0200  WRITE     HTMLFILE;PTCADES1;
          GOTO      PATM9999
.
PATM0300  WRITE     HTMLFILE;PTCADES2;
          GOTO      PATM9999
.
PATM0400  WRITE     HTMLFILE;PTCAELOS;
          GOTO      PATM9999
.
.PATM0500  MATCH     SP70,PTCAACTV
.          IF        @EQUAL
.            WRITE     HTMLFILE;"0";
.          ELSE
.            WRITE     HTMLFILE;PTCAACTV;
.          ENDIF
.
PATM0500  WRITE     HTMLFILE;PTCAACTV;
          GOTO      PATM9999
.
PATM0600  CALL      CMCTB000    * Table of Casemix Code Tables Maintenance
          GOTO      PATM9999
.
PATM0700  CALL      NEXTGR00    * Next set of Codes
          GOTO      PATM9999
.
PATM0800  CALL      PREVGR00    * Prev set of Codes
          GOTO      PATM9999
.
PATM0900  CALL      LNKSER00    * Link to server 
          GOTO      PATM9999
.
PATM9999  RETURN
.
.-----------------------------------------------------------
. Link to for Redirect
.-----------------------------------------------------------
LNKSER00  UNPACK    DIM127,D1,KEY8,DIM127
          UNPACK    DIM127,D1,KEY2,DIM127
          UNPACK    DIM127,D1,FLDPARA,DIM127
.
          REP       " +",PATCM001
.
          WRITE     HTMLFILE;KEY8,".pbl?reportno=",KEY2:
                                   "&template=",FLDPARA:
                                   "&cmixcode=",PATCM001;
.
          REP       "+ ",PATCM001
.
LNKSER99  RETURN
.------------------------------------------------------------
. Option 12 : DRG Code Table Maintenance
.------------------------------------------------------------
PDRG0000  BRANCH    FLDITMNO,PDRG0100,PDRG0200,PDRG0300,PDRG0400,PDRG0500:
                             PDRG0600,PDRG0700,PDRG0800,PDRG0900,PDRG1000:
                             PDRG1100
          GOTO      PATP9999
.
PDRG0100  WRITE     HTMLFILE;PTDWDRGC;
          GOTO      PDRG9999
.
PDRG0200  WRITE     HTMLFILE;PTDWMDCC;
          GOTO      PDRG9999
.
PDRG0300  WRITE     HTMLFILE;PTDWDESC;
          GOTO      PDRG9999
.
PDRG0400  WRITE     HTMLFILE;PTDWLOWT;
          GOTO      PDRG9999
.
PDRG0500  WRITE     HTMLFILE;PTDWHIGH;
          GOTO      PDRG9999
.
PDRG0600  WRITE     HTMLFILE;PTDWRWGT;
          GOTO      PDRG9999
.
PDRG0700  CALL      CSEL0000
          GOTO      PDRG9999
.                                                                     Car 273332 
PDRG0800  PACK      KEY4,SP70
          MATCH     SP70,PTDWDRGV
          IF        !@EQUAL
            MOVE      PTDWDRGV,FORM3
            IF        FORM3 < 100
              ASSIGN    (FORM3/10),FORM1P1
              MOVE      FORM1P1,KEY4
            ELSE       
              ASSIGN    (FORM3/10),FORM2P1
              MOVE      FORM2P1,KEY4
            ENDIF
          ENDIF
          WRITE     HTMLFILE;KEY4;
          GOTO      PDRG9999
.                                                                     Car 273332
PDRG0900  MATCH     "031",PTDWDRGV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"031#" selected> ":
                                 "3.1 </option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"031#"> ":
                                 "3.1 </option>"
          ENDIF
.
          MATCH     "041",PTDWDRGV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"041#" selected> ":
                                 "4.1 </option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"041#"> ":
                                 "4.1 </option>"
          ENDIF
.
          MATCH     "042",PTDWDRGV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"042#" selected> ":
                                 "4.2 </option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"042#"> ":
                                 "4.2 </option>"
          ENDIF
.
          MATCH     "050",PTDWDRGV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"050#" selected> ":
                                 "5.0 </option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"050#"> ":
                                 "5.0 </option>"
          ENDIF
.
          MATCH     "051",PTDWDRGV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"051#" selected> ":
                                 "5.1 </option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"051#"> ":
                                 "5.1 </option>"
          ENDIF
.
          MATCH     "052",PTDWDRGV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"052#" selected> ":
                                 "5.2 </option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"052#"> ":
                                 "5.2 </option>"
          ENDIF
.
          MATCH     "060",PTDWDRGV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"060#" selected> ":
                                 "6.0 </option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"060#"> ":
                                 "6.0 </option>"
          ENDIF
.
          MATCH     "062",PTDWDRGV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"062#" selected> ":
                                 "6.2 </option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"062#"> ":
                                 "6.2 </option>"
          ENDIF
.
          MATCH     "070",PTDWDRGV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"070#" selected> ":
                                 "7.0 </option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"070#"> ":
                                 "7.0 </option>"
          ENDIF
.
          MATCH     "080",PTDWDRGV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"080#" selected> ":
                                 "8.0 </option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"080#"> ":
                                 "8.0 </option>"
          ENDIF
.
          MATCH     "090",PTDWDRGV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"090#" selected> ":
                                 "9.0 </option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"090#"> ":
                                 "9.0 </option>"
          ENDIF
.
          MATCH     "100",PTDWDRGV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"100#" selected> ":
                                 "10.0 </option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"100#"> ":
                                 "10.0 </option>"
          ENDIF
.
          MATCH     "110",PTDWDRGV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"110#" selected> ":
                                 "11.0 </option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"110#"> ":
                                 "11.0 </option>"
          ENDIF
.
          MATCH     "120",PTDWDRGV
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"120#" selected> ":
                                 "12.0 </option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"120#"> ":
                                 "12.0 </option>"
          ENDIF
.
          GOTO      PDRG9999
.
PDRG1000  WRITE     HTMLFILE;PTDWDRGV;
          GOTO      PDRG9999
.
PDRG1100  MOVE      "Dt",CATEGORY
          MOVE      PTDWDRGT,CODE
          CALL      CODITM00
          GOTO      PDRG9999
.
PDRG9999  RETURN
+
.------------------------------------------------------------
. Clinical Specialty selection
.------------------------------------------------------------
CSEL0000  UNPACK    DIM127,D1,ANS,DIM127
          MOVE      ANS,F1
          BRANCH    F1,CSEL0050,CSEL0200
.
CSEL0050  PACK      KEY2,SP70
          CALL      RSPTCLS1
CSEL0100  CALL      RKPTCLS1
          BRANCH    OVRCD,CSEL9999
.
          PACK      KEY4,QUOTE,PTCICODE,QUOTE
          MATCH     PTDWCLSP,PTCICODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY4," selected>",PTCIDESC:
                               "   (",PTCICODE,")</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY4,">",PTCIDESC:
                               "   (",PTCICODE,")</option>";
          ENDIF
          GOTO      CSEL0100
.
CSEL0200  WRITE     HTMLFILE;PTDWCLSP;
          GOTO      CSEL9999 
.
CSEL9999  RETURN
.
.-----------------------------------------------------------
. Link to Next Group of Hospitals
.-----------------------------------------------------------
NEXTHP00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM+NORECORD,F3
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
          REP       " +",UNIQID
          REP       " +",HOSPCODE
.
          WRITE     HTMLFILE;"patweb88.pbl":
                                 "?reportno=",F1:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&pthos001=",HOSPCODE:
                                 "&ptloc001=",UNIQID;
          REP       "+ ",UNIQID
          REP       "+ ",HOSPCODE
.
NEXTHP99  RETURN
.-------------------------------------------------------------
. Link to Prev Group of Hospitals
.-------------------------------------------------------------
PREVHP00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM-NORECORD,F3
          IF        F3<0
            MOVE      ZERO,F3
          ENDIF
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
          REP       " +",UNIQID
          REP       " +",HOSPCODE
.
          WRITE     HTMLFILE;"patweb88.pbl":
                                 "?reportno=",F1:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&pthos001=",HOSPCODE:
                                 "&ptloc001=",UNIQID;
          REP       "+ ",UNIQID
          REP       "+ ",HOSPCODE
.
PREVHP99  RETURN
.-----------------------------------------------------------
. Link to Next Group of Wards
.-----------------------------------------------------------
NEXTWR00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM+NORECORD,F3
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
          REP       " +",PTNUR001
          REP       " +",NWARD
.
          WRITE     HTMLFILE;"patweb88.pbl":
                                 "?reportno=",F1:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&ptnur001=",PTNUR001:
                                 "&ptnur002=",NWARD;
          REP       "+ ",PTNUR001
          REP       "+ ",NWARD
.
NEXTWR99  RETURN
.-------------------------------------------------------------
. Link to Prev Group of wards
.-------------------------------------------------------------
PREVWR00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM-NORECORD,F3
          IF        F3<0
            MOVE      ZERO,F3
          ENDIF
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
          REP       " +",PTNUR001
          REP       " +",NWARD
.
          WRITE     HTMLFILE;"patweb88.pbl":
                                 "?reportno=",F1:           
                                 "&template=",FLDPARA:      
                                 "&startnum=",KEY3:         
                                 "&norecord=",KEY2:         
                                 "&ptnur001=",PTNUR001:
                                 "&ptnur002=",NWARD;                           
          REP       "+ ",PTNUR001
          REP       "+ ",NWARD
.                                           
PREVWR99  RETURN
.-----------------------------------------------------------
. Link to Next Group
.-----------------------------------------------------------
NEXTGR00  BRANCH    FHIRTYPE,NEXTGR10
          MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM+NORECORD,F3
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F2
.
          WRITE     HTMLFILE;"patweb88.pbl":
                                 "?reportno=",F2:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&keywords=",KEYWORDS:
                                 "&startkey=",STARTKEY;
        GOTO      NEXTGR99
.
NEXTGR10  IF        DISNUMB=NORECORD
            ASSIGN    STARTNUM+NORECORD,F6
            MOVE      F6,KEY6
            SQUEEZE   KEY6
            WRITE     HTMLFILE;*+,"nextpage=&startnum=",KEY6
          ENDIF
.
NEXTGR99  RETURN
.-------------------------------------------------------------
. Link to Prev Group
.-------------------------------------------------------------
PREVGR00  BRANCH    FHIRTYPE,PREVGR10
          MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM-NORECORD,F3
          IF        F3<0
            MOVE      ZERO,F3
          ENDIF
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F2
.
          WRITE     HTMLFILE;"patweb88.pbl":
                                 "?reportno=",F2:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&keywords=",KEYWORDS:
                                 "&startkey=",STARTKEY;
          GOTO      PREVGR99
.
PREVGR10  ASSIGN    STARTNUM-NORECORD,F6
          IF        F6>=0
            MOVE      F6,KEY6
            SQUEEZE   KEY6
            WRITE     HTMLFILE;*+,"prevpage=&startnum=",KEY6
          ENDIF
.
PREVGR99  RETURN
.------------------------------------------------------------
. NOMORE00 - Display "No more records" at end of list
.------------------------------------------------------------
NOMORE00  WRITE     HTMLFILE;"<tr>":
                             "<td class=RedCell colspan=20 align=center>":
                             "No more records</td>"
.
NOMORE99  RETURN
.
.------------------------------------------------------------
. Table of Hospital File Table Details
.------------------------------------------------------------
HOSTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      HSHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY4,STARTKEY,SP70
          CALL      RDSHOSP1
          IF        OVRCD=0
            CALL      RDPHOSP1
          ENDIF
HOSTB100  CALL      RDKHOSP1
          BRANCH    OVRCD,HOSTB900
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      HOSTB100
          ENDIF
.
          CALL      HSROW000      * Hospital File Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      HOSTB100 IF NOT EQUAL
.
          GOTO      HOSTB999
.
HOSTB900  CALL      NOMORE00      * Display No More Records Message
.
HOSTB999  RETURN
.------------------------------------------------------------
. Hospital File Table Details (TABLE HEADING)
.------------------------------------------------------------
HSHED000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell width=15%>":
                               "<b>Hospital Code</b></td>":
                               "<td class=HeadingCell width=15%>":
                               "<b>Unique Code</b></td>":
                               "<td class=HeadingCell width=40%>":
                               "<b>Description</b></td>":
                             "</tr>"
.
HSHED999  RETURN
.------------------------------------------------------------
. Hospital File Table (TABLE ROW)
.------------------------------------------------------------
HSROW000  MATCH     SP70,HOSDESC
          IF        @EQUAL
            MOVE      "&nbsp;",KEY30
          ELSE
            MOVE      HOSDESC,KEY30
          ENDIF
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail04":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pthos001=",HOSCODE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             HOSCODE,"</td>":
                             "<td>",HOSINDX,"</td><td>",KEY30,"</td>":
                             "</tr>"
.
HSROW999 RETURN
.------------------------------------------------------------
. Table of Hospital Data File Locations Table Details
.------------------------------------------------------------
LOCTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      LCHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY10,PTLOC001,SP70
          CALL      RSWBHD1
LOCTB100  CALL      RKWBHD1
          BRANCH    OVRCD,LOCTB900
.
          MATCH     WBHDHID,PTLOC001 
          GOTO      LOCTB900 IF NOT EQUAL
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      LOCTB100
          ENDIF
.
          CALL      LCROW000      * Data File Location Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      LOCTB100 IF NOT EQUAL
.
          GOTO      LOCTB999
.
LOCTB900  CALL      NOMORE00      * Display No More Records Message
.
LOCTB999  RETURN
.------------------------------------------------------------
. Hospital Data File Location Table Details (TABLE HEADING)
.------------------------------------------------------------
LCHED000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell width=40%>":
                               "<b>File Name</b></td>":
                               "<td class=HeadingCell width=60%>":
                               "<b>Path to Open</b></td>":
                             "</tr>"
.
LCHED999  RETURN
.------------------------------------------------------------
. Hospital Data File Location Table (TABLE ROW)
.------------------------------------------------------------
LCROW000  WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail05":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pthos001=",HOSCODE:
                             "&ptloc001=",WBHDHID:
                             "&ptloc002=",WBHDFIL,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             WBHDFIL,"</td>":
                             "<td>",WBHDPATH,"</td>":
                             "</tr>"
.
LCROW999 RETURN
.------------------------------------------------------------
. Table of LGA Code Maintanence
.------------------------------------------------------------
LGATB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      LGAHD000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY4,STARTKEY,SP70
          CALL      RDLGAA1 
          IF        OVRCD=0
            CALL      RDPLGAA1
          ENDIF
LGATB100  CALL      RDKLGAA1
          BRANCH    OVRCD,LGATB900
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      LGATB100
          ENDIF
.
          CALL      LGARW000      * Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      LGATB100 IF NOT EQUAL
.
          GOTO      LGATB999
.
LGATB900  CALL      NOMORE00      * Display No More Records Message
.
LGATB999  RETURN
.------------------------------------------------------------
. LGA Code Maintanance Details (TABLE HEADING)
.------------------------------------------------------------
LGAHD000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell width=30%>":
                               "<b>LGA Code</b></td>":
                               "<td class=HeadingCell width=70%>":
                               "<b>Description</b></td>":
                             "</tr>"
.
LGAHD999  RETURN
.------------------------------------------------------------
. LGA Code Maintanance Details (TABLE ROW)
.------------------------------------------------------------
LGARW000  WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail06":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&ptlgp001=",LGACODE:
                             "&ptlga001=",LGACODE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             LGACODE,"</td>":
                             "<td>",LGADESC,"</td>":
                             "</tr>"
.
LGARW999 RETURN
.------------------------------------------------------------
. Table of Nursing Station Maintanence
.------------------------------------------------------------
NURTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      NRHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY6,STARTKEY,PTNUR001,SP70
          CALL      RDNURS1
          IF        OVRCD=0
            CALL      RDPNURS1
          ENDIF
NURTB100  CALL      RDKNURS1
          BRANCH    OVRCD,NURTB900
.
          MATCH     SP70,NWARD    *Checks to see if this is a parent record
          IF        !@EQUAL
            GOTO      NURTB100
          ENDIF
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      NURTB100
          ENDIF
.
          CALL      NRROW000      * Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      NURTB100 IF NOT EQUAL
.
          GOTO      NURTB999
.
NURTB900  CALL      NOMORE00
.
NURTB999  RETURN
.------------------------------------------------------------
. Nursing Station Maintanance Details (TABLE HEADING)
.------------------------------------------------------------
NRHED000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell width=40%>":
                               "<b>Nursing Station Number</b></td>":
                               "<td class=HeadingCell width=60%>":
                               "<b>Description</b></td>":
                             "</tr>"
.
NRHED999  RETURN
.------------------------------------------------------------
. Nursing Station Maintanance Details (TABLE ROW)
.------------------------------------------------------------
NRROW000  MATCH     SP70,NSDESC
          IF        @EQUAL
            MOVE      "&nbsp;",KEY30
          ELSE
            MOVE      NSDESC,KEY30
          ENDIF
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail07":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&ptnur001=",NSTAT:
                             "&ptnur002=",NWARD,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             NSTAT,"</td>":
                             "<td>",KEY30,"</td>":
                             "</tr>"
.
NRROW999 RETURN
.------------------------------------------------------------
. Table of Nursing Ward Maintanence
.------------------------------------------------------------
WARTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      WRHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY6,PTNUR001,STARTKEY,SP70
          CALL      RDNURS1
          IF        OVRCD=0
            CALL      RDPNURS1
          ENDIF
WARTB100  CALL      RDKNURS1
          BRANCH    OVRCD,NURTB900
.
          MATCH     PTNUR001,NSTAT  *Checks to see if this is a child record
          IF        !@EQUAL
            GOTO      WARTB100
          ENDIF
.
          MATCH     SP70,NWARD      *Removes all parent records
          IF        @EQUAL
            GOTO      WARTB100
          ENDIF
.
          PACK      KEY6,NWARD,SP70 * Reads the wards file for the description
          CALL      RDWARD1
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      WARTB100
          ENDIF
.
          CALL      WRROW000      * Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      WARTB100 IF NOT EQUAL
.
          GOTO      WARTB999
.
WARTB900  CALL      NOMORE00        * Display No More Records Message
.
WARTB999  RETURN
.------------------------------------------------------------
. Nursing Ward Maintanance Details (TABLE HEADING)
.------------------------------------------------------------
WRHED000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell width=40%>":
                               "<b>Nursing Ward</b></td>":
                               "<td class=HeadingCell width=60%>":
                               "<b>Description</b></td>":
                             "</tr>"
.
WRHED999  RETURN
.------------------------------------------------------------
. Nursing Ward Maintanance Details (TABLE ROW)
.------------------------------------------------------------
WRROW000  MATCH     SP70,WBDESC
          IF        @EQUAL
            MOVE      "&nbsp;",KEY30
          ELSE
            MOVE      WBDESC,KEY30
          ENDIF
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail08":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&ptnur001=",NSTAT:
                             "&ptnur002=",NWARD,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             NWARD,"</td>":
                             "<td>",KEY30,"</td>":
                             "</tr>"
.
WRROW999 RETURN
.------------------------------------------------------------
. Table of LGA Post Code Maintanence
.------------------------------------------------------------
LGPTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      LGPHD000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY12,STARTKEY,SP70
          CALL      RDPTLGP1
          IF        OVRCD=0
            CALL      RPPTLGP1
          ENDIF
LGPTB100  CALL      RKPTLGP1
          BRANCH    OVRCD,LGPTB900
.
          MATCH     PTLGA001,PTLGLGAC
          IF        !@EQUAL 
            GOTO      LGPTB100
          ENDIF
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      LGPTB100
          ENDIF
.
          CALL      LGPRW000      * Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      LGPTB100 IF NOT EQUAL
.
          GOTO      LGPTB999
.
LGPTB900  CALL      NOMORE00      * Display No More Records Message
.
LGPTB999  RETURN
.------------------------------------------------------------
. LGA Post Code Maintanance Details (TABLE HEADING)
.------------------------------------------------------------
LGPHD000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell width=100%>":
                               "<b>Post Code</b></td>":
                             "</tr>"
.
LGPHD999  RETURN
.------------------------------------------------------------
. LGA Post Code Maintanance Details (TABLE ROW)
.------------------------------------------------------------
LGPRW000  WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail09":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&ptlgp001=",PTLGPOST:
                             "&ptlgp002=",PTLGLGAC,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             PTLGPOST,"</td>":
                             "</tr>"
.
LGPRW999 RETURN
.------------------------------------------------------------
. Table of Catchment Code Maintanence
.------------------------------------------------------------
CTCTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      CTCHD000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          BRANCH    LNK2PRT,CTCTB200,CTCTB300
.
.         List by postcode
.
          PACK      KEY8,STARTKEY,SP70
          CALL      RDCATC1 
          IF        OVRCD=0
            CALL      RDPCATC1
          ENDIF
CTCTB100  CALL      RDKCATC1
          BRANCH    OVRCD,CTCTB900
          GOTO      CTCTB400
.
.         List by catchment code
.
CTCTB200  PACK      KEY11,STARTKEY,SP70
          CALL      RDCATC2 
          IF        OVRCD=0
            CALL      RDPCATC2
          ENDIF
CTCTB220  CALL      RDKCATC2
          BRANCH    OVRCD,CTCTB900
          GOTO      CTCTB400
.
.         List by LGA code
.
CTCTB300  PACK      KEY12,STARTKEY,SP70
          CALL      RDCATC3 
          IF        OVRCD=0
            CALL      RDPCATC3
          ENDIF
CTCTB320  CALL      RDKCATC3
          BRANCH    OVRCD,CTCTB900
          GOTO      CTCTB400
.
CTCTB400  ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      CTCTB800
          ENDIF
.
          CALL      CTCRW000      * Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      CTCTB800 IF NOT EQUAL
          GOTO      CTCTB999
.
CTCTB800  BRANCH    LNK2PRT,CTCTB220,CTCTB320
          GOTO      CTCTB100
.
CTCTB900  CALL      NOMORE00       * Display No More Records Message
.
CTCTB999  RETURN
.------------------------------------------------------------
. Catchment Code Maintanance Details (TABLE HEADING)
.------------------------------------------------------------
CTCHD000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell width=20%>":
                               "<b>Post Code</b></td>":
                               "<td class=HeadingCell width=40%>":
                               "<b>Catchment Code</b></td>":
                               "<td class=HeadingCell width=40%>":
                               "<b>LGA Code</b></td>":
                             "</tr>"
.
CTCHD999  RETURN
.------------------------------------------------------------
. Catchment Code Maintanance Details (TABLE ROW)
.------------------------------------------------------------
CTCRW000  MOVE      SP70,LGADESC
          MOVE      SP70,KEY4
          MATCH     SP70,CTCLGA
          IF        !@EQUAL
            PACK      KEY4,CTCLGA,SP70
            CALL      RDLGAA1
          ENDIF
.
          MOVE      "CH",CATEGORY
          MOVE      CTCCODE,CODE
          CALL      GETCOD00

          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail10":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&ptctc001=",CTCPOST,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             CTCPOST,"</td>";
.
          MATCH     SP70,CTCCODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<td>&nbsp;</td>";
          ELSE
            WRITE     HTMLFILE;"<td>&nbsp;",CTCCODE," - ",TDESC,"</td>";
          ENDIF
.
          MATCH     SP70,KEY4
          IF        @EQUAL
            WRITE     HTMLFILE;"<td>&nbsp;</td></tr>"
          ELSE
            WRITE     HTMLFILE;"<td>&nbsp;",KEY4," - ",LGADESC,"</td>":
                               "</tr>"
          ENDIF
.
CTCRW999 RETURN
.------------------------------------------------------------
. Table of Casemix Codes Maintanence
.------------------------------------------------------------
CMCTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127

          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY9,STARTKEY,SP70
          CALL      RDPTCMC1
          IF        OVRCD=0
            CALL      RPPTCMC1
          ENDIF
CMCTB100  CALL      RKPTCMC1
          BRANCH    OVRCD,CMCTB900
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      CMCTB100
          ENDIF
.
          CALL      CMCRW000      * Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      CMCTB100 IF NOT EQUAL
.
          GOTO      CMCTB999
.
CMCTB900  CALL      NOMORE00
.
CMCTB999  RETURN
.------------------------------------------------------------
. Casemix Code Maintanance Details (TABLE ROW)
.------------------------------------------------------------
CMCRW000  COMPARE   ONE,PTCAACTV
          IF        @EQUAL
            MOVE      "Active",KEY11
          ELSE
            MOVE      "Not Active",KEY11
          ENDIF
.
          MATCH     SP70,PTCADES1
          IF        @EQUAL
            MOVE      "&nbsp;",KEY60
          ELSE
            CLEAR     KEY60
            APPEND    PTCADES1,KEY60
            APPEND    PTCADES2,KEY60
            RESET     KEY60
          ENDIF
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail11":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&patcm001=",PTCACODE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             PTCACODE,"</td>":
                             "<td>",KEY60,"</td>":
                             "<td>",PTCAELOS,"</td>":
                             "<td>",KEY11,"</td>":
                             "</tr>"
.
CMCRW999 RETURN
.-----------------------------------------------------------
. ICD10 Procedure Code: Search Table
.-----------------------------------------------------------
SPTCOA00  WRITE     HTMLFILE;"<tr align=center>":
                               "<td class=HeadingCell colspan=2><b>You Searched for ":
                               KEYWORDS,"</td>":
                             "</tr>":
                             "<tr>":
                               "<td class=HeadingCell width=15%><b>Code</b></td>":
                               "<td class=HeadingCell><b>Description</b></td>":
                             "</tr>"
.
          CALL      GETWRD00
.
          UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          STRIP     KEYWRD01
          PACK      KEY24,KEYWRD01,SP70
          CALL      RSPTCO2
SPTCOA10  CALL      RKPTCO2
          BRANCH    OVRCD,SPTCOA90
.
          CALL      SPTCOB00
          BRANCH    OVRCD,SPTCOA10,SPTCOA90
.
          MOVE      PTCOITM,KEY9
          CALL      RDPT10O1
          BRANCH    OVRCD,SPTCOA10
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      SPTCOA10
          ENDIF
.
          BRANCH    LNK2PRT,SPTCOA20,SPTCOA30
          GOTO      SPTCOA99  
.
SPTCOA20  MATCH     SP70,PT0ODSC2
          IF        @EQUAL 
            WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:showICD02":
                               "(#"",LINKPRG,"#.pbl":
                               "?reportno=",LINKREP:
                               "&template=",LINKTEM:
                               "&ptico001=",OPCODE,"#")'>":
                              "<img src=../images/MaintenanceIcon.gif hspace=4":
                               " border=0 align=absmiddle></a>":
                               OPCODE,"</td>":
                               "<td>",ODESC,"</td>":
                               "</tr>"
          ELSE
            WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:showICD02":
                               "(#"",LINKPRG,"#.pbl":
                               "?reportno=",LINKREP:
                               "&template=",LINKTEM:
                               "&ptico001=",OPCODE,"#")'>":
                              "<img src=../images/MaintenanceIcon.gif hspace=4":
                               " border=0 align=absmiddle></a>":
                               OPCODE,"</td>":
                               "<td>",PT0ODSC2,"</td>":
                               "</tr>"
          ENDIF
.
          GOTO      SPTCOA80  
.
SPTCOA30  MATCH     SP70,PT0ODSC2
          IF        @EQUAL
            WRITE     HTMLFILE;"<tr valign=top>":
                                "<td><a href=#"#" ":
                                "OnClick=#"updateParent('",ODESC:
                                "','",OPCODE,"')#">":
                                "<img src=../images/MaintenanceIcon.gif hspace=4":
                                " border=0 align=absmiddle></a>":
                                OPCODE,"</td>":
                                "<td>",ODESC,"</td>":
                               "</tr>"
          ELSE
            WRITE     HTMLFILE;"<tr valign=top>":
                                "<td><a href=#"#" ":
                                "OnClick=#"updateParent('",PT0ODSC2:
                                "','",OPCODE,"')#">":
                                "<img src=../images/MaintenanceIcon.gif hspace=4":
                                " border=0 align=absmiddle></a>":
                                OPCODE,"</td>":
                                "<td>",PT0ODSC2,"</td>":
                               "</tr>"
          ENDIF
. 
SPTCOA80  ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      SPTCOA10 IF NOT EQUAL
          GOTO      SPTCOA99
.
SPTCOA90  CALL      NOMORE00
.
SPTCOA99  RETURN
.------------------------------------------------------------
. Check  ICD10 Procedure Record
.------------------------------------------------------------
SPTCOB00  MATCH     KEYWRD01,PTCOKWD
          GOTO      SPTCOB92 IF NOT EQUAL
          IF        KEYWRDNO>1
            PACK      SAVKEY24,PTCOKWD,PTCOITM
            CALL      SPTCOC00
            BRANCH    EXIT,SPTCOB91
            MOVE      SAVKEY24,KEY24
            CALL      RDPTCO2
          ENDIF
.
. Insert Other Check for Valid Record Here i.e. Suspended or In Active
.   eg    COMPARE    ONE,INACTIVE
.         GOTO       SPTCOB91 IF EQUAL
.
          GOTO      SPTCOB90
.
SPTCOB90  MOVE      ZERO,OVRCD
          GOTO      SPTCOB99
SPTCOB91  MOVE      ONE,OVRCD
          GOTO      SPTCOB99
SPTCOB92  MOVE      TWO,OVRCD
SPTCOB99  RETURN
.------------------------------------------------------------
. Check for Matching ICD10 Procedure Words
.------------------------------------------------------------
SPTCOC00  MOVE      ONE,F2
          MOVE      ZERO,EXIT
          PACK      SAVKEY9,PTCOITM,SP70
.
SPTCOC10  COMPARE   KEYWRDNO,F2           * Loop through each Key Word in Search
          GOTO      SPTCOC99 IF EQUAL     * Exit OK
          ADD       ONE,F2
          LOAD      KEYWRDXX,F2,KEYWRD01,KEYWRD02,KEYWRD03,KEYWRD04,KEYWRD05:
                             KEYWRD06,KEYWRD07,KEYWRD08,KEYWRD09,KEYWRD10
          PACK      KEY24,PTCOITM,KEYWRDXX
          CALL      RDPTCO1               * Check for Exact Match
          COMPARE   ZERO,OVRCD            * Ok so Continue Loop
          GOTO      SPTCOC10 IF EQUAL
.
          CALL      RKPTCO1               * Not Exact so Read Next Record
          BRANCH    OVRCD,SPTCOC90        * No Match So Exit No Match
          PACK      KEY9,PTCOITM,SP70
          MATCH     SAVKEY9,KEY9        * Match Key Fields
          GOTO      SPTCOC90 IF NOT EQUAL * No Match So Exit
          STRIP     KEYWRDXX
          MATCH     PTCOKWD,KEYWRDXX         * Check Key Word
          GOTO      SPTCOC90 IF NOT EQUAL * No Match So Exit
          GOTO      SPTCOC10              * Check Next Search Word
.
SPTCOC90  MOVE      ONE,EXIT
SPTCOC99  RETURN
.
.-----------------------------------------------------------
. ICD10 Version 3 Procedure Code: Search Table
.-----------------------------------------------------------
SPT3OA00  WRITE     HTMLFILE;"<tr align=center>":
                               "<td class=HeadingCell colspan=2><b>You Searched for ":
                               KEYWORDS,"</td>":
                             "</tr>":
                             "<tr>":
                               "<td class=HeadingCell width=15%><b>Code</b></td> ":
                               "<td class=HeadingCell><b>Description</b></td>":
                             "</tr>"
.
          CALL      GETWRD00
.
          UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          STRIP     KEYWRD01
          PACK      KEY24,KEYWRD01,SP70
          CALL      RSPT3O2
SPT3OA10  CALL      RKPT3O2
          BRANCH    OVRCD,SPT3OA90
.
          CALL      SPT3OB00
          BRANCH    OVRCD,SPT3OA10,SPT3OA90
.
          MOVE      PTCOITM,KEY9
          CALL      RDPT13O1
          BRANCH    OVRCD,SPT3OA10
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      SPT3OA10
          ENDIF
.
          BRANCH    LNK2PRT,SPT3OA20,SPT3OA30
          GOTO      SPT3OA99
.
SPT3OA20  WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:showICD02":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&ptico001=",OPCODE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             OPCODE,"</td>":
                             "<td>",ODESC,"</td>":
                             "</tr>"
.
          GOTO      SPT3OA80
.
SPT3OA30  WRITE     HTMLFILE;"<tr valign=top>":
                              "<td><a href=#"#" ":
                              "OnClick=#"updateParent('",ODESC:
                              "','",OPCODE,"')#">":
                              "<img src=../images/MaintenanceIcon.gif hspace=4":
                              " border=0 align=absmiddle></a>":
                              OPCODE,"</td>":
                              "<td>",ODESC,"</td>":
                             "</tr>"
.
SPT3OA80  ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      SPT3OA10 IF NOT EQUAL
          GOTO      SPT3OA99
.
SPT3OA90  CALL      NOMORE00         * Display No More Records Message
.
SPT3OA99  RETURN
.------------------------------------------------------------
. Check ICD10 Version 3 Procedure Record
.------------------------------------------------------------
SPT3OB00  MATCH     KEYWRD01,PTCOKWD
          GOTO      SPT3OB92 IF NOT EQUAL
          IF        KEYWRDNO>1
            PACK      SAVKEY24,PTCOKWD,PTCOITM
            CALL      SPT3OC00
            BRANCH    EXIT,SPT3OB91
            MOVE      SAVKEY24,KEY24
            CALL      RDPT3O2
          ENDIF
.
. Insert Other Check for Valid Record Here i.e. Suspended or In Active
.   eg    COMPARE    ONE,INACTIVE
.         GOTO       SPT3OB91 IF EQUAL
.
          GOTO      SPT3OB90
.
SPT3OB90  MOVE      ZERO,OVRCD
          GOTO      SPT3OB99
SPT3OB91  MOVE      ONE,OVRCD
          GOTO      SPT3OB99
SPT3OB92  MOVE      TWO,OVRCD
SPT3OB99  RETURN
.------------------------------------------------------------
. Check for Matching ICD10 Vesrion 3 Procedure Words
.------------------------------------------------------------
SPT3OC00  MOVE      ONE,F2
          MOVE      ZERO,EXIT
          PACK      SAVKEY9,PTCOITM,SP70
.
SPT3OC10  COMPARE   KEYWRDNO,F2           * Loop through each Key Word in Search
          GOTO      SPT3OC99 IF EQUAL     * Exit OK
          ADD       ONE,F2
          LOAD      KEYWRDXX,F2,KEYWRD01,KEYWRD02,KEYWRD03,KEYWRD04,KEYWRD05:
                             KEYWRD06,KEYWRD07,KEYWRD08,KEYWRD09,KEYWRD10
          PACK      KEY24,PTCOITM,KEYWRDXX
          CALL      RDPT3O1               * Check for Exact Match
          COMPARE   ZERO,OVRCD            * Ok so Continue Loop
          GOTO      SPT3OC10 IF EQUAL
.
          CALL      RKPT3O1               * Not Exact so Read Next Record
          BRANCH    OVRCD,SPT3OC90        * No Match So Exit No Match
          PACK      KEY9,PTCOITM,SP70
          MATCH     SAVKEY9,KEY9        * Match Key Fields
          GOTO      SPT3OC90 IF NOT EQUAL * No Match So Exit
          STRIP     KEYWRDXX
          MATCH     PTCOKWD,KEYWRDXX         * Check Key Word
          GOTO      SPT3OC90 IF NOT EQUAL * No Match So Exit
          GOTO      SPT3OC10              * Check Next Search Word
.
SPT3OC90  MOVE      ONE,EXIT
SPT3OC99  RETURN
.                                                                      *I-49037
.-----------------------------------------------------------
. ICD10 Edition 4 Procedure Code: Search Table
.-----------------------------------------------------------
SPT4OA00  WRITE     HTMLFILE;"<tr align=center>":
                               "<td class=HeadingCell colspan=2><b>You Searched for ":
                               KEYWORDS,"</td>":
                             "</tr>":
                             "<tr>":
                               "<td class=HeadingCell width=15%><b>Code</b></td> ":
                               "<td class=HeadingCell><b>Description</b></td>":
                             "</tr>"
.
          CALL      GETWRD00
.
          UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          STRIP     KEYWRD01
          PACK      KEY24,KEYWRD01,SP70
          CALL      RSPT4O2
.
SPT4OA10  CALL      RKPT4O2
          BRANCH    OVRCD,SPT4OA90
.
          CALL      SPT4OB00
          BRANCH    OVRCD,SPT4OA10,SPT4OA90
.
          MOVE      PTCOITM,KEY9
          CALL      RDPT14O1
          BRANCH    OVRCD,SPT4OA10
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      SPT4OA10
          ENDIF
.
          BRANCH    LNK2PRT,SPT4OA20,SPT4OA30
          GOTO      SPT4OA99
.
SPT4OA20  WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:showICD02":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&ptico001=",OPCODE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             OPCODE,"</td>":
                             "<td>",ODESC,"</td>":
                             "</tr>"
.
          GOTO      SPT4OA80
.
SPT4OA30  WRITE     HTMLFILE;"<tr valign=top>":
                              "<td><a href=#"#" ":
                              "OnClick=#"updateParent('",ODESC:
                              "','",OPCODE,"')#">":
                              "<img src=../images/MaintenanceIcon.gif hspace=4":
                              " border=0 align=absmiddle></a>":
                              OPCODE,"</td>":
                              "<td>",ODESC,"</td>":
                             "</tr>"
.
SPT4OA80  ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      SPT4OA10 IF NOT EQUAL
          GOTO      SPT4OA99
.
SPT4OA90  CALL      NOMORE00      * Display No More Records Message
.
SPT4OA99  RETURN
.------------------------------------------------------------
. Check ICD10 Edition 4 Procedure Record
.------------------------------------------------------------
SPT4OB00  MATCH     KEYWRD01,PTCOKWD
          GOTO      SPT4OB92 IF NOT EQUAL
          IF        KEYWRDNO>1
            PACK      SAVKEY24,PTCOKWD,PTCOITM
            CALL      SPT4OC00
            BRANCH    EXIT,SPT4OB91
            MOVE      SAVKEY24,KEY24
            CALL      RDPT4O2
          ENDIF
.
. Insert Other Check for Valid Record Here i.e. Suspended or In Active
.   eg    COMPARE    ONE,INACTIVE
.         GOTO       SPT4OB91 IF EQUAL
.
          GOTO      SPT4OB90
.
SPT4OB90  MOVE      ZERO,OVRCD
          GOTO      SPT4OB99
SPT4OB91  MOVE      ONE,OVRCD
          GOTO      SPT4OB99
SPT4OB92  MOVE      TWO,OVRCD
SPT4OB99  RETURN
.------------------------------------------------------------
. Check for Matching ICD10 Edition 4 Procedure Words
.------------------------------------------------------------
SPT4OC00  MOVE      ONE,F2
          MOVE      ZERO,EXIT
          PACK      SAVKEY9,PTCOITM,SP70
.
SPT4OC10  COMPARE   KEYWRDNO,F2           * Loop through each Key Word in Search
          GOTO      SPT4OC99 IF EQUAL     * Exit OK
          ADD       ONE,F2
          LOAD      KEYWRDXX,F2,KEYWRD01,KEYWRD02,KEYWRD03,KEYWRD04,KEYWRD05:
                             KEYWRD06,KEYWRD07,KEYWRD08,KEYWRD09,KEYWRD10
          PACK      KEY24,PTCOITM,KEYWRDXX
          CALL      RDPT4O1               * Check for Exact Match
          COMPARE   ZERO,OVRCD            * Ok so Continue Loop
          GOTO      SPT4OC10 IF EQUAL
.
          CALL      RKPT4O1               * Not Exact so Read Next Record
          BRANCH    OVRCD,SPT4OC90        * No Match So Exit No Match
          PACK      KEY9,PTCOITM,SP70
          MATCH     SAVKEY9,KEY9        * Match Key Fields
          GOTO      SPT4OC90 IF NOT EQUAL * No Match So Exit
          STRIP     KEYWRDXX
          MATCH     PTCOKWD,KEYWRDXX         * Check Key Word
          GOTO      SPT4OC90 IF NOT EQUAL * No Match So Exit
          GOTO      SPT4OC10              * Check Next Search Word
.
SPT4OC90  MOVE      ONE,EXIT
SPT4OC99  RETURN
+
.-----------------------------------------------------------
. ICD9 Procedure Code: Search Table
.-----------------------------------------------------------
SP99OA00  WRITE     HTMLFILE;"<tr align=center>":
                               "<td class=HeadingCell colspan=2><b>You Searched for ":
                               KEYWORDS,"</td>":
                             "</tr>":
                             "<tr>":
                               "<td class=HeadingCell width=15%><b>Code</b></td> ":
                               "<td class=HeadingCell><b>Description</b></td>":
                             "</tr>"
.
          CALL      GETWRD00
.
          UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          STRIP     KEYWRD01
          PACK      KEY24,KEYWRD01,SP70
          CALL      RSPTOI2
SP99OA10  CALL      RKPTOI2
          BRANCH    OVRCD,SP99OA90
.
          CALL      SP99OB00
          BRANCH    OVRCD,SP99OA10,SP99OA90
.
          MOVE      PTOIICD,KEY9
          CALL      RD10T9O1
          BRANCH    OVRCD,SP99OA10
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      SP99OA10
          ENDIF
.
          BRANCH    LNK2PRT,SP99OA20,SP99OA30
          GOTO      SP99OA99
.
SP99OA20  WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:showICD02":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&ptico001=",OPCODE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             OPCODE,"</td>":
                             "<td>",ODESC,"</td>":
                             "</tr>"
.
          GOTO      SP99OA80
.
SP99OA30  WRITE     HTMLFILE;"<tr valign=top>":
                              "<td><a href=#"#" ":
                              "OnClick=#"updateParent('",ODESC:
                              "','",OPCODE,"')#">":
                              "<img src=../images/MaintenanceIcon.gif hspace=4":
                              " border=0 align=absmiddle></a>":
                              OPCODE,"</td>":
                              "<td>",ODESC,"</td>":
                             "</tr>"
.
SP99OA80  ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      SP99OA10 IF NOT EQUAL
SP99OA90
SP99OA99  RETURN
.------------------------------------------------------------
. Check ICD9 Procedure Record
.------------------------------------------------------------
SP99OB00  MATCH     KEYWRD01,PTOIKWD
          GOTO      SP99OB92 IF NOT EQUAL
          IF        KEYWRDNO>1
            PACK      SAVKEY24,PTOIKWD,PTOIICD
            CALL      SP99OC00
            BRANCH    EXIT,SP99OB91
            MOVE      SAVKEY24,KEY24
            CALL      RDPTOI2
          ENDIF
.
. Insert Other Check for Valid Record Here i.e. Suspended or In Active
.   eg    COMPARE    ONE,INACTIVE
.         GOTO       SP99OB91 IF EQUAL
.
          GOTO      SP99OB90
.
SP99OB90  MOVE      ZERO,OVRCD
          GOTO      SP99OB99
SP99OB91  MOVE      ONE,OVRCD
          GOTO      SP99OB99
SP99OB92  MOVE      TWO,OVRCD
SP99OB99  RETURN
.------------------------------------------------------------
. Check for Matching ICD9 Procedure Words
.------------------------------------------------------------
SP99OC00  MOVE      ONE,F2
          MOVE      ZERO,EXIT
          PACK      SAVKEY9,PTOIICD,SP70
.
SP99OC10  COMPARE   KEYWRDNO,F2           * Loop through each Key Word in Search
          GOTO      SP99OC99 IF EQUAL     * Exit OK
          ADD       ONE,F2
          LOAD      KEYWRDXX,F2,KEYWRD01,KEYWRD02,KEYWRD03,KEYWRD04,KEYWRD05:
                             KEYWRD06,KEYWRD07,KEYWRD08,KEYWRD09,KEYWRD10
          PACK      KEY24,PTOIICD,KEYWRDXX
          CALL      RDPTOI1               * Check for Exact Match
          COMPARE   ZERO,OVRCD            * Ok so Continue Loop
          GOTO      SP99OC10 IF EQUAL
.
          CALL      RKPTOI1               * Not Exact so Read Next Record
          BRANCH    OVRCD,SP99OC90        * No Match So Exit No Match
          PACK      KEY9,PTOIICD,SP70
          MATCH     SAVKEY9,KEY9        * Match Key Fields
          GOTO      SP99OC90 IF NOT EQUAL * No Match So Exit
          STRIP     KEYWRDXX
          MATCH     PTOIKWD,KEYWRDXX         * Check Key Word
          GOTO      SP99OC90 IF NOT EQUAL * No Match So Exit
          GOTO      SP99OC10              * Check Next Search Word
.
SP99OC90  MOVE      ONE,EXIT
SP99OC99  RETURN
+
.-----------------------------------------------------------
. ICD10 Diagnosis Code: Search Table
.-----------------------------------------------------------
SPTCDA00  WRITE     HTMLFILE;"<tr align=center>":
                             "<td class=HeadingCell colspan=2>":
                             "<b>You Searched for ":
                               KEYWORDS,"</td></tr><tr>":
                               "<td class=HeadingCell width=15%><b>Code</b>":
                               "</td>":
                               "<td class=HeadingCell><b>Description</b></td>":
                             "</tr>"
.
          CALL      GETWRD00
.
          UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          STRIP     KEYWRD01
          PACK      KEY24,KEYWRD01,SP70
          CALL      RSPTCD2
SPTCDA10  CALL      RKPTCD2
          BRANCH    OVRCD,SPTCDA90
.
          CALL      SPTCDB00
          BRANCH    OVRCD,SPTCDA10,SPTCDA90
.
          MOVE      PTCDITM,KEY9
          CALL      RDPT10D1
          BRANCH    OVRCD,SPTCDA10
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      SPTCDA10
          ENDIF
.
          BRANCH    LNK2PRT,SPTCDA20,SPTCDA30
          GOTO      SPTCDA99  
.
SPTCDA20  MATCH     SP70,PT0DDSC2
          IF        @EQUAL
            WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:showICD03":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pticd001=",DPCODE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             DPCODE,"</td>":
                             "<td>",DDESC,"</td>":
                             "</tr>"
          ELSE
            WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:showICD03":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pticd001=",DPCODE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             DPCODE,"</td>":
                             "<td>",PT0DDSC2,"</td>":
                             "</tr>"
          ENDIF
.
          GOTO      SPTCDA80  
.
SPTCDA30  MATCH     SP70,PT0DDSC2
          IF        @EQUAL
            WRITE     HTMLFILE;"<tr valign=top>":
                                "<td><a href=#"#" ":
                                "OnClick=#"updateParent('",DDESC:
                                "','",DPCODE,"')#">":
                                "<img src=../images/MaintenanceIcon.gif hspace=4":
                                " border=0 align=absmiddle></a>":
                                DPCODE,"</td>":
                                "<td>",DDESC,"</td>":
                               "</tr>"
          ELSE
            WRITE     HTMLFILE;"<tr valign=top>":
                                "<td><a href=#"#" ":
                                "OnClick=#"updateParent('",PT0DDSC2:
                                "','",DPCODE,"')#">":
                                "<img src=../images/MaintenanceIcon.gif hspace=4":
                                " border=0 align=absmiddle></a>":
                                DPCODE,"</td>":
                                "<td>",PT0DDSC2,"</td>":
                               "</tr>"
          ENDIF
. 
SPTCDA80  ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      SPTCDA10 IF NOT EQUAL
          GOTO      SPTCDA99
.
SPTCDA90  CALL      NOMORE00      * Display No More Records Message
.
SPTCDA99  RETURN
.------------------------------------------------------------
. Check ICD10 Diagnosis Record
.------------------------------------------------------------
SPTCDB00  MATCH     KEYWRD01,PTCDKWD
          GOTO      SPTCDB92 IF NOT EQUAL
          IF        KEYWRDNO>1
            PACK      SAVKEY24,PTCDKWD,PTCDITM
            CALL      SPTCDC00
            BRANCH    EXIT,SPTCDB91
            MOVE      SAVKEY24,KEY24
            CALL      RDPTCD2
          ENDIF
.
. Insert Other Check for Valid Record Here i.e. Suspended or In Active
.   eg    COMPARE    ONE,INACTIVE
.         GOTO       SPTCDB91 IF EQUAL
.
          GOTO      SPTCDB90
.
SPTCDB90  MOVE      ZERO,OVRCD
          GOTO      SPTCDB99
SPTCDB91  MOVE      ONE,OVRCD
          GOTO      SPTCDB99
SPTCDB92  MOVE      TWO,OVRCD
SPTCDB99  RETURN
.------------------------------------------------------------
. Check for Matching ICD10 Diagnosis Words
.------------------------------------------------------------
SPTCDC00  MOVE      ONE,F2
          MOVE      ZERO,EXIT
          PACK      SAVKEY9,PTCDITM,SP70
.
SPTCDC10  COMPARE   KEYWRDNO,F2           * Loop through each Key Word in Search
          GOTO      SPTCDC99 IF EQUAL     * Exit OK
          ADD       ONE,F2
          LOAD      KEYWRDXX,F2,KEYWRD01,KEYWRD02,KEYWRD03,KEYWRD04,KEYWRD05:
                             KEYWRD06,KEYWRD07,KEYWRD08,KEYWRD09,KEYWRD10
          PACK      KEY24,PTCDITM,KEYWRDXX
          CALL      RDPTCD1               * Check for Exact Match
          COMPARE   ZERO,OVRCD            * Ok so Continue Loop
          GOTO      SPTCDC10 IF EQUAL
.
          CALL      RKPTCD1               * Not Exact so Read Next Record
          BRANCH    OVRCD,SPTCDC90        * No Match So Exit No Match
          PACK      KEY9,PTCDITM,SP70
          MATCH     SAVKEY9,KEY9        * Match Key Fields
          GOTO      SPTCDC90 IF NOT EQUAL * No Match So Exit
          STRIP     KEYWRDXX
          MATCH     PTCDKWD,KEYWRDXX         * Check Key Word
          GOTO      SPTCDC90 IF NOT EQUAL * No Match So Exit
          GOTO      SPTCDC10              * Check Next Search Word
.
SPTCDC90  MOVE      ONE,EXIT
SPTCDC99  RETURN
.
.-----------------------------------------------------------
. ICD10 Version 3 Diagnosis Code: Search Table
.-----------------------------------------------------------
SPT3DA00  WRITE     HTMLFILE;"<tr align=center>":
                             "<td class=HeadingCell colspan=2>":
                             "<b>You Searched for ":
                               KEYWORDS,"</td></tr><tr>":
                               "<td class=HeadingCell width=15%><b>Code</b>":
                               "</td>":
                               "<td class=HeadingCell><b>Description</b></td>":
                             "</tr>"
.
          CALL      GETWRD00
.
          UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          STRIP     KEYWRD01
          PACK      KEY24,KEYWRD01,SP70
          CALL      RSPT3D2
.
SPT3DA10  CALL      RKPT3D2
          BRANCH    OVRCD,SPT3DA90
.
          CALL      SPT3DB00
          BRANCH    OVRCD,SPT3DA10,SPT3DA90
.
          MOVE      PTCDITM,KEY9
          CALL      RDPT13D1
          BRANCH    OVRCD,SPT3DA10
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      SPT3DA10
          ENDIF
.
          BRANCH    LNK2PRT,SPT3DA20,SPT3DA30
          GOTO      SPT3DA99
.
SPT3DA20  WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:showICD03":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pticd001=",DPCODE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             DPCODE,"</td>":
                             "<td>",DDESC,"</td>":
                             "</tr>"
.
          GOTO      SPT3DA80
.
SPT3DA30  WRITE     HTMLFILE;"<tr valign=top>":
                              "<td><a href=#"#" ":
                              "OnClick=#"updateParent('",DDESC:
                              "','",DPCODE,"')#">":
                              "<img src=../images/MaintenanceIcon.gif hspace=4":
                              " border=0 align=absmiddle></a>":
                              DPCODE,"</td>":
                              "<td>",DDESC,"</td>":
                             "</tr>"
.
SPT3DA80  ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      SPT3DA10 IF NOT EQUAL
          GOTO      SPT3DA99
.
SPT3DA90  CALL      NOMORE00       * Display No More Records Message
.
SPT3DA99  RETURN
.------------------------------------------------------------
. Check ICD10 Version 3 Diagnosis Record
.------------------------------------------------------------
SPT3DB00  MATCH     KEYWRD01,PTCDKWD
          GOTO      SPT3DB92 IF NOT EQUAL
          IF        KEYWRDNO>1
            PACK      SAVKEY24,PTCDKWD,PTCDITM
            CALL      SPT3DC00
            BRANCH    EXIT,SPT3DB91
            MOVE      SAVKEY24,KEY24
            CALL      RDPT3D2
          ENDIF
.
. Insert Other Check for Valid Record Here i.e. Suspended or In Active
.   eg    COMPARE    ONE,INACTIVE
.         GOTO       SPT3DB91 IF EQUAL
.
          GOTO      SPT3DB90
.
SPT3DB90  MOVE      ZERO,OVRCD
          GOTO      SPT3DB99
SPT3DB91  MOVE      ONE,OVRCD
          GOTO      SPT3DB99
SPT3DB92  MOVE      TWO,OVRCD
SPT3DB99  RETURN
.------------------------------------------------------------
. Check for Matching ICD10 Version 3 Diagnosis Words
.------------------------------------------------------------
SPT3DC00  MOVE      ONE,F2
          MOVE      ZERO,EXIT
          PACK      SAVKEY9,PTCDITM,SP70
.
SPT3DC10  COMPARE   KEYWRDNO,F2           * Loop through each Key Word in Search
          GOTO      SPT3DC99 IF EQUAL     * Exit OK
          ADD       ONE,F2
          LOAD      KEYWRDXX,F2,KEYWRD01,KEYWRD02,KEYWRD03,KEYWRD04,KEYWRD05:
                             KEYWRD06,KEYWRD07,KEYWRD08,KEYWRD09,KEYWRD10
          PACK      KEY24,PTCDITM,KEYWRDXX
          CALL      RDPT3D1               * Check for Exact Match
          COMPARE   ZERO,OVRCD            * Ok so Continue Loop
          GOTO      SPT3DC10 IF EQUAL
.
          CALL      RKPT3D1               * Not Exact so Read Next Record
          BRANCH    OVRCD,SPT3DC90        * No Match So Exit No Match
          PACK      KEY9,PTCDITM,SP70
          MATCH     SAVKEY9,KEY9        * Match Key Fields
          GOTO      SPT3DC90 IF NOT EQUAL * No Match So Exit
          STRIP     KEYWRDXX
          MATCH     PTCDKWD,KEYWRDXX         * Check Key Word
          GOTO      SPT3DC90 IF NOT EQUAL * No Match So Exit
          GOTO      SPT3DC10              * Check Next Search Word
.
SPT3DC90  MOVE      ONE,EXIT
SPT3DC99  RETURN
.                                                                      *I-49037
.-----------------------------------------------------------
. ICD10 Edition 4 Diagnosis Code: Search Table
.-----------------------------------------------------------
SPT4DA00  WRITE     HTMLFILE;"<tr align=center>":
                             "<td class=HeadingCell colspan=2>":
                             "<b>You Searched for ":
                               KEYWORDS,"</td></tr><tr>":
                               "<td class=HeadingCell width=15%><b>Code</b>":
                               "</td>":
                               "<td class=HeadingCell><b>Description</b></td>":
                             "</tr>"
.
          CALL      GETWRD00
.
          UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          STRIP     KEYWRD01
          PACK      KEY24,KEYWRD01,SP70
          CALL      RSPT4D2
.
SPT4DA10  CALL      RKPT4D2
          BRANCH    OVRCD,SPT4DA90
.
          CALL      SPT4DB00
          BRANCH    OVRCD,SPT4DA10,SPT4DA90
.
          MOVE      PTCDITM,KEY9
          CALL      RDPT14D1
          BRANCH    OVRCD,SPT4DA10
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      SPT4DA10
          ENDIF
.
          BRANCH    LNK2PRT,SPT4DA20,SPT4DA30
          GOTO      SPT4DA99
.
SPT4DA20  WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:showICD03":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pticd001=",DPCODE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             DPCODE,"</td>":
                             "<td>",DDESC,"</td>":
                             "</tr>"
.
          GOTO      SPT4DA80
.
SPT4DA30  WRITE     HTMLFILE;"<tr valign=top>":
                              "<td><a href=#"#" ":
                              "OnClick=#"updateParent('",DDESC:
                              "','",DPCODE,"')#">":
                              "<img src=../images/MaintenanceIcon.gif hspace=4":
                              " border=0 align=absmiddle></a>":
                              DPCODE,"</td>":
                              "<td>",DDESC,"</td>":
                             "</tr>"
.
SPT4DA80  ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      SPT4DA10 IF NOT EQUAL
          GOTO      SPT4DA99
.
SPT4DA90  CALL      NOMORE00
.
SPT4DA99  RETURN
.------------------------------------------------------------
. Check ICD10 Edition 4 Diagnosis Record
.------------------------------------------------------------
SPT4DB00  MATCH     KEYWRD01,PTCDKWD
          GOTO      SPT4DB92 IF NOT EQUAL
          IF        KEYWRDNO>1
            PACK      SAVKEY24,PTCDKWD,PTCDITM
            CALL      SPT4DC00
            BRANCH    EXIT,SPT4DB91
            MOVE      SAVKEY24,KEY24
            CALL      RDPT4D2
          ENDIF
.
. Insert Other Check for Valid Record Here i.e. Suspended or In Active
.   eg    COMPARE    ONE,INACTIVE
.         GOTO       SPT4DB91 IF EQUAL
.
          GOTO      SPT4DB90
.
SPT4DB90  MOVE      ZERO,OVRCD
          GOTO      SPT4DB99
SPT4DB91  MOVE      ONE,OVRCD
          GOTO      SPT4DB99
SPT4DB92  MOVE      TWO,OVRCD
SPT4DB99  RETURN
.------------------------------------------------------------
. Check for Matching ICD10 Edition 4 Diagnosis Words
.------------------------------------------------------------
SPT4DC00  MOVE      ONE,F2
          MOVE      ZERO,EXIT
          PACK      SAVKEY9,PTCDITM,SP70
.
SPT4DC10  COMPARE   KEYWRDNO,F2           * Loop through each Key Word in Search
          GOTO      SPT4DC99 IF EQUAL     * Exit OK
          ADD       ONE,F2
          LOAD      KEYWRDXX,F2,KEYWRD01,KEYWRD02,KEYWRD03,KEYWRD04,KEYWRD05:
                             KEYWRD06,KEYWRD07,KEYWRD08,KEYWRD09,KEYWRD10
          PACK      KEY24,PTCDITM,KEYWRDXX
          CALL      RDPT4D1               * Check for Exact Match
          COMPARE   ZERO,OVRCD            * Ok so Continue Loop
          GOTO      SPT4DC10 IF EQUAL
.
          CALL      RKPT4D1               * Not Exact so Read Next Record
          BRANCH    OVRCD,SPT4DC90        * No Match So Exit No Match
          PACK      KEY9,PTCDITM,SP70
          MATCH     SAVKEY9,KEY9        * Match Key Fields
          GOTO      SPT4DC90 IF NOT EQUAL * No Match So Exit
          STRIP     KEYWRDXX
          MATCH     PTCDKWD,KEYWRDXX         * Check Key Word
          GOTO      SPT4DC90 IF NOT EQUAL * No Match So Exit
          GOTO      SPT4DC10              * Check Next Search Word
.
SPT4DC90  MOVE      ONE,EXIT
SPT4DC99  RETURN
+
.-----------------------------------------------------------
. ICD9 Diagnosis Code: Search Table
.-----------------------------------------------------------
SP99DA00  WRITE     HTMLFILE;"<tr align=center>":
                             "<td class=HeadingCell colspan=2>":
                             "<b>You Searched for ":
                               KEYWORDS,"</td></tr><tr>":
                               "<td class=HeadingCell width=15%><b>Code</b>":
                               "</td>":
                               "<td class=HeadingCell><b>Description</b></td>":
                             "</tr>"
.
          CALL      GETWRD00
.
          UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          STRIP     KEYWRD01
          PACK      KEY24,KEYWRD01,SP70
          CALL      RSPTDI2
SP99DA10  CALL      RKPTDI2
          BRANCH    OVRCD,SP99DA90
.
          CALL      SP99DB00
          BRANCH    OVRCD,SP99DA10,SP99DA90
.
          MOVE      PTDIICD,KEY9
          CALL      RD10T9D1
          BRANCH    OVRCD,SP99DA10
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      SP99DA10
          ENDIF
.
          BRANCH    LNK2PRT,SP99DA20,SP99DA30
          GOTO      SP99DA99
.
SP99DA20  WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:showICD03":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pticd001=",DPCODE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             DPCODE,"</td>":
                             "<td>",DDESC,"</td>":
                             "</tr>"
.
          GOTO      SP99DA80
.
SP99DA30  WRITE     HTMLFILE;"<tr valign=top>":
                              "<td><a href=#"#" ":
                              "OnClick=#"updateParent('",DDESC:
                              "','",DPCODE,"')#">":
                              "<img src=../images/MaintenanceIcon.gif hspace=4":
                              " border=0 align=absmiddle></a>":
                              DPCODE,"</td>":
                              "<td>",DDESC,"</td>":
                             "</tr>"
.
SP99DA80  ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      SP99DA10 IF NOT EQUAL
SP99DA90
SP99DA99  RETURN
.------------------------------------------------------------
. Check ICD9 Diagnosis Record
.------------------------------------------------------------
SP99DB00  MATCH     KEYWRD01,PTDIKWD
          GOTO      SP99DB92 IF NOT EQUAL
          IF        KEYWRDNO>1
            PACK      SAVKEY24,PTDIKWD,PTDIICD
            CALL      SP99DC00
            BRANCH    EXIT,SP99DB91
            MOVE      SAVKEY24,KEY24
            CALL      RDPTDI2
          ENDIF
.
. Insert Other Check for Valid Record Here i.e. Suspended or In Active
.   eg    COMPARE    ONE,INACTIVE
.         GOTO       SP99DB91 IF EQUAL
.
          GOTO      SP99DB90
.
SP99DB90  MOVE      ZERO,OVRCD
          GOTO      SP99DB99
SP99DB91  MOVE      ONE,OVRCD
          GOTO      SP99DB99
SP99DB92  MOVE      TWO,OVRCD
SP99DB99  RETURN
.------------------------------------------------------------
. Check for Matching ICD9 Diagnosis Words
.------------------------------------------------------------
SP99DC00  MOVE      ONE,F2
          MOVE      ZERO,EXIT
          PACK      SAVKEY9,PTDIICD,SP70
.
SP99DC10  COMPARE   KEYWRDNO,F2           * Loop through each Key Word in Search
          GOTO      SP99DC99 IF EQUAL     * Exit OK
          ADD       ONE,F2
          LOAD      KEYWRDXX,F2,KEYWRD01,KEYWRD02,KEYWRD03,KEYWRD04,KEYWRD05:
                             KEYWRD06,KEYWRD07,KEYWRD08,KEYWRD09,KEYWRD10
          PACK      KEY24,PTDIICD,KEYWRDXX
          CALL      RDPTDI1               * Check for Exact Match
          COMPARE   ZERO,OVRCD            * Ok so Continue Loop
          GOTO      SP99DC10 IF EQUAL
.
          CALL      RKPTDI1               * Not Exact so Read Next Record
          BRANCH    OVRCD,SP99DC90        * No Match So Exit No Match
          PACK      KEY9,PTDIICD,SP70
          MATCH     SAVKEY9,KEY9        * Match Key Fields
          GOTO      SP99DC90 IF NOT EQUAL * No Match So Exit
          STRIP     KEYWRDXX
          MATCH     PTDIKWD,KEYWRDXX         * Check Key Word
          GOTO      SP99DC90 IF NOT EQUAL * No Match So Exit
          GOTO      SP99DC10              * Check Next Search Word
.
SP99DC90  MOVE      ONE,EXIT
SP99DC99  RETURN
+
.-------------------------------------------------------------------------------
. Option 3 : Set Parameters for Cancer Code Maintanance
.-------------------------------------------------------------------------------
STCAN000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STCAN001,STCAN002
.
          MOVE      ONE,EXIT
          GOTO      STCTC999
.
STCAN001  MOVE      QRYDATA,PTCAN001
          GOTO      STCAN999
.
STCAN002  MOVE      QRYDATA,PTCAN002
          GOTO      STCAN999
.
STCAN999  RETURN
.
.-------------------------------------------------------------------------------
. ADDCAN00  Add a record to the cancer file if it is a cancer code
.-------------------------------------------------------------------------------
ADDCAN00  COMPARE   ONE,PTCAN001
          GOTO      ADDCAN99 IF NOT EQUAL
.
          PACK      KEY9,PTICD001,SP70
          CALL      RDPTCAN1
          BRANCH    OVRCD,ADDCAN50
.
          MOVE      PTCAN002,PTCCLATR       
          CALL      UPPTCAN1                * Update the cancer code record
.
          GOTO      ADDCAN99
.
ADDCAN50  MOVE      PTICD001,PTCCCODE
          MOVE      PTCAN002,PTCCLATR
          MOVE      SP70,PTCCSPAR
.
          PACK      KEY9,PTICD001,SP70      * Add a new cancer code record
          CALL      WRPTCAN1

ADDCAN99  RETURN
.
.-------------------------------------------------------------------------------
. UPDCAN00  Update the cancer code file if it is a cancer code
.-------------------------------------------------------------------------------
UPDCAN00  COMPARE   ONE,PTCAN001
          GOTO      UPDCAN80 IF NOT EQUAL
.
          PACK      KEY9,PTICD001,SP70
          CALL      RDPTCAN1
          BRANCH    OVRCD,UPDCAN50
.
          MOVE      PTCAN002,PTCCLATR
          CALL      UPPTCAN1                * Update the cancer code record
          GOTO      UPDCAN99
.
UPDCAN50  MOVE      PTICD001,PTCCCODE
          MOVE      PTCAN002,PTCCLATR
          MOVE      SP70,PTCCSPAR
.
          PACK      KEY9,PTICD001,SP70      * Add a new cancer code record
          CALL      WRPTCAN1
          GOTO      UPDCAN99
.
UPDCAN80  PACK      KEY9,PTICD001,SP70
          CALL      RDPTCAN1
          BRANCH    OVRCD,UPDCAN99
.  
          CALL      DEPTCAN1                * Delete the cancer code record
.
UPDCAN99  RETURN
.
.-------------------------------------------------------------------------------
. DELCAN00  Delete the cancer code record if diagnosis code is deleted
.-------------------------------------------------------------------------------
DELCAN00  PACK      KEY9,PTICD001,SP70
          CALL      RDPTCAN1
          BRANCH    OVRCD,DELCAN99
.  
          CALL      DEPTCAN1                * Delete the cancer code record
.
DELCAN99  RETURN
.
.------------------------------------------------------------
. Option 17 : Hospital details Maintenance
.------------------------------------------------------------
HSPD0000  BRANCH    FLDITMNO,HSPD0100,HSPD0200,HSPD0300,HSPD0400,HSPD0500:
                             HSPD0600,HSPD0700,HSPD0800,HSPD0900,HSPD1000:
                             HSPD1100,HSPD1200,HSPD1300,HSPD1400,HSPD1500:
                             HSPD1600,HSPD1700,HSPD1800,HSPD1900,HSPD2000:
                             HSPD2100,HSPD2200,HSPD2300,HSPD2400,HSPD2500:
                             HSPD2600,HSPD2700,HSPD2800,HSPD2900,HSPD3000:
                             HSPD3100,HSPD3200,HSPD3300,HSPD3400,HSPD3500:
                             HSPD3600,HSPD3700,HSPD3800,HSPD3900,HSPD4000:
                             HSPD4100,HSPD4200,HSPD4300,HSPD4400,HSPD4500:
                             HSPD4600,HSPD4700,HSPD4800,HSPD4900,HSPD5000:
                             HSPD5100,HSPD5200,HSPD5300,HSPD5400,HSPD5500:
                             HSPD5600,HSPD5700,HSPD5800,HSPD5900,HSPD6000:
                             HSPD6100,HSPD6200,HSPD6300,HSPD6400,HSPD6500:
                             HSPD6600,HSPD6700,HSPD6800
          GOTO      HSPD9999
.
HSPD0100  WRITE     HTMLFILE;PTHSHOSP;
          GOTO      HSPD9999
.
HSPD0200  WRITE     HTMLFILE;PTHSNAME;
          GOTO      HSPD9999
.
HSPD0300  WRITE     HTMLFILE;PTHSADD1;
          GOTO      HSPD9999
.
HSPD0400  WRITE     HTMLFILE;PTHSADD2;
          GOTO      HSPD9999
.
HSPD0500  WRITE     HTMLFILE;PTHSADD3;
          GOTO      HSPD9999
.
HSPD0600  WRITE     HTMLFILE;PTHSADD4;
          GOTO      HSPD9999
.
HSPD0700  WRITE     HTMLFILE;PTHSPCOD;
          GOTO      HSPD9999
.
HSPD0800  WRITE     HTMLFILE;PTHSTELE;
          GOTO      HSPD9999
.
HSPD0900  WRITE     HTMLFILE;PTHSFAXN;
          GOTO      HSPD9999
.
HSPD1000  WRITE     HTMLFILE;PTHSUNIT;
          GOTO      HSPD9999
.
HSPD1100  WRITE     HTMLFILE;PTHSHDPC;
          GOTO      HSPD9999
.
HSPD1200  WRITE     HTMLFILE;PTHSMRPR;
          GOTO      HSPD9999
.
HSPD1300  WRITE     HTMLFILE;PTHSPACT;
          GOTO      HSPD9999
.
HSPD1400  WRITE     HTMLFILE;PTHSNUMB;
          GOTO      HSPD9999
.
HSPD1500  CALL      HSPTB000    * Table of Hospital Details Maintenance
          GOTO      HSPD9999
.
HSPD1600  CALL      NEXTGR00    * Next set of Codes
          GOTO      HSPD9999
.
HSPD1700  CALL      PREVGR00    * Prev set of Codes
          GOTO      HSPD9999
.
HSPD1800  MOVE      "0",KEY1
          MATCH     "1",PTHSPMBS
          IF        @EQUAL
            MOVE      "1",KEY1
          ENDIF 
          WRITE     HTMLFILE;KEY1;
          GOTO      HSPD9999
.
HSPD1900  WRITE     HTMLFILE;PTHSTFEE;
          GOTO      HSPD9999
.
HSPD2000  OPEN      CONTROLF,"controlf"
          READ      CONTROLF,SIXTY;*105,MRCNHMTY
          PACK      KEY7,SP70                                         *C-240724
          CALL      RSMRLOC1
HSPD2050  CALL      RKMRLOC1
          BRANCH    OVRCD,HSPD9999
.
          MATCH     MRLOTYPE,MRCNHMTY
          GOTO      HSPD2050 IF NOT EQUAL
.
          COMPARE   ONE,MRLOSTAT                   * I-49202
          GOTO      HSPD2050 IF EQUAL
.
          MATCH     PTHSHHOS,MRLOHOSP                                 *I-240724
          GOTO      HSPD2050 IF NOT EQUAL
.
          MATCH     PTHSHHOS,MRLOHOSP                                 *I-240724
          IF        @EQUAL
            MATCH     PTHSHLOC,MRLOCODE
            IF        @EQUAL
              WRITE     HTMLFILE;"<option value=#"",MRLOCODE,"#" selected>":
                                 MRLODESC,"</option>"
            ELSE
              WRITE     HTMLFILE;"<option value=#"",MRLOCODE,"#">",MRLODESC:
                                 "</option>"
            ENDIF
          ENDIF
          GOTO      HSPD2050
.
HSPD2100  MOVE      PTHSRCTY,CODE
          MOVE      "TY",CATEGORY
          CALL      CODITM00
          GOTO      HSPD9999
.
HSPD2200  WRITE     HTMLFILE;PTHSVOLM;
          GOTO      HSPD9999
.
HSPD2300  MOVE      PTHSSTAT,CODE
          MOVE      "RS",CATEGORY
          CALL      CODITM00
          GOTO      HSPD9999
.
HSPD2400  MOVE      PTHSDCLM,CODE
          MOVE      "CL",CATEGORY
          CALL      CODITM00
          GOTO      HSPD9999
.
HSPD2500  WRITE     HTMLFILE;PTHSAPPR;
          GOTO      HSPD9999
.
HSPD2600  MATCH     "1",PTHSUFMS
          IF        @EQUAL
            WRITE    HTMLFILE;"<option value=0>":
                              "No</option>":
                              "<option value=1 selected>":
                              "Yes(IBA)</option>":
                              "<option value=2>":
                              "Yes(Other)</option>";
          ELSE
            MATCH     "2",PTHSUFMS
            IF        @EQUAL
              WRITE    HTMLFILE;"<option value=0>":
                                "No</option>":
                                "<option value=1>":
                                "Yes(IBA)</option>":
                                "<option value=2 selected>":
                                "Yes(Other)</option>";
            ELSE
              WRITE    HTMLFILE;"<option value=0 selected>":
                                "No</option>":
                                "<option value=1>":
                                "Yes(IBA)</option>":
                                "<option value=2>":
                                "Yes(Other)</option>";
            ENDIF
          ENDIF
          GOTO      HSPD9999
.
HSPD2700  WRITE     HTMLFILE;PTHSABNN;
          GOTO      HSPD9999
.
HSPD2800  WRITE     HTMLFILE;PTHSHSID;
          GOTO      HSPD9999
.
HSPD2900  WRITE     HTMLFILE;PTHSHCEN;
          GOTO      HSPD9999
.
HSPD3000  WRITE     HTMLFILE;PTHSPTIN;
          GOTO      HSPD9999
.
HSPD3100  WRITE     HTMLFILE;PTHSSPID;
          GOTO      HSPD9999
.
HSPD3200  WRITE     HTMLFILE;PTHSEDIP;
          GOTO      HSPD9999
.
HSPD3300  WRITE     HTMLFILE;PTHSORID;
          GOTO      HSPD9999
.
HSPD3400  WRITE     HTMLFILE;PTHSMORG;
          GOTO      HSPD9999
.
HSPD3500  WRITE     HTMLFILE;PTHSCHOT;
          GOTO      HSPD9999
.
HSPD3600  WRITE     HTMLFILE;PTHSCHOD;
          GOTO      HSPD9999
.
HSPD3700  WRITE     HTMLFILE;PTHSHOST;
          GOTO      HSPD9999
.
HSPD3800  WRITE     HTMLFILE;PTHSUDVA;
          GOTO      HSPD9999
.
HSPD3900  PACK      KEY8,SP70
          CALL      RSPTLCN1
HSPD3950  CALL      RKPTLCN1
          BRANCH    OVRCD,HSPD9999
.
          MATCH     ANSI,PTLNACTV                * Active Only
          GOTO      HSPD3950 IF EQUAL
.
          MATCH     PTHSLOCN,PTLNLOCN
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",PTLNLOCN,"#" selected>":
                               PTLNDESC,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",PTLNLOCN,"#">",PTLNDESC:
                               "</option>"
          ENDIF
          GOTO      HSPD3950
.
HSPD4000  MOVE      ZERO,USEPTHSP           * Using user Hospital ID
          CALL      REGSLT00                * Register Selection List - Billing
          GOTO      HSPD9999
.
HSPD4100  MOVE      ZERO,USEPTHSP           * Using user Hospital ID
          CALL      CDSLTN00                * Cash Drawer Selection List
          GOTO      HSPD9999
.
HSPD4200  CALL      CHQSLT00
          GOTO      HSPD9999 
.
HSPD4300  WRITE     HTMLFILE;PTHSCFCD;
          GOTO      HSPD9999
.
HSPD4400  WRITE     HTMLFILE;PTHSSNAM;
          GOTO      HSPD9999
.
HSPD4500  WRITE     HTMLFILE;PTHSTORD;
          GOTO      HSPD9999
.
HSPD4600  COMPARE   ONE,IBCNMHOS
          GOTO      HSPD9999 IF NOT EQUAL
.
          WRITE     HTMLFILE;"<tr><td>&nbsp;</td><td>&nbsp;</td>":
                             "<td class=DataLabel>Default MR Hospital ID</td>":
                             "<td><select name=pthsp043 title='Hospital ID' ":
                             "onChange='SetLocation(UpdateForm)'>":
                             "<option></option>"
          MOVE      PTHSHHOS,DIM3
          CALL      HSEL0000
          WRITE     HTMLFILE;"</select></td></tr>";
          GOTO      HSPD9999
.
HSPD4700  PACK      KEY14,PTHSHOSP,SP70
          CALL      RSPMDIV1
          CALL      RKPMDIV1                * Does hospital have divisions?
          BRANCH    OVRCD,HSPD4710
.
          MATCH     PTHSHOSP,PMDIHOSP       * Same hospital?
          GOTO      HSPD4710 IF NOT EQUAL
.
          WRITE     HTMLFILE;ONE;           * divisions exist
          GOTO      HSPD9999
.
HSPD4710  WRITE     HTMLFILE;ZERO;          * no divisions exist
          GOTO      HSPD9999
.
HSPD4800  MOVE      ZERO,USEPTHSP           * Using user Hospital ID
          CALL      REGCRS00                * Register for Credit Card Surcharge
          GOTO      HSPD9999
.
HSPD4900  UNPACK    DIM127,D1,KEY1,DIM127
          MATCH     SP70,PTHSRCOP
          GOTO      HSPD9999 IF EQUAL
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,HSPD4910             * 0=description, 1=code
.
          MOVE      "&nbsp;",DOCFNAME
          PACK      KEY10,PTHSRCOP,SP70
          CALL      RDPMHCP1
          IF        OVRCD=0
            MOVE      PMHCTITL,FMTTITLE
            MOVE      PMHCGNAM,FMTGNAME
            MOVE      PMHCSNAM,FMTSNAME
            CALL      DOCNM000
          ENDIF
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      HSPD9999
.
HSPD4910  WRITE     HTMLFILE;PTHSRCOP;
          GOTO      HSPD9999
.
HSPD5000  WRITE     HTMLFILE;PTHSHBID;     * BPAY Identifier (1-4 digits)
          GOTO      HSPD9999
.
HSPD5100  PACK      KEY7,SP70              * Default MR Coding Destinatio
          CALL      RSMRLOC1
HSPD5150  CALL      RKMRLOC1
          BRANCH    OVRCD,HSPD9999
.
          COMPARE   ONE,MRLOSTAT
          GOTO      HSPD5150 IF EQUAL
.
          MATCH     PTHSHHOS,MRLOHOSP
          GOTO      HSPD5150 IF NOT EQUAL
.
          MATCH     PTHSHHOS,MRLOHOSP
          IF        @EQUAL
            MATCH     PTHSDCDT,MRLOCODE
            IF        @EQUAL
              WRITE     HTMLFILE;"<option value=#"",MRLOCODE,"#" selected>":
                                 MRLODESC,"</option>"
            ELSE
              WRITE     HTMLFILE;"<option value=#"",MRLOCODE,"#">",MRLODESC:
                                 "</option>"
            ENDIF
          ENDIF
          GOTO      HSPD5150
.
HSPD5200  WRITE     HTMLFILE;PTHSHPIO;     * HPI-O Number
          GOTO      HSPD9999
.
HSPD5300  PACK      KEY26,PTHSHOSP,SP70
          CALL      RSPMIHU1
          CALL      RKPMIHU1                * Does hospital unit have a HPIO 
          BRANCH    OVRCD,HSPD5310
.
          MATCH     PTHSHOSP,PMIUHOSP       * Same hospital?
          GOTO      HSPD5310 IF NOT EQUAL
.
          WRITE     HTMLFILE;ONE;           * HPIO exist
          GOTO      HSPD9999
.
HSPD5310  WRITE     HTMLFILE;ZERO;          * No HPIO exist
          GOTO      HSPD9999
.
HSPD5400  WRITE     HTMLFILE;PTHSCFST;
          GOTO      HSPD9999
.
HSPD5500  MOVE      PTHSHDHB,CODE           * District Health Board (Cat dh)
          MOVE      "dh",CATEGORY
          CALL      CODITM00
          GOTO      HSPD9999
.
HSPD5600  MOVE      PTHSAGNC,CODE           * Health Agency (Cat HA)
          MOVE      "HA",CATEGORY
          CALL      CODITM00
          GOTO      HSPD9999
.
HSPD5700  WRITE     HTMLFILE;PTHSHSST;
          GOTO      HSPD9999
.
HSPD5800  WRITE     HTMLFILE;PTHSACTR;
          GOTO      HSPD9999
.
HSPD5900  WRITE     HTMLFILE;PTHSAGEL;
          GOTO      HSPD9999
.
HSPD6000  WRITE     HTMLFILE;PTHSAGEH;
          GOTO      HSPD9999
.
HSPD6100  WRITE     HTMLFILE;PTHSMAPH;
          GOTO      HSPD9999
.
HSPD6200  UNPACK    DIM127,D1,KEY1,DIM127
          MATCH     SP70,PTHSACTR
          GOTO      HSPD9999 IF EQUAL
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,HSPD6210             * 0=description, 1=code
.
          MOVE      "&nbsp;",DOCFNAME
          PACK      KEY10,PTHSACTR,SP70
          CALL      RDPMHCP1
          IF        OVRCD=0
            MOVE      PMHCTITL,FMTTITLE
            MOVE      PMHCGNAM,FMTGNAME
            MOVE      PMHCSNAM,FMTSNAME
            CALL      DOCNM000
          ENDIF
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      HSPD9999
.
HSPD6210  WRITE     HTMLFILE;PTHSACTR;
          GOTO      HSPD9999
.
HSPD6300  CALL      RESLOC00
          GOTO      HSPD9999
.
HSPD6400  MOVE      WBSEHOSP,SAVWBHOS
          MOVE      PTHSHOSP,WBSEHOSP
          MOVE      PTHSDCLM,CODE
          MOVE      "CL",CATEGORY
          CALL      CODITM00
          MOVE      SAVWBHOS,WBSEHOSP
          GOTO      HSPD9999
.
HSPD6500  MOVE      ONE,USEPTHSP            * Using selected Hospital ID
          CALL      REGSLT00                * Register Selection List - Billing
          GOTO      HSPD9999
.
HSPD6600  MOVE      ONE,USEPTHSP            * Using selected Hospital ID
          CALL      CDSLTN00                * Cash Drawer Selection List
          GOTO      HSPD9999
.
HSPD6700  MOVE      ONE,USEPTHSP            * Using selected Hospital ID
          CALL      REGCRS00                * Register for Credit Card Surcharge
          GOTO      HSPD9999
.
HSPD6800  COMPARE   ONE,IBCNMHOS
          GOTO      HSPD9999 IF NOT EQUAL
.
          WRITE     HTMLFILE;"<tr><td>&nbsp;</td><td>&nbsp;</td>":
                             "<td class=DataLabel>Default MR Hospital ID</td>":
                             "<td><select name=pthsp043 title='Hospital ID' ":
                             "onChange='SetLocation(AddForm)'>":
                             "<option></option>"
          MOVE      PTHSHHOS,DIM3
          CALL      HSEL0000
          WRITE     HTMLFILE;"</select></td></tr>";
          GOTO      HSPD9999
.
HSPD9999  RETURN
+
.------------------------------------------------------------
. Hospital Selection - List of Hospitals allowed to User
.------------------------------------------------------------
HSEL0000  PACK      KEY3,SP70
          CALL      RSPTHSP1
HSEL0100  CALL      RKPTHSP1
          BRANCH    OVRCD,HSEL9000
.
          PACK      KEY13,USERID,SP70                * All hospital access
          CALL      RDMLSEC1
          IF        OVRCD=1
            PACK      KEY13,USERID,PTHSHOSP,SP70     * This hospital access
            CALL      RDMLSEC1
            BRANCH    OVRCD,HSEL0100
          ENDIF
.
          MOVE      PTHSNAME,KEY50
          PACK      KEY5,QUOTE,PTHSHOSP,QUOTE
          MATCH     DIM3,PTHSHOSP
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY5," selected>":
                               KEY50,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY5,">",KEY50,"</option>"
          ENDIF
          GOTO      HSEL0100
.
HSEL9000  PACK      KEY3,PTHSP001,SP70
          CALL      RDPTHSP1
.
HSEL9999  RETURN
.------------------------------------------------------------
. Table of Hospital ID Maintanence
.------------------------------------------------------------
HSPTB000  IF        FHIRTYPE=0
            UNPACK    DIM127,D1,LINKPRG,DIM127
            UNPACK    DIM127,D1,LINKREP,DIM127
            UNPACK    DIM127,D1,LINKTEM,DIM127
            CALL      HDHED000      * Output Table Heading
            IF        NORECORD=0
              MOVE      PTCNNRTD,NORECORD    * Set Default No Records to Display
            ENDIF
          ENDIF
.
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY3,STARTKEY,SP70
          CALL      RDPTHSP1
          IF        OVRCD=0
            CALL      RPPTHSP1
          ENDIF
.
HSPTB100  CALL      RKPTHSP1
          BRANCH    OVRCD,HSPTB900
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      HSPTB100
          ENDIF
.
          CALL      HDROW000      * Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      HSPTB100 IF NOT EQUAL
          GOTO      HSPTB999
.
HSPTB900  IF FHIRTYPE=0 
            CALL      NOMORE00         * Display No More Records Message
          ENDIF
.
HSPTB999  RETURN
.------------------------------------------------------------
. Hospital Details Maintanance Details (TABLE HEADING)
.------------------------------------------------------------
HDHED000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell width=40%>":
                               "<b>Hospital ID</b></td>":
                               "<td class=HeadingCell width=60%>":
                               "<b>Name</b></td>":
                             "</tr>"
.
HDHED999  RETURN
.------------------------------------------------------------
. Hospital details Maintanance Details (TABLE ROW)
.------------------------------------------------------------
HDROW000  MATCH     SP70,PTHSNAME
          IF        @EQUAL
            MOVE      "&nbsp;",KEY50
          ELSE
            MOVE      PTHSNAME,KEY50
          ENDIF
.
          BRANCH    FHIRTYPE,HDROW100
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail17":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pthsp001=",PTHSHOSP,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             PTHSHOSP,"</td>":
                             "<td>",KEY50,"</td>":
                             "</tr>"
          GOTO      HDROW999
.
HDROW100  IF        DISNUMB>0
            WRITE     HTMLFILE;",";
          ENDIF
          CLEAR     KEY16
          APPEND    "Hospital-",KEY16
          APPEND    PTHSHOSP,KEY16
          APPEND    SP70,KEY16
          RESET     KEY16
          STRIP     KEY16
          STRIP     WBTPFIL  *  Template
          WRITE     HTMLFILE;*+,"{ #"fullUrl#" : #"%BASEURL/Location/",KEY16,"#", ":
                                 " #"resource#" : ";
          CALL      RESLOC00
          WRITE     HTMLFILE;*+,"}"
HDROW999 RETURN
.
RESLOC00  STRIP     PTHSNAME
          STRIP     PTHSHOSP
          CLEAR     KEY16
          APPEND    "Hospital-",KEY16
          APPEND    PTHSHOSP,KEY16
          APPEND    SP70,KEY16
          RESET     KEY16
          STRIP     KEY16
          STRIP     WBTPFIL  *  Template
          WRITE     HTMLFILE;*+," { #"resourceType#": #"Location#",":
                    "   #"id#": #"",KEY16,"#",":
                    " #"extension#": [":
                    " { #"url#":#"%BASEURL/extension/webPASService#"":
                        " ,#"valueString#":#"",PRGID,SP1,PRGNAM,SP1,VERSION,"#"},":
                    " { #"url#":#"%BASEURL/extension/webPASTemplate#"":
                        " ,#"valueString#":#"%TEMPLATEHOME/",WBTPFIL," %TEMPLATEVERSION#"}":
                    " ],":
                    " #"identifier#": {":
                    "   #"value#": #"",KEY16,"#"":
                    " },";
          MATCH     SP70,PTHSTELE
          IF        !@EQUAL
             WRITE     HTMLFILE;*+," #"telecom#": [":
                       "{ #"system#": #"phone#",":
                       "  #"value#": #"",PTHSTELE,"#" }";
             MATCH    SP70,PTHSFAXN
             IF       @EQUAL
               WRITE    HTMLFILE;*+,"],";
             ELSE
               WRITE    HTMLFILE;*+,",";
             ENDIF
          ENDIF
          MATCH     SP70,PTHSFAXN
          IF        !@EQUAL
             MATCH     SP70,PTHSTELE
             IF        @EQUAL
               WRITE     HTMLFILE;*+," #"telecom#": ["; 
             ENDIF
             WRITE     HTMLFILE;*+,"{ #"system#": #"fax#",":
                       "  #"value#": #"",PTHSFAXN,"#" } ],";
          ENDIF
          WRITE     HTMLFILE;*+," #"name#": #"",PTHSNAME,"#", ":
                    " #"physicalType#": {":
                    "  #"coding#": [ {":
                    "   #"system#": #"http://hl7.org/fhir/location-physical-type#",":
                    "   #"code#": #"si#",":
                    "   #"display#": #"Site#"  } ] }":
                    "  } ";
          RETURN
+
.------------------------------------------------------------------------------
.                           Display Warnings
.------------------------------------------------------------------------------
WEBWAR00  CALL      OPENHTML
          BRANCH    EXIT,WEBWAR95
.
          WRITE     HTMLFILE;"<script type=#"text/javascript#" ":
                             "src=#"../js/Standard.js#"></script>":
                             "<script type=#"text/javascript#" ":
                             "src=#"../js/Custom.js#"></script>":
                             "<script type=#"text/javascript#"> ":
                             "  alert(#"",WARNTEXT,"#");":
                             " if (self.name.match(/PopUpFrame/)) {":
                             "  reloadParentFrame();}":
                             " else { ":
                             "  opener.history.go(0);":
                             "  self.close(); }":
                             "</script>"
          CALL      CLOSHTML     * End of Document
.
WEBWAR95  DISPLAY   "*** Fifo Not Found ***"
.
WEBWAR99  RETURN
+
.-----------------------------------------------------------
.  Register Selection List (Patient Billing) - rcpregaf
.-----------------------------------------------------------
REGSLT00  READ      CONTROLF,THIRTY6;*221,RCCNORUH
.
          PACK      KEY38,SP70                                         *C-58556
          CALL      RDSREGA4                                           *C-58556
REGSLT10  CALL      RDKREGA4                            * was RDKREGA1 *C-58556
          BRANCH    OVRCD,REGSLT99
.
          MATCH     "1",REGACTIV            * 1=Inactive               *I-58556
          GOTO      REGSLT10 IF EQUAL       * bypass Inactive          *I-58556
.
          IF        IBCNMHOS=1
            MATCH     "1",RCCNORUH
            IF        @EQUAL
              MATCH     "1",USEPTHSP       * Using the selected Hospital ID
              IF        @EQUAL
                MATCH     PTHSHOSP,REGHOSP
                GOTO      REGSLT10 IF NOT EQUAL
              ELSE
                MATCH     WBSEHOSP,REGHOSP
                GOTO      REGSLT10 IF NOT EQUAL
              ENDIF
            ENDIF
          ENDIF
.
          COMPARE   ONE,REGIBACD
          GOTO      REGSLT10 IF NOT EQUAL
.
          PACK      KEY5,QUOTE,REGCODE,QUOTE
          MATCH     PTHSERRE,REGCODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY5,"selected>",REGDESC:
                               "</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY5,">",REGDESC:
                               "</option>";
          ENDIF
          GOTO      REGSLT10
.
REGSLT99  RETURN
+
.-----------------------------------------------------------
.  Register Selection List (Credit Card Surcharge) - rcpregaf
.-----------------------------------------------------------
REGCRS00  READ      CONTROLF,THIRTY6;*221,RCCNORUH
.
          PACK      KEY38,SP70
          CALL      RDSREGA4
REGCRS10  CALL      RDKREGA4
          BRANCH    OVRCD,REGCRS99
.
          MATCH     "1",REGACTIV            * 1=Inactive
          GOTO      REGCRS10 IF EQUAL       * bypass Inactive
.
          IF        IBCNMHOS=1
            MATCH     "1",RCCNORUH
            IF        @EQUAL
              MATCH     "1",USEPTHSP       * Using the selected Hospital ID
              IF        @EQUAL
                MATCH     PTHSHOSP,REGHOSP
                GOTO      REGCRS10 IF NOT EQUAL
              ELSE
                MATCH     WBSEHOSP,REGHOSP
                GOTO      REGCRS10 IF NOT EQUAL
              ENDIF
            ENDIF
          ENDIF
.
          COMPARE   "89",REGIBACD
          GOTO      REGCRS10 IF NOT EQUAL
.
          PACK      KEY5,QUOTE,REGCODE,QUOTE
.
          MATCH     PTHSCRSR,REGCODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY5,"selected>",REGDESC:
                               "</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY5,">",REGDESC:
                               "</option>";
          ENDIF
          GOTO      REGCRS10
.
REGCRS99  RETURN
+
.-----------------------------------------------------------
.  Cash Drawer Selection List - rcpcidaf
.-----------------------------------------------------------
CDSLTN00  PACK      KEY6,SP70
          CALL      RDSCIDA1
CDSLTN10  CALL      RDKCIDA1
          BRANCH    OVRCD,CDSLTN99
.
          MATCH     "1",RCCIACTV
          GOTO      CDSLTN10 IF EQUAL   * Inactive
.
          CLEAR     FORMATNM
          APPEND    RCPGIVEN,FORMATNM
          APPEND    SP1,FORMATNM
          APPEND    RCPSUR,FORMATNM
          RESET     FORMATNM
.
          PACK      KEY8,QUOTE,RCPCASH,QUOTE
.
          MATCH     PTHSERCD,RCPCASH
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY8,"selected>",FORMATNM:
                               "</option>";
          ELSE
            IF        IBCNMHOS=1
              MATCH     SP70,RCCIHOSP
              IF        !@EQUAL
                MATCH     "1",USEPTHSP       * Using the selected Hospital ID
                IF        @EQUAL
                  MATCH     PTHSHOSP,RCCIHOSP
                  GOTO      CDSLTN10 IF NOT EQUAL
                ELSE
                  MATCH     WBSEHOSP,RCCIHOSP
                  GOTO      CDSLTN10 IF NOT EQUAL
                ENDIF
              ENDIF
            ENDIF
.
            WRITE     HTMLFILE;"<option value=",KEY8,">",FORMATNM:
                               "</option>";
          ENDIF
.
          GOTO      CDSLTN10
.
CDSLTN99  RETURN
+
.-----------------------------------------------------------
.  Cheque Account Selection List - fmschqaf
.-----------------------------------------------------------
CHQSLT00  PACK      KEY15,SP70
          CALL      RSFMCH1
CHQSLT10  CALL      RKFMCH1
          BRANCH    OVRCD,CHQSLT99
.
          PACK      KEY17,QUOTE,FMCHCHQ,QUOTE
          MATCH     PTHSERCA,FMCHCHQ
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY17,"selected>":
                               FMCHDES,"</option>";
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY17,">":
                               FMCHDES,"</option>";
          ENDIF
          GOTO      CHQSLT10
.
CHQSLT99  RETURN
+
.------------------------------------------------------------
. Contract ID Codes : Display,Add,Update,Delete
.------------------------------------------------------------
PMSCID00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      PMSCID40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      PMSCID10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      PMSCID20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      PMSCID30 IF EQUAL
.
          MATCH     "S",UPDTTYPE    * Keyword Search
          GOTO      PMSCID50 IF EQUAL
.
          GOTO      PMSCID93
.
.         ************ ADD FORMACTION ***********
.
PMSCID10  PACK      KEY6,PMCID001,SP70
          CALL      RDPMCID1
          COMPARE   ONE,OVRCD
          GOTO      PMSCID92 IF NOT EQUAL
.
          CALL      CLPCTR00      * Clear all the file variables
          CALL      MVPCTR00      * Moves input variables to file variables
.
          PACK      PMCICDAT,CCC,CYY,CMM,CDD
          REP       " 0",PMCICDAT
          CLOCK     TIME,PMCICTIM
          MOVE      USERID,PMCICUID
.
          CALL      WRPMCID1       * Writes away the data
          PROC      PMSCKIUP       * Contract ID keyword
.
. Adjust end date of previous contract based on start date of new contract
.
          MATCH     SP70,OLDCONTR
          IF        !@EQUAL
            MOVE      PMCID002,CIDEDATE     * effective from date (new Contract)
            SUB       ONE,CIDEDATE
            PACK      KEY6,OLDCONTR,SP70
            CALL      RDPMCID1
            IF        OVRCD<>1
              MOVE      CIDEDATE,PMCITDAT   * effective to date (old Contract)
              PACK      PMCIUDAT,CCC,CYY,CMM,CDD
              REP       " 0",PMCIUDAT
              CLOCK     TIME,PMCIUTIM
              MOVE      USERID,PMCIUUID
              CALL      UPPMCID1      * Writes away the data
            ENDIF
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      PMSCID99
.
.         ************ UPDATE FORMACTION **********
.
PMSCID20  PACK      KEY6,PMCID001,SP70
          CALL      RDPMCID1
          BRANCH    OVRCD,PMSCID91
.
          CALL      MVPCTR00      * Moves input variables to file variables
          MATCH     "1",PMCIDELE
          IF        @EQUAL
            CALL      CCID0000              * Check if Contract id is in use
            BRANCH    EXIT,PMSCID94
          ENDIF
.
          PACK      PMCIUDAT,CCC,CYY,CMM,CDD
          REP       " 0",PMCIUDAT 
          CLOCK     TIME,PMCIUTIM
          MOVE      USERID,PMCIUUID
.
          CALL      UPPMCID1      * Writes away the data
          MATCH     "1",PMCIDELE
          IF        @EQUAL
            CALL      ACID0000              * Write audit
          ENDIF
          PROC      PMSCKIUP      * practice keyword
.
          MOVE      ZERO,EXIT
          GOTO      PMSCID99
.
.         ************ DELETE FORMACTION **********
.
PMSCID30  PACK      KEY6,PMCID001,SP70
          CALL      RDPMCID1
          BRANCH    OVRCD,PMSCID91
.
          MOVE      "1",PMCIDELE            * set deleted flag=Yes
          PACK      PMCIUDAT,CCC,CYY,CMM,CDD
          REP       " 0",PMCIUDAT
          CLOCK     TIME,PMCIUTIM
          MOVE      USERID,PMCIUUID
.
          CALL      UPPMCID1                * Writes away the data
          MATCH     "1",PMCIDELE
          IF        @EQUAL
            CALL      ACID0000              * Write audit
          ENDIF
.
.>>>>     CALL      DEPMCID1
.>>>>     PROC      PMSCKIUP      * practice keyword
.
          MOVE      ZERO,EXIT
          GOTO      PMSCID99
.
.         ************ DISPLAY FORMACTION **********
.
PMSCID40  PACK      KEY6,PMCID001,SP70
          CALL      RDPMCID1
          IF        OVRCD=1
            CALL      CLPCTR00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Contract ID Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PMSCID99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      PMSCID99
.
PMSCID50  PACK      REDIRECT,REDIRECT,SP70
          STRIP     REDIRECT
          ENDSET    REDIRECT
          APPEND    "&keywords=",REDIRECT
          APPEND    KEYWORDS,REDIRECT
          APPEND    "&cidsdate=",REDIRECT
.
          MOVE      SP70,DIM11
          MATCH     CIDSDATE,SP70           * Effective To Date
          IF        !@EQUAL & !@EOS
            UNPACK    CIDSDATE,CCENT,CYEAR,CMON,CDAY
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
            PACK      DIM11,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          ENDIF
.
          APPEND    DIM11,REDIRECT
          RESET     REDIRECT 
.
          MOVE      ZERO,EXIT
          GOTO      PMSCID99
.
PMSCID91  MOVE      "Contract ID does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PMSCID99
.
PMSCID92  MOVE      "Contract ID exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PMSCID99
.
PMSCID93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PMSCID99
.
PMSCID94  MOVE      "Contract ID is in use and cannot be inactivated.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PMSCID99
.
PMSCID99  RETURN
+
.------------------------------------------------------------
. Clear Contract ID Table
.------------------------------------------------------------
CLPCTR00  MOVE      SP70,PMCICNTR
          MOVE      SP70,PMCIFDAT
          MOVE      SP70,PMCITDAT
          MOVE      SP70,PMCIDESC
          MOVE      SP70,PMCIDELE
          MOVE      SP70,PMCICUID
          MOVE      SP70,PMCICDAT
          MOVE      SP70,PMCICTIM
          MOVE      SP70,PMCIUUID
          MOVE      SP70,PMCIUDAT
          MOVE      SP70,PMCIUTIM
          MOVE      SP70,PMCIPINV
          MOVE      SP70,PMCICLDT
          MOVE      SP70,PMCISPAR
CLPCTR99  RETURN
+
.------------------------------------------------------------
. Move Contract ID cgis into file vars
.------------------------------------------------------------
MVPCTR00  MATCH     PMCID001,Z70
          IF        !@EQUAL
            MOVE      PMCID001,PMCICNTR
          ENDIF
.
          MATCH     PMCID002,Z70
          IF        !@EQUAL
            MOVE      PMCID002,PMCIFDAT
          ENDIF
.
          MATCH     PMCID003,Z70
          IF        !@EQUAL
            MOVE      PMCID003,PMCITDAT
          ENDIF
.
          MATCH     PMCID004,Z70
          IF        !@EQUAL
            MOVE      PMCID004,PMCIDESC
          ENDIF
.
          MATCH     PMCID005,Z70
          IF        !@EQUAL
            MOVE      PMCID005,PMCIDELE
          ENDIF
.
          MATCH     PMCID006,Z70
          IF        !@EQUAL
            MOVE      PMCID006,PMCIPINV
          ENDIF
.
          MATCH     PMCID007,Z70
          IF        !@EQUAL
            MOVE      PMCID007,PMCICLDT
          ENDIF
.
MVPCTR99  RETURN
+
.-------------------------------------------------------------
. Report 26: Contract ID  Maintenance tags
.-------------------------------------------------------------
PMCI0000  BRANCH    FLDITMNO,PMCI0100,PMCI0200,PMCI0300,PMCI0400,PMCI0500:
                             PMCI0600,PMCI0700,PMCI0800,PMCI0900,PMCI1000:
                             PMCI1100,PMCI1200,PMCI1300,PMCI1400
          GOTO      PMCI9999
.
PMCI0100  MOVE      ZERO,LNK2PRT * Table of Contract IDs
          CALL      CIDTB000
          GOTO      PMCI9999
.
PMCI0200  CALL      NEXTGR00     * Link to Next Set of Codes
          GOTO      PMCI9999
.
PMCI0300  CALL      PREVGR00     * Link to Prev Set of Codes
          GOTO      PMCI9999
.
PMCI0400  WRITE     HTMLFILE;KEYWORDS;
          GOTO      PMCI9999
.
PMCI0500  MOVE      TWO,LNK2PRT  * Link to Window
          CALL      CDSRH000     * Search Table of Contract IDs by keyword
          GOTO      PMCI9999
.
PMCI0600  WRITE     HTMLFILE;PMCICNTR;      * Contract ID
          GOTO      PMCI9999
.
PMCI0700  WRITE     HTMLFILE;PMCIDESC;      * Contract ID Description
          GOTO      PMCI9999
.
PMCI0800  MATCH     PMCIFDAT,SP70           * Effective From Date
          GOTO      PMCI9999 IF EQUAL
          UNPACK    PMCIFDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMCI9999
.
PMCI0900  MATCH     PMCITDAT,SP70           * Effective To Date
          GOTO      PMCI9999 IF EQUAL
          UNPACK    PMCITDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMCI9999
.
PMCI1000  MATCH     CIDSDATE,SP70           * Effective To Date
          GOTO      PMCI9999 IF EQUAL
          UNPACK    CIDSDATE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMCI9999
.
PMCI1100  MOVE      ZERO,LNK2PRT
          CALL      CDSRH000
          GOTO      PMCI9999
.
PMCI1200  WRITE     HTMLFILE;PMCIDELE;      * Contract ID Active? (1=No)
          GOTO      PMCI9999
.
PMCI1300  WRITE     HTMLFILE;PMCIPINV;      * Using Patient Portion Inv.?(1=Yes)
          GOTO      PMCI9999
.
PMCI1400  MATCH     PMCICLDT,SP70           * Close Off Date     
          GOTO      PMCI9999 IF EQUAL
          UNPACK    PMCICLDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PMCI9999
.
PMCI9999  RETURN
+
.------------------------------------------------------------
. Table of Contract IDs
.------------------------------------------------------------
CIDTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.         
          CALL      CIDHD000              * Output Table Heading
.         
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF     
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY6,STARTKEY,SP70
          CALL      RSPMCID1
          IF        OVRCD=0
            CALL      RPPMCID1
          ENDIF
CIDTB100  CALL      RKPMCID1
          BRANCH    OVRCD,CIDTB900
.
.>>>>     MATCH     "1",PMCIDELE
.>>>>     GOTO      CIDTB100 IF EQUAL     * don't display inactive records
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      CIDTB100
          ENDIF
.
          CALL      CIDRW000              * Contract ID Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      CIDTB100 IF NOT EQUAL
          GOTO      CIDTB999
.
CIDTB900  CALL      NOMORE00            * Display No More Records Message
.
CIDTB999  RETURN
.------------------------------------------------------------
. Contract IDs (TABLE HEADING)
.------------------------------------------------------------
CIDHD000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell width=15%>":
                               "Contract ID</td>":
                               "<td class=HeadingCell>":
                               "Description</td>":
                               "<td class=HeadingCell>":
                               "Effective From Date</td>":
                               "<td class=HeadingCell>":
                               "Effective To Date</td>":
                               "<td class=HeadingCell>":
                               "Active</td>":
                             "</tr>"
.
CIDHD999  RETURN
.------------------------------------------------------------
. Contract IDs (TABLE ROW)
.------------------------------------------------------------
CIDRW000  MOVE      SP70,DISPDAT1
          MATCH     SP70,PMCIFDAT
          IF        !@EQUAL
            UNPACK    PMCIFDAT,CCENT,CYEAR,CMON,CDAY
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
            PACK      DISPDAT1,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          ENDIF     
.
          MOVE      SP70,DISPDAT2
          MATCH     SP70,PMCITDAT
          IF        !@EQUAL
            UNPACK    PMCITDAT,CCENT,CYEAR,CMON,CDAY
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
            PACK      DISPDAT2,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          ENDIF     
.
          MOVE      "Yes",DIM3
          MATCH     "1",PMCIDELE
          IF        @EQUAL
            MOVE      "No ",DIM3         * inactive contract
          ENDIF
.
          CALL      JAVCID00             * format Contract desc for javascript
          BRANCH    LNK2PRT,CIDRW100,CIDRW200
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail26":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pmcid001=",PMCICNTR,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             PMCICNTR,"</td>":
                             "<td>&nbsp;",PMCIDESC,"</td>":
                             "<td>&nbsp;",DISPDAT1,"</td>":
                             "<td>&nbsp;",DISPDAT2,"</td>":
                             "<td>&nbsp;",DIM3,"</td>":
                             "</tr>"
.
          GOTO      CIDRW999
.
CIDRW100  WRITE     HTMLFILE;"<tr valign=#"top#">":
                             "<td><a href=#"":
                             "javascript:updateParent26('",JAVCDESC:
                             "','",PMCICNTR,"')#">":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             PMCICNTR,"</td>":
                             "<td>&nbsp;",DISPDAT1,"</td>":
                             "<td>&nbsp;",DISPDAT2,"</td>":
                             "<td>&nbsp;",DIM3,"</td>":
                             "</tr>"
          GOTO      CIDRW999
.
CIDRW200  WRITE     HTMLFILE;"<tr valign=#"top#">":
                             "<td><a href=#"":
                             "javascript:updateParent2626('",JAVCDESC:
                             "','",PMCICNTR,"')#">":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             PMCICNTR,"</td>":
                             "<td>&nbsp;",DISPDAT1,"</td>":
                             "<td>&nbsp;",DISPDAT2,"</td>":
                             "<td>&nbsp;",DIM3,"</td>":
                             "</tr>"
          GOTO      CIDRW999
.
CIDRW999 RETURN
+
.-------------------------------------------------------------------
. Format Contract ID Desc (for Javascript) by changing any ' to %60
.-------------------------------------------------------------------
JAVCID00  PACK      JAVCDESC,SP70,SP70
.
          MOVE      PMCIDESC,JAVCDESC
          SCAN      "'",JAVCDESC             * find any apostrophies
          GOTO      JAVCID99 IF NOT EQUAL
.
          MOVE      JAVCDESC,CIDEDESC 
          REP       "' ",CIDEDESC            * remove the apostrophy
.
          LENSET    JAVCDESC   
          RESET     JAVCDESC                 * get all characters before '
          MOVE      JAVCDESC,CIDSDESC
.
          REP       "'%",CIDSDESC
          STRIP     CIDSDESC
          PACK      JAVCDESC,CIDSDESC,SIXTY,CIDEDESC,SP70 * formatted desc
.
JAVCID99  RETURN
+
.------------------------------------------------------------
. Search Table of Contract IDs by Keyword
.------------------------------------------------------------
CDSRH000  CALL      CDSHD000      * Output Table Heading
.
          IF        LNK2PRT=1
            UNPACK    DIM127,D1,LINKPRG,DIM127
            UNPACK    DIM127,D1,LINKREP,DIM127
            UNPACK    DIM127,D1,LINKTEM,DIM127
          ENDIF
.
          IF        LNK2PRT=2
            UNPACK    DIM127,D1,LINKPRG,DIM127
            UNPACK    DIM127,D1,LINKREP,DIM127
            UNPACK    DIM127,D1,LINKTEM,DIM127
          ENDIF
.
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
.
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
          MOVE      ZERO,CIDAREND         * Number of contract ids in CIDARRAY[]
.
          CALL      GETWRD00
          MATCH     SP70,KEYWRD01
          IF        @EQUAL
            MOVE      CIDSDATE,KEYWRD01   * use effective date if no keyword
          ENDIF
.
          STRIP     KEYWRD01
          PACK      KEY21,KEYWRD01,SP70
          CALL      RSPMCKI2
.
CDSRH100  CALL      RKPMCKI2
          BRANCH    OVRCD,CDSRH900
.
          PACK      KEY6,PMCKCNTR,SP70
          CALL      RDPMCID1                * read contract id table
          BRANCH    OVRCD,CDSRH100
.
          MATCH     "1",PMCIDELE            * only return active contract IDs
          GOTO      CDSRH100 IF EQUAL
.
          CALL      PMSPKB00
          BRANCH    EXIT,CDSRH100,CDSRH900
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      CDSRH100
          ENDIF
.
          CALL      CDSRW000                * Contract ID Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          IF        !@EQUAL
            GOTO      CDSRH100
          ENDIF
          GOTO      CDSRH999
.
CDSRH900  CALL      NOMORE00           * Display No More Records Message
.
CDSRH999  RETURN
.------------------------------------------------------------
. Contract IDs (TABLE HEADING)
.------------------------------------------------------------
CDSHD000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell>":
                               "Contract ID</td>":
                               "<td class=HeadingCell>":
                               "Effective From Date</td>":
                               "<td class=HeadingCell>":
                               "Effective To Date</td>":
                             "</tr>"
.
CDSHD999  RETURN
.------------------------------------------------------------
. Contract IDs (TABLE ROW)
.------------------------------------------------------------
CDSRW000  MOVE      SP70,DISPDAT1
          MATCH     SP70,PMCIFDAT
          IF        !@EQUAL
            UNPACK    PMCIFDAT,CCENT,CYEAR,CMON,CDAY
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
            PACK      DISPDAT1,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          ENDIF
.
          MOVE      SP70,DISPDAT2
          MATCH     SP70,PMCITDAT
          IF        !@EQUAL
            UNPACK    PMCITDAT,CCENT,CYEAR,CMON,CDAY
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
            PACK      DISPDAT2,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR
          ENDIF
.
          CALL      JAVCID00             * format Contract desc for javascript
.
          BRANCH    LNK2PRT,CDSRW200,CDSRW300
.
CDSRW100  WRITE     HTMLFILE;"<tr valign=#"top#">":
                             "<td><a href=#"":
                             "javascript:updateParent('",PMCICNTR:
                             "','",JAVCDESC,"')#">":
                             PMCIDESC:
                             "<br>(",PMCICNTR,")</a></td>":
                             "<td>&nbsp;",DISPDAT1,"</td>":
                             "<td>&nbsp;",DISPDAT2,"</td>":
                             "</tr>"
          GOTO      CDSRW999
.
CDSRW200  WRITE     HTMLFILE;"<tr valign=#"top#">":
                             "<td nowrap><a href=#"":
                             "javascript:ShowCIDDetails26('":
                              LINKPRG,".pbl?":
                             "&reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pmcid001=",PMCICNTR:
                             "');#">":
                             PMCIDESC:
                             "<br>(",PMCICNTR,")</a></td>":
                             "<td>&nbsp;",DISPDAT1,"</td>":
                             "<td>&nbsp;",DISPDAT2,"</td>":
                             "</tr>"
          GOTO      CDSRW999
.
CDSRW300  WRITE     HTMLFILE;"<tr valign=#"top#">":
                             "<td nowrap><a href=#"":
                             "javascript:UpdateCID26('":
                              LINKPRG,".pbl?":
                             "&reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pmcid001=",PMCICNTR:
                             "');#">":
                             PMCIDESC:
                             "<br>(",PMCICNTR,")</a></td>":
                             "<td>&nbsp;",DISPDAT1,"</td>":
                             "<td>&nbsp;",DISPDAT2,"</td>":
                             "</tr>"
          GOTO      CDSRW999
.
CDSRW999 RETURN
+
.------------------------------------------------------------
. Check Contract ID Record
.------------------------------------------------------------
PMSPKB00  MATCH     KEYWRD01,PMCKKKWD
          GOTO      PMSPKB92 IF NOT EQUAL
          IF        KEYWRDNO>1
            PACK      SAVKEY21,PMCKKKWD,PMCKCNTR
            CALL      PMSPKC00
            BRANCH    EXIT,PMSPKB91
            MOVE      SAVKEY21,KEY21
            CALL      RDPMCKI2
          ENDIF
.
. CIDSDATE - Show Active Contract IDs Only (match effective from date)
.
          MATCH     SP70,CIDSDATE
          GOTO      PMSPKB90 IF EQUAL
.
          MATCH     PMCIFDAT,CIDSDATE
          GOTO      PMSPKB91 IF NOT EQUAL
.
.>>>>     MATCH     CIDSDATE,PMCITDAT
.>>>>     GOTO      PMSPKB91 IF LESS
.
PMSPKB90  CALL      CCON0000                * Check if contract id has been
          BRANCH    EXIT,PMSPKB91           * displayed before
.
          MOVE      ZERO,EXIT
          GOTO      PMSPKB99
.
PMSPKB91  MOVE      ONE,EXIT
          GOTO      PMSPKB99
.
PMSPKB92  MOVE      TWO,EXIT
.
PMSPKB99  RETURN
+
.------------------------------------------------------------
. Check if this contract id has already been output in the search
.------------------------------------------------------------
CCON0000  MOVE       ZERO,F3
          MOVE       ZERO,EXIT
.
CCON1000  ADD        ONE,F3
          IF         F3>CIDAREND
            IF         F3>200
              GOTO       CCON9999
            ENDIF
            MOVE       F3,CIDAREND
            MOVE       PMCICNTR,CIDARRAY[F3]
            GOTO       CCON9999
          ENDIF
.
          MATCH      PMCICNTR,CIDARRAY[F3]
          GOTO       CCON1000 IF NOT EQUAL
.
          MOVE       ONE,EXIT
.
CCON9999  RETURN
+
.------------------------------------------------------------
. Check for Matching Words (Contract ID keyword table)
.------------------------------------------------------------
PMSPKC00  MOVE      ONE,F2
          MOVE      ZERO,EXIT
          PACK      SAVKEY6,PMCKCNTR,SP70
.
PMSPKC10  COMPARE   KEYWRDNO,F2           * Loop through each Key Word in Search
          GOTO      PMSPKC99 IF EQUAL     * Exit OK
          ADD       ONE,F2
          LOAD      KEYWRDXX,F2,KEYWRD01,KEYWRD02,KEYWRD03,KEYWRD04,KEYWRD05:
                                KEYWRD06,KEYWRD07,KEYWRD08,KEYWRD09,KEYWRD10
          PACK      KEY21,PMCICNTR,KEYWRDXX
          CALL      RDPMCKI1              * Check for Exact Match
          COMPARE   ZERO,OVRCD            * Ok so Continue Loop
          GOTO      PMSPKC10 IF EQUAL
.
          CALL      RKPMCKI1              * Not Exact so Read Next Record
          BRANCH    OVRCD,PMSPKC90        * No Match So Exit No Match
          PACK      KEY6,PMCKCNTR,SP70
          MATCH     SAVKEY6,KEY6          * Match Key Fields
          GOTO      PMSPKC90 IF NOT EQUAL * No Match So Exit
          STRIP     KEYWRDXX
          MATCH     PMCKCNTR,KEYWRDXX     * Check Key Word
          GOTO      PMSPKC90 IF NOT EQUAL * No Match So Exit
          GOTO      PMSPKC10              * Check Next Search Word
.
PMSPKC90  MOVE      ONE,EXIT
.
PMSPKC99  RETURN
+
.------------------------------------------------------------
. Check that Contract ID does not exist in other tables
.------------------------------------------------------------
CCID0000  PACK      KEY27,PMCICNTR,SP70
          CALL      RSPTLSD1
          CALL      RKPTLSD1
          BRANCH    OVRCD,CCID0100
.
          MATCH     PMCICNTR,PTLSCNID
          GOTO      CCID9500 IF EQUAL            * contract ID exists
.
CCID0100  PACK      KEY30,PMCICNTR,SP70
          CALL      RSPTASD1
          CALL      RKPTASD1
          BRANCH    OVRCD,CCID0200
.
          MATCH     PMCICNTR,PTADCNID
          GOTO      CCID9500 IF EQUAL            * contract ID exists
.
CCID0200  PACK      KEY27,PMCICNTR,SP70
          CALL      RSPTHLF1
          CALL      RKPTHLF1
          BRANCH    OVRCD,CCID0300
.
          MATCH     PMCICNTR,PTHLCNID
          GOTO      CCID9500 IF EQUAL            * contract ID exists
.
CCID0300  PACK      KEY31,PMCICNTR,SP70
          CALL      RSPTLDF1
          CALL      RKPTLDF1
          BRANCH    OVRCD,CCID0400
.
          MATCH     PMCICNTR,PTLDCNID
          GOTO      CCID9500 IF EQUAL            * contract ID exists
.
CCID0400  PACK      KEY31,PMCICNTR,SP70
          CALL      RSPTHDF1
          CALL      RKPTHDF1
          BRANCH    OVRCD,CCID0500
.
          MATCH     PMCICNTR,PTHDCNID
          GOTO      CCID9500 IF EQUAL            * contract ID exists
.
CCID0500  PACK      KEY34,PMCICNTR,SP70
          CALL      RSPTAFE1
          CALL      RKPTAFE1
          BRANCH    OVRCD,CCID9000
.
          MATCH     PMCICNTR,PTFECNID
          GOTO      CCID9500 IF EQUAL            * contract ID exists
.
CCID9000  MOVE      ZERO,EXIT                    * contract ID doesn't exist
          GOTO      CCID9999
.
CCID9500  MOVE      ONE,EXIT                     * contract ID exists
CCID9999  RETURN
+
.------------------------------------------------------------
. Write audit for inactivating pmscidaf record
.------------------------------------------------------------
ACID0000  MOVE      "pmscidaf",PMDCFILE
          MOVE      PMCICNTR,PMDCCONT
          PACK      PMDCRKEY,PMCICNTR,SP70
.         
          MOVE      USERID,PMDCDUID
          PACK      PMDCDDAT,CCC,CYY,CMM,CDD
          REP       " 0",PMDCDDAT
          CLOCK     TIME,PMDCDTIM
          MOVE      SP70,PMDCSPAR
.
          MOVE      ZERO,F3
.
ACID1000  ADD       ONE,F3
          MOVE      F3,PMDCUNIQ
.
          PACK      KEY27,PMDCFILE,PMDCDDAT,PMDCDTIM,PMDCUNIQ,SP70
          CALL      RAPMDCA1
          IF        OVRCD=1
            CALL      WRPMDCA1
          ELSE
            GOTO      ACID1000
          ENDIF
.
ACID9999  RETURN
+
.----------------------------------------------------------------
. Divisions maintenance report 27
.----------------------------------------------------------------
PMSDIV00  RESET     UPDTTYPE
          MATCH     SP70,UPDTTYPE
          GOTO      PMSDIV40 IF EQUAL       * Display
.
          MATCH     "A",UPDTTYPE            * Add
          GOTO      PMSDIV10 IF EQUAL
.
          MATCH     "U",UPDTTYPE            * Update
          GOTO      PMSDIV20 IF EQUAL
.
          MATCH     "D",UPDTTYPE            * Delete
          GOTO      PMSDIV30 IF EQUAL
.
          GOTO      PMSDIV93

.          ************ ADD FORMACTION ***********
.
PMSDIV10  PACK      KEY14,PMDIV001,PMDIV002,PMDIV003,PMDIV004,SP70
          CALL      RDPMDIV1
          COMPARE   ZERO,OVRCD
          GOTO      PMSDIV91 IF EQUAL       * if record exists error
.
          CALL      CHKUN000                * check if unit exists against hosp
          BRANCH    EXIT,PMSDIV92           * if record exists error
.
          CALL      CLPMDI00                * Clear file variables
          CALL      MVPMDI00                * get the cgi parameters
.
          CALL      IBACLOCK
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          MOVE      CURRDATE,PMDICDAT       * date record created
          MOVE      CTIMEIS,PMDICTIM        * time record created
          MOVE      USERID,PMDICUID         * web user created
.
          PACK      KEY14,PMDIHOSP,PMDIDIVN,PMDIUNIT,PMDITEAM,SP70
          CALL      RAPMDIV1
          IF        OVRCD=1
            CALL      WRPMDIV1              * write a record
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      PMSDIV99
.
.          ************ UPDATE FORMACTION **********
.
PMSDIV20  PACK      KEY14,PMDIV001,PMDIV002,PMDIV003,PMDIV004,SP70
          CALL      RDPMDIV1
          BRANCH    OVRCD,PMSDIV90          * error if record not found
.
          CALL      MVPMDI00                * get the cgi parameters
.
          CALL      IBACLOCK
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          MOVE      CURRDATE,PMDIUDAT       * date record updated
          MOVE      CTIMEIS,PMDIUTIM        * time record updated
          MOVE      USERID,PMDIUUID         * web user updated
.
          CALL      UPPMDIV1                * update the record
.
          MOVE      ZERO,EXIT
          GOTO      PMSDIV99
.
.          ************ DELETE FORMACTION **********
.
PMSDIV30  PACK      KEY14,PMDIV001,PMDIV002,PMDIV003,PMDIV004,SP70
          CALL      RDPMDIV1
          BRANCH    OVRCD,PMSDIV90          * error if record not found
.
          PACK      KEY14,PMDIHOSP,PMDIDIVN,PMDIUNIT,PMDITEAM,SP70
          CALL      DEPMDIV1               * delete the record
.
          MOVE      ZERO,EXIT
          GOTO      PMSDIV99
.
.          ************ DISPLAY FORMACTION **********
.
PMSDIV40  PACK      KEY3,PTHSP001,SP70
          CALL      RDPTHSP1      
          IF        OVRCD=1                            
            CALL      CLPATHSP             * Clear file variables     *C-251645
          ENDIF
.
          PACK      KEY14,PTHSP001,PMDIV002,PMDIV003,PMDIV004,SP70
          CALL      RDPMDIV1
          IF        OVRCD=1
            CALL      CLPMDI00             * Clear file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Divisions Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PMSDIV99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      PMSDIV99
.
.         *********** ERROR CONDITIONS ***************
.
PMSDIV90  MOVE      "Code does not exist.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PMSDIV99
.
PMSDIV91  MOVE      "Code already exists.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PMSDIV99
.
PMSDIV92  MOVE      "Unit already exists for this hospital.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PMSDIV99
.
PMSDIV93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PMSDIV99
.
PMSDIV99  RETURN
+
.------------------------------------------------------------------------
. Each unit can only exist against one division in the hospital.
. Check if unit (pmdiv003) already exists against the hospital (pmdiv001)
.------------------------------------------------------------------------
CHKUN000  PACK      KEY14,PMDIV001,PMDIV003,SP70
          CALL      RSPMDIV2
CHKUN100  CALL      RKPMDIV2                * check if unit exists against hosp
          BRANCH    OVRCD,CHKUN900
.
          MATCH     SP70,PMDIV003
          GOTO      CHKUN900 IF EQUAL       * adding division with no unit is ok
.
          MATCH     SP70,PMDIV004
          GOTO      CHKUN900 IF NOT EQUAL   * adding team to existing unit is ok
.
          MATCH     PMDIV001,PMDIHOSP
          GOTO      CHKUN900 IF NOT EQUAL   * hospital record doesn't exist
.
          MATCH     PMDIV003,PMDIUNIT
.         GOTO      CHKUN950 IF EQUAL       * hospital/unit combo already exists
          IF        @EQUAL
            MATCH     "0",PMDIACTV
            GOTO      CHKUN950 IF EQUAL
          ENDIF
.
          GOTO      CHKUN100
.
CHKUN900  MOVE      ZERO,EXIT               * allow record to be added
          GOTO      CHKUN999
.
CHKUN950  MOVE      ONE,EXIT                * don't allow record to be added
CHKUN999  RETURN
+
.-------------------------------------------------------------
. General Table Tags
.-------------------------------------------------------------
TABL0000  BRANCH    FLDITMNO,TABL0100,TABL0200,TABL0300,TABL0400,TABL0500:
                             TABL0600,TABL0700,TABL0800,TABL0900,TABL1000:
                             TABL1100,TABL1200,TABL1300
          GOTO      TABL9999
.
TABL0100  CALL      LNKDI000      * Table of Hospital Linked Divisions
          GOTO      TABL9999
.
TABL0200  CALL      NEXTDV00      * Link to Next Set of Divisions / HPI-O
          GOTO      TABL9999
.
TABL0300  CALL      PREVDV00      * Link to Prev Set of Divisions / HPI-O
          GOTO      TABL9999
.
TABL0400  PACK      SAVKEY14,PMDIHOSP,PMDIDIVN,PMDIUNIT,PMDITEAM
.
          PACK      KEY14,PTHSP001,PMDIV002,SP70
          CALL      RSPMDIV1
          CALL      RKPMDIV1                * Does hosp/div have units?
          BRANCH    OVRCD,TABL0410
.
          MATCH     PTHSP001,PMDIHOSP       * Same hosp?
          GOTO      TABL0410 IF NOT EQUAL
.
          MATCH     PMDIV002,PMDIDIVN       * Same div?
          GOTO      TABL0410 IF NOT EQUAL
.
          WRITE     HTMLFILE;ONE;           * units exist
.
          MOVE      SAVKEY14,KEY14
          CALL      RDPMDIV1
.
          GOTO      TABL9999
.
TABL0410  WRITE     HTMLFILE;ZERO;          * no units exist
.
          MOVE      SAVKEY14,KEY14
          CALL      RDPMDIV1
.
          GOTO      TABL9999
.
TABL0500  CALL      LNKUN000      * Table of Division Linked Units
          GOTO      TABL9999
.
TABL0600  WRITE     HTMLFILE;PMDIV002;      * Division
          GOTO      TABL9999
.
TABL0700  PACK      SAVKEY14,PMDIHOSP,PMDIDIVN,PMDIUNIT,PMDITEAM
.
          PACK      KEY14,PTHSP001,PMDIV002,PMDIV003,SP70
          CALL      RSPMDIV1
          CALL      RKPMDIV1                * Does hosp/div/unit have teams?
          BRANCH    OVRCD,TABL0710
.
          MATCH     PTHSP001,PMDIHOSP       * Same hosp?
          GOTO      TABL0710 IF NOT EQUAL
.
          MATCH     PMDIV002,PMDIDIVN       * Same div?
          GOTO      TABL0710 IF NOT EQUAL
.
          MATCH     PMDIV003,PMDIUNIT       * Same unit?
          GOTO      TABL0710 IF NOT EQUAL
.
          WRITE     HTMLFILE;ONE;           * teams exist
.
          MOVE      SAVKEY14,KEY14
          CALL      RDPMDIV1
.
          GOTO      TABL9999
.
TABL0710  WRITE     HTMLFILE;ZERO;          * no teams exist
.
          MOVE      SAVKEY14,KEY14
          CALL      RDPMDIV1
.
          GOTO      TABL9999
.
TABL0800  CALL      LNKTE000      * Table of Unit Linked Teams
          GOTO      TABL9999
.
TABL0900  UNPACK    DIM127,DIM1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          PACK      KEY5,PMDITEAM,SP70
          CALL      RDPMTEM1
          IF        OVRCD=1
            MOVE      SP70,PMTMTEAM
            MOVE      SP70,PMTMDESC
          ENDIF
          BRANCH    F1,TABL0910,TABL0920
          WRITE     HTMLFILE;PMTMDESC;      * team description
          GOTO      TABL9999
.
TABL0910  WRITE     HTMLFILE;PMTMTEAM;      * team code
          GOTO      TABL9999
.
TABL0920  PACK      KEY5,SP70               * team selection list
          CALL      RSPMTEM1
TABL0925  CALL      RKPMTEM1
          BRANCH    OVRCD,TABL9999
.
          MATCH     "1",PMTMACTV
          GOTO      TABL0925 IF EQUAL
.
          PACK      KEY7,QUOTE,PMTMTEAM,QUOTE
          WRITE     HTMLFILE;"<option value=",KEY7,">",PMTMDESC,"</option>"
          GOTO      TABL0925
.
TABL1000  WRITE     HTMLFILE;PMDIV003;      * Unit
          GOTO      TABL9999
.
TABL1100  PACK      SAVKEY14,PMDIHOSP,PMDIDIVN,PMDIUNIT,PMDITEAM
.
          PACK      KEY14,PTHSP001,PMDIV002,PMDIV003,SP70
          CALL      RSPMDIV1
TABL1105  CALL      RKPMDIV1                * Does hosp/div/unit have teams?
          BRANCH    OVRCD,TABL1110
.
          MATCH     PTHSP001,PMDIHOSP       * Same hosp?
          GOTO      TABL1110 IF NOT EQUAL
.
          MATCH     PMDIV002,PMDIDIVN       * Same div?
          GOTO      TABL1110 IF NOT EQUAL
.
          MATCH     PMDIV003,PMDIUNIT       * Same unit?
          GOTO      TABL1110 IF NOT EQUAL
.
          MATCH     "1",PMDIACTV            * Inactive go to next team
          GOTO      TABL1105 IF EQUAL
.
          WRITE     HTMLFILE;ONE;           * teams exist
.
          MOVE      SAVKEY14,KEY14
          CALL      RDPMDIV1
.
          GOTO      TABL9999
.
TABL1110  WRITE     HTMLFILE;ZERO;          * no teams exist
.
          MOVE      SAVKEY14,KEY14
          CALL      RDPMDIV1
.
          GOTO      TABL9999
.
TABL1200  PACK      SAVKEY14,PMDIHOSP,PMDIDIVN,PMDIUNIT,PMDITEAM
.
          PACK      KEY14,PTHSP001,PMDIV002,SP70
          CALL      RSPMDIV1
TABL1205  CALL      RKPMDIV1                * Does hosp/div have units?
          BRANCH    OVRCD,TABL1210
.
          MATCH     PTHSP001,PMDIHOSP       * Same hosp?
          GOTO      TABL1210 IF NOT EQUAL
.
          MATCH     PMDIV002,PMDIDIVN       * Same div?
          GOTO      TABL1210 IF NOT EQUAL
.
          MATCH     "1",PMDIACTV            * Inactive go to next team
          GOTO      TABL1205 IF EQUAL
.
          WRITE     HTMLFILE;ONE;           * units exist
.
          MOVE      SAVKEY14,KEY14
          CALL      RDPMDIV1
.
          GOTO      TABL9999
.
TABL1210  WRITE     HTMLFILE;ZERO;          * no units exist
.
          MOVE      SAVKEY14,KEY14
          CALL      RDPMDIV1
.
          GOTO      TABL9999
.
TABL1300  CALL      HPIOT000      * Table of Hospital Linked Divisions
          GOTO      TABL9999
.
TABL9999  RETURN
+
.------------------------------------------------------------
. Table of Hospital Linked Divisions
.------------------------------------------------------------
LNKDI000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.         
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY14,PTHSP001,SP70
          CALL      RSPMDIV1
.
LNKDI100  CALL      RKPMDIV1
          BRANCH    OVRCD,LNKDI900
.
          MATCH     PTHSP001,PMDIHOSP       * same hosp?
          GOTO      LNKDI900 IF NOT EQUAL
.
          MATCH     SP70,PMDIUNIT           * only want division headers
          GOTO      LNKDI100 IF NOT EQUAL
.
LNKDI500  ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      LNKDI100
          ENDIF
.
          CALL      LDIRW000      * Linked Divisions Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      LNKDI100 IF NOT EQUAL
          GOTO      LNKDI999
.
LNKDI900  CALL      NOMORE00       * Display No More Records Message
.
LNKDI999  RETURN
.
.------------------------------------------------------------
. Hospital Linked Divisions (TABLE ROW)
.------------------------------------------------------------
LDIRW000  MATCH     "1",PMDIACTV
          IF        @EQUAL
            MOVE      "No ",KEY3
          ELSE
            MOVE      "Yes",KEY3
          ENDIF
.
          MOVE      "dv",CATEGORY           * division category
          MOVE      PMDIDIVN,CODE
          CALL      GETCOD00
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail27":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pthsp001=",PMDIHOSP:
                             "&pmdiv002=",PMDIDIVN:
                             "&pmdiv003=",PMDIUNIT:
                             "&pmdiv004=",PMDITEAM,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             PMDIDIVN,"</td>":
                             "<td>&nbsp;",TDESC,"</td>":
                             "<td>&nbsp;",KEY3,"</td>";
          WRITE     HTMLFILE;"</tr>"
.
LDIRW999 RETURN
.
.-----------------------------------------------------------
. Link to Next Group of Divisions / HPI-O
.-----------------------------------------------------------
NEXTDV00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM+NORECORD,F3
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F2
          REP       " +",PTHSP001
          REP       " +",PMDIV002
          REP       " +",PMDIV003
          REP       " +",PMDIV004
.
          WRITE     HTMLFILE;"patweb88.pbl":
                                 "?reportno=",F2:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&pthsp001=",PTHSP001:
                                 "&pmdiv002=",PMDIV002:
                                 "&pmdiv003=",PMDIV003:
                                 "&pmdiv004=",PMDIV004;
          REP       "+ ",PTHSP001
          REP       "+ ",PMDIV002
          REP       "+ ",PMDIV003
          REP       "+ ",PMDIV004
.
NEXTDV99  RETURN
.-------------------------------------------------------------
. Link to Prev Group of Divisions HPI-O
.-------------------------------------------------------------
PREVDV00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM-NORECORD,F3
          IF        F3<0
            MOVE      ZERO,F3
          ENDIF
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F2
          REP       " +",PTHSP001
          REP       " +",PMDIV002
          REP       " +",PMDIV003
          REP       " +",PMDIV004
.
          WRITE     HTMLFILE;"patweb88.pbl":
                                 "?reportno=",F2:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&pthsp001=",PTHSP001:
                                 "&pmdiv002=",PMDIV002:
                                 "&pmdiv003=",PMDIV003:
                                 "&pmdiv004=",PMDIV004;
          REP       "+ ",PTHSP001
          REP       "+ ",PMDIV002
          REP       "+ ",PMDIV003
          REP       "+ ",PMDIV004
.
PREVDV99  RETURN
+
.------------------------------------------------------------
. Table of Division Linked Units
.------------------------------------------------------------
LNKUN000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.         
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY14,PTHSP001,PMDIV002,SP70
          CALL      RSPMDIV1
.
LNKUN100  CALL      RKPMDIV1
          BRANCH    OVRCD,LNKUN900
.
          MATCH     PTHSP001,PMDIHOSP       * same hosp?
          GOTO      LNKUN900 IF NOT EQUAL
.
          MATCH     PMDIV002,PMDIDIVN       * same division?
          GOTO      LNKUN900 IF NOT EQUAL
.
          MATCH     SP70,PMDITEAM           * only want unit headers
          GOTO      LNKUN100 IF NOT EQUAL
.
LNKUN500  ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      LNKUN100
          ENDIF
.
          CALL      LUNRW000      * Linked Units Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      LNKUN100 IF NOT EQUAL
          GOTO      LNKUN999
.
LNKUN900  CALL      NOMORE00      * Display No More Records Message
.
LNKUN999  RETURN
.
.------------------------------------------------------------
. Division Linked Units (TABLE ROW)
.------------------------------------------------------------
LUNRW000  MATCH     "1",PMDIACTV
          IF        @EQUAL
            MOVE      "No ",KEY3
          ELSE
            MOVE      "Yes",KEY3
          ENDIF
.
          MOVE      "AC",CATEGORY           * unit category
          MOVE      PMDIUNIT,CODE
          CALL      GETCOD00
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail27":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pthsp001=",PMDIHOSP:
                             "&pmdiv002=",PMDIDIVN:
                             "&pmdiv003=",PMDIUNIT:
                             "&pmdiv004=",PMDITEAM,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             PMDIUNIT,"</td>":
                             "<td>&nbsp;",TDESC,"</td>":
                             "<td>&nbsp;",KEY3,"</td>";
          WRITE     HTMLFILE;"</tr>"
.
LUNRW999 RETURN
+
.------------------------------------------------------------
. Table of Unit Linked Teams
.------------------------------------------------------------
LNKTE000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.         
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY14,PTHSP001,PMDIV002,PMDIV003,SP70
          CALL      RSPMDIV1
.
LNKTE100  CALL      RKPMDIV1
          BRANCH    OVRCD,LNKTE900
.
          MATCH     PTHSP001,PMDIHOSP
          GOTO      LNKTE900 IF NOT EQUAL
.
          MATCH     PMDIV002,PMDIDIVN
          GOTO      LNKTE900 IF NOT EQUAL
.
          MATCH     PMDIV003,PMDIUNIT
          GOTO      LNKTE900 IF NOT EQUAL
.
LNKTE500  ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      LNKTE100
          ENDIF
.
          CALL      LTERW000      * Linked Teams Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      LNKTE100 IF NOT EQUAL
          GOTO      LNKTE999
.
LNKTE900  CALL      NOMORE00      * Display No More Records Message
.
LNKTE999  RETURN
.
.------------------------------------------------------------
. Unit Linked Teams (TABLE ROW)
.------------------------------------------------------------
LTERW000  MATCH     "1",PMDIACTV
          IF        @EQUAL
            MOVE      "No ",KEY3
          ELSE
            MOVE      "Yes",KEY3
          ENDIF
.
          PACK      KEY5,PMDITEAM,SP70
          CALL      RDPMTEM1                * get team desc
          IF        OVRCD=1
            MOVE      SP70,PMTMDESC
          ENDIF
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail27":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pthsp001=",PMDIHOSP:
                             "&pmdiv002=",PMDIDIVN:
                             "&pmdiv003=",PMDIUNIT:
                             "&pmdiv004=",PMDITEAM,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             PMDITEAM,"</td>":
                             "<td>&nbsp;",PMTMDESC,"</td>":
                             "<td>&nbsp;",KEY3,"</td>";
          WRITE     HTMLFILE;"</tr>"
.
LTERW999 RETURN
+
.----------------------------------------------------------------
. Hospital Unit HPI-O  maintenance report 30
.----------------------------------------------------------------
PMSIHU00  RESET     UPDTTYPE
          MATCH     SP70,UPDTTYPE
          GOTO      PMSIHU40 IF EQUAL       * Display
.
          MATCH     "A",UPDTTYPE            * Add
          GOTO      PMSIHU10 IF EQUAL
.
          MATCH     "U",UPDTTYPE            * Update
          GOTO      PMSIHU20 IF EQUAL
.
          MATCH     "D",UPDTTYPE            * Delete
          GOTO      PMSIHU30 IF EQUAL
.
          GOTO      PMSIHU92
.
.          ************ ADD FORMACTION ***********
.
PMSIHU10  PACK      KEY26,PMIHU001,PMIHU002,PMIHU003,SP70
          CALL      RDPMIHU1
          COMPARE   ZERO,OVRCD
          GOTO      PMSIHU91 IF EQUAL       * if record exists error
.
          CALL      CLPMSIHU                * Clear file variables
          CALL      MVPMIU00                * get the cgi parameters
.
          CALL      IBACLOCK
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          MOVE      CURRDATE,PMIUCDAT       * date record created
          MOVE      CTIMEIS,PMIUCTIM        * time record created
          MOVE      USERID,PMIUCUID         * web user created
.
          PACK      KEY26,PMIUHOSP,PMIUUNIT,PMIUHPIO,SP70
          CALL      RAPMIHU1
          IF        OVRCD=1
            CALL      WRPMIHU1              * write a record
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      PMSIHU99
.
.          ************ UPDATE FORMACTION **********
.
PMSIHU20  PACK      KEY26,PMIHU001,PMIHU002,PMIHU003,SP70
          CALL      RDPMIHU1
          BRANCH    OVRCD,PMSIHU90          * error if record not found
.
          CALL      MVPMIU00                * get the cgi parameters
.
          CALL      IBACLOCK
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          MOVE      CURRDATE,PMIUUDAT       * date record updated
          MOVE      CTIMEIS,PMIUUTIM        * time record updated
          MOVE      USERID,PMIUUUID         * web user updated
.
          CALL      UPPMIHU1                * update the record
.
          MOVE      ZERO,EXIT
          GOTO      PMSIHU99
.
.          ************ DELETE FORMACTION **********
.
PMSIHU30  PACK      KEY26,PMIHU001,PMIHU002,PMIHU003,SP70
          CALL      RDPMIHU1
          BRANCH    OVRCD,PMSIHU90          * error if record not found
.
          PACK      KEY26,PMIHU001,PMIHU002,PMIHU003,SP70
          CALL      DEPMIHU1               * delete the record
.
          MOVE      ZERO,EXIT
          GOTO      PMSIHU99
.
.          ************ DISPLAY FORMACTION **********
.
PMSIHU40  PACK      KEY3,PTHSP001,SP70
          CALL      RDPTHSP1
          IF        OVRCD=1
            CALL      CLPATHSP             * Clear file variables     *C-251645
          ENDIF
.
          PACK      KEY26,PMIHU001,PMIHU002,PMIHU003,SP70
          CALL      RDPMIHU1
          IF        OVRCD=1
            CALL      CLPMSIHU             * Clear file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Hospital Unit HPI-O Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PMSIHU99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      PMSIHU99
.
.         *********** ERROR CONDITIONS ***************
.
PMSIHU90  MOVE      "Code does not exist.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PMSIHU99
.
PMSIHU91  MOVE      "Code already exists.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PMSIHU99
.
PMSIHU92  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PMSIHU99
.
PMSIHU99  RETURN
.
+
.------------------------------------------------------------
. Table of Hospital Unit HPI-O Details
.------------------------------------------------------------
HPIOT000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY26,PTHSP001,SP70
          CALL      RSPMIHU1
.
HPIOT100  CALL      RKPMIHU1
          BRANCH    OVRCD,HPIOT900
.
          MATCH     PTHSP001,PMIUHOSP       * same hosp?
          GOTO      HPIOT900 IF NOT EQUAL
.
HPIOT500  ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      HPIOT100
          ENDIF
.
          CALL      HPIOR000      * Table Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      HPIOT100 IF NOT EQUAL
          GOTO      HPIOT999
.
HPIOT900  CALL      NOMORE00      * Display No More Records Message
.
HPIOT999  RETURN
.
.------------------------------------------------------------
. Hospital Unit HPI-O Details (TABLE ROW)
.------------------------------------------------------------
HPIOR000  MATCH     "1",PMIUACTV
          IF        @EQUAL
            MOVE      "No ",KEY3
          ELSE
            MOVE      "Yes",KEY3
          ENDIF
.
          MOVE      "AC",CATEGORY           * Unit
          MOVE      PMIUUNIT,CODE
          CALL      GETCOD00
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail30":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&pthsp001=",PMIUHOSP:
                             "&pmihu001=",PMIUHOSP:
                             "&pmihu002=",PMIUUNIT:
                             "&pmihu003=",PMIUHPIO:
                             "&pmihu004=",PMIUACTV,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             TDESC,"</td>":
                             "<td>&nbsp;",PMIUHPIO,"</td>":
                             "<td>&nbsp;",KEY3,"</td>";
          WRITE     HTMLFILE;"</tr>"
.
HPIOR999  RETURN
+
.------------------------------------------------------------
.         Provisional DRG via CMBS Item Code Maintenance
.------------------------------------------------------------
PRVDRG00  RESET     UPDTTYPE
          MATCH     SP70,UPDTTYPE
          GOTO      PRVDRG40 IF EQUAL       * Display
.
          MATCH     "A",UPDTTYPE            * Add formaction
          GOTO      PRVDRG10 IF EQUAL
.
          MATCH     "U",UPDTTYPE            * Update formaction
          GOTO      PRVDRG20 IF EQUAL
.
          MATCH     "D",UPDTTYPE            * Delete formaction
          GOTO      PRVDRG30 IF EQUAL
.
          GOTO      PRVDRG93
.
.
.         ************ ADD FORMACTION ***********
.
PRVDRG10  PACK      KEY13,PTPRD001,PTPRD002,SP70
          CALL      RDPTPRD1
          COMPARE   ZERO,OVRCD
          GOTO      PRVDRG91 IF EQUAL       * record exists
.
          CALL      CLPATPRD                * clear file variables
          CALL      MVPTPD00                * move cgi values into file vars
.
          PACK      KEY13,PTPDCMBS,PTPDPDRG,SP70
          CALL      RAPTPRD1
          IF        OVRCD=1
            CALL      WRPTPRD1              * write a record
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      PRVDRG99
.
.
.         ************ UPDATE FORMACTION **********
.
PRVDRG20  PACK      KEY13,PTPRD001,PTPRD002,SP70
          CALL      RDPTPRD1
          BRANCH    OVRCD,PRVDRG92          * record not found
.
          CALL      MVPTPD00                * move cgi values into file vars
          CALL      UPPTPRD1                * update the record
.
          MOVE      ZERO,EXIT
          GOTO      PRVDRG99
.
.
.          ************ DELETE FORMACTION **********
.
PRVDRG30  PACK      KEY13,PTPRD001,PTPRD002,SP70
          CALL      RDPTPRD1
          BRANCH    OVRCD,PRVDRG92          * record not found
.
          CALL      DEPTPRD1                * delete the record
.
          MOVE      ZERO,EXIT
          GOTO      PRVDRG99
.
.
.         ************ DISPLAY FORMACTION **********
.
PRVDRG40  PACK      KEY13,PTPRD001,PTPRD002,SP70
          CALL      RDPTPRD1
          IF        OVRCD=1
            CALL      CLPATPRD    * Clear file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Provisional DRG via CMBS Item Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PRVDRG99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      PRVDRG99
.
.
.         *********** ERROR CONDITIONS ***************
.
PRVDRG91  MOVE      "Record already exists.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PRVDRG99
.
PRVDRG92  MOVE      "Record not found.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PRVDRG99
.
PRVDRG93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PRVDRG99
.
PRVDRG99  RETURN
+
.------------------------------------------------------------
.         Remote Scripting Routine
.------------------------------------------------------------
REMOTE00  CALL      XMLHED00
          BRANCH    EXIT,REMOTE99
.
          BRANCH    REMOTENO,REMOTE10,REMOTE20
          GOTO      REMOTE98
.
REMOTE10  CALL      REMPRD00      * Get Provisional DRG for MBS Item
          GOTO      REMOTE98
.
REMOTE20  CALL      REMCMC00      * Validate Casemix Code
          GOTO      REMOTE98
.
REMOTE98  CALL      XMLEND00
REMOTE99  RETURN
+
.------------------------------------------------------------
.         Remote Script to get Provisional DRG for MBS Code
.------------------------------------------------------------
REMPRD00  MOVE      SP10,D4
          PACK      KEY16,PTPRD001,Z70
          CALL      RSPTPRD2
REMPRD10  CALL      RPPTPRD2
          BRANCH    OVRCD,REMPRD90
.
          MATCH     PTPDCMBS,PTPRD001       * same CMBS Item Code?
          GOTO      REMPRD90 IF NOT EQUAL
.
.         Validate Active code?
          MATCH     "0",PTPDACTV            * active?
          GOTO      REMPRD10 IF NOT EQUAL   * skip if not
.
.         Get the last matching DRG version for this Provisional
          MOVE      "999",KEY3
          PACK      KEY7,PTPDPDRG,KEY3,SP10
          CALL      RSPTDGW1
          CALL      RPPTDGW1
          BRANCH    OVRCD,REMPRD10
.
          MATCH     PTDWDRGC,PTPDPDRG       * matching DRG code?
          GOTO      REMPRD10 IF NOT EQUAL   * skip if not
.
.
.         Validate Patient Sex? (if not blank)
REMPRD11  MATCH     SP70,PTPDPSEX
          GOTO      REMPRD12 IF EQUAL
.
          MATCH     PTPDPSEX,PTPRD004       * matching patient sex?
          GOTO      REMPRD10 IF NOT EQUAL   * skip if not
.
.
.         Validate Sameday Only Visit? (if not blank)
REMPRD12  MATCH     SP70,PTPDSDAY
          GOTO      REMPRD13 IF EQUAL
.
          MATCH     SP70,PTPRD005           * Blank Sameday Only flag?
          GOTO      REMPRD13 IF EQUAL       * pass validation
.
          MOVE      ZERO,DIM1
          MATCH     "2",PTPRD005            * Same Day visit?
          IF        @EQUAL
            MOVE      ONE,DIM1
          ENDIF
          MATCH     PTPDSDAY,DIM1           * Sameday Only Code?
          GOTO      REMPRD10 IF NOT EQUAL   * skip if not matching
.
.
.         Vaidate Patient Age is within Valid Age Range
REMPRD13  MOVE      ZERO,FORM3
          RJUSTIFY  PTPRD007
          MOVE      PTPRD007,FORM3
.
          MOVE      ZERO,AGERNGFR           * default age range From value
          MOVE      PTPDAGEF,AGERNGFR       * Age Range From
.
          MOVE      "999",AGERNGTO          * default age range To value
          MOVE      PTPDAGET,AGERNGTO       * Age Range To
.
          COMPARE   AGERNGFR,FORM3          * Patient Age < Range From value?
          GOTO      REMPRD10 IF LESS        * skip
.
          COMPARE   FORM3,AGERNGTO          * Range To value < Patient Age?
          GOTO      REMPRD10 IF LESS        * skip
.
.
          MOVE      PTPDPDRG,D4             * got out DRG value
.
REMPRD90  WRITE     HTMLFILE;"<RETURN_VALUE TYPE=SIMPLE>",D4,"</RETURN_VALUE>"
.
REMPRD99  RETURN
+
.------------------------------------------------------------
.         Remote script to validate Casemix Code
.------------------------------------------------------------
REMCMC00  PACK      DIM60,SP70
.
          MOVE      VALDCODE,KEY9
          CALL      RDPTCMC1
          BRANCH    OVRCD,REMCMC90
.
          COMPARE   ONE,PTCAACTV            * Is selected code Active?
          GOTO      REMCMC90 IF NOT EQUAL   * No; finish
.
          PACK      DIM60,PTCADES1,SP1,PTCADES2
.
          WRITE     HTMLFILE;"<RETURN_VALUE TYPE=SIMPLE>":
                             *+,KEY9,*-,"|",DIM60:
                             "</RETURN_VALUE>"
          GOTO      REMCMC99
.
REMCMC90  WRITE     HTMLFILE;"<RETURN_VALUE TYPE=SIMPLE>",SP10,"</RETURN_VALUE>"
          GOTO      REMCMC99
.
REMCMC99  RETURN
.
.------------------------------------------------------------
. Surigcal preference/favourite items global functions
.------------------------------------------------------------
SURFAV00  MOVE      ZERO,EXIT
          RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      SURFAV40 IF EQUAL
.
          MATCH     "1",UPDTTYPE    * Surgical preference function 
          GOTO      SURFAV20 IF EQUAL
.
          MATCH     "2",UPDTTYPE    * Favourite charge item function
          GOTO      SURFAV30 IF EQUAL
.
          GOTO      SURFAV93
.
SURFAV20  PACK      SCHDDATE,CCC,CYY,CMM,CDD
          REP       " 0",SCHDDATE
          CLOCK     TIME,SCHDTIME
          MOVE      "IBARSH19",SCHDPGID
          MOVE      "Global Update of Preference /Tray Items",SCHDDESC
.
          MOVE      UPDTTYPE,KEYSTARR[1]     * Update Type  
          MOVE      USERID,KEYSTARR[2]       * Report User ID
          IF        IBCNMHOS = ONE
            MOVE      HOSPCODE,KEYSTARR[3]     * Hospital ID
            MOVE      FVGRP007,KEYSTARR[4]     * Item code to be replaced  
            MOVE      FVGRP008,KEYSTARR[5]     * New item code
            MOVE      ANSY,KEYSTARR[6]     
            MOVE      SIX,KEYSTCNT             * Number of Keyins
          ELSE
            MOVE      FVGRP007,KEYSTARR[3]     * Item code to be replaced
            MOVE      FVGRP008,KEYSTARR[4]     * New item code
            MOVE      ANSY,KEYSTARR[5]
            MOVE      FIVE,KEYSTCNT            * Number of Keyins
          ENDIF
.
          CALL      SCHPRO00                 * Schedule Extract
          GOTO      SURFAV99
.
SURFAV30  PACK      SCHDDATE,CCC,CYY,CMM,CDD
          REP       " 0",SCHDDATE
          CLOCK     TIME,SCHDTIME
          MOVE      "IBARSH19",SCHDPGID
          MOVE      "Global Update of Favourite Charge Items",SCHDDESC
.
          IF        IBCNMHOS = ONE
            MOVE      UPDTTYPE,KEYSTARR[1]     * Update Type  
            MOVE      FVGRP001,KEYSTARR[2]     * Hospital ID  
            MOVE      FVGRP002,KEYSTARR[3]     * User Occupational Group
            MOVE      FVGRP003,KEYSTARR[4]     * User ID 
            MOVE      FVGRP004,KEYSTARR[5]     * Favourite Group
            MOVE      USERID,KEYSTARR[6]       * Report User ID
            MOVE      FVGRP005,KEYSTARR[7]     * Item code to be replaced  
            MOVE      FVGRP006,KEYSTARR[8]     * New item code
            MOVE      ANSY,KEYSTARR[9]     
            MOVE      NINE,KEYSTCNT            * Number of Keyins
          ELSE
            MOVE      UPDTTYPE,KEYSTARR[1]     * Update Type
            MOVE      FVGRP002,KEYSTARR[2]     * User Occupational Group
            MOVE      FVGRP003,KEYSTARR[3]     * User ID
            MOVE      FVGRP004,KEYSTARR[4]     * Favourite Group
            MOVE      USERID,KEYSTARR[5]       * Report User ID
            MOVE      FVGRP005,KEYSTARR[6]     * Item code to be replaced
            MOVE      FVGRP006,KEYSTARR[7]     * New item code
            MOVE      ANSY,KEYSTARR[8]
            MOVE      EIGHT,KEYSTCNT           * Number of Keyins
          ENDIF
.
          CALL      SCHPRO00                   * Schedule Extract
          GOTO      SURFAV99
.
SURFAV40  CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,SURFAV99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      SURFAV99
.
SURFAV93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      SURFAV99
.
SURFAV99  RETURN
.
.--------------------------------------------------------------------------
. User Group Favourite Charge Items tags
.--------------------------------------------------------------------------
FVGP0000  BRANCH    FLDITMNO,FVGP0100,FVGP0200,FVGP0300
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      FVGP9999
.
FVGP0100  CALL      HSELD000
          GOTO      FVGP9999
.
FVGP0200  MOVE      CATACTIV,SCATACTI 
          MOVE      TWO,CATACTIV
          MOVE      "w0",CATEGORY
          MOVE      SP70,CODE
          CALL      CODITM00
          MOVE      SCATACTI,CATACTIV
          GOTO      FVGP9999
.
FVGP0300  MOVE      CATACTIV,SCATACTI
          MOVE      TWO,CATACTIV
          MOVE      "w4",CATEGORY
          MOVE      SP70,CODE
          CALL      CODITM00
          MOVE      SCATACTI,CATACTIV
          GOTO      FVGP9999
.
FVGP9999  RETURN
.
.------------------------------------------------------------
. Hospital Selection with default for Search favourite group
.------------------------------------------------------------
HSELD000  PACK      KEY3,SP70
          CALL      RSPTHSP1
HSELD100  CALL      RKPTHSP1
          BRANCH    OVRCD,HSELD999
.
          PACK      KEY13,USERID,SP70                * All hospital access
          CALL      RDMLSEC1
          IF        OVRCD=1
            PACK      KEY13,USERID,PTHSHOSP,SP70     * This hospital access
            CALL      RDMLSEC1
            BRANCH    OVRCD,HSELD100
          ENDIF
.
          PACK      KEY10,USERID,SP70
          CALL      RDWBSE1
.
          MOVE      PTHSNAME,KEY50
          PACK      KEY5,QUOTE,PTHSHOSP,QUOTE
.
          WRITE     HTMLFILE;"<option value=",KEY5,">",KEY50,"</option>"
          GOTO      HSELD100
.
HSELD999  RETURN
+
.-------------------------------------------------------------
          INC       IBAGSTIO/INC   * GST master file
          INC       MRTLOCIO/INC   * MRT Locations file
          INC       FMSCHQIO/INC
          INC       PATHOSIO/INC   * Hospital File 
          INC       PATITMIO/INC   * IO Patient MBS ITEM FILE
          INC       PATICOIO/INC   * IO ICD9 & (ICD10) Operations/Procedure
          INC       PATICDIO/INC   * IO ICD9 & (ICD10) Diseases/Diagnosis
          INC       PATCMCIO/INC   * Casemix Codes Table IO              
          INC       PATCMXIO/INC   * Casemix Funding Table
          INC       PATDGWIO/INC   * DRG Codes Table IO
          INC       PATIKIIO/INC   * IO patitemn MBS Key Words 
          INC       PATKCOIO/INC   * IO ICD10 Procedure Key Words    
          INC       PATKCDIO/INC   * IO ICD10 Diagnosis Key Words    
          INC       PATDICIO/INC   * IO ICD9 Diagnosis Key Words    
          INC       PATOICIO/INC   * IO ICD9 Procedure Key Words    
          INC       PATKCMIO/INC   * Casemix Codes Key Words    
          INC       PATADIIO/INC   * Audit IO  
          INC       WEBHDPIO/INC   * Hospital Data File Locations   
          INC       PATLCNIO/INC   * Eclipse Location
.
          INC       PAT105MN       * Maint routines for ICD10 Ed.5
          INC       PAT106MN       * Maint routines for ICD10 Ed.6    *I-163918
          INC       PAT107MN       * Maint routines for ICD10 Ed.r7   *I-219246
          INC       PAT108MN       * Maint routines for ICD10 Ed.r8   *I-284420
          INC       PAT109MN       * Maint routines for ICD10 Ed.r9   *I-311669
          INC       PAT10XMN       * Maint routines for ICD10 Ed.r10  *I-0833093
.
          INC       PATKDRPR       * Key Word search Proc: DRG Code
          INC       PATIKIPR       * Key Word search Proc: patitemn MBS Item
          INC       PATKCOPR       * Key Word search Proc: ICD10 Procedures
          INC       PATKCDPR       * Key Word search Proc: ICD10 Diagnosis 
          INC       PATK3OPR       * Key Word search Proc: ICD10 V3 Procedures
          INC       PATK3DPR       * Key Word search Proc: ICD10 V3 Diagnosis 
          INC       PATK4DPR       * Key Word search Proc: ICD10 Ed4 Diagnosis 
          INC       PATK4OPR       * Key Word search Proc: ICD10 Ed4 Procedures
.                                                                     *I-105244
          INC       PATK5DPR       * Key Word search Proc: ICD10 Ed5 Diagnosis 
          INC       PATK5OPR       * Key Word search Proc: ICD10 Ed5 Procedures
.                                                                     *I-163918
          INC       PATK6DPR       * Key Word search Proc: ICD10 Ed6 Diagnosis 
          INC       PATK6OPR       * Key Word search Proc: ICD10 Ed6 Procedures
.                                                                     *I-219246
          INC       PATK7DPR       * Key Word search Proc: ICD10 Ed7 Diagnosis 
          INC       PATK7OPR       * Key Word search Proc: ICD10 Ed7 Procedures
.                                                                     *I-284420
          INC       PATK8DPR       * Key Word search Proc: ICD10 Ed8 Diagnosis 
          INC       PATK8OPR       * Key Word search Proc: ICD10 Ed8 Procedures
.                                                                     *I-311669
          INC       PATK9DPR       * Key Word search Proc: ICD10 Ed9 Diagnosis
          INC       PATK9OPR       * Key Word search Proc: ICD10 Ed9 Procedures
.                                                                     *I-0833093
          INC       PATKXDPR       * Key Word search Proc: ICD10 Ed10 Diagnosis
          INC       PATKXOPR       * Key Word search Proc: ICD10 Ed10 Procedures
.
          INC       PATDICPR       * Key Word search Diag: ICD9
          INC       PATOICPR       * Key Word search Proc: ICD9
          INC       PATKCMPR       * Key Word search Proc: Casemix Codes   
          INC       PMSCKIPR       * Key Word search Proc: Contract IDs
.
          INC       PMSVMTTM
          INC       PMSVMTIO/INC
          INC       PMSVSTIO/INC
.
          INC       PATLGAIO/INC   * LGA Code IO
          INC       PATLG1IO/INC   * LGA Code IO
          INC       PATCT1IO/INC   * Catchment Codes IO 
          INC       PMSCIDIO/INC   * Contract ID IO 
          INC       PATNURIO/INC   * Nursing Station File IO
          INC       PATWR1IO/INC   * Ward Bed File IO
          INC       PATCLSIO/INC   * Clinical specialty file
          INC       PATCANIO/INC   * Cancer code file
          INC       PATHSPIO/INC   * Hospital details file
          INC       RCPREGIO/INC
          INC       RCPCIDIO/INC
          INC       PMSCKIIO/INC   * Contract ID key words
          INC       PMSDCAIO/INC   * Deleted Contracts Audit
          INC       PMSIHUIO/INC      * Hospital/Unit HPI-O Details
          INC       PMSTEMIO/INC
          INC       PMSHCPIO/INC                                      *I-251645
          INC       PATLSDIO/INC
          INC       PATASDIO/INC
          INC       PATHLFIO/INC
          INC       PATLDFIO/INC
          INC       PATHDFIO/INC
          INC       PATAFEIO/INC
          INC       PMSDIVIO/INC
          INC       MLTSECIO/INC   * Multi Hospital Security Table
          INC       PATPRDIO/INC   * Provisional DRG via CMBS Item Code IO
          INC       PATDOCCD                                          *I-251645
          INC       NAMSTRCD                                          *I-251645
.
          INC       PATITMRD
          INC       PATITMVL
          INC       PMSDIVTM
          INC       PMSIHUTM
          INC       DAYOFWEK   
          INC       IBAWEBCD
          INC       RSHWEBCD
          INC       WEBDATCD
          INC       CLPATHSP
          INC       CLPMSIHU
          INC       PATPRDTM       * Routines for Provisional DRG via CMBS Code
.
          INC       PATIX1TM       * Routines for ICD10 Edition 11
          INC       PATIX2TM       * Routines for ICD10 Edition 12    *I-0917793
          INC       PATIX3TM       * Routines for ICD10 Edition 13    *I-0956210
          INC       PTDK11PR       * Update Keyword Index: ICD10 Ed11 Diagnosis
          INC       PTDK12PR       * Update Keyword Index: ICD10 Ed12 Diagnosis
          INC       PTDK13PR       * Update Keyword Index: ICD10 Ed13 Diagnosis
          INC       PTOK11PR       * Update Keyword Index: ICD10 Ed11 Procedures
          INC       PTOK12PR       * Update Keyword Index: ICD10 Ed12 Procedures
          INC       PTOK13PR       * Update Keyword Index: ICD10 Ed13 Procedures
.
