.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.01.00"
.-------------------------------------------------------
. V9.09.01  25.06.2007 Sandra Barcham CAR 123735
.           Catalog Contract Price Control
.-------------------------------------------------------
. V9.04.01 08.04.2005 Peter Vela CAR 59696
.          Changed commodity group from DIM 5 to DIM 6
.-------------------------------------------------------
. V9.03.01 23/07/2004  Mike Laming  CAR 43474
.          Change UNCEA200 & USCEA200 to not write to "apscebaf" if qty = 0
. V9.02.02  24.04.2003  Davin  Quote 15040
.           Modified validation of delivery point
. V9.02.01  18.03.2003  Davin  Quote 15040
.           Modified program for Multiple Delivery Points
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B01 20.11.2000 Charles Handaya
.           Modification of Warehouse Security
.-------------------------------------------------------
. VF.00.09  16.02.2000 Sandra Barcham
.           Fix committed expenditure
.           srf 637096
. VF.00.08  20.01.2000 Sandra Barcham
.           Check for non-stock catalog on order
.           srf 646402
. VF.00.07  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           23.12.1999 Charles Handaya
.           Fixed Write to Audit File
.           10.11.1999 Charles Handaya
.           Fixed Y2K of Audit Files Date (CCYYMMDD)
. VF.00.06  02.11.1999 Sandra Barcham
.           Recompiled to change E to exit to X in SINPONCD
. VF.00.05  30.10.1999 Sandra Barcham
.           Stop add catalog/supplier defaulting values
.           srf 634506 & 634175
. VF.00.04  02.09.1999 Sandra Barcham
.           Add in Creditor Keyword Search
.           srf 631485
. VF.00.03  29.06.1999 Sandra Barcham
.           Allow X to exit for catalog code
.           srf 632601 & srf 645745
. VF.00.02  24.04.1999 Sandra Barcham
.           Display & print user defined ref 2 (SIPCUR2) for HSH V6.00.99
.           Also fix unix error 24 too many files open
.           srf 627759 quote 9231
. VF.00.01  04.03.1999 Sandra Barcham
.           Fix usage keys on batch screen
.-------------------------------------------------------
CEAFILE   FORM      1
CEXPDATE  DIM       8
CHECKCST  FORM      12.4                     * Check cost to see if changed
CHECKQTY  FORM      12.2                     * Check qty to see if changed
CKORDFLG  FORM      1
CURRSUPP  DIM       5
DETLCOST  DIM       5
DIM30     DIM       30
F12P4     FORM      12.4
FORM12P2  FORM      12.2
FORM6     FORM      6
HEADCOST  DIM       5
KEY46SAV  DIM       46
LASTPGP   DIM       5
LASTGST   DIM       6
MODQTY    FORM      12.2
MYCOL     FORM      2
MYVERT    FORM      2
NXORDLIN  FORM      3
ORDQTY    FORM      12.2
ORIGECT   FORM      12.4
ORIGGST   FORM      12.4
RECCOUNT  FORM      3
SAVECOST  FORM      12.4
SECSIWS   FORM      1
SSIPASUP  DIM       5
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN50
.   Function      :   Purchase Orders Maintenance             
.   Generated  On :   16/07/2007
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSCEAFD/INC
          INC       APSCEBFD/INC
          INC       APSCIOFD/INC
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
          INC       APSORDFD/INC
          INC       APSSNTFD/INC
          INC       APSSUBFD/INC
          INC       FMSAMAFD/INC
          INC       FMSCONFD/INC
          INC       FMSCSAFD/INC
          INC       FMSFPSFD/INC
          INC       FMSLMAFD/INC
          INC       FMSLMCDF    
          INC       FMSLMCFD/INC
          INC       FMSTUPFD/INC
          INC       IBAGEDFD/INC
          INC       IBAGSTFD/INC
          INC       SINCCAFD/INC
          INC       SINCGAFD/INC
          INC       SINCGBFD/INC
          INC       SINCIAFD/INC
          INC       SINCIBFD/INC
          INC       SINCICFD/INC
          INC       SINCIDFD/INC
          INC       SINCIEFD/INC
          INC       SINCIFFD/INC
          INC       SINCIGFD/INC
          INC       SINCIHFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINDPCFD/INC
          INC       SINFACFD/INC
          INC       SINLTTFD/INC
          INC       SINNATFD/INC
          INC       SINORIFD/INC
          INC       SINPERFD/INC
          INC       SINPIMFD/INC
          INC       SINPOAFD/INC
          INC       SINPOBFD/INC
          INC       SINPOCFD/INC
          INC       SINPODFD/INC
          INC       SINPOFFD/INC
          INC       SINRCPFD/INC
          INC       SINSCDFD/INC
          INC       SINSCMFD/INC
          INC       SINSUAFD/INC
          INC       SINSUBFD/INC
          INC       SINSVAFD/INC
          INC       SINSVBFD/INC
          INC       SINTMPDF/INC
          INC       SINTRNFD/INC
          INC       SINVHAFD/INC
          INC       SINWARFD/INC
          INC       SINWSEFD/INC
.=========================
.Local Variable Definition
.-------------------------
CANSAVE   DIM      10 * Scr 00 Fld     5
OPT50     FORM      1 * Scr 00 Fld    12
CONFDESC  DIM      30 * Scr 01 Fld    18
MESSDESC  DIM      30 * Scr 01 Fld    19
.
.Word Processor File * Scr 01 Fld    20
.
NAMSIPB1  INIT      "Wsipb1"
FILSIPB1  DIM       8
.
DEFTWARE  DIM       5 * Scr 01 Fld    25
NOTEAPSN  DIM       5 * Scr 01 Fld    29
.
.Word Processor File * Scr 01 Fld    33
.
NAMAPSN1  INIT      "Wapsn1"
FILAPSN1  DIM       8
.
DELVCODE  DIM      46 * Scr 01 Fld    40
DELVDESC  DIM      40 * Scr 01 Fld    41
.
.    Multi Item Key Fields Scr 02 Fld     1
.-------------------------------------------------------
SIPC1NAM  INIT      "SIPC1"
SIPC1END  FORM      1   * End Display
SIPC1SNO  FORM      5   * Number of Items on the Screen
SIPC1MKY  DIM       127 * Match Key 
SIPC1EKY  DIM       127 * End Key
SIPC1SKY  DIM       127 * Start Key
SIPC1IDX  INIT      " 132 UC1-5"
SIPC1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIPC1FNM  DIM       8  * Filename
SIPC1CNT  FORM      3  * Number of Items on Screen
UNITCOST  DIM      14 * Scr 02 Fld    14
.
.Word Processor File * Scr 03 Fld     4
.
NAMSIPD1  INIT      "Wsipd1"
FILSIPD1  DIM       8
.
NOTESIIB  DIM       5 * Scr 03 Fld    26
NOTESIIG  DIM       5 * Scr 03 Fld    27
NOTESIID  DIM       5 * Scr 03 Fld    28
TOTALGST  FORM     12.2 * Scr 03 Fld    37
TOTALCST  FORM     12.2 * Scr 03 Fld    38
.
.Word Processor File * Scr 04 Fld    62
.
NAMSIIB1  INIT      "Wsiib1"
FILSIIB1  DIM       8
.
.
.Word Processor File * Scr 04 Fld    63
.
NAMSIIG1  INIT      "Wsiig1"
FILSIIG1  DIM       8
.
.
.Word Processor File * Scr 04 Fld    64
.
NAMSIID1  INIT      "Wsiid1"
FILSIID1  DIM       8
.
SUSPDESC  DIM      25 * Scr 05 Fld     9
UDC1DESC  DIM      30 * Scr 05 Fld    29
UDC2DESC  DIM      30 * Scr 05 Fld    30
SAVECATA  DIM       7 * Scr 05 Fld    40
SAVECRED  DIM       5 * Scr 05 Fld    41
SAVEUNIT  DIM      15 * Scr 05 Fld    42
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN50"
PRGNAM    INIT      "Purchase Orders Maintenance             "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      RINCOCAT
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIPB1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     SIPC1FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIPD1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIIB1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIIG1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIID1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apssntaf";
          OPEN      APSSNTA1,"apssntaf"
          DISPLAY   *P56:24,"Opening apssubaf";
          OPEN      APSSUBA1,"apssubaf"
          DISPLAY   *P56:24,"Opening ibagedaf";
          OPEN      IBAGEDA1,"ibagedaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA1,"ibagstaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA2,"ibagstaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA3,"ibagstaf"
          MOVE      "   24",AUDTSECT
          MOVE      "207",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudic";
            OPEN      SINAUDIC,"sinaudic"
          ENDIF
          MOVE      "   24",AUDTSECT
          MOVE      "210",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudpa";
            OPEN      SINAUDPA,"sinaudpa"
          ENDIF
          MOVE      "   24",AUDTSECT
          MOVE      "210",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudpc";
            OPEN      SINAUDPC,"sinaudpc"
          ENDIF
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA1,"sinccaaf"
          DISPLAY   *P56:24,"Opening sincgaaf";
          OPEN      SINCGAA1,"sincgaaf"
          DISPLAY   *P56:24,"Opening sincgbaf";
          OPEN      SINCGBA1,"sincgbaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincibaf";
          OPEN      SINCIBA1,"sincibaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA1,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA2,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA3,"sincicaf"
          DISPLAY   *P56:24,"Opening sincidaf";
          OPEN      SINCIDA1,"sincidaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA1,"sincieaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA2,"sincieaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA1,"sincifaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA2,"sincifaf"
          DISPLAY   *P56:24,"Opening sincigaf";
          OPEN      SINCIGA1,"sincigaf"
          DISPLAY   *P56:24,"Opening sincihaf";
          OPEN      SINCIHA1,"sincihaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA2,"sincodaf"
          DISPLAY   *P56:24,"Opening sindpcaf";
          OPEN      SINDPCA1,"sindpcaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA1,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA2,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinlttaf";
          OPEN      SINLTTA1,"sinlttaf"
          DISPLAY   *P56:24,"Opening sinoriaf";
          OPEN      SINORIA1,"sinoriaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA2,"sinperaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA1,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA3,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA4,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpobaf";
          OPEN      SINPOBA1,"sinpobaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA1,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpodaf";
          OPEN      SINPODA1,"sinpodaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA1,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinrcpaf";
          OPEN      SINRCPA1,"sinrcpaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA2,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA3,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscmaf";
          OPEN      SINSCMA1,"sinscmaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsubaf";
          OPEN      SINSUBA1,"sinsubaf"
          DISPLAY   *P56:24,"Opening sinsvaaf";
          OPEN      SINSVAA1,"sinsvaaf"
          DISPLAY   *P56:24,"Opening sinsvbaf";
          OPEN      SINSVBA1,"sinsvbaf"
          DISPLAY   *P56:24,"Opening sintrnaf";
          OPEN      SINTRNA1,"sintrnaf"
          DISPLAY   *P56:24,"Opening  sinvhaaf           ";
          OPEN      SINVHAA3,"sinvhaaf"          
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA1,"sinwseaf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA2,"sinwseaf"
.--------------------------------------------------------
. Initialise Wp Filename for Additional Comments (Purchase Head)
.--------------------------------------------------------
          PACK      FILSIPB1,NAMSIPB1,PORT
          REP       " 0",FILSIPB1
          DISPLAY   *P56:24,"Create & Open ",FILSIPB1;
          PREP      TEMPWORD,FILSIPB1
.
.--------------------------------------------------------
. Initialise Wp Filename for Supplier Notes                     
.--------------------------------------------------------
          PACK      FILAPSN1,NAMAPSN1,PORT
          REP       " 0",FILAPSN1
          DISPLAY   *P56:24,"Create & Open ",FILAPSN1;
          PREP      TEMPWORD,FILAPSN1
.
.--------------------------------------------------------
. Initialise Batch Screen Item Number                        
.--------------------------------------------------------
          MOVE     ZERO,SIPC1SNO
          MOVE     "02    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIPC1SNO
            ENDIF
          ENDIF
          PACK      SIPC1FNM,ANST,SIPC1NAM,PORT
          REP       " 0",SIPC1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIPC1FL1,SIPC1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIPC1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIPC1FNM,SIPC1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIPC1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIPC1FL1,SIPC1FNM
.--------------------------------------------------------
. Initialise Wp Filename for Additional Comments                
.--------------------------------------------------------
          PACK      FILSIPD1,NAMSIPD1,PORT
          REP       " 0",FILSIPD1
          DISPLAY   *P56:24,"Create & Open ",FILSIPD1;
          PREP      TEMPWORD,FILSIPD1
.
.--------------------------------------------------------
. Initialise Wp Filename for Catalog Notes                      
.--------------------------------------------------------
          PACK      FILSIIB1,NAMSIIB1,PORT
          REP       " 0",FILSIIB1
          DISPLAY   *P56:24,"Create & Open ",FILSIIB1;
          PREP      TEMPWORD,FILSIIB1
.
.--------------------------------------------------------
. Initialise Wp Filename for Catalog/Warehouse Notes            
.--------------------------------------------------------
          PACK      FILSIIG1,NAMSIIG1,PORT
          REP       " 0",FILSIIG1
          DISPLAY   *P56:24,"Create & Open ",FILSIIG1;
          PREP      TEMPWORD,FILSIIG1
.
.--------------------------------------------------------
. Initialise Wp Filename for Catalog/Supplier Notes             
.--------------------------------------------------------
          PACK      FILSIID1,NAMSIID1,PORT
          REP       " 0",FILSIID1
          DISPLAY   *P56:24,"Create & Open ",FILSIID1;
          PREP      TEMPWORD,FILSIID1
.
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Purchase Order Maintenance Options 
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Purchase Order Header Input        
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Purchase Order Summary             
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Purchase Order Detail              
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Catalog Information Screen         
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Enter Supplier/Catalog Details     
          ENDIF
          RETURN
.--------------------------------
. Screen - Purchase Order Maintenance Options 
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      RDCON000
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Order Maintenance Options 
.-------------------------------------------------------
CF00L000
          MOVE      SP70,CANSAVE 
          MOVE      ZERO,OPT50   
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Order Maintenance Options 
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Order Maintenance Options 
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Order Maintenance Options 
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Order Maintenance Options 
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Order Maintenance Options 
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L101,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L102
          GOTO     PS00L999
.
PS00L101
          MOVE      CANSAVE,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      OPT50,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Order Maintenance Options 
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L101,SF00L102,SF00L103,SF00L104:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L105,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL      GENORD00
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SELORD00
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      MODORD00
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      CANORD00
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          MOVE      ZERO,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Purchase Order Header Input        
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      SETSCR01
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Order Header Input        
.-------------------------------------------------------
CF01L000
          MOVE      SP70,SIPAORI 
          MOVE      SP70,SIPAICN 
          MOVE      SP70,SIPASCN 
          MOVE      SP70,SIPADEL 
          MOVE      SP70,SIPAMES 
          MOVE      SP70,SIPADIN 
          MOVE      SP70,SIPAIDP 
          MOVE      SP70,SIPAUR1 
          MOVE      SP70,SIPAUR2 
          MOVE      SP70,SIPAUD1 
          MOVE      SP70,SIPAUD2 
          MOVE      SP70,SIPAUC1 
          MOVE      SP70,SIPAUC2 
          MOVE      SP70,SIPAUY1 
          MOVE      SP70,SIPAUY2 
          MOVE      SP70,SIORNAME
          MOVE      SP70,SIPACON 
          MOVE      SP70,CONFDESC
          MOVE      SP70,MESSDESC
          MOVE      SP70,SIPAPON 
          MOVE      SP70,DEFTWARE
          MOVE      SP70,SIWADES 
          MOVE      SP70,SIPASUP 
          MOVE      SP70,APMASN1 
          MOVE      SP70,NOTEAPSN
          MOVE      SP70,SIOREXT 
          MOVE      SP70,SIPEPER 
          MOVE      SP70,SIPEYEAR
          MOVE      SP70,SIPACST 
          MOVE      SP70,SICADESC
          MOVE      SP70,APMASTEL
          MOVE      SP70,APMASFAX
          MOVE      SP70,APMAUR1 
          MOVE      SP70,DELVCODE
          MOVE      SP70,DELVDESC
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Order Header Input        
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Order Header Input        
.---------------------------------------------------------
WP01L000
          PREP     TEMPWORD,FILSIPB1
          PACK     KEY10,SIPAPON,SP70
          MOVE     KEY10,SAVKEY80
          SETLPTR  SAVKEY80,7 
          CALL      RDSIPB1 
          IF        OVRCD=0
            CALL      RPSIPB1 
          ENDIF
WP01L100
          CALL     RKSIPB1 
          BRANCH   OVRCD,WP01L105
          PACK     KEY10,SIPBPON,SIPBLIN
          MATCH    SAVKEY80,KEY10   
          GOTO     WP01L105 IF NOT EQUAL
          PACK     VAR,SIPBCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIPBCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L100
WP01L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILAPSN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPSN1 
          IF        OVRCD=0
            CALL      RPAPSN1 
          ENDIF
WP01L110
          CALL     RKAPSN1 
          BRANCH   OVRCD,WP01L115
          PACK     KEY8,APSNCRD,APSNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP01L115 IF NOT EQUAL
          PACK     VAR,APSNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APSNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L110
WP01L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Order Header Input        
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Order Header Input        
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Order Header Input        
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L101,PS01L102,PS01L103,PS01L104:
                            PS01L105,PS01L106,PS01L107,PS01L108:
                            PS01L109,PS01L110,PS01L111,PS01L112:
                            PS01L113,PS01L114,PS01L115,PS01L116:
                            PS01L117,PS01L118,PS01L119,PS01L120:
                            PS01L121,PS01L999,PS01L999,PS01L999:
                            PS01L122,PS01L123,PS01L124,PS01L125:
                            PS01L126,PS01L127,PS01L128,PS01L129:
                            PS01L130,PS01L131,PS01L132,PS01L133:
                            PS01L134,PS01L999,PS01L135,PS01L136:
                            PS01L137
          GOTO     PS01L999
.
PS01L101
          MOVE      SIPAORI,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      SIPAICN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      SIPASCN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      SIPADEL,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      SIPAMES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      SIPAIDP,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      SIPAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      SIPAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          UNPACK    SIPAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          UNPACK    SIPAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      SIPAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      SIPAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      SIPACON,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          MOVE      CONFDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          MOVE      MESSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE     FILSIPB1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
.
PS01L121
          MOVE      SIPAPON,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          MOVE      DEFTWARE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          MOVE      SIPASUP,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE      NOTEAPSN,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L127
          MOVE      SIOREXT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L128
          MOVE      SIPEPER,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L129
          MOVE      SIPEYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L130
          MOVE     FILAPSN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
.
PS01L131
          MOVE      SIPACST,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L132
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L133
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L134
          CALL      RDCOD000
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L135
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L136
          CALL      CMDP0000
          MOVE      DELVCODE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L137
          MOVE      DELVDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Order Header Input        
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L101,SF01L102,SF01L103,SF01L104:
                            SF01L105,SF01L106,SF01L107,SF01L108:
                            SF01L109,SF01L110,SF01L111,SF01L112:
                            SF01L113,SF01L114,SF01L115,SF01L006:
                            SF01L116,SF01L006,SF01L006,SF01L117:
                            SF01L006,SF01L006,SF01L118,SF01L119:
                            SF01L120,SF01L006,SF01L121,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L122,SF01L123,SF01L006,SF01L006:
                            SF01L006,SF01L124,SF01L006,SF01L125:
                            SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L101,SF01L102,SF01L103,SF01L104:
                            SF01L105,SF01L106,SF01L107,SF01L108:
                            SF01L109,SF01L110,SF01L111,SF01L112:
                            SF01L113,SF01L114,SF01L115,SF01L020:
                            SF01L116,SF01L020,SF01L020,SF01L117:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L120,SF01L020,SF01L121,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L122,SF01L123,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L125:
                            SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIORNAME
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIOREXT 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EORIG000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L101
            ENDIF
            BRANCH    EXIT,SF01L101,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIPAORI,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIORNAME,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIOREXT,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L102
          CALL     SELECTED
          STRIP     SIPAICN 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPAICN,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPAICN 
          SFORMAT   VAR,127
          ENDSET    SIPAICN 
          APPEND    SP70,SIPAICN 
          RESET     SIPAICN 
          CMATCH    EXITCHAR,SIPAICN 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPAICN 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L102
            ENDIF
          ENDIF
          MOVE      SIPAICN,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L103
          CALL     SELECTED
          STRIP     SIPASCN 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPASCN,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPASCN 
          SFORMAT   VAR,127
          ENDSET    SIPASCN 
          APPEND    SP70,SIPASCN 
          RESET     SIPASCN 
          CMATCH    EXITCHAR,SIPASCN 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPASCN 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
          ENDIF
          MOVE      SIPASCN,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EDELP000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L104
            ENDIF
            BRANCH    EXIT,SF01L104,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIPADEL,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L105
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,MESSDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EMESS000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L105
            ENDIF
            BRANCH    EXIT,SF01L105,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIPAMES,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   19",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      MESSDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L106
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIPEPER 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIPEYEAR
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EORDD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L106
            ENDIF
            BRANCH    EXIT,SF01L106,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIPEPER,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIPEYEAR,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L107
          CALL     SELECTED
          STRIP     SIPAIDP 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPAIDP,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPAIDP 
          SFORMAT   VAR,127
          ENDSET    SIPAIDP 
          APPEND    SP70,SIPAIDP 
          RESET     SIPAIDP 
          CMATCH    EXITCHAR,SIPAIDP 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPAIDP 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L107
            ENDIF
          ENDIF
          MOVE      SIPAIDP,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L108
          CALL     SELECTED
          STRIP     SIPAUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPAUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPAUR1 
          SFORMAT   VAR,127
          ENDSET    SIPAUR1 
          APPEND    SP70,SIPAUR1 
          RESET     SIPAUR1 
          CMATCH    EXITCHAR,SIPAUR1 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPAUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L108
            ENDIF
          ENDIF
          MOVE      SIPAUR1,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L109
          CALL     SELECTED
          STRIP     SIPAUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPAUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPAUR2 
          SFORMAT   VAR,127
          ENDSET    SIPAUR2 
          APPEND    SP70,SIPAUR2 
          RESET     SIPAUR2 
          CMATCH    EXITCHAR,SIPAUR2 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPAUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L109
            ENDIF
          ENDIF
          MOVE      SIPAUR2,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L110
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIPAUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIPAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L111
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIPAUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIPAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L112
          CALL     SELECTED
          STRIP     SIPAUC1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPAUC1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPAUC1 
          SFORMAT   VAR,127
          ENDSET    SIPAUC1 
          APPEND    SP70,SIPAUC1 
          RESET     SIPAUC1 
          CMATCH    EXITCHAR,SIPAUC1 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPAUC1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L112
            ENDIF
          ENDIF
          MOVE      SIPAUC1,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L113
          CALL     SELECTED
          STRIP     SIPAUC2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPAUC2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPAUC2 
          SFORMAT   VAR,127
          ENDSET    SIPAUC2 
          APPEND    SP70,SIPAUC2 
          RESET     SIPAUC2 
          CMATCH    EXITCHAR,SIPAUC2 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPAUC2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L113
            ENDIF
          ENDIF
          MOVE      SIPAUC2,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L114
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIPAUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L115
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIPAUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L116
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CONFDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECONF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L116
            ENDIF
            BRANCH    EXIT,SF01L116,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIPACON,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CONFDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L117
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "12",SCPSROW
              MOVE     " 10",SCPSCOL
              MOVE     " 60",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIPB1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIPB1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SF01L001
.
SF01L118
          CALL      CAN10000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L119
          CALL      POST0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L120
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIWADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EWARE000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L120
            ENDIF
            BRANCH    EXIT,SF01L120,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      DEFTWARE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIWADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L121
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,NOTEAPSN
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   36",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASTEL
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL      RDCOD000
.
.
          MOVE      "   37",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASFAX
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   39",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMAUR1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESUPP000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L121
            ENDIF
            BRANCH    EXIT,SF01L121,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIPASUP,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      NOTEAPSN,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   36",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASTEL,VAR     
            CALL      DISPITEM
          ENDIF
          CALL      RDCOD000
.
.
          MOVE      "   37",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASFAX,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   39",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMAUR1,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L122
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "12",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPSN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPSN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF01L001
.
SF01L123
.
.
          MOVE      "   35",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SICADESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EDCST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L123
            ENDIF
            BRANCH    EXIT,SF01L123,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIPACST,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   35",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SICADESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L124
          CALL      IMPT0000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L125
.
.
          MOVE      "   41",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,DELVDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EDELP000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L125
            ENDIF
            BRANCH    EXIT,SF01L125,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          CALL      CMDP0000
          MOVE      DELVCODE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   41",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      DELVDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
SF01L990  MOVE      FOUR,EXIT * Exit Char Exit
SF01L999  RETURN
.--------------------------------
. Screen - Purchase Order Summary             
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Order Summary             
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Order Summary             
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Order Summary             
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Order Summary             
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :     1 Item Number                        
.---------------------------------------------------------
          UNPACK    SP70,SIPCPON,SIPCITM
          PACK      KEY10,SIPAPON,SP70
          MOVE      KEY10,SIPC1EKY
          STRIP     SIPC1SKY
          SETLPTR   SIPC1EKY,7
          MOVE      SIPC1EKY,SIPC1SKY
          CALL      RDSIPC1 
          IF        OVRCD=0
            CALL      RPSIPC1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,SIPC1CNT
          MOVE     ZERO,SIPC1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L101,DP02L102,DP02L103,DP02L104:
                            DP02L105,DP02L106,DP02L107,DP02L108:
                            DP02L109,DP02L110,DP02L111,DP02L112:
                            DP02L113,DP02L114,DP02L115,DP02L116:
                            DP02L117,DP02L118,DP02L119,DP02L120:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          PACK      SIPC1MKY,SP70,SP70
          CALL      UPTSIPC1
          IF        SIPC1END=0
            CALL      RKSIPC1 
            IF        OVRCD=0
              PACK      SIPC1MKY,SIPCPON,SIPCITM                                                                
              MATCH     SIPC1EKY,SIPC1MKY
              IF        @EQUAL
                MOVE      ZERO,SIPC1END
                ADD       ONE,SIPC1CNT
                CALL      UPTSIPC1
                MOVE      SIPCITM,VAR      
                CALL      DISPITEM
          CALL      REDITM00
              ELSE
                MOVE      ONE,SIPC1END
              ENDIF
            ELSE
              MOVE      ONE,SIPC1END
            ENDIF
          ENDIF
          IF        SIPC1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        SIPC1END=0
            MOVE      SIPCCST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        SIPC1END=0
            MOVE      SIPCPRD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        SIPC1END=0
            MOVE      SIPCDAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        SIPC1END=0
            MOVE      SIPCWAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        SIPC1END=0
            MOVE      SIPCCAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        SIPC1END=0
            MOVE      SIPCPN,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L108
          IF        SIPC1END=0
            MOVE      SIPCPD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L109
          IF        SIPC1END=0
            MOVE      SIPCCON,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L110
          IF        SIPC1END=0
            MOVE      SIPCCDT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L111
          IF        SIPC1END=0
            MOVE      SIPCSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L112
          IF        SIPC1END=0
            MOVE      SIPCEDD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L113
          IF        SIPC1END=0
            MOVE      SIPCOQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L114
          IF        SIPC1END=0
            MOVE      UNITCOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L115
          IF        SIPC1END=0
            MOVE      SIPCUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L116
          IF        SIPC1END=0
            MOVE      SIPCUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L117
          IF        SIPC1END=0
            UNPACK    SIPCUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L118
          IF        SIPC1END=0
            UNPACK    SIPCUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L119
          IF        SIPC1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIPCUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L120
          IF        SIPC1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIPCUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "SIPC1",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          CALL      TOTORD00
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOTALORD,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   49",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIORNAME,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "SIPC1",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY10,SIPC1SKY,SP70
          CALL     RDSIPC1  * Start
          IF       OVRCD=0
            CALL     RPSIPC1  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "SIPC1",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY10,SIPC1SKY,Z70
          CALL     RSSIPC1  * End
          IF       OVRCD=1
            CALL     RPSIPC1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPC1SNO
            CALL     RPSIPC1 
            IF       OVRCD=1
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            PACK     SIPC1MKY,SIPCPON,SIPCITM                                                                
            MATCH    SIPC1EKY,SIPC1MKY
            IF       !@EQUAL
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "SIPC1",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          CALL      RFTSIPC1
          BRANCH   OVRCD,PP02L115
          MOVE      SIPC1MKY,KEY10 
          CALL      RSSIPC1 
PP02L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIPC1SNO
            CALL     RPSIPC1 
            IF       OVRCD=1
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            PACK     SIPC1MKY,SIPCPON,SIPCITM                                                                
            MATCH    SIPC1EKY,SIPC1MKY
            IF       !@EQUAL
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPC1SNO
            CALL     RKSIPC1 
            IF       OVRCD=1
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            PACK     SIPC1MKY,SIPCPON,SIPCITM                                                                
            MATCH    SIPC1EKY,SIPC1MKY
            IF       !@EQUAL
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "SIPC1",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RKSIPC1 
          BRANCH   OVRCD,NP02L110
          PACK     SIPC1MKY,SIPCPON,SIPCITM                                                                
          MATCH    SIPC1EKY,SIPC1MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RPSIPC1 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RPSIPC1 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Purchase Order Summary             
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     1 Item Number                        
.---------------------------------------------------------
UPTSIPC1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPC1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIPC1FL1,KEY5;SCPSROW,SCPSCOL,SIPC1MKY
          ELSE
            UPDATE    SIPC1FL1;SCPSROW,SCPSCOL,SIPC1MKY
          ENDIF
          RETURN
RDTSIPC1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPC1FL1,KEY5;SCPSROW,SCPSCOL,SIPC1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIPC1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIPC1FL1,KEY5;;
          READKS    SIPC1FL1;SCPSROW,SCPSCOL,SIPC1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIPC1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Order Summary             
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Order Summary             
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L101,PS02L102,PS02L103,PS02L104:
                            PS02L105,PS02L106,PS02L107,PS02L108:
                            PS02L109,PS02L110,PS02L111,PS02L112:
                            PS02L113,PS02L114,PS02L115,PS02L116:
                            PS02L117,PS02L118,PS02L119,PS02L120:
                            PS02L121,PS02L122,PS02L123,PS02L124:
                            PS02L125,PS02L999
          GOTO     PS02L999
.
PS02L101
          CALL      TOTORD00
          MOVE      TOTALORD,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      SIPAPON,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      SIPASUP,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      SIPAORI,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      SIPAICN,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      SIPASCN,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      SIPADEL,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      SIPAMES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      SIWAWAR,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      SIPACON,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      SIPAIDP,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      SIPAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          MOVE      SIPAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          UNPACK    SIPAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L116
          UNPACK    SIPAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L117
          MOVE      SIPAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L118
          MOVE      SIPAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L120
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L121
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L122
          MOVE      CONFDESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L123
          MOVE      MESSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L124
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L125
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Order Summary             
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L101,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L102,SF02L103,SF02L104,SF02L105:
                            SF02L006,SF02L106,SF02L107,SF02L108:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L109
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L101,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          COMPARE   ONE,ACCEPT
          GOTO      SF02L001 IF EQUAL
          CALL      RDTSIPC1
          IF        OVRCD=1
            BEEP
            GOTO      SF02L001
          ENDIF
          MATCH     SP70,SIPC1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF02L001
          ENDIF
          MOVE      SIPC1MKY,KEY10 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELITM00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIPC1
          IF        OVRCD=1
            CALL      FP02L000
          ELSE
            MOVE      SIPC1MKY,KEY10 
            CALL      RSSIPC1 
            CALL      RPSIPC1 
            CALL      DP02L000
          ENDIF
          GOTO     SF02L001
.
SF02L102
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L103
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L104
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L105
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
.
SF02L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      ADITM000
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF02L000
          GOTO      SF02L001
.
SF02L107
.
.
          MOVE      "   53",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL      UPCOST00
.
.
          MOVE      "   53",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L108
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DEL10000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF02L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF02L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF02L999
          ENDIF
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF02L000
          ENDIF
          GOTO      SF02L001
.
SF02L109
          CALL      SELIN000
          GOTO      SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Purchase Order Detail              
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Order Detail              
.-------------------------------------------------------
CF03L000  COMPARE   ZERO,ACCEPT
              GOTO      CF03L999 IF EQUAL
          MOVE      SP70,SIPCITM 
          MOVE      SP70,SIPCCST 
          MOVE      SP70,SIPCPRD 
          MOVE      SP70,SIPCWAR 
          MOVE      SP70,SIPCCAT 
          MOVE      SP70,SIPCPN  
          MOVE      SP70,SIPCPD  
          MOVE      SP70,SIPCCON 
          MOVE      SP70,SIPCCDT 
          MOVE      SP70,SIPCSUT 
          MOVE      SP70,SIPCEDD 
          MOVE      ZERO,SIPCOQT 
          MOVE      SP70,UNITCOST
          MOVE      SP70,SIPCUR1 
          MOVE      SP70,SIPCUR2 
          MOVE      SP70,SIPCUD1 
          MOVE      SP70,SIPCUD2 
          MOVE      SP70,SIPCUY1 
          MOVE      SP70,SIPCUY2 
          MOVE      SP70,SIIADES 
          MOVE      SP70,SICADESC
          MOVE      SP70,SISADESC
          MOVE      SP70,NOTESIIB
          MOVE      SP70,NOTESIIG
          MOVE      SP70,NOTESIID
          MOVE      SP70,SIVACOD 
          MOVE      SP70,SIVADES 
          MOVE      SP70,SIPCGST 
          MOVE      SP70,IBGSDESC
          MOVE      ZERO,SIPCGSTA
          MOVE      ZERO,TOTALGST
          MOVE      ZERO,TOTALCST
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Order Detail              
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Order Detail              
.---------------------------------------------------------
WP03L000
          PREP     TEMPWORD,FILSIPD1
          PACK     KEY13,SIPCPON,SIPCITM,SP70
          MOVE     KEY13,SAVKEY80
          SETLPTR  SAVKEY80,10
          CALL      RDSIPD1 
          IF        OVRCD=0
            CALL      RPSIPD1 
          ENDIF
WP03L100
          CALL     RKSIPD1 
          BRANCH   OVRCD,WP03L105
          PACK     KEY13,SIPDPON,SIPDITM,SIPDLIN
          MATCH    SAVKEY80,KEY13   
          GOTO     WP03L105 IF NOT EQUAL
          PACK     VAR,SIPDCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIPDCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP03L100
WP03L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Order Detail              
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Order Detail              
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Order Detail              
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L101,PS03L102,PS03L103,PS03L104:
                            PS03L105,PS03L106,PS03L107,PS03L108:
                            PS03L109,PS03L110,PS03L111,PS03L112:
                            PS03L113,PS03L114,PS03L115,PS03L116:
                            PS03L117,PS03L118,PS03L119,PS03L120:
                            PS03L999,PS03L999,PS03L121,PS03L122:
                            PS03L123,PS03L124,PS03L125,PS03L126:
                            PS03L999,PS03L999,PS03L999,PS03L127:
                            PS03L128,PS03L129,PS03L130,PS03L131:
                            PS03L132,PS03L133
          GOTO     PS03L999
.
PS03L101
          MOVE      SIPCITM,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      SIPCCST,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      SIPCPRD,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE     FILSIPD1,WORDNAME
          CALL     DISPWORD
          GOTO     PS03L999
.
PS03L105
          MOVE      SIPCWAR,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      SIPCCAT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      SIPCPN,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      SIPCPD,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      SIPCCON,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      SIPCCDT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L111
          MOVE      SIPCSUT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L112
          UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L113
          MOVE      SIPCOQT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L114
          MOVE      UNITCOST,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L115
          MOVE      SIPCUR1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L116
          MOVE      SIPCUR2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L117
          UNPACK    SIPCUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L118
          UNPACK    SIPCUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPCUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L120
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPCUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L121
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L122
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L123
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L124
          MOVE      NOTESIIB,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L125
          MOVE      NOTESIIG,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L126
          MOVE      NOTESIID,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L127
          MOVE      SIVACOD,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L128
          MOVE      SIVADES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L129
          MOVE      SIPCGST,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L130
          MOVE      IBGSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L131
          MOVE      SIPCGSTA,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L132
          MOVE      TOTALGST,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L133
          MOVE      TOTALCST,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Order Detail              
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L006,SF03L104,SF03L105,SF03L106:
                            SF03L006,SF03L006,SF03L107,SF03L108:
                            SF03L109,SF03L110,SF03L111,SF03L112:
                            SF03L113,SF03L114,SF03L115,SF03L116:
                            SF03L006,SF03L117,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L118,SF03L119,SF03L120,SF03L006:
                            SF03L006,SF03L121,SF03L006,SF03L006:
                            SF03L006,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L101,SF03L102,SF03L103:
                            SF03L020,SF03L104,SF03L105,SF03L106:
                            SF03L020,SF03L020,SF03L107,SF03L108:
                            SF03L109,SF03L110,SF03L111,SF03L112:
                            SF03L113,SF03L114,SF03L115,SF03L116:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L121,SF03L020,SF03L020:
                            SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SICADESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOST000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L101
            ENDIF
            BRANCH    EXIT,SF03L101,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SIPCCST,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   24",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SICADESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L102
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SISADESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPROD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L102
            ENDIF
            BRANCH    EXIT,SF03L102,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SIPCPRD,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SISADESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L103
          CALL      NOWP0000
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     " 19",SCPSCOL
              MOVE     " 60",SCPSLEN
              MOVE     "12",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIPD1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIPD1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SF03L001
.
SF03L104
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIIADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIVACOD 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIVADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECATA000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L104
            ENDIF
            BRANCH    EXIT,SF03L104,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SIPCCAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   23",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIVACOD,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIVADES,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPART000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L105
            ENDIF
            BRANCH    EXIT,SF03L105,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SIPCPN,VAR       
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPDES000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L106
            ENDIF
            BRANCH    EXIT,SF03L106,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SIPCPD,VAR       
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUNIT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L107
            ENDIF
            BRANCH    EXIT,SF03L107,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SIPCSUT,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EEXDT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L108
            ENDIF
            BRANCH    EXIT,SF03L108,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L109
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EQTY0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L109
            ENDIF
            BRANCH    EXIT,SF03L109,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SIPCOQT,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L110
.
.
          MOVE      "   36",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIPCGSTA
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   37",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOTALGST
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOTALCST
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPRIC000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L110
            ENDIF
            BRANCH    EXIT,SF03L110,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      UNITCOST,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   36",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIPCGSTA,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   37",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOTALGST,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOTALCST,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L111
          CALL     SELECTED
          STRIP     SIPCUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPCUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPCUR1 
          SFORMAT   VAR,127
          ENDSET    SIPCUR1 
          APPEND    SP70,SIPCUR1 
          RESET     SIPCUR1 
          CMATCH    EXITCHAR,SIPCUR1 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPCUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L111
            ENDIF
          ENDIF
          MOVE      SIPCUR1,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L112
          CALL     SELECTED
          STRIP     SIPCUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIPCUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIPCUR2 
          SFORMAT   VAR,127
          ENDSET    SIPCUR2 
          APPEND    SP70,SIPCUR2 
          RESET     SIPCUR2 
          CMATCH    EXITCHAR,SIPCUR2 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIPCUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L112
            ENDIF
          ENDIF
          MOVE      SIPCUR2,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L113
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIPCUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIPCUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L114
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIPCUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIPCUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L115
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIPCUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPCUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L116
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIPCUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPCUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L117
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SCREEN04
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF03L001
.
SF03L118
          CALL      CAN30000
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L119
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DEL30000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF03L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF03L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF03L999
          ENDIF
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF03L000
          ENDIF
          GOTO      SF03L001
.
SF03L120
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      POS30000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF03L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF03L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF03L999
          ENDIF
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF03L000
          ENDIF
          GOTO      SF03L001
.
SF03L121
.
.
          MOVE      "   35",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,IBGSDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EGSTC000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L121
            ENDIF
            BRANCH    EXIT,SF03L121,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SIPCGST,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   35",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      IBGSDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
SF03L990  MOVE      FOUR,EXIT * Exit Char Exit
SF03L999  RETURN
.--------------------------------
. Screen - Catalog Information Screen         
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   65",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Catalog Information Screen         
.-------------------------------------------------------
CF04L000
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Catalog Information Screen         
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Catalog Information Screen         
.---------------------------------------------------------
WP04L000
          PREP     TEMPWORD,FILSIIB1
          PACK     KEY10,SIIACAT,SP70
          MOVE     KEY10,SAVKEY80
          SETLPTR  SAVKEY80,7 
          CALL      RDSIIB1 
          IF        OVRCD=0
            CALL      RPSIIB1 
          ENDIF
WP04L100
          CALL     RKSIIB1 
          BRANCH   OVRCD,WP04L105
          PACK     KEY10,SIIBCAT,SIIBLIN
          MATCH    SAVKEY80,KEY10   
          GOTO     WP04L105 IF NOT EQUAL
          PACK     VAR,SIIBCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIBCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP04L100
WP04L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILSIIG1
          PACK     KEY15,SIIACAT,SIPCWAR,SP70
          MOVE     KEY15,SAVKEY80
          SETLPTR  SAVKEY80,12
          CALL      RDSIIG1 
          IF        OVRCD=0
            CALL      RPSIIG1 
          ENDIF
WP04L110
          CALL     RKSIIG1 
          BRANCH   OVRCD,WP04L115
          PACK     KEY15,SIIGCAT,SIIGWAR,SIIGLIN
          MATCH    SAVKEY80,KEY15   
          GOTO     WP04L115 IF NOT EQUAL
          PACK     VAR,SIIGCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIGCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP04L110
WP04L115  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILSIID1
          PACK     KEY15,SIIACAT,SIPASUP,SP70
          MOVE     KEY15,SAVKEY80
          SETLPTR  SAVKEY80,12
          CALL      RDSIID1 
          IF        OVRCD=0
            CALL      RPSIID1 
          ENDIF
WP04L120
          CALL     RKSIID1 
          BRANCH   OVRCD,WP04L125
          PACK     KEY15,SIIDCAT,SIIDSUP,SIIDLIN
          MATCH    SAVKEY80,KEY15   
          GOTO     WP04L125 IF NOT EQUAL
          PACK     VAR,SIIDCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIDCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP04L120
WP04L125  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Catalog Information Screen         
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Catalog Information Screen         
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Catalog Information Screen         
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L101,PS04L102:
                            PS04L103,PS04L104,PS04L105,PS04L106:
                            PS04L107,PS04L108,PS04L109,PS04L110:
                            PS04L111,PS04L112,PS04L113,PS04L114:
                            PS04L115,PS04L116,PS04L117,PS04L118:
                            PS04L119,PS04L120,PS04L121,PS04L122:
                            PS04L123,PS04L124,PS04L125,PS04L126:
                            PS04L127,PS04L128,PS04L129,PS04L130:
                            PS04L131,PS04L132,PS04L133,PS04L134:
                            PS04L135,PS04L136,PS04L137,PS04L138:
                            PS04L139,PS04L140,PS04L141,PS04L142:
                            PS04L143,PS04L144,PS04L145,PS04L146:
                            PS04L147,PS04L148,PS04L149,PS04L150:
                            PS04L151,PS04L152,PS04L153,PS04L154:
                            PS04L155,PS04L156,PS04L157,PS04L158:
                            PS04L159,PS04L160,PS04L161,PS04L162:
                            PS04L999,PS04L999
          GOTO     PS04L999
.
PS04L101
          MOVE      SIIACAT,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L105
          MOVE      SIIASTI,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L106
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L107
          MOVE      SIIANAT,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L108
          MOVE      SIIAABC,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L109
          MOVE      SIIAPSC,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAREX,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L111
          MOVE      YES,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIANON,FORM2    
          LOAD      YESNO,FORM2,NO
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIASAB,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L113
          MOVE      SIIAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L114
          MOVE      SIIAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L115
          UNPACK    SIIAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L116
          UNPACK    SIIAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L117
          MOVE      SIIAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L118
          MOVE      SIIAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L120
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L121
          MOVE      SIIEWAR,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L122
          MOVE      SIIESID,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L123
          MOVE      SIIERAS,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L124
          MOVE      SIIESOH,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L125
          MOVE      SIIEROQ,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L126
          MOVE      SIIEROL,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L127
          UNPACK    SIIESTD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L128
          MOVE      SIIEABC,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L129
          MOVE      SIIEUR1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L130
          MOVE      SIIEUR2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L131
          MOVE      SIIEUC1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L132
          MOVE      SIIEUC2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L133
          UNPACK    SIIEUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L134
          UNPACK    SIIEUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L135
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIEUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L136
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIEUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L137
          MOVE      SIICSUP,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L138
          MOVE      SIICSUT,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L139
          MOVE      SIICCCT,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L140
          MOVE      SIICLCT,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L141
          MOVE      SIICLTM,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L142
          MOVE      SIICPNO,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L143
          MOVE      SIICPD1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L144
          MOVE      SIICPD2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L145
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICMAN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L146
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICAPO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L147
          MOVE      SIICUR1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L148
          MOVE      SIICUR2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L149
          UNPACK    SIICUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L150
          UNPACK    SIICUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L151
          MOVE      SIICUC1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L152
          MOVE      SIICUC2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L153
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L154
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L155
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L156
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L157
          MOVE      NOTESIIB,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L158
          MOVE      NOTESIIG,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L159
          MOVE      NOTESIID,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L160
          MOVE     FILSIIB1,WORDNAME
          CALL     DISPWORD
          GOTO     PS04L999
.
PS04L161
          MOVE     FILSIIG1,WORDNAME
          CALL     DISPWORD
          GOTO     PS04L999
.
PS04L162
          MOVE     FILSIID1,WORDNAME
          CALL     DISPWORD
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Catalog Information Screen         
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L101,SF04L102,SF04L103:
                            SF04L006,SF04L104
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L101,SF04L102,SF04L103:
                            SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 4",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     " 3",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIIB1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIIB1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF04L001
.
SF04L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "10",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     " 3",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIIG1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIIG1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF04L001
.
SF04L103
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "18",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     " 3",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIID1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIID1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF04L001
.
SF04L104
          MOVE      ZERO,EXIT
          GOTO      SF04L999
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.--------------------------------
. Screen - Enter Supplier/Catalog Details     
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 9",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC05L200
          CALL      CF05L000 * Clear Fields
          CALL      SETACCEP
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Enter Supplier/Catalog Details     
.-------------------------------------------------------
CF05L000
          MOVE      SP70,SIPCSUT 
          MOVE      ZERO,SIICCCT 
          MOVE      ZERO,SIICLCT 
          MOVE      ZERO,SIICLTM 
          MOVE      SP70,SIICPNO 
          MOVE      SP70,SIICPD1 
          MOVE      SP70,SIICPD2 
          MOVE      ZERO,SIICMAN 
          MOVE      ZERO,SIICAPO 
          MOVE      SP70,SIICUR1 
          MOVE      SP70,SIICUR2 
          MOVE      SP70,SIICUD1 
          MOVE      SP70,SIICUD2 
          MOVE      SP70,SIICUC1 
          MOVE      SP70,SIICUC2 
          MOVE      SP70,SIICUY1 
          MOVE      SP70,SIICUY2 
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Enter Supplier/Catalog Details     
.--------------------------------------------------------
KY05L000
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Enter Supplier/Catalog Details     
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Enter Supplier/Catalog Details     
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Enter Supplier/Catalog Details     
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Enter Supplier/Catalog Details     
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L101,PS05L999,PS05L102,PS05L103:
                            PS05L104,PS05L105,PS05L106,PS05L107:
                            PS05L108,PS05L999,PS05L999,PS05L109:
                            PS05L110,PS05L111,PS05L112,PS05L113:
                            PS05L114,PS05L115,PS05L116,PS05L117:
                            PS05L118,PS05L119,PS05L120,PS05L121:
                            PS05L122,PS05L123,PS05L124,PS05L125:
                            PS05L126,PS05L127,PS05L999,PS05L999:
                           PS05L999,PS05L999,PS05L999,PS05L999:
                            PS05L999,PS05L999,PS05L999,PS05L128:
                            PS05L129,PS05L130
          GOTO     PS05L999
.
PS05L101
          MOVE      SIPCSUT,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L103
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L104
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L105
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIANON,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L107
          MOVE      SIIASUS,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L108
          MOVE      SUSPDESC,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L109
          MOVE      SIICCCT,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L110
          MOVE      SIICLCT,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L111
          MOVE      SIICLTM,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L112
          MOVE      SIICPNO,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L113
          MOVE      SIICPD1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L114
          MOVE      SIICPD2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICMAN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L116
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICAPO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L117
          MOVE      SIICUR1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L118
          MOVE      SIICUR2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L119
          UNPACK    SIICUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L120
          UNPACK    SIICUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L121
          MOVE      SIICUC1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L122
          MOVE      SIICUC2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L123
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L124
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L125
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L126
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L127
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L128
          MOVE      SAVECATA,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L129
          MOVE      SAVECRED,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L130
          MOVE      SAVEUNIT,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Enter Supplier/Catalog Details     
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L101,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L102:
                            SF05L103,SF05L104,SF05L105,SF05L106:
                            SF05L107,SF05L108,SF05L109,SF05L110:
                            SF05L111,SF05L112,SF05L113,SF05L114:
                            SF05L115,SF05L116,SF05L117,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                           SF05L006,SF05L118,SF05L006,SF05L119:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L101,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L102:
                            SF05L103,SF05L104,SF05L105,SF05L106:
                            SF05L107,SF05L108,SF05L109,SF05L110:
                            SF05L111,SF05L112,SF05L113,SF05L114:
                            SF05L115,SF05L116,SF05L117,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                           SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
.
SF05L101
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSIFA000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L101
            ENDIF
            BRANCH    EXIT,SF05L101,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      SIPCSUT,VAR      
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L102
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SIICCCT 
          IF        SCPSMAN=1
            COMPARE   ZERO,SIICCCT 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L102
            ENDIF
          ENDIF
          MOVE      SIICCCT,VAR      
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L103
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SIICLCT 
          IF        SCPSMAN=1
            COMPARE   ZERO,SIICLCT 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L103
            ENDIF
          ENDIF
          MOVE      SIICLCT,VAR      
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L104
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SIICLTM 
          IF        SCPSMAN=1
            COMPARE   ZERO,SIICLTM 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L104
            ENDIF
          ENDIF
          MOVE      SIICLTM,VAR      
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L105
          CALL     SELECTED
          STRIP     SIICPNO 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIICPNO,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIICPNO 
          SFORMAT   VAR,127
          ENDSET    SIICPNO 
          APPEND    SP70,SIICPNO 
          RESET     SIICPNO 
          CMATCH    EXITCHAR,SIICPNO 
          GOTO      SF05L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIICPNO 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L105
            ENDIF
          ENDIF
          MOVE      SIICPNO,VAR      
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L106
          CALL      DEFPTD00
          CALL     SELECTED
          STRIP     SIICPD1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIICPD1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIICPD1 
          SFORMAT   VAR,127
          ENDSET    SIICPD1 
          APPEND    SP70,SIICPD1 
          RESET     SIICPD1 
          CMATCH    EXITCHAR,SIICPD1 
          GOTO      SF05L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIICPD1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L106
            ENDIF
          ENDIF
          MOVE      SIICPD1,VAR      
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L107
          CALL     SELECTED
          STRIP     SIICPD2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIICPD2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIICPD2 
          SFORMAT   VAR,127
          ENDSET    SIICPD2 
          APPEND    SP70,SIICPD2 
          RESET     SIICPD2 
          CMATCH    EXITCHAR,SIICPD2 
          GOTO      SF05L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIICPD2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L107
            ENDIF
          ENDIF
          MOVE      SIICPD2,VAR      
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L108
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIICMAN 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICMAN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L109
          CALL      DEFAULTY
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIICAPO 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICAPO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L110
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UDC1DESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          STRIP     SIICUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIICUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIICUR1 
          SFORMAT   VAR,127
          ENDSET    SIICUR1 
          APPEND    SP70,SIICUR1 
          RESET     SIICUR1 
          CMATCH    EXITCHAR,SIICUR1 
          GOTO      SF05L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIICUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L110
            ENDIF
          ENDIF
          MOVE      SIICUR1,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UDC1DESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
.
SF05L111
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UDC2DESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          STRIP     SIICUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIICUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIICUR2 
          SFORMAT   VAR,127
          ENDSET    SIICUR2 
          APPEND    SP70,SIICUR2 
          RESET     SIICUR2 
          CMATCH    EXITCHAR,SIICUR2 
          GOTO      SF05L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIICUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L111
            ENDIF
          ENDIF
          MOVE      SIICUR2,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UDC2DESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
.
SF05L112
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIICUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIICUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L113
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIICUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIICUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L114
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOD1000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L114
            ENDIF
            BRANCH    EXIT,SF05L114,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      SIICUC1,VAR      
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L115
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOD2000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L115
            ENDIF
            BRANCH    EXIT,SF05L115,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      SIICUC2,VAR      
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L116
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIICUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L117
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIICUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L118
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L119
          CALL      P05D0000
          MOVE      ZERO,EXIT
          GOTO      SF05L999
SF05L990  MOVE      FOUR,EXIT * Exit Char Exit
SF05L999  RETURN
.@@@@@ Function Restart Point @@@@@
. ------------------------------------------------------------
. Read Catalog Code Keyin Control Information
.
. INCOCATE  FORM      1         67      Catalog Code Type
. 0 Normal Keyin,   1 *JR *DE,   2 Generated ,  3 Generated with Check Digit
.------------------------------------------------------------
RINCOCAT  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*67,INCOCATE
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCOCATE
            WRITAB    CONTROLF,SIXTY3;*67,INCOCATE
          ENDIF
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,TWENTY6;*247,HPOWHDFT
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,HPOWHDFT
            WRITAB    CONTROLF,TWENTY6;*247,HPOWHDFT
          ENDIF
.
          READ      CONTROLF,TWENTY5;HADEL1,HADEL2,HADEL3,HADEL4:
                                     HADEL5,HADEL6,HADEL7,HADEL8
          READ      CONTROLF,TWENTY6;*248,HPURCHP
          READ      CONTROLF,SIXTY3;*240,SNCOPURC
          RETURN
.----------------------------------------------------------------------
. HACCNT    FORM 1  Running the Accounting System          0=No
. HACCDATA  DIM  20 General Ledger Data Directory
. HDEFWH    DIM  5  Default Warehouse for Non Stock Items
. HORDDES   DIM  1  Order Number Alhpa Prefix
.----------------------------------------------------------------------
RDCON000  MOVE      ONE,CEAFILE
          READ      CONTROLF,TWENTY3;*95,HACCNT,*124,HORDDES:
                                    *143,HDEFWH
          READ      CONTROLF,TWENTY4;*135,HACCDATA,*165,HLASTCIN
          COMPARE   ONE,HACCNT
          GOTO      RDCON999 IF NOT EQUAL
.
.---- GL interface is on ----
.
          CLOSE     CONTROLF           * get gl control file if possible
          MOVE      "controlf.txt",KEY12
          PACK      KEY80,HACCDATA,KEY12
          SQUEEZE   KEY80
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CONTROLF,KEY80
          TRAPCLR   IO
          IF        OVRCD=1
            OPEN      CONTROLF,"controlf"
          ENDIF
.
          CALL      RDFMCO50           * Read Account Code Parameters
          CALL      RDFMCO51
          CALL      RDFMCO52
          CALL      RDFMCO65
          CLOSE     CONTROLF
          OPEN      CONTROLF,"controlf"
.
          UNPACK  SP70,SIPESDT  ** Fix strange corruption of SIPESDT at Mercy **
          CLEAR     SIPESDT
          DISPLAY   *P80:3,*+,SIPESDT
.
          MOVE      "fmsamaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSAMAA1,KEY80
.
          MOVE      "fmslmaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSLMAA1,KEY80
.
          MOVE      "fmslmcaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSLMCA1,KEY80
.
          MOVE      "fmscsaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSCSAA1,KEY80
.
          MOVE      "fmstupaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSTUPA1,KEY80
.
          MOVE      ZERO,OVRCD
          MOVE      "apscioaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          TRAP      OVERCOND IF IO
          OPEN      APSCIOA1,KEY80
          TRAPCLR   IO
.
          MOVE      ZERO,OVRCD
          MOVE      "apsordaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          TRAP      OVERCOND IF IO
          OPEN      APSORDA1,KEY80
          TRAPCLR   IO
.
          MOVE      ZERO,OVRCD
          MOVE      "apsceaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          TRAP      OVERCOND IF IO
          OPEN      APSCEAA1,KEY80
          TRAPCLR   IO
.
          MOVE      "apscebaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          TRAP      OVERCOND IF IO
          OPEN      APSCEBA1,KEY80
          TRAPCLR   IO
          MOVE      OVRCD,CEAFILE
.
RDCON999  CALL      ONAT0000                 * Open Nato File
          CALL      CSIWS000                 * check warehouse security
          RETURN
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
.----------------------------------------------------------------------
. Check warehouse security
. Returns SECSIWS : 0 = no access to any warehouse
.                   1 = access to one warehouse
.                   2 = access to more than one warehouse
.                   3 = access to all warehouse(Not Applicable - for future use)
.----------------------------------------------------------------------
..                                            * (for future use)
..CSIWS000  MOVE      "3",SECSIWS             * default to all warehouse's
.
..          PACK      KEY9,SP70               * any security set up ???
..          CALL      RSSIWS1
..          CALL      RKSIWS1
..          BRANCH    OVRCD,CSIWS999
.
CSIWS000  MOVE      "0",SECSIWS             * check for no warehouse's
          PACK      KEY9,PASSCODE,SP70
          CALL      RSSIWS1
          CALL      RKSIWS1
          BRANCH    OVRCD,CSIWS999
.
          MATCH     SIWSUID,PASSCODE
          GOTO      CSIWS999 IF NOT EQUAL
.
          MOVE      "1",SECSIWS             * check for one warehouse's
          CALL      RKSIWS1
          BRANCH    OVRCD,CSIWS999
.
          MATCH     SIWSUID,PASSCODE
          GOTO      CSIWS999 IF NOT EQUAL
.
          MOVE      "2",SECSIWS             * more than one warehouse
.
CSIWS999  RETURN
.
.
GENORD00  MOVE      ZERO,OPT50
          DISPLAY   *P66:2,*V2LON," Input ",*HOFF;    * display program option
.
          CALL      SCREEN01
          CALL      CF01L000 * Clear Fields
.
          MOVE      "New    ",SIPAPON
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      "New    ",VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      ONE,ACCEPT
          CALL      SF01L000 * Select Fields
          CALL      UUSIPA1
          BRANCH    EXIT,GENORD00,GENORD00,GENORD00
          CALL      DISPHEAD
.
GENORD99  RETURN
.
SCREEN01  MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
          CLOSE     APSMASA1           * close & open to stop "I*M 024"
          PREP      TEMPWORD,FILSIPB1
          CLOSE     TEMPWORD
          OPEN      APSMASA1,"apsmasaf"
          RETURN
.
SELORD00  MOVE      ONE,OPT50
          DISPLAY   *P66:2,*V2LON," Input ",*HOFF;    * display program option
.
          CALL      SCREEN01
          CALL      CF01L000 * Clear Fields
.
          READ      CONTROLF,TWENTY4;*121,HSTRORD,HFINORD
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. - ",DISPMSG
            BEEP
            CALL      DISPITEM
            GOTO      FATALERR
          ENDIF
.
SELORD10  MOVE      SP70,VAR
          CALL      DISPITEM
          MOVE      ONE,CKEYTYP
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,ORDERNO
          COMPARE   ZERO,ORDERNO
          GOTO      SELORD90 IF EQUAL
          MOVE      ORDERNO,VAR
          CALL      DISPITEM
.
          IF        ORDERNO>HFINORD|ORDERNO<HSTRORD
            MOVE      "Purchase Order No. NOT Manual Order Range - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      SELORD10
          ENDIF
.
          MOVE      ORDERNO,KEY7
          CALL      RASIPA1
          IF        OVRCD=0
            MOVE      "Purchase Order Number Already Exists - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      SELORD10
          ENDIF
.
          MOVE      ORDERNO,SIPAPON
          MOVE      ONE,ACCEPT
          CALL      SF01L000 * Select Fields
          CALL      UUSIPA1
          GOTO      SELORD00
.
SELORD90  CALL      DISPHEAD
          GOTO      SELORD99
.
SELORD99  RETURN
.
MODORD00  MOVE      TWO,OPT50
          DISPLAY   *P66:2,*V2LON," Modify ",*HOFF;    * display program option
.
          CALL      SCREEN01
          CALL      CF01L000 * Clear Fields
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. - ",DISPMSG
            BEEP
            CALL      DISPITEM
            GOTO      FATALERR
          ENDIF
.
MODORD10  MOVE      SP70,VAR
          CALL      DISPITEM
          MOVE      ZERO,CKEYTYP
          CALL      KSIPAA00
          BRANCH    EXIT,MODORD90,MODORD90
.
          MOVE      SIPAPON,KEY7
          MOVE      SIPAPON,ORDERNO
          CALL      RLSIPA1
          IF        OVRCD=1
            MOVE      "Purchase Order Does Not Exist. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      MODORD10
          ENDIF
.
          IF        OVRCD=2
            MOVE      "Purchase Order Locked. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      MODORD10
          ENDIF
.
. check warehouse security
.
          MATCH     SP70,SIPAWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIPAWAR,SP70
            CALL      RDSIWS1
            IF        OVRCD=1
              CLEAR     DISPMSG
              APPEND    "You have no access for Warehouse ",DISPMSG
              APPEND    SIPAWAR,DISPMSG
              APPEND    " - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      MODORD90
            ENDIF
          ENDIF
.
          MOVE      TWO,AUDTTYPE
          CALL      WASIPA00       * Audit Before Change
.
          MOVE      ZERO,CKORDFLG
          CALL      VALORD00       * Validate Order Number
          BRANCH    EXIT,MODORD10
.
          CALL      WP01L000
          MOVE      ZERO,ACCEPT
.
          CALL      DF01L000 * Display Fields
          CALL      SF01L000 * Select Fields
          CALL      UUSIPA1
          GOTO      MODORD00
.
MODORD90  CALL      DISPHEAD
          GOTO      MODORD99
.
MODORD99  RETURN
.
VALORD00  PACK      CURRSUPP,SIPASUP,SP70
          MOVE      ZERO,EXIT
          MATCH     SP70,SIPADCN
          IF        !(@EQUAL)
            UNPACK    SIPADCN,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            CLEAR     DISPMSG
            APPEND    "Purchase Order Cancelled on ",DISPMSG
            APPEND    CPCDATE,DISPMSG
            APPEND    " - ",DISPMSG
            RESET     DISPMSG
            BEEP
            CALL      MESSAGE1
            CALL      UUSIPA1
            MOVE      ONE,EXIT
            GOTO      VALORD99
          ENDIF
.
..........MATCH     SP70,SIPADCM
..........IF        !(@EQUAL)
..........  UNPACK    SIPADCM,CCENT,CYEAR,CMON,CDAY
..........  CALL      PACDATE
..........  CLEAR     DISPMSG
..........  APPEND    "Purchase Order Completed on ",DISPMSG
..........  APPEND    CPCDATE,DISPMSG
..........  APPEND    " - ",DISPMSG
..........  RESET     DISPMSG
..........  BEEP
..........  CALL      MESSAGE1
..........  CALL      UUSIPA1
..........  MOVE      ONE,EXIT
..........  GOTO      VALORD99
..........ENDIF
.
          IF        CKORDFLG=1
            PACK      KEY12,SIPAPON,SP70
            CALL      RSSIPF1
            CALL      RKSIPF1
            BRANCH    OVRCD,VALORD10
            MATCH     SIPFPON,SIPAPON
            GOTO      VALORD10 IF NOT EQUAL
            MOVE      "Goods Already Received for That Order. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            CALL      UUSIPA1
            MOVE      ONE,EXIT
            GOTO      VALORD99
          ENDIF
.
VALORD10
          MATCH     SP70,SIPADPR
          IF        !(@EQUAL)
            UNPACK    SIPADPR,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            CLEAR     DISPMSG
            APPEND    "WARNING: Purchase Order Printed on ",DISPMSG
            APPEND    CPCDATE,DISPMSG
            APPEND    " - ",DISPMSG
            RESET     DISPMSG
            BEEP
            CALL      MESSAGE1
          ENDIF
.
          MOVE      SIPAWAR,KEY5
          CALL      RDSIWA1
          IF        OVRCD=0
            MOVE      SIPAWAR,DEFTWARE
            GOTO      VALORD40
          ENDIF
.
          PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPC1
.
VALORD20  CALL      RKSIPC1
          BRANCH    OVRCD,VALORD30
          MATCH     SIPCPON,SIPAPON
          GOTO      VALORD30 IF NOT EQUAL
          MATCH     SP70,SIPCWAR
          GOTO      VALORD20 IF EQUAL
          MOVE      SIPCWAR,DEFTWARE
          MOVE      SIPCWAR,KEY5
          CALL      RDSIWA1
          BRANCH    OVRCD,VALORD20
          GOTO      VALORD40
.
VALORD30  MOVE      "N/A  ",SIWAWAR
          MOVE      SP70,SIWADES
          MOVE      SP70,DEFTWARE
.
VALORD40  MOVE      SIPAORI,KEY3
          CALL      RDSIOR1
.
          MOVE      SP70,SICADESC
          MOVE      SIPACST,KEY5
          CALL      RDSICA1
.
          MOVE      SIPASUP,KEY5
          CALL      RDAPMA1
.
          MATCH     SP70,SIPAMES
          GOTO      VALORD50 IF EQUAL
          MOVE      "ME ",SICDCATA
          PACK      KEY6,SICDCATA,SIPAMES
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,MESSDESC
          ENDIF
.
VALORD50  MATCH     SP70,SIPACON
          GOTO      VALORD60 IF EQUAL
          MOVE      "CF ",SICDCATA
          PACK      KEY6,SICDCATA,SIPACON
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,CONFDESC
          ENDIF
VALORD60
          MOVE      SIPADIN,SIPEDATE
          CALL      RSIPE000
          IF        OVRCD=1
            MOVE      "WARNING. Invalid Period Date. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
          ENDIF
          IF        SIPELOC=1
            MOVE      "WARNING. Period Has Been LOCKED. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
....            MOVE      ONE,EXIT  * Removed for SRF620773
          ENDIF
.
VALORD99  RETURN
.
CANORD00  DISPLAY   *P66:2,*V2LON," Cancel ",*HOFF;    * display program option
.
          CALL      SCREEN01
          CALL      CF01L000 * Clear Fields
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. - ",DISPMSG
            BEEP
            CALL      DISPITEM
            GOTO      FATALERR
          ENDIF
.
CANORD10  MOVE      SP70,VAR
          CALL      DISPITEM
          MOVE      ZERO,CKEYTYP
          CALL      KSIPAA00
          BRANCH    EXIT,CANORD90,CANORD90
.
          MOVE      SIPAPON,KEY7
          MOVE      SIPAPON,ORDERNO
          CALL      RLSIPA1
          IF        OVRCD=1
            MOVE      "Purchase Order Does Not Exist. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      CANORD10
          ENDIF
          IF        OVRCD=2
            MOVE      "Purchase Order Locked. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      CANORD10
          ENDIF
.
. check warehouse security
.
          MATCH     SP70,SIPAWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIPAWAR,SP70
            CALL      RDSIWS1
            IF        OVRCD=1
              CLEAR     DISPMSG
              APPEND    "You have no access for Warehouse ",DISPMSG
              APPEND    SIPAWAR,DISPMSG
              APPEND    " - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      CANORD90
            ENDIF
          ENDIF
.
          MOVE      ONE,CKORDFLG
          CALL      VALORD00 * Validate Order
          BRANCH    EXIT,CANORD10
.
          CALL      WP01L000
          MOVE      ZERO,ACCEPT
.
          CALL      DF01L000 * Display Fields
.
          DISPLAY   *P1:24,*EL,"Correct Order to Cancel (":
                    *V2LON,"Y",*HOFF,"/":
                    *V2LON,"N",*HOFF,") ? ";
          MOVE      "33",CCOL
          MOVE      "24",CVERT
          CALL      YORN0000
.
          COMPARE   ONE,FYESNO
          GOTO      CANORD00 IF NOT EQUAL
.
          PACK      SIPADCN,CCC,CYY,CMM,CDD
          REP       " 0",SIPADCN
          MATCH     SP70,SIPADPR
          IF        @EQUAL
            PACK      SIPADPR,SIPADCN,SP70
          ENDIF
          PACK      SIPADCM,CCC,CYY,CMM,CDD
          REP       " 0",SIPADCM
          CALL      CLBLS000           * Clear Transmit Data if Transmit Data
          CALL      UPSIPA1
          MOVE      SEQ,OPTIONA        * 1=adding usage, -1=subtracting usage
          CALL      ADDUS000
          CALL      UUSIPA1
.
          CALL      CSPC0000           * clear line items next del date
.
          CALL      CEBA0000
.
          PACK      KEY7,SIPAPON
          CALL      RDSIRP1
          IF        OVRCD=0
            CALL      DESIRP1
          ENDIF
          GOTO      CANORD00
.
CANORD90  CALL      DISPHEAD
          GOTO      CANORD99
.
CANORD99  RETURN
.**********************************************************************
.  CLBLS - Clear Transmit Data if a Transmit Order       Called By ML
.**********************************************************************
CLBLS000  PACK      KEY7,SIPAPON,SP70
          CALL      RDSITR1
          BRANCH    OVRCD,CLBLS1000
.
          CALL      DESITR1
.
          PACK      KEY46SAV,SP10,SP3,SIPAPON,SP70
.
CLBLS100  CALL      RSSIVH3
          CALL      RKSIVH3
          BRANCH    OVRCD,CLBLS999
.
          MATCH     SIVHORD,KEY46SAV
          GOTO      CLBLS999 IF NOT EQUAL
.
          PACK      KEY46,SIVHORD,SIVHCOR,SIVHCAT,SIVHDAT,SIVHFNO,SIVHLIN,SP70
          CALL      DESIVH3
          GOTO      CLBLS100
.
CLBLS999  RETURN
.**********************************************************************
.  CSPC - Clear Next del date on sinpocaf              Called By ML
.**********************************************************************
CSPC0000  PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPC1
.
CSPC1000  CALL      RKSIPC1
          BRANCH    OVRCD,CSPC9999
          MATCH     SIPAPON,SIPCPON
          GOTO      CSPC9999 IF NOT EQUAL
.
          MOVE      SP70,SIPCEDD
          CALL      UPSIPC1
          GOTO      CSPC1000
.
CSPC9999  RETURN
.**********************************************************************
.  CEBA - Clear Comitted expenditure
.**********************************************************************
CEBA0000  PACK      KEY8,HORDDES,SIPAPON,SP70
          CALL      RDAPEA1
          BRANCH    OVRCD,CEBA1000
.
          CALL      DEAPEA1
.
CEBA1000  PACK      KEY14,HORDDES,SIPAPON,SP70
          CALL      RSAPEB1
.
          CALL      RKAPEB1
          BRANCH    OVRCD,CEBA9999
          MATCH     HORDDES,APEBISC
          GOTO      CEBA9999 IF NOT EQUAL
          MATCH     SIPAPON,APEBORD
          GOTO      CEBA9999 IF NOT EQUAL
.
          PACK      KEY14,APEBISC,APEBORD,APEBCAT,SP70
          CALL      DEAPEB1
          GOTO      CEBA1000
.
CEBA9999  RETURN
.----------------------------------------------------------------------
. Set up screen 01
.----------------------------------------------------------------------
SETSCR01
          MOVE      SP70,SIPACST            * clear default cost centre
          CALL      DISPHEAD
          DISPLAY   *P66:2," Input ";       * display program option
          RETURN
.------------------------------------------------------------------------
. Get Codes File Description
.------------------------------------------------------------------------
RDCOD000  PACK      KEY6,ANSP,ANSN,ANST,SIPAPNT
          CALL      RDSICD1
          IF        OVRCD<>0
            MOVE      SP70,SICDDESC
          ENDIF
.
RDCOD999  RETURN
CMDP0000  READ      CONTROLF,SIXTY3;*241,SNCOMDPC
          COMPARE   ONE,SNCOMDPC
          IF        @EQUAL
            MOVE      SIPAMDP,KEY3
            CALL      RDSIDP1
            IF        OVRCD<>1
              PACK      DELVCODE,SIPAMDP,SP3,SIDPADD1,SP70
              MOVE      SIDPADD2,DELVDESC
            ENDIF
          ELSE
            PACK      DELVCODE,SIPADEL,SP70
          ENDIF
CMDP9999  RETURN
.
.----------------------------------------------
. Enter Originator Code
.----------------------------------------------
EORIG000  MOVE      ZERO,CKEYTYP
          CALL      KSIORA00
          BRANCH    EXIT,EORIG999,EORIG999
.
          MOVE      SIORORIG,SIPAORI
          MOVE      SIORHOSP,SIPAICN
.
          MOVE      SIORDEL,F1
          LOAD      DIM30,F1,HADEL1,HADEL2,HADEL3,HADEL4:
                             HADEL5,HADEL6,HADEL7,HADEL8
          PACK      SIPADEL,DIM30,SP10
          IF        HPURCHP=6
            IF         F1 >=1 & F1 <6
              MOVE       SIORDEL,SIPAPNT
            ELSE
              MOVE       "6",SIPAPNT
              PACK       SIPADEL,SP70
            ENDIF
          ENDIF
.
          IF        HPURCHP=16
            MOVE      F1,SIPAPNT
            IF        F1 >=1 & F1 <9
              MOVE      SIORDEL,SIPAPNT
            ELSE
              MOVE      "0",SIPAPNT
              PACK      DIM30,HADEL3,SP70
            ENDIF
          ENDIF
.
          MOVE      SIORMESS,SIPAMES
          MOVE      SIORCON,SIPACON
          MOVE      SP70,MESSDESC
          MOVE      SP70,CONFDESC
          MATCH     SP70,SIORMESS
          IF        !(@EQUAL)
            MOVE      "ME ",SICDCATA
            PACK      KEY6,SICDCATA,SIPAMES
            CALL      RDSICD1
            IF        OVRCD=0
              MOVE      SICDDESC,MESSDESC
            ENDIF
          ENDIF
          MATCH     SP70,SIORCON
          IF        !(@EQUAL)
            MOVE      "CF ",SICDCATA
            PACK      KEY6,SICDCATA,SIPACON
            CALL      RDSICD1
            IF        OVRCD=0
              MOVE      SICDDESC,CONFDESC
            ENDIF
          ENDIF
.
          CALL      DF01L000
          MOVE      "    1",FLDID
          CALL      GETPOSIT
.
EORIG999  RETURN
.
.----------------------------------------------------------------------
. Enter Delivery Point (Multiple or Single, depending on parameter)
.----------------------------------------------------------------------
EDELP000  READ      CONTROLF,SIXTY3;*241,SNCOMDPC
          COMPARE   ONE,SNCOMDPC
          IF        @EQUAL
            CALL        MDPC0000            * using Multiple Delivery Points
            GOTO        EDELP999
          ENDIF
.
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,SIPADEL:
                    *PCCOL:CVERT
          ENDSET    SIPADEL
          APPEND    SP70,SIPADEL
          RESET     SIPADEL
          CMATCH    EXITCHAR,SIPADEL
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      EDELP999
          ENDIF
          MOVE      "0",SIPAPNT
          PACK      SIPAMDP,SP70
          MOVE      SIPADEL,ANS
          MOVE      ZERO,F1
          MOVE      ANS,F1
          BRANCH    F1,EDELP100,EDELP100,EDELP100,EDELP100:
                       EDELP100,EDELP100,EDELP100,EDELP100
          GOTO      EDELP999
.
EDELP100  IF        HPURCHP=6
            MOVE      F1,SIPAPNT
            IF        F1 >=1 & F1 <6
              LOAD      DIM30,F1,HADEL1,HADEL2,HADEL3,HADEL4:
                                 HADEL5
              PACK      SIPADEL,DIM30,SP70
              GOTO      EDELP999
            ELSE
              MOVE      "6",SIPAPNT
            ENDIF
          ENDIF
.
          IF        HPURCHP=16
            MOVE      F1,SIPAPNT
            IF        F1 >=1 & F1 <9
              LOAD      DIM30,F1,HADEL1,HADEL2,HADEL3,HADEL4:
                                 HADEL5,HADEL6,HADEL7,HADEL8
              PACK      SIPADEL,DIM30,SP70
              GOTO      EDELP999
            ELSE
              MOVE      "0",SIPAPNT
              PACK      DIM30,HADEL3,SP70
              GOTO      EDELP999
            ENDIF
          ENDIF
.
          LOAD      DIM30,F1,HADEL1,HADEL2,HADEL3,HADEL4:
                             HADEL5,HADEL6,HADEL7,HADEL8
          PACK      SIPADEL,DIM30,SP70
.
EDELP999  RETURN
.
MDPC0000  MOVE      "   40",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          MOVE     ZERO,CKEYTYP
          CALL     KSIDPA00
          BRANCH   EXIT,MDPC9999,MDPC9999
          COMPARE  ONE,OVRCD
          GOTO     MDPC9999 IF EQUAL
.
MDPC1000  MOVE      SIDPCODE,KEY3
          CALL      RDSIDP1
          BRANCH    OVRCD,MDPC9999
          MOVE      ZERO,EXIT
          MOVE      ZERO,OVRCD
          MOVE      SIDPCODE,SIPAMDP
          PACK      DELVCODE,SIDPCODE,SP3,SIDPADD1
          MOVE      SIDPADD2,DELVDESC
          PACK      SIPADEL,SP70
.
MDPC9999  RETURN
.
.----------------------------------------------
. Enter Message Code
.----------------------------------------------
EMESS000  MOVE        ZERO,CKEYTYP
          MOVE        "ME ",SICDCATA
          MOVE        SP70,MESSDESC
          CALL        KSICDB00
          BRANCH      EXIT,EMESS999,EMESS999
          MOVE        SICDCODE,SIPAMES
          MOVE        SICDDESC,MESSDESC
.
EMESS999  RETURN
.
EORDD000  UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY
          CALL      KEYDATE
          PACK      SIPADIN,CCENT,CYEAR,CMON,CDAY
          REP       " 0",SIPADIN
          MOVE      SIPADIN,SIPEDATE
          CALL      RSIPE000   * Get Period End Date
          IF        OVRCD=1
            MOVE      "Period Not on File. Invalid Date - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      EORDD000
          ENDIF
          IF        SIPELOC=1
            MOVE      "Period Locked. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      EORDD000
          ENDIF
.
          MATCH     SIPEYEAR,SIPECYR
          IF        !(@EQUAL)
            MOVE      "WARNING : Period Not in Current Year. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
          ENDIF
.
EORDD999  RETURN
.----------------------------------------------
. Enter Confirmation Code
.----------------------------------------------
ECONF000  MOVE        ZERO,CKEYTYP
          MOVE        "CF ",SICDCATA
          MOVE        SP70,CONFDESC
          CALL        KSICDB00
          BRANCH      EXIT,ECONF999,ECONF999
          MOVE        SICDCODE,SIPACON
          MOVE        SICDDESC,CONFDESC
.
ECONF999  RETURN
.
CAN10000  IF        OPT50=2
            MOVE      TWO,AUDTTYPE
            CALL      DASIPA00       * Delete Before Change
          ENDIF
          RETURN
.------------------------------------------------------------
. Post Screen Order Header
. OPT50 is Option Choosen from Options
. 0=New Order Generate Order Number
. 1=New Order Selected Order Number
. 2=Update Order
.------------------------------------------------------------
POST0000  BRANCH    OPT50,POST1000,POST0100
          GOTO      POST0500
.
POST0100  CALL      UPSIPA1           * Update Header Record
          MOVE      THREE,AUDTTYPE
          CALL      WASIPA00          * Audit Change
          CALL      POSNOT00          * Post Notes
          CALL      UPUS0000          * update usage if supplier changed
          CALL      UPINT000          * update accounts payable interface
          GOTO      POST3000
.
. Generate Order Number
.-----------------------
POST0500  MOVE      "       ",SIPAPON
          CALL      SINORDNO         * Get Next Order Number
          IF        OVRCD=1
            MOVE      "Unable to Allocate an Order Number - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            MOVE      ONE,EXIT
            GOTO      POST9999
          ENDIF
          DISPLAY   *P1:24,*EL,"Generated Order No. : ",*V2LON,SIPAPON:
                    *HOFF," - ";
          CALL      HITENTER
          MOVE      SIPAPON,KEY7
          CALL      RASIPA1
          IF        OVRCD=0
            GOTO      POST0000
          ELSE
            CALL      WRSIPA1
            CALL      RLSIPA1
            MOVE      ONE,AUDTTYPE
            CALL      WASIPA00                 * Audit Add
          ENDIF
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIPAPON,VAR
            CALL      DISPITEM
          ENDIF
.
          GOTO      POST2000
.
POST1000  MOVE      SIPAPON,KEY7
          CALL      RASIPA1
          IF        OVRCD=0
            MOVE      "Unable to Allocate Order Number - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            MOVE      ONE,EXIT
            GOTO      POST9999
          ELSE
            CALL     WRSIPA1
            CALL     RLSIPA1
            MOVE     ONE,AUDTTYPE
            CALL     WASIPA00               * Audit Add
          ENDIF
.
POST2000  CALL      POSNOT00                * Post Notes
.
          PACK      KEY7,SIPAPON
          CALL      RDSIRP1
          IF        OVRCD=1
            MOVE      SIPAPON,SIRPPON
            CALL      WRSIRP1
          ENDIF
.
.---- write SOS data if flag set ----
.
          COMPARE  ONE,SOSFLAG
          CALL     NEWSOS00 IF EQUAL
.
          CALL     ADITM000            * Insert Detail Items
.
POST3000  MOVE     ZERO,ACCEPT
          CALL     SC02L000            * Display Final Summary for Approval
.
POST9999  RETURN
.------------------------------------------------------------
. Write VHA SOS Details
.------------------------------------------------------------
NEWSOS00  MOVE      SIPAPON,SITRPURC      * Purchase order
          PACK      KEY7,SITRPURC
          MOVE      ZERO,SITRSTAT         * Status
          PACK      SITREDAT,SIPADIN      * Date order entered
          MOVE      SP30,SITRCREA         * Reason for cancellation
          MOVE      SP8,SITRTDAT          * Date order transmitted/cancelled
          MOVE      SP4,SITRUSER          * User id for trans/cancellation
          MOVE      SIPAORI,SITRORG       * Transmission/canc. originator
          MATCH     SIPASUP,INCNVHAS
          IF        @EQUAL
            MOVE      INCNBLSN,SITRTNUM   * BLS Transmission Number
          ELSE
            MOVE      INCNVHAN,SITRTNUM   * VHA Transmission number
          ENDIF
          CALL      RASITR1               * check if record exists (shouldnt)
          IF        OVRCD=0
            CALL      UPSITR1             * Update record
          ELSE
            CALL      WRSITR1             * Write record
          ENDIF
          RETURN
.------------------------------------------------------------
. Add Items to a Purchase Order
.------------------------------------------------------------
ADITM000  MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      ONE,ADDFLAG
.
ADITM100  MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
ADITM200  CALL      CLEAR000 * Clear Fields
.
          MOVE      ZERO,EXITFLAG
          MOVE      ONE,ACCEPT
          CALL      SF03L000 * Select Fields
.
          COMPARE   ONE,EXITFLAG
          GOTO      ADITM100 IF NOT EQUAL
.
          MOVE      ZERO,ADDFLAG
          RETURN
.
CLEAR000  MOVE      SP70,SIPCCST
          MOVE      SP70,SIPCPRD
          MOVE      SP70,SIPCWAR
          MOVE      SP70,SIPCCAT
          MOVE      SP70,SIPCPN
          MOVE      SP70,SIPCPD
          MOVE      SP70,SIPCCON
          MOVE      SP70,SIPCCDT
          MOVE      SP70,SIPCSUT
          MOVE      SP70,SIPCEDD
          MOVE      ZERO,SIPCOQT
          MOVE      ZERO,CHECKQTY   * save order quantity
          MOVE      ZERO,CHECKCST   * save order expected cost
          MOVE      SP70,UNITCOST
          MOVE      SP70,SIPCUR1
          MOVE      SP70,SIPCUR2
          MOVE      SP70,SIPCUD1
          MOVE      SP70,SIPCUD2
          MOVE      SP70,SIPCUY1
          MOVE      SP70,SIPCUY2
          MOVE      SP70,SIIADES
          MOVE      SP70,SICADESC
          MOVE      SP70,SISADESC
          MOVE      SP70,NOTESIIB
          MOVE      SP70,NOTESIIG
          MOVE      SP70,NOTESIID
          RETURN
.
POSNOT00  PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPB1
NOT11000  CALL      RKSIPB1
          BRANCH    OVRCD,NOT11900
          MATCH     SIPBPON,SIPAPON
          GOTO      NOT11900 IF NOT EQUAL
          PACK      KEY10,SIPBPON,SIPBLIN
          CALL      DESIPB1
          GOTO      NOT11000
.
NOT11900  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIPB1
          TRAPCLR   IO
          BRANCH    OVRCD,NOT19999
          MOVE      ONE,F3
NOT12000  READ      TEMPWORD,SEQ;SIPBCOM
          GOTO      NOT19999 IF OVER
          MOVE      F3,SIPBLIN
          PACK      KEY10,SIPAPON,SIPBLIN
          UNPACK    KEY10,SIPBPON,SIPBLIN
          CALL      WRSIPB1
          ADD       ONE,F3
          GOTO      NOT12000
.
NOT19999  RETURN
.--------------------------------------------------
. Total Cost of Order
.--------------------------------------------------
TOTORD00  MOVE     ZERO,TOTALORD
          PACK     KEY11,SIPCPON,SIPCITM,SP70
          PACK     KEY10,SIPAPON,SP70
          CALL     RSSIPC1
TOTORD10  CALL     RKSIPC1
          BRANCH   OVRCD,TOTORD90
          MATCH    SIPCPON,SIPAPON
          GOTO     TOTORD90 IF NOT EQUAL
          IF       SIPCECT>0
            ASSIGN   TOTALORD+(SIPCECT*SIPCOQT),TOTALORD
          ENDIF
          GOTO     TOTORD10
.
TOTORD90
          PACK     KEY10,KEY11,SP70
          CALL     RDSIPC1
.
TOTORD99  RETURN
.----------------------------------------------------------------------
. Update Usage if supplier changed
.----------------------------------------------------------------------
UPUS0000
          MATCH     CURRSUPP,SIPASUP
          GOTO      UPUS9999 IF EQUAL
.
          PACK      SSIPASUP,SIPASUP,SP70   * subtract usage for old supplier
          PACK      SIPASUP,CURRSUPP,SP70
          MOVE      "-1",OPTIONA
          CALL      ADDUS000
.
          PACK      SIPASUP,SSIPASUP,SP70   * add for new supplier
          MOVE      "1",OPTIONA
          CALL      ADDUS000
.
UPUS9999  RETURN
.----------------------------------------------------------------------
. Update Interface Files if supplier changed
.----------------------------------------------------------------------
UPINT000  MATCH     CURRSUPP,SIPASUP
          GOTO      UPINT999 IF EQUAL
          COMPARE   ONE,HACCNT              * Check Accounting is On
          GOTO      UPINT999 IF NOT EQUAL
.
          PACK      KEY8,HORDDES,SIPAPON
          CALL      RDAPEA1
          IF        OVRCD=0
            MOVE      SIPASUP,APEACRD
            CALL      UPAPEA1
          ELSE
            MOVE      HORDDES,APEAISC  * System Prefix
            MOVE      SIPAPON,APEAORD
            MOVE      SIPASUP,APEACRD
            PACK      KEY8,APEAISC,APEAORD,SP70
            MOVE      SIPADIN,APEADAT
            CALL      WRAPEA1
          ENDIF
          PACK      KEY8,HORDDES,SIPAPON
          CALL      RDAPCI1
          IF        OVRCD=0
            MOVE      SIPASUP,APCICRD
            CALL      UPAPCI1
          ELSE
            MOVE      HORDDES,APCIISC  * System Prefix
            MOVE      SIPAPON,APCIORD
            MOVE      SIPASUP,APCICRD
            PACK      KEY8,APCIISC,APCIORD,SP70
            MOVE      SIPADIN,APCIDAT
            CALL      WRAPCI1
          ENDIF
UPINT999  RETURN
.
EWARE000  COMPARE   ZERO,SECSIWS
          GOTO      EWARE890 IF EQUAL
.
          MOVE      ZERO,CKEYTYP
          IF        ACCEPT=1
            IF        HPOWHDFT=0
              MOVE      SP70,SIWAWAR
            ENDIF
          ENDIF
.
          CALL      KSIWSA00
          MOVE      SIWAWAR,DEFTWARE
          MOVE      SIWAWAR,SIPAWAR
          BRANCH    EXIT,EWARE900,EWARE900
          MOVE      SIWANPO,F7
          COMPARE   ZERO,F7
          IF        @EQUAL
            BEEP
            MOVE      "Warehouse May Not Have Purchase Orders. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      EWARE000
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      EWARE999
.
EWARE890  MOVE      "You have no access for All Warehouses - ",DISPMSG
          CALL      MESSAGE1
          GOTO      EWARE900
.
EWARE900  MOVE      TWO,EXIT
.
EWARE999  RETURN
.------------------------------------------------------------
. Enter Supplier Code
.------------------------------------------------------------
ESUPP000  MOVE      ZERO,CKEYTYP
          CALL      KAPMAB00
          BRANCH    EXIT,ESUPP950,ESUPP970
.
          IF        APMAHOR=1
            BEEP
            MOVE      "Supplier On Hold for Purchase Orders. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      ESUPP000
          ENDIF
.
          MOVE      APMACRD,SIPASUP
          CALL      CKDAT000           * check data to see if supply units exist
          BRANCH    EXIT,ESUPP000
.
          MOVE      APMACRD,KEY5
          CALL      RDAPMA1
          MOVE      APMASCON,SIPASCN
          UNPACK    SP70,SIPAICN,SIORMESS,SIORCON,SIORHOSP,SIPADEL
          MOVE      SIPAORI,KEY3
          CALL      RDSIOR1
          IF        OVRCD=0
            MOVE      SIORHOSP,SIPAICN
          ENDIF
          MOVE      SP70,SIPACON
          MOVE      SP70,CONFDESC
          MOVE      SP70,SIPAIDP
          MOVE      SP70,SIPAUR1
          MOVE      SP70,SIPAUR2
          MOVE      SP70,SIPAUD1
          MOVE      SP70,SIPAUD2
          MOVE      SP70,SIPAUC1
          MOVE      SP70,SIPAUC2
          MOVE      SP70,SIPAUY1
          MOVE      SP70,SIPAUY2
          MOVE      SP70,SIPADPR
          MOVE      SP70,SIPADCM
          MOVE      SP70,SIPADCN
          PACK      SIPADIN,CCC,CYY,CMM,CDD
          REP       " 0",SIPADIN
          MOVE      SIPADIN,SIPEDATE
          CALL      RSIPE000
          IF        OVRCD=1
            MOVE      "Current Period Missing from Date Range File. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          IF        SIPELOC=1
            MOVE      "WARNING: Current Period Locked. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
          ENDIF
.
          MOVE      SIORDEL,F1
          LOAD      DIM30,F1,HADEL1,HADEL2,HADEL3,HADEL4:
                             HADEL5,HADEL6,HADEL7,HADEL8
          PACK      SIPADEL,DIM30,SP10
          IF        HPURCHP=6
            IF         F1 >=1 & F1 <6
              MOVE       SIORDEL,SIPAPNT
            ELSE
              MOVE       "6",SIPAPNT
              PACK       SIPADEL,SP70
            ENDIF
          ENDIF
.
          IF        HPURCHP=16
            MOVE      F1,SIPAPNT
            IF        F1 >=1 & F1 <9
              MOVE      SIORDEL,SIPAPNT
            ELSE
              MOVE      "0",SIPAPNT
              PACK      DIM30,HADEL3,SP70
            ENDIF
          ENDIF
.
          MOVE      SIORMESS,SIPAMES
          MOVE      SIORCON,SIPACON
          MOVE      SP70,MESSDESC
          MOVE      SP70,CONFDESC
          MATCH     SP70,SIORMESS
          IF        !(@EQUAL)
            MOVE      "ME ",SICDCATA
            PACK      KEY6,SICDCATA,SIPAMES
            CALL      RDSICD1
            IF        OVRCD=0
              MOVE      SICDDESC,MESSDESC
            ENDIF
          ENDIF
          MATCH     SP70,SIORCON
          IF        !(@EQUAL)
            MOVE      "CF ",SICDCATA
            PACK      KEY6,SICDCATA,SIPACON
            CALL      RDSICD1
            IF        OVRCD=0
              MOVE      SICDDESC,CONFDESC
            ENDIF
          ENDIF
.
          MOVE      ZERO,ACCEPT
          MOVE      SP70,NOTEAPSN
          PACK      KEY8,APMACRD,SP70
          CALL      RSAPSN1
.
ESUPP100  CALL      RKAPSN1
          BRANCH    OVRCD,ESUPP200
          MATCH     APMACRD,APSNCRD
          GOTO      ESUPP200 IF NOT EQUAL
          MATCH     SP70,APSNDAT
          GOTO      ESUPP100 IF EQUAL
          MOVE      "Notes",NOTEAPSN
.
          CALL      WP01L000
          GOTO      ESUPP300
.
ESUPP200
          CLOSE     APSMASA1           * close & open to stop "I*M 024"
          PREP      TEMPWORD,FILAPSN1
          CLOSE     TEMPWORD
          OPEN      APSMASA1,"apsmasaf"
.
ESUPP300  CALL      DF01L000
          MOVE      "   27",FLDID
          CALL      GETPOSIT
.
.--- check if interface to VHA or BLS is Active
.
          READ      CONTROLF,TWENTY6;*36,INCNVHAS,*47,INCNVHAN,*172,INCNTRAL:
                                     *194,INCNSOSI
          READ      CONTROLF,SIXTY7;*7,INCNBLSS,*18,INCNBLSN:
                                    *181,INCNBLAL,*203,INCNBLON
.
          MOVE      ZERO,SOSFLAG
          MATCH     SIPASUP,INCNVHAS
          IF        (@EQUAL)&(INCNSOSI=1)
            CALL      CHKVHA00
          ENDIF
          MATCH     SIPASUP,INCNBLSS
          IF        (@EQUAL)&(INCNBLON=1)
            CALL      CHKBLS00
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      ESUPP999
.
ESUPP950  MOVE      ONE,EXIT
          GOTO      ESUPP999
.
ESUPP970  MOVE      TWO,EXIT
.
ESUPP999  RETURN
.----------------------------------------------------------------------
. Check supply units for order
.----------------------------------------------------------------------
CKDAT000  MOVE      ZERO,CHECKQTY
          MOVE      ZERO,CHECKCST
          PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPC1
.
CKDAT010  CALL      RKSIPC1
          BRANCH    OVRCD,CKDAT900
          MATCH     SIPCPON,SIPAPON
          GOTO      CKDAT900 IF NOT EQUAL
.
          MATCH     SP70,SIPCCAT
          GOTO      CKDAT010 IF EQUAL
.
          PACK      KEY27,SIPCCAT,SIPASUP,SIPCSUT,SP70
          CALL      RDSIIC1
          IF        OVRCD=1
            BEEP
            CLEAR     DISPMSG
            APPEND    "Catalog/Unit%",DISPMSG
            APPEND    SIPCCAT,DISPMSG
            APPEND    SLASH,DISPMSG
            APPEND    SIPCSUT,DISPMSG
            APPEND    "%Doesn't%Exist%-%",DISPMSG
            RESET     DISPMSG
            SQUEEZE   DISPMSG
            REP       "% ",DISPMSG
            CALL      MESSAGE1
            GOTO      CKDAT950
          ENDIF
          GOTO      CKDAT010
.
CKDAT900  MOVE      ZERO,EXIT
          GOTO      CKDAT999
.
CKDAT950  MOVE      ONE,EXIT
.
CKDAT999  RETURN
.---------------------------------------------------------
. Check VHA Transfer
.---------------------------------------------------------
CHKVHA00  IF        INCNTRAL=0
            PACK      DISPMSG,SP70,SP70
            CALL      MESSAGE2
            DISPLAY   *P1:24,"Is this a SOS transmit order (":
                      *V2LON,ANSY,*HOFF,"/",*V2LON,ANSN,*HOFF,") ? ";
            MOVE      "24",CVERT
            MOVE      "38",CCOL
            CALL      YORN0000
            CALL      MESSAGE3
            MOVE      FYESNO,SOSFLAG
          ELSE
            MOVE      ONE,SOSFLAG
          ENDIF
          RETURN
.---------------------------------------------------------
. Check BLS Transfer
.---------------------------------------------------------
CHKBLS00  IF        INCNBLAL=0
            PACK      DISPMSG,SP70,SP70
            CALL      MESSAGE2
            DISPLAY   *P1:24,"Is this a BLS transmit order (":
                      *V2LON,ANSY,*HOFF,"/",*V2LON,ANSN,*HOFF,") ? ";
            MOVE      "24",CVERT
            MOVE      "38",CCOL
            CALL      YORN0000
            CALL      MESSAGE3
            MOVE      FYESNO,SOSFLAG
          ELSE
            MOVE      ONE,SOSFLAG
          ENDIF
          RETURN
.
.
.---- keyin cost centre ----
.
EDCST000  MOVE     ZERO,CKEYTYP
          CALL     KSICAA00
          BRANCH   EXIT,ECOST999,ECOST999
.
EDCST100  IF       SICALOC=1
            BEEP
            MOVE     "Cost Centre Not Available for Purchases - ",DISPMSG
            CALL     MESSAGE1
            GOTO     EDCST000
          ENDIF
.
          MOVE     SICACODE,SIPACST
          MOVE     SICACODE,HEADCOST
.
EDCST999  RETURN
.------------------------------------------------------------
. Import Order Details
.------------------------------------------------------------
IMPT0000  IF        OPT50=2
            BEEP
            MOVE      "Import Only NOT Available for Changes - ",DISPMSG
            CALL      MESSAGE1
            GOTO      IMPT9999
          ENDIF
.
          MATCH     SP70,APMASEDI
          IF        @EQUAL
            BEEP
            MOVE      "Supplier Does Not have a Import Vendor ID - ",DISPMSG
            CALL      MESSAGE1
            GOTO      IMPT9999
          ENDIF
.
          CALL      GETFIL00          * Get File Name and Open File
          BRANCH    EXIT,IMPT9999
.
          CALL      VERI0000          * Verify Import File
          BRANCH    EXIT,IMPT9999
.
          CALL      SAVE0000
          BRANCH    EXIT,IMPT9999
.
          CALL      LOAD0000          * Load Import File
.
          CALL      PSTORD00          * Display Summary and Enable Post
.
IMPT9999  RETURN
.------------------------------------------------------------
. Get File Name and Open File
.------------------------------------------------------------
GETFIL00  MOVE      "ecoexprt.txt",IMPTNAME
          KEYIN     *P1:24,*EL,"Import File Name : ",*RV,IMPTNAME
          ENDSET    IMPTNAME
          APPEND    SP70,IMPTNAME
          RESET     IMPTNAME
          MATCH     SP70,IMPTNAME
          GOTO      GETFIL90 IF EQUAL
.
GETFIL10  STRIP     IMPTNAME
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      IMPTFILE,IMPTNAME
          TRAPCLR   IO
          COMPARE   ZERO,OVRCD
          GOTO      GETFIL80 IF EQUAL
.
          REP       "./",IMPTNAME
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      IMPTFILE,IMPTNAME
          TRAPCLR   IO
          COMPARE   ZERO,OVRCD
          GOTO      GETFIL80 IF EQUAL
.
GETFIL50  MOVE      "Y",ANS
          KEYIN     *P1:24,*EL,"File Does Not Exist. ":
                    "Execute PC Transfer (Y/N) ? ",*V2LON,*RV,ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MATCH     ANSN,ANS
          GOTO      GETFIL00 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      GETFIL50 IF NOT EQUAL
          REP       "/.",IMPTNAME
          CLEAR     KEY80
          APPEND    "ibasin50.us1 ",KEY80
          APPEND    IMPTNAME,KEY80
          RESET     KEY80
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          EXECUTE   KEY80,TASKID
          CALL      PUTSCR00
.
          GOTO      GETFIL10
.
GETFIL80  MOVE      ZERO,EXIT
          MOVE      "veri50",KEY6
          PACK      VERINAME,KEY6,PORT
          REP       " 0",VERINAME
          PREP      VERIFILE,VERINAME
          GOTO      GETFIL99
.
GETFIL90  MOVE      ONE,EXIT
.
GETFIL99  RETURN
.------------------------------------------------------------
. Verify Import File Format & Codes
.------------------------------------------------------------
VERI0000  MOVE      ZERO,RECCOUNT
          DISPLAY   *P1:24,*EL,"Verify Import ..."
.
VERI1000  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          ADD       ONE,RECCOUNT
          DISPLAY   *P20:24,RECCOUNT
          READ      IMPTFILE,SEQ;IMPTORD,IMPTLIN,IMPTVEN,IMPTDAT:
                                 IMPTCST,IMPTPRD,IMPTWAR,IMPTCAT:
                                 IMPTPN,IMPTPD,IMPTSUT,IMPTEDD:
                                 IMPTOQT,IMPTECT,IMPTUR1,IMPTUR2:
                                 IMPTDEL,IMPTGST
          GOTO      VERI9000 IF OVER
          TRAPCLR   FORMAT
          BRANCH    OVRCD,VERI9100
.
          MATCH     SP70,IMPTVEN
          IF        !@EQUAL
            MATCH     IMPTVEN,APMASEDI           * Check Vendor ID Matches
            GOTO      VERI9300 IF NOT EQUAL
          ENDIF
.
          CALL      CHKSIA00                     * Check Catalog
          BRANCH    EXIT,VERI9200
.
          CALL      CHKCST00                     * Check Cost Centre
          BRANCH    EXIT,VERI9200
.
          CALL      GETCST00                     * Get Cost Centre
.
          MOVE      SIIASUB,SIPCPRD              * Set Product Group
.
          CALL      CHKFMS00                     * Check General Ledger
          BRANCH    EXIT,VERI9200
.
          CALL      CHKPGP00                     * Check Product Group
          BRANCH    EXIT,VERI9200
.
          CALL      CHKWAR00                     * Check Warehouse
          BRANCH    EXIT,VERI9200
.
          WRITE     VERIFILE,SEQ;IMPTORD,IMPTLIN,IMPTVEN,IMPTDAT:
                                 IMPTCST,IMPTPRD,IMPTWAR,IMPTCAT:
                                 IMPTPN,IMPTPD,IMPTSUT,IMPTEDD:
                                 IMPTOQT,IMPTECT,IMPTUR1,IMPTUR2:
                                 IMPTDEL,IMPTGST
.
          GOTO      VERI1000
.
VERI9000  MOVE      ZERO,EXIT
          GOTO      VERI9999
.
VERI9100  BEEP
          CLEAR     DISPMSG
          APPEND    "Import Format Error on Line ",DISPMSG
          APPEND    RECCOUNT,DISPMSG
          APPEND    " - ",DISPMSG
          RESET     DISPMSG
          CALL      MESSAGE1
          MOVE      ONE,EXIT
          GOTO      VERI9999
.
.
VERI9200  MOVE      ONE,EXIT
          GOTO      VERI9999
.
VERI9300  BEEP
          CLEAR     DISPMSG
          APPEND    "Vendor ID Mismatch ",DISPMSG
          APPEND    IMPTVEN,DISPMSG
          APPEND    " Record No ",DISPMSG
          APPEND    RECCOUNT,DISPMSG
          APPEND    " - ",DISPMSG
          RESET     DISPMSG
          CALL      MESSAGE1
          MOVE      ONE,EXIT
          GOTO      VERI9999
.
VERI9999  RETURN
.---------------------------------------------------------------
. Check Catalog Code - Get Catalog Master and Supplier Details
.                      Exit = 1 If Can't Match Record
.---------------------------------------------------------------
CHKSIA00  MATCH     SP70,IMPTCAT
          GOTO      CHKSIA10 IF EQUAL
CHKSIA04  PACK      KEY7,IMPTCAT,SP70
          CALL      RDSIIA1                     * Read Master Record
          BRANCH    OVRCD,CHKSIA10
.
          PACK      KEY27,SIIACAT,SIPASUP,SP70
          CALL      RSSIIC1
CHKSIA05  CALL      RKSIIC1                     * Read Supply Details
          BRANCH    OVRCD,CHKSIA10
          MATCH     SIPASUP,SIICSUP
          GOTO      CHKSIA10 IF NOT EQUAL
          MATCH     IMPTPN,SIICPNO
          GOTO      CHKSIA50 IF EQUAL
.
          CALL      PARTMC00
          BRANCH    EXIT,CHKSIA05,CHKSIA98
.
          GOTO      CHKSIA50
.
. No Catalog Match on Vendors Part Number
.
CHKSIA10  MOVE      SP70,IMPTCAT
          PACK      KEY57,SIPASUP,IMPTPN,SP70
          CALL      RSSIIC2
CHKSIA20  CALL      RKSIIC2                    * Read Supplier Details
          BRANCH    OVRCD,CHKSIA91
          MATCH     SIPASUP,SIICSUP
          GOTO      CHKSIA91 IF NOT EQUAL
          MATCH     IMPTPN,SIICPNO
          GOTO      CHKSIA30 IF EQUAL
          MOVE      IMPTPN,KEY30
          STRIP     KEY30
          MATCH     KEY30,SIICPNO
          GOTO      CHKSIA20 IF NOT EQUAL
.
          MOVE      SIICCAT,KEY7
          CALL      RDSIIA1                    * Read Master Details
          BRANCH    OVRCD,CHKSIA90
.
          CALL      PARTMC00
          BRANCH    EXIT,CHKSIA20,CHKSIA98
.
. Exact Match
.
CHKSIA30  MOVE      SIICCAT,KEY7
          CALL      RDSIIA1                    * Read Master Details
          BRANCH    OVRCD,CHKSIA90
.
CHKSIA50  MOVE      SIIACAT,SIPCCAT
          COMPARE   ZERO,SIIANON
          GOTO      CHKSIA60 IF EQUAL
          MOVE      ZERO,EXIT
          GOTO      CHKSIA99
.
CHKSIA60  MOVE      SIPAWAR,SIPCWAR
          PACK      KEY12,SIIACAT,SIPAWAR
          CALL      RDSIIE1                    * Stock Item so Read Warehouse
          BRANCH    OVRCD,CHKSIA92
          MOVE      ZERO,EXIT
          GOTO      CHKSIA99
.
CHKSIA90  BEEP
          CLEAR     DISPMSG
          APPEND    "Invalid Catalog ",DISPMSG
          APPEND    IMPTCAT,DISPMSG
          APPEND    " Record No ",DISPMSG
          APPEND    RECCOUNT,DISPMSG
          APPEND    " - ",DISPMSG
          RESET     DISPMSG
          CALL      MESSAGE1
.
          CALL      INPCAT00
          BRANCH    EXIT,CHKSIA98
          GOTO      CHKSIA04
.
CHKSIA91  CLEAR     DISPMSG
          APPEND    "Can't Match Part Number ",DISPMSG
          APPEND    IMPTPN,DISPMSG
          APPEND    " Record No ",DISPMSG
          APPEND    RECCOUNT,DISPMSG
          APPEND    " - ",DISPMSG
          RESET     DISPMSG
          CALL      MESSAGE1
.
          CALL      INPCAT00
          BRANCH    EXIT,CHKSIA98
          GOTO      CHKSIA04
.
CHKSIA92  BEEP
          CLEAR     DISPMSG
          APPEND    "Invalid Catalog/Warehouse ",DISPMSG
          APPEND    SIIACAT,DISPMSG
          APPEND    "/",DISPMSG
          APPEND    SIPAWAR,DISPMSG
          APPEND    " Record No ",DISPMSG
          APPEND    RECCOUNT,DISPMSG
          APPEND    " - ",DISPMSG
          RESET     DISPMSG
          CALL      MESSAGE1
          MOVE      ONE,EXIT
          GOTO      CHKSIA99
.
CHKSIA98  MOVE      ONE,EXIT
CHKSIA99  RETURN
.------------------------------------------------------------
. Partial Match on Part Number
.------------------------------------------------------------
PARTMC00  BEEP
          MOVE      "16",HTOP
          MOVE      "1",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
          DISPLAY   *P1:16,*EF
          HLINE     *G37,16,1,80
.
          DISPLAY   *P1:17,*EF:
                    *P20:17,*V2LON,*ULON:
                    "WARNING - Part Number Does Not Match",*HOFF:
                    *P1:19,"Import Part No.: ",*V2LON,IMPTPN,*HOFF:
                    *P50:19," Unit  : ",*V2LON,IMPTSUT,*HOFF:
                    *P1:20,"Quantity       : ",*V2LON,IMPTOQT,*HOFF:
                    *P50:20," Price : ",*V2LON,IMPTECT,*HOFF:
                    *P1:21,"Catalog        : ",*V2LON,SIICCAT,SP1,SIIADES,*HOFF:
                    *P1:22,"Part Number    : ",*V2LON,SIICPNO,*HOFF:
                    *P50:22," Unit  : ",*V2LON,SIICSUT
          MOVE      "Y",ANS
.
PARTMC10  KEYIN     *P1:24,*EL,"Use this Catalog Code (",*V2LON,"Y",*HOFF,"/":
                    *V2LON,"N",*HOFF,"/":
                    *V2LON,"A",*HOFF,"bort) ? ",*V2LON,*RV,ANS
          REP       UPPLOW,ANS
          MATCH     ANSN,ANS
          GOTO      PARTMC90 IF EQUAL
          MATCH     ANSA,ANS
          GOTO      PARTMC95 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      PARTMC10 IF NOT EQUAL
          MOVE      SIICPNO,IMPTPN
          CALL      PUTSCR00
          MOVE      ZERO,EXIT
          GOTO      PARTMC99
.
PARTMC90  CALL      PUTSCR00
          MOVE      ONE,EXIT
          GOTO      PARTMC99
PARTMC95  CALL      PUTSCR00
          MOVE      TWO,EXIT
PARTMC99  RETURN
.---------------------------------------------------------------
. Check Warehouse
.---------------------------------------------------------------
CHKWAR00  MOVE      ZERO,EXIT
          MATCH     SP70,IMPTWAR
          GOTO      CHKWAR99 IF EQUAL
.
          PACK      KEY5,IMPTWAR,SP70
          CALL      RDSIWA1                     * Read Master Record
          IF        OVRCD=1
            BEEP
            CLEAR     DISPMSG
            APPEND    "Invalid Warehouse ",DISPMSG
            APPEND    IMPTWAR,DISPMSG
            APPEND    " Record No ",DISPMSG
            APPEND    RECCOUNT,DISPMSG
            APPEND    " - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
          ENDIF
.
CHKWAR99  RETURN
.---------------------------------------------------------------
. Check Cost Centre
.---------------------------------------------------------------
CHKCST00  MOVE      ZERO,EXIT
          COMPARE   ZERO,SIIANON                * Stock Item
          GOTO      CHKCST99 IF EQUAL
          MOVE      ZERO,EXIT
          MATCH     SP70,IMPTCST
          GOTO      CHKCST90 IF EQUAL
.
          PACK      KEY5,IMPTCST,SP70
          CALL      RDSICA1                     * Read Master Record
          IF        OVRCD=1
            BEEP
            CLEAR     DISPMSG
            APPEND    "Invalid Cost Centre ",DISPMSG
            APPEND    IMPTCST,DISPMSG
            APPEND    " Record No ",DISPMSG
            APPEND    RECCOUNT,DISPMSG
            APPEND    " - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            CALL      INPCST00        * Input Cost Centre
          ENDIF
          GOTO      CHKCST99
.
CHKCST90  MATCH     SP70,SIPACST
          IF        @EQUAL
            CALL      INPCST00        * Input Cost Centre
          ENDIF
.
CHKCST99  RETURN
.---------------------------------------------------------------
. Check Product Group
.---------------------------------------------------------------
CHKPGP00  MOVE      ZERO,EXIT
          MATCH     SP70,IMPTPRD
          GOTO      CHKPGP99 IF EQUAL
.
          PACK      KEY5,IMPTPRD,SP70
          CALL      RDSISA1                     * Read Master Record
          IF        OVRCD=1
            BEEP
            CLEAR     DISPMSG
            APPEND    "Invalid Product Group ",DISPMSG
            APPEND    IMPTPRD,DISPMSG
            APPEND    " Record No ",DISPMSG
            APPEND    RECCOUNT,DISPMSG
            APPEND    " - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
          ENDIF
.
CHKPGP99  RETURN
.------------------------------------------------------------
. Load Import File
.------------------------------------------------------------
LOAD0000  OPEN      IMPTFILE,IMPTNAME    * Reset to Start of File
          OPEN      VERIFILE,VERINAME    * Reset to Start of File
          MOVE      ZERO,RECCOUNT
          MOVE      ZERO,NXORDLIN
          DISPLAY   *P1:24,*EL,"Loading Details ..."
.
LOAD1000  ADD       ONE,RECCOUNT
          DISPLAY   *P20:24,RECCOUNT
          READ      VERIFILE,SEQ;IMPTORD,IMPTLIN,IMPTVEN,IMPTDAT:
                                 IMPTCST,IMPTPRD,IMPTWAR,IMPTCAT:
                                 IMPTPN,IMPTPD,IMPTSUT,IMPTEDD:
                                 IMPTOQT,IMPTECT,IMPTUR1,IMPTUR2:
                                 IMPTDEL,IMPTGST
          GOTO      LOAD9000 IF OVER
.
          CALL      CHKSIA00              * Read Catalog Details IA + IC + IE
.
          PACK      SIPEDATE,SIPADIN,SP70
          REP       " 0",SIPEDATE
          CALL      RSIPE000           * get current period
          PACK      SIPCDAT,SIPEYEAR,SIPEPER,SP70
.
          MOVE      SIPAPON,SIPCPON       * Set Order Number
          MOVE      SIIACAT,SIPCCAT       * Set Catalog
          MOVE      IMPTPN,SIPCPN         * Set Part No
          MOVE      SIICPD1,SIPCPD        * Set Part Desc
          MOVE      SIICSUT,SIPCSUT       * Set Supply Unit
          MOVE      SIIASUB,SIPCPRD       * Set Product Group
          MOVE      SP70,SIPCCDT          * Set Contract Date
          MOVE      SP70,SIPCCON          * Set Contract
          CALL      CDDT0000              * Calculate Delivery Date
          MOVE      IMPTECT,SIPCECT       * Set Expected Cost
          MOVE      IMPTOQT,SIPCOQT       * Set Expected Qty
          MOVE      SIPCOQT,SIPCOQO       * Set Original Order Qty
          MOVE      SIPCECT,SIPCOOP       * Set Original Order Price
          MOVE      SIIAGST,SIPCGST
          CALL      CALTAX00
          MOVE      SIPCGSTA,SIPCOGS
          MOVE      SP70,SIPCFDD          * Set First Delivery Date
          MOVE      ZERO,SIPCRQT
          MOVE      ZERO,SIPCIQT
          MOVE      ZERO,SIPCTCR
          MOVE      ZERO,SIPCTGS
          MOVE      ZERO,SIPCTIN
          MOVE      ZERO,SIPCIGS
          MOVE      IMPTUR1,SIPCUR1
          MOVE      IMPTUR2,SIPCUR2
          MOVE      SP70,SIPCUD1
          MOVE      SP70,SIPCUD2
          MOVE      SP70,SIPCUY1
          MOVE      SP70,SIPCUY2
          MOVE      SP70,SIPCSPA
          CALL      GETCST00             * Set Cost Centre & Warehouse
.
          CALL      WRLIN000             * Write Order Line
.
          MATCH     SP70,IMPTDEL         * Update Delivery Ins to Comments
          CALL      UPDEL000 IF NOT EQUAL
.
          GOTO      LOAD1000
.
LOAD9000  MOVE      "Load Complete - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          PREP      IMPTFILE,IMPTNAME
          PREP      VERIFILE,VERINAME
          CLOSE     IMPTFILE
          CLOSE     VERIFILE
.
LOAD9999  RETURN
.------------------------------------------------------------
. Update Delivery Instructions to Comments
.------------------------------------------------------------
UPDEL000  MOVE      ONE,F3
          PACK      KEY13,SIPCPON,SIPCITM,F3
          UNPACK    KEY13,SIPDPON,SIPDITM,SIPDLIN
          MOVE      IMPTDEL,SIPDCOM
          MOVE      SP70,SIPDSPA
          CALL      RASIPD1
          IF        OVRCD=1
            CALL      WRSIPD1
          ENDIF
          RETURN
.------------------------------------------------------------
. Post Line of Purchase Order
.------------------------------------------------------------
WRLIN000  CALL      LOCREC00
.
          REPEAT
            ADD       ONE,NXORDLIN
            MOVE      NXORDLIN,SIPCITM
            PACK      KEY10,SIPCPON,SIPCITM
            CALL      RASIPC1
          UNTIL     OVRCD=1
          CALL      WRSIPC1             * Write Order Detail Line
          MOVE      ONE,AUDTTYPE
          CALL      WASIPC00            * Audit Add
.
          CALL      LASTC000            * Update Last Cost (If Required)
.
          MOVE      ONE,SIFACTOR        * Get Factor for Usage Calc
          PACK      KEY30,SIIAISS,SIPCSUT
          CALL      RDSIFA1
.
          ASSIGN    SIPCOQT*SIFACTOR,SIUSQTY
          IF        SIPCECT<0
            MOVE      ZERO,SIUSCST
          ELSE
            IF        SNCOPURC=1
              MOVE      SIPCECT,F12P4
              ASSIGN    F12P4*SIPCOQT,SIUSCST
            ELSE
              MOVE      SIPCECT,F12P4
              SUB       SIPCGSTA,F12P4
              ASSIGN    F12P4*SIPCOQT,SIUSCST
            ENDIF
          ENDIF
.
          CALL      SINORDUS            * Update Purchases Usage
.
          CALL      UPSOO000            * Update Stock on Order
.                                       * Update Committed Exp
          COMPARE   ZERO,CEAFILE
          GOTO      WRLIN900 IF NOT EQUAL
          MOVE      SIPCOQT,MODQTY
          MATCH     SP70,SIPCCAT
          GOTO      WRLIN800 IF EQUAL
.
          BRANCH    SIIANON,WRLIN800
          CALL      USCEA000            * Committed Update Stock
          GOTO      WRLIN900
.
WRLIN800  CALL      UNCEA000            * Committed Update Non-Stock
.
WRLIN900  CALL      UUSIIA1             * Unlock Records
          IF        SIIANON=0
            CALL      UUSIIE1
          ENDIF
.
WRLIN999  RETURN
.------------------------------------------------------------
. Update Last Cost
.------------------------------------------------------------
LASTC000  IF        HLASTCIN=1
            MATCH     SIPCCAT,SP70
            IF        !@EQUAL
              PACK      KEY27,SIPCCAT,SIPASUP,SIPCSUT,SP70
              CALL      RDSIIC1
              IF        OVRCD=0
                MOVE      TWO,AUDTTYPE
                CALL      WASIIC00
                MOVE      SIPCECT,SIICLCT
                CALL      UPSIIC1
                MOVE      THREE,AUDTTYPE
                CALL      WASIIC00
              ENDIF
            ENDIF
          ENDIF
          RETURN
.------------------------------------------------------------
. Update Stock on Order
.------------------------------------------------------------
UPSOO000  IF        SIIANON=0
            PACK      KEY12,SIPCCAT,SIPCWAR
            CALL      RDSIIE1
            IF        OVRCD=0
              ADD       SIUSQTY,SIIESOO
              CALL      UPSIIE1           * Update Stock on Order
            ENDIF
          ENDIF
          RETURN
.------------------------------------------------------------
. Lock Catalog Records
.------------------------------------------------------------
LOCREC00  PACK      KEY7,SIIACAT,SP70
          CALL      RLSIIA1
          IF        OVRCD=2
            BEEP
            CLEAR     DISPMSG
            APPEND    "Catalog ",DISPMSG
            APPEND    SIIACAT,DISPMSG
            APPEND    " Locked. Retry - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            GOTO      LOCREC00
          ENDIF
.
LOCREC10  IF        SIIANON=0
            PACK      KEY12,SIPCCAT,SIPCWAR
            CALL      RLSIIE1
            IF        OVRCD=2
              CLEAR     DISPMSG
              APPEND    "Catalog/Warehouse ",DISPMSG
              APPEND    SIPCCAT,DISPMSG
              APPEND    " / ",DISPMSG
              APPEND    SIPCWAR,DISPMSG
              APPEND    " Locked. Retry - ",DISPMSG
              RESET     DISPMSG
              CALL      MESSAGE1
              GOTO      LOCREC10
            ENDIF
          ENDIF
          RETURN
.------------------------------------------------------------
. Determine Cost Centre & Warehouse
.------------------------------------------------------------
GETCST00  IF        SIIANON=0
            MOVE      "Stock",SIPCCST       * Set Cost Centre
            MOVE      SIIEWAR,SIPCWAR       * Set Warehouse
          ELSE
            MATCH     SP70,IMPTCST
            IF        @EQUAL
              MOVE      SIPACST,SIPCCST     * Set Cost Centre
            ELSE
              MOVE      IMPTCST,SIPCCST     * Set Cost Centre
            ENDIF
            MOVE      SP70,SIPCWAR          * Set Warehouse
          ENDIF
          RETURN
.------------------------------------------------------------
. Calculate Delivery Date from Lead Time
.------------------------------------------------------------
CDDT0000  MATCH     SP70,IMPTDAT
          IF        @EQUAL
            MOVE      CCC,CC           *   Calculate Expected Delivery Date
            MOVE      CYY,YY           *   from Order Date Date
            MOVE      CMM,MM
            MOVE      CDD,DD           *   Todays Date
          ELSE
            UNPACK    IMPTDAT,CCENT,CYEAR,CMON,CDAY
            MOVE      CCENT,CC
            MOVE      CYEAR,YY
            MOVE      CMON,MM
            MOVE      CDAY,DD
          ENDIF
          CALL      DMYCON           *   Convert to Jul Date
          ADD       SIICLTM,JULDAY   *   Add Lead Time
          MOVE      JULDAY,JWKDAY
          MOVE      JULYR,JWKYER
          MOVE      JULCC,JWKCC
          CALL      JULCON           *    Convert Date Back
          PACK      SIPCEDD,CC,YY,MM,DD
          REP       " 0",SIPCEDD
          RETURN
.------------------------------------------------------------
. SAVE0000 -  Allocate Order Number and Post Header
.             Generate Order Number
.------------------------------------------------------------
SAVE0000  BRANCH    OPT50,SAVE1000
.
          MOVE      "       ",SIPAPON
          CALL      SINORDNO         * Get Next Order Number
          BRANCH    OVRCD,SAVE9000
          CLEAR     DISPMSG
          APPEND    "Generated Order No. : ",DISPMSG
          APPEND    SIPAPON,DISPMSG
          APPEND    " - ",DISPMSG
          RESET     DISPMSG
          CALL      MESSAGE1
.
          MOVE      SIPAPON,KEY7
          CALL      RASIPA1
          BRANCH    OVRCD,SAVE2000
.
          GOTO      SAVE0000
.
SAVE1000  MOVE      SIPAPON,KEY7
          CALL      RASIPA1
          COMPARE   ZERO,OVRCD
          GOTO      SAVE9000 IF EQUAL
.
SAVE2000  CALL      WRSIPA1
          CALL      RLSIPA1
          MOVE      ONE,AUDTTYPE
          CALL      WASIPA00               * Audit Add
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIPAPON,VAR
            CALL      DISPITEM
          ENDIF
.
          CALL      POSNOT00                * SAVE Notes
          GOTO      SAVE9999
.
SAVE9000  MOVE      "Unable to Allocate an Order Number - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      ONE,EXIT
.
SAVE9999  RETURN
.------------------------------------------------------------
. Post Order Details
.------------------------------------------------------------
PSTORD00  MOVE     ZERO,ACCEPT
          CALL     SC02L000            * Display Final Summary for Approval
          MOVE     ZERO,EXIT
          RETURN
.
.------------------------------------------------------------
. Enter Cost Centre for Item
.------------------------------------------------------------
INPCST00  BEEP
          MOVE      "16",HTOP
          MOVE      "1",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
          DISPLAY   *P1:16,*EF
          HLINE     *G37,16,1,80
.
          DISPLAY   *P1:17,*EF:
                    *P20:17,*V2LON,*ULON:
                    "Cost Centre Required for Non Stock",*HOFF:
                    *P1:19,"Import Part No.: ",*V2LON,IMPTPN,*HOFF:
                    *P50:19," Unit  : ",*V2LON,IMPTSUT,*HOFF:
                    *P1:20,"Quantity       : ",*V2LON,IMPTOQT,*HOFF:
                    *P50:20," Price : ",*V2LON,IMPTECT,*HOFF:
                    *P1:21,"Catalog        : ",*V2LON,SIICCAT,SP1,SIIADES,*HOFF:
                    *P1:22,"Part Number    : ",*V2LON,SIICPNO,*HOFF:
                    *P50:22," Unit  : ",*V2LON,SIICSUT
.
INPCST10  DISPLAY   *P1:24,*EL,"Cost Centre   : "
          MOVE      "17",CCOL
          MOVE      "24",CVERT
          CALL      KSICAA00
          BRANCH    EXIT,INPCST10,INPCST90
INPCST20  DISPLAY   *P1:24,*EL,"Cost Centre   : ",*V2LON,SICACODE,SP1,SICADESC
          MOVE      ANSY,ANS
          KEYIN     *P65:24,*EL,"Ok (",*V2LON,"Y",*HOFF,"/":
                                       *V2LON,"N",*HOFF,") ? ",*V2LON,*RV,ANS
          REP       UPPLOW,ANS
          MATCH     ANSN,ANS
          GOTO      INPCST10 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      INPCST20 IF NOT EQUAL
          MOVE      SICACODE,IMPTCST
          CALL      PUTSCR00
          MOVE      ZERO,EXIT
          GOTO      INPCST99
.
INPCST90  CALL      PUTSCR00
          MOVE      ONE,EXIT
INPCST99  RETURN
.------------------------------------------------------------
. Enter Catalog for Item
.------------------------------------------------------------
INPCAT00  BEEP
          MOVE      "16",HTOP
          MOVE      "1",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HBOT
          MOVE      ZERO,HRIG
          DISPLAY   *P1:16,*EF
          HLINE     *G37,16,1,80
.
          DISPLAY   *P1:17,*EF:
                    *P20:17,*V2LON,*ULON:
                    "Catalog Code Required",*HOFF:
                    *P1:19,"Import Part No.: ",*V2LON,IMPTPN,*HOFF:
                    *P50:19," Unit  : ",*V2LON,IMPTSUT,*HOFF:
                    *P1:20,"Quantity       : ",*V2LON,IMPTOQT,*HOFF:
                    *P50:20," Price : ",*V2LON,IMPTECT,*HOFF:
                    *P1:21,"Import Catalog : ",*V2LON,IMPTCAT
.
INPCAT10  DISPLAY   *P1:24,*EL,"Enter Catalog Code : "
          MOVE      "22",CCOL
          MOVE      "24",CVERT
          CALL      KSIIAA00
          BRANCH    EXIT,INPCAT10,INPCAT90
INPCAT20  DISPLAY   *P1:24,*EL,"Catalog       : ",*V2LON,SIIACAT,SP1,SIIADES
          MOVE      ANSY,ANS
          KEYIN     *P65:24,*EL,"Ok (",*V2LON,"Y",*HOFF,"/":
                                       *V2LON,"N",*HOFF,") ? ",*V2LON,*RV,ANS
          REP       UPPLOW,ANS
          MATCH     ANSN,ANS
          GOTO      INPCAT10 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      INPCAT20 IF NOT EQUAL
.
          MOVE      SIIACAT,IMPTCAT
.
          CALL      PUTSCR00
          MOVE      ZERO,EXIT
          GOTO      INPCAT99
.
INPCAT90  CALL      PUTSCR00
          MOVE      ONE,EXIT
INPCAT99  RETURN
.
REDITM00  MOVE     SP70,SIIADES
          MOVE     SP70,SISADESC
          MOVE     SP70,SICADESC
.
          COMPARE   ZERO,SIPCOQO
          IF        @EQUAL
            MOVE      SIPCOQT,SIPCOQO
            MOVE      SIPCECT,SIPCOOP
            MOVE      SIPCGSTA,SIPCOGS
          ENDIF
          MOVE      SIPCOQT,CHECKQTY   * save order quantity
          IF        SNCOPURC=1
            MOVE      SIPCECT,CHECKCST   * save order cost
          ELSE
            MOVE      SIPCECT,F12P4   * save order cost
            SUB       SIPCGSTA,F12P4   * save order cost
            MOVE      F12P4,CHECKCST
          ENDIF
.
          MOVE     SIPCPRD,KEY5
          CALL     RDSISA1
.
          MOVE     SIPCGST,KEY6
          CALL     RDIBGS1
.
          MOVE     ZERO,F12P4
          ASSIGN   SIPCGSTA*SIPCOQT,F12P4
          MOVE     F12P4,TOTALGST
          MOVE     ZERO,F12P4
          ASSIGN   SIPCECT*SIPCOQT,F12P4
          MOVE     F12P4,TOTALCST
.
          MOVE     SIPCPON,SIPAPON
          MATCH    SP70,SIPCCAT
          GOTO     REDITM10 IF EQUAL
.
          MOVE     SIPCCAT,KEY7
          CALL     RDSIIA1
.
          MOVE     "0",SIICCONT
          COMPARE  ZERO,SIIANON
          GOTO     REDITM20 IF EQUAL
.
REDITM10  MOVE     SIPCCST,KEY5
          CALL     RDSICA1
          GOTO     REDITM30
.
REDITM20  PACK     KEY27,SIPCCAT,SIPASUP,SIPCSUT,SP70
          CALL     RDSIIC1
.
REDITM30  MOVE     ZERO,ADDFLAG
          MOVE     ZERO,ACCEPT
          CALL     CHKPRICE
.
REDITM99  RETURN
.
CHKPRICE  IF        (SIPCECT<0)
            MOVE      "        T.B.A.",UNITCOST
          ELSE
            MOVE      "9,999,999.9999",UNITCOST
            FEDIT     SIPCECT,UNITCOST
            MATCH     "*",UNITCOST
            IF        @EQUAL
              MOVE      SIPCECT,F9P4
              MOVE      F9P4,UNITCOST
            ENDIF
          ENDIF
          RETURN
SELITM00  CALL     CLEAR000
          CALL     REDITM00
.
          MOVE     TWO,AUDTTYPE
          CALL     WASIPC00          * Write Before Audit
          CALL     SC03L000
.
SELITM99  RETURN
.------------------------------------------------------------
. Update P/O Current Cost
.------------------------------------------------------------
UPCOST00  PACK      KEY7,SIPAPON
          CALL      RDSIRP1
          IF        OVRCD=1
            MOVE      SIPAPON,SIRPPON
            CALL      WRSIRP1
          ENDIF
.
          PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPC1
UPCOST10  CALL      RKSIPC1
          BRANCH    OVRCD,UPCOST90
          MATCH     SIPAPON,SIPCPON
          GOTO      UPCOST90 IF NOT EQUAL
          MATCH     SP70,SIPCCAT
          GOTO      UPCOST10 IF EQUAL
          IF        SIPCECT<0
            GOTO      UPCOST10
          ENDIF
          MOVE      ZERO,SECTOR
.
UPCOST20  PACK      KEY27,SIPCCAT,SIPASUP,SIPCSUT
          CALL      RDSIIC1
          BRANCH    OVRCD,UPCOST10
.
          MATCH     "1",SIICCONT
          GOTO      UPCOST10 IF EQUAL
.
          MOVE      TWO,AUDTTYPE
          CALL      WASIIC00
          MOVE      SIPCECT,SIICCCT
          CALL      UPSIIC1
          MOVE      THREE,AUDTTYPE
          CALL      WASIIC00
          GOTO      UPCOST10
.
UPCOST90  RETURN
.------------------------------------------------------------
. Delete Entire Order
.------------------------------------------------------------
DEL10000  MATCH     SP70,SIPADPR
          IF        !(@EQUAL)
             MOVE     "Deletion Invalid. Order Has Been Printed - ",DISPMSG
             BEEP
             CALL     MESSAGE1
             GOTO     DEL19000
          ENDIF
.
          PACK      KEY12,SIPAPON,SP70
          CALL      RSSIPF1
          CALL      RKSIPF1
          BRANCH    OVRCD,DEL10010
          MATCH     SIPFPON,SIPAPON
          GOTO      DEL10010 IF NOT EQUAL
          MOVE      "Goods Already Received for This Order - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          GOTO      DEL19000
.
DEL10010
          MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          CALL      DELQST
          CALL      MESSAGE3
          SUB       ONE,CEXIT
          BRANCH    CEXIT,DEL19000,DEL19100
.
          MOVE      SEQ,OPTIONA        * 1=adding usage, -1=subtracting usage
          CALL      ADDUS000
.
          MOVE      SIPAPON,KEY7
          CALL      DESIPA1
.
          MOVE      SIPAPON,KEY7
          CALL      RDSIRP1
          IF        OVRCD=0
            CALL      DESIRP1
          ENDIF
.
          PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPB1
.
DEL13100  CALL      RKSIPB1
          BRANCH    OVRCD,DEL14000
          MATCH     SIPAPON,SIPBPON
          GOTO      DEL14000 IF NOT EQUAL
          PACK      KEY10,SIPBPON,SIPBLIN
          CALL      DESIPB1
          GOTO      DEL13100
.
DEL14000  PACK      KEY13,SIPAPON,SP70
          CALL      RSSIPD1
.
DEL14100  CALL      RKSIPD1
          BRANCH    OVRCD,DEL15000
          MATCH     SIPAPON,SIPDPON
          GOTO      DEL15000 IF NOT EQUAL
          PACK      KEY13,SIPDPON,SIPDITM,SIPDLIN
          CALL      DESIPD1
          GOTO      DEL14100
.
DEL15000  PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPC1
.
DEL15100  CALL      RKSIPC1
          BRANCH    OVRCD,DEL16000
          MATCH     SIPAPON,SIPCPON
          GOTO      DEL16000 IF NOT EQUAL
          PACK      KEY10,SIPCPON,SIPCITM
          CALL      DESIPC1
          GOTO      DEL15100
.
DEL16000  MOVE      SIPAPON,KEY7       * delete from SOS transfer file
          CALL      DESITR1
          GOTO      DEL19100
.
DEL19000  MOVE      ONE,EXIT           * remain on screen
          GOTO      DEL19999
.
DEL19100  MOVE      ZERO,EXIT          * exit screen
          GOTO      DEL19999
.
DEL19999  RETURN
.----------------------------------------------------------------------
. Enter Line Number
.----------------------------------------------------------------------
SELIN000  PACK      KEY10,SIPAPON,SCSLSEL,SP70
          CALL      RDSIPC1
          IF        OVRCD=1
            MOVE      "Invalid Selection - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            MOVE      ZERO,ORIGECT
            MOVE      ZERO,ORIGGST
          ELSE
            MOVE      SIPCECT,ORIGECT
            MOVE      SIPCGSTA,ORIGGST
            MOVE      ZERO,HLEF
            CALL      GETSCR00
            CALL      REDITM00
.
            MOVE      TWO,AUDTTYPE
            CALL      WASIPC00          * Write Before Audit
.
            CALL      SC03L000
            MOVE      "02",SCRID
            MOVE      ZERO,PRCOL
            MOVE      ZERO,PRVERT
            MOVE      "   25",FLDID
            CALL      GETPOSIT
            IF        EXIT=0
              MOVE     SCPSCOL,PRCOL
              MOVE     SCPSROW,PRVERT
            ENDIF
            CALL      PUTSCR00
          ENDIF
.
SELIN900  CALL      FP02L000
.
SELIN999  RETURN
NOWP0000  IF       ACCEPT=1
            CLOSE     APSMASA2           * close & open to stop "I*M 024"
            PREP      TEMPWORD,FILSIPD1  * clear wp file
            CALL      SELECTED
            IF        EXIT=0
              CALL      RDWP0000
              MOVE      FILSIPD1,WORDNAME
              CALL      DISPWORD
            ENDIF
            CLOSE     TEMPWORD
            OPEN      APSMASA2,"apsmasaf"   * open apma2
            MOVE      "99999",SCSLITM
          ENDIF
          RETURN
.----------------------------------------------------------------------
. Read Service Code Notes
.----------------------------------------------------------------------
RDWP0000
          PACK      KEY4,SIVACOD,SP70
          PACK      KEY7,SIVACOD,SP70
          CALL      RSSIVB1
.
RDWP1000
          CALL      RKSIVB1
          BRANCH    OVRCD,RDWP9000
          PACK      KEY7,SIVBCOD,SIVBLIN,SP70
          MATCH     KEY4,KEY7
          GOTO      RDWP9000 IF NOT EQUAL
.
          PACK      VAR,SIVBCOM,SP70,SP70
          STRIP     VAR
          MOVELPTR  VAR,F3
          SFORMAT   VAR,F3
          MOVE      SIVBCOM,VAR
          IF        F3=0
            WRITE     TEMPWORD,SEQ;
          ELSE
            WRITE     TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT   VAR,127
          GOTO      RDWP1000
.
RDWP9000
.
RDWP9999  RETURN
ECOST000  MATCH    SP70,SIPCCAT
          GOTO     ECOST100 IF EQUAL
.
          BRANCH   SIIANON,ECOST100
          MOVE     "Stock",SIPCCST
          MOVE     SP70,SICADESC
          BRANCH   ACCEPT,ECOST999
          BEEP
          MOVE     "Stock Item. Cost Centre Not Required. - ",DISPMSG
          CALL     MESSAGE1
          GOTO     ECOST999
.
ECOST100  COMPARE  ZERO,ACCEPT         * in accept mode ?
          GOTO     ECOST200 IF EQUAL
.
          MATCH    SP70,SIVACOD        * service code exists ?
          GOTO     ECOST150 IF EQUAL
.
          PACK     KEY5,SIVACST,SP70   * Check for Service Code Details
          CALL     RDSICA1
          COMPARE  ONE,OVRCD
          GOTO     ECOST300 IF NOT EQUAL
.
ECOST150  PACK     KEY5,SIPACST,SP70   * Check for Default Cost Centre
          CALL     RDSICA1
          COMPARE  ONE,OVRCD
          GOTO     ECOST300 IF NOT EQUAL
.
.---- keyin cost centre ----
.
ECOST200  MOVE     ZERO,CKEYTYP
          CALL     KSICAA00
          BRANCH   EXIT,ECOST999,ECOST999
.
ECOST300  IF       SICALOC=1
            BEEP
            MOVE     "Cost Centre Not Available for Purchases - ",DISPMSG
            CALL     MESSAGE1
            GOTO     ECOST200
          ENDIF
.
          MATCH    HEADCOST,SICACODE
          GOTO     ECOST400 IF EQUAL
.
          MATCH    SP70,SIIACAT
          GOTO     ECOST400 IF EQUAL
.
          MOVE     SICACODE,DETLCOST
          PROC     CHKNCT00
          BRANCH   EXIT,ECOST200
.
ECOST400  MATCH    SP70,SICAMES
          IF       !(@EQUAL)
            BEEP
            MOVE     SICAMES,DISPMSG
            CALL     MESSAGE1
          ENDIF
          MOVE     SICACODE,SIPCCST
.
ECOST999  RETURN
.------------------------------------------------------------
. Enter Product Group
.------------------------------------------------------------
EPROD000  MOVE     ZERO,SECTOR
          PACK     KEY7,SIPCCAT,SP70
          CALL     RDSIIA1
          BRANCH   OVRCD,EPROD100
.
          MOVE     SIIASUB,SIPCPRD
          MOVE     SIIASUB,KEY5
.
          CALL     RDSISA1
          IF       OVRCD=1
            MOVE     "Catalog Item Has an Invalid Product Group - ",DISPMSG
            CALL     MESSAGE1
            GOTO     EPROD100
          ENDIF
.
          BRANCH   ACCEPT,EPROD999
          IF       ACCEPT=0 & SIIANON=1
            GOTO     EPROD100
          ENDIF
.
          BEEP
          MOVE     "Item is Cataloged. Product Group Not Required. - ",DISPMSG
          CALL     MESSAGE1
          GOTO     EPROD999
.
EPROD100  MATCH    SP70,SIVACOD        * use service code data if possible
          GOTO     EPROD200 IF EQUAL
          COMPARE  ZERO,ACCEPT          * use service code data if possible
          GOTO     EPROD200 IF EQUAL
.
          PACK     KEY5,SIVAPRD,SP70
          CALL     RDSISA1
          BRANCH   OVRCD,EPROD200
          GOTO     EPROD300
.
EPROD200  MOVE     ZERO,CKEYTYP
          CALL     KSISAA00
          BRANCH   EXIT,EPROD250,EPROD999
          GOTO     EPROD300
.
EPROD250  MOVE     LASTPGP,KEY5
          CALL     RDSISA1
          BRANCH   OVRCD,EPROD200
          MOVE     ZERO,EXIT
.
EPROD300  MOVE     SISACODE,SIPCPRD
          MOVE     SISACODE,LASTPGP     * Save Last Product Group Entered
.
EPROD999  RETURN
.
ECATA000  IF        ACCEPT=0
            CLEAR     DISPMSG
            APPEND    "Catalog May Not Be Changed. ",DISPMSG
            APPEND    "Delete and Re-enter Item.",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            GOTO      ECATA950
          ENDIF
.
          CALL      CLRPC000           * Clear All Purchase Order Details Vars
.
          MOVE      SP70,SIVACOD       * clear service code
          CLOSE     APSMASA1           * close & open to stop "I*M 024"
          PREP      TEMPWORD,FILSIPD1  * clear wp file
          CLOSE     TEMPWORD
          OPEN      APSMASA1,"apsmasaf"
.
          MOVE      SP70,CANSAVE       * No Save Key for Cancel
.                                      * only for change of items
          MOVE      SP70,SIPCCAT
          MOVE      ZERO,CKEYTYP
          MOVE      SIPASUP,SIICSUP    * For ? Option
          MOVE      SP70,SIICCAT
          MOVE      SP70,SIICSUT
          MOVE      ONE,ETOEXIT
          CALL      KCATAA00
          BRANCH    EXIT,ECATA100,ECATA900
.
          MOVE      SIIACAT,SIPCCAT
          MOVE      SIICSUT,SIPCSUT
.
          CALL      FCATA000     * Check Flags and Warehouse
          BRANCH    EXIT,ECATA000
.
          CALL      CHKNOT00     * Check Notes Flags
.
          GOTO      ECATA950
.
.---- non catalogues purchases ----
.
ECATA100  MOVE      SP70,SIPCCAT
          MOVE      SP70,SIPCPRD
          MOVE      SP70,SIIACAT
          MOVE      SP70,SIIADES
          MOVE      SP70,SIIASUB
          MOVE      SP70,SIIAISS
          MOVE      SP70,SIIASTI
          MOVE      ZERO,SIIAAVC
          MOVE      SP70,SIIANAT
          MOVE      SP70,SIIAABC
          MOVE      SP70,SIIAPSC
          MOVE      ZERO,SIIAREX
          MOVE      ZERO,SIIANON
          MOVE      ZERO,SIIASAB
          MOVE      ZERO,SIIASUS
          MOVE      SP70,SIIADTC
          MOVE      SP70,SIIAUSC
          MOVE      SP70,SIIATMC
          MOVE      SP70,SIIAUD1
          MOVE      SP70,SIIAUD2
          MOVE      SP70,SIIAUC1
          MOVE      SP70,SIIAUC2
          MOVE      SP70,SIIAUY1
          MOVE      SP70,SIIAUY2
          MOVE      SP70,SIIAUR1
          MOVE      SP70,SIIAUR1
.
.---- keyin service code ----
.
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ZERO,CKEYTYPE
            CALL      KSIVAA00           * keyin service code
            BRANCH    EXIT,ECATA950,ECATA900
          ENDIF
          GOTO      ECATA950
.
ECATA900  MOVE      ONE,EXITFLAG
          MOVE      TWO,EXIT
          GOTO      ECATA999
.
ECATA950  MOVE      ZERO,EXIT
.
ECATA999  RETURN
.--------------------------------------------------
. Enter Catalog Code Specific Supplier
.--------------------------------------------------
KCATAA00  READ      CONTROLF,SIXTY3;*67,INCOCATE,*141,INCNNATO
          MOVE      SP70,NATOCODE
          MOVE      SP70,SIIACAT
          MOVE      SP70,SIICCAT
          COMPARE   ZERO,INCOCATE
          GOTO      KCATAA01 IF NOT EQUAL
.
          KEYIN     *PCCOL:CVERT,*V2LON,NATOCODE
.
          ENDSET    NATOCODE
          APPEND    SP70,NATOCODE
          RESET     NATOCODE
.
          MATCH     SP70,NATOCODE
          IF        @EQUAL
            MOVE      ONE,EXIT
            GOTO      KCATAA99
          ENDIF
.
          CMATCH    EXITCHAR,NATOCODE
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      KCATAA99
          ENDIF
.
          REP       UPPLOW,NATOCODE
          MATCH     "E         ",NATOCODE
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      KCATAA99
          ENDIF
          MATCH     "X         ",NATOCODE
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      KCATAA99
          ENDIF
.
          CMATCH    QUEST,NATOCODE
          GOTO      KCATAA10 IF NOT EQUAL
          GOTO      KCATAA02
.
KCATAA01
          MOVE      SP70,NATOCODE
          KEYIN     *PCCOL:CVERT,*V2LON,*JR,NATOCODE
.
          ENDSET    NATOCODE
          APPEND    SP70,NATOCODE
          RESET     NATOCODE
.
          MATCH     SP70,NATOCODE
          IF        @EQUAL
            MOVE      ONE,EXIT
            GOTO      KCATAA99
          ENDIF
.
          REP       UPPLOW,NATOCODE
          ENDSET    NATOCODE
.
          CMATCH    EXITCHAR,NATOCODE
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      KCATAA99
          ENDIF
.
          MATCH     "E",NATOCODE
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      KCATAA99
          ENDIF
.
          MATCH     "X",NATOCODE
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      KCATAA99
          ENDIF
.
          CMATCH    QUEST,NATOCODE
          GOTO      KCATAA02 IF EQUAL
          RESET     NATOCODE
          GOTO      KCATAA10
.
KCATAA02  MOVE      CCITEM,SCCITEM
          MATCH     SIWAWAR,SP70
          CALL      HSIICC00               * Normal Catalog Lookup - all
.
          ENDSET    SIICCAT
          APPEND    SP70,SIICCAT
          RESET     SIICCAT
.
          MATCH     SP70,SIICCAT
          GOTO      KCATAA00 IF EQUAL
.
          MOVE      SIICCAT,SIIACAT
          PACK      KEY7,SIIACAT
          CALL      RDSIIA1
          BRANCH    OVRCD,KCATAA80
.
          PACK      KEY27,SIICCAT,SIICSUP,SIICSUT
          CALL      RDSIIC1
.
          MOVE      ZERO,EXIT
          GOTO      KCATAA99
.
KCATAA10
          IF        INCOCATE<>0
            UNPACK    NATOCODE,KEY3,KEY7
          ELSE
            UNPACK    NATOCODE,KEY7,KEY3
          ENDIF
          MOVE      KEY7,SIIACAT
.
          MATCH     KEY3,SP3          * Check if too large for Catalog - Nato?
          IF        @EQUAL
            CALL      RASIIA1
          ELSE
            IF        INCNNATO<>1
              MOVE      "Entry too long for a Catalog Code - ",DISPMSG
              CALL      MESSAGE1
              GOTO      KCATAA00
            ELSE
              MOVE      ONE,OVRCD     * Simulate for Nato Lookup
            ENDIF
          ENDIF
.
. ------- OVRCD=1 if not found on catalog file or if > 7 chars keyed in and
. ------- Nato Codes are being used.
          IF        OVRCD=1
            CALL      CHKNAT00               * Check Nato File
            BRANCH    EXIT,KCATAA00
          ENDIF
          PACK      KEY7,SIIACAT
          CALL      RDSIIA1
          BRANCH    OVRCD,KCATAA00
          MOVE      ZERO,EXIT
          GOTO      KCATAA99
.
KCATAA80  BEEP
          MOVE      "Catalog Code Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KCATAA00
.
KCATAA90  MOVE      ONE,EXIT
          GOTO      KCATAA99
.
KCATAA95  MOVE      TWO,EXIT
          GOTO      KCATAA99
.
KCATAA96  MOVE      THREE,EXIT
.
KCATAA99  DISPLAY   *PCCOL:CVERT,*V2LON,SIIACAT,SP3
          RETURN
. Check Flags for Catalog
.------------------------
FCATA000  MOVE      ZERO,EXIT
          MOVE      SP70,SIPCWAR
          MOVE      SIIASUB,SIPCPRD
          BRANCH    SIIANON,FCATA100
.
          MOVE      DEFTWARE,SIPCWAR      * Default Warehouse from P/O header
          MATCH     SP70,DEFTWARE         * Will force that warehouse. If
          GOTO      FCATA050 IF NOT EQUAL * Default is Blank and the catalog
.                                         * is in more than one warehouse then
          PACK      KEY12,SIIACAT,SP70    * the warehouse will have to be keyed.
          CALL      RSSIIE1
          CALL      RKSIIE1
          BRANCH    OVRCD,FCATA040
          MATCH     SIIACAT,SIIECAT
          GOTO      FCATA040 IF NOT EQUAL
          MOVE      SIIEWAR,SIPCWAR
          CALL      RKSIIE1
          BRANCH    OVRCD,FCATA050
          MATCH     SIIACAT,SIIECAT
          GOTO      FCATA050 IF NOT EQUAL
.
          MOVE      "    5",FLDID       * Warehouse Position
          CALL      GETPOSIT
          IF        EXIT=1
            BEEP
            MOVE      "Warehouse Keyin Position not on screen. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FCATA035
          ENDIF
          CALL      KSIWSA00
          BRANCH    EXIT,FCATA035,FCATA035
          MOVE      SIWAWAR,SIPCWAR
          MOVE      "    6",FLDID       * Catalog Position
          CALL      GETPOSIT
          GOTO      FCATA050
.
FCATA035  MOVE      "    6",FLDID       * Catalog Position
          CALL      GETPOSIT
          MOVE      ONE,EXIT
          GOTO      FCATA999
.
FCATA040  MOVE      "Catalog Not on Warehouse File. - ",DISPMSG
          CALL      MESSAGE1
          MOVE      ONE,EXIT
          GOTO      FCATA999
.
FCATA050  PACK      KEY12,SIIACAT,SIPCWAR
          CALL      RDSIIE1
          IF        OVRCD=1
            BEEP
            MOVE      "Catalog Not Available in Warehouse. - ",DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
            GOTO      FCATA999
          ENDIF
.
          IF        SIIESUS=2|SIIESUS=3
            BEEP
            MOVE      "Warehouse/Catalog has been Suspended. - ",DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
            GOTO      FCATA999
          ENDIF
.
FCATA100  IF        SIIASUS=2|SIIASUS=3
            BEEP
            MOVE      "Catalog has been Suspended. - ",DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
            GOTO      FCATA999
          ENDIF
.
          MATCH     SIPASUP,SIIAPSC
          IF        !(@EQUAL)
            BEEP
            CLEAR     DISPMSG
            APPEND    "WARNING: Preferred Supplier Code : ",DISPMSG
            APPEND    SIIAPSC,DISPMSG
            APPEND    " - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
          ENDIF
.
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          PACK      KEY45,SIIACAT,CURRDATE,Z70
          CALL      RSSISD2                 * Check for Contract Price
          CALL      RPSISD2                 * Lastest Price
          BRANCH    OVRCD,FCATA900          * No Contract
.
          MATCH     SISDCAT,SIIACAT         * Correct Catalog
          GOTO      FCATA900 IF NOT EQUAL   * No Contract
.
          MOVE      SISDCON,KEY10
          CALL      RDSISC1
          BRANCH    OVRCD,FCATA900          * No Contract
.
          MATCH     CURRDATE,SISCEDT        * Check for Completed Contract
          GOTO      FCATA900 IF LESS        * Contract Out of Date
.
          MATCH     SIPASUP,SISDCON
          IF        @EQUAL
            MOVE      SISCCON,SIPCCON
            MOVE      SISCSDT,SIPCCDT
            MOVE      SISDSUT,SIPCSUT
          ELSE
            BEEP
            CLEAR     DISPMSG
            APPEND    "WARNING: Contracted on Supplier/Contract : ",DISPMSG
            APPEND    SISDSUP,DISPMSG
            APPEND    "/",DISPMSG
            APPEND    SISDCON,DISPMSG
            APPEND    " - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
          ENDIF
.
.----- check stock on order ----
.
FCATA900  PROC      CHKCAT00     * check if catalog already on order
          BRANCH    EXIT,FCATA999
.
          BRANCH    SIIANON,FCATA950    * If Non-Stock no Cat/WH details
.
          IF        SIIESOO>0
            BEEP
            MOVE      SIIESOO,KEY15
            SQUEEZE   KEY15
            CLEAR     DISPMSG
            APPEND    "WARNING: ",DISPMSG
            APPEND    KEY15,DISPMSG
            APPEND    " Already on Order for this W/h - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE4
            LOAD      EXIT,EXIT,ONE,ZERO
          ENDIF
          GOTO      FCATA999
.
FCATA950  MATCH     SP70,SIIACAT
          GOTO      FCATA999 IF EQUAL
.
          MOVE      HEADCOST,DETLCOST
          PROC      CHKNCT00     * check if non-stock catalog already on order
          BRANCH    EXIT,FCATA999
.
FCATA999  RETURN
.----------------------------------------------------------------------
. Check if catalog already on this order
.----------------------------------------------------------------------
          DEFPROC   CHKCAT00
          INC       SINPOCFD/INC
          OPEN      SINPOCA1,"sinpocaf"
.
          MOVE      ZERO,EXIT
          PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPC1
.
CHKCAT10  CALL      RKSIPC1
          BRANCH    OVRCD,CHKCAT99
          MATCH     SIPAPON,SIPCPON
          GOTO      CHKCAT99 IF NOT EQUAL
.
          MATCH     SIIACAT,SIPCCAT
          GOTO      CHKCAT10 IF NOT EQUAL
.
          BEEP
          MOVE      "WARNING - Catalog Already Exists on this Order. ",DISPMSG
          CALL      MESSAGE4           * 1=no, 2=yes
          LOAD      EXIT,EXIT,ONE,ZERO
          GOTO      CHKCAT99
.
          INC       SINPOCIO/INC
          INC       IBAOVRIO/INC
.
CHKCAT99  ENDPROC
.----------------------------------------------------------------------
. Check if catalog already on this order
.----------------------------------------------------------------------
          DEFPROC   CHKNCT00
          INC       SINPOAFD/INC
          INC       SINPOCFD/INC
          OPEN      SINPOAA1,"sinpoaaf"
          OPEN      SINPOCA6,"sinpocaf"
.
          MOVE      ZERO,EXIT
          MOVE      ZERO,ORDQTY
          PACK      KEY25,SIIACAT,Z70
          CALL      RSSIPC6
.
CHKNCT10  CALL      RPSIPC6
          BRANCH    OVRCD,CHKNCT80
          MATCH     SIIACAT,SIPCCAT
          GOTO      CHKNCT80 IF NOT EQUAL
          MATCH     SP8,SIPCEDD
          GOTO      CHKNCT80 IF EQUAL
          MATCH     SIPCCST,DETLCOST
          GOTO      CHKNCT10 IF NOT EQUAL
.
          PACK      KEY7,SIPCPON
          CALL      RDSIPA1
          BRANCH    OVRCD,CHKNCT10
          MATCH     SP70,SIPADCN
          GOTO      CHKNCT10 IF NOT EQUAL
          MATCH     SP70,SIPADCM
          GOTO      CHKNCT10 IF NOT EQUAL
.
          MOVE      ONE,SIFACTOR
          PACK      KEY30,SIIAISS,SIPCSUT,SP70
          CALL      RDSIFA1
.
          ASSIGN    ORDQTY+((SIPCOQT*SIFACTOR)-SIPCRQT),ORDQTY
          GOTO      CHKNCT10
.
CHKNCT80  IF        ORDQTY > 0
            BEEP
            CLEAR     DISPMSG
            APPEND    "WARNING:",DISPMSG
            APPEND    ORDQTY,DISPMSG
            APPEND    " on Order for Cost Centre ",DISPMSG
            APPEND    DETLCOST,DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE4           * 1=no, 2=yes
            LOAD      EXIT,EXIT,ONE,ZERO
          ENDIF
          GOTO      CHKNCT99
.
          INC       SINPOAIO/INC
          INC       SINPOCIO/INC
          INC       IBAOVRIO/INC
.
CHKNCT99  ENDPROC
.----------------------------------------------------------------------
. Catalog Supplier Notes
.----------------------------------------------------------------------
CHKNOT00  MOVE        "     ",NOTESIID
          PACK        KEY12,SIIACAT,SIPASUP,SP70
          PACK        KEY15,SIIACAT,SIPASUP,SP70
          CALL        RSSIID1
.
CHKNOT10  CALL        RKSIID1
          BRANCH      OVRCD,CHKNOT20
          PACK        KEY15,SIIDCAT,SIIDSUP,SP70
          MATCH       KEY12,KEY15
          GOTO        CHKNOT20 IF NOT EQUAL
          MATCH       SP70,SIIDCOM
          GOTO        CHKNOT10 IF EQUAL
          MOVE        "Notes",NOTESIID
.
. Catalog Warehouse Notes
.
CHKNOT20  MOVE        "     ",NOTESIIG
          BRANCH      SIIANON,CHKNOT40
          PACK        KEY12,SIIACAT,SIWAWAR,SP70
          PACK        KEY15,SIIACAT,SIWAWAR,SP70
          CALL        RSSIIG1
CHKNOT30  CALL        RKSIIG1
          BRANCH      OVRCD,CHKNOT40
          PACK        KEY15,SIIGCAT,SIIGWAR,SP70
          MATCH       KEY12,KEY15
          GOTO        CHKNOT40 IF NOT EQUAL
          MATCH       SP70,SIIGCOM
          GOTO        CHKNOT30 IF EQUAL
          MOVE        "Notes",NOTESIIG
.
. Catalog Notes
.
CHKNOT40  MOVE        "     ",NOTESIIB
          PACK        KEY7,SIIACAT,SP70
          PACK        KEY10,SIIACAT,SP70
          CALL        RSSIIB1
CHKNOT50  CALL        RKSIIB1
          BRANCH      OVRCD,CHKNOT60
          MATCH       SIIACAT,SIIBCAT
          GOTO        CHKNOT60 IF NOT EQUAL
          MATCH       SP70,SIIBCOM
          GOTO        CHKNOT50 IF EQUAL
          MOVE        "Notes",NOTESIIB
CHKNOT60  RETURN
.--------------------------------------------------------
. Clear Fields after Delete : Purchase Order Detail
.-------------------------------------------------------
CLRPC000  MOVE      SP70,SIPCITM
          MOVE      SP70,SIPCCST
          MOVE      SP70,SIPCPRD
          MOVE      SP70,SIPCWAR
          MOVE      SP70,SIPCCAT
          MOVE      SP70,SIPCPN
          MOVE      SP70,SIPCPD
          MOVE      SP70,SIPCCON
          MOVE      SP70,SIPCCDT
          MOVE      SP70,SIPCSUT
          MOVE      SP70,SIPCEDD
          MOVE      SP70,SIPCFDD
          MOVE      ZERO,SIPCOQT
          MOVE      ZERO,SIPCIQT
          MOVE      ZERO,SIPCRQT
          MOVE      ZERO,SIPCECT
          MOVE      ZERO,SIPCGSTA
          MOVE      ZERO,SIPCTCR
          MOVE      ZERO,SIPCTGS
          MOVE      ZERO,SIPCTIN
          MOVE      ZERO,SIPCIGS
          MOVE      ZERO,SIPCOQO
          MOVE      ZERO,SIPCOOP
          MOVE      ZERO,SIPCOGS
          MOVE      SP70,SIPCGST
          MOVE      SP70,SIPCUR1
          MOVE      SP70,SIPCUR2
          MOVE      SP70,SIPCUD1
          MOVE      SP70,SIPCUD2
          MOVE      SP70,SIPCUY1
          MOVE      SP70,SIPCUY2
          MOVE      ZERO,ORIGECT
          MOVE      ZERO,ORIGGST
.
CLRPC999  RETURN
EPART000
          MOVE     ZERO,SECTOR
.
          IF        ACCEPT=1
            MOVE      SP70,SIPCPN
          ENDIF
          MATCH     SP70,SIPCCAT
          GOTO      EPART100 IF EQUAL
          PACK      KEY27,SIPCCAT,SIPASUP,SIPCSUT
          CALL      RDSIIC1
          BRANCH    OVRCD,EPART100
          MOVE      SIICPNO,SIPCPN
          BRANCH    ACCEPT,EPART999
          BEEP
          MOVE     "Item Cataloged. Part Number may not be Changed. - ",DISPMSG
          CALL     MESSAGE1
          GOTO     EPART999
.
EPART100
          MATCH     SP70,SIVACOD       * use service code data if possible
          IF        !@EQUAL&(ACCEPT=1)&(SECTOR=0)
            MOVE      ONE,SECTOR
            PACK      SIPCPN,SIVAPN,SP70
            MATCH     SP70,SIPCPN
            GOTO      EPART100 IF EQUAL
          ELSE
            STRIP     SIPCPN
            KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,SIPCPN:
                      *PCCOL:CVERT
            ENDSET    SIPCPN
            APPEND    SP70,SIPCPN
            RESET     SIPCPN
            MOVE      ZERO,EXIT
            CMATCH    EXITCHAR,SIPCPN
            IF        @EQUAL
              MOVE      TWO,EXIT
            ENDIF
            MATCH     SP70,SIPCPN
            IF        @EQUAL
              MOVE      ONE,EXIT
            ENDIF
          ENDIF
.
EPART999  RETURN
EPDES000
          MOVE     ZERO,SECTOR
.
          IF        ACCEPT=1
            MOVE      SP70,SIPCPD
          ENDIF
          MATCH     SP70,SIPCCAT
          GOTO      EPDES100 IF EQUAL
          PACK      KEY27,SIPCCAT,SIPASUP,SIPCSUT
          CALL      RDSIIC1
          BRANCH    OVRCD,EPDES100
          MOVE      SIICPD1,SIPCPD
          BRANCH    ACCEPT,EPDES999
          BEEP
          MOVE      "Item Cataloged. Description may NOT be changed. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      EPDES999
.
EPDES100
          MATCH     SP70,SIVACOD       * use service code data if possible
          IF        !@EQUAL&(ACCEPT=1)&(SECTOR=0)
            MOVE      ONE,SECTOR
            PACK      SIPCPD,SIVADES,SP70
            MATCH     SP70,SIPCPD
            GOTO      EPDES100 IF EQUAL
          ELSE
            STRIP     SIPCPD
            KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,SIPCPD:
                      *PCCOL:CVERT
            ENDSET    SIPCPD
            APPEND    SP70,SIPCPD
            RESET     SIPCPD
            MOVE      ZERO,EXIT
            CMATCH    EXITCHAR,SIPCPD
            IF        @EQUAL
              MOVE      TWO,EXIT
            ENDIF
            MATCH     SP70,SIPCPD
            IF        @EQUAL
              MOVE      ONE,EXIT
            ENDIF
          ENDIF
.
EPDES999  RETURN
EUNIT000  MOVE      ZERO,SECTOR
.
          IF        ACCEPT=1
            MOVE      SP70,SIPCSUT
          ENDIF
.
          MATCH     SP70,SIPCCAT
          GOTO      EUNIT800 IF EQUAL
          CALL      ESUPT000
          GOTO      EUNIT999
.
. Item Not on Catalog
.----------------------
EUNIT800  MATCH     SP70,SIVACOD       * use service code data if possible
          IF        !@EQUAL&(ACCEPT=1)&(SECTOR=0)
            MOVE      ONE,SECTOR
            MOVE      SIVASUT,SIPCSUT
            MATCH     SP70,SIPCSUT
            GOTO      EUNIT800 IF EQUAL
          ELSE
            STRIP     SIPCSUT
            KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,SIPCSUT:
                      *PCCOL:CVERT
            ENDSET    SIPCSUT
            APPEND    SP70,SIPCSUT
            RESET     SIPCSUT
          ENDIF
.
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,SIPCSUT
          IF        @EQUAL
            MOVE      TWO,EXIT
          ENDIF
          MATCH     SP70,SIPCSUT
          IF        @EQUAL
            MOVE      ONE,EXIT
          ENDIF
.
EUNIT999  RETURN
.
ESUPT000  BRANCH    ACCEPT,ESUPT200
.
ESUPT010  MOVE      "0",CKEYTYP
          MOVE      SIPCCAT,SIICCAT
          MOVE      SIPASUP,SIICSUP
          CALL      KSIICA00
          MOVE      SIICSUT,SIPCSUT
          BRANCH    EXIT,ESUPT999,ESUPT999
.
ESUPT100  PACK      KEY27,SIPCCAT,SIPASUP,SIPCSUT
          CALL      RDSIIC1
          BRANCH    OVRCD,ESUPT010
          IF        SIICAPO=0
            BEEP
            MOVE       "Purchase Orders Not Allowed for Supply Unit. - ",DISPMSG
            CALL       MESSAGE1
            GOTO       ESUPT010
          ENDIF
          PACK      KEY30,SIIAISS,SIPCSUT
          CALL      RDSIFA1
          IF        OVRCD=1
            BEEP
            MOVE       "Invalid Issue/Supply Factor - ",DISPMSG
            CALL       MESSAGE1
            GOTO       ESUPT010
          ENDIF
.
          MOVE      SIICLCT,SIPCECT
.
          IF        (SIPCECT<0)
            MOVE      SEQ,SIPCECT
            MOVE      "        T.B.A.",UNITCOST
          ELSE
            MOVE      "9,999,999.9999",UNITCOST
            FEDIT     SIPCECT,UNITCOST
            MATCH     "*",UNITCOST
            IF        @EQUAL
              MOVE      SIPCECT,F9P4
              MOVE      F9P4,UNITCOST
            ENDIF
          ENDIF
          GOTO      ESUPT999
.
ESUPT200  PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          PACK      KEY45,SIPASUP,SIPCCAT,CURRDATE,Z70
          CALL      RSSISD3                 * Check for Contract Price
          CALL      RPSISD3                 * Lastest Price
          BRANCH    OVRCD,ESUPT300          * No Contract
          MATCH     SISDSUP,SIPASUP         * Correct Supplier
          GOTO      ESUPT300 IF NOT EQUAL   * No
          MATCH     SISDCAT,SIPCCAT         * Correct Catalog
          GOTO      ESUPT300 IF NOT EQUAL   * No
.
          MOVE      SISDCON,KEY10
          CALL      RDSISC1
          BRANCH    OVRCD,ESUPT300          * No Contract
.
          MATCH     CURRDATE,SISCEDT        * Check for Completed Contract
          GOTO      ESUPT300 IF LESS        * Contract Out of Date
.
          MOVE      SISCCON,SIPCCON
          MOVE      SISDSUT,SIPCSUT
          MOVE      SISDSDT,SIPCCDT
          GOTO      ESUPT100
.
ESUPT300  PACK      KEY27,SIPCCAT,SIPASUP,SP70
          CALL      RSSIIC1
ESUPT400  CALL      RKSIIC1
          BRANCH    OVRCD,ESUPT900
          MATCH     SIPCCAT,SIICCAT
          GOTO      ESUPT900 IF NOT EQUAL
          MATCH     SIPASUP,SIICSUP
          GOTO      ESUPT900 IF NOT EQUAL
          COMPARE   ZERO,SIICAPO
          GOTO      ESUPT400 IF EQUAL
.
          MOVE      SIICSUT,SIPCSUT
.
          CALL      RKSIIC1
          BRANCH    OVRCD,ESUPT100
          MATCH     SIPCCAT,SIICCAT
          GOTO      ESUPT100 IF NOT EQUAL
          MATCH     SIPASUP,SIICSUP
          GOTO      ESUPT100 IF NOT EQUAL  * more than one supply unit
.
          GOTO      ESUPT010
.
ESUPT900  MOVE      "Supplier Not Available for this Catalog. ",DISPMSG
          BEEP
          CALL      MESSAGE4
          IF        EXIT=1
            MOVE      TWO,EXIT
          ELSE
            MOVE      ACCEPT,CURRYRDT
            MOVE      SCSLSEL,LASTCOD3
.
            MOVE      ZERO,HLEF
            CALL      GETSCR00
            CALL      SC05L000         * add data
            CALL      PUTSCR00
.
            MOVE      "03",SCRID
            MOVE      ZERO,PRCOL
            MOVE      ZERO,PRVERT
            MOVE      "   21",FLDID
            CALL      GETPOSIT
            IF        EXIT=0
              MOVE      SCPSCOL,PRCOL
              MOVE      SCPSROW,PRVERT
            ENDIF
.
            MOVE      ZERO,CCOL
            MOVE      ZERO,CVERT
            MOVE      "   11",FLDID
            CALL      GETPOSIT
            IF        EXIT=0
              MOVE      SCPSCOL,CCOL
              MOVE      SCPSROW,CVERT
            ENDIF
.
            MOVE      CURRYRDT,ACCEPT  * reset data
            MOVE      LASTCOD3,SCSLSEL
            PACK      KEY13,PRGID,SCRID,SCSLSEL,SP70
            CALL      RDSCSL1
            GOTO      ESUPT300         * re-check data
          ENDIF
.
ESUPT999  RETURN
EEXDT000
          IF        ACCEPT=1
            CALL      CALDD000
            MATCH     SP70,SIPCCAT
            GOTO      EEXDT999 IF NOT EQUAL
            MATCH     SP70,SIVACOD     * do we have a service code lead time ?
            IF        !@EQUAL&(SIVALED>0)
              GOTO      EEXDT999
            ENDIF
          ENDIF
          UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY
          CALL      KEYDATE
          PACK      SIPCEDD,CCENT,CYEAR,CMON,CDAY
          MATCH     SP2,CDAY
          IF        @EQUAL
            MOVE      SP8,SIPCEDD
          ENDIF
.
EEXDT999  RETURN
.
. Calculate Expected Delivery Date
.----------------------------------
CALDD000  MATCH     SP70,SIPCCAT
          IF        @EQUAL
            MOVE      "7",SIICLTM
            MATCH     SP70,SIVACOD     * do we have a service code lead time ?
            IF        !@EQUAL&(SIVALED>0)
              MOVE      SIVALED,SIICLTM
            ENDIF
          ENDIF
          MOVE      CCC,CC
          MOVE      CYY,YY
          MOVE      CMM,MM
          MOVE      CDD,DD              * Todays Date
          CALL      DMYCON              * Convert to Jul Date
          ADD       SIICLTM,JULDAY      * Add Lead Time
          MOVE      JULDAY,JWKDAY
          MOVE      JULYR,JWKYER
          MOVE      JULCC,JWKCC
          CALL      JULCON              * Convert Date Back
          PACK      SIPCEDD,CC,YY,MM,DD
          REP       " 0",SIPCEDD
          RETURN
EQTY0000  MOVE      ZERO,EXIT
.
          MOVE      SP70,VAR
          CALL      DISPITEM
          IF        ACCEPT=1
            MOVE      ZERO,SIPCOQT
          ENDIF
.
          MATCH     SP70,SIVACOD       * use service code data if possible
          IF        !@EQUAL&(ACCEPT=1)&(SIVAQTY>ZERO)
            MOVE      ONE,SECTOR
            MOVE      ZERO,QTYFORM8
            MOVE      SIVAQTY,QTYFORM8
          ELSE
            MOVE      SIPCOQT,QTYFORM8
            KEYIN     *PCCOL:CVERT,*V2LON,*RV,QTYFORM8
          ENDIF
.
          MATCH     SP70,SIPCCAT
          IF        @EQUAL
            MOVE      ONE,SIFACTOR
          ELSE
            MOVE      SIPCCAT,KEY7
            CALL      RDSIIA1
            PACK      KEY30,SIIAISS,SIPCSUT
            CALL      RDSIFA1
            IF        OVRCD=1
              MOVE      ONE,SIFACTOR
            ENDIF
          ENDIF
.
          IF        (QTYFORM8<(SIPCRQT/SIFACTOR)) & (SIPCRQT>0)
              BEEP
              PACK      DISPMSG,SP70,SP70
              RESET     DISPMSG
              MOVE      SIPCRQT,FORM12P2
              DIV       SIFACTOR,FORM12P2
              MOVE      FORM12P2,DIM15
              SQUEEZE   DIM15
              APPEND    "ERROR: Received Quantity is ",DISPMSG
              APPEND    DIM15,DISPMSG
              APPEND    "  -  ",DISPMSG
              CALL      MESSAGE1
              GOTO      EQTY0000
          ENDIF
.
          IF        (QTYFORM8=(SIPCRQT/SIFACTOR)) & (SIPCRQT>0)
            MOVE      SP8,SIPCEDD
          ENDIF
.
          IF        QTYFORM8>ZERO
            MOVE      QTYFORM8,SIPCOQT
          ELSE
            IF        QTYFORM8=ZERO
              MOVE      QTYFORM8,SIPCOQT
              MOVE      SP8,SIPCEDD
              GOTO      EQTY9000
            ENDIF
          ENDIF
          MATCH    SP70,SIPCCON
          GOTO     EQTY9000 IF EQUAL
.
          CALL     CPRIC000
.
          IF       SIPCOQT<SISDMQT
            BEEP
            MOVE      "Quantity Less Than Minimum Contract Quantity - ",DISPMSG
            CALL      MESSAGE1
          ENDIF
.
          IF        (SIPCECT<0)
            MOVE      SEQ,SIPCECT
            MOVE      "        T.B.A.",UNITCOST
          ELSE
            MOVE      "9,999,999.9999",UNITCOST
            FEDIT     SIPCECT,UNITCOST
            MATCH     "*",UNITCOST
            IF        @EQUAL
              MOVE      SIPCECT,F9P4
              MOVE      F9P4,UNITCOST
            ENDIF
          ENDIF
.
EQTY9000  CALL      CALTAX00
          MOVE      ZERO,F12P4
          ASSIGN    SIPCGSTA*SIPCOQT,F12P4
          MOVE      F12P4,TOTALGST
          MOVE      ZERO,F12P4
          ASSIGN    SIPCECT*SIPCOQT,F12P4
          MOVE      F12P4,TOTALCST
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UNITCOST,VAR
            CALL      DISPITEM
          ENDIF
.
          MOVE      "   36",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SIPCGSTA,VAR
            CALL     DISPITEM
          ENDIF
.
          MOVE      "   37",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     TOTALGST,VAR
            CALL     DISPITEM
          ENDIF
.
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     TOTALCST,VAR
            CALL     DISPITEM
          ENDIF
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          MOVE      ZERO,EXIT
.
EQTY9999  RETURN
EPRIC000  MOVE      SP70,VAR
          CALL      DISPITEM
.
          IF        ACCEPT=1
            MATCH     SP70,SIIACAT
            IF        @EQUAL
              MATCH     SP70,SIVACOD       * use service code data if possible
              IF        !@EQUAL&(ACCEPT=1)&(SIVAAMT>0)
                MOVE      SIVAAMT,F9P4
                GOTO      EPRIC100
              ELSE
                MOVE      ZERO,SIPCECT
                MOVE      ZERO,SIPCGSTA
              ENDIF
            ELSE
              MATCH     "1",SIICCONT
              IF        @EQUAL
                MOVE      SIICLCT,F9P4
                GOTO      EPRIC050
              ENDIF
              MATCH     SP70,SIPCCON
              IF        @EQUAL
                MOVE      SIPCECT,F9P4
                GOTO      EPRIC100
              ELSE
                CALL      CPRIC000
                MOVE      SIPCECT,F9P4
                GOTO      EPRIC100
              ENDIF
            ENDIF
          ENDIF
.
EPRIC050  KEYIN     *PCCOL:CVERT,*V2LON,*RV,F9P4
.
          MATCH     "1",SIICCONT
          GOTO      EPRIC100 IF NOT EQUAL
.
          PACK      CEXPDATE,CCC,CYY,CMM,CDD,SP70
          REP       " 0",CEXPDATE
.
          COMPARE   F9P4,SIICLCT
          GOTO      EPRIC085 IF EQUAL
          GOTO      EPRIC090 IF LESS
.
EPRIC085  MATCH     CEXPDATE,SIICCTEX
          GOTO      EPRIC100 IF NOT LESS
.
          BEEP
          CLEAR     DISPMSG
          APPEND    "WARNING: Catalog Contract Has Expired : ",DISPMSG
          RESET     DISPMSG
          CALL      MESSAGE1
          GOTO      EPRIC100
.
EPRIC090  MATCH     CEXPDATE,SIICCTEX
          GOTO      EPRIC093 IF NOT LESS
.
          BEEP
          CLEAR     DISPMSG
          APPEND    "ERROR: Expired Contract Cannot ",DISPMSG
          APPEND    "Increase Price ",DISPMSG
          RESET     DISPMSG
          GOTO      EPRIC095
.
EPRIC093  BEEP
          CLEAR     DISPMSG
          APPEND    "ERROR: Under Contract Cannot ",DISPMSG
          APPEND    "Increase Price ",DISPMSG
          RESET     DISPMSG
.
EPRIC095  CALL      MESSAGE1
          MOVE      SIICLCT,F9P4
          GOTO      EPRIC000
.
EPRIC100  MOVE      F9P4,SIPCECT
          IF        (SIPCECT<0)
            MOVE      SEQ,SIPCECT
            MOVE      "        T.B.A.",UNITCOST
            MOVE      ZERO,SIPCGSTA
            MOVE      ZERO,TOTALGST
            MOVE      ZERO,TOTALCST
          ELSE
            MOVE      "9,999,999.9999",UNITCOST
            FEDIT     SIPCECT,UNITCOST
            MATCH     "*",UNITCOST
            IF        @EQUAL
              MOVE      F9P4,UNITCOST
            ENDIF
            CALL      CALTAX00
            MOVE      ZERO,F12P4
            ASSIGN    SIPCGSTA*SIPCOQT,F12P4
            MOVE      F12P4,TOTALGST
            MOVE      ZERO,F12P4
            ASSIGN    SIPCECT*SIPCOQT,F12P4
            MOVE      F12P4,TOTALCST
          ENDIF
.
EPRIC999  RETURN
.--------------------------------------------------
. Determine Contract Price
.--------------------------------------------------
CPRIC000  PACK     KEY45,SIPASUP,SIPCCAT,SIPCCDT,SIPCCON,SIPCSUT
          CALL     RDSISD3
          BRANCH   OVRCD,CPRIC999
.
          IF        (SISDBQ1=0)|(SIPCOQT<SISDBQ1)
            MOVE      SISDUC1,SIPCECT
            GOTO      CPRIC100
          ENDIF
          IF        (SISDBQ2=0)|(SIPCOQT<SISDBQ2)
            MOVE      SISDUC2,SIPCECT
            GOTO      CPRIC100
          ENDIF
          IF        (SISDBQ3=0)|(SIPCOQT<SISDBQ3)
            MOVE      SISDUC3,SIPCECT
            GOTO      CPRIC100
          ENDIF
          MOVE      SISDUC4,SIPCECT
.
CPRIC100
.
CPRIC999  RETURN
.
CALTAX00  COMPARE   ZERO,SIPCECT
          GOTO      CALTAX90 IF EQUAL
.
          MATCH     SP6,SIPCGST
          GOTO      CALTAX90 IF EQUAL
.
          PACK      KEY8,CCC,CYY,CMM,CDD,SP70
          REP       " 0",KEY8
.
          PACK      KEY14,SIPCGST,KEY8,SP70
          CALL      RDIBGE1
          COMPARE   ZERO,OVRCD
          GOTO      CALTAX10 IF EQUAL
.
          CALL      RPIBGE1
          BRANCH    OVRCD,CALTAX90
.
          MATCH     SIPCGST,IBGECODE
          GOTO      CALTAX90 IF NOT EQUAL
.
CALTAX10  ASSIGN    (SIPCECT-(SIPCECT/(ONE+(IBGEAMNT/HUNDRED)))),SIPCGSTA
          GOTO      CALTAX99
.
CALTAX90  MOVE      ZERO,SIPCGSTA
.
CALTAX99  RETURN
SCREEN04  MATCH     SP70,SIPCCAT
          IF        @EQUAL
            MOVE      "Enter information into Additional Comments - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SCREEN99
          ELSE
            MOVE      SIPCCAT,KEY7
            CALL      RDSIIA1
            PACK      KEY12,SIPCCAT,SIPCWAR
            CALL      RDSIIE1
            PACK      KEY27,SIPCCAT,SIPASUP,SIPCSUT
            CALL      RDSIIC1
            MOVE      SIPASUP,KEY5
            CALL      RDAPMA1
            MOVE      SIPCWAR,KEY5
            CALL      RDSIWA1
            CALL      SC04L000
          ENDIF
SCREEN99  RETURN
.
CAN30000  CALL     DASIPC00   * Delete Before Audit
.
          MATCH    SP70,CANSAVE
          GOTO     CAN39999 IF EQUAL
          PACK     KEY10,CANSAVE
          CALL     RDSIPC1
          BRANCH   OVRCD,CAN39999
.
CAN39999  RETURN
.------------------------------------------------------------
. Delete Order Item
.------------------------------------------------------------
DEL30000  MATCH    SP70,SIPADPR
          IF       !(@EQUAL)
            MOVE     "Order has been printed Deletion Not Allowed - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      DEL39000
          ENDIF
.
          PACK      KEY12,SIPCPON,SIPCITM,SP70
          CALL      RSSIPF1
          CALL      RKSIPF1
          BRANCH    OVRCD,DEL30010
          MATCH     SIPFPON,SIPCPON
          GOTO      DEL30010 IF NOT EQUAL
          MATCH     SIPFITM,SIPCITM
          GOTO      DEL30010 IF NOT EQUAL
          MOVE      "Goods Already Received for This Item - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          GOTO      DEL39000
.
DEL30010
          MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          CALL      DELQST
          CALL      MESSAGE3
          SUB       ONE,CEXIT
          BRANCH    CEXIT,DEL39000,DEL39100
.
          PACK      KEY10,SIPCPON,SIPCITM,SP70
          CALL      RDSIPC1            * is there anything to delete ?
          IF        OVRCD=0
            MOVE      SEQ,OPTIONA      * 1=adding usage, -1=subtracting usage
            MOVE      ZERO,CHECKQTY
            MOVE      ZERO,CHECKCST
            CALL      ADDUA000
            PACK      KEY10,SIPCPON,SIPCITM,SP70
            CALL      DASIPC00         * Delete Before Audit
            MOVE      FOUR,AUDTTYPE
            CALL      WASIPC00         * Delete Audit
            CALL      DESIPC1
          ENDIF
          GOTO      DEL39100
.
.
DEL39000  MOVE     ONE,EXIT
          GOTO     DEL39999
.
DEL39100  MOVE     ZERO,EXIT
          GOTO     DEL39999
.
DEL39999  RETURN
.------------------------------------------------------------
. Post Order Line Item
.------------------------------------------------------------
POS30000  CALL     CHKFMS00
          BRANCH   EXIT,POS39999
.
          CALL     CHKDCM00
          BRANCH   EXIT,POS39999
.
          MOVE     SIPAPON,SIPCPON
          MOVE     SIPADIN,SIPEDATE
          CALL     RSIPE000
          PACK     SIPCDAT,SIPEYEAR,SIPEPER,SP70
.
          MOVE     ZERO,F3
          COMPARE  ZERO,ADDFLAG
          GOTO     POS30020 IF EQUAL
.
POS30010  ADD      ONE,F3
          PACK     KEY10,SIPCPON,F3
          CALL     RASIPC1
          COMPARE  ZERO,OVRCD
          GOTO     POS30010 IF EQUAL
          MOVE     F3,SIPCITM
.
POS30020  MOVE     ZERO,SIIANON
          PACK     KEY7,SIPCCAT
          CALL     RDSIIA1
          MOVE     SIPAWAR,SIPCWAR
.
          PACK     KEY10,SIPCPON,SIPCITM
          CALL     RASIPC1
          IF       OVRCD=0
            CALL     UPSIPC1
            MOVE     THREE,AUDTTYPE
            CALL     WASIPC00     * Audit Change
          ELSE
            MOVE     SP70,SIPCFDD
            MOVE     ZERO,SIPCIQT
            MOVE     ZERO,SIPCRQT
            MOVE     ZERO,SIPCTCR
            MOVE     ZERO,SIPCTGS
            MOVE     ZERO,SIPCTIN
            MOVE     ZERO,SIPCIGS
            MOVE     SIPCOQT,SIPCOQO
            MOVE     SIPCECT,SIPCOOP
            MOVE     SIPCGSTA,SIPCOGS
            CALL     WRSIPC1
            MOVE     ONE,AUDTTYPE
            CALL     WASIPC00     * Audit Add
          ENDIF
.
          IF        HLASTCIN=1
            MATCH     SIPCCAT,SP70
            IF        !@EQUAL
              PACK      KEY27,SIPCCAT,SIPASUP,SIPCSUT,SP70
              CALL      RDSIIC1
              IF        OVRCD=0
                MATCH     "1",SIICCONT
                IF        !@EQUAL
                  MOVE      TWO,AUDTTYPE
                  CALL      WASIIC00
                  MOVE      SIPCECT,SIICLCT
                  CALL      UPSIIC1
                  MOVE      THREE,AUDTTYPE
                  CALL      WASIIC00
                ENDIF
              ENDIF
            ENDIF
          ENDIF
.
          MOVE      ONE,SIFACTOR
          PACK      KEY30,SIIAISS,SIPCSUT,SP70
          CALL      RDSIFA1
.
POS30030  CALL      RLSIIA1
          COMPARE   ZERO,OVRCD
          GOTO      POS30040 IF EQUAL
.
          BRANCH    OVRCD,POS30050
.
          MOVE      "Record Locked.  Keep Trying - ",DISPMSG
          CALL      MESSAGE1
          GOTO      POS30030
.
POS30040  CALL      UPSIIA1
          CALL      UUSIIA1
.
POS30050  CALL      UPALL000      * Update receivals and A/P if sipcect changed
.
          CALL      UPCEB000      * Update committed expenditure
.
          PACK      KEY13,SIPCPON,SIPCITM,SP70
          CALL      RSSIPD1
.
POS31000  CALL      RKSIPD1
          BRANCH    OVRCD,POS31900
          MATCH     SIPDPON,SIPCPON
          GOTO      POS31900 IF NOT EQUAL
          MATCH     SIPDITM,SIPCITM
          GOTO      POS31900 IF NOT EQUAL
          PACK      KEY13,SIPDPON,SIPDITM,SIPDLIN
          CALL      DESIPD1
          GOTO      POS31000
.
POS31900  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIPD1
          TRAPCLR   IO
          BRANCH    OVRCD,POS33000
          MOVE      ONE,F3
.
POS32000  READ      TEMPWORD,SEQ;SIPDCOM
          GOTO      POS33000 IF OVER
          MOVE      F3,SIPDLIN
          PACK      KEY13,SIPCPON,SIPCITM,SIPDLIN
          UNPACK    KEY13,SIPDPON,SIPDITM,SIPDLIN
          CALL      WRSIPD1
          ADD       ONE,F3
          GOTO      POS32000
.
POS33000
          MOVE      ONE,OPTIONA        * 1=adding usage, -1=subtracting usage
          CALL      ADDUA000
          MOVE      ZERO,EXIT
.
POS39999  RETURN
.--------------------------------------------------
. Check If Completed
.--------------------------------------------------
CHKDCM00  MOVE     ZERO,EXIT
          MATCH    SIPADCM,SP70
          IF       !@EQUAL
            MOVE     "01",HLEF
            MOVE     "80",HRIG
            MOVE     "24",HBOT
            MOVE     "23",HTOP
            CALL     GETSCR00
            DISPLAY  *P1:24,*EL,"Order is Completed. Uncomplete it (Y/N)?: "
            MOVE     ZERO,OVRCD
            REPEAT
              MOVE     ANSY,ANS
              KEYIN    *P43:24,*V2LON,*RV,ANS
              PACK     ANS,ANS,SP70
              REP      "yYnN",ANS
              MATCH    "Y",ANS
              IF       @EQUAL
                PACK     KEY7,SIPAPON
                CALL     RDSIPA1
                MOVE     SP70,SIPADCM
                CALL     UPSIPA1
                CALL     SETNDD00
                MOVE     ONE,OVRCD
              ENDIF
              MATCH    "N",ANS
              IF       @EQUAL
                DISPLAY  *P1:24,*EL,"Cannot post addition to ":
                         "Completed Order - ";
                CALL     HITENTER
                MOVE     ONE,OVRCD
                MOVE     ONE,EXIT
              ENDIF
            UNTIL   OVRCD=1
            CALL    PUTSCR00
            MOVE      "10",HTOP
            MOVE      "24",HBOT
            MOVE      "20",HLEF
            MOVE      "80",HRIG
          ENDIF
.
CHKDCM99  RETURN
.--------------------------------------------------
. Set Next Delivery Date
.--------------------------------------------------
SETNDD00  PACK      KEY12,SIPCPON,SIPCITM,Z70
          CALL      RSSIPF1
          CALL      RPSIPF1
          BRANCH    OVRCD,SETNDD99
.
          PACK      KEY10,SIPFPON,SIPFITM
          MATCH     KEY10,KEY12
          GOTO      SETNDD99 IF NOT EQUAL
.
          MATCH     SIPFNDD,SP70
          GOTO      SETNDD99 IF NOT EQUAL
.
. ------- Must set Next Delivery Date - to come up in print receivals
          CALL      GETSCR00
          DISPLAY   *P1:24,*EL,"Enter Next Delivery Date for Item: ";
          MOVE      "24",CVERT
          MOVE      "36",CCOL
.
SETNDD10  PACK      KEY8,CCC,CYY,CMM,CDD
          REP       " 0",KEY8
          UNPACK    KEY8,CCENT,CYEAR,CMON,CDAY
          CALL      KEYDATE
          IF        OVRCD=1
            MOVE      "Invalid Date Entry..Please re-enter - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SETNDD10
          ELSE
            PACK      SIPFNDD,CCENT,CYEAR,CMON,CDAY
            REP       " 0",SIPFNDD
          ENDIF
          CALL      UPSIPF1
          CALL      PUTSCR00
.
SETNDD99  RETURN
.--------------------------------------------------
. Check Accounting System
.--------------------------------------------------
CHKFMS00  IF       HACCNT<>1
            UNPACK   SP70,FMAMLEDG,FMAMACCT
            MOVE     ZERO,EXIT
            GOTO     CHKFMS99
          ENDIF
.
          MATCH     SP70,SIPCCAT
          GOTO      CHKFMS50 IF EQUAL
          BRANCH    SIIANON,CHKFMS50
.
          MOVE      SIPCWAR,KEY5
          CALL      RDSIWA1
          IF        OVRCD=1
            MOVE      "Warehouse Code Missing - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            MOVE      SP70,KEY5
            CALL      RSSIWA1
            CALL      RKSIWA1
          ENDIF
.
          MOVE      SIWALED,FMAMLEDG
          BRANCH    SIWAPTY,CHKFMS10,CHKFMS10
          MOVE      SIWAPACC,FMAMACCT
          GOTO      CHKFMS90
.
CHKFMS10  STORE     SIWAPACC,FMSUUD4A,KEY1,KEY2,KEY3,KEY4,KEY5,KEY6:
                                      KEY7,KEY8,KEY9,KEY10,KEY11,KEY12
          LOAD      FMAMACCT,FMSUUD4A,KEY1,KEY2,KEY3,KEY4,KEY5,KEY6:
                                   KEY7,KEY8,KEY9,KEY10,KEY11,KEY12
          IF        FMSUUD2A=1
            PACK      FMAMACCT,FMAMACCT,FMSUUD2B
          ENDIF
          MOVE      SIIASUB,KEY5
          CALL      RDSISA1
          BRANCH    SIWAPTY,CHKFMS80,CHKFMS85
          GOTO      CHKFMS80
.
. Non Stock
.----------
CHKFMS50  MOVE      HDEFWH,KEY5
          CALL      RDSIWA1
          IF        OVRCD=1
            MOVE      "WARNING: Default Warehouse Missing.First Used.- ",DISPMSG
            BEEP
            CALL      MESSAGE1
            MOVE      SP70,KEY5
            CALL      RSSIWA1
            CALL      RKSIWA1
          ENDIF
.
          PACK      SICAGL,SP70
          MOVE      SIPCCST,KEY5
          CALL      RDSICA1
          IF        OVRCD=1
            BEEP
            CLEAR     DISPMSG
            APPEND    "Invalid Cost Centre : ",DISPMSG
            APPEND    KEY5,DISPMSG
            APPEND    " - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
          ENDIF
.
          UNPACK    SICAGL,FMAMLEDG,FMAMACCT
          MATCH     SP70,FMAMACCT      * use posting acc if no CC
          GOTO      CHKFMS82 IF EQUAL
.
          STORE     FMAMACCT,FMSUUD4A,KEY1,KEY2,KEY3,KEY4,KEY5,KEY6:
                                     KEY7,KEY8,KEY9,KEY10,KEY11,KEY12
          LOAD      FMAMACCT,FMSUUD4A,KEY1,KEY2,KEY3,KEY4,KEY5,KEY6:
                                     KEY7,KEY8,KEY9,KEY10,KEY11,KEY12
          IF        FMSUUD2A=1
            PACK      FMAMACCT,FMAMACCT,FMSUUD2B
          ENDIF
.
          MATCH     SP70,SIPCPRD
          IF        @EQUAL
            MOVE      SIIASUB,SIPCPRD
          ENDIF
          PACK      KEY5,SIPCPRD,SP70
          CALL      RDSISA1
          BRANCH    SIWATYP,CHKFMS85,CHKFMS82
.
CHKFMS80
          PACK      SILTSUB,SIPCPRD,SP70
          CALL      GTRA0000                       * check for translation table
          PACK      FMAMACCT,FMAMACCT,SILTSUB,SP70 * Add subjective code
          GOTO      CHKFMS90
.
CHKFMS82
          PACK      FMAMACCT,SICAPACC,SP70         * Use CC Posting Account
          GOTO      CHKFMS90
.
CHKFMS85
          PACK      SILTSUB,SISACOMM,SP70
          CALL      GTRA0000                       * check for translation table
          PACK      FMAMACCT,FMAMACCT,SILTSUB,SP70 * Add commodity code
          GOTO      CHKFMS90
.
CHKFMS90  PACK      KEY14,FMAMLEDG,FMAMACCT,SP70
          CALL      RDFMAM1
          COMPARE   ZERO,OVRCD
          GOTO      CHKFMS92 IF EQUAL
          SQUEEZE   KEY14
          CALL      RDFMAM1
          BRANCH    OVRCD,CHKFMS96
.
CHKFMS92  MOVE      FMAMTYPE,F1
.
          IF        F1>0 & F1<6
            IF        FMAMSTAT<>0
              CLEAR     DISPMSG
              APPEND    "ERROR: Ledger/Account: ",DISPMSG
              APPEND    FMAMLEDG,DISPMSG
              APPEND    "/",DISPMSG
              APPEND    FMAMACCT,DISPMSG
              APPEND    " is Closed - ",DISPMSG
              RESET     DISPMSG
              BEEP
              CALL      MESSAGE1
              MOVE      ONE,EXIT
              GOTO      CHKFMS99
            ELSE
              MOVE      ZERO,EXIT
              GOTO      CHKFMS99
            ENDIF
          ENDIF
.
          CLEAR     DISPMSG
          APPEND    "Invalid Ledger/Account Type : ",DISPMSG
          APPEND    FMAMLEDG,DISPMSG
          APPEND    "/",DISPMSG
          APPEND    FMAMACCT,DISPMSG
          APPEND    " - ",DISPMSG
          RESET     DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      ONE,EXIT
.
          GOTO      CHKFMS99
.
CHKFMS96  CLEAR     DISPMSG
          APPEND    "Invalid Ledger/Account : ",DISPMSG
          APPEND    FMAMLEDG,DISPMSG
          APPEND    "/",DISPMSG
          APPEND    FMAMACCT,DISPMSG
          APPEND    " - ",DISPMSG
          RESET     DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      ONE,EXIT
.
CHKFMS99  RETURN
.--------------------------------------------------
. Update all relevant files
.--------------------------------------------------
UPALL000  IF       SIPCECT<>ORIGECT
            GOTO     UPALL050
          ENDIF
          IF       SIPCGSTA=ORIGGST
            GOTO     UPALL999
          ENDIF
.
UPALL050  MOVE     ZERO,FORM6
          PACK     KEY12,SIPAPON,SIPCITM,SP70
          CALL     RSSIPF1
UPALL100  CALL     RKSIPF1
          BRANCH   OVRCD,UPALL500
.
          MATCH     SIPFPON,SIPAPON
          GOTO      UPALL500 IF NOT EQUAL
.
          MATCH     SIPFITM,SIPCITM
          GOTO      UPALL500 IF NOT EQUAL
.
          PACK      KEY12,SIPFPON,SIPFITM,SIPFREC,SP70
          MOVE      SIPCECT,SIPFCST
          MOVE      SIPCGSTA,SIPFGST
          CALL      UPSIPF1
          GOTO      UPALL100
.
. ------- Update Accounts Payable with new expected cost - if running FMS
UPALL500  IF        HACCNT<>1
            GOTO      UPALL999
          ENDIF
          MOVE      ZERO,FORM6
.
          MOVE      ZERO,FORM6
          PACK      KEY11,HORDDES,SIPAPON,SIPCITM,SP70
          PACK      KEY14,HORDDES,SIPAPON,SIPCITM,SP70
          CALL      RSAPOD1
UPALL600  CALL      RKAPOD1
          BRANCH    OVRCD,UPALL999
.
          PACK      KEY14,APODISC,APODORD,APODCAT,SP70
          MATCH     KEY11,KEY14
          GOTO      UPALL999 IF NOT EQUAL
.
          IF        OVRCD<>0
            IF        FORM6>100
              CALL      APSLOK00
              MOVE      ZERO,FORM6
            ENDIF
            ADD       ONE,FORM6
            CALL      RPAPOD1
            GOTO      UPALL600
          ENDIF
.
          MOVE      SIPCECT,APODUCT
          ASSIGN    APODUCT*APODQTY,APODAMT
          MOVE      SIPCGSTA,APODUGS
          ASSIGN    APODUGS*APODQTY,APODGSTA
          MOVE      SIPCGST,APODGST
          CALL      UPAPOD1
          GOTO      UPALL600
.
UPALL999  RETURN
.--------------------------------------------------
. A/P Record Locked
.--------------------------------------------------
APSLOK00  MOVE      "A/P apsordaf record is locked - ",DISPMSG
          CALL      MESSAGE1
.
APSLOK99  RETURN
.--------------------------------------------------
. Receival Record Locked
.--------------------------------------------------
RECLOK00  MOVE      "Receivals record is locked - ",DISPMSG
          CALL      MESSAGE1
.
RECLOK99  RETURN
.----------------------------------------------------------------------
. get subjective/commodity translation
.----------------------------------------------------------------------
GTRA0000  PACK      KEY8,FMAMLEDG,SILTSUB,SP70                         *C-59696
          CALL      RDSILT1
.
GTRA9999  RETURN
.----------------------------------------------------------------------
. Fix Usage and Stock On Order for whole order
.     NOTE: Should be the same routine in IBASIN50 and IBASIN58
.     Requires - OPTIONA  (-1=reversing usage, 1=adding usage)
.----------------------------------------------------------------------
ADDUS000  MOVE      ZERO,CHECKQTY
          MOVE      ZERO,CHECKCST
          PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPC1
.
ADDUS010  CALL      RKSIPC1
          BRANCH    OVRCD,ADDUS999
          MATCH     SIPCPON,SIPAPON
          GOTO      ADDUS999 IF NOT EQUAL
.
          CALL      ADDUA000      * update single item
          GOTO      ADDUS010
.
ADDUS999  RETURN
.----------------------------------------------------------------------
. Fix Usage and Stock On Order for single item
.     NOTE: Should be the same routine in IBASIN50 and IBASIN58
.     Requires - OPTIONA  (-1=reversing usage, 1=adding usage)
.                CHECKQTY (original amount)
.                CHECKCST (original cost)
.----------------------------------------------------------------------
ADDUA000  MATCH     SP70,SIPCCAT
          IF        @EQUAL
            MOVE      ONE,SIIANON
            MOVE      ONE,SIFACTOR
          ELSE
            MOVE      SIPCCAT,KEY7
            CALL      RDSIIA1
            PACK      KEY30,SIIAISS,SIPCSUT
            CALL      RDSIFA1
            IF        OVRCD=1
              MOVE      ONE,SIFACTOR
            ENDIF
          ENDIF
.
          IF        SNCOPURC=1
            MOVE      SIPCECT,SAVECOST
          ELSE
            MOVE      SIPCECT,SAVECOST
            SUB       SIPCGSTA,SAVECOST
          ENDIF
.
          ASSIGN    (SIPCOQT-CHECKQTY)*SIFACTOR*OPTIONA,SIUSQTY
.
          IF        SIPCECT<0
            ASSIGN    -CHECKQTY*CHECKCST*OPTIONA,SIUSCST
          ELSE
            IF        CHECKCST<0
              ASSIGN    SAVECOST*SIPCOQT*OPTIONA,SIUSCST
            ELSE
              ASSIGN    (SAVECOST*SIPCOQT-CHECKQTY*CHECKCST)*OPTIONA,SIUSCST
            ENDIF
          ENDIF
          UNPACK    SIPCDAT,SIPEYEAR,SIPEPER
.
          REPEAT
            PACK      KEY12,SIPCCAT,SIPCWAR
            CALL      RLSIIE1
            IF        OVRCD=0
              CALL      UPSIIE00                   * Update Stock on Order
            ENDIF
            IF        OVRCD=2
              BEEP
              MOVE      "Catalog/Warehouse Record Locked. - ",DISPMSG
              CALL      MESSAGE1
            ENDIF
          UNTIL     OVRCD<>2
.
          CALL      SINORDUS                   * Update Purchases Usage
.                                              * Update Committed Exp 2
          COMPARE   ZERO,CEAFILE
          GOTO      ADDUA999 IF NOT EQUAL
          ASSIGN    (SIPCOQT-CHECKQTY)*OPTIONA,MODQTY
          MATCH     SP70,SIPCCAT
          GOTO      ADDUA900 IF EQUAL
.
          BRANCH    SIIANON,ADDUA900
          CALL      USCEA000               * Committed Update Stock
          GOTO      ADDUA999
.
ADDUA900  CALL      UNCEA000               * Committed Update Non-Stock
.
ADDUA999  RETURN
.----------------------------------------------------------------------
. Update Stock On Order
.----------------------------------------------------------------------
UPSIIE00  IF        OPTIONA=-1
            ASSIGN    (SIIESOO-(SIPCOQT*SIFACTOR)),SIIESOO
            GOTO      UPSIIE90
          ENDIF
.
          IF        SIPCOQT > CHECKQTY
            IF        SIPCOQT > SIPCRQT
              IF        SIPCRQT < CHECKQTY
                ASSIGN    ((SIPCOQT-CHECKQTY)*SIFACTOR + SIIESOO),SIIESOO
              ELSE
                ASSIGN    ((SIPCOQT- SIPCRQT)*SIFACTOR + SIIESOO),SIIESOO
              ENDIF
            ENDIF
          ELSE
            IF        SIPCOQT < CHECKQTY
              IF        (CHECKQTY*SIFACTOR) > SIPCRQT
                IF        (SIPCOQT*SIFACTOR) < SIPCRQT
                  ASSIGN    (SIPCRQT-(CHECKQTY*SIFACTOR) + SIIESOO),SIIESOO
                ELSE
                  ASSIGN    ((SIPCOQT-CHECKQTY)*SIFACTOR + SIIESOO),SIIESOO
                ENDIF
              ENDIF
            ENDIF
          ENDIF
.
UPSIIE90  IF        SIIESOO<0
            MOVE      ZERO,SIIESOO
          ENDIF
.
          CALL      UPSIIE1                    * Update Stock on Order
          CALL      UUSIIE1
.
UPSIIE99  RETURN
.----------------------------------------------------------------------
. Update Non-Stock Item to Accounts Payable Files         - in POS30000
.----------------------------------------------------------------------
UNCEA000  MOVE      HORDDES,APEAISC  * System Prefix
          MOVE      SIPCPON,APEAORD
          MOVE      SIPASUP,APEACRD
          PACK      KEY8,APEAISC,APEAORD,SP70
          CALL      RDAPEA1         * Order Header Record
          IF        OVRCD=1
            MOVE      SIPADIN,APEADAT
            CALL      WRAPEA1
          ELSE
            MATCH     SIPASUP,APEACRD
            IF        !@EQUAL
              MOVE      SIPASUP,APEACRD
              MOVE      SIPADIN,APEADAT
              CALL      UPAPEA1
            ENDIF
          ENDIF
.
          MOVE      HORDDES,APEBISC  * System Prefix
          MOVE      SIPCPON,APEBORD
          PACK      APEBCAT,SIPCITM,SP70
          PACK      KEY14,APEBISC,APEBORD,APEBCAT
          CALL      RDAPEB1
          IF        OVRCD=0
            ADD       MODQTY,APEBQTY
            MOVE      SIPCECT,APEBUCT
            MOVE      SIPCGSTA,APEBUGS
            ASSIGN    APEBQTY*APEBUCT,APEBAMT
            ASSIGN    APEBQTY*APEBUGS,APEBGST
            IF        APEBQTY>0
              CALL      UPAPEB1
            ELSE
              CALL      DEAPEB1
              UNPACK    SP70,APEBISC,APEBORD,APEBCAT
              PACK      KEY8,APEAISC,APEAORD,SP70
              PACK      KEY14,KEY8,SP70
              CALL      RSAPEB1
              CALL      RKAPEB1
              PACK      KEY14,APEBISC,APEBORD,APEBCAT,SP70
              MATCH     KEY8,KEY14
              CALL      DEAPEA1 IF NOT EQUAL
            ENDIF
.
            MOVE      MODQTY,APEBQTY
            MOVE      SIPCECT,APEBUCT
            MOVE      SIPCGSTA,APEBUGS
            ASSIGN    APEBQTY*APEBUCT,APEBAMT
            ASSIGN    APEBQTY*APEBUGS,APEBGST
            CALL      UFMFP000         * update committed expenditure
            GOTO      UNCEA999
          ENDIF
.
. No Existing Record
.--------------------
          MOVE      HDEFWH,KEY5
          CALL      RDSIWA1
          IF        OVRCD=1
            MOVE      SP70,KEY5
            CALL      RSSIWA1
            CALL      RKSIWA1
          ENDIF
.
          PACK      SICAGL,SP70
          MOVE      SIPCCST,KEY5
          CALL      RDSICA1
.
          UNPACK    SICAGL,APEBLED,APEBACC
          MOVE      SIWADISS,APEBDIS
          MOVE      SIWARESP,APEBRES
          MOVE      SP70,APEBSPA
          MOVE      MODQTY,APEBQTY
          MOVE      SIPCECT,APEBUCT
          MOVE      SIPCGSTA,APEBUGS
          ASSIGN    APEBQTY*APEBUCT,APEBAMT
          ASSIGN    APEBQTY*APEBUGS,APEBGST
          MOVE      SIPCPD,APEBDES
.
UNCEA100  MATCH     SP70,APEBACC       * use posting acc if no CC
          GOTO      UNCEA115 IF EQUAL
.
          STORE     APEBACC,FMSUUD4A,KEY1,KEY2,KEY3,KEY4,KEY5,KEY6:
                                     KEY7,KEY8,KEY9,KEY10,KEY11,KEY12
          LOAD      APEBACC,FMSUUD4A,KEY1,KEY2,KEY3,KEY4,KEY5,KEY6:
                                     KEY7,KEY8,KEY9,KEY10,KEY11,KEY12
          IF        FMSUUD2A=1
            PACK      APEBACC,APEBACC,FMSUUD2B
          ENDIF
.
          MATCH     SP70,SIPCPRD
          IF        @EQUAL
            MOVE      SIIASUB,SIPCPRD
          ENDIF
          PACK      KEY5,SIPCPRD,SP70
          CALL      RDSISA1
          BRANCH    SIWATYP,UNCEA120,UNCEA115
.
UNCEA110
          PACK      SILTSUB,SIPCPRD,SP70
          PACK      FMAMLEDG,APEBLED,SP70
          CALL      GTRA0000                     * check for translation table
          PACK      APEBACC,APEBACC,SILTSUB,SP70 * Add subj code
          GOTO      UNCEA200
.
UNCEA115
          PACK      APEBACC,SICAPACC,SP70        * Use CC Posting Account
          GOTO      UNCEA200
.
UNCEA120  MOVE      SISACOMM,KEY6                                      *C-59696
          CALL      RDSIGA1
          PACK      SILTSUB,SISACOMM,SP70
          PACK      FMAMLEDG,APEBLED,SP70
          CALL      GTRA0000                     * check for translation table
          PACK      APEBACC,APEBACC,SILTSUB,SP70 * Add commodity code
.
UNCEA200
          CALL      XHKFMS00
.                                           * don't write if qty=0     *I-43474
          IF        APEBQTY > 0
            CALL      WRAPEB1
          ENDIF                                                        *I-43474
          CALL      UFMFP000           * update committed expenditure
.
UNCEA999  RETURN
.------------------------------------------------------------
. Check FMS Account
.------------------------------------------------------------
XHKFMS00  MOVE      ZERO,FMAMTYPE
          PACK      KEY14,APEBLED,APEBACC,SP70
          CALL      RDFMAM1
          IF        OVRCD=1
            SQUEEZE   KEY14
            CALL      RDFMAM1
            IF        OVRCD=0
              UNPACK    KEY14,APEBLED,APEBACC
            ENDIF
          ENDIF
.
          RETURN
.----------------------------------------------------------------------
. Update Stock Item to Accounts Payable Files             - in POS30000
.----------------------------------------------------------------------
USCEA000  MOVE      HORDDES,APEAISC  * System Prefix
          MOVE      SIPCPON,APEAORD
          MOVE      SIPASUP,APEACRD
          PACK      KEY8,APEAISC,APEAORD,SP70
          CALL      RDAPEA1         * Order Header Record
          IF        OVRCD=1
            MOVE      SIPADIN,APEADAT
            CALL      WRAPEA1
          ELSE
            MATCH     SIPASUP,APEACRD
            IF        !@EQUAL
              MOVE      SIPASUP,APEACRD
              MOVE      SIPADIN,APEADAT
              CALL      UPAPEA1
            ENDIF
          ENDIF
.
          MOVE      HORDDES,APEBISC  * System Prefix
          MOVE      SIPCPON,APEBORD
          PACK      APEBCAT,SIPCITM,SP70
          PACK      KEY14,APEBISC,APEBORD,APEBCAT
          CALL      RDAPEB1
          IF        OVRCD=0
            ADD       MODQTY,APEBQTY
            MOVE      SIPCECT,APEBUCT
            MOVE      SIPCGSTA,APEBUGS
            ASSIGN    APEBQTY*APEBUCT,APEBAMT
            ASSIGN    APEBQTY*APEBUGS,APEBGST
            IF        APEBQTY>0
              CALL      UPAPEB1
            ELSE
              CALL      DEAPEB1
              UNPACK    SP70,APEBISC,APEBORD,APEBCAT
              PACK      KEY8,APEAISC,APEAORD,SP70
              PACK      KEY14,KEY8,SP70
              CALL      RSAPEB1
              CALL      RKAPEB1
              PACK      KEY14,APEBISC,APEBORD,APEBCAT,SP70
              MATCH     KEY8,KEY14
              CALL      DEAPEA1 IF NOT EQUAL
            ENDIF
.
            MOVE      MODQTY,APEBQTY
            MOVE      SIPCECT,APEBUCT
            MOVE      SIPCGSTA,APEBUGS
            ASSIGN    APEBQTY*APEBUCT,APEBAMT
            ASSIGN    APEBQTY*APEBUGS,APEBGST
            CALL      UFMFP000         * update committed expenditure
            GOTO      USCEA999
          ENDIF
.
. No Existing Record
.--------------------
          MOVE      SIPCWAR,KEY5
          CALL      RDSIWA1
          IF        OVRCD=1
            MOVE      SP70,KEY5
            CALL      RSSIWA1
            CALL      RKSIWA1
          ENDIF
.
          MOVE      SIWALED,APEBLED
          MOVE      SIWADISS,APEBDIS
          MOVE      SIWARESP,APEBRES
          MOVE      SP70,APEBSPA
          MOVE      MODQTY,APEBQTY
          MOVE      SIPCECT,APEBUCT
          MOVE      SIPCGSTA,APEBUGS
          ASSIGN    APEBQTY*APEBUCT,APEBAMT
          ASSIGN    APEBQTY*APEBUGS,APEBGST
          MOVE      SIPCPD,APEBDES
.
          BRANCH    SIWAPTY,USCEA100,USCEA100
          MOVE      SIWAPACC,APEBACC
          GOTO      USCEA200
.
USCEA100  STORE     SIWAPACC,FMSUUD4A,KEY1,KEY2,KEY3,KEY4,KEY5,KEY6:
                                      KEY7,KEY8,KEY9,KEY10,KEY11,KEY12
          LOAD      APEBACC,FMSUUD4A,KEY1,KEY2,KEY3,KEY4,KEY5,KEY6:
                                     KEY7,KEY8,KEY9,KEY10,KEY11,KEY12
          IF        FMSUUD2A=1
            PACK      APEBACC,APEBACC,FMSUUD2B
          ENDIF
          PACK      KEY5,SIPCPRD,SP70
          CALL      RDSISA1
          BRANCH    SIWAPTY,USCEA110,USCEA120
.
USCEA110
          PACK      SILTSUB,SIPCPRD,SP70
          PACK      FMAMLEDG,APEBLED,SP70
          CALL      GTRA0000                     * check for translation table
          PACK      APEBACC,APEBACC,SILTSUB,SP70 * Add subj code
          GOTO      USCEA200
.
USCEA120  MOVE      SISACOMM,KEY6                                      *C-59696
          CALL      RDSIGA1
          PACK      SILTSUB,SISACOMM,SP70
          PACK      FMAMLEDG,APEBLED,SP70
          CALL      GTRA0000                     * check for translation table
          PACK      APEBACC,APEBACC,SILTSUB,SP70 * Add commodity code
.
USCEA200
          CALL      XHKFMS00
.                                           * don't write if qty=0     *I-43474
          IF        APEBQTY > 0
            CALL      WRAPEB1
          ENDIF                                                        *I-43474
          CALL      UFMFP000           * update committed expenditure
.
USCEA999  RETURN
.----------------------------------------------------------------------
. Update period summary file
.----------------------------------------------------------------------
UFMFP000
          PACK      KEY2,APEBLED,SP70
          CALL      RDFMLA1
          BRANCH    OVRCD,UFMFP999
.
          PACK      KEY14,APEBLED,APEBACC,SP70
          CALL      RDFMAM1
          BRANCH    OVRCD,UFMFP999
.
          PACK      WORKDATE,APEADAT,SP70
          CALL      CFYR0000
          BRANCH    EXIT,UFMFP999
.
          MOVE      "fmsp",KEY4
          PACK      KEY8,KEY4,CURYEAR,SP70
          REP       " 0",CURYEAR
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      FMSFPSA1,KEY8
          TRAPCLR   IO
          BRANCH    OVRCD,UFMFP999
.
          PACK      KEY14,APEBLED,APEBACC,SP70
          UNPACK    KEY14,FMFPCULD,FMFPCUAC
          CALL      RDFMFP1
          IF        OVRCD=0
            ASSIGN    APEBAMT+FMFPCOM2,FMFPCOM2
            CALL      UPFMFP1
          ELSE
            MOVE      ZERO,FMFPCBF
            MOVE      ZERO,FMFPC01
            MOVE      ZERO,FMFPC02
            MOVE      ZERO,FMFPC03
            MOVE      ZERO,FMFPC04
            MOVE      ZERO,FMFPC05
            MOVE      ZERO,FMFPC06
            MOVE      ZERO,FMFPC07
            MOVE      ZERO,FMFPC08
            MOVE      ZERO,FMFPC09
            MOVE      ZERO,FMFPC10
            MOVE      ZERO,FMFPC11
            MOVE      ZERO,FMFPC12
            MOVE      ZERO,FMFPC13
.
            MOVE      ZERO,FMFPABF
            MOVE      ZERO,FMFPA01
            MOVE      ZERO,FMFPA02
            MOVE      ZERO,FMFPA03
            MOVE      ZERO,FMFPA04
            MOVE      ZERO,FMFPA05
            MOVE      ZERO,FMFPA06
            MOVE      ZERO,FMFPA07
            MOVE      ZERO,FMFPA08
            MOVE      ZERO,FMFPA09
            MOVE      ZERO,FMFPA10
            MOVE      ZERO,FMFPA11
            MOVE      ZERO,FMFPA12
            MOVE      ZERO,FMFPA13
            MOVE      ZERO,FMFPCOM
.
            MOVE      ZERO,FMFPCBFD
            MOVE      ZERO,FMFPC01D
            MOVE      ZERO,FMFPC02D
            MOVE      ZERO,FMFPC03D
            MOVE      ZERO,FMFPC04D
            MOVE      ZERO,FMFPC05D
            MOVE      ZERO,FMFPC06D
            MOVE      ZERO,FMFPC07D
            MOVE      ZERO,FMFPC08D
            MOVE      ZERO,FMFPC09D
            MOVE      ZERO,FMFPC10D
            MOVE      ZERO,FMFPC11D
            MOVE      ZERO,FMFPC12D
            MOVE      ZERO,FMFPC13D
.
            MOVE      ZERO,FMFPABFD
            MOVE      ZERO,FMFPA01D
            MOVE      ZERO,FMFPA02D
            MOVE      ZERO,FMFPA03D
            MOVE      ZERO,FMFPA04D
            MOVE      ZERO,FMFPA05D
            MOVE      ZERO,FMFPA06D
            MOVE      ZERO,FMFPA07D
            MOVE      ZERO,FMFPA08D
            MOVE      ZERO,FMFPA09D
            MOVE      ZERO,FMFPA10D
            MOVE      ZERO,FMFPA11D
            MOVE      ZERO,FMFPA12D
            MOVE      ZERO,FMFPA13D
            MOVE      ZERO,FMFPCOMD
.
            MOVE      ZERO,FMFPCBFT
            MOVE      ZERO,FMFPC01T
            MOVE      ZERO,FMFPC02T
            MOVE      ZERO,FMFPC03T
            MOVE      ZERO,FMFPC04T
            MOVE      ZERO,FMFPC05T
            MOVE      ZERO,FMFPC06T
            MOVE      ZERO,FMFPC07T
            MOVE      ZERO,FMFPC08T
            MOVE      ZERO,FMFPC09T
            MOVE      ZERO,FMFPC10T
            MOVE      ZERO,FMFPC11T
            MOVE      ZERO,FMFPC12T
            MOVE      ZERO,FMFPC13T
.
            MOVE      ZERO,FMFPABFT
            MOVE      ZERO,FMFPA01T
            MOVE      ZERO,FMFPA02T
            MOVE      ZERO,FMFPA03T
            MOVE      ZERO,FMFPA04T
            MOVE      ZERO,FMFPA05T
            MOVE      ZERO,FMFPA06T
            MOVE      ZERO,FMFPA07T
            MOVE      ZERO,FMFPA08T
            MOVE      ZERO,FMFPA09T
            MOVE      ZERO,FMFPA10T
            MOVE      ZERO,FMFPA11T
            MOVE      ZERO,FMFPA12T
            MOVE      ZERO,FMFPA13T
            MOVE      ZERO,FMFPCOMT
.
            PACK      FMFPSPAR,SP70,SP70
            ASSIGN    APEBAMT,FMFPCOM2
            CALL      WRFMFP1
          ENDIF
.
          COMPARE   ONE,FMCOCALC
          GOTO      UFMFP999 IF NOT EQUAL
.
          PACK      KEY20,PORT,CURYEAR,APEBLED,APEBACC,SP70
          CALL      RDFMTU1            * record exists ?
          COMPARE   ZERO,OVRCD
          GOTO      UFMFP999 IF EQUAL
.
          UNPACK    KEY20,FMTUPORT,FMTUSPEC,FMTUTLED,FMTUTACC
          MOVE      FMAMCLEV,FMTULEV
          MOVE      ZERO,FMTUACT
          MOVE      ZERO,FMTUBUD
          MOVE      SP70,FMTUSPAR
          CALL      WRFMTU1            * Flag For Total Account Update
.
UFMFP999  RETURN
.
UPCEB000  IF       HACCNT<>1
            GOTO     UPCEB999
          ENDIF
.
          PACK      KEY8,HORDDES,SIPCPON,SP70
          CALL      RDAPEA1
          BRANCH    OVRCD,UPCEB999
.
          PACK      KEY14,HORDDES,SIPCPON,SIPCITM,SP70
          CALL      RDAPEB1
          BRANCH    OVRCD,UPCEB999
.
          MATCH     FMAMLEDG,APEBLED
          GOTO      UPCEB500 IF NOT EQUAL
          MATCH     FMAMACCT,APEBACC
          GOTO      UPCEB999 IF EQUAL
.
UPCEB500  MOVE      FMAMLEDG,APEBLED
          MOVE      FMAMACCT,APEBACC
          CALL      UPAPEB1
          GOTO      UPCEB999
.
UPCEB800  MOVE      HORDDES,APEBISC
          MOVE      SIPCPON,APEBORD
          PACK      APEBCAT,SIPCITM,SP70
          MOVE      FMAMLEDG,APEBLED
          MOVE      FMAMACCT,APEBACC
          MOVE      SIPCPD,APEBDES
          MOVE      SIWADISS,APEBDIS
          MOVE      SIWARESP,APEBRES
          MOVE      SIPCECT,APEBUCT
          MOVE      SIPCECT,APEBAMT
          MULT      SIPCOQT,APEBAMT
          MOVE      SIPCGSTA,APEBUGS
          MOVE      SIPCGSTA,APEBGST
          MULT      SIPCOQT,APEBGST
          MOVE      SIPCOQT,APEBQTY
          PACK      APEBSPA,SP70
          CALL      WRAPEB1
          GOTO      UPCEB999
.
UPCEB999  RETURN
.------------------------------------------------------------
. Enter GST Code
.------------------------------------------------------------
EGSTC000  MOVE     ZERO,SECTOR
          PACK     KEY7,SIPCCAT,SP70
          CALL     RDSIIA1
          BRANCH   OVRCD,EGSTC100
.
          MOVE     SIIAGST,SIPCGST
          MATCH    SP6,SIIAGST
          GOTO     EGSTC010 IF EQUAL
.
          MOVE     SIIAGST,KEY6
          CALL     RDIBGS1
          IF       OVRCD=1
            MOVE     "Catalog Item Has an Invalid GST Code - ",DISPMSG
            CALL     MESSAGE1
            GOTO     EGSTC100
          ENDIF
.
EGSTC010  BRANCH   ACCEPT,EGSTC999
          IF       ACCEPT=0 & SIIANON=1
            GOTO     EGSTC100
          ENDIF
.
          BEEP
          MOVE     "Item is Cataloged. GST Code Cannot Change. - ",DISPMSG
          CALL     MESSAGE1
          GOTO     EGSTC999
.
EGSTC100  MATCH    SP70,SIVACOD        * use service code data if possible
          GOTO     EGSTC200 IF EQUAL
          COMPARE  ZERO,ACCEPT          * use service code data if possible
          GOTO     EGSTC200 IF EQUAL
.
          PACK     KEY6,SIVAGST,SP70
          CALL     RDIBGS1
          BRANCH   OVRCD,EGSTC200
          GOTO     EGSTC300
.
EGSTC200  MOVE     ZERO,CKEYTYP
          CALL     KIBGSA00
          BRANCH   EXIT,EGSTC250,EGSTC999
          GOTO     EGSTC300
.
EGSTC250  MOVE     SP6,IBGSCODE
          MOVE     SP70,IBGSDESC
.
.         MOVE     LASTGST,KEY6
.         CALL     RDIBGS1
.         BRANCH   OVRCD,EGSTC200
          MOVE     ZERO,EXIT
.
EGSTC300  MOVE     IBGSCODE,SIPCGST
          MOVE     IBGSCODE,LASTGST     * Save Last GST Code Entered
.
          CALL      CALTAX00
          MOVE      ZERO,F12P4
          ASSIGN    SIPCGSTA*SIPCOQT,F12P4
          MOVE      F12P4,TOTALGST
          MOVE      ZERO,F12P4
          ASSIGN    SIPCECT*SIPCOQT,F12P4
          MOVE      F12P4,TOTALCST
.
          MOVE      "   36",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SIPCGSTA,VAR
            CALL     DISPITEM
          ENDIF
.
          MOVE      "   37",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     TOTALGST,VAR
            CALL     DISPITEM
          ENDIF
.
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     TOTALCST,VAR
            CALL     DISPITEM
          ENDIF
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
.
EGSTC999  RETURN
.
.********************************************************************
. Set accept mode
.********************************************************************
SETACCEP  MOVE      ONE,ACCEPT
          RETURN
DEFPTD00  IF    ACCEPT=1
            MOVE    SIIADES,SIICPD1
          ENDIF
          RETURN
DEFAULTN    MOVE     ANSN,DEFYESNO
            RETURN
DEFAULTY    MOVE     ANSY,DEFYESNO
            RETURN
.----------------------------------------------------------------------
. Keyin SIFA
.----------------------------------------------------------------------
KSIFA000  MOVE      SP70,SIFASUPP
          PACK      SIFAISSU,SIIAISS,SP70
          CALL      KSIFAB00                     * keyin SIFA
          BRANCH    EXIT,KSIFA950,KSIFA950
.
          PACK      SIPCSUT,SIFASUPP,SP70
.
KSIFA900  MOVE      ZERO,EXIT
          GOTO      KSIFA999
.
KSIFA950  MOVE      TWO,EXIT
.
KSIFA999  RETURN
.----------------------------------------------
. Enter Code
.----------------------------------------------
ECOD1000  MOVE        ZERO,CKEYTYP
          MOVE        "ic1",SICDCATA
          MOVE        SP70,UDC1DESC
          CALL        KSICDB00
          BRANCH      EXIT,ECOD1999,ECOD1999
          MOVE        SICDCODE,SIICUC1
          MOVE        SICDDESC,UDC1DESC
.
ECOD1999  RETURN
.----------------------------------------------
. Enter Code
.----------------------------------------------
ECOD2000  MOVE        ZERO,CKEYTYP
          MOVE        "ic2",SICDCATA
          MOVE        SP70,UDC2DESC
          CALL        KSICDB00
          BRANCH      EXIT,ECOD2999,ECOD2999
          MOVE        SICDCODE,SIICUC2
          MOVE        SICDDESC,UDC2DESC
.
ECOD2999  RETURN
P05D0000  PACK     KEY27,SIPCCAT,SIPASUP,SIPCSUT
          UNPACK   KEY27,SIICCAT,SIICSUP,SIICSUT
          CALL     RASIIC1
          IF       OVRCD=0
            GOTO     P05D9999          * should not be there !!
          ELSE
            CALL     WRSIIC1
            MOVE     ONE,AUDTTYPE
          ENDIF
.
          PACK     KEY7,SIICCAT
          CALL     RDSIIA1
          IF       OVRCD=0
            CLOCK    TIME,CTIMEIS
            PACK     SIIADTC,CCC,CYY,CMM,CDD
            REP      " 0",SIIADTC
            MOVE     CTIMEIS,SIIATMC
            MOVE     PASSCODE,SIIAUSC
            CALL     UPSIIA1
          ENDIF
.
          MOVE      SIICCAT,SAVECATA
          MOVE      SIICSUP,SAVECRED
          MOVE      SIICSUT,SAVEUNIT
.
          MATCH     SP70,SIICPNO              * No Check for Blank Part Numbers
          GOTO      P05D0500 IF EQUAL
.
          PACK      KEY35,SIICSUP,SIICPNO,SP70
          PACK      KEY57,SIICSUP,SIICPNO,SP70
          CALL      RSSIIC2
P05D0100
          CALL      RKSIIC2
          BRANCH    OVRCD,P05D0500
          PACK      KEY57,SIICSUP,SIICPNO,SP70
          MATCH     KEY35,KEY57
          GOTO      P05D0500 IF NOT EQUAL
          MATCH     SAVECATA,SIICCAT
          GOTO      P05D0100 IF EQUAL
.
          MOVE      SIICCAT,KEY7
          CALL      RDSIIA1
          IF        OVRCD=1
            MOVE      SAVECATA,KEY7
            CALL      RDSIIA1
            GOTO      P05D0100
          ENDIF
          MOVE      "19",HTOP
          MOVE      "1",HLEF
          MOVE      "80",HRIG
          MOVE      "24",HBOT
          CALL      GETSCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HRIG
          MOVE      ZERO,HBOT
          BEEP
          DISPLAY   *P1:19,*EF
          HLINE     *G37,19,1,80
          HLINE     *G37,23,1,80
          DISPLAY   *P1:20,"Catalog     : ",*V2LON,SIIACAT,*HOFF:
                    *P1:21,"Description : ",*V2LON,SIIADES,*HOFF:
                    *P1:22,"Issue Unit  : ",*V2LON,SIIAISS
.
P05D0200  KEYIN     *P1:24,*EL,*V2LON,"WARNING - ",*HOFF:
                    "Part Number Already on File for this Supplier. ":
                    "Continue (",*V2LON,"Y",*HOFF:
                    "/",*V2LON,"N",*HOFF,") ? ",ANS
          REP       UPPLOW,ANS
          MATCH     ANSN,ANS
          GOTO      P05D4000 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      P05D0200 IF NOT EQUAL
.
. Continue
.
          CALL      PUTSCR00
          MOVE      SAVECATA,KEY7
          CALL      RDSIIA1
.
P05D0500  PACK      KEY27,SAVECATA,SAVECRED,SAVEUNIT
          CALL      RDSIIC1
.
          CALL      WASIIC00                 * Audit Add
          CALL      PALIA000                 * Post Alias
          GOTO      P05D9999
.
. Discontinued Posting
.-----------------------
P05D4000  MOVE      SAVECATA,KEY7
          CALL      PUTSCR00
          CALL      RDSIIA1
          PACK      KEY27,SAVECATA,SAVECRED,SAVEUNIT
          CALL      RDSIIC1
          IF        OVRCD=0
            CALL      DESIIC1
          ENDIF
.
P05D9999  RETURN
.------------------------------------------------------------
. Post Alias
.------------------------------------------------------------
PALIA000  PACK      KEY67,SIIACAT,SP70
          CALL      RSSIIF2
.
PALIA100  CALL      RKSIIF2
          BRANCH    OVRCD,PALIA200
          MATCH     SIIFCAT,SIIACAT
          GOTO      PALIA200 IF NOT EQUAL
          COMPARE   ZERO,SIIFATY
          GOTO      PALIA100 IF EQUAL
          PACK      KEY67,SIIFCAT,SIIFALI
          CALL      DESIIF2
          GOTO      PALIA100
.
PALIA200
          MOVE      SIIACAT,SIIFCAT
          MOVE      SIIADES,SIIFALI
          MOVE      ONE,SIIFATY
          CALL      POSTALIA
.
          PACK      KEY27,SIIACAT,SP70
          CALL      RSSIIC1
PALIA300  CALL      RKSIIC1
          BRANCH    OVRCD,PALIA400
          MATCH     SIICCAT,SIIACAT
          GOTO      PALIA400 IF NOT EQUAL
.
          PACK      SIIFALI,SIICPD1,SP70
          MOVE      SIIACAT,SIIFCAT
          MOVE      TWO,SIIFATY
          CALL      POSTALIA
.
          PACK      SIIFALI,SIICPD2,SP70
          MOVE      SIIACAT,SIIFCAT
          MOVE      TWO,SIIFATY
          CALL      POSTALIA
.
          PACK      SIIFALI,SIICPNO,SP70
          MOVE      SIIACAT,SIIFCAT
          MOVE      THREE,SIIFATY
          CALL      POSTALIA
          GOTO      PALIA300
PALIA400  PROC      WRKCT000            * Update Keyword Index
          RETURN
.
POSTALIA  MATCH     SP70,SIIFALI
          RETURN    IF EQUAL
          PACK      KEY67,SIIFCAT,SIIFALI
          CALL      RASIIF2
          IF        OVRCD=1
            CALL      WRSIIF2
          ENDIF
          RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSCEAIO/INC
          INC       APSCEBIO/INC
          INC       APSCIOIO/INC
          INC       APSCKIKY    
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
          INC       APSORDIO/INC
          INC       APSSNTIO/INC
          INC       APSSUBIO/INC
          INC       FMSAMAIO/INC
          INC       FMSCONIO/INC
          INC       FMSCSAIO/INC
          INC       FMSFPSIO/INC
          INC       FMSLMAIO/INC
          INC       FMSLMCIO/INC
          INC       FMSLMCKY    
          INC       FMSTUPIO/INC
          INC       IBAGEDIO/INC
          INC       IBAGKIKY    
          INC       IBAGSTIO/INC
          INC       IBAGSTKY    
          INC       SINCCAIO/INC
          INC       SINCCAKY    
          INC       SINCGAIO/INC
          INC       SINCGBIO/INC
          INC       SINCIAIO/INC
          INC       SINCIAKY    
          INC       SINCIBIO/INC
          INC       SINCICIO/INC
          INC       SINCICKY    
          INC       SINCIDIO/INC
          INC       SINCIEIO/INC
          INC       SINCIFIO/INC
          INC       SINCIGIO/INC
          INC       SINCIHIO/INC
          INC       SINCODIO/INC
          INC       SINCODKY    
          INC       SINDPCIO/INC
          INC       SINDPCKY    
          INC       SINFACIO/INC
          INC       SINFACKY    
          INC       SINKCTPR    
          INC       SINLTTIO/INC
          INC       SINNATIO/INC
          INC       SINNATKY    
          INC       SINORDUS    
          INC       SINORIIO/INC
          INC       SINORIKY    
          INC       SINPERCD    
          INC       SINPERIO/INC
          INC       SINPOAIO/INC
          INC       SINPOAKY    
          INC       SINPOBIO/INC
          INC       SINPOCIO/INC
          INC       SINPODIO/INC
          INC       SINPOFIO/INC
          INC       SINPONCD    
          INC       SINRCPIO/INC
          INC       SINSCDIO/INC
          INC       SINSCMIO/INC
          INC       SINSUAIO/INC
          INC       SINSUAKY    
          INC       SINSUBIO/INC
          INC       SINSVAIO/INC
          INC       SINSVAKY    
          INC       SINSVBIO/INC
          INC       SINTRNIO/INC
          INC       SINVHAIO/INC
          INC       SINWARIO/INC
          INC       SINWSEIO/INC
          INC       SINWSEKY    
.
          INC       STDGENCD
.
