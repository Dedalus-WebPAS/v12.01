.----------------------------------------------------------------------
.   Program       : FXAPSORD
.   SRF Number    : 177105
.   Modifications : 
.
.----------------------------------------------------------------------
.
.----------------------------------------------------------------------
.  data includes
.----------------------------------------------------------------------
.
          INC       STDGENDF
          INC       APSORDFD/INC
          INC       SINPOAFD/INC
          INC       SINPOFFD/INC
.
.----------------------------------------------------------------------
.  local variables
.----------------------------------------------------------------------
.
.
PRGID     INIT      "FXAPSORD"
PRGNAM    INIT      "Fix APSORDAF"
VERSION   INIT      "V12.01.00"
.
.----------------------------------------------------------------------
.  program code
.----------------------------------------------------------------------
.
.---- initialise screen and confirm desire to execute program ----
.
ML0000    CALL      DISPHEAD
.
          DISPLAY   *P1:10,"This will Remove apsordaf records for P/O that ":
                    *P1:11,"have been purged"
          CALL      CONTQST
          SUB       ONE,CEXIT
          BRANCH    CEXIT,ML9999,ML9999
.
.---- open files ----
.
          OPEN      APSORDA1,"apsordaf"
          OPEN      SINPOAA1,"sinpoaaf"
          OPEN      SINPOFA1,"sinpofaf"
.
.---- loop through apsordaf ----
.
          PACK      KEY14,ANSI,SP70
          MOVE      ZERO,SECTOR
.
ML1000    CALL      RSAPOD1            * read next record
.
ML1100    CALL      RKAPOD1
          BRANCH    OVRCD,ML9999
.
          MATCH     "I",APODISC
          GOTO      ML9999 IF NOT EQUAL
.
          ADD       ONE,SECTOR         * display every 100th record
          IF        SECTOR%1000=1
            DISPLAY   *P1:24,*V2LON,SECTOR," - ",APODORD,*EL;
          ENDIF
.
          PACK      KEY7,APODORD,SP70
          CALL      RDSIPA1
          BRANCH    OVRCD,ML2000
.
          PACK      KEY12,APODORD,APODCAT,SP70
          CALL      RDSIPF1
          BRANCH    OVRCD,ML2000
          GOTO      ML1100
.
ML2000    PACK      KEY14,APODISC,APODORD,APODCAT,SP70
          CALL      DEAPOD1
          GOTO      ML1000
.
.---- exit program ----
.
ML9999    CHAIN     PGM
.----------------------------------------------------------------------
.  code includes
.----------------------------------------------------------------------
.
          INC       APSORDIO/INC
          INC       SINPOAIO/INC
          INC       SINPOFIO/INC
          INC       STDGENCD
.
