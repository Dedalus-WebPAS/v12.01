
.----------------------------------------------------------------------
.   Program       : GENERKLG
.   Description   : This program generates the keyword search for LGA table
.
.   Modifications : 
.----------------------------------------------------------------------
.
.----------------------------------------------------------------------
.  data includes
.----------------------------------------------------------------------
.
          INC       STDGENDF
          INC       IBACONFD/INC
          INC       PATCONFD/INC
          INC       PATLGAFD/INC
          INC       PATKLGFD/INC
.
.----------------------------------------------------------------------
.  local variables
.----------------------------------------------------------------------
.
CURRDATE  DIM       8
DIM26     DIM       26
.
PRGID     INIT      "GENERKLG"
PRGNAM    INIT      "Generate patklgaf"
VERSION   INIT      "V12.01.00"
.
.----------------------------------------------------------------------
.  program code
.----------------------------------------------------------------------
.
.---- initialise screen and confirm desire to execute program ----
.
ML0000    CALL      DISPHEAD
.
.---- open files ----
.
          OPEN      PATLGAA1,"patlgaaf"
          OPEN      PATKLGA1,"patklgaf"
          OPEN      PATKLGA2,"patklgaf"
.
          DISPLAY   *P1:10,"This file generates LGA Keyword records."
          CALL      CONTQST
          SUB       ONE,CEXIT
          BRANCH    CEXIT,ML9999,ML9999
.
.
.  Clears out all keywords records for the previous default claim code
.
ML0500    PACK     KEY56,SP70                     
          CALL     RSPTKLG1                       
          CALL     RKPTKLG1                      
          BRANCH   OVRCD,ML0750             

          ADD       ONE,SECTOR              * display every 1000th record
          IF        SECTOR%1000=1
            DISPLAY   *P1:24,*V2LON,"Deleting.. ",SECTOR," - ",PTLGCODE,*EF;
          ENDIF
.
          PACK     KEY19,PTLGCODE,PTLGKWRD,SP70
          CALL     DEPTKLG1
          GOTO     ML0500
.
.  Rebuilds the keywords file 
.
ML0750    MOVE      ZERO,SECTOR
          PACK      KEY4,SP70
          CALL      RDSLGAA1                * Position read
ML1000    CALL      RDKLGAA1                * Read next record
          BRANCH    OVRCD,ML9999            * At end exit
.
          ADD       ONE,SECTOR              * display every 100th record
          IF        SECTOR%100=1
            DISPLAY   *P1:24,*V2LON,SECTOR," - ",LGACODE,*EF;
          ENDIF

          PROC      PATKLGUP                * Write to keywords file
          GOTO      ML1000                  * Loop back to read next record
.
.---- exit program ----
.
ML9999    CHAIN     PGM
.----------------------------------------------------------------------
.  code includes
.----------------------------------------------------------------------
.
          INC       PATLGAIO/INC
          INC       PATKLGIO/INC
          INC       PATKLGPR
          INC       STDGENCD
.
