.******************************************************************************
          INC       STDGENDF
.
          INC       FMSBCFFD/INC
          INC       FMSCTRFD/INC
          INC       FMSTRNFD/INC
.
FILENAME  DIM       8
FMSR      INIT      "fmsr"
FMST      INIT      "fmst"
DIM4A     DIM       4
DIM4B     DIM       4
FMSR1995  IFILE     SQL, FIXED=141, KEY="U1-5,6-10"
FMST1995  IFILE     SQL, FIXED=141, KEY="U1-5,6-10"
CDATASAV  DIM       20
.
PRGID     INIT      "FX130516"
PRGNAM    INIT      "Change Posting Date Across Financial Years"
VERSION   INIT      "V12.01.00"
.
          CALL      DISPHEAD
.
          OPEN      FMSBCFA1,"fmsbcfaf" 
.  
KEYBATCH  DISPLAY   *P1:4,*EF,"Batch Number  : "; 
          MOVE      "4",CVERT 
          MOVE      "17",CCOL
          CALL      KBCFFM00
          BRANCH    EXIT,ENDIT,ENDIT
          GOTO      KEYPDATE
.
ENDIT     CHAIN     PGM
.
KEYPDATE  DISPLAY   *P1:6,*EF,"Posting Date : ";
          MOVE      "17",CCOL
          MOVE      "6",CVERT
          UNPACK    SP30,CDAY,CMON,CYEAR
          MOVE      CCC,CCENT
          MOVE      ONE,CCENTRY
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          CALL      KEYDATE
          COMPARE   ZERO,OVRCD
          GOTO      KEYFDATE IF EQUAL
.
          DISPLAY   *P1:24,*EL,"Invalid DATE - ";
          CALL      HITENTER
          GOTO      KEYPDATE
.
KEYFDATE  KEYIN     *P1:8,"Enter FROM Financial Year : ",*DE,*JR,*ZF:
                    *V2LON,DIM4A
          KEYIN     *P1:10,"Enter TO   Financial Year : ",*DE,*JR,*ZF:
                    *V2LON,DIM4B
.
OKCONT    CALL      CONTQST
          CMATCH    "1",ANS
          GOTO      KEYBATCH IF NOT EQUAL
.
          PACK      FILENAME,FMSR,DIM4B
          OPEN      FMSCTRA1,FILENAME
          PACK      FILENAME,FMSR,DIM4A
          OPEN      FMSR1995,FILENAME
          PACK      FILENAME,FMST,DIM4B
          OPEN      FMSTRNA1,FILENAME
          PACK      FILENAME,FMST,DIM4A
          OPEN      FMST1995,FILENAME
.
STRTLOOP  PACK      KEY10,FMBCBAT,SP30
LOOP1     CALL      RSFMR95
          CALL      RKFMR95
          BRANCH    OVRCD,END1
.
          MATCH     FMCTBAT,FMBCBAT
          GOTO      END1 IF NOT EQUAL
.
          DISPLAY   *P1:24,*EL,FMCTBAT,"/",FMCTUNIQ
          PACK      FMCTPDAT,CCENT,CYEAR,CMON,CDAY
          PACK      FMCTTDAT,CCENT,CYEAR,CMON,CDAY
.         
          PACK      KEY10,FMCTBAT,FMCTUNIQ
          CALL      RAFMCT1
          COMPARE   ZERO,OVRCD
          GOTO      LOOP1 IF EQUAL
.
          CALL      WRFMCT1
          CALL      DEFMR95
          GOTO      LOOP1
.
END1      PACK      KEY10,FMBCBAT,SP20
LOOP2     CALL      RSFMT95
          CALL      RKFMT95
          BRANCH    OVRCD,END2
.
          MATCH     FMTRBAT,FMBCBAT
          GOTO      END2 IF NOT EQUAL
.
          DISPLAY   *P1:24,*EL,FMTRBAT,"/",FMTRUNIQ
          PACK      FMTRPDAT,CCENT,CYEAR,CMON,CDAY
          PACK      FMTRTDAT,CCENT,CYEAR,CMON,CDAY
.
          PACK      KEY10,FMTRBAT,FMTRUNIQ
          CALL      RAFMTR1
          COMPARE   ZERO,OVRCD
          GOTO      LOOP2 IF EQUAL
.
          CALL      WRFMTR1
          CALL      DEFMT95
          GOTO      LOOP2
.
END2      PACK      FMBCPDAT,CCENT,CYEAR,CMON,CDAY
          PACK      FMBCCDAT,CCENT,CYEAR,CMON,CDAY
          PACK      FMBCDAT,CCENT,CYEAR,CMON,CDAY
          CALL      UPFMBC1
.
          GOTO      KEYBATCH
.
RBCFFM00
          RETURN
.
RSFMR95   RESET     KEY10
          READ      FMSR1995,KEY10;;
          RETURN
.
RKFMR95   MOVE      ZERO,OVRCD
          READKS    FMSR1995;FMCTBAT,FMCTUNIQ,FMCTLEDG,FMCTACCT:
                                  FMCTCRED,FMCTPDAT,FMCTTDAT,FMCTTYPE,FMCTDISS:
                                  FMCTPPER,FMCTDOCR,FMCTAMT,FMCTORD,FMCTRESP:
                                  FMCTDESC,FMCTSPAR
          GOTO      OVERCOND IF OVER
          RETURN
.
DEFMR95   RESET     KEY10
          DELETE    FMSR1995,KEY10
          RETURN
.
RSFMT95   RESET     KEY10
          READ      FMST1995,KEY10;;
          RETURN
.
RKFMT95   MOVE      ZERO,OVRCD
          READKS    FMST1995;FMTRBAT,FMTRUNIQ,FMTRLEDG,FMTRACCT:
                                  FMTRCRED,FMTRPDAT,FMTRTDAT,FMTRTYPE,FMTRDISS:
                                  FMTRPPER,FMTRDOCR,FMTRAMT,FMTRORD,FMTRRESP:
                                  FMTRDESC,FMTRSPAR
          GOTO      OVERCOND IF OVER
          RETURN
.
DEFMT95   RESET     KEY10
          DELETE    FMST1995,KEY10
          RETURN
.
          INC       STDGENCD
          INC       FMSBCFIO/INC
          INC       FMSBCFKY
          INC       FMSCTRIO/INC
          INC       FMSTRNIO/INC
