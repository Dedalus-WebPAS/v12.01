.***************************************************************************
.* System    :   WEB Security                                              *
.* Program   :   GENERSKI.PBL                                              *
.* Desc      :   Web security id keyword generation                        *
.***************************************************************************
.* Date      :   29/10/2010                                                *
.* Author    :   Ebon Clements                                             *
.* Function  :   Populate web security id key words file                   *
.* Modifications  :                                                        *
.***************************************************************************
.* V10.14.01 04/02/2019  Thanh T.      TSK 0862937                         *
.*           Recompiled as WEBSKIPR changed                                *
.* V10.01.00 29/10/2010  Ebon Clements CAR 233151                          *
.*           Created program                                               *
.***************************************************************************
.
. FILE DESCRIPTION INCLUDES
. -----------------------
.
          INC       STDGENDF
          INC       WEBSECFD/INC
          INC       WEBSKIFD/INC
.
PRGID     INIT      "GENERSKI"
PRGNAM    INIT      "Generate Security Id Keyword Table"
VERSION   INIT      "V12.01.00"
.
.----------------------------------------------------------------------
.  program code
.----------------------------------------------------------------------
ML0000    CALL      DISPHEAD
.
          DISPLAY   *P1:10,"Generate Web User Id Keyword Table."
          CALL      CONTQST
          SUB       ONE,CEXIT
          BRANCH    CEXIT,ML9999,ML9999
.
          OPEN      WEBSECA1,"websecaf"
          OPEN      WEBSKIA1,"webskiaf"
.
          MOVE      ZERO,SECTOR
.
          PACK      KEY10,SP70
          CALL      RSWBSE1            * read next record
ML1000    CALL      RKWBSE1 
          BRANCH    OVRCD,ML9999
.
          ADD       ONE,SECTOR
          IF        SECTOR%100=1
            DISPLAY   *P1:24,*V2LON,SECTOR," - ",WBSEUID,*EF;
          ENDIF
.
          PROC      WEBSKIUP
          GOTO      ML1000
.
ML9999    CHAIN     PGM
.----------------------------------------------------------------------
. Includes
.----------------------------------------------------------------------
.
          INC       WEBSECIO/INC
          INC       WEBSKIIO/INC
          INC       WEBSKIPR
          INC       STDGENCD
.
