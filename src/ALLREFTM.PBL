. *----------------------------------------------------------------------
. * Include Name  :   ALREFFTM.PBL
. *
. * Function      :   CGI variables for ALREFFFD - allrefaf.dat
. *
. * Includes Needed :
. *
. *----------------------------------------------------------------------
.  Modifications Done :
.------------------------------------------------------------------------
.  V12.00.01  11.11.2025  Bella Turco    Task 0968146
.             Added websecaf read at the end of ALRE0630 tag to restore logged
.             in user details. Made same change to all instances of RDWBSE1
.  V11.05.02  19.12.2024  DA Sarkies     Task 0954547 
.             Commented out <cat> tags to prevent browser incompatibility
.  V11.05.01  26/11/2024  Ebon Clements  Task 0954547 
.             Added <cat-c> start and end tag to category=XX tag
.------------------------------------------------------------------------
.  V11.04.02  08/02/2023  Thanh T       TSK 0903618
.             Changed SRSBS000 to fix issue with incorrect contract list
.  V11.04.01  17/01/2023  Thanh T       TSK 0903618
.             Added ALRESSUB/ALREF193, ALREX740 and procedure SRSUBSEL
.------------------------------------------------------------------------
.  V11.02.01  10.10.2022  DA Sarkies    TSK 0924898
.             Inserted check to skip over sites that are inactive
.------------------------------------------------------------------------
.  V11.01.03  16/12/2021  P  Le Febour  TSK 0891395
.             Added ALREX730 to retrieve Slot Type Description
.------------------------------------------------------------------------
.  V11.01.02  31/03/2021  Ebon Clements TSK 0902602
.             Changed key length for ALLDIAA2
.  V11.01.01  15/02/2021  Ebon Clements TSK 0902587
.             Fixed key length pack for procedure code selection list - ALLPRO00
.------------------------------------------------------------------------
.  V11.00.01  11/03/2020  Ebon Clements TSK 0888624
.             Added ALREFTSC/ALREF192
.------------------------------------------------------------------------
.  V10.13.01  25/09/2018  Thanh T       TSK 0859743
.             Added ALREBKOV/ALREF188 ALREBKPR/ALREF189
.                   ALREBKPM/ALREF190 ALREBKBA/ALREF191 fields
.------------------------------------------------------------------------
.  V10.10.01  30/03/2017  Ebon Clements TSK 0833052
.             Added ALRETRGS and ALRETRGD
.  V10.09.01  27/01/2017  Ebon Clements TSK 0828785
.             Added OP site security test to site selection list - SLSITE00
.  V10.07.01  13/11/2015  Ebon Clements CAR 320392
.             Added ALREUD11 to ALREUT15
.  V10.06.03  14/08/2015  Ebon Clements CAR 316109
.             Added ALRENVIN tag
.  V10.06.02  11/08/2015  Ania P        CAR 319861
.             Fixed multiple variables' output to trim spaces
.  V10.06.01  22/05/2015  Ebon Clements CAR 303389
.             Added ALREF169 to ALREF175
.  V10.05.03  15/09/2014  Ania P        CAR 303879
.             Removed output for ALREPURC
.  V10.05.02  11/09/2015  Ebon Clements CAR 291413
.             Added Referral Renewal Date (CCYYMMDD)
.  V10.05.01  18/08/2014  Ania P        CAR 303879
.             Added output for ALREPURC
.  V10.04.02  16/05/2014  Patrick Adair CAR 298073/298077
.             Added ALREX440/450/460 for NZ NPF data
.  V10.04.01  24/03/2014  Patrick Adair CAR 256037
.             Added additional UDF HCP's ALREF166 & ALREF167
.  V10.03.07  31/10/2013  Ebon Clements CAR 286042
.             Added exclude other factors affecting health test to 
.             department problem list -  ALLPRA00
.  V10.03.06  02/08/2013  Peter Vela    CAR 291757
.             Added check for spaces to Free Format HCP variables
.  V10.03.05  12/08/2013  Ebon Clements CAR 286042
.             Added exclude other factors affecting health test to 
.             department problem list -  ALLPRB00
.  V10.03.04  16/04/2012  Ebon Clements CAR 261277
.             Added .3 tag for a departments default clinic type - ALRE0670
.  V10.03.03  12/04/2012  Don Nguyen    CAR 261277
.             Removed ALREX420 as processing now moved into ALLWEB02
.  V10.03.02  11/04/2012  Don Nguyen    CAR 261277
.             Added ALREX420 for Referral Link indicator
.  V10.03.01  29/03/2012  Peter Vela    CAR 261277
.             Added tag for ALLPRA00 Reason for Referral Internal Referral
.             Add screens
.  V10.02.01  18/07/2011  Ebon Clements CAR 242070
.             Restored ALREF107 hospital functionality
.  V10.01.01  17/03/2010  Ebon Clements CAR 239576
.             Added ALREF165
.  V10.00.02  30/04/2010  Ebon Clements CAR 220289
.             Added ALREF154 to ALREF164
.  V10.00.01  24/03/2010  Ebon Clements CAR 135505
.             Added ALREF153 & ALREORIG
.  V9.12.05   08/01/2010  Saroeun Soeur  CAR XXXXXX
.             removed tag ALREX280 - ALHDPSIT - conflict with multiple
.             files
.  V9.12.04   06/01/2010  Saroeun Soeur  CAR 213542
.             added XXXXXXX.XX.X99.028   tag ALREX280 - ALHDPSIT
.  V9.12.03   24/11/2009  Saroeun Soeur  CAR 210857
.             added XXXXXXX.XX.199.027 tag ALREX270  - ALRESTAT
.  V9.12.02   13/11/2009  Saroeun Soeur  CAR 207550
.             added ALREX260 tag - selection dropdown for Cat "CG"
.  V9.12.01   26/08/2009  Peter McMullen CAR 171901
.             Remove MAPCAT00 call                             
.  V9.11.01   11/02/2009  Mike Laming   CAR 189239
.             Add Tag for Cat."S " on ALRESRCE for Healthscope
.  V9.10.01   15/05/2008  Mike Laming   CAR 152286
.             Added ALREDIAT,ALREUYN7,ALREUYN8,ALREUYN9,ALREUCD1,ALREUCD2 &
.                   ALREUCD3 (ALREF146 to ALREF152)
.  V9.09.02  04.03.2008 Ebon Clements CAR 163115
.            Fixed ALRE0170 tag - date inactive until
.  V9.09.01  31.01.2008 Ebon Clements CAR 159934
.            Added tag for referral status date
.  V9.08.02  17.05.2007 Ebon Clements CAR 140983   
.            Added ALREEVPR
.  V9.08.01  17.04.2007 Ebon Clements CAR 135524
.            Added ALREPURC,ALREOUTP,ALRECONT,ALRESCOR,ALREMOHR
.  V9.07.01  02.08.2006 Ebon Clements CAR 113925
.            Added ALREREVD
.  V9.05.B03 24/01/2006 Ebon Clements CAR 76341
.            Added additional SACS fields
.  V9.05.B02 11/01/2006 Davin         CAR 76341
.           Added SACS referral fields
.  V9.05.B01 13/12/2005 Ebon Clements CAR 76341
.           Added SACS referral rejection fields           
.  V9.04.10 26/07/2005  Davin         CAR 68945
.           Changed provider number tag (alre0222) to also check hcp table
.  V9.04.09 24/05/2005  Ebon Clements CAR 62018
.           Added tag for referral items provider usage
.           23/05/2005  Davin         CAR 22680
.           Changed practice/provider number tags (alre0220,alre0230) to read 
.           pmshclaf & pmshcgaf
.  V9.04.08 19/05/2005  Ebon Clements CAR 62018
.           Removed replace space with zero from ALREF019 and ALREF039
.           so you can delete the fields
.  V9.04.07 05/05/2005  J.Tan         CAR 60889
.           Default the first item type to 'MBS'
.  V9.04.06 04/05/2005  Ebon Clements CAR 61170
.           Added tag for visit type code
.  V9.04.05 22/03/2005  Ebon Clements CAR 56375
.           Added cgis 127 - Priority Date
.  V9.04.04 14/02/2005  Ebon Clements CAR 56375
.           Added cgis 126 - Must be seen by date
.  V9.04.03 03/02/2005  Davin         CAR 56671
.           Added cgis 108-125 and tags for HIC Claims
.  V9.04.02 22/11/2004  Ebon Clements CAR 55239
.           Changed ALREUHC4 to be case team details not user definded HCP4
.  V9.04.01 31/08/2004  Ebon Clements CAR 53089
.           Removed CGI for ALREHOSN (ALREF107)
.  V9.03.01 14/07/2003  Tracey Nguyen CAR 40986
.           Fixed Urgency of Examination issue. Moved ALREUNO1 (FORM 12.2)
.           to FORM1 before writing.
.  V9.02.04 25/10/2002  Lina Vo
.           Remove squeeze ALREF005 statement, so it does not change the
.           data format passed from the web. Web should right justify the
.           field.
.  V9.02.03 10/10/2002  Sylvek Litewka
.           Added processing for ALREHOSN (ALREF107).
.  V9.02.02 13/03/2002  Ebon Clements
.           Changed diagnosis and problem selection lisst to be in      
.           description order
.  V9.02.01 02/02/2002  Ebon Clements
.           Added code to display inactive diagnosis and problem codes
.           in the selection list if they are stored on file
.  V9.01.03 13/11/2001  Ebon Clements
.           Changed ALREUNO2 tag to output integer values only
.  V9.01.02 10/08/2001  Ebon Clements
.           Added output tag for Patient name            
.  V9.01.01 13/08/2001  Ebon Clements
.           Changed ALREPRTY from category TP to PR
.           Changed ALRESRCE from category LQ to be OSTCATG from the 
.           outpatient site file
.
.                      Added ALRE0680 to display the current user
.                      Modified ALRE0030 to display the status in text
.                      By Jaideep Chhabra  19/06/2001
.                       
.------------------------------------------------------------------------
.   Clear Parameters for allied health services referral table file
.------------------------------------------------------------------------
.
CPALRE00  MOVE      Z70,ALREF001
          MOVE      Z70,ALREF002
          MOVE      Z70,ALREF003
          MOVE      Z70,ALREF004
          MOVE      Z70,ALREF005
          MOVE      Z70,ALREF006
          MOVE      Z70,ALREF007
          MOVE      Z70,ALREF008
          MOVE      Z70,ALREF009
          MOVE      Z70,ALREF010
          MOVE      Z70,ALREF011
          MOVE      Z70,ALREF012
          MOVE      Z70,ALREF013
          MOVE      Z70,ALREF014
          MOVE      Z70,ALREF015
          MOVE      Z70,ALREF016
          MOVE      Z70,ALREF017
          MOVE      Z70,ALREF018
          MOVE      Z70,ALREF019
          MOVE      Z70,ALREF020
          MOVE      Z70,ALREF021
          MOVE      Z70,ALREF022
          MOVE      Z70,ALREF023
          MOVE      Z70,ALREF024
          MOVE      Z70,ALREF025
          MOVE      Z70,ALREF026
          MOVE      Z70,ALREF027
          MOVE      Z70,ALREF028
          MOVE      Z70,ALREF029
          MOVE      Z70,ALREF030
          MOVE      Z70,ALREF031
          MOVE      Z70,ALREF032
          MOVE      Z70,ALREF033
          MOVE      Z70,ALREF034
          MOVE      Z70,ALREF035
          MOVE      Z70,ALREF036
          MOVE      Z70,ALREF037
          MOVE      Z70,ALREF038
          MOVE      Z70,ALREF039
          MOVE      Z70,ALREF040
          MOVE      Z70,ALREF041
          MOVE      Z70,ALREF042
          MOVE      Z70,ALREF043
          MOVE      Z70,ALREF044
          MOVE      Z70,ALREF045
          MOVE      Z70,ALREF046
          MOVE      Z70,ALREF047
          MOVE      Z70,ALREF048
          MOVE      Z70,ALREF049
          MOVE      Z70,ALREF050
          MOVE      Z70,ALREF051
          MOVE      Z70,ALREF052
          MOVE      Z70,ALREF053
          MOVE      Z70,ALREF054
          MOVE      Z70,ALREF055
          MOVE      Z70,ALREF056
          MOVE      Z70,ALREF057
          MOVE      Z70,ALREF058
          MOVE      Z70,ALREF059
          MOVE      Z70,ALREF060
          MOVE      Z70,ALREF061
          MOVE      Z70,ALREF062
          MOVE      Z70,ALREF063
          MOVE      Z70,ALREF064
          MOVE      Z70,ALREF065
          MOVE      Z70,ALREF066
          MOVE      Z70,ALREF067
          MOVE      Z70,ALREF068
          MOVE      Z70,ALREF069
          MOVE      Z70,ALREF070
          MOVE      Z70,ALREF071
          MOVE      Z70,ALREF072
          MOVE      Z70,ALREF073
          MOVE      Z70,ALREF074
          MOVE      Z70,ALREF075
          MOVE      Z70,ALREF076
          MOVE      Z70,ALREF077
          MOVE      Z70,ALREF078
          MOVE      Z70,ALREF079
          MOVE      Z70,ALREF080
          MOVE      Z70,ALREF081
          MOVE      Z70,ALREF082
          MOVE      Z70,ALREF083
          MOVE      Z70,ALREF084
          MOVE      Z70,ALREF085
          MOVE      Z70,ALREF086
          MOVE      Z70,ALREF087
          MOVE      Z70,ALREF088
          MOVE      Z70,ALREF089
          MOVE      Z70,ALREF090
          MOVE      Z70,ALREF091
          MOVE      Z70,ALREF092
          MOVE      Z70,ALREF093
          MOVE      Z70,ALREF094
          MOVE      Z70,ALREF095
          MOVE      Z70,ALREF096
          MOVE      Z70,ALREF097
          MOVE      ZERO,ALREF098
          MOVE      ZERO,ALREF099
          MOVE      Z70,ALREF100
          MOVE      Z70,ALREF101
          MOVE      Z70,ALREF102
          MOVE      Z70,ALREF103
          MOVE      Z70,ALREF104
          MOVE      Z70,ALREF105
          MOVE      Z70,ALREF106
          MOVE      Z70,ALREF107
          MOVE      Z70,ALREF108
          MOVE      Z70,ALREF109
          MOVE      Z70,ALREF110
          MOVE      Z70,ALREF111
          MOVE      Z70,ALREF112
          MOVE      Z70,ALREF113
          MOVE      Z70,ALREF114
          MOVE      Z70,ALREF115
          MOVE      Z70,ALREF116
          MOVE      Z70,ALREF117
          MOVE      Z70,ALREF118
          MOVE      Z70,ALREF119
          MOVE      Z70,ALREF120
          MOVE      Z70,ALREF121
          MOVE      Z70,ALREF122
          MOVE      Z70,ALREF123
          MOVE      Z70,ALREF124
          MOVE      Z70,ALREF125
          MOVE      Z70,ALREF126
          MOVE      Z70,ALREF127
          MOVE      Z70,ALREF128
          MOVE      Z70,ALREF129
          MOVE      Z70,ALREF130
          MOVE      Z70,ALREF131
          MOVE      Z70,ALREF132
          MOVE      Z70,ALREF133
          MOVE      Z70,ALREF134
          MOVE      Z70,ALREF135
          MOVE      Z70,ALREF136
          MOVE      Z70,ALREF137
          MOVE      Z70,ALREF138
          MOVE      Z70,ALREF139
          MOVE      Z70,ALREF140
          MOVE      Z70,ALREF141
          MOVE      Z70,ALREF142
          MOVE      Z70,ALREF143
          MOVE      Z70,ALREF144
          MOVE      Z70,ALREF145
          MOVE      Z70,ALREF146
          MOVE      Z70,ALREF147
          MOVE      Z70,ALREF148
          MOVE      Z70,ALREF149
          MOVE      Z70,ALREF150
          MOVE      Z70,ALREF151
          MOVE      Z70,ALREF152
          MOVE      Z70,ALREF153
          MOVE      Z70,ALREF154
          MOVE      Z70,ALREF155
          MOVE      Z70,ALREF156
          MOVE      Z70,ALREF157
          MOVE      Z70,ALREF158
          MOVE      Z70,ALREF159
          MOVE      Z70,ALREF160
          MOVE      Z70,ALREF161
          MOVE      Z70,ALREF162
          MOVE      Z70,ALREF163
          MOVE      Z70,ALREF164
          MOVE      Z70,ALREF165
          MOVE      Z70,ALREF166
          MOVE      Z70,ALREF167
          MOVE      Z70,ALREF168
          MOVE      Z70,ALREF169
          MOVE      Z70,ALREF170
          MOVE      Z70,ALREF171
          MOVE      Z70,ALREF172
          MOVE      Z70,ALREF173
          MOVE      Z70,ALREF174
          MOVE      Z70,ALREF175
          MOVE      Z70,ALREF176
          MOVE      Z70,ALREF177
          MOVE      Z70,ALREF178
          MOVE      Z70,ALREF179
          MOVE      Z70,ALREF180
          MOVE      Z70,ALREF181
          MOVE      Z70,ALREF182
          MOVE      Z70,ALREF183
          MOVE      Z70,ALREF184
          MOVE      Z70,ALREF185
          MOVE      Z70,ALREF186
          MOVE      Z70,ALREF187
          MOVE      Z70,ALREF188
          MOVE      Z70,ALREF189
          MOVE      Z70,ALREF190
          MOVE      Z70,ALREF191
          MOVE      Z70,ALREF192
          MOVE      Z70,ALREF193
.
CPALRE99  RETURN
.------------------------------------------------------------
. Add allied health services referral table file
.------------------------------------------------------------
ALRE0000  BRANCH    FLDITMNO,ALRE0010,ALRE0020,ALRE0030,ALRE0040,ALRE0050:
                             ALRE0060,ALRE0070,ALRE0080,ALRE0090,ALRE0100:
                             ALRE0110,ALRE0120,ALRE0130,ALRE0140,ALRE0150:
                             ALRE0160,ALRE0170,ALRE0180,ALRE0190,ALRE0200:
                             ALRE0210,ALRE0220,ALRE0230,ALRE0240,ALRE0250:
                             ALRE0260,ALRE0270,ALRE0280,ALRE0290,ALRE0300:
                             ALRE0310,ALRE0320,ALRE0330,ALRE0340,ALRE0350:
                             ALRE0360,ALRE0370,ALRE0380,ALRE0390,ALRE0400:
                             ALRE0410,ALRE0420,ALRE0430,ALRE0440,ALRE0450:
                             ALRE0460,ALRE0470,ALRE0480,ALRE0490,ALRE0500:
                             ALRE0510,ALRE0520,ALRE0530,ALRE0540,ALRE0550:
                             ALRE0560,ALRE0570,ALRE0580,ALRE0590,ALRE0600:
                             ALRE0610,ALRE0620,ALRE0630,ALRE0640,ALRE0650:
                             ALRE0660,ALRE0670,ALRE0680,ALRE0690,ALRE0700:
                             ALRE0710,ALRE0720,ALRE0730,ALRE0740,ALRE0750:
                             ALRE0760,ALRE0770,ALRE0780,ALRE0790,ALRE0800:
                             ALRE0810,ALRE0820,ALRE0830,ALRE0840,ALRE0850:
                             ALRE0860,ALRE0870,ALRE0880,ALRE0890,ALRE0900:
                             ALRE0910,ALRE0920,ALRE0930,ALRE0940,ALRE0950:
                             ALRE0960,ALRE0970,ALRE0980,ALRE0990
.
. *** Add additional tags to 'ALREX000' (accessed from field item 99 above) ***
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      ALRE9999
.
ALRE0010  WRITE     HTMLFILE;ALREVISN;
          GOTO      ALRE9999
.
ALRE0020  WRITE     HTMLFILE;ALREURNO;
          GOTO      ALRE9999
.
ALRE0030  CALL      STAEQU00
          WRITE     HTMLFILE;REFSTAT;
          GOTO      ALRE9999
.
ALRE0040  MATCH     ALREDACT,SP70
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALREDACT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0050  WRITE     HTMLFILE;ALRELINK;
          GOTO      ALRE9999
.
ALRE0060  MOVE      "LL",CATEGORY
          MOVE      ALRERCLO,CODE
          CALL      CODITM00
          GOTO      ALRE9999
.
ALRE0070  MATCH     ALREDCLO,SP70
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALREDCLO,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0080  WRITE     HTMLFILE;ALRETCLO;
          GOTO      ALRE9999
.
ALRE0090  MATCH     SP70,ALREUCLO
          GOTO      ALRE9999 IF EQUAL
          PACK      KEY10,ALREUCLO
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      ALREUCLO,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
.
          PACK      KEY10,USERID,SP70
          CALL      RDWBSE1
          GOTO      ALRE9999
.
ALRE0100  MOVE      "LN",CATEGORY
          MOVE      ALRERCAN,CODE
          CALL      CODITM00
          GOTO      ALRE9999
.
ALRE0110  MATCH     ALREDCAN,SP70
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALREDCAN,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0120  WRITE     HTMLFILE;ALRETCAN;
          GOTO      ALRE9999
.
ALRE0130  MATCH     SP70,ALREUCAN
          GOTO      ALRE9999 IF EQUAL
          PACK      KEY10,ALREUCAN
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      ALREUCAN,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
.
          PACK      KEY10,USERID,SP70
          CALL      RDWBSE1
          GOTO      ALRE9999
.
ALRE0140  MOVE      "LI",CATEGORY
          MOVE      ALRERINA,CODE
          CALL      CODITM00
          GOTO      ALRE9999
.
ALRE0150  MATCH     ALREDINA,SP70
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALREDINA,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0160  WRITE     HTMLFILE;ALRETINA;
          GOTO      ALRE9999
.
ALRE0170  MATCH     ALREDINU,SP70
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALREDINU,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0180  MATCH     SP70,ALREUINA
          GOTO      ALRE9999 IF EQUAL
          PACK      KEY10,ALREUINA
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      ALREUINA,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
.
          PACK      KEY10,USERID,SP70
          CALL      RDWBSE1
          GOTO      ALRE9999
.
ALRE0190  MATCH     ALRERDAT,SP70
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALRERDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0200  MOVE      "CG",CATEGORY
          MOVE      ALRERDEP,CODE
          CALL      CODITM00
          GOTO      ALRE9999
.
ALRE0210  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALRE0211
          PACK      KEY10,ALRERDOC
          CALL      RDPMHCP1
          BRANCH    OVRCD,ALRE9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      ALRE9999
.
ALRE0211  WRITE     HTMLFILE;ALRERDOC;
          GOTO      ALRE9999
.
ALRE0220  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALRE0221,ALRE0222
          PACK      KEY10,ALRERHCP
          CALL      RDPMHCP1
          BRANCH    OVRCD,ALRE9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      ALRE9999
.
ALRE0221  WRITE     HTMLFILE;ALRERHCP;
          GOTO      ALRE9999
.
ALRE0222  PACK      KEY20,ALRERHCP,ALRERHCR
          CALL      RDPMHCL1
          IF        OVRCD=1
            PACK      KEY10,ALRERHCP
            CALL      RDPMHCP1
            BRANCH    OVRCD,ALRE9999
.
            WRITE     HTMLFILE;PMHCPRV1;
            GOTO      ALRE9999
          ENDIF
.
          WRITE     HTMLFILE;PMHLPRV1;
          GOTO      ALRE9999
.
ALRE0230  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALRE0231
          WRITE     HTMLFILE;ALRERHCR;
          GOTO      ALRE9999
.
ALRE0231  PACK      KEY12,ALRERHCR,ALRERHCT
          CALL      RDPMHCG1
          BRANCH    OVRCD,ALRE9999
.
          WRITE     HTMLFILE;PMHGPNAM;
          GOTO      ALRE9999
.
ALRE0240  WRITE     HTMLFILE;ALRERHCT;
          GOTO      ALRE9999
.
ALRE0250  MOVE      "CG",CATEGORY
          MOVE      ALREDEPT,CODE
          CALL      CODITM00
          GOTO      ALRE9999
.
ALRE0260  MOVE      "AC",CATEGORY
          MOVE      ALREUNIT,CODE
          CALL      CODITM00
          GOTO      ALRE9999
.
ALRE0270  MOVE      "PR",CATEGORY
          MOVE      ALREPRTY,CODE
          CALL      CODITM00
          GOTO      ALRE9999
.
ALRE0280  MOVE      ALREPRO1,ALLRFPRB
          CALL      ALLPRB00
          GOTO      ALRE9999
.
ALRE0290  MOVE      ALREPRO2,ALLRFPRB
          CALL      ALLPRB00
          GOTO      ALRE9999
.
ALRE0300  MOVE      ALREPRO3,ALLRFPRB
          CALL      ALLPRB00
          GOTO      ALRE9999
.
ALRE0310  MOVE      ALREDIA1,ALLRFDIA
          CALL      ALLDIA00
          GOTO      ALRE9999
.         
ALRE0320  MOVE      ALREDIA2,ALLRFDIA
          CALL      ALLDIA00
          GOTO      ALRE9999
.         
ALRE0330  MOVE      ALREDIA3,ALLRFDIA
          CALL      ALLDIA00
          GOTO      ALRE9999
.         
ALRE0340  PACK      KEY6,WBSESIT,SP70
          CALL      RDSITA1
          BRANCH    OVRCD,ALRE9999
.
          MOVE      OSTCATG,CATEGORY
          MOVE      ALRESRCE,CODE
          CALL      CODITM00
          GOTO      ALRE9999
.
ALRE0350  MOVE      "CL",CATEGORY
          MOVE      ALRECOMP,CODE
          CALL      CODITM00
          GOTO      ALRE9999
.
ALRE0360  MOVE      NO,YESNO
          MATCH     "1",ALREBULK
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALRE9999
.
ALRE0370  MATCH     ALREDREV,SP70
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALREDREV,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0380  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALRE0381
          PACK      KEY10,ALREHCP
          CALL      RDPMHCP1
          BRANCH    OVRCD,ALRE9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      ALRE9999
.
ALRE0381  WRITE     HTMLFILE;ALREHCP;
          GOTO      ALRE9999
.
ALRE0390  MATCH     ALREDREC,SP70
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALREDREC,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0400  UNPACK    DIM127,D1,KEY2,DIM127
          MOVE      KEY2,F2
          LOAD      CODE,F2,ALREUC01,ALREUC02,ALREUC03,ALREUC04,ALREUC05:
                            ALREUC06,ALREUC07,ALREUC08,ALREUC09,ALREUC10:
                            ALREUC11,ALREUC12,ALREUC13,ALREUC14,ALREUC15:
                            ALREUC16,ALREUC17,ALREUC18,ALREUC19,ALREUC20:
                            ALREUC21,ALREUC22,ALREUC23,ALREUC24,ALREUC25:
                            ALREUC26,ALREUC27,ALREUC28,ALREUC29,ALREUC30:
                            ALREUC31,ALREUC32,ALREUC33,ALREUC34,ALREUC35:
                            ALREUC36,ALREUC37,ALREUC38,ALREUC39,ALREUC40
.
          LOAD      CATEGORY,F2,ALREF201,ALREF202,ALREF203,ALREF204,ALREF205:
                                ALREF206,ALREF207,ALREF208,ALREF209,ALREF210:
                                ALREF211,ALREF212,ALREF213,ALREF214,ALREF215:
                                ALREF216,ALREF217,ALREF218,ALREF219,ALREF220:
                                ALREF221,ALREF222,ALREF223,ALREF224,ALREF225:
                                ALREF226,ALREF227,ALREF228,ALREF229,ALREF230:
                                ALREF231,ALREF232,ALREF233,ALREF234,ALREF235:
                                ALREF236,ALREF237,ALREF238,ALREF239,ALREF240
          CALL      CODITM00
          GOTO      ALRE9999

ALRE0410  MOVE      NO,YESNO
          MATCH     "1",ALREUYN1
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALRE9999
.
ALRE0420  MOVE      NO,YESNO
          MATCH     "1",ALREUYN2
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALRE9999
.
ALRE0430  MOVE      NO,YESNO
          MATCH     "1",ALREUYN3
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALRE9999
.
ALRE0440  MOVE      NO,YESNO
          MATCH     "1",ALREUYN4
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALRE9999
.
ALRE0450  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALRE0451
          PACK      KEY10,ALREUHC1
          CALL      RDPMHCP1 
          BRANCH    OVRCD,ALRE9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      ALRE9999
.
ALRE0451  WRITE     HTMLFILE;ALREUHC1;
          GOTO      ALRE9999
.
ALRE0460  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALRE0461
          PACK      KEY10,ALREUHC2
          CALL      RDPMHCP1 
          BRANCH    OVRCD,ALRE9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      ALRE9999
.
ALRE0461  WRITE     HTMLFILE;ALREUHC2;
          GOTO      ALRE9999
.
ALRE0470  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALRE0471
          PACK      KEY10,ALREUHC3
          CALL      RDPMHCP1 
          BRANCH    OVRCD,ALRE9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      ALRE9999
.
ALRE0471  WRITE     HTMLFILE;ALREUHC3;
          GOTO      ALRE9999
.
ALRE0480  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALRE0481
.
          PACK      KEY10,ALREUHC4,SP70
          CALL      RDALCAS1
          BRANCH    OVRCD,ALRE9999
.
          WRITE     HTMLFILE;ALCADESC;
          GOTO      ALRE9999
.
ALRE0481  WRITE     HTMLFILE;ALREUHC4;
          GOTO      ALRE9999
.
ALRE0490  STRIP     ALREUFR1
          WRITE     HTMLFILE;*+,ALREUFR1;
          GOTO      ALRE9999
.
ALRE0500  STRIP     ALREUFR2
          WRITE     HTMLFILE;*+,ALREUFR2;
          GOTO      ALRE9999
.
ALRE0510  MATCH     ALREUDT1,SP70
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALREUDT1,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0520  WRITE     HTMLFILE;ALREUTM1;
          GOTO      ALRE9999
.
ALRE0530  MATCH     ALREUDT2,SP70
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALREUDT2,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0540  WRITE     HTMLFILE;ALREUTM2;
          GOTO      ALRE9999
.
ALRE0550  MATCH     ALREUDT3,SP70
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALREUDT3,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0560  WRITE     HTMLFILE;ALREUTM3;
          GOTO      ALRE9999
.
ALRE0570  MATCH     ALREUDT4,SP70
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALREUDT4,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0580  WRITE     HTMLFILE;ALREUTM4;
          GOTO      ALRE9999
.
ALRE0590  MOVE      ALREUNO1,FORM1          * Formats urgency of examination
          COMPARE   ZERO,FORM1
          GOTO      ALRE9999 IF EQUAL
.
          WRITE     HTMLFILE;FORM1;
          GOTO      ALRE9999
.
ALRE0600  COMPARE   ZERO,ALREUNO2
          GOTO      ALRE9999 IF EQUAL
.
          MOVE      ALREUNO2,F10
          WRITE     HTMLFILE;F10;
          GOTO      ALRE9999
.
ALRE0610  MATCH     ALRECDAT,SP70
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALRECDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0620  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALRE0621
          WRITE     HTMLFILE;ALRECTIM;
          GOTO      ALRE9999
ALRE0621  UNPACK    ALRECTIM,D5
          WRITE     HTMLFILE;D5
          GOTO      ALRE9999
.
ALRE0630  MATCH     SP70,ALRECUID
          GOTO      ALRE9999 IF EQUAL
          PACK      KEY10,ALRECUID
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      ALRECUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
.
          PACK      KEY10,USERID,SP70
          CALL      RDWBSE1
          GOTO      ALRE9999
.
ALRE0640  MATCH     ALREUDAT,SP70
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALREUDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0650  WRITE     HTMLFILE;ALREUTIM;
          GOTO      ALRE9999
.
ALRE0660  MATCH     SP70,ALREUUID
          GOTO      ALRE9999 IF EQUAL
          PACK      KEY10,ALREUUID
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      ALREUUID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
.
          PACK      KEY10,USERID,SP70
          CALL      RDWBSE1
          GOTO      ALRE9999
.
ALRE0670  UNPACK    DIM127,D1,KEY1,DIM127    * Clinic Type of Referral
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALRE0671,ALRE0672,ALRE0673
.
          PACK      KEY12,WBSESIT,ALRECTYP,SP70
          CALL      RDCTYA1                  * Read Clinic Type File
          BRANCH    OVRCD,ALRE9999
          WRITE     HTMLFILE;OCTDESC;        * Descprition
          GOTO      ALRE9999
.
ALRE0671  WRITE     HTMLFILE;ALRECTYP;       * Code
          GOTO      ALRE9999 
.
ALRE0672  CALL      ARFCTY00
          GOTO      ALRE9999 
.
ALRE0673  CALL      DEPDCT00                 * Dept Default(first) clinic type
          GOTO      ALRE9999
.
ALRE0680  MATCH     SP70,USERID              * display the current user 
          GOTO      ALRE9999 IF EQUAL
          PACK      KEY10,USERID
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      USERID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
.
          PACK      KEY10,USERID,SP70
          CALL      RDWBSE1
          GOTO      ALRE9999
.
ALRE0690  PACK      KEY8,ALREURNO
          CALL      RDMAST1 
          BRANCH    OVRCD,ALRE9999
          MOVE      PTITL,FMTTITLE
          MOVE      PGNAME,FMTGNAME
          MOVE      PSNAME,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      ALRE9999
.
ALRE0700  UNPACK    DIM127,D1,KEY1,DIM127    * Outpatient Site
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALRE0701,ALRE0702
.
          WRITE     HTMLFILE;ALREHOSN;       
          GOTO      ALRE9999
.
ALRE0701  PACK      KEY3,ALREHOSN,SP70
          CALL      RDPTHSP1
          IF        OVRCD=1
            MOVE      ALREHOSN,PTHSNAME
          ENDIF
          WRITE     HTMLFILE;PTHSNAME;
          GOTO      ALRE9999

ALRE0702  CALL      RHSL0000
          GOTO      ALRE9999
.
ALRE0710  MATCH     SP70,ALREFHCP
          GOTO      ALRE9999 IF EQUAL
          WRITE     HTMLFILE;ALREFHCP;       
          GOTO      ALRE9999
.
ALRE0720  MATCH     SP70,ALREHCP1
          GOTO      ALRE9999 IF EQUAL
          WRITE     HTMLFILE;ALREHCP1;       
          GOTO      ALRE9999
.
ALRE0730  MATCH     SP70,ALREHCP2
          GOTO      ALRE9999 IF EQUAL
          WRITE     HTMLFILE;ALREHCP2;       
          GOTO      ALRE9999
.
ALRE0740  MATCH     SP70,ALREHCP3
          GOTO      ALRE9999 IF EQUAL
          WRITE     HTMLFILE;ALREHCP3;       
          GOTO      ALRE9999
.
ALRE0750  MATCH     SP70,ALREHCPC
          GOTO      ALRE9999 IF EQUAL
          WRITE     HTMLFILE;ALREHCPC;       
          GOTO      ALRE9999
.
ALRE0760  MATCH     SP70,ALREHCPS
          GOTO      ALRE9999 IF EQUAL
          WRITE     HTMLFILE;ALREHCPS;       
          GOTO      ALRE9999
.
ALRE0770  MATCH     SP70,ALREHCPB
          GOTO      ALRE9999 IF EQUAL
          WRITE     HTMLFILE;ALREHCPB;       
          GOTO      ALRE9999
.
ALRE0780  MATCH     SP70,ALREHCPF
          GOTO      ALRE9999 IF EQUAL 
          WRITE     HTMLFILE;ALREHCPF;       
          GOTO      ALRE9999
.
ALRE0790  MATCH     SP70,ALREHCPP
          GOTO      ALRE9999 IF EQUAL
          WRITE     HTMLFILE;ALREHCPP;       
          GOTO      ALRE9999
.
ALRE0800  MOVE      "CV",CATEGORY
          MOVE      ALRESTYP,CODE
          CALL      RFVSEL00
          GOTO      ALRE9999
.
ALRE0810  WRITE     HTMLFILE;ALREPRCM;       
          GOTO      ALRE9999
.
.         Site
. 
ALRE0820  UNPACK    DIM127,D1,KEY1,DIM127    * Outpatient Site
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALRE0822,ALRE0824
          PACK      KEY6,ALREPSIT,SP70
          CALL      RDSITA1                  * Read Site Code File
          BRANCH    OVRCD,ALRE9999
          WRITE     HTMLFILE;OSTDESC;        * Descprition
          GOTO      ALRE9999
ALRE0822  WRITE     HTMLFILE;ALREPSIT;       * Code
          GOTO      ALRE9999
ALRE0824  MOVE      ALREPSIT,SITECODE
          CALL      SLSITE00                 * Options
          GOTO      ALRE9999
.
ALRE0830  MOVE      "sc",CATEGORY
          MOVE      ALRECSTA,CODE
          CALL      CODITM00
          GOTO      ALRE9999
.
ALRE0840  MOVE      "hr",CATEGORY
          MOVE      ALRERREJ,CODE
          CALL      CODITM00
          GOTO      ALRE9999
.
ALRE0850  WRITE     HTMLFILE;ALRECCOM;       
          GOTO      ALRE9999
.
ALRE0860  MOVE      "RI",CATEGORY
          MOVE      ALRERTYP,CODE
          CALL      CODITM00
          GOTO      ALRE9999
.
ALRE0870  MATCH     SP70,ALREREXP
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALREREXP,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0880  UNPACK    DIM127,D1,KEY1,DIM127    * Outpatient Clinic
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALRE0882
.
          PACK      KEY20,ALREPSIT,ALRECLID,Z70
          CALL      RDSCLIA1
          CALL      RDPCLIA1
          BRANCH    OVRCD,ALRE9999
.
          MATCH     ALREPSIT,OCASITE
          GOTO      ALRE9999 IF NOT EQUAL
.
          MATCH     ALRECLID,OCACLIN
          GOTO      ALRE9999 IF NOT EQUAL
.
          WRITE     HTMLFILE;OCADESC;        * Descprition
          GOTO      ALRE9999
.
ALRE0882  WRITE     HTMLFILE;ALRECLID;       * Code
          GOTO      ALRE9999
.
ALRE0890  MATCH     SP70,ALREMDAT
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALREMDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0900  UNPACK    DIM127,D1,KEY2,DIM127
          PACK      KEY10,ALREVISN,KEY2,SP70
          CALL      RDALRIT1
          BRANCH    OVRCD,ALRE0902
.
          MATCH     " 0",ALRTIFLG
          IF        @EQUAL
            WRITE     HTMLFILE;"MBS";
            GOTO      ALRE9999
          ENDIF
.
          MATCH     " 1",ALRTIFLG
          IF        @EQUAL
            WRITE     HTMLFILE;"AMA";
            GOTO      ALRE9999
          ENDIF
          GOTO      ALRE9999
.
.         default to "MBS" item type
.
ALRE0902  WRITE     HTMLFILE;"MBS";
          GOTO      ALRE9999
.
ALRE0910  UNPACK    DIM127,D1,KEY2,DIM127
          PACK      KEY10,ALREVISN,KEY2,SP70
          CALL      RDALRIT1
          BRANCH    OVRCD,ALRE9999
.
          WRITE     HTMLFILE;ALRTITMN;
          GOTO      ALRE9999
.
ALRE0920  UNPACK    DIM127,D1,KEY2,DIM127
          PACK      KEY10,ALREVISN,KEY2,SP70
          CALL      RDALRIT1
          BRANCH    OVRCD,ALRE9999
.
          WRITE     HTMLFILE;ALRTSUBN;
          GOTO      ALRE9999
.
ALRE0930  UNPACK    DIM127,D1,KEY2,DIM127
          PACK      KEY10,ALREVISN,KEY2,SP70
          CALL      RDALRIT1
          BRANCH    OVRCD,ALRE9999
.
          MOVE      ALRTIFLG,FORM2
          PACK      KEY22,ALRTIFLG,ALRTITMN,ALRTSUBN,Z70 * Get current record
          CALL      RSPRIT1
          CALL      RPPRIT1
          BRANCH    OVRCD,ALRE9999
.
          COMPARE   FORM2,PRITFLAG           * Item Type
          GOTO      ALRE9999 IF NOT EQUAL
.
          MATCH     ALRTITMN,PRITITMN        * AMA/MBS Item
          GOTO      ALRE9999 IF NOT EQUAL
.
          MATCH     ALRTSUBN,PRITSUBN        * Sub Item
          GOTO      ALRE9999 IF NOT EQUAL
.
          WRITE     HTMLFILE;PRITDESC;       * AMA/MBS Description
          GOTO      ALRE9999
.
ALRE0940  MATCH     SP70,ALREPRDT
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALREPRDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0950  WRITE     HTMLFILE;ALRESTYP;
          GOTO      ALRE9999
.
ALRE0960  UNPACK    DIM127,D1,KEY2,DIM127
          PACK      KEY10,ALREVISN,KEY2,SP70
          CALL      RDALRIT1
          BRANCH    OVRCD,ALRE9999
.
          WRITE     HTMLFILE;ALRTPUSE;
          GOTO      ALRE9999
.
ALRE0970  MOVE      "rr",CATEGORY
          MOVE      ALRESREJ,CODE
          CALL      CODITM00
          GOTO      ALRE9999
.
ALRE0980  MATCH     SP70,ALRESRDT
          GOTO      ALRE9999 IF EQUAL
          UNPACK    ALRESRDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALRE9999
.
ALRE0990  UNPACK    DIM127,D1,KEY3,DIM127
          MOVE      KEY3,FLDITMNO
          CALL      ALREX000                * additional allref fields
          GOTO      ALRE9999
.
ALRE9999  RETURN
.
.------------------------------------------------------------
. Additional allied health services referral table tags
.------------------------------------------------------------
ALREX000  BRANCH    FLDITMNO,ALREX010,ALREX020,ALREX030,ALREX040,ALREX050:
                             ALREX060,ALREX070,ALREX080,ALREX090,ALREX100:
                             ALREX110,ALREX120,ALREX130,ALREX140,ALREX150:
                             ALREX160,ALREX170,ALREX180,ALREX190,ALREX200:
                             ALREX210,ALREX220,ALREX230,ALREX240,ALREX250:
                             ALREX260,ALREX270,ALREX280,ALREX290,ALREX300:
                             ALREX310,ALREX320,ALREX330,ALREX340,ALREX350:
                             ALREX360,ALREX370,ALREX380,ALREX390,ALREX400:
                             ALREX410,ALREX420,ALREX430,ALREX440,ALREX450:
                             ALREX460,ALREX470,ALREX480,ALREX490,ALREX500:
                             ALREX510,ALREX520,ALREX530,ALREX540,ALREX550:
                             ALREX560,ALREX570,ALREX580,ALREX590,ALREX600:
                             ALREX610,ALREX620,ALREX630,ALREX640,ALREX650:
                             ALREX660,ALREX670,ALREX680,ALREX690,ALREX700:
                             ALREX710,ALREX720,ALREX730,ALREX740
.
          WRITE     HTMLFILE;"Invalid IBA Tag";
          GOTO      ALREX999
.
ALREX010  WRITE     HTMLFILE;ALRESRTM;
          GOTO      ALREX999
.
ALREX020  MATCH     SP70,ALRESRUI
          GOTO      ALREX999 IF EQUAL
          PACK      KEY10,ALRESRUI,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      ALRESRUI,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
.
          PACK      KEY10,USERID,SP70
          CALL      RDWBSE1
          GOTO      ALREX999
.
ALREX030  MATCH     ALREUDT5,SP70
          GOTO      ALREX999 IF EQUAL
          UNPACK    ALREUDT5,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX040  WRITE     HTMLFILE;ALREUTM5;
          GOTO      ALREX999
.
ALREX050  MOVE      NO,YESNO
          MATCH     "1",ALREUYN5
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALREX999
.
ALREX060  MATCH     SP70,ALREUDID
          GOTO      ALREX999 IF EQUAL
          PACK      KEY10,ALREUDID,SP70
          CALL      RDWBSE1
          IF        OVRCD=1
            MOVE      ALREUDID,WBSENAM
          ENDIF
          WRITE     HTMLFILE;WBSENAM;
.
          PACK      KEY10,USERID,SP70
          CALL      RDWBSE1
          GOTO      ALREX999
.
ALREX070  MATCH     ALREUDT6,SP70
          GOTO      ALREX999 IF EQUAL
          UNPACK    ALREUDT6,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX080  WRITE     HTMLFILE;ALREUTM6;
          GOTO      ALREX999
.
ALREX090  MOVE      NO,YESNO
          MATCH     "1",ALREUYN6
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALREX999
.
ALREX100  MATCH     ALREREVD,SP70
          GOTO      ALREX999 IF EQUAL
.
          UNPACK    ALREREVD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX110  MOVE      "HP",CATEGORY
          MOVE      ALREPURC,CODE
          CALL      CODITM00
          GOTO      ALREX999
.
ALREX111  WRITE     HTMLFILE;ALREPURC;
          GOTO      ALREX999
.
ALREX120  MOVE      "AO",CATEGORY
          MOVE      ALREOUTP,CODE
          CALL      CODITM00
          GOTO      ALREX999
.
ALREX130  MOVE      "gb",CATEGORY
          MOVE      ALRECONT,CODE
          CALL      CODITM00
          GOTO      ALREX999
.
ALREX140  WRITE     HTMLFILE;ALRESCOR;
          GOTO      ALREX999
.
ALREX150  WRITE     HTMLFILE;ALREMOHR;
          GOTO      ALREX999
.
ALREX160  MOVE      "zG",CATEGORY
          MOVE      ALREEVPR,CODE
          CALL      CODITM00
          GOTO      ALREX999
.
ALREX170  CALL      STATDT00
          GOTO      ALREX999
.
ALREX180  WRITE     HTMLFILE;ALREDIAT;
          GOTO      ALREX999
.
ALREX190  MOVE      NO,YESNO
          MATCH     "1",ALREUYN7
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALREX999
.
ALREX200  MOVE      NO,YESNO
          MATCH     "1",ALREUYN8
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALREX999
.
ALREX210  MOVE      NO,YESNO
          MATCH     "1",ALREUYN9
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALREX999
.
ALREX220  WRITE     HTMLFILE;ALREUCD1;
          GOTO      ALREX999
.
ALREX230  WRITE     HTMLFILE;ALREUCD2;
          GOTO      ALREX999
.
ALREX240  WRITE     HTMLFILE;ALREUCD3;
          GOTO      ALREX999
.
ALREX250  MOVE      "S ",CATEGORY
          MOVE      ALRESRCE,CODE
          CALL      CODITM00
          GOTO      ALREX999
.
ALREX260  MOVE      "CG",CATEGORY
          MOVE      ALRECTYP,CODE
          CALL      CODITM00
          GOTO      ALREX999 
.
ALREX270  WRITE     HTMLFILE;ALRESTAT;
          GOTO      ALREX999
.
ALREX280  WRITE     HTMLFILE;ALREORIG;
          GOTO      ALREX999
.
ALREX290  MOVE      NO,YESNO
          MATCH     "1",ALREYN10
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALREX999
.
ALREX300  MOVE      NO,YESNO
          MATCH     "1",ALREYN11
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALREX999
.
ALREX310  MOVE      NO,YESNO
          MATCH     "1",ALREYN12
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALREX999
.
ALREX320  MATCH     ALREUDT7,SP70
          GOTO      ALREX999 IF EQUAL
.
          UNPACK    ALREUDT7,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX330  WRITE     HTMLFILE;ALREUTM7;
          GOTO      ALREX999
.
ALREX340  MATCH     ALREUDT8,SP70
          GOTO      ALREX999 IF EQUAL
.
          UNPACK    ALREUDT8,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX350  WRITE     HTMLFILE;ALREUTM8;
          GOTO      ALREX999
.
ALREX360  MATCH     ALREUDT9,SP70
          GOTO      ALREX999 IF EQUAL
.
          UNPACK    ALREUDT9,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX370  WRITE     HTMLFILE;ALREUTM9;
          GOTO      ALREX999
.
ALREX380  MATCH     ALREEIOD,SP70
          GOTO      ALREX999 IF EQUAL
.
          UNPACK    ALREEIOD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX390  MATCH     ALREACDD,SP70
          GOTO      ALREX999 IF EQUAL
.
          UNPACK    ALREACDD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX400  MATCH     ALREUD10,SP70
          GOTO      ALREX999 IF EQUAL
.
          UNPACK    ALREUD10,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX410  CALL      ALLPRA00
          GOTO      ALREX999
.
ALREX420  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALREX421
          PACK      KEY10,ALREUHC5
          CALL      RDPMHCP1 
          BRANCH    OVRCD,ALRE9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      ALRE9999
.
ALREX421  WRITE     HTMLFILE;ALREUHC5;
          GOTO      ALRE9999
.
ALREX430  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALREX431
          PACK      KEY10,ALREUHC6
          CALL      RDPMHCP1 
          BRANCH    OVRCD,ALRE9999
          MOVE      PMHCTITL,FMTTITLE
          MOVE      PMHCGNAM,FMTGNAME
          MOVE      PMHCSNAM,FMTSNAME
          CALL      DOCNM000
          WRITE     HTMLFILE;DOCFNAME;
          GOTO      ALRE9999
.
ALREX431  WRITE     HTMLFILE;ALREUHC6;
          GOTO      ALREX999
.
ALREX440  MOVE      "lu",CATEGORY
          MOVE      ALREUC21,CODE
          CALL      CODITM00
          GOTO      ALREX999
.
ALREX450  MOVE      "lt",CATEGORY
          MOVE      ALREUC20,CODE
          CALL      CODITM00
          GOTO      ALREX999
.
ALREX460  MOVE      "lv",CATEGORY
          MOVE      ALREUC22,CODE
          CALL      CODITM00
          GOTO      ALREX999
.
ALREX470  MATCH     ALRERRDT,SP70
          GOTO      ALREX999 IF EQUAL
.
          UNPACK    ALRERRDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX480  MOVE      ALREDIA4,ALLRFDIA
          CALL      ALLDIA00
          GOTO      ALREX999
.
ALREX490  MOVE      ALREDIA5,ALLRFDIA
          CALL      ALLDIA00
          GOTO      ALREX999
.
ALREX500  MOVE      ALREPRC1,KEY9
          CALL      ALLPRO00
          GOTO      ALREX999
.
ALREX510  MOVE      ALREPRC2,KEY9
          CALL      ALLPRO00
          GOTO      ALREX999
.
ALREX520  MOVE      ALREPRC3,KEY9
          CALL      ALLPRO00
          GOTO      ALREX999
.
ALREX530  MOVE      ALREPRC4,KEY9
          CALL      ALLPRO00
          GOTO      ALREX999
.
ALREX540  MOVE      ALREPRC5,KEY9
          CALL      ALLPRO00
          GOTO      ALREX999
.
ALREX550  MOVE      NO,YESNO
          MATCH     "1",ALRENVIN
          IF       @EQUAL
            MOVE      YES,YESNO
          ENDIF
          WRITE     HTMLFILE;YESNO;
          GOTO      ALREX999
.
ALREX560  MATCH     ALREUD11,SP70
          GOTO      ALREX999 IF EQUAL
.
          UNPACK    ALREUD11,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX570  WRITE     HTMLFILE;ALREUT11;
          GOTO      ALREX999
.
ALREX580  MATCH     ALREUD12,SP70
          GOTO      ALREX999 IF EQUAL
.
          UNPACK    ALREUD12,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX590  WRITE     HTMLFILE;ALREUT12;
          GOTO      ALREX999
.
ALREX600  MATCH     ALREUD13,SP70
          GOTO      ALREX999 IF EQUAL
.
          UNPACK    ALREUD13,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX610  WRITE     HTMLFILE;ALREUT13;
          GOTO      ALREX999
.
ALREX620  MATCH     ALREUD14,SP70
          GOTO      ALREX999 IF EQUAL
.
          UNPACK    ALREUD14,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX630  WRITE     HTMLFILE;ALREUT14;
          GOTO      ALREX999
.
ALREX640  MATCH     ALREUD15,SP70
          GOTO      ALREX999 IF EQUAL
.
          UNPACK    ALREUD15,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX650  WRITE     HTMLFILE;ALREUT15;
          GOTO      ALREX999
.
ALREX660  MOVE      "ts",CATEGORY
          MOVE      ALRETRGS,CODE
          CALL      CODITM00
          GOTO      ALREX999
.
ALREX670  MATCH     ALRETRGD,SP70
          GOTO      ALREX999 IF EQUAL
.
          UNPACK    ALRETRGD,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      ALREX999
.
ALREX680  MOVE      "ro",CATEGORY
          MOVE      ALREBKOV,CODE
          CALL      CODITM00
          GOTO      ALREX999
.
ALREX690  MOVE      "RF",CATEGORY
          MOVE      ALREBKPR,CODE
          CALL      CODITM00
          GOTO      ALREX999
.
ALREX700  WRITE     HTMLFILE;ALREBKPM;
          GOTO      ALREX999
.
ALREX710  MOVE      "0",DIM1
          MATCH     "1",ALREBKBA
          IF        @EQUAL
            MOVE      ALREBKBA,DIM1
          ENDIF
          WRITE     HTMLFILE;DIM1;
          GOTO      ALREX999
.
ALREX720  WRITE     HTMLFILE;ALREFTSC;
          GOTO      ALREX999
.
ALREX730  MOVE      "CV",CATEGORY                       
          MOVE      ALRESTYP,CODE                       
          CALL      CODITM00                            
          GOTO      ALREX999                            
.
ALREX740  MOVE      ALREDEPT,INALDEPT
          MOVE      ALRESSUB,INALCONT   
          PROC      SRSUBSEL
          GOTO      ALREX999
.
ALREX999  RETURN
.
.------------------------------------------------------------
. Display the date for the referral status
.------------------------------------------------------------
STATDT00  MATCH     "0",ALRESTAT
          GOTO      STATDT01 IF NOT EQUAL
          GOTO      STATDT99
.
STATDT01  MATCH     "1",ALRESTAT
          GOTO      STATDT02 IF NOT EQUAL
.
          MATCH     ALREDACT,SP70
          GOTO      STATDT99 IF EQUAL
.
          UNPACK    ALREDACT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      STATDT99
.
STATDT02  MATCH     "2",ALRESTAT
          GOTO      STATDT03 IF NOT EQUAL
.
          MATCH     ALREDCLO,SP70
          GOTO      STATDT99 IF EQUAL
.
          UNPACK    ALREDCLO,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      STATDT99
.
STATDT03  MATCH     "3",ALRESTAT
          GOTO      STATDT04 IF NOT EQUAL
.
          MATCH     ALREDINA,SP70
          GOTO      STATDT99 IF EQUAL
.
          UNPACK    ALREDINA,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      STATDT99
.
STATDT04  MATCH     "4",ALRESTAT
          GOTO      STATDT05 IF NOT EQUAL
.
          MATCH     ALREDCAN,SP70
          GOTO      STATDT99 IF EQUAL
.
          UNPACK    ALREDCAN,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      STATDT99
.
STATDT05  MATCH     "5",ALRESTAT
          GOTO      STATDT99 IF NOT EQUAL
.
          MATCH     ALRESRDT,SP70
          GOTO      STATDT99 IF EQUAL
.
          UNPACK    ALRESRDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
.
          GOTO      STATDT99
.
STATDT99  RETURN
+
.------------------------------------------------------------
. Clinic Type List
.------------------------------------------------------------
ARFCTY00  PACK      KEY15,WBSESIT,DEPTCODE,SP70
          CALL      RDSCTYA3
ARFCTY10  CALL      RDKCTYA3
          BRANCH    OVRCD,ARFCTY99
          MATCH     OCTSITE,WBSESIT
          GOTO      ARFCTY99 IF NOT EQUAL
          MATCH     OCTGRP,DEPTCODE
          GOTO      ARFCTY99 IF NOT EQUAL
.
          MATCH     ALRECTYP,OCTCTYP
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",OCTCTYP,"#" selected>":
                               OCTDESC,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",OCTCTYP,"#">":
                               OCTDESC,"</option>"
          ENDIF
          GOTO      ARFCTY10
.
ARFCTY99  RETURN
.
.------------------------------------------------------------
. Departments default (First on file ) clinic type code
.------------------------------------------------------------
DEPDCT00  PACK      KEY15,WBSESIT,DEPTCODE,SP70
          CALL      RDSCTYA3
DEPDCT10  CALL      RDKCTYA3
          BRANCH    OVRCD,DEPDCT99
.
          MATCH     OCTSITE,WBSESIT
          GOTO      DEPDCT99 IF NOT EQUAL
.
          MATCH     OCTGRP,DEPTCODE
          GOTO      DEPDCT99 IF NOT EQUAL
.
          WRITE     HTMLFILE;OCTCTYP;
.
DEPDCT99  RETURN
.
.------------------------------------------------------------
.   Set Parameters for allied health services referral table file
.------------------------------------------------------------
SPALR000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,SPALR001,SPALR002,SPALR003,SPALR004,SPALR005:
                       SPALR006,SPALR007,SPALR008,SPALR009,SPALR010:
                       SPALR011,SPALR012,SPALR013,SPALR014,SPALR015:
                       SPALR016,SPALR017,SPALR018,SPALR019,SPALR020:
                       SPALR021,SPALR022,SPALR023,SPALR024,SPALR025:
                       SPALR026,SPALR027,SPALR028,SPALR029,SPALR030:
                       SPALR031,SPALR032,SPALR033,SPALR034,SPALR035:
                       SPALR036,SPALR037,SPALR038,SPALR039,SPALR040:
                       SPALR041,SPALR042,SPALR043,SPALR044,SPALR045:
                       SPALR046,SPALR047,SPALR048,SPALR049,SPALR050:
                       SPALR051,SPALR052,SPALR053,SPALR054,SPALR055:
                       SPALR056,SPALR057,SPALR058,SPALR059,SPALR060:
                       SPALR061,SPALR062,SPALR063,SPALR064,SPALR065:
                       SPALR066,SPALR067,SPALR068,SPALR069,SPALR070:
                       SPALR071,SPALR072,SPALR073,SPALR074,SPALR075:
                       SPALR076,SPALR077,SPALR078,SPALR079,SPALR080:
                       SPALR081,SPALR082,SPALR083,SPALR084,SPALR085:
                       SPALR086,SPALR087,SPALR088,SPALR089,SPALR090:
                       SPALR091,SPALR092,SPALR093,SPALR094,SPALR095:
                       SPALR096,SPALR097,SPALR098,SPALR099,SPALR100:
                       SPALR101,SPALR102,SPALR103,SPALR104,SPALR105:
                       SPALR106,SPALR107,SPALR108,SPALR109,SPALR110:
                       SPALR111,SPALR112,SPALR113,SPALR114,SPALR115:
                       SPALR116,SPALR117,SPALR118,SPALR119,SPALR120:
                       SPALR121,SPALR122,SPALR123,SPALR124,SPALR125:
                       SPALR126,SPALR127,SPALR128,SPALR129,SPALR130:
                       SPALR131,SPALR132,SPALR133,SPALR134,SPALR135:
                       SPALR136,SPALR137,SPALR138,SPALR139,SPALR140:
                       SPALR141,SPALR142,SPALR143,SPALR144,SPALR145:
                       SPALR146,SPALR147,SPALR148,SPALR149,SPALR150:
                       SPALR151,SPALR152,SPALR153,SPALR154,SPALR155:
                       SPALR156,SPALR157,SPALR158,SPALR159,SPALR160:
                       SPALR161,SPALR162,SPALR163,SPALR164,SPALR165:
                       SPALR166,SPALR167,SPALR168,SPALR169,SPALR170:
                       SPALR171,SPALR172,SPALR173,SPALR174,SPALR175:
                       SPALR176,SPALR177,SPALR178,SPALR179,SPALR180:
                       SPALR181,SPALR182,SPALR183,SPALR184,SPALR185:
                       SPALR186,SPALR187,SPALR188,SPALR189,SPALR190:
                       SPALR191,SPALR192,SPALR193
          MOVE      ONE,EXIT
          GOTO      SPALR0999
.
SPALR001  SQUEEZE   QRYDATA  
          MOVE      QRYDATA,ALREF001
          PACK      ALREF001,ALREF001,SP70
          GOTO      SPALR999
.
SPALR002  SQUEEZE   QRYDATA
          MOVE      QRYDATA,ALREF002
          PACK      ALREF002,ALREF002,SP70
          GOTO      SPALR999
.
SPALR003  MOVE      QRYDATA,ALREF003
          GOTO      SPALR999
.
SPALR004  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF004,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR005  MOVE      QRYDATA,ALREF005
          PACK      ALREF005,ALREF005,SP70
          GOTO      SPALR999
.
SPALR006  MOVE      QRYDATA,ALREF006
          GOTO      SPALR999
.
SPALR007  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF007,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR008  MOVE      QRYDATA,ALREF008
          GOTO      SPALR999
.
SPALR009  MOVE      QRYDATA,ALREF009
          GOTO      SPALR999
.
SPALR010  MOVE      QRYDATA,ALREF010
          GOTO      SPALR999
.
SPALR011  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF011,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR012  MOVE      QRYDATA,ALREF012
          GOTO      SPALR999
.
SPALR013  MOVE      QRYDATA,ALREF013
          GOTO      SPALR999
.
SPALR014  MOVE      QRYDATA,ALREF014
          GOTO      SPALR999
.
SPALR015  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF015,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR016  MOVE      QRYDATA,ALREF016
          GOTO      SPALR999
.
SPALR017  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF017,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR018  MOVE      QRYDATA,ALREF018
          GOTO      SPALR999
.
SPALR019  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF019,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR020  MOVE      QRYDATA,ALREF020
          GOTO      SPALR999
.
SPALR021  MOVE      QRYDATA,ALREF021
          GOTO      SPALR999
.
SPALR022  SQUEEZE   QRYDATA 
          MOVE      QRYDATA,ALREF022
          PACK      ALREF022,ALREF022,SP70
          GOTO      SPALR999
.
SPALR023  MOVE      QRYDATA,ALREF023
          GOTO      SPALR999
.
SPALR024  MOVE      QRYDATA,ALREF024
          GOTO      SPALR999
.
SPALR025  MOVE      QRYDATA,ALREF025
          GOTO      SPALR999
.
SPALR026  MOVE      QRYDATA,ALREF026
          GOTO      SPALR999
.
SPALR027  MOVE      QRYDATA,ALREF027
          GOTO      SPALR999
.
SPALR028  MOVE      QRYDATA,ALREF028
          GOTO      SPALR999
.
SPALR029  MOVE      QRYDATA,ALREF029
          GOTO      SPALR999
.
SPALR030  MOVE      QRYDATA,ALREF030
          GOTO      SPALR999
.
SPALR031  MOVE      QRYDATA,ALREF031
          GOTO      SPALR999
.
SPALR032  MOVE      QRYDATA,ALREF032
          GOTO      SPALR999
.
SPALR033  MOVE      QRYDATA,ALREF033
          GOTO      SPALR999
.
SPALR034  MOVE      QRYDATA,ALREF034
          GOTO      SPALR999
.
SPALR035  MOVE      QRYDATA,ALREF035
          GOTO      SPALR999
.
SPALR036  MOVE      QRYDATA,ALREF036
          GOTO      SPALR999
.
SPALR037  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF037,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR038  MOVE      QRYDATA,ALREF038
          GOTO      SPALR999
.
SPALR039  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF039,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR040  MOVE      QRYDATA,ALREF040
          GOTO      SPALR999
.
SPALR041  MOVE      QRYDATA,ALREF041
          GOTO      SPALR999
.
SPALR042  MOVE      QRYDATA,ALREF042
          GOTO      SPALR999
.
SPALR043  MOVE      QRYDATA,ALREF043
          GOTO      SPALR999
.
SPALR044  MOVE      QRYDATA,ALREF044
          GOTO      SPALR999
.
SPALR045  MOVE      QRYDATA,ALREF045
          GOTO      SPALR999
.
SPALR046  MOVE      QRYDATA,ALREF046
          GOTO      SPALR999
.
SPALR047  MOVE      QRYDATA,ALREF047
          GOTO      SPALR999
.
SPALR048  MOVE      QRYDATA,ALREF048
          GOTO      SPALR999
.
SPALR049  MOVE      QRYDATA,ALREF049
          GOTO      SPALR999
.
SPALR050  MOVE      QRYDATA,ALREF050
          GOTO      SPALR999
.
SPALR051  MOVE      QRYDATA,ALREF051
          GOTO      SPALR999
.
SPALR052  MOVE      QRYDATA,ALREF052
          GOTO      SPALR999
.
SPALR053  MOVE      QRYDATA,ALREF053
          GOTO      SPALR999
.
SPALR054  MOVE      QRYDATA,ALREF054
          GOTO      SPALR999
.
SPALR055  MOVE      QRYDATA,ALREF055
          GOTO      SPALR999
.
SPALR056  MOVE      QRYDATA,ALREF056
          GOTO      SPALR999
.
SPALR057  MOVE      QRYDATA,ALREF057
          GOTO      SPALR999
.
SPALR058  MOVE      QRYDATA,ALREF058
          GOTO      SPALR999
.
SPALR059  MOVE      QRYDATA,ALREF059
          GOTO      SPALR999
.
SPALR060  MOVE      QRYDATA,ALREF060
          GOTO      SPALR999
.
SPALR061  MOVE      QRYDATA,ALREF061
          GOTO      SPALR999
.
SPALR062  MOVE      QRYDATA,ALREF062
          GOTO      SPALR999
.
SPALR063  MOVE      QRYDATA,ALREF063
          GOTO      SPALR999
.
SPALR064  MOVE      QRYDATA,ALREF064
          GOTO      SPALR999
.
SPALR065  MOVE      QRYDATA,ALREF065
          GOTO      SPALR999
.
SPALR066  MOVE      QRYDATA,ALREF066
          GOTO      SPALR999
.
SPALR067  MOVE      QRYDATA,ALREF067 
          GOTO      SPALR999
.
SPALR068  MOVE      QRYDATA,ALREF068
          GOTO      SPALR999
.
SPALR069  MOVE      QRYDATA,ALREF069
          GOTO      SPALR999
.
SPALR070  MOVE      QRYDATA,ALREF070
          GOTO      SPALR999
.
SPALR071  MOVE      QRYDATA,ALREF071
          GOTO      SPALR999
.
SPALR072  MOVE      QRYDATA,ALREF072
          GOTO      SPALR999
.
SPALR073  MOVE      QRYDATA,ALREF073
          GOTO      SPALR999
.
SPALR074  MOVE      QRYDATA,ALREF074
          GOTO      SPALR999
.
SPALR075  MOVE      QRYDATA,ALREF075
          GOTO      SPALR999
.
SPALR076  MOVE      QRYDATA,ALREF076
          GOTO      SPALR999
.
SPALR077  MOVE      QRYDATA,ALREF077
          GOTO      SPALR999
.
SPALR078  MOVE      QRYDATA,ALREF078
          GOTO      SPALR999
.
SPALR079  MOVE      QRYDATA,ALREF079
          GOTO      SPALR999
.
SPALR080  MOVE      QRYDATA,ALREF080
          GOTO      SPALR999
.
SPALR081  MOVE      QRYDATA,ALREF081
          GOTO      SPALR999
.
SPALR082  MOVE      QRYDATA,ALREF082
          GOTO      SPALR999
.
SPALR083  MOVE      QRYDATA,ALREF083 
          GOTO      SPALR999
.
SPALR084  MOVE      QRYDATA,ALREF084
          GOTO      SPALR999
.
SPALR085  MOVE      QRYDATA,ALREF085
          GOTO      SPALR999
.
SPALR086  MOVE      QRYDATA,ALREF086
          GOTO      SPALR999
.
SPALR087  MOVE      QRYDATA,ALREF087
          GOTO      SPALR999
.
SPALR088  MOVE      QRYDATA,ALREF088
          GOTO      SPALR999
.
SPALR089  MOVE      QRYDATA,ALREF089
          GOTO      SPALR999
.
SPALR090  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF090,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR091  MOVE      QRYDATA,ALREF091
          GOTO      SPALR999
.
SPALR092  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF092,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR093  MOVE      QRYDATA,ALREF093
          GOTO      SPALR999
.
SPALR094  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF094,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR095  MOVE      QRYDATA,ALREF095
          GOTO      SPALR999
.
SPALR096  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF096,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR097  MOVE      QRYDATA,ALREF097
          GOTO      SPALR999
.
SPALR098  MOVE      QRYDATA,ALREF098
          GOTO      SPALR999
.
SPALR099  MOVE      QRYDATA,ALREF099
          GOTO      SPALR999
.
SPALR100  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF100,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR101  MOVE      QRYDATA,ALREF101
          GOTO      SPALR999
.
SPALR102  MOVE      QRYDATA,ALREF102
          GOTO      SPALR999
.
SPALR103  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF103,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR104  MOVE      QRYDATA,ALREF104
          GOTO      SPALR999
.
SPALR105  MOVE      QRYDATA,ALREF105
          GOTO      SPALR999
.
SPALR106  MOVE      QRYDATA,ALREF106
          GOTO      SPALR999
.
SPALR107  MOVE      QRYDATA,ALREF107
          GOTO      SPALR999
.
SPALR108  MOVE      QRYDATA,ALREF108
          GOTO      SPALR999
.
SPALR109  MOVE      QRYDATA,ALREF109
          GOTO      SPALR999
.
SPALR110  MOVE      QRYDATA,ALREF110
          GOTO      SPALR999
.
SPALR111  MOVE      QRYDATA,ALREF111
          GOTO      SPALR999
.
SPALR112  MOVE      QRYDATA,ALREF112
          GOTO      SPALR999
.
SPALR113  MOVE      QRYDATA,ALREF113
          GOTO      SPALR999
.
SPALR114  MOVE      QRYDATA,ALREF114
          GOTO      SPALR999
.
SPALR115  MOVE      QRYDATA,ALREF115
          GOTO      SPALR999
.
SPALR116  MOVE      QRYDATA,ALREF116
          GOTO      SPALR999
.
SPALR117  MOVE      QRYDATA,ALREF117
          GOTO      SPALR999
.
SPALR118  MOVE      QRYDATA,ALREF118
          GOTO      SPALR999
.
SPALR119  MOVE      QRYDATA,ALREF119
          GOTO      SPALR999
.
SPALR120  MOVE      QRYDATA,ALREF120
          GOTO      SPALR999
.
SPALR121  MOVE      QRYDATA,ALREF121
          GOTO      SPALR999
.
SPALR122  MOVE      QRYDATA,ALREF122
          GOTO      SPALR999
.
SPALR123  MOVE      QRYDATA,ALREF123
          GOTO      SPALR999
.
SPALR124  MOVE      QRYDATA,ALREF124
          GOTO      SPALR999
.
SPALR125  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF125,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR126  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF126,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR127  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF127,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR128  MOVE      QRYDATA,ALREF128
          GOTO      SPALR999
.
SPALR129  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF129,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR130  MOVE      QRYDATA,ALREF130
          GOTO      SPALR999
.
SPALR131  MOVE      QRYDATA,ALREF131
          GOTO      SPALR999
.
SPALR132  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF132,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR133  MOVE      QRYDATA,ALREF133
          GOTO      SPALR999
.
SPALR134  MOVE      QRYDATA,ALREF134
          GOTO      SPALR999
.
SPALR135  MOVE      QRYDATA,ALREF135
          GOTO      SPALR999
.
SPALR136  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF136,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999                
.         
SPALR137  MOVE      QRYDATA,ALREF137
          GOTO      SPALR999
.
SPALR138  MOVE      QRYDATA,ALREF138
          GOTO      SPALR999
.
SPALR139  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF139,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR140  MOVE      QRYDATA,ALREF140
          GOTO      SPALR999
.
SPALR141  MOVE      QRYDATA,ALREF141
          GOTO      SPALR999
.
SPALR142  MOVE      QRYDATA,ALREF142
          GOTO      SPALR999
.
SPALR143  MOVE      QRYDATA,ALREF143
          GOTO      SPALR999
.
SPALR144  MOVE      QRYDATA,ALREF144
          GOTO      SPALR999
.
SPALR145  MOVE      QRYDATA,ALREF145
          GOTO      SPALR999
.
SPALR146  MOVE      QRYDATA,ALREF146
          GOTO      SPALR999
.
SPALR147  MOVE      QRYDATA,ALREF147
          GOTO      SPALR999
.
SPALR148  MOVE      QRYDATA,ALREF148
          GOTO      SPALR999
.
SPALR149  MOVE      QRYDATA,ALREF149
          GOTO      SPALR999
.
SPALR150  MOVE      QRYDATA,ALREF150
          GOTO      SPALR999
.
SPALR151  MOVE      QRYDATA,ALREF151
          GOTO      SPALR999
.
SPALR152  MOVE      QRYDATA,ALREF152
          GOTO      SPALR999
.
SPALR153  MOVE      QRYDATA,ALREF153
          GOTO      SPALR999
.
SPALR154  MOVE      QRYDATA,ALREF154
          GOTO      SPALR999
.
SPALR155  MOVE      QRYDATA,ALREF155
          GOTO      SPALR999
.
SPALR156  MOVE      QRYDATA,ALREF156 
          GOTO      SPALR999
.
SPALR157  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF157,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR158  MOVE      QRYDATA,ALREF158
          GOTO      SPALR999
.
SPALR159  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF159,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR160  MOVE      QRYDATA,ALREF160
          GOTO      SPALR999
.
SPALR161  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF161,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR162  MOVE      QRYDATA,ALREF162
          GOTO      SPALR999
.
SPALR163  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF163,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR164  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF164,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR165  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF165,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR166  MOVE      QRYDATA,ALREF166
          GOTO      SPALR999
.
SPALR167  MOVE      QRYDATA,ALREF167
          GOTO      SPALR999
.
SPALR168  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF168,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR169  MOVE      QRYDATA,ALREF169
          GOTO      SPALR999
.
SPALR170  MOVE      QRYDATA,ALREF170
          GOTO      SPALR999
.
SPALR171  MOVE      QRYDATA,ALREF171
          GOTO      SPALR999
.
SPALR172  MOVE      QRYDATA,ALREF172
          GOTO      SPALR999
.
SPALR173  MOVE      QRYDATA,ALREF173
          GOTO      SPALR999
.
SPALR174  MOVE      QRYDATA,ALREF174
          GOTO      SPALR999
.
SPALR175  MOVE      QRYDATA,ALREF175
          GOTO      SPALR999
.
SPALR176  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF176,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR177  MOVE      QRYDATA,ALREF177
          GOTO      SPALR999
.
SPALR178  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF178,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR179  MOVE      QRYDATA,ALREF179
          GOTO      SPALR999
.
SPALR180  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF180,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR181  MOVE      QRYDATA,ALREF181
          GOTO      SPALR999
.
SPALR182  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF182,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR183  MOVE      QRYDATA,ALREF183
          GOTO      SPALR999
.
SPALR184  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF184,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR185  MOVE      QRYDATA,ALREF185
          GOTO      SPALR999
.
SPALR186  MOVE      QRYDATA,ALREF186
          GOTO      SPALR999
.
SPALR187  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00                *Set CMON from MTHNAM3
          PACK      ALREF187,CCENT,CYEAR,CMON,CDAY
          GOTO      SPALR999
.
SPALR188  MOVE      QRYDATA,ALREF188
          GOTO      SPALR999
.
SPALR189  MOVE      QRYDATA,ALREF189
          GOTO      SPALR999
.
SPALR190  MOVE      QRYDATA,ALREF190
          GOTO      SPALR999
.
SPALR191  MOVE      QRYDATA,ALREF191
          GOTO      SPALR999
.
SPALR192  MOVE      QRYDATA,ALREF192
          GOTO      SPALR999
.
SPALR193  MOVE      QRYDATA,ALREF193
          GOTO      SPALR999
.
SPALR999  RETURN
.------------------------------------------------------------
.  Update allied health services referral table file
.------------------------------------------------------------
MVALRE00  MATCH     ALREF001,Z70
          IF        !@EQUAL
            MOVE      ALREF001,ALREVISN
          ENDIF
.
          MATCH     ALREF002,Z70
          IF        !@EQUAL
            MOVE      ALREF002,ALREURNO
          ENDIF
.
          MATCH     ALREF003,Z70
          IF        !@EQUAL
            MOVE      ALREF003,ALRESTAT
          ENDIF
.
          MATCH     ALREF004,Z70
          IF        !@EQUAL
            MOVE      ALREF004,ALREDACT
          ENDIF
.
          MATCH     ALREF005,Z70
          IF        !@EQUAL
            MOVE      ALREF005,ALRELINK
          ENDIF
.
          MATCH     ALREF006,Z70
          IF        !@EQUAL
            MOVE      ALREF006,ALRERCLO
          ENDIF
.
          MATCH     ALREF007,Z70
          IF        !@EQUAL
            MOVE      ALREF007,ALREDCLO
          ENDIF
.
          MATCH     ALREF008,Z70
          IF        !@EQUAL
            MOVE      ALREF008,ALRETCLO
          ENDIF
.
          MATCH     ALREF009,Z70
          IF        !@EQUAL
            MOVE      ALREF009,ALREUCLO
          ENDIF
.
          MATCH     ALREF010,Z70
          IF        !@EQUAL
            MOVE      ALREF010,ALRERCAN
          ENDIF
.
          MATCH     ALREF011,Z70
          IF        !@EQUAL
            MOVE      ALREF011,ALREDCAN
          ENDIF
.
          MATCH     ALREF012,Z70
          IF        !@EQUAL
            MOVE      ALREF012,ALRETCAN
          ENDIF
.
          MATCH     ALREF013,Z70
          IF        !@EQUAL
            MOVE      ALREF013,ALREUCAN
          ENDIF
.
          MATCH     ALREF014,Z70
          IF        !@EQUAL
            MOVE      ALREF014,ALRERINA 
          ENDIF
.
          MATCH     ALREF015,Z70
          IF        !@EQUAL
            MOVE      ALREF015,ALREDINA
          ENDIF
.
          MATCH     ALREF016,Z70
          IF        !@EQUAL
            MOVE      ALREF016,ALRETINA
          ENDIF
.
          MATCH     ALREF017,Z70
          IF        !@EQUAL
            MOVE      ALREF017,ALREDINU
          ENDIF
.
          MATCH     ALREF018,Z70
          IF        !@EQUAL
            MOVE      ALREF018,ALREUINA
          ENDIF
.
          MATCH     ALREF019,Z70
          IF        !@EQUAL
            MOVE      ALREF019,ALRERDAT
          ENDIF
.
          MATCH     ALREF020,Z70
          IF        !@EQUAL
            MOVE      ALREF020,ALRERDEP
          ENDIF
.
          MATCH     ALREF021,Z70
          IF        !@EQUAL
            MOVE      ALREF021,ALRERDOC
          ENDIF
.
          MATCH     ALREF022,Z70
          IF        !@EQUAL
            MOVE      ALREF022,ALRERHCP
          ENDIF
.
          MATCH     ALREF023,Z70
          IF        !@EQUAL
            MOVE      ALREF023,ALRERHCR
          ENDIF
.
          MATCH     ALREF024,Z70
          IF        !@EQUAL
            MOVE      ALREF024,ALRERHCT
          ENDIF
.
          MATCH     ALREF025,Z70
          IF        !@EQUAL
            MOVE      ALREF025,ALREDEPT
          ENDIF
.
          MATCH     ALREF026,Z70
          IF        !@EQUAL
            MOVE      ALREF026,ALREUNIT
          ENDIF
.
          MATCH     ALREF027,Z70
          IF        !@EQUAL
            MOVE      ALREF027,ALREPRTY
          ENDIF
.
          MATCH     ALREF028,Z70
          IF        !@EQUAL
            MOVE      ALREF028,ALREPRO1
          ENDIF
.
          MATCH     ALREF029,Z70
          IF        !@EQUAL
            MOVE      ALREF029,ALREPRO2
          ENDIF
.
          MATCH     ALREF030,Z70
          IF        !@EQUAL
            MOVE      ALREF030,ALREPRO3
          ENDIF
.
          MATCH     ALREF031,Z70
          IF        !@EQUAL
            MOVE      ALREF031,ALREDIA1
          ENDIF
.
          MATCH     ALREF032,Z70
          IF        !@EQUAL
            MOVE      ALREF032,ALREDIA2
          ENDIF
.
          MATCH     ALREF033,Z70
          IF        !@EQUAL
            MOVE      ALREF033,ALREDIA3
          ENDIF
.
          MATCH     ALREF034,Z70
          IF        !@EQUAL
            MOVE      ALREF034,ALRESRCE
          ENDIF
.
          MATCH     ALREF035,Z70
          IF        !@EQUAL
            MOVE      ALREF035,ALRECOMP
          ENDIF
.
          MATCH     ALREF036,Z70
          IF        !@EQUAL
            MOVE      ALREF036,ALREBULK
          ELSE
            MOVE      ZERO,ALREBULK
          ENDIF
.
          MATCH     ALREF037,Z70
          IF        !@EQUAL
            MOVE      ALREF037,ALREDREV
          ENDIF
.
          MATCH     ALREF038,Z70
          IF        !@EQUAL
            MOVE      ALREF038,ALREHCP 
          ENDIF
.
          MATCH     ALREF039,Z70
          IF        !@EQUAL
            MOVE      ALREF039,ALREDREC
          ENDIF
.
          MATCH     ALREF040,Z70
          IF        !@EQUAL
            MOVE      ALREF040,ALREUC01
          ENDIF
.
          MATCH     ALREF041,Z70
          IF        !@EQUAL
            MOVE      ALREF041,ALREUC02
          ENDIF
.
          MATCH     ALREF042,Z70
          IF        !@EQUAL
            MOVE      ALREF042,ALREUC03
          ENDIF
.
          MATCH     ALREF043,Z70
          IF        !@EQUAL
            MOVE      ALREF043,ALREUC04
          ENDIF
.
          MATCH     ALREF044,Z70
          IF        !@EQUAL
            MOVE      ALREF044,ALREUC05
          ENDIF
.
          MATCH     ALREF045,Z70
          IF        !@EQUAL
            MOVE      ALREF045,ALREUC06
          ENDIF
.
          MATCH     ALREF046,Z70
          IF        !@EQUAL
            MOVE      ALREF046,ALREUC07
          ENDIF
.
          MATCH     ALREF047,Z70
          IF        !@EQUAL
            MOVE      ALREF047,ALREUC08
          ENDIF
.
          MATCH     ALREF048,Z70
          IF        !@EQUAL
            MOVE      ALREF048,ALREUC09
          ENDIF
.
          MATCH     ALREF049,Z70
          IF        !@EQUAL
            MOVE      ALREF049,ALREUC10
          ENDIF
.
          MATCH     ALREF050,Z70
          IF        !@EQUAL
            MOVE      ALREF050,ALREUC11
          ENDIF
.
          MATCH     ALREF051,Z70
          IF        !@EQUAL
            MOVE      ALREF051,ALREUC12
          ENDIF
.
          MATCH     ALREF052,Z70
          IF        !@EQUAL
            MOVE      ALREF052,ALREUC13
          ENDIF
.
          MATCH     ALREF053,Z70
          IF        !@EQUAL
            MOVE      ALREF053,ALREUC14
          ENDIF
.
          MATCH     ALREF054,Z70
          IF        !@EQUAL
            MOVE      ALREF054,ALREUC15
          ENDIF
.
          MATCH     ALREF055,Z70
          IF        !@EQUAL
            MOVE      ALREF055,ALREUC16
          ENDIF
.
          MATCH     ALREF056,Z70
          IF        !@EQUAL
            MOVE      ALREF056,ALREUC17
          ENDIF
.
          MATCH     ALREF057,Z70
          IF        !@EQUAL
            MOVE      ALREF057,ALREUC18
          ENDIF
.
          MATCH     ALREF058,Z70
          IF        !@EQUAL
            MOVE      ALREF058,ALREUC19
          ENDIF
.
          MATCH     ALREF059,Z70
          IF        !@EQUAL
            MOVE      ALREF059,ALREUC20
          ENDIF
.
          MATCH     ALREF060,Z70
          IF        !@EQUAL
            MOVE      ALREF060,ALREUC21
          ENDIF
.
          MATCH     ALREF061,Z70
          IF        !@EQUAL
            MOVE      ALREF061,ALREUC22
          ENDIF
.
          MATCH     ALREF062,Z70
          IF        !@EQUAL
            MOVE      ALREF062,ALREUC23
          ENDIF
.
          MATCH     ALREF063,Z70
          IF        !@EQUAL
            MOVE      ALREF063,ALREUC24
          ENDIF
.
          MATCH     ALREF064,Z70
          IF        !@EQUAL
            MOVE      ALREF064,ALREUC25
          ENDIF
.
          MATCH     ALREF065,Z70
          IF        !@EQUAL
            MOVE      ALREF065,ALREUC26
          ENDIF
.
          MATCH     ALREF066,Z70
          IF        !@EQUAL
            MOVE      ALREF066,ALREUC27
          ENDIF
.
          MATCH     ALREF067,Z70
          IF        !@EQUAL
            MOVE      ALREF067,ALREUC28
          ENDIF
.
          MATCH     ALREF068,Z70
          IF        !@EQUAL
            MOVE      ALREF068,ALREUC29
          ENDIF
.
          MATCH     ALREF069,Z70
          IF        !@EQUAL
            MOVE      ALREF069,ALREUC30
          ENDIF
.
          MATCH     ALREF070,Z70
          IF        !@EQUAL
            MOVE      ALREF070,ALREUC31
          ENDIF
.
          MATCH     ALREF071,Z70
          IF        !@EQUAL
            MOVE      ALREF071,ALREUC32
          ENDIF
.
          MATCH     ALREF072,Z70
          IF        !@EQUAL
            MOVE      ALREF072,ALREUC33
          ENDIF
.
          MATCH     ALREF073,Z70
          IF        !@EQUAL
            MOVE      ALREF073,ALREUC34
          ENDIF
.
          MATCH     ALREF074,Z70
          IF        !@EQUAL
            MOVE      ALREF074,ALREUC35
          ENDIF
.
          MATCH     ALREF075,Z70
          IF        !@EQUAL
            MOVE      ALREF075,ALREUC36
          ENDIF
.
          MATCH     ALREF076,Z70
          IF        !@EQUAL
            MOVE      ALREF076,ALREUC37
          ENDIF
.
          MATCH     ALREF077,Z70
          IF        !@EQUAL
            MOVE      ALREF077,ALREUC38
          ENDIF
.
          MATCH     ALREF078,Z70
          IF        !@EQUAL
            MOVE      ALREF078,ALREUC39
          ENDIF
.
          MATCH     ALREF079,Z70
          IF        !@EQUAL
            MOVE      ALREF079,ALREUC40
          ENDIF
.
          MATCH     ALREF080,Z70
          IF        !@EQUAL
            MOVE      ALREF080,ALREUYN1
          ELSE
            MOVE      ZERO,ALREUYN1
          ENDIF
.
          MATCH     ALREF081,Z70
          IF        !@EQUAL
            MOVE      ALREF081,ALREUYN2
          ELSE
            MOVE      ZERO,ALREUYN2
          ENDIF
.
          MATCH     ALREF082,Z70
          IF        !@EQUAL
            MOVE      ALREF082,ALREUYN3
          ELSE
            MOVE      ZERO,ALREUYN3
          ENDIF
.
          MATCH     ALREF083,Z70
          IF        !@EQUAL
            MOVE      ALREF083,ALREUYN4
          ELSE
            MOVE      ZERO,ALREUYN4
          ENDIF
.
          MATCH     ALREF084,Z70
          IF        !@EQUAL
            MOVE      ALREF084,ALREUHC1
          ENDIF
.
          MATCH     ALREF085,Z70
          IF        !@EQUAL
            MOVE      ALREF085,ALREUHC2
          ENDIF
.
          MATCH     ALREF086,Z70
          IF        !@EQUAL
            MOVE      ALREF086,ALREUHC3
          ENDIF
.
          MATCH     ALREF087,Z70
          IF        !@EQUAL
            MOVE      ALREF087,ALREUHC4
          ENDIF
.
          MATCH     ALREF088,Z70
          IF        !@EQUAL
            MOVE      ALREF088,ALREUFR1
          ENDIF
.
          MATCH     ALREF089,Z70
          IF        !@EQUAL
            MOVE      ALREF089,ALREUFR2
          ENDIF
.
          MATCH     ALREF090,Z70
          IF        !@EQUAL
            MOVE      ALREF090,ALREUDT1
          ENDIF
.
          MATCH     ALREF091,Z70
          IF        !@EQUAL
            MOVE      ALREF091,ALREUTM1
          ENDIF
.
          MATCH     ALREF092,Z70
          IF        !@EQUAL
            MOVE      ALREF092,ALREUDT2
          ENDIF
.
          MATCH     ALREF093,Z70
          IF        !@EQUAL
            MOVE      ALREF093,ALREUTM2
          ENDIF
.
          MATCH     ALREF094,Z70
          IF        !@EQUAL
            MOVE      ALREF094,ALREUDT3
          ENDIF
.
          MATCH     ALREF095,Z70
          IF        !@EQUAL
            MOVE      ALREF095,ALREUTM3
          ENDIF
.
          MATCH     ALREF096,Z70
          IF        !@EQUAL
            MOVE      ALREF096,ALREUDT4
          ENDIF
.
          MATCH     ALREF097,Z70
          IF        !@EQUAL
            MOVE      ALREF097,ALREUTM4
          ENDIF
.
          COMPARE   ALREF098,ZERO
          IF        !@EQUAL
            MOVE      ALREF098,ALREUNO1
          ENDIF
.
          COMPARE   ALREF099,ZERO
          IF        !@EQUAL
            MOVE      ALREF099,ALREUNO2
          ENDIF
.
          MATCH     ALREF100,Z70
          IF        !@EQUAL
            MOVE      ALREF100,ALRECDAT
          ENDIF
.
          MATCH     ALREF101,Z70
          IF        !@EQUAL
            MOVE      ALREF101,ALRECTIM
          ENDIF
.
          MATCH     ALREF102,Z70
          IF        !@EQUAL
            MOVE      ALREF102,ALRECUID
          ENDIF
.
          MATCH     ALREF103,Z70
          IF        !@EQUAL
            MOVE      ALREF103,ALREUDAT
          ENDIF
.
          MATCH     ALREF104,Z70
          IF        !@EQUAL
            MOVE      ALREF104,ALREUTIM
          ENDIF
.
          MATCH     ALREF105,Z70
          IF        !@EQUAL
            MOVE      ALREF105,ALREUUID
          ENDIF
.
          MATCH     ALREF106,Z70
          IF        !@EQUAL
            MOVE      ALREF106,ALRECTYP
          ENDIF
.
.>>>>     MATCH     ALREF107,Z70
.>>>>     IF        !@EQUAL
.>>>>       MOVE      ALREF107,ALREHOSN
.>>>>     ENDIF
.
          MATCH     ALREF108,Z70
          IF        !@EQUAL
            MOVE      ALREF108,ALREFHCP
          ENDIF
.
          MATCH     ALREF109,Z70
          IF        !@EQUAL
            MOVE      ALREF109,ALREHCP1
          ENDIF
.
          MATCH     ALREF110,Z70
          IF        !@EQUAL
            MOVE      ALREF110,ALREHCP2
          ENDIF
.
          MATCH     ALREF111,Z70
          IF        !@EQUAL
            MOVE      ALREF111,ALREHCP3
          ENDIF
.
          MATCH     ALREF112,Z70
          IF        !@EQUAL
            MOVE      ALREF112,ALREHCPC
          ENDIF
.
          MATCH     ALREF113,Z70
          IF        !@EQUAL
            MOVE      ALREF113,ALREHCPS
          ENDIF
.
          MATCH     ALREF114,Z70
          IF        !@EQUAL
            MOVE      ALREF114,ALREHCPB
          ENDIF
.
          MATCH     ALREF115,Z70
          IF        !@EQUAL
            MOVE      ALREF115,ALREHCPF
          ENDIF
.
          MATCH     ALREF116,Z70
          IF        !@EQUAL
            MOVE      ALREF116,ALREHCPP
          ENDIF
.
          MATCH     ALREF117,Z70
          IF        !@EQUAL
            MOVE      ALREF117,ALRESTYP
          ENDIF
.
          MATCH     ALREF118,Z70
          IF        !@EQUAL
            MOVE      ALREF118,ALREPRCM
          ENDIF
.
          MATCH     ALREF119,Z70
          IF        !@EQUAL
            MOVE      ALREF119,ALREPSIT
          ENDIF
.
          MATCH     ALREF120,Z70
          IF        !@EQUAL
            MOVE      ALREF120,ALRECLID
          ENDIF
.
          MATCH     ALREF121,Z70
          IF        !@EQUAL
            MOVE      ALREF121,ALRECSTA
          ENDIF
.
          MATCH     ALREF122,Z70
          IF        !@EQUAL
            MOVE      ALREF122,ALRERREJ
          ENDIF
.
          MATCH     ALREF123,Z70
          IF        !@EQUAL
            MOVE      ALREF123,ALRECCOM
          ENDIF
.
          MATCH     ALREF124,Z70
          IF        !@EQUAL
            MOVE      ALREF124,ALRERTYP
          ENDIF
.
          MATCH     ALREF125,Z70
          IF        !@EQUAL
            MOVE      ALREF125,ALREREXP
          ENDIF
.
          MATCH     ALREF126,Z70
          IF        !@EQUAL
            MOVE      ALREF126,ALREMDAT
          ENDIF
.
          MATCH     ALREF127,Z70
          IF        !@EQUAL
            MOVE      ALREF127,ALREPRDT
          ENDIF
.
          MATCH     ALREF128,Z70
          IF        !@EQUAL
            MOVE      ALREF128,ALRESREJ
          ENDIF
.
          MATCH     ALREF129,Z70
          IF        !@EQUAL
            MOVE      ALREF129,ALRESRDT
          ENDIF
.
          MATCH     ALREF130,Z70
          IF        !@EQUAL
            MOVE      ALREF130,ALRESRTM
          ENDIF
.
          MATCH     ALREF131,Z70
          IF        !@EQUAL
            MOVE      ALREF131,ALRESRUI
          ENDIF
.
          MATCH     ALREF132,Z70
          IF        !@EQUAL
            MOVE      ALREF132,ALREUDT5
          ENDIF
.
          MATCH     ALREF133,Z70
          IF        !@EQUAL
            MOVE      ALREF133,ALREUTM5
          ENDIF
.
          MATCH     ALREF134,Z70
          IF        !@EQUAL
            MOVE      ALREF134,ALREUYN5
          ELSE
            MOVE      ZERO,ALREUYN5
          ENDIF
.
          MATCH     ALREF135,Z70
          IF        !@EQUAL
            MOVE      ALREF135,ALREUDID
          ENDIF
.
          MATCH     ALREF136,Z70
          IF        !@EQUAL
            MOVE      ALREF136,ALREUDT6
          ENDIF
.
          MATCH     ALREF137,Z70
          IF        !@EQUAL
            MOVE      ALREF137,ALREUTM6
          ENDIF
.
          MATCH     ALREF138,Z70
          IF        !@EQUAL
            MOVE      ALREF138,ALREUYN6
          ELSE
            MOVE      ZERO,ALREUYN6
          ENDIF
.
          MATCH     ALREF139,Z70
          IF        !@EQUAL
            MOVE      ALREF139,ALREREVD
          ENDIF
.
          MATCH     ALREF140,Z70
          IF        !@EQUAL
            MOVE      ALREF140,ALREPURC
          ENDIF
.
          MATCH     ALREF141,Z70
          IF        !@EQUAL
            MOVE      ALREF141,ALREOUTP
          ENDIF
.
          MATCH     ALREF142,Z70
          IF        !@EQUAL
            MOVE      ALREF142,ALRECONT
          ENDIF
.
          MATCH     ALREF143,Z70
          IF        !@EQUAL
            MOVE      ALREF143,ALRESCOR
          ENDIF
.
          MATCH     ALREF144,Z70
          IF        !@EQUAL
            MOVE      ALREF144,ALREMOHR
          ENDIF
.
          MATCH     ALREF145,Z70
          IF        !@EQUAL
            MOVE      ALREF145,ALREEVPR
          ENDIF
.
          MATCH     ALREF146,Z70
          IF        !@EQUAL
            MOVE      ALREF146,ALREDIAT
          ENDIF
.
          MATCH     ALREF147,Z70
          IF        !@EQUAL
            MOVE      ALREF147,ALREUYN7
          ELSE
            MOVE      ZERO,ALREUYN7
          ENDIF
.
          MATCH     ALREF148,Z70
          IF        !@EQUAL
            MOVE      ALREF148,ALREUYN8
          ELSE
            MOVE      ZERO,ALREUYN8
          ENDIF
.
          MATCH     ALREF149,Z70
          IF        !@EQUAL
            MOVE      ALREF149,ALREUYN9
          ELSE
            MOVE      ZERO,ALREUYN9
          ENDIF
.
          MATCH     ALREF150,Z70
          IF        !@EQUAL
            MOVE      ALREF150,ALREUCD1
          ENDIF
.
          MATCH     ALREF151,Z70
          IF        !@EQUAL
            MOVE      ALREF151,ALREUCD2
          ENDIF
.
          MATCH     ALREF152,Z70
          IF        !@EQUAL
            MOVE      ALREF152,ALREUCD3
          ENDIF
.
          MATCH     ALREF153,Z70
          IF        !@EQUAL
            MOVE      ALREF153,ALREORIG
          ENDIF
.
          MATCH     ALREF154,Z70
          IF        !@EQUAL
            MOVE      ALREF154,ALREYN10
          ENDIF
.
          MATCH     ALREF155,Z70
          IF        !@EQUAL
            MOVE      ALREF155,ALREYN11
          ENDIF
.
          MATCH     ALREF156,Z70
          IF        !@EQUAL
            MOVE      ALREF156,ALREYN12
          ENDIF
.
          MATCH     ALREF157,Z70
          IF        !@EQUAL
            MOVE      ALREF157,ALREUDT7
          ENDIF
.
          MATCH     ALREF158,Z70
          IF        !@EQUAL
            MOVE      ALREF158,ALREUTM7
          ENDIF
.
          MATCH     ALREF159,Z70
          IF        !@EQUAL
            MOVE      ALREF159,ALREUDT8
          ENDIF
.
          MATCH     ALREF160,Z70
          IF        !@EQUAL
            MOVE      ALREF160,ALREUTM8
          ENDIF
.
          MATCH     ALREF161,Z70
          IF        !@EQUAL
            MOVE      ALREF161,ALREUDT9
          ENDIF
.
          MATCH     ALREF162,Z70
          IF        !@EQUAL
            MOVE      ALREF162,ALREUTM9
          ENDIF
.
          MATCH     ALREF163,Z70
          IF        !@EQUAL
            MOVE      ALREF163,ALREEIOD
          ENDIF
.
          MATCH     ALREF164,Z70
          IF        !@EQUAL
            MOVE      ALREF164,ALREACDD
          ENDIF
.
          MATCH     ALREF165,Z70
          IF        !@EQUAL
            MOVE      ALREF165,ALREUD10
          ENDIF
.
          MATCH     ALREF166,Z70
          IF        !@EQUAL
            MOVE      ALREF166,ALREUHC5
          ENDIF
.
          MATCH     ALREF167,Z70
          IF        !@EQUAL
            MOVE      ALREF167,ALREUHC6
          ENDIF
.
          MATCH     ALREF168,Z70
          IF        !@EQUAL
            MOVE      ALREF168,ALRERRDT
          ENDIF
.
          MATCH     ALREF169,Z70
          IF        !@EQUAL
            MOVE      ALREF169,ALREDIA4
          ENDIF
.
          MATCH     ALREF170,Z70
          IF        !@EQUAL
            MOVE      ALREF170,ALREDIA5
          ENDIF
.
          MATCH     ALREF171,Z70
          IF        !@EQUAL
            MOVE      ALREF171,ALREPRC1
          ENDIF
.
          MATCH     ALREF172,Z70
          IF        !@EQUAL
            MOVE      ALREF172,ALREPRC2
          ENDIF
.
          MATCH     ALREF173,Z70
          IF        !@EQUAL
            MOVE      ALREF173,ALREPRC3
          ENDIF
.
          MATCH     ALREF174,Z70
          IF        !@EQUAL
            MOVE      ALREF174,ALREPRC4
          ENDIF
.
          MATCH     ALREF175,Z70
          IF        !@EQUAL
            MOVE      ALREF175,ALREPRC5
          ENDIF
.
          MATCH     ALREF176,Z70
          IF        !@EQUAL
            MOVE      ALREF176,ALREUD11
          ENDIF
.
          MATCH     ALREF177,Z70
          IF        !@EQUAL
            MOVE      ALREF177,ALREUT11
          ENDIF
.
          MATCH     ALREF178,Z70
          IF        !@EQUAL
            MOVE      ALREF178,ALREUD12
          ENDIF
.
          MATCH     ALREF179,Z70
          IF        !@EQUAL
            MOVE      ALREF179,ALREUT12
          ENDIF
.
          MATCH     ALREF180,Z70
          IF        !@EQUAL
            MOVE      ALREF180,ALREUD13
          ENDIF
.
          MATCH     ALREF181,Z70
          IF        !@EQUAL
            MOVE      ALREF181,ALREUT13
          ENDIF
.
          MATCH     ALREF182,Z70
          IF        !@EQUAL
            MOVE      ALREF182,ALREUD14
          ENDIF
.
          MATCH     ALREF183,Z70
          IF        !@EQUAL
            MOVE      ALREF183,ALREUT14
          ENDIF
.
          MATCH     ALREF184,Z70
          IF        !@EQUAL
            MOVE      ALREF184,ALREUD15
          ENDIF
.
          MATCH     ALREF185,Z70
          IF        !@EQUAL
            MOVE      ALREF185,ALREUT15
          ENDIF
.
          MATCH     ALREF186,Z70
          IF        !@EQUAL
            MOVE      ALREF186,ALRETRGS
          ENDIF
.
          MATCH     ALREF187,Z70
          IF        !@EQUAL
            MOVE      ALREF187,ALRETRGD
          ENDIF
.
          MATCH     ALREF188,Z70
          IF        !@EQUAL
            MOVE      ALREF188,ALREBKOV
          ENDIF
.
          MATCH     ALREF189,Z70
          IF        !@EQUAL
            MOVE      ALREF189,ALREBKPR
          ENDIF
.
          MATCH     ALREF190,Z70
          IF        !@EQUAL
            MOVE      ALREF190,ALREBKPM
          ENDIF
.
          MATCH     ALREF191,Z70
          IF        !@EQUAL
            MOVE      ALREF191,ALREBKBA
          ENDIF
.
          MATCH     ALREF192,Z70
          IF        !@EQUAL
            SQUEEZE   ALREF192
            IF        @EOS
              MOVE      SP70,ALREFTSC
            ELSE
              MOVE      ZERO,F3               * Store as a number
              MOVE      ALREF192,F3
              MOVE      F3,ALREFTSC
            ENDIF
          ENDIF
.
          MATCH     ALREF193,Z70
          IF        !@EQUAL
            MOVE      ALREF193,ALRESSUB
          ENDIF
.
MVALRE99  RETURN
.
STAEQU00  MATCH     "0",ALRESTAT
          GOTO      STAEQU01 IF NOT EQUAL
          MOVE      "Waiting",REFSTAT
          GOTO      STAEQU99
STAEQU01  MATCH     "1",ALRESTAT
          GOTO      STAEQU02 IF NOT EQUAL
          MOVE      "Active",REFSTAT
          GOTO      STAEQU99
STAEQU02  MATCH     "2",ALRESTAT
          GOTO      STAEQU03 IF NOT EQUAL
          MOVE      "Closed",REFSTAT
          GOTO      STAEQU99
STAEQU03  MATCH     "3",ALRESTAT
          GOTO      STAEQU04 IF NOT EQUAL
          MOVE      "Inactive",REFSTAT
          GOTO      STAEQU99
STAEQU04  MATCH     "4",ALRESTAT
          GOTO      STAEQU05 IF NOT EQUAL
          MOVE      "Cancelled",REFSTAT
          GOTO      STAEQU99
STAEQU05  MATCH     "5",ALRESTAT
          GOTO      STAEQU99 IF NOT EQUAL
          MOVE      "Rejected",REFSTAT
          GOTO      STAEQU99
.
STAEQU99  RETURN
.------------------------------------------------------------
. Output Allied Health Diagnosis 
.   - Input ALLRFDIA as Diagnosis Code
.   - Output based on tag parameter
.     0-Description, 1-Code, 2-Select Options
.------------------------------------------------------------
ALLDIA00  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALLDIA10,ALLDIA20
          PACK      KEY12,ALREDEPT,ALLRFDIA
          CALL      RDALDIA1
          BRANCH    OVRCD,ALLDIA99
          WRITE     HTMLFILE;ALDIDESC;
          GOTO      ALLDIA99
.
ALLDIA10  STRIP     ALLRFDIA
          WRITE     HTMLFILE;*+,ALLRFDIA;
          GOTO      ALLDIA99
.
ALLDIA20  PACK      KEY12,ALREDEPT,ALLRFDIA,SP70
          CALL      RDALDIA1
          BRANCH    OVRCD,ALLDIA25
.
          MATCH     "1",ALDIACTV            * Display InActive codes from file
          IF        !@EQUAL
            WRITE     HTMLFILE;"<option value=#"",ALDIDIAG,"#" selected>":
                                   ALDIDESC,"</option>"
          ENDIF
.
ALLDIA25  PACK      KEY92,ALREDEPT,SP70
          CALL      RSALDIA2                * positional read
ALLDIA30  CALL      RKALDIA2                * read a record
          BRANCH    OVRCD,ALLDIA99
          MATCH     ALREDEPT,ALDIDEPT
          GOTO      ALLDIA99 IF NOT EQUAL
.
          MATCH     "1",ALDIACTV            * Only display active codes
          GOTO      ALLDIA30 IF NOT EQUAL
.
          MATCH     ALLRFDIA,ALDIDIAG
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",ALDIDIAG,"#" selected>":
                                 ALDIDESC,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",ALDIDIAG,"#">":
                                 ALDIDESC,"</option>"
          ENDIF
          GOTO      ALLDIA30         
.
ALLDIA99  RETURN 
.
.------------------------------------------------------------
. Output Allied Health Problem
.   - Input ALLRFPRB as Problem Code
.   - Output based on tag parameter
.     0-Description, 1-Code, 2-Select Options
.------------------------------------------------------------
ALLPRB00  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALLPRB10,ALLPRB20
          PACK      KEY12,ALREDEPT,ALLRFPRB
          CALL      RDALPRR1
          BRANCH    OVRCD,ALLPRB99
          WRITE     HTMLFILE;ALPRDESC;
          GOTO      ALLPRB99
.
ALLPRB10  STRIP     ALLRFPRB
          WRITE     HTMLFILE;*+,ALLRFPRB;
          GOTO      ALLPRB99
.
ALLPRB20  PACK      KEY12,ALREDEPT,ALLRFPRB,SP70
          CALL      RDALPRR1
          BRANCH    OVRCD,ALLPRB25
.
          MATCH     "1",ALPRACTV            * display InActive codes from file
          IF        !@EQUAL
            WRITE     HTMLFILE;"<option value=#"",ALPRPROB,"#" selected>":
                                 ALPRDESC,"</option>"
          ENDIF
.
ALLPRB25  PACK      KEY52,ALREDEPT,SP70
          CALL      RSALPRR2                * positional read
ALLPRB30  CALL      RKALPRR2                * read a record
          BRANCH    OVRCD,ALLPRB99
.
          MATCH     ALPRDEPT,ALREDEPT
          GOTO      ALLPRB99 IF NOT EQUAL
.
          MATCH     "1",ALPRACTV            * Only display active codes
          GOTO      ALLPRB30 IF NOT EQUAL
.
          MATCH     ALPRPROB,ALLRFPRB
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",ALPRPROB,"#" selected>":
                                 ALPRDESC,"</option>"
          ELSE  
            MATCH     "2",ALPROTHR          * Don't display other factors
            GOTO      ALLPRB30 IF EQUAL
.
            WRITE     HTMLFILE;"<option value=#"",ALPRPROB,"#">":
                                 ALPRDESC,"</option>"
          ENDIF
          GOTO      ALLPRB30
ALLPRB99  RETURN
.
.------------------------------------------------------------
. Output Allied Health Problem Add Screen
.------------------------------------------------------------
ALLPRA00  MOVE      SP70,DIM1
.
          PACK      KEY52,DEPTCODE,SP70
          CALL      RSALPRR2                * positional read
ALLPRA10  CALL      RKALPRR2                * read a record
          BRANCH    OVRCD,ALLPRA99
.
          MATCH     ALPRDEPT,DEPTCODE
          GOTO      ALLPRA99 IF NOT EQUAL
.
          MATCH     "1",ALPRACTV            * Only display active codes
          GOTO      ALLPRA10 IF NOT EQUAL
.
          MATCH     "2",ALPROTHR          * Don't display other factors
          GOTO      ALLPRA10 IF EQUAL
.
          MATCH     "1",DIM1
          IF        !@EQUAL
            MATCH     "1",ALPRDFCD
            IF        @EQUAL
              MOVE      "1",DIM1
              WRITE     HTMLFILE;"<option value=#"",ALPRPROB,"#" selected>":
                                   ALPRDESC,"</option>"
            ELSE
              WRITE     HTMLFILE;"<option value=#"",ALPRPROB,"#">":
                                   ALPRDESC,"</option>"
            ENDIF
          ELSE
            WRITE     HTMLFILE;"<option value=#"",ALPRPROB,"#">":
                                 ALPRDESC,"</option>"
          ENDIF
.
          GOTO      ALLPRA10
.
ALLPRA99  RETURN
.
.------------------------------------------------------------
. Clinic Option List
.------------------------------------------------------------
SLSITE00  PACK      KEY36,SP70
          CALL      RDSSITA2
SLSITE10  CALL      RDKSITA2
          BRANCH    OVRCD,SLSITE99
         
          MATCH     SITECODE,OSTSITE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",OSTSITE,"#" selected>":
                               OSTDESC,"</option>"
          ELSE

.           Checks to see if site is active, and skips it if it isn't
            MATCH     "1",OTSTACTV
            GOTO      SLSITE10 IF EQUAL
.
            PACK      KEY16,USERID,SP70
            CALL      RDMLSIT1                   * Check OP Site security
            IF        OVRCD=1
              PACK      KEY16,USERID,OSTSITE,SP70
              CALL      RDMLSIT1
              BRANCH    OVRCD,SLSITE10
            ENDIF
.
            WRITE     HTMLFILE;"<option value=#"",OSTSITE,"#">":
                               OSTDESC,"</option>"
          ENDIF
          GOTO      SLSITE10
.
SLSITE99  RETURN
.
.
.------------------------------------------------------------
. Add Visit Type Selection Options to Form
.------------------------------------------------------------
RFVSEL00  MOVE      SP70,TDESC
          PACK      KEY5,CATEGORY,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      CATEGORY,TCODE
            MOVE      "Invalid Category",TDESC
          ENDIF
          REP       " _",TCODE
          REP       " _",THCSCOD
          WRITE     HTMLFILE;"<!--<cat-c category=#"",TCODE,"#" name=#"",TDESC:
                             "#" map=#"",THCSCOD,"#"></cat-c>-->"
.
          PACK      PTCDKEY2,CATEGORY,SP70
          CALL      RDSCODE2
RFVSEL10  CALL      RDKCODE2
          BRANCH    OVRCD,RFVSEL99
          MATCH     CATEGORY,TCODE
          GOTO      RFVSEL99 IF NOT EQUAL
          MATCH     SP70,ACODE
          GOTO      RFVSEL10 IF EQUAL
          MATCH     "I",PTCOACTV
          GOTO      RFVSEL10 IF EQUAL
          PACK      KEY15,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,THCSCOD
.
          MATCH     "U",TCINDC6           * Skip unavailabl
          GOTO      RFVSEL10 IF EQUAL
.
          PACK      KEY20,QUOTE,ACODE,KEY15,QUOTE
          MATCH     CODE,ACODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY20," selected>":
                               TDESC,"</option>"
          ELSE
.           Checks if option is active, and skips if it isn't
            MATCH     "1",PTCOACTV
            GOTO      RFVSEL10 IF EQUAL
.
            WRITE     HTMLFILE;"<option value=",KEY20,">",TDESC,"</option>"
          ENDIF
          GOTO      RFVSEL10
.
RFVSEL99  RETURN
.
.------------------------------------------------------------
. Referral Hospital Selection List
.------------------------------------------------------------
RHSL0000  PACK      KEY3,SP70
          CALL      RSPTHSP1
RHSL1000  CALL      RKPTHSP1
          BRANCH    OVRCD,RHSL9999
.
          MOVE      PTHSNAME,KEY50
          PACK      KEY5,QUOTE,PTHSHOSP,QUOTE
          MATCH     ALREHOSN,PTHSHOSP
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY5," selected>":
                               KEY50,"</option>"
          ELSE
            IF        IBCNMHOS=1
              PACK      KEY13,USERID,SP70                * All hospital access
              CALL      RDMLSEC1
              IF        OVRCD=1
                PACK      KEY13,USERID,PTHSHOSP,SP70     * This hospital access
                CALL      RDMLSEC1
                BRANCH    OVRCD,RHSL1000
              ENDIF
            ENDIF
            WRITE     HTMLFILE;"<option value=",KEY5,">",KEY50,"</option>"
          ENDIF
          GOTO      RHSL1000
.
RHSL9999  RETURN
.
.------------------------------------------------------------
. Output Allied Health Procedures
.   - Input KEY9 as Procedure Code
.   - Output based on tag parameter
.     0-Description, 1-Code, 2-Select Options
.------------------------------------------------------------
ALLPRO00  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,ALLPRO10,ALLPRO20
          PACK      KEY12,ALREDEPT,KEY9
          CALL      RDALPRO1
          BRANCH    OVRCD,ALLPRO99
.
          WRITE     HTMLFILE;ALPODESC;
          GOTO      ALLPRO99
.
ALLPRO10  STRIP     KEY9
          WRITE     HTMLFILE;*+,KEY9;
          GOTO      ALLPRO99
.
ALLPRO20  PACK      KEY12,ALREDEPT,KEY9,SP70
          CALL      RDALPRO1
          BRANCH    OVRCD,ALLPRO25
.
          MATCH     "1",ALPOACTV            * Display InActive codes from file
          IF        !@EQUAL
            WRITE     HTMLFILE;"<option value=#"",ALPOPROC,"#" selected>":
                                   ALPODESC,"</option>"
          ENDIF
.
ALLPRO25  PACK      KEY62,ALREDEPT,SP70
          CALL      RSALPRO2                * positional read
ALLPRO30  CALL      RKALPRO2                * read a record
          BRANCH    OVRCD,ALLPRO99
          MATCH     ALREDEPT,ALPODEPT
          GOTO      ALLPRO99 IF NOT EQUAL
.
          MATCH     "1",ALPOACTV            * Only display active codes
          GOTO      ALLPRO30 IF NOT EQUAL
.
          MATCH     KEY9,ALPOPROC
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",ALPOPROC,"#" selected>":
                                 ALPODESC,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",ALPOPROC,"#">":
                                 ALPODESC,"</option>"
          ENDIF
          GOTO      ALLPRO30
.
ALLPRO99  RETURN
.
.---------------------------------------------------------------------------
. Procedure: SRSUBSEL - returns service subtype selection list
. Requires :
.   INALDEPT - Department Code
.   INALCONT - Contract Code
.---------------------------------------------------------------------------
.
          DEFPROC   SRSUBSEL
.
          INC       ALLCCTFD/INC
.
FRSTREAD  FORM      1
CATZX     INIT      "ZX"
.
SRSBS000  OPEN      ALLCCTA1,"allcctaf"
.
          MOVE      ONE,FRSTREAD
          PACK      KEY8,INALDEPT,CATZX,SP70
          CALL      RSALCCT1
SRSBS200  CALL      RKALCCT1
          BRANCH    OVRCD,SRSBS900
.
          MATCH     INALDEPT,ALCCDEPT
          GOTO      SRSBS900 IF NOT EQUAL
.
          MATCH     CATZX,ALCCTYPE
          GOTO      SRSBS900 IF NOT EQUAL
.
          PACK      KEY5,CATZX,ALCCCONT,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,SRSBS200
.
          MATCH     "A",PTCOACTV
          GOTO      SRSBS200 IF NOT EQUAL
.
          MATCH     SP70,INALCONT
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",ALCCCONT,"#">":
                                 TDESC,"</option>"
          ELSE
            MATCH     INALCONT,ALCCCONT
            IF        @EQUAL
              WRITE     HTMLFILE;"<option value=#"",ALCCCONT,"#" selected>":
                                 TDESC,"</option>"
            ELSE
              WRITE     HTMLFILE;"<option value=#"",ALCCCONT,"#">": 
                                 TDESC,"</option>"
            ENDIF
          ENDIF
.
          MOVE      ZERO,FRSTREAD
.
          GOTO      SRSBS200
.
SRSBS900  CLOSE     ALLCCTA1
          IF        FRSTREAD = ONE
            MOVE      CATZX,CATEGORY
            MOVE      ALRECONT,CODE
            CALL      CODSEL00
          ENDIF 
.
SRSBS910  GOTO      SRSBS999                   * end procedure
.
.         I/O Routines
.
          INC       ALLCCTIO/INC
          INC       IBAOVRIO/INC
.
SRSBS999  ENDPROC
.
