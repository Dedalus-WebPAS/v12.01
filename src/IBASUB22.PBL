.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.01.00"
.-------------------------------------------------------
. V9.11.01 07/01/2009 Steve Armstrong  CAR 185927
.          Extended length of CMDLINE from 127 to 140.
.          Recompiled for changes to SINALLCD.
.-------------------------------------------------------
. V9.04.01 08.04.2005 Peter Vela CAR 59696
.          Changed commodity group from DIM 5 to DIM 6
.         V9.03.02  23/04/2004  Henry Son        CAR 49199
.                   Fix Wrong report description.
. V9.03.01  10.11.2003  Mike Laming  CAR 44233
.           Add Preferred Supplier Code and Name to Export file
. V9.02.01  10.07.2002  Glenn Saunders
.           Recompile for changes in CALCUSAG.
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B02 30.01.2001 Charles Handaya
.           Recompiled for CALCUSAG fix of Cost Amount inc. or excld. GST
. VF.09.B01 09.11.2000 Charles Handaya
.           Recompiled for CALCUSAG sincchaf changes
.           Modification of Warehouse Security
.-------------------------------------------------------
. VF.00.03  19.01.2000 Charles Handaya
.           Fix Print Heading
.           srf 637274
. VF.00.02  29.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.01  03.11.1999 Sandra Barcham
.           Change locked message to use X
.-------------------------------------------------------
CHECKCAT  DIM       7
CHECKCST  DIM       5
CHECKDAT  DIM       6
CHECKSUB  DIM       5
CHCKCOMM  DIM       6                                                  *C-59696
CHKDIM7   DIM       7
CMDLINE   DIM       140
DIM14CHK  DIM       1
REPTDESC  DIM       27
REPTSTKF  FORM      1
RNGEWARE  FORM      1
NONDESC   INIT      " - Non-Stock Catalogs Only"
STKDESC   INIT      " - Stock Catalogs Only"
PRINTCST  DIM       7
.
INCLTYPE  FORM      1
.
FIRSTHRU  FORM      1
F13TOT1   DIM       13
F13TOT2   DIM       13
F13TOT3   DIM       13
F13TOT4   DIM       13
F10TOT1   DIM       10
F10TOT2   DIM       10
F5TOT1    DIM       5
F5TOT2    DIM       5
F12P1     FORM      12.1
.
CURACT    FORM      12.2
CURBUD    FORM      12.2
CURQTY    FORM      12.2
.
KEY9CHK   DIM       9
KEY14CHK  DIM       14
KEY16CHK  DIM       16
.
YTDACT    FORM      12.2
YTDBUD    FORM      12.2
YTDQTY    FORM      12.2
TCURACT   FORM      12.2
TCURBUD   FORM      12.2
TYTDACT   FORM      12.2
TYTDBUD   FORM      12.2
GCURACT   FORM      12.2
GCURBUD   FORM      12.2
GYTDACT   FORM      12.2
GYTDBUD   FORM      12.2
.
EXPORTFL  FILE      ASCII, FIXED=400
TABDELM   EQU       0x09
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASUB22
.   Function      :   Cost Centre Stock Usage Report          
.   Generated  On :   08/01/2009
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSIMSFD/INC
          INC       APSINPFD/INC
          INC       APSMASFD/INC
          INC       SINALLFD/INC
          INC       SINCCAFD/INC
          INC       SINCCBFD/INC
          INC       SINCCEFD/INC
          INC       SINCCFFD/INC
          INC       SINCCHFD/INC
          INC       SINCGAFD/INC
          INC       SINCIAFD/INC
          INC       SINCIEFD/INC
          INC       SINCONFD/INC
          INC       SINFACFD/INC
          INC       SINNATFD/INC
          INC       SINPERFD/INC
          INC       SINPOAFD/INC
          INC       SINPOCFD/INC
          INC       SINPOFFD/INC
          INC       SINSUAFD/INC
          INC       SINTMPDF/INC
          INC       SINWARFD/INC
          INC       SINWSEFD/INC
.=========================
.Local Variable Definition
.-------------------------
REPTSTCK  DIM       1 * Scr 00 Fld     4
FROMCOST  DIM      46 * Scr 00 Fld     5
TOCOST    DIM      46 * Scr 00 Fld     6
FROMWAR   DIM      46 * Scr 00 Fld     7
TOWAR     DIM      46 * Scr 00 Fld     8
USYEAR    DIM       4 * Scr 00 Fld    10
USPERD    DIM       2 * Scr 00 Fld    11
REPTTYPE  FORM      1 * Scr 00 Fld    12
RTYPDESC  DIM      35 * Scr 00 Fld    13
EXPORTYN  FORM      1 * Scr 00 Fld    14
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASUB22"
PRGNAM    INIT      "Cost Centre Stock Usage Report          "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      ONAT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   51",AUDTSECT
          MOVE      " 48",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening apsaudma";
            OPEN      APSAUDMA,"apsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA1,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA2,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinccbaf";
          OPEN      SINCCBA1,"sinccbaf"
          DISPLAY   *P56:24,"Opening sincceaf";
          OPEN      SINCCEA1,"sincceaf"
          DISPLAY   *P56:24,"Opening sincceaf";
          OPEN      SINCCEA2,"sincceaf"
          DISPLAY   *P56:24,"Opening sinccfaf";
          OPEN      SINCCFA1,"sinccfaf"
          DISPLAY   *P56:24,"Opening sinccfaf";
          OPEN      SINCCFA2,"sinccfaf"
          DISPLAY   *P56:24,"Opening sincchaf";
          OPEN      SINCCHA1,"sincchaf"
          DISPLAY   *P56:24,"Opening sincchaf";
          OPEN      SINCCHA2,"sincchaf"
          DISPLAY   *P56:24,"Opening sincchaf";
          OPEN      SINCCHA3,"sincchaf"
          DISPLAY   *P56:24,"Opening sincchaf";
          OPEN      SINCCHA4,"sincchaf"
          DISPLAY   *P56:24,"Opening sincchaf";
          OPEN      SINCCHA5,"sincchaf"
          DISPLAY   *P56:24,"Opening sincgaaf";
          OPEN      SINCGAA1,"sincgaaf"
          DISPLAY   *P56:24,"Opening sincgaaf";
          OPEN      SINCGAA2,"sincgaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA2,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA3,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA1,"sincieaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA2,"sincieaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA1,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA2,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA1,"sinperaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA2,"sinperaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA1,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA2,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA3,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA4,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA1,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA2,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA3,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA4,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA5,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA6,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA7,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA1,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA2,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA3,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA2,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA3,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA2,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA1,"sinwseaf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA2,"sinwseaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Program Options                    
          ENDIF
          RETURN
.--------------------------------
. Screen - Program Options                    
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      MVACCEPT
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Program Options                    
.-------------------------------------------------------
CF00L000  COMPARE   ZERO,ACCEPT
              GOTO      CF00L999 IF EQUAL
          MOVE      SP70,REPTSTCK
          MOVE      SP70,FROMCOST
          MOVE      SP70,TOCOST  
          MOVE      SP70,FROMWAR 
          MOVE      SP70,TOWAR   
          MOVE      SP70,USYEAR  
          MOVE      SP70,USPERD  
          MOVE      ZERO,REPTTYPE
          MOVE      SP70,RTYPDESC
          MOVE      ZERO,EXPORTYN
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Program Options                    
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Program Options                    
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Program Options                    
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Program Options                    
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Program Options                    
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L101:
                            PS00L102,PS00L103,PS00L104,PS00L105:
                            PS00L999,PS00L106,PS00L107,PS00L108:
                            PS00L109,PS00L110
          GOTO     PS00L999
.
PS00L101
          MOVE      REPTSTCK,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      FROMCOST,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      TOCOST,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      FROMWAR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      TOWAR,VAR        
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      USYEAR,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      USPERD,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      REPTTYPE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      RTYPDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      EXPORTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Program Options                    
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L006,SF00L105,SF00L006:
                            SF00L006,SF00L106,SF00L107,SF00L108:
                            SF00L006,SF00L109
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L103:
                            SF00L104,SF00L020,SF00L105,SF00L020:
                            SF00L020,SF00L106,SF00L107,SF00L108:
                            SF00L020,SF00L109
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNTA000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESTCK000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L103
            ENDIF
            BRANCH    EXIT,SF00L103,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      REPTSTCK,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCOST  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
            BRANCH    EXIT,SF00L104,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMCOST,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCOST,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L105
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOWAR   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EWAR0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L105
            ENDIF
            BRANCH    EXIT,SF00L105,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMWAR,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOWAR,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KYEAR000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L106
            ENDIF
            BRANCH    EXIT,SF00L106,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      USYEAR,VAR       
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPERD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
            BRANCH    EXIT,SF00L107,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      USPERD,VAR       
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L108
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,RTYPDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "1",CKEYTYP
          CALL      ERTYP000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L108
            ENDIF
            BRANCH    EXIT,SF00L108,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      REPTTYPE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      RTYPDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L109
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,EXPORTYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      EXPORTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
.----------------------------------------
. Move one to accept to for insert mode
.----------------------------------------
MVACCEPT  MOVE      ONE,ACCEPT
          RETURN
.********************************************************************
.  Print Report
.********************************************************************
PRNTA000  PACK      DISPMSG,SP70,SP70            * save line 24
          CALL      MESSAGE2
          MOVE      SP70,FPRODGP
          MOVE      Z70,TPRODGP
          MOVE      SP70,FDESCRP
          MOVE      Z70,TDESCRP
          MOVE      SP70,FCATALOG
          MOVE      Z70,TCATALOG
          MOVE      SP70,SIWAWAR
          PACK      DAT6,USYEAR,USPERD,SP70
          UNPACK    DAT6,SIPEYEAR,SIPEPER
          ASSIGN    (2-REPTSTKF),INCLTYPE
.
          MOVE      "   63",AUDTSECT
          MOVE      "143",AUDTPOST
. ------- HNONUSAG   1-Receival 2-Purchase
          OPEN      CONTROLF,"controlf"
          READ      CONTROLF,TWENTY3;*95,HACCNT,*124,HORDDES
          READ      CONTROLF,SIXTY3;*143,HNONUSAG
.
          CALL      LOAD0000
.
          IF        EXPORTYN=1
            CALL      MAKEXP00
          ENDIF
.
          DISPLAY   *P1:24,*EL,"Printing :   ";
          MOVE      ZERO,CPAGENO                 * reset page no.
          CLOCK     TIME,CTIMEIS                 * get current time
          MOVE      "999",CLNO                   * init last line number
.
          PERFORM   REPTTYPE,WRIA0000,WRIB0000,WRIC0000,WRID0000
.
          COMPARE   ZERO,CPAGENO                 * print header if
          CALL      HEAD0000 IF EQUAL            * nothing printed
          CALL      PRTOT000
.
PRNTA900  MOVE      ZERO,EXIT                    * exit screen
          GOTO      PRNTA999
.
PRNTA950  MOVE      ONE,EXIT                     * continue
.
PRNTA999  CALL      MESSAGE3                     * restore line 24
          CALL      KLALL000
          IF        EXPORTYN=1
            CALL      TRAN0000
          ENDIF
          RETURN
.------------------------------------------------------------
. Print Catalog Analysis (Full Report)
.------------------------------------------------------------
WRIA0000  MOVE      TRUE,FIRSTHRU
          MOVE      ZERO,TCURACT
          MOVE      ZERO,TYTDACT
          MOVE      ZERO,CURACT
          MOVE      ZERO,CURQTY
          MOVE      ZERO,YTDACT
          MOVE      ZERO,YTDQTY
          MOVE      SP70,CHECKCST
          PACK      KEY28,FCOST,FCATALOG,SIPEYEAR,SP70
          CALL      RSSIAL3
WRIA1000  CALL      RKSIAL3
          BRANCH    OVRCD,WRIA9000
.
. ------- First Time Thru Set Check Var and Reset Firsthru var
          IF        FIRSTHRU=TRUE
            MOVE      SIALCST,CHECKCST
            MOVE      SIALCAT,CHECKCAT
            MOVE      CHECKCST,PRINTCST
            MOVE      FALSE,FIRSTHRU
          ENDIF
.
.
. ------- Has it Changed Cost Centres
          MATCH     SIALCST,CHECKCST    * Changed Cost Centres
          IF        !@EQUAL
            CALL      ASUB0000
            CALL      ATOT0000
            MOVE      "600",CLNO
            GOTO      WRIA2000
          ENDIF
.
. ------- Past the keyed in Usage Period
          MATCH     SIALCAT,CHECKCAT  * Past the Period - New Total
          IF        !@EQUAL
            CALL      ASUB0000
            GOTO      WRIA2000
          ENDIF
.
. ------- Has the Catalog Changed or is it past the Usage date
          MATCH     SIALDAT,DAT6
          IF        @LESS
            CALL      ASUB0000
            GOTO      WRIA2000
          ENDIF
.
. ------- Update the Actual and Year to Date Figures
WRIA2000  ADD       SIALUAM,YTDACT
          ADD       SIALUQT,YTDQTY
.
          MATCH     DAT6,SIALDAT
          GOTO      WRIA1000 IF NOT EQUAL
          ADD       SIALUAM,CURACT
          ADD       SIALUQT,CURQTY
          GOTO      WRIA1000
.
WRIA9000  IF        FIRSTHRU=0
            CALL      ASUB0000
            CALL      ATOT0000
          ENDIF
.
WRIA9999  RETURN
.--------------------------------------------------------------------
. Print Sub-Totals if Not Zero
.--------------------------------------------------------------------
ASUB0000  IF        ((YTDACT=0)&(YTDQTY=0)&(CURACT=0)&(CURQTY=0))
            GOTO      ASUB9999
          ENDIF
.
          COMPARE   "53",CLNO                    * end of page ?
          CALL      HEAD0000 IF NOT LESS         * start new page
.
          MOVE      "99,999,999.99",F13TOT1
          MOVE      "99,999,999.99",F13TOT2
          MOVE      "999,999.99",F10TOT1
          MOVE      "999,999.99",F10TOT2
          FEDIT     CURACT,F13TOT1
          FEDIT     CURQTY,F10TOT1
          FEDIT     YTDACT,F13TOT2
          FEDIT     YTDQTY,F10TOT2
.
          MATCH     CHECKCAT,SP70
          IF        @EQUAL
            CALL      SNON0000
          ELSE
            PACK      KEY7,CHECKCAT,SP70
            CALL      RDSIIA1
          ENDIF
          MOVE      SIIADES,KEY54
          MATCH     SIIACAT,SP20
.
          PRINT     "| ",SIIACAT,SP1,KEY54,"| ",SIIAISS,"|":
                    F10TOT1,F13TOT1," |":
                    F10TOT2,F13TOT2," |"
          IF        EXPORTYN=1
.* ****************************************** Start of Addition        *I-f1101
            IF REPTTYPE = 1
              MOVE      SP70,APMASN1            * get preferred supplier name
              MOVE      SP70,APMASN2
              PACK      KEY5,SIIAPSC,SP70
              CALL      RDAPMA1
              STRIP     APMASN1
              PACK      KEY54,APMASN1,SP1,APMASN2,SP70
            ENDIF
.* ****************************************** End of Addition          *I-f1101
            CALL      WREXPT00
            MOVE      SP70,KEY54                                       *I-f1101
          ENDIF
.
          ADD       "1",CLNO           * add one to line number
          ADD       CURACT,TCURACT
          ADD       YTDACT,TYTDACT
          MOVE      ZERO,CURACT
          MOVE      ZERO,YTDACT
          MOVE      ZERO,CURQTY
          MOVE      ZERO,YTDQTY
          MOVE      SIALCST,CHECKCST
          MOVE      SIALCAT,CHECKCAT
          MOVE      SIALDAT,CHECKDAT
.
ASUB9999  RETURN
.--------------------------------------------------------------------
. Print Totals if Not Zero
.--------------------------------------------------------------------
ATOT0000  MOVE      "99,999,999.99",F13TOT1
          MOVE      "99,999,999.99",F13TOT2
          MOVE      "          ",F10TOT1
          MOVE      "          ",F10TOT2
          FEDIT     TCURACT,F13TOT1
          FEDIT     TYTDACT,F13TOT2
.
          CALL      UND132
          PRINT     "| Cost Centre Total",*65,"|",*82,"|":
                    F10TOT1,F13TOT1," |":
                    F10TOT2,F13TOT2," |"
.
          ADD       "1",CLNO           * add one to line number
          ADD       TCURACT,GCURACT
          ADD       TYTDACT,GYTDACT
          MOVE      ZERO,TCURACT
          MOVE      ZERO,TYTDACT
.
ATOT9999  RETURN
.------------------------------------------------------------
. Print Product Group Totals
.------------------------------------------------------------
WRIB0000  MOVE      TRUE,FIRSTHRU
          MOVE      ZERO,TCURACT
          MOVE      ZERO,TYTDACT
          MOVE      ZERO,TCURBUD
          MOVE      ZERO,TYTDBUD
          MOVE      ZERO,CURACT
          MOVE      ZERO,CURBUD
          MOVE      ZERO,YTDACT
          MOVE      ZERO,YTDBUD
          MOVE      SP70,CHECKCST
          PACK      KEY28,FCOST,FPRODGP,SIPEYEAR,SP70
          CALL      RSSIAL2
WRIB1000  CALL      RKSIAL2
          IF        OVRCD=1
            CALL      BSUB0000
            CALL      BTOT0000
            GOTO      WRIB9999
          ENDIF
.
. ------- First Time Thru Set Check Var and Reset Firsthru var
          IF        FIRSTHRU=TRUE
            MOVE      SIALCST,CHECKCST
            MOVE      SIALCAT,CHECKCAT
            MOVE      SIALDAT,CHECKDAT
            MOVE      SIALSUB,CHECKSUB
            MOVE      FALSE,FIRSTHRU
          ENDIF
.
.
. ------- Has it Changed Cost Centres
          MATCH     SIALCST,CHECKCST    * Changed Cost Centres
          IF        !@EQUAL
            CALL      GBUD0000        * Get Budget Figures
            CALL      BSUB0000
            CALL      BTOT0000
            MOVE      "600",CLNO
            GOTO      WRIB2000
          ENDIF
.
. ------- Past the keyed in Usage Period
          MATCH     SIALSUB,CHECKSUB  * Past the Period - New Total
          IF        !@EQUAL
            CALL      GBUD0000        * Get Budget Figures
            CALL      BSUB0000
            GOTO      WRIB2000
          ENDIF
.
. ------- Has the Catalog Changed or is it past the Usage date
          MATCH     SIALDAT,DAT6
          IF        @LESS
            CALL      GBUD0000        * Get Budget Figures
            CALL      BSUB0000
            GOTO      WRIB2000
          ENDIF
.
. ------- Update the Actual and Year to Date Figures
WRIB2000  ADD       SIALUAM,YTDACT
.
          MATCH     DAT6,SIALDAT
          GOTO      WRIB1000 IF NOT EQUAL
          ADD       SIALUAM,CURACT
          GOTO      WRIB1000
.
WRIB9999  RETURN
.------------------------------------------------------------
. Get Budget Data for this Cost Centre & Subjective
.------------------------------------------------------------
GBUD0000  PACK      KEY16,CHECKCST,CHECKSUB,USYEAR,SP70
          PACK      KEY14,CHECKCST,CHECKSUB,USYEAR,SP70
          CALL      RSSICF2
GBUD1000  CALL      RKSICF2
          BRANCH    OVRCD,GBUD9999
.
          PACK      KEY16,SICFCST,SICFSUB,SICFDAT
          MATCH     KEY14,KEY16
          GOTO      GBUD9999 IF NOT EQUAL
.
          MATCH     SICFDAT,DAT6
          GOTO      GBUD9999 IF LESS
.
          ADD       SICFBUD,YTDBUD
          MATCH     DAT6,SICFDAT
          GOTO      GBUD1000 IF NOT EQUAL
          MOVE      SICFBUD,CURBUD
.
GBUD9999  RETURN
.------------------------------------------------------------
. Print Sub-Totals if Not Zero for Subjectives
.------------------------------------------------------------
BSUB0000  IF        ((YTDACT=0)&(YTDBUD=0)&(CURACT=0)&(CURBUD=0))
            GOTO      BSUB9999
          ENDIF
.
          COMPARE   "53",CLNO                    * end of page ?
          CALL      HEAD0000 IF NOT LESS         * start new page
.
          MOVE      "99,999,999.99",F13TOT1
          MOVE      "99,999,999.99",F13TOT2
          MOVE      "99,999,999.99",F13TOT3
          MOVE      "99,999,999.99",F13TOT4
          MOVE      "999,999.99",F10TOT1
          MOVE      "999,999.99",F10TOT2
          MOVE      "999.9",F5TOT1
          MOVE      "999.9",F5TOT2
          FEDIT     CURACT,F13TOT1
          FEDIT     CURBUD,F13TOT2
          ASSIGN    CURACT-CURBUD,F12P2
          FEDIT     F12P2,F10TOT1
          ASSIGN    ((CURACT-CURBUD)/CURBUD)*100.0,F12P1
          FEDIT     F12P1,F5TOT1

          FEDIT     YTDACT,F13TOT3
          FEDIT     YTDBUD,F13TOT4
          ASSIGN    YTDACT-YTDBUD,F12P2
          FEDIT     F12P2,F10TOT2
          ASSIGN    ((YTDACT-YTDBUD)/YTDBUD)*100.0,F12P1
          FEDIT     F12P1,F5TOT2
.
          MOVE      CHECKSUB,KEY5
          CALL      RDSISA1
.
          MOVE      SISADESC,KEY33
          PRINT     "| ",SISACODE,SP1,KEY33,"|":
                    F13TOT1,F13TOT2,SP1,F10TOT1,SP1,F5TOT1," |":
                    F13TOT3,F13TOT4,SP1,F10TOT2,SP1,F5TOT2," |"
          IF        EXPORTYN=1
            CALL      WREXPT00
          ENDIF
.
          ADD       "1",CLNO           * add one to line number
          ADD       CURACT,TCURACT
          ADD       CURBUD,TCURBUD
          ADD       YTDACT,TYTDACT
          ADD       YTDBUD,TYTDBUD
          MOVE      ZERO,CURACT
          MOVE      ZERO,YTDACT
          MOVE      ZERO,CURBUD
          MOVE      ZERO,YTDBUD
          MOVE      SIALSUB,CHECKSUB
          MOVE      SIALCST,CHECKCST
          MOVE      SIALDAT,CHECKDAT
.
BSUB9999  RETURN
.------------------------------------------------------------
. Print Totals if Not Zero
.------------------------------------------------------------
BTOT0000  MOVE      "99,999,999.99",F13TOT1
          MOVE      "99,999,999.99",F13TOT2
          MOVE      "99,999,999.99",F13TOT3
          MOVE      "99,999,999.99",F13TOT4
          MOVE      "999,999.99",F10TOT1
          MOVE      "999,999.99",F10TOT2
          MOVE      "999.9",F5TOT1
          MOVE      "999.9",F5TOT2
          FEDIT     TCURACT,F13TOT1
          FEDIT     TCURBUD,F13TOT2
          ASSIGN    TCURACT-TCURBUD,F12P2
          FEDIT     F12P2,F10TOT1
          ASSIGN    ((TCURACT-TCURBUD)/TCURBUD)*100.0,F12P1
          FEDIT     F12P1,F5TOT1
          FEDIT     TYTDACT,F13TOT3
          FEDIT     TYTDBUD,F13TOT4
          ASSIGN    TYTDACT-TYTDBUD,F12P2
          FEDIT     F12P2,F10TOT2
          ASSIGN    ((TYTDACT-TYTDBUD)/TYTDBUD)*100.0,F12P1
          FEDIT     F12P1,F5TOT2
.
          CALL      UND132
          PRINT     "| Cost Centre Total",*42,"|":
                    F13TOT1,F13TOT2,SP1,F10TOT1,SP1,F5TOT1," |":
                    F13TOT3,F13TOT4,SP1,F10TOT2,SP1,F5TOT2," |"
.
          ADD       "1",CLNO           * add one to line number
          ADD       TCURACT,GCURACT
          ADD       TCURBUD,GCURBUD
          ADD       TYTDACT,GYTDACT
          ADD       TYTDBUD,GYTDBUD
.
          MOVE      ZERO,TCURACT
          MOVE      ZERO,TYTDACT
          MOVE      ZERO,TCURBUD
          MOVE      ZERO,TYTDBUD
.
BTOT9999  RETURN
.------------------------------------------------------------
. Print Commodity Group Totals
.------------------------------------------------------------
WRIC0000  MOVE      TRUE,FIRSTHRU
          MOVE      ZERO,TCURACT
          MOVE      ZERO,TCURBUD
          MOVE      ZERO,TYTDACT
          MOVE      ZERO,TYTDBUD
          PACK      KEY5,FCOST,SP70
          MATCH     SP5,KEY5
          GOTO      WRIC0500 IF EQUAL
.
          CALL      RDSICA1
          COMPARE   ZERO,OVRCD
          GOTO      WRIC1200 IF EQUAL
.
WRIC0500  CALL      RSSICA1
.
WRIC1000  CALL      RKSICA1
          BRANCH    OVRCD,WRIC9999           * Printed all Cost Centres
.
. ------- Check if Cost Centre Exists on sinall file
WRIC1200  PACK      KEY28,SICACODE,SP70
          CALL      RSSIAL2
          CALL      RKSIAL2
          BRANCH    OVRCD,WRIC1000
.
          MATCH     SICACODE,SIALCST
          GOTO      WRIC1000 IF NOT EQUAL
.
          CALL      CSTC0000                 * Get Cost Centre Data for C
          CALL      PCTO0000                 * Print Total
          GOTO      WRIC1000
.
WRIC9999  RETURN
.------------------------------------------------------------
. Get Total For Current Cost Centre
.------------------------------------------------------------
CSTC0000  PACK      CHCKCOMM,SP70
          MOVE      SICACODE,CHECKCST
          MOVE      TRUE,FIRSTHRU
          MOVE      ZERO,CURACT
          MOVE      ZERO,CURBUD
          MOVE      ZERO,YTDACT
          MOVE      ZERO,YTDBUD
          PACK      KEY11,SP70                                         *C-59696
          CALL      RSSISA3
CSTC1000  CALL      RKSISA3
          IF        OVRCD=1
            CALL      PCST0000               * Print Sub-Totals
            GOTO      CSTC9999               * Exit
          ENDIF
.
. ------- Calculate Total for Product Groups Current & Year to Date
          MATCH     SISACOMM,CHCKCOMM
          IF        !@EQUAL
            IF        FIRSTHRU=FALSE
              CALL      PCST0000             * Print Sub-Totals
            ELSE
              MOVE      FALSE,FIRSTHRU
            ENDIF
            MOVE      SISACOMM,CHCKCOMM
          ENDIF
.
          CALL      SUBC0000                 * Get Data for a Cost C/Subj
          MOVE      SICACODE,CHECKCST
          MOVE      SISACODE,CHECKSUB
          CALL      GBUD0000                 * Get Budget Information
          GOTO      CSTC1000
.
CSTC9999  RETURN
.------------------------------------------------------------------------
. Get Cost Data for this Cost Centre, Subjective
.------------------------------------------------------------------------
SUBC0000  PACK      KEY14,SICACODE,SISACODE,USYEAR,SP70
          PACK      KEY28,SICACODE,SISACODE,SIPEYEAR,SP70
          CALL      RSSIAL2
SUBC1000  CALL      RKSIAL2
          BRANCH    OVRCD,SUBC9999
.
          PACK      KEY28,SIALCST,SIALSUB,SIALDAT,SP70
          MATCH     KEY14,KEY28
          GOTO      SUBC9999 IF NOT EQUAL
.
          MATCH     SIALDAT,DAT6
          GOTO      SUBC9999 IF LESS
.
          ADD       SIALUAM,YTDACT
.
          MATCH     DAT6,SIALDAT
          GOTO      SUBC1000 IF NOT EQUAL
.
          ADD       SIALUAM,CURACT
          GOTO       SUBC1000                * Get All Data
.
SUBC9999  RETURN
.------------------------------------------------------------
. Print C Sub-Totals if Not Zero
.------------------------------------------------------------
PCST0000  IF        ((YTDACT=0)&(YTDBUD=0)&(CURACT=0)&(CURBUD=0))
            GOTO      PCST9999
          ENDIF
.
          COMPARE   "53",CLNO                    * end of page ?
          CALL      HEAD0000 IF NOT LESS         * start new page
.
          MOVE      "99,999,999.99",F13TOT1
          MOVE      "99,999,999.99",F13TOT2
          MOVE      "99,999,999.99",F13TOT3
          MOVE      "99,999,999.99",F13TOT4
          MOVE      "999,999.99",F10TOT1
          MOVE      "999,999.99",F10TOT2
          MOVE      "999.9",F5TOT1
          MOVE      "999.9",F5TOT2
          FEDIT     CURACT,F13TOT1
          FEDIT     CURBUD,F13TOT2
          ASSIGN    CURACT-CURBUD,F12P2
          FEDIT     F12P2,F10TOT1
          ASSIGN    ((CURACT-CURBUD)/CURBUD)*100.0,F12P1
          FEDIT     F12P1,F5TOT1

          FEDIT     YTDACT,F13TOT3
          FEDIT     YTDBUD,F13TOT4
          ASSIGN    YTDACT-YTDBUD,F12P2
          FEDIT     F12P2,F10TOT2
          ASSIGN    ((YTDACT-YTDBUD)/YTDBUD)*100.0,F12P1
          FEDIT     F12P1,F5TOT2
.
          PACK      KEY6,CHCKCOMM                                      *C-59696
          CALL      RDSIGA1
          IF        OVRCD=0
            MOVE      SIGADES,KEY33
          ELSE
            PACK      KEY33,SP70
          ENDIF
          PRINT     "| ",SIGACOD,SP1,KEY33,"|":
                    F13TOT1,F13TOT2,SP1,F10TOT1,SP1,F5TOT1," |":
                    F13TOT3,F13TOT4,SP1,F10TOT2,SP1,F5TOT2," |"
          IF        EXPORTYN=1
            CALL      WREXPT00
          ENDIF
.
          ADD       "1",CLNO           * add one to line number
          ADD       CURACT,TCURACT
          ADD       CURBUD,TCURBUD
          ADD       YTDACT,TYTDACT
          ADD       YTDBUD,TYTDBUD
.
          MOVE      ZERO,CURACT
          MOVE      ZERO,CURBUD
          MOVE      ZERO,YTDACT
          MOVE      ZERO,YTDBUD
          GOTO      PCST9999
.
PCST9999  RETURN
.------------------------------------------------------------
. Print C Totals if Not Zero
.------------------------------------------------------------
PCTO0000  MOVE      "99,999,999.99",F13TOT1
          MOVE      "99,999,999.99",F13TOT2
          MOVE      "99,999,999.99",F13TOT3
          MOVE      "99,999,999.99",F13TOT4
          MOVE      "999,999.99",F10TOT1
          MOVE      "999,999.99",F10TOT2
          MOVE      "999.9",F5TOT1
          MOVE      "999.9",F5TOT2
          FEDIT     TCURACT,F13TOT1
          FEDIT     TCURBUD,F13TOT2
          ASSIGN    TCURACT-TCURBUD,F12P2
          FEDIT     F12P2,F10TOT1
          ASSIGN    ((TCURACT-TCURBUD)/TCURBUD)*100.0,F12P1
          FEDIT     F12P1,F5TOT1
          FEDIT     TYTDACT,F13TOT3
          FEDIT     TYTDBUD,F13TOT4
          ASSIGN    TYTDACT-TYTDBUD,F12P2
          FEDIT     F12P2,F10TOT2
          ASSIGN    ((TYTDACT-TYTDBUD)/TYTDBUD)*100.0,F12P1
          FEDIT     F12P1,F5TOT2
.
          CALL      UND132
          PRINT     "| Cost Centre Total",*42,"|":
                    F13TOT1,F13TOT2,SP1,F10TOT1,SP1,F5TOT1," |":
                    F13TOT3,F13TOT4,SP1,F10TOT2,SP1,F5TOT2," |"
.
          MOVE      "599",CLNO           * add one to line number
          ADD       TCURACT,GCURACT
          ADD       TCURBUD,GCURBUD
          ADD       TYTDACT,GYTDACT
          ADD       TYTDBUD,GYTDBUD
.
          MOVE      ZERO,TCURACT
          MOVE      ZERO,TCURBUD
          MOVE      ZERO,TYTDACT
          MOVE      ZERO,TYTDBUD
.
PCTO9999  RETURN
.------------------------------------------------------------
. Print Cost Centre Totals
.------------------------------------------------------------
WRID0000  MOVE      ZERO,CURACT
          MOVE      ZERO,CURBUD
          MOVE      ZERO,YTDACT
          MOVE      ZERO,YTDBUD
          MOVE      TRUE,FIRSTHRU
          MOVE      SP70,CHECKCST
.
          PACK      KEY28,SP70
          CALL      RSSIAL2
WRID1000  CALL      RKSIAL2
          IF        OVRCD=1
            CALL      BUDD0000             * Get Budget Totals
            CALL      TOTD0000             * Print Totals for Cost Centre
            GOTO      WRID9999
          ENDIF
.
          MATCH     CHECKCST,SIALCST
          IF        !@EQUAL
            IF        FIRSTHRU=FALSE
              CALL      BUDD0000             * Get Budget Totals
              CALL      TOTD0000             * Print Totals for Cost Centre
            ENDIF
            MOVE      FALSE,FIRSTHRU
            MOVE      SIALCST,CHECKCST
          ENDIF
.
          ADD       SIALUAM,YTDACT
.
          MATCH     DAT6,SIALDAT
          GOTO      WRID1000 IF NOT EQUAL
.
          ADD       SIALUAM,CURACT
          GOTO      WRID1000
.
WRID9999  RETURN
.------------------------------------------------------------
. Get Cost Centre Budget Totals
.------------------------------------------------------------
BUDD0000  PACK      KEY11,CHECKCST,USYEAR,SP70
          PACK      KEY9,CHECKCST,USYEAR,SP70
          CALL      RSSICB1
BUDD1000  CALL      RKSICB1
          BRANCH    OVRCD,BUDD9999
          PACK      KEY11,SICBCST,SICBDAT
          MATCH     KEY9,KEY11
          GOTO      BUDD9999 IF NOT EQUAL
.
          MATCH     SICBDAT,DAT6
          GOTO      BUDD9999 IF LESS
.
          ADD       SICBBUD,YTDBUD
.
          MATCH     DAT6,SICBDAT
          GOTO      BUDD1000 IF NOT EQUAL
.
          MOVE      SICBBUD,YTDBUD
.
BUDD9999  RETURN
.----------------------------------------------------------------------
. Print Cost Centre totals Totals
.----------------------------------------------------------------------
TOTD0000  COMPARE   "53",CLNO                    * end of page ?
          CALL      HEAD0000 IF NOT LESS         * start new page
.
          MOVE      "99,999,999.99",F13TOT1
          MOVE      "99,999,999.99",F13TOT2
          MOVE      "99,999,999.99",F13TOT3
          MOVE      "99,999,999.99",F13TOT4
          MOVE      "999,999.99",F10TOT1
          MOVE      "999,999.99",F10TOT2
          MOVE      "999.9",F5TOT1
          MOVE      "999.9",F5TOT2
          FEDIT     CURACT,F13TOT1
          FEDIT     CURBUD,F13TOT2
          ASSIGN    CURACT-CURBUD,F12P2
          FEDIT     F12P2,F10TOT1
          ASSIGN    ((CURACT-CURBUD)/CURBUD)*100.0,F12P1
          FEDIT     F12P1,F5TOT1
          FEDIT     YTDACT,F13TOT3
          FEDIT     YTDBUD,F13TOT4
          ASSIGN    YTDACT-YTDBUD,F12P2
          FEDIT     F12P2,F10TOT2
          ASSIGN    ((YTDACT-YTDBUD)/YTDBUD)*100.0,F12P1
          FEDIT     F12P1,F5TOT2
.
          MOVE      "****",SICACODE         * default code             *I-49199
          MOVE      "Unknown Cost Centre",SICADESC                     *I-49199
          PACK      KEY5,CHECKCST,SP70
          CALL      RDSICA1
          MOVE      SICADESC,KEY33
          PRINT     "| ",SICACODE,SP1,KEY33,"|":
                    F13TOT1,F13TOT2,SP1,F10TOT1,SP1,F5TOT1," |":
                    F13TOT3,F13TOT4,SP1,F10TOT2,SP1,F5TOT2," |"
          IF        EXPORTYN=1
            CALL      WREXPT00
          ENDIF
.
          ADD       "1",CLNO           * add one to line number
          ADD       CURACT,GCURACT
          ADD       CURBUD,GCURBUD
          ADD       YTDACT,GYTDACT
          ADD       YTDBUD,GYTDBUD
          MOVE      ZERO,CURACT
          MOVE      ZERO,CURBUD
          MOVE      ZERO,YTDACT
          MOVE      ZERO,YTDBUD
.
TOTD9999  RETURN
.--------------------------------------------------------------------------
. Print Report Totals
.--------------------------------------------------------------------------
PRTOT000  CALL      UND132
          BRANCH    REPTTYPE,PRTOT100,PRTOT200,PRTOT200,PRTOT200
PRTOT100  MOVE      "99,999,999.99",F13TOT1
          MOVE      "99,999,999.99",F13TOT2
          MOVE      "          ",F10TOT1
          MOVE      "          ",F10TOT2
          FEDIT     GCURACT,F13TOT1
          FEDIT     GYTDACT,F13TOT2
.
          PRINT     "| Report Total",*65,"|",*82,"|":
                    F10TOT1,F13TOT1," |":
                    F10TOT2,F13TOT2," |"
          GOTO      PRTOT900
.
PRTOT200  MOVE      "99,999,999.99",F13TOT1
          MOVE      "99,999,999.99",F13TOT2
          MOVE      "99,999,999.99",F13TOT3
          MOVE      "99,999,999.99",F13TOT4
          MOVE      "999,999.99",F10TOT1
          MOVE      "999,999.99",F10TOT2
          MOVE      "999.9",F5TOT1
          MOVE      "999.9",F5TOT2
          FEDIT     GCURACT,F13TOT1
          FEDIT     GCURBUD,F13TOT2
          ASSIGN    GCURACT-GCURBUD,F12P2
          FEDIT     F12P2,F10TOT1
          ASSIGN    ((GCURACT-GCURBUD)/GCURBUD)*100.0,F12P1
          FEDIT     F12P1,F5TOT1
          FEDIT     GYTDACT,F13TOT3
          FEDIT     GYTDBUD,F13TOT4
          ASSIGN    GYTDACT-GYTDBUD,F12P2
          FEDIT     F12P2,F10TOT2
          ASSIGN    ((GYTDACT-GYTDBUD)/GYTDBUD)*100.0,F12P1
          FEDIT     F12P1,F5TOT2
          PRINT     "| Report Total",*42,"|":
                    F13TOT1,F13TOT2,SP1,F10TOT1,SP1,F5TOT1," |":
                    F13TOT3,F13TOT4,SP1,F10TOT2,SP1,F5TOT2," |"
.
PRTOT900  CALL      UND132
          IF        CPAGENO>0 & REPTSTKF=0 & HNONUSAG=1
            PRINT     *34,"******  These Figures are Calculated ":
                             "as at Receival Time  ******"
          ELSE
            IF        CPAGENO>0 & REPTSTKF=0 & HNONUSAG=2
              PRINT     *34,"******  These Figures are Calculated ":
                               "as at Purchase Order Time  ******"
            ENDIF
          ENDIF
          PRINT     *50,"***** End of Report *****",*N:
                    *1,"WARNING : Information reported is restricted ":
                    "to User Security Access"
.
          RETURN
.------------------------------------------------------------
. Print Report Heading
.------------------------------------------------------------
HEAD0000  CALL      HEAD132                     * print heading
          ADD       "3",CLNO
.
          IF        CPAGENO=1
            STRIP   FROMCOST
            STRIP   TOCOST
            STRIP   FROMWAR
            STRIP   TOWAR
            MOVE    NONDESC,REPTDESC
            LOAD    REPTDESC,REPTSTKF,STKDESC
            PRINT   *40,"Print Cost Centre Totals For ",USPERD,"/",USYEAR:
                    REPTDESC
            PRINT   *+,"Cost Centre Range : ",FROMCOST," to ",TOCOST,*N:
                    "Warehouse   Range : ",FROMWAR," to ",TOWAR
            ADD     "3",CLNO
          ENDIF
          IF        REPTTYPE<>3
            PACK      KEY5,CHECKCST,SP70
            CALL      RDSICA1
            IF        OVRCD=1
              MOVE      SP70,SICACODE
              MOVE      "Unknown Cost Centre",SICADESC
            ENDIF
          ENDIF
.
          BRANCH    REPTTYPE,HEAD1000,HEAD2000,HEAD3000,HEAD4000

HEAD1000  PRINT     "Cost Centre : ",SICACODE,SP2,SICADESC
          CALL      UND132                      * print line
.
          PRINT     "|                                                    ":
                    "           |                | Period/Year :  ":
                                     USPERD,SLASH,USYEAR:
                    " |      Year to Date      |"
.
          PRINT     "| Catalog                                            ":
                    "           | Issue Unit     | Quantity         Co":
                    "st  |  Quantity         Cost |"
.
          ADD       "1",CLNO
          GOTO      HEAD9000
.
. Product Group Totals
.----------------------
HEAD2000  PRINT     "Cost Centre : ",SICACODE,SP2,SICADESC
          CALL      UND132                      * print line
          PRINT     "| Product Group                          |":
                  "            Period/Year : ",USPERD,"/",USYEAR,"           |":
                    "                 Year to Date               |"
          PRINT     "|                                        |":
                    "       Actual       Budget   Variance % Var |":
                    "       Actual       Budget   Variance % Var |"
          GOTO      HEAD9000
.
. Commodity Group Totals
.------------------------
HEAD3000  PRINT     "Cost Centre : ",SICACODE,SP2,SICADESC
          CALL      UND132                      * print line
          PRINT     "| Commodity Group                        |":
                  "            Period/Year : ",USPERD,"/",USYEAR,"           |":
                    "                 Year to Date               |"
          PRINT     "|                                        |":
                    "       Actual       Budget   Variance % Var |":
                    "       Actual       Budget   Variance % Var |"
          GOTO      HEAD9000
.
. Cost Centre Totals
.--------------------
HEAD4000  CALL      UND132                      * print line
          PRINT     "| Cost Centre                            |":
                  "            Period/Year : ",USPERD,"/",USYEAR,"           |":
                    "                 Year to Date               |"
          PRINT     "|                                        |":
                    "       Actual       Budget   Variance % Var |":
                    "       Actual       Budget   Variance % Var |"
.
HEAD9000  ADD       "1",CLNO
          CALL      UND132                      * print line
.
HEAD9999  RETURN
.--------------------------------------------------------------------------
. Execute Transfer Script eg softerm
.--------------------------------------------------------------------------
TRAN0000  MOVE     YES,DEFYESNO
          CLOSE    EXPORTFL
          DISPLAY  *P1:24,*EL,"Execute Transfer Now (":
                              *V2LON,"Y",*HOFF,"/":
                              *V2LON,"N",*HOFF,") ? "
          MOVE     "24",CVERT
          MOVE     "30",CCOL
          CALL     YORN0000
          COMPARE  ZERO,FYESNO,
          GOTO     TRAN9999 IF EQUAL   *  No Transfer
.
          MOVE     ZERO,HLEF
          CALL     GETSCR00
.
          MOVE     "EXPORT",KEY6
          PACK     KEY8,KEY6,PORT
          REP      " 0",KEY8
          CLEAR    KEY80
          APPEND   "keatran ",KEY80
          APPEND   KEY8,KEY80
          APPEND   ".txt",KEY80
          RESET    KEY80
          EXECUTE  KEY80,TASKID
.
          CALL     PUTSCR00
.
          DISPLAY  *P1:24,*EL,"Transfer Completed Ok (":
                              *V2LON,"Y",*HOFF,"/":
                              *V2LON,"N",*HOFF,") ? "
          MOVE     "24",CVERT
          MOVE     "31",CCOL
          CALL     YORN0000
          COMPARE  ZERO,FYESNO,
          GOTO     TRAN0000 IF EQUAL   *  Not ok
.
          PREP     EXPORTFL,KEY8
          CLOSE    EXPORTFL
.
TRAN9999  RETURN
.------------------------------------------------------------
. Create Export File
.------------------------------------------------------------
MAKEXP00  MOVE     "EXPORT",KEY6
          PACK     KEY8,KEY6,PORT
          REP      " 0",KEY8
          PREP     EXPORTFL,KEY8
          BRANCH   REPTTYPE,MAKEXP10,MAKEXP20,MAKEXP30,MAKEXP40
MAKEXP10  WRITE    EXPORTFL,SEQ;"Period",TABDELM:
                           "Cost Centre",TABDELM,"Cost Centre Name",TABDELM:
                           "Catalog",TABDELM,"Catalog Name",TABDELM:
                           "Issue Unit",TABDELM:
                           "Period Quantity",TABDELM,"Period Cost",TABDELM:
                           "YTD Quantity",TABDELM,"YTD Cost",TABDELM:  *I-f1101
                           "Pref. Supp. Code",TABDELM,"Pref. Supplier Name"
          GOTO     MAKEXP99
MAKEXP20  WRITE    EXPORTFL,SEQ;"Period",TABDELM:
                           "Cost Centre",TABDELM,"Cost Centre Name",TABDELM:
                           "Product Group",TABDELM,"Product Group Name",TABDELM:
                           "Period Actual",TABDELM,"Period Budget",TABDELM:
                           "YTD Actual",TABDELM,"YTD Budget"
          GOTO     MAKEXP99
MAKEXP30  WRITE    EXPORTFL,SEQ;"Period",TABDELM:
                     "Cost Centre",TABDELM,"Cost Centre Name",TABDELM:
                     "Commodity Group",TABDELM,"Commodity Group Name",TABDELM:
                     "Period Actual",TABDELM,"Period Budget",TABDELM:
                     "YTD Actual",TABDELM,"YTD Budget"
          GOTO     MAKEXP99
MAKEXP40  WRITE    EXPORTFL,SEQ;"Period",TABDELM:
                     "Cost Centre",TABDELM,"Cost Centre Name",TABDELM:
                     "Period Actual",TABDELM,"Period Budget",TABDELM:
                     "YTD Actual",TABDELM,"YTD Budget"
          GOTO     MAKEXP99
MAKEXP99  RETURN
.------------------------------------------------------------
. Write to Export File
.------------------------------------------------------------
WREXPT00  BRANCH    REPTTYPE,WREXPT10,WREXPT20,WREXPT30,WREXPT40
WREXPT10  WRITE     EXPORTFL,SEQ;USPERD,"/",USYEAR,TABDELM:
                               SICACODE,TABDELM,SICADESC,TABDELM:
                               SIIACAT,TABDELM,SIIADES,TABDELM,SIIAISS,TABDELM:
                               CURQTY,TABDELM,CURACT,TABDELM:
                               YTDQTY,TABDELM,YTDACT,TABDELM:          *C-f1101
                               SIIAPSC,TABDELM,KEY54                   *I-f1101
          GOTO      WREXPT99
WREXPT20  WRITE     EXPORTFL,SEQ;USPERD,"/",USYEAR,TABDELM:
                               SICACODE,TABDELM,SICADESC,TABDELM:
                               SISACODE,TABDELM,SISADESC,TABDELM:
                               CURACT,TABDELM,CURBUD,TABDELM:
                               YTDACT,TABDELM,YTDBUD
          GOTO      WREXPT99
WREXPT30  WRITE     EXPORTFL,SEQ;USPERD,"/",USYEAR,TABDELM:
                               SICACODE,TABDELM,SICADESC,TABDELM:
                               SIGACOD,TABDELM,SIGADES,TABDELM:
                               CURACT,TABDELM,CURBUD,TABDELM:
                               YTDACT,TABDELM,YTDBUD
          GOTO      WREXPT99
WREXPT40  WRITE     EXPORTFL,SEQ;USPERD,"/",USYEAR,TABDELM:
                               SICACODE,TABDELM,SICADESC,TABDELM:
                               CURACT,TABDELM,CURBUD,TABDELM:
                               YTDACT,TABDELM,YTDBUD
          GOTO      WREXPT99
WREXPT99  RETURN
.
ESTCK0000  MOVE     FALSE,EXIT
           MOVE     ANSS,REPTSTCK
           KEYIN    *PCCOL:CVERT,*EL,*V2LON,*RV,REPTSTCK
           PACK     REPTSTCK,REPTSTCK,SP10
.
           MATCH    EXITCHAR,REPTSTCK
           IF       @EQUAL
             MOVE     TWO,EXIT
             GOTO     ESTCK999
           ENDIF
.
           TYPE     REPTSTCK
           GOTO     ESTCK900 IF EQUAL
           REP      UPPLOW,REPTSTCK
           MOVE     REPTSTCK,ANS
           REP      "S1N0",ANS
           TYPE     ANS
           GOTO     ESTCK900 IF NOT EQUAL
.
. -------- Valid Option
           MOVE     ANS,FORM1
           IF       FORM1=1
             MOVE     ANSS,REPTSTCK          * Only Stock
             DISPLAY  *PCCOL:CVERT,*EL,*V2LON,"Stock Only"
             MOVE     FORM1,REPTSTKF           * Report Variable
             GOTO     ESTCK999
           ENDIF
.
           IF       FORM1=0
             MOVE     ANSN,REPTSTCK          * Only Non-Stock
             DISPLAY  *PCCOL:CVERT,*EL,*V2LON,"Non-Stock Only"
             MOVE     FORM1,REPTSTKF           * Report Variable
             GOTO     ESTCK999
           ENDIF
.
ESTCK900   MOVE     "Invalid Option - ",DISPMSG
           CALL     MESSAGE1
           GOTO     ESTCK0000
.
ESTCK999   RETURN
.----------------------------------------------------------------------
. Enter Cost Centre Range
.----------------------------------------------------------------------
ECOS0000  MOVE      "    5",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          MOVE      ZERO,CKEYTYP
          CALL      KSICAA00
          BRANCH    EXIT,ECOS1000,ECOS9500
          MOVE      SICACODE,FCOST
          PACK      FROMCOST,SICACODE,SP1,SICADESC,SP70
          GOTO      ECOS2000
.
ECOS1000  MOVE      SP70,FCOST
          MOVE      "Start                                         ",FROMCOST
.
ECOS2000  MOVE      FROMCOST,VAR
          CALL      DISPITEM
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          MOVE      ZERO,CKEYTYP
          CALL      KSICAA00
          BRANCH    EXIT,ECOS3000,ECOS9500
          MOVE      SICACODE,TCOST
          PACK      TOCOST,SICACODE,SP1,SICADESC,SP70
          MATCH     FCOST,TCOST
          GOTO      ECOS9000 IF EQUAL
          GOTO      ECOS9000 IF NOT LESS
          BEEP
          MOVE      "To Cost Centre Must Be > From Cost Centre - ",DISPMSG
          CALL      MESSAGE1
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          GOTO      ECOS0000
.
ECOS3000  PACK      TCOST,Z70
          MOVE      "Finish                                        ",TOCOST
.
ECOS9000  MOVE      "    5",FLDID
          CALL      GETPOSIT
          MOVE      ZERO,EXIT
          GOTO      ECOS9999
.
ECOS9500  MOVE      TWO,EXIT
.
ECOS9999  RETURN
.
.----------------------------------------------------------------------
. Range of Warehouse Code
. RNGEWARE = 1 - Standard Warehouse Range Keyin being used
.----------------------------------------------------------------------
EWAR0000  MOVE      ONE,RNGEWARE       * required by LOAD0000 (CALCUSAG.PBL)
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          PACK      SIWAWAR,SP70
          PACK      SIWADES,SP70
          CALL      KSIWSA00
          BRANCH    EXIT,EWAR0100,EWAR9500
          MOVE      SIWAWAR,FWAREHS
          PACK      FROMWAR,SIWAWAR,SP1,SIWADES
          GOTO      EWAR0150
EWAR0100  MOVE      "Start                                         ",FROMWAR
          PACK      FWAREHS,SP70
.
EWAR0150  MOVE      FROMWAR,VAR
          CALL      DISPITEM
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          PACK      SIWAWAR,SP70
          PACK      SIWADES,SP70
          CALL      KSIWSA00
          BRANCH    EXIT,EWAR0200,EWAR9500
          MOVE      SIWAWAR,TWAREHS
          PACK      TOWAR,SIWAWAR,SP1,SIWADES
          MATCH     FWAREHS,TWAREHS
          GOTO      EWAR9000 IF EQUAL
          GOTO      EWAR9000 IF NOT LESS
          BEEP
          MOVE      "To Warehouse Must Be > From Warehouse - ",DISPMSG
          CALL      MESSAGE1
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          GOTO      EWAR0000
.
EWAR0200  MOVE      "Finish                                        ",TOWAR
          PACK      TWAREHS,Z70
.
EWAR9000  MOVE      "    7",FLDID
          CALL      GETPOSIT
          MOVE      ZERO,EXIT
          GOTO      EWAR9999
.
EWAR9500  MOVE      TWO,EXIT
          GOTO      EWAR9999
.
EWAR9999  RETURN
.
.----------------------------------------------------------------------
. Keyin Year
.----------------------------------------------------------------------
KYEAR000  CALL      RINPECON
          MOVE      SIPECYR,USYEAR
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,*JR,USYEAR
          PACK      USYEAR,USYEAR,SP70
.
          MATCH     SP70,USYEAR
          GOTO      KYEAR950 IF EQUAL
          PACK      KEY4,SP3,EXITCHAR
          MATCH     KEY4,USYEAR
          GOTO      KYEAR950 IF EQUAL
.
          TYPE      USYEAR
          GOTO      KYEAR000 IF NOT EQUAL
.
          MOVE      USYEAR,SIPEYF4
          IF        SIPEYF4<100
            SQUEEZE   USYEAR
            MOVE      USYEAR,FORM2
            PACK      USYEAR,CCC,FORM2,SP70
          ENDIF
.
          REP       " 0",USYEAR
.
KYEAR900  MOVE      ZERO,EXIT                    * entry ok
          GOTO      KYEAR999
.
KYEAR950  MOVE      TWO,EXIT                     * quit screen
.
KYEAR999  RETURN
.----------------------------------------------------------------------
. Keyin period
.----------------------------------------------------------------------
KPERD000  KEYIN     *PCCOL:CVERT,*V2LON,*RV,*ZF,*JR,USPERD
          PACK      USPERD,USPERD,SP70
          REP       " 0",USPERD
.
          PACK      KEY2,ZERO,EXITCHAR      * check for exitchar
          MATCH     KEY2,USPERD
          GOTO      KPERD950 IF EQUAL
.
          TYPE      USPERD                  * check if numeric
          GOTO      KPERD000 IF NOT EQUAL
.
          MOVE      USPERD,F2
          IF        F2>SIPENUM
            BEEP
            MOVE      "Invalid Period - ",DISPMSG
            CALL      MESSAGE1
            GOTO      KPERD000
          ENDIF
.
          PACK      KEY6,USYEAR,USPERD
          REP       " 0",KEY6
          CALL      RDSIPE1
          IF        OVRCD=1
            BEEP
            MOVE      "Period Does Not Exist - ",DISPMSG
            CALL      MESSAGE1
            GOTO      KPERD000
          ENDIF
.
.
KPERD900  MOVE      ZERO,EXIT                    * entry ok
          GOTO      KPERD999
.
KPERD950  MOVE      TWO,EXIT                     * quit screen
.
KPERD999  RETURN
ERTYP000   CALL      DRTYP000
           IF        REPTTYPE<=0 | REPTTYPE>=5
             MOVE      ONE,REPTTYPE
           ENDIF
ERTYP001   KEYIN     *PCCOL:CVERT,*V2LON,*RV,DIM1
           MATCH     EXITCHAR,DIM1
           IF        @EQUAL
             MOVE      TWO,EXIT
             GOTO      ERTYP999
           ENDIF
           MOVE      DIM1,REPTTYPE
           BRANCH    REPTTYPE,ERTYP010,ERTYP020,ERTYP030,ERTYP040
           IF        REPTTYPE=0
             MOVE      TWO,EXIT
             GOTO      ERTYP999
           ENDIF
           GOTO      ERTYP001
.
ERTYP010   MOVE      "Full Report",RTYPDESC
           GOTO      ERTYP999
.
ERTYP020   MOVE      "Product Group Totals",RTYPDESC
           GOTO      ERTYP999
.
ERTYP030   MOVE      "Commodity Totals",RTYPDESC
           GOTO      ERTYP999
.
ERTYP040   MOVE      "Cost Centre Totals",RTYPDESC
           GOTO      ERTYP999
.
ERTYP999   CALL      PUTSCR00
           RETURN
.
DRTYP000  MOVE      "18",HTOP
          IF        CVERT<18
            ASSIGN    CVERT,HTOP
          ENDIF
          MOVE      "55",HLEF
          ASSIGN    HTOP+6,HBOT
          MOVE      "80",HRIG
.
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          ADD       ONE,HTOP
          DISPLAY   *P60:HTOP,*V2LON,*ULON,"Report Type",*HOFF
          ADD       ONE,HTOP
          DISPLAY   *P57:HTOP,*V2LON,"1. ",*HOFF,"Full Catalog Report"
          ADD       ONE,HTOP
          DISPLAY   *P57:HTOP,*V2LON,"2. ",*HOFF,"Product Group Totals"
          ADD       ONE,HTOP
          DISPLAY   *P57:HTOP,*V2LON,"3. ",*HOFF,"Commodity Totals"
          ADD       ONE,HTOP
          DISPLAY   *P57:HTOP,*V2LON,"4. ",*HOFF,"Cost Centre Totals"
          SUB       FIVE,HTOP
          RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSIMSIO/INC
          INC       APSINPIO/INC
          INC       APSMASIO/INC
          INC       CALCUSAG    
          INC       SINALLCD    
          INC       SINCCAIO/INC
          INC       SINCCAKY    
          INC       SINCCBIO/INC
          INC       SINCCEIO/INC
          INC       SINCCFIO/INC
          INC       SINCCHIO/INC
          INC       SINCGAIO/INC
          INC       SINCIAIO/INC
          INC       SINCIEIO/INC
          INC       SINFACIO/INC
          INC       SINNATIO/INC
          INC       SINPERCD    
          INC       SINPERIO/INC
          INC       SINPOAIO/INC
          INC       SINPOCIO/INC
          INC       SINPOFIO/INC
          INC       SINSUAIO/INC
          INC       SINWARIO/INC
          INC       SINWSEIO/INC
          INC       SINWSEKY    
.
          INC       STDGENCD
.
