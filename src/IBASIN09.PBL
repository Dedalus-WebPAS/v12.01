.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.01.00"
.-------------------------------------------------------
.V10.04.01  18/06/2014  Steve Armstrong
.           Added call to TFILENAM for FNAMPOST (AUTOPCOD)
.           in TMPFIL00 (new function).
.           Recompiled for changes to AUTOPCOD & AUPCDVAR.
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.01.01  18.05.2000 Charles Handaya
.           Add an item and painted it on screen
.-------------------------------------------------------
. VF.00.03  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
. VF.00.02  02.11.1999 Sandra Barcham
.           Change locked message to use X
. VF.00.01  02.09.1999 Sandra Barcham
.           Add Key Word Search for creditor code
.           srf 631485
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN09
.   Function      :   Supplier Maintenance                    
.   Generated  On :   18/06/2014
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSCNTFD/INC
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
          INC       APSSNTFD/INC
          INC       AUPCDVAR/INC
          INC       IBASEQFD/INC
          INC       TFILEVAR/INC
          INC       WEBERRFD/INC
.=========================
.Local Variable Definition
.-------------------------
.
.Word Processor File * Scr 00 Fld    11
.
NAMAPSN1  INIT      "Wapsn1"
FILAPSN1  DIM       8
.
.
.Word Processor File * Scr 00 Fld    29
.
NAMAPCN1  INIT      "Wapcn1"
FILAPCN1  DIM       8
.
.
.    Multi Item Key Fields Scr 01 Fld     2
.-------------------------------------------------------
APMX2NAM  INIT      "APMX2"
APMX2LEN  FORM      "102"
APMX2IDX  INIT      "DC1-5 UC6-35"
APMX2FNM  DIM       8  * Filename
APMX2AFL  FORM      1  * End Accept Mode
APMX2END  FORM      1  * End Display
APMX2SNO  FORM      5  * Number of Items on the Screen
APMX2NXT  DIM         35
APMX2FL1  IFILE     SQL, FIXED=102,  KEY="D1-5"
APMX2FL2  IFILE     SQL, FIXED=102, KEY="U6-35"
APMX2CNT  FORM      3  * Number of Items on Screen
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN09"
PRGNAM    INIT      "Supplier Maintenance                    "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      TMPFIL00
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPCN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     APMX2FL2
          CLOSE     APMX2FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   51",AUDTSECT
          MOVE      " 48",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening apsaudma";
            OPEN      APSAUDMA,"apsaudma"
          ENDIF
          DISPLAY   *P56:24,"Opening apscntaf";
          OPEN      APSCNTA1,"apscntaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
          DISPLAY   *P56:24,"Opening apssntaf";
          OPEN      APSSNTA1,"apssntaf"
          DISPLAY   *P56:24,"Opening ibaseqaf";
          OPEN      IBASEQA1,"ibaseqaf"
          DISPLAY   *P56:24,"Opening weberraf";
          OPEN      WEBERRA1,"weberraf"
          DISPLAY   *P56:24,"Opening weberraf";
          OPEN      WEBERRA2,"weberraf"
          DISPLAY   *P56:24,"Opening weberraf";
          OPEN      WEBERRA3,"weberraf"
.--------------------------------------------------------
. Initialise Wp Filename for Supplier Notes                     
.--------------------------------------------------------
          PACK      FILAPSN1,NAMAPSN1,PORT
          REP       " 0",FILAPSN1
          DISPLAY   *P56:24,"Create & Open ",FILAPSN1;
          PREP      TEMPWORD,FILAPSN1
.
.--------------------------------------------------------
. Initialise Wp Filename for Creditor Notes Display             
.--------------------------------------------------------
          PACK      FILAPCN1,NAMAPCN1,PORT
          REP       " 0",FILAPCN1
          DISPLAY   *P56:24,"Create & Open ",FILAPCN1;
          PREP      TEMPWORD,FILAPCN1
.
.--------------------------------------------------------
. Initialise Batch Screen Alias Description                  
.--------------------------------------------------------
          MOVE     ZERO,APMX2SNO
          MOVE     "01    2",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APMX2SNO
            ENDIF
          ENDIF
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Supplier Maintenance               
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Alias Maintenance                  
          ENDIF
          RETURN
.--------------------------------
. Screen - Supplier Maintenance               
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Supplier Maintenance               
.-------------------------------------------------------
CF00L000
          MOVE      SP70,APMACRD 
          MOVE      SP70,APMACN1 
          MOVE      SP70,APMASA1 
          MOVE      SP70,APMASA2 
          MOVE      SP70,APMASA3 
          MOVE      SP70,APMASPC 
          MOVE      SP70,APMASTEL
          MOVE      SP70,APMASFAX
          MOVE      SP70,APMASCON
          MOVE      SP70,APMAUR1 
          MOVE      SP70,APMAUR2 
          MOVE      SP70,APMAUD1 
          MOVE      SP70,APMAUD2 
          MOVE      ZERO,APMAGREG
          MOVE      ZERO,APMAUY2 
          MOVE      SP70,APMASN1 
          MOVE      SP70,APMASN2 
          MOVE      SP70,APMASEDI
          MOVE      SP70,APMACEDI
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Supplier Maintenance               
.--------------------------------------------------------
KY00L000
.
KY00L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      LAPMAB00
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Supplier Maintenance               
.---------------------------------------------------------
WP00L000
          PREP     TEMPWORD,FILAPSN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPSN1 
          IF        OVRCD=0
            CALL      RPAPSN1 
          ENDIF
WP00L100
          CALL     RKAPSN1 
          BRANCH   OVRCD,WP00L105
          PACK     KEY8,APSNCRD,APSNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP00L105 IF NOT EQUAL
          PACK     VAR,APSNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APSNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP00L100
WP00L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILAPCN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPCN1 
          IF        OVRCD=0
            CALL      RPAPCN1 
          ENDIF
WP00L110
          CALL     RKAPCN1 
          BRANCH   OVRCD,WP00L115
          PACK     KEY8,APCNCRD,APCNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP00L115 IF NOT EQUAL
          PACK     VAR,APCNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APCNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP00L110
WP00L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Supplier Maintenance               
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Supplier Maintenance               
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Supplier Maintenance               
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L101,PS00L102:
                            PS00L103,PS00L104,PS00L105,PS00L106:
                            PS00L107,PS00L108,PS00L109,PS00L999:
                           PS00L110,PS00L111,PS00L112,PS00L113:
                            PS00L114,PS00L115,PS00L116,PS00L117:
                            PS00L118,PS00L119,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L120,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE     FILAPSN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS00L999
.
PS00L110
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE     FILAPCN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Supplier Maintenance               
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L101:
                            SF00L102,SF00L103,SF00L104,SF00L105:
                            SF00L106,SF00L107,SF00L108,SF00L006:
                           SF00L109,SF00L110,SF00L111,SF00L112:
                            SF00L113,SF00L114,SF00L115,SF00L116:
                            SF00L117,SF00L118,SF00L006,SF00L006:
                           SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L119,SF00L120,SF00L121,SF00L006:
                           SF00L006,SF00L122
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L101:
                            SF00L102,SF00L103,SF00L104,SF00L105:
                            SF00L106,SF00L107,SF00L108,SF00L020:
                           SF00L109,SF00L110,SF00L111,SF00L112:
                            SF00L113,SF00L114,SF00L115,SF00L116:
                            SF00L117,SF00L118,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L119,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSA100
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L101
            ENDIF
            BRANCH    EXIT,SF00L101,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L102
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSA200
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L102
            ENDIF
            BRANCH    EXIT,SF00L102,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSA300
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L103
            ENDIF
            BRANCH    EXIT,SF00L103,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSPC00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
            BRANCH    EXIT,SF00L104,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSTE00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L105
            ENDIF
            BRANCH    EXIT,SF00L105,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSFA00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L106
            ENDIF
            BRANCH    EXIT,SF00L106,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSCO00
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
            BRANCH    EXIT,SF00L107,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L108
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "15",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     " 6",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPSN1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPSN1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SF00L001
.
SF00L109
          CALL     SELECTED
          STRIP     APMAUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMAUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMAUR1 
          SFORMAT   VAR,127
          ENDSET    APMAUR1 
          APPEND    SP70,APMAUR1 
          RESET     APMAUR1 
          CMATCH    EXITCHAR,APMAUR1 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMAUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L109
            ENDIF
          ENDIF
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L110
          CALL     SELECTED
          STRIP     APMAUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMAUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMAUR2 
          SFORMAT   VAR,127
          ENDSET    APMAUR2 
          APPEND    SP70,APMAUR2 
          RESET     APMAUR2 
          CMATCH    EXITCHAR,APMAUR2 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMAUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L110
            ENDIF
          ENDIF
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L111
          CALL     SELECTED
          CALL      KEYDATE
          PACK      APMAUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L112
          CALL     SELECTED
          CALL      KEYDATE
          PACK      APMAUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L113
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,APMAGREG
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L114
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,APMAUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L115
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSN100
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L115
            ENDIF
            BRANCH    EXIT,SF00L115,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L116
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KAPSN200
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L116
            ENDIF
            BRANCH    EXIT,SF00L116,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L117
          CALL     SELECTED
          STRIP     APMASEDI
          SFORMAT   VAR,SCPSLEN
          MOVE      APMASEDI,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMASEDI
          SFORMAT   VAR,127
          ENDSET    APMASEDI
          APPEND    SP70,APMASEDI
          RESET     APMASEDI
          CMATCH    EXITCHAR,APMASEDI
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMASEDI
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L117
            ENDIF
          ENDIF
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L118
          CALL     SELECTED
          STRIP     APMACEDI
          SFORMAT   VAR,SCPSLEN
          MOVE      APMACEDI,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMACEDI
          SFORMAT   VAR,127
          ENDSET    APMACEDI
          APPEND    SP70,APMACEDI
          RESET     APMACEDI
          CMATCH    EXITCHAR,APMACEDI
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,APMACEDI
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L118
            ENDIF
          ENDIF
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L119
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 70",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPCN1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPCN1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SF00L001
.
SF00L120
          CALL      CANCL000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L121
          CALL      WAPMA000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L122
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC01L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Alias Maintenance                  
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 57",CRIG
          MOVE      "11",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Alias Maintenance                  
.-------------------------------------------------------
CF01L000
          MOVE      SP70,APMXREF 
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Alias Maintenance                  
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Alias Maintenance                  
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Alias Maintenance                  
.---------------------------------------------------------
LM01L000
.---------------------------------------------------------
. Load for :     2 Alias Description                  
.---------------------------------------------------------
          UNPACK    SP70,APMXCRD,APMXREF
          PACK      APMX2FNM,ANST,APMX2NAM,PORT
          REP       " 0",APMX2FNM
          MOVE      ZERO,APMX2AFL
          CLOSE     APMX2FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      APMX2FL1,APMX2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     APMX2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,APMX2FNM,SP1,APMX2LEN,SP1,APMX2IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      APMX2FL1,APMX2FNM
          OPEN      APMX2FL2,APMX2FNM
          PACK      KEY35,APMACRD,SP70
          MOVE      KEY35,SAVKEY80
          SETLPTR   SAVKEY80,5 
          CALL      RDAPMX2 
          IF        OVRCD=0
            CALL      RPAPMX2 
          ENDIF
LM01L100
          CALL      RKAPMX2 
          BRANCH    OVRCD,LM01L105
          PACK      KEY35,APMXCRD,APMXREF
          MATCH     SAVKEY80,KEY35   
          GOTO      LM01L105 IF NOT EQUAL
          RESET     KEY35,6
          MOVE      KEY35,KEY30
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TAAPMX22
          IF        OVRCD=0
            CALL      TUAPMX22
          ELSE
            CALL      TWAPMX22
          ENDIF
          GOTO     LM01L100
LM01L105
          MOVE     SP70,KEY30  
          CALL     TSAPMX22
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Alias Maintenance                  
.---------------------------------------------------------
SM01L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM01L010 IF EQUAL
SM01L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM01L010,SM01L101,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010
SM01L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM01L007
          MATCH     PRGID,SCPSPID
          GOTO      SM01L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM01L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM01L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM01L006 IF NOT EQUAL
          GOTO      SM01L005
SM01L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM01L010
          BRANCH    STDGSFLG,SM01L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM01L900
          MATCH     PRGID,SCPSPID
          GOTO      SM01L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM01L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM01L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM01L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010,SM01L010,SM01L010:
                            SM01L010,SM01L010
          GOTO      SM01L010
.
SM01L101
          CALL      MAPMX000
          MOVE     ZERO,APMX2AFL
          STRIP     APMXREF 
          SFORMAT   VAR,SCPSLEN
          MOVE      APMXREF,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,APMXREF 
          SFORMAT   VAR,127
          ENDSET    APMXREF 
          APPEND    SP70,APMXREF 
          RESET     APMXREF 
          MATCH     SP70,APMXREF 
          GOTO      SM01L990 IF EQUAL
          CMATCH    EXITCHAR,APMXREF 
          GOTO      SM01L990 IF EQUAL
          PACK     KEY35,APMXCRD,APMXREF                                                           
          RESET    KEY35,6
          MOVE     KEY35,KEY30
          CALL      TAAPMX22
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM01L101
          ENDIF
          MOVE      APMXREF,VAR      
          CALL      DISPITEM
          GOTO     SM01L010
SM01L900
          MATCH    "APMX2",NAMSSFFI
          IF       @EQUAL
            PACK     KEY35,APMXCRD,APMXREF
            RESET    KEY35,6
            MOVE     KEY35,KEY30
            CALL      TAAPMX22
            IF        OVRCD=0
              CALL      TUAPMX22
            ELSE
              CALL      TWAPMX22
            ENDIF
            GOTO      SM01L999
          ENDIF
          GOTO      SM01L999
SM01L990
          MATCH    "APMX2",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,APMX2AFL
          ENDIF
SM01L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP01L000
          MOVE     ZERO,APMX2CNT
          MOVE     ZERO,APMX2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP01L600
          MATCH    PRGID,SCPSPID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP01L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP01L010,DP01L101,DP01L010,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010,DP01L010
          GOTO      DP01L010
.
DP01L101
          IF        APMX2END=0
            CALL      TKAPMX22
            IF        OVRCD=1
              MOVE      ONE,APMX2END
            ELSE
              MOVE      ZERO,APMX2END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUAPMX22
              MOVE      APMXREF,VAR      
              CALL      DISPITEM
            ENDIF
          ENDIF
          IF        APMX2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
DP01L600
          MATCH    "APMX2",NAMSSFFI
          GOTO     DP01L605 IF NOT EQUAL
          GOTO     DP01L999
DP01L605
DP01L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP01L000
.
          CALL     CT01L000
          MATCH    "APMX2",NAMSSFFI
          GOTO     FP01L105 IF NOT EQUAL
          MOVE     SP70,KEY30  
          CALL     TSAPMX22 * Start
          CALL     DP01L000
          GOTO     FP01L999
FP01L105
FP01L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP01L000
.
          CALL     CT01L000
          MATCH    "APMX2",NAMSSFFI
          GOTO     LP01L105 IF NOT EQUAL
          PACK     KEY30,Z70
          CALL     TSAPMX22
          IF       OVRCD=1
            CALL     TPAPMX22 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APMX2SNO
            CALL     TPAPMX22
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     LP01L999
LP01L105
LP01L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP01L000
.
PP01L100
          MATCH    "APMX2",NAMSSFFI
          GOTO     PP01L115 IF NOT EQUAL
PP01L105
          MOVE     SP70,APMX2NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSAPMX21
          CALL     TKAPMX21 * First on Page
          MOVE     KEY30,APMX2NXT
          CALL     TSAPMX22
          CALL     TPAPMX22 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP01L999
          ENDIF
.
          CALL     CT01L000
.
. Position and Display Page
.--------------------------
PP01L110
          MOVE     APMX2NXT,KEY30  
          CALL     TSAPMX22
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=APMX2SNO
            CALL     TPAPMX22
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     PP01L999
PP01L115
PP01L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP01L000
          MATCH    "APMX2",NAMSSFFI
          GOTO     NP01L115 IF NOT EQUAL
NP01L105
          MOVE     SP70,APMX2NXT
          PACK     KEY5,Z70
          CALL     TSAPMX21
          CALL     TPAPMX21
          MOVE     KEY30,APMX2NXT
          CALL     TSAPMX22
          CALL     TKAPMX22
          IF       OVRCD=1
            BEEP
            GOTO      NP01L999
          ENDIF
.
          CALL     CT01L000
.
. Position and Display Page
.--------------------------
NP01L110
          MOVE     APMX2NXT,KEY30  
          CALL     TSAPMX22
          CALL     DP01L000
          GOTO     NP01L999
NP01L115
NP01L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT01L000
          MATCH    "APMX2",NAMSSFFI
          GOTO     CT01L115 IF NOT EQUAL
CT01L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSAPMX21
          CALL     TKAPMX21
          BRANCH   OVRCD,CT01L110
          CALL     TRAPMX22
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUAPMX22
          GOTO     CT01L105
CT01L110
          GOTO     CT01L999
CT01L115
CT01L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP01L000
          CALL     CT01L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP01L999
          MATCH    PRGID,SCPSPID
          GOTO     CP01L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP01L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP01L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP01L010,CP01L100,CP01L010,CP01L010:
                            CP01L010,CP01L010,CP01L010,CP01L010:
                            CP01L010,CP01L010
.
CP01L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP01L010
CP01L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD01L000
          CALL      CP01L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD01L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD01L000
          MATCH     PRGID,SCPSPID
          GOTO      AD01L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD01L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD01L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM01L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "APMX2",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,APMX2AFL
            GOTO      AD01L010 IF EQUAL
            CALL      FP01L000
            GOTO      AD01L999
          ENDIF
AD01L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL01L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL01L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL01L900,DL01L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL01L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "APMX2",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRAPMX21
            IF        OVRCD=0
              CALL      TDAPMX22
            ELSE
              BEEP
              GOTO      DL01L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSAPMX21
            CALL      TKAPMX21
            MOVE     KEY30,APMX2NXT
            CALL      CT01L000
            MOVE      APMX2NXT,KEY30  
            CALL      TSAPMX22
            CALL      TPAPMX22
            CALL      DP01L000
            GOTO      DL01L005
          ENDIF
DL01L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL01L005
DL01L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Alias Maintenance                  
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     2 Alias Description                  
.---------------------------------------------------------
TSAPMX21  RESET     KEY5
          READ      APMX2FL1,KEY5;;
          RETURN
.
TSAPMX22  RESET     KEY30  
          READ      APMX2FL2,KEY30;;
          RETURN
.
TAAPMX22  RESET     KEY30  
          MOVE      ZERO,OVRCD
          READ      APMX2FL2,KEY30;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDAPMX21  RESET     KEY5
          DELETE    APMX2FL1,KEY5
          RETURN
.
TDAPMX22  RESET     KEY30
          DELETE    APMX2FL2,KEY30
          RETURN
.
TKAPMX21  MOVE      ZERO,OVRCD
          READKS    APMX2FL1;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TKAPMX22  MOVE      ZERO,OVRCD
          READKS    APMX2FL2;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TPAPMX21  MOVE      ZERO,OVRCD
          READKP    APMX2FL1;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TPAPMX22  MOVE      ZERO,OVRCD
          READKP    APMX2FL2;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TRAPMX21  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      APMX2FL1,KEY5;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TRAPMX22  RESET     KEY30  
          MOVE      ZERO,OVRCD
          READ      APMX2FL2,KEY30;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          GOTO      OVERCOND IF OVER
          RETURN
.
TUAPMX21  UPDATE    APMX2FL1;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          RETURN
.
TUAPMX22
          UPDATE    APMX2FL2;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          RETURN
.
TWAPMX22  RESET     KEY30  
          WRITE     APMX2FL2,KEY30;SCTMROW,SCTMCOL,KEY30:
                        APMXCRD,APMXREF,APMXTYP,APMXSPA                         
          RETURN
.---------------------------------------------------------
. Display Fields for : Alias Maintenance                  
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      FP01L000
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Alias Maintenance                  
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Alias Maintenance                  
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L105,SF01L106,SF01L107:
                            SF01L108,SF01L109
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L101,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L101
          CALL      SELECTED
          BRANCH    EXIT,SF01L001
          MOVE      "APMX2",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRAPMX21
            BRANCH    OVRCD,SF01L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF01L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF01L001 IF NOT EQUAL
            CALL      SM01L000 * Change Line
          ELSE
            IF        APMX2AFL=0
              MOVE      "APMX2",NAMSSFFI
              MOVE     "    2",ITMSSFFI
              CALL      AD01L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF01L001
.
SF01L102
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      NP01L000
          GOTO     SF01L001
.
SF01L103
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      PP01L000
          GOTO     SF01L001
.
SF01L104
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      AD01L000
          GOTO     SF01L001
.
SF01L105
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      DL01L000
          GOTO     SF01L001
.
SF01L106
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L107
          MOVE      "APMX2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      LP01L000
          GOTO     SF01L001
.
SF01L108
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L109
          CALL      WAPMX000
          MOVE      ZERO,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.@@@@@ Function Restart Point @@@@@
.***************************************************************************
.* TMPFIL00 - Set the temp file name                                       *
.***************************************************************************
.
TMPFIL00  CALL      TFILENAM
          MOVE      TFILNAME,FNAMPOST
.
TMPFIL99  RETURN
+
.----------------------------------------------------------------------
. Cancel Creditors Maintenance
.----------------------------------------------------------------------
LAPMAB00  CALL      KAPMAB00
          BRANCH    EXIT,LAPMAB99,LAPMAB99
LAPMAB10  MOVE      APMACRD,KEY5
          CALL      RLAPMA1
          BRANCH    OVRCD,LAPMAB90,LAPMAB20
          MOVE      TWO,AUDTTYPE
          CALL      WAAPMA00          * Write Before Audit
          MOVE      ZERO,EXIT
          GOTO      LAPMAB99
.
LAPMAB20  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          KEYIN     *P1:24,*EL,"Record Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MATCH     ANSR,ANS
          GOTO      LAPMAB10 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      LAPMAB00 IF EQUAL
          MATCH     ANSE,ANS
          GOTO      LAPMAB20 IF NOT EQUAL
          GOTO      LAPMAB00
.
LAPMAB90
          MOVE      SP70,APMATYP
          MOVE      SP70,APMASKY
          MOVE      SP70,APMACN1
          MOVE      SP70,APMACN2
          MOVE      SP70,APMACA1
          MOVE      SP70,APMACA2
          MOVE      SP70,APMACA3
          MOVE      SP70,APMACPC
          MOVE      SP70,APMACTEL
          MOVE      SP70,APMACFAX
          MOVE      SP70,APMACMOD
          MOVE      SP70,APMACEDI
          MOVE      SP70,APMACON
          MOVE      SP70,APMASN1
          MOVE      SP70,APMASN2
          MOVE      SP70,APMASA1
          MOVE      SP70,APMASA2
          MOVE      SP70,APMASA3
          MOVE      SP70,APMASPC
          MOVE      SP70,APMASTEL
          MOVE      SP70,APMASFAX
          MOVE      SP70,APMASMOD
          MOVE      SP70,APMASEDI
          MOVE      SP70,APMASCON
          MOVE      SP70,APMABSB
          MOVE      SP70,APMABAC
          MOVE      SP70,APMAPNM
          MOVE      ZERO,APMAPPT
          MOVE      ZERO,APMAPOT
          MOVE      ZERO,APMAHOR
          MOVE      ZERO,APMAHIN
          MOVE      ZERO,APMAHCR
          MOVE      ZERO,APMAHPY
          MOVE      ZERO,APMAPMT
          MOVE      ZERO,APMAGMT
          MOVE      SP70,APMAPPD
          MOVE      SP70,APMADTM
          MOVE      SP70,APMAUR1
          MOVE      SP70,APMAUR2
          MOVE      SP70,APMAUD1
          MOVE      SP70,APMAUD2
          MOVE      SP70,APMAUC1
          MOVE      SP70,APMAUC2
          MOVE      ZERO,APMAGREG
          MOVE      ZERO,APMAUY2
          MOVE      SP70,APMASPA
.
LAPMAB99  RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Address Line 2
.----------------------------------------------------------------------
KAPSA100  MATCH     SP70,APMASA1
          IF        @EQUAL
            MOVE      APMACA1,APMASA1
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASA1
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASA1
          IF        @EQUAL
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Address Line 2
.----------------------------------------------------------------------
KAPSA200  MATCH     SP70,APMASA2
          IF        @EQUAL
            MOVE      APMACA2,APMASA2
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASA2
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASA2
          GOTO      KAPSA290 IF EQUAL
.
          MOVE      TWO,SUBKYLIN
          PACK      IBAADLN2,APMASA2,SP30,SP30
          PACK      IBAADLN3,APMASA3,SP30,SP30
          PROC      AUTOPCOD
          BRANCH    EXIT,KAPSA200,KAPSA250
.
          MOVE      IBAPCOD,APMASPC
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASPC,VAR
            CALL      DISPITEM
          ENDIF
          MOVE      "    5",FLDID
          CALL      GETPOSIT
KAPSA250  MOVE      ZERO,EXIT
          GOTO      KAPSA299
.
KAPSA290  MOVE      TWO,EXIT
.
KAPSA299  RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Address Line 3
.----------------------------------------------------------------------
KAPSA300  MATCH     SP70,APMASA3
          IF        @EQUAL
            MOVE      APMACA3,APMASA3
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASA3
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASA3
          GOTO      KAPSA390 IF EQUAL
.
          MOVE      THREE,SUBKYLIN
          PACK      IBAADLN2,APMASA2,SP30,SP30
          PACK      IBAADLN3,APMASA3,SP30,SP30
          PROC      AUTOPCOD
          BRANCH    EXIT,KAPSA300,KAPSA350
.
          MOVE      IBAPCOD,APMASPC
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASPC,VAR
            CALL      DISPITEM
          ENDIF
          MOVE      "    6",FLDID
          CALL      GETPOSIT
KAPSA350  MOVE      ZERO,EXIT
          GOTO      KAPSA399
.
KAPSA390  MOVE      TWO,EXIT
.
KAPSA399  RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Post Code
.----------------------------------------------------------------------
KAPSPC00  MATCH     SP70,APMASPC
          IF        @EQUAL
            MOVE      APMACPC,APMASPC
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASPC
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASPC
          IF        @EQUAL
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Telephone
.----------------------------------------------------------------------
KAPSTE00  MATCH     SP70,APMASTEL
          IF        @EQUAL
            MOVE      APMACTEL,APMASTEL
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASTEL
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASTEL
          IF        @EQUAL
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Fax
.----------------------------------------------------------------------
KAPSFA00  MATCH     SP70,APMASFAX
          IF        @EQUAL
            MOVE      APMACFAX,APMASFAX
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASFAX
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASFAX
          IF        @EQUAL
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Contact
.----------------------------------------------------------------------
KAPSCO00  MATCH     SP70,APMASCON
          IF        @EQUAL
            MOVE      APMACON,APMASCON
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASCON
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASCON
          IF        @EQUAL
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Name 1
.----------------------------------------------------------------------
KAPSN100  MATCH     SP70,APMASN1
          IF        @EQUAL
            MOVE      APMACN1,APMASN1
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASN1
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASN1
          IF        @EQUAL
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.
.----------------------------------------------------------------------
. Keyin Supplier Name 2
.----------------------------------------------------------------------
KAPSN200  MATCH     SP70,APMASN2
          IF        @EQUAL
            MOVE      APMACN2,APMASN2
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,APMASN2
          MOVE      ZERO,EXIT
          CMATCH    EXITCHAR,APMASN2
          IF        @EQUAL
            MOVE      TWO,EXIT
          ENDIF
          RETURN
.
.----------------------------------------------------------------------
. Cancel Creditors Maintenance
.----------------------------------------------------------------------
CANCL000  MOVE    APMACRD,KEY5
          CALL    RAAPMA1
          BRANCH  OVRCD,CANCL100
          CALL    UUAPMA1
          CALL    DAAPMA00    * Delete Before Audit
          GOTO    CANCL999
.
CANCL100  PACK    KEY35,APMACRD,SP70
          CALL    RSAPMX2
CANCL200  CALL    RKAPMX2
          BRANCH  OVRCD,CANCL999
          MATCH   APMACRD,APMXCRD
          GOTO    CANCL999 IF NOT EQUAL
          PACK    KEY35,APMXCRD,APMXREF
          CALL    DEAPMX2
          GOTO    CANCL200
.
CANCL999  RETURN
.
.----------------------------------------------------------------------
. Post Creditor Details
.----------------------------------------------------------------------
WAPMA000  MOVE     APMACRD,KEY5
          CALL     RAAPMA1
          IF       OVRCD=0
            CALL     UPAPMA1
            CALL     UUAPMA1
            MOVE     THREE,AUDTTYPE
            CALL     WAAPMA00
          ELSE
            MOVE     ZERO,APMAPPT
            MOVE     ZERO,APMAPOT
            CALL     WRAPMA1
            MOVE     ONE,AUDTTYPE
            CALL     WAAPMA00
          ENDIF
          PACK     KEY35,APMACRD,SP70
          CALL     RSAPMX2
.
WAPMA400  CALL     RKAPMX2
          BRANCH   OVRCD,WAPMA500
          MATCH    APMXCRD,APMACRD
          GOTO     WAPMA500 IF NOT EQUAL
          MATCH    "1",APMXTYP
          IF       @EQUAL
            PACK     KEY35,APMXCRD,APMXREF
            CALL     DEAPMX2
          ENDIF
          MATCH    "2",APMXTYP
          IF       @EQUAL
            PACK     KEY35,APMXCRD,APMXREF
            CALL     DEAPMX2
          ENDIF
          GOTO     WAPMA400
.
WAPMA500  MOVE     APMACRD,APMXCRD
          MOVE     APMACN1,APMXREF
          MOVE     ONE,APMXTYP
          MOVE     SP70,APMXSPA
          PACK     KEY35,APMXCRD,APMXREF
          MATCH    SP70,APMXREF
          GOTO     WAPMA510 IF EQUAL
          CALL     RAAPMX2
          IF       OVRCD=1
            CALL     WRAPMX2
          ENDIF
.
WAPMA510  MOVE     APMACRD,APMXCRD
          MOVE     APMASN1,APMXREF
          MOVE     TWO,APMXTYP
          MOVE     SP70,APMXSPA
          PACK     KEY35,APMXCRD,APMXREF
          MATCH    SP70,APMXREF
          GOTO     WAPMA520 IF EQUAL
          CALL     RAAPMX2
          IF       OVRCD=1
            CALL     WRAPMX2
          ENDIF
.
WAPMA520  PROC      APSCKIUP
.
          PACK      KEY8,APMACRD,SP70
          CALL      RSAPCN1
.
WAPMA800  CALL      RKAPCN1
          BRANCH    OVRCD,WAPMA850
          MATCH     APMACRD,APCNCRD
          GOTO      WAPMA850 IF NOT EQUAL
          PACK      KEY8,APCNCRD,APCNLIN
          CALL      DEAPCN1
          GOTO      WAPMA800
.
WAPMA850  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPCN1
          TRAPCLR   IO
          BRANCH    OVRCD,WAPMA890
          MOVE      ZERO,F3
.
WAPMA860  READ      TEMPWORD,SEQ;APCNDAT
          GOTO      WAPMA890 IF OVER
          MOVE      F3,APCNLIN
          PACK      KEY21,APMACRD,APCNLIN
          UNPACK    KEY21,APCNCRD,APCNLIN
          CALL      WRAPCN1
          ADD       ONE,F3
          GOTO      WAPMA860
.
WAPMA890  PACK      KEY8,APMACRD,SP70
          CALL      RSAPSN1
.
WAPMA900  CALL      RKAPSN1
          BRANCH    OVRCD,WAPMA950
          MATCH     APMACRD,APSNCRD
          GOTO      WAPMA950 IF NOT EQUAL
          PACK      KEY8,APSNCRD,APSNLIN
          CALL      DEAPSN1
          GOTO      WAPMA900
.
WAPMA950  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          BRANCH    OVRCD,WAPMA999
          MOVE      ZERO,F3
.
WAPMA960  READ      TEMPWORD,SEQ;APSNDAT
          GOTO      WAPMA999 IF OVER
          MOVE      F3,APSNLIN
          PACK      KEY21,APMACRD,APSNLIN
          UNPACK    KEY21,APSNCRD,APSNLIN
          CALL      WRAPSN1
          ADD       ONE,F3
          GOTO      WAPMA960
.
WAPMA999  RETURN
.
.----------------------------------------------------------------------
. Clear Cross Reference Field
.----------------------------------------------------------------------
MAPMX000  MOVE     SP70,APMXREF
          RETURN
.
.----------------------------------------------------------------------
. Write Cross Reference Field
.----------------------------------------------------------------------
WAPMX000  PACK      KEY35,APMACRD,SP70
          CALL      RDAPMX2
          IF        OVRCD=0
            PACK      KEY35,APMXCRD,APMXREF
            CALL      DEAPMX2
          ENDIF
.
WAPMX100  CALL      RKAPMX2
          BRANCH    OVRCD,WAPMX200
          MATCH     APMACRD,APMXCRD
          GOTO      WAPMX200 IF NOT EQUAL
          MATCH     "1",APMXTYP
          GOTO      WAPMX100 IF EQUAL
          MATCH     "2",APMXTYP
          GOTO      WAPMX100 IF EQUAL
          PACK      KEY35,APMXCRD,APMXREF
          CALL      DEAPMX2
          GOTO      WAPMX100
.
WAPMX200  MOVE      SP70,KEY5
          CALL      TRAPMX21
          COMPARE   ZERO,OVRCD
          GOTO      WAPMX310 IF EQUAL
.
WAPMX300  CALL      TKAPMX21
          BRANCH    OVRCD,WAPMX400
.
WAPMX310  PACK      KEY35,APMACRD,APMXREF
          UNPACK    KEY35,APMXCRD,APMXREF
          MOVE      THREE,APMXTYP
          MATCH     SP70,APMXREF
          GOTO      WAPMX300 IF EQUAL
          CALL      RAAPMX2
          IF        OVRCD=1
            CALL      WRAPMX2
          ENDIF
          GOTO      WAPMX300
.
WAPMX400  PROC      APSCKIUP
.
WAPMX999  RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSCKIKY    
          INC       APSCKIPR    
          INC       APSCNTIO/INC
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
          INC       APSSNTIO/INC
          INC       AUTOPCOD    
          INC       IBASEQIO/INC
          INC       TFILENAM    
          INC       WEBERRIO/INC
.
          INC       STDGENCD
.
