.******************************************************************************
.* System    :   Patient                                                      *
.* Program   :   IBABIL54                                                     *
.* Desc      :   SA Health Department Transmission                            *
.******************************************************************************
.* Date      :   12/05/1999                                                   *
.* Author    :   Jill Habasque                                                *
.* Mods      :                                                                *
.******************************************************************************
.*        V12.00.04 28/07/2025  Alina Bhari    TSK  0961700                   *
.*                  Added the DOYR2025 in SA correction while writing record  *
.*                  - WRIC0000                                                *
.*        V12.00.03 17/07/2025  Alina Bhari    TSK  0961700                   *
.*                  Corrected the item num length with new variable XITEMNMN  *
.*                  DOYR2025 Changes - DOYR2025,WRIT8000,SDAT0000,MAST8000,   *
.*                  VALD7400,ITNO0000,ECDA0000,ECDA2400,WRIC0000,READ0000     *
.*                  Added Diagnosis Cluster Identifier for Principal Diagnosis*
.*                  -XDCIDFPD                                                 *
.*                  Added Diagnosis Cluster Identifier for Additional         *
.*                  Diagnosis- COUNTCAD,MRTCONFD,XDCAD001-XDCAD099,TEMPDCID   *
.*                  -SAVEKEY5,DCFLAGEC,XPDCIFEC                               *
.*                  Added Diagnosis Cluster Identifier for Place of Occurrence*
.*                  - DCFLAGPC, XPDCIFPP                                      *
.*                  Added Diagnosis Cluster Identifier for Activity When      *
.*                  Injured - DCFLAGWI,XPDCIFAJ                               *
.*        V12.00.01 11/06/2025  Ebon Clements   TSK 0961623                   *
.*                  Alphanueric visit number changes                          *
.*        V12.00.01 30/05/2025  Jacob Jackson  TSK  0955096                   *
.*                  Alphanumeric changes                                      *
.*        V11.03.03 11/08/2023  Thanh T        TSK  0934891                   *
.*                  When Gender HDP code is not "1 2 3 4 5 9", write out      *
.*                  an error message and blank out the data in extract file   * 
.*        V11.03.02 31/07/2023  Thanh T        TSK  0934891                   *
.*                  July 2023 changes                                         *
.*        V11.03.01 31/03/2023  Sunny          TSK  0930287                   *
.*                  Fixed validation in VALD7200 for Funding Source           *
.******************************************************************************
.*        V11.02.03 15/08/2022  Jacob Jackson  TSK  0918354                   *
.*                  Remove specific ACLAIM check for 'PBC', and check all of  *
.*                  CATCL claims for Ind 7 equalling 2                        *
.*        V11.02.02 02/08/2022  Jacob Jackson  TSK  0918354                   *
.*                  Check if Cat CL, Ind 7 value is equal to 2 for Insurance  *
.*                  Status Check                                              * .*        V11.02.01 26/04/2022  Jill Parkinson Task 0918492                   *
.*                  July 2022 changes                                         *
.*        V11.01.02 11/10/2021  Davin          TSK 0908094                    *
.*                  Use new field XHMECVNW for mech ven hours after 01/07/2021*
.*        V11.01.01 11/06/2021  Davin          TSK 0907385                    *
.*                  Check fnameb/filename values to stop I*N (failed PID) when*
.*                  exiting program at ml9000                                 *
.******************************************************************************
.*        V11.00.06 02/06/2020  Jill Parkinson Task 0892648                   *
.*                  Changed start date to be 01072020                         *
.*        V11.00.05 28/04/2020  Tracey Nguyen  TSK 0889020                    *
.*                  Increased length of NUMOPER,NUMDIAG,COUNT2 from FORM 2    *
.*                  to FORM 3                                                 *
.*        V11.00.04 28/04/2020  Tracey Nguyen  TSK 0889020                    *
.*                  1)Fixed duplicate write of XPROC032 and missing XPROC033  *
.*                    WRIT2000                                                *
.*                  2)Added missing XPROCLU - ECOA0000                        *
.*        V11.00.03 27/04/2020  Tracey Nguyen  TSK 0889020                    *
.*                  Statutory Changes for July 2020                           *
.*                  Fixed storing issue at XOTHCO64/XONSTO64/SOTHCO64         *
.*                  - ECDA0000                                                *
.*                  Fixed duplicate write of XOTHCO26/XONST026                *
.*                  and XPROC038/XPROCL038 - WRIT2000                         *
.*        V11.00.02 27/04/2020  Tracey Nguyen  TSK 0889020                    *
.*                  Statutory Changes for July 2020                           *
.*                  1)Added TEMP1G for extract file layout                    *
.*                  2)Added additional diagnosis 25-99 XOTHCO25-99,XONSTO25-99*
.*                  3)Added procedure 25-99 XPROC025-99,XPRCL025-99           *
.*                  4)Added XSUBURBL - Surburb                                *
.*                  5)Added DOYR2020                                          *
.*        V11.00.01 04/03/2020  J.Tan          TSK 0838262                    *
.*                  Added Effective from and to date to MBS Item file         *
.*                  10/03/2020  Jill Parkinson Task 0879163                   *
.*                  Added include SEXDSCIO                                    *
.*        V10.15.02 15/01/2020  Tracey Nguyen  TSK 0887026                    *
.*                  Removed 'GOTO VIST1000' in VIST2000 to fix incorrect      *
.*                  OLDDVAS causing error 4521                                *
.*        V10.15.01 18/11/2019  Thanh T.       TSK 0884341                    *
.*                  Changed VALD0000 to call RDPTICD1 instead of RDPT10D1     *
.*                  to get the correct ICD10 details based on discharge date  *
.******************************************************************************
.*        V10.14.01 03/10/2019  Sunny          TSK 0881832                    *
.*                  Added RDPMPX21 to read master extension for               *
.*                  XRACE in MAST0000                                         *
.******************************************************************************
.*        V10.13.01 05/12/2018  Don Nguyen     TSK 0838558                    *
.*                  Deleted temp files (TEMP1F, TEMP2, TEMP3) on program exit *
.*        V10.12.01 08/02/2018  Ken Bell       TSK 0853265                    *
.*                  2018 Update, Edit 4295 to include Burn Codes up L550-L559 * 
.*        V10.11.01 01/12/2017  Richa Phogat   TSK 0845275                    *
.*                  Updated fields XPREFLNG, XRELGAFF to display zeros insated*
.*                  of spaces in the output file                              *
.*        V10.10.02 16/03/2017  Richa Phogat   TSK 0832066                    *
.*                  Changed DVA Card Number and DVA Card colour to be         *
.*                  collected from PMCDCNUM.PMSCCDFD and PMCDDVAC.PMSPX2FD    *
.*                  instead of PREPAT.PMIMA1FD and PMPXDVAC.PMIMA1FD          *
.*        V10.10.01 08/03/2017  Jill Parkinson TK 0833212                     *
.*                  July 2017 changes - added blank Interpreter required,     *
.*                  Religious Affiliation and Preferred Language              *
.*        V10.08.02 26/09/2016  J.Tan          TSK 0319922                    *
.*                  Mods to default 'Move extract to web directory' to Yes    *
.*        V10.08.01 05/04/2016  Don Nguyen     TSK 0814715                    *
.*                  July 2016 Changes - new edits #2745 and #4051             *
.*        V10.06.01 04/05/2015 Jill Parkinson  CAR 312726                     *
.*                  July 2015 Changes                                         *
.*        V10.05.03 16/12/2014  Ebon Clements  CAR 304316                     *
.*                  Populate clinic code XCLINCOD using the HDP of the unit   *
.*                  ACLSSFT cat AC - ADMI1000                                 *
.*        V10.05.02 24/09/2014  Ebon Clements  CAR 304361                     *
.*                  Changed to report transfer from hospital if HDP of the    *
.*                  admission source is a 4 - DSCH1000                        *
.*        V10.05.01 23/09/2014  Davin          CAR 305188 / 302063            *
.*                  Mods to stop blank diagnoses in ecda0000 (count2/numdiag) *
.*                  Fixed onset type code in writ0000                         *
.*                  Force send of '0000' if Cat.C associated number = 0       *
.*        V10.04.05 03/04/2014  Don Nguyen     CAR 299560                     *
.*                  Modified GETDL100 to zero fill XDTTODL & XTTTODL          *
.*        V10.04.04 13/03/2014  J.Tan          CAR 296833                     *
.*                  Mods for 2014 changes                                     *
.*        V10.04.03 07/02/2014  Peter Vela     CAR 296498                     *
.*                  Added multi hospital to corrections option                *
.*        V10.04.02 05/02/2014  Peter Vela     CAR 296498                     *
.*                  Added multi hospital                                      *
.*        V10.03.06 23/12/2013  Jill Parkinson CAR 292889                     *
.*                  Fixed Medicare ref                                        *
.*        V10.03.05 23/05/2013  Jill Parkinson CAR 283280                     *
.*                  July 2013 changes - Medicare ref, prev specialised treatmn*
.*        V10.03.04 22/05/2012  Jill Parkinson CAR 265724                     *
.*                  July 2012 changes - Referral for further care increased   *
.*        V10.03.03 23/02/2012  Ebon Clements  CAR 237112                     *
.*                  Added print of no errors line if report has no errors     *
.*        V10.03.02 02/12/2011  Mike Laming    CAR 253541                     *
.*                  Correct edits 4521 & 4206 when there is no previous visit *
.*        V10.03.01 18/11/2011  Mike Laming     CAR 240184                    *
.*                  Changes to IBAPOSTF Post Code table - added State to Keys *
.*        V10.02.04 31/10/2011  Mike Laming    CAR 250267                     *
.*                  Correct vars for changed length of PTICUMEC at ICUD0000   *
.*        V10.02.03 08/06/2011 Saroeun Soeur  CAR 242752                      *
.*                  remove check to PATWVETF file and used DVA from PMI       *
.*                  ADMI2000                                                  *
.*        V10.02.02 28/04/2011 Jill Parkinson CAR 241497                      *
.*                  July 2011 changes - added edits 2301,2302,4521 and 4206   *
.*        V10.02.01 28/03/2011  Mike Laming   CAR 240107                      *
.*                  Mods to PATECDaf & PATECOaf variables & Keys - file change*
.*        V10.01.01 06/07/2010 Jill Parkinson CAR 225495                      *
.*                  Fixed form 5 paticuaf fields                              *
.*        V10.00.02 27/04/2010 Jill Parkinson CAR 204546                      *
.*                  Fixed 4950 error                                          *
.*        V10.00.01 12/04/2010 Jill Parkinson CAR 219469                      *
.*                  July 2010 mods                                            *
.*        V9.12.02  19/01/2010 Jill Parkinson CAR 208267                      *
.*                  Mods to clear blokno and squeeze pt0oblkn                 *
.*        V9.12.01  17/12/2009 Jill Parkinson CAR 207126                      *
.*                  Hours in ICU should be zero filled                        *
.*                  17/12/2009 Jill Parkinson CAR 209509                      *
.*                  Fixed error messages for #4000 and #4820                  *
.*        V9.11.02  14/04/2009  Mike Laming   CAR 194211                      *
.*                  Correct Hospital Transfers (from/to) at DSCH1000,VALD7300 *
.*                  Correct PT0DACRQ="P" or "A" creating duplicates @ ECDA2444*
.*        V9.11.01  14/11/2008 Sandra Barcham CAR 183421                      *
.*                  Hours of mechanical ventilation is blank should be 0000   *
.*        V9.10.03  09/09/2008  Jill Habasque CAR 177933                      *
.*                  Mods to not replace " 0" for onset codes                  *
.*        V9.10.02  16/06/2008  Jill Habasque CAR 166315                      *
.*                  Added place of occurence, activity and ext cause onset    *
.*        V9.10.01  18/04/2008  Jill Habasque CAR 166315                      *
.*                  July 2008 changes                                         *
.*                  31/04/2008 Sandra Barcham CAR 166315                      *
.*                  Fixed SLA to use ibapostf                                 *
.*        V9.09.01  31/08/2007 Sandra Barcham CAR 150561                      *
.*                  Fixed SLA & Country of Birth                              *
.*                  Fixed Procedures and Diagnosis                            *
.*        V9.08.03  23/05/2007 Jill Habasque  CAR 140785                      *
.*                  July 2007 Mods                                            *
.*        V9.08.02  20/04/2007 Jill Habasque  CAR 139025                      *
.*                  Mods to use PTVANHSC if populated                         *
.*        V9.08.01  09/02/2007  Janet George  CAR 130263                      *
.*                  Changed parameters PTCNUREA,PTCNEMPL,PTCNPPPT,PTCNOCCP    *
.*                  PTCNASUT,PTCNVETR,PTCNCSTA to values from Patient         *
.*                  Visit Extension File (pmsvx1af) and PMI Extension File    *
.*        V9.08.00  11.01.2007  Janet George  CAR 130263                      *
.*                  Ported from V6 to V9                                      *
.*        V6.14.02  20/06/2006  Mike Laming   CAR 108284  ISAAC SA 2006       *
.*                  2006 changes for SA HD - ISAAC                            *
.*        V6.14.01  29/05/2006  Mike Laming   CAR 105249    2006 HCP          *
.*                  Change Size & Position of PTCNUREA                        *
.*        V6.13.05  31/10/2005  Peter Vela    CAR 80571                       *
.*                  Default 3 into mental health legal status if not collected*
.*                  ADMI8010
.*                  Added validation for mental health legal status VALD7300  *
.*        V6.13.04  27/10/2005  Mike Laming   CAR 76098                       *
.*                  Increase PTCNPPPT to 1 - 9 (which AUSR for Election Stat) *
.*                  Add 8=PTMIUS10(V1) & 9=PTMIUS11(V2)                       *
.*        V6.13.03  15/09/2005  Peter Vela    CAR 76176                       *
.*                  Added subtraction of leavedays from total number of       *
.*                  hospital days VALD6000                                    *
.*        V6.13.02  22/07/2005  Mike Laming   CAR 68513                       *
.*                  Correct date test at VALD6000 for > 35 days               *
.*        V6.13.01  14/06/2005  Mike Laming   CAR 60344                       *
.*                  HDP Changes 2005 - SA HDP - ISAAC - finalise as below     *
.*        V6.12.02  26/05/2005  Mike Laming   CAR 60344                       *
.*                  HDP Changes 2005 - SA HDP - ISAAC - edits added at VALD6000
.*                  Changed VALD6000 (and subsequent labels) to VALD7000      *
.*                  Fixed "Item No." display at ITQU0000                      *
.*                  Added Option 3 to display SA HDP Items - DSPL0000         *
.*        V6.12.01  01/09/2004  Peter Vela    CAR 52873                       *
.*                  Fixed duplication of additional diagnosis in Place of     *
.*                  Occurance and Activity when Injured                       *
.*        V6.12.00  17/05/2004  Mike Laming   CAR 49016                       *
.*                  July 2004 PRS/2 - changed to use sex routine SEXDSC00     *
.*        V6.10.05  04/06/2003  CAR 38106   Steve Downing                     *
.*                  2003 Stat changes, mods to Indigenous & Admiss Categories *
.*        V6.10.04  14/04/2003  Guomin Fu CAR 38019                           *
.*                  Fixed External Cause and sporting codes in SA HDP         *
.*                  Extract having decimal point in this field                *
.*        V6.10.03  28/06/2002  Davin  2002/2003 changes                      *
.*                  Fixed some more rebounds                                  *
.*        V6.10.02  21/06/2002  Davin  2002/2003 changes                      *
.*                  Fixed some rebounds                                       *
.*        V6.10.01  21/06/2002  Davin  2002/2003 changes                      *
.*                  Recompiled for change to date 20020701                    *
.******************************************************************************
.*        V6.09.03  06/06/2002  Davin  2002/2003 changes                   *
.*                  Recompiled for change to paticuaf                      *
.*        V6.09.02  20/05/2002  Tonii  July 2002/2003 HDP mods             *
.*                  - Added 2 new item fields                              *
.*                     - Place of Occurence Code (XPLCEOCC)                *
.*                     - Activity Code (XACTVITY)                          *
.*                  - Added in validation for Unplanned Readmission for    *
.*                    private hospitals only                               *
.*        V6.09.01  21/06/2001  Steve Downing                              *
.*                  Added Funding source, mods to patient type, country of *
.*                  birth, Medicare default, removed ICU classification    *
.*        V6.09.B01 23/02/2001  Jill Habasque                              *
.*                  Mods for ABWGHT - changes to unpack into 4 characters  *
.*        V6.07.05  06/10/2000  Steve Downing                              *
.*                  Fixed hospital transferred to                          *
.*        V6.07.04  20/09/2000  Steve Downing                              *
.*                  Mods to include Indeterminate sex                      *
.*        V6.07.03  18/09/2000  Jill Habasque                              *
.*                  Changed to use 6,7 and 8 as external cause (PT0DACRQ)  *
.*        V6.07.02  01/09/2000  Steve Downing                              *
.*                  Print error for invalid sex type                       *
.*        V6.07.01  16/05/2000  Tonii                                      *
.*                  Added new subroutine VALD6000, to check for valid EOC  *
.*                  code. Subroutine executed only after July 1st          *
.*        V6.07.B03 11/02/2000  J Habasque                                 *
.*                  Fixed ICD9 external cause codes                        *
.*        V6.07.B02 02/02/2000  Greg Horvat                                *
.*                  Changed to get the coding from the episode coding files*
.*        V6.06.17  19/01/2000  J Habasque                                 *
.*                  Mods to send ICD9 codes if pre July 99                 *
.*        V6.06.16  09/12/1999  J Habasque                                 *
.*                  Changed XITEMNUM to be left justified                  *
.*        V6.06.15  23/11/1999  J Habasque                                 *
.*                  Fixed correction records when no item no. entered      *
.*        V6.06.14  19/11/1999  Jill Habasque                              *
.*                  Mods to correction records                             *
.*        V6.06.13  17/11/1999  Jill Habasque                              *
.*                  Mods to only pick up DVA if Cat CL HDP = 7             *
.*        V6.06.12  12/11/1999  Jill Habasque                              *
.*                  Fixed Hospital transferred from and to                 *
.*        V6.06.11  05/11/1999  Jill Habasque  SRF 635582                  *
.*                  Fixed PTCNDSCI to use Cat P                            *
.*        V6.06.10  29/10/1999  Greg Horvat                                *
.*                  Recompiled for changes to PATIOICD & PATIOICO          *
.*        V6.06.09  08/10/1999  Jill Habasque  SRF 635108                  *
.*                  Added default of 3 for unplanned readmission & PTCNPPPT*
.*        V6.06.08  29/09/1999  Jill Habasque  SRF 634965                  *
.*                  Zero filled fields                                     *
.*        V6.06.07  13/09/1999  Jill Habasque                              *
.*                  Added .ack file for the number of records              *
.*        V6.06.06  08/09/1999  Jill Habasque                              *
.*                  Fixed Z37 error message                                *
.*        V6.06.05  30/08/1999  Jill Habasque                              *
.*                  Added TCINDC6 for categ. CL (do not send if equal to 1)*
.*        V6.06.04  23/08/1999  Jill Habasque                              *
.*                  Changed unplanned readmission to be 2nd char of HDP    *
.*        V6.06.03  10/08/1999  Jill Habasque SRF 633582                   *
.*                  Changed External Cause to be V,W,X & Y                 *
.*        V6.06.02  22/07/1999  Jill Habasque                              *
.*                  Fixed I*C                                              *
.*        V6.06.01  Jill Habasque                                          *
.*                  Changed insurance status,admission election & type     *
.***************************************************************************
.
          INC       STD001FD
.
. File Description Includes
. -------------------------
          INC       IBAPOSFD/INC 
          INC       PMSCCDFD/INC
          INC       PATCT1FD/INC 
          INC       PATCMPFD/INC
          INC       PATCODFD/INC            * Codes file
          INC       PATCONFD/INC            * Control file
          INC       PATDADFD/INC            * Transfer destination file
          INC       PATVADFD/INC            * Transfer destination file
          INC       PATHSPFD/INC            * Hospital File
          INC       PATDSCFD/INC            * Discharge file
          INC       PATECDFD/INC            * Patient episode disease file
          INC       PATECOFD/INC            * Patient episode operation file
          INC       PATICDFD/INC            * ICD9 file
          INC       PATICOFD/INC            * ICD9 Operation file
          INC       PATICUFD/INC            * ICU file
          INC       PATITMFD/INC            * MBS Item file            *I-60344
          INC       PATMA1FD/INC            * Master File
          INC       PATMI1FD/INC            * Admission file
          INC       PMSVX1FD/INC            * Visit Extension File 
          INC       PMSPX2FD/INC            * PMI Extension File
          INC       PATSAIFD/INC            * SA Item file
          INC       PATTRNFD/INC            * Tran file
          INC       PATVISFD/INC            * Visit file
          INC       PATWVEFD/INC            * Veterans affairs
          INC       PATWR1FD/INC
          INC       MRTCONFD/INC
.
. Temporary File Definition from 01/07/2017
. -----------------------------------------
.
TEMP1F    FILE ASCII,   FIXED=756
.
.NAME     TYPE    LENGTH     START     DESCRIPTION
.----     ----    ------     -----     -----------
XRECTYP  DIM        1         1       "2"=New Submission
XHOSCOD  DIM        4         2       Hospital Code
XURNO    DIM       10         6       UR Number
XSEX     DIM        1        16       Patients Sex
XMARSTAT DIM        1        17       Marital Status
XCLINCOD DIM        3        18       Clinic Code
XADMNO   DIM        8        21       Admission Number
XMEDI    DIM       10        29       Medicare Number
XMEDIIRN DIM        1        39       Medicare Number
XLGA     DIM        4        40       LGA
XSUBURB  DIM       20        44       Suburb
XPOSTCOD DIM        4        64       Post Code
XCOUNTRY DIM        4        68       Country of Birth
XRACE    DIM        1        72       Race
XPBDATE  DIM        8        73       Date of Birth
XPACLSS  DIM        1        81       Patient Category
XSASRCE  DIM        1        82       Source of Referral
XADATE   DIM        8        83       Admission Date
XADELEC  DIM        1        91       Admission Election
XATYPE   DIM        1        92       Admission Type
XSTCHGD1 DIM        8        93       Status Change 1 - Date effective from
XSTCHGE1 DIM        1       101       Status Change 1 - Admission election
XSTCHGA1 DIM        1       102       Status Change 1 - Admission type
XSTCHGD2 DIM        8       103       Status Change 2 - Date effective from
XSTCHGE2 DIM        1       111       Status Change 2 - Admission election
XSTCHGA2 DIM        1       112       Status Change 2 - Admission type
XSTCHGD3 DIM        8       113       Status Change 3 - Date effective from
XSTCHGE3 DIM        1       121       Status Change 3 - Admission election
XSTCHGA3 DIM        1       122       Status Change 3 - Admission type
XVETCARD DIM        1       123       Veteran Card
XVETNUM  DIM        9       124       Veteran Card Number
XINSSTAT DIM        1       133       Insurance Status
XSEPDATE DIM        8       134       Separation Date
XREFFC   DIM        2       142       Referral for Further Care
XNATSEP  DIM        1       144       Nature of Separation
XHTRANTO DIM        4       145       Hospital Transferred to
XPRICON  DIM        5       149       Principal Condition Treated
XPRICONO DIM        1       154       Principal Condition Onset Flag
XOTHCO1  DIM        5       155       Other Conditions/complications 1
XONSTO1  DIM        1       160       Other Conditions onset 1
XOTHCO2  DIM        5       161       Other Conditions/complications 2
XONSTO2  DIM        1       166       Other Conditions onset 2
XOTHCO3  DIM        5       167       Other Conditions/complications 3
XONSTO3  DIM        1       172       Other Conditions onset 3
XOTHCO4  DIM        5       173       Other Conditions/complications 4
XONSTO4  DIM        1       178       Other Conditions onset 4
XOTHCO5  DIM        5       179       Other Conditions/complications 5
XONSTO5  DIM        1       184       Other Conditions onset 5
XOTHCO6  DIM        5       185       Other Conditions/complications 6
XONSTO6  DIM        1       190       Other Conditions onset 6
XOTHCO7  DIM        5       191       Other Conditions/complications 7
XONSTO7  DIM        1       196       Other Conditions onset 7
XOTHCO8  DIM        5       197       Other Conditions/complications 8
XONSTO8  DIM        1       202       Other Conditions onset 8
XOTHCO9  DIM        5       203       Other Conditions/complications 9
XONSTO9  DIM        1       208       Other Conditions onset 9
XOTHCO10 DIM        5       209       Other Conditions/complications 10
XONSTO10 DIM        1       214       Other Conditions onset 10
XOTHCO11 DIM        5       215       Other Conditions/complications 11
XONSTO11 DIM        1       220       Other Conditions onset 11
XOTHCO12 DIM        5       221       Other Conditions/complications 12
XONSTO12 DIM        1       226       Other Conditions onset 12
XOTHCO13 DIM        5       227       Other Conditions/complications 13
XONSTO13 DIM        1       232       Other Conditions onset 13
XOTHCO14 DIM        5       233       Other Conditions/complications 14
XONSTO14 DIM        1       238       Other Conditions onset 14
XOTHCO15 DIM        5       239       Other Conditions/complications 15
XONSTO15 DIM        1       244       Other Conditions onset 15
XOTHCO16 DIM        5       245       Other Conditions/complications 16
XONSTO16 DIM        1       250       Other Conditions onset 16
XOTHCO17 DIM        5       251       Other Conditions/complications 17
XONSTO17 DIM        1       256       Other Conditions onset 17
XOTHCO18 DIM        5       257       Other Conditions/complications 18
XONSTO18 DIM        1       262       Other Conditions onset 18
XOTHCO19 DIM        5       263       Other Conditions/complications 19
XONSTO19 DIM        1       268       Other Conditions onset 19
XOTHCO20 DIM        5       269       Other Conditions/complications 20
XONSTO20 DIM        1       274       Other Conditions onset 20
XOTHCO21 DIM        5       275       Other Conditions/complications 21
XONSTO21 DIM        1       280       Other Conditions onset 21
XOTHCO22 DIM        5       281       Other Conditions/complications 22
XONSTO22 DIM        1       286       Other Conditions onset 22
XOTHCO23 DIM        5       287       Other Conditions/complications 23
XONSTO23 DIM        1       292       Other Conditions onset 23
XOTHCO24 DIM        5       293       Other Conditions/complications 24
XONSTO24 DIM        1       298       Other Conditions onset 24
XPPROCA  DIM        7       299       Principal Procedure A
XPPROCLA DIM        1       306       Principal Procedure Location A
XPROCB   DIM        7       307       Procedure B
XPROCLB  DIM        1       312       Procedure Location B
XPROCC   DIM        7       315       Procedure C
XPROCLC  DIM        1       322       Procedure Location C
XPROCD   DIM        7       323       Procedure D
XPROCLD  DIM        1       330       Procedure Location D
XPROCE   DIM        7       330       Procedure E
XPROCLE  DIM        1       338       Procedure Location E
XPROCF   DIM        7       339       Procedure F
XPROCLF  DIM        1       346       Procedure Location F
XPROCG   DIM        7       347       Procedure G
XPROCLG  DIM        1       354       Procedure Location G
XPROCH   DIM        7       355       Procedure H
XPROCLH  DIM        1       362       Procedure Location H
XPROCI   DIM        7       363       Procedure I
XPROCLI  DIM        1       370       Procedure Location I
XPROCJ   DIM        7       371       Procedure J
XPROCLJ  DIM        1       378       Procedure Location J
XPROCK   DIM        7       379       Procedure K
XPROCLK  DIM        1       386       Procedure Location K
XPROCL   DIM        7       387       Procedure L
XPROCLL  DIM        1       394       Procedure Location L
XPROCM   DIM        7       395       Procedure M
XPROCLM  DIM        1       402       Procedure Location M
XPROCN   DIM        7       403       Procedure N
XPROCLN  DIM        1       410       Procedure Location N
XPROCO   DIM        7       411       Procedure O
XPROCLO  DIM        1       418       Procedure Location O
XPROCP   DIM        7       419       Procedure P
XPROCLP  DIM        1       426       Procedure Location P
XPROCQ   DIM        7       427       Procedure Q
XPROCLQ  DIM        1       434       Procedure Location Q
XPROCR   DIM        7       435       Procedure R
XPROCLR  DIM        1       442       Procedure Location R
XPROCS   DIM        7       443       Procedure S
XPROCLS  DIM        1       450       Procedure Location S
XPROCT   DIM        7       451       Procedure T
XPROCLT  DIM        1       458       Procedure Location T
XPROCU   DIM        7       459       Procedure U
XPROCLU  DIM        1       466       Procedure Location U
XPROCV   DIM        7       467       Procedure V
XPROCLV  DIM        1       474       Procedure Location V
XPROCW   DIM        7       475       Procedure W
XPROCLW  DIM        1       482       Procedure Location W
XPROCX   DIM        7       483       Procedure X
XPROCLX  DIM        1       490       Procedure Location X
XPROCY   DIM        7       491       Procedure Y
XPROCLY  DIM        1       498       Procedure Location Y
XEXTCAUS DIM        5       499       External Cause
XPLCEOCC DIM        5       504       Place of Occurance
XACTVITY DIM        5       509       Activity when Injured
XEOC     DIM        1       514       Episode of Care
XFUNDSRC DIM        2       515       Funding Source
XUNREAD  DIM        1       517       Unplanned Re-admission
XADMCAT  DIM        1       518       Admission Category
XCPURNO  DIM       10       519       Contract Provider hospital pat. unit num
XDACONPR DIM        8       529       Date admitted to contract provider hosp
XHOSPNUM DIM        4       537       Provider of contract services - hosp num
XLEAVFD1 DIM        8       541       Leave From Date 1
XLEAVFT1 DIM        4       549       Leave From Time 1
XLEAVTD1 DIM        8       553       Leave To Date 1
XLEAVTT1 DIM        4       561       Leave To Time 1
XLEAVFD2 DIM        8       565       Leave From Date 2
XLEAVFT2 DIM        4       573       Leave From Time 2
XLEAVTD2 DIM        8       577       Leave To Date 2
XLEAVTT2 DIM        4       585       Leave To Time 2
XLEAVFD3 DIM        8       589       Leave From Date 3
XLEAVFT3 DIM        4       597       Leave From Time 3
XLEAVTD3 DIM        8       601       Leave To Date 3
XLEAVTT3 DIM        4       609       Leave To Time 3
XLEAVFD4 DIM        8       613       Leave From Date 4
XLEAVFT4 DIM        4       621       Leave From Time 4
XLEAVTD4 DIM        8       625       Leave To Date 4
XLEAVTT4 DIM        4       633       Leave To Time 4
XADWGHT  DIM        4       637       Admission Weight (Grams)
XHICU    DIM        5       641       Hours in ICU
XHMECVEN DIM        4       646       Hours on Mechanical Ventilation
XLEGSTAT DIM        1       650       Legal Status
XADMTIME DIM        4       651       Admission Time
XSEPTIME DIM        4       655       Separation Time
XHTRANFR DIM        4       659       Hospital Transferred to
XMHLV    DIM       10       663       Mental Health Linking Variable
XOACISLV DIM       10       673       OACIS Linking Variable
XADUCHI  DIM        1       683       Adult/Child Flag
XPSYCAD  DIM        1       684       First Psychiatric Admission
XPREVSPC DIM        1       685       Prev Specialised Treatment (not collected)
XEMPSTAT DIM        1       686       Employment Status
XPENSTAT DIM        1       687       Pension Status
XUSUACC  DIM        1       688       Type of Usual Accomodation
XDOBACC  DIM        1       689       DOB Accuracy Flag
XDOFOTP  DIM        8       690       Date of first OT procedure
XTFOTP    DIM       4       698       Time of first OT procedure
XDISWARD  DIM       10       702       Discharge Ward
XEXTCONS  DIM        1       712       External Cause onset flag
XPLOCONS  DIM        1       713       Place of Occurence onset flag
XACTVONS  DIM        1       714       Activity onset flag
XDTTODL   DIM        8       715       Date transferred to discharge lounge
XTTTODL   DIM        4       723       Time transferred to discharge lounge
XADMWARD  DIM       10       727       Ward on admission
XRESITEM  DIM       10       737       Research Items
XPREFLNG  DIM       4        747       Preferred Language
XRELGAFF  DIM       4        751       Religious Affiliation
XINTREQD  DIM       1        755       Interpreter Required 
.
.End of Record               756
.


.*T0889020- File Definition from 01/07/2020
. -----------------------------------------
.
TEMP1G    FILE ASCII,   FIXED=1918
.
.NAME     TYPE    LENGTH     START     DESCRIPTION
.----     ----    ------     -----     -----------
.XRECTYP  DIM        1         1       "2"=New Submission
.XHOSCOD  DIM        4         2       Hospital Code
.XURNO    DIM       10         6       UR Number
.XSEX     DIM        1        16       Patients Sex
.XMARSTAT DIM        1        17       Marital Status
.XCLINCOD DIM        3        18       Clinic Code
.XADMNO   DIM        8        21       Admission Number
.XMEDI    DIM       10        29       Medicare Number
.XMEDIIRN DIM        1        39       Medicare Number
.XLGA     DIM        4        40       LGA
.XSUBURB  DIM       20        44       Suburb   - not in use initalize to blank
.XPOSTCOD DIM        4        64       Post Code
.XCOUNTRY DIM        4        68       Country of Birth
.XRACE    DIM        1        72       Race
.XPBDATE  DIM        8        73       Date of Birth
.XPACLSS  DIM        1        81       Patient Category
.XSASRCE  DIM        1        82       Source of Referral
.XADATE   DIM        8        83       Admission Date
.XADELEC  DIM        1        91       Admission Election
.XATYPE   DIM        1        92       Admission Type
.XSTCHGD1 DIM        8        93       Status Change 1 - Date effective from
.XSTCHGE1 DIM        1       101       Status Change 1 - Admission election
.XSTCHGA1 DIM        1       102       Status Change 1 - Admission type
.XSTCHGD2 DIM        8       103       Status Change 2 - Date effective from
.XSTCHGE2 DIM        1       111       Status Change 2 - Admission election
.XSTCHGA2 DIM        1       112       Status Change 2 - Admission type
.XSTCHGD3 DIM        8       113       Status Change 3 - Date effective from
.XSTCHGE3 DIM        1       121       Status Change 3 - Admission election
.XSTCHGA3 DIM        1       122       Status Change 3 - Admission type
.XVETCARD DIM        1       123       Veteran Card
.XVETNUM  DIM        9       124       Veteran Card Number
.XINSSTAT DIM        1       133       Insurance Status
.XSEPDATE DIM        8       134       Separation Date
.XREFFC   DIM        2       142       Referral for Further Care
.XNATSEP  DIM        1       144       Nature of Separation
.XHTRANTO DIM        4       145       Hospital Transferred to
.XPRICON  DIM        5       149       Principal Condition Treated
.XPRICONO DIM        1       154       Principal Condition Onset Flag
.XOTHCO1  DIM        5       155       Other Conditions/complications 1
.XONSTO1  DIM        1       160       Other Conditions onset 1
.XOTHCO2  DIM        5       161       Other Conditions/complications 2
.XONSTO2  DIM        1       166       Other Conditions onset 2
.XOTHCO3  DIM        5       167       Other Conditions/complications 3
.XONSTO3  DIM        1       172       Other Conditions onset 3
.XOTHCO4  DIM        5       173       Other Conditions/complications 4
.XONSTO4  DIM        1       178       Other Conditions onset 4
.XOTHCO5  DIM        5       179       Other Conditions/complications 5
.XONSTO5  DIM        1       184       Other Conditions onset 5
.XOTHCO6  DIM        5       185       Other Conditions/complications 6
.XONSTO6  DIM        1       190       Other Conditions onset 6
.XOTHCO7  DIM        5       191       Other Conditions/complications 7
.XONSTO7  DIM        1       196       Other Conditions onset 7
.XOTHCO8  DIM        5       197       Other Conditions/complications 8
.XONSTO8  DIM        1       202       Other Conditions onset 8
.XOTHCO9  DIM        5       203       Other Conditions/complications 9
.XONSTO9  DIM        1       208       Other Conditions onset 9
.XOTHCO10 DIM        5       209       Other Conditions/complications 10
.XONSTO10 DIM        1       214       Other Conditions onset 10
.XOTHCO11 DIM        5       215       Other Conditions/complications 11
.XONSTO11 DIM        1       220       Other Conditions onset 11
.XOTHCO12 DIM        5       221       Other Conditions/complications 12
.XONSTO12 DIM        1       226       Other Conditions onset 12
.XOTHCO13 DIM        5       227       Other Conditions/complications 13
.XONSTO13 DIM        1       232       Other Conditions onset 13
.XOTHCO14 DIM        5       233       Other Conditions/complications 14
.XONSTO14 DIM        1       238       Other Conditions onset 14
.XOTHCO15 DIM        5       239       Other Conditions/complications 15
.XONSTO15 DIM        1       244       Other Conditions onset 15
.XOTHCO16 DIM        5       245       Other Conditions/complications 16
.XONSTO16 DIM        1       250       Other Conditions onset 16
.XOTHCO17 DIM        5       251       Other Conditions/complications 17
.XONSTO17 DIM        1       256       Other Conditions onset 17
.XOTHCO18 DIM        5       257       Other Conditions/complications 18
.XONSTO18 DIM        1       262       Other Conditions onset 18
.XOTHCO19 DIM        5       263       Other Conditions/complications 19
.XONSTO19 DIM        1       268       Other Conditions onset 19
.XOTHCO20 DIM        5       269       Other Conditions/complications 20
.XONSTO20 DIM        1       274       Other Conditions onset 20
.XOTHCO21 DIM        5       275       Other Conditions/complications 21
.XONSTO21 DIM        1       280       Other Conditions onset 21
.XOTHCO22 DIM        5       281       Other Conditions/complications 22
.XONSTO22 DIM        1       286       Other Conditions onset 22
.XOTHCO23 DIM        5       287       Other Conditions/complications 23
.XONSTO23 DIM        1       292       Other Conditions onset 23
.XOTHCO24 DIM        5       293       Other Conditions/complications 24
.XONSTO24 DIM        1       298       Other Conditions onset 24
.XPPROCA  DIM        7       299       Principal Procedure A
.XPPROCLA DIM        1       306       Principal Procedure Location A
.XPROCB   DIM        7       307       Procedure B
.XPROCLB  DIM        1       312       Procedure Location B
.XPROCC   DIM        7       315       Procedure C
.XPROCLC  DIM        1       322       Procedure Location C
.XPROCD   DIM        7       323       Procedure D
.XPROCLD  DIM        1       330       Procedure Location D
.XPROCE   DIM        7       330       Procedure E
.XPROCLE  DIM        1       338       Procedure Location E
.XPROCF   DIM        7       339       Procedure F
.XPROCLF  DIM        1       346       Procedure Location F
.XPROCG   DIM        7       347       Procedure G
.XPROCLG  DIM        1       354       Procedure Location G
.XPROCH   DIM        7       355       Procedure H
.XPROCLH  DIM        1       362       Procedure Location H
.XPROCI   DIM        7       363       Procedure I
.XPROCLI  DIM        1       370       Procedure Location I
.XPROCJ   DIM        7       371       Procedure J
.XPROCLJ  DIM        1       378       Procedure Location J
.XPROCK   DIM        7       379       Procedure K
.XPROCLK  DIM        1       386       Procedure Location K
.XPROCL   DIM        7       387       Procedure L
.XPROCLL  DIM        1       394       Procedure Location L
.XPROCM   DIM        7       395       Procedure M
.XPROCLM  DIM        1       402       Procedure Location M
.XPROCN   DIM        7       403       Procedure N
.XPROCLN  DIM        1       410       Procedure Location N
.XPROCO   DIM        7       411       Procedure O
.XPROCLO  DIM        1       418       Procedure Location O
.XPROCP   DIM        7       419       Procedure P
.XPROCLP  DIM        1       426       Procedure Location P
.XPROCQ   DIM        7       427       Procedure Q
.XPROCLQ  DIM        1       434       Procedure Location Q
.XPROCR   DIM        7       435       Procedure R
.XPROCLR  DIM        1       442       Procedure Location R
.XPROCS   DIM        7       443       Procedure S
.XPROCLS  DIM        1       450       Procedure Location S
.XPROCT   DIM        7       451       Procedure T
.XPROCLT  DIM        1       458       Procedure Location T
.XPROCU   DIM        7       459       Procedure U
.XPROCLU  DIM        1       466       Procedure Location U
.XPROCV   DIM        7       467       Procedure V
.XPROCLV  DIM        1       474       Procedure Location V
.XPROCW   DIM        7       475       Procedure W
.XPROCLW  DIM        1       482       Procedure Location W
.XPROCX   DIM        7       483       Procedure X
.XPROCLX  DIM        1       490       Procedure Location X
.XPROCY   DIM        7       491       Procedure Y
.XPROCLY  DIM        1       498       Procedure Location Y
XPROC025  DIM        7       499       Procedure 025
XPRCL025  DIM        1       506       Procedure Location for Procedure 025
.XEXTCAUS DIM        5       507       External Cause
.XPLCEOCC DIM        5       512       Place of Occurance
.XACTVITY DIM        5       517       Activity when Injured
.XEOC     DIM        1       522       Episode of Care
.XFUNDSRC DIM        2       523       Funding Source
.XUNREAD  DIM        1       525       Unplanned Re-admission
.XADMCAT  DIM        1       526       Admission Category
.XCPURNO  DIM       10       527       Contract Provider hospital pat. unit num
.XDACONPR DIM        8       537       Date admitted to contract provider hosp
.XHOSPNUM DIM        4       545       Provider of contract services - hosp num
.XLEAVFD1 DIM        8       549       Leave From Date 1
.XLEAVFT1 DIM        4       557       Leave From Time 1
.XLEAVTD1 DIM        8       561       Leave To Date 1
.XLEAVTT1 DIM        4       569       Leave To Time 1
.XLEAVFD2 DIM        8       573       Leave From Date 2
.XLEAVFT2 DIM        4       581       Leave From Time 2
.XLEAVTD2 DIM        8       585       Leave To Date 2
.XLEAVTT2 DIM        4       593       Leave To Time 2
.XLEAVFD3 DIM        8       597       Leave From Date 3
.XLEAVFT3 DIM        4       605       Leave From Time 3
.XLEAVTD3 DIM        8       609       Leave To Date 3
.XLEAVTT3 DIM        4       617       Leave To Time 3
.XLEAVFD4 DIM        8       621       Leave From Date 4
.XLEAVFT4 DIM        4       629       Leave From Time 4
.XLEAVTD4 DIM        8       633       Leave To Date 4
.XLEAVTT4 DIM        4       641       Leave To Time 4
.XADWGHT  DIM        4       645       Admission Weight (Grams)
.XHICU    DIM        5       649       Hours in ICU
.XHMECVEN DIM        4       654       Hours on Mechanical Ventilation
.XLEGSTAT DIM        1       658       Legal Status
.XADMTIME DIM        4       659       Admission Time
.XSEPTIME DIM        4       663       Separation Time
.XHTRANFR DIM        4       667       Hospital Transferred to
.XMHLV    DIM       10       671       Mental Health Linking Variable
.XOACISLV DIM       10       681       OACIS Linking Variable
.XADUCHI  DIM        1       691       Adult/Child Flag
.XPSYCAD  DIM        1       692       First Psychiatric Admission
.XPREVSPC DIM        1       693       Prev Specialised Treatment (not collected)
.XEMPSTAT DIM        1       694       Employment Status
.XPENSTAT DIM        1       695       Pension Status
.XUSUACC  DIM        1       696       Type of Usual Accomodation
.XDOBACC  DIM        1       697       DOB Accuracy Flag
.XDOFOTP  DIM        8       698       Date of first OT procedure
.XTFOTP    DIM       4       706       Time of first OT procedure
.XDISWARD  DIM      10       710       Discharge Ward
.XEXTCONS  DIM       1       720       External Cause onset flag
.XPLOCONS  DIM       1       721       Place of Occurence onset flag
.XACTVONS  DIM       1       722       Activity onset flag
.XDTTODL   DIM       8       723       Date transferred to discharge lounge
.XTTTODL   DIM       4       731       Time transferred to discharge lounge
.XADMWARD  DIM      10       735       Ward on admission
.XRESITEM  DIM      10       745       Research Items
.XPREFLNG  DIM       4       755       Preferred Language
.XRELGAFF  DIM       4       759       Religious Affiliation
.XINTREQD  DIM       1       763       Interpreter Required 
XEPASVID  DIM       20       764       EPAS Site Visit Id
XMHACCPR  DIM        2       784       Mental Health Accommodation Prior
.----Additional Diagnosis 025-099 Position 786-1235
XOTHCO25  DIM        5       786       Additional Diagnosis 025
XONSTO25  DIM        1       791       Condition Onset ind for Addn Diag 025
XOTHCO26  DIM        5       792       Additional Diagnosis 026
XONSTO26  DIM        1       797       Condition Onset ind for Addn Diag 026
XOTHCO27  DIM        5       798       Additional Diagnosis 027
XONSTO27  DIM        1       803       Condition Onset ind for Addn Diag 027
XOTHCO28  DIM        5       804       Additional Diagnosis 028
XONSTO28  DIM        1       809       Condition Onset ind for Addn Diag 028
XOTHCO29  DIM        5       810       Additional Diagnosis 029
XONSTO29  DIM        1       815       Condition Onset ind for Addn Diag 029
XOTHCO30  DIM        5       816       Additional Diagnosis 030
XONSTO30  DIM        1       821       Condition Onset ind for Addn Diag 030
XOTHCO31  DIM        5       822       Additional Diagnosis 031
XONSTO31  DIM        1       827       Condition Onset ind for Addn Diag 031
XOTHCO32  DIM        5       828       Additional Diagnosis 032
XONSTO32  DIM        1       833       Condition Onset ind for Addn Diag 032
XOTHCO33  DIM        5       834       Additional Diagnosis 033
XONSTO33  DIM        1       839       Condition Onset ind for Addn Diag 033
XOTHCO34  DIM        5       840       Additional Diagnosis 034
XONSTO34  DIM        1       845       Condition Onset ind for Addn Diag 034
XOTHCO35  DIM        5       846       Additional Diagnosis 035
XONSTO35  DIM        1       851       Condition Onset ind for Addn Diag 035
XOTHCO36  DIM        5       852       Additional Diagnosis 036
XONSTO36  DIM        1       857       Condition Onset ind for Addn Diag 036
XOTHCO37  DIM        5       858       Additional Diagnosis 037
XONSTO37  DIM        1       863       Condition Onset ind for Addn Diag 025
XOTHCO38  DIM        5       864       Additional Diagnosis 038
XONSTO38  DIM        1       869       Condition Onset ind for Addn Diag 038
XOTHCO39  DIM        5       870       Additional Diagnosis 039
XONSTO39  DIM        1       875       Condition Onset ind for Addn Diag 039
XOTHCO40  DIM        5       876       Additional Diagnosis 040
XONSTO40  DIM        1       881       Condition Onset ind for Addn Diag 040
XOTHCO41  DIM        5       882       Additional Diagnosis 041
XONSTO41  DIM        1       887       Condition Onset ind for Addn Diag 040
XOTHCO42  DIM        5       888       Additional Diagnosis 042
XONSTO42  DIM        1       893       Condition Onset ind for Addn Diag 042
XOTHCO43  DIM        5       894       Additional Diagnosis 043
XONSTO43  DIM        1       899       Condition Onset ind for Addn Diag 043
XOTHCO44  DIM        5       900       Additional Diagnosis 044
XONSTO44  DIM        1       905       Condition Onset ind for Addn Diag 044
XOTHCO45  DIM        5       906       Additional Diagnosis 045
XONSTO45  DIM        1       911       Condition Onset ind for Addn Diag 045
XOTHCO46  DIM        5       912       Additional Diagnosis 046
XONSTO46  DIM        1       917       Condition Onset ind for Addn Diag 046
XOTHCO47  DIM        5       918       Additional Diagnosis 047
XONSTO47  DIM        1       923       Condition Onset ind for Addn Diag 047
XOTHCO48  DIM        5       924       Additional Diagnosis 048
XONSTO48  DIM        1       929       Condition Onset ind for Addn Diag 048
XOTHCO49  DIM        5       930       Additional Diagnosis 049
XONSTO49  DIM        1       935       Condition Onset ind for Addn Diag 049
XOTHCO50  DIM        5       936       Additional Diagnosis 050
XONSTO50  DIM        1       941       Condition Onset ind for Addn Diag 050
XOTHCO51  DIM        5       942       Additional Diagnosis 051
XONSTO51  DIM        1       947       Condition Onset ind for Addn Diag 051
XOTHCO52  DIM        5       948       Additional Diagnosis 052
XONSTO52  DIM        1       953       Condition Onset ind for Addn Diag 052
XOTHCO53  DIM        5       954       Additional Diagnosis 053
XONSTO53  DIM        1       959       Condition Onset ind for Addn Diag 053
XOTHCO54  DIM        5       960       Additional Diagnosis 054
XONSTO54  DIM        1       965       Condition Onset ind for Addn Diag 054
XOTHCO55  DIM        5       966       Additional Diagnosis 055
XONSTO55  DIM        1       971       Condition Onset ind for Addn Diag 055
XOTHCO56  DIM        5       972       Additional Diagnosis 056
XONSTO56  DIM        1       977       Condition Onset ind for Addn Diag 056
XOTHCO57  DIM        5       978       Additional Diagnosis 057
XONSTO57  DIM        1       983       Condition Onset ind for Addn Diag 057
XOTHCO58  DIM        5       984       Additional Diagnosis 058
XONSTO58  DIM        1       989       Condition Onset ind for Addn Diag 058
XOTHCO59  DIM        5       990       Additional Diagnosis 059
XONSTO59  DIM        1       995       Condition Onset ind for Addn Diag 059
XOTHCO60  DIM        5       996       Additional Diagnosis 060
XONSTO60  DIM        1      1001       Condition Onset ind for Addn Diag 060
XOTHCO61  DIM        5      1002       Additional Diagnosis 061
XONSTO61  DIM        1      1007       Condition Onset ind for Addn Diag 061
XOTHCO62  DIM        5      1008       Additional Diagnosis 062
XONSTO62  DIM        1      1013       Condition Onset ind for Addn Diag 062
XOTHCO63  DIM        5      1014       Additional Diagnosis 063
XONSTO63  DIM        1      1019       Condition Onset ind for Addn Diag 063
XOTHCO64  DIM        5      1020       Additional Diagnosis 064
XONSTO64  DIM        1      1025       Condition Onset ind for Addn Diag 064
XOTHCO65  DIM        5      1026       Additional Diagnosis 065
XONSTO65  DIM        1      1031       Condition Onset ind for Addn Diag 065
XOTHCO66  DIM        5      1032       Additional Diagnosis 066
XONSTO66  DIM        1      1037       Condition Onset ind for Addn Diag 066
XOTHCO67  DIM        5      1038       Additional Diagnosis 067
XONSTO67  DIM        1      1043       Condition Onset ind for Addn Diag 067
XOTHCO68  DIM        5      1044       Additional Diagnosis 068
XONSTO68  DIM        1      1049       Condition Onset ind for Addn Diag 068
XOTHCO69  DIM        5      1050       Additional Diagnosis 069
XONSTO69  DIM        1      1055       Condition Onset ind for Addn Diag 069
XOTHCO70  DIM        5      1056       Additional Diagnosis 070
XONSTO70  DIM        1      1061       Condition Onset ind for Addn Diag 070
XOTHCO71  DIM        5      1062       Additional Diagnosis 071
XONSTO71  DIM        1      1067       Condition Onset ind for Addn Diag 071
XOTHCO72  DIM        5      1068       Additional Diagnosis 072
XONSTO72  DIM        1      1073       Condition Onset ind for Addn Diag 072
XOTHCO73  DIM        5      1074       Additional Diagnosis 073
XONSTO73  DIM        1      1079       Condition Onset ind for Addn Diag 073
XOTHCO74  DIM        5      1080       Additional Diagnosis 074
XONSTO74  DIM        1      1085       Condition Onset ind for Addn Diag 074
XOTHCO75  DIM        5      1086       Additional Diagnosis 075
XONSTO75  DIM        1      1091       Condition Onset ind for Addn Diag 075
XOTHCO76  DIM        5      1092       Additional Diagnosis 076
XONSTO76  DIM        1      1097       Condition Onset ind for Addn Diag 076
XOTHCO77  DIM        5      1098       Additional Diagnosis 077
XONSTO77  DIM        1      1103       Condition Onset ind for Addn Diag 077
XOTHCO78  DIM        5      1104       Additional Diagnosis 078
XONSTO78  DIM        1      1109       Condition Onset ind for Addn Diag 078
XOTHCO79  DIM        5      1110       Additional Diagnosis 079
XONSTO79  DIM        1      1115       Condition Onset ind for Addn Diag 079
XOTHCO80  DIM        5      1116       Additional Diagnosis 080
XONSTO80  DIM        1      1121       Condition Onset ind for Addn Diag 080
XOTHCO81  DIM        5      1122       Additional Diagnosis 081
XONSTO81  DIM        1      1127       Condition Onset ind for Addn Diag 081
XOTHCO82  DIM        5      1128       Additional Diagnosis 082
XONSTO82  DIM        1      1133       Condition Onset ind for Addn Diag 082
XOTHCO83  DIM        5      1134       Additional Diagnosis 083
XONSTO83  DIM        1      1139       Condition Onset ind for Addn Diag 083
XOTHCO84  DIM        5      1140       Additional Diagnosis 084
XONSTO84  DIM        1      1145       Condition Onset ind for Addn Diag 084
XOTHCO85  DIM        5      1146       Additional Diagnosis 085
XONSTO85  DIM        1      1151       Condition Onset ind for Addn Diag 085
XOTHCO86  DIM        5      1152       Additional Diagnosis 086
XONSTO86  DIM        1      1157       Condition Onset ind for Addn Diag 086
XOTHCO87  DIM        5      1158       Additional Diagnosis 087
XONSTO87  DIM        1      1163       Condition Onset ind for Addn Diag 087
XOTHCO88  DIM        5      1164       Additional Diagnosis 088
XONSTO88  DIM        1      1169       Condition Onset ind for Addn Diag 088
XOTHCO89  DIM        5      1170       Additional Diagnosis 089
XONSTO89  DIM        1      1175       Condition Onset ind for Addn Diag 089
XOTHCO90  DIM        5      1176       Additional Diagnosis 090
XONSTO90  DIM        1      1181       Condition Onset ind for Addn Diag 090
XOTHCO91  DIM        5      1182       Additional Diagnosis 091
XONSTO91  DIM        1      1187       Condition Onset ind for Addn Diag 091
XOTHCO92  DIM        5      1188       Additional Diagnosis 092
XONSTO92  DIM        1      1193       Condition Onset ind for Addn Diag 092
XOTHCO93  DIM        5      1194       Additional Diagnosis 093
XONSTO93  DIM        1      1199       Condition Onset ind for Addn Diag 093
XOTHCO94  DIM        5      1200       Additional Diagnosis 094
XONSTO94  DIM        1      1205       Condition Onset ind for Addn Diag 094
XOTHCO95  DIM        5      1206       Additional Diagnosis 095
XONSTO95  DIM        1      1211       Condition Onset ind for Addn Diag 095
XOTHCO96  DIM        5      1212       Additional Diagnosis 096
XONSTO96  DIM        1      1217       Condition Onset ind for Addn Diag 096
XOTHCO97  DIM        5      1218       Additional Diagnosis 097
XONSTO97  DIM        1      1223       Condition Onset ind for Addn Diag 097
XOTHCO98  DIM        5      1224       Additional Diagnosis 098
XONSTO98  DIM        1      1229       Condition Onset ind for Addn Diag 098
XOTHCO99  DIM        5      1230       Additional Diagnosis 099
XONSTO99  DIM        1      1235       Condition Onset ind for Addn Diag 099
.----Procedure 026-099 Position 1236 to 1827
XPROC026  DIM        7      1236       Procedure 026
XPRCL026  DIM        1      1243       Procedure Location for Procedure 026
XPROC027  DIM        7      1244       Procedure 027
XPRCL027  DIM        1      1251       Procedure Location for Procedure 027
XPROC028  DIM        7      1252       Procedure 028
XPRCL028  DIM        1      1259       Procedure Location for Procedure 028
XPROC029  DIM        7      1260       Procedure 029
XPRCL029  DIM        1      1267       Procedure Location for Procedure 029
XPROC030  DIM        7      1268       Procedure 030
XPRCL030  DIM        1      1275       Procedure Location for Procedure 030
XPROC031  DIM        7      1276       Procedure 031
XPRCL031  DIM        1      1283       Procedure Location for Procedure 031
XPROC032  DIM        7      1284       Procedure 032
XPRCL032  DIM        1      1291       Procedure Location for Procedure 032
XPROC033  DIM        7      1292       Procedure 033
XPRCL033  DIM        1      1299       Procedure Location for Procedure 033
XPROC034  DIM        7      1300       Procedure 034
XPRCL034  DIM        1      1307       Procedure Location for Procedure 034
XPROC035  DIM        7      1308       Procedure 035
XPRCL035  DIM        1      1315       Procedure Location for Procedure 035
XPROC036  DIM        7      1316       Procedure 036
XPRCL036  DIM        1      1323       Procedure Location for Procedure 036
XPROC037  DIM        7      1324       Procedure 037
XPRCL037  DIM        1      1331       Procedure Location for Procedure 037
XPROC038  DIM        7      1332       Procedure 038
XPRCL038  DIM        1      1339       Procedure Location for Procedure 038
XPROC039  DIM        7      1340       Procedure 039
XPRCL039  DIM        1      1347       Procedure Location for Procedure 039
XPROC040  DIM        7      1348       Procedure 040
XPRCL040  DIM        1      1355       Procedure Location for Procedure 040
XPROC041  DIM        7      1356       Procedure 041
XPRCL041  DIM        1      1363       Procedure Location for Procedure 041
XPROC042  DIM        7      1364       Procedure 042
XPRCL042  DIM        1      1371       Procedure Location for Procedure 042
XPROC043  DIM        7      1372       Procedure 043
XPRCL043  DIM        1      1379       Procedure Location for Procedure 043
XPROC044  DIM        7      1380       Procedure 044
XPRCL044  DIM        1      1387       Procedure Location for Procedure 044
XPROC045  DIM        7      1388       Procedure 045
XPRCL045  DIM        1      1395       Procedure Location for Procedure 045
XPROC046  DIM        7      1396       Procedure 046
XPRCL046  DIM        1      1403       Procedure Location for Procedure 046
XPROC047  DIM        7      1404       Procedure 047
XPRCL047  DIM        1      1411       Procedure Location for Procedure 047
XPROC048  DIM        7      1412       Procedure 048
XPRCL048  DIM        1      1419       Procedure Location for Procedure 048
XPROC049  DIM        7      1420       Procedure 049
XPRCL049  DIM        1      1427       Procedure Location for Procedure 049
XPROC050  DIM        7      1428       Procedure 050
XPRCL050  DIM        1      1435       Procedure Location for Procedure 050
XPROC051  DIM        7      1436       Procedure 051
XPRCL051  DIM        1      1443       Procedure Location for Procedure 051
XPROC052  DIM        7      1444       Procedure 052
XPRCL052  DIM        1      1451       Procedure Location for Procedure 052
XPROC053  DIM        7      1452       Procedure 053
XPRCL053  DIM        1      1459       Procedure Location for Procedure 053
XPROC054  DIM        7      1460       Procedure 054
XPRCL054  DIM        1      1467       Procedure Location for Procedure 054
XPROC055  DIM        7      1468       Procedure 055
XPRCL055  DIM        1      1475       Procedure Location for Procedure 055
XPROC056  DIM        7      1476       Procedure 056
XPRCL056  DIM        1      1483       Procedure Location for Procedure 056
XPROC057  DIM        7      1484       Procedure 057
XPRCL057  DIM        1      1491       Procedure Location for Procedure 057
XPROC058  DIM        7      1492       Procedure 058
XPRCL058  DIM        1      1499       Procedure Location for Procedure 058
XPROC059  DIM        7      1500       Procedure 059
XPRCL059  DIM        1      1507       Procedure Location for Procedure 059
XPROC060  DIM        7      1508       Procedure 060
XPRCL060  DIM        1      1515       Procedure Location for Procedure 060
XPROC061  DIM        7      1516       Procedure 061
XPRCL061  DIM        1      1523       Procedure Location for Procedure 061
XPROC062  DIM        7      1524       Procedure 062
XPRCL062  DIM        1      1531       Procedure Location for Procedure 062
XPROC063  DIM        7      1532       Procedure 063
XPRCL063  DIM        1      1539       Procedure Location for Procedure 063
XPROC064  DIM        7      1540       Procedure 064
XPRCL064  DIM        1      1547       Procedure Location for Procedure 064
XPROC065  DIM        7      1548       Procedure 065
XPRCL065  DIM        1      1555       Procedure Location for Procedure 065
XPROC066  DIM        7      1556       Procedure 066
XPRCL066  DIM        1      1563       Procedure Location for Procedure 066
XPROC067  DIM        7      1564       Procedure 067
XPRCL067  DIM        1      1571       Procedure Location for Procedure 067
XPROC068  DIM        7      1572       Procedure 068
XPRCL068  DIM        1      1579       Procedure Location for Procedure 068
XPROC069  DIM        7      1580       Procedure 069
XPRCL069  DIM        1      1587       Procedure Location for Procedure 069
XPROC070  DIM        7      1588       Procedure 070
XPRCL070  DIM        1      1595       Procedure Location for Procedure 070
XPROC071  DIM        7      1596       Procedure 071
XPRCL071  DIM        1      1603       Procedure Location for Procedure 071
XPROC072  DIM        7      1604       Procedure 072
XPRCL072  DIM        1      1611       Procedure Location for Procedure 072
XPROC073  DIM        7      1612       Procedure 073
XPRCL073  DIM        1      1619       Procedure Location for Procedure 073
XPROC074  DIM        7      1620       Procedure 074
XPRCL074  DIM        1      1627       Procedure Location for Procedure 074
XPROC075  DIM        7      1628       Procedure 075
XPRCL075  DIM        1      1635       Procedure Location for Procedure 075
XPROC076  DIM        7      1636       Procedure 076
XPRCL076  DIM        1      1643       Procedure Location for Procedure 076
XPROC077  DIM        7      1644       Procedure 077
XPRCL077  DIM        1      1651       Procedure Location for Procedure 077
XPROC078  DIM        7      1652       Procedure 078
XPRCL078  DIM        1      1659       Procedure Location for Procedure 078
XPROC079  DIM        7      1660       Procedure 079
XPRCL079  DIM        1      1667       Procedure Location for Procedure 079
XPROC080  DIM        7      1668       Procedure 080
XPRCL080  DIM        1      1675       Procedure Location for Procedure 080
XPROC081  DIM        7      1676       Procedure 081  
XPRCL081  DIM        1      1683       Procedure Location for Procedure 081
XPROC082  DIM        7      1684       Procedure 082
XPRCL082  DIM        1      1691       Procedure Location for Procedure 082
XPROC083  DIM        7      1692       Procedure 083
XPRCL083  DIM        1      1699       Procedure Location for Procedure 083
XPROC084  DIM        7      1700       Procedure 084
XPRCL084  DIM        1      1707       Procedure Location for Procedure 084
XPROC085  DIM        7      1708       Procedure 085
XPRCL085  DIM        1      1715       Procedure Location for Procedure 085
XPROC086  DIM        7      1716       Procedure 086
XPRCL086  DIM        1      1723       Procedure Location for Procedure 086
XPROC087  DIM        7      1724       Procedure 087
XPRCL087  DIM        1      1731       Procedure Location for Procedure 087
XPROC088  DIM        7      1732       Procedure 088
XPRCL088  DIM        1      1739       Procedure Location for Procedure 088
XPROC089  DIM        7      1740       Procedure 089
XPRCL089  DIM        1      1747       Procedure Location for Procedure 089
XPROC090  DIM        7      1748       Procedure 090
XPRCL090  DIM        1      1755       Procedure Location for Procedure 090
XPROC091  DIM        7      1756       Procedure 091
XPRCL091  DIM        1      1763       Procedure Location for Procedure 091
XPROC092  DIM        7      1764       Procedure 092
XPRCL092  DIM        1      1771       Procedure Location for Procedure 092
XPROC093  DIM        7      1772       Procedure 093
XPRCL093  DIM        1      1779       Procedure Location for Procedure 093
XPROC094  DIM        7      1780       Procedure 094
XPRCL094  DIM        1      1787       Procedure Location for Procedure 094
XPROC095  DIM        7      1788       Procedure 095
XPRCL095  DIM        1      1795       Procedure Location for Procedure 095
XPROC096  DIM        7      1796       Procedure 096
XPRCL096  DIM        1      1803       Procedure Location for Procedure 096
XPROC097  DIM        7      1804       Procedure 097
XPRCL097  DIM        1      1811       Procedure Location for Procedure 097
XPROC098  DIM        7      1812       Procedure 098
XPRCL098  DIM        1      1819       Procedure Location for Procedure 098
XPROC099  DIM        7      1820       Procedure 099
XPRCL099  DIM        1      1827       Procedure Location for Procedure 099
.
XSUBURBL  DIM       50      1828       Suburb/Locality Long version
.
XHMECVNW  DIM        5      1878       Hours on Mechanical Ventilation NEW
XPRCGEND  DIM        1      1883       Gender
XPRCIHI   DIM       16      1884       Individual Healthcare Identifier (IHI)
XPRCIHIR  DIM        1      1900       IHI - Record Status
XPRCIHIN  DIM        1      1901       IHI - Number Status
XPRCEMRS  DIM       16      1902       EMR Service ID
XDCIDFPD  DIM       2       1918       Diag Clus Ident for Principal Diagnosis    
XDCAD001  DIM       2       1920       Diag Clus Identifier for Add Diag 001 
XDCAD002  DIM       2       1922       Diag Clus Identifier for Add Diag 002 
XDCAD003  DIM       2       1924       Diag Clus Identifier for Add Diag 003 
XDCAD004  DIM       2       1926       Diag Clus Identifier for Add Diag 004
XDCAD005  DIM       2       1928       Diag Clus Identifier for Add Diag 005 
XDCAD006  DIM       2       1930       Diag Clus Identifier for Add Diag 006 
XDCAD007  DIM       2       1932       Diag Clus Identifier for Add Diag 007 
XDCAD008  DIM       2       1934       Diag Clus Identifier for Add Diag 008 
XDCAD009  DIM       2       1936       Diag Clus Identifier for Add Diag 009
XDCAD010  DIM       2       1938       Diag Clus Identifier for Add Diag 010
XDCAD011  DIM       2       1940       Diag Clus Identifier for Add Diag 011
XDCAD012  DIM       2       1942       Diag Clus Identifier for Add Diag 012
XDCAD013  DIM       2       1944       Diag Clus Identifier for Add Diag 013
XDCAD014  DIM       2       1946       Diag Clus Identifier for Add Diag 014
XDCAD015  DIM       2       1948       Diag Clus Identifier for Add Diag 015
XDCAD016  DIM       2       1950       Diag Clus Identifier for Add Diag 016
XDCAD017  DIM       2       1952       Diag Clus Identifier for Add Diag 017
XDCAD018  DIM       2       1954       Diag Clus Identifier for Add Diag 018
XDCAD019  DIM       2       1956       Diag Clus Identifier for Add Diag 019
XDCAD020  DIM       2       1958       Diag Clus Identifier for Add Diag 020
XDCAD021  DIM       2       1960       Diag Clus Identifier for Add Diag 021
XDCAD022  DIM       2       1962       Diag Clus Identifier for Add Diag 022
XDCAD023  DIM       2       1964       Diag Clus Identifier for Add Diag 023
XDCAD024  DIM       2       1966       Diag Clus Identifier for Add Diag 024
XDCAD025  DIM       2       1968       Diag Clus Identifier for Add Diag 025
XDCAD026  DIM       2       1970       Diag Clus Identifier for Add Diag 026
XDCAD027  DIM       2       1972       Diag Clus Identifier for Add Diag 027
XDCAD028  DIM       2       1974       Diag Clus Identifier for Add Diag 028
XDCAD029  DIM       2       1976       Diag Clus Identifier for Add Diag 029
XDCAD030  DIM       2       1978       Diag Clus Identifier for Add Diag 030
XDCAD031  DIM       2       1980       Diag Clus Identifier for Add Diag 031
XDCAD032  DIM       2       1982       Diag Clus Identifier for Add Diag 032
XDCAD033  DIM       2       1984       Diag Clus Identifier for Add Diag 033
XDCAD034  DIM       2       1986       Diag Clus Identifier for Add Diag 034
XDCAD035  DIM       2       1988       Diag Clus Identifier for Add Diag 035
XDCAD036  DIM       2       1990       Diag Clus Identifier for Add Diag 036
XDCAD037  DIM       2       1992       Diag Clus Identifier for Add Diag 037
XDCAD038  DIM       2       1994       Diag Clus Identifier for Add Diag 038
XDCAD039  DIM       2       1996       Diag Clus Identifier for Add Diag 039
XDCAD040  DIM       2       1990       Diag Clus Identifier for Add Diag 040
XDCAD041  DIM       2       2000       Diag Clus Identifier for Add Diag 041
XDCAD042  DIM       2       2002       Diag Clus Identifier for Add Diag 042
XDCAD043  DIM       2       2004       Diag Clus Identifier for Add Diag 043
XDCAD044  DIM       2       2006       Diag Clus Identifier for Add Diag 044
XDCAD045  DIM       2       2008       Diag Clus Identifier for Add Diag 045
XDCAD046  DIM       2       2010       Diag Clus Identifier for Add Diag 046
XDCAD047  DIM       2       2012       Diag Clus Identifier for Add Diag 047
XDCAD048  DIM       2       2014       Diag Clus Identifier for Add Diag 048
XDCAD049  DIM       2       2016       Diag Clus Identifier for Add Diag 049
XDCAD050  DIM       2       2018       Diag Clus Identifier for Add Diag 050
XDCAD051  DIM       2       2020       Diag Clus Identifier for Add Diag 051
XDCAD052  DIM       2       2022       Diag Clus Identifier for Add Diag 052
XDCAD053  DIM       2       2024       Diag Clus Identifier for Add Diag 053
XDCAD054  DIM       2       2026       Diag Clus Identifier for Add Diag 054
XDCAD055  DIM       2       2028       Diag Clus Identifier for Add Diag 055
XDCAD056  DIM       2       2030       Diag Clus Identifier for Add Diag 056
XDCAD057  DIM       2       2032       Diag Clus Identifier for Add Diag 057
XDCAD058  DIM       2       2034       Diag Clus Identifier for Add Diag 058
XDCAD059  DIM       2       2036       Diag Clus Identifier for Add Diag 059
XDCAD060  DIM       2       2038       Diag Clus Identifier for Add Diag 060
XDCAD061  DIM       2       2040       Diag Clus Identifier for Add Diag 061
XDCAD062  DIM       2       2042       Diag Clus Identifier for Add Diag 062
XDCAD063  DIM       2       2044       Diag Clus Identifier for Add Diag 063
XDCAD064  DIM       2       2046       Diag Clus Identifier for Add Diag 064
XDCAD065  DIM       2       2048       Diag Clus Identifier for Add Diag 065
XDCAD066  DIM       2       2050       Diag Clus Identifier for Add Diag 066
XDCAD067  DIM       2       2052       Diag Clus Identifier for Add Diag 067
XDCAD068  DIM       2       2054       Diag Clus Identifier for Add Diag 068
XDCAD069  DIM       2       2056       Diag Clus Identifier for Add Diag 069
XDCAD070  DIM       2       2058       Diag Clus Identifier for Add Diag 070
XDCAD071  DIM       2       2060       Diag Clus Identifier for Add Diag 071
XDCAD072  DIM       2       2062       Diag Clus Identifier for Add Diag 072
XDCAD073  DIM       2       2064       Diag Clus Identifier for Add Diag 073
XDCAD074  DIM       2       2066       Diag Clus Identifier for Add Diag 074
XDCAD075  DIM       2       2068       Diag Clus Identifier for Add Diag 075
XDCAD076  DIM       2       2070       Diag Clus Identifier for Add Diag 076
XDCAD077  DIM       2       2072       Diag Clus Identifier for Add Diag 077
XDCAD078  DIM       2       2074       Diag Clus Identifier for Add Diag 078
XDCAD079  DIM       2       2076       Diag Clus Identifier for Add Diag 079
XDCAD080  DIM       2       2078       Diag Clus Identifier for Add Diag 080
XDCAD081  DIM       2       2080       Diag Clus Identifier for Add Diag 081
XDCAD082  DIM       2       2082       Diag Clus Identifier for Add Diag 082
XDCAD083  DIM       2       2084       Diag Clus Identifier for Add Diag 083
XDCAD084  DIM       2       2086       Diag Clus Identifier for Add Diag 084
XDCAD085  DIM       2       2088       Diag Clus Identifier for Add Diag 085
XDCAD086  DIM       2       2090       Diag Clus Identifier for Add Diag 086
XDCAD087  DIM       2       2092       Diag Clus Identifier for Add Diag 087
XDCAD088  DIM       2       2094       Diag Clus Identifier for Add Diag 088
XDCAD089  DIM       2       2096       Diag Clus Identifier for Add Diag 089
XDCAD090  DIM       2       2098       Diag Clus Identifier for Add Diag 090
XDCAD091  DIM       2       2100       Diag Clus Identifier for Add Diag 091
XDCAD092  DIM       2       2102       Diag Clus Identifier for Add Diag 092
XDCAD093  DIM       2       2104       Diag Clus Identifier for Add Diag 093
XDCAD094  DIM       2       2106       Diag Clus Identifier for Add Diag 094
XDCAD095  DIM       2       2108       Diag Clus Identifier for Add Diag 095
XDCAD096  DIM       2       2110       Diag Clus Identifier for Add Diag 096
XDCAD097  DIM       2       2112       Diag Clus Identifier for Add Diag 097
XDCAD098  DIM       2       2114       Diag Clus Identifier for Add Diag 098
XDCAD099  DIM       2       2116       Diag Clus Identifier for Add Diag 099 
XPDCIFEC  DIM       2       2118       Diag Clus Identifier for External Cause
XPDCIFPP  DIM       2       2120       Diag Clus Ident for Place Of Occurrance
XPDCIFAJ  DIM       2       2122       Diag Clus Ident for Activity When Injured
.
.End of Record              2124 
.
 
TEMP2     FILE ASCII,   FIXED=660               * Correction file
.
.NAME     TYPE    LENGTH     START     DESCRIPTION
.----     ----    ------     -----     -----------
.XRECTYP  DIM        1         1       "5"=Correction record
.XHOSCOD  DIM        4         2       Hospital Code
.XURNO    DIM       10         6       UR Number
.XSEPDAT  DIM        8        16       Separation Date
.XSEPTIME DIM        4        24       Separation Time
XDELIND   DIM        1        28       Delete Indicator 1=requires deletion
XITEMNUM  DIM        3        29       Item Number
XNEWINFO  DIM       65        32       New Information
.XFILL    DIM      563        97       Space filled
.
. TEMP2 variable for DOYR2025
.NAME     TYPE    LENGTH     START     DESCRIPTION
.----     ----    ------     -----     -----------
XITEMNMN  DIM        5        29       Item Number
.XNEWINFO  DIM       65       34       New Information
.XFILL     DIM       2024     99       Space Filler
.
.End of Record              2123
.
TEMP3     FILE ASCII,   FIXED=20
.
. Local Variable Definition 
. -------------------------
.
ADDGFLAG  FORM      1                                                  *I-52873
.
BLOKNO    FORM      4                                                 *I-108284
.
CADMNO    DIM       8           * Correction admission number
CALDAYS   FORM      4
CATEG     DIM       2
CITEMNUM  FORM      3           * Item number to be corrected 
CMDLINE   DIM      60
CMPCNT    FORM      1
CODE      DIM       3
CODE5     DIM       5
CODE9     DIM       9
COUNT     FORM      1
COUNT2    FORM      3
COUNTCAD  FORM      2
CURDATE   DIM       8           * Current date
.
DCFLAGEC  FORM      1           * Flag set for first activity for PT0DACRQ =2
DCFLAGPC  FORM      1           * Flag set for first activity for PT0DACRQ = p
DCFLAGWI  FORM      1           * Flag set for first activity for PT0DACRQ = A
.
DELIND    DIM       1           * Delete indicator
DIM1A     DIM       1
DIM3      DIM       3
DIM3A     DIM       3
DIM4      DIM       4
DIM4A     DIM       4
DIM6      DIM       6
DIM45     DIM       45
DIM8      DIM       8
DITEMNUM  DIM       3
.
ENDDTE    DIM       8           * End date for new transmission
ERRDESC   DIM      70           * Error description
ERRFND    FORM      1           * 0=No errors 1=Errors found
ERRORS    FORM      1
.
F00FLAG   FORM      1
G30FLAG   FORM      1
FILENAME  DIM       8           * Name of extract file
FILENAM1  DIM       20          * Name of extract file
FLAG1     FORM      1           * Used in validation
FLAG2     FORM      1
FLAG3     FORM      1
FNAMEB    DIM      24
FNDRECA   FORM      1
FORM1A    FORM      1
FORM1B    FORM      1
FORM2A    FORM      2
FORM3     FORM      3
FORM3F    FORM      3                                                  *I-60344
FORM3T    FORM      3                                                  *I-60344
FORMCODE  FORM      5           
FORM5     FORM      5
FORM7     FORM      7
OLDDVAS   FORM      2
OLDINDS   DIM       1
FROMDATE  DIM       8
.
FUNSRC  FORM      2                                                 *I-108284
.
IBCNMHOS  FORM      1
IBANUM    FORM      3
IBANUM1   FORM      3
ICD9FLAG  FORM      1           * sending codes in ICD9
INVALACT  FORM      1           * Invalid Activity flag
.
HOSPITAL  INIT      "HOSPITAL: "
.
LEAVECNT  FORM      1           * Count number of times on leave
.
MHCODE    DIM       3
.
NBRDAYS   FORM      4
DOYR2025  FORM      1 
NEXCON    DIM       1
NUMDIAG   FORM      3           * Number of diagnoses
NUMOPER   FORM      3           * Number of operations
.
PRINCFLG  FORM      1           * Principal condition flag
PROCLOC   DIM       1
.
RECCNT    FORM      4           * Record Count
RETCNT    FORM      1           * Count number of times returned from leave
.
SAVADMN   DIM       8           * Saved Admission number
SAVATYPE  DIM       1           * Saved admission type
SAVADELC  DIM       1           * Saved admission election
SAVURNO   DIM       8           * Saved UR number
SAVCODE   DIM       5
SAVEKEY5  DIM       5           * Temp var for first 5char of diagnosis code
SDATE     DIM       8           * Start date for new transmission
SPRICON   DIM       9           * Save primary diagnosis/condition
SOTHCO1   DIM       9           * Save diagnosis codes
SOTHCO2   DIM       9 
SOTHCO3   DIM       9 
SOTHCO4   DIM       9 
SOTHCO5   DIM       9 
SOTHCO6   DIM       9 
SOTHCO7   DIM       9 
SOTHCO8   DIM       9 
SOTHCO9   DIM       9 
SOTHCO10  DIM       9 
SOTHCO11  DIM       9 
SOTHCO12  DIM       9 
SOTHCO13  DIM       9 
SOTHCO14  DIM       9 
SOTHCO15  DIM       9 
SOTHCO16  DIM       9 
SOTHCO17  DIM       9 
SOTHCO18  DIM       9 
SOTHCO19  DIM       9 
SOTHCO20  DIM       9 
SOTHCO21  DIM       9 
SOTHCO22  DIM       9 
SOTHCO23  DIM       9 
SOTHCO24  DIM       9 
.*T0889020 - Additional Diagnosis 025-099 from 01/07/2020
SOTHCO25  DIM       9 
SOTHCO26  DIM       9 
SOTHCO27  DIM       9 
SOTHCO28  DIM       9 
SOTHCO29  DIM       9 
SOTHCO30  DIM       9 
SOTHCO31  DIM       9 
SOTHCO32  DIM       9 
SOTHCO33  DIM       9 
SOTHCO34  DIM       9 
SOTHCO35  DIM       9 
SOTHCO36  DIM       9 
SOTHCO37  DIM       9 
SOTHCO38  DIM       9 
SOTHCO39  DIM       9 
SOTHCO40  DIM       9 
SOTHCO41  DIM       9 
SOTHCO42  DIM       9 
SOTHCO43  DIM       9 
SOTHCO44  DIM       9 
SOTHCO45  DIM       9 
SOTHCO46  DIM       9 
SOTHCO47  DIM       9 
SOTHCO48  DIM       9 
SOTHCO49  DIM       9 
SOTHCO50  DIM       9 
SOTHCO51  DIM       9 
SOTHCO52  DIM       9 
SOTHCO53  DIM       9 
SOTHCO54  DIM       9 
SOTHCO55  DIM       9 
SOTHCO56  DIM       9 
SOTHCO57  DIM       9 
SOTHCO58  DIM       9 
SOTHCO59  DIM       9 
SOTHCO60  DIM       9 
SOTHCO61  DIM       9 
SOTHCO62  DIM       9 
SOTHCO63  DIM       9 
SOTHCO64  DIM       9 
SOTHCO65  DIM       9 
SOTHCO66  DIM       9 
SOTHCO67  DIM       9 
SOTHCO68  DIM       9 
SOTHCO69  DIM       9 
SOTHCO70  DIM       9 
SOTHCO71  DIM       9 
SOTHCO72  DIM       9 
SOTHCO73  DIM       9 
SOTHCO74  DIM       9 
SOTHCO75  DIM       9 
SOTHCO76  DIM       9 
SOTHCO77  DIM       9 
SOTHCO78  DIM       9 
SOTHCO79  DIM       9 
SOTHCO80  DIM       9 
SOTHCO81  DIM       9 
SOTHCO82  DIM       9 
SOTHCO83  DIM       9 
SOTHCO84  DIM       9 
SOTHCO85  DIM       9 
SOTHCO86  DIM       9 
SOTHCO87  DIM       9 
SOTHCO88  DIM       9 
SOTHCO89  DIM       9 
SOTHCO90  DIM       9 
SOTHCO91  DIM       9 
SOTHCO92  DIM       9 
SOTHCO93  DIM       9 
SOTHCO94  DIM       9 
SOTHCO95  DIM       9 
SOTHCO96  DIM       9 
SOTHCO97  DIM       9 
SOTHCO98  DIM       9 
SOTHCO99  DIM       9 
SP19      INIT      "                   "
TEMPDCID  DIM       2        * Temporary variable to store Diag cluster ID
.----- Save procedure codes
SPROCA    DIM       9        * Principal procedure
SPROCB    DIM       9        * Procedure code 001
SPROCC    DIM       9         
SPROCD    DIM       9
SPROCE    DIM       9
SPROCF    DIM       9
SPROCG    DIM       9
SPROCH    DIM       9
SPROCI    DIM       9
SPROCJ    DIM       9
SPROCK    DIM       9
SPROCL    DIM       9
SPROCM    DIM       9
SPROCN    DIM       9
SPROCO    DIM       9
SPROCP    DIM       9
SPROCQ    DIM       9
SPROCR    DIM       9
SPROCS    DIM       9
SPROCT    DIM       9
SPROCU    DIM       9
SPROCV    DIM       9
SPROCW    DIM       9
SPROCX    DIM       9
SPROCY    DIM       9         * Procedure code 024
.*T0889020 - Procedure Code 025-099 from 01/07/2020
SPROC025  DIM       9
SPROC026  DIM       9
SPROC027  DIM       9
SPROC028  DIM       9
SPROC029  DIM       9
SPROC030  DIM       9
SPROC031  DIM       9
SPROC032  DIM       9
SPROC033  DIM       9
SPROC034  DIM       9
SPROC035  DIM       9
SPROC036  DIM       9
SPROC037  DIM       9
SPROC038  DIM       9
SPROC039  DIM       9
SPROC040  DIM       9
SPROC041  DIM       9
SPROC042  DIM       9
SPROC043  DIM       9
SPROC044  DIM       9
SPROC045  DIM       9
SPROC046  DIM       9
SPROC047  DIM       9
SPROC048  DIM       9
SPROC049  DIM       9
SPROC050  DIM       9
SPROC051  DIM       9
SPROC052  DIM       9
SPROC053  DIM       9
SPROC054  DIM       9
SPROC055  DIM       9
SPROC056  DIM       9
SPROC057  DIM       9
SPROC058  DIM       9
SPROC059  DIM       9
SPROC060  DIM       9
SPROC061  DIM       9
SPROC062  DIM       9
SPROC063  DIM       9
SPROC064  DIM       9
SPROC065  DIM       9
SPROC066  DIM       9
SPROC067  DIM       9
SPROC068  DIM       9
SPROC069  DIM       9
SPROC070  DIM       9
SPROC071  DIM       9
SPROC072  DIM       9
SPROC073  DIM       9
SPROC074  DIM       9
SPROC075  DIM       9
SPROC076  DIM       9
SPROC077  DIM       9
SPROC078  DIM       9
SPROC079  DIM       9
SPROC080  DIM       9
SPROC081  DIM       9
SPROC082  DIM       9
SPROC083  DIM       9
SPROC084  DIM       9
SPROC085  DIM       9
SPROC086  DIM       9
SPROC087  DIM       9
SPROC088  DIM       9
SPROC089  DIM       9
SPROC090  DIM       9
SPROC091  DIM       9
SPROC092  DIM       9
SPROC093  DIM       9
SPROC094  DIM       9
SPROC095  DIM       9
SPROC096  DIM       9
SPROC097  DIM       9
SPROC098  DIM       9
SPROC099  DIM       9

ZERO10    INIT      "0000000000"
.
TODATE    DIM       8
TPSYFLG   FORM      1           * 1=Psychatric Admission 0=Not Psychiatric Adm
VALEXT    FORM      1           * Valid External Cause flag
WORKDT1   DATE      8                                                  *I-60344
WORKDT2   DATE      8                                                  *I-60344
WHRS      DIM       2                                                  *I-60344
WMINS     DIM       2                                                  *I-60344
XITEM     DIM       3
.
.PTMIUS10   DIM       3          * USER DEFINED FIELD 10
.PTMIUS11   DIM       3          * USER DEFINED FIELD 11
.
.
CATA      INIT      "A "        * Category A
CATC      INIT      "C "
CATBT     INIT      "BT"        * Category BT
CATCC     INIT      "CC"        * Category CC
CATCL     INIT      "CL"        * Category CL
CATP      INIT      "P "        * Category P
CATS      INIT      "S "        * Category S
CATU1     INIT      "U1"        * Category U1
CATU2     INIT      "U2"        * Category U2
CATU3     INIT      "U3"        * Category U3
CATU4     INIT      "U4"        * Category U4
CATU5     INIT      "U5"        * Category U5
CATU6     INIT      "U6"        * Category U6
CATU7     INIT      "U7"        * Category U7
CATU8     INIT      "U8"        * Category U8
CATU9     INIT      "U9"        * Category U9
CATV1     INIT      "V1"        * Category V1 AUSR field PTMIUS10
CATV2     INIT      "V2"        * Category V2 AUSR field PTMIUS11
CATVA     INIT      "VA"
CATVI     INIT      "VI"
CATKO     INIT      "KO"        * Category KO (Unplanned Readmission)
CATKD     INIT      "KD"        * Category KD (Employment Status)
CATKI     INIT      "KI"        * Category KI (Public/Private Patients)
CATKA     INIT      "KA"        * Category KA (Admission Service Unit Type)
CATDX     INIT      "DX"        * Category DX (Veteran Card)
CATLS     INIT      "LS"        * Category LS (Mental Health Legal Status)
CATP1     INIT      "P1"        * PMI user defined field 1
CATP2     INIT      "P2"        * PMI user defined field 2
CATP3     INIT      "P3"        * PMI user defined field 3
CATP4     INIT      "P4"        * PMI user defined field 4
CATP5     INIT      "P5"        * PMI user defined field 5
CATP6     INIT      "P6"        * PMI user defined field 6
.
.                                           * Unacceptable First Procedure codes
UNACPROC  INIT      "3134000"                                         *I-108284
UNACPR02  INIT      "3273700"
UNACPR03  INIT      "3275701"
UNACPR04  INIT      "3849300"
UNACPR05  INIT      "9857200"
UNACPR06  INIT      "3863700"
UNACPR07  INIT      "3864000"
UNACPR08  INIT      "4557200"
UNACPR09  INIT      "5931800"
UNACPR10  INIT      "5976300"
UNACPR11  INIT      "6007200"
UNACPR12  INIT      "6007500"
UNACPR13  INIT      "6007800"
UNACPR14  INIT      "6050600"
UNACPR15  INIT      "9251600"
UNACPR16  INIT      "9251700"
UNACPR17  INIT      "9251701"
UNACPR18  INIT      "9251702"
UNACPR19  INIT      "9251703"
UNACPR20  INIT      "9741600"
UNACPR21  INIT      "9741800"
.************************************ above used in SEARCH - do not re-arrange
.
SP127     INIT    "                                                           ":
                  "                                                           "
EOCERRD   INIT      "#Episode of Care Incompatible with Admission Type"
ZEROTEN   INIT      "0000000000"
Z20       INIT      "ZZZZZZZZZZZZZZZZZZZZ"
.
.---------------------------------------------------------------------------
PRGID     INIT      "IBABIL54"
PRGNAM    INIT      "SA Health Dept Transmission  "
VERSION   INIT      "V12.01.00"
.---------------------------------------------------------------------------
+
.**************************************************************************
.*                              ML0000                                    *
.*                      Controlling Logic (Mainline code)                 *
.**************************************************************************
.
ML0000    CALL      INIT0000               * initialisation and open files
.
ML0100    CALL      OPTN0000               * select options
          BRANCH    EXIT,ML9000            * EXIT = 1 if 0 chosen in menu
.
          BRANCH    COPTION,ML1000:        * New Submission
                            ML2000:        * Correction
                            ML3000         * Display Items table       *I-60344
          GOTO      ML9000
.
ML1000    CALL      CLEA0000
          CALL      NEWS0000               * Process a new submission
.
          GOTO      ML0100
.
ML2000    CALL      CORR0000               * Process a correction
.
          MOVE      "Y",ANS
          KEYIN     *P1:24,*B,*EL,"Move extract to web directory":
                    "(",*V2LON,*DV,ANSY:
                    *HOFF,"/",*V2LON,*DV,ANSN,*HOFF,") ? ",*RV,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     ANSY,ANS
          IF        @EQUAL
            CALL      MVEXT000               * Move Extracts to File Directory 
          ENDIF
.
          GOTO      ML0100
.
ML3000    MOVE      SP1,ANS
          CALL      DSPL0000               * Display Items table       *I-60344
.
          GOTO      ML0100
.
ML9000    RESET     FILENAME
          MATCH     SP1,FILENAME
          GOTO      ML9950 IF EQUAL
.
          PREP      TEMP1G,FILENAME    
          CLOSE     TEMP1G,DELETE
.
          PREP      TEMP2,FILENAME
          CLOSE     TEMP2,DELETE                * Create the tempfile
.
ML9950    RESET     FNAMEB
          MATCH     SP1,FNAMEB
          GOTO      ML9999 IF EQUAL
.
          PREP      TEMP3,FNAMEB
          CLOSE     TEMP3,DELETE
.
ML9999    CHAIN     PGM                    * chain back to program
+
.****************************************************************************
.*                                INIT0000             Called by: ML0000    *
.*                             initialisation                               *
.*  The initialisation routine is used to display headings and open files.  *
.****************************************************************************
.
INIT0000  CALL      DISPHEAD                  * display heading 
. 
          DISPLAY   *P56:24,"Opening ibapostf";
          OPEN      IBAPOST1,"ibapostf"
. 
          DISPLAY   *P64:24,"pmsccdaf";
          OPEN      PMSCCDA1,"pmsccdaf"
.
          DISPLAY   *P56:24,"Opening patcodes";
          OPEN      PATCODE1,"patcodes"
.
          DISPLAY    *P64:24,"patct1cf";
          OPEN      PATCT1C1,"patct1cf"
.
          DISPLAY   *P64:24,"patdadaf";
          OPEN      PATDADA1,"patdadaf"
.
          DISPLAY   *P64:24,"patvadaf";
          OPEN      PATVADA1,"patvadaf"
.
          DISPLAY   *P64:24,"patdschf";
          OPEN      PATDSCH1,"patdschf"
          OPEN      PATDSCH2,"patdschf"
.
          DISPLAY   *P64:24,"patecdaf";
          OPEN      PATECDA2,"patecdaf"
.
          DISPLAY   *P64:24,"patecoaf";
          OPEN      PATECOA2,"patecoaf"
.
          DISPLAY   *P64:24,"paticuaf";
          OPEN      PATICUA1,"paticuaf"
.
          DISPLAY   *P64:24,"patitemn";
          OPEN      PATITEM1,"patitemn"
.
          CALL      OPICD1
          CALL      OPICO1
.
          DISPLAY   *P64:24,"paticddf";
          OPEN      PATICDD1,"paticddf"
.
          DISPLAY   *P64:24,"paticdof";
          OPEN      PATICDO1,"paticdof"
.
          DISPLAY   *P64:24,"patwr1af";
          OPEN      PATWR1A1,"patwr1af"
.
.          DISPLAY   *P64:24,"patmastf";
.          OPEN      PATMAST1,"patmastf"
          DISPLAY   *P64:24,"patma1af";
          OPEN      PATMA1A1,"patma1af"
          OPEN      PATMX1A1,"patmx1af"
.
.          DISPLAY   *P64:24,"patmissf";
.          OPEN      PATMISS1,"patmissf"
          DISPLAY   *P64:24,"patmi1af";
          OPEN      PATMI1A1,"patmi1af"
          OPEN      PMSVX1A1,"pmsvx1af"
          OPEN      PMSPX2A1,"pmspx2af"
.
          DISPLAY   *P64:24,"patsaiaf";
          OPEN      PATSAIA1,"patsaiaf"
          OPEN      PATSAIA2,"patsaiaf"
.
          DISPLAY   *P64:24,"pattranf";
          OPEN      PATTRAN2,"pattranf"
.
          DISPLAY   *P64:24,"patvisaf";
          OPEN      PATVISA2,"patvisaf" 
.
          DISPLAY   *P64:24,"patwvetf";
          OPEN      PATWVET1,"patwvetf"
.
          DISPLAY   *P64:24,"controlf";
          OPEN      CONTROLF,"controlf"
.
          READ      CONTROLF,ZERO;*43,IBCNMHOS
.
          READ      CONTROLF,HUND31;*1,MRCNDCID * Diagnosis Cluster Identifier
.
          IF        IBCNMHOS = 1
            DISPLAY   *P64:24,"pathspaf";
            OPEN      PATHSPA1,"pathspaf"
          ENDIF
.
          READ      CONTROLF,TEN;*54,CFILENO:
                                 *94,CAGECOFF
          READ      CONTROLF,TEN3;*245,CHOSTYP
.
          READ      CONTROLF,TWENTY1;*220,PTNSWHDP,*216,PTCNDTRF
.                                     *214,PTCNUREA 
.          READ      CONTROLF,SEVENTY7;*215,PTCNUVTH 
          READ      CONTROLF,EIGHTY8;*242,PNSWRACE:
.                                    *237,PTCNEMPL:
.                                     *239,PTCNOCCP,*241,PTCNCSTA:
                                     *59,PTCNI10D  
          READ      CONTROLF,SEVENTY9;*82,PTCNDSCI
.          READ      CONTROLF,SEVENTY9;*114,PTCNPPPT
.          READ      CONTROLF,HUND05;*178,PTCNVETR,*250,PTCNASUT
.
          MOVE      CFILENO,XHOSCOD             * Hospital Code
          REP       " 0",XHOSCOD
.
          PACK      CURDATE,CCC,CYY,CMM,CDD 
          REP       " 0",CURDATE
.
          MOVE      ZERO,ERRFND
          MOVE      ZERO,ICD9FLAG
.
INIT9999  RETURN
+
.****************************************************************************
.*                                OPTN0000             Called by: ML0000    *
.*                        get user options or exit                          *
.*                                                                          *
.*    Returns:  EXIT    = FALSE (0)  Run clean up                           *
.*                        TRUE  (1)  Exit option selected                   *
.****************************************************************************
.
OPTN0000  DISPLAY   *P1:3,*EF,*P1:4,*V2LON,ZERO,*HOFF,". Exit":
                    *P1:5,*V2LON,ONE,*HOFF,". New Submission":
                    *P1:6,*V2LON,TWO,*HOFF,". Correction":
                    *P1:7,*V2LON,THREE,*HOFF,". Display SA HD Items"   *I-60344
.
OPTN0500  KEYIN     *P1:9,*EL,"Select Option : ",*DV,UNDLN1:           *C-60344
                    *P17:9,*V2LON,COPTION                              *C-60344
.
          COMPARE   ZERO,COPTION                 * exit selected ?
          GOTO      OPTN9500 IF EQUAL            * yes
.
          BRANCH    COPTION,OPTN9000,OPTN9000:   * run clean-up
                            OPTN9000                                   *I-60344
.
          BEEP
          GOTO      OPTN0500
.
OPTN9000  MOVE      ZERO,EXIT
          GOTO      OPTN9999
.
OPTN9500  MOVE      ONE,EXIT
.
OPTN9999  RETURN
+
.****************************************************************************
.*                                NEWS0000             Called by: ML0000    *
.*                             New Submission                               *
.****************************************************************************
.
NEWS0000  CALL      SDAT0000                    * Enter Start Date
          CALL      EDAT0000                    * Enter End Date
          CALL      FILE0000                    * Enter File Name
          MOVE      SP30,FNAMEB
.
          CLOSE     TEMP1G
          PREP      TEMP1G,FILENAME          * Open Extract File
.
          MOVE      "file2",FNAMEB 
          CLOSE     TEMP3
          PREP      TEMP3,FNAMEB
.
          CALL      KHOS0000
.
          CALL      CONTQST                     * Ok to continue ?
          BRANCH    CEXIT,NEWS1000:             * yes
                          NEWS0000:             * no
                          NEWS9999              * cancel
.
NEWS1000  MOVE      "2",XRECTYP                 * New Submission Record
          CALL      PROC0000                    * Process Discharge Records
.
          MOVE      ".ack",DIM4
          PACK      FNAMEB,FILENAME,DIM4
.
          PACK      CMDLINE,SP20,SP20,SP20
          CLEAR     CMDLINE
          APPEND    "mv `ldat file2.txt` ",CMDLINE
          APPEND    FNAMEB,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
.         Move Extract .ack to Web Directory
.
          CLEAR     CMDLINE       
          APPEND    "ibabil54.us1 ",CMDLINE
          APPEND    FILENAME,CMDLINE
          APPEND    ".ack",CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID  
.
.         Move Extract to Web Directory
.
          CLEAR     CMDLINE       
          APPEND    "ibabil54.us1 ",CMDLINE
          APPEND    FILENAME,CMDLINE
          APPEND    ".txt",CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID  
.
NEWS9999  RETURN
+
.****************************************************************************
.*                            MVEXT000                 Called by: ML0000    *
.*               Move Extract .txt to Web Directory                         *
.****************************************************************************
MVEXT000  CLEAR     CMDLINE
          APPEND    "ibabil54.us1 ",CMDLINE
          APPEND    FILENAME,CMDLINE       
          APPEND    ".txt",CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
MVEXT999  RETURN
.****************************************************************************
.*                                CORR0000             Called by: ML0000    *
.*                               Correction                                 *
.****************************************************************************
.
CORR0000  CALL      CLEA0000                    * Clear Variables
          MOVE      "5",XRECTYP                 * Correction Record
.
          CALL      FILE0000                    * Enter the file name
.
          IF        EXIT=2
            OPEN      TEMP2,FILENAME
            CALL      READ0000
          ELSE
            CLOSE     TEMP2,DELETE                * Create the tempfile
            PREP      TEMP2,FILENAME
          ENDIF
.
          CALL      CONTQST                     * Ok to continue ?
          BRANCH    CEXIT,CORR1000:             * yes
                          CORR0000:             * no
                          CORR9999              * cancel
.
CORR1000  CALL      EADM0000                    * Enter admission number 
          BRANCH    CEXIT,CORR9999
.
          CALL      DELE0000                    * Delete record from extract?
          MATCH     "1",XDELIND                 * 1=yes
          IF        @EQUAL
            GOTO      CORR3000
          ENDIF
.
CORR2000  CALL      ITNO0000                    * Enter the item number
          BRANCH    CEXIT,CORR1000
.
CORR3000  CALL      KHOS0000
          CALL      MAST0000                    * Master file Details
          CALL      ADMI0000                    * Admission Details
          CALL      DSCH0000                    * Discharge Details
          CALL      TRAN0000                    * Tran file Details
          CALL      VIST0000                    * Visit Details
          CALL      ECDA0000                    * Disease file Details
          CALL      ECOA0000                    * Operations file Detail
          CALL      ICUD0000                    * ICU file Details
.
          MATCH     "1",XDELIND                 * 1=yes
          
          IF        !@EQUAL
            CALL      ITEM0000                    * Load item which is corrected
          ENDIF
.
CORR3100  DISPLAY   *P20:14,*V2LON," ",DITEMNUM,"  ",PTSADESC
          CALL      CONTQST                     * Ok to continue ?
          BRANCH    CEXIT,CORR4000:             * yes
                          CORR1000:             * no
                          CORR9999              * cancel
.
CORR4000  IF        IBCNMHOS=1
            MATCH     SP70,PTHSHOSP
            GOTO      CORR5000 IF EQUAL
.
            PACK      KEY8,SAVADMN,SP70
            CALL      RDPMVX11
            BRANCH    OVRCD,CORR5100
.
            MATCH     PMVXMHOS,PTHSHOSP
            GOTO      CORR5100 IF NOT EQUAL
.
            PACK      XHOSCOD,PTHSHSID,SP70
.
            IF        IBANUM=1
              MOVE      XHOSCOD,XNEWINFO
            ENDIF
.
          ENDIF
.
CORR5000  CALL      ZOBL0000
          CALL      WRIC0000                    * Write to Correction File
CORR5100  MATCH     "1",XDELIND
          GOTO      CORR1000 IF EQUAL
          GOTO      CORR2000
.
CORR9999  RETURN
+
.****************************************************************************
.*                                SDAT0000             Called by: ML0000    *
.*                 Enter the start date for the new submission              *
.****************************************************************************
.
SDAT0000  DISPLAY   *P1:11,*EF,"Starting Date : "
          MOVE      ZERO,DOYR2025
          MOVE      CDD,CDAY                * default to current date
          MOVE      CMM,CMON
          MOVE      CYY,CYEAR
          MOVE      CCC,CCENT
          MOVE      TEN7,CCOL
          MOVE      TEN1,CVERT
          MOVE      ONE,CCANLDTE
          CALL      KEYDATE
          BRANCH    OVRCD,SDAT0000
          PACK      SDATE,CCENT,CYEAR,CMON,CDAY
          REP       " 0",SDATE
.
          MATCH    SDATE,CURDATE           * date cannot be greater than today
          GOTO     SDAT9000 IF LESS
.
.--------*T0934891 - set DOYR2025 flag from 01/07/2025
          SCAN      "PreJulyTest",REPTNAME
          IF        @EQUAL
            MATCH     "20250101",SDATE
          ELSE
            MATCH     "20250701",SDATE
          ENDIF
          IF       !@LESS
            MOVE     ONE,DOYR2025
          ENDIF

          GOTO     SDAT9999
.
SDAT9000  DISPLAY  *P1:24,*V2LON," Date cannot be in the future    ";
          CALL     HITENTER
          GOTO     SDAT0000
.
SDAT9999  RETURN
+
.**************************************************************************
.*                               EDAT0000              Called by: ML0000  *
.*                           Enter ending date                            *
.**************************************************************************
.
EDAT0000  DISPLAY   *P1:12,*EF,"Ending Date   : "
          MOVE      CDD,CDAY                     * default to current date
          MOVE      CMM,CMON
          MOVE      CYY,CYEAR
          MOVE      CCC,CCENT
          MOVE      TEN7,CCOL
          MOVE      TEN2,CVERT
          MOVE      ONE,CCANLDTE
          CALL      KEYDATE
          BRANCH    OVRCD,EDAT0000               * nothing entered
.
          PACK      ENDDTE,CCENT,CYEAR,CMON,CDAY
          REP       " 0",ENDDTE
          PACK      CURDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURDATE
.
          MATCH     ENDDTE,CURDATE                * after current date?
          GOTO      EDAT9000 IF LESS
.
          MATCH     ENDDTE,SDATE                  * after start date?
          GOTO      EDAT9999 IF LESS
          GOTO      EDAT9999 IF EQUAL
.
          DISPLAY   *P1:24,"Ending date must be greater than starting date ";
          CALL      HITENTER
          GOTO      EDAT0000
.
EDAT9000  DISPLAY   *P1:24,"Ending date cannot be in the future ";
          CALL      HITENTER
          GOTO      EDAT0000
.
EDAT9999  RETURN
+
.******************************************************************************
.*                                  FILE0000              Called by: ML0000   *
.*                            Get Extract Filename                            *
.******************************************************************************
FILE0000  MOVE      "14",CVERT
          DISPLAY   *P1:CVERT,*EL,"Extract File  : ";
FILE1000  COMPARE   ONE,COPTION
          IF        @EQUAL
            MOVE      "NSA",KEY4
          ELSE
            MOVE      "CSA",KEY4
          ENDIF
          UNPACK    CURDATE,CCENT,CYEAR,CMON,CDAY
          PACK      FILENAME,KEY4,CMON,CYEAR
          KEYIN     *P17:CVERT,*EL,*V2LON,*RV,FILENAME;
.
          ENDSET    FILENAME
          APPEND    SP8,FILENAME
          RESET     FILENAME
.
          CMATCH    EXITCHAR,FILENAME
          GOTO      FILE9500 IF EQUAL       * Exit
.
          MATCH     SP8,FILENAME
          GOTO      FILE9500 IF EQUAL       * Exit
.
          STRIP     FILENAME
          SQUEEZE   FILENAME
          DISPLAY   *P17:CVERT,*EL,*V2LON,*+,FILENAME,".txt";
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMP1G,FILENAME         *Use TEMP1G from 01/07/2020
          TRAPCLR   IO
          BRANCH    OVRCD,FILE3000          * File doesnt exist
          CLOSE     TEMP1G
.
FILE2000  KEYIN     *P1:24,*B,*EL,"An extraction file with this name":
                    " already exists. Overwrite it (",*V2LON,*DV,ANSY:
                    *HOFF,"/",*V2LON,*DV,ANSN,*HOFF,") ? ",*V2LON,ANS;
          REP       UPPLOW,ANS
          MATCH     ANSY,ANS
          GOTO      FILE9000 IF EQUAL       * Overwrite file
.
          MATCH     ANSN,ANS
          GOTO      FILE1000 IF EQUAL       * Keyin filename again
.
          BEEP
          GOTO      FILE2000
.
FILE3000  MOVE      ZERO,EXIT
          GOTO      FILE9999
.
FILE9000  MOVE      ZERO,EXIT
.
          KEYIN     *P1:24,*B,*EL,"Append to existing file ":
                    "(",*V2LON,*DV,ANSY:
                    *HOFF,"/",*V2LON,*DV,ANSN,*HOFF,") ? ",*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     ANSY,ANS
          GOTO      FILE9600 IF EQUAL       * Overwrite file
.
          MATCH     ANSN,ANS
          GOTO      FILE9100 IF EQUAL       * Keyin filename again
          GOTO      FILE9100
.
FILE9100  MOVE      ZERO,EXIT
          GOTO      FILE9999
.
FILE9500  MOVE      ONE,EXIT
          GOTO      FILE9999
.
FILE9600  MOVE      TWO,EXIT
          GOTO      FILE9999
.
FILE9999  RETURN
+
.**************************************************************************
.*                               PROC0000              Called by:NEWS0000 *
.*                    Loop through the discharge file                     *
.**************************************************************************
.
PROC0000  DISPLAY   *P1:24,*EL,*P20:24,*V2LON,"** Processing Discharges **",*W:
                    *P20:24,*EL,"Admission No. : ";
          MOVE      ZERO,RECCNT
.
          PACK      KEY16,SDATE,SP8
          CALL      RDSDSCH2
PROC1000  CALL      RDKDSCH2
          BRANCH    OVRCD OF PROC9000
.
          MATCH     DDATE,ENDDTE
          GOTO      PROC9000 IF LESS
.
          IF        IBCNMHOS=1
            MATCH     SP70,PTHSHOSP
            GOTO      PROC2000 IF EQUAL
.
            PACK      KEY8,DADMNO,SP70
            CALL      RDPMVX11
            BRANCH    OVRCD,PROC1000
.
            MATCH     PMVXMHOS,PTHSHOSP
            GOTO      PROC1000 IF NOT EQUAL
.
            PACK      XHOSCOD,PTHSHSID,SP70
.
          ENDIF
.
.
.         Only process the patient discharged in the keyin month
.
PROC2000  DISPLAY   *P45:24,*V2LON,DADMNO;
.
          MOVE      DURNO,SAVURNO              * Save the UR number
          PACK      XURNO,SP2,SAVURNO
          REP       " 0",XURNO
.
          MOVE      DDADMNO,SAVADMN             * Save the Admission number
          MOVE      SAVADMN,XADMNO
          REP       " 0",XADMNO
.
          PACK      KEY8,DDADMNO
          CALL      RDMISS1
          BRANCH    OVRCD,PROC8000
.
          PACK      KEY5,CATA,ATYPE
          CALL      RDCODE1
          BRANCH    OVRCD,PROC8000
.
          MATCH     "X",TCINDC5                 * SRF 634626
          GOTO      PROC1000 IF EQUAL
.
          PACK      KEY5,CATCL,ACLAIM
          CALL      RDCODE1
          BRANCH    OVRCD,PROC8000
.
          MATCH     "1",TCINDC6               
          GOTO      PROC1000 IF EQUAL
.
PROC8000  CALL      DETA0000                    * Get details for this discharge
.
          GOTO      PROC1000                    * Read next record
.
PROC9000  MOVE      ZERO,EXIT
          COMPARE   ONE,ERRORS
          IF        @EQUAL
            CALL      UND80
            PRINT     *N,"*** End of Report ***"
            DISPLAY   *P1:24,*EL,*V2LON,"Error Records Found. ";
            CALL      HITENTER
          ELSE
            CALL      IBACLOCK
            CALL      HEAD80
            CALL      UND80
            PRINT     *1,"| No Errors Found",*80,"|"
            CALL      UND80
            PRINT     *1,"*** End of Report ***"            
          ENDIF
.
          DISPLAY     *P1:24,*EL,*V2LON,RECCNT," Records Found. ";
          CALL        HITENTER
          WRITE       TEMP3,SEQ;RECCNT
.
PROC9999  RETURN
+
.**************************************************************************
.*                               DETA0000              Called by: PROC0000*
.*                      Get the details for a discharge                   *
.**************************************************************************
.
DETA0000  CALL      MAST0000                    * Master Details
          CALL      ADMI0000                    * Admission Details
          CALL      DSCH0000                    * Discharge Details
          CALL      TRAN0000                    * Tran file Details
          CALL      VIST0000                    * Visit Details
          CALL      ECDA0000                    * Disease file Details
          CALL      ECOA0000                    * Operations file Detail
          CALL      ICUD0000                    * ICU file Details
          CALL      ZOBL0000
          CALL      WRIT0000                    * Write to Extract File
          CALL      VALD0000                    * Validate data
          CALL      CLEA0000                    * Clear variables
          ADD       ONE,RECCNT
.
DETA9999  RETURN
+
.**************************************************************************
.*                               MAST0000              Called by: DETA0000*
.*                      Get Master file Details                           *
.**************************************************************************
.
.
MAST0000  PACK      KEY8,SAVURNO                * Read the master file record
          CALL      RDMAST1
          BRANCH    OVRCD,MAST9000
.
.                                           * original code for sex desc. has
.                                           * been deleted & replaced by :-
.
          PACK      KEY8,PURNO,SP70         * Read master extension 
          CALL      RDPMPX21                * for XRACE 
          BRANCH    OVRCD,MAST9000
.
          MOVE      PSEX,DSEXCHAR
          CALL      SEXDSC00                * get sex description (in IBACOMN)
.                                           *       returns DSEXDESC & DSEXNO
          MOVE      DSEXNO,XSEX
          COMPARE   NINE,DSEXNO
          IF        !@LESS
            MOVE      ZERO,XSEX                      * Clear variable
            MOVE      "Invalid sex type.",ERRDESC   
            CALL      PRINTERR                       * Print error
          ENDIF
.
          PACK      KEY5,ANSM,SP1,PMSTAT            * Patients Marital Status
          CALL      RDCODE1
          STRIP     THCSCOD
          MOVE      THCSCOD,XMARSTAT
          REP       " 0",XMARSTAT
.
          MOVE      PMEDI,XMEDI                 * Medicare Number
          REP       " 0",XMEDI
.
          MOVE      SP70,XMEDIIRN
          SQUEEZE   PTMXMCCD
          PACK      XMEDIIRN,PTMXMCCD,SP70      * Medicare Reference Number
          REP       " 0",XMEDIIRN
.
          MATCH     "0000000000",XMEDI
          IF        @EQUAL
            PACK      KEY5,ANST,SP1,PTYPE
            CALL      RDCODE1
            MATCH     "1",TCINDC1
            IF        !@EQUAL
              MOVE      "0000000009",XMEDI
            ENDIF
          ENDIF
.
          MATCH     SP70,PSUBRB                 * Suburb
          IF        !@EQUAL
            MOVE      PSUBRB,XSUBURB
            PACK      XSUBURBL,PSUBRB,SP70      * Suburb long version
          ELSE
            MOVE      PADD2,XSUBURB
            PACK      XSUBURBL,PADD2,SP70       * Suburb long version
          ENDIF
.
          MOVE      PPOST,XPOSTCOD              * Post Code
          REP       " 0",XPOSTCOD
.
.
...       PACK      KEY8,PPOST,SP70               * LGA
...       CALL      RDCATC1
...       IF        OVRCD<>1
...         STRIP     CTCLGA
...         MOVE      CTCLGA,FORM4
...         MOVE      FORM4,XLGA
...       ENDIF
...       REP       " 0",XLGA
.
          MOVE      PPOST,DIM4
          PACK      DIM45,XSUBURBL,SP70
          PACK      KEY56,PPOST,DIM45,PADD4,SP70                      *C-240184
          CALL      RDIBPOS1
          COMPARE   ZERO,OVRCD
          GOTO      MAST1100 IF EQUAL
.
          PACK      KEY56,PPOST,DIM45,SP70                            *I-240184
          CALL      RSIBPOS1
          CALL      RKIBPOS1
          BRANCH    OVRCD,MAST1050
          MATCH     PPOST,IBPOPCOD
          IF        @EQUAL
            MATCH     PSUBRB,IBPOSUBR
            GOTO      MAST1100 IF EQUAL
          ENDIF
.
MAST1050  CLEAR     XLGA
          APPEND    "0999",XLGA
          RESET     XLGA
          GOTO      MAST1500
.
MAST1100  UNPACK    IBPOASGC,DIM1,DIM4,DIM4A
          MATCH     "2880",PPOST
          IF        @EQUAL
            MOVE      "0021",XLGA
            GOTO      MAST1500
          ENDIF
          MATCH     "1",DIM1
          IF        @EQUAL
            MOVE      "0011",XLGA
            GOTO      MAST1500
          ENDIF
          MATCH     "9",DIM1
          IF        @EQUAL
            MOVE      "0010",XLGA
            GOTO      MAST1500
          ENDIF
          MATCH     "4",DIM1
          IF        @EQUAL
            MOVE      DIM4A,XLGA
            GOTO      MAST1500
          ENDIF
          CLEAR     XLGA
          APPEND    "000",XLGA
          APPEND    DIM1,XLGA
          RESET     XLGA
.
MAST1500  PACK      KEY5,CATC,PCONT
          CALL      RDCODE1
          BRANCH    OVRCD,MAST2000
.
MAST2000  MOVE      "9999",XCOUNTRY
          MATCH     "20010701",SDATE
          IF        @LESS
            MATCH     SP4,THCSCOD
            IF        !@EQUAL
              MOVE      THCSCOD,XCOUNTRY              * Country of Birth
            ENDIF
          ELSE
            COMPARE   ZERO,TCFORM6
            IF        !@EQUAL
              MOVE      TCFORM6,DIM6
              UNPACK    DIM6,DIM2,XCOUNTRY         * Country of Birth
              REP       " 0",XCOUNTRY
            ELSE
              MOVE      "0000",XCOUNTRY
            ENDIF
          ENDIF
.
          UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY * Birth Date
          PACK      XPBDATE,CDAY,CMON,CCENT,CYEAR
          REP       " 0",XPBDATE
          MATCH     "00000000",XPBDATE
          IF        @EQUAL
            MOVE      "01070000",XPBDATE
          ENDIF
.                                               * which user defined for race?
          UNPACK    SP5,DIM2,DIM3
          LOAD      DIM2,PNSWRACE,CATP1,CATP2,CATP3,CATP4,CATP5:
                                   CATP6,CATU1,CATU2,CATU3,CATU4:
                                   CATU5,CATU6,CATU7,CATVA
          LOAD      DIM3,PNSWRACE,PUSR1,PUSR2,PUSR3,PUSR4,PUSR5:
                                   PUSR6,AUSR1,AUSR2,AUSR3,AUSR4:
                                   AUSR5,AUSR6,AUSR7,PMPXABRG
.
          PACK      KEY5,DIM2,DIM3
          CALL      RDCODE1                     * Read a codes file record
          IF        OVRCD <> 1
            UNPACK    THCSCOD,ANS,XRACE,ANS,ANS    * Indigenous Status
          ENDIF
          REP       " 9",XRACE
.
MAST8000  MOVE      "Gi",DIM2
          MOVE      PMPXUCC4,DIM3
          PACK      KEY5,DIM2,DIM3
          CALL      RDCODE1    
          IF        OVRCD = 0
            UNPACK    THCSCOD,XPRCGEND
            MOVE      ZERO,FORM1
            MOVE      XPRCGEND,FORM1
            IF        FORM1<1 | FORM1>5 & FORM1<9
              MOVE      SP70,XPRCGEND
              MOVE      "Invalid Gender code - not reported",ERRDESC
              CALL      PRINTERR 
            ENDIF
          ENDIF
.
          GOTO      MAST9999
.
MAST9000  DISPLAY   *P1:24,*V2LON,SAVURNO," *** Missing Master file record ***"
.
MAST9999  RETURN
+
.**************************************************************************
.*                               ADMI0000              Called by: DETA0000*
.*                      Get Admission file Details                        *
.**************************************************************************
.
ADMI0000  PACK      KEY8,SAVADMN
          CALL      RDMISS1                     * Read Admission record
          BRANCH    OVRCD,ADMI9000
.
          PACK      KEY8,DAADMNO,SP70
          CALL      RDPMVX11
          BRANCH    OVRCD,ADMI9000 
.
          PACK      KEY8,AURNO,SP70
          CALL      RDPMPX21
          BRANCH    OVRCD,ADMI9000
. 
          MOVE      ZERO,FORM1 
. 
          MATCH     CATU1,DIM2                 * Adm u/d field for race
          IF        @EQUAL
            MOVE        ONE,FORM1
          ENDIF
.
          MATCH     CATU2,DIM2
          IF        @EQUAL
            MOVE      TWO,FORM1
          ENDIF
.
          COMPARE   ZERO,FORM1
          GOTO      ADMI1000 IF EQUAL
.
          LOAD      DIM3,FORM1,AUSR1,AUSR2
.
          PACK      KEY5,DIM2,DIM3
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      THCSCOD,XRACE
          ENDIF
          REP       " 0",XRACE
.
ADMI1000  MOVE      ZERO,FORM3
          MATCH     SP70,ACLSSFT
          IF        !@EQUAL
            PACK      KEY5,ANSA,ANSC,ACLSSFT,SP70     * Clinic Code / Cat AC
            CALL      RDCODE1
            IF        OVRCD<>1
              MATCH     SP3,THCSCOD
              IF        !@EQUAL
                STRIP     THCSCOD
                MOVE      THCSCOD,FORM3
              ENDIF
              MOVE      FORM3,XCLINCOD
            ENDIF
          ENDIF
          REP       " 0",XCLINCOD
.
          PACK      CATEG,SP6
          PACK      CODE,SP6
          IF        PTCNDSCI=0
            PACK      CATEG,CATP
            PACK      CODE,ACLSS
          ELSE
            LOAD      CATEG,PTCNDSCI,CATU1,CATU2,CATU3,CATU4,CATU5,CATVI
            LOAD      CODE,PTCNDSCI,AUSR1,AUSR2,AUSR3,AUSR4,AUSR5,PMVXIDUS
          ENDIF
.
          PACK      KEY5,CATEG,CODE              * Patient Category
          CALL      RDCODE1 
          IF        OVRCD<>1
            MOVE      THCSCOD,XPACLSS
          ENDIF
          REP       " 0",XPACLSS
.
          PACK      KEY5,CATS,ASRCE             * Source of Referral
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      THCSCOD,XSASRCE
          ENDIF
.
          MOVE      SP1,XATYPE
          PACK      KEY5,CATCC,ACARE            * Admission Type
          CALL      RDCODE1
          IF        OVRCD<>1
            MATCH   SP1,TCINDC10
            IF        !@EQUAL
              MOVE      TCINDC10,XATYPE
            ENDIF
          ENDIF
          REP       " 1",XATYPE
.
          UNPACK    ADATE,CCENT,CYEAR,CMON,CDAY * Admission date
          PACK      XADATE,CDAY,CMON,CCENT,CYEAR
          REP       " 0",XADATE
.
          MOVE      SP5,CATEG
          MOVE      SP3,DIM3
.
          MOVE      "9",XUSUACC
          MATCH     SP3,PMVXUSAC
          IF        !@EQUAL
            PACK      KEY5,ANSK,ANSP,PMVXUSAC,SP70
            CALL      RDCODE1               * Read the codes file
            IF        OVRCD<>1
              MOVE      THCSCOD,XUSUACC     * Usual accomodation
            ENDIF
          ENDIF
          REP       " 0",XUSUACC
.
          MATCH     SP3,PMVXASUT
          IF        !@EQUAL
            PACK      KEY5,CATKA,PMVXASUT           * Admission Category
            CALL      RDCODE1
            IF        OVRCD<>1
              MOVE      TCINDC1,XADMCAT
            ENDIF
          ENDIF
.
          REP       " 1",XADMCAT
.
          MATCH     "1",XADMCAT
          GOTO      ADMI1500 IF EQUAL
.
          MATCH     XSASRCE,ANSA
          GOTO      ADMI1400 IF EQUAL
.
          MATCH     XSASRCE,ANSE
          GOTO      ADMI1500 IF NOT EQUAL
.
ADMI1400  MOVE      "Adm Category incorrect for Admin Admission",ERRDESC
          CALL      PRINTERR                       * Print error
.
ADMI1500  PACK      KEY5,CATCC,ACARE            * Episode of Care
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      TCINDC7,XEOC
          ENDIF
          REP       " 0",XEOC
.
          MATCH     "20010701",SDATE
          GOTO      ADMI2000 IF LESS
.
          PACK      KEY5,CATCL,ACLAIM           * Admission Type
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      THCSCOD,XFUNDSRC
          ENDIF
.
ADMI2000  UNPACK    ABWGHT,DIM2,XADWGHT         * Admission Weight(grams)
          REP       " 0",XADWGHT
.
          REP       " 0",ATIME
          REP       ": ",ATIME                  * Admission Time
          SQUEEZE   ATIME
          MOVE      ATIME,XADMTIME
.
.                                               * Unplanned Readmission
          MOVE      THREE,XUNREAD               * set default
.                    *********** Increase Indicators to U1-U9,V1 & V2 *C-105249
          UNPACK    SP10,KEY2,CODE,THCSCOD
.
          MATCH     SP3,PMVXUREA
          IF        !@EQUAL
            PACK      KEY5,CATKO,PMVXUREA,SP5                       *I-105249
            CALL      RDCODE1
            IF        OVRCD<>1
              UNPACK    THCSCOD,DIM1,XUNREAD
            ENDIF
          ENDIF
.
          REP       " 3",XUNREAD
          REP       "Y1N2",XUNREAD
.
          MOVE      SP70,XUNREAD
          MATCH     "04",XFUNDSRC
          GOTO      ADMI8000 IF NOT EQUAL
.
          MOVE      SP10,ACODE                  * Veteran Card
          MOVE      ZERO,FORM1
          UNPACK    SP2,DIM1,DIM1A
.
.         Get DVA Number using concession card details
.
          MOVE      THREE,DIM1                  * set for DVA card type
          CALL      GCCARD00                    * get DVA card details
          PACK      KEY5,CATDX,PMCDDVAC
          CALL      RDCODE1
          IF        OVRCD = 0
            PACK      XVETCARD,THCSCOD
          ENDIF
.
          MOVE      PMCDCNUM,XVETNUM
.          PACK      KEY8,SAVADMN                * Get Veteran Card Number
.          CALL      RDWVET1
.          IF        OVRCD<>1
.            MOVE      VCLMNO,XVETNUM
.          ENDIF
.
ADMI8000  MOVE      SP10,ACODE                  * Get Employment Status
          MOVE      ZERO,FORM1
          UNPACK    SP2,DIM1,DIM1A
.
          MATCH     SP3,PMVXEMPL
          IF        !@EQUAL
            PACK      KEY5,CATKD,PMVXEMPL,SP70
            CALL      RDCODE1
            IF        OVRCD = 0
              UNPACK    THCSCOD,DIM1,DIM2        * Employment status
              PACK      XEMPSTAT,DIM1,SP2
            ENDIF
          ENDIF
          REP       " 0",XEMPSTAT
.
ADMI8010  MATCH     SP3,PMVXMHLS
          IF        !@EQUAL
          PACK      KEY5,CATLS,PMVXMHLS       * Mental Health Legal Stat
            CALL      RDCODE1
            IF        OVRCD<>1
              MOVE      TCINDC5,XLEGSTAT
            ENDIF
          ENDIF
.         
          REP       " 3",XLEGSTAT
.
          PACK      KEY5,CATCL,ACLAIM
          CALL      RDCODE1
          IF        OVRCD<>1
            MATCH     "2",TCINDC7
            IF        @EQUAL
              MOVE      "2",XINSSTAT           * health-fund not acknowledged
              GOTO      ADMI9999
            ENDIF
          ENDIF
.
          MOVE      "2",XINSSTAT           * insurance status - not insured
          MATCH     SP6,AFUNDH
          IF        !@EQUAL
            MOVE      "1",XINSSTAT         * insured
          ENDIF
.
          GOTO      ADMI9999
.
.
ADMI9000  DISPLAY   *P1:24,*V2LON,SAVADMN,"*** Missing Admission Record ***"
.
ADMI9999  RETURN
+
.**************************************************************************
.*                               DSCH0000              Called by: DETA0000*
.*                      Get Discharge file Details                        *
.**************************************************************************
.
DSCH0000  PACK      KEY8,SAVADMN
          CALL      RDDSCH1
          BRANCH    OVRCD,DSCH9999
.
          UNPACK    DDATE,CCENT,CYEAR,CMON,CDAY * Separation Date
          PACK      XSEPDATE,CDAY,CMON,CCENT,CYEAR
          REP       " 0",XSEPDATE
.
          REP       " 0",DTIME
          REP       ": ",DTIME                  * Separation Time
          SQUEEZE   DTIME
          MOVE      DTIME,XSEPTIME
.
DSCH1000  REP       " 0",XHTRANFR               * default XHTRANFR = "0000"
          REP       " 0",XHTRANTO               * default XHTRANTO = "0000"
          UNPACK    SP70,PTDAADTS,PTDADCTS
          PACK      KEY8,AADMNO
          CALL      RDPTDAD1                    * read Patient Transfer Src/Dest
          BRANCH    OVRCD,DSCH2000
.
          PACK      KEY5,CATS,ASRCE
          CALL      RDCODE1                     * read Cat."S "
          BRANCH    OVRCD,DSCH1500
.
          MOVE      ZERO,FORM4
          MATCH     "4",THCSCOD                 * HDP of 4
          IF        @EQUAL
            PACK      KEY5,PTDAADTS,SP70        * setup "Transfer From"
            CALL      RDPTVAD1                  * read Transfer Destination Code
            IF        OVRCD <> 1
              MATCH     SP70,PTVANHSC
              IF        !@EQUAL
                MOVE      PTVANHSC,XHTRANFR     * Hospital Transferred from
              ENDIF
            ENDIF
          ENDIF
.
DSCH1500  MOVE      ZERO,EXIT
          IF        PTCNDTRF = 1
            PACK      KEY5,ANSD,SP1,DSTAT       * Using Cat D
          ELSE
            PACK      KEY5,ANSD,ANSD,DDEST      * Using Cat DD
          ENDIF
          CALL      RDCODE1                     * Cat."D " or Cat."DD"
          BRANCH    OVRCD,DSCH2000
.
          MATCH     "1",TCINDC2
          IF        @EQUAL
            PACK      KEY5,PTDADCTS,SP70
            CALL      RDPTVAD1                  * read Transfer Destination Code
            IF        OVRCD <> 1
              MATCH     SP70,PTVANHSC
              IF        !@EQUAL
                MOVE      PTVANHSC,XHTRANTO     * Valid transfer source
              ENDIF
            ENDIF
          ENDIF
.
DSCH2000  MOVE      ZERO,EXIT
.
DSCH8000  PACK      KEY5,SP10                   * Nature of Separation
          IF        PTNSWHDP = 1
            MATCH     SP3,DSTAT
            IF        !@EQUAL
              PACK      KEY5,ANSD,SP1,DSTAT     * Using Category D
            ENDIF
          ELSE
            MATCH     SP3,DDEST
            IF        !@EQUAL
              PACK      KEY5,ANSD,ANSD,DDEST    * Using Category DD
            ENDIF
          ENDIF
          CALL      RDCODE1
          IF        OVRCD<>1
            UNPACK    THCSCOD,XNATSEP                         
          ENDIF
          REP       " 0",XNATSEP
.
.
DSCH9999  RETURN
+
.**************************************************************************
.*                               VIST0000              Called by: DETA0000*
.*                      Get Visit file Details                            *
.**************************************************************************
.
VIST0000  MOVE      AADMNO,SAVADMN
          MOVE      ZERO,XPSYCAD
.
          MOVE      ONE,XPSYCAD
.
          MOVE      ZERO,OLDDVAS
          PACK      OLDINDS,SP70
.
          MOVE      AURNO,PVIURNO
          PACK      PVIDATE,ADATE
          REP       " 0",PVIDATE
          PACK      KEY24,PVIURNO,PVIDATE,Z20
          CALL      RDSVISA2
VIST1000  CALL      RDPVISA2
          BRANCH    OVRCD,VIST3000
.
          MATCH     PVIURNO,SAVURNO        * Same U/R number ?
          GOTO      VIST3000 IF NOT EQUAL
.
          MATCH     DPVIBILL,SAVADMN
          GOTO      VIST1000 IF EQUAL
.
          MOVE      PVIBILL,AADMNO
          MOVE      AADMNO,KEY8
          CALL      RDMISS1
          BRANCH    OVRCD,VIST1000
.
          PACK      KEY5,CATCL,ACLAIM           * Admission Type
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      THCSCOD,KEY2
          ENDIF
.
          UNPACK    KEY2,KEY1,DIM1      * handles  - eg."1 ", "4 " & "11"
          MATCH     SP1,DIM1
          IF        @EQUAL
            PACK      KEY2,SP1,KEY1
          ENDIF
.
          MOVE      KEY2,OLDDVAS
.                                               * which user defined for race?
          UNPACK    SP5,DIM2,DIM3
          LOAD      DIM2,PNSWRACE,CATP1,CATP2,CATP3,CATP4,CATP5:
                                   CATP6,CATU1,CATU2,CATU3,CATU4:
                                   CATU5,CATU6,CATU7,CATVA
          LOAD      DIM3,PNSWRACE,PUSR1,PUSR2,PUSR3,PUSR4,PUSR5:
                                   PUSR6,AUSR1,AUSR2,AUSR3,AUSR4:
                                   AUSR5,AUSR6,AUSR7,PMPXABRG
.
          PACK      KEY5,DIM2,DIM3
          CALL      RDCODE1                     * Read a codes file record
          IF        OVRCD <> 1
            UNPACK    THCSCOD,ANS,OLDINDS,ANS,ANS    * Indigenous Status
          ENDIF
          REP       " 9",OLDINDS
          MATCH     CATU1,DIM2                 * Adm u/d field for race
          IF        @EQUAL
            MOVE        ONE,FORM1
          ENDIF
.
          MATCH     CATU2,DIM2
          IF        @EQUAL
            MOVE      TWO,FORM1
          ENDIF
.
          COMPARE   ZERO,FORM1
          GOTO      VIST2000 IF EQUAL
.
          LOAD      DIM3,FORM1,AUSR1,AUSR2
.
          PACK      KEY5,DIM2,DIM3
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      THCSCOD,OLDINDS
          ENDIF
          REP       " 0",OLDINDS
.
VIST2000  COMPARE   ONE,TPSYFLG
          IF        @EQUAL
            PACK      KEY5,ANSA,SP1,ATYPE
            CALL      RDCODE1
            CMATCH    ANSP,TCINDC3            * 3rd indicator a "P" ?
            IF        OVRCD = 0 & @EQUAL
              MOVE      "2",XPSYCAD           * no to first visit
              GOTO      VIST3000
            ENDIF
          ENDIF
.---------GOTO      VIST1000-----------------------------------------*T0887026
.
VIST3000  MOVE      SAVADMN,KEY8
          CALL      RDMISS1
.
VIST9999  MOVE      SP70,XPSYCAD
          RETURN
+
.**************************************************************************
.*                               TRAN0000              Called by: DETA0000*
.*                      Get Tran file Details                             *
.**************************************************************************
.
TRAN0000  MOVE      ZERO,LEAVECNT               * Leave count
          MOVE      ZERO,RETCNT
          MOVE      ONE,COUNT                   * Status change count
          MOVE      SP8,SAVATYPE
          MOVE      SP8,SAVADELC
          MOVE      ZERO,FNDRECA
          MOVE      ZERO,TPSYFLG
          REP       " 0",XSTCHGD1               
          REP       " 0",XSTCHGD2
          REP       " 0",XSTCHGD3
          REP       " 0",XSTCHGA1
          REP       " 0",XSTCHGA2
          REP       " 0",XSTCHGA3
          REP       " 0",XSTCHGE1
          REP       " 0",XSTCHGE2
          REP       " 0",XSTCHGE3
. 
          PACK      KEY30,SAVADMN,SP30
          CALL      RDSTRAN2
TRAN1000  CALL      RDKTRAN2
          BRANCH    OVRCD,TRAN9999
.
          MATCH     SAVADMN,DTADMN              * Same Admission no
          GOTO      TRAN9999 IF NOT EQUAL
.
          MATCH     "A",TMOVE                   * Discharge record
          IF        @EQUAL
            PACK      XADMWARD,TWARD,SP70
          ENDIF
.
          MATCH     "D",TMOVE                   * Discharge record
          IF        @EQUAL
            PACK      XDISWARD,TWARD,SP70
            CALL      GETDL000                  * Get discharge lounge details
            GOTO      TRAN9999
          ENDIF
.
          MATCH     "L",TMOVE                   * Leave record
          IF        @EQUAL
            ADD       ONE,LEAVECNT
          ELSE
            GOTO      TRAN1400
          ENDIF
.
          COMPARE   ONE,LEAVECNT
          IF        @EQUAL 
            UNPACK    TDATE,CCENT,CYEAR,CMON,CDAY     * Get leave date 1
            PACK      XLEAVFD1,CDAY,CMON,CCENT,CYEAR
            REP       " 0",XLEAVFD1
            REP       " 0",TTIME                      * Get leave time 1
            REP       ": ",TTIME
            SQUEEZE   TTIME
            MOVE      TTIME,XLEAVFT1
          ENDIF
.
          COMPARE   TWO,LEAVECNT
          IF        @EQUAL 
            UNPACK    TDATE,CCENT,CYEAR,CMON,CDAY     * Get leave date 2
            PACK      XLEAVFD2,CDAY,CMON,CCENT,CYEAR
            REP       " 0",XLEAVFD2
            REP       " 0",TTIME                      * Get leave time 2
            REP       ": ",TTIME
            SQUEEZE   TTIME
            MOVE      TTIME,XLEAVFT2
          ENDIF
.
          COMPARE   THREE,LEAVECNT
          IF        @EQUAL 
            UNPACK    TDATE,CCENT,CYEAR,CMON,CDAY     * Get leave date 3
            PACK      XLEAVFD3,CDAY,CMON,CCENT,CYEAR
            REP       " 0",XLEAVFD3
            REP       " 0",TTIME                      * Get leave time 3
            REP       ": ",TTIME
            SQUEEZE   TTIME
            MOVE      TTIME,XLEAVFT3
          ENDIF
.
          COMPARE   FOUR,LEAVECNT
          IF        @EQUAL 
            UNPACK    TDATE,CCENT,CYEAR,CMON,CDAY     * Get leave date 4
            PACK      XLEAVFD4,CDAY,CMON,CCENT,CYEAR
            REP       " 0",XLEAVFD4
            REP       " 0",TTIME                      * Get leave time 4
            REP       ": ",TTIME
            SQUEEZE   TTIME
            MOVE      TTIME,XLEAVFT4
          ENDIF
.
TRAN1400  MATCH     "R",TMOVE                   * Return record
          IF        @EQUAL
            ADD       ONE,RETCNT
          ELSE
            GOTO      TRAN1600
          ENDIF
.
          COMPARE   ONE,RETCNT
          IF        @EQUAL
            UNPACK    TDATE,CCENT,CYEAR,CMON,CDAY     * Get leave to date 1
            PACK      XLEAVTD1,CDAY,CMON,CCENT,CYEAR
            REP       " 0",XLEAVTD1
            REP       " 0",TTIME                      * Get leave to time 1
            REP       ": ",TTIME
            SQUEEZE   TTIME
            MOVE      TTIME,XLEAVTT1
          ENDIF
.
          COMPARE   TWO,RETCNT
          IF        @EQUAL
            UNPACK    TDATE,CCENT,CYEAR,CMON,CDAY     * Get leave to date 2
            PACK      XLEAVTD2,CDAY,CMON,CCENT,CYEAR
            REP       " 0",XLEAVTD2
            REP       " 0",TTIME                      * Get leave to time 2
            REP       ": ",TTIME
            SQUEEZE   TTIME
            MOVE      TTIME,XLEAVTT2
          ENDIF
.
          COMPARE   THREE,RETCNT
          IF        @EQUAL
            UNPACK    TDATE,CCENT,CYEAR,CMON,CDAY     * Get leave to date 3
            PACK      XLEAVTD3,CDAY,CMON,CCENT,CYEAR
            REP       " 0",XLEAVTD3
            REP       " 0",TTIME                      * Get leave to time 3
            REP       ": ",TTIME
            SQUEEZE   TTIME
            MOVE      TTIME,XLEAVTT3
          ENDIF
.
          COMPARE   FOUR,RETCNT
          IF        @EQUAL
            UNPACK    TDATE,CCENT,CYEAR,CMON,CDAY     * Get leave to date 4
            PACK      XLEAVTD4,CDAY,CMON,CCENT,CYEAR
            REP       " 0",XLEAVTD4
            REP       " 0",TTIME                      * Get leave to time 4
            REP       ": ",TTIME
            SQUEEZE   TTIME
            MOVE      TTIME,XLEAVTT4
          ENDIF
.
TRAN1600  BRANCH    FNDRECA,TRAN3000
          MATCH     "A",TMOVE                 * Admission record
          GOTO      TRAN1000 IF NOT EQUAL
.
TRAN2000  REP       " 0",XLEAVFD1
          REP       " 0",XLEAVFT1
          REP       " 0",XLEAVTD1
          REP       " 0",XLEAVTT1
          REP       " 0",XLEAVFD2
          REP       " 0",XLEAVFT2
          REP       " 0",XLEAVTD2
          REP       " 0",XLEAVTT2
          REP       " 0",XLEAVFD3
          REP       " 0",XLEAVFT3
          REP       " 0",XLEAVTD3
          REP       " 0",XLEAVTT3
          REP       " 0",XLEAVFD4
          REP       " 0",XLEAVFT4
          REP       " 0",XLEAVTD4
          REP       " 0",XLEAVTT4
          MOVE      SP4,THCSCOD
          PACK      KEY5,CATA,TATYPE
          CALL      RDCODE1
          CMATCH    ANSP,TCINDC3
          IF        OVRCD=0 & @EQUAL
            MOVE      ONE,TPSYFLG             * Psychiatric admission
          ENDIF
          IF        TPSYFLG = 1
            PACK      KEY5,CATCL,ACLAIM       * Pension Status
            CALL      RDCODE1
            IF        OVRCD<>1
              MATCH     SP4,THCSCOD
              IF        !@EQUAL
                MOVE      THCSCOD,XPENSTAT
              ENDIF
            ENDIF
          ENDIF
          REP       " 0",XPENSTAT
.
          UNPACK    SP8,CATEG
          UNPACK    SP8,CODE
.
          MATCH     SP3,PMVXPPPT
          IF        !@EQUAL
            PACK      KEY5,CATKI,PMVXPPPT,SP70
            CALL      RDCODE1
            IF        OVRCD <> 1
              MOVE      THCSCOD,XADELEC           * Admission election
              MOVE      THCSCOD,SAVADELC         * Save admission type
            ENDIF
          ENDIF 
.
          REP       " 2",XADELEC
.
          MOVE      ONE,FNDRECA                * Found record "A" Flag
          GOTO      TRAN1000
.
TRAN3000  PACK      KEY5,CATCL,TCHSTAT
          CALL      RDCODE1
.
TRAN3200  UNPACK    SP8,CATEG
          GOTO      TRAN1000
.
TRAN9999  RETURN
+
.**************************************************************************
.*                               GETDL000              Called by: TRAN0000*
.*                Get discharge lounge details                            *
.**************************************************************************
GETDL000  PACK      KEY6,XDISWARD,SP70
          CALL      RDWARD1
          BRANCH    OVRCD,GETDL999
.
          MATCH     SP70,WCLASS
          GOTO      GETDL999 IF EQUAL
.
          PACK      KEY5,ANSC,ANSG,WCLASS,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,GETDL999
.
          MATCH     ANSD,TCINDC1
          GOTO      GETDL999 IF NOT EQUAL
.
          PACK      KEY30,SAVADMN,Z70
          CALL      RDSTRAN2
GETDL100  CALL      RDPTRAN2
          BRANCH    OVRCD,GETDL999
.
          MATCH     DTADMN,SAVADMN
          GOTO      GETDL999 IF NOT EQUAL
.
          MATCH     XDISWARD,TWARD
          GOTO      GETDL999 IF NOT EQUAL
.
          PACK      XDTTODL,TDATE,SP70
          REP       " 0",XDTTODL
.
          REP       ": ",TTIME
          SQUEEZE   TTIME
          MOVE      TTIME,XTTTODL
          REP       " 0",XTTTODL
.
          GOTO      GETDL100 
.
GETDL999  RETURN
+
.
.**************************************************************************
.*                               ECDA0000              Called by: DETA0000*
.*                Read through patecdaf for disease codes                 *
.**************************************************************************
.
ECDA0000  MOVE      ONE,NUMDIAG
          MOVE      ONE,COUNT2
          MOVE      ZERO,PRINCFLG               * no principal condition
          MOVE      ZERO,CMPCNT
          MOVE      ZERO,ICD9FLAG
.
          MOVE      ZERO,COUNTCAD
          MOVE      SP70,XDCIDFPD
          MOVE      SP70,XPDCIFEC
          MOVE      SP70,XPDCIFPP
          MOVE      SP70,XPDCIFAJ
          MOVE      ZERO,DCFLAGEC
          MOVE      ZERO,DCFLAGPC
          MOVE      ZERO,DCFLAGWI
          MOVE      SP70,TEMPDCID
.
          PACK      KEY16,AADMNO,SP20
          CALL      RSPTECD2
ECDA1000  CALL      RKPTECD2
          BRANCH    OVRCD,ECDA9999
.
          MOVE      ZERO,ADDGFLAG                                      *I-52873
.
          MATCH     AADMNO,PTEDADMN
          GOTO      ECDA9999 IF NOT EQUAL
.
          MOVE      PTEDDTCD,ICDRDDTE
          PACK      KEY9,PTEDCODE,SP70
          CALL      RDPTICD1
          BRANCH    OVRCD,ECDA1000
.
ECDA2400  MOVE      DPCODE,KEY9
          CALL      RMDT0000
.
          MOVE      SP5,DIM4
          MOVE      SP1,DIM1
.
.        DOYR2025 And Cluster Id Parameter validation
          IF        DOYR2025 = 1      * DOYR2025
            MATCH     "1",MRCNDCID    * DCID parameter ticked ?
            IF        @EQUAL
.
              MOVE      SP70,SAVEKEY5
              UNPACK    KEY7,SAVEKEY5,DIM2
.
. 5.2.3  Populate Diagnosis Cluster Identifier for External Cause  *0961700
              IF        DCFLAGEC < 1
                MATCH     "Y9899",SAVEKEY5
                IF        @EQUAL | @LESS
                  MATCH     "U7400",SAVEKEY5
                  IF        !@LESS
                    MATCH     "2",PT0DACRQ
                    IF        @EQUAL
                      PACK      XPDCIFEC,PTEDDCID,SP70
                      RJUSTIFY  XPDCIFEC
                      MOVE      ONE,DCFLAGEC
                    ENDIF
                  ENDIF
                ENDIF
              ENDIF
.
. 5.2.4  Populate Diagnosis Cluster Identifier for Place of Occurrence *0961700
              IF        DCFLAGPC < 1
                MATCH     "Y9299",SAVEKEY5
                IF        @EQUAL | @LESS
                  MATCH     "Y9200",SAVEKEY5
                  IF        !@LESS
                    MATCH     "P",PT0DACRQ
                    IF        @EQUAL
                      PACK      XPDCIFPP,PTEDDCID,SP70
                      RJUSTIFY  XPDCIFPP
                      MOVE      ONE,DCFLAGPC
                    ENDIF
                  ENDIF
                ENDIF
              ENDIF
.
. 5.2.5 Populate Diagnosis Cluster Identifier for Activity When Injured *0961700
              IF        DCFLAGWI < 1
                MATCH     "U7399",SAVEKEY5
                IF        @EQUAL | @LESS
                  MATCH     "U5000",SAVEKEY5
                  IF        !@LESS
                    MATCH     "A",PT0DACRQ
                    IF        @EQUAL
                      PACK      XPDCIFAJ,PTEDDCID,SP70
                      RJUSTIFY  XPDCIFAJ
                      MOVE      ONE,DCFLAGWI
                    ENDIF
                  ENDIF
                ENDIF
              ENDIF
.
              MOVE      ZERO,FORM3
              MOVE      DPTEDCNT,FORM3
              COMPARE   ONE,FORM3     * Episode Unique Counter
              IF         @EQUAL
                CMATCH    "P",PTEDTYPE
                IF        @EQUAL
                  PACK       XDCIDFPD,PTEDDCID,SP70
. 5.2.1 Populate Diagnosis Cluster Identifier for Principal Diagnosis *0961700
                  RJUSTIFY   XDCIDFPD    * Rjustify
                ENDIF
              ELSE
                ADD        ONE,COUNTCAD
. 5.2.2 Populate Diagnosis Cluster Identifier for Additional Diagnosis *0961700
                IF         COUNTCAD < 100
                  PACK       TEMPDCID,PTEDDCID,SP70
                  RJUSTIFY   TEMPDCID    * Rjustify
                  STORE      TEMPDCID,COUNTCAD,XDCAD001,XDCAD002,XDCAD003:
                                   XDCAD004,XDCAD005:
                                   XDCAD006,XDCAD007,XDCAD008,XDCAD009,XDCAD010:
                                   XDCAD011,XDCAD012,XDCAD013,XDCAD014,XDCAD015:
                                   XDCAD016,XDCAD017,XDCAD018,XDCAD019,XDCAD020:
                                   XDCAD021,XDCAD022,XDCAD023,XDCAD024,XDCAD025:
                                   XDCAD026,XDCAD027,XDCAD028,XDCAD029,XDCAD030:
                                   XDCAD031,XDCAD032,XDCAD033,XDCAD034,XDCAD035:
                                   XDCAD036,XDCAD037,XDCAD038,XDCAD039,XDCAD040:
                                   XDCAD041,XDCAD042,XDCAD043,XDCAD044,XDCAD045:
                                   XDCAD046,XDCAD047,XDCAD048,XDCAD049,XDCAD050:
                                   XDCAD051,XDCAD052,XDCAD053,XDCAD054,XDCAD055:
                                   XDCAD056,XDCAD057,XDCAD058,XDCAD059,XDCAD060:
                                   XDCAD061,XDCAD062,XDCAD063,XDCAD064,XDCAD065:
                                   XDCAD066,XDCAD067,XDCAD068,XDCAD069,XDCAD070:
                                   XDCAD071,XDCAD072,XDCAD073,XDCAD074,XDCAD075:
                                   XDCAD076,XDCAD077,XDCAD078,XDCAD079,XDCAD080:
                                   XDCAD081,XDCAD082,XDCAD083,XDCAD084,XDCAD085:
                                   XDCAD086,XDCAD087,XDCAD088,XDCAD089,XDCAD090:
                                   XDCAD091,XDCAD092,XDCAD093,XDCAD094,XDCAD095:
                                   XDCAD096,XDCAD097,XDCAD098,XDCAD099
                ENDIF
              ENDIF
            ENDIF
          ENDIF
.
          CMATCH    "P",PTEDTYPE
          IF        @EQUAL
            COMPARE   ONE,PRINCFLG              * Principal condition flag
            IF        @EQUAL 
              GOTO      ECDA3000
            ELSE
              MOVE      " ",XPRICONO
              MOVE      KEY7,XPRICON
              MOVE      PTEDOSET,XPRICONO
              MOVE      KEY9,SPRICON
              MOVE      ONE,PRINCFLG
              GOTO      ECDA1000
            ENDIF
          ENDIF
.
ECDA2444  MATCH     "2",PT0DACRQ
          GOTO      ECDA2500 IF EQUAL
.
          MATCH     "6",PT0DACRQ
          GOTO      ECDA2500 IF EQUAL
.
          MATCH     "7",PT0DACRQ
          GOTO      ECDA2500 IF EQUAL
.
          MATCH     "8",PT0DACRQ
          GOTO      ECDA2500 IF EQUAL
.
.                                           * the following codes are associated
.                                           * with "6", "7" and "8" above and
.                                           * should follow them. Dependencies
.                                           * are -
.                                           * "6" followed by "P" (Place of Inj)
.                                           * "7" followed by "A" (Activity)
.                                           * "8" followed by both
.                                           * Wrong sequence may cause problems
          MATCH     "P",PT0DACRQ
          IF        @EQUAL
            MATCH     SP70,XPLCEOCC                                  *I-52873
            IF        @EQUAL
              MOVE      KEY7,XPLCEOCC
              PACK      XPLOCONS,PTEDOSET
              MOVE      ONE,ADDGFLAG                                 *I-52873
            ENDIF
            GOTO      ECDA4500              * to bypass duplicating   *C-194211
....        GOTO      ECDA2500
          ENDIF
.
          MATCH     "A",PT0DACRQ
          IF        @EQUAL
            MATCH     SP70,XACTVITY                                  *I-52873
            IF        @EQUAL
              MOVE      KEY7,XACTVITY
              PACK      XACTVONS,PTEDOSET
              MOVE      ONE,ADDGFLAG                                 *I-52873
            ENDIF
            GOTO      ECDA4500              * to bypass duplicating   *C-194211
....        GOTO      ECDA2500
          ENDIF
.
          GOTO      ECDA3000
.
ECDA2500  MATCH     SP5,XEXTCAUS
          IF        @EQUAL
            MOVE      KEY7,XEXTCAUS
            PACK      XEXTCONS,PTEDOSET
            MOVE      ONE,ADDGFLAG
          ENDIF
.
          COMPARE   ONE,ADDGFLAG                                       *I-52873
          GOTO      ECDA4500 IF EQUAL                                  *I-52873
.
ECDA3000 STORE      KEY7,NUMDIAG,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4,XOTHCO5:
                                 XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9,XOTHCO10:
                                 XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14,XOTHCO15:
                                 XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19,XOTHCO20:
                                 XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24,XOTHCO25:
                                 XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29,XOTHCO30:
                                 XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34,XOTHCO35:
                                 XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39,XOTHCO40:
                                 XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44,XOTHCO45:
                                 XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49,XOTHCO50:
                                 XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54,XOTHCO55:
                                 XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59,XOTHCO60:
                                 XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64,XOTHCO65:
                                 XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69,XOTHCO70:
                                 XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74,XOTHCO75:
                                 XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79,XOTHCO80:
                                 XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84,XOTHCO85:
                                 XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89,XOTHCO90:
                                 XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94,XOTHCO95:
                                 XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99
.
          STORE     PTEDOSET,NUMDIAG,XONSTO1,XONSTO2,XONSTO3,XONSTO4,XONSTO5:
                                 XONSTO6,XONSTO7,XONSTO8,XONSTO9,XONSTO10:
                                 XONSTO11,XONSTO12,XONSTO13,XONSTO14,XONSTO15:
                                 XONSTO16,XONSTO17,XONSTO18,XONSTO19,XONSTO20:
                                 XONSTO21,XONSTO22,XONSTO23,XONSTO24,XONSTO25:
                                 XONSTO26,XONSTO27,XONSTO28,XONSTO29,XONSTO30:
                                 XONSTO31,XONSTO32,XONSTO33,XONSTO34,XONSTO35:
                                 XONSTO36,XONSTO37,XONSTO38,XONSTO39,XONSTO40:
                                 XONSTO41,XONSTO42,XONSTO43,XONSTO44,XONSTO45:
                                 XONSTO46,XONSTO47,XONSTO48,XONSTO49,XONSTO50:
                                 XONSTO51,XONSTO52,XONSTO53,XONSTO54,XONSTO55:
                                 XONSTO56,XONSTO57,XONSTO58,XONSTO59,XONSTO60:
                                 XONSTO61,XONSTO62,XONSTO63,XONSTO64,XONSTO65:
                                 XONSTO66,XONSTO67,XONSTO68,XONSTO69,XONSTO70:
                                 XONSTO71,XONSTO72,XONSTO73,XONSTO74,XONSTO75:
                                 XONSTO76,XONSTO77,XONSTO78,XONSTO79,XONSTO80:
                                 XONSTO81,XONSTO82,XONSTO83,XONSTO84,XONSTO85:
                                 XONSTO86,XONSTO87,XONSTO88,XONSTO89,XONSTO90:
                                 XONSTO91,XONSTO92,XONSTO93,XONSTO94,XONSTO95:
                                 XONSTO96,XONSTO97,XONSTO98,XONSTO99
.
          ADD       ONE,NUMDIAG
.
ECDA4500  STORE     KEY9,COUNT2,SOTHCO1,SOTHCO2,SOTHCO3,SOTHCO4,SOTHCO5:
                                 SOTHCO6,SOTHCO7,SOTHCO8,SOTHCO9,SOTHCO10:
                                 SOTHCO11,SOTHCO12,SOTHCO13,SOTHCO14,SOTHCO15:
                                 SOTHCO16,SOTHCO17,SOTHCO18,SOTHCO19,SOTHCO20:
                                 SOTHCO21,SOTHCO22,SOTHCO23,SOTHCO24,SOTHCO25:
                                 SOTHCO26,SOTHCO27,SOTHCO28,SOTHCO29,SOTHCO30:
                                 SOTHCO31,SOTHCO32,SOTHCO33,SOTHCO34,SOTHCO35:
                                 SOTHCO36,SOTHCO37,SOTHCO38,SOTHCO39,SOTHCO40:
                                 SOTHCO41,SOTHCO42,SOTHCO43,SOTHCO44,SOTHCO45:
                                 SOTHCO46,SOTHCO47,SOTHCO48,SOTHCO49,SOTHCO50:
                                 SOTHCO51,SOTHCO52,SOTHCO53,SOTHCO54,SOTHCO55:
                                 SOTHCO56,SOTHCO57,SOTHCO58,SOTHCO59,SOTHCO60:
                                 SOTHCO61,SOTHCO62,SOTHCO63,SOTHCO64,SOTHCO65:
                                 SOTHCO66,SOTHCO67,SOTHCO68,SOTHCO69,SOTHCO70:
                                 SOTHCO71,SOTHCO72,SOTHCO73,SOTHCO74,SOTHCO75:
                                 SOTHCO76,SOTHCO77,SOTHCO78,SOTHCO79,SOTHCO80:
                                 SOTHCO81,SOTHCO82,SOTHCO83,SOTHCO84,SOTHCO85:
                                 SOTHCO86,SOTHCO87,SOTHCO88,SOTHCO89,SOTHCO90:
                                 SOTHCO91,SOTHCO92,SOTHCO93,SOTHCO94,SOTHCO95:
                                 SOTHCO96,SOTHCO97,SOTHCO98,SOTHCO99

.
          ADD       ONE,COUNT2
          GOTO      ECDA1000
.

ECDA9999  RETURN
+
.**************************************************************************
.*                               ECOA0000              Called by: DETA0000*
.*               Read through patecoaf for operation codes                *
.**************************************************************************
.
ECOA0000  MOVE      ONE,NUMOPER 
          PACK      KEY16,AADMNO,SP20
          CALL      RSPTECO2
ECOA1000  CALL      RKPTECO2
          BRANCH    OVRCD,ECOA9999
.
          MATCH     AADMNO,PTEOADMN
          GOTO      ECOA9999 IF NOT EQUAL
.
          MATCH     "X",PTEOTYPE
          GOTO      ECOA1000 IF EQUAL
.
          MOVE      ZERO,CMPCNT             * Complex map counter - no
.
          MOVE      PTEODTCD,ICDRDDTE
          PACK      KEY9,PTEOCODE,SP70
          CALL      RDPTICO1
          BRANCH    OVRCD,ECOA1000
.
          MOVE      ZERO,CMPCNT             * Complex map counter - no
.
ECOA5000  MOVE      OPCODE,KEY9
          CALL      RMDT0000                    * Remove dots
.
          MOVE      SP5,DIM4
          MOVE      SP1,DIM1
.
ECOA6000  STORE     KEY9,NUMOPER,SPROCA,SPROCB,SPROCC,SPROCD,SPROCE:
                                 SPROCF,SPROCG,SPROCH,SPROCI,SPROCJ:
                                 SPROCK,SPROCL,SPROCM,SPROCN,SPROCO:
                                 SPROCP,SPROCQ,SPROCR,SPROCS,SPROCT:
                                 SPROCU,SPROCV,SPROCW,SPROCX,SPROCY:
                                 SPROC025,SPROC026,SPROC027,SPROC028,SPROC029:
                                 SPROC030,SPROC031,SPROC032,SPROC033,SPROC034:
                                 SPROC035,SPROC036,SPROC037,SPROC038,SPROC039:
                                 SPROC040,SPROC041,SPROC042,SPROC043,SPROC044:
                                 SPROC045,SPROC046,SPROC047,SPROC048,SPROC049:
                                 SPROC050,SPROC051,SPROC052,SPROC053,SPROC054:
                                 SPROC055,SPROC056,SPROC057,SPROC058,SPROC059:
                                 SPROC060,SPROC061,SPROC062,SPROC063,SPROC064:
                                 SPROC065,SPROC066,SPROC067,SPROC068,SPROC069:
                                 SPROC070,SPROC071,SPROC072,SPROC073,SPROC074:
                                 SPROC075,SPROC076,SPROC077,SPROC078,SPROC079:
                                 SPROC080,SPROC081,SPROC082,SPROC083,SPROC084:
                                 SPROC085,SPROC086,SPROC087,SPROC088,SPROC089:
                                 SPROC090,SPROC091,SPROC092,SPROC093,SPROC094:
                                 SPROC095,SPROC096,SPROC097,SPROC098,SPROC099
.
          STORE     KEY7,NUMOPER,XPPROCA,XPROCB,XPROCC,XPROCD,XPROCE:
                                 XPROCF,XPROCG,XPROCH,XPROCI,XPROCJ:
                                 XPROCK,XPROCL,XPROCM,XPROCN,XPROCO:
                                 XPROCP,XPROCQ,XPROCR,XPROCS,XPROCT:
                                 XPROCU,XPROCV,XPROCW,XPROCX,XPROCY:
                                 XPROC025,XPROC026,XPROC027,XPROC028,XPROC029:
                                 XPROC030,XPROC031,XPROC032,XPROC033,XPROC034:
                                 XPROC035,XPROC036,XPROC037,XPROC038,XPROC039:
                                 XPROC040,XPROC041,XPROC042,XPROC043,XPROC044:
                                 XPROC045,XPROC046,XPROC047,XPROC048,XPROC049:
                                 XPROC050,XPROC051,XPROC052,XPROC053,XPROC054:
                                 XPROC055,XPROC056,XPROC057,XPROC058,XPROC059:
                                 XPROC060,XPROC061,XPROC062,XPROC063,XPROC064:
                                 XPROC065,XPROC066,XPROC067,XPROC068,XPROC069:
                                 XPROC070,XPROC071,XPROC072,XPROC073,XPROC074:
                                 XPROC075,XPROC076,XPROC077,XPROC078,XPROC079:
                                 XPROC080,XPROC081,XPROC082,XPROC083,XPROC084:
                                 XPROC085,XPROC086,XPROC087,XPROC088,XPROC089:
                                 XPROC090,XPROC091,XPROC092,XPROC093,XPROC094:
                                 XPROC095,XPROC096,XPROC097,XPROC098,XPROC099

.
          MOVE      SP1,PROCLOC
.
          MATCH     "O",PTEOTYPE
          IF        @EQUAL
            MOVE      ONE,PROCLOC
          ENDIF
.
          MATCH     "I",PTEOTYPE
          IF        @EQUAL
            MOVE      TWO,PROCLOC
          ENDIF
.
          MATCH     "N",PTEOTYPE
          IF        @EQUAL
            MOVE      TWO,PROCLOC
          ENDIF
.
          STORE     PROCLOC,NUMOPER,XPPROCLA,XPROCLB,XPROCLC,XPROCLD:
                                 XPROCLE,XPROCLF,XPROCLG,XPROCLH:
                                 XPROCLI,XPROCLJ,XPROCLK,XPROCLL:
                                 XPROCLM,XPROCLN,XPROCLO,XPROCLP:
                                 XPROCLQ,XPROCLR,XPROCLS,XPROCLT:
                                 XPROCLU,XPROCLV,XPROCLW,XPROCLX,XPROCLY:
                                 XPRCL025,XPRCL026,XPRCL027,XPRCL028,XPRCL029:
                                 XPRCL030,XPRCL031,XPRCL032,XPRCL033,XPRCL034:
                                 XPRCL035,XPRCL036,XPRCL037,XPRCL038,XPRCL039:
                                 XPRCL040,XPRCL041,XPRCL042,XPRCL043,XPRCL044:
                                 XPRCL045,XPRCL046,XPRCL047,XPRCL048,XPRCL049:
                                 XPRCL050,XPRCL051,XPRCL052,XPRCL053,XPRCL054:
                                 XPRCL055,XPRCL056,XPRCL057,XPRCL058,XPRCL059:
                                 XPRCL060,XPRCL061,XPRCL062,XPRCL063,XPRCL064:
                                 XPRCL065,XPRCL066,XPRCL067,XPRCL068,XPRCL069:
                                 XPRCL070,XPRCL071,XPRCL072,XPRCL073,XPRCL074:
                                 XPRCL075,XPRCL076,XPRCL077,XPRCL078,XPRCL079:
                                 XPRCL080,XPRCL081,XPRCL082,XPRCL083,XPRCL084:
                                 XPRCL085,XPRCL086,XPRCL087,XPRCL088,XPRCL089:
                                 XPRCL090,XPRCL091,XPRCL092,XPRCL093,XPRCL094:
                                 XPRCL095,XPRCL096,XPRCL097,XPRCL098,XPRCL099
.
          ADD       ONE,NUMOPER
          GOTO      ECOA1000
.
ECOA9999  RETURN
+
.******************************************************************************
.*                                  ICUD0000              Called by: DETA0000 *
.*                           Get ICU file details                             *
.******************************************************************************
ICUD0000  MOVE      "0000",XHMECVEN
          MOVE      "00000",XHMECVNW
          MOVE      "00000",XHICU
          PACK      KEY8,SAVADMN,SP10 
          CALL      RDPTICU1 
          BRANCH    OVRCD,ICUD9000
.
          MATCH     SAVADMN,DPTICUAD            * Different admission number
          GOTO      ICUD9000 IF NOT EQUAL 
.
          MOVE      PTICUINT,XHICU              * Hours in ICU
          REP       " 0",XHICU
.
          MOVE      PTICUMEC,XHMECVNW       * Mechanical Ventilation hours NEW
          REP       " 0",XHMECVNW
          MOVE      PTICUMEC,FORM4
          MOVE      FORM4,XHMECVEN          * Mechanical Ventilation hours OLD
          REP       " 0",XHMECVEN
.
ICUD9000  MATCH     "20210701",DDATE
          IF        !@LESS
            MOVE      SP4,XHMECVEN          * set old field as blank
          ENDIF
.
ICUD9999  RETURN
+
.******************************************************************************
.*                   Move field to be right justified                         *
.******************************************************************************
RJUS0000  MOVE      ZERO,FORM4
          MOVE      SP10,DIM4
          MOVE      SP8,DIM3
          RESET     THCSCOD,4
          GOTO      RJUS2500
.
RJUS2000  BUMP      THCSCOD,-1
          GOTO      RJUS9999 IF EOS
.
RJUS2500  CMATCH    SP1,THCSCOD
          GOTO      RJUS2000 IF EQUAL
.
          MOVEFPTR  THCSCOD,FORM2
.
          SETLPTR   THCSCOD,FORM2
.
RJUS3000  RESET     THCSCOD
          MOVE      THCSCOD,FORM4
          MOVE      FORM4,DIM4
          MOVE      FORM4,DIM3
          RESET     DIM4
          RESET     DIM3
.
RJUS9999  RETURN
+
.******************************************************************************
.*                                  RMDT0000              Called by: PROC0000 *
.*          Move KEY9 to KEY7 (Left Justify), eliminating any dots            *
.******************************************************************************
RMDT0000  RESET     KEY9
          CLEAR     KEY7
.
RMDT1000  CMATCH    SP1,KEY9
          GOTO      RMDT2000 IF EQUAL
.
          CMATCH    DOT,KEY9
          GOTO      RMDT2000 IF EQUAL
.
          CMATCH    "-",KEY9
          GOTO      RMDT2000 IF EQUAL
.
          CMATCH    SLASH,KEY9              * Ignore slashes
          GOTO      RMDT2000 IF EQUAL
          MOVE      KEY9,ANS
          APPEND    ANS,KEY7
.
RMDT2000  BUMP      KEY9
          GOTO      RMDT1000 IF NOT EOS
.
          RESET     KEY9
          APPEND    SP10,KEY7
          RESET     KEY7
.
RMDT9999  RETURN
+
.**************************************************************************
.*                               ZOBL0000              Called by: DETA0000*
.*                      Variables to be filled with zero or blank         *
.**************************************************************************
.
ZOBL0000  MOVE      "01",XREFFC
          PACK      XCPURNO,ZERO10
          PACK      XDACONPR,ZERO10
          PACK      XHOSPNUM,ZERO10
          PACK      XOACISLV,SP10
          MOVE      ONE,XDOBACC
          MATCH     "01071890",XPBDATE
          IF        @EQUAL
            MOVE      TWO,XDOBACC
          ENDIF
          MOVE      SP70,XDOFOTP
          REP       " 0",XDOFOTP
          MOVE      SP70,XTFOTP
          REP       " 0",XTFOTP
          MOVE      SP10,XRESITEM
.
ZOBL9999  RETURN
+
.**************************************************************************
.*                               VALD0000              Called by: DETA0000*
.*                             Validate data                              *
.**************************************************************************
.
VALD0000  MOVE      ZERO,FLAG1
          MOVE      ZERO,FLAG2
          MOVE      ZERO,FLAG3
.
............................................. special bit to resolve XFUNDSRC
          MOVE      XFUNDSRC,KEY2           * handles - eg. "01", "04" & "11"
          UNPACK    XFUNDSRC,KEY1,DIM1      * handles  - eg."1 ", "4 " & "11"
          MATCH     SP1,DIM1
          IF        @EQUAL
            PACK      KEY2,SP1,KEY1
          ENDIF
          MOVE      ZERO,FUNSRC
VALD0100  MOVE      KEY2,FUNSRC             * numeric value for XFUNDSRC
............................................ end of special bit
.   ---------- Principal Diagnosis -------------- 
          MATCH     SP9,SPRICON
          GOTO      VALD3000 IF EQUAL       * No Principal Diagnosis - bypass
.
          PACK      ICDRDDTE,DDATE
          PACK      KEY9,SPRICON
          CALL      RDPTICD1
          BRANCH    OVRCD,VALD3000
.
          MATCH     "1",PT0DCPRA
          IF        @EQUAL
           MOVE     "#2100 - Code not acceptable as principal diagnosis",ERRDESC
           CALL     PRINTERR
          ENDIF
.
.         ........................................
          MATCH     "O80",XPRICON           * Edit Principal Diagnosis "O80"
          GOTO      VALD0500 IF NOT EQUAL
          MOVE      ZERO,COUNT2
.
VALD0200  ADD       ONE,COUNT2
          IF        COUNT2 > 100
            GOTO      VALD0500
          ENDIF
.
          MOVE      SP9,CODE9
          LOAD      CODE9,COUNT2,SPROCA,SPROCB,SPROCC,SPROCD,SPROCE,SPROCF:
                              SPROCG,SPROCH,SPROCI,SPROCJ,SPROCK,SPROCL:
                              SPROCM,SPROCN,SPROCO,SPROCP,SPROCQ,SPROCR:
                              SPROCS,SPROCT,SPROCU,SPROCV,SPROCW,SPROCX,SPROCY:
                              SPROC025,SPROC026,SPROC027,SPROC028,SPROC029:
                              SPROC030,SPROC031,SPROC032,SPROC033,SPROC034:
                              SPROC035,SPROC036,SPROC037,SPROC038,SPROC039:
                              SPROC040,SPROC041,SPROC042,SPROC043,SPROC044:
                              SPROC045,SPROC046,SPROC047,SPROC048,SPROC049:
                              SPROC050,SPROC051,SPROC052,SPROC053,SPROC054:
                              SPROC055,SPROC056,SPROC057,SPROC058,SPROC059:
                              SPROC060,SPROC061,SPROC062,SPROC063,SPROC064:
                              SPROC065,SPROC066,SPROC067,SPROC068,SPROC069:
                              SPROC070,SPROC071,SPROC072,SPROC073,SPROC074:
                              SPROC075,SPROC076,SPROC077,SPROC078,SPROC079:
                              SPROC080,SPROC081,SPROC082,SPROC083,SPROC084:
                              SPROC085,SPROC086,SPROC087,SPROC088,SPROC089:
                              SPROC090,SPROC091,SPROC092,SPROC093,SPROC094:
                              SPROC095,SPROC096,SPROC097,SPROC098,SPROC099
.
          MATCH     SP9,CODE9
          GOTO      VALD0500 IF EQUAL
.
VALD0300  PACK      KEY9,CODE9
          CALL      RDPT10O1
.
          MATCH     "90472.00",OPCODE
          GOTO      VALD0200 IF EQUAL
.
.                                           * test Blocks 1333->1336 & 1342
          MOVE      ZERO,BLOKNO
          SQUEEZE   PT0OBLKN
          MOVE      PT0OBLKN,BLOKNO
          IF        (BLOKNO > 1332 & BLOKNO < 1337) | BLOKNO = 1342
            GOTO      VALD0200              * valid block
          ENDIF
.
          MOVE     "#2150 - Operative intervention with normal delivery",ERRDESC
          CALL      PRINTERR
.
VALD0500  MOVE      ZERO,COUNT2
          PACK      CODE5,SP10
.
VALD0750  ADD       ONE,COUNT2
          IF        COUNT2 > 100
            GOTO      VALD1000
          ENDIF
.
          MOVE     SP5,CODE5
.
          LOAD     CODE5,COUNT2,XPRICON,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4,XOTHCO5:
                                XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9,XOTHCO10:
                                XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14,XOTHCO15:
                                XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19,XOTHCO20:
                                XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99
.
          MATCH     SP5,CODE5
          GOTO      VALD1000 IF EQUAL
.
          MOVE      CODE5,SAVCODE      * Set flag if between O60-O82 
          SQUEEZE   SAVCODE
          CMATCH    "O",SAVCODE
          GOTO      VALD0750 IF NOT EQUAL
.
          REP       "O ",SAVCODE
          MOVE      SAVCODE,FORMCODE
          IF        FORMCODE > 59 & FORMCODE < 82
            MOVE      ONE,FLAG1
          ENDIF
.
          GOTO      VALD0750
.         
VALD1000  MOVE      ZERO,COUNT2
          MOVE      SP10,CODE9
          MOVE      ZERO,FORM4
.
VALD1250  ADD       ONE,COUNT2
          IF        COUNT2 > 100
            GOTO      VALD1500
          ENDIF
.
          MOVE      SP9,CODE9
          LOAD      CODE9,COUNT2,SPROCA,SPROCB,SPROCC,SPROCD,SPROCE,SPROCF:
                              SPROCG,SPROCH,SPROCI,SPROCJ,SPROCK,SPROCL:
                              SPROCM,SPROCN,SPROCO,SPROCP,SPROCQ,SPROCR:
                              SPROCS,SPROCT,SPROCU,SPROCV,SPROCW,SPROCX,SPROCY:
                              SPROC025,SPROC026,SPROC027,SPROC028,SPROC029:
                              SPROC030,SPROC031,SPROC032,SPROC033,SPROC034:
                              SPROC035,SPROC036,SPROC037,SPROC038,SPROC039:
                              SPROC040,SPROC041,SPROC042,SPROC043,SPROC044:
                              SPROC045,SPROC046,SPROC047,SPROC048,SPROC049:
                              SPROC050,SPROC051,SPROC052,SPROC053,SPROC054:
                              SPROC055,SPROC056,SPROC057,SPROC058,SPROC059:
                              SPROC060,SPROC061,SPROC062,SPROC063,SPROC064:
                              SPROC065,SPROC066,SPROC067,SPROC068,SPROC069:
                              SPROC070,SPROC071,SPROC072,SPROC073,SPROC074:
                              SPROC075,SPROC076,SPROC077,SPROC078,SPROC079:
                              SPROC080,SPROC081,SPROC082,SPROC083,SPROC084:
                              SPROC085,SPROC086,SPROC087,SPROC088,SPROC089:
                              SPROC090,SPROC091,SPROC092,SPROC093,SPROC094:
                              SPROC095,SPROC096,SPROC097,SPROC098,SPROC099
.
          MATCH     SP9,CODE9
          GOTO      VALD1500 IF EQUAL
.
          PACK      KEY9,CODE9
          CALL      RDPT10O1
.
          MOVE      ZERO,BLOKNO
          SQUEEZE   PT0OBLKN
          MOVE      PT0OBLKN,BLOKNO
          IF        BLOKNO > 1335 & BLOKNO < 1344
            MOVE      ONE,FLAG2
          ENDIF
.
          GOTO      VALD1250
.
VALD1500  MOVE      ONE,COUNT2     * only additional diagnosis
          MOVE      ZERO,CODE9
          MOVE      ZERO,FORM5
. 
VALD1750  ADD       ONE,COUNT2
          IF        COUNT2 > 100
            GOTO      VALD2250
          ENDIF
.
          LOAD     CODE9,COUNT2,SPRICON,SOTHCO1,SOTHCO2,SOTHCO3,SOTHCO4,SOTHCO5:
                                SOTHCO6,SOTHCO7,SOTHCO8,SOTHCO9,SOTHCO10:
                                SOTHCO11,SOTHCO12,SOTHCO13,SOTHCO14,SOTHCO15:
                                SOTHCO16,SOTHCO17,SOTHCO18,SOTHCO19,SOTHCO20:
                                SOTHCO21,SOTHCO22,SOTHCO23,SOTHCO24:
				SOTHCO25,SOTHCO26,SOTHCO27,SOTHCO28,SOTHCO29:
				SOTHCO30,SOTHCO31,SOTHCO32,SOTHCO33,SOTHCO34:
				SOTHCO35,SOTHCO36,SOTHCO37,SOTHCO38,SOTHCO39:
				SOTHCO40,SOTHCO41,SOTHCO42,SOTHCO43,SOTHCO44:
				SOTHCO45,SOTHCO46,SOTHCO47,SOTHCO48,SOTHCO49:
				SOTHCO50,SOTHCO51,SOTHCO52,SOTHCO53,SOTHCO54:
				SOTHCO55,SOTHCO56,SOTHCO57,SOTHCO58,SOTHCO59:
				SOTHCO60,SOTHCO61,SOTHCO62,SOTHCO63,SOTHCO64:
				SOTHCO65,SOTHCO66,SOTHCO67,SOTHCO68,SOTHCO69:
				SOTHCO70,SOTHCO71,SOTHCO72,SOTHCO73,SOTHCO74:
				SOTHCO75,SOTHCO76,SOTHCO77,SOTHCO78,SOTHCO79:
				SOTHCO80,SOTHCO81,SOTHCO82,SOTHCO83,SOTHCO84:
				SOTHCO85,SOTHCO86,SOTHCO87,SOTHCO88,SOTHCO89:
				SOTHCO90,SOTHCO91,SOTHCO92,SOTHCO93,SOTHCO94:
				SOTHCO95,SOTHCO96,SOTHCO97,SOTHCO98,SOTHCO99
.
          MATCH     SP9,CODE9
          GOTO      VALD2000 IF EQUAL
.
          REP       ". ",CODE9
          SQUEEZE   CODE9
          CMATCH    "Z",CODE9
          IF        !@EQUAL
            MOVE      ONE,FLAG3
            GOTO      VALD1750
          ENDIF
.
          REP       "Z ",CODE9
          MOVE      CODE9,FORM5
          IF        FORM5 > 369 & FORM5 < 380
            MOVE      ZERO,FLAG3
            GOTO      VALD2000
          ELSE
            MOVE      ONE,FLAG3
            GOTO      VALD1750
          ENDIF
.         
VALD2000  IF        (FLAG1=1 & FLAG3=1) | (FLAG2=1 & FLAG3=1)
            MOVE      "#4130 - No Z37 with delivery -Z37.0 generated.",ERRDESC
            CALL      PRINTERR
          ENDIF
.
          MOVE      ONE,COUNT2     * only additional diagnosis
          MOVE      ZERO,CODE9
.
VALD2250  ADD       ONE,COUNT2
          IF        COUNT2 > 100
            GOTO      VALD3000
          ENDIF
.
          LOAD     CODE9,COUNT2,SPRICON,SOTHCO1,SOTHCO2,SOTHCO3,SOTHCO4,SOTHCO5:
                                SOTHCO6,SOTHCO7,SOTHCO8,SOTHCO9,SOTHCO10:
                                SOTHCO11,SOTHCO12,SOTHCO13,SOTHCO14,SOTHCO15:
                                SOTHCO16,SOTHCO17,SOTHCO18,SOTHCO19,SOTHCO20:
                                SOTHCO21,SOTHCO22,SOTHCO23,SOTHCO24:
                                SOTHCO25,SOTHCO26,SOTHCO27,SOTHCO28,SOTHCO29:
                                SOTHCO30,SOTHCO31,SOTHCO32,SOTHCO33,SOTHCO34:
                                SOTHCO35,SOTHCO36,SOTHCO37,SOTHCO38,SOTHCO39:
                                SOTHCO40,SOTHCO41,SOTHCO42,SOTHCO43,SOTHCO44:
                                SOTHCO45,SOTHCO46,SOTHCO47,SOTHCO48,SOTHCO49:
                                SOTHCO50,SOTHCO51,SOTHCO52,SOTHCO53,SOTHCO54:
                                SOTHCO55,SOTHCO56,SOTHCO57,SOTHCO58,SOTHCO59:
                                SOTHCO60,SOTHCO61,SOTHCO62,SOTHCO63,SOTHCO64:
                                SOTHCO65,SOTHCO66,SOTHCO67,SOTHCO68,SOTHCO69:
                                SOTHCO70,SOTHCO71,SOTHCO72,SOTHCO73,SOTHCO74:
                                SOTHCO75,SOTHCO76,SOTHCO77,SOTHCO78,SOTHCO79:
                                SOTHCO80,SOTHCO81,SOTHCO82,SOTHCO83,SOTHCO84:
                                SOTHCO85,SOTHCO86,SOTHCO87,SOTHCO88,SOTHCO89:
                                SOTHCO90,SOTHCO91,SOTHCO92,SOTHCO93,SOTHCO94:
                                SOTHCO95,SOTHCO96,SOTHCO97,SOTHCO98,SOTHCO99
.
          MATCH     SP9,CODE9
          GOTO      VALD3000 IF EQUAL
.
          PACK      KEY9,CODE9
          CALL      RDPT10D1
          BRANCH    OVRCD,VALD2250
.
          MATCH     "1",PT0DACRQ
          GOTO      VALD2250 IF NOT EQUAL
.
          MATCH     SP5,XEXTCAUS
          GOTO      VALD2250 IF NOT EQUAL
.
          MOVE      "#4080 - External cause code required.",ERRDESC
.
.         ........................................ End of first bit
.
.                                           * Principal Diagnosis/Condition ***
VALD3000  MOVE      ZERO,EXIT
.
          UNPACK    XPRICON,DIM2,DIM1
          MATCH     "F1",DIM2               * check for F10, F11, F12 or F17
          IF        @EQUAL
            REP       "0-1-2-7-",DIM1
            MATCH     "-",DIM1
            IF        @EQUAL
              CALL      EDF1N000            * edit principal diagnosis
            ENDIF
          ENDIF
.
          CALL      EDF0N000                * edit principal diagnosis
.                                           * Procedure ***********************
          CALL      ED1PRC00 
.
.                                           * Hospital at Home ***************
          MATCH     "07",XREFFC              * Ref for Further Care = H@H (7)
          IF        @EQUAL
            MATCH     "A",XNATSEP
            IF        !@EQUAL
              PACK      ERRDESC,SP70,SP70
              CLEAR     ERRDESC
              APPEND    "#2720 - Referral to H@H must have ",ERRDESC
              APPEND    "Nature of Sep 'A'",ERRDESC
              CALL      PRINTERR
            ENDIF
.
            MATCH     "7",XEOC              * Episode of Care = H@H
            IF        @EQUAL
              PACK      ERRDESC,SP70,SP70
              CLEAR     ERRDESC
              APPEND    "#2730 - Incorrect referral - ",ERRDESC
              APPEND    "patient already H@H",ERRDESC
              CALL      PRINTERR
            ENDIF
.
            MATCH     "A",XNATSEP
            IF        @EQUAL
              MOVE      XEOC,DIM1
              REP       "5-6-7-8-9-L-",DIM1
              MATCH     "-",DIM1
              IF        @EQUAL
                PACK      ERRDESC,SP70,SP70
                CLEAR     ERRDESC
                APPEND    "#2750 - Incorrect nature of separation & re",ERRDESC
                APPEND    "ferral for further care for episode of care",ERRDESC
                CALL      PRINTERR
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     "7",XEOC                * Episode of Care = 7 (H@H)
          IF        @EQUAL
            MOVE      XNATSEP,KEY1
            REP       "0-A-E-2-3-4-7-",DIM1
            MATCH     "-",KEY1
            IF        !@EQUAL
              PACK      ERRDESC,SP70,SP70
              CLEAR     ERRDESC
              APPEND    "#4155 - Wrong nature of Separation",ERRDESC
              APPEND    " for Hospital at Home",ERRDESC
              CALL      PRINTERR
            ENDIF
.
            MATCH     "A",XSASRCE
            IF        @EQUAL
              MATCH     "Z519",XPRICON
              GOTO      VALD3120 IF EQUAL
              MATCH     "Z50",XPRICON
              IF        !@EQUAL
                MOVE      "#4822 - Z51.9 PDX required for H@H episode",ERRDESC
                CALL      PRINTERR
              ENDIF
            ELSE
              MATCH     "Z519",XPRICON
              IF        @EQUAL
                MOVE      "#4824 - Incorrect PDX for H@H episode",ERRDESC
                CALL      PRINTERR
              ENDIF
            ENDIF
            CALL      PRINTERR
          ENDIF
.
VALD3120  MOVE      ONE,EXIT
.                                           * Neoplasm #4145 *****************
          CALL      EDNEOP00
.                                           * Outcome of Delivery #4890 ******
          CALL      EDODEL00
.                                           * Duration of Pregnancy #4185 ****
          CALL      EDDPRE00
.                                           * Place of Occurrence #4960 ******
          CALL      EDPLOC00
.                                           * Activity Codes #4880 ***********
          CALL      EDACTV00
.                                           * Burns - Body Surface Area ******
          CALL      EDBURN00
.********************************************   end of addition       *I-108284
.
VALD3500  MATCH     SP5,XEXTCAUS            * External Cause *****************
          IF        !@EQUAL
            MOVE      ZERO,VALEXT
            UNPACK    XEXTCAUS,DIM1,DIM2
            REP       "V-W-X-Y-",DIM1
            MATCH     "-",DIM1
            IF        @EQUAL
              MOVE      ONE,VALEXT     * valid - V,W, or X (and possible Y)
              CMATCH    "Y",XEXTCAUS
              IF        @EQUAL
                MOVE      ZERO,VALEXT
                MOVE      DIM2,FORM2
                IF        FORM2 < 92 | FORM2 = 95 | FORM2 = 98
                  MOVE      ONE,VALEXT      * valid - must be Y900-Y919,Y95,Y98
                ENDIF
              ENDIF
            ENDIF
.
            COMPARE   ZERO,VALEXT
            IF        @EQUAL
.                                           * was "#2130."            *C-108283
              MOVE      "#2540 - External Cause Code Invalid.",ERRDESC
              CALL      PRINTERR
            ENDIF
          ENDIF
.
VALD6000  MOVE      ZERO,EXIT
.                                           * Length of Stay *****************
	  MOVE      ZERO,NBRDAYS
          MOVE      ADATE,FROMDATE
          MOVE      DDATE,TODATE
          CALL      NHOSPDAY                * returns LOS in NBRDAYS
.
          MOVE      XATYPE,FORM1B
          IF        FORM1B = 1
            COMPARE   "36",NBRDAYS
            IF        !@LESS
              MOVE      "#4150 - Admission Type should be long stay",ERRDESC
              CALL      PRINTERR
            ENDIF
          ENDIF
.
          COMPARE   "36",NBRDAYS
          IF        !@LESS
            MOVE      XSTCHGA1,DIM1
            REP       " -1-",DIM1
            IF        @EQUAL
              PACK      ERRDESC,SP70,SP70
              CLEAR     ERRDESC               
              APPEND    "#4150 - LOS >35 days, ensure ",ERRDESC
              APPEND    "patient is long stay",ERRDESC
              CALL      PRINTERR
            ENDIF
          ENDIF
.
          MATCH     XADELEC,XSTCHGE1
          IF        @EQUAL
            MATCH     XATYPE,XSTCHGA1
            IF        @EQUAL
              MATCH     XADATE,XSTCHGD1
              IF        @EQUAL
                PACK      ERRDESC,SP70,SP70
                CLEAR     ERRDESC               
                APPEND    "#4474 - Status Change details",ERRDESC
                APPEND    " not required",ERRDESC
                CALL      PRINTERR
              ENDIF
            ENDIF
          ENDIF
.                                           * Sameday Admission **************
VALD6020  MOVE      SP1,KEY1
          MATCH     XADATE,XSEPDATE
          GOTO      VALD6030 IF NOT EQUAL
.                                           * calc minutes of stay
          UNPACK    XADMTIME,WHRS,WMINS
          MOVE      WHRS,FORM3F
          MULT      SIXTY,FORM3F
          MOVE      WMINS,FORM3
          ADD       FORM3,FORM3F
          UNPACK    XSEPTIME,WHRS,WMINS
          MOVE      WHRS,FORM3T
          MULT      SIXTY,FORM3T
          MOVE      WMINS,FORM3
          ADD       FORM3,FORM3T
          SUB       FORM3F,FORM3T
.                                           * is length-of-stay > 240 minutes?
          IF        FORM3T > 240
            UNPACK    XPPROCA,KEY5,DIM2
            PACK      KEY9,KEY5,SP10
            PACK      KEY17,KEY9,SP70
            CALL      PATITMRD
            IF        OVRCD = 1
              CALL      RDSITEM1
              CALL      RDKITEM1
              MATCH     KEY5,ITEMNO
              GOTO      VALD6030 IF NOT EQUAL
            ENDIF
.
            COMPARE   ONE,PTITEXCL
            IF        @EQUAL
              MATCH     "0001",XHOSCOD
              IF        !@LESS
                MATCH     "0500",XHOSCOD
                IF        @LESS
                  PACK      ERRDESC,SP70,SP70
                  CLEAR     ERRDESC
                  APPEND    "#4000 - Possible Inappropriate Sameday",ERRDESC
                  APPEND    " Sameday Admission",ERRDESC
                  CALL      PRINTERR
                ENDIF
              ENDIF     
            ENDIF
          ENDIF     
.
.                                           * Admission Category - ************
.                                           * - for Statistical Admission
VALD6030  MOVE      XSASRCE,KEY1
          REP       "A-E-",KEY1
          MATCH     "-",KEY1
          GOTO      VALD6040 IF NOT EQUAL
          MATCH     "4",XADMCAT
          IF        !@EQUAL
            MOVE      "4",XADMCAT
            PACK      ERRDESC,SP70,SP70
            CLEAR     ERRDESC
            APPEND    "#4001 - Warning Wrong Admission Categ for",ERRDESC
            APPEND    " Statistical Admission",ERRDESC
            CALL      PRINTERR
          ENDIF
          GOTO      VALD7000
.
.                                           * - Dialysis Patient
....6040  MATCH     "Z49.1",XPRICON    ... should test SPRICON for Z49.1
VALD6040  MATCH     "Z491",XPRICON                                    *C-108284
          GOTO      VALD6050 IF NOT EQUAL
          MATCH     "4",XADMCAT
          IF        !@EQUAL
            MOVE      "4",XADMCAT
            PACK      ERRDESC,SP70,SP70
            CLEAR     ERRDESC
            APPEND    "#4002 - Warning Wrong Admission Category",ERRDESC
            APPEND    " for Dialysis Patient",ERRDESC
            CALL      PRINTERR
          ENDIF
          GOTO      VALD7000
.
.                                           * - Chemo Patient
VALD6050  MATCH     "Z511",XPRICON
          GOTO      VALD6055 IF EQUAL
.
          MATCH     "Z2921",XPRICON
          GOTO      VALD6060 IF NOT EQUAL
.
VALD6055  MATCH     "4",XADMCAT
          IF        !@EQUAL
            PACK      ERRDESC,SP70,SP70
            CLEAR     ERRDESC
            APPEND    "#4003 - Source of Referral not A or E,",ERRDESC
            APPEND    " Principal Diag Z511 or Z2921",ERRDESC
            CALL      PRINTERR
          ENDIF
          GOTO      VALD7000
.
.                                           * - Radiotherapy Patient
VALD6060  MATCH     "Z510",XPRICON                                    *C-108284
          GOTO      VALD6065 IF NOT EQUAL
          MATCH     "4",XADMCAT
          IF        !@EQUAL
            MOVE      "4",XADMCAT
            PACK      ERRDESC,SP70,SP70
            CLEAR     ERRDESC
            APPEND    "#4004 - Warning Wrong Admission Categ",ERRDESC
            APPEND    " for Radiotherapy Patient",ERRDESC
            CALL      PRINTERR
          ENDIF
          GOTO      VALD7000
.
.                                           * - Normal Delivery
VALD6065  MATCH     "O80  ",XPRICON
          IF        !@EQUAL
            MATCH     "O840",XPRICON
            GOTO      VALD6070 IF NOT EQUAL
          ENDIF
          MATCH     "4",XADMCAT
          IF        !@EQUAL
            MOVE      "4",XADMCAT
            PACK      ERRDESC,SP70,SP70
            CLEAR     ERRDESC
            APPEND    "#4005 - Warning Wrong Admission Categ",ERRDESC
            APPEND    " for Normal Delivery",ERRDESC
            CALL      PRINTERR
          ENDIF
          GOTO      VALD7000
.                                           * - Unqualified Newborn
VALD6070  MATCH     "5",XEOC
          GOTO      VALD6080 IF NOT EQUAL
          MATCH     "4",XADMCAT
          IF        !@EQUAL
            MOVE      "4",XADMCAT
            PACK      ERRDESC,SP70,SP70
            CLEAR     ERRDESC
            APPEND    "#4006 - Warning Wrong Admission Categ",ERRDESC
            APPEND    " for Unqualified Newborn",ERRDESC
            CALL      PRINTERR
          ENDIF
          GOTO      VALD7000
.
.                                           * - Birth Episode
VALD6080  MATCH     "5",XEOC
          GOTO      VALD7000 IF NOT EQUAL
          MOVE      XSASRCE,KEY1
          REP       "4-X-",KEY1
          MATCH     "-",KEY1
          GOTO      VALD7000 IF EQUAL
          MATCH     XADATE,XPBDATE
          GOTO      VALD7000 IF NOT EQUAL
          MATCH     "4",XADMCAT
          IF        !@EQUAL
            MOVE      "4",XADMCAT
            MOVE      "#4006 - Wrong Admission Categ for Birth Episode",ERRDESC
            CALL      PRINTERR
          ENDIF
.
VALD7000  MOVE      SP1,KEY1
          COMPARE   "4",FUNSRC
          IF        @EQUAL
            MOVE      XVETCARD,DIM1
            REP       "G-W-",DIM1
            MATCH     "-",DIM1
            IF        @EQUAL
              MATCH     SP9,XVETNUM
              IF        @EQUAL
                MOVE      "#2280 - Veteran Card Number Required.",ERRDESC
                CALL      PRINTERR
                GOTO      VALD7200
              ENDIF
            ELSE
              MOVE      "#2280 - Veteran Card Type Required.",ERRDESC
              CALL      PRINTERR
            ENDIF
          ENDIF
.
.
.                                           * Funding Source *****************
VALD7200  MOVE      ZERO,EXIT
          IF        FUNSRC < 1 | FUNSRC > 14
            MOVE      "#Invalid Funding Source.",ERRDESC
            CALL      PRINTERR
          ENDIF
.
          IF        FUNSRC = 6 | FUNSRC = 7 | FUNSRC = 11
            MATCH     "1",XADELEC
            IF        !@EQUAL
              MOVE      "#2320 - Wrong election for funding source type",ERRDESC
              CALL      PRINTERR
            ENDIF
          ENDIF
.
          IF        FUNSRC=4 | FUNSRC=5 | FUNSRC=8 | FUNSRC=9 | FUNSRC=10
            MATCH     "2",XADELEC
            IF        !@EQUAL
              PACK      ERRDESC,SP70,SP70
              CLEAR     ERRDESC
              APPEND    "#4525 - Election type not valid with ",ERRDESC
              APPEND    "submitted funding source type",ERRDESC
              CALL      PRINTERR
            ENDIF
          ENDIF
.
          IF        FUNSRC = 9
            MATCH     "1",XINSSTAT

            IF        !@EQUAL
              PACK      ERRDESC,SP70,SP70
              CLEAR     ERRDESC
              APPEND    "#2330 - Wrong hospital insurance with ",ERRDESC
              APPEND    "this funding source type",ERRDESC
              CALL      PRINTERR
            ENDIF
          ENDIF
.
          IF        FUNSRC > 0 & FUNSRC < 5
            MATCH     "2",XADELEC
            IF        !@EQUAL
              MATCH     "0049",XHOSCOD
              IF        !@LESS
                MATCH     "0251",XHOSCOD
                IF        @LESS
                  PACK      ERRDESC,SP70,SP70
                  CLEAR     ERRDESC
                  APPEND    "#4525 - Veteran or Compensable Patient",ERRDESC
                  APPEND    " - must be private",ERRDESC
                  CALL      PRINTERR
                ENDIF
              ENDIF
            ENDIF
          ENDIF
.
.                                           * Nature of Separation ***********
          MOVE      XNATSEP,DIM1
          REP       "2-5-6-7-E-",DIM1
          MATCH     "-",DIM1
          IF        @EQUAL
            MATCH     "01",XREFFC
            IF        !@EQUAL
              MOVE      "01",XREFFC
              PACK      ERRDESC,SP70,SP70
              CLEAR     ERRDESC
              APPEND    "#4240 - Referral for further care ",ERRDESC
              APPEND    "should not be referred",ERRDESC
              CALL      PRINTERR
            ENDIF
          ENDIF
.
.                                           * Hospital transfers *************
VALD7300  MATCH     "4",XSASRCE             * check "transfered from Hospital"
          IF        @EQUAL
            MATCH     "0000",XHTRANFR
            IF        @EQUAL
              CLEAR     ERRDESC
              APPEND    "#nnnn - Transfer Source requires a 'from'",ERRDESC
              APPEND    " Hospital Code",ERRDESC
              CALL      PRINTERR
            ENDIF
          ENDIF
.
          MOVE      XNATSEP,DIM1
          REP       "2-7-",DIM1
          MATCH     "-",DIM1                * check "transfered to Hospital"
          IF        @EQUAL
            MATCH     "0000",XHTRANTO
            IF        @EQUAL
              CLEAR     ERRDESC
              APPEND    "#nnnn - Transfer Source requires a 'to'",ERRDESC
              APPEND    " Hospital Code",ERRDESC
              CALL      PRINTERR
            ENDIF
          ENDIF
.
.                                           * Legal Status *******************
VALD7400  MOVE      XLEGSTAT,DIM1
.          IF        DOYR2023 = 1
          REP       "1-2-3-4-",DIM1
          MATCH     "-",DIM1
          IF        !@EQUAL
            MOVE      "#4220 - Invalid Mental Health Legal Status.",ERRDESC
            CALL      PRINTERR
          ENDIF
.          ELSE
.            REP       "1-2-3-",DIM1
.            MATCH     "-",DIM1
.            IF        !@EQUAL
.              MOVE      "#Invalid Mental Health Legal Status.",ERRDESC
.              CALL      PRINTERR
.            ENDIF
.          ENDIF
.
.  
.   *** Error 2301  and 2302 ***
          MATCH     "7",XEOC                * Episode of Care = 7 (H@H)
          IF        !@EQUAL
            MATCH     "5",XEOC              * Episode of Care = 5 Newborn
            GOTO      VALD7450 IF NOT EQUAL
          ENDIF
.
          MATCH     SP70,XHICU
          IF        !@EQUAL
            MOVE      "#2301 - ICU Hours incompatible with EOC type.",ERRDESC
            CALL      PRINTERR
          ENDIF
          
          MATCH     SP70,XHMECVNW
          IF        !@EQUAL
            MOVE      "#2303 - HMV Hours incompatible with EOC type.",ERRDESC
            CALL      PRINTERR
          ENDIF
.
. *** warning 4521 and 4206 **
.
VALD7450  COMPARE   ZERO,OLDDVAS
          GOTO      VALD7500 IF EQUAL
          COMPARE   FOUR,OLDDVAS
          IF        !@EQUAL
            COMPARE   "4",FUNSRC
            GOTO      VALD7500 IF NOT EQUAL
          ENDIF
.
          COMPARE   OLDDVAS,FUNSRC
          IF        !@EQUAL
            MOVE      "#4521 - DVA Status has changed since last EOC.",ERRDESC
            CALL      PRINTERR
          ENDIF
.
VALD7500  MATCH     SP70,OLDINDS
          IF        !@EQUAL
            MATCH     OLDINDS,XRACE
            IF        !@EQUAL
            MOVE "#4206 - Indigenous Status has changed since last EOC.",ERRDESC
              CALL      PRINTERR
            ENDIF
          ENDIF
.
VALD7600  MATCH     "P",XEOC                * Episode of Care = Indicator 7
          IF        @EQUAL
            MOVE      XNATSEP,KEY1
            REP       "5-6-",DIM1
            MATCH     "-",KEY1
            IF        !@EQUAL
              PACK      ERRDESC,SP70,SP70
              CLEAR     ERRDESC
              APPEND    "#2745 - Incorrect Nature of Separation",ERRDESC
              APPEND    " for Episode of Care Type",ERRDESC
              CALL      PRINTERR
            ENDIF
.
            MATCH     SP70,XPRICON
            GOTO      VALD9000 IF EQUAL
.
            MATCH     "Z52",XPRICON
            IF        !@EQUAL
              PACK      ERRDESC,SP70,SP70
              CLEAR     ERRDESC
              APPEND    "#4051 - Warning Procurement Episode,",ERRDESC
              APPEND    " Procurement Diag. Code Required",ERRDESC
              CALL      PRINTERR
            ENDIF
          ENDIF
.
VALD9000  MOVE      SP1,KEY1
.
VALD9999  RETURN
+
.**************************************************************************
.                              Edit Principal Diag. "F1N"
.                               EDF1N000                   From  VALD0000
.**************************************************************************
EDF1N000  MOVE      ZERO,COUNT2
          MOVE      ZERO,FLAG1
          MOVE      XPRICON,DIM3A     * save the first 3 characters (eg "F17")
.
          REPEAT                      * see if F101, F111, F121 or F171 exists
            ADD       ONE,COUNT2
            MOVE      SP5,CODE5             * scan primary & addit. diagnosis
            LOAD      CODE5,COUNT2,XPRICON,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99

            MATCH     SP7,CODE5
            GOTO      EDF1N200 IF EQUAL
.
            UNPACK    CODE5,DIM3,DIM1     * get 4th character
            MATCH     DIM3,DIM3A          * is the prefix correct ?
            IF        @EQUAL
              MATCH     "1",DIM1
              IF        @EQUAL
                MOVE      ONE,FLAG1         * found "F1n1"
              ENDIF
            ENDIF
          UNTIL     COUNT2 > 99 | FLAG1 = 1
.
EDF1N200  COMPARE   ONE,FLAG1
          GOTO      EDF1N999 IF NOT EQUAL   * get out - no "F1n1" code
.
          MOVE      ZERO,COUNT2
          REPEAT
            ADD       ONE,COUNT2
            MOVE      SP5,CODE5             * scan primary & addit. diagnosis
            LOAD      CODE5,COUNT2,XPRICON,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99

            MATCH     SP5,CODE5
            GOTO      EDF1N400 IF EQUAL
.
            UNPACK    CODE5,DIM3,DIM1     * get first 3 characters
            MATCH     DIM3,DIM3A          * is the prefix correct ?
            IF        @EQUAL
              MATCH     "1",DIM1
              IF        !@EQUAL
                MOVE      ONE,FLAG1       * found an "F1nn"
                GOTO      EDF1N400
              ENDIF
            ENDIF
          UNTIL     COUNT2 > 99 | FLAG1 = 1
.
EDF1N400  COMPARE   "1",FLAG1
          GOTO      EDF1N999 IF NOT EQUAL
.
          CLEAR     ERRDESC
          UNPACK    DIM3A,DIM2,DIM1
          REP       "00112273",DIM1
          MOVE      DIM1,COUNT 
          BRANCH    COUNT,EDF1N510,EDF1N520,EDF1N530
.
EDF1N500  MOVE      "#4812 - Harmful use of alcohol ",ERRDESC
          GOTO      EDF1N900
.
EDF1N510  MOVE      "#4812 - Harmful use of opiods ",ERRDESC
          GOTO      EDF1N900
.
EDF1N520  MOVE      "#4812 - Harmful use of cannabinoids ",ERRDESC
          GOTO      EDF1N900
.
EDF1N530  MOVE      "#4812 - Harmful use of tabacco ",ERRDESC
          GOTO      EDF1N900
.
EDF1N900  ENDSET    ERRDESC
          APPEND    "not required with related disorder",ERRDESC
          CALL      PRINTERR
.
EDF1N999  RETURN
+
.**************************************************************************
.                              Edit Principal Diag. "F0"
.                               EDF0N000                   From  VALD0000
.**************************************************************************
EDF0N000  MOVE      ZERO,COUNT2
          MOVE      ZERO,F00FLAG
          MOVE      ZERO,G30FLAG
.
          REPEAT                      * see if F000 exists in any
            ADD       ONE,COUNT2
            MOVE      SP5,CODE5             * scan additional diagnosis
            LOAD      CODE5,COUNT2,XPRICON,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99

            MATCH     SP7,CODE5
            GOTO      EDF0N200 IF EQUAL
.
            UNPACK    CODE5,DIM3
            MATCH     "G30",DIM3
            IF        @EQUAL
              MOVE      ONE,G30FLAG       * found "G30"
            ENDIF
            MATCH     "F00",DIM3
            IF        @EQUAL
              MOVE      ONE,F00FLAG       * found "F00"
            ENDIF
          UNTIL     COUNT2 > 99 | FLAG1 = 1
.
EDF0N200  COMPARE   ZERO,F00FLAG       * no f00, exit
          GOTO      EDF0N999 IF EQUAL
.
          COMPARE   ONE,G30FLAG     * we have f00, but no g30, error
          GOTO      EDF0N999 IF EQUAL
.
EDF0N500  MOVE      "#4080 - External Cause Code Required",ERRDESC
          ENDSET    ERRDESC
          CALL      PRINTERR
.
EDF0N999  RETURN
+

.**************************************************************************
.                    Edit Unacceptable First Code Procedure
.                               ED1PRC00                   From  VALD0000
.**************************************************************************
ED1PRC00  MATCH     SP7,XPPROCA
          GOTO      ED1PRC99 IF EQUAL
.
          MOVE      ZERO,COUNT 
          MOVE      TWENTY1,COUNT2
          SEARCH    XPPROCA,UNACPROC,COUNT2,COUNT
          GOTO      ED1PRC90 IF EQUAL       * one of the "unaccept Procs" found
.
          MOVE      SP9,PT0OBLKN            * now get the Procedures Block No.
          PACK      KEY9,SPROCA,SP9
          CALL      RDPT10O1

          MOVE      ZERO,BLOKNO
          SQUEEZE   PT0OBLKN
          MOVE      PT0OBLKN,BLOKNO
.
          IF        BLOKNO = 1909 | BLOKNO = 1910
            GOTO      ED1PRC90              * its an unacceptable Block
          ENDIF
          GOTO      ED1PRC99
.
ED1PRC90  PACK      ERRDESC,SP70,SP70
          CLEAR     ERRDESC
          APPEND    "#4832 - Procedure unacceptable as ",ERRDESC
          APPEND    "first procedure code",ERRDESC
          CALL      PRINTERR
.
ED1PRC99  RETURN
.
.**************************************************************************
.                         Edit Activity Codes
.                               EDACTV00                   From  VALD0000
.**************************************************************************
EDACTV00  MATCH     SP5,XACTVITY
          GOTO      EDACTV99 IF EQUAL
.
.                                           * check XEXTCAUS & XACTVITY
          MOVE      ZERO,FLAG1              * valid external cause yes/no
          MOVE      ZERO,FLAG2              * valid activity   yes/no
.
          UNPACK    XEXTCAUS,DIM1,DIM2
          REP       "V-W-X-Y-",DIM1
          MATCH     "-",DIM1
          GOTO      EDACTV10 IF NOT EQUAL   * not in range V..-Y..
.
          MATCH     "Y",XEXTCAUS
          IF        @EQUAL
            MOVE      DIM2,FORM2
            COMPARE   "35",FORM2
            GOTO      EDACTV10 IF NOT LESS  * not in range Y00-Y34
            MOVE      ONE,FLAG1
          ENDIF
.
EDACTV10  UNPACK    XACTVITY,DIM1,DIM3    * check range U500-U739
          CMATCH    "U",DIM1
          IF        @EQUAL
            MOVE      DIM3,FORM3               * check range U500-U739
            IF        FORM3 > 499 & FORM3 < 740
              MOVE      ONE,FLAG2
            ENDIF
          ENDIF
.
          IF        FLAG1 = 1 & FLAG2 = 0
            CLEAR     ERRDESC
            PACK      ERRDESC,SP70,SP70
            APPEND    "#4880 - Activity code required in",ERRDESC
            APPEND    "  data item 93, activity",ERRDESC
            CALL      PRINTERR
          ENDIF
          MOVE      FLAG1,FLAG3             * flag for final test
.
.                                           * next edit - check additn.diags
EDACTV20  MOVE      ZERO,FLAG1              * range V0000-Y34 yes/no
          MOVE      ZERO,FLAG2              * range U5000-U739 yes/no
          MOVE      ZERO,COUNT2
          REPEAT
            ADD       ONE,COUNT2
            MOVE      SP5,CODE5             * scan additional diagnosis
            LOAD      CODE5,COUNT2,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99

            MATCH     SP5,CODE5
            GOTO      EDACTV30 IF EQUAL
.
            UNPACK    CODE5,DIM1,DIM2
            REP       "V-W-X-Y-",DIM1
            MATCH     "-",DIM1
            GOTO      EDACTV29 IF NOT EQUAL   * not in range V..-Y..
.
            MATCH     "Y",CODE5     
            IF        @EQUAL
              MOVE      DIM2,FORM2
              COMPARE   "35",FORM2
              GOTO      EDACTV29 IF NOT LESS  * not in range Y00-Y34
              MOVE      ONE,FLAG1
            ENDIF
.
EDACTV29    MOVE      ZERO,COUNT
          UNTIL     COUNT2 > 98 | FLAG1 = 1
.
EDACTV30  MOVE      ZERO,COUNT2
          REPEAT
            ADD       ONE,COUNT2
            MOVE      SP5,CODE5             * scan additional diagnosis
            LOAD      CODE5,COUNT2,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99
.
            MATCH     SP5,CODE5
            GOTO      EDACTV40 IF EQUAL
.
            UNPACK    CODE5,DIM1,DIM3
            CMATCH    "U",DIM1
            IF        @EQUAL
              MOVE      DIM3,FORM3               * check range U500-U739
              IF        FORM3 > 499 & FORM3 < 740
                MOVE      ONE,FLAG2
              ENDIF
            ENDIF
.
          UNTIL     COUNT2 > 98 | FLAG2 = 1
.
.
EDACTV40  IF        FLAG1 = 1 & FLAG2 = 0
            CLEAR     ERRDESC
            PACK      ERRDESC,SP70,SP70
            APPEND    "#4885 - Activity code required in",ERRDESC
            APPEND    " data item 46, additional diagnosis or",ERRDESC
            APPEND    " data item 93, Activity",ERRDESC
            CALL      PRINTERR
          ENDIF
.
          IF        FLAG1 = 0 & FLAG3 = 0 & FLAG2 = 1
            MATCH     SP5,XACTVITY
            IF        !@EQUAL
              MOVE      SP5,XACTVITY
              MOVE      "#4870 - Activity code not required",ERRDESC
              CALL      PRINTERR
            ENDIF
          ENDIF
.
EDACTV99  RETURN
.
.
.**************************************************************************
.                         Burns - Body Surface Area
.                               EDBURN00                   From  VALD0000
.**************************************************************************
EDBURN00  MOVE      ZERO,COUNT
          MOVE      ZERO,FLAG1
          MOVE      ZERO,FLAG2
.
          MOVE      ZERO,COUNT2
          REPEAT
            ADD       ONE,COUNT2
            MOVE      SP5,CODE5             * scan additional diagnosis
            LOAD      CODE5,COUNT2,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99
.
            MATCH     SP5,CODE5
            GOTO      EDBURN99 IF EQUAL     * 1st diag. not found - exit routine
.
            CMATCH    "T",CODE5
            IF        @EQUAL
              UNPACK    CODE5,DIM1,DIM4
              MOVE      ZERO,FORM4
              MOVE      DIM4,FORM4          * check range T3100-T3199
              IF        FORM4 > 3099 & FORM4 < 3200
                MOVE      ONE,FLAG1
              ENDIF
            ENDIF
          UNTIL     COUNT > 98 | FLAG1 = 1
.
EDBURN20  MOVE      ZERO,COUNT2
          REPEAT
            ADD       ONE,COUNT2
            MOVE      SP5,CODE5             * scan primary & addit. diagnosis
            LOAD      CODE5,COUNT2,XPRICON,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99
.
            MATCH     SP5,CODE5
            GOTO      EDBURN40 IF EQUAL     * none found
.
            UNPACK    CODE5,DIM1,DIM3
            REP       "T-L-",DIM1
            MATCH     "-",DIM1
            IF        @EQUAL
              MOVE      ZERO,FORM3
              MOVE      DIM3,FORM3
              CMATCH    "T",CODE5           * check range T200-T253 T290-293
              IF        @EQUAL
                IF        FORM3 > 199 & FORM3 < 254
                  MOVE      ONE,FLAG2
                ENDIF
                IF        FORM3 > 289 & FORM3 < 294
                  MOVE      ONE,FLAG2
                ENDIF
              ELSE                          * check range L550-L559
                IF        FORM3 > 549 & FORM3 < 560
                  MOVE      ONE,FLAG2
                ENDIF
              ENDIF
            ENDIF
.
          UNTIL     COUNT > 99 | FLAG2 = 1
.
EDBURN40  IF        FLAG1 = 1 & FLAG2 = 0
            MOVE      "#4295 - T31 code assigned burns code required",ERRDESC
            CALL      PRINTERR
          ENDIF
.
EDBURN99  RETURN
.
.**************************************************************************
.                               Neoplasm
.                               EDNEOP00                   From  VALD0000
.**************************************************************************
EDNEOP00  MOVE      ZERO,COUNT
          MOVE      ZERO,FLAG1
          MOVE      ZERO,FLAG2
.
          MOVE      ZERO,COUNT2
          REPEAT
            ADD       ONE,COUNT2
            MOVE      SP5,CODE5             * scan primary & addit. diagnosis
            LOAD      CODE5,COUNT2,XPRICON,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99
.
            MATCH     SP5,CODE5
            GOTO      EDNEOP99 IF EQUAL     * 1st diag. not found - exit routine
.
            UNPACK    CODE5,DIM1,DIM3
            MATCH     "C",DIM1              * check range C770-C798
            IF        @EQUAL
              MOVE      ZERO,FORM3
              MOVE      DIM3,FORM3
              IF        FORM3 > 769 & FORM3 < 799
                MOVE      ONE,FLAG1
              ENDIF
            ENDIF
          UNTIL     COUNT2 > 24 | FLAG1 = 1
.
EDNEOP20  MOVE      ZERO,COUNT2
          REPEAT
            ADD       ONE,COUNT2
            MOVE      SP5,CODE5
            MOVE      SP5,CODE5             * scan primary & addit. diagnosis
            LOAD      CODE5,COUNT2,XPRICON,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99
.
            MATCH     SP5,CODE5
            GOTO      EDNEOP40 IF EQUAL
.           
            UNPACK    CODE5,DIM1,DIM3       
            MATCH     "C",DIM1              * check range C000-C768 C80
            IF        @EQUAL
              MOVE      ZERO,FORM3
              MOVE      DIM3,FORM3
              IF        FORM3 = 000 | (FORM3 > 000 & FORM3 < 769)
                MOVE      ONE,FLAG2
              ENDIF
              MATCH     "80",DIM3
              IF        @EQUAL
                MOVE      ONE,FLAG2
              ENDIF
            ENDIF   
          UNTIL     COUNT2 > 99 | FLAG2 = 1
.
EDNEOP40  IF        FLAG1 = 1 & FLAG2 = 0
            PACK      ERRDESC,SP70,SP70
            CLEAR     ERRDESC
            APPEND    "#4145 - Secondary neoplasm, primary",ERRDESC
            APPEND    " code required",ERRDESC
            CALL      PRINTERR
          ENDIF

EDNEOP99  RETURN
.
.**************************************************************************
.                          Outcome of Delivery
.                               EDODEL00                   From  VALD0000
.**************************************************************************
EDODEL00  MOVE      ZERO,COUNT
          MOVE      ZERO,FLAG1
          MOVE      ZERO,FLAG2
.           
          MOVE      ZERO,COUNT2 
          REPEAT
            ADD       ONE,COUNT2
            MOVE      SP5,CODE5             * scan primary & addit. diagnosis
            LOAD      CODE5,COUNT2,XPRICON,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99
.
            MATCH     SP5,CODE5    
            GOTO      EDODEL20 IF EQUAL
.           
            UNPACK    CODE5,DIM1,DIM3
            MATCH     "O",DIM1              * check range O601-O879 O890-O909
            IF        @EQUAL
              MOVE      ZERO,FORM3
              MOVE      DIM3,FORM3
              IF        (FORM3 > 600 & FORM3 < 880) | (FORM3 >889 & FORM3 <910)
                MOVE      ONE,FLAG1
              ENDIF
            ENDIF
          UNTIL     COUNT2 > 99 | FLAG1 = 1
.
EDODEL20  BRANCH    FLAG1,EDODEL50          * flag already on
          MATCH     SP7,XPPROCA
          IF        !@EQUAL 
            MOVE      SP9,PT0OBLKN          * now get the Procedures Block No.
            PACK      KEY9,SPROCA,SP9
            CALL      RDPT10O1 
            MOVE      ZERO,BLOKNO
            SQUEEZE   PT0OBLKN
            MOVE      PT0OBLKN,BLOKNO       
            IF        BLOKNO > 1335 & BLOKNO < 1348
              IF        BLOKNO <> 1341 & BLOKNO <> 1342 & BLOKNO <> 1345
                MOVE      ONE,FLAG1
                GOTO      EDODEL50
              ENDIF
            ENDIF
          ENDIF
.
EDODEL30  MOVE      XPPROCA,FORM7
          IF        (FORM7>9047101 & FORM7<9047107)|FORM7=1656400|FORM7=1656401
            MOVE      ONE,FLAG1
          ENDIF
.
.
EDODEL50  COMPARE   ZERO,FLAG1
          GOTO      EDODEL99 IF EQUAL
.
          MOVE      ZERO,COUNT2
          REPEAT      
            ADD       ONE,COUNT2
            MOVE      SP5,CODE5             * scan additional diagnosis
            LOAD      CODE5,COUNT2,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99
.
            MATCH     SP5,CODE5
            GOTO      EDODEL60 IF EQUAL     * none found
.           
            UNPACK    CODE5,DIM1,DIM3
            MATCH     "Z",DIM1
            IF        @EQUAL
              MOVE      ZERO,FORM3
              MOVE      DIM3,FORM3
              IF        (FORM3 > 369 & FORM3 < 380)|(FORM3 > 389 & FORM3 < 393)
                MOVE      ONE,FLAG2
              ENDIF
            ENDIF
.
          UNTIL     COUNT2 > 98 | FORM2 = 1
.
EDODEL60  IF        FLAG1 = 1 & FLAG2 = 0
            PACK      ERRDESC,SP70,SP70
            CLEAR     ERRDESC
            APPEND    "#4890 - Delivery/Post-partum stated",ERRDESC
            APPEND    " with a Z37 or Z39 code",ERRDESC
            CALL      PRINTERR
          ENDIF
.
EDODEL99  RETURN
.
.           
.**************************************************************************
.                          Duration of Pregency
.                               EDDPRE00                   From  VALD0000
.**************************************************************************
EDDPRE00  MOVE      ZERO,COUNT 
          MOVE      ZERO,FLAG1
          MOVE      ZERO,FLAG2
.           
          MOVE      ZERO,COUNT2
          REPEAT
            ADD       ONE,COUNT2
            MOVE      SP5,CODE5             * scan primary & addit. diagnosis
            LOAD      CODE5,COUNT2,XPRICON,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99
.
            MATCH     SP5,CODE5
            GOTO      EDDPRE99 IF EQUAL     * 1st diag. not found - exit routine
.
            UNPACK    CODE5,DIM1,DIM3
            MATCH     "O",DIM1              * check range O601-O879 O890-O909
            IF        @EQUAL
              MOVE      ZERO,FORM3
              MOVE      DIM3,FORM3
              IF        (FORM3>600&FORM3<604)|(FORM3>619&FORM3<880)|(FORM3>889&FORM3<910)
                MOVE      ONE,FLAG1
              ENDIF
            ENDIF
          UNTIL     COUNT2 > 99 | FLAG1 = 1
.
EDDPRE20  MOVE      ZERO,COUNT2
          REPEAT
            ADD       ONE,COUNT2
            MOVE      SP5,CODE5             * scan additional diagnosis
            LOAD      CODE5,COUNT2,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99
.
            MATCH     SP5,CODE5
            GOTO      EDDPRE40 IF EQUAL     * none found
.           
            UNPACK    CODE5,DIM1,DIM3
            MATCH     "O",DIM1
            IF        @EQUAL
              MOVE      ZERO,FORM3
              MOVE      DIM3,FORM3
              IF        FORM3 > 089 & FORM3 < 100
                MOVE      ONE,FLAG2
              ENDIF
            ENDIF
.
          UNTIL     COUNT2 > 98 | FORM2 = 1
.
EDDPRE40  IF        FLAG1 = 1 & FLAG2 = 0
            MOVE      "#4185 - Duration of pregency code required",ERRDESC
            CALL      PRINTERR
          ENDIF
.
EDDPRE99  RETURN
.
.**************************************************************************
.                          Place of Occurrencey
.                               EDDPRE00                   From  VALD0000
.**************************************************************************
EDPLOC00  MOVE      ZERO,COUNT
          MOVE      ZERO,FLAG1
          MOVE      ZERO,FLAG2
.
          MOVE      ZERO,COUNT2
          REPEAT
            ADD       ONE,COUNT2
            MOVE      SP5,CODE5             * scan ext.cause & addit. diagnosis
            LOAD      CODE5,COUNT2,XEXTCAUS,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99
.
            MATCH     SP5,CODE5
            GOTO      EDPLOC20 IF EQUAL     * 1st diag. not found 
.
            UNPACK    CODE5,DIM1,DIM3
            MATCH     "V",DIM1              * check range V0000-Y899
            IF        @EQUAL
              MOVE      ZERO,FORM3
              MOVE      DIM3,FORM3
              IF        FORM3 = 0 | (FORM3 > 000 & FORM3 < 900)
                MOVE      ONE,FLAG1
              ENDIF
            ENDIF
          UNTIL     COUNT2 > 99 | FLAG1 = 1   
.
EDPLOC20  MOVE      ZERO,COUNT2
          UNPACK    XPLCEOCC,DIM1,DIM3
          MATCH     "Y",DIM1                * check range Y920-Y929
          IF        @EQUAL
            MOVE      ZERO,FORM3
            MOVE      DIM3,FORM3
            IF        FORM3 > 919 & FORM3 < 929
              MOVE      ONE,FLAG2
            ENDIF
          ENDIF
.
EDPLOC40  IF        FLAG1 = 1 & FLAG2 = 0
            MOVE      "Y929 ",XPLCEOCC
            MOVE      "#4960 - Place of occurence code required",ERRDESC
            CALL      PRINTERR
          ENDIF
.
         MATCH     SP70,XPLCEOCC
          IF        !@EQUAL
            MATCH     SP70,XEXTCAUS
            IF        @EQUAL
              MOVE      "#4950 - Place of occurence code not required",ERRDESC
            ENDIF
          ENDIF
.
...       IF        FLAG1 = 0 & FLAG2 = 1
...         MOVE      SP5,XPLCEOCC
...         MOVE      "#4950 - Place of occurence code not required",ERRDESC
...         CALL      PRINTERR
...       ENDIF
.
EDPLOC50  IF        FLAG1 = 1
            MOVE      ZERO,COUNT2 
            REPEAT
              ADD       ONE,COUNT2
              MOVE      SP5,CODE5           * scan addit. diagnosis
              LOAD      CODE5,COUNT2,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99
.
              MATCH     SP5,CODE5
              GOTO      EDPLOC99 IF EQUAL     * 1st diag. not found
.
              MATCH     XPLCEOCC,CODE5
              IF        @EQUAL
                STORE     SP5,COUNT2,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4:
                                   XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9:
                                   XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14:
                                   XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19:
                                   XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24:
                                   XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29:
                                   XOTHCO30,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34:
                                   XOTHCO35,XOTHCO36,XOTHCO37,XOTHCO38,XOTHCO39:
                                   XOTHCO40,XOTHCO41,XOTHCO42,XOTHCO43,XOTHCO44:
                                   XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48,XOTHCO49:
                                   XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54:
                                   XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59:
                                   XOTHCO60,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64:
                                   XOTHCO65,XOTHCO66,XOTHCO67,XOTHCO68,XOTHCO69:
                                   XOTHCO70,XOTHCO71,XOTHCO72,XOTHCO73,XOTHCO74:
                                   XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78,XOTHCO79:
                                   XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84:
                                   XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89:
                                   XOTHCO90,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94:
                                   XOTHCO95,XOTHCO96,XOTHCO97,XOTHCO98,XOTHCO99
.
                GOTO      EDPLOC99
              ENDIF
            UNTIL     COUNT2 > 98 
          ENDIF
.
EDPLOC99  RETURN
.
STLLTODO  RETURN
.**************************************************************************
.*                               PRINTERR              Called by: VALD0000*
.*                          Print error report                            *
.**************************************************************************
.
PRINTERR  COMPARE   ZERO,ERRFND
          IF        @EQUAL
            CLOCK     TIME,CTIMEIS
            MOVE      ONE,ERRFND
            MOVE      ONE,ERRORS
            CALL      HEAD80
            CALL      UND80
            PRINT     *1,"|","U/R Number",*12,"|","Adm Number",*23,"| ":
                      " Error Description",*80,"|"
            CALL      UND80
            MOVE      "6",CLNO
          ENDIF
.
          COMPARE   FIFTY5,CLNO
          IF        !@LESS
            CALL      HEAD80
          ENDIF
.
          PRINT     *1,"| ",PURNO,*12,"| ",SAVADMN,*23,"| ",ERRDESC,*80,"|"
          ADD       ONE,CLNO
.
          RETURN
+
.**************************************************************************
.*                               CLEA0000              Called by: DETA0000*
.*                          Clear variables                               *
.**************************************************************************
.
CLEA0000  UNPACK    SP127,XURNO,XSEX,XMARSTAT
          UNPACK    SP127,XCLINCOD,XADMNO,XMEDI,XLGA,XSUBURB,XPOSTCOD
          UNPACK    SP127,XMEDIIRN,XPREVSPC
          UNPACK    SP127,XCOUNTRY,XRACE,XPBDATE,XPACLSS,XSASRCE
          UNPACK    SP127,XADATE,XADELEC,XATYPE,XSTCHGD1,XSTCHGE1
          UNPACK    SP127,XSTCHGA1,XSTCHGD2,XSTCHGE2,XSTCHGA2
          UNPACK    SP127,XSTCHGD3,XSTCHGE3,XSTCHGA3,XVETCARD,XVETNUM
          UNPACK    SP127,XINSSTAT,XSEPDATE,XREFFC,XNATSEP,XHTRANTO
          UNPACK    SP127,XPRICON,XOTHCO1,XOTHCO2,XOTHCO3,XOTHCO4
          UNPACK    SP127,XPRICONO,XONSTO1,XONSTO2,XONSTO3,XONSTO4
          UNPACK    SP127,XOTHCO5,XOTHCO6,XOTHCO7,XOTHCO8,XOTHCO9
          UNPACK    SP127,XONSTO5,XONSTO6,XONSTO7,XONSTO8,XONSTO9
          UNPACK    SP127,XOTHCO10,XOTHCO11,XOTHCO12,XOTHCO13,XOTHCO14
          UNPACK    SP127,XONSTO10,XONSTO11,XONSTO12,XONSTO13,XONSTO14
          UNPACK    SP127,XOTHCO15,XOTHCO16,XOTHCO17,XOTHCO18,XOTHCO19
          UNPACK    SP127,XONSTO15,XONSTO16,XONSTO17,XONSTO18,XONSTO19
          UNPACK    SP127,XOTHCO20,XOTHCO21,XOTHCO22,XOTHCO23,XOTHCO24
          UNPACK    SP127,XONSTO20,XONSTO21,XONSTO22,XONSTO23,XONSTO24
          UNPACK    SP127,SPRICON,SOTHCO1,SOTHCO2,SOTHCO3,SOTHCO4
          UNPACK    SP127,SOTHCO5,SOTHCO6,SOTHCO7,SOTHCO8,SOTHCO9
          UNPACK    SP127,SOTHCO10,SOTHCO11,SOTHCO12,SOTHCO13,SOTHCO14
          UNPACK    SP127,SOTHCO15,SOTHCO16,SOTHCO17,SOTHCO18,SOTHCO19
          UNPACK    SP127,SOTHCO20,SOTHCO21,SOTHCO22,SOTHCO23,SOTHCO24
          UNPACK    SP127,XPPROCA,XPPROCLA,XPROCB
          UNPACK    SP127,XPROCLB,XPROCC,XPROCLC,XPROCD,XPROCLD
          UNPACK    SP127,XPROCE,XPROCLE,XPROCF,XPROCLF,XPROCG,XPROCLG
          UNPACK    SP127,XPROCH,XPROCLH,XPROCI,XPROCLI,XPROCJ,XPROCLJ
          UNPACK    SP127,XPROCK,XPROCLK,XPROCL,XPROCLL,XPROCM,XPROCLM
          UNPACK    SP127,XPROCN,XPROCLN,XPROCO,XPROCLO,XPROCP,XPROCLP
          UNPACK    SP127,XPROCQ,XPROCLQ,XPROCR,XPROCLR,XPROCS,XPROCLS
          UNPACK    SP127,XPROCT,XPROCLT,XPROCU,XPROCLU,XPROCV,XPROCLV
          UNPACK    SP127,XPROCW,XPROCLW,XPROCX,XPROCLX,XPROCY,XPROCLY
          UNPACK    SP127,SPROCA,SPROCB,SPROCC,SPROCD,SPROCE,SPROCF
          UNPACK    SP127,SPROCG,SPROCH,SPROCI,SPROCJ,SPROCK,SPROCL
          UNPACK    SP127,SPROCM,SPROCN,SPROCO,SPROCP,SPROCQ,SPROCR
          UNPACK    SP127,SPROCS,SPROCT,SPROCU,SPROCV,SPROCW,SPROCX
          UNPACK    SP127,SPROCY,XEXTCAUS          
          UNPACK    SP127,XEOC,XFUNDSRC,XUNREAD,XADMCAT,XCPURNO
          UNPACK    SP127,XDACONPR,XHOSPNUM,XLEAVFD1,XLEAVFT1,XLEAVTD1
          UNPACK    SP127,XLEAVTT1,XLEAVFD2,XLEAVFT2,XLEAVTD2,XLEAVTT2
          UNPACK    SP127,XLEAVFD3,XLEAVFT3,XLEAVTD3,XLEAVTT3,XLEAVFD4
          UNPACK    SP127,XLEAVFT4,XLEAVTD4,XLEAVTT4,XADWGHT,XHICU
          UNPACK    SP127,XHMECVEN,XLEGSTAT,XADMTIME,XSEPTIME,XHTRANFR,XHMECVNW
          UNPACK    SP127,XMHLV,XOACISLV,XADUCHI,XPSYCAD
          UNPACK    SP127,XEMPSTAT,XPENSTAT,XUSUACC,XDOBACC,XRESITEM
          UNPACK    SP127,XEXTCONS,XPLOCONS,XACTVONS
          UNPACK    SP127,XADMWARD
          UNPACK    SP127,XDOFOTP
          UNPACK    SP127,XTFOTP
          UNPACK    SP127,XDISWARD
          UNPACK    SP127,XPLCEOCC,XACTVITY
          UNPACK    SP127,XDTTODL,XTTTODL
          REP       " 0",XDTTODL
          REP       " 0",XTTTODL
          UNPACK    SP127,XPREFLNG,XRELGAFF,XINTREQD
          REP       " 0",XPREFLNG
          REP       " 0",XRELGAFF
.
.--------*T0889020 - new extract fields from 01/07/2020
          UNPACK    SP127,XEPASVID,XMHACCPR,XSUBURBL
          UNPACK    SP127,XPROC025,XPROC026,XPROC027,XPROC028,XPROC029,XPROC030
          UNPACK    SP127,XPROC031,XPROC032,XPROC033,XPROC034,XPROC035,XPROC036
          UNPACK    SP127,XPROC037,XPROC038,XPROC039,XPROC040,XPROC041,XPROC042
          UNPACK    SP127,XPROC043,XPROC044,XPROC045,XPROC046,XPROC047,XPROC048
          UNPACK    SP127,XPROC049,XPROC050,XPROC051,XPROC052,XPROC053,XPROC054
          UNPACK    SP127,XPROC055,XPROC056,XPROC057,XPROC058,XPROC059,XPROC060
          UNPACK    SP127,XPROC061,XPROC062,XPROC063,XPROC064,XPROC065,XPROC066
          UNPACK    SP127,XPROC067,XPROC068,XPROC069,XPROC070,XPROC071,XPROC072
          UNPACK    SP127,XPROC073,XPROC074,XPROC075,XPROC076,XPROC077,XPROC078
          UNPACK    SP127,XPROC079,XPROC080,XPROC081,XPROC082,XPROC083,XPROC084
          UNPACK    SP127,XPROC085,XPROC086,XPROC087,XPROC088,XPROC089,XPROC090
          UNPACK    SP127,XPROC091,XPROC092,XPROC093,XPROC094,XPROC095,XPROC096
          UNPACK    SP127,XPROC097,XPROC098,XPROC099
.
          UNPACK    SP127,XPRCL025,XPRCL026,XPRCL027,XPRCL028,XPRCL029,XPRCL030
          UNPACK    SP127,XPRCL031,XPRCL032,XPRCL033,XPRCL034,XPRCL035,XPRCL036
          UNPACK    SP127,XPRCL037,XPRCL038,XPRCL039,XPRCL040,XPRCL041,XPRCL042
          UNPACK    SP127,XPRCL043,XPRCL044,XPRCL045,XPRCL046,XPRCL047,XPRCL048
          UNPACK    SP127,XPRCL049,XPRCL050,XPRCL051,XPRCL052,XPRCL053,XPRCL054
          UNPACK    SP127,XPRCL055,XPRCL056,XPRCL057,XPRCL058,XPRCL059,XPRCL060
          UNPACK    SP127,XPRCL061,XPRCL062,XPRCL063,XPRCL064,XPRCL065,XPRCL066
          UNPACK    SP127,XPRCL067,XPRCL068,XPRCL069,XPRCL070,XPRCL071,XPRCL072
          UNPACK    SP127,XPRCL073,XPRCL074,XPRCL075,XPRCL076,XPRCL077,XPRCL078
          UNPACK    SP127,XPRCL079,XPRCL080,XPRCL081,XPRCL082,XPRCL083,XPRCL084
          UNPACK    SP127,XPRCL085,XPRCL086,XPRCL087,XPRCL088,XPRCL089,XPRCL090
          UNPACK    SP127,XPRCL091,XPRCL092,XPRCL093,XPRCL094,XPRCL095,XPRCL096
          UNPACK    SP127,XPRCL097,XPRCL098,XPRCL099
.
          UNPACK    SP127,XOTHCO25,XOTHCO26,XOTHCO27,XOTHCO28,XOTHCO29,XOTHCO30
          UNPACK    SP127,XOTHCO31,XOTHCO32,XOTHCO33,XOTHCO34,XOTHCO35,XOTHCO36
          UNPACK    SP127,XOTHCO37,XOTHCO38,XOTHCO39,XOTHCO40,XOTHCO41,XOTHCO42
          UNPACK    SP127,XOTHCO43,XOTHCO44,XOTHCO45,XOTHCO46,XOTHCO47,XOTHCO48
          UNPACK    SP127,XOTHCO49,XOTHCO50,XOTHCO51,XOTHCO52,XOTHCO53,XOTHCO54
          UNPACK    SP127,XOTHCO55,XOTHCO56,XOTHCO57,XOTHCO58,XOTHCO59,XOTHCO60
          UNPACK    SP127,XOTHCO61,XOTHCO62,XOTHCO63,XOTHCO64,XOTHCO65,XOTHCO66
          UNPACK    SP127,XOTHCO67,XOTHCO68,XOTHCO69,XOTHCO70,XOTHCO71,XOTHCO72
          UNPACK    SP127,XOTHCO73,XOTHCO74,XOTHCO75,XOTHCO76,XOTHCO77,XOTHCO78
          UNPACK    SP127,XOTHCO79,XOTHCO80,XOTHCO81,XOTHCO82,XOTHCO83,XOTHCO84
          UNPACK    SP127,XOTHCO85,XOTHCO86,XOTHCO87,XOTHCO88,XOTHCO89,XOTHCO90
          UNPACK    SP127,XOTHCO91,XOTHCO92,XOTHCO93,XOTHCO94,XOTHCO95,XOTHCO96
          UNPACK    SP127,XOTHCO97,XOTHCO98,XOTHCO99
.
          UNPACK    SP127,XONSTO25,XONSTO26,XONSTO27,XONSTO28,XONSTO29,XONSTO30
          UNPACK    SP127,XONSTO31,XONSTO32,XONSTO33,XONSTO34,XONSTO35,XONSTO36
          UNPACK    SP127,XONSTO37,XONSTO38,XONSTO39,XONSTO40,XONSTO41,XONSTO42
          UNPACK    SP127,XONSTO43,XONSTO44,XONSTO45,XONSTO46,XONSTO47,XONSTO48
          UNPACK    SP127,XONSTO49,XONSTO50,XONSTO51,XONSTO52,XONSTO53,XONSTO54
          UNPACK    SP127,XONSTO55,XONSTO56,XONSTO57,XONSTO58,XONSTO59,XONSTO60
          UNPACK    SP127,XONSTO61,XONSTO62,XONSTO63,XONSTO64,XONSTO65,XONSTO66
          UNPACK    SP127,XONSTO67,XONSTO68,XONSTO69,XONSTO70,XONSTO71,XONSTO72
          UNPACK    SP127,XONSTO73,XONSTO74,XONSTO75,XONSTO76,XONSTO77,XONSTO78
          UNPACK    SP127,XONSTO79,XONSTO80,XONSTO81,XONSTO82,XONSTO83,XONSTO84
          UNPACK    SP127,XONSTO85,XONSTO86,XONSTO87,XONSTO88,XONSTO89,XONSTO90
          UNPACK    SP127,XONSTO91,XONSTO92,XONSTO93,XONSTO94,XONSTO95,XONSTO96
          UNPACK    SP127,XONSTO97,XONSTO98,XONSTO99
          UNPACK    SP127,XPRCGEND,XPRCIHI,XPRCIHIR,XPRCIHIN,XPRCEMRS
.
          UNPACK    SP127,XDCIDFPD,XPDCIFEC,XPDCIFPP,XPDCIFAJ
          UNPACK    SP127,XDCAD001,XDCAD002,XDCAD003,XDCAD004,XDCAD005
          UNPACK    SP127,XDCAD006,XDCAD007,XDCAD008,XDCAD009,XDCAD010
          UNPACK    SP127,XDCAD011,XDCAD012,XDCAD013,XDCAD014,XDCAD015
          UNPACK    SP127,XDCAD016,XDCAD017,XDCAD018,XDCAD019,XDCAD020
          UNPACK    SP127,XDCAD021,XDCAD022,XDCAD023,XDCAD024,XDCAD025
          UNPACK    SP127,XDCAD026,XDCAD027,XDCAD028,XDCAD029,XDCAD030
          UNPACK    SP127,XDCAD031,XDCAD032,XDCAD033,XDCAD034,XDCAD035
          UNPACK    SP127,XDCAD036,XDCAD037,XDCAD038,XDCAD039,XDCAD040
          UNPACK    SP127,XDCAD041,XDCAD042,XDCAD043,XDCAD044,XDCAD045
          UNPACK    SP127,XDCAD046,XDCAD047,XDCAD048,XDCAD049,XDCAD050
          UNPACK    SP127,XDCAD051,XDCAD052,XDCAD053,XDCAD054,XDCAD055
          UNPACK    SP127,XDCAD056,XDCAD057,XDCAD058,XDCAD059,XDCAD060
          UNPACK    SP127,XDCAD061,XDCAD062,XDCAD063,XDCAD064,XDCAD065
          UNPACK    SP127,XDCAD066,XDCAD067,XDCAD068,XDCAD069,XDCAD070
          UNPACK    SP127,XDCAD071,XDCAD072,XDCAD073,XDCAD074,XDCAD075
          UNPACK    SP127,XDCAD076,XDCAD077,XDCAD078,XDCAD079,XDCAD080
          UNPACK    SP127,XDCAD081,XDCAD082,XDCAD083,XDCAD084,XDCAD085
          UNPACK    SP127,XDCAD086,XDCAD087,XDCAD088,XDCAD089,XDCAD090
          UNPACK    SP127,XDCAD091,XDCAD092,XDCAD093,XDCAD094,XDCAD095
          UNPACK    SP127,XDCAD096,XDCAD097,XDCAD098,XDCAD099
          MOVE      ZERO,COUNTCAD
          MOVE      ZERO,DCFLAGEC
          MOVE      ZERO,DCFLAGPC
          MOVE      ZERO,DCFLAGWI
          MOVE      SP70,SAVEKEY5,TEMPDCID
.
CLEA9999  RETURN
+
.**************************************************************************
.*                               WRIT0000              Called by: ML0000  *
.*                      Write to the extract file                         *
.**************************************************************************
.
WRIT0000  MOVE      ZEROTEN,XMHLV
          MOVE      ZEROTEN,XOACISLV

WRIT2000  PACK     XEPASVID,ZEROTEN,ZEROTEN
          MOVE     ZEROTEN,XMHACCPR
          MOVE     SP70,XSUBURB
.
          WRITE     TEMP1G,SEQ;XRECTYP,XHOSCOD,XURNO,XSEX,XMARSTAT:
                           XCLINCOD,XADMNO,XMEDI,XMEDIIRN:
                           XLGA,XSUBURB,XPOSTCOD:
                           XCOUNTRY,XRACE,XPBDATE,XPACLSS,XSASRCE:
                           XADATE,XADELEC,XATYPE,XSTCHGD1,XSTCHGE1:
                           XSTCHGA1,XSTCHGD2,XSTCHGE2,XSTCHGA2:
                           XSTCHGD3,XSTCHGE3,XSTCHGA3,XVETCARD,XVETNUM:
                           XINSSTAT,XSEPDATE,XREFFC,XNATSEP,XHTRANTO:
                           XPRICON,XPRICONO,XOTHCO1,XONSTO1,XOTHCO2:
                           XONSTO2,XOTHCO3,XONSTO3,XOTHCO4,XONSTO4:
                           XOTHCO5,XONSTO5,XOTHCO6,XONSTO6,XOTHCO7:
                           XONSTO7,XOTHCO8,XONSTO8,XOTHCO9,XONSTO9:
                           XOTHCO10,XONSTO10,XOTHCO11,XONSTO11,XOTHCO12:
                           XONSTO12,XOTHCO13,XONSTO13,XOTHCO14,XONSTO14:
                           XOTHCO15,XONSTO15,XOTHCO16,XONSTO16,XOTHCO17:
                           XONSTO17,XOTHCO18,XONSTO18,XOTHCO19,XONSTO19:
                           XOTHCO20,XONSTO20,XOTHCO21,XONSTO21,XOTHCO22:
                           XONSTO22,XOTHCO23,XONSTO23,XOTHCO24,XONSTO24:
                           XPPROCA,XPPROCLA,XPROCB:
                           XPROCLB,XPROCC,XPROCLC,XPROCD,XPROCLD:
                           XPROCE,XPROCLE,XPROCF,XPROCLF,XPROCG,XPROCLG:
                           XPROCH,XPROCLH,XPROCI,XPROCLI,XPROCJ,XPROCLJ:
                           XPROCK,XPROCLK,XPROCL,XPROCLL,XPROCM,XPROCLM:
                           XPROCN,XPROCLN,XPROCO,XPROCLO,XPROCP,XPROCLP:
                           XPROCQ,XPROCLQ,XPROCR,XPROCLR,XPROCS,XPROCLS:
                           XPROCT,XPROCLT,XPROCU,XPROCLU,XPROCV,XPROCLV:
                           XPROCW,XPROCLW,XPROCX,XPROCLX,XPROCY,XPROCLY:
                         XPROC025,XPRCL025:
                           XEXTCAUS,XPLCEOCC,XACTVITY,XEOC,XFUNDSRC:
                           XUNREAD,XADMCAT,XCPURNO:
                           XDACONPR,XHOSPNUM,XLEAVFD1,XLEAVFT1,XLEAVTD1:
                           XLEAVTT1,XLEAVFD2,XLEAVFT2,XLEAVTD2,XLEAVTT2:
                           XLEAVFD3,XLEAVFT3,XLEAVTD3,XLEAVTT3,XLEAVFD4:
                           XLEAVFT4,XLEAVTD4,XLEAVTT4,XADWGHT,XHICU:
                           XHMECVEN,XLEGSTAT,XADMTIME,XSEPTIME,XHTRANFR:
                           XMHLV,XOACISLV,XADUCHI,XPSYCAD,XPREVSPC:
                           XEMPSTAT,XPENSTAT,XUSUACC,XDOBACC,XDOFOTP:
                           XTFOTP,XDISWARD,XEXTCONS,XPLOCONS,XACTVONS:
                           XDTTODL,XTTTODL,XADMWARD,XRESITEM,XPREFLNG:
                           XRELGAFF,XINTREQD:
                         XEPASVID,XMHACCPR:
                         XOTHCO25,XONSTO25,XOTHCO26,XONSTO26:
                         XOTHCO27,XONSTO27,XOTHCO28,XONSTO28,XOTHCO29,XONSTO29:
                         XOTHCO30,XONSTO30,XOTHCO31,XONSTO31,XOTHCO32,XONSTO32:
                         XOTHCO33,XONSTO33,XOTHCO34,XONSTO34,XOTHCO35,XONSTO35:
                         XOTHCO36,XONSTO36,XOTHCO37,XONSTO37,XOTHCO38,XONSTO38:
                         XOTHCO39,XONSTO39,XOTHCO40,XONSTO40,XOTHCO41,XONSTO41:
                         XOTHCO42,XONSTO42,XOTHCO43,XONSTO43,XOTHCO44,XONSTO44:
                         XOTHCO45,XONSTO45,XOTHCO46,XONSTO46,XOTHCO47,XONSTO47:
                         XOTHCO48,XONSTO48,XOTHCO49,XONSTO49,XOTHCO50,XONSTO50:
                         XOTHCO51,XONSTO51,XOTHCO52,XONSTO52,XOTHCO53,XONSTO53:
                         XOTHCO54,XONSTO54,XOTHCO55,XONSTO55,XOTHCO56,XONSTO56:
                         XOTHCO57,XONSTO57,XOTHCO58,XONSTO58,XOTHCO59,XONSTO59:
                         XOTHCO60,XONSTO60,XOTHCO61,XONSTO61,XOTHCO62,XONSTO62:
                         XOTHCO63,XONSTO63,XOTHCO64,XONSTO64,XOTHCO65,XONSTO65:
                         XOTHCO66,XONSTO66,XOTHCO67,XONSTO67,XOTHCO68,XONSTO68:
                         XOTHCO69,XONSTO69,XOTHCO70,XONSTO70,XOTHCO71,XONSTO71:
                         XOTHCO72,XONSTO72,XOTHCO73,XONSTO73,XOTHCO74,XONSTO74:
                         XOTHCO75,XONSTO75,XOTHCO76,XONSTO76,XOTHCO77,XONSTO77:
                         XOTHCO78,XONSTO78,XOTHCO79,XONSTO79,XOTHCO80,XONSTO80:
                         XOTHCO81,XONSTO81,XOTHCO82,XONSTO82,XOTHCO83,XONSTO83:
                         XOTHCO84,XONSTO84,XOTHCO85,XONSTO85,XOTHCO86,XONSTO86:
                         XOTHCO87,XONSTO87,XOTHCO88,XONSTO88,XOTHCO89,XONSTO89:
                         XOTHCO90,XONSTO90,XOTHCO91,XONSTO91,XOTHCO92,XONSTO92:
                         XOTHCO93,XONSTO93,XOTHCO94,XONSTO94,XOTHCO95,XONSTO95:
                         XOTHCO96,XONSTO96,XOTHCO97,XONSTO97,XOTHCO98,XONSTO98:
                         XOTHCO99,XONSTO99:
                         XPROC026,XPRCL026,XPROC027,XPRCL027,XPROC028,XPRCL028:
                         XPROC029,XPRCL029,XPROC030,XPRCL030,XPROC031,XPRCL031:
                         XPROC032,XPRCL032,XPROC033,XPRCL033,XPROC034,XPRCL034:
                         XPROC035,XPRCL035,XPROC036,XPRCL036,XPROC037,XPRCL037:
                         XPROC038,XPRCL038,XPROC039,XPRCL039:
                         XPROC040,XPRCL040,XPROC041,XPRCL041,XPROC042,XPRCL042:
                         XPROC043,XPRCL043,XPROC044,XPRCL044,XPROC045,XPRCL045:
                         XPROC046,XPRCL046,XPROC047,XPRCL047,XPROC048,XPRCL048:
                         XPROC049,XPRCL049,XPROC050,XPRCL050,XPROC051,XPRCL051:
                         XPROC052,XPRCL052,XPROC053,XPRCL053,XPROC054,XPRCL054:
                         XPROC055,XPRCL055,XPROC056,XPRCL056,XPROC057,XPRCL057:
                         XPROC058,XPRCL058,XPROC059,XPRCL059,XPROC060,XPRCL060:
                         XPROC061,XPRCL061,XPROC062,XPRCL062,XPROC063,XPRCL063:
                         XPROC064,XPRCL064,XPROC065,XPRCL065,XPROC066,XPRCL066:
                         XPROC067,XPRCL067,XPROC068,XPRCL068,XPROC069,XPRCL069:
                         XPROC070,XPRCL070,XPROC071,XPRCL071,XPROC072,XPRCL072:
                         XPROC073,XPRCL073,XPROC074,XPRCL074,XPROC075,XPRCL075:
                         XPROC076,XPRCL076,XPROC077,XPRCL077,XPROC078,XPRCL078:
                         XPROC079,XPRCL079,XPROC080,XPRCL080,XPROC081,XPRCL081:
                         XPROC082,XPRCL082,XPROC083,XPRCL083,XPROC084,XPRCL084:
                         XPROC085,XPRCL085,XPROC086,XPRCL086,XPROC087,XPRCL087:
                         XPROC088,XPRCL088,XPROC089,XPRCL089,XPROC090,XPRCL090:
                         XPROC091,XPRCL091,XPROC092,XPRCL092,XPROC093,XPRCL093:
                         XPROC094,XPRCL094,XPROC095,XPRCL095,XPROC096,XPRCL096:
                         XPROC097,XPRCL097,XPROC098,XPRCL098,XPROC099,XPRCL099;
.
WRIT8000  IF        DOYR2025 = 1
            WRITE     TEMP1G,SEQ;XSUBURBL,XHMECVNW;
            WRITE     TEMP1G,SEQ;XPRCGEND,XPRCIHI,XPRCIHIR,XPRCIHIN,XPRCEMRS:
                                 XDCIDFPD,XDCAD001,XDCAD002,XDCAD003:
                                 XDCAD004,XDCAD005:
                                 XDCAD006,XDCAD007,XDCAD008,XDCAD009,XDCAD010:
                                 XDCAD011,XDCAD012,XDCAD013,XDCAD014,XDCAD015:
                                 XDCAD016,XDCAD017,XDCAD018,XDCAD019,XDCAD020:
                                 XDCAD021,XDCAD022,XDCAD023,XDCAD024,XDCAD025:
                                 XDCAD026,XDCAD027,XDCAD028,XDCAD029,XDCAD030:
                                 XDCAD031,XDCAD032,XDCAD033,XDCAD034,XDCAD035:
                                 XDCAD036,XDCAD037,XDCAD038,XDCAD039,XDCAD040:
                                 XDCAD041,XDCAD042,XDCAD043,XDCAD044,XDCAD045:
                                 XDCAD046,XDCAD047,XDCAD048,XDCAD049,XDCAD050:
                                 XDCAD051,XDCAD052,XDCAD053,XDCAD054,XDCAD055:
                                 XDCAD056,XDCAD057,XDCAD058,XDCAD059,XDCAD060:
                                 XDCAD061,XDCAD062,XDCAD063,XDCAD064,XDCAD065:
                                 XDCAD066,XDCAD067,XDCAD068,XDCAD069,XDCAD070:
                                 XDCAD071,XDCAD072,XDCAD073,XDCAD074,XDCAD075:
                                 XDCAD076,XDCAD077,XDCAD078,XDCAD079,XDCAD080:
                                 XDCAD081,XDCAD082,XDCAD083,XDCAD084,XDCAD085:
                                 XDCAD086,XDCAD087,XDCAD088,XDCAD089,XDCAD090:
                                 XDCAD091,XDCAD092,XDCAD093,XDCAD094,XDCAD095:
                                 XDCAD096,XDCAD097,XDCAD098,XDCAD099:
                                 XPDCIFEC,XPDCIFPP,XPDCIFAJ
          ELSE
            WRITE     TEMP1G,SEQ;XSUBURBL,XHMECVNW;
            WRITE     TEMP1G,SEQ;XPRCGEND,XPRCIHI,XPRCIHIR,XPRCIHIN,XPRCEMRS
          ENDIF
.
          GOTO     WRIT9999
.WRIT8000  IF        DOYR2023 = 1
.            WRITE     TEMP1G,SEQ;XSUBURBL,XHMECVNW;
.            WRITE     TEMP1G,SEQ;XPRCGEND,XPRCIHI,XPRCIHIR,XPRCIHIN,XPRCEMRS
.          ELSE
.            WRITE     TEMP1G,SEQ;XSUBURBL,XHMECVNW
.          ENDIF       
.
.          GOTO     WRIT9999
.
WRIT9999  RETURN
+
.**************************************************************************
.*                               EADM0000              Called by: CORR0000*
.*                     Enter the admission number                         *
.**************************************************************************
.
EADM0000  MOVE      ZERO,CEXIT
          KEYIN     *P1:10,*EF,"Admission number  :",*V2LON,CADMNO
          RJUSTIFY  CADMNO
          MOVE      CADMNO,SAVADMN
.
          MATCH     SP70,CADMNO
          IF        @EQUAL
            MOVE      ONE,CEXIT
            GOTO      EADM9999
          ENDIF
.
          MATCH     ZEROVISN,CADMNO
          IF        @EQUAL
            MOVE      ONE,CEXIT
            GOTO      EADM9999
          ENDIF
.
          PACK      KEY8,CADMNO                  * Read the admission record
          CALL      RDMISS1                      * to find the UR Number
          BRANCH    OVRCD,EADM9000
.
          MATCH     SAVADMN,DAADMNO              * Same Admission ?
          GOTO      EADM9000 IF NOT EQUAL
.
          MOVE      AURNO,SAVURNO               * Save UR Number
          PACK      XURNO,SP2,AURNO 
          REP       " 0",XURNO
.
          GOTO      EADM9999
.
EADM9000  DISPLAY   *P1:24,*EL,*V2LON,"Missing Admission Record ",*HOFF;
          CALL      HITENTER
          MOVE      ONE,CEXIT
.
EADM9999  RETURN
.
+
.**************************************************************************
.*                               DELE0000              Called by: CORR0000*
.*                      Delete record from extract (Y/N)                  *
.**************************************************************************
.
DELE0000  MOVE      SP1,XDELIND
          KEYIN     *P1:12,*EF,"Delete Record Y/N :",*V2LON,DELIND
          REP       UPPLOW,DELIND
.
          MATCH     "Y",DELIND
          IF        @EQUAL
            MOVE      ONE,XDELIND
          ENDIF
.
          MATCH     "N",DELIND
          IF        @EQUAL
            MOVE      ZERO,XDELIND
          ENDIF
.
          MATCH     SP1,XDELIND
          GOTO      DELE0000 IF EQUAL
.
DELE9999  RETURN
+
.**************************************************************************
.*                               ITNO0000              Called by: CORR0000*
.*                        Enter the item number                           *
.**************************************************************************
.
ITNO0000  MOVE      ZERO,CEXIT 
          MOVE      ZERO,DITEMNUM
          MOVE      ZERO,CITEMNUM
          KEYIN     *P1:14,*EF,"Item number       :",*V2LON,DITEMNUM
.
.******************************************** start of moved code      *M-60344
          MATCH     QUEST,DITEMNUM
          IF        @EQUAL
            CALL      GETSCR00
            CALL      ITQU0000
            CALL      PUTSCR00
            DISPLAY   *P21:14,DITEMNUM
          ENDIF
.********************************************   end of moved code      *M-60344
.
          MOVE      DITEMNUM,CITEMNUM
.
          COMPARE   ZERO,CITEMNUM
          IF        @EQUAL
            MOVE      ONE,CEXIT
            GOTO      ITNO9999
          ELSE
            MOVE      TWO,CEXIT
          ENDIF
.******************************************** Code moved from here      D-60344
.
          PACK      KEY3,CITEMNUM
          CALL      RDPASAI1
          BRANCH    OVRCD,ITNO9000
.
          MOVE      CITEMNUM,XITEM
          SQUEEZE   XITEM
          MOVE      XITEM,XITEMNUM
          PACK      XITEMNMN,XITEM,SP70
          MOVE      PTIBANO,IBANUM 
          GOTO      ITNO9999
.
ITNO9000  DISPLAY   *P1:24,*V2LON,"Invalid Item Number ";
          CALL      HITENTER
          GOTO      ITNO0000
.
ITNO9999  RETURN
+
.**************************************************************************
.*                               ITQU0000              Called by: CORR0000*
.*                   Display available item numbers and description       *
.**************************************************************************
.
ITQU0000  MOVE      FIVE,CVERT
          DISPLAY   *P1:4,*EF:
                    *P30:4,*V2LON,"SA Item Numbers"
          PACK      KEY3,SP3
          CALL      RSPASAI2
ITQU1000  CALL      RKPASAI2
          BRANCH    OVRCD,ITQU9000
.
          DISPLAY   *P2:CVERT,*V2LON,PTSAINO:
                    *P6:CVERT,*HOFF,PTSADESC
          ADD       ONE,CVERT
          COMPARE   TWENTY3,CVERT
          IF        !@LESS
ITQU2000    KEYIN     *P1:24,"(",*V2LON,"N",*HOFF,")ext Screen":
                      *P15:24,"(",*V2LON,"C",*HOFF,")ontinue ",*V2LON,NEXCON
.
            REP       UPPLOW,NEXCON
            MATCH     "N",NEXCON
            IF        @EQUAL
              DISPLAY   *P1:5,*EF
              MOVE      FIVE,CVERT
              GOTO      ITQU1000
            ENDIF
.
            MATCH     "C",NEXCON
            IF        @EQUAL
              GOTO      ITQU9000
            ELSE
              GOTO      ITQU2000
            ENDIF
          ENDIF
.
          GOTO      ITQU1000
.
.
ITQU9000  KEYIN     *P1:24,*EL,"Item number : ",*V2LON,DITEMNUM
          MOVE      DITEMNUM,CITEMNUM
.
          MATCH     SP3,DITEMNUM
          GOTO      ITQU9000 IF EQUAL
.
          COMPARE   ZERO,CITEMNUM
          GOTO      ITQU9000 IF EQUAL
.
ITQU9999  RETURN
+
.******************************************** start of addition        *I-60344
.**************************************************************************
.*                               DSPL0000              Called by: ML3000  *
.*                   Display available item numbers and description       *
.**************************************************************************
.
DSPL0000  MOVE      SEVEN,CVERT
          DISPLAY   *P1:4,*EF:
                    *P30:4,*V2LON,"SA HDP Item Numbers":
                    *P1:6,"Item No.  IBA No.     Description";
.
          PACK      KEY3,SP3
          CALL      RSPASAI1
DSPL1000  CALL      RKPASAI1
          BRANCH    OVRCD,DSPL2000
.
          DISPLAY   *P3:CVERT,*V2LON,PTSAINO,*HOFF:
                    *P12:CVERT,PTIBANO:
                    *P21:CVERT,*HOFF,PTSADESC
          ADD       ONE,CVERT
.
          COMPARE   TWENTY3,CVERT
          IF        !@LESS
.           
DSPL2000    KEYIN     *P1:24,"(",*V2LON,"N",*HOFF,")ext,":
                      *P9:24,"(",*V2LON,"P",*HOFF,")revious,":
                      *P21:24,"e(",*V2LON,"X",*HOFF,")it : ",*V2LON,NEXCON
.
            REP       UPPLOW,NEXCON
            MATCH     "N",NEXCON            * Next
            IF        @EQUAL
              DISPLAY   *P1:7,*EF
              MOVE      SEVEN,CVERT
              GOTO      DSPL1000
            ENDIF
.
            ADD       TEN6,CVERT
            MATCH     "P",NEXCON            * Previous
            IF        @EQUAL
              REPEAT
                CALL      RPPASAI1
                BRANCH    OVRCD,DSPL2500
                SUB       ONE,CVERT
              UNTIL     CVERT < 8
DSPL2500      DISPLAY   *P1:7,*EF
              MOVE      SEVEN,CVERT
              GOTO      DSPL1000
            ENDIF
.
            MATCH     "X",NEXCON            * Exit     
            GOTO      DSPL9999 IF EQUAL
          ENDIF
.
          GOTO      DSPL1000
.
.
DSPL9999  RETURN
+
.**************************************************************************
.*                               ITEM0000              Called by: CORR0000*
.*                   Load the item that has been corrected                *
.**************************************************************************
.
ITEM0000  BRANCH    IBANUM,ITEM0010,ITEM0020,ITEM0030,ITEM0040:
                           ITEM0050,ITEM0060,ITEM0070,ITEM0080:
                           ITEM0090,ITEM0100,ITEM0110,ITEM0120: 
                           ITEM0130,ITEM0140,ITEM0150,ITEM0160: 
                           ITEM0170,ITEM0180,ITEM0190,ITEM0200: 
                           ITEM0210,ITEM0220,ITEM0230,ITEM0240: 
                           ITEM0250,ITEM0260,ITEM0270,ITEM0280: 
                           ITEM0290,ITEM0300,ITEM0310,ITEM0320: 
                           ITEM0330,ITEM0340,ITEM0350,ITEM0360: 
                           ITEM0370,ITEM0380,ITEM0390,ITEM0400: 
                           ITEM0410,ITEM0420,ITEM0430,ITEM0440: 
                           ITEM0450,ITEM0460,ITEM0470,ITEM0480: 
                           ITEM0490,ITEM0500,ITEM0510,ITEM0520: 
                           ITEM0530,ITEM0540,ITEM0550,ITEM0560: 
                           ITEM0570,ITEM0580,ITEM0590,ITEM0600: 
                           ITEM0610,ITEM0620,ITEM0630,ITEM0640: 
                           ITEM0650,ITEM0660,ITEM0670,ITEM0680: 
                           ITEM0690,ITEM0700,ITEM0710,ITEM0720: 
                           ITEM0730,ITEM0740,ITEM0750,ITEM0760: 
                           ITEM0770,ITEM0780,ITEM0790,ITEM0800: 
                           ITEM0810,ITEM0820,ITEM0830,ITEM0840: 
                           ITEM0850,ITEM0860,ITEM0870,ITEM0880: 
                           ITEM0890,ITEM0900,ITEM0910,ITEM0920: 
                           ITEM0930,ITEM0940,ITEM0950,ITEM0960:
                           ITEM0970,ITEM0980,ITEM0990,ITEM1000: 
                           ITEM1010,ITEM1020,ITEM1030,ITEM1040: 
                           ITEM1050,ITEM1060,ITEM1070,ITEM1080: 
                           ITEM1090,ITEM1100,ITEM1110,ITEM1120: 
                           ITEM1130,ITEM1140,ITEM1150,ITEM1160: 
                           ITEM1170,ITEM1180,ITEM1190,ITEM1200: 
                           ITEM1210,ITEM1220,ITEM1230,ITEM1240: 
                           ITEM1250,ITEM1260,ITEM1270,ITEM1280: 
                           ITEM1290,ITEM1300,ITEM1310,ITEM1320: 
                           ITEM1330,ITEM1340,ITEM1350,ITEM1360: 
                           ITEM1370,ITEM1380,ITEM1390,ITEM1400: 
                           ITEM1410,ITEM1420,ITEM1430,ITEM1440: 
                           ITEM1450,ITEM1460,ITEM1470,ITEM1480: 
                           ITEM1490,ITEM1500,ITEM1510,ITEM1520: 
                           ITEM1530,ITEM1540,ITEM1550,ITEM1560: 
                           ITEM1570,ITEM1580,ITEM1590,ITEM1600: 
                           ITEM1610,ITEM1620,ITEM1630,ITEM1640: 
                           ITEM1650
.
          GOTO      ITEM8000
.
ITEM0010  MOVE      XHOSCOD,XNEWINFO
          GOTO      ITEM9000
.
ITEM0020  MOVE      XCLINCOD,XNEWINFO
          GOTO      ITEM9000
.
ITEM0030  MOVE      XURNO,XNEWINFO
          GOTO      ITEM9000
.
ITEM0040  MOVE      XMEDI,XNEWINFO
          GOTO      ITEM9000
.
ITEM0050  MOVE      XSUBURB,XNEWINFO
          GOTO      ITEM9000
.
ITEM0060  MOVE      XPOSTCOD,XNEWINFO
          GOTO      ITEM9000
.
ITEM0070  MOVE      XLGA,XNEWINFO
          GOTO      ITEM9000
.
ITEM0080  MOVE      XSEX,XNEWINFO
          GOTO      ITEM9000
.
ITEM0090  MOVE      XPBDATE,XNEWINFO
          GOTO      ITEM9000
.
ITEM0100  MOVE      XCOUNTRY,XNEWINFO
          GOTO      ITEM9000
.
ITEM0110  MOVE      XADWGHT,XNEWINFO
          GOTO      ITEM9000
.
ITEM0120  MOVE      XMARSTAT,XNEWINFO
          GOTO      ITEM9000
.
ITEM0130  MOVE      XRACE,XNEWINFO
          GOTO      ITEM9000
.
ITEM0140  MOVE      XPACLSS,XNEWINFO
          GOTO      ITEM9000
.
ITEM0150  MOVE      XADMCAT,XNEWINFO
          GOTO      ITEM9000
.
ITEM0160  MOVE      XSASRCE,XNEWINFO
          GOTO      ITEM9000
.
ITEM0170  MOVE      XINSSTAT,XNEWINFO
          GOTO      ITEM9000
.
ITEM0180  MOVE      XHTRANFR,XNEWINFO
          GOTO      ITEM9000
.
ITEM0190  MOVE      XADELEC,XNEWINFO
          GOTO      ITEM9000
.
ITEM0200  MOVE      XATYPE,XNEWINFO
          GOTO      ITEM9000
.
ITEM0210  MOVE      XADATE,XNEWINFO
          GOTO      ITEM9000
.
ITEM0220  MOVE      XSTCHGE1,XNEWINFO
          GOTO      ITEM9000
.
ITEM0230  MOVE      XSTCHGA1,XNEWINFO
          GOTO      ITEM9000
.
ITEM0240  MOVE      XSTCHGD1,XNEWINFO
          GOTO      ITEM9000
.
ITEM0250  MOVE      XSTCHGE2,XNEWINFO
          GOTO      ITEM9000
.
ITEM0260  MOVE      XSTCHGA2,XNEWINFO
          GOTO      ITEM9000
.
ITEM0270  MOVE      XSTCHGD2,XNEWINFO
          GOTO      ITEM9000
.
ITEM0280  MOVE      XSTCHGE3,XNEWINFO
          GOTO      ITEM9000
.
ITEM0290  MOVE      XSTCHGA3,XNEWINFO
          GOTO      ITEM9000
.
ITEM0300  MOVE      XSTCHGD3,XNEWINFO
          GOTO      ITEM9000
.
ITEM0310  MOVE      XVETCARD,XNEWINFO
          GOTO      ITEM9000
.
ITEM0320  MOVE      XLEAVFD1,XNEWINFO
          GOTO      ITEM9000
.
ITEM0330  MOVE      XLEAVTD1,XNEWINFO
          GOTO      ITEM9000
.
ITEM0340  MOVE      XLEAVFD2,XNEWINFO
          GOTO      ITEM9000
.
ITEM0350  MOVE      XLEAVTD2,XNEWINFO
          GOTO      ITEM9000
.
ITEM0360  MOVE      XLEAVFD3,XNEWINFO
          GOTO      ITEM9000
.
ITEM0370  MOVE      XLEAVTD3,XNEWINFO
          GOTO      ITEM9000
.
ITEM0380  MOVE      XLEAVFD4,XNEWINFO
          GOTO      ITEM9000
.
ITEM0390  MOVE      XLEAVTD4,XNEWINFO
          GOTO      ITEM9000
.
ITEM0400  MOVE      XHICU,XNEWINFO
          GOTO      ITEM9000
.
ITEM0410  MOVE      XHMECVNW,XNEWINFO
          GOTO      ITEM9000
.
ITEM0420  MOVE      XNATSEP,XNEWINFO
          GOTO      ITEM9000
.
ITEM0430  MOVE      XSEPDATE,XNEWINFO
          GOTO      ITEM9000
.
ITEM0440  MOVE      XHTRANTO,XNEWINFO
          GOTO      ITEM9000
.
ITEM0450  MOVE      XPRICON,XNEWINFO
          GOTO      ITEM9000
.
ITEM0460  DISPLAY   *P1:24,"Additional Diagnosis"
          GOTO      ITEM9000
.
ITEM0470  MOVE      XEXTCAUS,XNEWINFO
          GOTO      ITEM9000
.
ITEM0480  DISPLAY   *P1:24,"Place of Occurence no longer used"
          GOTO      ITEM9000
.
ITEM0490  MOVE      XPPROCA,XNEWINFO
          GOTO      ITEM9000
.
ITEM0500  DISPLAY   *P1:24,"Additional Procedures"
          GOTO      ITEM9000
.
ITEM0510  MOVE      XEOC,XNEWINFO
          GOTO      ITEM9000
.
ITEM0520  GOTO      ITEM8000
.
ITEM0530  GOTO      ITEM8000
.
ITEM0540  GOTO      ITEM8000
.
ITEM0550  GOTO      ITEM8000
.
ITEM0560  GOTO      ITEM8000
.
ITEM0570  GOTO      ITEM8000
.
ITEM0580  GOTO      ITEM8000
.
ITEM0590  GOTO      ITEM8000
.
ITEM0600  GOTO      ITEM8000
.
ITEM0610  GOTO      ITEM8000
.
ITEM0620  GOTO      ITEM8000
.
ITEM0630  MOVE      XCPURNO,XNEWINFO
          GOTO      ITEM9000
.
ITEM0640  MOVE      XDACONPR,XNEWINFO
          GOTO      ITEM9000
.
ITEM0650  MOVE      XHOSPNUM,XNEWINFO
          GOTO      ITEM9000
.
ITEM0660  GOTO      ITEM8000
.
ITEM0670  MOVE      XADMTIME,XNEWINFO
          GOTO      ITEM9000
.
ITEM0680  MOVE      XADMNO,XNEWINFO
          GOTO      ITEM9000
.
ITEM0690  MOVE      XVETNUM,XNEWINFO
          GOTO      ITEM9000
.
ITEM0700  MOVE      XSEPTIME,XNEWINFO
          GOTO      ITEM9000
.
ITEM0710  MOVE      XLEGSTAT,XNEWINFO
          GOTO      ITEM9000
.
ITEM0720  MOVE      XREFFC,XNEWINFO
          GOTO      ITEM9000
.
ITEM0730  MOVE      XLEAVFT1,XNEWINFO
          GOTO      ITEM9000 
.
ITEM0740  MOVE      XLEAVTT1,XNEWINFO
          GOTO      ITEM9000
.
ITEM0750  MOVE      XLEAVFT2,XNEWINFO
          GOTO      ITEM9000
.
ITEM0760  MOVE      XLEAVTT2,XNEWINFO
          GOTO      ITEM9000
.
ITEM0770  MOVE      XLEAVFT3,XNEWINFO
          GOTO      ITEM9000
.
ITEM0780  MOVE      XLEAVTT3,XNEWINFO
          GOTO      ITEM9000
.
ITEM0790  MOVE      XLEAVFT4,XNEWINFO
          GOTO      ITEM9000
.
ITEM0800  MOVE      XLEAVTT4,XNEWINFO
          GOTO      ITEM9000
.
ITEM0810  GOTO      ITEM8000
.
ITEM0820  MOVE      XUNREAD,XNEWINFO
          GOTO      ITEM9000
.
ITEM0830  MOVE      XMHLV,XNEWINFO
          GOTO      ITEM9000
.
ITEM0840  MOVE      XOACISLV,XNEWINFO
          GOTO      ITEM9000
.
ITEM0850  DISPLAY   *P1:24,"Procedure Location Indicator"
          GOTO      ITEM9000
.
ITEM0860  MOVE      XADUCHI,XNEWINFO
          GOTO      ITEM9000
.
ITEM0870  MOVE      XPSYCAD,XNEWINFO
          GOTO      ITEM9000
.
ITEM0880  MOVE      XEMPSTAT,XNEWINFO
          GOTO      ITEM9000
.
ITEM0890  MOVE      XPENSTAT,XNEWINFO
          GOTO      ITEM9000
.
ITEM0900  MOVE      XUSUACC,XNEWINFO
          GOTO      ITEM9000
.
ITEM0910  MOVE      XDOBACC,XNEWINFO
          GOTO      ITEM9000
.
ITEM0920  GOTO      ITEM8000
.
ITEM0930  MOVE      XOTHCO1,XNEWINFO
          GOTO      ITEM9000
.
ITEM0940  MOVE      XOTHCO2,XNEWINFO
          GOTO      ITEM9000
.
ITEM0950  MOVE      XOTHCO3,XNEWINFO
          GOTO      ITEM9000
.
ITEM0960  MOVE      XOTHCO4,XNEWINFO
          GOTO      ITEM9000
.
ITEM0970  MOVE      XOTHCO5,XNEWINFO
          GOTO      ITEM9000
.
ITEM0980  MOVE      XOTHCO6,XNEWINFO
          GOTO      ITEM9000
.
ITEM0990  MOVE      XOTHCO7,XNEWINFO
          GOTO      ITEM9000
.
ITEM1000  MOVE      XOTHCO8,XNEWINFO
          GOTO      ITEM9000
.
ITEM1010  MOVE      XOTHCO9,XNEWINFO
          GOTO      ITEM9000
.
ITEM1020  MOVE      XOTHCO10,XNEWINFO
          GOTO      ITEM9000
.
ITEM1030  MOVE      XOTHCO11,XNEWINFO
          GOTO      ITEM9000
.
ITEM1040  MOVE      XOTHCO12,XNEWINFO
          GOTO      ITEM9000
.
ITEM1050  MOVE      XOTHCO13,XNEWINFO
          GOTO      ITEM9000
.
ITEM1060  MOVE      XOTHCO14,XNEWINFO
          GOTO      ITEM9000
.
ITEM1070  MOVE      XOTHCO15,XNEWINFO
          GOTO      ITEM9000
.
ITEM1080  MOVE      XOTHCO16,XNEWINFO
          GOTO      ITEM9000
.
ITEM1090  MOVE      XOTHCO17,XNEWINFO
          GOTO      ITEM9000
.
ITEM1100  MOVE      XOTHCO18,XNEWINFO
          GOTO      ITEM9000
.
ITEM1110  MOVE      XOTHCO19,XNEWINFO
          GOTO      ITEM9000
.
ITEM1120  MOVE      XOTHCO20,XNEWINFO
          GOTO      ITEM9000
.
ITEM1130  MOVE      XOTHCO21,XNEWINFO
          GOTO      ITEM9000
.
ITEM1140  MOVE      XOTHCO22,XNEWINFO
          GOTO      ITEM9000
.
ITEM1150  MOVE      XOTHCO23,XNEWINFO
          GOTO      ITEM9000
.
ITEM1160  MOVE      XOTHCO24,XNEWINFO
          GOTO      ITEM9000
.
ITEM1170  MOVE      XPROCB,XNEWINFO
          GOTO      ITEM9000
.
ITEM1180  MOVE      XPROCC,XNEWINFO
          GOTO      ITEM9000
.
ITEM1190  MOVE      XPROCD,XNEWINFO
          GOTO      ITEM9000
.
ITEM1200  MOVE      XPROCE,XNEWINFO
          GOTO      ITEM9000
.
ITEM1210  MOVE      XPROCF,XNEWINFO
          GOTO      ITEM9000
.
ITEM1220  MOVE      XPROCG,XNEWINFO
          GOTO      ITEM9000
.
ITEM1230  MOVE      XPROCH,XNEWINFO
          GOTO      ITEM9000
.
ITEM1240  MOVE      XPROCI,XNEWINFO
          GOTO      ITEM9000
.
ITEM1250  MOVE      XPROCJ,XNEWINFO
          GOTO      ITEM9000
.
ITEM1260  MOVE      XPROCK,XNEWINFO
          GOTO      ITEM9000
.
ITEM1270  MOVE      XPROCL,XNEWINFO
          GOTO      ITEM9000
.
ITEM1280  MOVE      XPROCM,XNEWINFO
          GOTO      ITEM9000
.
ITEM1290  MOVE      XPROCN,XNEWINFO
          GOTO      ITEM9000
.
ITEM1300  MOVE      XPROCO,XNEWINFO
          GOTO      ITEM9000
.
ITEM1310  MOVE      XPROCP,XNEWINFO
          GOTO      ITEM9000
.
ITEM1320  MOVE      XPROCQ,XNEWINFO
          GOTO      ITEM9000
.
ITEM1330  MOVE      XPROCR,XNEWINFO
          GOTO      ITEM9000
.
ITEM1340  MOVE      XPROCS,XNEWINFO
          GOTO      ITEM9000
.
ITEM1350  MOVE      XPROCT,XNEWINFO
          GOTO      ITEM9000
.
ITEM1360  MOVE      XPROCU,XNEWINFO
          GOTO      ITEM9000
.
ITEM1370  MOVE      XPROCV,XNEWINFO
          GOTO      ITEM9000
.
ITEM1380  MOVE      XPROCW,XNEWINFO
          GOTO      ITEM9000
.
ITEM1390  MOVE      XPROCX,XNEWINFO
          GOTO      ITEM9000
.
ITEM1400  MOVE      XPROCY,XNEWINFO
          GOTO      ITEM9000
.
ITEM1410  MOVE      XPPROCLA,XNEWINFO
          GOTO      ITEM9000
.
ITEM1420  MOVE      XPROCLB,XNEWINFO
          GOTO      ITEM9000
.
ITEM1430  MOVE      XPROCLC,XNEWINFO
          GOTO      ITEM9000
.
ITEM1440  MOVE      XPROCLD,XNEWINFO
          GOTO      ITEM9000
.
ITEM1450  MOVE      XPROCLE,XNEWINFO
          GOTO      ITEM9000
.
ITEM1460  MOVE      XPROCLF,XNEWINFO
          GOTO      ITEM9000
.
ITEM1470  MOVE      XPROCLG,XNEWINFO
          GOTO      ITEM9000
.
ITEM1480  MOVE      XPROCLH,XNEWINFO
          GOTO      ITEM9000
.
ITEM1490  MOVE      XPROCLI,XNEWINFO
          GOTO      ITEM9000
.
ITEM1500  MOVE      XPROCLJ,XNEWINFO
          GOTO      ITEM9000
.
ITEM1510  MOVE      XPROCLK,XNEWINFO
          GOTO      ITEM9000
.
ITEM1520  MOVE      XPROCLL,XNEWINFO
          GOTO      ITEM9000
.
ITEM1530  MOVE      XPROCLM,XNEWINFO
          GOTO      ITEM9000
.
ITEM1540  MOVE      XPROCLN,XNEWINFO
          GOTO      ITEM9000
.
ITEM1550  MOVE      XPROCLO,XNEWINFO
          GOTO      ITEM9000
.
ITEM1560  MOVE      XPROCLP,XNEWINFO
          GOTO      ITEM9000
.
ITEM1570  MOVE      XPROCLQ,XNEWINFO
          GOTO      ITEM9000
.
ITEM1580  MOVE      XPROCLR,XNEWINFO
          GOTO      ITEM9000
.
ITEM1590  MOVE      XPROCLS,XNEWINFO
          GOTO      ITEM9000
.
ITEM1600  MOVE      XPROCLT,XNEWINFO
          GOTO      ITEM9000
.
ITEM1610  MOVE      XPROCLU,XNEWINFO
          GOTO      ITEM9000
.
ITEM1620  MOVE      XPROCLV,XNEWINFO
          GOTO      ITEM9000
.
ITEM1630  MOVE      XPROCLW,XNEWINFO
          GOTO      ITEM9000
.
ITEM1640  MOVE      XPROCLX,XNEWINFO
          GOTO      ITEM9000
.
ITEM1650  MOVE      XPROCLY,XNEWINFO
          GOTO      ITEM9000
.
ITEM8000  DISPLAY   *P1:24,*V2LON,"Invalid Item";
          CALL      HITENTER
.
ITEM9000
.
ITEM9999  RETURN
+
.******************************************************************************
.*                                  KHOS0000       Called by:                 *
.*                For multi-hospital, get the hospital code                   *
.******************************************************************************
.
KHOS0000  COMPARE   ONE,IBCNMHOS                 * using multi-hospital ?
          GOTO      KHOS9999 IF NOT EQUAL        * no - finished
.
          DISPLAY   *P1:15,*EL,"Hospital Id               : ";
          MOVE      TWENTY9,ECOL
          MOVE      "15",EVERT
          MOVE      SP3,CKYIDEF3
          MOVE      ZERO,CKYIMAND                * Not Mandatory
.
          CALL      PATHSPKY                     * get code
          BRANCH    EXIT,KHOS2000:               * nothing input
                         KHOS9500                * exitchar input
          GOTO      KHOS3000
.
KHOS2000  MOVE      "All Hospitals",PTHSNAME
          MOVE      SP10,PTHSHOSP
          DISPLAY   *P29:15,*V2LON,PTHSNAME;
          MOVE      ZERO,EXIT
          GOTO      KHOS9999
.
KHOS3000  DISPLAY   *P37:15,PTHSNAME;
          GOTO      KHOS9999
.
KHOS9500  MOVE      ONE,EXIT
.
KHOS9999  RETURN
+
.**************************************************************************
.*                               WRIC0000              Called by: ML0000  *
.*                      Write the correction record                       *
.**************************************************************************
.
WRIC0000  SCAN      "PreJulyTest",REPTNAME
          IF        @EQUAL
            MATCH     "20250101",ADATE
          ELSE
            MATCH     "20250701",ADATE
          ENDIF
          IF       !@LESS
            MOVE     ONE,DOYR2025
          ENDIF
.
          IF        DOYR2025 = 1
            WRITE     TEMP2,SEQ;XRECTYP,XHOSCOD,XURNO,XSEPDATE,XSEPTIME:
                                        XDELIND,XITEMNMN,XNEWINFO,SP127:
                                        SP127,SP127,SP127,SP127,SP127:
                                        SP127,SP127,SP127,SP127,SP127:
                                        SP127,SP127,SP127,SP127,SP70:
                                        SP30,SP19
          ELSE
            WRITE     TEMP2,SEQ;XRECTYP,XHOSCOD,XURNO,XSEPDATE,XSEPTIME:
                                        XDELIND,XITEMNUM,XNEWINFO,SP127:
                                        SP127,SP127,SP127,SP30,SP25
          ENDIF
.
WRIC9999  RETURN
+
.**************************************************************************
.*                               READ0000              Called by: ML0000  *
.*                      Read  the correction record                       *
.**************************************************************************
.
READ0000  IF        DOYR2025 = 1
            READ      TEMP2,SEQ;XRECTYP,XHOSCOD,XURNO,XSEPDATE,XSEPTIME:
                                        XDELIND,XITEMNMN,XNEWINFO,SP127:
                                        SP127,SP127,SP127,SP127,SP127:
                                        SP127,SP127,SP127,SP127,SP127:
                                        SP127,SP127,SP127,SP127,SP70:
                                        SP30,SP19
          ELSE
            READ      TEMP2,SEQ;XRECTYP,XHOSCOD,XURNO,XSEPDATE,XSEPTIME:
                                        XDELIND,XITEMNUM,XNEWINFO,SP127:
                                      SP127,SP127,SP127,SP30,SP25
            GOTO      READ0000 IF NOT OVER
          ENDIF
.
READ9999  RETURN
+
. =========================================================================
.         I/O Includes
. =========================================================================
.
          INC       STD001IO
.
          INC       PATM10T9
          INC       NHOSPDAY
          INC       PATITMRD
          INC       SEXDSCIO
          INC       IBAPOSIO/INC
          INC       PMSCCDIO/INC
          INC       PATCMPIO/INC
          INC       PATCT1IO/INC
          INC       PATCODIO/INC
          INC       PATDADIO/INC
          INC       PATVADIO/INC
          INC       PATDSCIO/INC
          INC       PATECDIO/INC
          INC       PATECOIO/INC
          INC       PATHSPIO/INC
          INC       PATICUIO/INC
          INC       PATICDIO/INC
          INC       PATICOIO/INC
          INC       PATITMIO/INC            * MBS Item file            *I-60344
          INC       PATMA1IO/INC
          INC       PMSVX1IO/INC            * Visit Extension File 
          INC       PMSPX2IO/INC            * PMI Extension File
          INC       PATMI1IO/INC
          INC       PATSAIIO/INC
          INC       PATTRNIO/INC
          INC       PATVISIO/INC
          INC       PATWVEIO/INC
          INC       PATWR1IO/INC
.
          INC       PATHSPKY/PBL
          INC       GCCARD00/PBL
