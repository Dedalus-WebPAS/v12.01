.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.01.00"
.-------------------------------------------------------
. V9.04.01  19.04.2005 Peter Vela CAR 59696
.           Recompiled for SINTMPDF
. V9.03.01  10.09.2003 Steve Downing  (VF.11.01 CAR 9375)
.           Recompiled for SINREBFD & SINREBIO
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B01 15.11.2000 Charles Handaya
.           Modification of Warehouse Security
.-------------------------------------------------------
. VF.00.01  22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
.-------------------------------------------------------
SINTMPA1  IFILE SQL, FIXED=30, KEY="U1-8,9-15,16-20,21-21,22-28"
TMP1RAS   DIM       8         1
TMP1CAT   DIM       7         9
TMP1WAR   DIM       5        16
TMP1TYP   DIM       1        21
TMP1REQ   DIM       7        22
TMP1SPA   DIM       1        29
TOTALAMT  FORM      12.2
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN22
.   Function      :   Requisition Enquiries                   
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       SINCCAFD/INC
          INC       SINCIAFD/INC
          INC       SINCICFD/INC
          INC       SINCIEFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINNATFD/INC
          INC       SINREAFD/INC
          INC       SINREBFD/INC
          INC       SINTMPDF/INC
          INC       SINWARFD/INC
          INC       SINWSEFD/INC
.=========================
.Local Variable Definition
.-------------------------
REQTDESC  DIM      30 * Scr 00 Fld     3
REQDESC   DIM      12 * Scr 00 Fld    12
.
.    Multi Item Key Fields Scr 00 Fld    13
.-------------------------------------------------------
SIRB1NAM  INIT      "SIRB1"
SIRB1END  FORM      1   * End Display
SIRB1SNO  FORM      5   * Number of Items on the Screen
SIRB1MKY  DIM       127 * Match Key 
SIRB1EKY  DIM       127 * End Key
SIRB1SKY  DIM       127 * Start Key
SIRB1IDX  INIT      " 132 UC1-5"
SIRB1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIRB1FNM  DIM       8  * Filename
SIRB1CNT  FORM      3  * Number of Items on Screen
AVCOST    FORM     12.6 * Scr 01 Fld    14
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN22"
PRGNAM    INIT      "Requisition Enquiries                   "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      ONAT0000
          CALL      SC00L000
          CLOSE     SIRB1FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   24",AUDTSECT
          MOVE      "207",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudic";
            OPEN      SINAUDIC,"sinaudic"
          ENDIF
          MOVE      "   24",AUDTSECT
          MOVE      "208",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudie";
            OPEN      SINAUDIE,"sinaudie"
          ENDIF
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA1,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA2,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA2,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA3,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA1,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA2,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA3,"sincicaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA1,"sincieaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA2,"sincieaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA2,"sincodaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA1,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA2,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA3,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA4,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA1,"sinrebaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA2,"sinrebaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA3,"sinrebaf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA2,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA1,"sinwseaf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA2,"sinwseaf"
.--------------------------------------------------------
. Initialise Batch Screen Warehouse                          
.--------------------------------------------------------
          MOVE     ZERO,SIRB1SNO
          MOVE     "00   13",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIRB1SNO
            ENDIF
          ENDIF
          PACK      SIRB1FNM,ANST,SIRB1NAM,PORT
          REP       " 0",SIRB1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIRB1FL1,SIRB1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIRB1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIRB1FNM,SIRB1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIRB1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIRB1FL1,SIRB1FNM
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Requisition Enquiry Options        
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Requisition Detail Item            
          ENDIF
          RETURN
.--------------------------------
. Screen - Requisition Enquiry Options        
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Requisition Enquiry Options        
.-------------------------------------------------------
CF00L000
          MOVE      SP70,SIRATYP 
          MOVE      SP70,SIRAREQ 
          MOVE      SP70,REQTDESC
          MOVE      ZERO,SIRAIND 
          MOVE      SP70,SIRACST 
          MOVE      SP70,SIRADAT 
          MOVE      SP70,SIRADEL 
          MOVE      ZERO,SIRATOT 
          MOVE      SP70,SICADESC
          MOVE      SP70,SICATELE
          MOVE      SP70,SICACONT
          MOVE      SP70,REQDESC 
          MOVE      SP70,SIRBWAR 
          MOVE      SP70,SIRBCAT 
          MOVE      ZERO,SIRBRQT 
          MOVE      ZERO,SIRBIQT 
          MOVE      ZERO,SIRBAMT 
          MOVE      SP70,SIRBDAT 
          MOVE      SP70,SIIADES 
          MOVE      SP70,SIIAISS 
          MOVE      SP70,SIWADES 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Requisition Enquiry Options        
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,REQTDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EREQT000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      SIRATYP,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      REQTDESC,VAR     
            CALL      DISPITEM
          ENDIF
.
KY00L120
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,REQDESC 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EREQN000
          BRANCH    EXIT,KY00L110,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      SIRAREQ,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      REQDESC,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Requisition Enquiry Options        
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Requisition Enquiry Options        
.---------------------------------------------------------
LM00L000
.---------------------------------------------------------
. Load for :    13 Warehouse                          
.---------------------------------------------------------
          UNPACK    SP70,SIRBTYP,SIRBREQ,SIRBWAR,SIRBCAT
          PACK      KEY20,SIRATYP,SIRAREQ,SP70
          MOVE      KEY20,SIRB1EKY
          STRIP     SIRB1SKY
          SETLPTR   SIRB1EKY,8
          MOVE      SIRB1EKY,SIRB1SKY
          CALL      RDSIRB1 
          IF        OVRCD=0
            CALL      RPSIRB1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP00L000
          MOVE     ZERO,SIRB1CNT
          MOVE     ZERO,SIRB1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP00L600
          MATCH    PRGID,SCPSPID
          GOTO     DP00L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP00L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP00L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L101,DP00L102,DP00L103,DP00L104:
                            DP00L105,DP00L106,DP00L107,DP00L108:
                            DP00L109,DP00L010,DP00L010,DP00L010:
                            DP00L010,DP00L010,DP00L010,DP00L010:
                            DP00L010
          GOTO      DP00L010
.
DP00L101
          PACK      SIRB1MKY,SP70,SP70
          CALL      UPTSIRB1
          IF        SIRB1END=0
            CALL      RKSIRB1 
            IF        OVRCD=0
              PACK      SIRB1MKY,SIRBTYP,SIRBREQ,SIRBWAR,SIRBCAT                                                
              MATCH     SIRB1EKY,SIRB1MKY
              IF        @EQUAL
                MOVE      ZERO,SIRB1END
                ADD       ONE,SIRB1CNT
                CALL      UPTSIRB1
                MOVE      SIRBWAR,VAR      
                CALL      DISPITEM
          CALL      REDITM00
              ELSE
                MOVE      ONE,SIRB1END
              ENDIF
            ELSE
              MOVE      ONE,SIRB1END
            ENDIF
          ENDIF
          IF        SIRB1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L102
          IF        SIRB1END=0
            MOVE      SIRBCAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L103
          IF        SIRB1END=0
            MOVE      SIRBRQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L104
          IF        SIRB1END=0
            MOVE      SIRBIQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L105
          IF        SIRB1END=0
            MOVE      SIRBAMT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L106
          IF        SIRB1END=0
            MOVE      SIRBDAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L107
          IF        SIRB1END=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L108
          IF        SIRB1END=0
            MOVE      SIIAISS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
.
DP00L109
          IF        SIRB1END=0
            MOVE      SIWADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP00L010
DP00L600
          MATCH    "SIRB1",NAMSSFFI
          GOTO     DP00L605 IF NOT EQUAL
          GOTO     DP00L999
DP00L605
DP00L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP00L000
.
          MATCH    "SIRB1",NAMSSFFI
          GOTO     FP00L105 IF NOT EQUAL
          PACK     KEY20,SIRB1SKY,SP70
          CALL     RDSIRB1  * Start
          IF       OVRCD=0
            CALL     RPSIRB1  * Start
          ENDIF
          CALL     DP00L000
          GOTO     FP00L999
FP00L105
FP00L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP00L000
.
          MATCH    "SIRB1",NAMSSFFI
          GOTO     LP00L105 IF NOT EQUAL
          PACK     KEY20,SIRB1SKY,Z70
          CALL     RSSIRB1  * End
          IF       OVRCD=1
            CALL     RPSIRB1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIRB1SNO
            CALL     RPSIRB1 
            IF       OVRCD=1
              MOVE     SIRB1SNO,SECTOR
            ENDIF
            PACK     SIRB1MKY,SIRBTYP,SIRBREQ,SIRBWAR,SIRBCAT                                                
            MATCH    SIRB1EKY,SIRB1MKY
            IF       !@EQUAL
              MOVE     SIRB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP00L000
          GOTO     LP00L999
LP00L105
LP00L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP00L000
.
          MATCH    "SIRB1",NAMSSFFI
          GOTO     PP00L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP00L105
          CALL      RFTSIRB1
          BRANCH   OVRCD,PP00L115
          MOVE      SIRB1MKY,KEY20 
          CALL      RSSIRB1 
PP00L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIRB1SNO
            CALL     RPSIRB1 
            IF       OVRCD=1
              MOVE     SIRB1SNO,SECTOR
            ENDIF
            PACK     SIRB1MKY,SIRBTYP,SIRBREQ,SIRBWAR,SIRBCAT                                                
            MATCH    SIRB1EKY,SIRB1MKY
            IF       !@EQUAL
              MOVE     SIRB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP00L000
          GOTO     PP00L999
PP00L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIRB1SNO
            CALL     RKSIRB1 
            IF       OVRCD=1
              MOVE     SIRB1SNO,SECTOR
            ENDIF
            PACK     SIRB1MKY,SIRBTYP,SIRBREQ,SIRBWAR,SIRBCAT                                                
            MATCH    SIRB1EKY,SIRB1MKY
            IF       !@EQUAL
              MOVE     SIRB1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP00L999
PP00L120
PP00L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP00L000
          MATCH    "SIRB1",NAMSSFFI
          GOTO     NP00L115 IF NOT EQUAL
NP00L105
          CALL     RKSIRB1 
          BRANCH   OVRCD,NP00L110
          PACK     SIRB1MKY,SIRBTYP,SIRBREQ,SIRBWAR,SIRBCAT                                                
          MATCH    SIRB1EKY,SIRB1MKY
          GOTO     NP00L110 IF NOT EQUAL
          CALL     RPSIRB1 
          CALL     DP00L000
          GOTO     NP00L999
NP00L110
          CALL     RPSIRB1 
          BEEP
          GOTO     NP00L999
NP00L115
NP00L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT00L000
CT00L105
CT00L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Requisition Enquiry Options        
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    13 Warehouse                          
.---------------------------------------------------------
UPTSIRB1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIRB1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIRB1FL1,KEY5;SCPSROW,SCPSCOL,SIRB1MKY
          ELSE
            UPDATE    SIRB1FL1;SCPSROW,SCPSCOL,SIRB1MKY
          ENDIF
          RETURN
RDTSIRB1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIRB1FL1,KEY5;SCPSROW,SCPSCOL,SIRB1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIRB1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIRB1FL1,KEY5;;
          READKS    SIRB1FL1;SCPSROW,SCPSCOL,SIRB1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIRB1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Requisition Enquiry Options        
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
          MOVE      "SIRB1",NAMSSFFI
          MOVE      "   13",ITMSSFFI
          CALL      FP00L000
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Requisition Enquiry Options        
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L101,PS00L102:
                            PS00L103,PS00L104,PS00L105,PS00L106:
                            PS00L107,PS00L108,PS00L109,PS00L110:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      REQTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      SIRAIND,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      SIRACST,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          UNPACK    SIRADAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      SIRADEL,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      SIRATOT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      SICATELE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      SICACONT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      REQDESC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Requisition Enquiry Options        
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L101,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L102,SF00L103,SF00L104:
                            SF00L105,SF00L006,SF00L106,SF00L107:
                            SF00L108
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L101,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          MOVE      "SIRB1",NAMSSFFI
          MOVE      "   13",ITMSSFFI
          CALL      FP00L000
          GOTO     SF00L001
.
SF00L101
          CALL      SELECTED
          BRANCH    EXIT,SF00L001
          COMPARE   ONE,ACCEPT
          GOTO      SF00L001 IF EQUAL
          CALL      RDTSIRB1
          IF        OVRCD=1
            BEEP
            GOTO      SF00L001
          ENDIF
          MATCH     SP70,SIRB1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF00L001
          ENDIF
          MOVE      SIRB1MKY,KEY20 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELITM00
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIRB1
          IF        OVRCD=1
            CALL      FP00L000
          ELSE
            MOVE      SIRB1MKY,KEY20 
            CALL      RSSIRB1 
            CALL      RPSIRB1 
            CALL      DP00L000
          ENDIF
          GOTO     SF00L001
.
SF00L102
          MOVE      "SIRB1",NAMSSFFI
          MOVE      "   13",ITMSSFFI
          CALL      NP00L000
          GOTO     SF00L001
.
SF00L103
          MOVE      "SIRB1",NAMSSFFI
          MOVE      "   13",ITMSSFFI
          CALL      PP00L000
          GOTO     SF00L001
.
SF00L104
          MOVE      "SIRB1",NAMSSFFI
          MOVE      "   13",ITMSSFFI
          CALL      FP00L000
          GOTO     SF00L001
.
SF00L105
          MOVE      "SIRB1",NAMSSFFI
          MOVE      "   13",ITMSSFFI
          CALL      LP00L000
          GOTO     SF00L001
.
SF00L106
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L107
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L108
          CALL      PRNT0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Requisition Detail Item            
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Requisition Detail Item            
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Requisition Detail Item            
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Requisition Detail Item            
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Requisition Detail Item            
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Requisition Detail Item            
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Requisition Detail Item            
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L101,PS01L102,PS01L103,PS01L104:
                            PS01L105,PS01L106,PS01L107,PS01L108:
                            PS01L109,PS01L110,PS01L111,PS01L112:
                            PS01L113,PS01L114,PS01L999,PS01L999:
                            PS01L115,PS01L116,PS01L117
          GOTO     PS01L999
.
PS01L101
          MOVE      SIRBWAR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      SIRBCAT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      SIRBRQT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      SIRBIQT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      SIRBAMT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          UNPACK    SIRBDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      SIIANAT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      SIIAABC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      AVCOST,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      SIRBBCH,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      SIRBLED,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      SIRBACC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Requisition Detail Item            
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L101:
                            SF01L006,SF01L006,SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*143,HNONUSAG
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ONE,HNONUSAG
            WRITAB    CONTROLF,SIXTY3;*143,HNONUSAG
          ENDIF
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
REDITM00  MOVE     SIRBCAT,KEY7
          CALL     RDSIIA1
          MOVE     SIRBWAR,KEY5
          CALL     RDSIWA1
          RETURN
.
EREQT000  CALL      VCATRT00        * Verify Category Ok
          BRANCH    REQTSTAT,EREQT800,EREQT900
.
          CALL      REQTYP00
          BRANCH    EXIT,EREQT999,EREQT999
.
          MOVE      SICDDESC,REQTDESC
          GOTO      EREQT999
.
EREQT800  MOVE      ZERO,EXIT       * Only One Requisition Type
          GOTO      EREQT999
.
EREQT900  MOVE      "Requisition Type Codes Missing. (Cat. RT ) - ",DISPMSG
          CALL      MESSAGE1
          MOVE      TWO,EXIT
          GOTO      EREQT999
.
EREQT999  RETURN
.
VCATRT00  MOVE      "RT    ",KEY6
          CALL      RDSICD1
          BRANCH    OVRCD,VCATRT90
          CALL      RKSICD1
          BRANCH    OVRCD,VCATRT90
          MATCH     "RT ",SICDCATA
          GOTO      VCATRT90 IF NOT EQUAL
.
VCATRT10
          CALL      RKSICD1
          BRANCH    OVRCD,VCATRT80
          MATCH     "RT ",SICDCATA
          GOTO      VCATRT80 IF NOT EQUAL
          MATCH     "R  ",SICDCODE
          GOTO      VCATRT10 IF EQUAL
          MOVE      ZERO,REQTSTAT
          GOTO      VCATRT99
.
VCATRT80  CALL      RPSICD1
          MOVE      SICDCODE,SIRATYP
          MATCH     ANSR,SIRATYP         * Type "R" is Reserved for Returns
          GOTO      VCATRT90 IF EQUAL
          MOVE      SICDDESC,REQTDESC
          MOVE      ONE,REQTSTAT
          GOTO      VCATRT99
.
VCATRT90  MOVE      TWO,REQTSTAT   * Nothing Setup
          GOTO      VCATRT99
.
VCATRT99  RETURN
.
REQTYP00  KEYIN     *PCCOL:CVERT,*V2LON,*RV,*+,SIRATYP
          MOVE      SIRATYP,SICDCODE
          ENDSET    SICDCODE
          APPEND    SP70,SICDCODE
          RESET     SICDCODE
.
          MATCH     SP70,SICDCODE
          GOTO      REQTYP90 IF EQUAL
.
          CMATCH    EXITCHAR,SICDCODE
          GOTO      REQTYP95 IF EQUAL
.
          CMATCH    QUEST,SICDCODE
          GOTO      REQTYP10 IF NOT EQUAL
.
          MOVE      "RT ",SICDCATA
          MOVE      CCITEM,SCCITEM
          CALL      HSICDB00
          MOVE      SCCITEM,CCITEM
.
          ENDSET    SICDCODE
          APPEND    SP70,SICDCODE
          RESET     SICDCODE
.
          MATCH     SP70,SICDCODE
          GOTO      REQTYP00 IF EQUAL
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SICDCODE
REQTYP10
          MOVE      "RT ",SICDCATA
          PACK      KEY6,SICDCATA,SICDCODE
          CALL      RDSICD1
          BRANCH    OVRCD,REQTYP80
          MOVE      SICDCODE,SIRATYP
          MOVE      ZERO,EXIT
          GOTO      REQTYP99
.
REQTYP80  MOVE      "Requisition Type Does Not Exist - ",DISPMSG
          CALL      MESSAGE1
          GOTO      REQTYP00
REQTYP90  MOVE      ONE,EXIT
          GOTO      REQTYP99
REQTYP95  MOVE      TWO,EXIT
REQTYP99  RETURN
.
EREQN000  CALL      KSIRAA00
          BRANCH    EXIT,EREQN900,EREQN900
          MOVE      SIRACST,KEY5
          CALL      RDSICA1
          IF        SIRAIND=0
            MOVE      "Requisition",REQDESC
          ELSE
            MOVE      "Return     ",REQDESC
          ENDIF
          GOTO      EREQN999
.
EREQN900
          IF        REQTSTAT=0
            MOVE      ONE,EXIT
          ELSE
            MOVE      TWO,EXIT
          ENDIF
.
EREQN999  RETURN
.
SELITM00  MOVE      SIRB1MKY,KEY20
          CALL      RDSIRB1
          IF        OVRCD=1
            MOVE      "Invalid Selection - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      SELITM99
          ENDIF
.
. check warehouse security
.
          PACK      KEY9,PASSCODE,SIRBWAR,SP70
          CALL      RDSIWS1
          BRANCH    OVRCD,SELITM90
.
          MOVE      SIRBCAT,KEY7
          CALL      RDSIIA1
          MOVE      SIRBWAR,KEY5
          CALL      RDSIWA1
          ASSIGN    SIRBAMT/SIRBIQT,AVCOST
          CALL      SC01L000
          GOTO      SELITM99
.
SELITM90  CLEAR     DISPMSG
          APPEND    "You have no access for Warehouse ",DISPMSG
          APPEND    SIRBWAR,DISPMSG
          APPEND    " - ",DISPMSG
          CALL      MESSAGE1
          GOTO      SELITM99
.
SELITM99  RETURN
.
.------------------------------------------------------------
. Print Requisition
.------------------------------------------------------------
PRNT0000  CLEAR     KEY8
          APPEND    "SINTMP",KEY8
          APPEND    PORT,KEY8
          RESET     KEY8
          REP       " 0",KEY8
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SINTMPA1,KEY8
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SINTMPA1,DELETE
          ENDIF
          CLEAR     KEY80
          APPEND    "isbuild ",KEY80
          APPEND    KEY8,KEY80
          APPEND    " 30 uc1-8,9-15,16-20,21-21,22-28",KEY80
          RESET     KEY80
          EXECUTE   KEY80,TASKID
          OPEN      SINTMPA1,KEY8
          PACK      KEY20,SIRATYP,SIRAREQ
          CALL      RSSIRB1
PRNT1000  CALL      RKSIRB1
          BRANCH    OVRCD,PRNT1900
          MATCH     SIRATYP,SIRBTYP
          GOTO      PRNT1900 IF NOT EQUAL
          MATCH     SIRAREQ,SIRBREQ
          GOTO      PRNT1900 IF NOT EQUAL
.
          PACK      KEY12,SIRBCAT,SIRBWAR
          CALL      RDSIIE1
          BRANCH    OVRCD,PRNT1000
          PACK      KEY28,SIIERAS,SIRBCAT,SIRBWAR,SIRBTYP,SIRBREQ
          UNPACK    KEY28,TMP1RAS,TMP1CAT,TMP1WAR,TMP1TYP,TMP1REQ
          CALL      RDTMP1
          IF        OVRCD=1
            CALL      WRTMP1
          ENDIF
          GOTO      PRNT1000
.
PRNT1900  MOVE      "99",CLNO
          MOVE      "0",CPAGENO
          CLOCK     TIME,CTIMEIS
          PACK      KEY28,SP70
          CALL      RSTMP1
PRNT2000  CALL      RKTMP1
          BRANCH    OVRCD,PRNT9000
.
          PACK      KEY20,TMP1TYP,TMP1REQ,TMP1WAR,TMP1CAT
          CALL      RDSIRB1
          BRANCH    OVRCD,PRNT2000
.
          PACK      KEY7,TMP1CAT,SP70
          CALL      RDSIIA1
          BRANCH    OVRCD,PRNT2000
.
          PACK      KEY12,TMP1CAT,TMP1WAR
          CALL      RDSIIE1
          BRANCH    OVRCD,PRNT2000
.
          COMPARE   "55",CLNO
          CALL      HEAD0000 IF NOT LESS
.
          CALL      GETPNO00   * Get Part Number
.
          MOVE      "99,999,999.99",KEY13
          FEDIT     SIRBRQT,KEY13
          MATCH     "*",KEY13
          IF        @EQUAL
            MOVE      "9999999999.99",KEY13
            FEDIT     SIRBRQT,KEY13
          ENDIF
.
          MOVE      "9,999,999.99",KEY12
          FEDIT     SIRBIQT,KEY12
          MATCH     "*",KEY12
          IF        @EQUAL
            MOVE      "999999999.99",KEY12
            FEDIT     SIRBIQT,KEY12
          ENDIF
.
          MOVE      "999,999,999.99",KEY14
          FEDIT     SIRBAMT,KEY14
          MATCH     "*",KEY14
          IF        @EQUAL
            MOVE      "99999999999.99",KEY14
            FEDIT     SIRBAMT,KEY14
          ENDIF
.
          UNPACK    SIRADAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          PRINT     "|",TMP1RAS,"| ",TMP1CAT,SP1,SIIADES,"|",*95,"|":
                    *108,"| ",CPCDATE,*132,"|"
          PRINT     "|",*10,"|",*20,SIICPNO,KEY13,SP1,SIIAISS," | ",KEY12," | ":
                    *108,"| ",SIRBTYP,SIRBREQ,KEY14,"|"
          ADD       SIRBAMT,TOTALAMT
          GOTO      PRNT2000
.
PRNT9000  CALL      UND132
          MOVE      "999,999,999.99",KEY14
          FEDIT     TOTALAMT,KEY14
          MATCH     "*",KEY14
          IF        @EQUAL
            MOVE      "99999999999.99",KEY14
            FEDIT     TOTALAMT,KEY14
          ENDIF
.
          PRINT     *92,"| Total      : ",*118,KEY14,"|":
                    *N,*92,"*---------------------------------------*"
          PRINT     *50,"***** End of Report ******"
          CLOSE     SINTMPA1,DELETE
.
PRNT9999  RETURN
.------------------------------------------------------------
. Page Heading
.------------------------------------------------------------
HEAD0000  COMPARE   ZERO,CPAGENO
          CALL      UND132 IF NOT EQUAL
          MOVE      SP70,SIWADES
          PACK      KEY5,SIRBWAR,SP70
          CALL      RDSIWA1
.
          MOVE      SP70,SICADESC
          PACK      KEY5,SIRACST,SP70
          CALL      RDSICA1
.
          CALL      HEAD132
          ADD       "6",CLNO
          PRINT     *1,"Cost Centre       : ",SIRACST,SP2,SICADESC:
                    *N,"Warehouse         : ",SIRBWAR,SP2,SIWADES
.
          CALL      UND132
          PRINT     "|Rack &  | Catalog Description                      ":
                    "                           |    Issue Qty | Delivere":
                    "d  | Req'n Date            |"
          PRINT     "|Shelf   |         Supplier Part Number         Req'":
                    "n Quantity Issue Unit      |              | (If Diff":
                    "er)| Req'n No.   Total Cost|"
          CALL      UND132
          RETURN
.
RSTMP1    MOVE      ZERO,OVRCD
          READ      SINTMPA1,KEY28;;
          GOTO      OVERCOND IF OVER
          RETURN
.
RDTMP1    MOVE      ZERO,OVRCD
          READ      SINTMPA1,KEY28;TMP1RAS,TMP1CAT,TMP1WAR,TMP1TYP,TMP1REQ:
                                   TMP1SPA
          GOTO      OVERCOND IF OVER
          RETURN
.
RKTMP1    MOVE      ZERO,OVRCD
          READKS    SINTMPA1;TMP1RAS,TMP1CAT,TMP1WAR,TMP1TYP,TMP1REQ:
                             TMP1SPA
          GOTO      OVERCOND IF OVER
          RETURN
.
WRTMP1    WRITE     SINTMPA1,KEY28;TMP1RAS,TMP1CAT,TMP1WAR,TMP1TYP,TMP1REQ:
                                   TMP1SPA
          RETURN
.
.----------------------------------------------------------------
. Get the Part Number for a Catalog Item
.----------------------------------------------------------------
GETPNO00  MOVE      SP70,SIICPNO
          PACK      KEY27,SIIACAT,SIIAPSC,SP70
          CALL      RSSIIC1
          CALL      RKSIIC1
          BRANCH    OVRCD,GETPNO10
          PACK      KEY12,SIICCAT,SIICSUP
          MATCH     KEY12,KEY27
          GOTO      GETPNO99 IF EQUAL
.
GETPNO10  PACK      KEY27,SIIACAT,SP70
          CALL      RSSIIC1
          CALL      RKSIIC1
          BRANCH    OVRCD,GETPNO90
          MATCH     SIICCAT,SIIACAT
          GOTO      GETPNO99 IF EQUAL
GETPNO90  MOVE      SP70,SIICPNO
GETPNO99  RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       SINCCAIO/INC
          INC       SINCIAIO/INC
          INC       SINCICIO/INC
          INC       SINCIEIO/INC
          INC       SINCODIO/INC
          INC       SINCODKY    
          INC       SINNATIO/INC
          INC       SINREAIO/INC
          INC       SINREAKY    
          INC       SINREBIO/INC
          INC       SINWARIO/INC
          INC       SINWSEIO/INC
.
          INC       STDGENCD
.
