.****************************************************************************** 
.* System   : PATIENT MANAGEMENT                                              *
.* Program  : IBAPAT98                                                        *
.* Desc     : System Parameter Maintenance                                    *
.******************************************************************************
.* Date     : 16/10/1985                                                      *
.* Author   : Malcolm Hayse                                                   *
.* Function : This program maintains codes & flags in the control file.       *
.* Mods     :                                                                 *
.*       V12.00.02  02/07/2025  J.Tan          TSK 0955096                    *
.*                  Removed Alphanumeric visit number changes                 *
.*       V12.00.01  28/05/2025  J.Tan          TSK 0955096                    *
.*                  Added Alphanumeric visit number changes                   *
.*       V11.04.01  14/03/2024  J.Tan             TSK 0910994                 *
.*                  Moved PTCNCMAU PTCNCMDU - Adm/Dis UDF for Matrix to web   *
.*       V10.14.01  27/02/2018  J.Tan             TSK 0870576                 *
.*                  Moved PTCNQUOT(Next quote number for fees est.)from sector*
.*                  105 pos 85 to sector 95 pos 153 as per Fees Estimate prog.*
.*       V10.12.01  11/01/2018  J.Tan             TSK 0848146                 *
.*                  Added 'Use Claim Type' to CACCFEE (Accumulation for FI)   *
.*       V10.10.01  07/07/2017  Steve Armstrong   TSK 0841787                 *
.*                  Mods to use Cat D<1-5> instead of Cat U<1-5> when         *
.*                  displaying PTCNDSTT (KHS18030).                           *
.******************************************************************************
.*       V10.08.01  19/09/2016  Davin             TSK 0307316                 *
.*                  Moved codefinder parameter to web (IBA screen 16/field 17)*
.*       V10.06.01  29/05/2015  Ebon Clements     CAR 317094                  *
.*                  Removed Default Grouper Version from hospital screen 20   *
.*       V10.05.01  29/07/2014  Steve Armstrong   CAR 294204                  *
.*                  Added new SJOG Geelong label type (CTYPLAB = 27)          *
.******************************************************************************
.*       V10.04.03  17/06/2014  Steve Armstrong CAR 301639                    *
.*                  Added call to TFILENAM for FNAMPOST into start of program *
.*                  (from AUTOPCOD).                                          *
.*                  Moved call to TFILENAM for TEMPFILE into start of program.*
.*                  Recompiled for changes to AUTOPCOD & AUPCDVAR.            *
.*       V10.04.02  15/06/2014  Jill Parkinson  CAR 301639                    *
.*                  Moved TFILENAM to INIT0000                                *
.*       V10.04.01  24/04/2014  Jill Parkinson  CAR 292687                    *
.*                  Moved PT3BHOSP to web                                     *
.******************************************************************************
.*       V10.03.06  13/05/2013  Davin            CAR 284669 HDP 2013 DRG 7.0  *
.*                  Added DRG070 for DRG 7.0 in KHS20080                      *
.*                  Disable icd10/gouper version screen (hospital screen 28)  *
.*       V10.03.05  23/04/2013  Davin             CAR 284420  HDP 2013/2014   *
.*                  Added PTCNGDV8 ICD10 Ed.8 Go-live date  (Sec.110 Pos.69)  *
.*       V10.03.04  10/01/2013  J.Tan          CAR 271122                     *
.*                  Added new option for CFINAN=3-same Opt.2 for Transfer only*
.*       V10.03.03  31/12/2012 Patrick Adair   CAR 261630                     *
.*                  Removed port number from temp file name                   *
.*       V10.03.02  20/07/2012  Don Nguyen     CAR 264561                     *
.*                  Removed ability to set Hospital BPAY Identifier           *
.*       V10.03.01  28/02/2012  Mike Laming    CAR 267797 HDP 2012 DRG 6.2    *
.*                  Added PTCNU62G and PTCNC62C for DRG Ver 6.2 (Sect.10 152) *
.*       V10.01.05  21/04/2011  Jill Parkinson CAR 240721                     *
.*                  Moved CTYPEUR to WEB                                      *
.*       V10.01.04  09/03/2011  J.Tan         CAR 233267                      *
.*                  Mods CFINAN - display financial details for bed type only *
.*       V10.01.03  11/02/2011  Mike Laming   CAR 231176                      *
.*                  Add Cat."LS" to option for PTCNCSTA (M/H Legal Status)    *
.*       V10.01.02  21/12/2010  Mike Laming   CAR 233046                      *
.*                  Mods to Misc.Charges PATMCHFD - Key change, logic changes *
.*                  24/12/2010  J.Tan         CAR 233200                      *
.*                  Removed PTCNHCPB, PTCNIDES=2(Cross refrence daily/add.chr)*
.*       V10.01.01  04/11/2010 Jill Parkinson  CAR 233008                     *
.*                  Removed PTCNUUNA                                          *
.*       V10.00.02  30/04/2010  J.Tan     CAR 220887                          *
.*                  Mods checking for Active/Inactive of Misc.charge          *
.*       V10.00.01  01/04/2010  Mike Laming       CAR 219246  HDP 2010        *
.*                  Added PTCNGDV7 ICD10 Ed.7 Go-live date  (Sec.110 Pos.61)  *
.*        V9.12.03  19/02/2010  Steve Armstrong   CAR 216549                  *
.*                  Removed CTRKPG & CTRKPRT (no longer used)                 *
.*        V9.12.02  15/10/2009  Mike Laming      CAR 207222                   *
.*                  Mod "No Oper.Times in Morb" CMORBDTM to have value "2"    *
.*        V9.12.01  19/06/2009  Mike Laming      CAR 197814 HDP 2009 DRG 6.0  *
.*                  Added PTCNU60G and PTCNC60C for DRG Ver 6.0 (Sect.10 132) *
.*                  27/05/2009  Davin            CAR 203137                   *
.*                  Don't zero fill BPAY Hospital Identifier (ptcnhbid)       *
.*        V9.11.01  23/04/2008  J.Tan            CAR 170967                   *
.*                  Added ATB parameter for Healthscope                       *
.*        V9.10.02  16/09/2008  J.Tan            CAR 170967                   *
.*                  Changed DHCLAM1 variable definition for CACCFEE (FI Accum)*
.*        V9.10.01  29/04/2008  Mike Laming      CAR 167314                   *
.*                  Add 'MOVE SP8,ICDRDDTE' to fix I*C in RDPTICO1            *
.*        V9.09.02  20/03/2008  Mike Laming      CAR 163918   HDP 2008        *
.*                  Add PTCNGDV6 - ICD10 Ed.6 Go-live date - Hos.Screen 28    *
.*        V9.09.01  23/08/2007  Peter Vela       CAR Cabrini Health           *
.*                  Add new UR Number format CTYPEUR (NNNNNC)                 *
.*        V9.08.05  10/05/2007  J.Tan            CAR 140282                   *
.*                  Mods option for Using Other FMS (PTCNUFMS)                *
.*        V9.08.04  12/04/2007  Mike Laming      CAR 137125 HDP 2007 DRG 5.2  *
.*                  Added PTCNU52G and PTCNC52C for DRG Ver 5.2 (Sect.10 144) *
.*        V9.08.03  07/02/2007  Peter Vela       CAR sjog-vic                 *
.*                  Added ptcninvl=24 St. John of God 32                      *
.*                  29/03/2007  J.Tan            CAR 136149                   *
.*                  Mods to use default claim code for misc.item charging     *
.*        V9.08.02  03/11/2006  Mike Laming      CAR 103368                   *
.*                  Change PTCNUEDI descript to "Using HosClaims EDI Module"  *
.*                  03/11/2006  Davin            CAR 123200                   *
.*                  Allow 9.9 for ptcndgpv (hos screen 20)                    *
.*        V9.08.01  18/10/2006  Mike Laming      CAR 119915                   *
.*                  Add 4th option to Ind PTPCLRES - WorkCover Insur. Coy     *
.*        V9.07.02  16/08/2006  Ebon Clements    CAR 115299                   *
.*                  Fixed position of PTCNDWAW should be 216 not 215          *
.*        V9.07.01  05/07/2006  J.Tan            CAR 103365                   *
.*                  Added daily charge for John Hopkins                       *
.*                  06/07/2006  Davin S          CAR 104165                   *
.*                  Added care class (cat cc) to QLD banding (ptcnqldb)       *
.*        V9.06.01  04/05/2006  Mike Laming      CAR 105244   HDP 2006        *
.*                  Add PTCNGDV5 - ICD10 Ed.5 Go live date - Hos.Screen 28    *
.*        V9.05.01  07/03/2006  Mike Laming      CAR 97352                    *
.*                  Correct posting of Grouper 5.1 at UPHOS28                 *
.*        V9.04.12  25/11/2005  Davin S          CAR 64087                    *
.*                  Removed reference to PTCNSOLS                             *
.*        V9.04.11  12/10/2005  Steve Armstrong  CAR 64087                    *
.*                  Removed reference to PTCNMACH & PTCNSOCK.                 *
.*                  Added code to handle PTCNA44M.                            *
.*        V9.04.10  17/08/2005  Jill Habasque CAR 71704                       *
.*                  Fixed update of PTCNTIMC                                  *
.*        V9.04.09  21/07/2005  Steve Armstrong    CAR 65071                  *
.*                  Added PTCNMBRL - Mother/Baby relationship for HosClaims.  *
.*                  10/06/2005  Peter Vela    CAR 62569                       *
.*                  Modified PTCNSRVY to use PTMIUYN1 and PTMIUYN2            *
.*        V9.04.08  23/02/2005  Mike Laming   CAR 61562                       *
.*                  Added PTCNU51G and PTCNC51C for DRG Ver 5.1 (Sect.10 140) *
.*                  Move all DRG versions from Hos.Screen 21 to Hos.Screen 28 *
.*        V9.04.07  28/02/2005  Guomin Fu        CAR 58447                    *
.*                  Fixed option N-no default is not accepted for PTCNLCLM    *
.*        V9.04.06  13/12/2004  Henry Son        CAR 55406                    *
.*                  Added PTCNC41C, PTCNC42C,PTCNC50C                         *
.*                  for 3M encoder codes.                                     *
.*        V9.04.05  15/09/2004  Peter Vela        CAR 53150                   *
.*                  Added Census Report as an option for PRS/2 Report Code    *
.*                  Requests.                                                 *
.*        V9.04.04  16/11/2004  J.Tan   CAR 54768                             *
.*                  Changed invoice layout Anne Caudle to be Pendlebury       *
.*                  PTCNINVL=16 (Invoice layout = 25)                         *
.*        V9.04.03  08/11/2004  Mike Laming      CAR 54636                    *
.*                  Added CATVB to PTCNELPS in Hos Screen 24                  *
.*        V9.04.02  01/11/2004  Peter Vela    CAR 54520                       *
.*                  Added PTCNDFIN - Day facility Indicator                   *
.*        V9.04.01  20/09/2004  Jill Habasque CAR 50611                       *
.*                  Changed PTCNLCLM to allow N                               *
.*        V9.03.16  30/07/2004  Jill Habasque CAR 50611                       *
.*                  Added PTCNACCD - EOC or ACC for NMDS details              *
.*                  13/07/2004  Steve Armstrong   CAR 52367, 34707 & 48877    *
.*                  Added PTCNSOLS - Solicited Socket Alias                   *
.*                  Added PTCNDGHA - Broadcast Add Health Conc. Card          *
.*                  Added PTCNDGHD - Broadcast Delete Health Conc. Card       *
.*        V9.03.15  21/06/2004  Henry Son        CAR 49037                    *
.*                  Move GO-live dates to Hospital screens.                   *
.*        V9.03.14  31/05/2004  Peter Vela       CAR 49016                    *
.*                  PRS/2 2004 Stat Changes:                                  *
.*                  Added PTCNRTCN - Reporting Type for Trans Control and Rec *
.*                                   Reports                                  *
.*                  Added PTCNRTRQ - Reporting Type for Request Reports       *
.*                  Added PTCNPRS6 - Report Code for 6th Request              *
.*                  Added PTCNRNG6 - 6th PRS2 report code                     *
.*                  27/05/2004  Steve Armstrong  CAR 48778                    *
.*                  Added PTCNDGCP - Change Pre-admission broadcast           *
.*                  19/05/2004  Henry Son        CAR 49037                    *
.*                  Add ICD10 PTCNGDV4 V4 golive date.                        *
.*                  Add PTCNU50G for Grouper 5.0 CAR 39275                    *
.*        V9.03.13  25/05/2004  Jill Habasque    CAR 48414                    *
.*                  Removed PTCNSTGV - now in RSHWEB02                        *
.*        V9.03.12  03/05/2004  Guomin Fu        CAR 39616                    *
.*                  Add PTCNDWAW - Default Ward to Admitting Ward             *
.*                               0 - Exp.Post Op Ward                         *
.*                               1 - Expected Ward                            *
.*        V9.03.11  02/04/2004  Peter Vela       CAR 48227                    *
.*                  Added PTCNBPAY - Generate BPAY Customer Reference Number  *
.*                  Added PTCNHBID - Hospital BPAY Identifier                 *
.*        V9.03.10  15/03/2004  Steve Armstrong  HosClaims Phase 1 (48280)    *
.*                  Added PTCNHCCC, PTCNUEDI, PTCNEDIO, PTCNEDIH & PTCNORIG.  *
.*                  04/03/2004  Steve Armstrong  Product Integration          *
.*                  Added PTCNMACH, PTCNSOCK, PTCNA01M, PTNCA02M, PTCNA03M,   *
.*                  PTCNA08M, PTCNA11M, PTCNA12M, PTCNA13M, PTCNA14M,         *
.*                  PTCNA21M, PTCNA22M, PTCNA27M, PTCNA28M, PTCNA31M,         *
.*                  PTCNA34M for PAS-CIS Interface message parameters         *
.*        V9.03.09  12/02/2004  Henry Son        CAR 47385                    *
.*                  Added PTCNMBSF for checking if we allow more than         *
.*                  Six MBS Items.                                            *
.*        V9.03.08  21/01/2004  Ebon Clements   CAR 44720                     *
.*                  Removed PTCN40WD, as it was no longer required in V9.03   *
.*        V9.03.07  30/12/2003  Sylvek Litewka  CAR 44160                     *
.*                  Modified sections DISPHP0F and KHP0210 to use RDPTICO1    *
.*                  IO routine when reading ICD Procedures file.              *
.*        V9.03.06  06/11/2003  J.Tan   CAR   44160                           *
.*                  Added next credit note number                             *
.*        V9.03.05  17/09/2003  CAR 42453   Henry Son                         *
.*                  VIC DHS 2003 changes. Added Hospital and WIES report 13.  *
.*        V9.03.04  12/09/2003  Lina Vo         CAR 40497                     *
.*                  Changed index and read of patmchgf.                       *
.*        V9.03.03  10/09/2003  Jill Habasque   CAR 43142                     *
.*                  Fixed PTMORBDT                                            *
.*        V9.03.02  09/09/2003  Jill Habasque   CAR 43142                     *
.*                  Changed PTMORBDT to allow 2                               *
.*        V9.03.01  20/05/2003  Jill Habasque   (CAR 38102)                   *
.*                  Added PTCNACAS - Aged Care Assessment Service             *
.*        V9.02.31  04/04/2003  Steve Armstrong (CAR 13395) Merlin Interface  *
.*                  Mods for use of PTCNDMCC & PTCNDMJC.                      *
.*                  02/04/2003  Davin  CAR 23297                              *
.*                  Added PTCNNFPU - Using extra 3 fields for ADT83 (Y/N)     *
.*        V9.02.30  21/02/2003  Tonii (CAR 36455)                             *
.*                  Changed to not display the actual parameter value, just   *
.*                  the description, Hospital Screen 17, Option 17            *
.*                  10/02/2003 J.Tan    (SRF 20178)                           *
.*                  Added paramter for Last visit default all visit/inp.only  *
.*        V9.02.29  08/11/2002  J.Tan                                         *
.*                  Added parameters from r6.10 (hospital screen 25)          *
.*        V9.02.28  28/10/2002  Jill Habasque                                 *
.*                  Added option of not charging to CFEETYP                   *
.*        V9.02.27  10/10/2002  Pat Dirito       SRF 22695                    *
.*                  Made var HDP1=NZ instead of Unkown.                       *
.*        V9.02.26  23/09/2002  Davin            SRF 13395                    *
.*                  Added PTCNBNUM - auto batch number for misc. charges      *
.*        V9.02.25  02/09/02 Dean Cramer                                      *
.*                  Added option 2 for PTCNREPO in PRS/2 screen               *
.*                  Added PTCNINVL option 31 Calvary Cairns invoice layout    *
.*        V9.02.24  26/08/02 Jill Habasque SV90763                            *
.*                  Added PTCNSTGV - Using strict given name in soundex       *
.*        V9.02.23  31/07/02 J.Tan                                            *
.*                  Fixed PTCNCROL and PTCNCTYP                               *
.*        V9.02.22  15/07/02 J.Tan                                            *
.*                  Added PTCNCROL - default contract role to A or B for QLD  *
.*                  Added PTCNCTYP - default contract type for QLD            *
.*        V9.02.21  03/07/2002  Pat Dirito       SRF 19336                    * 
.*                  PTCNGDV3 was writing to incorrect pos.                    *
.*                  02/07/2002  Jill Habasque    SRF 18879                    *
.*                  Added PTCNCPAH - Write AH to current patient search       *
.*        V9.02.20  05/06/2002  Pat Dirito       SRF 18489                    *
.*                  Added PTCNGDV3 - Go live date for ICD10 version 3         *
.*        V9.02.19  21/05/2002  J.Tan                                         *
.*                  Added PTMBSINV - print theatre description on invoice     *
.*        V9.02.18  06/05/2002  J.Tan                                         *
.*                  Added PTSGCOPT - Suggested classification                 *
.*        V9.02.17  06/05/2002  J.Tan                                         *
.*                  Added PTCNPRCL                                            *
.*        V9.02.16  02/05/2002  Dean Cramer                                   *
.*                  Added Hospital Screen 24 - HCP/PHDB                       *
.*                  Added PTCNVETR, PTCNELPS, PTCNPPAL                        *
.*                  24/04/2002  J Habasque                                    *
.*                  Added PTCNTIMN - Time to run nutrition update             *
.*                  22/04/2002  J.Tan                                         *
.*                  Added PTCNTFEE - Using theatre fees file                  *
.*        V9.02.15  10/04/2002  Dean Cramer                                   *
.*                  Added Sector 109 - PTCNQUM1 & PTCNQUM2                    *
.*        V9.02.14  07/03/2002  Tonii St Vincent's                            *
.*                  Added PTCNNULB - Type of Nutrition Label being used       *
.*        V9.02.13  15/01/2002  Jill Habasque                                 *
.*                  Added PTCNIOEV                                            *
.*        V9.02.12  04/01/2002  Pat Dirito                                    *
.*                  Added PTCNICUT                                            *
.*        V9.02.11  13/12/2001  Jill Habasque                                 *
.*                  Added PTCNPRCC and PTCNTIMC                               *
.*        V9.02.10  06/12/2001  Tonii                                         *
.*                  Added PTCNCMXF in Hospital Screen 12                      *
.*        V9.02.09  28/11/2001  Davin                                         *
.*                  Fixed display - changed CPO to CPA on interface screen    *
.*        V9.02.08  20/11/2001  J.Tan                                         *
.*                  Changed CVIEWIP to view outstanding amount only           *
.*        V9.02.07  16/11/2001  Steve Armstrong                               *
.*                  Mods for PTCNDGPE                                         *
.*        V9.02.06  08/11/2001  Davin  (4.2 Grouper mods)                     *
.*                  Replaced PTCNUGRP with PTCNDGPV                           *
.*                  Added PTCNU31G, PTCNU41G & PTCNU42G                       *
.*                  Removed PTCNVOGU                                          *
.*        V9.02.05  26/10/2001  Greg Horvat                                   *
.*                  Changed the following parameters to have an extra option  *
.*                  to allow pmsvx1af variables to be selected                *
.*                  PNSWRACE, PTCNADMT, PTCNCRAY, PTCNCRTN, PTCNDSCI          *
.*        V9.02.04  28/09/2001  Pat Dirito                                    *
.*                  Added PTCNAUAT,PTCNWSPC,PTCNADB1,PTCNADB2,PTCNADB3        *
.*                        PTCNADB4,PTCNDFAN                                   *
.*        V9.02.03  27/09/2001  Mike Laming  RCH/SVHM                         *
.*                  1) Add a sub-menu to 'Interface Engine' Option 27 - Split *
.*                     into Broadcast Messages, and Solicitored Messages.     *
.*                  2) Add 3 new flags to Broadcast Messages - PTCNDGPA,      *
.*                     PTCNDGPO and PTCNDGPR                                  *
.*        V9.02.02  23/08/2001  Tonii                                         *
.*                  Added layout 26, for Royal Children's (CTYPLAB)           *
.*                  13/08/2001  Tonii                                         *
.*                  Added layout 25, for St Vincent's (CTYPLAB)               *
.*        V9.00.01  02/08/2001  Steve Armstrong     ACT PMI                   *
.*                  Added PTCNCCOD (ACT PMI Country code for Australia)       *
.*                  24/04/2001  Steve Armstrong                               *
.*                  Added PTCNACSA (ACT Sending Application) & PTCNAPID       *
.*                  (ACT Processing ID)                                       *
.******************************************************************************
.*        V5.10.B03 02/04/2001  Jill Habasque                                 *
.*                  Changed PTCNIDES to accept 2 - Cross Index                *
.*        V5.10.B02 26/03/2001  Steve Downing  SRF 9018                       *
.*                  Added PTCNDGET - delete Grouper and Encoder tempfiles     *
.*        V5.10.B01 25/03/2001  Glenn Saunders                                *
.*                  Remove access to PTCNSNDX and associated processing.      *
.******************************************************************************
.*        V5.09.B10 23/02/2001  Jill Habasque                                 *
.*                  Added PTCNCMYN and PTCNNWCM                               *
.*        V5.09.B09 23/01/2001  Tonii                                         *
.*                  Remcompiled for PATDASFD and PATDASIO changes             *
.*        V5.09.B08 18/01/2001  Steve Downing                                 *
.*                  Moved PTCNSRVY from Hosp Scr 20 to IBA scr PMI fields 2   *
.*        V5.09.B07 12/01/2001  Jill Habasque                                 *
.*                  Added PTCNQUOT - Next quote number for fees estimation    *
.*        V5.09.B06 08/01/2001  Dean Cramer                                   *
.*                  Include PTCNAMUI - Next ACT merge unique Id               *
.*        V5.09.B05 21/12/2000  Steve Downing                                 *
.*                  Recompiled due to version problem                         *
.*        V5.09.B04 21/12/2000  Steve Downing                                 *
.*                  Mods to use user def. fields P4-6 for CNSWLNG             *
.*        V5.09.B03 20/12/2000  Greg Horvat                                   *
.*                  Added PTCNWFAC - Which field for ACT country code         *
.*        V5.09.B02 14/12/2000  Ebon Clements  509 C/Mix Mods                 *
.*                  Added PTCNCMAU and PTCNCMDU user defined fields for       *
.*                  casemix matrix                                            *
.*        V5.09.B01 28/11/2000  Steve Downing                                 *
.*                  Added PTCNSRVY - Participate in survey, Hosp. Screen 20   *
.*        V5.09.B00 23/11/2000  Caleb Sharman  5.09 Mods                      *
.*                  Added PTCNPLFI                                            *
.*        V5.08.17  25/10/2000  Ebon Clements                                 *
.*                  Added PTCNMBSC - Load MBS items from ascii file           *
.*        V5.08.16  20/10/2000  Ebon Clements                                 *
.*                  Added PTCNUSQL,run SQL script option                      *
.*        V5.08.15  19/10/2000  Greg Horvat      SRF 5858                     *
.*                  Removed PTCNUMOR - IBA screen, Using files screen, no 5   *
.*        V5.08.14  20/10/2000  Ebon Clements                                 *
.*                  Added PTCNLPRO, load prosthetics isn IBAADT83             *
.*        V5.08.13  25/09/2000  Dean Cramer                                   *
.*                  Include option 11 System/Interface 2 details screen       *
.*                                    Using ACT Health Interfaces (Y/N)?      *
.*                  Include Hospital Controlled screen 22 State Base PMI      *
.*                  Include IBA Controlled screen 27 State Base PMI           *
.*        V5.08.12  31/08/2000  Steve Downing                                 *
.*                  Fixed display of MH Legal status (Hos screen 19)          *
.*        V5.08.11  16/08/2000  Caleb Sharman                                 *
.*                  Changed Health Fund variables to be 8 chars               *
.*        V5.08.10  28/07/2000  Steve Downing  SRF 4299                       *
.*                  Mods to have 6th option for PTCNCSTA                      *
.*        V5.08.09  24/07/2000  Jill Habasque                                 *
.*                  Fixed display of Board or Health fund description         *
.*        V5.08.08  18/07/2000  Greg Horvat                                   *
.*                  Changed audit X to be the EDI audit                       *
.*        V5.08.07  13/07/2000  Tonii  SRF 634562                             *
.*                  - Added PRS4DAT1 & PRS4DAT2 - date range for 4th report   *
.*                  - Added PRS5DAT1 & PRS5DAT2 - date range for 5th report   *
.*                  - Added PRSDESC6 - description for 6th option             *
.*                  - Added subroutines KHP0230, KHP0240, KHP0250 & KHP0260   *
.*                    for processing of reports 4 and 5                       *
.*                  - Made options for reports 4 & 5 selectable               *
.*        V5.08.06  06/07/2000  Greg Horvat                                   *
.*                  - Added PTCNBTHN - EDI batch no                           *
.*                  - Added PTCNAUED - AUS EDI extract directory              *
.*                  - Moved the parameter PTCNEDID to PTCNNZED                *
.*        V5.08.05  27/06/2000  Greg Horvat                                   *
.*                  Added PTCNGDV2 - Go live date for ICD10 version 2         *
.*        V5.08.04  16/06/2000  Greg Horvat      00/01 PRS2 Mods              *
.*                  Removed PTCNPVET - Sending Veterans Affairs Recs for PRS2 *
.*        V5.08.03  06/06/2000  Tonii                                         *
.*                  Changed from KEY10 to KEY14 for the health fund file      *
.*        V5.08.02  05/06/2000  Greg Horvat      00/01 PRS2 Mods              *
.*                  Removed PTCNWF1E - Use which file if 1 Episode PRS2       *
.*        V5.08.01  15/05/2000  J.Tan                                         *
.*                  Added PTCNINVB - Print invoice on Portrait/Landscape      *
.*        V5.08.B08 29/03/2000  J Habasque                                    *
.*                  Recompiled                                                *
.*        V5.08.B07 02/03/2000  Davin                                         *
.*                  Added PTCNPAIH & PTCNPAIT for user defined invoice        *
.*                  headers/tails                                             *
.*        V5.08.B06 15/02/2000  Steve Downing                                 *
.*                  Added PTCNAGST -GST code for admission                    *
.*        V5.08.B05 10/02/2000  Steve Armstrong   srf 637765                  *
.*                  Fixed CHCK0000 routine to use ccyy instead of yy to       *
.*                  to check if dates are > 2 years apart.                    *
.*        V5.08.B04 24/01/2000  J Habasque                                    *
.*                  Added PTCNDGST - default "Is GST applicable to this event"*
.*        V5.08.B03 07/01/2000  J Habasque  SRF 636725                        *
.*                  Changed PTCNPALC,PTCNUVTH,PTCNUREA to be U1-9             *
.*        V5.08.B02 17/01/2000  Davin                                         *
.*                  Mods to remove IBCNUGST - Moved to SYS98                   *
.*        V5.08.B01 08/01/2000  Steve Armstrong                               *
.*                  Mods to remove CSTRTYR - No longer required               *
.******************************************************************************
.*        V5.07.16  30/11/1999  Davin                                         *
.*                  Added PTCNUGRP - Using 3.1 grouper, 4.1 or mapping        *
.*        V5.07.15  25/11/1999  Jill Habasque SRF 634945                      *
.*                  Added PTCNPMIS - Print misc charge code on invoices       *
.*        V5.07.14  18/11/1999  Caleb Sharman  5.08 mods                      *
.*                  Mods to default health purchaser from PTCNHPCD            *
.*        V5.07.13  27/10/1999  J Habasque                                    *
.*                  Added PTCNRQDF - Default code for cat RQ in EOC01         *
.*        V5.07.12  06/10/1999  Steve Armstrong                               *
.*                  Added PTCNCPTH - G/L Control File Path                    *
.*                  Mods to KYND0000 to accept "2" and convert to "No"        *
.*        V5.07.11  22/09/1999  J Habasque                                    *
.*                  Added PTCNPSOS - Pension Status on Separation (ADT55)     *
.*        V5.07.10  22/09/1999  J Habasque                                    *
.*                  Added PTCNCSRL - Source of Referral for WAT62             *
.*        V5.07.09  21/07/1999  J.Tan                                         *
.*                  Added PTCNHCOD - new PRS2 hospital code                   *
.*        V5.07.08  12/07/1999  Andrew Peel SRF 633062                        *
.*                  Fixed keyin of PRS2 date ranges                           *
.*        V5.07.07  09/07/1999  Davin                                         *
.*                  Added - Hospital Screen 20                                *
.*                        - PTCNAFLG, PTCNCLNO (quote NZ1172 for INP08)       *
.*        V5.07.06  29/06/1999  Greg Horvat      99/00 PRS2 Mods              *
.*                  Added PTCNCRAY - Which UDF for carer availability         *
.*        V5.07.05  26/05/1999  J Habasque  SRF 631798                        *
.*                  Changed CNSWRACE to read from sector 88, PNSWRACE added   *
.*                  AUSR3-AUSR7                                               *
.*        V5.07.04  25/05/1999  J.Tan                                         *
.*                  Added parameters for HDP employment status,occupation etc.*
.*        V5.07.03  23/04/1999  Andrew Peel                                   *
.*                  Screen 19 Item 12/13 fixed for changing at MAINQST        *
.*        V5.07.02  09/04/1999  Davin                                         *
.*                  Added parameters for HFCF printing                        *
.*                  15/03/1999  J.Tan                                         *
.*                  Added parameters for casemix funding                      *
.*        V5.07.01  25/02/1999  Steve Armstrong                               *
.*                  Mods to remove reference to PTCNUNAK (remove GBmailer)    *
.*        V5.07.B05 05/02/1998  Greg Horvat      SRF 630029                   *
.*                  Put back PTCNEDRG - operation code to exlcude from grouper*
.*        V5.07.B04 23/12/1998  Steve Armstrong                               *
.*                  Mods to change "Datagate" to "Interface Engine"           *
.*        V5.07.B03 02/12/1998  Jim Stathopoulos                              *
.*                  Additional 507 Changes                                    *
.*        V5.07.B02 11/11/1998  Greg Horvat      SRF 628671                   *
.*                  Added PTCNDEBW - Don't display encoder interface birth wgt*
.*                  09/11/1998  Glenn Berry      5.07 changes                 *
.******************************************************************************
.*        V5.06.06  22/09/1998  Davin                                         *
.*                  Added PTCNEGLD - Encoder go-live date for ICD10           *
.*        V5.06.05  10/09/1998  Greg Horvat      SRF 627852                   *
.*                  Moved PTCNI10D to IBA controlled screen                   *
.*        V5.06.04  08/09/1998  Greg Horvat      SRF 627852                   *
.*                  Added PTCN1ATS - Allow 1st admin type to be statistical   *
.*        V5.06.03  31/08/1998  Greg Horvat      98/99 PRS2 Mods              *
.*                  Added PTCNCDSC - Collecting duration of stay in CCU &     *
.*                  removed the procedure exclusion code                      *
.*        V5.06.02  06/08/1998  Greg Horvat      98/99 PRS2 Mods              *
.*                  Added AUPCDVAR & AUTOPCOD - Automatic generation of the   *
.*                  postcode                                                  *
.*        V5.06.01  26/06/1998  Greg Horvat                                   *
.*                  Added PTCNVOGU - Version of grouper used                  *
.*                                                                            *
.*        V5.05.03  19/05/1998  Nick   506                                    *
.*                  Added PTCNI10D - go-live date for ICD10 codes and mapping *
.*        V5.05.02  19/03/1998  Davin  506                                    *
.*                  Added PTCNHADF - default Health Agency (cat HA)           *
.*        V5.05.01  04/08/1997  Steve Armstrong                               *
.*                  Added PTCNDGAL, PTCNDGDN & PTCNDGMW                       *
.******************************************************************************
.*        V5.04.22  04/08/1997  Steve Armstrong    505                        *
.*                  Mods for PTCNACCF                                         *
.*        V5.04.21  14/07/1997  Howellsy                                      *
.*                  Added West Wimmera Invoice Layout                         *
.*        V5.04.20  13/06/1997  Steve Armstrong    WHL AAE API Mods           *
.*                  Added PTCNDESI & PTCNDESO                                 *
.*        V5.04.19  03/06/97 ROD     SRF 620087                               *
.*                  added PTCNUFMS                                            *
.*        V5.04.18  14/05/97 J.Tan   SRF 619943                               *
.*                  Fixed displaying fields for PRS2 (send medicare & Census) *
.*        V5.04.17  13/05/97 J.Tan    SRF 619888                              *
.*                  Mods for NSW transmissions                                *
.*                  13/05/1997  Steve Armstrong   WHL                         *
.*                  Mods for Eltron Printer (PTCNPELT & PTCNIELT)             *
.*        V5.04.16  08/05/1997  Howellsy                                      *
.*                  Added PTCNBNOK - Default Baby NOK in IBAHOS73             *
.*        V5.04.15  07/05/1997  Howellsy                                      *
.*                  Added PTCNDDSD - Default Discharge Summary Diagnosis      *
.*        V5.04.14  06/05/1997  Howellsy                                      *
.*                  Added PTCNDDCD - Default Date for Coding Date             *
.*        V5.04.13  05/05/1997  Greg Horvat      SRF 619474                   *
.*                  Added 4 & 5 as valid options for PRS2 report codes        *
.*                  05/05/1997  Greg Horvat                                   *
.*                  Added PTCNHDPS - Hospital state for HDP extracts          *
.*                  05/05/1997  Greg Horvat                                   *
.*                  Put the IBA PRS2 screen back                              *
.*        V5.04.12  05/04/97 J.Tan   SRF 617785                               *
.*                  Added option to print receipt/chq on cash receipt audit   *
.*        V5.04.11  16/04/1997  Steve Armstrong                               *
.*                  Added PTCNDPSI, PTCNDPSO, PTCNDGPB, PTCNDASI, PTCNDASO,   *
.*                  PTCNDGAD, PTCNDGDS, PTCNDGTR & PTCNDGRG.                  *
.*        V5.04.10  14/04/1997  Paul Howells   RHA                            *
.*                  Added PTCNURHA                                            *
.*        V5.04.09  26/03/1996  Greg Horvat                                   *
.*                  Added PTCNBWMR                                            *
.*        V5.04.08  29/01/1996  Paul Howells                                  *
.*                  Added PTCNEEOC                                            *
.*        V5.04.07  09/12/1996  Howellsy         SRF 642398                   *
.*                  Removed PRS2 Screen.                                      *
.*        V5.04.06  30/08/1996  Paul Howells                                  *
.*                  Added PTCNUEOC, PTCNUACC, PTCNLMAN, PTCNLEDT, PTCNPACC    *
.*        V5.04.05  22/08/1996  Howellsy         SRF 641749                   *
.*                  Removed CHOS73LY, PTCNEXBD, PTCNCAMA                      *
.*        V5.04.04  15/07/1996  Greg Horvat      SRF 616143 <---- Nz don't    *
.*                  Added PTCNINVL 19 - MBF invoice layout  <---- want this   *
.*        V5.04.03  15/07/1996  Steve Armstrong  SRF 641467                   *
.*                  Mods for new label layout - CTYPLAB 24 (Mercy, Dunedin)   *
.*                  12/07/1996  Steve Armstrong  SRF 641749                   *
.*                  Mods to change lables to labels                           *
.*        V5.04.02  01/07/1996  Steve Armstrong  Quote 8678                   *
.*                  Added PTCNSTMT                                            *
.*        V5.04.01  18/06/1996  Greg Horvat      SRF 615716                   *
.*                  Added PTCNEAPD - Allocate principal disease code prefix   *
.*                  for the encoder                                           *
.*                                                                            *
.******************************************************************************
.
          INC       STDGENDF
          INC       STDKWSDF
          INC       AUPCDVAR/INC            * Auto postcode variables
.
          INC       FMSCHQFD/INC
          INC       FMSAMAFD/INC
          INC       FMSDISFD/INC
          INC       FMSLMAFD/INC     
          INC       FMSRESFD/INC 
.
          INC       IBACONFD/INC
          INC       IBAGSTFD/INC
          INC       IBASEQFD/INC                 * Sequential Numbers File
          INC       IBATMDFD/INC
          INC       IBATMHFD/INC
.
          INC       PATCODFD/INC
          INC       PATCONFD/INC
          INC       PATFN1FD/INC
          INC       PATHOSFD/INC
          INC       PATICOFD/INC
          INC       PATIN1FD/INC
          INC       PATIRNFD/INC
          INC       PATMCHFD/INC
          INC       MRTMOVFD/INC
          INC       RCPREGFD/INC
          INC       SCRFLDFD/INC
          INC       TFILEVAR/INC                 * Generate Temp File Name
          INC       WEBERRFD/INC                 * Web Server Error Logging
.
.         Work Variables
.
ACCDES0   INIT      "One Line                "
ACCDES1   INIT      "Two Lines - Add.and Daily"
ACASDESC  DIM       20
ACTPIDV   DIM       10
ACTPIDD   INIT      "Debugging "
ACTPIDP   INIT      "Production"
ACTPIDT   INIT      "Training  "
ADB1DESC  DIM       20
ADESC0    INIT      "Daily Chrge Desc."
ADESC1    INIT      "Additional Desc."
ACCTYPE   INIT      "           "      * account type
ACCTYPE1  INIT      "Income"
ACCTYPE2  INIT      "Expenditure"
ACCTYPE3  INIT      "Asset"
ACCTYPE4  INIT      "Liability"
ACCTYPE5  INIT      "Equity"
ACCTYPE6  INIT      "Total"
ACCTYPE7  INIT      "Heading"
ACCTYPE8  INIT      "Stat -Post"
ACCTYPE9  INIT      "Stat -Total"
ACTINTF   DIM       1
ADLGDESC  DIM       30
ADMCDESC  DIM       20
ADMDESC   DIM       23
ADMTYPE   INIT      "Admission Type"
ADTTDESC  DIM       20
AFLGDESC  DIM       25                      * description for accident flag
AGEFROM   DIM       3
AGEKEYIN  DIM       3
AGETO     DIM       3
AGETYPE   FORM      1                       * age type - 1=Day, 2=Month, 3=Year
AGSTDESC  DIM       30                      * GST code description
ANS15     DIM       4
ALRTDESC  DIM       20
ALRTONLY  INIT      "Alerts System Only"
ALRTWARN  INIT      "Alerts plus Warnings"
ASOURCE   INIT      "Admission field ASRCE         "
AUDFLAG   FORM      1
AUSERD0   INIT      "Adm User Def Field 0 'U0' "
AUSERD1   INIT      "Adm User Def Field 1 'U1' "
AUSERD2   INIT      "Adm User Def Field 2 'U2' "
AUSERD3   INIT      "Adm User Def Field 3 'U3' "
AUSERD4   INIT      "Adm User Def Field 4 'U4' "
AUSERD5   INIT      "Adm User Def Field 5 'U5' "
AUSERD6   INIT      "Adm User Def Field 6 'U6' "
AUSERD7   INIT      "Adm User Def Field 7 'U7' "
AUSERD8   INIT      "Adm User Def Field 8 'U8' "
AUSERD9   INIT      "Adm User Def Field 9 'U9' "
AUTO      INIT      "Automatic"
BABDDESC  DIM       30
BABDDSC0  INIT      "'Son of' or 'Daughter of'"
BABDDSC1  INIT      "'Baby of'"
BEDTYPE   INIT      "Bed Type"
BINPMH    INIT      "Inpatient/MH"
BNOKDES0  INIT      "Mother's NOK"
BNOKDES1  INIT      "Mother      "
BOXHDR    DIM       80
BRDDESC   INIT      "Board       "
CTRCTDES  DIM       4         * Default Contract Type description
CTYPE1    INIT      "B"
CTYPE2    INIT      "ABA"
CTYPE3    INIT      "AB"
CTYPE4    INIT      "(A)B"
CTYPE5    INIT      "BA"
CLNODESC  DIM       25                           * description for claim number
CSRLDESC  DIM       10
CTYPDESC  DIM       20
CACCTIND  FORM      "0" 
CARECLSS  INIT      "Care Class"
CATCC     INIT      "CC"
CATP      INIT      "P "
CATHP     INIT      "HP"
CATRQ     INIT      "RQ"
CATD1     INIT      "D1"
CATD2     INIT      "D2"
CATD3     INIT      "D3"
CATD4     INIT      "D4"
CATD5     INIT      "D5"
CATU1     INIT      "U1"
CATU2     INIT      "U2"
CATU3     INIT      "U3"
CATU4     INIT      "U4"
CATU5     INIT      "U5"
CATU6     INIT      "U6"
CATU7     INIT      "U7"
CATU8     INIT      "U8"
CATU9     INIT      "U9"
CATV1     INIT      "V1"
CATV2     INIT      "V2"
CATVB     INIT      "VB"                                               *I-54636
CSTAD1    INIT      "Dischrge UDF1 Cat.D1"
CSTAD2    INIT      "Dischrge UDF2 Cat.D2"
CSTAD3    INIT      "Dischrge UDF3 Cat.D3"
CSTAD4    INIT      "Dischrge UDF4 Cat.D4"
CSTAD5    INIT      "Dischrge UDF5 Cat.D5"
CSTACC    INIT      "Care Class    Cat.CC"
CSTALS    INIT      "MH Legal Stat Cat.LS"
CVIEW1    INIT      "Yes"
CVIEW2    INIT      "No"
CVIEW3    INIT      "Yes-O/S only"
ODATENON  INIT      "No Operation Date        "  * value = 1
ODATEEXS  INIT      "Oper.Date is Available   "  * value = 0
ODATEMAN  INIT      "Oper.Date is Mandatory   "  * value = 2
OTIMENON  INIT      "No Operation Times       "  * value = 1
OTIMEEXS  INIT      "Oper.Times are Available "  * value = 0
OTIMEMAN  INIT      "Oper.Times are Mandatory "  * value = 2
DATEDESC  DIM       25
TIMEDESC  DIM       25
.
CDATDATE  DIM       10
CENSDATE  DIM       10
CHEQDESD  DIM       30
CHEQDESP  DIM       30
CMDLINE   DIM       70
CODE      DIM       2
CODEA     INIT      "A "
CODEAC    INIT      "AC"
CODEBC    INIT      "BC"
CODEC     INIT      "C "
CODECB    INIT      "CB"
CODECC    INIT      "CC"
CODECL    INIT      "CL"
CODED     INIT      "D "
CODEDC    INIT      "DC"
CODEDD    INIT      "DD"
CODEDESC  DIM       20
CODEDP    INIT      "DP"
CODEFI    INIT      "FI"
CODEJ     INIT      "J "
CODEP     INIT      "P "
CODEPC    INIT      "PC"
CODES     INIT      "S "
CODESC    INIT      "SC"
CODET     INIT      "T "
CODEU1    INIT      "U1"
CODEU2    INIT      "U2"
CODEWR    INIT      "WR"
CODEW1    INIT      "W1"
CODEW2    INIT      "W2"
CODEW3    INIT      "W3"
CODEW4    INIT      "W4"
CODEX5    INIT      "X5"
CODEX6    INIT      "X6"
CODEX7    INIT      "X7"
CODEX8    INIT      "X8"
COL       FORM      2
CONTACT   DIM       18                 
CONTACT0  INIT      "Next of Kin      "
CONTACT1  INIT      "Emergency Contact"
CONTACT2  INIT      "Nearest Relative "
COUNT     FORM      4
CRAYDESC  DIM       20
CRRG01    INIT      "Barwon/South Western Reg. "
CRRG02    INIT      "Grampians Region          "
CRRG03    INIT      "Loddon Mallee Region      "
CRRG04    INIT      "Hume Region               "
CRRG05    INIT      "Gippsland Region          "
CRRG06    INIT      "Western Metropolitan Reg. "
CRRG07    INIT      "Northern Metropolitan Reg."
CRRG08    INIT      "Eastern Metropolitan Reg. "
CRRG09    INIT      "Southern Metropolitan Reg."
CRRG10    INIT      "Interstate/Overseas       "
CRRGDISP  DIM       28
CURMON    DIM       4
CURRDATE  DIM       8
DDRGSDY   DIM       10
DDRGMSO   DIM       10
DWARN     INIT      "Warn"
DDRG0     INIT      "Do nothing"
DDRG1     INIT      "Warn User "
DDRG2     INIT      "Stop User "
D33CHAR   INIT      "33 Chars"
D38CHAR   INIT      "38 Chars"
DACPS0    INIT      "Admission Level"
DACPS1    INIT      "Consultant Episode"
DADMOPT   DIM       16
DADMOPT0  INIT      "By Admission No."
DADMOPT1  INIT      "By U/R No.      "
DADMOPT2  INIT      "By Adm or U/R No"
DADMT     DIM       30
DANS      DIM       3
DANS0     DIM       3
DANS1     DIM       3
DANS10    DIM       10
DANS11    DIM       3
DANS12    DIM       3
DANS13    DIM       3
DANS14    DIM       3
DANS15    DIM       3
DANS16    DIM       3
DANS17    DIM       3
DANS18    DIM       3
DANS19    DIM       12
DANS2     DIM       3
DANS20    DIM       3
DANS21    DIM       3
DANS22    DIM       3
DANS23    DIM       3
DANS24    DIM       3
DANS25    DIM       3
DANS26    DIM       14
DANS28    DIM       3                                                  *I-39275
DANS29    DIM       20
DANS3     DIM       3
DANS4     DIM       3
DANS5     DIM       3
DANS6     DIM       3
DANS7     DIM       3
DANS8     DIM       3
DANS9     DIM       3
DATBLY    DIM       10
DATBLY0   INIT      "Normal    "
DATBLY1   INIT      "W.C.H.    "
DATBLY2   INIT      "Mercy     "
DATBLY3   INIT      "St.And(Ip)"
DATBLY4   INIT      "Mel.Clinic"
DATBLY5   INIT      "Healthscop"
DATCC     DIM       30
DBEDTYP   DIM       15
DBEDTYP1  INIT      "HDU"
DBILTM1   INIT      "Midnight"
DBILTM2   INIT      "Noon"
DBRDCUT   DIM       5
DCKMBS    DIM       20
DCKMBS0   INIT      "MBS Code Operations "
DCKMBS1   INIT      "ICD9(CM) Operations  "
DCLGDESC  DIM       30 
DCNDY     DIM       24
DCNDY0    INIT      "Reset on Adm Type Change"
DCNDY1    INIT      "Do not Reset Day Count  "
DCODEDP   DIM       20
DCODEDP1  DIM       20
DCPCONT   DIM       27
DCPCONT1  INIT      "Person Responsible for Bill"
DCPCONT2  INIT      "Alternate Person to Contact"
DCRTN     DIM       30
DDANS1     DIM       3
DDANS10    DIM       3
DDANS11    DIM       3
DDANS12    DIM       3
DDANS13    DIM       3
DDANS14    DIM       3
DDANS15    DIM       3
DDANS16    DIM       3
DDANS17    DIM       3
DDANS18    DIM       3
DDANS19    DIM       3
DDANS2     DIM       3
DDANS20    DIM       3
DDANS21    DIM       3
DDANS22    DIM       3
DDANS24    DIM       3
DDANS25    DIM       3
DDANS3     DIM       3
DDANS4     DIM       3
DDANS5     DIM       3
DDANS6     DIM       3
DDANS7     DIM       3
DDANS8     DIM       3
DDANS9     DIM       3
DDATE1    DIM       12
DDATE10   DIM       12
DDATE2    DIM       12
DDATE3    DIM       12
DDATE4    DIM       12
DDATE5    DIM       12
DDATE6    DIM       12
DDATE7    DIM       12
DDATE8    DIM       12
DDATE9    DIM       12
DDBDEF    DIM       15 
DDBILTM   DIM       8
DDESC1    DIM       25
DDESC10   DIM       25
DDESC11   DIM       30
DDESC12   DIM       30
DDESC13   DIM       25
DDESC14   DIM       25
DDESC15   DIM       25
DDESC16   DIM       25
DDESC17   DIM       25
DDESC18   DIM       25
DDESC19   DIM       25
DDESC2    DIM       25
DDESC20   DIM       25
DDESC3    DIM       25
DDESC4    DIM       25
DDESC5    DIM       25
DDESC6    DIM       25
DDESC7    DIM       25
DDESC8    DIM       25
DDESC9    DIM       25
DDEST     INIT      "DDEST"
DDESTCAT  INIT      "DDEST (DD)"
DDOCOP0   INIT      "Doctor"
DDOCOP1   INIT      "V.M.P."
DDOCOPS   DIM       6
DDODEF    DIM       20
DDSCI     DIM       20
DDSTA     DIM       3
DDSTAC    DIM       3
DDSTCC    DIM       3
DDSTCL    DIM       3
DDSTCS    DIM       3
DDSTDA    DIM       3
DDSTDC    DIM       3
DDSTDR    DIM       3
DDSTHF    DIM       3
DDSTP     DIM       3
DDSTRD    DIM       3
DDSTRR    DIM       3
DDSTST    DIM       3
DDSTT     DIM       3
DDTMIN    DIM       15
DDWBHB    DIM       22
DEEOC0    INIT      "AAE01 Only"             
DEEOC1    INIT      "AAE02 Only"
DEEOC2    INIT      "AAE01 & AAE02"
DEEOCDES  DIM       13
DELGDESC  DIM       30 
DEPTDESC  DIM       20
DERROR0   INIT      "No Errors "
DERROR1   INIT      "Errors Exist"
DES1PCDS  INIT      "Description Only"
DES2PCDS  INIT      "Code & Description"
DESC20A   DIM       20
DESC20B   DIM       20
DESC20C   DIM       20
DESC20D   DIM       20
DESC20E   DIM       20
DESCDLKR  DIM       20
DESCDOOP  DIM       25
DESCDTRF  DIM       20
DESCPALC  DIM       20
DESCRP83  DIM       10
DESCUDIN  DIM       20
DESCUREA  DIM       20
DESCUVTH  DIM       20
DFBANKDT  DIM       15
DFBANKPT  DIM       15
DFEETYP   DIM       8
DFEETYP0  INIT      "PATBFEE1"
DFEETYP1  INIT      "PATRATE1"
DFEETYP2  INIT      "PATNZRA1"
DFEETYP3  INIT      "PATWLRA1"
DFEETYP4  INIT      "PATBCHA1"
DFEETYP5  INIT      "NZPBFEA1-NZ Priv"
DFEETYP6  INIT      "PATSCFA1"
DFEETYP7  INIT      "Nursing Home"
DFEETYP8  INIT      "Not Charging"
DFEETYP9  INIT      "PATBFEE1-JH"
DGSTDESC  DIM       3
DGSTYN    DIM       1
DHCLAM    DIM       22
DHCLAM0   INIT      "Use Admission Type    "
DHCLAM1   INIT      "Use Ward/Claim        "
DHCLAM2   INIT      "Use Ward/Adm.Type     "
DHCLAM3   INIT      "Use Ward/Clm./Adm.Type"
DHCLAM4   INIT      "Use Ward/Adm.Type/Clm."
DHCLAM5   INIT      "Use Group Code/Item Code   "
DHCLAM6   INIT      "Use Clm ##/Group or Item ##"
DHCLAM7   INIT      "Use Journal Code           "
DHCLAM8   INIT      "Use Claim Code/Journal Code"
DHCLAM9   INIT      "Use Claim Code"
DHDTYPE   DIM       11 
DHDUTYP   INIT      "High Dependency "
DHGENR    DIM       35
DHGENR0   INIT      "No Automatic U/R Generation       "
DHGENR1   INIT      "Gen U/R ## at Admission time      "
DHGENR2   INIT      "Gen U/R ## at Pre-Admission time  "
DHIGHAMT  INIT      "Highest Amount"
DHIGHDES  DIM       15
DHIGHMBS  INIT      "Highest MBS   "
DHKANS1   DIM       3                        * HK Interface Field 1
DHKANS2   DIM       20                       * HK Interface Field 2
DHKANS3   FORM      4                        * HK Interface Field 3
DHKANS4   DIM       35                       * HK Interface Field 4
DHKANS5   DIM       8                        * HK Interface Field 5
DHKANS6   DIM       3                        * HK Interface Field 6
DHOSTYP   DIM       7
DHOSTYP0  INIT      "Private"
DHOSTYP1  INIT      "Public "
DHTYPE    DIM       20
DHTYPE1   INIT      "Diamond Valley      "
DHTYPE10  INIT      "Modbury Hospital    "
DHTYPE11  INIT      "Melbourne Clinic    "
DHTYPE12  INIT      "Wellington          "
DHTYPE13  INIT      "User Defined        "
DHTYPE14  INIT      "New Zealand         "
DHTYPE15  INIT      "Bundoora Ext'd Care "
DHTYPE16  INIT      "Anne Caudle Centre  "
DHTYPE17  INIT      "Hong Kong           "
DHTYPE18  INIT      "West Gippsland      "
DHTYPE19  INIT      "Monash Day Surgery  "
DHTYPE2   INIT      "A.H.R.              "
DHTYPE20  INIT      "Dudley              "
DHTYPE21  INIT      "Templated           "
DHTYPE22  INIT      "Hawkes Bay          "
DHTYPE23  INIT      "Mt Alvernia Hospital"
DHTYPE24  INIT      "Taranaki            "
DHTYPE25  INIT      "Port Macquarie      "
DHTYPE26  INIT      "Greenslopes         "
DHTYPE27  INIT      "St.Lukes            "
DHTYPE28  INIT      "Coast Health Care   "
DHTYPE29  INIT      "St.Vincents Bathurst"
DHTYPE3   INIT      "Epworth Hospital    "
DHTYPE30  INIT      "Mersey              "
DHTYPE31  INIT      "Mercy Dunedin       "
DHTYPE32  INIT      "M.B.F.              "
DHTYPE33  INIT      "West Wimmera Health "
DHTYPE34  INIT      "St Vincents Hospital"
DHTYPE35  INIT      "Royal Children's    "
DHTYPE36  INIT      "A.H.C               "
DHTYPE37  INIT      "Warburton Healt Care"
DHTYPE38  INIT      "Warburton           "
DHTYPE39  INIT      "Brisbane Waters     "
DHTYPE40  INIT      "Scottist            "
DHTYPE41  INIT      "Heidelberg Repat.   "
DHTYPE42  INIT      "Benchmark           "
DHTYPE43  INIT      "Lingard             "
DHTYPE44  INIT      "Mater               "
DHTYPE45  INIT      "Adel. Clinic        "
DHTYPE46  INIT      "Holy Spirit         "
DHTYPE47  INIT      "Greenslopes         "
DHTYPE48  INIT      "Peninsula           "
DHTYPE49  INIT      "Calvary Cairns      "
DHTYPE50  INIT      "Pendlebury          "
DHTYPE51  INIT      "John Hopkins        "
DHTYPE52  INIT      "NZ Private          "
DHTYPE53  INIT      "St. John of God     "
DHTYPE54  INIT      "SJOG Geelong        "

DHTYPE4   INIT      "Western Community   "
DHTYPE5   INIT      "Mercy Private       "
DHTYPE6   INIT      "St.Andrews Melbourne"
DHTYPE7   INIT      "St.Andrews Rocky    "
DHTYPE8   INIT      "H.O.A.              "
DHTYPE9   INIT      "St.Andrews War Mem. "
DHTYPEA   DIM       20
DIBED     DIM       21
DIBED0    INIT      "Don't Adjust Bed Stats"
DIBED1    INIT      "Adjust Bed Statistics"
DIBED2    INIT      "Ask At Closing Of Bed"
DICDC0    INIT      "ICD9-CM"
DICDC1    INIT      "ICD9"
DIM1A     DIM       1
DIM20     DIM       20
DIM22     DIM       22
DIM24     DIM       24
DIM25     DIM       25
DIM4A     DIM       4
DIM4B     DIM       4
DIM4C     DIM       4
DIM4D     DIM       4
DIM4E     DIM       4
DIM4F     DIM       4
DIM4G     DIM       4                                                   *I-49016
DIM16     DIM       16               * I CAR 39616
DISPSNDX  DIM       30
DISUSR1   INIT      "Disch Usr Def 1"
DISUSR2   INIT      "Disch Usr Def 2"
DISUSR3   INIT      "Disch Usr Def 3"
DISUSR4   INIT      "Disch Usr Def 4"
DISUSR5   INIT      "Disch Usr Def 5"
DJRNAL    DIM       34
DJRNAL1   INIT      "Use Keyin Date at time Input Jnl  "
DJRNAL2   INIT      "Use Current Date at time Input Jnl"
DLANGU    DIM       25
DLBCHAR   DIM       8
DLOCAT    DIM       26
DLOCAT1   INIT      "Address line 3 (PSUBRB)"
DLOCAT2   INIT      "Address line 2 (PATADD2)"
DLSIZE    DIM       30
DLSIZE1   INIT      "Small (37 Char Separation)  "
DLSIZE2   INIT      "Wide  (42 Char Separation)  "
DMBSOP0   INIT      "ICD9(CM) Operations  "
DMBSOP1   INIT      "MBS Code Operations "
DMBSOPR   DIM       20
DMICR0    INIT      "Don't Preserve Field"
DMICR1    INIT      "Preserve Old U/R's  "
DMICR2    INIT      "Preserve New U/R's  "
DMICRDES  DIM       24
DMRGNEW   INIT      "Save new UR Data on Merge"
DMRGOLD   INIT      "Save old UR Data on Merge"
DMUSE     DIM       35
DMUSE0    INIT      "Not In Use                         "
DMUSE1    INIT      "Copy from Invoice - No maintenance "
DMUSE2    INIT      "Copy from invoice - Maint. allowed "
DOCCP     INIT      "Occupation"
DOCLSIZ   DIM       30
DOFF      INIT      "Off"
DON       INIT      "On"
DOOP1     INIT      "All Charges"
DOOP2     INIT      "Theatre Fees Only"
DOTCC     DIM       30
DPCOND    DIM       11
DPCOND0   INIT      "Free Format"
DPCOND1   INIT      "Codes file "
DPIOPT    DIM       18
DPIOPT0   INIT      "None              "
DPIOPT1   INIT      "Patient receipting"
DPMS68I0  INIT      "Ward                  "
DPMS68I1  INIT      "Patient CLassification"
DPOSTCD   DIM       27
DPOSTCD0  INIT      "Using Australian Post Codes"
DPOSTCD1  INIT      "Using NZ Post Codes        "
DRACE     DIM       30
DREPT0    INIT      "Normal    "
DREPT1    INIT      "Wellington"
DRGDESC   DIM       15
DRGDESC1  INIT      "Australian"
DRGDESC2  INIT      "RUS"
DRG041    INIT      "041"
DRG042    INIT      "042"
DRG050    INIT      "050"
DRG051    INIT      "051"
DRG052    INIT      "052"                                             *I-137125
DRG060    INIT      "060"                                             *I-197814
DRG062    INIT      "062"                                             *I-267797
DRG070    INIT      "070"                                             *I-284669
DRG999    INIT      "999"
DRGD41    INIT      "4.1"
DRGD42    INIT      "4.2"
DRGD50    INIT      "5.0"
DRGD51    INIT      "5.1"
DRGD52    INIT      "5.2"                                             *I-137125
DRGD60    INIT      "6.0"                                             *I-197814
DRGD62    INIT      "6.2"                                             *I-267798
DRGD70    INIT      "7.0"                                             *I-284669
DRGD99    INIT      "9.9"
DRORC     DIM       7
DRORC0    INIT      "Receipt"
DRORC1    INIT      "Cheque "
DSC0RP83  INIT      "Normal"
DSC1RP83  INIT      "Taranaki"
DSEPMOD1  INIT      "DSTAT"
DSEPMOD2  INIT      "DDEST"
DSLGDESC  DIM       30 
DSPEC     INIT      "Spec Cond "
DSPEGLD   DIM       10
DSPGDV2   DIM       10
DSPGDV3   DIM       10
DSPGDV4   DIM       10                                                 *I-49037
DSPGDV5   DIM       10                                                *I-105244
DSPGDV6   DIM       10                                                *I-163918
DSPGDV7   DIM       10                                                *I-219246
DSPGDV8   DIM       10                                                *I-284420
DSTAT     INIT      "DSTAT"
DSTATCAT  INIT      "DSTAT (D )"
DSTTDESC  DIM       20
DSYST     DIM       10
DSYST0    INIT      "Priv. Aust"
DSYST1    INIT      "Modbury   "
DSYST2    INIT      "Wellington"
DTHCC     DIM       30
DTMIN1    INIT      "Final Invoice"
DTMIN2    INIT      "Temp. Invoice"
DURLINK0  INIT      "None        "
DURLINK1  INIT      "NMPI Number "
DURLINK2  INIT      "Hong Kong Id"
DURLINK3  INIT      "NHS Number  "
DURLINK4  INIT      "Singapore Id"
DURTYP0   INIT      "NNNNNNNN"
DURTYP1   INIT      " AAANNNC"
DURTYP2   INIT      "  AANNNN"
DURTYP3   INIT      " NNNNNNA"
DURTYP4   INIT      " NNNNNNC"
DURTYPE   DIM       8
DURVH590  INIT      "Check Valid U/R Format"
DURVH591  INIT      "Validate on patma1af  "
DUSERD1   INIT      "Discharge User Defined Field 1"
DUSERD2   INIT      "Discharge User Defined Field 2"
DUSERD3   INIT      "Discharge User Defined Field 3"
DUSERD4   INIT      "Discharge User Defined Field 4"
DUSERD5   INIT      "Discharge User Defined Field 5"
DWBED1    DIM       36 
DWBHB1    INIT      "Use Room Type (CAT RT)"
DWBHB2    INIT      "Use Bed Type (CAT BT)"
DPORTR    INIT      "Portrait  "
DLANDC    INIT      "Landscape "
DLANDR    INIT      "Lands.& RH"
DWAWDES0  INIT      "Exp.Post Op Ward"          * I CAR 39616
DWAWDES1  INIT      "Expected Ward"             * I CAR 39616
EOCACCD0  INIT      "From EOC Details"
EOCACCD1  INIT      "From ACC Details"
DEOCACC   DIM        16
.
ECDF0     INIT      "Next of Kin Details"
ECDF1     INIT      "Patient Details    "
EMPLDESC  DIM       20
ECDFDESC  INIT      "                   "
EDIADM    DIM       30
EDILIVE   INIT      "Live "
EDIMODE   DIM       5
EDIPMI    DIM       30
EDITEST   INIT      "Test "
ELPSCODE  DIM       2
ELPSDESC  DIM       20
ERROR0    INIT      "No errors   "               * for V5.83
ERROR1    INIT      "Errors exist"               * for V5.83
ERRORTYP  DIM       12                           * for V5.83
FIVE0     FORM      "50"                                                *I-49016
FIELD     FORM      2
FLAGITEM  DIM       2
FMSIBA    INIT      "Yes (IBA) "
FMSOTH    INIT      "Yes (Other) "
FMSAMA    INIT      "fmsamaaf"
FMSCHQ    INIT      "fmschqaf"
FMSDIS    INIT      "fmsdisaf"
FMSLMA    INIT      "fmslmaaf"
FMSRES    INIT      "fmsresaf"
FORM1A    FORM      1
FORM2A    FORM      2
FORM2B    FORM      2
FORM2C    FORM      2
FORM2D    FORM      2
FORM2E    FORM      2
FORM4B    FORM      4
FORM5     FORM      5
FORM6A    FORM      6
FORM6B    FORM      6
FORM6C    FORM      6
FORM6D    FORM      6
FORM8     FORM      8
FORM10    FORM      10
FORM101   FORM      "101"
FORM103   FORM      "103"
FORM118   FORM      "118"
FORM119   FORM      "119"
FPATH     DIM       40
FUNDDESC  DIM       20
GESTPER   DIM       30
GSTDESC   DIM       20
HDP0      INIT      "Not Aust"
HDP1      INIT      "NZ"
HDP2      INIT      "NSW"
HDP3      INIT      "VIC"
HDP4      INIT      "QLD"
HDP5      INIT      "SA"
HDP6      INIT      "WA"
HDP7      INIT      "TAS"
HDP8      INIT      "NT"
HDP9      INIT      "ACT"
HDTYPE1   INIT      "Standard"
HDTYPE2   INIT      "Nat I/C No."
HFDESC    INIT      "Health Fund "
HOMBAS    DIM       20
HPCDDESC  DIM       30
HSEMMETH  DIM       22
HSEMTYPA  INIT      "Discharge Date/Coding"
HUTTCN    DIM       30
I10DATE   DIM       10
ID1       INIT      "Search on item code"
ID2       INIT      "Search on item description"
IDDESC    DIM       30 
IDESCM    DIM       20
IDESCV    DIM       20
INDEX     FORM      2
JOURDES1  DIM       30
JOURDESC  DIM       30
KEY21A    DIM       21
KEY26A    DIM       26
KEYSEC    DIM       4
LADAAE01  DIM       26
LADDESC   DIM       26
LADDESC0  INIT      "Do Nothing                "
LADDESC1  INIT      "Ask Question              "
LADDESC2  INIT      "Load Details Automatically"
LADHOS31  DIM       26
LADOUT66  DIM       26
LADPAT01  DIM       26
LADWAT01  DIM       26
LNKEDATE  DIM       10
MELBCLIN  INIT      "Melb. Clinic"
MERGDESC  DIM       25
NADMNO    FORM      8
NONRESD   DIM       20
NORMAL    INIT      "Normal      "
OCBDAY    DIM       25
OCBDAY0   INIT      "Bed days in period      "
OCBDAY1   INIT      "Ward separation Bed days"
OCCPDESC  DIM       20
OIDAAE    DIM       20
OIDINP    DIM       20
OIDOUT    DIM       20
OPERDESC  DIM       17
OPTIONH   FORM      2
OPTIONI   FORM      2
OTHARED   DIM       20
OVRARED   DIM       20
PASS      DIM       8
PCCOL     FORM      3
PCONT     DIM       3
PEFR      DIM       25
PEFR0     INIT      "Print E.F.R. If Not Zero"
PEFR1     INIT      "Print If No Payment"
PEFR2     INIT      "Don't Print E.F.R."
PMIDESC   DIM       23
PMIMENT   INIT      "Mental Health only"
PMINONM   INIT      "Non-Mental Health only"
PMISDESC  DIM       3
PSQLDESC  DIM       3
PLFIDESC  DIM       3
PMISYN    DIM       1
PMSVX1VA  INIT      "pmsvx1af, Aboriginality (VA)"
PMSVX1VB  INIT      "pmsvx1af, Admin criteria (VB)"
PMSVX1VR  INIT      "pmsvx1af, Intent Readmit (VR)"
POS       FORM      2
PSQLYN    DIM       1
PPALDESC  DIM       20
PPPTDESC  DIM       20
PREVAGET  DIM       3
PREVTYPE  FORM      1
PRFADES0  INIT      "Ins.(TAC,VET)   "
PRFADES1  INIT      "Patient         "
PRFADES2  INIT      "prfa as prfa    "
PRFADES3  INIT      "Ins.(TAC,VET,WC)"
PRFADESC  DIM       12
PRS1DAT1  DIM       7
PRS1DAT2  DIM       7
PRS2DAT1  DIM       7
PRS2DAT2  DIM       7
PRS3DAT1  DIM       7                                                  *I-53150
PRS3DAT2  DIM       7                                                  *I-53150
PRS4DAT1  DIM       7
PRS4DAT2  DIM       7
PRS5DAT1  DIM       7
PRS5DAT2  DIM       7
PRS6DAT1  DIM       7                                                  *I-49016
PRS6DAT2  DIM       7                                                  *I-49016
PRS1DMY1  DIM       10                                                 *I-42453
PRS2DMY1  DIM       10                                                 *I-42453
PRS3DMY1  DIM       10                                                 *I-53150
PRS4DMY1  DIM       10                                                 *I-42453
PRS5DMY1  DIM       10                                                 *I-42453
PRS6DMY1  DIM       10                                                 *I-49016
PRSDAT6A  DIM       6
PRSDAT6B  DIM       6
PRSDESC1  INIT      "Diagnosis Outstanding Rep"
PRSDESC2  INIT      "Nil-value DRG Report"
PRSDESC3  INIT      "Census Report"                                    *I-53150
PRSDESC4  INIT      "Sub Acute Outstanding Rep"
PRSDESC5  INIT      "Hospital in the Home Rept"
PRSDESC6  INIT      "DRG-Based Simple Index"
PRSDES13  INIT      "Hospital Act & WIES Rep"                          *I-42453
PRS2DSC0  DIM       20                                                 *I-49016
PRS2DSC1  INIT      "Electronic Only"                                  *I-49016
PRS2DSC2  INIT      "Paper Only"                                       *I-49016
PRS2DSC3  INIT      "Electronic & Paper"                               *I-49016
PRS2DSC4  DIM       20                                                 *I-49016
PRSREP1   DIM       25
PRSREP2   DIM       25
PRSREP3   DIM       25                                                 *I-53150
PRSREP4   DIM       25
PRSREP5   DIM       25
PRSREP6   DIM       25                                                 *I-49016
PTCDKEY1  DIM       25
PUSERD0   INIT      "Not Used                      "
PUSERD1   INIT      "PMI User Defined Field 1      "
PUSERD2   INIT      "PMI User Defined Field 2      "
PUSERD3   INIT      "PMI User Defined Field 3      "
PUSERD4   INIT      "PMI User Defined Field 4      "
PUSERD5   INIT      "PMI User Defined Field 5      "
PUSERD6   INIT      "PMI User Defined Field 6      "
PUSRYND1  INIT      "ADM User Def Y/N Field 1      "
PUSRYND2  INIT      "ADM User Def Y/N Field 2      "
RCCNUPBR  FORM      1
REPFLAG   FORM      1
REPODES0  INIT      "Full transaction trail "
REPODES1  INIT      "Warning/Rejections only"
REPODES2  INIT      "Warning/Rejections at top"
REPODESC  DIM       25
RESDESC   DIM       20
RESPDESC  DIM       30
RFLDDESC  DIM       30
RQDFDESC  DIM       30
RSYST     DIM       10
RSYST0    INIT      "Normal    "
RSYST1    INIT      "Wellington"
SAVADMN   FORM      8
SAVRECP   FORM      12
SCANDES0  INIT      "Normal Format                    "
SCANDES1  INIT      "Include Medical Alerts and Cat CL"
SCANDESC  INIT      "                                 "
SCRPRGID  INIT      "PATMI1FD"                   * screen fields program i.d.
SCRPSCID  INIT      "01"                         * screen fields screen i.d.
SNDX0     INIT      "Surname only"
SNDX1     INIT      "Surname and Given Name"
SP12      INIT      "            "
SP14      INIT      "              "
SRVYDESC  DIM       30
TDESC1    DIM       20
TDESC2    DIM       20
TDESC3    DIM       20
TDESC4    DIM       20
TDESC5    DIM       20
TEMPCODE  DIM       8
TEMPDESC  DIM       30
TEMPINDX  INIT      " 39 U1-8 U9-38,1-8"
TEMPMONT  FORM      6
TEMPNAME  DIM       8
TEMPWEEK  FORM      6
TMPCFDS   DIM       3
TMPCDE    DIM       3[12]                        * store tempcodes
TMPCODE1  IFILE     SQL, FIXED=39, KEY="U1-8"
TMPCODE2  IFILE     SQL, FIXED=39, KEY="U9-38,1-8"
TMPDPFU   DIM       3
TMPDPID   DIM       3
TMPORDNO  FORM      10
UDATE     DIM       5
UKEY1     INIT      "Base 36                   "
UKEY2     INIT      "Episode & Adm No. - Type 1"
UKEY3     INIT      "Episode & Adm No. - Type 2"
UKEYDISP  DIM       26
URDESC    DIM       18
URDESC1   INIT      "With U/R"
URDESC2   INIT      "Without U/R"
VADM0     INIT      "None    "
VADM1     INIT      "NHS (UK)"
VADMDESC  INIT      "        "
VERT      FORM      2
VETRDESC  DIM       20
VHKID     DIM       8
VSDF0     INIT      "Include Event Number"
VSDF1     INIT      "Include Category A Description"
WARNONLY  INIT      "Warnings System Only"
WBED1     INIT      "Disp. smoker in ward/bed scan"
WBED2     INIT      "Disp. bed type in wd/bd scan"
XCENT1    DIM       2
XCENT3    DIM       2
XCENT4    DIM       2
XDAY1     DIM       2
XDAY3     DIM       2
XDAY4     DIM       2
XFORM2    FORM      2
XFORM6    FORM      6
XMON1     DIM       2
XMON2     DIM       2
XMON3     DIM       2
XMON4     DIM       2
XYEAR1    DIM       2
XYEAR2    DIM       2
XYEAR3    DIM       2
XYEAR4    DIM       2
.
PRGID     INIT      "IBAPAT98"
PRGNAM    INIT      "System Parameter Maintenance"
VERSION   INIT      "V12.01.00"
+
.*******************************************************************************
.*        START OF PROGRAM                                                     *
.*******************************************************************************
ML0000    CALL      DISPHEAD
.
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
.
          READ      CONTROLF,EIGHTY8;*59,PTCNI10D
          MATCH     "00000000",PTCNI10D
          IF        @EQUAL
            MOVE      "99991231",PTCNI10D
            WRITAB    CONTROLF,EIGHTY8;*59,PTCNI10D
          ELSE
            MATCH     PTCNI10D,SP8
            IF        @EQUAL
              MOVE      "99991231",PTCNI10D
              WRITAB    CONTROLF,EIGHTY8;*59,PTCNI10D
            ENDIF
          ENDIF
.
          READ      CONTROLF,NINTY8;*149,PTCNGDV2
          MATCH     "00000000",PTCNGDV2
          IF        @EQUAL
            MOVE      "99991231",PTCNGDV2
            WRITAB    CONTROLF,NINTY8;*149,PTCNGDV2
          ELSE
            MATCH     SP8,PTCNGDV2
            IF        @EQUAL
              MOVE      "99991231",PTCNGDV2
              WRITAB    CONTROLF,NINTY8;*149,PTCNGDV2
            ENDIF
          ENDIF
.
          READ      CONTROLF,HUND09;*151,PTCNGDV3
          MATCH     "00000000",PTCNGDV3
          IF        @EQUAL
            MOVE      "99991231",PTCNGDV3
            WRITAB    CONTROLF,HUND09;*151,PTCNGDV3
          ELSE
            MATCH     SP8,PTCNGDV3
            IF        @EQUAL
              MOVE      "99991231",PTCNGDV3
              WRITAB    CONTROLF,HUND09;*151,PTCNGDV3
            ENDIF
          ENDIF
.
          READ      CONTROLF,HUND05;*217,PTCNGDV4                      *I-49037
          MATCH     "00000000",PTCNGDV4
          IF        @EQUAL
            MOVE      "99991231",PTCNGDV4
            WRITAB    CONTROLF,HUND05;*217,PTCNGDV4
          ELSE
            MATCH     SP8,PTCNGDV4
            IF        @EQUAL
              MOVE      "99991231",PTCNGDV4
              WRITAB    CONTROLF,HUND05;*217,PTCNGDV4
            ENDIF
          ENDIF
.
          READ      CONTROLF,HUND05;*227,PTCNGDV5                     *I-105244
          REP       " 0",PTCNGDV5
          MATCH     "00000000",PTCNGDV5
          IF        @EQUAL
            MOVE      "99991231",PTCNGDV5
            WRITAB    CONTROLF,HUND05;*227,PTCNGDV5
          ENDIF
.
          READ      CONTROLF,HUND12;*239,PTCNGDV6                     *I-163918
          REP       " 0",PTCNGDV6
          MATCH     "00000000",PTCNGDV6
          IF        @EQUAL
            MOVE      "99991231",PTCNGDV6
            WRITAB    CONTROLF,HUND12;*239,PTCNGDV6
          ENDIF
.
          READ      CONTROLF,HUND10;*61,PTCNGDV7                      *I-219246
          UNPACK    PTCNGDV7,DIM4A,DIM4B
          MOVE      ZERO,FORM4
          MOVE      DIM4A,FORM4
          IF        FORM4 < 2000
            PACK      PTCNGDV7,SP10
          ENDIF
          REP       " 0",PTCNGDV7
          MATCH     "00000000",PTCNGDV7
          IF        @EQUAL
            MOVE      "99991231",PTCNGDV7
            WRITAB    CONTROLF,HUND10;*61,PTCNGDV7
          ENDIF
.
          READ      CONTROLF,HUND10;*69,PTCNGDV8                      *I-284420
          UNPACK    PTCNGDV8,DIM4A,DIM4B
          MOVE      ZERO,FORM4
          MOVE      DIM4A,FORM4
          IF        FORM4 < 2000
            PACK      PTCNGDV8,SP10
          ENDIF
          REP       " 0",PTCNGDV8
          MATCH     "00000000",PTCNGDV8
          IF        @EQUAL
            MOVE      "99991231",PTCNGDV8
            WRITAB    CONTROLF,HUND10;*69,PTCNGDV8
          ENDIF
.
          READ      CONTROLF,HUND30;*75,PTCNUANV      * Using AN Visit Numbers
.
          DISPLAY   *P64:24,"ibagstaf";
          OPEN      IBAGSTA1,"ibagstaf"
. 
          DISPLAY   *P64:24,"ibagstaf";
          OPEN      IBAGSTA2,"ibagstaf"
. 
          DISPLAY   *P64:24,"ibatmdaf";
          OPEN      IBATDET1,"ibatmdaf"
.
          DISPLAY   *P64:24,"ibatmhaf";
          OPEN      IBATMHA1,"ibatmhaf"
.
          DISPLAY   *P64:24,"patcodes";
          OPEN      PATCODE1,"patcodes"
.
          DISPLAY   *P64:24,"pathospf";
          OPEN      PATHOSP1,"pathospf"
          OPEN      PATHOSP2,"pathospf"
.
          DISPLAY   *P64:24,"paticdof";
          CALL      OPICO1
.
          DISPLAY   *P64:24,"patin1af";
          OPEN      PATIN1A1,"patin1af"
.
          DISPLAY   *P64:24,"patirnge";
          OPEN      PATIRNG1,"patirnge"
.
          DISPLAY   *P64:24,"patmchgf";
          OPEN      PATMCHG1,"patmchgf"
.
          DISPLAY   *P64:24,"patfn1af";
          OPEN      PATFN1A1,"patfn1af"
.
          DISPLAY   *P64:24,"scrfldaf";
          OPEN      SCRFLDA1,"scrfldaf"
.
          CALL      IBACLOCK
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
.
          CALL      TFILENAM                     * Generate temporary file name
          MOVE      TFILNAME,TEMPNAME
.
          CALL      TFILENAM                     * Generate temporary file name
          MOVE      TFILNAME,FNAMPOST
.
START     MOVE      ZERO,OVRCD
          READ      CONTROLF,TEN;*66,CINVLAY,*160,CMEDSERV
          READ      CONTROLF,TEN3;*245,CHOSTYP
.
          PACK      BOXHDR,SP30,SP30,SP30
.
. --- Display Main Menu ---
.
MAIN0000  MOVE      ZERO,REPFLAG            * havent entered security code
.
          HLINE     *G37,2,54,80
          DISPLAY   *P1:3,*EF:
                    *P2:4,*V2LON,ZERO,*HOFF," = Exit":
                    *P2:5,*V2LON,ONE,*HOFF," = Age Groups":
                    *P2:6,*V2LON,TWO,*HOFF," = Audit Groups":
                    *P2:7,*V2LON,THREE,*HOFF," = Hospital Controlled Screens":
                    *P2:8,*V2LON,FOUR,*HOFF," = IBA Controlled Screens"
.
MAIN1000  KEYIN     *P1:10,*EL,"Select Option : _",*P17:10,*V2LON,OPTION;
.
          IF        OPTION = 0
            GOTO      ENDIT                       * Exit program
          ENDIF
          IF        (OPTION<0) | (OPTION>4)
            BEEP                                  * Error in input
            GOTO      MAIN1000
          ENDIF
.
          IF        (OPTION=1) | (OPTION=2)
            BRANCH    OPTION,DOAGEGP,DOAUDGP      * Age Groups or Audit Groups
          ENDIF
.
. ------ Hospital Screens ------
.
SUBH0000  IF        OPTION=3
            HLINE     *G37,2,54,80
            DISPLAY  *P54:2,*V2LON,"- Hospital Screens ",*P1:3,*EF:
                     *P2:4,*V2LON,ZERO,*HOFF," = Exit": 
                     *P2:5,*V2LON,ONE,*HOFF:
                   " = Hospital Controlled Screen 1",*P2:6,*V2LON,TWO,*HOFF:
                   " =                     Screen 2",*P2:7,*V2LON,THREE,*HOFF:
                   " =                     Screen 3",*P2:8,*V2LON,FOUR,*HOFF:
                   " =                     Screen 4",*P2:9,*V2LON,FIVE,*HOFF:
                   " =                     Screen 5",*P2:10,*V2LON,SIX,*HOFF:
                   " =                     Screen 6",*P2:11,*V2LON,SEVEN,*HOFF:
                   " =                     Screen 7",*P2:12,*V2LON,EIGHT,*HOFF:
                   " =                     Screen 8",*P2:13,*V2LON,NINE,*HOFF:
                   " =                     Screen 9",*P1:14,*V2LON,TEN,*HOFF:
                   " =                     Screen 10",*P1:15,*V2LON,TEN1,*HOFF:
                   " =                     Screen 11",*P1:16,*V2LON,TEN2,*HOFF:
                   " =                     Screen 12",*P1:17,*V2LON,TEN3,*HOFF:
                   " =                     Screen 13",*P1:18,*V2LON,TEN4,*HOFF:
                   " =                     Screen 14",*P1:19,*V2LON,TEN5,*HOFF:
                   " =                     Screen 15",*P1:20,*V2LON,TEN6,*HOFF:
                   " =                     Screen 16",*P1:21,*V2LON,TEN7,*HOFF:
                   " =                     Screen 17",*P1:22,*V2LON,TEN8,*HOFF:
                   " =                     Screen 18",*P40:5,*V2LON,TEN9,*HOFF:
               " = Hospital Controlled Screen 19",*P40:6,*V2LON,TWENTY,*HOFF:
               " =                     Screen 20",*P40:7,*V2LON,TWENTY1,*HOFF:
               " =                     Screen 21",*P40:8,*V2LON,TWENTY2,*HOFF:
               " =                     PRS/2 Screen",*P40:9,*V2LON,TWENTY3:
                                          *HOFF:
               " =                     State Based PMI",*P40:10,*V2LON,TWENTY4:
                                          *HOFF:
               " =                     HDP/PHDB Screen":
               *P40:11,*V2LON,TWENTY5,*HOFF," =                     Screen 25":
               *P40:12,*V2LON,TWENTY6,*HOFF," =                     EDI Screen":
               *P40:13,*V2LON,TWENTY7,*HOFF," =                     PRS/2 Sc":                         "reen 2":
               *P40:14,*V2LON,TWENTY8,*HOFF," =                     ICD10 & ":
                       "DRG Vers";                                     *C-61562
.
SUBH1000      KEYIN     *P1:24,*EL,"Select Option : _",*P17:24,*V2LON,OPTIONH;
.
              IF        OPTIONH = 0
                GOTO      MAIN0000                    * Return to Main Menu
              ENDIF
.                                                                       *C-49016
              IF        (OPTIONH<0) | (OPTIONH>28)
                BEEP                                  * Error in input
                GOTO      SUBH1000
              ENDIF
.
            IF      (CINVLAY=1) & (CMEDSERV=1)
              BRANCH   OPTIONH,DOHSPC,DOHSPC2,DOHSPC3:
                              DOHSPC4,DOHSPC5,DOHSPC6,DOHSPC7,DOHSPC8:
                              DOHSPC9,DOHSPC10,DOHSPC11,DOHSPC12,DOHSPC13:
                              DOHSPC14,DOHSPC15,DOHSPC16,DOHSPC17,DOHSPC18:
                              DOHSPC19,DOHSPC20,DOHSPC21,DOHSPC22,DOHSPC23:
                              DOHSPC24,DOHSPC25,DOHSPC26,DOHSPC27:
                              DOHSPC28                                 *I-49037
            ELSE
              BRANCH   OPTIONH,DOHSPC,DOHSPC2,DOHSPC3:
                              DOHSPC4,DOHSPC5,DOHSPC6,DOHSPC7,DOHSPC8:
                              DOHSPC9,DOHSPC10,DOHSP11A,DOHSPC12,DOHSPC13:
                              DOHSPC14,DOHSPC15,DOHSPC16,DOHSPC17,DOHSPC18:
                              DOHSPC19,DOHSPC20,DOHSPC21,DOHSPC22,DOHSPC23:
                              DOHSPC24,DOHSPC25,DOHSPC26,DOHSPC27:      
                              DOHSPC28                                 *I-49037
            ENDIF
          ENDIF
.
. ------- IBA Screens -------
.
IBAS0000  CALL      IBASECUR                * Keyin IBA screen security passwd
          BRANCH    EXIT,START
.
          CALL      INIT0000
.
IBAS1000  CALL      IMEN0000
          BRANCH    EXIT,IBAS9999
.
          CALL      IOPT0000
          GOTO      IBAS1000
.
IBAS9999  CALL      KILL0000
          GOTO      START
.
.
.         Do the Age Group Screen
.
DOAGEGP   CALL      DISPAGE
          MOVE      ONE,OVRCD
.
.------ update the age group parameters ------
.
DOAGEGP1  CALL      UPAGE
          BRANCH    OVRCD,START
.
          CALL      CAGE0000                * check the age group parameters
          BRANCH    EXIT,DOAGEGP1
.
          CALL      WRAGE
.
          GOTO      START
.
.         Do the Audit Flags Screen
.
DOAUDGP   CALL      DISPAUD
          MOVE      ONE,OVRCD
          CALL      UPAUD
          BRANCH    OVRCD,START
          CALL      WRAUD
          GOTO      START
.
.         Do the Hospital Controlled Screen 1
.
DOHSPC    CALL      DSPHOS
          MOVE      ONE,OVRCD
          CALL      UPHOS
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS
          GOTO      SUBH0000
.
.         Do the Hospital Controlled Screen 2
.
DOHSPC2   CALL      DSPHOS2
          MOVE      ONE,OVRCD
          CALL      UPHOS2
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS2
          GOTO      SUBH0000
.
.         Do the Hospital Controlled Screen 3
.
DOHSPC3   CALL      DSPHOS3
          MOVE      ONE,OVRCD
          CALL      UPHOS3
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS3
          GOTO      SUBH0000
.
.         Do the Hospital Controlled Screen 4
.
DOHSPC4   CALL      DSPHOS4
          MOVE      ONE,OVRCD
          CALL      UPHOS4
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS4
          GOTO      SUBH0000
.
.         Do the Hospital Controlled Screen 5
.
DOHSPC5   CALL      DSPHOS5
          MOVE      ONE,OVRCD
          CALL      UPHOS5
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS5
          GOTO      SUBH0000
.
.         Do the Hospital Controlled Screen 6
.
DOHSPC6   CALL      DSPHOS6
          MOVE      ONE,OVRCD
          CALL      UPHOS6
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS6
          GOTO      SUBH0000
.
.         Do the Hospital Controlled Screen 7
.
DOHSPC7   CALL      DSPHOS7
          MOVE      ONE,OVRCD
          CALL      UPHOS7
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS7
          GOTO      SUBH0000
.
.         Do the Hospital Controlled Screen 8
.
DOHSPC8   CALL      DSPHOS8
          MOVE      ONE,OVRCD
          CALL      UPHOS8
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS8
          GOTO      SUBH0000
.
.         Do the Hospital Controlled Screen 9
.
DOHSPC9   CALL      DSPHOS9
          MOVE      ONE,OVRCD
          CALL      UPHOS9
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS9
          GOTO      SUBH0000
.
.         Do the Hospital Controlled Screen 10
.
DOHSPC10  CALL      DSPHOS10
          MOVE      ONE,OVRCD
          CALL      UPHOS10
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS10
          GOTO      SUBH0000
.
.         Do the Hospital Controlled Screen 11
.
DOHSPC11  CALL      DSPHOS11
          MOVE      ONE,OVRCD
          CALL      UPHOS11
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS11
          GOTO      SUBH0000
.
.         Do the Hospital Controlled Screen 11A (CMEDSERV = 0)
.
DOHSP11A  CALL      DSPHS11A
          MOVE      ONE,OVRCD
          CALL      UPHOS11A
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS11A
          GOTO      SUBH0000
.
.         Do the Hospital Controlled Screen 12
.
DOHSPC12  CALL      DSPHOS12
          MOVE      ONE,OVRCD
          CALL      UPHOS12
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS12
          GOTO      SUBH0000
.
.         Do the Hospital Controlled Screen 13
.
DOHSPC13  CALL      DSPHOS13
          MOVE      ONE,OVRCD
          CALL      UPHOS13
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS13
          GOTO      SUBH0000
.
.         Do the Hospital Controlled Screen 14
.
DOHSPC14  CALL      DSPHOS14
          MOVE      ONE,OVRCD
          CALL      UPHOS14
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS14
          GOTO      SUBH0000
.
.         Do the Hospital Controlled Screen 15
.
DOHSPC15  CALL      DSPHOS15
          MOVE      ONE,OVRCD
          CALL      UPHOS15
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS15
          GOTO      SUBH0000
.
.         Do the Hospital Controled Screen 16
.
DOHSPC16  CALL      DSPHOS16
          MOVE      ONE,OVRCD
DOHSP16A  CALL      UPHOS16
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS16
          BRANCH    EXIT,DOHSP16A
          GOTO      SUBH0000
.
.         Do the Hospital Controled Screen 17
.
DOHSPC17  CALL      DSPHOS17
          MOVE      ONE,OVRCD
DOHSP17A  CALL      UPHOS17
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS17
          GOTO      SUBH0000
.
.         Do the Hospital Controled Screen 18
.
DOHSPC18  CALL      DSPHOS18
          MOVE      ONE,OVRCD
DOHSP18A  CALL      UPHOS18
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS18
          GOTO      SUBH0000
.
.         Do the Hospital Controled Screen 19
.
DOHSPC19  CALL      DSPHOS19
          MOVE      ONE,OVRCD
DOHSP19A  CALL      UPHOS19
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS19
          GOTO      SUBH0000
.
.         Do the Hospital Controled Screen 20
.
DOHSPC20  CALL      DSPHOS20
          MOVE      ONE,OVRCD
DOHSP20A  CALL      UPHOS20
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS20
          GOTO      SUBH0000
.
.         Do the Hospital Controled Screen 21
.
DOHSPC21  CALL      DSPHOS21
          MOVE      ONE,OVRCD
DOHSP21A  CALL      UPHOS21
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS21
          GOTO      SUBH0000
.
.     Do the Hospital Controlled PRS/2 Screen 1
.
DOHSPC22  CALL      DSPHOS22
          MOVE      ONE,OVRCD
          CALL      UPHOS22
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS22
          GOTO      SUBH0000
.
.
.     Do the Hospital Controlled State Based PMI Screen
.
DOHSPC23  CALL      DSPHOS23
          MOVE      ONE,OVRCD
          CALL      UPHOS23 
          BRANCH    EXIT,SUBH0000
          CALL      WRHOS23 
          GOTO      SUBH0000
.
.
.     Do the Hospital Controlled HDP/PHDB                 
.
DOHSPC24  CALL      DSPHOS24
          MOVE      ONE,OVRCD
          CALL      UPHOS24 
          BRANCH    EXIT,SUBH0000
          CALL      WRHOS24 
          GOTO      SUBH0000
.
.     Do the Hospital Screen 25
.
DOHSPC25  CALL      DSPHOS25
          MOVE      ONE,OVRCD
          CALL      UPHOS25 
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS25 
          GOTO      SUBH0000
.
.     Do the Hospital EDI Screen
.
DOHSPC26  CALL      DSPHOS26
          MOVE      ONE,OVRCD
          CALL      UPHOS26 
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS26 
          GOTO      SUBH0000
.
.     Do the Hospital Controlled PRS/2 Screen 2                         *I-49016
.
DOHSPC27  CALL      DSPHOS27
          MOVE      ONE,OVRCD
          CALL      UPHOS27
          BRANCH    OVRCD,SUBH0000
          CALL      WRHOS27
          GOTO      SUBH0000
.
.     Do the Hospital Controlled Screen 28 - IDB10 & DRG Versions      *I-49037
.
DOHSPC28  DISPLAY   *P1:24,*B,"Please use webPAS front end.   ";
          CALL      HITENTER
          GOTO      SUBH1000
.
.davvy    CALL      DSPHOS28                               * CAR 284669
.davvy    MOVE      ONE,OVRCD
.davvy    CALL      UPHOS28
.davvy    BRANCH    OVRCD,SUBH0000
.davvy    CALL      WRHOS28
.davvy    GOTO      SUBH0000
.
.
.------------------------------------------------------------------------------
.         Subroutine to display screens
.------------------------------------------------------------------------------
.
DISPAGE   READ      CONTROLF,TWENTY;*92,PTCNAF01,PTCNAF02,PTCNAF03,PTCNAF04:
                                        PTCNAF05,PTCNAF06,PTCNAF07,PTCNAF08:
                                        PTCNAF09,PTCNAF10,PTCNAF11,PTCNAF12:
                                        PTCNAT01,PTCNAT02,PTCNAT03,PTCNAT04:
                                        PTCNAT05,PTCNAT06,PTCNAT07,PTCNAT08:
                                        PTCNAT09,PTCNAT10,PTCNAT11,PTCNAT12
.
          DISPLAY   *P1:3,*EF,*P8:4,*V2LON,*ULON:
                    "LOWER LIMIT",*P48:4,"UPPER LIMIT",*HOFF:
                    *P1:5," 1. Age Group  1 : ":
                    *P1:6," 2. Age Group  2 : ":
                    *P1:7," 3. Age Group  3 : ":
                    *P1:8," 4. Age Group  4 : ":
                    *P1:9," 5. Age Group  5 : ":
                    *P1:10," 6. Age Group  6 : ":
                    *P1:11," 7. Age Group  7 : ":
                    *P1:12," 8. Age Group  8 : ":
                    *P1:13," 9. Age Group  9 : ":
                    *P1:14,"10. Age Group 10 : ":
                    *P1:15,"11. Age Group 11 : ":
                    *P1:16,"12. Age Group 12 : ":
                    *P41:5,"13. Age Group  1 : ":
                    *P41:6,"14. Age Group  2 : ":
                    *P41:7,"15. Age Group  3 : ":
                    *P41:8,"16. Age Group  4 : ":
                    *P41:9,"17. Age Group  5 : ":
                    *P41:10,"18. Age Group  6 : ":
                    *P41:11,"19. Age Group  7 : ":
                    *P41:12,"20. Age Group  8 : ":
                    *P41:13,"21. Age Group  9 : ":
                    *P41:14,"22. Age Group 10 : ":
                    *P41:15,"23. Age Group 11 : ":
                    *P41:16,"24. Age Group 12 : ":
                    *P21:5,*V2LON,PTCNAF01,*P21:6,PTCNAF02:
                    *P21:7,PTCNAF03,*P21:8,PTCNAF04:
                    *P21:9,PTCNAF05,*P21:10,PTCNAF06:
                    *P21:11,PTCNAF07,*P21:12,PTCNAF08:
                    *P21:13,PTCNAF09,*P21:14,PTCNAF10:
                    *P21:15,PTCNAF11,*P21:16,PTCNAF12:
                    *P61:5,PTCNAT01,*P61:6,PTCNAT02:
                    *P61:7,PTCNAT03,*P61:8,PTCNAT04:
                    *P61:9,PTCNAT05,*P61:10,PTCNAT06:
                    *P61:11,PTCNAT07,*P61:12,PTCNAT08:
                    *P61:13,PTCNAT09,*P61:14,PTCNAT10:
                    *P61:15,PTCNAT11,*P61:16,PTCNAT12;
          RETURN
.
DISPAUD   READ      CONTROLF,TEN;*45,CAUDMAMX
          READ      CONTROLF,TEN;*201,CAUDA,CAUDB,CAUDC,CAUDD,CAUDE,CAUDF,CAUDG:
                                      CAUDH,CAUDI,CAUDJ,CAUDK,CAUDL,CAUDM,CAUDN:
                                      CAUDO,CAUDP,CAUDQ,CAUDR,CAUDS,CAUDT,CAUDU:
                                      CAUDV,CAUDW,CAUDX,CAUDY,CAUDZ:
                                      *239,CAUDA2,*250,CAUDA1
.
          DISPLAY   *P1:3,*EF:
                    *P1:4," 1. Admissions Audit   :":
                    *P1:5," 2. Discharges Audit   :":
                    *P1:6," 3. Codes Audit        :":
                    *P1:7," 4. Doctors Audit      :":
                    *P1:8," 5. Transfer Code Audit:":
                    *P1:9," 6. Bed Availability   :":
                    *P1:10," 7. Government Audit   :":
                    *P1:11," 8. Health Fund Audit  :":
                    *P1:12," 9. Item Codes Audit   :":
                    *P1:13,"10. Insurance Audit    :":
                    *P1:14,"11. Person Resp Audit  :":
                    *P1:15,"12. Group Code Audit   :":
                    *P1:16,"13. Master Index Audit :":
                    *P1:17,"14. Nursing Audit      :":
                    *P1:18,"15. Operations Audit   :":
                    *P1:19,"16. Rates Table Audit  :":
                    *P1:20,"17. Rate Change Audit  :":
                    *P1:21,"18. Misc Charges Audit :":
                    *P1:22,"19. Allowance Audit    :":
                    *P41:4,"20. Theatre Fee Audit  :":
                    *P41:5,"21. Enquiry Security   :":
                    *P41:6,"22. Bed Fee Audit      :":
                    *P41:7,"23. Ward Audit         :":
                    *P41:8,"24. EDI Audit          :":
                    *P41:9,"25. Ward Rates Audit   :":
                    *P41:10,"26. Disease Audit      :":
                    *P41:11,"27. Alerts Audit       :":
                    *P41:12,"28. Directorate Audit  :":
                    *P41:13,"29. PMI Master/Extens. :";
.
          MOVE      ZERO,INDEX
          MOVE      THREE,VERT
          MOVE      "26",COL
.
AUDLOOP1  ADD       ONE,INDEX
          ADD       ONE,VERT
          COMPARE   "30",INDEX
          GOTO      AUDCONT1 IF EQUAL
.
          COMPARE   "23",VERT
          GOTO      AUDPRNT1 IF LESS
.
          MOVE      FOUR,VERT
          MOVE      "66",COL
.
AUDPRNT1  LOAD      FIELD,INDEX,CAUDA,CAUDB,CAUDC,CAUDD,CAUDE:
                                CAUDF,CAUDG,CAUDH,CAUDI,CAUDJ:
                                CAUDK,CAUDL,CAUDM,CAUDN,CAUDO:
                                CAUDP,CAUDQ,CAUDR,CAUDS,CAUDT:
                                CAUDU,CAUDV,CAUDW,CAUDX,CAUDY:
                                CAUDZ,CAUDA1,CAUDA2,CAUDMAMX
          MOVE      DYES,DANS
          LOAD      DANS,FIELD,DNO
          DISPLAY   *PCOL:VERT,*V2LON,DANS;
          GOTO      AUDLOOP1
.
AUDCONT1  RETURN
.
DSPHOS    READ      CONTROLF,TEN;*9,CNOBEDS,*54,CFILENO,*66,CINVLAY:
                                *79,CAPPRVNO,*94,CAGECOFF,*138,CNOPORT
          READ      CONTROLF,TEN3;*1,CHADD1,CHADD2,CHPOST:
                                     CHPADD1,CHPADD2,CHPPOST,CHTELEB:
                                *167,BRSTAY1,BRSTAY2,BRSTAY3:
                                *213,CHCSCOD
          READ      CONTROLF,TEN8;*246,CMAXAGE
          READ      CONTROLF,TEN9;*212,CFEETYP
          READ      CONTROLF,EIGHTY;*250,PTCNHDPS
.
          IF        PTCNHDPS=0 & CFEETYP=0
            MOVE      SP1,KEY1
            UNPACK    CHPOST,KEY1,KEY3
            TYPE      KEY1
            IF        @EQUAL
              MOVE      KEY1,PTCNHDPS       * Get default from postcode
              WRITAB    CONTROLF,EIGHTY;*250,PTCNHDPS
            ENDIF
          ENDIF
          MOVE      HDP0,KEY23
          LOAD      KEY23,PTCNHDPS,HDP1,HDP2,HDP3,HDP4,HDP5,HDP6,HDP7,HDP8,HDP9
          PACK      KEY23,KEY23,SP30
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 1 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Hospital Address Line 1          :":
                    *P1:5," 2.                  Line 2          :":
                    *P1:6," 3. Hospital Postcode                :":
                    *P1:7," 4. Hospital Telephone Number        :":
                    *P1:8," 5. Hospital Postal Address Line 1   :":
                    *P1:9," 6.                         Line 2   :":
                    *P1:10," 7. Hospital Postal Postcode         :":
                    *P1:11," 8. Hospital File Number             :":
                    *P1:12," 9. Approval Number                  :":
                    *P1:13,"10. H.D.P. Hospital Code             :":
                    *P1:14,"11. Total Number of Beds in Hospital :":
                    *P1:15,"12. Child/Adult Age Cutoff           :":
                    *P1:16,"13. Maximum Permissible Age          :":
                    *P1:17,"14. Largest Port Number              :":
                    *P1:18,"15. Breakups First  Length of Stay   :":
                    *P1:19,"16. Breakups Second Length of Stay   :":
                    *P1:20,"17. Breakups Third  Length of Stay   :":
                    *P1:21,"18. Hospital State for HDP Extracts  :":
                    *P40:4,*V2LON,CHADD1,*P40:5,CHADD2,*P40:6,CHPOST:
                    *P40:7,CHTELEB:
                    *P40:8,CHPADD1,*P40:9,CHPADD2,*P40:10,CHPPOST:
                    *P40:11,CFILENO,*P40:12,CAPPRVNO,*P40:13,CHCSCOD:
                    *P41:14,CNOBEDS:
                    *P43:15,CAGECOFF,*P42:16,CMAXAGE,*P43:17,CNOPORT:
                    *P40:18,BRSTAY1,*P40:19,BRSTAY2,*P40:20,BRSTAY3:
                    *P40:21,PTCNHDPS,*HOFF,SP2,KEY23;
          RETURN
.
DSPHOS2   READ      CONTROLF,TEN;*120,CLETPLN,CLETTAB,*125,CSECFEE,*149,CLETLEN:
                                 *160,CMEDSERV,*164,CSPECCO:
                                 *183,CVIEWIP,CPRIMOP,CPRIMDS:
                                 *194,CDIETCD,CMEDCAR,*198,CDIETDF:
                                 *227,CLETTOP,CLETTOA,CLETTOS,CLETTOT
.
          READ      CONTROLF,TEN3;*144,COPRSIZ1,COPRSIZ2,*211,CINV1ST
          READ      CONTROLF,TEN4;*231,CATDMAN,*245,CMAXINV
          READ      CONTROLF,TEN5;*249,CRDRTYP
.
          MOVE      DNO,DANS0
          LOAD      DANS0,CINV1ST,DYES,DNO
.
          MOVE      CVIEW2,DANS1
          LOAD      DANS19,CVIEWIP,CVIEW1,CVIEW2,CVIEW3
.
          MOVE      DNO,DANS2
          LOAD      DANS2,CPRIMOP,DYES,DNO
.
          MOVE      DNO,DANS3
          LOAD      DANS3,CPRIMDS,DYES,DNO
.
          MOVE      DNO,DANS4
          LOAD      DANS4,CATDMAN,DYES,DNO
.
          MOVE      DNO,DANS6
          LOAD      DANS6,CMEDCAR,DYES,DNO
.
          MOVE      DNO,DANS7
          LOAD      DANS7,CRDRTYP,DYES,DNO
.
          MOVE      DOCCP,DANS10
          LOAD      DANS10,CSPECCO,DOCCP,DSPEC
.
          DISPLAY   *P54:2,*V2LON," - Hospital Screen 2 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. View Invoice before Printing     :":
                    *P1:5," 2. Use Primary Operations Only (Y/N):":
                    *P1:6," 3. Use Primary Diseases Only   (Y/N):":
                    *P1:7," 4. Medicare on Patient Status Report:":
                    *P1:8," 5. Using (O)ccupation or (S)pec Cond:":
                    *P1:9," 6. Printing Paper Length for Letters:":
                    *P1:10," 7. Default Letter Printing Length   :":
                    *P1:11," 8. Default Letter Top Margin        :":
                    *P1:12," 9. Default Letter Date/Address Gap  :":
                    *P1:13,"10. Default Letter Add./Salut. Gap   :":
                    *P1:14,"11. Default Letter Salut./Text Gap   :":
                    *P1:15,"12. Default Letter Left Margin       :":
                    *P1:16,"13. Security Level for Gross Fee     :":
                    *P1:17,"14. Doctors Summary Operation Level 1:":
                    *P1:18,"                              Level 2:":
                    *P1:19,"15. Invs 1st month as prev month(Y/N):":
                    *P1:20,"16. Attending Doctor mandatory ?(Y/N):":
                    *P1:21,"17. Referring Doctor Free Format(Y/N):":
                    *P1:22,"18. Max No. of days allowed on an inv:":
                    *P40:4,*V2LON,DANS19,*P40:5,DANS2:
                    *P40:6,DANS3:
                    *P40:7,DANS6:
                    *P40:8,DANS10:
                    *P40:9,CLETPLN:
                    *P40:10,CLETLEN,*P41:11,CLETTOP,*P41:12,CLETTOA:
                    *P41:13,CLETTOS,*P41:14,CLETTOT,*P41:15,CLETTAB:
                    *P42:16,CSECFEE,*P41:17,COPRSIZ1,*P41:18,COPRSIZ2:
                    *P40:19,DANS0,*P40:20,DANS4:
                    *P40:21,DANS7,*P40:22,CMAXINV;
.
          COMPARE   ONE,CDIETCD
          RETURN    IF NOT EQUAL
          PACK      KEY5,CODEDC,CDIETDF
          CALL      RDCODE1
          DISPLAY   *P1:23,"19. Default Dietary Category         :":
                    *P40:23,*V2LON,CDIETDF,*P50:23,TDESC;
          RETURN
.
DSPHOS3   READ      CONTROLF,TEN3;*143,CSIZLAB:
                                  *166,UROPT,*184,CERRAUD:
                                  *201,CNDOCLB,*212,CDOCSLB
          READ      CONTROLF,TEN4;*232,CDOCLLN
          READ      CONTROLF,TEN;*126,CLABPG,CLABPRT,*148,CDOCLAB
          READ      CONTROLF,TEN8;*207,CNDLAB,CDISPRT,*211,CBTLAB,CBTRPRT:
                                  *215,CPRDLB,CPRBTL,*231,CNBLAB,CNBPRT,CPRNBL
          READ      CONTROLF,FIFTY9;*35,CTYPLAB
.
          MOVE      DHTYPE2,DHTYPE
          LOAD      DHTYPE,CTYPLAB,DHTYPE3,DHTYPE5,DHTYPE6,DHTYPE9,DHTYPE10:
                                   DHTYPE12,DHTYPE14,DHTYPE15,DHTYPE16:
                                   DHTYPE17,DHTYPE18,DHTYPE19,DHTYPE20:
                                   DHTYPE21,DHTYPE22,DHTYPE23,DHTYPE24:
                                   DHTYPE25,DHTYPE26,DHTYPE27,DHTYPE28:
                                   DHTYPE29,DHTYPE30,DHTYPE31,DHTYPE34:
                                   DHTYPE35,DHTYPE54
.
          LOAD      DLSIZE,CSIZLAB,DLSIZE1,DLSIZE2
          LOAD      DOCLSIZ,CDOCSLB,DLSIZE1,DLSIZE2
.
          MOVE      URDESC1,URDESC
.
          MOVE      DNO,DANS15
          LOAD      DANS15,CPRDLB,DYES,DNO
.
          MOVE      DNO,DANS16
          LOAD      DANS16,CPRBTL,DYES,DNO
.
          MOVE      DNO,DANS17
          LOAD      DANS17,CPRNBL,DYES,DNO
.
          COMPARE   ZERO,UROPT
          GOTO      DISPSCN1 IF EQUAL
.
          MOVE      URDESC2,URDESC
.
DISPSCN1  DISPLAY   *P54:2,*V2LON,"- Hospital Screen 3 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Adm. Patient Labels - No Across Page :":
                    *P1:5," 2. Adm. Patient Labels - No to Print    :":
                    *P1:6," 3. Dis. Patient Labels - No Across Page :":
                    *P1:7," 4. Dis. Patient Labels - No to Print    :":
                    *P1:8," 5. B/Tr Patient Labels - No Across Page :":
                    *P1:9," 6. B/Tr Patient Labels - No to Print    :":
                    *P1:10," 7. N.Bn Patient Labels - No Across Page :":
                    *P1:11," 8. N.Bn Patient Labels - No to Print    :":
                    *P1:12," 9. Doctors Labels - No Across Page      :":
                    *P1:13,"10. Doctors Labels - No to Print         :":
                    *P1:14,"11. Doctors Labels - No of lines on label:":
                    *P1:15,"12. No longer in use                     :":
                    *P1:16,"13. No longer in use                     :":
                    *P1:17,"14. Patient Label U/R Option             :":
                    *P1:18,"15. Label Type used in Hospital          :":
                    *P1:19,"16. Patient Label Size used in Hospital  :":
                    *P1:20,"17. Doctor Label Size used in Hospital   :":
                    *P1:21,"18. Print Labels at time of Discharge    :":
                    *P1:22,"19. Print Labels at time of Bed Transfer :":
                    *P1:23,"20. Print Labels at time of New Born     :":
                    *P46:4,*V2LON,CLABPG:
                    *P44:5,CLABPRT:
                    *P46:6,CNDLAB:
                    *P44:7,CDISPRT:
                    *P46:8,CBTLAB:
                    *P44:9,CBTRPRT:
                    *P46:10,CNBLAB:
                    *P44:11,CNBPRT:
                    *P46:12,CDOCLAB:
                    *P45:13,CNDOCLB:
                    *P46:14,CDOCLLN:
                    *P46:17,UROPT,*P49:17,URDESC:
                    *P45:18,CTYPLAB,*P49:18,DHTYPE:
                    *P46:19,CSIZLAB,*P49:19,DLSIZE:
                    *P46:20,CDOCSLB,*P49:20,DOCLSIZ:
                    *P46:21,DANS15:
                    *P46:22,DANS16:
                    *P46:23,DANS17;
          RETURN
.
DSPHOS4   READ      CONTROLF,TEN3;*188,CMABINS,CVETINS:
                                  *216,CUSR1,CUSRDS1,CUSR2,CUSRDS2
          READ      CONTROLF,TEN4;*229,CUSMAN1,CUSMAN2
          READ      CONTROLF,TEN5;*233,CUSR3,CUSRDS3,CUSMAN3
          READ      CONTROLF,TEN8;*17,CUSR4,CUSRDS4,CUSMAN4
          READ      CONTROLF,HUND05;*203,PTCNCROL,PTCNCTYP
.
          MOVE      DNO,DANS1
          LOAD      DANS1,CUSR1,DYES,DNO
.
          MOVE      DNO,DANS2
          LOAD      DANS2,CUSMAN1,DYES,DNO
.
          MOVE      DNO,DANS3
          LOAD      DANS3,CUSR2,DYES,DNO
.
          MOVE      DNO,DANS4
          LOAD      DANS4,CUSMAN2,DYES,DNO
.
          MOVE      DNO,DANS5
          LOAD      DANS5,CUSR3,DYES,DNO
.
          MOVE      DNO,DANS6
          LOAD      DANS6,CUSMAN3,DYES,DNO
.
          MOVE      DNO,DANS7
          LOAD      DANS7,CUSR4,DYES,DNO
.
          MOVE      DNO,DANS8
          LOAD      DANS8,CUSMAN4,DYES,DNO
.
          MOVE      ZERO,FORM1
          MOVE      PTCNCTYP,FORM1
          PACK      CTRCTDES,SP20
          LOAD      CTRCTDES,FORM1,CTYPE1,CTYPE2,CTYPE3,CTYPE4,CTYPE5
.
          MOVE      SP30,INAME
          MOVE      CMABINS,KEY6
          CALL      RDINSR1
          MOVE      INAME,IDESCM
.
          MOVE      SP30,INAME
          MOVE      CVETINS,KEY6
          CALL      RDINSR1
          MOVE      INAME,IDESCV
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 4 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Insurance Code for M.A.B. Claims     :":
                    *P1:5," 2. Insurance Code for Veteran Affairs   :":
                    *P1:6," 3. Using User Defined Field 1(ADM) (Y/N):":
                    *P1:7," 4.                    Description       :":
                    *P1:8," 5.                    Mandatory ?  (Y/N):":
                    *P1:9," 6. Using User Defined Field 2(ADM) (Y/N):":
                    *P1:10," 7.                    Description       :":
                    *P1:11," 8.                    Mandatory ?  (Y/N):":
                    *P1:12," 9. Using User Defined Field 3(ADM) (Y/N):":
                    *P1:13,"10.                    Description       :":
                    *P1:14,"11.                    Mandatory  ? (Y/N):":
                    *P1:15,"12. Using User Defined Field 4(ADM) (Y/N):":
                    *P1:16,"13.                    Description       :":
                    *P1:17,"14.                    Mandatory  ? (Y/N):":
                    *P1:18,"15. Default Contract Role for QLD to     :":
                    *P1:19,"16. Default Contract Type for QLD to     :":
                    *P44:4,*V2LON,CMABINS,*P52:4,IDESCM:
                    *P44:5,CVETINS,*P52:5,IDESCV:
                    *P44:6,DANS1:
                    *P44:7,CUSRDS1:
                    *P44:8,DANS2:
                    *P44:9,DANS3:
                    *P44:10,CUSRDS2:
                    *P44:11,DANS4:
                    *P44:12,DANS5:
                    *P44:13,CUSRDS3:
                    *P44:14,DANS6:
                    *P44:15,DANS7:
                    *P44:16,CUSRDS4:
                    *P44:17,DANS8:
                    *P44:18,PTCNCROL:
                    *P44:19,PTCNCTYP,*P47:19,CTRCTDES;
          RETURN
.
DSPHOS5   READ      CONTROLF,TEN5;*191,CMUSR1,CMUSDS1,CMUSR2,CMUSDS2:
                                       CMUSR3,CMUSDS3,CMUSMAN1,CMUSMAN2,CMUSMAN3
          READ      CONTROLF,TEN8;*31,CUSR5,CUSRDS5,CUSMAN5:
                                      CUSR6,CUSRDS6,CUSMAN6:
                                      CUSR7,CUSRDS7,CUSMAN7
.
          MOVE      DNO,DANS1
          LOAD      DANS1,CUSR5,DYES,DNO
.
          MOVE      DNO,DANS2
          LOAD      DANS2,CUSMAN5,DYES,DNO
.
          MOVE      DNO,DANS3
          LOAD      DANS3,CUSR6,DYES,DNO
.
          MOVE      DNO,DANS4
          LOAD      DANS4,CUSMAN6,DYES,DNO
.
          MOVE      DNO,DANS5
          LOAD      DANS5,CUSR7,DYES,DNO
.
          MOVE      DNO,DANS6
          LOAD      DANS6,CUSMAN7,DYES,DNO
.
          MOVE      DNO,DANS7
          LOAD      DANS7,CMUSR1,DYES,DNO
.
          MOVE      DNO,DANS8
          LOAD      DANS8,CMUSMAN1,DYES,DNO
.
          MOVE      DNO,DANS9
          LOAD      DANS9,CMUSR2,DYES,DNO
.
          MOVE      DNO,DANS10
          LOAD      DANS10,CMUSMAN2,DYES,DNO
.
          MOVE      DNO,DANS11
          LOAD      DANS11,CMUSR3,DYES,DNO
.
          MOVE      DNO,DANS12
          LOAD      DANS12,CMUSMAN3,DYES,DNO
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 5 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Using User Defined Field 5(ADM) (Y/N):":
                    *P1:5," 2.                    Description       :":
                    *P1:6," 3.                    Mandatory ?  (Y/N):":
                    *P1:7," 4. Using User Defined Field 6(MOR) (Y/N):":
                    *P1:8," 5.                    Description       :":
                    *P1:9," 6.                    Mandatory ?  (Y/N):":
                    *P1:10," 7. Using User Defined Field 7(MOR) (Y/N):":
                    *P1:11," 8.                    Description       :":
                    *P1:12," 9.                    Mandatory ?  (Y/N):":
                    *P1:13,"10. Using User Defined Field 1(MAS) (Y/N):":
                    *P1:14,"11.                    Description       :":
                    *P1:15,"12.                    Mandatory ?  (Y/N):":
                    *P1:16,"13. Using User Defined Field 2(MAS) (Y/N):":
                    *P1:17,"14.                    Description       :":
                    *P1:18,"15.                    Mandatory ?  (Y/N):":
                    *P1:19,"16. Using User Defined Field 3(MAS) (Y/N):":
                    *P1:20,"17.                    Description       :":
                    *P1:21,"18.                    Mandatory ?  (Y/N):":
                    *P44:4,*V2LON,DANS1:
                    *P44:5,*V2LON,CUSRDS5:
                    *P44:6,*V2LON,DANS2:
                    *P44:7,*V2LON,DANS3:
                    *P44:8,*V2LON,CUSRDS6:
                    *P44:9,*V2LON,DANS4:
                    *P44:10,*V2LON,DANS5:
                    *P44:11,*V2LON,CUSRDS7:
                    *P44:12,*V2LON,DANS6:
                    *P44:13,*V2LON,DANS7:
                    *P44:14,CMUSDS1:
                    *P44:15,DANS8:
                    *P44:16,DANS9:
                    *P44:17,CMUSDS2:
                    *P44:18,DANS10:
                    *P44:19,DANS11:
                    *P44:20,CMUSDS3:
                    *P44:21,DANS12;
          RETURN
.
DSPHOS6   READ      CONTROLF,TEN8;*73,CDUSR1,CDUSDS1,CDUSMAN1:
                                      CDUSR2,CDUSDS2,CDUSMAN2:
                                      CDUSR3,CDUSDS3,CDUSMAN3:
                                      CDUSR4,CDUSDS4,CDUSMAN4:
                                      CDUSR5,CDUSDS5,CDUSMAN5
          MOVE      DNO,DANS1
          LOAD      DANS1,CDUSR1,DYES,DNO
.
          MOVE      DNO,DANS2
          LOAD      DANS2,CDUSMAN1,DYES,DNO
.
          MOVE      DNO,DANS3
          LOAD      DANS3,CDUSR2,DYES,DNO
.
          MOVE      DNO,DANS4
          LOAD      DANS4,CDUSMAN2,DYES,DNO
.
          MOVE      DNO,DANS5
          LOAD      DANS5,CDUSR3,DYES,DNO
.
          MOVE      DNO,DANS6
          LOAD      DANS6,CDUSMAN3,DYES,DNO
.
          MOVE      DNO,DANS7
          LOAD      DANS7,CDUSR4,DYES,DNO
.
          MOVE      DNO,DANS8
          LOAD      DANS8,CDUSMAN4,DYES,DNO
.
          MOVE      DNO,DANS9
          LOAD      DANS9,CDUSR5,DYES,DNO
.
          MOVE      DNO,DANS10
          LOAD      DANS10,CDUSMAN5,DYES,DNO
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 6 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Using User Defined Field 1(DSH) (Y/N):":
                    *P1:5," 2.                    Description       :":
                    *P1:6," 3.                    Mandatory ?  (Y/N):":
                    *P1:7," 4. Using User Defined Field 2(DSH) (Y/N):":
                    *P1:8," 5.                    Description       :":
                    *P1:9," 6.                    Mandatory ?  (Y/N):":
                    *P1:10," 7. Using User Defined Field 3(DSH) (Y/N):":
                    *P1:11," 8.                    Description       :":
                    *P1:12," 9.                    Mandatory ?  (Y/N):":
                    *P1:13,"10. Using User Defined Field 4(DSH) (Y/N):":
                    *P1:14,"11.                    Description       :":
                    *P1:15,"12.                    Mandatory ?  (Y/N):":
                    *P1:16,"13. Using User Defined Field 5(DSH) (Y/N):":
                    *P1:17,"14.                    Description       :":
                    *P1:18,"15.                    Mandatory ?  (Y/N):":
                    *P44:4,*V2LON,DANS1:
                    *P44:5,CDUSDS1:
                    *P44:6,DANS2:
                    *P44:7,DANS3:
                    *P44:8,CDUSDS2:
                    *P44:9,DANS4:
                    *P44:10,DANS5:
                    *P44:11,CDUSDS3:
                    *P44:12,DANS6:
                    *P44:13,DANS7:
                    *P44:14,CDUSDS4:
                    *P44:15,DANS8:
                    *P44:16,DANS9:
                    *P44:17,CDUSDS5:
                    *P44:18,DANS10;
          RETURN
.
DSPHOS7   READ      CONTROLF,TEN;*167,CSECURA,CSECURD
          READ      CONTROLF,TEN3;*182,CERRSEC,CERRDAY,*184,CERRAUD,CSTDOWN:
                                  *186,CMBSOPR,*200,CDOCVMP
          READ      CONTROLF,TEN5;*190,CKMBS,*247,CSTDOWN
          READ      CONTROLF,TEN8;*143,CLOWMBS,CLOWADM:
                                       CHIGHMBS,CHIGHADM,CTOPADM:
                                  *225,CCHGST1,CCHGST2
          READ      CONTROLF,TEN9;*209,CSRESP,*213,CDYCASE
          READ      CONTROLF,FIFTY9;*1,CDLSTEP,*233,PTCNADOC
.
          MOVE      "Free Format         ",DCKMBS
          LOAD      DCKMBS,CKMBS,DCKMBS0,DCKMBS1
.
          MOVE      SP20,TDESC1
          MATCH     SP3,CLOWADM
          GOTO      DHOS7A IF EQUAL
.
          PACK      KEY5,CODEA,CLOWADM
          CALL      RDCODE1
          BRANCH    OVRCD,DHOS7A
          MOVE      TDESC,TDESC1
.
DHOS7A    MOVE      SP20,TDESC2
          MATCH     SP3,CHIGHADM
          GOTO      DHOS7B IF EQUAL
.
          PACK      KEY5,CODEA,CHIGHADM
          CALL      RDCODE1
          BRANCH    OVRCD,DHOS7B
          MOVE      TDESC,TDESC2
.
DHOS7B    MOVE      SP20,TDESC3
          MATCH     SP3,CTOPADM
          GOTO      DHOS7C IF EQUAL
.
          PACK      KEY5,CODEA,CTOPADM
          CALL      RDCODE1
          BRANCH    OVRCD,DHOS7C
          MOVE      TDESC,TDESC3
.
.         Private Hospitals don't have the chargeable status
.
DHOS7C    COMPARE   ZERO,CHOSTYP
          GOTO      DHOS7E IF EQUAL
.
          MOVE      SP20,TDESC4
          MATCH     SP3,CCHGST1
          GOTO      DHOS7D IF EQUAL
.
          PACK      KEY5,CODEU2,CCHGST1
          CALL      RDCODE1
          BRANCH    OVRCD,DHOS7D
          MOVE      TDESC,TDESC4
.
DHOS7D    MOVE      SP20,TDESC5
          MATCH     SP3,CCHGST2
          GOTO      DHOS7E IF EQUAL
.
          PACK      KEY5,CODEU2,CCHGST2
          CALL      RDCODE1
          BRANCH    OVRCD,DHOS7E
          MOVE      TDESC,TDESC5
.
DHOS7E    MOVE      DNO,DANS2
          LOAD      DANS2,CSTDOWN,DYES,DNO
.
          MOVE      DNO,DANS1
          LOAD      DANS1,CDLSTEP,DYES,DNO
.
          MOVE      DNO,DANS3
          LOAD      DANS3,CSRESP,DYES,DNO
.
          MOVE      DYES,DANS4
          LOAD      DANS4,CERRAUD,DNO,DYES
.
          MOVE      DNO,DANS5
          LOAD      DANS5,CDYCASE,DYES,DNO
.
          MOVE      DMBSOP0,DMBSOPR
          LOAD      DMBSOPR,CMBSOPR,DMBSOP1
.
          MOVE      DDOCOP0,DDOCOPS
          LOAD      DDOCOPS,CDOCVMP,DDOCOP1
.
          MOVE      DNO,DANS6
          LOAD      DANS6,PTCNADOC,DYES,DNO
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 7 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Keyin Admitting Diagnosis MBS        :":
                    *P1:5," 2. Low MBS Fee                          :":
                    *P1:6," 3. Admission Type for Low MBS Fee       :":
                    *P1:7," 4. Highest MBS Fee                      :":
                    *P1:8," 5. Admission Type for Highest MBS Fee   :":
                    *P1:9," 6. Admission Type for Above Highest MBS :":
                    *P1:10," 7. Doing Automatic Stepdowns       (Y/N):":
                    *P1:11," 8. Doing Discount/Allow. Stepdowns (Y/N):":
                    *P1:12," 9. Auto change to Daycase Rate     (Y/N):":
                    *P1:13,"10. Self for Account Responsibility (Y/N):":
                    *P1:14,"11. Top Security Level for Date Changing :":
                    *P1:15,"12. Low Sec. Day Range for Date Changing :":
                    *P1:16,"13. Admission Security Level             :":
                    *P1:17,"14. Discharge Security Level             :":
                    *P1:18,"15. Can Delete Operator Error Audit (Y/N):":
                    *P1:19,"16. Management Analysis Operations Flag  :":
                    *P1:20,"17. Doctor Description in Doctor Reports :":
                    *P1:21,"18. Inactive doctor as Att. Doctor ?(Y/N):";
.
          COMPARE   ZERO,CHOSTYP
          GOTO      DHOS7F IF EQUAL
.
          DISPLAY   *P1:22,"19. Charge Code for Prisoner/Non-Resident:":
                    *P1:23,"20. Charge Code for Unknown Resident     :";
.
DHOS7F    DISPLAY   *P44:4,*V2LON,CKMBS,*P52:4,DCKMBS:
                    *P44:5,CLOWMBS:
                    *P44:6,CLOWADM,*P52:6,TDESC1:
                    *P44:7,CHIGHMBS:
                    *P44:8,CHIGHADM,*P52:8,TDESC2:
                    *P44:9,CTOPADM,*P52:9,TDESC3:
                    *P44:10,DANS2:
                    *P44:11,DANS1:
                    *P44:12,DANS5:
                    *P44:13,DANS3:
                    *P44:14,CERRSEC:
                    *P44:15,CERRDAY:
                    *P44:16,CSECURA:
                    *P44:17,CSECURD:
                    *P44:18,DANS4:
                    *P44:19,CMBSOPR,*P49:19,DMBSOPR:
                    *P44:20,CDOCVMP,*P49:20,DDOCOPS:
                    *P44:21,DANS6;
.
          COMPARE   ZERO,CHOSTYP
          RETURN    IF EQUAL
.
          DISPLAY   *P44:22,*V2LON,CCHGST1,*P52:22,TDESC4:
                    *P44:23,CCHGST2,*P52:23,TDESC5;
          RETURN
.
DSPHOS8   READ      CONTROLF,TEN8;*205,CPRINV,*206,CFINAN,*236,CMEDIB:
                                  *249,CNXBTCH,CDOCBTR,*254,CJRNDAT
          READ      CONTROLF,TEN5;*248,CBFXITM
          READ      CONTROLF,TEN9;*214,CWRDSCN,*216,CINVRIP,CINVRAE,CINVROF:
                                  *242,CTOTADM
          READ      CONTROLF,FIFTY9;*2,C3BDAYS,CREMINV,*6,CLUNTNO,*26,BEDCENS:
                                   *38,CRESIDT,*41,CNONRES,*44,CYRSRES:
                                  *227,CADMCAT
.
          MOVE      DNO,DANS1
          LOAD      DANS1,CWRDSCN,DYES,DNO
.
          MOVE      DNO,DANS12
          LOAD      DANS12,CBFXITM,DYES,DNO
.
          MOVE      DNO,DANS13
          LOAD      DANS13,CPRINV,DYES,DNO
.
          MOVE      "No                  ",KEY25
          IF        CFINAN=1
            MOVE      "Yes -Rates&Bed Type",KEY25
          ELSE
            IF        CFINAN=2
              MOVE      "Yes -Bed type(Adm&Trans)",KEY25
            ELSE
              IF        CFINAN=3
                MOVE      "Yes -Bed type(Trans)",KEY25
              ENDIF
            ENDIF
          ENDIF
.
          MOVE      DNO,DANS15
          LOAD      DANS15,CDOCBTR,DYES,DNO
.
          MOVE      DNO,DANS16
          LOAD      DANS16,CJRNDAT,DYES,DNO
.
          MOVE      DNO,DANS17
          LOAD      DANS17,CREMINV,DYES,DNO
.
          MOVE      DNO,DANS18
          LOAD      DANS18,CLUNTNO,DYES,DNO
.
          MOVE      SP20,DANS19
          LOAD      DANS19,BEDCENS,NORMAL,MELBCLIN
.
          PACK      KEY5,CODET,CRESIDT
          CALL      RDCODE1
          MOVE      TDESC,RESDESC
.
          PACK      KEY5,CODET,CNONRES
          CALL      RDCODE1
          MOVE      TDESC,NONRESD
.
          PACK      KEY5,CODECC,CADMCAT             * get default adm. cat.
          CALL      RDCODE1                         * for w. lists (hos31)
          MOVE      TDESC,ADMCDESC
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 8 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Print Invoice at Discharge ?          (Y/N):":
                    *P1:5," 2. Display Financial in Pat. Management?      :":
                    *P1:6," 3. Medibank Private Health Fund               :":
                    *P1:7," 4. Include Fixed Charge items in batch ? (Y/N):":
                    *P1:8," 5. Total No of Adms prior System Installation :":
                    *P1:9," 6. Selected Ward only in Ward/Bed Scan ? (Y/N):":
                    *P1:10," 7. Next Batch No. for HDP Transmission        :":
                    *P1:11," 8. Alter Attend. Doctor in Bed Transfer? (Y/N):":
                    *P1:12," 9. Alter Journal date in Input Journal ? (Y/N):":
                    *P1:13,"10. Inpatient System using Invoice Range       :":
                    *P1:14,"11. A & E System using Invoice Range           :":
                    *P1:15,"12. Other Financial System using Invoice Range :":
                    *P1:16,"13. Max Days of breaks b/w visits for 3B Cert. :":
                    *P1:17,"14. Remove zero amounts of Invoice Pending(Y/N):":
                    *P1:18,"15. Using Clinic Unit Number ?            (Y/N):":
                    *P1:19,"16. Patient Bed Census Report Layout           :":
                    *P1:20,"17. Default code for Resident Patients         :":
                    *P1:21,"18. Default code for Non-Resident Patients     :":
                    *P1:22,"19. Number of Years for Non-Charging           :":
                    *P1:23,"20. Default Adm. Cat. (CC) for W/List in HOS31 :":
                    *P50:4,*V2LON,DANS13,*P50:5,KEY25,*P50:6,CMEDIB:
                    *P50:7,DANS12,*P50:8,CTOTADM,*P50:9,DANS1,*P50:10,CNXBTCH:
                    *P50:11,DANS15,*P50:12,DANS16,*P50:13,CINVRIP:
                    *P50:14,CINVRAE,*P50:15,CINVROF:
                    *P50:16,C3BDAYS,*P50:17,DANS17,*P50:18,DANS18:
                    *P50:19,BEDCENS,"  ",DANS19,*P50:20,CRESIDT,*P57:20,RESDESC:
                    *P50:21,CNONRES,*P57:21,NONRESD,*P50:22,CYRSRES:
                    *P50:23,CADMCAT,*P57:23,ADMCDESC;
          RETURN
.
DSPHOS9   READ      CONTROLF,TEN9;*211,CPCINLE
          READ      CONTROLF,FIFTY9;*47,COTHARE,*50,COVRARE,*53,COIDINP:
                                    *55,COIDAAE,*57,COIDOUT:
                                    *66,CGSTPERC,CGSTITEM:
                                    *79,CYRESMAN,CBIRTHCN:
                                    *84,CMERGEUR,CMORBDTM,*128,CREBPORT:
                                   *132,CALRDESC,CPIDCOD,*205,CDOPANA:
                                   *208,PTWRDLAB,*213,PTURLAB,*216,PTPRVALS:
                                   *218,PTMORBDT
.
          MOVE      DNO,DANS
          LOAD      DANS,CPCINLE,DYES,DNO
.
          PACK      KEY5,CODEU1,COTHARE
          CALL      RDCODE1
          MOVE      TDESC,OTHARED
.
          PACK      KEY5,CODEU1,COVRARE
          CALL      RDCODE1
          MOVE      TDESC,OVRARED
.
          PACK      KEY5,COIDINP,SP3
          CALL      RDCODE1
          MOVE      TDESC,OIDINP
.
          PACK      KEY5,COIDAAE,SP3
          CALL      RDCODE1
          MOVE      TDESC,OIDAAE
.
          PACK      KEY5,COIDOUT,SP3
          CALL      RDCODE1
          MOVE      TDESC,OIDOUT
.
          READ      CONTROLF,TWENTY;*193,PTCNDCLM
          MATCH     SP70,PTCNDCLM
          IF        @EQUAL
            MOVE      "0  ",PTCNDCLM          * use zero claim code
          ENDIF
          PACK      KEY29,PTCNDCLM,SP6,SP3,CGSTITEM,CURRDATE,SP10
          CALL      PATMCHRD                * read Misc.Charges file 
          IF        EXIT = 1
            MOVE      SP70,MDESC
          ENDIF
          MOVE      MDESC,GSTDESC
.
DSPHOS91  MOVE      DNO,DANS1
          LOAD      DANS1,CYRESMAN,DYES,DNO
.
          MOVE      DNO,DANS2
          LOAD      DANS2,CBIRTHCN,DYES,DNO
.
          MOVE      DMRGOLD,MERGDESC
          LOAD      MERGDESC,CMERGEUR,DMRGOLD,DMRGNEW
.
          MOVE      OTIMEMAN,TIMEDESC                                 *C-207222
          LOAD      TIMEDESC,CMORBDTM,OTIMEEXS,OTIMENON
.
          MOVE      ODATEEXS,DATEDESC
          LOAD      DATEDESC,PTMORBDT,ODATENON,ODATEMAN
.
          MOVE      DNO,DANS5
          LOAD      DANS5,PTWRDLAB,DYES
.
          MOVE      DNO,DANS6
          LOAD      DANS6,PTPRVALS,DYES
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 9 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Area Code value for Other                  :":
                    *P1:5," 2. Area Code value for Overseas               :":
                    *P1:6," 3. Category used for Inpatient Operator Id    :":
                    *P1:7," 4. Category used for A & E Operator Id        :":
                    *P1:8," 5. Category used for Outpatient Operator Id   :":
                    *P1:9," 6. Patient Condition in Location Enquiry (Y/N):":
                    *P1:10," 7. GST Percentage                             :":
                    *P1:11," 8. GST Item (A miscellaneous charge)          :":
                    *P1:12," 9. Keyin Years Resident mandatory ?      (Y/N):":
                    *P1:13,"10. Keyin Country of Birth mandatory ?    (Y/N):":
                    *P1:14,"11. Merge UR Data Indicator                    :":
                    *P1:15,"12. Operation Times in Morbidity Data Entry    :":
                    *P1:16,"13. Operation Dates in Morbidity Data Entry    :":
                    *P1:17,"14. Medical Records Alert Description          :":
                    *P1:18,"15. User Defined Stationery Code for MR10's    :":
                    *P1:19,"16. Cat. used for Anaesthetic in Day Only Proc.:":
                    *P1:20,"17. Print ward on labels for Pre-admn. ?  (Y/N):":
                    *P1:21,"18. Adm. Patient U/R Labels - No. to Print     :":
                    *P1:22,"19. Previous name defaults to an alias ?  (Y/N):":
                    *P50:4,*V2LON,COTHARE,*P57:4,OTHARED:
                    *P50:5,COVRARE,*P57:5,OVRARED:
                    *P50:6,COIDINP,*P57:6,OIDINP:
                    *P50:7,COIDAAE,*P57:7,OIDAAE:
                    *P50:8,COIDOUT,*P57:8,OIDOUT:
                    *P50:9,DANS:
                    *P50:10,CGSTPERC:
                    *P50:11,CGSTITEM,*P57:11,GSTDESC:
                    *P50:12,DANS1:
                    *P50:13,DANS2:
                    *P50:14,MERGDESC:
                    *P50:15,TIMEDESC:
                    *P50:16,DATEDESC:
                    *P50:17,CALRDESC:
                    *P50:18,CPIDCOD:
                    *P50:19,CDOPANA:
                    *P50:20,DANS5:
                    *P50:21,PTURLAB:
                    *P50:22,DANS6;
.
DSPHOS92  RETURN
.
DSPHOS10  READ      CONTROLF,TEN4;CNOCLMS,CINMES1,CINMES2
          READ      CONTROLF,NINTY8;*165,PTCNAUED
          READ      CONTROLF,HUND09;PTCNQUM1,PTCNQUM2
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 10 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Invoice Message for Non-Claims":
                    *P1:7," 2. Invoice Message for Non-Payment ":
                          "Discharge Invoices":
                    *P1:10," 3. Invoice Message for patients ":
                           "discharged with Payment from Health Fund":
                    *P1:13," 4. Quotation Message line 1":
                    *P1:16," 5. Quotation Message line 2":
                    *P1:19," 6. EDI data directory (path must end with a ":
                    *V2LON,"/",*HOFF,")":
                    *P5:5,*V2LON,CNOCLMS:
                    *P5:8,CINMES1:
                    *P5:11,CINMES2:
                    *P5:14,PTCNQUM1:
                    *P5:17,PTCNQUM2:
                    *P5:20,PTCNAUED;
          RETURN
.
DSPHOS11  READ      CONTROLF,TEN5;CMSINV1,CMSINV2,CMSINV3
          READ      CONTROLF,EIGHTY8;*140,CFEEMDT
.
          UNPACK    CFEEMDT,XCENT3,XYEAR3,XMON3,XDAY3
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 11 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Invoice Message for Medical Services Line 1":
                    *P1:7," 2. Invoice Message for Medical Services Line 2":
                    *P1:10," 3. Invoice Message for Medical Services Line 3":
                    *P1:14," 4. From Date for Fees Invoiced Report :":
                    *P5:5,*V2LON,CMSINV1,*P5:8,CMSINV2:
                    *P5:11,CMSINV3,*P42:14,XDAY3,SLASH,XMON3,SLASH,XCENT3,XYEAR3;
          RETURN
.
DSPHS11A  READ      CONTROLF,TWENTY;*1,CMUSR4,CMUSDS4,CMUSR5,CMUSDS5,CMUSR6:
                                       CMUSDS6,CMUSMAN4,CMUSMAN5,CMUSMAN6
.
          MOVE      DNO,DANS7
          LOAD      DANS7,CMUSR4,DYES,DNO
.
          MOVE      DNO,DANS8
          LOAD      DANS8,CMUSMAN4,DYES,DNO
.
          MOVE      DNO,DANS9
          LOAD      DANS9,CMUSR5,DYES,DNO
.
          MOVE      DNO,DANS10
          LOAD      DANS10,CMUSMAN5,DYES,DNO
.
          MOVE      DNO,DANS11
          LOAD      DANS11,CMUSR6,DYES,DNO
.
          MOVE      DNO,DANS12
          LOAD      DANS12,CMUSMAN6,DYES,DNO
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 11A ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Using User Defined Field 4(MAS) (Y/N):":
                    *P1:5," 2.                    Description       :":
                    *P1:6," 3.                    Mandatory ?  (Y/N):":
                    *P1:7," 4. Using User Defined Field 5(MAS) (Y/N):":
                    *P1:8," 5.                    Description       :":
                    *P1:9," 6.                    Mandatory ?  (Y/N):":
                    *P1:10," 7. Using User Defined Field 6(MAS) (Y/N):":
                    *P1:11," 8.                    Description       :":
                    *P1:12," 9.                    Mandatory ?  (Y/N):":
                    *P44:4,*V2LON,DANS7:
                    *P44:5,CMUSDS4:
                    *P44:6,DANS8:
                    *P44:7,DANS9:
                    *P44:8,CMUSDS5:
                    *P44:9,DANS10:
                    *P44:10,DANS11:
                    *P44:11,CMUSDS6:
                    *P44:12,DANS12;
          RETURN
.
.         Display hospital screen 12
.
DSPHOS12  READ      CONTROLF,TEN;*15,PTCNDLVE,*25,PTCNVKCA,PTCNHBRD
          READ      CONTROLF,TWENTY;*78,PTCNALLC,*87,PTCNBRD,*91,PTCNHSEM:
                                    *165,PTCNDFBO,PTCNTACP,*192,PTALRH31:
                                    *193,PTCNDCLM,PTCNUCRD,PTCNUFML,PTCNPIOP:
                                    *199,PTCNBCUT,*204,PTCNDKCL,PTCNCDEF
          READ      CONTROLF,SEVENTY7;*23,PTCNNFAP,PTCNNFAD,PTCNDORO
          READ      CONTROLF,HUND05;*166,PTCNCMXF
.
DISPH12B  MOVE      "Date of Coding",HSEMMETH
          LOAD      HSEMMETH,PTCNHSEM,HSEMTYPA   * HSS extract method
.
          MOVE      DNO,DANS1
          LOAD      DANS1,PTCNALLC,DYES,DNO
.
          MOVE      DNO,DANS2
          LOAD      DANS2,PTCNDFBO,DYES,DNO
.
          MOVE      DNO,DANS3
          LOAD      DANS3,PTALRH31,DYES,DNO
.
          MOVE      DNO,DANS4
          LOAD      DANS4,PTCNUCRD,DYES,DNO
.
          MOVE      DNO,DANS5
          LOAD      DANS5,PTCNUFML,DYES,DNO
.
          MOVE      DNO,DANS6
          LOAD      DANS6,PTCNCDEF,DYES,DNO
.
          MOVE      DYES,DANS7
          LOAD      DANS7,PTCNVKCA,DNO,DYES
.
          MOVE      DPIOPT0,DPIOPT
          LOAD      DPIOPT,PTCNPIOP,DPIOPT1
.
          MOVE      SP20,TDESC
          MATCH     SP3,PTCNDLVE
          GOTO      DISPH12C IF EQUAL       * no code
          PACK      KEY5,ANST,ANSL,PTCNDLVE
          CALL      RDCODE1
DISPH12C  MOVE      TDESC,TDESC1
.
          MOVE      SP20,TDESC
          MATCH     SP3,PTCNDCLM
          GOTO      DISPH12D IF EQUAL
          PACK      KEY5,CODECL,PTCNDCLM
          CALL      RDCODE1
DISPH12D  MOVE      TDESC,TDESC2
.
          MOVE      SP20,TDESC
          MATCH     SP3,PTCNDKCL
          GOTO      DISPH12E IF EQUAL
          PACK      KEY5,CODECL,PTCNDKCL
          CALL      RDCODE1
DISPH12E  MOVE      TDESC,TDESC3
.
          MOVE      SP5,DBRDCUT
          MATCH     SP4,PTCNBCUT
          GOTO      DISPH12F IF EQUAL
          MATCH     "0000",PTCNBCUT
          GOTO      DISPH12F IF EQUAL
.
          UNPACK    PTCNBCUT,CMON,CDAY
          PACK      DBRDCUT,CDAY,SLASH,CMON
.
DISPH12F  MOVE      SP30,HFNAME
          PACK      KEY14,PTCNHBRD,ZERO,ZERO,ZERO,ZERO,SP10
          CALL      RDFUND1
          MOVE      HFNAME,FUNDDESC
.
          MOVE      DNO,DANS8
          LOAD      DANS8,PTCNCMXF,DYES
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 12 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Open all Clinics in Outpatient Proc ? (Y/N):":
                    *P1:5," 2. Board Number for New Zealand               :":
                    *P1:06," 3. HSS Extract Method                         :":
                    *P1:07," 4. Default Pre-Adm keyins to Bookings ?  (Y/N):":
                    *P1:08," 5. T.A.C. Provider number                     :":
                    *P1:09," 6. Default Type of leave                      :":
                    *P1:10," 7. Input Alert thru IBAHOS31/PAT31 ?     (Y/N):":
                    *P1:11," 8. Default claim code for charging            :":
                    *P1:12," 9. Default claim code for keyin               :":
                    *P1:13,"10. Using card information ?              (Y/N):":
                    *P1:14,"11. Using family id ?                     (Y/N):":
                    *P1:15,"12. Cash receipting when printing invoices     :":
                    *P1:16,"13. Starting date for board charging    (dd/mm):":
                    *P1:17,"14. Default card details from prev. visit (Y/N):":
                    *P1:18,"15. Audit on changes to card details ?    (Y/N):":
                    *P1:19,"16. Home board for other board referrals       :":
                    *P1:20,"17. No Fixed Abode Postcode                    :":
                    *P1:21,"18. No Fixed Abode District of Residence       :":
                    *P1:22,"19. Security level for D.O.R. keyin (GB Mailer):":
                    *P1:23,"20. Do Checking of Casemix Funding at Adm?(Y/N):":
                    *P50:4,*V2LON,DANS1:
                    *P50:5,PTCNBRD:
                    *P50:06,PTCNHSEM,*HOFF,*P54:06,HSEMMETH,*V2LON:
                    *P50:07,DANS2,*P50:08,PTCNTACP:
                    *P50:09,*V2LON,PTCNDLVE,*HOFF,*P58:09,TDESC1:
                    *P50:10,*V2LON,DANS3:
                    *P50:11,*V2LON,PTCNDCLM,*HOFF,*P58:11,TDESC2:
                    *P50:12,*V2LON,PTCNDKCL,*HOFF,*P58:12,TDESC3:
                    *P50:13,*V2LON,DANS4:
                    *P50:14,*V2LON,DANS5:
                    *P50:15,*V2LON,PTCNPIOP,*HOFF,*P58:15,DPIOPT:
                    *P50:16,*V2LON,DBRDCUT:
                    *P50:17,*V2LON,DANS6:
                    *P50:18,*V2LON,DANS7:
                    *P50:19,*V2LON,PTCNHBRD,*HOFF,*P58:19,FUNDDESC:
                    *P50:20,*V2LON,PTCNNFAP,*P50:21,*V2LON,PTCNNFAD:
                    *P50:22,*V2LON,PTCNDORO,*P50:23,*V2LON,DANS8
          RETURN
.
.         Display hospital screen 13
.
DSPHOS13  READ      CONTROLF,TWENTY;*209,PTCNSCLS,*211,PTCNCNDY,PTCNDOOP:
                             PTCNDPCN,*216,PTCNCSCP,*222,PTINSCER:
                             PTCNLNFF,PTCNCHFF
          READ      CONTROLF,TWENTY1;*1,PTCNBABD,PTCNOI73,PTCNET73,*46,PTCNBAGE:
                             *69,PTCNDSWP,PTCNDRGG,*123,PTCNOUTD,*199,PTCNDBWB:
                             *201,PTCNNLIL,PTCNUABL:
                             *219,PTCNDDCD:
                             *250,PTCNDDSD
.
          MOVE      DHIGHMBS,DHIGHDES
          LOAD      DHIGHDES,PTCNSCLS,DHIGHAMT
.
          MOVE      DNO,DANS2
          LOAD      DANS2,PTCNDPCN,DYES,DNO
.
          MOVE      DCNDY0,DCNDY
          LOAD      DCNDY,PTCNCNDY,DCNDY1
.
          MOVE      DOOP1,DESCDOOP
          LOAD      DESCDOOP,PTCNDOOP,DOOP2
.
          MOVE      DNO,DANS4
          LOAD      DANS4,PTINSCER,DYES,DNO
.
          MOVE      D38CHAR,DLBCHAR
          LOAD      DLBCHAR,PTCNCHFF,D33CHAR
.
          MOVE      BABDDSC0,BABDDESC
          LOAD      BABDDESC,PTCNBABD,BABDDSC1
.
          MOVE      DNO,DANS5
          LOAD      DANS5,PTCNOI73,DYES,DNO
.
          MOVE      DNO,DANS6
          LOAD      DANS6,PTCNET73,DYES,DNO
.
          MOVE      DRGDESC1,DRGDESC
          LOAD      DRGDESC,PTCNDRGG,DRGDESC2
.
          MOVE      DNO,DANS7
          LOAD      DANS7,PTCNDBWB,DYES,DNO
.
          MOVE      DNO,DANS8
          LOAD      DANS8,PTCNUABL,DYES,DNO
.
          MOVE      DNO,DANS9
          LOAD      DANS9,PTCNDDCD,DYES
.
          MOVE      DNO,DANS10
          LOAD      DANS10,PTCNDDSD,DYES
.
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 13 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Suggested Classification base on           :":
                    *P1:5," 2. When to reset day count for bed fee file   :":
                    *P1:6," 3. Dollar figure for operation rep. in PAT93  :":
                    *P1:7," 4. Print Patient condition in IBABIL89 (Y/N)? :":
                    *P1:8," 5. Community Service Card Prefix              :":
                    *P1:09," 6. Print insurance invoices on Cert.of Hosp.  :":
                    *P1:10," 7. No of lines on Free Format Label (5-8)     :":
                    *P1:11," 8. Size of Free Format Label (0=38char,1=33ch):":
                    *P1:12," 9. Baby Description to Use for a New Born     :":
                    *P1:13,"10. Input User Id in Input New Born            :":
                    *P1:14,"11. Input Ethnicity (Cat P1) in Input New Born :":
                    *P1:15,"12. Max. age to enter Admission weight (days)  :":
                    *P1:16,"13. Script name for Secretary Wordprocessor    :":
                    *P1:17,"14. DRG Grouper to use for IBAPMS99            :":
                    *P1:18,"15. Default Booking ward/bed at admission (Y/N):":
                    *P1:19,"16. Using Arm Band Labels in Templated Labels  :":
                    *P1:20,"17. Description for Outstanding Debt Alert     :":
                    *P1:21,"18. Number of Lines on Inpatient Labels        :":
                    *P1:22,"19. Coding Date to Default to Current Date     :":
                    *P1:23,"20. Default Discharge Summary Diagnosis (PAT34):":
                    *P50:4,*V2LON,PTCNSCLS,*HOFF,*P55:4,DHIGHDES:
                    *P50:5,*V2LON,PTCNCNDY,*HOFF,*P55:5,DCNDY:
                    *P50:6,*V2LON,PTCNDOOP,*HOFF,*P55:6,DESCDOOP:
                    *P50:7,*V2LON,DANS2,*P50:8,PTCNCSCP:
                    *P50:09,DANS4:
                    *P50:10,PTCNLNFF:
                    *P50:11,PTCNCHFF,*HOFF,*P55:11,DLBCHAR:
                    *P50:12,*V2LON,BABDDESC:
                    *P50:13,*V2LON,DANS5:
                    *P50:14,*V2LON,DANS6:
                    *P50:15,*V2LON,PTCNBAGE:
                    *P50:16,*V2LON,PTCNDSWP:
                    *P50:17,*V2LON,PTCNDRGG,*HOFF,*P55:17,DRGDESC:
                    *P50:18,*V2LON,DANS7:
                    *P50:19,*V2LON,DANS8:
                    *P50:20,*V2LON,PTCNOUTD:
                    *P50:21,PTCNNLIL:
                    *P50:22,*V2LON,DANS9:
                    *P50:23,*V2LON,DANS10
          RETURN
.
.
.         Display hospital screen 14
.
DSPHOS14
          READ      CONTROLF,TWENTY1;*174,PTCNDONR,PTCNMEDW,PTCNUDNG,PTCNNSCA:
                             PTCNMPTR,*181,PTCNLNCD,PTCNLP01,PTCNLH31,PTCNLO66:
                             PTCNLA01,PTCNLW01,PTCNVP32,PTCNVM21,PTCNUONL:
                             PTCNPCON,*212,PTCNLTYP:
                             *214,PTCNUREA
          READ      CONTROLF,SEVENTY7;*199,PTCNPCDS
          READ      CONTROLF,EIGHTY;*242,PTCNALOS
.
          MOVE      DNO,DANS1
          LOAD      DANS1,PTCNDONR,DYES,DNO
.
          MOVE      DNO,DANS2
          LOAD      DANS2,PTCNMEDW,DYES,DNO
.
          MOVE      DNO,DANS3       
          LOAD      DANS3,PTCNUDNG,DYES,DNO
.
          MOVE      DNO,DANS4
          LOAD      DANS4,PTCNNSCA,DYES,DNO
.
          MOVE      DNO,DANS5
          LOAD      DANS5,PTCNLNCD,DYES,DNO
.
          MOVE      DNO,DANS11
          LOAD      DANS11,PTCNVP32,DYES,DNO
.
          MOVE      DNO,DANS12
          LOAD      DANS12,PTCNVM21,DYES,DNO
.
          MOVE      DNO,DANS13
          LOAD      DANS13,PTCNUONL,DYES,DNO
.
          MOVE      CONTACT0,CONTACT
          LOAD      CONTACT,PTCNPCON,CONTACT1,CONTACT2
.
          MOVE      LADDESC0,LADPAT01
          LOAD      LADPAT01,PTCNLP01,LADDESC1,LADDESC2
.
          MOVE      LADDESC0,LADHOS31
          LOAD      LADHOS31,PTCNLH31,LADDESC1,LADDESC2
.
          MOVE      LADDESC0,LADOUT66
          LOAD      LADOUT66,PTCNLO66,LADDESC1,LADDESC2
.
          MOVE      LADDESC0,LADAAE01
          LOAD      LADAAE01,PTCNLA01,LADDESC1,LADDESC2
.
          MOVE      LADDESC0,LADWAT01
          LOAD      LADWAT01,PTCNLW01,LADDESC1,LADDESC2
.
          MOVE      "INVALID CODE",DDESC16
          LOAD      DDESC16,PTCNPCDS,DES1PCDS,DES2PCDS
.
          MOVE      DNO,DANS17
          LOAD      DANS17,PTCNLTYP,DYES,DNO
.
          MOVE      DNO,DANS19
          LOAD      DANS19,PTCNALOS,DYES,DNO
.
          PACK      KEY5,ANSU,PTCNUREA,SP3
          MOVE      "Invalid Code",DESCUREA
          CALL      RDCODE1
          MOVE      TDESC,DESCUREA 
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 14 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Using Donor Details ? (Y/N)                :":
                    *P1:5," 2. Using Medical Warnings Details ? (Y/N)     :":
                    *P1:6," 3. Can Danger Details Be Updated ? (Y/N)      :":
                    *P1:7," 4. National search criteria Automatic ? (Y/N) :":
                    *P1:8," 5. Max. no. of patients returned in search    :":
                    *P1:9," 6. Load Nat. Dets when change donor dets (Y/N):":
                    *P1:10," 7. Load National Details in PAT01 ?           :":
                    *P1:11," 8. Load National Details in HOS31 ?           :":
                    *P1:12," 9. Load National Details in OUT66 ?           :":
                    *P1:13,"10. Load National Details in AAE01 ?           :":
                    *P1:14,"11. Load National Details in WAT01 ?           :":
                    *P1:15,"12. Display National Visits in PAT32 ? (Y/N)   :":
                    *P1:16,"13. Display National Visits in MRT21 ? (Y/N)   :":
                    *P1:17,"14. Update National Details online ? (Y/N)     :":
                    *P1:18,"15. Patients Contact Person ?                  :":
                    *P1:19,"16. Default Procedure Code Description Type    :":
                    *P1:20,"17. Allow 'L' as disease type ?          (Y/N) :":
                    *P1:21,"18. (No longer used)                            ":
                    *P1:22,"19. AUSR Field for Re-admissn in 28 days?(1-9) :":
                    *P1:23,"20. Hosp ALOS divided by Discharges only(HOS82)?:":
                    *P50:4,*V2LON,DANS1,*HOFF:
                    *P50:5,*V2LON,DANS2:
                    *P50:6,*V2LON,DANS3:
                    *P50:7,*V2LON,DANS4,*HOFF," (No longer used)",*V2LON:
                    *P50:8,*V2LON,PTCNMPTR:             
                    *P50:9,DANS5:
                    *P50:10,*V2LON,PTCNLP01,*HOFF,*P52:10,"= ",LADPAT01:
                    *P50:11,*V2LON,PTCNLH31,*HOFF,*P52:11,"= ",LADHOS31:
                    *P50:12,*V2LON,PTCNLO66,*HOFF,*P52:12,"= ",LADOUT66:
                    *P50:13,*V2LON,PTCNLA01,*HOFF,*P52:13,"= ",LADAAE01:
                    *P50:14,*V2LON,PTCNLW01,*HOFF,*P52:14,"= ",LADWAT01:
                    *P50:15,*V2LON,DANS11:
                    *P50:16,*V2LON,DANS12:
                    *P50:17,*V2LON,DANS13:
                    *P50:18,*V2LON,PTCNPCON,*HOFF,*P52:18,"= ",CONTACT:
                    *P50:19,*V2LON,PTCNPCDS,*HOFF,*P52:19,"= ",DDESC16:
                    *P50:20,*V2LON,DANS17:
                    *P50:22,*V2LON,PTCNUREA,*HOFF,*P52:22,DESCUREA:
                    *P50:23,*V2LON,DANS19
          RETURN
.
.         Display hospital screen 15
.
DSPHOS15
          READ      CONTROLF,TEN;*39,PTCNACAN,*52,PTCNBNOK
          READ      CONTROLF,TWENTY1;*180,PTCNCDRS:
                             *215,PTCNUDIN,*218,PTCNBWMR:
                             *220,PTNSWHDP,*221,CNSWLOC,*222,CNSWLNG:
                             *223,PTCNEIAS,PTCNEIOC,PTCNEIMO,PTCNMWAD:
                             *238,PTCNAGEC
          READ      CONTROLF,SEVENTY7;*1,PTCNDPRS,PTCNCDAT:
                             *98,PTCNLFCH,*168,PTCNBRHF,*195,PTCNDLKR:
                             *198,PTCNPRCW
.
          PACK      KEY5,ANSU,PTCNUDIN,SP3
          MOVE      "Invalid Code",DESCUDIN
          CALL      RDCODE1
          MOVE      TDESC,DESCUDIN 
.
          MOVE      DNO,DANS2
          LOAD      DANS2,PTCNBWMR,DYES,DNO
.
          MOVE      DDESTCAT,DDESC4
          LOAD      DDESC4,PTNSWHDP,DSTATCAT
.
          MOVE      SP30,DLOCAT
          LOAD      DLOCAT,CNSWLOC,DLOCAT1,DLOCAT2
.
          MOVE      PUSERD0,DLANGU
          LOAD      DLANGU,CNSWLNG,PUSERD1,PUSERD2,PUSERD3,AUSERD1,AUSERD2:
                                   PUSERD4,PUSERD5,PUSERD6
.
          MOVE      ASOURCE,EDIADM
          LOAD      EDIADM,PTCNEIAS,AUSERD1,AUSERD2,AUSERD3,AUSERD4,AUSERD5:
                    AUSERD6,AUSERD7
.
          MOVE      SP30,EDIPMI
          LOAD      EDIPMI,PTCNEIOC,PUSERD1,PUSERD2,PUSERD3,PUSERD4,PUSERD5:
                    PUSERD6
          MOVE      EDILIVE,EDIMODE
          LOAD      EDIMODE,PTCNEIMO,EDITEST
.
          MOVE      DNO,DANS25
          LOAD      DANS25,PTCNDPRS,DYES,DNO
.
          UNPACK    PTCNCDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,CDATDATE
.
          MOVE      BRDDESC,DIM12
          LOAD      DIM12,PTCNBRHF,HFDESC
.
          MOVE      SP20,DESCDLKR
          MATCH     SP3,PTCNDLKR
          IF        !@EQUAL
            PACK      KEY5,ANSL,ANSU,PTCNDLKR      
            MOVE      SP20,TDESC
            CALL      RDCODE1
            MOVE      TDESC,DESCDLKR 
          ENDIF
.
          MOVE      DNO,DANS1
          LOAD      DANS1,PTCNCDRS,DYES,DNO
.
          MOVE      DNO,DANS4
          LOAD      DANS4,PTCNPRCW,DYES
.
          MOVE      DNO,DANS5
          LOAD      DANS5,PTCNACAN,DYES
.
          MOVE      BNOKDES0,DIM12
          LOAD      DIM12,PTCNBNOK,BNOKDES1
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 15 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. AUSR Field for Discharge Intention?   (1-7): ":
                    *P1:5," 2. Using Patient Weight in IBAINP94?     (Y/N): ":
                    *P1:6," 3. (No longer used)                           : ":
                    *P1:7," 4. Category to be used in NSW HDP transfer    : ":
                    *P1:8," 5. User defined field for HDP 'Locality'      : ":
                    *P1:9," 6. User defined field for HDP 'Language'      : ":
                    *P1:10," 7. User defined field for EDI Adm. Source     : ":
                    *P1:11," 8. User defined field for EDI Occupation      : ":
                    *P1:12," 9. EDI Extraction Mode :  0 = Live 1 = Test   : ":
                    *P1:13,"10. Medical Warnings Alert description         : ":
                    *P1:14,"11. Age at which patient is no longer a child  : ":
                    *P1:15,"12. Using different date range for PRS2 (Y/N)? :":
                    *P1:16,"13. Character used for Life Threatening Alerts :":
                    *P1:17,"14. Using Board or Health Fund Description     :":
                    *P1:18,"15. Default Link U/R Reason (cat LU) IBAHOS73  :":
                    *P1:19,"16. Using Coding Restraint for ICD9CM   (Y/N)? :":
                    *P1:20,"17. No Closed Ward/Beds printed in PAT84(Y/N)? :":
                    *P1:21,"18. Effective Date for ICD-10 Coding (DDMMCCYY):":
                    *P1:22,"19. Automatic Cancelation of Bookins On Death  :":
                    *P1:23,"20. Baby NOK Default in HOS73                  :":
                    *P50:4,*V2LON,PTCNUDIN,*HOFF,*P52:04,DESCUDIN:
                    *P50:5,*V2LON,DANS2:
                    *P50:7,*V2LON,PTNSWHDP,SP2,*HOFF,DDESC4:
                    *P50:8,*V2LON,CNSWLOC,*HOFF,SP2,DLOCAT:
                    *P50:9,*V2LON,CNSWLNG,*HOFF,SP2,DLANGU:
                    *P50:10,*V2LON,PTCNEIAS,*HOFF,SP2,EDIADM:
                    *P50:11,*V2LON,PTCNEIOC,*HOFF,SP2,EDIPMI:
                    *P50:12,*V2LON,PTCNEIMO,*HOFF,SP2,EDIMODE:
                    *P50:13,*V2LON,PTCNMWAD:
                    *P50:14,*V2LON,PTCNAGEC,*HOFF," years":
                    *P50:15,*V2LON,DANS25:
                    *P50:16,*V2LON,PTCNLFCH:
                    *P50:17,*V2LON,PTCNBRHF:
                    *P50:18,*V2LON,PTCNDLKR,*HOFF,SP2,DESCDLKR:
                    *P50:19,*V2LON,DANS1:
                    *P50:20,*V2LON,DANS4 :
                    *P50:21,*V2LON,CDATDATE:
                    *P50:22,*V2LON,DANS5,*HOFF," (No longer used)",*V2LON:
                    *P50:23,*V2LON,DIM12
          RETURN
.
.         Display Hospital Screen 16
.
DSPHOS16  READ      CONTROLF,THIRTY6;*176,RCCNUPBR
          READ      CONTROLF,SEVENTY7;*202,PTCNOCSC:
                                      *229,PTCNCFDS,*232,PTCNTMIN
          READ      CONTROLF,EIGHTY;*81,PTCNCQPT,PTCNCQDT,*240,PTCNDORP
.
DSPHS010  TRAP      DSPHS050 IF FORMAT
          READ      CONTROLF,EIGHTY;*111,PTCNADFP
          TRAPCLR   FORMAT 
.
DSPHS020  TRAP      DSPHS060 IF FORMAT
          READ      CONTROLF,EIGHTY;*117,PTCNADMF
          TRAPCLR   FORMAT
.
DSPHS030  TRAP      DSPHS070 IF FORMAT
          READ      CONTROLF,EIGHTY;*123,PTCNADXF
          TRAPCLR   FORMAT
          GOTO      DSPHS080
.
DSPHS050  MOVE      "   .00",PTCNADFP
          NORETURN
          GOTO      DSPHS020
.
DSPHS060  MOVE      "   .00",PTCNADMF
          NORETURN
          GOTO      DSPHS030
.
DSPHS070  MOVE      "   .00",PTCNADXF                            
          NORETURN
.
DSPHS080  READ      CONTROLF,TEN8;*162,CGLIND,*163,CGLPATH:
                                  *183,CGLDISS,*188,CGLRESP
          READ      CONTROLF,EIGHTY;*163,PTCNJRTY,*165,PTCNLDDC,*167,PTCNACDC:
                                      *179,PTCNLDAF,*181,PTCNACAF:
                                      *193,PTCNLDRF,*195,PTCNACRF: 
                                      *207,PTCNLDDS,*209,PTCNACDS:
                                      *221,PTCNJRCC,*230,PTCNDAY:
                                      *233,PTCNWEEK,*236,PTCNMONT
.
          IF        CGLIND <> 1 & RCCNUPBR <> 1
            MOVE      SP20,PTCNCQDT
            MOVE      SP20,PTCNCQPT
            MOVE      SP30,CHEQDESD
            MOVE      SP30,CHEQDESP
            PACK      PTCNLDDC,SP2
            PACK      PTCNACDC,SP20
            PACK      DCLGDESC,SP70
            PACK      PTCNLDDS,SP2
            PACK      PTCNACDS,SP20
            PACK      DSLGDESC,SP70
            PACK      PTCNLDAF,SP2
            PACK      PTCNACAF,SP20
            PACK      ADLGDESC,SP70
            PACK      PTCNLDRF,SP2
            PACK      PTCNACRF,SP20
            PACK      RFLDDESC,SP70
            MOVE      ZERO,CGLDISS
            PACK      CGLRESP,SP4
            GOTO      DSPHS100
          ENDIF
.
          IF        CGLIND <> 1 & RCCNUPBR = 1
            PACK      PTCNLDDC,SP2
            PACK      PTCNACDC,SP20
            PACK      DCLGDESC,SP70
            PACK      PTCNLDDS,SP2
            PACK      PTCNACDS,SP20
            PACK      DSLGDESC,SP70
            PACK      PTCNLDAF,SP2
            PACK      PTCNACAF,SP20
            PACK      ADLGDESC,SP70
            PACK      PTCNLDRF,SP2
            PACK      PTCNACRF,SP20
            PACK      RFLDDESC,SP70
            MOVE      ZERO,CGLDISS
            PACK      CGLRESP,SP4
            GOTO      DSPHS090
          ENDIF
.
          STRIP     CGLPATH
          PACK      FPATH,CGLPATH,FMSAMA
          SQUEEZE   FPATH
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      FMSAMAA1,FPATH
          TRAPCLR   IO
          BRANCH    OVRCD,DSPHS100
.
          OPEN      FMSAMAA2,FPATH
          OPEN      FMSAMAA3,FPATH
.
          STRIP     CGLPATH
          PACK      FPATH,CGLPATH,FMSDIS
          SQUEEZE   FPATH
          OPEN      FMSDISA1,FPATH
.
          STRIP     CGLPATH
          PACK      FPATH,CGLPATH,FMSRES
          SQUEEZE   FPATH
          OPEN      FMSRESA1,FPATH
.
          STRIP     CGLPATH
          PACK      FPATH,CGLPATH,FMSLMA
          SQUEEZE   FPATH
          OPEN      FMSLMAA1,FPATH
.
          PACK      KEY14,PTCNLDDC,PTCNACDC,SP20
          CALL      RDFMAM1
          IF        OVRCD = ONE
            PACK      PTCNLDDC,SP2
            PACK      PTCNACDC,SP20
            PACK      DCLGDESC,SP70
          ELSE
            MOVE      FMAMDESC,DCLGDESC
          ENDIF
.
          PACK      KEY14,PTCNLDDS,PTCNACDS,SP20
          CALL      RDFMAM1
          IF        OVRCD = ONE
            PACK      PTCNLDDS,SP2
            PACK      PTCNACDS,SP20
            PACK      DSLGDESC,SP70
          ELSE
            MOVE      FMAMDESC,DSLGDESC
          ENDIF
.
          PACK      KEY14,PTCNLDAF,PTCNACAF,SP20
          CALL      RDFMAM1
          IF        OVRCD = ONE
            PACK      PTCNLDAF,SP2
            PACK      PTCNACAF,SP20
            PACK      ADLGDESC,SP70
          ELSE
            MOVE      FMAMDESC,ADLGDESC
          ENDIF
.
          PACK      KEY14,PTCNLDRF,PTCNACRF,SP20
          CALL      RDFMAM1 
          IF        OVRCD = ONE
            PACK      PTCNLDRF,SP2
            PACK      PTCNACRF,SP20
            PACK      RFLDDESC,SP70
          ELSE
            MOVE      FMAMDESC,RFLDDESC  
          ENDIF
.
          PACK      KEY5,CGLDISS,SP5
          CALL      RDFMDS1
          IF        OVRCD = ONE
            MOVE      ZERO,CGLDISS
          ELSE
            MOVE      FMDSDESC,CODEDESC
          ENDIF
.
          PACK      KEY4,CGLRESP,SP4
          CALL      RDFMRS1
          IF        OVRCD = ONE
            PACK      CGLRESP,SP4
          ELSE
            MOVE      FMRSDESC,RESPDESC 
          ENDIF
.
DSPHS090  STRIP     CGLPATH
          PACK      FPATH,CGLPATH,FMSCHQ
          SQUEEZE   FPATH
          OPEN      FMSCHQA1,FPATH
.
          PACK      KEY15,PTCNCQPT,SP30
          CALL      RDFMCH1
          IF        OVRCD=TRUE
            MOVE      SP30,CHEQDESP
          ELSE
            MOVE      FMCHDES,CHEQDESP
          ENDIF
.
          PACK      KEY15,PTCNCQDT,SP30
          CALL      RDFMCH1
          IF        OVRCD=TRUE
            MOVE      SP30,CHEQDESD
          ELSE
            MOVE      FMCHDES,CHEQDESD
          ENDIF
.
DSPHS100  MOVE      SP30,DDODEF
          MATCH     PTCNCFDS,SP3
          GOTO      DSPHS110 IF EQUAL
.
          PACK      KEY5,CODED,PTCNCFDS,SP5
          CALL      RDCODE1
          IF        OVRCD=TRUE
            MOVE      SP30,DDODEF
          ELSE
            MOVE      TDESC,DDODEF
          ENDIF
.
DSPHS110  MOVE      PTCNTMIN,FORM1
          ADD       ONE,FORM1
          LOAD      DDTMIN,FORM1,DTMIN1,DTMIN2     * Temp invoice option
.
          PACK      KEY5,CODEJ,PTCNJRTY,SP20
          CALL      RDCODE1
          IF        OVRCD = 1
            PACK      PTCNJRTY,SP2
            PACK      JOURDESC,SP20
          ELSE
            MOVE      TDESC,JOURDESC
          ENDIF
.
          PACK      KEY5,CODEJ,PTCNJRCC,SP20
          CALL      RDCODE1
          IF        OVRCD = 1
            PACK      PTCNJRCC,SP2
            PACK      JOURDES1,SP20
          ELSE
            MOVE      TDESC,JOURDES1
          ENDIF
.
          MOVE      DNO,DANS1
          LOAD      DANS1,PTCNDORP,DYES
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 16 ",*P1:3,*EF,*HOFF:
                    *P1:4,*V2LON," 1":
                    *HOFF,". Occurence Screening Alert (4)  :":
                    *P1:5,*V2LON," 2":
                    *HOFF,". Patient Default Cheque Account :":
                    *P1:6,*V2LON," 3":
                    *HOFF,". Doctor Default Cheque Account  :":
                    *P1:7,*V2LON," 4":
                    *HOFF,". Doctor Entitlement Ledger/Acc. :":
                    *P1:8,*V2LON," 5":
                    *HOFF,". Specialist Fee Ledger/Account  :":
                    *P1:9,*V2LON," 6":
                    *HOFF,". Administr. Fee Ledger/Account  :":
                    *P1:10,*V2LON," 7":
                    *HOFF,". Refunds Ledger/Account         :":
                    *P1:11,*V2LON," 8":
                    *HOFF,". Journal Code for Refunds       :": 
                    *P1:12,*V2LON," 9":
                    *HOFF,". Dissection Code                :":
                    *P1:13,*V2LON,"10":
                    *HOFF,". Responsibility                 :":
                    *P1:14,*V2LON,"11":
                    *HOFF,". Default outcome (DSTAT)        :":
                    *P1:15,*V2LON,"12":
                    *HOFF,". Temporary invoice at discharge :":
                    *P1:16,*V2LON,"13":
                    *HOFF,". Administration Fee Percentage  :":
                    *P1:17,*V2LON,"14":
                    *HOFF,". Administration Fee Maximum     :":
                    *P1:18,*V2LON,"15":
                    *HOFF,". Administration Fee Minimum     :":
                    *P1:19,*V2LON,"16":
                    *HOFF,". Journal Code for Cancel Cheques:": 
                    *P1:20,*V2LON,"17":
                    *HOFF,". Upper Day Limit for PMIHEAD    :":
                    *P1:21,*V2LON,"18":
                    *HOFF,". Upper Week Limit for PMIHEAD   :":
                    *P1:22,*V2LON,"19":
                    *HOFF,". Upper Month Limit for PMIHEAD  :":
                    *P1:23,*V2LON,"20":
                    *HOFF,". Using DOR in previous address? :":
                    *P38:4,*V2LON,PTCNOCSC:
                    *P38:5,*V2LON,PTCNCQPT,*P54:5,*HOFF,CHEQDESP:
                    *P38:6,*V2LON,PTCNCQDT,*P54:6,*HOFF,CHEQDESD:
                    *P38:7,*V2LON,PTCNLDDC,*P40:7,*HOFF,"/",*V2LON:
                           PTCNACDC,*HOFF,*P54:7,DCLGDESC:
                    *P38:8,*V2LON,PTCNLDDS,*P40:8,*HOFF,"/",*V2LON:
                           PTCNACDS,*HOFF,*P54:8,DSLGDESC:
                    *P38:9,*V2LON,PTCNLDAF,*P40:9,*HOFF,"/",*V2LON:
                           PTCNACAF,*HOFF,*P54:9,ADLGDESC: 
                    *P38:10,*V2LON,PTCNLDRF,*P40:10,*HOFF,"/",*V2LON:
                           PTCNACRF,*HOFF,*P54:10,RFLDDESC:
                    *P38:11,*V2LON,PTCNJRTY,*P54:11,*HOFF,JOURDESC:
                    *P38:12,*V2LON,CGLDISS,*HOFF,*P54:12,CODEDESC:
                    *P38:13,*V2LON,CGLRESP,*HOFF,*P54:13,RESPDESC:
                    *P38:14,*V2LON,PTCNCFDS,*P54:14,*HOFF,DDODEF:
                    *P38:15,*V2LON,PTCNTMIN,*P54:15,*HOFF,DDTMIN:
                    *P38:16,*V2LON,PTCNADFP,*HOFF:
                    *P38:17,*V2LON,PTCNADXF,*HOFF:
                    *P38:18,*V2LON,PTCNADMF,*HOFF:
                    *P38:19,*V2LON,PTCNJRCC,*P54:19,*HOFF,JOURDES1:
                    *P38:20,*V2LON,PTCNDAY,*HOFF,*P54:20,"Days":
                    *P38:21,*V2LON,PTCNWEEK,*HOFF,*P54:21,"Weeks":
                    *P38:22,*V2LON,PTCNMONT,*HOFF,*P54:22,"Months":
                    *P38:23,*V2LON,DANS1
          RETURN
.
.         Display hospital screen 17
.
DSPHOS17  READ      CONTROLF,TEN;*40,PTCNINRA,PTCNINVQ,PTCNDGAT:
                                     PTCNMRBT,PTCNMRBC
          READ      CONTROLF,FIFTY9;*7,PTCNIBED
          READ      CONTROLF,SEVENTY9;*75,PTCNDBTR,*79,PTCNPREV,PTCNQLDB:
                                      *81,PTCNGEST,PTCNDSCI,PTCNESTB:
                                      *245,PTCNCHSD,PTCNCHAL:
                                       PTCNOPHO,*249,PTCNMIC1,PTCNMIC2
          READ      CONTROLF,EIGHTY;*143,PTCNAURN,*248,PTCNPEFR
.
          MOVE      DADMOPT0,DADMOPT
          LOAD      DADMOPT,PTCNAURN,DADMOPT1,DADMOPT2
.
          MOVE      DIBED0,DIBED
          LOAD      DIBED,PTCNIBED,DIBED1,DIBED2
.
          CLEAR     PEFR
          MOVE      PEFR0,PEFR
          LOAD      PEFR,PTCNPEFR,PEFR1,PEFR2
.
          MOVE      DYES,DANS1
          LOAD      DANS1,PTCNCHSD,DNO
.
          MOVE      DNO,DANS2
          LOAD      DANS2,PTCNINRA,DYES
.
          MOVE      DNO,DANS3
          LOAD      DANS3,PTCNINVQ,DYES
.
          MOVE      DNO,DANS4
          LOAD      DANS4,PTCNDGAT,DYES
.
          MOVE      DNO,DANS5
          LOAD      DANS5,PTCNMRBT,DYES
.
          MOVE      DNO,DANS6
          LOAD      DANS6,PTCNMRBC,DYES
.
          MOVE      DYES,DANS7
          LOAD      DANS7,PTCNCHSD,DNO
.
          MOVE      DYES,DANS8
          LOAD      DANS8,PTCNCHAL,DNO
.
          MOVE      DNO,DANS9
          LOAD      DANS9,PTCNOPHO,DYES
.
          MOVE      DNO,DANS10
          LOAD      DANS10,PTCNMIC1,DYES
.
          MOVE      DMICR0,DMICRDES                
          LOAD      DMICRDES,PTCNMIC2,DMICR1,DMICR2
.
          MOVE      DYES,DANS12
          LOAD      DANS12,PTCNPREV,DNO
.
          LOAD      DIM15,PTCNQLDB,DISUSR1,DISUSR2,DISUSR3,DISUSR4,DISUSR5:
                                   ADMTYPE,CARECLSS
.
          MOVE      AUSERD0,GESTPER
          LOAD      GESTPER,PTCNGEST,AUSERD1,AUSERD2,AUSERD3,AUSERD4,AUSERD5:
                                     AUSERD6,AUSERD7,AUSERD8,AUSERD9
.
          MOVE      "Invalid Code",DDSCI
          MOVE      "P ",TCODE
          IF        PTCNDSCI>0 & PTCNDSCI<6
            PACK      TCODE,ANSU,PTCNDSCI
          ENDIF
          IF        PTCNDSCI=6
            PACK      TCODE,ANSV,ANSI
          ENDIF
          PACK      KEY5,TCODE,SP3
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      TDESC,DDSCI
          ENDIF
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 17 ",*P1:3,*EF,*HOFF:
                    *P1:4,*V2LON," 1",*HOFF:
                          ". Method of admitting/changing adm. details    : ":
                    *P1:5,*V2LON," 2",*HOFF:
                          ". Adjust Occupancy Stats. for Inactive Beds    : ":
                    *P1:6,*V2LON," 3",*HOFF:
                          ". Print Estimated Fund Rebate ?                : ":
                    *P1:7,*V2LON," 4",*HOFF:
                          ". Using Intention to Re-Admit in INP79 (":
                    *V2LON,ANSY,*HOFF,"/",*V2LON,ANSN,*HOFF,")   : ":
                    *P1:8,*V2LON," 5",*HOFF:
                          ". ? Option on Invoice in Cash Receipts (":
                    *V2LON,ANSY,*HOFF,"/",*V2LON,ANSN,*HOFF,")   : ":
                    *P1:9,*V2LON," 6",*HOFF:
                          ". Check MBS against Adm.Type for Daycase (":
                    *V2LON,ANSY,*HOFF,"/",*V2LON,ANSN,*HOFF,") : ":
                    *P1:10,*V2LON," 7",*HOFF:
                          ". Move Medical Record at Bed Transfer (":
                    *V2LON,ANSY,*HOFF,"/",*V2LON,ANSN,*HOFF,")    : ":
                    *P1:11,*V2LON," 8",*HOFF:
                          ". Barcode to Move Med. Rec. at Bed Trans. (":
                    *V2LON,ANSY,*HOFF,"/",*V2LON,ANSN,*HOFF,"): ":
                    *P1:12,*V2LON," 9",*HOFF:
                           ". Change Transfer Recs. on Day of Change in PMS03":
                          " (":
                    *V2LON,ANSY,*HOFF,"/",*V2LON,ANSN,*HOFF,") : ":
                    *P1:13,*V2LON,"10",*HOFF:
                           ". Change Transfer Recs. following Change in PMS03":
                          " (":
                    *V2LON,ANSY,*HOFF,"/",*V2LON,ANSN,*HOFF,") : ":
                    *P1:14,*V2LON,"11",*HOFF:
                           ". Perform Operations at Different Hospitals":
                          " (":
                    *V2LON,ANSY,*HOFF,"/",*V2LON,ANSN,*HOFF,")       : ":
                    *P1:15,*V2LON,"12",*HOFF:
                           ". Default Medical Record Movement reason on ":
                           "Bed Transfer:":
                    *P1:16,*V2LON,"13",*HOFF:
                           ". Preserve Microfilm Address in U/R Merge":     
                           "- 1 field (":
                    *V2LON,ANSY,*HOFF,"/",*V2LON,ANSN,*HOFF,"): ":
                    *P1:17,*V2LON,"14",*HOFF:
                           ". Preserve Microfilm Address in U/R Merge":     
                           "- both fields  :":
                    *P1:18,*V2LON,"15",*HOFF:
                           ". (No Longer Used)                       ":     
                           "               :":
                    *P1:19,*V2LON,"16",*HOFF:
                           ". Using Preadmit with Previous Details (":     
                           *V2LON,ANSY,*HOFF,"/",*V2LON,ANSN,*HOFF,")":
                           "            :":
                    *P1:20,*V2LON,"17",*HOFF:
                           ". Banding & Type of Episode for QLD Health":
                           " Dept. Trans. :":
                    *P1:21,*V2LON,"18",*HOFF:
                           ". Adm user defined cat for Gestation Period  ":
                           ":":
                    *P1:22,*V2LON,"19",*HOFF:
                           ". Casemix - Field for Discharge Intention    ":
                           ":":
                    *P1:23,*V2LON,"20",*HOFF:
                           ". Establishment No. for Tasmanian Health Dept":
                           ":":
                    *P52:4,*V2LON,PTCNAURN,*HOFF,*P55:4,DADMOPT:
                    *P52:5,*V2LON,PTCNIBED,*HOFF,*P55:5,DIBED:
                    *P52:6,*V2LON,PTCNPEFR,*HOFF,*P55:6,PEFR:
                    *P52:7,*V2LON,DANS2:
                    *P52:8,*V2LON,DANS3:
                    *P52:9,*V2LON,DANS4:
                    *P52:10,*V2LON,DANS5:
                    *P52:11,*V2LON,DANS6:
                    *P61:12,*V2LON,DANS7:
                    *P61:13,*V2LON,DANS8:
                    *P61:14,*V2LON,DANS9:
                    *P61:15,*V2LON,PTCNDBTR:
                    *P61:16,DANS10:
                    *P61:17,DMICRDES:
                    *P61:19,DANS12:
                    *P61:20,DIM15:
                    *P50:21,*V2LON,PTCNGEST,*HOFF," = ",GESTPER:
                    *P50:22,*V2LON,PTCNDSCI,*HOFF,SP3,DDSCI:
                    *P50:23,*V2LON,PTCNESTB;
.
          RETURN
.
. ----- Display Hospital Screen 18 -----
.
DSPHOS18  READ      CONTROLF,TEN;*46,PTCNFRDA,PTCNNLOC,*50,PTCNACDR,PTCNACPH
          READ      CONTROLF,TWENTY;*250,PTCNH82W
          READ      CONTROLF,SEVENTY7;*35,PTCNP68L
          READ      CONTROLF,SEVENTY9;*93,PTCNAAPE,PTCNADTT,PTCNDSTT:
                                      *106,KEY4:
                                      *110,PTCNVADM,PTCNECDF,*113,PTCNDSPC:
                                      *114,PTCNPPPT,*119,PTCNEAPD:
                                      *122,PTCNLMAN,PTCNLEDT,PTCNPACC,PTCNEEOC
.
          REP       " 0",KEY4
          MOVE      KEY4,PTCNDAYM
.
          MOVE      DNO,DANS1
          LOAD      DANS1,PTCNAAPE,DYES
.
          MOVE      SP20,TDESC
          PACK      TCODE,ANSU,PTCNADTT
          PACK      KEY5,TCODE,SP5
          CALL      RDCODE1
          MOVE      TDESC,ADTTDESC
.
          MOVE      SP20,TDESC
          PACK      TCODE,ANSD,PTCNDSTT
          PACK      KEY5,TCODE,SP5
          CALL      RDCODE1
          MOVE      TDESC,DSTTDESC
.
          MOVE      SCANDES0,SCANDESC
          LOAD      SCANDESC,PTCNP68L,SCANDES1
.
          MOVE      VADM0,VADMDESC
          LOAD      VADMDESC,PTCNVADM,VADM1
          MOVE      ECDF0,ECDFDESC
          LOAD      ECDFDESC,PTCNECDF,ECDF1
.
          MOVE      DNO,DANS10
          LOAD      DANS10,PTCNACDR,DYES
          MOVE      DNO,DANS11
          LOAD      DANS11,PTCNACPH,DYES
.
          MOVE      DNO,DANS12
          LOAD      DANS12,PTCNDSPC,DYES
.
          MOVE      "Invalid Code",PPPTDESC
          PACK      KEY5,ANSU,PTCNPPPT
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      TDESC,PPPTDESC
          ENDIF
.
          MOVE      DNO,DANS15
          LOAD      DANS15,PTCNH82W,DYES
.
          MOVE      DNO,DANS16
          LOAD      DANS16,PTCNEAPD,DYES
.
          MOVE      DNO,DANS17
          LOAD      DANS17,PTCNLMAN,DYES
.
          UNPACK    PTCNLEDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,LNKEDATE
.
          MOVE      DEEOC0,DEEOCDES                
          LOAD      DEEOCDES,PTCNEEOC,DEEOC1,DEEOC2
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 18 ",*P1:3,*EF,*HOFF:
                    *P1:4,*V2LON," 1",*HOFF:
                          ". Change Encoder disease code prefixes   (Y/N)?: ":
                    *P1:5,*V2LON," 2",*HOFF:
                          ". Which AUSR field for admission transfer type : ":
                    *P1:6,*V2LON," 3",*HOFF:
                          ". Which DUSR field for discharge transfer type : ":
                    *P1:7,*V2LON," 4",*HOFF:
                          ".<Not Used> - Use Hospital EDI Screen - Fld 4> : ":
                    *P1:8,*V2LON," 5",*HOFF:
                          ". Format for Pre-Admission Scan                : ":
                    *P1:9,*V2LON," 6",*HOFF:
                          ". Number of Days in a Month                    : ":
                    *P1:10,*V2LON," 7",*HOFF:
                          ". Validation of Admission Details Being Used   : ":
                    *P1:11,*V2LON," 8",*HOFF:
                          ". Emergency Contact details default to         : ":
                    *P1:12,*V2LON," 9",*HOFF:
                          ". First Regular Day/Night Attender field       : ":
                    *P1:13,*V2LON,"10",*HOFF:
                          ". Neonatal Level of Care field                 : ":
                    *P1:14,*V2LON,"11",*HOFF:
                          ". Auto Check of District of Residence    (Y/N)?: ":
                    *P1:15,*V2LON,"12",*HOFF:
                          ". Auto Check of Postcode to Home Address (Y/N)?: ":
                    *P1:16,*V2LON,"13",*HOFF:
                          ". Default Doc Cat A for the Patient Cat A(Y/N)?: ":
                    *P1:17,*V2LON,"14",*HOFF:
                          ". Which AUSR field for private/public category : ":
                    *P1:18,*V2LON,"15",*HOFF:
                          ". Print no stats wards for HOS82         (Y/N)?: ":
                    *P1:19,*V2LON,"16",*HOFF:
                          ". Auto alloc of princ prefix for Encoder (Y/N)?: ":
                    *P1:20,*V2LON,"17",*HOFF:
                          ". Link Event to Episode of Care Mandatory(Y/N) : ":
                    *P1:21,*V2LON,"18",*HOFF:
                          ". Date to Link Events to EOC from              : ":
                    *P1:22,*V2LON,"19",*HOFF:
                          ". User Defined Stationery Code for ACC Form    : ":
                    *P1:23,*V2LON,"20",*HOFF:
                          ". Enter Emergency EOC Details in               : ":
                    *P52:4,*V2LON,DANS1,*HOFF:
                    *P52:5,*V2LON,PTCNADTT,*HOFF,SP1,ADTTDESC:
                    *P52:6,*V2LON,PTCNDSTT,*HOFF,SP1,DSTTDESC:
                    *P52:8,*V2LON,PTCNP68L,*HOFF,SP1,SCANDESC:
                    *P52:9,*V2LON,PTCNDAYM:
                    *P52:10,*V2LON,PTCNVADM,*HOFF,SP1,VADMDESC:
                    *P52:11,*V2LON,PTCNECDF,*HOFF,SP1,ECDFDESC:
                    *P52:12,*V2LON,PTCNFRDA:
                    *P52:13,*V2LON,PTCNNLOC:
                    *P52:14,*V2LON,DANS10:
                    *P52:15,*V2LON,DANS11:
                    *P52:16,*V2LON,DANS12:
                    *P52:17,*V2LON,PTCNPPPT,*HOFF,SP1,PPPTDESC:
                    *P52:18,*V2LON,DANS15:
                    *P52:19,*V2LON,DANS16:
                    *P52:20,*V2LON,DANS17:
                    *P52:21,*V2LON,LNKEDATE:
                    *P52:22,*V2LON,PTCNPACC:
                    *P52:23,*V2LON,DEEOCDES;
          RETURN
.
.***************************************************************************
. ----- Display Hospital Screen 19 -----
.***************************************************************************
DSPHOS19  READ      CONTROLF,SEVENTY7;*215,PTCNUVTH,PTCNPALC,PTCNFINP:
                                      *218,PTCNDSDY,PTCNDMSO
          READ      CONTROLF,SEVENTY9;*243,PTCNRORC
          READ      CONTROLF,EIGHTY8;*1,PTCNPELT,*2,PTCNIELT,*43,PTCNACCF:
                                     *56,PTCNHADF,*232,PTCNDEBW
          READ      CONTROLF,TWENTY1;*44,PTCNIDES
          READ      CONTROLF,EIGHTY8;*234,PTCNNCFB,*235,PTCNADCF,*236,PTCNDSCF:
                                     *237,PTCNEMPL,*239,PTCNOCCP,*241,PTCNCSTA:
                                     *244,PTCNCRAY
.
          MOVE      DRORC0,DRORC
          LOAD      DRORC,PTCNRORC,DRORC1
.
          PACK      KEY5,ANSU,PTCNUVTH
          MOVE      "Invalid Code",DESCUVTH
          CALL      RDCODE1
          IF        OVRCD = 0
            MOVE      TDESC,DESCUVTH
          ENDIF
.
          PACK      KEY5,ANSU,PTCNPALC
          MOVE      "Invalid Code",DESCPALC
          CALL      RDCODE1
          IF        OVRCD = 0
            MOVE      TDESC,DESCPALC
          ENDIF
.
          PACK      TDESC,SP20
          PACK      KEY5,ANSD,PTCNFINP,SP3
          CALL      RDCODE1
          IF        OVRCD = 0
            MOVE      TDESC,DESC20A
          ENDIF
.
          PACK      TDESC,SP20
          PACK      KEY5,ANSL,PTCNACCF,SP3
          CALL      RDCODE1
          IF        OVRCD = 0
            MOVE      TDESC,DESC20B
          ENDIF
.
          PACK      TDESC,SP20
          PACK      DESC20C,SP20
          MATCH     SP3,PTCNHADF
          IF        !@EQUAL
            PACK      KEY5,ANSH,ANSA,PTCNHADF,SP5
            CALL      RDCODE1
            IF        OVRCD = 0
              MOVE      TDESC,DESC20C
            ENDIF
          ENDIF
.
          MOVE      DNO,DANS1
          LOAD      DANS1,PTCNPELT,DYES
.
          MOVE      DNO,DANS2
          LOAD      DANS2,PTCNIELT,DYES
.
          MOVE      DNO,DANS13
          LOAD      DANS13,PTCNDEBW,DYES,DNO
.
          MOVE      ACCDES0,DIM24
          LOAD      DIM24,PTCNIDES,ACCDES1
.
          MOVE      DDRG0,DDRGSDY           * Default to "do nothing"
          LOAD      DDRGSDY,PTCNDSDY,DDRG1,DDRG2
.
          MOVE      DDRG0,DDRGMSO           * Default to "do nothing"
          LOAD      DDRGMSO,PTCNDMSO,DDRG1,DDRG2
.
          MOVE      SP20,DIM15
          MOVE      BEDTYPE,DIM15
          LOAD      DIM15,PTCNNCFB,ADMTYPE
.
          MOVE      DNO,DANS5
          LOAD      DANS5,PTCNADCF,DYES,DNO
.
          MOVE      DNO,DANS6
          LOAD      DANS6,PTCNDSCF,DYES,DNO
.
          PACK      TDESC,SP20
          PACK      KEY5,PTCNEMPL,SP3
          CALL      RDCODE1                 * Read the codes file
          PACK      EMPLDESC,TDESC,SP20
.
          PACK      TDESC,SP20
          PACK      KEY5,PTCNOCCP,SP3
          CALL      RDCODE1                 * Read the codes file
          PACK      OCCPDESC,TDESC,SP20
.
          MOVE      SP70,CTYPDESC
          LOAD      CTYPDESC,PTCNCSTA,CSTAD1,CSTAD2,CSTAD3,CSTAD4,CSTAD5:
                                      CSTACC,CSTALS
.
          PACK      TDESC,SP20
          IF        PTCNCRAY>0 & PTCNCRAY<5
            PACK      KEY5,ANSD,PTCNCRAY,SP3
          ELSE
            PACK      KEY5,ANSV,ANSK,SP3
          ENDIF
          CALL      RDCODE1                 * Read a codes file record
          PACK      CRAYDESC,TDESC,SP20
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 19 ",*P1:3,*EF,*HOFF:
                    *P1:4,*V2LON," 1",*HOFF:
                    ". Cheque/Receipt No for HF & Insur recpt audit:":
                    *P1:5,*V2LON," 2",*HOFF:
                    ". AUSR Fld for Unplanned Visit to Theatre(1-9):":
                    *P1:6,*V2LON," 3",*HOFF:
                    ". AUSR Fld for Involvement of Palliative (1-9):":
                    *P1:7,*V2LON," 4",*HOFF:
                    ". Which Usr Defined for Finance Prg.NSW(D1-D5): ":
                    *P1:8,*V2LON," 5",*HOFF:
                    ". Using Eltron Printer for PMI Labels (Y/N)   : ":
                    *P1:9,*V2LON," 6",*HOFF:
                    ". Using Eltron Printer for INP Labels (Y/N)   : ":
                    *P1:10,*V2LON," 7",*HOFF:
                    ". Which Usr Def. for ACC Accident Flag (L1-L4): ":
                    *P1:11,*V2LON," 8",*HOFF:
                    ". Default Health Agency (Category HA)         : ":
                    *P1:12,*V2LON," 9",*HOFF: 
                    ". (No longer used)                            : ":
                    *P1:13,*V2LON,"10",*HOFF: 
                    ". Don't display encoder interface birth weight: ":
                    *P1:14,*V2LON,"11",*HOFF: 
                    ". Print two lines of accommodation desc.(Y/N)?: ":
                    *P1:15,*V2LON,"12",*HOFF: 
                    ". Messages if DRG not allocated (Sameday)     : ":
                    *P1:16,*V2LON,"13",*HOFF: 
                    ". Messages if DRG not allocated (MSO)         : ":
                    *P1:17,*V2LON,"14",*HOFF: 
                    ". Admission type or Bed type in NCF extract ? : ":
                    *P1:18,*V2LON,"15",*HOFF: 
                    ". Print H.F.C.F. in admission programs (Y/N)? : ":
                    *P1:19,*V2LON,"16",*HOFF: 
                    ". Print H.F.C.F. in discharge program (Y/N)?  : ":
                    *P1:20,*V2LON,"17",*HOFF: 
                    ". HDP - Employment status                     : ":
                    *P1:21,*V2LON,"18",*HOFF: 
                    ". HDP - Occupation                            : ":
                    *P1:22,*V2LON,"19",*HOFF: 
                    ". HDP - Mental Health Legal Status(D1-D5,6=CC): ":
                    *P1:23,*V2LON,"20",*HOFF: 
                    ". Which UDF for Carer Availability(D1-D5,6=VK): ":
                    *P52:4,*V2LON,PTCNRORC,*HOFF,*P56:4,DRORC:
                    *P52:5,*V2LON,PTCNUVTH,*HOFF,SP1,DESCUVTH:
                    *P52:6,*V2LON,PTCNPALC,*HOFF,SP1,DESCPALC:
                    *P52:7,*V2LON,PTCNFINP,*HOFF,SP1,DESC20A:
                    *P52:8,*V2LON,DANS1:
                    *P52:9,*V2LON,DANS2:
                    *P52:10,*V2LON,PTCNACCF,*HOFF,SP1,DESC20B:
                    *P52:11,*V2LON,PTCNHADF,*HOFF,SP1,DESC20C:
                    *P52:12,*V2LON,KEY3:
                    *P52:13,*V2LON,DANS13:
                    *P52:14,*V2LON,DIM24:
                    *P52:15,*V2LON,DDRGSDY:
                    *P52:16,*V2LON,DDRGMSO:
                    *P52:17,*V2LON,PTCNNCFB,*HOFF,*P57:17,DIM15:
                    *P52:18,*V2LON,DANS5:
                    *P52:19,*V2LON,DANS6:
                    *P52:20,*V2LON,PTCNEMPL,*HOFF,*P57:20,*HOFF,EMPLDESC:
                    *P52:21,*V2LON,PTCNOCCP,*HOFF,*P57:21,*HOFF,OCCPDESC:
                    *P52:22,*V2LON,PTCNCSTA,*HOFF,*P57:22,*HOFF,CTYPDESC:
                    *P52:23,*V2LON,PTCNCRAY,*HOFF,*P57:23,*HOFF,CRAYDESC;
          RETURN
.***************************************************************************
. ----- Display Hospital Screen 20 -----
.***************************************************************************
DSPHOS20  MOVE      ZERO,PTCNAFLG
          MOVE      ZERO,PTCNCLNO
          MOVE      SP3,PTCNRQDF
          READ      CONTROLF,NINTY8;*71,PTCNAFLG,*76,PTCNCLNO,*84,PTCNCSRL
          READ      CONTROLF,NINTY8;*85,PTCNPSOS
          READ      CONTROLF,NINTY8;*121,PTCNRQDF
          READ      CONTROLF,NINTY8;*124,PTCNHPCD,PTCNPMIS:
                                    *129,PTCNDGST,PTCNAGST,*136,PTCNPAIH:
                                    *142,PTCNPAIT,*148,PTCNINVB
          READ      CONTROLF,HUND05;*66,PTCNUSQL,*69,PTCNPLFI:
                                    *71,PTCNCMAU,*73,PTCNCMDU:
                                    *98,PTCNCMYN,*99,PTCNNWCM
.
          MOVE      SP30,AFLGDESC
          PACK      KEY15,SCRPRGID,SCRPSCID,PTCNAFLG
          CALL      RDSCFL1                           * get description
          IF        OVRCD <> 1
            MOVE    SCFLDES,AFLGDESC
          ENDIF
.
          MOVE      SP30,CLNODESC
          PACK      KEY15,SCRPRGID,SCRPSCID,PTCNCLNO 
          CALL      RDSCFL1                           * get description
          IF        OVRCD <> 1
            MOVE    SCFLDES,CLNODESC
          ENDIF
.
          LOAD      CSRLDESC,PTCNCSRL,CODEW1,CODEW2,CODEW3,CODEW4:
                                      CODEX5,CODEX6,CODEX7,CODEX8,CODES
.
          MOVE      "Invalid Code ",RQDFDESC
          PACK      KEY5,CATRQ,PTCNRQDF    * Cat RQ Default
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      TDESC,RQDFDESC
          ENDIF
.
          MOVE      "Invalid Code ",HPCDDESC
          PACK      KEY5,CATHP,PTCNHPCD
          CALL      RDCODE1
          IF        OVRCD<>1
            MATCH     SP3,PTCNHPCD
            IF        !@EQUAL
              MOVE      TDESC,HPCDDESC
            ELSE
              MOVE      SP30,HPCDDESC
            ENDIF 
          ENDIF
.
          COMPARE   ZERO,PTCNPMIS
          IF        @EQUAL
            MOVE      "No",PMISDESC
          ELSE
            COMPARE   ONE,PTCNPMIS
            IF        @EQUAL
              MOVE     "Yes",PMISDESC
            ENDIF
          ENDIF
.
          MATCH     "N",PTCNDGST
          IF        @EQUAL
            MOVE      "No",DGSTDESC
          ELSE
            MATCH     "Y",PTCNDGST
            IF        @EQUAL
              MOVE     "Yes",DGSTDESC
            ENDIF
          ENDIF
.
          MOVE      "Invalid Code ",AGSTDESC
          PACK      KEY6,PTCNAGST
          CALL      RDIBGS1
          IF        OVRCD<>1
            MATCH     SP6,PTCNAGST
            IF        !@EQUAL
              MOVE      IBGSDESC,AGSTDESC
            ELSE
              MOVE      SP30,AGSTDESC
            ENDIF
          ENDIF
.
          COMPARE   ZERO,PTCNUSQL
          IF        @EQUAL
            MOVE      "No",PSQLDESC
          ELSE
            COMPARE   ONE,PTCNUSQL
            IF        @EQUAL
              MOVE     "Yes",PSQLDESC
            ENDIF
          ENDIF
.
          MOVE      DPORTR,DANS10
          LOAD      DANS10,PTCNINVB,DLANDC,DLANDR
.
          COMPARE   ZERO,PTCNPLFI
          IF        @EQUAL
            MOVE      "No",PLFIDESC
          ELSE
            COMPARE   ONE,PTCNPLFI
            IF        @EQUAL
              MOVE     "Yes",PLFIDESC
            ENDIF
          ENDIF
.
          MOVE      DNO,DANS11
          LOAD      DANS11,PTCNCMYN,DYES
.
          MOVE      DNO,DANS12
          LOAD      DANS12,PTCNNWCM,DYES
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 20 ",*P1:3,*EF,*HOFF:
                    *P1:4,*V2LON," 1",*HOFF:
                    ". Admission field to capture Accident Flag   :":
                    *P1:5,*V2LON," 2",*HOFF:
                    ". Admission field to capture Claim Number    :":
                    *P1:6,*V2LON," 3",*HOFF:
                    ". Which field to capture Source of Referral  :":
                    *P1:7,*V2LON," 4",*HOFF:
                    ". Which Discharge UDF for Pension Status(1-5):":
                    *P1:8,*V2LON," 5",*HOFF:
                    ". Default code for Category RQ in EOC01      :":
                    *P1:9,*V2LON," 6",*HOFF:
                    ". Default Health Purchaser Code for Cat. HP  :":
                    *P1:10,*V2LON," 7",*HOFF:
                    ". Print Misc Charge Code on invoices (Y/N)   :":
                    *P1:12,*V2LON," 9",*HOFF:
                    ". Default 'Is GST applicable to this event?' :":
                    *P1:13,*V2LON,"10",*HOFF:
                    ". GST Code for Accommodation                 :":
                    *P1:14,*V2LON,"11",*HOFF:
                    ". User Defined Patient Invoice Header Code   :":
                    *P1:15,*V2LON,"12",*HOFF:
                    ". User Defined Patient Invoice Tail Code     :":
                    *P1:16,*V2LON,"13",*HOFF:
                    ". Print Body of Invoice                      :":
                    *P1:17,*V2LON,"14",*HOFF:
                    ". Using SQL Scripts (Y/N)                    :":
                    *P1:18,*V2LON,"15",*HOFF:
                    ". Print Lumpsum amount on Fees Invoiced (Y/N):":
                    *P1:19,*V2LON,"16",*HOFF:
                    ". No longer in use                           :":
                    *P1:20,*V2LON,"17",*HOFF:
                    ". No longer in use                           :":
                    *P1:21,*V2LON,"18",*HOFF:
                    ". No longer in use                           :":
                    *P1:22,*V2LON,"19",*HOFF:
                    ". Default 'Casemix Payment Yes/No' to        :":
                    *P1:23,*V2LON,"20",*HOFF:
                    ". Using Matrix for Casempayment billing?     :":
.
                    *P49:4,*V2LON,PTCNAFLG,*HOFF,*P56:4,AFLGDESC:
                    *P49:5,*V2LON,PTCNCLNO,*HOFF,*P56:5,CLNODESC:
                    *P53:6,*V2LON,PTCNCSRL,*HOFF,*P56:6,CSRLDESC:
                    *P53:7,*V2LON,PTCNPSOS,*HOFF:
                    *P53:8,*V2LON,PTCNRQDF,*HOFF,*P56:8,RQDFDESC:
                    *P53:9,*V2LON,PTCNHPCD,*HOFF,*P56:9,HPCDDESC:
                    *P51:10,*V2LON,PMISDESC,*HOFF:
                    *P51:12,*V2LON,DGSTDESC,*HOFF:
                    *P51:13,*V2LON,PTCNAGST,*HOFF,*P59:13,AGSTDESC:
                    *P51:14,*V2LON,PTCNPAIH,*HOFF:
                    *P51:15,*V2LON,PTCNPAIT,*HOFF:
                    *P51:16,*V2LON,DANS10,*HOFF:
                    *P51:17,*V2LON,PSQLDESC,*HOFF:
                    *P51:18,*V2LON,PLFIDESC,*HOFF:
                    *P51:22,*V2LON,DANS11,*HOFF:
                    *P51:23,*V2LON,DANS12,*HOFF;
          RETURN
+
.***************************************************************************
. ----- Display Hospital Screen 21 -----
.***************************************************************************
DSPHOS21  MOVE      ZERO,EXIT                                          *C-61562
          READ      CONTROLF,HUND05;*130,PTCNAUAT,PTCNWSPC:
                                         PTCNADB1,PTCNADB2,PTCNADB3,PTCNADB4:
                                         PTCNDFAN,*165,PTCNONLA:
                                         *168,PTCNTIMC,*173,PTCNICUT:
                                         *174,PTCNIOEV,*175,PTCNNULB:
                                         *180,PTCNTIMN,*189,PTCNPRCL:
                                         *202,PTCNCPAH
          READ      CONTROLF,FIFTY9;*210,PTMBSINV
.
          MOVE      DNO,DANS2
          LOAD      DANS2,PTCNAUAT,DYES
          MOVE      DNO,DANS3
          LOAD      DANS3,PTCNWSPC,DYES
          MOVE      PTCNADB1,DANS4
          MOVE      PTCNADB2,DANS5
          MOVE      PTCNADB3,DANS6
          MOVE      PTCNADB4,DANS7
          MOVE      PTCNDFAN,DANS8
.
          MOVE      DNO,DANS12
          LOAD      DANS12,PTCNONLA,DYES,DWARN
.
          MOVE      DNO,DANS14
          LOAD      DANS14,PTCNICUT,DYES
.
          MOVE      DNO,DANS15
          LOAD      DANS15,PTCNIOEV,DYES
.
          MOVE      DNO,DANS16
          LOAD      DANS16,PTCNPRCL,DYES
.
          MOVE      DNO,DANS17
          LOAD      DANS17,PTMBSINV,DYES
.
          MOVE      DNO,DANS18
          LOAD      DANS18,PTCNCPAH,DYES
.
          MOVE      PTCNNULB,DIM2
          REP       " 0",DIM2 
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 21 ",*P1:3,*EF,*HOFF:
                    *P1:4,*V2LON," 1",*HOFF:
                    *P1:5,*V2LON," 2",*HOFF:
                    ". Automatic Update of Admission Type (Y/N)         :":
                    *P56:5,*V2LON,DANS2,*HOFF:
                    *P1:6,*V2LON," 3",*HOFF:
                    ". Warning for subsequent primary MBS changes (Y/N) :":
                    *P56:6,*V2LON,DANS3,*HOFF:
                    *P1:7,*V2LON," 4",*HOFF:
                    ". Automatic daycase band 1                         :":
                    *P56:7,*V2LON,DANS4,*HOFF:
                    *P1:8,*V2LON," 5",*HOFF:
                    ". Automatic daycase band 2                         :":
                    *P56:8,*V2LON,DANS5,*HOFF:
                    *P1:9,*V2LON," 6",*HOFF:
                    ". Automatic daycase band 3                         :":
                    *P56:9,*V2LON,DANS6,*HOFF:
                    *P1:10,*V2LON," 7",*HOFF:
                    ". Automatic daycase band 4                         :":
                    *P56:10,*V2LON,DANS7,*HOFF:
                    *P1:11,*V2LON," 8",*HOFF:
                    ". Default Anaesthetic Code for Day Procedure       :":
                    *P56:11,*V2LON,DANS8,*HOFF:
                    *P1:12,*V2LON," 9",*HOFF,".":                      *C-61562
                    *P1:13,*V2LON,"10",*HOFF,".":                      *C-61562
                    *P1:14,*V2LON,"11",*HOFF,".":                      *C-61562
                    *P1:15,*V2LON,"12",*HOFF:
                    ". Allow on leave bed allocation ?                  :":
                    *P56:15,*V2LON,DANS12,*HOFF:
                    *P1:16,*V2LON,"13",*HOFF:
                    ". Time to run current patient update               :":
                    *P56:16,*V2LON,PTCNTIMC,*HOFF:
                    *P1:17,*V2LON,"14",*HOFF:
                    ". Checking for an ICU/NCU Bed Type? (Y/N)          :":
                    *P56:17,*V2LON,DANS14,*HOFF:
                    *P1:18,*V2LON,"15",*HOFF:
                    ". Include Outpatient Events in VACS report? (Y/N)  :":
                    *P56:18,*V2LON,DANS15,*HOFF:
                    *P1:19,*V2LON,"16",*HOFF:
                    ". Type of Nutrition Label being Used               :":
                    *P56:19,*V2LON,DIM2,*HOFF:
                    *P1:20,*V2LON,"17",*HOFF:
                    ". Time to run nutrition update                     :":
                    *P56:20,*V2LON,PTCNTIMN,*HOFF:
                    *P1:21,*V2LON,"18",*HOFF:
                    ". Print Claim details for TAC,VET,MAB on Invoice?  :":
                    *P56:21,*V2LON,DANS16,*HOFF:
                    *P1:22,*V2LON,"19",*HOFF:
                    ". No MBS description on print invoices ?           :":
                    *P56:22,*V2LON,DANS17,*HOFF:
                    *P1:23,*V2LON,"20",*HOFF:
                    ". Write AH to current patient search?              :":
                    *P56:23,*V2LON,DANS18,*HOFF
.
          RETURN
+
.***************************************************************************
.* DSPHOS22 - Display Hospital Controlled PRS/2 Screen 1
.***************************************************************************
DSPHOS22  READ      CONTROLF,TWENTY;*53,PTCNPRS1,*63,PTCNPRS2,*210,PTCNMEDC
          READ      CONTROLF,EIGHTY8;*170,PTCNRNG1,*182,PTCNRNG2:
                                     *222,PTCNCDSC,*223,PTCN1ATS
          READ      CONTROLF,FIFTY9;*219,PTCNREPO
          READ      CONTROLF,SEVENTY7;*36,PTCNPRS3,PTCNDTE3,*220,PTCNEDRG
          READ      CONTROLF,NINTY8;*81,PTCNHCOD,*225,PTCNPRS4,*227,PTCNRNG4:
                                    *239,PTCNPRS5,*241,PTCNRNG5
          READ      CONTROLF,HUND05;*167,PTCNPRCC
          READ      CONTROLF,HUND09;*195,PTCNACAS,*224,PTCNPR3A,*226,PTCNRNG3  
.                                                                      *C-53150
          MOVE      DNO,DANS1
          LOAD      DANS1,PTCNMEDC,DYES,DNO
.
          MOVE      ZERO,FORM2
          MOVE      PTCNPRS1,FORM2
          MOVE      SP30,PRSREP1
          LOAD      PRSREP1,FORM2,PRSDESC1,PRSDESC2,PRSDESC3,PRSDESC4: *C-53150
                                  PRSDESC5,PRSDESC6,SP30,SP30:         *I-42453
                                  SP30,SP30,SP30,SP30:                 *I-42453
                                  PRSDES13                             *I-42453
.
          MOVE      SP7,PRS1DAT1
          MOVE      SP7,PRS1DAT2
          MOVE      SP10,PRS1DMY1                                      *I-42453
          MOVE      SP4,DIM4A
          UNPACK    PTCNRNG1,CCENT,CYEAR,CMON,XCENT,XYEAR,XMON
.
          MATCH     SP12,PTCNRNG1
          GOTO      DISPHP0E IF EQUAL
.
          MATCH     "000000000000",PTCNRNG1
          GOTO      DISPHP0E IF EQUAL
.
...       First look at last 4 digits of range for spaces
...       if they are then the centuary would contain the day.
...       ccyymmccyymm or ccyymmdd----.
...
          PACK      PRS1DAT1,XYEAR,XMON,SP4                            *I-42453
          MATCH     SP4,PRS1DAT1                                       *I-42453
          GOTO      DSPHP01A IF EQUAL                                  *I-42453
.
          PACK      PRS1DAT1,CMON,SLASH,CCENT,CYEAR
          PACK      PRS1DAT2,XMON,SLASH,XCENT,XYEAR
          MOVE      " to ",DIM4A
          GOTO      DISPHP0E
.
DSPHP01A  MOVE      SP4,DIM4A                                          *I-42453
          MOVE      SP7,PRS1DAT1                                       *I-42453
          MOVE      SP7,PRS1DAT2                                       *I-42453
          PACK      PRS1DMY1,XCENT,SLASH,CMON,SLASH,CCENT,CYEAR        *I-42453
.
DISPHP0E  MOVE      ZERO,FORM2
          MOVE      PTCNPRS2,FORM2
          MOVE      SP30,PRSREP2
          LOAD      PRSREP2,FORM2,PRSDESC1,PRSDESC2,PRSDESC3,PRSDESC4: *C-53150
                                  PRSDESC5,PRSDESC6,SP30,SP30:         *I-42453
                                  SP30,SP30,SP30,SP30:                 *I-42453
                                  PRSDES13                             *I-42453
.
          MOVE      SP7,PRS2DAT1
          MOVE      SP7,PRS2DAT2
          MOVE      SP10,PRS2DMY1                                      *I-42453
          MOVE      SP4,DIM4B
          UNPACK    PTCNRNG2,CCENT,CYEAR,CMON,XCENT,XYEAR,XMON
.
          MATCH     SP12,PTCNRNG2
          GOTO      DISPHP0F IF EQUAL
.
          MATCH     "000000000000",PTCNRNG2
          GOTO      DISPHP0F IF EQUAL
.
...       First look at last 4 digits of range for spaces
...       if they are then the centuary would contain the day.
...       ccyymmccyymm or ccyymmdd----.
...
          PACK      PRS2DAT1,XYEAR,XMON,SP4                            *I-42453
          MATCH     SP4,PRS2DAT1                                       *I-42453
          GOTO      DSPHP0FA IF EQUAL                                  *I-42453
.
          PACK      PRS2DAT1,CMON,SLASH,CCENT,CYEAR
          PACK      PRS2DAT2,XMON,SLASH,XCENT,XYEAR
          MOVE      " to ",DIM4B
          GOTO      DISPHP0F
.
DSPHP0FA  MOVE      SP4,DIM4B                                          *I-42453
          MOVE      SP7,PRS2DAT1                                       *I-42453
          MOVE      SP7,PRS2DAT2                                       *I-42453
          PACK      PRS2DMY1,XCENT,SLASH,CMON,SLASH,CCENT,CYEAR        *I-42453
.
.DISPHP0F  MOVE      DNO,DANS2
.          LOAD      DANS2,PTCNPRS3,DYES
..
.          UNPACK    PTCNDTE3,CCENT,CYEAR,CMON,CDAY
.          CALL      PACDATE
.          MOVE      CPCDATE,CENSDATE
.
DISPHP0F  MOVE      ZERO,FORM2                                         *I-52150
          MOVE      PTCNPR3A,FORM2
          MOVE      SP30,PRSREP3
          LOAD      PRSREP3,FORM2,PRSDESC1,PRSDESC2,PRSDESC3,PRSDESC4: *C-53150
                                  PRSDESC5,PRSDESC6,SP30,SP30:
                                  SP30,SP30,SP30,SP30:
                                  PRSDES13
.
          MOVE      SP7,PRS3DAT1
          MOVE      SP7,PRS3DAT2
          MOVE      SP10,PRS3DMY1                                      *I-42453
          MOVE      SP4,DIM4B
          UNPACK    PTCNRNG3,CCENT,CYEAR,CMON,XCENT,XYEAR,XMON
.
          MATCH     SP20,PTCNRNG3
          GOTO      DISPHPF1 IF EQUAL
.
          MATCH     "000000000000",PTCNRNG3
          GOTO      DISPHPF1 IF EQUAL
.
...       First look at last 4 digits of range for spaces
...       if they are then the centuary would contain the day.
...       ccyymmccyymm or ccyymmdd----.
...
          PACK      PRS3DAT1,XYEAR,XMON,SP4
          MATCH     SP4,PRS3DAT1
          GOTO      DSPHP0GA IF EQUAL
.
          PACK      PRS3DAT1,CMON,SLASH,CCENT,CYEAR
          PACK      PRS3DAT2,XMON,SLASH,XCENT,XYEAR
          MOVE      " to ",DIM4C
          GOTO      DISPHPF1
.
DSPHP0GA  MOVE      SP4,DIM4B
          MOVE      SP7,PRS3DAT1
          MOVE      SP7,PRS3DAT2
          PACK      PRS3DMY1,XCENT,SLASH,CMON,SLASH,CCENT,CYEAR
.                                                                  *end I-53150
DISPHPF1  MOVE      REPODES0,REPODESC
          LOAD      REPODESC,PTCNREPO,REPODES1,REPODES2
.
          MOVE      DNO,DANS9
          LOAD      DANS9,PTCNCDSC,DYES
.
          MOVE      DNO,DANS10
          LOAD      DANS10,PTCN1ATS,DYES
.
          MOVE      SP20,OPERDESC
          PACK      KEY9,PTCNEDRG,SP10
          CALL      RDPTICO1
          IF        OVRCD=1 & ICDRDVER>1
            CALL      RD10T9O1
          ENDIF
          IF        OVRCD=0
            MOVE      ODESC,OPERDESC
          ENDIF
.
DISPHP0G  MOVE      ZERO,FORM2
          MOVE      PTCNPRS4,FORM2
          MOVE      SP30,PRSREP4
          LOAD      PRSREP4,FORM2,PRSDESC1,PRSDESC2,PRSDESC3,PRSDESC4: *C-53150
                                  PRSDESC5,PRSDESC6,SP30,SP30:         *I-42453
                                  SP30,SP30,SP30,SP30:                 *I-42453
                                  PRSDES13                             *I-42453
.
          MOVE      SP7,PRS4DAT1
          MOVE      SP7,PRS4DAT2
          MOVE      SP10,PRS4DMY1                                      *I-42453
          MOVE      SP4,DIM4E
          UNPACK    PTCNRNG4,CCENT,CYEAR,CMON,XCENT,XYEAR,XMON
.
          MATCH     SP12,PTCNRNG4
          GOTO      DISPHP0H IF EQUAL
.
          MATCH     "000000000000",PTCNRNG4
          GOTO      DISPHP0H IF EQUAL
.
...       First look at last 4 digits of range for spaces
...       if they are then the centuary would contain the day.
...       ccyymmccyymm or ccyymmdd----.
...
          PACK      PRS4DAT1,XYEAR,XMON,SP4                            *I-42453
          MATCH     SP4,PRS4DAT1                                       *I-42453
          GOTO      DSPHP0HA IF EQUAL                                  *I-42453
.
          PACK      PRS4DAT1,CMON,SLASH,CCENT,CYEAR
          PACK      PRS4DAT2,XMON,SLASH,XCENT,XYEAR
          MOVE      " to ",DIM4E
          GOTO      DISPHP0H
.
DSPHP0HA  MOVE      SP4,DIM4E                                          *I-42453
          MOVE      SP7,PRS4DAT1                                       *I-42453
          MOVE      SP7,PRS4DAT2                                       *I-42453
          PACK      PRS4DMY1,XCENT,SLASH,CMON,SLASH,CCENT,CYEAR        *I-42453
.
DISPHP0H  MOVE      ZERO,FORM2
          MOVE      PTCNPRS5,FORM2
          MOVE      SP30,PRSREP5
          LOAD      PRSREP5,FORM2,PRSDESC1,PRSDESC2,PRSDESC3,PRSDESC4: *C-53150
                                  PRSDESC5,PRSDESC6,SP30,SP30:         *I-42453
                                  SP30,SP30,SP30,SP30:                 *I-42453
                                  PRSDES13                             *I-42453
.
          MOVE      SP7,PRS5DAT1
          MOVE      SP7,PRS5DAT2
          MOVE      SP10,PRS5DMY1                                      *I-42453
          MOVE      SP4,DIM4F
          UNPACK    PTCNRNG5,CCENT,CYEAR,CMON,XCENT,XYEAR,XMON
.
          MATCH     SP12,PTCNRNG5
          GOTO      DISPHP0I IF EQUAL
.
          MATCH     "000000000000",PTCNRNG5
          GOTO      DISPHP0I IF EQUAL
.
...       First look at last 4 digits of range for spaces
...       if they are then the centuary would contain the day.
...       ccyymmccyymm or ccyymmdd----.
...
          PACK      PRS5DAT1,XYEAR,XMON,SP4                            *I-42453
          MATCH     SP4,PRS5DAT1                                       *I-42453
          GOTO      DSPHP0IA IF EQUAL                                  *I-42453
.
          PACK      PRS5DAT1,CMON,SLASH,CCENT,CYEAR
          PACK      PRS5DAT2,XMON,SLASH,XCENT,XYEAR
          MOVE      " to ",DIM4F
          GOTO      DISPHP0I
.
DSPHP0IA  MOVE      SP4,DIM4F                                          *I-42453
          MOVE      SP7,PRS5DAT1                                       *I-42453
          MOVE      SP7,PRS5DAT2                                       *I-42453
          PACK      PRS5DMY1,XCENT,SLASH,CMON,SLASH,CCENT,CYEAR        *I-42453
.
DISPHP0I  MOVE      DNO,DANS11
          LOAD      DANS11,PTCNPRCC,DYES
.
          PACK      TDESC,SP20
          IF        PTCNACAS>0 & PTCNACAS<6
            PACK      KEY5,ANSD,PTCNACAS,SP3
          ELSE
            PACK      KEY5,ANSU,PTCNACAS,SP3
          ENDIF
          CALL      RDCODE1                 * Read a codes file record
          PACK      ACASDESC,TDESC,SP20
.
          DISPLAY   *P54:2,*EF,*V2LON,"- Hospital PRS/2 Screen",*HOFF:
                    *P1:04,*V2LON," 1",*HOFF:
                    ". Send Medicare Number for PRS2 (Y/N)        :":
                    *P1:05,*V2LON," 2",*HOFF:
                    ". PRS2 report code for 1st request           :":
                    *P1:06,*V2LON," 3",*HOFF:
                    ". PRS2 1st report request date range         :":
                    *P1:07,*V2LON," 4",*HOFF:
                    ". PRS2 report code for 2nd request           :":
                    *P1:08,*V2LON," 5",*HOFF:
                    ". PRS2 2nd report request date range         :":
                    *P1:09,*V2LON," 6",*HOFF:
                    ". PRS2 report code for 3rd request           :":
                    *P1:10,*V2LON," 7",*HOFF:
                    ". PRS2 3rd report request date range         :":
                    *P1:11,*V2LON," 8",*HOFF:
                    ". Reporting Option for PRS2                  :":
                    *P1:12,*V2LON," 9",*HOFF:
                    ". Collecting duration of stay in CCU?  (Y/N) :":
                    *P1:13,*V2LON,"10",*HOFF:
                    ". Allow 1st admin type be statistical? (Y/N) :":
                    *P1:14,*V2LON,"11",*HOFF:
                    ". Operation Code to Exclude from DRG Grouper :":
                    *P1:15,*V2LON,"12",*HOFF:
                    ". New Hospital code (after 01/07/99)         :":
                    *P1:16,*V2LON,"13",*HOFF:
                    ". PRS2 report code for 4th request           :":
                    *P1:17,*V2LON,"14",*HOFF:
                    ". PRS2 4th report request date range         :":
                    *P1:18,*V2LON,"15",*HOFF:
                    ". PRS2 report code for 5th request           :":
                    *P1:19,*V2LON,"16",*HOFF:
                    ". PRS2 5th report request date range         :":
                    *P1:20,*V2LON,"17",*HOFF:
                    ". Send Reason for Critical Care Transfer(Y/N):":
                    *P1:21,*V2LON,"18",*HOFF:
                    ". Which user defined for ACAS (D1-D5,U6-U7)  :";
.
          DISPLAY   *P50:4,*V2LON,DANS1:
                    *P50:5,PTCNPRS1,*HOFF,*P54:5,PRSREP1:
                    *P50:6,*V2LON,PRS1DAT1,*HOFF,DIM4A,*V2LON,PRS1DAT2:
                    *P50:7,PTCNPRS2,*HOFF,*P54:7,PRSREP2:
                    *P50:8,*V2LON,PRS2DAT1,*HOFF,DIM4B,*V2LON,PRS2DAT2:
.                   *P50:9,*V2LON,DANS2:
.                   *P50:10,*V2LON,CENSDATE:
                    *P50:9,PTCNPR3A,*HOFF,*P54:9,PRSREP3:              *C-53150
                    *P50:10,*V2LON,PRS3DAT1,*HOFF,DIM4C,*V2LON,PRS3DAT2:
                    *P50:11,*V2LON,REPODESC:
                    *P50:12,*V2LON,DANS9:
                    *P50:13,*V2LON,DANS10:
                    *P50:14,*V2LON,PTCNEDRG,*HOFF,SP1,OPERDESC:
                    *P50:15,*V2LON,PTCNHCOD:
                    *P50:16,PTCNPRS4,*HOFF,*P54:16,PRSREP4:
                    *P50:17,*V2LON,PRS4DAT1,*HOFF,DIM4E,*V2LON,PRS4DAT2:
                    *P50:18,PTCNPRS5,*HOFF,*P54:18,PRSREP5:
                    *P50:19,*V2LON,PRS5DAT1,*HOFF,DIM4F,*V2LON,PRS5DAT2:
                    *P50:20,*V2LON,DANS11:
                    *P51:21,*V2LON,PTCNACAS,*HOFF,*P57:21,*HOFF,ACASDESC;
.
          MATCH     "13",PTCNPRS1                                      *I-42453
          IF        @EQUAL
            DISPLAY   *P1:06,*V2LON," 3",*HOFF:
                      ". PRS2 1st report request date               :":
                      *P50:6,*EL,*V2LON,PRS1DMY1,*HOFF
          ELSE
            MATCH     "03",PTCNPRS1                                    *I-53150
            IF        @EQUAL
              DISPLAY   *P1:06,*V2LON," 3",*HOFF:
                        ". PRS2 1st report request date               :":
                        *P50:6,*EL,*V2LON,PRS1DMY1,*HOFF
            ELSE
              DISPLAY   *P1:06,*V2LON," 3",*HOFF:
                        ". PRS2 1st report request date range         :"
            ENDIF
          ENDIF
.
          MATCH     "13",PTCNPRS2                                      *I-42453
          IF        @EQUAL
            DISPLAY   *P1:08,*V2LON," 5",*HOFF:
                      ". PRS2 2nd report request date               :":
                      *P50:8,*EL,*V2LON,PRS2DMY1,*HOFF
          ELSE
            MATCH     "03",PTCNPRS2                                    *I-53150
            IF        @EQUAL
              DISPLAY   *P1:08,*V2LON," 5",*HOFF:
                        ". PRS2 2nd report request date               :":
                        *P50:8,*EL,*V2LON,PRS2DMY1,*HOFF
            ELSE
              DISPLAY   *P1:08,*V2LON," 5",*HOFF:
                        ". PRS2 2nd report request date range         :"
            ENDIF
          ENDIF
.
          MATCH     "13",PTCNPR3A                                      *I-53150
          IF        @EQUAL
            DISPLAY   *P1:10,*V2LON," 7",*HOFF:
                      ". PRS2 3rd report request date               :":
                      *P50:10,*EL,*V2LON,PRS3DMY1,*HOFF
          ELSE
            MATCH     "03",PTCNPR3A                                    *I-53150
            IF        @EQUAL
              DISPLAY   *P1:10,*V2LON," 7",*HOFF:
                        ". PRS2 3rd report request date               :":
                        *P50:10,*EL,*V2LON,PRS3DMY1,*HOFF
            ELSE
              DISPLAY   *P1:10,*V2LON," 7",*HOFF:
                        ". PRS2 3rd report request date range         :"
            ENDIF
          ENDIF
.
          MATCH     "13",PTCNPRS4                                      *I-42453
          IF        @EQUAL
            DISPLAY *P1:17,*V2LON,"14",*HOFF:
                    ". PRS2 4th report request date               :":
                    *P50:17,*EL,*V2LON,PRS4DMY1,*HOFF
          ELSE
            MATCH   "03",PTCNPRS4                                      *I-53150
            IF        @EQUAL
              DISPLAY *P1:17,*V2LON,"14",*HOFF:
                      ". PRS2 4th report request date               :":
                      *P50:17,*EL,*V2LON,PRS4DMY1,*HOFF
            ELSE
              DISPLAY *P1:17,*V2LON,"14",*HOFF:
                      ". PRS2 4th report request date range         :"
            ENDIF
          ENDIF
.
          MATCH     "13",PTCNPRS5                                      *I-42453
          IF        @EQUAL
            DISPLAY   *P1:19,*V2LON,"16",*HOFF:
                      ". PRS2 5th report request date               :":
                      *P50:19,*EL,*V2LON,PRS5DMY1,*HOFF
          ELSE
            MATCH     "03",PTCNPRS5                                    *I-53150
            IF        @EQUAL
              DISPLAY   *P1:19,*V2LON,"16",*HOFF:
                        ". PRS2 5th report request date               :":
                        *P50:19,*EL,*V2LON,PRS5DMY1,*HOFF
            ELSE
              DISPLAY   *P1:19,*V2LON,"16",*HOFF:
                        ". PRS2 5th report request date range         :"
            ENDIF
          ENDIF
.
          RETURN
.
.********************************************************************
.*  DSPHOS23  :  Hospital Controlled - Display State based PMI      *
.********************************************************************
DSPHOS23  READ      CONTROLF,HUND05;*2,PTCNTORG,*6,PTCNTOSX,*10,PTCNTOPQ:
                                    *14,PTCNTOAP,*18,PTCNTOUP,*22,PTCNTOMP
.
          DISPLAY   *P54:2,*V2LON,"- State Based PMI Screens",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". ":
                    "Timeout (in seconds) for Patient Registration      ":
                    *P1:05,*V2LON," 2",*HOFF,". ":
                    "                     for Surname & Sound X Query   ":
                    *P1:06,*V2LON," 3",*HOFF,". ":
                    "                     for Get Patient Query         ":   
                    *P1:07,*V2LON," 4",*HOFF,". ":
                    "                     for Adding a Patient          ":
                    *P1:08,*V2LON," 5",*HOFF,". ":
                    "                     for Updating a Patient        ":
                    *P1:09,*V2LON," 6",*HOFF,". ":
                    "                     for Merging a Patient         ":
                    *P57:04,": ",*V2LON,PTCNTORG,*HOFF:
                    *P57:05,": ",*V2LON,PTCNTOSX,*HOFF:
                    *P57:06,": ",*V2LON,PTCNTOPQ,*HOFF:
                    *P57:07,": ",*V2LON,PTCNTOAP,*HOFF:
                    *P57:08,": ",*V2LON,PTCNTOUP,*HOFF:
                    *P57:09,": ",*V2LON,PTCNTOMP,*HOFF;
.
          RETURN
.
.********************************************************************
.*  DSPHOS24  :  Hospital Controlled - Display HDP/PHDB             *
.********************************************************************
DSPHOS24  READ      CONTROLF,HUND05;*178,PTCNVETR,*185,PTCNELPS,*187,PTCNPPAL
.
          PACK      TDESC,SP20
          PACK      KEY5,PTCNVETR,SP3
          CALL      RDCODE1                 * Read the codes file
          PACK      VETRDESC,TDESC,SP20
.
          LOAD      ELPSCODE,PTCNELPS,CATU1,CATU2,CATU3,CATU4,CATU5,CATU6:
                             CATU7,CATU8,CATU9,CATV1,CATV2,CATCC,CATP:
                             CATVB                                     *I-54636
          PACK      KEY5,ELPSCODE,SP6
          CALL      RDCODE1
          IF        OVRCD<>0
            MOVE      "Invalid Code ",TDESC
          ENDIF
          PACK      ELPSDESC,TDESC,SP20
.
          PACK      TDESC,SP20
          PACK      KEY5,PTCNPPAL,SP3
          CALL      RDCODE1                 * Read the codes file
          PACK      PPALDESC,TDESC,SP20
.
          DISPLAY   *P54:2,*V2LON,"- HDP / PHDB Screen      ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". ":
                    "WA HDP - Veteran card                              :":
                    *P1:05,*V2LON," 2",*HOFF,". ":
                    "Category for Elective Patient Status               :":
                    *P1:06,*V2LON," 3",*HOFF,". ":
                    "Which UDF for Prev Non-admitted Palliative Patient :":   
                    *P58:04,*V2LON,PTCNVETR,*P61:04,*HOFF,VETRDESC:
                    *P58:05,*V2LON,ELPSCODE,*P61:05,*HOFF,ELPSDESC:
                    *P58:06,*V2LON,PTCNPPAL,*P61:06,*HOFF,PPALDESC
.
          RETURN
+
.********************************************************************
.*  DSPHOS25  :  Hospital Controlled - screen 25                    *
.********************************************************************
DSPHOS25  READ      CONTROLF,TEN;*104,PTCNMBSF                         *I-47385
          READ      CONTROLF,HUND05;*192,PTCNUBNK,*193,PTCNITXT,*194,PTCNPCOM:
                                    *195,PTCNLASR,*196,PTCNBLSI,*198,PTCNXLBI:
                                    *200,PTCNPJCI,*201,PTCNPFED,*210,PTCNLCLM:
                                    *212,PTCNHBID,*216,PTCNDWAW,*225,PTCNACCD
.
          READ      CONTROLF,HUND09;*159,PTCNUICF,*183,PTCNDMCC,*192,PTCNDMJC
.
          MOVE      DNO,DANS1
          LOAD      DANS1,PTCNUICF,DYES
.
          MOVE      DNO,DANS2
          LOAD      DANS2,PTCNUBNK,DYES
.
          MOVE      DNO,DANS3
          LOAD      DANS3,PTCNITXT,DYES
.
          MOVE      DNO,DANS4
          LOAD      DANS4,PTCNPCOM,DYES
.
          MOVE      DNO,DANS5
          LOAD      DANS5,PTCNLASR,DYES
.
          MOVE      DNO,DANS6
          LOAD      DANS6,PTCNPJCI,DYES
.
          MOVE      DNO,DANS7
          LOAD      DANS7,PTCNPFED,DYES
.
          MOVE      DYES,DANS8                                         *I-47385
          LOAD      DANS8,PTCNMBSF,DNO                                 *I-47385
.
          MOVE      SP20,KEY10
          MATCH     ANSA,PTCNLCLM
          IF        @EQUAL
            MOVE      "All Visits",KEY10
          ENDIF
          MATCH     ANSI,PTCNLCLM
          IF        @EQUAL
            MOVE      "Inpat.Only",KEY10
          ENDIF
.
          MATCH     ANSN,PTCNLCLM
          IF        @EQUAL
            MOVE      "No Default",KEY10
          ENDIF
.
.         Get the description for Journal Code for Pharmacy Interface
.
          MOVE      SP30,JOURDESC
          MATCH     SP3,PTCNDMJC
          IF        !@EQUAL
            MOVE      "Unknown Code",JOURDESC
            PACK      KEY5,ANSJ,SP1,PTCNDMJC
            CALL      RDCODE1
            IF        OVRCD = 0
              MOVE      TDESC,JOURDESC
            ENDIF
          ENDIF
.
.... I CAR 39616
          MOVE      DWAWDES0,DIM16
          LOAD      DIM16,PTCNDWAW,DWAWDES1
.... end I CAR 39616
.
          MOVE      EOCACCD0,DEOCACC
          LOAD      DEOCACC,PTCNACCD,EOCACCD1
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 25 ",*P1:3,*EF,*HOFF:
                    *P1:04,*V2LON," 1",*HOFF,". ":
                    "Using interim Health Fund Claim Forms? (Y/N)       :":
                    *P58:04,*V2LON,DANS1,*HOFF:
                    *P1:05,*V2LON," 2",*HOFF,". ":
                    "Using 'Banking has started...proceed?' message(Y/N):":
                    *P58:05,*V2LON,DANS2,*HOFF:
                    *P1:06,*V2LON," 3",*HOFF,". ":
                    "Write Invoice Layout 6 to a Text File ?            :":
                    *P58:06,*V2LON,DANS3,*HOFF:
                    *P1:07,*V2LON," 4",*HOFF,". ":
                    "Print Messages on original invoice ? (Y/N)         :":
                    *P58:07,*V2LON,DANS4,*HOFF:
                    *P1:08,*V2LON," 5",*HOFF,". ":
                    "Printing with a laser printer ?                    :":
                    *P58:08,*V2LON,DANS5,*HOFF:
                    *P1:09,*V2LON," 6",*HOFF,". ":
                    "No. of blank lines at the start of invoice         :":
                    *P58:09,*V2LON,PTCNBLSI,*HOFF:
                    *P1:10,*V2LON," 7",*HOFF,". ":
                    "No. of extra lines in the body of invoice          :":
                    *P58:10,*V2LON,PTCNXLBI,*HOFF:
                    *P1:11,*V2LON," 8",*HOFF,". ":
                    "Print Journal code on invoice ? (Y/N)              :":
                    *P58:11,*V2LON,DANS6,*HOFF:
                    *P1:12,*V2LON," 9",*HOFF,". ":
                    "Print Front End Deduction ?  (Y/N)                 :":
                    *P58:12,*V2LON,DANS7,*HOFF:
                    *P1:13,*V2LON,"10",*HOFF,". ":
                    "Last Claim default from All visits or Inpatients   :":
                    *P58:13,*V2LON,KEY10,*HOFF:
                    *P1:14,*V2LON,"11",*HOFF,". ":
                    "Default Misc. Charges Code for Pharmacy            :":
                    *P58:14,*V2LON,PTCNDMCC,*HOFF:
                    *P1:15,*V2LON,"12",*HOFF,". ":
                    "Default Journal Code for Pharmacy                  :":
                    *P58:15,*V2LON,PTCNDMJC,*HOFF,*P63:15,JOURDESC:    *I-47385
                    *P1:16,*V2LON,"13",*HOFF,". ":                     *I-47385
                    "Bill more than 6 MBS items? (Y/N)                  :":
                    *P58:16,*V2LON,DANS8,*HOFF:                        *I-47385
                    *P1:17,*V2LON,"14",*HOFF,". ":                     *I-48227
.                   "Hospital BPAY Identifier (1-3) digits              :":
.                   *P58:17,*V2LON,PTCNHBID,*HOFF:                     *I-48227
                    "(No longer in use)                                 :":
                    *P58:17,*V2LON,"",*HOFF:
                    *P1:18,*V2LON,"15",*HOFF,". ":                     *I-39616
                    "Default Ward to Admitting Ward:                    :":
                    *P58:18,*V2LON,DIM16:
                    *P1:19,*V2LON,"16",*HOFF,". ":
                    "ACC No. and Work Related for NMDS (INP08)          :":
                    *P58:19,*V2LON,DEOCACC
          RETURN
+
.********************************************************************
.*  DSPHOS26  :  Hospital Controlled - EDI screen 26                *
.********************************************************************
.
DSPHOS26  READ      CONTROLF,HUND10;*116,PTCNEDIH,*118,PTCNEDIO,*178,PTCNORIG:
                                    *228,PTCNHCCC,*242,PTCNMBRL
.
          MOVE      "Admission Type",DANS26
          IF        PTCNHCCC = 1
            MOVE      "Bed Type      ",DANS26
          ENDIF
.
          MOVE      "Unqualified Status",DANS29
          IF        PTCNMBRL = 1
            MOVE      "Baby's Date of Birth",DANS29
          ENDIF
.
          DISPLAY   *P54:2,*V2LON,"- Hospital EDI Screen ",*P1:3,*EF,*HOFF:
                    *P1:3,*EF:
                    *P1:4," 1. EDI Extract Outbound Path : ":
                    *P1:5," 2. EDI Hospital Code         : ":
                    *P1:6," 3. EDI Originator            : ":
                    *P1:7," 4. EDI Critical Care Source  : ":
                    *P1:8," 5. EDI Mother/Baby Link      : ":
                    *P33:4,*V2LON,PTCNEDIO:
                    *P33:5,*V2LON,PTCNEDIH:
                    *P33:6,*V2LON,PTCNORIG:
                    *P33:7,*V2LON,PTCNHCCC,*HOFF,*P40:7,DANS26:
                    *P33:8,*V2LON,PTCNMBRL,*HOFF,*P40:8,DANS29
.
          RETURN
+
.******************************************************************************
.* DSPHOS27 - Display Hospital Controlled PRS/2 Screen 2              *I-49016*
.******************************************************************************
DSPHOS27  READ      CONTROLF,HUND09;*208,PTCNRTCN,PTCNRTRQ,PTCNPRS6,PTCNRNG6
.
.  Reporting Type Control
.
          MATCH     ANSE,PTCNRTCN
          IF        @EQUAL
            MOVE      PRS2DSC1,PRS2DSC0                * Electronic Only
          ELSE
            MATCH     ANSB,PTCNRTCN
            IF        @EQUAL
              MOVE      PRS2DSC3,PRS2DSC0              * Electronic and Paper
            ELSE
              MOVE      ANSP,PTCNRTCN
              MOVE      PRS2DSC2,PRS2DSC0              * Paper Only (Default)
            ENDIF
          ENDIF
.
.  Reporting Type Request
.
          MATCH     ANSE,PTCNRTRQ
          IF        @EQUAL
            MOVE      PRS2DSC1,PRS2DSC4                * Electronic Only
          ELSE
            MATCH     ANSB,PTCNRTRQ
            IF        @EQUAL
              MOVE      PRS2DSC3,PRS2DSC4              * Electronic and Paper
            ELSE
              MOVE      ANSP,PTCNRTRQ
              MOVE      PRS2DSC2,PRS2DSC4              * Paper Only (Default)
            ENDIF
          ENDIF
.
.  PRS report code for 6th request and PRS 6th report request date range
.
          MOVE      ZERO,FORM2
          MOVE      PTCNPRS6,FORM2
          MOVE      SP30,PRSREP6
          LOAD      PRSREP6,FORM2,PRSDESC1,PRSDESC2,PRSDESC3,PRSDESC4: *C-53150
                                  PRSDESC5,PRSDESC6,SP30,SP30:         *I-42453
                                  SP30,SP30,SP30,SP30:                 *I-42453
                                  PRSDES13                             *I-42453
.
          MOVE      SP7,PRS6DAT1
          MOVE      SP7,PRS6DAT2
          MOVE      SP10,PRS6DMY1                                      *I-42453
          MOVE      SP4,DIM4G
          UNPACK    PTCNRNG6,CCENT,CYEAR,CMON,XCENT,XYEAR,XMON
.
          MATCH     SP20,PTCNRNG6
          GOTO      DSPHPR22 IF EQUAL
.
          MATCH     "000000000000",PTCNRNG6
          GOTO      DSPHPR22 IF EQUAL
.
...       First look at last 4 digits of range for spaces
...       if they are then the centuary would contain the day.
...       ccyymmccyymm or ccyymmdd----.
...
          PACK      PRS6DAT1,XYEAR,XMON,SP4                            *I-42453
          MATCH     SP4,PRS6DAT1                                       *I-42453
          GOTO      DSPHPR21 IF EQUAL                                  *I-42453
.
          PACK      PRS6DAT1,CMON,SLASH,CCENT,CYEAR
          PACK      PRS6DAT2,XMON,SLASH,XCENT,XYEAR
          MOVE      " to ",DIM4G
          GOTO      DSPHPR22
.
DSPHPR21  MOVE      SP4,DIM4G                                          *I-42453
          MOVE      SP7,PRS6DAT1                                       *I-42453
          MOVE      SP7,PRS6DAT2                                       *I-42453
          PACK      PRS6DMY1,XCENT,SLASH,CMON,SLASH,CCENT,CYEAR        *I-42453
.
DSPHPR22  CALL      DISPLIN2
          DISPLAY   *P54:2,*+,*V2LON," - HOSPITAL PRS/2 SCREEN 2",*HOFF:
                    *P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF:
                    ". Reporting Type Control             (E,P,B) :":
                    *P1:05,*V2LON," 2",*HOFF:
                    ". Reporting Type for Request Reports (E,P,B) :":
                    *P1:06,*V2LON," 3",*HOFF:
                    ". PRS2 report code for 6th request           :":
                    *P1:07,*V2LON," 4",*HOFF:
                    ". PRS2 6th report request date range         :";
.
          DISPLAY   *P50:4,*V2LON,PTCNRTCN,*HOFF,*P54:4,PRS2DSC0:
                    *P50:5,*V2LON,PTCNRTRQ,*HOFF,*P54:5,PRS2DSC4:
                    *P50:6,*V2LON,PTCNPRS6,*HOFF,*P54:6,PRSREP6:
                    *P50:7,*V2LON,PRS6DAT1,*HOFF,DIM4G,*V2LON,PRS6DAT2;
.
          MATCH     "13",PTCNPRS6                                      *I-42453
          IF        @EQUAL
            DISPLAY   *P1:07,*V2LON," 4",*HOFF:
                      ". PRS2 6th report request date               :":
                      *P50:7,*EL,*V2LON,PRS6DMY1,*HOFF
          ELSE
            MATCH     "03",PTCNPRS6                                    *I-53150
            IF        @EQUAL
              DISPLAY   *P1:07,*V2LON," 4",*HOFF:
                        ". PRS2 6th report request date               :":
                        *P50:7,*EL,*V2LON,PRS6DMY1,*HOFF
            ELSE
              DISPLAY   *P1:07,*V2LON," 4",*HOFF:
                        ". PRS2 6th report request date range         :"
            ENDIF
          ENDIF
.
          RETURN
+
.********************************************************************
.*  DSPHOS28  :  Display Hospital Controlled Screen 28              *  *I-49037
.********************************************************************
DSPHOS28  READ      CONTROLF,EIGHTY8;*59,PTCNI10D     * ICD10 ed1 date *I-49037
          READ      CONTROLF,NINTY8;*149,PTCNGDV2     * ICD10 ed2 date *I-49037
          READ      CONTROLF,HUND05;*217,PTCNGDV4:    * ICD10 ed4 date *I-49037
                                    *227,PTCNGDV5     * ICD10 ed5 date *I105244
          READ      CONTROLF,HUND12;*239,PTCNGDV6     * ICD10 ed.6    *I-163918
          READ      CONTROLF,HUND09;*151,PTCNGDV3     * ICD10 ed3 date *I-49037
          READ      CONTROLF,HUND10;*61,PTCNGDV7:     * ICD10 ed.7    *I-219246
                                    *69,PTCNGDV8      * ICD10 ed.8    *I-284420
.
          READ      CONTROLF,TEN;*105,PTCNU50G,*106,PTCNC50C:          *M-61562
                                 *109,PTCNC42C,*112,PTCNC41C:          *M-61562
                                 *132,PTCNU60G,*133,PTCNC60C:         *I-197814
                                 *140,PTCNU51G,*141,PTCNC51C:          *I-61562
                                 *144,PTCNU52G,*145,PTCNC52C:         *I-137125
                                 *152,PTCNU62G,*153,PTCNC62C          *I-267797
.
          READ      CONTROLF,HUND05;*104,PTCNDGET:
                                    *162,PTCNU41G,*163,PTCNU42G        *M-61562
.
.
          UNPACK    PTCNI10D,CCENT,CYEAR,CMON,CDAY                     *I-49037
          CALL      PACDATE
          MOVE      CPCDATE,I10DATE
.
          UNPACK    PTCNGDV2,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,DSPGDV2
.
          UNPACK    PTCNGDV3,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,DSPGDV3
.
          UNPACK    PTCNGDV4,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,DSPGDV4
.
          UNPACK    PTCNGDV5,CCENT,CYEAR,CMON,CDAY                    *I-105244
          CALL      PACDATE
          MOVE      CPCDATE,DSPGDV5
.
          UNPACK    PTCNGDV6,CCENT,CYEAR,CMON,CDAY                    *I-163918
          CALL      PACDATE
          MOVE      CPCDATE,DSPGDV6
.
          UNPACK    PTCNGDV7,CCENT,CYEAR,CMON,CDAY                    *I-219246
          CALL      PACDATE
          MOVE      CPCDATE,DSPGDV7
.
          UNPACK    PTCNGDV8,CCENT,CYEAR,CMON,CDAY                    *I-284420
          CALL      PACDATE
          MOVE      CPCDATE,DSPGDV8
.
          MOVE      DNO,DANS23
          LOAD      DANS23,PTCNU41G,DYES
.
          MOVE      DNO,DANS24
          LOAD      DANS24,PTCNU42G,DYES
.
          MOVE      DNO,DANS25
          MATCH     "1",PTCNU50G
          IF        @EQUAL
            MOVE      DYES,DANS25
          ENDIF
.
          MOVE      DNO,DANS28
          MATCH     "1",PTCNU51G
          IF        @EQUAL
            MOVE      DYES,DANS28
          ENDIF
.
          MOVE      DNO,DANS20
          MATCH     "1",PTCNU52G                                      *I-137125
          IF        @EQUAL
            MOVE      DYES,DANS20
          ENDIF
.
          MOVE      DNO,DANS21
          MATCH     "1",PTCNU60G                                      *I-197814
          IF        @EQUAL
            MOVE      DYES,DANS21
          ENDIF
.
          MOVE      DNO,DANS22
          MATCH     "1",PTCNU62G                                      *I-267797
          IF        @EQUAL
            MOVE      DYES,DANS22
          ENDIF
.
          MOVE      DNO,DANS1
          LOAD      DANS1,PTCNDGET,DYES
.
          DISPLAY   *P54:2,*V2LON,"- Hospital Screen 28",*P1:3,*EF:
                    *HOFF:
                    *P1:4,*V2LON," 1. ",*HOFF:
                          "ICD10 Edition 1 Go-Live Date                  :":
                    *P1:5,*V2LON," 2. ",*HOFF:
                          "ICD10 Edition 2 Go-Live Date                  :":
                    *P1:6,*V2LON," 3. ",*HOFF:
                          "ICD10 Edition 3 Go-Live Date                  :":
                    *P1:7,*V2LON," 4. ",*HOFF:
                          "ICD10 Edition 4 Go-Live Date                  :":
                    *P1:8,*V2LON," 5. ",*HOFF:
                          "ICD10 Edition 5 Go-Live Date                  :":
                    *P1:9,*V2LON," 6. ",*HOFF:
                          "ICD10 Edition 6 Go-Live Date                  :":
                    *P1:10,*V2LON," 7. ",*HOFF:
                          "ICD10 Edition 7 Go-Live Date                  :":
                    *P1:11,*V2LON," 8. ",*HOFF:
                          "ICD10 Edition 8 Go-Live Date                  :":
                   *P1:12," 9. ":
                   *P1:13,*V2LON,"10. ",*HOFF:
                          "Using 4.1 Grouper? (Y/N)                      :":
                   *P1:14,*V2LON,"11. ",*HOFF:
                          "Using 4.2 Grouper? (Y/N)                      :":
                   *P1:15,*V2LON,"12. ",*HOFF:
                          "Using 5.0 Grouper? (Y/N)                      :":
                   *P1:16,*V2LON,"13. ",*HOFF:
                          "Using 5.1 Grouper? (Y/N)                      :":
                   *P1:17,*V2LON,"14. ",*HOFF:
                          "Using 5.2 Grouper? (Y/N)                      :":
                   *P1:18,*V2LON,"15. ",*HOFF:
                          "Using 6.0 Grouper? (Y/N)                      :":
                   *P1:19,*V2LON,"16. ",*HOFF:                        *I-267797
                          "Using 6.2 Grouper? (Y/N)                      :":
                   *P1:20,"17. ":
                   *P1:21,*V2LON,"18. ",*HOFF:
                          "Delete Grouper and Encoder Tempfiles (Y/N)    :":
.
                    *P53:4,*V2LON,I10DATE:                             *I-49037
                    *P53:5,*V2LON,DSPGDV2:                             *I-49037
                    *P53:6,*V2LON,DSPGDV3:                             *I-49037
                    *P53:7,*V2LON,DSPGDV4:                             *I-49037
                    *P53:8,*V2LON,DSPGDV5:                             *I105244
                    *P53:9,*V2LON,DSPGDV6:                            *I-163918
                    *P53:10,*V2LON,DSPGDV7:                           *I-219246
                    *P53:11,*V2LON,DSPGDV8:                           *I-284420
.
                    *P53:13,*V2LON,DANS23:
                    *P53:14,*V2LON,DANS24:
                    *P53:15,*V2LON,DANS25:
                    *P53:16,*V2LON,DANS28:
                    *P53:17,*V2LON,DANS20:                            *I-137125
                    *P53:18,*V2LON,DANS21:                            *I-197814
                    *P53:19,*V2LON,DANS22:                            *I-267797
                    *P53:21,*V2LON,DANS1  
.
          IF        PTCNU41G = 1
            DISPLAY   *P61:13,"3M Code: ",*P70:13,*V2LON,PTCNC41C,*HOFF
          ENDIF
.
          IF        PTCNU42G = 1
            DISPLAY   *P61:14,"3M Code: ",*P70:14,*V2LON,PTCNC42C,*HOFF
          ENDIF
.
          MATCH     "1",PTCNU50G
          IF        @EQUAL
            DISPLAY   *P61:15,"3M Code: ",*P70:15,*V2LON,PTCNC50C,*HOFF
          ENDIF
.
          MATCH     "1",PTCNU51G
          IF        @EQUAL
            DISPLAY   *P61:16,"3M Code: ",*P70:16,*V2LON,PTCNC51C,*HOFF
          ENDIF
.
          MATCH     "1",PTCNU52G                                      *I-137125
          IF        @EQUAL
            DISPLAY   *P61:17,"3M Code: ",*P70:17,*V2LON,PTCNC52C,*HOFF
          ENDIF
.
          MATCH     "1",PTCNU60G                                      *I-197814
          IF        @EQUAL
            DISPLAY   *P61:18,"3M Code: ",*P70:18,*V2LON,PTCNC60C,*HOFF
          ENDIF
.
          MATCH     "1",PTCNU62G                                      *I-267797
          IF        @EQUAL
            DISPLAY   *P61:19,"3M Code: ",*P70:19,*V2LON,PTCNC62C,*HOFF
          ENDIF
.
          RETURN
.
+
.****************************************************************************** 
.*        Updating Subroutines                                      
.******************************************************************************
UPAGE     CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS
.
          MOVE      SP3,PREVAGET
.
          BRANCH    CCITEM,KAGE1,KAGE2,KAGE3,KAGE4,KAGE5,KAGE6,KAGE7,KAGE8:
                          KAGE9,KAGE10,KAGE11,KAGE12,KAGE13,KAGE14,KAGE15:
                          KAGE16,KAGE17,KAGE18,KAGE19,KAGE20,KAGE21,KAGE22:
                          KAGE23,KAGE24
          BEEP
          GOTO      UPAGE
.
.------ keyin the first age group from value ------
.
KAGE1     KEYIN     *P21:5,*DV,SP10,*P21:5,*V2LON,*JR,PTCNAF01;
          ENDSET    PTCNAF01
          APPEND    SP3,PTCNAF01
          RESET     PTCNAF01
          DISPLAY   *P21:5,*V2LON,PTCNAF01;
          MOVE      PTCNAF01,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE1
.
          MOVE      PTCNAF01,AGEFROM
          MOVE      PTCNAT01,AGETO
.
          CALL      VAGF0000                * validate an age from variable
          BRANCH    EXIT,KAGE1
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the second age group from value ------
.
KAGE2     KEYIN     *P21:6,*DV,SP10,*P21:6,*V2LON,*JR,PTCNAF02;
          ENDSET    PTCNAF02
          APPEND    SP3,PTCNAF02
          RESET     PTCNAF02
          DISPLAY   *P21:6,*V2LON,PTCNAF02;
          MOVE      PTCNAF02,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE2
.
          MOVE      PTCNAT01,PREVAGET
          MOVE      PTCNAF02,AGEFROM
          MOVE      PTCNAT02,AGETO
.
          CALL      VAGF0000                * validate an age from variable
          BRANCH    EXIT,KAGE2
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the third age group from value ------
.
KAGE3     KEYIN     *P21:7,*DV,SP10,*P21:7,*V2LON,*JR,PTCNAF03;
          ENDSET    PTCNAF03
          APPEND    SP3,PTCNAF03
          RESET     PTCNAF03
          DISPLAY   *P21:7,*V2LON,PTCNAF03;
          MOVE      PTCNAF03,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE3
.
          MOVE      PTCNAT02,PREVAGET
          MOVE      PTCNAF03,AGEFROM
          MOVE      PTCNAT03,AGETO
.
          CALL      VAGF0000                * validate an age from variable
          BRANCH    EXIT,KAGE3
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the fourth age group from value ------
.
KAGE4     KEYIN     *P21:8,*DV,SP10,*P21:8,*V2LON,*JR,PTCNAF04;
          ENDSET    PTCNAF04
          APPEND    SP3,PTCNAF04
          RESET     PTCNAF04
          DISPLAY   *P21:8,*V2LON,PTCNAF04;
          MOVE      PTCNAF04,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE4
.
          MOVE      PTCNAT03,PREVAGET
          MOVE      PTCNAF04,AGEFROM
          MOVE      PTCNAT04,AGETO
.
          CALL      VAGF0000                * validate an age from variable
          BRANCH    EXIT,KAGE4
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the fifth age group from value ------
.
KAGE5     KEYIN     *P21:9,*DV,SP10,*P21:9,*V2LON,*JR,PTCNAF05;
          ENDSET    PTCNAF05
          APPEND    SP3,PTCNAF05
          RESET     PTCNAF05
          DISPLAY   *P21:9,*V2LON,PTCNAF05;
          MOVE      PTCNAF05,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE5
.
          MOVE      PTCNAT04,PREVAGET
          MOVE      PTCNAF05,AGEFROM
          MOVE      PTCNAT05,AGETO
.
          CALL      VAGF0000                * validate an age from variable
          BRANCH    EXIT,KAGE5
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the sixth age group from value ------
.
KAGE6     KEYIN     *P21:10,*DV,SP10,*P21:10,*V2LON,*JR,PTCNAF06;
          ENDSET    PTCNAF06
          APPEND    SP3,PTCNAF06
          RESET     PTCNAF06
          DISPLAY   *P21:10,*V2LON,PTCNAF06;
          MOVE      PTCNAF06,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE6
.
          MOVE      PTCNAT05,PREVAGET
          MOVE      PTCNAF06,AGEFROM
          MOVE      PTCNAT06,AGETO
.
          CALL      VAGF0000                * validate an age from variable
          BRANCH    EXIT,KAGE6
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the seventh age group from value ------
.
KAGE7     KEYIN     *P21:11,*DV,SP10,*P21:11,*V2LON,*JR,PTCNAF07;
          ENDSET    PTCNAF07
          APPEND    SP3,PTCNAF07
          RESET     PTCNAF07
          DISPLAY   *P21:11,*V2LON,PTCNAF07;
          MOVE      PTCNAF07,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE7
.
          MOVE      PTCNAT06,PREVAGET
          MOVE      PTCNAF07,AGEFROM
          MOVE      PTCNAT07,AGETO
.
          CALL      VAGF0000                * validate an age from variable
          BRANCH    EXIT,KAGE7
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the eighth age group from value ------
.
KAGE8     KEYIN     *P21:12,*DV,SP10,*P21:12,*V2LON,*JR,PTCNAF08;
          ENDSET    PTCNAF08
          APPEND    SP3,PTCNAF08
          RESET     PTCNAF08
          DISPLAY   *P21:12,*V2LON,PTCNAF08;
          MOVE      PTCNAF08,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE8
.
          MOVE      PTCNAT07,PREVAGET
          MOVE      PTCNAF08,AGEFROM
          MOVE      PTCNAT08,AGETO
.
          CALL      VAGF0000                * validate an age from variable
          BRANCH    EXIT,KAGE8
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the ninth age group from value ------
.
KAGE9     KEYIN     *P21:13,*DV,SP10,*P21:13,*V2LON,*JR,PTCNAF09;
          ENDSET    PTCNAF09
          APPEND    SP3,PTCNAF09
          RESET     PTCNAF09
          DISPLAY   *P21:13,*V2LON,PTCNAF09;
          MOVE      PTCNAF09,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE9
.
          MOVE      PTCNAT08,PREVAGET
          MOVE      PTCNAF09,AGEFROM
          MOVE      PTCNAT09,AGETO
.
          CALL      VAGF0000                * validate an age from variable
          BRANCH    EXIT,KAGE9
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the tenth age group from value ------
.
KAGE10    KEYIN     *P21:14,*DV,SP10,*P21:14,*V2LON,*JR,PTCNAF10;
          ENDSET    PTCNAF10
          APPEND    SP3,PTCNAF10
          RESET     PTCNAF10
          DISPLAY   *P21:14,*V2LON,PTCNAF10;
          MOVE      PTCNAF10,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE10
.
          MOVE      PTCNAT09,PREVAGET
          MOVE      PTCNAF10,AGEFROM
          MOVE      PTCNAT10,AGETO
.
          CALL      VAGF0000                * validate an age from variable
          BRANCH    EXIT,KAGE10
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the eleventh age group from value ------
.
KAGE11    KEYIN     *P21:15,*DV,SP10,*P21:15,*V2LON,*JR,PTCNAF11;
          ENDSET    PTCNAF11
          APPEND    SP3,PTCNAF11
          RESET     PTCNAF11
          DISPLAY   *P21:15,*V2LON,PTCNAF11;
          MOVE      PTCNAF11,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE11
.
          MOVE      PTCNAT10,PREVAGET
          MOVE      PTCNAF11,AGEFROM
          MOVE      PTCNAT11,AGETO
.
          CALL      VAGF0000                * validate an age from variable
          BRANCH    EXIT,KAGE11
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the twelfth age group from value ------
.
KAGE12    KEYIN     *P21:16,*DV,SP10,*P21:16,*V2LON,*JR,PTCNAF12;
          ENDSET    PTCNAF12
          APPEND    SP3,PTCNAF12
          RESET     PTCNAF12
          DISPLAY   *P21:16,*V2LON,PTCNAF12;
          MOVE      PTCNAF12,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE12
.
          MOVE      PTCNAT11,PREVAGET
          MOVE      PTCNAF12,AGEFROM
          MOVE      PTCNAT12,AGETO
.
          CALL      VAGF0000                * validate an age from variable
          BRANCH    EXIT,KAGE12
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the first age group to value ------
.
KAGE13    KEYIN     *P61:5,*DV,SP10,*P61:5,*V2LON,*JR,PTCNAT01;
          ENDSET    PTCNAT01
          APPEND    SP3,PTCNAT01
          RESET     PTCNAT01
          DISPLAY   *P61:5,*V2LON,PTCNAT01;
          MOVE      PTCNAT01,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE13
.
          MOVE      PTCNAF01,AGEFROM
          MOVE      PTCNAT01,AGETO
.
          CALL      VAGT0000                * validate an age to variable
          BRANCH    EXIT,KAGE13
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the second age group to value ------
.
KAGE14    KEYIN     *P61:6,*DV,SP10,*P61:6,*V2LON,*JR,PTCNAT02;
          ENDSET    PTCNAT02
          APPEND    SP3,PTCNAT02
          RESET     PTCNAT02
          DISPLAY   *P61:6,*V2LON,PTCNAT02;
          MOVE      PTCNAT02,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE14
.
          MOVE      PTCNAF02,AGEFROM
          MOVE      PTCNAT02,AGETO
.
          CALL      VAGT0000                * validate an age to variable
          BRANCH    EXIT,KAGE14
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the third age group to value ------
.
KAGE15    KEYIN     *P61:7,*DV,SP10,*P61:7,*V2LON,*JR,PTCNAT03;
          ENDSET    PTCNAT03
          APPEND    SP3,PTCNAT03
          RESET     PTCNAT03
          DISPLAY   *P61:7,*V2LON,PTCNAT03;
          MOVE      PTCNAT03,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE15
.
          MOVE      PTCNAF03,AGEFROM
          MOVE      PTCNAT03,AGETO
.
          CALL      VAGT0000                * validate an age to variable
          BRANCH    EXIT,KAGE15
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the fourth age group to value ------
.
KAGE16    KEYIN     *P61:8,*DV,SP10,*P61:8,*V2LON,*JR,PTCNAT04;
          ENDSET    PTCNAT04
          APPEND    SP3,PTCNAT04
          RESET     PTCNAT04
          DISPLAY   *P61:8,*V2LON,PTCNAT04;
          MOVE      PTCNAT04,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE16
.
          MOVE      PTCNAF04,AGEFROM
          MOVE      PTCNAT04,AGETO
.
          CALL      VAGT0000                * validate an age to variable
          BRANCH    EXIT,KAGE16
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the fifth age group to value ------
.
KAGE17    KEYIN     *P61:9,*DV,SP10,*P61:9,*V2LON,*JR,PTCNAT05;
          ENDSET    PTCNAT05
          APPEND    SP3,PTCNAT05
          RESET     PTCNAT05
          DISPLAY   *P61:9,*V2LON,PTCNAT05;
          MOVE      PTCNAT05,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE17
.
          MOVE      PTCNAF05,AGEFROM
          MOVE      PTCNAT05,AGETO
.
          CALL      VAGT0000                * validate an age to variable
          BRANCH    EXIT,KAGE17
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the sixth age group to value ------
.
KAGE18    KEYIN     *P61:10,*DV,SP10,*P61:10,*V2LON,*JR,PTCNAT06;
          ENDSET    PTCNAT06
          APPEND    SP3,PTCNAT06
          RESET     PTCNAT06
          DISPLAY   *P61:10,*V2LON,PTCNAT06;
          MOVE      PTCNAT06,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE18
.
          MOVE      PTCNAF06,AGEFROM
          MOVE      PTCNAT06,AGETO
.
          CALL      VAGT0000                * validate an age to variable
          BRANCH    EXIT,KAGE18
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the seventh age group to value ------
.
KAGE19    KEYIN     *P61:11,*DV,SP10,*P61:11,*V2LON,*JR,PTCNAT07;
          ENDSET    PTCNAT07
          APPEND    SP3,PTCNAT07
          RESET     PTCNAT07
          DISPLAY   *P61:11,*V2LON,PTCNAT07;
          MOVE      PTCNAT07,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE19
.
          MOVE      PTCNAF07,AGEFROM
          MOVE      PTCNAT07,AGETO
.
          CALL      VAGT0000                * validate an age to variable
          BRANCH    EXIT,KAGE19
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the eighth age group to value ------
.
KAGE20    KEYIN     *P61:12,*DV,SP10,*P61:12,*V2LON,*JR,PTCNAT08;
          ENDSET    PTCNAT08
          APPEND    SP3,PTCNAT08
          RESET     PTCNAT08
          DISPLAY   *P61:12,*V2LON,PTCNAT08;
          MOVE      PTCNAT08,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE20
.
          MOVE      PTCNAF08,AGEFROM
          MOVE      PTCNAT08,AGETO
.
          CALL      VAGT0000                * validate an age to variable
          BRANCH    EXIT,KAGE20
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the ninth age group to value ------
.
KAGE21    KEYIN     *P61:13,*DV,SP10,*P61:13,*V2LON,*JR,PTCNAT09;
          ENDSET    PTCNAT09
          APPEND    SP3,PTCNAT09
          RESET     PTCNAT09
          DISPLAY   *P61:13,*V2LON,PTCNAT09;
          MOVE      PTCNAT09,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE21
.
          MOVE      PTCNAF09,AGEFROM
          MOVE      PTCNAT09,AGETO
.
          CALL      VAGT0000                * validate an age to variable
          BRANCH    EXIT,KAGE21
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the tenth age group to value ------
.
KAGE22    KEYIN     *P61:14,*DV,SP10,*P61:14,*V2LON,*JR,PTCNAT10;
          ENDSET    PTCNAT10
          APPEND    SP3,PTCNAT10
          RESET     PTCNAT10
          DISPLAY   *P61:14,*V2LON,PTCNAT10;
          MOVE      PTCNAT10,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE22
.
          MOVE      PTCNAF10,AGEFROM
          MOVE      PTCNAT10,AGETO
.
          CALL      VAGT0000                * validate an age to variable
          BRANCH    EXIT,KAGE22
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the eleventh age group to value ------
.
KAGE23    KEYIN     *P61:15,*DV,SP10,*P61:15,*V2LON,*JR,PTCNAT11;
          ENDSET    PTCNAT11
          APPEND    SP3,PTCNAT11
          RESET     PTCNAT11
          DISPLAY   *P61:15,*V2LON,PTCNAT11;
          MOVE      PTCNAT11,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE23
.
          MOVE      PTCNAF11,AGEFROM
          MOVE      PTCNAT11,AGETO
.
          CALL      VAGT0000                * validate an age to variable
          BRANCH    EXIT,KAGE23
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.------ keyin the twelfth age group to value ------
.
KAGE24    KEYIN     *P61:16,*DV,SP10,*P61:16,*V2LON,*JR,PTCNAT12;
          ENDSET    PTCNAT12
          APPEND    SP3,PTCNAT12
          RESET     PTCNAT12
          DISPLAY   *P61:16,*V2LON,PTCNAT12;
          MOVE      PTCNAT12,AGEKEYIN
.
          CALL      VGRP0000                * validate the age group entered
          BRANCH    EXIT,KAGE24
.
          MOVE      PTCNAF12,AGEFROM
          MOVE      PTCNAT12,AGETO
.
          CALL      VAGT0000                * validate an age to variable
          BRANCH    EXIT,KAGE24
.
          MOVE      ZERO,OVRCD
.
          GOTO      UPAGE
.
.**************************************************************************
.*                                  VGRP0000                              *
.*   Routine to validate the age group entered is a valid type, i.e. a    *
.*   year, month, day, or spaces                                          *
.**************************************************************************
VGRP0000  MOVE      FALSE,EXIT
          MOVE      THREE,AGETYPE           * default age type to year
.
          MATCH     SP3,AGEKEYIN            * spaces may be valid
          GOTO      VGRP9999 IF EQUAL
.
          TYPE      AGEKEYIN                * a number is valid
          GOTO      VGRP9999 IF EQUAL
.
          UNPACK    AGEKEYIN,DIM2,ANS
.
          TYPE      DIM2                    * if variable is not a number, the
          GOTO      VGRP9000 IF NOT EQUAL     first 2 characters must be
.
          MOVE      ONE,AGETYPE             * default age type to day
.
          MATCH     ANSD,ANS                * "D" is valid
          GOTO      VGRP9999 IF EQUAL
.
          MOVE      TWO,AGETYPE             * default age type to month
.
          MATCH     ANSM,ANS                * "M" is valid
          GOTO      VGRP9999 IF EQUAL
.
.------ invalid age group entered ------
.
VGRP9000  DISPLAY   *P1:24,*EL,*B,"Invalid age group entered - Hit <":
                           *V2LON,"ENTER",*HOFF,"> to continue";
          KEYIN     ANS;
          DISPLAY   *P1:24,*EL;
          MOVE      TRUE,EXIT
.
VGRP9999  RETURN
+
.**************************************************************************
.*                                  VAGF0000                              *
.*        Routine to validate an age from variable. i.e. lower limit      *
.**************************************************************************
VAGF0000  MOVE      FALSE,EXIT
.
          MATCH     SP3,AGEFROM             * see if the from limit is spaces
          GOTO      VAGF1000 IF NOT EQUAL
.
          MATCH     SP3,AGETO               * see if the to limit is spaces
          GOTO      VAGF9999 IF EQUAL
.
          MATCH     "000",AGETO             * see if the to limit is zeros
          GOTO      VAGF9999 IF EQUAL
.
          GOTO      VAGF9000
.
.------ the from limit entered is not spaces ------
.
VAGF1000  MATCH     SP3,PREVAGET            * see if the previous to limit 
          GOTO      VAGF9999 IF EQUAL         exists 
.
          MATCH     "000",PREVAGET          * see if the previous to limit is 
          GOTO      VAGF9999 IF EQUAL         zeros
.
          MOVE      THREE,PREVTYPE          * default age type to year
.
          TYPE      PREVAGET                * a number is valid
          GOTO      VAGF2000 IF EQUAL
.
          UNPACK    PREVAGET,DIM2,ANS
.
          MOVE      ONE,PREVTYPE            * default age type to day
.
          MATCH     ANSD,ANS                * "D" is valid
          GOTO      VAGF2000 IF EQUAL
.
          MOVE      TWO,PREVTYPE            * default age type to month
.
.------ see if this from limit is the same type as the previous to limit ------
.
VAGF2000  COMPARE   AGETYPE,PREVTYPE
          GOTO      VAGF9999 IF NOT EQUAL
.
          MATCH     AGEFROM,PREVAGET        * we have the same type so make 
          GOTO      VAGF9100 IF NOT LESS      sure ranges don't overlap
.
          GOTO      VAGF9999
.
.------ the from limit is invalid ------
.
VAGF9000  DISPLAY   *P1:24,*EL,*B,"Invalid age group entered - Hit <":
                           *V2LON,"ENTER",*HOFF,"> to continue";
          KEYIN     ANS;
          DISPLAY   *P1:24,*EL;
          MOVE      TRUE,EXIT
.
          GOTO      VAGF9999
.
.------ the from limit is not > the previous to limit of the same type ------
.
VAGF9100  DISPLAY   *P1:24,*EL,*B,"Error - age group included in a previous ":
                          "range - Hit <",*V2LON,"ENTER",*HOFF,"> to continue";
          KEYIN     ANS;
          DISPLAY   *P1:24,*EL;
          MOVE      TRUE,EXIT
.
VAGF9999  RETURN
+
.**************************************************************************
.*                                  VAGT0000                              *
.*        Routine to validate an age to variable. i.e. upper limit        *
.**************************************************************************
VAGT0000  MOVE      FALSE,EXIT
.
          MATCH     SP3,AGETO               * see if upper limit is spaces
          GOTO      VAGT1000 IF NOT EQUAL
.
          MATCH     SP3,AGEFROM             * see if lower limit is spaces
          GOTO      VAGT9999 IF EQUAL
.
          MATCH     "000",AGEFROM           * see if lower limit is zeros
          GOTO      VAGT9999 IF EQUAL
.
          GOTO      VAGT9000
.
.------ the to limit is not spaces ------
.
VAGT1000  MOVE      THREE,PREVTYPE          * default age type to year
.
          TYPE      AGEFROM                 * a number is valid
          GOTO      VAGT2000 IF EQUAL
.
          UNPACK    AGEFROM,DIM2,ANS
.
          MOVE      ONE,PREVTYPE            * default age type to day
.
          MATCH     ANSD,ANS                * "D" is valid
          GOTO      VAGT2000 IF EQUAL
.
          MOVE      TWO,PREVTYPE            * age type is month
.
.------ make sure the from limit and the to limit are the same type ------
.
VAGT2000  COMPARE   PREVTYPE,AGETYPE
          GOTO      VAGT9100 IF NOT EQUAL
.
          MATCH     AGEFROM,AGETO           * make sure a valid range has been
          GOTO      VAGT9999 IF NOT LESS      entered
.
.------ an invalid range has been entered for the current age group ------
.
VAGT9000  DISPLAY   *P1:24,*EL,*B,"Age group upper limit must not be < the":
                           " lower limit - Hit <",*V2LON,"ENTER",*HOFF:
                           "> to continue";
          KEYIN     ANS;
          DISPLAY   *P1:24,*EL;
          MOVE      TRUE,EXIT
.
          GOTO      VAGT9999
.
.------ the upper limit entered is not the same type as the lower limit ------
.
VAGT9100  DISPLAY   *P1:24,*EL,*B,"Upper Limit not the same type as the":
                           " lower limit - Hit <",*V2LON,"ENTER",*HOFF:
                           "> to continue";
          KEYIN     ANS;
          DISPLAY   *P1:24,*EL;
          MOVE      TRUE,EXIT
.
VAGT9999  RETURN
+
.**************************************************************************
.*                                  VHID0000                              *
.*      Validate the Hong Kong National Id to be of format xx999999       *
.**************************************************************************
VHID0000  UNPACK    VHKID,DIM2,DIM6          * Unpack into xx 999999
          TYPE      DIM2                     * Character Format ?
          GOTO      VHID9000 IF EQUAL        * No. Error
          MATCH     SP2,DIM2                 * Spaces ?
          GOTO      VHID9000 IF EQUAL        * Yes. Error
.
          TYPE      DIM6                     * Yes. Numeric Format ?
          GOTO      VHID9000 IF NOT EQUAL    * No. Error
          SQUEEZE   DIM6                     * Remove spaces
          MOVELPTR  DIM6,FORM1               * Save Logical Length
          COMPARE   SIX,FORM1                * 6 Numerics ?
          GOTO      VHID9000 IF NOT EQUAL    * No. Error
.
          MOVE      FALSE,EXIT               *      Yes. Exit = False 
          GOTO      VHID9999
.
VHID9000  DISPLAY   *P1:24,*B,"Invalid Hong Kong Id Format. ";
          CALL      HITENTER
          MOVE      TRUE,EXIT
.
VHID9999  RETURN
+
.**************************************************************************
.*                                  CAGE0000                              *
.*           Check each age group for the same type and a valid range     *
.*  N.B.  This is to cater for the situation where the user has changed   *
.*        the lower limit variable to a different type or value but has   *
.*        forgotten to change the upper limit variable as well            *
.**************************************************************************
CAGE0000  MOVE      FALSE,EXIT
          MOVE      ONE,FORM2
.
.------ get the next age group lower limit ------
.
CAGE0100  LOAD      AGEFROM,FORM2,PTCNAF01,PTCNAF02,PTCNAF03,PTCNAF04,PTCNAF05:
                                  PTCNAF06,PTCNAF07,PTCNAF08,PTCNAF09,PTCNAF10:
                                  PTCNAF11,PTCNAF12
.
          MOVE      THREE,AGETYPE           * default age type to year
.
          TYPE      AGEFROM                 * a number is valid
          GOTO      CAGE1000 IF EQUAL
.
          UNPACK    AGEFROM,DIM2,ANS
.
          MOVE      ONE,AGETYPE             * default age type to day
.
          MATCH     ANSD,ANS                * "D" is valid
          GOTO      CAGE1000 IF EQUAL
.
          MOVE      TWO,AGETYPE             * age type is month
.
.------ get the next age group upper limit ------
.
CAGE1000  LOAD      AGETO,FORM2,PTCNAT01,PTCNAT02,PTCNAT03,PTCNAT04,PTCNAT05:
                                PTCNAT06,PTCNAT07,PTCNAT08,PTCNAT09,PTCNAT10:
                                PTCNAT11,PTCNAT12
.
          MOVE      THREE,PREVTYPE          * default age type to year
.
          TYPE      AGETO                   * a number is valid
          GOTO      CAGE2000 IF EQUAL
.
          UNPACK    AGETO,DIM2,ANS
.
          MOVE      ONE,PREVTYPE            * default age type to day
.
          MATCH     ANSD,ANS                * "D" is valid
          GOTO      CAGE2000 IF EQUAL
.
          MOVE      TWO,PREVTYPE            * age type is month
.
.------ compare types for the given age group ------
.
CAGE2000  COMPARE   AGETYPE,PREVTYPE
          GOTO      CAGE9000 IF NOT EQUAL
.
          MATCH     AGEFROM,AGETO           * see if we have a valid range
          GOTO      CAGE9100 IF LESS 
.
          MATCH     SP3,AGEFROM             * see if lower limit exists
          GOTO      CAGE9100 IF EQUAL
.
          MATCH     "000",AGEFROM           * see if lower limit exists
          GOTO      CAGE9100 IF EQUAL
.
          ADD       ONE,FORM2
.
          COMPARE   TEN3,FORM2              * see if we have processed all 
          GOTO      CAGE9999 IF EQUAL         age groups
.
          GOTO      CAGE0100
.
.------ the upper limit for a given age group entered is not the same ------
.------ type as the lower limit ------
.
CAGE9000  DISPLAY   *P1:23,*EL,*B,"Upper Limit for age group ",*V2LON,FORM2:
                           *HOFF," is not the same type as the Lower Limit":
                    *P1:24,*EL,"Details will not be posted - Hit <",*V2LON:
                           "ENTER",*HOFF,"> to continue";
          KEYIN     ANS;
          DISPLAY   *P1:23,*EF;
          MOVE      TRUE,EXIT
.
          GOTO      CAGE9999
.
.------ the given age group is an inavalid range ------
.
CAGE9100  DISPLAY   *P1:23,*EL,*B,"Invalid range for age group ",*V2LON,FORM2:
                    *P1:24,*EL,*HOFF,"Details will not be posted - Hit <":
                           *V2LON,"ENTER",*HOFF,"> to continue";
          KEYIN     ANS;
          DISPLAY   *P1:23,*EF;
          MOVE      TRUE,EXIT
.
CAGE9999  RETURN
+
.*********************************************************************
.         update details on audit screen
.*********************************************************************
UPAUD     CALL      MAINQST
.
          MOVE      CCITEM,FIELD
          COMPARE   ZERO,FIELD
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS
          COMPARE   "30",FIELD
          GOTO      EKAUD IF NOT LESS
.
          MOVE      THREE,VERT
          MOVE      "26",COL
          ADD       FIELD,VERT
          COMPARE   "23",VERT
          GOTO      KAUDUP IF LESS
.
          MOVE      "66",COL
          SUB       "19",VERT
.
KAUDUP    KEYIN     *PCOL:VERT,*DV,SP10,*PCOL:VERT,*V2LON,ANS;
          REP       UPPLOW,ANS
.
          MATCH     "Y",ANS
          GOTO      KAUDYES IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KAUDNO IF EQUAL
.
          DISPLAY   *P40:24,*EL,*V2LON,*B:
                    "Invalid answer. Please enter Y or N. ";
          CALL      HITENTER
          GOTO      KAUDUP
.
EKAUD     BEEP
          GOTO      UPAUD
.
KAUDYES   MOVE      DYES,DANS
          MOVE      ZERO,AUDFLAG
          GOTO      KCHGAUD
.
KAUDNO    MOVE      DNO,DANS
          MOVE      ONE,AUDFLAG
.
KCHGAUD   STORE     AUDFLAG,FIELD,CAUDA,CAUDB,CAUDC,CAUDD,CAUDE:
                                  CAUDF,CAUDG,CAUDH,CAUDI,CAUDJ:
                                  CAUDK,CAUDL,CAUDM,CAUDN,CAUDO:
                                  CAUDP,CAUDQ,CAUDR,CAUDS,CAUDT:
                                  CAUDU,CAUDV,CAUDW,CAUDX,CAUDY:
                                  CAUDZ,CAUDA1,CAUDA2,CAUDMAMX
          DISPLAY   *PCOL:VERT,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPAUD
.
UPHOS     CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHOS1,KHOS2,KHOS3,KHOS4,KHOS5,KHOS6,KHOS7,KHOS8:
                          KHOS9,KHOS10,KHOS11,KHOS12,KHOS13,KHOS14,KHOS15:
                          KHOS16,KHOS17,KHOS18
          BEEP
          GOTO      UPHOS
.
KHOS1     KEYIN     *P40:4,*EL,*V2LON,CHADD1;
          DISPLAY   *P40:4,*EL,*V2LON,CHADD1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS2     KEYIN     *P40:5,*EL,*V2LON,CHADD2;
          DISPLAY   *P40:5,*EL,*V2LON,CHADD2;
.
          MOVE      TWO,SUBKYLIN            * 2nd address line keyin
          PACK      IBAADLN2,CHADD2,SP30,SP30
          PACK      IBAADLN3,SP30,SP30
          PROC      AUTOPCOD                * Auto generation of the postcode
          BRANCH    EXIT,KHOS2,KHOS2A
.
          MOVE      IBAPCOD,CHPOST
          DISPLAY   *P40:6,*V2LON,CHPOST;
.
KHOS2A    MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS3     KEYIN     *P40:6,*EL,*V2LON,*JR,CHPOST;
          DISPLAY   *P40:6,*EL,*V2LON,CHPOST;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS4     KEYIN     *P40:7,*EL,*V2LON,CHTELEB;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS5     KEYIN     *P40:8,*EL,*V2LON,CHPADD1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS6     KEYIN     *P40:9,*EL,*V2LON,CHPADD2;
.
          MOVE      TWO,SUBKYLIN            * 2nd address line keyin
          PACK      IBAADLN2,CHPADD2,SP30,SP30
          PACK      IBAADLN3,SP30,SP30
          PROC      AUTOPCOD                * Auto generation of the postcode
          BRANCH    EXIT,KHOS6,KHOS6A
.
          MOVE      IBAPCOD,CHPPOST
          DISPLAY   *P40:10,*V2LON,CHPPOST;
.
KHOS6A    MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS7     KEYIN     *P40:10,*EL,*V2LON,*JR,CHPPOST;
          DISPLAY   *P40:10,*EL,*V2LON,CHPPOST;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS8     KEYIN     *P40:11,*EL,*V2LON,CFILENO;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS9     KEYIN     *P40:12,*EL,*V2LON,CAPPRVNO;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS10    KEYIN     *P40:13,*EL,*V2LON,CHCSCOD;
          DISPLAY   *P40:13,*EL,*V2LON,CHCSCOD;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS11    KEYIN     *P41:14,*EL,*V2LON,CNOBEDS;
          DISPLAY   *P41:14,*EL,*V2LON,CNOBEDS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS12    KEYIN     *P43:15,*EL,*V2LON,CAGECOFF;
          DISPLAY   *P43:15,*EL,*V2LON,CAGECOFF;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS13    KEYIN     *P42:16,*EL,*V2LON,CMAXAGE;
          DISPLAY   *P42:16,*EL,*V2LON,CMAXAGE;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS14    KEYIN     *P43:17,*EL,*V2LON,CNOPORT;
          DISPLAY   *P43:17,*EL,*V2LON,CNOPORT;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS15    MOVE      ZERO,BRSTAY1
          KEYIN     *P40:18,*EL,*V2LON,BRSTAY1;
          DISPLAY   *P40:18,*EL,*V2LON,BRSTAY1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS16    MOVE      ZERO,BRSTAY2
          KEYIN     *P40:19,*EL,*V2LON,BRSTAY2;
          DISPLAY   *P40:19,*EL,*V2LON,BRSTAY2;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
KHOS17    MOVE      ZERO,BRSTAY3
          KEYIN     *P40:20,*EL,*V2LON,BRSTAY3;
          DISPLAY   *P40:20,*EL,*V2LON,BRSTAY3;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS
.
. ----- Hospital state for HDP extracts -----
.
KHOS18    MOVE      "1",HLEF
          MOVE      "23",HTOP
          MOVE      "80",HRIG
          MOVE      "24",HBOT
          CALL      GETSCR00                * Save the current screen
.
          DISPLAY   *P1:23,*EF,*V2LON,"0 ",*HOFF,HDP0,", ":
                               *V2LON,"1 ",*HOFF,HDP1,", ":
                               *V2LON,"2 ",*HOFF,HDP2,", ":
                               *V2LON,"3 ",*HOFF,HDP3,", ":
                               *V2LON,"4 ",*HOFF,HDP4,", ":
                               *V2LON,"5 ",*HOFF,HDP5,", ":
                               *V2LON,"6 ",*HOFF,HDP6,", ":
                               *V2LON,"7 ",*HOFF,HDP7,", ":
                               *V2LON,"8 ",*HOFF,HDP8,", ":
                               *V2LON,"9 ",*HOFF,HDP9;
.
KHOS1801  MOVE      SP1,KEY1
          MOVE      PTCNHDPS,KEY1
          KEYIN     *P40:21,*EL,*V2LON,*RV,KEY1;
.
          TYPE      KEY1
          GOTO      KHOS1802 IF NOT EQUAL   * Non numeric character, error
.
          MOVE      KEY1,FORM1
.
          COMPARE   ZERO,FORM1
          GOTO      KHOS1802 IF LESS        * < 0
.
          COMPARE   FORM1,NINE
          GOTO      KHOS1802 IF LESS        * > 9
.
          CALL      PUTSCR00                * Restore the previous screen
          MOVE      FORM1,PTCNHDPS
          MOVE      HDP0,KEY23
          LOAD      KEY23,PTCNHDPS,HDP1,HDP2,HDP3,HDP4,HDP5,HDP6,HDP7,HDP8,HDP9
          PACK      KEY23,KEY23,SP30
          DISPLAY   *P40:21,*V2LON,PTCNHDPS,*HOFF,SP2,KEY23;
          GOTO      UPHOS
.
KHOS1802  BEEP
          GOTO      KHOS1801
.
.
UPHOS2    CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS
.
          BRANCH    CCITEM,KHOS21,KHOS22,KHOS23,KHOS24,KHOS25,KHOS26,KHOS27:
                          KHOS28,KHOS29,KHOS210,KHOS211,KHOS212,KHOS213,KHOS214:
                          KHOS215,KHOS216,KHOS217,KHOS218,KHOS219
          BEEP
          GOTO      UPHOS2
.
KHOS21    DISPLAY   *P1:23,*EF,*P40:23,*V2LON,"1 =",*HOFF,CVIEW1,", ":
                               *V2LON,"2 =",*HOFF,CVIEW2,", ":
                               *V2LON,"3 =",*HOFF,CVIEW3,", " 
.
          MOVE      "Y",ANS
          KEYIN     *P40:4,*EL,*V2LON,*RV,ANS;
          DISPLAY   *P40:4,*V2LON,ANS;
          REP       "Y1N2",ANS
          MATCH     "1",ANS
          GOTO      KHOS21Y IF EQUAL
.
          MATCH     "2",ANS
          GOTO      KHOS21N IF EQUAL
.
          MATCH     "3",ANS
          GOTO      KHOS21V IF EQUAL
.
          BEEP
          GOTO      KHOS21
.
KHOS21Y   MOVE      ONE,CVIEWIP
          GOTO      KHOS21DS
.
KHOS21N   MOVE      TWO,CVIEWIP
          GOTO      KHOS21DS
.
KHOS21V   MOVE      THREE,CVIEWIP
          GOTO      KHOS21DS
.
KHOS21DS  MOVE      CVIEW2,DANS19
          LOAD      DANS19,CVIEWIP,CVIEW1,CVIEW2,CVIEW3
          DISPLAY   *P40:4,*EL,*V2LON,DANS19:
                    *P1:23,*EL;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
.
KHOS22    KEYIN     *P40:5,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS22Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS22N IF EQUAL
          BEEP
          GOTO      KHOS22
.
KHOS22Y   MOVE      ONE,CPRIMOP
          GOTO      KHOS22DS
.
KHOS22N   MOVE      TWO,CPRIMOP
.
KHOS22DS  LOAD      DANS,CPRIMOP,DYES,DNO
          DISPLAY   *P40:5,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
.
KHOS23    KEYIN     *P40:6,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS23Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS23N IF EQUAL
          BEEP
          GOTO      KHOS23
.
KHOS23Y   MOVE      ONE,CPRIMDS
          GOTO      KHOS23DS
.
KHOS23N   MOVE      TWO,CPRIMDS
.
KHOS23DS  LOAD      DANS,CPRIMDS,DYES,DNO
          DISPLAY   *P40:6,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
.
KHOS24    KEYIN     *P40:7,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS24Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS24N IF EQUAL
          BEEP
          GOTO      KHOS24
.
KHOS24Y   MOVE      ONE,CMEDCAR
          GOTO      KHOS24DS
.
KHOS24N   MOVE      TWO,CMEDCAR
.
KHOS24DS  LOAD      DANS,CMEDCAR,DYES,DNO
          DISPLAY   *P40:7,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
.
KHOS25    KEYIN     *P40:8,*EL,*V2LON,ANS;
          MATCH     "O",ANS
          GOTO      KHOS25O IF EQUAL
.
          MATCH     "S",ANS
          GOTO      KHOS25S IF EQUAL
          BEEP
          GOTO      KHOS25
.
KHOS25O   MOVE      ONE,CSPECCO
          GOTO      KHOS25DS
.
KHOS25S   MOVE      TWO,CSPECCO
.
KHOS25DS  LOAD      DANS10,CSPECCO,DOCCP,DSPEC
          DISPLAY   *P40:8,*EL,*V2LON,DANS10;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KHOS26    KEYIN     *P40:9,*EL,*V2LON,CLETPLN;
          DISPLAY   *P40:9,*V2LON,CLETPLN;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KHOS27    KEYIN     *P40:10,*EL,*V2LON,CLETLEN;
          COMPARE   SIX,CLETLEN
          GOTO      EKHOS27 IF LESS
          COMPARE   CLETLEN,CLETPLN
          GOTO      EKHOS27 IF LESS
          DISPLAY   *P40:10,*V2LON,CLETLEN;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
EKHOS27   DISPLAY   *P40:24,*EL,*B,*V2LON,"** Invalid Printing Page Length **":
                    *W2,*P40:24,*EL;
          GOTO      KHOS27
.
KHOS28    KEYIN     *P41:11,*EL,*V2LON,CLETTOP;
          COMPARE   ZERO,CLETTOP
          GOTO      EKHOS28 IF LESS
          COMPARE   CLETLEN,CLETTOP
          GOTO      EKHOS28 IF NOT LESS
          DISPLAY   *P41:11,*V2LON,CLETTOP;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
EKHOS28   DISPLAY   *P40:24,*EL,*B,*V2LON,"** Invalid Top Margin Size **":
                    *W2,*P40:24,*EL;
          GOTO      KHOS28
.
KHOS29    KEYIN     *P41:12,*EL,*V2LON,CLETTOA;
          COMPARE   ZERO,CLETTOA
          GOTO      EKHOS29 IF LESS
          COMPARE   "20",CLETTOA
          GOTO      EKHOS29 IF NOT LESS
          DISPLAY   *P41:12,*V2LON,CLETTOA;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
EKHOS29   DISPLAY   *P40:24,*EL,*B,*V2LON,"** Invalid Gap Size **":
                    *W2,*P40:24,*EL;
          GOTO      KHOS29
.
KHOS210   KEYIN     *P41:13,*EL,*V2LON,CLETTOS;
          COMPARE   ZERO,CLETTOS
          GOTO      EKHOS210 IF LESS
          COMPARE   "20",CLETTOS
          GOTO      EKHOS210 IF NOT LESS
          DISPLAY   *P41:13,*V2LON,CLETTOS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
EKHOS210  DISPLAY   *P40:24,*EL,*B,*V2LON,"** Invalid Gap Size **":
                    *W2,*P40:24,*EL;
          GOTO      KHOS210
.
KHOS211   KEYIN     *P41:14,*EL,*V2LON,CLETTOT;
          COMPARE   ZERO,CLETTOT
          GOTO      EKHOS211 IF LESS
          COMPARE   "20",CLETTOT
          GOTO      EKHOS211 IF NOT LESS
          DISPLAY   *P41:14,*V2LON,CLETTOT;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
EKHOS211  DISPLAY   *P40:24,*EL,*B,*V2LON,"** Invalid Gap Size **":
                    *W2,*P40:24,*EL;
          GOTO      KHOS211
.
KHOS212   KEYIN     *P41:15,*EL,*V2LON,CLETTAB;
          COMPARE   ZERO,CLETTAB
          GOTO      EKHOS212 IF LESS
          COMPARE   "30",CLETTAB
          GOTO      EKHOS212 IF NOT LESS
          DISPLAY   *P41:15,*V2LON,CLETTAB;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
EKHOS212  DISPLAY   *P40:24,*EL,*B,*V2LON,"** Invalid Left Margin Size **":
                    *W2,*P40:24,*EL;
          GOTO      KHOS212
.
KHOS213   KEYIN     *P42:16,*EL,*V2LON,CSECFEE;
          DISPLAY   *P42:16,*V2LON,CSECFEE;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KHOS214   KEYIN     *P41:17,*EL,*V2LON,COPRSIZ1;
          COMPARE   ZERO,COPRSIZ1
          GOTO      EKHOS214 IF LESS
          GOTO      EKHOS214 IF EQUAL
          DISPLAY   *P41:17,*V2LON,COPRSIZ1;
          MOVE      ZERO,OVRCD
.
          KEYIN     *P41:18,*EL,*V2LON,COPRSIZ2;
          COMPARE   ZERO,COPRSIZ2
          GOTO      EKHOS214 IF LESS
          GOTO      EKHOS214 IF EQUAL
.
          COMPARE   COPRSIZ2,COPRSIZ1
          GOTO      BKHOS214 IF NOT LESS
          DISPLAY   *P41:18,*V2LON,COPRSIZ2;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
BKHOS214  DISPLAY   *P40:24,*EL,*B,*V2LON,"** Operation Amount 2 > Amount 1 **":
                    *W2,*P40:24,*EL;
          GOTO      KHOS214
.
EKHOS214  DISPLAY   *P40:24,*EL,*B,*V2LON,"** Invalid Operation Amount Size **":
                    *W2,*P40:24,*EL;
          GOTO      KHOS214
.
.
KHOS215   KEYIN     *P40:19,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS215Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS215N IF EQUAL
          BEEP
          GOTO      KHOS215
.
KHOS215Y  MOVE      ONE,CINV1ST
          GOTO      KHOS215D
.
KHOS215N  MOVE      ZERO,CINV1ST
.
KHOS215D  MOVE      DNO,DANS
          LOAD      DANS,CINV1ST,DYES,DNO
          DISPLAY   *P40:19,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KHOS216   KEYIN     *P40:20,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS216Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS216N IF EQUAL
          BEEP
          GOTO      KHOS216
.
KHOS216Y  MOVE      ONE,CATDMAN
          GOTO      KHOS216S
.
KHOS216N  MOVE      TWO,CATDMAN
.
KHOS216S  MOVE      DNO,DANS
          LOAD      DANS,CATDMAN,DYES,DNO
          DISPLAY   *P40:20,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KHOS217   KEYIN     *P40:21,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS217Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS217N IF EQUAL
          BEEP
          GOTO      KHOS217
.
KHOS217Y  MOVE      ONE,CRDRTYP
          GOTO      KHOS217S
.
KHOS217N  MOVE      TWO,CRDRTYP
.
KHOS217S  MOVE      DNO,DANS
          LOAD      DANS,CRDRTYP,DYES,DNO
          DISPLAY   *P40:21,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
.
KHOS218   KEYIN     *P40:22,*EL,*V2LON,CMAXINV;
          DISPLAY   *P40:22,*V2LON,CMAXINV;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
KHOS219   COMPARE   ONE,CDIETCD
          GOTO      KHOS219A IF EQUAL
          BEEP
          GOTO      UPHOS2
.
KHOS219A  MOVE      SP3,CDIETDF
          KEYIN     *P40:23,*EL,*V2LON,CDIETDF;
          MATCH     SP3,CDIETDF
          GOTO      INVDIET IF EQUAL
          PACK      KEY5,CODEDC,CDIETDF
          CALL      RDCODE1
          BRANCH    OVRCD,INVDIET
          DISPLAY   *P50:23,*V2LON,TDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS2
.
INVDIET   DISPLAY   *P50:23,*B,*V2LON,"** Invalid Dietary Category **",*W2;
          GOTO      KHOS219
.
.
UPHOS3    CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHOS31,KHOS32,KHOS33,KHOS34,KHOS35,KHOS36,KHOS37:
                          KHOS38,KHOS39,KHOS310,KHOS311,KHOS312,KHOS313,KHOS314:
                          KHOS315,KHOS316,KHOS317,KHOS318,KHOS319,KHOS320
          BEEP
          GOTO      UPHOS3
.
.
KHOS31    KEYIN     *P46:4,*EL,*V2LON,CLABPG;
.
          COMPARE   FOUR,CLABPG
          GOTO      EKHOS31 IF NOT LESS
.
          IF        CTYPLAB=20 & CLABPG=3
            DISPLAY   *P1:24,*EL,*B,"St. Lukes labels must only be 1 or 2 ":
                      "labels across the page. ";
            CALL      HITENTER
            GOTO      KHOS31
          ENDIF
.
          DISPLAY   *P46:4,*EL,*V2LON,CLABPG;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
EKHOS31   DISPLAY   *P1:24,*EL,*B,"Invalid Number of Labels. ";
          CALL      HITENTER
          GOTO      KHOS31
.
KHOS32    KEYIN     *P44:5,*EL,*V2LON,CLABPRT;
          DISPLAY   *P44:5,*EL,*V2LON,CLABPRT;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KHOS33    KEYIN     *P46:6,*EL,*V2LON,CNDLAB;
          COMPARE   FOUR,CNDLAB
          GOTO      EKHOS33 IF NOT LESS
          DISPLAY   *P46:6,*EL,*V2LON,CNDLAB;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
EKHOS33   DISPLAY   *P40:24,*EL,*B,*V2LON,"** Invalid Number of Labels **":
                    *W2,*P40:24,*EL;
          GOTO      KHOS33
.
KHOS34    KEYIN     *P44:7,*EL,*V2LON,CDISPRT;
          DISPLAY   *P44:7,*EL,*V2LON,CDISPRT;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KHOS35    KEYIN     *P46:8,*EL,*V2LON,CBTLAB;
          COMPARE   FOUR,CBTLAB
          GOTO      EKHOS35 IF NOT LESS
          DISPLAY   *P46:8,*EL,*V2LON,CBTLAB;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
EKHOS35   DISPLAY   *P40:24,*EL,*B,*V2LON,"** Invalid Number of Labels **":
                    *W2,*P40:24,*EL;
          GOTO      KHOS35
.
KHOS36    KEYIN     *P44:9,*EL,*V2LON,CBTRPRT;
          DISPLAY   *P44:9,*EL,*V2LON,CBTRPRT;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KHOS37    KEYIN     *P46:10,*EL,*V2LON,CNBLAB;
          COMPARE   FOUR,CNBLAB
          GOTO      EKHOS37 IF NOT LESS
          DISPLAY   *P46:10,*EL,*V2LON,CNBLAB;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
EKHOS37   DISPLAY   *P40:24,*EL,*B,*V2LON,"** Invalid Number of Labels **":
                    *W2,*P40:24,*EL;
          GOTO      KHOS37
.
KHOS38    KEYIN     *P44:11,*EL,*V2LON,CNBPRT;
          DISPLAY   *P44:11,*EL,*V2LON,CNBPRT;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KHOS39    KEYIN     *P46:12,*EL,*V2LON,CDOCLAB;
          COMPARE   FOUR,CDOCLAB
          GOTO      EKHOS39 IF NOT LESS
          DISPLAY   *P46:12,*EL,*V2LON,CDOCLAB;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
EKHOS39   DISPLAY   *P40:24,*EL,*B,*V2LON,"** Invalid Number of Labels **":
                    *W2,*P40:24,*EL;
          GOTO      KHOS39
.
KHOS310   KEYIN     *P45:13,*EL,*V2LON,CNDOCLB;
          DISPLAY   *P45:13,*EL,*V2LON,CNDOCLB;
.
          COMPARE   ONE,CNDOCLB
          GOTO      EKHOS310 IF LESS
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
EKHOS310  DISPLAY   *P55:13,*EL,*V2LON,*B,"** Must be > Zero **",*W2;
          GOTO      KHOS310
.
KHOS311   MOVE      ZERO,CDOCLLN
          KEYIN     *P46:14,*EL,*V2LON,CDOCLLN;
          DISPLAY   *P46:14,*EL,*V2LON,CDOCLLN;
.
          COMPARE   FIVE,CDOCLLN
          GOTO      EKHOS311 IF NOT LESS
.
          DISPLAY   *P55:14,*EL,*V2LON,*B,"** Must be >= 5 **",*W2;
          GOTO      KHOS311
.
EKHOS311  MOVE      ZERO,OVRCD                   * added for V5.01.93
          GOTO      UPHOS3
.
KHOS312   GOTO      UPHOS3
.
EKHOS312  DISPLAY   *P40:24,*EL,*B,*V2LON:
                    "** Invalid Number of Tracking Labels **",*W2,*P40:24,*EL;
          GOTO      KHOS312
.
KHOS313   GOTO      UPHOS3
.
KHOS314   DISPLAY   *P1:24,*EL:
                    "Selections : ",*V2LON,ZERO,*HOFF," = With U/R ":
                    *V2LON,ONE,*HOFF," = Without U/R";
          KEYIN     *P46:17,*EL,*V2LON,UROPT;
.
          MOVE      ZERO,OVRCD
          COMPARE   ZERO,UROPT
          GOTO      EHOS314A IF EQUAL
.
          COMPARE   ONE,UROPT
          GOTO      EHOS314B IF EQUAL
          BEEP
          GOTO      KHOS314
.
EHOS314A  MOVE      URDESC1,URDESC
          GOTO      EHOS314C
.
EHOS314B  MOVE      URDESC2,URDESC
.
EHOS314C  DISPLAY   *P49:17,*V2LON,URDESC;
          GOTO      UPHOS3
.
.       TYPE OF LABEL
.
KHOS315   MOVE      "18",CVERT
          MOVE      "49",CCOL
          MOVE      "Labels Layout",BOXHDR
          CALL      LDLABL00                * Load Labels Layouts
          PROC      GENCODKY
          MOVE      ZERO,HLEF
          BRANCH    EXIT,UPHOS3
.
          MOVE      TEMPCODE,CTYPLAB
          DISPLAY   *P45:18,*V2LON,CTYPLAB;
          IF        CTYPLAB=20 & CLABPG=3
            DISPLAY   *P1:24,*EL,*B,"St. Lukes labels must only be 1 or 2 ":
                      "labels across the page. ";
            CALL      HITENTER
          ENDIF
          GOTO      UPHOS3
.
.       SIZE OF LABELS
.
KHOS316   DISPLAY   *P1:24,*EL,*V2LON,ONE,*HOFF:
                    ". = Small (37 Char Separation), ":
                    *V2LON,TWO,*HOFF:
                    ". = Wide  (42 Char Separation)";
.
          KEYIN     *P46:19,*EL,*V2LON,CSIZLAB,*P1:24,*EL;
          MOVE      ZERO,OVRCD
          BRANCH    CSIZLAB,OKHOS316,OKHOS316
          BEEP
          GOTO      KHOS316
.
OKHOS316  LOAD      DLSIZE,CSIZLAB,DLSIZE1,DLSIZE2
          DISPLAY   *P49:19,*V2LON,DLSIZE;
          GOTO      UPHOS3
.
KHOS317   DISPLAY   *P1:24,*EL,*V2LON,ONE,*HOFF:
                    ". = Small (37 Char Separation), ":
                    *V2LON,TWO,*HOFF:
                    ". = Wide  (42 Char Separation)";
.
          KEYIN     *P46:20,*EL,*V2LON,CDOCSLB,*P1:24,*EL;
          MOVE      ZERO,OVRCD
          BRANCH    CDOCSLB,OKHOS317,OKHOS317
          BEEP
          GOTO      KHOS317
.
OKHOS317  LOAD      DOCLSIZ,CDOCSLB,DLSIZE1,DLSIZE2
          DISPLAY   *P49:20,*V2LON,DOCLSIZ;
          GOTO      UPHOS3
.
KHOS318   KEYIN     *P46:21,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS318Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS318N IF EQUAL
          BEEP
          GOTO      KHOS318
.
KHOS318Y  MOVE      ONE,CPRDLB
          GOTO      KHOS318S
.
KHOS318N  MOVE      ZERO,CPRDLB
.
KHOS318S  MOVE      DNO,DANS15
          LOAD      DANS15,CPRDLB,DYES,DNO
          DISPLAY   *P46:21,*EL,*V2LON,DANS15;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KHOS319   KEYIN     *P46:22,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS319Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS319N IF EQUAL
          BEEP
          GOTO      KHOS319
.
KHOS319Y  MOVE      ONE,CPRBTL
          GOTO      KHOS319S
.
KHOS319N  MOVE      ZERO,CPRBTL
.
KHOS319S  MOVE      DNO,DANS16
          LOAD      DANS16,CPRBTL,DYES,DNO
          DISPLAY   *P46:22,*EL,*V2LON,DANS16;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
KHOS320   KEYIN     *P46:23,*EL,*V2LON,ANS;
          MATCH    "Y",ANS
          GOTO      KHOS320Y IF EQUAL
.
          MATCH    "N",ANS
          GOTO      KHOS320N IF EQUAL
          BEEP
          GOTO      KHOS320
.
KHOS320Y  MOVE      ONE,CPRNBL
          GOTO      KHOS320S
.
KHOS320N  MOVE      ZERO,CPRNBL
.
KHOS320S  MOVE      DNO,DANS17
          LOAD      DANS17,CPRNBL,DYES,DNO
          DISPLAY   *P46:23,*EL,*V2LON,DANS17;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS3
.
UPHOS4    CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHOS41,KHOS42,KHOS43,KHOS44,KHOS45,KHOS46,KHOS47:
                          KHOS48,KHOS49,KHOS410,KHOS411,KHOS412,KHOS413,KHOS414:
                          KHOS415,KHOS416
          BEEP
          GOTO      UPHOS4
.
KHOS41    MOVE      ZERO,OVRCD
          MOVE      SP6,CMABINS
          KEYIN     *P44:4,*EL,*V2LON,CMABINS;
.
          ENDSET    CMABINS
          APPEND    SP6,CMABINS
          RESET     CMABINS
.
          MATCH     SP6,CMABINS
          GOTO      UPHOS4 IF EQUAL
.
          MOVE      CMABINS,KEY6
          CALL      RDINSR1
          BRANCH    OVRCD,EKHOS41
.
          MOVE      INAME,IDESCM
          DISPLAY   *P44:4,*EL,*V2LON,CMABINS,*P52:4,IDESCM;
          GOTO      UPHOS4
.
EKHOS41   DISPLAY   *P52:4,*EL,*V2LON,"** Invalid Insurance Code **",*W2;
          GOTO      KHOS41
.
KHOS42    MOVE      ZERO,OVRCD
          MOVE      SP6,CVETINS
          KEYIN     *P44:5,*EL,*V2LON,CVETINS;
.
          RESET     CVETINS,6
          RESET     CVETINS
          MATCH     SP6,CVETINS
          GOTO      UPHOS4 IF EQUAL
.
          MOVE      CVETINS,KEY6
          CALL      RDINSR1
          BRANCH    OVRCD,EKHOS42
.
          MOVE      INAME,IDESCV
          DISPLAY   *P44:5,*EL,*V2LON,CVETINS,*P52:5,IDESCV;
          GOTO      UPHOS4
.
EKHOS42   DISPLAY   *P52:5,*EL,*V2LON,"** Invalid Insurance Code **",*W2;
          GOTO      KHOS42
.
KHOS43    KEYIN     *P44:6,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS43Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS43N IF EQUAL
          BEEP
          GOTO      KHOS43
.
KHOS43Y   MOVE      ONE,CUSR1
          GOTO      KHOS43S
.
KHOS43N   MOVE      ZERO,CUSR1
.
KHOS43S   MOVE      DNO,DANS
          LOAD      DANS,CUSR1,DYES,DNO
          DISPLAY   *P44:6,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
KHOS44    MOVE      SP20,CUSRDS1
          KEYIN     *P44:7,*EL,*V2LON,CUSRDS1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
KHOS45    KEYIN     *P44:8,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS45Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS45N IF EQUAL
          BEEP
          GOTO      KHOS45
.
KHOS45Y   MOVE      ONE,CUSMAN1
          GOTO      KHOS45S
.
KHOS45N   MOVE      TWO,CUSMAN1
.
KHOS45S   MOVE      DNO,DANS
          LOAD      DANS,CUSMAN1,DYES,DNO
          DISPLAY   *P44:8,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
KHOS46    KEYIN     *P44:9,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS46Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS46N IF EQUAL
          BEEP
          GOTO      KHOS46
.
KHOS46Y   MOVE      ONE,CUSR2
          GOTO      KHOS46S
.
KHOS46N   MOVE      ZERO,CUSR2
.
KHOS46S   MOVE      DNO,DANS
          LOAD      DANS,CUSR2,DYES,DNO
          DISPLAY   *P44:9,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
KHOS47    MOVE      SP20,CUSRDS2
          KEYIN     *P44:10,*EL,*V2LON,CUSRDS2;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
KHOS48    KEYIN     *P44:11,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS48Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS48N IF EQUAL
          BEEP
          GOTO      KHOS48
.
KHOS48Y   MOVE      ONE,CUSMAN2
          GOTO      KHOS48S
.
KHOS48N   MOVE      TWO,CUSMAN2
.
KHOS48S   MOVE      DNO,DANS
          LOAD      DANS,CUSMAN2,DYES,DNO
          DISPLAY   *P44:11,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
KHOS49    KEYIN     *P44:12,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS49Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS49N IF EQUAL
          BEEP
          GOTO      KHOS49
.
KHOS49Y   MOVE      ONE,CUSR3
          GOTO      KHOS49S
.
KHOS49N   MOVE      ZERO,CUSR3
.
KHOS49S   MOVE      DNO,DANS
          LOAD      DANS,CUSR3,DYES,DNO
          DISPLAY   *P44:12,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
KHOS410   MOVE      SP20,CUSRDS3
          KEYIN     *P44:13,*EL,*V2LON,CUSRDS3;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
KHOS411   KEYIN     *P44:14,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS411Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS411N IF EQUAL
          BEEP
          GOTO      KHOS411
.
KHOS411Y  MOVE      ONE,CUSMAN3
          GOTO      KHOS411S
.
KHOS411N  MOVE      TWO,CUSMAN3
.
KHOS411S  MOVE      DNO,DANS
          LOAD      DANS,CUSMAN3,DYES,DNO
          DISPLAY   *P44:14,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
KHOS412   KEYIN     *P44:15,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS412Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS412N IF EQUAL
          BEEP
          GOTO      KHOS412
.
KHOS412Y  MOVE      ONE,CUSR4
          GOTO      KHOS412S
.
KHOS412N  MOVE      ZERO,CUSR4
.
KHOS412S  MOVE      DNO,DANS
          LOAD      DANS,CUSR4,DYES,DNO
          DISPLAY   *P44:15,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
KHOS413   MOVE      SP20,CUSRDS4
          KEYIN     *P44:16,*EL,*V2LON,CUSRDS4;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
KHOS414   KEYIN     *P44:17,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS414Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS414N IF EQUAL
          BEEP
          GOTO      KHOS414
.
KHOS414Y  MOVE      ONE,CUSMAN4
          GOTO      KHOS414S
.
KHOS414N  MOVE      TWO,CUSMAN4
.
KHOS414S  MOVE      DNO,DANS
          LOAD      DANS,CUSMAN4,DYES,DNO
          DISPLAY   *P44:17,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS4
.
KHOS415   DISPLAY   *P1:23,*EF,"A or B" 
          KEYIN     *P44:18,*V2LON,PTCNCROL
          MATCH     SP1,PTCNCROL
          GOTO      KHOS415A IF EQUAL
          MATCH     ANSA,PTCNCROL
          GOTO      KHOS415A IF EQUAL
          MATCH     ANSB,PTCNCROL
          GOTO      KHOS415A IF EQUAL
          DISPLAY   *P1:24,"Invalid Code ";
          CALL      HITENTER
          GOTO      KHOS415
.
KHOS415A  DISPLAY   *P44:18,*V2LON,PTCNCROL
          DISPLAY   *P1:23,*EF
          GOTO      UPHOS4
.
KHOS416   MOVE      ZERO,FORM1
          MOVE      PTCNCTYP,FORM1
          MOVE      SP20,CTRCTDES
          LOAD      CTRCTDES,FORM1,CTYPE1,CTYPE2,CTYPE3,CTYPE4,CTYPE5
          DISPLAY   *P47:19,*EL,CTRCTDES
          DISPLAY   *P1:23,*EF,"1 = B, 2 = ABA, 3 = AB, 4 = (A)B, 5 = BA"
          KEYIN     *P44:19,*V2LON,FORM1
          IF        FORM1=0
            MOVE      SP10,PTCNCTYP
            GOTO      KHOS416B 
          ENDIF
          IF        FORM1 <1 | FORM1 > 5
            DISPLAY   *P1:24,"Invalid Code ";
            CALL      HITENTER
            GOTO      KHOS416 
          ENDIF

KHOS416A  MOVE      FORM1,PTCNCTYP
KHOS416B  MOVE      SP10,CTRCTDES
          LOAD      CTRCTDES,FORM1,CTYPE1,CTYPE2,CTYPE3,CTYPE4,CTYPE5
.
          DISPLAY   *P44:19,*V2LON,PTCNCTYP,SP2,*HOFF,CTRCTDES
          DISPLAY   *P1:23,*EF
          GOTO      UPHOS4
.
UPHOS5    CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHOS51,KHOS52,KHOS53,KHOS54,KHOS55,KHOS56,KHOS57:
                          KHOS58,KHOS59,KHOS510,KHOS511,KHOS512,KHOS513:
                          KHOS514,KHOS515,KHOS516,KHOS517,KHOS518
          BEEP
          GOTO      UPHOS5
.
KHOS51    KEYIN     *P44:4,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS51Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS51N IF EQUAL
          BEEP
          GOTO      KHOS51
.
KHOS51Y   MOVE      ONE,CUSR5
          GOTO      KHOS51S
.
KHOS51N   MOVE      ZERO,CUSR5
.
KHOS51S   MOVE      DNO,DANS
          LOAD      DANS,CUSR5,DYES,DNO
          DISPLAY   *P44:4,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS52    MOVE      SP20,CUSRDS5
          KEYIN     *P44:5,*EL,*V2LON,CUSRDS5;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS53    KEYIN     *P44:6,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS53Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS53N IF EQUAL
          BEEP
          GOTO      KHOS53
.
KHOS53Y   MOVE      ONE,CUSMAN5
          GOTO      KHOS53S
.
KHOS53N   MOVE      TWO,CUSMAN5
.
KHOS53S   MOVE      DNO,DANS
          LOAD      DANS,CUSMAN5,DYES,DNO
          DISPLAY   *P44:6,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS54    KEYIN     *P44:7,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS54Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS54N IF EQUAL
          BEEP
          GOTO      KHOS54
.
KHOS54Y   MOVE      ONE,CUSR6
          GOTO      KHOS54S
.
KHOS54N   MOVE      ZERO,CUSR6
.
KHOS54S   MOVE      DNO,DANS
          LOAD      DANS,CUSR6,DYES,DNO
          DISPLAY   *P44:7,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS55    MOVE      SP20,CUSRDS6
          KEYIN     *P44:8,*EL,*V2LON,CUSRDS6;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS56    KEYIN     *P44:9,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS56Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS56N IF EQUAL
          BEEP
          GOTO      KHOS56
.
KHOS56Y   MOVE      ONE,CUSMAN6
          GOTO      KHOS56S
.
KHOS56N   MOVE      TWO,CUSMAN6
.
KHOS56S   MOVE      DNO,DANS
          LOAD      DANS,CUSMAN6,DYES,DNO
          DISPLAY   *P44:9,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS57    KEYIN     *P44:10,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS57Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS57N IF EQUAL
          BEEP
          GOTO      KHOS57
.
KHOS57Y   MOVE      ONE,CUSR7
          GOTO      KHOS57S
.
KHOS57N   MOVE      ZERO,CUSR7
.
KHOS57S   MOVE      DNO,DANS
          LOAD      DANS,CUSR7,DYES,DNO
          DISPLAY   *P44:10,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS58    MOVE      SP20,CUSRDS1
          KEYIN     *P44:11,*EL,*V2LON,CUSRDS7;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS59    KEYIN     *P44:12,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS59Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS59N IF EQUAL
          BEEP
          GOTO      KHOS59
.
KHOS59Y   MOVE      ONE,CUSMAN7
          GOTO      KHOS59S
.
KHOS59N   MOVE      TWO,CUSMAN7
.
KHOS59S   MOVE      DNO,DANS
          LOAD      DANS,CUSMAN7,DYES,DNO
          DISPLAY   *P44:12,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS510   KEYIN     *P44:13,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS510Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS510N IF EQUAL
          BEEP
          GOTO      KHOS510
.
KHOS510Y  MOVE      ONE,CMUSR1
          GOTO      KHOS510S
.
KHOS510N  MOVE      ZERO,CMUSR1
.
KHOS510S  MOVE      DNO,DANS
          LOAD      DANS,CMUSR1,DYES,DNO
          DISPLAY   *P44:13,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS511   MOVE      SP20,CMUSDS1
          KEYIN     *P44:14,*EL,*V2LON,CMUSDS1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS512   KEYIN     *P44:15,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS512Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS512N IF EQUAL
          BEEP
          GOTO      KHOS512
.
KHOS512Y  MOVE      ONE,CMUSMAN1
          GOTO      KHOS512S
.
KHOS512N  MOVE      TWO,CMUSMAN1
.
KHOS512S  MOVE      DNO,DANS
          LOAD      DANS,CMUSMAN1,DYES,DNO
          DISPLAY   *P44:15,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
.
KHOS513   KEYIN     *P44:16,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS513Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS513N IF EQUAL
          BEEP
          GOTO      KHOS513
.
KHOS513Y  MOVE      ONE,CMUSR2
          GOTO      KHOS513S
.
KHOS513N  MOVE      ZERO,CMUSR2
.
KHOS513S  MOVE      DNO,DANS
          LOAD      DANS,CMUSR2,DYES,DNO
          DISPLAY   *P44:16,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS514   MOVE      SP20,CMUSDS2
          KEYIN     *P44:17,*EL,*V2LON,CMUSDS2;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS515   KEYIN     *P44:18,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS515Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS515N IF EQUAL
          BEEP
          GOTO      KHOS515
.
KHOS515Y  MOVE      ONE,CMUSMAN2
          GOTO      KHOS515S
.
KHOS515N  MOVE      TWO,CMUSMAN2
KHOS515S  MOVE      DNO,DANS
          LOAD      DANS,CMUSMAN2,DYES,DNO
          DISPLAY   *P44:18,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS516   KEYIN     *P44:19,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS516Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS516N IF EQUAL
          BEEP
          GOTO      KHOS516
.
KHOS516Y  MOVE      ONE,CMUSR3
          GOTO      KHOS516S
.
KHOS516N  MOVE      ZERO,CMUSR3
.
KHOS516S  MOVE      DNO,DANS
          LOAD      DANS,CMUSR3,DYES,DNO
          DISPLAY   *P44:19,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS517   MOVE      SP20,CMUSDS3
          KEYIN     *P44:20,*EL,*V2LON,CMUSDS3;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
KHOS518   KEYIN     *P44:21,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS518Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS518N IF EQUAL
          BEEP
          GOTO      KHOS518
.
KHOS518Y  MOVE      ONE,CMUSMAN3
          GOTO      KHOS518S
.
KHOS518N  MOVE      TWO,CMUSMAN3
KHOS518S  MOVE      DNO,DANS
          LOAD      DANS,CMUSMAN3,DYES,DNO
          DISPLAY   *P44:21,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS5
.
.
UPHOS6    CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHOS61,KHOS62,KHOS63,KHOS64,KHOS65,KHOS66,KHOS67:
                          KHOS68,KHOS69,KHOS610,KHOS611,KHOS612,KHOS613:
                          KHOS614,KHOS615
          BEEP
          GOTO      UPHOS6
.
KHOS61    KEYIN     *P44:4,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS61Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS61N IF EQUAL
          BEEP
          GOTO      KHOS61
.
KHOS61Y   MOVE      ONE,CDUSR1
          GOTO      KHOS61S
.
KHOS61N   MOVE      ZERO,CDUSR1
.
KHOS61S   MOVE      DNO,DANS
          LOAD      DANS,CDUSR1,DYES,DNO
          DISPLAY   *P44:4,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS6
.
KHOS62    MOVE      SP20,CDUSDS1
          KEYIN     *P44:5,*EL,*V2LON,CDUSDS1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS6
.
KHOS63    KEYIN     *P44:6,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS63Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS63N IF EQUAL
          BEEP
          GOTO      KHOS63
.
KHOS63Y   MOVE      ONE,CDUSMAN1
          GOTO      KHOS63S
.
KHOS63N   MOVE      TWO,CDUSMAN1
.
KHOS63S   MOVE      DNO,DANS
          LOAD      DANS,CDUSMAN1,DYES,DNO
          DISPLAY   *P44:6,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS6
.
KHOS64    KEYIN     *P44:7,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS64Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS64N IF EQUAL
          BEEP
          GOTO      KHOS64
.
KHOS64Y   MOVE      ONE,CDUSR2
          GOTO      KHOS64S
.
KHOS64N   MOVE      ZERO,CDUSR2
.
KHOS64S   MOVE      DNO,DANS
          LOAD      DANS,CDUSR2,DYES,DNO
          DISPLAY   *P44:7,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS6
.
KHOS65    MOVE      SP20,CDUSDS2
          KEYIN     *P44:8,*EL,*V2LON,CDUSDS2;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS6
.
KHOS66    KEYIN     *P44:9,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS66Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS66N IF EQUAL
          BEEP
          GOTO      KHOS66
.
KHOS66Y   MOVE      ONE,CDUSMAN2
          GOTO      KHOS66S
.
KHOS66N   MOVE      TWO,CDUSMAN2
.
KHOS66S   MOVE      DNO,DANS
          LOAD      DANS,CDUSMAN2,DYES,DNO
          DISPLAY   *P44:9,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS6
.
KHOS67    KEYIN     *P44:10,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS67Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS67N IF EQUAL
          BEEP
          GOTO      KHOS67
.
KHOS67Y   MOVE      ONE,CDUSR3
          GOTO      KHOS67S
.
KHOS67N   MOVE      ZERO,CDUSR3
.
KHOS67S   MOVE      DNO,DANS
          LOAD      DANS,CDUSR3,DYES,DNO
          DISPLAY   *P44:10,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS6
.
KHOS68    MOVE      SP20,CDUSDS3
          KEYIN     *P44:11,*EL,*V2LON,CDUSDS3;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS6
.
KHOS69    KEYIN     *P44:12,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS69Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS69N IF EQUAL
          BEEP
          GOTO      KHOS69
.
KHOS69Y   MOVE      ONE,CDUSMAN3
          GOTO      KHOS69S
.
KHOS69N   MOVE      TWO,CDUSMAN3
.
KHOS69S   MOVE      DNO,DANS
          LOAD      DANS,CDUSMAN3,DYES,DNO
          DISPLAY   *P44:12,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS6
.
KHOS610   KEYIN     *P44:13,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS610Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS610N IF EQUAL
          BEEP
          GOTO      KHOS610
.
KHOS610Y  MOVE      ONE,CDUSR4
          GOTO      KHOS610S
.
KHOS610N  MOVE      ZERO,CDUSR4
.
KHOS610S  MOVE      DNO,DANS
          LOAD      DANS,CDUSR4,DYES,DNO
          DISPLAY   *P44:13,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS6
.
KHOS611   MOVE      SP20,CDUSDS4
          KEYIN     *P44:14,*EL,*V2LON,CDUSDS4;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS6
.
KHOS612   KEYIN     *P44:15,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS612Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS612N IF EQUAL
          BEEP
          GOTO      KHOS612
.
KHOS612Y  MOVE      ONE,CDUSMAN4
          GOTO      KHOS612S
.
KHOS612N  MOVE      TWO,CDUSMAN4
.
KHOS612S  MOVE      DNO,DANS
          LOAD      DANS,CDUSMAN4,DYES,DNO
          DISPLAY   *P44:15,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS6
.
KHOS613   KEYIN     *P44:16,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS613Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS613N IF EQUAL
          BEEP
          GOTO      KHOS613
.
KHOS613Y  MOVE      ONE,CDUSR5
          GOTO      KHOS613S
.
KHOS613N  MOVE      ZERO,CDUSR5
.
KHOS613S  MOVE      DNO,DANS
          LOAD      DANS,CDUSR5,DYES,DNO
          DISPLAY   *P44:16,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS6
.
KHOS614   MOVE      SP20,CDUSDS5
          KEYIN     *P44:17,*EL,*V2LON,CDUSDS5;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS6
.
KHOS615   KEYIN     *P44:18,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS615Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS615N IF EQUAL
          BEEP
          GOTO      KHOS615
.
KHOS615Y  MOVE      ONE,CDUSMAN5
          GOTO      KHOS615S
.
KHOS615N  MOVE      TWO,CDUSMAN5
.
KHOS615S  MOVE      DNO,DANS
          LOAD      DANS,CDUSMAN5,DYES,DNO
          DISPLAY   *P44:18,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS6
.
.
UPHOS7    CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHOS71,KHOS72,KHOS73,KHOS74,KHOS75,KHOS76,KHOS77:
                          KHOS78,KHOS79,KHOS710,KHOS711,KHOS712,KHOS713,KHOS714:
                          KHOS715,KHOS716,KHOS717,KHOS718,KHOS719,KHOS720
UPHOS7A   BEEP
          GOTO      UPHOS7
.
KHOS71    DISPLAY   *P1:24,*EL:
                    *V2LON,ZERO,*HOFF," = Free Format, ":
                    *V2LON,ONE,*HOFF," = MBS Code, ":
                    *V2LON,TWO,*HOFF," = ICD9CM Code";
.
          KEYIN     *P44:4,*EL,*V2LON,CKMBS;
.
          COMPARE   ZERO,CKMBS
          GOTO      KHOS71S IF EQUAL
.
          BRANCH    CKMBS,KHOS71S,KHOS71S
          BEEP
          GOTO      KHOS71
.
KHOS71S   MOVE      "Free Format         ",DCKMBS
          LOAD      DCKMBS,CKMBS,DCKMBS0,DCKMBS1
          DISPLAY   *P1:24,*EL,*P44:4,*EL,*V2LON,CKMBS,*P52:4,DCKMBS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
.
KHOS72    MOVE      ZERO,CLOWMBS
          KEYIN     *P44:5,*EL,*V2LON,CLOWMBS;
          DISPLAY   *P44:5,*V2LON,CLOWMBS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS73    MOVE      SP3,CLOWADM
          KEYIN     *P44:6,*EL,*V2LON,CLOWADM;
          RESET     CLOWADM
          GOTO      KHOS73A IF EOS
.
          ENDSET    CLOWADM
          APPEND    SP3,CLOWADM
          RESET     CLOWADM
.
          MATCH     SP3,CLOWADM
          GOTO      KHOS73A IF EQUAL
.
          PACK      KEY5,CODEA,CLOWADM
          CALL      RDCODE1
          BRANCH    OVRCD,KHOS73A
          DISPLAY   *P52:6,*V2LON,TDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS73A   BEEP
          GOTO      KHOS73
.
KHOS74    MOVE      ZERO,CHIGHMBS
          KEYIN     *P44:7,*EL,*V2LON,CHIGHMBS;
          DISPLAY   *P44:7,*V2LON,CHIGHMBS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS75    MOVE      SP3,CHIGHADM
          KEYIN     *P44:8,*EL,*V2LON,CHIGHADM;
          RESET     CHIGHADM
          GOTO      KHOS75A IF EOS
.
          ENDSET    CHIGHADM
          APPEND    SP3,CHIGHADM
          RESET     CHIGHADM
.
          MATCH     SP3,CHIGHADM
          GOTO      KHOS75A IF EQUAL
.
          PACK      KEY5,CODEA,CHIGHADM
          CALL      RDCODE1
          BRANCH    OVRCD,KHOS75A
          DISPLAY   *P52:8,*V2LON,TDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS75A   BEEP
          GOTO      KHOS75
.
KHOS76    MOVE      SP3,CTOPADM
          KEYIN     *P44:9,*EL,*V2LON,CTOPADM;
          RESET     CTOPADM
          GOTO      KHOS76A IF EOS
.
          MATCH     SP3,CTOPADM
          GOTO      KHOS76A IF EQUAL
.
          PACK      KEY5,CODEA,CTOPADM
          CALL      RDCODE1
          BRANCH    OVRCD,KHOS76A
          DISPLAY   *P52:9,*V2LON,TDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS76A   BEEP
          GOTO      KHOS76
.
KHOS77    KEYIN     *P44:10,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS77Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS77N IF EQUAL
          BEEP
          GOTO      KHOS77
.
KHOS77Y   MOVE      ONE,CSTDOWN
          GOTO      KHOS77S
.
KHOS77N   MOVE      TWO,CSTDOWN
.
KHOS77S   MOVE      DNO,DANS
          LOAD      DANS,CSTDOWN,DYES,DNO
          DISPLAY   *P44:10,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
.
KHOS78    KEYIN     *P44:11,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS78Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS78N IF EQUAL
          BEEP
          GOTO      KHOS78
.
KHOS78Y   MOVE      ONE,CDLSTEP
          GOTO      KHOS78S
.
KHOS78N   MOVE      TWO,CDLSTEP
.
KHOS78S   MOVE      DNO,DANS
          LOAD      DANS,CDLSTEP,DYES,DNO
          DISPLAY   *P44:11,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS79    KEYIN     *P44:12,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS79Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS79N IF EQUAL
          BEEP
          GOTO      KHOS79
.
KHOS79Y   MOVE      ONE,CDYCASE
          GOTO      KHOS79S
.
KHOS79N   MOVE      TWO,CDYCASE
.
KHOS79S   MOVE      DNO,DANS
          LOAD      DANS,CDYCASE,DYES,DNO
          DISPLAY   *P44:12,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS710   KEYIN     *P44:13,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS710Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS710N IF EQUAL
          BEEP
          GOTO      KHOS710
.
KHOS710Y  MOVE      ONE,CSRESP
          GOTO      KHOS710S
.
KHOS710N  MOVE      TWO,CSRESP
.
KHOS710S  MOVE      DNO,DANS
          LOAD      DANS,CSRESP,DYES,DNO
          DISPLAY   *P44:13,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS711   MOVE      ZERO,CERRSEC
          KEYIN     *P44:14,*EL,*V2LON,CERRSEC;
          DISPLAY   *P44:14,*EL,*V2LON,CERRSEC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS712   MOVE      ZERO,CERRDAY
          KEYIN     *P44:15,*EL,*V2LON,CERRDAY;
          DISPLAY   *P44:15,*EL,*V2LON,CERRDAY;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS713   KEYIN     *P44:16,*EL,*V2LON,CSECURA;
          DISPLAY   *P44:16,*EL,*V2LON,CSECURA;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS714   KEYIN     *P44:17,*EL,*V2LON,CSECURD;
          DISPLAY   *P44:17,*EL,*V2LON,CSECURD;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS715   KEYIN     *P44:18,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS715Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS715N IF EQUAL
          BEEP
          GOTO      KHOS715
.
KHOS715N  MOVE      ONE,CERRAUD
          GOTO      KHOS715S
.
KHOS715Y  MOVE      ZERO,CERRAUD
.
KHOS715S  MOVE      DYES,DANS
          LOAD      DANS,CERRAUD,DNO,DYES
          DISPLAY   *P44:18,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS716   DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF,". = ",DMBSOP0,", ":
                    *V2LON,ONE,*HOFF,". = ",DMBSOP1;
.
          KEYIN     *P44:19,*EL,*V2LON,CMBSOPR:
                    *P44:19,*V2LON,*DV,CMBSOPR,*P1:24,*EL;
          BRANCH    CMBSOPR,KHOS716S
          COMPARE   ZERO,CMBSOPR
          GOTO      KHOS716S IF EQUAL
          BEEP
          GOTO      KHOS716
.
KHOS716S  MOVE      DMBSOP0,DMBSOPR
          LOAD      DMBSOPR,CMBSOPR,DMBSOP1
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS717   DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF,". = ",DDOCOP0,", ":
                    *V2LON,ONE,*HOFF,". = ",DDOCOP1;
.
          KEYIN     *P44:20,*EL,*V2LON,CDOCVMP:
                    *P44:20,*V2LON,*DV,CDOCVMP,*P1:24,*EL;
          BRANCH    CDOCVMP,KHOS717D
          COMPARE   ZERO,CDOCVMP
          GOTO      KHOS717D IF EQUAL
          BEEP
          GOTO      KHOS717
.
KHOS717D  MOVE      DDOCOP0,DDOCOPS
          LOAD      DDOCOPS,CDOCVMP,DDOCOP1
.
          DISPLAY   *P49:20,*EL,*V2LON,DDOCOPS
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS718   KEYIN     *P44:21,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS718Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS718N IF EQUAL
          BEEP
          GOTO      KHOS718
.
KHOS718N  MOVE      ZERO,PTCNADOC
          GOTO      KHOS718S
.
KHOS718Y  MOVE      ONE,PTCNADOC
.
KHOS718S  MOVE      DNO,DANS
          LOAD      DANS,PTCNADOC,DYES,DNO
          DISPLAY   *P44:21,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS719   COMPARE   ZERO,CHOSTYP
          GOTO      UPHOS7A IF EQUAL
.
          MOVE      SP3,CCHGST1
          KEYIN     *P44:22,*EL,*V2LON,CCHGST1;
          RESET     CCHGST1
          GOTO      KHOS719A IF EOS
.
          ENDSET    CCHGST1
          APPEND    SP3,CCHGST1
          RESET     CCHGST1
.
          MATCH     SP3,CCHGST1
          GOTO      KHOS719A IF EQUAL
.
          PACK      KEY5,CODEU2,CCHGST1
          CALL      RDCODE1
          BRANCH    OVRCD,KHOS719A
          DISPLAY   *P52:22,*V2LON,TDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS719A  BEEP
          GOTO      KHOS719
.
KHOS720   COMPARE   ZERO,CHOSTYP
          GOTO      UPHOS7A IF EQUAL
.
          MOVE      SP3,CCHGST2
          KEYIN     *P44:23,*EL,*V2LON,CCHGST2;
          RESET     CCHGST2
          GOTO      KHOS720A IF EOS
.
          ENDSET    CCHGST2
          APPEND    SP3,CCHGST2
          RESET     CCHGST2
.
          MATCH     SP3,CCHGST2
          GOTO      KHOS720A IF EQUAL
.
          PACK      KEY5,CODEU2,CCHGST2
          CALL      RDCODE1
          BRANCH    OVRCD,KHOS720A
          DISPLAY   *P52:23,*V2LON,TDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS7
.
KHOS720A  BEEP
          GOTO      KHOS720
.
UPHOS8    CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHOS81,KHOS82,KHOS83,KHOS84,KHOS85,KHOS86,KHOS87:
                          KHOS88,KHOS89,KHOS810,KHOS811,KHOS812,KHOS813,KHOS814:
                          KHOS815,KHOS816,KHOS817,KHOS818,KHOS819,KHOS820
          BEEP
          GOTO      UPHOS8
.
KHOS81    KEYIN     *P50:4,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS81Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS81N IF EQUAL
          BEEP
          GOTO      KHOS81
.
KHOS81Y   MOVE      ONE,CPRINV
          GOTO      KHOS81D
.
KHOS81N   MOVE      ZERO,CPRINV
.
KHOS81D   MOVE      DNO,DANS13
          LOAD      DANS13,CPRINV,DYES,DNO
          DISPLAY   *P50:4,*EL,*V2LON,DANS13;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
KHOS82    MOVE      ZERO,FORM1
          DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF,"=No. ":
                    *V2LON,"1",*HOFF,"=Yes-Rates/Bed Type  ":
                    *V2LON,"2",*HOFF,"=Yes-Bed Type(Adm&Trans) ":
                    *V2LON,"3",*HOFF,"=Yes-Bed Type(Trans)";
.
          KEYIN     *P50:5,*EL,*V2LON,FORM1;
.
          COMPARE   ZERO,FORM1
          GOTO      KHOS82N IF EQUAL
          BRANCH    FORM1,KHOS82Y,KHOS82B,KHOS83B
          BEEP
          GOTO      KHOS82
.
KHOS82N   DISPLAY   *P50:5,*EL,*V2LON,"No ",*P1:24,*EL;
          GOTO      KHOS82D
.
KHOS82Y   DISPLAY   *P50:5,*EL,*V2LON,"Yes -Rates/Bed Type",*P1:24,*EL;
          GOTO      KHOS82D
.
KHOS82B   DISPLAY   *P50:5,*EL,*V2LON,"Yes -Bed Type(Adm&Trans)",*P1:24,*EL;
          GOTO      KHOS82D
.
KHOS83B   DISPLAY   *P50:5,*EL,*V2LON,"Yes -Bed Type(Trans)",*P1:24,*EL;
          GOTO      KHOS82D
.
KHOS82D   MOVE      FORM1,CFINAN
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
KHOS83    MOVE      SP4,CMEDIB
          KEYIN     *P50:6,*EL,*V2LON,CMEDIB;
          ENDSET    CMEDIB
          APPEND    SP4,CMEDIB
          RESET     CMEDIB
.
          DISPLAY   *P50:6,*EL,*V2LON,CMEDIB;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
KHOS84    KEYIN     *P50:7,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS84Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS84N IF EQUAL
          BEEP
          GOTO      KHOS84
.
KHOS84Y   MOVE      ONE,CBFXITM
          GOTO      KHOS84D
.
KHOS84N   MOVE      ZERO,CBFXITM
.
KHOS84D   MOVE      DNO,DANS12
          LOAD      DANS12,CBFXITM,DYES,DNO
          DISPLAY   *P50:7,*EL,*V2LON,DANS12;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
KHOS85    KEYIN     *P50:8,*EL,*V2LON,CTOTADM;
          DISPLAY   *P50:8,*EL,*V2LON,CTOTADM;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
KHOS86    KEYIN     *P50:9,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS86Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS86N IF EQUAL
          BEEP
          GOTO      KHOS86
.
KHOS86Y   MOVE      ONE,CWRDSCN
          GOTO      KHOS86D
.
KHOS86N   MOVE      ZERO,CWRDSCN
.
KHOS86D   MOVE      DNO,DANS1
          LOAD      DANS1,CWRDSCN,DYES,DNO
          DISPLAY   *P50:9,*EL,*V2LON,DANS1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
KHOS87    KEYIN     *P50:10,*EL,*V2LON,CNXBTCH;
          DISPLAY   *P50:10,*EL,*V2LON,CNXBTCH;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
KHOS88    KEYIN     *P50:11,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS88Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS88N IF EQUAL
          BEEP
          GOTO      KHOS88
.
KHOS88Y   MOVE      ONE,CDOCBTR
          GOTO      KHOS88D
.
KHOS88N   MOVE      ZERO,CDOCBTR
.
KHOS88D   MOVE      DNO,DANS15
          LOAD      DANS15,CDOCBTR,DYES,DNO
          DISPLAY   *P50:11,*EL,*V2LON,DANS15;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
KHOS89    KEYIN     *P50:12,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS89Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS89N IF EQUAL
          BEEP
          GOTO      KHOS89
.
KHOS89Y   MOVE      ONE,CJRNDAT
          GOTO      KHOS89D
.
KHOS89N   MOVE      ZERO,CJRNDAT
.
KHOS89D   MOVE      DNO,DANS16
          LOAD      DANS16,CJRNDAT,DYES,DNO
          DISPLAY   *P50:12,*EL,*V2LON,DANS16;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
KHOS810   KEYIN     *P50:13,*DV,SP3,*P50:13,*V2LON,CINVRIP;
          MOVE      SP3,KEY3
          CALL      RDSIRNG1
KHOS810A  CALL      RDKIRNG1
          BRANCH    OVRCD,INVRIP
.
          MATCH     IRANGE,CINVRIP
          GOTO      KHOS810A IF NOT EQUAL
.
          DISPLAY   *P50:13,*EL,*V2LON,CINVRIP;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
INVRIP    DISPLAY   *P55:13,*EL,*V2LON,"*** Invalid Range ***",*W2,*P50:13,*EL;
          GOTO      KHOS810
.
KHOS811   KEYIN     *P50:14,*DV,SP3,*P50:14,*V2LON,CINVRAE;
          MOVE      SP3,KEY3
          CALL      RDSIRNG1
KHOS811A  CALL      RDKIRNG1
          BRANCH    OVRCD,INVRAE
.
          MATCH     IRANGE,CINVRAE
          GOTO      KHOS811A IF NOT EQUAL
.
          DISPLAY   *P50:14,*EL,*V2LON,CINVRAE;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
INVRAE    DISPLAY   *P55:14,*EL,*V2LON,"*** Invalid Range ***",*W2,*P50:14,*EL;
          GOTO      KHOS811
.
KHOS812   KEYIN     *P50:15,*DV,SP3,*P50:15,*V2LON,CINVROF;
          MOVE      SP3,KEY3
          CALL      RDSIRNG1
KHOS812A  CALL      RDKIRNG1
          BRANCH    OVRCD,INVROF
.
          MATCH     IRANGE,CINVROF
          GOTO      KHOS812A IF NOT EQUAL
.
          DISPLAY   *P50:15,*EL,*V2LON,CINVROF;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
INVROF    DISPLAY   *P55:15,*EL,*V2LON,"*** Invalid Range ***",*W2,*P50:15,*EL;
          GOTO      KHOS812
.
KHOS813   KEYIN     *P50:16,*EL,*V2LON,C3BDAYS;
          DISPLAY   *P50:16,*EL,*V2LON,C3BDAYS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
KHOS814   KEYIN     *P50:17,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS814Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS814N IF EQUAL
          BEEP
          GOTO      KHOS814
.
KHOS814Y  MOVE      ONE,CREMINV
          GOTO      KHOS814D
.
KHOS814N  MOVE      ZERO,CREMINV
.
KHOS814D  MOVE      DNO,DANS17
          LOAD      DANS17,CREMINV,DYES,DNO
          DISPLAY   *P50:17,*EL,*V2LON,DANS17;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
KHOS815   KEYIN     *P50:18,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS815Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS815N IF EQUAL
          BEEP
          GOTO      KHOS815
.
KHOS815Y  MOVE      ONE,CLUNTNO
          GOTO      KHOS815D
.
KHOS815N  MOVE      ZERO,CLUNTNO
.
KHOS815D  MOVE      DNO,DANS18
          LOAD      DANS18,CLUNTNO,DYES,DNO
          DISPLAY   *P50:18,*EL,*V2LON,DANS18;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
KHOS816   MOVE      ZERO,FORM1
          DISPLAY   *P1:24,*EL,*V2LON,"1",*HOFF,". Normal ",*V2LON,"2":
                    *HOFF," = Melb. Clinic";
          KEYIN     *P50:19,*EL,*V2LON,FORM1;
.
          BRANCH    FORM1,KHOS8161,KHOS8162
          BEEP
          GOTO      KHOS816
.
KHOS8161  DISPLAY   *P50:19,*V2LON,FORM1,"  ",NORMAL,*P1:24,*EL;
          MOVE      FORM1,BEDCENS
          GOTO      KHOS816E
.
KHOS8162  DISPLAY   *P50:19,*V2LON,FORM1,"  ",MELBCLIN,*P1:24,*EL;
          MOVE      FORM1,BEDCENS
.
KHOS816E  MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
KHOS817   MOVE      SP3,CRESIDT
          KEYIN     *P50:20,*EL,*V2LON,CRESIDT;
          MATCH     SP3,CRESIDT
          GOTO      INVRESD IF EQUAL
          PACK      KEY5,CODET,CRESIDT
          CALL      RDCODE1
          BRANCH    OVRCD,INVRESD
          DISPLAY   *P57:20,*V2LON,TDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
INVRESD   DISPLAY   *P50:20,*B,*V2LON,"** Invalid Resident Status **",*W2;
          GOTO      KHOS817
.
KHOS818   MOVE      SP3,CNONRES
          KEYIN     *P50:21,*EL,*V2LON,CNONRES;
          MATCH     SP3,CNONRES
          GOTO      INVNONR IF EQUAL
          PACK      KEY5,CODET,CNONRES
          CALL      RDCODE1
          BRANCH    OVRCD,INVNONR
          DISPLAY   *P57:21,*V2LON,TDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
INVNONR   DISPLAY   *P50:21,*B,*V2LON,"** Invalid Resident Status **",*W2;
          GOTO      KHOS818
.
KHOS819   KEYIN     *P50:22,*EL,*V2LON,CYRSRES;
          DISPLAY   *P50:22,*EL,*V2LON,CYRSRES;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
.--------- keyin default admission care class (CC) for w. lists in hos31 -----
.
KHOS820   MOVE      SP3,CADMCAT
          KEYIN     *P50:23,*EL,*V2LON,CADMCAT;
          MATCH     SP3,CADMCAT
          GOTO      INVADMC IF EQUAL
          PACK      KEY5,CODECC,CADMCAT
          CALL      RDCODE1
          BRANCH    OVRCD,INVADMC
          DISPLAY   *P57:23,*V2LON,TDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS8
.
INVADMC   DISPLAY   *P50:23,*B,*V2LON,"** Invalid Adm. Category **",*W2;
          GOTO      KHOS820
.
. -----   Hospital Screen 9 -----
.
UPHOS9    CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHOS91,KHOS92,KHOS93,KHOS94,KHOS95,KHOS96,KHOS97:
                          KHOS98,KHOS99,KHOS910,KHOS911,KHOS912,KHOS913,KHOS914:
                          KHOS915,KHOS916,KHOS917,KHOS918,KHOS919
          BEEP
          GOTO      UPHOS9
.
KHOS91    MOVE      SP3,COTHARE
          KEYIN     *P50:4,*EL,*V2LON,COTHARE;
          MATCH     SP3,COTHARE
          GOTO      INVOTH IF EQUAL
          PACK      KEY5,CODEU1,COTHARE
          CALL      RDCODE1
          BRANCH    OVRCD,INVOTH
          DISPLAY   *P57:4,*V2LON,TDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS9
.
INVOTH    DISPLAY   *P50:4,*B,*V2LON,"** Invalid Area Code **",*W2;
          GOTO      KHOS91
.
KHOS92    MOVE      SP3,COVRARE
          KEYIN     *P50:5,*EL,*V2LON,COVRARE;
          MATCH     SP3,COVRARE
          GOTO      INVOVR IF EQUAL
          PACK      KEY5,CODEU1,COVRARE
          CALL      RDCODE1
          BRANCH    OVRCD,INVOVR
          DISPLAY   *P57:5,*V2LON,TDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS9
.
INVOVR    DISPLAY   *P50:5,*B,*V2LON,"** Invalid Area Code **",*W2;
          GOTO      KHOS92
.
KHOS93    MOVE      SP2,COIDINP
          KEYIN     *P50:6,*EL,*V2LON,COIDINP;
          RESET     COIDINP
          GOTO      KHOS931 IF EOS
.
          PACK      KEY5,COIDINP,SP3
          CALL      RDCODE1
          DISPLAY   *P57:6,*V2LON,TDESC
.
KHOS931   MOVE      ZERO,OVRCD
          GOTO      UPHOS9
.
INVOIIP   DISPLAY   *P50:6,*B,*V2LON,"** Invalid Category **",*W2;
          GOTO      KHOS93
.
KHOS94    MOVE      SP2,COIDAAE
          KEYIN     *P50:7,*EL,*V2LON,COIDAAE;
          RESET     COIDAAE
          GOTO      KHOS941 IF EOS
.
          PACK      KEY5,COIDAAE,SP3
          CALL      RDCODE1
          DISPLAY   *P57:7,*V2LON,TDESC;
.
KHOS941   MOVE      ZERO,OVRCD
          GOTO      UPHOS9
.
KHOS95    MOVE      SP2,COIDOUT
          KEYIN     *P50:8,*EL,*V2LON,COIDOUT;
          RESET     COIDOUT
          GOTO      KHOS951 IF EOS
.
          PACK      KEY5,COIDOUT,SP3
          CALL      RDCODE1
          DISPLAY   *P57:8,*V2LON,TDESC;
.
KHOS951   MOVE      ZERO,OVRCD
          GOTO      UPHOS9
.
KHOS96    KEYIN     *P50:9,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS96Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS96N IF EQUAL
          BEEP
          GOTO      KHOS96
.
KHOS96Y   MOVE      ONE,CPCINLE
          GOTO      KHOS96DS
.
KHOS96N   MOVE      ZERO,CPCINLE
.
KHOS96DS  MOVE      DNO,DANS
          LOAD      DANS,CPCINLE,DYES,DNO
          DISPLAY   *P50:9,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS9
.
KHOS97    KEYIN     *P50:10,*V2LON,*EL,CGSTPERC;
          DISPLAY   *P50:10,*V2LON,*EL,CGSTPERC;
          MOVE      ZERO,OVRCD
.
          COMPARE   ZERO,CGSTPERC
          GOTO      UPHOS9 IF NOT LESS
.
          DISPLAY   *P60:10,*EL,*V2LON,*B,"** Invalid percentage ** ",*W;
          GOTO      KHOS97
.
KHOS98    KEYIN     *P50:11,*V2LON,*EL,CGSTITEM;
          ENDSET    CGSTITEM
          APPEND    SP4,CGSTITEM
          RESET     CGSTITEM
.
          DISPLAY   *P50:11,*V2LON,CGSTITEM;
.
          MATCH     SP4,CGSTITEM
          GOTO      KHOS98M IF EQUAL
.
          READ      CONTROLF,TWENTY;*193,PTCNDCLM
          MATCH     SP70,PTCNDCLM
          IF        @EQUAL
            MOVE      "0  ",PTCNDCLM          * use zero claim code
          ENDIF
.
          PACK      KEY29,PTCNDCLM,SP6,SP3,CGSTITEM,CURRDATE,SP10
          CALL      PATMCHRD                * read Misc.Charges file
          BRANCH    EXIT,KHOS98E
.
          MOVE      MDESC,GSTDESC
          MOVE      ZERO,OVRCD
          DISPLAY   *P57:11,*V2LON,GSTDESC;
          GOTO      UPHOS9
.
KHOS98E   IF        WKMCINAC = 1
            DISPLAY   *P57:11,*V2LON,*EL,*B,"** Item inactive ** ",*W;
          ELSE
            IF        WKMCXXDT = 1
              DISPLAY   *P57:11,*V2LON,*EL,*B,"** outside Date Range ** ",*W;
            ELSE
              DISPLAY   *P57:11,*V2LON,*EL,*B,"** Invalid Item ** ",*W;
            ENDIF
          ENDIF
          GOTO      KHOS98
.
KHOS98M   DISPLAY   *P57:11,*V2LON,*EL,*B,"** Mandatory ** ",*W;
          GOTO      KHOS98
.
KHOS99    KEYIN     *P50:12,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS99Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS99N IF EQUAL
          BEEP
          GOTO      KHOS99
.
KHOS99Y   MOVE      ONE,CYRESMAN
          GOTO      KHOS99DS
.
KHOS99N   MOVE      ZERO,CYRESMAN
.
KHOS99DS  MOVE      DNO,DANS1
          LOAD      DANS1,CYRESMAN,DYES,DNO
          DISPLAY   *P50:12,*EL,*V2LON,DANS1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS9
.
KHOS910   KEYIN     *P50:13,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS910Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS910N IF EQUAL
          BEEP
          GOTO      KHOS910
.
KHOS910Y  MOVE      ONE,CBIRTHCN
          GOTO      KHOS910D
.
KHOS910N  MOVE      ZERO,CBIRTHCN
.
KHOS910D  MOVE      DNO,DANS1
          LOAD      DANS1,CBIRTHCN,DYES,DNO
          DISPLAY   *P50:13,*EL,*V2LON,DANS1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS9
.
KHOS911   DISPLAY   *P1:24,*V2LON,ONE,*HOFF," = ",DMRGOLD,SP2:
                    *V2LON,TWO,*HOFF," = ",DMRGNEW;
.
KHOS911A  KEYIN     *P50:14,*EL,*V2LON,CMERGEUR;
.
          BRANCH    CMERGEUR,KHOS911B,KHOS911B
          BEEP
          GOTO      KHOS911A
.
KHOS911B  DISPLAY   *P1:24,*EL;
          LOAD      MERGDESC,CMERGEUR,DMRGOLD,DMRGNEW
          DISPLAY   *P50:14,*V2LON,MERGDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS9
.
. ------- Keyin Oper.Date & Time for Morbidity Data Entry ? -------
.
KHOS912   MOVE      "50",HLEF
          MOVE      "09",HTOP
          MOVE      "78",HRIG
          MOVE      "14",HBOT

          CALL      GETSCR00                * Save the current screen
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,*V2LON,HLEF,HTOP,HRIG,HBOT
.
          DISPLAY   *P51:10,*V2LON,"1 ",*HOFF,OTIMENON:         * => "2"
                    *P51:11,*V2LON,"2 ",*HOFF,OTIMEEXS:         * => "1"
                    *P51:12,*V2LON,"3 ",*HOFF,OTIMEMAN;         * => "0"
.
KHOS912A  KEYIN     *P50:15,*EL,*DV,UNDLN1,*P50:15,*V2LON,ANS;

          MOVE      TWO,F1                  * default
          MOVE      ANS,F1
          IF        F1 < 1 | F1 > 3
            GOTO      KHOS912A
          ENDIF
.
          CALL      PUTSCR00                * restore previous screen
          MOVE      ZERO,OVRCD              * Post changes later on
          BRANCH    F1,KHOS912B,KHOS912C,KHOS912D
KHOS912B  DISPLAY   *P50:15,*V2LON,OTIMENON;          * no times
          MOVE      TWO,CMORBDTM
          GOTO      UPHOS9
.
KHOS912C  DISPLAY   *P50:15,*V2LON,OTIMEEXS;
          MOVE      ONE,CMORBDTM                     * times available
          GOTO      UPHOS9
.
KHOS912D  IF        PTMORBDT <> 2
            DISPLAY   *P1:23,*EL,"Oper.Date is not mandatory, so Times ":
                                 "cannot be mandatory",*W2;
            DISPLAY   *P1:23,*EL,SP1
            GOTO    KHOS912C                * change to "Times Available"
          ENDIF
          DISPLAY   *P50:15,*V2LON,OTIMEMAN;
          MOVE      ZERO,CMORBDTM                    * times mandatory
          GOTO      UPHOS9
.
. ------- Not Keyin Oper.Date for Morbidity Data Entry ? -------
.
KHOS913   MOVE      "50",HLEF               
          MOVE      "10",HTOP
          MOVE      "78",HRIG
          MOVE      "15",HBOT
 
          CALL      GETSCR00                * Save the current screen
          BOXCLR    HLEF,HTOP,HRIG,HBOT              
          BOX       16,*V2LON,HLEF,HTOP,HRIG,HBOT
.
          DISPLAY   *P51:11,*V2LON,"1 ",*HOFF,ODATENON:               * => "1"
                    *P51:12,*V2LON,"2 ",*HOFF,ODATEEXS:               * => "0"
                    *P51:13,*V2LON,"3 ",*HOFF,ODATEMAN;               * => "2"
.           
KHOS913A  KEYIN     *P50:16,*EL,*DV,UNDLN1,*P50:16,*V2LON,ANS; 
          
          MOVE      TWO,F1                  * default
          MOVE      ANS,F1
          IF        F1 < 1 | F1 > 3
            GOTO      KHOS913A
          ENDIF
.
          CALL      PUTSCR00                * restore previous screen
          MOVE      ZERO,OVRCD              * Post changes later on
          BRANCH    F1,KHOS913B,KHOS913C,KHOS913D
          GOTO      KHOS913C
.
KHOS913B  DISPLAY   *P50:16,*V2LON,ODATENON;          * no Date
          MOVE      ONE,PTMORBDT
          GOTO      UPHOS9
.
KHOS913C  DISPLAY   *P50:16,*V2LON,ODATEEXS;
          MOVE      ZERO,PTMORBDT                    * Date available
          GOTO      UPHOS9
.
KHOS913D  DISPLAY   *P50:16,*V2LON,ODATEMAN;
          MOVE      TWO,PTMORBDT                     * Date mandatory
          GOTO      UPHOS9
.
.
KHOS914   DISPLAY   *P50:17,UNDLN9;
          KEYIN     *P50:17,*V2LON,CALRDESC;
.
          ENDSET    CALRDESC
          APPEND    SP9,CALRDESC
          RESET     CALRDESC
.
          DISPLAY   *P50:17,*V2LON,CALRDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS9
.
.------ keyin user defined stationery code ------
.
KHOS915   MOVE      SP6,CPIDCOD
          DISPLAY   *P50:18,*EL,UNDLN6;
          KEYIN     *P50:18,*V2LON,*RV,CPIDCOD;
          DISPLAY   *P50:18,*V2LON,CPIDCOD;
.
          ENDSET    CPIDCOD
          APPEND    SP6,CPIDCOD
          RESET     CPIDCOD
.
          MATCH     SP6,CPIDCOD
          GOTO      KHOS915Y IF EQUAL
.
          MOVE      CPIDCOD,KEY6
          CALL      RDIBTH1
          BRANCH    OVRCD,KHOS915N
.
          COMPARE   THREE,IBTHSTFM
          GOTO      KHOS915I IF NOT EQUAL
.
KHOS915Y  MOVE      ZERO,OVRCD
          GOTO      UPHOS9
.
KHOS915N  DISPLAY   *P1:24,*EL,*B,*V2LON,"Stationery Code not on file.  ";
          CALL      HITENTER
          GOTO      KHOS915
.
KHOS915I  DISPLAY   *P1:24,*EL,*B,*V2LON:
                    "Stationery Code is an invalid type.  ";
          CALL      HITENTER
          GOTO      KHOS915
.
. ------- Keyin Category used for Anaesthetic in Day only procedure form
.
KHOS916   MOVE       SP2,CDOPANA
          KEYIN      *P50:19,*EL,*V2LON,CDOPANA;
          RESET      CDOPANA
          GOTO       UPHOS9 IF EOS
.
          PACK       KEY5 WITH CDOPANA,SP3
          CALL       RDCODE1
          BRANCH     OVRCD OF KHOS916N
.
          DISPLAY    *P50:19,*EL,*V2LON,CDOPANA," ",TDESC;
          GOTO       KHOS916Y
.
KHOS916N  DISPLAY    *P1:24,*EL,*V2LON,*B,"** Invalid Category **     ";
          CALL       HITENTER
          GOTO       KHOS916
.
KHOS916Y  MOVE       ZERO,OVRCD
          GOTO       UPHOS9
.
. ------- Print Ward on labels for Pre-admission patients ? -------
.
KHOS917   KEYIN     *P50:20,*EL,*DV,UNDLN1,*P50:20,*V2LON,ANS;
          RESET     ANS
          GOTO      KHOS917N IF EOS
          MATCH     ANSN,ANS
          GOTO      KHOS917N IF EQUAL
          MATCH     ANSY,ANS
          GOTO      KHOS917Y IF EQUAL
          BEEP
          GOTO      KHOS917
.
KHOS917Y  DISPLAY   *P50:20,*V2LON,"Yes";
          MOVE      ONE,PTWRDLAB
          GOTO      KHOS917X
.
KHOS917N  DISPLAY   *P50:20,*V2LON,"No ";
          MOVE      ZERO,PTWRDLAB
.
KHOS917X  MOVE      ZERO,OVRCD
          GOTO      UPHOS9
.
KHOS918   KEYIN     *P50:21,*EL,*V2LON,PTURLAB;
          DISPLAY   *P50:21,*EL,*V2LON,PTURLAB;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS9
.
. ------- Previous name defaults to an alias ? -------
.
KHOS919   KEYIN     *P50:22,*EL,*DV,UNDLN1,*P50:22,*V2LON,ANS;
          RESET     ANS
          GOTO      KHOS919N IF EOS
          MATCH     ANSN,ANS
          GOTO      KHOS919N IF EQUAL
          MATCH     ANSY,ANS
          GOTO      KHOS919Y IF EQUAL
          BEEP
          GOTO      KHOS919
.
KHOS919Y  DISPLAY   *P50:22,*V2LON,"Yes";
          MOVE      ONE,PTPRVALS
          GOTO      KHOS919X
.
KHOS919N  DISPLAY   *P50:22,*V2LON,"No ";
          MOVE      ZERO,PTPRVALS
.
KHOS919X  MOVE      ZERO,OVRCD
          GOTO      UPHOS9
.
.------------------------------------------------------------------------------
.         Hospital Screen 10
.------------------------------------------------------------------------------
UPHOS10   CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHOS101,KHOS102,KHOS103,KHOS104,KHOS105,KHOS106
          BEEP
          GOTO      UPHOS10
.
KHOS101   PACK      CNOCLMS,SP30,SP30,SP30
          KEYIN     *P5:5,*EL,*V2LON,CNOCLMS;
.
          DISPLAY   *P5:5,*EL,*V2LON,CNOCLMS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS10
.
KHOS102   PACK      CINMES1,SP30,SP30
          KEYIN     *P5:8,*EL,*V2LON,CINMES1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS10
.
KHOS103   PACK      CINMES2,SP30,SP30
          KEYIN     *P5:11,*EL,*V2LON,CINMES2;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS10
.
KHOS104   KEYIN     *P5:14,*EL,*RV,*V2LON,PTCNQUM1;
          DISPLAY   *P5:14,*EL,*V2LON,PTCNQUM1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS10
.
KHOS105   KEYIN     *P5:17,*EL,*RV,*V2LON,PTCNQUM2;
          DISPLAY   *P5:17,*EL,*V2LON,PTCNQUM2;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS10
.
KHOS106   KEYIN     *P5:20,*EL,*RV,*V2LON,PTCNAUED;
          DISPLAY   *P5:20,*EL,*V2LON,PTCNAUED;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS10
.
. -----   Hospital Screen 11A -----
.
UPHOS11A  CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHS11A1,KHS11A2,KHS11A3,KHS11A4,KHS11A5,KHS11A6:
                          KHS11A7,KHS11A8,KHS11A9
          BEEP
          GOTO      UPHOS5
.
.
KHS11A1   KEYIN     *P44:4,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHS11A1Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHS11A1N IF EQUAL
          BEEP
          GOTO      KHS11A1
.
KHS11A1Y  MOVE      ONE,CMUSR4
          GOTO      KHS11A1S
.
KHS11A1N  MOVE      ZERO,CMUSR4
.
KHS11A1S  MOVE      DNO,DANS
          LOAD      DANS,CMUSR4,DYES,DNO
          DISPLAY   *P44:4,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS11A
.
KHS11A2   MOVE      SP20,CMUSDS4
          KEYIN     *P44:5,*EL,*V2LON,CMUSDS4;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS11A
.
KHS11A3   KEYIN     *P44:6,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHS11A3Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHS11A3N IF EQUAL
          BEEP
          GOTO      KHS11A3
.
KHS11A3Y  MOVE      ONE,CMUSMAN4
          GOTO      KHS11A3S
.
KHS11A3N  MOVE      TWO,CMUSMAN4
.
KHS11A3S  MOVE      DNO,DANS
          LOAD      DANS,CMUSMAN4,DYES,DNO
          DISPLAY   *P44:6,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS11A
.
.
KHS11A4   KEYIN     *P44:7,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHS11A4Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHS11A4N IF EQUAL
          BEEP
          GOTO      KHS11A4
.
KHS11A4Y  MOVE      ONE,CMUSR5
          GOTO      KHS11A4S
.
KHS11A4N  MOVE      ZERO,CMUSR5
.
KHS11A4S  MOVE      DNO,DANS
          LOAD      DANS,CMUSR5,DYES,DNO
          DISPLAY   *P44:7,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS11A
.
KHS11A5   MOVE      SP20,CMUSDS5
          KEYIN     *P44:8,*EL,*V2LON,CMUSDS5;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS11A
.
KHS11A6   KEYIN     *P44:9,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHS11A6Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHS11A6N IF EQUAL
          BEEP
          GOTO      KHS11A6
.
KHS11A6Y  MOVE      ONE,CMUSMAN5
          GOTO      KHS11A6S
.
KHS11A6N  MOVE      TWO,CMUSMAN5
KHS11A6S  MOVE      DNO,DANS
          LOAD      DANS,CMUSMAN5,DYES,DNO
          DISPLAY   *P44:9,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS11A
.
KHS11A7   KEYIN     *P44:10,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHS11A7Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHS11A7N IF EQUAL
          BEEP
          GOTO      KHS11A7
.
KHS11A7Y  MOVE      ONE,CMUSR6
          GOTO      KHS11A7S
.
KHS11A7N  MOVE      ZERO,CMUSR6
.
KHS11A7S  MOVE      DNO,DANS
          LOAD      DANS,CMUSR6,DYES,DNO
          DISPLAY   *P44:10,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS11A
.
KHS11A8   MOVE      SP20,CMUSDS6
          KEYIN     *P44:11,*EL,*V2LON,CMUSDS6;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS11A
.
KHS11A9   KEYIN     *P44:12,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHS11A9Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHS11A9N IF EQUAL
          BEEP
          GOTO      KHS11A9
.
KHS11A9Y  MOVE      ONE,CMUSMAN6
          GOTO      KHS11A9S
.
KHS11A9N  MOVE      TWO,CMUSMAN6
KHS11A9S  MOVE      DNO,DANS
          LOAD      DANS,CMUSMAN6,DYES,DNO
          DISPLAY   *P44:12,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS11A
.
. -----   Hospital Screen 11 -----
.
UPHOS11   CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHOS111,KHOS112,KHOS113,KHOS114
          BEEP
          GOTO      UPHOS11
.
KHOS111   PACK      CMSINV1,SP30,SP30
          KEYIN     *P5:5,*EL,*V2LON,CMSINV1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS11
.
KHOS112   PACK      CMSINV2,SP30,SP30
          KEYIN     *P5:8,*EL,*V2LON,CMSINV2;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS11
.
KHOS113   PACK      CMSINV3,SP30,SP30
          KEYIN     *P5:11,*EL,*V2LON,CMSINV3;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS11
.
KHOS114   MOVE      SP8,CFEEMDT
          MOVE      "14",VERT
          MOVE      "42",COL
          CALL      KEYINDTE
          PACK      CFEEMDT,ICENT,IYEAR,IMON,IDAY
          REP       " 0",CFEEMDT
          RESET     CFEEMDT
          MOVE      ZERO,OVRCD
          GOTO      UPHOS11
.
. -----   Hospital Screen 12 -----
.
UPHOS12   
.
UPHOS12A  CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
          DISPLAY   *P28:24,*EL,*V2LON,CCITEM;
.
          BRANCH    CCITEM,KHOS125,KHOS126,KHOS127,KHOS128,KHOS129:
                           KHOS1210,KHOS1211,KHOS1212,KHOS1213,KHOS1214:
                           KHOS1215,KHOS1216,KHOS1217,KHOS1218,KHOS1219:
                           KHOS1220,KHOS1221,KHOS1222,KHOS1223,KHOS1224
          BEEP
          GOTO      UPHOS12A
.
KHOS125   KEYIN     *P50:4,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHOS125Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS125N IF EQUAL
          BEEP
          GOTO      KHOS125
.
KHOS125Y  MOVE      ONE,PTCNALLC
          GOTO      KHOS125S
.
KHOS125N  MOVE      TWO,PTCNALLC
KHOS125S  MOVE      DNO,DANS
          LOAD      DANS,PTCNALLC,DYES,DNO
          DISPLAY   *P50:4,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
KHOS126   KEYIN     *P50:5,*EL,*DV,UNDLN4,*P50:5,*V2LON,PTCNBRD;
.
          ENDSET    PTCNBRD
          APPEND    SP4,PTCNBRD
          RESET     PTCNBRD
.
          DISPLAY   *P50:5,*V2LON,PTCNBRD;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
. ------- keyin HSS Extract Method value -------
.
KHOS127   DISPLAY   *P1:24,"(",*V2LON,ZERO,*HOFF,") = Date of Coding (",*V2LON:
                    ONE,*HOFF,") = Discharge Date/Coding",*EL;
.
          KEYIN     *P50:06,*DV,UNDLN1,*EL,*P50:06,*V2LON,PTCNHSEM;
.
          COMPARE   ZERO,PTCNHSEM
          GOTO      KHOS127A IF EQUAL       * zero entered
.
          COMPARE   ONE,PTCNHSEM
          GOTO      KHOS127B IF EQUAL       * one entered
          BEEP
          GOTO      KHOS127
.
.         Zero entered - Date of Coding
.
KHOS127A  MOVE      "Date of Coding",HSEMMETH
          DISPLAY   *P50:06,*V2LON,PTCNHSEM,*HOFF,*P54:06,HSEMMETH;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
.         One entered - Discharge Date/Coding
.
KHOS127B  MOVE      "Discharge Date/Coding",HSEMMETH
          DISPLAY   *P50:06,*V2LON,PTCNHSEM,*HOFF,*P54:06,HSEMMETH;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
.--- Keyin Defaults for Adm Keyins ---
.
KHOS128   KEYIN     *P50:07,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
          MATCH     "Y",ANS
          GOTO      KHOS128Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS128N IF EQUAL
          BEEP
          GOTO      KHOS128
.
KHOS128Y  MOVE      ONE,PTCNDFBO
          GOTO      KHOS128S
.
KHOS128N  MOVE      TWO,PTCNDFBO
.
KHOS128S  MOVE      DNO,DANS
          LOAD      DANS,PTCNDFBO,DYES,DNO
          DISPLAY   *P50:07,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
.--- Keyin T.A.C. Provider number ---
.
KHOS129   KEYIN     *P50:08,*EL,*DV,UNDLN20,*P50:08,*V2LON,PTCNTACP:
                    *P50:08,*DV,PTCNTACP;
          RESET     PTCNTACP
          GOTO      KHOS129A IF NOT EOS
          MOVE      SP20,PTCNTACP
.
KHOS129A  MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
. ------  keyin default type of leave -------
.
KHOS1210  KEYIN     *P50:09,*DV,UNDLN3,*EL:
                    *P50:09,*V2LON,PTCNDLVE:
                    *P50:09,*DV,PTCNDLVE
.
          ENDSET    PTCNDLVE
          APPEND    SP3,PTCNDLVE
          RESET     PTCNDLVE
.
          PACK      KEY5,ANST,ANSL,PTCNDLVE
          CALL      RDCODE1
          COMPARE   ZERO,OVRCD
          GOTO      KHS1210X IF EQUAL      
.
          DISPLAY   *P1:24,*B,"Invalid code.  ",*EL;
          CALL      HITENTER 
          GOTO      KHOS1210
.
KHS1210X  DISPLAY   *P54:09,TDESC
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
.--- Keyin Input alert in HOS31/PAT31 ---
.
KHOS1211  KEYIN     *P50:10,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
          MATCH     "Y",ANS
          GOTO      KHS1211Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHS1211N IF EQUAL
          BEEP
          GOTO      KHOS1211
.
KHS1211Y  MOVE      ONE,PTALRH31
          GOTO      KHS1211S
.
KHS1211N  MOVE      TWO,PTALRH31
.
KHS1211S  MOVE      DNO,DANS
          LOAD      DANS,PTALRH31,DYES,DNO
          DISPLAY   *P50:10,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
. ------  keyin default claim code for charging -------
.
KHOS1212  KEYIN     *P50:11,*DV,UNDLN3,*EL:
                    *P50:11,*V2LON,PTCNDCLM:
                    *P50:11,*DV,PTCNDCLM
.
          ENDSET    PTCNDCLM
          APPEND    SP3,PTCNDCLM
          RESET     PTCNDCLM
.
          PACK      KEY5,CODECL,PTCNDCLM
          CALL      RDCODE1
          COMPARE   ZERO,OVRCD
          GOTO      KHS1212X IF EQUAL      
.
          DISPLAY   *P1:24,*B,"Invalid code.  ",*EL;
          CALL      HITENTER 
          GOTO      KHOS1212
.
KHS1212X  DISPLAY   *P54:11,TDESC
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
. ------  keyin default claim code for keyin -------
.
KHOS1213  KEYIN     *P50:12,*DV,UNDLN3,*EL:
                    *P50:12,*V2LON,PTCNDKCL:
                    *P50:12,*DV,PTCNDKCL
.
          ENDSET    PTCNDKCL
          APPEND    SP3,PTCNDKCL
          RESET     PTCNDKCL
.
          PACK      KEY5,CODECL,PTCNDKCL
          CALL      RDCODE1
          COMPARE   ZERO,OVRCD
          GOTO      KHS1213X IF EQUAL      
.
          DISPLAY   *P1:24,*B,"Invalid code.  ",*EL;
          CALL      HITENTER 
          GOTO      KHOS1213
.
KHS1213X  DISPLAY   *P54:12,TDESC
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
. ------  keyin whether card information is to be used -------
.
KHOS1214  MOVE      "50",CCOL                * column for keyin
          MOVE      TEN3,CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNUCRD            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
. ------  keyin whether family id is to be used -------
.
KHOS1215  MOVE      "50",CCOL                * column for keyin
          MOVE      TEN4,CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNUFML            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
. ------  keyin print invoice options -------
.
KHOS1216  DISPLAY   *P1:24,*EL:
                    *V2LON,ZERO,*HOFF," = ",DPIOPT0,", ":
                    *V2LON,ONE,*HOFF," = ",DPIOPT1;
.
KHS1216A  KEYIN     *P50:15,*EL,*DV,UNDLN1:
                    *P50:15,*V2LON,PTCNPIOP:
                    *P50:15,*DV,PTCNPIOP
.
          COMPARE   ZERO,PTCNPIOP
          GOTO      KHS1216Y IF EQUAL
.
          BRANCH    PTCNPIOP,KHS1216Y
          BEEP
          GOTO      KHS1216A
.
KHS1216Y  MOVE      DPIOPT0,DPIOPT
          LOAD      DPIOPT,PTCNPIOP,DPIOPT1
.
          DISPLAY   *P50:15,*V2LON,PTCNPIOP,*HOFF,*P54:15,DPIOPT
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
. ------  keyin board charging start date -------
.
KHOS1217  MOVE      "50",CCOL                * column for keyin
          MOVE      "16",CVERT               * row for keyin
          CALL      KDM0000                  * keyin a day and month
          PACK      PTCNBCUT,CMON,CDAY       * pack up entered date
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
. ------  keyin whether to default the card details from previous visit -------
.
KHOS1218  MOVE      "50",CCOL                * column for keyin
          MOVE      "17",CVERT            * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNCDEF            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
. ------  keyin whether to audit card details -------
.
KHOS1219  MOVE      "50",CCOL                * column for keyin
          MOVE      "18",CVERT            * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      ONE,PTCNVKCA             * We want No to be "1"
          LOAD      PTCNVKCA,EXIT,ZERO       * and Yes to be "0"
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
. ------  keyin home board for checking for other board referrals ------
.
KHOS1220  KEYIN     *P50:19,*EL,*DV,UNDLN6:
                    *P50:19,*V2LON,PTCNHBRD:
                    *P50:19,*DV,PTCNHBRD;
.
          PACK      PTCNHBRD,PTCNHBRD,SP20
.
          MATCH     SP6,PTCNHBRD             * nothing input ?
          GOTO      KHS1220Z IF EQUAL        * no, valid code
.
          PACK      KEY14,PTCNHBRD,ZERO,ZERO,ZERO,ZERO,SP10
          CALL      RDFUND1
          BRANCH    OVRCD,KHS1220E
.
          GOTO      KHS1220Y
.
KHS1220E  DISPLAY   *P1:24,*EL,*B,"Invalid code. ";
          CALL      HITENTER
          GOTO      KHOS1220
.
KHS1220Y  MOVE      HFNAME,FUNDDESC
          DISPLAY   *P58:19,FUNDDESC
.
KHS1220Z  MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
. ******* no fixed abode postcode *****
.
KHOS1221  KEYIN     *P50:20,*V2LON,PTCNNFAP:
                    *P50:20,*DV,PTCNNFAP
          PACK      PTCNNFAP,PTCNNFAP,SP8
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
. ******* no fixed abode district of residence *******
.
KHOS1222  KEYIN     *P50:21,*V2LON,PTCNNFAD:
                    *P50:21,*DV,PTCNNFAD
          PACK      PTCNNFAD,PTCNNFAD,SP8
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
. ******* security level for d.o.r. keyin in GB mailer interface *******
.
KHOS1223  KEYIN     *P50:22,*V2LON,PTCNDORO:
                    *P50:22,*DV,PTCNDORO
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12
.
. ------  keyin whether patient will be casemix funded upon Admission -------
.
KHOS1224  MOVE      "50",CCOL                * column for keyin
          MOVE      "23",CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNCMXF            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS12

. -----   Hospital Screen 13 -----
.
UPHOS13   CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHOS1301,KHOS1303,KHOS1304,KHOS1305:
                           KHOS1306,KHOS1307,KHOS1308,KHOS1309,KHOS1310:
                           KHOS1311,KHOS1312,KHOS1313,KHOS1314,KHOS1315:
                           KHOS1316,KHOS1317,KHOS1318,KHOS1319,KHOS1320:
                           KHOS1321
          BEEP
          GOTO      UPHOS13
.
KHOS1301  MOVE      ZERO,PTCNSCLS
          DISPLAY   *P1:23,*EF:
                    *V2LON,ZERO,*HOFF," = ",DHIGHMBS:
                    *V2LON,ONE,*HOFF," = ",DHIGHAMT;
.
          KEYIN     *P50:4,*EL,*V2LON,PTCNSCLS,*P1:23,*EF;
.
          MOVE      ZERO,OVRCD
          BRANCH    PTCNSCLS,KHS1301A
          COMPARE   ZERO,PTCNSCLS
          GOTO      KHS1301A IF EQUAL
          BEEP
          GOTO      KHOS1301
.
KHS1301A  MOVE      DHIGHMBS,DHIGHDES
          LOAD      DHIGHDES,PTCNSCLS,DHIGHAMT
          DISPLAY   *P50:4,*V2LON,PTCNSCLS,*HOFF,*P55:4,DHIGHDES;
          GOTO      UPHOS13
.
KHOS1303  DISPLAY   *P1:23,*EF:
                    *V2LON,ZERO,*HOFF," = ",DCNDY0,", ":
                    *V2LON,ONE,*HOFF," = ",DCNDY1;
.
          KEYIN     *P50:5,*EL,*V2LON,PTCNCNDY,*P1:23,*EF;
.
          MOVE      ZERO,OVRCD
          BRANCH    PTCNCNDY,KHS1303A
          COMPARE   ZERO,PTCNCNDY
          GOTO      KHS1303A IF EQUAL
          BEEP
          GOTO      KHOS1303
.
KHS1303A  MOVE      DCNDY0,DCNDY
          LOAD      DCNDY,PTCNCNDY,DCNDY1
          DISPLAY   *P50:5,*V2LON,PTCNCNDY,*HOFF,*P55:5,DCNDY;
          GOTO      UPHOS13
.
.         Keyin the parameter for the dollar figure to use for the operation 
.         report in IBAPAT93
.
KHOS1304  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = ",DOOP1,", ": 
                               *V2LON,ONE,*HOFF," = ",DOOP2; 
.
.------ keyin the dollar figure desired ------
.
KHOS13K   KEYIN     *P50:6,*EL,*DV,UNDLN1:
                    *P50:6,*V2LON,PTCNDOOP:
                    *P50:6,*DV,PTCNDOOP
.
          BRANCH    PTCNDOOP,KHOS13OK       * test for a valid selection
.
          COMPARE   ZERO,PTCNDOOP           * test for a valid selection
          GOTO      KHOS13OK IF EQUAL
.
          BEEP                              * invalid selection
          GOTO      KHOS13K 
.
.------ display the description ------
.
KHOS13OK  MOVE      DOOP1,DESCDOOP
          LOAD      DESCDOOP,PTCNDOOP,DOOP2
.
          DISPLAY   *P55:6,DESCDOOP;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
. ----- Print patient condition in BIL89? --------
.
KHOS1305  KEYIN     *P50:7,*EL,*V2LON,ANS;
          MATCH     "Y",ANS
          GOTO      KHS1305Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHS1305N IF EQUAL
          BEEP
          GOTO      KHOS1305
.
KHS1305Y  MOVE      ONE,PTCNDPCN
          GOTO      KHS1305D
.
KHS1305N  MOVE      ZERO,PTCNDPCN
.
KHS1305D  MOVE      DNO,DANS1
          LOAD      DANS1,PTCNDPCN,DYES,DNO
          DISPLAY   *P50:7,*EL,*V2LON,DANS1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
. ------- community service card prefix - PTCNCSCP *******
.
KHOS1306  KEYIN     *P50:8,"______":
                    *P50:8,*V2LON,PTCNCSCP
          PACK      PTCNCSCP,PTCNCSCP,SP6
          DISPLAY   *P50:8,*V2LON,PTCNCSCP
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
. ------- print insurance invoices on the certificate of hospitalation ----
.
KHOS1307  KEYIN     *P50:09,*EL,*V2LON,ANS;
          REP       UPPLOW,ANS
          MATCH     "Y",ANS
          GOTO      KHS1307Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHS1307N IF EQUAL
          BEEP
          GOTO      KHOS1307
.
KHS1307Y  MOVE      ONE,PTINSCER
          GOTO      KHS1307D
.
KHS1307N  MOVE      ZERO,PTINSCER
.
KHS1307D  MOVE      DNO,DANS1
          LOAD      DANS1,PTINSCER,DYES,DNO
          DISPLAY   *P50:09,*EL,*V2LON,DANS1;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
. ------  No of lines on free format labels ------
.       
KHOS1308 KEYIN      *P50:10,*EL,*DV,UNDLN1:
                    *P50:10,*V2LON,PTCNLNFF:
                    *P50:10,*DV,PTCNLNFF
.
          COMPARE   FIVE,PTCNLNFF           * test for a valid selection
          GOTO      KHS1308A IF NOT LESS
.
          DISPLAY   *P1:24,*EL,*V2LON:
                    *P10:24,*B,"** Must be greater than or equal to FIVE **":
                    *W2,*HOFF,*P10:24,*EL;
          GOTO      KHOS1308
.
KHS1308A  COMPARE   NINE,PTCNLNFF
          GOTO      KHS1308B IF LESS
.
          DISPLAY   *P1:24,*EL,*V2LON:
                    *P10:24,*B,"** Must be less than or equal to EIGHT **":
                    *W2,*HOFF,*P10:24,*EL;
          GOTO      KHOS1308
.
.------ display the description ------
.
KHS1308B  DISPLAY   *P50:10,*V2LON,PTCNLNFF;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
. ------  Size of free format labels ------
.
KHOS1309  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = ",D38CHAR,", ": 
                               *V2LON,ONE,*HOFF," = ",D33CHAR; 
.
KHS1309A  KEYIN     *P50:11,*EL,*DV,UNDLN1:
                    *P50:11,*V2LON,PTCNCHFF:
                    *P50:11,*DV,PTCNCHFF
.
          BRANCH    PTCNCHFF,KHS1309Y       * test for a valid selection
.
          COMPARE   ZERO,PTCNCHFF           * test for a valid selection
          GOTO      KHS1309Y IF EQUAL
.
          BEEP                              * invalid selection
          GOTO      KHS1309A
.
.------ display the description ------
.
KHS1309Y  MOVE      D38CHAR,DLBCHAR         * default to 38 chars.
          LOAD      DLBCHAR,PTCNCHFF,D33CHAR
.
          DISPLAY   *P55:11,DLBCHAR;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
.
. keyin the baby description parameter for input newborns
.
KHOS1310  DISPLAY   *P1:23,*EF:
                    *V2LON,ZERO,*HOFF," = ",BABDDSC0,", ":
                    *V2LON,ONE,*HOFF," = ",BABDDSC1;
.
          KEYIN     *P50:12,*EL,*V2LON,PTCNBABD,*P1:23,*EF;
          MOVE      ZERO,OVRCD
.
          IF        PTCNBABD<0|PTCNBABD>1
            BEEP
            GOTO    KHOS1310
          ENDIF
.
          MOVE      BABDDSC0,BABDDESC
          LOAD      BABDDESC,PTCNBABD,BABDDSC1
.
          DISPLAY   *P50:12,*V2LON,BABDDESC
          GOTO      UPHOS13
.
. ------  keyin whether user id is to be keyed in HOS73 -------
.
KHOS1311  MOVE      "50",CCOL                * column for keyin
          MOVE      TEN3,CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNOI73            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
. ------  keyin whether ethnicity is to be keyed in HOS73 -------
.
KHOS1312  MOVE      "50",CCOL                * column for keyin
          MOVE      TEN4,CVERT               * row for keyin
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNET73            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
. ------- keyin max. days for entering admission weight -----
.
KHOS1313  MOVE      "50",CCOL
          MOVE      TEN5,CVERT
          KEYIN     *PCCOL:CVERT,*DV,UNDLN3:
                    *PCCOL:CVERT,*V2LON,PTCNBAGE:
                    *PCCOL:CVERT,*DV,PTCNBAGE
          COMPARE   ZERO,PTCNBAGE
          GOTO      KHOS1313 IF LESS
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
. ------- keyin script name for secretary wordprocessor -----
.
KHOS1314  MOVE      "50",CCOL
          MOVE      TEN6,CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,PTCNDSWP:
                    *PCCOL:CVERT,*DV,PTCNDSWP
          PACK      PTCNDSWP,PTCNDSWP,SP30
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
.------ keyin DRG Grouper to use for IBAPMS99 ------
.
KHOS1315  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = ",DRGDESC1,", ": 
                               *V2LON,ONE,*HOFF," = ",DRGDESC2; 
.
KHS1315A  KEYIN     *P50:17,*EL,*DV,UNDLN1:
                    *P50:17,*V2LON,PTCNDRGG:
                    *P50:17,*DV,PTCNDRGG
.
          BRANCH    PTCNDRGG,KHS1315Y       * test for a valid selection
.
          COMPARE   ZERO,PTCNDRGG           * test for a valid selection
          GOTO      KHS1315Y IF EQUAL
.
          BEEP                              * invalid selection
          GOTO      KHS1315A
.
.------ display the description ------
.
KHS1315Y  MOVE      DRGDESC1,DRGDESC         * default to 38 chars.
          LOAD      DRGDESC,PTCNDRGG,DRGDESC2
.
          DISPLAY   *P55:17,DRGDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
. Default booking ward/bed at admission
.
KHOS1316  MOVE      "50",CCOL                * column for keyin
          MOVE      TEN8,CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNDBWB            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
. ------  keyin default answer for admitting new born ----------
.
KHOS1317  MOVE      "50",CCOL                * column for keyin
          MOVE      TEN9,CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNUABL            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
.------ keyin description to display for Outstanding Debt ------
.
KHOS1318  MOVE      SP9,PTCNOUTD
          KEYIN     *P50:20,*V2LON,PTCNOUTD;
          ENDSET    PTCNOUTD
          APPEND    SP9,PTCNOUTD
          RESET     PTCNOUTD
          DISPLAY   *P50:20,*V2LON,PTCNOUTD;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
.------ Keyin Number of Lines on Inpatient Labels  ------
.
KHOS1319  
          KEYIN     *P50:21,*V2LON,*RV,PTCNNLIL;
          IF        PTCNNLIL<1
            BEEP
            MOVE      ONE,PTCNNLIL
            GOTO      KHOS1319
          ENDIF
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
. ------  default coding date to current date ------------------
.
KHOS1320  MOVE      "50",CCOL                * column for keyin
          MOVE      TWENTY2,CVERT             * row for keyin
.
          MOVE      PTCNDDCD,ANS
          CALL      KYND0000                 * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNDDCD            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
. ------  default discharge summary diagnosis ------------------
.
KHOS1321  MOVE      "50",CCOL                * column for keyin
          MOVE      TWENTY3,CVERT             * row for keyin
.
          MOVE      PTCNDDSD,ANS
          CALL      KYND0000                 * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNDDSD            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS13
.
.
. -----   Hospital Screen 14 -----
.
UPHOS14   CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHOS1401,KHOS1402,KHOS1403,KHOS1404,KHOS1405:
                           KHOS1406,KHOS1407,KHOS1408,KHOS1409,KHOS1410:
                           KHOS1411,KHOS1412,KHOS1413,KHOS1414,KHOS1415:
                           KHOS1416,KHOS1417,UPHOBEEP,KHOS1419,KHOS1420
          BEEP
UPHOBEEP  GOTO      UPHOS14
.
. ------  Using Donor details  -------
.
KHOS1401  MOVE      "50",CCOL                * column for keyin
          MOVE      FOUR,CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNDONR            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS14
.
. ------  Using Medical Warning details -------
.
KHOS1402  MOVE      "50",CCOL                * column for keyin
          MOVE      FIVE,CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNMEDW            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS14
.
. ------  Can danger details be updated ?-------
.
KHOS1403  MOVE      "50",CCOL                * column for keyin
          MOVE      SIX,CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNUDNG            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS14
.
. ------  National Search Criteria updated Automatically -------
.
KHOS1404  MOVE      "50",CCOL                * column for keyin
          MOVE      SEVEN,CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNNSCA            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS14
.
. ------  keyin Maximum number of patients returned in search -----
.
KHOS1405  MOVE      "50",CCOL                * column for keyin
          MOVE      EIGHT,CVERT               * row for keyin
.
          KEYIN     *PCCOL:CVERT,*V2LON,PTCNMPTR
          GOTO      UPHOS14
.
.
. ------  Load National Details when changing Donor Details -----
.
KHOS1406  MOVE      "50",CCOL                * column for keyin
          MOVE      NINE,CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNLNCD            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS14
.
.
. ------  Load National Details in PAT01  -------
.
KHOS1407  MOVE      "50",CCOL                * column for keyin
          MOVE      TEN,CVERT               * row for keyin
.
          CALL      KLAD0000        
          MOVE      EXIT,PTCNLP01            * set parameter
          GOTO      UPHOS14
.
.
. ------  Load National Details in HOS31  -------
.
KHOS1408  MOVE      "50",CCOL                * column for keyin
          MOVE      TEN1,CVERT               * row for keyin
.
          CALL      KLAD0000  
          MOVE      EXIT,PTCNLH31            * set parameter
          GOTO      UPHOS14
.
.
. ------  Load National Details in OUT66  -------
.
KHOS1409  MOVE      "50",CCOL                * column for keyin
          MOVE      TEN2,CVERT               * row for keyin
.
          CALL      KLAD0000 
          MOVE      EXIT,PTCNLO66            * set parameter
          GOTO      UPHOS14
.
.
. ------  Load National Details in AAE01   -------
.
KHOS1410  MOVE      "50",CCOL                * column for keyin
          MOVE      TEN3,CVERT               * row for keyin
.
          CALL      KLAD0000                 * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNLA01            * set parameter
          GOTO      UPHOS14
.
.
. ------  Load National Details in WAT01  -------
.
KHOS1411  MOVE      "50",CCOL                * column for keyin
          MOVE      TEN4,CVERT               * row for keyin
.
          CALL      KLAD0000                 * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNLW01            * set parameter
          GOTO      UPHOS14
.
.
. ------  Display National Visits in PAT32 -------
.
KHOS1412  MOVE      "50",CCOL                * column for keyin
          MOVE      TEN5,CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNVP32            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS14
.
.
. ------  Display National Visits in MRT21 -------
.
KHOS1413  MOVE      "50",CCOL                * column for keyin
          MOVE      TEN6,CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNVM21            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS14
.
.
. ------  Update National Details online -------
.
KHOS1414  MOVE      "50",CCOL                * column for keyin
          MOVE      TEN7,CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNUONL            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS14
.
. ------  Patients person to contact -------
.
KHOS1415  MOVE      "50",CCOL                * column for keyin
          MOVE      TEN8,CVERT               * row for keyin
          DISPLAY   *P1:24,*V2LON,ZERO,*HOFF," = Next of Kin, ":
                    *V2LON,ONE,*HOFF," = Emergency Contact, ":
                    *V2LON,TWO,*HOFF," = Nearest Relative"
.
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,PTCNPCON:
                    *DV,*PCCOL:CVERT,*V2LON,PTCNPCON
          IF        PTCNPCON < 3
            MOVE      CONTACT0,CONTACT
            LOAD      CONTACT,PTCNPCON,CONTACT1,CONTACT2
            DISPLAY   *P52:CVERT,"= ",CONTACT
            GOTO      UPHOS14
          ENDIF
          BEEP
          GOTO      KHOS1415
.
. ------  Default Procedure Code DescriptionType
.
KHOS1416  DISPLAY   *P1:24,*EL,*V2LON,"1",*HOFF,"= ",DES1PCDS,", ":
                               *V2LON,"2",*HOFF,"= ",DES2PCDS
          MOVE      "50",CCOL                * column for keyin
          MOVE      "19",CVERT               * row for keyin
.
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,PTCNPCDS
          BRANCH    PTCNPCDS,K1416AAA,K1416AAA
          BEEP
          GOTO      KHOS1416
.
K1416AAA  LOAD      DDESC16,PTCNPCDS,DES1PCDS,DES2PCDS
          DISPLAY   *PCCOL:CVERT,*EL,*V2LON,PTCNPCDS,*HOFF,SP1," = ",DDESC16
          GOTO      UPHOS14
.
. ------  Allow 'L' as disease type? -----
.
KHOS1417  MOVE      "50",CCOL                * column for keyin
          MOVE      "20",CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNLTYP            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS14
.
+
. ------  Keyin AUSR Field for Re-admission in 28 days
.
KHOS1419  MOVE      "50",CCOL                * column for keyin
          MOVE      "22",CVERT               * row for keyin
.
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,PTCNUREA
          IF        (PTCNUREA < 0) | (PTCNUREA > 9)
            BEEP
            GOTO      KHOS1419
          ENDIF
.
          PACK      KEY5,ANSU,PTCNUREA,SP3
          MOVE      "Invalid Code",DESCUREA
          CALL      RDCODE1
          MOVE      TDESC,DESCUREA
.
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNUREA,*HOFF,SP2,DESCUREA
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS14
.
. ------  Calc ALOS using discharges only in HOS82?-------
.
KHOS1420  MOVE      "50",CCOL                * column for keyin
          MOVE      TWENTY3,CVERT            * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNALOS            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS14
+
.
. -----   Hospital Screen 15 -----
.
UPHOS15   CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHOS1501,KHOS1502,KHOSBEEP,KHOS1504,KHOS1505:
                           KHOS1506,KHOS1507,KHOS1508,KHOS1509,KHOS1510:
                           KHOS1511,KHOS1514,KHOS1515:
                           KHOS1516,KHOS1517,KHOS1518,KHOS1519,KHOS1520:
                           KHOS1521,KHOS1522
KHOSBEEP  BEEP
          GOTO      UPHOS15
.
. ------  Keyin AUSR Field for Re-admission in 28 days
.
KHOS1501  MOVE      "50",CCOL                * column for keyin
          MOVE      "04",CVERT               * row for keyin
.
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,PTCNUDIN
          IF        (PTCNUDIN < 0) | (PTCNUDIN> 7)
            BEEP
            GOTO      KHOS1501
          ENDIF
.
          PACK      KEY5,ANSU,PTCNUDIN,SP3
          MOVE      "Invalid Code        ",TDESC       
          CALL      RDCODE1
          MOVE      TDESC,DESCUDIN
.
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNUDIN,*HOFF,SP2,DESCUDIN
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS15
+
. ------  Use Patient Weight in IBAPAT06?
.
KHOS1502  MOVE      "50",CCOL                * column for keyin
          MOVE      "05",CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNBWMR            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS15
+
.         Category to be used in NSW HDP Transmission
.    
KHOS1504  MOVE      "50",CCOL
          MOVE      "07",CVERT
.
          DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF," = ",DDESTCAT,",  ":
                               *V2LON,"1",*HOFF," = ",DSTATCAT
.
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,PTNSWHDP
          DISPLAY   *P1:24,*EL;
          MOVE      SP20,DDESC4
          IF        PTNSWHDP=0
            MOVE      DDESTCAT,DDESC4
            GOTO      KHS1504A
          ENDIF
          IF        PTNSWHDP=1
            MOVE      DSTATCAT,DDESC4
            GOTO      KHS1504A
          ENDIF
          BEEP
          GOTO      KHOS1504
.
KHS1504A  DISPLAY   *PCCOL:CVERT,*V2LON,PTNSWHDP,SP2,*HOFF,DDESC4
          GOTO      UPHOS15
+
.         NSW HDP Locality
.
KHOS1505  MOVE      "50",CCOL
          MOVE      "08",CVERT
.
          DISPLAY   *P1:24,*EL:
                    *V2LON,ONE,*HOFF," = ",DLOCAT1,",     ":
                    *V2LON,TWO,*HOFF," = ",DLOCAT2;
.
KHS1505A  KEYIN     *PCCOL:CVERT,*EL,*V2LON,CNSWLOC;
          BRANCH    CNSWLOC,KHS1505B,KHS1505B
          BEEP
          GOTO      KHS1505A
.
KHS1505B  LOAD      DLOCAT,CNSWLOC,DLOCAT1,DLOCAT2
          DISPLAY   *PCCOL:CVERT,*V2LON,CNSWLOC,SP2,*HOFF,DLOCAT;
          GOTO      UPHOS15
.
.         NSW HDP Language
.
KHOS1506  MOVE      "50",CCOL
          MOVE      "09",CVERT
.
          DISPLAY   *P1:24,*EL,"PMI User Defined: ":
                    *V2LON,ONE,*HOFF,",":
                    *V2LON,TWO,*HOFF,",":
                    *V2LON,THREE,*HOFF,", ":
                    *V2LON,FOUR,*HOFF," = ",*HOFF,"Adm User Def 1, ":
                    *V2LON,FIVE,*HOFF," = ",*HOFF,"Adm User Def 2, ":
                    "PMI 4-6: ":
                    *V2LON,SIX,*HOFF,",":
                    *V2LON,SEVEN,*HOFF,",":
                    *V2LON,EIGHT,*HOFF
.
KHS1506A  KEYIN     *PCCOL:CVERT,*EL,*V2LON,CNSWLNG;
          COMPARE   ZERO,CNSWLNG
          GOTO      KHS1506B IF EQUAL
.
          BRANCH    CNSWLNG OF KHS1506B,KHS1506B,KHS1506B,KHS1506B,KHS1506B:
                               KHS1506B,KHS1506B,KHS1506B
          BEEP
          GOTO      KHS1506A
.
KHS1506B  MOVE      PUSERD0,DLANGU
          LOAD      DLANGU,CNSWLNG,PUSERD1,PUSERD2,PUSERD3,AUSERD1,AUSERD2:
                                   PUSERD4,PUSERD5,PUSERD6
          DISPLAY   *PCCOL:CVERT,*EL,*V2LON,CNSWLNG,*HOFF,SP2,DLANGU;
          GOTO      UPHOS15
+
.
.-------  User defined field for EDI Admission source -----
.
KHOS1507
          DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = use ASRCE, ":
                    *V2LON,ONE,*HOFF," =AUSR1,":
                    *V2LON,TWO,*HOFF," =AUSR2,":
                    *V2LON,THREE,*HOFF," =AUSR3,":
                    *V2LON,FOUR,*HOFF," =AUSR4,":
                    *V2LON,FIVE,*HOFF," =AUSR5,":
                    *V2LON,SIX,*HOFF," =AUSR6,":
                    *V2LON,SEVEN,*HOFF," =AUSR7" 
          KEYIN     *P50:10,*V2LON,PTCNEIAS
.
          IF        PTCNEIAS = 0
            DISPLAY   *P53:10,ASOURCE
            GOTO      UPHOS15
          ENDIF
          BRANCH    PTCNEIAS,KHS1507A,KHS1507A,KHS1507A,KHS1507A,KHS1507A:
                             KHS1507A,KHS1507A
          BEEP
          GOTO      KHOS1507
KHS1507A  LOAD      EDIADM,PTCNEIAS,AUSERD1,AUSERD2,AUSERD3,AUSERD4,AUSERD5:
                                    AUSERD6,AUSERD7
          DISPLAY   *P53:10,EDIADM
          GOTO      UPHOS15 
.
.-------  User defined field for EDI Occupation       -----
.
KHOS1508
          DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = Not Used,":
                    *V2LON,ONE,*HOFF," = PUSR1,":
                    *V2LON,TWO,*HOFF," = PUSR2,":
                    *V2LON,THREE,*HOFF," = PUSR3,":
                    *V2LON,FOUR,*HOFF," = PUSR4,":
                    *V2LON,FIVE,*HOFF," = PUSR5,":
                    *V2LON,SIX,*HOFF," = PUSR6"
          KEYIN     *P50:11,*V2LON,PTCNEIOC
.
          IF        PTCNEIOC = 0
            DISPLAY   *P53:11,PUSERD0
            GOTO      UPHOS15
          ENDIF
          BRANCH    PTCNEIOC,KHS1508A,KHS1508A,KHS1508A,KHS1508A,KHS1508A:
                             KHS1508A
          BEEP
          GOTO      KHOS1508
KHS1508A  LOAD      EDIPMI,PTCNEIOC,PUSERD1,PUSERD2,PUSERD3,PUSERD4,PUSERD5:
                           PUSERD6
          DISPLAY   *P53:11,EDIPMI
          GOTO      UPHOS15
.
.-------  EDI Extract Mode -------                            
.
KHOS1509  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = Live ":
                               *V2LON,ONE,*HOFF," = Test"
.
          KEYIN     *P50:12,*V2LON,PTCNEIMO
.
          IF        PTCNEIMO = 0
            DISPLAY   *P53:12,EDILIVE
            GOTO      UPHOS15
          ENDIF
          BRANCH    PTCNEIMO,KHS1509A
          BEEP
          GOTO      KHOS1509
KHS1509A  DISPLAY   *P53:12,EDITEST
          GOTO      UPHOS15
.
.------- Medical Warnings Alert description -------
.
KHOS1510  KEYIN     *P50:13,*RV,*V2LON,PTCNMWAD:
                    *P50:13,*DV,*V2LON,PTCNMWAD
.
          PACK      PTCNMWAD,PTCNMWAD,SP10
          GOTO      UPHOS15
.

.------- Age at which patient is no longer a child
.
KHOS1511  KEYIN     *P50:14,*RV,*V2LON,PTCNAGEC
          DISPLAY   *P50:14,*V2LON,PTCNAGEC,*HOFF," years"
.
          GOTO      UPHOS15
.
. ------  using different date range for PRS2 ------
.
KHOS1514  MOVE      "50",CCOL                * column for keyin
          MOVE      "15",CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNDPRS            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS15
.
. ------  character for Life Threatening ALerts -----
.
KHOS1515  KEYIN     *P50:16,*V2LON,PTCNLFCH:
                    *P50:16,*DV,PTCNLFCH
.
          PACK      PTCNLFCH,PTCNLFCH,SP1
          MOVE      ZERO,OVRCD
          GOTO      UPHOS15
.
. ------ Board or Health fund description ------
.
KHOS1516  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = Board, ":
                               *V2LON,ONE,*HOFF," = Health Fund"
          KEYIN     *P50:17,*EL,*V2LON,PTCNBRHF:
                    *P50:17,*DV,PTCNBRHF
.
          MOVE      BRDDESC,DIM12
          LOAD      DIM12,PTCNBRHF,HFDESC
          DISPLAY   *P53:17,DIM12
          MOVE      ZERO,OVRCD
          GOTO      UPHOS15
.
. ------  Keyin Default link ur reason for hos 73  -----
.
KHOS1517  MOVE      "50",CCOL                * column for keyin
          MOVE      "18",CVERT               * row for keyin
.
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,PTCNDLKR
          PACK      PTCNDLKR,PTCNDLKR,SP3
.
          MOVE      SP20,DESCDLKR
          MATCH     SP3,PTCNDLKR
          IF        !@EQUAL
            PACK      KEY5,ANSL,ANSU,PTCNDLKR,SP3
            MOVE      SP20,TDESC
            CALL      RDCODE1
            IF        OVRCD = 1
              DISPLAY   *P1:24,*B,*EL,"Invalid Link Reason. ";
              CALL      HITENTER
              GOTO      KHOS1517
            ENDIF
            MOVE      TDESC,DESCDLKR
          ENDIF
.
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNDLKR,*HOFF,SP2,DESCDLKR
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS15
+
. ------  Using Coding Restraint (Y/N)?
.
KHOS1518  MOVE      "50",CCOL                * column for keyin
          MOVE      "19",CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNCDRS            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS15

.------- Printng Closed wards in PAT84
.
KHOS1519  MOVE      "50",CCOL                * column for keyin
          MOVE      "20",CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNPRCW            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS15
.
.------- ICD-10 coding effective date
KHOS1520  MOVE      "21",CVERT 
          MOVE      "50",CCOL
          MOVE      ZERO,CHIGHLT             * Highlight on
          MOVE      CCC,CCENT
          UNPACK    SP20,CYEAR,CMON,CDAY
          CALL      KEYDATE
          PACK      PTCNCDAT,CCENT,CYEAR,CMON,CDAY
          GOTO      UPHOS15
.
.------- Automatic Cancelation on Death
KHOS1521  MOVE      "22",CVERT
          MOVE      "50",CCOL
.
          CALL      KYN0000
          MOVE      EXIT,PTCNACAN
          MOVE      ZERO,OVRCD
          GOTO      UPHOS15 
.
.------- Baby NOK Default ------------------------------
.
KHOS1522  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = Mother's NOK, ":
                               *V2LON,ONE,*HOFF," = Mother"
          KEYIN     *P50:23,*EL,*V2LON,*DV,PTCNBNOK:
                    *P50:23,*EL,*V2LON,*RV,PTCNBNOK:
                    *P50:23,*DV,PTCNBNOK
.
          IF        PTCNBNOK < 0 | PTCNBNOK > 1
            BEEP
            GOTO      KHOS1522
          ENDIF
.
          MOVE      BNOKDES0,DIM12
          LOAD      DIM12,PTCNBNOK,BNOKDES1
          DISPLAY   *P53:23,DIM12
          MOVE      ZERO,OVRCD
          GOTO      UPHOS15
.
.         Hospital Screen 16
.
UPHOS16   CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHOS1601,KHOS1602,KHOS1603,KHOS1604,KHOS1605:
                           KHOS1606,KHOS1607,KHOS1608,KHOS1609,KHOS1610:
                           KHOS1611,KHOS1612,KHOS1613,KHOS1614,KHOS1615:
                           KHOS1616,KHOS1617,KHOS1618,KHOS1619,KHOS1620
.
          BEEP
          GOTO      UPHOS16
.
.         Alert Code 4 Display
.
KHOS1601  KEYIN     *P38:4,*V2LON,PTCNOCSC:
                    *P38:4,*DV,PTCNOCSC
          ENDSET    PTCNOCSC
          APPEND    SP10,PTCNOCSC
          RESET     PTCNOCSC
          GOTO      UPHOS16
.
.-------- Default Bank Details
.
KHOS1602  MOVE      "5",CVERT
          MOVE      "38",CCOL
          IF        CGLIND <> 1 & RCCNUPBR <> 1
            DISPLAY   *P1:24,*EL,*B,"G/L Interface Not On. Value Cannot be ":
                      "Changed. ";
            CALL      HITENTER
            GOTO      KHS1602A 
          ENDIF
.
          DISPLAY     *P54:CVERT,*EL
          MOVE        "0",HTOP
          CALL        KCHQFM00              * keyin cheque account
          BRANCH      EXIT,UPHOS16,UPHOS16
.
          MOVE        FMCHCHQ,PTCNCQPT 
          MOVE        FMCHDES,CHEQDESP
.
KHS1602A  DISPLAY   *P38:CVERT,*EL,*V2LON,PTCNCQPT,*HOFF:
                    *P54:CVERT,CHEQDESP;
          GOTO      UPHOS16
.
KHOS1603  MOVE      "6",CVERT
          MOVE      "38",CCOL
          IF        CGLIND <> 1 & RCCNUPBR <> 1
            DISPLAY   *P1:24,*EL,*B,"G/L Interface Not On. Value Cannot be ":
                      "Changed. ";
            CALL      HITENTER
            GOTO      KHS1603A 
          ENDIF
.
          DISPLAY     *P54:CVERT,*EL
          MOVE        "0",HTOP
          CALL      KCHQFM00                * keyin cheque account
          BRANCH    EXIT,UPHOS16,UPHOS16
.
          MOVE      FMCHCHQ,PTCNCQDT 
          MOVE      FMCHDES,CHEQDESD
.
KHS1603A  DISPLAY   *P38:CVERT,*EL,*V2LON,PTCNCQDT,*HOFF:
                    *P54:CVERT,CHEQDESD;
          GOTO      UPHOS16
.
.-------- Doctors Ledger/Account
.
KHOS1604  IF        CGLIND<>1
            DISPLAY   *P1:24,*EL,*B,"G/L Interface Not On. Value Cannot be ":
                      "Changed. ";
            CALL      HITENTER
            GOTO      UPHOS16
          ENDIF
.
          MOVE        "7",CVERT
          MOVE        "38",CCOL
          DISPLAY     *P54:CVERT,*EL
          MOVE        "0",HTOP
          CALL        KLMAFM00              * keyin ledger
          BRANCH      EXIT,UPHOS16,UPHOS16
          MOVE        FMLALEDG,PTCNLDDC
.
KHS1604A  KEYIN     *P41:CVERT,*EL,*V2LON,*DV,PTCNACDC,*P41:CVERT,*RV,PTCNACDC;
          PACK      PTCNACDC,PTCNACDC,SP30
.
          MATCH     QUEST,PTCNACDC
          IF        @EQUAL
            MOVE      PTCNLDDC,FMAMLEDG
            MOVE      "0",HTOP
            CALL      QFMAMA00              * question mark routine
            MATCH     SP20,FMAMACCT
            GOTO      KHS1604A IF EQUAL
            MOVE      FMAMACCT,PTCNACDC     * valid account
          ENDIF
.
          PACK      KEY14,PTCNLDDC,PTCNACDC,SP30
          CALL      RDFMAM1
          IF        OVRCD=TRUE
            DISPLAY   *P1:24,*EL,*B,"Invalid Account Code. ";
            CALL      HITENTER
            GOTO      KHOS1604
          ENDIF
.
          MOVE      FMAMDESC,DCLGDESC  
          MATCH     "1",FMAMTYPE
          GOTO      KHS1604B IF LESS
          MATCH     "6",FMAMTYPE
          GOTO      KHS1604C IF LESS
.
KHS1604B  DISPLAY   *P1:24,*EL,*B,"Invalid Account Type. ";
          CALL      HITENTER
          GOTO      KHS1604A
.
KHS1604C DISPLAY   *P38:7,*EL,*V2LON,PTCNLDDC,*P40:7,*HOFF,"/",*V2LON:
                    PTCNACDC,*HOFF,*P54:7,DCLGDESC
          GOTO      UPHOS16
.
. -------  Doctors Speciality Fee Ledger Account
.
KHOS1605  IF        CGLIND<>1
            DISPLAY   *P1:24,*EL,*B,"G/L Interface Not On. Value Cannot be ":
                      "Changed. ";
            CALL      HITENTER
            GOTO      UPHOS16
          ENDIF
          MOVE        "8",CVERT
          MOVE        "38",CCOL
.
          DISPLAY     *P54:CVERT,*EL
          MOVE        "0",HTOP
.
          CALL        KLMAFM00              * keyin ledger
          BRANCH      EXIT,UPHOS16,UPHOS16
          MOVE        FMLALEDG,PTCNLDDS
.
KHS1605A  KEYIN     *P41:CVERT,*EL,*V2LON,*DV,PTCNACDS,*P41:CVERT,*RV,PTCNACDS;
          PACK      PTCNACDS,PTCNACDS,SP30
.
          MATCH     QUEST,PTCNACDS
          IF        @EQUAL
            MOVE      PTCNLDDS,FMAMLEDG
            MOVE      "0",HTOP
            CALL      QFMAMA00              * question mark routine
            MATCH     SP20,FMAMACCT
            GOTO      KHS1605A IF EQUAL
            MOVE      FMAMACCT,PTCNACDS     * valid account
          ENDIF
.
          PACK      KEY14,PTCNLDDS,PTCNACDS,SP30
          CALL      RDFMAM1
          IF        OVRCD=TRUE
            DISPLAY   *P1:24,*EL,*B,"Invalid Account Code. ";
            CALL      HITENTER
            DISPLAY   *P1:24,*EL;
            GOTO      KHOS1605
          ENDIF
.
          MOVE      FMAMDESC,DSLGDESC  
          MATCH     "1",FMAMTYPE
          GOTO      KHS1605B IF LESS
          MATCH     "6",FMAMTYPE
          GOTO      KHS1605C IF LESS
.
KHS1605B  DISPLAY   *P1:24,*EL,*B,"Invalid Account Type. ";
          CALL      HITENTER
          GOTO      KHS1605A
.
KHS1605C DISPLAY   *P38:8,*EL,*V2LON,PTCNLDDS,*P40:8,*HOFF,"/",*V2LON:
                    PTCNACDS,*HOFF,*P54:8,DSLGDESC
          GOTO      UPHOS16
.
.-------- Administration Fees Ledger/Account
.
KHOS1606  IF        CGLIND<>1
            DISPLAY   *P1:24,*EL,*B,"G/L Interface Not On. Value Cannot be ":
                      "Changed. ";
            CALL      HITENTER
            GOTO      UPHOS16
          ENDIF
.
          MOVE        "9",CVERT
          MOVE        "38",CCOL
          DISPLAY     *P54:CVERT,*EL
          MOVE        "0",HTOP
          CALL        KLMAFM00
          BRANCH      EXIT,UPHOS16,UPHOS16
          MOVE        FMLALEDG,PTCNLDAF
.
KHS1606A  KEYIN     *P41:CVERT,*EL,*V2LON,*DV,PTCNACAF,*P41:CVERT,*RV,PTCNACAF;
          PACK      PTCNACAF,PTCNACAF,SP30
.
          MATCH     QUEST,PTCNACAF
          IF        @EQUAL
            MOVE      PTCNLDAF,FMAMLEDG 
            MOVE      "0",HTOP
            CALL      QFMAMA00  
            MATCH     SP20,FMAMACCT
            GOTO      KHS1606A IF EQUAL
            MOVE      FMAMACCT,PTCNACAF
          ENDIF  
.           
          PACK      KEY14,PTCNLDAF,PTCNACAF,SP30
          CALL      RDFMAM1
          IF        OVRCD=TRUE
            DISPLAY   *P1:24,*EL,*B,"Invalid Account Code. ";
            CALL      HITENTER
            GOTO      KHOS1606
          ENDIF
          MOVE      FMAMDESC,ADLGDESC
.
          MATCH     "1",FMAMTYPE
          GOTO      KHS1606B IF LESS
          MATCH     "6",FMAMTYPE
          GOTO      KHS1606C IF LESS
.
KHS1606B  DISPLAY   *P1:24,*EL,*B,"Invalid Account Type. ";
          CALL      HITENTER
          GOTO      KHS1606A
.
KHS1606C  DISPLAY   *P38:9,*EL,*V2LON,PTCNLDAF,*P40:9,*HOFF,"/",*V2LON:
                    PTCNACAF,*HOFF,*P54:9,ADLGDESC
          GOTO      UPHOS16
.
.-------- Refunds Ledger/Account
.
KHOS1607  IF        CGLIND<>1
            DISPLAY   *P1:24,*EL,*B,"G/L Interface Not On. Value Cannot be ":
                      "Changed. ";
            CALL      HITENTER
            GOTO      UPHOS16
          ENDIF
.
          MOVE        "10",CVERT
          MOVE        "38",CCOL
          DISPLAY     *P54:CVERT,*EL
          MOVE        "0",HTOP
          CALL        KLMAFM00
          BRANCH      EXIT,UPHOS16,UPHOS16
          MOVE        FMLALEDG,PTCNLDRF
          
.
KHS1607A  KEYIN     *P41:CVERT,*EL,*V2LON,*DV,PTCNACRF,*P41:CVERT,*RV,PTCNACRF;
          PACK      PTCNACRF,PTCNACRF,SP30
.
          MATCH     QUEST,PTCNACRF
          IF        @EQUAL
            MOVE      "0",HTOP
            MOVE      PTCNLDRF,FMAMLEDG
            CALL      QFMAMA00
            MATCH     SP20,FMAMACCT
            GOTO      KHS1607A IF EQUAL
            MOVE      FMAMACCT,PTCNACRF
          ENDIF
. 
          PACK      KEY14,PTCNLDRF,PTCNACRF,SP30
          CALL      RDFMAM1
          IF        OVRCD=TRUE
            DISPLAY   *P1:24,*EL,*B,"Invalid Account Code. ";
            CALL      HITENTER
            GOTO      KHOS1607 
          ENDIF
          MOVE      FMAMDESC,RFLDDESC
.
          MATCH     "1",FMAMTYPE
          GOTO      KHS1607B IF LESS
          MATCH     "6",FMAMTYPE
          GOTO      KHS1607C IF LESS
.
KHS1607B  DISPLAY   *P1:24,*EL,*B,"Invalid Account Type. ";
          CALL      HITENTER
          GOTO      KHS1607A
.
KHS1607C  DISPLAY   *P38:10,*EL,*V2LON,PTCNLDRF,*HOFF,"/",*V2LON:
                    PTCNACRF,*HOFF,*P54:10,RFLDDESC
          GOTO      UPHOS16
.
.-------- Journal For Refunds
.
KHOS1608  MOVE      "11",CVERT
.
          MOVE      CVERT,EVERT
          MOVE      "38",ECOL
          MOVE      CODEJ,CODE
          MOVE      PTCNJRTY,CKYIDEF3
          MOVE      "0",CKYIMAND
          MOVE      "1",CNEWDS
.
          DISPLAY   *P54:CVERT,*EL 
          CALL      PATCODKY
.
          BRANCH    EXIT,UPHOS16,UPHOS16
.
          MOVE      ACODE,PTCNJRTY
          MOVE      TDESC,JOURDESC
.
          DISPLAY   *P38:11,*EL,*V2LON,PTCNJRTY,*HOFF:
                    *P54:11,JOURDESC;
          GOTO      UPHOS16
.         
. ------- Dissection Code
.
KHOS1609  IF        CGLIND<>1
            DISPLAY   *P1:24,*EL,*B,"G/L Interface Not On. Value Cannot be ":
                      "Changed. ";
            CALL      HITENTER
            GOTO      UPHOS16
          ENDIF
          MOVE      "12",CVERT
          MOVE      "38",CCOL
          DISPLAY   *P54:CVERT,*EL
          MOVE      "0",HTOP
          CALL      KFMDSA00
          MOVE      FMDSCODE,CGLDISS
          PACK      KEY5,CGLDISS,SP5
          CALL      RDFMDS1
          MOVE      FMDSDESC,CODEDESC
          DISPLAY   *P38:12,*EL,*V2LON,CGLDISS,*HOFF,*P54:12,CODEDESC 
          GOTO      UPHOS16    
.
. ------- Responsibility Code
.
KHOS1610  IF        CGLIND<>1
            DISPLAY   *P1:24,*EL,*B,"G/L Interface Not On. Value Cannot be ":
                      "Changed. ";
            CALL      HITENTER
            GOTO      UPHOS16
          ENDIF
          MOVE      "13",CVERT
          MOVE      "38",CCOL
          DISPLAY   *P54:CVERT,*EL
          MOVE      "0",HTOP
          CALL      KFMRSA00
          BRANCH    EXIT,UPHOS16,UPHOS16
          MOVE      FMRSCODE,CGLRESP
.
          PACK      KEY4,CGLRESP,SP4
          CALL      RDFMRS1
          MOVE      FMRSDESC,RESPDESC
          DISPLAY   *P38:13,*EL,*V2LON,CGLRESP,*HOFF,*P54:13,RESPDESC
          GOTO      UPHOS16
.
.
.-------- Default outcome (DSTAT) 
.
KHOS1611  MOVE      "14",CVERT
.
          MOVE      CVERT,EVERT
          MOVE      "38",ECOL
          MOVE      CODED,CODE
          MOVE      PTCNCFDS,CKYIDEF3
          MOVE      "0",CKYIMAND
          MOVE      "1",CNEWDS 
.
          DISPLAY   *P54:CVERT,*EL
          CALL      PATCODKY
.
          MATCH     SP3,ACODE
          GOTO      KHS16111 IF EQUAL
.
          BRANCH    EXIT,KHS16111,UPHOS16
.
KHS16111  MOVE      ACODE,PTCNCFDS
          MOVE      TDESC,DDODEF
.
KHS1611A  DISPLAY   *P38:14,*EL,*V2LON,PTCNCFDS,*HOFF:
                    *P54:14,DDODEF;
          GOTO      UPHOS16
.
. ------- Temporary invoice at discharge
.
KHOS1612  MOVE      "15",CVERT
          DISPLAY   *P54:CVERT,*EL
          ASSIGN    PTCNTMIN+1,FORM1
          LOAD      DDTMIN,FORM1,DTMIN1,DTMIN2
          KEYIN     *P38:CVERT,*EL,*V2LON,*DV,PTCNTMIN,*P54:CVERT:
                    *HOFF,*DV,DDTMIN:
                    *P1:24,*EL,*V2LON,"0 ",*HOFF,"= ",*DV,DTMIN1,*V2LON," 1 ": 
                    *HOFF,"= ",*DV,DTMIN2,*P38:CVERT,*RV,*V2LON,PTCNTMIN;
.
          IF        PTCNTMIN<0 | PTCNTMIN>1
            DISPLAY   *P1:24,*EL,*B,"Option Must be 0 or 1. ";
            CALL      HITENTER
            ASSIGN    FORM1-1,PTCNTMIN
            GOTO      KHOS1612
          ENDIF
.
          ASSIGN      PTCNTMIN+1,FORM1
          LOAD        DDTMIN,FORM1,DTMIN1,DTMIN2
          DISPLAY     *P38:CVERT,*V2LON,PTCNTMIN,*P54:CVERT,*HOFF,DDTMIN;
.
          GOTO      UPHOS16
.
. ------- Admin. Fee percentage
.
KHOS1613  MOVE      "16",CVERT
          KEYIN     *P38:CVERT,*V2LON,PTCNADFP:
                    *P38:CVERT,*DV,PTCNADFP
          IF        PTCNADFP > 100 | PTCNADFP < 0
            BEEP
            GOTO    KHOS1613
          ENDIF
          GOTO      UPHOS16
.
. ------- Admin Fee Maximum
.
KHOS1614  MOVE      "17",CVERT
          KEYIN     *P38:CVERT,*V2LON,PTCNADXF:
                    *P38:CVERT,*DV,PTCNADXF
          IF        PTCNADXF < 0
            DISPLAY   *P1:24,*B,*EL,"Maximum Fee Must Not Be Less Than Zero. ";
            CALL      HITENTER
            GOTO      KHOS1614
          ENDIF 
          GOTO      UPHOS16
.
. ------- Admin Fee Minimum
.
KHOS1615  MOVE      "18",CVERT
          KEYIN     *P38:CVERT,*V2LON,PTCNADMF:
                    *P38:CVERT,*DV,PTCNADMF
          IF        PTCNADMF < 0
            DISPLAY   *P1:24,*B,*EL,"Minimum Fee Must Not Be Less Than Zero. ";
            CALL      HITENTER
            GOTO      KHOS1615
          ENDIF
          GOTO      UPHOS16
.
. ------- Journal Type for Cancel Cheques
.
KHOS1616  MOVE      "19",CVERT
.
          MOVE      CVERT,EVERT
          MOVE      "38",ECOL
          MOVE      CODEJ,CODE
          MOVE      PTCNJRCC,CKYIDEF3
          MOVE      "0",CKYIMAND
          MOVE      "1",CNEWDS
.
          DISPLAY   *P54:CVERT,*EL 
          CALL      PATCODKY
.
          BRANCH    EXIT,UPHOS16,UPHOS16
.
          MOVE      ACODE,PTCNJRCC
          MOVE      TDESC,JOURDES1
.
          DISPLAY   *P38:19,*EL,*V2LON,PTCNJRCC,*HOFF:
                    *P54:19,JOURDES1;
          GOTO      UPHOS16
.
KHOS1617  KEYIN     *P38:20,*EL,*V2LON,PTCNDAY
          IF        PTCNDAY < 0
            DISPLAY   *P1:24,*EL,*B,"Day Cannot be Negative. ";
            CALL      HITENTER
            GOTO      KHOS1617
          ENDIF
          DISPLAY   *P38:20,*V2LON,PTCNDAY,*HOFF,*P54:20,"Days";
          GOTO      UPHOS16
.
KHOS1618  KEYIN     *P38:21,*EL,*V2LON,PTCNWEEK 
          MOVE      PTCNWEEK,TEMPWEEK
          MULT      "7",TEMPWEEK
          IF        TEMPWEEK<=PTCNDAY
            DISPLAY   *P1:24,*EL,*B,"Number of weeks must be greater ":
                                    "than number of days. ";
            CALL      HITENTER
            GOTO      KHOS1618
          ENDIF
          DISPLAY   *P38:21,*V2LON,PTCNWEEK,*HOFF,*P54:21,"Weeks";
          GOTO      UPHOS16
.
KHOS1619  KEYIN     *P38:22,*EL,*V2LON,PTCNMONT
          MOVE      PTCNMONT,TEMPMONT
          MULT      "30",TEMPMONT           * number of days
          DIV       "7",TEMPMONT            * number of weeks
          IF        TEMPMONT <= PTCNWEEK 
            DISPLAY   *P1:24,*EL,*B,"Number of months must be greater ":
                                    "than number of weeks. ";
            CALL      HITENTER
            GOTO      KHOS1619
          ENDIF
          DISPLAY   *P38:22,*V2LON,PTCNMONT,*HOFF,*P54:22,"Months";
          GOTO      UPHOS16
.
.------- using DOR in previous address?
.
KHOS1620  MOVE      "38",CCOL                * column for keyin
          MOVE      "23",CVERT               * row for keyin
.
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNDORP            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS16
+
.
. -----   Hospital Screen 17 -----
.
UPHOS17   CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHOS1701,KHOS1702,KHOS1703,KHOS1705:
                           KHOS1706,KHOS1707,KHOS1708,KHOS1709:
                           KHOS17A0,KHOS17B0,KHOS17C0,KHOS17D0:
                           KHOS17E0,KHOS17F0,UPHOS17A,KHOS17H0:
                           KHOS17I0,KHOS17J0,KHOS17K0,KHOS17L0
UPHOS17A  BEEP
          GOTO      UPHOS17
.
.         Method of admission and changing of admission details
.
KHOS1701  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF,"=",DADMOPT0:
                    SP2,*V2LON,ONE,*HOFF,"=",DADMOPT1:
                    SP2,*V2LON,TWO,*HOFF,"=",DADMOPT2;
.
          KEYIN     *P52:4,*EL,*V2LON,PTCNAURN
          IF        (PTCNAURN<0) | (PTCNAURN>2)
            BEEP
            GOTO      KHOS1701
          ENDIF
.
          MOVE      DADMOPT0,DADMOPT
          LOAD      DADMOPT,PTCNAURN,DADMOPT1,DADMOPT2
.
          DISPLAY   *P52:4,*V2LON,PTCNAURN,*HOFF,*P55:4,DADMOPT
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS17
.
.         Method of admission and changing of admission details
.
KHOS1702  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF,"=",DIBED0:
                    SP2,*V2LON,ONE,*HOFF,"=",DIBED1:
                    SP2,*V2LON,TWO,*HOFF,"=",DIBED2;
.
          KEYIN     *P52:5,*EL,*V2LON,PTCNIBED
          IF        (PTCNIBED<0) | (PTCNIBED>2)
            BEEP
            GOTO      KHOS1702
          ENDIF
.
          MOVE      DIBED0,DIBED
          LOAD      DIBED,PTCNIBED,DIBED1,DIBED2
.
          DISPLAY   *P52:5,*V2LON,PTCNIBED,*HOFF,*P55:5,DIBED
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS17
.
.         Print Estimated Fund Rebate
.
KHOS1703  DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF," = ",PEFR0,", ":
                               *V2LON,"1",*HOFF," = ",PEFR1,", ":
                               *V2LON,"2",*HOFF," = ",PEFR2
.
          KEYIN     *P52:6,*EL,*V2LON,*RV,PTCNPEFR
.
          IF        PTCNPEFR<0 | PTCNPEFR>2
            BEEP
            GOTO      KHOS1703
          ENDIF
.
          CLEAR     PEFR
          MOVE      PEFR0,PEFR
          LOAD      PEFR,PTCNPEFR,PEFR1,PEFR2
.
          DISPLAY   *P52:6,*V2LON,PTCNPEFR,*HOFF,*P55:6,PEFR;
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS17
.
KHOS1705  MOVE      ANSN,ANS
          LOAD      ANS,PTCNINRA,ANSY
          KEYIN     *P52:7,*EL,*V2LON,*RV,ANS;
          REP       UPPLOW,ANS
          MATCH     "Y",ANS
          GOTO      KHOS175Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS175N IF EQUAL
          BEEP
          GOTO      KHOS1705
.
KHOS175Y  MOVE      ONE,PTCNINRA
          GOTO      KHOS175S
.
KHOS175N  MOVE      ZERO,PTCNINRA
.
KHOS175S  MOVE      DNO,DANS
          LOAD      DANS,PTCNINRA,DYES
          DISPLAY   *P52:7,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS17
.
KHOS1706  MOVE      ANSN,ANS
          LOAD      ANS,PTCNINVQ,ANSY
          KEYIN     *P52:8,*EL,*V2LON,*RV,ANS;
          REP       UPPLOW,ANS
          MATCH     "Y",ANS
          GOTO      KHOS176Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS176N IF EQUAL
          BEEP
          GOTO      KHOS1706
.
KHOS176Y  MOVE      ONE,PTCNINVQ
          GOTO      KHOS176S
.
KHOS176N  MOVE      ZERO,PTCNINVQ
.
KHOS176S  MOVE      DNO,DANS
          LOAD      DANS,PTCNINVQ,DYES
          DISPLAY   *P52:8,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS17
.
KHOS1707  MOVE      ANSN,ANS
          LOAD      ANS,PTCNDGAT,ANSY
          KEYIN     *P52:9,*EL,*V2LON,*RV,ANS;
          REP       UPPLOW,ANS
          MATCH     "Y",ANS
          GOTO      KHOS177Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS177N IF EQUAL
          BEEP
          GOTO      KHOS1707
.
KHOS177Y  MOVE      ONE,PTCNDGAT
          GOTO      KHOS177S
.
KHOS177N  MOVE      ZERO,PTCNDGAT
.
KHOS177S  MOVE      DNO,DANS
          LOAD      DANS,PTCNDGAT,DYES
          DISPLAY   *P52:9,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS17
.
KHOS1708  MOVE      ANSN,ANS
          LOAD      ANS,PTCNMRBT,ANSY
          KEYIN     *P52:10,*EL,*V2LON,*RV,ANS;
          REP       UPPLOW,ANS
          MATCH     "Y",ANS
          GOTO      KHOS178Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS178N IF EQUAL
          BEEP
          GOTO      KHOS1708
.
KHOS178Y  MOVE      ONE,PTCNMRBT
          GOTO      KHOS178S
.
KHOS178N  MOVE      ZERO,PTCNMRBT
.
KHOS178S  MOVE      DNO,DANS
          LOAD      DANS,PTCNMRBT,DYES
          DISPLAY   *P52:10,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS17
.
KHOS1709  MOVE      ANSN,ANS
          LOAD      ANS,PTCNMRBC,ANSY
          KEYIN     *P52:11,*EL,*V2LON,*RV,ANS;
          REP       UPPLOW,ANS
          MATCH     "Y",ANS
          GOTO      KHOS179Y IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS179N IF EQUAL
          BEEP
          GOTO      KHOS1709
.
KHOS179Y  MOVE      ONE,PTCNMRBC
          GOTO      KHOS179S
.
KHOS179N  MOVE      ZERO,PTCNMRBC
.
KHOS179S  MOVE      DNO,DANS
          LOAD      DANS,PTCNMRBC,DYES
          DISPLAY   *P52:11,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS17
.
KHOS17A0  MOVE      ANSY,ANS
          LOAD      ANS,PTCNCHSD,ANSN
          KEYIN     *P61:12,*EL,*V2LON,*RV,ANS;
          REP       UPPLOW,ANS
          MATCH     "Y",ANS
          GOTO      KHOS17AY IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS17AN IF EQUAL
          BEEP
          GOTO      KHOS17A0
.
KHOS17AY  MOVE      ZERO,PTCNCHSD
          GOTO      KHOS17AS
.
KHOS17AN  MOVE      ONE,PTCNCHSD
.
KHOS17AS  MOVE      DYES,DANS
          LOAD      DANS,PTCNCHSD,DNO
          DISPLAY   *P61:12,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS17
.
KHOS17B0  MOVE      ANSY,ANS
          LOAD      ANS,PTCNCHAL,ANSN
          KEYIN     *P61:13,*EL,*V2LON,*RV,ANS;
          REP       UPPLOW,ANS
          MATCH     "Y",ANS
          GOTO      KHOS17BY IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS17BN IF EQUAL
          BEEP
          GOTO      KHOS17B0
.
KHOS17BY  MOVE      ZERO,PTCNCHAL
          GOTO      KHOS17BS
.
KHOS17BN  MOVE      ONE,PTCNCHAL
.
KHOS17BS  MOVE      DYES,DANS
          LOAD      DANS,PTCNCHAL,DNO
          DISPLAY   *P61:13,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS17
.
KHOS17C0  MOVE      ANSN,ANS
          LOAD      ANS,PTCNOPHO,ANSY
          KEYIN     *P61:14,*EL,*V2LON,*RV,ANS;
          REP       UPPLOW,ANS
          MATCH     "Y",ANS
          GOTO      KHOS17CY IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS17CN IF EQUAL
          BEEP
          GOTO      KHOS17C0
.
KHOS17CY  MOVE      ONE,PTCNOPHO
          GOTO      KHOS17CS
.
KHOS17CN  MOVE      ZERO,PTCNOPHO
.
KHOS17CS  MOVE      DNO,DANS
          LOAD      DANS,PTCNOPHO,DYES
          DISPLAY   *P61:14,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS17
.
.
. keyin med rec default movement reason on bed transfer
.
KHOS17D0  KEYIN     *P61:15,*EL,*V2LON,PTCNDBTR;
.
          PACK      PTCNDBTR,PTCNDBTR,SP3,SP3
          MATCH     SP3,PTCNDBTR
          GOTO      UPHOS17 IF EQUAL
.
          OPEN      MRTMOVA1,"mrtmovaf"
          MOVE      PTCNDBTR,KEY4
          CALL      RDMRMOV1
          CLOSE     MRTMOVA1
          IF        OVRCD=1
            DISPLAY   *P1:24,*EL,*B,"Invalid Code.  ";
            CALL      HITENTER
            GOTO      KHOS17D0
          ENDIF
.
          GOTO      UPHOS17
.
. Preserve microfilm address in U/R merge - both fields 
.
KHOS17E0  MOVE      ANSN,ANS
          LOAD      ANS,PTCNMIC1,ANSY
          KEYIN     *P61:16,*EL,*V2LON,*RV,ANS;
          REP       UPPLOW,ANS
          MATCH     "Y",ANS
          GOTO      KHOS17EY IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS17EN IF EQUAL
          BEEP
          GOTO      KHOS17E0
.
KHOS17EY  MOVE      ONE,PTCNMIC1
          GOTO      KHOS17ES
.
KHOS17EN  MOVE      ZERO,PTCNMIC1
.
KHOS17ES  MOVE      DNO,DANS
          LOAD      DANS,PTCNMIC1,DYES
          DISPLAY   *P61:16,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS17
.
. Preserve microfilm address in U/R merge - both fields 
.
KHOS17F0  MOVE      "17",CVERT
          MOVE      "61",CCOL
          MOVE      "Preserve Microfilm Address",BOXHDR
          CALL      LDMICA00                * Load Microfilm address
          PROC      GENCODKY
          BRANCH    EXIT,UPHOS17
          MOVE      TEMPCODE,PTCNMIC2
          GOTO      UPHOS17
.
KHOS17H0  MOVE      ANSY,ANS
          LOAD      ANS,PTCNPREV,ANSN
          KEYIN     *P61:19,*EL,*V2LON,*RV,ANS;
          REP       UPPLOW,ANS
          MATCH     "Y",ANS
          GOTO      KHOS17HY IF EQUAL
.
          MATCH     "N",ANS
          GOTO      KHOS17HN IF EQUAL
          BEEP
          GOTO      KHOS17H0
.
KHOS17HY  MOVE      ZERO,PTCNPREV
          GOTO      KHOS17HS
.
KHOS17HN  MOVE      ONE,PTCNPREV
.
KHOS17HS  MOVE      DYES,DANS
          LOAD      DANS,PTCNPREV,DNO
          DISPLAY   *P61:19,*EL,*V2LON,DANS;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS17
.
. ----- Banding & type of episode for QLD H.D.T. ----- 
.
KHOS17I0  MOVE      "20",CVERT
          MOVE      "64",CCOL
          MOVE      "Band. & Epis. for QLD HDT ",BOXHDR
          CALL      LDQLDB00                * Load QLD bandings
          PROC      GENCODKY
          MOVE      TEMPCODE,FORM1
          LOAD      DIM15,FORM1,DISUSR1,DISUSR2,DISUSR3,DISUSR4,DISUSR5,ADMTYPE:
                                CARECLSS
          DISPLAY   *P61:20,*EL,*V2LON,DIM15,*HOFF;   * car 36455
          BRANCH    EXIT,UPHOS17
          MOVE      TEMPCODE,PTCNQLDB
          GOTO      UPHOS17
.
. -----  User defined field for Gestation Period ------
.
KHOS17J0  DISPLAY   *P1:24,*EL:
                    *V2LON,ZERO,*HOFF," =U0, ":
                    *V2LON,ONE,*HOFF," =U1, ":
                    *V2LON,TWO,*HOFF," =U2, ":
                    *V2LON,THREE,*HOFF," =U3, ":
                    *V2LON,FOUR,*HOFF," =U4, ":
                    *V2LON,FIVE,*HOFF," =U5, ":
                    *V2LON,SIX,*HOFF," =U6, ":
                    *V2LON,SEVEN,*HOFF," =U7 ":
                    *V2LON,EIGHT,*HOFF," =U8 ":
                    *V2LON,NINE,*HOFF," =U9" 
          KEYIN     *P50:21,*EL,*V2LON,PTCNGEST
.
          BRANCH    PTCNGEST,KHS17J0A,KHS17J0A,KHS17J0A,KHS17J0A,KHS17J0A:
                             KHS17J0A,KHS17J0A,KHS17J0A,KHS17J0A
          IF        PTCNGEST = 0
            MOVE      AUSERD0,GESTPER
            GOTO      KHS17J0B
          ENDIF
          BEEP
          GOTO      KHOS17J0
KHS17J0A  LOAD      GESTPER,PTCNGEST,AUSERD1,AUSERD2,AUSERD3,AUSERD4,AUSERD5:
                                    AUSERD6,AUSERD7,AUSERD8,AUSERD9,AUSERD0
KHS17J0B  DISPLAY   *P51:21," = ",GESTPER
          GOTO      UPHOS17 
.
. ----- Discharge Intention field for Casemix Data Extract -----
.
KHOS17K0  MOVE      "1",HLEF
          MOVE      "80",HRIG
          MOVE      "23",HTOP
          MOVE      "24",HBOT
          CALL      GETSCR00
          DISPLAY   *P1:23,*EF,*V2LON,"0",*HOFF," = Admission Class, ":
                    *V2LON,"1-5",*HOFF," = Admission User Defined Fields 1-5":
                    *P1:24,*V2LON,"6",*HOFF," = pmsvx1af, Intended LOS";
          KEYIN     *P50:22,*EL,*V2LON,PTCNDSCI;
          IF        PTCNDSCI<0 | PTCNDSCI>6
            BEEP
            GOTO      KHOS17K0
          ENDIF
          MOVE      "Invalid Code",DDSCI
          MOVE      "P ",TCODE
          IF        PTCNDSCI>0 & PTCNDSCI<6
            PACK      TCODE,ANSU,PTCNDSCI
          ENDIF
          IF        PTCNDSCI=6
            PACK      TCODE,ANSV,ANSI
          ENDIF
          PACK      KEY5,TCODE,SP3
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      TDESC,DDSCI
          ENDIF
          CALL      PUTSCR00
          DISPLAY   *P50:22,*EL,*V2LON,PTCNDSCI,*HOFF,SP3,DDSCI,*P1:24,*EL;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS17
.
. ----- Establishment Number for Tasmanian Health Department -----
.
KHOS17L0  KEYIN     *P50:23,*EL,*V2LON,PTCNESTB;
.
          ENDSET    PTCNESTB
          APPEND    SP6,PTCNESTB
          RESET     PTCNESTB
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS17
+
.
. ----- Hospital Screen 18 -----
.
UPHOS18   CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHS18010,KHS18020,KHS18030,KHS18040,KHS18050:
                           KHS18060,KHS18070,KHS18080,KHS18090,KHS18100:
                           KHS18110,KHS18120,KHS18130,KHS18140,KHS18150:
                           KHS18160,KHS18170,KHS18171,KHS18172,KHS18173
.
          BEEP
          GOTO      UPHOS18
.
. ----- Change Encoder disease code prefixes (Y/N) -----
.
KHS18010  MOVE      "4",CVERT
          MOVE      "52",CCOL
          MOVE      PTCNAAPE,ANS
          CALL      KYND0000                * Standard yes/no keyin
          MOVE      EXIT,PTCNAAPE
          GOTO      UPHOS18
.
. ----- Which AUSR field for admission transfer type -----
.
KHS18020  DISPLAY   *P1:24,*EL,*V2LON,"0-9",*HOFF," = Admission User Defined ":
                    "Fields 0-9";
KHS18021  KEYIN     *P52:5,*EL,*V2LON,PTCNADTT;
.
          IF        PTCNADTT<0 | PTCNADTT>9
            BEEP
            GOTO      KHS18021
          ENDIF
          MOVE      SP20,TDESC
          PACK      TCODE,ANSU,PTCNADTT
          PACK      KEY5,TCODE,SP5
          CALL      RDCODE1
          MOVE      TDESC,ADTTDESC
          DISPLAY   *P52:5,*EL,*V2LON,PTCNADTT,*HOFF,SP1,ADTTDESC;
          GOTO      UPHOS18
.
. ----- Which DUSR field for discharge transfer type -----
.
KHS18030  DISPLAY   *P1:24,*EL,*V2LON,"1-5",*HOFF," = Discharge User Defined ":
                    "Fields 1-5";
KHS18031  KEYIN     *P52:6,*EL,*V2LON,PTCNDSTT;
.
          IF        PTCNDSTT<1 | PTCNDSTT>5
            BEEP
            GOTO      KHS18031
          ENDIF
          MOVE      SP20,TDESC
          PACK      TCODE,ANSD,PTCNDSTT
          PACK      KEY5,TCODE,SP5
          CALL      RDCODE1
          MOVE      TDESC,DSTTDESC
          DISPLAY   *P52:6,*EL,*V2LON,PTCNDSTT,*HOFF,SP1,DSTTDESC;
          GOTO      UPHOS18
.
KHS18040
          GOTO      UPHOS18
.
. ----- Pre-Admission Scan Format ---------------------
.
KHS18050  DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF," - Normal Format, ":
                    *V2LON,"1",*HOFF," - Include Medical Alerts and Cat CL";
KHS18051  KEYIN     *P52:8,*EL,*V2LON,PTCNP68L;
.
          IF        PTCNP68L<0 | PTCNP68L>1
            BEEP
            GOTO      KHS18051
          ENDIF
.
          MOVE      SCANDES0,SCANDESC
          LOAD      SCANDESC,PTCNP68L,SCANDES1 
          DISPLAY   *P52:8,*EL,*V2LON,PTCNP68L,*HOFF,SP1,SCANDESC;
          GOTO      UPHOS18
.
. ----- Number of Days in a Month -------------------
.
KHS18060  KEYIN     *P52:9,*EL,*V2LON,PTCNDAYM
.
          IF        PTCNDAYM<0
            BEEP
            GOTO      KHS18060
          ENDIF
.
          DISPLAY   *P52:9,*EL,*V2LON,PTCNDAYM
          GOTO      UPHOS18
.
. ----- Validation of Admission Details Being Used ------
.
KHS18070  DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF," = None, ":
                               *V2LON,"1",*HOFF," = NHS (UK)"
.
KHS18071  KEYIN     *P52:10,*EL,*V2LON,PTCNVADM
.
          IF        PTCNVADM<0 | PTCNVADM > 1
            BEEP
            GOTO      KHS18071
          ENDIF
.
          MOVE      VADM0,VADMDESC
          LOAD      VADMDESC,PTCNVADM,VADM1
          DISPLAY   *P52:10,*EL,*V2LON,PTCNVADM,*HOFF,SP1,VADMDESC
          GOTO      UPHOS18
.
. ------- Emergency Contact details default to -------
.
KHS18080  DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF," = Next of Kin, ":
                               *V2LON,"1",*HOFF," = Patient"
.
KHS18081  KEYIN     *P52:11,*EL,*V2LON,PTCNECDF
          IF        PTCNECDF<0 | PTCNECDF > 1
            BEEP
            GOTO      KHS18081
          ENDIF
.
          MOVE      ECDF0,ECDFDESC
          LOAD      ECDFDESC,PTCNECDF,ECDF1
          DISPLAY   *P52:11,*EL,*V2LON,PTCNECDF,*HOFF,SP1,ECDFDESC
          GOTO      UPHOS18
.
. ------- First Regular Day/Night Attender field -------
.
KHS18090  DISPLAY   *P1:24,*EL,"0=PTMIUSR0, 1-7=AUSR1-7, 8-9=PTMIUSR8-9"
          KEYIN     *P52:12,*V2LON,PTCNFRDA:
                    *P52:12,*DV,PTCNFRDA
          IF        PTCNFRDA < 0 | PTCNFRDA > 9
            BEEP
            GOTO      KHS18090
          ENDIF
          DISPLAY   *P1:24,*EL;
          GOTO      UPHOS18
.
. ------- Neonatal Level of Care field -------
.
KHS18100  DISPLAY   *P1:24,*EL,"0=PTMIUSR0, 1-5=DUSR1-5, 6-7=AUSR6-7, ":
                    "8-9=PTMIUSR8-9"
          KEYIN     *P52:13,*V2LON,PTCNNLOC:
                    *P52:13,*DV,PTCNNLOC
          IF        PTCNNLOC < 0 | PTCNNLOC > 9
            BEEP
            GOTO      KHS18100
          ENDIF
          DISPLAY   *P1:24,*EL;
          GOTO      UPHOS18
.
. ------- Automatic check of District of Residence -------
.
KHS18110  MOVE      "14",CVERT
          MOVE      "52",CCOL
          MOVE      PTCNACDR,ANS
          CALL      KYND0000                * Standard yes/no keyin
          MOVE      EXIT,PTCNACDR
          GOTO      UPHOS18
.
. ------- Automatic check of Post Code to Home Address -------
.
KHS18120  MOVE      "15",CVERT
          MOVE      "52",CCOL
          MOVE      PTCNACPH,ANS
          CALL      KYND0000                * Standard yes/no keyin
          MOVE      EXIT,PTCNACPH
          GOTO      UPHOS18
.
. ------- Default Doctor's Cat A for Patient Cat A Field -----
.
KHS18130  MOVE      "16",CVERT
          MOVE      "52",CCOL
          MOVE      PTCNDSPC,ANS
          CALL      KYND0000                * Standard yes/no keyin
          MOVE      EXIT,PTCNDSPC
          GOTO      UPHOS18
.
. ----- Which AUSR field for private/public category -----
.
KHS18140  DISPLAY   *P1:24,*EL,*V2LON,"0-9",*HOFF," = Admission User Defined ":
                    "Fields 0-9";
KHS18141  KEYIN     *P52:17,*EL,*V2LON,PTCNPPPT;
.
          IF        PTCNPPPT<0 | PTCNPPPT>9
            BEEP
            GOTO      KHS18141
          ENDIF
          MOVE      "Invalid Code",PPPTDESC
          PACK      KEY5,ANSU,PTCNPPPT
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      TDESC,PPPTDESC
          ENDIF
          DISPLAY   *P52:17,*EL,*V2LON,PTCNPPPT,*HOFF,SP1,PPPTDESC;
          GOTO      UPHOS18
.
. ------- Print no stats wards for IBAHOS82 -------
.
KHS18150  MOVE      "18",CVERT
          MOVE      "52",CCOL
          MOVE      PTCNH82W,ANS
          CALL      KYND0000                * Standard yes/no keyin
          MOVE      EXIT,PTCNH82W
          GOTO      UPHOS18
.
. ----- Auto alloc of princ prefix for Encoder (Y/N) -----
.
KHS18160  MOVE      "19",CVERT
          MOVE      "52",CCOL
          MOVE      PTCNEAPD,ANS
          CALL      KYND0000                * Standard yes/no keyin
          MOVE      EXIT,PTCNEAPD
          GOTO      UPHOS18
.
. ----- Link Event to Episode Mandatory -----
.
KHS18170  MOVE      "20",CVERT
          MOVE      "52",CCOL
          MOVE      PTCNLMAN,ANS
          CALL      KYND0000                * Standard yes/no keyin
          MOVE      EXIT,PTCNLMAN
          GOTO      UPHOS18
.
KHS18171  MOVE      "52",CCOL
          MOVE      "21",CVERT
          MOVE      ZERO,CHIGHLT             * Highlight on
          MOVE      "19",CCENT
          UNPACK    SP20,CYEAR,CMON,CDAY
          CALL      KEYDATE
          PACK      PTCNLEDT,CCENT,CYEAR,CMON,CDAY
          GOTO      UPHOS18
.
KHS18172  MOVE      "52",ECOL
          MOVE      "22",EVERT
.
          MOVE      PTCNPACC,CKYIDEF6
          MOVE      ONE,CNEWDS
          MOVE      ZERO,CKYIMODE
          MOVE      ZERO,CKYIMAND
.
          MOVE      SP6,PTCNPACC
          CALL      IBATMDKY
          BRANCH    EXIT,UPHOS18,UPHOS18
.
          COMPARE   FIVE,IBTHSTFM
          IF        !@EQUAL
            DISPLAY   *P1:24,*EL,*B,*V2LON:
                      "Stationery Code is an Invalid Type. ";
            CALL      HITENTER
            GOTO      KHS18172
          ENDIF
.
          MOVE      KEY6,PTCNPACC
          GOTO      UPHOS18
.
. Enter Emergency EOC Details in :                            
.
KHS18173  MOVE      "23",CVERT
          MOVE      "52",CCOL
          MOVE      "Enter Emergency EOC Details in",BOXHDR
          CALL      LDEEOC00                
          PROC      GENCODKY
          BRANCH    EXIT,UPHOS18
          MOVE      TEMPCODE,PTCNEEOC
          GOTO      UPHOS18
.
. ----- Hospital Screen 19 -----
.
UPHOS19   CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS 
.
          BRANCH    CCITEM,KHS19010,KHS19020,KHS19030,KHS19040,KHS19050:
                           KHS19060,KHS19070,KHS19080,KHS19090,KHS19100:
                           KHS19110,KHS19120,KHS19130,KHS19140,KHS19150:
                           KHS19160,KHS19170,KHS19180,KHS19190,KHS19200
          BEEP
          GOTO      UPHOS19
.
.         Cheque/Receipt No. for Health Fund & Insurance Receipts Audit
.
KHS19010  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = ",DRORC0,",  ":
                    *V2LON,ONE,*HOFF," = ",DRORC1;
.
KHS19012  KEYIN     *P52:4,*EL,*DV,UNDLN1,*P52:4,*V2LON,PTCNRORC:
                    *P52:4,*DV,PTCNRORC;
.
          BRANCH    PTCNRORC,KHS19014
          COMPARE   ZERO,PTCNRORC
          GOTO      KHS19014 IF EQUAL
          BEEP
          GOTO      KHS19012
.
KHS19014  MOVE      DRORC0,DRORC
          LOAD      DRORC,PTCNRORC,DRORC1
.
          DISPLAY   *P56:4,DRORC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS19
.
. ------  Unplanned visit to theatre  ----------
.
KHS19020  MOVE      "52",CCOL                * column for keyin
          MOVE      "5",CVERT                * row for keyin
.
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,PTCNUVTH
          IF        (PTCNUVTH < 0) | (PTCNUVTH> 9)
            BEEP
            GOTO      KHS19020
          ENDIF
.
          PACK      KEY5,ANSU,PTCNUVTH,SP3
          MOVE      "Invalid Code        ",TDESC       
          CALL      RDCODE1
          MOVE      TDESC,DESCUVTH
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNUVTH,*HOFF:
                    *P56:CVERT,DESCUVTH
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS19
.
. ------  Involvement of Palliative Care Team  ----------
.
KHS19030  MOVE      "52",CCOL                * column for keyin
          MOVE      "6",CVERT            * row for keyin
.
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,PTCNPALC
          IF        (PTCNPALC < 0) | (PTCNPALC> 9)
            BEEP
            GOTO      KHS19030
          ENDIF
.
          PACK      KEY5,ANSU,PTCNPALC,SP3
          MOVE      "Invalid Code        ",TDESC       
          CALL      RDCODE1
          MOVE      TDESC,DESCPALC
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNPALC,*HOFF:
                    *P56:CVERT,DESCPALC
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS19
.
. ------- User Defined Category to use for Financial Prg.(NSW Trans.) -------
.
KHS19040  DISPLAY   *P1:24,*EL,"Valid values are 1 - 5";
.
          KEYIN     *P52:7,*EL,*V2LON,PTCNFINP
          BRANCH    PTCNFINP,KHS19042,KHS19042,KHS19042,KHS19042,KHS19042
          DISPLAY   *P1:24,*EL,*B,*V2LON:
                    "** Invalid User Defined Category **    ";
          CALL      HITENTER
          GOTO      KHS19040
.
KHS19042  MOVE      SP20,TDESC
          PACK      KEY5,ANSD,PTCNFINP,SP3
          CALL      RDCODE1
          DISPLAY   *P56:7,TDESC;
          MOVE      ZERO,OVRCD               * Set update flag
          GOTO      UPHOS19
.
.         Using Eltron printer for PMI labels
.
KHS19050  MOVE      "8",CVERT
          MOVE      "52",CCOL
          MOVE      PTCNPELT,ANS
          CALL      KYND0000                * Standard yes/no keyin
          MOVE      EXIT,PTCNPELT
          GOTO      UPHOS19
.
.         Using Eltron printer for INP labels
.
KHS19060  MOVE      "9",CVERT
          MOVE      "52",CCOL
          MOVE      PTCNIELT,ANS
          CALL      KYND0000                * Standard yes/no keyin
          MOVE      EXIT,PTCNIELT
          GOTO      UPHOS19
.
. ------- User Defined Category to use for ACC Accident Flag (NMDS req.) ----
.
KHS19070  DISPLAY   *P1:24,*EL,"Valid values are 1 - 4";
.
          KEYIN     *P52:10,*EL,*V2LON,PTCNACCF
          BRANCH    PTCNACCF,KHS19072,KHS19072,KHS19072,KHS19072
          DISPLAY   *P1:24,*EL,*B,*V2LON:
                    "** Invalid User Defined Category **    ";
          CALL      HITENTER
          GOTO      KHS19070
.
KHS19072  MOVE      SP20,TDESC
          PACK      KEY5,ANSL,PTCNACCF,SP3
          CALL      RDCODE1
          DISPLAY   *P56:10,TDESC;
          MOVE      ZERO,OVRCD               * Set update flag
          GOTO      UPHOS19
.
.-------- Default Health Agency code (category HA)
.
KHS19080  MOVE      "11",CVERT
.
          MOVE      CVERT,EVERT
          MOVE      "52",ECOL
          MOVE      "HA",CODE
          MOVE      PTCNHADF,CKYIDEF3
          MOVE      "0",CKYIMAND
          MOVE      "1",CNEWDS
.
          DISPLAY   *P56:CVERT,*EL 
          CALL      PATCODKY
.
          BRANCH    EXIT,KHS19082,UPHOS19
.
          MOVE      ACODE,PTCNHADF
          PACK      TDESC,TDESC,SP20
          GOTO      KHS19085
.
KHS19082  MOVE      SP3,PTCNHADF
          PACK      TDESC,SP20
.
KHS19085  DISPLAY   *P52:11,*EL,*V2LON,PTCNHADF,*HOFF:
                    *P56:11,TDESC;
          GOTO      UPHOS19
.
. ----- (No longer used) -----
.
KHS19090  BEEP
          GOTO      UPHOS19
.
. ----- Don't display encoder interface birth weight -----
.
KHS19100  MOVE      "13",CVERT
          MOVE      "52",CCOL
          MOVE      PTCNDEBW,ANS
          CALL      KYND0000                * Standard yes/no keyin
          MOVE      EXIT,PTCNDEBW
          GOTO      UPHOS19
.
. ----- Accommodation description -----
.
KHS19110  MOVE      "52",CCOL
          MOVE      "14",CVERT
          DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF," - 1,":
                    *V2LON,"1",*HOFF," - Two Lines Daily and Add.Charge,";
.
          KEYIN     *P52:14,*EL,*V2LON,PTCNIDES
.
          COMPARE   ZERO,PTCNIDES
          GOTO      KHS19115 IF EQUAL
          BRANCH    PTCNIDES,KHS19115
.
          DISPLAY   *P1:24,*EL,*B;
          GOTO      KHS19110
.
KHS19115  MOVE      "14",CVERT
          MOVE      "52",CCOL
          MOVE      ACCDES0,DIM24
          LOAD      DIM24,PTCNIDES,ACCDES1
          DISPLAY   *PCCOL:CVERT,*EL,*V2LON,PTCNIDES,*HOFF," - ",DIM24;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS19
.
. ------- Messages if DRG not allocated for Same day -------
.
KHS19120  DISPLAY   *P1:24,*EL,"0=Do nothing, 1=Warn User, 2=Stop User";
          MOVE      ZERO,PTCNDSDY
          KEYIN     *P52:15,*EL,*V2LON,PTCNDSDY
          MOVE      DDRG0,DDRGSDY
          COMPARE   ZERO,PTCNDSDY
          GOTO      KHS19124 IF EQUAL
          BRANCH    PTCNDSDY,KHS19122,KHS19122
          BEEP
          GOTO      KHS19120
.
KHS19122  LOAD      DDRGSDY,PTCNDSDY,DDRG1,DDRG2
KHS19124  DISPLAY   *P57:15,*V2LON,DDRGSDY;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS19
.
. ------- Messages if DRG not allocated for MSO -------
.
KHS19130  DISPLAY   *P1:24,*EL,"0=Do nothing, 1=Warn User, 2=Stop User";
          MOVE      ZERO,PTCNDMSO
          KEYIN     *P52:16,*EL,*V2LON,PTCNDMSO
          MOVE      DDRG0,DDRGMSO
          COMPARE   ZERO,PTCNDMSO
          GOTO      KHS19134 IF EQUAL
          BRANCH    PTCNDMSO,KHS19132,KHS19132
          BEEP
          GOTO      KHS19130
.
KHS19132  LOAD      DDRGMSO,PTCNDMSO,DDRG1,DDRG2
KHS19134  DISPLAY   *P57:16,*V2LON,DDRGMSO;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS19
+
. ----- Admission type or Bed type in NCF extract -----
.
KHS19140  DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF," - Bed Type, ":
                    *V2LON,"1",*HOFF," - Admission Type";
KHS19141  KEYIN     *P52:17,*EL,*V2LON,PTCNNCFB;
.
          IF        PTCNNCFB<0 |PTCNNCFB>1
            BEEP
            GOTO      KHS19141
          ENDIF
.
          MOVE      SP20,DIM15
          MOVE      BEDTYPE,DIM15
          LOAD      DIM15,PTCNNCFB,ADMTYPE
          DISPLAY   *P52:17,*EL,*V2LON,PTCNNCFB,*P57:17,*HOFF,DIM15;
          GOTO      UPHOS19
.
. ----- Print HFCF from admission programs ? -----
.
KHS19150  MOVE      "18",CVERT
          MOVE      "52",CCOL
          MOVE      PTCNADCF,ANS
          CALL      KYND0000                * Standard yes/no keyin
          MOVE      EXIT,PTCNADCF
          GOTO      UPHOS19
.
. ----- Print HFCF from discharge program ? -----
.
KHS19160  MOVE      "19",CVERT
          MOVE      "52",CCOL
          MOVE      PTCNDSCF,ANS
          CALL      KYND0000                * Standard yes/no keyin
          MOVE      EXIT,PTCNDSCF
          GOTO      UPHOS19
.
. -----  HDP - Category for Employment status -----
.
KHS19170  DISPLAY   *P1:24,*EL,"Valid values are P1... P6,U1... U7 ";
          MOVE      "52",CCOL
          MOVE      "20",CVERT
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,PTCNEMPL;
.
          MOVE      ZERO,FORM1
          UNPACK    SP2,DIM1,DIM1A
          UNPACK    PTCNEMPL,DIM1,DIM1A
          MOVE      DIM1A,FORM1
.
          MATCH     "U",DIM1
          IF        @EQUAL
            IF        FORM1>0 & FORM1< 8
              GOTO      KHS19172
            ENDIF
          ENDIF
.
          MATCH     "P",DIM1
          IF        @EQUAL
            IF        FORM1> 0 & FORM1< 7
              GOTO      KHS19172
            ENDIF
          ENDIF
.
          BEEP
          GOTO      KHS19170
.
KHS19172  PACK      TDESC,SP20
          PACK      KEY5,PTCNEMPL,SP3
          CALL      RDCODE1                 * Read the codes file
          PACK      EMPLDESC,TDESC,SP20
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNEMPL,*P57:CVERT,*HOFF,EMPLDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS19
.
. ----- HDP - Category for Occupation -----
.
KHS19180  DISPLAY   *P1:24,*EL,"Valid values are P1... P6,U1... U7 ";
          MOVE      "52",CCOL
          MOVE      "21",CVERT
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,PTCNOCCP;
.
          MOVE      ZERO,FORM1
          UNPACK    SP2,DIM1,DIM1A
          UNPACK    PTCNOCCP,DIM1,DIM1A
          MOVE      DIM1A,FORM1
.
          MATCH     "U",DIM1
          IF        @EQUAL
            IF        FORM1> 0 & FORM1< 8
              GOTO      KHS19182
            ENDIF
          ENDIF
.
          MATCH     "P",DIM1
          IF        @EQUAL
            IF        FORM1>0 & FORM1< 7
              GOTO      KHS19182
            ENDIF
          ENDIF
.
          BEEP
          GOTO      KHS19180
.
KHS19182  PACK      TDESC,SP20
          PACK      KEY5,PTCNOCCP,SP3
          CALL      RDCODE1                 * Read the codes file
          PACK      OCCPDESC,TDESC,SP20
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNOCCP,*P57:CVERT,*HOFF,OCCPDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS19
.
. ----- HDP - Mental Health Legal Status -----
.
KHS19190  MOVE      "56",HLEF
          MOVE      "13",HTOP
          MOVE      "79",HRIG
          MOVE      "21",HBOT
.
          CALL      GETSCR00                     * save screen
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       13,*V2LON,HLEF,HTOP,HRIG,HBOT
.
          DISPLAY   *P57:14,*V2LON,"1.",*HOFF,CSTAD1:
                    *P57:15,*V2LON,"2.",*HOFF,CSTAD2:
                    *P57:16,*V2LON,"3.",*HOFF,CSTAD3:
                    *P57:17,*V2LON,"4.",*HOFF,CSTAD4:
                    *P57:18,*V2LON,"5.",*HOFF,CSTAD5:
                    *P57:19,*V2LON,"6.",*HOFF,CSTACC:
                    *P57:20,*V2LON,"7.",*HOFF,CSTALS;
.
          MOVE      "52",CCOL
          MOVE      "22",CVERT
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,PTCNCSTA;
.
          IF        PTCNCSTA < 1 | PTCNCSTA > 7
            BEEP
            GOTO      KHS19190
          ENDIF
.
          MOVE      SP70,CTYPDESC
          LOAD      CTYPDESC,PTCNCSTA,CSTAD1,CSTAD2,CSTAD3,CSTAD4,CSTAD5:
                                      CSTACC,CSTALS
          CALL      PUTSCR00                     * restore screen
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNCSTA,*P57:CVERT,*HOFF,CTYPDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS19
.
. ----- Which UDF for Carer Availability -----
.
KHS19200  DISPLAY   *P1:24,*EL,*V2LON,"1-5",*HOFF," Discharge User Defined ":
                    "Fields 1-5, ",*V2LON,"6",*HOFF," pmsvx1af Carer ":
                    "Availability"
          MOVE      "52",CCOL
          MOVE      "23",CVERT
.
KHS19201  MOVE      PTCNCRAY,FORM1
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,FORM1;
.
          IF        FORM1<1 | FORM1>6
            BEEP
            GOTO      KHS19201
          ENDIF
.
          MOVE      FORM1,PTCNCRAY
          PACK      TDESC,SP20
          IF        PTCNCRAY>0 & PTCNCRAY<5
            PACK      KEY5,ANSD,PTCNCRAY,SP3
          ELSE
            PACK      KEY5,ANSV,ANSK,SP3
          ENDIF
          CALL      RDCODE1                 * Read a codes file record
          PACK      CRAYDESC,TDESC,SP20
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNCRAY,*P57:CVERT,*HOFF,CRAYDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS19
+
UPHOS20   CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS
.
          BRANCH    CCITEM,KHS20010,KHS20020,KHS20030,KHS20040,KHS20050:
                    KHS20060,KHS20070,KHS20080,KHS20090,KHS20100,KHS20110:
                    KHS20120,KHS20130,KHS20140,KHS20150,KHS20160,KHS20170:
                    KHS20180,KHS20190,KHS20200
.
          BEEP
          GOTO      UPHOS20
.
KHS20010  MOVE      "4",CVERT
          MOVE      "54",CCOL
          MOVE      "Admission Field for Accident Flag",BOXHDR
          CALL      LDAFLG00                     * load items for selection
          CALL      SELFLG00                     * select item
          IF        EXIT = 1
            MOVE      ZERO,PTCNAFLG
            DISPLAY   *P47:4,*EL,*V2LON,PTCNAFLG     * set to zero
          ELSE
            MOVE      TMPCDE[FORM2],KEY3
            STRIP     KEY3
            MOVE      KEY3,KEY8
            CALL      RDTEMP1                    * get description for item
            MOVE      KEY3,PTCNAFLG
            DISPLAY   *P49:4,*EL,*V2LON,PTCNAFLG,SP2,*HOFF,TEMPDESC
          ENDIF
          GOTO      UPHOS20
.
KHS20020  PACK      KEY15,SCRPRGID,SCRPSCID,SP3,SIXTY8
          CALL      RDSCFL1                          * get description for 68
          BRANCH    OVRCD,UPHOS20
.
          MOVE      SCFLDES,DIM25
.
          PACK      KEY15,SCRPRGID,SCRPSCID,SP3,SIXTY9
          CALL      RDSCFL1                          * get description for 69
          BRANCH    OVRCD,UPHOS20
.
          MOVE      SCFLDES,KEY25
.
. ---- only items 68 & 69 are valid ----
.
          DISPLAY   *P1:24,"Valid fields are: ",*V2LON,"68 ",*HOFF,DIM25:
                           *V2LON," 69 ",*HOFF,KEY25
          KEYIN     *P49:5,*EL,*V2LON,PTCNCLNO
          IF        PTCNCLNO <> 0
            IF        PTCNCLNO = 68
              DISPLAY   *P56:5,DIM25;       * display 68 description
              GOTO      UPHOS20
            ENDIF
            IF        PTCNCLNO = 69
              DISPLAY   *P56:5,KEY25;       * display 69 description
              GOTO      UPHOS20
            ENDIF
            BEEP
            GOTO    KHS20020
          ENDIF
          GOTO      UPHOS20
.
KHS20030  DISPLAY   *P1:24,"1=W1, 2=W2, 3=W3, 4=W4, 5=X5, 6=X6, 7=X7, 8=X8":
                           " 9=Cat S"
          KEYIN     *P53:6,*EL,*V2LON,PTCNCSRL
          IF        PTCNCSRL<0 | PTCNCSRL >9
            DISPLAY   *P1:24,*EL,*V2LON,"Invalid Field";
            CALL      HITENTER
            GOTO      KHS20030
          ENDIF
.
          LOAD      CSRLDESC,PTCNCSRL,CODEW1,CODEW2,CODEW3,CODEW4:
                                      CODEX5,CODEX6,CODEX7,CODEX8,CODES
          DISPLAY   *P56:6,CSRLDESC
          GOTO      UPHOS20
.
KHS20040  KEYIN     *P53:7,*EL,*V2LON,PTCNPSOS
          IF        PTCNPSOS<1 | PTCNPSOS >5
            DISPLAY   *P1:24,*EL,*V2LON,"Invalid Field";
            CALL      HITENTER
            GOTO      KHS20040
          ENDIF
.
KHS20050  DISPLAY   *P54:8,*EL
          MOVE      "51",ECOL
          MOVE      "8",EVERT
          MOVE      CATRQ,CODE
          MOVE      ONE,CKYIMAND
          CALL      PATCODKY
          IF        EXIT=2
            GOTO      KHS20050
          ENDIF
.
          MOVE      ACODE,PTCNRQDF
          PACK      KEY5,CATRQ,PTCNRQDF
          CALL      RDCODE1
          IF        OVRCD=1
            DISPLAY   *P54:8,*EL
            DISPLAY   *P1:24,*EL,*V2LON,"Invalid Code. ";
            CALL      HITENTER
            GOTO      KHS20050
          ENDIF
.
          MOVE      TDESC,RQDFDESC
          DISPLAY   *P51:8,*EL,*P53:8,*EL,*V2LON:
                    PTCNRQDF,*HOFF,*P56:8,RQDFDESC
          GOTO      UPHOS20
.
KHS20060  DISPLAY   *P54:9,*EL
          MOVE      "51",ECOL
          MOVE      "9",EVERT
          MOVE      CATHP,CODE
          MOVE      ZERO,CKYIMAND
          CALL      PATCODKY
.
          MOVE      ACODE,PTCNHPCD
          PACK      KEY5,CATHP,PTCNHPCD 
          CALL      RDCODE1
          IF        OVRCD=1
            DISPLAY   *P54:9,*EL
            DISPLAY   *P1:24,*EL,*V2LON,"Invalid Code. ";
            CALL      HITENTER
            GOTO      KHS20060
          ENDIF
.
          MATCH     SP3,PTCNHPCD
          MOVE      TDESC,HPCDDESC
.
          IF        @EQUAL
            MOVE      SP30,HPCDDESC
          ENDIF
          DISPLAY   *P51:9,*EL,*P53:9,*V2LON,PTCNHPCD:
                    *HOFF,*P56:9,HPCDDESC
          GOTO      UPHOS20
.
KHS20070  DISPLAY   *P51:10,SP3
          KEYIN     *P51:10,*V2LON,PMISYN
          REP       UPPLOW,PMISYN
          MATCH     "Y",PMISYN
          IF        @EQUAL
            MOVE      ONE,PTCNPMIS
            MOVE      "Yes",PMISDESC
          ELSE
            MATCH     "N",PMISYN
            IF        @EQUAL
              MOVE      ZERO,PTCNPMIS
              MOVE      "No",PMISDESC
            ELSE
              GOTO     KHS20070
            ENDIF
          ENDIF
          DISPLAY   *P51:10,*V2LON,PMISDESC
          GOTO      UPHOS20
.
.******************************************** start of changes        *I-137125
KHS20080  
          GOTO      UPHOS20
.
KHS20090  DISPLAY   *P51:12,SP3
          KEYIN     *P51:12,*V2LON,DGSTYN
          REP       UPPLOW,DGSTYN
          MATCH     "Y",DGSTYN
          IF        @EQUAL
            MOVE      "Y",PTCNDGST
            MOVE      "Yes",DGSTDESC
          ELSE
            MATCH     "N",DGSTYN
            IF        @EQUAL
              MOVE      "N",PTCNDGST
              MOVE      "No",DGSTDESC
            ELSE
              GOTO     KHS20090
            ENDIF
          ENDIF
          DISPLAY   *P51:12,*V2LON,DGSTDESC
          GOTO      UPHOS20
.
KHS20100  DISPLAY   *P51:13,SP6,*P59:13,SP30
          MOVE      "51",PCCOL
          MOVE      "51",CCOL
          MOVE      "13",CVERT
          MOVE      ZERO,IBGSACTV
          CALL      KIBGSA00
.
*          COMPARE   ONE,IBGSACTV
*          IF        @EQUAL
*            MOVE      "Inactive Code - ",DISPMSG
*            CALL      MESSAGE1
*            GOTO      KHS20100
*          ENDIF
*          GOTO      KHS20100 IF EQUAL
.
          MOVE      IBGSCODE,PTCNAGST
          MOVE      "Invalid Code ",AGSTDESC
          PACK      KEY6,PTCNAGST
          CALL      RDIBGS1
          IF        OVRCD<>1
            MATCH     SP6,PTCNAGST
            IF        !@EQUAL
              MOVE      IBGSDESC,AGSTDESC
            ELSE
              MOVE      SP30,AGSTDESC
            ENDIF
          ENDIF
          DISPLAY   *P59:13,AGSTDESC
          GOTO      UPHOS20
.
.------ keyin user defined stationery code for patient invoice header ------
.
KHS20110  MOVE      SP6,IBTHSCOD
          MOVE      ZERO,CKEYTYP
          MOVE      "51",CCOL
          MOVE      "14",CVERT
.
          CALL      KIBTHA00
          BRANCH    EXIT,KHS20110,KHS20115
.
          COMPARE   NINE,IBTHSTFM                * correct type ?
          IF        !@EQUAL
            DISPLAY   *P1:24,*EL,*B,*V2LON:
                      "Stationery Code is an invalid type.  ";
            CALL      HITENTER
            GOTO      KHS20110
          ENDIF
.
          MOVE      IBTHSCOD,PTCNPAIH
KHS20115  GOTO      UPHOS20
.
.------ keyin user defined stationery code for patient invoice tail ------
.
KHS20120  MOVE      SP6,IBTHSCOD
          MOVE      ZERO,CKEYTYP
          MOVE      "51",CCOL
          MOVE      "15",CVERT
.
          CALL      KIBTHA00
          BRANCH    EXIT,KHS20120,KHS20125
.
          COMPARE   TEN,IBTHSTFM                 * correct type ?
          IF        !@EQUAL
            DISPLAY   *P1:24,*EL,*B,*V2LON:
                      "Stationery Code is an invalid type.  ";
            CALL      HITENTER
            GOTO      KHS20120
          ENDIF
.
          MOVE      IBTHSCOD,PTCNPAIT
KHS20125  GOTO      UPHOS20
+
.
KHS20130  DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF," - Portrait, ":
                               "1",*HOFF," - Landscape, ":
                               "2",*HOFF," - Landscape & Right Hand side";
          MOVE      "51",CCOL
          MOVE      "16",CVERT
.
KHS20132  MOVE      PTCNINVB,FORM1
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,FORM1;
.
          IF        FORM1<0 | FORM1>2
            BEEP
            GOTO      KHS20132
          ENDIF
.
          MOVE      FORM1,PTCNINVB
          MOVE      DPORTR,DANS10
          LOAD      DANS10,PTCNINVB,DLANDC,DLANDR
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNINVB,*P57:CVERT,*HOFF,DANS10:
                    *P1:24,*EL;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS20
.
KHS20140  DISPLAY   *P51:17,SP3
          KEYIN     *P51:17,*V2LON,PSQLYN
          REP       UPPLOW,PSQLYN
          MATCH     "Y",PSQLYN
          IF        @EQUAL
            MOVE      ONE,PTCNUSQL
            MOVE      "Yes",PSQLDESC
          ELSE
            MATCH     "N",PSQLYN
            IF        @EQUAL
              MOVE      ZERO,PTCNUSQL
              MOVE      "No",PSQLDESC
            ELSE
              GOTO     KHS20140
            ENDIF
          ENDIF
          DISPLAY   *P51:17,*V2LON,PSQLDESC
          GOTO      UPHOS20
.
KHS20150  DISPLAY   *P51:18,SP3
          KEYIN     *P51:18,*V2LON,PSQLYN
          REP       UPPLOW,PSQLYN
          MATCH     "Y",PSQLYN
          IF        @EQUAL
            MOVE      ONE,PTCNPLFI
            MOVE      "Yes",PLFIDESC
          ELSE
            MATCH     "N",PSQLYN
            IF        @EQUAL
              MOVE      ZERO,PTCNPLFI
              MOVE      "No",PLFIDESC
            ELSE
              GOTO     KHS20140
            ENDIF
          ENDIF
          DISPLAY   *P51:18,*V2LON,PLFIDESC
          GOTO      UPHOS20
.
.         No longer used
.
KHS20160  
          GOTO      UPHOS20
.
.         No longer used
.
KHS20170  
          GOTO      UPHOS20
.
.         No longer used
.
KHS20180  GOTO      UPHOS20
.
KHS20190  MOVE      "51",CCOL
          MOVE      "22",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNCMYN
          MOVE      ZERO,OVRCD
.
          GOTO      UPHOS20
.
KHS20200  MOVE      "51",CCOL
          MOVE      "23",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNNWCM
          MOVE      ZERO,OVRCD
.
          GOTO      UPHOS20
+
UPHOS21   CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS
.
          BRANCH    CCITEM,UPHOS21,KHS21020,KHS21030,KHS21040,KHS21050:
                           KHS21060,KHS21070,KHS21080,UPHOS21,UPHOS21:
                           UPHOS21,KHS21120,KHS21130,KHS21140,KHS21150:
                           KHS21160,KHS21170,KHS21180,KHS21190,KHS21200
.
          BEEP
          GOTO      UPHOS21
.
KHS21010  MOVE      "56",CCOL
          GOTO      UPHOS21
.
KHS21020  MOVE      "56",CCOL
          MOVE      "5",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNAUAT 
          GOTO      UPHOS21
.
KHS21030  MOVE      "56",CCOL
          MOVE      "6",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNWSPC 
          GOTO      UPHOS21
.
KHS21040  MOVE      SP3,PTCNADB1
          KEYIN     *P56:7,*EL,*V2LON,PTCNADB1;
          ENDSET    PTCNADB1
          APPEND    SP3,PTCNADB1
          RESET     PTCNADB1
          GOTO      UPHOS21
.
KHS21050  MOVE      SP3,PTCNADB2
          KEYIN     *P56:8,*EL,*V2LON,PTCNADB2;
          ENDSET    PTCNADB2
          APPEND    SP3,PTCNADB2
          RESET     PTCNADB2
          GOTO      UPHOS21
.
KHS21060  MOVE      SP3,PTCNADB3
          KEYIN     *P56:9,*EL,*V2LON,PTCNADB3;
          ENDSET    PTCNADB3
          APPEND    SP3,PTCNADB3
          RESET     PTCNADB3
          GOTO      UPHOS21
.
KHS21070  MOVE      SP3,PTCNADB4
          KEYIN     *P56:10,*EL,*V2LON,PTCNADB4;
          ENDSET    PTCNADB4
          APPEND    SP3,PTCNADB4
          RESET     PTCNADB4
          GOTO      UPHOS21
.
KHS21080  MOVE      SP3,PTCNDFAN
          KEYIN     *P56:11,*EL,*V2LON,PTCNDFAN;
          ENDSET    PTCNDFAN
          APPEND    SP3,PTCNDFAN
          RESET     PTCNDFAN
          GOTO      UPHOS21
.
KHS21090  MOVE      "56",CCOL
          MOVE      "12",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNU50G                                      *C-39275
          BRANCH    EXIT,KHS2109A                                      *I-????
          DISPLAY   *P61:12,*EL                                        *I-????
          GOTO      UPHOS21
.
KHS2109A  DISPLAY   *P61:12,"3M Code: "                                *I-????
          KEYIN     *P70:12,*V2LON,*RV,PTCNC50C                        *I-????
          GOTO      UPHOS21                                            *I-????
.
KHS21100  MOVE      "56",CCOL
          MOVE      "13",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNU42G
          BRANCH    EXIT,KHS2110A                                      *I-????
          DISPLAY   *P61:13,*EL                                        *I-????
          GOTO      UPHOS21
.
KHS2110A  DISPLAY   *P61:13,"3M Code: "                                *I-????
          KEYIN     *P70:13,*V2LON,*RV,PTCNC42C                        *I-????
          GOTO      UPHOS21                                            *I-????
.
KHS21110  MOVE      "56",CCOL
          MOVE      "14",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNU41G
          BRANCH    EXIT,KHS2111A                                      *I-????
          DISPLAY   *P61:14,*EL                                        *I-????
          GOTO      UPHOS21
.
KHS2111A  DISPLAY   *P61:14,"3M Code: "                                *I-????
          KEYIN     *P70:14,*V2LON,*RV,PTCNC41C                        *I-????
          GOTO      UPHOS21                                            *I-????
.
KHS21120  MOVE      "56",CCOL
          MOVE      "15",CVERT
          DISPLAY   *P56:15,*V2LON,*EL,*P61:15,"0=No 1=Yes 2=Warn"
          KEYIN     *P56:15,*V2LON,PTCNONLA;
          IF        PTCNONLA<0 | PTCNONLA>3
            GOTO      KHS21120
          ENDIF
          GOTO      UPHOS21
.
KHS21130  MOVE      "56",CCOL
          MOVE      "16",CVERT
          UNPACK    PTCNTIMC,CHOUR,ANS,CMIN
          CALL      KEYTIME
          PACK      PTCNTIMC,CHOUR,COLON,CMIN
          REP       " 0",PTCNTIMC
          GOTO      UPHOS21
.
KHS21140  MOVE      "56",CCOL
          MOVE      "17",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNICUT
          GOTO      UPHOS21
.
KHS21150  MOVE      "56",CCOL
          MOVE      "18",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNIOEV
          GOTO      UPHOS21
.
KHS21160  MOVE      "56",CCOL
          MOVE      "19",CVERT
          KEYIN     *P56:19,*V2LON,PTCNNULB;
          IF        PTCNNULB < 0 
            GOTO      KHS21160
          ENDIF
          GOTO      UPHOS21
.
KHS21170  MOVE      "56",CCOL
          MOVE      "20",CVERT
          UNPACK    PTCNTIMN,CHOUR,ANS,CMIN
          CALL      KEYTIME
          PACK      PTCNTIMN,CHOUR,COLON,CMIN
          REP       " 0",PTCNTIMN
          GOTO      UPHOS21
.
KHS21180  MOVE      "56",CCOL
          MOVE      "21",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNPRCL
          GOTO      UPHOS21
.
KHS21190  MOVE      "56",CCOL
          MOVE      "22",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTMBSINV
          GOTO      UPHOS21
.
KHS21200  MOVE      "56",CCOL
          MOVE      "23",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNCPAH
          GOTO      UPHOS21
.
+
.----------------------------------------------------------------------
.                    HOSPITAL PRS/2 SCREEN 01
.----------------------------------------------------------------------
UPHOS22   CALL      MAINQST

          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS
.
          BRANCH    CCITEM,KHP0110,KHP0120,KHP0130,KHP0140,KHP0150,KHP0160:
                           KHP0170,KHP0180,KHP0190,KHP0200,KHP0210,KHP0220:
                           KHP0230,KHP0240,KHP0250,KHP0260,KHP0270,KHP0280
.
          BEEP
          GOTO      UPHOS22
.
+
.******************************************************************************
.         Send Medicare Number for PRS/2 - PTCNMEDC
.******************************************************************************
KHP0110   MOVE      "50",CCOL
          MOVE      "4",CVERT 
          CALL      KYND0000
          MOVE      EXIT,PTCNMEDC
          MOVE      ZERO,OVRCD
.
          GOTO      UPHOS22
+
.******************************************************************************
.         PRS/2 Report Code for 1st Request - PTCNPRS1
.******************************************************************************
KHP0120   MOVE      "1",HLEF
          MOVE      "21",HTOP
          MOVE      "80",HRIG
          MOVE      "24",HBOT
          CALL      GETSCR00                * Save the current screen
KHP0120A  DISPLAY   *P1:21,*EF,"________________________________________":
                               "________________________________________":
                    *P1:22,*EF,*V2LON,"0",*HOFF," = No Report, ":
                               *V2LON,"1",*HOFF," = Diagnosis Outstanding, ":
                               *V2LON,"2",*HOFF," = Nil-value DRG":
                               *V2LON,"3",*HOFF," = Census Report":    *I-53150
                    *P1:23,*EL,*V2LON,"4",*HOFF," = Sub Acute Outstanding, ":
                               *V2LON,"5",*HOFF," = Hospital in the Home, ":
                               *V2LON,"6",*HOFF," = DRG-Based Simple Index, ":
                    *P1:24,*EL,*V2LON,"13",*HOFF," = Hospital Active & WIES":
                    *P50:5,*EL,UNDLN2;
          MOVE      SP2,PTCNPRS1
          MOVE      SP30,PRSREP1
          MOVE      ZERO,FORM2
          KEYIN     *P50:5,*V2LON,*RV,FORM2;
.
          COMPARE   ZERO,FORM2              * see if no code entered
          GOTO      KHP0120E IF EQUAL
.
          BRANCH    FORM2,KHP0120C,KHP0120C,KHP0120C,KHP0120C,KHP0120C: *C-53150
                          KHP0120C,KHP0120B,KHP0120B,KHP0120B,KHP0120B:
                          KHP0120B,KHP0120B,KHP0120C                   *I-42453
.
KHP0120B  BEEP                              * invalid code
          GOTO      KHP0120A
.
KHP0120C  MOVE      FORM2,PTCNPRS1
          REP       " 0",PTCNPRS1
.
          MATCH     PTCNPRS1,PTCNPRS2       * match report codes 1 & 2
          GOTO      KHP0120D IF EQUAL
.
          MATCH     PTCNPRS1,PTCNPR3A       * match report codes 1 & 3
          GOTO      KHP0120D IF EQUAL                                  *I-53150
.
          MATCH     PTCNPRS1,PTCNPRS4       * match report codes 1 & 4
          GOTO      KHP0120D IF EQUAL
.
          MATCH     PTCNPRS1,PTCNPRS5       * match report codes 1 & 5
          GOTO      KHP0120D IF EQUAL
.
          MATCH     PTCNPRS1,PTCNPRS6       * match report codes 1 & 6
          GOTO      KHP0120D IF EQUAL                                  *I-53150
.
          LOAD      PRSREP1,FORM2,PRSDESC1,PRSDESC2,PRSDESC3,PRSDESC4: *C-53150
                                  PRSDESC5,PRSDESC6,SP30,SP30:         *I-42453
                                  SP30,SP30,SP30,SP30:                 *I-42453
                                  PRSDES13                             *I-42453
          GOTO      KHP0120E
.
KHP0120D  DISPLAY   *P1:24,*EL,*B:
                    "You Cannot Use the Same Report Code Twice.  ";
          CALL      HITENTER
          GOTO      KHP0120A
.
KHP0120E  MOVE      ZERO,OVRCD
          CALL      PUTSCR00                * Restore the previous screen
          DISPLAY   *P50:5,*EL,*V2LON,PTCNPRS1,*P54:5,*HOFF,PRSREP1;
          GOTO      KHP0130                                            *I-42453
.         GOTO      UPHOS22
+
.******************************************************************************
.         keyin date range for 1st PRS2 report code - PTCNRNG1
.******************************************************************************
KHP0130   MOVE      SIX,CVERT
          MOVE      SP12,PTCNRNG1
.
KHP0130A  MOVE      FIFTY,CCOL
          MOVE      SP2,CMON
          MOVE      SP2,CYEAR
          MOVE      SP2,CCENT
          DISPLAY   *P50:6,*EL;
.
          MATCH     "13",PTCNPRS1                                      *I-42453
          IF        @EQUAL
            DISPLAY   *P1:06,*V2LON," 3",*HOFF:
                      ". PRS2 1st report request date               :":
                      *P1:24,*EL,"Enter request date: DDMMCCYY"
          ELSE
            MATCH     "03",PTCNPRS1                                    *I-53150
            IF        @EQUAL
              DISPLAY   *P1:06,*V2LON," 3",*HOFF:
                        ". PRS2 1st report request date               :":
                        *P1:24,*EL,"Enter request date: DDMMCCYY"
            ELSE
              DISPLAY   *P1:06,*V2LON," 3",*HOFF:
                        ". PRS2 1st report request date range         :":
                        *P1:24,*EL,"Enter request date range: MMCCYY to MMCCYY"
            ENDIF
          ENDIF
.
.         MATCH     "13",PTCNPRS1                                      *I-42453
.         GOTO      KHP013BA IF NOT EQUAL                              *I-42453
.                                                                      *I-42453
          MATCH     "13",PTCNPRS1 
          IF        !@EQUAL
            MATCH     "03",PTCNPRS1                                    *I-53150
            GOTO      KHP013BA IF NOT EQUAL
          ENDIF
.
          UNPACK    SP20,CYEAR,CMON,CDAY                               *I-42453
          CALL      KEYDATE                                            *I-42453
          GOTO      KHP0130E                                           *I-42453
.
KHP013BA  CALL      KEYMONTH                * keyin the month
          BRANCH    OVRCD,KHP0130F
.
          PACK      PRSDAT6A,CCENT,CYEAR,CMON
          MOVE      PRSDAT6A,DIM6
.
          CALL      CURR0000                * check against current date
          BRANCH    EXIT,KHP0130A
          DISPLAY   *P57:6," to ";
          MOVE      SIXTY1,CCOL
.
KHP0130B  MOVE      SP2,CMON
          MOVE      SP2,CYEAR
          MOVE      SP2,CCENT
.
          CALL      KEYMONTH                * keyin the month
          BRANCH    OVRCD,KHP0130A
.
          PACK      PRSDAT6B,CCENT,CYEAR,CMON
          MOVE      PRSDAT6B,DIM6
.
          CALL      CURR0000                * check against current date
          BRANCH    EXIT,KHP0130B
.
          MATCH     PRSDAT6A,PRSDAT6B
          GOTO      KHP0130D IF LESS
.
          CALL      CHCK0000                * check the date range
          BRANCH    EXIT,KHP0130C
          UNPACK    PRSDAT6A,CCENT,CYEAR,CMON
          UNPACK    PRSDAT6B,XCENT,XYEAR,XMON
          PACK      PTCNRNG1,CCENT,CYEAR,CMON,XCENT,XYEAR,XMON
          GOTO      KHP0130F
.
KHP0130C  DISPLAY   *P1:24,*EL,*B:
                    "Date Range Cannot Exceed 2 Years. ";
          CALL      HITENTER
          GOTO      KHP0130B
.
.           invalid date range entered
.
KHP0130D  DISPLAY   *P1:24,*EL,*B,"Invalid Date Range. ";
          CALL      HITENTER
          GOTO      KHP0130B
.
KHP0130E  PACK      PTCNRNG1,CCENT,CYEAR,CMON,CDAY,SP4                 *I-42453
          GOTO      KHP0130F
.
KHP0130F  MOVE      ZERO,OVRCD
          GOTO      UPHOS22
+
.******************************************************************************
.         PRS/2 Report Code for 2nd Request - PTCNPRS2
.******************************************************************************
KHP0140   MOVE      "1",HLEF
          MOVE      "21",HTOP
          MOVE      "80",HRIG
          MOVE      "24",HBOT
          CALL      GETSCR00                * Save the current screen
KHP0140A  DISPLAY   *P1:21,*EF,"________________________________________":
                               "________________________________________":
                    *P1:22,*EF,*V2LON,"0",*HOFF," = No Report, ":
                               *V2LON,"1",*HOFF," = Diagnosis Outstanding, ":
                               *V2LON,"2",*HOFF," = Nil-value DRG":
                               *V2LON,"3",*HOFF," = Census Report":    *I-53150
                    *P1:23,*EL,*V2LON,"4",*HOFF," = Sub Acute Outstanding, ":
                               *V2LON,"5",*HOFF," = Hospital in the Home, ":
                               *V2LON,"6",*HOFF," = DRG-Based Simple Index, ":
                    *P1:24,*EL,*V2LON,"13",*HOFF," = Hospital Active & WIES":
                    *P50:7,*EL,UNDLN2;
          MOVE      SP2,PTCNPRS2
          MOVE      SP30,PRSREP2
          MOVE      ZERO,FORM2
          KEYIN     *P50:7,*V2LON,*RV,FORM2;
.
          COMPARE   ZERO,FORM2              * see if no code entered
          GOTO      KHP0140E IF EQUAL
.
          BRANCH    FORM2,KHP0140C,KHP0140C,KHP0140C,KHP0140C,KHP0140C: *I-53150
                          KHP0140C,KHP0140B,KHP0140B,KHP0140B,KHP0140B:
                          KHP0140B,KHP0140B,KHP0140C                   *I-42453
.
KHP0140B  BEEP                              * invalid code
          GOTO      KHP0140A
.
KHP0140C  MOVE      FORM2,PTCNPRS2
          REP       " 0",PTCNPRS2
.
          MATCH     PTCNPRS1,PTCNPRS2       * match report codes 1 & 2
          GOTO      KHP0140D IF EQUAL
.
          MATCH     PTCNPRS2,PTCNPR3A       * match report codes 2 & 3
          GOTO      KHP0140D IF EQUAL                                  *I-53150
.
          MATCH     PTCNPRS2,PTCNPRS4       * match report codes 2 & 4
          GOTO      KHP0140D IF EQUAL
.
          MATCH     PTCNPRS2,PTCNPRS5       * match report codes 2 & 5
          GOTO      KHP0140D IF EQUAL
.
          MATCH     PTCNPRS2,PTCNPRS6       * match report codes 2 & 6
          GOTO      KHP0140D IF EQUAL                                  *I-53150
.
          LOAD      PRSREP2,FORM2,PRSDESC1,PRSDESC2,PRSDESC3,PRSDESC4: *C-53150
                                  PRSDESC5,PRSDESC6,SP30,SP30:         *I-42453
                                  SP30,SP30,SP30,SP30:                 *I-42453
                                  PRSDES13                             *I-42453
          GOTO      KHP0140E
.
KHP0140D  DISPLAY   *P1:24,*EL,*B:
                    "You Cannot Use the Same Report Code Twice.  ";
          CALL      HITENTER
          GOTO      KHP0140A
.
KHP0140E  MOVE      ZERO,OVRCD
          CALL      PUTSCR00                * Restore the previous screen
          DISPLAY   *P50:7,*EL,*V2LON,PTCNPRS2,*P54:7,*HOFF,PRSREP2;
          GOTO      KHP0150                                            *I-42453
.         GOTO      UPHOS22
+
.*****************************************************************************
.*        keyin date range for 2nd PRS2 report code - PTCNRNG2
.*****************************************************************************
KHP0150   MOVE      EIGHT,CVERT
          MOVE      SP12,PTCNRNG2
.
KHP0150A  MOVE      FIFTY,CCOL
          MOVE      SP2,CMON
          MOVE      SP2,CYEAR
          MOVE      SP2,CCENT
          DISPLAY   *P50:8,*EL;
.
          MATCH     "13",PTCNPRS2                                      *I-42453
          IF        @EQUAL
            DISPLAY   *P1:08,*V2LON," 5",*HOFF:
                      ". PRS2 2nd report request date               :":
                      *P1:24,*EL,"Enter request date: DDMMCCYY"
          ELSE
            MATCH     "03",PTCNPRS2                                    *I-53150
            IF        @EQUAL
              DISPLAY   *P1:08,*V2LON," 5",*HOFF:
                        ". PRS2 2nd report request date               :":
                        *P1:24,*EL,"Enter request date: DDMMCCYY"
            ELSE
              DISPLAY   *P1:08,*V2LON," 5",*HOFF:
                        ". PRS2 2nd report request date range         :":
                        *P1:24,*EL,"Enter request date range: MMCCYY to MMCCYY"
            ENDIF
          ENDIF
.
.         MATCH     "13",PTCNPRS2                                      *I-42453
.         GOTO      KHP015BA IF NOT EQUAL                              *I-42453
.                                                                      *I-42453
          MATCH     "13",PTCNPRS2
          IF        !@EQUAL
            MATCH     "03",PTCNPRS2                                    *I-53150
            GOTO      KHP015BA IF NOT EQUAL
          ENDIF
.
          UNPACK    SP20,CYEAR,CMON,CDAY                               *I-42453
          CALL      KEYDATE                                            *I-42453
          GOTO      KHP0150E                                           *I-42453
.
KHP015BA  CALL      KEYMONTH                * keyin the month
          BRANCH    OVRCD,KHP0150F
          PACK      PRSDAT6A,CCENT,CYEAR,CMON
          MOVE      PRSDAT6A,DIM6
.
          CALL      CURR0000                * check against current date
          BRANCH    EXIT,KHP0150A
          DISPLAY   *P57:8," to ";
          MOVE      SIXTY1,CCOL
.
KHP0150B  MOVE      SP2,CMON
          MOVE      SP2,CYEAR
          MOVE      SP2,CCENT
.
          CALL      KEYMONTH                * keyin the month
          BRANCH    OVRCD,KHP0150A
          PACK      PRSDAT6B,CCENT,CYEAR,CMON
          MOVE      PRSDAT6B,DIM6
.
          CALL      CURR0000                * check against current date
          BRANCH    EXIT,KHP0150B
.
          MATCH     PRSDAT6A,PRSDAT6B
          GOTO      KHP0150D IF LESS
.
          CALL      CHCK0000                * check the date range
          BRANCH    EXIT,KHP0150C
          UNPACK    PRSDAT6A,CCENT,CYEAR,CMON
          UNPACK    PRSDAT6B,XCENT,XYEAR,XMON
          PACK      PTCNRNG2,CCENT,CYEAR,CMON,XCENT,XYEAR,XMON
          GOTO      KHP0150F
.
KHP0150C  DISPLAY   *P1:24,*EL,*B:
                    "Date Range Cannot Exceed 2 Years. ";
          CALL      HITENTER
          GOTO      KHP0150B
.
.           invalid date range entered
.
KHP0150D  DISPLAY   *P1:24,*EL,*B,"Invalid Date Range. ";
          CALL      HITENTER
          GOTO      KHP0150B
.
KHP0150E  PACK      PTCNRNG2,CCENT,CYEAR,CMON,CDAY,SP4                 *I-42453
          GOTO      KHP0150F
.
KHP0150F  MOVE      ZERO,OVRCD
          GOTO      UPHOS22
+
.*****************************************************************************
.*        Using PRS2 Census Report - PTCNPRS3
.*****************************************************************************
.KHP0160   MOVE      "50",CCOL
.          MOVE      "9",CVERT
.          CALL      KYND0000                  * keyin yes/no
.          MOVE      EXIT,PTCNPRS3
.          MOVE      ZERO,OVRCD               * Set update flag
.          GOTO      UPHOS22
+
.*****************************************************************************
.*        Date for PRS2 Census Report? - PTCNDTE3
.*****************************************************************************
.KHP0170   MOVE      "50",CCOL
.          MOVE      "10",CVERT
.          MOVE      ZERO,CHIGHLT             * Highlight on
.          MOVE      "19",CCENT
.          UNPACK    SP20,CYEAR,CMON,CDAY
.          CALL      KEYDATE
.          PACK      PTCNDTE3,CCENT,CYEAR,CMON,CDAY
.
.          GOTO      UPHOS22
+
.******************************************************************************
.         PRS/2 Report Code for 3rd Request - PTCNPR3A                 *I-53150
.******************************************************************************
KHP0160   MOVE      "1",HLEF
          MOVE      "22",HTOP
          MOVE      "80",HRIG
          MOVE      "24",HBOT
          CALL      GETSCR00                * Save the current screen
KHP0160A  DISPLAY   *P1:22,*EF,*V2LON,"0",*HOFF," = No Report, ":
                               *V2LON,"1",*HOFF," = Diagnosis Outstanding, ":
                               *V2LON,"2",*HOFF," = Nil-value DRG ":
                               *V2LON,"3",*HOFF," = Census Report":    *I-53150
                    *P1:23,*EL,*V2LON,"4",*HOFF," = Sub Acute Outstanding, ":
                               *V2LON,"5",*HOFF," = Hospital in the Home, ":
                               *V2LON,"6",*HOFF," = DRG-Based Simple Index, ":
                    *P1:24,*EL,*V2LON,"13",*HOFF," = Hospital Active & WIES":
                    *P50:9,*EL,UNDLN2;
          MOVE      SP2,PTCNPR3A
          MOVE      SP30,PRSREP3
          MOVE      ZERO,FORM2
          KEYIN     *P50:9,*V2LON,*RV,FORM2;
.
          COMPARE   ZERO,FORM2              * see if no code entered
          GOTO      KHP0160E IF EQUAL
.
          BRANCH    FORM2,KHP0160C,KHP0160C,KHP0160C,KHP0160C,KHP0160C: *C-53150
                          KHP0160C,KHP0160B,KHP0160B,KHP0160B,KHP0160B:
                          KHP0160B,KHP0160B,KHP0160C
.
KHP0160B  BEEP                              * invalid code
          GOTO      KHP0160A
.
KHP0160C  MOVE      FORM2,PTCNPR3A
          REP       " 0",PTCNPR3A
.
          MATCH     PTCNPR3A,PTCNPRS1       * match report codes 1 & 3 *C-53150
          GOTO      KHP0160D IF EQUAL
.
          MATCH     PTCNPR3A,PTCNPRS2       * match report codes 2 & 3 *I-53150
          GOTO      KHP0160D IF EQUAL
.
          MATCH     PTCNPR3A,PTCNPRS4       * match report codes 3 & 4 *C-53150
          GOTO      KHP0160D IF EQUAL
.
          MATCH     PTCNPR3A,PTCNPRS5       * match report codes 3 & 5 *C-53150
          GOTO      KHP0160D IF EQUAL
.
          MATCH     PTCNPR3A,PTCNPRS6       * match report codes 3 & 6 *I-53150
          GOTO      KHP0160D IF EQUAL
.
          LOAD      PRSREP3,FORM2,PRSDESC1,PRSDESC2,PRSDESC3,PRSDESC4: *I-53150
                                  PRSDESC5,PRSDESC6,SP30,SP30:
                                  SP30,SP30,SP30,SP30:
                                  PRSDES13
.
          GOTO      KHP0160E
.
KHP0160D  DISPLAY   *P1:24,*EL,*B:
                    "You Cannot Use the Same Report Code Twice.  ";
          CALL      HITENTER
          GOTO      KHP0160A
.
KHP0160E  MOVE      ZERO,OVRCD
          CALL      PUTSCR00                * Restore the previous screen
          DISPLAY   *P50:9,*EL,*V2LON,PTCNPR3A,*P54:9,*HOFF,PRSREP3;
          GOTO      KHP0170
.         GOTO      UPHOS22
+
.*****************************************************************************
.*        keyin date range for 2nd PRS2 report code - PTCNRNG2
.*****************************************************************************
KHP0170   MOVE      TEN,CVERT
          MOVE      SP20,PTCNRNG3
.
KHP0170A  MOVE      FIVE0,CCOL
          MOVE      SP2,CMON
          MOVE      CCC,CCENT
          MOVE      SP2,CYEAR
          DISPLAY   *P50:10,*EL;
.
          MATCH     "13",PTCNPR3A
          IF        @EQUAL
            DISPLAY   *P1:10,*V2LON," 7",*HOFF:
                      ". PRS2 3rd report request date               :":
                      *P1:24,*EL,"Enter request date: DDMMCCYY"
          ELSE
            MATCH     "03",PTCNPR3A                                    *I-53150
            IF        @EQUAL
              DISPLAY   *P1:10,*V2LON," 7",*HOFF:
                        ". PRS2 3rd report request date               :":
                        *P1:24,*EL,"Enter request date: DDMMCCYY"
            ELSE
              DISPLAY   *P1:10,*V2LON," 7",*HOFF:
                        ". PRS2 3rd report request date range         :":
                        *P1:24,*EL,"Enter request date range: MMCCYY to MMCCYY"
            ENDIF
          ENDIF
.
.         MATCH     "13",PTCNPR3A
.         GOTO      KHP017BA IF NOT EQUAL
.
          MATCH     "13",PTCNPR3A
          IF        !@EQUAL
            MATCH     "03",PTCNPR3A                                    *I-53150
            GOTO      KHP017BA IF NOT EQUAL
          ENDIF
.
          UNPACK    SP20,CYEAR,CMON,CDAY
          CALL      KEYDATE
          GOTO      KHP0170E
.
KHP017BA  CALL      KEYMONTH                * keyin the month
          BRANCH    OVRCD,KHP0170F
          PACK      PRSDAT6A,CCENT,CYEAR,CMON
          MOVE      PRSDAT6A,DIM6
.
          CALL      CURR0000                * check against current date
          BRANCH    EXIT,KHP0170A
          DISPLAY   *P57:10," to ";
          MOVE      SIXTY1,CCOL
.
KHP0170B  MOVE      SP2,CMON
          MOVE      CCC,CCENT
          MOVE      SP2,CYEAR
.
          CALL      KEYMONTH                * keyin the month
          BRANCH    OVRCD,KHP0170A
          PACK      PRSDAT6B,CCENT,CYEAR,CMON
          MOVE      PRSDAT6B,DIM6
.
          CALL      CURR0000                * check against current date
          BRANCH    EXIT,KHP0170B
.
          MATCH     PRSDAT6A,PRSDAT6B
          GOTO      KHP0170D IF LESS
.
          CALL      CHCK0000                * check the date range
          BRANCH    EXIT,KHP0170C
          UNPACK    PRSDAT6A,CCENT,CYEAR,CMON
          UNPACK    PRSDAT6B,XCENT,XYEAR,XMON
          PACK      PTCNRNG3,CCENT,CYEAR,CMON,XCENT,XYEAR,XMON
          GOTO      KHP0170F
.
KHP0170C  DISPLAY   *P1:24,*EL,*B:
                    "Date Range Cannot Exceed 2 Years. ";
          CALL      HITENTER
          GOTO      KHP0170B
.
.           invalid date range entered
.
KHP0170D  DISPLAY   *P1:24,*EL,*B,"Invalid Date Range. ";
          CALL      HITENTER
          GOTO      KHP0170B
.
KHP0170E  PACK      PTCNRNG3,CCENT,CYEAR,CMON,CDAY,SP4                 *I-42453
          GOTO      KHP0170F
.
KHP0170F  MOVE      ZERO,OVRCD
          GOTO      UPHOS22
+
.*****************************************************************************
.*        Reporting Option for PRS/2  - PTCNREPO
.*****************************************************************************
KHP0180   DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF,"=All transactions":
                    ", ",*V2LON,"1",*HOFF,"=Warnings/Rejections only":
                    ", ",*V2LON,"2",*HOFF,"=Warnings/Rejections at top";
.
          KEYIN     *P50:11,*EL,*V2LON,PTCNREPO;
          MOVE      ZERO,OVRCD
.
          COMPARE   ZERO,PTCNREPO
          GOTO      KHP0180A IF EQUAL
.
          BRANCH    PTCNREPO,KHP0180B,KHP0180C
.
          DISPLAY   *P1:24,*EL,*B,"Invalid Option. ";
          CALL      HITENTER
          GOTO      KHP0180
.
KHP0180A  DISPLAY   *P50:11,*V2LON,*EL,"Full transaction trail";
          GOTO      UPHOS22
.
KHP0180B  DISPLAY   *P50:11,*V2LON,*EL,"Warning/Rejections only";
          GOTO      UPHOS22
.
KHP0180C  DISPLAY   *P50:11,*V2LON,*EL,"Warning/Rejections at top";
          GOTO      UPHOS22
+
.******************************************************************************
.*        Collecting duration of stay in CCU - PTCNCDSC                       *
.******************************************************************************
KHP0190   MOVE      "50",CCOL
          MOVE      "12",CVERT
          CALL      KYND0000                * Keyin yes/no
          MOVE      EXIT,PTCNCDSC
          MOVE      ZERO,OVRCD
          GOTO      UPHOS22
+
.******************************************************************************
.*        Allow 1st admin type be statistical - PTCN1ATS                      *
.******************************************************************************
KHP0200   MOVE      "50",CCOL
          MOVE      "13",CVERT
          CALL      KYND0000                * Keyin yes/no
          MOVE      EXIT,PTCN1ATS
          MOVE      ZERO,OVRCD
          GOTO      UPHOS22
+
.****************************************************************************
.*      Exclude Operation from DRG - PTCNEDRG
.****************************************************************************
KHP0210   MOVE      "50",CCOL
          MOVE      "14",CVERT
          MOVE      SP20,OPERDESC
          MOVE      ZERO,OVRCD
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,*DV,PTCNEDRG:
                    *PCCOL:CVERT,*V2LON,*RV,PTCNEDRG:
                    *PCCOL:CVERT,*V2LON,*DV,PTCNEDRG
.
          ENDSET    PTCNEDRG
          APPEND    SP10,PTCNEDRG
          RESET     PTCNEDRG
.
          MATCH     SP9,PTCNEDRG
          GOTO      UPHOS22 IF EQUAL        * Don't exclude any codes
.
          PACK      KEY9,PTCNEDRG,SP10
          CALL      RDPTICO1
          IF        OVRCD=1 & ICDRDVER>1
            CALL      RD10T9O1
          ENDIF
          IF        OVRCD=1
            DISPLAY   *P1:24,*EL,*B,"Procedure code does not exist.  ";
            CALL      HITENTER
            GOTO      KHP0210
          ENDIF
.
          MATCH     "H",OFLAG
          IF        @EQUAL
            DISPLAY   *P1:24,*EL,*B,"Procedure code is a header record.  ";
            CALL      HITENTER
            GOTO      KHP0210
          ENDIF
.
          MOVE      ODESC,OPERDESC
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNEDRG,*HOFF,SP1,OPERDESC
          MOVE      ZERO,OVRCD
          GOTO      UPHOS22
+
.****************************************************************************
.*      PRS2 new Hospital code  - PTCNHCOD    
.****************************************************************************
KHP0220   KEYIN     *P50:15,*EL,*V2LON,PTCNHCOD;
          DISPLAY   *P50:15,*EL,*V2LON,PTCNHCOD;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS22
+
.******************************************************************************
.         PRS/2 Report Code for 4th Request - PTCNPRS4
.******************************************************************************
KHP0230   MOVE      "1",HLEF
          MOVE      "21",HTOP
          MOVE      "80",HRIG
          MOVE      "24",HBOT
          CALL      GETSCR00                * Save the current screen
KHP0230A  DISPLAY   *P1:21,*EF,"________________________________________":
                               "________________________________________":
                    *P1:22,*EF,*V2LON,"0",*HOFF," = No Report, ":
                               *V2LON,"1",*HOFF," = Diagnosis Outstanding, ":
                               *V2LON,"2",*HOFF," = Nil-value DRG":
                               *V2LON,"3",*HOFF," = Census Report":    *I-53150
                    *P1:23,*EL,*V2LON,"4",*HOFF," = Sub Acute Outstanding, ":
                               *V2LON,"5",*HOFF," = Hospital in the Home, ":
                               *V2LON,"6",*HOFF," = DRG-Based Simple Index, ":
                    *P1:24,*EL,*V2LON,"13",*HOFF," = Hospital Active & WIES":
                    *P50:16,*EL,UNDLN2;
          MOVE      SP2,PTCNPRS4
          MOVE      SP30,PRSREP4
          MOVE      ZERO,FORM2
          KEYIN     *P50:16,*V2LON,*RV,FORM2;
.
          COMPARE   ZERO,FORM2              * see if no code entered
          GOTO      KHP0230E IF EQUAL
.
          BRANCH    FORM2,KHP0230C,KHP0230C,KHP0230C,KHP0230C,KHP0230C: *C-53150
                          KHP0230C,KHP0230B,KHP0230B,KHP0230B,KHP0230B:
                          KHP0230B,KHP0230B,KHP0230C                   *I-42453
.
KHP0230B  BEEP                              * invalid code
          GOTO      KHP0230A
.
KHP0230C  MOVE      FORM2,PTCNPRS4
          REP       " 0",PTCNPRS4
.
          MATCH     PTCNPRS1,PTCNPRS4       * match report codes 1 & 4
          GOTO      KHP0230D IF EQUAL
.
          MATCH     PTCNPRS2,PTCNPRS4       * match report codes 2 & 4
          GOTO      KHP0230D IF EQUAL
.
          MATCH     PTCNPR3A,PTCNPRS4       * match report codes 3 & 4
          GOTO      KHP0230D IF EQUAL                                  *I-53150
.
          MATCH     PTCNPRS4,PTCNPRS5       * match report codes 4 & 5
          GOTO      KHP0230D IF EQUAL
.
          MATCH     PTCNPRS4,PTCNPRS6       * match report codes 4 & 6
          GOTO      KHP0230D IF EQUAL                                  *I-53150
.
          LOAD      PRSREP4,FORM2,PRSDESC1,PRSDESC2,PRSDESC3,PRSDESC4: *I-53150
                                  PRSDESC5,PRSDESC6,SP30,SP30:         *I-42453
                                  SP30,SP30,SP30,SP30:                 *I-42453
                                  PRSDES13                             *I-42453
          GOTO      KHP0230E
.
KHP0230D  DISPLAY   *P1:24,*EL,*B:
                    "You Cannot Use the Same Report Code Twice.  ";
          CALL      HITENTER
          GOTO      KHP0230A
.
KHP0230E  MOVE      ZERO,OVRCD
          CALL      PUTSCR00                * Restore the previous screen
          DISPLAY   *P50:16,*EL,*V2LON,PTCNPRS4,*P54:16,*HOFF,PRSREP4;
          GOTO      KHP0240                                            *I-42453
.         GOTO      UPHOS22
+
.******************************************************************************
.         keyin date range for 4th PRS2 report code - PTCNRNG4
.******************************************************************************
KHP0240   MOVE      TEN7,CVERT
          MOVE      SP12,PTCNRNG4
.
KHP0240A  MOVE      FIFTY,CCOL
          MOVE      SP2,CMON
          MOVE      SP2,CYEAR
          MOVE      SP2,CCENT
          DISPLAY   *P50:17,*EL;
.
          MATCH     "13",PTCNPRS4                                      *I-42453
          IF        @EQUAL
            DISPLAY   *P1:17,*V2LON,"14",*HOFF:
                      ". PRS2 4th report request date               :":
                      *P1:24,*EL,"Enter request date: DDMMCCYY"
          ELSE
            MATCH     "03",PTCNPRS4                                    *I-53150
            IF        @EQUAL
              DISPLAY   *P1:17,*V2LON,"14",*HOFF:
                        ". PRS2 4th report request date               :":
                        *P1:24,*EL,"Enter request date: DDMMCCYY"
            ELSE
              DISPLAY   *P1:17,*V2LON,"14",*HOFF:
                        ". PRS2 4th report request date range         :":
                        *P1:24,*EL,"Enter request date range: MMCCYY to MMCCYY"
            ENDIF
          ENDIF
.
.         MATCH     "13",PTCNPRS4                                      *I-42453
.         GOTO      KHP024BA IF NOT EQUAL                              *I-42453
.                                                                      *I-42453
          MATCH     "13",PTCNPRS4
          IF        !@EQUAL
            MATCH     "03",PTCNPRS4                                    *I-53150
            GOTO      KHP024BA IF NOT EQUAL
          ENDIF
.
          UNPACK    SP20,CYEAR,CMON,CDAY                               *I-42453
          CALL      KEYDATE                                            *I-42453
          GOTO      KHP0240E                                           *I-42453
.
KHP024BA  CALL      KEYMONTH                * keyin the month
          BRANCH    OVRCD,KHP0240F
.
          PACK      PRSDAT6A,CCENT,CYEAR,CMON
          MOVE      PRSDAT6A,DIM6
.
          CALL      CURR0000                * check against current date
          BRANCH    EXIT,KHP0240A
          DISPLAY   *P57:17," to ";
          MOVE      SIXTY1,CCOL
.
KHP0240B  MOVE      SP2,CMON
          MOVE      SP2,CYEAR
          MOVE      SP2,CCENT
.
          CALL      KEYMONTH                * keyin the month
          BRANCH    OVRCD,KHP0240A
.
          PACK      PRSDAT6B,CCENT,CYEAR,CMON
          MOVE      PRSDAT6B,DIM6
.
          CALL      CURR0000                * check against current date
          BRANCH    EXIT,KHP0240B
.
          MATCH     PRSDAT6A,PRSDAT6B
          GOTO      KHP0240D IF LESS
.
          CALL      CHCK0000                * check the date range
          BRANCH    EXIT,KHP0240C
          UNPACK    PRSDAT6A,CCENT,CYEAR,CMON
          UNPACK    PRSDAT6B,XCENT,XYEAR,XMON
          PACK      PTCNRNG4,CCENT,CYEAR,CMON,XCENT,XYEAR,XMON
          GOTO      KHP0240F
.
KHP0240C  DISPLAY   *P1:24,*EL,*B:
                    "Date Range Cannot Exceed 2 Years. ";
          CALL      HITENTER
          GOTO      KHP0240B
.
.           invalid date range entered
.
KHP0240D  DISPLAY   *P1:24,*EL,*B,"Invalid Date Range. ";
          CALL      HITENTER
          GOTO      KHP0240B
.
KHP0240E  PACK      PTCNRNG4,CCENT,CYEAR,CMON,CDAY,SP4                 *I-42453
          GOTO      KHP0240F
.
KHP0240F  MOVE      ZERO,OVRCD
          GOTO      UPHOS22
+
.******************************************************************************
.         PRS/2 Report Code for 5th Request - PTCNPRS5
.******************************************************************************
KHP0250   MOVE      "1",HLEF
          MOVE      "21",HTOP
          MOVE      "80",HRIG
          MOVE      "24",HBOT
          CALL      GETSCR00                * Save the current screen
KHP0250A  DISPLAY   *P1:21,*EF,"________________________________________":
                               "________________________________________":
                    *P1:22,*EF,*V2LON,"0",*HOFF," = No Report, ":
                               *V2LON,"1",*HOFF," = Diagnosis Outstanding, ":
                               *V2LON,"2",*HOFF," = Nil-value DRG":
                               *V2LON,"3",*HOFF," = Census Report":    *I-53150
                    *P1:23,*EL,*V2LON,"4",*HOFF," = Sub Acute Outstanding, ":
                               *V2LON,"5",*HOFF," = Hospital in the Home, ":
                               *V2LON,"6",*HOFF," = DRG-Based Simple Index, ":
                    *P1:24,*EL,*V2LON,"13",*HOFF," = Hospital Active & WIES":
                    *P50:18,*EL,UNDLN2;
          MOVE      SP2,PTCNPRS5
          MOVE      SP30,PRSREP5
          MOVE      ZERO,FORM2
          KEYIN     *P50:18,*V2LON,*RV,FORM2;
.
          COMPARE   ZERO,FORM2              * see if no code entered
          GOTO      KHP0250E IF EQUAL
.
          BRANCH    FORM2,KHP0250C,KHP0250C,KHP0250C,KHP0250C,KHP0250C: *C-52150
                          KHP0250C,KHP0250B,KHP0250B,KHP0250B,KHP0250B:
                          KHP0250B,KHP0250B,KHP0250C                   *I-42453
.
.
KHP0250B  BEEP                              * invalid code
          GOTO      KHP0250A
.
KHP0250C  MOVE      FORM2,PTCNPRS5
          REP       " 0",PTCNPRS5
.
          MATCH     PTCNPRS1,PTCNPRS5       * match report codes 1 & 5
          GOTO      KHP0250D IF EQUAL
.
          MATCH     PTCNPRS2,PTCNPRS5       * match report codes 2 & 5
          GOTO      KHP0250D IF EQUAL
.
          MATCH     PTCNPR3A,PTCNPRS5       * match report codes 3 & 5
          GOTO      KHP0250D IF EQUAL                                  *I-53150
.
          MATCH     PTCNPRS4,PTCNPRS5       * match report codes 4 & 5
          GOTO      KHP0250D IF EQUAL
.
          MATCH     PTCNPRS6,PTCNPRS5       * match report codes 5 & 6
          GOTO      KHP0250D IF EQUAL                                  *I-53150
.
          LOAD      PRSREP5,FORM2,PRSDESC1,PRSDESC2,PRSDESC3,PRSDESC4: *C-53150
                                  PRSDESC5,PRSDESC6,SP30,SP30:         *I-42453
                                  SP30,SP30,SP30,SP30:                 *I-42453
                                  PRSDES13                             *I-42453
          GOTO      KHP0250E
.
KHP0250D  DISPLAY   *P1:24,*EL,*B:
                    "You Cannot Use the Same Report Code Twice.  ";
          CALL      HITENTER
          GOTO      KHP0250A
.
KHP0250E  MOVE      ZERO,OVRCD
          CALL      PUTSCR00                * Restore the previous screen
          DISPLAY   *P50:18,*EL,*V2LON,PTCNPRS5,*P54:18,*HOFF,PRSREP5;
          GOTO      KHP0260                                            *I-42453
.         GOTO      UPHOS22
+
.*****************************************************************************
.*        keyin date range for 5th PRS2 report code - PTCNRNG5
.*****************************************************************************
KHP0260   MOVE      TEN9,CVERT
          MOVE      SP12,PTCNRNG5
.
KHP0260A  MOVE      FIFTY,CCOL
          MOVE      SP2,CMON
          MOVE      SP2,CYEAR
          MOVE      SP2,CCENT
          DISPLAY   *P50:19,*EL;
.
          MATCH     "13",PTCNPRS5                                      *I-42453
          IF        @EQUAL
            DISPLAY   *P1:19,*V2LON,"16",*HOFF:
                      ". PRS2 5th report request date               :":
                      *P1:24,*EL,"Enter request date: DDMMCCYY"
          ELSE
            MATCH     "03",PTCNPRS5                                    *I-53150
            IF        @EQUAL
              DISPLAY   *P1:19,*V2LON,"16",*HOFF:
                        ". PRS2 5th report request date               :":
                        *P1:24,*EL,"Enter request date: DDMMCCYY"
            ELSE
              DISPLAY   *P1:19,*V2LON,"16",*HOFF:
                        ". PRS2 5th report request date range         :":
                        *P1:24,*EL,"Enter request date range: MMCCYY to MMCCYY"
            ENDIF
          ENDIF
.
.         MATCH     "13",PTCNPRS5                                      *I-42453
.         GOTO      KHP026BA IF NOT EQUAL                              *I-42453
.                                                                      *I-42453
          MATCH     "13",PTCNPRS5
          IF        !@EQUAL
            MATCH     "03",PTCNPRS5                                    *I-53150
            GOTO      KHP026BA IF NOT EQUAL
          ENDIF
.
          UNPACK    SP20,CYEAR,CMON,CDAY                               *I-42453
          CALL      KEYDATE                                            *I-42453
          GOTO      KHP0260E                                           *I-42453
.
KHP026BA  CALL      KEYMONTH                * keyin the month
          BRANCH    OVRCD,KHP0260F
          PACK      PRSDAT6A,CCENT,CYEAR,CMON
          MOVE      PRSDAT6A,DIM6
.
          CALL      CURR0000                * check against current date
          BRANCH    EXIT,KHP0260A
          DISPLAY   *P57:19," to ";
          MOVE      SIXTY1,CCOL
.
KHP0260B  MOVE      SP2,CMON
          MOVE      SP2,CYEAR
          MOVE      SP2,CCENT
.
          CALL      KEYMONTH                * keyin the month
          BRANCH    OVRCD,KHP0260A
          PACK      PRSDAT6B,CCENT,CYEAR,CMON
          MOVE      PRSDAT6B,DIM6
.
          CALL      CURR0000                * check against current date
          BRANCH    EXIT,KHP0260B
.
          MATCH     PRSDAT6A,PRSDAT6B
          GOTO      KHP0260D IF LESS
.
          CALL      CHCK0000                * check the date range
          BRANCH    EXIT,KHP0260C
          UNPACK    PRSDAT6A,CCENT,CYEAR,CMON
          UNPACK    PRSDAT6B,XCENT,XYEAR,XMON
          PACK      PTCNRNG5,CCENT,CYEAR,CMON,XCENT,XYEAR,XMON
          GOTO      KHP0260F
.
KHP0260C  DISPLAY   *P1:24,*EL,*B:
                    "Date Range Cannot Exceed 2 Years. ";
          CALL      HITENTER
          GOTO      KHP0260B
.
.           invalid date range entered
.
KHP0260D  DISPLAY   *P1:24,*EL,*B,"Invalid Date Range. ";
          CALL      HITENTER
          GOTO      KHP0260B
.
KHP0260E  PACK      PTCNRNG5,CCENT,CYEAR,CMON,CDAY,SP4                 *I-42453
          GOTO      KHP0260F
.
KHP0260F  MOVE      ZERO,OVRCD
          GOTO      UPHOS22
.
.******************************************************************************
.*        Sending Reason for critical care transfer                           *
.******************************************************************************
KHP0270   MOVE      "50",CCOL
          MOVE      "20",CVERT
          CALL      KYND0000                * Keyin yes/no
          MOVE      EXIT,PTCNPRCC
          MOVE      ZERO,OVRCD
          GOTO      UPHOS22
.
.******************************************************************************
.*      Which UDF for Aged Care Assessment Service                            *
.******************************************************************************
.
KHP0280   DISPLAY   *P1:24,*EL,*V2LON,"1-5",*HOFF," Discharge User Defined ":
                    "Fields 1-5, ",*V2LON,"6-7",*HOFF," Admission User ":
                    "Defined Fields 6-7";
          MOVE      "50",CCOL
          MOVE      "21",CVERT
.
KHP02801  MOVE      PTCNACAS,FORM1
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,FORM1;
.
          IF        FORM1<1 | FORM1>7
            BEEP
            GOTO      KHP02801
          ENDIF
.
          MOVE      FORM1,PTCNACAS
          PACK      TDESC,SP20
          IF        PTCNACAS>0 & PTCNACAS<6
            PACK      KEY5,ANSD,PTCNACAS,SP3
          ELSE
            PACK      KEY5,ANSU,PTCNACAS,SP3
          ENDIF
          CALL      RDCODE1                 * Read a codes file record
          PACK      ACASDESC,TDESC,SP20
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNACAS,*P57:CVERT,*HOFF,ACASDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS22
+
.***********************************************************************
.*  UPHOS23   :  Hospital Controlled State based PMI screen keyin         
.***********************************************************************
UPHOS23   MOVE      FALSE,EXIT
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      UPSB9999 IF EQUAL
          GOTO      UPSB9000 IF LESS

          MOVE      SP4,KEYSEC
          BRANCH    CCITEM,UPSB0100:
                           UPSB0200:
                           UPSB0300:
                           UPSB0400:
                           UPSB0500:
                           UPSB0600 
.
          BEEP
          GOTO      UPHOS23 
.
UPSB0100  MOVE      PTCNTORG,KEYSEC
          KEYIN     *P59:4,*V2LON,*RV,KEYSEC:
                    *P59:4,*DV,KEYSEC; 
          RESET     KEYSEC
          MATCH     SP4,KEYSEC
          IF        @EQUAL
            MOVE     "0",KEYSEC 
          ENDIF
          TYPE      KEYSEC  
          GOTO      UPSB0150 IF NOT EQUAL

          MOVE      KEYSEC,PTCNTORG
          DISPLAY   *P59:4,*V2LON,PTCNTORG
          GOTO      UPHOS23 
.
UPSB0150  BEEP
          GOTO      UPSB0100
.
UPSB0200  MOVE      PTCNTOSX,KEYSEC
          KEYIN     *P59:5,*V2LON,*RV,KEYSEC:
                    *P59:5,*DV,KEYSEC; 
          RESET     KEYSEC
          MATCH     SP4,KEYSEC
          IF        @EQUAL
            MOVE     "0",KEYSEC 
          ENDIF
          TYPE      KEYSEC  
          GOTO      UPSB0250 IF NOT EQUAL

          MOVE      KEYSEC,PTCNTOSX
          DISPLAY   *P59:5,*V2LON,PTCNTOSX
          GOTO      UPHOS23 
.
UPSB0250  BEEP
          GOTO      UPSB0200
.
UPSB0300  MOVE      PTCNTOPQ,KEYSEC
          KEYIN     *P59:6,*V2LON,*RV,KEYSEC:
                    *P59:6,*DV,KEYSEC; 
          RESET     KEYSEC
          MATCH     SP4,KEYSEC
          IF        @EQUAL
            MOVE     "0",KEYSEC 
          ENDIF
          TYPE      KEYSEC  
          GOTO      UPSB0350 IF NOT EQUAL

          MOVE      KEYSEC,PTCNTOPQ
          DISPLAY   *P59:6,*V2LON,PTCNTOPQ
          GOTO      UPHOS23 
.
UPSB0350  BEEP
          GOTO      UPSB0300
.
UPSB0400  MOVE      PTCNTOAP,KEYSEC
          KEYIN     *P59:7,*V2LON,*RV,KEYSEC:
                    *P59:7,*DV,KEYSEC; 
          RESET     KEYSEC
          MATCH     SP4,KEYSEC
          IF        @EQUAL
            MOVE     "0",KEYSEC 
          ENDIF
          TYPE      KEYSEC  
          GOTO      UPSB0450 IF NOT EQUAL

          MOVE      KEYSEC,PTCNTOAP
          DISPLAY   *P59:7,*V2LON,PTCNTOAP
          GOTO      UPHOS23 
.
UPSB0450  BEEP
          GOTO      UPSB0400
.
UPSB0500  MOVE      PTCNTOUP,KEYSEC
          KEYIN     *P59:8,*V2LON,*RV,KEYSEC:
                    *P59:8,*DV,KEYSEC; 
          RESET     KEYSEC
          MATCH     SP4,KEYSEC
          IF        @EQUAL
            MOVE     "0",KEYSEC 
          ENDIF
          TYPE      KEYSEC  
          GOTO      UPSB0550 IF NOT EQUAL

          MOVE      KEYSEC,PTCNTOUP
          DISPLAY   *P59:8,*V2LON,PTCNTOUP
          GOTO      UPHOS23 
.
UPSB0550  BEEP
          GOTO      UPSB0500
.
UPSB0600  MOVE      PTCNTOMP,KEYSEC
          KEYIN     *P59:9,*V2LON,*RV,KEYSEC:
                    *P59:9,*DV,KEYSEC; 
          RESET     KEYSEC
          MATCH     SP4,KEYSEC
          IF        @EQUAL
            MOVE     "0",KEYSEC 
          ENDIF
          TYPE      KEYSEC  
          GOTO      UPSB0650 IF NOT EQUAL

          MOVE      KEYSEC,PTCNTOMP
          DISPLAY   *P59:9,*V2LON,PTCNTOMP
          GOTO      UPHOS23 
.
UPSB0650  BEEP
          GOTO      UPSB0600
.
UPSB9000  MOVE      TRUE,EXIT
.
UPSB9999  RETURN
.          
.***********************************************************************
.*  UPHOS24   :  Hospital Controlled HDP / PHDB screen keyin
.***********************************************************************
UPHOS24   MOVE      FALSE,EXIT
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      UPHP9999 IF EQUAL
          GOTO      UPHP9000 IF LESS

          MOVE      SP4,KEYSEC
          BRANCH    CCITEM,UPHP0100:
                           UPHP0200:
                           UPHP0300
.
          BEEP
          GOTO      UPHOS24
.
. ----- WA HDP - Category for Veteran card -----
.
UPHP0100  DISPLAY   *P1:23,*EL:
                    *P1:24,*EL,"Valid values are P1... 6, U1... U9, V0, V1, DX";
          MOVE      "58",CCOL
          MOVE      "04",CVERT
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,PTCNVETR;
.
          MATCH     "DX",PTCNVETR
          GOTO      UPHP0150 IF EQUAL
.
          MOVE      ZERO,FORM1
          UNPACK    SP2,DIM1,DIM1A
          UNPACK    PTCNVETR,DIM1,DIM1A
          MOVE      DIM1A,FORM1
.
          MATCH     "U",DIM1
          IF        @EQUAL
            IF        FORM1> 0 & FORM1< 10
              GOTO      UPHP0150
            ENDIF
          ENDIF
.
          MATCH     "V",DIM1
          IF        @EQUAL
            IF        FORM1>=1 & FORM1< 3
              GOTO      UPHP0150
            ENDIF
          ENDIF
.
          MATCH     "P",DIM1
          IF        @EQUAL
            IF        FORM1> 0 & FORM1< 7
              GOTO      UPHP0150
            ENDIF
          ENDIF
.
          BEEP
          GOTO      UPHP0100
.
UPHP0150  PACK      TDESC,SP20
          PACK      KEY5,PTCNVETR,SP3
          CALL      RDCODE1                 * Read the codes file
          PACK      VETRDESC,TDESC,SP20
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNVETR,*P61:CVERT,*HOFF,VETRDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS24
.
UPHP0200  LOAD      ELPSCODE,PTCNELPS,CATU1,CATU2,CATU3,CATU4,CATU5,CATU6:
                             CATU7,CATU8,CATU9,CATV1,CATV2,CATCC,CATP:
                             CATVB                                     *I-54636
          DISPLAY   *P58:5,ELPSCODE
          DISPLAY   *P1:23,*EF,"1 = U1,2 = U2,3 = U3,4 = U4,5 = U5,6 = U6,":
                    "7 = U7,8 = U8,9 = U9":
                    *P1:24,"10 = V1,11 = V2,12 = CC,13 = P,14 = VB"    *C-54636
          KEYIN     *P58:5,PTCNELPS
          LOAD      ELPSCODE,PTCNELPS,CATU1,CATU2,CATU3,CATU4,CATU5,CATU6:
                             CATU7,CATU8,CATU9,CATV1,CATV2,CATCC,CATP:
                             CATVB                                     *I-54636
          PACK      KEY5,ELPSCODE,SP6
          CALL      RDCODE1
          PACK      ELPSDESC,TDESC,SP20
.                                                                      *C-54636
          IF        PTCNELPS<1|PTCNELPS>14|OVRCD<>0
            DISPLAY   *P1:24,"Invalid Code ";
            CALL      HITENTER
            GOTO      UPHP0200 
          ENDIF
.
          DISPLAY   *P58:5,ELPSCODE,*P61:5,*V2LON,TDESC
          DISPLAY   *P1:23,*EF
          GOTO      UPHOS24
.
UPHP0300  DISPLAY   *P1:23,*EL:
                    *P1:24,*EL,"Valid values are P1... 6, U1... U9, V0, V1 ";
          MOVE      "58",CCOL
          MOVE      "6",CVERT
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,PTCNPPAL;
.
          MOVE      ZERO,FORM1
          UNPACK    SP2,DIM1,DIM1A
          UNPACK    PTCNPPAL,DIM1,DIM1A
          MOVE      DIM1A,FORM1
.
          MATCH     "U",DIM1
          IF        @EQUAL
            IF        FORM1> 0 & FORM1< 10
              GOTO      UPHP0350
            ENDIF
          ENDIF
.
          MATCH     "V",DIM1
          IF        @EQUAL
            IF        FORM1>=1 & FORM1< 3
              GOTO      UPHP0350
            ENDIF
          ENDIF
.
          MATCH     "P",DIM1
          IF        @EQUAL
            IF        FORM1> 0 & FORM1< 7
              GOTO      UPHP0350
            ENDIF
          ENDIF
.
          BEEP
          GOTO      UPHP0300 
.
UPHP0350  PACK      TDESC,SP20
          PACK      KEY5,PTCNPPAL,SP3
          CALL      RDCODE1                 * Read the codes file
          PACK      PPALDESC,TDESC,SP20
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNPPAL,*P61:CVERT,*HOFF,PPALDESC;
          MOVE      ZERO,OVRCD
          GOTO      UPHOS24
.
UPHP9000  MOVE      TRUE,EXIT
.
UPHP9999  RETURN
.
.***********************************************************************
.*  UPHOS25   :  Hospital Controlled screen 25
.***********************************************************************
UPHOS25   MOVE      FALSE,EXIT
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS
.
          BRANCH    CCITEM,KHS25010,KHS25020,KHS25030,KHS25040,KHS25050:
                           KHS25060,KHS25070,KHS25080,KHS25090,KHS25100:
                           KHS25110,KHS25120,KHS25130,UPHOS25,KHS25150:*C-48227
                           KHS25160
.                                                                      *I-39616
          BEEP
          GOTO      UPHOS25
.
.---      Using interim Health Fund CLaim Forms? (Y/N)
.
KHS25010  MOVE      "58",CCOL                * column for keyin
          MOVE      "04",CVERT               * row for keyin
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNUICF            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS25
.
.---      Using 'Banking has started...proceed?' messege
.
KHS25020  MOVE      "58",CCOL                * column for keyin
          MOVE      "05",CVERT               * row for keyin
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNUBNK            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS25
.
.---      Write Invoice Layout 6 to a Text File ?
.
KHS25030  MOVE      "58",CCOL                * column for keyin
          MOVE      "06",CVERT               * row for keyin
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNITXT            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS25
.
.---      Print Messages on original invoice ? 
.
KHS25040  MOVE      "58",CCOL                * column for keyin
          MOVE      "07",CVERT               * row for keyin
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNPCOM            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS25
.
.---      Printing with a laser printer ? 
.
KHS25050  MOVE      "58",CCOL                * column for keyin
          MOVE      "08",CVERT               * row for keyin
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNLASR            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS25
.
.---      Number of blank lines at the start of the invoice
.
KHS25060  IF        PTCNLASR=0
            BEEP
            GOTO      UPHOS25
          ENDIF
          KEYIN     *P58:9,*EL,*V2LON,PTCNBLSI
          IF        PTCNBLSI>=31 | PTCNBLSI<0
            DISPLAY   *P1:24,*EL,*B,"Must not be less than 0, or greater ":
                      "than 30."
            GOTO      KHS25060
          ENDIF
          DISPLAY   *P58:9,*EL,*V2LON,PTCNBLSI,*P1:24,*EL
          GOTO      UPHOS25
.
.---      Number of extra lines in the body of the invoice
.
KHS25070  IF        PTCNLASR=0
            BEEP
            GOTO      UPHOS25
          ENDIF
          KEYIN     *P58:10,*EL,*V2LON,PTCNXLBI
          IF        PTCNXLBI>=31
            DISPLAY   *P1:24,*EL,*B,"Must not be greater than 30."
            GOTO       KHS25070
          ENDIF
          DISPLAY   *P58:10,*EL,*V2LON,PTCNXLBI,*P1:24,*EL
          GOTO      UPHOS25
.
.---      Print journal code on invoice ?
.
KHS25080  MOVE      "58",CCOL                * column for keyin
          MOVE      "11",CVERT               * row for keyin
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNPJCI            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS25
.
.---      Print front end deductions ?
.
KHS25090  MOVE      "58",CCOL                * column for keyin
          MOVE      "12",CVERT               * row for keyin
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNPFED            * set parameter
          MOVE      ZERO,OVRCD
          GOTO      UPHOS25
.
.---      Default claim code from all visits or inpatients only
.
KHS25100  MOVE      "58",CCOL                * column for keyin
          MOVE      "13",CVERT               * row for keyin
.
KHS25101  DISPLAY   *P1:24,*EL,*V2LON,ANSA,*HOFF," = From All Visits, ":
                               *V2LON,ANSI,*HOFF," = From Inpat Visits only, ":
                               *V2LON,ANSN,*HOFF," = No Default"
.
          KEYIN     *PCCOL:CVERT,*DV,SP20:   * clear previous display
                    *PCCOL:CVERT,*DV,UNDLN1:
                    *PCCOL:CVERT,*V2LON,ANS:
                    *PCCOL:CVERT,*DV,ANS;
.
          TYPE      ANS                      * check if a number was input
          GOTO      KHS25108 IF EQUAL        * yes, invalid
.
          MATCH     ANSA,ANS
          GOTO      KHS25102 IF NOT EQUAL
          MOVE      "All Visits",KEY10
          MOVE      ANSA,PTCNLCLM
          GOTO      KHS25107
.
KHS25102  MATCH     ANSI,ANS
          GOTO      KHS25103 IF NOT EQUAL    * C-58447
          MOVE      "Inpat.Only",KEY10
          MOVE      ANSI,PTCNLCLM
          GOTO      KHS25107
.
KHS25103  MATCH     ANSN,ANS
          GOTO      KHS25108 IF NOT EQUAL
          MOVE      "No Default",KEY10
          MOVE      ANSN,PTCNLCLM
          GOTO      KHS25107
.
KHS25107  DISPLAY   *PCCOL:CVERT,*V2LON,KEY10
          GOTO      KHS25109
.
KHS25108  BEEP
          GOTO      KHS25101
.
KHS25109  MOVE      ZERO,OVRCD
          GOTO      UPHOS25
.
.         Default Miscellaneous Charges Code for Pharmacy Interface
.
KHS25110  KEYIN     *P58:14,*EL,*V2LON,*RV,PTCNDMCC
          PACK      PTCNDMCC,PTCNDMCC,SP9
          GOTO      UPHOS25
.
. ----- Default Journal Code for Pharmacy Interface ----
.
KHS25120  MOVE      "58",ECOL
          MOVE      "15",EVERT
          PACK      CODE,ANSJ,SP1
          MOVE      PTCNDMJC,CKYIDEF3
          MOVE      ZERO,CKYIMAND
          CALL      PATCODKY
          BRANCH    EXIT,KHS25121,UPHOS25
.
          MOVE      ACODE,PTCNDMJC
          MOVE      TDESC,JOURDESC
          GOTO      KHS25122
.
KHS25121  PACK      PTCNDMJC,SP3
          PACK      JOURDESC,SP30
.
KHS25122  DISPLAY   *P58:15,*V2LON,PTCNDMJC,*P63:15,*HOFF,JOURDESC;
          GOTO      UPHOS25
.
.        Bill more that 6 items - default is 0 - yes                   *I-47385
.                                                                      *I-47385
KHS25130  MOVE      "58",CCOL                * column for keyin        *I-47385
          MOVE      "16",CVERT               * row for keyin           *I-47385
          CALL      KYN0000                  * keyin Y (1) or N (0)    *I-47385
          BRANCH    EXIT,KHS25131            * We want Y(0) or N(1)    *I-47385
.                                                                      *I-47385
          MOVE      ZERO,OVRCD                                         *I-47385
          MOVE      ONE,PTCNMBSF                                       *I-47385
          GOTO      UPHOS25                                            *I-47385
.                                                                      *I-47385
KHS25131  MOVE      ZERO,PTCNMBSF                                      *I-47385
          GOTO      UPHOS25                                            *I-47385
.
.        BPAY Hospital Identifier                                      *I-48227
.
KHS25140  KEYIN     *P58:17,*EL,*V2LON,*DE,*JR,PTCNHBID
          IF        @EOS
            MOVE      SP3,PTCNHBID
          ELSE
.>>>>       REP       " 0",PTCNHBID
          ENDIF
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS25                                       * end I-48227
.
..... I CAR 39616
KHS25150  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = Exp.Post Op Ward, ":
                               *V2LON,ONE,*HOFF," = Expected Ward"
          KEYIN     *P50:24,*EL,*V2LON,*DV,PTCNDWAW:
                    *P50:24,*EL,*V2LON,*RV,PTCNDWAW:
                    *P50:24,*DV,PTCNDWAW
.
          IF        PTCNDWAW < 0 | PTCNDWAW > 1
            BEEP
            GOTO      KHS25150
          ENDIF
          MOVE      DWAWDES0,DIM16
          LOAD      DIM16,PTCNDWAW,DWAWDES1
          DISPLAY   *P58:18,DIM16
          MOVE      ZERO,OVRCD
          GOTO      UPHOS25
.... end I CAR 39616
KHS25160  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = From EOC Details, ":
                               *V2LON,ONE,*HOFF," = From ACC Details"
          KEYIN     *P50:24,*EL,*V2LON,*DV,PTCNACCD:
                    *P50:24,*EL,*V2LON,*RV,PTCNACCD:
                    *P50:24,*DV,PTCNACCD
.
          IF        PTCNACCD < 0 | PTCNACCD > 1
            BEEP
            GOTO      KHS25160
          ENDIF
          MOVE      EOCACCD0,DEOCACC
          LOAD      DEOCACC,PTCNACCD,EOCACCD1
          DISPLAY   *P58:19,DEOCACC
          MOVE      ZERO,OVRCD
          GOTO      UPHOS25
+
.***********************************************************************
.*  UPHOS26   :  Hospital Controlled EDI screen 26
.***********************************************************************
.
UPHOS26   MOVE      FALSE,EXIT
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS
.
          BRANCH    CCITEM,KHS26010:             * Keyin EDI Extract Out Path
                           KHS26020:             * Keyin EDI Hospital Code
                           KHS26030:             * Keyin EDI Originator
                           KHS26040:             * Keyin EDI Critical Care Src.
                           KHS26050              * Keyin EDI Mother/Baby Reln.
          BEEP
          GOTO      UPHOS26
.
.
KHS26010  KEYIN     *P33:4,*EL,*V2LON,PTCNEDIO
          ENDSET    PTCNEDIO                     * Position at end of PTCNEDIO
          MOVEFPTR  PTCNEDIO,POS                 * Save last position
          IF        POS > ZERO & POS < SIXTY
            SCAN      "/",PTCNEDIO
            IF        !@EQUAL
              APPEND  "/",PTCNEDIO               * Append a '/'
            ENDIF
            RESET   PTCNEDIO                     * Reset form pointer
            DISPLAY *P33:4,*EL,*V2LON,PTCNEDIO
          ENDIF
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS26
.
KHS26020  KEYIN     *P33:5,*EL,*V2LON,PTCNEDIH
          SQUEEZE   PTCNEDIH                     * Remove all spaces
          ENDSET    PTCNEDIH                     * Position at end PTCNEDIH
          MOVEFPTR  PTCNEDIH,POS                 * Save last position
          RESET     PTCNEDIH                     * Reset form pointer
.
          COMPARE   POS,TWO                      * 2 characters keyin?
          GOTO      KHS26020 IF NOT EQUAL        * No.
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS26
.
KHS26030  KEYIN     *P33:6,*EL,*V2LON,PTCNORIG
.
          MOVE      ZERO,OVRCD
          GOTO      UPHOS26
.
KHS26040  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF,"= Admission Type, ":
                    *V2LON,ONE,*HOFF,"= Bed Type"
          KEYIN     *P33:7,*EL,*V2LON,*DE,PTCNHCCC
.
          IF        PTCNHCCC < 0 | PTCNHCCC > 1
            BEEP
            GOTO      KHS26040
          ENDIF
.
          IF        PTCNHCCC = 0
            DISPLAY   *P40:7,"Admission Type",*P1:24,*EL;
          ELSE
            DISPLAY   *P40:7,"Bed Type",*P1:24,*EL;
          ENDIF
          MOVE      ZERO,OVRCD
          GOTO      UPHOS26
.
KHS26050  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF,"= Unqualified Status, ":
                    *V2LON,ONE,*HOFF,"= Baby's Date of Birth"
          KEYIN     *P33:8,*EL,*V2LON,*DE,PTCNMBRL
.
          IF        PTCNMBRL < 0 | PTCNMBRL > 1
            BEEP
            GOTO      KHS26050
          ENDIF
.
          IF        PTCNMBRL = 0
            DISPLAY   *P40:8,"Unqualified Status",*P1:24,*EL;
          ELSE
            DISPLAY   *P40:8,"Baby's Date of Birth",*P1:24,*EL;
          ENDIF
          MOVE      ZERO,OVRCD
          GOTO      UPHOS26
+
.-----------------------------------------------------------------------
.                    HOSPITAL PRS/2 SCREEN 02                           *I-49016
.-----------------------------------------------------------------------
UPHOS27   CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      POST IF EQUAL
          GOTO      CANC IF LESS
.
          BRANCH    CCITEM,KHP0285,KHP0290,KHP0300,KHP0310
.
          BEEP
          GOTO      UPHOS27
.
+
.----------------------------------------------------------------------
.  REPORTING TYPE FOR TRANSMISSION CONTROL AND RECONCILIATION REPORT    *I-49016
.----------------------------------------------------------------------
KHP0285   KEYIN     *P50:4,*V2LON,PTCNRTCN
.
          MATCH     ANSE,PTCNRTCN
          IF        @EQUAL
            MOVE      PRS2DSC1,PRS2DSC0                * Electronic Only
          ELSE
            MATCH     ANSB,PTCNRTCN
            IF        @EQUAL
              MOVE      PRS2DSC3,PRS2DSC0              * Electronic and Paper
            ELSE
              MOVE      ANSP,PTCNRTCN
              MOVE      PRS2DSC2,PRS2DSC0              * Paper Only (Default)
            ENDIF
          ENDIF
.
          DISPLAY   *P50:4,*V2LON,PTCNRTCN,*HOFF,*P54:4,PRS2DSC0
.
          GOTO      UPHOS27
+
.----------------------------------------------------------------------
.                 REPORTING TYPE FOR REQUEST REPORTS                    *I-49016
.----------------------------------------------------------------------
KHP0290   KEYIN     *P50:5,*V2LON,PTCNRTRQ
.
          MATCH     ANSE,PTCNRTRQ
          IF        @EQUAL
            MOVE      PRS2DSC1,PRS2DSC4                * Electronic Only
          ELSE
            MATCH     ANSB,PTCNRTRQ
            IF        @EQUAL
              MOVE      PRS2DSC3,PRS2DSC4              * Electronic and Paper
            ELSE
              MOVE      ANSP,PTCNRTRQ
              MOVE      PRS2DSC2,PRS2DSC4              * Paper Only (Default)
            ENDIF
          ENDIF
.
          DISPLAY   *P50:5,*V2LON,PTCNRTRQ,*HOFF,*P54:5,PRS2DSC4
.
          GOTO      UPHOS27
+
.----------------------------------------------------------------------
.             PRS/2 REPORT CODE FOR 6TH REQUEST - PTCNPRS6              *I-49016
.----------------------------------------------------------------------
KHP0300   MOVE      "1",HLEF
          MOVE      "22",HTOP
          MOVE      "80",HRIG
          MOVE      "24",HBOT
          CALL      GETSCR00                * Save the current screen
KHP0300A  DISPLAY   *P1:22,*EF,*V2LON,"0",*HOFF," = No Report, ":
                               *V2LON,"1",*HOFF," = Diagnosis Outstanding, ":
                               *V2LON,"2",*HOFF," = Nil-value DRG":
                               *V2LON,"3",*HOFF," = Census Report":    *I-53150
                    *P1:23,*EL,*V2LON,"4",*HOFF," = Sub Acute Outstanding, ":
                               *V2LON,"5",*HOFF," = Hospital in the Home, ":
                               *V2LON,"6",*HOFF," = DRG-Based Simple Index, ":
                    *P1:24,*EL,*V2LON,"13",*HOFF," = Hospital Active & WIES":
                    *P50:6,*EL,UNDLN2;
          MOVE      SP2,PTCNPRS6
          MOVE      SP30,PRSREP6
          MOVE      ZERO,FORM2
          KEYIN     *P50:6,*V2LON,*RV,FORM2;
.
          COMPARE   ZERO,FORM2              * see if no code entered
          GOTO      KHP0300E IF EQUAL
.
          BRANCH    FORM2,KHP0300C,KHP0300C,KHP0300C,KHP0300C,KHP0300C: *C-53150
                          KHP0300C,KHP0300B,KHP0300B,KHP0300B,KHP0300B:
                          KHP0300B,KHP0300B,KHP0300C                   *I-42453
.
KHP0300B  BEEP                              * invalid code
          GOTO      KHP0300A
.
KHP0300C  MOVE      FORM2,PTCNPRS6
          REP       " 0",PTCNPRS6
.
          MATCH     PTCNPRS1,PTCNPRS6       * match report codes 1 & 6
          GOTO      KHP0300D IF EQUAL
.
          MATCH     PTCNPRS2,PTCNPRS6       * match report codes 2 & 6
          GOTO      KHP0300D IF EQUAL
.
          MATCH     PTCNPR3A,PTCNPRS6       * match report codes 3 & 6
          GOTO      KHP0300D IF EQUAL                                  *I-53150
.
          MATCH     PTCNPRS4,PTCNPRS6       * match report codes 4 & 6
          GOTO      KHP0300D IF EQUAL
.
          MATCH     PTCNPRS5,PTCNPRS6       * match report codes 5 & 6
          GOTO      KHP0300D IF EQUAL
.
          LOAD      PRSREP6,FORM2,PRSDESC1,PRSDESC2,PRSDESC3,PRSDESC4: *C-53150
                                  PRSDESC5,PRSDESC6,SP30,SP30:         *I-42453
                                  SP30,SP30,SP30,SP30:                 *I-42453
                                  PRSDES13                             *I-42453
          GOTO      KHP0300E
.
KHP0300D  DISPLAY   *P1:24,*EL,*B:
                    "You Cannot Use the Same Report Code Twice.  ";
          CALL      HITENTER
          GOTO      KHP0300A
.
KHP0300E  MOVE      ZERO,OVRCD
          CALL      PUTSCR00                * Restore the previous screen
          DISPLAY   *P50:6,*EL,*V2LON,PTCNPRS6,*P54:6,*HOFF,PRSREP6;
          GOTO      KHP0310
+
.----------------------------------------------------------------------
.         KEYIN DATE RANGE FOR 6TH PRS2 REPORT CODE - PTCNRNG6          *I-49016
.----------------------------------------------------------------------
KHP0310   MOVE      SEVEN,CVERT
          MOVE      SP20,PTCNRNG6
.
KHP0310A  MOVE      FIVE0,CCOL
          MOVE      SP2,CMON
          MOVE      CCC,CCENT
          MOVE      SP2,CYEAR
          DISPLAY   *P50:7,*EL;
.
          MATCH     "13",PTCNPRS6                                      *I-42453
          IF        @EQUAL
            DISPLAY   *P2:7,*V2LON,"4",*HOFF:
                      ". PRS2 6th report request date               :":
                      *P1:24,*EL,"Enter request date: DDMMCCYY"
          ELSE
            MATCH     "03",PTCNPRS6                                    *I-53150
            IF        @EQUAL
              DISPLAY   *P2:7,*V2LON,"4",*HOFF:
                        ". PRS2 6th report request date               :":
                        *P1:24,*EL,"Enter request date: DDMMCCYY"
            ELSE
              DISPLAY   *P2:7,*V2LON,"4",*HOFF:
                        ". PRS2 6th report request date range         :":
                        *P1:24,*EL,"Enter request date range: MMCCYY to MMCCYY"
            ENDIF
          ENDIF
.
.         MATCH     "13",PTCNPRS6                                      *I-42453
.         GOTO      KHP031BA IF NOT EQUAL                              *I-42453
.                                                                      *I-42453
          MATCH     "13",PTCNPRS6
          IF        !@EQUAL
            MATCH     "03",PTCNPRS6                                    *I-53150
            GOTO      KHP031BA IF NOT EQUAL
          ENDIF
.
          UNPACK    SP20,CYEAR,CMON,CDAY                               *I-42453
          CALL      KEYDATE                                            *I-42453
          GOTO      KHP0310E                                           *I-42453
.
KHP031BA  CALL      KEYMONTH                * keyin the month
          BRANCH    OVRCD,KHP0310F
          PACK      PRSDAT6A,CCENT,CYEAR,CMON
          MOVE      PRSDAT6A,DIM6
.
          CALL      CURR0000                * check against current date
          BRANCH    EXIT,KHP0310A
          DISPLAY   *P57:7," to ";
          MOVE      SIXTY1,CCOL
.
KHP0310B  MOVE      SP2,CMON
          MOVE      CCC,CCENT
          MOVE      SP2,CYEAR
.
          CALL      KEYMONTH                * keyin the month
          BRANCH    OVRCD,KHP0310A
          PACK      PRSDAT6B,CCENT,CYEAR,CMON
          MOVE      PRSDAT6B,DIM6
.
          CALL      CURR0000                * check against current date
          BRANCH    EXIT,KHP0310B
.
          MATCH     PRSDAT6A,PRSDAT6B
          GOTO      KHP0310D IF LESS
.
          CALL      CHCK0000                * check the date range
          BRANCH    EXIT,KHP0310C
          UNPACK    PRSDAT6A,CCENT,CYEAR,CMON
          UNPACK    PRSDAT6B,XCENT,XYEAR,XMON
          PACK      PTCNRNG6,CCENT,CYEAR,CMON,XCENT,XYEAR,XMON
          GOTO      KHP0310F
.
KHP0310C  DISPLAY   *P1:24,*EL,*B:
                    "Date Range Cannot Exceed 2 Years. ";
          CALL      HITENTER
          GOTO      KHP0310B
.
.           invalid date range entered
.
KHP0310D  DISPLAY   *P1:24,*EL,*B,"Invalid Date Range. ";
          CALL      HITENTER
          GOTO      KHP0310B
.
KHP0310E  PACK      PTCNRNG6,CCENT,CYEAR,CMON,CDAY,SP4                 *I-42453
          GOTO      KHP0310F
.
KHP0310F  MOVE      ZERO,OVRCD
.
          GOTO      UPHOS27
+
.***********************************************************************
.*  UPHOS28   :  Update Hospital controlled screen 28                  *I-49037
.***********************************************************************
UPHOS28   CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      KHS28900 IF EQUAL       * validate PTCNDGET before posting
          GOTO      CANC IF LESS
.
          BRANCH    CCITEM,KHS28010,KHS28020,KHS28030,KHS28040,KHS28050:
                           KHS28060,KHS28070,KHS28075,UPHOS28:
                           KHS28080,KHS28090,KHS28100,KHS28110,KHS28120:
                           KHS28130,KHS28140,UPHOS28,KHS28150         *C-267797
.
          BEEP
          GOTO      UPHOS28
.
. ----- Go live date for ICD10 Edition 1 -----                         *I-49037
.
KHS28010  MOVE      "53",CCOL
          MOVE      "4",CVERT
          MOVE      ZERO,CHIGHLT
.
          MOVE      PTCNI10D,KEY8
          CALL      GDVX0000
          BRANCH    EXIT,KHS28010
          MOVE      KEY8,PTCNI10D
.
          GOTO      UPHOS28
.
. ----- Go live date for ICD10 Edition 2 -----                         *I-49037
.
KHS28020  MOVE      "53",CCOL
          MOVE      "5",CVERT
          MOVE      ZERO,CHIGHLT
.
          MOVE      PTCNGDV2,KEY8
          CALL      GDVX0000
          BRANCH    EXIT,KHS28020
          MOVE      KEY8,PTCNGDV2
.
          GOTO      UPHOS28
.
. ----- Go live date for ICD10 Edition 3 -----                         *I-49037
.
KHS28030  MOVE      "53",CCOL
          MOVE      "6",CVERT
          MOVE      ZERO,CHIGHLT
.
          MOVE      PTCNGDV3,KEY8
          CALL      GDVX0000
          BRANCH    EXIT,KHS28030
          MOVE      KEY8,PTCNGDV3
.
          GOTO      UPHOS28
.
. ----- Go live date for ICD10 Edition 4 -----                         *I-49037
.
KHS28040  MOVE      "53",CCOL
          MOVE      "7",CVERT
          MOVE      ZERO,CHIGHLT
.
          MOVE      PTCNGDV4,KEY8
          CALL      GDVX0000
          BRANCH    EXIT,KHS28040
          MOVE      KEY8,PTCNGDV4
.
          GOTO      UPHOS28
.
. ----- Go live date for ICD10 Edition 5 -----                        *I-105244
.
KHS28050  MOVE      "53",CCOL
          MOVE      "8",CVERT
          MOVE      ZERO,CHIGHLT
.
          MOVE      PTCNGDV5,KEY8
          CALL      GDVX0000
          BRANCH    EXIT,KHS28050
          MOVE      KEY8,PTCNGDV5
.
          GOTO      UPHOS28
.
. ----- Go live date for ICD10 Edition 6 -----                        *I-163918
.
KHS28060  MOVE      "53",CCOL
          MOVE      "9",CVERT
          MOVE      ZERO,CHIGHLT
.
          MOVE      PTCNGDV6,KEY8
          CALL      GDVX0000
          BRANCH    EXIT,KHS28060
          MOVE      KEY8,PTCNGDV6
.
          GOTO      UPHOS28
.         
. ----- Go live date for ICD10 Edition 7 -----                        *I-219246
. 
KHS28070  MOVE      "53",CCOL
          MOVE      "10",CVERT
          MOVE      ZERO,CHIGHLT
.         
          MOVE      PTCNGDV7,KEY8
          CALL      GDVX0000
          BRANCH    EXIT,KHS28070
          MOVE      KEY8,PTCNGDV7
.
          GOTO      UPHOS28
.
. ----- Go live date for ICD10 Edition 8 -----                        *I-284420
. 
KHS28075  MOVE      "53",CCOL
          MOVE      "11",CVERT
          MOVE      ZERO,CHIGHLT
.         
          MOVE      PTCNGDV8,KEY8
          CALL      GDVX0000
          BRANCH    EXIT,KHS28075
          MOVE      KEY8,PTCNGDV8
.
          GOTO      UPHOS28
.
.
.
KHS28080  MOVE      "53",CCOL
          MOVE      "13",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNU41G
          BRANCH    EXIT,KHS2808A
          DISPLAY   *P61:CVERT,*EL
          GOTO      UPHOS28
.
KHS2808A  DISPLAY   *P61:CVERT,"3M Code: "
          KEYIN     *P70:CVERT,*V2LON,*RV,PTCNC41C
          GOTO      UPHOS28
.
KHS28090  MOVE      "53",CCOL
          MOVE      "14",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNU42G
          BRANCH    EXIT,KHS2809A
          DISPLAY   *P61:CVERT,*EL
          GOTO      UPHOS28
.
KHS2809A  DISPLAY   *P61:CVERT,"3M Code: "
          KEYIN     *P70:CVERT,*V2LON,*RV,PTCNC42C
          GOTO      UPHOS28
.
KHS28100  MOVE      "53",CCOL
          MOVE      "15",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNU50G
          BRANCH    EXIT,KHS2810A
          DISPLAY   *P61:CVERT,*EL
          GOTO      UPHOS28
.
KHS2810A  DISPLAY   *P61:CVERT,"3M Code: "
          KEYIN     *P70:CVERT,*V2LON,*RV,PTCNC50C
          GOTO      UPHOS28
.
KHS28110  MOVE      "53",CCOL
          MOVE      "16",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNU51G
          BRANCH    EXIT,KHS2811A
          DISPLAY   *P61:CVERT,*EL
          GOTO      UPHOS28
.
KHS2811A  DISPLAY   *P61:CVERT,"3M Code: "
          KEYIN     *P70:CVERT,*V2LON,*RV,PTCNC51C
          GOTO      UPHOS28
.
.                                                                     *I-137125
KHS28120  MOVE      "53",CCOL
          MOVE      "17",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNU52G
          BRANCH    EXIT,KHS2812A
          DISPLAY   *P61:CVERT,*EL
          GOTO      UPHOS28
.
KHS2812A  DISPLAY   *P61:CVERT,"3M Code: "
          KEYIN     *P70:CVERT,*V2LON,*RV,PTCNC52C
          GOTO      UPHOS28
.
.                                                                     *I-197814
KHS28130  MOVE      "53",CCOL
          MOVE      "18",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNU60G
          BRANCH    EXIT,KHS2813A
          DISPLAY   *P61:CVERT,*EL
          GOTO      UPHOS28
.
KHS2813A  DISPLAY   *P61:CVERT,"3M Code: "
          KEYIN     *P70:CVERT,*V2LON,*RV,PTCNC60C
          GOTO      UPHOS28
.                                                                     *I-267797
KHS28140  MOVE      "53",CCOL
          MOVE      "19",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNU62G
          BRANCH    EXIT,KHS2814A
          DISPLAY   *P61:CVERT,*EL
          GOTO      UPHOS28
.
KHS2814A  DISPLAY   *P61:CVERT,"3M Code: "
          KEYIN     *P70:CVERT,*V2LON,*RV,PTCNC62C
          GOTO      UPHOS28
.
.
KHS28150  MOVE      "53",CCOL
          MOVE      "21",CVERT
          CALL      KYND0000
          MOVE      EXIT,PTCNDGET
          GOTO      UPHOS28
.
.
KHS28900  COMPARE   ZERO,PTCNDGET           * validate PTCNDGET before posting
          GOTO      POST IF EQUAL
.
          MOVE      PTCNU41G,FORM1
          MOVE      PTCNU42G,FORM1A
          ADD       FORM1A,FORM1
          MOVE      PTCNU50G,FORM1A
          ADD       FORM1A,FORM1
          MOVE      PTCNU51G,FORM1A
          ADD       FORM1A,FORM1
          MOVE      PTCNU52G,FORM1A                                   *I-137125
          ADD       FORM1A,FORM1
          MOVE      PTCNU60G,FORM1A                                   *I-197814
          ADD       FORM1A,FORM1
          MOVE      PTCNU62G,FORM1A                                   *I-267797
          ADD       FORM1A,FORM1
.
          COMPARE   TWO,FORM1
          GOTO      POST IF LESS
          DISPLAY   *P1:23,"Tempfiles cannot be deleted if using multiple":
                           " Groupers - ";
          CALL      HITENTER
          DISPLAY   *P1:23,*EL;
          GOTO      UPHOS28
.
.
.
KHS28999  RETURN
.
+
.****************************************************************************
.*                           GDVX0000                                       *
.*        routine to format PTCNGDV3 to PTCNGDV7 (et al)                    *
.****************************************************************************
GDVX0000  MOVE      ZERO,EXIT
          UNPACK    KEY8,CCENT,CYEAR,CMON,CDAY
          MATCH     SP8,KEY8
          IF        @EQUAL
            MOVE      CCC,CCENT
            UNPACK    SP6,CYEAR,CMON,CDAY
          ENDIF
          MATCH     "00000000",KEY8
          IF        @EQUAL
            MOVE      CCC,CCENT
            UNPACK    SP6,CYEAR,CMON,CDAY
          ENDIF
.
          CALL      KEYDATE
          BRANCH    CQUEST,GDVX2000
.
          IF        OVRCD=1
            MOVE      SP8,KEY8
          ELSE
            PACK      KEY8,CCENT,CYEAR,CMON,CDAY
            REP       " 0",KEY8
          ENDIF
          GOTO      GDVX9999
.
GDVX2000  MOVE      ONE,EXIT
.
GDVX9999  RETURN
.****************************************************************************
.*                           KLAD0000                                       *
.*          Keyin for load additional parameters- NZHIS Parameters          *
.****************************************************************************
.
KLAD0000  DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = Do Nothing, ":
                               *V2LON,ONE,*HOFF," = Ask Question, ":
                               *V2LON,TWO,*HOFF," = Load details automatically"
.
KLAD1000  KEYIN     *PCCOL:CVERT,*V2LON,*EL,EXIT
.
          IF        EXIT > 2
            BEEP
            GOTO    KLAD1000
          ENDIF
.
          MOVE      LADDESC0,LADDESC
          LOAD      LADDESC,EXIT,LADDESC1,LADDESC2
          DISPLAY   *P52:CVERT,"= ",LADDESC
          
KLAD9999  RETURN
.**********************************************************************
.*                             KDM0000                                *
.*       Routine to keyin a day and month (no year)                   *
.**********************************************************************
KDM0000   UNPACK    SP4,CMON,CDAY            * initialise
.
.         Keyin day
.
          KEYIN     *PCCOL:CVERT,*DV,UNDLN2,*DV,SLASH,*DV,UNDLN2:
                    *PCCOL:CVERT,*V2LON,*DE,*JR,*+,XDAY;
          RESET     XDAY
          GOTO      KDM9000 IF EOS           * nothing input
          MATCH     SP2,XDAY
          GOTO      KDM9000 IF EQUAL         * nothing input
.
          MOVE      XDAY,IDAY                * convert to a form field
          COMPARE   ONE,IDAY                 * must be >= 1
          GOTO      KDM0900 IF LESS          * error
.
          COMPARE   IDAY,THIRTY1             * must be <= 31
          GOTO      KDM0900 IF LESS          * error
.
          MOVE      IDAY,CDAY
          REP       " 0",CDAY
.
.         Keyin month
.
KDM0500   MOVE      CCOL,FORM2
          ADD       THREE,FORM2
          KEYIN     *PCCOL:CVERT,*DV,*V2LON,CDAY,*DV,SLASH,*DV,*HOFF,UNDLN2:
                    *PFORM2:CVERT,*V2LON,*DE,*JR,XMON;
          RESET     XMON
          GOTO      KDM0000 IF EOS           * nothing input
          MATCH     SP2,XMON
          GOTO      KDM0000 IF EQUAL         * nothing input
.
          MOVE      XMON,IMON                * convert to a form field
          COMPARE   ONE,IMON                 * must be >= 1
          GOTO      KDM1900 IF LESS          * error
.
          COMPARE   IMON,TEN2                * must be <= 12
          GOTO      KDM1900 IF LESS          * error
.
          MOVE      IMON,CMON
          REP       " 0",CMON
.
.         Validate number of days against month
.
          LOAD      FORM2,IMON,THIRTY1,TWENTY8,THIRTY1,THIRTY,THIRTY1,THIRTY:
                               THIRTY1,THIRTY1,THIRTY,THIRTY1,THIRTY,THIRTY1
.
          COMPARE   IDAY,FORM2
          GOTO      KDM2900 IF LESS
.
          DISPLAY   *PCCOL:CVERT,*V2LON,CDAY,SLASH,CMON
          GOTO      KDM9999
.
.         Errors
.
KDM0900   BEEP
          GOTO      KDM0000
.
KDM1900   BEEP
          GOTO      KDM0500
.
KDM2900   DISPLAY   *P1:24,*EL,*B,"This month has only ",FORM2," days. ";
          CALL      HITENTER
          GOTO      KDM0000
.
.         Nothing input
.
KDM9000   DISPLAY   *PCCOL:CVERT,SP5
.
KDM9999   RETURN
.**********************************************************************
.*                             CURR0000                               *
.*       Routine to make sure any date entered is not in the future   *
.**********************************************************************
CURR0000  PACK      CURMON,CYY,CMM
          REP       " 0",CURMON
          MOVE      FALSE,EXIT
.
          MATCH     DIM4,CURMON             * test date entered against current
          GOTO      CURR9999 IF NOT LESS      month and year
.
          DISPLAY   *P1:24,*EL,*B,*V2LON,"Date cannot be into the future.    ";
          CALL      HITENTER
          MOVE      TRUE,EXIT
.
CURR9999  RETURN
+
.**********************************************************************
.*                             CHCK0000                               *
.*       Routine to make sure that the date ranges entered for        *
.*       the PRS2 reports do not exceed 2 years                       *
.**********************************************************************
CHCK0000  MOVE      FALSE,EXIT
          UNPACK    PRSDAT6A,CCENT,CYEAR,CMON
          UNPACK    PRSDAT6B,XCENT,XYEAR,XMON
          PACK      DIM4C,CCENT,CYEAR
          PACK      DIM4D,XCENT,XYEAR
          MOVE      DIM4C,FORM4A
          MOVE      DIM4D,FORM4B
          SUB       FORM4A,FORM4B
.
          COMPARE   THREE,FORM4B            * see if 3 or more years difference
          GOTO      CHCK9000 IF NOT LESS
.
          BRANCH    FORM4B,CHCK9999,CHCK1000
          GOTO      CHCK9999
.
.------ difference between years is 2 so check the months difference ------
.
CHCK1000  MOVE      CMON,FORM2A
          MOVE      XMON,FORM2B
.
          COMPARE   FORM2B,FORM2A           * ending month must be <= starting
          GOTO      CHCK9999 IF NOT LESS      month
.
.------ Invalid date range ------
.
CHCK9000  MOVE      TRUE,EXIT          
.
CHCK9999  RETURN
+
.*******************************************************************************
.*        Posting routine for all update routines except UPIBAS                *
.*******************************************************************************

POST      MOVE      ZERO,OVRCD
          RETURN
+
CANC      MOVE      ONE,OVRCD
          RETURN
+
.*******************************************************************************
.*        Subroutines to update the control file with the new values           *
.*******************************************************************************
WRAGE     WRITAB    CONTROLF,TWENTY;*92,PTCNAF01,PTCNAF02,PTCNAF03,PTCNAF04:
                                        PTCNAF05,PTCNAF06,PTCNAF07,PTCNAF08:
                                        PTCNAF09,PTCNAF10,PTCNAF11,PTCNAF12:
                                        PTCNAT01,PTCNAT02,PTCNAT03,PTCNAT04:
                                        PTCNAT05,PTCNAT06,PTCNAT07,PTCNAT08:
                                        PTCNAT09,PTCNAT10,PTCNAT11,PTCNAT12
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRAUD     WRITAB    CONTROLF,TEN;*45,CAUDMAMX
          WRITAB    CONTROLF,TEN;*201,CAUDA,CAUDB,CAUDC,CAUDD,CAUDE,CAUDF,CAUDG:
                                      CAUDH,CAUDI,CAUDJ,CAUDK,CAUDL,CAUDM,CAUDN:
                                      CAUDO,CAUDP,CAUDQ,CAUDR,CAUDS,CAUDT,CAUDU:
                                      CAUDV,CAUDW,CAUDX,CAUDY,CAUDZ:
                                      *239,CAUDA2,*250,CAUDA1
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS     WRITAB    CONTROLF,TEN;*9,CNOBEDS,*54,CFILENO,*79,CAPPRVNO:
                                *94,CAGECOFF,*138,CNOPORT
          WRITAB    CONTROLF,TEN3;CHADD1,CHADD2,CHPOST:
                                  CHPADD1,CHPADD2,CHPPOST,CHTELEB:
                             *167,BRSTAY1,BRSTAY2,BRSTAY3,*213,CHCSCOD
          WRITAB    CONTROLF,TEN8;*246,CMAXAGE
          WRITAB    CONTROLF,EIGHTY;*250,PTCNHDPS
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS2    WRITAB    CONTROLF,TEN;*120,CLETPLN,CLETTAB,CSECFEE,*149,CLETLEN:
                                 *160,CMEDSERV,*164,CSPECCO:
                                 *183,CVIEWIP,CPRIMOP,CPRIMDS:
                                 *194,CDIETCD,CMEDCAR,*198,CDIETDF:
                                 *227,CLETTOP,CLETTOA,CLETTOS,CLETTOT
          WRITAB    CONTROLF,TEN3;*144,COPRSIZ1,COPRSIZ2,*211,CINV1ST
          WRITAB    CONTROLF,TEN4;*231,CATDMAN,*245,CMAXINV
          WRITAB    CONTROLF,TEN5;*249,CRDRTYP
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS3    WRITAB    CONTROLF,TEN3;*143,CSIZLAB:
                                  *166,UROPT,*184,CERRAUD:
                                  *188,CMABINS,CVETINS:
                                  *201,CNDOCLB,*212,CDOCSLB
          WRITAB    CONTROLF,TEN4;*232,CDOCLLN
          WRITAB    CONTROLF,TEN;*126,CLABPG,CLABPRT,*148,CDOCLAB
          WRITAB    CONTROLF,TEN8;*207,CNDLAB,CDISPRT,*211,CBTLAB,CBTRPRT:
                                  *215,CPRDLB,CPRBTL,*231,CNBLAB,CNBPRT,CPRNBL
          WRITAB    CONTROLF,FIFTY9;*35,CTYPLAB
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS4    WRITAB    CONTROLF,TEN3;*188,CMABINS,CVETINS:
                                  *216,CUSR1,CUSRDS1,CUSR2,CUSRDS2
          WRITAB    CONTROLF,TEN4;*229,CUSMAN1,CUSMAN2
          WRITAB    CONTROLF,TEN5;*233,CUSR3,CUSRDS3,CUSMAN3
          WRITAB    CONTROLF,TEN8;*17,CUSR4,CUSRDS4,CUSMAN4
          WRITAB    CONTROLF,HUND05;*203,PTCNCROL,PTCNCTYP
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS5    WRITAB    CONTROLF,TEN5;*191,CMUSR1,CMUSDS1,CMUSR2,CMUSDS2:
                                       CMUSR3,CMUSDS3,CMUSMAN1,CMUSMAN2,CMUSMAN3
          WRITAB    CONTROLF,TEN8;*31,CUSR5,CUSRDS5,CUSMAN5:
                                      CUSR6,CUSRDS6,CUSMAN6:
                                      CUSR7,CUSRDS7,CUSMAN7
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS6    WRITAB    CONTROLF,TEN8;*73,CDUSR1,CDUSDS1,CDUSMAN1:
                                      CDUSR2,CDUSDS2,CDUSMAN2:
                                      CDUSR3,CDUSDS3,CDUSMAN3:
                                      CDUSR4,CDUSDS4,CDUSMAN4:
                                      CDUSR5,CDUSDS5,CDUSMAN5
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS7    WRITAB    CONTROLF,TEN;*167,CSECURA,CSECURD
          WRITAB    CONTROLF,TEN3;*182,CERRSEC,CERRDAY,CERRAUD:
                                  *186,CMBSOPR,*200,CDOCVMP
          WRITAB    CONTROLF,TEN5;*190,CKMBS,*247,CSTDOWN
          WRITAB    CONTROLF,TEN8;*143,CLOWMBS,CLOWADM:
                                       CHIGHMBS,CHIGHADM,CTOPADM:
                                  *207,CNDLAB,CDISPRT:
                                  *225,CCHGST1,CCHGST2
          WRITAB    CONTROLF,TEN9;*209,CSRESP,*213,CDYCASE
          WRITAB    CONTROLF,FIFTY9;*1,CDLSTEP,*233,PTCNADOC
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS8    WRITAB    CONTROLF,TEN8;*205,CPRINV,*206,CFINAN,*236,CMEDIB:
                                  *249,CNXBTCH,CDOCBTR,*254,CJRNDAT
          WRITAB    CONTROLF,TEN5;*248,CBFXITM
          WRITAB    CONTROLF,TEN9;*214,CWRDSCN,*216,CINVRIP,CINVRAE,CINVROF:
                                  *242,CTOTADM
          WRITAB    CONTROLF,FIFTY9;*2,C3BDAYS,CREMINV,*6,CLUNTNO,*26,BEDCENS:
                                   *38,CRESIDT,*41,CNONRES,*44,CYRSRES:
                                  *227,CADMCAT
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS9    WRITAB    CONTROLF,TEN9;*211,CPCINLE
          WRITAB    CONTROLF,FIFTY9;*47,COTHARE,*50,COVRARE,*53,COIDINP:
                                    *55,COIDAAE,*57,COIDOUT:
                                    *66,CGSTPERC,CGSTITEM,*79,CYRESMAN,CBIRTHCN:
                                    *84,CMERGEUR,CMORBDTM,*128,CREBPORT:
                                   *132,CALRDESC,CPIDCOD,*205,CDOPANA:
                                   *208,PTWRDLAB,*213,PTURLAB,*216,PTPRVALS:
                                   *218,PTMORBDT,PTCNREPO
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS10   WRITAB    CONTROLF,TEN4;CNOCLMS,CINMES1,CINMES2
          WRITAB    CONTROLF,NINTY8;*165,PTCNAUED
          WRITAB    CONTROLF,HUND09;*1,PTCNQUM1,PTCNQUM2
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS11   WRITAB    CONTROLF,TEN5;CMSINV1,CMSINV2,CMSINV3
          WRITAB    CONTROLF,EIGHTY8;*140,CFEEMDT
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS11A  WRITAB    CONTROLF,TWENTY;*1,CMUSR4,CMUSDS4,CMUSR5,CMUSDS5:
                    CMUSR6,CMUSDS6:
                    CMUSMAN4,CMUSMAN5,CMUSMAN6
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS12   WRITAB    CONTROLF,TEN;*15,PTCNDLVE,*25,PTCNVKCA,PTCNHBRD
          WRITAB    CONTROLF,TWENTY;*78,PTCNALLC,*87,PTCNBRD,*91,PTCNHSEM:
                                    *165,PTCNDFBO,PTCNTACP,*192,PTALRH31:
                                    *193,PTCNDCLM,PTCNUCRD,PTCNUFML,PTCNPIOP:
                                    *199,PTCNBCUT,*204,PTCNDKCL,PTCNCDEF
          WRITAB    CONTROLF,SEVENTY7;*23,PTCNNFAP,PTCNNFAD,PTCNDORO
          WRITAB    CONTROLF,HUND05;*166,PTCNCMXF
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS13   WRITAB    CONTROLF,TWENTY;*209,PTCNSCLS,*211,PTCNCNDY,PTCNDOOP:
                             PTCNDPCN,*216,PTCNCSCP,*222,PTINSCER:
                             PTCNLNFF,PTCNCHFF
          WRITAB    CONTROLF,TWENTY1;*1,PTCNBABD,PTCNOI73,PTCNET73,*46,PTCNBAGE:
                             *69,PTCNDSWP,PTCNDRGG,*123,PTCNOUTD,*199,PTCNDBWB:
                             *201,PTCNNLIL,PTCNUABL:
                             *219,PTCNDDCD:
                             *250,PTCNDDSD
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS14   WRITAB    CONTROLF,TWENTY1;*174,PTCNDONR,PTCNMEDW,PTCNUDNG,PTCNNSCA:
                             PTCNMPTR,*181,PTCNLNCD,PTCNLP01,PTCNLH31,PTCNLO66:
                             PTCNLA01,PTCNLW01,PTCNVP32,PTCNVM21,PTCNUONL:
                             PTCNPCON,*212,PTCNLTYP:
                             *214,PTCNUREA
          WRITAB    CONTROLF,SEVENTY7;*199,PTCNPCDS
          WRITAB    CONTROLF,EIGHTY;*242,PTCNALOS
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS15   WRITAB    CONTROLF,TEN;*39,PTCNACAN,*52,PTCNBNOK
          WRITAB    CONTROLF,TWENTY1;*180,PTCNCDRS:
                             *215,PTCNUDIN,*218,PTCNBWMR:
                             *220,PTNSWHDP,*221,CNSWLOC,*222,CNSWLNG:
                             *223,PTCNEIAS,PTCNEIOC,PTCNEIMO,PTCNMWAD:
                             *238,PTCNAGEC
          WRITAB    CONTROLF,SEVENTY7;*1,PTCNDPRS,PTCNCDAT:
                             *98,PTCNLFCH,*168,PTCNBRHF,*195,PTCNDLKR:
                             *198,PTCNPRCW
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
WRHOS16   MATCH     PTCNLDDC,PTCNLDAF       * All ledgers must be the same! 
          GOTO      WRHOS16A IF NOT EQUAL 
.
          MATCH     PTCNLDDC,PTCNLDDS
          GOTO      WRHOS16B IF EQUAL 
.
WRHOS16A  DISPLAY   *P1:24,*B,*EL,"All Ledgers must be the same - ";
          CALL      HITENTER
          MOVE      ONE,EXIT
          GOTO      WRHOS16C
.
WRHOS16B  IF        PTCNADMF > PTCNADXF
            DISPLAY   *P1:24,*B,*EL,"Mimimum Fee Must be Less Than Maximum ":
                      "Fee. ";
            CALL      HITENTER
            MOVE      ONE,EXIT
            GOTO      WRHOS16C
          ENDIF
.             
          WRITAB    CONTROLF,TEN8;*183,CGLDISS,*188,CGLRESP
          WRITAB    CONTROLF,SEVENTY7;*202,PTCNOCSC:
                                      *229,PTCNCFDS,*232,PTCNTMIN
          WRITAB    CONTROLF,EIGHTY;*81,PTCNCQPT,PTCNCQDT,*111,PTCNADFP:
                                      *117,PTCNADMF,*123,PTCNADXF:
                                      *163,PTCNJRTY,*165,PTCNLDDC,*167,PTCNACDC:
                                      *179,PTCNLDAF,*181,PTCNACAF:
                                      *193,PTCNLDRF,*195,PTCNACRF:
                                      *207,PTCNLDDS,*209,PTCNACDS:
                                      *221,PTCNJRCC,*230,PTCNDAY:
                                      *233,PTCNWEEK,*236,PTCNMONT,*240,PTCNDORP
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          MOVE      ZERO,EXIT
WRHOS16C  RETURN
+
WRHOS17   WRITAB    CONTROLF,TEN;*40,PTCNINRA,PTCNINVQ,PTCNDGAT:
                                     PTCNMRBT,PTCNMRBC
          WRITAB    CONTROLF,FIFTY9;*7,PTCNIBED
          WRITAB    CONTROLF,SEVENTY9;*75,PTCNDBTR,*79,PTCNPREV,PTCNQLDB:
                                      *81,PTCNGEST,PTCNDSCI,PTCNESTB:
                                      *245,PTCNCHSD,PTCNCHAL:
                                       PTCNOPHO,*249,PTCNMIC1,PTCNMIC2
          WRITAB    CONTROLF,EIGHTY;*143,PTCNAURN,*248,PTCNPEFR
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          MOVE      ZERO,EXIT
          RETURN
+
WRHOS18   WRITAB    CONTROLF,TEN;*46,PTCNFRDA,PTCNNLOC,*50,PTCNACDR,PTCNACPH
          WRITAB    CONTROLF,TWENTY;*250,PTCNH82W
          WRITAB    CONTROLF,SEVENTY7;*35,PTCNP68L
          WRITAB    CONTROLF,SEVENTY9;*93,PTCNAAPE,PTCNADTT,PTCNDSTT:
                                      *106,PTCNDAYM:
                                      *110,PTCNVADM,PTCNECDF,*113,PTCNDSPC:
                                      *114,PTCNPPPT,*119,PTCNEAPD:
                                      *122,PTCNLMAN,PTCNLEDT,PTCNPACC,PTCNEEOC
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          MOVE      ZERO,EXIT
          RETURN
+
WRHOS19   WRITAB    CONTROLF,SEVENTY7;*215,PTCNUVTH,PTCNPALC,PTCNFINP:
                                      *218,PTCNDSDY,PTCNDMSO
          WRITAB    CONTROLF,SEVENTY9;*243,PTCNRORC
          WRITAB    CONTROLF,EIGHTY8;*1,PTCNPELT,*2,PTCNIELT,*43,PTCNACCF:
                                     *56,PTCNHADF,*232,PTCNDEBW
          WRITAB    CONTROLF,TWENTY1;*44,PTCNIDES
          WRITAB    CONTROLF,EIGHTY8;*234,PTCNNCFB,*235,PTCNADCF,*236,PTCNDSCF:
                                     *237,PTCNEMPL,*239,PTCNOCCP,*241,PTCNCSTA:
                                     *244,PTCNCRAY
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          MOVE      ZERO,EXIT
          RETURN
+
WRHOS20   WRITAB    CONTROLF,NINTY8;*71,PTCNAFLG,*76,PTCNCLNO,*84,PTCNCSRL:
                                    *85,PTCNPSOS,*121,PTCNRQDF,*124,PTCNHPCD:
                                        PTCNPMIS,*129,PTCNDGST:
                                        PTCNAGST,*136,PTCNPAIH,*142,PTCNPAIT:
                                    *148,PTCNINVB
          WRITAB    CONTROLF,HUND05;*66,PTCNUSQL,*69,PTCNPLFI:
                                    *71,PTCNCMAU,*73,PTCNCMDU:
                                    *98,PTCNCMYN,*99,PTCNNWCM
          RETURN
+
WRHOS21   MOVE      ZERO,EXIT                                          *C-61562
          WRITAB    CONTROLF,HUND05;*130,PTCNAUAT,PTCNWSPC:
                                         PTCNADB1,PTCNADB2,PTCNADB3,PTCNADB4:
                                         PTCNDFAN,*165,PTCNONLA:
                                         *168,PTCNTIMC,*173,PTCNICUT:
                                         *174,PTCNIOEV,*175,PTCNNULB:
                                         *180,PTCNTIMN,*189,PTCNPRCL:
                                         *202,PTCNCPAH
          WRITAB    CONTROLF,FIFTY9;*210,PTMBSINV
.
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          MOVE      ZERO,EXIT
          RETURN
+
.***************************************************************************
.* WRHOS22 - Write Hospital Controlled PRS/2 Screen 1
.***************************************************************************
WRHOS22   WRITAB    CONTROLF,TWENTY;*53,PTCNPRS1,*63,PTCNPRS2,*210,PTCNMEDC
          WRITAB    CONTROLF,EIGHTY8;*170,PTCNRNG1,*182,PTCNRNG2:
                                     *222,PTCNCDSC,*223,PTCN1ATS
          WRITAB    CONTROLF,FIFTY9;*219,PTCNREPO
          WRITAB    CONTROLF,SEVENTY7;*36,PTCNPRS3,PTCNDTE3,*220,PTCNEDRG
          WRITAB    CONTROLF,NINTY8;*81,PTCNHCOD,*225,PTCNPRS4,*227,PTCNRNG4:
                                    *239,PTCNPRS5,*241,PTCNRNG5
          WRITAB    CONTROLF,HUND05;*167,PTCNPRCC
          WRITAB    CONTROLF,HUND09;*195,PTCNACAS,*224,PTCNPR3A,*226,PTCNRNG3
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2            *C-53150
          MOVE      ZERO,EXIT
          RETURN
.
.********************************************************************
.* WRHOS23   :  Hospital Controlled - Write State based PMI     
.********************************************************************
WRHOS23   WRITAB    CONTROLF,HUND05;*2,PTCNTORG,*6,PTCNTOSX,*10,PTCNTOPQ:
                                    *14,PTCNTOAP,*18,PTCNTOUP,*22,PTCNTOMP
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
.
.********************************************************************
.* WRHOS24   :  Hospital Controlled - Write HDP / PHDB          
.********************************************************************
WRHOS24   WRITAB    CONTROLF,HUND05;*178,PTCNVETR,*185,PTCNELPS,*187,PTCNPPAL 
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
.
.********************************************************************
.* WRHOS25   :  Hospital Controlled - screen 25
.********************************************************************
WRHOS25   WRITAB    CONTROLF,TEN;*104,PTCNMBSF                         *I-47385
          WRITAB    CONTROLF,HUND05;*192,PTCNUBNK,*193,PTCNITXT,*194,PTCNPCOM:
                                    *195,PTCNLASR,*196,PTCNBLSI,*198,PTCNXLBI:
                                    *200,PTCNPJCI,*201,PTCNPFED,*210,PTCNLCLM:
                                    *212,PTCNHBID,*216,PTCNDWAW,*225,PTCNACCD
.                                                                      *I-39616
          WRITAB    CONTROLF,HUND09;*159,PTCNUICF,*183,PTCNDMCC,*192,PTCNDMJC
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.* WRHOS26   :  Hospital Controlled - EDI screen 26
.********************************************************************
.
WRHOS26   WRITAB    CONTROLF,HUND10;*116,PTCNEDIH,*118,PTCNEDIO,*178,PTCNORIG:
                                    *228,PTCNHCCC,*242,PTCNMBRL
.
          RETURN
+
.***************************************************************************
.* WRHOS27 - Write Hospital Controlled PRS/2 Screen 2               *I-49016
.***************************************************************************
WRHOS27   WRITAB    CONTROLF,HUND09;*208,PTCNRTCN,PTCNRTRQ,PTCNPRS6,PTCNRNG6
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
          RETURN
.
.***************************************************************************
.* WRHOS28 - Write Hospital Controlled Screen 28                       *I-49037
.***************************************************************************
WRHOS28   WRITAB    CONTROLF,EIGHTY8;*59,PTCNI10D     * ICD10 Ed1 date *I-49037
          WRITAB    CONTROLF,NINTY8;*149,PTCNGDV2     * ICD10 Ed2 date *I-49037
          WRITAB    CONTROLF,HUND09;*151,PTCNGDV3     * ICD10 Ed3 date *I-49037
          WRITAB    CONTROLF,HUND05;*217,PTCNGDV4:    * ICD10 Ed4 date *I-49037
                                    *227,PTCNGDV5     * ICD10 Ed5 date *I105244
          WRITAB    CONTROLF,HUND12;*239,PTCNGDV6     * ICD10 Ed.6    *I-163918
          WRITAB    CONTROLF,HUND10;*61,PTCNGDV7:     * ICD10 Ed.7    *I-219246
                                    *69,PTCNGDV8      * ICD10 Ed.8    *I-284420
.
          WRITAB    CONTROLF,TEN;*104,PTCNDGET:
                                 *105,PTCNU50G,*106,PTCNC50C:          *I-61562
                                 *109,PTCNC42C,*112,PTCNC41C:          *I-61562
                                 *132,PTCNU60G,*133,PTCNC60C:         *I-197814
                                 *140,PTCNU51G,*141,PTCNC51C:          *I-61562
                                 *144,PTCNU52G,*145,PTCNC52C:         *I-137125
                                 *152,PTCNU62G,*153,PTCNC62C          *I-267797
.
          WRITAB    CONTROLF,HUND05;*162,PTCNU41G,*163,PTCNU42G        *I-61562
.
          RETURN
+
.
.         Subroutine to key in a date
.
KEYINDTE  
          IF        IDAY=0
            MOVE      SP10,CDAY        * no default day/mon
            MOVE      SP10,CMON
          ELSE
            MOVE      IDAY,CDAY        * set up day/mon
            MOVE      IMON,CMON
          ENDIF
          MOVE      IYEAR,CYEAR        * set up year
.
          MOVE      VERT,CVERT         * set up position
          MOVE      COL,CCOL
.
          MOVE      "0",CCANLDTE       * 0=cannot cancel default date, 1=can
          MOVE      "1",CDEFDTE        * 0=3 C/R's to accept date, 1=1 C/R
          REPEAT
            CALL      KEYDATE          * nez modified to use standard routine
          UNTIL     CQUEST=0
.
          MOVE      ZERO,IDAY
          MOVE      CDAY,IDAY
.
          RETURN
.
.------------------------------------------------------------------------------
.         Yes/No standard keyin
.------------------------------------------------------------------------------
.
KYN0000   KEYIN     *PCCOL:CVERT,*DV,SP3:    * clear previous display
                    *PCCOL:CVERT,*DV,UNDLN1:
                    *PCCOL:CVERT,*V2LON,ANS:
                    *PCCOL:CVERT,*DV,ANS;
.
          TYPE      ANS                      * check if a number was input
          GOTO      KYN9000 IF EQUAL         * yes, invalid
.
          REP       "Y1y1N0n0",ANS           * convert valid answers to numerics
.
          TYPE      ANS                      * check if now a number
          GOTO      KYN9000 IF NOT EQUAL     * no, invalid
.
          MOVE      ANS,EXIT                 * set exit to Y/N value
.
          MOVE      DNO,DANS1                * assume answer was "No "
          LOAD      DANS1,EXIT,DYES,DNO      * unless otherwise stated
.
          DISPLAY   *PCCOL:CVERT,*V2LON,DANS1
          GOTO      KYN9999
.
KYN9000   BEEP
          GOTO      KYN0000
.
KYN9999   RETURN
.
.------------------------------------------------------------------------------
.         Yes/No standard keyin  with   DEFAULTS !!!!!!!!!!!!!!
.         Requires ANS (1=No, 0=Yes)
.------------------------------------------------------------------------------
.
KYNO0000  REP       "1N0Y",ANS
          MOVE      ANS,DIM1                      * save default
.         
KYNO1000  MOVE      DIM1,ANS
          KEYIN     *PCCOL:CVERT,*DV,ANS:
                    *PCCOL:CVERT,*V2LON,*RV,ANS:
                    *PCCOL:CVERT,*DV,ANS;
.
          TYPE      ANS                      * check if a number was input
          GOTO      KYNO9000 IF EQUAL         * yes, invalid
.
          REP       "N1n1Y0y0",ANS           * convert valid answers to numerics
.
          TYPE      ANS                      * check if now a number
          GOTO      KYNO9000 IF NOT EQUAL     * no, invalid
.
          MOVE      ANS,EXIT                 * set exit to Y/N value
.
          MOVE      DYES,DANS1                * assume answer was "Yes"
          LOAD      DANS1,EXIT,DNO            * unless otherwise stated
.
          DISPLAY   *PCCOL:CVERT,*V2LON,DANS1
          GOTO      KYNO9999
.
KYNO9000  BEEP
          GOTO      KYNO1000
.
KYNO9999  RETURN
.------------------------------------------------------------------------------
.         Yes/No standard keyin  with   DEFAULTS !!!!!!!!!!!!!!
.         Requires ANS (0=No, 1=Yes, 2=No)
.------------------------------------------------------------------------------
.
KYND0000  REP       "2N1Y0N",ANS
          MOVE      ANS,DIM1                      * save default
.         
KYND1000  MOVE      DIM1,ANS
          KEYIN     *PCCOL:CVERT,*EL,*DV,ANS:
                    *PCCOL:CVERT,*V2LON,*RV,ANS:
                    *PCCOL:CVERT,*DV,ANS;
.
          TYPE      ANS                      * check if a number was input
          GOTO      KYND9000 IF EQUAL         * yes, invalid
.
          REP       "Y1y1N0n0",ANS           * convert valid answers to numerics
.
          TYPE      ANS                      * check if now a number
          GOTO      KYND9000 IF NOT EQUAL     * no, invalid
.
          MOVE      ANS,EXIT                 * set exit to Y/N value
.
          MOVE      DNO,DANS1                * assume answer was "No "
          LOAD      DANS1,EXIT,DYES,DNO      * unless otherwise stated
.
          DISPLAY   *PCCOL:CVERT,*V2LON,DANS1
          GOTO      KYND9999
.
KYND9000  BEEP
          GOTO      KYND1000
.
KYND9999  RETURN
.------------------------------------------------------------------------------
.         Yes/No standard keyin  with   DEFAULTS !!!!!!!!!!!!!!
.         Requires ANS (1=No, 0=Yes)
.------------------------------------------------------------------------------
.
KNYD0000  REP       "0Y1N",ANS
          MOVE      ANS,DIM1                      * save default
.         
KNYD1000  MOVE      DIM1,ANS
          KEYIN     *PCCOL:CVERT,*DV,ANS:
                    *PCCOL:CVERT,*V2LON,*RV,ANS:
                    *PCCOL:CVERT,*DV,ANS;
.
          TYPE      ANS                      * check if a number was input
          GOTO      KNYD9000 IF EQUAL         * yes, invalid
.
          REP       "Y0y0N1n1",ANS           * convert valid answers to numerics
.
          TYPE      ANS                      * check if now a number
          GOTO      KNYD9000 IF NOT EQUAL     * no, invalid
.
          MOVE      ANS,EXIT                 * set exit to Y/N value
.
          MOVE      DYES,DANS1               * assume answer was "Yes"
          LOAD      DANS1,EXIT,DNO           * unless otherwise stated
.
          DISPLAY   *PCCOL:CVERT,*V2LON,DANS1
          GOTO      KNYD9999
.
KNYD9000  BEEP
          GOTO      KNYD1000
.
KNYD9999  RETURN
+
ENDIT     CALL      KILL0000
          CHAIN     PGM
          STOP
+
.********************************************************************
.*  INIT0000  :  Initialise                                         *
.********************************************************************
.
INIT0000  CALL      DISPHEAD
.
          DISPLAY   *P64:24,"Opening controlf"
          OPEN      CONTROLF,"controlf"
.
          DISPLAY   *P72:24,"patcodes"
          OPEN      PATCODE1,"patcodes"
.
          DISPLAY   *P72:24,"pathospf"
          OPEN      PATHOSP1,"pathospf"
          OPEN      PATHOSP2,"pathospf"
.
          MOVE      "35",HLEF
          MOVE      "80",HRIG
          MOVE      "12",HTOP
          MOVE      "23",HBOT
          MOVE      "44",CCOL
          PACK      BOXHDR,SP30,SP30,SP30
.
          RETURN
+
.********************************************************************
.*  IMEN0000  :  IBA Screens Menu                                   *
.********************************************************************
.
IMEN0000  HLINE     *G37,2,54,80
          DISPLAY   *P1:3,*EF:
                    *P01:04,*V2LON," 0",*HOFF," = Exit":
                    *P01:05,*V2LON," 1",*HOFF," = Hospital based details":
                    *P01:06,*V2LON," 2",*HOFF," = Systems/Interfaces 1":
                    *P01:07,*V2LON," 3",*HOFF," = Systems/Interfaces 2":
                    *P01:08,*V2LON," 4",*HOFF," = Menus":
                    *P01:09,*V2LON," 5",*HOFF," = HDP/HCS details":
                    *P01:10,*V2LON," 6",*HOFF," = Incremental Number":
                    *P01:11,*V2LON," 7",*HOFF," = Using Files":
                    *P01:12,*V2LON," 8",*HOFF," = U/R based details":
                    *P01:13,*V2LON," 9",*HOFF," = PMI fields 1":
                    *P01:14,*V2LON,"10",*HOFF," = Financial 1":
                    *P01:15,*V2LON,"11",*HOFF," = Financial 2":
                    *P01:16,*V2LON,"12",*HOFF," = Labels/Id sheets":
                    *P01:17,*V2LON,"13",*HOFF," = Invoices":
                    *P01:18,*V2LON,"14",*HOFF," = Comments":
                    *P01:19,*V2LON,"15",*HOFF," = Length of stay details":
                    *P01:20,*V2LON,"16",*HOFF," = Admission based details":
                    *P01:21,*V2LON,"17",*HOFF," = Miscellaneous details 1":
                    *P01:22,*V2LON,"18",*HOFF," = Miscellaneous details 2":
                    *P40:04,*V2LON,"19",*HOFF," = Screen Painter details":
                    *P40:05,*V2LON,"20",*HOFF," = Quotes":
                    *P40:06,*V2LON,"21",*HOFF," = PMI fields 2":
                    *P40:07,*V2LON,"22",*HOFF," = HK National Interface":
                    *P40:08,*V2LON,"23",*HOFF," = Singapore Interface":
                    *P40:09,*V2LON,"24",*HOFF," = Status Adjustment Fields":
                    *P40:10,*V2LON,"25",*HOFF," = PRS/2 Details":
                    *P40:11,*V2LON,"26",*HOFF," = Interface Engine Set Up":
                    *P40:12,*V2LON,"27",*HOFF," = State base PMI screens":
                    *P40:13,*V2LON,"28",*HOFF," = Miscellaneous details 3":
                    *P1:24,"Select Option : ";
.
IMEN1000  KEYIN     *P17:24,*DV,UNDLN2:
                    *P17:24,*V2LON,COPTION:
                    *P17:24,*DV,COPTION
.
          IF        (COPTION<0) | (COPTION>28)
            BEEP
            GOTO      IMEN1000
          ENDIF
.
          MOVE      ZERO,EXIT
          COMPARE   ZERO,COPTION
          GOTO      IMEN9999 IF NOT EQUAL
          MOVE      ONE,EXIT                      * Exit selected
.
IMEN9999  RETURN
+
.********************************************************************
.*  IOPT0000  :  IBA Screens Options        Requires: COPTION       *
.********************************************************************
IOPT0000  BRANCH    COPTION,IOPT0100:             * Hospital details
                            IOPT0200:             * Systems/Interfaces 1
                            IOPT0300:             * Systems/Interfaces 2
                            IOPT0400:             * Menus
                            IOPT0500:             * HDP/HCS details
                            IOPT0600:             * Incremental No's
                            IOPT0700:             * Using files
                            IOPT0800:             * U/R Based details
                            IOPT0900:             * PMI Fields 1
                            IOPT1000:             * Financial 1
                            IOPT1100:             * Financial 2
                            IOPT1200:             * Labels/Id sheets
                            IOPT1300:             * Invoices
                            IOPT1400:             * Comments
                            IOPT1500:             * Length of Stay details
                            IOPT1600:             * Admission based details
                            IOPT1700:             * Miscellaneous details 1
                            IOPT1800:             * Miscellaneous details 2
                            IOPT1900:             * Screen Painter
                            IOPT2000:             * Quotes
                            IOPT2100:             * PMI fields 2
                            IOPT2200:             * HK National Interface
                            IOPT2300:             * Singapore Interface
                            IOPT2400:             * Status adjustments fields
                            IOPT2500:             * PRS2 Screen
                            IOPT2600:             * Interface Engine Set Up
                            IOPT2700:             * State based PMI screens 
                            IOPT2800              * Miscellaneous details 3
.
. Hospital based details
.
IOPT0100  CALL      DIHS0000                      * display screen
          CALL      CIHS0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRHS0000                      * Post
          GOTO      IOPT9999
.
. Systems/Interfaces 1
.
IOPT0200  CALL      DISI0000                      * display screen
          CALL      CISI0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRSI0000                      * Post
          GOTO      IOPT9999
.
. Systems/Interfaces 2
.
IOPT0300  CALL      DS2I0000                      * display screen
          CALL      CS2I0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WR2I0000                      * Post
          GOTO      IOPT9999
.
. Menus
.
IOPT0400  CALL      DIME0000                      * display screen
          CALL      CIME0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRME0000                      * Post
          GOTO      IOPT9999
.
. HDP/HCS details
.
IOPT0500  CALL      DIHD0000                      * display screen
          CALL      CIHD0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRHD0000                      * Post
          GOTO      IOPT9999
.
. Incremental Numbers
.
IOPT0600  CALL      DIIN0000                      * display screen
          CALL      CIIN0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRIN0000                      * Post
          GOTO      IOPT9999
.
. Using files
.
IOPT0700  CALL      DIUF0000                      * display screen
          CALL      CIUF0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRUF0000                      * Post
          GOTO      IOPT9999
.
. U/R Based details
.
IOPT0800  CALL      DIUR0000                      * display screen
          CALL      CIUR0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRUR0000                      * Post
          GOTO      IOPT9999
.
. PMI fields
.
IOPT0900  CALL      DIPM0000                      * display screen
          CALL      CIPM0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRPM0000                      * Post
          GOTO      IOPT9999
.
. Financial 1
.
IOPT1000  CALL      DI1F0000                      * display screen
          CALL      CI1F0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WR1F0000                      * Post
          GOTO      IOPT9999
.
. Financial 2
.
IOPT1100  CALL      DI2F0000                      * display screen
          CALL      CI2F0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WR2F0000                      * Post
          GOTO      IOPT9999
.
. Labels/Id sheets
.
IOPT1200  CALL      DILI0000                      * display screen
          CALL      CILI0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRLI0000                      * Post
          GOTO      IOPT9999
.
. Invoices
.
IOPT1300  CALL      DIIV0000                      * display screen
          CALL      CIIV0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRIV0000                      * Post
          GOTO      IOPT9999
.
. Comments
.
IOPT1400  CALL      DICO0000                      * display screen
          CALL      CICO0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRCO0000                      * Post
          GOTO      IOPT9999
.
. Length of stay details
.
IOPT1500  CALL      DILS0000                      * display screen
          CALL      CILS0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRLS0000                      * Post
          GOTO      IOPT9999
.
. Admission based details
.
IOPT1600  CALL      DIAD0000                      * display screen
          CALL      CIAD0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRAD0000                      * Post
          GOTO      IOPT9999
.
. Miscellaneous details 1
.
IOPT1700  CALL      DIMS0000                      * display screen
          CALL      CIMS0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRMS0000                      * Post
          GOTO      IOPT9999
.
. Miscellaneous details 2
.
IOPT1800  CALL      DIMC0000                      * display screen
          CALL      CIMC0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRMC0000                      * Post
          GOTO      IOPT9999
.
. Screen Painter
.
IOPT1900  CALL      DISP0000                      * display screen
          CALL      CISP0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRSP0000                      * Post
          GOTO      IOPT9999
.
. Quotes
.
IOPT2000  CALL      DIQU0000                      * display screen
          CALL      CIQU0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRQU0000                      * Post
          GOTO      IOPT9999
.
. PMI fields 2
.
IOPT2100  CALL      DIP20000                      * display screen
          CALL      CIP20000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRP20000                      * Post
          GOTO      IOPT9999
.
. Hong Kong National Interface
.
IOPT2200  CALL      DHKI0000                      * display screen
          CALL      CHKI0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WHKI0000                      * Post
          GOTO      IOPT9999
.
. Singapore Interface
.
IOPT2300  CALL      DSSI0000                      * display screen
          CALL      CHSI0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WSSI0000                      * Post
          GOTO      IOPT9999
.
. Singapore Interface
.
IOPT2400  CALL      DSAI0000                      * display screen
          CALL      CSAI0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WSAI0000                      * Post
          GOTO      IOPT9999
.
. IBA Controlled PRS/2 Screen 1
.
IOPT2500  CALL      DISPSCR1                 * Display screen & data
          CALL      UPPSCR1                  * Alter parameters
          BRANCH    EXIT,IOPT9999            * No changes - reenter menu
          CALL      WRIBAP1                  * Update changes
          GOTO      IOPT9999                 * Reenter menu
.
. Interface Engine Set Up
.
IOPT2600  CALL      DDGA0000                 * Display Sub-menu         I-90203
          GOTO      IOPT9999                 * Reenter menu
. ------------------------------------------ Start of removed code      D-90203
.--IOPT2600  CALL      DDGT0000                 * Display screen & data
.--          CALL      CDGT0000                 * Alter parameters
.--          BRANCH    EXIT,IOPT9999            * No changes - reenter menu
.--          CALL      WDGT0000                 * Update changes
.--          GOTO      IOPT9999                 * Reenter menu
. ------------------------------------------ End of removed code        D-90203
.
. State based PMI screens   
.
IOPT2700  CALL      DISB0000                 * Display screen & data
          CALL      CHSB0000                 * Alter parameters
          BRANCH    EXIT,IOPT9999            * No changes - reenter menu
          CALL      WRSB0000                 * Update changes
          GOTO      IOPT9999                 * Reenter menu
.
. Miscellaneous details 3
.
IOPT2800  CALL      DINC0000                      * display screen
          CALL      CINC0000                      * change fields
          BRANCH    EXIT,IOPT9999                 * Cancel selected
          CALL      WRNC0000                      * Post
          GOTO      IOPT9999
.
IOPT9999  RETURN
+
.***********************************************************************
.*  DIHS0000  :  Display Hospital Based details screen                 *
.***********************************************************************
.
DIHS0000  READ      CONTROLF,ZERO;*43,IBCNMHOS        * Multi Hosp Indicator
.
          READ      CONTROLF,TEN;*244,CHOSPNUM        * Unique Hospital Id
.
          READ      CONTROLF,TEN3;*245,CHOSTYP        * Hospital Type
.
          READ      CONTROLF,FIFTY9;*37,CTYPCHG:      * Charging Type
                                    *64,CUSENOTE:     * Multi Hosp Case Notes
                                    *87,CHUTTCN:      * Unique Hutt Identifier
                                    *91,CTYPREP:      * Reporting Layout
                                    *235,PTCNPREG     * Using Patient Reg Scrn
          READ      CONTROLF,HUND03;*43,PTCNDFIN      * Day Facility Indicator
.
          MOVE      DNO,DDANS2
          LOAD      DDANS2,CUSENOTE,DYES,DNO          * Multi Hosp Case Notes
          MOVE      DNO,DDANS3
          LOAD      DDANS3,PTCNPREG,DYES,DNO          * Using Patient Reg Scrn
          MOVE      DNO,DDANS4
          LOAD      DDANS4,IBCNMHOS,DYES,DNO          * Multi Hosp Indicator
.
          MOVE      DHOSTYP0,DDESC1                   * Hospital Type
          LOAD      DDESC1,CHOSTYP,DHOSTYP1
.
          MOVE      DSYST0,DDESC2                     * Charging Type
          LOAD      DDESC2,CTYPCHG,DSYST1,DSYST2
.
          PACK      KEY2,CHOSPNUM                     * Unique Hospital Id
          CALL      RDHOSP2
          IF        OVRCD=0
            MOVE      HOSDESC,DDESC3
          ELSE
            MOVE      SP30,DDESC3
          ENDIF
.
          MOVE      DREPT0,DDESC4                     * Reporting Layout
          LOAD      DDESC4,CTYPREP,DREPT1
.
          PACK      KEY4,CHUTTCN
          CALL      RDHOSP1
          IF        OVRCD=1
            MOVE      SP30,DDESC5
          ELSE
            MOVE      HOSDESC,DDESC5
          ENDIF
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,PTCNDFIN,DYES            * Day Facility Indicator
.
          DISPLAY   *P54:2,*V2LON,"- Hospital details ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". (No longer used)":
                    *P1:05,*V2LON," 2",*HOFF,". (No longer used)":
                    *P1:06,*V2LON," 3",*HOFF,". (No longer used)":
                    *P1:07,*V2LON," 4",*HOFF,". Hospital Type":
                    *P1:08,*V2LON," 5",*HOFF,". Charging Type":
                    *P1:09,*V2LON," 6",*HOFF,". (No longer used)":
                    *P1:10,*V2LON," 7",*HOFF,". Unique Hospital Id (from":
                    " PATHOSPF)":
                    *P1:11,*V2LON," 8",*HOFF,". (No longer used)":
                    *P1:12,*V2LON," 9",*HOFF,". Multihospital Case Notes":
                    " Display":
                    *P1:13,*V2LON,"10",*HOFF,". Reporting Layout":
                    *P1:14,*V2LON,"11",*HOFF,". Unique Identifier for":
                    " Hutt Hosp":
                    *P1:15,*V2LON,"12",*HOFF,". Using Patient Regist. ":
                    "Screen",*HOFF:
                    *P1:16,*V2LON,"13",*HOFF,". Multi Hospital Indicator ":
                    *P1:17,*V2LON,"14",*HOFF,". Day Facility (Y/N) ?":
                    *P42:04,": ":
                    *P42:05,": ":
                    *P42:06,": ":
                    *P42:07,": ",*V2LON,DDESC1,*HOFF:
                    *P42:08,": ",*V2LON,DDESC2,*HOFF:
                    *P42:09,": ":
                    *P42:10,": ",*V2LON,DDESC3,*HOFF:
                    *P42:11,": ":
                    *P42:12,": ",*V2LON,DDANS2,*HOFF:
                    *P42:13,": ",*V2LON,DDESC4,*HOFF:
                    *P42:14,": ",*V2LON,DDESC5,*HOFF:
                    *P42:15,": ",*V2LON,DDANS3,*HOFF:
                    *P42:16,": ",*V2LON,DDANS4,*HOFF:
                    *P42:17,": ",*V2LON,DDANS1,*HOFF
.
DIHS9999  RETURN
+
.***********************************************************************
.*  DISI0000  :  Display Systems/Interfaces details screen             *
.***********************************************************************
.
DISI0000  READ      CONTROLF,TEN;*18,PTCNP31G:        * Gen Pre-Adm in PAT31
                                 *19,PTCNP31M:        * MH Pre-Adm in PAT31
                                 *20,PTCNH31G:        * Gen Pre-Adm in HOS31
                                 *21,PTCNH31M:        * MH Pre-Adm in HOS31
                                 *22,PTCNMHBK:        * MH Booking Option
                                 *160,CMEDSERV:       * Using Medical Services
                                 *166,CMEMB:          * Using Membership
                                 *194,CDIETCD         * Using Meal Menu
.
          READ      CONTROLF,TEN3;*243,CACCLSS        * Using Cat. AC
.
          READ      CONTROLF,TEN5;*187,CBOOKG:        * Using Bookings
                                  *188,CMATRN:        * Using Maternity
                                  *189,CTHETR         * Using Theatre
.
          READ      CONTROLF,TEN8;*162,CGLIND:        * General Ledger Interface
                                  *163,CGLPATH        * General Ledger Path Name
.
          READ      CONTROLF,SEVENTY7;*213,PTCNCRPT   * Central Cash Receipting
                                                      * for Inpatients
.
. SOGGY YOU SPANNER THESE VARS ARE IN SECTOR 20 NOT 21
.
          READ      CONTROLF,TWENTY;*190,PTCNIR31     * Bill/RUS in HOS31
.
          READ      CONTROLF,FIFTY9;*60,PTCNUFMS:     * using FMS
                                    *86,CDETENTE:     * Detente Interface
                                    *92,CDETPATH      * Detente Audit File Path
.
          READ      CONTROLF,NINTY8;*86,PTCNCPTH      * G/L Control File Path
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,CDIETCD,DYES,DNO            * Using Meal Menu
          MOVE      DNO,DDANS2
          LOAD      DDANS2,CMEMB,DYES,DNO              * Using Membership
          MOVE      DNO,DDANS3
          LOAD      DDANS3,CACCLSS,DYES,DNO            * Using Cat. AC
          MOVE      DNO,DDANS4
          LOAD      DDANS4,CMEDSERV,DYES,DNO           * Using Medical Services
          MOVE      DNO,DDANS5
          LOAD      DDANS5,CBOOKG,DYES,DNO             * Using Bookings
          MOVE      DNO,DDANS6
          LOAD      DDANS6,CMATRN,DYES,DNO             * Using Maternity
          MOVE      DNO,DDANS7
          LOAD      DDANS7,CTHETR,DYES,DNO             * Using Theatre
          MOVE      DNO,DDANS9
          LOAD      DDANS9,PTCNIR31,DYES,DNO           * Bill/RUS Int in HOS31
          MOVE      DNO,DDANS10
          LOAD      DDANS10,CGLIND,DYES,DNO            * General Ledger Interface
          MOVE      DNO,DDANS11
          LOAD      DDANS11,CDETENTE,DYES,DNO          * Detente Interface
          MOVE      DNO,DDANS12
          LOAD      DDANS12,PTCNP31G,DYES,DNO          * Gen Pre-Adm in PAT31
          MOVE      DNO,DDANS13
          LOAD      DDANS13,PTCNP31M,DYES,DNO          * MH Pre-Adm in PAT31
          MOVE      DNO,DDANS14
          LOAD      DDANS14,PTCNH31G,DYES,DNO          * Gen Pre-Adm in HOS31
          MOVE      DNO,DDANS15
          LOAD      DDANS15,PTCNH31M,DYES,DNO          * MH Pre-Adm in HOS31
          MOVE      DNO,DDANS16
          LOAD      DDANS16,PTCNMHBK,DYES,DNO          * MH Booking Option
.
          MOVE      DNO,DDANS17                        * Centralised Cash
.                                                      * Recieipting for
          LOAD      DDANS17,PTCNCRPT,DYES,DNO          * Inpatients option
          MOVE      SP70,DDESC1
          MOVE      DNO,DDESC1
          LOAD      DDESC1,PTCNUFMS,FMSIBA,FMSOTH      * Using FMS
.
          DISPLAY   *P54:2,*V2LON,"- System/Interfaces 1 details ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". Using Meal Menu System":
                    *P1:05,*V2LON," 2",*HOFF,". Using Membership":
                    *P1:06,*V2LON," 3",*HOFF,". Using Category AC":
                    *P1:07,*V2LON," 4",*HOFF,". Using Medical Services":
                    *P1:08,*V2LON," 5",*HOFF,". Using Booking System":
                    *P1:09,*V2LON," 6",*HOFF,". Using Maternity System":
                    *P1:10,*V2LON," 7",*HOFF,". Using Theatre System":
                    *P1:11,*V2LON," 8",*HOFF,". Bill/RUS Interface in HOS31":
                    *P1:12,*V2LON," 9",*HOFF,". Running General Ledger ":
                           "Interface":
                    *P1:13,*V2LON,"10",*HOFF,". General Ledger Path Name":
                    *P1:14,*V2LON,"11",*HOFF,". Gen. Ledger Control File Path":
                    *P1:15,*V2LON,"12",*HOFF,". Detente Interface":
                    *P1:16,*V2LON,"13",*HOFF,". Detente Audit File Path":
                    *P1:17,*V2LON,"14",*HOFF,". General Inp. Pre-Adm. in PAT31":
                    *P1:18,*V2LON,"15",*HOFF,". MH Inp. Pre-Adm. in PAT31":
                    *P1:19,*V2LON,"16",*HOFF,". General Inp. Pre-Adm. in HOS31":
                    *P1:20,*V2LON,"17",*HOFF,". MH Inp. Pre-Adm. in HOS31":
                    *P1:21,*V2LON,"18",*HOFF,". MH Booking Option":
                    *P1:22,*V2LON,"19",*HOFF,". Using Centralised Cash for ":
                           "Inpatients":
                    *P1:23,*V2LON,"20",*HOFF,". Using FMS system (IBAPIN01)":
                    *P42:04,": ",*V2LON,DDANS1,*HOFF:
                    *P42:05,": ",*V2LON,DDANS2,*HOFF:
                    *P42:06,": ",*V2LON,DDANS3,*HOFF:
                    *P42:07,": ",*V2LON,DDANS4,*HOFF:
                    *P42:08,": ",*V2LON,DDANS5,*HOFF:
                    *P42:09,": ",*V2LON,DDANS6,*HOFF:
                    *P42:10,": ",*V2LON,DDANS7,*HOFF:
                    *P42:11,": ",*V2LON,DDANS9,*HOFF:
                    *P42:12,": ",*V2LON,DDANS10,*HOFF:
                    *P42:13,": ",*V2LON,CGLPATH,*HOFF:
                    *P42:14,": ",*V2LON,PTCNCPTH,*HOFF:
                    *P42:15,": ",*V2LON,DDANS11,*HOFF:
                    *P42:16,": ",*V2LON,CDETPATH,*HOFF:
                    *P42:17,": ",*V2LON,DDANS12,*HOFF:
                    *P42:18,": ",*V2LON,DDANS13,*HOFF:
                    *P42:19,": ",*V2LON,DDANS14,*HOFF:
                    *P42:20,": ",*V2LON,DDANS15,*HOFF:
                    *P42:21,": ",*V2LON,DDANS16,*HOFF:
                    *P42:22,": ",*V2LON,DDANS17,*HOFF:
                    *P42:23,": ",*V2LON,DDESC1,*HOFF
 
.
DISI9999  RETURN
.
+
.***********************************************************************
.*  DS2I0000  :  Display Systems/Interfaces  2 details screen          *
.***********************************************************************
.
DS2I0000  READ      CONTROLF,TWENTY1;*138,PTCNNHII,PTCNNHID,*191,PTCNNHIF:
                                     *204,PTCNAWRN,*240,PTCNEDIF
          READ      CONTROLF,SEVENTY7;*45,PTCNNZED
          READ      CONTROLF,SEVENTY9;*33,PTCNSEND
          READ      CONTROLF,EIGHTY;*138,PTCNNZUR,PTCNNUMH,*223,PTCNNXTT
          READ      CONTROLF,HUND10;*115,PTCNUEDI
+
          MOVE      DNO,DDANS1
          LOAD      DDANS1,PTCNNHII,DYES,DNO            * Using Meal Menu
.
          MOVE      ALRTONLY,ALRTDESC
          LOAD      ALRTDESC,PTCNAWRN,ALRTWARN,WARNONLY
.
          MOVE      DNO,DDANS7
          LOAD      DDANS7,PTCNNZUR,DYES,DNO
.
          MOVE      PTCNNXTT,KEY6
          REP       " 0",KEY6
.
          MOVE      DNO,DDANS8
          LOAD      DDANS8,PTCNNUMH,DYES,DNO
.
          MOVE      DNO,DDANS9
          LOAD      DDANS9,PTCNUEDI,DYES,DNO
.
          DISPLAY   *P54:2,*V2LON,"- System/Interfaces 2 details ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". Using NZHIS Interface ":
                    *P1:05,*V2LON," 2",*HOFF,". NZHIS Interface FIFO Directory":
                    *P1:06,*V2LON," 3",*HOFF,". NZHIS Interface Master File Name":
                    *P1:07,*V2LON," 4",*HOFF,". Which Alerts system is being":
                    " used ?":
                    *P1:08,*V2LON," 5",*HOFF,". NZEDI extract directory":
                    *P1:09,*V2LON," 6",*HOFF,". EDI interface extract file ":
                           "number":
                    *P1:10,*V2LON," 7",*HOFF,". Storing NMPI in U/R field? ":
                    *P1:11,*V2LON," 8",*HOFF,". NMPI = UR and Multi Hospital":
                                               "/Control files":
                    *P1:12,*V2LON," 9",*HOFF,". Next Temporary NMPI Number":
                    *P1:13,*V2LON,"10",*HOFF,". EDI Sending Facility":
                    *P1:14,*V2LON,"11",*HOFF,". Using Electronic Claiming":
.
                    *P42:4,": ",*V2LON,DDANS1,*HOFF:
                    *P42:5,": ",*V2LON,PTCNNHID,*HOFF:
                    *P42:6,": ",*V2LON,PTCNNHIF,*HOFF:
                    *P42:7,": ",*V2LON,ALRTDESC,*HOFF:
                    *P28:8,": ",*V2LON,PTCNNZED,*HOFF:
                    *P42:9,": ",*V2LON,PTCNEDIF,*HOFF:
                    *P42:10,": ",*V2LON,DDANS7,*HOFF:
                    *P42:11,": ",*V2LON,DDANS8,*HOFF:
                    *P42:12,": ",*V2LON,"T-",KEY6,*HOFF:
                    *P42:13,": ",*V2LON,PTCNSEND,*HOFF:
                    *P42:14,": ",*V2LON,DDANS9,*HOFF
.
DS2I9999  RETURN
.
.***********************************************************************
.*  DIME0000  :  Display Menu details screen                           *
.***********************************************************************
.
DIME0000  DISPLAY   *P54:2,*V2LON,"- Menu Details ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". (No longer used)",*P42:04,": ":
                    *P1:05,*V2LON," 2",*HOFF,". (No longer used)",*P42:05,": ":
                    *P1:06,*V2LON," 3",*HOFF,". (No longer used)",*P42:06,": ":
                    *P1:07,*V2LON," 4",*HOFF,". (No longer used)",*P42:07,": ":
                    *P1:08,*V2LON," 5",*HOFF,". (No longer used)",*P42:08,": ":
                    *P1:09,*V2LON," 6",*HOFF,". (No longer used)",*P42:09,": ":
                    *P1:10,*V2LON," 7",*HOFF,". (No longer used)",*P42:10,": ":
                    *P1:11,*V2LON," 8",*HOFF,". (No longer used)",*P42:11,": "
DIME9999  RETURN
+
.***********************************************************************
.*  DIHD0000  :  Display HDP/HCS Details Screen                        *
.***********************************************************************
.
DIHD0000  READ      CONTROLF,EIGHTY8;*86,CDAILYDT      * Last Govt. Susbidy Run
.
          READ      CONTROLF,TEN3;*187,CUSEHCS:       * Using HCS system for HDP
                                  *203,CHCSUNIQ:      * HDP Transaction Number
                                  *244,CHCS           * Collecting HDP Data
.
          READ      CONTROLF,EIGHTY8;*116,CHCSDTE         * Start Date for HDP
.
          READ      CONTROLF,TWENTY;*51,PTCNPRSB:     * Patient Billing Menu
                                    *79,PTCNHSSN      * Patient Syst Manag Menu
.
          READ      CONTROLF,FIFTY9;*221,PTCNBFHD:    * Using Bed Fee Equiv.
                                    *222,PTCNFNHD:    * Using H/Fund Equiv.
                                    *232,PTHCSDOC     * HCS Doctor Mandatory
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,CHCS,DYES,DNO               * Collecting HDP Data
.
          MOVE      DNO,DDANS2
          LOAD      DDANS2,CUSEHCS,DYES,DNO            * Using HCS of Transm.
.
          MOVE      DNO,DDANS3
          LOAD      DDANS3,PTCNBFHD,DYES,DNO           * Using Bed Fee Equiv.
.
          MOVE      DNO,DDANS4
          LOAD      DDANS4,PTCNFNHD,DYES,DNO           * Using H/Fund Equiv.
.
          MOVE      DNO,DDANS5
          LOAD      DDANS5,PTHCSDOC,DYES,DNO           * HCS Doctor Mandatory
.
          MOVE      DNO,DDANS6
          LOAD      DDANS6,PTCNPRSB,DYES,DNO           * PATBFEE in PRS2 Vald.
.
          UNPACK    CHCSDTE,CCENT,CYEAR,CMON,CDAY      * Start Date HDP Data
          CALL      PACDATE
          PACK      DDATE1,CPCDATE,SP30
.
          UNPACK    CDAILYDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PACK      DDATE2,CPCDATE,SP30
.
          DISPLAY   *P54:2,*V2LON,"- HDP/HCS Details ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". HDP Last Transaction Number":
                    *P1:05,*V2LON," 2",*HOFF,". Collecting HDP Data":
                    *P1:06,*V2LON," 3",*HOFF,". Starting Data for HDP Data":
                    *P1:07,*V2LON," 4",*HOFF,". (No longer used)":
                    *P1:08,*V2LON," 5",*HOFF,". Using HCS System of HDP ":
                                             "Transmission":
                    *P1:09,*V2LON," 6",*HOFF,". Using Bed Fees HDP Equivalent":
                    *P1:10,*V2LON," 7",*HOFF,". Using Health Fund HDP ":
                                             "Equivalent":
                    *P1:11,*V2LON," 8",*HOFF,". HCS Doctor Mandatory":
                    *P1:12,*V2LON," 9",*HOFF,". Last HSS Tape Number for New ":
                                             "Zealand":
                    *P1:13,*V2LON,"10",*HOFF,". Last Date Government Subsidy ":
                                             "Run":
                    *P1:14,*V2LON,"11",*HOFF,". Using PATBFEE for PRS2 ":
                                             "Validation":
                    *P42:04,": ",*V2LON,CHCSUNIQ,*HOFF:
                    *P42:05,": ",*V2LON,DDANS1,*HOFF:
                    *P42:06,": ",*V2LON,DDATE1,*HOFF:
                    *P42:07,": ":
                    *P42:08,": ",*V2LON,DDANS2,*HOFF:
                    *P42:09,": ",*V2LON,DDANS3,*HOFF:
                    *P42:10,": ",*V2LON,DDANS4,*HOFF:
                    *P42:11,": ",*V2LON,DDANS5,*HOFF:
                    *P42:12,": ",*V2LON,PTCNHSSN,*HOFF:
                    *P42:13,": ",*V2LON,DDATE2,*HOFF:
                    *P42:14,": ",*V2LON,DDANS6,*HOFF
.
DIHD9999  RETURN
+
.********************************************************************
.*  DIIN0000  :  Display Incremental Numbers Screen                 *
.*                                                                  *
.********************************************************************
.
DIIN0000  READ      CONTROLF,TEN;*1,NADMNO:           * Next Admission Number
                                 *89,CGOVCLIM         * Gov Sub Claim Number
.
          READ      CONTROLF,EIGHTY8;*78,CGADMNO
          READ      CONTROLF,EIGHTY8;*210,CRECPNO 
.
          READ      CONTROLF,TEN8;*9,CMEXTINV:        * Next Med Serv Invoice
                                  *192,CLHFASS:       * Last Claims Ass Number
                                  *217,CLHBNO         * Last HB21 Invoice Number
.
          READ      CONTROLF,TWENTY1;*133,PTCNPCSQ    * Next HMS86 File Number
.
          READ      CONTROLF,FIFTY9;*182,PTCNORNO     * Last Order Number
.
          READ      CONTROLF,SEVENTY7;*170,PTCNHIDF:  * From Range HK ID 
                                      *178,PTCNHIDT:  * To Range HK ID 
                                      *186,PTCNHIDN   * Next Generated HK ID
.
          READ      CONTROLF,NINTY5;*153,PTCNQUOT     * Quote number
          READ      CONTROLF,NINTY8;*157,PTCNBTHN     * EDI batch no
.
          READ      CONTROLF,HUND05;*75,PTCNAMUI      * ACT Merge Id       
          READ      CONTROLF,HUND09;*161,PTCNBNUM:    * Batch number       
                                    *196,PTCNCRNO     * Credit Note number
.
          MOVE      NADMNO,SAVADMN                    * Save Admission Number
          MOVE      CRECPNO,SAVRECP                   * Save Receipt Number
.
          DISPLAY   *P54:2,*V2LON,"- Incremental Numbers ",*P1:3,*EF;
          MATCH     "1",PTCNUANV      * Using AN Visit Numbers
          IF        @EQUAL
            DISPLAY   *P1:04,*V2LON," 1",*HOFF,". Not in used          ";
          ELSE
            DISPLAY   *P1:04,*V2LON," 1",*HOFF,". Next Admission Number";
          ENDIF
.
          DISPLAY   *P1:05,*V2LON," 2",*HOFF,". Next Receipt Number":
                    *P1:06,*V2LON," 3",*HOFF,". Next Medical Services Invoice ":                                             "Number":
                    *P1:07,*V2LON," 4",*HOFF,". Last Claim Assesment Number ":
                                             "(Inp)":
                    *P1:08,*V2LON," 5",*HOFF,". Last HB21 Invoice Number":
                    *P1:09,*V2LON," 6",*HOFF,". Last Order Number":
                    *P1:10,*V2LON," 7",*HOFF,". Government Subsidy Claim ":
                                             "Number":
                    *P1:11,*V2LON," 8",*HOFF,". Starting Gov't Subsidy ":
                                             "Admiss. No.":
                    *P1:12,*V2LON," 9",*HOFF,". Next Extraction File No ":
                                             "in IBAHMS86":
                    *P1:13,*V2LON,"10",*HOFF,". Range for Auto. ":
                                             "Generation of H/K Id":
                    *P1:14,*V2LON,"11",*HOFF,". Next National Hong Kong Id ":
                                             "Number":
                    *P1:15,*V2LON,"12",*HOFF,". EDI batch no":
                    *P1:16,*V2LON,"13",*HOFF,". Next ACT Merge Unique Id":
                    *P1:17,*V2LON,"14",*HOFF,". Next Quote number (fees ":
                                             "estimation)":
                    *P1:18,*V2LON,"15",*HOFF,". Next Batch Number       ":
                    *P1:19,*V2LON,"16",*HOFF,". Next Credit Note Number ":
                    *P42:04,": ",*V2LON,NADMNO,*HOFF:
                    *P42:05,": ",*V2LON,CRECPNO,*HOFF:
                    *P42:06,": ",*V2LON,CMEXTINV,*HOFF:
                    *P42:07,": ",*V2LON,CLHFASS,*HOFF:
                    *P42:08,": ",*V2LON,CLHBNO,*HOFF:
                    *P42:09,": ",*V2LON,PTCNORNO,*HOFF:
                    *P42:10,": ",*V2LON,CGOVCLIM,*HOFF:
                    *P42:11,": ",*V2LON,CGADMNO,*HOFF:
                    *P42:12,": ",*V2LON,PTCNPCSQ,*HOFF:
                    *P42:13,": ",*V2LON,PTCNHIDF,*HOFF," to ",*V2LON,PTCNHIDT:
                    *P42:14,*HOFF,": ",*V2LON,PTCNHIDN,*HOFF:
                    *P42:15,": ",*V2LON,PTCNBTHN,*HOFF:
                    *P42:16,": ",*V2LON,PTCNAMUI,*HOFF:
                    *P42:17,": ",*V2LON,PTCNQUOT,*HOFF:
                    *P42:18,": ",*V2LON,PTCNBNUM,*HOFF:
                    *P42:19,": ",*V2LON,PTCNCRNO,*HOFF;
.
DIIN9999  RETURN
.
.********************************************************************
.*  DIUF0000  :  Display Using Files Screen                         *
.*                                                                  *
.********************************************************************
.
DIUF0000  READ      CONTROLF,TEN9;*212,CFEETYP        * Daily Charging File
.
          READ      CONTROLF,TWENTY;*49,PTCNRESB:     * Re-Submit Quest in PAT06
                                    *76,PTCNMSDF:     * PATMSDFD
                                    *186,PTCNUCSL     * Case Note Location File
          READ      CONTROLF,TWENTY1;*121,PTCNUADM    * U/R change for an Adm.
.
          READ      CONTROLF,FIFTY9;*171,PTCNSTAU:    * New Adm & Dsc Stats 1 
                                    *172,PTCNNUMM:    * Monthly Update PATNUMFD
                                    *173,PTCNNEWS:    * New Stats Update
                                    *209,PTCNDAYF:    * Patient Day File
                                    *220,PTCNUADT:    * Adm, Dsc, Trn Dest File
                                    *225,PTCNUURC    * U/R No. Change File
.
          READ      CONTROLF,SEVENTY7;*240,PTCNAXEU   * Using admiss. ext. file
          READ      CONTROLF,SEVENTY9;*248,PTCNIPEN     * Invoice Pending File
          READ      CONTROLF,EIGHTY;*241,PTCNUCGP   * Using Reg Gp changes file
          READ      CONTROLF,HUND05;*177,PTCNTFEE:    * Using theatre fees
                                    *190,PTSGCOPT     * Using suggested class.
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,PTCNUADT,DYES,DNO           * Adm, Dsc, Trn Dest File
          MOVE      DNO,DDANS2
          LOAD      DDANS2,PTCNNUMM,DYES,DNO           * Monthly Update PATNUMFD
          MOVE      DNO,DDANS3
          LOAD      DDANS3,PTCNDAYF,DYES,DNO           * Patient Day File
          MOVE      DNO,DDANS6
          LOAD      DDANS6,PTCNUURC,DYES,DNO           * U/R No. Change File
          MOVE      DNO,DDANS7
          LOAD      DDANS7,PTCNMSDF,DYES,DNO           * PATMSDFD
          MOVE      DNO,DDANS8
          LOAD      DDANS8,PTCNUCSL,DYES,DNO           * Case Note Location File
          MOVE      DNO,DDANS9
          LOAD      DDANS9,PTCNSTAU,DYES,DNO           * New Adm & Dsc Stats 1 
          MOVE      DNO,DDANS10
          LOAD      DDANS10,PTCNNEWS,DYES,DNO          * New Stats Update
          MOVE      DNO,DDANS11
          LOAD      DDANS11,PTCNRESB,DYES,DNO          * Re-Subm Quest in PAT06
          MOVE      DNO,DDANS12
          LOAD      DDANS12,PTCNUADM,DYES,DNO          * U/R Change for An adm.
          MOVE      DNO,DDANS13
          LOAD      DDANS13,PTCNAXEU,DYES,DNO          * Using adm. ext. file
          MOVE      DNO,DDANS14
          LOAD      DDANS14,PTCNUCGP,DYES,DNO          * Using Reg Gp changes?
          MOVE      DYES,DDANS15
          LOAD      DDANS15,PTCNIPEN,DNO               * Using Invoice Pending
          MOVE      DNO,DDANS16
          LOAD      DDANS16,PTCNTFEE,DYES              * Using Theatre fees
          MOVE      DNO,DDANS17
          LOAD      DDANS17,PTSGCOPT,DYES              * Using suggested class.
.
          MOVE      DFEETYP0,DDESC1
          LOAD      DDESC1,CFEETYP,DFEETYP1,DFEETYP2,DFEETYP3:
                                   DFEETYP4,DFEETYP5,DFEETYP6,DFEETYP7:
                                   DFEETYP8,DFEETYP9
.
          DISPLAY   *P54:2,*V2LON,"- Using Files ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". Using Adm Dsc.Transfer Dest.":
                                             "file":
                    *P1:05,*V2LON," 2",*HOFF,". Using Daily Charging File":
                    *P1:06,*V2LON," 3",*HOFF,". Monthly update of PATNUMFD ":
                                             "file":
                    *P1:07,*V2LON," 4",*HOFF,". Using Pat. Day file for Stats":
                    *P1:08,*V2LON," 5",*HOFF,". (No Longer Used)            ":
                    *P1:09,*V2LON," 6",*HOFF,". Using Unadmit/Disch Adm ":
                                             "Change File":
                    *P1:10,*V2LON," 7",*HOFF,". Using U/R No. Change Audit ":
                                             "File":
                    *P1:11,*V2LON," 8",*HOFF,". Using PATMSDFD File":
                    *P1:12,*V2LON," 9",*HOFF,". Using Case Note Location File":
                    *P1:13,*V2LON,"10",*HOFF,". Using New Adm & Dsc stats 1 ":
                                             "Rept":
                    *P1:14,*V2LON,"11",*HOFF,". Using the New Stats Update":
                    *P1:15,*V2LON,"12",*HOFF,". PAT06 NHSC Re-Submit data ":
                                             "Question":
                    *P1:16,*V2LON,"13",*HOFF,". Using U/R change for an ":
                                             "Adm. Audit":
                    *P1:17,*V2LON,"14",*HOFF,". Using Admission Extension File":
                    *P1:18,*V2LON,"15",*HOFF,". Using Registered GP changes":
                                             " file":
                    *P1:19,*V2LON,"16",*HOFF,". Using Invoice Pending File":
                    *P1:20,*V2LON,"17",*HOFF,". Using Theatre fees File   ":
                    *P1:21,*V2LON,"18",*HOFF,". Using Suggested Claasification":
                    *P42:04,": ",*V2LON,DDANS1,*HOFF:
                    *P42:05,": ",*V2LON,DDESC1,*HOFF:
                    *P42:06,": ",*V2LON,DDANS2,*HOFF:
                    *P42:07,": ",*V2LON,DDANS3,*HOFF:
                    *P42:09,": ",*V2LON,"No longer Used",*HOFF:
                    *P42:10,": ",*V2LON,DDANS6,*HOFF:
                    *P42:11,": ",*V2LON,DDANS7,*HOFF:
                    *P42:12,": ",*V2LON,DDANS8,*HOFF:
                    *P42:13,": ",*V2LON,DDANS9,*HOFF:
                    *P42:14,": ",*V2LON,DDANS10,*HOFF:
                    *P42:15,": ",*V2LON,DDANS11,*HOFF:
                    *P42:16,": ",*V2LON,DDANS12,*HOFF:
                    *P42:17,": ",*V2LON,DDANS13,*HOFF:
                    *P42:18,": ",*V2LON,DDANS14,*HOFF:
                    *P42:19,": ",*V2LON,DDANS15,*HOFF:
                    *P42:20,": ",*V2LON,DDANS16,*HOFF:
                    *P42:21,": ",*V2LON,DDANS17,*HOFF
.
DIUF9999  RETURN
.
.********************************************************************
.*  DIUR0000  :  Display U/R Based Details Screen                   *
.*                                                                  *
.********************************************************************
.
DIUR0000  READ      CONTROLF,TEN;*196,CGENRUR         * U/R No. Generation
.
          READ      CONTROLF,TWENTY;*225,PTCNNMDX:    * Desc for National No.
                                    *237,PTCNNULU     * Show Link for Nat. No.
.
          READ      CONTROLF,TWENTY1;*4,PTCNAUNB:     * Enter U/R in BIL02
                                    *67,PTCNH59V:     * U/R Validation in HOS59
                                    *119,PTCNRPIK:    * Register patient in Kurn
                                    *248,PTCNSOUC     * Security on U/R comments
.
          READ      CONTROLF,FIFTY9;*78,CMERGURS:     * Merging U/R's in PAT02
                                    *234,PTCNNMPI     * Link btw. U/R and Nat.
.
          READ      CONTROLF,SEVENTY7;*10,PTCNULUE:   * Last U/R Entered   
                                      *20,PTCNUVSM:   * Using Visit Summary
                                      *21,PTCNVSDF:   * Vis Sum Display format
                                      *22,PTCNSVOD    * Select Vis Other Datab
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,PTCNAUNB,DYES,DNO           * Enter U/R in BIL02
          MOVE      DNO,DDANS2
          LOAD      DDANS2,CMERGURS,DYES,DNO           * Merging U/R's in BIL02
          MOVE      DNO,DDANS3
          LOAD      DDANS3,PTCNNULU,DYES,DNO           * Show Nqt. No. Link
.
          MOVE      DHGENR0,DDESC2
          LOAD      DDESC2,CGENRUR,DHGENR1,DHGENR2
.
          MOVE      DURLINK0,DDESC3
          LOAD      DDESC3,PTCNNMPI,DURLINK1,DURLINK2,DURLINK3,DURLINK4
.
          MOVE      DURVH590,DDESC4
          LOAD      DDESC4,PTCNH59V,DURVH591
.
          MOVE      DNO,DANS9
          LOAD      DANS9,PTCNRPIK,DYES
.
          MOVE      DNO,DANS10
          LOAD      DANS10,PTCNSOUC,DYES
.
          MOVE      DNO,DANS11
          LOAD      DANS11,PTCNULUE,DYES
.
          MOVE      DNO,DANS12
          LOAD      DANS12,PTCNUVSM,DYES
.
          MOVE      VSDF0,DDESC13
          LOAD      DDESC13,PTCNVSDF,VSDF1
.
          MOVE      DNO,DANS14
          LOAD      DANS14,PTCNSVOD,DYES
.
          MOVE      "Moved to WEB ",DDESC1
.
          DISPLAY   *P54:2,*V2LON,"- U/R Based Details ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". Enter U/R Number in BIL02":
                    *P1:05,*V2LON," 2",*HOFF,". Type of U/R Numbers Used":
                    *P1:06,*V2LON," 3",*HOFF,". Generate U/R's Automatically":
                    *P1:07,*V2LON," 4",*HOFF,". Merging U/R's in IBAPAT02":
                    *P1:08,*V2LON," 5",*HOFF,". Link Between U/R and NMPI":
                    *P1:09,*V2LON," 6",*HOFF:
                    ". Description for National Number":
                    *P1:10,*V2LON," 7",*HOFF:
                    ". Show Link from U/R to National No.":
                    *P1:11,*V2LON," 8",*HOFF,". U/R Validation in IBAHOS59":
                    *P1:12,*V2LON," 9",*HOFF:
                    ". Register Patient option in Kurn":
                    *P1:13,*V2LON,"10",*HOFF,". Security on U/R Comments":
                    *P1:14,*V2LON,"11",*HOFF,". Using Last U/R Entered  ":
                    *P1:15,*V2LON,"12",*HOFF,". Using Visit Summary     ":
                    *P1:16,*V2LON,"13",*HOFF,". Visit Summary Format    ":
                    *P1:17,*V2LON,"14",*HOFF:
                    ". Select Visits from other Databases":
                    *P42:04,": ",*V2LON,DDANS1,*HOFF:
                    *P42:05,": ",*V2LON,DDESC1,*HOFF:
                    *P42:06,": ",*V2LON,DDESC2,*HOFF:
                    *P42:07,": ",*V2LON,DDANS2,*HOFF:
                    *P42:08,": ",*V2LON,DDESC3,*HOFF:
                    *P42:09,": ",*V2LON,PTCNNMDX,*HOFF:
                    *P42:10,": ",*V2LON,DDANS3,*HOFF:
                    *P42:11,": ",*V2LON,DDESC4,*HOFF:
                    *P42:12,": ",*V2LON,DANS9,*HOFF:
                    *P42:13,": ",*V2LON,DANS10,*HOFF:
                    *P42:14,": ",*V2LON,DANS11,*HOFF:
                    *P42:15,": ",*V2LON,DANS12,*HOFF:
                    *P42:16,": ",*V2LON,PTCNVSDF,*HOFF,*P50:16,DDESC13:
                    *P42:17,": ",*V2LON,DANS14,*HOFF
          RETURN
.
.********************************************************************
.*  DIPM0000  :  Display PMI Field Details Screen                   *
.*                                                                  *
.********************************************************************
.
DIPM0000  READ      CONTROLF,TEN;*24,PTCNICAD:        * Input Current Address
                                 *53,CPCONT           * Person to Contact
.
          READ      CONTROLF,TEN9;*210,CPCFORM        * Pat. Cond. Description
.
          READ      CONTROLF,TWENTY1;*14,PTCNCNFA:    * Command for Add Keyin
                                     *53,PTCNRSGS:    * Reverse Surn/Giv
                                     *54,PTCNPCKL:    * Picking List
                                     *55,PTCNDOBS:    * DOB Search
                                     *56,PTCNDEFT:    * Search Param Deft.
                                     *101,PTCNUDRG:   * Using death regist.
                                     *102,PTCNWDTH:   * canc. code for W/L
                                     *105,PTCNIDTH:   * canc. code for IP
                                     *108,PTCNODTH:   * canc. code for OP 
                                     *111,PTCNBDTH:   * canc. code for Bkg
                                     *114,PTCNTDTH    * canc. code for OPR
.
          READ      CONTROLF,FIFTY9;*59,CPOSTCD:      * NZ or Aust Post Code
                                    *231,PTCNRGNS     * Reverse Givename Search
.
          MOVE      DNO,DDANS2
          LOAD      DDANS2,PTCNRGNS,DYES,DNO           * Reverse Givename Search
          MOVE      DNO,DDANS3
          LOAD      DDANS3,PTCNICAD,DYES,DNO           * Input Current Address
          MOVE      DNO,DDANS4
          LOAD      DDANS4,PTCNRSGS,DYES,DNO           * Reverse Surn/Giv Search
          MOVE      DNO,DDANS5
          LOAD      DDANS5,PTCNPCKL,DYES,DNO           * Dual Line picking List
          MOVE      DNO,DDANS6
          LOAD      DDANS6,PTCNDOBS,DYES,DNO           * Using DOB Search
          MOVE      DNO,DDANS7
          LOAD      DDANS7,PTCNDEFT,DYES,DNO           * Default Search Param
.
          MOVE      SP30,DDESC1
          LOAD      DDESC1,CPCONT,DCPCONT1,DCPCONT2
.
          MOVE      DPCOND0,DDESC2
          LOAD      DDESC2,CPCFORM,DPCOND1
.
          MOVE      DPOSTCD0,DDESC3
          LOAD      DDESC3,CPOSTCD,DPOSTCD1
.
          MOVE      DNO,DANS14
          LOAD      DANS14,PTCNUDRG,DYES,DNO           * using death register
.
          MOVE      SP20,DESC20A
          MOVE      SP20,DESC20B
          MOVE      SP20,DESC20C
          MOVE      SP20,DESC20D
          MOVE      SP20,DESC20E
          MATCH     SP3,PTCNWDTH
          IF        !@EQUAL
             PACK      KEY5,CODEWR,PTCNWDTH
             CALL      RDCODE1
             MOVE      TDESC,DESC20A           * w/l cancellation code
          ENDIF
          MATCH     SP3,PTCNIDTH
          IF        !@EQUAL
             PACK      KEY5,CODEPC,PTCNIDTH
             CALL      RDCODE1
             MOVE      TDESC,DESC20B           * i/p cancellation code
          ENDIF
          MATCH     SP3,PTCNODTH
          IF        !@EQUAL
             PACK      KEY5,CODECB,PTCNODTH
             CALL      RDCODE1
             MOVE      TDESC,DESC20C           * o/p cancellation code
          ENDIF
          MATCH     SP3,PTCNBDTH
          IF        !@EQUAL
             PACK      KEY5,CODEBC,PTCNBDTH
             CALL      RDCODE1
             MOVE      TDESC,DESC20D           * bkg cancellation code
          ENDIF
          MATCH     SP3,PTCNTDTH
          IF        !@EQUAL
             PACK      KEY5,CODESC,PTCNTDTH
             CALL      RDCODE1
             MOVE      TDESC,DESC20E           * OPR cancellation code
          ENDIF
.
          DISPLAY   *P54:2,*V2LON,"- PMI Fields ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". (No Longer in use)          ":
                    *P1:05,*V2LON," 2",*HOFF,". Not Applicable                ":
                    *P1:06,*V2LON," 3",*HOFF,". Person to Contact":
                    *P1:07,*V2LON," 4",*HOFF,". Patient Condition Description ":
                                             "Format":
                    *P1:08,*V2LON," 5",*HOFF,". NZ or Australian Post Codes":
                    *P1:09,*V2LON," 6",*HOFF,". (No Longer in use)     ":
                    *P1:10,*V2LON," 7",*HOFF,". Reverse Given Name Search ":
                                             "Required":
                    *P1:11,*V2LON," 8",*HOFF,". Input Patients Current Address":
                    *P1:12,*V2LON," 9",*HOFF,". (No Longer Used)         ":
                                             "      ":
                    *P1:13,*V2LON,"10",*HOFF,". Using Swap Surname/Given Name ":
                                             "Search":
                    *P1:14,*V2LON,"11",*HOFF,". Dual Line Picking List in ":
                                             "Surn Srch":
                    *P1:15,*V2LON,"12",*HOFF,". Using DOB Search":
                    *P1:16,*V2LON,"13",*HOFF,". Default Search Details for ":
                                             "New U/R":
                    *P1:17,*V2LON,"14",*HOFF,". Using Death Registration   ":
                                             "       ":
                    *P1:18,*V2LON,"15",*HOFF,". Cancellation code for W/L f":
                                             "or death":
                    *P1:19,*V2LON,"16",*HOFF,". Cancellation code for I/P f":
                                             "or death":
                    *P1:20,*V2LON,"17",*HOFF,". Cancellation code for O/P f":
                                             "or death":
                    *P1:21,*V2LON,"18",*HOFF,". Cancellation code for Bkg f":
                                             "or death":
                    *P1:22,*V2LON,"19",*HOFF,". Cancellation code for OPR f":
                                             "or death":
                    *P42:05,": ",*V2LON,PTCNCNFA,*HOFF:
                    *P42:06,": ",*V2LON,DDESC1,*HOFF:
                    *P42:07,": ",*V2LON,DDESC2,*HOFF:
                    *P42:08,": ",*V2LON,DDESC3,*HOFF:
                    *P42:09,": ":                     
                    *P42:10,": ",*V2LON,DDANS2,*HOFF:
                    *P42:11,": ",*V2LON,DDANS3,*HOFF:
                    *P42:12,": ":
                    *P42:13,": ",*V2LON,DDANS4,*HOFF:
                    *P42:14,": ",*V2LON,DDANS5,*HOFF:
                    *P42:15,": ",*V2LON,DDANS6,*HOFF:
                    *P42:16,": ",*V2LON,DDANS7,*HOFF:
                    *P42:17,": ",*V2LON,DANS14,*HOFF:
                    *P42:18,": ",*V2LON,DESC20A,*HOFF:
                    *P42:19,": ",*V2LON,DESC20B,*HOFF:
                    *P42:20,": ",*V2LON,DESC20C,*HOFF:
                    *P42:21,": ",*V2LON,DESC20D,*HOFF:
                    *P42:22,": ",*V2LON,DESC20E,*HOFF
          RETURN
.
.********************************************************************
.*  DI1F0000  :  Display Financial Parameters Screen 1              *
.*                                                                  *
.********************************************************************
.
DI1F0000  READ      CONTROLF,EIGHTY8;*94,CLACDATE
          READ      CONTROLF,EIGHTY8;*102,CFEEDT
          READ      CONTROLF,TEN;*192,CACCFEE         * Accum. of Bed Fees
.
          READ      CONTROLF,TEN3;*185,CATBLAY        * Full Report IN A.T.B.
          READ      CONTROLF,EIGHTY8;*110,UPMONTH 
.
          READ      CONTROLF,TEN8;*255,CJRNREP        * Date of Journal
.
          READ      CONTROLF,TEN9;*215,CMCNOHF        * Using HF in Misc. Chargs
.
          READ      CONTROLF,EIGHTY8;*162,PTCFEEOF     * From Date Fees Inv (OF)
          READ      CONTROLF,TWENTY;*239,PTCNMXCH     * Maximum Charge (For HK)
.
          READ      CONTROLF,FIFTY9;*24,CFUTENQ:      * Future Action on Enq.
                                    *27,CPERMTH:      * Using word Period/Month
                                    *33,CPRTREC:      * Print Rec in BIL21
                                    *127,COTHSFN:     * Oth Fin Opt in PATSELFN
                                    *128,CREBPORT:    * Rebate Port Required Flg
                                    *174,PTCNNDAT:    * Next Daily Update Date
                                    *226,CCARECL
          READ      CONTROLF,EIGHTY8;*194,PTCFEEAE: 
                                    *202,PTCFEEOP  
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,CFUTENQ,DYES,DNO            * Future Action on Enq.
          MOVE      DYES,DDANS2
          LOAD      DDANS2,CPRTREC,DNO                 * Print Receipt in BIL21
          MOVE      DNO,DDANS3
          LOAD      DDANS3,COTHSFN,DYES,DNO            * Other Fin Opt PATSELFN
          MOVE      DNO,DDANS4
          LOAD      DDANS4,CCARECL,DYES,DNO            * Dateable Care Class
          MOVE      DNO,DDANS5
          LOAD      DDANS5,CMCNOHF,DYES,DNO            * Using HF in Misc. Chrgs
          MOVE      DNO,DDANS6
          LOAD      DDANS6,CREBPORT,DYES,DNO           * Rebate Port Req. Flg
.
          UNPACK    CFEEDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PACK      DDATE2,CPCDATE,SP30
.
          UNPACK    CLACDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PACK      DDATE3,CPCDATE,SP30
.
          UNPACK    UPMONTH,CCENT,CYEAR,CMON      
          MOVE      "99",CDAY
          CALL      PACDATE
          UNPACK    CPCDATE,ANS,ANS,ANS,DDATE4
          PACK      DDATE4,DDATE4,SP30
.
          UNPACK    PTCFEEAE,CCENT,CYEAR,CMON,CDAY    
          CALL      PACDATE
          PACK      DDATE5,CPCDATE,SP30
.
          UNPACK    PTCFEEOP,CCENT,CYEAR,CMON,CDAY   * From Date Fees Inv Out
          CALL      PACDATE
          PACK      DDATE6,CPCDATE,SP30
.
          UNPACK    PTCFEEOF,CCENT,CYEAR,CMON,CDAY   * From Date Fees Inv OF
          CALL      PACDATE
          PACK      DDATE7,CPCDATE,SP30
.
          UNPACK    PTCNNDAT,CCENT,CYEAR,CMON,CDAY    * Date for next Daily Upd
          CALL      PACDATE
          PACK      DDATE8,CPCDATE,SP30
.
          MOVE      DHCLAM0,DDESC1
          LOAD      DDESC1,CACCFEE,DHCLAM1,DHCLAM2,DHCLAM3,DHCLAM4,DHCLAM9
.
          MOVE      DATBLY0,DDESC2
          LOAD      DDESC2,CATBLAY,DATBLY1,DATBLY2,DATBLY3,DATBLY4,DATBLY5
.
          MOVE      DJRNAL1,DDESC3
          LOAD      DDESC3,CJRNREP,DJRNAL1,DJRNAL2
.
          DISPLAY   *P54:2,*V2LON,"- Financial Parameters 1 ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". No Longer In Use":
                    *P1:05,*V2LON," 2",*HOFF,". From Date for Fees Invoiced ":
                                             "Report":
                    *P1:06,*V2LON," 3",*HOFF,". Last Acc. Date for Old Debts":
                    *P1:07,*V2LON," 4",*HOFF,". Next Operating Monthly Update":
                    *P1:08,*V2LON," 5",*HOFF,". Using the Word Period or Month":
                    *P1:09,*V2LON," 6",*HOFF,". Accumulation of Fees Invoiced":
                    *P1:10,*V2LON," 7",*HOFF,". Full Report in Aged Trial ":
                                             "Balance":
                    *P1:11,*V2LON," 8",*HOFF,". Future Acton when doing ":
                                             "Enquiry":
                    *P1:12,*V2LON," 9",*HOFF,". Print Receipts in IBABIl21":
                    *P1:13,*V2LON,"10",*HOFF,". Other Financial Opt in ":
                                             "PATSELFN":
                    *P1:14,*V2LON,"11",*HOFF,". Dateable Care Class":
                    *P1:15,*V2LON,"12",*HOFF,". From Date for Fees Inv":
                                             "Report (A&E)":
                    *P1:16,*V2LON,"13",*HOFF,".                       ":
                                             "       (O/P)":
                    *P1:17,*V2LON,"14",*HOFF,".                       ":
                                             "(Other Fin.)":
                    *P1:18,*V2LON,"15",*HOFF,". Maximum Charge For Patient":
                    *P1:19,*V2LON,"16",*HOFF,". Not Using H/Fund in Misc ":
                                             "Charges":
                    *P1:20,*V2LON,"17",*HOFF,". Date of Journal":
                    *P1:21,*V2LON,"18",*HOFF,". Rebate Portion Required Flag":
                    *P1:22,*V2LON,"19",*HOFF,". Date for Next Daily Update":
                    *P42:05,": ",*V2LON,DDATE2,*HOFF:
                    *P42:06,": ",*V2LON,DDATE3,*HOFF:
                    *P42:07,": ",*V2LON,DDATE4,*HOFF:
                    *P42:08,": ",*V2LON,CPERMTH,*HOFF:
                    *P42:09,": ",*V2LON,DDESC1,*HOFF:
                    *P42:10,": ",*V2LON,DDESC2,*HOFF:
                    *P42:11,": ",*V2LON,DDANS1,*HOFF:
                    *P42:12,": ",*V2LON,DDANS2,*HOFF:
                    *P42:13,": ",*V2LON,DDANS3,*HOFF:
                    *P42:14,": ",*V2LON,DDANS4,*HOFF:
                    *P42:15,": ",*V2LON,DDATE5,*HOFF:
                    *P42:16,": ",*V2LON,DDATE6,*HOFF:
                    *P42:17,": ",*V2LON,DDATE7,*HOFF:
                    *P42:18,": ",*V2LON,PTCNMXCH,*HOFF:
                    *P42:19,": ",*V2LON,DDANS5,*HOFF:
                    *P42:20,": ",*V2LON,DDESC3,*HOFF:
                    *P42:21,": ",*V2LON,DDANS6,*HOFF:
                    *P42:22,": ",*V2LON,DDATE8
.
          RETURN
.
.********************************************************************
.*  DI2F0000  :  Display Financial Parameters Screen 2              *
.*                                                                  *
.********************************************************************
.
DI2F0000  READ      CONTROLF,TEN;*32,PTCNUBRD:        * Input Board in Adm's
                                 *33,PTCNGSTF         * Separate GST in BIL19
          READ      CONTROLF,TWENTY;*50,PTCNADBF:     * Auto Def. in PATBFEE
                                    *164,PTRESDAY:    * Reset Day Count S/Down
                                    *203,PTCNBDOM     * Def Board using P'Code
          READ      CONTROLF,TWENTY1;*60,PTCNCCRR:    * Claim code for ref. rate
                                     *63,PTCNCLOR:    * Calculate loss of rev.
                                     *120,PTCNADDC:   * Additional Charging
                                     *136,PTCNMITM    * Multiple items
          READ      CONTROLF,SEVENTY7;*214,PTCNBTNM   * Bed transfer billing
          READ      CONTROLF,SEVENTY9;*68,PTCNMFEE,PTCNJFEE
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,PTCNADBF,DYES,DNO           * Auto Def. in PATBFEE
          MOVE      DNO,DDANS2
          LOAD      DDANS2,PTRESDAY,DYES,DNO           * Reset Day Count S/Down
          MOVE      DNO,DDANS3
          LOAD      DDANS3,PTCNBDOM,DYES,DNO           * Def Board using P'Code
          MOVE      DNO,DDANS4
          LOAD      DDANS4,PTCNUBRD,DYES,DNO           * Input Board in Adm's
          MOVE      DNO,DDANS5
          LOAD      DDANS5,PTCNGSTF,DYES,DNO           * Separate GST in BIL19
          MOVE      DNO,DDANS21
          LOAD      DDANS21,PTCNADDC,DYES,DNO          * Using Addit. Charging
          MOVE      DNO,DDANS7
          LOAD      DDANS7,PTCNMITM,DYES,DNO          * Using multiple items
          PACK      PTCNCCRR,PTCNCCRR,SP3
          MOVE      SP20,TDESC1
          MATCH     SP3,PTCNCCRR 
          IF        !@EQUAL
            PACK      KEY5,CODECL,PTCNCCRR
            CALL      RDCODE1
            MOVE      TDESC,TDESC1
          ENDIF
          MOVE      DNO,DDANS6
          LOAD      DDANS6,PTCNCLOR,DYES,DNO           * Separate GST in BIL19
          MOVE      PTCNBTNM,FORM1         
          ADD       ONE,FORM1
          LOAD      DDBILTM,FORM1,DBILTM1,DBILTM2      * Bed transfer bill time
.
          MOVE      DHCLAM5,DDESC11
          LOAD      DDESC11,PTCNMFEE,DHCLAM6
.
          MOVE      DHCLAM7,DDESC12
          LOAD      DDESC12,PTCNJFEE,DHCLAM8
.
          DISPLAY   *P54:2,*V2LON,"- Financial Parameters 2 ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". Automatic Use of Defaults ":
                                             "for PATBFEE":
                    *P1:05,*V2LON," 2",*HOFF,". Reset Day Count for Stepdown":
                    *P1:06,*V2LON," 3",*HOFF,". Default Board (HF) Based on ":
                                             "Post Code":
                    *P1:07,*V2LON," 4",*HOFF,". Inputting Board (HF) in ":
                                             "Admissions":
                    *P1:08,*V2LON," 5",*HOFF,". Separate GST in IBABIL19":
                    *P1:09,*V2LON," 6",*HOFF,". Claim Code for Reference rate":
                    *P1:10,*V2LON," 7",*HOFF,". Calculate loss of revenue ":
                    *P1:11,*V2LON," 8",*HOFF,". Using Additional Charging ? ":
                    *P1:12,*V2LON," 9",*HOFF,". Multiple items for non-fixed ":
                                             "items":
                    *P1:13,*V2LON,"10",*HOFF,". Bed transfer billing time ":
                    *P1:14,*V2LON,"11",*HOFF,". Accumulation of Misc. Fees ":
                                             "Invoiced":
                    *P1:15,*V2LON,"12",*HOFF,". Accumulation of Journal Fees ":
                                             "Invoiced":
                    *P42:04,": ",*V2LON,DDANS1,*HOFF:
                    *P42:05,": ",*V2LON,DDANS2,*HOFF:
                    *P42:06,": ",*V2LON,DDANS3,*HOFF:
                    *P42:07,": ",*V2LON,DDANS4,*HOFF:
                    *P42:08,": ",*V2LON,DDANS5,*HOFF:
                    *P42:09,": ",*V2LON,TDESC1,*HOFF:
                    *P42:10,": ",*V2LON,DDANS6,*HOFF:
                    *P42:11,": ",*V2LON,DDANS21,*HOFF:
                    *P42:12,": ",*V2LON,DDANS7,*HOFF:
                    *P42:13,": ",*V2LON,PTCNBTNM,*HOFF:
                    *P42:14,": ",*V2LON,DDESC11,*HOFF:
                    *P42:15,": ",*V2LON,DDESC12,*HOFF
          RETURN
.
.********************************************************************
.*  DILI0000  :  Display Labels/Id Sheets Screen                    *
.*                                                                  *
.********************************************************************
.
DILI0000  READ      CONTROLF,TEN;*165,CIDENT          * Using Id Sheets
.
          READ      CONTROLF,TEN4;*227,CIDLAY         * Id Sheet Layout
.
          READ      CONTROLF,FIFTY9;*130,CADDLAB:     * Number of Add Labels
                                    *236,PTCNFFLL     * Free Form Line in UR Lab
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,PTCNFFLL,DYES,DNO           * Free Form Lne in UR Lab
          MOVE      DNO,DDANS2
          LOAD      DDANS2,CIDENT,DYES,DNO             * Using Id Sheets
.
          MOVE      DHTYPE4,DDESC1
          LOAD      DDESC1,CIDLAY,DHTYPE6,DHTYPE7,DHTYPE8:
                                  DHTYPE10,DHTYPE11,DHTYPE13,DHTYPE23,DHTYPE25
.
.
          DISPLAY   *P54:2,*V2LON,"- Labels/Id Sheet Details ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". Free Format Line in U/R Labels":
                    *P1:05,*V2LON," 2",*HOFF,". Number of Additional Labels ":
                                             "to Print":
                    *P1:06,*V2LON," 3",*HOFF,". Using Identification Sheets":
                    *P1:07,*V2LON," 4",*HOFF,". Id Sheet Layout":
                    *P42:04,": ",*V2LON,DDANS1,*HOFF:
                    *P42:05,": ",*V2LON,CADDLAB,*HOFF:
                    *P42:06,": ",*V2LON,DDANS2,*HOFF:
                    *P42:07,": ",*V2LON,DDESC1
.
          RETURN
.
.********************************************************************
.*  DIIV0000  :  Display Invoice Screen                             *
.*                                                                  *
.********************************************************************
.
DIIV0000  READ      CONTROLF,TEN;*66,CINVLAY          * Invoice Layout
          READ      CONTROLF,TWENTY1;*51,PTCNINVL     * Invoice Layout 2nd Param
.
          READ      CONTROLF,TEN4;*228,CINVFF         * Invoice Formfeed Var.
.
          READ      CONTROLF,TWENTY;*208,PTCNSTMS     * Print Pat/HF portion
.
          READ      CONTROLF,FIFTY9;*23,CFUTINV:      * Future Action when Prnt.
                                    *62,CINVJRN       * Log Inv Num with Jrnl
.
          READ      CONTROLF,SEVENTY7;*212,PTCNSUFA    * Supress Statements
          READ      CONTROLF,EIGHTY8;*233,PTCNADES    * Supress Statements
.
          READ      CONTROLF,HUND05;*205,PTCNPFID:    * print details on tobeinv
                                    *211,PTCNBPAY     * BPAY Parameter I-48227
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,CFUTINV,DYES,DNO            * Future Action when Prnt.
          MOVE      DNO,DDANS2
          LOAD      DDANS2,CINVJRN,DYES,DNO            * Log Inv Num with Jrnl
          MOVE      DNO,DDANS3
          LOAD      DDANS3,PTCNSTMS,DYES,DNO           * Print Pat/HF portion
.
          ASSIGN    (CINVLAY+PTCNINVL),FORM2
          MOVE      DHTYPE1,DDESC1
          LOAD      DDESC1,FORM2,DHTYPE2,DHTYPE3,DHTYPE4,DHTYPE5,DHTYPE6:
                                 DHTYPE8,DHTYPE7,DHTYPE10,DHTYPE11,DHTYPE36:
                                 DHTYPE37,DHTYPE39,DHTYPE32,DHTYPE40,DHTYPE41:
                                 DHTYPE42,DHTYPE43,DHTYPE44,DHTYPE45,DHTYPE46:
                                 DHTYPE47,DHTYPE48,DHTYPE35,DHTYPE34,DHTYPE50:
                                 DHTYPE18,DHTYPE23,DHTYPE33,DHTYPE22,DHTYPE24:
                                 DHTYPE51,DHTYPE52,DHTYPE53
.
          MOVE      DNO,DDANS4
          LOAD      DDANS4,PTCNSUFA,DYES,DNO           * Supress Statements?
.
          MOVE      ADESC0,ADB1DESC
          LOAD      ADB1DESC,PTCNADES,ADESC1
.
          MOVE      DNO,DDANS5 
          LOAD      DDANS5,PTCNPFID,DYES,DNO
.
          MOVE      DNO,DDANS6                         * I-48227 Init to No
          LOAD      DDANS6,PTCNBPAY,DYES,DNO           * I-48227 Load yes or no
.
          DISPLAY   *P54:2,*V2LON,"- Invoice Details ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". Invoice Layout":
                    *P1:05,*V2LON," 2",*HOFF,". Future Action when Printing ":
                                             "Invoices":
                    *P1:06,*V2LON," 3",*HOFF,". Log Away Invoice No. with":
                                             " Journal":
                    *P1:07,*V2LON," 4",*HOFF,". Print Pat/HF portions on ":
                                             "Statement":
                    *P1:08,*V2LON," 5",*HOFF,". Supress Printing of Statements":
                                             " by Future Action Code?":
                    *P1:09,*V2LON," 6",*HOFF,". Description for zero new addit":
                                             "ional Charge (1,2)     ":
                    *P1:10,*V2LON," 7",*HOFF,". Print details on Fees Invoice":
                                             " (Y/N)                 ":
                    *P1:11,*V2LON," 8",*HOFF,". Generate BPAY Customer Referen":
                                             "ce Number? (Y/N)       ": *I-48227
                    *P59:04,": ",*V2LON,DDESC1,*HOFF:
                    *P59:05,": ",*V2LON,DDANS1,*HOFF:
                    *P59:06,": ",*V2LON,DDANS2,*HOFF:
                    *P59:07,": ",*V2LON,DDANS3,*HOFF:
                    *P59:08,": ",*V2LON,DDANS4,*HOFF:
                    *P59:09,": ",*V2LON,PTCNADES,*HOFF,SP2,ADB1DESC:
                    *P59:10,": ",*V2LON,DDANS5,*HOFF:
                    *P59:11,": ",*V2LON,DDANS6,*HOFF                    *I-48227
.
          RETURN
.
.********************************************************************
.*  DICO0000  :  Display Comments Screen                            *
.*                                                                  *
.********************************************************************
.
DICO0000  READ      CONTROLF,TWENTY;*238,PTCNURCO     * Using U/R Level Comments
.
          READ      CONTROLF,FIFTY9;*25,CFUTCOM:      * Write Future Action Com
                                    *129,CCHGCMN      * Comm. in Chng. in HOS31
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,PTCNURCO,DYES,DNO           * Using U/R Level Comments
          MOVE      DNO,DDANS2
          LOAD      DDANS2,CFUTCOM,DYES,DNO            * Write Future Action Com
          MOVE      DNO,DDANS3
          LOAD      DDANS3,CCHGCMN,DYES,DNO            * Comm. in Chng. in HOS31
.
          DISPLAY   *P54:2,*V2LON,"- Comments details ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". Using U/R Level Comments":
                    *P1:05,*V2LON," 2",*HOFF,". Write Future Action to ":
                                             "Comments":
                    *P1:06,*V2LON," 3",*HOFF,". Comments in Chg Adm Details ":
                                             " IBAHOS31":
                    *P42:04,": ",*V2LON,DDANS1,*HOFF:
                    *P42:05,": ",*V2LON,DDANS2,*HOFF:
                    *P42:06,": ",*V2LON,DDANS3,*HOFF
.
          RETURN
.
.
.********************************************************************
.*  DILS0000  :  Display Length of Stay Screen                      *
.*                                                                  *
.********************************************************************
.
DILS0000  READ      CONTROLF,FIFTY9;*147,PTCNLOS1:    * 1st Length of Stay
                                    *150,PTCNLOS2:    * 2nd Length of Stay
                                    *153,PTCNLOS3:    * 3rd Length of Stay
                                    *156,PTCNELDR:    * Elderly Patient Age
                                    *159,PTCNLSR1:    * 1st Long Stay Range
                                    *162,PTCNLSR2:    * 2nd Long Stay Range
                                    *165,PTCNLSR3:    * 3rd Long Stay Range
                                    *168,PTCNLSR4:    * 4th Long Stay Range
                                    *217,PTOCBDAY     * Occ. Bed Days for LOS
.
          MOVE      OCBDAY0,DDESC1
          LOAD      DDESC1,PTOCBDAY,OCBDAY1
.
          DISPLAY   *P54:2,*V2LON,"- Length of Stay details ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". 1st Length of Stay in PATDASFD":
                    *P1:05,*V2LON," 2",*HOFF,". 2nd Length of Stay in PATDASFD":
                    *P1:06,*V2LON," 3",*HOFF,". 3rd Length of Stay in PATDASFD":
                    *P1:07,*V2LON," 4",*HOFF,". Elderly Patient Age in ":
                                             "PATDASFD":
                    *P1:08,*V2LON," 5",*HOFF,". 1st Long Stay Range in ":
                                             "Clinical Stats":
                    *P1:09,*V2LON," 6",*HOFF,". 2nd Long Stay Range in ":
                                             "Clinical Stats":
                    *P1:10,*V2LON," 7",*HOFF,". 3rd Long Stay Range in ":
                                             "Clinical Stats":
                    *P1:11,*V2LON," 8",*HOFF,". 4th Long Stay Range in ":
                                             "Clinical Stats":
                    *P1:12,*V2LON," 9",*HOFF,". Occupied Bed Days for Av. LOS":
                    *P42:04,": ",*V2LON,PTCNLOS1,*HOFF:
                    *P42:05,": ",*V2LON,PTCNLOS2,*HOFF:
                    *P42:06,": ",*V2LON,PTCNLOS3,*HOFF:
                    *P42:07,": ",*V2LON,PTCNELDR,*HOFF:
                    *P42:08,": ",*V2LON,PTCNLSR1,*HOFF:
                    *P42:09,": ",*V2LON,PTCNLSR2,*HOFF:
                    *P42:10,": ",*V2LON,PTCNLSR3,*HOFF:
                    *P42:11,": ",*V2LON,PTCNLSR4,*HOFF:
                    *P42:12,": ",*V2LON,DDESC1
.
          RETURN
.
.
.********************************************************************
.*  DIAD0000  :  Display Admission Based Details Screen             *
.*                                                                  *
.********************************************************************
.
DIAD0000  READ      CONTROLF,TEN;*13,PTCNTLVE:        * Using Type Of Leave
                                 *34,PTCNRFFF:        * Free Format Doctor Ref
                                 *35,PTCNATHM:        * Authority Mand. in Ref
                                 *197,CASSOCD         * Using Assoc. Doctor
.
          READ      CONTROLF,TWENTY;*52,PTPCLRES      * P.R.A. for Claims
.
          READ      CONTROLF,TWENTY1;*45,PTCNDRSM:    * Var for Sep. Mode
                                     *49,PTCNVDDI:    * View Disc. Diag in MRT06
                                     *65,PTCNICDC:    * Type of ICD9 coding
                                     *66,PTCNABBL:    * Admit by Book list hos31
                                    *118,PTCNUCEP:    * Using Consult. Episodes?
                                    *122,PTCNADMB:    * Default to admit baby
                                    *216,PTCNDTRF    
.
          READ      CONTROLF,FIFTY9;*81,CHOMBAS       * Code for Home Base
.
          READ      CONTROLF,SEVENTY9;*105,PTCNUILH   * using letter history
.
          READ      CONTROLF,EIGHTY;*243,PTCNODRG:    * Using online grouper
                                    *249,PTCNEDTE     * E code dates
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,PTCNTLVE,DYES,DNO           * Using Type Of Leave
          MOVE      DNO,DDANS3
          LOAD      DDANS3,PTCNVDDI,DYES,DNO           * View Disc Diag in MRT06
          MOVE      DNO,DDANS4
          LOAD      DDANS4,CASSOCD,DYES,DNO            * Using Assoc. Doctor
          MOVE      DNO,DDANS5
          LOAD      DDANS5,PTCNRFFF,DYES,DNO           * Free Format Doctor Ref
          MOVE      DNO,DDANS6
          LOAD      DDANS6,PTCNATHM,DYES,DNO           * Authority Mand. in Ref
          MOVE      DNO,DDANS7
          LOAD      DDANS7,PTCNABBL,DYES,DNO           * Admit by book list 
.                                                        option in hos31 ?
          MOVE      DSEPMOD2,DDESC1
          LOAD      DDESC1,PTCNDRSM,DSEPMOD1
.
          PACK      KEY5,ANSU,ONE,CHOMBAS
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      SP30,DDESC2
          ELSE
            MOVE      TDESC,DDESC2
          ENDIF
.
          MOVE      PRFADES0,DDESC3
          LOAD      DDESC3,PTPCLRES,PRFADES1,PRFADES2,PRFADES3        *C-119915
.
          MOVE      DNO,DDANS8
          LOAD      DDANS8,PTCNUCEP,DYES,DNO           * Admit by book list 
.
          MOVE      DNO,DDANS9
          LOAD      DDANS9,PTCNADMB,DYES,DNO           * default to admit baby
.
          MOVE      DICDC0,DDESC5
          LOAD      DDESC5,PTCNICDC,DICDC1
.
          MOVE      SP20,DESCDTRF
          MOVE      DDEST,DESCDTRF
          LOAD      DESCDTRF,PTCNDTRF,DSTAT
.
.
          MOVE      DNO,DDANS11
          LOAD      DDANS11,PTCNODRG,DYES,DNO          * Online DRG            
.
          MOVE      DNO,DDANS12
          LOAD      DDANS12,PTCNEDTE,DYES,DNO          * E code dates           
.
          MOVE      SP3,DDANS17
.>>>>     LOAD      DDANS17,PTCNOENC,DYES              * Online encoder
.
          MOVE      DNO,DDANS18
          LOAD      DDANS18,PTCNUILH,DYES              * letter history
.
          DISPLAY   *P54:2,*V2LON,"- Admission Based details ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". Using Type of Leave      ":
                                  "                        : ":
                    *P1:05,*V2LON," 2",*HOFF,". Not in use               ":
                                  "                        : ":
                    *P1:06,*V2LON," 3",*HOFF,". Which Variable to use for":
                                  " Separ Mode             : ":
                    *P1:07,*V2LON," 4",*HOFF,". View Discharge Diagnosis ":
                                  "in IBAMRT06             : ":
                    *P1:08,*V2LON," 5",*HOFF,". Using Associated Doctor  ":
                                  "                        : ":
                    *P1:09,*V2LON," 6",*HOFF,". Code for Home Base (Cat U":
                                  "1)                      : ":
                    *P1:10,*V2LON," 7",*HOFF,". Pat's with claim to use S":
                                  "elf P.R.A.              : ":
                    *P1:11,*V2LON," 8",*HOFF,". Free Format Doctor in Ref":
                                  "erral Details           : ":
                    *P1:12,*V2LON," 9",*HOFF,". Authority Mandatory in Re":
                                  "f. Details              : ":
                    *P1:13,*V2LON,"10",*HOFF,". Using Consultant Episodes":
                                  " ?                      : ":
                    *P1:14,*V2LON,"11",*HOFF,". Type of Disease coding us":
                                  "ed                      : ":
                    *P1:15,*V2LON,"12",*HOFF,". Admit by Booking List in ":
                                  "HOS31 ?                 : ":
                    *P1:16,*V2LON,"13",*HOFF,". HOS73 Default for newborn":
                                  " admission              : ":
                    *P1:17,*V2LON,"14",*HOFF,". Variable for 'Transfer to":
                                  " another hospital' (0/1): ":
                    *P1:18,*V2LON,"15",*HOFF,". Using online DRG (Y/N) ? ":
                                  "                        : ":
                    *P1:19,*V2LON,"16",*HOFF,". Entering dates for every ":
                                  "'E' code in MRT06 ?     : ":
                    *P1:20,*V2LON,"17",*HOFF,". Moved to web front end   ":
                                  "                        : ":
                    *P1:21,*V2LON,"18",*HOFF,". Using Letter History file":
                                  " (Y/N)                  : ":
                    *P56:04,*V2LON,DDANS1,*HOFF:
                    *P56:06,*V2LON,DDESC1,*HOFF:
                    *P56:07,*V2LON,DDANS3,*HOFF:
                    *P56:08,*V2LON,DDANS4,*HOFF:
                    *P56:09,*V2LON,DDESC2,*HOFF:
                    *P56:10,*V2LON,DDESC3,*HOFF:
                    *P56:11,*V2LON,DDANS5,*HOFF:
                    *P56:12,*V2LON,DDANS6,*HOFF:
                    *P56:13,*V2LON,DDANS8,*HOFF:
                    *P56:14,*V2LON,DDESC5,*HOFF:
                    *P56:15,*V2LON,DDANS7,*HOFF:
                    *P56:16,*V2LON,DDANS9,*HOFF:
                    *P56:17,*V2LON,PTCNDTRF,SP1,*HOFF,DESCDTRF:
                    *P56:18,*V2LON,DDANS11,*HOFF:
                    *P56:19,*V2LON,DDANS12,*HOFF:
                    *P56:20,*V2LON,DDANS17,*HOFF:
                    *P56:21,*V2LON,DDANS18,*HOFF
.
          RETURN
.
.
.********************************************************************
.*  DIMS0000  :  Display Miscellaneous Screen 1                     *
.*                                                                  *
.********************************************************************
.
DIMS0000  READ      CONTROLF,TEN3;*154,CUSEMBS:       * MBS Codes in Med Rec
                                  *163,BEDTYP:        * Bed Type for W.C.H.
                                  *242,CCLMCHN        * Claims Maint in Admiss
.
          READ      CONTROLF,TWENTY;*73,PTCNDEPM:     * Category A Mandatory
                                    *74,PTCNVALD:     * Vald. Dept to Doctor Typ
                                    *75,PTCNCHDP:     * Change Dept in Bed Trans
                                    *77,PT3BHOSP:     * Inc Days of Hos in 3B C
                                    *214,PTCNSQD3:    * Supress '?' on Cat D3
                                    *215,PTCNSQU3     * Supress '?' on Cat U3
.
          READ      CONTROLF,TWENTY1;*50,PTCNTAST:    * Single Terminal in BIL31
                                     *57,PTCNUAHS:    * WL Ad-Hoc Sc WAT30/OPR40
                                     *59,PTCNWRDS:    * Ward Speclties in PAT13
                                     *64,PTCNNPDS:    * New Disp. in WL/Book
                                     *68,PTCNPALL:    * Print all in MRT21
                                    *117,PTCNH77U     * UK layout hoss77?
.
          READ      CONTROLF,FIFTY9;*61,CHFCOMM:      * Health Fund Comments Opt
                                    *207,PTPMS68F:    * Info in PMS68
                                    *237,PTCNLDOC     * Using Local Doctor
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,CCLMCHN,DYES,DNO           * Claims Maint in Admiss
          MOVE      DNO,DDANS2
          LOAD      DDANS2,CHFCOMM,DYES,DNO           * Health Fund Comments Opt
          MOVE      DNO,DDANS3
          LOAD      DDANS3,PTCNLDOC,DYES,DNO          * Using Local Doctor
          MOVE      DNO,DDANS4
          LOAD      DDANS4,PTCNDEPM,DYES,DNO          * Category A Mandatory
          MOVE      DNO,DDANS5
          LOAD      DDANS5,PTCNVALD,DYES,DNO          * Vald. Dept to Doctor Typ
          MOVE      DNO,DDANS6
          LOAD      DDANS6,PTCNCHDP,DYES,DNO          * Change Dept in Bed Trans
          MOVE      DNO,DDANS7
          LOAD      DDANS7,PT3BHOSP,DYES,DNO          * Inc Days of Hos in 3B C
          MOVE      DNO,DDANS8
          LOAD      DDANS8,PTCNSQD3,DYES,DNO          * Supress '?' on Cat D3
          MOVE      DNO,DDANS9
          LOAD      DDANS9,PTCNSQU3,DYES,DNO          * Supress '?' on Cat U3
          MOVE      DNO,DDANS10
          LOAD      DDANS10,PTCNTAST,DYES,DNO         * Single Term. in BIL31
          MOVE      DNO,DDANS11
          LOAD      DDANS11,PTCNUAHS,DYES,DNO         * WL Ad-Hoc in WAT30/OPR40
          MOVE      DNO,DDANS12
          LOAD      DDANS12,PTCNWRDS,DYES,DNO         * Ward Specialities PAT13 
          MOVE      DNO,DDANS13
          LOAD      DDANS13,PTCNNPDS,DYES,DNO         * New Disp. in WL/Book
          MOVE      DNO,DDANS14
          LOAD      DDANS14,PTCNPALL,DYES,DNO         * Print all in MRT21 k
          MOVE      DNO,DDANS16
          LOAD      DDANS16,PTCNH77U,DYES,DNO         * UK layout for hos77
.
          MOVE      SP30,DDESC1
          LOAD      DDESC1,PTPMS68F,DPMS68I0,DPMS68I1
.
          MOVE      DMUSE0,DDESC2
          LOAD      DDESC2,CUSEMBS,DMUSE1,DMUSE2
.
          DISPLAY   *P54:2,*V2LON,"- Miscellaneous Details 1 ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". Type of Info Printed in ":
                                             "IBAPMS68":
                    *P1:05,*V2LON," 2",*HOFF,". Claim Maint. in Admissions":
                    *P1:06,*V2LON," 3",*HOFF,". MBS Codes in Medical Records":
                    *P1:07,*V2LON," 4",*HOFF,". Bed Type Used for W.C.H.":
                    *P1:08,*V2LON," 5",*HOFF,". Health Fund Comments Option":
                    *P1:09,*V2LON," 6",*HOFF,". Using Local Doctor":
                    *P1:10,*V2LON," 7",*HOFF,". Category A Mandatory":
                    *P1:11,*V2LON," 8",*HOFF,". Validate Category A in Bed ":
                                             "Trans":
                    *P1:12,*V2LON," 9",*HOFF,". Change Category A in Bed ":
                                             "Trans":
                    *P1:13,*V2LON,"10",*HOFF,". Include Days of Hosp. to 3B ":
                                             "Cert":
                    *P1:14,*V2LON,"11",*HOFF,". Supress '?' on Cat 'D3'":
                    *P1:15,*V2LON,"12",*HOFF,". Supress '?' on Cat 'U3'":
                    *P1:16,*V2LON,"13",*HOFF,". Ask for Single Terminal ":
                                             "in BIL31":
                    *P1:17,*V2LON,"14",*HOFF,". WL Ad-Hoc Screen in WAT30":
                                             "/OPR40":
                    *P1:18,*V2LON,"15",*HOFF,". Ward Specialities in PAT13 ? ":
                    *P1:19,*V2LON,"16",*HOFF,". New Patient Display in WAT01/":
                                             "/OPR40":
                    *P1:20,*V2LON,"17",*HOFF,". Print All Details in MRT21 ? ":
                    *P1:21,*V2LON,"18",*HOFF,". Use UK layout in HOS77 ?     ":
                    *P42:04,": ",*V2LON,DDESC1,*HOFF:
                    *P42:05,": ",*V2LON,DDANS1,*HOFF:
                    *P42:06,": ",*V2LON,DDESC2,*HOFF:
                    *P42:07,": ",*V2LON,BEDTYP,*HOFF:
                    *P42:08,": ",*V2LON,DDANS2,*HOFF:
                    *P42:09,": ",*V2LON,DDANS3,*HOFF:
                    *P42:10,": ",*V2LON,DDANS4,*HOFF:
                    *P42:11,": ",*V2LON,DDANS5,*HOFF:
                    *P42:12,": ",*V2LON,DDANS6,*HOFF:
                    *P42:13,": ",*V2LON,"moved to web",*HOFF:
                    *P42:14,": ",*V2LON,DDANS8,*HOFF:
                    *P42:15,": ",*V2LON,DDANS9,*HOFF:
                    *P42:16,": ",*V2LON,DDANS10,*HOFF:
                    *P42:17,": ",*V2LON,DDANS11,*HOFF:
                    *P42:18,": ",*V2LON,DDANS12,*HOFF:
                    *P42:19,": ",*V2LON,DDANS13,*HOFF:
                    *P42:20,": ",*V2LON,DDANS14,*HOFF:
                    *P42:21,": ",*V2LON,DDANS16,*HOFF
.
          RETURN
.
.********************************************************************
.*  DIMC0000  :  Display Miscellaneous Screen 2                     *
.*                                                                  *
.********************************************************************
DIMC0000  READ      CONTROLF,TWENTY1;*132,PTCNCADD:   * change att doc./dept
                                     *200,PTCNICRA:   * Cash Receipts Audit ?
                                     *209,PTCNADMT    * Usr Def. Intent Readm<28
          READ      CONTROLF,SEVENTY7;*11,PTCNDIRT:   * Using Directorates.
                                      *194,PTCNHKPL:  * HK Pulling List (PMS56)
                                      *211,PTCNSMKR:  * Ward/Bed Scan
                                      *239,PTCNWBHB:  * Use historical bed type
                                      *241,PTCNMSDS   * item code search 
          READ      CONTROLF,EIGHTY;*129,PTCNATCC:    * Attendance Charge Code
                                      *145,PTCNTHCC:  * Theatre Charge Code
                                      *154,PTCNOTCC:  * Other Charge Code
                                      *144,PTCNRP83:  * Report layout for PAT83
                                      *239,PTCNNWSP:  * New Ward/Spec in PAT13?
                                      *247,PTCNNTCM   * SVL mods for PMS27 & 29?
...
...       READ      CONTROLF,EIGHTY8;*59,PTCNI10D:    * ICD10 go live date
...
          READ      CONTROLF,EIGHTY8;*224,PTCNEGLD:  * Encoder go-live (ICD10)
                                      *242,PNSWRACE   * User Def. Fld for Race
...       READ      CONTROLF,NINTY8;*149,PTCNGDV2     * ICD10 v2 go live date
          READ      CONTROLF,HUND05;*67,PTCNLPRO       * Load prosthetics
          READ      CONTROLF,HUND05;*68,PTCNMBSC       * Load MBS items 
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,PTCNCADD,DYES,DNO          * change att doc./deptss
          MOVE      DNO,DDANS2 
          LOAD      DDANS2,PTCNICRA,DYES,DNO          * Cash Receipts Audit
          MOVE      DNO,DDANS3 
          LOAD      DDANS3,PTCNHKPL,DYES,DNO          * HK Pulling List
          MOVE      DNO,DDANS4 
          LOAD      DDANS4,PTCNNWSP,DYES,DNO          * New Ward/Spec in PAT13
          MOVE      DNO,DDANS5 
          LOAD      DDANS5,PTCNNTCM,DYES,DNO          * SVL mods for PMS27 & 29?
          MOVE      DNO,DDANS6 
          LOAD      DDANS6,PTCNDIRT,DYES,DNO          * Using Directorates.
          MOVE      DNO,DDANS24
          LOAD      DDANS24,PTCNLPRO,DYES,DNO          * Load Prosthetics
          MOVE      DNO,DDANS25
          LOAD      DDANS25,PTCNMBSC,DYES,DNO          * Load MBS items    
. ------- Race Description 
DIMC1000  MOVE      PUSERD0,DRACE
          LOAD      DRACE,PNSWRACE,PUSERD1,PUSERD2,PUSERD3,PUSERD4:
                                   PUSERD5,PUSERD6,AUSERD1,AUSERD2:
                                   AUSERD3,AUSERD4,AUSERD5,AUSERD6:
                                   AUSERD7,PMSVX1VA
.
. ------- Admission Type Description 
          MOVE      PUSERD0,DADMT
          LOAD      DADMT,PTCNADMT,DUSERD1,DUSERD2,DUSERD3,DUSERD4:
                                   DUSERD5,AUSERD6,AUSERD7,PMSVX1VR
.
. ------- Ward/Bed Scan Type
          MOVE      PTCNSMKR,FORM1
          ADD       ONE,FORM1
          LOAD      DWBED1,FORM1,WBED1,WBED2
.
. ------- Use Bed Type in Ward/Bed History
          MOVE      PTCNWBHB,FORM1
          ADD       ONE,FORM1
          LOAD      DDWBHB,FORM1,DWBHB1,DWBHB2
.
. ------- Use Description in item code search 
          MOVE      PTCNMSDS,FORM1
          ADD       ONE,FORM1
          LOAD      IDDESC,FORM1,ID1,ID2
.
          READ      CONTROLF,TWENTY;*193,PTCNDCLM
          MATCH     SP70,PTCNDCLM
          IF        @EQUAL
            MOVE      "0  ",PTCNDCLM          * use zero claim code
          ENDIF
.
. ------- Attendance Charge Code Description
          MOVE      SP30,DATCC
          MATCH     PTCNATCC,SP9
          IF        !@EQUAL
            PACK      KEY29,PTCNDCLM,SP6,SP3,PTCNATCC,CURRDATE,SP10
            CALL      PATMCHRD                * read Misc.Charges file 
            IF        EXIT = 1
              MOVE      "Unknown Code",MDESC
            ENDIF
            MOVE      MDESC,DATCC
          ENDIF
.
. ------- Theatre Charge Code Description
          MOVE      SP30,DTHCC
          MATCH     PTCNTHCC,SP9
          IF        !@EQUAL
            PACK      KEY29,PTCNDCLM,SP6,SP3,PTCNATCC,CURRDATE,SP10
            CALL      PATMCHRD                * read Misc.Charges file 
            IF        EXIT = 1
              MOVE      "Unknown Code",MDESC
            ENDIF
            MOVE      MDESC,DTHCC
          ENDIF
.
. ------- Other Charge Code Description
          MOVE      SP30,DOTCC
          MATCH     PTCNOTCC,SP9
          IF        !@EQUAL
            PACK      KEY29,PTCNDCLM,SP6,SP3,PTCNATCC,CURRDATE,SP10
            CALL      PATMCHRD                * read Misc.Charges file 
            IF        EXIT = 1
              MOVE      "Unknown Code",MDESC
            ENDIF
            MOVE      MDESC,DOTCC
          ENDIF
.
          MOVE      DSC0RP83,DESCRP83
          LOAD      DESCRP83,PTCNRP83,DSC1RP83        * Report for IBAPAT83
.
          UNPACK    PTCNI10D,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,I10DATE
.
          UNPACK    PTCNEGLD,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,DSPEGLD
.
          UNPACK    PTCNGDV2,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,DSPGDV2
.
          DISPLAY   *P54:2,*V2LON,"- Miscellaneous Details 2 ",*P1:3,*EF:
                    *P1:04,*V2LON:
                    " 1",*HOFF,". Change Dr./Dept. when re-admitting ":
                    *P1:05,*V2LON:
                    " 2",*HOFF,". Allow Auditing on Cash Receipts    ":
                    *P1:06,*V2LON:
                    " 3",*HOFF,". User Def'd Fld for Aboriginality   ":
                    *P1:07,*V2LON:
                    " 4",*HOFF,". UDF Intention to ReAdmit < 28 Days ":
                    *P1:08,*V2LON:
                    " 5",*HOFF,". HK Version of Pulling List IBAPMS56":
                    *P1:09,*V2LON:
                    " 6",*HOFF,". Ward/Bed Scan Type (0-1)           ":
                    *P1:10,*V2LON:
                    " 7",*HOFF,". Use bed type in ward/bed history   ":
                    *P1:11,*V2LON:
                    " 8",*HOFF,". Use description in item code search":
                    *P1:12,*V2LON:
                    " 9",*HOFF,". Attendance charge code             ":
                    *P1:13,*V2LON:
                    "10",*HOFF,". Theatre charge code                ":
                    *P1:14,*V2LON:
                    "11",*HOFF,". Other charge code                  ":
                    *P1:15,*V2LON:
                    "12",*HOFF,". Report Layout for IBAPAT83         ":
                    *P1:16,*V2LON:
                    "13",*HOFF,". Using New Ward/Specialty in PAT13? ":
                    *P1:17,*V2LON:
                    "14",*HOFF,". SVL mods for PMS27 & PMS29         ":
                    *P1:18,*V2LON:
                    "15",*HOFF,". Using Directorates                 ":
...                 *P1:19,*V2LON:                                     *D-49037
...                 "16",*HOFF,". Go-Live Date for ICD10 Coding      ":*D-49037
                    *P1:19,*V2LON:
                    "16",*HOFF,". Encoder go-live date for ICD10     ":
...                 *P1:21,*V2LON:                                     *D-49037
...                 "18",*HOFF,". Go live date for ICD10 version 2   ":*D-49037
                    *P1:20,*V2LON:
                    "17",*HOFF,". Load Prosthetics in IBAADT83 (Y/N) ":
                    *P1:21,*V2LON:
                    "18",*HOFF,". Load MBS items from ASCII file Y/N ";

          DISPLAY   *P40:04,": ",*V2LON,DDANS1,*HOFF:
                    *P40:05,": ",*V2LON,DDANS2,*HOFF:
                    *P40:06,": ",*V2LON,PNSWRACE,*HOFF,*P52:06,DRACE:
                    *P40:07,": ",*V2LON,PTCNADMT,*HOFF,*P52:07,DADMT:
                    *P40:08,": ",*V2LON,DDANS3,*HOFF:
                    *P40:09,": ",*V2LON,PTCNSMKR,*HOFF,*P52:09,DWBED1:
                    *P40:10,": ",*V2LON,PTCNWBHB,*HOFF,*P52:10,DDWBHB:
                    *P40:11,": ",*V2LON,PTCNMSDS,*HOFF,*P52:11,IDDESC:
                    *P40:12,": ",*V2LON,PTCNATCC,*HOFF,*P52:12,DATCC:
                    *P40:13,": ",*V2LON,PTCNTHCC,*HOFF,*P52:13,DTHCC:
                    *P40:14,": ",*V2LON,PTCNOTCC,*HOFF,*P52:14,DOTCC:
                    *P40:15,": ",*V2LON,DESCRP83,*HOFF:
                    *P40:16,": ",*V2LON,DDANS4,*HOFF:
                    *P40:17,": ",*V2LON,DDANS5,*HOFF:
                    *P40:18,": ",*V2LON,DDANS6,*HOFF:
...                 *P40:19,": ",*V2LON,I10DATE,*HOFF:                 *D-49037
                    *P40:19,": ",*V2LON,DSPEGLD,*HOFF:
...                 *P40:21,": ",*V2LON,DSPGDV2,*HOFF:                 *D-49037
                    *P40:20,": ",*V2LON,DDANS24,*HOFF:
                    *P40:21,": ",*V2LON,DDANS25,*HOFF
.
          RETURN
.
.********************************************************************
.*  DINC0000  :  Display Miscellaneous Screen 3                     *
.*                                                                  *
.********************************************************************
...C0000  READ      CONTROLF,HUND09;*151,PTCNGDV3:    * ICD10 v3 go live date
...       UNPACK    PTCNGDV3,CCENT,CYEAR,CMON,CDAY                     *D-49037
...       CALL      PACDATE                                            *D-49037
...       MOVE      CPCDATE,DSPGDV3                                    *D-49037
...
DINC0000  READ      CONTROLF,HUND09;*182,PTCNNFPU     * new files for prosth.
.
          MOVE      DNO,DDANS2
          LOAD      DDANS2,PTCNNFPU,DYES,DNO         * new files for prosth.
.
          DISPLAY   *P54:2,*V2LON,"- Miscellaneous Details 3 ",*P1:3,*EF:
...                 *P1:04,*V2LON:
...                 " 1",*HOFF,". Go live date for ICD10 version 3   ":
...                 *P1:04,*V2LON:
...                 " 2",*HOFF,". No longer used                     ":
                    *P1:04,*V2LON:
                    " 1",*HOFF,". Using extra 3 fields for ADT83(Y/N)";
.
...       DISPLAY   *P40:04,": ",*V2LON,DSPGDV3,*HOFF:                 *D-49037
...       DISPLAY   *P40:04,": ",*V2LON,DDANS1,*HOFF:
          DISPLAY   *P40:04,": ",*V2LON,DDANS2,*HOFF;
.
          RETURN
.
.
.********************************************************************
.*  DISP0000  :  Display Screen Painter Screen                      *
.*                                                                  *
.********************************************************************
.
DISP0000  READ      CONTROLF,TEN;*14,PTCNP2SC:       * 2nd PMI Screen
                                 *23,PTCNA2SC        * 2nd Admission Screen
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,PTCNP2SC,DYES,DNO
.
          MOVE      DNO,DDANS2
          LOAD      DDANS2,PTCNA2SC,DYES,DNO
.
          MOVE      DNO,DDANS3
          LOAD      DDANS3,PTCNICRA,DYES
.
          DISPLAY   *P54:2,*V2LON,"- Screen Painter details ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". Using Extra MH PMI screen ?":
                    *P1:05,*V2LON," 2",*HOFF,". Using Extra MH Adm screen ?":
                    *P42:04,": ",*V2LON,DDANS1,*HOFF:
                    *P42:05,": ",*V2LON,DDANS2,*HOFF 
.
          RETURN
.
.********************************************************************
.*  DIQU0000  :  Display Quotes Screen
.********************************************************************
DIQU0000
          READ      CONTROLF,TWENTY1;*137,PTCN7405,*235,PTCNDPL8,PTCNCASP:
                                     *237,PTCNPAOF,*211,PTCNMGUR,*247,PTCNDCQS:
                                     *249,PTCNRTWL,*251,PTCNATDT
          READ      CONTROLF,SEVENTY9;*89,PTCNDATB:
                                      *120,PTCNUEOC,PTCNUACC:
                                      *138,PTCNURHA:
                                      *244,PTCNSTMT
. 
          READ      CONTROLF,TEN;*38,PTCNJDRG
          READ      CONTROLF,EIGHTY;*244,PTCNJADJ,*245,PTCNDFCL
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,PTCNDPL8,DYES 
.
          MOVE      DNO,DDANS2
          LOAD      DDANS2,PTCNCASP,DYES 
.
          MOVE      DNO,DDANS3
          LOAD      DDANS3,PTCNPAOF,DYES 
.
          MOVE      DNO,DDANS4
          LOAD      DDANS4,PTCNMGUR,DYES,DNO
.
          MOVE      DNO,DANS24
          LOAD      DANS24,PTCN7405,DYES
.
          MOVE      DNO,DDANS5
          LOAD      DDANS5,PTCNDCQS,DYES
.
          MOVE      DNO,DDANS6
          LOAD      DDANS6,PTCNRTWL,DYES
.
          MOVE      DNO,DDANS8
          LOAD      DDANS8,PTCNATDT,DYES
.
          MOVE      DNO,DDANS10
          LOAD      DDANS10,PTCNJADJ,DYES 
.
          MOVE      DNO,DDANS11
          LOAD      DDANS11,PTCNDFCL,DYES 
.
          MOVE      DNO,DDANS12
          LOAD      DDANS12,PTCNJDRG,DYES 
.
          MOVE      DNO,DDANS13
          LOAD      DDANS13,PTCNSTMT,DYES 
.
          MOVE      DNO,DDANS14
          LOAD      DDANS14,PTCNUEOC,DYES 
.
          MOVE      DNO,DDANS15
          LOAD      DDANS15,PTCNUACC,DYES 
.
          MOVE      DNO,DDANS16
          LOAD      DDANS16,PTCNURHA,DYES 
.
.         display the screen
.
          DISPLAY   *P54:2,*V2LON,"- Quotes Screen ",*P1:3,*EF:
                    *P5:3,*ULON,"Quote",*P11:3,"  Date  "
.
          DISPLAY   *P1:4," 1. ",*V2LON,*P5:4," 7729",*P11:4,"06/08/93",*HOFF:
                    *P20:4,"Print 'DAYPATIENT' on invoice layout 8    (Y/N) : ":
.
                   *P1:5," 2. ",*V2LON,*P5:5,"?????",*P11:5,"09/08/93",*HOFF:
                   *P20:5,"Allow coding across specialties (HMS48)   (Y/N) : ":
                   *P1:6," 3. ",*V2LON,*P5:6,"Bul27",*P11:6,"13/08/93",*HOFF:
                   *P20:6,"Use 'Parent of' as P.R.A. for children    (Y/N) : ":
                   *P1:7," 4. ",*V2LON,*P5:7," 7675",*P11:7,"13/09/93",*HOFF:
                   *P20:7,"Look up Merged U/R's in IBAPAT32?         (Y/N) : ":
                   *P1:8," 5. ",*V2LON,*P5:8," 7405",*P11:8,"01/06/93",*HOFF:
                   *P20:8,"U/R optn for cancel last trn in PAT05     (Y/N) : ":
                   *P1:9," 6. ",*V2LON,*P5:9," 7828",*P11:9,"15/02/94",*HOFF:
                   *P20:9,"Display single column for '?' Doct Screen (Y/N) : ":
                   *P1:10," 7. ",*V2LON,*P6:10,"7829",*P11:10,"24/03/94",*HOFF:
                   *P20:10,"Option to return patient to W/L in PAT03  (Y/N) :":
                   *P1:11," 8. ",*V2LON,*HOFF:
                   *P20:11,"(No Longer Used)                                :":
                   *P1:12," 9. ",*V2LON,*P6:12,"7901",*P11:12,"04/07/94",*HOFF:
                   *P20:12,"Using admssn time field for delivery time (Y/N) : ":
                   *P1:13,"10. ",*V2LON,*P6:13,"8131",*P11:13,"26/10/94",*HOFF:
                   *P20:13,"Include Journal Adjustments in IBAPAT92?  (Y/N) : ":
                   *P1:14,"11. ",*V2LON,*P5:14,"Bul32",*P11:14,"26/10/94",*HOFF:
                   *P20:14,"Default Claim Code from most prevs visit? (Y/N) : ":
                   *P1:15,"12. ",*V2LON,*P5:15,"8256",*P11:15,"05/12/94",*HOFF:
                   *P20:15,"Include journals in DRG reports (IBAINP64)(Y/N) : ":
                   *P1:16,"13. ",*V2LON,*P5:16,"8481",*P11:16,"28/08/95",*HOFF:
                   *P20:16,"Default Admiss'n Type code for babies (IBAHOS73): ":
                   *P1:17,"14. ",*V2LON,*P5:17,"8678",*P11:17,"01/07/96",*HOFF:
                   *P20:17,"Using THC statement layout in IBAHOS20    (Y/N) : ":
                   *P1:18,"15. ",*V2LON,*P11:18,"30/09/96",*HOFF:
                   *P20:18,"Using Episodes of Care                    (Y/N) : ":
                   *P1:19,"16. ",*V2LON,*P11:19,"30/09/96",*HOFF:
                   *P20:19,"Using Accident Compensation Comm. System  (Y/N) : ":
                   *P1:20,"17. ",*V2LON,*P11:20,"14/04/97",*HOFF:
                   *P20:20,"Using RHA Booking System                  (Y/N) : "
.
.         display the values
.
          DISPLAY   *V2LON:
                    *P70:04,DDANS1:
                    *P70:05,DDANS2:
                    *P70:06,DDANS3:
                    *P70:07,DDANS4:
                    *P70:08,DANS24:
                    *P70:09,DDANS5:
                    *P70:10,DDANS6:
                    *P70:12,DDANS8:
                    *P70:13,DDANS10:
                    *P70:14,DDANS11:
                    *P70:15,DDANS12:
                    *P70:16,PTCNDATB:
                    *P70:17,DDANS13:
                    *P70:18,DDANS14:
                    *P70:19,DDANS15:
                    *P70:20,DDANS16
.
DIQU9999  RETURN
+
.
.********************************************************************
.*  DIP20000  :  Display PMI fields 2 Screen
.********************************************************************
.
DIP20000  READ      CONTROLF,SEVENTY7;*95,PTCNDSHL,PTCNASEC,PTCNLIFE:
                      *200,PTCNWLDC,*201,PTCNIDHD,*243,PTCNCMSX
          READ      CONTROLF,TEN9;*225,CSALIAS
          READ      CONTROLF,EIGHTY;*229,PTCNDATE
          READ      CONTROLF,HUND05;*70,PTCNSRVY
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,PTCNDSHL,DYES,DNO
.
          MOVE      DNO,DDANS2
          LOAD      DDANS2,PTCNASEC,DYES,DNO
.
          MOVE      DNO,DDANS3
          LOAD      DDANS3,PTCNLIFE,DYES,DNO
.
          MOVE      DNO,DDESC4   
          LOAD      DDESC4,CSALIAS,DYES,AUTO
          STRIP     DDESC4
.
          MOVE      DNO,DDESC5   
          LOAD      DDESC5,PTCNWLDC,DYES,DNO
          STRIP     DDESC5
.
          ASSIGN    PTCNIDHD+1,FORM1
          LOAD      DHDTYPE,FORM1,HDTYPE1,HDTYPE2
.
          MOVE      DNO,DDESC7   
          LOAD      DDESC7,PTCNCMSX,DYES
          STRIP     DDESC7
.
          MOVE      DNO,DDESC8   
          LOAD      DDESC8,PTCNDATE,DYES
          STRIP     DDESC8
.
          LOAD      SRVYDESC,PTCNSRVY,PUSRYND1,PUSRYND2
.
          DISPLAY   *P54:2,*V2LON,"- PMI fields 2 ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". ":
                    "Allow Discharges while on leave?":
                    *P1:05,*V2LON," 2",*HOFF,". ":
                    "Allow Alert Security Levels ?   ":
                    *P1:06,*V2LON," 3",*HOFF,". ":
                    "Allow Life Threatening Alerts ? ":
                    *P1:07,*V2LON," 4",*HOFF,". ":
                    "Ask Question to use Surname/Given Name as Alias ? ":
                    *P1:08,*V2LON," 5",*HOFF,". ":
                    "Option to put patient back on W/List after Discharge? ":
                    *P1:09,*V2LON," 6",*HOFF,". ":
                    "PMI display header type (0-1) ?":
                    *P1:10,*V2LON," 7",*HOFF,". ":
                    "Returning Closest Match in Soundex Search? ":
                    *P1:11,*V2LON," 8",*HOFF,". ":
                    "Using Age Conversion for Patient Header Display ? ":
                    *P1:12,*V2LON," 9",*HOFF,". ":
                    "User defined field for Survey Release ":
.
                    *P58:04,": ",*V2LON,DDANS1,*HOFF:
                    *P58:05,": ",*V2LON,DDANS2,*HOFF:
                    *P58:06,": ",*V2LON,DDANS3,*HOFF:
                    *P58:07,": ",*V2LON,DDESC4,*HOFF:
                    *P58:08,": ",*V2LON,DDESC5,*HOFF:
                    *P58:09,": ",*V2LON,PTCNIDHD,*P64:09,*HOFF,DHDTYPE:
                    *P58:10,": ",*V2LON,DDESC7,*HOFF:
                    *P58:11,": ",*V2LON,DDESC8,*HOFF:
                    *P58:12,": ",*V2LON,PTCNSRVY,*HOFF,*P64:12,SRVYDESC
.
DIP29999  RETURN
.
.********************************************************************
.*  DHKI0000  :  Display Hong Kong National Interface
.********************************************************************
DHKI0000  READ      CONTROLF,SEVENTY7;*99,PTCNHKIF,PTCNDKEY,PTCNNUMB:
                                          PTCNDIRN,PTCNSCPT
          READ      CONTROLF,SEVENTY7;*169,PTCNHIDG
.
          MOVE      DNO,DHKANS1
          LOAD      DHKANS1,PTCNHKIF,DYES
.
          MOVE      PTCNDKEY,DHKANS2
.
          MOVE      PTCNNUMB,DHKANS3
.
          MOVE      PTCNDIRN,DHKANS4
.
          MOVE      PTCNSCPT,DHKANS5
.
          MOVE      DNO,DHKANS6
          LOAD      DHKANS6,PTCNHIDG,DYES
.
          DISPLAY   *P54:2,*V2LON,"- HK National Interface ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". ":
                    "Running the HK National Interface ?  ":
                    *P1:05,*V2LON," 2",*HOFF,". ":
                    "Download key for the next transfer   ":
                    *P1:06,*V2LON," 3",*HOFF,". ":
                    "Number of records to download        ":
                    *P1:07,*V2LON," 4",*HOFF,". ":
                    "DIR. to copy file on to IBA Machine  ":
                    *P1:08,*V2LON," 5",*HOFF,". ":
                    "Script name to create file           ":
                    *P1:09,*V2LON," 6",*HOFF,". ":
                    "Automatic generate National ID       ":
.
                    *P42:04,": ",*V2LON,DHKANS1,*HOFF:
                    *P42:05,": ",*V2LON,DHKANS2,*HOFF:
                    *P42:06,": ",*V2LON,DHKANS3,*HOFF:
                    *P42:07,": ",*V2LON,DHKANS4,*HOFF:
                    *P42:08,": ",*V2LON,DHKANS5,*HOFF: 
                    *P42:09,": ",*V2LON,DHKANS6,*HOFF
.
DHKI9999  RETURN
.
.-------- Singapore interface
.
DSSI0000  READ      CONTROLF,EIGHTY;*1,PTCNMEAB,*41,PTCNMEDB
.
          DISPLAY   *P54:2,*V2LON,"- Singapore Interface ",*P1:3,*EF:
                    *P1:5,*V2LON," 1",*HOFF:
                    ". Retrieve Medisave Balance by Admission Number :":
                    *P1:7,*V2LON," 2",*HOFF:
                    ". Calculate Doctors Medisave Claimable Amounts by ":
                    "Admission Number :":
                    *P5:6,*V2LON,PTCNMEAB:
                    *P5:8,*V2LON,PTCNMEDB; 
.
DSSI9999  RETURN
.
.-------- Status Adjustment Fields
.
DSAI0000  READ      CONTROLF,TWENTY;*188,PTCNIREF,*189,PTCNBRUS
          READ      CONTROLF,SEVENTY7;*233,PTCNSTT,*234,PTCNSTP,*235,PTCNSTCL:
                    *236,PTCNSTA,*237,PTCNSTAC,*238,PTCNSTHF,*244,PTCNSTDR:
                    *245,PTCNSTCC,*246,PTCNSTCS,*247,PTCNSTDC,*248,PTCNSTDA:
                    *249,PTCNSTST
.
          MOVE      DNO,DDSTT
          LOAD      DDSTT,PTCNSTT,DYES,DNO
.
          MOVE      DNO,DDSTP
          LOAD      DDSTP,PTCNSTP,DYES,DNO
.
          MOVE      DNO,DDSTCL
          LOAD      DDSTCL,PTCNSTCL,DYES,DNO
.
          MOVE      DNO,DDSTA
          LOAD      DDSTA,PTCNSTA,DYES,DNO
.
          MOVE      DNO,DDSTAC
          LOAD      DDSTAC,PTCNSTAC,DYES,DNO
.
          MOVE      DNO,DDSTHF
          LOAD      DDSTHF,PTCNSTHF,DYES,DNO
.
          MOVE      DNO,DDSTDR
          LOAD      DDSTDR,PTCNSTDR,DYES,DNO
.
          MOVE      DNO,DDSTCC
          LOAD      DDSTCC,PTCNSTCC,DYES,DNO
.
          MOVE      DNO,DDSTCS
          LOAD      DDSTCS,PTCNSTCS,DYES,DNO
.
          MOVE      DNO,DDSTDC
          LOAD      DDSTDC,PTCNSTDC,DYES,DNO
.
          MOVE      DNO,DDSTRD
          LOAD      DDSTRD,PTCNIREF,DYES,DNO
.
          MOVE      DNO,DDSTRR
          LOAD      DDSTRR,PTCNBRUS,DYES,DNO
.
          MOVE      DNO,DDSTDA
          LOAD      DDSTDA,PTCNSTDA,DYES,DNO
.
          MOVE      DNO,DDSTST
          LOAD      DDSTST,PTCNSTST,DYES,DNO
.
          DISPLAY   *P54:2,*V2LON,"- Status Adjustment Fields ",*P1:3,*EF:
                    *P1:4,*HOFF,"Can Field be Changed During Normal ":
                    "Processing (Y/N) ?"
.
          MOVE      "Unknown code",TDESC
          PACK      KEY5,CODET,SP5
          CALL      RDCODE1
.
          DISPLAY   *P2:6,*V2LON,"1",*HOFF,". ":
                    TDESC," (Cat T, PTYPE)",*P45:6,COLON
.
          MOVE      "Unknown code",TDESC
          PACK      KEY5,CODEP,SP5
          CALL      RDCODE1
.
          DISPLAY   *P2:7,*V2LON,"2",*HOFF,". ":
                    TDESC," (Cat P, ACLSS)",*P45:7,COLON
.
          MOVE      "Unknown code",TDESC
          PACK      KEY5,CODECL,SP5
          CALL      RDCODE1
.
          DISPLAY   *P2:8,*V2LON,"3",*HOFF,". ":
                    TDESC," (Cat CL, ACLAIM)",*P45:8,COLON
.
          MOVE      "Unknown code",TDESC
          PACK      KEY5,CODEA,SP5
          CALL      RDCODE1
.
          DISPLAY   *P2:9,*V2LON,"4",*HOFF,". ":
                    TDESC," (Cat A, ATYPE)",*P45:9,COLON
.
          MOVE      "Unknown code",TDESC
          PACK      KEY5,CODEAC,SP5
          CALL      RDCODE1
.
          DISPLAY   *P2:10,*V2LON,"5",*HOFF,". ":
                    TDESC," (Cat AC, ACLSSFT)",*P45:10,COLON:
                    *P2:11,*V2LON,"6",*HOFF:
                    ". Health Fund",*P26:11,"(AFUNDH)",*P45:11,COLON:
                    *P2:12,*V2LON,"7",*HOFF:
                    ". Attending Doctor",*P26:12,"(ADOCTA)",*P45:12,COLON
.
          MOVE      "Unknown code",TDESC
          PACK      KEY5,CODECC,SP5
          CALL      RDCODE1
.
          DISPLAY   *P2:13,*V2LON,"8",*HOFF,". ":
                    TDESC," (Cat CC, ACARE)",*P45:13,COLON
.
          MOVE      "Unknown code",TDESC
          PACK      KEY5,CODEU2,SP5
          CALL      RDCODE1
.
          DISPLAY   *P2:14,*V2LON,"9",*HOFF,". ":
                    TDESC," (Cat U2, AUSR2)",*P45:14,COLON
.
          MOVE      "Unknown code",TDESC
          PACK      KEY5,CODEDC,SP5
          CALL      RDCODE1
.
          DISPLAY   *P1:15,*V2LON,"10",*HOFF,". ":
                    TDESC," (Cat DC, ADIET)",*P45:15,COLON:
                    *P1:16,*V2LON,"11",*HOFF,". ":
                    "Referral Details",*P45:16,COLON:
                    *P1:17,*V2LON,"12",*HOFF,". ":
                    "Regenerate RUS Billing",*P45:17,COLON:
                    *P1:18,*V2LON,"13",*HOFF,". ":
                    "Days Charged Adjustment",*P45:18,COLON:
                    *P1:19,*V2LON,"14",*HOFF,". ":
                    "Stepdown",*P45:19,COLON:
                    *P47:6,*V2LON,DDSTT:
                    *P47:7,DDSTP:
                    *P47:8,DDSTCL:
                    *P47:9,DDSTA:
                    *P47:10,DDSTAC:
                    *P47:11,DDSTHF:
                    *P47:12,DDSTDR:
                    *P47:13,DDSTCC:
                    *P47:14,DDSTCS:
                    *P47:15,DDSTDC:
                    *P47:16,DDSTRD:
                    *P47:17,DDSTRR:
                    *P47:18,DDSTDA:
                    *P47:19,DDSTST;
.
DSAI9999  RETURN
+
.********************************************************************
.*  DDGA0000  :  Display Interface Engine Secondary Menu            *
.********************************************************************
DDGA0000  HLINE     *G37,2,54,80
          DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON," 0",*HOFF," = Exit":
                    *P1:5,*V2LON," 1",*HOFF:
                       " = Broadcast - Transmissions TO other Systems":
                    *P1:6,*V2LON," 2",*HOFF:
                       " = Solicited - Transmissions FROM other Systems":
                    *P1:7,*V2LON," 3",*HOFF:
                       " = Broadcast - PAS to CIS":
                    *P1:24,"Select Option : ";
.
DDGA1000  KEYIN     *P17:24,*DV,UNDLN2:
                    *P17:24,*V2LON,COPTION:
                    *P17:24,*DV,COPTION
.
          IF        (COPTION<0) | (COPTION>3)
            BEEP
            GOTO      DDGA1000
          ENDIF
.
          BRANCH    COPTION,DDGA2000,DDGA3000,DDGA4000
          GOTO      DDGA9999                 * Option 0 selected
.
.         Process Broadcast Message Flags
.
DDGA2000  CALL      DDGT0000                 * Display screen & data
          CALL      CDGT0000                 * Alter parameters
          BRANCH    EXIT,DDGA0000            * No changes - return to sub-menu
          CALL      WDGT0000                 * Update changes
          GOTO      DDGA0000                 * Return to sub-menu
.
.
.         Process Solicited Message Flags
.
DDGA3000  CALL      DDGS0000                 * Display screen & data
          CALL      CDGS0000                 * Alter parameters
          BRANCH    EXIT,DDGA0000            * No changes - return to sub-menu
          CALL      WDGS0000                 * Update changes
          GOTO      DDGA0000                 * Return to sub-menu
.
.
.         Process Broadcast PAS-CIS Message Flags
.
DDGA4000  CALL      DCIS0000                 * Display screen & data
          CALL      CCIS0000                 * Alter parameters
          BRANCH    EXIT,DDGA0000            * No changes - return to sub-menu
          CALL      WCIS0000                 * Update changes
          GOTO      DDGA0000                 * Return to sub-menu
.
DDGA9999  RETURN
+
. ------------------------------------------ Start of additional code   I-90203
.*****************************************************************************
.*  DDGS0000  :  Display Interface Engine Solicited Messages Parameters      *
.*****************************************************************************
DDGS0000  READ      CONTROLF,SEVENTY9;*139,PTCNDPSI,*159,PTCNDPSO:
                                      *199,PTCNDASI,*219,PTCNDASO
.
          READ      CONTROLF,EIGHTY8;*3,PTCNDESI,*23,PTCNDESO
.
          DISPLAY   *P54:2,*V2LON,"- Solicited Messages ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". ":
                    "PMI Interface Solicited Service Name (inbound)":
                    *P1:05,*V2LON," 2",*HOFF,". ":
                    "PMI Interface Solicited Service Name (outbound)":
                    *P1:07,*V2LON," 3",*HOFF,". ":
                    "ADT Interface Solicited Service Name (inbound)":
                    *P1:08,*V2LON," 4",*HOFF,". ":
                    "ADT Interface Solicited Service Name (outbound)":
                    *P1:10,*V2LON," 5",*HOFF,". ":
                    "Z04 Interface Solicited Service Name (inbound)":
                    *P1:11,*V2LON," 6",*HOFF,". ":
                    "Z04 Interface Solicited Service Name (outbound)":
                    *P57:04,": ",*V2LON,PTCNDPSI,*HOFF:
                    *P57:05,": ",*V2LON,PTCNDPSO,*HOFF:
                    *P57:07,": ",*V2LON,PTCNDASI,*HOFF:
                    *P57:08,": ",*V2LON,PTCNDASO,*HOFF:
                    *P57:10,": ",*V2LON,PTCNDESI,*HOFF:
                    *P57:11,": ",*V2LON,PTCNDESO,*HOFF
.
DDGS9999  RETURN
. ------------------------------------------ End of additional code     I-90203
+
.********************************************************************
.*  DDGT0000  :  Display Interface Engine set up parameters         *
.********************************************************************
. ------------------------------------------ Start of deleted code      D-90203
. -- D- DDGT0000  READ      CONTROLF,SEVENTY9;*115,PTCNDGUP,PTCNDGUA,PTCNDGMU:
. -- D-90203                          PTCNDGUU,*139,PTCNDPSI,*159,PTCNDPSO:
. -- D-90203                          *179,PTCNDGPB,*199,PTCNDASI,*219,PTCNDASO:
. -- D-90203                          *239,PTCNDGAD,*240,PTCNDGDS,*241,PTCNDGTR:
. -- D-90203                          *242,PTCNDGRG
. --
. --      READ      CONTROLF,EIGHTY8;*3,PTCNDESI,*23,PTCNDESO:          D-90203
. --                                 *53,PTCNDGAL:                      D-90203
. --                                 *54,PTCNDGDN,*55,PTCNDGMW          D-90203
. ------------------------------------------ End of deleted code        D-90203

DDGT0000  READ      CONTROLF,SEVENTY9;*115,PTCNDGUP,PTCNDGUA,PTCNDGMU: *I-90203
                                      *118,PTCNDGUU,*179,PTCNDGPB:     *I-90203
                                      *239,PTCNDGAD,*240,PTCNDGDS:     *I-90203
                                      *241,PTCNDGTR,*242,PTCNDGRG      *I-90203
.
          READ      CONTROLF,EIGHTY8;*53,PTCNDGAL,*54,PTCNDGDN:        *I-90203
                                     *55,PTCNDGMW                      *I-90203
.
          READ      CONTROLF,HUND05;*105,PTCNDGPO,*106,PTCNDGPR:       *I-90203
                                     *107,PTCNDGPA,*164,PTCNDGPE       *I-90203
.
          READ      CONTROLF,HUND03;*41,PTCNDGHA,*42,PTCNDGHD
.
          READ      CONTROLF,HUND10;*239,PTCNDGCP
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,PTCNDGUP,DYES
.
          MOVE      DNO,DDANS2
          LOAD      DDANS2,PTCNDGUA,DYES
.
          MOVE      DNO,DDANS3
          LOAD      DDANS3,PTCNDGMU,DYES
.
          MOVE      DNO,DDANS4
          LOAD      DDANS4,PTCNDGUU,DYES
.
          MOVE      DNO,DDANS5
          LOAD      DDANS5,PTCNDGAD,DYES
.
          MOVE      DNO,DDANS6
          LOAD      DDANS6,PTCNDGDS,DYES
.
          MOVE      DNO,DDANS7
          LOAD      DDANS7,PTCNDGTR,DYES
.
          MOVE      DNO,DDANS8
          LOAD      DDANS8,PTCNDGRG,DYES
.
          MOVE      DNO,DDANS9
          LOAD      DDANS9,PTCNDGAL,DYES
.
          MOVE      DNO,DDANS10
          LOAD      DDANS10,PTCNDGDN,DYES
.
          MOVE      DNO,DDANS11
          LOAD      DDANS11,PTCNDGMW,DYES
.
          MOVE      DNO,DDANS12                                        *I-90203
          LOAD      DDANS12,PTCNDGPO,DYES                              *I-90203
.
          MOVE      DNO,DDANS13                                        *I-90203
          LOAD      DDANS13,PTCNDGPR,DYES                              *I-90203
.
          MOVE      DNO,DDANS14                                        *I-90203
          LOAD      DDANS14,PTCNDGPA,DYES                              *I-90203
.
          MOVE      DNO,DDANS15
          LOAD      DDANS15,PTCNDGPE,DYES
.
          MOVE      DNO,DDANS16
          LOAD      DDANS16,PTCNDGCP,DYES
.
          MOVE      DNO,DDANS17
          LOAD      DDANS17,PTCNDGHA,DYES
.
          MOVE      DNO,DDANS18
          LOAD      DDANS18,PTCNDGHD,DYES
.
. ------------------------------------------ Start of deleted code      D-90203
. --      DISPLAY   *P54:2,*V2LON,"- Interface Engine ",*P1:3,*EF:
. --                *P1:04,*V2LON," 1",*HOFF,". ":
. --                "Inform Subsidiary system after Update PMI details ?":
. --                *P1:05,*V2LON," 2",*HOFF,". ":
. --                "Inform Subsidiary system after Update Alias details?":
. --                *P1:06,*V2LON," 3",*HOFF,". ":
. --                "Inform Subsidiary system after Merge U/R ?":
. --                *P1:07,*V2LON," 4",*HOFF,". ":
. --                "Inform Subsidiary system after UnMerge U/R ?":
. --                *P1:08,*V2LON," 5",*HOFF,". ":
. --                "PMI Interface Solicited Service Name (inbound)":
. --                *P1:09,*V2LON," 6",*HOFF,". ":
. --                "PMI Interface Solicited Service Name (outbound)":
. --                *P1:10,*V2LON," 7",*HOFF,". ":
. --                "Interface Broadcast Service Name ":
. --                *P1:11,*V2LON," 8",*HOFF,". ":
. --                "ADT Interface Solicited Service Name (inbound)":
. --                *P1:12,*V2LON," 9",*HOFF,". ":
. --                "ADT Interface Solicited Service Name (outbound)":
. --                *P1:13,*V2LON,"10",*HOFF,". ":
. --                "Inform Subsidiary system after Patient Admission ?":
. --                *P1:14,*V2LON,"11",*HOFF,". ":
. --                "Inform Subsidiary system after Patient Discharge ?":
. --                *P1:15,*V2LON,"12",*HOFF,". ":
. --                "Inform Subsidiary system after Patient Transfer ? ":
. --                *P1:16,*V2LON,"13",*HOFF,". ":
. --                "Inform Subsidiary system after Patient Registration?":
. --                *P1:17,*V2LON,"14",*HOFF,". ":
. --                "Z04 Interface Solicited Service Name (inbound)":
. --                *P1:18,*V2LON,"15",*HOFF,". ":
. --                "Z04 Interface Solicited Service Name (outbound)":
. --                *P1:19,*V2LON,"16",*HOFF,". ":
. --                "Inform Subsidiary system after Alert Update ?":
. --                *P1:20,*V2LON,"17",*HOFF,". ":
. --                "Inform Subsidiary system after Donor Update ?":
. --                *P1:21,*V2LON,"18",*HOFF,". ":
. --                "Inform Subsidiary system after Med. Warning Update ?":
. --                *P57:04,": ",*V2LON,DDANS1,*HOFF:
. --                *P57:05,": ",*V2LON,DDANS2,*HOFF:
. --                *P57:06,": ",*V2LON,DDANS3,*HOFF:
. --                *P57:07,": ",*V2LON,DDANS4,*HOFF:
. --                *P57:08,": ",*V2LON,PTCNDPSI,*HOFF:
. --                *P57:09,": ",*V2LON,PTCNDPSO,*HOFF:
. --                *P57:10,": ",*V2LON,PTCNDGPB,*HOFF:
. --                *P57:11,": ",*V2LON,PTCNDASI,*HOFF:
. --                *P57:12,": ",*V2LON,PTCNDASO,*HOFF:
. --                *P57:13,": ",*V2LON,DDANS5,*HOFF:
. --                *P57:14,": ",*V2LON,DDANS6,*HOFF:
. --                *P57:15,": ",*V2LON,DDANS7,*HOFF:
. --                *P57:16,": ",*V2LON,DDANS8,*HOFF:
. --                *P57:17,": ",*V2LON,PTCNDESI,*HOFF:
. --                *P57:18,": ",*V2LON,PTCNDESO,*HOFF:
. --                *P57:19,": ",*V2LON,DDANS9,*HOFF:
. --                *P57:20,": ",*V2LON,DDANS10,*HOFF:
. --                *P57:21,": ",*V2LON,DDANS11,*HOFF
. ------------------------------------------ End of deleted code        D-90203
.
          DISPLAY   *P54:2,*V2LON,"- Broadcast Messages ",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". ":
                    "Interface Broadcast Service Name ":
                    *P1:05,*V2LON," 2",*HOFF,". ":
                    "Send a CUP message after Update PMI details ?":
                    *P1:06,*V2LON," 3",*HOFF,". ":
                    "Send a CUA message after Update Alias details ?":
                    *P1:07,*V2LON," 4",*HOFF,". ":
                    "Send a CMR message after Merge U/R ?":
                    *P1:08,*V2LON," 5",*HOFF,". ":
                    "Send a CUM message after UnMerge U/R ?":
                    *P1:09,*V2LON," 6",*HOFF,". ":
                    "Send a CAD message after Patient Admission ?":
                    *P1:10,*V2LON," 7",*HOFF,". ":
                    "Send a CDS message after Patient Discharge ?":
                    *P1:11,*V2LON," 8",*HOFF,". ":
                    "Send a CTR message after Patient Transfer ? ":
                    *P1:12,*V2LON," 9",*HOFF,". ":
                    "Send a CRG message after Patient Registration?":
                    *P1:13,*V2LON,"10",*HOFF,". ":
                    "Send a CAT message after Alert Update ?":
                    *P1:14,*V2LON,"11",*HOFF,". ":
                    "Send a CDN message after Donor Update ?":
                    *P1:15,*V2LON,"12",*HOFF,". ":
                    "Send a CMW message after Med. Warning Update ?":
                    *P1:16,*V2LON,"13",*HOFF,". ":
                    "Send a CPO message after Patient On-Leave ?":
                    *P1:17,*V2LON,"14",*HOFF,". ":
                    "Send a CPR message after Patient Return from Leave ?":
                    *P1:18,*V2LON,"15",*HOFF,". ":
                    "Send a CPA message after Cancel Pre-Admission ?":
                    *P1:19,*V2LON,"16",*HOFF,". ":
                    "Send a CPE message after Pre-Admission ?":
                    *P1:20,*V2LON,"17",*HOFF,". ":
                    "Send a CCP message after Change Pre-Admission ?":
                    *P1:21,*V2LON,"18",*HOFF,". ":
                    "Send a CHA message after Adding Concession Card ?":
                    *P1:22,*V2LON,"19",*HOFF,". ":
                    "Send a CHD message after Deleting Concession Card ?":
                    *P57:04,": ",*V2LON,PTCNDGPB,*HOFF:
                    *P57:05,": ",*V2LON,DDANS1,*HOFF:
                    *P57:06,": ",*V2LON,DDANS2,*HOFF:
                    *P57:07,": ",*V2LON,DDANS3,*HOFF:
                    *P57:08,": ",*V2LON,DDANS4,*HOFF:
                    *P57:09,": ",*V2LON,DDANS5,*HOFF:
                    *P57:10,": ",*V2LON,DDANS6,*HOFF:
                    *P57:11,": ",*V2LON,DDANS7,*HOFF:
                    *P57:12,": ",*V2LON,DDANS8,*HOFF:
                    *P57:13,": ",*V2LON,DDANS9,*HOFF:
                    *P57:14,": ",*V2LON,DDANS10,*HOFF:
                    *P57:15,": ",*V2LON,DDANS11,*HOFF:
                    *P57:16,": ",*V2LON,DDANS12,*HOFF:
                    *P57:17,": ",*V2LON,DDANS13,*HOFF:
                    *P57:18,": ",*V2LON,DDANS14,*HOFF:
                    *P57:19,": ",*V2LON,DDANS15,*HOFF:
                    *P57:20,": ",*V2LON,DDANS16,*HOFF:
                    *P57:21,": ",*V2LON,DDANS17,*HOFF:
                    *P57:22,": ",*V2LON,DDANS18,*HOFF
.
DDGT9999  RETURN
+
.*****************************************************************************
.*                            DCIS0000                                       *
.*              Display PAS-CIS Broadcast Interface Parameters               *
.*****************************************************************************
.
DCIS0000  READ      CONTROLF,HUND10;*101,PTCNA01M:
                                    *102,PTCNA02M,*103,PTCNA03M,*104,PTCNA08M:
                                    *105,PTCNA11M,*106,PTCNA12M,*107,PTCNA13M:
                                    *108,PTCNA14M,*109,PTCNA21M,*110,PTCNA22M:
                                    *111,PTCNA27M,*112,PTCNA28M,*113,PTCNA31M:
                                    *114,PTCNA34M,*244,PTCNA44M
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,PTCNA01M,DYES
.
          MOVE      DNO,DDANS2
          LOAD      DDANS2,PTCNA02M,DYES
.
          MOVE      DNO,DDANS3
          LOAD      DDANS3,PTCNA03M,DYES
.
          MOVE      DNO,DDANS4
          LOAD      DDANS4,PTCNA08M,DYES
.
          MOVE      DNO,DDANS5
          LOAD      DDANS5,PTCNA11M,DYES
.
          MOVE      DNO,DDANS6
          LOAD      DDANS6,PTCNA12M,DYES
.
          MOVE      DNO,DDANS7
          LOAD      DDANS7,PTCNA13M,DYES
.
          MOVE      DNO,DDANS8
          LOAD      DDANS8,PTCNA14M,DYES
.
          MOVE      DNO,DDANS9
          LOAD      DDANS9,PTCNA21M,DYES
.
          MOVE      DNO,DDANS10
          LOAD      DDANS10,PTCNA22M,DYES
.
          MOVE      DNO,DDANS11
          LOAD      DDANS11,PTCNA27M,DYES
.
          MOVE      DNO,DDANS12
          LOAD      DDANS12,PTCNA28M,DYES
.
          MOVE      DNO,DDANS13
          LOAD      DDANS13,PTCNA31M,DYES
.
          MOVE      DNO,DDANS14
          LOAD      DDANS14,PTCNA34M,DYES
.
          MOVE      DNO,DDANS15
          LOAD      DDANS15,PTCNA44M,DYES
.
          DISPLAY   *P54:2,*V2LON,"PAS-CIS Interface ",*P1:3,*EF:
                    *P1:4,*V2LON," 1",*HOFF,". ":
                    "No longer in use                               :":
                    *P1:5,*V2LON," 2",*HOFF,". ":
                    "No longer in use                               :":
                    *P1:6,*V2LON," 3",*HOFF,". ":
                    "No longer in use                               :":
                    *P1:7,*V2LON," 4",*HOFF,". ":
                    "Send A01 message after new admission (Y/N)     :":
                    *P1:8,*V2LON," 5",*HOFF,". ":
                    "Send A02 message after transfer (Y/N)          :":
                    *P1:9,*V2LON," 6",*HOFF,". ":
                    "Send A03 message after discharge (Y/N)         :":
                    *P1:10,*V2LON," 7",*HOFF,". ":
                    "Send A08 message after admission update (Y/N)  :":
                    *P1:11,*V2LON," 8",*HOFF,". ":
                    "Send A11 message after cancel admission (Y/N)  :":
                    *P1:12,*V2LON," 9",*HOFF,". ":
                    "Send A12 message after cancel transfer (Y/N)   :":
                    *P1:13,*V2LON,"10",*HOFF,". ":
                    "Send A13 message after cancel discharge (Y/N)  :":
                    *P1:14,*V2LON,"11",*HOFF,". ":
                    "Send A14 message after preadmit (Y/N)          :":
                    *P1:15,*V2LON,"12",*HOFF,". ":
                    "Send A21 message after on-leave (Y/N)          :":
                    *P1:16,*V2LON,"13",*HOFF,". ":
                    "Send A22 message after return from leave (Y/N) :":
                    *P1:17,*V2LON,"14",*HOFF,". ":
                    "Send A27 message after cancel preadmit (Y/N)   :":
                    *P1:18,*V2LON,"15",*HOFF,". ":
                    "Send A28 message after PMI registration (Y/N)  :":
                    *P1:19,*V2LON,"16",*HOFF,". ":
                    "Send A31 message after PMI update (Y/N)        :":
                    *P1:20,*V2LON,"17",*HOFF,". ":
                    "Send A34 message after U/R merge (Y/N)         :":
                    *P1:21,*V2LON,"18",*HOFF,". ":
                    "Send A44 after change U/R for I/P visit (Y/N)  :"
.
          DISPLAY   *P54:7,DDANS1:
                    *P54:8,DDANS2:
                    *P54:9,DDANS3:
                    *P54:10,DDANS4:
                    *P54:11,DDANS5:
                    *P54:12,DDANS6:
                    *P54:13,DDANS7:
                    *P54:14,DDANS8:
                    *P54:15,DDANS9:
                    *P54:16,DDANS10:
                    *P54:17,DDANS11:
                    *P54:18,DDANS12:
                    *P54:19,DDANS13:
                    *P54:20,DDANS14:
                    *P54:21,DDANS15
.
DCIS9999  RETURN
+
.********************************************************************
.*  DISB0000  :  IBA Controlled Display State based PMI screens     *
.********************************************************************
DISB0000  READ      CONTROLF,HUND05;*1,PTCNACTI,*26,PTCNINSN,*46,PTCNOTSN:
                                    *108,PTCNACSA,*123,PTCNAPID,*124,PTCNCCOD
.
          MOVE      DNO,DDANS1
          LOAD      DDANS1,PTCNACTI,DYES,DNO
.
          MOVE      SP10,ACTPIDV
          MOVE      PTCNAPID,ANS
          REP       "P1D2T3",ANS
          MOVE      ANS,FORM1
          LOAD      ACTPIDV,FORM1,ACTPIDP,ACTPIDD,ACTPIDT
.
          DISPLAY   *P54:2,*V2LON,"- State Based PMI Screens",*P1:3,*EF:
                    *P1:04,*V2LON," 1",*HOFF,". ":
                    "Interface Inbound  Service Name                    ":
                    *P1:05,*V2LON," 2",*HOFF,". ":
                    "Interface Outbound Service Name                    ":
                    *P1:06,*V2LON," 3",*HOFF,". ":
                    "Using ACT Health Interface (Y/N) ?                 ":
                    *P1:07,*V2LON," 4",*HOFF,". ":
                    "ACT Health Sending Application                     ":
                    *P1:08,*V2LON," 5",*HOFF,". ":
                    "ACT Health Processing ID                           ":
                    *P1:09,*V2LON," 6",*HOFF,". ":
                    "ACT Country Code for Australia                     ":
                    *P38:04,": ",*V2LON,PTCNINSN,*HOFF:
                    *P38:05,": ",*V2LON,PTCNOTSN,*HOFF:
                    *P38:06,": ",*V2LON,DDANS1:
                    *P38:07,": ",*V2LON,PTCNACSA:
                    *P38:08,": ",*V2LON,ACTPIDV:
                    *P38:09,": ",*V2LON,PTCNCCOD
.
DISB9999  RETURN
+
.******************************************************************************
.*        Display IBA Controlled PRS/2 Screen 1                               *
.******************************************************************************
DISPSCR1  READ      CONTROLF,TEN;*243,PTCNEFLG
          READ      CONTROLF,TWENTY1;*205,PTCNUKEY,PTCNCRRG,*208,PTCNCRTN:
                                     *210,PTCNHOSP
          READ      CONTROLF,SEVENTY7;*12,PTCNPRSL
.
          MOVE      ERROR0,ERRORTYP
          LOAD      ERRORTYP,PTCNEFLG,ERROR1
.
. ------- Get Current Unique Key Type if Valid
.
          MOVE      SP30,UKEYDISP
          LOAD      UKEYDISP,PTCNUKEY,UKEY1,UKEY2,UKEY3
.
. ------- Get Current Region Description
.
          MOVE      SP30,CRRGDISP
          TYPE      PTCNCRRG
          GOTO      DISPS01A IF NOT EQUAL
.
          MOVE      PTCNCRRG,FORM2
          ADD       "1",FORM2
          LOAD      CRRGDISP,FORM2,CRRG01,CRRG02,CRRG03,CRRG04,CRRG05:
                                   CRRG06,CRRG07,CRRG08,CRRG09,CRRG10
.
. ------- Criterion Description 
.
DISPS01A  MOVE      PUSERD0,DCRTN
          LOAD      DCRTN,PTCNCRTN,AUSERD1,AUSERD2,AUSERD3,AUSERD4:
                                   AUSERD5,AUSERD6,AUSERD7,PMSVX1VB
.
. ------- Which Hospital Type
.
          MOVE      DHOSTYP0,DDESC1                   * Hospital Type
          LOAD      DDESC1,PTCNHOSP,DHOSTYP1
.
. ------- Date that PRS2 goes live
.
          UNPACK    PTCNPRSL,XCENT1,XYEAR1,XMON1,XDAY1
.
          DISPLAY   *P54:2,*EF,*V2LON,"- IBA PRS/2 Screen",*HOFF:
                    *P1:04,*V2LON," 1",*HOFF:
                    ". Toggle HCS data transmission Error Flag    :":
                    *P1:05,*V2LON," 2",*HOFF:
                    ". Unique Key Format for PRS/2                :":
                    *P1:06,*V2LON," 3",*HOFF:
                    ". Current Region for PRS/2 (0-9)             :":
                    *P1:07,*V2LON," 4",*HOFF:
                    ". User Def'd Fld for Criteria for Adm        :":
                    *P1:08,*V2LON," 5",*HOFF:
                    ". Hospital Type (0-Private  1-Public)        :":
                    *P1:09,*V2LON," 6",*HOFF:
                    ". Live Date for PRS2                         :";
.
.
          DISPLAY   *P50:04,*V2LON,PTCNEFLG,*HOFF,*P55:04,ERRORTYP:
                    *P50:05,*V2LON,PTCNUKEY,*HOFF,*P55:05,UKEYDISP:
                    *P50:06,*V2LON,PTCNCRRG,*HOFF,*P55:06,CRRGDISP:
                    *P50:07,*V2LON,PTCNCRTN,*HOFF,*P55:07,DCRTN:
                    *P50:08,*V2LON,PTCNHOSP,*HOFF,*P55:08,DDESC1:
                    *P50:09,*V2LON,XDAY1,SLASH,XMON1,SLASH,XCENT1,XYEAR1;
.
          RETURN
+
.***********************************************************************
.*  CIHS0000  :  Change Hospital Based details screen                  *
.***********************************************************************
.
CIHS0000  MOVE      FALSE,EXIT
          CALL      MAINQST
          MOVE      "44",CCOL
.
          COMPARE   ZERO,CCITEM
          GOTO      CIHS9999 IF EQUAL
          GOTO      CIHS9000 IF LESS
.
          BRANCH    CCITEM,CIHS0100,CIHS0200,CIHS0300,CIHS0400,CIHS0500:
                           CIHS0600,CIHS0700,CIHS0800,CIHS0900,CIHS1000:
                           CIHS1100,CIHS1200,CIHS1300,CIHS1400
          BEEP
          GOTO      CIHS0000
.
CIHS0100  MOVE      "4",CVERT
          GOTO      CIHS0000
.
CIHS0200  MOVE      "5",CVERT
          GOTO      CIHS0000
.
CIHS0300  MOVE      "6",CVERT
          GOTO      CIHS0000
.
CIHS0400  MOVE      "7",CVERT
          MOVE      "Hospital Type",BOXHDR
          CALL      LDHSPT00                * Load Hospital Types
          PROC      GENCODKY
          BRANCH    EXIT,CIHS0000
          MOVE      TEMPCODE,CHOSTYP
          GOTO      CIHS0000
.
CIHS0500  MOVE      "8",CVERT
          MOVE      "Charging Type",BOXHDR
          CALL      LDCHRG00                * Load Charging Types
          PROC      GENCODKY
          BRANCH    EXIT,CIHS0000
          MOVE      TEMPCODE,CTYPCHG
          GOTO      CIHS0000
.
CIHS0600  MOVE      "9",CVERT
          GOTO      CIHS0000
.
CIHS0700  MOVE      "10",CVERT
          MOVE      "Unique Hospital Id",BOXHDR
          CALL      LDHTYP00                * Load Hospital Type
          PROC      GENCODKY
          BRANCH    EXIT,CIHS0000
          MOVE      TEMPCODE,CHOSPNUM
          GOTO      CIHS0000
.
CIHS0800  BEEP
          GOTO      CIHS0000
.
CIHS0900  MOVE      "12",CVERT
          MOVE      CUSENOTE,ANS
          CALL      KYND0000
          MOVE      EXIT,CUSENOTE
          GOTO      CIHS0000
.
CIHS1000  MOVE      "13",CVERT
          MOVE      "Reporting Layout",BOXHDR
          CALL      LDREPT00                * Load Report Layouts
          PROC      GENCODKY
          BRANCH    EXIT,CIHS0000
          MOVE      TEMPCODE,CTYPREP
          GOTO      CIHS0000
.
CIHS1100  MOVE      "14",CVERT
          MOVE      "Unique Hosp. Id for Hutt",BOXHDR
          CALL      LDUHID00                * Load Unique Hospital Id's
          PROC      GENCODKY
          BRANCH    EXIT,CIHS0000
          MOVE      TEMPCODE,CHUTTCN
          GOTO      CIHS0000
.
CIHS1200  MOVE      "15",CVERT
          MOVE      PTCNPREG,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNPREG
          GOTO      CIHS0000
.
CIHS1300  MOVE      "16",CVERT
          MOVE      IBCNMHOS,ANS
          CALL      KYND0000
          MOVE      EXIT,IBCNMHOS
          GOTO      CIHS0000
.
CIHS1400  MOVE      "17",CVERT
          MOVE      PTCNDFIN,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDFIN
          GOTO      CIHS0000
.
CIHS9000  MOVE      TRUE,EXIT
.
CIHS9999  RETURN
+
.***********************************************************************
.*  CISI0000  :  Change System/Interfaces details screen               *
.***********************************************************************
+
CISI0000  MOVE      FALSE,EXIT
          CALL      MAINQST
          MOVE      "44",CCOL
.
          COMPARE   ZERO,CCITEM
          GOTO      CISI9999 IF EQUAL
          GOTO      CISI9000 IF LESS
.
          BRANCH    CCITEM,CISI0100,CISI0200,CISI0300,CISI0400,CISI0500:
                           CISI0600,CISI0700,CISI0800,CISI0900,CISI1000:
                           CISI1100,CISI1200,CISI1300,CISI1400,CISI1500:
                           CISI1600,CISI1700,CISI1800,CISI1900,CISI2000
          BEEP
          GOTO      CISI0000
.
CISI0100  MOVE      "4",CVERT
          MOVE      CDIETCD,ANS
          CALL      KYND0000
          MOVE      EXIT,CDIETCD
          GOTO      CISI0000
.
CISI0200  MOVE      "5",CVERT
          MOVE      CMEMB,ANS
          CALL      KYND0000
          MOVE      EXIT,CMEMB
          GOTO      CISI0000
.
CISI0300  MOVE      "6",CVERT
          MOVE      CACCLSS,ANS
          CALL      KYND0000
          MOVE      EXIT,CACCLSS
          GOTO      CISI0000
.
CISI0400  MOVE      "7",CVERT
          MOVE      CMEDSERV,ANS
          CALL      KYND0000
          MOVE      EXIT,CMEDSERV
          GOTO      CISI0000
.
CISI0500  MOVE      "8",CVERT
          MOVE      CBOOKG,ANS
          CALL      KYND0000
          MOVE      EXIT,CBOOKG
          GOTO      CISI0000
.
CISI0600  MOVE      "9",CVERT
          MOVE      CMATRN,ANS
          CALL      KYND0000
          MOVE      EXIT,CMATRN
          GOTO      CISI0000
.
CISI0700  MOVE      "10",CVERT
          MOVE      CTHETR,ANS
          CALL      KYND0000
          MOVE      EXIT,CTHETR
          GOTO      CISI0000
.
CISI0800  MOVE      "11",CVERT
          MOVE      PTCNIR31,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNIR31
          GOTO      CISI0000
.
CISI0900  MOVE      "12",CVERT
          MOVE      CGLIND,ANS
          CALL      KYND0000
          MOVE      EXIT,CGLIND
          GOTO      CISI0000
.
CISI1000  MOVE      "13",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,CGLPATH;
          GOTO      CISI0000
.
CISI1100  MOVE      "14",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNCPTH;
          GOTO      CISI0000
.
CISI1200  MOVE      "15",CVERT
          MOVE      CDETENTE,ANS
          CALL      KYND0000
          MOVE      EXIT,CDETENTE
          GOTO      CISI0000
.
CISI1300  MOVE      "16",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,CDETPATH;
          GOTO      CISI0000
.
CISI1400  MOVE      "17",CVERT
          MOVE      PTCNP31G,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNP31G
          GOTO      CISI0000
.
CISI1500  MOVE      "18",CVERT
          MOVE      PTCNP31M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNP31M
          GOTO      CISI0000
.
CISI1600  MOVE      "19",CVERT
          MOVE      PTCNH31G,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNH31G
          GOTO      CISI0000
.
CISI1700  MOVE      "20",CVERT
          MOVE      PTCNH31M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNH31M
          GOTO      CISI0000
.
CISI1800  MOVE      "21",CVERT
          MOVE      PTCNMHBK,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNMHBK
          GOTO      CISI0000
.
CISI1900  MOVE      "22",CVERT
          MOVE      PTCNCRPT,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNCRPT
          GOTO      CISI0000
.
CISI2000  MOVE      "23",CVERT
          MOVE      "Using FMS",BOXHDR
          CALL      LDUFMS00                * Load Using FMS options
          PROC      GENCODKY
          BRANCH    EXIT,CIHS0000
          MOVE      TEMPCODE,PTCNUFMS
          GOTO      CISI0000
.
CISI9000  MOVE      TRUE,EXIT
.
CISI9999  RETURN
+
.********************************************************************
.*  LDUFMS00  :  Load Using FMS option                              *
.*                                                                  *
.********************************************************************
.
LDUFMS00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<3
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DNO,FMSIBA,FMSOTH
            LOAD      TEMPCODE,COUNT,ZERO,ONE,TWO
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
+
.***********************************************************************
.*  CS2I0000  :  Change System/Interfaces  2 details screen            *
.***********************************************************************
+
CS2I0000  MOVE      FALSE,EXIT
          CALL      MAINQST
          MOVE      "44",CCOL
.
          COMPARE   ZERO,CCITEM
          GOTO      CS2I9999 IF EQUAL
          GOTO      CS2I9000 IF LESS
.
          BRANCH    CCITEM,CS2I0100,CS2I0200,CS2I0300,CS2I0400,CS2I0500:
                           CS2I0600,CS2I0700,CS2I0800,CS2I0900,CS2I1000:
                           CS2I1100
          BEEP
          GOTO      CS2I0000
.
.---------------------------------------------------
CS2I0100  MOVE      "4",CVERT
          MOVE      PTCNNHII,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNNHII
          GOTO      CS2I0000
.
.---------------------------------------------------
CS2I0200  MOVE      "5",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNNHID;
          GOTO      CS2I0000
.
.---------------------------------------------------
CS2I0300  MOVE      "6",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNNHIF;
          GOTO      CS2I0000
.
.---------------------------------------------------
CS2I0400  MOVE      "7",CVERT
          MOVE      "Alerts System",BOXHDR
          CALL      LDALRT00                * Load Alerts system being used
          PROC      GENCODKY
          BRANCH    EXIT,CS2I0000
          MOVE      TEMPCODE,PTCNAWRN
          GOTO      CS2I0000
.---------------------------------------------------
.
CS2I0500  MOVE      "8",CVERT
          KEYIN     *P30:CVERT,*V2LON,*RV,PTCNNZED
          GOTO      CS2I0000
.
.---------------------------------------------------
CS2I0600  MOVE      "9",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNEDIF:
                    *PCCOL:CVERT,*DV,PTCNEDIF
          GOTO      CS2I0000
.
.---------------------------------------------------
CS2I0700  MOVE      "10",CVERT
          MOVE      PTCNNZUR,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNNZUR
          GOTO      CS2I0000
.
.---------------------------------------------------
CS2I0800  MOVE      "11",CVERT
          MOVE      PTCNNUMH,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNNUMH
          GOTO      CS2I0000
.
.---------------------------------------------------
CS2I0900  MOVE      "12",CVERT
          DISPLAY   *PCCOL:CVERT,*V2LON,"T-";
          MOVE      CCOL,ECOL
          ADD       "2",ECOL
          KEYIN     *PECOL:CVERT,*V2LON,*RV,PTCNNXTT
          MOVE      PTCNNXTT,KEY6
          REP       " 0",KEY6
          DISPLAY   *PECOL:CVERT,*V2LON,KEY6
          GOTO      CS2I0000
.---------------------------------------------------
.
CS2I1000  MOVE      "13",CVERT
          KEYIN     *P44:CVERT,*V2LON,*DV,PTCNSEND,*P44:CVERT,*RV,PTCNSEND
          GOTO      CS2I0000
.
.---------------------------------------------------
CS2I1100  MOVE      "14",CVERT
          MOVE      PTCNUEDI,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNUEDI
          GOTO      CS2I0000
.
CS2I9000  MOVE      TRUE,EXIT
.
CS2I9999  RETURN
.
.***********************************************************************
.*  CIME0000  :  Change Menu details screen                            *
.***********************************************************************
+
CIME0000  MOVE      FALSE,EXIT
          CALL      MAINQST
          MOVE      "44",CCOL
.
          COMPARE   ZERO,CCITEM
          GOTO      CIME9999 IF EQUAL
          GOTO      CIME9000 IF LESS
.
          BRANCH    CCITEM,CIME0100,CIME0200,CIME0300,CIME0400,CIME0500:
                           CIME0600,CIME0700,CIME0800
          BEEP
          GOTO      CIME0000
.
CIME0100  MOVE      "4",CVERT
          GOTO      CIME0000
.
CIME0200  MOVE      "5",CVERT
          GOTO      CIME0000
.
CIME0300  MOVE      "6",CVERT
          GOTO      CIME0000
.
CIME0400  MOVE      "7",CVERT
          GOTO      CIME0000
.
CIME0500  MOVE      "8",CVERT
          GOTO      CIME0000
.
CIME0600  MOVE      "9",CVERT
          GOTO      CIME0000
.
CIME0700  MOVE      "10",CVERT
          GOTO      CIME0000
.
CIME0800  MOVE      "11",CVERT
          GOTO      CIME0000
.
CIME9000  MOVE      TRUE,EXIT
.
CIME9999  RETURN
+
.***********************************************************************
.*  CIHD0000  :  Change HDP/HCS details screen                         *
.***********************************************************************
+
CIHD0000  MOVE      FALSE,EXIT
          CALL      MAINQST
          MOVE      "44",CCOL
.
          COMPARE   ZERO,CCITEM
          GOTO      CIHD9999 IF EQUAL
          GOTO      CIHD9000 IF LESS
.
          BRANCH    CCITEM,CIHD0100,CIHD0200,CIHD0300,CIHD0400,CIHD0500:
                           CIHD0600,CIHD0700,CIHD0900,CIHD1000:
                           CIHD1100,CIHD1200
          BEEP
          GOTO      CIHD0000
.
CIHD0100  MOVE      "4",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,CHCSUNIQ;
          GOTO      CIHD0000
.
CIHD0200  MOVE      "5",CVERT
          MOVE      CHCS,ANS
          CALL      KYND0000
          MOVE      EXIT,CHCS
          GOTO      CIHD0000
.
CIHD0300  MOVE      "6",CVERT
          MOVE      ZERO,CHIGHLT          *   Highlights on 
          MOVE      ONE,CDEFDTE           *   One Keyin to enter
          MOVE      ZERO,CCANLDTE         *   Default dates cannot be cancelled
          UNPACK    CHCSDTE,CCENT,CYEAR,CMON,CDAY
          CALL      KEYDATE
          PACK      CHCSDTE,CCENT,CYEAR,CMON,CDAY
          REP       " 0",CHCSDTE
          GOTO      CIHD0000
.
CIHD0400  MOVE      "7",CVERT
          GOTO      CIHD0000
.
CIHD0500  MOVE      "8",CVERT
          MOVE      CUSEHCS,ANS
          CALL      KYND0000
          MOVE      EXIT,CUSEHCS
          GOTO      CIHD0000
.
CIHD0600  MOVE      "9",CVERT
          MOVE      PTCNBFHD,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNBFHD
          GOTO      CIHD0000
.
CIHD0700  MOVE      "10",CVERT
          MOVE      PTCNFNHD,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNFNHD
          GOTO      CIHD0000
.
CIHD0900  MOVE      "11",CVERT
          MOVE      PTHCSDOC,ANS
          CALL      KYND0000
          MOVE      EXIT,PTHCSDOC
          GOTO      CIHD0000
.
CIHD1000  MOVE      "12",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNHSSN:
                    *PCCOL:CVERT,*DV,PTCNHSSN;
          GOTO      CIHD0000
.
CIHD1100  MOVE      "13",CVERT
          MOVE      ZERO,CHIGHLT          *   Highlights on 
          MOVE      ONE,CDEFDTE           *   One Keyin to enter
          MOVE      ZERO,CCANLDTE         *   Default dates cannot be cancelled
          UNPACK    CDAILYDT,CCENT,CYEAR,CMON,CDAY
          CALL      KEYDATE
          PACK      CDAILYDT,CCENT,CYEAR,CMON,CDAY
          REP       " 0",CDAILYDT
          GOTO      CIHD0000
.
CIHD1200  MOVE      "14",CVERT
          MOVE      PTCNPRSB,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNPRSB
          GOTO      CIHD0000
.
CIHD9000  MOVE      TRUE,EXIT
.
CIHD9999  RETURN
+
.***********************************************************************
.*  CIIN0000  :  Change Incremental Numbers details screen             *
.***********************************************************************
+
CIIN0000  MOVE      FALSE,EXIT
          CALL      MAINQST
          MOVE      "44",CCOL
.
          COMPARE   ZERO,CCITEM
          GOTO      CIIN9999 IF EQUAL
          GOTO      CIIN9000 IF LESS
.
          BRANCH    CCITEM,CIIN0100,CIIN0200,CIIN0300,CIIN0400,CIIN0500:
                           CIIN0600,CIIN0700,CIIN0800,CIIN0900,CIIN1000:
                           CIIN1100,CIIN1200,CIIN1300,CIIN1400,CIIN1500:
                           CIIN1600
          BEEP
          GOTO      CIIN0000
.
CIIN0100  MOVE      "4",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,NADMNO:
                    *PCCOL:CVERT,*EL,*DV,NADMNO;
          COMPARE   NADMNO,SAVADMN
          IF        !@LESS
            DISPLAY   *P1:24,*EL,"Admission Number Too Low - ";
            CALL      HITENTER
            GOTO      CIIN0100
          ENDIF
          GOTO      CIIN0000
.
CIIN0200  MOVE      "5",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,CRECPNO:
                    *PCCOL:CVERT,*EL,*DV,CRECPNO
          COMPARE   CRECPNO,SAVRECP
          IF        !@LESS
            DISPLAY   *P1:24,*EL,"Receipt Number Too Low - ";
            CALL      HITENTER
            GOTO      CIIN0200
          ENDIF
          GOTO      CIIN0000
.
CIIN0300  MOVE      "6",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,CMEXTINV:
                    *PCCOL:CVERT,*EL,*DV,CMEXTINV
          IF        CMEXTINV<1
            BEEP
            GOTO      CIIN0300
          ENDIF
          GOTO      CIIN0000
.
CIIN0400  MOVE      "7",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,CLHFASS:
                    *PCCOL:CVERT,*EL,*DV,CLHFASS
          GOTO      CIIN0000
.
CIIN0500  MOVE      "8",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,CLHBNO:
                    *PCCOL:CVERT,*EL,*DV,CLHBNO
          GOTO      CIIN0000
.
CIIN0600  MOVE      "9",CVERT
          MOVE      PTCNORNO,TMPORDNO
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNORNO:
                    *PCCOL:CVERT,*EL,*DV,PTCNORNO
          COMPARE   TMPORDNO,PTCNORNO
          IF        @LESS
            DISPLAY   *P1:24,*EL,"Order Number Cannot be Less than ":
                                 "Current Value - ";
            CALL      HITENTER
            GOTO      CIIN0600
          ENDIF
          GOTO      CIIN0000
.
CIIN0700  MOVE      "10",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,CGOVCLIM:
                    *PCCOL:CVERT,*EL,*DV,CGOVCLIM
          GOTO      CIIN0000
.
CIIN0800  MOVE      "11",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,CGADMNO:
                    *PCCOL:CVERT,*EL,*DV,CGADMNO
          GOTO      CIIN0000
.
CIIN0900  MOVE      "12",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNPCSQ:
                    *PCCOL:CVERT,*EL,*DV,PTCNPCSQ
          GOTO      CIIN0000
.
.         Range for Generated Hong Kong National ID's
.
CIIN1000  MOVE      "13",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNHIDF:
                    *PCCOL:CVERT,*DV,PTCNHIDF
          MOVE       PTCNHIDF,VHKID
          CALL       VHID0000                * Validate HKId (Correct Format)
          BRANCH    EXIT,CIIN1000
CIIN1010  ASSIGN    CCOL+12,ECOL 
          KEYIN     *PECOL:CVERT,*V2LON,*RV,PTCNHIDT:
                    *PECOL:CVERT,*EL,*DV,PTCNHIDT
          MOVE       PTCNHIDT,VHKID
          CALL       VHID0000                * Validate HKId (Correct Format)
          BRANCH    EXIT,CIIN1010
          MATCH     PTCNHIDF,PTCNHIDT
          IF        @LESS
            DISPLAY   *P1:24,*B,"Starting HKID is > Ending HKID. ";
            CALL      HITENTER
            GOTO      CIIN1000
          ELSE 
            GOTO      CIIN0000
          ENDIF
.
.         Next Generated Hong Kong National ID Number
.  
CIIN1100  MOVE      "14",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNHIDN:
                    *PCCOL:CVERT,*EL,*DV,PTCNHIDN
          MOVE       PTCNHIDN,VHKID
          CALL       VHID0000                * Validate HKId (Correct Format)
          BRANCH    EXIT,CIIN1100
          MATCH     PTCNHIDN,PTCNHIDT
          IF        @LESS
            DISPLAY   *P1:24,*B,"Next Generated HKID is > Ending HKID. ";
            CALL      HITENTER
            GOTO      CIIN1100
          ENDIF
          MATCH     PTCNHIDF,PTCNHIDN
          IF        @LESS
            DISPLAY   *P1:24,*B,"Starting HKID is > Next Generated HKID. ";
            CALL      HITENTER
            GOTO      CIIN1100
          ENDIF
          GOTO      CIIN0000
.
. ----- EDI batch no -----
.
CIIN1200  MOVE      "15",CVERT
CIIN1210  MOVE      PTCNBTHN,FORM8
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,FORM8;
.
          IF        FORM8<0
            BEEP
            GOTO      CIIN1210
          ENDIF
.
          IF        FORM8<PTCNBTHN
            DISPLAY   *P1:24,*EL,*B,"Batch no must not be before current ":
                      "batch no: ",*V2LON,PTCNBTHN,*HOFF,".  ";
            CALL      HITENTER
            GOTO      CIIN1210
          ENDIF
.
          MOVE      FORM8,PTCNBTHN
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNBTHN;
          GOTO      CIIN0000
.
. ----- ACT Merge Id -----
.
CIIN1300  MOVE      "16",CVERT
CIIN1310  MOVE      PTCNAMUI,FORM10
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,FORM10;
.
          IF        FORM10<0
            BEEP
            GOTO      CIIN1310
          ENDIF
.
          IF        FORM10<PTCNAMUI
            DISPLAY   *P1:24,*EL,*B,"ACT merge Id must not be before current ":
                      "merge id: ",*V2LON,PTCNAMUI,*HOFF,".  ";
            CALL      HITENTER
            GOTO      CIIN1310
          ENDIF
.
          MOVE      FORM10,PTCNAMUI
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNAMUI;
          GOTO      CIIN0000
.
CIIN1400  MOVE      "17",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNQUOT:
                    *PCCOL:CVERT,*EL,*DV,PTCNQUOT
          IF        PTCNQUOT<1
            BEEP
            GOTO      CIIN1400
          ENDIF
          GOTO      CIIN0000
.
. ----- Next Batch Number -----
.
CIIN1500  MOVE      "18",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNBNUM:
                    *PCCOL:CVERT,*EL,*DV,PTCNBNUM
          IF        PTCNBNUM<1
            BEEP
            GOTO      CIIN1500
          ENDIF
          GOTO      CIIN0000
.
CIIN9000  MOVE      TRUE,EXIT
.
CIIN9999  RETURN
.
. ----- Next Credit Note Number -----
.
CIIN1600  MOVE      "19",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNCRNO:
                    *PCCOL:CVERT,*EL,*DV,PTCNCRNO
          IF        PTCNCRNO<1
            BEEP
            GOTO      CIIN1600
          ENDIF
          GOTO      CIIN0000
+
.***********************************************************************
.*  CIUF0000  :  Change Using Fields details screen                    *
.***********************************************************************
+
CIUF0000  MOVE      FALSE,EXIT
          CALL      MAINQST
          MOVE      "44",CCOL
.
          COMPARE   ZERO,CCITEM
          GOTO      CIUF9999 IF EQUAL
          GOTO      CIUF9000 IF LESS
          MOVE      "44",CCOL
.
          BRANCH    CCITEM,CIUF0100,CIUF0200,CIUF0300,CIUF0400,CIUF0500:
                           CIUF0600,CIUF0700,CIUF0800,CIUF0900,CIUF1000:
                           CIUF1100,CIUF1200,CIUF1300,CIUF1400,CIUF1500:
                           CIUF1600,CIUF1700,CIUF1800
          BEEP
          GOTO      CIUF0000
.
CIUF0100  MOVE      "4",CVERT
          MOVE      PTCNUADT,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNUADT
          GOTO      CIUF0000
.
CIUF0200  MOVE      "5",CVERT
          MOVE      "Inpatient Daily Charging File",BOXHDR
          CALL      LDDCHG00                * Load Daily Charging Types
          PROC      GENCODKY
          BRANCH    EXIT,CIUF0000
          MOVE      TEMPCODE,CFEETYP
          GOTO      CIUF0000
.
CIUF0300  MOVE      "6",CVERT
          MOVE      PTCNNUMM,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNNUMM
          GOTO      CIUF0000
.
CIUF0400  MOVE      "7",CVERT
          MOVE      PTCNDAYF,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDAYF
          GOTO      CIUF0000
.
CIUF0500  
          GOTO      CIUF0000
.
CIUF0600  DISPLAY   *P1:24,*EL,*B,"This option is no longer available.  ";
          CALL      HITENTER
          GOTO      CIUF0000
.
..CIUF0600  MOVE      "9",CVERT
..          MOVE      PTCNUUNA,ANS
..          CALL      KYND0000
..          MOVE      EXIT,PTCNUUNA
..          GOTO      CIUF0000
.
CIUF0700  MOVE      "10",CVERT
          MOVE      PTCNUURC,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNUURC
          GOTO      CIUF0000
.
CIUF0800  MOVE      "11",CVERT
          MOVE      PTCNMSDF,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNMSDF
          GOTO      CIUF0000
.
CIUF0900  MOVE      "12",CVERT
          MOVE      PTCNUCSL,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNUCSL
          GOTO      CIUF0000
.
CIUF1000  MOVE      "13",CVERT
          MOVE      PTCNSTAU,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSTAU
          GOTO      CIUF0000
.
CIUF1100  MOVE      "14",CVERT
          MOVE      PTCNNEWS,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNNEWS
          GOTO      CIUF0000
.
CIUF1200  MOVE      "15",CVERT
          MOVE      PTCNRESB,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNRESB
          GOTO      CIUF0000
.
CIUF1300  MOVE      "16",CVERT
          MOVE      PTCNUADM,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNUADM
          GOTO      CIUF0000
.
CIUF1400  MOVE      "17",CVERT
          MOVE      PTCNAXEU,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNAXEU
          GOTO      CIUF0000
.
CIUF1500  MOVE      "18",CVERT
          MOVE      PTCNUCGP,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNUCGP
          GOTO      CIUF0000
.
CIUF1600  MOVE      "19",CVERT
          MOVE      PTCNIPEN,ANS
          CALL      KNYD0000
          MOVE      EXIT,PTCNIPEN
          GOTO      CIUF0000
.
CIUF1700  MOVE      "20",CVERT
          MOVE      PTCNTFEE,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNTFEE
          GOTO      CIUF0000
.
CIUF1800  MOVE      "21",CVERT
          MOVE      PTSGCOPT,ANS
          CALL      KYND0000
          MOVE      EXIT,PTSGCOPT
          GOTO      CIUF0000
.
CIUF9000  MOVE      TRUE,EXIT
.
CIUF9999  RETURN
+
.***********************************************************************
.*  CIUR0000  :  Change U/R Based details screen                       *
.***********************************************************************
+
CIUR0000  MOVE      FALSE,EXIT
          CALL      MAINQST
          MOVE      "44",CCOL
.
          COMPARE   ZERO,CCITEM
          GOTO      CIUR9999 IF EQUAL
          GOTO      CIUR9000 IF LESS
.
          BRANCH    CCITEM,CIUR0100,CIUR0200,CIUR0300,CIUR0400,CIUR0500:
                           CIUR0600,CIUR0700,CIUR0800,CIUR0900,CIUR1000:
                           CIUR1100,CIUR1200,CIUR1300,CIUR1400
          BEEP
          GOTO      CIUR0000
.
CIUR0100  MOVE      "4",CVERT
          MOVE      PTCNAUNB,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNAUNB
          GOTO      CIUR0000
.
CIUR0200  
          GOTO      CIUR0000
.
CIUR0300  MOVE      "6",CVERT
          MOVE      "Generate U/R Automatically",BOXHDR
          CALL      LDGNUR00                * Load U/R Generation Types
          PROC      GENCODKY
          BRANCH    EXIT,CIUR0000
          MOVE      TEMPCODE,CGENRUR
          GOTO      CIUR0000
.
CIUR0400  MOVE      "7",CVERT
          MOVE      CMERGURS,ANS
          CALL      KYND0000
          MOVE      EXIT,CMERGURS
          GOTO      CIUR0000
.
CIUR0500  MOVE      "8",CVERT
          MOVE      "Link Between U/R's",BOXHDR
          CALL      LDURLN00                * Load U/R Link Types
          PROC      GENCODKY
          BRANCH    EXIT,CIUR0000
          MOVE      TEMPCODE,PTCNNMPI
          GOTO      CIUR0000
.
CIUR0600  MOVE      "9",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNNMDX;
          GOTO      CIUR0000
.
CIUR0700  MOVE      "10",CVERT
          MOVE      PTCNNULU,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNNULU
          GOTO      CIUR0000
.
CIUR0800  MOVE      "11",CVERT
          MOVE      "U/R Validation in HOS59",BOXHDR
          CALL      LDUVLD00                * Load Yes/No Field
          PROC      GENCODKY
          BRANCH    EXIT,CIUR0000
          MOVE      TEMPCODE,PTCNH59V
          GOTO      CIUR0000
.
CIUR0900  MOVE      "12",CVERT
          MOVE      PTCNRPIK,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNRPIK
          GOTO      CIUR0000
.
CIUR1000  MOVE      "13",CVERT
          MOVE      PTCNSOUC,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSOUC
          GOTO      CIUR0000
.
CIUR1100  MOVE      "14",CVERT
          MOVE      PTCNULUE,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNULUE
          GOTO      CIUR0000
.
CIUR1200  MOVE      "15",CVERT
          MOVE      PTCNUVSM,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNUVSM
          GOTO      CIUR0000
.
CIUR1300  CALL      KVSDF000
          GOTO      CIUR0000
.
CIUR1400  MOVE      "17",CVERT
          MOVE      PTCNSVOD,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSVOD
          GOTO      CIUR0000
.
CIUR9000  MOVE      TRUE,EXIT
.
CIUR9999  RETURN
+
.***********************************************************************
.*  CIPM0000  :  Change PMI details screen                             *
.***********************************************************************
+
CIPM0000  MOVE      FALSE,EXIT
          CALL      MAINQST
          MOVE      "44",CCOL
.
          COMPARE   ZERO,CCITEM
          GOTO      CIPM9999 IF EQUAL
          GOTO      CIPM9000 IF LESS
.
          BRANCH    CCITEM,CIPM0100,CIPM0200,CIPM0300,CIPM0400,CIPM0500:
                           CIPM0600,CIPM0700,CIPM0800,CIPM0050,CIPM1000:
                           CIPM1100,CIPM1200,CIPM1300,CIPM1400,CIPM1500:
                           CIPM1600,CIPM1700,CIPM1800,CIPM1900
                    
CIPM0050  BEEP
          GOTO      CIPM0000
.
CIPM0100  GOTO      CIPM0000
.
CIPM0200  MOVE      "5",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNCNFA;
          GOTO      CIPM0000
.
CIPM0300  MOVE      "6",CVERT
          MOVE      "Person to Contact",BOXHDR
          CALL      LDPERS00                * Load Person Responsible Types
          PROC      GENCODKY
          BRANCH    EXIT,CIPM0000
          MOVE      TEMPCODE,CPCONT
          GOTO      CIPM0000
.
CIPM0400  MOVE      "7",CVERT
          MOVE      "PAtient Condition Description",BOXHDR
          CALL      LDCOND00                * Load Patient Condition Types
          PROC      GENCODKY
          BRANCH    EXIT,CIPM0000
          MOVE      TEMPCODE,CPCFORM
          GOTO      CIPM0000
.
CIPM0500  MOVE      "8",CVERT
          MOVE      "Post Code Format",BOXHDR
          CALL      LDPSTC00                * Load Post Code Format Types
          PROC      GENCODKY
          BRANCH    EXIT,CIPM0000
          MOVE      TEMPCODE,CPOSTCD
          GOTO      CIPM0000
.
CIPM0600  GOTO      CIPM0000                * Option removed V.10.B01
.
CIPM0700  MOVE      "10",CVERT
          MOVE      PTCNRGNS,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNRGNS
          GOTO      CIPM0000
.
CIPM0800  MOVE      "11",CVERT
          MOVE      PTCNICAD,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNICAD
          GOTO      CIPM0000
.
CIPM1000  MOVE      "13",CVERT
          MOVE      PTCNRSGS,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNRSGS
          GOTO      CIPM0000
.
CIPM1100  MOVE      "14",CVERT
          MOVE      PTCNPCKL,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNPCKL
          GOTO      CIPM0000
.
CIPM1200  MOVE      "15",CVERT
          MOVE      PTCNDOBS,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDOBS
          GOTO      CIPM0000
.
CIPM1300  MOVE      "16",CVERT
          MOVE      PTCNDEFT,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDEFT
          GOTO      CIPM0000
.
CIPM1400  MOVE      "17",CVERT
          MOVE      PTCNUDRG,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNUDRG
          GOTO      CIPM0000
.
CIPM1500  MOVE      "18",CVERT
          MOVE      "Cancellation code for W/L Death",BOXHDR
          MOVE      CODEWR,CODE             * set the category
          CALL      LPTCD000
          PROC      GENCODKY
          BRANCH    EXIT,CIPM0000
          MOVE      TEMPCODE,PTCNWDTH
          GOTO      CIPM0000
.
CIPM1600  MOVE      "19",CVERT
          MOVE      "Cancellation code for I/P Death",BOXHDR
          MOVE      CODEPC,CODE             * set the category
          CALL      LPTCD000
          PROC      GENCODKY
          BRANCH    EXIT,CIPM0000
          MOVE      TEMPCODE,PTCNIDTH
          GOTO      CIPM0000
.
CIPM1700  MOVE      "20",CVERT
          MOVE      "Cancellation code for O/P Death",BOXHDR
          MOVE      CODECB,CODE             * set the category
          CALL      LPTCD000
          PROC      GENCODKY
          BRANCH    EXIT,CIPM0000
          MOVE      TEMPCODE,PTCNODTH
          GOTO      CIPM0000
.
CIPM1800  MOVE      "21",CVERT
          MOVE      "Cancellation code for Bkg Death",BOXHDR
          MOVE      CODEBC,CODE             * set the category
          CALL      LPTCD000
          PROC      GENCODKY
          BRANCH    EXIT,CIPM0000
          MOVE      TEMPCODE,PTCNBDTH
          GOTO      CIPM0000
.
CIPM1900  MOVE      "22",CVERT
          MOVE      "Cancellation code for OPR Death",BOXHDR
          MOVE      CODESC,CODE             * set the category
          CALL      LPTCD000
          PROC      GENCODKY
          BRANCH    EXIT,CIPM0000
          MOVE      TEMPCODE,PTCNTDTH
          GOTO      CIPM0000
.
CIPM9000  MOVE      TRUE,EXIT
.
CIPM9999  RETURN
+
.***********************************************************************
.*  CI1F0000  :  Change Financial (1) details screen                   *
.***********************************************************************
+
CI1F0000  MOVE      FALSE,EXIT
          CALL      MAINQST
          MOVE      "44",CCOL
.
          COMPARE   ZERO,CCITEM
          GOTO      CI1F9999 IF EQUAL
          GOTO      CI1F9000 IF LESS
.
          BRANCH    CCITEM,CI1F0100,CI1F0200,CI1F0300,CI1F0400,CI1F0500:
                           CI1F0600,CI1F0700,CI1F0800,CI1F0900,CI1F1000:
                           CI1F1100,CI1F1200,CI1F1300,CI1F1400,CI1F1500:
                           CI1F1600,CI1F1700,CI1F1800,CI1F1900
          BEEP
          GOTO      CI1F0000
.
CI1F0100  BEEP
          GOTO      CI1F0000
.
CI1F0200  MOVE      "5",CVERT
          MOVE      ZERO,CHIGHLT          *   Highlights on 
          MOVE      ONE,CDEFDTE           *   One Keyin to enter
          MOVE      ZERO,CCANLDTE         *   Default dates cannot be cancelled
          UNPACK    CFEEDT,CCENT,CYEAR,CMON,CDAY
          CALL      KEYDATE
          PACK      CFEEDT,CCENT,CYEAR,CMON,CDAY
          REP       " 0",CFEEDT
          GOTO      CI1F0000
.
CI1F0300  MOVE      "6",CVERT
          MOVE      ZERO,CHIGHLT          *   Highlights on 
          MOVE      ONE,CDEFDTE           *   One Keyin to enter
          MOVE      ZERO,CCANLDTE         *   Default dates cannot be cancelled
          UNPACK    CLACDATE,CCENT,CYEAR,CMON,CDAY
          CALL      KEYDATE
          PACK      CLACDATE,CCENT,CYEAR,CMON,CDAY
          REP       " 0",CLACDATE
          GOTO      CI1F0000
.
CI1F0400  MOVE      "7",CVERT
          MOVE      ZERO,CHIGHLT          *   Highlights on 
          MOVE      ONE,CDEFDTE           *   One Keyin to enter
          MOVE      ZERO,CCANLDTE         *   Default dates cannot be cancelled
          UNPACK    UPMONTH,CCENT,CYEAR,CMON
          CALL      KEYMONTH
          PACK      UPMONTH,CCENT,CYEAR,CMON
          REP       " 0",UPMONTH
          GOTO      CI1F0000
.
CI1F0500  MOVE      "8",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,*JR,CPERMTH;
          GOTO      CI1F0000
.
CI1F0600  MOVE      "9",CVERT
          MOVE      "Accumulation of Fees Inv.",BOXHDR
          CALL      LDFEEI00                * Load Fee's Invoice Acc Types
          PROC      GENCODKY
          BRANCH    EXIT,CI1F0000
          MOVE      TEMPCODE,CACCFEE
          GOTO      CI1F0000
.
CI1F0700  MOVE      "10",CVERT
          MOVE      "Age Trial Balance Reports",BOXHDR
          CALL      LDATBR00                * Load Age Trail Balance Repot Types
          PROC      GENCODKY
          BRANCH    EXIT,CI1F0000
          MOVE      TEMPCODE,CATBLAY
          GOTO      CI1F0000
.
CI1F0800  MOVE      "11",CVERT
          MOVE      CFUTENQ,ANS
          CALL      KYND0000
          MOVE      EXIT,CFUTENQ
          GOTO      CI1F0000
.
CI1F0900  MOVE      "12",CVERT
          MOVE      CPRTREC,ANS
          CALL      KYNO0000
          MOVE      EXIT,CPRTREC
          GOTO      CI1F0000
.
CI1F1000  MOVE      "13",CVERT
          MOVE      COTHSFN,ANS
          CALL      KYND0000
          MOVE      EXIT,COTHSFN
          GOTO      CI1F0000
.
CI1F1100  MOVE      "14",CVERT
          MOVE      CCARECL,ANS
          CALL      KYND0000
          MOVE      EXIT,CCARECL
          GOTO      CI1F0000
.
CI1F1200  MOVE      "15",CVERT
          MOVE      ZERO,CHIGHLT          *   Highlights on 
          MOVE      ONE,CDEFDTE           *   One Keyin to enter
          MOVE      ZERO,CCANLDTE         *   Default dates cannot be cancelled
          UNPACK    PTCFEEAE,CCENT,CYEAR,CMON,CDAY
          CALL      KEYDATE
          PACK      PTCFEEAE,CCENT,CYEAR,CMON,CDAY
          REP       " 0",PTCFEEAE
          GOTO      CI1F0000
.
CI1F1300  MOVE      "16",CVERT
          MOVE      ZERO,CHIGHLT          *   Highlights on 
          MOVE      ONE,CDEFDTE           *   One Keyin to enter
          MOVE      ZERO,CCANLDTE         *   Default dates cannot be cancelled
          UNPACK    PTCFEEOP,CCENT,CYEAR,CMON,CDAY
          CALL      KEYDATE
          PACK      PTCFEEOP,CCENT,CYEAR,CMON,CDAY
          REP       " 0",PTCFEEOP
          GOTO      CI1F0000
.
CI1F1400  MOVE      "17",CVERT
          MOVE      ZERO,CHIGHLT          *   Highlights on 
          MOVE      ONE,CDEFDTE           *   One Keyin to enter
          MOVE      ZERO,CCANLDTE         *   Default dates cannot be cancelled
          UNPACK    PTCFEEOF,CCENT,CYEAR,CMON,CDAY
          CALL      KEYDATE
          PACK      PTCFEEOF,CCENT,CYEAR,CMON,CDAY
          REP       " 0",PTCFEEOF
          GOTO      CI1F0000
.
CI1F1500  MOVE      "18",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNMXCH;
          IF        PTCNMXCH<0
            DISPLAY   *P1:24,*EL,"Value Must be Greater than Zero - ";
            CALL      HITENTER
            GOTO      CI1F1500
          ENDIF
          GOTO      CI1F0000
.
CI1F1600  MOVE      "19",CVERT
          MOVE      CMCNOHF,ANS
          CALL      KYND0000
          MOVE      EXIT,CMCNOHF
          GOTO      CI1F0000
.
CI1F1700  MOVE      "20",CVERT
          MOVE      "Date of Journal",BOXHDR
          CALL      LDJRND00                * Load Journal Date Types
          PROC      GENCODKY
          BRANCH    EXIT,CI1F0000
          MOVE      TEMPCODE,CJRNREP
          GOTO      CI1F0000
.
CI1F1800  MOVE      "21",CVERT
          MOVE      CREBPORT,ANS
          CALL      KYND0000
          MOVE      EXIT,CREBPORT
          GOTO      CI1F0000
.
CI1F1900  MOVE      "22",CVERT
          MOVE      ZERO,CHIGHLT          *   Highlights on 
          MOVE      ONE,CDEFDTE           *   One Keyin to enter
          MOVE      ZERO,CCANLDTE         *   Default dates cannot be cancelled
          UNPACK    PTCNNDAT,CCENT,CYEAR,CMON,CDAY
          CALL      KEYDATE
          PACK      PTCNNDAT,CCENT,CYEAR,CMON,CDAY
          REP       " 0",PTCNNDAT
          GOTO      CI1F0000
.
CI1F9000  MOVE      TRUE,EXIT
.
CI1F9999  RETURN
+
.***********************************************************************
.*  CI2F0000  :  Change Financial (2) details screen                   *
.***********************************************************************
CI2F0000  MOVE      FALSE,EXIT
          CALL      MAINQST
          MOVE      "44",CCOL
          COMPARE   ZERO,CCITEM
          GOTO      CI2F9999 IF EQUAL
          GOTO      CI2F9000 IF LESS
.
          BRANCH    CCITEM,CI2F0100,CI2F0200,CI2F0300,CI2F0400,CI2F0500:
                           CI2F0600,CI2F0700,CI2F0800,CI2F0900,CI2F1000:
                           CI2F1100,CI2F1200
.
          BEEP
          GOTO      CI2F0000
.
CI2F0100  MOVE      "4",CVERT
          MOVE      PTCNADBF,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNADBF
          GOTO      CI2F0000
.
CI2F0200  MOVE      "5",CVERT
          MOVE      PTRESDAY,ANS
          CALL      KYND0000
          MOVE      EXIT,PTRESDAY
          GOTO      CI2F0000
.
CI2F0300  MOVE      "6",CVERT
          MOVE      PTCNBDOM,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNBDOM
          GOTO      CI2F0000
.
CI2F0400  MOVE      "7",CVERT
          MOVE      PTCNUBRD,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNUBRD
          GOTO      CI2F0000
.
CI2F0500  MOVE      "8",CVERT
          MOVE      PTCNGSTF,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNGSTF
          GOTO      CI2F0000
.
CI2F0600  MOVE      "9",CVERT
          MOVE      "Claim Code for Reference Rate",BOXHDR
          MOVE      CODECL,CODE             * set the category
          CALL      LPTCD000
          PROC      GENCODKY
          BRANCH    EXIT,CI2F0000
          MOVE      TEMPCODE,PTCNCCRR
          GOTO      CI2F0000
.
CI2F0700  MOVE      "10",CVERT
          MOVE      PTCNCLOR,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNCLOR
          GOTO      CI2F0000
.
CI2F0800  MOVE      "11",CVERT
          MOVE      PTCNADDC,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNADDC
          GOTO      CI2F0000
.
CI2F0900  MOVE      "12",CVERT
          MOVE      PTCNMITM,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNMITM
          GOTO      CI2F0000
.
CI2F1000  MOVE      "12",CVERT
          ASSIGN    PTCNBTNM+1,FORM1
          LOAD      DDBILTM,FORM1,DBILTM1,DBILTM2
.
          KEYIN     *P44:13,*EL,*DV,PTCNBTNM,*P48:13,*DV,DDBILTM,*P1:24,*EL:
                    *V2LON,"0",*HOFF," = ",*DV,DBILTM1:
                    *V2LON," 1",*HOFF," = ",*DV,DBILTM2:
                    *P44:13,*V2LON,PTCNBTNM;
.
          IF        PTCNBTNM<0 | PTCNBTNM>1
            BEEP
            DISPLAY *P1:24,"Option must be 0 or 1 : ";
            CALL    HITENTER
            ASSIGN  FORM1-1,PTCNBTNM
            GOTO    CI2F1000
          ENDIF
.
          ASSIGN    PTCNBTNM+1,FORM1
          LOAD      DDBILTM,FORM1,DBILTM1,DBILTM2
          DISPLAY   *P48:13,*EL,DDBILTM;
          GOTO      CI2F0000
.
CI2F1100  MOVE      "14",CVERT
          MOVE      "Accum. of Misc. Fees Inv.",BOXHDR
          CALL      LDMFEE00                * Load Misc. Fees Invoiced
          PROC      GENCODKY
          BRANCH    EXIT,CI2F0000
          MOVE      TEMPCODE,PTCNMFEE
          GOTO      CI2F0000
.
CI2F1200  MOVE      "15",CVERT
          MOVE      "Accum. of Jour. Fees Inv.",BOXHDR
          CALL      LDJFEE00                * Load Journal Fees Invoiced
          PROC      GENCODKY
          BRANCH    EXIT,CI2F0000
          MOVE      TEMPCODE,PTCNJFEE
          GOTO      CI2F0000
.
CI2F9000  MOVE      TRUE,EXIT
.
CI2F9999  RETURN
+
.***********************************************************************
.*  CILI0000  :  Change Labels/Id Sheets details screen                *
.***********************************************************************
+
CILI0000  MOVE      FALSE,EXIT
          CALL      MAINQST
          MOVE      "44",CCOL
.
          COMPARE   ZERO,CCITEM
          GOTO      CILI9999 IF EQUAL
          GOTO      CILI9000 IF LESS
.
          BRANCH    CCITEM,CILI0100,CILI0200,CILI0300,CILI0400
.
          BEEP
          GOTO      CILI0000
.
CILI0100  MOVE      "4",CVERT
          MOVE      PTCNFFLL,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNFFLL
          GOTO      CILI0000
.
CILI0200  MOVE      "5",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,CADDLAB;
          GOTO      CILI0000
.
CILI0300  MOVE      "6",CVERT
          MOVE      CIDENT,ANS
          CALL      KYND0000
          MOVE      EXIT,CIDENT
          GOTO      CILI0000
.
CILI0400  MOVE      "7",CVERT
          MOVE      "Id Sheet Layout",BOXHDR
          CALL      LDIDSL00                * Load Invoice Layout Types
          PROC      GENCODKY
          BRANCH    EXIT,CILI0000
          MOVE      TEMPCODE,CIDLAY
          GOTO      CILI0000
.
CILI9000  MOVE      TRUE,EXIT
.
CILI9999  RETURN
+
.***********************************************************************
.*  CIIV0000  :  Change Invoice details screen                         *
.***********************************************************************
+
CIIV0000  MOVE      FALSE,EXIT
          MOVE      "61",CCOL
.
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CIIV9999 IF EQUAL
          GOTO      CIIV9000 IF LESS
.
          BRANCH    CCITEM,CIIV0100,CIIV0200,CIIV0300,CIIV0400,CIIV0500:
                           CIIV0600,CIIV0700,CIIV0800          * C-48227
.
          BEEP
          GOTO      CIIV0000
.
CIIV0100  MOVE      "4",CVERT
          MOVE      "Invoice Layout",BOXHDR
          CALL      LDINVL00                * Load Invoice Layouts
          PROC      GENCODKY
          BRANCH    EXIT,CIIV0000
          MOVE      TEMPCODE,PTCNINVL
          MOVE      PTCNINVL,FORM2
.
          IF        PTCNINVL > 9
            MOVE      NINE,CINVLAY
            SUB       NINE,PTCNINVL
          ELSE
            MOVE      PTCNINVL,CINVLAY
            MOVE      ZERO,PTCNINVL
          ENDIF
.
          MOVE      ONE,CINVFF
          LOAD      CINVFF,FORM2,ONE,TWO,ONE,TWO,TWO:
                                 TWO,TWO,TWO,TWO,TWO:
                                 TWO,TWO,TWO,TWO
.
          GOTO      CIIV0000
.
CIIV0200  MOVE      "5",CVERT
          MOVE      CFUTINV,ANS
          CALL      KYND0000
          MOVE      EXIT,CFUTINV
          GOTO      CIIV0000
.
CIIV0300  MOVE      "6",CVERT
          MOVE      CINVJRN,ANS
          CALL      KYND0000
          MOVE      EXIT,CINVJRN
          GOTO      CIIV0000
.
CIIV0400  MOVE      "7",CVERT
          MOVE      PTCNSTMS,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSTMS
          GOTO      CIIV0000
.
CIIV0500  MOVE      "8",CVERT
          MOVE      PTCNSUFA,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSUFA
          GOTO      CIIV0000
.
. ----- Which desc.to use for zero addition charge -----
.
CIIV0600  DISPLAY   *P1:24,*EL,"0=Display Daily Charge  ":
                               " 1=Display Additional Charge";
.
CIIV0671  MOVE      "9",CVERT
          KEYIN     *PCCOL:CVERT,*EL,*DV,PTCNADES:
                    *PCCOL:CVERT,*V2LON,*RV,PTCNADES:
                    *PCCOL:CVERT,*DV,PTCNADES;
.
          IF        PTCNADES<>0 & PTCNADES<>1
            BEEP
            GOTO      CIIV0671
          ENDIF
.
          MOVE      ADESC0,ADB1DESC
          LOAD      ADB1DESC,PTCNADES,ADESC1
          DISPLAY   *PCCOL:CVERT,*V2LON,PTCNADES,*HOFF,SP2,ADB1DESC;
          GOTO      CIIV0000
.
. ----- Print 'To be Invoiced' on Fees Invoice ---
.
CIIV0700  MOVE      "10",CVERT
          MOVE      PTCNPFID,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNPFID
          GOTO      CIIV0000
.
. ----- Generate BPAY Customer Reference Number ---
.
CIIV0800  MOVE      "11",CVERT        * I-48227
          MOVE      PTCNBPAY,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNBPAY
          GOTO      CIIV0000          * end I-48227
.
CIIV9000  MOVE      TRUE,EXIT
.
CIIV9999  RETURN
+
.***********************************************************************
.*  CICO0000  :  Change Comments details screen                        *
.***********************************************************************
+
CICO0000  MOVE      FALSE,EXIT
          MOVE      "44",CCOL
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CICO9999 IF EQUAL
          GOTO      CICO9000 IF LESS
.
          BRANCH    CCITEM,CICO0100,CICO0200,CICO0300
.
          BEEP
          GOTO      CICO0000
.
CICO0100  MOVE      "4",CVERT
          MOVE      PTCNURCO,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNURCO
          GOTO      CICO0000
.
CICO0200  MOVE      "5",CVERT
          MOVE      CFUTCOM,ANS
          CALL      KYND0000
          MOVE      EXIT,CFUTCOM
          GOTO      CICO0000
.
CICO0300  MOVE      "6",CVERT
          MOVE      CCHGCMN,ANS
          CALL      KYND0000
          MOVE      EXIT,CCHGCMN
          GOTO      CICO0000
.
CICO9000  MOVE      TRUE,EXIT
.
CICO9999  RETURN
+
.***********************************************************************
.*  CILS0000  :  Change Length of Stay details screen                  *
.***********************************************************************
+
CILS0000  MOVE      FALSE,EXIT
          MOVE      "44",CCOL
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CILS9999 IF EQUAL
          GOTO      CILS9000 IF LESS
.
          BRANCH    CCITEM,CILS0100,CILS0200,CILS0300,CILS0400,CILS0500:
                           CILS0600,CILS0700,CILS0800,CILS0900
          BEEP
          GOTO      CILS0000
.
CILS0100  MOVE      "4",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNLOS1:
                    *PCCOL:CVERT,*EL,*DV,PTCNLOS1;
          IF        PTCNLOS1<0
            DISPLAY   *P1:24,*EL,"Range Must be Greater than Zero - ";
            CALL      HITENTER
            GOTO      CILS0100
          ENDIF
          GOTO      CILS0000
.
CILS0200  MOVE      "5",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNLOS2:
                    *PCCOL:CVERT,*EL,*DV,PTCNLOS2;
          IF        PTCNLOS2<=PTCNLOS1
            DISPLAY   *P1:24,*EL,"Range Must be Greater than ",PTCNLOS1," - ";
            CALL      HITENTER
            GOTO      CILS0200
          ENDIF
          GOTO      CILS0000
.
CILS0300  MOVE      "6",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNLOS3:
                    *PCCOL:CVERT,*EL,*DV,PTCNLOS3;
          IF        PTCNLOS3<=PTCNLOS2
            DISPLAY   *P1:24,*EL,"Range Must be Greater than ",PTCNLOS2," - ";
            CALL      HITENTER
            GOTO      CILS0300
          ENDIF
          GOTO      CILS0000
.
CILS0400  MOVE      "7",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNELDR:
                    *PCCOL:CVERT,*EL,*DV,PTCNELDR;
          GOTO      CILS0000
.
CILS0500  MOVE      "8",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNLSR1:
                    *PCCOL:CVERT,*EL,*DV,PTCNLSR1;
          IF        PTCNLSR1<0
            DISPLAY   *P1:24,*EL,"Range Must be Greater than Zero - ";
            CALL      HITENTER
            GOTO      CILS0500
          ENDIF
          GOTO      CILS0000
.
CILS0600  MOVE      "9",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNLSR2:
                    *PCCOL:CVERT,*EL,*DV,PTCNLSR2;
          IF        PTCNLSR2<=PTCNLSR1
            DISPLAY   *P1:24,*EL,"Range Must be Greater than ",PTCNLSR1," - ";
            CALL      HITENTER
            GOTO      CILS0600
          ENDIF
          GOTO      CILS0000
.
CILS0700  MOVE      "10",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNLSR3:
                    *PCCOL:CVERT,*EL,*DV,PTCNLSR3;
          IF        PTCNLSR3<=PTCNLSR2
            DISPLAY   *P1:24,*EL,"Range Must be Greater than ",PTCNLSR2," - ";
            CALL      HITENTER
            GOTO      CILS0700
          ENDIF
          GOTO      CILS0000
.
CILS0800  MOVE      "11",CVERT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,PTCNLSR4:
                    *PCCOL:CVERT,*EL,*DV,PTCNLSR4;
          IF        PTCNLSR4<=PTCNLSR3
            DISPLAY   *P1:24,*EL,"Range Must be Greater than ",PTCNLSR3," - ";
            CALL      HITENTER
            GOTO      CILS0800
          ENDIF
          GOTO      CILS0000
.
CILS0900  MOVE      "12",CVERT
          MOVE      "Occ Bed Days for LOS",BOXHDR
          CALL      LDBDLS00                * Load Occupied Bed Days L.O.S.
          PROC      GENCODKY
          BRANCH    EXIT,CILS0000
          MOVE      TEMPCODE,PTOCBDAY
          GOTO      CILS0000
.
CILS9000  MOVE      TRUE,EXIT
.
CILS9999  RETURN
+
.***********************************************************************
.*  CIAD0000  :  Change Admission details screen                       *
.***********************************************************************
+
CIAD0000  MOVE      FALSE,EXIT
          MOVE      "56",CCOL
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CIAD9999 IF EQUAL
          GOTO      CIAD9000 IF LESS
.
          BRANCH    CCITEM,CIAD0100,CIAD0200,CIAD0300,CIAD0400,CIAD0500:
                           CIAD0600,CIAD0700,CIAD0800,CIAD0900,CIAD1000:
                           CIAD1100,CIAD1200,CIAD1300,CIAD1400,CIAD1500:
                           CIAD1600,CIAD1700,CIAD1800
          BEEP
          GOTO      CIAD0000
.
CIAD0100  MOVE      "4",CVERT
          MOVE      PTCNTLVE,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNTLVE
          GOTO      CIAD0000
.
CIAD0200  GOTO      CIAD0000
.
CIAD0300  MOVE      "6",CVERT
          MOVE      "Separation Mode Varible",BOXHDR
          CALL      LDSEPM00                * Load Separation Mode
          PROC      GENCODKY
          BRANCH    EXIT,CIAD0000
          MOVE      TEMPCODE,PTCNDRSM
          GOTO      CIAD0000
.
CIAD0400  MOVE      "7",CVERT
          MOVE      PTCNVDDI,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNVDDI
          GOTO      CIAD0000
.
CIAD0500  MOVE      "8",CVERT
          MOVE      CASSOCD,ANS
          CALL      KYND0000
          MOVE      EXIT,CASSOCD
          GOTO      CIAD0000
.
CIAD0600  MOVE      "9",CVERT
          MOVE      "Code for Home Base",BOXHDR
          MOVE      CODEU1,CODE             * set the category
          CALL      LPTCD000                * Load Category U1
          PROC      GENCODKY
          BRANCH    EXIT,CIAD0000
          MOVE      TEMPCODE,CHOMBAS
          GOTO      CIAD0000
.
CIAD0700  MOVE      "10",CVERT
          MOVE      "Claims P.R.A.",BOXHDR
          CALL      LDPRAC00                * Load Yes/No Field
          PROC      GENCODKY
          BRANCH    EXIT,CIAD0000
          MOVE      TEMPCODE,FORM2
          LOAD      PTPCLRES,FORM2,ZERO,ONE,TWO,THREE   * post correct number
          GOTO      CIAD0000
.
CIAD0800  MOVE      "11",CVERT
          MOVE      PTCNRFFF,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNRFFF
          GOTO      CIAD0000
.
CIAD0900  MOVE      "12",CVERT
          MOVE      PTCNATHM,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNATHM
          GOTO      CIAD0000
.
CIAD1000  MOVE      "13",CVERT
          MOVE      PTCNUCEP,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNUCEP
          GOTO      CIAD0000
.
CIAD1100  DISPLAY   *P1:24,*EL,*B,"This option is no longer available.  ";
          CALL      HITENTER
.          MOVE      "14",CVERT
.          MOVE      "Type of Disease coding",BOXHDR
.          CALL      LDICDC00                * Load Valid values
.          PROC      GENCODKY
.          BRANCH    EXIT,CIAD0000
.          MOVE      TEMPCODE,PTCNICDC
          GOTO      CIAD0000
.
CIAD1200  MOVE      "15",CVERT
          MOVE      PTCNABBL,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNABBL
          GOTO      CIAD0000
.
CIAD1300  MOVE      "16",CVERT
          MOVE      PTCNADMB,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNADMB
          GOTO      CIAD0000
.
CIAD1400  MOVE      "17",CVERT
.
          DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF," = DDEST, ":
                               *V2LON,"1",*HOFF," = DSTAT"
.
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,PTCNDTRF
          DISPLAY   *P1:24,*EL;
          MOVE      SP20,DESCDTRF
          IF        PTCNDTRF=0
            MOVE      DDEST,DESCDTRF
            GOTO      CIAD1490
          ENDIF
          IF        PTCNDTRF=1
            MOVE      DSTAT,DESCDTRF
            GOTO      CIAD1490
          ENDIF
          BEEP
.
          GOTO      CIAD1400
.
CIAD1490  DISPLAY   *PCCOL:CVERT,*V2LON,PTCNDTRF,SP2,*HOFF,DESCDTRF
          GOTO      CIAD0000
.
CIAD1500  MOVE      "18",CVERT
          MOVE      PTCNODRG,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNODRG
          GOTO      CIAD0000
.
CIAD1600  MOVE      "19",CVERT
          MOVE      PTCNEDTE,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNEDTE
          GOTO      CIAD0000
.
CIAD1700  GOTO      CIAD0000
.
CIAD1800  MOVE      "21",CVERT
          MOVE      PTCNUILH,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNUILH
          GOTO      CIAD0000
.
CIAD9000  MOVE      TRUE,EXIT
.
CIAD9999  RETURN
+
.***********************************************************************
.*  CIMS0000  :  Change Miscellaneous details screen 1                 *
.***********************************************************************
+
CIMS0000  MOVE      FALSE,EXIT
          MOVE      "44",CCOL
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CIMS9999 IF EQUAL
          GOTO      CIMS9000 IF LESS
.
          BRANCH    CCITEM,CIMS0100,CIMS0200,CIMS0300,CIMS0400,CIMS0500:
                           CIMS0600,CIMS0700,CIMS0800,CIMS0900,CIMS0000:
                           CIMS1100,CIMS1200,CIMS1300,CIMS1400,CIMS1500:
                           CIMS1600,CIMS1700,CIMS1800
          BEEP
          GOTO      CIMS0000
.
CIMS0100  MOVE      "4",CVERT
          MOVE      "Info Printed In PMS68",BOXHDR
          CALL      LDPM6800                * Load Info in IBAPMS68
          PROC      GENCODKY
          BRANCH    EXIT,CIMS0000
          MOVE      TEMPCODE,PTPMS68F
          GOTO      CIMS0000
.
CIMS0200  MOVE      "5",CVERT
          MOVE      CCLMCHN,ANS
          CALL      KYND0000
          MOVE      EXIT,CCLMCHN
          GOTO      CIMS0000
.
CIMS0300  MOVE      "6",CVERT
          MOVE      "MBS Codes in Med. Rec's",BOXHDR
          CALL      LDMBSC00                * Load MBS Codes in Med Recs.
          PROC      GENCODKY
          BRANCH    EXIT,CIMS0000
          MOVE      TEMPCODE,CUSEMBS
          GOTO      CIMS0000
.
CIMS0400  MOVE      "7",CVERT
          MOVE      "Bed Type for WCH",BOXHDR
          CALL      LDBTYP00                * Load Bed Type used for WCH
          PROC      GENCODKY
          BRANCH    EXIT,CIMS0000
          MOVE      TEMPCODE,BEDTYP
          GOTO      CIMS0000
.
CIMS0500  MOVE      "8",CVERT
          MOVE      CHFCOMM,ANS
          CALL      KYND0000
          MOVE      EXIT,CHFCOMM
          GOTO      CIMS0000
.
CIMS0600  MOVE      "9",CVERT
          MOVE      PTCNLDOC,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNLDOC
          GOTO      CIMS0000
.
CIMS0700  MOVE      "10",CVERT
          MOVE      PTCNDEPM,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDEPM
          GOTO      CIMS0000
.
CIMS0800  MOVE      "11",CVERT
          MOVE      PTCNVALD,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNVALD
          GOTO      CIMS0000
.
CIMS0900  MOVE      "12",CVERT
          MOVE      PTCNCHDP,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNCHDP
          GOTO      CIMS0000
.
CIMS1000  MOVE      "13",CVERT
          MOVE      PT3BHOSP,ANS
          CALL      KYND0000
          MOVE      EXIT,PT3BHOSP
          GOTO      CIMS0000
.
CIMS1100  MOVE      "14",CVERT
          MOVE      PTCNSQD3,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSQD3
          GOTO      CIMS0000
.
CIMS1200  MOVE      "15",CVERT
          MOVE      PTCNSQU3,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSQU3
          GOTO      CIMS0000
.
CIMS1300  MOVE      "16",CVERT
          MOVE      PTCNTAST,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNTAST
          GOTO      CIMS0000
.
CIMS1400  MOVE      "17",CVERT
          MOVE      PTCNUAHS,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNUAHS
          GOTO      CIMS0000
.
CIMS1500  MOVE      "18",CVERT
          MOVE      PTCNWRDS,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNWRDS
          GOTO      CIMS0000
.
CIMS1600  MOVE      "19",CVERT
          MOVE      PTCNNPDS,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNNPDS
          GOTO      CIMS0000
.
CIMS1700  MOVE      "20",CVERT
          MOVE      PTCNPALL,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNPALL
          GOTO      CIMS0000
.
CIMS1800  MOVE      "21",CVERT
          MOVE      PTCNH77U,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNH77U
          GOTO      CIMS0000
.
CIMS9000  MOVE      TRUE,EXIT
.
CIMS9999  RETURN
+
.***********************************************************************
.*  CIMC0000  :  Change Miscellaneous details screen 2                 *
.***********************************************************************
+
CIMC0000  MOVE      FALSE,EXIT
          MOVE      "42",CCOL
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CIMC9999 IF EQUAL
          GOTO      CIMC9000 IF LESS
.
          BRANCH    CCITEM,CIMC0100,CIMC0200,CIMC0500,CIMC0700,CIMC1000:
                           CIMC1100,CIMC1200,CIMC1300,CIMC1400,CIMC1500:
                           CIMC1600,CIMC1700,CIMC1800,CIMC2000,CIMC2100:
                           CIMC2300,CIMC2500,CIMC2600
...
...                        CIMC2200,CIMC2300,CIMC2400,CIMC2500,CIMC2600*D-49037
.
          BEEP
          GOTO      CIMC0000
.
CIMC0100  MOVE      "4",CVERT
          MOVE      PTCNCADD,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNCADD
          GOTO      CIMC0000
.
CIMC0200  MOVE      "5",CVERT
          MOVE      PTCNICRA,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNICRA
          GOTO      CIMC0000
.
CIMC0500  MOVE      "6",CVERT
          MOVE      PUSERD0,DRACE
          LOAD      DRACE,PNSWRACE,PUSERD1,PUSERD2,PUSERD3,PUSERD4,PUSERD5:
                                   PUSERD6,AUSERD1,AUSERD2,AUSERD3,AUSERD4:
                                   AUSERD5,AUSERD6,AUSERD7,PMSVX1VA
.
          KEYIN     *P42:CVERT,*EL,*P1:23,*EL,"1=PMI 1, 2=PMI 2, 3=PMI 3,":
                    " 4=PMI 4, 5=PMI 5, 6=PMI 6, 7=ADM 1, 8=ADM 2":
                    *P1:24,"9=ADM 3, 10=ADM 4, 11=ADM 5, 12=ADM 6, 13=ADM 7,":
                    " 14=pmsvx1af Aboriginality":
                    *P52:CVERT,*DV,DRACE,*P42:CVERT,*RV,*V2LON,PNSWRACE:
                    *P1:23,*EF
.
. ------- Is it 0 - 13
          COMPARE   PNSWRACE,TEN4
          GOTO      CIMC0590 IF LESS         * FORM2 > 14
.
          COMPARE   ZERO,PNSWRACE
          GOTO      CIMC0590 IF LESS         * FORM2 < 0
.
. ------- Valid Entry
          MOVE      PUSERD0,DRACE
          LOAD      DRACE,PNSWRACE,PUSERD1,PUSERD2,PUSERD3,PUSERD4,PUSERD5:
                                   PUSERD6,AUSERD1,AUSERD2,AUSERD3,AUSERD4:
                                   AUSERD5,AUSERD6,AUSERD7,PMSVX1VA
          DISPLAY   *P52:CVERT,*EL,DRACE    
          GOTO      CIMC0000                 * Valid & finished input
.
CIMC0590  DISPLAY   *P1:24,*EL,*B,"Option must be 0 to 14. ";
          CALL      HITENTER
          GOTO      CIMC0500
.
. ------  User Defined field for Intention to ReAdmit < 28 Days
CIMC0700  MOVE      "07",CVERT
          MOVE      PUSERD0,DADMT
          LOAD      DADMT,PTCNADMT,DUSERD1,DUSERD2,DUSERD3,DUSERD4:
                                   DUSERD5,AUSERD6,AUSERD7,PMSVX1VR
.
          DISPLAY   *P1:23,*EF,"1=DSC 1, 2=DSC 2, 3=DSC 3, 4=DSC 4, 5=DSC 5, ":
                    "6=ADM 1, 7=ADM 2",*P1:24,"8=pmsvx1af Intention to Readmit";
          KEYIN     *P42:CVERT,*EL,*P52:CVERT,*DV,DADMT:
                    *P42:CVERT,*RV,*V2LON,PTCNADMT:
                    *P1:24,*EL
.
. ------- Is it 0 - 8 
          COMPARE   PTCNADMT,EIGHT
          GOTO      CIMC0790 IF LESS         * FORM2 > 8
.
          COMPARE   ZERO,PTCNADMT
          GOTO      CIMC0790 IF LESS         * FORM2 < 0
.
. ------- Valid Entry
          MOVE      PUSERD0,DADMT
          LOAD      DADMT,PTCNADMT,DUSERD1,DUSERD2,DUSERD3,DUSERD4:
                                   DUSERD5,AUSERD6,AUSERD7,PMSVX1VR
          DISPLAY   *P52:CVERT,*EL,DADMT:
                    *P1:23,*EF;
          GOTO      CIMC0000                 * Valid & finished input
.
CIMC0790  DISPLAY   *P1:24,*EL,*B,"Option must be 0 to 8.  ";
          CALL      HITENTER
          GOTO      CIMC0700
.
CIMC1000  MOVE      "08",CVERT
          MOVE      PTCNHKPL,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNHKPL
          GOTO      CIMC0000
.
.-------- Get ward/bed scan type
CIMC1100  MOVE      "09",CVERT
          ASSIGN    PTCNSMKR+1,FORM1
 
          LOAD      DWBED1,FORM1,WBED1,WBED2
          KEYIN     *P42:CVERT,*EL,*P1:24,*EL:
                    *V2LON,"0",*HOFF," = Smoker in ward/bed scan, ":
                    *V2LON,"1",*HOFF," = Bed type in ward/bed scan ":
                    *P52:CVERT,*DV,DWBED1,*P42:CVERT,*RV,*V2LON,PTCNSMKR:
                    *P1:24,*EL

          IF        PTCNSMKR<0 | PTCNSMKR>1
            BEEP
            DISPLAY   *P1:24,"Option must be 0 or 1 : ";
            CALL      HITENTER
            ASSIGN    FORM1-1,PTCNSMKR
            GOTO      CIMC1100
          ENDIF
.
          ASSIGN    PTCNSMKR+1,FORM1
          LOAD      DWBED1,FORM1,WBED1,WBED2
          DISPLAY   *P42:CVERT,*V2LON,PTCNSMKR,*HOFF,*P52:CVERT,DWBED1
          GOTO      CIMC0000
.
.-------- Use bed in ward/bed history 
CIMC1200  MOVE      "10",CVERT
          ASSIGN    PTCNWBHB+1,FORM1
          LOAD      DDWBHB,FORM1,DWBHB1,DWBHB2
          KEYIN     *P42:CVERT,*EL,*P1:24,*EL:
                    *V2LON,"0",*HOFF," = Use room type (CAT RT), ":
                    *V2LON,"1",*HOFF," = Use bed type (CAT BT) ":
                    *P52:CVERT,*DV,DDWBHB,*P42:CVERT,*RV,*V2LON,PTCNWBHB:
                    *P1:24,*EL

          IF        PTCNWBHB<0 | PTCNWBHB>1
            BEEP
            DISPLAY   *P1:24,"Option must be 0 or 1 : ";
            CALL      HITENTER
            ASSIGN    FORM1-1,PTCNWBHB
            GOTO      CIMC1200
          ENDIF
.
          ASSIGN    PTCNWBHB+1,FORM1
          LOAD      DDWBHB,FORM1,DWBHB1,DWBHB2
          DISPLAY   *P42:CVERT,*V2LON,PTCNWBHB,*HOFF,*P52:CVERT,DDWBHB
          GOTO      CIMC0000
.
.-------- Use description in item code search 
.
CIMC1300  MOVE      "11",CVERT
          ASSIGN    PTCNMSDS+1,FORM1
          LOAD      IDDESC,FORM1,ID1,ID2
          KEYIN     *P42:CVERT,*EL,*P1:24,*EL:
                    *V2LON,"0",*HOFF," = search on item code, ":
                    *V2LON,"1",*HOFF," = search on item description ":
                    *P52:CVERT,*DV,IDDESC,*P42:CVERT,*RV,*V2LON,PTCNMSDS:
                    *P1:24,*EL

          IF        PTCNMSDS<0 | PTCNMSDS>1
            BEEP
            DISPLAY   *P1:24,"Option must be 0 or 1 : ";
            CALL      HITENTER
            ASSIGN    FORM1-1,PTCNMSDS
            GOTO      CIMC1300
          ENDIF
.
          ASSIGN    PTCNMSDS+1,FORM1
          LOAD      IDDESC,FORM1,ID1,ID2
          DISPLAY   *P42:CVERT,*V2LON,PTCNMSDS,*HOFF,*P52:CVERT,IDDESC
          GOTO      CIMC0000
.
CIMC1400  MOVE      "12",CVERT 
          CALL      CHKM0000
.
          MOVE      DIM9,PTCNATCC
          DISPLAY   *P52:CVERT,MDESC;
          GOTO      CIMC0000
.
CIMC1500  MOVE      "13",CVERT 
          CALL      CHKM0000
.
          MOVE      DIM9,PTCNTHCC
          DISPLAY   *P52:CVERT,MDESC;
          GOTO      CIMC0000
.
CIMC1600  MOVE      "14",CVERT 
          CALL      CHKM0000
.
          MOVE      DIM9,PTCNOTCC
          DISPLAY   *P52:CVERT,MDESC;
          GOTO      CIMC0000
.
.----------------------------------------------------
CIMC1700  DISPLAY   *P1:24,*EL,"0 = ",*V2LON,DSC0RP83,*HOFF,", ":
                               "1 = ",*V2LON,DSC1RP83
          MOVE      "15",CVERT
          KEYIN     *PCCOL:CVERT,*EL,PTCNRP83
          COMPARE   ZERO,PTCNRP83
          GOTO      CIMC1720 IF EQUAL
          BRANCH    PTCNRP83,CIMC1720
.
          BEEP             
          GOTO      CIMC1700
.
CIMC1720  MOVE      DSC0RP83,DESCRP83
          LOAD      DESCRP83,PTCNRP83,DSC1RP83
          DISPLAY   *PCCOL:CVERT,*V2LON,DESCRP83
          DISPLAY   *P1:24,*EL
          GOTO      CIMC0000
.
CIMC1800  MOVE      "16",CVERT
          MOVE      PTCNNWSP,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNNWSP
          GOTO      CIMC0000
.
CIMC2000  MOVE      "17",CVERT
          MOVE      PTCNNTCM,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNNTCM
          GOTO      CIMC0000
.
CIMC2100  MOVE      "18",CVERT
          MOVE      PTCNDIRT,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDIRT
          GOTO      CIMC0000
.
. ----- Go-Live date for ICD10 Coding -----                            *D-49037
.
.IMC2200  MOVE      "42",CCOL
.         MOVE      "19",CVERT
.         MOVE      ZERO,CHIGHLT
.
.         UNPACK    PTCNI10D,CCENT,CYEAR,CMON,CDAY
.         MATCH     SP8,PTCNI10D
.         IF        @EQUAL
.           MOVE      CCC,CCENT
.           UNPACK    SP6,CYEAR,CMON,CDAY
.         ENDIF
.         MATCH     "00000000",PTCNI10D
.         IF        @EQUAL
.           MOVE      CCC,CCENT
.           UNPACK    SP6,CYEAR,CMON,CDAY
.         ENDIF
.
.         CALL      KEYDATE
.         BRANCH    CQUEST,CIMC2200
.
.         IF        OVRCD=1
.           MOVE      SP8,PTCNI10D
.         ELSE
.           PACK      PTCNI10D,CCENT,CYEAR,CMON,CDAY
.           REP       " 0",PTCNI10D
.         ENDIF
.         GOTO      CIMC0000
.
. ----- Date to start sending codes to Encoder in ICD10 -----
.
CIMC2300  MOVE      "42",CCOL
          MOVE      "19",CVERT
          MOVE      ZERO,CHIGHLT
.
          UNPACK    PTCNEGLD,CCENT,CYEAR,CMON,CDAY
          MATCH     SP8,PTCNEGLD
          IF        @EQUAL
            MOVE      CCC,CCENT
            UNPACK    SP6,CYEAR,CMON,CDAY
          ENDIF
          MATCH     "00000000",PTCNEGLD
          IF        @EQUAL
            MOVE      CCC,CCENT
            UNPACK    SP6,CYEAR,CMON,CDAY
          ENDIF
.
          CALL      KEYDATE
          BRANCH    CQUEST,CIMC2300
.
          IF        OVRCD=1
            MOVE      SP8,PTCNEGLD
          ELSE
            PACK      PTCNEGLD,CCENT,CYEAR,CMON,CDAY
            REP       " 0",PTCNEGLD
          ENDIF
          GOTO      CIMC0000
.
. ----- Go live date for ICD10 Version 2 -----                         *D-49037
.
.IMC2400  MOVE      "42",CCOL
.         MOVE      "21",CVERT
.         MOVE      ZERO,CHIGHLT
.
.         UNPACK    PTCNGDV2,CCENT,CYEAR,CMON,CDAY
.         MATCH     SP8,PTCNGDV2
.         IF        @EQUAL
.           MOVE      CCC,CCENT
.           UNPACK    SP6,CYEAR,CMON,CDAY
.         ENDIF
.         MATCH     "00000000",PTCNGDV2
.         IF        @EQUAL
.           MOVE      CCC,CCENT
.           UNPACK    SP6,CYEAR,CMON,CDAY
.         ENDIF
.
.         CALL      KEYDATE
.         BRANCH    CQUEST,CIMC2400
.
.         IF        OVRCD=1
.           MOVE      SP8,PTCNGDV2
.         ELSE
.           PACK      PTCNGDV2,CCENT,CYEAR,CMON,CDAY
.           REP       " 0",PTCNGDV2
.         ENDIF
.         GOTO      CIMC0000
.
CIMC2500  MOVE      "20",CVERT
          MOVE      PTCNLPRO,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNLPRO
          GOTO      CIMC0000
.
CIMC2600  MOVE      "21",CVERT
          MOVE      PTCNMBSC,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNMBSC
          GOTO      CIMC0000
.
CIMC9000  MOVE      TRUE,EXIT
.
CIMC9999  RETURN
.***********************************************************************
.*  CINC0000  :  Change Miscellaneous details screen 3                 *
.***********************************************************************
+
CINC0000  MOVE      FALSE,EXIT
          MOVE      "42",CCOL
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CINC9999 IF EQUAL
          GOTO      CINC9000 IF LESS
.
...       BRANCH    CCITEM,CINC0100,CINC0200,CINC0300                  *D-49037
          BRANCH    CCITEM,CINC0300
.
          BEEP
          GOTO      CINC0000
.
. ----- Go live date for ICD10 Version 3 -----                         *D-49037
.
.INC0100  MOVE      "42",CCOL
.         MOVE      " 4",CVERT
.         MOVE      ZERO,CHIGHLT
.
.         UNPACK    PTCNGDV3,CCENT,CYEAR,CMON,CDAY
.         MATCH     SP8,PTCNGDV3
.         IF        @EQUAL
.           MOVE      CCC,CCENT
.           UNPACK    SP6,CYEAR,CMON,CDAY
.         ENDIF
.         MATCH     "00000000",PTCNGDV3
.         IF        @EQUAL
.           MOVE      CCC,CCENT
.           UNPACK    SP6,CYEAR,CMON,CDAY
.         ENDIF
.
.         CALL      KEYDATE
.         BRANCH    CQUEST,CINC0100
.
.         IF        OVRCD=1
.           MOVE      SP8,PTCNGDV3
.         ELSE
.           PACK      PTCNGDV3,CCENT,CYEAR,CMON,CDAY
.           REP       " 0",PTCNGDV3
.         ENDIF
.         GOTO      CINC0000
.
CINC0200  * No longer used
          GOTO      CINC0000
.
CINC0300  READ      CONTROLF,HUND05;*67,PTCNLPRO       * Load prosthetics
          IF        PTCNLPRO=1
            MOVE      ZERO,PTCNNFPU                    * must be set to zero
            GOTO      CINC0000
          ENDIF
          MOVE      "42",CCOL
          MOVE      " 4",CVERT
          MOVE      PTCNNFPU,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNNFPU
          GOTO      CINC0000
.
CINC9000  MOVE      TRUE,EXIT
.
CINC9999  RETURN
+
.*************************************************************************
.*                             CHKM0000                                  *
.*             validate the miscellaneous charge code                    *
.* Returns :    DIM9 - miscellaneous charge code                         *
.*************************************************************************
.
CHKM0000  MOVE      SP30,MDESC
          KEYIN     *P42:CVERT,*EL,*V2LON,DIM9;
          PACK      DIM9,DIM9,SP9
.
          MATCH     DIM9,SP9                     * anything input ?
          GOTO      CHKM9999 IF EQUAL
.
          READ      CONTROLF,TWENTY;*193,PTCNDCLM
          MATCH     SP70,PTCNDCLM
          IF        @EQUAL
            MOVE      "0  ",PTCNDCLM          * use zero claim code
          ENDIF
.
          PACK      KEY29,PTCNDCLM,SP6,SP3,DIM9,CURRDATE,SP10
          CALL      PATMCHRD                * read Misc.Charges file
          IF        EXIT = 0
            PACK      KEY5,CODEFI,MMSCGRP
            CALL      RDCODE1
            IF        OVRCD = 0
              MOVE      ZERO,FORM1
              MOVE      TCINDC1,FORM1
              IF        FORM1 <> 1
                DISPLAY   *P1:24,*EL,*B,"Not a valid doctor charge code.  ";
                CALL      HITENTER
                GOTO      CHKM0000
              ENDIF
            ELSE
              DISPLAY   *P1:24,*EL,*B,*V2LON,MMSCGRP,*HOFF:
                        " not on codes file.  ";
              CALL      HITENTER
              GOTO      CHKM0000
            ENDIF
          ELSE
            DISPLAY   *P1:24,*EL,*B,"Miscellaneous charge code not on file.  ";
            CALL      HITENTER
            GOTO      CHKM0000
          ENDIF
.
CHKM9999  RETURN
+
.***********************************************************************
.*  CISP0000  :  Change Screen Painter details screen                  *
.***********************************************************************
+
CISP0000  MOVE      FALSE,EXIT
          MOVE      "44",CCOL
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CISP9999 IF EQUAL
          GOTO      CISP9000 IF LESS
.
          BRANCH    CCITEM,CISP0100,CISP0200
.
          BEEP
          GOTO      CISP0000
.
CISP0100  MOVE      "4",CVERT
          MOVE      PTCNP2SC,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNP2SC
          GOTO      CISP0000
.
CISP0200  MOVE      "5",CVERT
          MOVE      PTCNA2SC,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA2SC
          GOTO      CISP0000
.
CISP9000  MOVE      TRUE,EXIT
.
CISP9999  RETURN
+
.
.***********************************************************************
.*  CISP0000  :  Change Quotes
.***********************************************************************
CIQU0000
          MOVE      FALSE,EXIT
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CIQU9999 IF EQUAL
          GOTO      CIQU9000 IF LESS
.
          MOVE      "70",CCOL
          BRANCH    CCITEM,CIQU0100,CIQU0200,CIQU0300,CIQU0400,CIQU0500:
                    CIQU0600,CIQU0700,CIQU0050,CIQU0900,CIQU1000,CIQU1100:
                    CIQU1200,CIQU1300,CIQU1400,CIQU1500,CIQU1600,CIQU1700
.
          BEEP
CIQU0050  GOTO      CIQU0000
.
.-------  Print 'DAYPATIENT' on invoice layout 8?
.
CIQU0100  MOVE      "4",CVERT
          MOVE      PTCNDPL8,ANS
          CALL      KYN0000
          MOVE      EXIT,PTCNDPL8
          GOTO      CIQU0000
.
.-------  Allow coding across specialties?
.
CIQU0200  MOVE      "5",CVERT
          MOVE      PTCNCASP,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNCASP
          GOTO      CIQU0000
.
.-------  Use 'Parent of' as P.R.A. for children
.
CIQU0300  MOVE      "6",CVERT
          MOVE      PTCNPAOF,ANS
          CALL      KYN0000
          MOVE      EXIT,PTCNPAOF
          GOTO      CIQU0000
.
. ------  Look up Merged U/R's in IBAPAT32?-----
.
CIQU0400  MOVE      "7",CVERT               * row for keyin
          CALL      KYN0000                  * keyin Y (1) or N (0)
          MOVE      EXIT,PTCNMGUR            * set parameter
          GOTO      CIQU0000
.
.------   U/R option for Cancel last tran. in PAT05 ------
.
CIQU0500  MOVE      "8",CVERT
          MOVE      PTCN7405,ANS
          CALL      KYN0000
          MOVE      EXIT,PTCN7405
          GOTO      CIQU0000
.
.-------  Format to display Doctors screen in for "?" option  ------
.
CIQU0600  MOVE      "9",CVERT
          MOVE      PTCNDCQS,ANS
          CALL      KYN0000
          MOVE      EXIT,PTCNDCQS
          GOTO      CIQU0000
.
.-------  Option to return patient to W/L or not in PAT03 ----------
.
CIQU0700  MOVE      "10",CVERT
          MOVE      PTCNRTWL,ANS
          CALL      KYN0000
          MOVE      EXIT,PTCNRTWL
          GOTO      CIQU0000
.
.-------- Using admission time field for delivery time ? -----------
.
CIQU0900  MOVE      "12",CVERT
          MOVE      PTCNATDT,ANS
          CALL      KYN0000
          MOVE      EXIT,PTCNATDT
          GOTO      CIQU0000
.
.-------- Include Journal Adjustments in IBAPAT92? 
.
CIQU1000  MOVE      "13",CVERT
          MOVE      PTCNJADJ,ANS
          CALL      KYN0000
          MOVE      EXIT,PTCNJADJ
          GOTO      CIQU0000
.
CIQU1100  MOVE      "14",CVERT
          MOVE      PTCNDFCL,ANS
          CALL      KYN0000
          MOVE      EXIT,PTCNDFCL
          GOTO      CIQU0000
.
CIQU1200  MOVE      "15",CVERT
          MOVE      PTCNJDRG,ANS
          CALL      KYN0000
          MOVE      EXIT,PTCNJDRG
          GOTO      CIQU0000
.
.  Keyin default admission type code (cat P) for babies in IBAHOS73
.  A blank code will cause the code to default to the mothers
.
CIQU1300  MOVE      "16",CVERT
.
          MOVE      CVERT,EVERT
          MOVE      CCOL,ECOL
          MOVE      CODEP,CODE
          MOVE      PTCNDATB,CKYIDEF3
          MOVE      "0",CKYIMAND
          MOVE      "1",CNEWDS
.
          DISPLAY   *PCCOL:CVERT,*EL 
          CALL      PATCODKY
.
          BRANCH    EXIT,CIQU1310,CIQU0000
.
CIQU1310  MOVE      ACODE,PTCNDATB
          PACK      PTCNDATB,PTCNDATB,SP3
          GOTO      CIQU0000
.
CIQU1400  MOVE      "17",CVERT
          MOVE      PTCNSTMT,ANS
          CALL      KYN0000
          MOVE      EXIT,PTCNSTMT
          GOTO      CIQU0000
.
CIQU1500  MOVE      "18",CVERT
          MOVE      PTCNUEOC,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNUEOC
          GOTO      CIQU0000
.
CIQU1600  MOVE      "19",CVERT
          MOVE      PTCNUACC,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNUACC
          GOTO      CIQU0000
.
CIQU1700  MOVE      "20",CVERT
          MOVE      PTCNURHA,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNURHA
          GOTO      CIQU0000
.
CIQU9000  MOVE      TRUE,EXIT
.
CIQU9999  RETURN
+
.***********************************************************************
.*  CIP20000  :  Change PMI fields 2
.***********************************************************************
CIP20000  MOVE      FALSE,EXIT
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CIP29999 IF EQUAL
          GOTO      CIP29000 IF LESS
.
          MOVE      "60",CCOL
          BRANCH    CCITEM,CIP20100,CIP20200,CIP20300,CIP20400,CIP20500:
                    CIP20600,CIP20700,CIP20800,CIP20900
.
          BEEP
          GOTO      CIP20000
.
.-------  Allow Discharges while on leave?
.
CIP20100  MOVE      "4",CVERT
          MOVE      PTCNDSHL,ANS
          CALL      KYN0000
          MOVE      EXIT,PTCNDSHL
          GOTO      CIP20000
.
.-------  Allow Alert Security Levels?
.
CIP20200  MOVE      "5",CVERT
          MOVE      PTCNASEC,ANS
          CALL      KYN0000
          MOVE      EXIT,PTCNASEC
          GOTO      CIP20000
.
.-------  Allow Life Threatening alerts?
.
CIP20300  MOVE      "6",CVERT
          MOVE      PTCNLIFE,ANS
          CALL      KYN0000
          MOVE      EXIT,PTCNLIFE
          GOTO      CIP20000
.
.-------  Ask Question to use Surname/Given Name as Alias
.
CIP20400  DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF,"=No, ":
                           *V2LON,"1",*HOFF,"=Yes, ":
                           *V2LON,"2",*HOFF,"=Automatic "
          MOVE      "7",CVERT
          MOVE      CSALIAS,DDESC4
.
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,FORM1:
                    *PCCOL:CVERT,*DV,FORM1;
.
          COMPARE   ZERO,FORM1
          GOTO      CIP20420 IF EQUAL
          BRANCH    FORM1,CIP20420,CIP20420
.
CIP20410  BEEP
          GOTO      CIP20400
.
CIP20420  MOVE      FORM1,CSALIAS
          MOVE      DNO,DDESC4
          LOAD      DDESC4,CSALIAS,DYES,AUTO
          DISPLAY   *PCCOL:CVERT,*V2LON,DDESC4
          GOTO      CIP20000
.
.-------  Option to put patient back on W/List after Discharge?
.
CIP20500  MOVE      "8",CVERT
          MOVE      PTCNWLDC,ANS
          CALL      KYN0000
          MOVE      EXIT,PTCNWLDC
          GOTO      CIP20000
.
.-------- Option on PMI record header
.
CIP20600  MOVE      "9",CVERT
          ASSIGN    PTCNIDHD+1,FORM1
          LOAD      DHDTYPE,FORM1,HDTYPE1,HDTYPE2
          KEYIN     *P60:CVERT,*EL,*P1:24,*EL:
                    *V2LON,"0",*HOFF," = Standard two line header, ":
                    *V2LON,"1",*HOFF," = Header including national I/C Number ":
                    *P64:CVERT,*DV,DHDTYPE,*P60:CVERT,*RV,*V2LON,PTCNIDHD:
                    *P1:24,*EL

          IF        PTCNIDHD<0 | PTCNIDHD>1
            BEEP
            DISPLAY   *P1:24,"Option must be 0 or 1 : ";
            CALL      HITENTER
            ASSIGN    FORM1-1,PTCNIDHD
            GOTO      CIP20600
          ENDIF
.
          ASSIGN    PTCNIDHD+1,FORM1
          LOAD      DHDTYPE,FORM1,HDTYPE1,HDTYPE2
          DISPLAY   *P60:CVERT,*V2LON,PTCNIDHD,*HOFF,*P64:CVERT,DHDTYPE;
          GOTO      CIP20000
.
.-------  Returning Closest Match in Soundex Search?
.
CIP20700  MOVE      "10",CVERT
          MOVE      PTCNCMSX,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNCMSX
          GOTO      CIP20000
.
CIP20800  MOVE      "11",CVERT
          MOVE      PTCNDATE,ANS
          CALL      KYN0000
          MOVE      EXIT,PTCNDATE
          GOTO      CIP20000
.
CIP20900  DISPLAY   *P1:24,*EL,*V2LON,"0",*HOFF:
                               " -Not Using Pat. Satisfaction Survey ":
                               *V2LON,"1",*HOFF,", ":
                               *V2LON,"2",*HOFF," ":
                               " - ADM User defined Y/N field 1-2"
.
CIP20950  MOVE      PTCNSRVY,FORM1
          KEYIN     *P60:12,*EL,*V2LON,FORM1;
.
          IF        FORM1<0 | FORM1>2
            BEEP
            GOTO      CIP20950
          ENDIF
.
          MOVE      FORM1,PTCNSRVY
          MOVE      PUSERD0,SRVYDESC
          LOAD      SRVYDESC,PTCNSRVY,PUSRYND1,PUSRYND2
          DISPLAY   *P64:12,SRVYDESC
.
          MOVE      ZERO,OVRCD
          GOTO      CIP20000
.
CIP29000  MOVE      TRUE,EXIT
.
CIP29999  RETURN
.
.***********************************************************************
.*  CHKI0000  :  Hong Kong National Interface
.***********************************************************************
CHKI0000  MOVE      FALSE,EXIT
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CHKI9999 IF EQUAL
          GOTO      CHKI9000 IF LESS
.
          MOVE      "44",CCOL
          BRANCH    CCITEM,CHKI0100,CHKI0200,CHKI0300,CHKI0400:
                           CHKI0500,CHKI0600
.
          BEEP
          GOTO      CHKI0000
.
.-------  Running the HK National Interface
.
CHKI0100  MOVE      "4",CVERT
          MOVE      PTCNHKIF,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNHKIF
          GOTO      CHKI0000
.
.-------  Download key for the next transfer
.
CHKI0200  MOVE      "5",CVERT
          MOVE      PTCNDKEY,DHKANS2 
          KEYIN     *PCCOL:CVERT,*DV,DHKANS2:
                    *PCCOL:CVERT,*V2LON,*RV,DHKANS2:
                    *PCCOL:CVERT,*DV,DHKANS2;
          MOVE      DHKANS2,PTCNDKEY
          GOTO      CHKI0000
.
.-------  Number of records to download
.
CHKI0300  MOVE      "6",CVERT
          MOVE      PTCNNUMB,DHKANS3 
          KEYIN     *PCCOL:CVERT,*DE,*DV,DHKANS3:
                    *PCCOL:CVERT,*V2LON,*RV,DHKANS3:
                    *PCCOL:CVERT,*DE,*DV,DHKANS3;
          MOVE      DHKANS3,PTCNNUMB
          GOTO      CHKI0000
.
.-------  Directory to copy file to on the IBA machine
.
CHKI0400  MOVE      "7",CVERT
          MOVE      PTCNDIRN,DHKANS4
          KEYIN     *PCCOL:CVERT,*DV,DHKANS4:
                    *PCCOL:CVERT,*V2LON,*RV,DHKANS4:
                    *PCCOL:CVERT,*DV,DHKANS4;
          MOVE      DHKANS4,PTCNDIRN
          GOTO      CHKI0000
.
.-------  Script Name to create file
.
CHKI0500  MOVE      "8",CVERT
          MOVE      PTCNSCPT,DHKANS5
          KEYIN     *PCCOL:CVERT,*DV,DHKANS5:
                    *PCCOL:CVERT,*V2LON,*RV,DHKANS5:
                    *PCCOL:CVERT,*DV,DHKANS5;
          MOVE      DHKANS5,PTCNSCPT
          GOTO      CHKI0000
.
.-------  Automatic Generate Hong Kong National Id
.
CHKI0600  MOVE      "9",CVERT
          MOVE      PTCNHIDG,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNHIDG
          GOTO      CHKI0000
.
CHKI9000  MOVE      TRUE,EXIT
.
CHKI9999  RETURN
+
.
.***********************************************************************
.*  CHSI0000  :  Singapore Interface 
.***********************************************************************
CHSI0000  MOVE      FALSE,EXIT
          CALL      MAINQST
          MOVE      "44",CCOL
.
          COMPARE   ZERO,CCITEM
          GOTO      CHSI9999 IF EQUAL
          GOTO      CHSI9000 IF LESS
.
          BRANCH    CCITEM,CHSI0100,CHSI0200
.
          BEEP
          GOTO      CHSI0000
.
CHSI0100  MOVE      "6",CVERT
          KEYIN     *P5:CVERT,*V2LON,*RV,PTCNMEAB;
          GOTO      CHSI0000
.
CHSI0200  MOVE      "8",CVERT
          KEYIN     *P5:CVERT,*V2LON,*RV,PTCNMEDB;
          GOTO      CHSI0000
.
CHSI9000  MOVE      TRUE,EXIT
.
CHSI9999  RETURN
.
.***********************************************************************
.*  CSAI0000  :  Status Adjustment Fields 
.***********************************************************************
CSAI0000  MOVE      FALSE,EXIT
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CSAI9999 IF EQUAL
          GOTO      CSAI9000 IF LESS
.
          MOVE      "47",CCOL
          BRANCH    CCITEM,CSAI0100,CSAI0150,CSAI0200,CSAI0250:
                           CSAI0300,CSAI0350,CSAI0400,CSAI0450:
                           CSAI0500,CSAI0550,CSAI0600,CSAI0650:
                           CSAI0700,CSAI0750
.
          BEEP
          GOTO      CSAI0000
.
.-------- Resident status
.
CSAI0100  MOVE      "6",CVERT
          MOVE      PTCNSTT,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSTT
          GOTO      CSAI0000
.
.-------- Patient type
.
CSAI0150  MOVE      "7",CVERT
          MOVE      PTCNSTP,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSTP
          GOTO      CSAI0000
.
.-------- Claim code
.
CSAI0200  MOVE      "8",CVERT
          MOVE      PTCNSTCL,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSTCL
          GOTO      CSAI0000
.
.-------- Speciality
.
CSAI0250  MOVE      "9",CVERT
          MOVE      PTCNSTA,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSTA
          GOTO      CSAI0000
.
.-------- Classification
.
CSAI0300  MOVE      "10",CVERT
          MOVE      PTCNSTAC,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSTAC
          GOTO      CSAI0000
.
.-------- Health Fund
.
CSAI0350  MOVE      "11",CVERT
          MOVE      PTCNSTHF,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSTHF
          GOTO      CSAI0000
.
.-------- Attending Doctor
.
CSAI0400  MOVE      "12",CVERT
          MOVE      PTCNSTDR,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSTDR
          GOTO      CSAI0000
.
.-------- Care Class
.
CSAI0450  MOVE      "13",CVERT
          MOVE      PTCNSTCC,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSTCC
          GOTO      CSAI0000
.
.-------- Chargeable Status
.
CSAI0500  MOVE      "14",CVERT
          MOVE      PTCNSTCS,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSTCS
          GOTO      CSAI0000
.
.-------- Diet Code
.
CSAI0550  MOVE      "15",CVERT
          MOVE      PTCNSTDC,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSTDC
          GOTO      CSAI0000
.
.-------- Referral Details
.
CSAI0600  MOVE      "16",CVERT
          MOVE      PTCNIREF,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNIREF
          GOTO      CSAI0000
.
.-------- Regenerate RUS Billing
.
CSAI0650  MOVE      "17",CVERT
          MOVE      PTCNBRUS,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNBRUS
          GOTO      CSAI0000
.
.-------- Days Charged Adjustments 
.
CSAI0700  MOVE      "18",CVERT
          MOVE      PTCNSTDA,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSTDA
          GOTO      CSAI0000
.
.-------- Stepdowns
.
CSAI0750  MOVE      "19",CVERT
          MOVE      PTCNSTST,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNSTST
          GOTO      CSAI0000
.
CSAI9000  MOVE      TRUE,EXIT
.
CSAI9999  RETURN
+
. ------------------------------------------ Start of additional code   I-90203
.***********************************************************************
.*  CDGS0000  :  Status Adjustment Fields  for Solicited Messages
.***********************************************************************
CDGS0000  MOVE      FALSE,EXIT
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CDGT9999 IF EQUAL
          GOTO      CDGT9000 IF LESS
.
          MOVE      "59",CCOL
          BRANCH    CCITEM,CDGS0100:     * PMI Interface Service Name (inbound)
                           CDGS0200:     * PMI Interface Service Name (outbound)
                           CDGS0300:     * ADT Interface Service Name (inbound)
                           CDGS0400:     * ADT Interface Service Name (outbound)
                           CDGS0500:     * AAE Interface Service Name (inbound)
                           CDGS0600      * AAE Interface Service Name (outbound)
.
          BEEP
          GOTO      CDGS0000
.
.         PMI Interface Solicited Service Name (Inbound)
.
CDGS0100  KEYIN     *P59:4,*V2LON,*RV,PTCNDPSI:
                    *P59:4,*DV,PTCNDPSI
          GOTO      CDGS0000
.
.         PMI Interface Solicited Service Name (Outbound)
.
CDGS0200  KEYIN     *P59:5,*V2LON,*RV,PTCNDPSO:
                    *P59:5,*DV,PTCNDPSO
          GOTO      CDGS0000
.
.         ADT Interface Solicited Service Name (Inbound)
.
CDGS0300  KEYIN     *P59:7,*V2LON,*RV,PTCNDASI:
                    *P59:7,*DV,PTCNDASI
          GOTO      CDGS0000
.
.         ADT Interface Solicited Service Name (Outbound)
.
CDGS0400  KEYIN     *P59:8,*V2LON,*RV,PTCNDASO:
                    *P59:8,*DV,PTCNDASO
          GOTO      CDGS0000
.
.         Z04 Interface Solicited Service Name (Inbound)
.
CDGS0500  KEYIN     *P59:10,*V2LON,*RV,PTCNDESI:
                    *P59:10,*DV,PTCNDESI
          GOTO      CDGS0000
.
.         Z04 Interface Solicited Service Name (Outbound)
.
CDGS0600  KEYIN     *P59:11,*V2LON,*RV,PTCNDESO:
                    *P59:11,*DV,PTCNDESO
          GOTO      CDGS0000
.
CDGS9000  MOVE      TRUE,EXIT
.
CDGS9999  RETURN
. ------------------------------------------ End of additional code     I-90203
+
.***********************************************************************
.*  CDGT0000  :  Status Adjustment Fields for Broadcast messages
.***********************************************************************
CDGT0000  MOVE      FALSE,EXIT
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CDGT9999 IF EQUAL
          GOTO      CDGT9000 IF LESS
.
          MOVE      "59",CCOL
          BRANCH    CCITEM,CDGT0100:     * Braodcast Service Name      *C-90203
                           CDGT0200:     * Inform of PMI Update    CUP *C-90203
                           CDGT0250:     * Inform of Update Alias      CUA
                           CDGT0300:     * Inform of Merge             CMR
                           CDGT0350:     * Inform of Un-merge          ...
. -- D-090203              CDGT0910:     * PMI Interface Service Name (inbound)
. -- D-090203              CDGT0912:     * PMI Interface Service Name (outbound)
. -- D-090203              CDGT0400:     * Braodcast Service Name
. -- D-090203              CDGT0914:     * ADT Interface Service Name (inbound)
. -- D-090203              CDGT0916:     * ADT Interface Service Name (outbound)
                           CDGT0400:     * Inform of Patient Admission  CAD
                           CDGT0450:     * Inform of Patient Discharge  CDS
                           CDGT0500:     * Inform of Patient Transfer   CTR
                           CDGT0550:     * Inform of Patient Regist'n   CRG
. -- D-090203              CDGT0918:     * AAE Interface Service Name (inbound)
. -- D-090203              CDGT0920:     * AAE Interface Service Name (outbound)
                           CDGT0600:     * Inform of Alert Update       CAT
                           CDGT0650:     * Inform of Donor Update       CDN
                           CDGT0700:     * Inform of Med. Warning Upd   CMW
                           CDGT0750:     * Inform of Patient On-leave   CPO
                           CDGT0800:     * Inform of Return from Leave  CPR
                           CDGT0850:     * Inform of Cancel Pre-Admiss. CPA
                           CDGT0900:     * Inform of Pre-Admiss. CPE
                           CDGT0910:     * Inform of Change Pre-Admiss. CCP
                           CDGT0920:     * Inform of Add Concession Card. CHA
                           CDGT0930      * Inform of Delete Concession Card CHD
.
          BEEP
          GOTO      CDGT0000
.
.         Broadcast Service Name (Outbound)
.
CDGT0100  KEYIN     *P59:04,*V2LON,*RV,PTCNDGPB:
                    *P59:04,*DV,PTCNDGPB
          GOTO      CDGT0000
.
. Write subsidary system after Update PMI details?
.
CDGT0200  MOVE      "5",CVERT
          MOVE      PTCNDGUP,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGUP
          GOTO      CDGT0000
.
. Write subsidary system after Update Alias details?
.
CDGT0250  MOVE      "6",CVERT
          MOVE      PTCNDGUA,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGUA
          GOTO      CDGT0000
.
. Write subsidary system after Merge U/R?
.
CDGT0300  MOVE      "7",CVERT
          MOVE      PTCNDGMU,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGMU
          GOTO      CDGT0000
.
. Write subsidary system after UnMerge U/R?
.
CDGT0350  MOVE      "8",CVERT
          MOVE      PTCNDGUU,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGUU
          GOTO      CDGT0000
.
. Write subsidary system after Patient Admission ?
.
CDGT0400  MOVE      "9",CVERT
          MOVE      PTCNDGAD,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGAD
          GOTO      CDGT0000
.
. Write subsidary system after Patient Discharge ?
.
CDGT0450  MOVE      "10",CVERT
          MOVE      PTCNDGDS,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGDS
          GOTO      CDGT0000
.
. Write subsidary system after Patient Transfer ?
.
CDGT0500  MOVE      "11",CVERT
          MOVE      PTCNDGTR,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGTR
          GOTO      CDGT0000
.
. Write subsidary system after Patient Registration ?
.
CDGT0550  MOVE      "12",CVERT
          MOVE      PTCNDGRG,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGRG
          GOTO      CDGT0000
.
. Write subsidary system after Alert Update ?
.
CDGT0600  MOVE      "13",CVERT
          MOVE      PTCNDGAL,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGAL
          GOTO      CDGT0000
.
. Write subsidary system after Donor Update ?
.
CDGT0650  MOVE      "14",CVERT
          MOVE      PTCNDGDN,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGDN
          GOTO      CDGT0000
.
. Write subsidary system after Med. Warning Update ?
.
CDGT0700  MOVE      "15",CVERT
          MOVE      PTCNDGMW,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGMW
          GOTO      CDGT0000
.
. ------------------------------------------ Start of additional code   I-90203
.
. Write subsidary system after Put Patient On-leave ?
.
CDGT0750  MOVE      "16",CVERT
          MOVE      PTCNDGPO,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGPO
          GOTO      CDGT0000
.
. Write subsidary system after Return Patient from Leave ?
.
CDGT0800  MOVE      "17",CVERT
          MOVE      PTCNDGPR,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGPR
          GOTO      CDGT0000
.
. Write subsidary system after Cancel Pre- Admission ?    
.
CDGT0850  MOVE      "18",CVERT
          MOVE      PTCNDGPA,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGPA
          GOTO      CDGT0000
.
. Write subsidary system after Pre- Admission ?    
.
CDGT0900  MOVE      "19",CVERT
          MOVE      PTCNDGPE,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGPE
          GOTO      CDGT0000
.
. Write subsidary system after Change Pre- Admission ?    
.
CDGT0910  MOVE      "20",CVERT
          MOVE      PTCNDGCP,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGCP
          GOTO      CDGT0000
.
. Write subsidary system after Add Concession Card ?
.
CDGT0920  MOVE      "21",CVERT
          MOVE      PTCNDGHA,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGHA
          GOTO      CDGT0000
.
. Write subsidary system after Delete Concession Card ?
.
CDGT0930  MOVE      "22",CVERT
          MOVE      PTCNDGHD,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNDGHD
          GOTO      CDGT0000
.
. ------------------------------------------ End of additional code     I-90203
.
. ------------------------------------------ Start of deleted code      D-90203
. -- .
. -- .         PMI Interface Solicited Service Name (Inbound)
. -- .
. -- CDGT0910  KEYIN     *P59:8,*V2LON,*RV,PTCNDPSI:
. --                     *P59:8,*DV,PTCNDPSI
. --           GOTO      CDGT0000
. -- .
. -- .         PMI Interface Solicited Service Name (Outbound)
. -- .
. -- CDGT0912  KEYIN     *P59:9,*V2LON,*RV,PTCNDPSO:
. --                     *P59:9,*DV,PTCNDPSO
. --           GOTO      CDGT0000
. -- .
. -- .         ADT Interface Solicited Service Name (Inbound)
. -- .
. -- CDGT0914  KEYIN     *P59:11,*V2LON,*RV,PTCNDASI:
. --                     *P59:11,*DV,PTCNDASI
. --           GOTO      CDGT0000
. -- .
. -- .         ADT Interface Solicited Service Name (Outbound)
. -- .
. -- CDGT0916  KEYIN     *P59:12,*V2LON,*RV,PTCNDASO:
. --                     *P59:12,*DV,PTCNDASO
. --           GOTO      CDGT0000
. -- .
. -- .         Z04 Interface Solicited Service Name (Inbound)
. -- .
. -- CDGT0918  KEYIN     *P59:17,*V2LON,*RV,PTCNDESI:
. --                     *P59:17,*DV,PTCNDESI
. --           GOTO      CDGT0000
. -- .
. -- .         Z04 Interface Solicited Service Name (Outbound)
. -- .
. -- CDGT0920  KEYIN     *P59:18,*V2LON,*RV,PTCNDESO:
. --                     *P59:18,*DV,PTCNDESO
. --           GOTO      CDGT0000
. ------------------------------------------ End of deleted code        D-90203
.
CDGT9000  MOVE      TRUE,EXIT
.
CDGT9999  RETURN
+
.*****************************************************************************
.*                            CCIS0000                                       *
.*            Change PAS-CIS Broadcast Interface Parameters                  *
.*****************************************************************************
.
CCIS0000  CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CCIS9000 IF EQUAL
          GOTO      CCIS9100 IF LESS
.
          MOVE      "54",CCOL
          BRANCH    CCITEM,CCIS0100:     * No longer in use
                           CCIS0200:     * No longer in use
                           CCIS0300:     * Solicited Socket alias
                           CCIS0400:     * A01 (Admission)
                           CCIS0500:     * A02 (Transfer)
                           CCIS0600:     * A03 (Discharge)
                           CCIS0700:     * A08 (Admission Update)
                           CCIS0800:     * A11 (Cancel Admit)
                           CCIS0900:     * A12 (Cancel Transfer)
                           CCIS1000:     * A13 (Cancel Discharge)
                           CCIS1100:     * A14 (Preadmit)
                           CCIS1200:     * A21 (On-leave)
                           CCIS1300:     * A22 (Return from Leave)
                           CCIS1400:     * A27 (Cancel Preadmit)
                           CCIS1500:     * A28 (PMI Registration)
                           CCIS1600:     * A31 (PMI Update)
                           CCIS1700:     * A34 (U/R Merge)
                           CCIS1800      * A44 (Change U/R for I/P Visit)
.
          BEEP
          GOTO      CCIS0000
.
.         No longer used
.
CCIS0100  GOTO      CCIS0000
.
.         No longer used
.
CCIS0200  GOTO      CCIS0000
.
.         No longer used            
.
CCIS0300  GOTO      CCIS0000
.
.         A01 (Admission)
.
CCIS0400  MOVE      "7",CVERT
          MOVE      PTCNA01M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA01M
          GOTO      CCIS0000
.
.         A02 (Transfer)
.
CCIS0500  MOVE      "8",CVERT
          MOVE      PTCNA02M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA02M
          GOTO      CCIS0000
.
.         A03 (Discharge)
.
CCIS0600  MOVE      "9",CVERT
          MOVE      PTCNA03M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA03M
          GOTO      CCIS0000
.
.         A08 (Update Admission)
.
CCIS0700  MOVE      "10",CVERT
          MOVE      PTCNA08M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA08M
          GOTO      CCIS0000
.
.         A11 (Cancel Admit)
.
CCIS0800  MOVE      "11",CVERT
          MOVE      PTCNA11M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA11M
          GOTO      CCIS0000
.
.         A12 (Cancel Transfer)
.
CCIS0900  MOVE      "12",CVERT
          MOVE      PTCNA12M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA12M
          GOTO      CCIS0000
.
.         A13 (Cancel Discharge)
.
CCIS1000  MOVE      "13",CVERT
          MOVE      PTCNA13M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA13M
          GOTO      CCIS0000
.
.         A14 (Preadmit)
.
CCIS1100  MOVE      "14",CVERT
          MOVE      PTCNA14M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA14M
          GOTO      CCIS0000
.
.         A21 (On-leave)
.
CCIS1200  MOVE      "15",CVERT
          MOVE      PTCNA21M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA21M
          GOTO      CCIS0000
.
.         A22 (Return from Leave)
.
CCIS1300  MOVE      "16",CVERT
          MOVE      PTCNA22M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA22M
          GOTO      CCIS0000
.
.         A27 (Cancel Preadmission)
.
CCIS1400  MOVE      "17",CVERT
          MOVE      PTCNA27M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA27M
          GOTO      CCIS0000
.
.         A28 (PMI Registration)
.
CCIS1500  MOVE      "18",CVERT
          MOVE      PTCNA28M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA28M
          GOTO      CCIS0000
.
.         A31 (PMI Update)
.
CCIS1600  MOVE      "19",CVERT
          MOVE      PTCNA31M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA31M
          GOTO      CCIS0000
.
.         A34 (U/R Merge)
.
CCIS1700  MOVE      "20",CVERT
          MOVE      PTCNA34M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA34M
          GOTO      CCIS0000
.
.         A44 (Change U/R for I/P Visit)
.
CCIS1800  MOVE      "21",CVERT
          MOVE      PTCNA44M,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNA44M
          GOTO      CCIS0000
.
CCIS9000  MOVE      ZERO,EXIT
          GOTO      CCIS9999
.
CCIS9100  MOVE      ONE,EXIT
.
CCIS9999  RETURN
+
.***********************************************************************
.*  CHSB0000  :  IBS Controlled - State based PMI                      * 
.***********************************************************************
CHSB0000  MOVE      FALSE,EXIT
          CALL      MAINQST
.
          COMPARE   ZERO,CCITEM
          GOTO      CHSB9999 IF EQUAL
          GOTO      CHSB9000 IF LESS

          MOVE      SP4,KEYSEC
          BRANCH    CCITEM,CHSB0100:
                           CHSB0200:
                           CHSB0300:        * ACT Health Interface
                           CHSB0400:        * ACT Health Sending Application
                           CHSB0500:        * ACT Health Processing ID
                           CHSB0600         * ACT PMI Country Code for Australia
.
          BEEP
          GOTO      CHSB0000
.
CHSB0100  KEYIN     *P40:4,*V2LON,*RV,PTCNINSN:
                    *P40:4,*DV,PTCNINSN;
          GOTO      CHSB0000
.
CHSB0200  KEYIN     *P40:5,*V2LON,*RV,PTCNOTSN:
                    *P40:5,*DV,PTCNOTSN;
          GOTO      CHSB0000
.
.         ACT Health Interface
.
CHSB0300  MOVE      SIX,CVERT
          MOVE      FORTY,CCOL
          MOVE      PTCNACTI,ANS
          CALL      KYND0000
          MOVE      EXIT,PTCNACTI
          GOTO      CHSB0000
.
.         ACT Health Sending Application
.
CHSB0400  KEYIN     *P40:7,*V2LON,*DV,PTCNACSA,*P40:7,*RV,PTCNACSA
          GOTO      CHSB0000
.
.         ACT Health Processing ID
.
CHSB0500  DISPLAY   *P1:24,*EL,"P=Production, D=Debugging, T=Training"
          KEYIN     *P40:8,*V2LON,*DV,PTCNAPID,*P40:8,*RV,PTCNAPID
.
          MATCH     ANSP,PTCNAPID
          IF        @EQUAL
            DISPLAY   *P40:8,*V2LON,ACTPIDP
            GOTO      CHSB0000
          ENDIF
.
          MATCH     ANSD,PTCNAPID
          IF        @EQUAL
            DISPLAY   *P40:8,*V2LON,ACTPIDD
            GOTO      CHSB0000
          ENDIF
.
          MATCH     ANST,PTCNAPID
          IF        @EQUAL
            DISPLAY   *P40:8,*V2LON,ACTPIDT
            GOTO      CHSB0000
          ENDIF
.
          BEEP
          GOTO      CHSB0500
.
CHSB0600  KEYIN     *P40:9,*V2LON,*RV,PTCNCCOD:
                    *P40:9,*DV,PTCNCCOD;
          GOTO      CHSB0000
.
CHSB9000  MOVE      TRUE,EXIT
.
CHSB9999  RETURN          
+
.******************************************************************************
.*        Alter IBA PRS/2 Screen 1                                            *
.******************************************************************************
UPPSCR1   CALL      MAINQST                  * Select Item, (P)ost, (C)ancel
.
          COMPARE   ZERO,CCITEM
          GOTO      UPPSCR90 IF EQUAL
          GOTO      UPPSCR95 IF LESS
.
          BRANCH    CCITEM,KIPRS01,KIPRS02,KIPRS03,KIPRS04,KIPRS05,KIPRS06
.
          BEEP
          GOTO      UPPSCR1
.
UPPSCR90  MOVE      ZERO,EXIT
          RETURN
.
UPPSCR95  MOVE      ONE,EXIT
          RETURN
.
.*****************************************************************************
.* PRS/2 Error Flag - PTCNEFLG
.*****************************************************************************
KIPRS01   KEYIN     *P50:04,*EL,*V2LON,PTCNEFLG:
                    *P50:04,*V2LON,*DV,PTCNEFLG;
.
          BRANCH    PTCNEFLG,KIPRS01A
.
          COMPARE   ZERO,PTCNEFLG
          GOTO      KIPRS01A IF EQUAL
          BEEP
.
          GOTO      KIPRS01
.
KIPRS01A  MOVE      ERROR0,ERRORTYP
          LOAD      ERRORTYP,PTCNEFLG,ERROR1
.
          DISPLAY   *P55:04,ERRORTYP;
          MOVE      ZERO,EXIT 
.
          GOTO      UPPSCR1
.
.*************************************************************************
.*        Unique Key format for PRS/2 - PTCNUKEY
.*************************************************************************
.
KIPRS02   MOVE      "05",CVERT
          BRANCH    PTCNUKEY,KIPRS02A,KIPRS02A,KIPRS02A
.
          MOVE      SP30,UKEYDISP
          MOVE      SP30,ANS
          GOTO      KIPRS02B
.
KIPRS02A  LOAD      UKEYDISP,PTCNUKEY,UKEY1,UKEY2,UKEY3
.
KIPRS02B  KEYIN     *P1:24,*EL:
                    *V2LON,"1",*HOFF," - Base 36, ":
                    *V2LON,"2",*HOFF," - Episode & Adm. No. Type 1, ":
                    *V2LON,"3",*HOFF," - Episode & Adm. No. Type 2":
                    *P55:CVERT,*EL,*HOFF,*DV,UKEYDISP:
                    *P50:CVERT,*V2LON,*DV,PTCNUKEY:
                    *P50:CVERT,*V2LON,*RV,PTCNUKEY:
                    *P1:24,*EL
.
. ------- Is it >= 1 and <= 3
          COMPARE   "1",PTCNUKEY
          GOTO      KIPRS02C IF LESS
          COMPARE   "4",PTCNUKEY
          GOTO      KIPRS02C IF NOT LESS
.
. ------- Valid Entry
          MOVE      SP30,UKEYDISP
          LOAD      UKEYDISP,PTCNUKEY,UKEY1,UKEY2,UKEY3
          DISPLAY   *P50:CVERT,*EL,*V2LON,PTCNUKEY,*HOFF:
                    *P55:CVERT,UKEYDISP
          GOTO      UPPSCR1  
.
KIPRS02C  DISPLAY   *P1:24,*EL,*B,"Option must be 1, 2 or 3. ";
          CALL      HITENTER
          GOTO      KIPRS02
.
.****************************************************************************
.*        Current region for PRS/2 (0-9) - PTCNCRRG
.****************************************************************************
KIPRS03   MOVE      "06",CVERT
          MOVE      SP30,CRRGDISP
          TYPE      PTCNCRRG
          GOTO      KIPRS03A IF EQUAL
.
          MOVE      SP1,PTCNCRRG
          MOVE      SP30,CRRGDISP
          GOTO      KIPRS03B
.
KIPRS03A  MOVE      PTCNCRRG,FORM2
          ADD       "1",FORM2
          MOVE      SP30,CRRGDISP
          LOAD      CRRGDISP,FORM2,CRRG01,CRRG02,CRRG03,CRRG04,CRRG05:
                                   CRRG06,CRRG07,CRRG08,CRRG09,CRRG10
.
KIPRS03B  MOVE      PTCNCRRG,ANS
          KEYIN     *P55:CVERT,*DV,*HOFF,CRRGDISP:
                    *P50:CVERT,*V2LON,*DV,ANS:
                    *P50:CVERT,*V2LON,*RV,ANS
.
. ------- Is it Alpha  
          TYPE      ANS
          GOTO      KIPRS03C IF NOT EQUAL
.
. ------- Is it 0 - 9 
          MOVE      ANS,FORM2
          ADD       ONE,FORM2
          COMPARE   FORM2,TEN
          GOTO      KIPRS03C IF LESS         * FORM2 > 10
.
          COMPARE   ONE,FORM2
          GOTO      KIPRS03C IF LESS         * FORM2 < 1
.
. ------- Valid Entry
          LOAD      CRRGDISP,FORM2,CRRG01,CRRG02,CRRG03,CRRG04,CRRG05:
                                   CRRG06,CRRG07,CRRG08,CRRG09,CRRG10
          DISPLAY   *P55:CVERT,*EL,CRRGDISP
          MOVE      ANS,PTCNCRRG             * Move to field when valid
          GOTO      UPPSCR1                  * Valid & finished input
.
KIPRS03C  DISPLAY   *P1:24,*EL,*B,"Option must be 0 to 9.  ";
          CALL      HITENTER
          GOTO      KIPRS03 
.
.****************************************************************************
.*        User Defined field for Criterion for Admission - PTCNCRTN
.****************************************************************************
KIPRS04   MOVE      "07",CVERT
          MOVE      PUSERD0,DCRTN
          LOAD      DCRTN,PTCNCRTN,AUSERD1,AUSERD2,AUSERD3,AUSERD4:
                                   AUSERD5,AUSERD6,AUSERD7,PMSVX1VB
.
          DISPLAY   *P1:23,*EF,"1=ADM 1, 2=ADM 2, 3=ADM 3, 4=ADM 4, 5=ADM 5, ":
                    "6=ADM 6, 7=ADM 7",*P1:24,"8=pmsvx1af, Admission criteria";
          KEYIN     *P55:CVERT,*DV,DCRTN:
                    *P50:CVERT,*V2LON,*DV,PTCNCRTN:
                    *P50:CVERT,*V2LON,*RV,PTCNCRTN;
.
. ------- Is it 0 - 8
          COMPARE   PTCNCRTN,EIGHT
          GOTO      KIPRS04A IF LESS         * FORM2 > 8
.
          COMPARE   ZERO,PTCNCRTN
          GOTO      KIPRS04A IF LESS         * FORM2 < 0
.
. ------- Valid Entry
          MOVE      PUSERD0,DCRTN
          LOAD      DCRTN,PTCNCRTN,AUSERD1,AUSERD2,AUSERD3,AUSERD4:
                                   AUSERD5,AUSERD6,AUSERD7,PMSVX1VB
          DISPLAY   *P55:CVERT,*EL,DCRTN,*P1:23,*EF;
          GOTO      UPPSCR1                  * Valid & finished input
.
KIPRS04A  DISPLAY   *P1:24,*EL,*B,"Option must be 0 to 8.  ";
          CALL      HITENTER
          MOVE      "1",PTCNCRTN
          GOTO      KIPRS04 
.
.*****************************************************************************
.*        Hosiptal Type - PTCNHOSP
.*****************************************************************************
KIPRS05   MOVE      "08",CVERT
.
. ------- Get Hospital Format
.
          MOVE      DHOSTYP0,DDESC1                   * Hospital Type
          LOAD      DDESC1,PTCNHOSP,DHOSTYP1
.
          KEYIN     *P50:CVERT,*EL,*P1:24,*EL:
                    *V2LON,"0",*HOFF," = Private, ":
                    *V2LON,"1",*HOFF," = Public ":
                    *P55:CVERT,*DV,DDESC1:
                    *P50:CVERT,*V2LON,*DV,PTCNHOSP:
                    *P50:CVERT,*V2LON,*RV,PTCNHOSP:
                    *P1:24,*EL
.
. ------- Is it 0 - 1 
          COMPARE   PTCNHOSP,ONE    
          GOTO      KIPRS05A IF LESS         * FORM2 > 1
.
          COMPARE   ZERO,PTCNHOSP
          GOTO      KIPRS05A IF LESS         * FORM2 < 0
.
. ------- Get Hospital Format
          MOVE      DHOSTYP0,DDESC1                   * Hospital Type
          LOAD      DDESC1,PTCNHOSP,DHOSTYP1
.
          DISPLAY   *P50:CVERT,*V2LON,PTCNHOSP,*HOFF,*P55:CVERT,DDESC1
          GOTO      UPPSCR1 
.
KIPRS05A  DISPLAY   *P1:24,*EL,*B,"Option must be 0 or 1.  ";
          CALL      HITENTER
          GOTO      KIPRS05 
.
.****************************************************************************
.*       PRS2 Live Date - PTCNPRSL
.****************************************************************************
KIPRS06   MOVE      SP8,PTCNPRSL
          MOVE      "09",VERT
          MOVE      "50",COL
.
          UNPACK    SP6,CDAY,CMON,CYEAR
          MOVE      CCC,CCENT
          MOVE      COL,CCOL
          MOVE      VERT,CVERT
          MOVE      "1",CDEFDTE
          MOVE      "0",CHIGHLT
          DISPLAY   *PCOL:VERT,*EL,*P71:VERT,"DD/MM/CCYY"
.
          CALL      KEYDATE 
          IF        OVRCD=1
            BEEP
            GOTO      KIPRS06
          ENDIF
.
          PACK      PTCNPRSL,CCENT,CYEAR,CMON,CDAY
          REP       " 0",PTCNPRSL
          RESET     PTCNPRSL
          MOVE      ZERO,EXIT 
          GOTO      UPPSCR1
+
.***********************************************************************
.*  WRHS0000  :  Write   Hospital Based details screen                 *
.***********************************************************************
WRHS0000  WRITAB    CONTROLF,ZERO;*43,IBCNMHOS        * Multi Hosp Indicator
          WRITAB    CONTROLF,TEN;*244,CHOSPNUM        * Unique Hospital Id
          WRITAB    CONTROLF,TEN3;*245,CHOSTYP        * Hospital Type
          WRITAB    CONTROLF,FIFTY9;*37,CTYPCHG:      * Charging Type
                                    *64,CUSENOTE:     * Multi Hosp Case Notes
                                    *87,CHUTTCN:      * Unique Hutt Identifier
                                    *91,CTYPREP:      * Reporting Layout
                                    *235,PTCNPREG     * Using Patient Reg Scrn
          WRITAB    CONTROLF,HUND03;*43,PTCNDFIN      * Day Facility Indicator
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.***********************************************************************
.*  WRSI0000  :  Write   Systems/Interfaces details screen             *
.***********************************************************************
WRSI0000  WRITAB    CONTROLF,TEN;*18,PTCNP31G:        * Gen Pre-Adm in PAT31
                                 *19,PTCNP31M:        * MH Pre-Adm in PAT31
                                 *20,PTCNH31G:        * Gen Pre-Adm in HOS31
                                 *21,PTCNH31M:        * MH Pre-Adm in HOS31
                                 *22,PTCNMHBK:        * MH Booking Option
                                 *160,CMEDSERV:       * Using Medical Services
                                 *166,CMEMB:          * Using Membership
                                 *194,CDIETCD         * Using Meal Menu
          WRITAB    CONTROLF,TEN3;*243,CACCLSS        * Using Category A
          WRITAB    CONTROLF,TEN5;*187,CBOOKG:        * Using Bookings
                                  *188,CMATRN:        * Using Maternity
                                  *189,CTHETR         * Using Theatre
          WRITAB    CONTROLF,TEN8;*162,CGLIND:        * General Ledger Interface
                                  *163,CGLPATH        * General Ledger Path Name
          WRITAB    CONTROLF,TWENTY;*190,PTCNIR31     * Bill/RUS in HOS31
          WRITAB    CONTROLF,FIFTY9;*60,PTCNUFMS:     * using FMS
                                    *86,CDETENTE:     * Detente Interface
                                    *92,CDETPATH      * Detente Audit File Path
          WRITAB    CONTROLF,SEVENTY7;*213,PTCNCRPT   * RCP (Inpatients)
          WRITAB    CONTROLF,NINTY8;*86,PTCNCPTH      * controlf path
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.***********************************************************************
.*  WR2I0000  :  Write   Systems/Interfaces details screen             *
.***********************************************************************
WR2I0000  WRITAB    CONTROLF,TWENTY1;*138,PTCNNHII:   * Using NZHIS Interface
                                 *139,PTCNNHID:       * directory for NZHIS Int
                                 *191,PTCNNHIF:       * File for master FIFO
                                 *204,PTCNAWRN:       * Alerts system used
                                 *240,PTCNEDIF        * EDI file number
          WRITAB    CONTROLF,SEVENTY7;*45,PTCNNZED    * EDI Directory        
          WRITAB    CONTROLF,SEVENTY9;*33,PTCNSEND    * EDI Sender
          WRITAB    CONTROLF,EIGHTY;*138,PTCNNZUR:  
                                      *223,PTCNNXTT 
          WRITAB    CONTROLF,HUND10;*115,PTCNUEDI
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.***********************************************************************
.*  WRME0000  :  Write   Menu details screen                           *
.***********************************************************************
WRME0000  DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.***********************************************************************
.*  WRHD0000  :  Write   HDP/HCS Details Screen                        *
.***********************************************************************
WRHD0000  WRITAB    CONTROLF,EIGHTY8;*86,CDAILYDT    * Last Govt. Susbidy Run
          WRITAB    CONTROLF,TEN3;*187,CUSEHCS:       * Using HCS system for HDP
                                  *203,CHCSUNIQ:      * HDP Transaction Number
                                  *244,CHCS           * Collecting HDP Data
          WRITAB    CONTROLF,EIGHTY8;*116,CHCSDTE        * Start Date for HDP
          WRITAB    CONTROLF,TWENTY;*51,PTCNPRSB:     * Patient Billing Menu
                                    *79,PTCNHSSN      * Patient Syst Manag Menu
          WRITAB    CONTROLF,FIFTY9;*221,PTCNBFHD:    * Using Bed Fee Equiv.
                                    *222,PTCNFNHD:    * Using H/Fund Equiv.
                                    *232,PTHCSDOC     * HCS Doctor Mandatory
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.*  WRIN0000  :  Write   Incremental Numbers Screen                 *
.********************************************************************
WRIN0000  WRITAB    CONTROLF,TEN;*1,NADMNO:           * Next Admission Number
                                 *89,CGOVCLIM         * Gov Sub Claim Number
          WRITAB    CONTROLF,EIGHTY8;*78,CGADMNO
          WRITAB    CONTROLF,EIGHTY8;*210,CRECPNO     * Next Receipt Number
          WRITAB    CONTROLF,TEN8;*9,CMEXTINV:        * Next Med Serv Invoice
                                  *192,CLHFASS:       * Last Claims Ass Number
                                  *217,CLHBNO         * Last HB21 Invoice Number
          WRITAB    CONTROLF,TWENTY1;*133,PTCNPCSQ    * Next HMS86 File Number
          WRITAB    CONTROLF,FIFTY9;*182,PTCNORNO     * Last Order Number
          WRITAB    CONTROLF,SEVENTY7;*170,PTCNHIDF:  * From Range HK ID 
                                      *178,PTCNHIDT:  * To Range HK ID 
                                      *186,PTCNHIDN   * Next Generated HK ID
          WRITAB    CONTROLF,NINTY5;*153,PTCNQUOT     * Quote number
          WRITAB    CONTROLF,NINTY8;*157,PTCNBTHN     * EDI batch no
          WRITAB    CONTROLF,HUND05;*75,PTCNAMUI      * ACT Merge Id
          WRITAB    CONTROLF,HUND09;*161,PTCNBNUM:    * Batch number
                                    *196,PTCNCRNO     * Credit Note number
.
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.*  WRUF0000  :  Write   Using Files Screen                         *
.********************************************************************
WRUF0000  WRITAB    CONTROLF,TEN9;*212,CFEETYP        * Daily Charging File
          WRITAB    CONTROLF,TWENTY;*49,PTCNRESB:     * Re-Submit Quest in PAT06
                                    *76,PTCNMSDF:     * PATMSDFD
                                    *186,PTCNUCSL     * Case Note Location File
          WRITAB    CONTROLF,TWENTY1;*121,PTCNUADM    * U/R change for an Adm.
          WRITAB    CONTROLF,FIFTY9;*171,PTCNSTAU:    * New Adm & Dsc Stats 1 
                                    *172,PTCNNUMM:    * Monthly Update PATNUMFD
                                    *173,PTCNNEWS:    * New Stats Update
                                    *209,PTCNDAYF:    * Patient Day File
                                    *220,PTCNUADT:    * Adm, Dsc, Trn Dest File
                                    *225,PTCNUURC     * U/R No. Change File
          WRITAB    CONTROLF,SEVENTY7;*240,PTCNAXEU   * U/R change for an Adm.
          WRITAB    CONTROLF,SEVENTY9;*248,PTCNIPEN   * Invoice Pending File
          WRITAB    CONTROLF,EIGHTY;*241,PTCNUCGP     * Reg GP changes file  
          WRITAB    CONTROLF,HUND05;*177,PTCNTFEE:    * Using theatre fees
                                    *190,PTSGCOPT     * Using suggested class.
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.*  WRUR0000  :  Write   U/R Based Details Screen                   *
.********************************************************************
WRUR0000  WRITAB    CONTROLF,TEN;*196,CGENRUR         * U/R No. Generation
          WRITAB    CONTROLF,TWENTY;*225,PTCNNMDX:    * Desc for National No.
                                    *237,PTCNNULU     * Show Link for Nat. No.
          WRITAB    CONTROLF,TWENTY1;*4,PTCNAUNB:     * Enter U/R in BIL02
                                     *67,PTCNH59V:    * U/R Validation in HOS59
                                    *119,PTCNRPIK:    * Register patient in Kurn
                                    *248,PTCNSOUC     * Security on U/R comments
          WRITAB    CONTROLF,FIFTY9;*78,CMERGURS:     * Merging U/R's in PAT02
                                    *234,PTCNNMPI     * Link btw. U/R and Nat.
          WRITAB    CONTROLF,SEVENTY7;*10,PTCNULUE:   * Last U/R Entered   
                                      *20,PTCNUVSM:   * Using Visit Summary
                                      *21,PTCNVSDF:   * Vis Sum Display format
                                      *22,PTCNSVOD    * Select Vis Other Datab
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.*  WRPM0000  :  Write   PMI Field Details Screen                   *
.********************************************************************
WRPM0000  WRITAB    CONTROLF,TEN;*24,PTCNICAD:        * Input Current Address
                                 *53,CPCONT           * Person to Contact
          WRITAB    CONTROLF,TEN9;*210,CPCFORM        * Pat. Cond. Description
          WRITAB    CONTROLF,TWENTY1;*14,PTCNCNFA:    * Command for Add Keyin
                                     *53,PTCNRSGS:    * Reverse Surn/Giv
                                     *54,PTCNPCKL:    * Picking List
                                     *55,PTCNDOBS:    * DOB Search
                                     *56,PTCNDEFT:    * Search Param Deft.
                                     *101,PTCNUDRG:   * Using death regist.
                                     *102,PTCNWDTH:   * canc. code for W/L
                                     *105,PTCNIDTH:   * canc. code for IP
                                     *108,PTCNODTH:   * canc. code for OP 
                                     *111,PTCNBDTH:   * canc. code for Bkg
                                     *114,PTCNTDTH    * canc. code for OPR
          WRITAB    CONTROLF,FIFTY9;*59,CPOSTCD:      * NZ or Aust Post Code
                                    *231,PTCNRGNS     * Reverse Givename Search
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.*  WR1F0000  :  Write   Financial Parameters Screen 1              *
.********************************************************************
WR1F0000  WRITAB    CONTROLF,EIGHTY8;*94,CLACDATE
          WRITAB    CONTROLF,EIGHTY8;*102,CFEEDT
          WRITAB    CONTROLF,TEN;*192,CACCFEE         * Accum. of Bed Fees
          WRITAB    CONTROLF,TEN3;*185,CATBLAY
          WRITAB    CONTROLF,EIGHTY8;*110,UPMONTH   
          WRITAB    CONTROLF,TEN8;*255,CJRNREP        * Date of Journal
          WRITAB    CONTROLF,TEN9;*215,CMCNOHF        * Using HF in Misc. Chargs
          WRITAB    CONTROLF,EIGHTY8;*162,PTCFEEOF
          WRITAB    CONTROLF,TWENTY;*239,PTCNMXCH     * Maximum Charge (For HK)
          WRITAB    CONTROLF,FIFTY9;*24,CFUTENQ:      * Future Action on Enq.
                                    *27,CPERMTH:      * Using word Period/Month
                                    *33,CPRTREC:      * Print Rec in BIL21
                                    *127,COTHSFN:     * Oth Fin Opt in PATSELFN
                                    *128,CREBPORT:    * Rebate Port Required Flg
                                    *174,PTCNNDAT:    * Next Daily Update Date
                                    *226,CCARECL     * Dateable Care Class
          WRITAB    CONTROLF,EIGHTY8;*194,PTCFEEAE: 
                                    *202,PTCFEEOP  
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.*  WR2F0000  :  Write   Financial Parameters Screen 2              *
.********************************************************************
WR2F0000  WRITAB    CONTROLF,TEN;*32,PTCNUBRD:        * Input Board in Adm's
                                 *33,PTCNGSTF         * Separate GST in BIL19
          WRITAB    CONTROLF,TWENTY;*50,PTCNADBF:     * Auto Def. in PATBFEE
                                    *164,PTRESDAY:    * Reset Day Count S/Down
                                    *203,PTCNBDOM     * Def Board using P'Code
          WRITAB    CONTROLF,TWENTY1;*60,PTCNCCRR:    * Claim code for ref. rate
                                     *63,PTCNCLOR:    * Calculate loss of rev.
                                     *120,PTCNADDC:   * Additional Charging
                                     *136,PTCNMITM
          WRITAB    CONTROLF,SEVENTY7;*214,PTCNBTNM  * Transfer billing time
          WRITAB    CONTROLF,SEVENTY9;*68,PTCNMFEE,PTCNJFEE
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.*  WRLI0000  :  Write   Labels/Id Sheets Screen                    *
.********************************************************************
WRLI0000  WRITAB    CONTROLF,TEN;*165,CIDENT          * Using Id Sheets
          WRITAB    CONTROLF,TEN4;*227,CIDLAY         * Id Sheet Layout
          WRITAB    CONTROLF,FIFTY9;*130,CADDLAB:     * Number of Add Labels
                                    *236,PTCNFFLL     * Free Form Line in UR Lab
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.*  WRIV0000  :  Write   Invoice Screen                             *
.********************************************************************
WRIV0000  WRITAB    CONTROLF,TEN;*66,CINVLAY          * Invoice Layout
          WRITAB    CONTROLF,TWENTY1;*51,PTCNINVL     * Invoice Layout 2nd Param
          WRITAB    CONTROLF,TEN4;*228,CINVFF         * Invoice Formfeed Var.
          WRITAB    CONTROLF,TWENTY;*208,PTCNSTMS     * Print Pat/HF portion
          WRITAB    CONTROLF,FIFTY9;*23,CFUTINV:      * Future Action when Prnt.
                                    *62,CINVJRN       * Log Inv Num with Jrnl
          WRITAB    CONTROLF,SEVENTY7;*212,PTCNSUFA   * Supress Statements
          WRITAB    CONTROLF,EIGHTY8;*233,PTCNADES    * Supress Statements
          WRITAB    CONTROLF,HUND05;*205,PTCNPFID:    * print details on tobeinv
                                    *211,PTCNBPAY     * I-48227
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.*  WRCO0000  :  Write   Comments Screen                            *
.********************************************************************
WRCO0000  WRITAB    CONTROLF,TWENTY;*238,PTCNURCO     * Using U/R Level Comments
          WRITAB    CONTROLF,FIFTY9;*25,CFUTCOM:      * Write Future Action Com
                                    *129,CCHGCMN      * Comm. in Chng. in HOS31
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.*  WRLS0000  :  Write   Length of Stay Screen                      *
.********************************************************************
WRLS0000  WRITAB    CONTROLF,FIFTY9;*147,PTCNLOS1:    * 1st Length of Stay
                                    *150,PTCNLOS2:    * 2nd Length of Stay
                                    *153,PTCNLOS3:    * 3rd Length of Stay
                                    *156,PTCNELDR:    * Elderly Patient Age
                                    *159,PTCNLSR1:    * 1st Long Stay Range
                                    *162,PTCNLSR2:    * 2nd Long Stay Range
                                    *165,PTCNLSR3:    * 3rd Long Stay Range
                                    *168,PTCNLSR4:    * 4th Long Stay Range
                                    *217,PTOCBDAY     * Occ. Bed Days for LOS
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.*  WRAD0000  :  Write   Admission Based Details Screen             *
.********************************************************************
WRAD0000  WRITAB    CONTROLF,TEN;*13,PTCNTLVE:        * Using Type Of Leave
                                 *34,PTCNRFFF:        * Free Format Doctor Ref
                                 *35,PTCNATHM:        * Authority Mand. in Ref
                                 *197,CASSOCD         * Using Assoc. Doctor
          WRITAB    CONTROLF,TWENTY;*52,PTPCLRES      * P.R.A for Claim
          WRITAB    CONTROLF,TWENTY1;*45,PTCNDRSM:    * Var for Sep. Mode
                                     *49,PTCNVDDI:    * View Disc. Diag in MRT06
                                     *65,PTCNICDC:    * Type of ICD coding
                                     *66,PTCNABBL:    * Admit by book list hos31
                                    *118,PTCNUCEP:    * Using Conultant Episodes
                                    *122,PTCNADMB:    * Default to admit baby
                                    *216,PTCNDTRF
          WRITAB    CONTROLF,FIFTY9;*81,CHOMBAS       * Code for Home Base
          WRITAB    CONTROLF,SEVENTY9;*105,PTCNUILH   * Using letter history
          WRITAB    CONTROLF,EIGHTY;*243,PTCNODRG:    * Using online DRG
                                    *249,PTCNEDTE     * E code dates
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.*  WRMS0000  :  Write   Miscellaneous Screen 1                     *
.********************************************************************
WRMS0000  WRITAB    CONTROLF,TEN3;*154,CUSEMBS:       * MBS Codes in Med Rec
                                  *163,BEDTYP:        * Bed Type for W.C.H.
                                  *242,CCLMCHN        * Claims Maint in Admiss
          WRITAB    CONTROLF,TWENTY;*73,PTCNDEPM:     * Category A Mandatory
                                    *74,PTCNVALD:     * Vald. Dept to Doctor Typ
                                    *75,PTCNCHDP:     * Change Dept in Bed Trans
                                    *77,PT3BHOSP:     * Inc Days of Hos in 3B C
                                    *214,PTCNSQD3:    * Supress '?' on Cat D3
                                    *215,PTCNSQU3     * Supress '?' on Cat U3
          WRITAB    CONTROLF,TWENTY1;*50,PTCNTAST:    * Single Terminal in BIL31
                                     *57,PTCNUAHS:    * WL Ad-Hoc Sc WAT30/OPR40
                                     *59,PTCNWRDS:    * Ward Specialities PAT13
                                     *64,PTCNNPDS:    * New Disp. in WL/Bookings
                                     *68,PTCNPALL:    * Print all in MRT21
                                    *117,PTCNH77U     * UK Layout for HOS77
          WRITAB    CONTROLF,FIFTY9;*61,CHFCOMM:      * Health Fund Comments Opt
                                    *207,PTPMS68F:    * Info in PMS68
                                    *237,PTCNLDOC     * Using Local Doctor
.
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.*  WRMC0000  :  Write   Miscellaneous Screen 2                     *
.********************************************************************
WRMC0000  WRITAB    CONTROLF,TWENTY1;*132,PTCNCADD:   * change att doc./dept
                                     *200,PTCNICRA:   * Cash Receipts Audit 
                                     *209,PTCNADMT    * User Def Fld 4 Adm Type
          WRITAB    CONTROLF,SEVENTY7;*11,PTCNDIRT:   * Using Directorates.
                                      *194,PTCNHKPL:  * HK Pulling List (PMS56)
                                      *211,PTCNSMKR:
                                      *239,PTCNWBHB:
                                      *241,PTCNMSDS   * Search on Item/Desc
          WRITAB    CONTROLF,EIGHTY;*129,PTCNATCC:    * Attendance Charge Code
                                      *144,PTCNRP83:  * Report for IBAPAT83
                                      *145,PTCNTHCC:  * Theatre Charge Code
                                      *154,PTCNOTCC:  * Other Charge Code
                                      *239,PTCNNWSP:  * New Ward/Spec in PAT13
                                      *247,PTCNNTCM   * SVL mods for PMS27 & 29?
...
...       WRITAB    CONTROLF,EIGHTY8;*59,PTCNI10D:    * ICD10 go live date
...
          WRITAB    CONTROLF,EIGHTY8;*224,PTCNEGLD:  * Encoder go-live (ICD10)
                                      *242,PNSWRACE   * User Def Fld 4 Race  
...       WRITAB    CONTROLF,NINTY8;*149,PTCNGDV2     * ICD10 v2 go live date
          WRITAB    CONTROLF,HUND05;*67,PTCNLPRO:      * Load Prosthetics
                                    *68,PTCNMBSC       * Load MBS items 
          IF        PTCNLPRO=1
            MOVE      ZERO,PTCNNFPU                   * new files for prosth.
            WRITAB    CONTROLF,HUND09;*182,PTCNNFPU
          ENDIF
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
.********************************************************************
.*  WRNC0000  :  Write   Miscellaneous Screen 3                     *
.********************************************************************
...C0000  WRITAB    CONTROLF,HUND09;*151,PTCNGDV3:    * ICD10 v3 go live date
WRNC0000  WRITAB    CONTROLF,HUND09;*182,PTCNNFPU     * new files for prosth.
.
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.*  WRSP0000  :  Write   Screen Painter Screen                      *
.********************************************************************
WRSP0000  WRITAB    CONTROLF,TEN;*14,PTCNP2SC:       * 2nd PMI Screen
                                 *23,PTCNA2SC        * 2nd Admission Screen
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.* WRQU0000  :  Write Quotes Screen
.********************************************************************
WRQU0000  WRITAB    CONTROLF,TWENTY1;*137,PTCN7405,*211,PTCNMGUR:
                                     *235,PTCNDPL8,*236,PTCNCASP:
                                     *237,PTCNPAOF,*247,PTCNDCQS:
                                     *249,PTCNRTWL:
                                     *251,PTCNATDT
          WRITAB    CONTROLF,TEN;*38,PTCNJDRG
          WRITAB    CONTROLF,SEVENTY9;*89,PTCNDATB:
                                      *120,PTCNUEOC:
                                      *121,PTCNUACC:
                                      *138,PTCNURHA:
                                      *244,PTCNSTMT
          WRITAB    CONTROLF,EIGHTY;*244,PTCNJADJ,*245,PTCNDFCL
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
WRQU9999  RETURN
+
.********************************************************************
.* WRP20000  :  Write PMI fields 2
.********************************************************************
WRP20000  WRITAB    CONTROLF,SEVENTY7;*95,PTCNDSHL,PTCNASEC,PTCNLIFE:
                      *200,PTCNWLDC,*201,PTCNIDHD,*243,PTCNCMSX
          WRITAB    CONTROLF,TEN9;*225,CSALIAS
          WRITAB    CONTROLF,EIGHTY;*229,PTCNDATE
          WRITAb    CONTROLF,HUND05;*70,PTCNSRVY
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
WRP29999  RETURN
+
.********************************************************************
.* WHKI0000  :  Write Hong Kong National Interface
.********************************************************************
WHKI0000  WRITAB    CONTROLF,SEVENTY7;*99,PTCNHKIF,PTCNDKEY,PTCNNUMB:
                                          PTCNDIRN,PTCNSCPT
          WRITAB    CONTROLF,SEVENTY7;*169,PTCNHIDG
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
. ------------------------------------------ Start of additional code   I-90203
.********************************************************************
.* WDGS0000  :  Write Interface Engine for Solicited Messages
.********************************************************************
WDGS0000  WRITAB    CONTROLF,SEVENTY9;*139,PTCNDPSI,*159,PTCNDPSO:
                                      *199,PTCNDASI,*219,PTCNDASO
.
          WRITAB    CONTROLF,EIGHTY8;*3,PTCNDESI,*23,PTCNDESO
.
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.* WDGT0000  :  Write Interface Engine             
.********************************************************************
WDGT0000  WRITAB    CONTROLF,SEVENTY9;*115,PTCNDGUP,PTCNDGUA,PTCNDGMU:
                                      *118,PTCNDGUU,*179,PTCNDGPB:
                                      *239,PTCNDGAD,*240,PTCNDGDS:
                                      *241,PTCNDGTR,*242,PTCNDGRG
.
          WRITAB    CONTROLF,EIGHTY8;*53,PTCNDGAL,*54,PTCNDGDN:
                                     *55,PTCNDGMW
.
          WRITAB    CONTROLF,HUND05;*105,PTCNDGPO,*106,PTCNDGPR:
                                     *107,PTCNDGPA,*164,PTCNDGPE
.
          WRITAB    CONTROLF,HUND03;*41,PTCNDGHA,*42,PTCNDGHD
.
          WRITAB    CONTROLF,HUND10;*239,PTCNDGCP
.
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
. ------------------------------------------ End of additional code     I-90203
+
. ------------------------------------------ Start of deleted code      D-90203
. -- .********************************************************************
. -- .* WDGT0000  :  Write Interface Engine             
. -- .********************************************************************
. -- WDGT0000  WRITAB    CONTROLF,SEVENTY9;*115,PTCNDGUP,PTCNDGUA,PTCNDGMU:
. --                                  PTCNDGUU,*139,PTCNDPSI,*159,PTCNDPSO:
. --                                  *179,PTCNDGPB,*199,PTCNDASI,*219,PTCNDASO:
. --                                  *239,PTCNDGAD,*240,PTCNDGDS,*241,PTCNDGTR:
. --                                  *242,PTCNDGRG
. -- .
. --           WRITAB    CONTROLF,EIGHTY8;*3,PTCNDESI,*23,PTCNDESO,*53,PTCNDGAL:
. --                                      *54,PTCNDGDN,*55,PTCNDGMW
. -- .
. --           DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
. --           RETURN
. ------------------------------------------ End of deleted code        D-90203
+
.*****************************************************************************
.*                          WCIS0000                                         *
.*           Write PAS-CIS Broadcast Interface Parameters                    *
.*****************************************************************************
.
WCIS0000  WRITAB    CONTROLF,HUND10;*101,PTCNA01M:
                                    *102,PTCNA02M,*103,PTCNA03M,*104,PTCNA08M:
                                    *105,PTCNA11M,*106,PTCNA12M,*107,PTCNA13M:
                                    *108,PTCNA14M,*109,PTCNA21M,*110,PTCNA22M:
                                    *111,PTCNA27M,*112,PTCNA28M,*113,PTCNA31M:
                                    *114,PTCNA34M,*244,PTCNA44M
.
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W;
.
WCIS9999  RETURN
+
.********************************************************************
.* WRSB1000  :  Write State based PMI     
.********************************************************************
WRSB0000  WRITAB    CONTROLF,HUND05;*1,PTCNACTI,*26,PTCNINSN,*46,PTCNOTSN:
                                    *108,PTCNACSA,*123,PTCNAPID,*124,PTCNCCOD
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W;
          RETURN
+
.********************************************************************
.* WSSI0000  :  Write Singapore Interface 
.********************************************************************
WSSI0000  WRITAB    CONTROLF,EIGHTY;*1,PTCNMEAB,*41,PTCNMEDB
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.* WSAI0000  :  Write Status Adjustment Fields 
.******************************************************************** 
WSAI0000  WRITAB    CONTROLF,TWENTY;*188,PTCNIREF,*189,PTCNBRUS
          WRITAB    CONTROLF,SEVENTY7;*233,PTCNSTT,*234,PTCNSTP,*235,PTCNSTCL:
                    *236,PTCNSTA,*237,PTCNSTAC,*238,PTCNSTHF,*244,PTCNSTDR:
                    *245,PTCNSTCC,*246,PTCNSTCS,*247,PTCNSTDC,*248,PTCNSTDA:
                    *249,PTCNSTST
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
.
.********************************************************************
.* WRIBAP1  :  Write IBA Controlled PRS/2 Screen 1
.******************************************************************** 
WRIBAP1   WRITAB    CONTROLF,TEN;*243,PTCNEFLG
          WRITAB    CONTROLF,TWENTY1;*205,PTCNUKEY,PTCNCRRG,*208,PTCNCRTN:
                                     *210,PTCNHOSP
          WRITAB    CONTROLF,SEVENTY7;*12,PTCNPRSL
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2
          RETURN
+
.********************************************************************
.*  LDMICA00  :  Load Microfilm Address                             *
.********************************************************************
LDMICA00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<3
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DMICR0,DMICR1,DMICR2
            LOAD      TEMPCODE,COUNT,ZERO,ONE,TWO
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
          MOVE      "40",HLEF
          MOVE      "80",HRIG
          MOVE      "16",HTOP
          MOVE      "23",HBOT
.
          RETURN
.
+
.********************************************************************
.*  LDEEOC00  :  Load Emergency EOC Program                         *
.********************************************************************
LDEEOC00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<3
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DEEOC0,DEEOC1,DEEOC2
            LOAD      TEMPCODE,COUNT,ZERO,ONE,TWO
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
          MOVE      "40",HLEF
          MOVE      "80",HRIG
          MOVE      "16",HTOP
          MOVE      "23",HBOT
.
          RETURN
.********************************************************************
.*  LDQLDB00  :  Load QLD Bandings                                  *
.*                                                                  *
.********************************************************************
.
LDQLDB00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<7
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DISUSR1,DISUSR2,DISUSR3,DISUSR4,DISUSR5:
                                     ADMTYPE,CARECLSS
            LOAD      TEMPCODE,COUNT,ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
          MOVE      "40",HLEF
          MOVE      "79",HRIG
          MOVE      "13",HTOP
          MOVE      "23",HBOT
.
          RETURN
.********************************************************************
.*  LDHSPT00  :  Load Hospital Types Into Temp File                 *
.*                                                                  *
.********************************************************************
.
LDHSPT00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DHOSTYP0,DHOSTYP1
            LOAD      TEMPCODE,COUNT,ZERO,ONE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.
.********************************************************************
.*  LDMBSC00  :  Load MBS Codes in Med Rec into Temp File           *
.*                                                                  *
.********************************************************************
.
LDMBSC00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<3
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DMUSE0,DMUSE1,DMUSE2
            LOAD      TEMPCODE,COUNT,ZERO,ONE,TWO
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDHSPT00  :  Load Charging Types Into Temp File                 *
.*                                                                  *
.********************************************************************
.
LDCHRG00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<3
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DSYST0,DSYST1,DSYST2
            LOAD      TEMPCODE,COUNT,ZERO,ONE,TWO
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDICDC00  :  Load Type of ICD coding in temp file               *
.*                                                                  *
.********************************************************************
.
LDICDC00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DICDC0,DICDC1
            LOAD      TEMPCODE,COUNT,ZERO,ONE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDALRT00  :  Load Type of ALert System used in temp file        *
.*                                                                  *
.********************************************************************
LDALRT00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<3
            MOVE      ALRTONLY,TEMPDESC
            LOAD      TEMPDESC,COUNT,ALRTWARN,WARNONLY
            MOVE      ZERO,TEMPCODE
            LOAD      TEMPCODE,COUNT,ONE,TWO
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
            ADD       ONE,COUNT
          DO
.
          RETURN
.
.********************************************************************
.*  LDHTYP00  :  Load Hospital Type Into Temp File                  *
.*                                                                  *
.********************************************************************
.
LDHTYP00  CALL      BUILD000                * Build a New Temp File
.
          PACK      KEY2,SP2
          CALL      RDSHOSP2
.
LDHTYP10  CALL      RDKHOSP2
          BRANCH    OVRCD,LDHTYP99
.
          MOVE      HOSDESC,TEMPDESC
          MOVE      DHOSINDX,TEMPCODE
.
          ENDSET    TEMPCODE
          APPEND    SP8,TEMPCODE
          RESET     TEMPCODE
.
          MOVE      TEMPCODE,KEY8
          CALL      WRTEMP1
.
          GOTO      LDHTYP10
.
LDHTYP99  RETURN
.
.********************************************************************
.*  LDUHID00  :  Load Unique Hospital Id's Into Temp File           *
.*                                                                  *
.********************************************************************
.
LDUHID00  CALL      BUILD000                * Build a New Temp File
.
          PACK      KEY4,SP4
          CALL      RDSHOSP1
.
LDUHID10  CALL      RDKHOSP1
          BRANCH    OVRCD,LDUHID99
.
          MOVE      HOSDESC,TEMPDESC
          MOVE      HOSCODE,TEMPCODE
.
          ENDSET    TEMPCODE
          APPEND    SP8,TEMPCODE
          RESET     TEMPCODE
.
          MOVE      TEMPCODE,KEY8
          CALL      WRTEMP1
.
          GOTO      LDUHID10
.
LDUHID99  RETURN
.
.********************************************************************
.*  LDONOF00  :  Load On/Off Fields Into Temp File                  *
.*                                                                  *
.********************************************************************
.
LDONOF00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DOFF,DON
            LOAD      TEMPCODE,COUNT,ZERO,ONE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.
.********************************************************************
.*  LDYSNO00  :  Load Yes/No Fields Into Temp File                  *
.*                                                                  *
.********************************************************************
.
LDYSNO00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DNO,DYES
            LOAD      TEMPCODE,COUNT,ZERO,ONE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDEROR00  :  Load Error Messages Into Temp File                 *
.*                                                                  *
.********************************************************************
.
LDEROR00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DERROR0,DERROR1
            LOAD      TEMPCODE,COUNT,ZERO,ONE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.
.********************************************************************
.*  LDREPT00  :  Load Reporting Layout Into Temp File               *
.*                                                                  *
.********************************************************************
.
LDREPT00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DREPT0,DREPT1
            LOAD      TEMPCODE,COUNT,ZERO,ONE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDCHRG00  :  Load Charging Type Into Temp File                  *
.*                                                                  *
.********************************************************************
.
LDDCHG00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<10
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DFEETYP0,DFEETYP1,DFEETYP2,DFEETYP3:
                                     DFEETYP4,DFEETYP5,DFEETYP6,DFEETYP7:
                                     DFEETYP8,DFEETYP9
.
            LOAD     TEMPCODE,COUNT,ZERO,ONE,TWO,THREE,FOUR,FIVE,SIX:
                                    SEVEN,EIGHT,NINE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDURTP00  :  Load U/R Types Into Temp File                      *
.*                                                                  *
.********************************************************************
.
LDURTP00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<5
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DURTYP0,DURTYP1,DURTYP2,DURTYP3,DURTYP4
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE,TWO,THREE,FOUR
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDGNUR00  :  Load U/R Generation Types Into Temp File           *
.*                                                                  *
.********************************************************************
.
LDGNUR00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<3
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DHGENR0,DHGENR1,DHGENR2
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE,TWO
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDURLN00  :  Load U/R Link Types Into Temp File                 *
.*                                                                  *
.********************************************************************
.
LDURLN00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<5
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DURLINK0,DURLINK1,DURLINK2,DURLINK3:
                      DURLINK4
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE,TWO,THREE,FOUR
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDPERS00  :  Load Person Responsible Types into Temp File       *
.*                                                                  *
.********************************************************************
.
LDPERS00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DCPCONT1,DCPCONT2
.
            LOAD      TEMPCODE,COUNT,ONE,TWO
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDCOND00  :  Load Patient Condition Types into Temp File        *
.*                                                                  *
.********************************************************************
.
LDCOND00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DPCOND0,DPCOND1
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDPSTC00  :  Load Post Code Format Types into Temp File         *
.*                                                                  *
.********************************************************************
.
LDPSTC00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DPOSTCD0,DPOSTCD1
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDFEEI00  :  Load Fees Invoice Acc Types into Temp File         *
.*                                                                  *
.********************************************************************
.
LDFEEI00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<6
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DHCLAM0,DHCLAM1,DHCLAM2,DHCLAM3,DHCLAM4:
                                     DHCLAM9
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE,TWO,THREE,FOUR,FIVE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDATBR00  :  Load Age Trial Balance Report Types into Temp File *
.*                                                                  *
.********************************************************************
.
LDATBR00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<6
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DATBLY0,DATBLY1,DATBLY2,DATBLY3,DATBLY4:
                                     DATBLY5
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE,TWO,THREE,FOUR,FIVE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDJRND00  :  Load Journal Date Types into Temp File             *
.*                                                                  *
.********************************************************************
.
LDJRND00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DJRNAL1,DJRNAL2
.
            LOAD      TEMPCODE,COUNT,ONE,TWO
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDIDSL00  :  Load Id Sheet Layout Types into Temp File          *
.*                                                                  *
.********************************************************************
.
LDIDSL00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<9
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DHTYPE4,DHTYPE6,DHTYPE7,DHTYPE8:
                                     DHTYPE10,DHTYPE11,DHTYPE13,DHTYPE23,DHTYPE25
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,EIGHT
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.
.********************************************************************
.*  LDINVL00  :  Load Invoice Layout Types into Temp File           *
.*                                                                  *
.********************************************************************
.
LDINVL00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<34
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DHTYPE1,DHTYPE2,DHTYPE3,DHTYPE4:
                                     DHTYPE5,DHTYPE6,DHTYPE8,DHTYPE7:
                                     DHTYPE10,DHTYPE11,DHTYPE36,DHTYPE37:
                                     DHTYPE39,DHTYPE32,DHTYPE40,DHTYPE41:
                                     DHTYPE42,DHTYPE43,DHTYPE44,DHTYPE45:
                                     DHTYPE46,DHTYPE47,DHTYPE48,DHTYPE35:
                                     DHTYPE34,DHTYPE50,DHTYPE18,DHTYPE23:
                                     DHTYPE33,DHTYPE22,DHTYPE24,DHTYPE51:
                                     DHTYPE52,DHTYPE53
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE,TWO,THREE,FOUR:
                                     FIVE,SIX,SEVEN,EIGHT:
                                     NINE,TEN,TEN1,TEN2:
                                     TEN3,TEN4,TEN5,TEN6:
                                     TEN7,TEN8,TEN9,TWENTY:
                                     TWENTY1,TWENTY2,TWENTY3,TWENTY4:
                                     TWENTY5,TWENTY6,TWENTY7,TWENTY8:
                                     TWENTY9,THIRTY,THIRTY1,THIRTY2:
                                     THIRTY3,THIRTY4
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
+
.********************************************************************
.*  LDAFLG00  :  Load 'Admission Field To Capture Accident Flag'    *
.*                                                                  *
.********************************************************************
.
LDAFLG00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<12
            ADD       ONE,COUNT
            LOAD      TEMPCODE,COUNT,THIRTY4,THIRTY6,THIRTY8,FORTY,FORTY2:
                                     FORTY4,FORTY6,NINTY9,FORM101,FORM103:
                                     FORM118,FORM119
.
            MOVE      TEMPCODE,FORM5
            PACK      KEY15,SCRPRGID,SCRPSCID,FORM5
            CALL      RDSCFL1
            IF        OVRCD = 1
              MOVE      SP30,TEMPDESC
            ELSE
              MOVE      SCFLDES,TEMPDESC
            ENDIF
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
          MOVE      "35",HLEF
          MOVE      "80",HRIG
          MOVE      "7",HTOP
          MOVE      "23",HBOT
          RETURN
+
.********************************************************************
.*  SELFLG00  :  Select 'Admission Field To Capture Accident Flag'  *
.*                                                                  *
.********************************************************************
SELFLG00  CALL      GETSCR00
          SUSPEND
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,*V2LON,HLEF,HTOP,HRIG,HBOT
          ASSIGN    (HBOT-2),EVERT
          DISPLAY   *V2LON,*PHLEF:EVERT,*G33,*PHRIG:EVERT,*G34
          ASSIGN    (HLEF+1),ECOL
          ASSIGN    (HRIG-1),CCOL1
          HLINE     *G37,*V2LON,EVERT,ECOL,CCOL1
.
          ASSIGN    (HRIG-HLEF),CCITEM      * box width
          MOVE      ZERO,FORM2
          STRIP     BOXHDR
          MOVELPTR  BOXHDR,FORM2            * get the actual length of header
          ADD       TWO,FORM2               * allow for blanks each side
          IF        FORM2 <= CCITEM & FORM2 <> 2
            ASSIGN    (((CCITEM-FORM2)/2)+HLEF+1),ECOL   * display position
            DISPLAY   *V2LON,*HON,*PECOL:HTOP,SP1,*+,BOXHDR,*-,SP1
          ENDIF
.
          FLUSH     HLEF,HTOP,HRIG,HBOT
          SETLPTR   BOXHDR
.
          MOVE      "36",ECOL
          MOVE      "8",EVERT
          DISPLAY   *PECOL:EVERT,*V2LON,*ULON,"Item"
          ADD       FIVE,ECOL
          DISPLAY   *PECOL:EVERT,*V2LON,*ULON,"Field"
          ADD       SIX,ECOL
          DISPLAY   *PECOL:EVERT,*V2LON,*ULON,"Description"
          SUB       TEN1,ECOL
.
          MOVE      ZERO,COUNT
          PACK      KEY8,SP8
          CALL      RDSTEMP1
SELFLG10  CALL      RDKTEMP1
          BRANCH    OVRCD,SELFLG20          * end of file
.
          ADD       ONE,COUNT
          MOVE      TEMPCODE,TMPCDE[COUNT]       * store item numbers
          MOVE      TEMPCODE,KEY4
          STRIP     KEY4
          MOVE      KEY4,FORM4
          ADD       ONE,EVERT
          DISPLAY   *PECOL:EVERT,*V2LON,COUNT,*HOFF,". ",FORM4,SP1,TEMPDESC
          GOTO      SELFLG10
.
SELFLG20  DISPLAY   *P36:22,"Select Item, e(",*V2LON,ANSX,*HOFF,")it : ";
          KEYIN     *P58:22,*V2LON,FLAGITEM;
          REP       UPPLOW,FLAGITEM
          MATCH     ANSX,FLAGITEM                * exit
          GOTO      SELFLG95 IF EQUAL
.
          MOVE      FLAGITEM,FORM2               * check if in range
          IF        FORM2 < 1 | FORM2 > 12
            BEEP
            GOTO      SELFLG20
          ENDIF
.
SELFLG90  MOVE      ZERO,EXIT
          CALL      PUTSCR00
          GOTO      SELFLG99
.
SELFLG95  MOVE      ONE,EXIT
          CALL      PUTSCR00
SELFLG99  RETURN
+
.********************************************************************
.*  LDLABL00  :  Load Labels Layout Types into Temp File            *
.*                                                                  *
.********************************************************************
LDLABL00  CALL      BUILD000                * Build a New Temp File
          MOVE      ZERO,COUNT
          WHILE     COUNT<28
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DHTYPE2,DHTYPE3,DHTYPE5,DHTYPE6:
                                     DHTYPE9,DHTYPE10,DHTYPE12,DHTYPE14:
                                     DHTYPE15,DHTYPE16,DHTYPE17,DHTYPE18:
                                     DHTYPE19,DHTYPE20,DHTYPE21,DHTYPE22:
                                     DHTYPE23,DHTYPE24,DHTYPE25,DHTYPE26:
                                     DHTYPE27,DHTYPE28,DHTYPE29,DHTYPE30:
                                     DHTYPE31,DHTYPE34,DHTYPE35,DHTYPE54
            LOAD      TEMPCODE,COUNT,ZERO,ONE,TWO,THREE:
                                     FOUR,FIVE,SIX,SEVEN:
                                     EIGHT,NINE,TEN,TEN1:
                                     TEN2,TEN3,TEN4,TEN5:
                                     TEN6,TEN7,TEN8,TEN9:
                                     TWENTY,TWENTY1,TWENTY2,TWENTY3:
                                     TWENTY4,TWENTY5,TWENTY6,TWENTY7
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
          MOVE      "35",HLEF
          MOVE      "80",HRIG
          MOVE      "12",HTOP
          MOVE      "23",HBOT
          RETURN
.
.********************************************************************
.*  LDBDLS00  :  Load Occupied Bed Days L.O.S. Temp File            *
.*                                                                  *
.********************************************************************
.
LDBDLS00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,OCBDAY0,OCBDAY1
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDSEPM00  :  Load Separation Modes Temp File                    *
.*                                                                  *
.********************************************************************
.
LDSEPM00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DSEPMOD1,DSEPMOD2
.
            LOAD      TEMPCODE,COUNT,ONE,TWO
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LPTCD000  :  Load any codes file entry into temp file           *
.*  Parameters:  CODE    the category to load                       *
.********************************************************************
LPTCD000  CALL      BUILD000                * Build a New Temp File
          PACK      KEY5,CODE,SP3
          CALL      RDCODE1
.
LPTCD100  CALL      RDKCODE1
          BRANCH    OVRCD,LPTCD999
.
          MATCH     CODE,TCODE
          GOTO      LPTCD999 IF NOT EQUAL
.
          MOVE      ACODE,TEMPCODE
          MOVE      TDESC,TEMPDESC
.
          ENDSET    TEMPCODE
          APPEND    SP8,TEMPCODE
          RESET     TEMPCODE
.
          MOVE      TEMPCODE,KEY8
          CALL      WRTEMP1
          GOTO      LPTCD100
.
LPTCD999  RETURN
.
.********************************************************************
.*  LDPRAC00  :  Load Person Responsible for Account Temp File      *
.*                                                                  *
.********************************************************************
.
LDPRAC00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
.                                                                     *C-119915
          WHILE     COUNT < 4
            ADD       ONE,COUNT
.                                                                     *C-119915
            LOAD      TEMPDESC,COUNT,PRFADES0,PRFADES1,PRFADES2,PRFADES3
.
            LOAD      TEMPCODE,COUNT,ONE,TWO,THREE,FOUR
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDPM6800  :  Load Details in IBAPMS68 Temp File                 *
.*                                                                  *
.********************************************************************
.
LDPM6800  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DPMS68I0,DPMS68I1
.
            LOAD      TEMPCODE,COUNT,ONE,TWO
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDBTYP00  :  Load Bed Type for WCH Temp File                    *
.*                                                                  *
.********************************************************************
.
LDBTYP00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<1
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DBEDTYP1
.
            LOAD      TEMPCODE,COUNT,DBEDTYP1
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LD2SCR00  :  Load 2nd Screen Details into Temp File             *
.*                                                                  *
.********************************************************************
.
LD2SCR00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,BINPMH,PMIMENT
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDUVLD00  :  Load U/R Validation in IBAHOS59 into Temp File     *
.*                                                                  *
.********************************************************************
.
LDUVLD00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DURVH590,DURVH591
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDMFEE00  :  Load Miscell. Fees Invoice Acc Types into Temp File*
.*                                                                  *
.********************************************************************
.
LDMFEE00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DHCLAM5,DHCLAM6
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*  LDJFEE00  :  Load Journal Fees Invoice Acc Types into Temp File *
.*                                                                  *
.********************************************************************
.
LDJFEE00  CALL      BUILD000                * Build a New Temp File
.
          MOVE      ZERO,COUNT
          WHILE     COUNT<2
            ADD       ONE,COUNT
            LOAD      TEMPDESC,COUNT,DHCLAM7,DHCLAM8
.
            LOAD      TEMPCODE,COUNT,ZERO,ONE
.
            ENDSET    TEMPCODE
            APPEND    SP8,TEMPCODE
            RESET     TEMPCODE
.
            MOVE      TEMPCODE,KEY8
            CALL      WRTEMP1
          DO
.
          RETURN
.
.********************************************************************
.*                    BUILD000 - Build a New Temp File              *
.********************************************************************
.
BUILD000  CALL      KILL0000
.
          PACK      CMDLINE,SP70
          CLEAR     CMDLINE
          APPEND    "isbuild ",CMDLINE
          APPEND    TEMPNAME,CMDLINE
          APPEND    TEMPINDX,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
          OPEN      TMPCODE1,TEMPNAME
          OPEN      TMPCODE2,TEMPNAME
.
          RETURN
.
.********************************************************************
.*                    KILL0000 - Kills the Old Temp File            *
.********************************************************************
.
KILL0000  CLOSE     TMPCODE1
          PACK      CMDLINE,SP70
          CLEAR     CMDLINE
          APPEND    "iserase ",CMDLINE
          APPEND    TEMPNAME,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          RETURN
.
.
.********************************************************************
.*                    Temp File I/O Routines                        *
.********************************************************************
.
WRTEMP1  RESET     KEY8
         WRITE     TMPCODE1,KEY8;TEMPCODE,TEMPDESC
         RETURN
.
RDATEMP1 RESET     KEY8
         READ      TMPCODE1,KEY8;ANS
         RETURN
.
RDSTEMP1 RESET     KEY8
         READ      TMPCODE1,KEY8;;
         RETURN
.
RDTEMP1  MOVE      ZERO,OVRCD
         RESET     KEY8
         READ      TMPCODE1,KEY8;TEMPCODE,TEMPDESC
         GOTO      OVERCOND IF OVER
         RETURN
.
RDKTEMP1 MOVE      ZERO,OVRCD
         READKS    TMPCODE1;TEMPCODE,TEMPDESC
         GOTO      OVERCOND IF OVER
         RETURN
.
RDPTEMP1 MOVE      ZERO,OVRCD
         READKP    TMPCODE1;TEMPCODE,TEMPDESC
         GOTO      OVERCOND IF OVER
         RETURN
.
.
RDATEMP2 RESET     KEY38
         READ      TMPCODE2,KEY38;ANS
         RETURN
.
RDSTEMP2 RESET     KEY38
         READ      TMPCODE2,KEY38;;
         RETURN
.
RDTEMP2  MOVE      ZERO,OVRCD
         RESET     KEY38
         READ      TMPCODE2,KEY38;TEMPCODE,TEMPDESC
         GOTO      OVERCOND IF OVER
         RETURN
.
RDKTEMP2 MOVE      ZERO,OVRCD
         READKS    TMPCODE2;TEMPCODE,TEMPDESC
         GOTO      OVERCOND IF OVER
         RETURN
.
RDPTEMP2 MOVE      ZERO,OVRCD
         READKP    TMPCODE2;TEMPCODE,TEMPDESC
         GOTO      OVERCOND IF OVER
         RETURN
.
.==============================================================================
.
          INC       STDGENCD
          INC       STDKWSCD
          INC       AUTOPCOD                * Auto generation of the postcode
          INC       FMSCHQIO/INC
          INC       FMSAMAIO/INC
          INC       FMSDISIO/INC
          INC       FMSLMAIO/INC  
          INC       FMSRESIO/INC
          INC       FMSCHQKY
          INC       FMSRESKY
          INC       FMSDISKY
          INC       FMSLMAKY                * Keyin for Ledger 
          INC       FMSAMAKY                * Question mark for Account Code
          INC       GENCODKY                * General Code Keyin Routine
..........INC       GSECCD00                * Get Company Security Code
          INC       IBAGKIKY               
          INC       IBAGSTKY               
          INC       IBATMHKY               
          INC       IBASECUR                * Keyin IBA screen security passwd
          INC       IBAGSTIO/INC
          INC       IBATMDIO/INC
          INC       IBATMHIO/INC
          INC       IBATMDKY
          INC       PATCODKY
          INC       PATMCHRD                * Miscellaneous Charges read routine
          INC       SCRFLDKY
          INC       PATHOSIO/INC
          INC       PATCODIO/INC
          INC       PATFN1IO/INC
          INC       PATICOIO/INC
          INC       PATIN1IO/INC
          INC       PATIRNIO/INC
          INC       PATMCHIO/INC
          INC       MRTMOVIO/INC
          INC       RCPREGIO/INC
          INC       SCRFLDIO/INC
          INC       TFILENAM                     * Generate Temp File Name
          INC       IBASEQIO/INC                 * Sequential Numbers File
          INC       WEBERRIO/INC                 * Web Server Error Logging
.............................................................................
.*********************************************************************
.         keyin visit summary format
.*********************************************************************
KVSDF000  DISPLAY   *P1:24,"0 =",VSDF0,", 1 =",VSDF1,*EL;
          KEYIN     *P44:16,*V2LON,PTCNVSDF:
                    *P44:16,*DV,PTCNVSDF
          COMPARE   ZERO,PTCNVSDF
          GOTO      KVSDF900 IF EQUAL
          BRANCH    PTCNVSDF,KVSDF900
          BEEP
          GOTO      KVSDF000
KVSDF900  MOVE      VSDF0,DDESC13
          LOAD      DDESC13,PTCNVSDF,VSDF1
          DISPLAY   *P1:24,*EL,*P50:16,DDESC13
KVSDF999  RETURN
+
