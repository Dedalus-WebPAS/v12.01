.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.01.00"
.-------------------------------------------------------
. V9.09.01  25.06.2007 Sandra Barcham 123735
.           Added Contract Item and Contract Expiry Date
.-------------------------------------------------------
. V9.05.B01 03.02.2006 Sandra Barcham 93464
.           Extended Unit of Measure
.-------------------------------------------------------
. V9.04.01  21.04.2005 Peter Vela CAR 59698
.           Added functionality for Catalog Extended Description (sincijaf)
.           08.04.2005 Peter Vela CAR 59696
.           Changed commodity group from DIM 5 to DIM 6
. V9.03.01  10.09.2003 Steve Downing     (VF.11.01 CAR 9375)
.           Recompiled for SINREBFD & SINREBIO
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B01 02.11.2000 Charles Handaya
.           Recompiled for sincchaf and SINUSAGE change
.           Modification of Warehouse Security
.-------------------------------------------------------
. VF.01.03  09.10.2000 Charles Handaya
.           Change Stock to Non-stock will not Check Imprest if INCOSIN7 (1=Yes)
.           srf 6459
. VF.01.02  18.07.2000 Charles Handaya
.           Omnicell import file - Move spaces into Restock ID (SIBPRESI)
.           Quote 9817
. VF.01.01  18.05.2000 Charles Handaya
.           Add an item and painted it on screen
.-------------------------------------------------------
. VF.00.03  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           10.11.1999 Charles Handaya
.           Fix Y2K of Audit Files Date (CCYYMMDD)
. VF.00.02  02.11.1999 Sandra Barcham
.           Change locked message to use X
. VF.00.01  03.09.1999 Sandra Barcham
.           Add in Creditors Keyword Search
.           srf 631485
.-------------------------------------------------------
CMDLINE   DIM       80
.
INSCAT    FORM      1        * if in insert mode for SRF126775
INSRTCAT  FORM      1
ISPREFER  FORM      1
.
KEY27SAV  DIM       27
.
SAVSUP    DIM       5
SAVNON    FORM      1
SECSIWS   FORM      1
SLINE24   DIM       80
SSIIACAT  DIM       7      *      Catalog Code
SSIIADES  DIM       60     *      Description
SSIIASUB  DIM       5      *     Subjective
SSIIAISS  DIM       15     *     Issue Unit
SSIIASTI  DIM       6      *     Stock Indicator
SSIIAAVC  FORM      12.6   *     Average Cost
SSIIANAT  DIM       10     *    NATO Number
SSIIAABC  DIM       1      *    ABC Flag
SSIIAPSC  DIM       5      *    Preffered Supplier Code
SSIIAREX  FORM      1      *    Record Expiry Dates
SSIIANON  FORM      1      *    Non-Stock Item 0=No
SSIIASAB  FORM      1      *    Suspend ABC    0=No
SSIIASUS  FORM      1      *    Susp. Flag 1-Req'n 2-P/O 3-Both
SSIIADUN  DIM       15     *    Dispensing Units
SSIICCCT  FORM      12.2     * save var for current cost
SSIIAGST  DIM       6      *    GST Code
.
TMBANAME  DIM       8
TMBANAMA  INIT      "tmpbac"
TOTALEFT  FORM      12.2
TOTSUPS   FORM      4
TOTUNITS  FORM      4
.
TMPBACA1  IFILE     SQL, FIXED=61, KEY="U26-33,21-25,6-12,1-5,13-20"
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN02
.   Function      :   Catalog Maintenance                     
.   Generated  On :   16/07/2007
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
          INC       CSMCIAFD/INC
          INC       IBAGSTFD/INC
          INC       PHAPLUFD/INC
          INC       SINBACFD/INC
          INC       SINBATFD/INC
          INC       SINBPSFD/INC
          INC       SINCCAFD/INC
          INC       SINCCBFD/INC
          INC       SINCCEFD/INC
          INC       SINCCFFD/INC
          INC       SINCCHFD/INC
          INC       SINCGBFD/INC
          INC       SINCIAFD/INC
          INC       SINCIBFD/INC
          INC       SINCICFD/INC
          INC       SINCIDFD/INC
          INC       SINCIEFD/INC
          INC       SINCIFFD/INC
          INC       SINCIGFD/INC
          INC       SINCIHFD/INC
          INC       SINCIIFD/INC
          INC       SINCIJFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINCOSFD/INC
          INC       SINFACFD/INC
          INC       SINIMPFD/INC
          INC       SINITMFD/INC
          INC       SINNATFD/INC
          INC       SINPERFD/INC
          INC       SINPOAFD/INC
          INC       SINPOCFD/INC
          INC       SINPRQFD/INC
          INC       SINREAFD/INC
          INC       SINREBFD/INC
          INC       SINSCDFD/INC
          INC       SINSCMFD/INC
          INC       SINSUAFD/INC
          INC       SINSUBFD/INC
          INC       SINTMPDF/INC
          INC       SINWARFD/INC
          INC       SINWRKDF    
          INC       SINWRKFD/INC
          INC       SINWSEFD/INC
.=========================
.Local Variable Definition
.-------------------------
CANCFLAG  FORM      1 * Scr 00 Fld    11
SAVECATA  DIM       7 * Scr 00 Fld    12
SAVECRED  DIM       5 * Scr 00 Fld    13
SAVEUNIT  DIM      15 * Scr 00 Fld    14
SUSPDESC  DIM      25 * Scr 01 Fld    17
UDC1DESC  DIM      30 * Scr 01 Fld    26
UDC2DESC  DIM      30 * Scr 01 Fld    27
NOTESIIB  DIM       5 * Scr 01 Fld    31
.
.Word Processor File * Scr 01 Fld    32
.
NAMSIIB1  INIT      "Wsiib1"
FILSIIB1  DIM       8
.
.
.Word Processor File * Scr 01 Fld    39
.
NAMSIIJ1  INIT      "Wsiij1"
FILSIIJ1  DIM       8
.
.
.    Multi Item Key Fields Scr 02 Fld    23
.-------------------------------------------------------
SIIC1NAM  INIT      "SIIC1"
SIIC1END  FORM      1   * End Display
SIIC1SNO  FORM      5   * Number of Items on the Screen
SIIC1MKY  DIM       127 * Match Key 
SIIC1EKY  DIM       127 * End Key
SIIC1SKY  DIM       127 * Start Key
SIIC1IDX  INIT      " 132 UC1-5"
SIIC1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIIC1FNM  DIM       8  * Filename
SIIC1CNT  FORM      3  * Number of Items on Screen
ISSLCOST  FORM     12.6 * Scr 02 Fld    28
ISSCCOST  FORM     12.6 * Scr 02 Fld    33
NOTESIID  DIM       5 * Scr 03 Fld    31
.
.Word Processor File * Scr 03 Fld    32
.
NAMSIID1  INIT      "Wsiid1"
FILSIID1  DIM       8
.
.
.    Multi Item Key Fields Scr 04 Fld    23
.-------------------------------------------------------
SIIE1NAM  INIT      "SIIE1"
SIIE1END  FORM      1   * End Display
SIIE1SNO  FORM      5   * Number of Items on the Screen
SIIE1MKY  DIM       127 * Match Key 
SIIE1EKY  DIM       127 * End Key
SIIE1SKY  DIM       127 * Start Key
SIIE1IDX  INIT      " 132 UC1-5"
SIIE1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIIE1FNM  DIM       8  * Filename
SIIE1CNT  FORM      3  * Number of Items on Screen
WHOLESOH  FORM     12 * Scr 05 Fld    11
WHOLEROQ  FORM     12 * Scr 05 Fld    12
WHOLEROL  FORM     12 * Scr 05 Fld    13
NOTESIIG  DIM       5 * Scr 05 Fld    29
.
.Word Processor File * Scr 05 Fld    30
.
NAMSIIG1  INIT      "Wsiig1"
FILSIIG1  DIM       8
.
.
.    Multi Item Key Fields Scr 06 Fld     2
.-------------------------------------------------------
SIIF2NAM  INIT      "SIIF2"
SIIF2LEN  FORM      "146"
SIIF2IDX  INIT      "DC1-5 UC6-65"
SIIF2FNM  DIM       8  * Filename
SIIF2AFL  FORM      1  * End Accept Mode
SIIF2END  FORM      1  * End Display
SIIF2SNO  FORM      5  * Number of Items on the Screen
SIIF2NXT  DIM         65
SIIF2FL1  IFILE     SQL, FIXED=146,  KEY="D1-5"
SIIF2FL2  IFILE     SQL, FIXED=146, KEY="U6-65"
SIIF2CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr BA Fld     1
.-------------------------------------------------------
SIBT1NAM  INIT      "SIBT1"
SIBT1LEN  FORM      "58"
SIBT1IDX  INIT      "DC1-5 UC6-13"
SIBT1FNM  DIM       8  * Filename
SIBT1AFL  FORM      1  * End Accept Mode
SIBT1END  FORM      1  * End Display
SIBT1SNO  FORM      5  * Number of Items on the Screen
SIBT1NXT  DIM         13
SIBT1FL1  IFILE     SQL, FIXED=58,  KEY="D1-5"
SIBT1FL2  IFILE     SQL, FIXED=58, KEY="U6-13"
SIBT1CNT  FORM      3  * Number of Items on Screen
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN02"
PRGNAM    INIT      "Catalog Maintenance                     "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      ONAT0000
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIIB1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIIJ1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     SIIC1FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIID1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     SIIE1FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIIG1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     SIIF2FL2
          CLOSE     SIIF2FL1,DELETE
.
          CLOSE     SIBT1FL2
          CLOSE     SIBT1FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA1,"ibagstaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA2,"ibagstaf"
          DISPLAY   *P56:24,"Opening ibagstaf";
          OPEN      IBAGSTA3,"ibagstaf"
          MOVE      "   24",AUDTSECT
          MOVE      "205",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudfa";
            OPEN      SINAUDFA,"sinaudfa"
          ENDIF
          MOVE      "   24",AUDTSECT
          MOVE      "203",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudia";
            OPEN      SINAUDIA,"sinaudia"
          ENDIF
          MOVE      "   24",AUDTSECT
          MOVE      "207",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudic";
            OPEN      SINAUDIC,"sinaudic"
          ENDIF
          MOVE      "   24",AUDTSECT
          MOVE      "208",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudie";
            OPEN      SINAUDIE,"sinaudie"
          ENDIF
          DISPLAY   *P56:24,"Opening sinbacaf";
          OPEN      SINBACA2,"sinbacaf"
          DISPLAY   *P56:24,"Opening sinbacaf";
          OPEN      SINBACA3,"sinbacaf"
          DISPLAY   *P56:24,"Opening sinbataf";
          OPEN      SINBATA1,"sinbataf"
          DISPLAY   *P56:24,"Opening sinbpsaf";
          OPEN      SINBPSA1,"sinbpsaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA1,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinccbaf";
          OPEN      SINCCBA1,"sinccbaf"
          DISPLAY   *P56:24,"Opening sincceaf";
          OPEN      SINCCEA1,"sincceaf"
          DISPLAY   *P56:24,"Opening sincceaf";
          OPEN      SINCCEA2,"sincceaf"
          DISPLAY   *P56:24,"Opening sinccfaf";
          OPEN      SINCCFA1,"sinccfaf"
          DISPLAY   *P56:24,"Opening sinccfaf";
          OPEN      SINCCFA2,"sinccfaf"
          DISPLAY   *P56:24,"Opening sincchaf";
          OPEN      SINCCHA1,"sincchaf"
          DISPLAY   *P56:24,"Opening sincchaf";
          OPEN      SINCCHA5,"sincchaf"
          DISPLAY   *P56:24,"Opening sincgbaf";
          OPEN      SINCGBA1,"sincgbaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincibaf";
          OPEN      SINCIBA1,"sincibaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA1,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA2,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA4,"sincicaf"
          DISPLAY   *P56:24,"Opening sincidaf";
          OPEN      SINCIDA1,"sincidaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA1,"sincieaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA1,"sincifaf"
          DISPLAY   *P56:24,"Opening sincifaf";
          OPEN      SINCIFA2,"sincifaf"
          DISPLAY   *P56:24,"Opening sincigaf";
          OPEN      SINCIGA1,"sincigaf"
          DISPLAY   *P56:24,"Opening sincihaf";
          OPEN      SINCIHA1,"sincihaf"
          DISPLAY   *P56:24,"Opening sincihaf";
          OPEN      SINCIHA2,"sincihaf"
          DISPLAY   *P56:24,"Opening sinciiaf";
          OPEN      SINCIIA1,"sinciiaf"
          DISPLAY   *P56:24,"Opening sincijaf";
          OPEN      SINCIJA1,"sincijaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA2,"sincodaf"
          DISPLAY   *P56:24,"Opening sincosaf";
          OPEN      SINCOSA1,"sincosaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA1,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA2,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA2,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinitmaf";
          OPEN      SINITMA1,"sinitmaf"
          DISPLAY   *P56:24,"Opening sinitmaf";
          OPEN      SINITMA2,"sinitmaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA1,"sinperaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA2,"sinperaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA1,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA3,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA6,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinprqaf";
          OPEN      SINPRQA2,"sinprqaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA1,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA1,"sinrebaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA3,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscmaf";
          OPEN      SINSCMA1,"sinscmaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsubaf";
          OPEN      SINSUBA1,"sinsubaf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA1,"sinwseaf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA2,"sinwseaf"
.--------------------------------------------------------
. Initialise Wp Filename for Notes for Catalog                  
.--------------------------------------------------------
          PACK      FILSIIB1,NAMSIIB1,PORT
          REP       " 0",FILSIIB1
          DISPLAY   *P56:24,"Create & Open ",FILSIIB1;
          PREP      TEMPWORD,FILSIIB1
.
.--------------------------------------------------------
. Initialise Wp Filename for Extended Description for Catalog   
.--------------------------------------------------------
          PACK      FILSIIJ1,NAMSIIJ1,PORT
          REP       " 0",FILSIIJ1
          DISPLAY   *P56:24,"Create & Open ",FILSIIJ1;
          PREP      TEMPWORD,FILSIIJ1
.
.--------------------------------------------------------
. Initialise Batch Screen Supply Unit                        
.--------------------------------------------------------
          MOVE     ZERO,SIIC1SNO
          MOVE     "02   23",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIIC1SNO
            ENDIF
          ENDIF
          PACK      SIIC1FNM,ANST,SIIC1NAM,PORT
          REP       " 0",SIIC1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIIC1FL1,SIIC1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIIC1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIIC1FNM,SIIC1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIIC1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIIC1FL1,SIIC1FNM
.--------------------------------------------------------
. Initialise Wp Filename for Catalog/Supplier Notes             
.--------------------------------------------------------
          PACK      FILSIID1,NAMSIID1,PORT
          REP       " 0",FILSIID1
          DISPLAY   *P56:24,"Create & Open ",FILSIID1;
          PREP      TEMPWORD,FILSIID1
.
.--------------------------------------------------------
. Initialise Batch Screen Warehouse Code                     
.--------------------------------------------------------
          MOVE     ZERO,SIIE1SNO
          MOVE     "04   23",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIIE1SNO
            ENDIF
          ENDIF
          PACK      SIIE1FNM,ANST,SIIE1NAM,PORT
          REP       " 0",SIIE1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIIE1FL1,SIIE1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIIE1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIIE1FNM,SIIE1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIIE1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIIE1FL1,SIIE1FNM
.--------------------------------------------------------
. Initialise Wp Filename for Catalog/Warehouse Notes            
.--------------------------------------------------------
          PACK      FILSIIG1,NAMSIIG1,PORT
          REP       " 0",FILSIIG1
          DISPLAY   *P56:24,"Create & Open ",FILSIIG1;
          PREP      TEMPWORD,FILSIIG1
.
.--------------------------------------------------------
. Initialise Batch Screen Alias Description                  
.--------------------------------------------------------
          MOVE     ZERO,SIIF2SNO
          MOVE     "06    2",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIIF2SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Requisition                        
.--------------------------------------------------------
          MOVE     ZERO,SIBT1SNO
          MOVE     "BA    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIBT1SNO
            ENDIF
          ENDIF
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Control Screen                     
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Catalog Master Details             
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Supplier Summary                   
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Supplier Details                   
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Warehouse Summary                  
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Warehouse Details                  
          ENDIF
          MATCH     "06",SCRID
          IF         @EQUAL
            CALL       PS06L000   * Alias Maintenance                  
          ENDIF
          MATCH     "BA",SCRID
          IF         @EQUAL
            CALL       PSBAL000   * Backorder Details                  
          ENDIF
          RETURN
.--------------------------------
. Screen - Control Screen                     
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      RINCOCAT
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Control Screen                     
.-------------------------------------------------------
CF00L000
          MOVE      ZERO,CANCFLAG
          MOVE      SP70,SAVECATA
          MOVE      SP70,SAVECRED
          MOVE      SP70,SAVEUNIT
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Control Screen                     
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Control Screen                     
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Control Screen                     
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Control Screen                     
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Control Screen                     
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L101,PS00L102:
                            PS00L103,PS00L104
          GOTO     PS00L999
.
PS00L101
          MOVE      CANCFLAG,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      SAVECATA,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      SAVECRED,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      SAVEUNIT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Control Screen                     
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L101,SF00L102,SF00L103,SF00L104:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                           SF00L105,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL      INSCAT00
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      MODCAT00
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          MOVE      ZERO,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Catalog Master Details             
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
          CALL      UUSIIA00
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Catalog Master Details             
.-------------------------------------------------------
CF01L000  COMPARE   ZERO,ACCEPT
              GOTO      CF01L999 IF EQUAL
          MOVE      SP70,SIIACAT 
          MOVE      SP70,SIIADES 
          MOVE      SP70,SIIASUB 
          MOVE      SP70,SIIAISS 
          MOVE      SP70,SIIASTI 
          MOVE      ZERO,SIIAAVC 
          MOVE      SP70,SIIANAT 
          MOVE      SP70,SIIAABC 
          MOVE      SP70,SIIAPSC 
          MOVE      ZERO,SIIAREX 
          MOVE      ZERO,SIIANON 
          MOVE      ZERO,SIIASAB 
          MOVE      ZERO,SIIASUS 
          MOVE      SP70,SIIADTC 
          MOVE      SP70,SIIAUSC 
          MOVE      SP70,SIIATMC 
          MOVE      SP70,SUSPDESC
          MOVE      SP70,SIIAUD1 
          MOVE      SP70,SIIAUD2 
          MOVE      SP70,SIIAUC1 
          MOVE      SP70,SIIAUC2 
          MOVE      SP70,SIIAUY1 
          MOVE      SP70,SIIAUY2 
          MOVE      SP70,SIIAUR1 
          MOVE      SP70,SIIAUR2 
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
          MOVE      SP70,SISADESC
          MOVE      SP70,APMASN1 
          MOVE      SP70,NOTESIIB
          MOVE      SP70,SIIADUN 
          MOVE      SP70,SIIAGST 
          MOVE      SP70,IBGSDESC
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Catalog Master Details             
.--------------------------------------------------------
KY01L000
.
KY01L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECATA000
          BRANCH    EXIT,KY01L900,KY01L900
          MOVE      ZERO,ACCEPT
          MOVE      SIIACAT,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Catalog Master Details             
.---------------------------------------------------------
WP01L000
          PREP     TEMPWORD,FILSIIB1
          PACK     KEY10,SIIACAT,SP70
          MOVE     KEY10,SAVKEY80
          SETLPTR  SAVKEY80,7 
          CALL      RDSIIB1 
          IF        OVRCD=0
            CALL      RPSIIB1 
          ENDIF
WP01L100
          CALL     RKSIIB1 
          BRANCH   OVRCD,WP01L105
          PACK     KEY10,SIIBCAT,SIIBLIN
          MATCH    SAVKEY80,KEY10   
          GOTO     WP01L105 IF NOT EQUAL
          PACK     VAR,SIIBCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIBCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L100
WP01L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILSIIJ1
          PACK     KEY10,SIIACAT,SP70
          MOVE     KEY10,SAVKEY80
          SETLPTR  SAVKEY80,7 
          CALL      RDSIIJ1 
          IF        OVRCD=0
            CALL      RPSIIJ1 
          ENDIF
WP01L110
          CALL     RKSIIJ1 
          BRANCH   OVRCD,WP01L115
          PACK     KEY10,SIIJCAT,SIIJLIN
          MATCH    SAVKEY80,KEY10   
          GOTO     WP01L115 IF NOT EQUAL
          PACK     VAR,SIIJCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIJCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L110
WP01L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Catalog Master Details             
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Catalog Master Details             
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Catalog Master Details             
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L101,PS01L102,PS01L103:
                            PS01L104,PS01L105,PS01L106,PS01L107:
                            PS01L108,PS01L109,PS01L110,PS01L111:
                            PS01L112,PS01L113,PS01L114,PS01L115:
                            PS01L116,PS01L117,PS01L118,PS01L119:
                            PS01L120,PS01L121,PS01L122,PS01L123:
                            PS01L124,PS01L125,PS01L126,PS01L127:
                            PS01L128,PS01L999,PS01L129,PS01L130:
                            PS01L999,PS01L999,PS01L999,PS01L131:
                            PS01L132,PS01L133,PS01L134
          GOTO     PS01L999
.
PS01L101
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      SIIASTI,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      SIIANAT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      SIIAABC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      SIIAPSC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAREX,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      YES,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIANON,FORM2    
          LOAD      YESNO,FORM2,NO
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIASAB,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      SIIASUS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          UNPACK    SIIADTC,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      SIIAUSC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      SIIATMC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      SUSPDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          UNPACK    SIIAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          UNPACK    SIIAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          MOVE      SIIAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE      SIIAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          MOVE      SIIAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          MOVE      SIIAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L127
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L128
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L129
          CALL      NSIIB000
          MOVE      NOTESIIB,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L130
          MOVE     FILSIIB1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
.
PS01L131
          MOVE      SIIADUN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L132
          MOVE      SIIAGST,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L133
          MOVE      IBGSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L134
          MOVE     FILSIIJ1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Catalog Master Details             
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L105,SF01L106,SF01L107:
                            SF01L108,SF01L109,SF01L110,SF01L111:
                            SF01L112,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L113,SF01L114,SF01L115:
                            SF01L116,SF01L117,SF01L118,SF01L119:
                            SF01L120,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L121:
                            SF01L122,SF01L123,SF01L124,SF01L125:
                            SF01L126,SF01L006,SF01L127
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L101,SF01L102,SF01L103:
                            SF01L104,SF01L105,SF01L106,SF01L107:
                            SF01L108,SF01L109,SF01L110,SF01L111:
                            SF01L112,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L113,SF01L114,SF01L115:
                            SF01L116,SF01L117,SF01L118,SF01L119:
                            SF01L120,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L121:
                            SF01L020,SF01L020,SF01L020,SF01L125:
                            SF01L126,SF01L020,SF01L127
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          CALL     SELECTED
          STRIP     SIIADES 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIIADES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIIADES 
          SFORMAT   VAR,127
          ENDSET    SIIADES 
          APPEND    SP70,SIIADES 
          RESET     SIIADES 
          CMATCH    EXITCHAR,SIIADES 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIIADES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L101
            ENDIF
          ENDIF
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L102
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SISADESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSISAA00
          MOVE      SISACODE,SIIASUB
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L102
            ENDIF
            BRANCH    EXIT,SF01L102,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SISADESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EIUNT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESTI0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L104
            ENDIF
            BRANCH    EXIT,SF01L104,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIIASTI,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L105
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SIIAAVC 
          IF        SCPSMAN=1
            COMPARE   ZERO,SIIAAVC 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L105
            ENDIF
          ENDIF
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L106
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ENATO000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L106
            ENDIF
            BRANCH    EXIT,SF01L106,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIIANAT,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L107
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EABC0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L107
            ENDIF
            BRANCH    EXIT,SF01L107,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIIAABC,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L108
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPSUP000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L108
            ENDIF
            BRANCH    EXIT,SF01L108,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIIAPSC,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L109
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIIAREX 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAREX,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L110
          CALL      DEFAULTN
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESNON000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L110
            ENDIF
            BRANCH    EXIT,SF01L110,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      YES,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIANON,FORM2    
          LOAD      YESNO,FORM2,NO
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L111
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIIASAB 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIASAB,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L112
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SUSPDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESUS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L112
            ENDIF
            BRANCH    EXIT,SF01L112,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIIASUS,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   17",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SUSPDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L113
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIIAUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIIAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L114
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIIAUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIIAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L115
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UDC1DESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUDC1000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L115
            ENDIF
            BRANCH    EXIT,SF01L115,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIIAUC1,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UDC1DESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L116
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UDC2DESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EUDC2000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L116
            ENDIF
            BRANCH    EXIT,SF01L116,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIIAUC2,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UDC2DESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L117
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIIAUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L118
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIIAUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L119
          CALL     SELECTED
          STRIP     SIIAUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIIAUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIIAUR1 
          SFORMAT   VAR,127
          ENDSET    SIIAUR1 
          APPEND    SP70,SIIAUR1 
          RESET     SIIAUR1 
          CMATCH    EXITCHAR,SIIAUR1 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIIAUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L119
            ENDIF
          ENDIF
          MOVE      SIIAUR1,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L120
          CALL     SELECTED
          STRIP     SIIAUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIIAUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIIAUR2 
          SFORMAT   VAR,127
          ENDSET    SIIAUR2 
          APPEND    SP70,SIIAUR2 
          RESET     SIIAUR2 
          CMATCH    EXITCHAR,SIIAUR2 
          GOTO      SF01L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIIAUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L120
            ENDIF
          ENDIF
          MOVE      SIIAUR2,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L121
          CALL      NSIIB000
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,NOTESIIB
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 6",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIIB1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIIB1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          CALL      NSIIB000
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      NOTESIIB,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L122
          CALL      CAN10000
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L123
          CALL      POS10000
          MOVE      ONE,EXIT
          GOTO      SF01L999
.
SF01L124
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC06L000
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF01L001
.
SF01L125
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KDISP000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L125
            ENDIF
            BRANCH    EXIT,SF01L125,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIIADUN,VAR      
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L126
.
.
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,IBGSDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KIBGSA00
          MOVE      IBGSCODE,SIIAGST
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L126
            ENDIF
            BRANCH    EXIT,SF01L126,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      SIIAGST,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      IBGSDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L127
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "20",SCPSROW
              MOVE     " 21",SCPSCOL
              MOVE     " 57",SCPSLEN
              MOVE     " 3",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIIJ1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIIJ1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Supplier Summary                   
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
          CALL      UUSIIA00
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Supplier Summary                   
.-------------------------------------------------------
CF02L000
          MOVE      SP70,SIIACAT 
          MOVE      SP70,SIIADES 
          MOVE      SP70,SIIASUB 
          MOVE      SP70,SIIAISS 
          MOVE      ZERO,SIIAAVC 
          MOVE      SP70,SIIAPSC 
          MOVE      ZERO,SIIANON 
          MOVE      ZERO,SIIASUS 
          MOVE      SP70,SIIAUR1 
          MOVE      SP70,SIIAUR2 
          MOVE      SP70,SIIAUD1 
          MOVE      SP70,SIIAUD2 
          MOVE      SP70,SIIAUC1 
          MOVE      SP70,SIIAUC2 
          MOVE      SP70,SIIAUY1 
          MOVE      SP70,SIIAUY2 
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
          MOVE      SP70,SISADESC
          MOVE      SP70,APMASN1 
          MOVE      SP70,SUSPDESC
          MOVE      SP70,SIICSUT 
          MOVE      ZERO,SIFACTOR
          MOVE      SP70,SIICSUP 
          MOVE      SP70,APMASN1 
          MOVE      ZERO,SIICLCT 
          MOVE      ZERO,ISSLCOST
          MOVE      ZERO,SIICMAN 
          MOVE      ZERO,SIICAPO 
          MOVE      ZERO,SIICLTM 
          MOVE      ZERO,SIICCCT 
          MOVE      ZERO,ISSCCOST
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Supplier Summary                   
.--------------------------------------------------------
KY02L000
.
KY02L110
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIIADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIIASUB 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIIAISS 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECATB000
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      SIIACAT,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIASUB,VAR      
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIAISS,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Supplier Summary                   
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Supplier Summary                   
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :    23 Supply Unit                        
.---------------------------------------------------------
          UNPACK    SP70,SIICCAT,SIICSUP,SIICSUT
          PACK      KEY27,SIIACAT,SP70
          MOVE      KEY27,SIIC1EKY
          STRIP     SIIC1SKY
          SETLPTR   SIIC1EKY,7
          MOVE      SIIC1EKY,SIIC1SKY
          CALL      RDSIIC1 
          IF        OVRCD=0
            CALL      RPSIIC1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,SIIC1CNT
          MOVE     ZERO,SIIC1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L101,DP02L102:
                            DP02L103,DP02L104,DP02L105,DP02L106:
                            DP02L107,DP02L108,DP02L109,DP02L110:
                            DP02L111,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          PACK      SIIC1MKY,SP70,SP70
          CALL      UPTSIIC1
          IF        SIIC1END=0
            CALL      RKSIIC1 
            IF        OVRCD=0
              PACK      SIIC1MKY,SIICCAT,SIICSUP,SIICSUT                                                        
              MATCH     SIIC1EKY,SIIC1MKY
              IF        @EQUAL
                MOVE      ZERO,SIIC1END
                ADD       ONE,SIIC1CNT
                CALL      UPTSIIC1
          CALL      SUPDET00
                MOVE      SIICSUT,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,SIIC1END
              ENDIF
            ELSE
              MOVE      ONE,SIIC1END
            ENDIF
          ENDIF
          IF        SIIC1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        SIIC1END=0
            MOVE      SIFACTOR,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        SIIC1END=0
            MOVE      SIICSUP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        SIIC1END=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        SIIC1END=0
            MOVE      SIICLCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        SIIC1END=0
            MOVE      ISSLCOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        SIIC1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIICMAN,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L108
          IF        SIIC1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIICAPO,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L109
          IF        SIIC1END=0
            MOVE      SIICLTM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L110
          IF        SIIC1END=0
            MOVE      SIICCCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L111
          IF        SIIC1END=0
            MOVE      ISSCCOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "SIIC1",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "SIIC1",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY27,SIIC1SKY,SP70
          CALL     RDSIIC1  * Start
          IF       OVRCD=0
            CALL     RPSIIC1  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "SIIC1",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY27,SIIC1SKY,Z70
          CALL     RSSIIC1  * End
          IF       OVRCD=1
            CALL     RPSIIC1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIC1SNO
            CALL     RPSIIC1 
            IF       OVRCD=1
              MOVE     SIIC1SNO,SECTOR
            ENDIF
            PACK     SIIC1MKY,SIICCAT,SIICSUP,SIICSUT                                                        
            MATCH    SIIC1EKY,SIIC1MKY
            IF       !@EQUAL
              MOVE     SIIC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "SIIC1",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          CALL      RFTSIIC1
          BRANCH   OVRCD,PP02L115
          MOVE      SIIC1MKY,KEY27 
          CALL      RSSIIC1 
PP02L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIIC1SNO
            CALL     RPSIIC1 
            IF       OVRCD=1
              MOVE     SIIC1SNO,SECTOR
            ENDIF
            PACK     SIIC1MKY,SIICCAT,SIICSUP,SIICSUT                                                        
            MATCH    SIIC1EKY,SIIC1MKY
            IF       !@EQUAL
              MOVE     SIIC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIC1SNO
            CALL     RKSIIC1 
            IF       OVRCD=1
              MOVE     SIIC1SNO,SECTOR
            ENDIF
            PACK     SIIC1MKY,SIICCAT,SIICSUP,SIICSUT                                                        
            MATCH    SIIC1EKY,SIIC1MKY
            IF       !@EQUAL
              MOVE     SIIC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "SIIC1",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RKSIIC1 
          BRANCH   OVRCD,NP02L110
          PACK     SIIC1MKY,SIICCAT,SIICSUP,SIICSUT                                                        
          MATCH    SIIC1EKY,SIIC1MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RPSIIC1 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RPSIIC1 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Supplier Summary                   
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    23 Supply Unit                        
.---------------------------------------------------------
UPTSIIC1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIC1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIIC1FL1,KEY5;SCPSROW,SCPSCOL,SIIC1MKY
          ELSE
            UPDATE    SIIC1FL1;SCPSROW,SCPSCOL,SIIC1MKY
          ENDIF
          RETURN
RDTSIIC1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIC1FL1,KEY5;SCPSROW,SCPSCOL,SIIC1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIIC1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIIC1FL1,KEY5;;
          READKS    SIIC1FL1;SCPSROW,SCPSCOL,SIIC1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIIC1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Supplier Summary                   
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "SIIC1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Supplier Summary                   
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L101,PS02L102,PS02L103:
                            PS02L104,PS02L105,PS02L106,PS02L107:
                            PS02L108,PS02L109,PS02L110,PS02L111:
                            PS02L112,PS02L113,PS02L114,PS02L115:
                            PS02L116,PS02L117,PS02L118,PS02L119:
                            PS02L120,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999
          GOTO     PS02L999
.
PS02L101
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      SIIAPSC,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIANON,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      SIIASUS,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      SIIAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      SIIAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          UNPACK    SIIAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          UNPACK    SIIAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      SIIAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      SIIAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L116
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L117
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L118
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L119
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L120
          MOVE      SUSPDESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Supplier Summary                   
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L101,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L102,SF02L103,SF02L104:
                            SF02L105,SF02L106,SF02L107,SF02L108
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L101,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "SIIC1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          COMPARE   ONE,ACCEPT
          GOTO      SF02L001 IF EQUAL
          CALL      RDTSIIC1
          IF        OVRCD=1
            BEEP
            GOTO      SF02L001
          ENDIF
          MATCH     SP70,SIIC1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF02L001
          ENDIF
          MOVE      SIIC1MKY,KEY27 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      MODSUP00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIIC1
          IF        OVRCD=1
            CALL      FP02L000
          ELSE
            MOVE      SIIC1MKY,KEY27 
            CALL      RSSIIC1 
            CALL      RPSIIC1 
            CALL      DP02L000
          ENDIF
          GOTO     SF02L001
.
SF02L102
          MOVE      "SIIC1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L103
          MOVE      "SIIC1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      ADDSUP00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF02L000
          GOTO      SF02L001
.
SF02L105
          CALL      CAN20000
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L106
          MOVE      "SIIC1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L107
          MOVE      "SIIC1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
.
SF02L108
          MOVE      ONE,EXIT
          GOTO      SF02L999
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Supplier Details                   
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Supplier Details                   
.-------------------------------------------------------
CF03L000
          MOVE      SP70,SIIACAT 
          MOVE      SP70,SIICSUP 
          MOVE      SP70,SIICSUT 
          MOVE      ZERO,SIICCCT 
          MOVE      ZERO,SIICLCT 
          MOVE      ZERO,SIICLTM 
          MOVE      SP70,SIICPNO 
          MOVE      SP70,SIICPD1 
          MOVE      SP70,SIICPD2 
          MOVE      ZERO,SIICMAN 
          MOVE      ZERO,SIICAPO 
          MOVE      SP70,SIICUR1 
          MOVE      SP70,SIICUR2 
          MOVE      SP70,SIICUD1 
          MOVE      SP70,SIICUD2 
          MOVE      SP70,SIICUC1 
          MOVE      SP70,SIICUC2 
          MOVE      SP70,SIICUY1 
          MOVE      SP70,SIICUY2 
          MOVE      SP70,SIICUOM 
          MOVE      SP70,SIICCONT
          MOVE      SP70,SIICCTEX
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Supplier Details                   
.--------------------------------------------------------
KY03L000
.
KY03L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECATB000
          BRANCH    EXIT,KY03L900,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      SIIACAT,VAR      
          CALL      DISPITEM
.
KY03L120
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KAPMAA00
          MOVE      APMACRD,SIICSUP
          BRANCH    EXIT,KY03L110,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      SIICSUP,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ENDIF
.
KY03L130
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KSIFAB00
          MOVE      SIFASUPP,SIICSUT
          BRANCH    EXIT,KY03L120,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      SIICSUT,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Supplier Details                   
.---------------------------------------------------------
WP03L000
          PREP     TEMPWORD,FILSIID1
          PACK     KEY15,SIICCAT,SIICSUP,SP70
          MOVE     KEY15,SAVKEY80
          SETLPTR  SAVKEY80,12
          CALL      RDSIID1 
          IF        OVRCD=0
            CALL      RPSIID1 
          ENDIF
WP03L100
          CALL     RKSIID1 
          BRANCH   OVRCD,WP03L105
          PACK     KEY15,SIIDCAT,SIIDSUP,SIIDLIN
          MATCH    SAVKEY80,KEY15   
          GOTO     WP03L105 IF NOT EQUAL
          PACK     VAR,SIIDCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIDCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP03L100
WP03L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Supplier Details                   
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Supplier Details                   
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Supplier Details                   
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L101,PS03L102,PS03L103:
                            PS03L104,PS03L105,PS03L106,PS03L107:
                            PS03L108,PS03L999,PS03L999,PS03L109:
                            PS03L110,PS03L111,PS03L112,PS03L113:
                            PS03L114,PS03L115,PS03L116,PS03L117:
                            PS03L118,PS03L119,PS03L120,PS03L121:
                            PS03L122,PS03L123,PS03L124,PS03L125:
                            PS03L126,PS03L127,PS03L128,PS03L129:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L130,PS03L131,PS03L132
          GOTO     PS03L999
.
PS03L101
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIANON,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      SIIASUS,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      SUSPDESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      SIICCCT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      SIICLCT,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L111
          MOVE      SIICLTM,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L112
          MOVE      SIICPNO,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L113
          MOVE      SIICPD1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L114
          MOVE      SIICPD2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICMAN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L116
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICAPO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L117
          MOVE      SIICUR1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L118
          MOVE      SIICUR2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L119
          UNPACK    SIICUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L120
          UNPACK    SIICUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L121
          MOVE      SIICUC1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L122
          MOVE      SIICUC2,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L123
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L124
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L125
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L126
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L127
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L128
          CALL      NSIID000
          MOVE      NOTESIID,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L129
          MOVE     FILSIID1,WORDNAME
          CALL     DISPWORD
          GOTO     PS03L999
.
PS03L130
          MOVE      SIICUOM,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICCONT,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L132
          UNPACK    SIICCTEX,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Supplier Details                   
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L101:
                            SF03L102,SF03L103,SF03L104,SF03L105:
                            SF03L106,SF03L107,SF03L108,SF03L109:
                            SF03L110,SF03L111,SF03L112,SF03L113:
                            SF03L114,SF03L115,SF03L116,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L117:
                            SF03L006,SF03L118,SF03L119,SF03L120:
                            SF03L121,SF03L122,SF03L123
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L101:
                            SF03L102,SF03L103,SF03L104,SF03L105:
                            SF03L106,SF03L107,SF03L108,SF03L109:
                            SF03L110,SF03L111,SF03L112,SF03L113:
                            SF03L114,SF03L115,SF03L116,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L117:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L121,SF03L122,SF03L123
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SIICCCT 
          IF        SCPSMAN=1
            COMPARE   ZERO,SIICCCT 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L101
            ENDIF
          ENDIF
          MOVE      SIICCCT,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L102
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SIICLCT 
          IF        SCPSMAN=1
            COMPARE   ZERO,SIICLCT 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L102
            ENDIF
          ENDIF
          MOVE      SIICLCT,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L103
          CALL     SELECTED
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SIICLTM 
          IF        SCPSMAN=1
            COMPARE   ZERO,SIICLTM 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L103
            ENDIF
          ENDIF
          MOVE      SIICLTM,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L104
          CALL     SELECTED
          STRIP     SIICPNO 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIICPNO,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIICPNO 
          SFORMAT   VAR,127
          ENDSET    SIICPNO 
          APPEND    SP70,SIICPNO 
          RESET     SIICPNO 
          CMATCH    EXITCHAR,SIICPNO 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIICPNO 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L104
            ENDIF
          ENDIF
          MOVE      SIICPNO,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L105
          CALL      DEFPTD00
          CALL     SELECTED
          STRIP     SIICPD1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIICPD1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIICPD1 
          SFORMAT   VAR,127
          ENDSET    SIICPD1 
          APPEND    SP70,SIICPD1 
          RESET     SIICPD1 
          CMATCH    EXITCHAR,SIICPD1 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIICPD1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L105
            ENDIF
          ENDIF
          MOVE      SIICPD1,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L106
          CALL     SELECTED
          STRIP     SIICPD2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIICPD2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIICPD2 
          SFORMAT   VAR,127
          ENDSET    SIICPD2 
          APPEND    SP70,SIICPD2 
          RESET     SIICPD2 
          CMATCH    EXITCHAR,SIICPD2 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIICPD2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L106
            ENDIF
          ENDIF
          MOVE      SIICPD2,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L107
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIICMAN 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICMAN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L108
          CALL      DEFAULTY
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIICAPO 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICAPO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L109
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UDC1DESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          STRIP     SIICUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIICUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIICUR1 
          SFORMAT   VAR,127
          ENDSET    SIICUR1 
          APPEND    SP70,SIICUR1 
          RESET     SIICUR1 
          CMATCH    EXITCHAR,SIICUR1 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIICUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L109
            ENDIF
          ENDIF
          MOVE      SIICUR1,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UDC1DESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L110
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UDC2DESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          STRIP     SIICUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIICUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIICUR2 
          SFORMAT   VAR,127
          ENDSET    SIICUR2 
          APPEND    SP70,SIICUR2 
          RESET     SIICUR2 
          CMATCH    EXITCHAR,SIICUR2 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIICUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L110
            ENDIF
          ENDIF
          MOVE      SIICUR2,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UDC2DESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L111
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIICUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIICUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L112
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIICUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIICUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L113
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOD1000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L113
            ENDIF
            BRANCH    EXIT,SF03L113,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SIICUC1,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L114
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOD2000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L114
            ENDIF
            BRANCH    EXIT,SF03L114,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      SIICUC2,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L115
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIICUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L116
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIICUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L117
          CALL      NSIID000
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,NOTESIID
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 8",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "14",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIID1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIID1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          CALL      NSIID000
.
.
          MOVE      "   31",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      NOTESIID,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L118
          CALL      CAN30000
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L119
          CALL      DEL30000
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L120
          CALL      POS30000
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L121
          CALL     SELECTED
          STRIP     SIICUOM 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIICUOM,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIICUOM 
          SFORMAT   VAR,127
          ENDSET    SIICUOM 
          APPEND    SP70,SIICUOM 
          RESET     SIICUOM 
          CMATCH    EXITCHAR,SIICUOM 
          GOTO      SF03L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIICUOM 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L121
            ENDIF
          ENDIF
          MOVE      SIICUOM,VAR      
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L122
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIICCONT
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICCONT,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L123
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECEXP000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L123
            ENDIF
            BRANCH    EXIT,SF03L123,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          UNPACK    SIICCTEX,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Warehouse Summary                  
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
          CALL      UUSIIA00
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Warehouse Summary                  
.-------------------------------------------------------
CF04L000
          MOVE      SP70,SIIACAT 
          MOVE      SP70,SIIADES 
          MOVE      SP70,SIIASUB 
          MOVE      SP70,SIIAISS 
          MOVE      ZERO,SIIAAVC 
          MOVE      SP70,SIIAPSC 
          MOVE      ZERO,SIIANON 
          MOVE      ZERO,SIIASUS 
          MOVE      SP70,SIIAUR1 
          MOVE      SP70,SIIAUR2 
          MOVE      SP70,SIIAUD1 
          MOVE      SP70,SIIAUD2 
          MOVE      SP70,SIIAUC1 
          MOVE      SP70,SIIAUC2 
          MOVE      SP70,SIIAUY1 
          MOVE      SP70,SIIAUY2 
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
          MOVE      SP70,SISADESC
          MOVE      SP70,APMASN1 
          MOVE      SP70,SUSPDESC
          MOVE      SP70,SIIEWAR 
          MOVE      SP70,SIIERAS 
          MOVE      ZERO,SIIESOH 
          MOVE      SP70,SIWADES 
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Warehouse Summary                  
.--------------------------------------------------------
KY04L000
.
KY04L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECATB000
          BRANCH    EXIT,KY04L900,KY04L900
          MOVE      ZERO,ACCEPT
          MOVE      SIIACAT,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Warehouse Summary                  
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Warehouse Summary                  
.---------------------------------------------------------
LM04L000
.---------------------------------------------------------
. Load for :    23 Warehouse Code                     
.---------------------------------------------------------
          UNPACK    SP70,SIIECAT,SIIEWAR
          PACK      KEY12,SIIACAT,SP70
          MOVE      KEY12,SIIE1EKY
          STRIP     SIIE1SKY
          SETLPTR   SIIE1EKY,7
          MOVE      SIIE1EKY,SIIE1SKY
          CALL      RDSIIE1 
          IF        OVRCD=0
            CALL      RPSIIE1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP04L000
          MOVE     ZERO,SIIE1CNT
          MOVE     ZERO,SIIE1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP04L600
          MATCH    PRGID,SCPSPID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP04L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L101,DP04L102:
                            DP04L103,DP04L104,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010
          GOTO      DP04L010
.
DP04L101
          PACK      SIIE1MKY,SP70,SP70
          CALL      UPTSIIE1
          IF        SIIE1END=0
            CALL      RKSIIE1 
            IF        OVRCD=0
              PACK      SIIE1MKY,SIIECAT,SIIEWAR                                                                
              MATCH     SIIE1EKY,SIIE1MKY
              IF        @EQUAL
                MOVE      ZERO,SIIE1END
                ADD       ONE,SIIE1CNT
                CALL      UPTSIIE1
          CALL      WARDET00
                MOVE      SIIEWAR,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,SIIE1END
              ENDIF
            ELSE
              MOVE      ONE,SIIE1END
            ENDIF
          ENDIF
          IF        SIIE1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L102
          IF        SIIE1END=0
            MOVE      SIIERAS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L103
          IF        SIIE1END=0
            MOVE      SIIESOH,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L104
          IF        SIIE1END=0
            MOVE      SIWADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
DP04L600
          MATCH    "SIIE1",NAMSSFFI
          GOTO     DP04L605 IF NOT EQUAL
          GOTO     DP04L999
DP04L605
DP04L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP04L000
.
          MATCH    "SIIE1",NAMSSFFI
          GOTO     FP04L105 IF NOT EQUAL
          PACK     KEY12,SIIE1SKY,SP70
          CALL     RDSIIE1  * Start
          IF       OVRCD=0
            CALL     RPSIIE1  * Start
          ENDIF
          CALL     DP04L000
          GOTO     FP04L999
FP04L105
FP04L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP04L000
.
          MATCH    "SIIE1",NAMSSFFI
          GOTO     LP04L105 IF NOT EQUAL
          PACK     KEY12,SIIE1SKY,Z70
          CALL     RSSIIE1  * End
          IF       OVRCD=1
            CALL     RPSIIE1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIE1SNO
            CALL     RPSIIE1 
            IF       OVRCD=1
              MOVE     SIIE1SNO,SECTOR
            ENDIF
            PACK     SIIE1MKY,SIIECAT,SIIEWAR                                                                
            MATCH    SIIE1EKY,SIIE1MKY
            IF       !@EQUAL
              MOVE     SIIE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     LP04L999
LP04L105
LP04L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP04L000
.
          MATCH    "SIIE1",NAMSSFFI
          GOTO     PP04L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP04L105
          CALL      RFTSIIE1
          BRANCH   OVRCD,PP04L115
          MOVE      SIIE1MKY,KEY12 
          CALL      RSSIIE1 
PP04L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIIE1SNO
            CALL     RPSIIE1 
            IF       OVRCD=1
              MOVE     SIIE1SNO,SECTOR
            ENDIF
            PACK     SIIE1MKY,SIIECAT,SIIEWAR                                                                
            MATCH    SIIE1EKY,SIIE1MKY
            IF       !@EQUAL
              MOVE     SIIE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     PP04L999
PP04L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIE1SNO
            CALL     RKSIIE1 
            IF       OVRCD=1
              MOVE     SIIE1SNO,SECTOR
            ENDIF
            PACK     SIIE1MKY,SIIECAT,SIIEWAR                                                                
            MATCH    SIIE1EKY,SIIE1MKY
            IF       !@EQUAL
              MOVE     SIIE1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP04L999
PP04L120
PP04L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP04L000
          MATCH    "SIIE1",NAMSSFFI
          GOTO     NP04L115 IF NOT EQUAL
NP04L105
          CALL     RKSIIE1 
          BRANCH   OVRCD,NP04L110
          PACK     SIIE1MKY,SIIECAT,SIIEWAR                                                                
          MATCH    SIIE1EKY,SIIE1MKY
          GOTO     NP04L110 IF NOT EQUAL
          CALL     RPSIIE1 
          CALL     DP04L000
          GOTO     NP04L999
NP04L110
          CALL     RPSIIE1 
          BEEP
          GOTO     NP04L999
NP04L115
NP04L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT04L000
CT04L105
CT04L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Warehouse Summary                  
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :    23 Warehouse Code                     
.---------------------------------------------------------
UPTSIIE1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIE1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIIE1FL1,KEY5;SCPSROW,SCPSCOL,SIIE1MKY
          ELSE
            UPDATE    SIIE1FL1;SCPSROW,SCPSCOL,SIIE1MKY
          ENDIF
          RETURN
RDTSIIE1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIE1FL1,KEY5;SCPSROW,SCPSCOL,SIIE1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIIE1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIIE1FL1,KEY5;;
          READKS    SIIE1FL1;SCPSROW,SCPSCOL,SIIE1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIIE1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Warehouse Summary                  
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
          MOVE      "SIIE1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      FP04L000
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Warehouse Summary                  
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L101,PS04L102,PS04L103:
                            PS04L104,PS04L105,PS04L106,PS04L107:
                            PS04L108,PS04L109,PS04L110,PS04L111:
                            PS04L112,PS04L113,PS04L114,PS04L115:
                            PS04L116,PS04L117,PS04L118,PS04L119:
                            PS04L120,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999
          GOTO     PS04L999
.
PS04L101
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L105
          MOVE      SIIAPSC,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIANON,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L107
          MOVE      SIIASUS,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L108
          MOVE      SIIAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L109
          MOVE      SIIAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L110
          UNPACK    SIIAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L111
          UNPACK    SIIAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L112
          MOVE      SIIAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L113
          MOVE      SIIAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L116
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L117
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L118
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L119
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L120
          MOVE      SUSPDESC,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Warehouse Summary                  
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L101,SF04L006:
                            SF04L006,SF04L006,SF04L102,SF04L103:
                            SF04L006,SF04L104,SF04L105,SF04L106:
                            SF04L006,SF04L107,SF04L108
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L101,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          MOVE      "SIIE1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L101
          CALL      SELECTED
          BRANCH    EXIT,SF04L001
          COMPARE   ONE,ACCEPT
          GOTO      SF04L001 IF EQUAL
          CALL      RDTSIIE1
          IF        OVRCD=1
            BEEP
            GOTO      SF04L001
          ENDIF
          MATCH     SP70,SIIE1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF04L001
          ENDIF
          MOVE      SIIE1MKY,KEY12 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      MODWAR00
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIIE1
          IF        OVRCD=1
            CALL      FP04L000
          ELSE
            MOVE      SIIE1MKY,KEY12 
            CALL      RSSIIE1 
            CALL      RPSIIE1 
            CALL      DP04L000
          ENDIF
          GOTO     SF04L001
.
SF04L102
          MOVE      "SIIE1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      NP04L000
          GOTO     SF04L001
.
SF04L103
          MOVE      "SIIE1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      PP04L000
          GOTO     SF04L001
.
SF04L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      ADDWAR00
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF04L000
          GOTO      SF04L001
.
SF04L105
          MOVE      "SIIE1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L106
          MOVE      "SIIE1",NAMSSFFI
          MOVE      "   23",ITMSSFFI
          CALL      LP04L000
          GOTO     SF04L001
.
SF04L107
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L108
          MOVE      ONE,EXIT
          GOTO      SF04L999
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.--------------------------------
. Screen - Warehouse Details                  
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC05L200
          CALL      CF05L000 * Clear Fields
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Warehouse Details                  
.-------------------------------------------------------
CF05L000
          MOVE      SP70,SIIACAT 
          MOVE      SP70,SIIEWAR 
          MOVE      SP70,SIIESID 
          MOVE      SP70,SIIERAS 
          MOVE      ZERO,WHOLESOH
          MOVE      ZERO,WHOLEROQ
          MOVE      ZERO,WHOLEROL
          MOVE      ZERO,SIIESIC 
          MOVE      ZERO,SIIESAB 
          MOVE      SP70,SIIEABC 
          MOVE      ZERO,SIIESUS 
          MOVE      SP70,SIIEUR1 
          MOVE      SP70,SIIEUR2 
          MOVE      SP70,SIIEUC1 
          MOVE      SP70,SIIEUC2 
          MOVE      SP70,SIIEUD1 
          MOVE      SP70,SIIEUD2 
          MOVE      SP70,SIIEUY1 
          MOVE      SP70,SIIEUY2 
          MOVE      ZERO,SIIESTI 
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Warehouse Details                  
.--------------------------------------------------------
KY05L000
.
KY05L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECATB000
          BRANCH    EXIT,KY05L900,KY05L900
          MOVE      ZERO,ACCEPT
          MOVE      SIIACAT,VAR      
          CALL      DISPITEM
.
KY05L120
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIWADES 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KSIWSA00
          BRANCH    EXIT,KY05L110,KY05L900
          MOVE      ZERO,ACCEPT
          MOVE      SIIEWAR,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIWADES,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Warehouse Details                  
.---------------------------------------------------------
WP05L000
          PREP     TEMPWORD,FILSIIG1
          PACK     KEY15,SIIECAT,SIIEWAR,SP70
          MOVE     KEY15,SAVKEY80
          SETLPTR  SAVKEY80,12
          CALL      RDSIIG1 
          IF        OVRCD=0
            CALL      RPSIIG1 
          ENDIF
WP05L100
          CALL     RKSIIG1 
          BRANCH   OVRCD,WP05L105
          PACK     KEY15,SIIGCAT,SIIGWAR,SIIGLIN
          MATCH    SAVKEY80,KEY15   
          GOTO     WP05L105 IF NOT EQUAL
          PACK     VAR,SIIGCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIGCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP05L100
WP05L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Warehouse Details                  
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Warehouse Details                  
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Warehouse Details                  
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L101,PS05L102,PS05L103:
                            PS05L104,PS05L105,PS05L106,PS05L999:
                            PS05L107,PS05L108,PS05L109,PS05L110:
                            PS05L111,PS05L112,PS05L113,PS05L114:
                            PS05L115,PS05L116,PS05L117,PS05L118:
                            PS05L119,PS05L120,PS05L121,PS05L122:
                            PS05L123,PS05L124,PS05L125,PS05L126:
                            PS05L127,PS05L128,PS05L999,PS05L999:
                            PS05L999,PS05L129,PS05L999,PS05L130
          GOTO     PS05L999
.
PS05L101
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L103
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L104
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L105
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIANON,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L107
          MOVE      SIIESID,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L108
          MOVE      SIIERAS,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L109
          MOVE      WHOLESOH,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L110
          MOVE      WHOLEROQ,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L111
          MOVE      WHOLEROL,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIESIC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIESAB,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L114
          MOVE      SIIEABC,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L115
          MOVE      SIIESUS,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L116
          MOVE      SIIEUR1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L117
          MOVE      SIIEUR2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L118
          MOVE      SIIEUC1,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L119
          MOVE      SIIEUC2,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L120
          UNPACK    SIIEUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L121
          UNPACK    SIIEUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L122
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIEUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L123
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIEUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L124
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L125
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L126
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L127
          CALL      NSIIG000
          MOVE      NOTESIIG,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L128
          MOVE     FILSIIG1,WORDNAME
          CALL     DISPWORD
          GOTO     PS05L999
.
PS05L129
          MOVE      SUSPDESC,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L130
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIESTI,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Warehouse Details                  
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L101,SF05L102,SF05L103,SF05L104:
                            SF05L105,SF05L106,SF05L107,SF05L108:
                            SF05L109,SF05L110,SF05L111,SF05L112:
                            SF05L113,SF05L114,SF05L115,SF05L116:
                            SF05L117,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L118,SF05L119,SF05L120:
                            SF05L006,SF05L006,SF05L121,SF05L122
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L101,SF05L102,SF05L103,SF05L104:
                            SF05L105,SF05L106,SF05L107,SF05L108:
                            SF05L109,SF05L110,SF05L111,SF05L112:
                            SF05L113,SF05L114,SF05L115,SF05L116:
                            SF05L117,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L118,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L122
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
.
SF05L101
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESTW0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L101
            ENDIF
            BRANCH    EXIT,SF05L101,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      SIIESID,VAR      
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L102
          CALL     SELECTED
          STRIP     SIIERAS 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIIERAS,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIIERAS 
          SFORMAT   VAR,127
          ENDSET    SIIERAS 
          APPEND    SP70,SIIERAS 
          RESET     SIIERAS 
          CMATCH    EXITCHAR,SIIERAS 
          GOTO      SF05L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIIERAS 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L102
            ENDIF
          ENDIF
          MOVE      SIIERAS,VAR      
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESOH0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L103
            ENDIF
            BRANCH    EXIT,SF05L103,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      WHOLESOH,VAR     
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L104
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EROQ0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L104
            ENDIF
            BRANCH    EXIT,SF05L104,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      WHOLEROQ,VAR     
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EROL0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L105
            ENDIF
            BRANCH    EXIT,SF05L105,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      WHOLEROL,VAR     
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L106
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIIESIC 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIESIC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L107
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIIESAB 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIESAB,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L108
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EWABC000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L108
            ENDIF
            BRANCH    EXIT,SF05L108,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      SIIEABC,VAR      
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L109
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SUSPDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EWSU0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L109
            ENDIF
            BRANCH    EXIT,SF05L109,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      SIIESUS,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   34",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SUSPDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
.
SF05L110
          CALL     SELECTED
          STRIP     SIIEUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIIEUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIIEUR1 
          SFORMAT   VAR,127
          ENDSET    SIIEUR1 
          APPEND    SP70,SIIEUR1 
          RESET     SIIEUR1 
          CMATCH    EXITCHAR,SIIEUR1 
          GOTO      SF05L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIIEUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L110
            ENDIF
          ENDIF
          MOVE      SIIEUR1,VAR      
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L111
          CALL     SELECTED
          STRIP     SIIEUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIIEUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIIEUR2 
          SFORMAT   VAR,127
          ENDSET    SIIEUR2 
          APPEND    SP70,SIIEUR2 
          RESET     SIIEUR2 
          CMATCH    EXITCHAR,SIIEUR2 
          GOTO      SF05L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SIIEUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L111
            ENDIF
          ENDIF
          MOVE      SIIEUR2,VAR      
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L112
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UDC1DESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECDE1000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L112
            ENDIF
            BRANCH    EXIT,SF05L112,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      SIIEUC1,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UDC1DESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
.
SF05L113
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UDC2DESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECDE2000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L113
            ENDIF
            BRANCH    EXIT,SF05L113,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      SIIEUC2,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UDC2DESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
.
SF05L114
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIIEUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIIEUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L115
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SIIEUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SIIEUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L116
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIIEUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIEUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L117
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIIEUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIEUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L118
          CALL      NSIIG000
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,NOTESIIG
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "16",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     " 5",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIIG1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIIG1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          CALL      NSIIG000
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      NOTESIIG,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
.
SF05L119
          CALL      CAN50000
          MOVE      ONE,EXIT
          GOTO      SF05L999
.
SF05L120
          CALL      POS50000
          MOVE      ONE,EXIT
          GOTO      SF05L999
.
SF05L121
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      DEL50000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF05L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF05L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF05L999
          ENDIF
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF05L000
          ENDIF
          GOTO      SF05L001
.
SF05L122
          CALL      NYESNO00
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SIIESTI 
          CALL      CYESNO00
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIESTI,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF05L001
SF05L990  MOVE      ONE,EXIT * Exit Char Restart
SF05L999  RETURN
.--------------------------------
. Screen - Alias Maintenance                  
.--------------------------------
SC06L000
SC06L100
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "11",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC06L200
          CALL      CF06L000 * Clear Fields
SC06L300
          CALL      KY06L000 * Enter Key Fields
          BRANCH    EXIT,SC06L999,SC06L999
SC06L400
          CALL      WP06L000 * Load any WP Details
SC06L500
          CALL      LM06L000 * Load any Batch Details
SC06L600
          CALL      DF06L000 * Display Fields
SC06L700
          CALL      SF06L000 * Select Fields
          BRANCH    EXIT,SC06L100,SC06L100,SC06L200
SC06L800
SC06L900
SC06L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Alias Maintenance                  
.-------------------------------------------------------
CF06L000
CF06L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Alias Maintenance                  
.--------------------------------------------------------
KY06L000
          MOVE      ZERO,EXIT
          GOTO      KY06L999
.
KY06L900  MOVE      ONE,EXIT
KY06L999  RETURN
.---------------------------------------------------------
. Load WP files for : Alias Maintenance                  
.---------------------------------------------------------
WP06L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Alias Maintenance                  
.---------------------------------------------------------
LM06L000
.---------------------------------------------------------
. Load for :     2 Alias Description                  
.---------------------------------------------------------
          UNPACK    SP70,SIIFCAT,SIIFALI
          PACK      SIIF2FNM,ANST,SIIF2NAM,PORT
          REP       " 0",SIIF2FNM
          MOVE      ZERO,SIIF2AFL
          CLOSE     SIIF2FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIIF2FL1,SIIF2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIIF2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIIF2FNM,SP1,SIIF2LEN,SP1,SIIF2IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      SIIF2FL1,SIIF2FNM
          OPEN      SIIF2FL2,SIIF2FNM
          PACK      KEY67,SAVCAT,SP70
          MOVE      KEY67,SAVKEY80
          SETLPTR   SAVKEY80,7 
          CALL      RDSIIF2 
          IF        OVRCD=0
            CALL      RPSIIF2 
          ENDIF
LM06L100
          CALL      RKSIIF2 
          BRANCH    OVRCD,LM06L105
          PACK      KEY67,SIIFCAT,SIIFALI
          MATCH     SAVKEY80,KEY67   
          GOTO      LM06L105 IF NOT EQUAL
          RESET     KEY67,8
          MOVE      KEY67,KEY60
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TASIIF22
          IF        OVRCD=0
            CALL      TUSIIF22
          ELSE
            CALL      TWSIIF22
          ENDIF
          GOTO     LM06L100
LM06L105
          MOVE     SP70,KEY60  
          CALL     TSSIIF22
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Alias Maintenance                  
.---------------------------------------------------------
SM06L000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SM06L010 IF EQUAL
SM06L005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SM06L010,SM06L101,SM06L010,SM06L010:
                            SM06L010,SM06L010,SM06L010,SM06L010:
                            SM06L010,SM06L010
SM06L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM06L007
          MATCH     PRGID,SCPSPID
          GOTO      SM06L007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM06L007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM06L007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM06L006 IF NOT EQUAL
          GOTO      SM06L005
SM06L007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SM06L010
          BRANCH    STDGSFLG,SM06L006
          CALL      RKSCPS1
          BRANCH    OVRCD,SM06L900
          MATCH     PRGID,SCPSPID
          GOTO      SM06L900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SM06L900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SM06L900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SM06L010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SM06L010,SM06L010,SM06L010,SM06L010:
                            SM06L010,SM06L010,SM06L010,SM06L010:
                            SM06L010,SM06L010
          GOTO      SM06L010
.
SM06L101
          CALL      MAPMX000
          MOVE     ZERO,SIIF2AFL
          STRIP     SIIFALI 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIIFALI,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIIFALI 
          SFORMAT   VAR,127
          ENDSET    SIIFALI 
          APPEND    SP70,SIIFALI 
          RESET     SIIFALI 
          MATCH     SP70,SIIFALI 
          GOTO      SM06L990 IF EQUAL
          CMATCH    EXITCHAR,SIIFALI 
          GOTO      SM06L990 IF EQUAL
          PACK     KEY67,SIIFCAT,SIIFALI                                                           
          RESET    KEY67,8
          MOVE     KEY67,KEY60
          CALL      TASIIF22
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SM06L101
          ENDIF
          MOVE      SIIFALI,VAR      
          CALL      DISPITEM
          GOTO     SM06L010
SM06L900
          MATCH    "SIIF2",NAMSSFFI
          IF       @EQUAL
            PACK     KEY67,SIIFCAT,SIIFALI
            RESET    KEY67,8
            MOVE     KEY67,KEY60
            CALL      TASIIF22
            IF        OVRCD=0
              CALL      TUSIIF22
            ELSE
              CALL      TWSIIF22
            ENDIF
            GOTO      SM06L999
          ENDIF
          GOTO      SM06L999
SM06L990
          MATCH    "SIIF2",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,SIIF2AFL
          ENDIF
SM06L999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP06L000
          MOVE     ZERO,SIIF2CNT
          MOVE     ZERO,SIIF2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP06L600
          MATCH    PRGID,SCPSPID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP06L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP06L010,DP06L101,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010
          GOTO      DP06L010
.
DP06L101
          IF        SIIF2END=0
            CALL      TKSIIF22
            IF        OVRCD=1
              MOVE      ONE,SIIF2END
            ELSE
              MOVE      ZERO,SIIF2END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUSIIF22
              MOVE      SIIFALI,VAR      
              CALL      DISPITEM
            ENDIF
          ENDIF
          IF        SIIF2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
DP06L600
          MATCH    "SIIF2",NAMSSFFI
          GOTO     DP06L605 IF NOT EQUAL
          GOTO     DP06L999
DP06L605
DP06L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP06L000
.
          CALL     CT06L000
          MATCH    "SIIF2",NAMSSFFI
          GOTO     FP06L105 IF NOT EQUAL
          MOVE     SP70,KEY60  
          CALL     TSSIIF22 * Start
          CALL     DP06L000
          GOTO     FP06L999
FP06L105
FP06L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP06L000
.
          CALL     CT06L000
          MATCH    "SIIF2",NAMSSFFI
          GOTO     LP06L105 IF NOT EQUAL
          PACK     KEY60,Z70
          CALL     TSSIIF22
          IF       OVRCD=1
            CALL     TPSIIF22 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIF2SNO
            CALL     TPSIIF22
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     LP06L999
LP06L105
LP06L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP06L000
.
PP06L100
          MATCH    "SIIF2",NAMSSFFI
          GOTO     PP06L115 IF NOT EQUAL
PP06L105
          MOVE     SP70,SIIF2NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSSIIF21
          CALL     TKSIIF21 * First on Page
          MOVE     KEY60,SIIF2NXT
          CALL     TSSIIF22
          CALL     TPSIIF22 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PP06L999
          ENDIF
.
          CALL     CT06L000
.
. Position and Display Page
.--------------------------
PP06L110
          MOVE     SIIF2NXT,KEY60  
          CALL     TSSIIF22
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIIF2SNO
            CALL     TPSIIF22
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     PP06L999
PP06L115
PP06L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP06L000
          MATCH    "SIIF2",NAMSSFFI
          GOTO     NP06L115 IF NOT EQUAL
NP06L105
          MOVE     SP70,SIIF2NXT
          PACK     KEY5,Z70
          CALL     TSSIIF21
          CALL     TPSIIF21
          MOVE     KEY60,SIIF2NXT
          CALL     TSSIIF22
          CALL     TKSIIF22
          IF       OVRCD=1
            BEEP
            GOTO      NP06L999
          ENDIF
.
          CALL     CT06L000
.
. Position and Display Page
.--------------------------
NP06L110
          MOVE     SIIF2NXT,KEY60  
          CALL     TSSIIF22
          CALL     DP06L000
          GOTO     NP06L999
NP06L115
NP06L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT06L000
          MATCH    "SIIF2",NAMSSFFI
          GOTO     CT06L115 IF NOT EQUAL
CT06L105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSSIIF21
          CALL     TKSIIF21
          BRANCH   OVRCD,CT06L110
          CALL     TRSIIF22
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUSIIF22
          GOTO     CT06L105
CT06L110
          GOTO     CT06L999
CT06L115
CT06L999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CP06L000
          CALL     CT06L000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CP06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,CP06L999
          MATCH    PRGID,SCPSPID
          GOTO     CP06L999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CP06L999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CP06L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CP06L010,CP06L100,CP06L010,CP06L010:
                            CP06L010,CP06L010,CP06L010,CP06L010:
                            CP06L010,CP06L010
.
CP06L100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CP06L010
CP06L999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
AD06L000
          CALL      CP06L000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
AD06L010  CALL      RKSCPS2
          BRANCH    OVRCD,AD06L000
          MATCH     PRGID,SCPSPID
          GOTO      AD06L000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      AD06L000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      AD06L000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SM06L000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "SIIF2",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,SIIF2AFL
            GOTO      AD06L010 IF EQUAL
            CALL      FP06L000
            GOTO      AD06L999
          ENDIF
AD06L999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DL06L000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DL06L005  
          CALL      MDELQ000
          BRANCH    EXIT,DL06L900,DL06L900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DL06L100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "SIIF2",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRSIIF21
            IF        OVRCD=0
              CALL      TDSIIF22
            ELSE
              BEEP
              GOTO      DL06L005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSSIIF21
            CALL      TKSIIF21
            MOVE     KEY60,SIIF2NXT
            CALL      CT06L000
            MOVE      SIIF2NXT,KEY60  
            CALL      TSSIIF22
            CALL      TPSIIF22
            CALL      DP06L000
            GOTO      DL06L005
          ENDIF
DL06L100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DL06L005
DL06L900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Alias Maintenance                  
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     2 Alias Description                  
.---------------------------------------------------------
TSSIIF21  RESET     KEY5
          READ      SIIF2FL1,KEY5;;
          RETURN
.
TSSIIF22  RESET     KEY60  
          READ      SIIF2FL2,KEY60;;
          RETURN
.
TASIIF22  RESET     KEY60  
          MOVE      ZERO,OVRCD
          READ      SIIF2FL2,KEY60;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDSIIF21  RESET     KEY5
          DELETE    SIIF2FL1,KEY5
          RETURN
.
TDSIIF22  RESET     KEY60
          DELETE    SIIF2FL2,KEY60
          RETURN
.
TKSIIF21  MOVE      ZERO,OVRCD
          READKS    SIIF2FL1;SCTMROW,SCTMCOL,KEY60:
                        SIIFCAT,SIIFALI,SIIFTYP,SIIFATY,SIIFSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKSIIF22  MOVE      ZERO,OVRCD
          READKS    SIIF2FL2;SCTMROW,SCTMCOL,KEY60:
                        SIIFCAT,SIIFALI,SIIFTYP,SIIFATY,SIIFSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPSIIF21  MOVE      ZERO,OVRCD
          READKP    SIIF2FL1;SCTMROW,SCTMCOL,KEY60:
                        SIIFCAT,SIIFALI,SIIFTYP,SIIFATY,SIIFSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPSIIF22  MOVE      ZERO,OVRCD
          READKP    SIIF2FL2;SCTMROW,SCTMCOL,KEY60:
                        SIIFCAT,SIIFALI,SIIFTYP,SIIFATY,SIIFSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRSIIF21  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      SIIF2FL1,KEY5;SCTMROW,SCTMCOL,KEY60:
                        SIIFCAT,SIIFALI,SIIFTYP,SIIFATY,SIIFSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRSIIF22  RESET     KEY60  
          MOVE      ZERO,OVRCD
          READ      SIIF2FL2,KEY60;SCTMROW,SCTMCOL,KEY60:
                        SIIFCAT,SIIFALI,SIIFTYP,SIIFATY,SIIFSPA                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUSIIF21  UPDATE    SIIF2FL1;SCTMROW,SCTMCOL,KEY60:
                        SIIFCAT,SIIFALI,SIIFTYP,SIIFATY,SIIFSPA                 
          RETURN
.
TUSIIF22
          UPDATE    SIIF2FL2;SCTMROW,SCTMCOL,KEY60:
                        SIIFCAT,SIIFALI,SIIFTYP,SIIFATY,SIIFSPA                 
          RETURN
.
TWSIIF22  RESET     KEY60  
          WRITE     SIIF2FL2,KEY60;SCTMROW,SCTMCOL,KEY60:
                        SIIFCAT,SIIFALI,SIIFTYP,SIIFATY,SIIFSPA                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Alias Maintenance                  
.---------------------------------------------------------
DF06L000
          BRANCH   ACCEPT,DF06L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF06L900
          MATCH    PRGID,SCPSPID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF06L010 IF NOT EQUAL
.
          CALL     PS06L000 * Display Field
          GOTO     DF06L010
DF06L900
          MOVE      "SIIF2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      FP06L000
DF06L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Alias Maintenance                  
.---------------------------------------------------------
PS06L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999
          GOTO     PS06L999
PS06L999
          RETURN
.---------------------------------------------------------
. Selections for : Alias Maintenance                  
.---------------------------------------------------------
SF06L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF06L001  BRANCH   ACCEPT,SF06L020
.
SF06L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L006,SF06L101,SF06L102,SF06L103:
                            SF06L104,SF06L105,SF06L106,SF06L107:
                            SF06L108,SF06L109
SF06L006  BEEP
          GOTO     SF06L005
SF06L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF06L090
          MATCH    PRGID,SCSLPID
          GOTO     SF06L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF06L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L020,SF06L101,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020
          GOTO     SF06L020
SF06L090  MOVE     ZERO,ACCEPT
          MOVE      "SIIF2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L101
          CALL      SELECTED
          BRANCH    EXIT,SF06L001
          MOVE      "SIIF2",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRSIIF21
            BRANCH    OVRCD,SF06L001
            MATCH     SCTMROW,SCSLROW
            GOTO      SF06L001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SF06L001 IF NOT EQUAL
            CALL      SM06L000 * Change Line
          ELSE
            IF        SIIF2AFL=0
              MOVE      "SIIF2",NAMSSFFI
              MOVE     "    2",ITMSSFFI
              CALL      AD06L000 * Add Line
            ENDIF
          ENDIF
          GOTO     SF06L001
.
SF06L102
          MOVE      "SIIF2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      NP06L000
          GOTO     SF06L001
.
SF06L103
          MOVE      "SIIF2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      PP06L000
          GOTO     SF06L001
.
SF06L104
          CALL      CLRDES00
          MOVE      "SIIF2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      AD06L000
          GOTO     SF06L001
.
SF06L105
          MOVE      "SIIF2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      DL06L000
          GOTO     SF06L001
.
SF06L106
          MOVE      "SIIF2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L107
          MOVE      "SIIF2",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      LP06L000
          GOTO     SF06L001
.
SF06L108
          MOVE      ZERO,EXIT
          GOTO      SF06L999
.
SF06L109
          CALL      SALI0000
          MOVE      ZERO,EXIT
          GOTO      SF06L999
SF06L990  MOVE      ONE,EXIT * Exit Char Restart
SF06L999  RETURN
.--------------------------------
. Screen - Backorder Details                  
.--------------------------------
SCBAL000
SCBAL100
          MOVE      "BA",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SCBAL200
          CALL      CFBAL000 * Clear Fields
SCBAL300
          CALL      KYBAL000 * Enter Key Fields
          BRANCH    EXIT,SCBAL999,SCBAL999
SCBAL400
          CALL      WPBAL000 * Load any WP Details
SCBAL500
          CALL      LMBAL000 * Load any Batch Details
SCBAL600
          CALL      DFBAL000 * Display Fields
SCBAL700
          CALL      SFBAL000 * Select Fields
          BRANCH    EXIT,SCBAL100,SCBAL100,SCBAL200
SCBAL800
SCBAL900
SCBAL999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Backorder Details                  
.-------------------------------------------------------
CFBAL000
CFBAL999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Backorder Details                  
.--------------------------------------------------------
KYBAL000
          MOVE      ZERO,EXIT
          GOTO      KYBAL999
.
KYBAL900  MOVE      ONE,EXIT
KYBAL999  RETURN
.---------------------------------------------------------
. Load WP files for : Backorder Details                  
.---------------------------------------------------------
WPBAL000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Backorder Details                  
.---------------------------------------------------------
LMBAL000
.---------------------------------------------------------
. Load for :     1 Requisition                        
.---------------------------------------------------------
          UNPACK    SP70,SIBTPON,SIBTREQ
          PACK      SIBT1FNM,ANST,SIBT1NAM,PORT
          REP       " 0",SIBT1FNM
          MOVE      ZERO,SIBT1AFL
          CLOSE     SIBT1FL2
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIBT1FL1,SIBT1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIBT1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIBT1FNM,SP1,SIBT1LEN,SP1,SIBT1IDX
          DISPLAY   *P1:3;
          EXECUTE   KEY80,TASKID
          OPEN      SIBT1FL1,SIBT1FNM
          OPEN      SIBT1FL2,SIBT1FNM
          PACK      KEY15,PORT,SP70
          MOVE      KEY15,SAVKEY80
          SETLPTR   SAVKEY80,7 
          CALL      RDSIBT1 
          IF        OVRCD=0
            CALL      RPSIBT1 
          ENDIF
LMBAL100
          CALL      RKSIBT1 
          BRANCH    OVRCD,LMBAL105
          PACK      KEY15,SIBTPON,SIBTREQ
          MATCH     SAVKEY80,KEY15   
          GOTO      LMBAL105 IF NOT EQUAL
          RESET     KEY15,8
          MOVE      KEY15,KEY8
          MOVE      SP70,SCTMROW
          MOVE      SP70,SCTMCOL
          CALL      TASIBT12
          IF        OVRCD=0
            CALL      TUSIBT12
          ELSE
            CALL      TWSIBT12
          ENDIF
          GOTO     LMBAL100
LMBAL105
          MOVE     SP70,KEY8   
          CALL     TSSIBT12
          RETURN
.---------------------------------------------------------
. Batch Item Selected Screen : Backorder Details                  
.---------------------------------------------------------
SMBAL000
          MOVE      ZERO,STDGSFLG
          MOVE      SCPSITM,FIRSTITM
          MOVE      SCPSROW,SCTMROW
          MOVE      SCPSCOL,SCTMCOL
          PACK      KEY15,PRGID,SCRID,SCPSROW,SCPSCOL
          MOVE      KEY15,SKSCPS15
          CALL      RDSCPS1
          COMPARE   ZERO,ACCEPT
          GOTO      SMBAL010 IF EQUAL
SMBAL005
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          MOVE      ONE,STDGSFLG
          BRANCH    FIELDNO,SMBAL101,SMBAL010,SMBAL010,SMBAL010:
                            SMBAL010,SMBAL010,SMBAL010,SMBAL010:
                            SMBAL010,SMBAL010,SMBAL010,SMBAL010:
                            SMBAL010,SMBAL010,SMBAL010,SMBAL010:
                            SMBAL010,SMBAL010,SMBAL010,SMBAL010:
                            SMBAL010
SMBAL006
          CALL      RKSCPS1
          BRANCH    OVRCD,SMBAL007
          MATCH     PRGID,SCPSPID
          GOTO      SMBAL007 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SMBAL007 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SMBAL007 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SMBAL006 IF NOT EQUAL
          GOTO      SMBAL005
SMBAL007
          MOVE      ZERO,STDGSFLG
          MOVE      SKSCPS15,KEY15
          CALL      RDSCPS1
SMBAL010
          BRANCH    STDGSFLG,SMBAL006
          CALL      RKSCPS1
          BRANCH    OVRCD,SMBAL900
          MATCH     PRGID,SCPSPID
          GOTO      SMBAL900 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      SMBAL900 IF NOT EQUAL
          MATCH     FIRSTITM,SCPSITM
          GOTO      SMBAL900 IF EQUAL
          MATCH     NAMSSFFI,SCPSMTY
          GOTO      SMBAL010 IF NOT EQUAL
          MOVE      SCPSROW,CVERT
          MOVE      SCPSCOL,CCOL
          MOVE      SCPSITM,FIELDNO
          BRANCH    FIELDNO,SMBAL010,SMBAL010,SMBAL010,SMBAL102:
                            SMBAL010,SMBAL010,SMBAL010,SMBAL010:
                            SMBAL010,SMBAL010,SMBAL010,SMBAL010:
                            SMBAL010,SMBAL010,SMBAL010,SMBAL010:
                            SMBAL010,SMBAL010,SMBAL010,SMBAL010:
                            SMBAL010
          GOTO      SMBAL010
.
SMBAL101
          MOVE     ZERO,SIBT1AFL
          STRIP     SIBTREQ 
          SFORMAT   VAR,SCPSLEN
          MOVE      SIBTREQ,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SIBTREQ 
          SFORMAT   VAR,127
          ENDSET    SIBTREQ 
          APPEND    SP70,SIBTREQ 
          RESET     SIBTREQ 
          MATCH     SP70,SIBTREQ 
          GOTO      SMBAL990 IF EQUAL
          CMATCH    EXITCHAR,SIBTREQ 
          GOTO      SMBAL990 IF EQUAL
          PACK     KEY15,SIBTPON,SIBTREQ                                                           
          RESET    KEY15,8
          MOVE     KEY15,KEY8
          CALL      TASIBT12
          IF        OVRCD=0
            MOVE      "Record Already On File - ",DISPMSG
            CALL      MESSAGE1
            GOTO      SMBAL101
          ENDIF
          MOVE      SIBTREQ,VAR      
          CALL      DISPITEM
          CALL      BACLIN00
          GOTO     SMBAL010
.
SMBAL102
          MOVE      SP70,VAR
          CALL      DISPITEM
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,SIBTISS 
          IF        SCPSMAN=1
            COMPARE   ZERO,SIBTISS 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SMBAL102
            ENDIF
          ENDIF
          MOVE      SIBTISS,VAR      
          CALL      DISPITEM
          GOTO     SMBAL010
SMBAL900
          MATCH    "SIBT1",NAMSSFFI
          IF       @EQUAL
            PACK     KEY15,SIBTPON,SIBTREQ
            RESET    KEY15,8
            MOVE     KEY15,KEY8
            CALL      TASIBT12
            IF        OVRCD=0
              CALL      TUSIBT12
            ELSE
              CALL      TWSIBT12
            ENDIF
            GOTO      SMBAL999
          ENDIF
          GOTO      SMBAL999
SMBAL990
          MATCH    "SIBT1",NAMSSFFI
          IF       @EQUAL
            MOVE     ONE,SIBT1AFL
          ENDIF
SMBAL999
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DPBAL000
          MOVE     ZERO,SIBT1CNT
          MOVE     ZERO,SIBT1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DPBAL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DPBAL600
          MATCH    PRGID,SCPSPID
          GOTO     DPBAL600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DPBAL600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DPBAL010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DPBAL101,DPBAL102,DPBAL103,DPBAL104:
                            DPBAL105,DPBAL010,DPBAL010,DPBAL010:
                            DPBAL010,DPBAL010,DPBAL010,DPBAL010:
                            DPBAL010,DPBAL010,DPBAL010,DPBAL010:
                            DPBAL010,DPBAL010,DPBAL010,DPBAL010:
                            DPBAL010
          GOTO      DPBAL010
.
DPBAL101
          IF        SIBT1END=0
            CALL      TKSIBT12
            IF        OVRCD=1
              MOVE      ONE,SIBT1END
            ELSE
              MOVE      ZERO,SIBT1END
              MOVE      SCPSROW,SCTMROW
              MOVE      SCPSCOL,SCTMCOL
              CALL      TUSIBT12
              MOVE      SIBTREQ,VAR      
              CALL      DISPITEM
          CALL      BACLIN00
            ENDIF
          ENDIF
          IF        SIBT1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPBAL010
.
DPBAL102
          IF        SIBT1END=0
            MOVE      SIBTCST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPBAL010
.
DPBAL103
          IF        SIBT1END=0
            MOVE      SIBTQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPBAL010
.
DPBAL104
          IF        SIBT1END=0
            MOVE      SIBTISS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPBAL010
.
DPBAL105
          IF        SIBT1END=0
            MOVE      SICADESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DPBAL010
DPBAL600
          MATCH    "SIBT1",NAMSSFFI
          GOTO     DPBAL605 IF NOT EQUAL
          GOTO     DPBAL999
DPBAL605
DPBAL999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FPBAL000
.
          CALL     CTBAL000
          MATCH    "SIBT1",NAMSSFFI
          GOTO     FPBAL105 IF NOT EQUAL
          MOVE     SP70,KEY8   
          CALL     TSSIBT12 * Start
          CALL     DPBAL000
          GOTO     FPBAL999
FPBAL105
FPBAL999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LPBAL000
.
          CALL     CTBAL000
          MATCH    "SIBT1",NAMSSFFI
          GOTO     LPBAL105 IF NOT EQUAL
          PACK     KEY8,Z70
          CALL     TSSIBT12
          IF       OVRCD=1
            CALL     TPSIBT12 * End
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIBT1SNO
            CALL     TPSIBT12
            ADD      ONE,SECTOR
          DO
          CALL     DPBAL000
          GOTO     LPBAL999
LPBAL105
LPBAL999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PPBAL000
.
PPBAL100
          MATCH    "SIBT1",NAMSSFFI
          GOTO     PPBAL115 IF NOT EQUAL
PPBAL105
          MOVE     SP70,SIBT1NXT
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSSIBT11
          CALL     TKSIBT11 * First on Page
          MOVE     KEY8,SIBT1NXT
          CALL     TSSIBT12
          CALL     TPSIBT12 * Get Key
          IF       OVRCD=1
            BEEP
            GOTO      PPBAL999
          ENDIF
.
          CALL     CTBAL000
.
. Position and Display Page
.--------------------------
PPBAL110
          MOVE     SIBT1NXT,KEY8   
          CALL     TSSIBT12
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIBT1SNO
            CALL     TPSIBT12
            ADD      ONE,SECTOR
          DO
          CALL     DPBAL000
          GOTO     PPBAL999
PPBAL115
PPBAL999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NPBAL000
          MATCH    "SIBT1",NAMSSFFI
          GOTO     NPBAL115 IF NOT EQUAL
NPBAL105
          MOVE     SP70,SIBT1NXT
          PACK     KEY5,Z70
          CALL     TSSIBT11
          CALL     TPSIBT11
          MOVE     KEY8,SIBT1NXT
          CALL     TSSIBT12
          CALL     TKSIBT12
          IF       OVRCD=1
            BEEP
            GOTO      NPBAL999
          ENDIF
.
          CALL     CTBAL000
.
. Position and Display Page
.--------------------------
NPBAL110
          MOVE     SIBT1NXT,KEY8   
          CALL     TSSIBT12
          CALL     DPBAL000
          GOTO     NPBAL999
NPBAL115
NPBAL999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CTBAL000
          MATCH    "SIBT1",NAMSSFFI
          GOTO     CTBAL115 IF NOT EQUAL
CTBAL105
          PACK     KEY5,SP1,ONE,SP70
          CALL     TSSIBT11
          CALL     TKSIBT11
          BRANCH   OVRCD,CTBAL110
          CALL     TRSIBT12
          MOVE     SP70,SCTMROW
          MOVE     SP70,SCTMCOL
          CALL     TUSIBT12
          GOTO     CTBAL105
CTBAL110
          GOTO     CTBAL999
CTBAL115
CTBAL999  RETURN
.----------------------------------
. Clear Pages of Multi Items 
.----------------------------------
CPBAL000
          CALL     CTBAL000
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
CPBAL010
          CALL     RKSCPS1
          BRANCH   OVRCD,CPBAL999
          MATCH    PRGID,SCPSPID
          GOTO     CPBAL999 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     CPBAL999 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     CPBAL010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,CPBAL100,CPBAL100,CPBAL100,CPBAL100:
                            CPBAL100,CPBAL010,CPBAL010,CPBAL010:
                            CPBAL010,CPBAL010,CPBAL010,CPBAL010:
                            CPBAL010,CPBAL010,CPBAL010,CPBAL010:
                            CPBAL010,CPBAL010,CPBAL010,CPBAL010:
                            CPBAL010
.
CPBAL100
          PACK     VAR,SP70,SP70
          CALL     DISPITEM  * Display Blank Item
          GOTO     CPBAL010
CPBAL999  RETURN
.---------------------------------------------------------
. Add Items
.---------------------------------------------------------
ADBAL000
          CALL      CPBAL000 * Clear Screen of Items
          PACK      KEY20,PRGID,SCRID,ITMSSFFI,SP70
          CALL      RSSCPS2
ADBAL010  CALL      RKSCPS2
          BRANCH    OVRCD,ADBAL000
          MATCH     PRGID,SCPSPID
          GOTO      ADBAL000 IF NOT EQUAL
          MATCH     SCRID,SCPSSID
          GOTO      ADBAL000 IF NOT EQUAL
          MATCH     ITMSSFFI,SCPSITM
          GOTO      ADBAL000 IF NOT EQUAL
          PACK      SKSCPS20,SCPSPID,SCPSSID,SCPSITM,SCPSROW,SCPSCOL
          MOVE      ACCEPT,SACCEPT
          MOVE      ONE,ACCEPT
          CALL      SMBAL000
          MOVE      SACCEPT,ACCEPT
          MOVE      SKSCPS20,KEY20
          CALL      RDSCPS2
          MATCH     "SIBT1",NAMSSFFI
          IF        @EQUAL
            COMPARE   ZERO,SIBT1AFL
            GOTO      ADBAL010 IF EQUAL
            CALL      FPBAL000
            GOTO      ADBAL999
          ENDIF
ADBAL999
          RETURN
.---------------------------------------------------------
. Delete Items
.---------------------------------------------------------
DLBAL000  
          MOVE      SCSLDES,DISPMSG
          CALL      MESSAGE2
DLBAL005  
          CALL      MDELQ000
          BRANCH    EXIT,DLBAL900,DLBAL900
          MOVE      SCSLITM,FIELDNO
          MATCH     ITMSSFFI,SCSLITM
          GOTO      DLBAL100 IF NOT EQUAL
          CALL      SELECTED
          MATCH     "SIBT1",SCPSMTY
          IF        @EQUAL
            PACK      KEY5,SCSLROW,SCSLCOL
            CALL      TRSIBT11
            IF        OVRCD=0
              CALL      TDSIBT12
            ELSE
              BEEP
              GOTO      DLBAL005
            ENDIF
            PACK      KEY5,SP1,ONE,SP70
            CALL      TSSIBT11
            CALL      TKSIBT11
            MOVE     KEY8,SIBT1NXT
            CALL      CTBAL000
            MOVE      SIBT1NXT,KEY8   
            CALL      TSSIBT12
            CALL      TPSIBT12
            CALL      DPBAL000
            GOTO      DLBAL005
          ENDIF
DLBAL100  MOVE      "Invalid Selection. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      DLBAL005
DLBAL900  CALL      MESSAGE3
          RETURN
.---------------------------------------------------------
. Batch IO for Screen : Backorder Details                  
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     1 Requisition                        
.---------------------------------------------------------
TSSIBT11  RESET     KEY5
          READ      SIBT1FL1,KEY5;;
          RETURN
.
TSSIBT12  RESET     KEY8   
          READ      SIBT1FL2,KEY8;;
          RETURN
.
TASIBT12  RESET     KEY8   
          MOVE      ZERO,OVRCD
          READ      SIBT1FL2,KEY8;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
TDSIBT11  RESET     KEY5
          DELETE    SIBT1FL1,KEY5
          RETURN
.
TDSIBT12  RESET     KEY8
          DELETE    SIBT1FL2,KEY8
          RETURN
.
TKSIBT11  MOVE      ZERO,OVRCD
          READKS    SIBT1FL1;SCTMROW,SCTMCOL,KEY8:
                        SIBTPON,SIBTREQ,SIBTCST,SIBTQTY,SIBTISS:
                        SIBTSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TKSIBT12  MOVE      ZERO,OVRCD
          READKS    SIBT1FL2;SCTMROW,SCTMCOL,KEY8:
                        SIBTPON,SIBTREQ,SIBTCST,SIBTQTY,SIBTISS:
                        SIBTSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPSIBT11  MOVE      ZERO,OVRCD
          READKP    SIBT1FL1;SCTMROW,SCTMCOL,KEY8:
                        SIBTPON,SIBTREQ,SIBTCST,SIBTQTY,SIBTISS:
                        SIBTSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TPSIBT12  MOVE      ZERO,OVRCD
          READKP    SIBT1FL2;SCTMROW,SCTMCOL,KEY8:
                        SIBTPON,SIBTREQ,SIBTCST,SIBTQTY,SIBTISS:
                        SIBTSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRSIBT11  RESET     KEY5
          MOVE      ZERO,OVRCD
          READ      SIBT1FL1,KEY5;SCTMROW,SCTMCOL,KEY8:
                        SIBTPON,SIBTREQ,SIBTCST,SIBTQTY,SIBTISS:
                        SIBTSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TRSIBT12  RESET     KEY8   
          MOVE      ZERO,OVRCD
          READ      SIBT1FL2,KEY8;SCTMROW,SCTMCOL,KEY8:
                        SIBTPON,SIBTREQ,SIBTCST,SIBTQTY,SIBTISS:
                        SIBTSPA                                                 
          GOTO      OVERCOND IF OVER
          RETURN
.
TUSIBT11  UPDATE    SIBT1FL1;SCTMROW,SCTMCOL,KEY8:
                        SIBTPON,SIBTREQ,SIBTCST,SIBTQTY,SIBTISS:
                        SIBTSPA                                                 
          RETURN
.
TUSIBT12
          UPDATE    SIBT1FL2;SCTMROW,SCTMCOL,KEY8:
                        SIBTPON,SIBTREQ,SIBTCST,SIBTQTY,SIBTISS:
                        SIBTSPA                                                 
          RETURN
.
TWSIBT12  RESET     KEY8   
          WRITE     SIBT1FL2,KEY8;SCTMROW,SCTMCOL,KEY8:
                        SIBTPON,SIBTREQ,SIBTCST,SIBTQTY,SIBTISS:
                        SIBTSPA                                                 
          RETURN
.---------------------------------------------------------
. Display Fields for : Backorder Details                  
.---------------------------------------------------------
DFBAL000
          BRANCH   ACCEPT,DFBAL999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DFBAL010
          CALL     RKSCPS1
          BRANCH   OVRCD,DFBAL900
          MATCH    PRGID,SCPSPID
          GOTO     DFBAL900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DFBAL900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DFBAL010 IF NOT EQUAL
.
          CALL     PSBAL000 * Display Field
          GOTO     DFBAL010
DFBAL900
          MOVE      "SIBT1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FPBAL000
DFBAL999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Backorder Details                  
.---------------------------------------------------------
PSBAL000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PSBAL999,PSBAL999,PSBAL999,PSBAL999:
                            PSBAL999,PSBAL999,PSBAL999,PSBAL999:
                            PSBAL999,PSBAL999,PSBAL999,PSBAL101:
                            PSBAL102,PSBAL103,PSBAL104,PSBAL999:
                            PSBAL999,PSBAL999,PSBAL999,PSBAL999:
                            PSBAL999
          GOTO     PSBAL999
.
PSBAL101
          MOVE      TOTALREC,VAR     
          CALL      DISPITEM
          GOTO     PSBAL999
.
PSBAL102
          MOVE      SIIACAT,VAR      
          CALL      DISPITEM
          GOTO     PSBAL999
.
PSBAL103
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PSBAL999
.
PSBAL104
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PSBAL999
PSBAL999
          RETURN
.---------------------------------------------------------
. Selections for : Backorder Details                  
.---------------------------------------------------------
SFBAL000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SFBAL001  BRANCH   ACCEPT,SFBAL020
.
SFBAL005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFBAL101,SFBAL006,SFBAL006,SFBAL006:
                            SFBAL006,SFBAL006,SFBAL006,SFBAL006:
                            SFBAL102,SFBAL006,SFBAL006,SFBAL006:
                            SFBAL006,SFBAL006,SFBAL006,SFBAL103:
                            SFBAL104,SFBAL006,SFBAL006,SFBAL105:
                            SFBAL106
SFBAL006  BEEP
          GOTO     SFBAL005
SFBAL020  CALL     RKSCSL1
          BRANCH   OVRCD,SFBAL090
          MATCH    PRGID,SCSLPID
          GOTO     SFBAL090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SFBAL090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SFBAL101,SFBAL020,SFBAL020,SFBAL020:
                            SFBAL020,SFBAL020,SFBAL020,SFBAL020:
                            SFBAL020,SFBAL020,SFBAL020,SFBAL020:
                            SFBAL020,SFBAL020,SFBAL020,SFBAL020:
                            SFBAL020,SFBAL020,SFBAL020,SFBAL020:
                            SFBAL020
          GOTO     SFBAL020
SFBAL090  MOVE     ZERO,ACCEPT
          MOVE      "SIBT1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FPBAL000
          GOTO     SFBAL001
.
SFBAL101
          CALL      SELECTED
          BRANCH    EXIT,SFBAL001
          MOVE      "SIBT1",NAMSSFFI
          MOVE      SCPSITM,ITMSSFFI
          IF        ACCEPT=0
            PACK      KEY5,SCPSROW,SCPSCOL
            CALL      TRSIBT11
            BRANCH    OVRCD,SFBAL001
            MATCH     SCTMROW,SCSLROW
            GOTO      SFBAL001 IF NOT EQUAL
            MATCH     SCTMCOL,SCSLCOL
            GOTO      SFBAL001 IF NOT EQUAL
            CALL      SMBAL000 * Change Line
          ELSE
            IF        SIBT1AFL=0
              MOVE      "SIBT1",NAMSSFFI
              MOVE     "    1",ITMSSFFI
              CALL      ADBAL000 * Add Line
            ENDIF
          ENDIF
          GOTO     SFBAL001
.
SFBAL102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      BALAN000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SFBAL999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SFBAL001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SFBAL999
          ENDIF
          MOVE      "BA",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DFBAL000
          ENDIF
          GOTO      SFBAL001
.
SFBAL103
          MOVE      "SIBT1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NPBAL000
          GOTO     SFBAL001
.
SFBAL104
          MOVE      "SIBT1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PPBAL000
          GOTO     SFBAL001
.
SFBAL105
          MOVE      "SIBT1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FPBAL000
          GOTO     SFBAL001
.
SFBAL106
          MOVE      "SIBT1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LPBAL000
          GOTO     SFBAL001
SFBAL990  MOVE      ONE,EXIT * Exit Char Restart
SFBAL999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO,*157,SNCOCORP
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            MOVE      ZERO,SNCOCORP
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO,*157,SNCOCORP
          ENDIF
          IF        SNCOCORP=1
            OPEN      CSMCIAA1,"csmciaaf"
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
. ------------------------------------------------------------
. Read Catalog Code Keyin Control Information
.
. INCOCATE  FORM      1         67      Catalog Code Type
. 0 Normal Keyin,   1 *JR *DE,   2 Generated ,  3 Generated with Check Digit
. INCONCAT  FORM      7         68      Next Generated Catalog Number
.------------------------------------------------------------
RINCOCAT  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*67,INCOCATE,INCONCAT
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCOCATE
            MOVE      ZERO,INCONCAT
            WRITAB    CONTROLF,SIXTY3;*67,INCOCATE,INCONCAT
          ENDIF
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,TWENTY3;*120,HBACK
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,HBACK
            WRITAB    CONTROLF,TWENTY3;*120,HBACK
          ENDIF
.
          READ      CONTROLF,SIXTY3;*132,INCOSIN7     * srf 6459
.
          RETURN
.----------------------------------------------------------------------
. Insert a Catalog
.----------------------------------------------------------------------
INSCAT00  BRANCH    SNCOCORP,INSCAT95
          CALL      IMAIN000                * Master Details Insert
          BRANCH    EXIT,INSCAT99,INSCAT99  * Cancel
.
          MOVE      SIIACAT,KEY7            * Lock Catalog
          CALL      RLSIIA1
          BRANCH    OVRCD,INSCAT00,INSCAT00 * Somethings Wrong if not on file
.                                           * or Locked so Restart
          MOVE      ONE,ADDFLAG             * Flag First Supplier. Must Default
          CALL      ISUPP000                * Supplier Details
          BRANCH    EXIT,INSCAT90           * Abort Insert
.
          BRANCH    SIIANON,INSCAT10        * Not Stock
          MOVE      ONE,ADDFLAG             * Flag Insert for Warehouse Details
          CALL      IWARE000                * Warehouse Details
INSCAT10  CALL      UUSIIA1                 * Unlock
          GOTO      INSCAT00                * Next
.
INSCAT90  CALL      DELCAT00                * Abort Delete
          GOTO      INSCAT00                * Next Insert
.
INSCAT95  BEEP
          MOVE      "Corporate Catalog System in Use - ",DISPMSG
          CALL      MESSAGE1
.
INSCAT99  MOVE      ZERO,ADDFLAG            * Clear Add Flag
          RETURN
.------------------------------------------------------------
. Delete a Catalog Code
.------------------------------------------------------------
DELCAT00  MOVE     SIIACAT,KEY7
          CALL     RDSIIA1
          IF       OVRCD=0
            CALL     DESIIA1
          ENDIF
.
          BRANCH   INCOCATE,DELCAT10,DELCAT05,DELCAT05
          GOTO     DELCAT10
.
.------------------------------------------------------------
. Allow Reuse of Generated Catalog Codes if Possible
.------------------------------------------------------------
DELCAT05  READ      CONTROLF,SIXTY3;*67,INCOCATE,INCONCAT
          SUB       ONE,INCONCAT
          IF        INCOCATE=2
            MOVE      SIIACAT,CALFORM7
          ELSE
            MOVE      SIIACAT,KEY6
            MOVE      KEY6,CALFORM7
          ENDIF
          IF        INCONCAT=CALFORM7
            WRITAB    CONTROLF,SIXTY3;*67,INCOCATE,INCONCAT
          ENDIF
.
DELCAT10  PACK     KEY67,SIIACAT,SP70
          CALL     RSSIIF2
          CALL     RKSIIF2
          BRANCH   OVRCD,DELCAT20
          MATCH    SIIFCAT,SIIACAT
          GOTO     DELCAT20 IF NOT EQUAL
          PACK     KEY67,SIIFCAT,SIIFALI
          CALL     DESIIF2
          GOTO     DELCAT10
.
DELCAT20  PACK     KEY10,SIIACAT,SP70
          CALL     RSSIIB1
          CALL     RKSIIB1
          BRANCH   OVRCD,DELCAT30
          MATCH    SIIBCAT,SIIACAT
          GOTO     DELCAT30 IF NOT EQUAL
          PACK     KEY10,SIIBCAT,SIIBLIN
          CALL     DESIIB1
          GOTO     DELCAT20
.                                                                      *I-59698
DELCAT30  PACK     KEY10,SIIACAT,SP70
          CALL     RSSIIJ1
          CALL     RKSIIJ1
          BRANCH   OVRCD,DELCAT99
          MATCH    SIIJCAT,SIIACAT
          GOTO     DELCAT99 IF NOT EQUAL
          PACK     KEY10,SIIJCAT,SIIJLIN
          CALL     DESIIJ1
          GOTO     DELCAT30                                        *end I-59698
.
DELCAT99  RETURN
.----------------------------------------------------------------------
. Insert main details
.----------------------------------------------------------------------
IMAIN000  MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
IMAIN200  MOVE      ONE,ACCEPT
          MOVE      ONE,INSRTCAT
          CALL      CF01L000      * Clear Fields
.
          CALL      ICATA000      * Insert or Generate Catalog Code
          BRANCH    EXIT,IMAIN999,IMAIN999
.
          CALL      WP01L000      * Load any WP Details
          CALL      LM01L000      * Load any Batch Details
          CALL      DF01L000      * Display Fields
          MOVE      ZERO,CANCFLAG
          CALL      SF01L000      * Select Fields
          BRANCH    CANCFLAG,IMAIN900 * Post
          MOVE      ONE,EXIT
          GOTO      IMAIN999
.
IMAIN900  MOVE      ZERO,EXIT
.
IMAIN999  RETURN
.------------------------------------------------------------
. Determine Catalog Code
.------------------------------------------------------------
ICATA000  MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
.
          BRANCH    INCOCATE,ICATA100,ICATA200,ICATA200
.
ICATA100  MOVE      "1",CKEYTYP
          CALL      ECATA000
          BRANCH    EXIT,ICATA900,ICATA900
.
          MOVE      ONE,ACCEPT
          MOVE      SIIACAT,VAR
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          MOVE      SIIACAT,SAVCAT
          GOTO      ICATA999
.
ICATA200  MOVE      ONE,ACCEPT
          MOVE      "Next    ",SIIACAT
          MOVE      "Next    ",VAR
          PACK      SIIADES,EXITCHAR,SP70
          CALL      DISPITEM
          MOVE      ZERO,EXIT
.
          CLEAR     SAVCAT
          APPEND    "Next",SAVCAT
          APPEND    PORT,SAVCAT
          APPEND    SP70,SAVCAT
          RESET     SAVCAT
          GOTO      ICATA999
.
ICATA900  MOVE      ONE,EXIT
ICATA999  RETURN
.
ISUPP000  MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
ISUPP200  MOVE      ONE,ACCEPT
          MOVE      SIIACAT,KEY7
          CALL      CF03L000 * Clear Fields
          CALL      RDSIIA1
.
          CALL      GSUPP000 * Enter Key Fields
          BRANCH    EXIT,ISUPP900,ISUPP900
.
          CALL      WP03L000          * Load any WP Details
          MOVE      ZERO,CANCFLAG
          CALL      SF03L000          * Select Fields
          BRANCH    CANCFLAG,ISUPP800 * Cancel ? Abort Catalog
          MOVE      ZERO,ADDFLAG      * Flag for first supplier in insert
          GOTO      ISUPP000
.
ISUPP800  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          BEEP
          KEYIN     *P1:24,*EL,"Abort Catalog Insert (":
                    *V2LON,"Y",*HOFF,"/":
                    *V2LON,"N",*HOFF,") ? ",*V2LON,ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MATCH     ANSN,ANS
          GOTO      ISUPP000 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      ISUPP800 IF NOT EQUAL
          MOVE      ONE,EXIT
          GOTO      ISUPP999
.
ISUPP900  MOVE      ZERO,EXIT
          PACK      KEY27,SIIACAT,SP70
          CALL      RSSIIC1
          CALL      RKSIIC1
          BRANCH    OVRCD,ISUPP800
          MATCH     SIIACAT,SIICCAT
          GOTO      ISUPP800 IF NOT EQUAL
.
ISUPP999  RETURN
.
IWARE000  MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
IWARE200  MOVE      ONE,ACCEPT
          MOVE      SIIACAT,KEY7
          CALL      RDSIIA1
.
IWARE250  CALL      CLRWAR00 * Clear Fields
          CALL      GWARE000 * Enter Key Fields
          BRANCH    EXIT,IWARE900,IWARE900
.
          CALL      WP05L000 * Load any WP Details
          CALL      SF05L000 * Select Fields
          GOTO      IWARE000
.
IWARE900  PACK      KEY12,SIIACAT,SP70
          CALL      RSSIIE1
          CALL      RKSIIE1
          BRANCH    OVRCD,IWARE950
          MATCH     SIIECAT,SIIACAT
          GOTO      IWARE950 IF NOT EQUAL
          GOTO      IWARE990
.
IWARE950  BEEP
          MOVE      "Stocked Item Must be in at Least One Warehouse. - ",DISPMSG
          CALL      MESSAGE1
          GOTO      IWARE250
.
IWARE990  MOVE      ZERO,EXIT
IWARE999  RETURN
.----------------------------------------------------------------------
. Insert main details
.----------------------------------------------------------------------
MODCAT00  MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
MODCAT20  MOVE      ZERO,INSRTCAT
          CALL      CF01L000      * Clear Fields
.
          CALL      KY01L000      * Insert or Generate Catalog Code
          BRANCH    EXIT,MODCAT99,MODCAT99
          CALL      WP01L000      * Load any WP Details
          CALL      LM01L000      * Load any Batch Details
          CALL      DF01L000      * Display Fields
          CALL      SF01L000      * Select Fields
          GOTO      MODCAT00
.
MODCAT99  RETURN
.
.----------------------------------------------------------------------
. Unlock Catalog
.----------------------------------------------------------------------
UUSIIA00
          CALL      UUSIIA1
          RETURN
DEFAULTN    MOVE     ANSN,DEFYESNO
            RETURN
.----------------------------------------------
. Check for Notes
.----------------------------------------------
NSIIB000  MOVE        SP70,NOTESIIB
          MOVE        ZERO,OVRCD
          TRAP        OVERCOND IF IO
          OPEN        TEMPWORD,FILSIIB1
          TRAPCLR     IO
          BRANCH      OVRCD,NSIIB999
NSIIB100  READ        TEMPWORD,SEQ;SIIBCOM
          GOTO        NSIIB900 IF OVER
          MATCH       SP70,SIIBCOM
          GOTO        NSIIB100 IF EQUAL
          MOVE        "Notes",NOTESIIB
.
NSIIB900  CLOSE       TEMPWORD
NSIIB999  RETURN
.
ECATA000  CALL      UUSIIA1
          CALL      KSIIAA00
          BRANCH    EXIT,ECATA999,ECATA999
.
          COMPARE   ONE,OVRCD
          GOTO      ECATA999 IF EQUAL
.
ECATA100  MOVE      SIIACAT,KEY7
          MOVE      SIIACAT,SAVCAT
          CALL      RLSIIA1
          BRANCH    OVRCD,ECATA999,ECATA200
          MOVE      TWO,AUDTTYPE
          CALL      WASIIA00          * Write Before Audit
.
          MOVE      SIIANON,SAVNON
.
          MOVE      SIIAPSC,KEY5
          CALL      RDAPMA1
.
          MOVE      SIIASUB,KEY5
          CALL      RDSISA1
.
          PACK      IBGSDESC,SP70
          MOVE      SIIAGST,KEY6
          CALL      RDIBGS1
.
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
.
          CLEAR     KEY6
          APPEND    "ia1",KEY6
          APPEND    SIIAUC1,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC1DESC
          ENDIF
.
          CLEAR     KEY6
          APPEND    "ia2",KEY6
          APPEND    SIIAUC2,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC2DESC
          ENDIF
.
          ADD       ONE,SIIASUS
          BRANCH    SIIASUS,ECATA110,ECATA120,ECATA130,ECATA140
ECATA110  MOVE      "Not Suspend               ",SUSPDESC
          GOTO      ECATA190
ECATA120  MOVE      "Requisitions              ",SUSPDESC
          GOTO      ECATA190
ECATA130  MOVE      "Suspend P/O              ",SUSPDESC
          GOTO      ECATA190
ECATA140  MOVE      "Suspend P/O & Requisition",SUSPDESC
          GOTO      ECATA190
ECATA190  SUB       ONE,SIIASUS
.
          MOVE      ZERO,EXIT
          MOVE      ZERO,OVRCD
          GOTO      ECATA999
.
ECATA200  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          KEYIN     *P1:24,*EL,"Record Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MATCH     ANSR,ANS
          GOTO      ECATA100 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      ECATA000 IF EQUAL
          MATCH     ANSE,ANS
          GOTO      ECATA200 IF NOT EQUAL
          GOTO      ECATA000
.
ECATA999  RETURN
.--------------------------------------------------
. Enter Issue Unit
.--------------------------------------------------
EIUNT000  IF        SNCOCORP=1
            BEEP
            MOVE      "Corporate Catalog in Use - ",DISPMSG
            CALL      MESSAGE1
            GOTO      EIUNT999
          ENDIF
          IF        ACCEPT<>1
            CALL      CHKISS00   * Not in Insert Mode so Check History
            BRANCH    EXIT,EIUNT900
          ENDIF
          MOVE      SP70,SIFASUPP
          MOVE      ZERO,CKEYTYP
          CALL      KSIFAA00
          BRANCH    EXIT,EIUNT999,EIUNT999
          MOVE      SIFAISSU,SIIAISS
.
EIUNT900  MOVE      ZERO,EXIT
.
EIUNT999  RETURN
.--------------------------------------------------
. Check for Activity on Catalog Code
.--------------------------------------------------
CHKISS00  PACK      KEY25,SIIACAT,SP70
          MOVE      ZERO,EXIT
          CALL      RSSIPC6
CHKISS10  CALL      RKSIPC6
          BRANCH    EXIT,CHKISS99
          MATCH     SIPCCAT,SIIACAT
          GOTO      CHKISS99 IF NOT EQUAL
          PACK      KEY7,SIPCPON,SP70
          CALL      RDSIPA1
          BRANCH    OVRCD,CHKISS10
          MATCH     SIPADCN,SP70
          GOTO      CHKISS10 IF NOT EQUAL
.
          MOVE      SP70,ANS
          PACK      DISPMSG,SP70,SP70
          RESET     DISPMSG
          APPEND    "Catalog already used. ",DISPMSG
          APPEND    "Cannot Change Issue Unit. ",DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      ONE,EXIT
          MATCH     "*",ANS
          IF        @EQUAL
            MOVE      ZERO,EXIT
          ENDIF
.
CHKISS99  RETURN
.
ESTI0000  MOVE      SP70,DISPMSG
          CALL      DCODE000
          CLEAR     SIIASTI
          MOVE      CCOL,F2
          MOVE      ZERO,CLNO
ESTI1000  KEYIN     *PF2:CVERT,*V2LON,*DE,*+,ANS
          RESET     ANS
          GOTO      ESTI2000 IF EOS
          MATCH     "0",ANS
          GOTO      ESTI1100 IF EQUAL
          MATCH     "1",ANS
          GOTO      ESTI1100 IF EQUAL
          BEEP
          GOTO      ESTI1000
.
ESTI1100  ADD       ONE,F2
          ADD       ONE,CLNO
          APPEND    ANS,SIIASTI
          COMPARE   SIX,CLNO
          GOTO      ESTI1000 IF LESS
.
ESTI2000  APPEND    "000000",SIIASTI
          RESET     SIIASTI
          DISPLAY   *PCCOL:CVERT,*V2LON,SIIASTI
          CALL      PUTSCR00
          RETURN
.
DCODE000  MOVE      "15",HTOP
          MOVE      "44",HLEF
          MOVE      "24",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
          DISPLAY   *P52:16,*V2LON,*ULON,"Sequence Descriptions"
          MOVE      ONE,F1
DCODE100  PACK      KEY6,ANSC,ANSA,ANST,F1,SP70
          CALL      RDSICD1
          IF        OVRCD=1
            MOVE      "No Description on Code",SICDDESC
          ENDIF
          ASSIGN    F1+16,F2
          DISPLAY   *P46:F2,*V2LON,F1,". ",*HOFF,SICDDESC
          ADD       ONE,F1
          COMPARE   SEVEN,F1
          GOTO      DCODE100 IF NOT EQUAL
          DISPLAY   *P46:23,"Enter ",*V2LON,"1",*HOFF," to Include"
          RETURN
.----------------------------------------------------------------------
. Enter Nato Code
.----------------------------------------------------------------------
ENATO000  BRANCH    ACCEPT,ENATO800  * Insert Mode
.
          MOVE      SIIANAT,NATOCODE
          MOVE      SP70,SIIANAT
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,NATOCODE
          PACK      NATOCODE,NATOCODE,SP70
.
          IF        INCNNATO=1
            MATCH     NATOCODE,SP70
            IF        @EQUAL
              GOTO      ENATO900
            ENDIF
            MATCH     NATOCODE,EXITCHAR
            IF        @EQUAL
              MOVE      TWO,EXIT
              GOTO      ENATO999
            ENDIF
.
            PACK      KEY17,NATOCODE,SP70
            CALL      RSSINA2                  * Does it exist
            CALL      RKSINA2                  * Does it exist
            MATCH     NATOCODE,SINANAT
            IF        OVRCD=0 & @EQUAL
              MOVE      "Nato Code already exists.  ",DISPMSG
              CALL      MESSAGE1
              GOTO      ENATO000
            ENDIF
            UNPACK    NATOCODE,KEY7,KEY3
            MATCH     KEY3,SP3
            IF        @EQUAL
              CALL      RASIIA1
              IF        OVRCD=0
                MOVE      "Code exists as a Catalog Code - ",DISPMSG
                CALL      MESSAGE1
                GOTO      ENATO000
              ENDIF
            ENDIF
          ENDIF
          GOTO      ENATO900
.
ENATO800  MOVE      SP70,NATOCODE
.
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,NATOCODE
          ENDSET    NATOCODE
          APPEND    SP70,NATOCODE
          RESET     NATOCODE
.
          IF        INCNNATO=1
            MATCH     NATOCODE,SP70
            IF        @EQUAL
              GOTO      ENATO900
            ENDIF
.
            MATCH     NATOCODE,EXITCHAR
            IF        @EQUAL
              MOVE      TWO,EXIT
              GOTO      ENATO999
            ENDIF
.
            PACK      KEY17,NATOCODE,SP70
            CALL      RSSINA2                  * Does it exist
            CALL      RKSINA2                  * Does it exist
            MATCH     NATOCODE,SINANAT
            IF        OVRCD=0 & @EQUAL
              MOVE      "Nato Code already exists.  ",DISPMSG
              CALL      MESSAGE1
              GOTO      ENATO000
            ENDIF
            UNPACK    NATOCODE,KEY7,KEY3
            MATCH     KEY3,SP3
            IF        @EQUAL
              CALL      RASIIA1
              IF        OVRCD=0
                MOVE      "Code exists as a Catalog Code - ",DISPMSG
                CALL      MESSAGE1
                GOTO      ENATO000
              ENDIF
            ENDIF
          ENDIF
.
ENATO900  MOVE      NATOCODE,SIIANAT
          MOVE      ZERO,EXIT
.
ENATO999  RETURN
EABC0000  KEYIN     *PCCOL:CVERT,*V2LON,*RV,SIIAABC
          REP       UPPLOW,SIIAABC
          MATCH     ANSA,SIIAABC
          GOTO      EABC9999 IF EQUAL
          MATCH     ANSB,SIIAABC
          GOTO      EABC9999 IF EQUAL
          MATCH     ANSC,SIIAABC
          GOTO      EABC9999 IF EQUAL
          BEEP
          GOTO      EABC0000
EABC9999  RETURN
.------------------------------------------------------------
. Enter Preffered Supplier Code
.------------------------------------------------------------
EPSUP000
.          IF        SNCOCORP=1
.            BEEP
.            MOVE      "Corporate Catalog in Use - ",DISPMSG
.            CALL      MESSAGE1
.            MOVE      SIIAPSC,KEY5
.            CALL      RDAPMA1
.            GOTO      EPSUP999
.          ENDIF
.
          CALL      KAPMAA000
          MOVE      APMACRD,SIIAPSC
          BRANCH    EXIT,EPSUP999,EPSUP999
          BRANCH    ACCEPT,EPSUP999
          PACK      KEY27,SIIACAT,SIIAPSC,SP70
          CALL      RSSIIC1
          CALL      RKSIIC1
          BRANCH    OVRCD,EPSUP100
.
          MATCH     SIIACAT,SIICCAT
          GOTO      EPSUP100 IF NOT EQUAL
          MATCH     SIIAPSC,SIICSUP
          GOTO      EPSUP999 IF EQUAL
.
EPSUP100  MOVE      "Warning Supplier is not Attached to this Catalog. ",DISPMSG
          CALL      MESSAGE1
.
EPSUP999  RETURN
ESNON000  CALL      CSIWS000                * check warehouse security
.
          BRANCH    ACCEPT,ESNON100
          PACK      KEY12,SIIACAT,SP70
          CALL      RSSIIE1
          CALL      RKSIIE1
          BRANCH    OVRCD,ESNON100
          MATCH     SIIACAT,SIIECAT
          GOTO      ESNON100 IF NOT EQUAL
.
          CLEAR     DISPMSG
          APPEND    "Catalog in Warehouse : ",DISPMSG
          APPEND    SIIEWAR,DISPMSG
          RESET     DISPMSG
          BEEP
          CALL      MESSAGE1
          GOTO      ESNON999
.
ESNON100  MOVE      ANSY,DEFYESNO
          CALL      YORN0000
          IF        FYESNO=0
            MOVE      "1",SIIANON  * No Non Stock
          ELSE
            COMPARE   ZERO,SECSIWS
            IF        @EQUAL
              CLEAR     DISPMSG
              APPEND    "You have no Warehouse access, ",DISPMSG
              APPEND    "Stock is not allowed - ",DISPMSG
              CALL      MESSAGE1
              GOTO      ESNON000
            ENDIF
            MOVE      "0",SIIANON  * Yes Stocked
          ENDIF
          CALL      WARN0000
          IF        EXIT=1
            MOVE      SAVNON,SIIANON
          ENDIF
.
ESNON999  RETURN
.----------------------------------------------------------------------
. Warn if Stock to Non-Stock Changed and in modify mode
.----------------------------------------------------------------------
WARN0000  BRANCH    ACCEPT,WARN9999
.
          IF        SAVNON=SIIANON
            GOTO      WARN9999
          ENDIF
.
          MOVE      "0",HLEF
          CALL      GETSCR00
          IF        SIIANON=1
            CALL      CHSTK000
          ELSE
            CALL      CHOPO000
          ENDIF
          CALL      PUTSCR00
.
WARN9999  RETURN
.----------------------------------------------------------------------
. Check for Outstanding Reqs, BO Reqs or POs
.----------------------------------------------------------------------
CHSTK000  CALL      CHSTT000           * Check if on stocktake
          BRANCH    EXIT,CHSTK999
.
          MATCH     "1",INCOSIN7       * srf 6459
          GOTO      CHSTK010 IF EQUAL
.
          CALL      CHIMP000           * Check if on Imprest
          BRANCH    EXIT,CHSTK999
.
CHSTK010  CALL      CHPRQ000           * Check Outstanding Requisitions
          BRANCH    EXIT,CHSTK999
.
          CALL      CHOPO000           * Check for Outstanding POs
          BRANCH    EXIT,CHSTK999
.
          CALL      CHOBO000           * Check Outstanding BOs
          BRANCH    EXIT,CHSTK999
.
CHSTK999  RETURN
.----------------------------------------------------------------------
. Check if on stock take
.----------------------------------------------------------------------
CHSTT000  MOVE      ZERO,EXIT
.
          PACK      KEY12,SIIACAT,SP70
          CALL      RSSIIE1
.
CHSTT100  CALL      RKSIIE1
          BRANCH    OVRCD,CHSTT999
.
          MATCH     SIIECAT,SIIACAT
          GOTO      CHSTT999 IF NOT EQUAL
.
          PACK      KEY12,SIIECAT,SIIEWAR,SP70
          CALL      SISIWK1            * check if stocktake file exists
          IF        OVRCD=0
            CLOSE     SINWRKA1
            CLEAR     DISPMSG
            APPEND    "Stocktake in Progress for Warehouse - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
            GOTO      CHSTT999
          ELSE
            GOTO      CHSTT100
          ENDIF
.
CHSTT999  RETURN
.----------------------------------------------------------------------
. Check for Outstanding POs
.----------------------------------------------------------------------
CHOPO000  MOVE      ZERO,EXIT
          MOVE      "Checking for Outstanding Purchase Orders.",DISPMSG
          CALL      MESG0000
          CALL      SVCIA000            * Save sincia variables
.
          PACK      KEY21,SIIACAT,SP70
          CALL      RSSIPC3
CHOPO100  CALL      RKSIPC3
          BRANCH    OVRCD,CHOPO999
.
          MATCH     SIPCCAT,SIIACAT
          GOTO      CHOPO999 IF NOT EQUAL
.
          PACK      KEY7,SIPCPON
          CALL      RDSIPA1
          MATCH     SIPADCN,SP70
          GOTO      CHOPO100 IF NOT EQUAL
.
          MOVE      ONE,SIFACTOR
          MATCH     SIPCCAT,SP70
          IF        !@EQUAL
            PACK      KEY7,SIPCCAT
            CALL      RDSIIA1
            IF        OVRCD=0
              PACK      KEY30,SIIAISS,SIPCSUT
              CALL      RDSIFA1
            ENDIF
          ENDIF
.
          COMPARE   ZERO,SIPCOQT
          GOTO      CHOPO100 IF EQUAL
.
          IF        SIPCOQT > (SIPCRQT/SIFACTOR)
            CLEAR     DISPMSG
            APPEND    "Outstanding Purchase Orders ",DISPMSG
            APPEND    SIPCPON,DISPMSG
            APPEND    " exist for Catalog - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
            GOTO      CHOPO999
          ENDIF
          GOTO      CHOPO100
.
CHOPO999  PACK      KEY7,SIIACAT
          CALL      RLSIIA1
          CALL      RECIA000            * Save sincia variables
          RETURN
.----------------------------------------------------------------------
. Check if on Imprest
.----------------------------------------------------------------------
CHIMP000  MOVE      ZERO,EXIT
          MOVE      "Checking if Catalog is on Imprest.",DISPMSG
          CALL      MESG0000
.
          PACK      KEY12,SIIACAT,SP70
          CALL      RSSIIM2
          CALL      RKSIIM2
          BRANCH    OVRCD,CHIMP999
.
          MATCH     SIIMCAT,SIIACAT
          IF        @EQUAL
            CLEAR     DISPMSG
            APPEND    "Catalog is on Imprest: ",DISPMSG
            APPEND    SIIMCST,DISPMSG
            APPEND    " - ",DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
          ENDIF
.
CHIMP999  RETURN
.----------------------------------------------------------------------
. Check for Outstanding Requisitions
.----------------------------------------------------------------------
CHPRQ000  MOVE      ZERO,EXIT
          MOVE      "Checking for Outstanding Requisitions.",DISPMSG
          CALL      MESG0000
          PACK      KEY83,SIIACAT,SP70,SP20
          CALL      RSSIPR2
CHPRQ100  CALL      RKSIPR2
          BRANCH    OVRCD,CHPRQ999
.
          MATCH     SIIACAT,SIPRCAT
          IF        @EQUAL
            MOVE      "Outstanding Requisitions not Picked exist - ",DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
          ENDIF
.
CHPRQ999  RETURN
.----------------------------------------------------------------------
. Check if Outstanding on Backorder
.----------------------------------------------------------------------
CHOBO000  MOVE      ZERO,EXIT
          MOVE      "Checking if Catalog is on Backorder.",DISPMSG
          CALL      MESG0000
.
          PACK      KEY25,SIIACAT,SP70
          CALL      RSSIBA3
          CALL      RKSIBA3
          BRANCH    OVRCD,CHOBO999
.
          MATCH     SIBACAT,SIIACAT
          IF        @EQUAL
            CLEAR     DISPMSG
            APPEND    "Catalog on Backorder 'C/R/W':",DISPMSG
            APPEND    "'",DISPMSG
            APPEND    SIBACST,DISPMSG
            APPEND    SLASH,DISPMSG
            APPEND    SIBAREQ,DISPMSG
            APPEND    SLASH,DISPMSG
            APPEND    SIBAWAR,DISPMSG
            APPEND    "' - ",DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
          ENDIF
.
CHOBO999  RETURN
.----------------------------------------------------------------------
. Display Message for each Check
.----------------------------------------------------------------------
MESG0000
          RESET     DISPMSG
          STRIP     DISPMSG
          ENDSET    DISPMSG
          DISPLAY   *P1:24,*EL,DISPMSG
.
MESG9999  RETURN
.----------------------------------------------------------------------
. Save SINCIA variables
.----------------------------------------------------------------------
SVCIA000
          MOVE      SIIADES,SSIIADES
          MOVE      SIIASUB,SSIIASUB
          MOVE      SIIAISS,SSIIAISS
          MOVE      SIIASTI,SSIIASTI
          MOVE      SIIAAVC,SSIIAAVC
          MOVE      SIIANAT,SSIIANAT
          MOVE      SIIAABC,SSIIAABC
          MOVE      SIIAPSC,SSIIAPSC
          MOVE      SIIAREX,SSIIAREX
          MOVE      SIIANON,SSIIANON
          MOVE      SIIASAB,SSIIASAB
          MOVE      SIIASUS,SSIIASUS
          MOVE      SIIADUN,SSIIADUN
          MOVE      SIIAGST,SSIIAGST
.
SVCIA999  RETURN
.----------------------------------------------------------------------
. Restore SINCIA variables
.----------------------------------------------------------------------
RECIA000
          MOVE      SSIIADES,SIIADES
          MOVE      SSIIASUB,SIIASUB
          MOVE      SSIIAISS,SIIAISS
          MOVE      SSIIASTI,SIIASTI
          MOVE      SSIIAAVC,SIIAAVC
          MOVE      SSIIANAT,SIIANAT
          MOVE      SSIIAABC,SIIAABC
          MOVE      SSIIAPSC,SIIAPSC
          MOVE      SSIIAREX,SIIAREX
          MOVE      SSIIANON,SIIANON
          MOVE      SSIIASAB,SIIASAB
          MOVE      SSIIASUS,SIIASUS
          MOVE      SSIIADUN,SIIADUN
          MOVE      SSIIAGST,SIIAGST
.
RECIA999  RETURN
.----------------------------------------------------------------------
. Check warehouse security
. Returns SECSIWS : 0 = no access to any warehouse
.                   1 = access to one warehouse
.                   2 = access to more than one warehouse
.                   3 = access to all warehouse(Not Applicable - for future use)
.----------------------------------------------------------------------
..                                            * (for future use)
..CSIWS000  MOVE      "3",SECSIWS             * default to all warehouse's
.
..          PACK      KEY9,SP70               * any security set up ???
..          CALL      RSSIWS1
..          CALL      RKSIWS1
..          BRANCH    OVRCD,CSIWS999
.
CSIWS000  MOVE      "0",SECSIWS             * check for no warehouse's
          PACK      KEY9,PASSCODE,SP70
          CALL      RSSIWS1
          CALL      RKSIWS1
          BRANCH    OVRCD,CSIWS999
.
          MATCH     SIWSUID,PASSCODE
          GOTO      CSIWS999 IF NOT EQUAL
.
          MOVE      "1",SECSIWS             * check for one warehouse's
          CALL      RKSIWS1
          BRANCH    OVRCD,CSIWS999
.
          MATCH     SIWSUID,PASSCODE
          GOTO      CSIWS999 IF NOT EQUAL
.
          MOVE      "2",SECSIWS             * more than one warehouse
.
CSIWS999  RETURN
.------------------------------------------------------------
. Enter Suspension Indicator
.------------------------------------------------------------
ESUS0000  MOVE      ZERO,SIIASUS
          IF        SNCOCORP=1
            CALL      CORPSU00     * Check Corporate Suspension
            BRANCH    EXIT,ESUS9999
          ENDIF
          MOVE      SP70,DISPMSG
          CALL      MESSAGE2
.
ESUS1000  DISPLAY   *P1:24,*EL:
                    *V2LON,"0",*HOFF," = Not Suspend  ":
                    *V2LON,"1",*HOFF," = Requisitions  ":
                    *V2LON,"2",*HOFF," = Suspend P/O  ":
                    *V2LON,"3",*HOFF," = Suspend P/O & Requisit."
.
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,SIIASUS
          ADD       ONE,SIIASUS
          BRANCH    SIIASUS,ESUS2100,ESUS2200,ESUS2300,ESUS2400
          BEEP
          GOTO      ESUS1000
.
ESUS2100  MOVE      "Not Suspend               ",SUSPDESC
          GOTO      ESUS3000
ESUS2200  MOVE      "Requisitions              ",SUSPDESC
          GOTO      ESUS3000
ESUS2300  MOVE      "Suspend P/O              ",SUSPDESC
          GOTO      ESUS3000
ESUS2400  MOVE      "Suspend P/O & Requisition",SUSPDESC
          GOTO      ESUS3000
ESUS3000  SUB       ONE,SIIASUS
          CALL      MESSAGE3
ESUS9999  RETURN
.
CORPSU00  MOVE      ZERO,EXIT
          PACK      KEY7,SIIACAT
          CALL      RDCSIA1
          BRANCH    OVRCD,CORPSU99
          COMPARE   ZERO,CSIASUS
          GOTO      CORPSU99 IF EQUAL
          BEEP
          MOVE      "Corporate Suspension in Place - ",DISPMSG
          CALL      MESSAGE1
          MOVE      ONE,EXIT
CORPSU99  RETURN
.

.----------------------------------------------
. Enter Code
.----------------------------------------------
EUDC1000  MOVE        ZERO,CKEYTYP
          MOVE        "ia1",SICDCATA
          MOVE        SP70,UDC1DESC
          CALL        KSICDB00
          BRANCH      EXIT,EUDC1999,EUDC1999
          MOVE        SICDCODE,SIIAUC1
          MOVE        SICDDESC,UDC1DESC
.
EUDC1999  RETURN
.
.----------------------------------------------
. Enter Code
.----------------------------------------------
EUDC2000  MOVE        ZERO,CKEYTYP
          MOVE        "ia2",SICDCATA
          MOVE        SP70,UDC2DESC
          CALL        KSICDB00
          BRANCH      EXIT,EUDC2999,EUDC2999
          MOVE        SICDCODE,SIIAUC2
          MOVE        SICDDESC,UDC2DESC
.
EUDC2999  RETURN
.
CAN10000  PACK     KEY7,SIIACAT
          CALL     RASIIA1
          IF       OVRCD=0
            CALL     DASIIA00                 * Delete Before Audit
            CALL     UUSIIA1                  * Unlock
          ELSE
            CALL     DALI0000                 * delete any save aliases
          ENDIF
          RETURN
.
.---- delete any saved aliases ----
.
DALI0000  PACK     KEY67,SAVCAT,SP70
.
DALI1000  CALL     RSSIIF2
          CALL     RKSIIF2
          BRANCH   OVRCD,DALI9999
          PACK     KEY67,SIIFCAT,SIIFALI,SP70
          MATCH    KEY67,SAVCAT
          GOTO     DALI9999 IF NOT EQUAL
.
          CALL     DESIIF2
          GOTO     DALI1000
.
DALI9999  RETURN
POS10000  MOVE     ONE,CANCFLAG
          MATCH    "Next   ",SIIACAT
          GOTO     POS10100 IF NOT EQUAL
.
POS10010  READ      CONTROLF,SIXTY3;*68,INCONCAT
          ADD       ONE,INCONCAT
          WRITAB    CONTROLF,SIXTY3;*68,INCONCAT
          SUB       ONE,INCONCAT
.
          COMPARE   TWO,INCOCATE
          GOTO      POS10050 IF EQUAL
.
          ASSIGN    (INCONCAT%13)*13,FORM1
          PACK      KEY8,INCONCAT,FORM1
          UNPACK    KEY8,KEY1,KEY7
          MOVE      KEY7,INCONCAT
.
POS10050  MOVE     INCONCAT,KEY7
          MOVE     INCONCAT,SIIACAT
          CALL     RASIIA1
          COMPARE  ZERO,OVRCD
          GOTO     POS10010 IF EQUAL
.
          PACK     KEY67,SAVCAT,SP70
.
POS10060  CALL     RSSIIF2
          CALL     RKSIIF2
          BRANCH   OVRCD,POS10100
          PACK     KEY67,SIIFCAT,SIIFALI,SP70
          MATCH    KEY67,SAVCAT
          GOTO     POS10100 IF NOT EQUAL
.
          CALL     DESIIF2
          PACK     KEY67,SIIACAT,SIIFALI,SP70
          UNPACK   KEY67,SIIFCAT,SIIFALI
          CALL     RASIIF2
          IF       OVRCD=1
            CALL     WRSIIF2
          ENDIF
.
          PACK     KEY67,SAVCAT,SP70
          GOTO     POS10060
.
POS10100  PACK     KEY7,SIIACAT
          CLOCK    TIME,CTIMEIS
          PACK     SIIADTC,CCC,CYY,CMM,CDD
          REP      " 0",SIIADTC
          MOVE     CTIMEIS,SIIATMC
          MOVE     PASSCODE,SIIAUSC
POS10150  CALL     RASIIA1
          BRANCH   OVRCD,POS10200
.
          BRANCH   INSRTCAT,POS10160
.
          CALL     UPSIIA1
          MOVE     THREE,AUDTTYPE
          MOVE     FALSE,INSCAT
          CALL     WASIIA00
          CALL     UUSIIA1
          GOTO     POS10300
.
POS10160  MOVE     "Catalog has been posted by someone else - ",DISPMSG
          BEEP
          CALL     MESSAGE1
.
          DISPLAY  *P1:24,"Enter New Catalog Code : ";
          MOVE     TWENTY6,CCOL
          MOVE     TWENTY4,CVERT
          MOVE     "1",CKEYTYP
          CALL     KSIIAA00
          BRANCH   EXIT,POS19900,POS19900
.
          MOVE     SIIACAT,VAR
          CALL     DISPITEM
          MOVE     SIIACAT,KEY7
.
POS10200  CALL     WRSIIA1
          MOVE     TRUE,INSCAT
          MOVE     ONE,AUDTTYPE
          CALL     WASIIA00                 * Audit Add
          PACK     SIICPD1,SP70
          PACK     SIICPD2,SP70
          PACK     SIICPNO,SP70
          MOVE     SIIACAT,SAVCAT
.
POS10300  CALL      PALIA000                  * Post Alias
.
          PACK      KEY10,SIIACAT,SP70
          CALL      RSSIIB1
POS11000  CALL      RKSIIB1
          BRANCH    OVRCD,POS11900
          MATCH     SIIBCAT,SIIACAT
          GOTO      POS11900 IF NOT EQUAL
          PACK      KEY10,SIIBCAT,SIIBLIN
          CALL      DESIIB1
          GOTO      POS11000
.
POS11900  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIIB1
          TRAPCLR   IO
          BRANCH    OVRCD,POS13000                                     *C-59698
          MOVE      ZERO,F3
.
POS12000  READ      TEMPWORD,SEQ;SIIBCOM
          GOTO      POS13000 IF OVER                                   *C-59698
.
          MOVE      F3,SIIBLIN
          PACK      KEY10,SIIACAT,SIIBLIN
          UNPACK    KEY10,SIIBCAT,SIIBLIN
          CALL      WRSIIB1
          ADD       ONE,F3
          GOTO      POS12000
.
POS13000  PACK      KEY10,SIIACAT,SP70                                 *I-59698
          CALL      RSSIIJ1
POS13100  CALL      RKSIIJ1
          BRANCH    OVRCD,POS13900
          MATCH     SIIJCAT,SIIACAT
          GOTO      POS13900 IF NOT EQUAL
          PACK      KEY10,SIIJCAT,SIIJLIN
          CALL      DESIIJ1
          GOTO      POS13100
.
POS13900  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIIJ1
          TRAPCLR   IO
          BRANCH    OVRCD,POS19000
          MOVE      ZERO,F3
.
POS14000  READ      TEMPWORD,SEQ;SIIJCOM
          GOTO      POS19000 IF OVER
.
          MOVE      F3,SIIJLIN
          PACK      KEY10,SIIACAT,SIIJLIN
          UNPACK    KEY10,SIIJCAT,SIIJLIN
          CALL      WRSIIJ1
          ADD       ONE,F3
          GOTO      POS14000                                       *end I-59698
.
POS19000  CALL      CKISS000           * check issue unit
          CALL      CKISW000           * check warehouse
.
POS19500  MOVE      ZERO,EXIT
          GOTO      POS19999
.
POS19900  MOVE      ONE,EXIT
.
POS19999  RETURN
.------------------------------------------------------------
. Check issue unit
.------------------------------------------------------------
CKISS000
          PACK      KEY27,SIIACAT,SP70
          CALL      RSSIIC1
.
CKISS100
          CALL      RKSIIC1            * loop through all linked supply units
          BRANCH    OVRCD,CKISS999
          MATCH     SIIACAT,SIICCAT
          GOTO      CKISS999 IF NOT EQUAL
.
          PACK      KEY30,SIIAISS,SIICSUT,SP70
          UNPACK    KEY30,SIFAISSU,SIFASUPP
          CALL      RDSIFA1            * check if factor exists
          IF        OVRCD=1
            PACK      DISPMSG,SP70,SP70
            CALL      MESSAGE2
            REPEAT
              MOVE      ONE,SIFACTOR
              KEYIN     *P1:24,"Factor Missing For ":
                        *V2LON,*DV,SIIAISS,*DV,SLASH,*DV,SIICSUT,*HOFF:
                        ". Enter Factor : ",*V2LON,*RV,SIFACTOR;
            UNTIL     SIFACTOR>0
            CALL      MESSAGE3
.
            CALL     WRSIFA1
            MOVE     ONE,AUDTTYPE
            CALL     WASIFA00
.
            PACK     KEY15,SIFASUPP              * Blank Record for Issue Unit
            PACK     KEY30,SIFAISSU,SP70
            UNPACK   KEY30,SIFAISSU,SIFASUPP
            CALL     RASIFA1
            IF       OVRCD=1
              MOVE     ONE,SIFACTOR
              CALL     WRSIFA1
            ENDIF
.
            PACK     KEY30,SP10,SP5,KEY15        * Blank Record for Supply Unit
            UNPACK   KEY30,SIFAISSU,SIFASUPP
            CALL     RASIFA1
            IF       OVRCD=1
              MOVE     ONE,SIFACTOR
              CALL     WRSIFA1
            ENDIF
          ENDIF
          GOTO      CKISS100
.
CKISS999  RETURN
.------------------------------------------------------------
. Check if set up in warehouse if a stock item
.------------------------------------------------------------
CKISW000  BRANCH    INSCAT,CKISW999    * if yes = insert mode
          BRANCH    SIIANON,CKISW999   * if yes = non-stock item
.
          PACK      KEY12,SIIACAT,SP70
          CALL      RSSIIE1
          CALL      RKSIIE1            * loop through all linked supply units
          BRANCH    OVRCD,CKISW900
          MATCH     SIIACAT,SIIECAT
          GOTO      CKISW900 IF NOT EQUAL
          GOTO      CKISW999
.
CKISW900  MOVE      ONE,ADDFLAG
          CALL      IWARE000
.
CKISW999  RETURN
.------------------------------------------------------------
. Post Alias
.------------------------------------------------------------
PALIA000  PACK      KEY67,SIIACAT,SP70
          CALL      RSSIIF2
.
PALIA100  CALL      RKSIIF2
          BRANCH    OVRCD,PALIA200
          MATCH     SIIFCAT,SIIACAT
          GOTO      PALIA200 IF NOT EQUAL
          COMPARE   ZERO,SIIFATY
          GOTO      PALIA100 IF EQUAL
          PACK      KEY67,SIIFCAT,SIIFALI
          CALL      DESIIF2
          GOTO      PALIA100
.
PALIA200
          MOVE      SIIACAT,SIIFCAT
          MOVE      SIIADES,SIIFALI
          MOVE      ONE,SIIFATY
          CALL      POSTALIA
.
          PACK      KEY27,SIIACAT,SP70
          CALL      RSSIIC1
PALIA300  CALL      RKSIIC1
          BRANCH    OVRCD,PALIA400
          MATCH     SIICCAT,SIIACAT
          GOTO      PALIA400 IF NOT EQUAL
.
          PACK      SIIFALI,SIICPD1,SP70
          MOVE      SIIACAT,SIIFCAT
          MOVE      TWO,SIIFATY
          CALL      POSTALIA
.
          PACK      SIIFALI,SIICPD2,SP70
          MOVE      SIIACAT,SIIFCAT
          MOVE      TWO,SIIFATY
          CALL      POSTALIA
.
          PACK      SIIFALI,SIICPNO,SP70
          MOVE      SIIACAT,SIIFCAT
          MOVE      THREE,SIIFATY
          CALL      POSTALIA
          GOTO      PALIA300
PALIA400  PROC      WRKCT000            * Update Keyword Index
          RETURN
.
POSTALIA  MATCH     SP70,SIIFALI
          RETURN    IF EQUAL
          PACK      KEY67,SIIFCAT,SIIFALI
          CALL      RASIIF2
          IF        OVRCD=1
            CALL      WRSIIF2
          ENDIF
          RETURN
.----------------------------------------------------------------------
. Keyin Dispensing Units
.----------------------------------------------------------------------
KDISP000  MOVE      ZERO,EXIT
          OPEN      CONTROLF,"controlf"
          READ      CONTROLF,TWENTY3;*157,HPHARM
          IF        HPHARM<>1
            BRANCH    ACCEPT,KDISP999,KDISP999
            MOVE      "Pharmacy is not switched on  -  ",DISPMSG
            CALL      MESSAGE1
            GOTO      KDISP999
          ENDIF
.
          OPEN      PHAPLUA1,"phapluaf"
.
          IF        CKEYTYP=1 | CKEYTYP=2
            MOVE      SP70,SIIADUN
          ENDIF
.
          CALL      KPHPLA00
          BRANCH    EXIT,KDISP999,KDISP999
.
          MOVE      PLDISP,SIIADUN
.
KDISP999  RETURN
SUPDET00
          PACK      KEY5,SIICSUP
          CALL      RDAPMA1
          PACK      KEY30,SIIAISS,SIICSUT
          CALL      RDSIFA1
          ASSIGN    SIICCCT/SIFACTOR,ISSCCOST
          ASSIGN    SIICLCT/SIFACTOR,ISSLCOST
.
          RETURN
ECATB000
          CALL      UUSIIA1
          MOVE      ZERO,CKEYTYP
          CALL      KSIIAA00
          BRANCH    EXIT,ECATB999,ECATB999
          MATCH     "04",SCRID
          GOTO      ECATB100 IF NOT EQUAL
          IF         SIIANON=1
            MOVE       "Catalog Not Stocked - ",DISPMSG
            CALL       MESSAGE1
            GOTO       ECATB000
          ENDIF
.
ECATB100  MOVE      SIIACAT,KEY5
          CALL      RLSIIA1
          BRANCH    OVRCD,ECATB999,ECATB200
.
          MOVE      SIIAPSC,KEY5
          CALL      RDAPMA1
.
          MOVE      SIIASUB,KEY5
          CALL      RDSISA1
.
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
.
          CLEAR     KEY6
          APPEND    "ia1",KEY6
          APPEND    SIIAUC1,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC1DESC
          ENDIF
.
          CLEAR     KEY6
          APPEND    "ia2",KEY6
          APPEND    SIIAUC2,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC2DESC
          ENDIF
.
          ADD       ONE,SIIASUS
          BRANCH    SIIASUS,ECATB110,ECATB120,ECATB130,ECATB140
ECATB110  MOVE      "Not Suspend               ",SUSPDESC
          GOTO      ECATB190
ECATB120  MOVE      "Requisitions              ",SUSPDESC
          GOTO      ECATB190
ECATB130  MOVE      "Suspend P/O              ",SUSPDESC
          GOTO      ECATB190
ECATB140  MOVE      "Suspend P/O & Requisition",SUSPDESC
          GOTO      ECATB190
ECATB190  SUB       ONE,SIIASUS
.
          MOVE      ZERO,EXIT
          MOVE      ZERO,OVRCD
          GOTO      ECATB999
.
ECATB200  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          KEYIN     *P1:24,*EL,"Record Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MATCH     ANSR,ANS
          GOTO      ECATB100 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      ECATB000 IF EQUAL
          MATCH     ANSE,ANS
          GOTO      ECATB200 IF NOT EQUAL
          GOTO      ECATB000
.
ECATB999  IF        EXIT=0
            MOVE      "    4",FLDID
            CALL      GETPOSIT
            IF        EXIT=0
              MOVE      SIIAISS,VAR
              CALL      DISPITEM
            ENDIF
            MOVE      "    1",FLDID
            CALL      GETPOSIT
          ENDIF
          RETURN
.------------------------------------------------------------
. Modify Supplier Details
.------------------------------------------------------------
MODSUP00  MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
MODSU200  CALL      DSUPP000 * Display Key Fields
          BRANCH    EXIT,MODSU999
.
          IF        SNCOCORP=1
            CALL      CHKCON00              * Check for Contract
            BRANCH    EXIT,MODSU999
          ENDIF
.
          CALL      WP03L000 * Load any WP Details
          CALL      DF03L000 * Display Fields
          CALL      SF03L000 * Select Fields
.
MODSU999  RETURN
.--------------------------------------------------------------------
. Display Key Fields for Supplier Details and Write Before Audit
.--------------------------------------------------------------------
DSUPP000  MOVE      SIIC1MKY,KEY27
          CALL      RDSIIC1
          IF        OVRCD=1
            MOVE      "Catalog/Supplier/Supply Unit Not File. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      DSUPP900
          ENDIF
.
          MOVE      SIICCCT,SSIICCCT
.
          MOVE      TWO,AUDTTYPE
          CALL      WASIIC00          * Write Before Audit
.
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      SIIACAT,SIICCAT
          MOVE      SIIACAT,VAR
          CALL      DISPITEM
.
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      SIICSUP,KEY5
          CALL      RDAPMA1
          MOVE      SIICSUP,VAR
          CALL      DISPITEM
.
          MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      ZERO,ACCEPT
          MOVE      SIICSUT,VAR
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      DSUPP999
.
DSUPP900  MOVE      ONE,EXIT
DSUPP999  RETURN
.---------------------------------------------------------------------------
. Check for any Contact Details
. Hospitals cannot modify details if item is on a corporate contract
.---------------------------------------------------------------------------
CHKCON00  MOVE      ZERO,EXIT
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          PACK      KEY45,SIICSUP,SIICCAT,CURRDATE,Z70
          CALL      RSSISD3                 * Check for Contract Price
          CALL      RPSISD3                 * Lastest Price
          BRANCH    OVRCD,CHKCON99          * No Contract
          MATCH     SISDSUP,SIICSUP         * Correct Supplier
          GOTO      CHKCON99 IF NOT EQUAL   * No Contract
          MATCH     SISDCAT,SIICCAT         * Correct Catalog
          GOTO      CHKCON99 IF NOT EQUAL   * No Contract
.
          MOVE      SISDCON,KEY10
          CALL      RDSISC1
          BRANCH    OVRCD,CHKCON99          * No Contract
.
          MATCH     CURRDATE,SISCEDT        * Check for Completed Contract
          GOTO      CHKCON99 IF LESS        * Contract Out of Date
.
          BEEP
          MOVE      "Supplier on Corporate Contract - ",DISPMSG
          CALL      MESSAGE1
          MOVE      ONE,EXIT
.
CHKCON99  RETURN
.
ADDSUP00
ADDSU100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
ADDSU200  MOVE      ONE,ACCEPT
          MOVE      SIIACAT,KEY7
          CALL      CF03L000 * Clear Fields
          CALL      RDSIIA1
.
          MOVE      ZERO,ADDFLAG  * Flag for Insert of Preferred Supplier
          CALL      GSUPP000 * Enter Key Fields
          BRANCH    EXIT,ADDSU999,ADDSU999
.
          MOVE      ZERO,SSIICCCT
          CALL      WP03L000 * Load any WP Details
          CALL      SF03L000 * Select Fields
.
ADDSU999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Supplier Details
.--------------------------------------------------------
GSUPP000  MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      SIIACAT,SIICCAT
          MOVE      SIIACAT,VAR
          CALL      DISPITEM
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIADES,VAR
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIAISS,VAR
            CALL      DISPITEM
          ENDIF
.
GSUPP120  MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "   10",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          IF        ADDFLAG=1
            MOVE      SIIAPSC,KEY5
            CALL      RDAPMA1
            IF        OVRCD=0
              MOVE      KEY5,SIICSUP
              GOTO      GSUPP125
            ENDIF
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KAPMAA00
          MOVE      APMACRD,SIICSUP
          BRANCH    EXIT,GSUPP900,GSUPP900
.
GSUPP125  MOVE      SIICSUP,VAR
          CALL      DISPITEM
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN1,VAR
            CALL      DISPITEM
          ENDIF
.
GSUPP130  MOVE      "   11",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          MOVE      SIIAISS,SIFAISSU
          MOVE      SP20,SIFASUPP
          CALL      KSIFAB00
          MOVE      SIFASUPP,SIICSUT
          BRANCH    EXIT,GSUPP120,GSUPP900
          PACK      KEY27,SIICCAT,SIICSUP,SIICSUT
          CALL      RASIIC1
          IF        OVRCD=0
            MOVE      "Catalog/Supplier/Supply Unit Already on File. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      GSUPP130
          ENDIF
          MOVE      ONE,ACCEPT
          MOVE      SIICSUT,VAR
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      GSUPP999
GSUPP900  MOVE      ONE,EXIT
GSUPP999  RETURN
CAN20000  CALL     UUSIIA1                  * Unlock
          RETURN
DEFPTD00  IF    ACCEPT=1
            MOVE    SIIADES,SIICPD1
          ENDIF
          RETURN
DEFAULTY    MOVE     ANSY,DEFYESNO
            RETURN
.----------------------------------------------
. Check for Notes
.----------------------------------------------
NSIID000  MOVE        SP70,NOTESIID
          MOVE        ZERO,OVRCD
          TRAP        OVERCOND IF IO
          OPEN        TEMPWORD,FILSIID1
          TRAPCLR     IO
          BRANCH      OVRCD,NSIID999
NSIID100  READ        TEMPWORD,SEQ;SIIDCOM
          GOTO        NSIID900 IF OVER
          MATCH       SP70,SIIDCOM
          GOTO        NSIID100 IF EQUAL
          MOVE        "Notes",NOTESIID
.
NSIID900  CLOSE       TEMPWORD
NSIID999  RETURN
.
.----------------------------------------------
. Enter Code
.----------------------------------------------
ECOD1000  MOVE        ZERO,CKEYTYP
          MOVE        "ic1",SICDCATA
          MOVE        SP70,UDC1DESC
          CALL        KSICDB00
          BRANCH      EXIT,ECOD1999,ECOD1999
          MOVE        SICDCODE,SIICUC1
          MOVE        SICDDESC,UDC1DESC
.
ECOD1999  RETURN
.
.----------------------------------------------
. Enter Code
.----------------------------------------------
ECOD2000  MOVE        ZERO,CKEYTYP
          MOVE        "ic2",SICDCATA
          MOVE        SP70,UDC2DESC
          CALL        KSICDB00
          BRANCH      EXIT,ECOD2999,ECOD2999
          MOVE        SICDCODE,SIICUC2
          MOVE        SICDDESC,UDC2DESC
.
ECOD2999  RETURN
.
CAN30000  PACK     KEY27,SIICCAT,SIICSUP,SIICSUT
          CALL     RASIIC1
          IF       OVRCD=0
            CALL     DASIIC00                 * Delete Before Audit
          ENDIF
          MOVE     ONE,CANCFLAG
          CALL     UUSIIA1
          RETURN
DEL30000  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          CALL     DELQST
          CALL     MESSAGE3
          BRANCH   CEXIT,DEL31000,DEL39000,DEL39100
.
DEL31000  PACK     KEY27,SIICCAT,SIICSUP,SIICSUT
          MOVE     KEY27,KEY27SAV
          CALL     CHLAST00
          BRANCH   EXIT,DEL39100
.
          PACK     KEY27,KEY27SAV
          CALL     RDSIIC1
          IF       OVRCD=0
            CALL     DASIIC00                 * Delete Before Audit
            MOVE     FOUR,AUDTTYPE
            CALL     WASIIC00                 * Delete Audit
            CALL     DESIIC1
          ENDIF
          PACK     KEY27,SIICCAT,SIICSUP,SP70
          PACK     KEY12,SIICCAT,SIICSUP,SP70
          CALL     RSSIIC1
          CALL     RKSIIC1
          BRANCH   OVRCD,DEL31100
          PACK     KEY27,SIICCAT,SIICSUP,SP70
          MATCH    KEY12,KEY27
          GOTO     DEL31900 IF EQUAL
.
. If No Other Records for this supplier then delete notes
.
DEL31100  PACK     KEY15,KEY12,SP70
          CALL     RSSIID1
          CALL     RKSIID1
          PACK     KEY15,SIIDCAT,SIIDSUP,SIIDLIN
          MATCH    KEY12,KEY15
          GOTO     DEL31900 IF NOT EQUAL
          CALL     DESIID1
          GOTO     DEL31100
.
DEL31900  MOVE     TWO,EXIT
          GOTO     DEL39999
.
DEL39000  MOVE     ONE,EXIT
          GOTO     DEL39999
.
DEL39100  CALL     CAN30000
          MOVE     TWO,EXIT
          GOTO     DEL39999
.
DEL39999  RETURN
.-----------------------------------------------------------------------------
. Check if Last Supplier/Supp. Unit  - Else OK
. Returns Exit=1  -  Not able to delete (last sup. or pref. supp. or not exist)
.         Exit=0  -  Able to Delete
.-----------------------------------------------------------------------------
CHLAST00  MOVE     ONE,EXIT
          CALL     RASIIC1
          IF       OVRCD=0
            CALL     GETTOT00
            IF       (TOTSUPS=FALSE) & (TOTUNITS=FALSE)
              MOVE    "Must have at least one Supplier/Supplier Unit - ",DISPMSG
              CALL     MESSAGE1
              GOTO     CHLAST99
            ENDIF
            IF       (TOTSUPS=TRUE) & (TOTUNITS=FALSE) & (ISPREFER=TRUE)
              MOVE     "Cannot Delete your Preferred Supplier - ",DISPMSG
              CALL     MESSAGE1
              GOTO     CHLAST99
            ENDIF
            MOVE      ZERO,EXIT
          ELSE
            MOVE      "Supplier/Supplier Unit does not exist - ",DISPMSG
            CALL      MESSAGE1
            GOTO      CHLAST99
          ENDIF
.
CHLAST99  RETURN
.-----------------------------------------------------------------------------
. Get Total Suppliers and Total Units per Supplier and If Preferred
. TOTSUPS  1-Two or more Suppliers for Catalog      0-only one for Catalog
. TOTUNITS 1-Two or more Units for Catalog/Supplier 0-only one for Cat./Supplier
. ISPREFER 1-Yes                                    0-No
.-----------------------------------------------------------------------------
GETTOT00  MOVE      SIICSUP,SAVSUP
          MATCH     SIIAPSC,SIICSUP
          IF        @EQUAL
            MOVE      TRUE,ISPREFER
          ELSE
            MOVE      FALSE,ISPREFER
          ENDIF
.
          MOVE      FALSE,TOTSUPS
          MOVE      "-1",TOTUNITS
.
. ------- Check if More than one supplier unit for Catalog/Supplier
          PACK      KEY27,SIICCAT,SIICSUP,SP70
          CALL      RSSIIC1
GETTOT10  CALL      RKSIIC1
          BRANCH    OVRCD,GETTOT20
.
          PACK      KEY12,SIICCAT,SIICSUP
          MATCH     KEY12,KEY27
          GOTO      GETTOT20 IF NOT EQUAL
.
          ADD       ONE,TOTUNITS
          BRANCH    TOTUNITS,GETTOT20
          GOTO      GETTOT10
.
. ------- Check if More than one supplier
GETTOT20  PACK      KEY12,KEY27SAV,Z70
          PACK      KEY27,KEY12,Z70
          CALL      RSSIIC1
          CALL      RKSIIC1
          BRANCH    OVRCD,GETTOT99
.
          MATCH     SIICCAT,KEY27SAV
          IF        @EQUAL
            MOVE      ONE,TOTSUPS
            GOTO      GETTOT99
          ENDIF
.
          PACK      KEY27,KEY12,SP70
          CALL      RSSIIC1
          CALL      RPSIIC1
          BRANCH    OVRCD,GETTOT99
.
          MATCH     SIICCAT,KEY27SAV
          IF        @EQUAL
            MOVE      ONE,TOTSUPS
            GOTO      GETTOT99
          ENDIF
.
GETTOT99  IF        TOTUNITS<0
            MOVE      ZERO,TOTUNITS
          ENDIF
          IF        TOTSUPS<0
            MOVE      ZERO,TOTSUPS
          ENDIF
          RETURN
POS30000
          PACK     KEY27,SIICCAT,SIICSUP,SIICSUT,SP70
          CALL     RASIIC1
          IF       OVRCD=0
            CALL     UPSIIC1
            MOVE     THREE,AUDTTYPE
            IF       SIICCCT<>SSIICCCT
              PACK     SICODAT,CCC,CYY,CMM,CDD,SP70
              REP      " 0",SICODAT
              PACK     KEY35,SIICCAT,SIICSUP,SIICSUT,SICODAT,SP70
              CALL     RDSICO1
              IF       OVRCD=0
                MOVE     SIICCCT,SICONPR
                CALL     UPSICO1
              ELSE
                UNPACK   KEY35,SICOCAT,SICOSUP,SICOSUT,SICODAT
                MOVE     SIICCCT,SICONPR
                MOVE     SSIICCCT,SICOOPR
                MOVE     SP70,SICOSPA
                CALL     WRSICO1
              ENDIF
            ENDIF
          ELSE
            CALL     WRSIIC1
            MOVE     ONE,AUDTTYPE
          ENDIF
.
          PACK     KEY7,SIICCAT
          CALL     RDSIIA1
          IF       OVRCD=0
            CLOCK    TIME,CTIMEIS
            PACK     SIIADTC,CCC,CYY,CMM,CDD
            REP      " 0",SIIADTC
            MOVE     CTIMEIS,SIIATMC
            MOVE     PASSCODE,SIIAUSC
            CALL     UPSIIA1
          ENDIF
.
          MOVE      SIICCAT,SAVECATA
          MOVE      SIICSUP,SAVECRED
          MOVE      SIICSUT,SAVEUNIT
.
          MATCH     SP70,SIICPNO              * No Check for Blank Part Numbers
          GOTO      POS30500 IF EQUAL
.
          PACK      KEY35,SIICSUP,SIICPNO,SP70
          PACK      KEY57,SIICSUP,SIICPNO,SP70
          CALL      RSSIIC2
POS30100
          CALL      RKSIIC2
          BRANCH    OVRCD,POS30500
          PACK      KEY57,SIICSUP,SIICPNO,SP70
          MATCH     KEY35,KEY57
          GOTO      POS30500 IF NOT EQUAL
          MATCH     SAVECATA,SIICCAT
          GOTO      POS30100 IF EQUAL
.
          MOVE      SIICCAT,KEY7
          CALL      RDSIIA1
          IF        OVRCD=1
            MOVE      SAVECATA,KEY7
            CALL      RDSIIA1
            GOTO      POS30100
          ENDIF
          MOVE      "19",HTOP
          MOVE      "1",HLEF
          MOVE      "80",HRIG
          MOVE      "24",HBOT
          CALL      GETSCR00
          MOVE      ZERO,HTOP
          MOVE      ZERO,HLEF
          MOVE      ZERO,HRIG
          MOVE      ZERO,HBOT
          BEEP
          DISPLAY   *P1:19,*EF
          HLINE     *G37,19,1,80
          HLINE     *G37,23,1,80
          DISPLAY   *P1:20,"Catalog     : ",*V2LON,SIIACAT,*HOFF:
                    *P1:21,"Description : ",*V2LON,SIIADES,*HOFF:
                    *P1:22,"Issue Unit  : ",*V2LON,SIIAISS
.
POS30200  KEYIN     *P1:24,*EL,*V2LON,"WARNING - ",*HOFF:
                    "Part Number Already on File for this Supplier. ":
                    "Continue (",*V2LON,"Y",*HOFF:
                    "/",*V2LON,"N",*HOFF,") ? ",ANS
          REP       UPPLOW,ANS
          MATCH     ANSN,ANS
          GOTO      POS34000 IF EQUAL
          MATCH     ANSY,ANS
          GOTO      POS30200 IF NOT EQUAL
.
. Continue
.
          CALL      PUTSCR00
          MOVE      SAVECATA,KEY7
          CALL      RDSIIA1
.
POS30500  PACK      KEY27,SAVECATA,SAVECRED,SAVEUNIT
          CALL      RDSIIC1
.
          CALL      WASIIC00                 * Audit Add
          PACK      KEY15,SIICCAT,SIICSUP,SP70
          CALL      RSSIID1
POS31000  CALL      RKSIID1
          BRANCH    OVRCD,POS31900
          MATCH     SIIDCAT,SIICCAT
          GOTO      POS31900 IF NOT EQUAL
          MATCH     SIIDSUP,SIICSUP
          GOTO      POS31900 IF NOT EQUAL
          PACK      KEY15,SIIDCAT,SIIDSUP,SIIDLIN
          CALL      DESIID1
          GOTO      POS31000
.
POS31900  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIID1
          TRAPCLR   IO
          BRANCH    OVRCD,POS39000
          MOVE      ZERO,F3
POS32000  READ      TEMPWORD,SEQ;SIIDCOM
          GOTO      POS39000 IF OVER
          MOVE      F3,SIIDLIN
          PACK      KEY15,SIICCAT,SIICSUP,SIIDLIN
          UNPACK    KEY15,SIIDCAT,SIIDSUP,SIIDLIN
          CALL      WRSIID1
          ADD       ONE,F3
          GOTO      POS32000
.
. Discontinued Posting
.-----------------------
POS34000  MOVE      SAVECATA,KEY7
          CALL      PUTSCR00
          CALL      RDSIIA1
          PACK      KEY27,SAVECATA,SAVECRED,SAVEUNIT
          CALL      RDSIIC1
          IF        OVRCD=0
            CALL      DESIIC1
            IF        AUDTTYPE=3
              CALL      DASIIC00                 * Delete Before Audit
            ENDIF
          ENDIF
.
POS39000  CALL      PALIA000
          RETURN
ECEXP000   MATCH     "1",SIICCONT
           IF        @EQUAL
             UNPACK    SIICCTEX,CCENT,CYEAR,CMON,CDAY
             MOVE      ZERO,CDEFDTE
             CALL      KEYDATE
             PACK      SIICCTEX,CCENT,CYEAR,CMON,CDAY
             MATCH     SP2,CDAY
             IF        @EQUAL
               MOVE      SP8,SIICCTEX
             ENDIF
           ELSE
              MOVE      SP8,SIICCTEX
           ENDIF
.
ECEXP999  RETURN
WARDET00
          PACK      KEY5,SIIEWAR
          CALL      RDSIWA1
          RETURN
MODWAR00  CALL      CSIWS000          * check warehouse security
          COMPARE   ZERO,SECSIWS      * no warehouse access at all
          GOTO      MODWA900 IF EQUAL
.
..          COMPARE   THREE,SECSIWS     * access all warehouses
..          GOTO      MODWA100 IF EQUAL
.
          UNPACK    KEY12,DIM7,DIM5   * selected warehouse access
          PACK      KEY9,PASSCODE,DIM5,SP70
          CALL      RDSIWS1
          BRANCH    OVRCD,MODWA910
.
MODWA100  MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL    * Position for Prompt
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000          * Display Background
.
MODWA200  CALL      DWARE000          * Display Key Fields
          BRANCH    EXIT,MODWA999
          CALL      WP05L000          * Load any WP Details
          CALL      DF05L000          * Display Fields
          MOVE      ZERO,ADDFLAG      * Modification
          MOVE      SIIESOH,TOTALSOH  * Save Stock On Hand for Item History Adj.
          CALL      SF05L000          * Select Fields
          CALL      UUSIIE1           * Unlock Warehouse level
          GOTO      MODWA999
.
MODWA900  CLEAR     DISPMSG
          MOVE      "You have no access for All Warehouses - ",DISPMSG
          CALL      MESSAGE1
          GOTO      MODWA999
.
MODWA910  CLEAR     DISPMSG
          APPEND    "You have no access for Warehouse ",DISPMSG
          APPEND    DIM5,DISPMSG
          APPEND    " - ",DISPMSG
          CALL      MESSAGE1
          GOTO      MODWA999
.
MODWA999  RETURN
.--------------------------------------------------------------------
. Display Key Fields for Supplier Details and Write Before Audit
.--------------------------------------------------------------------
DWARE000  MOVE      SIIE1MKY,KEY12
          CALL      RLSIIE1
          IF        OVRCD=1
            BEEP
            MOVE      "Catalog/Warehouse NOT On File. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      DWARE900
          ENDIF
.
          IF        OVRCD=2
            BEEP
            MOVE      "Catalog/Warehouse Locked. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      DWARE900
          ENDIF
.
          MOVE      TWO,AUDTTYPE
          CALL      WASIIE00          * Write Before Audit
.
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      SIIACAT,SIIECAT
          MOVE      SIIACAT,VAR
          CALL      DISPITEM
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      SIIEWAR,KEY5
          CALL      RDSIWA1
          MOVE      SIIEWAR,VAR
          CALL      DISPITEM
.
          BRANCH    SIIESUS,DWARE220,DWARE230,DWARE240
.
          MOVE      "Not Suspend               ",SUSPDESC
          GOTO      DWARE300
DWARE220  MOVE      "Requisitions              ",SUSPDESC
          GOTO      DWARE300
DWARE230  MOVE      "Suspend P/O               ",SUSPDESC
          GOTO      DWARE300
DWARE240  MOVE      "Suspend P/O & Requisition ",SUSPDESC
          GOTO      DWARE300
DWARE300
.
          MOVE      SIIESOH,WHOLESOH
          MOVE      SIIEROL,WHOLEROL
          MOVE      SIIEROQ,WHOLEROQ
.
          MOVE      ZERO,ACCEPT
          MOVE      ZERO,EXIT
          GOTO      DWARE999
.
DWARE900  MOVE      ONE,EXIT
DWARE999  RETURN
ADDWAR00  MOVE      ONE,ADDFLAG
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
ADDWA200  MOVE      ONE,ACCEPT
          MOVE      SIIACAT,KEY7
          CALL      CLRWAR00 * Clear Fields
          CALL      RDSIIA1
.
          CALL      GWARE000 * Enter Key Fields
          BRANCH    EXIT,ADDWA999,ADDWA999
.
          CALL      WP05L000 * Load any WP Details
          CALL      SF05L000 * Select Fields
.
ADDWA999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Supplier Details
.--------------------------------------------------------
GWARE000  MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      SIIACAT,SIIECAT
          MOVE      SIIACAT,VAR
          CALL      DISPITEM
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIADES,VAR
            CALL      DISPITEM
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIIAISS,VAR
            CALL      DISPITEM
          ENDIF
.
GWARE120  MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KSIWSA00
          MOVE      SIWAWAR,SIIEWAR
          BRANCH    EXIT,GWARE900,GWARE900
          MOVE      SIWAWAR,VAR
          CALL      DISPITEM
.
          MOVE      "   26",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIWADES,VAR
            CALL      DISPITEM
          ENDIF
.
          PACK      KEY12,SIIECAT,SIIEWAR
          CALL      RASIIE1
          IF        OVRCD=0
            MOVE      "Catalog/Warehouse Already on File. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      GWARE120
          ENDIF
          MOVE      ONE,ACCEPT
          MOVE      ZERO,EXIT
          GOTO      GWARE999
GWARE900  MOVE      ONE,EXIT
GWARE999  RETURN
CLRWAR00  MOVE      SP70,SIIESID
          MOVE      SP70,SIIERAS
          MOVE      ZERO,SIIESOO
          MOVE      ZERO,SIIESOH
          MOVE      ZERO,SIIEROQ
          MOVE      ZERO,SIIEROL
          MOVE      ZERO,SIIESIC
          MOVE      ZERO,SIIESAB
          MOVE      SP70,SIIEABC
          MOVE      ZERO,SIIESUS
          MOVE      SP70,SIIEUR1
          MOVE      SP70,SIIEUR2
          MOVE      SP70,SIIEUC1
          MOVE      SP70,SIIEUC2
          MOVE      SP70,SIIEUD1
          MOVE      SP70,SIIEUD2
          MOVE      SP70,SIIEUY1
          MOVE      SP70,SIIEUY2
          MOVE      SP70,SIWADES
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
          MOVE      SP70,NOTESIIG
          MOVE      SP70,SUSPDESC
          RETURN
.----------------------------------------------
. Check for Notes
.----------------------------------------------
NSIIG000  MOVE        SP70,NOTESIIG
          MOVE        ZERO,OVRCD
          TRAP        OVERCOND IF IO
          OPEN        TEMPWORD,FILSIIG1
          TRAPCLR     IO
          BRANCH      OVRCD,NSIIG999
NSIIG100  READ        TEMPWORD,SEQ;SIIGCOM
          GOTO        NSIIG900 IF OVER
          MATCH       SP70,SIIGCOM
          GOTO        NSIIG100 IF EQUAL
          MOVE        "Notes",NOTESIIG
.
NSIIG900  CLOSE       TEMPWORD
NSIIG999  RETURN
.
.----------------------------------------------------------------------
. Default DEFYESNO to "N"
.----------------------------------------------------------------------
NYESNO00  MOVE      "N",DEFYESNO
          RETURN
.----------------------------------------------------------------------
. Default DEFYESNO to "_"
.----------------------------------------------------------------------
CYESNO00  MOVE      "_",DEFYESNO
          RETURN
ESTW0000  CALL      DCODE000
          CLEAR     SIIESID
          MOVE      CCOL,F2
          MOVE      ZERO,CLNO
ESTW1000  KEYIN     *PF2:CVERT,*V2LON,*DE,*+,ANS
          RESET     ANS
          GOTO      ESTW2000 IF EOS
          MATCH     "0",ANS
          GOTO      ESTW1100 IF EQUAL
          MATCH     "1",ANS
          GOTO      ESTW1100 IF EQUAL
          BEEP
          GOTO      ESTW1000
.
ESTW1100  ADD       ONE,F2
          ADD       ONE,CLNO
          APPEND    ANS,SIIESID
          COMPARE   SIX,CLNO
          GOTO      ESTW1000 IF LESS
.
ESTW2000  APPEND    "000000",SIIESID
          RESET     SIIESID
          DISPLAY   *PCCOL:CVERT,*V2LON,SIIESID
          CALL      PUTSCR00
          RETURN
ESOH0000
          CALL      SISIWK1            * check if stocktake file exists
          IF        OVRCD=0
            CLOSE     SINWRKA1
            CLEAR     DISPMSG
            APPEND    "Stocktake in Progress for this Warehouse - ",DISPMSG
            CALL      MESSAGE1
            GOTO      ESOH9999
          ENDIF
.
          MOVE      SIIESOH,WHOLESOH
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,WHOLESOH:
                    *PCCOL:CVERT
          IF        WHOLESOH<0
            MOVE      "Stock on Hand Must be Positive. - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      ESOH0000
          ENDIF
          MOVE      WHOLESOH,SIIESOH
ESOH9999  RETURN
EROQ0000  MOVE      SIIEROQ,WHOLEROQ
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,WHOLEROQ:
                    *PCCOL:CVERT
          IF        WHOLEROQ<0
            MOVE      "Re-Order Quantity Must be Positive - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      EROQ0000
          ENDIF
          MOVE      WHOLEROQ,SIIEROQ
EROQ9999  RETURN
EROL0000  MOVE      SIIEROL,WHOLEROL
          KEYIN     *PCCOL:CVERT,*V2LON,*NOMASK,*RV,WHOLEROL:
                    *PCCOL:CVERT
          IF        WHOLEROL<0
            MOVE      "Re-Order Quantity Must be Positive - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      EROL0000
          ENDIF
          MOVE      WHOLEROL,SIIEROL
EROL9999  RETURN
EWABC000  KEYIN     *PCCOL:CVERT,*V2LON,*RV,SIIEABC
          REP       UPPLOW,SIIEABC
          MATCH     ANSA,SIIEABC
          GOTO      EWABC999 IF EQUAL
          MATCH     ANSB,SIIEABC
          GOTO      EWABC999 IF EQUAL
          MATCH     ANSC,SIIEABC
          GOTO      EWABC999 IF EQUAL
          BEEP
          GOTO      EWABC000
EWABC999  RETURN
EWSU0000  MOVE      ZERO,SIIESUS
          MOVE      SP70,DISPMSG
          CALL      MESSAGE2
.
EWSU1000  DISPLAY   *P1:24,*EL:
                    *V2LON,"0",*HOFF," = Not Suspend  ":
                    *V2LON,"1",*HOFF," = Requisitions  ":
                    *V2LON,"2",*HOFF," = Suspend P/O  ":
                    *V2LON,"3",*HOFF," = Suspend P/O & Requisit."
.
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,SIIESUS
          ADD       ONE,SIIESUS
          BRANCH    SIIESUS,EWSU2100,EWSU2200,EWSU2300,EWSU2400
          BEEP
          GOTO      EWSU1000
.
EWSU2100  MOVE      "Not Suspend               ",SUSPDESC
          GOTO      EWSU3000
EWSU2200  MOVE      "Requisitions              ",SUSPDESC
          GOTO      EWSU3000
EWSU2300  MOVE      "Suspend P/O              ",SUSPDESC
          GOTO      EWSU3000
EWSU2400  MOVE      "Suspend P/O & Requisition",SUSPDESC
          GOTO      EWSU3000
EWSU3000  SUB       ONE,SIIESUS
          CALL      MESSAGE3
.
EWSU9999  RETURN
.----------------------------------------------
. Enter Code
.----------------------------------------------
ECDE1000  MOVE        ZERO,CKEYTYP
          MOVE        "ie1",SICDCATA
          MOVE        SP70,UDC1DESC
          CALL        KSICDB00
          BRANCH      EXIT,ECDE1999,ECDE1999
          MOVE        SICDCODE,SIIEUC1
          MOVE        SICDDESC,UDC1DESC
.
ECDE1999  RETURN
.
.----------------------------------------------
. Enter Code
.----------------------------------------------
ECDE2000  MOVE        ZERO,CKEYTYP
          MOVE        "ie2",SICDCATA
          MOVE        SP70,UDC2DESC
          CALL        KSICDB00
          BRANCH      EXIT,ECDE2999,ECDE2999
          MOVE        SICDCODE,SIIEUC2
          MOVE        SICDDESC,UDC2DESC
.
ECDE2999  RETURN
.
CAN50000  PACK     KEY12,SIIECAT,SIIEWAR
          CALL     RASIIE1
          IF       OVRCD=0
            CALL     DASIIE00                 * Delete Before Audit
          ENDIF
          CALL     UUSIIA1
          RETURN
.
POS50000  PACK     KEY12,SIIECAT,SIIEWAR
          CALL     RASIIE1
          IF       OVRCD=0
            CALL     UPSIIE1
            MOVE     THREE,AUDTTYPE
            CALL     WASIIE00                 * Audit Change
          ELSE
            CALL     WRSIIE1
            MOVE     ONE,AUDTTYPE
            CALL     WASIIE00                 * Audit Add
          ENDIF
.
          PACK     KEY7,SIIECAT
          CALL     RDSIIA1
          IF       OVRCD=0
            CLOCK    TIME,CTIMEIS
            PACK     SIIADTC,CCC,CYY,CMM,CDD
            REP      " 0",SIIADTC
            MOVE     CTIMEIS,SIIATMC
            MOVE     PASSCODE,SIIAUSC
            CALL     UPSIIA1
          ENDIF
.
          CALL      ITMHIS00                  * Update Item History
.
.---- post notes ----
.
          PACK      KEY15,SIIECAT,SIIEWAR,SP70
          CALL      RSSIIG1
.
POS51000  CALL      RKSIIG1
          BRANCH    OVRCD,POS51900
          MATCH     SIIGCAT,SIIECAT
          GOTO      POS51900 IF NOT EQUAL
          MATCH     SIIGWAR,SIIEWAR
          GOTO      POS51900 IF NOT EQUAL
          PACK      KEY15,SIIGCAT,SIIGWAR,SIIGLIN
          CALL      DESIIG1
          GOTO      POS51000
.
POS51900  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIIG1
          TRAPCLR   IO
          BRANCH    OVRCD,POS59999
          MOVE      ZERO,F3
.
POS52000  READ      TEMPWORD,SEQ;SIIGCOM
          GOTO      POS59999 IF OVER
          MOVE      F3,SIIGLIN
          PACK      KEY15,SIIECAT,SIIEWAR,SIIGLIN
          UNPACK    KEY15,SIIGCAT,SIIGWAR,SIIGLIN
          CALL      WRSIIG1
          ADD       ONE,F3
          GOTO      POS52000
.
POS59999  RETURN
.
ITMHIS00  PACK      SIITDAT,CCC,CYY,CMM,CDD,SP70
          REP       " 0",SIITDAT
          CALL      GETPER00           * Get Period for Item History
          BRANCH    ADDFLAG,ITMHIS50
.
          COMPARE   SIIESOH,TOTALSOH   * No Change
          GOTO      ITMHIS99 IF EQUAL
.
          MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          BEEP
          KEYIN     *P1:24,*EL,"Stock on Hand Changed. Enter Reason : ":
                    *V2LON,SIITREF
          CALL      MESSAGE3
.
          MOVE      ONE,SIITTYP
          ASSIGN    SIIESOH-TOTALSOH,SIITQTY
          ASSIGN    SIIESOH-TOTALSOH,TOTALREC    * for backorders
.
          GOTO      ITMHIS80
.
ITMHIS50
          MOVE      ZERO,SIITTYP
          MOVE      "New Catalog",SIITREF
          MOVE      SIIESOH,SIITQTY
          MOVE      SIIESOH,TOTALREC             * for backorders
.
ITMHIS80
          ASSIGN    SIITQTY*SIIAAVC,SIITAMT
          MOVE      SIIEWAR,SIITWAR
          MOVE      SIIECAT,SIITCAT
          CLOCK     TIME,SIITTIM
          MOVE      PASSCODE,SIITOPR
          MOVE      PORT,SIITPOR
          MOVE      PRGID,SIITPRG
          MOVE      SP70,SIITCST
          MOVE      SP70,SIITREQ
          MOVE      SP70,SIITPUR
          MOVE      SIIESOH,SIITSOH
          MOVE      SP70,SIITSPA
          REPEAT
            CLOCK     TIME,SIITTIM
            PACK      KEY28,SIITWAR,SIITCAT,SIITDAT,SIITTIM,SP70
            CALL      RASIIT1
          UNTIL     OVRCD=1
          CALL      WRSIIT1
.
          IF        TOTALREC>0
            CALL      BACK0000              * Update Backorders
          ENDIF
.
ITMHIS99  RETURN
.--------------------------------------------------
. Get Period for Item History
.--------------------------------------------------
GETPER00  REPEAT
            MOVE      SIITDAT,SIPEDATE
            CALL      RSIPE0000          * get period
            IF        (OVRCD=1)|(SIPELOC=1)
              PACK      DISPMSG,SP70,SP70
              CALL      MESSAGE2
              UNPACK    SIPEDATE,CCENT,CYEAR,CMON,CDAY
              CALL      PACDATE
              MOVE      "24",CVERT
              MOVE      "41",CCOL
              IF        OVRCD=1
                DISPLAY   *P1:24,"No Period For ",*V2LON,CPCDATE,*HOFF," - ";
              ELSE
                DISPLAY   *P1:24,"Year/Period ",*V2LON:
                          SIPEYEAR,SLASH,SIPEPER,*HOFF," Locked - ";
              ENDIF
              DISPLAY   "Enter Date : ";
              CALL      KEYDATE
              PACK      SIITDAT,CCENT,CYEAR,CMON,CDAY,SP70
              CALL      MESSAGE3
            ENDIF
          UNTIL     (OVRCD=0)&(SIPELOC=0)
          PACK      SIITPER,SIPEYEAR,SIPEPER,SP70
          RETURN
.
.----------------------------------------------------------------------
. Process Back Orders
. Requires : TOTALREC (quantity to allocate)
.----------------------------------------------------------------------
BACK0000  READ      CONTROLF,TWENTY3;*120,HBACK
          READ      CONTROLF,SIXTY3;*144,HALLOCBO
.
          COMPARE   ONE,HBACK
          GOTO      BACK9999 IF NOT EQUAL
.
          MOVE      ZERO,TOTALSOB
          MOVE      ZERO,COUNT
.
          PACK      KEY12,SIIEWAR,SIIECAT,SP70
          PACK      KEY25,SIIEWAR,SIIECAT,SP70
          CALL      RSSIBA2
.
BACK1000  CALL      RKSIBA2
          BRANCH    OVRCD,BACK1100
          PACK      KEY25,SIBAWAR,SIBACAT,SIBACST,SIBAREQ,SP70
          MATCH     KEY12,KEY25
          GOTO      BACK1100 IF NOT EQUAL
.
BACK1050  CALL      RLSIBA2
          IF        OVRCD=2
            BEEP
            DISPLAY   *P1:24,*EL,"Back Order Locked : ",KEY25
            GOTO      BACK1050
          ENDIF
.
          ADD       SIBAQTY,TOTALSOB      * Total of Requisitions
          ADD       ONE,COUNT             * Number of Requisitions
          GOTO      BACK1000
.
BACK1100  COMPARE   ZERO,TOTALSOB
          GOTO      BACK9000 IF EQUAL
.
          IF        TOTALREC>TOTALSOB
            CALL      BACALL00           * Allocate all Backorders
            GOTO      BACK9000
          ENDIF
.
          IF        COUNT=1
            CALL      BACONE00           * Allocate to Single Back Order
            GOTO      BACK9000
          ENDIF
.
          CALL      BACUSR00           * Allow User to Allocate Backorder
.
BACK9000  CALL      UUSIBA2
.
BACK9999  RETURN
.-------------------------------------------------------------------
. Not Enough Received to Cover All Back Orders.
.-------------------------------------------------------------------
BACUSR00  CALL      KLTMBA00
          CALL      CRTMBA00
.
          PACK      KEY12,SIIEWAR,SIIECAT,SP70
          PACK      KEY25,SIIEWAR,SIIECAT,SP70
          PACK      SKEY7,PORT,SP70
          CALL      RSSIBA2
.
BACUSR10  CALL      RKSIBA2
          BRANCH    OVRCD,BACUSR20
          PACK      KEY25,SIBAWAR,SIBACAT,SIBACST,SIBAREQ,SP70
          MATCH     KEY12,KEY25
          GOTO      BACUSR20 IF NOT EQUAL
.
          IF        HALLOCBO=2
            PACK      KEY33,SIBADAT,KEY25
          ELSE
            PACK      KEY33,SP8,KEY25
          ENDIF
.
          CALL      RATMBA1
          IF        OVRCD=1
            CALL      WRTMBA1
          ENDIF
          GOTO      BACUSR10
.
BACUSR20  MOVE      SP70,KEY33
          MOVE      TOTALREC,TOTALEFT
          CALL      RSTMBA1
BACUSR30  CALL      RKTMBA1
          BRANCH    OVRCD,BACUSR40
.
          PACK      SIBTPON,SKEY7,SP70
          MOVE      SIBAREQ,SIBTREQ
          MOVE      SIBACST,SIBTCST
          MOVE      SIBAQTY,SIBTQTY
.
          IF        HALLOCBO=2
            IF        TOTALEFT>=SIBTQTY
              MOVE      SIBTQTY,SIBTISS
              SUB       SIBTQTY,TOTALEFT
            ELSE
              MOVE      TOTALEFT,SIBTISS
              MOVE      ZERO,TOTALEFT
            ENDIF
          ELSE
            ASSIGN    (SIBAQTY/TOTALSOB),F12P2
            ASSIGN    (F12P2*TOTALREC)+.50,F12P2
            MOVE      F12P2,QTYFORM8
            IF        TOTALEFT>=QTYFORM8
              MOVE      QTYFORM8,SIBTISS
              SUB       QTYFORM8,TOTALEFT
            ELSE
              MOVE      TOTALEFT,SIBTISS
              MOVE      ZERO,TOTALEFT
            ENDIF
          ENDIF
.
          PACK      KEY15,SIBTPON,SIBTREQ
          CALL      RASIBT1
          IF        OVRCD=1
            CALL      WRSIBT1
          ENDIF
          GOTO      BACUSR30
.
BACUSR40  CALL      KLTMBA00
          CALL      SCBAL000
.
          PACK      KEY8,SP70
          CALL      TSSIBT12
.
BACUSR50  CALL      TKSIBT12
          BRANCH    OVRCD,BACUSR99
          MOVE      SIIEWAR,SIBPWAR
          MOVE      SIBTCST,SIBPCST
.
          COMPARE   ZERO,SIBTISS
          GOTO      BACUSR80 IF EQUAL
.
          PACK      KEY25,SIIEWAR,SIIECAT,SIBTCST,SIBTREQ,SP70
          CALL      RDSIBA2
          BRANCH    OVRCD,BACUSR50
.
          MOVE      SIBTISS,SIBPAQT
          ASSIGN    SIBAQTY-SIBTISS,SIBPBQT
          CALL      WRPIC000
.
          ASSIGN    SIBAQTY-SIBTISS,SIBAQTY
          IF        SIBAQTY>0
            CALL      UPSIBA2
          ELSE
            CALL      DESIBA2
          ENDIF
.
BACUSR80  PACK      KEY15,SKEY7,SIBTREQ,SP70
          CALL      RASIBT1
          IF        OVRCD=0
            CALL      DESIBT1
          ENDIF
          GOTO      BACUSR50
.
BACUSR99  RETURN
.-----------------------------------------------------------------
. Kill the Temporary Backorder File
.-----------------------------------------------------------------
KLTMBA00  PACK      TMBANAME,TMBANAMA,PORT
          CLOSE     TMPBACA1
          CLEAR     CMDLINE
          APPEND    "iserase ",CMDLINE
          APPEND    TMBANAME,CMDLINE
          RESET     CMDLINE
.
          EXECUTE   CMDLINE,TASKID
.
KLTMBA99  RETURN
.-----------------------------------------------------------------
. Create the Temporary Backorder File
.-----------------------------------------------------------------
CRTMBA00  CLEAR     CMDLINE
          APPEND    "isbuild ",CMDLINE
          APPEND    TMBANAME,CMDLINE
.
          APPEND    " 61 UC26-33,21-25,6-12,1-5,13-20",CMDLINE
          RESET     CMDLINE
.
          EXECUTE   CMDLINE,TASKID
          OPEN      TMPBACA1,TMBANAME
.
CRTMBA99  RETURN
.-----------------------------------------------------------------
. Enough Received to Cover All Back Orders.
.-----------------------------------------------------------------
BACALL00  PACK      KEY12,SIIEWAR,SIIECAT,SP70
          PACK      KEY25,SIIEWAR,SIIECAT,SP70
          CALL      RSSIBA2
.
BACALL10  CALL      RKSIBA2
          BRANCH    OVRCD,BACALL99
          PACK      KEY25,SIBAWAR,SIBACAT,SIBACST,SIBAREQ,SP70
          MATCH     KEY12,KEY25
          GOTO      BACALL99 IF NOT EQUAL
.
          MOVE      SIBAQTY,SIBPAQT
          MOVE      ZERO,SIBPBQT
          CALL      WRPIC000   * Write to Picking Sheets
.
          PACK      KEY25,SIBAWAR,SIBACAT,SIBACST,SIBAREQ,SP70
          CALL      DESIBA2    * Back Order Compltete So Remove
          GOTO      BACALL10
.
BACALL99  RETURN
.----------------------------------------------------------------------
. Single Item on Back Order Only.
.----------------------------------------------------------------------
BACONE00  PACK      KEY12,SIIEWAR,SIIECAT,SP70
          PACK      KEY25,SIIEWAR,SIIECAT,SP70
          CALL      RSSIBA2
          CALL      RKSIBA2
          BRANCH    OVRCD,BACONE99
          PACK      KEY25,SIBAWAR,SIBACAT,SIBACST,SIBAREQ,SP70
          MATCH     KEY12,KEY25
          GOTO      BACONE99 IF NOT EQUAL
.
          MOVE      TOTALREC,SIBPAQT
          ASSIGN    SIBAQTY-TOTALREC,SIBPBQT
.
          CALL      WRPIC000
.
          ASSIGN    SIBAQTY-TOTALREC,SIBAQTY
          IF        SIBAQTY=0
            CALL      DESIBA2
          ELSE
            CALL      UPSIBA2
          ENDIF
.
BACONE99  RETURN
.-----------------------------------------------
. Write to Picking Sheet File for Back Orders
.-----------------------------------------------
WRPIC000  CALL      GETREQ00    * Post Requisition File Entry
.
          MOVE      SIIEWAR,SIBPWAR    * Warehouse
          MOVE      SIIECAT,SIBPCAT    * Catalog
          MOVE      SIBAQTY,SIBPRQT    * Quantity Required
          MOVE      BACKDEL,SIBPDEL    * Delivery Details
          MOVE      SIRACST,SIBPCST    * Cost Centre
          MOVE      SIIERAS,SIBPRAC    * Rack&Shelf
          MOVE      SIRATYP,SIBPTYP    * Req Type
          MOVE      SIRAREQ,SIBPREQ    * Req No.
          MOVE      SP70,SIBPRESI      * Restock ID
          MOVE      SP2,SIBPPFL
          PACK    KEY83,SIBPWAR,SIBPCST,SIBPDEL,SIBPRAC,SIBPCAT,SIBPTYP,SIBPREQ
          CALL      RASIBP1
          IF        OVRCD=1
            CALL      WRSIBP1
          ENDIF
.
          SUB       SIBPAQT,SIIESOH
          CALL      UPSIIE1
.
          PACK      SIITPER,SIPEYEAR,SIPEPER
          MOVE      SIBPWAR,SIITWAR            * Warehouse
          MOVE      SIBPCAT,SIITCAT            * Catalog
          ASSIGN    SIBPAQT*SEQ,SIITQTY        * Quantity
          ASSIGN    SEQ*SIBPAQT*SIIAAVC,SIITAMT
          MOVE      SIBPCST,SIITCST            * Cost Centre
          PACK      SIITREQ,SIBPTYP,SIBPREQ
          MOVE      "6",SIITTYP                * Back Order Requisition
          MOVE      SP7,SIITPUR                * Order Number
          MOVE      SIIESOH,SIITSOH            * Stock on Hand
          MOVE      SP70,SIITSPA               * Spare
.
          MOVE      PRGID,SIITPRG
          MOVE      PORT,SIITPOR
          MOVE      PASSCODE,SIITOPR
          PACK      SIITDAT,CCC,CYY,CMM,CDD
          REP       " 0",SIITDAT
          REPEAT
            CLOCK     TIME,SIITTIM
            PACK      KEY28,SIITWAR,SIITCAT,SIITDAT,SIITTIM,SP70
            CALL      RASIIT1
          UNTIL     OVRCD=1
          CALL      WRSIIT1
.
          ASSIGN    SIBPAQT,SIUSQTY        * Quantity
          ASSIGN    SIBPAQT*SIIAAVC,SIUSCST
.
          MOVE      SIBACST,KEY5
          CALL      RDSICA1
.
          CALL      SINUSAGE
.
          RETURN
.------------------------------------------------------------
. Write Backorder Requisition Details
.------------------------------------------------------------
GETREQ00  PACK      KEY8,ANSB,Z70
          CALL      RSSIRA1
          CALL      RPSIRA1
          IF        OVRCD=1
            MOVE      ZERO,F7
          ELSE
            MOVE      SIRAREQ,F7
          ENDIF
.
          MOVE      SP70,SIRADEL
          PACK      KEY8,SIBAREQ,SP70
          CALL      RDSIRA1
          MOVE      SIRADEL,BACKDEL
.
GETREQ10  ADD       ONE,F7
          PACK      KEY8,ANSB,F7
          CALL      RDSIRA1
          COMPARE   ZERO,OVRCD
          GOTO      GETREQ10 IF EQUAL
.
          UNPACK    KEY8,SIRATYP,SIRAREQ   * Move in details
          MOVE      SIBACST,SIRACST
          MOVE      ZERO,SIRAIND
          PACK      SIRADAT,CCC,CYY,CMM,CDD
          REP       " 0",SIRADAT
          ASSIGN    SIBPAQT*SIIAAVC,SIRATOT
.
          CLEAR     SIRADEL
          APPEND    SIITREF,SIRADEL
          APPEND    SP70,SIRADEL
          RESET     SIRADEL
.
          CALL      WRSIRA1                * Write to Header File
.
          PACK      KEY20,SIRATYP,SIRAREQ,SIBAWAR,SIBACAT
          UNPACK    KEY20,SIRBTYP,SIRBREQ,SIRBWAR,SIRBCAT
          CALL      RASIRB1
          IF        OVRCD=0
            CALL      DESIRA1
            GOTO      GETREQ10
          ELSE
            MOVE      SIBAQTY,SIRBRQT
            MOVE      SIBPAQT,SIRBIQT
            ASSIGN    SIBPAQT*SIIAAVC,SIRBAMT
            UNPACK    SP70,SIRBBCH,SIRBLED,SIRBACC,SIRBSPA
            MOVE      SIRADAT,SIRBDAT
            CALL      WRSIRB1              * Write to Details File
          ENDIF
          RETURN
DEL50000  COMPARE   ZERO,SIIESOH
          GOTO      DEL59000 IF NOT EQUAL
          COMPARE   ZERO,SIIESOO
          GOTO      DEL59100 IF NOT EQUAL
.
          PACK      KEY25,SIIEWAR,SIIECAT,SP70
          CALL      RSSIBA2
          CALL      RKSIBA2
          BRANCH    OVRCD,DEL50100
          MATCH     SIIEWAR,SIBAWAR
          GOTO      DEL50100 IF NOT EQUAL
          MATCH     SIIECAT,SIBACAT
          GOTO      DEL59200 IF EQUAL
.
DEL50100  PACK      KEY28,SIIEWAR,SIIECAT,SP70
          CALL      RSSIIT1
          CALL      RKSIIT1
          BRANCH    OVRCD,DEL50200
          MATCH     SIIEWAR,SIITWAR
          GOTO      DEL50200 IF NOT EQUAL
          MATCH     SIIECAT,SIITCAT
          GOTO      DEL50200 IF NOT EQUAL
          MOVE      "WARNING : Item History will be lost - ",DISPMSG
          BEEP
          CALL      MESSAGE1
.
DEL50200  PACK      KEY12,SIIECAT,SIIEWAR,SP70
          CALL      SISIWK1              * check if stocktake file exists
          IF        OVRCD=0
            CLOSE     SINWRKA1
            CLEAR     DISPMSG
            APPEND    "Stocktake in Progress for this Warehouse - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
            GOTO      DEL59999
          ENDIF
.
DEL51000  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
          CALL     DELQST
          CALL     MESSAGE3
          BRANCH   CEXIT,DEL52000,DEL59800,DEL59900
.
DEL52000  PACK     KEY12,SIIECAT,SIIEWAR
          CALL     RASIIE1
          IF       OVRCD=0
            CALL     DASIIE00                 * Delete Before Audit
            MOVE     FOUR,AUDTTYPE
            CALL     WASIIE00                 * Delete Audit
            CALL     DESIIE1
          ENDIF
          MOVE     TWO,EXIT
          GOTO     DEL59999
.
DEL59000  MOVE      "Stock on Hand is NOT Zero. - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      ONE,EXIT
          GOTO      DEL59999
.
DEL59100  MOVE      "Stock on Order is NOT Zero. - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      ONE,EXIT
          GOTO      DEL59999
.
DEL59200  MOVE      "Outstanding Back Orders for Catalog. - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          MOVE      ONE,EXIT
          GOTO      DEL59999
.
DEL59800  MOVE     ONE,EXIT
          GOTO     DEL59999
.
DEL59900  CALL     CAN50000
          MOVE     TWO,EXIT
          GOTO     DEL59999
.
DEL59999  RETURN
.----------------------------------------------------------------------
. Clear Cross Reference Field
.----------------------------------------------------------------------
MAPMX000  MOVE     SP70,SIIFALI
          RETURN
.
.----------------------------------------------------------------------
. Code to do clear description
.----------------------------------------------------------------------
CLRDES00  MOVE      SP70,SIIFALI
.
CLRDES99  RETURN
.----------------------------------------------------------------------
. Write Cross Reference Field
.----------------------------------------------------------------------
SALI0000  PACK      KEY67,SAVCAT,SP70
          CALL      RDSIIF2
          IF        OVRCD=0
            PACK      KEY67,SIIFCAT,SIIFALI
            CALL      DESIIF2
          ENDIF
SALI0100
          CALL      RKSIIF2
          BRANCH    OVRCD,SALI0200
          MATCH     SAVCAT,SIIFCAT
          GOTO      SALI0200 IF NOT EQUAL
          COMPARE   ZERO,SIIFATY
          GOTO      SALI0100 IF NOT EQUAL
          PACK      KEY67,SIIFCAT,SIIFALI
          CALL      DESIIF2
          GOTO      SALI0100
SALI0200
          MOVE      SP70,KEY5
          CALL      TRSIIF21
          COMPARE   ZERO,OVRCD
          GOTO      SALI0310 IF EQUAL
SALI0300
          CALL      TKSIIF21
          BRANCH    OVRCD,SALI0400
SALI0310
          PACK      KEY67,SAVCAT,SIIFALI
          UNPACK    KEY67,SIIFCAT,SIIFALI
          MOVE      ZERO,SIIFATY
          MATCH     SP70,SIIFALI
          GOTO      SALI0300 IF EQUAL
          CALL      RASIIF2
          IF        OVRCD=1
            CALL      WRSIIF2
          ENDIF
          GOTO      SALI0300
SALI0400  PROC      WRKCT000        * Update Keyword Index
          RETURN
.
BACLIN00  MOVE     SIBTCST,KEY5
          CALL     RDSICA1
          RETURN
BALAN000  MOVE      ZERO,EXIT
          MOVE      ZERO,F12P2
          PACK      KEY8,SP70
          CALL      TSSIBT12
BALAN100  CALL      TKSIBT12
          BRANCH    OVRCD,BALAN200
          ADD       SIBTISS,F12P2
          GOTO      BALAN100
.
BALAN200  MOVE      ZERO,EXIT
          COMPARE   F12P2,TOTALREC
          GOTO      BALAN999 IF EQUAL
          PACK      DISPMSG,SP70,SP70
          CALL      MESSAGE2
.
BALAN300  DISPLAY   *P1:24,*EL,*B,"Received :",*V2LON,TOTALREC,*HOFF:
                    "  Allocated :",*V2LON,F12P2,*HOFF," Continue (":
                    *V2LON,"Y",*HOFF,"/",*V2LON,"N",*HOFF,") ? "
          KEYIN     *P71:24,*V2LON,ANS
          REP       UPPLOW,ANS
          MATCH     ANSY,ANS
          GOTO      BALAN400 IF EQUAL
          MATCH     ANSN,ANS
          GOTO      BALAN300 IF NOT EQUAL
          MOVE      ONE,EXIT
          CALL      MESSAGE3
          GOTO      BALAN999
.
BALAN400
          IF        F12P2>TOTALREC
            MOVE      ONE,EXIT
          ELSE
            MOVE      ZERO,EXIT
          ENDIF
.
          CALL      MESSAGE3
.
BALAN999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSCKIKY    
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
          INC       CSMCIAIO/INC
          INC       IBAGKIKY    
          INC       IBAGSTIO/INC
          INC       IBAGSTKY    
          INC       PHAPLUIO/INC
          INC       PHAPLUKY    
          INC       SINBACIO/INC
          INC       SINBATIO/INC
          INC       SINBOTIO/INC
          INC       SINBPSIO/INC
          INC       SINCCAIO/INC
          INC       SINCCBIO/INC
          INC       SINCCEIO/INC
          INC       SINCCFIO/INC
          INC       SINCCHIO/INC
          INC       SINCGBIO/INC
          INC       SINCIAIO/INC
          INC       SINCIAKY    
          INC       SINCIBIO/INC
          INC       SINCICIO/INC
          INC       SINCIDIO/INC
          INC       SINCIEIO/INC
          INC       SINCIFIO/INC
          INC       SINCIGIO/INC
          INC       SINCIHIO/INC
          INC       SINCIIIO/INC
          INC       SINCIJIO/INC
          INC       SINCODIO/INC
          INC       SINCODKY    
          INC       SINCOSIO/INC
          INC       SINFACIO/INC
          INC       SINFACKY    
          INC       SINIMPIO/INC
          INC       SINITMIO/INC
          INC       SINKCTPR    
          INC       SINNATIO/INC
          INC       SINPERCD    
          INC       SINPERIO/INC
          INC       SINPOAIO/INC
          INC       SINPOCIO/INC
          INC       SINPRQIO/INC
          INC       SINREAIO/INC
          INC       SINREBIO/INC
          INC       SINSCDIO/INC
          INC       SINSCMIO/INC
          INC       SINSUAIO/INC
          INC       SINSUAKY    
          INC       SINSUBIO/INC
          INC       SINUSAGE    
          INC       SINWARIO/INC
          INC       SINWRKCD    
          INC       SINWRKIO/INC
          INC       SINWSEIO/INC
          INC       SINWSEKY    
.
          INC       STDGENCD
.
