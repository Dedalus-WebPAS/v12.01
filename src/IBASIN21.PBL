.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.01.00"
.-------------------------------------------------------
. V9.04.01  13.04.2005 Peter Vela CAR 59696
.           Recompiled for SINSUAFD
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.01  04.03.2002 Sai - SRF 13781
.           Added new field in Total Receival Details screen to show the
.           the total value of order received, added TOTREC00.
. VF.09.B01 15.11.2000 Charles Handaya
.           Modification of Warehouse Security
.-------------------------------------------------------
. VF.00.02  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.01  24.04.1999 Sandra Barcham
.           Print User Defined reference 2 for HSH V6.00.20
.           srf 627759 quote 9231
.-------------------------------------------------------
CANCDATE  DIM       10
COMPDATE  DIM       10
DEFCDESC  DIM       40
FORM10    FORM      10
MYCOL     FORM      2
MYVERT    FORM      2
PRINDATE  DIM       10
PURODATE  DIM       10
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN21
.   Function      :   Purchase Order Enquiries                
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSIMSFD/INC
          INC       APSINPFD/INC
          INC       APSMASFD/INC
          INC       IBAPASFD/INC
          INC       SINCCAFD/INC
          INC       SINCIAFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINFACFD/INC
          INC       SINNATFD/INC
          INC       SINOQCFD/INC
          INC       SINORIFD/INC
          INC       SINPERFD/INC
          INC       SINPOAFD/INC
          INC       SINPOBFD/INC
          INC       SINPOCFD/INC
          INC       SINPODFD/INC
          INC       SINPOFFD/INC
          INC       SINSUAFD/INC
          INC       SINTMPDF/INC
          INC       SINTRNFD/INC
          INC       SINWARFD/INC
          INC       SINWSEFD/INC
.=========================
.Local Variable Definition
.-------------------------
CONFDESC  DIM      30 * Scr 00 Fld    18
MESSDESC  DIM      30 * Scr 00 Fld    19
.
.Word Processor File * Scr 00 Fld    20
.
NAMSIPB1  INIT      "Wsipb1"
FILSIPB1  DIM       8
.
CODEDES1  DIM      30 * Scr 00 Fld    33
CODEDES2  DIM      30 * Scr 00 Fld    34
TRANSSTA  DIM      20 * Scr 00 Fld    36
.
.Word Processor File * Scr 01 Fld    41
.
NAMSIPD1  INIT      "Wsipd1"
FILSIPD1  DIM       8
.
.
.    Multi Item Key Fields Scr 02 Fld     1
.-------------------------------------------------------
SIPC1NAM  INIT      "SIPC1"
SIPC1END  FORM      1   * End Display
SIPC1SNO  FORM      5   * Number of Items on the Screen
SIPC1MKY  DIM       127 * Match Key 
SIPC1EKY  DIM       127 * End Key
SIPC1SKY  DIM       127 * Start Key
SIPC1IDX  INIT      " 132 UC1-5"
SIPC1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIPC1FNM  DIM       8  * Filename
SIPC1CNT  FORM      3  * Number of Items on Screen
UNITCOST  DIM      14 * Scr 02 Fld    14
TRANSST2  DIM      40 * Scr 03 Fld     3
.
.    Multi Item Key Fields Scr 04 Fld     3
.-------------------------------------------------------
SIPF1NAM  INIT      "SIPF1"
SIPF1END  FORM      1   * End Display
SIPF1SNO  FORM      5   * Number of Items on the Screen
SIPF1MKY  DIM       127 * Match Key 
SIPF1EKY  DIM       127 * End Key
SIPF1SKY  DIM       127 * Start Key
SIPF1IDX  INIT      " 132 UC1-5"
SIPF1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIPF1FNM  DIM       8  * Filename
SIPF1CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 06 Fld     1
.-------------------------------------------------------
SIPF2NAM  INIT      "SIPF2"
SIPF2END  FORM      1   * End Display
SIPF2SNO  FORM      5   * Number of Items on the Screen
SIPF2MKY  DIM       127 * Match Key 
SIPF2EKY  DIM       127 * End Key
SIPF2SKY  DIM       127 * Start Key
SIPF2IDX  INIT      " 132 UC1-5"
SIPF2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIPF2FNM  DIM       8  * Filename
SIPF2CNT  FORM      3  * Number of Items on Screen
RECUSDT   DIM       7 * Scr 06 Fld    59
TOTALRED  FORM     12.2 * Scr 06 Fld    70
.
.    Multi Item Key Fields Scr 07 Fld     9
.-------------------------------------------------------
SIQC3NAM  INIT      "SIQC3"
SIQC3END  FORM      1   * End Display
SIQC3SNO  FORM      5   * Number of Items on the Screen
SIQC3MKY  DIM       127 * Match Key 
SIQC3EKY  DIM       127 * End Key
SIQC3SKY  DIM       127 * Start Key
SIQC3IDX  INIT      " 132 UC1-5"
SIQC3FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIQC3FNM  DIM       8  * Filename
SIQC3CNT  FORM      3  * Number of Items on Screen
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN21"
PRGNAM    INIT      "Purchase Order Enquiries                "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      ONAT0000
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIPB1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIPD1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     SIPC1FL1,DELETE
.
          CLOSE     SIPF1FL1,DELETE
.
          CLOSE     SIPF2FL1,DELETE
.
          CLOSE     SIQC3FL1,DELETE
.
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening  ihapassf           ";
          OPEN      IHAPASS1,"ihapassf"          
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA1,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA2,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA2,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA3,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA2,"sincodaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA1,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA2,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinoqcaf";
          OPEN      SINOQCA1,"sinoqcaf"
          DISPLAY   *P56:24,"Opening sinoqcaf";
          OPEN      SINOQCA2,"sinoqcaf"
          DISPLAY   *P56:24,"Opening sinoqcaf";
          OPEN      SINOQCA3,"sinoqcaf"
          DISPLAY   *P56:24,"Opening sinoqcaf";
          OPEN      SINOQCA4,"sinoqcaf"
          DISPLAY   *P56:24,"Opening sinoriaf";
          OPEN      SINORIA1,"sinoriaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA1,"sinperaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA2,"sinperaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA1,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA3,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA4,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpobaf";
          OPEN      SINPOBA1,"sinpobaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA1,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpodaf";
          OPEN      SINPODA1,"sinpodaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA1,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA2,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA2,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA3,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sintrnaf";
          OPEN      SINTRNA1,"sintrnaf"
          DISPLAY   *P56:24,"Opening sintrnaf";
          OPEN      SINTRNA2,"sintrnaf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA2,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA1,"sinwseaf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA2,"sinwseaf"
.--------------------------------------------------------
. Initialise Wp Filename for Additional Comments (Purchase Head)
.--------------------------------------------------------
          PACK      FILSIPB1,NAMSIPB1,PORT
          REP       " 0",FILSIPB1
          DISPLAY   *P56:24,"Create & Open ",FILSIPB1;
          PREP      TEMPWORD,FILSIPB1
.
.--------------------------------------------------------
. Initialise Wp Filename for Purchase Order Item Comments       
.--------------------------------------------------------
          PACK      FILSIPD1,NAMSIPD1,PORT
          REP       " 0",FILSIPD1
          DISPLAY   *P56:24,"Create & Open ",FILSIPD1;
          PREP      TEMPWORD,FILSIPD1
.
.--------------------------------------------------------
. Initialise Batch Screen Item Number                        
.--------------------------------------------------------
          MOVE     ZERO,SIPC1SNO
          MOVE     "02    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIPC1SNO
            ENDIF
          ENDIF
          PACK      SIPC1FNM,ANST,SIPC1NAM,PORT
          REP       " 0",SIPC1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIPC1FL1,SIPC1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIPC1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIPC1FNM,SIPC1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIPC1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIPC1FL1,SIPC1FNM
.--------------------------------------------------------
. Initialise Batch Screen Receival Number                    
.--------------------------------------------------------
          MOVE     ZERO,SIPF1SNO
          MOVE     "04    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIPF1SNO
            ENDIF
          ENDIF
          PACK      SIPF1FNM,ANST,SIPF1NAM,PORT
          REP       " 0",SIPF1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIPF1FL1,SIPF1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIPF1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIPF1FNM,SIPF1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIPF1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIPF1FL1,SIPF1FNM
.--------------------------------------------------------
. Initialise Batch Screen Receival Number                    
.--------------------------------------------------------
          MOVE     ZERO,SIPF2SNO
          MOVE     "06    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIPF2SNO
            ENDIF
          ENDIF
          PACK      SIPF2FNM,ANST,SIPF2NAM,PORT
          REP       " 0",SIPF2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIPF2FL1,SIPF2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIPF2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIPF2FNM,SIPF2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIPF2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIPF2FL1,SIPF2FNM
.--------------------------------------------------------
. Initialise Batch Screen Requisition ID                     
.--------------------------------------------------------
          MOVE     ZERO,SIQC3SNO
          MOVE     "07    9",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIQC3SNO
            ENDIF
          ENDIF
          PACK      SIQC3FNM,ANST,SIQC3NAM,PORT
          REP       " 0",SIQC3FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIQC3FL1,SIQC3FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIQC3FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIQC3FNM,SIQC3IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIQC3FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIQC3FL1,SIQC3FNM
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Purchase Order Enquiry Options     
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Purchase Order Detail Item         
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Purchase Order Summary             
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Transmission Details               
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Receival Details                   
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Receival Details                   
          ENDIF
          MATCH     "06",SCRID
          IF         @EQUAL
            CALL       PS06L000   * Total Receival Details             
          ENDIF
          MATCH     "07",SCRID
          IF         @EQUAL
            CALL       PS07L000   * Purchase Requisition Summary       
          ENDIF
          MATCH     "08",SCRID
          IF         @EQUAL
            CALL       PS08L000   * Purchase Requisition Details       
          ENDIF
          RETURN
.--------------------------------
. Screen - Purchase Order Enquiry Options     
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Order Enquiry Options     
.-------------------------------------------------------
CF00L000
          MOVE      SP70,SIPAORI 
          MOVE      SP70,SIPAICN 
          MOVE      SP70,SIPASCN 
          MOVE      SP70,SIPADEL 
          MOVE      SP70,SIPAMES 
          MOVE      SP70,SIPADIN 
          MOVE      SP70,SIPAIDP 
          MOVE      SP70,SIPAUR1 
          MOVE      SP70,SIPAUR2 
          MOVE      SP70,SIPAUD1 
          MOVE      SP70,SIPAUD2 
          MOVE      SP70,SIPAUC1 
          MOVE      SP70,SIPAUC2 
          MOVE      SP70,SIPAUY1 
          MOVE      SP70,SIPAUY2 
          MOVE      SP70,SIORNAME
          MOVE      SP70,SIPACON 
          MOVE      SP70,CONFDESC
          MOVE      SP70,MESSDESC
          MOVE      SP70,SIPAPON 
          MOVE      ZERO,TOTALORD
          MOVE      SP70,SIPASUP 
          MOVE      SP70,APMASN1 
          MOVE      SP70,SIOREXT 
          MOVE      SP70,SIPEPER 
          MOVE      SP70,SIPEYEAR
          MOVE      SP70,CODEDES1
          MOVE      SP70,CODEDES2
          MOVE      SP70,TRANSSTA
          MOVE      SP70,SIPADCM 
          MOVE      SP70,SIPADCN 
          MOVE      SP70,APMASTEL
          MOVE      SP70,SIPACST 
          MOVE      SP70,SICADESC
          MOVE      SP70,SIPAWAR 
          MOVE      SP70,SIWADES 
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Order Enquiry Options     
.--------------------------------------------------------
KY00L000
.
KY00L110
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      KSIPA000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      SIPAPON,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Order Enquiry Options     
.---------------------------------------------------------
WP00L000
          PREP     TEMPWORD,FILSIPB1
          PACK     KEY10,SIPAPON,SP70
          MOVE     KEY10,SAVKEY80
          SETLPTR  SAVKEY80,7 
          CALL      RDSIPB1 
          IF        OVRCD=0
            CALL      RPSIPB1 
          ENDIF
WP00L100
          CALL     RKSIPB1 
          BRANCH   OVRCD,WP00L105
          PACK     KEY10,SIPBPON,SIPBLIN
          MATCH    SAVKEY80,KEY10   
          GOTO     WP00L105 IF NOT EQUAL
          PACK     VAR,SIPBCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIPBCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP00L100
WP00L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Order Enquiry Options     
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Order Enquiry Options     
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Order Enquiry Options     
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L101,PS00L102,PS00L103,PS00L104:
                            PS00L105,PS00L106,PS00L107,PS00L108:
                            PS00L109,PS00L110,PS00L111,PS00L112:
                            PS00L113,PS00L114,PS00L115,PS00L116:
                            PS00L117,PS00L118,PS00L119,PS00L120:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L121,PS00L122,PS00L123:
                            PS00L999,PS00L124,PS00L125,PS00L126:
                            PS00L127,PS00L128,PS00L999,PS00L129:
                            PS00L999,PS00L130,PS00L131,PS00L999:
                            PS00L999,PS00L132,PS00L133,PS00L134:
                            PS00L135,PS00L136,PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      SIPAORI,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      SIPAICN,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      SIPASCN,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      SIPADEL,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      SIPAMES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      SIPAIDP,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      SIPAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      SIPAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          UNPACK    SIPAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          UNPACK    SIPAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      SIPAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      SIPAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      SIPACON,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      CONFDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      MESSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE     FILSIPB1,WORDNAME
          CALL     DISPWORD
          GOTO     PS00L999
.
PS00L121
          MOVE      TOTALORD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      SIPASUP,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      SIOREXT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      SIPEPER,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      SIPEYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          MOVE      CODEDES1,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          MOVE      CODEDES2,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L129
          MOVE      TRANSSTA,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L130
          UNPACK    SIPADCM,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L131
          UNPACK    SIPADCN,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L132
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L133
          MOVE      SIPACST,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L134
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L135
          MOVE      SIPAWAR,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L136
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Order Enquiry Options     
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L101:
                            SF00L006,SF00L006,SF00L102,SF00L103:
                            SF00L104,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L105,SF00L006:
                            SF00L106,SF00L006,SF00L006,SF00L107:
                            SF00L108,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L109
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L101:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "12",SCPSROW
              MOVE     " 10",SCPSCOL
              MOVE     " 60",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIPB1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIPB1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF00L001
.
SF00L102
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC02L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L105
          CALL      REDITM00
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC03L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC06L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L108
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC07L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   22",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L109
          CALL      PPUR0000
          GOTO      SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Purchase Order Detail Item         
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 8",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Order Detail Item         
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Order Detail Item         
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Order Detail Item         
.---------------------------------------------------------
WP01L000
          PREP     TEMPWORD,FILSIPD1
          PACK     KEY13,SIPCPON,SIPCITM,SP70
          MOVE     KEY13,SAVKEY80
          SETLPTR  SAVKEY80,10
          CALL      RDSIPD1 
          IF        OVRCD=0
            CALL      RPSIPD1 
          ENDIF
WP01L100
          CALL     RKSIPD1 
          BRANCH   OVRCD,WP01L105
          PACK     KEY13,SIPDPON,SIPDITM,SIPDLIN
          MATCH    SAVKEY80,KEY13   
          GOTO     WP01L105 IF NOT EQUAL
          PACK     VAR,SIPDCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIPDCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L100
WP01L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Order Detail Item         
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Order Detail Item         
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Order Detail Item         
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L101,PS01L102,PS01L103,PS01L104:
                            PS01L105,PS01L106,PS01L107,PS01L108:
                            PS01L109,PS01L110,PS01L111,PS01L112:
                            PS01L113,PS01L114,PS01L115,PS01L116:
                            PS01L117,PS01L118,PS01L119,PS01L120:
                            PS01L121,PS01L122,PS01L123,PS01L124:
                            PS01L125,PS01L126,PS01L127,PS01L128:
                            PS01L129,PS01L130,PS01L131,PS01L132:
                            PS01L133,PS01L134,PS01L135,PS01L136:
                            PS01L137,PS01L138,PS01L139,PS01L999:
                            PS01L140,PS01L999,PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      SIPCITM,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      SIPCCST,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      SIPCPRD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      SIPCDAT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      SIPCWAR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      SIPCCAT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      SIPCPN,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      SIPCPD,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      SIPCCON,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          UNPACK    SIPCCDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      SIPCSUT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          UNPACK    SIPCFDD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      SIPCOQT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      SIPCIQT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      SIPCRQT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      SIPCECT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          MOVE      SIPCTCR,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          MOVE      SIPCTIN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE      SIPCOQO,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      SIPCOOP,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          MOVE      SIPCUR1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          MOVE      SIPCUR2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          UNPACK    SIPCUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          UNPACK    SIPCUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPCUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L127
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPCUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L128
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L129
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L130
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L131
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L132
          MOVE      SIIANON,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L133
          MOVE      SIIASUS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L134
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L135
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L136
          MOVE      SICATELE,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L137
          MOVE      SICACONT,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L138
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L139
          MOVE      SISACOMM,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L140
          MOVE     FILSIPD1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Order Detail Item         
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L101:
                            SF01L102,SF01L006,SF01L103
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L102,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "12",SCPSROW
              MOVE     " 10",SCPSCOL
              MOVE     " 60",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIPD1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIPD1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF01L001
.
SF01L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC04L000
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF01L001
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Purchase Order Summary             
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Order Summary             
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Order Summary             
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Order Summary             
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Order Summary             
.---------------------------------------------------------
LM02L000
.---------------------------------------------------------
. Load for :     1 Item Number                        
.---------------------------------------------------------
          UNPACK    SP70,SIPCPON,SIPCITM
          PACK      KEY10,SIPAPON,SP70
          MOVE      KEY10,SIPC1EKY
          STRIP     SIPC1SKY
          SETLPTR   SIPC1EKY,7
          MOVE      SIPC1EKY,SIPC1SKY
          CALL      RDSIPC1 
          IF        OVRCD=0
            CALL      RPSIPC1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP02L000
          MOVE     ZERO,SIPC1CNT
          MOVE     ZERO,SIPC1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP02L600
          MATCH    PRGID,SCPSPID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP02L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP02L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP02L101,DP02L102,DP02L103,DP02L104:
                            DP02L105,DP02L106,DP02L107,DP02L108:
                            DP02L109,DP02L110,DP02L111,DP02L112:
                            DP02L113,DP02L114,DP02L115,DP02L116:
                            DP02L117,DP02L118,DP02L119,DP02L120:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                            DP02L010,DP02L010,DP02L010,DP02L010:
                           DP02L010,DP02L010
          GOTO      DP02L010
.
DP02L101
          PACK      SIPC1MKY,SP70,SP70
          CALL      UPTSIPC1
          IF        SIPC1END=0
            CALL      RKSIPC1 
            IF        OVRCD=0
              PACK      SIPC1MKY,SIPCPON,SIPCITM                                                                
              MATCH     SIPC1EKY,SIPC1MKY
              IF        @EQUAL
                MOVE      ZERO,SIPC1END
                ADD       ONE,SIPC1CNT
                CALL      UPTSIPC1
                MOVE      SIPCITM,VAR      
                CALL      DISPITEM
          CALL      CHKPRICE
              ELSE
                MOVE      ONE,SIPC1END
              ENDIF
            ELSE
              MOVE      ONE,SIPC1END
            ENDIF
          ENDIF
          IF        SIPC1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L102
          IF        SIPC1END=0
            MOVE      SIPCCST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L103
          IF        SIPC1END=0
            MOVE      SIPCPRD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L104
          IF        SIPC1END=0
            MOVE      SIPCDAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L105
          IF        SIPC1END=0
            MOVE      SIPCWAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L106
          IF        SIPC1END=0
            MOVE      SIPCCAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L107
          IF        SIPC1END=0
            MOVE      SIPCPN,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L108
          IF        SIPC1END=0
            MOVE      SIPCPD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L109
          IF        SIPC1END=0
            MOVE      SIPCCON,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L110
          IF        SIPC1END=0
            MOVE      SIPCCDT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L111
          IF        SIPC1END=0
            MOVE      SIPCSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L112
          IF        SIPC1END=0
            MOVE      SIPCEDD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L113
          IF        SIPC1END=0
            MOVE      SIPCOQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L114
          IF        SIPC1END=0
            MOVE      UNITCOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L115
          IF        SIPC1END=0
            MOVE      SIPCUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L116
          IF        SIPC1END=0
            MOVE      SIPCUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L117
          IF        SIPC1END=0
            UNPACK    SIPCUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L118
          IF        SIPC1END=0
            UNPACK    SIPCUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L119
          IF        SIPC1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIPCUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
.
DP02L120
          IF        SIPC1END=0
            MOVE      SICADESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP02L010
DP02L600
          MATCH    "SIPC1",NAMSSFFI
          GOTO     DP02L605 IF NOT EQUAL
          CALL      TOTORD00
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOTALORD,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   49",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIORNAME,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     DP02L999
DP02L605
DP02L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP02L000
.
          MATCH    "SIPC1",NAMSSFFI
          GOTO     FP02L105 IF NOT EQUAL
          PACK     KEY10,SIPC1SKY,SP70
          CALL     RDSIPC1  * Start
          IF       OVRCD=0
            CALL     RPSIPC1  * Start
          ENDIF
          CALL     DP02L000
          GOTO     FP02L999
FP02L105
FP02L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP02L000
.
          MATCH    "SIPC1",NAMSSFFI
          GOTO     LP02L105 IF NOT EQUAL
          PACK     KEY10,SIPC1SKY,Z70
          CALL     RSSIPC1  * End
          IF       OVRCD=1
            CALL     RPSIPC1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPC1SNO
            CALL     RPSIPC1 
            IF       OVRCD=1
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            PACK     SIPC1MKY,SIPCPON,SIPCITM                                                                
            MATCH    SIPC1EKY,SIPC1MKY
            IF       !@EQUAL
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     LP02L999
LP02L105
LP02L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP02L000
.
          MATCH    "SIPC1",NAMSSFFI
          GOTO     PP02L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP02L105
          CALL      RFTSIPC1
          BRANCH   OVRCD,PP02L115
          MOVE      SIPC1MKY,KEY10 
          CALL      RSSIPC1 
PP02L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIPC1SNO
            CALL     RPSIPC1 
            IF       OVRCD=1
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            PACK     SIPC1MKY,SIPCPON,SIPCITM                                                                
            MATCH    SIPC1EKY,SIPC1MKY
            IF       !@EQUAL
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP02L000
          GOTO     PP02L999
PP02L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPC1SNO
            CALL     RKSIPC1 
            IF       OVRCD=1
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            PACK     SIPC1MKY,SIPCPON,SIPCITM                                                                
            MATCH    SIPC1EKY,SIPC1MKY
            IF       !@EQUAL
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP02L999
PP02L120
PP02L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP02L000
          MATCH    "SIPC1",NAMSSFFI
          GOTO     NP02L115 IF NOT EQUAL
NP02L105
          CALL     RKSIPC1 
          BRANCH   OVRCD,NP02L110
          PACK     SIPC1MKY,SIPCPON,SIPCITM                                                                
          MATCH    SIPC1EKY,SIPC1MKY
          GOTO     NP02L110 IF NOT EQUAL
          CALL     RPSIPC1 
          CALL     DP02L000
          GOTO     NP02L999
NP02L110
          CALL     RPSIPC1 
          BEEP
          GOTO     NP02L999
NP02L115
NP02L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT02L000
CT02L105
CT02L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Purchase Order Summary             
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     1 Item Number                        
.---------------------------------------------------------
UPTSIPC1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPC1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIPC1FL1,KEY5;SCPSROW,SCPSCOL,SIPC1MKY
          ELSE
            UPDATE    SIPC1FL1;SCPSROW,SCPSCOL,SIPC1MKY
          ENDIF
          RETURN
RDTSIPC1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPC1FL1,KEY5;SCPSROW,SCPSCOL,SIPC1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIPC1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIPC1FL1,KEY5;;
          READKS    SIPC1FL1;SCPSROW,SCPSCOL,SIPC1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIPC1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Order Summary             
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP02L000
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Order Summary             
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                           PS02L101,PS02L102,PS02L103,PS02L104:
                            PS02L105,PS02L106,PS02L107,PS02L108:
                            PS02L109,PS02L999,PS02L110,PS02L111:
                            PS02L112,PS02L113,PS02L114,PS02L115:
                            PS02L116,PS02L117,PS02L118,PS02L119:
                            PS02L120,PS02L121,PS02L122,PS02L999:
                           PS02L123,PS02L999
          GOTO     PS02L999
.
PS02L101
          CALL      TOTORD00
          MOVE      TOTALORD,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      SIPAPON,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      SIPASUP,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      SIPAORI,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      SIPAICN,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      SIPASCN,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      SIPADEL,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      SIPAMES,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      SIPACON,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      SIPAIDP,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      SIPAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      SIPAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          UNPACK    SIPAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          UNPACK    SIPAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L116
          MOVE      SIPAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L117
          MOVE      SIPAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L120
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L121
          MOVE      CONFDESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L122
          MOVE      MESSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L123
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Order Summary             
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L101,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L102,SF02L103,SF02L104,SF02L105:
                            SF02L006,SF02L006,SF02L106,SF02L006:
                           SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                           SF02L006,SF02L107
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L101,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                           SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L101
          CALL      SELECTED
          BRANCH    EXIT,SF02L001
          COMPARE   ONE,ACCEPT
          GOTO      SF02L001 IF EQUAL
          CALL      RDTSIPC1
          IF        OVRCD=1
            BEEP
            GOTO      SF02L001
          ENDIF
          MATCH     SP70,SIPC1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF02L001
          ENDIF
          MOVE      SIPC1MKY,KEY10 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELITM00
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIPC1
          IF        OVRCD=1
            CALL      FP02L000
          ELSE
            MOVE      SIPC1MKY,KEY10 
            CALL      RSSIPC1 
            CALL      RPSIPC1 
            CALL      DP02L000
          ENDIF
          GOTO     SF02L001
.
SF02L102
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP02L000
          GOTO     SF02L001
.
SF02L103
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP02L000
          GOTO     SF02L001
.
SF02L104
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP02L000
          GOTO     SF02L001
.
SF02L105
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP02L000
          GOTO     SF02L001
.
SF02L106
.
.
          MOVE      "   53",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   53",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PPUR0000
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      DF02L000
          GOTO      SF02L001
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Transmission Details               
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
          CALL      SETSCR03
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Transmission Details               
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Transmission Details               
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Transmission Details               
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Transmission Details               
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Transmission Details               
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Transmission Details               
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L101,PS03L102:
                            PS03L103,PS03L104,PS03L105,PS03L106:
                            PS03L107,PS03L108,PS03L109
          GOTO     PS03L999
.
PS03L101
          MOVE      TRANSST2,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      SITRUSER,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      SECUSER,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      SITRCREA,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      SITRORG,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          UNPACK    SITREDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          UNPACK    SITRTDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      SITRTNUM,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Transmission Details               
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Receival Details                   
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "11",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Receival Details                   
.-------------------------------------------------------
CF04L000
          MOVE      SP70,SIPFREC 
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Receival Details                   
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Receival Details                   
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Receival Details                   
.---------------------------------------------------------
LM04L000
.---------------------------------------------------------
. Load for :     3 Receival Number                    
.---------------------------------------------------------
          UNPACK    SP70,SIPFPON,SIPFITM,SIPFREC
          PACK      KEY12,SIPCPON,SIPCITM,SP70
          MOVE      KEY12,SIPF1EKY
          STRIP     SIPF1SKY
          SETLPTR   SIPF1EKY,10
          MOVE      SIPF1EKY,SIPF1SKY
          CALL      RDSIPF1 
          IF        OVRCD=0
            CALL      RPSIPF1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP04L000
          MOVE     ZERO,SIPF1CNT
          MOVE     ZERO,SIPF1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP04L600
          MATCH    PRGID,SCPSPID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP04L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP04L010,DP04L010,DP04L101,DP04L010:
                            DP04L010,DP04L010,DP04L010,DP04L010:
                            DP04L010,DP04L102,DP04L103,DP04L104:
                            DP04L105,DP04L106,DP04L107,DP04L108
          GOTO      DP04L010
.
DP04L101
          PACK      SIPF1MKY,SP70,SP70
          CALL      UPTSIPF1
          IF        SIPF1END=0
            CALL      RKSIPF1 
            IF        OVRCD=0
              PACK      SIPF1MKY,SIPFPON,SIPFITM,SIPFREC                                                        
              MATCH     SIPF1EKY,SIPF1MKY
              IF        @EQUAL
                MOVE      ZERO,SIPF1END
                ADD       ONE,SIPF1CNT
                CALL      UPTSIPF1
          CALL      REDITB00
                MOVE      SIPFREC,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,SIPF1END
              ENDIF
            ELSE
              MOVE      ONE,SIPF1END
            ENDIF
          ENDIF
          IF        SIPF1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L102
          IF        SIPF1END=0
            UNPACK    SIPFDAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L103
          IF        SIPF1END=0
            MOVE      SIPFDEL,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L104
          IF        SIPF1END=0
            MOVE      SIPFQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L105
          IF        SIPF1END=0
            MOVE      SIPFCST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L106
          IF        SIPF1END=0
            MOVE      SIPFSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L107
          IF        SIPF1END=0
            UNPACK    SIPFNDD,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L108
          IF        SIPF1END=0
            UNPACK    SIPFDUP,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
DP04L600
          MATCH    "SIPF1",NAMSSFFI
          GOTO     DP04L605 IF NOT EQUAL
          GOTO     DP04L999
DP04L605
DP04L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP04L000
.
          MATCH    "SIPF1",NAMSSFFI
          GOTO     FP04L105 IF NOT EQUAL
          PACK     KEY12,SIPF1SKY,SP70
          CALL     RDSIPF1  * Start
          IF       OVRCD=0
            CALL     RPSIPF1  * Start
          ENDIF
          CALL     DP04L000
          GOTO     FP04L999
FP04L105
FP04L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP04L000
.
          MATCH    "SIPF1",NAMSSFFI
          GOTO     LP04L105 IF NOT EQUAL
          PACK     KEY12,SIPF1SKY,Z70
          CALL     RSSIPF1  * End
          IF       OVRCD=1
            CALL     RPSIPF1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPF1SNO
            CALL     RPSIPF1 
            IF       OVRCD=1
              MOVE     SIPF1SNO,SECTOR
            ENDIF
            PACK     SIPF1MKY,SIPFPON,SIPFITM,SIPFREC                                                        
            MATCH    SIPF1EKY,SIPF1MKY
            IF       !@EQUAL
              MOVE     SIPF1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     LP04L999
LP04L105
LP04L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP04L000
.
          MATCH    "SIPF1",NAMSSFFI
          GOTO     PP04L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP04L105
          CALL      RFTSIPF1
          BRANCH   OVRCD,PP04L115
          MOVE      SIPF1MKY,KEY12 
          CALL      RSSIPF1 
PP04L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIPF1SNO
            CALL     RPSIPF1 
            IF       OVRCD=1
              MOVE     SIPF1SNO,SECTOR
            ENDIF
            PACK     SIPF1MKY,SIPFPON,SIPFITM,SIPFREC                                                        
            MATCH    SIPF1EKY,SIPF1MKY
            IF       !@EQUAL
              MOVE     SIPF1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     PP04L999
PP04L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPF1SNO
            CALL     RKSIPF1 
            IF       OVRCD=1
              MOVE     SIPF1SNO,SECTOR
            ENDIF
            PACK     SIPF1MKY,SIPFPON,SIPFITM,SIPFREC                                                        
            MATCH    SIPF1EKY,SIPF1MKY
            IF       !@EQUAL
              MOVE     SIPF1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP04L999
PP04L120
PP04L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP04L000
          MATCH    "SIPF1",NAMSSFFI
          GOTO     NP04L115 IF NOT EQUAL
NP04L105
          CALL     RKSIPF1 
          BRANCH   OVRCD,NP04L110
          PACK     SIPF1MKY,SIPFPON,SIPFITM,SIPFREC                                                        
          MATCH    SIPF1EKY,SIPF1MKY
          GOTO     NP04L110 IF NOT EQUAL
          CALL     RPSIPF1 
          CALL     DP04L000
          GOTO     NP04L999
NP04L110
          CALL     RPSIPF1 
          BEEP
          GOTO     NP04L999
NP04L115
NP04L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT04L000
CT04L105
CT04L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Receival Details                   
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Receival Number                    
.---------------------------------------------------------
UPTSIPF1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPF1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIPF1FL1,KEY5;SCPSROW,SCPSCOL,SIPF1MKY
          ELSE
            UPDATE    SIPF1FL1;SCPSROW,SCPSCOL,SIPF1MKY
          ENDIF
          RETURN
RDTSIPF1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPF1FL1,KEY5;SCPSROW,SCPSCOL,SIPF1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIPF1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIPF1FL1,KEY5;;
          READKS    SIPF1FL1;SCPSROW,SCPSCOL,SIPF1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIPF1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Receival Details                   
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
          MOVE      "SIPF1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP04L000
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Receival Details                   
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Receival Details                   
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L103:
                            SF04L104,SF04L006,SF04L006,SF04L105:
                            SF04L106,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L006,SF04L006
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L102,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          MOVE      "SIPF1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
          CALL      SELECTED
          BRANCH    EXIT,SF04L001
          COMPARE   ONE,ACCEPT
          GOTO      SF04L001 IF EQUAL
          CALL      RDTSIPF1
          IF        OVRCD=1
            BEEP
            GOTO      SF04L001
          ENDIF
          MATCH     SP70,SIPF1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF04L001
          ENDIF
          MOVE      SIPF1MKY,KEY12 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELITB00
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIPF1
          IF        OVRCD=1
            CALL      FP04L000
          ELSE
            MOVE      SIPF1MKY,KEY12 
            CALL      RSSIPF1 
            CALL      RPSIPF1 
            CALL      DP04L000
          ENDIF
          GOTO     SF04L001
.
SF04L103
          MOVE      "SIPF1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NP04L000
          GOTO     SF04L001
.
SF04L104
          MOVE      "SIPF1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PP04L000
          GOTO     SF04L001
.
SF04L105
          MOVE      "SIPF1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L106
          MOVE      "SIPF1",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LP04L000
          GOTO     SF04L001
SF04L990  MOVE      FOUR,EXIT * Exit Char Exit
SF04L999  RETURN
.--------------------------------
. Screen - Receival Details                   
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "12",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC05L200
          CALL      CF05L000 * Clear Fields
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Receival Details                   
.-------------------------------------------------------
CF05L000
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Receival Details                   
.--------------------------------------------------------
KY05L000
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Receival Details                   
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Receival Details                   
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Receival Details                   
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Receival Details                   
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L999,PS05L101,PS05L999:
                           PS05L999,PS05L999,PS05L999,PS05L999:
                           PS05L999,PS05L102,PS05L103,PS05L104:
                            PS05L105,PS05L106,PS05L107,PS05L108
          GOTO     PS05L999
.
PS05L101
          MOVE      SIPFREC,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          UNPACK    SIPFDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L103
          MOVE      SIPFDEL,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L104
          MOVE      SIPFQTY,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L105
          MOVE      SIPFCST,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L106
          MOVE      SIPFSUT,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L107
          UNPACK    SIPFNDD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L108
          UNPACK    SIPFDUP,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Receival Details                   
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L101,SF05L006,SF05L006:
                           SF05L006,SF05L006,SF05L006,SF05L006:
                           SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L020:
                           SF05L020,SF05L020,SF05L020,SF05L020:
                           SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
.
SF05L101
          MOVE      ZERO,EXIT
          GOTO      SF05L999
SF05L990  MOVE      FOUR,EXIT * Exit Char Exit
SF05L999  RETURN
.--------------------------------
. Screen - Total Receival Details             
.--------------------------------
SC06L000
SC06L100
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC06L200
          CALL      CF06L000 * Clear Fields
SC06L300
          CALL      KY06L000 * Enter Key Fields
          BRANCH    EXIT,SC06L999,SC06L999
SC06L400
          CALL      WP06L000 * Load any WP Details
SC06L500
          CALL      LM06L000 * Load any Batch Details
SC06L600
          CALL      DF06L000 * Display Fields
SC06L700
          CALL      SF06L000 * Select Fields
          BRANCH    EXIT,SC06L100,SC06L100,SC06L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC06L800
SC06L900
SC06L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Total Receival Details             
.-------------------------------------------------------
CF06L000
CF06L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Total Receival Details             
.--------------------------------------------------------
KY06L000
          MOVE      ZERO,EXIT
          GOTO      KY06L999
.
KY06L900  MOVE      ONE,EXIT
KY06L999  RETURN
.---------------------------------------------------------
. Load WP files for : Total Receival Details             
.---------------------------------------------------------
WP06L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Total Receival Details             
.---------------------------------------------------------
LM06L000
.---------------------------------------------------------
. Load for :     1 Receival Number                    
.---------------------------------------------------------
          UNPACK    SP70,SIPFPON,SIPFREC,SIPFITM
          PACK      KEY12,SIPAPON,SP70
          MOVE      KEY12,SIPF2EKY
          STRIP     SIPF2SKY
          SETLPTR   SIPF2EKY,7
          MOVE      SIPF2EKY,SIPF2SKY
          CALL      RDSIPF2 
          IF        OVRCD=0
            CALL      RPSIPF2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP06L000
          MOVE     ZERO,SIPF2CNT
          MOVE     ZERO,SIPF2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP06L600
          MATCH    PRGID,SCPSPID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP06L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP06L101,DP06L102,DP06L103,DP06L104:
                            DP06L105,DP06L106,DP06L107,DP06L108:
                            DP06L109,DP06L110,DP06L111,DP06L112:
                            DP06L113,DP06L114,DP06L115,DP06L116:
                            DP06L117,DP06L118,DP06L119,DP06L120:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L121,DP06L010,DP06L122:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L123,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010,DP06L010,DP06L010:
                           DP06L010,DP06L124,DP06L125,DP06L126:
                            DP06L127,DP06L128,DP06L129,DP06L010:
                           DP06L010,DP06L010,DP06L010,DP06L010:
                           DP06L010,DP06L010,DP06L010,DP06L010:
                           DP06L010,DP06L010
          GOTO      DP06L010
.
DP06L101
          PACK      SIPF2MKY,SP70,SP70
          CALL      UPTSIPF2
          IF        SIPF2END=0
            CALL      RKSIPF2 
            IF        OVRCD=0
              PACK      SIPF2MKY,SIPFPON,SIPFREC,SIPFITM                                                        
              MATCH     SIPF2EKY,SIPF2MKY
              IF        @EQUAL
                MOVE      ZERO,SIPF2END
                ADD       ONE,SIPF2CNT
                CALL      UPTSIPF2
          CALL      REDITB00
                MOVE      SIPFREC,VAR      
                CALL      DISPITEM
          CALL      CHKPRICE
              ELSE
                MOVE      ONE,SIPF2END
              ENDIF
            ELSE
              MOVE      ONE,SIPF2END
            ENDIF
          ENDIF
          IF        SIPF2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L102
          IF        SIPF2END=0
            MOVE      SIPCCST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L103
          IF        SIPF2END=0
            MOVE      SIPCPRD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L104
          IF        SIPF2END=0
            MOVE      SIPCDAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L105
          IF        SIPF2END=0
            MOVE      SIPCWAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L106
          IF        SIPF2END=0
            MOVE      SIPCCAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L107
          IF        SIPF2END=0
            MOVE      SIPCPN,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L108
          IF        SIPF2END=0
            MOVE      SIPCPD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L109
          IF        SIPF2END=0
            MOVE      SIPCCON,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L110
          IF        SIPF2END=0
            MOVE      SIPCCDT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L111
          IF        SIPF2END=0
            MOVE      SIPCSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L112
          IF        SIPF2END=0
            MOVE      SIPCEDD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L113
          IF        SIPF2END=0
            MOVE      SIPCOQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L114
          IF        SIPF2END=0
            MOVE      UNITCOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L115
          IF        SIPF2END=0
            MOVE      SIPCUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L116
          IF        SIPF2END=0
            MOVE      SIPCUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L117
          IF        SIPF2END=0
            UNPACK    SIPCUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L118
          IF        SIPF2END=0
            UNPACK    SIPCUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L119
          IF        SIPF2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIPCUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L120
          IF        SIPF2END=0
            MOVE      SICADESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L121
          IF        SIPF2END=0
            MOVE      SIPFITM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L122
          IF        SIPF2END=0
            UNPACK    SIPFDAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L123
          IF        SIPF2END=0
            MOVE      SIPFDEL,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L124
          IF        SIPF2END=0
            MOVE      SIPFQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L125
          IF        SIPF2END=0
            MOVE      SIPFCST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L126
          IF        SIPF2END=0
            MOVE      SIPFSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L127
          IF        SIPF2END=0
            UNPACK    SIPFNDD,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L128
          IF        SIPF2END=0
            UNPACK    SIPFDUP,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L129
          IF        SIPF2END=0
            MOVE      RECUSDT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
DP06L600
          MATCH    "SIPF2",NAMSSFFI
          GOTO     DP06L605 IF NOT EQUAL
          CALL      TOTORD00
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOTALORD,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   49",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIORNAME,VAR     
            CALL      DISPITEM
          ENDIF
          CALL      TOTREC00
.
.
          MOVE      "   70",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOTALRED,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     DP06L999
DP06L605
DP06L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP06L000
.
          MATCH    "SIPF2",NAMSSFFI
          GOTO     FP06L105 IF NOT EQUAL
          PACK     KEY12,SIPF2SKY,SP70
          CALL     RDSIPF2  * Start
          IF       OVRCD=0
            CALL     RPSIPF2  * Start
          ENDIF
          CALL     DP06L000
          GOTO     FP06L999
FP06L105
FP06L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP06L000
.
          MATCH    "SIPF2",NAMSSFFI
          GOTO     LP06L105 IF NOT EQUAL
          PACK     KEY12,SIPF2SKY,Z70
          CALL     RSSIPF2  * End
          IF       OVRCD=1
            CALL     RPSIPF2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPF2SNO
            CALL     RPSIPF2 
            IF       OVRCD=1
              MOVE     SIPF2SNO,SECTOR
            ENDIF
            PACK     SIPF2MKY,SIPFPON,SIPFREC,SIPFITM                                                        
            MATCH    SIPF2EKY,SIPF2MKY
            IF       !@EQUAL
              MOVE     SIPF2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     LP06L999
LP06L105
LP06L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP06L000
.
          MATCH    "SIPF2",NAMSSFFI
          GOTO     PP06L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP06L105
          CALL      RFTSIPF2
          BRANCH   OVRCD,PP06L115
          MOVE      SIPF2MKY,KEY12 
          CALL      RSSIPF2 
PP06L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIPF2SNO
            CALL     RPSIPF2 
            IF       OVRCD=1
              MOVE     SIPF2SNO,SECTOR
            ENDIF
            PACK     SIPF2MKY,SIPFPON,SIPFREC,SIPFITM                                                        
            MATCH    SIPF2EKY,SIPF2MKY
            IF       !@EQUAL
              MOVE     SIPF2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     PP06L999
PP06L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPF2SNO
            CALL     RKSIPF2 
            IF       OVRCD=1
              MOVE     SIPF2SNO,SECTOR
            ENDIF
            PACK     SIPF2MKY,SIPFPON,SIPFREC,SIPFITM                                                        
            MATCH    SIPF2EKY,SIPF2MKY
            IF       !@EQUAL
              MOVE     SIPF2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP06L999
PP06L120
PP06L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP06L000
          MATCH    "SIPF2",NAMSSFFI
          GOTO     NP06L115 IF NOT EQUAL
NP06L105
          CALL     RKSIPF2 
          BRANCH   OVRCD,NP06L110
          PACK     SIPF2MKY,SIPFPON,SIPFREC,SIPFITM                                                        
          MATCH    SIPF2EKY,SIPF2MKY
          GOTO     NP06L110 IF NOT EQUAL
          CALL     RPSIPF2 
          CALL     DP06L000
          GOTO     NP06L999
NP06L110
          CALL     RPSIPF2 
          BEEP
          GOTO     NP06L999
NP06L115
NP06L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT06L000
CT06L105
CT06L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Total Receival Details             
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     1 Receival Number                    
.---------------------------------------------------------
UPTSIPF2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPF2FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIPF2FL1,KEY5;SCPSROW,SCPSCOL,SIPF2MKY
          ELSE
            UPDATE    SIPF2FL1;SCPSROW,SCPSCOL,SIPF2MKY
          ENDIF
          RETURN
RDTSIPF2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPF2FL1,KEY5;SCPSROW,SCPSCOL,SIPF2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIPF2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIPF2FL1,KEY5;;
          READKS    SIPF2FL1;SCPSROW,SCPSCOL,SIPF2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIPF2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Total Receival Details             
.---------------------------------------------------------
DF06L000
          BRANCH   ACCEPT,DF06L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF06L900
          MATCH    PRGID,SCPSPID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF06L010 IF NOT EQUAL
.
          CALL     PS06L000 * Display Field
          GOTO     DF06L010
DF06L900
          MOVE      "SIPF2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP06L000
DF06L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Total Receival Details             
.---------------------------------------------------------
PS06L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L101,PS06L102,PS06L103,PS06L104:
                            PS06L105,PS06L106,PS06L107,PS06L108:
                            PS06L109,PS06L999,PS06L110,PS06L111:
                            PS06L112,PS06L113,PS06L114,PS06L115:
                            PS06L116,PS06L117,PS06L118,PS06L119:
                            PS06L120,PS06L121,PS06L122,PS06L999:
                           PS06L123,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                           PS06L999,PS06L999,PS06L999,PS06L999:
                           PS06L999,PS06L999,PS06L999,PS06L999:
                           PS06L999,PS06L124
          GOTO     PS06L999
.
PS06L101
          CALL      TOTORD00
          MOVE      TOTALORD,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L102
          MOVE      SIPAPON,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L103
          MOVE      SIPASUP,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L104
          MOVE      SIPAORI,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L105
          MOVE      SIPAICN,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L106
          MOVE      SIPASCN,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L107
          MOVE      SIPADEL,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L108
          MOVE      SIPAMES,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L109
          UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L110
          MOVE      SIPACON,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L111
          MOVE      SIPAIDP,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L112
          MOVE      SIPAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L113
          MOVE      SIPAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L114
          UNPACK    SIPAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L115
          UNPACK    SIPAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L116
          MOVE      SIPAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L117
          MOVE      SIPAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L120
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L121
          MOVE      CONFDESC,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L122
          MOVE      MESSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L123
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L124
          CALL      TOTREC00
          MOVE      TOTALRED,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
PS06L999
          RETURN
.---------------------------------------------------------
. Selections for : Total Receival Details             
.---------------------------------------------------------
SF06L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF06L001  BRANCH   ACCEPT,SF06L020
.
SF06L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L101,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L102,SF06L103,SF06L104,SF06L105:
                            SF06L006,SF06L006,SF06L106,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                           SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L006,SF06L006:
                           SF06L006,SF06L006,SF06L006,SF06L006:
                           SF06L006,SF06L006,SF06L006,SF06L006:
                           SF06L006,SF06L006
SF06L006  BEEP
          GOTO     SF06L005
SF06L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF06L090
          MATCH    PRGID,SCSLPID
          GOTO     SF06L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF06L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L101,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                           SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                           SF06L020,SF06L020,SF06L020,SF06L020:
                           SF06L020,SF06L020,SF06L020,SF06L020:
                           SF06L020,SF06L020
          GOTO     SF06L020
SF06L090  MOVE     ZERO,ACCEPT
          MOVE      "SIPF2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L101
          CALL      SELECTED
          BRANCH    EXIT,SF06L001
          COMPARE   ONE,ACCEPT
          GOTO      SF06L001 IF EQUAL
          CALL      RDTSIPF2
          IF        OVRCD=1
            BEEP
            GOTO      SF06L001
          ENDIF
          MATCH     SP70,SIPF2MKY
          IF        @EQUAL
            BEEP
            GOTO      SF06L001
          ENDIF
          MOVE      SIPF2MKY,KEY12 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELITC00
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIPF2
          IF        OVRCD=1
            CALL      FP06L000
          ELSE
            MOVE      SIPF2MKY,KEY12 
            CALL      RSSIPF2 
            CALL      RPSIPF2 
            CALL      DP06L000
          ENDIF
          GOTO     SF06L001
.
SF06L102
          MOVE      "SIPF2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP06L000
          GOTO     SF06L001
.
SF06L103
          MOVE      "SIPF2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP06L000
          GOTO     SF06L001
.
SF06L104
          MOVE      "SIPF2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L105
          MOVE      "SIPF2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP06L000
          GOTO     SF06L001
.
SF06L106
.
.
          MOVE      "   53",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   53",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      SF06L999
SF06L990  MOVE      FOUR,EXIT * Exit Char Exit
SF06L999  RETURN
.--------------------------------
. Screen - Purchase Requisition Summary       
.--------------------------------
SC07L000
SC07L100
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC07L200
          CALL      CF07L000 * Clear Fields
SC07L300
          CALL      KY07L000 * Enter Key Fields
          BRANCH    EXIT,SC07L999,SC07L999
SC07L400
          CALL      WP07L000 * Load any WP Details
SC07L500
          CALL      LM07L000 * Load any Batch Details
SC07L600
          CALL      DF07L000 * Display Fields
SC07L700
          CALL      SF07L000 * Select Fields
          BRANCH    EXIT,SC07L100,SC07L100,SC07L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC07L800
SC07L900
SC07L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Requisition Summary       
.-------------------------------------------------------
CF07L000
CF07L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Requisition Summary       
.--------------------------------------------------------
KY07L000
          MOVE      ZERO,EXIT
          GOTO      KY07L999
.
KY07L900  MOVE      ONE,EXIT
KY07L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Requisition Summary       
.---------------------------------------------------------
WP07L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Requisition Summary       
.---------------------------------------------------------
LM07L000
.---------------------------------------------------------
. Load for :     9 Requisition ID                     
.---------------------------------------------------------
          UNPACK    SP70,SIQCORD,SIQCSUP,SIQCPN,SIQCCST,SIQCRID
          PACK      KEY55,SIPAPON,SP70
          MOVE      KEY55,SIQC3EKY
          STRIP     SIQC3SKY
          SETLPTR   SIQC3EKY,7
          MOVE      SIQC3EKY,SIQC3SKY
          CALL      RDSIQC3 
          IF        OVRCD=0
            CALL      RPSIQC3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP07L000
          MOVE     ZERO,SIQC3CNT
          MOVE     ZERO,SIQC3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP07L600
          MATCH    PRGID,SCPSPID
          GOTO     DP07L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP07L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP07L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L101,DP07L010,DP07L010,DP07L010:
                           DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L102,DP07L103,DP07L104:
                            DP07L105,DP07L106,DP07L107,DP07L108:
                            DP07L109,DP07L110,DP07L111,DP07L112:
                            DP07L113,DP07L114,DP07L115,DP07L116:
                            DP07L117,DP07L118,DP07L119,DP07L120:
                            DP07L121,DP07L122,DP07L123,DP07L124:
                            DP07L125,DP07L126,DP07L127,DP07L128:
                            DP07L129,DP07L130,DP07L131,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010
          GOTO      DP07L010
.
DP07L101
          PACK      SIQC3MKY,SP70,SP70
          CALL      UPTSIQC3
          IF        SIQC3END=0
            CALL      RKSIQC3 
            IF        OVRCD=0
              PACK      SIQC3MKY,SIQCORD,SIQCSUP,SIQCPN,SIQCCST,SIQCRID                                         
              MATCH     SIQC3EKY,SIQC3MKY
              IF        @EQUAL
                MOVE      ZERO,SIQC3END
                ADD       ONE,SIQC3CNT
                CALL      UPTSIQC3
          CALL      SCR07DIS
                MOVE      SIQCRID,VAR      
                CALL      DISPITEM
              ELSE
                MOVE      ONE,SIQC3END
              ENDIF
            ELSE
              MOVE      ONE,SIQC3END
            ENDIF
          ENDIF
          IF        SIQC3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L102
          IF        SIQC3END=0
            MOVE      SIQCCST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L103
          IF        SIQC3END=0
            MOVE      SIQCCAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L104
          IF        SIQC3END=0
            MOVE      SIQCUNT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L105
          IF        SIQC3END=0
            MOVE      SIQCPD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L106
          IF        SIQC3END=0
            MOVE      SIQCPN,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L107
          IF        SIQC3END=0
            MOVE      SIQCQTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L108
          IF        SIQC3END=0
            MOVE      SIQCSTA,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L109
          IF        SIQC3END=0
            MOVE      SIQCUID,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L110
          IF        SIQC3END=0
            UNPACK    SIQCDAT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L111
          IF        SIQC3END=0
            MOVE      SIQCTIM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L112
          IF        SIQC3END=0
            MOVE      SIQCPOR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L113
          IF        SIQC3END=0
            UNPACK    SIQCPDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L114
          IF        SIQC3END=0
            MOVE      SIQCPTM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L115
          IF        SIQC3END=0
            MOVE      SIQCPID,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L116
          IF        SIQC3END=0
            MOVE      SIQCPPO,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L117
          IF        SIQC3END=0
            MOVE      SIQCORI,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L118
          IF        SIQC3END=0
            MOVE      SIQCPTY,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L119
          IF        SIQC3END=0
            MOVE      SIQCPQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L120
          IF        SIQC3END=0
            MOVE      UNITCOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L121
          IF        SIQC3END=0
            MOVE      SIQCCAN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L122
          IF        SIQC3END=0
            MOVE      SIQCORD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L123
          IF        SIQC3END=0
            MOVE      SIQCREQ,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L124
          IF        SIQC3END=0
            UNPACK    SIQCEDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L125
          IF        SIQC3END=0
            MOVE      SIQCSUP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L126
          IF        SIQC3END=0
            MOVE      SIQCSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L127
          IF        SIQC3END=0
            MOVE      SIQCPGP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L128
          IF        SIQC3END=0
            MOVE      SIQCCON,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L129
          IF        SIQC3END=0
            UNPACK    SIQCCDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L130
          IF        SIQC3END=0
            MOVE      SICADESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L131
          IF        SIQC3END=0
            MOVE      SIORNAME,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
DP07L600
          MATCH    "SIQC3",NAMSSFFI
          GOTO     DP07L605 IF NOT EQUAL
          GOTO     DP07L999
DP07L605
DP07L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP07L000
.
          MATCH    "SIQC3",NAMSSFFI
          GOTO     FP07L105 IF NOT EQUAL
          PACK     KEY55,SIQC3SKY,SP70
          CALL     RDSIQC3  * Start
          IF       OVRCD=0
            CALL     RPSIQC3  * Start
          ENDIF
          CALL     DP07L000
          GOTO     FP07L999
FP07L105
FP07L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP07L000
.
          MATCH    "SIQC3",NAMSSFFI
          GOTO     LP07L105 IF NOT EQUAL
          PACK     KEY55,SIQC3SKY,Z70
          CALL     RSSIQC3  * End
          IF       OVRCD=1
            CALL     RPSIQC3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIQC3SNO
            CALL     RPSIQC3 
            IF       OVRCD=1
              MOVE     SIQC3SNO,SECTOR
            ENDIF
            PACK     SIQC3MKY,SIQCORD,SIQCSUP,SIQCPN,SIQCCST,SIQCRID                                         
            MATCH    SIQC3EKY,SIQC3MKY
            IF       !@EQUAL
              MOVE     SIQC3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP07L000
          GOTO     LP07L999
LP07L105
LP07L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP07L000
.
          MATCH    "SIQC3",NAMSSFFI
          GOTO     PP07L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP07L105
          CALL      RFTSIQC3
          BRANCH   OVRCD,PP07L115
          MOVE      SIQC3MKY,KEY55 
          CALL      RSSIQC3 
PP07L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIQC3SNO
            CALL     RPSIQC3 
            IF       OVRCD=1
              MOVE     SIQC3SNO,SECTOR
            ENDIF
            PACK     SIQC3MKY,SIQCORD,SIQCSUP,SIQCPN,SIQCCST,SIQCRID                                         
            MATCH    SIQC3EKY,SIQC3MKY
            IF       !@EQUAL
              MOVE     SIQC3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP07L000
          GOTO     PP07L999
PP07L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIQC3SNO
            CALL     RKSIQC3 
            IF       OVRCD=1
              MOVE     SIQC3SNO,SECTOR
            ENDIF
            PACK     SIQC3MKY,SIQCORD,SIQCSUP,SIQCPN,SIQCCST,SIQCRID                                         
            MATCH    SIQC3EKY,SIQC3MKY
            IF       !@EQUAL
              MOVE     SIQC3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP07L999
PP07L120
PP07L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP07L000
          MATCH    "SIQC3",NAMSSFFI
          GOTO     NP07L115 IF NOT EQUAL
NP07L105
          CALL     RKSIQC3 
          BRANCH   OVRCD,NP07L110
          PACK     SIQC3MKY,SIQCORD,SIQCSUP,SIQCPN,SIQCCST,SIQCRID                                         
          MATCH    SIQC3EKY,SIQC3MKY
          GOTO     NP07L110 IF NOT EQUAL
          CALL     RPSIQC3 
          CALL     DP07L000
          GOTO     NP07L999
NP07L110
          CALL     RPSIQC3 
          BEEP
          GOTO     NP07L999
NP07L115
NP07L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT07L000
CT07L105
CT07L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Purchase Requisition Summary       
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     9 Requisition ID                     
.---------------------------------------------------------
UPTSIQC3
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIQC3FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIQC3FL1,KEY5;SCPSROW,SCPSCOL,SIQC3MKY
          ELSE
            UPDATE    SIQC3FL1;SCPSROW,SCPSCOL,SIQC3MKY
          ENDIF
          RETURN
RDTSIQC3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIQC3FL1,KEY5;SCPSROW,SCPSCOL,SIQC3MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIQC3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIQC3FL1,KEY5;;
          READKS    SIQC3FL1;SCPSROW,SCPSCOL,SIQC3MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIQC3MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Requisition Summary       
.---------------------------------------------------------
DF07L000
          BRANCH   ACCEPT,DF07L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF07L900
          MATCH    PRGID,SCPSPID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF07L010 IF NOT EQUAL
.
          CALL     PS07L000 * Display Field
          GOTO     DF07L010
DF07L900
          MOVE      "SIQC3",NAMSSFFI
          MOVE      "    9",ITMSSFFI
          CALL      FP07L000
DF07L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Requisition Summary       
.---------------------------------------------------------
PS07L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS07L101,PS07L102,PS07L103,PS07L104:
                            PS07L105,PS07L106,PS07L107,PS07L108:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                           PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999
          GOTO     PS07L999
.
PS07L101
          MOVE      SIPAPON,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L102
          UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L103
          MOVE      TOTALORD,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L104
          MOVE      SIPASUP,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L105
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L106
          MOVE      SIPASCN,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L107
          MOVE      SIPAORI,VAR      
          CALL      DISPITEM
          GOTO     PS07L999
.
PS07L108
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
PS07L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Requisition Summary       
.---------------------------------------------------------
SF07L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF07L001  BRANCH   ACCEPT,SF07L020
.
SF07L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L101,SF07L006,SF07L006,SF07L006:
                           SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L102,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L103:
                            SF07L104,SF07L006,SF07L006,SF07L105:
                            SF07L106
SF07L006  BEEP
          GOTO     SF07L005
SF07L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF07L090
          MATCH    PRGID,SCSLPID
          GOTO     SF07L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF07L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L101,SF07L020,SF07L020,SF07L020:
                           SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020
          GOTO     SF07L020
SF07L090  MOVE     ZERO,ACCEPT
          MOVE      "SIQC3",NAMSSFFI
          MOVE      "    9",ITMSSFFI
          CALL      FP07L000
          GOTO     SF07L001
.
SF07L101
          CALL      SELECTED
          BRANCH    EXIT,SF07L001
          COMPARE   ONE,ACCEPT
          GOTO      SF07L001 IF EQUAL
          CALL      RDTSIQC3
          IF        OVRCD=1
            BEEP
            GOTO      SF07L001
          ENDIF
          MATCH     SP70,SIQC3MKY
          IF        @EQUAL
            BEEP
            GOTO      SF07L001
          ENDIF
          MOVE      SIQC3MKY,KEY55 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELREQ00
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIQC3
          IF        OVRCD=1
            CALL      FP07L000
          ELSE
            MOVE      SIQC3MKY,KEY55 
            CALL      RSSIQC3 
            CALL      RPSIQC3 
            CALL      DP07L000
          ENDIF
          GOTO     SF07L001
.
SF07L102
          MOVE      ZERO,EXIT
          GOTO      SF07L999
.
SF07L103
          MOVE      "SIQC3",NAMSSFFI
          MOVE      "    9",ITMSSFFI
          CALL      NP07L000
          GOTO     SF07L001
.
SF07L104
          MOVE      "SIQC3",NAMSSFFI
          MOVE      "    9",ITMSSFFI
          CALL      PP07L000
          GOTO     SF07L001
.
SF07L105
          MOVE      "SIQC3",NAMSSFFI
          MOVE      "    9",ITMSSFFI
          CALL      FP07L000
          GOTO     SF07L001
.
SF07L106
          MOVE      "SIQC3",NAMSSFFI
          MOVE      "    9",ITMSSFFI
          CALL      LP07L000
          GOTO     SF07L001
SF07L990  MOVE      FOUR,EXIT * Exit Char Exit
SF07L999  RETURN
.--------------------------------
. Screen - Purchase Requisition Details       
.--------------------------------
SC08L000
SC08L100
          MOVE      "08",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   30",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 8",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC08L200
          CALL      CF08L000 * Clear Fields
          CALL      SETSCR08
SC08L300
          CALL      KY08L000 * Enter Key Fields
          BRANCH    EXIT,SC08L999,SC08L999
SC08L400
          CALL      WP08L000 * Load any WP Details
SC08L500
          CALL      LM08L000 * Load any Batch Details
SC08L600
          CALL      DF08L000 * Display Fields
SC08L700
          CALL      SF08L000 * Select Fields
          BRANCH    EXIT,SC08L100,SC08L100,SC08L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC08L800
SC08L900
SC08L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Requisition Details       
.-------------------------------------------------------
CF08L000
CF08L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Requisition Details       
.--------------------------------------------------------
KY08L000
          MOVE      ZERO,EXIT
          GOTO      KY08L999
.
KY08L900  MOVE      ONE,EXIT
KY08L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Requisition Details       
.---------------------------------------------------------
WP08L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Requisition Details       
.---------------------------------------------------------
LM08L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Requisition Details       
.---------------------------------------------------------
DF08L000
          BRANCH   ACCEPT,DF08L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF08L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF08L900
          MATCH    PRGID,SCPSPID
          GOTO     DF08L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF08L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF08L010 IF NOT EQUAL
.
          CALL     PS08L000 * Display Field
          GOTO     DF08L010
DF08L900
DF08L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Requisition Details       
.---------------------------------------------------------
PS08L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS08L101,PS08L102,PS08L103,PS08L104:
                            PS08L105,PS08L106,PS08L107,PS08L108:
                            PS08L109,PS08L110,PS08L111,PS08L112:
                            PS08L113,PS08L114,PS08L115,PS08L116:
                            PS08L117,PS08L118,PS08L119,PS08L120:
                            PS08L121,PS08L122,PS08L123,PS08L124:
                            PS08L125,PS08L126,PS08L127,PS08L128:
                            PS08L129,PS08L999,PS08L999,PS08L130:
                            PS08L131,PS08L132,PS08L133
          GOTO     PS08L999
.
PS08L101
          MOVE      SIQCRID,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L102
          MOVE      SIQCCST,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L103
          MOVE      SIQCCAT,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L104
          MOVE      SIQCUNT,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L105
          MOVE      SIQCPD,VAR       
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L106
          MOVE      SIQCPN,VAR       
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L107
          MOVE      SIQCQTY,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L108
          MOVE      SIQCSTA,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L109
          MOVE      SIQCUID,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L110
          UNPACK    SIQCDAT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L111
          MOVE      SIQCTIM,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L112
          MOVE      SIQCPOR,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L113
          UNPACK    SIQCPDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L114
          MOVE      SIQCPTM,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L115
          MOVE      SIQCPID,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L116
          MOVE      SIQCPPO,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L117
          MOVE      SIQCORI,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L118
          MOVE      SIQCPTY,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L119
          MOVE      SIQCPQT,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L120
          MOVE      SIQCECT,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L121
          MOVE      SIQCCAN,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L122
          MOVE      SIQCORD,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L123
          MOVE      SIQCREQ,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L124
          UNPACK    SIQCEDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L125
          MOVE      SIQCSUP,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L126
          MOVE      SIQCSUT,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L127
          MOVE      SIQCPGP,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L128
          MOVE      SIQCCON,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L129
          MOVE      SIQCCDT,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L130
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L131
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L132
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS08L999
.
PS08L133
          MOVE      SICDDESC,VAR     
          CALL      DISPITEM
          GOTO     PS08L999
PS08L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Requisition Details       
.---------------------------------------------------------
SF08L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF08L001  BRANCH   ACCEPT,SF08L020
.
SF08L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L101,SF08L006:
                            SF08L006,SF08L006,SF08L006
SF08L006  BEEP
          GOTO     SF08L005
SF08L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF08L090
          MATCH    PRGID,SCSLPID
          GOTO     SF08L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF08L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020
          GOTO     SF08L020
SF08L090  MOVE     ZERO,ACCEPT
          GOTO     SF08L001
.
SF08L101
          MOVE      ZERO,EXIT
          GOTO      SF08L999
SF08L990  MOVE      FOUR,EXIT * Exit Char Exit
SF08L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
          READ      CONTROLF,TWENTY3;*95,HACCNT,*124,HORDDES
          READ      CONTROLF,TWENTY4;*135,HACCDATA
.
          COMPARE   ONE,HACCNT
          GOTO      ONAT9999 IF NOT EQUAL
.
          DISPLAY   *P64:24,"apsimsaf";
          OPEN      APSIMSA1,"apsimsaf"
          DISPLAY   *P64:24,"apsinpaf";
          OPEN      APSINPA2,"apsinpaf"
.
ONAT9999  RETURN
.----------------------------------------------------------------------
. Keyin SIPA
.----------------------------------------------------------------------
KSIPA000  MOVE      ZERO,CKEYTYP
          CALL      KSIPAA00                     * keyin SIPA
          BRANCH    EXIT,KSIPA950,KSIPA950
.
          CALL      CWSA0000                     * check warehouse security
          BRANCH    EXIT,KSIPA000
.
          MATCH     SP70,SIPADCN
          IF        !@EQUAL
            UNPACK    SIPADCN,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            CLEAR     DISPMSG
            APPEND    "WARNING: Order Cancelled on ",DISPMSG
            APPEND    CPCDATE,DISPMSG
            APPEND    " : ",DISPMSG
            RESET     DISPMSG
            BEEP
            CALL      MESSAGE1
          ENDIF
.
          UNPACK    SP70,SIPEYEAR,SIPEPER
          MOVE      SIPADIN,SIPEDATE
          CALL      RSIPE000                * get period
.
          MOVE      SP70,APMASN1
          PACK      KEY5,SIPASUP,SP70
          CALL      RDAPMA1
.
          MOVE      SP70,SIORNAME
          PACK      KEY3,SIPAORI,SP70
          CALL      RDSIOR1
.
          MOVE      SP70,SICADESC
          PACK      KEY5,SIPACST,SP70
          CALL      RDSICA1
          MOVE      SICADESC,DEFCDESC
.
          MOVE      SP70,SIWADES
          PACK      KEY5,SIPAWAR,SP70
          CALL      RDSIWA1
          MOVE      SIWADES,DEFWDESC
.
          UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,PURODATE
.
          MATCH     SP8,SIPADPR
          IF        !@EQUAL
            UNPACK  SIPADPR,CCENT,CYEAR,CMON,CDAY
            CALL    PACDATE
            MOVE    CPCDATE,PRINDATE
          ENDIF
.
          MATCH     SP8,SIPADCN
          IF        !@EQUAL
            UNPACK  SIPADCN,CCENT,CYEAR,CMON,CDAY
            CALL    PACDATE
            MOVE    CPCDATE,CANCDATE
          ENDIF
.
          MATCH     SP8,SIPADCM
          IF        !@EQUAL
            UNPACK  SIPADCM,CCENT,CYEAR,CMON,CDAY
            CALL    PACDATE
            MOVE    CPCDATE,COMPDATE
          ENDIF
.
          MOVE      SP70,SICDDESC
          MOVE      "ME ",KEY3
          PACK      KEY6,KEY3,SIPAMES,SP70
          MATCH     SP70,SIPAMES
          CALL      RDSICD1 IF NOT EQUAL
          MOVE      SICDDESC,MESSDESC
.
          MOVE      SP70,SICDDESC
          MOVE      "CF ",KEY3
          PACK      KEY6,KEY3,SIPACON,SP70
          MATCH     SP70,SIPACON
          CALL      RDSICD1 IF NOT EQUAL
          MOVE      SICDDESC,CONFDESC
.
          MOVE      SP70,SICDDESC
          MOVE      "pa1",KEY3
          PACK      KEY6,KEY3,SIPAUC1,SP70
          MATCH     SP70,SIPAUC1
          CALL      RDSICD1 IF NOT EQUAL
          MOVE      SICDDESC,CODEDES1
.
          MOVE      SP70,SICDDESC
          MOVE      "pa2",KEY3
          PACK      KEY6,KEY3,SIPAUC2,SP70
          MATCH     SP70,SIPAUC2
          CALL      RDSICD1 IF NOT EQUAL
          MOVE      SICDDESC,CODEDES2
          CALL      TOTORD00
.
          MOVE      "**  UNKNOWN  **    ",TRANSSTA
          UNPACK    SP70,SITRPURC,SITRSTAT,SITRUSER,SITRCREA:
                         SITRORG,SITREDAT,SITRTDAT
          MOVE      "000",SITRTNUM
          PACK      KEY7,SIPAPON,SP70
          CALL      RDSITR1
          IF        OVRCD=1
            MOVE      "No Transmission    ",TRANSSTA
          ELSE
            MATCH     "0",SITRSTAT
            IF        @EQUAL
              MOVE      "Await. Transmit    ",TRANSSTA
            ENDIF
            MATCH     "1",SITRSTAT
            IF        @EQUAL
              MOVE      "In Progress        ",TRANSSTA
            ENDIF
            MATCH     "3",SITRSTAT
            IF        @EQUAL
              MOVE      "Ack. Received      ",TRANSSTA
            ENDIF
            MATCH     "9",SITRSTAT
            IF        @EQUAL
              MOVE      "Cancelled          ",TRANSSTA
            ENDIF
          ENDIF
.
.
KSIPA900  MOVE      ZERO,EXIT
          GOTO      KSIPA999
.
KSIPA950  MOVE      TWO,EXIT
.
KSIPA999  RETURN
.----------------------------------------------------------------------
. check warehouse security
. requires : SIPAPON
. returns  : EXIT = 0 - access granted,
.                   1 - access denied
.----------------------------------------------------------------------
CWSA0000  MOVE      ZERO,EXIT          * access granted
          PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPC1
CWSA0100  CALL      RKSIPC1
          BRANCH    OVRCD,CWSA9999
.
          MATCH     SIPAPON,SIPCPON
          GOTO      CWSA9999 IF NOT EQUAL
.
          MATCH     SP5,SIPCWAR
          GOTO      CWSA0100 IF EQUAL
.
          PACK      KEY9,SIPCWAR,PASSCODE,SP70
          CALL      RDSIWS2
          BRANCH    OVRCD,CWSA9000
.
          GOTO      CWSA0100
.
CWSA9000  MOVE      ONE,EXIT           * access denied
          CLEAR     DISPMSG
          APPEND    "P/O ",DISPMSG
          APPEND    SIPAPON,DISPMSG
          APPEND    SLASH,DISPMSG
          APPEND    SIPCITM,DISPMSG
          APPEND    ", from W/H ",DISPMSG
          APPEND    SIPCWAR,DISPMSG
          APPEND    ". No Access - ",DISPMSG
          CALL      MESSAGE1
          GOTO      CWSA9999
.
CWSA9999  RETURN
REDITM00  MATCH     SP70,SIPCCAT
          IF        @EQUAL
            MOVE      "N/A",SIPCCAT
            MOVE      SP70,SIIADES
            MOVE      SIPCSUT,SIIAISS
            MOVE      ZERO,SIIAAVC
            MOVE      ONE,SIIANON
          ELSE
            MOVE      SIPCCAT,KEY7
            CALL      RDSIIA1
............MOVE      SIIASUB,SIPCPRD        * SRF127291
          ENDIF
.
          MOVE      SP70,SICADESC
          MOVE      SIPCCST,KEY5
          CALL      RDSICA1
.
          MATCH     SP70,SIPCWAR
          IF        @EQUAL
            MOVE      "N/A",SIPCWAR
            MOVE      SP70,SIWADES
          ELSE
            MOVE      SIPCWAR,KEY5
            CALL      RDSIWA1
          ENDIF
.
          MOVE      SIPCPRD,KEY5
          CALL      RDSISA1
.
REDITM99  RETURN
.
.--------------------------------------------------------------------
. Print purchase order details
.--------------------------------------------------------------------
.
PPUR0000  MOVE      ZERO,CPAGENO
          MOVE      "99",CLNO
          CLOCK     TIME,CTIMEIS
.
          PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPC1
.
PPUR1000  CALL      RKSIPC1
          BRANCH    OVRCD,PPUR9999
.
          MATCH     SIPAPON,SIPCPON
          GOTO      PPUR9999 IF NOT EQUAL
.
          MOVE      ONE,SIFACTOR
          MATCH     SP7,SIPCCAT
          IF        !@EQUAL
            PACK      KEY7,SIPCCAT,SP70
            CALL      RDSIIA1
            BRANCH    OVRCD,PPUR1100
            PACK      KEY30,SIIAISS,SIPCSUT,SP70
            CALL      RDSIFA1
          ENDIF
.
PPUR1100  ASSIGN    SIPCRQT/SIFACTOR,F12P2
          ASSIGN    SIPCOQT-F12P2,F12P5
          MOVE      F12P5,FORM12A
          MOVE      SIPCOQT,FORM12
          MOVE      SIPCECT,F8P4
.
          COMPARE   "56",CLNO
          CALL      HEAD0000 IF NOT LESS
          PRINT     *1,SIPCCAT,*10,SIPCPD,*41,FORM12,*54,FORM12A:
                    *68,F8P4:
                    *N,*1,"Product Group : ",SIPCPRD," Cost Centre : ":
                    SIPCCST," C.H.P. : ",SIPCCON
          ADD       TWO,CLNO
.
          MATCH     SP70,SIPCUR2
          IF        !@EQUAL
            PRINT     *1,"Internal Del. : ",SIPCUR2
            ADD       ONE,CLNO
          ENDIF
.
          PACK      KEY13,SIPCPON,SIPCITM,SP70
          CALL      RSSIPD1
.
PPUR1200  CALL      RKSIPD1
          BRANCH    OVRCD,PPUR1300
.
          MATCH     SIPCPON,SIPDPON
          GOTO      PPUR1300 IF NOT EQUAL
          MATCH     SIPCITM,SIPDITM
          GOTO      PPUR1300 IF NOT EQUAL
.
          PRINT     *10,SIPDCOM
          ADD       ONE,CLNO
          COMPARE   "56",CLNO
          CALL      HEAD0000 IF NOT LESS
          GOTO      PPUR1200
.
PPUR1300  PACK      KEY12,SIPCPON,SIPCITM,SP70
          CALL      RSSIPF1
.
PPUR1350  CALL      RKSIPF1
          BRANCH    OVRCD,PPUR1400
.
          MATCH     SIPCPON,SIPFPON
          GOTO      PPUR1400 IF NOT EQUAL
          MATCH     SIPCITM,SIPFITM
          GOTO      PPUR1400 IF NOT EQUAL
.
          UNPACK    SIPFDAT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      SIPFQTY,FORM12
          PRINT     "Recv: ",SIPFREC,*10,FORM12,*23," on ",CPCDATE:
                    *38,"Docket : ",SIPFDEL
          ADD       ONE,CLNO
          COMPARE   "56",CLNO
          CALL      HEAD0000 IF NOT LESS
          GOTO      PPUR1350
.
PPUR1400  COMPARE   ONE,HACCNT
          GOTO      PPUR1000 IF NOT EQUAL
.
          PACK      DIM8,HORDDES,SIPCPON
.
          PACK      KEY51,SIPASUP,HORDDES,SIPCPON,SP70
          CALL      RSAPIN2
.
PPUR1500  CALL      RKAPIN2
          BRANCH    OVRCD,PPUR1000
.
          MATCH     SIPASUP,APINCRD
          GOTO      PPUR1000 IF NOT EQUAL
          MATCH     DIM8,APINORD
          GOTO      PPUR1000 IF NOT EQUAL
          UNPACK    APINCAT,DIM3,DIM2
          MATCH     SIPCITM,DIM3
          GOTO      PPUR1500 IF NOT EQUAL
.
          PACK      KEY40,APINBCH,APINCRD,APINREF,APINDOC,SP70
          CALL      RDAPIM1
.
          MOVE      APIMTYP,F1
          BRANCH    F1,PPUR1600,PPUR1500,PPUR1500,PPUR1500
.
PPUR1600  COMPARE   "56",CLNO
          CALL      HEAD0000 IF NOT LESS
.
          UNPACK    APIMIDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          MOVE      APINQTY,FORM10
          IF        F1=0
            PRINT     *1,"Inv : ",*12,FORM10,*23," on ",CPCDATE:
                      *38,"Invoice:",*50,APINDOC,*66,APINAMT
          ELSE
            ASSIGN    FORM10*SEQ,FORM10
            ASSIGN    APINAMT*SEQ,APINAMT
            PRINT     *1,"Crd : ",*12,FORM10,*23," on ",CPCDATE:
                      *38,"Credit :",*50,APINDOC,*66,APINAMT
          ENDIF
.
          ADD       ONE,CLNO
          GOTO      PPUR1500
.
PPUR9999  RETURN
.--------------------------------------------------------------------
. Print purchase order heading
.--------------------------------------------------------------------
.
HEAD0000  CALL      HEAD80
.
          PRINT        *1,"Purchase Order Number : ",SIPAPON
.
          COMPARE   ONE,CPAGENO
          GOTO      HEAD0200 IF NOT EQUAL
.
          PRINT        *1,"Purchase Order Date   : ",PURODATE:
                      *40,"Date Printed   : ",PRINDATE:
                    *N,*1,"Date Cancelled        : ",CANCDATE:
                      *40,"Date Completed : ",COMPDATE:
                    *N,*1,"Default Cost Centre   : ",SIPACST,*40,DEFCDESC:
                    *N,*1,"Default Warehouse     : ",SIPAWAR,*40,DEFWDESC:
                    *N,*1,"Supplier Code         : ",SIPASUP,*40,APMASN1:
                    *N,*1,"Originator Code       : ",SIPAORI,*40,SIORNAME:
                    *N,*1,"Confirmation Code     : ",SIPACON,*40,CONFDESC:
                    *N,*1,"Supplier Contact      : ",SIPASCN:
                    *N,*1,"Hospital Contact      : ",SIPAICN:
                    *N,*1,"Extension             : ",SIOREXT:
                    *N,*1,"Message               : ",SIPAMES,*40,MESSDESC:
                    *N,*1,"Delivery Details      : ",SIPAIDP:
                    *N,*1,"Comments              : "
          ADD       TEN4,CLNO
.
          PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPB1
HEAD0100  CALL      RKSIPB1
          BRANCH    OVRCD,HEAD0200
.
          MATCH     SIPAPON,SIPBPON
          GOTO      HEAD0200 IF NOT EQUAL
.
          PRINT     *1,SIPBCOM
          ADD       ONE,CLNO
          GOTO      HEAD0100
.
HEAD0200  PRINT     *N,*1,"Catalog",*10,"Description",*46,"Ordered":
                    *55,"Outstanding",*72,"Unit Cost":
                    *N,"-------",*10,"------------------------------":
                    *46,"-------",*55,"-----------":
                    *72,"---------"
          ADD       THREE,CLNO
.
HEAD9999  RETURN
CHKPRICE  IF        (SIPCECT<0)
            MOVE      "        T.B.A.",UNITCOST
          ELSE
            MOVE      "9,999,999.9999",UNITCOST
            FEDIT     SIPCECT,UNITCOST
            MATCH     "*",UNITCOST
            IF        @EQUAL
              MOVE      SIPCECT,F9P4
              MOVE      F9P4,UNITCOST
            ENDIF
          ENDIF
.
          MOVE     SIPCCST,KEY5
          MOVE     SP70,SICADESC
          CALL     RDSICA1
          IF       OVRCD=1
            MOVE     SP70,SIPCCST
            MOVE     SP70,SICADESC
          ENDIF
.
          RETURN
.
.--------------------------------------------------
. Total Cost of Order
.--------------------------------------------------
TOTORD00  MOVE     ZERO,TOTALORD
          PACK     KEY11,SIPCPON,SIPCITM,SP70    * save current record
          PACK     KEY10,SIPAPON,SP70
          CALL     RSSIPC1
TOTORD10  CALL     RKSIPC1
          BRANCH   OVRCD,TOTORD90
          MATCH    SIPCPON,SIPAPON
          GOTO     TOTORD90 IF NOT EQUAL
          IF       SIPCECT>0
            ASSIGN   TOTALORD+(SIPCECT*SIPCOQT),TOTALORD
          ENDIF
          GOTO     TOTORD10
TOTORD90
          PACK     KEY10,KEY11,SP70              * restore original record
          CALL     RDSIPC1
          RETURN
SELITM00  MOVE      SIPC1MKY,KEY20
          CALL      RDSIPC1
          IF        OVRCD=1
            MOVE      "Invalid Selection - ",DISPMSG
            BEEP
            CALL      MESSAGE1
          ELSE
            CALL      REDITM00
            CALL      SC01L000
          ENDIF
.
SELITM99  RETURN
.
.----------------------------------------------------------------------
. Set up screen 03
.----------------------------------------------------------------------
SETSCR03
          MOVE      SP70,SIORNAME
          PACK      KEY3,SITRORG,SP70
          CALL      RDSIOR1
.
          MOVE      SP70,SECUSER
          PACK      KEY3,SITRUSER,SP70
          CALL      RDPASS1
.
          MOVE      "**  TRANSMISSION STATUS UNKNOWN  **   ",TRANSST2
          PACK      KEY7,SIPAPON,SP70
          CALL      RDSITR1
          IF        OVRCD=1
            MOVE      "Not to be Transmitted                   ",TRANSST2
          ELSE
            MATCH     "0",SITRSTAT
            IF        @EQUAL
              MOVE      "Awaiting Transmission                 ",TRANSST2
            ENDIF
            MATCH     "1",SITRSTAT
            IF        @EQUAL
              MOVE      "Transmission In Progress              ",TRANSST2
            ENDIF
            MATCH     "2",SITRSTAT
            IF        @EQUAL
              MOVE      "Acknowledgement Received              ",TRANSST2
            ENDIF
            MATCH     "3",SITRSTAT
            IF        @EQUAL
              MOVE      "Transmission Completed                ",TRANSST2
            ENDIF
            MATCH     "9",SITRSTAT
            IF        @EQUAL
              MOVE      "Transmission Cancelled                ",TRANSST2
            ENDIF
          ENDIF
.
          RETURN
REDITB00
          UNPACK    SIPFUDT,KEY4,SKEY2
          PACK      RECUSDT,KEY4,SLASH,SKEY2,SP70
.
          UNPACK    SP70,SIPCPD,SIPCWAR,SIPCCAT,SIPCPRD
          PACK      KEY10,SIPFPON,SIPFITM,SP70
          CALL      RDSIPC1
.
          MATCH     SP70,SIPCCAT
          IF        @EQUAL
            MOVE      "N/A",SIPCCAT
            MOVE      SP70,SIIADES
            MOVE      SIPCSUT,SIIAISS
            MOVE      ZERO,SIIAAVC
            MOVE      ONE,SIIANON
          ELSE
            MOVE      SIPCCAT,KEY7
            CALL      RDSIIA1
............MOVE      SIIASUB,SIPCPRD        * SRF127291
          ENDIF
.
          MOVE      SP70,SICADESC
          MOVE      SIPCCST,KEY5
          CALL      RDSICA1
.
          MATCH     SP70,SIPCWAR
          IF        @EQUAL
            MOVE      "N/A",SIPCWAR
            MOVE      SP70,SIWADES
          ELSE
            MOVE      SIPCWAR,KEY5
            CALL      RDSIWA1
          ENDIF
.
          MOVE      SIPCPRD,KEY5
          CALL      RDSISA1
.
REDITB99  RETURN
.
SELITB00  MOVE      SIPF1MKY,KEY20
          CALL      RDSIPF1
          IF        OVRCD=1
            MOVE      "Invalid Selection - ",DISPMSG
            BEEP
            CALL      MESSAGE1
          ELSE
            CALL      REDITB00
            CALL      SC05L000
          ENDIF
.
SELITB99  RETURN
.
.--------------------------------------------------
. Total Cost of Order Received
.--------------------------------------------------
TOTREC00  MOVE     ZERO,TOTALRED
          PACK     KEY12,SIPCPON,SP70
          CALL     RSSIPF1
TOTREC10  CALL     RKSIPF1
          BRANCH   OVRCD,TOTREC99
          MATCH    SIPCPON,SIPFPON
          GOTO     TOTREC99 IF NOT EQUAL
          IF       SIPCECT>0
            ASSIGN   TOTALRED+(SIPFQTY*SIPFCST),TOTALRED
          ENDIF
          GOTO     TOTREC10
TOTREC99
          RETURN
SELITC00  MOVE      SIPF2MKY,KEY10
          CALL      RDSIPF2
          IF        OVRCD=1
            MOVE      "Invalid Selection - ",DISPMSG
            BEEP
            CALL      MESSAGE1
          ELSE
            CALL      REDITB00
            CALL      SC05L000
          ENDIF
.
SELITC99  RETURN
.
SCR07DIS  IF        SIQCECT<0
            MOVE      "        T.B.A.",UNITCOST
          ELSE
            MOVE      "9,999,999.9999",UNITCOST
            FEDIT     SIQCECT,UNITCOST
            MATCH     "*",UNITCOST
            IF        @EQUAL
              MOVE      SIQCECT,F9P4
              MOVE      F9P4,UNITCOST
            ENDIF
          ENDIF
.
          PACK      SICADESC,SP70
          PACK      KEY5,SIQCCST,SP70
          CALL      RDSICA1
.
          PACK      SIORNAME,SP70
          PACK      KEY3,SIQCORI,SP70
          CALL      RDSIOR1
.
          RETURN
SELREQ00
          CALL      RDSIQC3
          IF        OVRCD=1
            MOVE      "Invalid Selection - ",DISPMSG
            BEEP
            CALL      MESSAGE1
          ELSE
.           CALL      REDREQ00
            CALL      SC08L000
          ENDIF
.
SELREQ99  RETURN
.----------------------------------------------------------------------
. Set up screen 08
.----------------------------------------------------------------------
SETSCR08
          MOVE      SP70,SIORNAME
          PACK      KEY3,SIQCORI,SP70
          CALL      RDSIOR1
.
          MOVE      SP70,SIIADES
          PACK      KEY7,SIQCCAT,SP70
          CALL      RDSIIA1
.
          MOVE      SP70,SICADESC
          PACK      KEY5,SIQCCST,SP70
          CALL      RDSICA1
.
          MOVE      "PRC",KEY3
          MOVE      SP70,SICDDESC
          PACK      KEY6,KEY3,SIQCSTA
          CALL      RDSICD1
.
          RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSIMSIO/INC
          INC       APSINPIO/INC
          INC       APSMASIO/INC
          INC       IBAPASIO/INC
          INC       SINCCAIO/INC
          INC       SINCIAIO/INC
          INC       SINCODIO/INC
          INC       SINCODKY    
          INC       SINFACIO/INC
          INC       SINNATIO/INC
          INC       SINOQCIO/INC
          INC       SINORIIO/INC
          INC       SINPERCD    
          INC       SINPERIO/INC
          INC       SINPOAIO/INC
          INC       SINPOAKY    
          INC       SINPOBIO/INC
          INC       SINPOCIO/INC
          INC       SINPODIO/INC
          INC       SINPOFIO/INC
          INC       SINSUAIO/INC
          INC       SINTRNIO/INC
          INC       SINWARIO/INC
          INC       SINWSEIO/INC
.
          INC       STDGENCD
.
