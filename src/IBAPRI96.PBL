.******************************************************************************
.* System    :  PRIVATE PRACTICE                                              *
.* Program   :  IBAPRI96                                                      *
.* Desc      :  Print Audit Reports                                           *
.******************************************************************************
.* Date      :  04/12/1991                                                    *
.* Author    :  DIG                                                           *
.* Mods      :                                                                *
.* V10.13.01   03/08/2018  Richa Phogat    TSK                                *
.*             Updated Print length in PRNT0300 from 132 to 136               *
.******************************************************************************
.*        V9.04.01  19.08.2005      J.Tan          CAR 62750                  *
.*                  Removed redefined amount variables                        *
.*        V9.03.01  01/03/2004  Lina Vo        CAR 47921                      *
.*                  Removed use of PRIDBTFD & IO                              *
.*        V5.08.02  03/07/2000  Jill Habasque                                 *
.*                  Recompiled for PRIAUDDO                                   *
.*        V5.08.01  05/05/2000  J.Tan                                         *
.*                  Recompiled for PRIDOCT file                               *
.*        V5.07.02  15/10/1999  D.Di Paola                                    *
.*                  Recompiled for PRISPTFD and PRIITMFD                      *
.*        V5.07.01  15/10/1999  D. Di Paola                                   *
.*                  Recompiled for PRIHTRFD and PRIBULFD                      *
.*                  Recompiled for PRIAUDPR length change                     *
.*                  Recompiled for PRIAUDDO length change                     *
.*                  Recompiled for PRIAUDDB length change                     *
.*                  Recompiled for PRIAUDEX length change                     *
.*       V5.07.B01  06/11/1998  Jim Stathopoulos                              *
.*                  507 Changes                                               *
.******************************************************************************
.*        V6.00.01  07/10/1992  Steve Armstrong                               *
.*                  Modified for alphanumeric debtor number                   *
.*        V6.00.02  06/01/1993  i chung           SRF 118272                  *
.*                  Added option to clear audits.                             *
.*                  Added date range facility for Print option.               *
.*        V6.00.03  22/01/1993    Justin Coates                               *
.*                  added for files pataudfd, patauifd, pataurfd              *
.*        V6.03.B1  25/02/1995  Graeme Williams   R6.03 Enhancements          *
.*                  Added extra fields to the "priitemf" audit file.          *
.*                  11/03/1995  Graeme Williams   R6.03 Enhancements          *
.*                  Added extra audits for the "priexcaf" and "prisptaf" files*
.*        V6.03.B2  15/09/1995  Steve Armstrong                               *
.*                  Recompiled for PRIAUIFD                                   *
.*        V6.03.B3  14/11/1995  Steve Armstrong   SRF 612675                  *
.*                  Mods to ignore printing of audits which are currently not *
.*                  in use (PRCNAUDA, PRCNAUDB, PRCNAUDF).                    *
.*        V6.03.01  26/09/96 J.Tan          SRF 617204                        *
.*                  Fixed key for cash deposit                                *
.******************************************************************************
.
          INC       STD001FD
          INC       PRIAUDFD/INC
          INC       PRIAUIFD/INC
          INC       PRIAURFD/INC
          INC       PRICONFD/INC
...          INC       PRIDBTFD/INC
          INC       PRIDOCFD/INC
          INC       PRIEXCFD/INC
          INC       PRIITMFD/INC
          INC       PRISPTFD/INC
          INC       PRIPRAFD/INC
+
.**********************************************************************
.*                       GLOBAL VARIABLES                             *
.**********************************************************************
CMDLINE   DIM       60
COUNT     FORM      2
DESCAUD   DIM       32
DISAVAIL  DIM       12
DUMMYF6   FORM      6
FORM6     FORM      6
FORM8P2   FORM      8.2
FRDATE    DIM       8
OLDKEY19  DIM       19
TODATE    DIM       8
TOTADDS   FORM      6
TOTCHNGS  FORM      6
TOTDELS   FORM      6
+
.**********************************************************************
.*                             CONSTANTS                              *
.**********************************************************************
AVNO      INIT      "Un-Available"
AVYES     INIT      "Available"
.
DESCAUDA  INIT      "Audit A (Not Used)"
DESCAUDB  INIT      "Audit B (Not Used)"
DESCAUDC  INIT      "Doctor Audit File"
...DESCAUDD  INIT      "Debtors Audit File"
DESCAUDD  INIT      "Audit D (Not Used)"
DESCAUDE  INIT      "Medical Practice Audit File"
DESCAUDF  INIT      "Audit F (Not Used)"
DESCAUDG  INIT      "Spec. Path. Tests Audit File"
DESCAUDH  INIT      "Exception Charging Audit File"
DESCAUDI  INIT      "Item Audit File"
DESCAAUD  INIT      "Cash Deposit Audit File"
DESCAAUI  INIT      "Cash Deposit Invoiced Audit File"
DESCAAUR  INIT      "Deposits Refunded Audit File"
.
DASH100   INIT     "*-------------------------------------------------":
                   "--------------------------------------------------"
DASH32    INIT     "-------------------------------*"
.
FINISH    INIT      "Finish"
START     INIT      "Start"
.
PRGID     INIT      "IBAPRI96"
PRGNAM    INIT      "Print Audit Reports"
VERSION   INIT      "V12.01.00"
+
.**********************************************************************
.*                           MAINLINE                                 *
.*                       Controlling Logic                            *
.**********************************************************************
ML0000    CALL      INIT0000                * open files & display header
.
ML1000    CALL      OPTN0000                * main option screen
          BRANCH    EXIT,ML9999
.
. ------  display the audit screen  ------
.
ML2000    CALL      SCR0000                 * display screen
.
ML2100    CALL      SEL0000                 * select audit(s) to print/delete
          COMPARE   ZERO,OPTION             * anything selected ?
          GOTO      ML1000 IF EQUAL         * no
          BRANCH    MOPTION,ML3000,ML4000   * print/clear
.
. ------  Print Option  ------
.
ML3000    CALL      SETU0000                * set up standard routines' input
.                                             requirements
          CALL      DATE0000
          BRANCH    EXIT,ML2000             * "Cancel" option selected
          BRANCH    OPTION,ML3100,ML3200
.
ML3100    CALL      PSNG0000                * print a single audit
          GOTO      ML2000
.
ML3200    CALL      PALL0000                * print all audits
          GOTO      ML2000
.
. ------  Clear Option  ------
.
ML4000    CALL      RSTA0000
          BRANCH    EXIT,ML2100
          BRANCH    OPTION,ML4100,ML4200
.
ML4100    CALL      CSNG0000                * clear a single audit
          GOTO      ML2000
.
ML4200    CALL      CALL0000                * clear all audits
          GOTO      ML2000
.
ML9999    CHAIN     PGM
+
.**********************************************************************
.*                           INIT0000                                 *
.*               Open files and display header                        *
.**********************************************************************
INIT0000  CALL      DISPHEAD                * display screen header
.
          DISPLAY   *P50:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
.
...          DISPLAY   *P58:24,"priauddb";
...          OPEN      PRIAUDDB,"priauddb"
.
          DISPLAY   *P58:24,"priauddo";
          OPEN      PRIAUDDO,"priauddo"
.
          DISPLAY   *P58:24,"priaudex";
          OPEN      PRIAUDEX,"priaudex"
.
          DISPLAY   *P58:24,"priaudit";
          OPEN      PRIAUDIT,"priaudit"
.
          DISPLAY   *P58:24,"priaudsp";
          OPEN      PRIAUDSP,"priaudsp"
.
          DISPLAY   *P58:24,"priaudpr";
          OPEN      PRIAUDPR,"priaudpr"
.
          DISPLAY   *P58:24,"priaudaf";
          OPEN      PRIAUDA1,"priaudaf"
          DISPLAY   *P58:24,"priauiaf";
          OPEN      PRIAUIA1,"priauiaf"
          DISPLAY   *P58:24,"priauraf";
          OPEN      PRIAURA1,"priauraf"
.
INIT9999  RETURN
+
.**********************************************************************
.*                           OPTN0000                                 *
.*                   Display the main option screen                   *
.**********************************************************************
OPTN0000  MOVE      FALSE,EXIT
          DISPLAY   *P41:2,*EF:
                    *P1:4,*V2LON,ZERO,*HOFF," = Exit":
                    *P1:5,*V2LON,ONE,*HOFF," = Print Audit":
                    *P1:6,*V2LON,TWO,*HOFF," = Clear Audit":
                    *P1:8,"Select Option : ";
.
.------ keyin the option ------
.
OPTN1000  KEYIN     *P17:8,*EL,*DV,UNDLN1,*P17:8,*V2LON,MOPTION;
.
          COMPARE   ZERO,MOPTION            * see if exit was chosen
          GOTO      OPTN9000 IF EQUAL
.
          BRANCH    MOPTION,OPTN2000,OPTN3000
          BEEP                              * invalid option chosen
          GOTO      OPTN1000
.
.------ Print option chosen ------
.
OPTN2000  DISPLAY   *P41:2,"- ",*V2LON,"Print Audit(s)";
          GOTO      OPTN9999
.
.------ Clear option chosen ------
.
OPTN3000  DISPLAY   *P41:2,"- ",*V2LON,"Clear Audit(s)";
          GOTO      OPTN9999
.
.------ Exit option chosen ------
.
OPTN9000  MOVE      TRUE,EXIT
.
OPTN9999  RETURN
+
.**********************************************************************
.*                                 SCR0000                            *
.*             Routine to display the screen of audits                *
.**********************************************************************
SCR0000   READ      CONTROLF,THIRTY3;*51,PRCNAUDA,PRCNAUDB,PRCNAUDC,PRCNAUDD:
                                         PRCNAUDE,PRCNAUDF,PRCNAUDG,PRCNAUDH:
                                         PRCNAUDI
.
          DISPLAY   *P1:3,*EF,*V2LON:
                    *P2:4,ONE:
                    *P2:5,TWO:
                    *P2:6,THREE:
                    *P2:7,FOUR:
                    *P2:8,FIVE:
                    *P2:9,SIX:
                    *P2:10,SEVEN:
                    *P2:11,EIGHT:
                    *P2:12,NINE:
                    *P1:13,TEN:
                    *P1:14,TEN1:
                    *P1:15,TEN2:
                    *P3:4,*HOFF,". ",DESCAUDA,*P40:4," : ":
                    *P3:5,". ",DESCAUDB,*P40:5," : ":
                    *P3:6,". ",DESCAUDC,*P40:6," : ":
                    *P3:7,". ",DESCAUDD,*P40:7," : ":
                    *P3:8,". ",DESCAUDE,*P40:8," : ":
                    *P3:9,". ",DESCAUDF,*P40:9," : ":
                    *P3:10,". ",DESCAUDG,*P40:10," : ":
                    *P3:11,". ",DESCAUDH,*P40:11," : ":
                    *P3:12,". ",DESCAUDI,*P40:12," : ":
                    *P3:13,". ",DESCAAUD,*P40:13," : ":
                    *P3:14,". ",DESCAAUI,*P40:14," : ":
                    *P3:15,". ",DESCAAUR,*P40:15," : ";
.
          MOVE      ZERO,COUNT
          MOVE      THREE,CVERT
          MOVE      "43",CCOL
.
.------ display the availability of all of the audit files ------
.
SCR1000   ADD       ONE,COUNT
          ADD       ONE,CVERT
.
          COMPARE   TEN3,COUNT               * see if no more audits to display
          GOTO      SCR9999 IF EQUAL
.
          LOAD      FORM1,COUNT,PRCNAUDA,PRCNAUDB,PRCNAUDC,PRCNAUDD,PRCNAUDE:
                                PRCNAUDF,PRCNAUDG,PRCNAUDH,PRCNAUDI,ZERO:
                                ZERO,ZERO
          MOVE      AVYES,DISAVAIL
          LOAD      DISAVAIL,FORM1,AVNO
          DISPLAY   *PCCOL:CVERT,*V2LON,DISAVAIL;
          GOTO      SCR1000
.
SCR9999   RETURN
+
.**********************************************************************
.*                                SEL0000                             *
.*          Routine to select an audit or all audits to print         *
.**********************************************************************
SEL0000   MOVE      SP1,ANS
          DISPLAY   *P1:24,*EL,"Select Audit (":
                    *V2LON,"1-12",*HOFF,") or (":
                    *V2LON,ANSA,*HOFF,")ll Audits ? ";
          KEYIN     *P39:24,*EL,*JR,*V2LON,DIM2;
.
          ENDSET    DIM2
          APPEND    SP2,DIM2
          RESET     DIM2
.
          MATCH     SP2,DIM2                * see if anything was entered
          GOTO      SEL7000 IF EQUAL
.
          TYPE      DIM2                    * see if a numeric was entered
          GOTO      SEL2000 IF EQUAL
          REP       UPPLOW,DIM2
.
          UNPACK    DIM2,ANS,ANS
          MATCH     ANSA,ANS                * see if All was selected
          GOTO      SEL9000 IF EQUAL
.
.------ invalid option ------
.
SEL1000   BEEP
          GOTO      SEL0000
.
.------ a number was entered ------
.
SEL2000   MOVE      DIM2,COPTION
.
          COMPARE   ZERO,COPTION            * see if zero was entered
          GOTO      SEL1000 IF EQUAL
.
          COMPARE   TEN3,COPTION            * see if a number >= 13 was
          GOTO      SEL1000 IF NOT LESS       entered
.
          LOAD      FORM1,COPTION,PRCNAUDA,PRCNAUDB,PRCNAUDC,PRCNAUDD,PRCNAUDE:
                                  PRCNAUDF,PRCNAUDG,PRCNAUDH,PRCNAUDI,ZERO:
                                  ZERO,ZERO
.
          COMPARE   ZERO,FORM1              * see if audit file is available
          GOTO      SEL8000 IF EQUAL
.
          DISPLAY   *P1:24,*EL,*B,"Audit File not available.    ";
          CALL      HITENTER
          GOTO      SEL0000
.
.------ nothing was selected ------
.
SEL7000   MOVE      ZERO,OPTION
          GOTO      SEL9999
.
.------ a single audit file was selected ------
.
SEL8000   MOVE      ONE,OPTION
          GOTO      SEL9999
.
.------ All audit files was selected ------
.
SEL9000   MOVE      TWO,OPTION
.
SEL9999   RETURN
+
.**********************************************************************
.*                               SETU0000                             *
.*             SETUp standard routines' input requirements            *
.**********************************************************************
SETU0000  MOVE      ONE,CNOUNDLN            * HEAD132
          MOVE      ZERO,CCANLDTE
          MOVE      ZERO,CDEFDTE
          MOVE      ZERO,CHIGHLT
          RETURN
+
.**********************************************************************
.*                               DATE0000                             *
.*                     Routine to enter DATE range                    *
.**********************************************************************
DATE0000  BRANCH    OPTION,DATE1000,DATE1100
          GOTO      DATE9000
.
DATE1000  LOAD      DESCAUD,COPTION,DESCAUDA,DESCAUDB,DESCAUDC,DESCAUDD:
                                    DESCAUDE,DESCAUDF,DESCAUDG,DESCAUDH:
                                    DESCAUDI,DESCAAUD,DESCAAUI,DESCAAUR
          STRIP     DESCAUD
          DISPLAY   *P1:4,*EF:
                    *P5:5,*V2LON,"*** ",*+,DESCAUD," ***";
          GOTO      DATE2000
.
DATE1100  DISPLAY   *P1:4,*EF:
                    *P5:5,*V2LON,"*** ","All Audits"," ***";
.
DATE2000  BRANCH    COPTION,DATE2010,DATE2010,DATE2010,DATE2010:
                            DATE2010,DATE2010,DATE2010,DATE2010:
                            DATE2010,DATE9999,DATE9999,DATE9999
.
DATE2010  DISPLAY   *P5:8,"From Date : ":
                    *P5:9,"To   Date : ";
          MOVE      SP8,FRDATE
          MOVE      SP8,TODATE
          MOVE      "17",CCOL
.
.         input From Date
.
DATE3000  DISPLAY   *P17:9,*EF,*P17:8,*EL;
          MOVE      "8",CVERT
.
DATE3100  UNPACK    SP6,CDAY,CMON,CYEAR
          MOVE      CCC,CCENT
          CALL      KEYDATE
          BRANCH    CQUEST,DATE3100
          BRANCH    OVRCD,DATE3200
.
          PACK      FRDATE,CCENT,CYEAR,CMON,CDAY
          REP       " 0",FRDATE
          GOTO      DATE4000
.
DATE3200  MOVE      SP8,FRDATE
          DISPLAY   *P17:8,*EL,*V2LON,START;
.
.         input To Date
.
DATE4000  MOVE      "9",CVERT
.
DATE4100  UNPACK    SP6,CDAY,CMON,CYEAR
          MOVE      CCC,CCENT
          CALL      KEYDATE
          BRANCH    CQUEST,DATE4100
          BRANCH    OVRCD,DATE4200
.
          PACK      TODATE,CCENT,CYEAR,CMON,CDAY
          REP       " 0",TODATE
          GOTO      DATE5000
.
DATE4200  MOVE      "99999999",TODATE
          DISPLAY   *P17:9,*EL,*V2LON,FINISH;
          GOTO      DATE6000
.
DATE5000  MATCH     FRDATE,TODATE
          GOTO      DATE6000 IF NOT LESS
          DISPLAY   *P1:24,*EL,*B:
                    "To Date must be greater than or equal to From Date.    ";
          CALL      HITENTER
          GOTO      DATE4100
.
DATE6000  CALL      CONTQST
          BRANCH    CEXIT,DATE8000,DATE3000,DATE9000
          GOTO      DATE5000
.
DATE8000  MOVE      FALSE,EXIT
          GOTO      DATE9999
.
DATE9000  MOVE      TRUE,EXIT
.
DATE9999  RETURN
+
.**********************************************************************
.*                               PALL0000                             *
.*                  Routine to print all audit files                  *
.**********************************************************************
PALL0000  MOVE      ZERO,COPTION
.
.------ get the next audit file to print ------
.
PALL1000  ADD       ONE,COPTION
.
          COMPARE   TEN3,COPTION             * see if any more audit files to 
          GOTO      PALL9999 IF EQUAL         process
.
          LOAD      FORM1,COPTION,PRCNAUDA,PRCNAUDB,PRCNAUDC,PRCNAUDD,PRCNAUDE:
                                  PRCNAUDF,PRCNAUDG,PRCNAUDH,PRCNAUDI,ZERO:
                                  ZERO,ZERO
.
          BRANCH    FORM1,PALL1000          * skip if not available
          LOAD      DESCAUD,COPTION,DESCAUDA,DESCAUDB,DESCAUDC,DESCAUDD:
                                    DESCAUDE,DESCAUDF,DESCAUDG,DESCAUDH:
                                    DESCAUDI,DESCAAUD,DESCAAUI,DESCAAUR
          CALL      PSNG0000                * print a single audit file
          GOTO      PALL1000
.
PALL9999  RETURN
+
.**********************************************************************
.*                                PSNG0000                            *
.*                  Routine to print an audit file                    *
.**********************************************************************
PSNG0000  DISPLAY   *P1:24,*EL,"Printing ",*V2LON,DESCAUD;
          MOVE      ZERO,CPAGENO
          MOVE      ZERO,TOTADDS
          MOVE      ZERO,TOTCHNGS
          MOVE      ZERO,TOTDELS
          CALL      HEAD0000                * print the page header
.
          CALL      READ0000                * read the appropriate audit file
          BRANCH    EXIT,PSNG7000:
                         PSNG9999           * audit not used
.
.------ see if we need to paginate ------
.
PSNG1000  COMPARE   "55",CLNO               * Test if paginating is required
          GOTO      PSNG2000 IF LESS
          CALL      HEAD0000                * Print the page header
.
.------ print the current record ------
.
PSNG2000  CALL      PRNT0000                * print a record 
          CALL      READ5000                * get the next record
          BRANCH    EXIT,PSNG8000
          GOTO      PSNG1000
.
.------ no records on the current audit file ------
.
PSNG7000  COMPARE   TWO,OPTION              * see if we are printing all audits
          GOTO      PSNG9999 IF EQUAL
.
          DISPLAY   *P1:24,*EL,*B,"Blank Audit file.    ";
          CALL      HITENTER
          GOTO      PSNG9000
.
.------ we have finished printing this audit file so print the totals ------
.
PSNG8000  PRINT     *N,DASH100,DASH32:
                    *N,*N,"Total Additions Printed : ",TOTADDS:
                       *N,"Total Changes   Printed : ",TOTCHNGS:
                       *N,"Total Deletions Printed : ",TOTDELS;
.
.------ print the end of report ------
.
PSNG9000  PRINT     *N,*N,"***  End of Report  ***";
.
PSNG9999  RETURN
+
.**********************************************************************
.*                               HEAD0000                             *
.*                  Routine to print the page header                  *
.**********************************************************************
HEAD0000  COMPARE   ZERO,CPAGENO            * see if we are on the first page
          GOTO      HEAD1000 IF EQUAL
          PRINT     *N,DASH100,DASH32;
.
.------ print the page header ------
.
HEAD1000  CLOCK     TIME,CTIMEIS
          CALL      HEAD132                 * print the page header
.
          BRANCH    COPTION,HEAD9999,HEAD9999,HEAD1300,HEAD9999,HEAD1500:
                            HEAD9999,HEAD1700,HEAD1800,HEAD1900,HEAD2000:
                            HEAD2100,HEAD2200
.
HEAD1300  PRINT     *N,"Doctor File (pridoctf)";
          GOTO      HEAD6000
.
...HEAD1400  PRINT     *N,"Debtors File (pridebtf)";
...          GOTO      HEAD6000
.
HEAD1500  PRINT     *N,"Medical Practice File (pripracf)";
          GOTO      HEAD6000
.
HEAD1700  PRINT     *N,"Special Pathology Tests File (prisptaf)";
          GOTO      HEAD6000
.
HEAD1800  PRINT     *N,"Exception Charging File (priexcaf)";
          GOTO      HEAD6000
.
HEAD1900  PRINT     *N,"Item File (priitemf)";
          GOTO      HEAD6000
.
HEAD2000  PRINT     *N,"Cash Deposit File (priaudaf)";
          GOTO      HEAD6000
.
HEAD2100  PRINT     *N,"Cash Deposit Invoiced File (priauiaf)";
          GOTO      HEAD6000
.
HEAD2200  PRINT     *N,"Deposits Refunded File (priauraf)";
          GOTO      HEAD6000
.
.------ print the heading details ------
.
HEAD6000  PRINT     *N,DASH100,DASH32:
                    *N,"|",*5,"Date",*12,"|",*16,"Time",*23,"|Port|Type|":
                       *35,"User | Audit Data",*132,"|":
                    *N,DASH100,DASH32;
          MOVE      SEVEN,CLNO
.
HEAD9999  RETURN
+
.**********************************************************************
.*                               READ0000                             *
.*      Routine to read a record from the appropriate audit file.     *
.*      This includes getting the first record (READ0000) and         *
.*      getting any subsequent records (READ5000).                    *
.*      SRF 612675 - Mods to set exit flag to 2 if audit is not in use*
.**********************************************************************
READ0000  MOVE      ZERO,EXIT
          BRANCH    COPTION,READ9500,READ9500,READ0300,READ9500,READ0500:
                            READ9500,READ0700,READ0800,READ0900,READ1000:
                            READ1100,READ1200
.
.------ we are processing the doctor audit file ------
.
READ0300  PACK      KEY19,FRDATE,SP20
          CALL      ASPRDO                  * get the first doctor audit file
          CALL      AKPRDO                    record
          BRANCH    OVRCD,READ9000
          MATCH     PRDOAUDD,TODATE
          GOTO      READ9000 IF LESS
          GOTO      READ9999
.
.------ we are processing the debtor audit file ------
.
...READ0400  PACK      KEY19,FRDATE,SP20
...          CALL      ASPRDB                  * get the first debtor audit file
...          CALL      AKPRDB                    record
...          BRANCH    OVRCD,READ9000
...          MATCH     PRDBAUDD,TODATE
...          GOTO      READ9000 IF LESS
...          GOTO      READ9999
.
.------ we are processing the medical practice audit file ------
.
READ0500  PACK      KEY19,FRDATE,SP20
          CALL      ASPRPR                  * get the first medical practice
          CALL      AKPRPR                    audit file record
          BRANCH    OVRCD,READ9000
          MATCH     PRPRAUDD,TODATE
          GOTO      READ9000 IF LESS
          GOTO      READ9999
.
.------ we are processing the special pathology test audit file ------
.
READ0700  PACK      KEY19,FRDATE,SP20
          CALL      ASPRSP                  * get the first item audit file
          CALL      AKPRSP                    record
          BRANCH    OVRCD,READ9000
          MATCH     PRSPAUDD,TODATE
          GOTO      READ9000 IF LESS
          GOTO      READ9999
.
.------ we are processing the exception charging audit file ------
.
READ0800  PACK      KEY19,FRDATE,SP20
          CALL      ASPREX                  * get the first item audit file
          CALL      AKPREX                    record
          BRANCH    OVRCD,READ9000
          MATCH     PREXAUDD,TODATE
          GOTO      READ9000 IF LESS
          GOTO      READ9999
.
.------ we are processing the item audit file ------
.
READ0900  PACK      KEY19,FRDATE,SP20
          CALL      ASPRIT                  * get the first item audit file
          CALL      AKPRIT                    record
          BRANCH    OVRCD,READ9000
          MATCH     PRITAUDD,TODATE
          GOTO      READ9000 IF LESS
          GOTO      READ9999
.
. ----- we are processing priaudaf -------
.
READ1000  PACK      KEY31,SP20,SP20
          CALL      RSPRAD1
          CALL      RKPRAD1
          BRANCH    OVRCD,READ9000
          GOTO      READ9999
.
. ----- we are processing priauiaf -------
.
READ1100  MOVE      SP20,KEY18
          CALL      RSPRAI1
          CALL      RKPRAI1
          BRANCH    OVRCD,READ9000
          GOTO      READ9999
.
. ----- we are processing priauraf -------
.
READ1200  MOVE      SP20,KEY13
          CALL      RSPRAR1
          CALL      RKPRAR1
          BRANCH    OVRCD,READ9000
          GOTO      READ9999
.
.------ get the next record to process from the relevant audit file ------
.
READ5000  BRANCH    COPTION,READ9500,READ9500,READ5300,READ9500,READ5500:
                            READ9500,READ5700,READ5800,READ5900,READ6000:
                            READ6100,READ6200
.
.------ get the next doctor audit file record ------
.
READ5300  CALL      AKPRDO
          BRANCH    OVRCD,READ9000
          MATCH     PRDOAUDD,TODATE
          GOTO      READ9000 IF LESS
          GOTO      READ9999
.
.------ get the next debtor audit file record ------
.
...READ5400  CALL      AKPRDB
...          BRANCH    OVRCD,READ9000
...          MATCH     PRDBAUDD,TODATE
...          GOTO      READ9000 IF LESS
...          GOTO      READ9999
.
.------ get the next medical practice audit file record ------
.
READ5500  CALL      AKPRPR
          BRANCH    OVRCD,READ9000
          MATCH     PRPRAUDD,TODATE
          GOTO      READ9000 IF LESS
          GOTO      READ9999
.
.------ get the next special pathology test audit file ------
.
READ5700  CALL      AKPRSP
          BRANCH    OVRCD,READ9000
          MATCH     PRSPAUDD,TODATE
          GOTO      READ9000 IF LESS
          GOTO      READ9999
.
.------ get the next exception charging audit file ------
.
READ5800  CALL      AKPREX
          BRANCH    OVRCD,READ9000
          MATCH     PREXAUDD,TODATE
          GOTO      READ9000 IF LESS
          GOTO      READ9999
.
.------ get the next item audit file ------
.
READ5900  CALL      AKPRIT
          BRANCH    OVRCD,READ9000
          MATCH     PRITAUDD,TODATE
          GOTO      READ9000 IF LESS
          GOTO      READ9999
.
. ----- we are processing priaudaf -------
.
READ6000  CALL      RKPRAD1
          BRANCH    OVRCD,READ9000
          GOTO      READ9999
.
. ----- we are processing priauiaf -------
.
READ6100  CALL      RKPRAI1
          BRANCH    OVRCD,READ9000
          GOTO      READ9999
.
. ----- we are processing priauraf -------
.
READ6200  CALL      RKPRAR1
          BRANCH    OVRCD,READ9000
          GOTO      READ9999
.
.------ we have reached the end of file ------
.
READ9000  MOVE      ONE,EXIT
          GOTO      READ9999
.
READ9500  MOVE      TWO,EXIT
.
READ9999  RETURN
+
.**********************************************************************
.*                               PRNT0000                             *
.*      Routine to print a record from the appropriate audit file     *
.**********************************************************************
PRNT0000  BRANCH    COPTION,PRNT9999,PRNT9999,PRNT0300,PRNT9999,PRNT0500:
                            PRNT9999,PRNT0700,PRNT0800,PRNT0900,PRNT1000:
                            PRNT1100,PRNT1200
.
.------ we are processing the doctor audit file ------
.
PRNT0300  UNPACK    PRDOAUDD,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE                 * pack the date
          MOVE      PRDOAUDR,ANS
          REP       "A1B2C3D4",ANS
          MOVE      ANS,FORM1
          LOAD      FORM6,FORM1,TOTADDS,DUMMYF6,TOTCHNGS,TOTDELS
          ADD       ONE,FORM6
          STORE     FORM6,FORM1,TOTADDS,DUMMYF6,TOTCHNGS,TOTDELS
.
          PRINT     *N,*1,"|",*2,CPCDATE,*12,"|",*14,PRDOAUDT,*23,"|",*25:
                          PRDOAUDP,*28,"|",*31,PRDOAUDR,*33,"|",*35,PRDOAUDO:
                          *40,"|",*42,PRDOPRAC,"~",PRDODOCT,"~",PRDOCLAM:
                          "~",PRDOPIND,"~",PRDOCOMM,"~",PRDOFEEP,"~",PRDOSTAT:
                          "~",PRDOSPAR,*136,"|";
          ADD       ONE,CLNO
.
          COMPARE   TWO,PRDOAUDS            * Record Status = "Printed" ?
          GOTO      PRNT9999 IF EQUAL       * yes
          MOVE      TWO,PRDOAUDS            * no, update status
          CALL      AUPRDO
          GOTO      PRNT9999
.
.------ we are processing the debtor audit file ------
.
...PRNT0400  UNPACK    PRDBAUDD,CCENT,CYEAR,CMON,CDAY
...          CALL      PACDATE                 * pack the date
...          MOVE      PRDBAUDR,ANS
...          REP       "A1B2C3D4",ANS
...          MOVE      ANS,FORM1
...          LOAD      FORM6,FORM1,TOTADDS,DUMMYF6,TOTCHNGS,TOTDELS
...          ADD       ONE,FORM6
...          STORE     FORM6,FORM1,TOTADDS,DUMMYF6,TOTCHNGS,TOTDELS
.
...          PRINT     *N,*1,"|",*2,CPCDATE,*12,"|",*14,PRDBAUDT,*23,"|",*25:
...                          PRDBAUDP,*28,"|",*31,PRDBAUDR,*33,"|",*35,PRDBAUDO:
...                          *40,"|",*42,PRDBDEBT,"~",PRDBSNAM,"~",PRDBGNAM:
...                          "~",PRDBTITL,"~",PRDBADD1,"~",*132,"|":
...                    *N,*1,"|",*12,"|",*23,"|",*28,"|",*33,"|",*40,"|":
...                       *42,PRDBADD2,"~",PRDBADD3,"~",PRDBPOST,"~",PRDBTELP:
...                       "~",PRDBTELB,"~",*132,"|":
...                    *N,*1,"|",*12,"|",*23,"|",*28,"|",*33,"|",*40,"|":
...                       *42,PRDBPOSN,"~",PRDBRNAM,"~",*132,"|":
...                    *N,*1,"|",*12,"|",*23,"|",*28,"|",*33,"|",*40,"|":
...                       *42,PRDBRAD1,"~",PRDBRAD2,"~",PRDBRAD3,"~",PRDBRPOS:
...                       "~",*132,"|":
...                    *N,*1,"|",*12,"|",*23,"|",*28,"|",*33,"|",*40,"|":
...                       *42,PRDBRTEP,"~",PRDBRTEB,"~",PRDBRREL,"~",PRDBFUND:
...                       "~",PRDBTABL,"~",PRDBMEMN,"~",PRDBEXTC,"~",PRDBRATE:
...                       "~",PRDBMEDN,"~",PRDBBADD,"~",*132,"|":
...                    *N,*1,"|",*12,"|",*23,"|",*28,"|",*33,"|",*40,"|":
...                       *42,PRDBHOLD,"~",PRDBUDF1,"~",PRDBUDF2,"~",PRDBUDF3:
...                       "~",PRDBUDF4,"~",PRDBLOCK,"~",PRDBADMN,"~",PRDBDOBH:
...                       "~",PRDBSPAR,*132,"|";
...          ADD       SIX,CLNO
.
...          COMPARE   TWO,PRDBAUDS            * Record Status = "Printed" ?
...          GOTO      PRNT9999 IF EQUAL       * yes
...          MOVE      TWO,PRDBAUDS            * no, update status
...          CALL      AUPRDB
...          GOTO      PRNT9999
.
.------ we are processing the medical practice audit file ------
.
PRNT0500  UNPACK    PRPRAUDD,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE                 * pack the date
          MOVE      PRPRAUDR,ANS
          REP       "A1B2C3D4",ANS
          MOVE      ANS,FORM1
          LOAD      FORM6,FORM1,TOTADDS,DUMMYF6,TOTCHNGS,TOTDELS
          ADD       ONE,FORM6
          STORE     FORM6,FORM1,TOTADDS,DUMMYF6,TOTCHNGS,TOTDELS
.
          PRINT     *N,*1,"|",*2,CPCDATE,*12,"|",*14,PRPRAUDT,*23,"|":
                          *25,PRPRAUDP,*28,"|",*31,PRPRAUDR,*33,"|":
                          *35,PRPRAUDO,*40,"|",*42,PRPRCODE,"~",PRPRDESC,"~":
                          PRPRPDOC,"~",PRPRADD1,"~",*132,"|":
                    *N,*1,"|",*12,"|",*23,"|",*28,"|",*33,"|",*40,"|":
                          *42,PRPRADD2,"~",PRPRADD3,"~",PRPRPOST,"~",PRPRTELP:
                          "~",PRPRSTAT,"~",PRPRTIME,"~",PRPRSPAR,*132,"|";
          ADD       TWO,CLNO
.
          COMPARE   TWO,PRPRAUDS            * Record Status = "Printed" ?
          GOTO      PRNT9999 IF EQUAL       * yes
          MOVE      TWO,PRPRAUDS            * no, update status
          CALL      AUPRPR
          GOTO      PRNT9999
.
.------ we are processing the special pathology tests audit file ------
.
PRNT0700  UNPACK    PRSPAUDD,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE                 * pack the date
          MOVE      PRSPAUDR,ANS
          REP       "A1B2C3D4",ANS
          MOVE      ANS,FORM1
          LOAD      FORM6,FORM1,TOTADDS,DUMMYF6,TOTCHNGS,TOTDELS
          ADD       ONE,FORM6
          STORE     FORM6,FORM1,TOTADDS,DUMMYF6,TOTCHNGS,TOTDELS
.
          PRINT     *N,*1,"|",*2,CPCDATE,*12,"|",*14,PRSPAUDT,*23,"|":
                          *25,PRSPAUDP,*28,"|",*31,PRSPAUDR,*33,"|":
                          *35,PRSPAUDO,*40,"|",*42,PRSPFLAG,"~":
                          PRSPITM1,"~",PRSPSUB1,"~",PRSPEDAT,"~",PRSPITM2,"~":
                          PRSPSUB2,"~",PRSPITMN,"~",PRSPSUBN,"~",PRSPSPAR:
                         *132,"|";
          ADD       ONE,CLNO
.
          COMPARE   TWO,PRSPAUDS            * Record Status = "Printed" ?
          GOTO      PRNT9999 IF EQUAL       * yes
          MOVE      TWO,PRSPAUDS            * no, update status
          CALL      AUPRSP
          GOTO      PRNT9999
.
.------ we are processing the exception charging audit file ------
.
PRNT0800  UNPACK    PREXAUDD,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE                 * pack the date
          MOVE      PREXAUDR,ANS
          REP       "A1B2C3D4",ANS
          MOVE      ANS,FORM1
          LOAD      FORM6,FORM1,TOTADDS,DUMMYF6,TOTCHNGS,TOTDELS
          ADD       ONE,FORM6
          STORE     FORM6,FORM1,TOTADDS,DUMMYF6,TOTCHNGS,TOTDELS
.
          PRINT     *N,*1,"|",*2,CPCDATE,*12,"|",*14,PREXAUDT,*23,"|":
                          *25,PREXAUDP,*28,"|",*31,PREXAUDR,*33,"|":
                          *35,PREXAUDO,*40,"|",*42,PREXCLM,"~",PREXFLAG,"~":
                          PREXITMN,"~",PREXSUBN,"~",PREXDAT1,"~",PREXCHRG,"~":
                          PREXDAT2,"~",PREXSPAR,*132,"|";
          ADD       ONE,CLNO
.
          COMPARE   TWO,PREXAUDS            * Record Status = "Printed" ?
          GOTO      PRNT9999 IF EQUAL       * yes
          MOVE      TWO,PREXAUDS            * no, update status
          CALL      AUPREX
          GOTO      PRNT9999
.
.------ we are processing the item audit file ------
.
PRNT0900  UNPACK    PRITAUDD,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE                 * pack the date
          MOVE      PRITAUDR,ANS
          REP       "A1B2C3D4",ANS
          MOVE      ANS,FORM1
          LOAD      FORM6,FORM1,TOTADDS,DUMMYF6,TOTCHNGS,TOTDELS
          ADD       ONE,FORM6
          STORE     FORM6,FORM1,TOTADDS,DUMMYF6,TOTCHNGS,TOTDELS
.
          MOVE      PRITSFEE,FORM8P2
          PRINT     *N,*1,"|",*2,CPCDATE,*12,"|",*14,PRITAUDT,*23,"|",*25:
                          PRITAUDP,*28,"|",*31,PRITAUDR,*33,"|",*35,PRITAUDO:
                          *40,"|",*42,PRITFLAG,"~",PRITITMN,"~",PRITSUBN:
                          "~",PRITDAT1,"~",PRITDESC,"~",PRITKEYI,"~",FORM8P2:
                          "~",PRITSETC,"~",PRITDAT2,"~",PRITICAT,"~",*132,"|":
                    *N,*1,"|",*12,"|",*23,"|",*28,"|",*33,"|",*40,"|":
                          *42,PRITIGRP,"~",PRITSGRP,"~",PRITFTYP,"~",PRITPTYP:
                          "~",PRITPATH,"~",PRITMAXR,"~",PRITDAYS,"~",PRITSTEP:
                          "~",PRITSTSB,"~",PRITFIXD,"~",PRITSPAR:
                          *132,"|";
          ADD       TWO,CLNO
.
          COMPARE   TWO,PRITAUDS            * Record Status = "Printed" ?
          GOTO      PRNT9999 IF EQUAL       * yes
          MOVE      TWO,PRITAUDS            * no, update status
          CALL      AUPRIT
          GOTO      PRNT9999
.
. ------- printing priaudaf -------
.
PRNT1000  UNPACK    PRADDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PRINT     *N,*1,"|",*2,CPCDATE,*12,"| ",PRADTIME,*23,"| ":
                          PRADPORT,*28,"|",*31,ANSA,*33,"|",*35,PRADOPER:
                          *40,"| ",PRADDEBT,"~",PRADSCAN,"~",PRADPRAC,"~":
                          PRADRECP,"~",PRADTCNT,"~",PRADAMNT,"~",PRADMETH:
                          "~",PRADDRAW,*132,"|":
                    *N,*1,"|",*12,"|",*23,"|",*28,"|",*33,"|":
                       *40,"| ",PRADBANK,"~",PRADBRNC,*132,"|";
          ADD       TWO,CLNO
          GOTO      PRNT9999
.
. ------- printing priauiaf -------
.
PRNT1100  UNPACK    PRAIDDTE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PRINT     *N,*1,"|",*2,CPCDATE,*12,"|",*23,"| ":
                          PRAIPORT,*28,"|",*31,ANSA,*33,"|",*35,PRAIOPER:
                          *40,"| ",PRAIDEBT,"~",PRAISCAN,"~",PRAIINVN:
                          "~",PRAIIDTE,"~",PRAIDDTE,"~",PRAIAMNT,*132,"|";
          ADD       ONE,CLNO
          GOTO      PRNT9999
.
. ------- printing priauraf -------
.
PRNT1200  UNPACK    PRARRFDT,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PRINT     *N,*1,"|",*2,CPCDATE,*12,"|",*23,"| ":
                          PRARPORT,*28,"|",*31,ANSD,*33,"|",*35,PRAROPER:
                          *40,"| ",PRARDEBT,"~",PRARSCAN,"~",PRARUNIQ:
                          "~",PRARRECT,"~",PRARAMNT,*132,"|";
          ADD       ONE,CLNO
          GOTO      PRNT9999
.
PRNT9999  RETURN
+
.**********************************************************************
.*                               RSTA0000                             *
.*        clear only Records with "Printed" STAtus or all records     *
.**********************************************************************
RSTA0000  COMPARE   TEN,COPTION
          GOTO      RSTA9999 IF NOT LESS    * dont ask for these audits
.
          MOVE      SP1,ANS
          DISPLAY   *P1:24,*EL,"Clear only (":
                    *V2LON,ANSP,*HOFF,")rinted records or (":
                    *V2LON,ANSA,*HOFF,")ll records ? ";
.
RSTA1000  KEYIN     *P49:24,*EL,*V2LON,ANS;
          RESET     ANS
          GOTO      RSTA9000 IF EOS
          REP       UPPLOW,ANS
.
          MATCH     ANSP,ANS
          GOTO      RSTA2000 IF EQUAL
          MATCH     ANSA,ANS
          GOTO      RSTA2000 IF EQUAL
          BEEP
          GOTO      RSTA1000
.
RSTA2000  REP       "P1A2",ANS
          MOVE      ANS,CEXIT
          MOVE      FALSE,EXIT
          GOTO      RSTA9999
.
RSTA9000  MOVE      TRUE,EXIT
.
RSTA9999  RETURN
+
.**********************************************************************
.*                               CALL0000                             *
.*                  Routine to clear all audit files                  *
.**********************************************************************
CALL0000  MOVE      ZERO,COPTION
.
.------ get the next audit file to print ------
.
CALL1000  ADD       ONE,COPTION
.
          COMPARE   TEN3,COPTION             * see if any more audit files to 
          GOTO      CALL9999 IF EQUAL         process
.
          LOAD      FORM1,COPTION,PRCNAUDA,PRCNAUDB,PRCNAUDC,PRCNAUDD,PRCNAUDE:
                                  PRCNAUDF,PRCNAUDG,PRCNAUDH,PRCNAUDI,ZERO:
                                  ZERO,ZERO
.
          BRANCH    FORM1,CALL1000          * skip if not available
          CALL      CSNG0000                * clear a single audit file
          GOTO      CALL1000
.
CALL9999  RETURN
+
.**********************************************************************
.*                               CSNG0000                             *
.*                  Routine to clear an audit file                    *
.**********************************************************************
CSNG0000  LOAD      DESCAUD,COPTION,DESCAUDA,DESCAUDB,DESCAUDC,DESCAUDD:
                                    DESCAUDE,DESCAUDF,DESCAUDG,DESCAUDH:
                                    DESCAUDI,DESCAAUD,DESCAAUI,DESCAAUR
          DISPLAY   *P1:24,*EL,"Clearing data from ",*V2LON,DESCAUD;
.
          BRANCH    COPTION,CSNG9999,CSNG9999,CSNG0300,CSNG9999,CSNG0500:
                            CSNG9999,CSNG0700,CSNG0800,CSNG0900,CSNG1000:
                            CSNG1100,CSNG1200
          GOTO      CSNG9999
.
CSNG0300  CALL      CDOC0000                * clear Doctor file audit
          GOTO      CSNG9999
.
..CSNG0400  CALL      CDEB0000                * clear Debtor file audit
..          GOTO      CSNG9999
.
CSNG0500  CALL      CMPR0000                * clear Medical Practice file audit
          GOTO      CSNG9999
.
CSNG0700  CALL      CSPT0000                * clear special pathology audits
          GOTO      CSNG9999
.
CSNG0800  CALL      CEXC0000                * clear except. charging audits
          GOTO      CSNG9999
.
CSNG0900  CALL      CITM0000                * clear Item file audits
          GOTO      CSNG9999
.
CSNG1000  CALL      CAUD0000                * clear cash deposits
          GOTO      CSNG9999
.
CSNG1100  CALL      CAUI0000                * clear cash deposits invoiced
          GOTO      CSNG9999
.
CSNG1200  CALL      CAUR0000                * clear deposits refunded
          GOTO      CSNG9999
.
CSNG9999  RETURN
+
.******************************************************************************
.*                                  CDOC0000                                  *
.*                  Clear DOCtor file audits (printed or all)                 *
.******************************************************************************
CDOC0000  BRANCH    CEXIT,CDOC1000
.
. ------  clear All records  ------
.
          CLOSE     PRIAUDDO
          CLEAR     CMDLINE
          APPEND    "iserase priauddo",CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          CLEAR     CMDLINE
          APPEND    "isbuild priauddo",CMDLINE
          APPEND    " 95 D1-8,9-16,17-18,19-19",CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
          OPEN      PRIAUDDO,"priauddo"
          GOTO      CDOC9999
.
. ------  clear only Printed records  ------
.
CDOC1000  PACK      KEY19,SP20              * position at start of file
          CALL      ASPRDO

CDOC2000  CALL      AKPRDO                  * read next record
          BRANCH    OVRCD,CDOC9999          * end of file
          BRANCH    PRDOAUDS,CDOC2000       * if record not printed get next one
.
.         Delete the record
.
CDOC3000  DISPLAY   *P75:24,*EL,*V2LON,PRDOAUDR;
          PACK      KEY19,PRDOAUDD,PRDOAUDT,PRDOAUDP,PRDOAUDR
          CALL      ADPRDO
.
.         save key for checking
.
          PACK      OLDKEY19,PRDOAUDD,PRDOAUDT,PRDOAUDP,PRDOAUDR
.
.**** Reposition in case of duplicate keys
.
          PACK      KEY19,PRDOAUDD,PRDOAUDT,PRDOAUDP,SP1
          CALL      ASPRDO
          CALL      AKPRDO
          BRANCH    OVRCD,CDOC9999
.
          PACK      KEY19,PRDOAUDD,PRDOAUDT,PRDOAUDP,PRDOAUDR
.
          MATCH     KEY19,OLDKEY19       * same key ?
          GOTO      CDOC3000 IF EQUAL    * yes, delete record
.
          PACK      KEY19,PRDOAUDD,PRDOAUDT,PRDOAUDP,SP1
          CALL      ASPRDO
          GOTO      CDOC2000
.
CDOC9999  RETURN
+
.******************************************************************************
.*                                  CDEB0000                                  *
.*                  Clear DEBtors file audits (printed or all)                *
.******************************************************************************
...CDEB0000  BRANCH    CEXIT,CDEB1000
.
. ------  clear All records  ------
.
...          CLOSE     PRIAUDDB
...          CLEAR     CMDLINE
...          APPEND    "iserase priauddb",CMDLINE
...          RESET     CMDLINE
...          EXECUTE   CMDLINE,TASKID
.
...          CLEAR     CMDLINE
...          APPEND    "isbuild priauddb",CMDLINE
...          APPEND    " 451 D1-8,9-16,17-18,19-19",CMDLINE
...          RESET     CMDLINE
...          EXECUTE   CMDLINE,TASKID
...          OPEN      PRIAUDDB,"priauddb"
...          GOTO      CDEB9999
.
. ------  clear only Printed records  ------
.
...CDEB1000  PACK      KEY19,SP20              * position at start of file
...          CALL      ASPRDB
...
...CDEB2000  CALL      AKPRDB                  * read next record
...          BRANCH    OVRCD,CDEB9999          * end of file
...          BRANCH    PRDBAUDS,CDEB2000       * if record not printed get next one
.
.         Delete the record
.
...CDEB3000  DISPLAY   *P75:24,*EL,*V2LON,PRDBAUDR;
...          PACK      KEY19,PRDBAUDD,PRDBAUDT,PRDBAUDP,PRDBAUDR
...          CALL      ADPRDB
.
.         save key for checking
.
...          PACK      OLDKEY19,PRDBAUDD,PRDBAUDT,PRDBAUDP,PRDBAUDR
.
.**** Reposition in case of duplicate keys
.
...          PACK      KEY19,PRDBAUDD,PRDBAUDT,PRDBAUDP,SP1
...          CALL      ASPRDB
...          CALL      AKPRDB
...          BRANCH    OVRCD,CDEB9999
.
...          PACK      KEY19,PRDBAUDD,PRDBAUDT,PRDBAUDP,PRDBAUDR
.
...          MATCH     KEY19,OLDKEY19       * same key ?
...          GOTO      CDEB3000 IF EQUAL    * yes, delete record
.
...          PACK      KEY19,PRDBAUDD,PRDBAUDT,PRDBAUDP,SP1
...          CALL      ASPRDB
...          GOTO      CDEB2000
.
...CDEB9999  RETURN
+
.******************************************************************************
.*                                  CMPR0000                                  *
.*            Clear Medical PRactice file audits (printed or all)             *
.******************************************************************************
CMPR0000  BRANCH    CEXIT,CMPR1000
.
. ------  clear All records  ------
.
          CLOSE     PRIAUDPR
          CLEAR     CMDLINE
          APPEND    "iserase priaudpr",CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          CLEAR     CMDLINE
          APPEND    "isbuild priaudpr",CMDLINE
          APPEND    " 168 D1-8,9-16,17-18,19-19",CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
          OPEN      PRIAUDPR,"priaudpr"
          GOTO      CMPR9999
.
. ------  clear only Printed records  ------
.
CMPR1000  PACK      KEY19,SP20              * position at start of file
          CALL      ASPRPR

CMPR2000  CALL      AKPRPR                  * read next record
          BRANCH    OVRCD,CMPR9999          * end of file
          BRANCH    PRPRAUDS,CMPR2000       * if record not printed get next one
.
.         Delete the record
.
CMPR3000  DISPLAY   *P75:24,*EL,*V2LON,PRPRAUDR;
          PACK      KEY19,PRPRAUDD,PRPRAUDT,PRPRAUDP,PRPRAUDR
          CALL      ADPRPR
.
.         save key for checking
.
          PACK      OLDKEY19,PRPRAUDD,PRPRAUDT,PRPRAUDP,PRPRAUDR
.
.**** Reposition in case of duplicate keys
.
          PACK      KEY19,PRPRAUDD,PRPRAUDT,PRPRAUDP,SP1
          CALL      ASPRPR
          CALL      AKPRPR
          BRANCH    OVRCD,CMPR9999
.
          PACK      KEY19,PRPRAUDD,PRPRAUDT,PRPRAUDP,PRPRAUDR
.
          MATCH     KEY19,OLDKEY19       * same key ?
          GOTO      CMPR3000 IF EQUAL    * yes, delete record
.
          PACK      KEY19,PRPRAUDD,PRPRAUDT,PRPRAUDP,SP1
          CALL      ASPRPR
          GOTO      CMPR2000
.
CMPR9999  RETURN
+
.******************************************************************************
.*                                  CSPT0000                                  *
.*               Clear MBS/AMA Item file audits (printed or all)              *
.******************************************************************************
CSPT0000  BRANCH    CEXIT,CSPT1000
.
. ------  clear All records  ------
.
          CLOSE     PRIAUDSP
          CLEAR     CMDLINE
          APPEND    "iserase priaudsp",CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          CLEAR     CMDLINE
          APPEND    "isbuild priaudsp",CMDLINE
          APPEND    " 93 D1-8,9-16,17-18,19-19",CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
          OPEN      PRIAUDSP,"priaudsp"
          GOTO      CSPT9999
.
. ------  clear only Printed records  ------
.
CSPT1000  PACK      KEY19,SP20              * position at start of file
          CALL      ASPRSP

CSPT2000  CALL      AKPRSP                  * read next record
          BRANCH    OVRCD,CSPT9999          * end of file
          BRANCH    PRSPAUDS,CSPT2000       * if record not printed get next one
.
.         Delete the record
.
CSPT3000  DISPLAY   *P75:24,*EL,*V2LON,PRSPAUDR;
          PACK      KEY19,PRSPAUDD,PRSPAUDT,PRSPAUDP,PRSPAUDR
          CALL      ADPRSP
.
.         save key for checking
.
          PACK      OLDKEY19,PRSPAUDD,PRSPAUDT,PRSPAUDP,PRSPAUDR
.
.**** Reposition in case of duplicate keys
.
          PACK      KEY19,PRSPAUDD,PRSPAUDT,PRSPAUDP,SP1
          CALL      ASPRSP
          CALL      AKPRSP
          BRANCH    OVRCD,CSPT9999
.
          PACK      KEY19,PRSPAUDD,PRSPAUDT,PRSPAUDP,PRSPAUDR
.
          MATCH     KEY19,OLDKEY19       * same key ?
          GOTO      CSPT3000 IF EQUAL    * yes, delete record
.
          PACK      KEY19,PRSPAUDD,PRSPAUDT,PRSPAUDP,SP1
          CALL      ASPRSP
          GOTO      CSPT2000
.
CSPT9999  RETURN
+
.******************************************************************************
.*                                  CEXC0000                                  *
.*               Clear MBS/AMA Item file audits (printed or all)              *
.******************************************************************************
CEXC0000  BRANCH    CEXIT,CEXC1000
.
. ------  clear All records  ------
.
          CLOSE     PRIAUDEX
          CLEAR     CMDLINE
          APPEND    "iserase priaudex",CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          CLEAR     CMDLINE
          APPEND    "isbuild priaudex",CMDLINE
          APPEND    " 83 D1-8,9-16,17-18,19-19",CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
          OPEN      PRIAUDEX,"priaudex"
          GOTO      CEXC9999
.
. ------  clear only Printed records  ------
.
CEXC1000  PACK      KEY19,SP20              * position at start of file
          CALL      ASPREX

CEXC2000  CALL      AKPREX                  * read next record
          BRANCH    OVRCD,CEXC9999          * end of file
          BRANCH    PREXAUDS,CEXC2000       * if record not printed get next one
.
.         Delete the record
.
CEXC3000  DISPLAY   *P75:24,*EL,*V2LON,PREXAUDR;
          PACK      KEY19,PREXAUDD,PREXAUDT,PREXAUDP,PREXAUDR
          CALL      ADPREX
.
.         save key for checking
.
          PACK      OLDKEY19,PREXAUDD,PREXAUDT,PREXAUDP,PREXAUDR
.
.**** Reposition in case of duplicate keys
.
          PACK      KEY19,PREXAUDD,PREXAUDT,PREXAUDP,SP1
          CALL      ASPREX
          CALL      AKPREX
          BRANCH    OVRCD,CEXC9999
.
          PACK      KEY19,PREXAUDD,PREXAUDT,PREXAUDP,PREXAUDR
.
          MATCH     KEY19,OLDKEY19       * same key ?
          GOTO      CEXC3000 IF EQUAL    * yes, delete record
.
          PACK      KEY19,PREXAUDD,PREXAUDT,PREXAUDP,SP1
          CALL      ASPREX
          GOTO      CEXC2000
.
CEXC9999  RETURN
+
.******************************************************************************
.*                                  CITM0000                                  *
.*               Clear MBS/AMA Item file audits (printed or all)              *
.******************************************************************************
CITM0000  BRANCH    CEXIT,CITM1000
.
. ------  clear All records  ------
.
          CLOSE     PRIAUDIT
          CLEAR     CMDLINE
          APPEND    "iserase priaudit",CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          CLEAR     CMDLINE
          APPEND    "isbuild priaudit",CMDLINE
          APPEND    " 150 D1-8,9-16,17-18,19-19",CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
          OPEN      PRIAUDIT,"priaudit"
          GOTO      CITM9999
.
. ------  clear only Printed records  ------
.
CITM1000  PACK      KEY19,SP20              * position at start of file
          CALL      ASPRIT

CITM2000  CALL      AKPRIT                  * read next record
          BRANCH    OVRCD,CITM9999          * end of file
          BRANCH    PRITAUDS,CITM2000       * if record not printed get next one
.
.         Delete the record
.
CITM3000  DISPLAY   *P75:24,*EL,*V2LON,PRITAUDR;
          PACK      KEY19,PRITAUDD,PRITAUDT,PRITAUDP,PRITAUDR
          CALL      ADPRIT
.
.         save key for checking
.
          PACK      OLDKEY19,PRITAUDD,PRITAUDT,PRITAUDP,PRITAUDR
.
.**** Reposition in case of duplicate keys
.
          PACK      KEY19,PRITAUDD,PRITAUDT,PRITAUDP,SP1
          CALL      ASPRIT
          CALL      AKPRIT
          BRANCH    OVRCD,CITM9999
.
          PACK      KEY19,PRITAUDD,PRITAUDT,PRITAUDP,PRITAUDR
.
          MATCH     KEY19,OLDKEY19       * same key ?
          GOTO      CITM3000 IF EQUAL    * yes, delete record
.
          PACK      KEY19,PRITAUDD,PRITAUDT,PRITAUDP,SP1
          CALL      ASPRIT
          GOTO      CITM2000
.
CITM9999  RETURN
+
.*********************************************************************
.         clear the audit file for priaudaf
.*********************************************************************
CAUD0000  PACK      KEY31,SP20,SP20
          CALL      RSPRAD1
          CALL      RKPRAD1
          BRANCH    OVRCD,CAUD9999
          PACK      KEY31,PRADDEBT,PRADSCAN,PRADPRAC,PRADRECP,PRADTCNT
          CALL      DEPRAD1
          GOTO      CAUD0000
CAUD9999  RETURN
+
.*********************************************************************
.         clear the audit file for priauiaf
.*********************************************************************
CAUI0000  MOVE      SP20,KEY18
          CALL      RSPRAI1
          CALL      RKPRAI1
          BRANCH    OVRCD,CAUI9999
          PACK      KEY18,PRAIDEBT,PRAISCAN,PRAIINVN
          DISPLAY   *P60:24,*V2LON,KEY18
          CALL      DEPRAI1
          GOTO      CAUI0000
CAUI9999  RETURN
+
.*********************************************************************
.         clear the audit file for priauraf
.*********************************************************************
CAUR0000  MOVE      SP20,KEY13
          CALL      RSPRAR1
          CALL      RKPRAR1
          BRANCH    OVRCD,CAUR9999
          PACK      KEY13,PRARDEBT,PRARSCAN,PRARUNIQ
          DISPLAY   *P65:24,*V2LON,KEY13
          CALL      DEPRAR1
          GOTO      CAUR0000
CAUR9999  RETURN
+
.******************************************************************************
.
          INC       STD001IO
          INC       PRIAUDIO/INC
          INC       PRIAUIIO/INC
          INC       PRIAURIO/INC
...          INC       PRIDBTIO/INC
          INC       PRIDOCIO/INC
          INC       PRIEXCIO/INC
          INC       PRIITMIO/INC
          INC       PRISPTIO/INC
          INC       PRIPRAIO/INC
...............................................................................
