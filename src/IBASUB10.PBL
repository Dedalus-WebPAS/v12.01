.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.01.00"
.-------------------------------------------------------
. V9.04.01  13.04.2005 Peter Vela CAR 59696
.           Recompiled for SINSUAFD
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.00.01  29.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASUB10
.   Function      :   Product Group Analysis                  
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       SINCONFD/INC
          INC       SINPERFD/INC
          INC       SINSUAFD/INC
          INC       SINSUBFD/INC
          INC       SINTMPDF/INC
.=========================
.Local Variable Definition
.-------------------------
FROMNAME  DIM      30 * Scr 00 Fld     3
TONAME    DIM      30 * Scr 00 Fld     4
FGROUP    DIM       5 * Scr 00 Fld    10
TGROUP    DIM       5 * Scr 00 Fld    11
ANALTYPE  FORM      1 * Scr 00 Fld    12
ANALDESC  DIM      15 * Scr 00 Fld    13
COMPTYPE  FORM      1 * Scr 00 Fld    14
COMPDESC  DIM      15 * Scr 00 Fld    15
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASUB10"
PRGNAM    INIT      "Product Group Analysis                  "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA1,"sinperaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA2,"sinperaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA2,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA3,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsubaf";
          OPEN      SINSUBA1,"sinsubaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Reporting Options                  
          ENDIF
          RETURN
.--------------------------------
. Screen - Reporting Options                  
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    9",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      MVACCEPT
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Reporting Options                  
.-------------------------------------------------------
CF00L000
          MOVE      SP70,FROMCODE
          MOVE      SP70,TOCODE  
          MOVE      SP70,FROMNAME
          MOVE      SP70,TONAME  
          MOVE      SP70,SIPEYEAR
          MOVE      SP70,SIPEPER 
          MOVE      SP70,FGROUP  
          MOVE      SP70,TGROUP  
          MOVE      ZERO,ANALTYPE
          MOVE      SP70,ANALDESC
          MOVE      ZERO,COMPTYPE
          MOVE      SP70,COMPDESC
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Reporting Options                  
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Reporting Options                  
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Reporting Options                  
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Reporting Options                  
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Reporting Options                  
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L101,PS00L102,PS00L103,PS00L104:
                            PS00L105,PS00L106,PS00L999,PS00L999:
                            PS00L999,PS00L107,PS00L108,PS00L109:
                            PS00L110,PS00L111,PS00L112
          GOTO     PS00L999
.
PS00L101
          MOVE      FROMCODE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      TOCODE,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      FROMNAME,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      TONAME,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      SIPEYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      SIPEPER,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      FGROUP,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      TGROUP,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      ANALTYPE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      ANALDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      COMPTYPE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      COMPDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Reporting Options                  
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L101,SF00L006,SF00L006,SF00L006:
                            SF00L102,SF00L103,SF00L104,SF00L105:
                            SF00L006,SF00L006,SF00L006,SF00L106:
                            SF00L006,SF00L107,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L101,SF00L020,SF00L020,SF00L020:
                            SF00L102,SF00L103,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L106:
                            SF00L020,SF00L107,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCODE  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FROMNAME
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TONAME  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EGRP0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L101
            ENDIF
            BRANCH    EXIT,SF00L101,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FROMCODE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCODE,VAR       
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    3",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FROMNAME,VAR     
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TONAME,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L102
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EYEAR000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L102
            ENDIF
            BRANCH    EXIT,SF00L102,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      SIPEYEAR,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPERD000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L103
            ENDIF
            BRANCH    EXIT,SF00L103,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      SIPEPER,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L104
          CALL      REPT0000
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L105
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L106
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,ANALDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EANAL000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L106
            ENDIF
            BRANCH    EXIT,SF00L106,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      ANALTYPE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      ANALDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L107
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,COMPDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOMP000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
            BRANCH    EXIT,SF00L107,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      COMPTYPE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      COMPDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
SF00L990  MOVE      FOUR,EXIT * Exit Char Exit
SF00L999  RETURN
.@@@@@ Function Restart Point @@@@@
.----------------------------------------
. Move one to accept to for insert mode
.----------------------------------------
MVACCEPT  MOVE      ONE,ACCEPT
          RETURN
EGRP0000  MOVE      "    1",FLDID
          CALL      GETPOSIT
          MOVE      ZERO,CKEYTYP
          CALL      KSISAA00
          BRANCH    EXIT,EGRP1000,EGRP9999
          MOVE      SISACODE,FGROUP
          MOVE      SISACODE,FROMCODE
          MOVE      SISADESC,FROMNAME
          GOTO      EGRP2000
.
EGRP1000  MOVE      SP70,FGROUP
          MOVE      "Start",FROMCODE
          MOVE      SP70,FROMNAME
.
EGRP2000  MOVE      "    2",FLDID
          CALL      GETPOSIT
          MOVE      ZERO,CKEYTYP
          CALL      KSISAA00
          BRANCH    EXIT,EGRP3000,EGRP9999
          MOVE      SISACODE,TGROUP
          MOVE      SISACODE,TOCODE
          MOVE      SISADESC,TONAME
          GOTO      EGRP9000
.
EGRP3000  MOVE      "ZZZZZ",TGROUP
          MOVE      "End  ",TOCODE
          MOVE      SP70,TONAME
.
EGRP9000  MOVE      "    1",FLDID
          CALL      GETPOSIT
EGRP9999  RETURN
EYEAR000  CALL      RINPECON
          MOVE      SIPECYR,SIPEYEAR
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,*JR,SIPEYEAR
          PACK      SIPEYEAR,SIPEYEAR,SP70
.
          MATCH     SP70,SIPEYEAR
          GOTO      EYEAR990 IF EQUAL
          PACK      KEY4,SP3,EXITCHAR * exitchar entered ?
          MATCH     KEY4,SIPEYEAR
          GOTO      EYEAR990 IF EQUAL
.
          TYPE      SIPEYEAR           * valid numeric ?
          GOTO      EYEAR000 IF NOT EQUAL
.
          MOVE      SIPEYEAR,SIPEYF4
          IF        SIPEYF4<100
            SQUEEZE   SIPEYEAR
            MOVE      SIPEYEAR,FORM2
            PACK      SIPEYEAR,CCC,FORM2,SP70
          ENDIF
.
          REP       " 0",SIPEYEAR
          MOVE      ZERO,EXIT
          GOTO      EYEAR999
.
EYEAR990  MOVE      TWO,EXIT
.
EYEAR999  RETURN
EPERD000  KEYIN     *PCCOL:CVERT,*V2LON,*RV,F2
          COMPARE   ZERO,F2
          GOTO      EPERD990 IF EQUAL
          IF        F2>SIPENUM
            BEEP
            MOVE      "Invalid Period. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      EPERD000
          ENDIF
          MOVE      F2,SIPEPER
          REP       " 0",SIPEPER
          PACK      KEY6,SIPEYEAR,SIPEPER
          REP       " 0",KEY6
          CALL      RDSIPE1
          IF        OVRCD=1
            BEEP
            MOVE      "Period NOT Created. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      EPERD000
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      EPERD999
.
EPERD990  MOVE      TWO,EXIT
.
EPERD999  RETURN
.------------------------------------------------------------------------------
. REPT - Print Out Report
.------------------------------------------------------------------------------
REPT0000  DISPLAY   *P1:24,*EL,"Processing - "
          MOVE      "80",CLNO                         * Set up print values
          MOVE      "0",CPAGENO
          CLOCK     TIME,CTIMEIS
.
          MOVE      SIPEYEAR,SIPEYF4
          SUB       ONE,SIPEYF4
          MOVE      SIPEYF4,LASTYEAR
          REP       " 0",LASTYEAR
.
          MOVE      ZERO,TOTLYRMT
          MOVE      ZERO,TOTLYRDT
          MOVE      ZERO,TOTCYRMT
          MOVE      ZERO,TOTCYRDT
.
          PACK      KEY5,FGROUP
          CALL      RDSISA1
          IF        OVRCD=0
            CALL      RPSISA1
          ENDIF
REPT1000  CALL      RKSISA1
          BRANCH    OVRCD,REPT9000
          MATCH     SISACODE,TGROUP
          GOTO      REPT9000 IF LESS
.
          DISPLAY   *P15:24,*EL,SISACODE
.
          CALL      CALC0000
.
          COMPARE   "55",CLNO               * Number of Lines Test
          CALL      HEAD0000 IF NOT LESS
.
          ASSIGN    CURRYRMT-LASTYRMT,VARIAN1A
          ASSIGN    CURRYRDT-LASTYRDT,VARIAN1B
          ASSIGN    ((CURRYRMT-LASTYRMT)/LASTYRMT)*100.0,F12X4
          MOVE      F12X4,PERCEN1A
          ASSIGN    ((CURRYRDT-LASTYRDT)/LASTYRDT)*100.0,F12X4
          MOVE      F12X4,PERCEN1B
          PRINT     *1,"!",*3,SISACODE,*10,SISADESC,*43,"!":
                    *44,LASTYRMT,*56,LASTYRDT:
                    *68,"!",*69,CURRYRMT,*81,CURRYRDT:
                    *92,"!",*93,VARIAN1A,*105,PERCEN1A,"%":
                    *113,VARIAN1B,*125,PERCEN1B,"%",*132,"!"
          ADD       "1",CLNO
.
          ADD       LASTYRMT,TOTLYRMT
          ADD       LASTYRDT,TOTLYRDT
          ADD       CURRYRMT,TOTCYRMT
          ADD       CURRYRDT,TOTCYRDT
          GOTO      REPT1000
.
REPT9000  CALL      UND132                  * Print Page Footer
          ASSIGN    TOTCYRMT-TOTLYRMT,VARIAN1A
          ASSIGN    TOTCYRDT-TOTLYRDT,VARIAN1B
          PRINT     *1,"!",*43,"!",TOTLYRMT,*56,TOTLYRDT,*68,"!":
                    *69,TOTCYRMT,*81,TOTCYRDT,*92,"!":
                    *93,VARIAN1A,*113,VARIAN1B,*132,"!"
          CALL      UND132
          PRINT     *57,"***** End of Report *****"
          DISPLAY   *P1:24,*EL              * Clear Processing Lines Display
REPT9999  RETURN
.----------------------------------------------------------
. Print Heading
.----------------------------------------------------------
HEAD0000  CALL      HEAD132                 * Print Page Header
          PRINT     *1,"Product Group Range : ",FGROUP:
                       " to  ",TGROUP:
                    *56,"Usage Period : ",SIPEPER,"/",SIPEYEAR
          PRINT     *1,"Analysis of ",ANALDESC," Comparison to ",COMPDESC
          CALL      UND132:
          BRANCH    COMPTYPE,HEAD1000
          PRINT     *1,"!",*3,"Product Group",*43,"!",*52,"Last Year":
                    *68,"!",*76,"Current Year",*92,"!",*107,"Variance":
                    *132,"!":
                    *N,*1,"!",*3,"Code  Description",*43,"!":
                    *50,"Month",*61,"Y.T.D.",*68,"!",*75,"Month":
                    *86,"Y.T.D.",*92,"!",*99,"Month",*118,"Y.T.D.",*132,"!"
          GOTO      HEAD2000
.
HEAD1000  PRINT     *1,"!",*3,"Product Group",*43,"!",*52,"  Budget ":
                    *68,"!",*76,"  Actuals   ",*92,"!",*107,"Variance":
                    *132,"!":
                    *N,*1,"!",*3,"Code  Description",*43,"!":
                    *50,"Month",*61,"Y.T.D.",*68,"!",*75,"Month":
                    *86,"Y.T.D.",*92,"!",*99,"Month",*118,"Y.T.D.",*132,"!"
HEAD2000
          CALL      UND132
          MOVE      "8",CLNO
          RETURN
.----------------------------------------------------------
. Calculate Totals
.----------------------------------------------------------
CALC0000  MOVE      ZERO,LASTYRMT
          MOVE      ZERO,LASTYRDT
          MOVE      ZERO,CURRYRMT
          MOVE      ZERO,CURRYRDT
.
. Current Month
.--------------
          PACK      KEY11,SISACODE,SIPEYEAR,SIPEPER
          CALL      RDSISB1
          BRANCH    OVRCD,CALC1000
          IF        ANALTYPE=1
             MOVE      SISBUAM,CURRYRMT
             MOVE      SISBUBD,LASTYRMT
          ENDIF
          IF        ANALTYPE=2
             MOVE      SISBPAM,CURRYRMT
             MOVE      SISBPBD,LASTYRMT
          ENDIF
          IF        ANALTYPE=3
             MOVE      SISBRAM,CURRYRMT
             MOVE      SISBRBD,LASTYRMT
          ENDIF
.
. Current Year
.-------------
CALC1000  PACK      KEY11,SISACODE,SIPEYEAR,SP70
          CALL      RSSISB1
CALC1100  CALL      RKSISB1
          BRANCH    OVRCD,CALC1900
          MATCH     SISACODE,SISBSUB
          GOTO      CALC1900 IF NOT EQUAL
          MATCH     SIPEYEAR,SISBDAT
          GOTO      CALC1900 IF NOT EQUAL
          PACK      KEY6,SIPEYEAR,SIPEPER
          MATCH     SISBDAT,KEY6
          GOTO      CALC1900 IF LESS
          IF        ANALTYPE=1
             ADD       SISBUAM,CURRYRDT
             ADD       SISBUBD,LASTYRDT
          ENDIF
          IF        ANALTYPE=2
             ADD       SISBPAM,CURRYRDT
             ADD       SISBPBD,LASTYRDT
          ENDIF
          IF        ANALTYPE=3
             ADD       SISBRAM,CURRYRDT
             ADD       SISBRBD,LASTYRDT
          ENDIF
          GOTO      CALC1100
.
. Last Year
.--------------
CALC1900  BRANCH    COMPTYPE,CALC2900
          MOVE      ZERO,LASTYRMT
          MOVE      ZERO,LASTYRDT
          PACK      KEY11,SISACODE,LASTYEAR,SIPEPER
          CALL      RDSISB1
          BRANCH    OVRCD,CALC2000
          IF        ANALTYPE=1
             MOVE      SISBUAM,LASTYRMT
          ENDIF
          IF        ANALTYPE=2
             MOVE      SISBPAM,LASTYRMT
          ENDIF
          IF        ANALTYPE=3
             MOVE      SISBRAM,LASTYRMT
          ENDIF
.
CALC2000  PACK      KEY11,SISACODE,LASTYEAR,SP70
          CALL      RSSISB1
CALC2100  CALL      RKSISB1
          BRANCH    OVRCD,CALC2900
          MATCH     SISACODE,SISBSUB
          GOTO      CALC2900 IF NOT EQUAL
          MATCH     LASTYEAR,SISBDAT
          GOTO      CALC2900 IF NOT EQUAL
          PACK      KEY6,LASTYEAR,SIPEPER
          MATCH     SISBDAT,KEY6
          GOTO      CALC2900 IF LESS
          IF        ANALTYPE=1
             ADD       SISBUAM,LASTYRDT
          ENDIF
          IF        ANALTYPE=2
             ADD       SISBPAM,LASTYRDT
          ENDIF
          IF        ANALTYPE=3
             ADD       SISBRAM,LASTYRDT
          ENDIF
          GOTO      CALC2100
.
CALC2900  RETURN
EANAL000  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
EANAL010  DISPLAY   *P1:24,*EL,"Analysis Type : ":
                    *V2LON,"1. ",*HOFF,"Issue Usage, ":
                    *V2LON,"2. ",*HOFF,"Ordered, ":
                    *V2LON,"3. ",*HOFF,"Received"
          MOVE      ONE,ANALTYPE
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,ANALTYPE
          BRANCH    ANALTYPE,EANAL100,EANAL200,EANAL300
          BEEP
          GOTO      EANAL010
.
EANAL100  MOVE      "Issue Usage",ANALDESC
          GOTO      EANAL999
EANAL200  MOVE      "Ordered Usage",ANALDESC
          GOTO      EANAL999
EANAL300  MOVE      "Receival Usage",ANALDESC
.
EANAL999  CALL      MESSAGE3
          RETURN
ECOMP000  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
ECOMP010  DISPLAY   *P1:24,*EL,"Comparison Type :  ":
                    *V2LON,"1. ",*HOFF,"to Budget, ":
                    *V2LON,"2. ",*HOFF,"to Last Year"
          MOVE      ONE,COMPTYPE
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,COMPTYPE
          BRANCH    COMPTYPE,ECOMP100,ECOMP200
          BEEP
          GOTO      ECOMP010
.
ECOMP100  MOVE      "Budget",COMPDESC
          GOTO      ECOMP999
ECOMP200  MOVE      "Last Year",COMPDESC
          GOTO      ECOMP999
ECOMP999  CALL      MESSAGE3
          RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       SINPERCD    
          INC       SINPERIO/INC
          INC       SINSUAIO/INC
          INC       SINSUAKY    
          INC       SINSUBIO/INC
.
          INC       STDGENCD
.
