.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.01.00"
.-------------------------------------------------------
. V9.04.01  08.04.2005 Peter Vela CAR 59696
.           Changed commodity group from DIM 5 to DIM 6
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.00.01  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN15
.   Function      :   Product Group Enquiries                 
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSMASFD/INC
          INC       GPHSTDDF    
          INC       SINCGAFD/INC
          INC       SINCIAFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINNATFD/INC
          INC       SINPERFD/INC
          INC       SINSUAFD/INC
          INC       SINSUBFD/INC
.=========================
.Local Variable Definition
.-------------------------
UDC1DESC  DIM      30 * Scr 00 Fld    14
UDC2DESC  DIM      30 * Scr 00 Fld    15
.
.    Multi Item Key Fields Scr 01 Fld     1
.-------------------------------------------------------
SIIA2NAM  INIT      "SIIA2"
SIIA2END  FORM      1   * End Display
SIIA2SNO  FORM      5   * Number of Items on the Screen
SIIA2MKY  DIM       127 * Match Key 
SIIA2EKY  DIM       127 * End Key
SIIA2SKY  DIM       127 * Start Key
SIIA2IDX  INIT      " 132 UC1-5"
SIIA2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIIA2FNM  DIM       8  * Filename
SIIA2CNT  FORM      3  * Number of Items on Screen
SUSPDESC  DIM      25 * Scr 01 Fld    24
FINYEAR   DIM       4 * Scr 02 Fld     1
ACTPER01  FORM     12.2 * Scr 02 Fld    14
ACTPER02  FORM     12.2 * Scr 02 Fld    15
ACTPER03  FORM     12.2 * Scr 02 Fld    16
ACTPER04  FORM     12.2 * Scr 02 Fld    17
ACTPER05  FORM     12.2 * Scr 02 Fld    18
ACTPER06  FORM     12.2 * Scr 02 Fld    19
ACTPER07  FORM     12.2 * Scr 02 Fld    20
ACTPER08  FORM     12.2 * Scr 02 Fld    21
ACTPER09  FORM     12.2 * Scr 02 Fld    22
ACTPER10  FORM     12.2 * Scr 02 Fld    23
ACTPER11  FORM     12.2 * Scr 02 Fld    24
ACTPER12  FORM     12.2 * Scr 02 Fld    25
ACTPERXX  FORM     12.2 * Scr 02 Fld    26
BUDPER01  FORM     12.2 * Scr 02 Fld    27
BUDPER02  FORM     12.2 * Scr 02 Fld    28
BUDPER03  FORM     12.2 * Scr 02 Fld    29
BUDPER04  FORM     12.2 * Scr 02 Fld    30
BUDPER05  FORM     12.2 * Scr 02 Fld    31
BUDPER06  FORM     12.2 * Scr 02 Fld    32
BUDPER07  FORM     12.2 * Scr 02 Fld    33
BUDPER08  FORM     12.2 * Scr 02 Fld    34
BUDPER09  FORM     12.2 * Scr 02 Fld    35
BUDPER10  FORM     12.2 * Scr 02 Fld    36
BUDPER11  FORM     12.2 * Scr 02 Fld    37
BUDPER12  FORM     12.2 * Scr 02 Fld    38
BUDPERXX  FORM     12.2 * Scr 02 Fld    39
VARPER01  FORM     12.2 * Scr 02 Fld    40
VARPER02  FORM     12.2 * Scr 02 Fld    41
VARPER03  FORM     12.2 * Scr 02 Fld    42
VARPER04  FORM     12.2 * Scr 02 Fld    43
VARPER05  FORM     12.2 * Scr 02 Fld    44
VARPER06  FORM     12.2 * Scr 02 Fld    45
VARPER07  FORM     12.2 * Scr 02 Fld    46
VARPER08  FORM     12.2 * Scr 02 Fld    47
VARPER09  FORM     12.2 * Scr 02 Fld    48
VARPER10  FORM     12.2 * Scr 02 Fld    49
VARPER11  FORM     12.2 * Scr 02 Fld    50
VARPER12  FORM     12.2 * Scr 02 Fld    51
VARPERXX  FORM     12.2 * Scr 02 Fld    52
PVAPER01  FORM     12.2 * Scr 02 Fld    53
PVAPER02  FORM     12.2 * Scr 02 Fld    54
PVAPER03  FORM     12.2 * Scr 02 Fld    55
PVAPER04  FORM     12.2 * Scr 02 Fld    56
PVAPER05  FORM     12.2 * Scr 02 Fld    57
PVAPER06  FORM     12.2 * Scr 02 Fld    58
PVAPER07  FORM     12.2 * Scr 02 Fld    59
PVAPER08  FORM     12.2 * Scr 02 Fld    60
PVAPER09  FORM     12.2 * Scr 02 Fld    61
PVAPER10  FORM     12.2 * Scr 02 Fld    62
PVAPER11  FORM     12.2 * Scr 02 Fld    63
PVAPER12  FORM     12.2 * Scr 02 Fld    64
PVAPERXX  FORM     12.2 * Scr 02 Fld    65
ACTPER13  FORM     12.2 * Scr 02 Fld    72
BUDPER13  FORM     12.2 * Scr 02 Fld    73
VARPER13  FORM     12.2 * Scr 02 Fld    74
PVAPER13  FORM     12.2 * Scr 02 Fld    75
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN15"
PRGNAM    INIT      "Product Group Enquiries                 "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      ONAT0000
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening sincgaaf";
          OPEN      SINCGAA1,"sincgaaf"
          DISPLAY   *P56:24,"Opening sincgaaf";
          OPEN      SINCGAA2,"sincgaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA2,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA3,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA2,"sincodaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA1,"sinperaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA2,"sinperaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA2,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA3,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsubaf";
          OPEN      SINSUBA1,"sinsubaf"
.--------------------------------------------------------
. Initialise Batch Screen Catalog                            
.--------------------------------------------------------
          MOVE     ZERO,SIIA2SNO
          MOVE     "01    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIIA2SNO
            ENDIF
          ENDIF
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Selection Control Screen           
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Product Group Related Catalog Codes
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Usage Analysis                     
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Purchase Analysis                  
          ENDIF
          RETURN
.--------------------------------
. Screen - Selection Control Screen           
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Selection Control Screen           
.-------------------------------------------------------
CF00L000  COMPARE   ZERO,ACCEPT
              GOTO      CF00L999 IF EQUAL
          MOVE      SP70,SISACODE
          MOVE      SP70,SISADESC
          MOVE      SP70,SISACOMM
          MOVE      SP70,SISAGLI 
          MOVE      SP70,SISAUR1 
          MOVE      SP70,SISAUR2 
          MOVE      SP70,SISAUD1 
          MOVE      SP70,SISAUD2 
          MOVE      SP70,SISAUC1 
          MOVE      SP70,SISAUC2 
          MOVE      SP70,SISAUY1 
          MOVE      SP70,SISAUY2 
          MOVE      SP70,SIGADES 
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Selection Control Screen           
.--------------------------------------------------------
KY00L000
.
KY00L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EPROD000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      SISACODE,VAR     
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Selection Control Screen           
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Selection Control Screen           
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Selection Control Screen           
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Selection Control Screen           
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L104,PS00L105,PS00L106,PS00L107:
                            PS00L108,PS00L109,PS00L110,PS00L111:
                            PS00L112,PS00L113,PS00L114,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      SISACOMM,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      SISAGLI,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      SISAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      SISAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          UNPACK    SISAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          UNPACK    SISAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      SISAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      SISAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SISAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      SIGADES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Selection Control Screen           
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L101,SF00L102,SF00L103,SF00L104:
                            SF00L105
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L102
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC01L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC02L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC03L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Product Group Related Catalog Codes
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   32",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Product Group Related Catalog Codes
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Product Group Related Catalog Codes
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Product Group Related Catalog Codes
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Product Group Related Catalog Codes
.---------------------------------------------------------
LM01L000
.---------------------------------------------------------
. Load for :     1 Catalog                            
.---------------------------------------------------------
          UNPACK    SP70,SIIASUB,SIIACAT
          PACK      KEY12,SISACODE,SP70
          MOVE      KEY12,SIIA2EKY
          STRIP     SIIA2SKY
          SETLPTR   SIIA2EKY,5
          MOVE      SIIA2EKY,SIIA2SKY
          CALL      RDSIIA2 
          IF        OVRCD=0
            CALL      RPSIIA2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP01L000
          MOVE     ZERO,SIIA2CNT
          MOVE     ZERO,SIIA2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP01L600
          MATCH    PRGID,SCPSPID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP01L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP01L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP01L101,DP01L102,DP01L103,DP01L104:
                            DP01L105,DP01L106,DP01L107,DP01L108:
                            DP01L109,DP01L110,DP01L111,DP01L112:
                            DP01L113,DP01L114,DP01L115,DP01L116:
                            DP01L117,DP01L118,DP01L119,DP01L120:
                            DP01L121,DP01L122,DP01L123,DP01L124:
                            DP01L125,DP01L126,DP01L127,DP01L010:
                            DP01L010,DP01L010,DP01L010,DP01L010:
                            DP01L010
          GOTO      DP01L010
.
DP01L101
          IF        SIIA2END=0
            CALL      RKSIIA2 
            IF        OVRCD=0
              PACK      SIIA2MKY,SIIASUB,SIIACAT                                                                
              MATCH     SIIA2EKY,SIIA2MKY
              IF        @EQUAL
                MOVE      ZERO,SIIA2END
                ADD       ONE,SIIA2CNT
                MOVE      SIIACAT,VAR      
                CALL      DISPITEM
          CALL      LINDET00
              ELSE
                MOVE      ONE,SIIA2END
              ENDIF
            ELSE
              MOVE      ONE,SIIA2END
            ENDIF
          ENDIF
          IF        SIIA2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L102
          IF        SIIA2END=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L103
          IF        SIIA2END=0
            MOVE      SIIAISS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L104
          IF        SIIA2END=0
            MOVE      SIIASTI,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L105
          IF        SIIA2END=0
            MOVE      SIIAAVC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L106
          IF        SIIA2END=0
            MOVE      SIIANAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L107
          IF        SIIA2END=0
            MOVE      SIIAABC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L108
          IF        SIIA2END=0
            MOVE      SIIAPSC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L109
          IF        SIIA2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIIAREX,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L110
          IF        SIIA2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIIANON,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L111
          IF        SIIA2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIIASAB,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L112
          IF        SIIA2END=0
            MOVE      SIIASUS,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L113
          IF        SIIA2END=0
            UNPACK    SIIADTC,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L114
          IF        SIIA2END=0
            MOVE      SIIATMC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L115
          IF        SIIA2END=0
            MOVE      SIIAUSC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L116
          IF        SIIA2END=0
            MOVE      SIIAUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L117
          IF        SIIA2END=0
            MOVE      SIIAUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L118
          IF        SIIA2END=0
            UNPACK    SIIAUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L119
          IF        SIIA2END=0
            UNPACK    SIIAUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L120
          IF        SIIA2END=0
            MOVE      SIIAUC1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L121
          IF        SIIA2END=0
            MOVE      SIIAUC2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L122
          IF        SIIA2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIIAUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L123
          IF        SIIA2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIIAUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L124
          IF        SIIA2END=0
            MOVE      SUSPDESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L125
          IF        SIIA2END=0
            MOVE      UDC1DESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L126
          IF        SIIA2END=0
            MOVE      UDC2DESC,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
.
DP01L127
          IF        SIIA2END=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP01L010
DP01L600
          MATCH    "SIIA2",NAMSSFFI
          GOTO     DP01L605 IF NOT EQUAL
          GOTO     DP01L999
DP01L605
DP01L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP01L000
.
          MATCH    "SIIA2",NAMSSFFI
          GOTO     FP01L105 IF NOT EQUAL
          PACK     KEY12,SIIA2SKY,SP70
          CALL     RDSIIA2  * Start
          IF       OVRCD=0
            CALL     RPSIIA2  * Start
          ENDIF
          CALL     DP01L000
          GOTO     FP01L999
FP01L105
FP01L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP01L000
.
          MATCH    "SIIA2",NAMSSFFI
          GOTO     LP01L105 IF NOT EQUAL
          PACK     KEY12,SIIA2SKY,Z70
          CALL     RSSIIA2  * End
          IF       OVRCD=1
            CALL     RPSIIA2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIA2SNO
            CALL     RPSIIA2 
            IF       OVRCD=1
              MOVE     SIIA2SNO,SECTOR
            ENDIF
            PACK     SIIA2MKY,SIIASUB,SIIACAT                                                                
            MATCH    SIIA2EKY,SIIA2MKY
            IF       !@EQUAL
              MOVE     SIIA2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     LP01L999
LP01L105
LP01L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP01L000
.
          MATCH    "SIIA2",NAMSSFFI
          GOTO     PP01L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP01L105
          COMPARE  SECTOR,SIIA2SNO
          GOTO     PP01L110 IF EQUAL
          CALL     RPSIIA2 
          BRANCH   OVRCD,PP01L115
          PACK     SIIA2MKY,SIIASUB,SIIACAT                                                                
          MATCH    SIIA2EKY,SIIA2MKY
          GOTO     PP01L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP01L105
PP01L110
          MOVE     ZERO,SECTOR
          IF       SIIA2CNT=SIIA2SNO
            SUB      ONE,SIIA2CNT
          ENDIF
          WHILE    SECTOR<=SIIA2CNT
            CALL     RPSIIA2 
            IF       OVRCD=1
              MOVE     SIIA2SNO,SECTOR
            ENDIF
            PACK     SIIA2MKY,SIIASUB,SIIACAT                                                                
            MATCH    SIIA2EKY,SIIA2MKY
            IF       !@EQUAL
              MOVE     SIIA2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP01L000
          GOTO     PP01L999
PP01L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIA2SNO
            CALL     RKSIIA2 
            IF       OVRCD=1
              MOVE     SIIA2SNO,SECTOR
            ENDIF
            PACK     SIIA2MKY,SIIASUB,SIIACAT                                                                
            MATCH    SIIA2EKY,SIIA2MKY
            IF       !@EQUAL
              MOVE     SIIA2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP01L999
PP01L120
PP01L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP01L000
          MATCH    "SIIA2",NAMSSFFI
          GOTO     NP01L115 IF NOT EQUAL
NP01L105
          CALL     RKSIIA2 
          BRANCH   OVRCD,NP01L110
          PACK     SIIA2MKY,SIIASUB,SIIACAT                                                                
          MATCH    SIIA2EKY,SIIA2MKY
          GOTO     NP01L110 IF NOT EQUAL
          CALL     RPSIIA2 
          CALL     DP01L000
          GOTO     NP01L999
NP01L110
          CALL     RPSIIA2 
          BEEP
          GOTO     NP01L999
NP01L115
NP01L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT01L000
CT01L105
CT01L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Product Group Related Catalog Codes
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Product Group Related Catalog Codes
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
          MOVE      "SIIA2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP01L000
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Product Group Related Catalog Codes
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999,PS01L999,PS01L999,PS01L999:
                            PS01L999
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Product Group Related Catalog Codes
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L101:
                            SF01L102,SF01L103,SF01L104,SF01L006:
                            SF01L105
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          MOVE      "SIIA2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L101
          MOVE      "SIIA2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP01L000
          GOTO     SF01L001
.
SF01L102
          MOVE      "SIIA2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP01L000
          GOTO     SF01L001
.
SF01L103
          MOVE      "SIIA2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP01L000
          GOTO     SF01L001
.
SF01L104
          MOVE      "SIIA2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP01L000
          GOTO     SF01L001
.
SF01L105
          MOVE      ZERO,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Usage Analysis                     
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Usage Analysis                     
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Usage Analysis                     
.--------------------------------------------------------
KY02L000
.
KY02L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EYEAR000
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      FINYEAR,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Usage Analysis                     
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Usage Analysis                     
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Usage Analysis                     
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Usage Analysis                     
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L101,PS02L102,PS02L103:
                            PS02L104,PS02L105,PS02L106,PS02L107:
                            PS02L108,PS02L109,PS02L110,PS02L111:
                            PS02L112,PS02L113,PS02L114,PS02L115:
                            PS02L116,PS02L117,PS02L118,PS02L119:
                            PS02L120,PS02L121,PS02L122,PS02L123:
                            PS02L124,PS02L125,PS02L126,PS02L127:
                            PS02L128,PS02L129,PS02L130,PS02L131:
                            PS02L132,PS02L133,PS02L134,PS02L135:
                            PS02L136,PS02L137,PS02L138,PS02L139:
                            PS02L140,PS02L141,PS02L142,PS02L143:
                            PS02L144,PS02L145,PS02L146,PS02L147:
                            PS02L148,PS02L149,PS02L150,PS02L151:
                            PS02L152,PS02L153,PS02L154,PS02L155:
                            PS02L156,PS02L157,PS02L158,PS02L159:
                            PS02L160,PS02L161,PS02L162,PS02L163:
                            PS02L164,PS02L999,PS02L999,PS02L999:
                            PS02L999,PS02L999,PS02L165,PS02L166:
                            PS02L167,PS02L168,PS02L169
          GOTO     PS02L999
.
PS02L101
          MOVE      HAPER1,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      HAPER2,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      HAPER3,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      HAPER4,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      HAPER5,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      HAPER6,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      HAPER7,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      HAPER8,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      HAPER9,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      HAPER10,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      HAPER11,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      HAPER12,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      ACTPER01,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          MOVE      ACTPER02,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          MOVE      ACTPER03,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L116
          MOVE      ACTPER04,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L117
          MOVE      ACTPER05,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L118
          MOVE      ACTPER06,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L119
          MOVE      ACTPER07,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L120
          MOVE      ACTPER08,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L121
          MOVE      ACTPER09,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L122
          MOVE      ACTPER10,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L123
          MOVE      ACTPER11,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L124
          MOVE      ACTPER12,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L125
          MOVE      ACTPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L126
          MOVE      BUDPER01,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L127
          MOVE      BUDPER02,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L128
          MOVE      BUDPER03,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L129
          MOVE      BUDPER04,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L130
          MOVE      BUDPER05,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L131
          MOVE      BUDPER06,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L132
          MOVE      BUDPER07,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L133
          MOVE      BUDPER08,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L134
          MOVE      BUDPER09,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L135
          MOVE      BUDPER10,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L136
          MOVE      BUDPER11,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L137
          MOVE      BUDPER12,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L138
          MOVE      BUDPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L139
          MOVE      VARPER01,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L140
          MOVE      VARPER02,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L141
          MOVE      VARPER03,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L142
          MOVE      VARPER04,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L143
          MOVE      VARPER05,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L144
          MOVE      VARPER06,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L145
          MOVE      VARPER07,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L146
          MOVE      VARPER08,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L147
          MOVE      VARPER09,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L148
          MOVE      VARPER10,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L149
          MOVE      VARPER11,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L150
          MOVE      VARPER12,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L151
          MOVE      VARPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L152
          MOVE      PVAPER01,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L153
          MOVE      PVAPER02,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L154
          MOVE      PVAPER03,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L155
          MOVE      PVAPER04,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L156
          MOVE      PVAPER05,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L157
          MOVE      PVAPER06,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L158
          MOVE      PVAPER07,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L159
          MOVE      PVAPER08,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L160
          MOVE      PVAPER09,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L161
          MOVE      PVAPER10,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L162
          MOVE      PVAPER11,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L163
          MOVE      PVAPER12,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L164
          MOVE      PVAPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L165
          MOVE      HAPER13,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L166
          MOVE      ACTPER13,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L167
          MOVE      BUDPER13,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L168
          MOVE      VARPER13,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L169
          MOVE      PVAPER13,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Usage Analysis                     
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L101:
                            SF02L102,SF02L103,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPHU0000
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF02L001
.
SF02L103
          MOVE      ZERO,EXIT
          GOTO      SF02L999
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Purchase Analysis                  
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Analysis                  
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Analysis                  
.--------------------------------------------------------
KY03L000
.
KY03L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EPYR0000
          BRANCH    EXIT,KY03L900,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      FINYEAR,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Analysis                  
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Analysis                  
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Analysis                  
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Analysis                  
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L101,PS03L102,PS03L103:
                            PS03L104,PS03L105,PS03L106,PS03L107:
                            PS03L108,PS03L109,PS03L110,PS03L111:
                            PS03L112,PS03L113,PS03L114,PS03L115:
                            PS03L116,PS03L117,PS03L118,PS03L119:
                            PS03L120,PS03L121,PS03L122,PS03L123:
                            PS03L124,PS03L125,PS03L126,PS03L127:
                            PS03L128,PS03L129,PS03L130,PS03L131:
                            PS03L132,PS03L133,PS03L134,PS03L135:
                            PS03L136,PS03L137,PS03L138,PS03L139:
                            PS03L140,PS03L141,PS03L142,PS03L143:
                            PS03L144,PS03L145,PS03L146,PS03L147:
                            PS03L148,PS03L149,PS03L150,PS03L151:
                            PS03L152,PS03L153,PS03L154,PS03L155:
                            PS03L156,PS03L157,PS03L158,PS03L159:
                            PS03L160,PS03L161,PS03L162,PS03L163:
                            PS03L164,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L165,PS03L166:
                            PS03L167,PS03L168,PS03L169
          GOTO     PS03L999
.
PS03L101
          MOVE      HAPER1,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      HAPER2,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      HAPER3,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      HAPER4,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      HAPER5,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      HAPER6,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      HAPER7,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      HAPER8,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      HAPER9,VAR       
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      HAPER10,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L111
          MOVE      HAPER11,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L112
          MOVE      HAPER12,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L113
          MOVE      ACTPER01,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L114
          MOVE      ACTPER02,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L115
          MOVE      ACTPER03,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L116
          MOVE      ACTPER04,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L117
          MOVE      ACTPER05,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L118
          MOVE      ACTPER06,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L119
          MOVE      ACTPER07,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L120
          MOVE      ACTPER08,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L121
          MOVE      ACTPER09,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L122
          MOVE      ACTPER10,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L123
          MOVE      ACTPER11,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L124
          MOVE      ACTPER12,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L125
          MOVE      ACTPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L126
          MOVE      BUDPER01,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L127
          MOVE      BUDPER02,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L128
          MOVE      BUDPER03,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L129
          MOVE      BUDPER04,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L130
          MOVE      BUDPER05,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L131
          MOVE      BUDPER06,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L132
          MOVE      BUDPER07,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L133
          MOVE      BUDPER08,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L134
          MOVE      BUDPER09,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L135
          MOVE      BUDPER10,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L136
          MOVE      BUDPER11,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L137
          MOVE      BUDPER12,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L138
          MOVE      BUDPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L139
          MOVE      VARPER01,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L140
          MOVE      VARPER02,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L141
          MOVE      VARPER03,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L142
          MOVE      VARPER04,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L143
          MOVE      VARPER05,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L144
          MOVE      VARPER06,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L145
          MOVE      VARPER07,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L146
          MOVE      VARPER08,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L147
          MOVE      VARPER09,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L148
          MOVE      VARPER10,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L149
          MOVE      VARPER11,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L150
          MOVE      VARPER12,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L151
          MOVE      VARPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L152
          MOVE      PVAPER01,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L153
          MOVE      PVAPER02,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L154
          MOVE      PVAPER03,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L155
          MOVE      PVAPER04,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L156
          MOVE      PVAPER05,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L157
          MOVE      PVAPER06,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L158
          MOVE      PVAPER07,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L159
          MOVE      PVAPER08,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L160
          MOVE      PVAPER09,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L161
          MOVE      PVAPER10,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L162
          MOVE      PVAPER11,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L163
          MOVE      PVAPER12,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L164
          MOVE      PVAPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L165
          MOVE      HAPER13,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L166
          MOVE      ACTPER13,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L167
          MOVE      BUDPER13,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L168
          MOVE      VARPER13,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L169
          MOVE      PVAPER13,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Analysis                  
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L101:
                            SF03L102,SF03L103,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ONE,EXIT
          GOTO      SF03L999
.
SF03L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPHP0000
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   66",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF03L001
.
SF03L103
          MOVE      ZERO,EXIT
          GOTO      SF03L999
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*143,HNONUSAG
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ONE,HNONUSAG
            WRITAB    CONTROLF,SIXTY3;*143,HNONUSAG
          ENDIF
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
EPROD000  CALL     KSISAA00
          BRANCH   EXIT,EPROD999,EPROD999
.
          MOVE      SISACOMM,KEY6     * Get Commodity Code Description *C-59696
          CALL      RDSIGA1
.
          CLEAR     KEY6
          APPEND    "sa1",KEY6
          APPEND    SISAUC1,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC1DESC
          ELSE
            MOVE      SP70,UDC1DESC
          ENDIF
.
          CLEAR     KEY6
          APPEND    "sa2",KEY6
          APPEND    SISAUC2,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC2DESC
          ELSE
            MOVE      SP70,UDC2DESC
          ENDIF
.
          MOVE      ZERO,EXIT
          MOVE      ZERO,OVRCD
.
EPROD999  RETURN
LINDET00  MOVE      SIIAPSC,KEY5
          CALL      RDAPMA1
.
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
.
          MATCH     SP70,SIIAUC1
          GOTO      LINDET02 IF EQUAL
          CLEAR     KEY6
          APPEND    "ia1",KEY6
          APPEND    SIIAUC1,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC1DESC
          ENDIF
.
LINDET02  MATCH     SP70,SIIAUC1
          GOTO      LINDET04 IF EQUAL
          CLEAR     KEY6
          APPEND    "ia2",KEY6
          APPEND    SIIAUC2,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC2DESC
          ENDIF
LINDET04  ADD       ONE,SIIASUS
          BRANCH    SIIASUS,LINDET10,LINDET20,LINDET30,LINDET40
LINDET10  MOVE      "Not Suspend               ",SUSPDESC
          GOTO      LINDET90
LINDET20  MOVE      "Requisitions              ",SUSPDESC
          GOTO      LINDET90
LINDET30  MOVE      "Suspend P/O              ",SUSPDESC
          GOTO      LINDET90
LINDET40  MOVE      "Suspend P/O & Requisition",SUSPDESC
          GOTO      LINDET90
LINDET90  SUB       ONE,SIIASUS
          RETURN
EYEAR000  CALL      RINPECON
          MOVE      SIPECYR,FINYEAR
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,*JR,FINYEAR
          PACK      FINYEAR,FINYEAR,SP70
.
          MATCH     SP70,FINYEAR
          GOTO      EYEAR990 IF EQUAL
          PACK      KEY4,SP3,EXITCHAR * exitchar entered ?
          MATCH     KEY4,FINYEAR
          GOTO      EYEAR990 IF EQUAL
.
          TYPE      FINYEAR           * valid numeric ?
          GOTO      EYEAR000 IF NOT EQUAL
.
          MOVE      FINYEAR,SIPEYF4
          IF        SIPEYF4<100
            SQUEEZE   FINYEAR
            MOVE      FINYEAR,FORM2
            PACK      FINYEAR,CCC,FORM2,SP70
          ENDIF
.
          REP       " 0",FINYEAR
          MOVE      ZERO,BUDPERXX
          MOVE      ZERO,ACTPERXX
.
          MOVE      ZERO,F2
EYEAR100  ADD       ONE,F2
          IF        F2>SIPENUM
            GOTO      EYEAR900
          ENDIF
          PACK      SISBDAT,FINYEAR,F2
          REP       " 0",SISBDAT
          PACK      KEY11,SISACODE,SISBDAT
          CALL      RDSISB1
          IF        OVRCD=1
            MOVE      ZERO,SISBUBD
            MOVE      ZERO,SISBUAM
          ENDIF
.
          STORE     SISBUBD,F2,BUDPER01,BUDPER02,BUDPER03,BUDPER04:
                               BUDPER05,BUDPER06,BUDPER07,BUDPER08:
                               BUDPER09,BUDPER10,BUDPER11,BUDPER12,BUDPER13
          STORE     SISBUAM,F2,ACTPER01,ACTPER02,ACTPER03,ACTPER04:
                               ACTPER05,ACTPER06,ACTPER07,ACTPER08:
                               ACTPER09,ACTPER10,ACTPER11,ACTPER12,ACTPER13
          ASSIGN    SISBUAM-SISBUBD,VARPERXX
.
          IF        SISBUAM=0 & SISBUBD=0
            MOVE      ZERO,PVAPERXX
          ELSE
            IF        SISBUAM=0 & SISBUBD<>0
              ASSIGN    HUNDRED*SEQ,PVAPERXX
            ELSE
              IF        SISBUAM<>0 & SISBUBD=0
                MOVE      HUNDRED,PVAPERXX
              ELSE
                ASSIGN    (VARPERXX/SISBUBD)*100.0,PVAPERXX
              ENDIF
            ENDIF
          ENDIF
.
          STORE     VARPERXX,F2,VARPER01,VARPER02,VARPER03,VARPER04:
                               VARPER05,VARPER06,VARPER07,VARPER08:
                               VARPER09,VARPER10,VARPER11,VARPER12,VARPER13
          STORE     PVAPERXX,F2,PVAPER01,PVAPER02,PVAPER03,PVAPER04:
                               PVAPER05,PVAPER06,PVAPER07,PVAPER08:
                               PVAPER09,PVAPER10,PVAPER11,PVAPER12,PVAPER13
          ADD       SISBUBD,BUDPERXX
          ADD       SISBUAM,ACTPERXX
          GOTO      EYEAR100
.
EYEAR900  ASSIGN    ACTPERXX-BUDPERXX,VARPERXX
          IF        ACTPERXX=0 & BUDPERXX=0
            MOVE      ZERO,PVAPERXX
          ELSE
            IF        ACTPERXX=0 & BUDPERXX<>0
              ASSIGN    HUNDRED*SEQ,PVAPERXX
            ELSE
              IF        ACTPERXX<>0 & BUDPERXX=0
                MOVE      HUNDRED,PVAPERXX
              ELSE
                ASSIGN    (VARPERXX/BUDPERXX)*100.0,PVAPERXX
              ENDIF
            ENDIF
          ENDIF
          GOTO      EYEAR999
.
EYEAR990  MOVE      TWO,EXIT
.
EYEAR999  RETURN
GPHU0000
.----------------------------------------------------------------------
. Create Temp File By Calling Following OPNGRAPH
.----------------------------------------------------------------------
          CALL      OPNGRAPH
.----------------------------------------------------------------------
. Insert Data to be Graphed into Temp File
.----------------------------------------------------------------------
          MOVE      ZERO,F3
.
GPHU1000  ADD       ONE,F3
          LOAD      SCGPDES,F3,HAPER1,HAPER2,HAPER3,HAPER4,HAPER5,HAPER6:
                               HAPER7,HAPER8,HAPER9,HAPER10,HAPER11,HAPER12:
                               HAPER13
          MOVE      F3,SCGPPER
          MOVE      "  1",SCGPITM * Actual
          LOAD      SCGPVAL,F3,ACTPER01,ACTPER02,ACTPER03,ACTPER04:
                               ACTPER05,ACTPER06,ACTPER07,ACTPER08:
                               ACTPER09,ACTPER10,ACTPER11,ACTPER12,ACTPER13
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
.
          MOVE      "  2",SCGPITM * Budget
          LOAD      SCGPVAL,F3,BUDPER01,BUDPER02,BUDPER03,BUDPER04:
                               BUDPER05,BUDPER06,BUDPER07,BUDPER08:
                               BUDPER09,BUDPER10,BUDPER11,BUDPER12,BUDPER13
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
          COMPARE   SIPENUM,F3
          GOTO      GPHU1000 IF NOT EQUAL
.----------------------------------------------------------------------
. Setup Name of Graph and Legend
.----------------------------------------------------------------------
          STRIP     SISADESC
          CLEAR     GPHNAME
          APPEND    SISADESC,GPHNAME
          APPEND    " Usage for the Year ",GPHNAME
          APPEND    FINYEAR,GPHNAME
          RESET     GPHNAME
          MOVE      "Actual    ",GPHLEDG[1]
          MOVE      "Budget     ",GPHLEDG[2]
.
          MOVE      TEN,GPHNOCOY    * Width of Y Axis Description Display
          MOVE      TWO,GPHNTYP     * Number of Columns per Period
          IF        SIPENUM=12
            MOVE      SIX,GPHNOCOX  * Width of X Axis Description Display
          ELSE
            MOVE      FIVE,GPHNOCOX * Width of X Axis Description Display
          ENDIF
          MOVE      ZERO,GPHTYPE    * Initial Display Type 0=X 1=Y
          CALL      DISGRAPH        * Routine to Display Graph
.----------------------------------------------------------------------
. When Complete Call CLSGRAPH to Close and Delete Temp
.----------------------------------------------------------------------
          CALL      CLSGRAPH
.
          RETURN
.
EPYR0000  CALL      RINPECON
          MOVE      SIPECYR,FINYEAR
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,*JR,FINYEAR
          PACK      FINYEAR,FINYEAR,SP70
.
          MATCH     SP70,FINYEAR
          GOTO      EPYR0990 IF EQUAL
          PACK      KEY4,SP3,EXITCHAR * exitchar entered ?
          MATCH     KEY4,FINYEAR
          GOTO      EPYR0990 IF EQUAL
.
          TYPE      FINYEAR           * valid numeric ?
          GOTO      EPYR0000 IF NOT EQUAL
.
          MOVE      FINYEAR,SIPEYF4
          IF        SIPEYF4<100
            SQUEEZE   FINYEAR
            MOVE      FINYEAR,FORM2
            PACK      FINYEAR,CCC,FORM2,SP70
          ENDIF
.
          REP       " 0",FINYEAR
          MOVE      ZERO,BUDPERXX
          MOVE      ZERO,ACTPERXX
.
          MOVE      ZERO,F2
EPYR0100  ADD       ONE,F2
          IF        F2>SIPENUM
            GOTO      EPYR0900
          ENDIF
          PACK      SISBDAT,FINYEAR,F2
          REP       " 0",SISBDAT
          PACK      KEY11,SISACODE,SISBDAT
          CALL      RDSISB1
          IF        OVRCD=1
            MOVE      ZERO,SISBPBD
            MOVE      ZERO,SISBPAM
          ENDIF
.
          STORE     SISBPBD,F2,BUDPER01,BUDPER02,BUDPER03,BUDPER04:
                               BUDPER05,BUDPER06,BUDPER07,BUDPER08:
                               BUDPER09,BUDPER10,BUDPER11,BUDPER12,BUDPER13
          STORE     SISBPAM,F2,ACTPER01,ACTPER02,ACTPER03,ACTPER04:
                               ACTPER05,ACTPER06,ACTPER07,ACTPER08:
                               ACTPER09,ACTPER10,ACTPER11,ACTPER12,ACTPER13
          ASSIGN    SISBPAM-SISBPBD,VARPERXX
.
          IF        SISBPAM=0 & SISBPBD=0
            MOVE      ZERO,PVAPERXX
          ELSE
            IF        SISBPAM=0 & SISBPBD<>0
              ASSIGN    HUNDRED*SEQ,PVAPERXX
            ELSE
              IF        SISBPAM<>0 & SISBPBD=0
                MOVE      HUNDRED,PVAPERXX
              ELSE
                ASSIGN    (VARPERXX/SISBPBD)*100.0,PVAPERXX
              ENDIF
            ENDIF
          ENDIF
.
          STORE     VARPERXX,F2,VARPER01,VARPER02,VARPER03,VARPER04:
                               VARPER05,VARPER06,VARPER07,VARPER08:
                               VARPER09,VARPER10,VARPER11,VARPER12,VARPER13
          STORE     PVAPERXX,F2,PVAPER01,PVAPER02,PVAPER03,PVAPER04:
                               PVAPER05,PVAPER06,PVAPER07,PVAPER08:
                               PVAPER09,PVAPER10,PVAPER11,PVAPER12,PVAPER13
          ADD       SISBPBD,BUDPERXX
          ADD       SISBPAM,ACTPERXX
          GOTO      EPYR0100
.
EPYR0900  ASSIGN    ACTPERXX-BUDPERXX,VARPERXX
          IF        ACTPERXX=0 & BUDPERXX=0
            MOVE      ZERO,PVAPERXX
          ELSE
            IF        ACTPERXX=0 & BUDPERXX<>0
              ASSIGN    HUNDRED*SEQ,PVAPERXX
            ELSE
              IF        ACTPERXX<>0 & BUDPERXX=0
                MOVE      HUNDRED,PVAPERXX
              ELSE
                ASSIGN    (VARPERXX/BUDPERXX)*100.0,PVAPERXX
              ENDIF
            ENDIF
          ENDIF
          GOTO      EPYR0999
.
EPYR0990  MOVE      TWO,EXIT
.
EPYR0999  RETURN
GPHP0000
.----------------------------------------------------------------------
. Create Temp File By Calling Following OPNGRAPH
.----------------------------------------------------------------------
          CALL      OPNGRAPH
.----------------------------------------------------------------------
. Insert Data to be Graphed into Temp File
.----------------------------------------------------------------------
          MOVE      ZERO,F3
.
GPHP1000  ADD       ONE,F3
          LOAD      SCGPDES,F3,HAPER1,HAPER2,HAPER3,HAPER4,HAPER5,HAPER6:
                               HAPER7,HAPER8,HAPER9,HAPER10,HAPER11,HAPER12:
                               HAPER13
          MOVE      F3,SCGPPER
          MOVE      "  1",SCGPITM * Actual
          LOAD      SCGPVAL,F3,ACTPER01,ACTPER02,ACTPER03,ACTPER04:
                               ACTPER05,ACTPER06,ACTPER07,ACTPER08:
                               ACTPER09,ACTPER10,ACTPER11,ACTPER12,ACTPER13
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
.
          MOVE      "  2",SCGPITM * Budget
          LOAD      SCGPVAL,F3,BUDPER01,BUDPER02,BUDPER03,BUDPER04:
                               BUDPER05,BUDPER06,BUDPER07,BUDPER08:
                               BUDPER09,BUDPER10,BUDPER11,BUDPER12,BUDPER13
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
          COMPARE   SIPENUM,F3
          GOTO      GPHP1000 IF NOT EQUAL
.----------------------------------------------------------------------
. Setup Name of Graph and Legend
.----------------------------------------------------------------------
          STRIP     SISADESC
          CLEAR     GPHNAME
          APPEND    SISADESC,GPHNAME
          APPEND    " Purchases for the Year ",GPHNAME
          APPEND    FINYEAR,GPHNAME
          RESET     GPHNAME
          MOVE      "Actual    ",GPHLEDG[1]
          MOVE      "Budget     ",GPHLEDG[2]
.
          MOVE      TEN,GPHNOCOY    * Width of Y Axis Description Display
          MOVE      TWO,GPHNTYP    * Number of Columns per Period
          IF        SIPENUM=12
            MOVE      SIX,GPHNOCOX  * Width of X Axis Description Display
          ELSE
            MOVE      FIVE,GPHNOCOX * Width of X Axis Description Display
          ENDIF
          MOVE      ZERO,GPHTYPE    * Initial Display Type 0=X 1=Y
          CALL      DISGRAPH        * Routine to Display Graph
.----------------------------------------------------------------------
. When Complete Call CLSGRAPH to Close and Delete Temp
.----------------------------------------------------------------------
          CALL      CLSGRAPH
.
          RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSMASIO/INC
          INC       GPHSTDCD    
          INC       SINCGAIO/INC
          INC       SINCIAIO/INC
          INC       SINCODIO/INC
          INC       SINNATIO/INC
          INC       SINPERCD    
          INC       SINPERIO/INC
          INC       SINSUAIO/INC
          INC       SINSUAKY    
          INC       SINSUBIO/INC
.
          INC       STDGENCD
.
