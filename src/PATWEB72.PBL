.----------------------------------------------------------------------
. Program       : PATWEB72
.
. Function      : Patient Identification Sheet Print Server
.
. Modifications :
.-----------------------------------------------------------------------
.V12.00.05  13/11/2025  Ebon Clements  TSK 0969539
.           Added open of PMSRELA1 and PMSRELA2
.V12.00.04  30/09/2025  Thanh T        TSK 0937505
.           Recompiled for PATINVHL changes
.V12.00.03  08/09/2025  Thanh T          TSK 0949457
.           Recompiled for PATSHT6 changes
.V12.00.02  03/06/2025  J.Tan          TSK 0955096
.           Added Alphanumeric visit number changes
.V12.00.01  15.05.2025  DA Sarkies     TSK 0955096
.           Updated for Alpha-Numeric Visit Number
.V11.05.02  07/0r42025  PJ Le Febour    TSK 0949428b
.           Recompiled for PATSHT6  
.V11.05.01  20/03/2025  PJ Le Febour    TSK 0949428a
.           Recompiled for PATSHT6  
.V11.05.01  18/02/2025  PJ Le Febour    TSK 0949428
.           Recompiled for PATSHT6  - added PMVXUDF7(upload MyHealth)
.V11.04.03  13/05/2024  Thanh T         TSK 0941543
.           Recompiled for PATSHT6 changes
.           14/05/2024  J.Tan           TSK 0935689
.           Recompiled for PATSHT6 - Variable 1245 for Total Out of Pocket $
.V11.04.02  05.02.2024  DA Sarkies      TSK 0936282
.           Increase size of variable to hold Healthfund Number       
.V11.04.01  23/11/2023  Peter Vela      TSK 0935874
.           Recompiled for PATSHT6 - Added validation for PTCNUNET = 3
.           NIHC IHI functionality
.V11.03.05  08/11/2023  Nikitha B      TSK 0927699c
.           Read CAPPRVNO and PTCNHABN for Hospital Approval ABN number.
.V11.03.04  17/10/2023  Peter Vela       TSK 0935874
.           Added parameter check for pmsihiaf
.V11.03.03  04/10/2023  Nikitha B     TSK 0927699
.           Recomplied for PATINVHL, PATINVTL - Stationary variables
.V11.03.02  11/09/2023  Thanh T       TSK 0914124
.           Added SAVKEY10 to save WBSEUID
.V11.03.01  14/06/2023  Bella Turco   TSK 0933691
.           Fixed misspelling of Stationary
.V11.02.04  02/08/2022  Thanh T       TSK 0914124
.           Recompiled for PATSHT6 changes 
.V11.02.03  14/07/2022  Alina Bhari   TSK 0922164
.           Matched the report description with scheduled process list
.           description for patient invoice list     
.           - SCHDDESC,PRSTUR90,CLRPAR00,SETPAR00    
.V11.02.02  10/02/2022  Thanh T       TSK 0905641
.           Recompiled as OUTMA1FD (PATMASTM) changes
.V11.02.01  24/01/2022  Jacob Jackson  TSK 0864505
.           Recompiled for PATINVHL, PATINVTL - Preferred name changes
.V11.01.03  14/09/2021  Davin          TSK 0911277
.           Recompiled for PRTINVBD
.V11.01.02  10/09/2021  Davin          TSK 0911277
.           Recompiled for PATINVTL - Changed field 20 length to 12.2
.V11.01.01  24/08/2021  Davin          TSK 0897318
.           Recompiled for PATINVTL - added field 57(Adjustment Total)
.-----------------------------------------------------------------------
.V11.00.09  09/12/2020  Thanh T          TSK 0872840
.           Recompiled as PMSPX2TM changes
.V11.00.08  17/11/2020  Thanh T          TSK 0878747
.           Added PATATRFD PATATRIO and PATATRTD for PATSHT6 
.V11.00.07  12/11/2020  Ebon Clement     TSK 0898748
.           Recompiled for PATSHT6 - Emergency contact address
.V11.00.06  23/09/2020  Peter Vela       TSK 0895969
.           Recompiled for WEBSEDFD
.V11.00.05  22/09/2020  Peter Vela       TSK 0895969
.           Recompiled for WEBERCFD
.V11.00.04  08/09/2020  Peter Vela     Task 0895969
.           Added WebServices OECW
.V11.00.03  31/08/2020  Tracey Nguyen  Task 0896149
.           Recompiled for PATHFCF -
.           Commented out PHFC6712 to revert changes to Care Type
.           cat CC to use User Defined Field 3 as per pre 01/07/2020
.V11.00.02  07/04/2020  Ebon Clements    TSK 0887745
.           Recompiled for PATSHT6 - Discharge date dd/mm/ccyy
.           03/04/2020  Thanh T          TSK 0879163
.           Recompiled for PATSHT6
.V11.00.01  06/03/2020  Tracey Nguyen    TSK 0848746 
.           Recompiled for PATHFCF (PRTHFCF)- Added variable fields 
.           400(Insurance Company) and 401 (Insurance Policy Number/
.           Insurance Fund Membership Number)
.-----------------------------------------------------------------------
.V10.13.07  13/12/2018  Thanh T          TSK 0865690
.           Recompiled for PATSHT6
.V10.13.06  13/12/2018  Thanh T          TSK 0865690
.           Recompiled for PATSHT6
.V10.13.05  19/11/2018  Ken Bell         TSK 0862405
.           Recompiled for PATSHT6
.V10.13.04  07/11/2018  Thanh T          TSK 0865690
.           Recompiled for PATSHT6
.V10.13.03  04/09/2018  Ken Bell         TSK 0862168
.           Recompiled for PATSHT6 
.V10.13.02  22/08/2018  Thanh T          TSk 0860668
.           Recompiled for PATSHT6
.V10.13.01  08/08/2018  Thanh T          TSk 0860668
.           Recompiled for PATSHT6
.V10.12.01  28/02/2018  J.Tan            TSK 0852351
.           Recompiled for PATINVHL-fields 226 & 227(Program Code/Desc)
.V10.11.05  27/11/2017  Thanh Tieu       Task 0821710
.           Recompiled as PATMASTM changed
.V10.11.04  24/10/2017  Davin            TSK 0837347
.           Recompiled for PATSHT6 - mods to HCP Practice variables
.V10.11.03  30/07/2017  Thanh T.         TSK 0821710
.           Audit admission/outpatient/UR comments. changed PATMASTM/PMSPX2TM.
.V10.11.02  26/07/2017  Thanh T.         TSK 0821710
.           Recompiled PASMISTM
.V10.11.01  18/07/2017  Steve Armstrong  TSK 0842330
.           Recompiled for changes to PATHST6.
.           14/07/2017  Thanh T.         TSK 0821710
.           Audit Amission/outpatient visit comments. PATMISTM changed.
.-----------------------------------------------------------------------
.V10.10.01  21/03/2017  Thanh T.         TSK 0832066
.           Recompiled for PATSHT6
.V10.09.01  03/02/2017  Ken Bell         TSK 0831808
.           Recompiled for PATHST6 - GP Practice details for Inpatient 
.V10.08.05  07/09/2016  Peter Vela       TSK 0821597
.           Recompiled for PATSHT6 - Medical Records Alert Description
.V10.08.04  10/08/2016  Davin            TSK 0321234
.           Recompiled for PATSHT6 - alert care pathway fields
.           10/08/2016  Ebon Clements    TSK 0821162
.           Recompiled for PATSHT6 - Nearest relative relationship
.V10.08.03  15/07/2016  Davin            TSK 0315393
.           Recompiled for PATSHT6
.V10.08.02  07/06/2016  Jill Parkinson TSK 0820003
.           Recompiled for PMSCEXCD - allow patmx1af/patma1af details
.V10.08.01  03/05/2016  Peter Vela       TSK 0321530
.           Recompiled for PATSHT6
.V10.07.04  23/02/2016  Don Nguyen       TSK 0323914
.           Recompiled for PATSHT6 - added var 1162 (PR6I3162)
.V10.07.03  02/02/2016  Peter Vela       CAR 0322116
.           Recompiled for PATSHT6
.V10.07.02  29/01/2016  Peter Vela       CAR 0809567
.           Recompiled for PATSHT6
.V10.07.01  19/10/2015  Don Nguyen       CAR 316625
.           Recompiled for PATSHT6 - added variables 1152 and 1153
.V10.06.07  21/09/2015  Davin            CAR 313906
.           Recompiled for PMSCEXCD - allow patmx1af/patma1af details
.V10.06.06  14/09/2015  Peter Vela       CAR 320950
.           Recompiled for PATSHT6 - Added Multiple Card Type Number
.V10.06.05  27/08/2015  Don Nguyen       CAR 308621
.           Recompiled for PATSHT6 - added variables 1148-1150
.V10.06.04  13/08/2015  Don Nguyen       CAR 308621
.           Added TABOCTAL and recompiled for PATSHT6
.V10.06.03  28/05/2015  Peter Vela       CAR 312552
.           Recompiled for PATSHT6 - added ASTAY
.V10.06.02  15/05/2015  Davin            CAR 310155
.           Recompiled for PATGBCRN - added MOD10V05 for BPAY
.V10.06.01  15/04/2015  J.Tan            CAR 314503
.           Recompiled for PATSHT6 - added 1135 for Casemix Code
.V10.05.07  10/02/2015 J.Tan      CAR 311717
.           Recompiled for PATINVHL
.V10.05.06  09/01/2015  Don Nguyen       CAR 296120
.           Recompiled for PATSHT6 - added 1132 for TAC Accident Date
.V10.05.05  31/10/2014  J.Tan            CAR 304310
.           Recompiled PATSHT6 - Added 1131 for DVA Visit
.V10.05.04  30/10/2014  Don Nguyen       CAR 307680
.           Recompiled for changes to PATSHT6 - Added PR6I3130
.V10.05.03  29/09/2014  Davin            CAR 305951
.           Recompiled for PATHFCF - Changed fund membership number
.V10.05.02  18/09/2014  Davin            CAR 304204
.           Recompiled for GETDRG - get drg vers based on disch date
.V10.05.01  16/09/2014  Davin            CAR 304498
.           Fixed I * C - Added open of pmsvx1af (init0000)
.V10.04.06  02/07/2014  Don Nguyen       CAR 292599
.           Recompiled for PATSHT6 - Added vars 1120 - 1129
.           Added LINE80 & FIRSTCH
.V10.04.05  16/05/2014  Ebon Clements    CAR 300899
.           Fixed I * C - Added open of ward file index 1
.V10.04.04  24/02/2014  J.Tan            CAR 285504
.           Recompiled for DXPATMAS
.V10.04.03  07/04/2014  Peter Vela      CAR 286258
.           Recompiled for PATMASTM
.V10.04.02  18/03/2014  Don Nguyen       CAR 291879
.           Recompiled for PATSHT6 - Added Field 1117
.           24/02/2014  J.Tan            CAR 285504
.           Recompiled for DXPATMAS
.V10.04.01  09/01/2014  Don Nguyen       CAR 295501
.           Recompiled for PATSHT6 - Added Field 1116
.V10.03.13  09/12/2013  Ania P           CAR 294740
.           Recompiled for PATINVHL
.V10.03.12  12/09/2013  Peter Vela       CAR 271911
.           Recompiled for PATINVTL
.V10.03.11  26/08/2013  Davin            CAR 284840
.           Recompiled for PATSHT6 - Added Fields 1114 & 1115
.V10.03.10  20/06/2013  Davin            CAR 287161
.           Recompiled for PATGBCRN - right justify ptcnhbpi
.V10.03.09  23/04/2013  Don Nguyen       CAR 283575
.           Recompiled for PATSHT6 - Added Fields 1111 & 1112
.V10.03.08  18/04/2013  J.Tan            CAR 281636
.           Recompiled for PATSHT6 - "UNK" AVISIT
.V10.03.07  18/04/2013  Ania P           CAR 281663
.           Recompiled for PATHFCF
.V10.03.06  26/03/2013  Don Nguyen       CAR 282342
.           Recompiled for PATGBCRN
.V10.03.05  05/03/2013  Patrick Adair    CAR 281898
.           Recompiled for PATHFCF
.V10.03.04  18/07/2012  Don Nguyen       CAR 264561
.           Recompiled for PATGBCRN
.V10.03.03  21/02/2012  J.Tan            CAR 247672
.           Recompiled for PATSHT6 - Hospital Approval no for Multi Hosp
.V10.03.02  01/02/2012  J.Tan            CAR 247090
.           Recompiled for PATSHT6 - Print indicator for Card Type
.V10.03.01 10/11/2011  Ebon Clements     CAR 248529
.           Added multiple contacts of the same type functionality
.V10.02.10  18/10/2011  Davin            CAR 253080
.           Recompiled for PATHFCF (added mehdlsfd/io/open)
.V10.02.09  14/10/2011  Davin            CAR 252759
.           Recompiled for PATSHT6
.V10.02.08  13/09/2011  Davin            CAR 248749
.           Recompiled for PATSHT6
.V10.02.07  04/07/2011  Steve Armstrong  CAR 240722
.           Recompiled for changes to PMSCEXCD
.           04/07/2011  Peter Vela  CAR 239594
.           Recompiled for PATSHT6
.V10.02.06  14/06/2011 Ebon Clements    CAR 239530
.           Added print extra contact functionality (Fixed version number)
.V10.02.04  25/05/2011  Saroeun Soeur    CAR 242008
.           Recompiled for PATSHT6
.V10.02.03  12/05/2011  Saroeun Soeur  CAR 242008
.           Recompiled for PATSHT6
.V10.02.02  11/04/2011  Peter Vela     CAR 239759
.           Recompiled for PATSHT6
.V10.02.01  04/04/2011 Jill Parkinson CAR 239574
.           Removed open of ibaprntf
. ----------------------------------------------------------------------
.V10.01.02  06/01/2011 Jill Parkinson CAR 233088
.           Changed to use PMVSFNDM instead of AFNDMM
.V10.01.01  14/12/2010 Mike Laming   CAR 233046
.           Mods to Misc.Charges PATMCHFD - incl. new routine PATMCHRD
. ----------------------------------------------------------------------
.V10.00.01  31/03/2010  Davin          CAR 208120
.           Recompiled for PATSHT6 - var 874 - first Alternate ID
. ----------------------------------------------------------------------
. V9.12.05  05/02/2010  J.Tan            CAR 209061
.           Mods not to print statement for invoice with zero amount
. V9.12.04  07/01/2010  Ebon Clements    CAR 212367
.           Recompiled for PATSHT6 - local doctor free format
. V9.12.03  04/12/2009  Peter Vela       CAR 202333
.           Recompiled for PATINVHL - Changed variable 88 to surname only 
. V9.12.02  12/10/2009  Davin            CAR 205174
.           Recompiled for PATSHT6 - mods to fields 681 (& 682)
. V9.12.01  14/07/2009  Peter Vela       CAR 197776
.           Recompiled for PATSHT6 - Added Referring GP Code and Desc
. V9.11.04  01/04/2009  Peter Vela    CAR 189217
.           Recompiled for PATSHT6 - Discharge Intention CAT KN
.           PMSVX1FD.PMVXUDIN
. V9.11.03  23/03/2009  Davin         CAR 178015
.           Recompiled for PATINVHL - Changed BPAY CRN to use invoice number
. V9.11.02  10/02/2009  Peter Vela    CAR 183976
.           Recompiled for PATSHT6 - Eclipse OEC Eligibility Check
. V9.11.01  14/10/2008  Peter Vela    CAR 159227
.           Recompiled for PATINVHL - Added Emergency Invoice
.           Arrival Date and Time
. V9.10.09  25/09/2008 Peter Vela      CAR 179076
.           Recompiled for PATSHT6 - Added Attending Doctor with call to PACNAME
. V9.10.08  23/09/2008 Peter Vela      CAR 179104
.           Recompiled for PATSHT6
.           - Added deceased PRFA indicator to variable 89
. V9.10.07  16/09/2008 Peter Vela      CAR 170506
.           Recompiled for PATSHT6
.           Added Cat KO pmvxurea code 
.           Added Cat KO pmvxurea description
.           Added Attending Doctor fax number
. V9.10.06  04.09/2008 Ebon Clements   CAR 177643
.           Recompiled for PATSHT6 - PMPXUSR7, PMPXUSR8 & PMPXUSR9
. V9.10.05  19/08/2008 Ebon Clements   CAR 176281
.           Recompiled for PATSHT6 - Fee information
. V9.10.04  15/07/2008  Ebon Clements  CAR 160213
.           Recompiled for update fee estimate functionality changes
. V9.10.03  20/05/2008 Ebon Clements     CAR 166566
.           Recompiled for PATSHT6
. V9.10.02  19/05/2008 Ebon Clements     CAR 167936
.           Recompiled for PATSHT6
. V9.10.01  13/05/2008 Ebon Clements     CAR 166566
.           Recompiled for PATSHT6
. V9.09.12  28/03/2008 Ebon Clements     CAR 164282
.           Recompiled for PATSHT6 - Added Treating Doctor
. V9.09.11  28/02/2008 Peter Vela        CAR 162654
.           Recompiled for PATSHT6 - Added Inform GP
. V9.09.10  08/02/2008 Davin              CAR 153384
.           Recompiled for PATSHT6  
. V9.09.09  25/01/2008 Davin              CAR 153384
.           Recompiled for PATSHT6  
. V9.09.08  25/01/2008 Jill Habasque      CAR 100278
.           Recompiled for PATSHT6  
. V9.09.07  27/12/2007 Peter Vela         CAR 155907
.           Recompiled for PATINVTL
. V9.09.06  05/12/2007 Peter Vela         CAR 147233
.           Recompiled for PATSHT6
. V9.09.05  15/08/2007 Mike Laming        CAR 131722
.           Recompiled for PATSHT6 - add suburb to address lines
. V9.09.04  18/07/2007  Peter Vela        CAR 142173
.           Recompiled for PATSHT6
. V9.09.03  11/07/2007  Mike Laming   CAR 140395
.           Re-compile for PATINVL PATINVHL and PATINVTL
. V9.09.02  20/06/2007  Mike Laming   CAR 140395
.           Added Private Practice invoices to OPTION2 (PPRI0000 & PPPT0000)
.           Added "ADD TOTBAL,NETTOT" in Statements at PRSTAD20
.           Added "Credit Note/s" PTINCRTT to all Statement calcs.
. V9.09.01  03/07/2007 Peter Vela     CAR 142173
.           Recompiled for PATINVTL
. V9.08.10  20/04/2007 Peter Vela     CAR 129314
.           Added Ward Description (WBDESC from Ward record)
. V9.08.09  19/02/2007 Peter Vela     CAR 135241  
.           Recompiled for WEBDINVS - St. John of God invoice layout
. V9.08.08  06/02/2007  Neelkamal Pyla CAR 120594
.           Recompiled for PATSHT6 - Added NOK Relation and Title Desc
. V9.08.07  31/01/2007  Peter Vela     CAR 127930
.           Recompiled for MRTMASFD
. V9.08.06  13/12/2006  J.Tan         CAR 127625
.           Mods to JH HRN
. V9.08.05  27/11/2006  Steve Armstrong   CAR 126039
.           Recompiled for changes to SGCHKDIG
. V9.08.04  16/11/2006  Steve Armstrong   CAR 124160
.           Recompiled for PATSHT6 (Singapore HRN)
.           Recompiled for PATINVHL (Singapore HRN)
.           Recompiled for PATINVTL (Singapore HRN)
. V9.08.03  14/11/2006  Peter Vela    CAR 124547
.           Added reads of PTCNDEES PTCNDDES
. V9.08.02  23/10/2006  Peter Vela    CAR 120622
.           Recompiled for PATSHT6
. V9.08.01  29/09/2006  Peter Vela    CAR 120319
.           Recompiled for PATINVHL
. ----------------------------------------------------------------------
. V9.07.01  25/08/2006  Peter Vela    CAR 105060
.           Recompiled for PATSHT6 - Added aboriginality code
. ----------------------------------------------------------------------
. V9.06.02  04/10/2005  Peter Vela    CAR 60396
.           Recompiled for PATSHT6
. V9.06.01  24/04/2006  J.Tan         CAR 102287
.           Recompiled for PATINVHL - Added fields for multi hospital details
. ----------------------------------------------------------------------
. V9.05.03  29/03/2006  Peter Vela    CAR 95780
.           Recompiled for PATINVHL - Added emg mobile contact numbers
. V9.05.02  27/03/2006  Peter Vela    CAR 61299
.           Increased field no size from DIM3 to DIM5   
. V9.05.01  09/03/2006  Ebon Clements CAR 78533
.           Mods for PATCODTM - Hospital specific category codes
. V9.04.11  03/11/2005  Peter Vela    CAR 79842
.           Recompiled for PATSHT6
. V9.04.10  04/10/2005  Peter Vela    CAR 60396
.           Recompiled for PATSHT6
. V9.04.09  18/08/2005  Peter Vela        CAR 69456
.           Recompiled for PATSHT6
. V9.04.08  01/08/2005  Peter Vela        CAR 67204
.           Recompiled for PATSHT6
. V9.04.07  27/07/2005  Steve Armstrong   CAR 66545
.           Recompiled for PATSHT6
. V9.04.06  19/07/2005  Peter Vela    CAR 63023
.           Recompiled for PATSHT6
. V9.04.05  14/07/2005  Peter Vela    CAR 62172
.           Recompiled for PATINVTL
. V9.04.04  01/03/2005  Peter Vela    CAR 57547
.           Recompiled for PATVADFD and PATVADIO
. V9.04.03  07/10/2004 Jill Habasque CAR 53798
.           Mods to read pathspaf if multi hospital
. V9.04.02  14/09/2004 J.Tan                
.           Mods print statement by adm. to have health fund default from mast.
. V9.04.01  03/09/2004 Lina Vo    CAR 52998
.           Initialise Page number                             
. V9.03.06  07/06/2004 Peter Vela CAR 49016
.           2004 Statutory Changes - recompiled for PMSPX2TM
. V9.03.05  27/05/2004 Peter Vela        CAR 48227
.           Recompiled for PATSHT6
. V9.03.04  06/04/2004 Peter Vela        CAR 48227
.           Added VARGBCRN and PATGBCRN - BPAY Reference Number
. V9.03.03  26/03/2004 Peter Vela        CAR 13038
.           Recompiled for PATDOCCD - Doctor Name format Parameter
. V9.03.02  07/11/2003  Sylvek Litewka   CAR 44328
.           Recompiled for PATMMBFD changes.
. V9.03.01  29/07/2003  J.Tan   SRF 36505
.           Added Print statement
. V9.02.02  10/02/2002  Jill Habasque
.           Recompiled for PATSHT6
. V9.02.01  19/12/2001 Ebon ClementsClements 
.           Recompiled for PATSHT6 - head of unit doctor
. V9.00.B02 13.07.2001 Sandra Barcham
.           Replace GP with HCP
. V9.00.B01 26/02/2001  J.Tan        
.           Recompiled for PATWMAFD
.----------------------------------------------------------------------
.                 V5.08.01  16/08/2000  Caleb Sharman
.                          Changed Health Fund variables to be 8 chars
.                 V5.07.02 12/01/2000  Nicole Harrington
.                          Changed to open of PATWC1A1 to call OPPTWCO1
.                 V5.07.01 20/12/1999  Katie Nelson 
.                          Recompile for IBAWEBDF/IBAWEBCD                    
.                 V5.07.00 27/10/1999  Katie Nelson 
.                          Port to 5.07                                       
.                 V6.06.01 04/05/1999  Katie Nelson 
.                          Removed update default printer file - is now called
.                          from the CLSPRINT routine in WEBPRTCD.
.                 V6.04.01 15/10/1998  Greg Horvat
.                          Changed to print centuries
.                 V6.04.00 11.02.1998 B.G.Ackland
.                          Created Program
.                 V6.04.00 10.06.1998 Katie Nelson
.                          Modified Program to be patient ID print server
.
.----------------------------------------------------------------------
          INC       IBAWEBDF    
          INC       PATCOMM/INC
          INC       PATCALAG/INC
          INC       PATDHEAD/INC
          INC       WEBDINVS/INC
.
          INC       EMRVISFD/INC
          INC       MRTMASFD/INC
          INC       APSMASFD/INC
          INC       AAEDE1FD/INC
          INC       BOKRC1FD/INC                   
          INC       BOKRX1FD/INC                   
          INC       CHKDIGVR/INC
          INC       IBALPCFD/INC
          INC       IBATMDFD/INC
          INC       MEHDLSFD/INC
          INC       MEHVI1FD/INC
          INC       NHIETHFD/INC
          INC       NHIMASFD/INC
          INC       OPRDEAFD/INC
          INC       OUTBOAFD/INC
          INC       OUTBB1FD/INC
          INC       OUTCLIFD/INC
          INC       OUTSITFD/INC
          INC       OUTPREFD/INC
          INC       PATALRFD/INC
          INC       PMSALNFD/INC
          INC       PATAXEFD/INC
          INC       PATASFFD/INC
          INC       PMSUCHFD/INC
          INC       PMSUCDFD/INC
          INC       PATMASTD/INC
          INC       PATCMCFD/INC
          INC       VISMDTFD/INC
          INC       VISMTXFD/INC
          INC       PATCT1FD/INC
          INC       PATCONFD/INC
          INC       PATCUNFD/INC
          INC       PATDADFD/INC
          INC       PATDGWFD/INC
          INC       PATDSCFD/INC
          INC       PATDTRFD/INC
          INC       PATDO1FD/INC
          INC       PATELGFD/INC
          INC       PATQMHFD/INC
          INC       PMSCEXFD/INC
          INC       PMSEEHFD/INC
          INC       PMSEEDFD/INC
          INC       PMSEXTFD/INC
          INC       PMSSESFD/INC
          INC       PMSSEDFD/INC
          INC       PMSERCFD/INC
          INC       PMSAILFD/INC
          INC       PMSFIDFD/INC
          INC       PATMCHFD/INC
          INC       PATFN1FD/INC
          INC       PATGO1FD/INC
          INC       PMSAELFD/INC
          INC       PMSCCDFD/INC
          INC       PMSEVTFD/INC
          INC       PMSHCGFD/INC
          INC       PMSHCPFD/INC
          INC       PATHSPFD/INC
          INC       PATICDFD/INC
          INC       PATIN1FD/INC
          INC       PATITMFD/INC
          INC       PATINVFD/INC
          INC       PATMA1FD/INC
          INC       PATMI1FD/INC
          INC       PATMMBFD/INC
          INC       PATNIDFD/INC
          INC       PATPR1FD/INC
          INC       PATRE1FD/INC
          INC       PATTRNFD/INC
          INC       PATVADFD/INC
          INC       PATVISFD/INC
          INC       PATVKCFD/INC
          INC       PATWC1FD/INC
          INC       PMSDTCFD/INC
          INC       PMSWORFD/INC
          INC       PMSWX1FD/INC
          INC       PATWMAFD/INC
          INC       PATWR1FD/INC
          INC       PATWVEFD/INC
          INC       NZPCFNFD/INC
          INC       NZPSPRFD/INC
          INC       MLTCFNFD/INC
          INC       PATHGPFD/INC
.
          INC       PATATRFD/INC
          INC       PATATRTD/INC
          INC       PRIINVFD/INC
          INC       PRIPRAFD/INC
.
          INC       PMSHCGTD/INC
          INC       PMSHCPTD/INC
          INC       PMSVX1FD/INC
          INC       PMSPRGFD/INC
          INC       PMSDUNFD/INC
          INC       PMSPX2FD/INC
          INC       PMSPX2TD/INC
          INC       PMSRELFD/INC
          INC       PMSTLEFD/INC
          INC       PMSDIVFD/INC
          INC       PMSTEMFD/INC
          INC       PMSIHIFD/INC            * IHI Details
.
          INC       VARGBCRN/INC     * I-48227
          INC       ALLCASFD/INC
          INC       PATMISTD/INC
.
          INC       WEBEEHFD/INC
          INC       WEBEEDFD/INC
          INC       WEBERCFD/INC
          INC       WEBSESFD/INC
          INC       WEBSEDFD/INC
.
.-------------------------------------------------------------------
.         West Wimmera Temp File for Printing Statements by U/R
.-------------------------------------------------------------------
.
WTMPFIL1  IFILE     SQL, FIXED=45, KEY="U1-8,9-16,22-22"
WTMPFIL2  IFILE     SQL, FIXED=45, KEY="U23-30,1-8,9-16,22-22"     
.
WWINVDTE  DIM       8         8         1         Invoice Date CCYYMMDD
WWINVNO   DIM       8         8         9         Invoice Number
WWINVTOT  FORM      6.2       5         17        Invoice Total
WWINVSYS  DIM       1         1         22        System
.                                                 1 = A & E          
.                                                 2 = Outpatients    
.                                                 3 = Inpatients     
.                                                 4 = Other Financial
.                                                 5 = Day Centre     
.                                                 P = Private Practice
.                                                 (Diag. Billing at WWH)
WWURNO    DIM       8         8         23        U/R Number
WWADMN    DIM       8         8         31
WWINVBAL  FORM      6.2       5         39        Outstanding Balance
WWSYS     DIM       1         1         44 
.End of Record                          45
.
.
AGEMASK1  DIM       9               * EDIT field for AGEING[1]
AGEMASK2  DIM       9               * EDIT field for AGEING[2]
AGEMASK3  DIM       9               * EDIT field for AGEING[3]
AGEMASK4  DIM       9               * EDIT field for AGEING[4]
AECNAEIH  DIM       6
AECNAEIT  DIM       6
AGEING    FORM      6.2[4]
ACDESC    DIM       20
ADDRLN    DIM       57
ADIAG     DIM       50
ADMSRC    DIM       19
ADMTYPE   DIM       20
ADOCDESC  DIM       22
AWRDBED   DIM       7
AMOUNT    FORM      8.2
ANSLI     INIT      "i"
ANSLW     INIT      "w"
.
CFILEPRE  DIM       3   * Current Open File Prefix for Outpatient Files
CATap     INIT      "ap"
CATdv     INIT      "dv"
CATTC     INIT      "tc"
CATLS     INIT      "LS"
CURRDAT9  DIM       9
CURRDATE  DIM       8
CARECLS   DIM       20
CLAIMCOD  DIM       3
CLDESC    DIM       20
CLMDET1   DIM       50
CLMDET2   DIM       50
CONTTYPE  DIM       1
CONTTYP2  FORM      1
COUNTRY1  DIM       20
COUNTRY   DIM       12
CURRENT   FORM      8.2
CLMFLAG   FORM      1
.
DALERG    DIM       3
DCATE     DIM       1
DCENT1    DIM       2
DCENT2    DIM       2
DCLASS    DIM       1
DDAY1     DIM       1
DDAY2     DIM       1
DFUND     DIM       20
DIM4      DIM       4
DIM4A     DIM       4
DIM4B     DIM       4
DIM4C     DIM       4
DIM9      DIM       9
DIM1A     DIM       1
DIM1B     DIM       1
DIM1C     DIM       1
DIM3      DIM       3
DIM3A     DIM       3
DIM7      DIM       7
DIM16     DIM       16
DIM18     DIM       18
DIM30     DIM       30
DIM40     DIM       40
DMON1     DIM       1
DMON2     DIM       1
DOCNAME   DIM       30
DOCTCODE  DIM       6
DPSTAT    DIM       24
DSCDEST   DIM       19
DSCSTAT   DIM       20
DSSEX     DIM       8
DSMOKE    DIM       3
DSNAMEA   DIM       20
DTYPE     DIM       20
DYEAR1    DIM       1
DYEAR2    DIM       1
DMON01    INIT      "Jan"
DMON02    INIT      "Feb"
DMON03    INIT      "Mar"
DMON04    INIT      "Apr"
DMON05    INIT      "May"
DMON06    INIT      "Jun"
DMON07    INIT      "Jul"
DMON08    INIT      "Aug"
DMON09    INIT      "Sep"
DMON10    INIT      "Oct"
DMON11    INIT      "Nov"
DMON12    INIT      "Dec"
EDCLM     DIM       3
EMCNGINV  DIM       1       221        Group Invoice by Service Doctor
.
FIRSTCH   FORM      1
FREETXT1  DIM       40
FREETXT2  DIM       40
FREETXT3  DIM       40
FREETXT4  DIM       40
FREETXT5  DIM       40
FREETXT6  DIM       40
FREETXT7  DIM       40
FRSTFLAG  FORM      1
FLAG6ERR  FORM      1
FNDESC    DIM       22
FORM5     FORM      5
FORM62A   FORM      6.2
FORM8     FORM      8
FUNDESC   DIM       30
.
ALRTDESC  DIM       20
WRKDTE8   DIM       8
WRKDTE10  DIM       10
WORKCATG  DIM       2
WORKVAR   DIM       100
.
HCSADM    DIM       4
HCSCAT    DIM       4
HCSINS    DIM       4
HCSMAR    DIM       4
HCSRAC    DIM       4
HCSREG    DIM       4
HCSSRC    DIM       4
HCSTRY    DIM       4
HCSTYP    DIM       4
HCSU2     DIM       4
HDIM4     DIM       4
HFPORT    FORM      6.2
HDOCDESC  DIM       22
HINVDES   DIM       30
HYPHEN    INIT      "-"
HOPTION   FORM      1
.
.
IHINUMBR  DIM       20                      * IHI Number
INPUTNO   FORM      6
INSIND    DIM       1
.
JOURTOT   FORM      6.2
.
KEY21A    DIM       21
KEY26A    DIM       26
.
LABELTYP  DIM       10
LINE80    DIM       80
.
OECWINDC  FORM      1
.
MBSDESC   DIM       40
MPGEFLAG  FORM      1
MARITAL   DIM       10
MARITAL1  DIM       20
MAXDISC   FORM      6.2
MDIM3     DIM       3
MULTILIN  FORM      1
MBIRURNO  DIM       8
MBIRTYOR  DIM       24
.
NOKADDR   DIM       57
.
OTCNOTIH  DIM       6
OTCNOTIT  DIM       6
OVERDUE   FORM      8.2
P10DATE   DIM       10
PREVPRAC  DIM       6
PRNTFLAG  FORM      1
.
RMONTH    DIM       3
RDOCTEL   DIM       12
RDOCFAX   DIM       12
RDOCADD1  DIM       29
RDOCADD2  DIM       29
RDOCADD3  DIM       15
RDOCPCOD  DIM       4
REGDESC   DIM       20
RELIGN    DIM       20
RESADDR   DIM       57
RUNBAL    FORM      8.2
.
SAVKEY5   DIM       5
SAVKEY10  DIM       10
SCHDCOPY  FORM      3
SCHDDESC  DIM       50      * Report Program Description
SCHDPRNT  DIM       3
STCLM     DIM       3
STOTBAL   FORM      8.2
STATFLG   FORM      "1"
SAVFIL8   DIM       8
SBWINDOW  FORM      1
SEXIND    DIM       1
STATNCOD  DIM       6
SUBSYSKY  DIM       50
SVSTNCOD  DIM       6
SERVDOCT  DIM       10
.
TODATE8   DIM       8
TABLNA    DIM       60
TABDESC   DIM       30
TBLDESC   DIM       16
TOTBAL    FORM      8.2
TOTREB    FORM      8.2
.
U1DESC    DIM       20
U1QATB    DIM       3
U2DESC    DIM       20
.
WDIM3     DIM       3
.
XWKAGE    DIM       2
XAGE      DIM       3
.
CODEA     INIT      "A "
CODEAC    INIT      "AC"
CODEBT    INIT      "BT"
CODEC     INIT      "C "
CODECC    INIT      "CC"
CODECL    INIT      "CL"
CODED     INIT      "D "
CODEDD    INIT      "DD"
CODEDX    INIT      "DX"
CODEEG    INIT      "EG"
CODEIO    INIT      "IO"
CODEIP    INIT      "IP"
CODEIQ    INIT      "IQ"
CODEIJ    INIT      "IJ"
CODEIK    INIT      "IK"
CODELA    INIT      "LA"
CODEM     INIT      "M "
CODEP     INIT      "P "
CODEP1    INIT      "P1"
CODEP2    INIT      "P2"
CODEP3    INIT      "P3"
CODEP4    INIT      "P4"
CODEP5    INIT      "P5"
CODEP6    INIT      "P6"
CODEPV    INIT      "PV"
CODER     INIT      "R "
CODES     INIT      "S "
CODEVA    INIT      "VA"
CODEVB    INIT      "VB"
CODEVI    INIT      "VI"
CODEVJ    INIT      "VJ"
CODEVK    INIT      "VK"
CODEVR    INIT      "VR"
CATW0     INIT      "w0"
.
ZERO4     INIT      "0000"
ZERO8     INIT      "0000    "          * for patfndfd
.
SP11      INIT      "           "
SP12      INIT      "            "
SP14      INIT      "              "
.
X2        INIT      "XX"
X3        INIT      "XXX"
X4        INIT      "XXXX"
X15       INIT      "XXXXXXXXXXXXXXX"
X20       INIT      "XXXXXXXXXXXXXXXXXXXX"
X25       INIT      "XXXXXXXXXXXXXXXXXXXXXXXXX"
X27       INIT      "XXXXXXXXXXXXXXXXXXXXXXXXXXX"
X30       INIT      "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
X100      INIT      "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX ": 
                    "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX "
.
STAT6     INIT      "In Hospital         "
STAT7     INIT      "On Short Term Leave "
STAT8     INIT      "On Trial Leave      "
STAT9     INIT      "On Holiday Leave    "
STAT10    INIT      "A.W.O.L.            "
STAT11    INIT      "Discharged          "
.
TABOCTAL  INIT      011                * TAB character (Octal form)
.
.------------------------------------------------------------------------------
PRGID     INIT      "PATWEB72"
VERSION   INIT      "V12.01.00"
PRGNAM    INIT      "Patient Identification Sheet Print Server"
.------------------------------------------------------------------------------
.
          CALL      WEBINT00       * Initialise Fifo Etc.
          CALL      INIT0000       * Open Files
.
MAIN1000  CALL      WEBRED00       * Read Fifo WEBPID and USERID
.
          COMPARE   "999",REPORTNO * End Server Process on Report Option 999
          GOTO      MAIN9999 IF EQUAL
.
          BRANCH    REPORTNO,MAIN1100,MAIN1200,MAIN1300
.
          PACK      WEBTITLE,PRGID,SP1,VERSION,SP1,PRGNAM,SP70
          MOVE      "INVALID OPTION",WEBTITLE
          CALL      WEBERR00   * Create Output File and Write HTML Page Header
          GOTO      MAIN1000
.
MAIN1100  CALL      PRTIDS00  
          BRANCH    EXIT,MAIN1000
.
          MOVE      "Printing Complete",WEBTITLE
          IF        SBWINDOW<>ZERO
            CALL      WINALT00
          ELSE
            CALL      DISALT00
          ENDIF
          GOTO      MAIN1000
.
MAIN1200  CALL      PRNVIS00              * Print Statement for admission
          BRANCH    PRNTFLAG,MAIN1000     * Statement not printed
          BRANCH    EXIT,MAIN1000
.
          MOVE      "Printing Complete",WEBTITLE
          IF        SBWINDOW<>ZERO
            CALL      WINALT00
          ELSE
            CALL      DISALT00
          ENDIF
          GOTO      MAIN1000
.
MAIN1300  CALL      PRSTUR00              * Print Statement for U/R
          BRANCH    PRNTFLAG,MAIN1000     * Statement not printed
          BRANCH    EXIT,MAIN1000
.
          MOVE      "Printing Complete",WEBTITLE
          IF        SBWINDOW<>ZERO
            CALL      WINALT00
          ELSE
            CALL      DISALT00
          ENDIF
          GOTO      MAIN1000
.
MAIN9999  MOVE      "SERVER SHUTDOWN COMPLETE",WEBTITLE
          CALL      WEBERR00
          STOP
.------------------------------------------------------------
.  Print Identification Sheet
.------------------------------------------------------------
PRTIDS00  MOVE      ADMISSNO,KEY8
          CALL      RDMISS1
          BRANCH    OVRCD,PRTIDS90
.
          BRANCH    ASTAT,PRTIDS20,PRTIDS10,PRTIDS20,PRTIDS20,PRTIDS80
.
PRTIDS10  MATCH     SP3,AWARD
          GOTO      PRTIDS20 IF NOT EQUAL
.
.         Get the standby ward
.
          MOVE      AADMNO,WSTBY
          PACK      KEY14,WSTBY,SP6
          CALL      RDSWARD4
          CALL      RDKWARD4
          BRANCH    OVRCD,PRTIDS20
.
          MATCH     AADMNO,WSTBY
          GOTO      PRTIDS20 IF NOT EQUAL
          MOVE      WWARD,AWARD
          MOVE      WBED,ABED
.
PRTIDS20  CALL      CLPATDSC           *Clear discharge file variables
          COMPARE   THREE,ASTAT
          GOTO      PRTIDS30 IF NOT EQUAL
          MOVE      AADMNO,KEY8
          CALL      RDDSCH1
.
PRTIDS30  MATCH     ZEROUR,AURNO         *pre-admission ?
          GOTO      PRTIDS40 IF EQUAL  *yes
          MOVE      AURNO,KEY8
          CALL      RDMAST1
          BRANCH    OVRCD,PRTIDS91
          GOTO      PRTIDS50
.
PRTIDS40  MOVE      AADMNO,KEY8        *no, try read pre-admissions file
          CALL      RDPRAM1            *read pre-admissions file
.
PRTIDS50  MOVE      AADMNO,KEY8
          CALL      RDRESP1
.
.          COMPARE   ZERO,CLUNTNO --   inside WEBGNCUN --  
.          GOTO      PRTIDS60 IF EQUAL
.
          CALL      GCUN0000           *web version of PATGNCUN 
.                                      *Generate clinic unit number 
.
PRTIDS60  CALL      SETUP000           
          BRANCH    EXIT,PRTIDS99
.          
          COMPARE   ONE,PTCNUADT
          CALL      GTRNSRC0 IF EQUAL   *Get the transfer source codes
.
          CALL      OPNPRINT           *Create a spool file
.
          CALL      GMHVIS00
.
          IF        IBCNMHOS<>1
            GOTO      PRTIDS65
          ENDIF
.
          PACK      KEY8,ADMISSNO,SP70
          CALL      RDPMVX11
          BRANCH    OVRCD,PRTIDS92
          PACK      KEY3,PMVXMHOS,SP70
          CALL      RDPTHSP1
.
PRTIDS65  CALL      PRTSHT00      
.
          CALL      CLSPRINT           *Send print file to printer
.
          MOVE      ZERO,EXIT
          GOTO      PRTIDS99
.
PRTIDS80  MOVE      "Admission Status = Cancelled",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PRTIDS99
.
PRTIDS90  MOVE      "ERROR READING ADMISSION FILE",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PRTIDS99
.
PRTIDS91  MOVE      "ERROR READING MASTER FILE",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
.
PRTIDS92  MOVE      "ERROR READING VISIT EXT FILE",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
.
PRTIDS99  RETURN
.------------------------------------------------------------
.    Setup routine from IBABIL79
.------------------------------------------------------------
SETUP000  BRANCH    CIDLAY,SETLID2,SETLINID,SETLID3,SETLID4,SETLID5,SETUP100
          GOTO      SETLINID
.
SETUP100  MOVE      CPIDCOD,KEY6
          CALL      RDIBTH1
          BRANCH    OVRCD,SETUP900
.
          PACK      KEY12,CPIDCOD,SP6  *position on details file 
          CALL      RSIBDET1
          CALL      RKIBDET1
          BRANCH    OVRCD,SETUP900
.
          MATCH     CPIDCOD,IBDTSCOD   *match stationary codes
          GOTO      SETUP900 IF NOT EQUAL
          GOTO      SETUP999
.
SETUP900  MOVE      "User Defined Stationery Code not on file",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
.
SETUP999  RETURN
.------------------------------------------------------------
.   Get the transfer source code
.------------------------------------------------------------
GTRNSRC0  MOVE      SP10,PTDAADTS
          MOVE      SP10,PTDADCTS
          MOVE      AADMNO,KEY8
          CALL      RDPTDAD1           *read PATDADFD record using adm no as key
.
GTRNSRC9  RETURN 
.------------------------------------------------------------
.  PRTSHT Routine from IBABIL79
.------------------------------------------------------------
PRTSHT00  BRANCH    CIDLAY,PRTSHT2,PRTSHEET,PRTSHT3,PRTSHT4,PRTSHT5,PRTSHT6
          GOTO      PRTSHEET    
+
.-------------------------------------------------------------
. Print Statement for a visit number
.-------------------------------------------------------------
PRNVIS00  MOVE      ONE,PRNTFLAG
          MATCH     SP70,ADMISSNO
          GOTO      PRNVIS99 IF EQUAL
.
          MOVE      ONE,STATMENT                                      *I-140395
          READ      CONTROLF,HUND03;*9,PTCNSMTH,*15,PTCNSMTT          *I-140395
.
          MOVE      ONE,WEBFLAG
          MOVE      ONE,HOPTION         * Flag for printing for an admission
          MOVE      SP8,A8DATE
          MOVE      SP10,A10DATE
          MOVE      SP8,D8DATE
          MOVE      SP10,D10DATE
          MOVE      SP8,B8DATE
          MOVE      SP10,B10DATE
          MOVE      ONE,PAGENUM
.
          MOVE      ADMISSNO,AADMNO
          MOVE      ADMISSNO,KEY8
          CALL      RDVISA1
          BRANCH    OVRCD,PRNVIS99
.
          MOVE      URNUMBER,KEY8
          CALL      RDMAST1
          BRANCH    OVRCD,PRNVIS99
.
          CALL      PDET0000
          BRANCH    EXIT,PRNVIS99
          MATCH     SP10,AFUNDH
          IF        @EQUAL
            MOVE      PFUNDH,AFUNDH
            MOVE      PFNDTB,AFNDTB
          ENDIF
.
          UNPACK    ADATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPDATE,A8DATE
          MOVE      CPCDATE,A10DATE
.
          MOVE      ADIAG1,KEY50
.
          UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPDATE,B8DATE
          MOVE      CPCDATE,B10DATE
.
          MATCH     SP8,DDATE
          IF        !@EQUAL
            UNPACK    DDATE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
            MOVE      CPDATE,D8DATE
            MOVE      CPCDATE,D10DATE
          ENDIF
.
          MOVE      SP30,HFNAME
          MOVE      SP30,TABLNM
          MOVE      SP70,TABLNN
          CLEAR     KEY14
          APPEND    AFUNDH,KEY14
          APPEND    "0000",KEY14
          RESET     KEY14
          OPEN      PATFN1A1,"patfn1af"
          CALL      RDFUND1
.
          MOVE      HFNAME,FUNDNM
.
          MOVE      SP30,HFNAME
          PACK      KEY14 WITH AFUNDH,AFNDTB,SP10
          CALL      RDFUND1
          CLOSE     PATFN1A1
.
          MOVE      HFNAME,TABLNM
          MOVE      PMVXFNDM,TABLNN
          CALL      GETPNAM
          CALL      GETPRES
          MOVE      ZERO,PAGENO
.
.         Print the statement 
.
          CALL      OPNPRINT 
          MOVE      THREE,PINVSYS        * default to use inpatient heading
          IF        PTCNSTMT = 0
            CALL      HEAD
          ENDIF
          MOVE      ZERO,TOTBAL
          MOVE      ZERO,TOTREB
          MOVE      ZERO,TOTPAT
          MOVE      ZERO,FRSTFLAG
          MOVE      ZERO,NETTOT
          CALL      PRSTAD00             * Print admission statement
          CALL      CLSPRINT
          MOVE      ZERO,PRNTFLAG
.
PRNVIS99  MOVE      ZERO,STATMENT
          RETURN
+
.-------------------------------------------------------------
.         Check which system this is from to determine
.         what other data needs to be read in, and from where
.-------------------------------------------------------------
PDET0000  MOVE      ZERO,EXIT
          BRANCH    PVITYPE OF PDET3000,PDET2000,PDET1000,PDET4000
          GOTO      PDET9000
.
.         Inpatient data needed
.
PDET1000  MOVE      AADMNO,KEY8
          CALL      RDMISS1
          BRANCH    OVRCD OF PDET9000
.
          MOVE      SP8,DDATE
          MOVE      SP3,DSTAT
          MOVE      AADMNO,KEY8
          CALL      RDDSCH1
          GOTO      PDET9999
.
.         Outpatient data needed
.
PDET2000  MOVE      "out",OSTFILE
          MOVE      PVISITE,KEY6
          CALL      RDSITA1
.
          CLOSE     OUTBB1A2
          PACK      CFNAME,OSTFILE,FILBB1A2
          CALL      OPOTBB12
.
          PACK      KEY16,PVIDATE,PVIBILL
          CALL      RDBOKB2
          BRANCH    OVRCD,PDET9000
.
          MOVE      PVIURNO,OBAURNO
          MOVE      PVISITE,OBASITE
          UNPACK    OBADATE,ADATE     * Initialize ADATE
          MOVE      SP10,DDATE
          MOVE      SP10,AFUNDH
          GOTO      PDET9999
.
.         A & E data needed
.
PDET3000  OPEN      AAEDE1A1,"aaede1af"
          MOVE      PVIBILL,KEY8
          CALL      RDDETA1
          BRANCH    OVRCD OF PDET9000
.
          UNPACK    ADADATE,ADATE     * Initialize ADATE
          MOVE      SP10,DDATE
          MOVE      SP10,AFUNDH
          GOTO      PDET9999
.
.         Other Financial data needed
.
PDET4000  UNPACK    PVIDATE WITH,ADATE
          MOVE      SP10,DDATE
          MOVE      "out",OSTFILE
          MOVE      SP10,AFUNDH
          GOTO      PDET9999
.
PDET9000  MOVE      ONE,EXIT
PDET9999  RETURN
+
.-------------------------------------------------------------
. Print Statement for a patient U/R number
.-------------------------------------------------------------
PRSTUR00  MOVE      TWO,HOPTION             * printing for an U/R 
          MOVE      ZERO,NETTOT
          MOVE      ONE,PRNTFLAG
          MOVE      URNUMBER,KEY8
          CALL      RDMAST1
          BRANCH    OVRCD,PRSTUR99
.
          CALL      OPNPRINT 
.
          MOVE      ONE,STATMENT                                      *I-140395
          READ      CONTROLF,HUND03;*9,PTCNSMTH,*15,PTCNSMTT          *I-140395
.
          MOVE      ZEROVISN,AADMNO
          MOVE      SP10,ADATE
          MOVE      SP10,ATIME
          MOVE      SP10,DDATE
          MOVE      SP10,DTIME
          MOVE      SP10,A8DATE
          MOVE      SP10,D8DATE
          PACK      KEY50,SP20,SP20,SP20
.
          UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPDATE,B8DATE
          MOVE      CPCDATE,B10DATE
.
          MOVE      PFUNDH,AFUNDH
          MOVE      PFNDTB,AFNDTB
          MOVE      SP30,HFNAME
          MOVE      SP30,TABLNM
          MOVE      SP70,TABLNN
          CLEAR     KEY14
          APPEND    AFUNDH,KEY14
          APPEND    "0000",KEY14
          RESET     KEY14
          OPEN      PATFN1A1,"patfn1af"
          CALL      RDFUND1
.
          MOVE      HFNAME,FUNDNM
.
          MOVE      SP30,HFNAME
          PACK      KEY14,AFUNDH,AFNDTB,SP10
          CALL      RDFUND1
          CLOSE     PATFN1A1
.
          MOVE      HFNAME,TABLNM
          MOVE      PMVXFNDM,TABLNN
          CALL      GETPNAM
          CALL      GETPRES                 * uses AADMNO="       0"
.
          MOVE      ZERO,PAGENO
          MOVE      ZERO,TOTBAL
          MOVE      ZERO,TOTREB
          MOVE      ZERO,TOTPAT
.
.         If statement for THC, then call separate routines to print
.
          MOVE      ONE,WEBFLAG
          IF        PTCNSTMT = 1
            CALL      GTHC0000
            GOTO      PRSTUR90              * finished printing THC statement
          ENDIF
.
.        Print the statement heading section
.
          MOVE      ZEROVISN,AADMNO         * print zero admission number
          MOVE      THREE,PINVSYS           * default to use inpatient heading
          MOVE      THREE,PVITYPE           *    "    "   "      "        "
          CALL      HEAD                    * for the heading
.
          MOVE      URNUMBER,PVIURNO
          PACK      KEY24,PVIURNO,SP20
          CALL      RDSVISA2
PRSTUR10  CALL      RDKVISA2
          BRANCH    OVRCD OF PRSTUR70
.
          MATCH     URNUMBER,PVIURNO
          GOTO      PRSTUR70 IF NOT EQUAL
.
          MOVE      PVIBILL,AADMNO
          MOVE      PVIBILL,ADMISSNO
          COMPARE   SIX,PVITYPE
          GOTO      PRSTUR10 IF EQUAL
.
.         Check for a non-zero balance
.
          CALL      CALCOUT
....      BRANCH    PRTALL,PRSTUR20         * Print zero balances
          COMPARE   ZERO,STOTBAL
          GOTO      PRSTUR10 IF EQUAL
.
PRSTUR20  COMPARE   TWO,PTCNINVL            * Anne Caudle invoice ?
          GOTO      PRSTUR24 IF NOT EQUAL    * no
          COMPARE   TWENTY3,COUNT
          GOTO      PRSTUR30 IF LESS
          GOTO      PRSTUR28 IF NOT EQUAL
          GOTO      PRSTUR26
.
PRSTUR24  IF        PTCNINVL=6
            COMPARE   TWENTY7,COUNT
          ELSE
            COMPARE   TWENTY1,COUNT
          ENDIF
          GOTO      PRSTUR30 IF LESS
          GOTO      PRSTUR28 IF NOT EQUAL
.
PRSTUR26  PRINT     *N;
          ADD       ONE,COUNT
.
PRSTUR28  CALL      TLHEAD
.
PRSTUR30  PRINT     *1,"Admission No.:",AADMNO,*N
          ADD       TWO,COUNT
          CALL      PRSTAD00                * Print admission statement
          GOTO      PRSTUR10
.
.                   * print any Private Practice invoices for a UR    *I-140395
PRSTUR70  MOVE      ZERO,EXIT               * end of PMI Invoices
          CALL      PPRI0000                * print any Private Practice Invs.
.
.
PRSTUR80  MOVE      TOTBAL,NETTOT           * set NETTOT for PATINVTL *I-140395
          CALL      CHKLIN00                * print payment due to patient/HF.
.
PRSTUR90  MOVE      SCHDDESC,SCHEDDSC       * Description of Report
          CALL      CLSPRINT
          MOVE      SP70,SCHDDESC
          MOVE      ZERO,PRNTFLAG
.
PRSTUR99  MOVE      ZERO,STATMENT
          RETURN
+
.****************************************************************************
.*                                GTHC0000             Called by:           *
.*                Get THC header details prior and print                    *
.****************************************************************************
.
GTHC0000  MOVE      ZERO,RUNBAL                  * initialise running balance
          MOVE      ZERO,OVERDUE                 * initialise overdue amount
          MOVE      ZERO,CURRENT                 * initialise current amount
          MOVE      ZERO,ENDFLAG                 * initialise finished flag
          MOVE      ZERO,TOTBAL                  * initialise total balance
          MOVE      ONE,PAGENUM                  * initialise page number
          MOVE      ZERO,FRSTFLAG                * initialise first rec. flag
          MOVE      ZERO,NETTOT
.
          MOVE      URNUMBER,PVIURNO
          PACK      KEY24,PVIURNO,SP20
          CALL      RDSVISA2                     * re - position on first visit
GTHC0500  CALL      RDKVISA2                     * read next record
          BRANCH    OVRCD,GTHC9000               * eof - finished
.
          MATCH     URNUMBER,PVIURNO             * same U/R ?
          GOTO      GTHC9000 IF NOT EQUAL        * no - finished
.
          MOVE      PVIBILL,AADMNO               * save admission number
          MOVE      PVIBILL,ADMISSNO
.
          COMPARE   SIX,PVITYPE                  * Comm. Health visit ?
          GOTO      GTHC0500 IF EQUAL            * yes - ignore
.
.         BRANCH    PRTALL,GTHC1000              * Print zero balances
.         CALL      CALCOUT                      * check if zero balance
.         COMPARE   ZERO,STOTBAL                 * balance zero ?
.         GOTO      GTHC0500 IF EQUAL            * yes - ignore
.
GTHC1000  BRANCH    FRSTFLAG,GTHC2000
.
GTHC2000  CALL      PRSTAD00                     * print admiss. transactions
          GOTO      GTHC0500                     * get next visit record
.
GTHC9000  MOVE      ONE,ENDFLAG                  * set finished flag
          CALL      TTHC0000                     * print statement tail
.
GTHC9999  RETURN
+
.-------------------------------------------------------------
.         Print statement for an admission number
.-------------------------------------------------------------
PRSTAD00  MOVE      ZERO,TOTBAL
          PACK      KEY16,ADMISSNO,SP70
          CALL      RDSINV3
PRSTAD10  CALL      RDKINV3
          BRANCH    OVRCD,PRSTAD90
          MOVE      PINVADM,KEY8
          MATCH     KEY8,ADMISSNO
          GOTO      PRSTAD90 IF NOT EQUAL
.
          BRANCH    PINVSYS,PRSTAD12,PRSTAD12,PRSTAD12
          GOTO      PRSTAD10
.
PRSTAD12  BRANCH    PTCNSTMT,PRSTAD20            * using THC layout
.
          MOVE      ZERO,FORM1
.
.         Calculate total invoice for health fund
.
          ADD       PINVREB,TOTREB         * Total invoice for health fund
          ADD       PINVOTHA,TOTREB        * subtract any insurance payment
          ADD       PINVHFDA,TOTREB        * subtract amount paid by health fund
.
.         Calculate total invoice payable to patient
.
          ADD       PINVAMT,TOTPAT
          SUB       PINVREB,TOTPAT
          ADD       PINVJOUR,TOTPAT
          ADD       PINVPATA,TOTPAT        * subtract amount paid by patient
          ADD       PTINCRTT,TOTPAT        * sub Credit Note total    *I-140395
.
.         Calculate balance outstanding
.
PRSTAD20  ADD       PINVAMT,TOTBAL
          ADD       PINVPATA,TOTBAL
          ADD       PINVHFDA,TOTBAL
          ADD       PINVOTHA,TOTBAL
          ADD       PINVJOUR,TOTBAL
          ADD       PTINGSTJ,TOTBAL
          ADD       PTINCRTT,TOTBAL        * sub Credit Note total    *I-140395
.
          COMPARE   ZERO,TOTBAL
          GOTO      PRSTAD10 IF EQUAL      * Zero outstanding
.
.         If using THC statement layout, then process differently
.
          IF        PTCNSTMT = 1
..          IF        TOTBAL = 0 & PRTALL <> 1
..            GOTO      PRSTAD10                 * not printing zero balances
..          ENDIF
.
.           The P.R.A. details are obtained from the first admission record
.           printed and will remain so for all pages printed, regardless of
.           whether the P.R.A. changes as admission number changes.
.
            COMPARE   ZERO,FRSTFLAG
            IF        @EQUAL
              CALL      GETPRES                  * Get P.R.A.
              CALL      IBACLOCK                 * get current date
              MOVE      CCC,CCENT
              MOVE      CYY,CYEAR
              MOVE      CMM,FORM2                * load current month
              MOVE      CDD,CDAY
              CALL      FDAT0000                 * format date
              MOVE      DIM9,CURRDAT9            * load formatted date
              PRINT     *N
.
.             Print the header details
.
              CALL      HTHC0000                 * print statement header
              MOVE      ONE,FRSTFLAG
            ENDIF
            CALL      PLIN0000                   * print line of statement body
            MOVE      ZERO,TOTBAL                * reset invoice balance
            GOTO      PRSTAD10                   * get next invoice
          ENDIF
. 
PRSTAD30  COMPARE   SEVEN,FORM1                                       *C-140395
          GOTO      PRSTAD10 IF NOT LESS
.
          COMPARE   TWO,PTCNINVL            * Anne Caudle invoice ?
          GOTO      PRSTAD32 IF NOT EQUAL   * no
          COMPARE   TWENTY4,COUNT           * yes
          CALL      TLHEAD IF NOT LESS
          GOTO      PRSTAD40
.
PRSTAD32  IF        PTCNINVL=6
            COMPARE   TWENTY8,COUNT
          ELSE
            IF        PTCNINVL=9
              COMPARE   TWENTY7,COUNT
              CALL      TLHEAD IF NOT LESS
            ELSE
              COMPARE   TWENTY2,COUNT
              CALL      TLHEAD IF NOT LESS
            ENDIF
          ENDIF
.
PRSTAD40  ADD       ONE,FORM1
          BRANCH    FORM1,PRSTAD42,PRSTAD44,PRSTAD46,PRSTAD48,PRSTAD50,PRSTAD52
          PRINT     *N;
          ADD       ONE,COUNT
          GOTO      PRSTAD30
.
.         Print the invoice amount
.
PRSTAD42  MOVE      PINVADM,KEY8
          UNPACK    PINVDTE,CCENT,CYEAR,CMON,CDAY 
.         CALL      RDVISA1
.         UNPACK    PVIDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PRINT     *1,CPDATE;
.
          MOVE      ZERO,EXIT
          CALL      SAGE0000                * do the statement ageing
.
          COMPARE   THREE,PINVSYS
          GOTO      PRSTAD43 IF NOT EQUAL   * Not inpatient
.
          MOVE      SP10,DDATE
          MOVE      PINVADM,KEY8
          CALL      RDDSCH1
          BRANCH    OVRCD,PRSTAD43
.
.         MATCH     SP8,DDATE
.         GOTO      PRSTAD43 IF EQUAL
.         UNPACK    DDATE,CCENT,CYEAR,CMON,CDAY
.         CALL      PACDATE
.         PRINT     *10,"- ",CPDATE;
.
PRSTAD43  IF        PTCNINVL=9
              PRINT     *12,"Inv. No: ",PINVNO,*67,PINVAMT
          ELSE
              PRINT     *25,"Invoice No: ",PINVNO,*67,PINVAMT
          ENDIF
          ADD       ONE,COUNT
          GOTO      PRSTAD30
.
.         Print the receipts from patient
.
PRSTAD44  COMPARE   ZERO,PINVPATA
          GOTO      PRSTAD30 IF EQUAL
.
          IF        PTCNINVL=9
              PRINT     *12,"Receipt(s) From Patient",*68,PINVPATA
          ELSE
              PRINT     *27,"Receipt/s From Patient",*68,PINVPATA
          ENDIF
          ADD       ONE,COUNT
          GOTO      PRSTAD30
.
.         Print the receipts from Health fund
.
PRSTAD46  COMPARE   ZERO,PINVHFDA
          GOTO      PRSTAD30 IF EQUAL
.
          IF        PTCNINVL=9
              PRINT     *12,"Receipt(s) From Health Fund",*68,PINVHFDA
          ELSE
              PRINT     *27,"Receipt/s From Health Fund",*68,PINVHFDA
          ENDIF
          ADD       ONE,COUNT
          GOTO      PRSTAD30
.
.         Print the receipts from Insurance
.
PRSTAD48  COMPARE   ZERO,PINVOTHA
          GOTO      PRSTAD30 IF EQUAL
.
          IF        PTCNINVL=9
              PRINT     *12,"Receipt(s) From Insurance",*68,PINVOTHA
          ELSE
              PRINT     *27,"Receipt/s From Insurance",*68,PINVOTHA
          ENDIF
          ADD       ONE,COUNT
          GOTO      PRSTAD30
.
.         Print the journals
.
PRSTAD50  COMPARE   ZERO,PINVJOUR
          GOTO      PRSTAD30 IF EQUAL
.
          IF        PTCNINVL=9
              PRINT     *12,"Journals",*66,PINVJOUR
          ELSE
              PRINT     *27,"Journals",*66,PINVJOUR
          ENDIF
          ADD       ONE,COUNT
          GOTO      PRSTAD30
.
.         Print the journals
.
PRSTAD52  COMPARE   ZERO,PTINCRTT
          GOTO      PRSTAD30 IF EQUAL
.
          IF        PTCNINVL=9
              PRINT     *12,"Credit Note/s",*66,PTINCRTT
          ELSE
              PRINT     *27,"Credit Note/s",*66,PTINCRTT
          ENDIF
          ADD       ONE,COUNT
          GOTO      PRSTAD30
.
.
.
PRSTAD90  ADD       TOTBAL,NETTOT
          COMPARE   TWO,HOPTION
          GOTO      PRSTAD99 IF EQUAL
          CALL      CHKLIN00                 * Check line
PRSTAD99  RETURN
+
******************************************************************************
*                                PPRI0000                                    *
*                    Read Private Practice Invoices (for Statements)         *
******************************************************************************
PPRI0000  MOVE      ZERO,STOTBAL
          MOVE      SP6,PREVPRAC
          PACK      KEY18,URNUMBER,SP20
          CALL      RSPRIN3                      * position in file
PPRI1000  CALL      RKPRIN3                      * read next record
          BRANCH    OVRCD,PPRI9999               * eof - finished
.
          MATCH     URNUMBER,PRINDEBT            * same debtor ?
          GOTO      PPRI9999 IF NOT EQUAL        * no - finished
.
          IF        PRINSCAN<>1
              GOTO      PPRI1000                 * not PMI patient
          ENDIF
.
.                          * Calculate outstanding balance on PRI invoice
          MOVE      PRINITOT,STOTBAL
          ADD       PRINPAMT,STOTBAL
          ADD       PRINHAMT,STOTBAL
          ADD       PRINIAMT,STOTBAL
          ADD       PRINMAMT,STOTBAL
          ADD       PRINVAMT,STOTBAL
          ADD       PRINOTHA,STOTBAL
          ADD       PRINJAMT,STOTBAL
          ADD       PRINCNTT,STOTBAL        * sub Credit Note         *I-140395
.
          COMPARE   ZERO,STOTBAL                 * zero balance ?
          GOTO      PPRI1000 IF EQUAL            * yes - ignore
.
..RI2000  MOVE      ONE,DOPRIVPR
....      CALL      SAGE0000                     * calculate invoice ageing
.
          CALL      PPPT0000                     * print Private Prac Invoice
          ADD       STOTBAL,TOTBAL               * add each invoice to Total
.
          GOTO      PPRI1000                     * get next record
.
PPRI9999  RETURN
+
******************************************************************************
*                                   PPPT0000                                  *
*                   Print Private Practice Invoice line                       *
******************************************************************************
PPPT0000  MOVE      ZERO,EXIT
.
PPPT1000  MATCH     PREVPRAC,PRINPRAC
          GOTO      PPPT1500 IF EQUAL
.
          MOVE      "Unknown practice",PRPRDESC  * get medical practice name
          PACK      KEY6,PRINPRAC
          CALL      RDPRPR1
.
          MOVE      "Unknown doctor",DOCNAME     * get serv. doctor name
          PACK      KEY6,PRINDOCT
          PACK      KEY10,PRINDOCT,SP10
          CALL      RDPMHCP1
          BRANCH    OVRCD,PPPT9999               * not on file
.
          MOVE      PMHCTITL,PACTITLE            * format doctor name
          MOVE      PMHCGNAM,PACGNAME
          MOVE      PMHCSNAM,PACSNAME
          MOVE      ONE,PACFRMT
.
          CALL      PACNAME
          MOVE      PACFNAME,DOCNAME
.
          PRINT     *1,PRPRDESC," - ",DOCNAME,*N
          ADD       TWO,COUNT
          MOVE      PRINPRAC,PREVPRAC
.
PPPT1500  MOVE      ZERO,FORM1
.
PPPT2000  MOVE      ZERO,EXIT
.                                          * check for statement length
          IF        PTCNINVL=2
            COMPARE   TWENTY4,COUNT         *Anne Caudle invoice
            CALL      TLHEAD IF NOT LESS
          ELSE
            IF        PTCNINVL=6
              COMPARE   TWENTY8,COUNT
              CALL      TLHEAD IF NOT LESS
            ELSE
              IF        PTCNINVL=9
                COMPARE   TWENTY7,COUNT
                CALL      TLHEAD IF NOT LESS
              ELSE
                COMPARE   TWENTY2,COUNT
                CALL      TLHEAD IF NOT LESS
              ENDIF
            ENDIF
          ENDIF
.
          ADD       ONE,FORM1
          BRANCH    FORM1,PPPT3001,PPPT3002,PPPT3003,PPPT3004,PPPT3005:
                          PPPT3006,PPPT3007,PPPT3008,PPPT3009
          PRINT     *N;
          ADD       TWO,COUNT
          GOTO      PPPT9999
.
PPPT3001  MOVE      PRINDATE,KEY8
          UNPACK    PRINDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          PRINT     *1,CPDATE;
.
....      MOVE      ONE,DOPRIVPR
....      CALL      SAGE0000                * do the statement ageing
.
          IF        PTCNINVL=9
              PRINT     *12,"Inv. No: ",PRINNUMB,*66,PRINITOT
          ELSE
              PRINT     *25,"Invoice No: ",PRINNUMB,*66,PRINITOT
          ENDIF
          ADD       ONE,COUNT
          GOTO      PPPT2000
.
PPPT3002  COMPARE   ZERO,PRINPAMT
          GOTO      PPPT2000 IF EQUAL
.
          IF        PTCNINVL=9
              PRINT     *12,"Receipt(s) From Patient",*66,PRINPAMT
          ELSE
              PRINT     *27,"Receipt/s From Patient",*66,PRINPAMT
          ENDIF
          ADD       ONE,COUNT
          GOTO      PPPT2000
.
PPPT3003  COMPARE   ZERO,PRINHAMT
          GOTO      PPPT2000 IF EQUAL
.
          IF        PTCNINVL=9
              PRINT     *12,"Receipt(s) From Health Fund",*66,PRINHAMT
          ELSE
              PRINT     *27,"Receipt/s From Health Fund",*66,PRINHAMT
          ENDIF
          ADD       ONE,COUNT
          GOTO      PPPT2000
.
PPPT3004  COMPARE   ZERO,PRINIAMT
          GOTO      PPPT2000 IF EQUAL
.
          IF        PTCNINVL=9
              PRINT     *12,"Receipt(s) From Insurer",*66,PRINIAMT
          ELSE
              PRINT     *27,"Receipt/s From Insurer",*66,PRINIAMT
          ENDIF
          ADD       ONE,COUNT
          GOTO      PPPT2000
.
PPPT3005  COMPARE   ZERO,PRINMAMT
          GOTO      PPPT2000 IF EQUAL
.
          IF        PTCNINVL=9
              PRINT     *12,"Receipt(s) From Medicare",*66,PRINMAMT
          ELSE
              PRINT     *27,"Receipt/s From Medicare",*66,PRINMAMT
          ENDIF
          ADD       ONE,COUNT
          GOTO      PPPT2000
.
PPPT3006  COMPARE   ZERO,PRINVAMT
          GOTO      PPPT2000 IF EQUAL
.
          IF        PTCNINVL=9
              PRINT     *12,"Receipt(s) From Veteran Affairs",*66,PRINVAMT
          ELSE
              PRINT     *27,"Receipt/s From Veteran Affairs",*66,PRINVAMT
          ENDIF
          ADD       ONE,COUNT
          GOTO      PPPT2000
.
PPPT3007  COMPARE   ZERO,PRINOTHA
          GOTO      PPPT2000 IF EQUAL
.
          IF        PTCNINVL=9
              PRINT     *12,"Receipt(s) From Insurer",*66,PRINOTHA
          ELSE
              PRINT     *27,"Receipt/s From Insurer",*66,PRINOTHA
          ENDIF
          ADD       ONE,COUNT
          GOTO      PPPT2000
.
PPPT3008  COMPARE   ZERO,PRINJAMT
          GOTO      PPPT2000 IF EQUAL
.
          IF        PTCNINVL=9
              PRINT     *12,"Journals",*66,PRINJAMT
          ELSE
              PRINT     *27,"Journals",*66,PRINJAMT
          ENDIF
          ADD       ONE,COUNT
          GOTO      PPPT2000
.
PPPT3009  COMPARE   ZERO,PRINCNTT
          GOTO      PPPT2000 IF EQUAL
.
          IF        PTCNINVL=9
              PRINT     *12,"Credit Note/s",*66,PRINCNTT
          ELSE
              PRINT     *27,"Credit Note/s",*66,PRINCNTT
          ENDIF
          ADD       ONE,COUNT
          GOTO      PPPT2000
.
PPPT9999  RETURN
+
.-------------------------------------------------------------
.         Check the current number of line
.-------------------------------------------------------------
CHKLIN00  IF        PTCNINVL=6
            COMPARE   THIRTY,COUNT
          ELSE
            COMPARE   TWENTY5,COUNT
          ENDIF
          GOTO      CHKLIN10 IF NOT LESS
          PRINT     *N;
          ADD       ONE,COUNT
          GOTO      CHKLIN00
.
.         Check if we need to print the patient/hf portion messages
.
CHKLIN10  BRANCH    PTCNSTMS,CHKLIN20       * To print the message
          PRINT     *N,*N,*N
          GOTO      CHKLIN30
.
CHKLIN20  IF        PTCNINVL=9
            PRINT     *N,*N,*N
          ELSE
            PRINT     *N,*N,"We will Claim from your Health Fund an ":
                      "Exp. Rebate of $",TOTREB:
                      *N,"Payment now due from Patient $",TOTPAT
          ENDIF
.
CHKLIN30  ADD       TWO,COUNT
.
.         Calculate the balance payable
.
          COMPARE   TWO,HOPTION
          GOTO      CHKLIN60 IF NOT EQUAL
          MOVE      ZEROVISN,AADMNO
.
CHKLIN60  MOVE      THREE,PINVSYS        * default to use inpatient tail
          CALL      ENDPRT
CHKLIN99  RETURN
+
.-------------------------------------------------------------
.         Print the tail and heading
.-------------------------------------------------------------
TLHEAD    IF        PTCNINVL=6
            COMPARE   THIRTY,COUNT
          ELSE
            COMPARE   TWENTY5,COUNT
          ENDIF
          GOTO      TLHEAD1 IF NOT LESS
          PRINT     *N;
          ADD       ONE,COUNT
          GOTO      TLHEAD
.
.         Check if we need to print the patient/hf portion messages
.
TLHEAD1   PRINT     *N,*N,*N
.
          MOVE      THREE,PINVSYS        * default to use inpatient tail
          IF        HOPTION=2
            MOVE      AADMNO,DIM8VISN       * Save the Admission Number
            MOVE      ZEROVISN,AADMNO       * Print zero admission for
            CALL      TAIL                  * the heading and tail
            MOVE      DIM8VISN,AADMNO
          ELSE
            CALL      TAIL                  * Print with the Admission number
          ENDIF
          RETURN
+
.-------------------------------------------------------------
.         Subroutine to calculate the total amount outstanding for the patient
.-------------------------------------------------------------
CALCOUT   MOVE      ZERO,STOTBAL
          MOVE      ZERO,NUMINVS
          PACK      KEY16 WITH PVIBILL,SP8
          CALL      RDSINV3           
CALCOLP   CALL      RDKINV3
          BRANCH    OVRCD OF CALCOEND
.
          MATCH     PVIBILL,PINVADM
          GOTO      CALCOEND IF NOT EQUAL
.
          IF        HOPTION = 3
            MATCH     PINVDTE,TODATE8
            GOTO      CALCOLP IF LESS
.
.         Check for a valid claim code
.
            MATCH     STCLM,PINVCLM
            GOTO      CALCOLP IF LESS
.
            MATCH     PINVCLM,EDCLM
            GOTO      CALCOLP IF LESS
          ENDIF
.
.         Accumulate totals
.
          ADD       PINVAMT,STOTBAL
          ADD       PINVPATA,STOTBAL
          ADD       PINVHFDA,STOTBAL
          ADD       PINVOTHA,STOTBAL
          ADD       PINVJOUR,STOTBAL
          ADD       PTINCRTT,STOTBAL                                  *I-140395
          ADD       ONE,NUMINVS
          GOTO      CALCOLP
.
CALCOEND  RETURN
+
.*************************************************************************
.*                             FDAT0000              Called by: PLIN0000 *
.*                    Format Date Printed (dd-MMM-yy)           GTHC0000 *
.* Requires: CDAY   (Day - DD)                                           *
.*           CYEAR  (Year - YY)                                          *
.*           FORM2  (Month - MM)                                         *
.* Returns:  DIM9 - formatted date                                       *
.*************************************************************************
.
FDAT0000  LOAD      RMONTH,FORM2,DMON01,DMON02,DMON03,DMON04,DMON05,DMON06:
                    DMON07,DMON08,DMON09,DMON10,DMON11,DMON12
.
.         Format full date
.
          PACK      DIM9,CDAY,HYPHEN,RMONTH,HYPHEN,CYEAR
          REP       " 0",DIM9
.
FDAT9999  RETURN
+
.*********************************************************************
.*        calculate the ageing for the statements
.*        SRF 641xxx - Fixed so that routine calculates difference
.*        between dates, and uses invoice date instead of visit date
.*        as the start date
.*********************************************************************
.
SAGE0000  BRANCH    EXIT,SAGE5000  * Doing West Wimmera Priv Prac Invoices
.
          UNPACK    PINVDTE,CCENT,CYEAR,CMON,CDAY
          PACK      CDYSFDTE,CCENT,CYEAR,CMON,CDAY
          REP       " 0",CDYSFDTE
          PACK      CDYSTDTE,CCC,CYY,CMM,CDD
          REP       " 0",CDYSTDTE
          CALL      CALCDAYS                * number of days
          SUB       ONE,CDYSDAYS            * get difference
.
          MOVE      ZERO,AMOUNT
          ADD       PINVAMT,AMOUNT
          ADD       PINVPATA,AMOUNT
          ADD       PINVHFDA,AMOUNT
          ADD       PINVOTHA,AMOUNT
          ADD       PINVJOUR,AMOUNT
          ADD       PTINCRTT,AMOUNT                                   *I-140395
.
.
          IF        CDYSDAYS > 90
            ADD       AMOUNT,AGEING[1]      * 90 days debt
            GOTO      SAGE9999
          ENDIF
          IF        CDYSDAYS > 60
            ADD       AMOUNT,AGEING[2]      * 60 days debt
            GOTO      SAGE9999
          ENDIF
          IF        CDYSDAYS > 30
            ADD       AMOUNT,AGEING[3]      * 30 days debt
            GOTO      SAGE9999
          ENDIF
.
          ADD       AMOUNT,AGEING[4]        * current debt
          GOTO      SAGE9999
.
. ----    Do Ageing of Priv. Prac. Invoices for West Wimmera ----
.
SAGE5000  UNPACK    PRINDATE,CCENT,CYEAR,CMON,CDAY
          PACK      CDYSFDTE,CCENT,CYEAR,CMON,CDAY
          REP       " 0",CDYSFDTE
          PACK      CDYSTDTE,CCC,CYY,CMM,CDD
          REP       " 0",CDYSTDTE
          CALL      CALCDAYS                * number of days
          SUB       ONE,CDYSDAYS            * get difference
.
          MOVE      ZERO,AMOUNT
          ADD       PRINITOT,AMOUNT
          ADD       PRINPAMT,AMOUNT
          ADD       PRINHAMT,AMOUNT
          ADD       PRINOTHA,AMOUNT
          ADD       PRINJAMT,AMOUNT
          ADD       PRINIAMT,AMOUNT
          ADD       PRINMAMT,AMOUNT
          ADD       PRINVAMT,AMOUNT
.
          IF        CDYSDAYS > 90
            ADD       AMOUNT,AGEING[1]      * 90 days debt
            GOTO      SAGE9999
          ENDIF
          IF        CDYSDAYS > 60
            ADD       AMOUNT,AGEING[2]      * 60 days debt
            GOTO      SAGE9999
          ENDIF
          IF        CDYSDAYS > 30
            ADD       AMOUNT,AGEING[3]      * 30 days debt
            GOTO      SAGE9999
          ENDIF
.
          ADD       AMOUNT,AGEING[4]        * current debt
          MOVE      ZERO,EXIT
.
.
SAGE9999  RETURN
+
.****************************************************************************
.*                              PLIN0000               Called by: PRITVADM  *
.*               Print a line in the statement body for THC                 *
.****************************************************************************
.
PLIN0000  MOVE      PINVADM,KEY8
          CALL      RDVISA1
          BRANCH    OVRCD,PLIN9999
.
          UNPACK    PINVDTE,CCENT,CYEAR,CMON,CDAY      * load invoice date
          MOVE      CMON,FORM2                   * load month
          CALL      FDAT0000                     * format date
.
          COMPARE   THIRTY3,CLNO                 * page full ?
          IF        !@LESS
            CALL      TTHC0000                   * yes - print tail
            ADD       ONE,PAGENUM                * increment page number
            CALL      HTHC0000                   * yes - print header
          ENDIF
.
.         Calculate the ageing of the debt if outstanding balance exists.
.         If an invoice is in credit, then this is part of the current debt.
.
          IF        TOTBAL > 0
            CALL      TAGE0000
            ASSIGN    (OVERDUE+AGEING[3]),OVERDUE
            ADD       AGEING[4],CURRENT
          ELSE
            IF        TOTBAL < 0
              ADD       TOTBAL,CURRENT           * account in credit
            ENDIF
          ENDIF
          ADD       TOTBAL,RUNBAL                * update running balance
.
          PRINT     *6,PINVNO,*15,DIM9,*52,PINVADM,*66,TOTBAL:
                    *77,RUNBAL,*92,PINVNO,*104,TOTBAL
.
          ADD       ONE,CLNO
.
PLIN9999  RETURN
+
.*****************************************************************************
.*                             TAGE0000                Called by: PLIN0000   *
.*        calculate the ageing for the THC statements                        *
.* Returns: AGEING[3] = debts > 30 days old                                  *
.*          AGEING[4] = debts < 31 days old                                  *
.*****************************************************************************
.
TAGE0000  MOVE      ZERO,AGEING[3]
          MOVE      ZERO,AGEING[4]
          UNPACK    PINVDTE,CCENT,CYEAR,CMON,CDAY
          PACK      CDYSFDTE,CCENT,CYEAR,CMON,CDAY
          REP       " 0",CDYSFDTE
          PACK      CDYSTDTE,CCC,CYY,CMM,CDD     * load current date
          REP       " 0",CDYSTDTE
          CALL      CALCDAYS                     * number of days
          SUB       ONE,CDYSDAYS                 * get difference
.
          MOVE      ZERO,AMOUNT                  * total outstanding debt
          ADD       PINVAMT,AMOUNT
          ADD       PINVPATA,AMOUNT
          ADD       PINVHFDA,AMOUNT
          ADD       PINVOTHA,AMOUNT
          ADD       PINVJOUR,AMOUNT
          ADD       PTINCRTT,AMOUNT                                   *I-140395
.
          IF        CDYSDAYS > 30
            ADD       AMOUNT,AGEING[3]           * 31 days+ debt
          ELSE
            ADD       AMOUNT,AGEING[4]           * current debt
          ENDIF
.
TAGE9999  RETURN
+
.****************************************************************************
.*                               HTHC0000              Called by: PLIN0000  *
.*                       Print header of THC statement            GTHC0000  *
.****************************************************************************
.
HTHC0000  PRINT     *N,*N,*N,*44,PFNAME,*80,CURRDAT9:
                    *N,*44,PKADD1:
                    *N,*44,PKADD2,*80,PURNO:
                    *N,*44,PKSUBR:
                    *N,*44,PKADD4:
                    *N,*44,PKPOST,*80,PAGENUM:
                    *N,*N,*92,PFNAME:
                    *N,*N,*N,*92,PURNO,*104,CURRDAT9,*N,*N;
.
          MOVE      TEN6,CLNO                    * initialise line count
.
HTHC9999  RETURN
+
.****************************************************************************
.*                               TTHC0000              Called by: PLIN0000  *
.*                        Print tail of THC statement             GTHC0000  *
.****************************************************************************
.
.         Print blank lines until we are at the second bottom line of the 
.         body of the statement
.
TTHC0000  WHILE     CLNO < 34
            PRINT     *N;
            ADD       ONE,CLNO
          DO
.
.         Print message at bottom of body of statement
.
          PRINT     *N
.
.         Check if we have printed the last record for the current U/R, and
.         if so, print ageing details and total outstanding balance
.
          COMPARE   ZERO,ENDFLAG                 * last record printed for U/R ?
          IF        @EQUAL
            PRINT     *F                         * no - form feed then finish
            GOTO      TTHC9999 IF EQUAL
          ENDIF
.
          PRINT     *N,*102,RUNBAL               * yes - print total
.
.         If there is any overdue debt, then print a warning
.
          IF        OVERDUE > 0 & RUNBAL > 0
            PRINT     *N,*6,"PART OF THE BALANCE IS OVERDUE.  IF PAYMENT":
                      *N,*6,"IS NOT MADE WITHIN 7 DAYS THEN YOUR FILE";
          ELSE
            PRINT     *N,*N;
          ENDIF
.
          PRINT     *50,CURRENT,*61,OVERDUE,*75,RUNBAL;      * print ageing
          IF        OVERDUE > 0
            PRINT     *N,*6,"MAY BE REFERRED TO DUNN & BRADSTREET FOR":
                      *N,*6,"COLLECTION ACTION."
          ENDIF
.
TTHC9999  RETURN
+
.------------------------------------------------------------
.   Process fields from template body
.------------------------------------------------------------
PROFLD00  BRANCH    REPORTNO,PROFLD10,PROFLD99,PROFLD99
          GOTO      PROFLD99
.
PROFLD10  BRANCH    FLDSETNO,PROFLD11,PROFLD12
          GOTO      PROFLD99
.
PROFLD11  CALL      MASF0000
          GOTO      PROFLD99
.
PROFLD12  CALL      MISF0000
          GOTO      PROFLD99
.
PROFLD99  RETURN
.------------------------------------------------------------
. Open Files and Initialize Variables
.------------------------------------------------------------
INIT0000  OPEN      IBASPOL1,"ibaspolf"
          OPEN      IBAPRTA1,"ibaprtaf"        * For Printer Selection
          OPEN      IBACODE1,"ibacodef"        * For Printer Selection
          OPEN      IHAPASS1,"ihapassf"        * For Printer Selection
          OPEN      IBAPDFA1,"ibapdfaf"        * For default printer selection
.
          OPEN      OPRDETA1,"oprdetaf"
          OPEN      OPRDETA2,"oprdetaf"
          OPEN      PATCMCA1,"patcmcaf"
          OPEN      PATHSPA1,"pathspaf"
          OPEN      VISMDTA1,"vismdtaf"
          OPEN      VISMTXA1,"vismtxaf"
          OPEN      PATALRT1,"patalrtf"
          OPEN      PMSALNA1,"pmsalnaf"
          OPEN      PATASFA1,"patasfaf"
          OPEN      PATIN1A1,"patin1af"
          OPEN      PATMA1A1,"patma1af"
          OPEN      PATMX1A1,"patmx1af"
          OPEN      PATMI1A1,"patmi1af"
          OPEN      PMSVX1A1,"pmsvx1af"
          OPEN      PATMMBS1,"patmmbsf"
          OPEN      PATCODE1,"patcodes"
          OPEN      PATDO1A1,"patdo1af"
          OPEN      PATDSCH1,"patdschf"
          OPEN      PATELGA1,"patelgaf"
          OPEN      PMSEEHA1,"pmseehaf"
          OPEN      PMSCEXA1,"pmscexaf"
          OPEN      PMSEEDA1,"pmseedaf"
          OPEN      PMSSESA1,"pmssesaf"
          OPEN      PMSSEDA1,"pmssedaf"
          OPEN      PMSERCA1,"pmsercaf"
          OPEN      PATMCHG1,"patmchgf"
          OPEN      PMSAILA1,"pmsailaf"
          OPEN      PMSFIDA1,"pmsfidaf"
          OPEN      PMSWORA1,"pmsworaf"
          OPEN      PATFN1A1,"patfn1af"
          OPEN      PATRE1A1,"patre1af"
          OPEN      PATGO1A1,"patgo1af"
          OPEN      PATPR1A1,"patpr1af"
          OPEN      PATDADA1,"patdadaf"
          OPEN      PATDGWA1,"patdgwaf"
          OPEN      PATTRAN1,"pattranf"
          OPEN      PATVADA1,"patvadaf"
          OPEN      PATCT1C1,"patct1cf"
          OPEN      PATITEM1,"patitemn"
          OPEN      PATICDD1,"paticddf"
          OPEN      PATWR1A1,"patwr1af"
          OPEN      PATWR1A4,"patwr1af"
          OPEN      PATWC1A1,"patwc1af"
          OPEN      PMSWX1A1,"pmswx1af"
          OPEN      PATWVET1,"patwvetf"
          OPEN      PATWMAB1,"patwmabf"
          OPEN      IBATMHA1,"ibatmhaf"
          OPEN      IBATDET1,"ibatmdaf"
          OPEN      PATCUNO1,"patcunof"
          OPEN      PMSHCPA1,"pmshcpaf"
          OPEN      PMSHCPA4,"pmshcpaf"
          OPEN      PMSHCGA1,"pmshcgaf"
          OPEN      PMSDUNA2,"pmsdunaf"
          OPEN      PMSDTCA1,"pmsdtcaf"
          OPEN      PMSCCDA1,"pmsccdaf"
          OPEN      PMSAELA1,"pmsaelaf"
          OPEN      PMSDIVA2,"pmsdivaf"
          OPEN      PMSTEMA1,"pmstemaf"
          OPEN      PMSRELA1,"pmsrelaf"
          OPEN      PMSRELA2,"pmsrelaf"
          OPEN      MEHDLSA1,"mehdlsaf"
          OPEN      MEHVI1A1,"mehvi1af"
.
          OPEN      PATVISA1,"patvisaf"
          OPEN      PATVISA2,"patvisaf"
          OPEN      PATINVR1,"patinvrf"
          OPEN      PATINVR3,"patinvrf"
          OPEN      EMRVISA1,"emrvisaf"
.
          OPEN      PRIPRAC1,"pripracf"
          OPEN      PRIINVO1,"priinvof"
          OPEN      PRIINVO3,"priinvof"
          OPEN      PATHGRP1,"pathgrpf"
.
          OPEN      OUTSITA1,"outsitaf"
.
.
          OPEN      ALLCASA1,"allcasaf"          * HCP Case Team
.
          MOVE      "out",CFILEPRE
          PACK      CFNAME,CFILEPRE,FILBOKA1
          CALL      OPOTBB11               * Open the file
.
          PACK      CFNAME,CFILEPRE,FILBOKA1  * Get the name of the BOKA1 file
          OPEN      OUTBOKA1,CFNAME           * Open the file
.
.         READ CONTROL FILE
.
          READ      CONTROLF,TEN;*66,CINVLAY,*79,CAPPRVNO,*166,CMEMB
          READ      CONTROLF,TEN3;CHADD1,CHADD2,CHPOST:
                                  CHPADD1,CHPADD2,CHPPOST,CHTELEB:
                                  *213,CHCSCOD
          READ      CONTROLF,TEN4;*1,CNOCLMS:
                                  *227,CIDLAY,*228,CINVFF
          READ      CONTROLF,TEN5;*249,CRDRTYP
          READ      CONTROLF,TEN9;*75,CCNOTES
          READ      CONTROLF,TWENTY;*208,PTCNSTMS
          READ      CONTROLF,TWENTY1;*51,PTCNINVL,*237,PTCNPAOF
          READ      CONTROLF,THIRTY2;*57,OTCNOTIH,*63,OTCNOTIT
          READ      CONTROLF,FIFTY9;*6,CLUNTNO,*50,PTCNUADT:
                                    *132,CALRDESC,*141,CPIDCOD  
          READ      CONTROLF,SEVENTY7;*212,PTCNSUFA
          READ      CONTROLF,SEVENTY8;*40,AECNAEIH,*46,AECNAEIT
          READ      CONTROLF,SEVENTY9;*244,PTCNSTMT
          READ      CONTROLF,NINTY8;*136,PTCNPAIH,*142,PTCNPAIT
          READ      CONTROLF,HUND03;*212,PTCNPFSN,PTCNPFGN,*220,PTCNDEES:
                    *221,PTCNDDES
          READ      CONTROLF,ZERO;*43,IBCNMHOS
          READ      CONTROLF,HUND14;*145,PTCNCLID
          READ      CONTROLF,HUND18;*138,PTCNNEWC
          READ      CONTROLF,HUND20;*158,PTCNUNET
          READ      CONTROLF,HUND29;*61,PTCNWSIN,*71,PTCNOECW,*72,PTCNOECE
          READ      CONTROLF,HUND30;*1,PTCNHABN
.
          IF        IBCNMHOS=1
            OPEN      MLTCODA1,"mltcodaf"
            OPEN      MLTCODA2,"mltcodaf"
          ENDIF
.
          MOVE      ONE,OECWINDC
          MATCH     "1",PTCNOECW
          IF         @EQUAL
.
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      WEBEEHA1,"webeehaf"
            TRAPCLR   IO
            IF        OVRCD=1
              MOVE      ZERO,OECWINDC
            ENDIF
.
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      WEBEEDA1,"webeedaf"
            TRAPCLR   IO
            IF        OVRCD=1
              MOVE      ZERO,OECWINDC
            ENDIF
.
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      WEBERCA1,"webercaf"
            TRAPCLR   IO
            IF        OVRCD=1
              MOVE      ZERO,OECWINDC
            ENDIF
.
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      WEBSESA1,"websesaf"
            TRAPCLR   IO
            IF        OVRCD=1
              MOVE      ZERO,OECWINDC
            ENDIF
.
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      WEBSEDA1,"websedaf"
            TRAPCLR   IO
            IF        OVRCD=1
              MOVE      ZERO,OECWINDC
            ENDIF
.
          ENDIF
.
          MATCH     "0",PTCNUNET
          IF        !@EQUAL
            OPEN      PMSIHIA1,"pmsihiaf"          * IHI Details
          ENDIF
.
          RETURN
.------------------------------------------------------------
. Clear Parameters
.------------------------------------------------------------
CLRPAR00  MOVE      ZERO,REPORTNO
          MOVE      SP70,SCHDDESC
          MOVE      SP70,TEMPLATE
          RETURN
.------------------------------------------------------------
. Set Parameters
.------------------------------------------------------------
SETPAR00  MATCH     "reportno=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,REPORTNO
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "template=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,TEMPLATE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "admissno=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,ADMISSNO
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "urnumber=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,URNUMBER
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "schddesc=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,SCHDDESC
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "selprint=",QRYNAME
          IF        @EQUAL
            SQUEEZE   QRYDATA
            MOVE      QRYDATA,SELPRINT
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "sbwindow=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,SBWINDOW
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "nocopies=",QRYNAME
          IF        @EQUAL
            SQUEEZE   QRYDATA
            MOVE      QRYDATA,NOCOPIES
            GOTO      SETPAR99
          ENDIF
.
SETPAR99  RETURN
+
CMPH0000  RETURN
.
.--------------------------------------------------------------------
. Get Mental Health Visit Details
.--------------------------------------------------------------------
GMHVIS00  PACK      KEY8,ADMISSNO,SP70
          CALL      RDMHVIS1
          BRANCH    OVRCD,GMHVIS99
.         
GMHVIS99  RETURN    
+         
.----------------------------------------------------------------------------
. MVEEH000 - Move webeehaf data to pmseehaf. For template variables
.----------------------------------------------------------------------------
MVEEH000  MOVE      WBEHARID,PMHEARID
          MOVE      WBEHRPTC,PMHERPTC
          MOVE      WBEHCTID,PMHECTID
          MOVE      WBEHBENL,PMHEBENL
          MOVE      WBEHCFAC,PMHECFAC
          MOVE      WBEHCPAM,PMHECPAM
          MOVE      WBEHCPDR,PMHECPDR
          MOVE      WBEHCPDI,PMHECPDI
          MOVE      WBEHCPFN,PMHECPFN
          MOVE      WBEHCPMN,PMHECPMN
          MOVE      WBEHCPRN,PMHECPRN
          MOVE      WBEHEXAM,PMHEEXAM
          MOVE      WBEHEADI,PMHEEADI
          MOVE      WBEHEXBA,PMHEEXBA
          MOVE      WBEHEXDI,PMHEEXDI
          MOVE      WBEHFSTA,PMHEFSTA
          MOVE      WBEHFRID,PMHEFRID
          MOVE      WBEHFSCD,PMHEFSCD
          MOVE      WBEHMSCD,PMHEMSCD
          MOVE      WBEHPEAI,PMHEPEAI
          MOVE      WBEHPSCD,PMHEPSCD
          MOVE      WBEHTNAM,PMHETNAM
          MOVE      WBEHTBDI,PMHETBDI
          MOVE      WBEHTBSC,PMHETBSC
          MOVE      WBEHVCID,PMHEVCID
          MOVE      WBEHUDTE,PMHEUDTE
          MOVE      WBEHUTIM,PMHEUTIM
.
MVEEH999  RETURN
+
.-------------------------------------------------------------
          INC       IBAWEBCD    
.
          INC       APSMASIO/INC
          INC       BOKRC1IO/INC
          INC       BOKRX1IO/INC
          INC       IBATMDIO/INC
.
          INC       CLPATDSC
          INC       CLPMSCEX
          INC       CLPMSEEH
          INC       CLPMSEED
          INC       CLPMSSES
          INC       CLPMSSED
          INC       CLPMSERC
          INC       CLWEBEEH
          INC       CLWEBEED
          INC       CLWEBERC
          INC       CLWEBSES
          INC       CLWEBSED
          INC       GTIHINUM
          INC       IBALPCCD
          INC       PMSCEXCD
          INC       AAEDE1IO/INC
          INC       EMRVISIO/INC
          INC       IBALPCIO/INC
          INC       MRTMASIO/INC
          INC       MEHDLSIO/INC
          INC       MEHVI1IO/INC
          INC       NHIETHIO/INC
          INC       NHIMASIO/INC
          INC       WEBGNCUN                *Generate clinic unit number
          INC       OPRDEAIO/INC
          INC       OUTBB1IO/INC
          INC       OUTSITIO/INC
..          INC       PATCNAIO/INC
          INC       PATALRIO/INC
          INC       PMSALNIO/INC
          INC       PATAXEIO/INC
          INC       PATASFIO/INC
          INC       PATCUNIO/INC
          INC       PMSUCHIO/INC
          INC       PMSUCDIO/INC
          INC       PATDADIO/INC
          INC       PATDGWIO/INC
          INC       PATGO1IO/INC
          INC       PMSCEXIO/INC
          INC       PMSCCDIO/INC
          INC       PMSAELIO/INC
          INC       PMSEVTIO/INC
          INC       PMSHCGIO/INC
          INC       PMSHCPIO/INC
          INC       PATHSPIO/INC
          INC       PATNIDIO/INC
          INC       PATVKCIO/INC
          INC       PATCMCIO/INC
          INC       VISMDTIO/INC
          INC       VISMTXIO/INC
          INC       PATCT1IO/INC
          INC       PATDO1IO/INC
          INC       PATDSCIO/INC
          INC       PATDTRIO/INC
          INC       PATFN1IO/INC
          INC       PATELGIO/INC
          INC       PMSEEHIO/INC
          INC       PMSEEDIO/INC
          INC       PMSSESIO/INC
          INC       PMSSEDIO/INC
          INC       PMSERCIO/INC
          INC       PATMCHIO/INC
          INC       PMSAILIO/INC
          INC       PMSFIDIO/INC
          INC       PATICDIO/INC
          INC       PATIN1IO/INC
          INC       PATITMIO/INC
          INC       PATINVIO/INC
          INC       PATMA1IO/INC
          INC       PATMI1IO/INC
          INC       PATMMBIO/INC
          INC       PATPR1IO/INC
          INC       PATQMHIO/INC
          INC       PATRE1IO/INC
          INC       PATTRNIO/INC
          INC       PATWC1IO/INC
          INC       PMSWORIO/INC
          INC       PMSWX1IO/INC
          INC       PATWMAIO/INC
          INC       PATWR1IO/INC
          INC       PATWVEIO/INC
          INC       PATVADIO/INC
          INC       PATVISIO/INC
          INC       PMSVX1IO/INC
          INC       PMSPRGIO/INC
          INC       PMSDUNIO/INC
          INC       PMSDTCIO/INC
          INC       PMSPX2IO/INC
          INC       PMSRELIO/INC
          INC       PMSTLEIO/INC
          INC       PMSDIVIO/INC
          INC       PMSTEMIO/INC
          INC       PATHGPIO/INC
          INC       PMSIHIIO/INC            * IHI Details
.
          INC       PATATRIO/INC
          INC       MULBIR00
.
          INC       PRIINVIO/INC
          INC       PRIPRAIO/INC
.
          INC       NZPCFNIO/INC
          INC       NZPSPRIO/INC
          INC       MLTCFNIO/INC
          INC       ALLCASIO/INC
.
          INC       WEBEEHIO/INC
          INC       WEBEEDIO/INC
          INC       WEBERCIO/INC
          INC       WEBSESIO/INC
          INC       WEBSEDIO/INC
.
          INC       CLPMSPX2
          INC       PATDOCCD
          INC       PATGBCRN                   * I-48227
          INC       LABELAGE
          INC       CALCAGE
          INC       DAYOFWEK
          INC       PATSHEET      *Patient Identification Sheet
          INC       PATSHT2       *Patient Identifiaction Sheet (St. Andrews)
          INC       PATSHT3       *Patient Identifiaction Sheet (H.O.A)
          INC       PATSHT4       *Patient Identifiaction Sheet (Modbury)
          INC       PATSHT5       *Patient Identifiaction Sheet (Melb. Clinic)
          INC       PATSHT6       *Patient Identifiaction Sheet (User Defined)
.
          INC       PATINVL
          INC       PATINVHL
          INC       PATINVTL
          INC       PATSTA28
.
          INC       CLNHIMAS                   * Clear nhimasaf file variables
          INC       NAMSTRCD
          INC       PATDOCTM
          INC       PMSHCGTM
          INC       PMSHCPTM
          INC       PATMASTM
          INC       PATMISTM
          INC       PATMSXTM
          INC       PMSPX2TM
          INC       GETALTID
          INC       PACADDRS
          INC       PATMCHRD                * Miscellaneous Charges read routine
.
