.***************************************************************************
.* System    :   System Management                                         *
.* Program   :   IBASYS95                                                  *
.* Desc      :   Management of Queuing Messaging Tables                    *
.***************************************************************************
.* Date      :   09/07/2003                                                *
.* Author    :   Steve Armstrong                                           *
.* Function  :   This program will allow the user to query and delete      *
.*               the records in the queuing messaging tables.              *
.* Mods      :                                                             *
.***************************************************************************
.*        V11.04.04 09/04/2024  Davin            TSK 0931586               *
.*                  Fixed branch on coption at drec2000                    *
.*        V11.04.03 28/03/2024 Thanh T           TSK 0935314               *
.*                  Recompiled for PMSQDRFD changes                        *
.*        V11.04.02 09/01/2024 Thanh T           TSK 0936263               *
.*                  Added OPEN PMSQPXA1 index                              *
.*        V11.04.01 11/12/2023 Thanh T           TSK 0935728               *
.*                  Recompiled for OPRQUEFD changes                        *
.*        V11.03.02 22/09/2023  Davin            TSK 0896442               *
.*                  Added message type A37 for PMI UnMerge                 *
.*                  Added option 10 - delete all waiting records (DELW0000)*
.*        V11.03.01 28/07/2023  Ebon Clements    TSK 0935527               *
.*                  Recompiled for OPRQUEFD - Theatre booking hospital     *
.*        V11.02.01 09/02/2022  Thanh T          TSK 0905641               *
.*                  Recompiled as OUTMA1FD/WATTR1FD changes                *
.***************************************************************************
.*        V11.00.01 28/07/2020  Davin            TSK 0894853               *
.*                  Fixed display of alternate A31 message type (VINB0000) *
.***************************************************************************
.*        V10.15.01 13/11/2019  Davin            TSK 0861253               *
.*                  Added OUTTHIFD for O/P telehealth fields               *
.***************************************************************************
.*        V10.13.01 05/12/2018  Don Nguyen       TSK 0838558               *
.*                  Deleted temp file (TEMPFILE) after processing          *
.*        V10.11.03 27/12/2017  Steve Armstrong  TSK 0849511               *
.*                  Fixed default message type in GTYP0000 to be a valid   *
.*                  PMI & ADT record instead of giving an error.           *
.*        V10.11.02 06/11/2017  Steve Armstrong  TSK 0845336               *
.*                  Added new WATQUEFD fields into LODW0000:               *
.*                  WTWMRSFL, WTWMECNT, WTWMCSST, WTWMCSDT, WTWMASSR,      *
.*                  WTWMACPR, WTTXPSAH, WTTXPHOS, WTTXPRPB, WTTXAASC,      *
.*                  WTTXUD09, WTTXUD10, WTTXUD11, WTTXUD12 & WTTXUD13.     *
.*        V10.11.01 22/08/2017  Davin            TSK 0837617               *
.*                  Added message types I12,I13,I14 for W/L Add,Upd,Remove *
.***************************************************************************
.*        V10.10.03 09/06/2017  Davin            TSK 0838220               *
.*                  Added message type A44 for A/H (move visit) (MESSLA44) *
.*        V10.10.02 21/04/2017  Steve Armstrong  TSK 0833052               *
.*                  Added new field ALRETRGS into LODN0000.                *
.*        V10.10.01 27/03/2017  Steve Armstrong  TSK 0833314 & 0830704     *
.*                  Added new ED fields into LODE0000 (EMVIPRLO to         *
.*                  EMVIMDTM).                                             *
.*                  Added new O/P fields into LODO0000 (OTBBFLUP to        *
.*                  OTBBPURC).                                             *
.***************************************************************************
.*        V10.06.03 17/06/2015  Steve Armstrong  CAR 313856                *
.*                  Fixed category for Preferred Accommodation (pmvxpacc)  *
.*                  to use BP instead of MV.                               *
.*        V10.06.02 31/03/2015 Peter Vela         CAR 298921               *
.*                  Changed OTBBADCS to a PMSHCP type field                *
.*        V10.06.01 12/03/2015 Steve Armstrong    CAR 314108               *
.*                  Removed reference to PATCGPFD (No Longer in use)       *
.***************************************************************************
.*        V10.05.01 01/01/2015  Ania P                      CAR 261630     *
.*                  Removed use of PORT for temp file naming               *
.***************************************************************************
.*        V10.04.01 06/02/2014 Steve Armstrong    CAR 297074               *
.*                  Mods to display new holding file variables following   *
.*                  V10.04 FD changes).                                    *
.***************************************************************************
.*        V10.03.08 10/12/2013 Davin              CAR 295110               *
.*                  Check for W/L (watque) last when determining A08 type  *
.*                  (gtyp0300 & gdes0300)                                  *
.*        V10.03.07 27/08/2013 Steve Armstrong    CAR 272415               *
.*                  Mods to not use KURN for Option 6 (By U/R Number),     *
.*                  but to use a new routine which allows the user to      *
.*                  choose either the keyed in U/R, or the "merged to"     *
.*                  U/R where the patient has been merged.                 *
.*        V10.03.06 18/07/2013 Steve Armstrong    CAR 268961               *
.*                  Mods to display Receiving Application Tag and Sending  *
.*                  Facility Tag on the message header record summary      *
.*                  screen (VINB0000).                                     *
.*                  Mods to also display ACLSFFT, ADOCTA & ATYPE for I/P   *
.*                  related messages.                                      *
.*                  Recompiled for changes to PMSQVIFD.                    *
.*        V10.03.05 03/05/2013 Steve Armstrong    CAR 284376               *
.*                  Mods to display Web User ID and Web User Hospital ID   *
.*                  on holding header file details screen.                 *
.*        V10.03.04 20/12/2012 Steve Armstrong    CAR 267173               *
.*                  Changes to handle A03 and A13 messages for O/P and     *
.*                  O/P maintenance (clinic master/clinic type) messages.  *
.*        V10.03.03 15/08/2012 Ebon Clements      CAR 261277               *
.*                  Assigned new cat code to ALREUC32                      *
.*        V10.03.02 15/02/2012  Davin             CAR 256006               *
.*                  Recompiled for changes to WATQUEFD.                    *
.*        V10.03.01 09/11/2011  Steve Armstrong   CAR 254751               *
.*                  Recompiled for changes to OPRQUEFD.                    *
.*                  Fixed O/P and A/H source of referral to use ostcatg    *
.*                  as the category.                                       *
.***************************************************************************
.*        V10.02.03 05/10/2011  Steve Armstrong   CAR 246036               *
.*                  Mods to cater for A05, A08 and A38 W/L Booking         *
.*                  messages.                                              *
.*        V10.02.02 26/09/2011  Steve Armstrong   CAR 249584               *
.*                  Mods to GTYP0000 and GDES0000 to check for pmsqviaf    *
.*                  record last, now that I/P messages are not the only    *
.*                  messages using pmsqviaf.                               *
.*        V10.02.01 21/09/2011  Steve Armstrong   CAR 251515               *
.*                  Recompiled for changes to WATQUEFD.                    *
.*                  Also added new fields from pmsqptaf & pmsqviaf.        *
.***************************************************************************
.*        V10.01.01 10/02/2011  Jill Parkinson CAR 233088                  *
.*                  Added pmsvx1af                                         *
.***************************************************************************
.*        V10.00.05 03/09/2010  Steve Armstrong  CAR 229420                *
.*                  Added CKOH0000 routine to check for on-hold U/R's      *
.*                  and validate if they should be there or not.           *
.*        V10.00.04 25/08/2010  Steve Armstrong  CAR 228937                *
.*                  Mods to GTYP0000 to check outrquaf for A08 message &   *
.*                  A05 message.                                           *
.*        V10.00.03 13/08/2010  Steve Armstrong  CAR 228216                *
.*                  Added U/R column to "Rejected" messages list.          *
.*                  Added new option for Reset all rejected messages.      *
.*                  Changes to GSET0000 to loop through using index 5 of   *
.*                  hl7cisaf instead of index 2, when resetting record     *
.*                  status.                                                *
.*                  Also removed TRAP's from outrquaf & hl7urhaf.          *
.*        V10.00.02 02/07/2010  Davin            CAR 225239                *
.*                  Changed raopque1 to raotque1 in gtyp0000 for A08s      *
.*        V10.00.01 28/08/2009  Steve Armstrong  CAR 135505                *
.*                  Added code to handle Allied Health referral messages   *
.*                  (I12, I13 & I14) and encounter (A03, A08 & A13)        *
.*                  messages.  Removed code to display allaefaf and        *
.*                  allercaf variables as these will no longer be written  *
.*                  allqueaf - they will be read from the relevant tables  *
.*                  at the time of sending the message.                    *
.*                  Also added delete for outrquaf in DOUT0000.            *
.*                  Also added display of trigger id and trigger program   *
.*                  include.                                               *
.*                  01/09/2009  Davin S         CAR 204998                 *
.*                  Only read outrqu (VINB3000) if sending outpatient      *
.*                  referral messages                                      *
.***************************************************************************
.*        V9.11.01  03/03/2009  Steve Armstrong  CAR 177234                *
.*                  Added code to handle O/P referral A05 & A08 messages   *
.***************************************************************************
.*        V9.10.01  26/08/2008  Steve Armstrong  CAR 147323                *
.*                  Added code to handle S12, S14 & S15 messages           *
.***************************************************************************
.*        V9.09.03  05/12/2007  Steve Armstrong  CAR 156961                *
.*                  Mods to delete watqueaf records for A14 & A08          *
.*                  messages.                                              *
.*        V9.09.02  10/03/2007  Steve Armstrong  CAR 145650                *
.*                  Mods to read visit queue tables to determine visit     *
.*                  type instead of using program prefix.                  *
.*        V9.09.01  12/09/2007  Steve Armstrong  CAR 148394                *
.*                  Mods for parameter PTCNH7A5 to cater for an A05 being  *
.*                  sent instead of an A14.                                *
.***************************************************************************
.*        V9.08.01  01/12/2006  Steve Armstrong  CAR 126796                *
.*                  Fixed SYSTEM redisplay after record deletion           *
.***************************************************************************
.*        V9.06.02  29/05/2006  Steve Armstrong  CAR 106897                *
.*                  Added system to message listings                       *
.*        V9.06.01  09/05/2006  Steve Armstrong  CAR 104922                *
.*                  Recompiled for changes to HL7URHFD                     *
.***************************************************************************
.*        V9.05.04  19/04/2006  Steve Armstrong  CAR 81335                 *
.*                  Mods to handle M02 messages.                           *
.*        V9.05.03  23/03/2006  Steve Armstrong  CAR 54614                 *
.*                  Mods to handle display of PRA details.                 *
.*        V9.05.02  22/03/2006  Steve Armstrong  CAR 93425                 *
.*                  Mods to handle display of alternate A31 message.       *
.*        V9.05.01  11/03/2006  Steve Armstrong  CAR 99223                 *
.*                  Fixed display of A13 visit details for Emergency       *
.*                  discharges.                                            *
.*                  06/03/2006  Steve Armstrong  CAR 99223                 *
.*                  Added OBASTAT to the field display list                *
.*        V9.05.B01 13/12/2005  Steve Armstrong  CAR 88619                 *
.*                  Mods to make "Message Id" option 4 instead of 7.       *
.*                  Inserted new option - "View by U/R number".            *
.*                  Added U/R number to display of hl7cisaf details.       *
.*                  Added display of ASTAT to I/P Visit details screen.    *
.*                  Fixed setting of program prefix for Web.               *
.*                  Added PATRE1FD.                                        *
.***************************************************************************
.*        V9.04.01 23/09/2005  Davin                                       *
.*                 Ported from 6.13                                        *
.***************************************************************************
.*        V6.13.03 28/07/2005  Steve Armstrong                             *
.*                 Added new option to query message using message id.     *
.*        V6.13.02 26/07/2005  Steve Armstrong  CAR 68967                  *
.*                 Added code to display PMQVTDAT & PMQVTTIM from pmsqviaf *
.*        V6.13.01 20/07/2005  Steve Armstrong  CAR 68526                  *
.*                 Added code to handle A44 message for I/P, O/P & EMR     *
.***************************************************************************
.
          INC       STD001FD
.
. FILE DESCRIPTION INCLUDES
. -------------------------
          INC       ALLAEFFD/INC
          INC       ALLENCFD/INC
          INC       ALLERCFD/INC
          INC       ALLQUEFD/INC
          INC       ALLREFFD/INC
          INC       BOKRC1FD/INC
          INC       EMRVISFD/INC
          INC       EMRQUEFD/INC
          INC       HL7CISFD/INC
          INC       HL7URHFD/INC
          INC       NHIMASFD/INC
          INC       NZHISIFD/INC
          INC       OPRDEAFD/INC
          INC       OPRQUEFD/INC
          INC       OUTBOAFD/INC
          INC       OUTBB1FD/INC
          INC       OUTCANFD/INC
          INC       OUTCLIFD/INC
          INC       OUTCONFD/INC
          INC       OUTCTYFD/INC
          INC       OUTMA1FD/INC
          INC       OUTPREFD/INC
          INC       OUTQMAFD/INC
          INC       OUTQTYFD/INC
          INC       OUTQUEFD/INC
          INC       OUTRF1FD/INC
          INC       OUTRQUFD/INC
          INC       OUTRSHFD/INC
          INC       OUTSITFD/INC
          INC       OUTTHIFD/INC
          INC       PATALRFD/INC
          INC       PATCALAG/INC
          INC       PATCODFD/INC
          INC       PATCOMM/INC
          INC       PATCONFD/INC
          INC       PATDHEAD/INC
          INC       PATDO1FD/INC
          INC       PATDSCFD/INC
          INC       PATECDFD/INC
          INC       PATGSRFD/INC
          INC       PATHSPFD/INC
          INC       PATMA1FD/INC
          INC       PATMI1FD/INC
          INC       PATNIDFD/INC
          INC       PATONLFD/INC
          INC       PATPR1FD/INC
          INC       PATRE1FD/INC
          INC       PATTRNFD/INC
          INC       PATWR1FD/INC
          INC       PMSBRQFD/INC
          INC       PMSHCPFD/INC
          INC       PMSPX2FD/INC
          INC       PMSQDRFD/INC
          INC       PMSQPTFD/INC
          INC       PMSQVIFD/INC
          INC       PMSVX1FD/INC
          INC       WATQUEFD/INC
          INC       WATTR1FD/INC
          INC       WATTX1FD/INC
          INC       WEBSECFD/INC
          INC       IBASEQFD/INC  
          INC       TFILEVAR/INC
          INC       WEBERRFD/INC
.
.
. LOCAL VARIABLE DEFINITION
. -------------------------
ACTNDESC  DIM       6
ASTATDES  DIM       13
.
BJDAY     FORM      3
BOOKDESC  DIM       13
.
CALLPOSN  FORM      1
CAPTTEXT  DIM       34                 * caption text
CJDAY     FORM      3
CODETYPE  FORM      2
CODECATG  DIM       2
COUNT     FORM      2
COUNTER   FORM      8
COUNTR    FORM      12
CPLENGTH  FORM      2                  * caption length
.
DATEVAR   DIM       8
DATLNGTH  FORM      3                  * data field length
DAYOFWK   DIM       9                  * day of week text
DELTFLAG  FORM      1                  * delete flag
.                                           0 = record just deleted
.                                           1 = record status reset
DIM3      DIM       3
DIM4      DIM       4
DIM7      DIM       7
DIM8      DIM       8
DIM8A     DIM       8
DIM8B     DIM       8
DIM10A    DIM       10
DIM10B    DIM       10
DIM17     DIM       17
DIM20     DIM       20
DIM24     DIM       24
DIM50     DIM       50
DIM78     DIM       78
DISPFLAG  FORM      2                  * PMI flag
.                                           0 = PMI only
.                                           1 = PMI & ADT
.                                           2 = PMI & O/P
.                                           3 = PMI & EMR
.                                           4 = PMI & OPR
.                                           5 = PMI & ALL
.                                           6 = PMI & W/L
.                                           7 = HCP only
.                                           8 = O/P Maintenance
.                                           9 = Error
DOTLNGTH  FORM      2
.
FIELD     FORM      2
FIELDNAM  DIM       8
FIELDTXT  DIM       13                 * database field name text
FLLENGTH  FORM      2                  * database field name length
FORM3     FORM      3
FRSTGNAM  DIM       40
FULLGNAM  DIM       80
.
HCPSTATS  DIM       28
HOSPDESC  DIM       39
.
INTRDESC  DIM       10
.
LSTATDES  DIM       15
.
MESSDESC  DIM       27
MESSNUMB  FORM      20
MESSSTAT  DIM       1
MESSSYST  DIM       3
MESSTYPE  DIM       3
MHLRCODE  DIM       3
MOVEDESC  DIM       17
.
NMPNUMB   DIM       20
.
ODAYDESC  DIM       9
OPMNFLAG  FORM      1             * O/P maintenance flag
.                                     0 = Clinic master maintenance
.                                     1 = Clinic type maintenance
.
PSEXDESC  DIM       13
PURGDESC  DIM       8
.
RECDDISP  DIM       80[18]
.
SAVEKEY1  DIM       37
SAVEKEY2  DIM       40
SAVEKEY3  DIM       44
SAVEURNO  DIM       8
SAVKEY37  DIM       37
SAVKEY44  DIM       44
SAVTXWRD  DIM       3
SCNDGNAM  DIM       40
SELCTION  FORM      2
SPACECNT  FORM      2
SPACENUM  FORM      2
STATDESC  DIM       9
STRTDATE  DIM       8
.
TEMPKEY1  DIM       37[18]
TEMPKEY2  DIM       40[18]
TEMPKEY3  DIM       44[18]
TEMPFILE  FILE      ASCII, FIXED=81
TIMEVAR   DIM       8
.
UPARROW   FORM      1             * Up arrow flag
.                                     0 = up arrow not set
.                                     1 = up arrow set
USERDESC  DIM       30
.
WMSTDESC  DIM       25
WORDSTAT  FORM      2
.
.
. PROGRAM CONSTANTS
.------------------
ACTNDES1  INIT      "Add   "
ACTNDES2  INIT      "Update"
ASTATDE1  INIT      "Pre-admission"
ASTATDE2  INIT      "Admitted     "
ASTATDE3  INIT      "Discharged   "
ASTATDE4  INIT      "On-Leave     "
ASTATDE5  INIT      "Cancelled    "
.
BOOKDES0  INIT      "Not Booked   "
BOOKDES1  INIT      "Booked       "
BOOKDES2  INIT      "Not Used     "
BOOKDES3  INIT      "Extended Slot"
BOOKDES4  INIT      "Attended     "
BOOKDES5  INIT      "No Attendance"
.
ESTADESC  INIT      "                     "
ESTATDE1  INIT      "Current Patient      "
ESTATDE2  INIT      "Discharged Incomplete"
ESTATDE3  INIT      "Discharged Complete  "
.
FRIDAY    INIT      "Friday   "
.
HCPSTA01  INIT      "Attending Doctor            "
HCPSTA02  INIT      "Referring Doctor            "
HCPSTA03  INIT      "Attending & Referring Doctor"
HCPSTA04  INIT      "GP                          "
HCPSTA05  INIT      "Attending Doctor & GP       "
HCPSTA06  INIT      "Referring Doctor & GP       "
HCPSTA07  INIT      "Attending, Referring & GP   "
HCPSTA08  INIT      "Other                       "
HCPSTA09  INIT      "Other Attending             "
HCPSTA10  INIT      "Other Referring             "
HCPSTA11  INIT      "Other Attending & Referring "
HYPHEN    INIT      "-"
.
INTRDES1  INIT      "Not Stated"
.
LSTATDE0  INIT      "On Waiting List"
LSTATDE1  INIT      "Active         "
LSTATDE2  INIT      "Closed         "
LSTATDE3  INIT      "Inactive       "
LSTATDE4  INIT      "Cancelled      "
LSTATDE5  INIT      "Rejected       "
.
MONDAY    INIT      "Monday   "
MESSAA01  INIT      "Admit                 (ADT)"
MESSAA02  INIT      "Transfer              (ADT)"
MESSWA02  INIT      "Transfer              (W/L)"
MESSAA03  INIT      "Discharge             (ADT)"
MESSAA08  INIT      "Admission Update      (ADT)"
MESSAA11  INIT      "Cancel Admission      (ADT)"
MESSAA12  INIT      "Cancel Transfer       (ADT)"
MESSAA13  INIT      "Cancel Discharge      (ADT)"
MESSAA14  INIT      "Pre-admit             (ADT)"
MESSAA21  INIT      "On-Leave              (ADT)"
MESSAA22  INIT      "Return from Leave     (ADT)"
MESSAA27  INIT      "Cancel Pre-admit      (ADT)"
MESSPA28  INIT      "Register Patient      (PMI)"
MESSPA31  INIT      "Update Patient        (PMI)"
MESSPA34  INIT      "Merge Patient         (PMI)"
MESSPA37  INIT      "UnMerge Patient       (PMI)"
MESSAA44  INIT      "Move Visit            (ADT)"
MESSOA03  INIT      "Discharge O/P         (OPD)"
MESSOA04  INIT      "Attend Patient        (OPD)"
MESSOA05  INIT      "Patient Booking       (OPD)"
MESSOA08  INIT      "Booking Update        (OPD)"
MESSOA11  INIT      "Unattend Patient      (OPD)"
MESSOA13  INIT      "Cancel O/P Discharge  (OPD)"
MESSOA38  INIT      "Cancel Booking        (OPD)"
MESSOA44  INIT      "Move Visit            (OPD)"
MESSEA03  INIT      "Discharge             (EMR)"
MESSEA04  INIT      "Register Patient      (EMR)"
MESSEA08  INIT      "Emergency Update      (EMR)"
MESSEA11  INIT      "Cancel Visit          (EMR)"
MESSEA13  INIT      "Cancel Discharge      (EMR)"
MESSEA44  INIT      "Move Visit            (EMR)"
MESSLI12  INIT      "Patient Referral      (ALL)"
MESSLI13  INIT      "Modify Referral       (ALL)"
MESSLI14  INIT      "Cancel Referral       (ALL)"
MESSWI12  INIT      "Add W/L Entry         (W/L)"
MESSWI13  INIT      "Update W/L Entry      (W/L)"
MESSWI14  INIT      "Remove W/L Entry      (W/L)"
MESSLA03  INIT      "Add Encounter         (ALL)"
MESSLA08  INIT      "Modify Encounter      (ALL)"
MESSLA13  INIT      "Cancel Encounter      (ALL)"
MESSLA44  INIT      "Move Visit            (ALL)"
MESSMM01  INIT      "O/P Clinic Master File     "
MESSTM01  INIT      "O/P Clinic Type File        "
MESSPM02  INIT      "Practitioner Master File   "
MESSTS12  INIT      "Add Theatre Booking   (OPR)"
MESSTS14  INIT      "Change Theatre Booking(OPR)"
MESSTS15  INIT      "Cancel Theatre Booking(OPR)"
MESSRA05  INIT      "Add Referral          (OPD)"
MESSRA08  INIT      "Update Referral       (OPD)"
MESSWA05  INIT      "Create Booking        (W/L)"
MESSWA08  INIT      "Booking Update        (W/L)"
MESSWA38  INIT      "Booking Cancellation  (W/L)"
MESSWA44  INIT      "Move Visit            (W/L)"
MESTYP01  INIT      "A01"
MESTYP02  INIT      "A02"
MESTYP03  INIT      "A03"
MESTYP04  INIT      "A04"
MESTYP05  INIT      "A05"
MESTYP08  INIT      "A08"
MESTYP11  INIT      "A11"
MESTYP12  INIT      "A12"
MESTYP13  INIT      "A13"
MESTYP14  INIT      "A14"
MESTYP21  INIT      "A21"
MESTYP22  INIT      "A22"
MESTYP27  INIT      "A27"
MESTYP28  INIT      "A28"
MESTYP31  INIT      "A31"
MESTYP34  INIT      "A34"
MESTYP37  INIT      "A37"
MESTYP38  INIT      "A38"
MESTYP44  INIT      "A44"
MESTYM02  INIT      "M02"
MESTYS12  INIT      "S12"
MESTYS14  INIT      "S14"
MESTYS15  INIT      "S15"
MESTYI12  INIT      "I12"
MESTYI13  INIT      "I13"
MESTYI14  INIT      "I14"
.
MOVEDES1  INIT      "Admission        "
MOVEDES2  INIT      "Discharge        "
MOVEDES3  INIT      "Change           "
MOVEDES4  INIT      "On Leave         "
MOVEDES5  INIT      "Return from Leave"
.
OSTADESC  INIT      "                     "
OSTATDE0  INIT      "Not Booked           "
OSTATDE1  INIT      "Booked               "
OSTATDE2  INIT      "Not Used             "
OSTATDE3  INIT      "Extended Slot        "
OSTATDE4  INIT      "Attended             "
OSTATDE5  INIT      "No Attendance        "
OSTATDE6  INIT      "Suspended            "
OSTATDE7  INIT      "Unavailable          "
OSTATDE8  INIT      "                     "
OSTATDE9  INIT      "Reserved             "
.
PSEXFEML  INIT      "Female       "
PSEXINDT  INIT      "Indeterminate"
PSEXMALE  INIT      "Male         "
PSEXUNKN  INIT      "Unknown      "
PSEXINTR  INIT      "Intersex     "
PURGDES1  INIT      "No Purge"
PURGDES2  INIT      "Partial "
PURGDES3  INIT      "Fully   "
.
SATURDAY  INIT      "Saturday "
SP16      INIT      "                "
SP80      INIT      "                                        ":
                    "                                        "
STATDESD  INIT      "Delivered"
STATDESR  INIT      "Rejected "
STATDESW  INIT      "Waiting  "
SUNDAY    INIT      "Sunday   "
.
THURSDAY  INIT      "Thursday "
TILDA40   INIT      "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
TUESDAY   INIT      "Tuesday  "
.
WEDNSDAY  INIT      "Wednesday"
WMSTDSC1  INIT      "Unscheduled"
WMSTDSC2  INIT      "Scheduled"
WMSTDSC3  INIT      "Pre-Admitted"
WMSTDSC4  INIT      "Admitted"
WMSTDSC5  INIT      "Discharged"
WMSTDSC6  INIT      "Removed from Waiting List"
WMSTDSC7  INIT      "Performed"
WMSTDSC8  INIT      "Not Performed"
WMSTDSC9  INIT      "Cancelled Admission"
WPFILEP   INIT      "sys95a"
.
.
.
PRGID     INIT      "IBASYS95"
PRGNAM    INIT      "Queuing Message Table Maintenance"
VERSION   INIT      "V12.01.00"
+
.**************************************************************************
.*                              MAIN0000                                  *
.*                      Controlling Logic (Mainline code)                 *
.**************************************************************************
.
MAIN0000  CALL      INIT0000               * initialisation and open files
          BRANCH    EXIT,MAIN9999          * error
.
MAIN0100  CALL      OPTN0000               * select options
          BRANCH    EXIT,MAIN9999          * EXIT = 1 if 0 chosen in menu
          BRANCH    COPTION,MAIN1000:      * view all waiting records
                            MAIN1000:      * view all delivered records
                            MAIN1000:      * view delivered recs by mess. type
                            MAIN1000:      * view all rejected records
                            MAIN4000:      * view by message id
                            MAIN5000:      * view by U/R number
                            MAIN2000:      * delete delivered
                            MAIN3000:      * delete all
                            MAIN6000:      * reset all rejected messages
                            MAIN7000       * delete waiting
.
MAIN1000  CALL      VIEW0000               * view queued records
          GOTO      MAIN0100
.
MAIN2000  CALL      DELD0000               * delete delivered records
          GOTO      MAIN0100
.
MAIN3000  CALL      DELA0000               * delete all records
          GOTO      MAIN0100
.
MAIN4000  CALL      VMES0000               * view by message id
          GOTO      MAIN0100
.
MAIN5000  CALL      GPAT0000               * get patient U/R
          BRANCH    EXIT,MAIN0100          * nothing input
.
          CALL      VIEW0000               * view queued records
          GOTO      MAIN5000
.
MAIN6000  CALL      ALLR0000               * reset all rejected messages
          CALL      CKOH0000               * check all U/R's on hold
          GOTO      MAIN0100
.
MAIN7000  CALL      DELW0000               * delete waiting records
          GOTO      MAIN0100
.
MAIN9999  CHAIN     PGM                    * chain back to program
+
.****************************************************************************
.*                                INIT0000             Called by: MAIN0000  *
.*                             initialisation                               *
.*  The initialisation routine is used to display headings and open files.  *
.****************************************************************************
.
INIT0000  CALL      DISPHEAD                  * display heading
.
          DISPLAY   *P56:24,*EL,"Opening ":
                    *P64:24,"controlf";
          OPEN      CONTROLF,"controlf"
.
          DISPLAY   *P64:24,"hl7cisaf";
          OPEN      HL7CISA1,"hl7cisaf"
          OPEN      HL7CISA2,"hl7cisaf"
          OPEN      HL7CISA3,"hl7cisaf"
          OPEN      HL7CISA4,"hl7cisaf"
          OPEN      HL7CISA5,"hl7cisaf"
.
          DISPLAY   *P64:24,"hl7urhaf";
          OPEN      HL7URHA1,"hl7urhaf"
.
          DISPLAY   *P64:24,"allqueaf";
          OPEN      ALLQUEA1,"allqueaf"
.
          DISPLAY   *P64:24,"emrqueaf";
          OPEN      EMRQUEA1,"emrqueaf"
.
          DISPLAY   *P64:24,"oprqueaf";
          OPEN      OPRQUEA1,"oprqueaf"
.
          DISPLAY   *P64:24,"outqmaaf";
          OPEN      OUTQMAA1,"outqmaaf"
.
          DISPLAY   *P64:24,"outqtyaf";
          OPEN      OUTQTYA1,"outqtyaf"
.
          DISPLAY   *P64:24,"outqueaf";
          OPEN      OUTQUEA1,"outqueaf"
.
          DISPLAY   *P64:24,"outrquaf";
          OPEN      OUTRQUA1,"outrquaf"
.
          DISPLAY   *P64:24,"outsitaf";
          OPEN      OUTSITA1,"outsitaf"
.
          DISPLAY   *P64:24,"patcodes";
          OPEN      PATCODE1,"patcodes"
.
          DISPLAY   *P64:24,"patdo1af";
          OPEN      PATDO1A1,"patdo1af"
.
          DISPLAY   *P64:24,"pathspaf";
          OPEN      PATHSPA1,"pathspaf"
.
          DISPLAY   *P64:24,"pmshcpaf";
          OPEN      PMSHCPA1,"pmshcpaf"
.
          DISPLAY   *P64:24,"pmspx2af";
          OPEN      PMSPX2A1,"pmspx2af"
.
          DISPLAY   *P64:24,"pmsqdraf";
          OPEN      PMSQDRA1,"pmsqdraf"
.
          DISPLAY   *P64:24,"pmsqptaf";
          OPEN      PMSQPTA1,"pmsqptaf"
          OPEN      PMSQPXA1,"pmsqpxaf"
.
          DISPLAY   *P64:24,"pmsqviaf";
          OPEN      PMSQVIA1,"pmsqviaf"
.
          DISPLAY   *P64:24,"patmastf";
          OPEN      PATMA1A1,"patma1af"
          OPEN      PATMX1A1,"patmx1af"
.
          DISPLAY   *P64:24,"patgsrnf";
          OPEN      PATGSRN2,"patgsrnf"
          OPEN      PATGSRN3,"patgsrnf"
.
          DISPLAY   *P64:24,"watqueaf";
          OPEN      WATQUEA1,"watqueaf"
.
          DISPLAY   *P64:24,"websecaf";
          OPEN      WEBSECA1,"websecaf"
.
          READ      CONTROLF,THIRTY2;*126,OTCNA05R:
                                     *127,OTCNA08R
          READ      CONTROLF,HUND10;*98,PTCNA31X  * get alternative A31 message
          READ      CONTROLF,HUND12;*99,PTCNH7A5  * sending A05 instead of A08
.
          CALL      TFILENAM
          MOVE      TFILNAME,CFNAME
.
          MOVE      ZERO,EXIT
          GOTO      INIT9999
.
INIT9100  MOVE      ONE,EXIT
.
INIT9999  RETURN
+
.****************************************************************************
.*                                OPTN0000             Called by: MAIN0000  *
.*                        get user options or exit                          *
.*                                                                          *
.*    Returns:  COPTION =       (1)  View All Waiting Records               *
.*                              (2)  View All Delivered Records             *
.*                              (3)  View Delivered Records by Mess. Type   *
.*                              (4)  View All Rejected Messages             *
.*                              (5)  View By Message Id                     *
.*                              (6)  View By Patient U/R Number             *
.*                              (7)  Delete Delivered Records               *
.*                              (8)  Delete All Records                     *
.*                              (9)  Reset All Rejected Records             *
.*                              (10) Delete Waiting Records                 *
.*              EXIT   0 = Valid selection                                  *
.*                     1 = exit selected                                    *
.****************************************************************************
.
OPTN0000  HLINE     *G37,2,57,80
          DISPLAY   *P1:3,*EF,*P1:4,*V2LON,ZERO,*HOFF,". Exit":
                    *P1:5,*V2LON,ONE,*HOFF,". View All Waiting Messages":
                    *P1:6,*V2LON,TWO,*HOFF,". View All Delivered Messages":
                    *P1:7,*V2LON,THREE,*HOFF,". View Delivered Messages by":
                                            " Message Type":
                    *P1:8,*V2LON,FOUR,*HOFF,". View All Rejected Messages":
                    *P1:9,*V2LON,FIVE,*HOFF,". View by Message Id":
                    *P1:10,*V2LON,SIX,*HOFF,". View by U/R Number":
                    *P1:11,*V2LON,SEVEN,*HOFF,". Delete Delivered Messages":
                    *P1:12,*V2LON,EIGHT,*HOFF,". Delete All Messages":
                    *P1:13,*V2LON,NINE,*HOFF,". Reset All Rejected Messages":
                    *P1:14,*V2LON,TEN,*HOFF,". Delete Waiting Messages"
.
OPTN0500  KEYIN     *P1:16,*EL,"Select Option : ":
                    *P17:16,*V2LON,COPTION
.
          COMPARE   ZERO,COPTION                 * exit selected ?
          GOTO      OPTN9910 IF EQUAL            * yes
.
          BRANCH    COPTION,OPTN9100:            * view all waiting records
                            OPTN9200:            * view all delivered records
                            OPTN9300:         * view delivered recs by mess type
                            OPTN9400:            * view all rejected records
                            OPTN9500:            * view by message id
                            OPTN9600:            * view by U/R number
                            OPTN9700:            * delete delivered records
                            OPTN9800:            * delete all records
                            OPTN9850:            * reset all rejected records
                            OPTN9860             * delete waiting records
.
          BEEP
          GOTO      OPTN0500
.
OPTN9100  DISPLAY   *P57:2,"- All Waiting "
          GOTO      OPTN9900
.
OPTN9200  DISPLAY   *P57:2,"- All Delivered "
          GOTO      OPTN9900
.
OPTN9300  DISPLAY   *P57:2,"- Delivered by Type "
          GOTO      OPTN9900
.
OPTN9400  DISPLAY   *P57:2,"- All Rejected "
          GOTO      OPTN9900
.
OPTN9500  DISPLAY   *P57:2,"- Message Id "
          GOTO      OPTN9900
.
OPTN9600  DISPLAY   *P57:2,"- U/R Number "
          GOTO      OPTN9900
.
OPTN9700  DISPLAY   *P57:2,"- Delete Delivered "
          GOTO      OPTN9900
.
OPTN9800  DISPLAY   *P57:2,"- Delete All "
          GOTO      OPTN9900
.
OPTN9850  DISPLAY   *P57:2,"- Reset All Rejected "
          GOTO      OPTN9900
.
OPTN9860  DISPLAY   *P57:2,"- Delete Waiting "
          GOTO      OPTN9900
.
OPTN9900  MOVE      ZERO,EXIT
          GOTO      OPTN9999
.
OPTN9910  MOVE      ONE,EXIT
.
OPTN9999  RETURN
+
.*********************************************************************
.*                  KEYA0000                    Called by : VIEW0000 *
.*        Keyin response to question                                 *
.*        Returns : EXIT = 0      Number entered                     *
.*                  EXIT = 1      Exit   entered                     * 
.*                  EXIT = 2      Next   entered                     * 
.*                  EXIT = 3      Prev   entered                     * 
.*                  EXIT = 4      Delete entered                     * 
.*                  EXIT = 5      View   entered                     * 
.*                  EXIT = 6      reFresh entered                    * 
.*                  EXIT = 7      reSet entered                      * 
.*********************************************************************
.
KEYA0000  DISPLAY   *P1:24,*EL,"Select item, e(",*V2LON,ANSX,*HOFF,")it, (":
                    *V2LON,ANSD,*HOFF,")elete, (",*V2LON,ANSV,*HOFF,")iew, re(":
                    *V2LON,ANSF,*HOFF,")resh, re(",*V2LON,ANSS,*HOFF,")et";
          MOVE      FIFTY7,CCOL
          IF        CALLPOSN = 1 | CALLPOSN = 2
            DISPLAY   ", (",*V2LON,ANSN,*HOFF,")ext";
            ADD       EIGHT,CCOL
          ENDIF
          IF        CALLPOSN = 1
            DISPLAY   ", p(",*V2LON,ANSR,*HOFF,")ev.";
            ADD       NINE,CCOL
          ENDIF
          IF        CALLPOSN = 3
            DISPLAY   ", p(",*V2LON,ANSR,*HOFF,")evious";
            ADD       TEN2,CCOL
          ENDIF
.
          DISPLAY   " :  ";
          ADD       FOUR,CCOL
.
KEYA1000  KEYIN     *PCCOL:24,*V2LON,*JR,DIM2:
                    *PCCOL:24,*DV,DIM2
.
.         Check if down arrow selected and if so move to next record on page
.         or next page (if last record on current page).
.
          IF        @DOWN
             IF       SELCTION < FIELD
               ADD      ONE,FORM2
               CALL     GREC0000            * next record
               BRANCH   EXIT,KEYA0000       * record not found
               GOTO     KEYA0000
             ELSE
               GOTO     KEYA9200            * next page
             ENDIF
          ENDIF
.
.         Check if up arrow selected and if so move to previous record on page,
.         or last record on previous page (if first record is selection on 
.         current page and this is not the first page).
.
          IF        @UP
             IF       SELCTION > 1
               SUB      ONE,FORM2
               CALL     GREC0000            * next record
               BRANCH   EXIT,KEYA0000       * record not found
               GOTO     KEYA0000
             ELSE
               IF       CPAGENO > 1
                 MOVE     ONE,UPARROW       * set up arrow flag (record 1)
                 GOTO     KEYA9300          * previous page
               ENDIF
             ENDIF
          ENDIF
.
          PACK      DIM2,DIM2,SP2
          UNPACK    DIM2,ANS,ANS
          REP       UPPLOW,ANS
.
          MATCH     ANSD,ANS                * delete selected ?
          IF        @EQUAL
            COMPARE   ZERO,SELCTION         * yes - selection made ?
            GOTO      KEYA9400 IF NOT EQUAL * yes
.
            BEEP
            GOTO      KEYA0000
          ENDIF
.
          MATCH     ANSV,ANS                * view selected ?
          IF        @EQUAL
            COMPARE   ZERO,SELCTION         * yes - selection made ?
            GOTO      KEYA9500 IF NOT EQUAL * yes
.
            BEEP
            GOTO      KEYA0000
          ENDIF
.
          MATCH     ANSX,ANS                * exit selected ?
          GOTO      KEYA9100 IF EQUAL       * yes
.
          MATCH     ANSN,ANS                * next page selected ?
          GOTO      KEYA9200 IF EQUAL       * yes
.
          MATCH     ANSR,ANS                * previous page selected ?
          GOTO      KEYA9300 IF EQUAL       * yes
.
          MATCH     ANSF,ANS                * reFresh page selected ?
          GOTO      KEYA9600 IF EQUAL       * yes
.
          MATCH     ANSS,ANS                * reSet selected ?
          IF        @EQUAL
            COMPARE   ZERO,SELCTION         * yes - selection made ?
            GOTO      KEYA9700 IF NOT EQUAL * yes
.
            BEEP
            GOTO      KEYA0000
          ENDIF
.
          TYPE      DIM2
          GOTO      KEYA5000 IF EQUAL       * a number entered
.
KEYA1500  BEEP
          GOTO      KEYA1000
.
.         number entered directly
.
KEYA5000  MOVE      DIM2,FORM2
.
          COMPARE   FORM2,ZERO              * number < 1 ?
          GOTO      KEYA1500 IF NOT LESS    * yes - invalid
.
          COMPARE   FORM2,FIELD             * number in range ?
          GOTO      KEYA1500 IF LESS        * no - too high
.
.         set the exit flag
.
          MOVE      ZERO,EXIT               * number selected
          GOTO      KEYA9999
.
KEYA9100  MOVE      ONE,EXIT                * exit
          GOTO      KEYA9999
.
KEYA9200  MOVE      TWO,EXIT                * next
          GOTO      KEYA9999
.
KEYA9300  MOVE      THREE,EXIT              * previous
          GOTO      KEYA9999
.
KEYA9400  CALL      DELQST                  * delete
          BRANCH    CEXIT,KEYA9450:         * Yes
                          KEYA0000:         * No
                          KEYA0000          * Cancel
KEYA9450  MOVE      FOUR,EXIT
          GOTO      KEYA9999
.
KEYA9500  MOVE      FIVE,EXIT               * view
          GOTO      KEYA9999
.
KEYA9600  MOVE      SIX,EXIT                * reFresh
          GOTO      KEYA9999
.
KEYA9700  MOVE      SEVEN,EXIT              * reSet
.
KEYA9999  RETURN
+
.**************************************************************************
.*                               VIEW0000              Called by: MAIN0000*
.*           Display all the records on the header file (hl7cisaf)        *
.**************************************************************************
.
.         Get the message type if displaying delivered records by
.         message type (option 3)
.
VIEW0000  IF        COPTION = 3
            KEYIN     *P1:24,*EL,"Message Type:":
                      *P15:24,*V2LON,MESSTYPE
.
            PACK      MESSTYPE,MESSTYPE,SP3
            REP       UPPLOW,MESSTYPE
.
            MATCH     SP3,MESSTYPE                 * anything entered ?
            GOTO      VIEW9999 IF EQUAL            * no - finish
.
.           Check if message type is valid
.
            MOVE      ZERO,COUNTR
            WHILE     COUNTR < 26
              ADD       ONE,COUNTR
              LOAD      DIM3,COUNTR,MESTYP01,MESTYP02,MESTYP03,MESTYP04:
                                    MESTYP05,MESTYP08,MESTYP11,MESTYP12:
                                    MESTYP13,MESTYP14,MESTYP21,MESTYP22:
                                    MESTYP27,MESTYP28,MESTYP31,MESTYP34:
                                    MESTYP38,MESTYP44,MESTYM02,MESTYS12:
                                    MESTYS14,MESTYS15,MESTYI12,MESTYI13:
                                    MESTYI14,MESTYP37
.
              MATCH     DIM3,MESSTYPE              * valid message type ?
              GOTO      VIEW0200 IF EQUAL          * yes - continue
            DO
.
            DISPLAY   *P1:24,*EL,*B,"Message type not available.  ";
            CALL      HITENTER
            GOTO      VIEW0000
          ENDIF
.
.         Keyin date
.
VIEW0200  DISPLAY   *P1:24,*EL,"Start Date :"
.
          IF        COPTION <> 1
            MOVE      TWENTY4,CVERT              * set row
            MOVE      TEN4,CCOL                  * set column
            CALL      GDAT0000                   * get starting date
            BRANCH    EXIT,VIEW9999              * nothing input
          ENDIF
.
VIEW0500  IF        COPTION = 1|COPTION = 4
            DISPLAY   *P1:3,*EF,*V2LON,*P13:3,"Created":
                      *ULON,*P1:4,"Item",*P6:4,"   Date   ",*P17:4,"  Time  ":
                      *P26:4,"Type",*P31:4,"System":
                      *P38:4,"     Message Id     ",*P59:4,"U/R Number"
          ELSE
            IF        COPTION = 6
              DISPLAY   *P1:3,*EF,*V2LON,*P12:3,"Created",*P68:3,"Delivered":
                        *ULON,*P1:4,"Itm",*P5:4,"   Date   ",*P16:4,"  Time  ":
                        *P25:4,"Type ",*P31:4," Status  ":
                        *P41:4,"     Message Id     ",*P62:4,"   Date   ":
                        *P73:4,"  Time  "
            ELSE
              DISPLAY   *P1:3,*EF,*V2LON,*P13:3,"Created",*P44:3,"Delivered":
                        *ULON,*P1:4,"Item",*P6:4,"   Date   ",*P17:4,"  Time  ":
                        *P26:4,"Type",*P31:4,"System",*P38:4,"   Date   ":
                        *P49:4,"  Time  ",*P58:4,"     Message Id     "
            ENDIF
          ENDIF
.
          MOVE      ZERO,UPARROW                 * Initialise up arrow flag
          MOVE      ZERO,SELCTION                * Initialise item selection
          MOVE      ONE,CPAGENO                  * Initialise page number
          MOVE      FOUR,CVERT                   * Reset line number
          MOVE      ZERO,FIELD                   * Reset record count
.
.         Position in the table just after the most recent message of that type
.
          LOAD      MESSSTAT,COPTION,ANSW,ANSD,ANSD,ANSR
          BRANCH    COPTION,VIEW0710:            * all waiting
                            VIEW0720:            * all delivered
                            VIEW0730:            * delivered - by message type
                            VIEW0740:            * all rejected
                            VIEW9999:            * message id
                            VIEW0750:            * U/R number
                            VIEW9999:            * delete delivered
                            VIEW9999             * delete all
.
          GOTO      VIEW9999                     * invalid option
.
.         All Waiting
.
VIEW0710  PACK      KEY37,MESSSTAT,SP30,SP10  
          CALL      RSH7CIS2                     * position in file
          GOTO      VIEW1000
.
.         All Delivered
.
VIEW0720  PACK      KEY37,MESSSTAT,STRTDATE,TILDA40  
          CALL      RSH7CIS2                     * position in file
          GOTO      VIEW1000
.
.         Delivered by Message Type
.
VIEW0730  PACK      KEY40,MESSTYPE,MESSSTAT,STRTDATE,TILDA40  
          CALL      RSH7CIS4                     * position in file
          GOTO      VIEW1000
.
.         All Rejected
.
VIEW0740  PACK      KEY37,MESSSTAT,STRTDATE,TILDA40  
          CALL      RSH7CIS2                     * position in file
          GOTO      VIEW1000
.
.         By U/R number
.
VIEW0750  PACK      KEY44,SAVEURNO,STRTDATE,TILDA40  
          CALL      RSH7CIS5                     * position in file
.
VIEW1000  IF        COPTION = 1
            CALL      RKH7CIS2                   * read next record
          ELSE
            IF        COPTION = 3
              CALL      RPH7CIS4                 * read next record
            ELSE
              IF        COPTION = 6
                CALL      RPH7CIS5               * read next record
              ELSE
                CALL      RPH7CIS2               * read next record
              ENDIF
            ENDIF
          ENDIF
          BRANCH    OVRCD,VIEW5000               * end of file
.
          IF        COPTION = 3
            MATCH     MESSTYPE,H7CIMETP          * same message type ?
            GOTO      VIEW5000 IF NOT EQUAL      * no - finished
          ELSE
            MOVE      H7CIMETP,MESSTYPE          * set default message type
          ENDIF
.
.         If by U/R, make sure we still have the same patient, otherwise
.         make sure we still have the same status
.
          IF        COPTION = 6
            MATCH     SAVEURNO,H7CIURNO          * same U/R still ?
          ELSE
            MATCH     MESSSTAT,H7CISTAT          * same message status ?
          ENDIF
          GOTO      VIEW5000 IF NOT EQUAL        * no - finished
.
.         If this is the first page, and no records have been displayed,
.         then set the selction to this first record
.
          IF        CPAGENO = 1 & SELCTION = 0
            MOVE      ONE,SELCTION
          ENDIF
.
          ADD       ONE,CVERT                    * increment line count
.
          COMPARE   TWENTY3,CVERT                * page full ?
          GOTO      VIEW4000 IF NOT LESS         * yes
.
VIEW3000  ADD       ONE,FIELD   
.
          UNPACK    H7CIDTTM,CCENT,CYEAR,CMON,CDAY,DIM8A
          CALL      PACDATE
          MOVE      CPCDATE,DIM10A               * load creation date
          UNPACK    H7CIDDAT,CCENT,CYEAR,CMON,CDAY,DIM8B
          CALL      PACDATE
          MOVE      CPCDATE,DIM10B               * load delivery date
.
.         If this an A31 message, then check if the alternate message id is
.         being used
.
          MOVE      H7CIMETP,DIM3
          MATCH     "A31",H7CIMETP               * A31 message ?
          IF        @EQUAL
            MATCH     SP2,PTCNA31X               * yes - alternate type set ?
            IF        !@EQUAL
              PACK      DIM3,ANSA,PTCNA31X       * yes - load alternate type
            ENDIF
          ENDIF
.
.         If this is an A14 message, then check if we are sending A05 instead
.
          MATCH     "A14",H7CIMETP               * A14 message ?
          IF        @EQUAL
            MATCH     "1",PTCNH7A5               * yes - sending A05 instead ?
            IF        @EQUAL
              MOVE      MESTYP05,DIM3            * yes - load A05
            ENDIF
          ENDIF
.
          MOVE      H7CIMETP,MESSTYPE
          CALL      GDES0000                     * get message system
.
.         Format the display field
.
          IF        COPTION = 1|COPTION = 4
            PACK      RECDDISP[FIELD],FIELD,SP3,DIM10A,SP1:
                      DIM8A,SP2,DIM3,SP2,MESSSYST,SP3,H7CIMESI,SP2,H7CIURNO
          ELSE
            IF        COPTION = 6
              MOVE      H7CISTAT,ANS
              REP       "w1W1r2R2d3D3",ANS
              MOVE      ANS,FORM1
              LOAD      STATDESC,FORM1,STATDESW,STATDESR,STATDESD
.
              MOVE      MESSSYST,ANS
              PACK      RECDDISP[FIELD],FIELD,SP2,DIM10A,SP1:
                        DIM8A,SP1,DIM3,HYPHEN,ANS,SP1,STATDESC,SP1,H7CIMESI:
                        SP1,DIM10B,SP1,DIM8B
            ELSE
              PACK      RECDDISP[FIELD],FIELD,SP3,DIM10A,SP1:
                        DIM8A,SP2,DIM3,SP2,MESSSYST,SP3,DIM10B,SP1,DIM8B:
                        SP1,H7CIMESI
            ENDIF
          ENDIF
.
.         Save current record key and display record
.
          IF        COPTION = 3
            PACK      TEMPKEY2[FIELD],H7CIMETP,H7CISTAT,H7CIDTTM,H7CIMESI
          ELSE
            IF        COPTION = 6
              PACK      TEMPKEY3[FIELD],H7CIURNO,H7CIDTTM,H7CIMESI
            ELSE
              PACK      TEMPKEY1[FIELD],H7CISTAT,H7CIDTTM,H7CIMESI
            ENDIF
          ENDIF
          DISPLAY   *P1:CVERT,*V2LON,RECDDISP[FIELD]
          GOTO      VIEW1000
.
.         new page needed - read first record again as this will be the default
.         current (highlighted) record
.
VIEW4000  IF        COPTION = 3
            PACK      SAVEKEY2,H7CIMETP,H7CISTAT,H7CIDTTM,H7CIMESI
          ELSE
            IF        COPTION = 6
              PACK      SAVEKEY3,H7CIURNO,H7CIDTTM,H7CIMESI
            ELSE
              PACK      SAVEKEY1,H7CISTAT,H7CIDTTM,H7CIMESI
            ENDIF
          ENDIF
          MOVE      ONE,FORM2                    * set first record as current
          CALL      GREC0000                     * record found ?
          BRANCH    EXIT,VIEW9999                * no - shouldn't happen
.
          BRANCH    CPAGENO,VIEW4500             * first page
.
.         in middle pages : Next & First options
.
VIEW4100  MOVE      "1",CALLPOSN                 * set call position
          CALL      KEYA0000                     * keyin response
          BRANCH    EXIT,VIEW9999:               * exit
                         VIEW7000:               * next
                         VIEW8000:               * previous
                         VIEW9000:               * delete
                         VIEW8500:               * view
                         VIEW0500:               * reFresh
                         VIEW9500                * reSet
          GOTO      VIEW6000                     * number entered
.
.         on first page : Next option
.
VIEW4500  MOVE      "2",CALLPOSN                 * set call position
          CALL      KEYA0000                     * keyin response
          BRANCH    EXIT,VIEW9999:               * exit
                         VIEW7000:               * next
                         VIEW5900:               * previous
                         VIEW9000:               * delete
                         VIEW8500:               * view
                         VIEW0500:               * reFresh
                         VIEW9500                * reSet
          GOTO      VIEW6000                     * number entered
.
.         end of data
.
VIEW5000  IF        FIELD > 0
            MOVE      ONE,FORM2                  * set first record as current
            CALL      GREC0000                   * record found ?
            BRANCH    EXIT,VIEW9999              * no - shouldn't happen
          ENDIF
.
          BRANCH    CPAGENO,VIEW5500             * first page
.
.         in middle pages : First option
.
VIEW5100  MOVE      "3",CALLPOSN                 * set call position
          CALL      KEYA0000                     * keyin response
          BRANCH    EXIT,VIEW9999:               * exit
                         VIEW5900:               * next
                         VIEW8000:               * prev
                         VIEW9000:               * delete
                         VIEW8500:               * view
                         VIEW0500:               * reFresh
                         VIEW9500                * reSet
          GOTO      VIEW6000                     * number entered
.
.         on first page : No options
.
VIEW5500  MOVE      "4",CALLPOSN                 * set call position
          CALL      KEYA0000                     * keyin response
          BRANCH    EXIT,VIEW9999:               * exit
                         VIEW5900:               * next
                         VIEW5900:               * previous
                         VIEW9000:               * delete
                         VIEW8500:               * view
                         VIEW0500:               * reFresh
                         VIEW9500                * reSet
          GOTO      VIEW6000                     * number entered
.
VIEW5900  BEEP
VIEW5910  BRANCH    CALLPOSN,VIEW4100,VIEW4500,VIEW5100,VIEW5500
.
.         number entered - read selected record
.
VIEW6000  CALL      GREC0000                     * read selected record
          BRANCH    EXIT,VIEW5910                * error on read
          GOTO      VIEW5910                     * record selection ok
.
.         next screen selected
.
VIEW7000  IF        COPTION = 3
            MOVE      SAVEKEY2,KEY40
            CALL      RDH7CIS4                 * re read 1st record of next page
          ELSE
            IF        COPTION = 6
              MOVE      SAVEKEY3,KEY44
              CALL      RDH7CIS5               * re read 1st record of next page
            ELSE
              MOVE      SAVEKEY1,KEY37
              CALL      RDH7CIS2               * re read 1st record of next page
            ENDIF
          ENDIF
          BRANCH    OVRCD,VIEW0500             * not found - shouldn't happen
.
          MOVE      FIVE,CVERT
          ADD       ONE,CPAGENO
          DISPLAY   *P1:CVERT,*EF
          MOVE      ZERO,FIELD
          MOVE      ONE,SELCTION
          GOTO      VIEW3000
.
.         previous screen selected
.
VIEW8000  IF        COPTION = 3
            MOVE      TEMPKEY2[1],KEY40
            CALL      RDH7CIS4                   * reread first record on screen
          ELSE
            IF        COPTION = 6
              MOVE      TEMPKEY3[1],KEY44
              CALL      RDH7CIS5                 * reread first record on screen
            ELSE
              MOVE      TEMPKEY1[1],KEY37
              CALL      RDH7CIS2                 * reread first record on screen
            ENDIF
          ENDIF
          BRANCH    OVRCD,VIEW0500               * eof
.
          MOVE      ZERO,FORM2                   * initialise count
          WHILE     FORM2 <= 17
            IF        COPTION = 1
              CALL      RPH7CIS2                 * read previous record
            ELSE
              IF        COPTION = 3
                CALL      RKH7CIS4               * read previous record
              ELSE
                IF        COPTION = 6
                  CALL      RKH7CIS5             * read previous record
                ELSE
                  CALL      RKH7CIS2             * read previous record
                ENDIF
              ENDIF
            ENDIF
            BRANCH    OVRCD,VIEW0500             * eof
.
            IF        COPTION = 3
              MATCH     MESSTYPE,H7CIMETP        * same message type ?
              GOTO      VIEW0500 IF NOT EQUAL    * no
            ENDIF
.
            IF        COPTION = 6
              MATCH     SAVEURNO,H7CIURNO        * same U/R number?
            ELSE
              MATCH     MESSSTAT,H7CISTAT        * same message type?
            ENDIF
            GOTO      VIEW0500 IF NOT EQUAL      * no
.
            ADD       ONE,FORM2                  * increment count
          DO
.
          MOVE      FIVE,CVERT                   * reset line position
          SUB       ONE,CPAGENO                  * decrement page number
          MOVE      ZERO,FIELD                   * reset record counter
          MOVE      ONE,SELCTION
          DISPLAY   *P1:CVERT,*EF
          GOTO      VIEW3000
.
.         View the details from the header file (hl7cisaf)
.
VIEW8500  CALL      VINB0000                     * display details of hl7cisaf
          GOTO      VIEW5910
.
.         Delete a message.
.
VIEW9000  CALL      DREC0000
          MOVE      ZERO,DELTFLAG                * set delete flag
.
.         Redisplay the current page
.
VIEW9200  IF        SELCTION = 1
            BRANCH    FIELD,VIEW8000             * no other records on screen
            IF        COPTION = 3
              MOVE      TEMPKEY2[2],KEY40        * first record deleted/reset
            ELSE
              IF        COPTION = 6
                IF        DELTFLAG = 0
                  MOVE      TEMPKEY3[2],KEY44    * first record deleted
                ELSE
                  MOVE      TEMPKEY3[1],KEY44    * first record reset
                ENDIF
              ELSE
                MOVE      TEMPKEY1[2],KEY37      * first record deleted/reset
              ENDIF
            ENDIF
          ELSE
            IF        COPTION = 3
              MOVE      TEMPKEY2[1],KEY40        * first rec not deleted/reset
            ELSE
              IF        COPTION = 6
                MOVE      TEMPKEY3[1],KEY44      * first rec not deleted/reset
              ELSE
                MOVE      TEMPKEY1[1],KEY37      * first rec not deleted/reset
              ENDIF
            ENDIF
          ENDIF
          IF        COPTION = 3
            CALL      RDH7CIS4                   * read first record for page
          ELSE
            IF        COPTION = 6
              CALL      RDH7CIS5                 * read first record for page
            ELSE
              CALL      RDH7CIS2                 * read first record for page
            ENDIF
          ENDIF
          BRANCH    OVRCD,VIEW0500               * not found - shouldn't happen
.
          MOVE      FIVE,CVERT                   * reset page variables
          DISPLAY   *P1:CVERT,*EF
          MOVE      ZERO,FIELD
          MOVE      ONE,SELCTION
          GOTO      VIEW3000                     * redisplay page
.
.         Reset message status according to the current status
.
VIEW9500  CALL      GSET0000                     * status change confirmed ?
          BRANCH    EXIT,VIEW5910                * no - back to prompt
.
          MOVE      ONE,DELTFLAG                 * set delete flag
          GOTO      VIEW9200                     * yes - redisplay page
.
VIEW9999  RETURN
+
.*****************************************************************************
.*                            GSET0000               Called by: GSET0000     *
.*             The reset option has been selected from (V)iew, so            *
.*             get the new status for the selected record                    *
.*   "Waiting" can only be changed to "Rejected" - to stop a message sending *
.*   "Rejected" can only be changed to "Waiting" - to send a skipped message *
.*   "Delivered" can only be changed to "Waiting"- to resend a message       *
.* Returns:    EXIT   0 = Status change confirmed & completed                *
.*                    1 = Status change aborted                              *
.*****************************************************************************
.
GSET0000  IF        COPTION = 6
            MOVE      H7CISTAT,ANS
            REP       "w1W1r2R2d3D3",ANS
            MOVE      ANS,FORM1
            LOAD      STATDESC,FORM1,STATDESR,STATDESW,STATDESW
          ELSE
            LOAD      STATDESC,COPTION,STATDESR,STATDESW,STATDESW,STATDESW
          ENDIF
.
          KEYIN     *P1:24,*EL,"Ok to set status to ",*V2LON,*DV,STATDESC:
                    *HOFF," (",*V2LON,*DV,ANSY,*HOFF,*DV,SLASH,*V2LON:
                    *DV,ANSN,*HOFF,")?":
                    *P38:24,*V2LON,ANS
.
          PACK      ANS,ANS,SP1
          REP       UPPLOW,ANS
.
          MATCH     ANSY,ANS                            * "Y" entered ?
          GOTO      GSET1000 IF EQUAL                   * yes
.
          MATCH     ANSN,ANS
          GOTO      GSET9100 IF EQUAL
.
          BEEP
          GOTO      GSET0000
.
.         Ok to continue with resetting status.
.         First, set the new status.
.
GSET1000  IF        COPTION = 6
            LOAD      ANS,FORM1,ANSR,ANSW,ANSW
          ELSE
            LOAD      ANS,COPTION,ANSR,ANSW,ANSW,ANSW
          ENDIF
.
          IF        COPTION = 3
            UNPACK    TEMPKEY2[SELCTION],DIM20,KEY20
          ELSE
            IF        COPTION = 6
              UNPACK    TEMPKEY3[SELCTION],DIM24,KEY20
            ELSE
              UNPACK    TEMPKEY1[SELCTION],DIM17,KEY20
            ENDIF
          ENDIF
          CALL      RDH7CIS1                     * record found using index 1 ?
          IF        OVRCD = 1
            DISPLAY   *P1:24,*EL,*B,"Message Id ",*V2LON,KEY20,*HOFF:
                      " not found in hl7cisaf(1).  ";
            CALL      HITENTER
            GOTO      GSET9100                   * ignore request
          ENDIF
.
          MOVE      H7CIURNO,PURNO               * save U/R number
.
.         If this is an M02 message, go straight to the update
.
          MATCH     "M02",H7CIMETP               * M02 message ?
          GOTO      GSET7000 IF EQUAL            * yes
.
.         The option we are running will dictate what we need to do.
.         If we are resetting a "Rejected" record to "Waiting" (Option 4),
.         then if the patient's U/R number is on the U/R Holding table,
.         we need to reset all of this patient's rejected messages.
.         For option 1, read the pmsqptaf record to get the U/R number, 
.         otherwise, for options 2-3, just reset the current record.
.
          IF        COPTION = 6
            BRANCH    FORM1,GSET7000:            * by U/R - waiting
                            GSET2000:            * by U/R - rejected
                            GSET7000             * by U/R - delivered
          ENDIF
.
          BRANCH    COPTION,GSET7000:            * waiting messages
                            GSET7000:            * delivered messages
                            GSET7000:            * del. messages by type
                            GSET2000             * rejected messages
.
.         We are changing the status of rejected messages back to waiting,
.         so loop through hl7cisaf rejected records using index 5, so that
.         the messages for the U/R are reset in sequence, from oldest to
.         youngest.
.
GSET2000  PACK      KEY44,PURNO,SP30,SP20
GSET2500  CALL      RSH7CIS5                     * position at start of "R" recs
GSET3000  CALL      RKH7CIS5                     * read next record
          BRANCH    OVRCD,GSET8000               * eof - finished
.
          MATCH     H7CIURNO,PURNO               * same U/R number ?
          GOTO      GSET8000 IF NOT EQUAL        * no - ignore record
.
          MATCH     ANSR,H7CISTAT                * same status still ?
          GOTO      GSET3000 IF NOT EQUAL        * no - finished
.
.         A record for the U/R has been found, so reset the status 
.
          PACK      SAVKEY44,H7CIURNO,H7CIDTTM,H7CIMESI   * save record key
          MOVE      H7CIMESI,KEY20
          CALL      RDH7CIS1                     * read rec. using index 1
          IF        OVRCD = 1
            DISPLAY   *P1:24,*EL,*B,"Message Id ",*V2LON,KEY20,*HOFF:
                      " not found in hl7cisaf(2).  ";
            CALL      HITENTER
            GOTO      GSET9100                   * ignore request
          ENDIF
.
.         Reset record status from "Rejected" to "Waiting"
.
          MOVE      ANSW,H7CISTAT                * load new status
          MOVE      SP20,H7CIDDAT
          CALL      UPH7CIS1                     * update record status
.
          MOVE      SAVKEY44,KEY44               * reload record key
          GOTO      GSET2500                     * get next rejected record
.
.         We are changing from "Waiting" to "Rejected", or "Delivered" to
.         "Waiting", so update the status of the selected record.
.
GSET7000  MOVE      ANS,H7CISTAT                 * load new status
          MOVE      SP20,H7CIDDAT
          CALL      UPH7CIS1                     * update record status
.
          IF        COPTION = 6
            BRANCH    FORM1,GSET7500:            * by U/R - waiting
                            GSET8000:            * by U/R - rejected
                            GSET9000             * by U/R - delivered
          ENDIF
.
          BRANCH    COPTION,GSET7500:            * waiting messages
                            GSET9000:            * delivered messages
                            GSET9000:            * del. messages by type
                            GSET8000             * rejected messages
.
          MATCH     SP8,PURNO                    * yes - blank U/R (M02)?
          GOTO      GSET9000 IF EQUAL            * yes
.
.         We are changing from "Waiting" to "Rejected", so write U/R to the
.         U/R holding table (hl7urhaf) if not already present.
.
GSET7500  MOVE      PURNO,KEY8                   * no
          CALL      RAH7URH1
          IF        OVRCD = 1
            MOVE      PURNO,H7URNUMB
            CALL      WRH7URH1 
          ENDIF
          GOTO      GSET9000
.
.         We have reset a "Rejected" message back to "Waiting", so delete
.         record from U/R Holding table if present
.
GSET8000  MOVE      PURNO,KEY8
          CALL      RAH7URH1
          IF        OVRCD = 0
            MOVE      PURNO,KEY8
            CALL      DEH7URH1
          ENDIF
.
GSET9000  MOVE      ZERO,EXIT
          GOTO      GSET9999
.
GSET9100  MOVE      ONE,EXIT
.
GSET9999  RETURN
+
.*****************************************************************************
.*                            DELA0000               Called by: MAIN0000     *
.*             Delete all holding file records                               *
.*****************************************************************************
.
DELA0000  DISPLAY   *P1:16,*EF,*B,*V2LON,"Warning: all records will be deleted"
.
          CALL      DELQST                       * delete ?
          BRANCH    CEXIT,DELA1000:              * Yes
                          DELA9999:              * No
                          DELA9999               * Cancel
.
.         Process record deletion
.
DELA1000  DISPLAY   *P1:24,*EL,"Deleting: ";
          MOVE      ZERO,COUNTR                  * initialise counter
.
DELA1100  MOVE      SP20,KEY20
          CALL      RSH7CIS1                     * position at start of file
          CALL      RKH7CIS1                     * read next record
          BRANCH    OVRCD,DELA8500               * eof - finished
.
          DISPLAY   *P11:24,*EL,*V2LON,H7CIMESI;
          ADD       ONE,COUNTR                   * increment counter
.
          CALL      DREC0000                     * delete record(s)
          GOTO      DELA1100                     * get next record
.
.         Delete all records on the U/R on hold table (hl7urhaf)
.
DELA8500  MOVE      SP8,KEY8
          CALL      RSH7URH1                     * position in file
          CALL      RKH7URH1                     * read next record
          BRANCH    OVRCD,DELA9000               * eof - finished
.
          MOVE      H7URNUMB,KEY8
          CALL      DEH7URH1                     * delete record
.
          GOTO      DELA8500                     * get next record
.
DELA9000  DISPLAY   *P1:24,*EL,*B,"Completed. ",*V2LON,COUNTR,*HOFF," records":
                    " deleted.  ";
          CALL      HITENTER
.
DELA9999  RETURN
+
.*****************************************************************************
.*                            DELW0000               Called by: MAIN0000     *
.*             Delete all waiting records                                    *
.*****************************************************************************
.
DELW0000  DISPLAY   *P1:16,*EF,*B,*V2LON,"All Waiting records will be deleted"
.
          CALL      DELQST                       * delete ?
          BRANCH    CEXIT,DELW1000:              * Yes
                          DELW9999:              * No
                          DELW9999               * Cancel
.
.         Process record deletion
.
DELW1000  DISPLAY   *P1:24,*EL,"Deleting: ";
          MOVE      ZERO,COUNTR                  * initialise counter
.
DELW1100  PACK      KEY37,ANSW,SP70
          CALL      RSH7CIS2                     * position for waiting records
          CALL      RKH7CIS2                     * read next record
          BRANCH    OVRCD,DELW9000               * eof - finished
.
          MATCH     ANSW,H7CISTAT                * waiting status ?
          GOTO      DELW9000 IF NOT EQUAL        * no - finished
.
          DISPLAY   *P11:24,*EL,*V2LON,H7CIMESI;
          ADD       ONE,COUNTR                   * increment counter
.
          CALL      DREC0000                     * delete record(s)
          GOTO      DELW1100                     * get next record
.
DELW9000  DISPLAY   *P1:24,*EL,*B,"Completed. ",*V2LON,COUNTR,*HOFF," records":
                    " deleted.  ";
          CALL      HITENTER
.
DELW9999  RETURN
+
.*****************************************************************************
.*                            DELD0000               Called by: MAIN0000     *
.*             Delete delivered records prior to a given date                *
.*****************************************************************************
.
DELD0000  DISPLAY   *P1:16,*EF,"Delete Records Prior to :"
          MOVE      TEN6,CVERT                   * set row
          MOVE      TWENTY7,CCOL                 * set column
          CALL      GDAT0000                     * get starting date
          BRANCH    EXIT,DELD9999                * nothing input
.
          CALL      DELQST                       * delete ?
          BRANCH    CEXIT,DELD1000:              * Yes
                          DELD0000:              * No
                          DELD9999               * Cancel
.
.         Process record deletion
.
DELD1000  DISPLAY   *P1:24,*EL,"Deleting: ";
          MOVE      ZERO,COUNTR                  * initialise counter
.
DELD1100  PACK      KEY37,ANSD,STRTDATE,SP30
          CALL      RSH7CIS3                     * position for start date
          CALL      RPH7CIS3                     * read previous record
          BRANCH    OVRCD,DELD9000               * eof - finished
.
          MATCH     ANSD,H7CISTAT                * delivered status ?
          GOTO      DELD9000 IF NOT EQUAL        * no - finished
.
          DISPLAY   *P11:24,*EL,*V2LON,H7CIMESI;
          ADD       ONE,COUNTR                   * increment counter
.
          CALL      DREC0000                     * delete record(s)
          GOTO      DELD1100                     * get next record
.
DELD9000  DISPLAY   *P1:24,*EL,*B,"Completed. ",*V2LON,COUNTR,*HOFF," records":
                    " deleted.  ";
          CALL      HITENTER
.
DELD9999  RETURN
+
.*****************************************************************************
.*                            DREC0000               Called by: VIEW0000     *
.*          Delete the records associated with a single message id           *
.*****************************************************************************
.
DREC0000  MATCH     "A01",H7CIMETP               * admit message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DQVI0000                   * delete ADT detail record
            GOTO      DREC2000
          ENDIF
.
          MATCH     "A02",H7CIMETP               * transfer message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DQVI0000                   * delete ADT detail record
            GOTO      DREC2000
          ENDIF
.
          MATCH     "A03",H7CIMETP               * discharge message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DEMR0000                   * delete EMR detail record
            CALL      DQVI0000                   * delete ADT detail record
            CALL      DALL0000                   * delete ALL detail record
            GOTO      DREC2000
          ENDIF
.
          MATCH     "A04",H7CIMETP               * attend patient message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DEMR0000                   * delete EMR detail record
            CALL      DOUT0000                   * delete O/P detail record
            GOTO      DREC2000
          ENDIF
.
.         A05 could be O/P, W/L booking or I/P Pre-Admission (where A14 is sent
.         as an A05)
.
          MATCH     "A05",H7CIMETP               * patient booking message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DOUT0000                   * delete O/P detail record
.
            CALL      DQVI0000                   * delete ADT detail record
            CALL      DWAT0000                   * delete WAT detail record
            GOTO      DREC2000
          ENDIF
.
.         An A08 is either an ADT (admission update), O/P or W/L message
.         (booking update), or EMR message (visit update).
.         Check all visit tables for deletion.
.
          MATCH     "A08",H7CIMETP               * admission update message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DOUT0000                   * delete O/P detail record
            CALL      DEMR0000                   * delete EMR detail record
            CALL      DQVI0000                   * delete ADT detail record
            CALL      DWAT0000                   * delete WAT detail record
            CALL      DALL0000                   * delete ALL detail record
            GOTO      DREC2000
          ENDIF
.
.         An A11 is either an ADT (cancel admission), O/P message (unattend
.         patient), or EMR message (cancel visit).  Check all visit tables
.         for deletion.
.
          MATCH     "A11",H7CIMETP               * cancel admission message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DOUT0000                   * delete O/P detail record
            CALL      DEMR0000                   * delete EMR detail record
            CALL      DQVI0000                   * delete ADT detail record
            GOTO      DREC2000
          ENDIF
.
          MATCH     "A12",H7CIMETP               * cancel transfer message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DQVI0000                   * delete ADT detail record
            GOTO      DREC2000
          ENDIF
.
          MATCH     "A13",H7CIMETP               * cancel discharge message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DQVI0000                   * delete ADT detail record
            CALL      DALL0000                   * delete ALL detail record
            GOTO      DREC2000
          ENDIF
.
          MATCH     "A14",H7CIMETP               * Pre-admit message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DQVI0000                   * delete ADT detail record
            CALL      DWAT0000                   * delete WAT detail record
            GOTO      DREC2000
          ENDIF
.
          MATCH     "A21",H7CIMETP               * on-leave message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DQVI0000                   * delete ADT detail record
            GOTO      DREC2000
          ENDIF
.
          MATCH     "A22",H7CIMETP               * return from leave message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DQVI0000                   * delete ADT detail record
            GOTO      DREC2000
          ENDIF
.
          MATCH     "A27",H7CIMETP               * cancel pre-admit message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DQVI0000                   * delete ADT detail record
            GOTO      DREC2000
          ENDIF
.
          MATCH     "A28",H7CIMETP               * register message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            GOTO      DREC2000
          ENDIF
.
          MATCH     "A31",H7CIMETP               * update patient message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            GOTO      DREC2000
          ENDIF
.
          MATCH     "A34",H7CIMETP               * merge patient message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            GOTO      DREC2000
          ENDIF
.
          MATCH     "A37",H7CIMETP               * unmerge patient message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            GOTO      DREC2000
          ENDIF
.
.         An A38 is either an O/P or W/L booking cancellation.
.         Check all visit tables for deletion.
.
          MATCH     "A38",H7CIMETP               * cancel booking message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DOUT0000                   * delete O/P detail record
            CALL      DWAT0000                   * delete WAT detail record
            GOTO      DREC2000
          ENDIF
.
.         An A44 is either an ADT (move visit), O/P message (move
.         visit), or Emergency message (move visit).  Try to delete all
.         so that the relevant visit record is found and deleted (only
.         one will exist).
.         Also check for W/L and A/H to delete.
.
          MATCH     "A44",H7CIMETP               * Move visit message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DALL0000                   * delete A/H detail record
            CALL      DWAT0000                   * delete W/L detail record
            CALL      DOUT0000                   * delete O/P detail record
            CALL      DEMR0000                   * delete Emergency det. record
            CALL      DQVI0000                   * delete ADT detail record
            GOTO      DREC2000
          ENDIF
.
          MATCH     "M02",H7CIMETP               * practitioner message ?
          IF        @EQUAL
            CALL      DQDR0000                   * delete HCP detail record
            MOVE      H7CIMESI,KEY20
            CALL      DEH7CIS1                   * delete hl7cisaf record
            GOTO      DREC9999
          ENDIF
.
          MATCH     "S12",H7CIMETP               * add theatre booking message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DOPR0000                   * delete OPR detail record
            MOVE      H7CIMESI,KEY20
            CALL      DEH7CIS1                   * delete hl7cisaf record
            GOTO      DREC9999
          ENDIF
.
          MATCH     "S14",H7CIMETP               * chg.theatre booking message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DOPR0000                   * delete OPR detail record
            MOVE      H7CIMESI,KEY20
            CALL      DEH7CIS1                   * delete hl7cisaf record
            GOTO      DREC9999
          ENDIF
.
          MATCH     "S15",H7CIMETP               * can.theatre booking message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DOPR0000                   * delete OPR detail record
            MOVE      H7CIMESI,KEY20
            CALL      DEH7CIS1                   * delete hl7cisaf record
            GOTO      DREC9999
          ENDIF
.
.         Check for W/L and A/H to delete for I12,I13,I14
.
          MATCH     "I12",H7CIMETP               * patient referral message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DALL0000                   * delete ALL detail record
            CALL      DWAT0000                   * delete W/L detail record
            MOVE      H7CIMESI,KEY20
            CALL      DEH7CIS1                   * delete hl7cisaf record
            GOTO      DREC9999
          ENDIF
.
          MATCH     "I13",H7CIMETP               * modify pt, referral message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DALL0000                   * delete ALL detail record
            CALL      DWAT0000                   * delete W/L detail record
            MOVE      H7CIMESI,KEY20
            CALL      DEH7CIS1                   * delete hl7cisaf record
            GOTO      DREC9999
          ENDIF
.
          MATCH     "I14",H7CIMETP               * cancel pt. referral message ?
          IF        @EQUAL
            CALL      DQPT0000                   * delete PMI detail record
            CALL      DALL0000                   * delete ALL detail record
            CALL      DWAT0000                   * delete W/L detail record
            MOVE      H7CIMESI,KEY20
            CALL      DEH7CIS1                   * delete hl7cisaf record
            GOTO      DREC9999
          ENDIF
.
.         Delete holding header record
.
DREC2000  MOVE      H7CIMESI,KEY20
          CALL      DEH7CIS1                     * delete record
.
.         If this is a "Rejected" record, then check if this patient has their
.         U/R on hold (record in hl7urhaf).  If they do, then check if there are
.         any more rejected records for that patient, and if not, we can delete
.         the on-hold record for the U/R
.
          BRANCH    COPTION,DREC9999:            * View Waiting
                            DREC9999:            * View Delivered
                            DREC9999:            * View Delivered by Type
                            DREC3000:            * View Rejected
                            DREC9999:            * Message Id
                            DREC9999:            * U/R Number
                            DREC9999:            * Delete Deleivered
                            DREC9999:            * Delete All
                            DREC9999:            * reset all rejected messages
                            DREC9999             * delete waiting
.
DREC3000  MOVE      PURNO,KEY8
          CALL      RDH7URH1                     * U/R on hold ?
          BRANCH    OVRCD,DREC9999               * no - finished
.
.         U/R is on hold, so see if there are any more rejected records
.         for this patient
.
          PACK      KEY37,ANSR,SP30,SP10
          CALL      RSH7CIS2                     * position on rejected records
DREC3100  CALL      RKH7CIS2                     * read next record
          BRANCH    OVRCD,DREC3500               * eof - delete record
.
          MATCH     ANSR,H7CISTAT                * rejected record ?
          GOTO      DREC3500 IF NOT EQUAL        * no - delete record
.
          MOVE      H7CIMESI,KEY20
          CALL      RDPMQPT1                     * patient PMI details found ?
          BRANCH    OVRCD,DREC3100               * no - get next record
.
          MATCH     DIM8,PURNO                   * same U/R number ?
          GOTO      DREC9999 IF EQUAL            * yes - finished
.
          GOTO      DREC3100                     * no - get next record
.
.         No other records found for the U/R number, so delete the on-hold
.         table record (hl7urhaf).
.
DREC3500  MOVE      DIM8,KEY8
          CALL      DEH7URH1
.
DREC9999  RETURN
+
.*****************************************************************************
.*                            DALL0000               Called by: DREC0000     *
.*             Delete record from allqueaf                                   *
.*****************************************************************************
.
DALL0000    MOVE      H7CIMESI,KEY20
            CALL      RDALQUE1
            IF        OVRCD = 0
              MOVE      ALQUMESI,KEY20
              CALL      DEALQUE1
            ENDIF
.
DALL9999  RETURN
+
.*****************************************************************************
.*                            DEMR0000               Called by: DREC0000     *
.*             Delete record from emrqueaf                                   *
.*****************************************************************************
.
DEMR0000    MOVE      H7CIMESI,KEY20
            CALL      RDEMQUE1
            IF        OVRCD = 0
              MOVE      EMQUMESI,KEY20
              CALL      DEEMQUE1
            ENDIF
.
DEMR9999  RETURN
+
.*****************************************************************************
.*                            DOPR0000               Called by: DREC0000     *
.*             Delete record from oprqueaf                                   *
.*****************************************************************************
.
DOPR0000    MOVE      H7CIMESI,KEY20
            CALL      RDOPQUE1
            IF        OVRCD = 0
              MOVE      OPQUMESI,KEY20
              CALL      DEOPQUE1
            ENDIF
.
DOPR9999  RETURN
+
.*****************************************************************************
.*                            DOUT0000               Called by: DREC0000     *
.*             Delete record from outqueaf or outrquaf                       *
.*****************************************************************************
.
DOUT0000    MOVE      H7CIMESI,KEY20
            CALL      RDOTQUE1
            IF        OVRCD = 0
              MOVE      OTQUMESG,KEY20
              CALL      DEOTQUE1
            ENDIF
.
            IF        OTCNA05R = 1 | OTCNA08R = 1
              MOVE      H7CIMESI,KEY20
              CALL      RDOTRQU1
              IF        OVRCD = 0
                MOVE      OTRQMESG,KEY20
                CALL      DEOTRQU1
              ENDIF
            ENDIF
.
DOUT9999  RETURN
+
.*****************************************************************************
.*                            DQDR0000               Called by: DREC0000     *
.*             Delete record from pmsqdraf                                   *
.*****************************************************************************
.
DQDR0000    MOVE      H7CIMESI,KEY20
            CALL      RDPMQDR1
            IF        OVRCD = 0
              MOVE      PMQRMESI,KEY20
              CALL      DEPMQDR1
            ENDIF
.
DQDR9999  RETURN
+
.*****************************************************************************
.*                            DQPT0000               Called by: DREC0000     *
.*             Delete record from pmsqptaf                                   *
.*****************************************************************************
.
DQPT0000    MOVE      H7CIMESI,KEY20
            CALL      RDPMQPT1
            IF        OVRCD = 0
              MOVE      PURNO,DIM8               * save U/R number
              MOVE      PMQPMESI,KEY20
              CALL      DEPMQPT1
            ENDIF
.
DQPT9999  RETURN
+
.*****************************************************************************
.*                            DQVI0000               Called by: DREC0000     *
.*             Delete record from pmsqviaf                                   *
.*****************************************************************************
.
DQVI0000    PACK      KEY22,H7CIMESI,SP30
            CALL      RSPMQVI1                   * position on first record
            CALL      RKPMQVI1                   * read next record
            BRANCH    OVRCD,DQVI9999             * eof - finished
.
            COMPARE   H7CIMESI,PMQVMESI          * same message id still ?
            GOTO      DQVI9999 IF NOT EQUAL      * no - finished deleting
.
            PACK      KEY22,PMQVMESI,PMQVTRAN
            CALL      DEPMQVI1                   * delete record
            GOTO      DQVI0000                   * get next record
.
DQVI9999  RETURN
+
.*****************************************************************************
.*                            DWAT0000               Called by: DREC0000     *
.*             Delete record from watqueaf                                   *
.*****************************************************************************
.
DWAT0000    MOVE      H7CIMESI,KEY20
            CALL      RDWTQUE1
            IF        OVRCD = 0
              MOVE      WTQUMESI,KEY20
              CALL      DEWTQUE1
            ENDIF
.
DWAT9999  RETURN
+
.*****************************************************************************
.*                             VINB0000                Called by: VIEW0000   *
.*        Display the details of the holding header file hl7cisaf            *
.*****************************************************************************
.
VINB0000  CALL      GETSCR00                     * save current screen
.
VINB1000  BOX       16,1,3,80,23
          BOXCLR    2,4,79,22
          DISPLAY   *P26:3,*HON," Holding File (hl7cisaf) Details "
.
          MOVE      H7CISTAT,ANS
          REP       "w1W1r2R2d3D3",ANS
          MOVE      ANS,FORM1
          LOAD      STATDESC,FORM1,STATDESW,STATDESR,STATDESD
.
          UNPACK    H7CIDTTM,DATEVAR,TIMEVAR
          UNPACK    DATEVAR,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
.         If this an A31 message, then check if the alternate message id is
.         being used
.
          MOVE      H7CIMETP,DIM3
          MATCH     "A31",H7CIMETP               * A31 message ?
          IF        @EQUAL
            MATCH     SP2,PTCNA31X               * yes - alternate type set ?
            IF        !@EQUAL
              PACK      DIM3,ANSA,PTCNA31X       * yes - load alternate type
            ENDIF
          ENDIF
.
.         If this is an A14 message, then check if we are sending A05 instead
.
          MATCH     "A14",H7CIMETP               * A14 message ?
          IF        @EQUAL
            MATCH     "1",PTCNH7A5               * yes - sending A05 instead ?
            IF        @EQUAL
              MOVE      MESTYP05,DIM3            * yes - load A05
            ENDIF
          ENDIF
.
          MOVE      H7CIMETP,MESSTYPE
          CALL      GDES0000                     * get message description
.
          DISPLAY   *P2:4,"Message Id                : ",*V2LON,H7CIMESI,*HOFF:
                    *P2:5,"Message Status            : ",*V2LON,H7CISTAT,*HOFF:
                    *P41:5,STATDESC:
                    *P2:6,"Message Date              : ",*V2LON,CPCDATE,*HOFF:
                    *P2:7,"Message Time              : ",*V2LON,TIMEVAR,*HOFF:
                    *P2:8,"Message Type              : ",*V2LON,DIM3,*HOFF:
                    *P41:8,MESSDESC:
                    *P2:9,"Operator Id               : ",*V2LON,H7CIOPER,*HOFF:
                    *P2:10,"Port Number               : ",*V2LON,H7CIPORT,*HOFF:
                    *P2:11,"Program Id                : ",*V2LON,H7CIPGID,*HOFF
.
          UNPACK    H7CIDDAT,DATEVAR,TIMEVAR
          UNPACK    DATEVAR,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
.
          MOVE      SP6,ACTNDESC
          MATCH     ANSA,H7CIACTN
          IF        @EQUAL
            MOVE      ACTNDES1,ACTNDESC
          ENDIF
          MATCH     ANSU,H7CIACTN
          IF        @EQUAL
            MOVE      ACTNDES2,ACTNDESC
          ENDIF
.
.         Get the user name
.
          MOVE      "Unknown User",USERDESC
          MATCH     SP10,H7CIUSID
          IF        !@EQUAL
            MOVE      H7CIUSID,KEY10
            CALL      RDWBSE1
            IF        OVRCD = 0
              MOVE      WBSENAM,USERDESC
            ENDIF
          ENDIF
.
.         Get the hospital description
.
          MOVE      "Unknown Hospital",HOSPDESC
          MATCH     SP3,H7CIHOSP
          IF        !@EQUAL
            MOVE      H7CIHOSP,KEY3
            CALL      RDPTHSP1
            IF        OVRCD = 0
              MOVE      PTHSNAME,HOSPDESC
            ENDIF
          ENDIF
.
          DISPLAY   *P2:12,"Delivery Date             : ",*V2LON,CPCDATE,*HOFF:
                    *P2:13,"Delivery Time             : ",*V2LON,TIMEVAR,*HOFF:
                    *P2:14,"U/R Number                : ",*V2LON,H7CIURNO,*HOFF:
                    *P2:15,"Visit Number              : ",*V2LON,H7CIVISN,*HOFF:
                    *P2:16,"Action Flag               : ",*V2LON,ACTNDESC,*HOFF:
                    *P2:17,"Trigger Id                : ",*V2LON,H7CITRID,*HOFF:
                    *P2:18,"Trigger Include           : ",*V2LON,H7CIINCL,*HOFF:
                    *P2:19,"Web User ID               : ",*V2LON,H7CIUSID,*HOFF:
                    *P41:19,USERDESC:
                    *P2:20,"Web Hospital User ID      : ",*V2LON,H7CIHOSP,*HOFF:
                    *P41:20,HOSPDESC:
                    *P2:21,"Receiving Application Tag : ",*V2LON,H7CIRTAG,*HOFF:
                    *P2:22,"Sending Facility Tag      : ",*V2LON,H7CISTAG
.
.         See if the data for the message is PMI Only, PMI & ADT,
.         PMI & O/P, PMI & EMR, PMI & OPR, PMI & ALL or HCP Only
.
          CALL      GTYP0000                     * get the message type
          COMPARE   NINE,DISPFLAG                * error getting message type ?
          GOTO      VINB9000 IF EQUAL            * yes
.
.         Create the temporary word processor file, making sure that if
.         it already exists that it is deleted before being re-created
.
VINB1500  PREP      TEMPFILE,CFNAME              * create the temp file
          CLOSE     TEMPFILE,DELETE              * delete in case left over
          PREP      TEMPFILE,CFNAME              * create the temp file
.
          CALL      KEYB0000                     * get user option
          BRANCH    EXIT,VINB9000:               * exit selected
                         VINB2000:               * ADT Visit selected
                         VINB3000:               * O/P Visit selected
                         VINB4000:               * EMR Visit selected
                         VINB5000:               * OPR Visit selected
                         VINB6000:               * ALL Visit selected
                         VINB6100:               * WAT Visit selected
                         VINB6500:               * HCP Data selected
                         VINB6700                * O/P Maintenance selected
.
.         PMI selected
.
          CALL      LODP0000                     * load PMI details
          BRANCH    EXIT,VINB8000                * data not found - finish
          GOTO      VINB7000
.
.         Visit selected
.
VINB2000  CALL      LODA0000                     * load ADT visit details
          BRANCH    EXIT,VINB8000                * data not found - finish
          GOTO      VINB7000
.
VINB3000  IF        OTCNA05R = 1 | OTCNA08R = 1
            GOTO      VINB3500                   * using O/P referrals
          ENDIF
.
          CALL      LODO0000                     * load O/P visit details
          BRANCH    EXIT,VINB8000                * data not found - finish
          GOTO      VINB7000
.
VINB3500  MOVE      H7CIMESI,KEY20
          CALL      RAOTRQU1
          IF        OVRCD = 0
            CALL      LODR0000                   * load O/P referral details
          ELSE
            CALL      LODO0000                   * load O/P visit details
          ENDIF
          BRANCH    EXIT,VINB8000                * data not found - finish
          GOTO      VINB7000
.
VINB4000  CALL      LODE0000                     * Load EMR visit details
          BRANCH    EXIT,VINB8000                * data not found - finish
          GOTO      VINB7000
.
VINB5000  CALL      LODT0000                     * load theatre booking details
          BRANCH    EXIT,VINB8000                * data not found - finish
          GOTO      VINB7000
.
VINB6000  CALL      LODN0000                     * Load A/H ref. & enc. details
          GOTO      VINB7000
.
VINB6100  CALL      LODW0000                     * Load W/L details
          GOTO      VINB7000
.
VINB6500  CALL      LODD0000                     * Load practitioner details
          BRANCH    EXIT,VINB8000                * data not found - finish
          GOTO      VINB7000
.
VINB6700  CALL      LODM0000                     * Load O/P maintenance details
          BRANCH    EXIT,VINB8000                * data not found - finish
          GOTO      VINB7000
.
VINB7000  CALL      WPRC0000                     * display the word processor
VINB8000  CALL      KTMP0000                     * kill temp file
          GOTO      VINB1500
.
VINB9000  CALL      PUTSCR00                     * restore original view screen
.
VINB9999  RETURN
+
.*****************************************************************************
.*                        KEYB0000                     Called by: VINB0000   *
.*                  Get user to select option                                *
.* Requires:   H7CIMETP - message type                                       *
.*             DISPFLAG -0 = PMI only                                        *
.*                       1 = PMI & ADT                                       *
.*                       2 = PMI & O/P                                       *
.*                       3 = PMI & EMR                                       *
.*                       4 = PMI & OPR                                       *
.*                       5 = PMI & ALL                                       *
.*                       6 = PMI & W/L                                       *
.*                       7 = HCP only                                        *
.*                       8 = O/P Maintenance                                 *
.* Returns:    EXIT  0 = PMI selected                                        *
.*                   1 = exit selected                                       *
.*                   2 = ADT Visit selected                                  *
.*                   3 = O/P Visit selected                                  *
.*                   4 = EMR Visit selected                                  *
.*                   5 = OPR Visit selected                                  *
.*                   6 = ALL Visit selected                                  *
.*                   7 = W/L Visit selected                                  *
.*                   8 = HCP Details selected                                *
.*                   9 = O/P Maintenance                                     *
.*****************************************************************************
.
KEYB0000  DISPLAY   *P1:24,*EL,"e(",*V2LON,ANSX,*HOFF,")it";
          MOVE      SEVEN,CCOL
          IF        DISPFLAG = 7
            DISPLAY   *PCCOL:24,", (",*V2LON,ANSH,*HOFF,")CP Data";
            ADD       TEN2,CCOL
          ELSE
            IF        DISPFLAG = 8
              DISPLAY   *PCCOL:24,", (",*V2LON,ANSO,*HOFF,")P Maintenance Data";
              ADD       TWENTY3,CCOL
            ELSE
              DISPLAY   *PCCOL:24,", (",*V2LON,ANSP,*HOFF,")MI Data";
              ADD       TEN2,CCOL
            ENDIF
          ENDIF
.
          IF        DISPFLAG > 0 & DISPFLAG < 7
            DISPLAY   *PCCOL:24,", (",*V2LON,ANSV,*HOFF,")isit data";
            ADD       TEN4,CCOL
          ENDIF
          ADD       ONE,CCOL
.
          KEYIN     *PCCOL:24,": ",*V2LON,ANS;
.
          PACK      ANS,ANS,SP1
          REP       UPPLOW,ANS
.
          MATCH     ANSX,ANS                     * exit selected ?
          GOTO      KEYB9100 IF EQUAL            * yes
.
          IF        DISPFLAG = 7
            MATCH     ANSH,ANS                   * HCP selected ?
            GOTO      KEYB9800 IF EQUAL          * yes
          ENDIF
.
          IF        DISPFLAG = 8
            MATCH     ANSO,ANS                   * O/P maintenance selected ?
            GOTO      KEYB9900 IF EQUAL          * yes
          ENDIF
.
          IF        DISPFLAG < 7
            MATCH     ANSP,ANS                   * PMI selected ?
            GOTO      KEYB9000 IF EQUAL          * yes
          ENDIF
.
          IF        DISPFLAG > 0 & DISPFLAG < 7
            MATCH     ANSV,ANS                   * visit selected ?
            IF        @EQUAL
              BRANCH    DISPFLAG,KEYB9200:       * ADT visit
                                 KEYB9300:       * O/P visit
                                 KEYB9400:       * EMR visit
                                 KEYB9500:       * OPR visit
                                 KEYB9600:       * ALL visit
                                 KEYB9700        * W/L visit
            ENDIF
          ENDIF
.
          BEEP                                   * invalid input
          GOTO      KEYB0000
.
KEYB9000  MOVE      ZERO,EXIT                    * PMI selected
          GOTO      KEYB9999
.
KEYB9100  MOVE      ONE,EXIT                     * exit selected
          GOTO      KEYB9999
.
KEYB9200  MOVE      TWO,EXIT                     * ADT Visit selected
          GOTO      KEYB9999
.
KEYB9300  MOVE      THREE,EXIT                   * O/P Visit selected
          GOTO      KEYB9999
.
KEYB9400  MOVE      FOUR,EXIT                    * EMR visit selected
          GOTO      KEYB9999
.
KEYB9500  MOVE      FIVE,EXIT                    * OPR visit selected
          GOTO      KEYB9999
.
KEYB9600  MOVE      SIX,EXIT                     * ALL visit selected
          GOTO      KEYB9999
.
KEYB9700  MOVE      SEVEN,EXIT                   * W/L visit selected
          GOTO      KEYB9999
.
KEYB9800  MOVE      EIGHT,EXIT                   * HCP details selected
          GOTO      KEYB9999
.
KEYB9900  MOVE      NINE,EXIT                    * O/P maintenance selected
.
KEYB9999  RETURN
+
.*****************************************************************************
.*                        GTYP0000                     Called by: VINB0000   *
.*             See if the message is PMI only or ADT or O/P or EMR           *
.* Requires:   H7CIMETP - message type                                       *
.* Returns:    DISPFLAG 0 = PMI only                                         *
.*                      1 = PMI & ADT                                        *
.*                      2 = PMI & O/P                                        *
.*                      3 = PMI & EMR                                        *
.*                      4 = PMI & OPR                                        *
.*                      5 = PMI & ALL                                        *
.*                      6 = PMI & W/L                                        *
.*                      7 = HCP only                                         *
.*                      8 = O/P Clinic Master/Clinic Type only               *
.*                      9 = Error - Visit details record not found/Unk.Messg *
.*****************************************************************************
.
.         See if message is PMI only
.
GTYP0000  MATCH     "A28",H7CIMETP               * Register patient message ?
          GOTO      GTYP9000 IF EQUAL            * yes
.
          MATCH     "A31",H7CIMETP               * Update patient message ?
          GOTO      GTYP9000 IF EQUAL            * yes
.
          MATCH     "A34",H7CIMETP               * Merge patient message ?
          GOTO      GTYP9000 IF EQUAL            * yes
.
          MATCH     "A37",H7CIMETP               * UnMerge patient message ?
          GOTO      GTYP9000 IF EQUAL            * yes
.
          MATCH     "A02",H7CIMETP               * transfer ?
          GOTO      GTYP0050 IF NOT EQUAL        * no
.
          PACK      KEY22,H7CIMESI,SP1,ONE
          CALL      RAPMQVI1
          IF        OVRCD = 0
            GOTO      GTYP9100                   * I/P transfer message
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAWTQUE1                     * W/L Transfer message ?
          IF        OVRCD = 0
            GOTO      GTYP9600                   * yes
          ENDIF
          GOTO      GTYP9900                     * error
.
.         There are visit details included in the message, so check if ADT, O/P
.         or EMR
.
GTYP0050  MATCH     "A03",H7CIMETP               * discharge ?
          GOTO      GTYP0100 IF NOT EQUAL        * no
.
          MOVE      H7CIMESI,KEY20
          CALL      RAEMQUE1
          IF        OVRCD = 0
            GOTO      GTYP9300                   * EMR discharge message
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQUE1
          IF        OVRCD = 0
            GOTO      GTYP9200                   * O/P discharge message
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAALQUE1
          IF        OVRCD = 0
            GOTO      GTYP9500                   * A/H encounter message
          ENDIF
.
          PACK      KEY22,H7CIMESI,SP1,ONE
          CALL      RAPMQVI1
          IF        OVRCD = 0
            GOTO      GTYP9100                   * I/P discharge message
          ENDIF
          GOTO      GTYP9900                     * error
.
GTYP0100  MATCH     "A04",H7CIMETP               * attend ?
          GOTO      GTYP0200 IF NOT EQUAL        * no
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQUE1
          IF        OVRCD = 0
            GOTO      GTYP9200                   * O/P attend patient message
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAEMQUE1
          IF        OVRCD = 0
            GOTO      GTYP9300                   * EMR register patient message
          ENDIF
          GOTO      GTYP9900                     * error
.
GTYP0200  MATCH     "A05",H7CIMETP               * Patient booking message ?
          GOTO      GTYP0300 IF NOT EQUAL        * no
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQUE1                     * O/P message ?
          IF        OVRCD = 0
            GOTO      GTYP9200                   * yes
          ENDIF
.
          IF        OTCNA05R = 1
            MOVE      H7CIMESI,KEY20
            CALL      RAOTRQU1                   * O/P Referral message ?
            IF        OVRCD = 0
              GOTO      GTYP9200                 * yes
            ENDIF
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAWTQUE1                     * W/L Booking message ?
          IF        OVRCD = 0
            GOTO      GTYP9600                   * yes
          ENDIF
          GOTO      GTYP9900                     * error
.
GTYP0300  MATCH     "A08",H7CIMETP               * update message ?
          GOTO      GTYP0400 IF NOT EQUAL        * no
.
          MOVE      H7CIMESI,KEY20
          CALL      RAEMQUE1                     * EMR message ?
          IF        OVRCD = 0
            GOTO      GTYP9300                   * yes
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQUE1                     * O/P message ?
          IF        OVRCD = 0
            GOTO      GTYP9200                   * yes
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAALQUE1                     * A/H message ?
          IF        OVRCD = 0
            GOTO      GTYP9500                   * yes
          ENDIF
.
          IF        OTCNA08R = 1
            MOVE      H7CIMESI,KEY20
            CALL      RAOTRQU1                   * O/P Referral message ?
            IF        OVRCD = 0
              GOTO      GTYP9200                 * yes
            ENDIF
          ENDIF
.
          PACK      KEY22,H7CIMESI,SP1,ONE
          CALL      RAPMQVI1                     * ADT update ?
          IF        OVRCD = 0
            GOTO      GTYP9100                   * yes
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAWTQUE1                     * W/L Booking message ?
          IF        OVRCD = 0
            GOTO      GTYP9600                   * yes
          ENDIF
.
          GOTO      GTYP9900                     * error
.
GTYP0400  MATCH     "A11",H7CIMETP               * Cancel message ?
          GOTO      GTYP0500 IF NOT EQUAL        * no
.
          MOVE      H7CIMESI,KEY20               * yes
          CALL      RAOTQUE1
          IF        OVRCD = 0
            GOTO      GTYP9200                   * O/P unattend message
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAEMQUE1
          IF        OVRCD = 0
            GOTO      GTYP9300                   * EMR cancel visit message
          ENDIF
.
          PACK      KEY22,H7CIMESI,SP1,ONE
          CALL      RAPMQVI1
          IF        OVRCD = 0
            GOTO      GTYP9100                   * I/P cancel admission message
          ENDIF
          GOTO      GTYP9900                     * error
.
GTYP0500  MATCH     "A12",H7CIMETP               * I/P cancel transfer ?
          GOTO      GTYP9100 IF EQUAL            * yes
.
          MATCH     "A13",H7CIMETP               * Cancel discharge message ?
          GOTO      GTYP0600 IF NOT EQUAL        * no
.
          MOVE      H7CIMESI,KEY20               * yes
          CALL      RAEMQUE1
          IF        OVRCD = 0
            GOTO      GTYP9300                   * EMR cancel discharge message
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQUE1
          IF        OVRCD = 0
            GOTO      GTYP9200                   * O/P cancel discharge message
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAALQUE1
          IF        OVRCD = 0
            GOTO      GTYP9500                   * A/H cancel encounter message
          ENDIF
.
          PACK      KEY22,H7CIMESI,SP1,ONE
          CALL      RAPMQVI1
          IF        OVRCD = 0
            GOTO      GTYP9100                   * ADT cancel discharge
          ENDIF
          GOTO      GTYP9900                     * error
.
GTYP0600  MATCH     "A14",H7CIMETP               * I/P Pre-admit ?
          GOTO      GTYP9100 IF EQUAL            * yes
.
          MATCH     "A21",H7CIMETP               * I/P On-leave ?
          GOTO      GTYP9100 IF EQUAL            * yes
.
          MATCH     "A22",H7CIMETP               * I/P return from leave ?
          GOTO      GTYP9100 IF EQUAL            * yes
.
          MATCH     "A27",H7CIMETP               * I/P cancel pre-admit ?
          GOTO      GTYP9100 IF EQUAL            * yes
.
          MATCH     "A38",H7CIMETP               * Cancel booking message ?
          GOTO      GTYP0700 IF NOT EQUAL        * no
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQUE1
          IF        OVRCD = 0
            GOTO      GTYP9200                   * O/P Cancel Booking message
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAWTQUE1
          IF        OVRCD = 0
            GOTO      GTYP9600                   * W/L Cancel Booking message
          ENDIF
          GOTO      GTYP9900                     * error
.
.         A move visit message (A44) is triggered from PATWEB83 for ADT, O/P
.         and Emergency, so check which visit holding record exists
.
GTYP0700  MATCH     "A44",H7CIMETP               * Move visit message ?
          GOTO      GTYP0800 IF NOT EQUAL        * no
.
          MOVE      H7CIMESI,KEY20               * yes
          CALL      RAALQUE1
          IF        OVRCD = 0
            GOTO      GTYP9500                   * A/H Move visit message
          ENDIF
.
          MOVE      H7CIMESI,KEY20               * yes
          CALL      RAWTQUE1
          IF        OVRCD = 0
            GOTO      GTYP9600                   * W/L Move visit message
          ENDIF
.
          MOVE      H7CIMESI,KEY20               * yes
          CALL      RAOTQUE1
          IF        OVRCD = 0
            GOTO      GTYP9200                   * O/P Move visit message
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAEMQUE1
          IF        OVRCD = 0
            GOTO      GTYP9300                   * Emergency Move visit message
          ENDIF
.
          PACK      KEY22,H7CIMESI,SP1,ONE
          CALL      RAPMQVI1
          IF        OVRCD = 0
            GOTO      GTYP9100                   * ADT Move visit
          ENDIF
          GOTO      GTYP9900                     * error
.
GTYP0800  MATCH     "M01",H7CIMETP               * O/P maintenance message ?
          GOTO      GTYP0900 IF NOT EQUAL        * no
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQMA1
          IF        OVRCD = 0
            GOTO      GTYP9800                   * Clinic master
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQTY1
          IF        OVRCD = 0
            GOTO      GTYP9800                   * Clinic type
          ENDIF
          GOTO      GTYP9900                     * error
.
GTYP0900  MATCH     "M02",H7CIMETP               * HCP message ?
          GOTO      GTYP9700 IF EQUAL            * yes
.
          MATCH     "S12",H7CIMETP               * S12 message ?
          GOTO      GTYP9400 IF EQUAL            * yes
.
          MATCH     "S14",H7CIMETP               * S14 message ?
          GOTO      GTYP9400 IF EQUAL            * yes
.
          MATCH     "S15",H7CIMETP               * S15 message ?
          GOTO      GTYP9400 IF EQUAL            * yes
.
          MATCH     "I12",H7CIMETP               * I12 message ?
          GOTO      GTYP1000 IF NOT EQUAL        * no
.
          MOVE      H7CIMESI,KEY20
          CALL      RAALQUE1
          IF        OVRCD = 0
            GOTO      GTYP9500                   * A/H Add Referral
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAWTQUE1
          IF        OVRCD = 0
            GOTO      GTYP9600                   * W/L Add Entry
          ENDIF
          GOTO      GTYP9900                     * error
.
GTYP1000  MATCH     "I13",H7CIMETP               * I13 message ?
          GOTO      GTYP1100 IF NOT EQUAL        * no
.
          MOVE      H7CIMESI,KEY20
          CALL      RAALQUE1
          IF        OVRCD = 0
            GOTO      GTYP9500                   * A/H Modify Referral
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAWTQUE1
          IF        OVRCD = 0
            GOTO      GTYP9600                   * W/L Update Entry
          ENDIF
          GOTO      GTYP9900                     * error
.
GTYP1100  MATCH     "I14",H7CIMETP               * I14 message ?
          GOTO      GTYP9100 IF NOT EQUAL        * no, must be PMI & ADT
.
          MOVE      H7CIMESI,KEY20
          CALL      RAALQUE1
          IF        OVRCD = 0
            GOTO      GTYP9500                   * A/H Cancel Referral
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAWTQUE1
          IF        OVRCD = 0
            GOTO      GTYP9600                   * W/L Remove Entry
          ENDIF
          GOTO      GTYP9900                     * error
.
GTYP9000  MOVE      ZERO,DISPFLAG                * set flag for PMI only
          GOTO      GTYP9999
.
GTYP9100  MOVE      ONE,DISPFLAG                 * PMI & ADT
          GOTO      GTYP9999
.
GTYP9200  MOVE      TWO,DISPFLAG                 * PMI & O/P
          GOTO      GTYP9999
.
GTYP9300  MOVE      THREE,DISPFLAG               * PMI & EMR
          GOTO      GTYP9999
.
GTYP9400  MOVE      FOUR,DISPFLAG                * PMI & OPR
          GOTO      GTYP9999
.
GTYP9500  MOVE      FIVE,DISPFLAG                * PMI & ALL
          GOTO      GTYP9999
.
GTYP9600  MOVE      SIX,DISPFLAG                 * PMI & W/L
          GOTO      GTYP9999
.
GTYP9700  MOVE      SEVEN,DISPFLAG               * HCP Only
          GOTO      GTYP9999
.
GTYP9800  MOVE      EIGHT,DISPFLAG               * O/P Maintenance Only
          GOTO      GTYP9999
.
GTYP9900  DISPLAY   *P1:24,*EL,*B,"Visit type not found.  ";
          CALL      HITENTER
          MOVE      NINE,DISPFLAG
          GOTO      GTYP9999
.
GTYP9950  DISPLAY   *P1:24,*EL,*B,"Unknown Message Type.  ";
          CALL      HITENTER
          MOVE      NINE,DISPFLAG
.
GTYP9999  RETURN
+
.*****************************************************************************
.*                        GDES0000                     Called by: VINB0000   *
.*                   Get the message description                             *
.* Requires:  MESSTYPE    - 3 character message type                         *
.* Returns:   MESSDESC    - Message description                              *
.*            MESSSYST    - 3 character system identifier                    *
.*                              PMI - PMI                                    *
.*                              INP - Inpatient                              *
.*                              OUT - Outpatient                             *
.*                              EMR - Emergency                              *
.*                              MAS - Master File                            *
.*                              ORF - O/P Referrals                          *
.*                              ALL - Allied Health Referrals                *
.*                              W/L - W/L Bookings                           *
.*****************************************************************************
.
GDES0000  MOVE      SP30,MESSDESC
          MOVE      SP3,MESSSYST
.
.         Admit (ADT)
.
          MATCH     "A01",MESSTYPE
          IF        @EQUAL
            MOVE      MESSAA01,MESSDESC
            MOVE      "INP",MESSSYST
            GOTO      GDES9999
          ENDIF
.
.         Transfer (ADT)
.
          MATCH     "A02",MESSTYPE
          GOTO      GDES0050 IF NOT EQUAL
.
          PACK      KEY22,H7CIMESI,SP1,ONE
          CALL      RAPMQVI1
          IF        OVRCD = 0
            MOVE      MESSAA02,MESSDESC
            MOVE      "INP",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAWTQUE1
          IF        OVRCD = 0
            MOVE      MESSWA02,MESSDESC
            MOVE      "W/L",MESSSYST
            GOTO      GDES9999
          ENDIF
          GOTO      GDES9100
.
.         Discharge (ADT, ALL and EMR)
.
GDES0050  MATCH     "A03",MESSTYPE
          GOTO      GDES0100 IF NOT EQUAL
.
          MOVE      H7CIMESI,KEY20
          CALL      RAEMQUE1
          IF        OVRCD = 0
            MOVE      MESSEA03,MESSDESC
            MOVE      "EMR",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQUE1
          IF        OVRCD = 0
            MOVE      MESSOA03,MESSDESC
            MOVE      "OUT",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAALQUE1
          IF        OVRCD = 0
            MOVE      MESSLA03,MESSDESC
            MOVE      "ALL",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          PACK      KEY22,H7CIMESI,SP1,ONE
          CALL      RAPMQVI1
          IF        OVRCD = 0
            MOVE      MESSAA03,MESSDESC
            MOVE      "INP",MESSSYST
            GOTO      GDES9999
          ENDIF
          GOTO      GDES9100
.
.         Attend Patient (O/P) and Register Patient (EMR)
.
GDES0100  MATCH     "A04",MESSTYPE
          GOTO      GDES0200 IF NOT EQUAL
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQUE1
          IF        OVRCD = 0
            MOVE      MESSOA04,MESSDESC
            MOVE      "OUT",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAEMQUE1
          IF        OVRCD = 0
            MOVE      MESSEA04,MESSDESC
            MOVE      "EMR",MESSSYST
            GOTO      GDES9999
          ENDIF
          GOTO      GDES9100
.
.         Patient Booking (O/P or W/L) or New Referral
.
GDES0200  MATCH     "A05",MESSTYPE
          GOTO      GDES0300 IF NOT EQUAL
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQUE1
          IF        OVRCD = 0
            MOVE      MESSOA05,MESSDESC
            MOVE      "OUT",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          IF        OTCNA05R = 1
            MOVE      H7CIMESI,KEY20
            CALL      RDOTRQU1
            IF        OVRCD = 0
              MOVE      MESSRA05,MESSDESC
              MOVE      "ORF",MESSSYST
              GOTO      GDES9999
            ENDIF
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAWTQUE1
          IF        OVRCD = 0
            MOVE      MESSWA05,MESSDESC
            MOVE      "W/L",MESSSYST
            GOTO      GDES9999
          ENDIF
          GOTO      GDES9100
.
.         An A08 is either an ADT (admission update), O/P message (booking
.         update or referral update), or EMR message (Visit update) or W/L
.         message (booking update).
.         Check which visit table is populated to determine which description
.         to load
.
GDES0300  MATCH     "A08",MESSTYPE
          GOTO      GDES0400 IF NOT EQUAL
.
          MOVE      H7CIMESI,KEY20
          CALL      RAEMQUE1
          IF        OVRCD = 0
            MOVE      MESSEA08,MESSDESC
            MOVE      "EMR",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQUE1
          IF        OVRCD = 0
            MOVE      MESSOA08,MESSDESC
            MOVE      "OUT",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RDALQUE1
          IF        OVRCD = 0
            MOVE      MESSLA08,MESSDESC
            MOVE      "ALL",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          IF        OTCNA08R = 1
            MOVE      H7CIMESI,KEY20
            CALL      RDOTRQU1
            IF        OVRCD = 0
              MOVE      MESSRA08,MESSDESC
              MOVE      "ORF",MESSSYST
              GOTO      GDES9999
            ENDIF
          ENDIF
.
          PACK      KEY22,H7CIMESI,SP1,ONE
          CALL      RAPMQVI1
          IF        OVRCD = 0
            MOVE      MESSAA08,MESSDESC
            MOVE      "INP",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAWTQUE1
          IF        OVRCD = 0
            MOVE      MESSWA08,MESSDESC
            MOVE      "W/L",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          GOTO      GDES9100
.
.         An A11 is either an ADT (cancel admission), O/P message (unattend
.         patient), or EMR message (cancel visit).  Check which visit table
.         is populated to determine which description to load
.
GDES0400  MATCH     "A11",MESSTYPE
          GOTO      GDES0500 IF NOT EQUAL
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQUE1
          IF        OVRCD = 0
            MOVE      MESSOA11,MESSDESC
            MOVE      "OUT",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAEMQUE1
          IF        OVRCD = 0
            MOVE      MESSEA11,MESSDESC
            MOVE      "EMR",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          PACK      KEY22,H7CIMESI,SP1,ONE
          CALL      RAPMQVI1
          IF        OVRCD = 0
            MOVE      MESSAA11,MESSDESC
            MOVE      "INP",MESSSYST
            GOTO      GDES9999
          ENDIF
          GOTO      GDES9100
.
.         Cancel Transfer (ADT)
.
GDES0500  MATCH     "A12",MESSTYPE
          IF        @EQUAL
            MOVE      MESSAA12,MESSDESC
            MOVE      "INP",MESSSYST
            GOTO      GDES9999
          ENDIF
.
.         Cancel Discharge (ADT & EMR)
.
          MATCH     "A13",MESSTYPE
          GOTO      GDES0600 IF NOT EQUAL
.
          MOVE      H7CIMESI,KEY20
          CALL      RAEMQUE1
          IF        OVRCD = 0
            MOVE      MESSEA13,MESSDESC
            MOVE      "EMR",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQUE1
          IF        OVRCD = 0
            MOVE      MESSOA13,MESSDESC
            MOVE      "OUT",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAALQUE1
          IF        OVRCD = 0
            MOVE      MESSLA13,MESSDESC
            MOVE      "ALL",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          PACK      KEY22,H7CIMESI,SP1,ONE
          CALL      RAPMQVI1
          IF        OVRCD = 0
            MOVE      MESSAA13,MESSDESC
            MOVE      "INP",MESSSYST
            GOTO      GDES9999
.
          ENDIF
          GOTO      GDES9100
.
.         Pre-admit (ADT)
.
GDES0600  MATCH     "A14",MESSTYPE
          IF        @EQUAL
            MOVE      MESSAA14,MESSDESC
            MOVE      "INP",MESSSYST
            GOTO      GDES9999
          ENDIF
.
.         On-Leave (ADT)
.
          MATCH     "A21",MESSTYPE
          IF        @EQUAL
            MOVE      MESSAA21,MESSDESC
            MOVE      "INP",MESSSYST
            GOTO      GDES9999
          ENDIF
.
.         Return from Leave (ADT)
.
          MATCH     "A22",MESSTYPE
          IF        @EQUAL
            MOVE      MESSAA22,MESSDESC
            MOVE      "INP",MESSSYST
            GOTO      GDES9999
          ENDIF
.
.         Cncel Pre-admit (ADT)
.
          MATCH     "A27",MESSTYPE
          IF        @EQUAL
            MOVE      MESSAA27,MESSDESC
            MOVE      "INP",MESSSYST
            GOTO      GDES9999
          ENDIF
.
.         Register Patient (PMI)
.
          MATCH     "A28",MESSTYPE
          IF        @EQUAL
            MOVE      MESSPA28,MESSDESC
            MOVE      "PMI",MESSSYST
            GOTO      GDES9999
          ENDIF
.
.         Update Patient (PMI)
.
          MATCH     "A31",MESSTYPE
          IF        @EQUAL
            MOVE      MESSPA31,MESSDESC
            MOVE      "PMI",MESSSYST
            GOTO      GDES9999
          ENDIF
.
.         Merge Patient (PMI)
.
          MATCH     "A34",MESSTYPE
          IF        @EQUAL
            MOVE      MESSPA34,MESSDESC
            MOVE      "PMI",MESSSYST
            GOTO      GDES9999
          ENDIF
.
.         UnMerge Patient (PMI)
.
          MATCH     "A37",MESSTYPE
          IF        @EQUAL
            MOVE      MESSPA37,MESSDESC
            MOVE      "PMI",MESSSYST
            GOTO      GDES9999
          ENDIF
.
.         Cancel Booking (O/P or W/L)
.
          MATCH     "A38",MESSTYPE
          GOTO      GDES0700 IF NOT EQUAL
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQUE1
          IF        OVRCD = 0
            MOVE      MESSOA38,MESSDESC
            MOVE      "OUT",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAWTQUE1
          IF        OVRCD = 0
            MOVE      MESSWA38,MESSDESC
            MOVE      "W/L",MESSSYST
            GOTO      GDES9999
          ENDIF
          GOTO      GDES9100
.
.         An A44 is either an ADT (move visit), O/P message (move
.         visit), or EMR message (move visit).  Check which visit table
.         is populated to determine which description to load
.
GDES0700  MATCH     "A44",MESSTYPE
          GOTO      GDES0800 IF NOT EQUAL
.
          MOVE      H7CIMESI,KEY20
          CALL      RAALQUE1
          IF        OVRCD = 0
            MOVE      MESSLA44,MESSDESC
            MOVE      "A/H",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAWTQUE1
          IF        OVRCD = 0
            MOVE      MESSWA44,MESSDESC
            MOVE      "W/L",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQUE1
          IF        OVRCD = 0
            MOVE      MESSOA44,MESSDESC
            MOVE      "OUT",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAEMQUE1
          IF        OVRCD = 0
            MOVE      MESSEA44,MESSDESC
            MOVE      "EMR",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          PACK      KEY22,H7CIMESI,SP1,ONE
          CALL      RAPMQVI1
          IF        OVRCD = 0
            MOVE      MESSAA44,MESSDESC
            MOVE      "INP",MESSSYST
            GOTO      GDES9999
          ENDIF
          GOTO      GDES9100
.
.         Add Theatre Booking
.
GDES0800  MATCH     "S12",MESSTYPE
          IF        @EQUAL
            MOVE      MESSTS12,MESSDESC
            MOVE      "OPR",MESSSYST
            GOTO      GDES9999
          ENDIF
.
.         Change Theatre Booking
.
          MATCH     "S14",MESSTYPE
          IF        @EQUAL
            MOVE      MESSTS14,MESSDESC
            MOVE      "OPR",MESSSYST
            GOTO      GDES9999
          ENDIF
.
.         Cancel Theatre Booking
.
          MATCH     "S15",MESSTYPE
          IF        @EQUAL
            MOVE      MESSTS15,MESSDESC
            MOVE      "OPR",MESSSYST
            GOTO      GDES9999
          ENDIF
.
.         Patient Referral or W/L Add
.
          MATCH     "I12",MESSTYPE
          GOTO      GDES0900 IF NOT EQUAL
.
          MOVE      H7CIMESI,KEY20
          CALL      RAALQUE1
          IF        OVRCD = 0
            MOVE      MESSLI12,MESSDESC
            MOVE      "ALL",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAWTQUE1
          IF        OVRCD = 0
            MOVE      MESSWI12,MESSDESC
            MOVE      "W/L",MESSSYST
            GOTO      GDES9999
          ENDIF
          GOTO      GDES9100
.
.         Modify Patient Referral or W/L update
.
GDES0900  MATCH     "I13",MESSTYPE
          GOTO      GDES1000 IF NOT EQUAL
.
          MOVE      H7CIMESI,KEY20
          CALL      RAALQUE1
          IF        OVRCD = 0
            MOVE      MESSLI13,MESSDESC
            MOVE      "ALL",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAWTQUE1
          IF        OVRCD = 0
            MOVE      MESSWI13,MESSDESC
            MOVE      "W/L",MESSSYST
            GOTO      GDES9999
          ENDIF
          GOTO      GDES9100
.
.         Cancel Patient Referral or W/L Remove
.
GDES1000  MATCH     "I14",MESSTYPE
          GOTO      GDES1100 IF NOT EQUAL
.
          MOVE      H7CIMESI,KEY20
          CALL      RAALQUE1
          IF        OVRCD = 0
            MOVE      MESSLI14,MESSDESC
            MOVE      "ALL",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAWTQUE1
          IF        OVRCD = 0
            MOVE      MESSWI14,MESSDESC
            MOVE      "W/L",MESSSYST
            GOTO      GDES9999
          ENDIF
          GOTO      GDES9100
.
.         Master File - HCP
.
GDES1100  MATCH     "M02",MESSTYPE
          IF        @EQUAL
            MOVE      MESSPM02,MESSDESC
            MOVE      "MAS",MESSSYST
            GOTO      GDES9999
          ENDIF
.
.         Master File - Outpatient Clinic Master/Type
.
          MATCH     "M01",MESSTYPE
          GOTO      GDES9100 IF NOT EQUAL
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQMA1
          IF        OVRCD = 0
            MOVE      ZERO,OPMNFLAG
            MOVE      MESSMM01,MESSDESC
            MOVE      "MAS",MESSSYST
            GOTO      GDES9999
          ENDIF
.
          MOVE      H7CIMESI,KEY20
          CALL      RAOTQTY1
          IF        OVRCD = 0
            MOVE      ONE,OPMNFLAG
            MOVE      MESSTM01,MESSDESC
            MOVE      "MAS",MESSSYST
            GOTO      GDES9999
          ENDIF
.
GDES9100  MOVE      "Unknown Message Type       ",MESSDESC
          MOVE      "UNK",MESSSYST
.
GDES9999  RETURN
+
.*****************************************************************************
.*                        GREC0000                     Called by: KEYA0000   *
.*                   Get the selected record                      VIEW0000   *
.* Requires:  SELCTION - Item number selected                                *
.* Returns:   EXIT  - 0 = record found                                       *
.*                    1 = error reading record                               *
.*****************************************************************************
.
.         If the up arrow is set, then the up arrow key was pressed while the
.         first record on the current screen was selected.  We now have to
.         redisplay the previous screen, and select (highlight) the last record
.
GREC0000  IF        UPARROW = 1
            MOVE      FIELD,FORM2                * set last record as selected
            MOVE      ZERO,UPARROW               * turn off up arrow flag
          ENDIF
.
          ASSIGN    (SELCTION+4),EVERT
          DISPLAY   *P1:EVERT,*V2LON,RECDDISP[SELCTION]
          ASSIGN    (FORM2+4),EVERT
          DISPLAY   *P1:EVERT,*HON,RECDDISP[FORM2]
          MOVE      FORM2,SELCTION
.
          IF        COPTION = 3
            MOVE      TEMPKEY2[SELCTION],KEY40
            CALL      RDH7CIS4                   * reread first record on screen
          ELSE
            IF        COPTION = 6
              MOVE      TEMPKEY3[SELCTION],KEY44
              CALL      RDH7CIS5                 * reread first record on screen
            ELSE
              MOVE      TEMPKEY1[SELCTION],KEY37
              CALL      RDH7CIS2                 * reread first record on screen
            ENDIF
          ENDIF
          BRANCH    OVRCD,GREC9100               * not found - shouldn't happen
.
          MOVE      ZERO,EXIT
          GOTO      GREC9999
.
GREC9100  DISPLAY   *P1:24,*EL,*B,"Error reading item ",*V2LON,SELCTION,*HOFF:
                    ".  ";
          CALL      HITENTER
          MOVE      ONE,EXIT
.
GREC9999  RETURN
+
.*****************************************************************************
.*                        GDAT0000                     Called by: VIEW0000   *
.*                Get user selected date                          DELD0000   *
.* Requires:  CVERT - keyin row                                              *
.*            CCOL  - keyin column                                           *
.* Returns:   STRTDATE = starting date                                       *
.*            EXIT - 0 = Valid date entered                                  *
.*                   1 = No date entered                                     *
.*****************************************************************************
.
GDAT0000  CALL      IBACLOCK                     * get current date (default)
          MOVE      CCC,CCENT
          MOVE      CYY,CYEAR
          MOVE      CMM,CMON
          MOVE      CDD,CDAY
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          CALL      KEYDATE
          BRANCH    OVRCD,GDAT9100
.
          PACK      STRTDATE,CCENT,CYEAR,CMON,CDAY
          REP       " 0",STRTDATE
.
          MOVE      ZERO,EXIT
          GOTO      GDAT9999
.
GDAT9100  MOVE      ONE,EXIT
.
GDAT9999  RETURN
+
.*****************************************************************************
.*                  FRMT0000                           Called by : LODA0000  *
.*        Format the line display details                          LODO0000  *
.* Requires: FIELDNAM - Database field name                        LODP0000  *
.*           CPATTEXT - Field caption                              LODE0000  *
.*           CODETYPE - 0 = Non-coded field                                  *
.*                      1 = Category Code                                    *
.*                      2 = Doctor Code                                      *
.*                      3 = HCP Code                                         *
.*                      4 = Hospital Code                                    *
.*           CODECATG - Category for Category Coded Fields                   *
.* Returns:  DIM78 - formatted display line                                  *
.* Note:  Maximum field displayed is 50 characters (DIM50)                   *
.*****************************************************************************
.
FRMT0000  PACK      FIELDTXT,SP1,LBRACK,FIELDNAM,RBRACK,COLON,SP1
          MOVELPTR  FIELDTXT,FLLENGTH            * get length of field name
          MOVELPTR  CAPTTEXT,CPLENGTH            * get length of caption
.
.         Calculate how many dots (".") to display between the field caption
.         and the field name
.
          ASSIGN    (FORTY5-FLLENGTH-CPLENGTH),DOTLNGTH
.
          MOVE      CAPTTEXT,DIM78
          ENDSET    DIM78
          WHILE     DOTLNGTH > 0
            APPEND    DOT,DIM78
            SUB       ONE,DOTLNGTH
          DO
.
.         Add the field name and the actual data on to the end of the line.
.         Check the length of the data to see if it is > 33 characters.  If
.         it is, then we will need to put this on a new line to fit
.         the data field on the screen.  Position the data field so that the
.         data is right justified.
.
          APPEND    FIELDTXT,DIM78
          MOVELPTR  DIM50,DATLNGTH
          IF        DATLNGTH > 33
            CALL      WLIN0000                   * write the data line
.
.           Fill start of new data line with blanks to right justify
.
            ASSIGN    (SEVENTY8-DATLNGTH),SPACENUM
            CLEAR     DIM78
            ENDSET    DIM78
            MOVE      ZERO,SPACECNT
            WHILE     SPACECNT < SPACENUM
              ADD       ONE,SPACECNT
              APPEND    SP1,DIM78
            DO
          ENDIF
          APPEND    DIM50,DIM78
.
          BRANCH    CODETYPE,FRMT1000:           * category code
                             FRMT2000:           * doctor code
                             FRMT3000:           * HCP code
                             FRMT4000            * Hospital code
.
          GOTO      FRMT9000
.
.         This is a category/codes field so if a code is present, get the
.         corresponding description and append to the display
.
FRMT1000  MATCH     SP3,DIM50
          IF        !@EQUAL
            PACK      KEY5,CODECATG,DIM50
            CALL      RDCODE1
            IF        OVRCD = 1
              MOVE      "Unknown Code",TDESC
            ENDIF
            APPEND    SP5,DIM78
            APPEND    TDESC,DIM78
          ENDIF
          GOTO      FRMT9000
.
.         This is a doctor code field so if a code is present, get the
.         corresponding description and append to the display
.
FRMT2000  MATCH     SP6,DIM50
          IF        !@EQUAL
            MOVE      DIM50,KEY6
            CALL      RDDOCT1
            IF        OVRCD = 1
              MOVE      "Unknown Code",PACFNAME
            ELSE
              MOVE      DSNAME,PACSNAME
              MOVE      DGNAME,PACGNAME
              MOVE      DTITL,PACTITLE
              MOVE      ONE,PACFRMT
              CALL      PACNAME
            ENDIF
            APPEND    SP2,DIM78
            APPEND    PACFNAME,DIM78
          ENDIF
          GOTO      FRMT9000
.
.         This is a HCP code field so if a code is present, get the
.         corresponding description and append to the display
.
FRMT3000  MATCH     SP6,DIM50
          IF        !@EQUAL
            MOVE      DIM50,KEY10
            CALL      RDPMHCP1
            IF        OVRCD = 1
              MOVE      "Unknown Code",PACFNAME
            ELSE
              MOVE      PMHCSNAM,PACSNAME
              MOVE      PMHCGNAM,PACGNAME
              MOVE      PMHCTITL,PACTITLE
              MOVE      ONE,PACFRMT
              CALL      PACNAME
            ENDIF
            APPEND    SP2,DIM78
            APPEND    PACFNAME,DIM78
          ENDIF
          GOTO      FRMT9000
.
.         This is a hospital code field so if a code is present, get the
.         corresponding description and append to the display
.
FRMT4000  MATCH     SP3,DIM50
          IF        !@EQUAL
            MOVE      DIM50,KEY3
            CALL      RDPTHSP1
            IF        OVRCD = 1
              MOVE      "Unknown Code",PTHSNAME
            ENDIF
            APPEND    SP5,DIM78
            APPEND    PTHSNAME,DIM78
          ENDIF
          GOTO      FRMT9000
.
FRMT9000  CALL      WLIN0000                     * write the data line
.
FRMT9999  RETURN
+
.*****************************************************************************
.*                  LODA0000                           Called by : VINB0000  *
.*        Load the ADT details into the temporary file                       *
.*****************************************************************************
.
.         Read the ADT holding file data
.
LODA0000  PACK      KEY22,H7CIMESI,SP30
          CALL      RSPMQVI1                     * position on first record
          CALL      RKPMQVI1                     * read next record
          BRANCH    OVRCD,LODA9500               * eof - error
.
          COMPARE   H7CIMESI,PMQVMESI            * same message id still ?
          GOTO      LODA9500 IF NOT EQUAL        * no - error
.
.         First record found, so display details
.
          MOVE      "ADT Data - Record 1",DIM78
          CALL      WLIN0000                     * write the data line
.
          MOVE      SP80,DIM78
          CALL      WLIN0000                     * write the data line
.
          CALL      LADT0000                     * Load each of the ADT fields
.
.         See if a second visit record exists for the message
.
          CALL      RKPMQVI1                     * read next record
          BRANCH    OVRCD,LODA9000               * eof
.
          COMPARE   H7CIMESI,PMQVMESI            * same message id still ?
          GOTO      LODA9000 IF NOT EQUAL        * no - finished
.
.         Second record found, so display details
.
          MOVE      SP80,DIM78
          CALL      WLIN0000                     * write the data line
.
          MOVE      "ADT Data - Record 2",DIM78
          CALL      WLIN0000                     * write the data line
.
          MOVE      SP80,DIM78
          CALL      WLIN0000                     * write the data line
.
          CALL      LADT0000                     * Load each of the ADT fields
.
LODA9000  MOVE      ZERO,EXIT
          GOTO      LODA9999
.
LODA9500  DISPLAY   *P1:24,*EL,*B,"ADT Holding file data not found.  ";
          CALL      HITENTER
          MOVE      ONE,EXIT
.
LODA9999  RETURN
+
.*****************************************************************************
.*                  LADT0000                                                 *
.*        Load each of the ADT fields                                        *
.*****************************************************************************
LADT0000  MOVE      "Admission No",CAPTTEXT
          MOVE      "aadmno",FIELDNAM
          MOVE      AADMNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "U/R No",CAPTTEXT
          MOVE      "aurno",FIELDNAM
          MOVE      AURNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ADATE
          IF        !@EQUAL
            UNPACK    ADATE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Admission Date",CAPTTEXT
          MOVE      "adate",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Admission Time",CAPTTEXT
          MOVE      "atime",FIELDNAM
          MOVE      ATIME,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          LOAD      ASTATDES,ASTAT,ASTATDE1,ASTATDE2,ASTATDE3,ASTATDE4,ASTATDE5
          MOVE      "Admission Status",CAPTTEXT
          MOVE      "astat",FIELDNAM
          MOVE      ASTATDES,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Number of Invoices Printed",CAPTTEXT
          MOVE      "ainvprt",FIELDNAM
          MOVE      AINVPRT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALACDTE
          IF        !@EQUAL
            UNPACK    ALACDTE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Last Accomm. Invoice Date",CAPTTEXT
          MOVE      "alacdte",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Pre-admission Cancellation Reason",CAPTTEXT
          MOVE      "acancel",FIELDNAM
          MOVE      ACANCEL,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "PC",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Referring Doctor",CAPTTEXT
          MOVE      "adoctr",FIELDNAM
          MOVE      ADOCTR,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Attending Doctor",CAPTTEXT
          MOVE      "adocta",FIELDNAM
          MOVE      ADOCTA,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Local Doctor",CAPTTEXT
          MOVE      "adoctl",FIELDNAM
          MOVE      ADOCTL,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Admission Source",CAPTTEXT
          MOVE      "asrce",FIELDNAM
          MOVE      ASRCE,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "S ",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Admission Type",CAPTTEXT
          MOVE      "atype",FIELDNAM
          MOVE      ATYPE,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "A ",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Admission Class",CAPTTEXT
          MOVE      "aclss",FIELDNAM
          MOVE      ACLSS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "P ",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Care Class",CAPTTEXT
          MOVE      "acare",FIELDNAM
          MOVE      ACARE,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CC",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Health Fund",CAPTTEXT
          MOVE      "afundh",FIELDNAM
          MOVE      AFUNDH,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Health Fund Table",CAPTTEXT
          MOVE      "afndtb",FIELDNAM
          MOVE      AFNDTB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Health Fund Membership No",CAPTTEXT
          MOVE      "afndmm",FIELDNAM
          MOVE      AFNDMM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      DNO,DIM3
          LOAD      DIM3,AELIG,DYES,DNO
          MOVE      "Eligibility for Govt. Rebate",CAPTTEXT
          MOVE      "aelig",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      DNO,DIM3
          LOAD      DIM3,AVISIT,DYES,DNO
          MOVE      "Religious Visit",CAPTTEXT
          MOVE      "avisit",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      DNO,DIM3
          LOAD      DIM3,AALERG,DYES,DNO
          MOVE      "Patient Allergies",CAPTTEXT
          MOVE      "aalerg",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      DNO,DIM3
          LOAD      DIM3,AILLN,DYES,DNO
          MOVE      "Pre-existing Illness",CAPTTEXT
          MOVE      "ailln",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Admitting Diagnosis 1",CAPTTEXT
          MOVE      "adiag1",FIELDNAM
          MOVE      ADIAG1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Admitting Diagnosis 2",CAPTTEXT
          MOVE      "adiag2",FIELDNAM
          MOVE      ADIAG2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Patient Discount %",CAPTTEXT
          MOVE      "adisc",FIELDNAM
          MOVE      ADISC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Treating Doctor",CAPTTEXT
          MOVE      "adoctt",FIELDNAM
          MOVE      ADOCTT,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Department Code",CAPTTEXT
          MOVE      "aclssft",FIELDNAM
          MOVE      ACLSSFT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "AC",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Patient Allowance Code",CAPTTEXT
          MOVE      "aallow",FIELDNAM
          MOVE      AALLOW,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Admitting MBS Code",CAPTTEXT
          MOVE      "ambs",FIELDNAM
          MOVE      AMBS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Claim Code",CAPTTEXT
          MOVE      "aclaim",FIELDNAM
          MOVE      ACLAIM,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CL",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Diet Code",CAPTTEXT
          MOVE      "adiet",FIELDNAM
          MOVE      ADIET,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "DC",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Place of Occurrence",CAPTTEXT
          MOVE      "aploccr",FIELDNAM
          MOVE      APLOCCR,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "PO",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Expected Length of Stay",CAPTTEXT
          MOVE      "astay",FIELDNAM
          MOVE      ASTAY,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Days of Hospitalisation",CAPTTEXT
          MOVE      "adyhosp",FIELDNAM
          MOVE      ADYHOSP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      DNO,DIM3
          LOAD      DIM3,AMEMB,DYES,DNO
          MOVE      "Diamond Valley Membership",CAPTTEXT
          MOVE      "amemb",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Membership No",CAPTTEXT
          MOVE      "amembno",FIELDNAM
          MOVE      AMEMBNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Comments Field 1",CAPTTEXT
          MOVE      "acomm1",FIELDNAM
          MOVE      ACOMM1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Comments Field 2",CAPTTEXT
          MOVE      "acomm2",FIELDNAM
          MOVE      ACOMM2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Plurality of Baby",CAPTTEXT
          MOVE      "aplur",FIELDNAM
          MOVE      APLUR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      PURGDES1,PURGDESC
          LOAD      PURGDESC,APURGE,PURGDES2,PURGDES3
          MOVE      "Purge Indicator",CAPTTEXT
          MOVE      "apurge",FIELDNAM
          MOVE      PURGDESC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Adm. User Defined Field 1",CAPTTEXT
          MOVE      "ausr1",FIELDNAM
          MOVE      AUSR1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "U1",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Adm. User Defined Field 2",CAPTTEXT
          MOVE      "ausr2",FIELDNAM
          MOVE      AUSR2,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "U2",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Adm. User Defined Field 3",CAPTTEXT
          MOVE      "ausr3",FIELDNAM
          MOVE      AUSR3,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "U3",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Adm. User Defined Field 4",CAPTTEXT
          MOVE      "ausr4",FIELDNAM
          MOVE      AUSR4,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "U4",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Adm. User Defined Field 5",CAPTTEXT
          MOVE      "ausr5",FIELDNAM
          MOVE      AUSR5,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "U5",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Adm. User Defined Field 6",CAPTTEXT
          MOVE      "ausr6",FIELDNAM
          MOVE      AUSR6,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "U6",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Adm. User Defined Field 7",CAPTTEXT
          MOVE      "ausr7",FIELDNAM
          MOVE      AUSR7,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "U7",CODECATG
          CALL      FRMT0000
.         
          MOVE      DNO,DIM3
          LOAD      DIM3,ADSCHI,DYES
          MOVE      "Discharge Invoice Printed",CAPTTEXT
          MOVE      "adschi",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Free Format Referring Dr.",CAPTTEXT
          MOVE      "ardrnam",FIELDNAM
          MOVE      ARDRNAM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Yrs. of Fund Membership",CAPTTEXT
          MOVE      "afndyy",FIELDNAM
          MOVE      AFNDYY,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      SP7,DIM7
          MATCH     SP6,AFNDCG
          IF        !@EQUAL
            UNPACK    AFNDCG,DIM4,DIM2
            PACK      DIM7,DIM4,SLASH,DIM2
          ENDIF
          MOVE      "Fund Cover Change",CAPTTEXT
          MOVE      "afndcg",FIELDNAM
          MOVE      DIM7,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,AOCCDTE
          IF        !@EQUAL
            UNPACK    AOCCDTE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date of Occurrence",CAPTTEXT
          MOVE      "aoccdte",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,ACODDTE
          IF        !@EQUAL
            UNPACK    ACODDTE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Coding Completed",CAPTTEXT
          MOVE      "acoddte",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,ARETDTE
          IF        !@EQUAL
            UNPACK    ARETDTE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Expected Return from Leave",CAPTTEXT
          MOVE      "aretdte",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Mother's Admission No",CAPTTEXT
          MOVE      "amumadm",FIELDNAM
          MOVE      AMUMADM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "No of prev. visits charged",CAPTTEXT
          MOVE      "ptmipvis",FIELDNAM
          MOVE      PTMIPVIS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Baby's /Admission weight",CAPTTEXT
          MOVE      "abwght",FIELDNAM
          MOVE      ABWGHT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring GP.",CAPTTEXT
          MOVE      "ptmsrfgp",FIELDNAM
          MOVE      PTMSRFGP,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "GP Practice Code",CAPTTEXT
          MOVE      "ptmsgppc",FIELDNAM
          MOVE      PTMSGPPC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "eAdmission ID",CAPTTEXT
          MOVE      "ptmsfhan",FIELDNAM
          MOVE      PTMSFHAN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "ECR Approval Number",CAPTTEXT
          MOVE      "ptmsecra",FIELDNAM
          MOVE      PTMSECRA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Management Intent (CAT MI)",CAPTTEXT
          MOVE      "ptmsmgin",FIELDNAM
          MOVE      PTMSMGIN,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "MI",CODECATG
          CALL      FRMT0000
.
          MOVE      "Discharged diagnosis printed?",CAPTTEXT
          MOVE      "ptmiddig",FIELDNAM
          MOVE      PTMIDDIG,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "GP Practice count",CAPTTEXT
          MOVE      "ptmigppt",FIELDNAM
          MOVE      PTMIGPPT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "District of Residence (Cat DA)",CAPTTEXT
          MOVE      "ptmidofr",FIELDNAM
          MOVE      PTMIDOFR,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "DA",CODECATG
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,PTMIREFD
          IF        !@EQUAL
            UNPACK    PTMIREFD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Date of Referral (EDI nz)",CAPTTEXT
          MOVE      "ptmirefd",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,PTMIDFCN
          IF        !@EQUAL
            UNPACK    PTMIDFCN,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Date of 1st consult. (EDI nz)",CAPTTEXT
          MOVE      "ptmidfcn",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Principle Hlth Service Purchaser",CAPTTEXT
          MOVE      "ptmiphpu",FIELDNAM
          MOVE      PTMIPHPU,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "HP",CODECATG
          CALL      FRMT0000
.
          MOVE      "Health Agency (EDI nz) (CAT HA)",CAPTTEXT
          MOVE      "ptmiagnc",FIELDNAM
          MOVE      PTMIAGNC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "HA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Evnt Summary supress flg(EDI nz)",CAPTTEXT
          MOVE      "ptmiessf",FIELDNAM
          MOVE      PTMIESSF,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User defined field 8 (CAT U8)",CAPTTEXT
          MOVE      "ptmiusr8",FIELDNAM
          MOVE      PTMIUSR8,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "U8",CODECATG
          CALL      FRMT0000
.         
          MOVE      "User defined field 9 (CAT U9)",CAPTTEXT
          MOVE      "ptmiusr9",FIELDNAM
          MOVE      PTMIUSR9,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "U9",CODECATG
          CALL      FRMT0000
.         
          MOVE      "User defined field 0 (CAT U0)",CAPTTEXT
          MOVE      "ptmiusr0",FIELDNAM
          MOVE      PTMIUSR0,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "U0",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Provisional DRG",CAPTTEXT
          MOVE      "ptmipdrg",FIELDNAM
          MOVE      PTMIPDRG,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Operator who pre-admitted pat.",CAPTTEXT
          MOVE      "ptmioper",FIELDNAM
          MOVE      PTMIOPER,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Expected Ward for Pre-Admission",CAPTTEXT
          MOVE      "ptmixwrd",FIELDNAM
          MOVE      PTMIXWRD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Associated Doctor",CAPTTEXT
          MOVE      "ptmiadoc",FIELDNAM
          MOVE      PTMIADOC,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Registrar",CAPTTEXT
          MOVE      "ptmiregs",FIELDNAM
          MOVE      PTMIREGS,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def. Y/N Field 1 (1=Y,0=N)",CAPTTEXT
          MOVE      "ptmiuyn1",FIELDNAM
          MOVE      PTMIUYN1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def. Y/N Field 2 (1=Y,0=N)",CAPTTEXT
          MOVE      "ptmiuyn2",FIELDNAM
          MOVE      PTMIUYN2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Previous Admission Number",CAPTTEXT
          MOVE      "ptmipano",FIELDNAM
          MOVE      PTMIPANO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,PTMIPADT
          IF        !@EQUAL
            UNPACK    PTMIPADT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Previous Admission Date",CAPTTEXT
          MOVE      "ptmipadt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Casemix Code",CAPTTEXT
          MOVE      "ptmipcmx",FIELDNAM
          MOVE      PTMIPCMX,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "GST Applicable to Event",CAPTTEXT
          MOVE      "ptmigsta",FIELDNAM
          MOVE      PTMIGSTA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Casemix Payment",CAPTTEXT
          MOVE      "ptmicmxp",FIELDNAM
          MOVE      PTMICMXP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Expected Bed",CAPTTEXT
          MOVE      "ptmiebed",FIELDNAM
          MOVE      PTMIEBED,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Pre-admission Movement Indicator",CAPTTEXT
          MOVE      "ptmidmov",FIELDNAM
          MOVE      PTMIDMOV,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,PTMIDFAS
          IF        !@EQUAL
            UNPACK    PTMIDFAS,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Date Patient First Aware of Symtoms",CAPTTEXT
          MOVE      "ptmidfas",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Credit Card Details on File",CAPTTEXT
          MOVE      "ptmicrcd",FIELDNAM
          MOVE      PTMICRCD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Follow-up for Implant Invoicing",CAPTTEXT
          MOVE      "ptmifinv",FIELDNAM
          MOVE      PTMIFINV,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Continuous Billing Event",CAPTTEXT
          MOVE      "ptmiconb",FIELDNAM
          MOVE      PTMICONB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,PTMIDATC
          IF        !@EQUAL
            UNPACK    PTMIDATC,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Date Created",CAPTTEXT
          MOVE      "ptmidatc",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time Created",CAPTTEXT
          MOVE      "ptmitimc",FIELDNAM
          MOVE      PTMITIMC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Web User who Created",CAPTTEXT
          MOVE      "ptmiwebc",FIELDNAM
          MOVE      PTMIWEBC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,PTMIDATU
          IF        !@EQUAL
            UNPACK    PTMIDATU,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Date Updated",CAPTTEXT
          MOVE      "ptmidatu",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time Updated",CAPTTEXT
          MOVE      "ptmitimu",FIELDNAM
          MOVE      PTMITIMU,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Web User who Updated",CAPTTEXT
          MOVE      "ptmiwebu",FIELDNAM
          MOVE      PTMIWEBU,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "3B Certificate Days",CAPTTEXT
          MOVE      "ptmi3bdy",FIELDNAM
          MOVE      PTMI3BDY,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,PTMI3BAD
          IF        !@EQUAL
            UNPACK    PTMI3BAD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "3B Certificate Admission Date",CAPTTEXT
          MOVE      "ptmi3bad",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Transfer Ward",CAPTTEXT
          MOVE      "tward",FIELDNAM
          MOVE      TWARD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Transfer Bed",CAPTTEXT
          MOVE      "tbed",FIELDNAM
          MOVE      TBED,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,TDATE
          IF        !@EQUAL
            UNPACK    TDATE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Transfer Date",CAPTTEXT
          MOVE      "tdate",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Transfer Time",CAPTTEXT
          MOVE      "ttime",FIELDNAM
          MOVE      TTIME,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient U/R Number",CAPTTEXT
          MOVE      "turno",FIELDNAM
          MOVE      TURNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient Admission Number",CAPTTEXT
          MOVE      "tadmn",FIELDNAM
          MOVE      TADMN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient Portion",CAPTTEXT
          MOVE      "tratef",FIELDNAM
          MOVE      TRATEF,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Government Chargeable",CAPTTEXT
          MOVE      "trateg",FIELDNAM
          MOVE      TRATEG,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient Discount",CAPTTEXT
          MOVE      "tdisc",FIELDNAM
          MOVE      TDISC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient Allowance",CAPTTEXT
          MOVE      "tallw",FIELDNAM
          MOVE      TALLW,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Admission Type",CAPTTEXT
          MOVE      "tatype",FIELDNAM
          MOVE      TATYPE,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "A ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Attending Doctor",CAPTTEXT
          MOVE      "tadoct",FIELDNAM
          MOVE      TADOCT,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Health Fund Portion",CAPTTEXT
          MOVE      "trateh",FIELDNAM
          MOVE      TRATEH,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Extra Daily Charge",CAPTTEXT
          MOVE      "textra",FIELDNAM
          MOVE      TEXTRA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "EFR Bed Type",CAPTTEXT
          MOVE      "trbtyp",FIELDNAM
          MOVE      TRBTYP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "BT",CODECATG
          CALL      FRMT0000
.
          MOVE      "End Day for Rate",CAPTTEXT
          MOVE      "trbend",FIELDNAM
          MOVE      TRBEND,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Chargeable Status",CAPTTEXT
          MOVE      "tchstat",FIELDNAM
          MOVE      TCHSTAT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "U2",CODECATG
          CALL      FRMT0000
.
          MOVE      "Department Code (Cat AC)",CAPTTEXT
          MOVE      "tdept",FIELDNAM
          MOVE      TDEPT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "AC",CODECATG
          CALL      FRMT0000
.
          MOVE      "Type of Patient leave (Cat TL)",CAPTTEXT
          MOVE      "pttrltyp",FIELDNAM
          MOVE      PTTRLTYP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "TL",CODECATG
          CALL      FRMT0000
.
          MOVE      "Episode number",CAPTTEXT
          MOVE      "pttrepno",FIELDNAM
          MOVE      PTTREPNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Manual Stepdown",CAPTTEXT
          MOVE      "pttrepsd",FIELDNAM
          MOVE      PTTREPSD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient Portion of Lumpsum",CAPTTEXT
          MOVE      "pttrlspt",FIELDNAM
          MOVE      PTTRLSPT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Rebate Portion of Lumpsum",CAPTTEXT
          MOVE      "pttrlsrb",FIELDNAM
          MOVE      PTTRLSRB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "End Day for Additional Rate",CAPTTEXT
          MOVE      "pttradpt",FIELDNAM
          MOVE      PTTRADPT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Additional Daily Rate - Rebate",CAPTTEXT
          MOVE      "pttradrb",FIELDNAM
          MOVE      PTTRADRB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Nursing Home Account Code (Cat NH)",CAPTTEXT
          MOVE      "pttrnhac",FIELDNAM
          MOVE      PTTRNHAC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "NH",CODECATG
          CALL      FRMT0000
.
          MOVE      "Operator Id",CAPTTEXT
          MOVE      "pttroper",FIELDNAM
          MOVE      PTTROPER,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Auto Update of Admission Type",CAPTTEXT
          MOVE      "pttrauat",FIELDNAM
          MOVE      PTTRAUAT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,PTTRCDAT
          IF        !@EQUAL
            UNPACK    PTTRCDAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Date Record Created",CAPTTEXT
          MOVE      "pttrcdat",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time Record Created",CAPTTEXT
          MOVE      "pttrctim",FIELDNAM
          MOVE      PTTRCTIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Passcode Created",CAPTTEXT
          MOVE      "pttrcuid",FIELDNAM
          MOVE      PTTRCUID,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Leave Transfer Source",CAPTTEXT
          MOVE      "pttrltsc",FIELDNAM
          MOVE      PTTRLTSC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Web User who Created Record",CAPTTEXT
          MOVE      "pttrucid",FIELDNAM
          MOVE      PTTRUCID,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Web User who Updated Record",CAPTTEXT
          MOVE      "pttruuid",FIELDNAM
          MOVE      PTTRUUID,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Claim Type (Cat CL)",CAPTTEXT
          MOVE      "pttrclty",FIELDNAM
          MOVE      PTTRCLTY,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CL",CODECATG
          CALL      FRMT0000
.
          MOVE      "Transfer Type (Cat RB)",CAPTTEXT
          MOVE      "pttrtrty",FIELDNAM
          MOVE      PTTRTRTY,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "RB",CODECATG
          CALL      FRMT0000
.
          MOVE      "Team",CAPTTEXT
          MOVE      "pttrteam",FIELDNAM
          MOVE      PTTRTEAM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Registrar",CAPTTEXT
          MOVE      "pttrrstr",FIELDNAM
          MOVE      PTTRRSTR,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Resident",CAPTTEXT
          MOVE      "pttrresi",FIELDNAM
          MOVE      PTTRRESI,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Valuables Location",CAPTTEXT
          MOVE      "pmvxvloc",FIELDNAM
          MOVE      PMVXVLOC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Claim Form Signed (0=NO,1=YES)",CAPTTEXT
          MOVE      "pmvxcfsg",FIELDNAM
          MOVE      PMVXCFSG,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Inform Registerd GP (0=NO,1=YES)",CAPTTEXT
          MOVE      "pmvxingp",FIELDNAM
          MOVE      PMVXINGP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Critical Pathway (Cat PW)",CAPTTEXT
          MOVE      "pmvxcpth",FIELDNAM
          MOVE      PMVXCPTH,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "PW",CODECATG
          CALL      FRMT0000
.
          MOVE      "Notify HCP1 (0=NO,1=YES)",CAPTTEXT
          MOVE      "pmvxhcp1",FIELDNAM
          MOVE      PMVXHCP1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Notify HCP2 (0=NO,1=YES)",CAPTTEXT
          MOVE      "pmvxhcp2",FIELDNAM
          MOVE      PMVXHCP2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Notify HCP3 (0=NO,1=YES)",CAPTTEXT
          MOVE      "pmvxhcp3",FIELDNAM
          MOVE      PMVXHCP3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Notify HCP4 (0=NO,1=YES)",CAPTTEXT
          MOVE      "pmvxhcp4",FIELDNAM
          MOVE      PMVXHCP4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP 1 (pmshcpaf)",CAPTTEXT
          MOVE      "pmvxrhc1",FIELDNAM
          MOVE      PMVXRHC1,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP 2 (pmshcpaf)",CAPTTEXT
          MOVE      "pmvxrhc2",FIELDNAM
          MOVE      PMVXRHC2,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP 3 (pmshcpaf)",CAPTTEXT
          MOVE      "pmvxrhc3",FIELDNAM
          MOVE      PMVXRHC3,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP 4 (pmshcpaf)",CAPTTEXT
          MOVE      "pmvxrhc4",FIELDNAM
          MOVE      PMVXRHC4,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Admission Criter. (PRS/2 Cat VB)",CAPTTEXT
          MOVE      "pmvxcadm",FIELDNAM
          MOVE      PMVXCADM,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "VB",CODECATG
          CALL      FRMT0000
.
          MOVE      "Intent to Readmit(PRS/2 Cat VR)",CAPTTEXT
          MOVE      "pmvxirad",FIELDNAM
          MOVE      PMVXIRAD,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "VR",CODECATG
          CALL      FRMT0000
.
          MOVE      "Intend Stay Duratn(PRS/2 Cat VI)",CAPTTEXT
          MOVE      "pmvxidus",FIELDNAM
          MOVE      PMVXIDUS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "VI",CODECATG
          CALL      FRMT0000
.
          MOVE      "Carer Availability(PRS/2 Cat VK)",CAPTTEXT
          MOVE      "pmvxcrav",FIELDNAM
          MOVE      PMVXCRAV,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "VK",CODECATG
          CALL      FRMT0000
.
          MOVE      "Crit. Care Xfer Reason(PRS/2 VJ)",CAPTTEXT
          MOVE      "pmvxrcct",FIELDNAM
          MOVE      PMVXRCCT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "VJ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Admitting Point Ward (patwr1af)",CAPTTEXT
          MOVE      "pmvxapwd",FIELDNAM
          MOVE      PMVXAPWD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Admitting Point Bed (patwr1af)",CAPTTEXT
          MOVE      "pmvxapbd",FIELDNAM
          MOVE      PMVXAPBD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Post-Op Ward (patwr1af)",CAPTTEXT
          MOVE      "pmvxpowd",FIELDNAM
          MOVE      PMVXPOWD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Post-Op Bed (patwr1af)",CAPTTEXT
          MOVE      "pmvxpobd",FIELDNAM
          MOVE      PMVXPOBD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Parent Staying (0=NO,1=YES)",CAPTTEXT
          MOVE      "pmvxpsty",FIELDNAM
          MOVE      PMVXPSTY,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Visitor Allowed (0=NO,1=YES)",CAPTTEXT
          MOVE      "pmvxvalw",FIELDNAM
          MOVE      PMVXVALW,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Phone Calls Allowed?(0=NO,1=YES)",CAPTTEXT
          MOVE      "pmvxpalw",FIELDNAM
          MOVE      PMVXPALW,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Intended Day Case (0=NO,1=YES)",CAPTTEXT
          MOVE      "pmvxindc",FIELDNAM
          MOVE      PMVXINDC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mode of Arrival (Cat VM)",CAPTTEXT
          MOVE      "pmvxmdav",FIELDNAM
          MOVE      PMVXMDAV,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "VM",CODECATG
          CALL      FRMT0000
.
          MOVE      "Forms (Cat VF)",CAPTTEXT
          MOVE      "pmvxfrms",FIELDNAM
          MOVE      PMVXFRMS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "VF",CODECATG
          CALL      FRMT0000
.
          MOVE      "Extra Doctor Code 1 (patdo1af)",CAPTTEXT
          MOVE      "pmvxedc1",FIELDNAM
          MOVE      PMVXEDC1,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Extra Doctor Code 2 (patdo1af)",CAPTTEXT
          MOVE      "pmvxedc2",FIELDNAM
          MOVE      PMVXEDC2,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Extra Doctor Code 3 (patdo1af)",CAPTTEXT
          MOVE      "pmvxedc3",FIELDNAM
          MOVE      PMVXEDC3,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Free Format 1",CAPTTEXT
          MOVE      "pmvxudf1",FIELDNAM
          MOVE      PMVXUDF1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Free Format 2",CAPTTEXT
          MOVE      "pmvxudf2",FIELDNAM
          MOVE      PMVXUDF2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Free Format 3",CAPTTEXT
          MOVE      "pmvxudf3",FIELDNAM
          MOVE      PMVXUDF3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Free Format 4",CAPTTEXT
          MOVE      "pmvxudf4",FIELDNAM
          MOVE      PMVXUDF4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def Date/Time 1 ",CAPTTEXT
          MOVE      "pmvxudt1",FIELDNAM
          MOVE      PMVXUDT1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def Date/Time 2 ",CAPTTEXT
          MOVE      "pmvxudt2",FIELDNAM
          MOVE      PMVXUDT2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def Date/Time 3 ",CAPTTEXT
          MOVE      "pmvxudt3",FIELDNAM
          MOVE      PMVXUDT3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def Date/Time 4 ",CAPTTEXT
          MOVE      "pmvxudt4",FIELDNAM
          MOVE      PMVXUDT4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def Date/Time 5 ",CAPTTEXT
          MOVE      "pmvxudt5",FIELDNAM
          MOVE      PMVXUDT5,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def Date/Time 6 ",CAPTTEXT
          MOVE      "pmvxudt6",FIELDNAM
          MOVE      PMVXUDT6,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMVXCDTE
          IF        !@EQUAL
            UNPACK    PMVXCDTE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Date Record Created",CAPTTEXT
          MOVE      "pmvxcdte",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time Record Created",CAPTTEXT
          MOVE      "pmvxctim",FIELDNAM
          MOVE      PMVXCTIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Web User who Created",CAPTTEXT
          MOVE      "pmvxwebc",FIELDNAM
          MOVE      PMVXWEBC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMVXLUPD
          IF        !@EQUAL
            UNPACK    PMVXLUPD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Last Update Date",CAPTTEXT
          MOVE      "pmvxlupd",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Last Update Time",CAPTTEXT
          MOVE      "pmvxlupt",FIELDNAM
          MOVE      PMVXLUPT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Web User who Last Updated",CAPTTEXT
          MOVE      "pmvxwebu",FIELDNAM
          MOVE      PMVXWEBU,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mental Health Legal Status (Cat LS)",CAPTTEXT
          MOVE      "pmvxmhls",FIELDNAM
          MOVE      PMVXMHLS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "LS",CODECATG
          CALL      FRMT0000
.
          MOVE      "Provisional ICD10 Code",CAPTTEXT
          MOVE      "pmvxpicd",FIELDNAM
          MOVE      PMVXPICD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "RMO Responsible (Cat MO)",CAPTTEXT
          MOVE      "pmvxrmor",FIELDNAM
          MOVE      PMVXRMOR,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "MO",CODECATG
          CALL      FRMT0000
.
          MOVE      "Admission Service Unit Type (Cat KA)",CAPTTEXT
          MOVE      "pmvxasut",FIELDNAM
          MOVE      PMVXASUT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "KA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Elective Patient Status (Cat KC)",CAPTTEXT
          MOVE      "pmvxelps",FIELDNAM
          MOVE      PMVXELPS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "KC",CODECATG
          CALL      FRMT0000
.
          MOVE      "Employment Status (Cat KD)",CAPTTEXT
          MOVE      "pmvxempl",FIELDNAM
          MOVE      PMVXEMPL,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "KD",CODECATG
          CALL      FRMT0000
.
          MOVE      "Which Financial Program (Cat KE)",CAPTTEXT
          MOVE      "pmvxfinp",FIELDNAM
          MOVE      PMVXFINP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "KE",CODECATG
          CALL      FRMT0000
.
          MOVE      "Occupation (Cat KF)",CAPTTEXT
          MOVE      "pmvxoccp",FIELDNAM
          MOVE      PMVXOCCP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "KF",CODECATG
          CALL      FRMT0000
.
          MOVE      "Involvement in Palliative Care (Cat KG)",CAPTTEXT
          MOVE      "pmvxpalc",FIELDNAM
          MOVE      PMVXPALC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "KG",CODECATG
          CALL      FRMT0000
.
          MOVE      "Previous Non-Admitted Palliative Care (Cat KH)",CAPTTEXT
          MOVE      "pmvxppal",FIELDNAM
          MOVE      PMVXPPAL,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "KH",CODECATG
          CALL      FRMT0000
.
          MOVE      "Public/Private Patients (Cat KI)",CAPTTEXT
          MOVE      "pmvxpppt",FIELDNAM
          MOVE      PMVXPPPT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "KI",CODECATG
          CALL      FRMT0000
.
          MOVE      "Pension Status on Separation (Cat KJ)",CAPTTEXT
          MOVE      "pmvxpsos",FIELDNAM
          MOVE      PMVXPPPT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "KJ",CODECATG
.
          MOVE      "Payment Status on Separation (Cat KK)",CAPTTEXT
          MOVE      "pmvxpysp",FIELDNAM
          MOVE      PMVXPYSP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "KK",CODECATG
          CALL      FRMT0000
.
          MOVE      "Banding/Type of Episode for QLDHDP",CAPTTEXT
          MOVE      "pmvxqldb",FIELDNAM
          MOVE      PMVXQLDB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Re-Admission in 28 Days (Cat KM)",CAPTTEXT
          MOVE      "pmvxread",FIELDNAM
          MOVE      PMVXREAD,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "KM",CODECATG
          CALL      FRMT0000
.
          MOVE      "Discharge Intention (Cat KN)",CAPTTEXT
          MOVE      "pmvxudin",FIELDNAM
          MOVE      PMVXUDIN,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "KN",CODECATG
          CALL      FRMT0000
.
          MOVE      "Unplanned Readmission (Cat KO)",CAPTTEXT
          MOVE      "pmvxurea",FIELDNAM
          MOVE      PMVXUREA,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "KO",CODECATG
          CALL      FRMT0000
.
          MOVE      "Usual Accommodation (Cat KP)",CAPTTEXT
          MOVE      "pmvxusac",FIELDNAM
          MOVE      PMVXUSAC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "KP",CODECATG
          CALL      FRMT0000
.
          MOVE      "Unplanned Visit to Theatre (Cat KB)",CAPTTEXT
          MOVE      "pmvxuvth",FIELDNAM
          MOVE      PMVXUVTH,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "KB",CODECATG
          CALL      FRMT0000
.
          MOVE      "Interpreter Required (0=NO,1=YES)",CAPTTEXT
          MOVE      "pmvxintr",FIELDNAM
          MOVE      PMVXINTR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Preferred Language (Cat LA)",CAPTTEXT
          MOVE      "pmvxlng1",FIELDNAM
          MOVE      PMVXLNG1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "LA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Interpreter Required (0=NO,1=YES)",CAPTTEXT
          MOVE      "pmvxintr",FIELDNAM
          MOVE      PMVXINTR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "ABS AGSC",CAPTTEXT
          MOVE      "pmvxasgc",FIELDNAM
          MOVE      PMVXASGC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Multi Hospital ID (pathspaf)",CAPTTEXT
          MOVE      "pmvxmhos",FIELDNAM
          MOVE      PMVXMHOS,DIM50
          MOVE      FOUR,CODETYPE
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMVXDSPD
          IF        !@EQUAL
            UNPACK    PMVXDSPD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Discharge Summary Produced Date",CAPTTEXT
          MOVE      "pmvxdspd",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Disch Summary (I)nterim / (F)inal",CAPTTEXT
          MOVE      "pmvxdsif",FIELDNAM
          MOVE      PMVXDSIF,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Participate/Receive Marketing Info",CAPTTEXT
          MOVE      "pmvxprmi",FIELDNAM
          MOVE      PMVXPRMI,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Participate/Receive Advertising Info",CAPTTEXT
          MOVE      "pmvxprai",FIELDNAM
          MOVE      PMVXPRAI,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Participate in Research Projects",CAPTTEXT
          MOVE      "pmvxpres",FIELDNAM
          MOVE      PMVXPRES,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Use Information for Training",CAPTTEXT
          MOVE      "pmvxuitr",FIELDNAM
          MOVE      PMVXUITR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Release to Enduring POA / IFC",CAPTTEXT
          MOVE      "pmvxrpoa",FIELDNAM
          MOVE      PMVXRPOA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Release to Contact 1 (ptmxnrnm)",CAPTTEXT
          MOVE      "pmvxrcn1",FIELDNAM
          MOVE      PMVXRCN1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Release to Contact 2 (ptmxexnm)",CAPTTEXT
          MOVE      "pmvxrcn2",FIELDNAM
          MOVE      PMVXRCN2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Release to Health Fund",CAPTTEXT
          MOVE      "pmvxrhfu",FIELDNAM
          MOVE      PMVXRHFU,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Release to DVA",CAPTTEXT
          MOVE      "pmvxrdva",FIELDNAM
          MOVE      PMVXRDVA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "RSL Visit OK",CAPTTEXT
          MOVE      "pmvxrslo",FIELDNAM
          MOVE      PMVXRSLO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Medical Record Location (Cat MV)",CAPTTEXT
          MOVE      "pmvxmloc",FIELDNAM
          MOVE      PMVXMLOC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "MV",CODECATG
          CALL      FRMT0000
.
          MOVE      "Preferred Accommodation (Cat BP)",CAPTTEXT
          MOVE      "pmvxpacc",FIELDNAM
          MOVE      PMVXPACC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "BP",CODECATG
          CALL      FRMT0000
.
          MOVE      "Extra Doctor Unit 1 (Cat AC)",CAPTTEXT
          MOVE      "pmvxedu1",FIELDNAM
          MOVE      PMVXEDU1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "AC",CODECATG
          CALL      FRMT0000
.
          MOVE      "Extra Doctor Unit 2 (Cat AC)",CAPTTEXT
          MOVE      "pmvxedu2",FIELDNAM
          MOVE      PMVXEDU2,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "AC",CODECATG
          CALL      FRMT0000
.
          MOVE      "Extra Doctor Unit 3 (Cat AC)",CAPTTEXT
          MOVE      "pmvxedu3",FIELDNAM
          MOVE      PMVXEDU3,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "AC",CODECATG
          CALL      FRMT0000
.
          MOVE      "Program Code",CAPTTEXT
          MOVE      "pmvxprgm",FIELDNAM
          MOVE      PMVXPRGM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Appointment Confirmed (0=No 1=Yes)",CAPTTEXT
          MOVE      "pmvxconf",FIELDNAM
          MOVE      PMVXCONF,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "EOC Link Admission Number",CAPTTEXT
          MOVE      "pmvxeocl",FIELDNAM
          MOVE      PMVXEOCL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Location SOR (Cat SG)",CAPTTEXT
          MOVE      "pmvxsloc",FIELDNAM
          MOVE      PMVXSLOC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "SG",CODECATG
          CALL      FRMT0000
.
          MOVE      "Clinical SOR (Cat SH)",CAPTTEXT
          MOVE      "pmvxscli",FIELDNAM
          MOVE      PMVXSCLI,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "SH",CODECATG
          CALL      FRMT0000
.
          MOVE      "Transport SOR (Cat SI)",CAPTTEXT
          MOVE      "pmvxstra",FIELDNAM
          MOVE      PMVXSTRA,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "SI",CODECATG
          CALL      FRMT0000
.
          MOVE      "QAS Number",CAPTTEXT
          MOVE      "pmvxqasn",FIELDNAM
          MOVE      PMVXQASN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "All Theatre Charges Posted (0=No 1=Yes)",CAPTTEXT
          MOVE      "pmvxatcp",FIELDNAM
          MOVE      PMVXATCP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Arrival Time",CAPTTEXT
          MOVE      "pmvxatim",FIELDNAM
          MOVE      PMVXATIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Interview Time",CAPTTEXT
          MOVE      "pmvxitim",FIELDNAM
          MOVE      PMVXITIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Health Fund First Given Name Alias",CAPTTEXT
          MOVE      "pmvxhfgn",FIELDNAM
          MOVE      PMVXHFGN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Health Fund Surname Alias",CAPTTEXT
          MOVE      "pmvxhfsn",FIELDNAM
          MOVE      PMVXHFSN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Health Fund UPI",CAPTTEXT
          MOVE      "pmvxfupi",FIELDNAM
          MOVE      PMVXFUPI,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient Online Eligibility Consent",CAPTTEXT
          MOVE      "pmvxpoec",FIELDNAM
          MOVE      PMVXPOEC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Program Identifier (Cat PK)",CAPTTEXT
          MOVE      "pmvxpgid",FIELDNAM
          MOVE      PMVXPGID,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "PK",CODECATG
          CALL      FRMT0000
.
          MOVE      "Reason Theatre Incomplete (Cat Rt)",CAPTTEXT
          MOVE      "pmvxticm",FIELDNAM
          MOVE      PMVXTICM,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "Rt",CODECATG
          CALL      FRMT0000
.
          MOVE      "Presenting Illness Code (Cat iL)",CAPTTEXT
          MOVE      "pmvxpilc",FIELDNAM
          MOVE      PMVXPILC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "iL",CODECATG
          CALL      FRMT0000
.
          MOVE      "Family Violence (Cat fv)",CAPTTEXT
          MOVE      "pmvxfvio",FIELDNAM
          MOVE      PMVXFVIO,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "fv",CODECATG
          CALL      FRMT0000
.
          MOVE      "Health Fund Membership Number",CAPTTEXT
          MOVE      "pmvxfndm",FIELDNAM
          MOVE      PMVXFNDM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Category code",CAPTTEXT
          MOVE      "pmvxudf5",FIELDNAM
          MOVE      PMVXUDF5,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Category code",CAPTTEXT
          MOVE      "pmvxudf6",FIELDNAM
          MOVE      PMVXUDF6,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Category code",CAPTTEXT
          MOVE      "pmvxudf7",FIELDNAM
          MOVE      PMVXUDF7,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Category code",CAPTTEXT
          MOVE      "pmvxudf8",FIELDNAM
          MOVE      PMVXUDF8,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Category code",CAPTTEXT
          MOVE      "pmvxudf9",FIELDNAM
          MOVE      PMVXUDF9,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Category code",CAPTTEXT
          MOVE      "pmvxud10",FIELDNAM
          MOVE      PMVXUD10,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Category code",CAPTTEXT
          MOVE      "pmvxud11",FIELDNAM
          MOVE      PMVXUD11,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Category code",CAPTTEXT
          MOVE      "pmvxud12",FIELDNAM
          MOVE      PMVXUD12,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Category code",CAPTTEXT
          MOVE      "pmvxud13",FIELDNAM
          MOVE      PMVXUD13,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Category code",CAPTTEXT
          MOVE      "pmvxud14",FIELDNAM
          MOVE      PMVXUD14,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Category code",CAPTTEXT
          MOVE      "pmvxud15",FIELDNAM
          MOVE      PMVXUD15,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Team",CAPTTEXT
          MOVE      "pmvxteam",FIELDNAM
          MOVE      PMVXTEAM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Non WA Hospital Contact (Cat cw)",CAPTTEXT
          MOVE      "pmvxnwhc",FIELDNAM
          MOVE      PMVXNWHC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "cw",CODECATG
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMVXEDDT
          IF        !@EQUAL
            UNPACK    PMVXEDDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Expected Delivery Date",CAPTTEXT
          MOVE      "pmpxeddt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Property Held (Cat ps)",CAPTTEXT
          MOVE      "pmvxphld",FIELDNAM
          MOVE      PMVXPHLD,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ps",CODECATG
          CALL      FRMT0000
.
          MOVE      "Property Location (Cat pt)",CAPTTEXT
          MOVE      "pmvxploc",FIELDNAM
          MOVE      PMVXPLOC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "pt",CODECATG
          CALL      FRMT0000
.         
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMVXDTRT
          IF        !@EQUAL
            UNPACK    PMVXDTRT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Date Returned",CAPTTEXT
          MOVE      "pmvxdtrt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Disaster Flag",CAPTTEXT
          MOVE      "pmvxdflg",FIELDNAM
          MOVE      PMVXDFLG,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Funding Source (Cat cx)",CAPTTEXT
          MOVE      "pmvxfsrc",FIELDNAM
          MOVE      PMVXFSRC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "cx",CODECATG
          CALL      FRMT0000
.
          MOVE      "Contributor Name",CAPTTEXT
          MOVE      "pmvxconm",FIELDNAM
          MOVE      PMVXCONM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,DDATE
          IF        !@EQUAL
            UNPACK    DDATE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Discharge Date",CAPTTEXT
          MOVE      "ddate",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Discharge Time",CAPTTEXT
          MOVE      "dtime",FIELDNAM
          MOVE      DTIME,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Discharge Status",CAPTTEXT
          MOVE      "dstat",FIELDNAM
          MOVE      DSTAT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "D ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Discharge Destination",CAPTTEXT
          MOVE      "ddest",FIELDNAM
          MOVE      DDEST,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "DD",CODECATG
          CALL      FRMT0000
.
          MOVE      "Discharge Diagnosis 1",CAPTTEXT
          MOVE      "ddiag",FIELDNAM
          MOVE      DDIAG,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Discharge Diagnosis 2",CAPTTEXT
          MOVE      "ddiag2",FIELDNAM
          MOVE      DDIAG2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Dis. User Defined Field 1",CAPTTEXT
          MOVE      "dusd1",FIELDNAM
          MOVE      DUSD1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "D1",CODECATG
          CALL      FRMT0000
.
          MOVE      "Dis. User Defined Field 2",CAPTTEXT
          MOVE      "dusd2",FIELDNAM
          MOVE      DUSD2,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "D2",CODECATG
          CALL      FRMT0000
.
          MOVE      "Dis. User Defined Field 3",CAPTTEXT
          MOVE      "dusd3",FIELDNAM
          MOVE      DUSD3,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "D3",CODECATG
          CALL      FRMT0000
.
          MOVE      "Dis. User Defined Field 4",CAPTTEXT
          MOVE      "dusd4",FIELDNAM
          MOVE      DUSD4,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "D4",CODECATG
          CALL      FRMT0000
.
          MOVE      "Dis. User Defined Field 5",CAPTTEXT
          MOVE      "dusd5",FIELDNAM
          MOVE      DUSD5,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "D5",CODECATG
          CALL      FRMT0000
.
          MOVE      "Discharge Diagnosis Code",CAPTTEXT
          MOVE      "dfmbs",FIELDNAM
          MOVE      DFMBS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "MDC Code",CAPTTEXT
          MOVE      "ptdsdmdc",FIELDNAM
          MOVE      PTDSDMDC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "DRG Code",CAPTTEXT
          MOVE      "ptdsddrg",FIELDNAM
          MOVE      PTDSDDRG,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Reasn Disc.Pat back on WL (RW)",CAPTTEXT
          MOVE      "dwlreasn",FIELDNAM
          MOVE      DWLREASN,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "RW",CODECATG
          CALL      FRMT0000
.
          MOVE      "DRG Severity Index",CAPTTEXT
          MOVE      "ptdssidx",FIELDNAM
          MOVE      PTDSSIDX,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Grouper Version",CAPTTEXT
          MOVE      "ptdsvogu",FIELDNAM
          MOVE      PTDSVOGU,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Operator who discharged patient",CAPTTEXT
          MOVE      "ptdsoper",FIELDNAM
          MOVE      PTDSOPER,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N Field 1",CAPTTEXT
          MOVE      "ptdsuyn1",FIELDNAM
          MOVE      PTDSUYN1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N Field 2",CAPTTEXT
          MOVE      "ptdsuyn2",FIELDNAM
          MOVE      PTDSUYN2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N Field 3",CAPTTEXT
          MOVE      "ptdsuyn3",FIELDNAM
          MOVE      PTDSUYN3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N Field 4",CAPTTEXT
          MOVE      "ptdsuyn4",FIELDNAM
          MOVE      PTDSUYN4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Discharge Ward",CAPTTEXT
          MOVE      "ptdsdwrd",FIELDNAM
          MOVE      PTDSDWRD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Length of Stay",CAPTTEXT
          MOVE      "ptdsdlos",FIELDNAM
          MOVE      PTDSDLOS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Separation Referral",CAPTTEXT
          MOVE      "ptdssref",FIELDNAM
          MOVE      PTDSSREF,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Palliative Care Days (PRS/2)",CAPTTEXT
          MOVE      "ptdspald",FIELDNAM
          MOVE      PTDSPALD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Departure Means (CAT SI)",CAPTTEXT
          MOVE      "ptdhdpmn",FIELDNAM
          MOVE      PTDSDPMN,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "SI",CODECATG
          CALL      FRMT0000
.
          MOVE      "Leave end reason code (CAT LE)",CAPTTEXT
          MOVE      "mhlrcode",FIELDNAM
          MOVE      MHLRCODE,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "LE",CODECATG
          CALL      FRMT0000
.
          MOVE      "Ward Standby Number",CAPTTEXT
          MOVE      "wstby",FIELDNAM
          MOVE      WSTBY,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP 1 Pract. (pmshcl)",CAPTTEXT
          MOVE      "pmvxrh1g",FIELDNAM
          MOVE      PMVXRH1G,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP 1 Grp Cnt (pmshcg)",CAPTTEXT
          MOVE      "pmvxrh1c",FIELDNAM
          MOVE      PMVXRH1C,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Cancelled Transfer Date",CAPTTEXT
          MOVE      "pmqvtdat",FIELDNAM
          MOVE      PMQVTDAT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Cancelled Transfer Time",CAPTTEXT
          MOVE      "pmqvttim",FIELDNAM
          MOVE      PMQVTTIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Person Resp. for A/C Name",CAPTTEXT
          MOVE      "pkname",FIELDNAM
          MOVE      PKNAME,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "P.R.A. Address Line 1",CAPTTEXT
          MOVE      "pkadd1",FIELDNAM
          MOVE      PKADD1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "P.R.A. Address Line 2",CAPTTEXT
          MOVE      "pkadd2",FIELDNAM
          MOVE      PKADD2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "P.R.A. Suburb",CAPTTEXT
          MOVE      "pksubr",FIELDNAM
          MOVE      PKSUBR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "P.R.A. Address Line 4",CAPTTEXT
          MOVE      "pkadd4",FIELDNAM
          MOVE      PKADD4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "P.R.A. Postcode",CAPTTEXT
          MOVE      "pkpost",FIELDNAM
          MOVE      PKPOST,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "P.R.A. Private Telephone No",CAPTTEXT
          MOVE      "pktelep",FIELDNAM
          MOVE      PKTELEP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "P.R.A. Business Telephone No",CAPTTEXT
          MOVE      "pkteleb",FIELDNAM
          MOVE      PKTELEB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "P.R.A. Relationship",CAPTTEXT
          MOVE      "pkrelp",FIELDNAM
          MOVE      PKRELP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "P.R.A. Mobile Telephone Number",CAPTTEXT
          MOVE      "ptremobl",FIELDNAM
          MOVE      PTREMOBL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Surname or Contact Name for Insurance",CAPTTEXT
          MOVE      "ptresnam",FIELDNAM
          MOVE      PTRESNAM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Given Name",CAPTTEXT
          MOVE      "ptregnam",FIELDNAM
          MOVE      PTREGNAM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
LADT9999  RETURN
+
.*****************************************************************************
.*                  LODT0000                           Called by : VINB0000  *
.*        Load the OPR details into the temporary file                       *
.*****************************************************************************
.
.         Read the OPR holding file data
.
LODT0000  MOVE      H7CIMESI,KEY20
          CALL      RDOPQUE1                     * record found ?
          BRANCH    OVRCD,LODT9500               * no - error
.
          MOVE      "OPR Data",DIM78
          RESET     DIM78
          PACK      DIM78,DIM78,SP80
          CALL      WLIN0000                     * write the data line
.
          MOVE      SP80,DIM78
          CALL      WLIN0000                     * write the data line
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OPDADATE
          IF        !@EQUAL
            UNPACK    OPDADATE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Session Date",CAPTTEXT
          MOVE      "opdadate",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Start Time",CAPTTEXT
          MOVE      "opdatime",FIELDNAM
          MOVE      OPDATIME,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic/Surgeon",CAPTTEXT
          MOVE      "opdaclin",FIELDNAM
          MOVE      OPDACLIN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      BOOKDES1,BOOKDESC
          LOAD      BOOKDESC,OPDASTAT,ASTATDE1:
                                      ASTATDE2:
                                      ASTATDE5:
                                      ASTATDE3
          MOVE      "Booking Status",CAPTTEXT
          MOVE      "opdastat",FIELDNAM
          MOVE      BOOKDESC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Case Number",CAPTTEXT
          MOVE      "opdacase",FIELDNAM
          MOVE      OPDACASE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Admission No",CAPTTEXT
          MOVE      "opdaadmn",FIELDNAM
          MOVE      OPDAADMN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Unique Id",CAPTTEXT
          MOVE      "opdauniq",FIELDNAM
          MOVE      OPDAUNIQ,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Expected Start Time",CAPTTEXT
          MOVE      "opdaexps",FIELDNAM
          MOVE      OPDAEXPS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Expected Duration",CAPTTEXT
          MOVE      "opdaexpd",FIELDNAM
          MOVE      OPDAEXPD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Anaesthetic Code",CAPTTEXT
          MOVE      "opdaanae",FIELDNAM
          MOVE      OPDAANAE,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "OA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Operation Type",CAPTTEXT
          MOVE      "opdatype",FIELDNAM
          MOVE      OPDATYPE,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "OY",CODECATG
          CALL      FRMT0000
.
          MOVE      "Transport Code",CAPTTEXT
          MOVE      "opdatran",FIELDNAM
          MOVE      OPDATRAN,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "OR",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 1",CAPTTEXT
          MOVE      "opdausr1",FIELDNAM
          MOVE      OPDAUSR1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "Y6",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 2",CAPTTEXT
          MOVE      "opdausr2",FIELDNAM
          MOVE      OPDAUSR2,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "Y7",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 3",CAPTTEXT
          MOVE      "opdausr3",FIELDNAM
          MOVE      OPDAUSR3,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "Y8",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 4",CAPTTEXT
          MOVE      "opdausr4",FIELDNAM
          MOVE      OPDAUSR4,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "Y9",CODECATG
          CALL      FRMT0000
.
          MOVE      "Waiting Lists (Y/N)",CAPTTEXT
          MOVE      "opdawait",FIELDNAM
          MATCH     "1",OPDAWAIT
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Provisional Item 1",CAPTTEXT
          MOVE      "opdaprov",FIELDNAM
          MOVE      OPDAPROV,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Provisional Item 2",CAPTTEXT
          MOVE      "opdaprv2",FIELDNAM
          MOVE      OPDAPRV2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Provisional Item 3",CAPTTEXT
          MOVE      "opdaprv3",FIELDNAM
          MOVE      OPDAPRV3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Operation Description 1",CAPTTEXT
          MOVE      "opdades1",FIELDNAM
          MOVE      OPDADES1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Operation Description 2",CAPTTEXT
          MOVE      "opdades2",FIELDNAM
          MOVE      OPDADES2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Operation Description 3",CAPTTEXT
          MOVE      "opdades3",FIELDNAM
          MOVE      OPDADES3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Comments",CAPTTEXT
          MOVE      "opdacomm",FIELDNAM
          MOVE      OPDACOMM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Cancellation Code",CAPTTEXT
          MOVE      "opdacanc",FIELDNAM
          MOVE      OPDACANC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "SC",CODECATG
          CALL      FRMT0000
.
          MOVE      "Operating Room Code",CAPTTEXT
          MOVE      "opdathet",FIELDNAM
          MOVE      OPDATHET,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Pre-Operative Time 1",CAPTTEXT
          MOVE      "opdapre1",FIELDNAM
          MOVE      OPDAPRE1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Pre-Operative Time 2",CAPTTEXT
          MOVE      "opdapre2",FIELDNAM
          MOVE      OPDAPRE2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Pre-Operative Time 3",CAPTTEXT
          MOVE      "opdapre3",FIELDNAM
          MOVE      OPDAPRE3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Pre-Operative Time 4",CAPTTEXT
          MOVE      "opdapre4",FIELDNAM
          MOVE      OPDAPRE4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Pre-Operative Time 5",CAPTTEXT
          MOVE      "opdapre5",FIELDNAM
          MOVE      OPDAPRE5,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Post-Operative Time 1",CAPTTEXT
          MOVE      "opdapre1",FIELDNAM
          MOVE      OPDAPRE1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Post-Operative Time 2",CAPTTEXT
          MOVE      "opdapre2",FIELDNAM
          MOVE      OPDAPRE2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Post-Operative Time 3",CAPTTEXT
          MOVE      "opdapre3",FIELDNAM
          MOVE      OPDAPRE3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Post-Operative Time 4",CAPTTEXT
          MOVE      "opdapre4",FIELDNAM
          MOVE      OPDAPRE4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Actual Duration in Theatre",CAPTTEXT
          MOVE      "opdatdur",FIELDNAM
          MOVE      OPDATDUR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Known Infection",CAPTTEXT
          MOVE      "opdaknow",FIELDNAM
          MOVE      OPDAKNOW,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "OK",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OPDACDAT
          IF        !@EQUAL
            UNPACK    OPDACDAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Cancellation Date",CAPTTEXT
          MOVE      "opdacdat",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Equipment Required 1",CAPTTEXT
          MOVE      "opdaeqr1",FIELDNAM
          MOVE      OPDAEQR1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "XE",CODECATG
          CALL      FRMT0000
.
          MOVE      "Equipment Required 2",CAPTTEXT
          MOVE      "opdaeqr2",FIELDNAM
          MOVE      OPDAEQR2,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "XE",CODECATG
          CALL      FRMT0000
.
          MOVE      "Loan Equipment Required",CAPTTEXT
          MOVE      "opdaleqr",FIELDNAM
          MOVE      OPDALEQR,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "XO",CODECATG
          CALL      FRMT0000
.
          MOVE      "Equipment Required 3",CAPTTEXT
          MOVE      "opdaeqr3",FIELDNAM
          MOVE      OPDAEQR3,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "XE",CODECATG
          CALL      FRMT0000
.
          MOVE      "Specialty/Unit",CAPTTEXT
          MOVE      "opdaunit",FIELDNAM
          MOVE      OPDAUNIT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ST",CODECATG
          CALL      FRMT0000
.
          MOVE      "U/R Number",CAPTTEXT
          MOVE      "opdaurno",FIELDNAM
          MOVE      OPDAURNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "W/L Procedure Code",CAPTTEXT
          MOVE      "opdaproc",FIELDNAM
          MOVE      OPDAPROC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "W/L Procedure Count",CAPTTEXT
          MOVE      "opdacont",FIELDNAM
          MOVE      OPDACONT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Admission Source",CAPTTEXT
          MOVE      "opdaasrc",FIELDNAM
          MOVE      OPDAASRC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "S ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Consent Obtained (Y/N)",CAPTTEXT
          MOVE      "opdacsst",FIELDNAM
          MATCH     "1",OPDACSST
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OPDACSDT
          IF        !@EQUAL
            UNPACK    OPDACSDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Consent Changed Date",CAPTTEXT
          MOVE      "opdacsdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OPDACRDT
          IF        !@EQUAL
            UNPACK    OPDACRDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Record Created",CAPTTEXT
          MOVE      "opdacrdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time Record Created",CAPTTEXT
          MOVE      "opdactim",FIELDNAM
          MOVE      OPDACTIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Created by User Id",CAPTTEXT
          MOVE      "opdawebc",FIELDNAM
          MOVE      OPDAWEBC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OPDAUDAT
          IF        !@EQUAL
            UNPACK    OPDAUDAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Last Update Date",CAPTTEXT
          MOVE      "opdaudat",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Last Update Time",CAPTTEXT
          MOVE      "opdautim",FIELDNAM
          MOVE      OPDAUTIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Updated by User Id",CAPTTEXT
          MOVE      "opdawebu",FIELDNAM
          MOVE      OPDAWEBU,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      ZERO,EXIT
          GOTO      LODT9999
.
LODT9500  DISPLAY   *P1:24,*EL,*B,"OPR Holding file data not found.  ";
          CALL      HITENTER
          MOVE      ONE,EXIT
.
LODT9999  RETURN
+
.*****************************************************************************
.*                  LODR0000                           Called by : VINB0000  *
.*        Load the O/P referral details into the temporary file              *
.*****************************************************************************
.
.         Read the O/P referral holding file data
.
LODR0000  MOVE      H7CIMESI,KEY20
          CALL      RDOTRQU1                     * record found ?
          BRANCH    OVRCD,LODR9500               * no - error
.
          MOVE      "O/P Referral Data",DIM78
          RESET     DIM78
          PACK      DIM78,DIM78,SP80
          CALL      WLIN0000                     * write the data line
.
          MOVE      SP80,DIM78
          CALL      WLIN0000                     * write the data line
.
          MOVE      "Outpatient Number",CAPTTEXT
          MOVE      "otrloutn",FIELDNAM
          MOVE      OTRLOUTN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "U/R Number",CAPTTEXT
          MOVE      "otrlurno",FIELDNAM
          MOVE      OTRLURNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OTRLDATE
          IF        !@EQUAL
            UNPACK    OTRLDATE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE                    
          ENDIF
          MOVE      "Letter Date",CAPTTEXT
          MOVE      "otrldate",FIELDNAM          
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP",CAPTTEXT
          MOVE      "otrlrdoc",FIELDNAM
          MOVE      OTRLRDOC,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Consultant",CAPTTEXT
          MOVE      "otrlcons",FIELDNAM
          MOVE      OTRLCONS,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Department",CAPTTEXT
          MOVE      "otrldept",FIELDNAM
          MOVE      OTRLDEPT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "A ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Priority",CAPTTEXT
          MOVE      "otrlprio",FIELDNAM
          MOVE      OTRLPRIO,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "PR",CODECATG
          CALL      FRMT0000
.
          MOVE      "Diagnosis",CAPTTEXT
          MOVE      "otrldiag",FIELDNAM
          MOVE      OTRLDIAG,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Field 1",CAPTTEXT
          MOVE      "otrlusd1",FIELDNAM
          MOVE      OTRLUSD1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "L1",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 2",CAPTTEXT
          MOVE      "otrlusd2",FIELDNAM
          MOVE      OTRLUSD2,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "L2",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 3",CAPTTEXT
          MOVE      "otrlusd3",FIELDNAM
          MOVE      OTRLUSD3,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "L3",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 4",CAPTTEXT
          MOVE      "otrlusd4",FIELDNAM
          MOVE      OTRLUSD4,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "L4",CODECATG
          CALL      FRMT0000
.
          MOVE      "Booked Site",CAPTTEXT
          MOVE      "otrlbsit",FIELDNAM
          MOVE      OTRLBSIT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Booked Clinic",CAPTTEXT
          MOVE      "otrlbcli",FIELDNAM
          MOVE      OTRLBCLI,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OTRLBDTE
          IF        !@EQUAL
            UNPACK    OTRLBDTE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Booked Date",CAPTTEXT
          MOVE      "otrlbdte",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Booked Start Time",CAPTTEXT
          MOVE      "otrlbstr",FIELDNAM
          MOVE      OTRLBSTR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Booked Slot No",CAPTTEXT
          MOVE      "otrlbslt",FIELDNAM
          MOVE      OTRLBSLT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring GP",CAPTTEXT
          MOVE      "otrlrfgp",FIELDNAM
          MOVE      OTRLRFGP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "GP Practice Code",CAPTTEXT
          MOVE      "otrlgppc",FIELDNAM
          MOVE      OTRLGPPC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Request Number",CAPTTEXT
          MOVE      "otrlrqst",FIELDNAM
          MOVE      OTRLRQST,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OTRLCDTE
          IF        !@EQUAL
            UNPACK    OTRLCDTE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Request for Appointment Canc. Date",CAPTTEXT
          MOVE      "otrlcdte",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Reason for Request",CAPTTEXT
          MOVE      "otrlreas",FIELDNAM
          MOVE      OTRLREAS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "RQ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Specialty Function Code",CAPTTEXT
          MOVE      "otrlspfc",FIELDNAM
          MOVE      OTRLSPFC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "OF",CODECATG
          CALL      FRMT0000
.
          MOVE      "Correspondence Address Line 1",CAPTTEXT
          MOVE      "otrlcad1",FIELDNAM
          MOVE      OTRLCAD1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Correspondence Address Line 2",CAPTTEXT
          MOVE      "otrlcad2",FIELDNAM
          MOVE      OTRLCAD2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Correspondence Address Line 3",CAPTTEXT
          MOVE      "otrlcad3",FIELDNAM
          MOVE      OTRLCAD3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Correspondence Address Line 4",CAPTTEXT
          MOVE      "otrlcad4",FIELDNAM
          MOVE      OTRLCAD4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Correspondence Post code",CAPTTEXT
          MOVE      "otrlcpc",FIELDNAM
          MOVE      OTRLCPC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "ECR Approval Number",CAPTTEXT
          MOVE      "otrlecrn",FIELDNAM
          MOVE      OTRLECRN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "GPFH Approval Number",CAPTTEXT
          MOVE      "otrlgpfh",FIELDNAM
          MOVE      OTRLGPFH,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "GP Practice Count",CAPTTEXT
          MOVE      "otrlgppt",FIELDNAM
          MOVE      OTRLGPPT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Operator who Recorded O/P Referral",CAPTTEXT
          MOVE      "otrloper",FIELDNAM
          MOVE      OTRLOPER,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Type of Referral",CAPTTEXT
          MOVE      "otrlctyp",FIELDNAM
          MOVE      OTRLCTYP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Site Code of Referral",CAPTTEXT
          MOVE      "otrlsite",FIELDNAM
          MOVE      OTRLSITE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Source of Referral",CAPTTEXT
          MOVE      "otrlsrce",FIELDNAM
          MOVE      OTRLSRCE,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "S ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Responsible HCP",CAPTTEXT
          MOVE      "otrlrhcp",FIELDNAM
          MOVE      OTRLRHCP,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OTRLDREC
          IF        !@EQUAL
            UNPACK    OTRLDREC,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Referral Received",CAPTTEXT
          MOVE      "otrldrec",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OTRLDPRI
          IF        !@EQUAL
            UNPACK    OTRLDPRI,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date of Priority",CAPTTEXT
          MOVE      "otrldpri",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Expected Purchaser",CAPTTEXT
          MOVE      "otrlpurc",FIELDNAM
          MOVE      OTRLPURC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "HP",CODECATG
          CALL      FRMT0000
.
          MOVE      "Referral Type",CAPTTEXT
          MOVE      "otrltref",FIELDNAM
          IF        OTRLTREF = 0
            MOVE      "Outpatient",DIM50
          ELSE      
            MOVE      "Other",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000 
.
          MOVE      "Patient Rank",CAPTTEXT
          MOVE      "otrlrank",FIELDNAM
          MOVE      OTRLRANK,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OTRLUDAT
          IF        !@EQUAL
            UNPACK    OTRLUDAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Record Updated",CAPTTEXT
          MOVE      "otrludat",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time Record Updated",CAPTTEXT
          MOVE      "otrlutim",FIELDNAM
          MOVE      OTRLUTIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Web User Id Updated",CAPTTEXT
          MOVE      "otrluuid",FIELDNAM
          MOVE      OTRLUUID,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OTRLCDAT
          IF        !@EQUAL
            UNPACK    OTRLCDAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Date Record Created",CAPTTEXT
          MOVE      "otrlcdat",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time Record Created",CAPTTEXT
          MOVE      "otrlctim",FIELDNAM
          MOVE      OTRLCTIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Web User Id Created",CAPTTEXT
          MOVE      "otrlcuid",FIELDNAM
          MOVE      OTRLCUID,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Claim Code",CAPTTEXT
          MOVE      "otrlclam",FIELDNAM
          MOVE      OTRLCLAM,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CL",CODECATG
          CALL      FRMT0000
.
          MOVE      ZERO,EXIT
          GOTO      LODR9999
.
LODR9500  DISPLAY   *P1:24,*EL,*B,"O/P Referral Holding file data not found.  ";
          CALL      HITENTER
          MOVE      ONE,EXIT
.
LODR9999  RETURN
+
.*****************************************************************************
.*                  LODO0000                           Called by : VINB0000  *
.*        Load the O/P details into the temporary file                       *
.*****************************************************************************
.
.         Read the O/P holding file data
.
LODO0000  MOVE      H7CIMESI,KEY20
          CALL      RDOTQUE1                     * record found ?
          BRANCH    OVRCD,LODO9500               * no - error
.
          MOVE      "O/P Data",DIM78
          RESET     DIM78
          PACK      DIM78,DIM78,SP80
          CALL      WLIN0000                     * write the data line
.
          MOVE      SP80,DIM78
          CALL      WLIN0000                     * write the data line
.
          MOVE      "Site",CAPTTEXT
          MOVE      "obasite",FIELDNAM
          MOVE      OBASITE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Id",CAPTTEXT
          MOVE      "obaclin",FIELDNAM
          MOVE      OBACLIN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OBADATE
          IF        !@EQUAL
            UNPACK    OBADATE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Booking Date",CAPTTEXT
          MOVE      "obadate",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Start Time",CAPTTEXT
          MOVE      "obastrt",FIELDNAM
          MOVE      OBASTRT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Slot No",CAPTTEXT
          MOVE      "obaslot",FIELDNAM
          MOVE      OBASLOT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Slot Time",CAPTTEXT
          MOVE      "obatime",FIELDNAM
          MOVE      OBATIME,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Type",CAPTTEXT
          MOVE      "obactyp",FIELDNAM
          MOVE      OBACTYP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Visit Type",CAPTTEXT
          MOVE      "obavisit",FIELDNAM
          MOVE      OBAVISIT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CV",CODECATG
          CALL      FRMT0000
.
          MOVE      "O/P No",CAPTTEXT
          MOVE      "obaoutno",FIELDNAM
          MOVE      OBAOUTNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      BOOKDES0,BOOKDESC
          LOAD      BOOKDESC,OBASTAT,BOOKDES1:
                                     BOOKDES2:
                                     BOOKDES3:
                                     BOOKDES4:
                                     BOOKDES5
          MOVE      "Slot Status",CAPTTEXT
          MOVE      "obastat",FIELDNAM
          MOVE      BOOKDESC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Session Status Code (Cat CS)",CAPTTEXT
          MOVE      "obasesst",FIELDNAM
          MOVE      OBASESST,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CS",CODECATG
          CALL      FRMT0000
.
          MOVE      "S ",CODECATG                * set defaults
          MOVE      "Source of Referral (Cat S)",CAPTTEXT
.
          MATCH     SP3,OBASITE                  * blank site code ?
          GOTO      LODO1000 IF EQUAL            * yes
.
          MOVE      OBASITE,KEY6
          CALL      RDSITA1                      * site code on file ?
          BRANCH    OVRCD,LODO1000               * yes
.
          MATCH     SP2,OSTCATG                  * src of ref category blank ?
          GOTO      LODO1000 IF EQUAL            * yes
.
          MOVE      OSTCATG,CODECATG             * load src of ref category
          MOVE      "Source of Referral (Cat ",CAPTTEXT
          ENDSET    CAPTTEXT
          STRIP     OSTCATG
          APPEND    OSTCATG,CAPTTEXT
          APPEND    ")",CAPTTEXT
          RESET     CAPTTEXT
.
LODO1000  MOVE      "obasrcr",FIELDNAM
          MOVE      OBASRCR,DIM50
          MOVE      ONE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Compensation Eligibility(Cat CL)",CAPTTEXT
          MOVE      "obacomp",FIELDNAM
          MOVE      OBACOMP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CL",CODECATG
          CALL      FRMT0000
.
          MOVE      "Patient Classification",CAPTTEXT
          MOVE      "obaclass",FIELDNAM
          MOVE      OBACLASS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "A ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Insurance Status",CAPTTEXT
          MOVE      "obains",FIELDNAM
          MOVE      OBAINS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "U1",CODECATG
          CALL      FRMT0000
.
          MOVE      "Attendance Code",CAPTTEXT
          MOVE      "obaattn",FIELDNAM
          MOVE      OBAATTN,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Doctor Code",CAPTTEXT
          MOVE      "obadoct",FIELDNAM
          MOVE      OBADOCT,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Comments",CAPTTEXT
          MOVE      "obacomm",FIELDNAM
          MOVE      OBACOMM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Health Fund Code",CAPTTEXT
          MOVE      "otbbfund",FIELDNAM
          MOVE      OTBBFUND,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Health Fund Table",CAPTTEXT
          MOVE      "otbbtble",FIELDNAM
          MOVE      OTBBTBLE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "No. of Prev. Visits Charged",CAPTTEXT
          MOVE      "otbbpvis",FIELDNAM
          MOVE      OTBBPVIS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Allocation (OX)",CAPTTEXT
          MOVE      "otbbclal",FIELDNAM
          MOVE      OTBBCLAL,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "OX",CODECATG
          CALL      FRMT0000
.
          MOVE      "Patient Category",CAPTTEXT
          MOVE      "obacat",FIELDNAM
          MOVE      OBACAT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "P ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Priority",CAPTTEXT
          MOVE      "obaprty",FIELDNAM
          MOVE      OBAPRTY,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "PR",CODECATG
          CALL      FRMT0000
.
          MOVE      "Reschedule Reason",CAPTTEXT
          MOVE      "obarschd",FIELDNAM
          MOVE      OBARSCHD,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "RR",CODECATG
          CALL      FRMT0000
.
          MOVE      "Non-booked Attendee Flag",CAPTTEXT
          MOVE      "obbbook",FIELDNAM
          MATCH     SP1,OBBBOOK
          IF        @EQUAL
            MOVE      "Booked attendee",DIM50
          ENDIF
          MATCH     ANSN,OBBBOOK
          IF        @EQUAL
            MOVE      "Non-booked attendee, no slot",DIM50
          ENDIF
          MATCH     ANSS,OBBBOOK
          IF        @EQUAL
            MOVE      "Non-booked attendee with slot",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "O/P User Defined Field 1",CAPTTEXT
          MOVE      "obousr1",FIELDNAM
          MOVE      OBOUSR1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "O1",CODECATG
          CALL      FRMT0000
.
          MOVE      "O/P User Defined Field 2",CAPTTEXT
          MOVE      "obousr2",FIELDNAM
          MOVE      OBOUSR2,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "O2",CODECATG
          CALL      FRMT0000
.
          MOVE      "O/P User Defined Field 3",CAPTTEXT
          MOVE      "obousr3",FIELDNAM
          MOVE      OBOUSR3,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "O3",CODECATG
          CALL      FRMT0000
.
          MOVE      "O/P User Defined Field 4",CAPTTEXT
          MOVE      "obousr4",FIELDNAM
          MOVE      OBOUSR4,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "O4",CODECATG
          CALL      FRMT0000
.
          MOVE      "Department Code",CAPTTEXT
          MOVE      "otbbdept",FIELDNAM
          MOVE      OTBBDEPT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "AC",CODECATG
          CALL      FRMT0000
.
          MOVE      "Transport Allocation",CAPTTEXT
          MOVE      "otbbtran",FIELDNAM
          MOVE      OTBBTRAN,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "OB",CODECATG
          CALL      FRMT0000
.
          MOVE      "Language of Interpreter",CAPTTEXT
          MOVE      "otbblngi",FIELDNAM
          MOVE      OTBBLNGI,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "OL",CODECATG
          CALL      FRMT0000
.
          MOVE      "Time First Seen",CAPTTEXT
          MOVE      "otbbtmfs",FIELDNAM
          MOVE      OTBBTMFS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time Booked Out",CAPTTEXT
          MOVE      "otbbtmbo",FIELDNAM
          MOVE      OTBBTMBO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "GPFH Approval No",CAPTTEXT
          MOVE      "otbbgpfa",FIELDNAM
          MOVE      OTBBGPFA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "ECR Approval No",CAPTTEXT
          MOVE      "otbbecra",FIELDNAM
          MOVE      OTBBECRA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring GP",CAPTTEXT
          MOVE      "otbbrfgp",FIELDNAM
          MOVE      OTBBRFGP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "GP Practice Code",CAPTTEXT
          MOVE      "otbbgppc",FIELDNAM
          MOVE      OTBBGPPC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Actual Doctor Seen",CAPTTEXT
          MOVE      "otbbadcs",FIELDNAM
          MOVE      OTBBADCS,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Check in Time",CAPTTEXT
          MOVE      "otbbcitm",FIELDNAM
          MOVE      OTBBCITM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time Actually Seen",CAPTTEXT
          MOVE      "otbbastm",FIELDNAM
          MOVE      OTBBASTM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time of Departure",CAPTTEXT
          MOVE      "otbbdptm",FIELDNAM
          MOVE      OTBBDPTM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Outcome",CAPTTEXT
          MOVE      "otbboutc",FIELDNAM
          MOVE      OTBBOUTC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "OZ",CODECATG
          CALL      FRMT0000
.
          MOVE      "District of Residence",CAPTTEXT
          MOVE      "otbbdofr",FIELDNAM
          MOVE      OTBBDOFR,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "DA",CODECATG
          CALL      FRMT0000
.
          MOVE      "O/P User Defined Field 5",CAPTTEXT
          MOVE      "obousr5",FIELDNAM
          MOVE      OBOUSR5,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "O5",CODECATG
          CALL      FRMT0000
.
          MOVE      "O/P User Defined Field 6",CAPTTEXT
          MOVE      "obousr6",FIELDNAM
          MOVE      OBOUSR6,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "O6",CODECATG
          CALL      FRMT0000
.
          MOVE      "O/P User Defined Field 7",CAPTTEXT
          MOVE      "obousr7",FIELDNAM
          MOVE      OBOUSR7,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "O7",CODECATG
          CALL      FRMT0000
.
          MOVE      "O/P User Defined Field 8",CAPTTEXT
          MOVE      "obousr8",FIELDNAM
          MOVE      OBOUSR8,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "O8",CODECATG
          CALL      FRMT0000
.
          MOVE      "Patient Rank",CAPTTEXT
          MOVE      "otbbrank",FIELDNAM
          MOVE      OTBBRANK,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Special Arrangements",CAPTTEXT
          MOVE      "otbbspca",FIELDNAM
          MOVE      OTBBSPCA,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "SA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Clinic Indicator (CI)",CAPTTEXT
          MOVE      "otbbcind",FIELDNAM
          MOVE      OTBBCIND,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CI",CODECATG
          CALL      FRMT0000
.
          MOVE      "Follow Up App. Made Flag (Y/N)",CAPTTEXT
          MOVE      "opdacsst",FIELDNAM
          MATCH     "1",OTBBFLUP
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Send Correspondence to Carer (Y/N)",CAPTTEXT
          MOVE      "opdascar",FIELDNAM
          MATCH     "1",OTBBSCAR
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OTBBGLDT
          IF        !@EQUAL
            UNPACK    OTBBGLDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Generate Letter Date",CAPTTEXT
          MOVE      "otbbgldt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Send Generate Letter (Y/N)",CAPTTEXT
          MOVE      "opdasngl",FIELDNAM
          MATCH     "1",OTBBSNGL
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MATCH     "2",OTBBSNGL
            IF        @EQUAL
              MOVE      "N/A",DIM50
            ELSE
              MOVE      "No",DIM50
            ENDIF
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "NMDS Code (Category NM)",CAPTTEXT
          MOVE      "otbbnmds",FIELDNAM
          MOVE      OTBBNMDS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "NM",CODECATG
          CALL      FRMT0000
.
          MOVE      "Care Type (Category CC)",CAPTTEXT
          MOVE      "otbbcart",FIELDNAM
          MOVE      OTBBCART,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CC",CODECATG
          CALL      FRMT0000
.
          MOVE      "Service Delivery Mode (Category sd)",CAPTTEXT
          MOVE      "otbbsrvd",FIELDNAM
          MOVE      OTBBSRVD,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "sd",CODECATG
          CALL      FRMT0000
.
          MOVE      "Clinical High Risk (Y/N)",CAPTTEXT
          MOVE      "opdaclhr",FIELDNAM
          MATCH     "1",OTBBCLHR
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Contract Code (Category gb)",CAPTTEXT
          MOVE      "otbbcont",FIELDNAM
          MOVE      OTBBcont,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "gb",CODECATG
          CALL      FRMT0000
.
          MOVE      "Tier 2 Code (Category NC)",CAPTTEXT
          MOVE      "otbbtcod",FIELDNAM
          MOVE      OTBBTCOD,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "NC",CODECATG
          CALL      FRMT0000
.
LODO1200  MOVE      "Health Purchaser (Category HP)",CAPTTEXT
          MOVE      "otbbpurc",FIELDNAM
          MOVE      OTBBPURC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "HP",CODECATG
          CALL      FRMT0000
.
          MOVE      "Site of booking",CAPTTEXT
          MOVE      "oprssite",FIELDNAM
          MOVE      OPRSSITE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Original Booking Clinic",CAPTTEXT
          MOVE      "oprsclin",FIELDNAM
          MOVE      OPRSCLIN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OPRSDATE
          IF        !@EQUAL
            UNPACK    OPRSDATE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Original Booking Date",CAPTTEXT
          MOVE      "oprsdate",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Original Session Start Time",CAPTTEXT
          MOVE      "oprsstrt",FIELDNAM
          MOVE      OPRSSTRT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Original Session Slot No",CAPTTEXT
          MOVE      "oprsslot",FIELDNAM
          MOVE      OPRSSLOT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Original Session Slot Time",CAPTTEXT
          MOVE      "oprstime",FIELDNAM
          MOVE      OPRSTIME,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Outpatient number rescheduled",CAPTTEXT
          MOVE      "oprsoutn",FIELDNAM
          MOVE      OPRSOUTN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Reschedule Reason",CAPTTEXT
          MOVE      "oprsreas",FIELDNAM
          MOVE      OPRSREAS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "RR",CODECATG
          CALL      FRMT0000
.
          MOVE      "Clinic of New Booking",CAPTTEXT
          MOVE      "oprsncli",FIELDNAM
          MOVE      OPRSNCLI,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OPRSNDAT
          IF        !@EQUAL
            UNPACK    OPRSNDAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date of New Booking",CAPTTEXT
          MOVE      "oprsndat",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "New Session Start Time",CAPTTEXT
          MOVE      "oprsnstr",FIELDNAM
          MOVE      OPRSNSTR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "New Session Slot No",CAPTTEXT
          MOVE      "oprsnslo",FIELDNAM
          MOVE      OPRSNSLO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "New Session Slot Time",CAPTTEXT
          MOVE      "oprsntim",FIELDNAM
          MOVE      OPRSNTIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "New Visit Type  (Cat CV)",CAPTTEXT
          MOVE      "oprsnvis",FIELDNAM
          MOVE      OPRSNVIS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CV",CODECATG
          CALL      FRMT0000
.
          MOVE      "New Clinic Type",CAPTTEXT
          MOVE      "oprsntyp",FIELDNAM
          MOVE      OPRSNTYP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Old Visit Type  (Cat CV)",CAPTTEXT
          MOVE      "oprsvist",FIELDNAM
          MOVE      OPRSVIST,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CV",CODECATG
          CALL      FRMT0000
.
          MOVE      "Old Clinic Type",CAPTTEXT
          MOVE      "oprsctyp",FIELDNAM
          MOVE      OPRSCTYP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Site of Cancelled Booking",CAPTTEXT
          MOVE      "opcnsite",FIELDNAM
          MOVE      OPCNSITE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic of Cancelled Booking",CAPTTEXT
          MOVE      "opcnclin",FIELDNAM
          MOVE      OPCNCLIN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OPCNDATE
          IF        !@EQUAL
            UNPACK    OPCNDATE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date of Cancelled Booking",CAPTTEXT
          MOVE      "opcndate",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Cancelled Session Start Time",CAPTTEXT
          MOVE      "opcnstrt",FIELDNAM
          MOVE      OPCNSTRT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Cancelled Session Slot No",CAPTTEXT
          MOVE      "opcnslot",FIELDNAM
          MOVE      OPCNSLOT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Cancelled Session Slot Time",CAPTTEXT
          MOVE      "opcntime",FIELDNAM
          MOVE      OPCNTIME,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Outpatient number cancelled",CAPTTEXT
          MOVE      "opcnoutn",FIELDNAM
          MOVE      OPCNOUTN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Cancellation Reason",CAPTTEXT
          MOVE      "opcnreas",FIELDNAM
          MOVE      OPCNREAS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CB",CODECATG
          CALL      FRMT0000
.
          MOVE      "Visit Type of Booking",CAPTTEXT
          MOVE      "opcnvtyp",FIELDNAM
          MOVE      OPCNVTYP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CV",CODECATG
          CALL      FRMT0000
.
          MOVE      "Location Type (Category CT)",CAPTTEXT
          MOVE      "otmaltyp",FIELDNAM
          MOVE      OTMALTYP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CT",CODECATG
          CALL      FRMT0000
.
          MOVE      OSTATDE0,OSTADESC
          LOAD      OSTADESC,OBASTAT,OSTATDE1,OSTATDE2,OSTATDE3,OSTATDE4:
                                     OSTATDE5,OSTATDE6,OSTATDE7,OSTATDE8:
                                     OSTATDE9
          MOVE      "Booking Status",CAPTTEXT
          MOVE      "obastat",FIELDNAM
          MOVE      OSTADESC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      ZERO,EXIT
          GOTO      LODO9999
.
LODO9500  DISPLAY   *P1:24,*EL,*B,"O/P Holding file data not found.  ";
          CALL      HITENTER
          MOVE      ONE,EXIT
.
LODO9999  RETURN
+
.*****************************************************************************
.*                  LODP0000                           Called by : VINB0000  *
.*        Load the PMI details into the temporary file                       *
.*****************************************************************************
.
.         Read the PMI holding file data
.
LODP0000  MOVE      H7CIMESI,KEY20
          CALL      RDPMQPT1                     * record found ?
          BRANCH    OVRCD,LODP9500               * no - error
.
          MOVE      "PMI Data",DIM78
          RESET     DIM78
          PACK      DIM78,DIM78,SP80
          CALL      WLIN0000                     * write the data line
.
          MOVE      SP80,DIM78
          CALL      WLIN0000                     * write the data line
.
          MOVE      "U/R No",CAPTTEXT
          MOVE      "purno",FIELDNAM
          MOVE      PURNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Old U/R No",CAPTTEXT
          MOVE      "purno",FIELDNAM
          MOVE      PMQPOURN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Alias Status",CAPTTEXT
          MOVE      "csalias",FIELDNAM
          MOVE      CSALIAS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Title",CAPTTEXT
          MOVE      "ptitl",FIELDNAM
          MOVE      PTITL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      DNO,DIM3
          LOAD      DIM3,PHOSP,DYES,DNO
          MOVE      "Hospital Last 12 mths",CAPTTEXT
          MOVE      "phosp",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "No. Days Last in Hospital",CAPTTEXT
          MOVE      "pldays",FIELDNAM
          MOVE      PLDAYS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      DNO,DIM3
          LOAD      DIM3,PBDEBT,DYES,DNO
          MOVE      "Bad Debtor",CAPTTEXT
          MOVE      "pbdebt",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Surname",CAPTTEXT
          MOVE      "psname",FIELDNAM
          MOVE      PSNAME,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Given Name",CAPTTEXT
          MOVE      "pgname",FIELDNAM
          MOVE      PGNAME,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Previous Surname",CAPTTEXT
          MOVE      "ppsname",FIELDNAM
          MOVE      PPSNAME,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Address Line 1",CAPTTEXT
          MOVE      "padd1",FIELDNAM
          MOVE      PADD1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Address Line 2",CAPTTEXT
          MOVE      "padd2",FIELDNAM
          MOVE      PADD2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Suburb",CAPTTEXT
          MOVE      "psubrb",FIELDNAM
          MOVE      PSUBRB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Address Line 4",CAPTTEXT
          MOVE      "padd4",FIELDNAM
          MOVE      PADD4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Postcode",CAPTTEXT
          MOVE      "ppost",FIELDNAM
          MOVE      PPOST,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Home Telephone",CAPTTEXT
          MOVE      "ptelep",FIELDNAM
          MOVE      PTELEP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Bus. Telephone",CAPTTEXT
          MOVE      "pteleb",FIELDNAM
          MOVE      PTELEB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      PSEX,ANS
          REP       "M1F2I3U4R5",ANS
          MOVE      ANS,FORM1
          LOAD      PSEXDESC,FORM1,PSEXMALE,PSEXFEML,PSEXINDT,PSEXUNKN,PSEXINTR
          MOVE      "Sex",CAPTTEXT
          MOVE      "psex",FIELDNAM
          MOVE      PSEXDESC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Marital Status",CAPTTEXT
          MOVE      "pmstat",FIELDNAM
          MOVE      PMSTAT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "M ",CODECATG
          CALL      FRMT0000
.
          UNPACK    PBDATE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      "Date of Birth",CAPTTEXT
          MOVE      "pbdate",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Country of Birth",CAPTTEXT
          MOVE      "pcont",FIELDNAM
          MOVE      PCONT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "C ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Religion",CAPTTEXT
          MOVE      "preg",FIELDNAM
          MOVE      PREG,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "R ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Patient Type",CAPTTEXT
          MOVE      "ptype",FIELDNAM
          MOVE      PTYPE,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "T ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Occupation",CAPTTEXT
          MOVE      "poccup",FIELDNAM
          MOVE      POCCUP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PLDDATE
          IF        !@EQUAL
            UNPACK    PLDDATE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Last Discharge Date",CAPTTEXT
          MOVE      "plddate",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Medicare Number",CAPTTEXT
          MOVE      "pmedi",FIELDNAM
          MOVE      PMEDI,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Pension Number",CAPTTEXT
          MOVE      "ppenno",FIELDNAM
          MOVE      PPENNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP7,DIM7
          MATCH     SP6,PPNDTE
          IF        !@EQUAL
            UNPACK    PPNDTE,DIM4,DIM2
            PACK      DIM7,DIM4,SLASH,DIM2
          ENDIF
          MOVE      "Pension No. Expiry Date",CAPTTEXT
          MOVE      "ppndte",FIELDNAM
          MOVE      DIM7,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Repatriation Number",CAPTTEXT
          MOVE      "prepat",FIELDNAM
          MOVE      PREPAT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      DNO,DIM3
          LOAD      DIM3,PSMOK,DYES,DNO
          MOVE      "Smoker",CAPTTEXT
          MOVE      "psmok",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Microfilm Address",CAPTTEXT
          MOVE      "pmicro",FIELDNAM
          MOVE      PMICRO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      DNO,DIM3
          LOAD      DIM3,PCEASE,DYES,DNO
          MOVE      "Deceased",CAPTTEXT
          MOVE      "pcease",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      DNO,DIM3
          LOAD      DIM3,PCASE,DYES,DNO
          MOVE      "Case Notes",CAPTTEXT
          MOVE      "pcase",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      DNO,DIM3
          LOAD      DIM3,PAUTOPY,DYES,DNO
          MOVE      "Autopsy",CAPTTEXT
          MOVE      "pautopy",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Highlight Code 1",CAPTTEXT
          MOVE      "phigh1",FIELDNAM
          MOVE      PHIGH1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "H1",CODECATG
          CALL      FRMT0000
.
          MOVE      "Highlight Code 2",CAPTTEXT
          MOVE      "phigh2",FIELDNAM
          MOVE      PHIGH2,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "H2",CODECATG
          CALL      FRMT0000
.
          MOVE      "Highlight Code 3",CAPTTEXT
          MOVE      "phigh3",FIELDNAM
          MOVE      PHIGH3,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "H3",CODECATG
          CALL      FRMT0000
.
          MOVE      "Local Doctor",CAPTTEXT
          MOVE      "plocdoc",FIELDNAM
          MOVE      PLOCDOC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Health Fund",CAPTTEXT
          MOVE      "pfundh",FIELDNAM
          MOVE      PFUNDH,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Health Fund Table",CAPTTEXT
          MOVE      "pfndtb",FIELDNAM
          MOVE      PFNDTB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Health Fund Membership No",CAPTTEXT
          MOVE      "pfndmm",FIELDNAM
          MOVE      PFNDMM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Field 1",CAPTTEXT
          MOVE      "pusr1",FIELDNAM
          MOVE      PUSR1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "P1",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 2",CAPTTEXT
          MOVE      "pusr2",FIELDNAM
          MOVE      PUSR2,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "P2",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 3",CAPTTEXT
          MOVE      "pusr3",FIELDNAM
          MOVE      PUSR3,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "P3",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 4",CAPTTEXT
          MOVE      "pusr4",FIELDNAM
          MOVE      PUSR4,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "P4",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 5",CAPTTEXT
          MOVE      "pusr5",FIELDNAM
          MOVE      PUSR5,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "P5",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 6",CAPTTEXT
          MOVE      "pusr6",FIELDNAM
          MOVE      PUSR6,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "P6",CODECATG
          CALL      FRMT0000
.
          MOVE      DNO,DIM3
          LOAD      DIM3,PUYN1,DYES,DNO
          MOVE      "User Defined Y/N Field 1",CAPTTEXT
          MOVE      "puyn1",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      DNO,DIM3
          LOAD      DIM3,PUYN2,DYES,DNO
          MOVE      "User Defined Y/N Field 2",CAPTTEXT
          MOVE      "puyn2",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      DNO,DIM3
          LOAD      DIM3,PUYN3,DYES,DNO
          MOVE      "User Defined Y/N Field 3",CAPTTEXT
          MOVE      "puyn3",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Number of Years Resident",CAPTTEXT
          MOVE      "pyrres",FIELDNAM
          MOVE      PYRRES,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Next of Kin Name",CAPTTEXT
          MOVE      "pnkname",FIELDNAM
          MOVE      PNKNAME,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "NoK Address Line 1",CAPTTEXT
          MOVE      "pnkadd1",FIELDNAM
          MOVE      PNKADD1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "NoK Address Line 2",CAPTTEXT
          MOVE      "pnkadd2",FIELDNAM
          MOVE      PNKADD2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "NoK Suburb",CAPTTEXT
          MOVE      "pnksubr",FIELDNAM
          MOVE      PNKSUBR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "NoK Address Line 4",CAPTTEXT
          MOVE      "pnkadd4",FIELDNAM
          MOVE      PNKADD4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "NoK Postcode",CAPTTEXT
          MOVE      "pnkpost",FIELDNAM
          MOVE      PNKPOST,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "NoK Private Telephone",CAPTTEXT
          MOVE      "pnktelp",FIELDNAM
          MOVE      PNKTELP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "NoK Business Telephone",CAPTTEXT
          MOVE      "pnktelb",FIELDNAM
          MOVE      PNKTELB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "NoK Relationship",CAPTTEXT
          MOVE      "pnkrelp",FIELDNAM
          MOVE      PNKRELP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Years Health Fund Membership",CAPTTEXT
          MOVE      "pfndyy",FIELDNAM
          MOVE      PFNDYY,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP7,DIM7
          MATCH     SP6,PFNDCG
          IF        !@EQUAL
            UNPACK    PFNDCG,DIM4,DIM2
            PACK      DIM7,DIM4,SLASH,DIM2
          ENDIF
          MOVE      "Health Fund Cover Change",CAPTTEXT
          MOVE      "pfndcg",FIELDNAM
          MOVE      DIM7,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PDECDTE
          IF        !@EQUAL
            UNPACK    PDECDTE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date of Death",CAPTTEXT
          MOVE      "pdecdte",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Default Diet Code",CAPTTEXT
          MOVE      "pdiet",FIELDNAM
          MOVE      PDIET,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "DC",CODECATG
          CALL      FRMT0000
.
          MOVE      "Hospital U/R Initiated From",CAPTTEXT
          MOVE      "pinithos",FIELDNAM
          MOVE      PINITHOS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Hong Kong Unique Address ID",CAPTTEXT
          MOVE      "phkaduni",FIELDNAM
          MOVE      PHKADUNI,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient Employer Code",CAPTTEXT
          MOVE      "ptmaempc",FIELDNAM
          MOVE      PTMAEMPC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Next Of Kin Occupation",CAPTTEXT
          MOVE      "ptmanoko",FIELDNAM
          MOVE      PTMANOKO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Next Of Kin Employer Code",CAPTTEXT
          MOVE      "ptmanoke",FIELDNAM
          MOVE      PTMANOKE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Death Certificate Number",CAPTTEXT
          MOVE      "ptmadcno",FIELDNAM
          MOVE      PTMADCNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PTMXRDAT
          IF        !@EQUAL
            UNPACK    PTMXRDAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Registration Date",CAPTTEXT
          MOVE      "ptmxrdat",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Special Meal Requirements",CAPTTEXT
          MOVE      "ptmxmeal",FIELDNAM
          MOVE      PTMXMEAL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "LGA Code",CAPTTEXT
          MOVE      "ptmxlga",FIELDNAM
          MOVE      PTMXLGA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Current Legal status (Cat LS)",CAPTTEXT
          MOVE      "ptmxls",FIELDNAM
          MOVE      PTMXLS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "LS",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PTMXLSDT
          IF        !@EQUAL
            UNPACK    PTMXLSDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date of legal status (ccyymmdd)",CAPTTEXT
          MOVE      "ptmxlsdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      DNO,DIM3
          MOVE      PTMXFHMD,FORM1
          LOAD      DIM3,FORM1,DYES,DNO
          MOVE      "Family hist. of mental disorder?",CAPTTEXT
          MOVE      "ptmxfhmd",FIELDNAM
          MOVE      DIM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "M.H. User def. field 1 (Cat V6)",CAPTTEXT
          MOVE      "ptmxmhu1",FIELDNAM
          MOVE      PTMXMHU1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "V6",CODECATG
          CALL      FRMT0000
.
          MOVE      "M.H. User def. field 2 (Cat V7)",CAPTTEXT
          MOVE      "ptmxmhu2",FIELDNAM
          MOVE      PTMXMHU2,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "V7",CODECATG
          CALL      FRMT0000
.
          MOVE      "M.H. User def. field 3 (Cat V8)",CAPTTEXT
          MOVE      "ptmxmhu3",FIELDNAM
          MOVE      PTMXMHU3,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "V8",CODECATG
          CALL      FRMT0000
.
          MOVE      "Emergency contact name",CAPTTEXT
          MOVE      "ptmxecnm",FIELDNAM
          MOVE      PTMXECNM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Emergency contact address line 1",CAPTTEXT
          MOVE      "ptmxeca1",FIELDNAM
          MOVE      PTMXECA1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Emergency contact address line 2",CAPTTEXT
          MOVE      "ptmxeca2",FIELDNAM
          MOVE      PTMXECA2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Emergency contact address line 3",CAPTTEXT
          MOVE      "ptmxeca3",FIELDNAM
          MOVE      PTMXECA3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Emergency contact address line 4",CAPTTEXT
          MOVE      "ptmxeca4",FIELDNAM
          MOVE      PTMXECA4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Emergency contact postcode",CAPTTEXT
          MOVE      "ptmxecpc",FIELDNAM
          MOVE      PTMXECPC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Emergency contact private phone",CAPTTEXT
          MOVE      "ptmxecpp",FIELDNAM
          MOVE      PTMXECPP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Emergency contact business phone",CAPTTEXT
          MOVE      "ptmxecbp",FIELDNAM
          MOVE      PTMXECBP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Emergency contact relationship",CAPTTEXT
          MOVE      "ptmxecre",FIELDNAM
          MOVE      PTMXECRE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Nearest relative name",CAPTTEXT
          MOVE      "ptmxnrnm",FIELDNAM
          MOVE      PTMXNRNM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Nearest relative address line 1",CAPTTEXT
          MOVE      "ptmxnra1",FIELDNAM
          MOVE      PTMXNRA1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Nearest relative address line 2",CAPTTEXT
          MOVE      "ptmxnra2",FIELDNAM
          MOVE      PTMXNRA2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Nearest relative address line 3",CAPTTEXT
          MOVE      "ptmxnra3",FIELDNAM
          MOVE      PTMXNRA3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Nearest relative address line 4",CAPTTEXT
          MOVE      "ptmxnra4",FIELDNAM
          MOVE      PTMXNRA4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Nearest relative postcode",CAPTTEXT
          MOVE      "ptmxnrpc",FIELDNAM
          MOVE      PTMXNRPC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Nearest relative private phone",CAPTTEXT
          MOVE      "ptmxnrpp",FIELDNAM
          MOVE      PTMXNRPP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Nearest relative business phone",CAPTTEXT
          MOVE      "ptmxnrbp",FIELDNAM
          MOVE      PTMXNRBP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Nearest relative relationship",CAPTTEXT
          MOVE      "ptmxnrre",FIELDNAM
          MOVE      PTMXNRRE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PTMX3BEX
          IF        !@EQUAL
            UNPACK    PTMX3BEX,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "3B certificate expiry date",CAPTTEXT
          MOVE      "ptmx3bex",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Card number (NZ billing)",CAPTTEXT
          MOVE      "ptmxcard",FIELDNAM
          MOVE      PTMXCARD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PTMXCEXP
          IF        !@EQUAL
            UNPACK    PTMXCEXP,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Card expiry date (NZ billing)",CAPTTEXT
          MOVE      "ptmxcexp",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Card exemption type (Cat XM)",CAPTTEXT
          MOVE      "ptmxcxmp",FIELDNAM
          MOVE      PTMXCXMP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "XM",CODECATG
          CALL      FRMT0000
.
          MOVE      "Family id",CAPTTEXT
          MOVE      "ptmxfmly",FIELDNAM
          MOVE      PTMXFMLY,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Chinese Name",CAPTTEXT
          MOVE      "ptmxchnm",FIELDNAM
          MOVE      PTMXCHNM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "District of Residence (Cat DA)",CAPTTEXT
          MOVE      "ptmxdofr",FIELDNAM
          MOVE      PTMXDOFR,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "DA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Registered GP",CAPTTEXT
          MOVE      "ptmxregp",FIELDNAM
          MOVE      PTMXREGP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "GP Practice Code",CAPTTEXT
          MOVE      "ptmxgppc",FIELDNAM
          MOVE      PTMXGPPC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Supplementary Id",CAPTTEXT
          MOVE      "ptmxspid",FIELDNAM
          MOVE      PTMXSPID,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "GP Practice count",CAPTTEXT
          MOVE      "ptmxgppt",FIELDNAM
          MOVE      PTMXGPPT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PTMXOSDT
          IF        !@EQUAL
            UNPACK    PTMXOSDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Arrived from O/S (CCYYMMDD)",CAPTTEXT
          MOVE      "ptmxosdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "National ID No.",CAPTTEXT
          MOVE      "ptninmpi",FIELDNAM
          MOVE      PTNINMPI,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Surname",CAPTTEXT
          MOVE      "nhmasurn",FIELDNAM
          MOVE      NHMASURN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Given Name 1",CAPTTEXT
          MOVE      "nhmagiv1",FIELDNAM
          MOVE      NHMAGIV1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Given Name 2",CAPTTEXT
          MOVE      "nhmagiv2",FIELDNAM
          MOVE      NHMAGIV2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Given Name 3",CAPTTEXT
          MOVE      "nhmagiv3",FIELDNAM
          MOVE      NHMAGIV3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Preferred Name Indicator (1-3)",CAPTTEXT
          MOVE      "nhmaprei",FIELDNAM
          MOVE      NHMAPREI,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Address Line 1",CAPTTEXT
          MOVE      "nhmaadd1",FIELDNAM
          MOVE      NHMAADD1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Address Line 2",CAPTTEXT
          MOVE      "nhmaadd2",FIELDNAM
          MOVE      NHMAADD2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Suburb",CAPTTEXT
          MOVE      "nhmaadd3",FIELDNAM
          MOVE      NHMAADD3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "City/Town",CAPTTEXT
          MOVE      "nhmaadd4",FIELDNAM
          MOVE      NHMAADD4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Country",CAPTTEXT
          MOVE      "nhmaadd5",FIELDNAM
          MOVE      NHMAADD5,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,NHMADOB
          IF        !@EQUAL
            UNPACK    NHMADOB,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date of Birth",CAPTTEXT
          MOVE      "nhmadob",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,NHMADDTH
          IF        !@EQUAL
            UNPACK    NHMADDTH,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date of Death",CAPTTEXT
          MOVE      "nhmaddth",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Domicile Code",CAPTTEXT
          MOVE      "nhmadomc",FIELDNAM
          MOVE      NHMADOMC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Residence Status (Y/N)",CAPTTEXT
          MOVE      "nhmares",FIELDNAM
          MOVE      NHMARES,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Ethnicity",CAPTTEXT
          MOVE      "nhmaeth",FIELDNAM
          MOVE      NHMAETH,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Gender",CAPTTEXT
          MOVE      "nhmasex",FIELDNAM
          MOVE      NHMASEX,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,NHMADAT
          IF        !@EQUAL
            UNPACK    NHMADAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Last Updated",CAPTTEXT
          MOVE      "nhmadat",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,NHMATIM
          IF        !@EQUAL
            UNPACK    NHMATIM,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Time Last Updated",CAPTTEXT
          MOVE      "nhmatim",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "2nd Ethnicity",CAPTTEXT
          MOVE      "nhmaeth2",FIELDNAM
          MOVE      NHMAETH2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "3rd Ethnicity",CAPTTEXT
          MOVE      "nhmaeth3",FIELDNAM
          MOVE      NHMAETH2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Operator Code who Created Record",CAPTTEXT
          MOVE      "ptmxoper",FIELDNAM
          MOVE      PTMXOPER,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Unknown Date Arrvd from O/S(Y/N)",CAPTTEXT
          MOVE      "ptmxukdo",FIELDNAM
          MOVE      PTMXUKDO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Cellular Phone Number",CAPTTEXT
          MOVE      "ptmxcell",FIELDNAM
          MOVE      PTMXCELL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Postal Address Line 1",CAPTTEXT
          MOVE      "ptmxadd1",FIELDNAM
          MOVE      PTMXADD1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Postal Address Line 2",CAPTTEXT
          MOVE      "ptmxadd2",FIELDNAM
          MOVE      PTMXADD2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Postal Address Line 3",CAPTTEXT
          MOVE      "ptmxadd3",FIELDNAM
          MOVE      PTMXADD3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Postal Address Line 4",CAPTTEXT
          MOVE      "ptmxadd4",FIELDNAM
          MOVE      PTMXADD4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Postal Address Post Code",CAPTTEXT
          MOVE      "ptmxpost",FIELDNAM
          MOVE      PTMXPOST,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Interpreter Reqd? (0=NO,1=YES)",CAPTTEXT
          MOVE      "pmpxintr",FIELDNAM
          MOVE      PMPXINTR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Preferred Language 1 (Cat LA)",CAPTTEXT
          MOVE      "pmpxlng1",FIELDNAM
          MOVE      PMPXLNG1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "LA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Preferred Language 2 (Cat LA)",CAPTTEXT
          MOVE      "pmpxlng2",FIELDNAM
          MOVE      PMPXLNG2,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "LA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Preferred Language 3 (Cat LA)",CAPTTEXT
          MOVE      "pmpxlng3",FIELDNAM
          MOVE      PMPXLNG3,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "LA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Patient's Email Address",CAPTTEXT
          MOVE      "pmpxpeml",FIELDNAM
          MOVE      PMPXPEML,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Date of Birth Estimated? 0=N,1=Y",CAPTTEXT
          MOVE      "pmpxedob",FIELDNAM
          MOVE      PMPXEDOB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Emergency Contact Mobile Number",CAPTTEXT
          MOVE      "pmpxcmob",FIELDNAM
          MOVE      PMPXCMOB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Emergency Contact Email Address",CAPTTEXT
          MOVE      "pmpxceml",FIELDNAM
          MOVE      PMPXCEML,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Emer. Contact Corres. (0=N,1=Y)",CAPTTEXT
          MOVE      "pmpxccrp",FIELDNAM
          MOVE      PMPXCCRP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "NOK Mobile Number",CAPTTEXT
          MOVE      "pmpxkmob",FIELDNAM
          MOVE      PMPXKMOB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "NOK Email Address",CAPTTEXT
          MOVE      "pmpxkeml",FIELDNAM
          MOVE      PMPXKEML,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "NOK Correspondence (0=NO,1=YES)",CAPTTEXT
          MOVE      "pmpxkcrp",FIELDNAM
          MOVE      PMPXKCRP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Nearest Relative Mobile Number",CAPTTEXT
          MOVE      "pmpxrmob",FIELDNAM
          MOVE      PMPXRMOB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Nearest Relative Email Address",CAPTTEXT
          MOVE      "pmpxreml",FIELDNAM
          MOVE      PMPXREML,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Nearest Relative Corres 0=N,1=Y",CAPTTEXT
          MOVE      "pmpxrcrp",FIELDNAM
          MOVE      PMPXRCRP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMPXMEDC
          IF        !@EQUAL
            UNPACK    PMPXMEDC,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Medicare Card Valid to(CCYYMMDD)",CAPTTEXT
          MOVE      "pmpxmedc",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Death Type (Cat DY)",CAPTTEXT
          MOVE      "pmpxdety",FIELDNAM
          MOVE      PMPXDETY,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "DY",CODECATG
          CALL      FRMT0000
.
          MOVE      "PRISM Number",CAPTTEXT
          MOVE      "pmpxpris",FIELDNAM
          MOVE      PMPXPRIS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Correctional Services Number",CAPTTEXT
          MOVE      "pmpxcser",FIELDNAM
          MOVE      PMPXCSER,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient Height",CAPTTEXT
          MOVE      "pmpxphei",FIELDNAM
          MOVE      PMPXPHEI,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient Weight",CAPTTEXT
          MOVE      "pmpxpwei",FIELDNAM
          MOVE      PMPXPWEI,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMPXDREC
          IF        !@EQUAL
            UNPACK    PMPXDREC,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Weight/Height Rec(CCYYMMDD)",CAPTTEXT
          MOVE      "pmpxdrec",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "DVA Card Colour (Cat DX)",CAPTTEXT
          MOVE      "pmpxdvac",FIELDNAM
          MOVE      PMPXDVAC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "DX",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMPXPNSD
          IF        !@EQUAL
            UNPACK    PMPXPNSD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Pension Start Date (CCYYMMDD)",CAPTTEXT
          MOVE      "pmpxpnsd",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def. Y/N field 4 0=NO,1=YES",CAPTTEXT
          MOVE      "pmpxuyn4",FIELDNAM
          MOVE      PMPXUYN4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def. Y/N field 5 0=NO,1=YES",CAPTTEXT
          MOVE      "pmpxuyn5",FIELDNAM
          MOVE      PMPXUYN5,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def. Y/N field 6 0=NO,1=YES",CAPTTEXT
          MOVE      "pmpxuyn6",FIELDNAM
          MOVE      PMPXUYN6,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Aboriginality (Cat VA)",CAPTTEXT
          MOVE      "pmpxabrg",FIELDNAM
          MOVE      PMPXABRG,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "VA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Privacy Indicator (Cat PV)",CAPTTEXT
          MOVE      "pmpxprvi",FIELDNAM
          MOVE      PMPXPRVI,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "PV",CODECATG
          CALL      FRMT0000
.
          MOVE      "Consent Rel. of Info? 0=NO,1=YES",CAPTTEXT
          MOVE      "pmpxcrin",FIELDNAM
          MOVE      PMPXCRIN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Homeless? (0=NO,1=YES)",CAPTTEXT
          MOVE      "pmpxhoml",FIELDNAM
          MOVE      PMPXHOML,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Comments 1",CAPTTEXT
          MOVE      "pmpxudc1",FIELDNAM
          MOVE      PMPXUDC1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Comments 2",CAPTTEXT
          MOVE      "pmpxudc2",FIELDNAM
          MOVE      PMPXUDC2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Comments 3",CAPTTEXT
          MOVE      "pmpxudc3",FIELDNAM
          MOVE      PMPXUDC3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined 7 (Category P7)",CAPTTEXT
          MOVE      "pmpxusr7",FIELDNAM
          MOVE      PMPXUSR7,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "P7",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined 8 (Category P8)",CAPTTEXT
          MOVE      "pmpxusr8",FIELDNAM
          MOVE      PMPXUSR8,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "P8",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined 9 (Category P9)",CAPTTEXT
          MOVE      "pmpxusr9",FIELDNAM
          MOVE      PMPXUSR9,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "P9",CODECATG
          CALL      FRMT0000
.
          MOVE      "Mother's Surname",CAPTTEXT
          MOVE      "pmpxmsna",FIELDNAM
          MOVE      PMPXMSNA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mother's Given Name",CAPTTEXT
          MOVE      "pmpxmgna",FIELDNAM
          MOVE      PMPXMGNA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mother's Title",CAPTTEXT
          MOVE      "pmpxmtle",FIELDNAM
          MOVE      PMPXMTLE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mother's Address Line 1",CAPTTEXT
          MOVE      "pmpxmad1",FIELDNAM
          MOVE      PMPXMAD1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mother's Address Line 2",CAPTTEXT
          MOVE      "pmpxmad2",FIELDNAM
          MOVE      PMPXMAD2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mother's Address Line 3",CAPTTEXT
          MOVE      "pmpxmad3",FIELDNAM
          MOVE      PMPXMAD3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mother's Address Line 4",CAPTTEXT
          MOVE      "pmpxmad4",FIELDNAM
          MOVE      PMPXMAD4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mother's Address Post Code",CAPTTEXT
          MOVE      "pmpxmpos",FIELDNAM
          MOVE      PMPXMPOS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mother's Private Number",CAPTTEXT
          MOVE      "pmpxmpno",FIELDNAM
          MOVE      PMPXMPNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mother's Business Number",CAPTTEXT
          MOVE      "pmpxmbno",FIELDNAM
          MOVE      PMPXMBNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mother's Mobile Number",CAPTTEXT
          MOVE      "pmpxmmno",FIELDNAM
          MOVE      PMPXMMNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mother's Email Address",CAPTTEXT
          MOVE      "pmpxmeml",FIELDNAM
          MOVE      PMPXMEML,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mother's Country of Birth(Cat C)",CAPTTEXT
          MOVE      "pmpxmcnt",FIELDNAM
          MOVE      PMPXMCNT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "C ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Mother's Correspondence 0=N,1=Y",CAPTTEXT
          MOVE      "pmpxmcrp",FIELDNAM
          MOVE      PMPXMCRP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mother's Name on Labels 0=N,1=Y",CAPTTEXT
          MOVE      "pmpxmlab",FIELDNAM
          MOVE      PMPXMLAB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Relationship to Patient",CAPTTEXT
          MOVE      "pmpxmrel",FIELDNAM
          MOVE      PMPXMREL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Father's Surname",CAPTTEXT
          MOVE      "pmpxfsna",FIELDNAM
          MOVE      PMPXFSNA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Father's Given Name",CAPTTEXT
          MOVE      "pmpxfgna",FIELDNAM
          MOVE      PMPXFGNA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Father's Title",CAPTTEXT
          MOVE      "pmpxftle",FIELDNAM
          MOVE      PMPXFTLE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Father's Address Line 1",CAPTTEXT
          MOVE      "pmpxfad1",FIELDNAM
          MOVE      PMPXFAD1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Father's Address Line 2",CAPTTEXT
          MOVE      "pmpxfad2",FIELDNAM
          MOVE      PMPXFAD2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Father's Address Line 3",CAPTTEXT
          MOVE      "pmpxfad3",FIELDNAM
          MOVE      PMPXFAD3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Father's Address Line 4",CAPTTEXT
          MOVE      "pmpxfad4",FIELDNAM
          MOVE      PMPXFAD4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Father's Address Post Code",CAPTTEXT
          MOVE      "pmpxfpos",FIELDNAM
          MOVE      PMPXFPOS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Father's Private Number",CAPTTEXT
          MOVE      "pmpxfpno",FIELDNAM
          MOVE      PMPXFPNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Father's Business Number",CAPTTEXT
          MOVE      "pmpxfbno",FIELDNAM
          MOVE      PMPXFBNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Father's Mobile Number",CAPTTEXT
          MOVE      "pmpxfmno",FIELDNAM
          MOVE      PMPXFMNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Father's Email Address",CAPTTEXT
          MOVE      "pmpxfeml",FIELDNAM
          MOVE      PMPXFEML,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Father's Country of Birth(Cat C)",CAPTTEXT
          MOVE      "pmpxfcnt",FIELDNAM
          MOVE      PMPXFCNT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "C ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Father's Correspondence 0=N,1=Y",CAPTTEXT
          MOVE      "pmpxfcrp",FIELDNAM
          MOVE      PMPXFCRP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Father's Name on Labels 0=N,1=Y",CAPTTEXT
          MOVE      "pmpxflab",FIELDNAM
          MOVE      PMPXFLAB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Relationship to Patient",CAPTTEXT
          MOVE      "pmpxfrel",FIELDNAM
          MOVE      PMPXFREL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Medicare Code",CAPTTEXT
          MOVE      "ptmxmccd",FIELDNAM
          MOVE      PTMXMCCD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Registered HCP 1",CAPTTEXT
          MOVE      "pmpxrhc1",FIELDNAM
          MOVE      PMPXRHC1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Registered HCP Practice 1",CAPTTEXT
          MOVE      "pmpxrh1g",FIELDNAM
          MOVE      PMPXRH1G,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Registered HCP Practice Count 1",CAPTTEXT
          MOVE      "pmpxr1gc",FIELDNAM
          MOVE      PMPXR1GC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient First Given Name",CAPTTEXT
          MOVE      "pmpxfnam",FIELDNAM
          MOVE      PMPXFNAM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient Second Give Name",CAPTTEXT
          MOVE      "pmpxsnam",FIELDNAM
          MOVE      PMPXSNAM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient Surname",CAPTTEXT
          MOVE      "ptmasnam",FIELDNAM
          MOVE      PTMASNAM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PTMADCDT
          IF        !@EQUAL
            UNPACK    PTMADCDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Demographics Confirmed Date (CCYYMMDD)",CAPTTEXT
          MOVE      "ptmadcdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Hospital Initiating U/R",CAPTTEXT
          MOVE      "pmpxihos",FIELDNAM
          MOVE      PMPXIHOS,DIM50
          MOVE      FOUR,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Hospital Last Updated U/R",CAPTTEXT
          MOVE      "pmpxlubh",FIELDNAM
          MOVE      PMPXLUBH,DIM50
          MOVE      FOUR,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Preferred Method of Contact(Cat Pn)",CAPTTEXT
          MOVE      "pmpxpmcn",FIELDNAM
          MOVE      PMPXPMCN,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "Pn",CODECATG
          CALL      FRMT0000
.
          MOVE      "Preferred Method of Correspondence(Cat Pr)",CAPTTEXT
          MOVE      "pmpxpmcr",FIELDNAM
          MOVE      PMPXPMCR,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "Pr",CODECATG
          CALL      FRMT0000
.
          MOVE      ZERO,EXIT
          GOTO      LODP9999
.
LODP9500  DISPLAY   *P1:24,*EL,*B,"PMI Holding file data not found.  ";
          CALL      HITENTER
          MOVE      ONE,EXIT
.
LODP9999  RETURN
+
.*****************************************************************************
.*                  LODD0000                           Called by : VINB0000  *
.*        Load the practitioner details into the temporary file              *
.*****************************************************************************
.
.         Read the HCP holding file data
.
LODD0000  MOVE      H7CIMESI,KEY20
          CALL      RDPMQDR1                     * record found ?
          BRANCH    OVRCD,LODD9500               * no - error
.         
          MOVE      "HCP Data",DIM78
          RESET     DIM78
          PACK      DIM78,DIM78,SP80
          CALL      WLIN0000                     * write the data line
.
          MOVE      SP80,DIM78
          CALL      WLIN0000         
.
          MOVE      "HCP Code",CAPTTEXT
          MOVE      "pmhchcpc",FIELDNAM
          MOVE      PMHCHCPC,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Type of HCP",CAPTTEXT
          MOVE      "pmhchcpt",FIELDNAM
          MATCH     ANSD,PMHCHCPT
          IF        @EQUAL
            MOVE      "Dentist",DIM50
          ELSE
            MATCH     ANSG,PMHCHCPT
            IF        @EQUAL
              MOVE      "GP",DIM50
            ELSE
              MOVE      "Unknown",DIM50
            ENDIF
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Title",CAPTTEXT
          MOVE      "pmhctitl",FIELDNAM
          MOVE      PMHCTITL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Given names",CAPTTEXT
          MOVE      "pmhcgnam",FIELDNAM
          MOVE      PMHCGNAM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Surname",CAPTTEXT
          MOVE      "pmhcsnam",FIELDNAM
          MOVE      PMHCSNAM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Initials",CAPTTEXT
          MOVE      "pmhcinit",FIELDNAM
          MOVE      PMHCINIT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Gender",CAPTTEXT
          MOVE      "pmhcgndr",FIELDNAM
          MATCH     ANSM,PMHCGNDR
          IF        @EQUAL
            MOVE      "Male",DIM50
          ELSE
            MATCH     ANSF,PMHCGNDR
            IF        @EQUAL
              MOVE      "Female",DIM50
            ELSE
              MOVE      "Unknown",DIM50
            ENDIF
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCDTOB
          IF        !@EQUAL
            UNPACK    PMHCDTOB,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date of Birth (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhcdtob",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Specialty 1 Code (category DT)",CAPTTEXT
          MOVE      "pmhcspc1",FIELDNAM
          MOVE      PMHCSPC1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "DT",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCSPD1
          IF        !@EQUAL
            UNPACK    PMHCSPD1,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Specialty Date 1 (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhcspd1",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Specialty 2 Code (category DT)",CAPTTEXT
          MOVE      "pmhcspc2",FIELDNAM
          MOVE      PMHCSPC2,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "DT",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCSPD2
          IF        !@EQUAL
            UNPACK    PMHCSPD2,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Specialty Date 2 (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhcspd2",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Specialty 3 Code (category DT)",CAPTTEXT
          MOVE      "pmhcspc3",FIELDNAM
          MOVE      PMHCSPC3,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "DT",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCSPD3
          IF        !@EQUAL
            UNPACK    PMHCSPD3,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Specialty Date 3 (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhcspd3",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Specialty 4 Code (category DT)",CAPTTEXT
          MOVE      "pmhcspc4",FIELDNAM
          MOVE      PMHCSPC4,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "DT",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCSPD4
          IF        !@EQUAL
            UNPACK    PMHCSPD4,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Specialty Date 4 (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhcspd4",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Specialty 5 Code (category DT)",CAPTTEXT
          MOVE      "pmhcspc5",FIELDNAM
          MOVE      PMHCSPC5,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "DT",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCSPD5
          IF        !@EQUAL
            UNPACK    PMHCSPD5,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Specialty Date 5 (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhcspd5",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Receptionist's Name",CAPTTEXT
          MOVE      "pmhcrcpt",FIELDNAM
          MOVE      PMHCRCPT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Receptionist's Name",CAPTTEXT
          MOVE      "pmhcrcpt",FIELDNAM
          MOVE      PMHCRCPT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Surgery Address Line 1",CAPTTEXT
          MOVE      "pmhcadr1",FIELDNAM
          MOVE      PMHCADR1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Surgery Address Line 2",CAPTTEXT
          MOVE      "pmhcadr2",FIELDNAM
          MOVE      PMHCADR2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Surgery Address Line 3",CAPTTEXT
          MOVE      "pmhcadr3",FIELDNAM
          MOVE      PMHCADR3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Surgery Address Line 4",CAPTTEXT
          MOVE      "pmhcadr4",FIELDNAM
          MOVE      PMHCADR4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Surgery Address Line 5",CAPTTEXT
          MOVE      "pmhcadr5",FIELDNAM
          MOVE      PMHCADR5,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Surgery Address Line 6",CAPTTEXT
          MOVE      "pmhcadr6",FIELDNAM
          MOVE      PMHCADR6,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Surgery Postcode",CAPTTEXT
          MOVE      "pmhcpost",FIELDNAM
          MOVE      PMHCPOST,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Surgery State",CAPTTEXT
          MOVE      "pmhcstat",FIELDNAM
          MOVE      PMHCSTAT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Surgery Email Address",CAPTTEXT
          MOVE      "pmhcseml",FIELDNAM
          MOVE      PMHCSEML,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Surgery Telephone",CAPTTEXT
          MOVE      "pmhcstel",FIELDNAM
          MOVE      PMHCSTEL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Pager Telephone",CAPTTEXT
          MOVE      "pmhcpagr",FIELDNAM
          MOVE      PMHCPAGR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Pager Number",CAPTTEXT
          MOVE      "pmhcpagn",FIELDNAM
          MOVE      PMHCPAGN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Associated HCP 1",CAPTTEXT
          MOVE      "pmhcahp1",FIELDNAM
          MOVE      PMHCAHP1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Associated HCP 2",CAPTTEXT
          MOVE      "pmhcahp2",FIELDNAM
          MOVE      PMHCAHP2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Associated HCP 3",CAPTTEXT
          MOVE      "pmhcahp3",FIELDNAM
          MOVE      PMHCAHP3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Associated HCP 4",CAPTTEXT
          MOVE      "pmhcahp4",FIELDNAM
          MOVE      PMHCAHP4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Associated HCP 5",CAPTTEXT
          MOVE      "pmhcahp5",FIELDNAM
          MOVE      PMHCAHP5,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Provider Number 1",CAPTTEXT
          MOVE      "pmhcprv1",FIELDNAM
          MOVE      PMHCPRV1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Provider Number 2",CAPTTEXT
          MOVE      "pmhcprv2",FIELDNAM
          MOVE      PMHCPRV2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Provider Number 3",CAPTTEXT
          MOVE      "pmhcprv3",FIELDNAM
          MOVE      PMHCPRV3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Provider Number 4",CAPTTEXT
          MOVE      "pmhcprv4",FIELDNAM
          MOVE      PMHCPRV4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Provider Number 5",CAPTTEXT
          MOVE      "pmhcprv5",FIELDNAM
          MOVE      PMHCPRV5,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Home Telephone",CAPTTEXT
          MOVE      "pmhchtel",FIELDNAM
          MOVE      PMHCHTEL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Home Address Line 1",CAPTTEXT
          MOVE      "pmhchad1",FIELDNAM
          MOVE      PMHCHAD1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Home Address Line 2",CAPTTEXT
          MOVE      "pmhchad2",FIELDNAM
          MOVE      PMHCHAD2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Home Address Line 3",CAPTTEXT
          MOVE      "pmhchad3",FIELDNAM
          MOVE      PMHCHAD3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Home Address Line 4",CAPTTEXT
          MOVE      "pmhchad4",FIELDNAM
          MOVE      PMHCHAD4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Home Address Line 5",CAPTTEXT
          MOVE      "pmhchad5",FIELDNAM
          MOVE      PMHCHAD5,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Home Address Line 6",CAPTTEXT
          MOVE      "pmhchad6",FIELDNAM
          MOVE      PMHCHAD6,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Home Postcode",CAPTTEXT
          MOVE      "pmhchpcd",FIELDNAM
          MOVE      PMHCHPCD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Home Email Address",CAPTTEXT
          MOVE      "pmhcheml",FIELDNAM
          MOVE      PMHCHEML,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Date of 1st Accreditation",CAPTTEXT
          MOVE      "pmhcdfac",FIELDNAM
          MOVE      PMHCDFAC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Date of Last Accreditation",CAPTTEXT
          MOVE      "pmhcdlac",FIELDNAM
          MOVE      PMHCDLAC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Years of Accreditation",CAPTTEXT
          MOVE      "pmhcyacc",FIELDNAM
          MOVE      PMHCYACC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Accreditation Type (category AT)",CAPTTEXT
          MOVE      "pmhcatyp",FIELDNAM
          MOVE      PMHCATYP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "AT",CODECATG
          CALL      FRMT0000
.
          MOVE      "H.C.S. Code",CAPTTEXT
          MOVE      "pmhchhcp",FIELDNAM
          MOVE      PMHCHHCP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Oper. Superv'n Level (cat. DL)",CAPTTEXT
          MOVE      "pmhcoslv",FIELDNAM
          MOVE      PMHCOSLV,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "DL",CODECATG
          CALL      FRMT0000
.
          MOVE      "Status",CAPTTEXT
          MOVE      "pmhchcst",FIELDNAM
          LOAD      HCPSTATS,PMHCHCST,HCPSTA01,HCPSTA02,HCPSTA03,HCPSTA04:
                                      HCPSTA05,HCPSTA06,HCPSTA07,HCPSTA08:
                                      HCPSTA09,HCPSTA10,HCPSTA11
          MOVE      HCPSTATS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCHCSD
          IF        !@EQUAL
            UNPACK    PMHCHCSD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Status Date (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhchcsd",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Fax Number",CAPTTEXT
          MOVE      "pmhcfaxn",FIELDNAM
          MOVE      PMHCFAXN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Home Fax Number",CAPTTEXT
          MOVE      "pmhchfxn",FIELDNAM
          MOVE      PMHCHFXN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mobile Number",CAPTTEXT
          MOVE      "pmhcmobn",FIELDNAM
          MOVE      PMHCMOBN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Creditor Code",CAPTTEXT
          MOVE      "pmhccrdc",FIELDNAM
          MOVE      PMHCCRDC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "WA HDP Code",CAPTTEXT
          MOVE      "pmhcwahc",FIELDNAM
          MOVE      PMHCWAHC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Medical Regist. Board Number",CAPTTEXT
          MOVE      "pmhcmrbn",FIELDNAM
          MOVE      PMHCMRBN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "NHS Prescriber Number",CAPTTEXT
          MOVE      "pmhcnhsn",FIELDNAM
          MOVE      PMHCNHSN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def'd Field 1 (category R5)",CAPTTEXT
          MOVE      "pmhcudf1",FIELDNAM
          MOVE      PMHCUDF1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "R5",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Def'd Field 2 (category R6)",CAPTTEXT
          MOVE      "pmhcudf2",FIELDNAM
          MOVE      PMHCUDF2,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "R6",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Def'd Field 3 (category R7)",CAPTTEXT
          MOVE      "pmhcudf3",FIELDNAM
          MOVE      PMHCUDF3,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "R7",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Def'd Field 4 (category R8)",CAPTTEXT
          MOVE      "pmhcudf4",FIELDNAM
          MOVE      PMHCUDF4,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "R8",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Def'd Field 5 (category R9)",CAPTTEXT
          MOVE      "pmhcudf5",FIELDNAM
          MOVE      PMHCUDF5,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "R9",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N Field 1",CAPTTEXT
          MOVE      "pmhcuyn1",FIELDNAM
          MATCH     "1",PMHCUYN1
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N Field 2",CAPTTEXT
          MOVE      "pmhcuyn2",FIELDNAM
          MATCH     "1",PMHCUYN2
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N Field 3",CAPTTEXT
          MOVE      "pmhcuyn3",FIELDNAM
          MATCH     "1",PMHCUYN3
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N Field 4",CAPTTEXT
          MOVE      "pmhcuyn4",FIELDNAM
          MATCH     "1",PMHCUYN4
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N Field 5",CAPTTEXT
          MOVE      "pmhcuyn5",FIELDNAM
          MATCH     "1",PMHCUYN5
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Insurance Code",CAPTTEXT
          MOVE      "pmhcinsc",FIELDNAM
          MOVE      PMHCINSC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Insurance Policy Number",CAPTTEXT
          MOVE      "pmhcipln",FIELDNAM
          MOVE      PMHCIPLN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCIDTF
          IF        !@EQUAL
            UNPACK    PMHCIDTF,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Insurance Date From (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhcidtf",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCIDTT
          IF        !@EQUAL
            UNPACK    PMHCIDTT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Insurance Date To (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhcidtt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "MPG Certificate Number",CAPTTEXT
          MOVE      "pmhcmpgn",FIELDNAM
          MOVE      PMHCMPGN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "APC",CAPTTEXT
          MOVE      "pmhcapci",FIELDNAM
          MATCH     "1",PMHCAPCI
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Registration Type (category HR)",CAPTTEXT
          MOVE      "pmhcregt",FIELDNAM
          MOVE      PMHCREGT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "HR",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCRGDF
          IF        !@EQUAL
            UNPACK    PMHCRGDF,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Registrat'n Date From (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhcrgdf",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCRGDT
          IF        !@EQUAL
            UNPACK    PMHCRGDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Registration Date To (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhcrgdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCPRDF
          IF        !@EQUAL
            UNPACK    PMHCPRDF,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Prob. Regist Date From (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhcprdf",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCPRDT
          IF        !@EQUAL
            UNPACK    PMHCPRDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Prob. Regist. Date To (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhcprdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCTSDF
          IF        !@EQUAL
            UNPACK    PMHCTSDF,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Temp. Start Date From (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhctsdf",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCTFDT
          IF        !@EQUAL
            UNPACK    PMHCTFDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Temp. Start Date To (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhctfdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCVISD
          IF        !@EQUAL
            UNPACK    PMHCVISD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Visa Date (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhcvisd",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Pref'd Communication (cat. CZ)",CAPTTEXT
          MOVE      "pmhcprfc",FIELDNAM
          MOVE      PMHCPRFC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CZ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Preferred Name",CAPTTEXT
          MOVE      "pmhcprfn",FIELDNAM
          MOVE      PMHCPRFN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "ABN Number",CAPTTEXT
          MOVE      "pmhcabnn",FIELDNAM
          MOVE      PMHCABNN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Update Flag",CAPTTEXT
          MOVE      "pmhcupdf",FIELDNAM
          MATCH     ANSA,PMHCUPDF
          IF        @EQUAL
            MOVE      "Automatic",DIM50
          ELSE
            MATCH     ANSM,PMHCUPDF
            IF        @EQUAL
              MOVE      "Manual",DIM50
            ELSE
              MOVE      "Unknown",DIM50
            ENDIF
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Processed Record Marker",CAPTTEXT
          MOVE      "pmhcprmk",FIELDNAM
          MATCH     "1",PMHCPRMK
          IF        @EQUAL
            MOVE      "Processed",DIM50
          ELSE
            MOVE      "Not Processed",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Record Status",CAPTTEXT
          MOVE      "pmhcstts",FIELDNAM
          MATCH     "0",PMHCSTTS
          IF        @EQUAL
            MOVE      "Active",DIM50
          ELSE
            MOVE      "Inactive",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCDLMI
          IF        !@EQUAL
            UNPACK    PMHCDLMI,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Last Made Inactive (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhcdlmi",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCDLMA
          IF        !@EQUAL
            UNPACK    PMHCDLMA,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Last Made Active (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhcdlma",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCCDTE
          IF        !@EQUAL
            UNPACK    PMHCCDTE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Record Created (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhccdte",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
.
          MOVE      "Time Record Created",CAPTTEXT
          MOVE      "pmhcctim",FIELDNAM
          MOVE      PMHCCTIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Creator's Web User Id",CAPTTEXT
          MOVE      "pmhcwebc",FIELDNAM
          MOVE      PMHCWEBC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,PMHCLUPD
          IF        !@EQUAL
            UNPACK    PMHCLUPD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Last Update Date (CCYYMMDD)",CAPTTEXT
          MOVE      "pmhclupd",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
.
          MOVE      "Time Record Updated",CAPTTEXT
          MOVE      "pmhclupt",FIELDNAM
          MOVE      PMHCLUPT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Updater's Web User Id",CAPTTEXT
          MOVE      "pmhcwebu",FIELDNAM
          MOVE      PMHCWEBU,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Show Local GP on PMI",CAPTTEXT
          MOVE      "pmhcslgp",FIELDNAM
          MATCH     "1",PMHCSLGP
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      ZERO,EXIT
          GOTO      LODD9999
.
LODD9500  DISPLAY   *P1:24,*EL,*B,"HCP Holding file data not found.  ";
          CALL      HITENTER
          MOVE      ONE,EXIT
.         
LODD9999  RETURN
+
.*****************************************************************************
.*                  LODM0000                           Called by : VINB0000  *
.*        Load the O/P Maintenance file details into the temporary file      *
.*****************************************************************************
.
LODM0000  BRANCH    OPMNFLAG,LODM5000            * clinic type
.
.         Load the Clinic Master Maintenance file details 
 
          MOVE      H7CIMESI,KEY20
          CALL      RDOTQMA1                     * record found ?
          BRANCH    OVRCD,LODM9500               * no - error
.         
          MOVE      "O/P MAS Data",DIM78
          RESET     DIM78
          PACK      DIM78,DIM78,SP80
          CALL      WLIN0000                     * write the data line
.
          MOVE      SP80,DIM78
          CALL      WLIN0000         
.
          MOVE      "Site",CAPTTEXT
          MOVE      "omasite",FIELDNAM
          MOVE      OMASITE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Id",CAPTTEXT
          MOVE      "omaclin",FIELDNAM
          MOVE      OMACLIN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Type",CAPTTEXT
          MOVE      "omatyp",FIELDNAM
          MOVE      OMATYP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          LOAD      DAYOFWK,OMADAY,MONDAY,TUESDAY,WEDNSDAY,THURSDAY,FRIDAY:
                                   SATURDAY,SUNDAY
          MOVE      DAYOFWK,CAPTTEXT
          MOVE      "omaday",FIELDNAM
          MOVE      OMADAY,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Start Time",CAPTTEXT
          MOVE      "omastart",FIELDNAM
          MOVE      OMASTART,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Finish Booking Time",CAPTTEXT
          MOVE      "omafin",FIELDNAM
          MOVE      OMAFIN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "End Session Time",CAPTTEXT
          MOVE      "omaend",FIELDNAM
          MOVE      OMAEND,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Indicator",CAPTTEXT
          MOVE      "omacind",FIELDNAM
          MOVE      OMACIND,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Registrar's Clinic (Y/N)",CAPTTEXT
          MOVE      "omareg",FIELDNAM
          MOVE      OMAREG,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Keyin Doctor (Y/N)",CAPTTEXT
          MOVE      "omakdoc",FIELDNAM
          MOVE      OMAKDOC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Comments Line 1",CAPTTEXT
          MOVE      "omacom1",FIELDNAM
          MOVE      OMACOM1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Comments Line 2",CAPTTEXT
          MOVE      "omacom2",FIELDNAM
          MOVE      OMACOM2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Slot Duration (mins)",CAPTTEXT
          MOVE      "omadurn",FIELDNAM
          MOVE      OMADURN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Slots for a New Patient",CAPTTEXT
          MOVE      "omanewsl",FIELDNAM
          MOVE      OMANEWSL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Slots for a Special Patient",CAPTTEXT
          MOVE      "omaspcsl",FIELDNAM
          MOVE      OMASPCSL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Status",CAPTTEXT
          MOVE      "omastat",FIELDNAM
          MOVE      OMASTAT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Session Frequency (Monthly)",CAPTTEXT
          MOVE      "omafreqm",FIELDNAM
          MOVE      OMAFREQM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Report Sequence",CAPTTEXT
          MOVE      "domaseq",FIELDNAM
          MOVE      DOMASEQ,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Session Frequency Flag",CAPTTEXT
          MOVE      "omafreqf",FIELDNAM
          MOVE      OMAFREQF,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Session Frequency (Yearly)",CAPTTEXT
          MOVE      "omafreqy",FIELDNAM
          MOVE      OMAFREQY,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OMADATE
          IF        !@EQUAL
            UNPACK    OMADATE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Session Last Opened (CCYYMMDD)",CAPTTEXT
          MOVE      "omadate",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Allocate Visit Type when Booking Doctor (Y/N)",CAPTTEXT
          MOVE      "otmaavis",FIELDNAM
          MOVE      OTMAAVIS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Slot Times Controlled by Visit Type (Y/N)",CAPTTEXT
          MOVE      "otmastvt",FIELDNAM
          MOVE      OTMASTVT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Supress Extended Slots on Displays (Y/N)",CAPTTEXT
          MOVE      "otmasupx",FIELDNAM
          MOVE      OTMASUPX,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Using RUS Automated Extract",CAPTTEXT
          MOVE      "otmaruse",FIELDNAM
          MOVE      OTMARUSE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Display Comments at Booking Time",CAPTTEXT
          MOVE      "otmadcmb",FIELDNAM
          MOVE      OTMADCMB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Input Extra Screen when Attending (Y/N)",CAPTTEXT
          MOVE      "otmaixta",FIELDNAM
          MOVE      OTMAIXTA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Default Doctor Code",CAPTTEXT
          MOVE      "otmadefd",FIELDNAM
          MOVE      OTMAdefd,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Using Attendance Register (Y/N)",CAPTTEXT
          MOVE      "otmauatr",FIELDNAM
          MOVE      OTMAUATR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Days after which Patient is Discharged",CAPTTEXT
          MOVE      "otmaddna",FIELDNAM
          MOVE      OTMADDNA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Number of Days for Reappointment",CAPTTEXT
          MOVE      "otmandrp",FIELDNAM
          MOVE      OTMANDRP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Letter to Patient on Reappointment",CAPTTEXT
          MOVE      "otmalptr",FIELDNAM
          MOVE      OTMALPTR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Letter to GP on Discharge",CAPTTEXT
          MOVE      "otmalgpd",FIELDNAM
          MOVE      OTMALGPD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Letter to Patient on Discharge",CAPTTEXT
          MOVE      "otmalptd",FIELDNAM
          MOVE      OTMALPTD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Standard Booking Letter",CAPTTEXT
          MOVE      "otmabklt",FIELDNAM
          MOVE      OTMABKLT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Standard Reappointment Letter",CAPTTEXT
          MOVE      "otmaralt",FIELDNAM
          MOVE      OTMARALT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Standard Reschedule Letter",CAPTTEXT
          MOVE      "otmarslt",FIELDNAM
          MOVE      OTMARSLT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Session",CAPTTEXT
          MOVE      "otmaclse",FIELDNAM
          MOVE      OTMACLSE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Hospital",CAPTTEXT
          MOVE      "otmahosp",FIELDNAM
          MOVE      OTMAHOSP,DIM50
          MOVE      FOUR,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Location",CAPTTEXT
          MOVE      "otmacloc",FIELDNAM
          MOVE      OTMACLOC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Ward Clinic (Y/N)",CAPTTEXT
          MOVE      "otmawdcl",FIELDNAM
          MOVE      OTMAWDCL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Ward",CAPTTEXT
          MOVE      "otmaward",FIELDNAM
          MOVE      OTMAWARD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Location Type (category CT)",CAPTTEXT
          MOVE      "otmaltyp",FIELDNAM
          MOVE      OTMALTYP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CT",CODECATG
          CALL      FRMT0000
.
          MOVE      "Default Value for Send Letter",CAPTTEXT
          MOVE      "otmadfsl",FIELDNAM
          MOVE      OTMADFSL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Generate Case Notes on Attendance",CAPTTEXT
          MOVE      "otmadfgn",FIELDNAM
          MOVE      OTMADFGN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Group Session (Y/N)",CAPTTEXT
          MOVE      "otmagrps",FIELDNAM
          MOVE      OTMAGRPS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Security Level to Overbook",CAPTTEXT
          MOVE      "dotmasov",FIELDNAM
          MOVE      DOTMASOV,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Number of Overbookings Allowed",CAPTTEXT
          MOVE      "dotmanoo",FIELDNAM
          MOVE      DOTMANOO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Security level to Forcebook",CAPTTEXT
          MOVE      "dotmaslf",FIELDNAM
          MOVE      DOTMASLF,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Security level to use Reserved Slots",CAPTTEXT
          MOVE      "dotmaslr",FIELDNAM
          MOVE      DOTMASLR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Booking Label Screen ID",CAPTTEXT
          MOVE      "otmasbkl",FIELDNAM
          MOVE      OTMASBKL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Appointment Label Screen ID",CAPTTEXT
          MOVE      "otmasapl",FIELDNAM
          MOVE      OTMASAPL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "PMI Mailing Label Screen ID",CAPTTEXT
          MOVE      "otmaspmm",FIELDNAM
          MOVE      OTMASPMM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "GP Mailing Label Screen ID",CAPTTEXT
          MOVE      "otmasgpm",FIELDNAM
          MOVE      OTMASGPM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Letter to Patient on Cancellation",CAPTTEXT
          MOVE      "dotmalpp",FIELDNAM
          MOVE      DOTMALPP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Standard Reschedule Letter",CAPTTEXT
          MOVE      "dotmasrl",FIELDNAM
          MOVE      DOTMASRL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Non-Consultant clinic (Y/N)",CAPTTEXT
          MOVE      "dotmanco",FIELDNAM
          MOVE      DOTMANCO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Location of Clinic",CAPTTEXT
          MOVE      "otmalocn",FIELDNAM
          MOVE      OTMALOCN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OTMADTCO
          IF        !@EQUAL
            UNPACK    OTMADTCO,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Clinic Created (CCYYMMDD)",CAPTTEXT
          MOVE      "otmadtco",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,OTMADTCC
          IF        !@EQUAL
            UNPACK    OTMADTCC,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Clinic Closed (CCYYMMDD)",CAPTTEXT
          MOVE      "otmadtcc",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Instruction 1",CAPTTEXT
          MOVE      "otmains1",FIELDNAM
          MOVE      OTMAINS1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Instruction 2",CAPTTEXT
          MOVE      "otmains2",FIELDNAM
          MOVE      OTMAINS2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Instruction 3",CAPTTEXT
          MOVE      "otmains3",FIELDNAM
          MOVE      OTMAINS3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Series Booking Letter",CAPTTEXT
          MOVE      "otmalser",FIELDNAM
          MOVE      OTMALSER,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Using Medclaims (Y/N)",CAPTTEXT
          MOVE      "otmaumci",FIELDNAM
          MOVE      OTMAUMCI,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Provider Number",CAPTTEXT
          MOVE      "otmaprov",FIELDNAM
          MOVE      OTMAPROV,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Default CMBS Item Template ID",CAPTTEXT
          MOVE      "otmambst",FIELDNAM
          MOVE      OTMAMBST,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Room Number",CAPTTEXT
          MOVE      "otmaroom",FIELDNAM
          MOVE      OTMAROOM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Ledger",CAPTTEXT
          MOVE      "otmaledg",FIELDNAM
          MOVE      OTMALEDG,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Cost Centre",CAPTTEXT
          MOVE      "otmacctr",FIELDNAM
          MOVE      OTMACCTR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Medical Practice",CAPTTEXT
          MOVE      "otmamprc",FIELDNAM
          MOVE      OTMAMPRC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Apply CMBS Template to Booking",CAPTTEXT
          MOVE      "otmambsa",FIELDNAM
          MOVE      OTMAMBSA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Non-Attendance Letter",CAPTTEXT
          MOVE      "otmaldna",FIELDNAM
          MOVE      OTMALDNA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Allied Health Department",CAPTTEXT
          MOVE      "otmaadep",FIELDNAM
          MOVE      OTMAADEP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Collect Encounter Details (Y/N)",CAPTTEXT
          MOVE      "otmacenc",FIELDNAM
          MOVE      OTMACENC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Collect Carer Details (Y/N)",CAPTTEXT
          MOVE      "otmaccar",FIELDNAM
          MOVE      OTMACCAR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Collect Transport Details (Y/N)",CAPTTEXT
          MOVE      "otmactrn",FIELDNAM
          MOVE      OTMACTRN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Number of Days Prior to Send Letter",CAPTTEXT
          MOVE      "otmadpsl",FIELDNAM
          MOVE      OTMADPSL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Using Confrim PMI (Y/N)",CAPTTEXT
          MOVE      "otmacpmi",FIELDNAM
          MOVE      OTMACPMI,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Using Check-In Page (Y/N)",CAPTTEXT
          MOVE      "otmacpag",FIELDNAM
          MOVE      OTMACPAG,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Telephone Number",CAPTTEXT
          MOVE      "otmactel",FIELDNAM
          MOVE      OTMACTEL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "NMDS Code (category NM)",CAPTTEXT
          MOVE      "otmanmds",FIELDNAM
          MOVE      OTMANMDS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "NM",CODECATG
          CALL      FRMT0000
.
          MOVE      "Care Type (category CC)",CAPTTEXT
          MOVE      "otmacart",FIELDNAM
          MOVE      OTMACART,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CT",CODECATG
          CALL      FRMT0000
.
          MOVE      "Service Delivery Mode (category sd)",CAPTTEXT
          MOVE      "otmasrvd",FIELDNAM
          MOVE      OTMASRVD,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "sd",CODECATG
          CALL      FRMT0000
.
          MOVE      "Clinical High Risk (Y/N)",CAPTTEXT
          MOVE      "otmaclhr",FIELDNAM
          MOVE      OTMACLHR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Multidisciplinary Clinic (Y/N)",CAPTTEXT
          MOVE      "otmamltd",FIELDNAM
          MOVE      OTMAMLTD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Exclude from Pulling List (Y/N)",CAPTTEXT
          MOVE      "otmaxpul",FIELDNAM
          MOVE      OTMAXPUL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          GOTO      LODM9999
.
.         Load the Clinic Type Maintenance file details 
.
.
LODM5000  MOVE      H7CIMESI,KEY20
          CALL      RDOTQTY1                     * record found ?
          BRANCH    OVRCD,LODM9500               * no - error
.
          MOVE      "Site",CAPTTEXT
          MOVE      "octsite",FIELDNAM
          MOVE      OCTSITE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Type",CAPTTEXT
          MOVE      "octctyp",FIELDNAM
          MOVE      OCTCTYP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Group Code (category CG)",CAPTTEXT
          MOVE      "octgrp",FIELDNAM
          MOVE      OCTGRP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CG",CODECATG
          CALL      FRMT0000
.
          MOVE      "Clinic Type Description",CAPTTEXT
          MOVE      "octdesc",FIELDNAM
          MOVE      OCTDESC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Extra Booking Screen Id",CAPTTEXT
          MOVE      "octxbok",FIELDNAM
          MOVE      OCTXBOK,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Extra Attendee Screen Id",CAPTTEXT
          MOVE      "octxatt",FIELDNAM
          MOVE      OCTXATT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Booking Template",CAPTTEXT
          MOVE      "octbkt",FIELDNAM
          MOVE      OCTBKT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Attendance Template",CAPTTEXT
          MOVE      "octatt",FIELDNAM
          MOVE      OCTATT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Inactive",CAPTTEXT
          MOVE      "octact",FIELDNAM
          MOVE      OCTACT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "VACS Code (category CQ)",CAPTTEXT
          MOVE      "octvacs",FIELDNAM
          MOVE      OCTVACS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CQ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Waiting List Unit (category WU)",CAPTTEXT
          MOVE      "octwunit",FIELDNAM
          MOVE      OCTWUNIT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "WU",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 1",CAPTTEXT
          MOVE      "octusdf1",FIELDNAM
          MOVE      OCTUSDF1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Field 2",CAPTTEXT
          MOVE      "octusdf2",FIELDNAM
          MOVE      OCTUSDF2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      ZERO,EXIT
          GOTO      LODM9999
.
LODM9500  DISPLAY   *P1:24,*EL,*B,"HCP Holding file data not found.  ";
          CALL      HITENTER
          MOVE      ONE,EXIT
.
LODM9999  RETURN
+
.*****************************************************************************
.*                  LODE0000                           Called by : VINB0000  *
.*        Load the EMR details into the temporary file                       *
.*****************************************************************************
.
.         Read the EMR holding file data
.
LODE0000  MOVE      H7CIMESI,KEY20
          CALL      RDEMQUE1                     * record found ?
          BRANCH    OVRCD,LODE9500               * no - error
.         
          MOVE      "EMR Data",DIM78
          RESET     DIM78
          PACK      DIM78,DIM78,SP80
          CALL      WLIN0000                     * write the data line
.
          MOVE      SP80,DIM78
          CALL      WLIN0000         
.
          MOVE      "Visit Number",CAPTTEXT
          MOVE      "emviadmn",FIELDNAM
          MOVE      EMVIADMN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          LOAD      ESTADESC,EMVISTAT,ESTATDE1,ESTATDE2,ESTATDE3
          MOVE      "Status",CAPTTEXT
          MOVE      "emvistat",FIELDNAM
          MOVE      ESTADESC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient U/R Number",CAPTTEXT
          MOVE      "emviurno",FIELDNAM
          MOVE      EMVIURNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIDATE
          IF        !@EQUAL
            UNPACK    EMVIDATE,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Arrival Date (CCYYMMDD)",CAPTTEXT
          MOVE      "emvidate",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Arrival Time (HH:MM:SS)",CAPTTEXT
          MOVE      "emvitime",FIELDNAM
          MOVE      EMVITIME,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Triage Code (category AA)",CAPTTEXT
          MOVE      "emvitrig",FIELDNAM
          MOVE      EMVITRIG,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "AA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Complaint Line 1",CAPTTEXT
          MOVE      "emvicom1",FIELDNAM
          MOVE      EMVICOM1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Complaint Line 2",CAPTTEXT
          MOVE      "emvicom2",FIELDNAM
          MOVE      EMVICOM2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Location (emrlocaf)",CAPTTEXT
          MOVE      "emvilocn",FIELDNAM
          MOVE      EMVILOCN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Attending Doctor",CAPTTEXT
          MOVE      "emvidoct",FIELDNAM
          MOVE      EMVIDOCT,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Compensation Code (category CL)",CAPTTEXT
          MOVE      "emvicomp",FIELDNAM
          MOVE      EMVICOMP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CL",CODECATG
          CALL      FRMT0000
.
          MOVE      "Patient Classification (cat. A)",CAPTTEXT
          MOVE      "emviclas",FIELDNAM
          MOVE      EMVICLAS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "A ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Insurance Status (category U1)",CAPTTEXT
          MOVE      "emviinsr",FIELDNAM
          MOVE      EMVIINSR,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "U1",CODECATG
          CALL      FRMT0000
.
          MOVE      "Source of Referral (category S)",CAPTTEXT
          MOVE      "emvisrce",FIELDNAM
          MOVE      EMVISRCE,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "S ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Situation (category ES)",CAPTTEXT
          MOVE      "emvisitn",FIELDNAM
          MOVE      EMVISITN,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ES",CODECATG
          CALL      FRMT0000
.
          MOVE      "Mode of Arrival (category EA)",CAPTTEXT
          MOVE      "emvimode",FIELDNAM
          MOVE      EMVIMODE,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "EA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Admitted to Hospital (0=no,1=yes)",CAPTTEXT
          MOVE      "emviadmt",FIELDNAM
          MOVE      EMVIADMT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Duration of Waiting (in minutes)",CAPTTEXT
          MOVE      "emvidurn",FIELDNAM
          MOVE      EMVIDURN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Employer (Workcover)",CAPTTEXT
          MOVE      "emviempl",FIELDNAM
          MOVE      EMVIEMPL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Completion Wait Code (cat. EW)",CAPTTEXT
          MOVE      "emviwait",FIELDNAM
          MOVE      EMVIWAIT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "EW",CODECATG
          CALL      FRMT0000
.
          MOVE      "Previous A&E Attendance (cat. EP)",CAPTTEXT
          MOVE      "emviprev",FIELDNAM
          MOVE      EMVIPREV,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "EP",CODECATG
          CALL      FRMT0000
.
          MOVE      "Health Fund",CAPTTEXT
          MOVE      "emvifund",FIELDNAM
          MOVE      EMVIFUND,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Health Fund Table",CAPTTEXT
          MOVE      "emvitabl",FIELDNAM
          MOVE      EMVITABL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring GP",CAPTTEXT
          MOVE      "emvirefg",FIELDNAM
          MOVE      EMVIREFG,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring Doctor",CAPTTEXT
          MOVE      "emvirefd",FIELDNAM
          MOVE      EMVIREFD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Place of Incident (category AP)",CAPTTEXT
          MOVE      "emviplin",FIELDNAM
          MOVE      EMVIPLIN,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "AP",CODECATG
          CALL      FRMT0000
.
          MOVE      "Initiator (category AI)",CAPTTEXT
          MOVE      "emviinit",FIELDNAM
          MOVE      EMVIINIT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "AI",CODECATG
          CALL      FRMT0000
.
          MOVE      "RTA Seatbelt Details (category AR)",CAPTTEXT
          MOVE      "emvirtas",FIELDNAM
          MOVE      EMVIRTAS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "AR",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIDDAT
          IF        !@EQUAL
            UNPACK    EMVIDDAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Discharge Date (CCYYMMDD)",CAPTTEXT
          MOVE      "emviddat",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Discharge Time (HH:MM:SS)",CAPTTEXT
          MOVE      "emvidtim",FIELDNAM
          MOVE      EMVIDTIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Discharge Status (category ED)",CAPTTEXT
          MOVE      "emvidsta",FIELDNAM
          MOVE      EMVIDSTA,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ED",CODECATG
          CALL      FRMT0000
.
          MOVE      "Web Operator - event (websecaf)",CAPTTEXT
          MOVE      "emviopr1",FIELDNAM
          MOVE      EMVIOPR1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Web Operator - disch. (websecaf)",CAPTTEXT
          MOVE      "emviopr2",FIELDNAM
          MOVE      EMVIOPR2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Code 1  (category A1)",CAPTTEXT
          MOVE      "emviuc01",FIELDNAM
          MOVE      EMVIUC01,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "A1",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 2  (category A2)",CAPTTEXT
          MOVE      "emviuc02",FIELDNAM
          MOVE      EMVIUC02,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "A2",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 3  (category A3)",CAPTTEXT
          MOVE      "emviuc03",FIELDNAM
          MOVE      EMVIUC03,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "A3",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 4  (category A4)",CAPTTEXT
          MOVE      "emviuc04",FIELDNAM
          MOVE      EMVIUC04,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "A4",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 5  (category A5)",CAPTTEXT
          MOVE      "emviuc05",FIELDNAM
          MOVE      EMVIUC05,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "A5",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 6  (category A6)",CAPTTEXT
          MOVE      "emviuc06",FIELDNAM
          MOVE      EMVIUC06,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "A6",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 7  (category A7)",CAPTTEXT
          MOVE      "emviuc07",FIELDNAM
          MOVE      EMVIUC07,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "A7",CODECATG
          CALL      FRMT0000
.
          MOVE      "Discharge Dest ACT   (category A8)",CAPTTEXT
          MOVE      "emviuc08",FIELDNAM
          MOVE      EMVIUC08,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "A8",CODECATG
          CALL      FRMT0000
.
          MOVE      "Transport Mode       (category ea)",CAPTTEXT
          MOVE      "emviuc09",FIELDNAM
          MOVE      EMVIUC09,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ea",CODECATG
          CALL      FRMT0000
.
          MOVE      "Escort Source        (category eb)",CAPTTEXT
          MOVE      "emviuc10",FIELDNAM
          MOVE      EMVIUC10,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "eb",CODECATG
          CALL      FRMT0000
.
          MOVE      "Referred to on Disch (category ec)",CAPTTEXT
          MOVE      "emviuc11",FIELDNAM
          MOVE      EMVIUC11,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ec",CODECATG
          CALL      FRMT0000
.
          MOVE      "Reason for Transfer  (category ed)",CAPTTEXT
          MOVE      "emviuc12",FIELDNAM
          MOVE      EMVIUC12,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ed",CODECATG
          CALL      FRMT0000
.
          MOVE      "Type of Visit        (category ee)",CAPTTEXT
          MOVE      "emviuc13",FIELDNAM
          MOVE      EMVIUC13,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ee",CODECATG
          CALL      FRMT0000
.
          MOVE      "Human Intent         (category ef)",CAPTTEXT
          MOVE      "emviuc14",FIELDNAM
          MOVE      EMVIUC14,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ef",CODECATG
          CALL      FRMT0000
.
          MOVE      "Activity when Injured(category eg)",CAPTTEXT
          MOVE      "emviuc15",FIELDNAM
          MOVE      EMVIUC15,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "eg",CODECATG
          CALL      FRMT0000
.
          MOVE      "Nurse Code           (category eh)",CAPTTEXT
          MOVE      "emviuc16",FIELDNAM
          MOVE      EMVIUC16,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "eh",CODECATG
          CALL      FRMT0000
.
          MOVE      "Injury Cause         (category ei)",CAPTTEXT
          MOVE      "emviuc17",FIELDNAM
          MOVE      EMVIUC17,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ei",CODECATG
          CALL      FRMT0000
.
          MOVE      "Reason for Undisch   (category ej)",CAPTTEXT
          MOVE      "emviuc18",FIELDNAM
          MOVE      EMVIUC18,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ej",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 19 (category ek)",CAPTTEXT
          MOVE      "emviuc19",FIELDNAM
          MOVE      EMVIUC19,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ek",CODECATG
          CALL      FRMT0000
.
          MOVE      "Presenting Complaint (category el)",CAPTTEXT
          MOVE      "emviuc20",FIELDNAM
          MOVE      EMVIUC20,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "el",CODECATG
          CALL      FRMT0000
.
          MOVE      "Attendance Source    (category em)",CAPTTEXT
          MOVE      "emviuc21",FIELDNAM
          MOVE      EMVIUC21,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "em",CODECATG
          CALL      FRMT0000
.
          MOVE      "Clerical ID          (category en)",CAPTTEXT
          MOVE      "emviuc22",FIELDNAM
          MOVE      EMVIUC22,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "en",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 23 (category eo)",CAPTTEXT
          MOVE      "emviuc23",FIELDNAM
          MOVE      EMVIUC23,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "eo",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 24 (category ep)",CAPTTEXT
          MOVE      "emviuc24",FIELDNAM
          MOVE      EMVIUC24,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ep",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 25 (category eq)",CAPTTEXT
          MOVE      "emviuc25",FIELDNAM
          MOVE      EMVIUC25,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "eq",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 26 (category er)",CAPTTEXT
          MOVE      "emviuc26",FIELDNAM
          MOVE      EMVIUC26,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "er",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 27 (category es)",CAPTTEXT
          MOVE      "emviuc27",FIELDNAM
          MOVE      EMVIUC27,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "es",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 28 (category et)",CAPTTEXT
          MOVE      "emviuc28",FIELDNAM
          MOVE      EMVIUC28,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "et",CODECATG
          CALL      FRMT0000
.
          MOVE      "Research             (category eu)",CAPTTEXT
          MOVE      "emviuc29",FIELDNAM
          MOVE      EMVIUC29,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "eu",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 30 (category ev)",CAPTTEXT
          MOVE      "emviuc30",FIELDNAM
          MOVE      EMVIUC30,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ev",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIUD01
          IF        !@EQUAL
            UNPACK    EMVIUD01,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Ready for Dept. Date (CCYYMMDD)",CAPTTEXT
          MOVE      "emviud01",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIUD02
          IF        !@EQUAL
            UNPACK    EMVIUD02,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "User Defined Date 2  (CCYYMMDD)",CAPTTEXT
          MOVE      "emviud02",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIUD03
          IF        !@EQUAL
            UNPACK    EMVIUD03,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Ward Request Date    (CCYYMMDD)",CAPTTEXT
          MOVE      "emviud03",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIUD04
          IF        !@EQUAL
            UNPACK    EMVIUD04,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Ward Allocation Date (CCYYMMDD)",CAPTTEXT
          MOVE      "emviud04",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIUD05
          IF        !@EQUAL
            UNPACK    EMVIUD05,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Bed Ready Date       (CCYYMMDD)",CAPTTEXT
          MOVE      "emviud05",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIUD06
          IF        !@EQUAL
            UNPACK    EMVIUD06,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "User Defined Date 6  (CCYYMMDD)",CAPTTEXT
          MOVE      "emviud06",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIUD07
          IF        !@EQUAL
            UNPACK    EMVIUD07,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "User Defined Date 7  (CCYYMMDD)",CAPTTEXT
          MOVE      "emviud07",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIUD08
          IF        !@EQUAL
            UNPACK    EMVIUD08,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "User Defined Date 8  (CCYYMMDD)",CAPTTEXT
          MOVE      "emviud08",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIUD09
          IF        !@EQUAL
            UNPACK    EMVIUD09,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "User Defined Date 9  (CCYYMMDD)",CAPTTEXT
          MOVE      "emviud09",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIUD10
          IF        !@EQUAL
            UNPACK    EMVIUD10,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "User Defined Date 10 (CCYYMMDD)",CAPTTEXT
          MOVE      "emviud10",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Ready for Dept. Time (HH:MM:SS)",CAPTTEXT
          MOVE      "emviut01",FIELDNAM
          MOVE      EMVIUT01,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Time 2  (HH:MM:SS)",CAPTTEXT
          MOVE      "emviut02",FIELDNAM
          MOVE      EMVIUT02,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Ward Request Time    (HH:MM:SS)",CAPTTEXT
          MOVE      "emviut03",FIELDNAM
          MOVE      EMVIUT03,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Ward Allocation Time (HH:MM:SS)",CAPTTEXT
          MOVE      "emviut04",FIELDNAM
          MOVE      EMVIUT04,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Bed Ready Time       (HH:MM:SS)",CAPTTEXT
          MOVE      "emviut05",FIELDNAM
          MOVE      EMVIUT05,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Time 6  (HH:MM:SS)",CAPTTEXT
          MOVE      "emviut06",FIELDNAM
          MOVE      EMVIUT06,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Time 7  (HH:MM:SS)",CAPTTEXT
          MOVE      "emviut07",FIELDNAM
          MOVE      EMVIUT07,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Time 8  (HH:MM:SS)",CAPTTEXT
          MOVE      "emviut08",FIELDNAM
          MOVE      EMVIUT08,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Time 9  (HH:MM:SS)",CAPTTEXT
          MOVE      "emviut09",FIELDNAM
          MOVE      EMVIUT09,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Time 10 (HH:MM:SS)",CAPTTEXT
          MOVE      "emviut10",FIELDNAM
          MOVE      EMVIUT10,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def. Y/N Field 1 (0=no,1=yes)",CAPTTEXT
          MOVE      "emviyn01",FIELDNAM
          MOVE      EMVIYN01,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "C-Type Admission      (0=no,1=yes)",CAPTTEXT
          MOVE      "emviyn02",FIELDNAM
          MOVE      EMVIYN02,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def. Y/N Field 3 (0=no,1=yes)",CAPTTEXT
          MOVE      "emviyn03",FIELDNAM
          MOVE      EMVIYN03,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def. Y/N Field 4 (0=no,1=yes)",CAPTTEXT
          MOVE      "emviyn04",FIELDNAM
          MOVE      EMVIYN04,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def. Y/N Field 5 (0=no,1=yes)",CAPTTEXT
          MOVE      "emviyn05",FIELDNAM
          MOVE      EMVIYN01,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def. Y/N Field 6 (0=no,1=yes)",CAPTTEXT
          MOVE      "emviyn06",FIELDNAM
          MOVE      EMVIYN06,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def. Y/N Field 7 (0=no,1=yes)",CAPTTEXT
          MOVE      "emviyn07",FIELDNAM
          MOVE      EMVIYN07,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def. Y/N Field 8 (0=no,1=yes)",CAPTTEXT
          MOVE      "emviyn08",FIELDNAM
          MOVE      EMVIYN08,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Def. Y/N Field 9 (0=no,1=yes)",CAPTTEXT
          MOVE      "emviyn09",FIELDNAM
          MOVE      EMVIYN09,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Ongoing Care Communic.(0=no,1=yes)",CAPTTEXT
          MOVE      "emviyn10",FIELDNAM
          MOVE      EMVIYN10,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Text Field 1",CAPTTEXT
          MOVE      "emvitxt1",FIELDNAM
          MOVE      EMVITXT1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Text Field 2",CAPTTEXT
          MOVE      "emvitxt2",FIELDNAM
          MOVE      EMVITXT2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Text Field 3",CAPTTEXT
          MOVE      "emvitxt3",FIELDNAM
          MOVE      EMVITXT3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Text Field 4",CAPTTEXT
          MOVE      "emvitxt4",FIELDNAM
          MOVE      EMVITXT4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Text Field 5",CAPTTEXT
          MOVE      "emvitxt5",FIELDNAM
          MOVE      EMVITXT5,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Numeric Field 1",CAPTTEXT
          MOVE      "emviun01",FIELDNAM
          MOVE      EMVIUN01,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Numeric Field 2",CAPTTEXT
          MOVE      "emviun02",FIELDNAM
          MOVE      EMVIUN02,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Numeric Field 3",CAPTTEXT
          MOVE      "emviun03",FIELDNAM
          MOVE      EMVIUN03,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Numeric Field 4",CAPTTEXT
          MOVE      "emviun04",FIELDNAM
          MOVE      EMVIUN04,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Numeric Field 5",CAPTTEXT
          MOVE      "emviun05",FIELDNAM
          MOVE      EMVIUN05,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Elapsed Since Accident (cat. AE)",CAPTTEXT
          MOVE      "emvielap",FIELDNAM
          MOVE      EMVIELAP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "AE",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVINSDT
          IF        !@EQUAL
            UNPACK    EMVINSDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date First Seen by Nurse (CCYYMMDD)",CAPTTEXT
          MOVE      "emvinsdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time First Seen by Nurse (HH:MM:SS)",CAPTTEXT
          MOVE      "emvinstm",FIELDNAM
          MOVE      EMVINSTM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIDRDT
          IF        !@EQUAL
            UNPACK    EMVIDRDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date First Seen by Doct. (CCYYMMDD)",CAPTTEXT
          MOVE      "emvidrdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time First Seen by Doct. (HH:MM:SS)",CAPTTEXT
          MOVE      "emvidrtm",FIELDNAM
          MOVE      EMVIDRTM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Number of Previous Attendences",CAPTTEXT
          MOVE      "emvipatt",FIELDNAM
          MOVE      EMVIPATT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Transfer Source Code",CAPTTEXT
          MOVE      "emvitsrc",FIELDNAM
          MOVE      EMVITSRC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Discharge Destination Code",CAPTTEXT
          MOVE      "emvidest",FIELDNAM
          MOVE      EMVIDEST,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Ambulance Case Number",CAPTTEXT
          MOVE      "emviambl",FIELDNAM
          MOVE      EMVIAMBL,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Body Region",CAPTTEXT
          MOVE      "emviregn",FIELDNAM
          MOVE      EMVIREGN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Extract Sent (0=No,1=Yes)",CAPTTEXT
          MOVE      "emvisent",FIELDNAM
          MOVE      EMVISENT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Doctor Field 1",CAPTTEXT
          MOVE      "emviur01",FIELDNAM
          MOVE      EMVIUR01,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Doctor Field 2",CAPTTEXT
          MOVE      "emviur02",FIELDNAM
          MOVE      EMVIUR02,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Doctor Field 3",CAPTTEXT
          MOVE      "emviur03",FIELDNAM
          MOVE      EMVIUR03,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Doctor Field 4",CAPTTEXT
          MOVE      "emviur04",FIELDNAM
          MOVE      EMVIUR04,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Doctor Field 5",CAPTTEXT
          MOVE      "emviur05",FIELDNAM
          MOVE      EMVIUR05,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient System AdmNo (if admitted)",CAPTTEXT
          MOVE      "emvipadm",FIELDNAM
          MOVE      EMVIPADM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Expected Ward (Patient System)",CAPTTEXT
          MOVE      "emviewrd",FIELDNAM
          MOVE      EMVIEWRD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Expected Bed  (Patient System)",CAPTTEXT
          MOVE      "emviebed",FIELDNAM
          MOVE      EMVIEBED,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Health Fund Member Number",CAPTTEXT
          MOVE      "emvihfmn",FIELDNAM
          MOVE      EMVIHFMN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Admission Class (category P)",CAPTTEXT
          MOVE      "emviacls",FIELDNAM
          MOVE      EMVIACLS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "P ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Care Class (category CC)",CAPTTEXT
          MOVE      "emviccls",FIELDNAM
          MOVE      EMVICCLS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CC",CODECATG
          CALL      FRMT0000
.
          MOVE      "Triage Nurse",CAPTTEXT
          MOVE      "emvitrns",FIELDNAM
          MOVE      EMVITRNS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Dummy Field 1",CAPTTEXT
          MOVE      "emvidum1",FIELDNAM
          MOVE      EMVIDUM1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVITRDT
          IF        !@EQUAL
            UNPACK    EMVITRDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Triage Date (CCYYMMDD)",CAPTTEXT
          MOVE      "emvitrdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Triage Time",CAPTTEXT
          MOVE      "emvitrtm",FIELDNAM
          MOVE      EMVITRTM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Attending Nurse",CAPTTEXT
          MOVE      "emviatns",FIELDNAM
          MOVE      EMVIATNS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Dummy Field 2",CAPTTEXT
          MOVE      "emvidum2",FIELDNAM
          MOVE      EMVIDUM2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "External Location Code (emrlocaf)",CAPTTEXT
          MOVE      "emviexlc",FIELDNAM
          MOVE      EMVIEXLC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Emergency Site Code",CAPTTEXT
          MOVE      "emvisite",FIELDNAM
          MOVE      EMVISITE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Unit (category AC)",CAPTTEXT
          MOVE      "emviunit",FIELDNAM
          MOVE      EMVIUNIT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "AC",CODECATG
          CALL      FRMT0000
.
          MOVE      "Complaint Line 3",CAPTTEXT
          MOVE      "emvicom3",FIELDNAM
          MOVE      EMVICOM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Complaint Line 4",CAPTTEXT
          MOVE      "emvicom4",FIELDNAM
          MOVE      EMVICOM4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Complaint Line 5",CAPTTEXT
          MOVE      "emvicom5",FIELDNAM
          MOVE      EMVICOM5,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Complaint Line 6",CAPTTEXT
          MOVE      "emvicom6",FIELDNAM
          MOVE      EMVICOM6,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Injury Description Line 1",CAPTTEXT
          MOVE      "emviinj1",FIELDNAM
          MOVE      EMVIINJ1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Injury Description Line 2",CAPTTEXT
          MOVE      "emviinj2",FIELDNAM
          MOVE      EMVIINJ2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Nature of Main Injury (cat ex)",CAPTTEXT
          MOVE      "emvinati",FIELDNAM
          MOVE      EMVINATI,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ex",CODECATG
          CALL      FRMT0000
.
          MOVE      "Injury Cause (cat ey)",CAPTTEXT
          MOVE      "emviinjc",FIELDNAM
          MOVE      EMVIINJC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ey",CODECATG
          CALL      FRMT0000
.
          MOVE      "Human Intent (cat ez)",CAPTTEXT
          MOVE      "emvihumi",FIELDNAM
          MOVE      EMVIHUMI,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ez",CODECATG
          CALL      FRMT0000
.
          MOVE      "Activity When Injured (cat EY)",CAPTTEXT
          MOVE      "emviacti",FIELDNAM
          MOVE      EMVIACTI,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "EY",CODECATG
          CALL      FRMT0000
.
          MOVE      "Other Location Description",CAPTTEXT
          MOVE      "emviloco",FIELDNAM
          MOVE      EMVILOCO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Previous Location (emrlocaf)",CAPTTEXT
          MOVE      "emviprlo",FIELDNAM
          MOVE      EMVIPRLO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time left Previous Location",CAPTTEXT
          MOVE      "emviprtm",FIELDNAM
          MOVE      EMVIPRTM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIDPDT
          IF        !@EQUAL
            UNPACK    EMVIDPDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Departure Date (CCYYMMDD)",CAPTTEXT
          MOVE      "emvidpdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Departure Time",CAPTTEXT
          MOVE      "emvidptm",FIELDNAM
          MOVE      EMVIDPTM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Extended Visit Reason (cat RX)",CAPTTEXT
          MOVE      "emviexrs",FIELDNAM
          MOVE      EMVIEXRS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "RX",CODECATG
          CALL      FRMT0000
.
          MOVE      "Departure Delay Reason (cat RY)",CAPTTEXT
          MOVE      "emvidlrs",FIELDNAM
          MOVE      EMVIDLRS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "RY",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVISPDT
          IF        !@EQUAL
            UNPACK    EMVISPDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Speciality Date (CCYYMMDD)",CAPTTEXT
          MOVE      "emvispdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Speciality Time",CAPTTEXT
          MOVE      "emvisptm",FIELDNAM
          MOVE      EMVISPTM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVISADT
          IF        !@EQUAL
            UNPACK    EMVISADT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Speciality Arrival Date (CCYYMMDD)",CAPTTEXT
          MOVE      "emvisadt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Speciality Arrival Time",CAPTTEXT
          MOVE      "emvisatm",FIELDNAM
          MOVE      EMVISATM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Mental Health Practitioner (pmshcpaf)",CAPTTEXT
          MOVE      "emvimpra",FIELDNAM
          MOVE      EMVIMPRA,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIMPDT
          IF        !@EQUAL
            UNPACK    EMVIMPDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date First Seen by MH Prac. (CCYYMMDD)",CAPTTEXT
          MOVE      "emvimpdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time First Seen by MH Practitioner",CAPTTEXT
          MOVE      "emvimptm",FIELDNAM
          MOVE      EMVIMPTM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIAADT
          IF        !@EQUAL
            UNPACK    EMVIAADT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Ambulance Arrival Date (CCYYMMDD)",CAPTTEXT
          MOVE      "emviaadt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Ambulance Arrival Time",CAPTTEXT
          MOVE      "emviaatm",FIELDNAM
          MOVE      EMVIAATM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIAHDT
          IF        !@EQUAL
            UNPACK    EMVIAHDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Ambulance Handover Date (CCYYMMDD)",CAPTTEXT
          MOVE      "emviahdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Ambulance Handover Time",CAPTTEXT
          MOVE      "emviahtm",FIELDNAM
          MOVE      EMVIAHTM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIDADT
          IF        !@EQUAL
            UNPACK    EMVIDADT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Decision to Admit Date (CCYYMMDD)",CAPTTEXT
          MOVE      "emvidadt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Decision to Admit Time",CAPTTEXT
          MOVE      "emvidatm",FIELDNAM
          MOVE      EMVIDATM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Health Purchaser (cat HP)",CAPTTEXT
          MOVE      "emvipurc",FIELDNAM
          MOVE      EMVIPURC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "HP",CODECATG
          CALL      FRMT0000
.
          MOVE      "Meet & Greet Ass. Nurse Code (pmshcpaf)",CAPTTEXT
          MOVE      "emvimncd",FIELDNAM
          MOVE      EMVIMNCD,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIMNDT
          IF        !@EQUAL
            UNPACK    EMVIMNDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Meet & Greet Ass. Nurse Seen Date (CCYYMMDD)",CAPTTEXT
          MOVE      "emvimndt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Meet & Greet Ass. Nurse Time Seen",CAPTTEXT
          MOVE      "emvimntm",FIELDNAM
          MOVE      EMVIMNTM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Meet & Greet Ass. Doctor Code (pmshcpaf)",CAPTTEXT
          MOVE      "emvimdcd",FIELDNAM
          MOVE      EMVIMDCD,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,EMVIMDDT
          IF        !@EQUAL
            UNPACK    EMVIMDDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Meet & Greet Ass. Doctor Date Seen (CCYYMMDD)",CAPTTEXT
          MOVE      "emvimddt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Meet & Greet Ass. Doctor Time Seen",CAPTTEXT
          MOVE      "emvimdtm",FIELDNAM
          MOVE      EMVIMDTM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      ZERO,EXIT
          GOTO      LODE9999
.
LODE9500  DISPLAY   *P1:24,*EL,*B,"EMR Holding file data not found.  ";
          CALL      HITENTER
          MOVE      ONE,EXIT
.         
LODE9999  RETURN    
+
.*****************************************************************************
.*                  LODN0000                           Called by : VINB0000  *
.*     Load the ALL referral and encounter details into the temporary file   *
.*****************************************************************************
.
.         Read the ALL holding file data
.
LODN0000  MOVE      H7CIMESI,KEY20
          CALL      RDALQUE1                     * record found ?
          BRANCH    OVRCD,LODN9500               * no - error
.         
          MOVE      "ALL Data",DIM78
          RESET     DIM78
          PACK      DIM78,DIM78,SP80
          CALL      WLIN0000                     * write the data line
.
          MOVE      SP80,DIM78
          CALL      WLIN0000         
.
          MOVE      "Visit Number",CAPTTEXT
          MOVE      "alrevisn",FIELDNAM
          MOVE      ALREVISN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
.         Check if this is a referral message (only show referral details),
.         or if it is an encounter message (show both referral and encounter
.         details).
.
          MATCH     ANSI,H7CIMETP                * referral message ?
          GOTO      LODN5000 IF EQUAL            * yes - only show referral
.
.         Display Encounter fields
.
          MOVE      "Encounter Number",CAPTTEXT
          MOVE      "alenenct",FIELDNAM
          MOVE      ALENENCT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Type",CAPTTEXT
          MOVE      "alenclin",FIELDNAM
          MOVE      ALENCLIN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Service Provider",CAPTTEXT
          MOVE      "alenhcp",FIELDNAM
          MOVE      ALENHCP,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALENSDAT
          IF        !@EQUAL
            UNPACK    ALENSDAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Service Date (CCYYMMDD)",CAPTTEXT
          MOVE      "alensdat",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Service Time (HH:MM:SS)",CAPTTEXT
          MOVE      "alenstim",FIELDNAM
          MOVE      ALENSTIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Location of Service (category LD)",CAPTTEXT
          MOVE      "alenloca",FIELDNAM
          MOVE      ALENLOCA,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "LD",CODECATG
          CALL      FRMT0000
.
          MOVE      "Linked Visit Number",CAPTTEXT
          MOVE      "alenlink",FIELDNAM
          MOVE      ALENLINK,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient Type (category GI)",CAPTTEXT
          MOVE      "alentype",FIELDNAM
          MOVE      ALENTYPE,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "GI",CODECATG
          CALL      FRMT0000
.
          MOVE      "Service Type",CAPTTEXT
          MOVE      "alenserv",FIELDNAM
          MOVE      ALENSERV,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Direct Units",CAPTTEXT
          MOVE      "alendiun",FIELDNAM
          MOVE      ALENDIUN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Direct Billable Units",CAPTTEXT
          MOVE      "alendbun",FIELDNAM
          MOVE      ALENDBUN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Indirect Units",CAPTTEXT
          MOVE      "aleninun",FIELDNAM
          MOVE      ALENINUN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Indirect Billable Units",CAPTTEXT
          MOVE      "alenibun",FIELDNAM
          MOVE      ALENIBUN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Bulk Billing Code (category GB)",CAPTTEXT
          MOVE      "alenbulk",FIELDNAM
          MOVE      ALENBULK,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "GB",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALENUDT1
          IF        !@EQUAL
            UNPACK    ALENUDT1,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "User Defined Date 1 (CCYYMMDD)",CAPTTEXT
          MOVE      "alenudt1",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Time 1 (HH:MM:SS)",CAPTTEXT
          MOVE      "alenutm1",FIELDNAM
          MOVE      ALENUTM1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALENUDT2
          IF        !@EQUAL
            UNPACK    ALENUDT2,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "User Defined Date 2 (CCYYMMDD)",CAPTTEXT
          MOVE      "alenudt2",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Time 2 (HH:MM:SS)",CAPTTEXT
          MOVE      "alenutm2",FIELDNAM
          MOVE      ALENUTM2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALENUDT3
          IF        !@EQUAL
            UNPACK    ALENUDT3,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "User Defined Date 3 (CCYYMMDD)",CAPTTEXT
          MOVE      "alenudt1",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Time 3 (HH:MM:SS)",CAPTTEXT
          MOVE      "alenutm3",FIELDNAM
          MOVE      ALENUTM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALENUDT4
          IF        !@EQUAL
            UNPACK    ALENUDT4,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "User Defined Date 4 (CCYYMMDD)",CAPTTEXT
          MOVE      "alenudt4",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Time 4 (HH:MM:SS)",CAPTTEXT
          MOVE      "alenutm4",FIELDNAM
          MOVE      ALENUTM4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Doctor 1",CAPTTEXT
          MOVE      "alenuhc1",FIELDNAM
          MOVE      ALENUHC1,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Doctor 2",CAPTTEXT
          MOVE      "alenuhc2",FIELDNAM
          MOVE      ALENUHC2,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Doctor 3",CAPTTEXT
          MOVE      "alenuhc3",FIELDNAM
          MOVE      ALENUHC3,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Doctor 4",CAPTTEXT
          MOVE      "alenuhc4",FIELDNAM
          MOVE      ALENUHC4,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Diagnosis 1",CAPTTEXT
          MOVE      "alenudi1",FIELDNAM
          MOVE      ALENUDI1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Diagnosis 2",CAPTTEXT
          MOVE      "alenudi2",FIELDNAM
          MOVE      ALENUDI2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Diagnosis 3",CAPTTEXT
          MOVE      "alenudi3",FIELDNAM
          MOVE      ALENUDI3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Free Format Diagnosis 1",CAPTTEXT
          MOVE      "alenudi4",FIELDNAM
          MOVE      ALENUDI4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Free Format Diagnosis 2",CAPTTEXT
          MOVE      "alenudi5",FIELDNAM
          MOVE      ALENUDI5,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Free Format Diagnosis 3",CAPTTEXT
          MOVE      "alenudi6",FIELDNAM
          MOVE      ALENUDI6,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 1",CAPTTEXT
          MOVE      "alenuyn1",FIELDNAM
          MATCH     "1",ALENUYN1
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 2",CAPTTEXT
          MOVE      "alenuyn2",FIELDNAM
          MATCH     "1",ALENUYN2
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 3",CAPTTEXT
          MOVE      "alenuyn3",FIELDNAM
          MATCH     "1",ALENUYN3
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 4",CAPTTEXT
          MOVE      "alenuyn4",FIELDNAM
          MATCH     "1",ALENUYN4
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 5",CAPTTEXT
          MOVE      "alenuyn5",FIELDNAM
          MATCH     "1",ALENUYN5
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 6",CAPTTEXT
          MOVE      "alenuyn6",FIELDNAM
          MATCH     "1",ALENUYN6
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 7",CAPTTEXT
          MOVE      "alenuyn7",FIELDNAM
          MATCH     "1",ALENUYN7
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 8",CAPTTEXT
          MOVE      "alenuyn8",FIELDNAM
          MATCH     "1",ALENUYN8
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 9",CAPTTEXT
          MOVE      "alenuyn9",FIELDNAM
          MATCH     "1",ALENUYN9
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Free Format 1",CAPTTEXT
          MOVE      "alenuff1",FIELDNAM
          MOVE      ALENUFF1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Free Format 2",CAPTTEXT
          MOVE      "alenuff2",FIELDNAM
          MOVE      ALENUFF2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Free Format 3",CAPTTEXT
          MOVE      "alenuff3",FIELDNAM
          MOVE      ALENUFF3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Code 1 (category za)",CAPTTEXT
          MOVE      "alenuc01",FIELDNAM
          MOVE      ALENUC01,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "za",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 2 (category zb)",CAPTTEXT
          MOVE      "alenuc02",FIELDNAM
          MOVE      ALENUC02,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zb",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 3 (category zc)",CAPTTEXT
          MOVE      "alenuc03",FIELDNAM
          MOVE      ALENUC03,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zc",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 4 (category zd)",CAPTTEXT
          MOVE      "alenuc04",FIELDNAM
          MOVE      ALENUC04,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zd",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 5 (category ze)",CAPTTEXT
          MOVE      "alenuc05",FIELDNAM
          MOVE      ALENUC05,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ze",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 6 (category zf)",CAPTTEXT
          MOVE      "alenuc06",FIELDNAM
          MOVE      ALENUC06,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zf",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 7 (category zg)",CAPTTEXT
          MOVE      "alenuc07",FIELDNAM
          MOVE      ALENUC07,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zg",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 8 (category zh)",CAPTTEXT
          MOVE      "alenuc08",FIELDNAM
          MOVE      ALENUC08,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zh",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 9 (category zi)",CAPTTEXT
          MOVE      "alenuc09",FIELDNAM
          MOVE      ALENUC09,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zi",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 10 (category zj)",CAPTTEXT
          MOVE      "alenuc10",FIELDNAM
          MOVE      ALENUC10,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zj",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 11 (category zk)",CAPTTEXT
          MOVE      "alenuc11",FIELDNAM
          MOVE      ALENUC11,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zk",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 12 (category zl)",CAPTTEXT
          MOVE      "alenuc12",FIELDNAM
          MOVE      ALENUC12,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zl",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 13 (category zm)",CAPTTEXT
          MOVE      "alenuc13",FIELDNAM
          MOVE      ALENUC13,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zm",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 14 (category zn)",CAPTTEXT
          MOVE      "alenuc14",FIELDNAM
          MOVE      ALENUC14,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zn",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 15 (category zo)",CAPTTEXT
          MOVE      "alenuc15",FIELDNAM
          MOVE      ALENUC15,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zo",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 16 (category zp)",CAPTTEXT
          MOVE      "alenuc16",FIELDNAM
          MOVE      ALENUC16,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zp",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 17 (category zq)",CAPTTEXT
          MOVE      "alenuc17",FIELDNAM
          MOVE      ALENUC17,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zq",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 18 (category zr)",CAPTTEXT
          MOVE      "alenuc18",FIELDNAM
          MOVE      ALENUC18,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zr",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 19 (category zs)",CAPTTEXT
          MOVE      "alenuc19",FIELDNAM
          MOVE      ALENUC19,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zs",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 20 (category zt)",CAPTTEXT
          MOVE      "alenuc20",FIELDNAM
          MOVE      ALENUC20,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zt",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 21 (category zu)",CAPTTEXT
          MOVE      "alenuc21",FIELDNAM
          MOVE      ALENUC21,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zu",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 22 (category zv)",CAPTTEXT
          MOVE      "alenuc22",FIELDNAM
          MOVE      ALENUC22,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zv",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 23 (category zw)",CAPTTEXT
          MOVE      "alenuc23",FIELDNAM
          MOVE      ALENUC23,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zw",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 24 (category zx)",CAPTTEXT
          MOVE      "alenuc24",FIELDNAM
          MOVE      ALENUC24,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zx",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 25 (category zy)",CAPTTEXT
          MOVE      "alenuc25",FIELDNAM
          MOVE      ALENUC25,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zy",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 26 (category zz)",CAPTTEXT
          MOVE      "alenuc26",FIELDNAM
          MOVE      ALENUC26,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zz",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 27 (category zA)",CAPTTEXT
          MOVE      "alenuc27",FIELDNAM
          MOVE      ALENUC27,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zA",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 28 (category zB)",CAPTTEXT
          MOVE      "alenuc28",FIELDNAM
          MOVE      ALENUC28,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zB",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 29 (category zC)",CAPTTEXT
          MOVE      "alenuc29",FIELDNAM
          MOVE      ALENUC29,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zC",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 30 (category zD)",CAPTTEXT
          MOVE      "alenuc30",FIELDNAM
          MOVE      ALENUC30,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zD",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 31 (category zE)",CAPTTEXT
          MOVE      "alenuc31",FIELDNAM
          MOVE      ALENUC31,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zE",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 32 (category zF)",CAPTTEXT
          MOVE      "alenuc32",FIELDNAM
          MOVE      ALENUC32,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zF",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 33 (category zG)",CAPTTEXT
          MOVE      "alenuc33",FIELDNAM
          MOVE      ALENUC33,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zG",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 34 (category zH)",CAPTTEXT
          MOVE      "alenuc34",FIELDNAM
          MOVE      ALENUC34,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zH",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 35 (category zI)",CAPTTEXT
          MOVE      "alenuc35",FIELDNAM
          MOVE      ALENUC35,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zI",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 36 (category zJ)",CAPTTEXT
          MOVE      "alenuc36",FIELDNAM
          MOVE      ALENUC36,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zJ",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 37 (category zK)",CAPTTEXT
          MOVE      "alenuc37",FIELDNAM
          MOVE      ALENUC37,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zK",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 38 (category zL)",CAPTTEXT
          MOVE      "alenuc38",FIELDNAM
          MOVE      ALENUC38,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zL",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 39 (category zM)",CAPTTEXT
          MOVE      "alenuc39",FIELDNAM
          MOVE      ALENUC39,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zM",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 40 (category zN)",CAPTTEXT
          MOVE      "alenuc40",FIELDNAM
          MOVE      ALENUC40,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zN",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 1",CAPTTEXT
          MOVE      "alenuf01",FIELDNAM
          MOVE      ALENUF01,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 2",CAPTTEXT
          MOVE      "alenuf02",FIELDNAM
          MOVE      ALENUF02,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 3",CAPTTEXT
          MOVE      "alenuf03",FIELDNAM
          MOVE      ALENUF03,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 4",CAPTTEXT
          MOVE      "alenuf04",FIELDNAM
          MOVE      ALENUF04,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 5",CAPTTEXT
          MOVE      "alenuf05",FIELDNAM
          MOVE      ALENUF05,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 6",CAPTTEXT
          MOVE      "alenuf06",FIELDNAM
          MOVE      ALENUF06,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 7",CAPTTEXT
          MOVE      "alenuf07",FIELDNAM
          MOVE      ALENUF07,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 8",CAPTTEXT
          MOVE      "alenuf08",FIELDNAM
          MOVE      ALENUF08,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 9",CAPTTEXT
          MOVE      "alenuf09",FIELDNAM
          MOVE      ALENUF09,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 10",CAPTTEXT
          MOVE      "alenuf10",FIELDNAM
          MOVE      ALENUF10,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 11",CAPTTEXT
          MOVE      "alenuf11",FIELDNAM
          MOVE      ALENUF11,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 12",CAPTTEXT
          MOVE      "alenuf12",FIELDNAM
          MOVE      ALENUF12,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 13",CAPTTEXT
          MOVE      "alenuf13",FIELDNAM
          MOVE      ALENUF13,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 14",CAPTTEXT
          MOVE      "alenuf14",FIELDNAM
          MOVE      ALENUF14,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 15",CAPTTEXT
          MOVE      "alenuf15",FIELDNAM
          MOVE      ALENUF15,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 16",CAPTTEXT
          MOVE      "alenuf16",FIELDNAM
          MOVE      ALENUF16,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 17",CAPTTEXT
          MOVE      "alenuf17",FIELDNAM
          MOVE      ALENUF17,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 18",CAPTTEXT
          MOVE      "alenuf18",FIELDNAM
          MOVE      ALENUF18,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 19",CAPTTEXT
          MOVE      "alenuf19",FIELDNAM
          MOVE      ALENUF19,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Form Field 20",CAPTTEXT
          MOVE      "alenuf20",FIELDNAM
          MOVE      ALENUF20,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Comments 1",CAPTTEXT
          MOVE      "alencmt1",FIELDNAM
          MOVE      ALENCMT1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Comments 2",CAPTTEXT
          MOVE      "alencmt2",FIELDNAM
          MOVE      ALENCMT2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Compensation Code (category CL)",CAPTTEXT
          MOVE      "alencomp",FIELDNAM
          MOVE      ALENCOMP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CL",CODECATG
          CALL      FRMT0000
.
          MOVE      "Private Practice Unique Identifier",CAPTTEXT
          MOVE      "alenuniq",FIELDNAM
          MOVE      ALENUNIQ,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Separate SACS Episode Y/N",CAPTTEXT
          MOVE      "alenssac",FIELDNAM
          MATCH     "1",ALENSSAC
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALENREVD
          IF        !@EQUAL
            UNPACK    ALENREVD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Active (CCYYMMDD)",CAPTTEXT
          MOVE      "alenrevd",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Case Referral",CAPTTEXT
          MOVE      "alencref",FIELDNAM
          MOVE      ALENCREF,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Purchaser (category HP)",CAPTTEXT
          MOVE      "alenpurc",FIELDNAM
          MOVE      ALENPURC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "HP",CODECATG
          CALL      FRMT0000
.
          MOVE      "Contract (category gb)",CAPTTEXT
          MOVE      "alencont",FIELDNAM
          MOVE      ALENCONT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "gb",CODECATG
          CALL      FRMT0000
.
          MOVE      "MOH Indicator",CAPTTEXT
          MOVE      "alenmohr",FIELDNAM
          MOVE      ALENMOHR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
.         Display Referral fields
.
LODN5000  MOVE      "U/R Number",CAPTTEXT
          MOVE      "alreurno",FIELDNAM
          MOVE      ALREURNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      ALRESTAT,FORM1
          MOVE      LSTATDE0,LSTATDES
          LOAD      LSTATDES,FORM1,LSTATDE1,LSTATDE2,LSTATDE3,LSTATDE4:
                             LSTATDE5
          MOVE      "Status",CAPTTEXT
          MOVE      "alrestat",FIELDNAM
          MOVE      LSTATDES,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREDACT
          IF        !@EQUAL
            UNPACK    ALREDACT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Active (CCYYMMDD)",CAPTTEXT
          MOVE      "alredact",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Reason for Closure (category LL)",CAPTTEXT
          MOVE      "alrerclo",FIELDNAM
          MOVE      ALRERCLO,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "LL",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREDCLO
          IF        !@EQUAL
            UNPACK    ALREDCLO,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Closed (CCYYMMDD)",CAPTTEXT
          MOVE      "alredclo",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time Closed (HH:MM:SS)",CAPTTEXT
          MOVE      "alretclo",FIELDNAM
          MOVE      ALRETCLO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "WEB User ID Closed",CAPTTEXT
          MOVE      "alreuclo",FIELDNAM
          MOVE      ALREUCLO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Reason Cancelled (category LN)",CAPTTEXT
          MOVE      "alrercan",FIELDNAM
          MOVE      ALRERCAN,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "LN",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREDCAN
          IF        !@EQUAL
            UNPACK    ALREDCAN,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Cancelled (CCYYMMDD)",CAPTTEXT
          MOVE      "alredcan",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time Cancelled (HH:MM:SS)",CAPTTEXT
          MOVE      "alretcan",FIELDNAM
          MOVE      ALRETCAN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Web User ID Cancelled",CAPTTEXT
          MOVE      "alreucan",FIELDNAM
          MOVE      ALREUCAN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Reason Inactive (category LI)",CAPTTEXT
          MOVE      "alrerina",FIELDNAM
          MOVE      ALRERINA,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "LI",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREDINA
          IF        !@EQUAL
            UNPACK    ALREDINA,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Inactive (CCYYMMDD)",CAPTTEXT
          MOVE      "alredina",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time Inactive (HH:MM:SS)",CAPTTEXT
          MOVE      "alretina",FIELDNAM
          MOVE      ALRETINA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREDINU
          IF        !@EQUAL
            UNPACK    ALREDINU,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Inactive Until (CCYYMMDD)",CAPTTEXT
          MOVE      "alredinu",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Web User ID Inactive",CAPTTEXT
          MOVE      "alreuina",FIELDNAM
          MOVE      ALREUINA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALRERDAT
          IF        !@EQUAL
            UNPACK    ALRERDAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date of Referral (CCYYMMDD)",CAPTTEXT
          MOVE      "alrerdat",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referred to Department",CAPTTEXT
          MOVE      "alrerdep",FIELDNAM
          MOVE      ALRERDEP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referred by Doctor",CAPTTEXT
          MOVE      "alrerdoc",FIELDNAM
          MOVE      ALRERDOC,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP",CAPTTEXT
          MOVE      "alrerhcp",FIELDNAM
          MOVE      ALRERHCP,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring Practice",CAPTTEXT
          MOVE      "alrerhcr",FIELDNAM
          MOVE      ALRERHCR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring Group Count",CAPTTEXT
          MOVE      "alrerhct",FIELDNAM
          MOVE      ALRERHCT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Department Code",CAPTTEXT
          MOVE      "alredept",FIELDNAM
          MOVE      ALREDEPT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Unit Specialty (category AC)",CAPTTEXT
          MOVE      "alreunit",FIELDNAM
          MOVE      ALREUNIT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "AC",CODECATG
          CALL      FRMT0000
.
          MOVE      "Priority (category PR)",CAPTTEXT
          MOVE      "alreprty",FIELDNAM
          MOVE      ALREPRTY,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "PR",CODECATG
          CALL      FRMT0000
.
          MOVE      "Problem Code 1",CAPTTEXT
          MOVE      "alrepro1",FIELDNAM
          MOVE      ALREPRO1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Problem Code 2",CAPTTEXT
          MOVE      "alrepro2",FIELDNAM
          MOVE      ALREPRO2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Problem Code 3",CAPTTEXT
          MOVE      "alrepro3",FIELDNAM
          MOVE      ALREPRO3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Diagnosis Code 1",CAPTTEXT
          MOVE      "alredia1",FIELDNAM
          MOVE      ALREDIA1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Diagnosis Code 2",CAPTTEXT
          MOVE      "alredia2",FIELDNAM
          MOVE      ALREDIA2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Diagnosis Code 3",CAPTTEXT
          MOVE      "alredia3",FIELDNAM
          MOVE      ALREDIA3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "S ",CODECATG                * set defaults
          MOVE      "Source of Referral (category S)",CAPTTEXT
.
          MATCH     SP3,ALREPSIT                 * blank site code ?
          GOTO      LODN6000 IF EQUAL            * yes
.
          MOVE      ALREPSIT,KEY6
          CALL      RDSITA1                      * site code on file ?
          BRANCH    OVRCD,LODN6000               * yes
.
          MATCH     SP2,OSTCATG                  * src of ref category blank ?
          GOTO      LODN6000 IF EQUAL            * yes
.
          MOVE      OSTCATG,CODECATG             * load src of ref category
          MOVE      "Source of Referral (category ",CAPTTEXT
          ENDSET    CAPTTEXT
          STRIP     OSTCATG 
          APPEND    OSTCATG,CAPTTEXT
          APPEND    ")",CAPTTEXT
          RESET     CAPTTEXT
.
LODN6000  MOVE      "alresrce",FIELDNAM
          MOVE      ALRESRCE,DIM50
          MOVE      ONE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Bulk Bill Y/N",CAPTTEXT
          MOVE      "alrebulk",FIELDNAM
          MATCH     "1",ALREBULK
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREDREV
          IF        !@EQUAL
            UNPACK    ALREDREV,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date of Next Review (CCYYMMDD)",CAPTTEXT
          MOVE      "alredrev",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Responsible HCP",CAPTTEXT
          MOVE      "alrehcp",FIELDNAM
          MOVE      ALREHCP,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREDREC
          IF        !@EQUAL
            UNPACK    ALREDREC,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
          MOVE      "Date Referral Received (CCYYMMDD)",CAPTTEXT
          MOVE      "alredrec",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Code 1 (category la)",CAPTTEXT
          MOVE      "alreuc01",FIELDNAM
          MOVE      ALREUC01,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "la",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 2 (category lb)",CAPTTEXT
          MOVE      "alreuc02",FIELDNAM
          MOVE      ALREUC02,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lb",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 3 (category lc)",CAPTTEXT
          MOVE      "alreuc03",FIELDNAM
          MOVE      ALREUC03,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lc",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 4 (category ld)",CAPTTEXT
          MOVE      "alreuc04",FIELDNAM
          MOVE      ALREUC04,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ld",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 5 (category le)",CAPTTEXT
          MOVE      "alreuc05",FIELDNAM
          MOVE      ALREUC05,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "le",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 6 (category lf)",CAPTTEXT
          MOVE      "alreuc06",FIELDNAM
          MOVE      ALREUC06,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lf",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 7 (category lg)",CAPTTEXT
          MOVE      "alreuc07",FIELDNAM
          MOVE      ALREUC07,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lg",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 8 (category lh)",CAPTTEXT
          MOVE      "alreuc08",FIELDNAM
          MOVE      ALREUC08,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lh",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 9 (category li)",CAPTTEXT
          MOVE      "alreuc09",FIELDNAM
          MOVE      ALREUC09,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "li",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 10 (category lj)",CAPTTEXT
          MOVE      "alreuc10",FIELDNAM
          MOVE      ALREUC10,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lj",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 11 (category lk)",CAPTTEXT
          MOVE      "alreuc11",FIELDNAM
          MOVE      ALREUC11,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lk",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 12 (category ll)",CAPTTEXT
          MOVE      "alreuc12",FIELDNAM
          MOVE      ALREUC12,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ll",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 13 (category lm)",CAPTTEXT
          MOVE      "alreuc13",FIELDNAM
          MOVE      ALREUC13,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lm",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 14 (category ln)",CAPTTEXT
          MOVE      "alreuc14",FIELDNAM
          MOVE      ALREUC14,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ln",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 15 (category lo)",CAPTTEXT
          MOVE      "alreuc15",FIELDNAM
          MOVE      ALREUC15,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lo",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 16 (category lp)",CAPTTEXT
          MOVE      "alreuc16",FIELDNAM
          MOVE      ALREUC16,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lp",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 17 (category lq)",CAPTTEXT
          MOVE      "alreuc17",FIELDNAM
          MOVE      ALREUC17,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lq",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 18 (category lr)",CAPTTEXT
          MOVE      "alreuc18",FIELDNAM
          MOVE      ALREUC18,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lr",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 19 (category ls)",CAPTTEXT
          MOVE      "alreuc19",FIELDNAM
          MOVE      ALREUC19,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ls",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 20 (category lt)",CAPTTEXT
          MOVE      "alreuc20",FIELDNAM
          MOVE      ALREUC20,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lt",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 21 (category lu)",CAPTTEXT
          MOVE      "alreuc21",FIELDNAM
          MOVE      ALREUC21,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lu",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 22 (category lv)",CAPTTEXT
          MOVE      "alreuc22",FIELDNAM
          MOVE      ALREUC22,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lv",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 23 (category lw)",CAPTTEXT
          MOVE      "alreuc23",FIELDNAM
          MOVE      ALREUC23,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lw",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 24 (category lx)",CAPTTEXT
          MOVE      "alreuc24",FIELDNAM
          MOVE      ALREUC24,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lx",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 25 (category ly)",CAPTTEXT
          MOVE      "alreuc25",FIELDNAM
          MOVE      ALREUC25,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ly",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 26 (category lz)",CAPTTEXT
          MOVE      "alreuc26",FIELDNAM
          MOVE      ALREUC26,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lz",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 27 (category lA)",CAPTTEXT
          MOVE      "alreuc27",FIELDNAM
          MOVE      ALREUC27,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lA",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 28 (category lB)",CAPTTEXT
          MOVE      "alreuc28",FIELDNAM
          MOVE      ALREUC28,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lB",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 29 (category lC)",CAPTTEXT
          MOVE      "alreuc29",FIELDNAM
          MOVE      ALREUC29,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lC",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 30 (category lD)",CAPTTEXT
          MOVE      "alreuc30",FIELDNAM
          MOVE      ALREUC30,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lD",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 31 (category lE)",CAPTTEXT
          MOVE      "alreuc31",FIELDNAM
          MOVE      ALREUC31,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lE",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 32 (category lO)",CAPTTEXT
          MOVE      "alreuc32",FIELDNAM
          MOVE      ALREUC32,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lO",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 33 (category lG)",CAPTTEXT
          MOVE      "alreuc33",FIELDNAM
          MOVE      ALREUC33,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lG",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 34 (category lH)",CAPTTEXT
          MOVE      "alreuc34",FIELDNAM
          MOVE      ALREUC34,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lH",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 35 (category lI)",CAPTTEXT
          MOVE      "alreuc35",FIELDNAM
          MOVE      ALREUC35,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lI",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 36 (category lJ)",CAPTTEXT
          MOVE      "alreuc36",FIELDNAM
          MOVE      ALREUC36,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lJ",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 37 (category lK)",CAPTTEXT
          MOVE      "alreuc37",FIELDNAM
          MOVE      ALREUC37,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lK",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 38 (category lL)",CAPTTEXT
          MOVE      "alreuc38",FIELDNAM
          MOVE      ALREUC38,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lL",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 39 (category lM)",CAPTTEXT
          MOVE      "alreuc39",FIELDNAM
          MOVE      ALREUC39,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lM",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Code 40 (category lN)",CAPTTEXT
          MOVE      "alreuc40",FIELDNAM
          MOVE      ALREUC40,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "lN",CODECATG
          CALL      FRMT0000
.         
          MOVE      "User Defined Y/N 1",CAPTTEXT
          MOVE      "alreuyn1",FIELDNAM
          MATCH     "1",ALREUYN1 
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE      
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
.         
          MOVE      "User Defined Y/N 2",CAPTTEXT
          MOVE      "alreuyn2",FIELDNAM
          MATCH     "1",ALREUYN2 
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE      
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "User Defined Y/N 3",CAPTTEXT
          MOVE      "alreuyn3",FIELDNAM
          MATCH     "1",ALREUYN3 
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE      
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "User Defined Y/N 4",CAPTTEXT
          MOVE      "alreuyn4",FIELDNAM
          MATCH     "1",ALREUYN4 
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE      
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined HCP 1",CAPTTEXT
          MOVE      "alreuhc1",FIELDNAM
          MOVE      ALREUHC1,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined HCP 2",CAPTTEXT
          MOVE      "alreuhc2",FIELDNAM
          MOVE      ALREUHC2,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined HCP 3",CAPTTEXT
          MOVE      "alreuhc3",FIELDNAM
          MOVE      ALREUHC3,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined HCP 4",CAPTTEXT
          MOVE      "alreuhc4",FIELDNAM
          MOVE      ALREUHC4,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Free Format 1",CAPTTEXT
          MOVE      "alreufr1",FIELDNAM
          MOVE      ALREUFR1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Free Format 2",CAPTTEXT
          MOVE      "alreufr2",FIELDNAM
          MOVE      ALREUFR2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREUDT1
          IF        !@EQUAL
            UNPACK    ALREUDT1,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "User Defined Date 1 (CCYYMMDD)",CAPTTEXT
          MOVE      "alreudt1",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "User Defined Time 1 (HH:MM:SS)",CAPTTEXT
          MOVE      "alreutm1",FIELDNAM
          MOVE      ALREUTM1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREUDT2
          IF        !@EQUAL
            UNPACK    ALREUDT2,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "User Defined Date 2 (CCYYMMDD)",CAPTTEXT
          MOVE      "alreudt2",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "User Defined Time 2 (HH:MM:SS)",CAPTTEXT
          MOVE      "alreutm2",FIELDNAM
          MOVE      ALREUTM2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREUDT3
          IF        !@EQUAL
            UNPACK    ALREUDT3,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "User Defined Date 3 (CCYYMMDD)",CAPTTEXT
          MOVE      "alreudt3",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "User Defined Time 3 (HH:MM:SS)",CAPTTEXT
          MOVE      "alreutm3",FIELDNAM
          MOVE      ALREUTM3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREUDT4
          IF        !@EQUAL
            UNPACK    ALREUDT4,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "User Defined Date 4 (CCYYMMDD)",CAPTTEXT
          MOVE      "alreudt4",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "User Defined Time 4 (HH:MM:SS)",CAPTTEXT
          MOVE      "alreutm4",FIELDNAM
          MOVE      ALREUTM4,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "User Defined Numeric 1",CAPTTEXT
          MOVE      "alreuno1",FIELDNAM
          MOVE      ALREUNO1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.         
          MOVE      "Job Number (Orthotics)",CAPTTEXT
          MOVE      "alreuno2",FIELDNAM
          MOVE      ALREUNO2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic Type",CAPTTEXT
          MOVE      "alrectyp",FIELDNAM
          MOVE      ALRECTYP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Hospital/Unit Number",CAPTTEXT
          MOVE      "alrehosn",FIELDNAM
          MOVE      ALREHOSN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP",CAPTTEXT
          MOVE      "alrefhcp",FIELDNAM
          MOVE      ALREFHCP,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP Address 1",CAPTTEXT
          MOVE      "alrehcp1",FIELDNAM
          MOVE      ALREHCP1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP Address 2",CAPTTEXT
          MOVE      "alrehcp2",FIELDNAM
          MOVE      ALREHCP2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP Address 3",CAPTTEXT
          MOVE      "alrehcp3",FIELDNAM
          MOVE      ALREHCP3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP Postcode",CAPTTEXT
          MOVE      "alrehcpc",FIELDNAM
          MOVE      ALREHCPC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP State",CAPTTEXT
          MOVE      "alrehcps",FIELDNAM
          MOVE      ALREHCPS,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP Bus. Phone",CAPTTEXT
          MOVE      "alrehcpb",FIELDNAM
          MOVE      ALREHCPB,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP Bus. Fax",CAPTTEXT
          MOVE      "alrehcpf",FIELDNAM
          MOVE      ALREHCPF,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring HCP Provider No",CAPTTEXT
          MOVE      "alrehcpp",FIELDNAM
          MOVE      ALREHCPP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Slot Type (category CV)",CAPTTEXT
          MOVE      "alrestyp",FIELDNAM
          MOVE      ALRESTYP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CV",CODECATG
          CALL      FRMT0000
.
          MOVE      "Presenting Complaint",CAPTTEXT
          MOVE      "alreprcm",FIELDNAM
          MOVE      ALREPRCM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Preferred Site",CAPTTEXT
          MOVE      "alrepsit",FIELDNAM
          MOVE      ALREPSIT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Clinic ID",CAPTTEXT
          MOVE      "alreclid",FIELDNAM
          MOVE      ALRECLID,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Claim Status (category sc)",CAPTTEXT
          MOVE      "alrecsta",FIELDNAM
          MOVE      ALRECSTA,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "sc",CODECATG
          CALL      FRMT0000
.
          MOVE      "HIC Reason for Rejection (category hr)",CAPTTEXT
          MOVE      "alrerrej",FIELDNAM
          MOVE      ALRERREJ,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "hr",CODECATG
          CALL      FRMT0000
.
          MOVE      "Claim Comments",CAPTTEXT
          MOVE      "alreccom",FIELDNAM
          MOVE      ALRECCOM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Type of Referral (category RI)",CAPTTEXT
          MOVE      "alrertyp",FIELDNAM
          MOVE      ALRERTYP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "RI",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREREXP
          IF        !@EQUAL
            UNPACK    ALREREXP,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Referral Expiry Date (CCYYMMDD)",CAPTTEXT
          MOVE      "alrerexp",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREMDAT
          IF        !@EQUAL
            UNPACK    ALREMDAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Must be Seen by Date (CCYYMMDD)",CAPTTEXT
          MOVE      "alremdat",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREPRDT
          IF        !@EQUAL
            UNPACK    ALREPRDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Priority Date (CCYYMMDD)",CAPTTEXT
          MOVE      "alreprdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "SACS Reason for Rejection (category rr)",CAPTTEXT
          MOVE      "alresrej",FIELDNAM
          MOVE      ALRESREJ,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "rr",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALRESRDT
          IF        !@EQUAL
            UNPACK    ALRESRDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "SACS Date Rejected (CCYYMMDD)",CAPTTEXT
          MOVE      "alresrdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "SACS Time Rejected (HH:MM:SS)",CAPTTEXT
          MOVE      "alresrtm",FIELDNAM
          MOVE      ALRESRTM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "SACS Web User Rejected",CAPTTEXT
          MOVE      "alresrui",FIELDNAM 
          MOVE      ALRESRUI,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREUDT5
          IF        !@EQUAL
            UNPACK    ALREUDT5,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "User Defined Date 5 (CCYYMMDD)",CAPTTEXT
          MOVE      "alreudt5",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Time 5 (HH:MM:SS)",CAPTTEXT
          MOVE      "alreutm5",FIELDNAM
          MOVE      ALREUTM5,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 5",CAPTTEXT
          MOVE      "alreuyn5",FIELDNAM
          MATCH     "1",ALREUYN5
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Web User ID 1",CAPTTEXT
          MOVE      "alreudid",FIELDNAM 
          MOVE      ALREUDID,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREUDT6
          IF        !@EQUAL
            UNPACK    ALREUDT6,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "User Defined Date 6 (CCYYMMDD)",CAPTTEXT
          MOVE      "alreudt6",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Time 6 (HH:MM:SS)",CAPTTEXT
          MOVE      "alreutm6",FIELDNAM
          MOVE      ALREUTM6,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 6",CAPTTEXT
          MOVE      "alreuyn6",FIELDNAM
          MATCH     "1",ALREUYN6
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREREVD
          IF        !@EQUAL
            UNPACK    ALREREVD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Case Review Date (CCYYMMDD)",CAPTTEXT
          MOVE      "alrerevd",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Purchaser (category HP)",CAPTTEXT
          MOVE      "alrepurc",FIELDNAM
          MOVE      ALREPURC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "HP",CODECATG
          CALL      FRMT0000
.
          MOVE      "Outcome of Priority (category AO)",CAPTTEXT
          MOVE      "alreoutp",FIELDNAM
          MOVE      ALREOUTP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "AO",CODECATG
          CALL      FRMT0000
.
          MOVE      "Contract (category gb)",CAPTTEXT
          MOVE      "alrecont",FIELDNAM
          MOVE      ALRECONT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "gb",CODECATG
          CALL      FRMT0000
.
          MOVE      "Score",CAPTTEXT
          MOVE      "alrescor",FIELDNAM 
          MOVE      ALRESCOR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "MOH Indicator Record sent to MHINC",CAPTTEXT
          MOVE      "alremohr",FIELDNAM 
          MOVE      ALREMOHR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Event Program (category zG)",CAPTTEXT
          MOVE      "alreevpr",FIELDNAM
          MOVE      ALREEVPR,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "zG",CODECATG
          CALL      FRMT0000
.
          MOVE      "Diagnosis Code Free Text",CAPTTEXT
          MOVE      "alrediat",FIELDNAM 
          MOVE      ALREDIAT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 7",CAPTTEXT
          MOVE      "alreuyn7",FIELDNAM
          MATCH     "1",ALREUYN7
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 8",CAPTTEXT
          MOVE      "alreuyn8",FIELDNAM
          MATCH     "1",ALREUYN8
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 9",CAPTTEXT
          MOVE      "alreuyn9",FIELDNAM
          MATCH     "1",ALREUYN9
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Code 1",CAPTTEXT
          MOVE      "alreucd1",FIELDNAM 
          MOVE      ALREUCD1,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Code 2",CAPTTEXT
          MOVE      "alreucd2",FIELDNAM 
          MOVE      ALREUCD2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Code 3",CAPTTEXT
          MOVE      "alreucd3",FIELDNAM 
          MOVE      ALREUCD3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Originating Referral",CAPTTEXT
          MOVE      "alreorig",FIELDNAM 
          MOVE      ALREORIG,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 10",CAPTTEXT
          MOVE      "alreyn10",FIELDNAM
          MATCH     "1",ALREYN10
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 11",CAPTTEXT
          MOVE      "alreyn11",FIELDNAM
          MATCH     "1",ALREYN11
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Y/N 12",CAPTTEXT
          MOVE      "alreyn12",FIELDNAM
          MATCH     "1",ALREYN12
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREUDT7
          IF        !@EQUAL
            UNPACK    ALREUDT7,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "User Defined Date 7 (CCYYMMDD)",CAPTTEXT
          MOVE      "alreudt7",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Time 7 (HH:MM:SS)",CAPTTEXT
          MOVE      "alreutm7",FIELDNAM
          MOVE      ALREUTM7,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREUDT8
          IF        !@EQUAL
            UNPACK    ALREUDT8,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "User Defined Date 8 (CCYYMMDD)",CAPTTEXT
          MOVE      "alreudt8",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Time 8 (HH:MM:SS)",CAPTTEXT
          MOVE      "alreutm8",FIELDNAM
          MOVE      ALREUTM8,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREUDT9
          IF        !@EQUAL
            UNPACK    ALREUDT9,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "User Defined Date 9 (CCYYMMDD)",CAPTTEXT
          MOVE      "alreudt9",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Time 9 (HH:MM:SS)",CAPTTEXT
          MOVE      "alreutm9",FIELDNAM
          MOVE      ALREUTM9,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREEIOD
          IF        !@EQUAL
            UNPACK    ALREEIOD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Impairment Onset Date (CCYYMMDD)",CAPTTEXT
          MOVE      "alreeiod",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREACDD
          IF        !@EQUAL
            UNPACK    ALREACDD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Adv. Care Plan Doc. Date (CCYYMMDD)",CAPTTEXT
          MOVE      "alreacdd",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREUD10
          IF        !@EQUAL
            UNPACK    ALREUD10,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "User Defined Date 10 (CCYYMMDD)",CAPTTEXT
          MOVE      "alreud10",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Non-VINAH Referral Y/N",CAPTTEXT
          MOVE      "alrenvin",FIELDNAM
          MATCH     "1",ALRENVIN
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALRECDAT
          IF        !@EQUAL
            UNPACK    ALRECDAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Date Record Created (CCYYMMDD)",CAPTTEXT
          MOVE      "alrecdat",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Time Record Created (HH:MM:SS)",CAPTTEXT
          MOVE      "alrectim",FIELDNAM
          MOVE      ALRECTIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,ALREUDAT
          IF        !@EQUAL
            UNPACK    ALREUDAT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Update Date (CCYYMMDD)",CAPTTEXT
          MOVE      "alreudat",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Triage Status (category ts)",CAPTTEXT
          MOVE      "alretrgs",FIELDNAM
          MOVE      ALRETRGS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "ts",CODECATG
          CALL      FRMT0000
.
          MOVE      ZERO,EXIT
          GOTO      LODN9999
.
LODN9500  DISPLAY   *P1:24,*EL,*B,"ALL Holding file data not found.  ";
          CALL      HITENTER
          MOVE      ONE,EXIT
.
LODN9999  RETURN
+
.*****************************************************************************
.*                  LODW0000                           Called by : VINB0000  *
.*     Load the W/L Booking details into the temporary file                  *
.*****************************************************************************
.
.         Read the W/L holding file data
.
LODW0000  MOVE      H7CIMESI,KEY20
          CALL      RDWTQUE1                     * record found ?
          BRANCH    OVRCD,LODW9500               * no - error
.         
          MOVE      "W/L Data",DIM78
          RESET     DIM78
          PACK      DIM78,DIM78,SP80
          CALL      WLIN0000                     * write the data line
.
          MOVE      SP80,DIM78
          CALL      WLIN0000         
.
          MOVE      "U/R Number",CAPTTEXT
          MOVE      "wmurno",FIELDNAM
          MOVE      WMURNO,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Procedure Code",CAPTTEXT
          MOVE      "wmcode",FIELDNAM
          MOVE      WMCODE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Procedure Time",CAPTTEXT
          MOVE      "wmtime",FIELDNAM
          MOVE      WMTIME,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Procedure Description",CAPTTEXT
          MOVE      "wmdesc",FIELDNAM
          MOVE      WMDESC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Reason for Procedure",CAPTTEXT
          MOVE      "wmreason",FIELDNAM
          MOVE      WMREASON,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Procedure Status",CAPTTEXT
          MOVE      "dwmstat",FIELDNAM
          MOVE      DWMSTAT,F1
          LOAD      WMSTDESC,F1,WMSTDSC1,WMSTDSC2,WMSTDSC3,WMSTDSC4,WMSTDSC5:
                                WMSTDSC6,WMSTDSC7,WMSTDSC8,WMSTDSC9
          MOVE      WMSTDESC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WMDATE1
          IF        !@EQUAL
            UNPACK    WMDATE1,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Date on List (CCYYMMDD)",CAPTTEXT
          MOVE      "wmdate1",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WMDATE2
          IF        !@EQUAL
            UNPACK    WMDATE2,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Date of Last Review (CCYYMMDD)",CAPTTEXT
          MOVE      "wmdate2",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WMDATE3
          IF        !@EQUAL
            UNPACK    WMDATE3,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Scheduled Admission Date (CCYYMMDD)",CAPTTEXT
          MOVE      "wmdate3",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WMDATE4
          IF        !@EQUAL
            UNPACK    WMDATE4,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Removal Date (CCYYMMDD)",CAPTTEXT
          MOVE      "wmdate4",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Unit/Clinic (category WU)",CAPTTEXT
          MOVE      "wmunit",FIELDNAM
          MOVE      WMUNIT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "WU",CODECATG
          CALL      FRMT0000
.         
          MOVE      "Attending Doctor",CAPTTEXT
          MOVE      "wmdoctor",FIELDNAM
          MOVE      WMDOCTOR,DIM50
          MOVE      TWO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Estimated Stay",CAPTTEXT
          MOVE      "wmstay",FIELDNAM
          MOVE      WMSTAY,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Priority (category TP)",CAPTTEXT
          MOVE      "wmpty",FIELDNAM
          MOVE      WMPTY,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "TP",CODECATG
          CALL      FRMT0000
.
          MOVE      "Short Notice (category WS)",CAPTTEXT
          MOVE      "wmnotice",FIELDNAM
          MOVE      WMNOTICE,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "WS",CODECATG
          CALL      FRMT0000
.
          MOVE      "Resident Status (category T)",CAPTTEXT
          MOVE      "wmptype",FIELDNAM
          MOVE      WMPTYPE,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "T ",CODECATG
          CALL      FRMT0000
.
          MOVE      "Admission Type (category A)",CAPTTEXT
          MOVE      "wmpcat",FIELDNAM
          MOVE      WMPCAT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "A ",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 1 (category W1)",CAPTTEXT
          MOVE      "wmudef1",FIELDNAM
          MOVE      WMUDEF1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "W1",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 2 (category W2)",CAPTTEXT
          MOVE      "wmudef2",FIELDNAM
          MOVE      WMUDEF2,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "W2",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 3 (category W3)",CAPTTEXT
          MOVE      "wmudef3",FIELDNAM
          MOVE      WMUDEF3,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "W3",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 4 (category W4)",CAPTTEXT
          MOVE      "wmudef4",FIELDNAM
          MOVE      WMUDEF4,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "W4",CODECATG
          CALL      FRMT0000
.
          MOVE      "Booking Number",CAPTTEXT
          MOVE      "wmbook",FIELDNAM
          MOVE      WMBOOK,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WMKEYDT
          IF        !@EQUAL
            UNPACK    WMKEYDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Keyin Date for Procedure (CCYYMMDD)",CAPTTEXT
          MOVE      "wmkeydt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WTWMREAD
          IF        !@EQUAL
            UNPACK    WTWMREAD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Reassessment Date (CCYYMMDD)",CAPTTEXT
          MOVE      "wtwmread",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WTWMDEDA
          IF        !@EQUAL
            UNPACK    WTWMDEDA,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Deferred or Staged Admission Date (CCYYMMDD)",CAPTTEXT
          MOVE      "wtwmdeda",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Admission Class (category P)",CAPTTEXT
          MOVE      "wtwmclss",FIELDNAM
          MOVE      WTWMCLSS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "P ",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WTWMDTAD
          IF        !@EQUAL
            UNPACK    WTWMDTAD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Decision to Admit Date (CCYYMMDD)",CAPTTEXT
          MOVE      "wtwmdtad",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Administrative Category (category CL)",CAPTTEXT
          MOVE      "wtwmacat",FIELDNAM
          MOVE      WTWMACAT,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CL",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WTWMGADD
          IF        !@EQUAL
            UNPACK    WTWMGADD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Guaranteed Admission Date (CCYYMMDD)",CAPTTEXT
          MOVE      "wtwmgadd",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WTWMDABD
          IF        !@EQUAL
            UNPACK    WTWMDABD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Do Not Admit Before Date (CCYYMMDD)",CAPTTEXT
          MOVE      "wtwmdabd",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Elective Admission Type (category CC)",CAPTTEXT
          MOVE      "wtwmeaty",FIELDNAM
          MOVE      WTWMEATY,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CL",CODECATG
          CALL      FRMT0000
.
          MOVE      "Admission Category (category WA)",CAPTTEXT
          MOVE      "wtwmadmc",FIELDNAM
          MOVE      WTWMADMC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "WA",CODECATG
          CALL      FRMT0000
.
          MOVE      "ECR Approval Number",CAPTTEXT
          MOVE      "wtwmecra",FIELDNAM
          MOVE      WTWMECRA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "GPFH Approval Number",CAPTTEXT
          MOVE      "wtwmgpfa",FIELDNAM
          MOVE      WTWMGPFA,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring GP",CAPTTEXT
          MOVE      "wtwmrfgp",FIELDNAM
          MOVE      WTWMRFGP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "GP Practice Code",CAPTTEXT
          MOVE      "wtwmgppc",FIELDNAM
          MOVE      WTWMGPPC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WTWMNAFR
          IF        !@EQUAL
            UNPACK    WTWMNAFR,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Not Available From Date (CCYYMMDD)",CAPTTEXT
          MOVE      "wtwmnafr",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WTWMNATO
          IF        !@EQUAL
            UNPACK    WTWMNATO,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Not Available To Date (CCYYMMDD)",CAPTTEXT
          MOVE      "wtwmnato",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "GP Practice Count",CAPTTEXT
          MOVE      "wtwmgppt",FIELDNAM
          MOVE      WTWMGPPT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "District of Residence (category DA)",CAPTTEXT
          MOVE      "wtwmdofr",FIELDNAM
          MOVE      WTWMDOFR,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "DA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Intended Hospital (pathspaf)",CAPTTEXT
          MOVE      "wtwmihsp",FIELDNAM
          MOVE      WTWMIHSP,DIM50
          MOVE      FOUR,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Validation Letter Sent Flag Y/N",CAPTTEXT
          MOVE      "wtwmvlsf",FIELDNAM
          MATCH     "1",WTWMVLSF
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Procedure Code 2",CAPTTEXT
          MOVE      "wtwmpro2",FIELDNAM
          MOVE      WTWMPRO2,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Procedure Code 3",CAPTTEXT
          MOVE      "wtwmpro3",FIELDNAM
          MOVE      WTWMPRO3,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WTWMTRPA
          IF        !@EQUAL
            UNPACK    WTWMTRPA,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Previous Decision To Admit Date (CCYYMMDD)",CAPTTEXT
          MOVE      "wtwmtrpa",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Field 5 (category X5)",CAPTTEXT
          MOVE      "wmudef5",FIELDNAM
          MOVE      WMUDEF5,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "X5",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 6 (category X6)",CAPTTEXT
          MOVE      "wmudef6",FIELDNAM
          MOVE      WMUDEF6,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "X6",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 7 (category X7)",CAPTTEXT
          MOVE      "wmudef7",FIELDNAM
          MOVE      WMUDEF7,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "X7",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 8 (category X8)",CAPTTEXT
          MOVE      "wmudef8",FIELDNAM
          MOVE      WMUDEF8,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "X8",CODECATG
          CALL      FRMT0000
.
          MOVE      "Patient Rank",CAPTTEXT
          MOVE      "wtwmrank",FIELDNAM
          MOVE      WTWMRANK,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Source of Referral (category S)",CAPTTEXT
          MOVE      "wtwmsrcr",FIELDNAM
          MOVE      WTWMSRCR,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "S ",CODECATG
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WTWMDRSA
          IF        !@EQUAL
            UNPACK    WTWMDRSA,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Date of Referral for first Specialised Assessment (CCYYMMDD)",CAPTTEXT
          MOVE      "wtwmdrsa",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WTWMDOSA
          IF        !@EQUAL
            UNPACK    WTWMDOSA,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Date of first Specialised Assessment (CCYYMMDD)",CAPTTEXT
          MOVE      "wtwmdosa",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Principal Health Service Purchaser (category HP)",CAPTTEXT
          MOVE      "wtwmphsp",FIELDNAM
          MOVE      WTWMPHSP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "HP",CODECATG
          CALL      FRMT0000
.
          MOVE      "Booking Status Code",CAPTTEXT
          MOVE      "wtwmbscd",FIELDNAM
          MOVE      WTWMBSCD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient List Status - PRS/2 (category VL)",CAPTTEXT
          MOVE      "wttxplst",FIELDNAM
          MOVE      WTTXPLST,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "VL",CODECATG
          CALL      FRMT0000
.
          MOVE      "Post-Op Ward",CAPTTEXT
          MOVE      "wttxpowd",FIELDNAM
          MOVE      WTTXPOWD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Admitting Ward",CAPTTEXT
          MOVE      "wttxadmw",FIELDNAM
          MOVE      WTTXADMW,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Parent Staying Y/N",CAPTTEXT
          MOVE      "wttxpsty",FIELDNAM
          MATCH     "1",WTTXPSTY
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Intended Day Case (category XB)",CAPTTEXT
          MOVE      "wttxidyc",FIELDNAM
          MOVE      WTTXIDYC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "XB",CODECATG
          CALL      FRMT0000
.
          MOVE      "Admission Forms (category XA)",CAPTTEXT
          MOVE      "wttxadmf",FIELDNAM
          MOVE      WTTXADMF,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "XA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Equipment Required 1 (category XE)",CAPTTEXT
          MOVE      "wttxeqr1",FIELDNAM
          MOVE      WTTXEQR1,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "XE",CODECATG
          CALL      FRMT0000
.
          MOVE      "Equipment Required 2 (category XE)",CAPTTEXT
          MOVE      "wttxeqr2",FIELDNAM
          MOVE      WTTXEQR2,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "XE",CODECATG
          CALL      FRMT0000
.
          MOVE      "Pre-Admission Status (category XG)",CAPTTEXT
          MOVE      "wttxpast",FIELDNAM
          MOVE      WTTXPAST,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "XG",CODECATG
          CALL      FRMT0000
.
          MOVE      "Consent Y/N",CAPTTEXT
          MOVE      "wttxcnsn",FIELDNAM
          MATCH     "1",WTTXCNSN
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Notify registered GP Y/N",CAPTTEXT
          MOVE      "wttxntgp",FIELDNAM
          MATCH     "1",WTTXNTGP
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Proposed Admission Time",CAPTTEXT
          MOVE      "wttxpatm",FIELDNAM
          MOVE      WTTXPATM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Loan Equipment Required (category XO)",CAPTTEXT
          MOVE      "wttxleqr",FIELDNAM
          MOVE      WTTXLEQR,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "X0",CODECATG
          CALL      FRMT0000
.
          MOVE      "Duplicate Procedure Code",CAPTTEXT
          MOVE      "wttxdprc",FIELDNAM
          MOVE      WTTXDPRC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Duplicate Count",CAPTTEXT
          MOVE      "wttxdpcn",FIELDNAM
          MOVE      WTTXDPCN,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Claim Type (category CL)",CAPTTEXT
          MOVE      "wttxctyp",FIELDNAM
          MOVE      WTTXCTYP,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "CL",CODECATG
          CALL      FRMT0000
.
          MOVE      "Equipment Required 3 (category XE)",CAPTTEXT
          MOVE      "wttxeqr3",FIELDNAM
          MOVE      WTTXEQR3,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "XE",CODECATG
          CALL      FRMT0000
.
          MOVE      "Proposed Pre-Admission Time",CAPTTEXT
          MOVE      "wttxptim",FIELDNAM
          MOVE      WTTXPTIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Proposed Operation Time",CAPTTEXT
          MOVE      "wttxpotm",FIELDNAM
          MOVE      WTTXPOTM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Pre-Anaesthetic Status (category XH)",CAPTTEXT
          MOVE      "wttxpans",FIELDNAM
          MOVE      WTTXPANS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "XH",CODECATG
          CALL      FRMT0000
.
          MOVE      "Pre-Anaesthetic Time",CAPTTEXT
          MOVE      "wttxpant",FIELDNAM
          MOVE      WTTXPANT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Planned 23 Hour Stay Y/N",CAPTTEXT
          MOVE      "wttx23hr",FIELDNAM
          MATCH     "1",WTTX23HR
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Anaesthetic Type (category OA)",CAPTTEXT
          MOVE      "wttxanae",FIELDNAM
          MOVE      WTTXANAE,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "OA",CODECATG
          CALL      FRMT0000
.
          MOVE      "Booking Type (category BK)",CAPTTEXT
          MOVE      "wttxboty",FIELDNAM
          MOVE      WTTXBOTY,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "BK",CODECATG
          CALL      FRMT0000
.
          MOVE      "Team",CAPTTEXT
          MOVE      "wttxteam",FIELDNAM
          MOVE      WTTXTEAM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Funding Source (category cx)",CAPTTEXT
          MOVE      "wttxfund",FIELDNAM
          MOVE      WTTXFUND,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "cx",CODECATG
          CALL      FRMT0000
.
          MOVE      "Ward",CAPTTEXT
          MOVE      "wttxward",FIELDNAM
          MOVE      WTTXWARD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Preferred Accommodation (category BP)",CAPTTEXT
          MOVE      "wttxpref",FIELDNAM
          MOVE      WTTXPREF,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "BP",CODECATG
          CALL      FRMT0000
.
          MOVE      "No WA Hospital Contact (category cw)",CAPTTEXT
          MOVE      "wttxnwhc",FIELDNAM
          MOVE      WTTXNWHC,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "cw",CODECATG
          CALL      FRMT0000
.
          MOVE      "Intended Stay (category VI)",CAPTTEXT
          MOVE      "wttxintd",FIELDNAM
          MOVE      WTTXINTD,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "VI",CODECATG
          CALL      FRMT0000
.
          MOVE      "Medical Authorisation Approved Y/N",CAPTTEXT
          MOVE      "wttxmaut",FIELDNAM
          MATCH     "1",WTTXMAUT
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WTTXEXPD
          IF        !@EQUAL
            UNPACK    WTTXEXPD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Expected Delivery Date (CCYYMMDD)",CAPTTEXT
          MOVE      "wttxexpd",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Tertiary Care Reason (category WH)",CAPTTEXT
          MOVE      "wttxtcrs",FIELDNAM
          MOVE      WTTXTCRS,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "WH",CODECATG
          CALL      FRMT0000
.
          MOVE      "Disaster Code",CAPTTEXT
          MOVE      "wttxdisc",FIELDNAM
          MOVE      WTTXDISC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Removal Time",CAPTTEXT
          MOVE      "wttxrtim",FIELDNAM
          MOVE      WTTXRTIM,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring Clinician",CAPTTEXT
          MOVE      "wttxrcli",FIELDNAM
          MOVE      WTTXRCLI,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Referring Clinician Practice",CAPTTEXT
          MOVE      "wttxrpli",FIELDNAM
          MOVE      WTTXRCLP,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Prior Ward",CAPTTEXT
          MOVE      "savtxwrd",FIELDNAM
          MOVE      SAVTXWRD,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Procedure Description Comments",CAPTTEXT
          MOVE      "wtwmpdsc",FIELDNAM
          MOVE      WTWMPDSC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Record Sent Flag Y/N",CAPTTEXT
          MOVE      "wtwmrsfl",FIELDNAM
          MATCH     ANSY,WTWMRSFL
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "ESIS Unique Count",CAPTTEXT
          MOVE      "wtwmecnt",FIELDNAM
          MOVE      WTWMECNT,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Consent Obtained Y/N",CAPTTEXT
          MOVE      "wtwmcsst",FIELDNAM
          MATCH     ANSY,WTWMCSST
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MOVE      "No",DIM50
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      SP10,CPCDATE
          MATCH     SP8,WTWMCSDT
          IF        !@EQUAL
            UNPACK    WTWMCSDT,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF     
          MOVE      "Consent Changed Date (CCYYMMDD)",CAPTTEXT
          MOVE      "wtwmcsdt",FIELDNAM
          MOVE      CPCDATE,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Assessor Code",CAPTTEXT
          MOVE      "wtwmassr",FIELDNAM
          MOVE      WTWMASSR,DIM50
          MOVE      THREE,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Actual Procedure Event Number",CAPTTEXT
          MOVE      "wtwmacpr",FIELDNAM
          MOVE      WTWMACPR,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Patient Suitable For Another Hospital Y/N",CAPTTEXT
          MOVE      "wttxpsah",FIELDNAM
          MATCH     "1",WTTXPSAH
          IF        @EQUAL
            MOVE      "Yes",DIM50
          ELSE
            MATCH     "2",WTTXPSAH
            IF        @EQUAL
              MOVE      "Unknown",DIM50
            ELSE
              MOVE      "No",DIM50
            ENDIF
          ENDIF
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Preferred Hospital (pathspaf)",CAPTTEXT
          MOVE      "wttxphos",FIELDNAM
          MOVE      WTTXPHOS,DIM50
          MOVE      FOUR,CODETYPE
          CALL      FRMT0000
.
          MOVE      "Procedure Can Be Performed By (category yh)",CAPTTEXT
          MOVE      "wttxprpb",FIELDNAM
          MOVE      WTTXPRPB,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "yh",CODECATG
          CALL      FRMT0000
.
          MOVE      "Airway Assessment Score",CAPTTEXT
          MOVE      "wttxaasc",FIELDNAM
          MOVE      WTTXAASC,DIM50
          MOVE      ZERO,CODETYPE
          CALL      FRMT0000
.
          MOVE      "User Defined Field 9 (category X9)",CAPTTEXT
          MOVE      "wttxud09",FIELDNAM
          MOVE      WTTXUD09,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "X9",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 10 (category x1)",CAPTTEXT
          MOVE      "wttxud10",FIELDNAM
          MOVE      WTTXUD10,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "x1",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 11 (category x2)",CAPTTEXT
          MOVE      "wttxud11",FIELDNAM
          MOVE      WTTXUD11,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "x2",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 12 (category x3)",CAPTTEXT
          MOVE      "wttxud12",FIELDNAM
          MOVE      WTTXUD12,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "x3",CODECATG
          CALL      FRMT0000
.
          MOVE      "User Defined Field 13 (category x4)",CAPTTEXT
          MOVE      "wttxud13",FIELDNAM
          MOVE      WTTXUD13,DIM50
          MOVE      ONE,CODETYPE
          MOVE      "x4",CODECATG
          CALL      FRMT0000
.
          MOVE      ZERO,EXIT
          GOTO      LODW9999
.
LODW9500  DISPLAY   *P1:24,*EL,*B,"W/L Holding file data not found.  ";
          CALL      HITENTER
          MOVE      ONE,EXIT
.
LODW9999  RETURN
+
.*****************************************************************************
.*                  WLIN0000                           Called by : LODA0000  *
.*        write a data line to the temp file                       LODO0000  *
.*                                                                 LODP0000  *
.*                                                                 LODD0000  *
.*****************************************************************************
.
WLIN0000  RESET     DIM78
          PACK      DIM78,DIM78,SP80             * fill line with spaces
          WRITE     TEMPFILE,SEQ;DIM78           * write the data line
.
WLIN9999  RETURN
+
.*****************************************************************************
.*                  WPRC0000                           Called by : VINB0000  *
.*        Execute the word processor                                         *
.*****************************************************************************
.
WPRC0000  CLOSE     TEMPFILE
          MOVE      SIX,WORDSTAT
          WORD      CFNAME,999,1,6,80,24,WORDSTAT
          MOVE      ZERO,EXIT
.
WPRC9999  RETURN
+
.*****************************************************************************
.*                              KTMP0000              Called by: MAIN0000    *
.*                         erase temp file                                   *
.*****************************************************************************
.
KTMP0000  PREP      TEMPFILE,CFNAME
          CLOSE     TEMPFILE,DELETE              * Delete the comments temp file
.
KTMP9999  RETURN
+
.*****************************************************************************
.*                              VMES0000              Called by: MAIN0000    *
.*                   View a single message using message id                  *
.*****************************************************************************
.
VMES0000  KEYIN     *P1:24,*EL,"Message Id :":
                    *P14:24,*V2LON,MESSNUMB
.
          COMPARE   ZERO,MESSNUMB                * anything entered ?
          GOTO      VMES9999 IF EQUAL            * no - finished
.
          MOVE      MESSNUMB,KEY20
          CALL      RDH7CIS1                     * message on file ?
          IF        OVRCD = 1
            DISPLAY   *P1:24,*EL,*B,"Message not on file.  ";
            CALL      HITENTER
            GOTO      VMES0000
          ENDIF
.
.         A valid message has been found, so display the details.
.
          CALL      VINB0000
          GOTO      VMES0000
.
VMES9999  RETURN
+
.****************************************************************************
.*                              GPAT0000             Called by: MAIN0000    *
.*                   Get the patient U/R number                             *
.* Returns: SAVEURNO - U/R number                                           *
.*          EXIT   0 = valid U/R selected                                   *
.*                 1 = nothing input                                        *
.****************************************************************************
.
GPAT0000  HLINE     *G37,2,70,80
          KEYIN     *P1:3,*EF:
                    *P1:4,"U/R Number     :":
                    *P18:4,*V2LON,*JR,DIM8
.
          PACK      DIM8,DIM8,SP8
          MATCH     SP8,DIM8                     * anything entered ?
          GOTO      GPAT9100 IF EQUAL            * no
.
GPAT2000  MOVE      DIM8,KEY8
          CALL      RDMAST1                      * U/R on file ?
          BRANCH    OVRCD,GPAT9700               * no
.
          MOVE      PURNO,SAVEURNO
.
          MOVE      PSNAME,PACSNAME              * format name
          MOVE      PGNAME,PACGNAME
          MOVE      PTITL,PACTITLE
          MOVE      ONE,PACFRMT
          CALL      PACNAME
.
          DISPLAY   *P70:2,"(",*V2LON,PURNO,*HOFF,") ":
                    *P30:4,*EF,PACFNAME
.
.         Check if the U/R is merged
.
          COMPARE   ONE,PSTAT                    * U/R merged ?
          GOTO      GPAT9000 IF NOT EQUAL        * no
.
          MATCH     PPSNAME,SP20                 * yes - merged U/R blank ?
          GOTO      GPAT9000 IF EQUAL            * yes - use original U/R
.
          MOVE      PPSNAME,KEY8
          CALL      RDMAST1                      * new U/R on file ?
          BRANCH    OVRCD,GPAT4000               * no - use original
.
.         The U/R is merged so alert user and get them to select which
.         U/R to use
.
          MOVE      PSNAME,PACSNAME              * format name
          MOVE      PGNAME,PACGNAME
          MOVE      PTITL,PACTITLE
          MOVE      ONE,PACFRMT
          CALL      PACNAME
.
GPAT3000  KEYIN     *P1:8,"U/R merged to (",*V2LON,*DV,PURNO,*HOFF,") ":
                    *DV,PACFNAME:
                    *P1:24,*EL,"Select e(",*V2LON,*DV,ANSX,*HOFF,")it, (":
                    *V2LON,*DV,ANSO,*HOFF,")riginal or (":
                    *V2LON,*DV,ANSM,*HOFF,")erged U/R :":
                    *P45:24,*V2LON,ANS
.
          PACK      ANS,ANS,SP1
          REP       UPPLOW,ANS
.
          MATCH     ANSX,ANS                     * exit selected ?
          GOTO      GPAT9100 IF EQUAL            * yes
.
          MATCH     ANSO,ANS                     * original U/R selected ?
          GOTO      GPAT4000 IF EQUAL            * yes
.
          MATCH     ANSM,ANS                     * merged U/R selected ?
          IF        @EQUAL
            MOVE      PURNO,DIM8                 * yes
            DISPLAY   *P18:4,*V2LON,DIM8
            GOTO      GPAT2000
          ENDIF
.
          BEEP
          GOTO      GPAT3000
.
.         Re-read original PMI record
.
GPAT4000  MOVE      SAVEURNO,KEY8
          CALL      RDMAST1                      * U/R on file ?
          BRANCH    OVRCD,GPAT9700               * no
.
          MOVE      PSNAME,PACSNAME              * format name
          MOVE      PGNAME,PACGNAME
          MOVE      PTITL,PACTITLE
          MOVE      ONE,PACFRMT
          CALL      PACNAME
.
GPAT9000  DISPLAY   *P70:2,"(",*V2LON,PURNO,*HOFF,") ":
                    *P30:4,*EF,PACFNAME
.
          MOVE      ZERO,EXIT
          GOTO      GPAT9999
.
GPAT9100  MOVE      ONE,EXIT
          GOTO      GPAT9999
.
GPAT9700  DISPLAY   *P1:24,*EL,*B,"U/R number does not exist.  ";
          CALL      HITENTER
          GOTO      GPAT0000
.
GPAT9999  RETURN
+
.****************************************************************************
.*                              ALLR0000             Called by: MAIN0000    *
.*                   Reset all rejected messages to Waiting                 *
.****************************************************************************
.
ALLR0000  KEYIN     *P1:24,*EL,"Ok to reset all rejected messages to ":
                    *V2LON,*DV,STATDESW,*HOFF," (":
                    *V2LON,*DV,ANSY,*HOFF,*DV,SLASH,*V2LON,*DV,ANSN,*HOFF,")?":
                    *P55:24,*V2LON,ANS
.
          PACK      ANS,ANS,SP1
          REP       UPPLOW,ANS
.
          MATCH     ANSY,ANS                     * "Y" entered ?
          GOTO      ALLR1000 IF EQUAL            * yes
.
          MATCH     ANSN,ANS                     * "N" entered ?
          GOTO      ALLR9999 IF EQUAL            * yes
.
          BEEP                                   * invalid input
          GOTO      ALLR0000
.
.         Ok to continue with resetting status.
.         First, set the new status.
.
ALLR1000  MOVE      ZERO,COUNTER                 * initialise record counter
          DISPLAY   *P1:24,*EL,"Processing:";
.
ALLR1500  PACK      KEY37,ANSR,SP30,SP10
ALLR1600  CALL      RSH7CIS2                     * position on 1st rejected mess
ALLR1700  CALL      RKH7CIS2                     * read next record
          BRANCH    OVRCD,ALLR9900               * eof - finished
.
          MATCH     ANSR,H7CISTAT                * status still "R" ?
          GOTO      ALLR9900 IF NOT EQUAL        * no - finished
.
          MATCH     SP8,H7CIURNO                 * blank U/R ?
          GOTO      ALLR1700 IF EQUAL            * yes
.
          PACK      SAVKEY37,H7CISTAT,H7CIDTTM,H7CIMESI   * save current key
          DISPLAY   *P13:24,*EL,*V2LON,SAVKEY37;
.
.         We need to reset all of this patient's rejected messages,
.         so loop through hl7cisaf records for the U/R using index 5,
.         so that the messages are reset in sequence, from oldest to youngest.
.
          MOVE      H7CIURNO,PURNO               * save current U/R
.
          PACK      KEY44,PURNO,SP30,SP20
ALLR2500  CALL      RSH7CIS5                     * pos'n at start of pt's recs
ALLR3000  CALL      RKH7CIS5                     * read next record
          BRANCH    OVRCD,ALLR9000               * eof - finished
.
          MATCH     PURNO,H7CIURNO               * same U/R still ?
          GOTO      ALLR9000 IF NOT EQUAL        * no - finished
.
          MATCH     ANSR,H7CISTAT                * rejected status ?
          GOTO      ALLR3000 IF NOT EQUAL        * no - finished
.
          PACK      SAVKEY44,H7CIURNO,H7CIDTTM,H7CIMESI   * save record key
.
.         A record for the U/R has been found, so reset the status 
.
          MOVE      H7CIMESI,KEY20
          CALL      RDH7CIS1                     * read rec. using index 1
          BRANCH    OVRCD,ALLR9100
.
.         Reset record status from "Rejected" to "Waiting"
.
          MOVE      ANSW,H7CISTAT                * load new status
          MOVE      SP20,H7CIDDAT
          CALL      UPH7CIS1                     * update record status
.
          ADD       ONE,COUNTER                  * increment counter
          MOVE      SAVKEY44,KEY44
          GOTO      ALLR2500
.
.         Delete record from U/R Holding table if present
.
ALLR9000  MOVE      PURNO,KEY8
          CALL      RAH7URH1
          IF        OVRCD = 0
            MOVE      PURNO,KEY8
            CALL      DEH7URH1
          ENDIF
.
.         Re-position in file for next patient
.
ALLR9100  MOVE      SAVKEY37,KEY37
          GOTO      ALLR1600
.
ALLR9900  DISPLAY   *P1:24,*EL,*V2LON,COUNTER,*HOFF," messages reset.  ";
          CALL      HITENTER
.
ALLR9999  RETURN
+
.*****************************************************************************
.*                           CKOH0000              Called by: MAIN0000       *
.*               Check on-hold U/R's are valid                               *
.*****************************************************************************
.
.         For each U/R in hl7urhaf, loop through hl7cisaf looking for
.         rejected or waiting messages for that U/R and if none exist, then
.         delete the record from hl7urhaf.
.
CKOH0000  MOVE      SP8,KEY8
CKOH0500  CALL      RSH7URH1                     * position at start of file
CKOH1000  CALL      RKH7URH1                     * read next record
          BRANCH    OVRCD,CKOH9999               * eof - finished
.
          PACK      KEY44,H7URNUMB,SP30,SP20
          CALL      RSH7CIS5                     * position on U/R
CKOH2000  CALL      RKH7CIS5                     * read next record
          BRANCH    OVRCD,CKOH8000               * eof - delete hl7urhaf record
.
          MATCH     H7URNUMB,H7CIURNO            * same U/R still ?
          GOTO      CKOH8000 IF NOT EQUAL        * no - delete hl7urhaf record
.
          MATCH     ANSW,H7CISTAT                * waiting record ?
          GOTO      CKOH1000 IF EQUAL            * yes - leave hl7urhaf record
.
          MATCH     ANSR,H7CISTAT                * rejected record ?
          GOTO      CKOH1000 IF EQUAL            * yes - leave hl7urhaf record
.
.         Delivered record, so keep checking
.
          GOTO      CKOH2000                     * get next record
.
.         There are no waiting or rejected messages for the current U/R,
.         so delete the hl7urhaf record
.
CKOH8000  MOVE      H7URNUMB,KEY8
          CALL      DEH7URH1                     * delete record
          GOTO      CKOH0500                     * reposition for next record
.
CKOH9999  RETURN
+
.*****************************************************************************
+
GETSVAR   RETURN
+
. =========================================================================
.         I/O Includes
. =========================================================================
.
          INC       STD001IO
.
          INC       CALCAGE
          INC       CLPATMAS
          INC       NZHISIIO
          INC       NZIBSRCH
          INC       PATCOMN1
          INC       PATSNDX
          INC       PATSNX2
          INC       CLPMSQPX
.
          INC       ALLQUEIO/INC
          INC       BOKRC1IO/INC
          INC       EMRQUEIO/INC
          INC       HL7CISIO/INC
          INC       HL7URHIO/INC
          INC       NHIMASIO/INC
          INC       OPRQUEIO/INC
          INC       OUTPREIO/INC
          INC       OUTQMAIO/INC
          INC       OUTQTYIO/INC
          INC       OUTQUEIO/INC
          INC       OUTRQUIO/INC
          INC       OUTSITIO/INC
          INC       PATCODIO/INC
          INC       PATDO1IO/INC
          INC       PATGSRIO/INC
          INC       PATHSPIO/INC
          INC       PATMA1IO/INC
          INC       PATMI1IO/INC
          INC       PMSPX2IO/INC
          INC       PMSVX1IO/INC
          INC       PATPR1IO/INC
          INC       PMSHCPIO/INC
          INC       PMSQDRIO/INC
          INC       PMSQPTIO/INC
          INC       PMSQVIIO/INC
          INC       WATQUEIO/INC
          INC       WEBSECIO/INC
          INC       TFILENAM 
          INC       IBASEQIO/INC 
          INC       WEBERRIO/INC
