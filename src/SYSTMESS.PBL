. *****************************************************************************
. *                                                                           *
. *                       P R O G R A M   S U M M A R Y                       *
. *                       -------------   -------------                       *
. *                                                                           *
. *     PROGRAM NAME:    SYSTMESS                                             *
. *                                                                           *
. *     FUNCTION:        TURN ON & OFF SYSTEM MESSAGES                        *
. *                                                                           *
. *     AUTHOR:          SOMEONE FROM THE PAST                                *
. *                                                                           *
. *     MODIFICATIONS:                                                        *
. *     C1.00.01  05/10/1995      MATT                                        *
. *               Redefine SYSMES as FILE                                    *
. *                                                                           *
. *****************************************************************************
. *     MODIFICATIONS:   W2.00     14/04/87 M.HAYSE                           *
. *                                HIGHLIGHT PROGRAM                          *
. *                                                                           *
. *                      V5.01.01  27/08/90 i chung        SRF 106207         *
. *                                Initialize message to spaces before keyin  *
. *                                                                           *
. *****************************************************************************
          INC       STDGENDF  
.
SYSMES    FILE     ASCII, FIXED=256, FIXED=250
.
          INC       BDSYSMES/INC
.
FIELD     FORM      1
.
PRGID     INIT      "SYSTMESS"
PRGNAM    INIT      "System Message Maintenance"
VERSION   INIT      "V12.01.00"
.
.         START OF PROGRAM
.
          CALL      DISPHEAD
          COMPARE   "6",SECLEV
          GOTO      NONO IF LESS
.
          OPEN      SYSMES,"systmess"
.
START     CALL      RSYSMESM
. 
          DISPLAY   *P1:4,*ULON,*EF:
                    *P25:4," Current Message ",*HOFF:
                    *P1:6,"1.",*V2LON,SYSMES1,*HOFF:
                    *P1:7,"2.",*V2LON,SYSMES2,*HOFF:
                    *P1:8,"3.",*V2LON,SYSMES3
. 
SFIELD    CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      WRMES IF EQUAL
          COMPARE   SEQ,CCITEM
          GOTO      ENDIT IF EQUAL
.
          BRANCH    CCITEM OF LINE1,LINE2,LINE3
          BEEP
          GOTO      SFIELD
. 
LINE1     PACK      SYSMES1,SP30,SP30,SP20
          KEYIN     *P3:6,*EL,*V2LON,SYSMES1
          RESET     SYSMES1
          GOTO      SFIELD IF EOS
. 
          ENDSET    SYSMES1
          APPEND    SP30,SYSMES1
          APPEND    SP30,SYSMES1
          APPEND    SP20,SYSMES1
          RESET     SYSMES1
          GOTO      SFIELD
.
LINE2     PACK      SYSMES2,SP30,SP30,SP20
          KEYIN     *P3:7,*EL,*V2LON,SYSMES2
          RESET     SYSMES2
          GOTO      SFIELD IF EOS
.
          ENDSET    SYSMES2
          APPEND    SP30,SYSMES2
          APPEND    SP30,SYSMES2
          APPEND    SP20,SYSMES2
          RESET     SYSMES2
          GOTO      SFIELD
.
LINE3     PACK      SYSMES3,SP30,SP30,SP20
          KEYIN     *P3:8,*EL,*V2LON,SYSMES3
          RESET     SYSMES3
          GOTO      SFIELD IF EOS
.
          ENDSET    SYSMES3
          APPEND    SP30,SYSMES3
          APPEND    SP30,SYSMES3
          APPEND    SP20,SYSMES3
          RESET     SYSMES3
          GOTO      SFIELD
.
WRMES     CALL      WSYSMESM
.
          DISPLAY   *P40:24,*EL,*V2LON:
                    "** Data Successfully Posted **",*W2;
          GOTO      ENDIT
.
NONO      DISPLAY   *P1:24,*EL,*B,*V2LON:
                    "*** Inadequate SECURITY Clearance ! ***",*W;
.
ENDIT     CHAIN     "ANSWER"
. 
          INC       BCSYSMES
          INC       STDGENCD
.
