.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.01.00"
.-------------------------------------------------------
. V9.04.01  19.04.2005 Peter Vela CAR 59696
.           Recompiled for SINTMPDF
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B01 21.11.2000 Charles Handaya
.           Modification of Warehouse Security
.-------------------------------------------------------
. VF.00.02  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.01  02.09.1999 Sandra Barcham
.           Add in Creditor Keyword Search
.           srf 631485
.-------------------------------------------------------
CODECHG   FORM      1
CURCOD5   DIM       5
ENDORI    DIM       3
ENDPON    DIM       7
ENDSUP    DIM       5
ENDWAR    DIM       5
LASTCOD5  DIM       5
LASTPON   DIM       7
MYCOL     FORM      2
MYVERT    FORM      2
REPTSTKF  FORM      1
STRORI    DIM       3
STRPON    DIM       7
STRSUP    DIM       5
STRWAR    DIM       5
.-------------------------------------------------------
.
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN54
.   Function      :   Print Outstanding Purchase Orders       
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
          INC       SIN54DF     
          INC       SINCCAFD/INC
          INC       SINCIAFD/INC
          INC       SINCIEFD/INC
          INC       SINCONFD/INC
          INC       SINFACFD/INC
          INC       SINNATFD/INC
          INC       SINORIFD/INC
          INC       SINPOAFD/INC
          INC       SINPOCFD/INC
          INC       SINPOFFD/INC
          INC       SINTMPDF/INC
          INC       SINWARFD/INC
          INC       SINWSEFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMSUPP  DIM      36 * Scr 01 Fld     4
TOSUPP    DIM      36 * Scr 01 Fld     5
PRTLOWST  FORM      1 * Scr 01 Fld     8
PRTOVERD  FORM      1 * Scr 01 Fld     9
NEWPGPER  FORM      1 * Scr 01 Fld    10
FROMPON   DIM       7 * Scr 02 Fld     4
TOPON     DIM       7 * Scr 02 Fld     5
FROMORI   DIM      24 * Scr 03 Fld     4
TOORI     DIM      24 * Scr 03 Fld     5
REPTSTCK  DIM       1 * Scr 04 Fld     4
FROMCOST  DIM      46 * Scr 04 Fld     5
TOCOST    DIM      46 * Scr 04 Fld     6
FROMWAR   DIM      46 * Scr 04 Fld     7
TOWAR     DIM      46 * Scr 04 Fld     8
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN54"
PRGNAM    INIT      "Print Outstanding Purchase Orders       "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SC00L000
          CALL      CLOS0000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
          MOVE      "   24",AUDTSECT
          MOVE      "223",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudwa";
            OPEN      SINAUDWA,"sinaudwa"
          ENDIF
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA1,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA2,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA2,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA3,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA1,"sincieaf"
          DISPLAY   *P56:24,"Opening sincieaf";
          OPEN      SINCIEA2,"sincieaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA1,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA2,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinoriaf";
          OPEN      SINORIA1,"sinoriaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA1,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA2,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA3,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA4,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA1,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA2,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA3,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA4,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA5,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA6,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA7,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA1,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA2,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA3,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinpofaf";
          OPEN      SINPOFA4,"sinpofaf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA2,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA1,"sinwseaf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA2,"sinwseaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Main Menu                          
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * By Supplier                        
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * By Purchase Order                  
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * By Originator                      
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * By Cost Centre/Warehouse           
          ENDIF
          RETURN
.--------------------------------
. Screen - Main Menu                          
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      ONAT0000
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Main Menu                          
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Main Menu                          
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Main Menu                          
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Main Menu                          
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Main Menu                          
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Main Menu                          
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                           PS00L999,PS00L999,PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Main Menu                          
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L006:
                           SF00L103,SF00L104,SF00L105
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                           SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L104
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - By Supplier                        
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      SETSCR01
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : By Supplier                        
.-------------------------------------------------------
CF01L000
          MOVE      SP70,FROMSUPP
          MOVE      SP70,TOSUPP  
          MOVE      ZERO,PRTLOWST
          MOVE      ZERO,PRTOVERD
          MOVE      ZERO,NEWPGPER
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for By Supplier                        
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : By Supplier                        
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : By Supplier                        
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : By Supplier                        
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : By Supplier                        
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L101:
                            PS01L102,PS01L999,PS01L999,PS01L103:
                            PS01L104,PS01L105
          GOTO     PS01L999
.
PS01L101
          MOVE      FROMSUPP,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      TOSUPP,VAR       
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PRTLOWST,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PRTOVERD,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      NEWPGPER,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : By Supplier                        
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L006,SF01L006,SF01L006,SF01L104:
                            SF01L105,SF01L106
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L103:
                            SF01L020,SF01L020,SF01L020,SF01L104:
                            SF01L105,SF01L106
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF01L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF01L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF01L999
          ENDIF
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF01L000
          ENDIF
          GOTO      SF01L001
.
SF01L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOSUPP  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESUP0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      FROMSUPP,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOSUPP,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF01L001
.
SF01L104
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PRTLOWST
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PRTLOWST,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L105
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PRTOVERD
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PRTOVERD,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L106
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,NEWPGPER
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      NEWPGPER,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF01L001
SF01L990  MOVE      FOUR,EXIT * Exit Char Exit
SF01L999  RETURN
.--------------------------------
. Screen - By Purchase Order                  
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      SETSCR02
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : By Purchase Order                  
.-------------------------------------------------------
CF02L000
          MOVE      SP70,FROMPON 
          MOVE      SP70,TOPON   
          MOVE      ZERO,PRTLOWST
          MOVE      ZERO,PRTOVERD
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for By Purchase Order                  
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : By Purchase Order                  
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : By Purchase Order                  
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : By Purchase Order                  
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : By Purchase Order                  
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L101:
                            PS02L102,PS02L999,PS02L999,PS02L103:
                            PS02L104
          GOTO     PS02L999
.
PS02L101
          MOVE      FROMPON,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      TOPON,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PRTLOWST,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PRTOVERD,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : By Purchase Order                  
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L006,SF02L006,SF02L006,SF02L104:
                            SF02L105
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L103:
                            SF02L020,SF02L020,SF02L020,SF02L104:
                            SF02L105
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF02L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF02L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF02L999
          ENDIF
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF02L000
          ENDIF
          GOTO      SF02L001
.
SF02L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOPON   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EPON0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L103
            ENDIF
            BRANCH    EXIT,SF02L103,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      FROMPON,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOPON,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L104
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PRTLOWST
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PRTLOWST,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L105
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PRTOVERD
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PRTOVERD,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
SF02L990  MOVE      FOUR,EXIT * Exit Char Exit
SF02L999  RETURN
.--------------------------------
. Screen - By Originator                      
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
          CALL      SETSCR03
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : By Originator                      
.-------------------------------------------------------
CF03L000
          MOVE      SP70,FROMORI 
          MOVE      SP70,TOORI   
          MOVE      ZERO,PRTLOWST
          MOVE      ZERO,PRTOVERD
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for By Originator                      
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : By Originator                      
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : By Originator                      
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : By Originator                      
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : By Originator                      
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L101:
                            PS03L102,PS03L999,PS03L999,PS03L103:
                            PS03L104
          GOTO     PS03L999
.
PS03L101
          MOVE      FROMORI,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      TOORI,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PRTLOWST,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PRTOVERD,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : By Originator                      
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L006,SF03L006,SF03L006,SF03L104:
                            SF03L105
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L103:
                            SF03L020,SF03L020,SF03L020,SF03L104:
                            SF03L105
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF03L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF03L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF03L999
          ENDIF
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF03L000
          ENDIF
          GOTO      SF03L001
.
SF03L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOORI   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EORI0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L103
            ENDIF
            BRANCH    EXIT,SF03L103,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      FROMORI,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOORI,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L104
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PRTLOWST
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PRTLOWST,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L105
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PRTOVERD
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PRTOVERD,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
SF03L990  MOVE      FOUR,EXIT * Exit Char Exit
SF03L999  RETURN
.--------------------------------
. Screen - By Cost Centre/Warehouse           
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
          CALL      SETSCR04
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : By Cost Centre/Warehouse           
.-------------------------------------------------------
CF04L000
          MOVE      SP70,REPTSTCK
          MOVE      SP70,FROMCOST
          MOVE      SP70,TOCOST  
          MOVE      SP70,FROMWAR 
          MOVE      SP70,TOWAR   
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for By Cost Centre/Warehouse           
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : By Cost Centre/Warehouse           
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : By Cost Centre/Warehouse           
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : By Cost Centre/Warehouse           
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : By Cost Centre/Warehouse           
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L101:
                            PS04L102,PS04L103,PS04L104,PS04L105
          GOTO     PS04L999
.
PS04L101
          MOVE      REPTSTCK,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      FROMCOST,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      TOCOST,VAR       
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      FROMWAR,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L105
          MOVE      TOWAR,VAR        
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : By Cost Centre/Warehouse           
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L103:
                            SF04L104,SF04L006,SF04L105,SF04L006
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L103:
                            SF04L104,SF04L020,SF04L105,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNT0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF04L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF04L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF04L999
          ENDIF
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF04L000
          ENDIF
          GOTO      SF04L001
.
SF04L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ESTK0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L103
            ENDIF
            BRANCH    EXIT,SF04L103,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      REPTSTCK,VAR     
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L104
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCOST  
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOS0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L104
            ENDIF
            BRANCH    EXIT,SF04L104,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      FROMCOST,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCOST,VAR       
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
.
SF04L105
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOWAR   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      EWAR0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L105
            ENDIF
            BRANCH    EXIT,SF04L105,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      FROMWAR,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOWAR,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
SF04L990  MOVE      FOUR,EXIT * Exit Char Exit
SF04L999  RETURN
.@@@@@ Function Restart Point @@@@@
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*143,HNONUSAG
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ONE,HNONUSAG
            WRITAB    CONTROLF,SIXTY3;*143,HNONUSAG
          ENDIF
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
.----------------------------------------------------------------------
. Set up for screen 1
.----------------------------------------------------------------------
SETSCR01
          MOVE      "1",OPTIONA
          MOVE      ONE,ACCEPT
          RETURN
.********************************************************************
. PRNT - print report for SIPA                      Called by ML
.         Returns  : EXIT            (1=illegal range entered)
.********************************************************************
PRNT0000  BRANCH    TMPFLFLG,PRNT0010            * create temp file ?
          CALL      OPEN0000
.
PRNT0010  PACK      DISPMSG,SP70,SP70            * save line 24
          CALL      MESSAGE2
.
          DISPLAY   *P1:24,*EL,*P50:24,"Printing :   ";
          UNPACK    SP70,CURCOD3,CURCOD5,CURCOD7
          UNPACK    SP70,LASTCOD3,LASTCOD5,LASTCOD7
          MOVE      SP70,LASTPON
          MOVE      ZERO,CPAGENO                 * reset page no.
          MOVE      ZERO,ATOTAL01
          MOVE      ZERO,ATOTAL02
          CLOCK     TIME,CTIMEIS                 * get current time
          MOVE      "999",CLNO                   * init last line number
.
          CALL      FILE0000                    * go to correct position in file
.
PRNT1000  CALL      NREC0000                     * get next record
          BRANCH    OVRCD,PRNT8000               * end of file ?
.
          DISPLAY   *P61:24,*V2LON,SIPAPON,*EL;
.
          CALL      WRIT0000                     * print details
          GOTO      PRNT1000                     * get next record
.
PRNT8000  MOVE      FALSE,CODECHG
          COMPARE   ZERO,CPAGENO
          CALL      HEAD0000 IF EQUAL          * print header if nothing printed
          IF        OPTIONA<>2
            CALL      BRKTOT00
          ENDIF
          CALL      UND132                       * print line
          PRINT     *1,"| Report Total",*98,ATOTAL02,*132,"|"
          CALL      UND132                       * print line
          MOVE      ZERO,ATOTAL01
          MOVE      ZERO,ATOTAL02
          PRINT     "****   End of Report   ****"
.
.
PRNT9000  MOVE      ZERO,EXIT                    * exit screen
          GOTO      PRNT9999
.
PRNT9500  MOVE      ONE,EXIT                     * continue
.
PRNT9999
          CALL      MESSAGE3                     * restore line 24
          RETURN
.**********************************************************************
.  FILE - Set file pointer                             Called By PRNT
.**********************************************************************
FILE0000
          BRANCH    OPTIONA,FILE0100,FILE0200,FILE0300,FILE0400:
                            FILE9999,FILE9999,FILE9999,FILE9999
.
.---- print by type 1 ----
.
FILE0100  PACK      KEY12,STRSUP,SP70
          CALL      RSNEZZ2
          CALL      RPNEZZ2
          GOTO      FILE9999
.
.---- print by type 2 ----
.
FILE0200  PACK      KEY7,STRPON,SP70
          CALL      RSNEZZ1
          CALL      RPNEZZ1
          GOTO      FILE9999
.
.---- print by type 3 ----
.
FILE0300  PACK      KEY10,STRORI,SP70
          CALL      RSNEZZ3
          CALL      RPNEZZ3
          GOTO      FILE9999
.
.---- print by type 4a ----
.
FILE0400  COMPARE   ZERO,REPTSTKF
          GOTO      FILE0450 IF NOT EQUAL
.
          PACK      KEY23,FCOST,SP70
          CALL      RSTMPF1
          CALL      RPTMPF1
          GOTO      FILE9999
.
.---- print by type 4b ----
.
FILE0450  PACK      KEY12,STRWAR,SP70
          CALL      RSNEZZ4
          CALL      RPNEZZ4
          GOTO      FILE9999
.
FILE9999  RETURN
.**********************************************************************
.  NREC - Get next record                              Called By PRNT
.**********************************************************************
NREC0000
          BRANCH    OPTIONA,NREC0100,NREC0200,NREC0300,NREC0400:
                            NREC9999,NREC9999,NREC9999,NREC9999
.
.---- print by type 1 ----
.
NREC0100  CALL      RKNEZZ2
          BRANCH    OVRCD,NREC9500
.
          PACK      CURCOD5,NEZZSUP,SP70
          MATCH     CURCOD5,ENDSUP
          GOTO      NREC9500 IF LESS             * out of range ?
          GOTO      NREC9000
.
.---- print by type 2 ----
.
NREC0200  CALL      RKNEZZ1
          BRANCH    OVRCD,NREC9500
.
          MATCH     NEZZPON,ENDPON
          GOTO      NREC9500 IF LESS             * out of range ?
          PACK      CURCOD7,SP70
          GOTO      NREC9000
.
.---- print by type 3 ----
.
NREC0300  CALL      RKNEZZ3
          BRANCH    OVRCD,NREC9500
.
          PACK      CURCOD3,NEZZORI,SP70
          MATCH     CURCOD3,ENDORI
          GOTO      NREC9500 IF LESS             * out of range ?
          GOTO      NREC9000
.
.---- print by type 4a ----
.
NREC0400  COMPARE   ZERO,REPTSTKF
          GOTO      NREC0450 IF NOT EQUAL
.
          CALL      RKTMPF1
          BRANCH    OVRCD,NREC9500
.
          PACK      CURCOD5,TMPFCST,SP70
          MATCH     CURCOD5,TCOST
          GOTO      NREC9500 IF LESS             * out of range ?
          GOTO      NREC9000
.
.---- print by type 4b ----
.
NREC0450  CALL      RKNEZZ4
          BRANCH    OVRCD,NREC9500
.
          PACK      KEY9,PASSCODE,NEZZWAR,SP70   * check warehouse security
          CALL      RDSIWS1
          BRANCH    OVRCD,NREC0450
.
          PACK      CURCOD5,NEZZWAR,SP70
          MATCH     CURCOD5,ENDWAR
          GOTO      NREC9500 IF LESS             * out of range ?
          GOTO      NREC9000
.
NREC9000
          IF        OPTIONA=4 & REPTSTKF=0
            PACK      KEY7,TMPFPON,SP70  * read purchase order
          ELSE
            PACK      KEY7,NEZZPON,SP70  * read purchase order
          ENDIF
          CALL      RDSIPA1
          BRANCH    OVRCD,NREC0000     * should not be missing
          MATCH     SP70,SIPADCN       * skip if cancelled
          GOTO      NREC0000 IF NOT EQUAL
.
          MOVE      ZERO,OVRCD         * continue
          GOTO      NREC9999
.
NREC9500  MOVE      ONE,OVRCD          * quit
.
NREC9999  RETURN
.********************************************************************
. HEAD - print report                               Called by PRNT
.********************************************************************
HEAD0000  IF        OPTIONA<>1 | CLNO>=55
            CALL      HEADTOP0       * if new code & Not by supplier - Top
            CALL      HEADBOT0       * if new code & Not by supplier - Bottom
          ELSE
            IF        CODECHG=TRUE
              IF        NEWPGPER=1
                CALL      HEADTOP0   * New Page per Supplier
                CALL      HEADBOT0
              ELSE
                CALL      HEADBOT0   * No New Page per Supplier
              ENDIF
            ENDIF
          ENDIF
.
HEAD9999  RETURN
.********************************************************************
. HEADBOT - print top of new page header               Called by HEAD
.********************************************************************
HEADBOT0  IF        OPTIONA=1
            MOVE      SP70,APMASN1
            MOVE      SP70,APMASN2
            MOVE      SP70,APMASTEL
            PACK      KEY5,CURCOD5,SP70
            CALL      RDAPMA1
            CALL      UND132                     * print line
            PRINT     "| Supplier : ",CURCOD5,SP1,APMASN1:
                      "   Phone : ",APMASTEL,*132,"|",*N:
                      "|                    ",APMASN2,*132,"|"
          ENDIF
.
          IF        OPTIONA=3
            MOVE      SP70,SIORNAME
            MOVE      SP70,SIOREXT
            PACK      KEY3,CURCOD3,SP70
            CALL      RDSIOR1
            CALL      UND132                     * print line
            PRINT     "| Originator : ",CURCOD3,SP1,SIORNAME:
                      "   Phone : ",SIOREXT,*132,"|",*N:
                      "|",*132,"|"
          ENDIF
.
          IF        OPTIONA=4
            IF        REPTSTKF=0
              MOVE      SP70,SICADESC
              PACK      KEY5,CURCOD5,SP70
              CALL      RDSICA1
              CALL      UND132                     * print line
              PRINT     "| Cost Centre : ",CURCOD5,SP1,SICADESC:
                        *132,"|",*N:
                        "|",*132,"|"
            ELSE
              MOVE      SP70,SIWADES
              PACK      KEY5,CURCOD5,SP70
              CALL      RDSIWA1
              CALL      UND132                     * print line
              PRINT     "| Warehouse : ",CURCOD5,SP1,SIWADES:
                        *132,"|",*N:
                        "|",*132,"|"
            ENDIF
          ENDIF
          ADD       "2",CLNO
.
          CALL      UND132                       * print line
          PRINT     "|Purchase| Catalog Description                   ":
                    "| Original | Outstand | Supply Unit    |   Unit Cost":
                    "| Ext Cost | Date Due | Order ":
                    *132,"|"
          PRINT     "| Order  |                                       ":
                    "| Quantity | Quantity |                |            ":
                    "|          |          | Status":
                    *132,"|"
          ADD       "2",CLNO
          CALL      UND132                       * print line
.
HEADBOT9  RETURN
.********************************************************************
. HEADTOP - print top of new page header               Called by HEAD
.********************************************************************
HEADTOP0  CALL      HEAD132
          IF        ONE=PRTLOWST
            PRINT     *40,"Printed For Low Stock Only"
            ADD       ONE,CLNO
          ENDIF
.
          IF        OPTIONA=1
            PRINT     *40,"Print By Supplier    ":
                      *N,*40,"From : ",FROMSUPP:
                      *N,*40,"To   : ",TOSUPP
          ENDIF
          IF        OPTIONA=2
            PRINT     *40,"Print Purchase Order ":
                      *N,*40,"From : ",FROMPON:
                      *N,*40,"To   : ",TOPON
          ENDIF
          IF        OPTIONA=3
            PRINT     *40,"Print Originator     ":
                      *N,*40,"From : ",FROMORI:
                      *N,*40,"To   : ",TOORI
          ENDIF
          IF        OPTIONA=4
            IF        REPTSTKF=0
              PRINT     *40,"Print Non-Stock by Cost Centre ":
                        *N,*40,"From : ",FROMCOST:
                        *N,*40,"To   : ",TOCOST
            ELSE
              PRINT     *40,"Print Stock by Warehouse   ":
                        *N,*40,"From : ",FROMWAR:
                        *N,*40,"To   : ",TOWAR
            ENDIF
          ENDIF
          ADD       THREE,CLNO
.
HEADTOP9  RETURN
.********************************************************************
. WRIT - print data line                            Called by PRNT
.********************************************************************
WRIT0000  IF        OPTIONA=4 & REPTSTKF=0
            PACK      KEY10,TMPFPON,TMPFITM,SP70
            CALL      RDSIPC1
            BRANCH    OVRCD,WRIT9999
.
            MATCH     SP70,SIPCEDD
            GOTO      WRIT9999 IF EQUAL
.
            MATCH     LASTPON,TMPFPON
            GOTO      WRIT1050 IF EQUAL
.
            PACK      PURCHORD,TMPFPON,SP70
            GOTO      WRIT1050
          ELSE
            PACK      PURCHORD,SIPAPON,SP70
          ENDIF
.
          PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPC1
.
WRIT1000  CALL      RKSIPC1
          BRANCH    OVRCD,WRIT9999
          MATCH     SIPAPON,SIPCPON
          GOTO      WRIT9999 IF NOT EQUAL
          MATCH     SP70,SIPCEDD
          GOTO      WRIT1000 IF EQUAL
.
          IF        OPTIONA=4 & REPTSTKF=1
            MATCH     "Stock",SIPCCST
            GOTO      WRIT1000 IF NOT EQUAL
          ENDIF
.
          CALL      CKLOW000                     * check for low stock
          BRANCH    EXIT,WRIT1000
.
          IF        PRTOVERD=1
            PACK      KEY8,CCC,CYY,CMM,CDD,SP70
            REP       " 0",KEY8
            MATCH     KEY8,SIPCEDD
            IF        !(@LESS)
              GOTO      WRIT1000
            ENDIF
          ENDIF
.
WRIT1050  MATCH     SP7,SIPCCAT
          IF        !@EQUAL
            PACK      KEY7,SIPCCAT
            CALL      RDSIIA1
            BRANCH    OVRCD,WRIT1100
          ELSE
            GOTO      WRIT1100
          ENDIF
          PACK      KEY30,SIIAISS,SIPCSUT,SP70
          CALL      RDSIFA1
          BRANCH    OVRCD,WRIT1100
.
          ASSIGN   ((SIPCOQT*SIFACTOR)-SIPCRQT)/SIFACTOR,F12P2
          GOTO     WRIT1200
.
WRIT1100  ASSIGN    SIPCOQT-SIPCRQT,F12P2
.
WRIT1200  MOVE      F12P2,F7P2B
          IF        F7P2B<0
            MOVE      ZERO,F7P2B
            MOVE      ZERO,F12P2
          ENDIF
.
          MOVE      SIPCOQT,F7P2A
          MOVE      SIPCECT,F7P4A
          ASSIGN    F7P2B*F7P4A,F7P2C
          ASSIGN    F12P2*SIPCECT,F12P2
.
          MOVE      FALSE,CODECHG
.
          REP       " 0",SIPCEDD
          MATCH     "00000000",SIPCEDD
          IF        @EQUAL
            MOVE      SP70,CPCDATE
          ELSE
            UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY
            CALL      PACDATE
          ENDIF
.
          PACK      KEY8,CCC,CYY,CMM,CDD,SP70
          REP       " 0",KEY8
          MATCH     KEY8,SIPCEDD
          IF        @LESS
            MOVE      "OVERDUE",KEY7
          ELSE
            MOVE      SP70,KEY7
          ENDIF
.
          MATCH     SP70,CPCDATE
          IF        @EQUAL
            MOVE      SP70,KEY7
          ENDIF
.
          MOVE      F7P4A,KEY12
          COMPARE   "-1",F7P4A
          IF        @EQUAL
            MOVE      "T.B.A.",KEY12
            MOVE      ZERO,F12P2
            MOVE      ZERO,F7P2C
          ENDIF
          PACK      KEY12,KEY12,SP20
.
          IF        OPTIONA=1
            MATCH     LASTCOD5,CURCOD5
          ENDIF
          IF        OPTIONA=2
            MATCH     LASTCOD7,CURCOD7
          ENDIF
          IF        OPTIONA=3
            MATCH     LASTCOD3,CURCOD3
          ENDIF
          IF        OPTIONA=4
            MATCH     LASTCOD5,CURCOD5
          ENDIF
          IF        !@EQUAL
            IF        CPAGENO<>0
              CALL      BRKTOT00
            ENDIF
            MOVE      ZERO,ATOTAL01
            MOVE      TRUE,CODECHG
            CALL      HEAD0000
          ELSE
            MOVE      FALSE,CODECHG
          ENDIF
          IF        OPTIONA=1
            MOVE      CURCOD5,LASTCOD5
          ENDIF
          IF        OPTIONA=2
            MOVE      CURCOD7,LASTCOD7
          ENDIF
          IF        OPTIONA=3
            MOVE      CURCOD3,LASTCOD3
          ENDIF
          IF        OPTIONA=4
            MOVE      CURCOD5,LASTCOD5
          ENDIF
.
          COMPARE   "55",CLNO
          CALL      HEAD0000 IF NOT LESS
.
          MATCH     SP70,SIPCCAT
          IF        @EQUAL
            MOVE      SIPCPD,KEY30
          ELSE
            MOVE      SIIADES,KEY30
          ENDIF
.
          PRINT     "| ",PURCHORD,"| ",SIPCCAT,SP1,KEY30,"|",F7P2A:
                    "|",F7P2B,"| ",SIPCSUT,"|",KEY12,"|",F7P2C:
                    "|",CPCDATE,"|",KEY7:
                    *132,"|"
          ADD       "1",CLNO           * add one to line number
          MOVE      SP70,PURCHORD
          ADD       F12P2,ATOTAL01
          ADD       F12P2,ATOTAL02
.
          IF        OPTIONA=4 & REPTSTKF=0
            MOVE      TMPFPON,LASTPON
            GOTO      WRIT9999
          ENDIF
          GOTO      WRIT1000
.
WRIT9999  RETURN
.
BRKTOT00      CALL      UND132                       * print line
              PRINT     *1,"| Total ",*98,ATOTAL01,*132,"|"
BRKTOT99  RETURN
.********************************************************************
. CKLOW - print data line                            Called by PRNT
.********************************************************************
CKLOW000  COMPARE   ONE,PRTLOWST       * print all or just low stock ?
          GOTO      CKLOW900 IF NOT EQUAL
.
..........MATCH     SP70,SIPCCAT       * Ignore Non Cataloged
..........GOTO      CKLOW950 IF EQUAL
          PACK      SIIADES,SP70,SP70
          MATCH     SIPCCAT,SP7
          IF        !@EQUAL
            PACK      KEY7,SIPCCAT,SP70
            CALL      RDSIIA1
            BRANCH    OVRCD,CKLOW950
            PACK      KEY12,SIPCCAT,SIPCWAR,SP70
            CALL      RDSIIE1            * get catalog/warehouse data
            BRANCH    OVRCD,CKLOW950
            COMPARE   SIIESOH,SIIEROQ    * greater than reorder level ?
            GOTO      CKLOW950 IF LESS
          ENDIF
.
CKLOW900  MOVE      ZERO,EXIT
          GOTO      CKLOW999
.
CKLOW950  MOVE      ONE,EXIT
.
CKLOW999  RETURN
.
.----------------------------------------------------------------------
. Enter Range of Supplier
.----------------------------------------------------------------------
ESUP0000  MOVE      "    4",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          CALL      KAPMAA00
          BRANCH    EXIT,ESUP0100,ESUP9999
          MOVE      APMACRD,STRSUP
          PACK      FROMSUPP,APMACRD,SP1,APMASN1
          GOTO      ESUP0150
.
ESUP0100  MOVE      "Start                               ",FROMSUPP
          PACK      STRSUP,SP70
.
ESUP0150  MOVE      FROMSUPP,VAR
          CALL      DISPITEM
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          CALL      KAPMAA00
          BRANCH    EXIT,ESUP0200,ESUP9999
          MOVE      APMACRD,ENDSUP
          PACK      TOSUPP,APMACRD,SP1,APMASN1
          MATCH     STRSUP,ENDSUP
          GOTO      ESUP9000 IF EQUAL
          GOTO      ESUP9000 IF NOT LESS
          BEEP
          MOVE      "To Supplier Code Must Be > From Supplier Code - ",DISPMSG
          CALL      MESSAGE1
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
          GOTO      ESUP0000
.
ESUP0200  MOVE      "Finish                              ",TOSUPP
          PACK      ENDSUP,Z70
          GOTO      ESUP9000
.
ESUP9000  MOVE      "    4",FLDID
          CALL      GETPOSIT
.
ESUP9999  RETURN
.
.----------------------------------------------------------------------
. Set up for screen 2
.----------------------------------------------------------------------
SETSCR02
          MOVE      "2",OPTIONA
          MOVE      ONE,ACCEPT
          RETURN
.----------------------------------------------------------------------
. Enter Range of Purchase Order
.----------------------------------------------------------------------
EPON0000  MOVE      "    4",FLDID
          CALL      GETPOSIT
          CALL      KSIPAA00
          BRANCH    EXIT,EPON0100,EPON9999
          MOVE      SIPAPON,STRPON
          PACK      FROMPON,SIPAPON,SP70
          GOTO      EPON0150
.
EPON0100  MOVE      "Start  ",FROMPON
          PACK      STRPON,SP70
.
EPON0150  MOVE      FROMPON,VAR
          CALL      DISPITEM
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          CALL      KSIPAA00
          BRANCH    EXIT,EPON0200,EPON9999
          MOVE      SIPAPON,ENDPON
          PACK      TOPON,SIPAPON,SP70
          MATCH     STRPON,ENDPON
          GOTO      EPON9000 IF EQUAL
          GOTO      EPON9000 IF NOT LESS
          BEEP
          MOVE      "To P/O Must Be > From P/O - ",DISPMSG
          CALL      MESSAGE1
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          GOTO      EPON0000
.
EPON0200  MOVE      "Finish ",TOPON
          PACK      ENDPON,Z70
          GOTO      EPON9000
.
EPON9000  MOVE      "    4",FLDID
          CALL      GETPOSIT
.
EPON9999  RETURN
.
.----------------------------------------------------------------------
. Set up for screen 3
.----------------------------------------------------------------------
SETSCR03  MOVE      "3",OPTIONA
          MOVE      ONE,ACCEPT
          RETURN
.----------------------------------------------------------------------
. Enter Range of Originator
.----------------------------------------------------------------------
EORI0000  MOVE      "    4",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          CALL      KSIORA00
          BRANCH    EXIT,EORI0100,EORI9999
          MOVE      SIORORIG,STRORI
          PACK      FROMORI,SIORORIG,SP1,SIORNAME
          GOTO      EORI0150
EORI0100  MOVE      "Start                   ",FROMORI
          PACK      STRORI,SP70
.
EORI0150  MOVE      FROMORI,VAR
          CALL      DISPITEM
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          CALL      KSIORA00
          BRANCH    EXIT,EORI0200,EORI9999
          MOVE      SIORORIG,ENDORI
          PACK      TOORI,SIORORIG,SP1,SIORNAME
          MATCH     STRORI,ENDORI
          GOTO      EORI9000 IF EQUAL
          GOTO      EORI9000 IF NOT LESS
          BEEP
          MOVE      "To Originator Must Be > From Originator - ",DISPMSG
          CALL      MESSAGE1
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          GOTO      EORI0000
.
EORI0200  MOVE      "Finish                  ",TOORI
          PACK      ENDORI,Z70
.
EORI9000  MOVE      "    4",FLDID
          CALL      GETPOSIT
.
EORI9999  RETURN
.
.----------------------------------------------------------------------
. Set up for screen 4
.----------------------------------------------------------------------
SETSCR04
          MOVE      "4",OPTIONA
          MOVE      ONE,ACCEPT
          RETURN
.----------------------------------------------------------------------
. Enter Stock of Non-Stock
.----------------------------------------------------------------------
ESTK0000  MOVE      FALSE,EXIT
          MOVE      ANSS,REPTSTCK
          KEYIN     *PCCOL:CVERT,*EL,*V2LON,*RV,REPTSTCK
          PACK      REPTSTCK,REPTSTCK,SP10
.
          MATCH     EXITCHAR,REPTSTCK
          IF        @EQUAL
            MOVE      TWO,EXIT
            GOTO      ESTK9999
          ENDIF
.
          TYPE      REPTSTCK
          GOTO      ESTK9000 IF EQUAL
          REP       UPPLOW,REPTSTCK
          MOVE      REPTSTCK,ANS
          REP       "S1N0",ANS
          TYPE      ANS
          GOTO      ESTK9000 IF NOT EQUAL
.
. -------- Valid Option
.
          MOVE      ANS,FORM1
          IF        FORM1=1
            MOVE      ANSS,REPTSTCK          * Only Stock
            DISPLAY   *PCCOL:CVERT,*EL,*V2LON,"Stock Only"
            MOVE      FORM1,REPTSTKF           * Report Variable
            IF        ACCEPT=0
              MOVE      "    5",FLDID
              CALL      GETPOSIT
              MOVE     "** Not Applicable, for Stock only **          ",FROMCOST
              MOVE      FROMCOST,VAR
              CALL      DISPITEM
              PACK      FCOST,SP70
.
              MOVE      "    6",FLDID
              CALL      GETPOSIT
              MOVE      "** Not Applicable, for Stock only **          ",TOCOST
              MOVE      TOCOST,VAR
              CALL      DISPITEM
              PACK      TCOST,SP70
.
              MATCH     "** Not Applicable",FROMWAR
              IF        @EQUAL
                MOVE      "    7",FLDID
                CALL      GETPOSIT
                MOVE    "Start                                         ",FROMWAR
                MOVE      FROMWAR,VAR
                CALL      DISPITEM
                PACK      STRWAR,SP70
.
                MOVE      "    8",FLDID
                CALL      GETPOSIT
                MOVE    "Finish                                        ",TOWAR
                MOVE      TOWAR,VAR
                CALL      DISPITEM
                PACK      ENDWAR,Z70
              ENDIF
            ENDIF
          ENDIF
.
          IF        FORM1=0
            MOVE      ANSN,REPTSTCK          * Only Non-Stock
            DISPLAY   *PCCOL:CVERT,*EL,*V2LON,"Non-Stock Only"
            MOVE      FORM1,REPTSTKF           * Report Variable
            IF        ACCEPT=0
              MATCH     "** Not Applicable",FROMCOST
              IF        @EQUAL
                MOVE      "    5",FLDID
                CALL      GETPOSIT
                MOVE   "Start                                         ",FROMCOST
                MOVE      FROMCOST,VAR
                CALL      DISPITEM
                PACK      FCOST,SP70
.
                MOVE      "    6",FLDID
                CALL      GETPOSIT
                MOVE   "Finish                                        ",TOCOST
                MOVE      TOCOST,VAR
                CALL      DISPITEM
                PACK      TCOST,Z70
              ENDIF
.
              MOVE      "    7",FLDID
              CALL      GETPOSIT
              MOVE      "** Not Applicable, for Non-Stock only **      ",FROMWAR
              MOVE      FROMWAR,VAR
              CALL      DISPITEM
              PACK      STRWAR,SP70
.
              MOVE      "    8",FLDID
              CALL      GETPOSIT
              MOVE      "** Not Applicable, for Non-Stock only **      ",TOWAR
              MOVE      TOWAR,VAR
              CALL      DISPITEM
              PACK      ENDWAR,SP70
.
            ENDIF
          ENDIF
          MOVE      "    4",FLDID
          CALL      GETPOSIT
          GOTO      ESTK9999
.
ESTK9000  MOVE      "Invalid Option - ",DISPMSG
          CALL      MESSAGE1
          GOTO      ESTK0000
.
ESTK9999  RETURN
.
.----------------------------------------------------------------------
. Enter Cost Centre Range
.----------------------------------------------------------------------
ECOS0000  IF        REPTSTKF=1
            IF        ACCEPT=0
              MATCH     "** Not Applicable",FROMWAR
              IF        @EQUAL
                MOVE      "    7",FLDID
                CALL      GETPOSIT
                MOVE    "Start                                         ",FROMWAR
                MOVE      FROMWAR,VAR
                CALL      DISPITEM
                PACK      STRWAR,SP70
.
                MOVE      "    8",FLDID
                CALL      GETPOSIT
                MOVE      "Finish                                        ",TOWAR
                MOVE      TOWAR,VAR
                CALL      DISPITEM
                PACK      ENDWAR,Z70
              ENDIF
            ENDIF
.
            MOVE      "    6",FLDID
            CALL      GETPOSIT
            MOVE      "** Not Applicable, for Stock only **          ",TOCOST
            MOVE      TOCOST,VAR
            CALL      DISPITEM
            PACK      TCOST,SP70
.
            MOVE      "    5",FLDID
            CALL      GETPOSIT
            MOVE     "** Not Applicable, for Stock only **          ",FROMCOST
            MOVE      FROMCOST,VAR
            CALL      DISPITEM
            PACK      FCOST,SP70
.
            GOTO      ECOS9999
          ENDIF
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          MOVE      ZERO,CKEYTYP
          CALL      KSICAA00
          BRANCH    EXIT,ECOS1000,ECOS9500
          MOVE      SICACODE,FCOST
          PACK      FROMCOST,SICACODE,SP1,SICADESC,SP70
          GOTO      ECOS2000
.
ECOS1000  MOVE      SP70,FCOST
          MOVE      "Start                                         ",FROMCOST
.
ECOS2000  MOVE      FROMCOST,VAR
          CALL      DISPITEM
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          MOVE      ZERO,CKEYTYP
          CALL      KSICAA00
          BRANCH    EXIT,ECOS3000,ECOS9500
          MOVE      SICACODE,TCOST
          PACK      TOCOST,SICACODE,SP1,SICADESC,SP70
          MATCH     FCOST,TCOST
          GOTO      ECOS9000 IF EQUAL
          GOTO      ECOS9000 IF NOT LESS
          BEEP
          MOVE      "To Cost Centre Must Be > From Cost Centre - ",DISPMSG
          CALL      MESSAGE1
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          GOTO      ECOS0000
.
ECOS3000  PACK      TCOST,Z70
          MOVE      "Finish                                        ",TOCOST
.
ECOS9000  MOVE      "    5",FLDID
          CALL      GETPOSIT
          MOVE      ZERO,EXIT
          GOTO      ECOS9999
.
ECOS9500  MOVE      TWO,EXIT
.
ECOS9999  RETURN
.
.----------------------------------------------------------------------
. Range of Warehouse Code
.----------------------------------------------------------------------
EWAR0000  IF        REPTSTKF=0
            IF        ACCEPT=0
              MATCH     "** Not Applicable",FROMCOST
              IF        @EQUAL
                MOVE      "    5",FLDID
                CALL      GETPOSIT
                MOVE   "Start                                         ",FROMCOST
                MOVE      FROMCOST,VAR
                CALL      DISPITEM
                PACK      FCOST,SP70
.
                MOVE      "    6",FLDID
                CALL      GETPOSIT
                MOVE   "Finish                                        ",TOCOST
                MOVE      TOCOST,VAR
                CALL      DISPITEM
                PACK      TCOST,Z70
              ENDIF
            ENDIF
.
            MOVE      "    8",FLDID
            CALL      GETPOSIT
            MOVE      "** Not Applicable, for Non-Stock only **      ",TOWAR
            MOVE      TOWAR,VAR
            CALL      DISPITEM
            PACK      ENDWAR,SP70
.
            MOVE      "    7",FLDID
            CALL      GETPOSIT
            MOVE      "** Not Applicable, for Non-Stock only **      ",FROMWAR
            MOVE      FROMWAR,VAR
            CALL      DISPITEM
            PACK      STRWAR,SP70
.
            GOTO      EWAR9999
          ENDIF
.
          MOVE      "    7",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          PACK      SIWAWAR,SP70
          PACK      SIWADES,SP70
          CALL      KSIWSA00
          BRANCH    EXIT,EWAR0100,EWAR9500
          MOVE      SIWAWAR,STRWAR
          PACK      FROMWAR,SIWAWAR,SP1,SIWADES
          GOTO      EWAR0150
EWAR0100  MOVE      "Start                                         ",FROMWAR
          PACK      STRWAR,SP70
.
EWAR0150  MOVE      FROMWAR,VAR
          CALL      DISPITEM
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          PACK      SIWAWAR,SP70
          PACK      SIWADES,SP70
          CALL      KSIWSA00
          BRANCH    EXIT,EWAR0200,EWAR9500
          MOVE      SIWAWAR,ENDWAR
          PACK      TOWAR,SIWAWAR,SP1,SIWADES
          MATCH     STRWAR,ENDWAR
          GOTO      EWAR9000 IF EQUAL
          GOTO      EWAR9000 IF NOT LESS
          BEEP
          MOVE      "To Warehouse Must Be > From Warehouse - ",DISPMSG
          CALL      MESSAGE1
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          MOVE      SP70,VAR
          CALL      DISPITEM
.
          GOTO      EWAR0000
.
EWAR0200  MOVE      "Finish                                        ",TOWAR
          PACK      ENDWAR,Z70
.
EWAR9000  MOVE      "    7",FLDID
          CALL      GETPOSIT
          MOVE      ZERO,EXIT
          GOTO      EWAR9999
.
EWAR9500  MOVE      TWO,EXIT
          GOTO      EWAR9999
.
EWAR9999  RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSCKIKY    
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
          INC       SIN54CD     
          INC       SINCCAIO/INC
          INC       SINCCAKY    
          INC       SINCIAIO/INC
          INC       SINCIEIO/INC
          INC       SINFACIO/INC
          INC       SINNATIO/INC
          INC       SINORIIO/INC
          INC       SINORIKY    
          INC       SINPOAIO/INC
          INC       SINPOAKY    
          INC       SINPOCIO/INC
          INC       SINPOFIO/INC
          INC       SINWARIO/INC
          INC       SINWSEIO/INC
          INC       SINWSEKY    
.
          INC       STDGENCD
.
