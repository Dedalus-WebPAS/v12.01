.***************************************************************************
.* System    :   System Management                                         *
.* Program   :   HL7RSLTS                                                  *
.* Desc      :   HL7 Results Message Receiving Server                      *
.***************************************************************************
.* Date      :   01/10/2006                                                *
.* Author    :   Steve Armstrong                                           *
.* Function  :   This program will accept HL7 messages via a TCP/IP port.  *
.*               It will then validate the message and send an             *
.*               acknowledgement message back to the sender.  All messages *
.*               received are recorded for reviewing.                      *
.*               The first stage of message validation is purely at the    *
.*               HL7 level.  If this validation is successful, then the    *
.*               message will be processed by a subroutine specific for the*
.*               message type.  This subroutine will validate data against *
.*               the data tables then, if successful, update the tables    *
.*               accordingly.                                              *
.*                                                                         *
.*       Note:   Each read from the socket (via RECV) is into a buffer     *
.*               which can hold 4000 characters.  We may receive as few as *
.*               one character or as many as 4000 characters on any given  *
.*               read (RECV), so we need to keep reading while there are   *
.*               characters coming through.                                *
.*               For example, a message which is 30 characters long, may   *
.*               come through in 3 reads (RECV), the first read receiving  *
.*               10 characters, the second 15 characters, and the third    *
.*               5 characters.  It may also be the case that characters    *
.*               from two separate messages may come through in a single   *
.*               read ie, the tail of one message and the start of the     *
.*               next message.                                             *
.*                                                                         *
.*  Segments Validated                                                     *
.*            MSH - Message Header                                         *
.*            PID - Patient Identification                                 *
.*            PV1 - Visit Information                                      *
.*            ORC - Common Order                                           *
.*            RXD - Pharmacy Treatment/Dispense                            *
.*            RXR - Pharmacy Treatment Route                               *
.*                                                                         *
.*  HL7 Messages Processed                                                 *
.*            RDS^O01 - Pharmacy/Treatment Dispense                        *
.*            ORU^R01 - Unsolicited Observation                            *
.***************************************************************************
.*  Mod's     :                                                            *
.*        V11.00.01 21/04/2020  Davin            TSK 0879163               *
.*                  Added GENDR000 - validate PID.8 (sex) with Cat.G value *
.*        V10.15.02 31/10/2019  Thanh T          TSK 0856646               *
.*                  Recompiled for HL7CISVR changes                        *
.*        V10.15.01 07/10/2019  Ken Bell         TSK 0875392               *
.*                  Recompile for HL7CISVR - Cancelled ACC Details         *
.*        V10.11.01 14/09/2017  Thanh T.         TSK 0821710               *
.*                  ecompiled for HL7CISVR                                 *
.*        V10.05.00 16/07/2014  Steve Armstrong  CAR 291316/306161         *
.*                  Created program                                        *
.***************************************************************************
.
          INC       STD002FD
.
          INC       HL7CISVR/INC
          INC       OBSMEDFD/INC
          INC       PATAM1FD/INC
          INC       PMSTLEFD/INC
          INC       TFILEVAR/INC
.
.         File Definitions
.         ----------------
.
LISSOCKT  SOCKET    ASCII,FIXED=1   * socket on which to listen for connections
.
.
.         Temporary File Definition
.         -------------------------
.
DRUGTMP1  IFILE SQL, FIXED=362, KEY="U1-3"
.
.NAME     TYPE    LENGTH     PHYSICAL     START     DESCRIPTION
.----     ----    ------     --------     -----     -----------
DTMPUNIQ  DIM      3           3            1       Record Counter
TEMPDRUG  DIM      70          70           4       Drug name
TEMPSCDT  DIM      8           8           74       Script Date
TEMPINST  DIM      200         200         82       Instructions
TEMPDOSE  DIM      40          40         282       Dosage
TEMPDRBR  DIM      40          40         322       Drug Brand
.
.End of Record                            362
.
. Redefine FORM fields from key
. -----------------------------
TEMPUNIQ  FORM     3
.
.
.
. LOCAL VARIABLES
. ---------------
ALTERDSC  DIM       50            * error description for email alert
O01ARRAY  DIM       1[6]          * O01 mandatory segment array
.                                      element 1 = MSH
.                                      element 2 = PID
.                                      element 3 = PV1
.                                      element 4 = ORC
.                                      element 5 = RXD
.                                      element 6 = RXR
O01ARRCT  FORM      2[3]          * O01 mandatory segment array count
.
CDDRCTRY  DIM       80
COMPCNT   FORM      2             * component count for a field
COMPFLAG  FORM      1             * Component Flag
.                                         0 = Component character not set
.                                         1 = Component character set
COMSEPAR  DIM       1             * component separator variable
COUNTR    FORM      2
CURRDATE  DIM       8
.
DATFLAG1  FORM      1             * Dates Allowed flag
.                                     0 = any datetime allowed
.                                     1 = future datetime not allowed
.                                     2 = future time only allowed
.                                         (date must be past or current)
DATFLAG2  FORM      1             * Date Type
.                                     0 = Date only (ccyymmdd)
.                                     1 = Date and Time (ccyymmddhhmmss)
DATETIME  DIM       14            * message date/time (ccyymmddhhmmss)
DIM2C     DIM       2             * century variable (cc)
DIM2Y     DIM       2             * year variable    (yy)
DIM2M     DIM       2             * month variable   (mm)
DIM2D     DIM       2             * day variable     (dd)
DIM2H     DIM       2             * hour variable    (hh)
DIM2N     DIM       2             * minute variable  (mm)
DIM2S     DIM       2             * second variable  (ss)
DIM4      DIM       4             * full year work variable (ccyy)
DIM5      DIM       5
DIM8      DIM       8             * date/time work variable 
.                                         (ccyymmdd) or (hh:mm:ss)
DIM14     DIM       14            * date/time work variable (ccyymmddhhmmss)
DISPFLAG  FORM      1             * display to screen flag
.                                     0 = don't display messages to screen
.                                     1 = display messages to screen (debug)
DPATHVAR  DIM       100
.
ERRORDSC  DIM       70            * error description for acknowledgement
ERRORCNT  FORM      4             * error count
ERRORNUM  FORM      3             * HL7 error number
ERORLINE  DIM       80            * save variable for 1st error description
ERORNUMB  FORM      3             * HL7 error number for MSH segment
ERORTEXT  DIM       26
ESCSEPAR  DIM       1             * escape character
.
FIELDID   DIM       6
FIELDNO   FORM      3             * segment field counter
FORM3     FORM      3
FULLPATH  DIM       100
.
HOURTM    DIM       2
.
MESSGNUM  FORM      2             * message number
.                                      1 = RDS^O01 (Pharmacy/Treatment Dispense)
MESSTYPE  DIM       3             * message type (ie O01)
MINTIME   DIM       2
MSH00101  DIM       500           * MSH Component variables
MSH00201  DIM       500
MSH00301  DIM       500
MSH00302  DIM       500
MSH00303  DIM       500
MSH00401  DIM       500
MSH00402  DIM       500
MSH00403  DIM       500
MSH00501  DIM       500
MSH00502  DIM       500
MSH00503  DIM       500
MSH00601  DIM       500
MSH00602  DIM       500
MSH00603  DIM       500
MSH00701  DIM       500
MSH00801  DIM       500
MSH00901  DIM       3
MSH00902  DIM       3
MSH00903  DIM       7
MSH01001  DIM       500
MSH01101  DIM       500
MSH01102  DIM       500
MSH01201  DIM       500
MSH01202  DIM       500
MSH01203  DIM       500
MSH01301  DIM       500
MSH01401  DIM       500
MSH01501  DIM       500
MSH01601  DIM       500
MSH01701  DIM       500
MSH01801  DIM       500
MSH01901  DIM       500
MSH01902  DIM       500
MSH01903  DIM       500
MSH01904  DIM       500
MSH01905  DIM       500
MSH01906  DIM       500
MSH02001  DIM       500

MTYPARRY  DIM       3[1]
.
NEWSTRNG  DIM       4000
.
O01FAIL   FORM      8
O01RECV   FORM      8
O01SUCC   FORM      8
OBR00101  DIM       4
OBR00201  DIM       100
OBR00202  DIM       100
OBR00203  DIM       100
OBR00204  DIM       100
OBR00301  DIM       100
OBR00302  DIM       100
OBR00303  DIM       100
OBR00304  DIM       100
OBR00401  DIM       200
OBR00402  DIM       100
OBR00403  DIM       100
OBR00404  DIM       100
OBR00405  DIM       100
OBR00406  DIM       100
OBR00501  DIM       2
OBR00601  DIM       26
OBR00701  DIM       26
OBR00801  DIM       26
OBR00901  DIM       100
OBR00902  DIM       100
OBR00903  DIM       100
OBR00904  DIM       100
OBR00905  DIM       100
OBR00906  DIM       100
OBR00907  DIM       100
OBR00908  DIM       100
OBR00909  DIM       100
OBR00910  DIM       100
OBR00911  DIM       100
OBR00912  DIM       100
OBR01001  DIM       100
OBR01002  DIM       100
OBR01003  DIM       100
OBR01004  DIM       100
OBR01005  DIM       100
OBR01006  DIM       100
OBR01007  DIM       100
OBR01008  DIM       100
OBR01009  DIM       100
OBR01010  DIM       100
OBR01011  DIM       100
OBR01012  DIM       100
OBR01013  DIM       100
OBR01014  DIM       100
OBR01015  DIM       100
OBR01101  DIM       1
OBR01201  DIM       200
OBR01202  DIM       100
OBR01203  DIM       100
OBR01204  DIM       100
OBR01205  DIM       100
OBR01206  DIM       100
OBR01301  DIM       300
OBR01401  DIM       26
OBR01501  DIM       300
OBR01502  DIM       100
OBR01503  DIM       100
OBR01504  DIM       100
OBR01505  DIM       100
OBR01506  DIM       100
OBR01601  DIM       120
OBR01602  DIM       100
OBR01603  DIM       100
OBR01604  DIM       100
OBR01605  DIM       100
OBR01606  DIM       100
OBR01607  DIM       100
OBR01608  DIM       100
OBR01609  DIM       100
OBR01610  DIM       100
OBR01611  DIM       100
OBR01612  DIM       100
OBR01613  DIM       100
OBR01614  DIM       100
OBR01615  DIM       100
OBR01701  DIM       100
OBR01702  DIM       100
OBR01703  DIM       100
OBR01704  DIM       100
OBR01705  DIM       100
OBR01706  DIM       100
OBR01707  DIM       100
OBR01708  DIM       100
OBR01709  DIM       100
OBR01801  DIM       100
OBR01901  DIM       100
OBR02001  DIM       100
OBR02101  DIM       100
OBR02201  DIM       26
OBR02301  DIM       100
OBR02302  DIM       100
OBR02401  DIM       10
OBR02501  DIM       1
OBR02601  DIM       200
OBR02602  DIM       100
OBR02603  DIM       100
OBR02701  DIM       200
OBR02702  DIM       100
OBR02703  DIM       100
OBR02704  DIM       100
OBR02705  DIM       100
OBR02706  DIM       100
OBR02707  DIM       100
OBR02708  DIM       100
OBR02709  DIM       100
OBR02710  DIM       100
OBR02711  DIM       100
OBR02712  DIM       100
OBR02801  DIM       150
OBR02802  DIM       100
OBR02803  DIM       100
OBR02804  DIM       100
OBR02805  DIM       100
OBR02806  DIM       100
OBR02807  DIM       100
OBR02808  DIM       100
OBR02809  DIM       100
OBR02810  DIM       100
OBR02811  DIM       100
OBR02812  DIM       100
OBR02813  DIM       100
OBR02814  DIM       100
OBR02815  DIM       100
OBR02901  DIM       200
OBR02902  DIM       100
OBR03001  DIM       20
OBR03101  DIM       200
OBR03102  DIM       100
OBR03103  DIM       100
OBR03104  DIM       100
OBR03105  DIM       100
OBR03106  DIM       100
OBR03201  DIM       200
OBR03202  DIM       100
OBR03203  DIM       100
OBR03204  DIM       100
OBR03205  DIM       100
OBR03206  DIM       100
OBR03207  DIM       100
OBR03208  DIM       100
OBR03209  DIM       100
OBR03210  DIM       100
OBR03211  DIM       100
OBR03301  DIM       200
OBR03302  DIM       100
OBR03303  DIM       100
OBR03304  DIM       100
OBR03305  DIM       100
OBR03306  DIM       100
OBR03307  DIM       100
OBR03308  DIM       100
OBR03309  DIM       100
OBR03310  DIM       100
OBR03311  DIM       100
OBR03401  DIM       200
OBR03402  DIM       100
OBR03403  DIM       100
OBR03404  DIM       100
OBR03405  DIM       100
OBR03406  DIM       100
OBR03407  DIM       100
OBR03408  DIM       100
OBR03409  DIM       100
OBR03410  DIM       100
OBR03411  DIM       100
OBR03501  DIM       200
OBR03502  DIM       100
OBR03503  DIM       100
OBR03504  DIM       100
OBR03505  DIM       100
OBR03506  DIM       100
OBR03507  DIM       100
OBR03508  DIM       100
OBR03509  DIM       100
OBR03510  DIM       100
OBR03511  DIM       100
OBR03601  DIM       26
OBR03701  DIM       4
OBR03801  DIM       200
OBR03802  DIM       100
OBR03803  DIM       100
OBR03804  DIM       100
OBR03805  DIM       100
OBR03806  DIM       100
OBR03901  DIM       200
OBR03902  DIM       100
OBR03903  DIM       100
OBR03904  DIM       100
OBR03905  DIM       100
OBR03906  DIM       100
OBR04001  DIM       200
OBR04002  DIM       100
OBR04003  DIM       100
OBR04004  DIM       100
OBR04005  DIM       100
OBR04006  DIM       100
OBR04101  DIM       30
OBR04201  DIM       1
OBR04301  DIM       200
OBR04302  DIM       100
OBR04303  DIM       100
OBR04304  DIM       100
OBR04305  DIM       100
OBR04306  DIM       100
OBR04401  DIM       200
OBR04402  DIM       100
OBR04403  DIM       100
OBR04404  DIM       100
OBR04405  DIM       100
OBR04406  DIM       100
OBR04501  DIM       200
OBR04502  DIM       100
OBR04503  DIM       100
OBR04504  DIM       100
OBR04505  DIM       100
OBR04506  DIM       100
OLDSTRNG  DIM       4000
ORC00101  DIM       2
ORC00201  DIM       100
ORC00202  DIM       100
ORC00203  DIM       100
ORC00204  DIM       100
ORC00301  DIM       100
ORC00302  DIM       100
ORC00303  DIM       100
ORC00304  DIM       100
ORC00401  DIM       100
ORC00402  DIM       100
ORC00403  DIM       100
ORC00404  DIM       100
ORC00501  DIM       2
ORC00601  DIM       1
ORC00701  DIM       200
ORC00702  DIM       200
ORC00703  DIM       200
ORC00704  DIM       200
ORC00705  DIM       200
ORC00706  DIM       200
ORC00707  DIM       200
ORC00708  DIM       200
ORC00709  DIM       200
ORC00710  DIM       200
ORC00711  DIM       200
ORC00712  DIM       200
ORC00801  DIM       200
ORC00802  DIM       200
ORC00901  DIM       26
ORC01001  DIM       120
ORC01002  DIM       120
ORC01003  DIM       120
ORC01004  DIM       120
ORC01005  DIM       120
ORC01006  DIM       120
ORC01007  DIM       120
ORC01008  DIM       120
ORC01009  DIM       120
ORC01010  DIM       120
ORC01011  DIM       120
ORC01012  DIM       120
ORC01013  DIM       120
ORC01014  DIM       120
ORC01015  DIM       120
ORC01101  DIM       120
ORC01102  DIM       120
ORC01103  DIM       120
ORC01104  DIM       120
ORC01105  DIM       120
ORC01106  DIM       120
ORC01107  DIM       120
ORC01108  DIM       120
ORC01109  DIM       120
ORC01110  DIM       120
ORC01111  DIM       120
ORC01112  DIM       120
ORC01113  DIM       120
ORC01114  DIM       120
ORC01115  DIM       120
ORC01201  DIM       120
ORC01202  DIM       120
ORC01203  DIM       120
ORC01204  DIM       120
ORC01205  DIM       120
ORC01206  DIM       120
ORC01207  DIM       120
ORC01208  DIM       120
ORC01209  DIM       120
ORC01210  DIM       120
ORC01211  DIM       120
ORC01212  DIM       120
ORC01213  DIM       120
ORC01214  DIM       120
ORC01215  DIM       120
ORC01301  DIM       100
ORC01302  DIM       100
ORC01303  DIM       100
ORC01304  DIM       100
ORC01305  DIM       100
ORC01306  DIM       100
ORC01307  DIM       100
ORC01308  DIM       100
ORC01309  DIM       100
ORC01401  DIM       100
ORC01402  DIM       100
ORC01403  DIM       100
ORC01404  DIM       100
ORC01405  DIM       100
ORC01406  DIM       100
ORC01407  DIM       100
ORC01408  DIM       100
ORC01409  DIM       100
ORC01501  DIM       26
ORC01601  DIM       200
ORC01602  DIM       200
ORC01603  DIM       200
ORC01604  DIM       200
ORC01605  DIM       200
ORC01606  DIM       200
ORC01701  DIM       100
ORC01702  DIM       100
ORC01703  DIM       100
ORC01704  DIM       100
ORC01705  DIM       100
ORC01706  DIM       100
ORC01801  DIM       600
ORC01802  DIM       100
ORC01803  DIM       100
ORC01804  DIM       100
ORC01805  DIM       100
ORC01806  DIM       100
ORC01901  DIM       120
ORC01902  DIM       120
ORC01903  DIM       120
ORC01904  DIM       120
ORC01905  DIM       120
ORC01906  DIM       120
ORC01907  DIM       120
ORC01908  DIM       120
ORC01909  DIM       120
ORC01910  DIM       120
ORC01911  DIM       120
ORC01912  DIM       120
ORC01913  DIM       120
ORC01914  DIM       120
ORC01915  DIM       120
ORC02001  DIM       100
ORC02002  DIM       100
ORC02003  DIM       100
ORC02004  DIM       100
ORC02005  DIM       100
ORC02006  DIM       100
ORC02101  DIM       100
ORC02102  DIM       100
ORC02103  DIM       100
ORC02104  DIM       100
ORC02105  DIM       100
ORC02106  DIM       100
ORC02107  DIM       100
ORC02108  DIM       100
ORC02109  DIM       100
ORC02201  DIM       200
ORC02202  DIM       100
ORC02203  DIM       100
ORC02204  DIM       100
ORC02205  DIM       100
ORC02206  DIM       100
ORC02207  DIM       100
ORC02208  DIM       100
ORC02209  DIM       100
ORC02210  DIM       100
ORC02211  DIM       100
ORC02301  DIM       100
ORC02302  DIM       100
ORC02303  DIM       100
ORC02304  DIM       100
ORC02305  DIM       100
ORC02306  DIM       100
ORC02307  DIM       100
ORC02308  DIM       100
ORC02309  DIM       100
ORC02401  DIM       200
ORC02402  DIM       100
ORC02403  DIM       100
ORC02404  DIM       100
ORC02405  DIM       100
ORC02406  DIM       100
ORC02407  DIM       100
ORC02408  DIM       100
ORC02409  DIM       100
ORC02410  DIM       100
ORC02411  DIM       100
.
PID00101  DIM       500
PID00201  DIM       500
PID00202  DIM       500
PID00203  DIM       500
PID00204  DIM       500
PID00205  DIM       500
PID00206  DIM       500
PID00301  DIM       100[5]
PID00302  DIM       100[5]
PID00303  DIM       5[5]
PID00304  DIM       6[5]
PID00305  DIM       100[5]
PID00306  DIM       100[5]
PID00401  DIM       500
PID00402  DIM       500
PID00403  DIM       500
PID00404  DIM       500
PID00405  DIM       500
PID00406  DIM       500
PID00501  DIM       500
PID00502  DIM       500
PID00503  DIM       500
PID00504  DIM       500
PID00505  DIM       500
PID00506  DIM       500
PID00507  DIM       500
PID00508  DIM       500
PID00601  DIM       500
PID00602  DIM       500
PID00603  DIM       500
PID00604  DIM       500
PID00605  DIM       500
PID00606  DIM       500
PID00607  DIM       500
PID00608  DIM       500
PID00701  DIM       500
PID00801  DIM       500
PID00901  DIM       40[80]
PID00902  DIM       40[80]
PID00903  DIM       40[80]
PID00904  DIM       2[80]
PID00905  DIM       2[80]
PID00906  DIM       2[80]
PID00907  DIM       2[80]
PID00908  DIM       2[80]
PID01001  DIM       500
PID01002  DIM       500
PID01003  DIM       500
PID01004  DIM       500
PID01005  DIM       500
PID01006  DIM       500
PID01101  DIM       35[2]
PID01102  DIM       35[2]
PID01103  DIM       35[2]
PID01104  DIM       35[2]
PID01105  DIM       8[2]
PID01106  DIM       35[2]
PID01107  DIM       2[2]
PID01108  DIM       2[2]
PID01109  DIM       2[2]
PID01110  DIM       2[2]
PID01111  DIM       2[2]
PID01201  DIM       500
PID01301  DIM       500[2]
PID01302  DIM       500[2]
PID01303  DIM       500[2]
PID01304  DIM       500[2]
PID01305  DIM       500[2]
PID01306  DIM       500[2]
PID01307  DIM       500[2]
PID01308  DIM       500[2]
PID01309  DIM       500[2]
PID01401  DIM       500[2]
PID01402  DIM       500[2]
PID01403  DIM       500[2]
PID01404  DIM       500[2]
PID01405  DIM       500[2]
PID01406  DIM       500[2]
PID01407  DIM       500[2]
PID01408  DIM       500[2]
PID01409  DIM       500[2]
PID01501  DIM       500
PID01502  DIM       500
PID01503  DIM       500
PID01504  DIM       500
PID01505  DIM       500
PID01506  DIM       500
PID01601  DIM       500
PID01602  DIM       500
PID01603  DIM       500
PID01604  DIM       500
PID01605  DIM       500
PID01606  DIM       500
PID01701  DIM       500
PID01702  DIM       500
PID01703  DIM       500
PID01704  DIM       500
PID01705  DIM       500
PID01706  DIM       500
PID01801  DIM       500
PID01802  DIM       500
PID01803  DIM       500
PID01804  DIM       500
PID01805  DIM       500
PID01806  DIM       500
PID01901  DIM       500
PID02001  DIM       500
PID02002  DIM       500
PID02003  DIM       500
PID02101  DIM       500
PID02102  DIM       500
PID02103  DIM       500
PID02104  DIM       500
PID02105  DIM       500
PID02106  DIM       500
PID02201  DIM       500
PID02202  DIM       500
PID02203  DIM       500
PID02204  DIM       500
PID02205  DIM       500
PID02206  DIM       500
PID02301  DIM       500
PID02401  DIM       500
PID02501  DIM       500
PID02601  DIM       500
PID02602  DIM       500
PID02603  DIM       500
PID02604  DIM       500
PID02605  DIM       500
PID02606  DIM       500
PID02701  DIM       500
PID02702  DIM       500
PID02703  DIM       500
PID02704  DIM       500
PID02705  DIM       500
PID02706  DIM       500
PID02801  DIM       500
PID02802  DIM       500
PID02803  DIM       500
PID02804  DIM       500
PID02805  DIM       500
PID02806  DIM       500
PID02901  DIM       500
PID03001  DIM       500
PREVCHAR  DIM       1
PV100101  DIM       100
PV100201  DIM       100
PV100301  DIM       100
PV100302  DIM       100
PV100303  DIM       100
PV100304  DIM       100
PV100305  DIM       100
PV100306  DIM       100
PV100307  DIM       100
PV100308  DIM       100
PV100309  DIM       100
PV100401  DIM       100
PV100501  DIM       100
PV100502  DIM       100
PV100503  DIM       100
PV100504  DIM       100
PV100505  DIM       100
PV100506  DIM       100
PV100601  DIM       100
PV100602  DIM       100
PV100603  DIM       100
PV100604  DIM       100
PV100605  DIM       100
PV100606  DIM       100
PV100607  DIM       100
PV100608  DIM       100
PV100609  DIM       100
PV100701  DIM       100
PV100702  DIM       100
PV100703  DIM       100
PV100704  DIM       100
PV100705  DIM       100
PV100706  DIM       100
PV100707  DIM       100
PV100708  DIM       100
PV100709  DIM       100
PV100710  DIM       100
PV100711  DIM       100
PV100712  DIM       100
PV100713  DIM       100
PV100714  DIM       100
PV100715  DIM       100
PV100801  DIM       100
PV100802  DIM       100
PV100803  DIM       100
PV100804  DIM       100
PV100805  DIM       100
PV100806  DIM       100
PV100807  DIM       100
PV100808  DIM       100
PV100809  DIM       100
PV100810  DIM       100
PV100811  DIM       100
PV100812  DIM       100
PV100813  DIM       100
PV100814  DIM       100
PV100815  DIM       100
PV100901  DIM       100
PV100902  DIM       100
PV100903  DIM       100
PV100904  DIM       100
PV100905  DIM       100
PV100906  DIM       100
PV100907  DIM       100
PV100908  DIM       100
PV100909  DIM       100
PV100910  DIM       100
PV100911  DIM       100
PV100912  DIM       100
PV100913  DIM       100
PV100914  DIM       100
PV100915  DIM       100
PV101001  DIM       100
PV101101  DIM       100
PV101102  DIM       100
PV101103  DIM       100
PV101104  DIM       100
PV101105  DIM       100
PV101106  DIM       100
PV101107  DIM       100
PV101108  DIM       100
PV101109  DIM       100
PV101201  DIM       100
PV101301  DIM       100
PV101401  DIM       100
PV101501  DIM       100
PV101601  DIM       100
PV101701  DIM       100
PV101702  DIM       100
PV101703  DIM       100
PV101704  DIM       100
PV101705  DIM       100
PV101706  DIM       100
PV101707  DIM       100
PV101708  DIM       100
PV101709  DIM       100
PV101710  DIM       100
PV101711  DIM       100
PV101712  DIM       100
PV101713  DIM       100
PV101714  DIM       100
PV101715  DIM       100
PV101801  DIM       100
PV101901  DIM       100
PV101902  DIM       100
PV101903  DIM       100
PV101904  DIM       100
PV101905  DIM       100
PV101906  DIM       100
PV102001  DIM       100
PV102002  DIM       100
PV102101  DIM       100
PV102201  DIM       100
PV102301  DIM       100
PV102401  DIM       100
PV102501  DIM       100
PV102601  DIM       100
PV102701  DIM       100
PV102801  DIM       100
PV102901  DIM       100
PV103001  DIM       100
PV103101  DIM       100
PV103201  DIM       100
PV103301  DIM       100
PV103401  DIM       100
PV103501  DIM       100
PV103601  DIM       100
PV103701  DIM       100
PV103702  DIM       100
PV103801  DIM       100
PV103802  DIM       100
PV103803  DIM       100
PV103804  DIM       100
PV103805  DIM       100
PV103806  DIM       100
PV103901  DIM       100
PV104001  DIM       100
PV104101  DIM       100
PV104201  DIM       100
PV104202  DIM       100
PV104203  DIM       100
PV104204  DIM       100
PV104205  DIM       100
PV104206  DIM       100
PV104207  DIM       100
PV104208  DIM       100
PV104209  DIM       100
PV104301  DIM       100
PV104302  DIM       100
PV104303  DIM       100
PV104304  DIM       100
PV104305  DIM       100
PV104306  DIM       100
PV104307  DIM       100
PV104308  DIM       100
PV104309  DIM       100
PV104401  DIM       100
PV104501  DIM       100
PV104601  DIM       100
PV104701  DIM       100
PV104801  DIM       100
PV104901  DIM       100
PV105001  DIM       100
PV105002  DIM       100
PV105003  DIM       100
PV105004  DIM       100
PV105005  DIM       100
PV105006  DIM       100
PV105101  DIM       100
PV105201  DIM       100
PV105202  DIM       100
PV105203  DIM       100
PV105204  DIM       100
PV105205  DIM       100
PV105206  DIM       100
PV105207  DIM       100
PV105208  DIM       100
PV105209  DIM       100
PV105210  DIM       100
PV105211  DIM       100
PV105212  DIM       100
PV105213  DIM       100
PV105214  DIM       100
PV105215  DIM       100
.
REPSEPAR  DIM       1             * repetition separator character
REPTNCNT  FORM      3             * repetition count
RECVMESS  DIM       4000          * message buffer
RXD00101  DIM       4
RXD00201  DIM       100
RXD00202  DIM       100
RXD00203  DIM       100
RXD00204  DIM       100
RXD00205  DIM       100
RXD00206  DIM       100
RXD00301  DIM       26
RXD00401  DIM       20
RXD00501  DIM       100
RXD00502  DIM       100
RXD00503  DIM       100
RXD00504  DIM       100
RXD00505  DIM       100
RXD00506  DIM       100
RXD00601  DIM       100
RXD00602  DIM       100
RXD00603  DIM       100
RXD00604  DIM       100
RXD00605  DIM       100
RXD00606  DIM       100
RXD00701  DIM       20
RXD00801  DIM       20
RXD00901  DIM       200
RXD01001  DIM       200
RXD01002  DIM       200
RXD01003  DIM       200
RXD01004  DIM       200
RXD01005  DIM       200
RXD01006  DIM       200
RXD01007  DIM       200
RXD01008  DIM       200
RXD01009  DIM       200
RXD01010  DIM       200
RXD01011  DIM       200
RXD01012  DIM       200
RXD01013  DIM       200
RXD01014  DIM       200
RXD01015  DIM       200
RXD01101  DIM       1
RXD01201  DIM       100
RXD01202  DIM       100
RXD01203  DIM       100
RXD01204  DIM       100
RXD01205  DIM       100
RXD01206  DIM       100
RXD01207  DIM       100
RXD01208  DIM       100
RXD01209  DIM       100
RXD01301  DIM       200
RXD01302  DIM       200
RXD01303  DIM       200
RXD01304  DIM       200
RXD01305  DIM       200
RXD01306  DIM       200
RXD01307  DIM       200
RXD01308  DIM       200
RXD01309  DIM       200
RXD01310  DIM       200
RXD01311  DIM       200
RXD01312  DIM       200
RXD01313  DIM       200
RXD01314  DIM       200
RXD01315  DIM       200
RXD01316  DIM       200
RXD01401  DIM       1
RXD01501  DIM       200
RXD01502  DIM       200
RXD01503  DIM       200
RXD01504  DIM       200
RXD01505  DIM       200
RXD01506  DIM       200
RXD01601  DIM       20
RXD01701  DIM       100
RXD01702  DIM       100
RXD01703  DIM       100
RXD01704  DIM       100
RXD01705  DIM       100
RXD01706  DIM       100
RXD01801  DIM       100
RXD01901  DIM       26
RXD02001  DIM       100
RXD02002  DIM       100
RXD02003  DIM       100
RXD02004  DIM       100
RXD02005  DIM       100
RXD02006  DIM       100
RXD02101  DIM       200
RXD02102  DIM       200
RXD02103  DIM       200
RXD02104  DIM       200
RXD02105  DIM       200
RXD02106  DIM       200
RXD02201  DIM       20
RXD02301  DIM       100
RXD02302  DIM       100
RXD02303  DIM       100
RXD02304  DIM       100
RXD02305  DIM       100
RXD02306  DIM       100
RXD02401  DIM       2
RXDCOUNT  FORM      3
RXR00101  DIM       100
RXR00102  DIM       100
RXR00103  DIM       100
RXR00104  DIM       100
RXR00105  DIM       100
RXR00106  DIM       100
RXR00201  DIM       100
RXR00202  DIM       100
RXR00203  DIM       100
RXR00204  DIM       100
RXR00205  DIM       100
RXR00206  DIM       100
RXR00301  DIM       100
RXR00302  DIM       100
RXR00303  DIM       100
RXR00304  DIM       100
RXR00305  DIM       100
RXR00306  DIM       100
RXR00401  DIM       100
RXR00402  DIM       100
RXR00403  DIM       100
RXR00404  DIM       100
RXR00405  DIM       100
RXR00406  DIM       100
RXR00501  DIM       100
RXR00502  DIM       100
RXR00503  DIM       100
RXR00504  DIM       100
RXR00505  DIM       100
RXR00506  DIM       100
.
SAVAPPLI  DIM       180           * save application variable
SAVEDATE  DIM       8
SAVFACIL  DIM       180           * save facility variable
SAVMESID  DIM       20            * saved incoming message id
SAVPRCID  DIM       1             * saved incoming processing id
SAVSEGMT  DIM       3
SAVVISIT  DIM       8
SECTIME   DIM       2
SEGCOUNT  FORM      2             * segment sequence count
SEGMENT   DIM       3             * 3 character HL7 segment code
SEGNUMBR  FORM      2             * segment number
.                                     1 = MSH
.                                     2 = PID
.                                     3 = PV1
.                                     4 = ORC
.                                     5 = RXD
.                                     6 = RXR
SENTMESS  DIM       4000
STRNGLEN  FORM      4
SUBSEPAR  DIM       1             * sub-component separator
.
TCPIPORT  DIM       40            * receiving machine name and port number
TIMSTAMP  DIM       8
TMPSTRNG  DIM       4000          * buffer for reading in message
TXTFNAME  DIM       8             * text file name variable
.
UPDDFLAG  FORM      1             * Update Data Flag
.                                    0 = No (don't write/update PAS data tables)
.                                    1 = Yes (write/update PAS data tables)
URNFOUND  FORM      1             * U/R Number found flag
.                                     0 = U/R found
.                                     1 = no U/R found
.
.
. PROGRAM CONSTANTS
. -----------------
CARET     INIT      "^"
COMECAPT  INIT      "Data committed"
COMSCAPT  INIT      "Commencing data commit"
CONNCAPT  INIT      "Connection Lost"
CRETURN   INIT      015                * Carriage Return
.
DASHLINE  INIT      "--------------------------------------------------":
                    "------------------------------"
.
ENDBLOCK  INIT      034                * End of Block
ENVVNAME  INIT      "DPATH"
ERORCAPT  INIT      "Data not committed based on message errors"
.
ICOMCAPT  INIT      "Timeout waiting for incoming message"
.
LODECAPT  INIT      " segment loaded"
LODSCAPT  INIT      "Loading segment: "
.
MINUS3    FORM      "-3"
MSASCAPT  INIT      "MSA Segment successfully sent"
MSEQCAPT  INIT      "Message segment sequence not valid"
MSHSCAPT  INIT      "MSH Segment successfully sent"
MSHSEGMT  INIT      "MSH"
MSHMCAPT  INIT      "MSH segment missing"
MTYPEO01  INIT      "O01"
.
NUPDCAPT  INIT      "Data not committed based on update mode"
.
ORCSEGMT  INIT      "ORC"
OUTGCAPT  INIT      "Timeout waiting for outgoing message"
.
PIPE      INIT      "|"
PIDSEGMT  INIT      "PID"
PV1SEGMT  INIT      "PV1"
.
RECVCAPT  INIT      "Data received at: "
RXDSEGMT  INIT      "RXD"
RXRSEGMT  INIT      "RXR"
.
SENDCAPN  INIT      "Acknowledgement Message sent at: "
SP100     INIT      "                                                  ":
                    "                                                  "
STRTBLOK  INIT      013                * Start of Block
.
TESTCAPT  INIT      "Data not committed based on Processing ID"
.
UKEYA     INIT      " 362 U1-3"
.
VALECAPT  INIT      " segment validated"
VALSCAPT  INIT      "Validating segment: "
VOTSCAPT  INIT      "Validating message specific fields"
VOTECAPT  INIT      "Message specific fields validated"
.
.
.-----------------------------------------------------------------------
PRGID     INIT      "HL7RSLTS"
PRGNAM    INIT      "HL7 Results Message Receiver"
VERSION   INIT      "V12.01.00"
.-----------------------------------------------------------------------
+
.*************************************************************************
.*                             MAIN0000                                  *
.*                  Main processing routine                              *
.*************************************************************************
.
MAIN0000  CALL      SETX0000                     * set up common
.
          CALL      INIT0000                     * initialisation routine
          BRANCH    EXIT,MAIN9999
.
          CALL      CREA0000                     * create temporary table
.
          CALL      PROC0000                     * listen for & process message
.
          CALL      KILL0000                     * remove temporary table
.
MAIN9999  STOP
+
.*****************************************************************************
.*                         INIT0000                Called by: MAIN0000       *
.*               Initialisation routine                                      *
.*****************************************************************************
.
INIT0000  CALL      DISPHEAD                     * display screen header
.
          DISPLAY   *P1:24,*EL,*P54:24,"Opening":
                    *P64:24,"controlf"
          OPEN      CONTROLF,"controlf"
.
          DISPLAY   *P56:24,"obsmedaf";
          OPEN      OBSMEDA1,"obsmedaf"
.
          DISPLAY   *P64:24,"patcodes"
          OPEN      PATCODE1,"patcodes"
          OPEN      PATCODE2,"patcodes"
.
          DISPLAY   *P56:24,"patma1af";
          OPEN      PATMA1A1,"patma1af"
          OPEN      PATMX1A1,"patmx1af"
.
          DISPLAY   *P56:24,"patmi1af";
          OPEN      PATMI1A1,"patmi1af"
.
          DISPLAY   *P56:24,"pmsvx1af";
          OPEN      PMSVX1A1,"pmsvx1af"
.
          DISPLAY   *P56:24,"patvisaf";
          OPEN      PATVISA1,"patvisaf"
.
          DISPLAY   *P56:24,"pmspx2af";
          OPEN      PMSPX2A1,"pmspx2af"
.
          READ      CONTROLF,TEN;*79,CAPPRVNO         * hospital approval no.
          READ      CONTROLF,HUND03;*217,PTCNCKDG     * sending U/R check digit
.
.         Get the first directory in the DPATH (cd directory) as this will
.         be where the log file will be created/updated if required
.
          GETENV    ENVVNAME,DPATHVAR            * get DPATH
          IF        @OVER
            DISPLAY   *P1:24,*EL,*B,"Problem getting DPATH (1)",*W5;
            GOTO      INIT9100
          ENDIF
.         
          MOVE      SP100,CDDRCTRY               * clear cd directory variable
          CLEAR     CDDRCTRY
          SCAN      ":",DPATHVAR                 * find end of first directory
          IF        @EOS
            DISPLAY   *P1:24,*EL,*B,"Problem getting DPATH (2)",*W5;
            GOTO      INIT9100
          ENDIF
.
          IF        @EQUAL
            MOVEFPTR  DPATHVAR,FORM3
            SUB       ONE,FORM3
            RESET     DPATHVAR
            SETLPTR   DPATHVAR,FORM3
          ENDIF
.
          MOVE      DPATHVAR,CDDRCTRY
          ENDSET    CDDRCTRY
          APPEND    SLASH,CDDRCTRY
          RESET     CDDRCTRY
.
.         Load up the message array with the valid messages which can
.         be accepted
.
          MOVE      ZERO,COUNTER
          WHILE     COUNTER < 1
            ADD       ONE,COUNTER               
            MOVE      SP3,MTYPARRY[COUNTER]
          DO
.
          MOVE      "O01",MTYPARRY[1]
.
          MOVE      "1000",RPLYTIME              * set timeout
.
INIT1000  KEYIN     *P1:6,*EF,"Update data files (",*V2LON,*DV:
                    ANSY,*HOFF,*DV,SLASH,*V2LON,*DV,ANSN,*HOFF,") :":
                    *P40:6,*V2LON,ANS
.
          PACK      ANS,ANS,SP1
          REP       UPPLOW,ANS
.
          MATCH     ANSY,ANS
          iF        @EQUAL
            MOVE      ONE,UPDDFLAG
            GOTO      INIT2000
          ENDIF
.
          MATCH     ANSN,ANS
          IF        @EQUAL
            MOVE      ZERO,UPDDFLAG
            GOTO      INIT2000
          ENDIF
.
          BEEP
          GOTO      INIT1000
.
INIT2000  KEYIN     *P1:8,"Display messages to the screen (",*V2LON,*DV:
                    ANSY,*HOFF,*DV,SLASH,*V2LON,*DV,ANSN,*HOFF,") :":
                    *P40:8,*V2LON,ANS
.
          PACK      ANS,ANS,SP1
          REP       UPPLOW,ANS
.
          MATCH     ANSY,ANS
          IF        @EQUAL
            MOVE      ONE,DISPFLAG
            GOTO      INIT9050
          ENDIF
.
          MATCH     ANSN,ANS
          IF        @EQUAL
            MOVE      ZERO,DISPFLAG
            GOTO      INIT9000
          ENDIF
.
          BEEP
          GOTO      INIT2000
.
INIT9000  CALL      BACK0000
.
INIT9050  MOVE      ZERO,EXIT
          GOTO      INIT9999
.
INIT9100  MOVE      ONE,EXIT
.
INIT9999  RETURN
+
.*****************************************************************************
.*                              CREA0000               Called by: MAIN0000   *
.*             Create a new temporary file                                   *
.*****************************************************************************
.
CREA0000  CALL      TFILENAM                     * get new tempfile name
          MOVE      TFILNAME,TEMPFILE
.
          CALL      KILL0000                     * remove existing file
.
          CLEAR     CMDLINE
          PACK      CMDLINE,ISBUILD,TEMPFILE,UKEYA
          EXECUTE   CMDLINE,TASKID               * create temporary index file
.
          OPEN      DRUGTMP1,TEMPFILE            * open temp index file
.
CREA9999  RETURN
+
.****************************************************************************
.*                              KILL0000               Called by: MAIN0000  *
.*               Close and erase the temporary file                         *
.****************************************************************************
.
KILL0000  CLOSE     DRUGTMP1                     * close file
.
          CLEAR     CMDLINE
          PACK      CMDLINE,ERASE,TEMPFILE       * set file erase command
          EXECUTE   CMDLINE,TASKID               * erase temp file
.
KILL9999 RETURN
+
.****************************************************************************
.*                              CTMP0000               Called by: MAIN0000  *
.*               Clear all records from the temporary table                 *
.****************************************************************************
.
CTMP0000  MOVE      SP3,KEY3
          CALL      RSTEMP1                      * position at start of file
          CALL      RKTEMP1                      * read next record
          BRANCH    OVRCD,CTMP9999               * eof - finished
.
          MOVE      TEMPUNIQ,KEY3
          CALL      DETEMP1                      * delete current record
          GOTO      CTMP0000                     * get next record
.
CTMP9999  RETURN
+
.*****************************************************************************
.*                              PROC0000             Called by: MAIN0000     *
.*           Listen for and process an incoming message                      *
.*****************************************************************************
.
.         Get the solicited socket on which we will be listening.
.
PROC0000  IF        DISPFLAG = 1
            DISPLAY   *P1:4,*EF;
          ENDIF
.
          READ      CONTROLF,ZERO;*229,IBCNRESA
          MATCH     SP20,IBCNRESA                * blank socket ?
          GOTO      PROC9100 IF EQUAL            * yes
.
.         Set port
.
          MOVE      IBCNRESA,TCPIPORT
          STRIP     TCPIPORT
.
.         Listen on the port for a connection
.
          IF        DISPFLAG = 1
            DISPLAY   "Listening on port: ",TCPIPORT,*R,*N;
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          LISTEN    LISSOCKT,TCPIPORT
          TRAPCLR   IO
          BRANCH    OVRCD,PROC9700
.
          IF        DISPFLAG = 1
            DISPLAY   "Accepting connections on port: ",TCPIPORT,*R,*N;
          ENDIF
PROC0100  ACCEPT    COMSOCKT,LISSOCKT
          IF        DISPFLAG = 1
            DISPLAY   "Accepted connection on port: ",TCPIPORT,*R,*N;
          ENDIF
.
.         Wait for a new message to come through
.
PROC0500  IF        DISPFLAG = 1
            DISPLAY   "Waiting for next message....",*R,*N;
          ENDIF
.
          CLOSE     TEXTFILE                     * close text file
.
          CALL      CLER0000                     * clear mess. buffer and flags
          CALL      OLOG0000                     * open message log file
.
          CALL      GTSTR000                     * get next 4000 chars (or less)
          BRANCH    EXIT,PROC9500:               * timeout
                         PROC9000                * connection lost
.
.         Search the string for a start of block (ASCII 11) character
.
          SCAN      STRTBLOK,TMPSTRNG            * sob found ?
          GOTO      PROC0500 IF NOT EQUAL        * no - ignore message
.
          APPEND    STRTBLOK,RECVMESS            * yes
.
          IF        DISPFLAG = 1
            DISPLAY   "Start of Block found",*R,*N;
          ENDIF
.
.         The next segment needs to be processed, so read in the next segment id
.
PROC4000  CALL      GSEG0000                     * validate segment code
          BRANCH    EXIT,PROC9500:               * connection timeout
                         PROC9000:               * connection lost
                         PROC4000:               * start of block
                         PROC6000:               * end of block
                         PROC4000:               * end of segment
                         PROC0500                * 1st segment not MSH
.
          IF        DISPFLAG = 1
            DISPLAY   "Loading segment: [",SEGMENT,"]",*R,*N;
          ENDIF
          WRITE     TEXTFILE,SEQ;LODSCAPT,SEGMENT
.
.         We need to validate the segment for the message type, and
.         make sure that the segment is in the correct sequence for the
.         message
.
          CALL      VSEG0000                     * validate segment
          IF        EXIT = 0
            ADD       ONE,SEGCOUNT               * increment segment count
            PERFORM   MESSGNUM,VO010000          * validate RDS^O01 segments
          ENDIF
.
.         If a valid segment id has been found, clear the segment fields
.
          PERFORM   SEGNUMBR,CMSH0000:           * MSH
                             CPID0000:           * PID
                             CPV10000:           * PV1
                             CORC0000:           * ORC
                             CRXD0000:           * RXD
                             CRXR0000            * RXR
.
          MOVE      ZERO,FIELDNO                 * initialise seg. field count
.
.         Read in the rest of the segment until an end of segment character
.         (ASCII 13 - Carriage return) is found.
.
PROC5000  CALL      GCHR0000                     * get next character in message
          BRANCH    EXIT,PROC9500:               * connection timeout
                         PROC9000:               * connection lost
                         PROC4000:               * start of block
                         PROC6000:               * end of block
                         PROC5500:               * end of segment
                         PROC0500:               * no field separator
                         PROC0500                * missing encoding char(s)
.
.         Check if the character just read is a component separator,
.         as long as the field is not MSH.2 (which is where the component
.         separator is set).
.
          MATCH     MSHSEGMT,SEGMENT             * MSH segment & second field?
          IF        @EQUAL
            IF        FIELDNO = 2
              GOTO      PROC5100
            ENDIF
          ENDIF
.
.         If the character just read is a component separator, then reset
.         the previous field as long as there was data in the previous
.         field (ie the previous character was not a field separator or a
.         component separator or a repeat separator).
.
          MATCH     ANS,COMSEPAR                 * check if comp. separator
          IF        @EQUAL
            MATCH     PREVCHAR,ANS
            IF        !@EQUAL
              MATCH     PREVCHAR,MSH00101
              IF        !@EQUAL
                MATCH     PREVCHAR,COMSEPAR
                IF        !@EQUAL
                  MATCH     PREVCHAR,REPSEPAR
                  IF        !@EQUAL
                    CALL      RFLD0000           * reset component just loaded
                  ENDIF
                ENDIF
              ENDIF
            ENDIF
            ADD       ONE,COMPCNT                * increment component count
            GOTO      PROC5200                   * only load into full message
          ENDIF
.
          MATCH     ANS,REPSEPAR                 * check if repetition separator
          IF        @EQUAL
            MATCH     PREVCHAR,ANS
            IF        !@EQUAL
              MATCH     PREVCHAR,MSH00101
              IF        !@EQUAL
                MATCH     PREVCHAR,REPSEPAR
                IF        !@EQUAL
                  CALL      RFLD0000             * reset component just loaded
                ENDIF
              ENDIF
            ENDIF
            ADD       ONE,REPTNCNT               * increment repetition count
            MOVE      ONE,COMPCNT                * reset component count
            GOTO      PROC5200                   * only load into full message
          ENDIF
.
.         A valid character has been found so load it into the relevant
.         segment field/component (according to FIELDNO/COMPCNT/REPETITION).
.
PROC5100  PERFORM   SEGNUMBR,LMSH0000:           * MSH
                             LPID0000:           * PID
                             LPV10000:           * PV1
                             LORC0000:           * ORC
                             LRXD0000:           * RXD
                             LRXR0000            * RXR
.
PROC5200  APPEND    ANS,RECVMESS                 * append char. to full message
          MOVE      ANS,PREVCHAR                 * save character
          GOTO      PROC5000
.
PROC5500  WRITE     TEXTFILE,SEQ;SEGMENT,LODECAPT
          IF        DISPFLAG = 1
            DISPLAY   "Validating segment: [",SEGMENT,"]",*R,*N;
          ENDIF
          WRITE     TEXTFILE,SEQ;VALSCAPT,SEGMENT
.
          PERFORM   SEGNUMBR,VMSH0000:           * MSH
                             VPID0000:           * PID
                             VPV10000:           * PV1
                             VORC0000:           * ORC
                             VRXD0000:           * RXD
                             VRXR0000            * RXR
.
          IF        DISPFLAG = 1
            DISPLAY   "[",SEGMENT,"] segment validated",*R,*N;
          ENDIF
          WRITE     TEXTFILE,SEQ;SEGMENT,VALECAPT
.
          MATCH     ANS,ENDBLOCK                 * end of message received ?
          GOTO      PROC4000 IF NOT EQUAL        * no - get next segment
.
.         The end of message (EOB) has been found
.
PROC6000  RESET     RECVMESS
          IF        DISPFLAG = 1
            DISPLAY   "End of Block received",*R,*N;  * display full message
            STRIP     RECVMESS
            MOVE      ZERO,COUNTR
            MOVELPTR  RECVMESS,FORM4
            DISPLAY   *R,*N:
                      "----------------------------------------":
                      "----------------------------------------",*R,*N:
                      "Full Message received is ",FORM4," bytes (including ":
                      "control characters):",*R,*N,*R,*N;
            WHILE     FORM4 > 0
              ADD       ONE,COUNTR
              MATCH     CRETURN,RECVMESS
              IF        @EQUAL
                DISPLAY   *R,*N,*R,*N;
                MOVE      ZERO,COUNTR
              ELSE
                MOVE      RECVMESS,ANS
                DISPLAY   *HON,ANS,*HOFF;
                IF        COUNTR = 80
                  DISPLAY   "]",*R,*N;
                  MOVE      ZERO,COUNTR
                ENDIF
              ENDIF
              SUB       ONE,FORM4
              BUMP      RECVMESS
            DO
            DISPLAY   "----------------------------------------":
                      "----------------------------------------":
                      *R,*N,*R,*N;
            RESET     RECVMESS
          ENDIF
.
.         All general HL7 validations have been performed, so now we
.         need to validate that all mandatory segments have been received
.         for the message type
.
          CALL      MANR0000                     * check for mandatory segments
.
.         Finally validate message specific fields before writing the data
.         to the database
.
          IF        DISPFLAG = 1
            DISPLAY   "Validating message specific fields",*R,*N;
          ENDIF
          WRITE     TEXTFILE,SEQ;VOTSCAPT
          CALL      VMES0000                     * validate message
          WRITE     TEXTFILE,SEQ;VOTECAPT
.
.
.         If we are writing/updating the PAS database, and there are no errors,
.         then process the messages
.
          COMPARE   ZERO,ERRORCNT                * any errors ?
          IF        !@EQUAL
            WRITE     TEXTFILE,SEQ;ERORCAPT
            GOTO      PROC7000
          ENDIF
.
          COMPARE   ONE,UPDDFLAG                 * updating database ?
          IF        !@EQUAL
            WRITE     TEXTFILE,SEQ;NUPDCAPT
            GOTO      PROC7000
          ENDIF
.
          MATCH     ANSP,MSH01101                * production message ?
          IF        !@EQUAL
            WRITE     TEXTFILE,SEQ;TESTCAPT
            GOTO      PROC7000
          ENDIF
.
          WRITE     TEXTFILE,SEQ;COMSCAPT
.
          MATCH     MTYPEO01,MESSTYPE            * R01 message ?
          IF        @EQUAL
            CALL      PO010000                   * yes - process message
            GOTO      PROC6900
          ENDIF
.
PROC6900  WRITE     TEXTFILE,SEQ;COMECAPT
PROC7000  IF        ERRORCNT = 0
            CALL      USST0000                   * update successful stats
          ELSE
            CALL      UFST0000                   * update failed/rejected stats
          ENDIF
.
.         Send the reply acknowledgement message
.
          CLOCK     TIME,CTIMEIS
          REP       " 0",CTIMEIS
          WRITE     TEXTFILE,SEQ;
          WRITE     TEXTFILE,SEQ;SENDCAPN,CTIMEIS
          IF        DISPFLAG = 1
            DISPLAY   "Sending Acknowledgement",*R,*N;
          ENDIF
          CALL      WMSH0000                     * format MSH segment
          BRANCH    EXIT,PROC9000:               * connection lost
                         PROC9600                * timeout
          WRITE     TEXTFILE,SEQ;
          WRITE     TEXTFILE,SEQ;MSHSCAPT
.
          CALL      WMSA0000                     * format MSA segment
          BRANCH    EXIT,PROC9000:               * connection lost
                         PROC9600                * timeout
          WRITE     TEXTFILE,SEQ;
          WRITE     TEXTFILE,SEQ;MSASCAPT
.
.         Finish sending message with an end of block character and carriage
.         return
.
          IF        DISPFLAG = 1
            DISPLAY   "Sending end of message [",*HON,ENDBLOCK,ASK:
                      *HOFF,"]:  (* = carriage return)",*R,*N;
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF SIGPIPE
          WRITE     COMSOCKT,2,1000;ENDBLOCK,CRETURN
          TRAPCLR   SIGPIPE
          GOTO      PROC9600 IF TIMEOUT          * timeout expired
          BRANCH    OVRCD,PROC9000               * connection lost
.
          GOTO      PROC0500                     * get next message
.
PROC9000  IF        DISPFLAG = 1
            DISPLAY   "Connection lost",*R,*N;
          ENDIF
          WRITE     TEXTFILE,SEQ;CONNCAPT
          GOTO      PROC9900
.
PROC9100  IF        DISPFLAG = 1
            DISPLAY   "Solicited Socket not set up",*R,*N;
          ENDIF
          GOTO      PROC9900
.
PROC9500  IF        DISPFLAG = 1
            DISPLAY   "Timeout waiting for incoming message",*R,*N;
          ENDIF
          WRITE     TEXTFILE,SEQ;ICOMCAPT
          GOTO      PROC0500
.
PROC9600  IF        DISPFLAG = 1
            DISPLAY   "Timeout waiting for outgoing message",*R,*N;
          ENDIF
          WRITE     TEXTFILE,SEQ;OUTGCAPT
          GOTO      PROC9900
.
PROC9700  IF        DISPFLAG = 1
            DISPLAY   "Error: port ",TCPIPORT," in use by another process":
                       *R,*N;
          ENDIF
          GOTO      PROC9999                                 
.
.         Close the communications socket and start again
.
PROC9900  CLOSE     COMSOCKT
          GOTO      PROC0100
.
PROC9999  RETURN
+
.*****************************************************************************
.*                          GTSTR000               Called by: PROC0000       *
.*                                                            GSEG0000       *
.*                                                            GCHR0000       *
.*        Read the next 4000 characters (or less) from the socket            *
.* Returns:   TMPSTRNG - buffer containing character string read in          *
.*            EXIT      0 = read ok                                          *
.*                      1 = timeout expired                                  *
.*                      2 = connection lost                                  *
.*****************************************************************************
.
GTSTR000  RECV      COMSOCKT,4000,30000;TMPSTRNG; * read first 4000 characters
          GOTO      GTSTR910 IF TIMEOUT          * timeout expired
          GOTO      GTSTR920 IF OVER             * connection lost
          IF        @LESS
.>>>>>>                                          * there are no more chars
.                                                  to be read
          ENDIF
.
.         Data received
.
          IF        DISPFLAG = 1
            STRIP     TMPSTRNG
            MOVE      ZERO,COUNTR
            MOVELPTR  TMPSTRNG,FORM4
            DISPLAY   "Received ",FORM4," bytes:  (* = carriage return)",*R,*N;
            WHILE     FORM4 > 0
              ADD       ONE,COUNTR
              MATCH     CRETURN,TMPSTRNG
              IF        @EQUAL
                MOVE      ASK,ANS
              ELSE
                MOVE      TMPSTRNG,ANS
              ENDIF
              IF        COUNTR = 1
                DISPLAY   "[";
              ENDIF
              DISPLAY   *HON,ANS,*HOFF;
              IF        COUNTR = 70
                DISPLAY   "]",*R,*N;
                MOVE      ZERO,COUNTR
              ENDIF
              SUB       ONE,FORM4
              BUMP      TMPSTRNG
            DO
            DISPLAY     "]",*R,*N;
            RESET       TMPSTRNG
          ENDIF
          CLOCK     TIME,TIMSTAMP                * get current date/time
          WRITE     TEXTFILE,SEQ;RECVCAPT,TIMSTAMP
          WRITE     TEXTFILE,SEQ;TMPSTRNG
.
          MOVE      ZERO,EXIT
          GOTO      GTSTR999
.
GTSTR910  MOVE      ONE,EXIT                     * timeout
          GOTO      GTSTR999
.
GTSTR920  MOVE      TWO,EXIT                     * connection lost
.
GTSTR999  RETURN
+
.*****************************************************************************
.*                              GDTM0000           Called by: WMSH0000       *
.*        Get the datetime the message is being sent                         *
.* Returns: DATETIME (ccyymmddhhmmss) - current date & time                  *
.*****************************************************************************
.
GDTM0000  OPEN      CONTROLF,"controlf"
          CALL      IBACLOCK
          UNPACK    CTIMEIS,HOURTM,ANS,MINTIME,ANS,SECTIME
          PACK      DATETIME,CCC,CYY,CMM,CDD,HOURTM,MINTIME,SECTIME
          REP       " 0",DATETIME
.
GDTM9999  RETURN
+
.*****************************************************************************
.*                                 LMSH0000        Called by: PROC0000       *
.*                          Load the MSH fields                              *
.*****************************************************************************
.
LMSH0000  BRANCH    FIELDNO,LMSH9999:            * Field Separator
                            LMSH0200:            * Encoding Characters
                            LMSH0300:            * Sending Application
                            LMSH0400:            * Sending Facility
                            LMSH0500:            * Receiving Application
                            LMSH0600:            * Receiving Facility
                            LMSH0700:            * Date/Time of Message
                            LMSH0800:            * Security
                            LMSH0900:            * Message Type
                            LMSH1000:            * Message Control ID
                            LMSH1100:            * Processing ID
                            LMSH1200:            * Version ID
                            LMSH1300:            * Sequence Number
                            LMSH1400:            * Continuation Pointer
                            LMSH1500:            * Accept Acknowledgement Type
                            LMSH1600:            * Appl. Acknowledgement Type
                            LMSH1700:            * Country Code
                            LMSH1800:            * Character Set
                            LMSH1900:            * Principal Language of Message
                            LMSH2000             * Alt. Char Set Hand Scheme
.
.         Invalid MSH field received, so ignore it
.
          GOTO      LMSH9999
.
. Note: MSH00101 is set in GCHR0000
.
.         MSH.2 Encoding Characters (ST)
.
LMSH0200  BRANCH    COMPCNT,LMSH0201
          GOTO      LMSH9999
.
LMSH0201  APPEND    ANS,MSH00201
          GOTO      LMSH9999
.
.         MSH.3 Sending Application (HD)
.
LMSH0300  BRANCH    COMPCNT,LMSH0301:            * namespace ID
                            LMSH0302:            * universal ID
                            LMSH0303             * universal ID type
          GOTO      LMSH9999
.
LMSH0301  APPEND    ANS,MSH00301                 * load namespace id (IS)
          GOTO      LMSH9999
.
LMSH0302  APPEND    ANS,MSH00302                 * load universal id (ST)
          GOTO      LMSH9999
.
LMSH0303  APPEND    ANS,MSH00303                 * load universal id type (ID)
          GOTO      LMSH9999
.
.         MSH.4 Sending Facility
.
LMSH0400  BRANCH    COMPCNT,LMSH0401:            * namespace ID
                            LMSH0402:            * universal ID
                            LMSH0403             * universal ID type
          GOTO      LMSH9999
.
LMSH0401  APPEND    ANS,MSH00401                 * load namespace id (IS)
          GOTO      LMSH9999
.
LMSH0402  APPEND    ANS,MSH00402                 * load universal id (ST)
          GOTO      LMSH9999
.
LMSH0403  APPEND    ANS,MSH00403                 * load universal id type (ID)
          GOTO      LMSH9999
.
.         MSH.5 Receiving Application
.
LMSH0500  BRANCH    COMPCNT,LMSH0501:            * namespace ID
                            LMSH0502:            * universal ID
                            LMSH0503             * universal ID type
          GOTO      LMSH9999
.
LMSH0501  APPEND    ANS,MSH00501                 * load namespace id (IS)
          GOTO      LMSH9999
.
LMSH0502  APPEND    ANS,MSH00502                 * load universal id (ST)
          GOTO      LMSH9999
.
LMSH0503  APPEND    ANS,MSH00503                 * load universal id type (ID)
          GOTO      LMSH9999
.
.         MSH.6 Receiving Facility
.
LMSH0600  BRANCH    COMPCNT,LMSH0601:            * namespace ID
                            LMSH0602:            * universal ID
                            LMSH0603             * universal ID type
          GOTO      LMSH9999
.
LMSH0601  APPEND    ANS,MSH00601                 * load namespace id (IS)
          GOTO      LMSH9999
.
LMSH0602  APPEND    ANS,MSH00602                 * load universal id (ST)
          GOTO      LMSH9999
.
LMSH0603  APPEND    ANS,MSH00603                 * load universal id type (ID)
          GOTO      LMSH9999
.
.         MSH.7 Date/Time of Message (TS)
.
LMSH0700  BRANCH    COMPCNT,LMSH0701
          GOTO      LMSH9999
.
LMSH0701  APPEND    ANS,MSH00701
          GOTO      LMSH9999
.
.         MSH.8 Security (ST)
.
LMSH0800  BRANCH    COMPCNT,LMSH0801
          GOTO      LMSH9999
.
LMSH0801  APPEND    ANS,MSH00801
          GOTO      LMSH9999
.
.         MSH.9 Message Type (CM)
.
LMSH0900  BRANCH    COMPCNT,LMSH0901:            * message type
                            LMSH0902:            * trigger event
                            LMSH0903             * message structure
          GOTO      LMSH9999
.         
LMSH0901  APPEND    ANS,MSH00901                 * load message type (ID)
          GOTO      LMSH9999
.         
LMSH0902  APPEND    ANS,MSH00902                 * load trigger event (ID)
          GOTO      LMSH9999
.
LMSH0903  APPEND    ANS,MSH00903                 * load message structure (ID)
          GOTO      LMSH9999
.
.         MSH.10 Message Control ID (ST)
.
LMSH1000  BRANCH    COMPCNT,LMSH1001
          GOTO      LMSH9999
.
LMSH1001  APPEND    ANS,MSH01001
          GOTO      LMSH9999
.
.         MSH.11 Processing ID (PT)
.
LMSH1100  BRANCH    COMPCNT,LMSH1101:            * processing id
                            LMSH1102             * processing mode
          GOTO      LMSH9999
.         
LMSH1101  APPEND    ANS,MSH01101                 * load processing id (ID)
          GOTO      LMSH9999
.         
LMSH1102  APPEND    ANS,MSH01102                 * load processing mode (ID)
          GOTO      LMSH9999
.
.         MSH.12 Version ID (VID)
.
LMSH1200  BRANCH    COMPCNT,LMSH1201:            * version ID
                            LMSH1202:            * internationalisation code
                            LMSH1203             * internal version ID
          GOTO      LMSH9999
.         
LMSH1201  APPEND    ANS,MSH01201                 * load version id (ID)
          GOTO      LMSH9999
.         
LMSH1202  APPEND    ANS,MSH01202                 * load intern'ln code (CE)
          GOTO      LMSH9999
.
LMSH1203  APPEND    ANS,MSH01203                 * load internal version id (CE)
          GOTO      LMSH9999
.
.         MSH.13 Sequence Number (NM)
.
LMSH1300  BRANCH    COMPCNT,LMSH1301
          GOTO      LMSH9999
.
LMSH1301  APPEND    ANS,MSH01301
          GOTO      LMSH9999
.
.         MSH.14 Continuation Pointer (ST)
.
LMSH1400  BRANCH    COMPCNT,LMSH1401
          GOTO      LMSH9999
.
LMSH1401  APPEND    ANS,MSH01401
          GOTO      LMSH9999
.
.         MSH.15 Accept Acknowledgement Type (ID)
.
LMSH1500  BRANCH    COMPCNT,LMSH1501
          GOTO      LMSH9999
.
LMSH1501  APPEND    ANS,MSH01501
          GOTO      LMSH9999
.
.         MSH.16 Application Acknowledgement Type (ID)
.
LMSH1600  BRANCH    COMPCNT,LMSH1601
          GOTO      LMSH9999
.
LMSH1601  APPEND    ANS,MSH01601
          GOTO      LMSH9999
.
.         MSH.17 Country Code (ID)
.
LMSH1700  BRANCH    COMPCNT,LMSH1701
          GOTO      LMSH9999
.
LMSH1701  APPEND    ANS,MSH01701
          GOTO      LMSH9999
.
.         MSH.18 Character Set (ID)
.
LMSH1800  BRANCH    COMPCNT,LMSH1801
          GOTO      LMSH9999
.
LMSH1801  APPEND    ANS,MSH01801
          GOTO      LMSH9999
.
.         MSH.19 Principal Language of Message (CE)
.
LMSH1900  BRANCH    COMPCNT,LMSH1901:            * identifier
                            LMSH1902:            * text
                            LMSH1903:            * name of coding system
                            LMSH1904:            * alternate identifier
                            LMSH1905:            * alternate text
                            LMSH1906             * name of alternate coding syst
          GOTO      LMSH9999
.         
LMSH1901  APPEND    ANS,MSH01901                 * load identifier (ID)
          GOTO      LMSH9999
.         
LMSH1902  APPEND    ANS,MSH01902                 * load text (ST)
          GOTO      LMSH9999
.
LMSH1903  APPEND    ANS,MSH01903                 * load name of cod. system (ST)
          GOTO      LMSH9999
.         
LMSH1904  APPEND    ANS,MSH01904                 * load alternate ident. (ID)
          GOTO      LMSH9999
.         
LMSH1905  APPEND    ANS,MSH01905                 * load aternate text (ST)
          GOTO      LMSH9999
.
LMSH1906  APPEND    ANS,MSH01906                 * load name alt cod system (ST)
          GOTO      LMSH9999
.
.         MSH.20 Alternate Character Set Handling (ID)
.
LMSH2000  BRANCH    COMPCNT,LMSH2001
          GOTO      LMSH9999
.
LMSH2001  APPEND    ANS,MSH02001
          GOTO      LMSH9999
.
LMSH9999  RETURN
+
.*****************************************************************************
.*                                 LPID0000        Called by: PROC0000       *
.*                          Load the PID fields                              *
.*****************************************************************************
.
LPID0000  BRANCH    FIELDNO,LPID0100:            * Set ID - Patient ID
                            LPID0200:            * Patient ID (External)
                            LPID0300:            * Patient ID (Internal)
                            LPID0400:            * Alternate Patient ID
                            LPID0500:            * Patient Name
                            LPID0600:            * Mother's Maiden name
                            LPID0700:            * Date/Time of Birth
                            LPID0800:            * Gender
                            LPID0900:            * Patient Alias
                            LPID1000:            * Race
                            LPID1100:            * Patient Address Information
                            LPID1200:            * County Code
                            LPID1300:            * Contact Information
                            LPID1400:            * Contact Information
                            LPID1500:            * Language Spoken
                            LPID1600:            * Marital Status
                            LPID1700:            * Religion
                            LPID1800:            * Patient Account Number
                            LPID1900:            * SSN Number - Patient
                            LPID2000:            * Driver's License No - Patient
                            LPID2100:            * Mother's Identifier
                            LPID2200:            * Ethnic Group
                            LPID2300:            * Place of Birth
                            LPID2400:            * Multiple Birth Indicator
                            LPID2500:            * Birth Order
                            LPID2600:            * Citizenship
                            LPID2700:            * Veterans Military Status
                            LPID2800:            * Nationality
                            LPID2900:            * Patient Death Date/Time
                            LPID3000             * Patient Death Indicator
.
.         Invalid PID field received, so ignore it
.
          GOTO      LPID9999
.
.         PID.1 Set ID (SI)
.
LPID0100  BRANCH    COMPCNT,LPID0101
          GOTO      LPID9999
.
LPID0101  APPEND    ANS,PID00101
          GOTO      LPID9999
.
.         PID.2 Patient ID (CX)
.
LPID0200  BRANCH    COMPCNT,LPID0201:            * id (ST)
                            LPID0202:            * check digit (ST)
                            LPID0203:            * check digit code scheme (ID)
                            LPID0204:            * assigning authority (HD)
                            LPID0205:            * identifier type code (IS)
                            LPID0206             * assigning facility (HD)
          GOTO      LPID9999
.
LPID0201  APPEND    ANS,PID00201                 * load id (ST)
          GOTO      LPID9999
.
LPID0202  APPEND    ANS,PID00202                 * load check digit (ST)
          GOTO      LPID9999
.
LPID0203  APPEND    ANS,PID00203                 * load check digit scheme (ID)
          GOTO      LPID9999
.
LPID0204  APPEND    ANS,PID00204                 * load assigning authority (HD)
          GOTO      LPID9999
.
LPID0205  APPEND    ANS,PID00205                 * load ident. type code (IS)
          GOTO      LPID9999
.
LPID0206  APPEND    ANS,PID00206                 * load assigning facility (HD)
          GOTO      LPID9999
.
.         PID.3 Patient Identifier List (CX)
.                 (maximum of 4 repeats - 5 identifiers in total)
.
LPID0300  COMPARE   REPTNCNT,FIVE                * maximum repeats reached ?
          GOTO      LPID9999 IF LESS             * yes
.
          BRANCH    COMPCNT,LPID0301:            * id (ST)
                            LPID0302:            * check digit (ST)
                            LPID0303:            * check digit code scheme (ID)
                            LPID0304:            * assigning authority (HD)
                            LPID0305:            * identifier type code (IS)
                            LPID0306             * assigning facility (HD)
          GOTO      LPID9999
.
LPID0301  APPEND    ANS,PID00301[REPTNCNT]       * load id (ST)
          GOTO      LPID9999
.
LPID0302  APPEND    ANS,PID00302[REPTNCNT]       * load check digit (ST)
          GOTO      LPID9999
.
LPID0303  APPEND    ANS,PID00303[REPTNCNT]       * load check digit scheme (ID)
          GOTO      LPID9999
.
LPID0304  APPEND    ANS,PID00304[REPTNCNT]       * load assigning authority (HD)
          GOTO      LPID9999
.
LPID0305  APPEND    ANS,PID00305[REPTNCNT]       * load ident. type code (IS)
          GOTO      LPID9999
.
LPID0306  APPEND    ANS,PID00306[REPTNCNT]       * load assigning facility (HD)
          GOTO      LPID9999
.
.         PID.4 Alternate Patient ID (CX)
.
LPID0400  BRANCH    COMPCNT,LPID0401:            * id (ST)
                            LPID0402:            * check digit (ST)
                            LPID0403:            * check digit code scheme (ID)
                            LPID0404:            * assigning authority (HD)
                            LPID0405:            * identifier type code (IS)
                            LPID0406             * assigning facility (HD)
          GOTO      LPID9999
.
LPID0401  APPEND    ANS,PID00401                 * load id (ST)
          GOTO      LPID9999
.
LPID0402  APPEND    ANS,PID00402                 * load check digit (ST)
          GOTO      LPID9999
.
LPID0403  APPEND    ANS,PID00403                 * load check digit scheme (ID)
          GOTO      LPID9999
.
LPID0404  APPEND    ANS,PID00404                 * load assigning authority (HD)
          GOTO      LPID9999
.
LPID0405  APPEND    ANS,PID00405                 * load ident. type code (IS)
          GOTO      LPID9999
.
LPID0406  APPEND    ANS,PID00406                 * load assigning facility (HD)
          GOTO      LPID9999
.
.         PID.5 Patient Name (XPN)
.
LPID0500  BRANCH    COMPCNT,LPID0501:            * family name (ST)
                            LPID0502:            * given name (ST)
                            LPID0503:            * middle name (ST)
                            LPID0504:            * suffix (ST)
                            LPID0505:            * prefix (ST)
                            LPID0506:            * degree (IS)
                            LPID0507:            * name type code (ID)
                            LPID0508             * name representation code (ID)
          GOTO      LPID9999
.
LPID0501  APPEND    ANS,PID00501                 * load family name (ST)
          GOTO      LPID9999
.
LPID0502  APPEND    ANS,PID00502                 * load given name (ST)
          GOTO      LPID9999
.
LPID0503  APPEND    ANS,PID00503                 * load middle name (ST)
          GOTO      LPID9999
.
LPID0504  APPEND    ANS,PID00504                 * load suffix (ST)
          GOTO      LPID9999
.
LPID0505  APPEND    ANS,PID00505                 * load prefix (ST)
          GOTO      LPID9999
.
LPID0506  APPEND    ANS,PID00506                 * load degree (IS)
          GOTO      LPID9999
.
LPID0507  APPEND    ANS,PID00507                 * load name type code (ID)
          GOTO      LPID9999
.
LPID0508  APPEND    ANS,PID00508                 * load name rep. code (ID)
          GOTO      LPID9999
.
.         PID.6 Mother's Maiden Name (XPN)
.
LPID0600  BRANCH    COMPCNT,LPID0601:            * family name (ST)
                            LPID0602:            * given name (ST)
                            LPID0603:            * middle name (ST)
                            LPID0604:            * suffix (ST)
                            LPID0605:            * prefix (ST)
                            LPID0606:            * degree (IS)
                            LPID0607:            * name type code (ID)
                            LPID0608             * name representation code (ID)
          GOTO      LPID9999
.
LPID0601  APPEND    ANS,PID00601                 * load family name (ST)
          GOTO      LPID9999
.
LPID0602  APPEND    ANS,PID00602                 * load given name (ST)
          GOTO      LPID9999
.
LPID0603  APPEND    ANS,PID00603                 * load middle name (ST)
          GOTO      LPID9999
.
LPID0604  APPEND    ANS,PID00604                 * load suffix (ST)
          GOTO      LPID9999
.
LPID0605  APPEND    ANS,PID00605                 * load prefix (ST)
          GOTO      LPID9999
.
LPID0606  APPEND    ANS,PID00606                 * load degree (IS)
          GOTO      LPID9999
.
LPID0607  APPEND    ANS,PID00607                 * load name type code (ID)
          GOTO      LPID9999
.
LPID0608  APPEND    ANS,PID00608                 * load name rep. code (ID)
          GOTO      LPID9999
.
.         PID.7 Date/Time for Birth (TS)
.
LPID0700  BRANCH    COMPCNT,LPID0701
          GOTO      LPID9999
.
LPID0701  APPEND    ANS,PID00701
          GOTO      LPID9999
.
.         PID.8 Sex (IS)
.
LPID0800  BRANCH    COMPCNT,LPID0801
          GOTO      LPID9999
.
LPID0801  APPEND    ANS,PID00801
          GOTO      LPID9999
.
.         PID.9 Patient Alias (XPN)
.                 (maximum of 79 repeats - 80 aliases in total)
.
LPID0900  COMPARE   REPTNCNT,EIGHTY              * maximum repeats reached ?
          GOTO      LPID9999 IF LESS             * yes
.
          BRANCH    COMPCNT,LPID0901:            * family name (ST)
                            LPID0902:            * given name (ST)
                            LPID0903:            * middle name (ST)
                            LPID0904:            * suffix (ST)
                            LPID0905:            * prefix (ST)
                            LPID0906:            * degree (IS)
                            LPID0907:            * name type code (ID)
                            LPID0908             * name representation code (ID)
          GOTO      LPID9999
.
LPID0901  APPEND    ANS,PID00901[REPTNCNT]       * load family name (ST)
          GOTO      LPID9999
.
LPID0902  APPEND    ANS,PID00902[REPTNCNT]       * load given name (ST)
          GOTO      LPID9999
.
LPID0903  APPEND    ANS,PID00903[REPTNCNT]       * load middle name (ST)
          GOTO      LPID9999
.
LPID0904  APPEND    ANS,PID00904[REPTNCNT]       * load suffix (ST)
          GOTO      LPID9999
.
LPID0905  APPEND    ANS,PID00905[REPTNCNT]       * load prefix (ST)
          GOTO      LPID9999
.
LPID0906  APPEND    ANS,PID00906[REPTNCNT]       * load degree (IS)
          GOTO      LPID9999
.
LPID0907  APPEND    ANS,PID00907[REPTNCNT]       * load name type code (ID)
          GOTO      LPID9999
.
LPID0908  APPEND    ANS,PID00908[REPTNCNT]       * load name rep. code (ID)
          GOTO      LPID9999
.
.         PID.10 Race (CE)
.
LPID1000  BRANCH    COMPCNT,LPID1001:            * identifier (ST)
                            LPID1002:            * text (ST)
                            LPID1003:            * name of coding system (ST)
                            LPID1004:            * alternate identifier (ST)
                            LPID1005:            * alternate text (ST)
                            LPID1006             * name alt. coding system (ST)
          GOTO      LPID9999
.
LPID1001  APPEND    ANS,PID01001                 * load identifier (ST)
          GOTO      LPID9999
.
LPID1002  APPEND    ANS,PID01002                 * load text (ST)
          GOTO      LPID9999
.
LPID1003  APPEND    ANS,PID01003                 * load name coding system (ST)
          GOTO      LPID9999
.
LPID1004  APPEND    ANS,PID01004                 * load alt. identifier (ST)
          GOTO      LPID9999
.
LPID1005  APPEND    ANS,PID01005                 * load alternate text (ST)
          GOTO      LPID9999
.
LPID1006  APPEND    ANS,PID01006                 * load name alt. cod. sys (HD)
          GOTO      LPID9999
.
.         PID.11 Patient Address (XAD)
.                (maximum of 1 repeat - 2 addresses in total)
.
LPID1100  COMPARE   REPTNCNT,TWO                 * maximum repeats reached ?
          GOTO      LPID9999 IF LESS             * yes
.
          BRANCH    COMPCNT,LPID1101:            * street address (ST)
                            LPID1102:            * other designation (ST)
                            LPID1103:            * city (ST)
                            LPID1104:            * state (ST)
                            LPID1105:            * postcode (ST)
                            LPID1106:            * country (ID)
                            LPID1107:            * address type (ID)
                            LPID1108:            * other geographic desig. (ST)
                            LPID1109:            * county (IS)
                            LPID1110:            * census tract (IS)
                            LPID1111             * address rep. code (ID)
          GOTO      LPID9999
.
LPID1101  APPEND    ANS,PID01101[REPTNCNT]       * load street address (ST)
          GOTO      LPID9999
.
LPID1102  APPEND    ANS,PID01102[REPTNCNT]       * load other designation (ST)
          GOTO      LPID9999
.
LPID1103  APPEND    ANS,PID01103[REPTNCNT]       * load city (ST)
          GOTO      LPID9999
.
LPID1104  APPEND    ANS,PID01104[REPTNCNT]       * load state (ST)
          GOTO      LPID9999
.
LPID1105  APPEND    ANS,PID01105[REPTNCNT]       * load postcode (ST)
          GOTO      LPID9999
.
LPID1106  APPEND    ANS,PID01106[REPTNCNT]       * load country (ID)
          GOTO      LPID9999
.
LPID1107  APPEND    ANS,PID01107[REPTNCNT]       * load address type (ID)
          GOTO      LPID9999
.
LPID1108  APPEND    ANS,PID01108[REPTNCNT]       * load other geog. desig. (ST)
          GOTO      LPID9999
.
LPID1109  APPEND    ANS,PID01109[REPTNCNT]       * load county (IS)
          GOTO      LPID9999
.
LPID1110  APPEND    ANS,PID01110[REPTNCNT]       * load census tract (IS)
          GOTO      LPID9999
.
LPID1111  APPEND    ANS,PID01111[REPTNCNT]       * load address rep code (ID)
          GOTO      LPID9999
.
.         PID.12 County Code (IS)
.
LPID1200  BRANCH    COMPCNT,LPID1201
          GOTO      LPID9999
.
LPID1201  APPEND    ANS,PID01201                 * load county code
          GOTO      LPID9999
.
.         PID.13 Phone Number - Home (XTN)
.                (maximum of 1 repeat - 2 phone numbers in total)
.
LPID1300  COMPARE   REPTNCNT,TWO                 * maximum repeats reached ?
          GOTO      LPID9999 IF LESS             * yes
.
          BRANCH    COMPCNT,LPID1301:            * text
                            LPID1302:            * telecomm. use code (ID)
                            LPID1303:            * telcomm. equipment type (ID)
                            LPID1304:            * email address (ST)
                            LPID1305:            * country code (NM)
                            LPID1306:            * area/city code (NM)
                            LPID1307:            * phone number (NM)
                            LPID1308:            * extension (NM)
                            LPID1309             * any text (ST)
          GOTO      LPID9999
.
LPID1301  APPEND    ANS,PID01301[REPTNCNT]       * load text
          GOTO      LPID9999
.
LPID1302  APPEND    ANS,PID01302[REPTNCNT]       * load telecomm. use code (ID)
          GOTO      LPID9999
.
LPID1303  APPEND    ANS,PID01303[REPTNCNT]       * load telcomm. equip.type (ID)
          GOTO      LPID9999
.
LPID1304  APPEND    ANS,PID01304[REPTNCNT]       * load email address (ST)
          GOTO      LPID9999
.
LPID1305  APPEND    ANS,PID01305[REPTNCNT]       * load country code (NM)
          GOTO      LPID9999
.
LPID1306  APPEND    ANS,PID01306[REPTNCNT]       * load area/city code (NM)
          GOTO      LPID9999
.
LPID1307  APPEND    ANS,PID01307[REPTNCNT]       * load phone number (NM)
          GOTO      LPID9999
.
LPID1308  APPEND    ANS,PID01308[REPTNCNT]       * load extension (NM)
          GOTO      LPID9999
.
LPID1309  APPEND    ANS,PID01309[REPTNCNT]       * load any text (ST)
          GOTO      LPID9999
.
.         PID.14 Phone Number - Business (XTN)
.                (maximum of 1 repeat - 2 phone numbers in total)
.
LPID1400  COMPARE   REPTNCNT,TWO                 * maximum repeats reached ?
          GOTO      LPID9999 IF LESS             * yes
.
          BRANCH    COMPCNT,LPID1401:            * text
                            LPID1402:            * telecomm. use code (ID)
                            LPID1403:            * telcomm. equipment type (ID)
                            LPID1404:            * email address (ST)
                            LPID1405:            * country code (NM)
                            LPID1406:            * area/city code (NM)
                            LPID1407:            * phone number (NM)
                            LPID1408:            * extension (NM)
                            LPID1409             * any text (ST)
          GOTO      LPID9999
.
LPID1401  APPEND    ANS,PID01401[REPTNCNT]       * load text
          GOTO      LPID9999
.
LPID1402  APPEND    ANS,PID01402[REPTNCNT]       * load telecomm. use code (ID)
          GOTO      LPID9999
.
LPID1403  APPEND    ANS,PID01403[REPTNCNT]       * load telcomm. equip.type (ID)
          GOTO      LPID9999
.
LPID1404  APPEND    ANS,PID01404[REPTNCNT]       * load email address (ST)
          GOTO      LPID9999
.
LPID1405  APPEND    ANS,PID01405[REPTNCNT]       * load country code (NM)
          GOTO      LPID9999
.
LPID1406  APPEND    ANS,PID01406[REPTNCNT]       * load area/city code (NM)
          GOTO      LPID9999
.
LPID1407  APPEND    ANS,PID01407[REPTNCNT]       * load phone number (NM)
          GOTO      LPID9999
.
LPID1408  APPEND    ANS,PID01408[REPTNCNT]       * load extension (NM)
          GOTO      LPID9999
.
LPID1409  APPEND    ANS,PID01409[REPTNCNT]       * load any text (ST)
          GOTO      LPID9999
.
.         PID.15 Primary Language (CE)
.
LPID1500  BRANCH    COMPCNT,LPID1501:            * identifier (ST)
                            LPID1502:            * text (ST)
                            LPID1503:            * name of coding system (ST)
                            LPID1504:            * alternate identifier (ST)
                            LPID1505:            * alternate text (ST)
                            LPID1506             * name of alt. coding sys. (ST)
          GOTO      LPID9999
.
LPID1501  APPEND    ANS,PID01501                 * load identifier (ST)
          GOTO      LPID9999
.
LPID1502  APPEND    ANS,PID01502                 * load text (ST)
          GOTO      LPID9999
.
LPID1503  APPEND    ANS,PID01503                 * load name of coding sys. (ST)
          GOTO      LPID9999
.
LPID1504  APPEND    ANS,PID01504                 * load alt. identifier (ST)
          GOTO      LPID9999
.
LPID1505  APPEND    ANS,PID01505                 * load alternate text (ST)
          GOTO      LPID9999
.
LPID1506  APPEND    ANS,PID01506                 * load name alt. cod. sys. (ST)
          GOTO      LPID9999
.
.         PID.16 Marital Status (CE)
.
LPID1600  BRANCH    COMPCNT,LPID1601:            * identifier (ST)
                            LPID1602:            * text (ST)
                            LPID1603:            * name of coding system (ST)
                            LPID1604:            * alternate identifier (ST)
                            LPID1605:            * alternate text (ST)
                            LPID1606             * name of alt. coding sys. (ST)
          GOTO      LPID9999
.
LPID1601  APPEND    ANS,PID01601                 * load identifier (ST)
          GOTO      LPID9999
.
LPID1602  APPEND    ANS,PID01602                 * load text (ST)
          GOTO      LPID9999
.
LPID1603  APPEND    ANS,PID01603                 * load name of coding sys. (ST)
          GOTO      LPID9999
.
LPID1604  APPEND    ANS,PID01604                 * load alt. identifier (ST)
          GOTO      LPID9999
.
LPID1605  APPEND    ANS,PID01605                 * load alternate text (ST)
          GOTO      LPID9999
.
LPID1606  APPEND    ANS,PID01606                 * load name alt. cod. sys. (ST)
          GOTO      LPID9999
.
.         PID.17 Religion (CE)
.
LPID1700  BRANCH    COMPCNT,LPID1701:            * identifier (ST)
                            LPID1702:            * text (ST)
                            LPID1703:            * name of coding system (ST)
                            LPID1704:            * alternate identifier (ST)
                            LPID1705:            * alternate text (ST)
                            LPID1706             * name of alt. coding sys. (ST)
          GOTO      LPID9999
.
LPID1701  APPEND    ANS,PID01701                 * load identifier (ST)
          GOTO      LPID9999
.
LPID1702  APPEND    ANS,PID01702                 * load text (ST)
          GOTO      LPID9999
.
LPID1703  APPEND    ANS,PID01703                 * load name of coding sys. (ST)
          GOTO      LPID9999
.
LPID1704  APPEND    ANS,PID01704                 * load alt. identifier (ST)
          GOTO      LPID9999
.
LPID1705  APPEND    ANS,PID01705                 * load alternate text (ST)
          GOTO      LPID9999
.
LPID1706  APPEND    ANS,PID01706                 * load name alt. cod. sys. (ST)
          GOTO      LPID9999
.
.         PID.18 Patient Account Number (CX)
.
LPID1800  BRANCH    COMPCNT,LPID1801:            * id (ST)
                            LPID1802:            * check digit (ST)
                            LPID1803:            * code ident. chk dig, sch (ID)
                            LPID1804:            * assigning authority (HD)
                            LPID1805:            * identifier type code (IS)
                            LPID1806             * assigning facility (HD)
          GOTO      LPID9999
.
LPID1801  APPEND    ANS,PID01801                 * load id (ST)
          GOTO      LPID9999
.
LPID1802  APPEND    ANS,PID01802                 * load check digit (ST)
          GOTO      LPID9999
.
LPID1803  APPEND    ANS,PID01803                 * load code ident chk dig (ID)
          GOTO      LPID9999
.
LPID1804  APPEND    ANS,PID01804                 * load assigning authority (HD)
          GOTO      LPID9999
.
LPID1805  APPEND    ANS,PID01805                 * load ident. type code (IS)
          GOTO      LPID9999
.
LPID1806  APPEND    ANS,PID01806                 * load assigning facility (HD)
          GOTO      LPID9999
.
.         PID.19 SSN Number - Patient (ST)
.
LPID1900  BRANCH    COMPCNT,LPID1901
          GOTO      LPID9999
.
LPID1901  APPEND    ANS,PID01901                 * load SSN number - patient
          GOTO      LPID9999
.
.         PID.20 Driver's License Number - Patient (DLN)
.
LPID2000  BRANCH    COMPCNT,LPID2001:            * license number (ST)
                            LPID2002:            * issuing state (IS)
                            LPID2003             * expiration date (DT)
          GOTO      LPID9999
.
LPID2001  APPEND    ANS,PID02001                 * load license number (ST)
          GOTO      LPID9999
.
LPID2002  APPEND    ANS,PID02002                 * load issuing state (IS)
          GOTO      LPID9999
.
LPID2003  APPEND    ANS,PID02003                 * load expiration date (DT)
          GOTO      LPID9999
.
.         PID.21 Mother's Identifier (CX)
.
LPID2100  BRANCH    COMPCNT,LPID2101:            * id (ST)
                            LPID2102:            * check digit (ST)
                            LPID2103:            * code ident. chk dig, sch (ID)
                            LPID2104:            * assigning authority (HD)
                            LPID2105:            * identifier type code (IS)
                            LPID2106             * assigning facility (HD)
          GOTO      LPID9999
.
LPID2101  APPEND    ANS,PID02101                 * load id (ST)
          GOTO      LPID9999
.
LPID2102  APPEND    ANS,PID02102                 * load check digit (ST)
          GOTO      LPID9999
.
LPID2103  APPEND    ANS,PID02103                 * load code ident chk dig (ID)
          GOTO      LPID9999
.
LPID2104  APPEND    ANS,PID02104                 * load assigning authority (HD)
          GOTO      LPID9999
.
LPID2105  APPEND    ANS,PID02105                 * load ident. type code (IS)
          GOTO      LPID9999
.
LPID2106  APPEND    ANS,PID02106                 * load assigning facility (HD)
          GOTO      LPID9999
.
.         PID.22 Ethnic Group (CE)
.
LPID2200  BRANCH    COMPCNT,LPID2201:            * identifier (ST)
                            LPID2202:            * text (ST)
                            LPID2203:            * name of coding system (ST)
                            LPID2204:            * alternate identifier (ST)
                            LPID2205:            * alternate text (ST)
                            LPID2206             * name of alt. coding sys. (ST)
          GOTO      LPID9999
.
LPID2201  APPEND    ANS,PID02201                 * load identifier (ST)
          GOTO      LPID9999
.
LPID2202  APPEND    ANS,PID02202                 * load text (ST)
          GOTO      LPID9999
.
LPID2203  APPEND    ANS,PID02203                 * load name of coding sys. (ST)
          GOTO      LPID9999
.
LPID2204  APPEND    ANS,PID02204                 * load alt. identifier (ST)
          GOTO      LPID9999
.
LPID2205  APPEND    ANS,PID02205                 * load alternate text (ST)
          GOTO      LPID9999
.
LPID2206  APPEND    ANS,PID02206                 * load name alt. cod. sys. (ST)
          GOTO      LPID9999
.
.         PID.23 Birth Place (ST)
.
LPID2300  BRANCH    COMPCNT,LPID2301
          GOTO      LPID9999
.
LPID2301  APPEND    ANS,PID02301                 * load place of birth
          GOTO      LPID9999
.
.         PID.24 Multiple Birth Indicator (ID)
.
LPID2400  BRANCH    COMPCNT,LPID2401
          GOTO      LPID9999
.
LPID2401  APPEND    ANS,PID02401                 * load multiple birth indicator
          GOTO      LPID9999
.
.         PID.25 Birth Order (NM)
.
LPID2500  BRANCH    COMPCNT,LPID2501
          GOTO      LPID9999
.
LPID2501  APPEND    ANS,PID02501                 * load birth order
          GOTO      LPID9999
.
.         PID.26 Citizenship (CE)
.
LPID2600  BRANCH    COMPCNT,LPID2601:            * identifier (ST)
                            LPID2602:            * text (ST)
                            LPID2603:            * name of coding system (ST)
                            LPID2604:            * alternate identifier (ST)
                            LPID2605:            * alternate text (ST)
                            LPID2606             * name of alt. coding sys. (ST)
          GOTO      LPID9999
.
LPID2601  APPEND    ANS,PID02601                 * load identifier (ST)
          GOTO      LPID9999
.
LPID2602  APPEND    ANS,PID02602                 * load text (ST)
          GOTO      LPID9999
.
LPID2603  APPEND    ANS,PID02603                 * load name of coding sys. (ST)
          GOTO      LPID9999
.
LPID2604  APPEND    ANS,PID02604                 * load alt. identifier (ST)
          GOTO      LPID9999
.
LPID2605  APPEND    ANS,PID02605                 * load alternate text (ST)
          GOTO      LPID9999
.
LPID2606  APPEND    ANS,PID02606                 * load name alt. cod. sys. (ST)
          GOTO      LPID9999
.
.         PID.27 Veterans Military Status (CE)
.
LPID2700  BRANCH    COMPCNT,LPID2701:            * identifier (ST)
                            LPID2702:            * text (ST)
                            LPID2703:            * name of coding system (ST)
                            LPID2704:            * alternate identifier (ST)
                            LPID2705:            * alternate text (ST)
                            LPID2706             * name of alt. coding sys. (ST)
          GOTO      LPID9999
.
LPID2701  APPEND    ANS,PID02701                 * load identifier (ST)
          GOTO      LPID9999
.
LPID2702  APPEND    ANS,PID02702                 * load text (ST)
          GOTO      LPID9999
.
LPID2703  APPEND    ANS,PID02703                 * load name of coding sys. (ST)
          GOTO      LPID9999
.
LPID2704  APPEND    ANS,PID02704                 * load alt. identifier (ST)
          GOTO      LPID9999
.
LPID2705  APPEND    ANS,PID02705                 * load alternate text (ST)
          GOTO      LPID9999
.
LPID2706  APPEND    ANS,PID02706                 * load name alt. cod. sys. (ST)
          GOTO      LPID9999
.
.         PID.28 Nationality (CE)
.
LPID2800  BRANCH    COMPCNT,LPID2801:            * identifier (ST)
                            LPID2802:            * text (ST)
                            LPID2803:            * name of coding system (ST)
                            LPID2804:            * alternate identifier (ST)
                            LPID2805:            * alternate text (ST)
                            LPID2806             * name of alt. coding sys. (ST)
          GOTO      LPID9999
.
LPID2801  APPEND    ANS,PID02801                 * load identifier (ST)
          GOTO      LPID9999
.
LPID2802  APPEND    ANS,PID02802                 * load text (ST)
          GOTO      LPID9999
.
LPID2803  APPEND    ANS,PID02803                 * load name of coding sys. (ST)
          GOTO      LPID9999
.
LPID2804  APPEND    ANS,PID02804                 * load alt. identifier (ST)
          GOTO      LPID9999
.
LPID2805  APPEND    ANS,PID02805                 * load alternate text (ST)
          GOTO      LPID9999
.
LPID2806  APPEND    ANS,PID02806                 * load name alt. cod. sys. (ST)
          GOTO      LPID9999
.
.         PID.29 Patient Death Date and Time (TS)
.
LPID2900  BRANCH    COMPCNT,LPID2901
          GOTO      LPID9999
.
LPID2901  APPEND    ANS,PID02901                 * load patient death date/time
          GOTO      LPID9999
.
.         PID.30 Patient Death Indicator (ID)
.
LPID3000  BRANCH    COMPCNT,LPID3001
          GOTO      LPID9999
.
LPID3001  APPEND    ANS,PID03001                 * load patient death indicator
          GOTO      LPID9999
.
LPID9999  RETURN
+
.*****************************************************************************
.*                                 LPV10000        Called by: PROC0000       *
.*                          Load the PV1 fields                              *
.*****************************************************************************
.
LPV10000  BRANCH    FIELDNO,LPV10100:            * Set ID
                            LPV10200:            * Patient Class
                            LPV10300:            * Assigned Pt. Location
                            LPV10400:            * Admission Type
                            LPV10500:            * Preadmit No.
                            LPV10600:            * Prior Pt. Location
                            LPV10700:            * Attending Doctor
                            LPV10800:            * Referring Doctor
                            LPV10900:            * Consulting Doctor
                            LPV11000:            * Hospital Service
                            LPV11100:            * Temporary Location
                            LPV11200:            * Preadmit Test Indicator
                            LPV11300:            * Readmission Indicator
                            LPV11400:            * Admit Source
                            LPV11500:            * Ambulatory Status
                            LPV11600:            * VIP Indicator
                            LPV11700:            * Admitting Doctor
                            LPV11800:            * Patient Type
                            LPV11900:            * Visit Number
                            LPV12000:            * Financial Class
                            LPV12100:            * Charge Price Indicator
                            LPV12200:            * Courtesy Code
                            LPV12300:            * Credit Rating
                            LPV12400:            * Contract Code
                            LPV12500:            * Contract Effective Date
                            LPV12600:            * Contract Amount
                            LPV12700:            * Contract Period
                            LPV12800:            * Interest Code
                            LPV12900:            * Transfer to Bad Debt Code
                            LPV13000:            * Transfer to Bad Debt Date
                            LPV13100:            * Bad Debt Agency Code
                            LPV13200:            * Bad Debt Transfer Amount
                            LPV13300:            * Bad Debt recovery Amount
                            LPV13400:            * Delete Account Indicator
                            LPV13500:            * Delete Account Date
                            LPV13600:            * Discharge Disposition
                            LPV13700:            * Discharged to Location
                            LPV13800:            * Diet Type
                            LPV13900:            * Servicing Facility
                            LPV14000:            * Bed Status
                            LPV14100:            * Account Status
                            LPV14200:            * Pending Location
                            LPV14300:            * Prior Temporary Location
                            LPV14400:            * Admit Date/Time
                            LPV14500:            * Discharge Date/Time
                            LPV14600:            * Current Patient Balance
                            LPV14700:            * Total Charges
                            LPV14800:            * Total Adjustments
                            LPV14900:            * Total Payments
                            LPV15000:            * Alternate Visit Id
                            LPV15100:            * Visit Indicator
                            LPV15200             * Other Healthcare Provider
.
.         Invalid PV1 field received, so ignore it
.
          GOTO      LPV19999
.                           
.         PV1.1 Set ID (SI)
.                           
LPV10100  BRANCH    COMPCNT,LPV10101
          GOTO      LPV19999
.                           
LPV10101  APPEND    ANS,PV100101
          GOTO      LPV19999
.                           
.         PV1.2 Patient Class (IS)
.                           
LPV10200  BRANCH    COMPCNT,LPV10201
          GOTO      LPV19999
.                           
LPV10201  APPEND    ANS,PV100201
          GOTO      LPV19999
.                           
.         PV1.3 Assigned Patient Location (PL)
.                           
LPV10300  BRANCH    COMPCNT,LPV10301:            * point of care (IS)
                            LPV10302:            * room (IS)
                            LPV10303:            * bed (IS)
                            LPV10304:            * facility (HD)
                            LPV10305:            * location status (IS)
                            LPV10306:            * person location type (IS)
                            LPV10307:            * building (IS)
                            LPV10308:            * floor (IS)
                            LPV10309             * location description (ST)
          GOTO      LPV19999
.                           
LPV10301  APPEND    ANS,PV100301                 * load point of care (IS)
          GOTO      LPV19999
.                           
LPV10302  APPEND    ANS,PV100302                 * load room (IS)
          GOTO      LPV19999
.                           
LPV10303  APPEND    ANS,PV100303                 * load bed (IS)
          GOTO      LPV19999
.                           
LPV10304  APPEND    ANS,PV100304                 * load facility (HD)
          GOTO      LPV19999
.                           
LPV10305  APPEND    ANS,PV100305                 * load location status (IS)
          GOTO      LPV19999
.                           
LPV10306  APPEND    ANS,PV100306                 * load person locat. type (IS)
          GOTO      LPV19999
.                           
LPV10307  APPEND    ANS,PV100307                 * load building (IS)
          GOTO      LPV19999
.                           
LPV10308  APPEND    ANS,PV100308                 * load floor (IS)
          GOTO      LPV19999
.                           
LPV10309  APPEND    ANS,PV100309                 * load locat. description (ST)
          GOTO      LPV19999
.                           
.         PV1.4 Admission Type (IS)
.                           
LPV10400  BRANCH    COMPCNT,LPV10401
          GOTO      LPV19999
.                           
LPV10401  APPEND    ANS,PV100401
          GOTO      LPV19999
.                           
.         PV1.5 Preadmit Number (CX)
.                           
LPV10500  BRANCH    COMPCNT,LPV10501:            * id (ST)
                            LPV10502:            * check digit (ST)
                            LPV10503:            * check digit scheme code (ID)
                            LPV10504:            * assigning authority (HD)
                            LPV10505:            * identifier type code (IS)
                            LPV10506             * assigning facility (HD)
          GOTO      LPV19999
.                           
LPV10501  APPEND    ANS,PV100501                 * load id (ST)
          GOTO      LPV19999
.                           
LPV10502  APPEND    ANS,PV100502                 * load check digit (ST)
          GOTO      LPV19999
.                           
LPV10503  APPEND    ANS,PV100503                 * load chk dig scheme code (ID)
          GOTO      LPV19999
.                           
LPV10504  APPEND    ANS,PV100504                 * load assigning authority (HD)
          GOTO      LPV19999
.                           
LPV10505  APPEND    ANS,PV100505                 * load identifier typ code (IS)
          GOTO      LPV19999
.                           
LPV10506  APPEND    ANS,PV100506                 * load assigning facility (HD)
          GOTO      LPV19999
.                           
.         PV1.6 Prior Patient Location (PL)
.                           
LPV10600  BRANCH    COMPCNT,LPV10601:            * point of care (IS)
                            LPV10602:            * room (IS)
                            LPV10603:            * bed (IS)
                            LPV10604:            * facility (HD)
                            LPV10605:            * location status (IS)
                            LPV10606:            * person location type (IS)
                            LPV10607:            * building (IS)
                            LPV10608:            * floor (IS)
                            LPV10609             * location description (ST)
          GOTO      LPV19999
.                           
LPV10601  APPEND    ANS,PV100601                 * load point of care (IS)
          GOTO      LPV19999
.                           
LPV10602  APPEND    ANS,PV100602                 * load room (IS)
          GOTO      LPV19999
.                           
LPV10603  APPEND    ANS,PV100603                 * load bed (IS)
          GOTO      LPV19999
.                           
LPV10604  APPEND    ANS,PV100604                 * load facility (HD)
          GOTO      LPV19999
.                           
LPV10605  APPEND    ANS,PV100605                 * load location status (IS)
          GOTO      LPV19999
.                           
LPV10606  APPEND    ANS,PV100606                 * load person locat. type (IS)
          GOTO      LPV19999
.                           
LPV10607  APPEND    ANS,PV100607                 * load building (IS)
          GOTO      LPV19999
.                           
LPV10608  APPEND    ANS,PV100608                 * load floor (IS)
          GOTO      LPV19999
.                           
LPV10609  APPEND    ANS,PV100609                 * load locat. description (ST)
          GOTO      LPV19999
.                           
.         PV1.7 Attending Doctor (XCN)
.                           
LPV10700  BRANCH    COMPCNT,LPV10701:            * id number (ST)
                            LPV10702:            * family name (ST)
                            LPV10703:            * given name (ST)
                            LPV10704:            * middle name (ST)
                            LPV10705:            * suffix (ST)
                            LPV10706:            * prefix (ST)
                            LPV10707:            * degree (IS)
                            LPV10708:            * source table (IS)
                            LPV10709:            * assigning authority (HD)
                            LPV10710:            * name type code (ID)
                            LPV10711:            * identifier check digit (ST)
                            LPV10712:            * check digit scheme code (ID)
                            LPV10713:            * identifier type code (IS)
                            LPV10714:            * assigning facility (HD)
                            LPV10715             * name representation code (ID)
          GOTO      LPV19999
.                           
LPV10701  APPEND    ANS,PV100701                 * load id number (ST)
          GOTO      LPV19999
.                           
LPV10702  APPEND    ANS,PV100702                 * load family name (ST)
          GOTO      LPV19999
.                           
LPV10703  APPEND    ANS,PV100703                 * load given name (ST)
          GOTO      LPV19999
.                           
LPV10704  APPEND    ANS,PV100704                 * load middle name (ST)
          GOTO      LPV19999
.                           
LPV10705  APPEND    ANS,PV100705                 * load suffix (ST)
          GOTO      LPV19999
.                           
LPV10706  APPEND    ANS,PV100706                 * load prefix (ST)
          GOTO      LPV19999
.                           
LPV10707  APPEND    ANS,PV100707                 * load degree (IS)
          GOTO      LPV19999
.                           
LPV10708  APPEND    ANS,PV100708                 * load source table (IS)
          GOTO      LPV19999
.                           
LPV10709  APPEND    ANS,PV100709                 * load assigning authority (HD)
          GOTO      LPV19999
.                           
LPV10710  APPEND    ANS,PV100710                 * load name type code (ID)
          GOTO      LPV19999
.                           
LPV10711  APPEND    ANS,PV100711                 * load ident. check digit (ST)
          GOTO      LPV19999
.                           
LPV10712  APPEND    ANS,PV100712                 * load chk dig scheme code (ID)
          GOTO      LPV19999
.                           
LPV10713  APPEND    ANS,PV100713                 * load ident. type code (IS)
          GOTO      LPV19999
.                           
LPV10714  APPEND    ANS,PV100714                 * load assigning facility (HD)
          GOTO      LPV19999
.                           
LPV10715  APPEND    ANS,PV100715                 * load name repres. code (ID)
          GOTO      LPV19999
.                           
.         PV1.8 Referring Doctor (XCN)
.                           
LPV10800  BRANCH    COMPCNT,LPV10801:            * id number (ST)
                            LPV10802:            * family name (ST)
                            LPV10803:            * given name (ST)
                            LPV10804:            * middle name (ST)
                            LPV10805:            * suffix (ST)
                            LPV10806:            * prefix (ST)
                            LPV10807:            * degree (IS)
                            LPV10808:            * source table (IS)
                            LPV10809:            * assigning authority (HD)
                            LPV10810:            * name type code (ID)
                            LPV10811:            * identifier check digit (ST)
                            LPV10812:            * check digit scheme code (ID)
                            LPV10813:            * identifier type code (IS)
                            LPV10814:            * assigning facility (HD)
                            LPV10815             * name representation code (ID)
          GOTO      LPV19999
.                           
LPV10801  APPEND    ANS,PV100801                 * load id number (ST)
          GOTO      LPV19999
.                           
LPV10802  APPEND    ANS,PV100802                 * load family name (ST)
          GOTO      LPV19999
.                           
LPV10803  APPEND    ANS,PV100803                 * load given name (ST)
          GOTO      LPV19999
.                           
LPV10804  APPEND    ANS,PV100804                 * load middle name (ST)
          GOTO      LPV19999
.                           
LPV10805  APPEND    ANS,PV100805                 * load suffix (ST)
          GOTO      LPV19999
.                           
LPV10806  APPEND    ANS,PV100806                 * load prefix (ST)
          GOTO      LPV19999
.                           
LPV10807  APPEND    ANS,PV100807                 * load degree (IS)
          GOTO      LPV19999
.                           
LPV10808  APPEND    ANS,PV100808                 * load source table (IS)
          GOTO      LPV19999
.                           
LPV10809  APPEND    ANS,PV100809                 * load assigning authority (HD)
          GOTO      LPV19999
.                           
LPV10810  APPEND    ANS,PV100810                 * load name type code (ID)
          GOTO      LPV19999
.                           
LPV10811  APPEND    ANS,PV100811                 * load ident. check digit (ST)
          GOTO      LPV19999
.                           
LPV10812  APPEND    ANS,PV100812                 * load chk dig scheme code (ID)
          GOTO      LPV19999
.                           
LPV10813  APPEND    ANS,PV100813                 * load ident. type code (IS)
          GOTO      LPV19999
.                           
LPV10814  APPEND    ANS,PV100814                 * load assigning facility (HD)
          GOTO      LPV19999
.                           
LPV10815  APPEND    ANS,PV100815                 * load name repres. code (ID)
          GOTO      LPV19999
.                           
.         PV1.9 Consulting Doctor (XCN)
.                           
LPV10900  BRANCH    COMPCNT,LPV10901:            * id number (ST)
                            LPV10902:            * family name (ST)
                            LPV10903:            * given name (ST)
                            LPV10904:            * middle name (ST)
                            LPV10905:            * suffix (ST)
                            LPV10906:            * prefix (ST)
                            LPV10907:            * degree (IS)
                            LPV10908:            * source table (IS)
                            LPV10909:            * assigning authority (HD)
                            LPV10910:            * name type code (ID)
                            LPV10911:            * identifier check digit (ST)
                            LPV10912:            * check digit scheme code (ID)
                            LPV10913:            * identifier type code (IS)
                            LPV10914:            * assigning facility (HD)
                            LPV10915             * name representation code (ID)
          GOTO      LPV19999
.                           
LPV10901  APPEND    ANS,PV100901                 * load id number (ST)
          GOTO      LPV19999
.                           
LPV10902  APPEND    ANS,PV100902                 * load family name (ST)
          GOTO      LPV19999
.                           
LPV10903  APPEND    ANS,PV100903                 * load given name (ST)
          GOTO      LPV19999
.                           
LPV10904  APPEND    ANS,PV100904                 * load middle name (ST)
          GOTO      LPV19999
.                           
LPV10905  APPEND    ANS,PV100905                 * load suffix (ST)
          GOTO      LPV19999
.                           
LPV10906  APPEND    ANS,PV100906                 * load prefix (ST)
          GOTO      LPV19999
.                           
LPV10907  APPEND    ANS,PV100907                 * load degree (IS)
          GOTO      LPV19999
.                           
LPV10908  APPEND    ANS,PV100908                 * load source table (IS)
          GOTO      LPV19999
.                           
LPV10909  APPEND    ANS,PV100909                 * load assigning authority (HD)
          GOTO      LPV19999
.                           
LPV10910  APPEND    ANS,PV100910                 * load name type code (ID)
          GOTO      LPV19999
.                           
LPV10911  APPEND    ANS,PV100911                 * load ident. check digit (ST)
          GOTO      LPV19999
.                           
LPV10912  APPEND    ANS,PV100912                 * load chk dig scheme code (ID)
          GOTO      LPV19999
.                           
LPV10913  APPEND    ANS,PV100913                 * load ident. type code (IS)
          GOTO      LPV19999
.                           
LPV10914  APPEND    ANS,PV100914                 * load assigning facility (HD)
          GOTO      LPV19999
.                           
LPV10915  APPEND    ANS,PV100915                 * load name repres. code (ID)
          GOTO      LPV19999
.                           
.         PV1.10 Hospital Service (IS)
.                           
LPV11000  BRANCH    COMPCNT,LPV11001
          GOTO      LPV19999
.
LPV11001  APPEND    ANS,PV101001    
          GOTO      LPV19999
.                           
.         PV1.11 Temporary  Location (PL)
.                           
LPV11100  BRANCH    COMPCNT,LPV11101:            * point of care (IS)
                            LPV11102:            * room (IS)
                            LPV11103:            * bed (IS)
                            LPV11104:            * facility (HD)
                            LPV11105:            * location status (IS)
                            LPV11106:            * person location type (IS)
                            LPV11107:            * building (IS)
                            LPV11108:            * floor (IS)
                            LPV11109             * location description (ST)
          GOTO      LPV19999
.                           
LPV11101  APPEND    ANS,PV101101                 * load point of care (IS)
          GOTO      LPV19999
.                           
LPV11102  APPEND    ANS,PV101102                 * load room (IS)
          GOTO      LPV19999
.                           
LPV11103  APPEND    ANS,PV101103                 * load bed (IS)
          GOTO      LPV19999
.                           
LPV11104  APPEND    ANS,PV101104                 * load facility (HD)
          GOTO      LPV19999
.                           
LPV11105  APPEND    ANS,PV101105                 * load location status (IS)
          GOTO      LPV19999
.                           
LPV11106  APPEND    ANS,PV101106                 * load person locat. type (IS)
          GOTO      LPV19999
.                           
LPV11107  APPEND    ANS,PV101107                 * load building (IS)
          GOTO      LPV19999
.                           
LPV11108  APPEND    ANS,PV101108                 * load floor (IS)
          GOTO      LPV19999
.                           
LPV11109  APPEND    ANS,PV101109                 * load locat. description (ST)
          GOTO      LPV19999
.
.         PV1.12 Preadmit Test Indicator (IS)
.
LPV11200  BRANCH    COMPCNT,LPV11201
          GOTO      LPV19999
.
LPV11201  APPEND    ANS,PV101201
          GOTO      LPV19999
.
.         PV1.13 Re-admission Indicator (IS)
.
LPV11300  BRANCH    COMPCNT,LPV11301
          GOTO      LPV19999
.
LPV11301  APPEND    ANS,PV101301
          GOTO      LPV19999
.
.         PV1.14 Admit Source (IS)
.
LPV11400  BRANCH    COMPCNT,LPV11401
          GOTO      LPV19999
.
LPV11401  APPEND    ANS,PV101401
          GOTO      LPV19999
.
.         PV1.15 Ambulatory Status (IS)
.
LPV11500  BRANCH    COMPCNT,LPV11501
          GOTO      LPV19999
.
LPV11501  APPEND    ANS,PV101501
          GOTO      LPV19999
.
.         PV1.16 VIP Indicator (IS)
.
LPV11600  BRANCH    COMPCNT,LPV11601
          GOTO      LPV19999
.
LPV11601  APPEND    ANS,PV101601
          GOTO      LPV19999
.                           
.         PV1.17 Admitting Doctor (XCN)
.                           
LPV11700  BRANCH    COMPCNT,LPV11701:            * id number (ST)
                            LPV11702:            * family name (ST)
                            LPV11703:            * given name (ST)
                            LPV11704:            * middle name (ST)
                            LPV11705:            * suffix (ST)
                            LPV11706:            * prefix (ST)
                            LPV11707:            * degree (IS)
                            LPV11708:            * source table (IS)
                            LPV11709:            * assigning authority (HD)
                            LPV11710:            * name type code (ID)
                            LPV11711:            * identifier check digit (ST)
                            LPV11712:            * check digit scheme code (ID)
                            LPV11713:            * identifier type code (IS)
                            LPV11714:            * assigning facility (HD)
                            LPV11715             * name representation code (ID)
          GOTO      LPV19999
.                           
LPV11701  APPEND    ANS,PV101701                 * load id number (ST)
          GOTO      LPV19999
.                           
LPV11702  APPEND    ANS,PV101702                 * load family name (ST)
          GOTO      LPV19999
.                           
LPV11703  APPEND    ANS,PV101703                 * load given name (ST)
          GOTO      LPV19999
.                           
LPV11704  APPEND    ANS,PV101704                 * load middle name (ST)
          GOTO      LPV19999
.                           
LPV11705  APPEND    ANS,PV101705                 * load suffix (ST)
          GOTO      LPV19999
.                           
LPV11706  APPEND    ANS,PV101706                 * load prefix (ST)
          GOTO      LPV19999
.                           
LPV11707  APPEND    ANS,PV101707                 * load degree (IS)
          GOTO      LPV19999
.                           
LPV11708  APPEND    ANS,PV101708                 * load source table (IS)
          GOTO      LPV19999
.                           
LPV11709  APPEND    ANS,PV101709                 * load assigning authority (HD)
          GOTO      LPV19999
.                           
LPV11710  APPEND    ANS,PV101710                 * load name type code (ID)
          GOTO      LPV19999
.                           
LPV11711  APPEND    ANS,PV101711                 * load ident. check digit (ST)
          GOTO      LPV19999
.                           
LPV11712  APPEND    ANS,PV101712                 * load chk dig scheme code (ID)
          GOTO      LPV19999
.                           
LPV11713  APPEND    ANS,PV101713                 * load ident. type code (IS)
          GOTO      LPV19999
.                           
LPV11714  APPEND    ANS,PV101714                 * load assigning facility (HD)
          GOTO      LPV19999
.                           
LPV11715  APPEND    ANS,PV101715                 * load name repres. code (ID)
          GOTO      LPV19999
.
.         PV1.18 Patient Type (IS)
.
LPV11800  BRANCH    COMPCNT,LPV11801
          GOTO      LPV19999
.
LPV11801  APPEND    ANS,PV101801
          GOTO      LPV19999
.                           
.         PV1.19 Visit Number (CX)
.                           
LPV11900  BRANCH    COMPCNT,LPV11901:            * id (ST)
                            LPV11902:            * check digit (ST)
                            LPV11903:            * check digit scheme code (ID)
                            LPV11904:            * assigning authority (HD)
                            LPV11905:            * identifier type code (IS)
                            LPV11906             * assigning facility (HD)
          GOTO      LPV19999
.                           
LPV11901  APPEND    ANS,PV101901                 * load id (ST)
          GOTO      LPV19999
.                           
LPV11902  APPEND    ANS,PV101902                 * load check digit (ST)
          GOTO      LPV19999
.                           
LPV11903  APPEND    ANS,PV101903                 * load chk dig scheme code (ID)
          GOTO      LPV19999
.                           
LPV11904  APPEND    ANS,PV101904                 * load assigning authority (HD)
          GOTO      LPV19999
.                           
LPV11905  APPEND    ANS,PV101905                 * load identifier typ code (IS)
          GOTO      LPV19999
.                           
LPV11906  APPEND    ANS,PV101906                 * load assigning facility (HD)
          GOTO      LPV19999
.                           
.         PV1.20 Financial Class (FC)
.                           
LPV12000  BRANCH    COMPCNT,LPV12001:            * financial class (IS)
                            LPV12002             * effective date (TS)
          GOTO      LPV19999
.                           
LPV12001  APPEND    ANS,PV102001                 * load financial class (IS)
          GOTO      LPV19999
.                           
LPV12002  APPEND    ANS,PV102002                 * load effective date (TS)
          GOTO      LPV19999
.
.         PV1.21 Charge Price Indicator (IS)
.
LPV12100  BRANCH    COMPCNT,LPV12101
          GOTO      LPV19999
.
LPV12101  APPEND    ANS,PV102101
          GOTO      LPV19999
.
.         PV1.22 Courtesy Code (IS)
.
LPV12200  BRANCH    COMPCNT,LPV12201
          GOTO      LPV19999
.
LPV12201  APPEND    ANS,PV102201
          GOTO      LPV19999
.
.         PV1.23 Credit Rating (IS)
.
LPV12300  BRANCH    COMPCNT,LPV12301
          GOTO      LPV19999
.
LPV12301  APPEND    ANS,PV102301
          GOTO      LPV19999
.
.         PV1.24 Contract Code (IS)
.
LPV12400  BRANCH    COMPCNT,LPV12401
          GOTO      LPV19999
.
LPV12401  APPEND    ANS,PV102401
          GOTO      LPV19999
.
.         PV1.25 Contract Effective Date (DT)
.
LPV12500  BRANCH    COMPCNT,LPV12501
          GOTO      LPV19999
.
LPV12501  APPEND    ANS,PV102501
          GOTO      LPV19999
.
.         PV1.26 Contract Amount (NM)
.
LPV12600  BRANCH    COMPCNT,LPV12601
          GOTO      LPV19999
.
LPV12601  APPEND    ANS,PV102601
          GOTO      LPV19999
.
.         PV1.27 Contract Period (NM)
.
LPV12700  BRANCH    COMPCNT,LPV12701
          GOTO      LPV19999
.
LPV12701  APPEND    ANS,PV102701
          GOTO      LPV19999
.
.         PV1.28 Interest Code (IS)
.
LPV12800  BRANCH    COMPCNT,LPV12801
          GOTO      LPV19999
.
LPV12801  APPEND    ANS,PV102801
          GOTO      LPV19999
.
.         PV1.29 Transfer To Bad Debt Code (IS)
.
LPV12900  BRANCH    COMPCNT,LPV12901
          GOTO      LPV19999
.
LPV12901  APPEND    ANS,PV102901
          GOTO      LPV19999
.
.         PV1.30 Transfer To Bad Debt Date (DT)
.
LPV13000  BRANCH    COMPCNT,LPV13001
          GOTO      LPV19999
.
LPV13001  APPEND    ANS,PV103001
          GOTO      LPV19999
.
.         PV1.31  Bad Debt Agency Code (IS)
.
LPV13100  BRANCH    COMPCNT,LPV13101
          GOTO      LPV19999
.
LPV13101  APPEND    ANS,PV103101
          GOTO      LPV19999
.
.         PV1.32  Bad Debt Transfer Amount (NM)
.
LPV13200  BRANCH    COMPCNT,LPV13201
          GOTO      LPV19999
.
LPV13201  APPEND    ANS,PV103201
          GOTO      LPV19999
.
.         PV1.33  Bad Debt Recovery Amount (NM)
.
LPV13300  BRANCH    COMPCNT,LPV13301
          GOTO      LPV19999
.
LPV13301  APPEND    ANS,PV103301
          GOTO      LPV19999
.
.         PV1.34  Delete Account Indicator (IS)
.
LPV13400  BRANCH    COMPCNT,LPV13401
          GOTO      LPV19999
.
LPV13401  APPEND    ANS,PV103401
          GOTO      LPV19999
.
.         PV1.35  Delete Account Date (DT)
.
LPV13500  BRANCH    COMPCNT,LPV13501
          GOTO      LPV19999
.
LPV13501  APPEND    ANS,PV103501
          GOTO      LPV19999
.
.         PV1.36  Discharge Disposition (IS)
.
LPV13600  BRANCH    COMPCNT,LPV13601
          GOTO      LPV19999
.
LPV13601  APPEND    ANS,PV103601
          GOTO      LPV19999
.
.         PV1.37  Discharged To Location (CM)
.
LPV13700  BRANCH    COMPCNT,LPV13701:            * discharge location (IS)
                            LPV13702             * effective date (TS)
          GOTO      LPV19999
.
LPV13701  APPEND    ANS,PV103701                 * load discharge location (IS)
          GOTO      LPV19999
.
LPV13702  APPEND    ANS,PV103702                 * load effective date (TS)
          GOTO      LPV19999
.                           
.         PV1.38 Diet Type (CE)
.                           
LPV13800  BRANCH    COMPCNT,LPV13801:            * identifier (ST)
                            LPV13802:            * text (ST)
                            LPV13803:            * name of coding system (ST)
                            LPV13804:            * alternate identifier (ST)
                            LPV13805:            * alternate text (ST)
                            LPV13806             * name of alt. cod. system (ST)
          GOTO      LPV19999
.                           
LPV13801  APPEND    ANS,PV103801                 * load identifier (ST)
          GOTO      LPV19999
.                           
LPV13802  APPEND    ANS,PV103802                 * load text (ST)
          GOTO      LPV19999
.                           
LPV13803  APPEND    ANS,PV103803                 * load name of cod. system (ST)
          GOTO      LPV19999
.                           
LPV13804  APPEND    ANS,PV103804                 * load alt. identifier (ST)
          GOTO      LPV19999
.                           
LPV13805  APPEND    ANS,PV103805                 * load alternate text (ST)
          GOTO      LPV19999
.                           
LPV13806  APPEND    ANS,PV103806                 * load alt. cod. sys. name (ST)
          GOTO      LPV19999
.
.         PV1.39  Servicing Facility (IS)
.                           
LPV13900  BRANCH    COMPCNT,LPV13901
          GOTO      LPV19999
.                           
LPV13901  APPEND    ANS,PV103901
          GOTO      LPV19999
.
.         PV1.40  Bed Status (IS)
.                           
LPV14000  BRANCH    COMPCNT,LPV14001
          GOTO      LPV19999
.                           
LPV14001  APPEND    ANS,PV104001
          GOTO      LPV19999
.
.         PV1.41  Account Status (IS)
.                           
LPV14100  BRANCH    COMPCNT,LPV14101
          GOTO      LPV19999
.                           
LPV14101  APPEND    ANS,PV104101
          GOTO      LPV19999
.                           
.         PV1.42 Pending Location (PL)
.                           
LPV14200  BRANCH    COMPCNT,LPV14201:            * point of care (IS)
                            LPV14202:            * room (IS)
                            LPV14203:            * bed (IS)
                            LPV14204:            * facility (HD)
                            LPV14205:            * location status (IS)
                            LPV14206:            * person location type (IS)
                            LPV14207:            * building (IS)
                            LPV14208:            * floor (IS)
                            LPV14209             * location description (ST)
          GOTO      LPV19999
.                           
LPV14201  APPEND    ANS,PV104201                 * load point of care (IS)
          GOTO      LPV19999
.                           
LPV14202  APPEND    ANS,PV104202                 * load room (IS)
          GOTO      LPV19999
.                           
LPV14203  APPEND    ANS,PV104203                 * load bed (IS)
          GOTO      LPV19999
.                           
LPV14204  APPEND    ANS,PV104204                 * load facility (HD)
          GOTO      LPV19999
.                           
LPV14205  APPEND    ANS,PV104205                 * load location status (IS)
          GOTO      LPV19999
.                           
LPV14206  APPEND    ANS,PV104206                 * load person locat. type (IS)
          GOTO      LPV19999
.                           
LPV14207  APPEND    ANS,PV104207                 * load building (IS)
          GOTO      LPV19999
.                           
LPV14208  APPEND    ANS,PV104208                 * load floor (IS)
          GOTO      LPV19999
.                           
LPV14209  APPEND    ANS,PV104209                 * load locat. description (ST)
          GOTO      LPV19999
.                           
.         PV1.43 Prior Temporary Location (PL)
.                           
LPV14300  BRANCH    COMPCNT,LPV14301:            * point of care (IS)
                            LPV14302:            * room (IS)
                            LPV14303:            * bed (IS)
                            LPV14304:            * facility (HD)
                            LPV14305:            * location status (IS)
                            LPV14306:            * person location type (IS)
                            LPV14307:            * building (IS)
                            LPV14308:            * floor (IS)
                            LPV14309             * location description (ST)
          GOTO      LPV19999
.                           
LPV14301  APPEND    ANS,PV104301                 * load point of care (IS)
          GOTO      LPV19999
.                           
LPV14302  APPEND    ANS,PV104302                 * load room (IS)
          GOTO      LPV19999
.                           
LPV14303  APPEND    ANS,PV104303                 * load bed (IS)
          GOTO      LPV19999
.                           
LPV14304  APPEND    ANS,PV104304                 * load facility (HD)
          GOTO      LPV19999
.                           
LPV14305  APPEND    ANS,PV104305                 * load location status (IS)
          GOTO      LPV19999
.                           
LPV14306  APPEND    ANS,PV104306                 * load person locat. type (IS)
          GOTO      LPV19999
.                           
LPV14307  APPEND    ANS,PV104307                 * load building (IS)
          GOTO      LPV19999
.                           
LPV14308  APPEND    ANS,PV104308                 * load floor (IS)
          GOTO      LPV19999
.                           
LPV14309  APPEND    ANS,PV104309                 * load locat. description (ST)
          GOTO      LPV19999
.         
.         PV1.44  Admit Date/Time (TS)
.                           
LPV14400  BRANCH    COMPCNT,LPV14401
          GOTO      LPV19999
.
LPV14401  APPEND    ANS,PV104401     
          GOTO      LPV19999
.         
.         PV1.45  Discharge Date/Time (TS)
.                           
LPV14500  BRANCH    COMPCNT,LPV14501
          GOTO      LPV19999
.
LPV14501  APPEND    ANS,PV104501     
          GOTO      LPV19999
.         
.         PV1.46  Current Patient Balance (NM)
.                           
LPV14600  BRANCH    COMPCNT,LPV14601
          GOTO      LPV19999
.
LPV14601  APPEND    ANS,PV104601     
          GOTO      LPV19999
.         
.         PV1.47  Total Charges (NM)
.                           
LPV14700  BRANCH    COMPCNT,LPV14701
          GOTO      LPV19999
.
LPV14701  APPEND    ANS,PV104701     
          GOTO      LPV19999
.         
.         PV1.48  Total Adjustments (NM)
.                           
LPV14800  BRANCH    COMPCNT,LPV14801
          GOTO      LPV19999
.
LPV14801  APPEND    ANS,PV104801     
          GOTO      LPV19999
.         
.         PV1.49  Total Payments (NM)
.                           
LPV14900  BRANCH    COMPCNT,LPV14901
          GOTO      LPV19999
.
LPV14901  APPEND    ANS,PV104901     
          GOTO      LPV19999
.                           
.         PV1.50 Alternate Visit ID (CX)
.                           
LPV15000  BRANCH    COMPCNT,LPV15001:            * id (ST)
                            LPV15002:            * check digit (ST)
                            LPV15003:            * check digit scheme code (ID)
                            LPV15004:            * assigning authority (HD)
                            LPV15005:            * identifier type code (IS)
                            LPV15006             * assigning facility (HD)
          GOTO      LPV19999
.                           
LPV15001  APPEND    ANS,PV105001                 * load id (ST)
          GOTO      LPV19999
.                           
LPV15002  APPEND    ANS,PV105002                 * load check digit (ST)
          GOTO      LPV19999
.                           
LPV15003  APPEND    ANS,PV105003                 * load chk dig scheme code (ID)
          GOTO      LPV19999
.                           
LPV15004  APPEND    ANS,PV105004                 * load assigning authority (HD)
          GOTO      LPV19999
.                           
LPV15005  APPEND    ANS,PV105005                 * load identifier typ code (IS)
          GOTO      LPV19999
.                           
LPV15006  APPEND    ANS,PV105006                 * load assigning facility (HD)
          GOTO      LPV19999
.         
.         PV1.51  Visit Indicator (IS)
.                           
LPV15100  BRANCH    COMPCNT,LPV15101
          GOTO      LPV19999
.
LPV15101  APPEND    ANS,PV105101     
          GOTO      LPV19999
.                           
.         PV1.52 Admitting Doctor (XCN)
.                           
LPV15200  BRANCH    COMPCNT,LPV15201:            * id number (ST)
                            LPV15202:            * family name (ST)
                            LPV15203:            * given name (ST)
                            LPV15204:            * middle name (ST)
                            LPV15205:            * suffix (ST)
                            LPV15206:            * prefix (ST)
                            LPV15207:            * degree (IS)
                            LPV15208:            * source table (IS)
                            LPV15209:            * assigning authority (HD)
                            LPV15210:            * name type code (ID)
                            LPV15211:            * identifier check digit (ST)
                            LPV15212:            * check digit scheme code (ID)
                            LPV15213:            * identifier type code (IS)
                            LPV15214:            * assigning facility (HD)
                            LPV15215             * name representation code (ID)
          GOTO      LPV19999
.                           
LPV15201  APPEND    ANS,PV105201                 * load id number (ST)
          GOTO      LPV19999
.                           
LPV15202  APPEND    ANS,PV105202                 * load family name (ST)
          GOTO      LPV19999
.                           
LPV15203  APPEND    ANS,PV105203                 * load given name (ST)
          GOTO      LPV19999
.                           
LPV15204  APPEND    ANS,PV105204                 * load middle name (ST)
          GOTO      LPV19999
.                           
LPV15205  APPEND    ANS,PV105205                 * load suffix (ST)
          GOTO      LPV19999
.                           
LPV15206  APPEND    ANS,PV105206                 * load prefix (ST)
          GOTO      LPV19999
.                           
LPV15207  APPEND    ANS,PV105207                 * load degree (IS)
          GOTO      LPV19999
.                           
LPV15208  APPEND    ANS,PV105208                 * load source table (IS)
          GOTO      LPV19999
.                           
LPV15209  APPEND    ANS,PV105209                 * load assigning authority (HD)
          GOTO      LPV19999
.                           
LPV15210  APPEND    ANS,PV105210                 * load name type code (ID)
          GOTO      LPV19999
.                           
LPV15211  APPEND    ANS,PV105211                 * load ident. check digit (ST)
          GOTO      LPV19999
.                           
LPV15212  APPEND    ANS,PV105212                 * load chk dig scheme code (ID)
          GOTO      LPV19999
.                           
LPV15213  APPEND    ANS,PV105213                 * load ident. type code (IS)
          GOTO      LPV19999
.                           
LPV15214  APPEND    ANS,PV105214                 * load assigning facility (HD)
          GOTO      LPV19999
.                           
LPV15215  APPEND    ANS,PV105215                 * load name repres. code (ID)
          GOTO      LPV19999
.
LPV19999  RETURN
+
.*****************************************************************************
.*                                 LORC0000        Called by: PROC0000       *
.*                          Load the ORC fields                              *
.*****************************************************************************
.
LORC0000  BRANCH    FIELDNO,LORC0100:            * Order Control
                            LORC0200:            * Placer Order Number
                            LORC0300:            * Filler Order Number
                            LORC0400:            * Placer Group Number
                            LORC0500:            * Order Status
                            LORC0600:            * Response Flag
                            LORC0700:            * Quantity/Timing
                            LORC0800:            * Parent
                            LORC0900:            * Date/Time of Transaction
                            LORC1000:            * Entered By
                            LORC1100:            * Verified By
                            LORC1200:            * Ordering Provider
                            LORC1300:            * Enterer.s Location
                            LORC1400:            * Call Back Phone Number
                            LORC1500:            * Order Effective Date/Time
                            LORC1600:            * Order Control Code Reason
                            LORC1700:            * Entering Organisation
                            LORC1800:            * Entering Device
                            LORC1900:            * Action By
                            LORC2000:            * Adv'd Beneficiary Notice Code
                            LORC2100:            * Ordering Facility Name
                            LORC2200:            * Ordering Facility Address
                            LORC2300:            * Ordering Facility Phone No.
                            LORC2400             * Ordering Provider Address
.
.         Invalid ORC field received, so ignore it
.
          GOTO      LORC9999
.
.         ORC.1 Order Control (ID)
.
LORC0100  BRANCH    COMPCNT,LORC0101
          GOTO      LORC9999
.
LORC0101  APPEND    ANS,ORC00101             
          GOTO      LORC9999
.
.         ORC.2  Placer Order Number (EI)
.
LORC0200  BRANCH    COMPCNT,LORC0201:            * entity identifier (ST)
                            LORC0202:            * namespace id (IS)
                            LORC0203:            * universal id (ST)
                            LORC0204             * universal id type (ID)
          GOTO      LORC9999
.
LORC0201  APPEND    ANS,ORC00201                 * load entity identifier (ST)
          GOTO      LORC9999
.
LORC0202  APPEND    ANS,ORC00202                 * load namespace id (IS)
          GOTO      LORC9999
.
LORC0203  APPEND    ANS,ORC00203                 * load universal id (ST)
          GOTO      LORC9999
.
LORC0204  APPEND    ANS,ORC00204                 * load universal id type (ID)
          GOTO      LORC9999
.
.         ORC.3  Filler Order Number (EI)
.
LORC0300  BRANCH    COMPCNT,LORC0301:            * entity identifier (ST)
                            LORC0302:            * namespace id (IS)
                            LORC0303:            * universal id (ST)
                            LORC0304             * universal id type (ID)
          GOTO      LORC9999
.
LORC0301  APPEND    ANS,ORC00301                 * load entity identifier (ST)
          GOTO      LORC9999
.
LORC0302  APPEND    ANS,ORC00302                 * load namespace id (IS)
          GOTO      LORC9999
.
LORC0303  APPEND    ANS,ORC00303                 * load universal id (ST)
          GOTO      LORC9999
.
LORC0304  APPEND    ANS,ORC00304                 * load universal id type (ID)
          GOTO      LORC9999
.
.         ORC.4  Placer Group Number (EI)
.
LORC0400  BRANCH    COMPCNT,LORC0401:            * entity identifier (ST)
                            LORC0402:            * namespace id (IS)
                            LORC0403:            * universal id (ST)
                            LORC0404             * universal id type (ID)
          GOTO      LORC9999
.
LORC0401  APPEND    ANS,ORC00401                 * load entity identifier (ST)
          GOTO      LORC9999
.
LORC0402  APPEND    ANS,ORC00402                 * load namespace id (IS)
          GOTO      LORC9999
.
LORC0403  APPEND    ANS,ORC00403                 * load universal id (ST)
          GOTO      LORC9999
.
LORC0404  APPEND    ANS,ORC00404                 * load universal id type (ID)
          GOTO      LORC9999
.
.         ORC.5 Order Status (ID)
.
LORC0500  BRANCH    COMPCNT,LORC0501
          GOTO      LORC9999
.
LORC0501  APPEND    ANS,ORC00501             
          GOTO      LORC9999
.
.         ORC.6 Response Flag (ID)
.
LORC0600  BRANCH    COMPCNT,LORC0601
          GOTO      LORC9999
.
LORC0601  APPEND    ANS,ORC00601             
          GOTO      LORC9999
.
.         ORC.7 Quantity/Timing (TQ)
.
LORC0700  BRANCH    COMPCNT,LORC0701:            * quantity (CQ)
                            LORC0702:            * interval (CM)
                            LORC0703:            * duration (ST)
                            LORC0704:            * start date/time (TS)
                            LORC0705:            * end date/time (TS)
                            LORC0706:            * priority (ST)
                            LORC0707:            * condition (ST)
                            LORC0708:            * text (TX)
                            LORC0709:            * conjunction (ST)
                            LORC0710:            * order sequencing (CM)
                            LORC0711:            * occurrence duration (CE)
                            LORC0712             * total occurrences (NM)
          GOTO      LORC9999
.
LORC0701  APPEND    ANS,ORC00701                 * quantity (CQ)
          GOTO      LORC9999
.
LORC0702  APPEND    ANS,ORC00702                 * interval (CM)
          GOTO      LORC9999
.
LORC0703  APPEND    ANS,ORC00703                 * duration (ST)
          GOTO      LORC9999
.
LORC0704  APPEND    ANS,ORC00704                 * start date/time (TS)
          GOTO      LORC9999
.
LORC0705  APPEND    ANS,ORC00705                 * end date/time (TS)
          GOTO      LORC9999
.
LORC0706  APPEND    ANS,ORC00706                 * priority (ST)
          GOTO      LORC9999
.
LORC0707  APPEND    ANS,ORC00707                 * condition (ST)
          GOTO      LORC9999
.
LORC0708  APPEND    ANS,ORC00708                 * text (TX)
          GOTO      LORC9999
.
LORC0709  APPEND    ANS,ORC00709                 * conjunction (ST)
          GOTO      LORC9999
.
LORC0710  APPEND    ANS,ORC00710                 * order sequencing (CM)
          GOTO      LORC9999
.
LORC0711  APPEND    ANS,ORC00711                 * occurrence duration (CE)
          GOTO      LORC9999
.
LORC0712  APPEND    ANS,ORC00712                 * total occurrences (NM)
          GOTO      LORC9999
.
.         ORC.8 Parent (CM)
.
LORC0800  BRANCH    COMPCNT,LORC0801:            * parent's placer order no (EI)
                            LORC0802             * parent's filler order no (EI)
          GOTO      LORC9999
.
LORC0801  APPEND    ANS,ORC00801                 * parent's placer order no (EI)
          GOTO      LORC9999
.
LORC0802  APPEND    ANS,ORC00802                 * parent's filler order no (EI)
          GOTO      LORC9999
.
.         ORC.9 Date/Time of Transaction (TS)
.
LORC0900  BRANCH    COMPCNT,LORC0901
          GOTO      LORC9999
.
LORC0901  APPEND    ANS,ORC00901            
          GOTO      LORC9999
.
.         ORC.10 Entered By (XCN)
.
LORC1000  BRANCH    COMPCNT,LORC1001:            * id number (ST)
                            LORC1002:            * family name (ST)
                            LORC1003:            * given name (ST)
                            LORC1004:            * middle name (ST)
                            LORC1005:            * suffix (ST)
                            LORC1006:            * prefix (ST)
                            LORC1007:            * degree (IS)
                            LORC1008:            * source table (IS)
                            LORC1009:            * assigning authority (HD)
                            LORC1010:            * name type code (ID)
                            LORC1011:            * identifier check digit (ST)
                            LORC1012:            * check digit code scheme (ID)
                            LORC1013:            * identifier type code (IS)
                            LORC1014:            * assigning facility (HD)
                            LORC1015             * name representation code (ID)
          GOTO      LORC9999
.
LORC1001  APPEND    ANS,ORC01001                 * id number (ST)
          GOTO      LORC9999
.
LORC1002  APPEND    ANS,ORC01002                 * family name (ST)
          GOTO      LORC9999
.
LORC1003  APPEND    ANS,ORC01003                 * given name (ST)
          GOTO      LORC9999
.
LORC1004  APPEND    ANS,ORC01004                 * middle name (ST)
          GOTO      LORC9999
.
LORC1005  APPEND    ANS,ORC01005                 * suffix (ST)
          GOTO      LORC9999
.
LORC1006  APPEND    ANS,ORC01006                 * prefix (ST)
          GOTO      LORC9999
.
LORC1007  APPEND    ANS,ORC01007                 * degree (IS)
          GOTO      LORC9999
.
LORC1008  APPEND    ANS,ORC01008                 * source table (IS)
          GOTO      LORC9999
.
LORC1009  APPEND    ANS,ORC01009                 * assigning authority (HD)
          GOTO      LORC9999
.
LORC1010  APPEND    ANS,ORC01010                 * name type code (ID)
          GOTO      LORC9999
.
LORC1011  APPEND    ANS,ORC01011                 * identifier check digit (ST)
          GOTO      LORC9999
.
LORC1012  APPEND    ANS,ORC01012                 * check digit code scheme (ID)
          GOTO      LORC9999
.
LORC1013  APPEND    ANS,ORC01013                 * identifier type code (IS)
          GOTO      LORC9999
.
LORC1014  APPEND    ANS,ORC01014                 * assigning facility (HD)
          GOTO      LORC9999
.
LORC1015  APPEND    ANS,ORC01015                 * name representation code (ID)
          GOTO      LORC9999
.
.         ORC.11 Verified By (XCN)
.
LORC1100  BRANCH    COMPCNT,LORC1101:            * id number (ST)
                            LORC1102:            * family name (ST)
                            LORC1103:            * given name (ST)
                            LORC1104:            * middle name (ST)
                            LORC1105:            * suffix (ST)
                            LORC1106:            * prefix (ST)
                            LORC1107:            * degree (IS)
                            LORC1108:            * source table (IS)
                            LORC1109:            * assigning authority (HD)
                            LORC1110:            * name type code (ID)
                            LORC1111:            * identifier check digit (ST)
                            LORC1112:            * check digit code scheme (ID)
                            LORC1113:            * identifier type code (IS)
                            LORC1114:            * assigning facility (HD)
                            LORC1115             * name representation code (ID)
          GOTO      LORC9999
.
LORC1101  APPEND    ANS,ORC01101                 * id number (ST)
          GOTO      LORC9999
.
LORC1102  APPEND    ANS,ORC01102                 * family name (ST)
          GOTO      LORC9999
.
LORC1103  APPEND    ANS,ORC01103                 * given name (ST)
          GOTO      LORC9999
.
LORC1104  APPEND    ANS,ORC01104                 * middle name (ST)
          GOTO      LORC9999
.
LORC1105  APPEND    ANS,ORC01105                 * suffix (ST)
          GOTO      LORC9999
.
LORC1106  APPEND    ANS,ORC01106                 * prefix (ST)
          GOTO      LORC9999
.
LORC1107  APPEND    ANS,ORC01107                 * degree (IS)
          GOTO      LORC9999
.
LORC1108  APPEND    ANS,ORC01108                 * source table (IS)
          GOTO      LORC9999
.
LORC1109  APPEND    ANS,ORC01109                 * assigning authority (HD)
          GOTO      LORC9999
.
LORC1110  APPEND    ANS,ORC01110                 * name type code (ID)
          GOTO      LORC9999
.
LORC1111  APPEND    ANS,ORC01111                 * identifier check digit (ST)
          GOTO      LORC9999
.
LORC1112  APPEND    ANS,ORC01112                 * check digit code scheme (ID)
          GOTO      LORC9999
.
LORC1113  APPEND    ANS,ORC01113                 * identifier type code (IS)
          GOTO      LORC9999
.
LORC1114  APPEND    ANS,ORC01114                 * assigning facility (HD)
          GOTO      LORC9999
.
LORC1115  APPEND    ANS,ORC01115                 * name representation code (ID)
          GOTO      LORC9999
.
.         ORC.12 Ordering Provider (XCN)
.
LORC1200  BRANCH    COMPCNT,LORC1201:            * id number (ST)
                            LORC1202:            * family name (ST)
                            LORC1203:            * given name (ST)
                            LORC1204:            * middle name (ST)
                            LORC1205:            * suffix (ST)
                            LORC1206:            * prefix (ST)
                            LORC1207:            * degree (IS)
                            LORC1208:            * source table (IS)
                            LORC1209:            * assigning authority (HD)
                            LORC1210:            * name type code (ID)
                            LORC1211:            * identifier check digit (ST)
                            LORC1212:            * check digit code scheme (ID)
                            LORC1213:            * identifier type code (IS)
                            LORC1214:            * assigning facility (HD)
                            LORC1215             * name representation code (ID)
          GOTO      LORC9999
.
LORC1201  APPEND    ANS,ORC01201                 * id number (ST)
          GOTO      LORC9999
.
LORC1202  APPEND    ANS,ORC01202                 * family name (ST)
          GOTO      LORC9999
.
LORC1203  APPEND    ANS,ORC01203                 * given name (ST)
          GOTO      LORC9999
.
LORC1204  APPEND    ANS,ORC01204                 * middle name (ST)
          GOTO      LORC9999
.
LORC1205  APPEND    ANS,ORC01205                 * suffix (ST)
          GOTO      LORC9999
.
LORC1206  APPEND    ANS,ORC01206                 * prefix (ST)
          GOTO      LORC9999
.
LORC1207  APPEND    ANS,ORC01207                 * degree (IS)
          GOTO      LORC9999
.
LORC1208  APPEND    ANS,ORC01208                 * source table (IS)
          GOTO      LORC9999
.
LORC1209  APPEND    ANS,ORC01209                 * assigning authority (HD)
          GOTO      LORC9999
.
LORC1210  APPEND    ANS,ORC01210                 * name type code (ID)
          GOTO      LORC9999
.
LORC1211  APPEND    ANS,ORC01211                 * identifier check digit (ST)
          GOTO      LORC9999
.
LORC1212  APPEND    ANS,ORC01212                 * check digit code scheme (ID)
          GOTO      LORC9999
.
LORC1213  APPEND    ANS,ORC01213                 * identifier type code (IS)
          GOTO      LORC9999
.
LORC1214  APPEND    ANS,ORC01214                 * assigning facility (HD)
          GOTO      LORC9999
.
LORC1215  APPEND    ANS,ORC01215                 * name representation code (ID)
          GOTO      LORC9999
.
.         ORC.13 Enterer's Location (PL)
.
LORC1300  BRANCH    COMPCNT,LORC1301:            * point of care (IS)
                            LORC1302:            * room (IS)
                            LORC1303:            * bed (IS)
                            LORC1304:            * facility (HD)
                            LORC1305:            * location status (IS)
                            LORC1306:            * person location type (IS)
                            LORC1307:            * building (IS)
                            LORC1308:            * floor (IS)
                            LORC1309             * location description (ST)
          GOTO      LORC9999
.
LORC1301  APPEND    ANS,ORC01301                 * load point of care (IS)
          GOTO      LORC9999
.
LORC1302  APPEND    ANS,ORC01302                 * load room (IS)
          GOTO      LORC9999
.
LORC1303  APPEND    ANS,ORC01303                 * load bed (IS)
          GOTO      LORC9999
.
LORC1304  APPEND    ANS,ORC01304                 * load facility (HD)
          GOTO      LORC9999
.
LORC1305  APPEND    ANS,ORC01305                 * load location status (IS)
          GOTO      LORC9999
.
LORC1306  APPEND    ANS,ORC01306                 * load person locat. type (IS)
          GOTO      LORC9999
.
LORC1307  APPEND    ANS,ORC01307                 * load building (IS)
          GOTO      LORC9999
.
LORC1308  APPEND    ANS,ORC01308                 * load floor (IS)
          GOTO      LORC9999
.
LORC1309  APPEND    ANS,ORC01309                 * load locat. description (ST)
          GOTO      LORC9999
.
.         ORC.14 Call Back Phone Number (XTN)
.
LORC1400  BRANCH    COMPCNT,LORC1401:            * text
                            LORC1402:            * telecomm. use code (ID)
                            LORC1403:            * telcomm. equipment type (ID)
                            LORC1404:            * email address (ST)
                            LORC1405:            * country code (NM)
                            LORC1406:            * area/city code (NM)
                            LORC1407:            * phone number (NM)
                            LORC1408:            * extension (NM)
                            LORC1409             * any text (ST)
          GOTO      LORC9999
.
LORC1401  APPEND    ANS,ORC01401                 * load text
          GOTO      LORC9999
.
LORC1402  APPEND    ANS,ORC01402                 * load telecomm. use code (ID)
          GOTO      LORC9999
.
LORC1403  APPEND    ANS,ORC01403                 * load telcomm. equip.type (ID)
          GOTO      LORC9999
.
LORC1404  APPEND    ANS,ORC01404                 * load email address (ST)
          GOTO      LORC9999
.
LORC1405  APPEND    ANS,ORC01405                 * load country code (NM)
          GOTO      LORC9999
.
LORC1406  APPEND    ANS,ORC01406                 * load area/city code (NM)
          GOTO      LORC9999
.
LORC1407  APPEND    ANS,ORC01407                 * load phone number (NM)
          GOTO      LORC9999
.
LORC1408  APPEND    ANS,ORC01408                 * load extension (NM)
          GOTO      LORC9999
.
LORC1409  APPEND    ANS,ORC01409                 * load any text (ST)
          GOTO      LORC9999
.
.         ORC.15 Order Effective Date/Time (TS)
.
LORC1500  BRANCH    COMPCNT,LORC1501
          GOTO      LORC9999
.
LORC1501  APPEND    ANS,ORC01501            
          GOTO      LORC9999
.
.         ORC.16 Order Control Code Reason (CE)
.
LORC1600  BRANCH    COMPCNT,LORC1601:            * identifier (ST)
                            LORC1602:            * text (ST)
                            LORC1603:            * name of coding system (ST)
                            LORC1604:            * alternate identifier (ST)
                            LORC1605:            * alternate text (ST)
                            LORC1606             * name of alt. coding sys. (ST)
          GOTO      LORC9999
.
LORC1601  APPEND    ANS,ORC01601                 * load identifier (ST)
          GOTO      LORC9999
.
LORC1602  APPEND    ANS,ORC01602                 * load text (ST)
          GOTO      LORC9999
.
LORC1603  APPEND    ANS,ORC01603                 * load name of coding sys. (ST)
          GOTO      LORC9999
.
LORC1604  APPEND    ANS,ORC01604                 * load alt. identifier (ST)
          GOTO      LORC9999
.
LORC1605  APPEND    ANS,ORC01605                 * load alternate text (ST)
          GOTO      LORC9999
.
LORC1606  APPEND    ANS,ORC01606                 * load name alt. cod. sys. (ST)
          GOTO      LORC9999
.
.         ORC.17 Entering Organisation (CE)
.
LORC1700  BRANCH    COMPCNT,LORC1701:            * identifier (ST)
                            LORC1702:            * text (ST)
                            LORC1703:            * name of coding system (ST)
                            LORC1704:            * alternate identifier (ST)
                            LORC1705:            * alternate text (ST)
                            LORC1706             * name of alt. coding sys. (ST)
          GOTO      LORC9999
.
LORC1701  APPEND    ANS,ORC01701                 * load identifier (ST)
          GOTO      LORC9999
.
LORC1702  APPEND    ANS,ORC01702                 * load text (ST)
          GOTO      LORC9999
.
LORC1703  APPEND    ANS,ORC01703                 * load name of coding sys. (ST)
          GOTO      LORC9999
.
LORC1704  APPEND    ANS,ORC01704                 * load alt. identifier (ST)
          GOTO      LORC9999
.
LORC1705  APPEND    ANS,ORC01705                 * load alternate text (ST)
          GOTO      LORC9999
.
LORC1706  APPEND    ANS,ORC01706                 * load name alt. cod. sys. (ST)
          GOTO      LORC9999
.
.         ORC.18 Entering Device (CE)
.
LORC1800  BRANCH    COMPCNT,LORC1801:            * identifier (ST)
                            LORC1802:            * text (ST)
                            LORC1803:            * name of coding system (ST)
                            LORC1804:            * alternate identifier (ST)
                            LORC1805:            * alternate text (ST)
                            LORC1806             * name of alt. coding sys. (ST)
          GOTO      LORC9999
.
LORC1801  APPEND    ANS,ORC01801                 * load identifier (ST)
          GOTO      LORC9999
.
LORC1802  APPEND    ANS,ORC01802                 * load text (ST)
          GOTO      LORC9999
.
LORC1803  APPEND    ANS,ORC01803                 * load name of coding sys. (ST)
          GOTO      LORC9999
.
LORC1804  APPEND    ANS,ORC01804                 * load alt. identifier (ST)
          GOTO      LORC9999
.
LORC1805  APPEND    ANS,ORC01805                 * load alternate text (ST)
          GOTO      LORC9999
.
LORC1806  APPEND    ANS,ORC01806                 * load name alt. cod. sys. (ST)
          GOTO      LORC9999
.
.         ORC.19 Action By (XCN)
.
LORC1900  BRANCH    COMPCNT,LORC1901:            * id number (ST)
                            LORC1902:            * family name (ST)
                            LORC1903:            * given name (ST)
                            LORC1904:            * middle name (ST)
                            LORC1905:            * suffix (ST)
                            LORC1906:            * prefix (ST)
                            LORC1907:            * degree (IS)
                            LORC1908:            * source table (IS)
                            LORC1909:            * assigning authority (HD)
                            LORC1910:            * name type code (ID)
                            LORC1911:            * identifier check digit (ST)
                            LORC1912:            * check digit code scheme (ID)
                            LORC1913:            * identifier type code (IS)
                            LORC1914:            * assigning facility (HD)
                            LORC1915             * name representation code (ID)
          GOTO      LORC9999
.
LORC1901  APPEND    ANS,ORC01901                 * id number (ST)
          GOTO      LORC9999
.
LORC1902  APPEND    ANS,ORC01902                 * family name (ST)
          GOTO      LORC9999
.
LORC1903  APPEND    ANS,ORC01903                 * given name (ST)
          GOTO      LORC9999
.
LORC1904  APPEND    ANS,ORC01904                 * middle name (ST)
          GOTO      LORC9999
.
LORC1905  APPEND    ANS,ORC01905                 * suffix (ST)
          GOTO      LORC9999
.
LORC1906  APPEND    ANS,ORC01906                 * prefix (ST)
          GOTO      LORC9999
.
LORC1907  APPEND    ANS,ORC01907                 * degree (IS)
          GOTO      LORC9999
.
LORC1908  APPEND    ANS,ORC01908                 * source table (IS)
          GOTO      LORC9999
.
LORC1909  APPEND    ANS,ORC01909                 * assigning authority (HD)
          GOTO      LORC9999
.
LORC1910  APPEND    ANS,ORC01910                 * name type code (ID)
          GOTO      LORC9999
.
LORC1911  APPEND    ANS,ORC01911                 * identifier check digit (ST)
          GOTO      LORC9999
.
LORC1912  APPEND    ANS,ORC01912                 * check digit code scheme (ID)
          GOTO      LORC9999
.
LORC1913  APPEND    ANS,ORC01913                 * identifier type code (IS)
          GOTO      LORC9999
.
LORC1914  APPEND    ANS,ORC01914                 * assigning facility (HD)
          GOTO      LORC9999
.
LORC1915  APPEND    ANS,ORC01915                 * name representation code (ID)
          GOTO      LORC9999
.
.         ORC.20 Advanced Beneficiary Notice Code (CE)
.
LORC2000  BRANCH    COMPCNT,LORC2001:            * identifier (ST)
                            LORC2002:            * text (ST)
                            LORC2003:            * name of coding system (ST)
                            LORC2004:            * alternate identifier (ST)
                            LORC2005:            * alternate text (ST)
                            LORC2006             * name of alt. coding sys. (ST)
          GOTO      LORC9999
.
LORC2001  APPEND    ANS,ORC02001                 * load identifier (ST)
          GOTO      LORC9999
.
LORC2002  APPEND    ANS,ORC02002                 * load text (ST)
          GOTO      LORC9999
.
LORC2003  APPEND    ANS,ORC02003                 * load name of coding sys. (ST)
          GOTO      LORC9999
.
LORC2004  APPEND    ANS,ORC02004                 * load alt. identifier (ST)
          GOTO      LORC9999
.
LORC2005  APPEND    ANS,ORC02005                 * load alternate text (ST)
          GOTO      LORC9999
.
LORC2006  APPEND    ANS,ORC02006                 * load name alt. cod. sys. (ST)
          GOTO      LORC9999
.
.         ORC.21 Ordering Facility Name (XON)
.
LORC2100  BRANCH    COMPCNT,LORC2101:            * organisation name (ST)
                            LORC2102:            * org. name type code (IS)
                            LORC2103:            * id number (NM)
                            LORC2104:            * check digit (NM)
                            LORC2105:            * check digit scheme code (ID)
                            LORC2106:            * assigning authority (HD)
                            LORC2107:            * identifier type code (IS)
                            LORC2108:            * assigning facility (HD)
                            LORC2109             * name rep. code (ID)
          GOTO      LORC9999
.
LORC2101  APPEND    ANS,ORC02101                 * organisation name (ST)
          GOTO      LORC9999
.
LORC2102  APPEND    ANS,ORC02102                 * org. name type code (IS)
          GOTO      LORC9999
.
LORC2103  APPEND    ANS,ORC02103                 * id number (NM)
          GOTO      LORC9999
.
LORC2104  APPEND    ANS,ORC02104                 * load check digit (ST)
          GOTO      LORC9999
.
LORC2105  APPEND    ANS,ORC02105                 * load chk dig scheme code (ID)
          GOTO      LORC9999
.
LORC2106  APPEND    ANS,ORC02106                 * load assigning authority (HD)
          GOTO      LORC9999
.
LORC2107  APPEND    ANS,ORC02107                 * load identifier typ code (IS)
          GOTO      LORC9999
.
LORC2108  APPEND    ANS,ORC02108                 * load assigning facility (HD)
          GOTO      LORC9999
.
LORC2109  APPEND    ANS,ORC02109                 * load name rep. code (ID)
          GOTO      LORC9999
.
.         ORC.22 Ordering Facility Address (XAD)
.
LORC2200  BRANCH    COMPCNT,LORC2201:            * street address (ST)
                            LORC2202:            * other designation (ST)
                            LORC2203:            * city (ST)
                            LORC2204:            * state (ST)
                            LORC2205:            * postcode (ST)
                            LORC2206:            * country (ID)
                            LORC2207:            * address type (ID)
                            LORC2208:            * other geographic desig. (ST)
                            LORC2209:            * county (IS)
                            LORC2210:            * census tract (IS)
                            LORC2211             * address rep. code (ID)
          GOTO      LORC9999
.
LORC2201  APPEND    ANS,ORC02201                 * load street address (ST)
          GOTO      LORC9999
.
LORC2202  APPEND    ANS,ORC02202                 * load other designation (ST)
          GOTO      LORC9999
.
LORC2203  APPEND    ANS,ORC02203                 * load city (ST)
          GOTO      LORC9999
.
LORC2204  APPEND    ANS,ORC02204                 * load state (ST)
          GOTO      LORC9999
.
LORC2205  APPEND    ANS,ORC02205                 * load postcode (ST)
          GOTO      LORC9999
.
LORC2206  APPEND    ANS,ORC02206                 * load country (ID)
          GOTO      LORC9999
.
LORC2207  APPEND    ANS,ORC02207                 * load address type (ID)
          GOTO      LORC9999
.
LORC2208  APPEND    ANS,ORC02208                 * load other geog. desig. (ST)
          GOTO      LORC9999
.
LORC2209  APPEND    ANS,ORC02209                 * load county (IS)
          GOTO      LORC9999
.
LORC2210  APPEND    ANS,ORC02210                 * load census tract (IS)
          GOTO      LORC9999
.
LORC2211  APPEND    ANS,ORC02211                 * load address rep code (ID)
          GOTO      LORC9999
.
.         ORC.23 Ordering Facility Phone Number (XTN)
.
LORC2300  BRANCH    COMPCNT,LORC2301:            * text
                            LORC2302:            * telecomm. use code (ID)
                            LORC2303:            * telcomm. equipment type (ID)
                            LORC2304:            * email address (ST)
                            LORC2305:            * country code (NM)
                            LORC2306:            * area/city code (NM)
                            LORC2307:            * phone number (NM)
                            LORC2308:            * extension (NM)
                            LORC2309             * any text (ST)
          GOTO      LORC9999
.
LORC2301  APPEND    ANS,ORC02301                 * load text
          GOTO      LORC9999
.
LORC2302  APPEND    ANS,ORC02302                 * load telecomm. use code (ID)
          GOTO      LORC9999
.
LORC2303  APPEND    ANS,ORC02303                 * load telcomm. equip.type (ID)
          GOTO      LORC9999
.
LORC2304  APPEND    ANS,ORC02304                 * load email address (ST)
          GOTO      LORC9999
.
LORC2305  APPEND    ANS,ORC02305                 * load country code (NM)
          GOTO      LORC9999
.
LORC2306  APPEND    ANS,ORC02306                 * load area/city code (NM)
          GOTO      LORC9999
.
LORC2307  APPEND    ANS,ORC02307                 * load phone number (NM)
          GOTO      LORC9999
.
LORC2308  APPEND    ANS,ORC02308                 * load extension (NM)
          GOTO      LORC9999
.
LORC2309  APPEND    ANS,ORC02309                 * load any text (ST)
          GOTO      LORC9999
.
.         ORC.24 Ordering Provider Address (XAD)
.
LORC2400  BRANCH    COMPCNT,LORC2401:            * street address (ST)
                            LORC2402:            * other designation (ST)
                            LORC2403:            * city (ST)
                            LORC2404:            * state (ST)
                            LORC2405:            * postcode (ST)
                            LORC2406:            * country (ID)
                            LORC2407:            * address type (ID)
                            LORC2408:            * other geographic desig. (ST)
                            LORC2409:            * county (IS)
                            LORC2410:            * census tract (IS)
                            LORC2411             * address rep. code (ID)
          GOTO      LORC9999
.
LORC2401  APPEND    ANS,ORC02401                 * load street address (ST)
          GOTO      LORC9999
.
LORC2402  APPEND    ANS,ORC02402                 * load other designation (ST)
          GOTO      LORC9999
.
LORC2403  APPEND    ANS,ORC02403                 * load city (ST)
          GOTO      LORC9999
.
LORC2404  APPEND    ANS,ORC02404                 * load state (ST)
          GOTO      LORC9999
.
LORC2405  APPEND    ANS,ORC02405                 * load postcode (ST)
          GOTO      LORC9999
.
LORC2406  APPEND    ANS,ORC02406                 * load country (ID)
          GOTO      LORC9999
.
LORC2407  APPEND    ANS,ORC02407                 * load address type (ID)
          GOTO      LORC9999
.
LORC2408  APPEND    ANS,ORC02408                 * load other geog. desig. (ST)
          GOTO      LORC9999
.
LORC2409  APPEND    ANS,ORC02409                 * load county (IS)
          GOTO      LORC9999
.
LORC2410  APPEND    ANS,ORC02410                 * load census tract (IS)
          GOTO      LORC9999
.
LORC2411  APPEND    ANS,ORC02411                 * load address rep code (ID)
          GOTO      LORC9999
.
LORC9999  RETURN
+
.*****************************************************************************
.*                                 LRXD0000        Called by: PROC0000       *
.*                          Load the RXD fields                              *
.*****************************************************************************
.
LRXD0000  BRANCH    FIELDNO,LRXD0100:            * Dispense Sub-ID Counter
                            LRXD0200:            * Dispense/Give Code
                            LRXD0300:            * Date/Time Dispensed
                            LRXD0400:            * Actual Dispense Amount
                            LRXD0500:            * Actual Dispense Units
                            LRXD0600:            * Actual Dosage Form
                            LRXD0700:            * Prescription Number
                            LRXD0800:            * Number of Refills Remaining
                            LRXD0900:            * Dispense Notes
                            LRXD1000:            * Dispensing Provider
                            LRXD1100:            * Substitution Status
                            LRXD1200:            * Total Daily Dose
                            LRXD1300:            * Dispense-to Location
                            LRXD1400:            * Needs Human Review
                            LRXD1500:            * Pharmacy/Treatment Supplier's
.                                                  Special Disp'ing Instructions
                            LRXD1600:            * Actual Strength
                            LRXD1700:            * Actual Strength Unit
                            LRXD1800:            * Substance Lot Number
                            LRXD1900:            * Substance Expiration Date
                            LRXD2000:            * Substance Manufacturer Name
                            LRXD2100:            * Indication
                            LRXD2200:            * Dispense Package Size
                            LRXD2300:            * Dispense Package Size Unit
                            LRXD2400             * Dispense Package Method
.
.         Invalid RXD field received, so ignore it
.
          GOTO      LRXD9999
.
.         RXD.1 Dispense Sub-ID Counter (NM)
.
LRXD0100  BRANCH    COMPCNT,LRXD0101
          GOTO      LRXD9999
.
LRXD0101  APPEND    ANS,RXD00101                 * load dispense sub-id counter
          GOTO      LRXD9999
.
.         RXD.2 Dispense/Give Code (CE)
.
LRXD0200  BRANCH    COMPCNT,LRXD0201:            * identifier (ST)
                            LRXD0202:            * text (ST)
                            LRXD0203:            * name of coding system (ST)
                            LRXD0204:            * alternate identifier (ST)
                            LRXD0205:            * alternate text (ST)
                            LRXD0206             * name of alt. coding sys. (ST)
          GOTO      LRXD9999
.
LRXD0201  APPEND    ANS,RXD00201                 * load identifier (ST)
          GOTO      LRXD9999
.
LRXD0202  APPEND    ANS,RXD00202                 * load text (ST)
          GOTO      LRXD9999
.
LRXD0203  APPEND    ANS,RXD00203                 * load name of coding sys. (ST)
          GOTO      LRXD9999
.
LRXD0204  APPEND    ANS,RXD00204                 * load alt. identifier (ST)
          GOTO      LRXD9999
.
LRXD0205  APPEND    ANS,RXD00205                 * load alternate text (ST)
          GOTO      LRXD9999
.
LRXD0206  APPEND    ANS,RXD00206                 * load name alt. cod. sys. (ST)
          GOTO      LRXD9999
.
.         RXD.3 Date/Time Dispensed (TS)
.
LRXD0300  BRANCH    COMPCNT,LRXD0301
          GOTO      LRXD9999
.
LRXD0301  APPEND    ANS,RXD00301                 * load date/time dispensed
          GOTO      LRXD9999
.
.         RXD.4 Actual Dispense Amount (NM)
.
LRXD0400  BRANCH    COMPCNT,LRXD0401
          GOTO      LRXD9999
.
LRXD0401  APPEND    ANS,RXD00401                 * load actual dispense amount
          GOTO      LRXD9999
.
.         RXD.5 Actual Dispense Units (CE)
.
LRXD0500  BRANCH    COMPCNT,LRXD0501:            * identifier (ST)
                            LRXD0502:            * text (ST)
                            LRXD0503:            * name of coding system (ST)
                            LRXD0504:            * alternate identifier (ST)
                            LRXD0505:            * alternate text (ST)
                            LRXD0506             * name of alt. coding sys. (ST)
          GOTO      LRXD9999
.
LRXD0501  APPEND    ANS,RXD00501                 * load identifier (ST)
          GOTO      LRXD9999
.
LRXD0502  APPEND    ANS,RXD00502                 * load text (ST)
          GOTO      LRXD9999
.
LRXD0503  APPEND    ANS,RXD00503                 * load name of coding sys. (ST)
          GOTO      LRXD9999
.
LRXD0504  APPEND    ANS,RXD00504                 * load alt. identifier (ST)
          GOTO      LRXD9999
.
LRXD0505  APPEND    ANS,RXD00505                 * load alternate text (ST)
          GOTO      LRXD9999
.
LRXD0506  APPEND    ANS,RXD00506                 * load name alt. cod. sys. (ST)
          GOTO      LRXD9999
.
.         RXD.6 Actual Dosage Form (CE)
.
LRXD0600  BRANCH    COMPCNT,LRXD0601:            * identifier (ST)
                            LRXD0602:            * text (ST)
                            LRXD0603:            * name of coding system (ST)
                            LRXD0604:            * alternate identifier (ST)
                            LRXD0605:            * alternate text (ST)
                            LRXD0606             * name of alt. coding sys. (ST)
          GOTO      LRXD9999
.
LRXD0601  APPEND    ANS,RXD00601                 * load identifier (ST)
          GOTO      LRXD9999
.
LRXD0602  APPEND    ANS,RXD00602                 * load text (ST)
          GOTO      LRXD9999
.
LRXD0603  APPEND    ANS,RXD00603                 * load name of coding sys. (ST)
          GOTO      LRXD9999
.
LRXD0604  APPEND    ANS,RXD00604                 * load alt. identifier (ST)
          GOTO      LRXD9999
.
LRXD0605  APPEND    ANS,RXD00605                 * load alternate text (ST)
          GOTO      LRXD9999
.
LRXD0606  APPEND    ANS,RXD00606                 * load name alt. cod. sys. (ST)
          GOTO      LRXD9999
.
.         RXD.7 Prescription Number (ST)
.
LRXD0700  BRANCH    COMPCNT,LRXD0701
          GOTO      LRXD9999
.
LRXD0701  APPEND    ANS,RXD00701                 * load prescription number
          GOTO      LRXD9999
.
.         RXD.8 Number of Refills Remaining (NM)
.
LRXD0800  BRANCH    COMPCNT,LRXD0801
          GOTO      LRXD9999
.
LRXD0801  APPEND    ANS,RXD00801                 * load no of refills remaining
          GOTO      LRXD9999
.
.         RXD.9 Dispense Notes (ST)
.
LRXD0900  BRANCH    COMPCNT,LRXD0901
          GOTO      LRXD9999
.
LRXD0901  APPEND    ANS,RXD00901                 * load dispense notes
          GOTO      LRXD9999
.
.         RXD.10 Dispensing Provider (XCN)
.
LRXD1000  BRANCH    COMPCNT,LRXD1001:            * id number (ST)
                            LRXD1002:            * family name (ST)
                            LRXD1003:            * given name (ST)
                            LRXD1004:            * middle name (ST)
                            LRXD1005:            * suffix (ST)
                            LRXD1006:            * prefix (ST)
                            LRXD1007:            * degree (IS)
                            LRXD1008:            * source table (IS)
                            LRXD1009:            * assigning authority (HD)
                            LRXD1010:            * name type code (ID)
                            LRXD1011:            * identifier check digit (ST)
                            LRXD1012:            * check digit code scheme (ID)
                            LRXD1013:            * identifier type code (IS)
                            LRXD1014:            * assigning facility (HD)
                            LRXD1015             * name representation code (ID)
          GOTO      LRXD9999
.
LRXD1001  APPEND    ANS,RXD01001
          GOTO      LRXD9999
.
LRXD1002  APPEND    ANS,RXD01002
          GOTO      LRXD9999
.
LRXD1003  APPEND    ANS,RXD01003
          GOTO      LRXD9999
.
LRXD1004  APPEND    ANS,RXD01004
          GOTO      LRXD9999
.
LRXD1005  APPEND    ANS,RXD01005
          GOTO      LRXD9999
.
LRXD1006  APPEND    ANS,RXD01006
          GOTO      LRXD9999
.
LRXD1007  APPEND    ANS,RXD01007
          GOTO      LRXD9999
.
LRXD1008  APPEND    ANS,RXD01008
          GOTO      LRXD9999
.
LRXD1009  APPEND    ANS,RXD01009
          GOTO      LRXD9999
.
LRXD1010  APPEND    ANS,RXD01010
          GOTO      LRXD9999
.
LRXD1011  APPEND    ANS,RXD01011
          GOTO      LRXD9999
.
LRXD1012  APPEND    ANS,RXD01012
          GOTO      LRXD9999
.
LRXD1013  APPEND    ANS,RXD01013
          GOTO      LRXD9999
.
LRXD1014  APPEND    ANS,RXD01014
          GOTO      LRXD9999
.
LRXD1015  APPEND    ANS,RXD01015
          GOTO      LRXD9999
.
.         RXD.11 Substitution Status (ID)
.
LRXD1100  BRANCH    COMPCNT,LRXD1101
          GOTO      LRXD9999
.
LRXD1101  APPEND    ANS,RXD01101                 * load substitution status
          GOTO      LRXD9999
.
.         RXD.12 Total Daily Dose (CQ)
.
LRXD1200  BRANCH    COMPCNT,LRXD1201:            * quantity (CQ)
                            LRXD1202:            * interval (CM)
                            LRXD1203:            * duration
                            LRXD1204:            * start date/time (TS)
                            LRXD1205:            * end date/time (TS)
                            LRXD1206:            * priority (ID)
                            LRXD1207:            * rtext (TX)
                            LRXD1208:            * conjunction (ID)
                            LRXD1209             * order sequencing
          GOTO      LRXD9999
.
LRXD1201  APPEND    ANS,RXD01201                 * load quantity
          GOTO      LRXD9999
.
LRXD1202  APPEND    ANS,RXD01202                 * load interval
          GOTO      LRXD9999
.
LRXD1203  APPEND    ANS,RXD01203                 * load duration
          GOTO      LRXD9999
.
LRXD1204  APPEND    ANS,RXD01204                 * load start date/time
          GOTO      LRXD9999
.
LRXD1205  APPEND    ANS,RXD01205                 * load end date/time
          GOTO      LRXD9999
.
LRXD1206  APPEND    ANS,RXD01206                 * load priority
          GOTO      LRXD9999
.
LRXD1207  APPEND    ANS,RXD01207                 * load rtext
          GOTO      LRXD9999
.
LRXD1208  APPEND    ANS,RXD01208                 * load conjunction
          GOTO      LRXD9999
.
LRXD1209  APPEND    ANS,RXD01209                 * load order sequence
          GOTO      LRXD9999
.
.         RXD.13 Dispense-to Location (CM)
.
LRXD1300  BRANCH    COMPCNT,LRXD1301:            * point of care (IS)
                            LRXD1302:            * room (IS)
                            LRXD1303:            * bed (IS)
                            LRXD1304:            * facility (HD)
                            LRXD1305:            * location status (IS)
                            LRXD1306:            * patient location type (IS)
                            LRXD1307:            * building (IS)
                            LRXD1308:            * floor (IS)
                            LRXD1309:            * street address (ST)
                            LRXD1310:            * other designation (ST)
                            LRXD1311:            * city (ST)
                            LRXD1312:            * state or province (ST)
                            LRXD1313:            * zip or postal code (ST)
                            LRXD1314:            * country (ID)
                            LRXD1315:            * address type (ID)
                            LRXD1316             * other geographic desig. (ST)
          GOTO      LRXD9999
.
LRXD1301  APPEND    ANS,RXD01301                 * load point of care
          GOTO      LRXD9999
.
LRXD1302  APPEND    ANS,RXD01302                 * load room
          GOTO      LRXD9999
.
LRXD1303  APPEND    ANS,RXD01303                 * load bed
          GOTO      LRXD9999
.
LRXD1304  APPEND    ANS,RXD01304                 * load facility
          GOTO      LRXD9999
.
LRXD1305  APPEND    ANS,RXD01305                 * load location status
          GOTO      LRXD9999
.
LRXD1306  APPEND    ANS,RXD01306                 * load patient location type
          GOTO      LRXD9999
.
LRXD1307  APPEND    ANS,RXD01307                 * load building
          GOTO      LRXD9999
.
LRXD1308  APPEND    ANS,RXD01308                 * load floor
          GOTO      LRXD9999
.
LRXD1309  APPEND    ANS,RXD01309                 * load street address
          GOTO      LRXD9999
.
LRXD1310  APPEND    ANS,RXD01310                 * load other designation
          GOTO      LRXD9999
.
LRXD1311  APPEND    ANS,RXD01311                 * load city
          GOTO      LRXD9999
.
LRXD1312  APPEND    ANS,RXD01312                 * load state or province
          GOTO      LRXD9999
.
LRXD1313  APPEND    ANS,RXD01313                 * load zip or postal code
          GOTO      LRXD9999
.
LRXD1314  APPEND    ANS,RXD01314                 * load country
          GOTO      LRXD9999
.
LRXD1315  APPEND    ANS,RXD01315                 * load address type
          GOTO      LRXD9999
.
LRXD1316  APPEND    ANS,RXD01316                 * load other geographic desig.
          GOTO      LRXD9999
.
.         RXD.14 Needs Human Review (ID)
.
LRXD1400  BRANCH    COMPCNT,LRXD1401
          GOTO      LRXD9999
.
LRXD1401  APPEND    ANS,RXD01401                 * load needs human review
          GOTO      LRXD9999
.
.         RXD.15 Pharmacy/Treatment Supplier's Special Dispensing
.                Instructions (CE)
.
LRXD1500  BRANCH    COMPCNT,LRXD1501:            * identifier (ST)
                            LRXD1502:            * text (ST)
                            LRXD1503:            * name of coding system (ST)
                            LRXD1504:            * alternate identifier (ST)
                            LRXD1505:            * alternate text (ST)
                            LRXD1506             * name of alt. coding sys. (ST)
          GOTO      LRXD9999
.
LRXD1501  APPEND    ANS,RXD01501                 * load identifier (ST)
          GOTO      LRXD9999
.
LRXD1502  APPEND    ANS,RXD01502                 * load text (ST)
          GOTO      LRXD9999
.
LRXD1503  APPEND    ANS,RXD01503                 * load name of coding sys. (ST)
          GOTO      LRXD9999
.
LRXD1504  APPEND    ANS,RXD01504                 * load alt. identifier (ST)
          GOTO      LRXD9999
.
LRXD1505  APPEND    ANS,RXD01505                 * load alternate text (ST)
          GOTO      LRXD9999
.
LRXD1506  APPEND    ANS,RXD01506                 * load name alt. cod. sys. (ST)
          GOTO      LRXD9999
.
.         RXD.16 Actual Strength (NM)
.
LRXD1600  BRANCH    COMPCNT,LRXD1601
          GOTO      LRXD9999
.
LRXD1601  APPEND    ANS,RXD01601                 * load actual strength
          GOTO      LRXD9999
.
.         RXD.17 Actual Strength Unit (CE)
.
LRXD1700  BRANCH    COMPCNT,LRXD1701:            * identifier (ST)
                            LRXD1702:            * text (ST)
                            LRXD1703:            * name of coding system (ST)
                            LRXD1704:            * alternate identifier (ST)
                            LRXD1705:            * alternate text (ST)
                            LRXD1706             * name of alt. coding sys. (ST)
          GOTO      LRXD9999
.
LRXD1701  APPEND    ANS,RXD01701                 * load identifier (ST)
          GOTO      LRXD9999
.
LRXD1702  APPEND    ANS,RXD01702                 * load text (ST)
          GOTO      LRXD9999
.
LRXD1703  APPEND    ANS,RXD01703                 * load name of coding sys. (ST)
          GOTO      LRXD9999
.
LRXD1704  APPEND    ANS,RXD01704                 * load alt. identifier (ST)
          GOTO      LRXD9999
.
LRXD1705  APPEND    ANS,RXD01705                 * load alternate text (ST)
          GOTO      LRXD9999
.
LRXD1706  APPEND    ANS,RXD01706                 * load name alt. cod. sys. (ST)
          GOTO      LRXD9999
.
.         RXD.18 Substance Lot Number (ST)
.
LRXD1800  BRANCH    COMPCNT,LRXD1801
          GOTO      LRXD9999
.
LRXD1801  APPEND    ANS,RXD01801                 * load dispense notes
          GOTO      LRXD9999
.
.         RXD.19 Substance Expiration Date (TS)
.
LRXD1900  BRANCH    COMPCNT,LRXD1901
          GOTO      LRXD9999
.
LRXD1901  APPEND    ANS,RXD01901                 * load substance lot no.
          GOTO      LRXD9999
.
.         RXD.20 Substance Manufacturer Name (CE)
.
LRXD2000  BRANCH    COMPCNT,LRXD2001:            * identifier (ST)
                            LRXD2002:            * text (ST)
                            LRXD2003:            * name of coding system (ST)
                            LRXD2004:            * alternate identifier (ST)
                            LRXD2005:            * alternate text (ST)
                            LRXD2006             * name of alt. coding sys. (ST)
          GOTO      LRXD9999
.
LRXD2001  APPEND    ANS,RXD02001                 * load identifier (ST)
          GOTO      LRXD9999
.
LRXD2002  APPEND    ANS,RXD02002                 * load text (ST)
          GOTO      LRXD9999
.
LRXD2003  APPEND    ANS,RXD02003                 * load name of coding sys. (ST)
          GOTO      LRXD9999
.
LRXD2004  APPEND    ANS,RXD02004                 * load alt. identifier (ST)
          GOTO      LRXD9999
.
LRXD2005  APPEND    ANS,RXD02005                 * load alternate text (ST)
          GOTO      LRXD9999
.
LRXD2006  APPEND    ANS,RXD02006                 * load name alt. cod. sys. (ST)
          GOTO      LRXD9999
.
.         RXD.21 Indication (CE)
.
LRXD2100  BRANCH    COMPCNT,LRXD2101:            * identifier (ST)
                            LRXD2102:            * text (ST)
                            LRXD2103:            * name of coding system (ST)
                            LRXD2104:            * alternate identifier (ST)
                            LRXD2105:            * alternate text (ST)
                            LRXD2106             * name of alt. coding sys. (ST)
          GOTO      LRXD9999
.
LRXD2101  APPEND    ANS,RXD02101                 * load identifier (ST)
          GOTO      LRXD9999
.
LRXD2102  APPEND    ANS,RXD02102                 * load text (ST)
          GOTO      LRXD9999
.
LRXD2103  APPEND    ANS,RXD02103                 * load name of coding sys. (ST)
          GOTO      LRXD9999
.
LRXD2104  APPEND    ANS,RXD02104                 * load alt. identifier (ST)
          GOTO      LRXD9999
.
LRXD2105  APPEND    ANS,RXD02105                 * load alternate text (ST)
          GOTO      LRXD9999
.
LRXD2106  APPEND    ANS,RXD00206                 * load name alt. cod. sys. (ST)
          GOTO      LRXD9999
.
.         RXD.22 Dispense Package Size (NM)
.
LRXD2200  BRANCH    COMPCNT,LRXD2201
          GOTO      LRXD9999
.
LRXD2201  APPEND    ANS,RXD02201                 * load dispense package size
          GOTO      LRXD9999
.
.         RXD.23 Dispense Package Size Unit (CE)
.
LRXD2300  BRANCH    COMPCNT,LRXD2301:            * identifier (ST)
                            LRXD2302:            * text (ST)
                            LRXD2303:            * name of coding system (ST)
                            LRXD2304:            * alternate identifier (ST)
                            LRXD2305:            * alternate text (ST)
                            LRXD2306             * name of alt. coding sys. (ST)
          GOTO      LRXD9999
.
LRXD2301  APPEND    ANS,RXD02301                 * load identifier (ST)
          GOTO      LRXD9999
.
LRXD2302  APPEND    ANS,RXD02302                 * load text (ST)
          GOTO      LRXD9999
.
LRXD2303  APPEND    ANS,RXD02303                 * load name of coding sys. (ST)
          GOTO      LRXD9999
.
LRXD2304  APPEND    ANS,RXD02304                 * load alt. identifier (ST)
          GOTO      LRXD9999
.
LRXD2305  APPEND    ANS,RXD02305                 * load alternate text (ST)
          GOTO      LRXD9999
.
LRXD2306  APPEND    ANS,RXD02306                 * load name alt. cod. sys. (ST)
          GOTO      LRXD9999
.
.         RXD.24 Dispense Package Method (ID)
.
LRXD2400  BRANCH    COMPCNT,LRXD2401
          GOTO      LRXD9999
.
LRXD2401  APPEND    ANS,RXD02401                 * load dispense package method
          GOTO      LRXD9999
.
LRXD9999  RETURN
+
.*****************************************************************************
.*                                 LRXR0000        Called by: PROC0000       *
.*                          Load the RXR fields                              *
.*****************************************************************************
.
LRXR0000  BRANCH    FIELDNO,LRXR0100:            * Route
                            LRXR0200:            * Site
                            LRXR0300:            * Administration Device
                            LRXR0400:            * Administration Method
                            LRXR0500             * Routing Instruction
.
.         Invalid RXR field received, so ignore it
.
          GOTO      LRXR9999
.
.         RXR.1 Route (CE)
.
LRXR0100  BRANCH    COMPCNT,LRXR0101:            * identifier (ST)
                            LRXR0102:            * text (ST)
                            LRXR0103:            * name of coding system (ST)
                            LRXR0104:            * alternate identifier (ST)
                            LRXR0105:            * alternate text (ST)
                            LRXR0106             * name of alt. coding sys. (ST)
          GOTO      LRXR9999
.
LRXR0101  APPEND    ANS,RXR00101                 * load identifier (ST)
          GOTO      LRXR9999
.
LRXR0102  APPEND    ANS,RXR00102                 * load text (ST)
          GOTO      LRXR9999
.
LRXR0103  APPEND    ANS,RXR00103                 * load name of coding sys. (ST)
          GOTO      LRXR9999
.
LRXR0104  APPEND    ANS,RXR00104                 * load alt. identifier (ST)
          GOTO      LRXR9999
.
LRXR0105  APPEND    ANS,RXR00105                 * load alternate text (ST)
          GOTO      LRXR9999
.
LRXR0106  APPEND    ANS,RXR00106                 * load name alt. cod. sys. (ST)
          GOTO      LRXR9999
.
.         RXR.2 Site (CE)
.
LRXR0200  BRANCH    COMPCNT,LRXR0201:            * identifier (ST)
                            LRXR0202:            * text (ST)
                            LRXR0203:            * name of coding system (ST)
                            LRXR0204:            * alternate identifier (ST)
                            LRXR0205:            * alternate text (ST)
                            LRXR0206             * name of alt. coding sys. (ST)
          GOTO      LRXR9999
.
LRXR0201  APPEND    ANS,RXR00201                 * load identifier (ST)
          GOTO      LRXR9999
.
LRXR0202  APPEND    ANS,RXR00202                 * load text (ST)
          GOTO      LRXR9999
.
LRXR0203  APPEND    ANS,RXR00203                 * load name of coding sys. (ST)
          GOTO      LRXR9999
.
LRXR0204  APPEND    ANS,RXR00204                 * load alt. identifier (ST)
          GOTO      LRXR9999
.
LRXR0205  APPEND    ANS,RXR00205                 * load alternate text (ST)
          GOTO      LRXR9999
.
LRXR0206  APPEND    ANS,RXR00206                 * load name alt. cod. sys. (ST)
          GOTO      LRXR9999
.
.         RXR.3 Administration Device (CE)
.
LRXR0300  BRANCH    COMPCNT,LRXR0301:            * identifier (ST)
                            LRXR0302:            * text (ST)
                            LRXR0303:            * name of coding system (ST)
                            LRXR0304:            * alternate identifier (ST)
                            LRXR0305:            * alternate text (ST)
                            LRXR0306             * name of alt. coding sys. (ST)
          GOTO      LRXR9999
.
LRXR0301  APPEND    ANS,RXR00301                 * load identifier (ST)
          GOTO      LRXR9999
.
LRXR0302  APPEND    ANS,RXR00302                 * load text (ST)
          GOTO      LRXR9999
.
LRXR0303  APPEND    ANS,RXR00303                 * load name of coding sys. (ST)
          GOTO      LRXR9999
.
LRXR0304  APPEND    ANS,RXR00304                 * load alt. identifier (ST)
          GOTO      LRXR9999
.
LRXR0305  APPEND    ANS,RXR00305                 * load alternate text (ST)
          GOTO      LRXR9999
.
LRXR0306  APPEND    ANS,RXR00306                 * load name alt. cod. sys. (ST)
          GOTO      LRXR9999
.
.         RXR.4 Administration Method (CE)
.
LRXR0400  BRANCH    COMPCNT,LRXR0401:            * identifier (ST)
                            LRXR0402:            * text (ST)
                            LRXR0403:            * name of coding system (ST)
                            LRXR0404:            * alternate identifier (ST)
                            LRXR0405:            * alternate text (ST)
                            LRXR0406             * name of alt. coding sys. (ST)
          GOTO      LRXR9999
.
LRXR0401  APPEND    ANS,RXR00401                 * load identifier (ST)
          GOTO      LRXR9999
.
LRXR0402  APPEND    ANS,RXR00402                 * load text (ST)
          GOTO      LRXR9999
.
LRXR0403  APPEND    ANS,RXR00403                 * load name of coding sys. (ST)
          GOTO      LRXR9999
.
LRXR0404  APPEND    ANS,RXR00404                 * load alt. identifier (ST)
          GOTO      LRXR9999
.
LRXR0405  APPEND    ANS,RXR00405                 * load alternate text (ST)
          GOTO      LRXR9999
.
LRXR0406  APPEND    ANS,RXR00406                 * load name alt. cod. sys. (ST)
          GOTO      LRXR9999
.
.         RXR.5 Routing Instruction (CE)
.
LRXR0500  BRANCH    COMPCNT,LRXR0501:            * identifier (ST)
                            LRXR0502:            * text (ST)
                            LRXR0503:            * name of coding system (ST)
                            LRXR0504:            * alternate identifier (ST)
                            LRXR0505:            * alternate text (ST)
                            LRXR0506             * name of alt. coding sys. (ST)
          GOTO      LRXR9999
.
LRXR0501  APPEND    ANS,RXR00501                 * load identifier (ST)
          GOTO      LRXR9999
.
LRXR0502  APPEND    ANS,RXR00502                 * load text (ST)
          GOTO      LRXR9999
.
LRXR0503  APPEND    ANS,RXR00503                 * load name of coding sys. (ST)
          GOTO      LRXR9999
.
LRXR0504  APPEND    ANS,RXR00504                 * load alt. identifier (ST)
          GOTO      LRXR9999
.
LRXR0505  APPEND    ANS,RXR00505                 * load alternate text (ST)
          GOTO      LRXR9999
.
LRXR0506  APPEND    ANS,RXR00506                 * load name alt. cod. sys. (ST)
          GOTO      LRXR9999
.
LRXR9999  RETURN
+
.*****************************************************************************
.*                                 LOBR0000        Called by: PROC0000       *
.*                          Load the OBR fields                              *
.*****************************************************************************
.
LOBR0000  BRANCH    FIELDNO,LOBR0100:            * Set ID - OBR
                            LOBR0200:            * Placer Order Number
                            LOBR0300:            * Filler Order Number
                            LOBR0400:            * Universal Service ID
                            LOBR0500:            * Priority - OBR
                            LOBR0600:            * Requested Date/Time
                            LOBR0700:            * Observation Date/Time #
                            LOBR0800:            * Observation End Date/Time #
                            LOBR0900:            * Collection Volume
                            LOBR1000:            * Collector Identifier
                            LOBR1100:            * Specimen Action Code
                            LOBR1200:            * Danger Code
                            LOBR1300:            * Relevant Clinical Info
                            LOBR1400:            * Specimen Received Date/Time
                            LOBR1500:            * Specimen Source
                            LOBR1600:            * Ordering Provider
                            LOBR1700:            * Order Callback Phone Number
                            LOBR1800:            * Placer Field 1
                            LOBR1900:            * Placer Field 2
                            LOBR2000:            * Filler Field 1
                            LOBR2100:            * Filler Field 2
                            LOBR2200:            * Results Rpt/Status Chng -
.                                                  Date/Time
                            LOBR2300:            * Charge to Practice
                            LOBR2400:            * Diagnostic Serv Sect ID
                            LOBR2500:            * Result Status
                            LOBR2600:            * Parent Result
                            LOBR2700:            * Quantity/Timing
                            LOBR2800:            * Result Copies To
                            LOBR2900:            * Parent
                            LOBR3000:            * Transportation Mode
                            LOBR3100:            * Reason for Study
                            LOBR3200:            * Principal Result Interpreter
                            LOBR3300:            * Assistant Result Interpreter
                            LOBR3400:            * Technician
                            LOBR3500:            * Transcriptionist
                            LOBR3600:            * Scheduled Date/Time
                            LOBR3700:            * Number of Sample Containers
                            LOBR3800:            * Transport Logistics of
.                                                  Collected Sample
                            LOBR3900:            * Collector's Comment
                            LOBR4000:            * Transport Arrangement
.                                                  Responsibility
                            LOBR4100:            * Transport Arranged
                            LOBR4200:            * Escort Required
                            LOBR4300:            * Planned Patient Transport
.                                                  Comment
                            LOBR4400:            * Procedure Code
                            LOBR4500             * Procedure Code Modifier
.
.         Invalid OBR field received, so ignore it
.
.         OBR.1  Set ID (SI)
.
LOBR0100  BRANCH    COMPCNT,LOBR0101
          GOTO      LOBR9999
.
LOBR0101  APPEND    ANS,OBR00101
          GOTO      LOBR9999
.
.         OBR.2  Placer Order Number (EI)
.
LOBR0200  BRANCH    COMPCNT,LOBR0201:            * entity identifier (ST)
                            LOBR0202:            * namespace id (IS)
                            LOBR0203:            * universal id (ST)
                            LOBR0204             * universal id type (ID)
          GOTO      LOBR9999
.
LOBR0201  RESET     OBR00201                     * load entity identifier (ST)
          GOTO      LOBR9999
.
LOBR0202  RESET     OBR00202                     * load namespace id (IS)
          GOTO      LOBR9999
.
LOBR0203  RESET     OBR00203                     * load universal id (ST)
          GOTO      LOBR9999
.
LOBR0204  RESET     OBR00204                     * load universal id type (ID)
          GOTO      LOBR9999
.
.         OBR.3  Filler Order Number (EI)
.
LOBR0300  BRANCH    COMPCNT,LOBR0301:            * entity identifier (ST)
                            LOBR0302:            * namespace id (IS)
                            LOBR0303:            * universal id (ST)
                            LOBR0304             * universal id type (ID)
          GOTO      LOBR9999
.
LOBR0301  RESET     OBR00301                     * load entity identifier (ST)
          GOTO      LOBR9999
.
LOBR0302  RESET     OBR00302                     * load namespace id (IS)
          GOTO      LOBR9999
.
LOBR0303  RESET     OBR00303                     * load universal id (ST)
          GOTO      LOBR9999
.
LOBR0304  RESET     OBR00304                     * load universal id type (ID)
          GOTO      LOBR9999
.
.         OBR.4 Universal Service ID (CE)
.
LOBR0400  BRANCH    COMPCNT,LOBR0401:            * identifier (ST)
                            LOBR0402:            * text (ST)
                            LOBR0403:            * name of coding system (ST)
                            LOBR0404:            * alternate identifier (ST)
                            LOBR0405:            * alternate text (ST)
                            LOBR0406             * name of alt. cod. system (ST)
          GOTO      LOBR9999
.
LOBR0401  APPEND    ANS,OBR00401                 * load identifier (ST)
          GOTO      LOBR9999
.
LOBR0402  APPEND    ANS,OBR00402                 * load text (ST)
          GOTO      LOBR9999
.
LOBR0403  APPEND    ANS,OBR00403                 * load name of cod. system (ST)
          GOTO      LOBR9999
.
LOBR0404  APPEND    ANS,OBR00404                 * load alt. identifier (ST)
          GOTO      LOBR9999
.
LOBR0405  APPEND    ANS,OBR00405                 * load alternate text (ST)
          GOTO      LOBR9999
.
LOBR0406  APPEND    ANS,OBR00406                 * load alt. cod. sys. name (ST)
          GOTO      LOBR9999
.
.         OBR.5  Priority (ID)
.
LOBR0500  BRANCH    COMPCNT,LOBR0501
          GOTO      LOBR9999
.
LOBR0501  APPEND    ANS,OBR00501
          GOTO      LOBR9999
.
.         OBR.6  Requested Date/Time (TS)
.
LOBR0600  BRANCH    COMPCNT,LOBR0601
          GOTO      LOBR9999
.
LOBR0601  APPEND    ANS,OBR00601
          GOTO      LOBR9999
.
.         OBR.7  Observation Date/Time (TS)
.
LOBR0700  BRANCH    COMPCNT,LOBR0701
          GOTO      LOBR9999
.
LOBR0701  APPEND    ANS,OBR00701
          GOTO      LOBR9999
.
.         OBR.8  Observation End Date/Time (TS)
.
LOBR0800  BRANCH    COMPCNT,LOBR0801
          GOTO      LOBR9999
.
LOBR0801  APPEND    ANS,OBR00801
          GOTO      LOBR9999
.
.         OBR.9 Collection Volume (CQ)
.
LOBR0900  BRANCH    COMPCNT,LOBR0901:            * quantity (NM)
                            LOBR0902             * units (CE)
.
LOBR0901  APPEND    ANS,OBR00901                 * load quantity (NM)
          GOTO      LOBR9999
.
LOBR0902  APPEND    ANS,OBR00902                 * load units (CE)
          GOTO      LOBR9999
.
.         OBR.10 Collector Identifier (XCN)
.
LOBR1000  BRANCH    COMPCNT,LOBR1001:            * id number (ST)
                            LOBR1002:            * family name (ST)
                            LOBR1003:            * given name (ST)
                            LOBR1004:            * middle name (ST)
                            LOBR1005:            * suffix (ST)
                            LOBR1006:            * prefix (ST)
                            LOBR1007:            * degree (IS)
                            LOBR1008:            * source table (IS)
                            LOBR1009:            * assigning authority (HD)
                            LOBR1010:            * name type code (ID)
                            LOBR1011:            * identifier check digit (ST)
                            LOBR1012:            * check digit scheme code (ID)
                            LOBR1013:            * identifier type code (IS)
                            LOBR1014:            * assigning facility (HD)
                            LOBR1015             * name representation code (ID)
          GOTO      LOBR9999
.
LOBR1001  APPEND    ANS,OBR01001                 * load id number (ST)
          GOTO      LOBR9999
.
LOBR1002  APPEND    ANS,OBR01002                 * load family name (ST)
          GOTO      LOBR9999
.
LOBR1003  APPEND    ANS,OBR01003                 * load given name (ST)
          GOTO      LOBR9999
.
LOBR1004  APPEND    ANS,OBR01004                 * load middle name (ST)
          GOTO      LOBR9999
.
LOBR1005  APPEND    ANS,OBR01005                 * load suffix (ST)
          GOTO      LOBR9999
.
LOBR1006  APPEND    ANS,OBR01006                 * load prefix (ST)
          GOTO      LOBR9999
.
LOBR1007  APPEND    ANS,OBR01007                 * load degree (IS)
          GOTO      LOBR9999
.
LOBR1008  APPEND    ANS,OBR01008                 * load source table (IS)
          GOTO      LOBR9999
.
LOBR1009  APPEND    ANS,OBR01009                 * load assigning authority (HD)
          GOTO      LOBR9999
.
LOBR1010  APPEND    ANS,OBR01010                 * load name type code (ID)
          GOTO      LOBR9999
.
LOBR1011  APPEND    ANS,OBR01011                 * load ident. check digit (ST)
          GOTO      LOBR9999
.
LOBR1012  APPEND    ANS,OBR01012                 * load chk dig scheme code (ID)
          GOTO      LOBR9999
.
LOBR1013  APPEND    ANS,OBR01013                 * load ident. type code (IS)
          GOTO      LOBR9999
.
LOBR1014  APPEND    ANS,OBR01014                 * load assigning facility (HD)
          GOTO      LOBR9999
.
LOBR1015  APPEND    ANS,OBR01015                 * load name repres. code (ID)
          GOTO      LOBR9999
.
.         OBR.11  Specimen Action Code (ID)
.
LOBR1100  BRANCH    COMPCNT,LOBR1101
          GOTO      LOBR9999
.
LOBR1101  APPEND    ANS,OBR01101
          GOTO      LOBR9999
.
.         OBR.12 Danger Code (CE)
.
LOBR1200  BRANCH    COMPCNT,LOBR1201:            * identifier (ST)
                            LOBR1202:            * text (ST)
                            LOBR1203:            * name of coding system (ST)
                            LOBR1204:            * alternate identifier (ST)
                            LOBR1205:            * alternate text (ST)
                            LOBR1206             * name of alt. cod. system (ST)
          GOTO      LOBR9999
.
LOBR1201  APPEND    ANS,OBR01201                 * load identifier (ST)
          GOTO      LOBR9999
.
LOBR1202  APPEND    ANS,OBR01202                 * load text (ST)
          GOTO      LOBR9999
.
LOBR1203  APPEND    ANS,OBR01203                 * load name of cod. system (ST)
          GOTO      LOBR9999
.
LOBR1204  APPEND    ANS,OBR01204                 * load alt. identifier (ST)
          GOTO      LOBR9999
.
LOBR1205  APPEND    ANS,OBR01205                 * load alternate text (ST)
          GOTO      LOBR9999
.
LOBR1206  APPEND    ANS,OBR01206                 * load alt. cod. sys. name (ST)
          GOTO      LOBR9999
.
.         OBR.13  Relevant Clinical Info (ST)
.
LOBR1300  BRANCH    COMPCNT,LOBR1301
          GOTO      LOBR9999
.
LOBR1301  APPEND    ANS,OBR01301
          GOTO      LOBR9999
.
.         OBR.14  Specimen Received Date/Time (TS)
.
LOBR1400  BRANCH    COMPCNT,LOBR1401
          GOTO      LOBR9999
.
LOBR1401  APPEND    ANS,OBR01401
          GOTO      LOBR9999
.
.         OBR.15 Specimen Source (CM)
.
LOBR1500  BRANCH    COMPCNT,LOBR1501:            * specimen source code (CE)
                            LOBR1502:            * additives (TX)
                            LOBR1503:            * freetext (TX)
                            LOBR1504:            * body site (CE)
                            LOBR1505:            * site modifier (CE)
                            LOBR1506:            * coll. method modifier (CE)
.
LOBR1501  APPEND    ANS,OBR01501                 * load spec. source code (CE)
          GOTO      LOBR9999
.
LOBR1502  APPEND    ANS,OBR01502                 * load additives (TX)
          GOTO      LOBR9999
.
LOBR1503  APPEND    ANS,OBR01503                 * load freetext (TX)
          GOTO      LOBR9999
.
LOBR1504  APPEND    ANS,OBR01504                 * load body site (CE)
          GOTO      LOBR9999
.
LOBR1505  APPEND    ANS,OBR01505                 * load site modifier (CE)
          GOTO      LOBR9999
.
LOBR1506  APPEND    ANS,OBR01506                 * load coll. method mod. (CE)
          GOTO      LOBR9999
.
.         OBR.16 Ordering Provider (XCN)
.
LOBR1600  BRANCH    COMPCNT,LOBR1601:            * id number (ST)
                            LOBR1602:            * family name (ST)
                            LOBR1603:            * given name (ST)
                            LOBR1604:            * middle name (ST)
                            LOBR1605:            * suffix (ST)
                            LOBR1606:            * prefix (ST)
                            LOBR1607:            * degree (IS)
                            LOBR1608:            * source table (IS)
                            LOBR1609:            * assigning authority (HD)
                            LOBR1610:            * name type code (ID)
                            LOBR1611:            * identifier check digit (ST)
                            LOBR1612:            * check digit scheme code (ID)
                            LOBR1613:            * identifier type code (IS)
                            LOBR1614:            * assigning facility (HD)
                            LOBR1615             * name representation code (ID)
          GOTO      LOBR9999
.
LOBR1601  APPEND    ANS,OBR01601                 * load id number (ST)
          GOTO      LOBR9999
.
LOBR1602  APPEND    ANS,OBR01602                 * load family name (ST)
          GOTO      LOBR9999
.
LOBR1603  APPEND    ANS,OBR01603                 * load given name (ST)
          GOTO      LOBR9999
.
LOBR1604  APPEND    ANS,OBR01604                 * load middle name (ST)
          GOTO      LOBR9999
.
LOBR1605  APPEND    ANS,OBR01605                 * load suffix (ST)
          GOTO      LOBR9999
.
LOBR1606  APPEND    ANS,OBR01606                 * load prefix (ST)
          GOTO      LOBR9999
.
LOBR1607  APPEND    ANS,OBR01607                 * load degree (IS)
          GOTO      LOBR9999
.
LOBR1608  APPEND    ANS,OBR01608                 * load source table (IS)
          GOTO      LOBR9999
.
LOBR1609  APPEND    ANS,OBR01609                 * load assigning authority (HD)
          GOTO      LOBR9999
.
LOBR1610  APPEND    ANS,OBR01610                 * load name type code (ID)
          GOTO      LOBR9999
.
LOBR1611  APPEND    ANS,OBR01611                 * load ident. check digit (ST)
          GOTO      LOBR9999
.
LOBR1612  APPEND    ANS,OBR01612                 * load chk dig scheme code (ID)
          GOTO      LOBR9999
.
LOBR1613  APPEND    ANS,OBR01613                 * load ident. type code (IS)
          GOTO      LOBR9999
.
LOBR1614  APPEND    ANS,OBR01614                 * load assigning facility (HD)
          GOTO      LOBR9999
.
LOBR1615  APPEND    ANS,OBR01615                 * load name repres. code (ID)
          GOTO      LOBR9999
.
.         OBR.17 Order Callback Phone Number (XTN)
.
LOBR1700  BRANCH    COMPCNT,LOBR1701:            * text
                            LOBR1702:            * telecomm. use code (ID)
                            LOBR1703:            * telcomm. equipment type (ID)
                            LOBR1704:            * email address (ST)
                            LOBR1705:            * country code (NM)
                            LOBR1706:            * area/city code (NM)
                            LOBR1707:            * phone number (NM)
                            LOBR1708:            * extension (NM)
                            LOBR1709             * any text (ST)
          GOTO      LOBR9999
.
LOBR1701  RESET     OBR01701                     * load text
          GOTO      LOBR9999
.
LOBR1702  RESET     OBR01702                     * load telecomm. use code (ID)
          GOTO      LOBR9999
.
LOBR1703  RESET     OBR01703                     * load telcomm. equip.type (ID)
          GOTO      LOBR9999
.
LOBR1704  RESET     OBR01704                     * load email address (ST)
          GOTO      LOBR9999
.
LOBR1705  RESET     OBR01705                     * load country code (NM)
          GOTO      LOBR9999
.
LOBR1706  RESET     OBR01706                     * load area/city code (NM)
          GOTO      LOBR9999
.
LOBR1707  RESET     OBR01707                     * load phone number (NM)
          GOTO      LOBR9999
.
LOBR1708  RESET     OBR01708                     * load extension (NM)
          GOTO      LOBR9999
.
LOBR1709  RESET     OBR01709                     * load any text (ST)
          GOTO      LOBR9999
.
.         OBR.18  Placer Field 1 (ST)
.
LOBR1800  BRANCH    COMPCNT,LOBR1801
          GOTO      LOBR9999
.
LOBR1801  APPEND    ANS,OBR01801
          GOTO      LOBR9999
.
.         OBR.19  Placer Field 2 (ST)
.
LOBR1900  BRANCH    COMPCNT,LOBR1901
          GOTO      LOBR9999
.
LOBR1901  APPEND    ANS,OBR01901
          GOTO      LOBR9999
.
.         OBR.20  Filler Field 1 (ST)
.
LOBR2000  BRANCH    COMPCNT,LOBR2001
          GOTO      LOBR9999
.
LOBR2001  APPEND    ANS,OBR02001
          GOTO      LOBR9999
.
.         OBR.21  Filler Field 2 (ST)
.
LOBR2100  BRANCH    COMPCNT,LOBR2101
          GOTO      LOBR9999
.
LOBR2101  APPEND    ANS,OBR02101
          GOTO      LOBR9999
.
.         OBR.22  Results Rpt/Status Chng - Date/Time (TS)
.
LOBR2200  BRANCH    COMPCNT,LOBR2201
          GOTO      LOBR9999
.
LOBR2201  APPEND    ANS,OBR02201
          GOTO      LOBR9999
.
.         OBR.23 Charge to Practice (CM)
.
LOBR2300  BRANCH    COMPCNT,LOBR2301:            * dollar amount (MO)
                            LOBR2302             * charge code (CE)
.
LOBR2301  APPEND    ANS,OBR02301                 * load dollar amount
          GOTO      LOBR9999
.
LOBR2302  APPEND    ANS,OBR02302                 * load charge code
          GOTO      LOBR9999
.
.         OBR.24  Diagnostic Serv Sect ID (ID)
.
LOBR2400  BRANCH    COMPCNT,LOBR2401
          GOTO      LOBR9999
.
LOBR2401  APPEND    ANS,OBR02401
          GOTO      LOBR9999
.
.         OBR.25  Result Status (ID)
.
LOBR2500  BRANCH    COMPCNT,LOBR2501
          GOTO      LOBR9999
.
LOBR2501  APPEND    ANS,OBR02501
          GOTO      LOBR9999
.
.         OBR.26 Parent Result (CM)
.
LOBR2600  BRANCH    COMPCNT,LOBR2601:            * OBX.3 obs. identifier (CE)
                            LOBR2602:            * OBX.4 sub-id (ST)
                            LOBR2603             * part of OBX.5 obs. (TX)
.
LOBR2601  APPEND    ANS,OBR02601                 * load obs. identifier (CE)
          GOTO      LOBR9999
.
LOBR2602  APPEND    ANS,OBR02602                 * load sub-id (ST)
          GOTO      LOBR9999
.
LOBR2603  APPEND    ANS,OBR02603                 * load obs. (TX)
          GOTO      LOBR9999
.
.         OBR.27 Quantity/Timing (TQ)
.
LOBR2700  BRANCH    COMPCNT,LOBR2701:            * quantity (CQ)
                            LOBR2702:            * interval (CM)
                            LOBR2703:            * duration (ST)
                            LOBR2704:            * start date/time (TS)
                            LOBR2705:            * end date/time (TS)
                            LOBR2706:            * priority (ST)
                            LOBR2707:            * condition (ST)
                            LOBR2708:            * text (TX)
                            LOBR2709:            * conjunction (ST)
                            LOBR2710:            * order sequencing (CM)
                            LOBR2711:            * occurence duration (CE)
                            LOBR2712             * total occurrences (NM)
.
LOBR2701  APPEND    ANS,OBR02701                 * load quantity (CQ)
          GOTO      LOBR9999
.
LOBR2702  APPEND    ANS,OBR02702                 * load interval (CM)
          GOTO      LOBR9999
.
LOBR2703  APPEND    ANS,OBR02703                 * load duration (ST)
          GOTO      LOBR9999
.
LOBR2704  APPEND    ANS,OBR02704                 * load start date/time (TS)
          GOTO      LOBR9999
.
LOBR2705  APPEND    ANS,OBR02705                 * load end date/time (TS)
          GOTO      LOBR9999
.
LOBR2706  APPEND    ANS,OBR02706                 * load priority (ST)
          GOTO      LOBR9999
.
LOBR2707  APPEND    ANS,OBR02707                 * load condition (ST)
          GOTO      LOBR9999
.
LOBR2708  APPEND    ANS,OBR02708                 * load text (TX)
          GOTO      LOBR9999
.
LOBR2709  APPEND    ANS,OBR02709                 * load conjunction (ST)
          GOTO      LOBR9999
.
LOBR2710  APPEND    ANS,OBR02710                 * load order sequencing (CM)
          GOTO      LOBR9999
.
LOBR2711  APPEND    ANS,OBR02711                 * load occurence duration (CE)
          GOTO      LOBR9999
.
LOBR2712  APPEND    ANS,OBR02712                 * load total occurrences (NM)
          GOTO      LOBR9999
.
.         OBR.28 Result Copies To (XCN)
.
LOBR2800  BRANCH    COMPCNT,LOBR2801:            * id number (ST)
                            LOBR2802:            * family name (ST)
                            LOBR2803:            * given name (ST)
                            LOBR2804:            * middle name (ST)
                            LOBR2805:            * suffix (ST)
                            LOBR2806:            * prefix (ST)
                            LOBR2807:            * degree (IS)
                            LOBR2808:            * source table (IS)
                            LOBR2809:            * assigning authority (HD)
                            LOBR2810:            * name type code (ID)
                            LOBR2811:            * identifier check digit (ST)
                            LOBR2812:            * check digit scheme code (ID)
                            LOBR2813:            * identifier type code (IS)
                            LOBR2814:            * assigning facility (HD)
                            LOBR2815             * name representation code (ID)
          GOTO      LOBR9999
.
LOBR2801  APPEND    ANS,OBR02801                 * load id number (ST)
          GOTO      LOBR9999
.
LOBR2802  APPEND    ANS,OBR02802                 * load family name (ST)
          GOTO      LOBR9999
.
LOBR2803  APPEND    ANS,OBR02803                 * load given name (ST)
          GOTO      LOBR9999
.
LOBR2804  APPEND    ANS,OBR02804                 * load middle name (ST)
          GOTO      LOBR9999
.
LOBR2805  APPEND    ANS,OBR02805                 * load suffix (ST)
          GOTO      LOBR9999
.
LOBR2806  APPEND    ANS,OBR02806                 * load prefix (ST)
          GOTO      LOBR9999
.
LOBR2807  APPEND    ANS,OBR02807                 * load degree (IS)
          GOTO      LOBR9999
.
LOBR2808  APPEND    ANS,OBR02808                 * load source table (IS)
          GOTO      LOBR9999
.
LOBR2809  APPEND    ANS,OBR02809                 * load assigning authority (HD)
          GOTO      LOBR9999
.
LOBR2810  APPEND    ANS,OBR02810                 * load name type code (ID)
          GOTO      LOBR9999
.
LOBR2811  APPEND    ANS,OBR02811                 * load ident. check digit (ST)
          GOTO      LOBR9999
.
LOBR2812  APPEND    ANS,OBR02812                 * load chk dig scheme code (ID)
          GOTO      LOBR9999
.
LOBR2813  APPEND    ANS,OBR02813                 * load ident. type code (IS)
          GOTO      LOBR9999
.
LOBR2814  APPEND    ANS,OBR02814                 * load assigning facility (HD)
          GOTO      LOBR9999
.
LOBR2815  APPEND    ANS,OBR02815                 * load name repres. code (ID)
          GOTO      LOBR9999
.
.         OBR.29 Parent (CM)
.
LOBR2900  BRANCH    COMPCNT,LOBR2901:            * parent's placer order # (EI)
                            LOBR2902             * parent's filler order # (EI)
.
LOBR2901  APPEND    ANS,OBR02901                 * load parent's placer order #
          GOTO      LOBR9999
.
LOBR2902  APPEND    ANS,OBR02902                 * load parent's filler order #
          GOTO      LOBR9999
.
.         OBR.30  Transportation Mode (ID)
.
LOBR3000  BRANCH    COMPCNT,LOBR3001
          GOTO      LOBR9999
.
LOBR3001  APPEND    ANS,OBR03001
          GOTO      LOBR9999
.
.         OBR.31 Reason for Study (CE)
.
LOBR3100  BRANCH    COMPCNT,LOBR3101:            * identifier (ST)
                            LOBR3102:            * text (ST)
                            LOBR3103:            * name of coding system (ST)
                            LOBR3104:            * alternate identifier (ST)
                            LOBR3105:            * alternate text (ST)
                            LOBR3106             * name of alt. cod. system (ST)
          GOTO      LOBR9999
.
LOBR3101  APPEND    ANS,OBR03101                 * load identifier (ST)
          GOTO      LOBR9999
.
LOBR3102  APPEND    ANS,OBR03102                 * load text (ST)
          GOTO      LOBR9999
.
LOBR3103  APPEND    ANS,OBR03103                 * load name of cod. system (ST)
          GOTO      LOBR9999
.
LOBR3104  APPEND    ANS,OBR03104                 * load alt. identifier (ST)
          GOTO      LOBR9999
.
LOBR3105  APPEND    ANS,OBR03105                 * load alternate text (ST)
          GOTO      LOBR9999
.
LOBR3106  APPEND    ANS,OBR03106                 * load alt. cod. sys. name (ST)
          GOTO      LOBR9999
.
.         OBR.32 Principal Result Interpreter (CM)
.
LOBR3200  BRANCH    COMPCNT,LOBR3201:            * name (CN)
                            LOBR3202:            * start date/time (TS)
                            LOBR3203:            * end date/time (TS)
                            LOBR3204:            * point of care (IS)
                            LOBR3205:            * room (IS)
                            LOBR3206:            * bed (IS)
                            LOBR3207:            * facility (HD)
                            LOBR3208:            * location status (IS)
                            LOBR3209:            * patient location (IS)
                            LOBR3210:            * building (IS)
                            LOBR3211             * floor (IS)
.
LOBR3201  APPEND    ANS,OBR03201                 * load name (CN)
          GOTO      LOBR9999
.
LOBR3202  APPEND    ANS,OBR03202                 * load start date/time (TS)
          GOTO      LOBR9999
.
LOBR3203  APPEND    ANS,OBR03203                 * load end date/time (TS)
          GOTO      LOBR9999
.
LOBR3204  APPEND    ANS,OBR03204                 * load point of care (IS)
          GOTO      LOBR9999
.
LOBR3205  APPEND    ANS,OBR03205                 * load room (IS)
          GOTO      LOBR9999
.
LOBR3206  APPEND    ANS,OBR03206                 * load bed (IS)
          GOTO      LOBR9999
.
LOBR3207  APPEND    ANS,OBR03207                 * load facility (HD)
          GOTO      LOBR9999
.
LOBR3208  APPEND    ANS,OBR03208                 * load location status (IS)
          GOTO      LOBR9999
.
LOBR3209  APPEND    ANS,OBR03209                 * load patient location (IS)
          GOTO      LOBR9999
.
LOBR3210  APPEND    ANS,OBR03210                 * load building (IS)
          GOTO      LOBR9999
.
LOBR3211  APPEND    ANS,OBR03211                 * load floor (IS)
          GOTO      LOBR9999
.
.         OBR.33 Assistant Result Interpreter (CM)
.
LOBR3300  BRANCH    COMPCNT,LOBR3301:            * name (CN)
                            LOBR3302:            * start date/time (TS)
                            LOBR3303:            * end date/time (TS)
                            LOBR3304:            * point of care (IS)
                            LOBR3305:            * room (IS)
                            LOBR3306:            * bed (IS)
                            LOBR3307:            * facility (HD)
                            LOBR3308:            * location status (IS)
                            LOBR3309:            * patient location (IS)
                            LOBR3310:            * building (IS)
                            LOBR3311             * floor (IS)
.
LOBR3301  APPEND    ANS,OBR03301                 * load name (CN)
          GOTO      LOBR9999
.
LOBR3302  APPEND    ANS,OBR03302                 * load start date/time (TS)
          GOTO      LOBR9999
.
LOBR3303  APPEND    ANS,OBR03303                 * load end date/time (TS)
          GOTO      LOBR9999
.
LOBR3304  APPEND    ANS,OBR03304                 * load point of care (IS)
          GOTO      LOBR9999
.
LOBR3305  APPEND    ANS,OBR03305                 * load room (IS)
          GOTO      LOBR9999
.
LOBR3306  APPEND    ANS,OBR03306                 * load bed (IS)
          GOTO      LOBR9999
.
LOBR3307  APPEND    ANS,OBR03307                 * load facility (HD)
          GOTO      LOBR9999
.
LOBR3308  APPEND    ANS,OBR03308                 * load location status (IS)
          GOTO      LOBR9999
.
LOBR3309  APPEND    ANS,OBR03309                 * load patient location (IS)
          GOTO      LOBR9999
.
LOBR3310  APPEND    ANS,OBR03310                 * load building (IS)
          GOTO      LOBR9999
.
LOBR3311  APPEND    ANS,OBR03311                 * load floor (IS)
          GOTO      LOBR9999
.
.         OBR.34 Technician (CM)
.
LOBR3400  BRANCH    COMPCNT,LOBR3401:            * name (CN)
                            LOBR3402:            * start date/time (TS)
                            LOBR3403:            * end date/time (TS)
                            LOBR3404:            * point of care (IS)
                            LOBR3405:            * room (IS)
                            LOBR3406:            * bed (IS)
                            LOBR3407:            * facility (HD)
                            LOBR3408:            * location status (IS)
                            LOBR3409:            * patient location (IS)
                            LOBR3410:            * building (IS)
                            LOBR3411             * floor (IS)
.
LOBR3401  APPEND    ANS,OBR03401                 * load name (CN)
          GOTO      LOBR9999
.
LOBR3402  APPEND    ANS,OBR03402                 * load start date/time (TS)
          GOTO      LOBR9999
.
LOBR3403  APPEND    ANS,OBR03403                 * load end date/time (TS)
          GOTO      LOBR9999
.
LOBR3404  APPEND    ANS,OBR03404                 * load point of care (IS)
          GOTO      LOBR9999
.
LOBR3405  APPEND    ANS,OBR03405                 * load room (IS)
          GOTO      LOBR9999
.
LOBR3406  APPEND    ANS,OBR03406                 * load bed (IS)
          GOTO      LOBR9999
.
LOBR3407  APPEND    ANS,OBR03407                 * load facility (HD)
          GOTO      LOBR9999
.
LOBR3408  APPEND    ANS,OBR03408                 * load location status (IS)
          GOTO      LOBR9999
.
LOBR3409  APPEND    ANS,OBR03409                 * load patient location (IS)
          GOTO      LOBR9999
.
LOBR3410  APPEND    ANS,OBR03410                 * load building (IS)
          GOTO      LOBR9999
.
LOBR3411  APPEND    ANS,OBR03411                 * load floor (IS)
          GOTO      LOBR9999
.
.         OBR.35 Transcriptionist (CM)
.
LOBR3500  BRANCH    COMPCNT,LOBR3501:            * name (CN)
                            LOBR3502:            * start date/time (TS)
                            LOBR3503:            * end date/time (TS)
                            LOBR3504:            * point of care (IS)
                            LOBR3505:            * room (IS)
                            LOBR3506:            * bed (IS)
                            LOBR3507:            * facility (HD)
                            LOBR3508:            * location status (IS)
                            LOBR3509:            * patient location (IS)
                            LOBR3510:            * building (IS)
                            LOBR3511             * floor (IS)
.
LOBR3501  APPEND    ANS,OBR03501                 * load name (CN)
          GOTO      LOBR9999
.
LOBR3502  APPEND    ANS,OBR03502                 * load start date/time (TS)
          GOTO      LOBR9999
.
LOBR3503  APPEND    ANS,OBR03503                 * load end date/time (TS)
          GOTO      LOBR9999
.
LOBR3504  APPEND    ANS,OBR03504                 * load point of care (IS)
          GOTO      LOBR9999
.
LOBR3505  APPEND    ANS,OBR03505                 * load room (IS)
          GOTO      LOBR9999
.
LOBR3506  APPEND    ANS,OBR03506                 * load bed (IS)
          GOTO      LOBR9999
.
LOBR3507  APPEND    ANS,OBR03507                 * load facility (HD)
          GOTO      LOBR9999
.
LOBR3508  APPEND    ANS,OBR03508                 * load location status (IS)
          GOTO      LOBR9999
.
LOBR3509  APPEND    ANS,OBR03509                 * load patient location (IS)
          GOTO      LOBR9999
.
LOBR3510  APPEND    ANS,OBR03510                 * load building (IS)
          GOTO      LOBR9999
.
LOBR3511  APPEND    ANS,OBR03511                 * load floor (IS)
          GOTO      LOBR9999
.
.         OBR.36  Scheduled Date/Time (TS)
.
LOBR3600  BRANCH    COMPCNT,LOBR3601
          GOTO      LOBR9999
.
LOBR3601  APPEND    ANS,OBR03601
          GOTO      LOBR9999
.
.         OBR.37  Number of Sample Containers (NM)
.
LOBR3700  BRANCH    COMPCNT,LOBR3701
          GOTO      LOBR9999
.
LOBR3701  APPEND    ANS,OBR03701
          GOTO      LOBR9999
.
.         OBR.38 Reason for Study (CE)
.
LOBR3800  BRANCH    COMPCNT,LOBR3801:            * identifier (ST)
                            LOBR3802:            * text (ST)
                            LOBR3803:            * name of coding system (ST)
                            LOBR3804:            * alternate identifier (ST)
                            LOBR3805:            * alternate text (ST)
                            LOBR3806             * name of alt. cod. system (ST)
          GOTO      LOBR9999
.
LOBR3801  APPEND    ANS,OBR03801                 * load identifier (ST)
          GOTO      LOBR9999
.
LOBR3802  APPEND    ANS,OBR03802                 * load text (ST)
          GOTO      LOBR9999
.
LOBR3803  APPEND    ANS,OBR03803                 * load name of cod. system (ST)
          GOTO      LOBR9999
.
LOBR3804  APPEND    ANS,OBR03804                 * load alt. identifier (ST)
          GOTO      LOBR9999
.
LOBR3805  APPEND    ANS,OBR03805                 * load alternate text (ST)
          GOTO      LOBR9999
.
LOBR3806  APPEND    ANS,OBR03806                 * load alt. cod. sys. name (ST)
          GOTO      LOBR9999
.
.         OBR.39 Collector's Comment (CE)
.
LOBR3900  BRANCH    COMPCNT,LOBR3901:            * identifier (ST)
                            LOBR3902:            * text (ST)
                            LOBR3903:            * name of coding system (ST)
                            LOBR3904:            * alternate identifier (ST)
                            LOBR3905:            * alternate text (ST)
                            LOBR3906             * name of alt. cod. system (ST)
          GOTO      LOBR9999
.
LOBR3901  APPEND    ANS,OBR03901                 * load identifier (ST)
          GOTO      LOBR9999
.
LOBR3902  APPEND    ANS,OBR03902                 * load text (ST)
          GOTO      LOBR9999
.
LOBR3903  APPEND    ANS,OBR03903                 * load name of cod. system (ST)
          GOTO      LOBR9999
.
LOBR3904  APPEND    ANS,OBR03904                 * load alt. identifier (ST)
          GOTO      LOBR9999
.
LOBR3905  APPEND    ANS,OBR03905                 * load alternate text (ST)
          GOTO      LOBR9999
.
LOBR3906  APPEND    ANS,OBR03906                 * load alt. cod. sys. name (ST)
          GOTO      LOBR9999
.
.         OBR.40 Transport Arrangement Responsibility (CE)
.
LOBR4000  BRANCH    COMPCNT,LOBR4001:            * identifier (ST)
                            LOBR4002:            * text (ST)
                            LOBR4003:            * name of coding system (ST)
                            LOBR4004:            * alternate identifier (ST)
                            LOBR4005:            * alternate text (ST)
                            LOBR4006             * name of alt. cod. system (ST)
          GOTO      LOBR9999
.
LOBR4001  APPEND    ANS,OBR04001                 * load identifier (ST)
          GOTO      LOBR9999
.
LOBR4002  APPEND    ANS,OBR04002                 * load text (ST)
          GOTO      LOBR9999
.
LOBR4003  APPEND    ANS,OBR04003                 * load name of cod. system (ST)
          GOTO      LOBR9999
.
LOBR4004  APPEND    ANS,OBR04004                 * load alt. identifier (ST)
          GOTO      LOBR9999
.
LOBR4005  APPEND    ANS,OBR04005                 * load alternate text (ST)
          GOTO      LOBR9999
.
LOBR4006  APPEND    ANS,OBR04006                 * load alt. cod. sys. name (ST)
          GOTO      LOBR9999
.
.         OBR.41  Transport Arranged (ID)
.
LOBR4100  BRANCH    COMPCNT,LOBR4101
          GOTO      LOBR9999
.
LOBR4101  APPEND    ANS,OBR04101
          GOTO      LOBR9999
.
.         OBR.42  Escort Required (ID)
.
LOBR4200  BRANCH    COMPCNT,LOBR4201
          GOTO      LOBR9999
.
LOBR4201  APPEND    ANS,OBR04201
          GOTO      LOBR9999
.
.         OBR.43 Planned Patient Transport Comment (CE)
.
LOBR4300  BRANCH    COMPCNT,LOBR4301:            * identifier (ST)
                            LOBR4302:            * text (ST)
                            LOBR4303:            * name of coding system (ST)
                            LOBR4304:            * alternate identifier (ST)
                            LOBR4305:            * alternate text (ST)
                            LOBR4306             * name of alt. cod. system (ST)
          GOTO      LOBR9999
.
LOBR4301  APPEND    ANS,OBR04301                 * load identifier (ST)
          GOTO      LOBR9999
.
LOBR4302  APPEND    ANS,OBR04302                 * load text (ST)
          GOTO      LOBR9999
.
LOBR4303  APPEND    ANS,OBR04303                 * load name of cod. system (ST)
          GOTO      LOBR9999
.
LOBR4304  APPEND    ANS,OBR04304                 * load alt. identifier (ST)
          GOTO      LOBR9999
.
LOBR4305  APPEND    ANS,OBR04305                 * load alternate text (ST)
          GOTO      LOBR9999
.
LOBR4306  APPEND    ANS,OBR04306                 * load alt. cod. sys. name (ST)
          GOTO      LOBR9999
.
.         OBR.44 Procedure Code (CE)
.
LOBR4400  BRANCH    COMPCNT,LOBR4401:            * identifier (ST)
                            LOBR4402:            * text (ST)
                            LOBR4403:            * name of coding system (ST)
                            LOBR4404:            * alternate identifier (ST)
                            LOBR4405:            * alternate text (ST)
                            LOBR4406             * name of alt. cod. system (ST)
          GOTO      LOBR9999
.
LOBR4401  APPEND    ANS,OBR04401                 * load identifier (ST)
          GOTO      LOBR9999
.
LOBR4402  APPEND    ANS,OBR04402                 * load text (ST)
          GOTO      LOBR9999
.
LOBR4403  APPEND    ANS,OBR04403                 * load name of cod. system (ST)
          GOTO      LOBR9999
.
LOBR4404  APPEND    ANS,OBR04404                 * load alt. identifier (ST)
          GOTO      LOBR9999
.
LOBR4405  APPEND    ANS,OBR04405                 * load alternate text (ST)
          GOTO      LOBR9999
.
LOBR4406  APPEND    ANS,OBR04406                 * load alt. cod. sys. name (ST)
          GOTO      LOBR9999
.
.         OBR.45 Procedure Code Modifier (CE)
.
LOBR4500  BRANCH    COMPCNT,LOBR4501:            * identifier (ST)
                            LOBR4502:            * text (ST)
                            LOBR4503:            * name of coding system (ST)
                            LOBR4504:            * alternate identifier (ST)
                            LOBR4505:            * alternate text (ST)
                            LOBR4506             * name of alt. cod. system (ST)
          GOTO      LOBR9999
.
LOBR4501  APPEND    ANS,OBR04501                 * load identifier (ST)
          GOTO      LOBR9999
.
LOBR4502  APPEND    ANS,OBR04502                 * load text (ST)
          GOTO      LOBR9999
.
LOBR4503  APPEND    ANS,OBR04503                 * load name of cod. system (ST)
          GOTO      LOBR9999
.
LOBR4504  APPEND    ANS,OBR04504                 * load alt. identifier (ST)
          GOTO      LOBR9999
.
LOBR4505  APPEND    ANS,OBR04505                 * load alternate text (ST)
          GOTO      LOBR9999
.
LOBR4506  APPEND    ANS,OBR04506                 * load alt. cod. sys. name (ST)
          GOTO      LOBR9999
.
LOBR9999  RETURN
+
.*****************************************************************************
.*                               CMSH0000          Called by: PROC0000       *
.*                     Clear all MSH variables                               *
.*****************************************************************************
.
CMSH0000  
.         CALL      CTMP0000                     * clear drug temp file
.         MOVE      ZERO,TEMPUNIQ                * initialise unique counter
.
.         Fill all variables with spaces so that no data is carried over
.         from a previous message.
.
          PACK      MSH00101,SP100,SP100,SP100,SP100,SP100
          PACK      MSH00201,SP100,SP100,SP100,SP100,SP100
          PACK      MSH00301,SP100,SP100,SP100,SP100,SP100
          PACK      MSH00302,SP100,SP100,SP100,SP100,SP100
          PACK      MSH00303,SP100,SP100,SP100,SP100,SP100
          PACK      MSH00401,SP100,SP100,SP100,SP100,SP100
          PACK      MSH00402,SP100,SP100,SP100,SP100,SP100
          PACK      MSH00403,SP100,SP100,SP100,SP100,SP100
          PACK      MSH00501,SP100,SP100,SP100,SP100,SP100
          PACK      MSH00502,SP100,SP100,SP100,SP100,SP100
          PACK      MSH00503,SP100,SP100,SP100,SP100,SP100
          PACK      MSH00601,SP100,SP100,SP100,SP100,SP100
          PACK      MSH00602,SP100,SP100,SP100,SP100,SP100
          PACK      MSH00603,SP100,SP100,SP100,SP100,SP100
          PACK      MSH00701,SP100,SP100,SP100,SP100,SP100
          PACK      MSH00801,SP100,SP100,SP100,SP100,SP100
          MOVE      SP100,MSH00901
          MOVE      SP100,MSH00902
          MOVE      SP100,MSH00903
          PACK      MSH01001,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01101,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01102,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01201,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01202,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01203,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01301,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01401,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01501,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01601,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01701,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01801,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01901,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01902,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01903,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01904,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01905,SP100,SP100,SP100,SP100,SP100
          PACK      MSH01906,SP100,SP100,SP100,SP100,SP100
          PACK      MSH02001,SP100,SP100,SP100,SP100,SP100
.
.         Set the LL and FP to zero so that each character received for
.         the field can be APPENDed.
.
          CLEAR     MSH00101
          CLEAR     MSH00201
          CLEAR     MSH00301
          CLEAR     MSH00302
          CLEAR     MSH00303
          CLEAR     MSH00401
          CLEAR     MSH00402
          CLEAR     MSH00403
          CLEAR     MSH00501
          CLEAR     MSH00502
          CLEAR     MSH00503
          CLEAR     MSH00601
          CLEAR     MSH00602
          CLEAR     MSH00603
          CLEAR     MSH00701
          CLEAR     MSH00801
          CLEAR     MSH00901
          CLEAR     MSH00902
          CLEAR     MSH00903
          CLEAR     MSH01001
          CLEAR     MSH01101
          CLEAR     MSH01102
          CLEAR     MSH01201
          CLEAR     MSH01202
          CLEAR     MSH01203
          CLEAR     MSH01301
          CLEAR     MSH01401
          CLEAR     MSH01501
          CLEAR     MSH01601
          CLEAR     MSH01701
          CLEAR     MSH01801
          CLEAR     MSH01901
          CLEAR     MSH01902
          CLEAR     MSH01903
          CLEAR     MSH01904
          CLEAR     MSH01905
          CLEAR     MSH01906
          CLEAR     MSH02001
.
CMSH9999  RETURN
+
.*****************************************************************************
.*                               CPID0000          Called by: PROC0000       *
.*                     Clear all PID variables                               *
.*****************************************************************************
.
.         Fill all variables with spaces so that no data is carried over
.         from a previous message.
.
CPID0000  PACK      PID00101,SP100,SP100,SP100,SP100,SP100
          PACK      PID00201,SP100,SP100,SP100,SP100,SP100
          PACK      PID00202,SP100,SP100,SP100,SP100,SP100
          PACK      PID00203,SP100,SP100,SP100,SP100,SP100
          PACK      PID00204,SP100,SP100,SP100,SP100,SP100
          PACK      PID00205,SP100,SP100,SP100,SP100,SP100
          PACK      PID00206,SP100,SP100,SP100,SP100,SP100
.
          MOVE      ZERO,COUNTER
          WHILE     COUNTER < 5
            ADD       ONE,COUNTER
            MOVE      SP100,PID00301[COUNTER]
            MOVE      SP100,PID00302[COUNTER]
            MOVE      SP100,PID00303[COUNTER]
            MOVE      SP100,PID00304[COUNTER]
            MOVE      SP100,PID00305[COUNTER]
            MOVE      SP100,PID00306[COUNTER]
          DO
.
          PACK      PID00401,SP100,SP100,SP100,SP100,SP100
          PACK      PID00402,SP100,SP100,SP100,SP100,SP100
          PACK      PID00403,SP100,SP100,SP100,SP100,SP100
          PACK      PID00404,SP100,SP100,SP100,SP100,SP100
          PACK      PID00405,SP100,SP100,SP100,SP100,SP100
          PACK      PID00406,SP100,SP100,SP100,SP100,SP100
          PACK      PID00501,SP100,SP100,SP100,SP100,SP100
          PACK      PID00502,SP100,SP100,SP100,SP100,SP100
          PACK      PID00503,SP100,SP100,SP100,SP100,SP100
          PACK      PID00504,SP100,SP100,SP100,SP100,SP100
          PACK      PID00505,SP100,SP100,SP100,SP100,SP100
          PACK      PID00506,SP100,SP100,SP100,SP100,SP100
          PACK      PID00507,SP100,SP100,SP100,SP100,SP100
          PACK      PID00508,SP100,SP100,SP100,SP100,SP100
          PACK      PID00601,SP100,SP100,SP100,SP100,SP100
          PACK      PID00602,SP100,SP100,SP100,SP100,SP100
          PACK      PID00603,SP100,SP100,SP100,SP100,SP100
          PACK      PID00604,SP100,SP100,SP100,SP100,SP100
          PACK      PID00605,SP100,SP100,SP100,SP100,SP100
          PACK      PID00606,SP100,SP100,SP100,SP100,SP100
          PACK      PID00607,SP100,SP100,SP100,SP100,SP100
          PACK      PID00608,SP100,SP100,SP100,SP100,SP100
          PACK      PID00701,SP100,SP100,SP100,SP100,SP100
          PACK      PID00801,SP100,SP100,SP100,SP100,SP100
.
          MOVE      ZERO,COUNTER
          WHILE     COUNTER < 80
            ADD       ONE,COUNTER
            MOVE      SP100,PID00901[COUNTER]
            MOVE      SP100,PID00902[COUNTER]
            MOVE      SP100,PID00903[COUNTER]
            MOVE      SP100,PID00904[COUNTER]
            MOVE      SP100,PID00905[COUNTER]
            MOVE      SP100,PID00906[COUNTER]
            MOVE      SP100,PID00907[COUNTER]
            MOVE      SP100,PID00908[COUNTER]
          DO
.
          PACK      PID01001,SP100,SP100,SP100,SP100,SP100
          PACK      PID01002,SP100,SP100,SP100,SP100,SP100
          PACK      PID01003,SP100,SP100,SP100,SP100,SP100
          PACK      PID01004,SP100,SP100,SP100,SP100,SP100
          PACK      PID01005,SP100,SP100,SP100,SP100,SP100
          PACK      PID01006,SP100,SP100,SP100,SP100,SP100
.
          MOVE      ZERO,COUNTER
          WHILE     COUNTER < 2
            ADD       ONE,COUNTER
            MOVE      SP100,PID01101[COUNTER]
            MOVE      SP100,PID01102[COUNTER]
            MOVE      SP100,PID01103[COUNTER]
            MOVE      SP100,PID01104[COUNTER]
            MOVE      SP100,PID01105[COUNTER]
            MOVE      SP100,PID01106[COUNTER]
            MOVE      SP100,PID01107[COUNTER]
            MOVE      SP100,PID01108[COUNTER]
            MOVE      SP100,PID01109[COUNTER]
            MOVE      SP100,PID01110[COUNTER]
            MOVE      SP100,PID01111[COUNTER]
          DO
.
          PACK      PID01201,SP100,SP100,SP100,SP100,SP100
.
          MOVE      ZERO,COUNTER
          WHILE     COUNTER < 2
            ADD       ONE,COUNTER
            MOVE      SP100,PID01301[COUNTER]
            MOVE      SP100,PID01401[COUNTER]
            MOVE      SP100,PID01302[COUNTER]
            MOVE      SP100,PID01402[COUNTER]
            MOVE      SP100,PID01303[COUNTER]
            MOVE      SP100,PID01403[COUNTER]
            MOVE      SP100,PID01304[COUNTER]
            MOVE      SP100,PID01404[COUNTER]
            MOVE      SP100,PID01305[COUNTER]
            MOVE      SP100,PID01405[COUNTER]
            MOVE      SP100,PID01306[COUNTER]
            MOVE      SP100,PID01406[COUNTER]
            MOVE      SP100,PID01307[COUNTER]
            MOVE      SP100,PID01407[COUNTER]
            MOVE      SP100,PID01308[COUNTER]
            MOVE      SP100,PID01408[COUNTER]
            MOVE      SP100,PID01309[COUNTER]
            MOVE      SP100,PID01409[COUNTER]
          DO
.
          PACK      PID01501,SP100,SP100,SP100,SP100,SP100
          PACK      PID01502,SP100,SP100,SP100,SP100,SP100
          PACK      PID01503,SP100,SP100,SP100,SP100,SP100
          PACK      PID01504,SP100,SP100,SP100,SP100,SP100
          PACK      PID01505,SP100,SP100,SP100,SP100,SP100
          PACK      PID01506,SP100,SP100,SP100,SP100,SP100
          PACK      PID01601,SP100,SP100,SP100,SP100,SP100
          PACK      PID01602,SP100,SP100,SP100,SP100,SP100
          PACK      PID01603,SP100,SP100,SP100,SP100,SP100
          PACK      PID01604,SP100,SP100,SP100,SP100,SP100
          PACK      PID01605,SP100,SP100,SP100,SP100,SP100
          PACK      PID01606,SP100,SP100,SP100,SP100,SP100
          PACK      PID01701,SP100,SP100,SP100,SP100,SP100
          PACK      PID01702,SP100,SP100,SP100,SP100,SP100
          PACK      PID01703,SP100,SP100,SP100,SP100,SP100
          PACK      PID01704,SP100,SP100,SP100,SP100,SP100
          PACK      PID01705,SP100,SP100,SP100,SP100,SP100
          PACK      PID01706,SP100,SP100,SP100,SP100,SP100
          PACK      PID01801,SP100,SP100,SP100,SP100,SP100
          PACK      PID01802,SP100,SP100,SP100,SP100,SP100
          PACK      PID01803,SP100,SP100,SP100,SP100,SP100
          PACK      PID01804,SP100,SP100,SP100,SP100,SP100
          PACK      PID01805,SP100,SP100,SP100,SP100,SP100
          PACK      PID01806,SP100,SP100,SP100,SP100,SP100
          PACK      PID01901,SP100,SP100,SP100,SP100,SP100
          PACK      PID02001,SP100,SP100,SP100,SP100,SP100
          PACK      PID02002,SP100,SP100,SP100,SP100,SP100
          PACK      PID02003,SP100,SP100,SP100,SP100,SP100
          PACK      PID02101,SP100,SP100,SP100,SP100,SP100
          PACK      PID02102,SP100,SP100,SP100,SP100,SP100
          PACK      PID02103,SP100,SP100,SP100,SP100,SP100
          PACK      PID02104,SP100,SP100,SP100,SP100,SP100
          PACK      PID02105,SP100,SP100,SP100,SP100,SP100
          PACK      PID02106,SP100,SP100,SP100,SP100,SP100
          PACK      PID02201,SP100,SP100,SP100,SP100,SP100
          PACK      PID02202,SP100,SP100,SP100,SP100,SP100
          PACK      PID02203,SP100,SP100,SP100,SP100,SP100
          PACK      PID02204,SP100,SP100,SP100,SP100,SP100
          PACK      PID02205,SP100,SP100,SP100,SP100,SP100
          PACK      PID02206,SP100,SP100,SP100,SP100,SP100
          PACK      PID02301,SP100,SP100,SP100,SP100,SP100
          PACK      PID02401,SP100,SP100,SP100,SP100,SP100
          PACK      PID02501,SP100,SP100,SP100,SP100,SP100
          PACK      PID02601,SP100,SP100,SP100,SP100,SP100
          PACK      PID02602,SP100,SP100,SP100,SP100,SP100
          PACK      PID02603,SP100,SP100,SP100,SP100,SP100
          PACK      PID02604,SP100,SP100,SP100,SP100,SP100
          PACK      PID02605,SP100,SP100,SP100,SP100,SP100
          PACK      PID02606,SP100,SP100,SP100,SP100,SP100
          PACK      PID02701,SP100,SP100,SP100,SP100,SP100
          PACK      PID02702,SP100,SP100,SP100,SP100,SP100
          PACK      PID02703,SP100,SP100,SP100,SP100,SP100
          PACK      PID02704,SP100,SP100,SP100,SP100,SP100
          PACK      PID02705,SP100,SP100,SP100,SP100,SP100
          PACK      PID02706,SP100,SP100,SP100,SP100,SP100
          PACK      PID02801,SP100,SP100,SP100,SP100,SP100
          PACK      PID02802,SP100,SP100,SP100,SP100,SP100
          PACK      PID02803,SP100,SP100,SP100,SP100,SP100
          PACK      PID02804,SP100,SP100,SP100,SP100,SP100
          PACK      PID02805,SP100,SP100,SP100,SP100,SP100
          PACK      PID02806,SP100,SP100,SP100,SP100,SP100
          PACK      PID02901,SP100,SP100,SP100,SP100,SP100
          PACK      PID03001,SP100,SP100,SP100,SP100,SP100
.
.         Set the LL and FP to zero so that each character received for
.         the field can be APPENDed.
.
          CLEAR     PID00101
          CLEAR     PID00201
          CLEAR     PID00202
          CLEAR     PID00203
          CLEAR     PID00204
          CLEAR     PID00205
          CLEAR     PID00206
.
          MOVE      ZERO,COUNTER
          WHILE     COUNTER < 5
            ADD       ONE,COUNTER
            CLEAR     PID00301[COUNTER]
            CLEAR     PID00302[COUNTER]
            CLEAR     PID00303[COUNTER]
            CLEAR     PID00304[COUNTER]
            CLEAR     PID00305[COUNTER]
            CLEAR     PID00306[COUNTER]
          DO
.
          CLEAR     PID00401
          CLEAR     PID00402
          CLEAR     PID00403
          CLEAR     PID00404
          CLEAR     PID00405
          CLEAR     PID00406
          CLEAR     PID00501
          CLEAR     PID00502
          CLEAR     PID00503
          CLEAR     PID00504
          CLEAR     PID00505
          CLEAR     PID00506
          CLEAR     PID00507
          CLEAR     PID00508
          CLEAR     PID00601
          CLEAR     PID00602
          CLEAR     PID00603
          CLEAR     PID00604
          CLEAR     PID00605
          CLEAR     PID00606
          CLEAR     PID00607
          CLEAR     PID00608
          CLEAR     PID00701
          CLEAR     PID00801
.
          MOVE      ZERO,COUNTER
          WHILE     COUNTER < 80
            ADD       ONE,COUNTER
            CLEAR     PID00901[COUNTER]
            CLEAR     PID00902[COUNTER]
            CLEAR     PID00903[COUNTER]
            CLEAR     PID00904[COUNTER]
            CLEAR     PID00905[COUNTER]
            CLEAR     PID00906[COUNTER]
            CLEAR     PID00907[COUNTER]
            CLEAR     PID00908[COUNTER]
          DO
.
          CLEAR     PID01001
          CLEAR     PID01002
          CLEAR     PID01003
          CLEAR     PID01004
          CLEAR     PID01005
          CLEAR     PID01006
.
          MOVE      ZERO,COUNTER
          WHILE     COUNTER < 2
            ADD       ONE,COUNTER
            CLEAR     PID01101[COUNTER]
            CLEAR     PID01102[COUNTER]
            CLEAR     PID01103[COUNTER]
            CLEAR     PID01104[COUNTER]
            CLEAR     PID01105[COUNTER]
            CLEAR     PID01106[COUNTER]
            CLEAR     PID01107[COUNTER]
            CLEAR     PID01108[COUNTER]
            CLEAR     PID01109[COUNTER]
            CLEAR     PID01110[COUNTER]
            CLEAR     PID01111[COUNTER]
          DO
.
          CLEAR     PID01201
.
          MOVE      ZERO,COUNTER
          WHILE     COUNTER < 2
            ADD       ONE,COUNTER
            CLEAR     PID01301[COUNTER]
            CLEAR     PID01401[COUNTER]
            CLEAR     PID01302[COUNTER]
            CLEAR     PID01402[COUNTER]
            CLEAR     PID01303[COUNTER]
            CLEAR     PID01403[COUNTER]
            CLEAR     PID01304[COUNTER]
            CLEAR     PID01404[COUNTER]
            CLEAR     PID01305[COUNTER]
            CLEAR     PID01405[COUNTER]
            CLEAR     PID01306[COUNTER]
            CLEAR     PID01406[COUNTER]
            CLEAR     PID01307[COUNTER]
            CLEAR     PID01407[COUNTER]
            CLEAR     PID01308[COUNTER]
            CLEAR     PID01408[COUNTER]
            CLEAR     PID01309[COUNTER]
            CLEAR     PID01409[COUNTER]
          DO
.
          CLEAR     PID01501
          CLEAR     PID01502
          CLEAR     PID01503
          CLEAR     PID01504
          CLEAR     PID01505
          CLEAR     PID01506
          CLEAR     PID01601
          CLEAR     PID01602
          CLEAR     PID01603
          CLEAR     PID01604
          CLEAR     PID01605
          CLEAR     PID01606
          CLEAR     PID01701
          CLEAR     PID01702
          CLEAR     PID01703
          CLEAR     PID01704
          CLEAR     PID01705
          CLEAR     PID01706
          CLEAR     PID01801
          CLEAR     PID01802
          CLEAR     PID01803
          CLEAR     PID01804
          CLEAR     PID01805
          CLEAR     PID01806
          CLEAR     PID01901
          CLEAR     PID02001
          CLEAR     PID02002
          CLEAR     PID02003
          CLEAR     PID02101
          CLEAR     PID02102
          CLEAR     PID02103
          CLEAR     PID02104
          CLEAR     PID02105
          CLEAR     PID02106
          CLEAR     PID02201
          CLEAR     PID02202
          CLEAR     PID02203
          CLEAR     PID02204
          CLEAR     PID02205
          CLEAR     PID02206
          CLEAR     PID02301
          CLEAR     PID02401
          CLEAR     PID02501
          CLEAR     PID02601
          CLEAR     PID02602
          CLEAR     PID02603
          CLEAR     PID02604
          CLEAR     PID02605
          CLEAR     PID02606
          CLEAR     PID02701
          CLEAR     PID02702
          CLEAR     PID02703
          CLEAR     PID02704
          CLEAR     PID02705
          CLEAR     PID02706
          CLEAR     PID02801
          CLEAR     PID02802
          CLEAR     PID02803
          CLEAR     PID02804
          CLEAR     PID02805
          CLEAR     PID02806
          CLEAR     PID02901
          CLEAR     PID03001
.
CPID9999  RETURN
+
.*****************************************************************************
.*                                 CORC0000        Called by: PROC0000       *
.*                          Clear the ORC fields                             *
.*****************************************************************************
.
CORC0000  PACK      ORC00101,SP100
          PACK      ORC00201,SP100
          PACK      ORC00202,SP100
          PACK      ORC00203,SP100
          PACK      ORC00204,SP100
          PACK      ORC00301,SP100
          PACK      ORC00302,SP100
          PACK      ORC00303,SP100
          PACK      ORC00304,SP100
          PACK      ORC00401,SP100
          PACK      ORC00402,SP100
          PACK      ORC00403,SP100
          PACK      ORC00404,SP100
          PACK      ORC00501,SP100
          PACK      ORC00601,SP100,SP100
          PACK      ORC00701,SP100
          PACK      ORC00702,SP100
          PACK      ORC00703,SP100
          PACK      ORC00704,SP100
          PACK      ORC00705,SP100
          PACK      ORC00706,SP100
          PACK      ORC00707,SP100
          PACK      ORC00708,SP100
          PACK      ORC00709,SP100
          PACK      ORC00710,SP100
          PACK      ORC00711,SP100
          PACK      ORC00712,SP100
          PACK      ORC00801,SP100,SP100
          PACK      ORC00802,SP100,SP100
          PACK      ORC00901,SP100
          PACK      ORC01001,SP100
          PACK      ORC01002,SP100
          PACK      ORC01003,SP100
          PACK      ORC01004,SP100
          PACK      ORC01005,SP100
          PACK      ORC01006,SP100
          PACK      ORC01007,SP100
          PACK      ORC01008,SP100
          PACK      ORC01009,SP100
          PACK      ORC01010,SP100
          PACK      ORC01011,SP100
          PACK      ORC01012,SP100
          PACK      ORC01013,SP100
          PACK      ORC01014,SP100
          PACK      ORC01015,SP100
          PACK      ORC01101,SP100
          PACK      ORC01102,SP100
          PACK      ORC01103,SP100
          PACK      ORC01104,SP100
          PACK      ORC01105,SP100
          PACK      ORC01106,SP100
          PACK      ORC01107,SP100
          PACK      ORC01108,SP100
          PACK      ORC01109,SP100
          PACK      ORC01110,SP100
          PACK      ORC01111,SP100
          PACK      ORC01112,SP100
          PACK      ORC01113,SP100
          PACK      ORC01114,SP100
          PACK      ORC01115,SP100
          PACK      ORC01201,SP100
          PACK      ORC01202,SP100
          PACK      ORC01203,SP100
          PACK      ORC01204,SP100
          PACK      ORC01205,SP100
          PACK      ORC01206,SP100
          PACK      ORC01207,SP100
          PACK      ORC01208,SP100
          PACK      ORC01209,SP100
          PACK      ORC01210,SP100
          PACK      ORC01211,SP100
          PACK      ORC01212,SP100
          PACK      ORC01213,SP100
          PACK      ORC01214,SP100
          PACK      ORC01215,SP100
          PACK      ORC01301,SP100
          PACK      ORC01302,SP100
          PACK      ORC01303,SP100
          PACK      ORC01304,SP100
          PACK      ORC01305,SP100
          PACK      ORC01306,SP100
          PACK      ORC01307,SP100
          PACK      ORC01308,SP100
          PACK      ORC01309,SP100
          PACK      ORC01401,SP100
          PACK      ORC01402,SP100
          PACK      ORC01403,SP100
          PACK      ORC01404,SP100
          PACK      ORC01405,SP100
          PACK      ORC01406,SP100
          PACK      ORC01407,SP100
          PACK      ORC01408,SP100
          PACK      ORC01409,SP100
          PACK      ORC01501,SP100
          PACK      ORC01601,SP100,SP100
          PACK      ORC01602,SP100
          PACK      ORC01603,SP100
          PACK      ORC01604,SP100
          PACK      ORC01605,SP100
          PACK      ORC01606,SP100
          PACK      ORC01701,SP100,SP100
          PACK      ORC01702,SP100
          PACK      ORC01703,SP100
          PACK      ORC01704,SP100
          PACK      ORC01705,SP100
          PACK      ORC01706,SP100
          PACK      ORC01801,SP100,SP100
          PACK      ORC01802,SP100
          PACK      ORC01803,SP100
          PACK      ORC01804,SP100
          PACK      ORC01805,SP100
          PACK      ORC01806,SP100
          PACK      ORC01901,SP100,SP100
          PACK      ORC01902,SP100
          PACK      ORC01903,SP100
          PACK      ORC01904,SP100
          PACK      ORC01905,SP100
          PACK      ORC01906,SP100
          PACK      ORC01907,SP100
          PACK      ORC01908,SP100
          PACK      ORC01909,SP100
          PACK      ORC01910,SP100
          PACK      ORC01911,SP100
          PACK      ORC01912,SP100
          PACK      ORC01913,SP100
          PACK      ORC01914,SP100
          PACK      ORC01915,SP100
          PACK      ORC02001,SP100
          PACK      ORC02002,SP100
          PACK      ORC02003,SP100
          PACK      ORC02004,SP100
          PACK      ORC02005,SP100
          PACK      ORC02006,SP100
          PACK      ORC02101,SP100
          PACK      ORC02102,SP100
          PACK      ORC02103,SP100
          PACK      ORC02104,SP100
          PACK      ORC02105,SP100
          PACK      ORC02106,SP100
          PACK      ORC02107,SP100
          PACK      ORC02108,SP100
          PACK      ORC02109,SP100
          PACK      ORC02201,SP100,SP100
          PACK      ORC02202,SP100
          PACK      ORC02203,SP100
          PACK      ORC02204,SP100
          PACK      ORC02205,SP100
          PACK      ORC02206,SP100
          PACK      ORC02207,SP100
          PACK      ORC02208,SP100
          PACK      ORC02209,SP100
          PACK      ORC02210,SP100
          PACK      ORC02211,SP100
          PACK      ORC02301,SP100
          PACK      ORC02302,SP100
          PACK      ORC02303,SP100
          PACK      ORC02304,SP100
          PACK      ORC02305,SP100
          PACK      ORC02306,SP100
          PACK      ORC02307,SP100
          PACK      ORC02308,SP100
          PACK      ORC02309,SP100
          PACK      ORC02401,SP100,SP100
          PACK      ORC02402,SP100
          PACK      ORC02403,SP100
          PACK      ORC02404,SP100
          PACK      ORC02405,SP100
          PACK      ORC02406,SP100
          PACK      ORC02407,SP100
          PACK      ORC02408,SP100
          PACK      ORC02409,SP100
          PACK      ORC02410,SP100
          PACK      ORC02411,SP100
.
.         Set the LL and FP to zero so that each character received for
.         the field can be APPENDed.
.
          CLEAR     ORC00101
          CLEAR     ORC00201
          CLEAR     ORC00202
          CLEAR     ORC00203
          CLEAR     ORC00204
          CLEAR     ORC00301
          CLEAR     ORC00302
          CLEAR     ORC00303
          CLEAR     ORC00304
          CLEAR     ORC00401
          CLEAR     ORC00402
          CLEAR     ORC00403
          CLEAR     ORC00404
          CLEAR     ORC00501
          CLEAR     ORC00601
          CLEAR     ORC00701
          CLEAR     ORC00702
          CLEAR     ORC00703
          CLEAR     ORC00704
          CLEAR     ORC00705
          CLEAR     ORC00706
          CLEAR     ORC00707
          CLEAR     ORC00708
          CLEAR     ORC00709
          CLEAR     ORC00710
          CLEAR     ORC00711
          CLEAR     ORC00712
          CLEAR     ORC00801
          CLEAR     ORC00802
          CLEAR     ORC00901
          CLEAR     ORC01001
          CLEAR     ORC01002
          CLEAR     ORC01003
          CLEAR     ORC01004
          CLEAR     ORC01005
          CLEAR     ORC01006
          CLEAR     ORC01007
          CLEAR     ORC01008
          CLEAR     ORC01009
          CLEAR     ORC01010
          CLEAR     ORC01011
          CLEAR     ORC01012
          CLEAR     ORC01013
          CLEAR     ORC01014
          CLEAR     ORC01015
          CLEAR     ORC01101
          CLEAR     ORC01102
          CLEAR     ORC01103
          CLEAR     ORC01104
          CLEAR     ORC01105
          CLEAR     ORC01106
          CLEAR     ORC01107
          CLEAR     ORC01108
          CLEAR     ORC01109
          CLEAR     ORC01110
          CLEAR     ORC01111
          CLEAR     ORC01112
          CLEAR     ORC01113
          CLEAR     ORC01114
          CLEAR     ORC01115
          CLEAR     ORC01201
          CLEAR     ORC01202
          CLEAR     ORC01203
          CLEAR     ORC01204
          CLEAR     ORC01205
          CLEAR     ORC01206
          CLEAR     ORC01207
          CLEAR     ORC01208
          CLEAR     ORC01209
          CLEAR     ORC01210
          CLEAR     ORC01211
          CLEAR     ORC01212
          CLEAR     ORC01213
          CLEAR     ORC01214
          CLEAR     ORC01215
          CLEAR     ORC01301
          CLEAR     ORC01302
          CLEAR     ORC01303
          CLEAR     ORC01304
          CLEAR     ORC01305
          CLEAR     ORC01306
          CLEAR     ORC01307
          CLEAR     ORC01308
          CLEAR     ORC01309
          CLEAR     ORC01401
          CLEAR     ORC01402
          CLEAR     ORC01403
          CLEAR     ORC01404
          CLEAR     ORC01405
          CLEAR     ORC01406
          CLEAR     ORC01407
          CLEAR     ORC01408
          CLEAR     ORC01409
          CLEAR     ORC01501
          CLEAR     ORC01601
          CLEAR     ORC01602
          CLEAR     ORC01603
          CLEAR     ORC01604
          CLEAR     ORC01605
          CLEAR     ORC01606
          CLEAR     ORC01701
          CLEAR     ORC01702
          CLEAR     ORC01703
          CLEAR     ORC01704
          CLEAR     ORC01705
          CLEAR     ORC01706
          CLEAR     ORC01801
          CLEAR     ORC01802
          CLEAR     ORC01803
          CLEAR     ORC01804
          CLEAR     ORC01805
          CLEAR     ORC01806
          CLEAR     ORC01901
          CLEAR     ORC01902
          CLEAR     ORC01903
          CLEAR     ORC01904
          CLEAR     ORC01905
          CLEAR     ORC01906
          CLEAR     ORC01907
          CLEAR     ORC01908
          CLEAR     ORC01909
          CLEAR     ORC01910
          CLEAR     ORC01911
          CLEAR     ORC01912
          CLEAR     ORC01913
          CLEAR     ORC01914
          CLEAR     ORC01915
          CLEAR     ORC02001
          CLEAR     ORC02002
          CLEAR     ORC02003
          CLEAR     ORC02004
          CLEAR     ORC02005
          CLEAR     ORC02006
          CLEAR     ORC02101
          CLEAR     ORC02102
          CLEAR     ORC02103
          CLEAR     ORC02104
          CLEAR     ORC02105
          CLEAR     ORC02106
          CLEAR     ORC02107
          CLEAR     ORC02108
          CLEAR     ORC02109
          CLEAR     ORC02201
          CLEAR     ORC02202
          CLEAR     ORC02203
          CLEAR     ORC02204
          CLEAR     ORC02205
          CLEAR     ORC02206
          CLEAR     ORC02207
          CLEAR     ORC02208
          CLEAR     ORC02209
          CLEAR     ORC02210
          CLEAR     ORC02211
          CLEAR     ORC02301
          CLEAR     ORC02302
          CLEAR     ORC02303
          CLEAR     ORC02304
          CLEAR     ORC02305
          CLEAR     ORC02306
          CLEAR     ORC02307
          CLEAR     ORC02308
          CLEAR     ORC02309
          CLEAR     ORC02401
          CLEAR     ORC02402
          CLEAR     ORC02403
          CLEAR     ORC02404
          CLEAR     ORC02405
          CLEAR     ORC02406
          CLEAR     ORC02407
          CLEAR     ORC02408
          CLEAR     ORC02409
          CLEAR     ORC02410
          CLEAR     ORC02411
.
CORC9999  RETURN
+
.*****************************************************************************
.*                                 CRXD0000        Called by: PROC0000       *
.*                          Clear the RXD fields                             *
.*****************************************************************************
.
CRXD0000  PACK      RXD00101,SP100
          PACK      RXD00201,SP100
          PACK      RXD00202,SP100
          PACK      RXD00203,SP100
          PACK      RXD00204,SP100
          PACK      RXD00205,SP100
          PACK      RXD00206,SP100
          PACK      RXD00301,SP100
          PACK      RXD00401,SP100
          PACK      RXD00501,SP100
          PACK      RXD00502,SP100
          PACK      RXD00503,SP100
          PACK      RXD00504,SP100
          PACK      RXD00505,SP100
          PACK      RXD00506,SP100
          PACK      RXD00601,SP100
          PACK      RXD00602,SP100
          PACK      RXD00603,SP100
          PACK      RXD00604,SP100
          PACK      RXD00605,SP100
          PACK      RXD00606,SP100
          PACK      RXD00701,SP100
          PACK      RXD00801,SP100
          PACK      RXD00901,SP100
          PACK      RXD01001,SP100
          PACK      RXD01002,SP100
          PACK      RXD01003,SP100
          PACK      RXD01004,SP100
          PACK      RXD01005,SP100
          PACK      RXD01006,SP100
          PACK      RXD01007,SP100
          PACK      RXD01008,SP100
          PACK      RXD01009,SP100
          PACK      RXD01010,SP100
          PACK      RXD01011,SP100
          PACK      RXD01012,SP100
          PACK      RXD01013,SP100
          PACK      RXD01014,SP100
          PACK      RXD01015,SP100
          PACK      RXD01101,SP100
          PACK      RXD01201,SP100
          PACK      RXD01202,SP100
          PACK      RXD01203,SP100
          PACK      RXD01204,SP100
          PACK      RXD01205,SP100
          PACK      RXD01206,SP100
          PACK      RXD01207,SP100
          PACK      RXD01208,SP100
          PACK      RXD01209,SP100
          PACK      RXD01301,SP100
          PACK      RXD01302,SP100
          PACK      RXD01303,SP100
          PACK      RXD01304,SP100
          PACK      RXD01305,SP100
          PACK      RXD01306,SP100
          PACK      RXD01307,SP100
          PACK      RXD01308,SP100
          PACK      RXD01309,SP100
          PACK      RXD01310,SP100
          PACK      RXD01311,SP100
          PACK      RXD01312,SP100
          PACK      RXD01313,SP100
          PACK      RXD01314,SP100
          PACK      RXD01315,SP100
          PACK      RXD01316,SP100
          PACK      RXD01401,SP100
          PACK      RXD01501,SP100
          PACK      RXD01502,SP100
          PACK      RXD01503,SP100
          PACK      RXD01504,SP100
          PACK      RXD01505,SP100
          PACK      RXD01506,SP100
          PACK      RXD01601,SP100
          PACK      RXD01701,SP100
          PACK      RXD01702,SP100
          PACK      RXD01703,SP100
          PACK      RXD01704,SP100
          PACK      RXD01705,SP100
          PACK      RXD01706,SP100
          PACK      RXD01801,SP100
          PACK      RXD01901,SP100
          PACK      RXD02001,SP100
          PACK      RXD02002,SP100
          PACK      RXD02003,SP100
          PACK      RXD02004,SP100
          PACK      RXD02005,SP100
          PACK      RXD02006,SP100
          PACK      RXD02101,SP100
          PACK      RXD02102,SP100
          PACK      RXD02103,SP100
          PACK      RXD02104,SP100
          PACK      RXD02105,SP100
          PACK      RXD02106,SP100
          PACK      RXD02201,SP100
          PACK      RXD02301,SP100
          PACK      RXD02302,SP100
          PACK      RXD02303,SP100
          PACK      RXD02304,SP100
          PACK      RXD02305,SP100
          PACK      RXD02306,SP100
          PACK      RXD02401,SP100
.
.         Set the LL and FP to zero so that each character received for
.         the field can be APPENDed.
.
          CLEAR     RXD00101
          CLEAR     RXD00201
          CLEAR     RXD00202
          CLEAR     RXD00203
          CLEAR     RXD00204
          CLEAR     RXD00205
          CLEAR     RXD00206
          CLEAR     RXD00301
          CLEAR     RXD00401
          CLEAR     RXD00501
          CLEAR     RXD00502
          CLEAR     RXD00503
          CLEAR     RXD00504
          CLEAR     RXD00505
          CLEAR     RXD00506
          CLEAR     RXD00601
          CLEAR     RXD00602
          CLEAR     RXD00603
          CLEAR     RXD00604
          CLEAR     RXD00605
          CLEAR     RXD00606
          CLEAR     RXD00701
          CLEAR     RXD00801
          CLEAR     RXD00901
          CLEAR     RXD01001
          CLEAR     RXD01002
          CLEAR     RXD01003
          CLEAR     RXD01004
          CLEAR     RXD01005
          CLEAR     RXD01006
          CLEAR     RXD01007
          CLEAR     RXD01008
          CLEAR     RXD01009
          CLEAR     RXD01010
          CLEAR     RXD01011
          CLEAR     RXD01012
          CLEAR     RXD01013
          CLEAR     RXD01014
          CLEAR     RXD01015
          CLEAR     RXD01101
          CLEAR     RXD01201
          CLEAR     RXD01202
          CLEAR     RXD01203
          CLEAR     RXD01204
          CLEAR     RXD01205
          CLEAR     RXD01206
          CLEAR     RXD01207
          CLEAR     RXD01208
          CLEAR     RXD01209
          CLEAR     RXD01301
          CLEAR     RXD01302
          CLEAR     RXD01303
          CLEAR     RXD01304
          CLEAR     RXD01305
          CLEAR     RXD01306
          CLEAR     RXD01307
          CLEAR     RXD01308
          CLEAR     RXD01309
          CLEAR     RXD01310
          CLEAR     RXD01311
          CLEAR     RXD01312
          CLEAR     RXD01313
          CLEAR     RXD01314
          CLEAR     RXD01315
          CLEAR     RXD01316
          CLEAR     RXD01401
          CLEAR     RXD01501
          CLEAR     RXD01502
          CLEAR     RXD01503
          CLEAR     RXD01504
          CLEAR     RXD01505
          CLEAR     RXD01506
          CLEAR     RXD01601
          CLEAR     RXD01701
          CLEAR     RXD01702
          CLEAR     RXD01703
          CLEAR     RXD01704
          CLEAR     RXD01705
          CLEAR     RXD01706
          CLEAR     RXD01801
          CLEAR     RXD01901
          CLEAR     RXD02001
          CLEAR     RXD02002
          CLEAR     RXD02003
          CLEAR     RXD02004
          CLEAR     RXD02005
          CLEAR     RXD02006
          CLEAR     RXD02101
          CLEAR     RXD02102
          CLEAR     RXD02103
          CLEAR     RXD02104
          CLEAR     RXD02105
          CLEAR     RXD02106
          CLEAR     RXD02201
          CLEAR     RXD02301
          CLEAR     RXD02302
          CLEAR     RXD02303
          CLEAR     RXD02304
          CLEAR     RXD02305
          CLEAR     RXD02306
          CLEAR     RXD02401
.
CRXD9999  RETURN
+
.*****************************************************************************
.*                                 CRXR0000        Called by: PROC0000       *
.*                          Clear the RXR fields                             *
.*****************************************************************************
.
CRXR0000  PACK      RXR00101,SP100
          PACK      RXR00102,SP100
          PACK      RXR00103,SP100
          PACK      RXR00104,SP100
          PACK      RXR00105,SP100
          PACK      RXR00106,SP100
          PACK      RXR00201,SP100
          PACK      RXR00202,SP100
          PACK      RXR00203,SP100
          PACK      RXR00204,SP100
          PACK      RXR00205,SP100
          PACK      RXR00206,SP100
          PACK      RXR00301,SP100
          PACK      RXR00302,SP100
          PACK      RXR00303,SP100
          PACK      RXR00304,SP100
          PACK      RXR00305,SP100
          PACK      RXR00306,SP100
          PACK      RXR00401,SP100
          PACK      RXR00402,SP100
          PACK      RXR00403,SP100
          PACK      RXR00404,SP100
          PACK      RXR00405,SP100
          PACK      RXR00406,SP100
          PACK      RXR00501,SP100
          PACK      RXR00502,SP100
          PACK      RXR00503,SP100
          PACK      RXR00504,SP100
          PACK      RXR00505,SP100
          PACK      RXR00506,SP100
.
.         Set the LL and FP to zero so that each character received for
.         the field can be APPENDed.
.
          CLEAR     RXR00101
          CLEAR     RXR00102
          CLEAR     RXR00103
          CLEAR     RXR00104
          CLEAR     RXR00105
          CLEAR     RXR00106
          CLEAR     RXR00201
          CLEAR     RXR00202
          CLEAR     RXR00203
          CLEAR     RXR00204
          CLEAR     RXR00205
          CLEAR     RXR00206
          CLEAR     RXR00301
          CLEAR     RXR00302
          CLEAR     RXR00303
          CLEAR     RXR00304
          CLEAR     RXR00305
          CLEAR     RXR00306
          CLEAR     RXR00401
          CLEAR     RXR00402
          CLEAR     RXR00403
          CLEAR     RXR00404
          CLEAR     RXR00405
          CLEAR     RXR00406
          CLEAR     RXR00501
          CLEAR     RXR00502
          CLEAR     RXR00503
          CLEAR     RXR00504
          CLEAR     RXR00505
          CLEAR     RXR00506
.
CRXR9999  RETURN
+
.*****************************************************************************
.*                               CPV10000          Called by: PROC0000       *
.*                     Clear all PV1 variables                               *
.*****************************************************************************
.
.         Fill all variables with spaces so that no data is carried over
.         from a previous message.
.
CPV10000  PACK      PV100101,SP100
          PACK      PV100201,SP100
          PACK      PV100301,SP100
          PACK      PV100302,SP100
          PACK      PV100303,SP100
          PACK      PV100304,SP100
          PACK      PV100305,SP100
          PACK      PV100306,SP100
          PACK      PV100307,SP100
          PACK      PV100308,SP100
          PACK      PV100309,SP100
          PACK      PV100401,SP100
          PACK      PV100501,SP100
          PACK      PV100502,SP100
          PACK      PV100503,SP100
          PACK      PV100504,SP100
          PACK      PV100505,SP100
          PACK      PV100506,SP100
          PACK      PV100601,SP100
          PACK      PV100602,SP100
          PACK      PV100603,SP100
          PACK      PV100604,SP100
          PACK      PV100605,SP100
          PACK      PV100606,SP100
          PACK      PV100607,SP100
          PACK      PV100608,SP100
          PACK      PV100609,SP100
          PACK      PV100701,SP100
          PACK      PV100702,SP100
          PACK      PV100703,SP100
          PACK      PV100704,SP100
          PACK      PV100705,SP100
          PACK      PV100706,SP100
          PACK      PV100707,SP100
          PACK      PV100708,SP100
          PACK      PV100709,SP100
          PACK      PV100710,SP100
          PACK      PV100711,SP100
          PACK      PV100712,SP100
          PACK      PV100713,SP100
          PACK      PV100714,SP100
          PACK      PV100715,SP100
          PACK      PV100801,SP100
          PACK      PV100802,SP100
          PACK      PV100803,SP100
          PACK      PV100804,SP100
          PACK      PV100805,SP100
          PACK      PV100806,SP100
          PACK      PV100807,SP100
          PACK      PV100808,SP100
          PACK      PV100809,SP100
          PACK      PV100810,SP100
          PACK      PV100811,SP100
          PACK      PV100812,SP100
          PACK      PV100813,SP100
          PACK      PV100814,SP100
          PACK      PV100815,SP100
          PACK      PV100901,SP100
          PACK      PV100902,SP100
          PACK      PV100903,SP100
          PACK      PV100904,SP100
          PACK      PV100905,SP100
          PACK      PV100906,SP100
          PACK      PV100907,SP100
          PACK      PV100908,SP100
          PACK      PV100909,SP100
          PACK      PV100910,SP100
          PACK      PV100911,SP100
          PACK      PV100912,SP100
          PACK      PV100913,SP100
          PACK      PV100914,SP100
          PACK      PV100915,SP100
          PACK      PV101001,SP100
          PACK      PV101101,SP100
          PACK      PV101102,SP100
          PACK      PV101103,SP100
          PACK      PV101104,SP100
          PACK      PV101105,SP100
          PACK      PV101106,SP100
          PACK      PV101107,SP100
          PACK      PV101108,SP100
          PACK      PV101109,SP100
          PACK      PV101201,SP100
          PACK      PV101301,SP100
          PACK      PV101401,SP100
          PACK      PV101501,SP100
          PACK      PV101601,SP100
          PACK      PV101701,SP100
          PACK      PV101702,SP100
          PACK      PV101703,SP100
          PACK      PV101704,SP100
          PACK      PV101705,SP100
          PACK      PV101706,SP100
          PACK      PV101707,SP100
          PACK      PV101708,SP100
          PACK      PV101709,SP100
          PACK      PV101710,SP100
          PACK      PV101711,SP100
          PACK      PV101712,SP100
          PACK      PV101713,SP100
          PACK      PV101714,SP100
          PACK      PV101715,SP100
          PACK      PV101801,SP100
          PACK      PV101901,SP100
          PACK      PV101902,SP100
          PACK      PV101903,SP100
          PACK      PV101904,SP100
          PACK      PV101905,SP100
          PACK      PV101906,SP100
          PACK      PV102001,SP100
          PACK      PV102002,SP100
          PACK      PV102101,SP100
          PACK      PV102201,SP100
          PACK      PV102301,SP100
          PACK      PV102401,SP100
          PACK      PV102501,SP100
          PACK      PV102601,SP100
          PACK      PV102701,SP100
          PACK      PV102801,SP100
          PACK      PV102901,SP100
          PACK      PV103001,SP100
          PACK      PV103101,SP100
          PACK      PV103201,SP100
          PACK      PV103301,SP100
          PACK      PV103401,SP100
          PACK      PV103501,SP100
          PACK      PV103601,SP100
          PACK      PV103701,SP100
          PACK      PV103702,SP100
          PACK      PV103801,SP100
          PACK      PV103802,SP100
          PACK      PV103803,SP100
          PACK      PV103804,SP100
          PACK      PV103805,SP100
          PACK      PV103806,SP100
          PACK      PV103901,SP100
          PACK      PV104001,SP100
          PACK      PV104101,SP100
          PACK      PV104201,SP100
          PACK      PV104202,SP100
          PACK      PV104203,SP100
          PACK      PV104204,SP100
          PACK      PV104205,SP100
          PACK      PV104206,SP100
          PACK      PV104207,SP100
          PACK      PV104208,SP100
          PACK      PV104209,SP100
          PACK      PV104301,SP100
          PACK      PV104302,SP100
          PACK      PV104303,SP100
          PACK      PV104304,SP100
          PACK      PV104305,SP100
          PACK      PV104306,SP100
          PACK      PV104307,SP100
          PACK      PV104308,SP100
          PACK      PV104309,SP100
          PACK      PV104401,SP100
          PACK      PV104501,SP100
          PACK      PV104601,SP100
          PACK      PV104701,SP100
          PACK      PV104801,SP100
          PACK      PV104901,SP100
          PACK      PV105001,SP100
          PACK      PV105002,SP100
          PACK      PV105003,SP100
          PACK      PV105004,SP100
          PACK      PV105005,SP100
          PACK      PV105006,SP100
          PACK      PV105101,SP100
          PACK      PV105201,SP100
          PACK      PV105202,SP100
          PACK      PV105203,SP100
          PACK      PV105204,SP100
          PACK      PV105205,SP100
          PACK      PV105206,SP100
          PACK      PV105207,SP100
          PACK      PV105208,SP100
          PACK      PV105209,SP100
          PACK      PV105210,SP100
          PACK      PV105211,SP100
          PACK      PV105212,SP100
          PACK      PV105213,SP100
          PACK      PV105214,SP100
          PACK      PV105215,SP100
.
.         Set the LL and FP to zero so that each character received for
.         the field can be APPENDed.
.
          CLEAR     PV100101
          CLEAR     PV100201
          CLEAR     PV100301
          CLEAR     PV100302
          CLEAR     PV100303
          CLEAR     PV100304
          CLEAR     PV100305
          CLEAR     PV100306
          CLEAR     PV100307
          CLEAR     PV100308
          CLEAR     PV100309
          CLEAR     PV100401
          CLEAR     PV100501
          CLEAR     PV100502
          CLEAR     PV100503
          CLEAR     PV100504
          CLEAR     PV100505
          CLEAR     PV100506
          CLEAR     PV100601
          CLEAR     PV100602
          CLEAR     PV100603
          CLEAR     PV100604
          CLEAR     PV100605
          CLEAR     PV100606
          CLEAR     PV100607
          CLEAR     PV100608
          CLEAR     PV100609
          CLEAR     PV100701
          CLEAR     PV100702
          CLEAR     PV100703
          CLEAR     PV100704
          CLEAR     PV100705
          CLEAR     PV100706
          CLEAR     PV100707
          CLEAR     PV100708
          CLEAR     PV100709
          CLEAR     PV100710
          CLEAR     PV100711
          CLEAR     PV100712
          CLEAR     PV100713
          CLEAR     PV100714
          CLEAR     PV100715
          CLEAR     PV100801
          CLEAR     PV100802
          CLEAR     PV100803
          CLEAR     PV100804
          CLEAR     PV100805
          CLEAR     PV100806
          CLEAR     PV100807
          CLEAR     PV100808
          CLEAR     PV100809
          CLEAR     PV100810
          CLEAR     PV100811
          CLEAR     PV100812
          CLEAR     PV100813
          CLEAR     PV100814
          CLEAR     PV100815
          CLEAR     PV100901
          CLEAR     PV100902
          CLEAR     PV100903
          CLEAR     PV100904
          CLEAR     PV100905
          CLEAR     PV100906
          CLEAR     PV100907
          CLEAR     PV100908
          CLEAR     PV100909
          CLEAR     PV100910
          CLEAR     PV100911
          CLEAR     PV100912
          CLEAR     PV100913
          CLEAR     PV100914
          CLEAR     PV100915
          CLEAR     PV101001
          CLEAR     PV101101
          CLEAR     PV101102
          CLEAR     PV101103
          CLEAR     PV101104
          CLEAR     PV101105
          CLEAR     PV101106
          CLEAR     PV101107
          CLEAR     PV101108
          CLEAR     PV101109
          CLEAR     PV101201
          CLEAR     PV101301
          CLEAR     PV101401
          CLEAR     PV101501
          CLEAR     PV101601
          CLEAR     PV101701
          CLEAR     PV101702
          CLEAR     PV101703
          CLEAR     PV101704
          CLEAR     PV101705
          CLEAR     PV101706
          CLEAR     PV101707
          CLEAR     PV101708
          CLEAR     PV101709
          CLEAR     PV101710
          CLEAR     PV101711
          CLEAR     PV101712
          CLEAR     PV101713
          CLEAR     PV101714
          CLEAR     PV101715
          CLEAR     PV101801
          CLEAR     PV101901
          CLEAR     PV101902
          CLEAR     PV101903
          CLEAR     PV101904
          CLEAR     PV101905
          CLEAR     PV101906
          CLEAR     PV102001
          CLEAR     PV102002
          CLEAR     PV102101
          CLEAR     PV102201
          CLEAR     PV102301
          CLEAR     PV102401
          CLEAR     PV102501
          CLEAR     PV102601
          CLEAR     PV102701
          CLEAR     PV102801
          CLEAR     PV102901
          CLEAR     PV103001
          CLEAR     PV103101
          CLEAR     PV103201
          CLEAR     PV103301
          CLEAR     PV103401
          CLEAR     PV103501
          CLEAR     PV103601
          CLEAR     PV103701
          CLEAR     PV103702
          CLEAR     PV103801
          CLEAR     PV103802
          CLEAR     PV103803
          CLEAR     PV103804
          CLEAR     PV103805
          CLEAR     PV103806
          CLEAR     PV103901
          CLEAR     PV104001
          CLEAR     PV104101
          CLEAR     PV104201
          CLEAR     PV104202
          CLEAR     PV104203
          CLEAR     PV104204
          CLEAR     PV104205
          CLEAR     PV104206
          CLEAR     PV104207
          CLEAR     PV104208
          CLEAR     PV104209
          CLEAR     PV104301
          CLEAR     PV104302
          CLEAR     PV104303
          CLEAR     PV104304
          CLEAR     PV104305
          CLEAR     PV104306
          CLEAR     PV104307
          CLEAR     PV104308
          CLEAR     PV104309
          CLEAR     PV104401
          CLEAR     PV104501
          CLEAR     PV104601
          CLEAR     PV104701
          CLEAR     PV104801
          CLEAR     PV104901
          CLEAR     PV105001
          CLEAR     PV105002
          CLEAR     PV105003
          CLEAR     PV105004
          CLEAR     PV105005
          CLEAR     PV105006
          CLEAR     PV105101
          CLEAR     PV105201
          CLEAR     PV105202
          CLEAR     PV105203
          CLEAR     PV105204
          CLEAR     PV105205
          CLEAR     PV105206
          CLEAR     PV105207
          CLEAR     PV105208
          CLEAR     PV105209
          CLEAR     PV105210
          CLEAR     PV105211
          CLEAR     PV105212
          CLEAR     PV105213
          CLEAR     PV105214
          CLEAR     PV105215
.
CPV19999  RETURN
+
.*****************************************************************************
.*                               COBR0000          Called by: PROC0000       *
.*                     Clear all OBR variables                               *
.*****************************************************************************
.
.         Fill all variables with spaces so that no data is carried over
.         from a previous message.
.
COBR0000  PACK      OBR00101,SP100
          PACK      OBR00201,SP100
          PACK      OBR00202,SP100
          PACK      OBR00203,SP100
          PACK      OBR00204,SP100
          PACK      OBR00301,SP100
          PACK      OBR00302,SP100
          PACK      OBR00303,SP100
          PACK      OBR00304,SP100
          PACK      OBR00401,SP100,SP100
          PACK      OBR00402,SP100
          PACK      OBR00403,SP100
          PACK      OBR00404,SP100
          PACK      OBR00405,SP100
          PACK      OBR00406,SP100
          PACK      OBR00501,SP100
          PACK      OBR00601,SP100
          PACK      OBR00701,SP100
          PACK      OBR00801,SP100
          PACK      OBR00901,SP100
          PACK      OBR00902,SP100
          PACK      OBR00903,SP100
          PACK      OBR00904,SP100
          PACK      OBR00905,SP100
          PACK      OBR00906,SP100
          PACK      OBR00907,SP100
          PACK      OBR00908,SP100
          PACK      OBR00909,SP100
          PACK      OBR00910,SP100
          PACK      OBR00911,SP100
          PACK      OBR00912,SP100
          PACK      OBR01001,SP100
          PACK      OBR01002,SP100
          PACK      OBR01003,SP100
          PACK      OBR01004,SP100
          PACK      OBR01005,SP100
          PACK      OBR01006,SP100
          PACK      OBR01007,SP100
          PACK      OBR01008,SP100
          PACK      OBR01009,SP100
          PACK      OBR01010,SP100
          PACK      OBR01011,SP100
          PACK      OBR01012,SP100
          PACK      OBR01013,SP100
          PACK      OBR01014,SP100
          PACK      OBR01015,SP100
          PACK      OBR01101,SP100
          PACK      OBR01201,SP100,SP100
          PACK      OBR01202,SP100
          PACK      OBR01203,SP100
          PACK      OBR01204,SP100
          PACK      OBR01205,SP100
          PACK      OBR01206,SP100
          PACK      OBR01301,SP100,SP100,SP100
          PACK      OBR01401,SP100
          PACK      OBR01501,SP100,SP100,SP100
          PACK      OBR01502,SP100
          PACK      OBR01503,SP100
          PACK      OBR01504,SP100
          PACK      OBR01505,SP100
          PACK      OBR01506,SP100
          PACK      OBR01601,SP100,SP100
          PACK      OBR01602,SP100
          PACK      OBR01603,SP100
          PACK      OBR01604,SP100
          PACK      OBR01605,SP100
          PACK      OBR01606,SP100
          PACK      OBR01607,SP100
          PACK      OBR01608,SP100
          PACK      OBR01609,SP100
          PACK      OBR01610,SP100
          PACK      OBR01611,SP100
          PACK      OBR01612,SP100
          PACK      OBR01613,SP100
          PACK      OBR01614,SP100
          PACK      OBR01615,SP100
          PACK      OBR01701,SP100
          PACK      OBR01702,SP100
          PACK      OBR01703,SP100
          PACK      OBR01704,SP100
          PACK      OBR01705,SP100
          PACK      OBR01706,SP100
          PACK      OBR01707,SP100
          PACK      OBR01708,SP100
          PACK      OBR01709,SP100
          PACK      OBR01801,SP100
          PACK      OBR01901,SP100
          PACK      OBR02001,SP100
          PACK      OBR02101,SP100
          PACK      OBR02201,SP100
          PACK      OBR02301,SP100
          PACK      OBR02302,SP100
          PACK      OBR02401,SP100
          PACK      OBR02501,SP100
          PACK      OBR02601,SP100,SP100
          PACK      OBR02602,SP100
          PACK      OBR02603,SP100
          PACK      OBR02701,SP100,SP100
          PACK      OBR02702,SP100
          PACK      OBR02703,SP100
          PACK      OBR02704,SP100
          PACK      OBR02705,SP100
          PACK      OBR02706,SP100
          PACK      OBR02707,SP100
          PACK      OBR02708,SP100
          PACK      OBR02709,SP100
          PACK      OBR02710,SP100
          PACK      OBR02711,SP100
          PACK      OBR02712,SP100
          PACK      OBR02801,SP100,SP100
          PACK      OBR02802,SP100
          PACK      OBR02803,SP100
          PACK      OBR02804,SP100
          PACK      OBR02805,SP100
          PACK      OBR02806,SP100
          PACK      OBR02807,SP100
          PACK      OBR02808,SP100
          PACK      OBR02809,SP100
          PACK      OBR02810,SP100
          PACK      OBR02811,SP100
          PACK      OBR02812,SP100
          PACK      OBR02813,SP100
          PACK      OBR02814,SP100
          PACK      OBR02815,SP100
          PACK      OBR02901,SP100,SP100
          PACK      OBR02902,SP100
          PACK      OBR03001,SP100
          PACK      OBR03101,SP100,SP100
          PACK      OBR03102,SP100
          PACK      OBR03103,SP100
          PACK      OBR03104,SP100
          PACK      OBR03105,SP100
          PACK      OBR03106,SP100
          PACK      OBR03201,SP100,SP100
          PACK      OBR03202,SP100
          PACK      OBR03203,SP100
          PACK      OBR03204,SP100
          PACK      OBR03205,SP100
          PACK      OBR03206,SP100
          PACK      OBR03207,SP100
          PACK      OBR03208,SP100
          PACK      OBR03209,SP100
          PACK      OBR03210,SP100
          PACK      OBR03211,SP100
          PACK      OBR03301,SP100,SP100
          PACK      OBR03302,SP100
          PACK      OBR03303,SP100
          PACK      OBR03304,SP100
          PACK      OBR03305,SP100
          PACK      OBR03306,SP100
          PACK      OBR03307,SP100
          PACK      OBR03308,SP100
          PACK      OBR03309,SP100
          PACK      OBR03310,SP100
          PACK      OBR03311,SP100
          PACK      OBR03401,SP100,SP100
          PACK      OBR03402,SP100
          PACK      OBR03403,SP100
          PACK      OBR03404,SP100
          PACK      OBR03405,SP100
          PACK      OBR03406,SP100
          PACK      OBR03407,SP100
          PACK      OBR03408,SP100
          PACK      OBR03409,SP100
          PACK      OBR03410,SP100
          PACK      OBR03411,SP100
          PACK      OBR03501,SP100,SP100
          PACK      OBR03502,SP100
          PACK      OBR03503,SP100
          PACK      OBR03504,SP100
          PACK      OBR03505,SP100
          PACK      OBR03506,SP100
          PACK      OBR03507,SP100
          PACK      OBR03508,SP100
          PACK      OBR03509,SP100
          PACK      OBR03510,SP100
          PACK      OBR03511,SP100
          PACK      OBR03601,SP100
          PACK      OBR03701,SP100
          PACK      OBR03801,SP100,SP100
          PACK      OBR03802,SP100
          PACK      OBR03803,SP100
          PACK      OBR03804,SP100
          PACK      OBR03805,SP100
          PACK      OBR03806,SP100
          PACK      OBR03901,SP100,SP100
          PACK      OBR03902,SP100
          PACK      OBR03903,SP100
          PACK      OBR03904,SP100
          PACK      OBR03905,SP100
          PACK      OBR03906,SP100
          PACK      OBR04001,SP100,SP100
          PACK      OBR04002,SP100
          PACK      OBR04003,SP100
          PACK      OBR04004,SP100
          PACK      OBR04005,SP100
          PACK      OBR04006,SP100
          PACK      OBR04101,SP100
          PACK      OBR04201,SP100
          PACK      OBR04301,SP100,SP100
          PACK      OBR04302,SP100
          PACK      OBR04303,SP100
          PACK      OBR04304,SP100
          PACK      OBR04305,SP100
          PACK      OBR04306,SP100
          PACK      OBR04401,SP100,SP100
          PACK      OBR04402,SP100
          PACK      OBR04403,SP100
          PACK      OBR04404,SP100
          PACK      OBR04405,SP100
          PACK      OBR04406,SP100
          PACK      OBR04501,SP100,SP100
          PACK      OBR04502,SP100
          PACK      OBR04503,SP100
          PACK      OBR04504,SP100
          PACK      OBR04505,SP100
          PACK      OBR04506,SP100
.
.         Set the LL and FP to zero so that each character received for
.         the field can be APPENDed.
.
          CLEAR     OBR00101
          CLEAR     OBR00201
          CLEAR     OBR00202
          CLEAR     OBR00203
          CLEAR     OBR00204
          CLEAR     OBR00301
          CLEAR     OBR00302
          CLEAR     OBR00303
          CLEAR     OBR00304
          CLEAR     OBR00401
          CLEAR     OBR00402
          CLEAR     OBR00403
          CLEAR     OBR00404
          CLEAR     OBR00405
          CLEAR     OBR00406
          CLEAR     OBR00501
          CLEAR     OBR00601
          CLEAR     OBR00701
          CLEAR     OBR00801
          CLEAR     OBR00901
          CLEAR     OBR00902
          CLEAR     OBR00903
          CLEAR     OBR00904
          CLEAR     OBR00905
          CLEAR     OBR00906
          CLEAR     OBR00907
          CLEAR     OBR00908
          CLEAR     OBR00909
          CLEAR     OBR00910
          CLEAR     OBR00911
          CLEAR     OBR00912
          CLEAR     OBR01001
          CLEAR     OBR01002
          CLEAR     OBR01003
          CLEAR     OBR01004
          CLEAR     OBR01005
          CLEAR     OBR01006
          CLEAR     OBR01007
          CLEAR     OBR01008
          CLEAR     OBR01009
          CLEAR     OBR01010
          CLEAR     OBR01011
          CLEAR     OBR01012
          CLEAR     OBR01013
          CLEAR     OBR01014
          CLEAR     OBR01015
          CLEAR     OBR01101
          CLEAR     OBR01201
          CLEAR     OBR01202
          CLEAR     OBR01203
          CLEAR     OBR01204
          CLEAR     OBR01205
          CLEAR     OBR01206
          CLEAR     OBR01301
          CLEAR     OBR01401
          CLEAR     OBR01501
          CLEAR     OBR01502
          CLEAR     OBR01503
          CLEAR     OBR01504
          CLEAR     OBR01505
          CLEAR     OBR01506
          CLEAR     OBR01601
          CLEAR     OBR01602
          CLEAR     OBR01603
          CLEAR     OBR01604
          CLEAR     OBR01605
          CLEAR     OBR01606
          CLEAR     OBR01607
          CLEAR     OBR01608
          CLEAR     OBR01609
          CLEAR     OBR01610
          CLEAR     OBR01611
          CLEAR     OBR01612
          CLEAR     OBR01613
          CLEAR     OBR01614
          CLEAR     OBR01615
          CLEAR     OBR01701
          CLEAR     OBR01702
          CLEAR     OBR01703
          CLEAR     OBR01704
          CLEAR     OBR01705
          CLEAR     OBR01706
          CLEAR     OBR01707
          CLEAR     OBR01708
          CLEAR     OBR01709
          CLEAR     OBR01801
          CLEAR     OBR01901
          CLEAR     OBR02001
          CLEAR     OBR02101
          CLEAR     OBR02201
          CLEAR     OBR02301
          CLEAR     OBR02302
          CLEAR     OBR02401
          CLEAR     OBR02501
          CLEAR     OBR02601
          CLEAR     OBR02602
          CLEAR     OBR02603
          CLEAR     OBR02701
          CLEAR     OBR02702
          CLEAR     OBR02703
          CLEAR     OBR02704
          CLEAR     OBR02705
          CLEAR     OBR02706
          CLEAR     OBR02707
          CLEAR     OBR02708
          CLEAR     OBR02709
          CLEAR     OBR02710
          CLEAR     OBR02711
          CLEAR     OBR02712
          CLEAR     OBR02801
          CLEAR     OBR02802
          CLEAR     OBR02803
          CLEAR     OBR02804
          CLEAR     OBR02805
          CLEAR     OBR02806
          CLEAR     OBR02807
          CLEAR     OBR02808
          CLEAR     OBR02809
          CLEAR     OBR02810
          CLEAR     OBR02811
          CLEAR     OBR02812
          CLEAR     OBR02813
          CLEAR     OBR02814
          CLEAR     OBR02815
          CLEAR     OBR02901
          CLEAR     OBR02902
          CLEAR     OBR03001
          CLEAR     OBR03101
          CLEAR     OBR03102
          CLEAR     OBR03103
          CLEAR     OBR03104
          CLEAR     OBR03105
          CLEAR     OBR03106
          CLEAR     OBR03201
          CLEAR     OBR03202
          CLEAR     OBR03203
          CLEAR     OBR03204
          CLEAR     OBR03205
          CLEAR     OBR03206
          CLEAR     OBR03207
          CLEAR     OBR03208
          CLEAR     OBR03209
          CLEAR     OBR03210
          CLEAR     OBR03211
          CLEAR     OBR03301
          CLEAR     OBR03302
          CLEAR     OBR03303
          CLEAR     OBR03304
          CLEAR     OBR03305
          CLEAR     OBR03306
          CLEAR     OBR03307
          CLEAR     OBR03308
          CLEAR     OBR03309
          CLEAR     OBR03310
          CLEAR     OBR03311
          CLEAR     OBR03401
          CLEAR     OBR03402
          CLEAR     OBR03403
          CLEAR     OBR03404
          CLEAR     OBR03405
          CLEAR     OBR03406
          CLEAR     OBR03407
          CLEAR     OBR03408
          CLEAR     OBR03409
          CLEAR     OBR03410
          CLEAR     OBR03411
          CLEAR     OBR03501
          CLEAR     OBR03502
          CLEAR     OBR03503
          CLEAR     OBR03504
          CLEAR     OBR03505
          CLEAR     OBR03506
          CLEAR     OBR03507
          CLEAR     OBR03508
          CLEAR     OBR03509
          CLEAR     OBR03510
          CLEAR     OBR03511
          CLEAR     OBR03601
          CLEAR     OBR03701
          CLEAR     OBR03801
          CLEAR     OBR03802
          CLEAR     OBR03803
          CLEAR     OBR03804
          CLEAR     OBR03805
          CLEAR     OBR03806
          CLEAR     OBR03901
          CLEAR     OBR03902
          CLEAR     OBR03903
          CLEAR     OBR03904
          CLEAR     OBR03905
          CLEAR     OBR03906
          CLEAR     OBR04001
          CLEAR     OBR04002
          CLEAR     OBR04003
          CLEAR     OBR04004
          CLEAR     OBR04005
          CLEAR     OBR04006
          CLEAR     OBR04101
          CLEAR     OBR04201
          CLEAR     OBR04301
          CLEAR     OBR04302
          CLEAR     OBR04303
          CLEAR     OBR04304
          CLEAR     OBR04305
          CLEAR     OBR04306
          CLEAR     OBR04401
          CLEAR     OBR04402
          CLEAR     OBR04403
          CLEAR     OBR04404
          CLEAR     OBR04405
          CLEAR     OBR04406
          CLEAR     OBR04501
          CLEAR     OBR04502
          CLEAR     OBR04503
          CLEAR     OBR04504
          CLEAR     OBR04505
          CLEAR     OBR04506
.
COBR9999  RETURN
+
.*****************************************************************************
.*                           RFLD0000              Called by: GCHR0000       *
.*           Reset the HL7 component field just loaded        PROC0000       *
.*****************************************************************************
.
RFLD0000  PERFORM   SEGNUMBR,RMSH0000:           * MSH
                             RPID0000:           * PID
                             RPV10000:           * PV1
                             RORC0000:           * ORC
                             RRXD0000:           * RXD
                             RRXR0000            * RXR
.
RFLD9999  RETURN
+
.*****************************************************************************
.*                              RMSH0000           Called by: RFLD0000       *
.*                      Reset all MSH variables                              *
.*    Also need to save some variables to send back in the acknowledgement   *
.*    message.                                                               *
.*****************************************************************************
.
RMSH0000  BRANCH    FIELDNO,RMSH0100:            * Field Separator
                            RMSH0200:            * Encoding Characters
                            RMSH0300:            * Sending Application
                            RMSH0400:            * Sending Facility
                            RMSH0500:            * Receiving Application
                            RMSH0600:            * Receiving Facility
                            RMSH0700:            * Date/Time of Message
                            RMSH0800:            * Security
                            RMSH0900:            * Message Type
                            RMSH1000:            * Message Control ID
                            RMSH1100:            * Processing ID
                            RMSH1200:            * Version ID
                            RMSH1300:            * Sequence Number
                            RMSH1400:            * Continuation Pointer
                            RMSH1500:            * Accept Acknowledgement Type
                            RMSH1600:            * Applic'n Acknowledgment Type
                            RMSH1700:            * Country Code
                            RMSH1800:            * Character Set
                            RMSH1900:            * Principal Language of Message
                            RMSH2000             * Alt. Char. Set Hand. Scheme
          GOTO      RMSH9999
.
.         MSH.1 - Field Separator (already set)
.
RMSH0100  GOTO      RMSH9999
.
.         MSH.2 - Encoding Characters
.
RMSH0200  BRANCH    COMPCNT,RMSH0201
          GOTO      RMSH9999
.
RMSH0201  RESET     MSH00201
          GOTO      RMSH9999
.
.         MSH.3 - Sending Application
.
RMSH0300  BRANCH    COMPCNT,RMSH0301:
                            RMSH0302:
                            RMSH0303
          GOTO      RMSH9999
.
RMSH0301  RESET     MSH00301
          MOVE      MSH00301,SAVAPPLI
          GOTO      RMSH9999
.
RMSH0302  RESET     MSH00302
          STRIP     SAVAPPLI
          ENDSET    SAVAPPLI
          APPEND    CARET,SAVAPPLI
          APPEND    MSH00302,SAVAPPLI
          RESET     SAVAPPLI
          GOTO      RMSH9999
.
RMSH0303  RESET     MSH00303
          STRIP     SAVAPPLI
          ENDSET    SAVAPPLI
          APPEND    CARET,SAVAPPLI
          APPEND    MSH00303,SAVAPPLI
          RESET     SAVAPPLI
          GOTO      RMSH9999
.
.         MSH.4 - Sending Facility
.
RMSH0400  BRANCH    COMPCNT,RMSH0401:
                            RMSH0402:
                            RMSH0403 
          GOTO      RMSH9999
.
RMSH0401  RESET     MSH00401
          MOVE      MSH00401,SAVFACIL
          GOTO      RMSH9999
.
RMSH0402  RESET     MSH00402
          STRIP     SAVFACIL
          ENDSET    SAVFACIL
          APPEND    CARET,SAVFACIL
          APPEND    MSH00402,SAVFACIL
          RESET     SAVFACIL
          GOTO      RMSH9999
.
RMSH0403  RESET     MSH00403
          STRIP     SAVFACIL
          ENDSET    SAVFACIL
          APPEND    CARET,SAVFACIL
          APPEND    MSH00403,SAVFACIL
          RESET     SAVFACIL
          GOTO      RMSH9999
.
.         MSH.5 - Receiving Application
.
RMSH0500  BRANCH    COMPCNT,RMSH0501:
                            RMSH0502:
                            RMSH0503
          GOTO      RMSH9999
.
RMSH0501  RESET     MSH00501
          GOTO      RMSH9999
.
RMSH0502  RESET     MSH00502
          GOTO      RMSH9999
.
RMSH0503  RESET     MSH00503
          GOTO      RMSH9999
.
.         MSH.6 - Receiving Facility
.
RMSH0600  BRANCH    COMPCNT,RMSH0601:
                            RMSH0602:
                            RMSH0603
          GOTO      RMSH9999
.
RMSH0601  RESET     MSH00601
          GOTO      RMSH9999
.
RMSH0602  RESET     MSH00602
          GOTO      RMSH9999
.
RMSH0603  RESET     MSH00603
          GOTO      RMSH9999
.
.         MSH.7 - Date/Time of Message
.
RMSH0700  BRANCH    COMPCNT,RMSH0701
          GOTO      RMSH9999
.
RMSH0701  RESET     MSH00701
          GOTO      RMSH9999
.
.         MSH.8 - Security
.
RMSH0800  BRANCH    COMPCNT,RMSH0801
          GOTO      RMSH9999
.
RMSH0801  RESET     MSH00801
          GOTO      RMSH9999
.
.         MSH.9 - Message Type
.
RMSH0900  BRANCH    COMPCNT,RMSH0901:
                            RMSH0902:
                            RMSH0903
          GOTO      RMSH9999
.
RMSH0901  RESET     MSH00901
          GOTO      RMSH9999
.
RMSH0902  RESET     MSH00902
          GOTO      RMSH9999
.
RMSH0903  RESET     MSH00903
          GOTO      RMSH9999
.
.         MSH.10 - Message Control ID
.
RMSH1000  BRANCH    COMPCNT,RMSH1001
          GOTO      RMSH9999
.
RMSH1001  RESET     MSH01001
          MOVE      MSH01001,SAVMESID
          GOTO      RMSH9999
.
.         MSH.11 - Processing ID
.
RMSH1100  BRANCH    COMPCNT,RMSH1101:
                            RMSH1102
          GOTO      RMSH9999
.
RMSH1101  RESET     MSH01101
          MOVE      MSH01101,SAVPRCID
          GOTO      RMSH9999
.
RMSH1102  RESET     MSH01102
          GOTO      RMSH9999
.
.         MSH.12 - Version ID
.
RMSH1200  BRANCH    COMPCNT,RMSH1201:
                            RMSH1202:
                            RMSH1203
          GOTO      RMSH9999
.
RMSH1201  RESET     MSH01201
          GOTO      RMSH9999
.
RMSH1202  RESET     MSH01202
          GOTO      RMSH9999
.
RMSH1203  RESET     MSH01203
          GOTO      RMSH9999
.
.         MSH.13 - Sequence Number
.
RMSH1300  BRANCH    COMPCNT,RMSH1301
          GOTO      RMSH9999
.
RMSH1301  RESET     MSH01301
          GOTO      RMSH9999
.
.         MSH.14 - Continuation Pointer
.
RMSH1400  BRANCH    COMPCNT,RMSH1401
          GOTO      RMSH9999
.
RMSH1401  RESET     MSH01401
          GOTO      RMSH9999
.
.         MSH.15 - Accept Acknowledgement Type
.
RMSH1500  BRANCH    COMPCNT,RMSH1501
          GOTO      RMSH9999
.
RMSH1501  RESET     MSH01501
          GOTO      RMSH9999
.
.         MSH.16 - Application Acknowledgment Type
.
RMSH1600  BRANCH    COMPCNT,RMSH1601
          GOTO      RMSH9999
.
RMSH1601  RESET     MSH01601
          GOTO      RMSH9999
.
.         MSH.17 - Country Code
.
RMSH1700  BRANCH    COMPCNT,RMSH1701
          GOTO      RMSH9999
.
RMSH1701  RESET     MSH01701
          GOTO      RMSH9999
.
.         MSH.18 - Character Set
.
RMSH1800  BRANCH    COMPCNT,RMSH1801
          GOTO      RMSH9999
.
RMSH1801  RESET     MSH01801
          GOTO      RMSH9999
.
.         MSH.19 - Principal Language of Message
.
RMSH1900  BRANCH    COMPCNT,RMSH1901:
                            RMSH1902:
                            RMSH1903:
                            RMSH1904:
                            RMSH1905:
                            RMSH1906
          GOTO      RMSH9999
.
RMSH1901  RESET     MSH01901
          GOTO      RMSH9999
.
RMSH1902  RESET     MSH01902
          GOTO      RMSH9999
.
RMSH1903  RESET     MSH01903
          GOTO      RMSH9999
.
RMSH1904  RESET     MSH01904
          GOTO      RMSH9999
.
RMSH1905  RESET     MSH01905
          GOTO      RMSH9999
.
RMSH1906  RESET     MSH01906
          GOTO      RMSH9999
.
.         MSH.20 - Alternate Character Set Handling Scheme
.
RMSH2000  BRANCH    COMPCNT,RMSH2001
          GOTO      RMSH9999
.
RMSH2001  RESET     MSH02001
          GOTO      RMSH9999
.
RMSH9999  RETURN
+
.*****************************************************************************
.*                              RPID0000           Called by: RFLD0000       *
.*                         Reset all PID variables                           *
.*****************************************************************************
.
RPID0000  BRANCH    FIELDNO,RPID0100:            * set id
                            RPID0200:            * patient id
                            RPID0300:            * patient identifier list
                            RPID0400:            * alternate patient id
                            RPID0500:            * patient name
                            RPID0600:            * mother's maiden name
                            RPID0700:            * date/time of birth
                            RPID0800:            * sex
                            RPID0900:            * patient alias
                            RPID1000:            * race
                            RPID1100:            * patient address
                            RPID1200:            * county code
                            RPID1300:            * phone number - home
                            RPID1400:            * phone number - business
                            RPID1500:            * primary language
                            RPID1600:            * marital status
                            RPID1700:            * religion
                            RPID1800:            * patient account number
                            RPID1900:            * ssn number
                            RPID2000:            * driver's license number
                            RPID2100:            * mother's identifier
                            RPID2200:            * ethnic group
                            RPID2300:            * birth place
                            RPID2400:            * multiple birth indicator
                            RPID2500:            * birth order
                            RPID2600:            * citizenship
                            RPID2700:            * veterans military status
                            RPID2800:            * nationality
                            RPID2900:            * patient death date/time
                            RPID3000             * patient death indicator
          GOTO      RPID9999
.
.         PID.1 - Set Id
.
RPID0100  BRANCH    COMPCNT,RPID0101
          GOTO      RPID9999
.
RPID0101  RESET     PID00101
          GOTO      RPID9999
.
.         PID.2 - Patient Id
.
RPID0200  BRANCH    COMPCNT,RPID0201:
                            RPID0202:
                            RPID0203:
                            RPID0204:
                            RPID0205:
                            RPID0206 
          GOTO      RPID9999
.
RPID0201  RESET     PID00201
          GOTO      RPID9999
.
RPID0202  RESET     PID00202
          GOTO      RPID9999
.
RPID0203  RESET     PID00203
          GOTO      RPID9999
.
RPID0204  RESET     PID00204
          GOTO      RPID9999
.
RPID0205  RESET     PID00205
          GOTO      RPID9999
.
RPID0206  RESET     PID00206
          GOTO      RPID9999
.
.         PID.3 - Patient Identifier List
.                 (maximum of 4 repeats - 5 identifiers in total)
.
RPID0300  COMPARE   REPTNCNT,FIVE                * maximum repeats reached ?
          GOTO      RPID9999 IF LESS             * yes
.
          BRANCH    COMPCNT,RPID0301:
                            RPID0302:
                            RPID0303:
                            RPID0304:
                            RPID0305:
                            RPID0306 
          GOTO      RPID9999
.
RPID0301  RESET     PID00301[REPTNCNT]
          MOVE      PID00301[REPTNCNT],OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID00301[REPTNCNT]
          GOTO      RPID9999
.
RPID0302  RESET     PID00302[REPTNCNT]
          GOTO      RPID9999
.
RPID0303  RESET     PID00303[REPTNCNT]
          GOTO      RPID9999
.
RPID0304  RESET     PID00304[REPTNCNT]
          GOTO      RPID9999
.
RPID0305  RESET     PID00305[REPTNCNT]
          GOTO      RPID9999
.
RPID0306  RESET     PID00306[REPTNCNT]
          GOTO      RPID9999
.
.         PID.4 - Alternate Patient Id
.
RPID0400  BRANCH    COMPCNT,RPID0401:
                            RPID0402:
                            RPID0403:
                            RPID0404:
                            RPID0405:
                            RPID0406 
          GOTO      RPID9999
.
RPID0401  RESET     PID00401
          GOTO      RPID9999
.
RPID0402  RESET     PID00402
          GOTO      RPID9999
.
RPID0403  RESET     PID00403
          GOTO      RPID9999
.
RPID0404  RESET     PID00404
          GOTO      RPID9999
.
RPID0405  RESET     PID00405
          GOTO      RPID9999
.
RPID0406  RESET     PID00406
          GOTO      RPID9999
.
.         PID.5 - Patient Name
.
RPID0500  BRANCH    COMPCNT,RPID0501:
                            RPID0502:
                            RPID0503:
                            RPID0504:
                            RPID0505:
                            RPID0506:
                            RPID0507:
                            RPID0508 
          GOTO      RPID9999
.
RPID0501  RESET     PID00501
          MOVE      PID00501,OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID00501
          MATCH     BLANKSTR,PID00501
          IF        !@EQUAL
            REP       "#"'",PID00501
          ENDIF
          GOTO      RPID9999
.
RPID0502  RESET     PID00502
          MOVE      PID00502,OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID00502
          MATCH     BLANKSTR,PID00502
          IF        !@EQUAL
            REP       "#"'",PID00502
          ENDIF
          GOTO      RPID9999
.
RPID0503  RESET     PID00503
          MOVE      PID00503,OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID00503
          MATCH     BLANKSTR,PID00503
          IF        !@EQUAL
            REP       "#"'",PID00503
          ENDIF
          GOTO      RPID9999
.
RPID0504  RESET     PID00504
          GOTO      RPID9999
.
RPID0505  RESET     PID00505
          MOVE      PID00505,OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID00505
          GOTO      RPID9999
.
RPID0506  RESET     PID00506
          GOTO      RPID9999
.
RPID0507  RESET     PID00507
          GOTO      RPID9999
.
RPID0508  RESET     PID00508
          GOTO      RPID9999
.
.         PID.6 - Mother's Maiden Name
.
RPID0600  BRANCH    COMPCNT,RPID0601:
                            RPID0602:
                            RPID0603:
                            RPID0604:
                            RPID0605:
                            RPID0606:
                            RPID0607:
                            RPID0608 
          GOTO      RPID9999
.
RPID0601  RESET     PID00601
          GOTO      RPID9999
.
RPID0602  RESET     PID00602
          GOTO      RPID9999
.
RPID0603  RESET     PID00603
          GOTO      RPID9999
.
RPID0604  RESET     PID00604
          GOTO      RPID9999
.
RPID0605  RESET     PID00605
          GOTO      RPID9999
.
RPID0606  RESET     PID00606
          GOTO      RPID9999
.
RPID0607  RESET     PID00607
          GOTO      RPID9999
.
RPID0608  RESET     PID00608
          GOTO      RPID9999
.
.         PID.7 - Date/Time of Birth
.
RPID0700  BRANCH    COMPCNT,RPID0701
          GOTO      RPID9999
.
RPID0701  RESET     PID00701
          GOTO      RPID9999
.
.         PID.8 - Sex
.
RPID0800  BRANCH    COMPCNT,RPID0801
          GOTO      RPID9999
.
RPID0801  RESET     PID00801
          GOTO      RPID9999
.
.         PID.9 - Patient Alias
.                 (maximum of 79 repeats - 80 aliases in total)
.
RPID0900  COMPARE   REPTNCNT,EIGHTY              * maximum repeats reached ?
          GOTO      RPID9999 IF LESS             * yes
.
          BRANCH    COMPCNT,RPID0901:
                            RPID0902:
                            RPID0903:
                            RPID0904:
                            RPID0905:
                            RPID0906:
                            RPID0907:
                            RPID0908 
          GOTO      RPID9999
.
RPID0901  RESET     PID00901[REPTNCNT]
          MOVE      PID00901[REPTNCNT],OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID00901[REPTNCNT]
          GOTO      RPID9999
.
RPID0902  RESET     PID00902[REPTNCNT]
          MOVE      PID00902[REPTNCNT],OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID00902[REPTNCNT]
          GOTO      RPID9999
.
RPID0903  RESET     PID00903[REPTNCNT]
          MOVE      PID00903[REPTNCNT],OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID00903[REPTNCNT]
          GOTO      RPID9999
.
RPID0904  RESET     PID00904[REPTNCNT]
          GOTO      RPID9999
.
RPID0905  RESET     PID00905[REPTNCNT]
          GOTO      RPID9999
.
RPID0906  RESET     PID00906[REPTNCNT]
          GOTO      RPID9999
.
RPID0907  RESET     PID00907[REPTNCNT]
          GOTO      RPID9999
.
RPID0908  RESET     PID00908[REPTNCNT]
          GOTO      RPID9999
.
.         PID.10 - Race
.
RPID1000  BRANCH    COMPCNT,RPID1001:
                            RPID1002:
                            RPID1003:
                            RPID1004:
                            RPID1005:
                            RPID1006 
          GOTO      RPID9999
.
RPID1001  RESET     PID01001
          GOTO      RPID9999
.
RPID1002  RESET     PID01002
          GOTO      RPID9999
.
RPID1003  RESET     PID01003
          GOTO      RPID9999
.
RPID1004  RESET     PID01004
          GOTO      RPID9999
.
RPID1005  RESET     PID01005
          GOTO      RPID9999
.
RPID1006  RESET     PID01006
          GOTO      RPID9999
.
.         PID.11 - Patient Address
.                  (maximum of 1 repeat - 2 addresses in total)
.
RPID1100  COMPARE   REPTNCNT,TWO                 * maximum repeats reached ?
          GOTO      RPID9999 IF LESS             * yes
.
          BRANCH    COMPCNT,RPID1101:
                            RPID1102:
                            RPID1103:
                            RPID1104:
                            RPID1105:
                            RPID1106:
                            RPID1107:
                            RPID1108:
                            RPID1109:
                            RPID1110:
                            RPID1111
          GOTO      RPID9999
.
RPID1101  RESET     PID01101[REPTNCNT]
          MOVE      PID01101[REPTNCNT],OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID01101[REPTNCNT]
          REP       UPPLOW,PID01101[REPTNCNT]
          MATCH     BLANKSTR,PID01101[REPTNCNT]
          IF        !@EQUAL
            REP       "#"'",PID01101[REPTNCNT]
          ENDIF
          GOTO      RPID9999
.
RPID1102  RESET     PID01102[REPTNCNT]
          MOVE      PID01102[REPTNCNT],OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID01102[REPTNCNT]
          REP       UPPLOW,PID01102[REPTNCNT]
          MATCH     BLANKSTR,PID01102[REPTNCNT]
          IF        !@EQUAL
            REP       "#"'",PID01102[REPTNCNT]
          ENDIF
          GOTO      RPID9999
.
RPID1103  RESET     PID01103[REPTNCNT]
          MOVE      PID01103[REPTNCNT],OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID01103[REPTNCNT]
          REP       UPPLOW,PID01103[REPTNCNT]
          MATCH     BLANKSTR,PID01103[REPTNCNT]
          IF        !@EQUAL
            REP       "#"'",PID01103[REPTNCNT]
          ENDIF
          GOTO      RPID9999
.
RPID1104  RESET     PID01104[REPTNCNT]
          MOVE      PID01104[REPTNCNT],OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID01104[REPTNCNT]
          REP       UPPLOW,PID01104[REPTNCNT]
          MATCH     BLANKSTR,PID01104[REPTNCNT]
          IF        !@EQUAL
            REP       "#"'",PID01104[REPTNCNT]
          ENDIF
          GOTO      RPID9999
.
RPID1105  RESET     PID01105[REPTNCNT]
          MOVE      PID01105[REPTNCNT],OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID01105[REPTNCNT]
          GOTO      RPID9999
.
RPID1106  RESET     PID01106[REPTNCNT]
          MOVE      PID01106[REPTNCNT],OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID01106[REPTNCNT]
          GOTO      RPID9999
.
RPID1107  RESET     PID01107[REPTNCNT]
          GOTO      RPID9999
.
RPID1108  RESET     PID01108[REPTNCNT]
          GOTO      RPID9999
.
RPID1109  RESET     PID01109[REPTNCNT]
          GOTO      RPID9999
.
RPID1110  RESET     PID01110[REPTNCNT]
          GOTO      RPID9999
.
RPID1111  RESET     PID01111[REPTNCNT]
          GOTO      RPID9999
.
.         PID.12 - County Code
.
RPID1200  BRANCH    COMPCNT,RPID1201
          GOTO      RPID9999
.
RPID1201  RESET     PID01201
          GOTO      RPID9999
.
.         PID.13 - Phone Number - Home
.                  (maximum of 1 repeat - 2 phone numbers in total)
.
RPID1300  COMPARE   REPTNCNT,TWO                 * maximum repeats reached ?
          GOTO      RPID9999 IF LESS             * yes
.
          BRANCH    COMPCNT,RPID1301:
                            RPID1302:
                            RPID1303:
                            RPID1304:
                            RPID1305:
                            RPID1306:
                            RPID1307:
                            RPID1308:
                            RPID1309
          GOTO      RPID9999
.
RPID1301  RESET     PID01301[REPTNCNT]
          GOTO      RPID9999
.
RPID1302  RESET     PID01302[REPTNCNT]
          GOTO      RPID9999
.
RPID1303  RESET     PID01303[REPTNCNT]
          GOTO      RPID9999
.
RPID1304  RESET     PID01304[REPTNCNT]
          GOTO      RPID9999
.
RPID1305  RESET     PID01305[REPTNCNT]
          GOTO      RPID9999
.
RPID1306  RESET     PID01306[REPTNCNT]
          GOTO      RPID9999
.
RPID1307  RESET     PID01307[REPTNCNT]
          MOVE      PID01307[REPTNCNT],OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID01307[REPTNCNT]
          GOTO      RPID9999
.
RPID1308  RESET     PID01308[REPTNCNT]
          GOTO      RPID9999
.
RPID1309  RESET     PID01309[REPTNCNT]
          MOVE      PID01309[REPTNCNT],OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID01309[REPTNCNT]
          GOTO      RPID9999
.
.         PID.14 - Phone Number - Business
.                  (maximum of 1 repeat - 2 phone numbers in total)
.
RPID1400  COMPARE   REPTNCNT,TWO                 * maximum repeats reached ?
          GOTO      RPID9999 IF LESS             * yes
.
          BRANCH    COMPCNT,RPID1401:
                            RPID1402:
                            RPID1403:
                            RPID1404:
                            RPID1405:
                            RPID1406:
                            RPID1407:
                            RPID1408:
                            RPID1409
          GOTO      RPID9999
.
RPID1401  RESET     PID01401[REPTNCNT]
          GOTO      RPID9999
.
RPID1402  RESET     PID01402[REPTNCNT]
          GOTO      RPID9999
.
RPID1403  RESET     PID01403[REPTNCNT]
          GOTO      RPID9999
.
RPID1404  RESET     PID01404[REPTNCNT]
          GOTO      RPID9999
.
RPID1405  RESET     PID01405[REPTNCNT]
          GOTO      RPID9999
.
RPID1406  RESET     PID01406[REPTNCNT]
          GOTO      RPID9999
.
RPID1407  RESET     PID01407[REPTNCNT]
          MOVE      PID01407[REPTNCNT],OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID01407[REPTNCNT]
          GOTO      RPID9999
.
RPID1408  RESET     PID01408[REPTNCNT]
          GOTO      RPID9999
.
RPID1409  RESET     PID01409[REPTNCNT]
          MOVE      PID01409[REPTNCNT],OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID01409[REPTNCNT]
          GOTO      RPID9999
.
.         PID.15 - Primary Language
.
RPID1500  BRANCH    COMPCNT,RPID1501:
                            RPID1502:
                            RPID1503:
                            RPID1504:
                            RPID1505:
                            RPID1506
          GOTO      RPID9999
.
RPID1501  RESET     PID01501
          GOTO      RPID9999
.
RPID1502  RESET     PID01502
          GOTO      RPID9999
.
RPID1503  RESET     PID01503
          GOTO      RPID9999
.
RPID1504  RESET     PID01504
          GOTO      RPID9999
.
RPID1505  RESET     PID01505
          GOTO      RPID9999
.
RPID1506  RESET     PID01506
          GOTO      RPID9999
.
.         PID.16 - Marital Status
.
RPID1600  BRANCH    COMPCNT,RPID1601:
                            RPID1602:
                            RPID1603:
                            RPID1604:
                            RPID1605:
                            RPID1606
          GOTO      RPID9999
.
RPID1601  RESET     PID01601
          GOTO      RPID9999
.
RPID1602  RESET     PID01602
          GOTO      RPID9999
.
RPID1603  RESET     PID01603
          GOTO      RPID9999
.
RPID1604  RESET     PID01604
          GOTO      RPID9999
.
RPID1605  RESET     PID01605
          GOTO      RPID9999
.
RPID1606  RESET     PID01606
          GOTO      RPID9999
.
.         PID.17 - Religion
.
RPID1700  BRANCH    COMPCNT,RPID1701:
                            RPID1702:
                            RPID1703:
                            RPID1704:
                            RPID1705:
                            RPID1706
          GOTO      RPID9999
.
RPID1701  RESET     PID01701
          MOVE      PID01701,OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID01701
          GOTO      RPID9999
.
RPID1702  RESET     PID01702
          GOTO      RPID9999
.
RPID1703  RESET     PID01703
          GOTO      RPID9999
.
RPID1704  RESET     PID01704
          GOTO      RPID9999
.
RPID1705  RESET     PID01705
          GOTO      RPID9999
.
RPID1706  RESET     PID01706
          GOTO      RPID9999
.
.         PID.18 - Patient Account Number
.
RPID1800  BRANCH    COMPCNT,RPID1801:
                            RPID1802:
                            RPID1803:
                            RPID1804:
                            RPID1805:
                            RPID1806
          GOTO      RPID9999
.
RPID1801  RESET     PID01801
          GOTO      RPID9999
.
RPID1802  RESET     PID01802
          GOTO      RPID9999
.
RPID1803  RESET     PID01803
          GOTO      RPID9999
.
RPID1804  RESET     PID01804
          GOTO      RPID9999
.
RPID1805  RESET     PID01805
          GOTO      RPID9999
.
RPID1806  RESET     PID01806
          GOTO      RPID9999
.
.         PID.19 - SSN Number
.
RPID1900  BRANCH    COMPCNT,RPID1901
          GOTO      RPID9999
.
RPID1901  RESET     PID01901
          GOTO      RPID9999
.
.         PID.20 - Driver's License Number
.
RPID2000  BRANCH    COMPCNT,RPID2001:
                            RPID2002:
                            RPID2003
          GOTO      RPID9999
.
RPID2001  RESET     PID02001
          GOTO      RPID9999
.
RPID2002  RESET     PID02002
          GOTO      RPID9999
.
RPID2003  RESET     PID02003
          GOTO      RPID9999
.
.         PID.21 - Mother's Identifier
.
RPID2100  BRANCH    COMPCNT,RPID2101:
                            RPID2102:
                            RPID2103:
                            RPID2104:
                            RPID2105:
                            RPID2106
          GOTO      RPID9999
.
RPID2101  RESET     PID02101
          GOTO      RPID9999
.
RPID2102  RESET     PID02102
          GOTO      RPID9999
.
RPID2103  RESET     PID02103
          GOTO      RPID9999
.
RPID2104  RESET     PID02104
          GOTO      RPID9999
.
RPID2105  RESET     PID02105
          GOTO      RPID9999
.
RPID2106  RESET     PID02106
          GOTO      RPID9999
.
.         PID.22 - Ethnic Group
.
RPID2200  BRANCH    COMPCNT,RPID2201:
                            RPID2202:
                            RPID2203:
                            RPID2204:
                            RPID2205:
                            RPID2206
          GOTO      RPID9999
.
RPID2201  RESET     PID02201
          GOTO      RPID9999
.
RPID2202  RESET     PID02202
          GOTO      RPID9999
.
RPID2203  RESET     PID02203
          GOTO      RPID9999
.
RPID2204  RESET     PID02204
          GOTO      RPID9999
.
RPID2205  RESET     PID02205
          GOTO      RPID9999
.
RPID2206  RESET     PID02206
          GOTO      RPID9999
.
.         PID.23 - Birth Place
.
RPID2300  BRANCH    COMPCNT,RPID2301
          GOTO      RPID9999
.
RPID2301  RESET     PID02301
          GOTO      RPID9999
.
.         PID.24 - Multiple Birth Indicator
.
RPID2400  BRANCH    COMPCNT,RPID2401
          GOTO      RPID9999
.
RPID2401  RESET     PID02401
          GOTO      RPID9999
.
.         PID.25 - Birth Order
.
RPID2500  BRANCH    COMPCNT,RPID2501
          GOTO      RPID9999
.
RPID2501  RESET     PID02501
          GOTO      RPID9999
.
.         PID.26 - Citizenship
.
RPID2600  BRANCH    COMPCNT,RPID2601:
                            RPID2602:
                            RPID2603:
                            RPID2604:
                            RPID2605:
                            RPID2606
          GOTO      RPID9999
.
RPID2601  RESET     PID02601
          GOTO      RPID9999
.
RPID2602  RESET     PID02602
          GOTO      RPID9999
.
RPID2603  RESET     PID02603
          GOTO      RPID9999
.
RPID2604  RESET     PID02604
          GOTO      RPID9999
.
RPID2605  RESET     PID02605
          GOTO      RPID9999
.
RPID2606  RESET     PID02606
          GOTO      RPID9999
.
.         PID.27 - Veteran's Military Status
.
RPID2700  BRANCH    COMPCNT,RPID2701:
                            RPID2702:
                            RPID2703:
                            RPID2704:
                            RPID2705:
                            RPID2706
          GOTO      RPID9999
.
RPID2701  RESET     PID02701
          GOTO      RPID9999
.
RPID2702  RESET     PID02702
          GOTO      RPID9999
.
RPID2703  RESET     PID02703
          GOTO      RPID9999
.
RPID2704  RESET     PID02704
          GOTO      RPID9999
.
RPID2705  RESET     PID02705
          GOTO      RPID9999
.
RPID2706  RESET     PID02706
          GOTO      RPID9999
.
.         PID.28 - Nationality
.
RPID2800  BRANCH    COMPCNT,RPID2801:
                            RPID2802:
                            RPID2803:
                            RPID2804:
                            RPID2805:
                            RPID2806
          GOTO      RPID9999
.
RPID2801  RESET     PID02801
          MOVE      PID02801,OLDSTRNG
          CALL      CONV0000                     * convert any escape sequences
          MOVE      NEWSTRNG,PID02801
          GOTO      RPID9999
.
RPID2802  RESET     PID02802
          GOTO      RPID9999
.
RPID2803  RESET     PID02803
          GOTO      RPID9999
.
RPID2804  RESET     PID02804
          GOTO      RPID9999
.
RPID2805  RESET     PID02805
          GOTO      RPID9999
.
RPID2806  RESET     PID02806
          GOTO      RPID9999
.
.         PID.29 - Patient Death Date/Time
.
RPID2900  BRANCH    COMPCNT,RPID2901
          GOTO      RPID9999
.
RPID2901  RESET     PID02901
          GOTO      RPID9999
.
.         PID.30 - Patient Death Indicator
.
RPID3000  BRANCH    COMPCNT,RPID3001
          GOTO      RPID9999
.
RPID3001  RESET     PID03001
          GOTO      RPID9999
.
RPID9999  RETURN
+
.*****************************************************************************
.*                              RPV10000           Called by: RFLD0000       *
.*                         Reset all PV1 variables                           *
.*****************************************************************************
.
RPV10000  BRANCH    FIELDNO,RPV10100:            * set id
                            RPV10200:            * patient class
                            RPV10300:            * assigned patient location
                            RPV10400:            * admissiotn type
                            RPV10500:            * preadmit number
                            RPV10600:            * prior patient location
                            RPV10700:            * attending doctor
                            RPV10800:            * referring doctor
                            RPV10900:            * consulting doctor
                            RPV11000:            * hospital service
                            RPV11100:            * temprorary location
                            RPV11200:            * preadmit test indicator
                            RPV11300:            * re-admission indicator
                            RPV11400:            * admit source
                            RPV11500:            * ambulatory status
                            RPV11600:            * vip indicator
                            RPV11700:            * admitting doctor
                            RPV11800:            * patient type
                            RPV11900:            * visit number
                            RPV12000:            * financial class
                            RPV12100:            * charge price indicator
                            RPV12200:            * courtesy code
                            RPV12300:            * credit rating
                            RPV12400:            * contract code
                            RPV12500:            * contract effective date
                            RPV12600:            * contract amount
                            RPV12700:            * contract period
                            RPV12800:            * interest code
                            RPV12900:            * transfer to bad debt code
                            RPV13000:            * transfer to bad debt date
                            RPV13100:            * bad debt agency code
                            RPV13200:            * bad debt transfer amount
                            RPV13300:            * bad debt recovery amount
                            RPV13400:            * delete account indicator
                            RPV13500:            * delete account date
                            RPV13600:            * discharge disposition
                            RPV13700:            * discharged to location
                            RPV13800:            * diet type
                            RPV13900:            * servicing facility
                            RPV14000:            * bed status
                            RPV14100:            * account status
                            RPV14200:            * pending location
                            RPV14300:            * prior temporary location
                            RPV14400:            * admit date/time
                            RPV14500:            * discharge date/time
                            RPV14600:            * current patient balance
                            RPV14700:            * total charges
                            RPV14800:            * total adjustments
                            RPV14900:            * total payments
                            RPV15000:            * alternate visit id
                            RPV15100:            * visit indicator
                            RPV15200             * other healtcare provider
          GOTO      RPV19999
.
.         PV1.1 - Set Id
.
RPV10100  BRANCH    COMPCNT,RPV10101
          GOTO      RPV19999
.
RPV10101  RESET     PV100101
          GOTO      RPV19999
.
.         PV1.2 - Patient Class
.
RPV10200  BRANCH    COMPCNT,RPV10201
          GOTO      RPV19999
.
RPV10201  RESET     PV100201
          GOTO      RPV19999
.
.         PV1.3 - Assigned Patient Location
.
RPV10300  BRANCH    COMPCNT,RPV10301:
                            RPV10302:
                            RPV10303:
                            RPV10304:
                            RPV10305:
                            RPV10306:
                            RPV10307:
                            RPV10308:
                            RPV10309 
          GOTO      RPV19999
.
RPV10301  RESET     PV100301
          GOTO      RPV19999
.
RPV10302  RESET     PV100302
          GOTO      RPV19999
.
RPV10303  RESET     PV100303
          GOTO      RPV19999
.
RPV10304  RESET     PV100304
          GOTO      RPV19999
.
RPV10305  RESET     PV100305
          GOTO      RPV19999
.
RPV10306  RESET     PV100306
          GOTO      RPV19999
.
RPV10307  RESET     PV100307
          GOTO      RPV19999
.
RPV10308  RESET     PV100308
          GOTO      RPV19999
.
RPV10309  RESET     PV100309
          GOTO      RPV19999
.
.         PV1.4 - Admission Type
.
RPV10400  BRANCH    COMPCNT,RPV10401
          GOTO      RPV19999
.
RPV10401  RESET     PV100401
          GOTO      RPV19999
.
.         PV1.5 - Preadmit Number
.
RPV10500  BRANCH    COMPCNT,RPV10501:
                            RPV10502:
                            RPV10503:
                            RPV10504:
                            RPV10505:
                            RPV10506
          GOTO      RPV19999
.
RPV10501  RESET     PV100501
          GOTO      RPV19999
.
RPV10502  RESET     PV100502
          GOTO      RPV19999
.
RPV10503  RESET     PV100503
          GOTO      RPV19999
.
RPV10504  RESET     PV100504
          GOTO      RPV19999
.
RPV10505  RESET     PV100505
          GOTO      RPV19999
.
RPV10506  RESET     PV100506
          GOTO      RPV19999
.
.         PV1.6 - Prior Patient Location
.
RPV10600  BRANCH    COMPCNT,RPV10601:
                            RPV10602:
                            RPV10603:
                            RPV10604:
                            RPV10605:
                            RPV10606:
                            RPV10607:
                            RPV10608:
                            RPV10609 
          GOTO      RPV19999
.
RPV10601  RESET     PV100601
          GOTO      RPV19999
.
RPV10602  RESET     PV100602
          GOTO      RPV19999
.
RPV10603  RESET     PV100603
          GOTO      RPV19999
.
RPV10604  RESET     PV100604
          GOTO      RPV19999
.
RPV10605  RESET     PV100605
          GOTO      RPV19999
.
RPV10606  RESET     PV100606
          GOTO      RPV19999
.
RPV10607  RESET     PV100607
          GOTO      RPV19999
.
RPV10608  RESET     PV100608
          GOTO      RPV19999
.
RPV10609  RESET     PV100609
          GOTO      RPV19999
.
.         PV1.7 - Attending Doctor
.
RPV10700  BRANCH    COMPCNT,RPV10701:
                            RPV10702:
                            RPV10703:
                            RPV10704:
                            RPV10705:
                            RPV10706:
                            RPV10707:
                            RPV10708:
                            RPV10709:
                            RPV10710:
                            RPV10711:
                            RPV10712:
                            RPV10713:
                            RPV10714:
                            RPV10715
          GOTO      RPV19999
.
RPV10701  RESET     PV100701
          GOTO      RPV19999
.
RPV10702  RESET     PV100702
          GOTO      RPV19999
.
RPV10703  RESET     PV100703
          GOTO      RPV19999
.
RPV10704  RESET     PV100704
          GOTO      RPV19999
.
RPV10705  RESET     PV100705
          GOTO      RPV19999
.
RPV10706  RESET     PV100706
          GOTO      RPV19999
.
RPV10707  RESET     PV100707
          GOTO      RPV19999
.
RPV10708  RESET     PV100708
          GOTO      RPV19999
.
RPV10709  RESET     PV100709
          GOTO      RPV19999
.
RPV10710  RESET     PV100710
          GOTO      RPV19999
.
RPV10711  RESET     PV100711
          GOTO      RPV19999
.
RPV10712  RESET     PV100712
          GOTO      RPV19999
.
RPV10713  RESET     PV100713
          GOTO      RPV19999
.
RPV10714  RESET     PV100714
          GOTO      RPV19999
.
RPV10715  RESET     PV100715
          GOTO      RPV19999
.
.         PV1.8 - Referring Doctor
.
RPV10800  BRANCH    COMPCNT,RPV10801:
                            RPV10802:
                            RPV10803:
                            RPV10804:
                            RPV10805:
                            RPV10806:
                            RPV10807:
                            RPV10808:
                            RPV10809:
                            RPV10810:
                            RPV10811:
                            RPV10812:
                            RPV10813:
                            RPV10814:
                            RPV10815
          GOTO      RPV19999
.
RPV10801  RESET     PV100801
          GOTO      RPV19999
.
RPV10802  RESET     PV100802
          GOTO      RPV19999
.
RPV10803  RESET     PV100803
          GOTO      RPV19999
.
RPV10804  RESET     PV100804
          GOTO      RPV19999
.
RPV10805  RESET     PV100805
          GOTO      RPV19999
.
RPV10806  RESET     PV100806
          GOTO      RPV19999
.
RPV10807  RESET     PV100807
          GOTO      RPV19999
.
RPV10808  RESET     PV100808
          GOTO      RPV19999
.
RPV10809  RESET     PV100809
          GOTO      RPV19999
.
RPV10810  RESET     PV100810
          GOTO      RPV19999
.
RPV10811  RESET     PV100811
          GOTO      RPV19999
.
RPV10812  RESET     PV100812
          GOTO      RPV19999
.
RPV10813  RESET     PV100813
          GOTO      RPV19999
.
RPV10814  RESET     PV100814
          GOTO      RPV19999
.
RPV10815  RESET     PV100815
          GOTO      RPV19999
.
.         PV1.9 - Consulting Doctor
.
RPV10900  BRANCH    COMPCNT,RPV10901:
                            RPV10902:
                            RPV10903:
                            RPV10904:
                            RPV10905:
                            RPV10906:
                            RPV10907:
                            RPV10908:
                            RPV10909:
                            RPV10910:
                            RPV10911:
                            RPV10912:
                            RPV10913:
                            RPV10914:
                            RPV10915
          GOTO      RPV19999
.
RPV10901  RESET     PV100901
          GOTO      RPV19999
.
RPV10902  RESET     PV100902
          GOTO      RPV19999
.
RPV10903  RESET     PV100903
          GOTO      RPV19999
.
RPV10904  RESET     PV100904
          GOTO      RPV19999
.
RPV10905  RESET     PV100905
          GOTO      RPV19999
.
RPV10906  RESET     PV100906
          GOTO      RPV19999
.
RPV10907  RESET     PV100907
          GOTO      RPV19999
.
RPV10908  RESET     PV100908
          GOTO      RPV19999
.
RPV10909  RESET     PV100909
          GOTO      RPV19999
.
RPV10910  RESET     PV100910
          GOTO      RPV19999
.
RPV10911  RESET     PV100911
          GOTO      RPV19999
.
RPV10912  RESET     PV100912
          GOTO      RPV19999
.
RPV10913  RESET     PV100913
          GOTO      RPV19999
.
RPV10914  RESET     PV100914
          GOTO      RPV19999
.
RPV10915  RESET     PV100915
          GOTO      RPV19999
.
.         PV1.10 - Hospital Service
.
RPV11000  BRANCH    COMPCNT,RPV11001
          GOTO      RPV19999
.
RPV11001  RESET     PV101001
          GOTO      RPV19999
.
.         PV1.11 - Temporary Location
.
RPV11100  BRANCH    COMPCNT,RPV11101:
                            RPV11102:
                            RPV11103:
                            RPV11104:
                            RPV11105:
                            RPV11106:
                            RPV11107:
                            RPV11108:
                            RPV11109 
          GOTO      RPV19999
.
RPV11101  RESET     PV101101
          GOTO      RPV19999
.
RPV11102  RESET     PV101102
          GOTO      RPV19999
.
RPV11103  RESET     PV101103
          GOTO      RPV19999
.
RPV11104  RESET     PV101104
          GOTO      RPV19999
.
RPV11105  RESET     PV101105
          GOTO      RPV19999
.
RPV11106  RESET     PV101106
          GOTO      RPV19999
.
RPV11107  RESET     PV101107
          GOTO      RPV19999
.
RPV11108  RESET     PV101108
          GOTO      RPV19999
.
RPV11109  RESET     PV101109
          GOTO      RPV19999
.
.         PV1.12 - Preadmit Test Indicator
.
RPV11200  BRANCH    COMPCNT,RPV11201
          GOTO      RPV19999
.
RPV11201  RESET     PV101201
          GOTO      RPV19999
.
.         PV1.13 - Re-admission Indicator
.
RPV11300  BRANCH    COMPCNT,RPV11301
          GOTO      RPV19999
.
RPV11301  RESET     PV101301
          GOTO      RPV19999
.
.         PV1.14 - Admit Source
.
RPV11400  BRANCH    COMPCNT,RPV11401
          GOTO      RPV19999
.
RPV11401  RESET     PV101401
          GOTO      RPV19999
.
.         PV1.15 - Ambulatory Status
.
RPV11500  BRANCH    COMPCNT,RPV11501
          GOTO      RPV19999
.
RPV11501  RESET     PV101501
          GOTO      RPV19999
.
.         PV1.16 - VIP Indicator
.
RPV11600  BRANCH    COMPCNT,RPV11601
          GOTO      RPV19999
.
RPV11601  RESET     PV101601
          GOTO      RPV19999
.
.         PV1.17 - Admitting Doctor
.
RPV11700  BRANCH    COMPCNT,RPV11701:
                            RPV11702:
                            RPV11703:
                            RPV11704:
                            RPV11705:
                            RPV11706:
                            RPV11707:
                            RPV11708:
                            RPV11709:
                            RPV11710:
                            RPV11711:
                            RPV11712:
                            RPV11713:
                            RPV11714:
                            RPV11715
          GOTO      RPV19999
.
RPV11701  RESET     PV101701
          GOTO      RPV19999
.
RPV11702  RESET     PV101702
          GOTO      RPV19999
.
RPV11703  RESET     PV101703
          GOTO      RPV19999
.
RPV11704  RESET     PV101704
          GOTO      RPV19999
.
RPV11705  RESET     PV101705
          GOTO      RPV19999
.
RPV11706  RESET     PV101706
          GOTO      RPV19999
.
RPV11707  RESET     PV101707
          GOTO      RPV19999
.
RPV11708  RESET     PV101708
          GOTO      RPV19999
.
RPV11709  RESET     PV101709
          GOTO      RPV19999
.
RPV11710  RESET     PV101710
          GOTO      RPV19999
.
RPV11711  RESET     PV101711
          GOTO      RPV19999
.
RPV11712  RESET     PV101712
          GOTO      RPV19999
.
RPV11713  RESET     PV101713
          GOTO      RPV19999
.
RPV11714  RESET     PV101714
          GOTO      RPV19999
.
RPV11715  RESET     PV101715
          GOTO      RPV19999
.
.         PV1.18 - Patient Type
.
RPV11800  BRANCH    COMPCNT,RPV11801
          GOTO      RPV19999
.
RPV11801  RESET     PV101801
          GOTO      RPV19999
.
.         PV1.19 - Visit Number
.
RPV11900  BRANCH    COMPCNT,RPV11901:
                            RPV11902:
                            RPV11903:
                            RPV11904:
                            RPV11905:
                            RPV11906
          GOTO      RPV19999
.
RPV11901  RESET     PV101901
          GOTO      RPV19999
.
RPV11902  RESET     PV101902
          GOTO      RPV19999
.
RPV11903  RESET     PV101903
          GOTO      RPV19999
.
RPV11904  RESET     PV101904
          GOTO      RPV19999
.
RPV11905  RESET     PV101905
          GOTO      RPV19999
.
RPV11906  RESET     PV101906
          GOTO      RPV19999
.
.         PV1.20 - Financial Class
.
RPV12000  BRANCH    COMPCNT,RPV12001:
                            RPV12001
          GOTO      RPV19999
.
RPV12001  RESET     PV102001
          GOTO      RPV19999
.
RPV12002  RESET     PV102002
          GOTO      RPV19999
.
.         PV1.21 - Charge Price Indicator
.
RPV12100  BRANCH    COMPCNT,RPV12101
          GOTO      RPV19999
.
RPV12101  RESET     PV102101
          GOTO      RPV19999
.
.         PV1.22 - Courtesy Code
.
RPV12200  BRANCH    COMPCNT,RPV12201
          GOTO      RPV19999
.
RPV12201  RESET     PV102201
          GOTO      RPV19999
.
.         PV1.23 - Credit Rating
.
RPV12300  BRANCH    COMPCNT,RPV12301
          GOTO      RPV19999
.
RPV12301  RESET     PV102301
          GOTO      RPV19999
.
.         PV1.24 - Contract Code
.
RPV12400  BRANCH    COMPCNT,RPV12401
          GOTO      RPV19999
.
RPV12401  RESET     PV102401
          GOTO      RPV19999
.
.         PV1.25 - Contract Effective Date
.
RPV12500  BRANCH    COMPCNT,RPV12501
          GOTO      RPV19999
.
RPV12501  RESET     PV102501
          GOTO      RPV19999
.
.         PV1.26 - Contract Amount
.
RPV12600  BRANCH    COMPCNT,RPV12601
          GOTO      RPV19999
.
RPV12601  RESET     PV102601
          GOTO      RPV19999
.
.         PV1.27 - Contract Period
.
RPV12700  BRANCH    COMPCNT,RPV12701
          GOTO      RPV19999
.
RPV12701  RESET     PV102701
          GOTO      RPV19999
.
.         PV1.28 - Interest Code
.
RPV12800  BRANCH    COMPCNT,RPV12801
          GOTO      RPV19999
.
RPV12801  RESET     PV102801
          GOTO      RPV19999
.
.         PV1.29 - Transfer To Bad Debt Code
.
RPV12900  BRANCH    COMPCNT,RPV12901
          GOTO      RPV19999
.
RPV12901  RESET     PV102901
          GOTO      RPV19999
.
.         PV1.30 - Transfer To Bad Debt Date
.
RPV13000  BRANCH    COMPCNT,RPV13001
          GOTO      RPV19999
.
RPV13001  RESET     PV103001
          GOTO      RPV19999
.
.         PV1.31 - Bad Debt Agency Code
.
RPV13100  BRANCH    COMPCNT,RPV13101
          GOTO      RPV19999
.
RPV13101  RESET     PV103101
          GOTO      RPV19999
.
.         PV1.32 - Bad Debt Transfer Amount
.
RPV13200  BRANCH    COMPCNT,RPV13201
          GOTO      RPV19999
.
RPV13201  RESET     PV103201
          GOTO      RPV19999
.
.         PV1.33 - Bad Debt Recovery Amount
.
RPV13300  BRANCH    COMPCNT,RPV13301
          GOTO      RPV19999
.
RPV13301  RESET     PV103301
          GOTO      RPV19999
.
.         PV1.34 - Delete Account Indicator
.
RPV13400  BRANCH    COMPCNT,RPV13401
          GOTO      RPV19999
.
RPV13401  RESET     PV103401
          GOTO      RPV19999
.
.         PV1.35 - Delete Account Date
.
RPV13500  BRANCH    COMPCNT,RPV13501
          GOTO      RPV19999
.
RPV13501  RESET     PV103501
          GOTO      RPV19999
.
.         PV1.36 - Discharge Disposition
.
RPV13600  BRANCH    COMPCNT,RPV13601
          GOTO      RPV19999
.
RPV13601  RESET     PV103601
          GOTO      RPV19999
.
.         PV1.37 - Discharged To Location
.
RPV13700  BRANCH    COMPCNT,RPV13701:
                            RPV13702
          GOTO      RPV19999
.
RPV13701  RESET     PV103701
          GOTO      RPV19999
.
RPV13702  RESET     PV103702
          GOTO      RPV19999
.
.         PV1.38 - Diet Type
.
RPV13800  BRANCH    COMPCNT,RPV13801:
                            RPV13802:
                            RPV13803:
                            RPV13804:
                            RPV13805:
                            RPV13806
          GOTO      RPV19999
.
RPV13801  RESET     PV103801
          GOTO      RPV19999
.
RPV13802  RESET     PV103802
          GOTO      RPV19999
.
RPV13803  RESET     PV103803
          GOTO      RPV19999
.
RPV13804  RESET     PV103804
          GOTO      RPV19999
.
RPV13805  RESET     PV103805
          GOTO      RPV19999
.
RPV13806  RESET     PV103806
          GOTO      RPV19999
.
.         PV1.39 - Servicing Facility
.
RPV13900  BRANCH    COMPCNT,RPV13901
          GOTO      RPV19999
.
RPV13901  RESET     PV103901
          GOTO      RPV19999
.
.         PV1.40 - Bed Status
.
RPV14000  BRANCH    COMPCNT,RPV14001
          GOTO      RPV19999
.
RPV14001  RESET     PV104001
          GOTO      RPV19999
.
.         PV1.41 - Account Status
.
RPV14100  BRANCH    COMPCNT,RPV14101
          GOTO      RPV19999
.
RPV14101  RESET     PV104101
          GOTO      RPV19999
.
.         PV1.42 - Pending Location
.
RPV14200  BRANCH    COMPCNT,RPV14201:
                            RPV14202:
                            RPV14203:
                            RPV14204:
                            RPV14205:
                            RPV14206:
                            RPV14207:
                            RPV14208:
                            RPV14209 
          GOTO      RPV19999
.
RPV14201  RESET     PV104201
          GOTO      RPV19999
.
RPV14202  RESET     PV104202
          GOTO      RPV19999
.
RPV14203  RESET     PV104203
          GOTO      RPV19999
.
RPV14204  RESET     PV104204
          GOTO      RPV19999
.
RPV14205  RESET     PV104205
          GOTO      RPV19999
.
RPV14206  RESET     PV104206
          GOTO      RPV19999
.
RPV14207  RESET     PV104207
          GOTO      RPV19999
.
RPV14208  RESET     PV104208
          GOTO      RPV19999
.
RPV14209  RESET     PV104209
          GOTO      RPV19999
.
.         PV1.43 - Prior Temporary Location
.
RPV14300  BRANCH    COMPCNT,RPV14301:
                            RPV14302:
                            RPV14303:
                            RPV14304:
                            RPV14305:
                            RPV14306:
                            RPV14307:
                            RPV14308:
                            RPV14309 
          GOTO      RPV19999
.
RPV14301  RESET     PV104301
          GOTO      RPV19999
.
RPV14302  RESET     PV104302
          GOTO      RPV19999
.
RPV14303  RESET     PV104303
          GOTO      RPV19999
.
RPV14304  RESET     PV104304
          GOTO      RPV19999
.
RPV14305  RESET     PV104305
          GOTO      RPV19999
.
RPV14306  RESET     PV104306
          GOTO      RPV19999
.
RPV14307  RESET     PV104307
          GOTO      RPV19999
.
RPV14308  RESET     PV104308
          GOTO      RPV19999
.
RPV14309  RESET     PV104309
          GOTO      RPV19999
.
.         PV1.44 - Admit Date/Time
.
RPV14400  BRANCH    COMPCNT,RPV14401
          GOTO      RPV19999
.
RPV14401  RESET     PV104401
          GOTO      RPV19999
.
.         PV1.45 - Discharge Date/Time
.
RPV14500  BRANCH    COMPCNT,RPV14501
          GOTO      RPV19999
.
RPV14501  RESET     PV104501
          GOTO      RPV19999
.
.         PV1.46 - Current Patient Balance
.
RPV14600  BRANCH    COMPCNT,RPV14601
          GOTO      RPV19999
.
RPV14601  RESET     PV104601
          GOTO      RPV19999
.
.         PV1.47 - Total Charges
.
RPV14700  BRANCH    COMPCNT,RPV14701
          GOTO      RPV19999
.
RPV14701  RESET     PV104701
          GOTO      RPV19999
.
.         PV1.48 - Total Adjustments
.
RPV14800  BRANCH    COMPCNT,RPV14801
          GOTO      RPV19999
.
RPV14801  RESET     PV104801
          GOTO      RPV19999
.
.         PV1.49 - Total Payments
.
RPV14900  BRANCH    COMPCNT,RPV14901
          GOTO      RPV19999
.
RPV14901  RESET     PV104901
          GOTO      RPV19999
.
.         PV1.50 - Alternate Visit Id
.
RPV15000  BRANCH    COMPCNT,RPV15001:
                            RPV15002:
                            RPV15003:
                            RPV15004:
                            RPV15005:
                            RPV15006
          GOTO      RPV19999
.
RPV15001  RESET     PV105001
          GOTO      RPV19999
.
RPV15002  RESET     PV105002
          GOTO      RPV19999
.
RPV15003  RESET     PV105003
          GOTO      RPV19999
.
RPV15004  RESET     PV105004
          GOTO      RPV19999
.
RPV15005  RESET     PV105005
          GOTO      RPV19999
.
RPV15006  RESET     PV105006
          GOTO      RPV19999
.
.         PV1.51 - Visit Indicator
.
RPV15100  BRANCH    COMPCNT,RPV15101
          GOTO      RPV19999
.
RPV15101  RESET     PV105101
          GOTO      RPV19999
.
.         PV1.52 - Other Healthcare Provider
.
RPV15200  BRANCH    COMPCNT,RPV15201:
                            RPV15202:
                            RPV15203:
                            RPV15204:
                            RPV15205:
                            RPV15206:
                            RPV15207:
                            RPV15208:
                            RPV15209:
                            RPV15210:
                            RPV15211:
                            RPV15212:
                            RPV15213:
                            RPV15214:
                            RPV15215
          GOTO      RPV19999
.
RPV15201  RESET     PV105201
          GOTO      RPV19999
.
RPV15202  RESET     PV105202
          GOTO      RPV19999
.
RPV15203  RESET     PV105203
          GOTO      RPV19999
.
RPV15204  RESET     PV105204
          GOTO      RPV19999
.
RPV15205  RESET     PV105205
          GOTO      RPV19999
.
RPV15206  RESET     PV105206
          GOTO      RPV19999
.
RPV15207  RESET     PV105207
          GOTO      RPV19999
.
RPV15208  RESET     PV105208
          GOTO      RPV19999
.
RPV15209  RESET     PV105209
          GOTO      RPV19999
.
RPV15210  RESET     PV105210
          GOTO      RPV19999
.
RPV15211  RESET     PV105211
          GOTO      RPV19999
.
RPV15212  RESET     PV105212
          GOTO      RPV19999
.
RPV15213  RESET     PV105213
          GOTO      RPV19999
.
RPV15214  RESET     PV105214
          GOTO      RPV19999
.
RPV15215  RESET     PV105215
          GOTO      RPV19999
.
RPV19999  RETURN
+
.*****************************************************************************
.*                                 RORC0000        Called by: PROC0000       *
.*                          Reset the ORC fields                             *
.*****************************************************************************
.
RORC0000  BRANCH    FIELDNO,RORC0100:            * Order Control
                            RORC0200:            * Placer Order Number
                            RORC0300:            * Filler Order Number
                            RORC0400:            * Placer Group Number
                            RORC0500:            * Order Status
                            RORC0600:            * Response Flag
                            RORC0700:            * Quantity/Timing
                            RORC0800:            * Parent
                            RORC0900:            * Date/Time of Transaction
                            RORC1000:            * Entered By
                            RORC1100:            * Verified By
                            RORC1200:            * Ordering Provider
                            RORC1300:            * Enterer.s Location
                            RORC1400:            * Call Back Phone Number
                            RORC1500:            * Order Effective Date/Time
                            RORC1600:            * Order Control Code Reason
                            RORC1700:            * Entering Organisation
                            RORC1800:            * Entering Device
                            RORC1900:            * Action By
                            RORC2000:            * Adv'd Beneficiary Notice Code
                            RORC2100:            * Ordering Facility Name
                            RORC2200:            * Ordering Facility Address
                            RORC2300:            * Ordering Facility Phone No.
                            RORC2400             * Ordering Provider Address
.
.         Invalid ORC field received, so ignore it
.
          GOTO      RORC9999
.
.         ORC.1 Order Control (ID)
.
RORC0100  BRANCH    COMPCNT,RORC0101
          GOTO      RORC9999
.
RORC0101  RESET     ORC00101             
          GOTO      RORC9999
.
.         ORC.2  Placer Order Number (EI)
.
RORC0200  BRANCH    COMPCNT,RORC0201:            * entity identifier (ST)
                            RORC0202:            * namespace id (IS)
                            RORC0203:            * universal id (ST)
                            RORC0204             * universal id type (ID)
          GOTO      RORC9999
.
RORC0201  RESET     ORC00201                     * load entity identifier (ST)
          GOTO      RORC9999
.
RORC0202  RESET     ORC00202                     * load namespace id (IS)
          GOTO      RORC9999
.
RORC0203  RESET     ORC00203                     * load universal id (ST)
          GOTO      RORC9999
.
RORC0204  RESET     ORC00204                     * load universal id type (ID)
          GOTO      RORC9999
.
.         ORC.3  Filler Order Number (EI)
.
RORC0300  BRANCH    COMPCNT,RORC0301:            * entity identifier (ST)
                            RORC0302:            * namespace id (IS)
                            RORC0303:            * universal id (ST)
                            RORC0304             * universal id type (ID)
          GOTO      RORC9999
.
RORC0301  RESET     ORC00301                     * load entity identifier (ST)
          GOTO      RORC9999
.
RORC0302  RESET     ORC00302                     * load namespace id (IS)
          GOTO      RORC9999
.
RORC0303  RESET     ORC00303                     * load universal id (ST)
          GOTO      RORC9999
.
RORC0304  RESET     ORC00304                     * load universal id type (ID)
          GOTO      RORC9999
.
.         ORC.4  Placer Group Number (EI)
.
RORC0400  BRANCH    COMPCNT,RORC0401:            * entity identifier (ST)
                            RORC0402:            * namespace id (IS)
                            RORC0403:            * universal id (ST)
                            RORC0404             * universal id type (ID)
          GOTO      RORC9999
.
RORC0401  RESET     ORC00401                     * load entity identifier (ST)
          GOTO      RORC9999
.
RORC0402  RESET     ORC00402                     * load namespace id (IS)
          GOTO      RORC9999
.
RORC0403  RESET     ORC00403                     * load universal id (ST)
          GOTO      RORC9999
.
RORC0404  RESET     ORC00404                     * load universal id type (ID)
          GOTO      RORC9999
.
.         ORC.5 Order Status (ID)
.
RORC0500  BRANCH    COMPCNT,RORC0501
          GOTO      RORC9999
.
RORC0501  RESET     ORC00501             
          GOTO      RORC9999
.
.         ORC.6 Response Flag (ID)
.
RORC0600  BRANCH    COMPCNT,RORC0601
          GOTO      RORC9999
.
RORC0601  RESET     ORC00601             
          GOTO      RORC9999
.
.         ORC.7 Quantity/Timing (TQ)
.
RORC0700  BRANCH    COMPCNT,RORC0701:            * quantity (CQ)
                            RORC0702:            * interval (CM)
                            RORC0703:            * duration (ST)
                            RORC0704:            * start date/time (TS)
                            RORC0705:            * end date/time (TS)
                            RORC0706:            * priority (ST)
                            RORC0707:            * condition (ST)
                            RORC0708:            * text (TX)
                            RORC0709:            * conjunction (ST)
                            RORC0710:            * order sequencing (CM)
                            RORC0711:            * occurrence duration (CE)
                            RORC0712             * total occurrences (NM)
          GOTO      RORC9999
.
RORC0701  RESET     ORC00701                     * quantity (CQ)
          GOTO      RORC9999
.
RORC0702  RESET     ORC00702                     * interval (CM)
          GOTO      RORC9999
.
RORC0703  RESET     ORC00703                     * duration (ST)
          GOTO      RORC9999
.
RORC0704  RESET     ORC00704                     * start date/time (TS)
          GOTO      RORC9999
.
RORC0705  RESET     ORC00705                     * end date/time (TS)
          GOTO      RORC9999
.
RORC0706  RESET     ORC00706                     * priority (ST)
          GOTO      RORC9999
.
RORC0707  RESET     ORC00707                     * condition (ST)
          GOTO      RORC9999
.
RORC0708  RESET     ORC00708                     * text (TX)
          GOTO      RORC9999
.
RORC0709  RESET     ORC00709                     * conjunction (ST)
          GOTO      RORC9999
.
RORC0710  RESET     ORC00710                     * order sequencing (CM)
          GOTO      RORC9999
.
RORC0711  RESET     ORC00711                     * occurrence duration (CE)
          GOTO      RORC9999
.
RORC0712  RESET     ORC00712                     * total occurrences (NM)
          GOTO      RORC9999
.
.         ORC.8 Parent (CM)
.
RORC0800  BRANCH    COMPCNT,RORC0801:            * parent's placer order no (EI)
                            RORC0802             * parent's filler order no (EI)
          GOTO      RORC9999
.
RORC0801  RESET     ORC00801                     * parent's placer order no (EI)
          GOTO      RORC9999
.
RORC0802  RESET     ORC00802                     * parent's filler order no (EI)
          GOTO      RORC9999
.
.         ORC.9 Date/Time of Transaction (TS)
.
RORC0900  BRANCH    COMPCNT,RORC0901
          GOTO      RORC9999
.
RORC0901  RESET     ORC00901            
          GOTO      RORC9999
.
.         ORC.10 Entered By (XCN)
.
RORC1000  BRANCH    COMPCNT,RORC1001:            * id number (ST)
                            RORC1002:            * family name (ST)
                            RORC1003:            * given name (ST)
                            RORC1004:            * middle name (ST)
                            RORC1005:            * suffix (ST)
                            RORC1006:            * prefix (ST)
                            RORC1007:            * degree (IS)
                            RORC1008:            * source table (IS)
                            RORC1009:            * assigning authority (HD)
                            RORC1010:            * name type code (ID)
                            RORC1011:            * identifier check digit (ST)
                            RORC1012:            * check digit code scheme (ID)
                            RORC1013:            * identifier type code (IS)
                            RORC1014:            * assigning facility (HD)
                            RORC1015             * name representation code (ID)
          GOTO      RORC9999
.
RORC1001  RESET     ORC01001                     * id number (ST)
          GOTO      RORC9999
.
RORC1002  RESET     ORC01002                     * family name (ST)
          GOTO      RORC9999
.
RORC1003  RESET     ORC01003                     * given name (ST)
          GOTO      RORC9999
.
RORC1004  RESET     ORC01004                     * middle name (ST)
          GOTO      RORC9999
.
RORC1005  RESET     ORC01005                     * suffix (ST)
          GOTO      RORC9999
.
RORC1006  RESET     ORC01006                     * prefix (ST)
          GOTO      RORC9999
.
RORC1007  RESET     ORC01007                     * degree (IS)
          GOTO      RORC9999
.
RORC1008  RESET     ORC01008                     * source table (IS)
          GOTO      RORC9999
.
RORC1009  RESET     ORC01009                     * assigning authority (HD)
          GOTO      RORC9999
.
RORC1010  RESET     ORC01010                     * name type code (ID)
          GOTO      RORC9999
.
RORC1011  RESET     ORC01011                     * identifier check digit (ST)
          GOTO      RORC9999
.
RORC1012  RESET     ORC01012                     * check digit code scheme (ID)
          GOTO      RORC9999
.
RORC1013  RESET     ORC01013                     * identifier type code (IS)
          GOTO      RORC9999
.
RORC1014  RESET     ORC01014                     * assigning facility (HD)
          GOTO      RORC9999
.
RORC1015  RESET     ORC01015                     * name representation code (ID)
          GOTO      RORC9999
.
.         ORC.11 Verified By (XCN)
.
RORC1100  BRANCH    COMPCNT,RORC1101:            * id number (ST)
                            RORC1102:            * family name (ST)
                            RORC1103:            * given name (ST)
                            RORC1104:            * middle name (ST)
                            RORC1105:            * suffix (ST)
                            RORC1106:            * prefix (ST)
                            RORC1107:            * degree (IS)
                            RORC1108:            * source table (IS)
                            RORC1109:            * assigning authority (HD)
                            RORC1110:            * name type code (ID)
                            RORC1111:            * identifier check digit (ST)
                            RORC1112:            * check digit code scheme (ID)
                            RORC1113:            * identifier type code (IS)
                            RORC1114:            * assigning facility (HD)
                            RORC1115             * name representation code (ID)
          GOTO      RORC9999
.
RORC1101  RESET     ORC01101                     * id number (ST)
          GOTO      RORC9999
.
RORC1102  RESET     ORC01102                     * family name (ST)
          GOTO      RORC9999
.
RORC1103  RESET     ORC01103                     * given name (ST)
          GOTO      RORC9999
.
RORC1104  RESET     ORC01104                     * middle name (ST)
          GOTO      RORC9999
.
RORC1105  RESET     ORC01105                     * suffix (ST)
          GOTO      RORC9999
.
RORC1106  RESET     ORC01106                     * prefix (ST)
          GOTO      RORC9999
.
RORC1107  RESET     ORC01107                     * degree (IS)
          GOTO      RORC9999
.
RORC1108  RESET     ORC01108                     * source table (IS)
          GOTO      RORC9999
.
RORC1109  RESET     ORC01109                     * assigning authority (HD)
          GOTO      RORC9999
.
RORC1110  RESET     ORC01110                     * name type code (ID)
          GOTO      RORC9999
.
RORC1111  RESET     ORC01111                     * identifier check digit (ST)
          GOTO      RORC9999
.
RORC1112  RESET     ORC01112                     * check digit code scheme (ID)
          GOTO      RORC9999
.
RORC1113  RESET     ORC01113                     * identifier type code (IS)
          GOTO      RORC9999
.
RORC1114  RESET     ORC01114                     * assigning facility (HD)
          GOTO      RORC9999
.
RORC1115  RESET     ORC01115                     * name representation code (ID)
          GOTO      RORC9999
.
.         ORC.12 Ordering Provider (XCN)
.
RORC1200  BRANCH    COMPCNT,RORC1201:            * id number (ST)
                            RORC1202:            * family name (ST)
                            RORC1203:            * given name (ST)
                            RORC1204:            * middle name (ST)
                            RORC1205:            * suffix (ST)
                            RORC1206:            * prefix (ST)
                            RORC1207:            * degree (IS)
                            RORC1208:            * source table (IS)
                            RORC1209:            * assigning authority (HD)
                            RORC1210:            * name type code (ID)
                            RORC1211:            * identifier check digit (ST)
                            RORC1212:            * check digit code scheme (ID)
                            RORC1213:            * identifier type code (IS)
                            RORC1214:            * assigning facility (HD)
                            RORC1215             * name representation code (ID)
          GOTO      RORC9999
.
RORC1201  RESET     ORC01201                     * id number (ST)
          GOTO      RORC9999
.
RORC1202  RESET     ORC01202                     * family name (ST)
          GOTO      RORC9999
.
RORC1203  RESET     ORC01203                     * given name (ST)
          GOTO      RORC9999
.
RORC1204  RESET     ORC01204                     * middle name (ST)
          GOTO      RORC9999
.
RORC1205  RESET     ORC01205                     * suffix (ST)
          GOTO      RORC9999
.
RORC1206  RESET     ORC01206                     * prefix (ST)
          GOTO      RORC9999
.
RORC1207  RESET     ORC01207                     * degree (IS)
          GOTO      RORC9999
.
RORC1208  RESET     ORC01208                     * source table (IS)
          GOTO      RORC9999
.
RORC1209  RESET     ORC01209                     * assigning authority (HD)
          GOTO      RORC9999
.
RORC1210  RESET     ORC01210                     * name type code (ID)
          GOTO      RORC9999
.
RORC1211  RESET     ORC01211                     * identifier check digit (ST)
          GOTO      RORC9999
.
RORC1212  RESET     ORC01212                     * check digit code scheme (ID)
          GOTO      RORC9999
.
RORC1213  RESET     ORC01213                     * identifier type code (IS)
          GOTO      RORC9999
.
RORC1214  RESET     ORC01214                     * assigning facility (HD)
          GOTO      RORC9999
.
RORC1215  RESET     ORC01215                     * name representation code (ID)
          GOTO      RORC9999
.
.         ORC.13 Enterer's Location (PL)
.
RORC1300  BRANCH    COMPCNT,RORC1301:            * point of care (IS)
                            RORC1302:            * room (IS)
                            RORC1303:            * bed (IS)
                            RORC1304:            * facility (HD)
                            RORC1305:            * location status (IS)
                            RORC1306:            * person location type (IS)
                            RORC1307:            * building (IS)
                            RORC1308:            * floor (IS)
                            RORC1309             * location description (ST)
          GOTO      RORC9999
.
RORC1301  RESET     ORC01301                     * load point of care (IS)
          GOTO      RORC9999
.
RORC1302  RESET     ORC01302                     * load room (IS)
          GOTO      RORC9999
.
RORC1303  RESET     ORC01303                     * load bed (IS)
          GOTO      RORC9999
.
RORC1304  RESET     ORC01304                     * load facility (HD)
          GOTO      RORC9999
.
RORC1305  RESET     ORC01305                     * load location status (IS)
          GOTO      RORC9999
.
RORC1306  RESET     ORC01306                     * load person locat. type (IS)
          GOTO      RORC9999
.
RORC1307  RESET     ORC01307                     * load building (IS)
          GOTO      RORC9999
.
RORC1308  RESET     ORC01308                     * load floor (IS)
          GOTO      RORC9999
.
RORC1309  RESET     ORC01309                     * load locat. description (ST)
          GOTO      RORC9999
.
.         ORC.14 Call Back Phone Number (XTN)
.
RORC1400  BRANCH    COMPCNT,RORC1401:            * text
                            RORC1402:            * telecomm. use code (ID)
                            RORC1403:            * telcomm. equipment type (ID)
                            RORC1404:            * email address (ST)
                            RORC1405:            * country code (NM)
                            RORC1406:            * area/city code (NM)
                            RORC1407:            * phone number (NM)
                            RORC1408:            * extension (NM)
                            RORC1409             * any text (ST)
          GOTO      RORC9999
.
RORC1401  RESET     ORC01401                     * load text
          GOTO      RORC9999
.
RORC1402  RESET     ORC01402                     * load telecomm. use code (ID)
          GOTO      RORC9999
.
RORC1403  RESET     ORC01403                     * load telcomm. equip.type (ID)
          GOTO      RORC9999
.
RORC1404  RESET     ORC01404                     * load email address (ST)
          GOTO      RORC9999
.
RORC1405  RESET     ORC01405                     * load country code (NM)
          GOTO      RORC9999
.
RORC1406  RESET     ORC01406                     * load area/city code (NM)
          GOTO      RORC9999
.
RORC1407  RESET     ORC01407                     * load phone number (NM)
          GOTO      RORC9999
.
RORC1408  RESET     ORC01408                     * load extension (NM)
          GOTO      RORC9999
.
RORC1409  RESET     ORC01409                     * load any text (ST)
          GOTO      RORC9999
.
.         ORC.15 Order Effective Date/Time (TS)
.
RORC1500  BRANCH    COMPCNT,RORC1501
          GOTO      RORC9999
.
RORC1501  RESET     ORC01501            
          GOTO      RORC9999
.
.         ORC.16 Order Control Code Reason (CE)
.
RORC1600  BRANCH    COMPCNT,RORC1601:            * identifier (ST)
                            RORC1602:            * text (ST)
                            RORC1603:            * name of coding system (ST)
                            RORC1604:            * alternate identifier (ST)
                            RORC1605:            * alternate text (ST)
                            RORC1606             * name of alt. coding sys. (ST)
          GOTO      RORC9999
.
RORC1601  RESET     ORC01601                     * load identifier (ST)
          GOTO      RORC9999
.
RORC1602  RESET     ORC01602                     * load text (ST)
          GOTO      RORC9999
.
RORC1603  RESET     ORC01603                     * load name of coding sys. (ST)
          GOTO      RORC9999
.
RORC1604  RESET     ORC01604                     * load alt. identifier (ST)
          GOTO      RORC9999
.
RORC1605  RESET     ORC01605                     * load alternate text (ST)
          GOTO      RORC9999
.
RORC1606  RESET     ORC01606                     * load name alt. cod. sys. (ST)
          GOTO      RORC9999
.
.         ORC.17 Entering Organisation (CE)
.
RORC1700  BRANCH    COMPCNT,RORC1701:            * identifier (ST)
                            RORC1702:            * text (ST)
                            RORC1703:            * name of coding system (ST)
                            RORC1704:            * alternate identifier (ST)
                            RORC1705:            * alternate text (ST)
                            RORC1706             * name of alt. coding sys. (ST)
          GOTO      RORC9999
.
RORC1701  RESET     ORC01701                     * load identifier (ST)
          GOTO      RORC9999
.
RORC1702  RESET     ORC01702                     * load text (ST)
          GOTO      RORC9999
.
RORC1703  RESET     ORC01703                     * load name of coding sys. (ST)
          GOTO      RORC9999
.
RORC1704  RESET     ORC01704                     * load alt. identifier (ST)
          GOTO      RORC9999
.
RORC1705  RESET     ORC01705                     * load alternate text (ST)
          GOTO      RORC9999
.
RORC1706  RESET     ORC01706                     * load name alt. cod. sys. (ST)
          GOTO      RORC9999
.
.         ORC.18 Entering Device (CE)
.
RORC1800  BRANCH    COMPCNT,RORC1801:            * identifier (ST)
                            RORC1802:            * text (ST)
                            RORC1803:            * name of coding system (ST)
                            RORC1804:            * alternate identifier (ST)
                            RORC1805:            * alternate text (ST)
                            RORC1806             * name of alt. coding sys. (ST)
          GOTO      RORC9999
.
RORC1801  RESET     ORC01801                     * load identifier (ST)
          GOTO      RORC9999
.
RORC1802  RESET     ORC01802                     * load text (ST)
          GOTO      RORC9999
.
RORC1803  RESET     ORC01803                     * load name of coding sys. (ST)
          GOTO      RORC9999
.
RORC1804  RESET     ORC01804                     * load alt. identifier (ST)
          GOTO      RORC9999
.
RORC1805  RESET     ORC01805                     * load alternate text (ST)
          GOTO      RORC9999
.
RORC1806  RESET     ORC01806                     * load name alt. cod. sys. (ST)
          GOTO      RORC9999
.
.         ORC.19 Action By (XCN)
.
RORC1900  BRANCH    COMPCNT,RORC1901:            * id number (ST)
                            RORC1902:            * family name (ST)
                            RORC1903:            * given name (ST)
                            RORC1904:            * middle name (ST)
                            RORC1905:            * suffix (ST)
                            RORC1906:            * prefix (ST)
                            RORC1907:            * degree (IS)
                            RORC1908:            * source table (IS)
                            RORC1909:            * assigning authority (HD)
                            RORC1910:            * name type code (ID)
                            RORC1911:            * identifier check digit (ST)
                            RORC1912:            * check digit code scheme (ID)
                            RORC1913:            * identifier type code (IS)
                            RORC1914:            * assigning facility (HD)
                            RORC1915             * name representation code (ID)
          GOTO      RORC9999
.
RORC1901  RESET     ORC01901                     * id number (ST)
          GOTO      RORC9999
.
RORC1902  RESET     ORC01902                     * family name (ST)
          GOTO      RORC9999
.
RORC1903  RESET     ORC01903                     * given name (ST)
          GOTO      RORC9999
.
RORC1904  RESET     ORC01904                     * middle name (ST)
          GOTO      RORC9999
.
RORC1905  RESET     ORC01905                     * suffix (ST)
          GOTO      RORC9999
.
RORC1906  RESET     ORC01906                     * prefix (ST)
          GOTO      RORC9999
.
RORC1907  RESET     ORC01907                     * degree (IS)
          GOTO      RORC9999
.
RORC1908  RESET     ORC01908                     * source table (IS)
          GOTO      RORC9999
.
RORC1909  RESET     ORC01909                     * assigning authority (HD)
          GOTO      RORC9999
.
RORC1910  RESET     ORC01910                     * name type code (ID)
          GOTO      RORC9999
.
RORC1911  RESET     ORC01911                     * identifier check digit (ST)
          GOTO      RORC9999
.
RORC1912  RESET     ORC01912                     * check digit code scheme (ID)
          GOTO      RORC9999
.
RORC1913  RESET     ORC01913                     * identifier type code (IS)
          GOTO      RORC9999
.
RORC1914  RESET     ORC01914                     * assigning facility (HD)
          GOTO      RORC9999
.
RORC1915  RESET     ORC01915                     * name representation code (ID)
          GOTO      RORC9999
.
.         ORC.20 Advanced Beneficiary Notice Code (CE)
.
RORC2000  BRANCH    COMPCNT,RORC2001:            * identifier (ST)
                            RORC2002:            * text (ST)
                            RORC2003:            * name of coding system (ST)
                            RORC2004:            * alternate identifier (ST)
                            RORC2005:            * alternate text (ST)
                            RORC2006             * name of alt. coding sys. (ST)
          GOTO      RORC9999
.
RORC2001  RESET     ORC02001                     * load identifier (ST)
          GOTO      RORC9999
.
RORC2002  RESET     ORC02002                     * load text (ST)
          GOTO      RORC9999
.
RORC2003  RESET     ORC02003                     * load name of coding sys. (ST)
          GOTO      RORC9999
.
RORC2004  RESET     ORC02004                     * load alt. identifier (ST)
          GOTO      RORC9999
.
RORC2005  RESET     ORC02005                     * load alternate text (ST)
          GOTO      RORC9999
.
RORC2006  RESET     ORC02006                     * load name alt. cod. sys. (ST)
          GOTO      RORC9999
.
.         ORC.21 Ordering Facility Name (XON)
.
RORC2100  BRANCH    COMPCNT,RORC2101:            * organisation name (ST)
                            RORC2102:            * org. name type code (IS)
                            RORC2103:            * id number (NM)
                            RORC2104:            * check digit (NM)
                            RORC2105:            * check digit scheme code (ID)
                            RORC2106:            * assigning authority (HD)
                            RORC2107:            * identifier type code (IS)
                            RORC2108:            * assigning facility (HD)
                            RORC2109             * name rep. code (ID)
          GOTO      RORC9999
.
RORC2101  RESET     ORC02101                     * organisation name (ST)
          GOTO      RORC9999
.
RORC2102  RESET     ORC02102                     * org. name type code (IS)
          GOTO      RORC9999
.
RORC2103  RESET     ORC02103                     * id number (NM)
          GOTO      RORC9999
.
RORC2104  RESET     ORC02104                     * load check digit (ST)
          GOTO      RORC9999
.
RORC2105  RESET     ORC02105                     * load chk dig scheme code (ID)
          GOTO      RORC9999
.
RORC2106  RESET     ORC02106                     * load assigning authority (HD)
          GOTO      RORC9999
.
RORC2107  RESET     ORC02107                     * load identifier typ code (IS)
          GOTO      RORC9999
.
RORC2108  RESET     ORC02108                     * load assigning facility (HD)
          GOTO      RORC9999
.
RORC2109  RESET     ORC02109                     * load name rep. code (ID)
          GOTO      RORC9999
.
.         ORC.22 Ordering Facility Address (XAD)
.
RORC2200  BRANCH    COMPCNT,RORC2201:            * street address (ST)
                            RORC2202:            * other designation (ST)
                            RORC2203:            * city (ST)
                            RORC2204:            * state (ST)
                            RORC2205:            * postcode (ST)
                            RORC2206:            * country (ID)
                            RORC2207:            * address type (ID)
                            RORC2208:            * other geographic desig. (ST)
                            RORC2209:            * county (IS)
                            RORC2210:            * census tract (IS)
                            RORC2211             * address rep. code (ID)
          GOTO      RORC9999
.
RORC2201  RESET     ORC02201                     * load street address (ST)
          GOTO      RORC9999
.
RORC2202  RESET     ORC02202                     * load other designation (ST)
          GOTO      RORC9999
.
RORC2203  RESET     ORC02203                     * load city (ST)
          GOTO      RORC9999
.
RORC2204  RESET     ORC02204                     * load state (ST)
          GOTO      RORC9999
.
RORC2205  RESET     ORC02205                     * load postcode (ST)
          GOTO      RORC9999
.
RORC2206  RESET     ORC02206                     * load country (ID)
          GOTO      RORC9999
.
RORC2207  RESET     ORC02207                     * load address type (ID)
          GOTO      RORC9999
.
RORC2208  RESET     ORC02208                     * load other geog. desig. (ST)
          GOTO      RORC9999
.
RORC2209  RESET     ORC02209                     * load county (IS)
          GOTO      RORC9999
.
RORC2210  RESET     ORC02210                     * load census tract (IS)
          GOTO      RORC9999
.
RORC2211  RESET     ORC02211                     * load address rep code (ID)
          GOTO      RORC9999
.
.         ORC.23 Ordering Facility Phone Number (XTN)
.
RORC2300  BRANCH    COMPCNT,RORC2301:            * text
                            RORC2302:            * telecomm. use code (ID)
                            RORC2303:            * telcomm. equipment type (ID)
                            RORC2304:            * email address (ST)
                            RORC2305:            * country code (NM)
                            RORC2306:            * area/city code (NM)
                            RORC2307:            * phone number (NM)
                            RORC2308:            * extension (NM)
                            RORC2309             * any text (ST)
          GOTO      RORC9999
.
RORC2301  RESET     ORC02301                     * load text
          GOTO      RORC9999
.
RORC2302  RESET     ORC02302                     * load telecomm. use code (ID)
          GOTO      RORC9999
.
RORC2303  RESET     ORC02303                     * load telcomm. equip.type (ID)
          GOTO      RORC9999
.
RORC2304  RESET     ORC02304                     * load email address (ST)
          GOTO      RORC9999
.
RORC2305  RESET     ORC02305                     * load country code (NM)
          GOTO      RORC9999
.
RORC2306  RESET     ORC02306                     * load area/city code (NM)
          GOTO      RORC9999
.
RORC2307  RESET     ORC02307                     * load phone number (NM)
          GOTO      RORC9999
.
RORC2308  RESET     ORC02308                     * load extension (NM)
          GOTO      RORC9999
.
RORC2309  RESET     ORC02309                     * load any text (ST)
          GOTO      RORC9999
.
.         ORC.24 Ordering Provider Address (XAD)
.
RORC2400  BRANCH    COMPCNT,RORC2401:            * street address (ST)
                            RORC2402:            * other designation (ST)
                            RORC2403:            * city (ST)
                            RORC2404:            * state (ST)
                            RORC2405:            * postcode (ST)
                            RORC2406:            * country (ID)
                            RORC2407:            * address type (ID)
                            RORC2408:            * other geographic desig. (ST)
                            RORC2409:            * county (IS)
                            RORC2410:            * census tract (IS)
                            RORC2411             * address rep. code (ID)
          GOTO      RORC9999
.
RORC2401  RESET     ORC02401                     * load street address (ST)
          GOTO      RORC9999
.
RORC2402  RESET     ORC02402                     * load other designation (ST)
          GOTO      RORC9999
.
RORC2403  RESET     ORC02403                     * load city (ST)
          GOTO      RORC9999
.
RORC2404  RESET     ORC02404                     * load state (ST)
          GOTO      RORC9999
.
RORC2405  RESET     ORC02405                     * load postcode (ST)
          GOTO      RORC9999
.
RORC2406  RESET     ORC02406                     * load country (ID)
          GOTO      RORC9999
.
RORC2407  RESET     ORC02407                     * load address type (ID)
          GOTO      RORC9999
.
RORC2408  RESET     ORC02408                     * load other geog. desig. (ST)
          GOTO      RORC9999
.
RORC2409  RESET     ORC02409                     * load county (IS)
          GOTO      RORC9999
.
RORC2410  RESET     ORC02410                     * load census tract (IS)
          GOTO      RORC9999
.
RORC2411  RESET     ORC02411                     * load address rep code (ID)
          GOTO      RORC9999
.
RORC9999  RETURN
+
.*****************************************************************************
.*                                 RRXD0000        Called by: PROC0000       *
.*                          Reset the RXD fields                             *
.*****************************************************************************
.
RRXD0000  BRANCH    FIELDNO,RRXD0100:            * Dispense Sub-ID Counter
                            RRXD0200:            * Dispense/Give Code
                            RRXD0300:            * Date/Time Dispensed
                            RRXD0400:            * Actual Dispense Amount
                            RRXD0500:            * Actual Dispense Units
                            RRXD0600:            * Actual Dosage Form
                            RRXD0700:            * Prescription Number
                            RRXD0800:            * Number of Refills Remaining
                            RRXD0900:            * Dispense Notes
                            RRXD1000:            * Dispensing Provider
                            RRXD1100:            * Substitution Status
                            RRXD1200:            * Total Daily Dose
                            RRXD1300:            * Dispense-to Location
                            RRXD1400:            * Needs Human Review
                            RRXD1500:            * Pharmacy/Treatment Supplier's
.                                                  Special Disp'ing Instructions
                            RRXD1600:            * Actual Strength
                            RRXD1700:            * Actual Strength Unit
                            RRXD1800:            * Substance Lot Number
                            RRXD1900:            * Substance Expiration Date
                            RRXD2000:            * Substance Manufacturer Name
                            RRXD2100:            * Indication
                            RRXD2200:            * Dispense Package Size
                            RRXD2300:            * Dispense Package Size Unit
                            RRXD2400             * Dispense Package Method
.
.         Invalid RXD field received, so ignore it
.
          GOTO      RRXD9999
.
.         RXD.1 Dispense Sub-ID Counter (NM)
.
RRXD0100  BRANCH    COMPCNT,RRXD0101
          GOTO      RRXD9999
.
RRXD0101  RESET     RXD00101                     * load dispense sub-id counter
          GOTO      RRXD9999
.
.         RXD.2 Dispense/Give Code (CE)
.
RRXD0200  BRANCH    COMPCNT,RRXD0201:            * identifier (ST)
                            RRXD0202:            * text (ST)
                            RRXD0203:            * name of coding system (ST)
                            RRXD0204:            * alternate identifier (ST)
                            RRXD0205:            * alternate text (ST)
                            RRXD0206             * name of alt. coding sys. (ST)
          GOTO      RRXD9999
.
RRXD0201  RESET     RXD00201                     * load identifier (ST)
          GOTO      RRXD9999
.
RRXD0202  RESET     RXD00202                     * load text (ST)
          GOTO      RRXD9999
.
RRXD0203  RESET     RXD00203                     * load name of coding sys. (ST)
          GOTO      RRXD9999
.
RRXD0204  RESET     RXD00204                     * load alt. identifier (ST)
          GOTO      RRXD9999
.
RRXD0205  RESET     RXD00205                     * load alternate text (ST)
          GOTO      RRXD9999
.
RRXD0206  RESET     RXD00206                     * load name alt. cod. sys. (ST)
          GOTO      RRXD9999
.
.         RXD.3 Date/Time Dispensed (TS)
.
RRXD0300  BRANCH    COMPCNT,RRXD0301
          GOTO      RRXD9999
.
RRXD0301  RESET     RXD00301                     * load date/time dispensed
          GOTO      RRXD9999
.
.         RXD.4 Actual Dispense Amount (NM)
.
RRXD0400  BRANCH    COMPCNT,RRXD0401
          GOTO      RRXD9999
.
RRXD0401  RESET     RXD00401                     * load actual dispense amount
          GOTO      RRXD9999
.
.         RXD.5 Actual Dispense Units (CE)
.
RRXD0500  BRANCH    COMPCNT,RRXD0501:            * identifier (ST)
                            RRXD0502:            * text (ST)
                            RRXD0503:            * name of coding system (ST)
                            RRXD0504:            * alternate identifier (ST)
                            RRXD0505:            * alternate text (ST)
                            RRXD0506             * name of alt. coding sys. (ST)
          GOTO      RRXD9999
.
RRXD0501  RESET     RXD00501                     * load identifier (ST)
          GOTO      RRXD9999
.
RRXD0502  RESET     RXD00502                     * load text (ST)
          GOTO      RRXD9999
.
RRXD0503  RESET     RXD00503                     * load name of coding sys. (ST)
          GOTO      RRXD9999
.
RRXD0504  RESET     RXD00504                     * load alt. identifier (ST)
          GOTO      RRXD9999
.
RRXD0505  RESET     RXD00505                     * load alternate text (ST)
          GOTO      RRXD9999
.
RRXD0506  RESET     RXD00506                     * load name alt. cod. sys. (ST)
          GOTO      RRXD9999
.
.         RXD.6 Actual Dosage Form (CE)
.
RRXD0600  BRANCH    COMPCNT,RRXD0601:            * identifier (ST)
                            RRXD0602:            * text (ST)
                            RRXD0603:            * name of coding system (ST)
                            RRXD0604:            * alternate identifier (ST)
                            RRXD0605:            * alternate text (ST)
                            RRXD0606             * name of alt. coding sys. (ST)
          GOTO      RRXD9999
.
RRXD0601  RESET     RXD00601                     * load identifier (ST)
          GOTO      RRXD9999
.
RRXD0602  RESET     RXD00602                     * load text (ST)
          GOTO      RRXD9999
.
RRXD0603  RESET     RXD00603                     * load name of coding sys. (ST)
          GOTO      RRXD9999
.
RRXD0604  RESET     RXD00604                     * load alt. identifier (ST)
          GOTO      RRXD9999
.
RRXD0605  RESET     RXD00605                     * load alternate text (ST)
          GOTO      RRXD9999
.
RRXD0606  RESET     RXD00606                     * load name alt. cod. sys. (ST)
          GOTO      RRXD9999
.
.         RXD.7 Prescription Number (ST)
.
RRXD0700  BRANCH    COMPCNT,RRXD0701
          GOTO      RRXD9999
.
RRXD0701  RESET     RXD00701                     * load prescription number
          GOTO      RRXD9999
.
.         RXD.8 Number of Refills Remaining (NM)
.
RRXD0800  BRANCH    COMPCNT,RRXD0801
          GOTO      RRXD9999
.
RRXD0801  RESET     RXD00801                     * load no of refills remaining
          GOTO      RRXD9999
.
.         RXD.9 Dispense Notes (ST)
.
RRXD0900  BRANCH    COMPCNT,RRXD0901
          GOTO      RRXD9999
.
RRXD0901  RESET     RXD00901                     * load dispense notes
          GOTO      RRXD9999
.
.         RXD.10 Dispensing Provider (XCN)
.
RRXD1000  BRANCH    COMPCNT,RRXD1001:            * id number (ST)
                            RRXD1002:            * family name (ST)
                            RRXD1003:            * given name (ST)
                            RRXD1004:            * middle name (ST)
                            RRXD1005:            * suffix (ST)
                            RRXD1006:            * prefix (ST)
                            RRXD1007:            * degree (IS)
                            RRXD1008:            * source table (IS)
                            RRXD1009:            * assigning authority (HD)
                            RRXD1010:            * name type code (ID)
                            RRXD1011:            * identifier check digit (ST)
                            RRXD1012:            * check digit code scheme (ID)
                            RRXD1013:            * identifier type code (IS)
                            RRXD1014:            * assigning facility (HD)
                            RRXD1015             * name representation code (ID)
          GOTO      RRXD9999
.
RRXD1001  RESET     RXD01001
          GOTO      RRXD9999
.
RRXD1002  RESET     RXD01002
          GOTO      RRXD9999
.
RRXD1003  RESET     RXD01003
          GOTO      RRXD9999
.
RRXD1004  RESET     RXD01004
          GOTO      RRXD9999
.
RRXD1005  RESET     RXD01005
          GOTO      RRXD9999
.
RRXD1006  RESET     RXD01006
          GOTO      RRXD9999
.
RRXD1007  RESET     RXD01007
          GOTO      RRXD9999
.
RRXD1008  RESET     RXD01008
          GOTO      RRXD9999
.
RRXD1009  RESET     RXD01009
          GOTO      RRXD9999
.
RRXD1010  RESET     RXD01010
          GOTO      RRXD9999
.
RRXD1011  RESET     RXD01011
          GOTO      RRXD9999
.
RRXD1012  RESET     RXD01012
          GOTO      RRXD9999
.
RRXD1013  RESET     RXD01013
          GOTO      RRXD9999
.
RRXD1014  RESET     RXD01014
          GOTO      RRXD9999
.
RRXD1015  RESET     RXD01015
          GOTO      RRXD9999
.
.         RXD.11 Substitution Status (ID)
.
RRXD1100  BRANCH    COMPCNT,RRXD1101
          GOTO      RRXD9999
.
RRXD1101  RESET     RXD01101                     * load substitution status
          GOTO      RRXD9999
.
.         RXD.12 Total Daily Dose (CQ)
.
RRXD1200  BRANCH    COMPCNT,RRXD1201:            * quantity (CQ)
                            RRXD1202:            * interval (CM)
                            RRXD1203:            * duration
                            RRXD1204:            * start date/time (TS)
                            RRXD1205:            * end date/time (TS)
                            RRXD1206:            * priority (ID)
                            RRXD1207:            * rtext (TX)
                            RRXD1208:            * conjunction (ID)
                            RRXD1209             * order sequencing
          GOTO      RRXD9999
.
RRXD1201  RESET     RXD01201                     * load quantity
          GOTO      RRXD9999
.
RRXD1202  RESET     RXD01202                     * load interval
          GOTO      RRXD9999
.
RRXD1203  RESET     RXD01203                     * load duration
          GOTO      RRXD9999
.
RRXD1204  RESET     RXD01204                     * load start date/time
          GOTO      RRXD9999
.
RRXD1205  RESET     RXD01205                     * load end date/time
          GOTO      RRXD9999
.
RRXD1206  RESET     RXD01206                     * load priority
          GOTO      RRXD9999
.
RRXD1207  RESET     RXD01207                     * load rtext
          GOTO      RRXD9999
.
RRXD1208  RESET     RXD01208                     * load conjunction
          GOTO      RRXD9999
.
RRXD1209  RESET     RXD01209                     * load order sequence
          GOTO      RRXD9999
.
.         RXD.13 Dispense-to Location (CM)
.
RRXD1300  BRANCH    COMPCNT,RRXD1301:            * point of care (IS)
                            RRXD1302:            * room (IS)
                            RRXD1303:            * bed (IS)
                            RRXD1304:            * facility (HD)
                            RRXD1305:            * location status (IS)
                            RRXD1306:            * patient location type (IS)
                            RRXD1307:            * building (IS)
                            RRXD1308:            * floor (IS)
                            RRXD1309:            * street address (ST)
                            RRXD1310:            * other designation (ST)
                            RRXD1311:            * city (ST)
                            RRXD1312:            * state or province (ST)
                            RRXD1313:            * zip or postal code (ST)
                            RRXD1314:            * country (ID)
                            RRXD1315:            * address type (ID)
                            RRXD1316             * other geographic desig. (ST)
          GOTO      RRXD9999
.
RRXD1301  RESET     RXD01301                     * load point of care
          GOTO      RRXD9999
.
RRXD1302  RESET     RXD01302                     * load room
          GOTO      RRXD9999
.
RRXD1303  RESET     RXD01303                     * load bed
          GOTO      RRXD9999
.
RRXD1304  RESET     RXD01304                     * load facility
          GOTO      RRXD9999
.
RRXD1305  RESET     RXD01305                     * load location status
          GOTO      RRXD9999
.
RRXD1306  RESET     RXD01306                     * load patient location type
          GOTO      RRXD9999
.
RRXD1307  RESET     RXD01307                     * load building
          GOTO      RRXD9999
.
RRXD1308  RESET     RXD01308                     * load floor
          GOTO      RRXD9999
.
RRXD1309  RESET     RXD01309                     * load street address
          GOTO      RRXD9999
.
RRXD1310  RESET     RXD01310                     * load other designation
          GOTO      RRXD9999
.
RRXD1311  RESET     RXD01311                     * load city
          GOTO      RRXD9999
.
RRXD1312  RESET     RXD01312                     * load state or province
          GOTO      RRXD9999
.
RRXD1313  RESET     RXD01313                     * load zip or postal code
          GOTO      RRXD9999
.
RRXD1314  RESET     RXD01314                     * load country
          GOTO      RRXD9999
.
RRXD1315  RESET     RXD01315                     * load address type
          GOTO      RRXD9999
.
RRXD1316  RESET     RXD01316                     * load other geographic desig.
          GOTO      RRXD9999
.
.         RXD.14 Needs Human Review (ID)
.
RRXD1400  BRANCH    COMPCNT,RRXD1401
          GOTO      RRXD9999
.
RRXD1401  RESET     RXD01401                     * load needs human review
          GOTO      RRXD9999
.
.         RXD.15 Pharmacy/Treatment Supplier's Special Dispensing
.                Instructions (CE)
.
RRXD1500  BRANCH    COMPCNT,RRXD1501:            * identifier (ST)
                            RRXD1502:            * text (ST)
                            RRXD1503:            * name of coding system (ST)
                            RRXD1504:            * alternate identifier (ST)
                            RRXD1505:            * alternate text (ST)
                            RRXD1506             * name of alt. coding sys. (ST)
          GOTO      RRXD9999
.
RRXD1501  RESET     RXD01501                     * load identifier (ST)
          GOTO      RRXD9999
.
RRXD1502  RESET     RXD01502                     * load text (ST)
          GOTO      RRXD9999
.
RRXD1503  RESET     RXD01503                     * load name of coding sys. (ST)
          GOTO      RRXD9999
.
RRXD1504  RESET     RXD01504                     * load alt. identifier (ST)
          GOTO      RRXD9999
.
RRXD1505  RESET     RXD01505                     * load alternate text (ST)
          GOTO      RRXD9999
.
RRXD1506  RESET     RXD01506                     * load name alt. cod. sys. (ST)
          GOTO      RRXD9999
.
.         RXD.16 Actual Strength (NM)
.
RRXD1600  BRANCH    COMPCNT,RRXD1601
          GOTO      RRXD9999
.
RRXD1601  RESET     RXD01601                     * load actual strength
          GOTO      RRXD9999
.
.         RXD.17 Actual Strength Unit (CE)
.
RRXD1700  BRANCH    COMPCNT,RRXD1701:            * identifier (ST)
                            RRXD1702:            * text (ST)
                            RRXD1703:            * name of coding system (ST)
                            RRXD1704:            * alternate identifier (ST)
                            RRXD1705:            * alternate text (ST)
                            RRXD1706             * name of alt. coding sys. (ST)
          GOTO      RRXD9999
.
RRXD1701  RESET     RXD01701                     * load identifier (ST)
          GOTO      RRXD9999
.
RRXD1702  RESET     RXD01702                     * load text (ST)
          GOTO      RRXD9999
.
RRXD1703  RESET     RXD01703                     * load name of coding sys. (ST)
          GOTO      RRXD9999
.
RRXD1704  RESET     RXD01704                     * load alt. identifier (ST)
          GOTO      RRXD9999
.
RRXD1705  RESET     RXD01705                     * load alternate text (ST)
          GOTO      RRXD9999
.
RRXD1706  RESET     RXD01706                     * load name alt. cod. sys. (ST)
          GOTO      RRXD9999
.
.         RXD.18 Substance Lot Number (ST)
.
RRXD1800  BRANCH    COMPCNT,RRXD1801
          GOTO      RRXD9999
.
RRXD1801  RESET     RXD01801                     * load dispense notes
          GOTO      RRXD9999
.
.         RXD.19 Substance Expiration Date (TS)
.
RRXD1900  BRANCH    COMPCNT,RRXD1901
          GOTO      RRXD9999
.
RRXD1901  RESET     RXD01901                     * load substance lot no.
          GOTO      RRXD9999
.
.         RXD.20 Substance Manufacturer Name (CE)
.
RRXD2000  BRANCH    COMPCNT,RRXD2001:            * identifier (ST)
                            RRXD2002:            * text (ST)
                            RRXD2003:            * name of coding system (ST)
                            RRXD2004:            * alternate identifier (ST)
                            RRXD2005:            * alternate text (ST)
                            RRXD2006             * name of alt. coding sys. (ST)
          GOTO      RRXD9999
.
RRXD2001  RESET     RXD02001                     * load identifier (ST)
          GOTO      RRXD9999
.
RRXD2002  RESET     RXD02002                     * load text (ST)
          GOTO      RRXD9999
.
RRXD2003  RESET     RXD02003                     * load name of coding sys. (ST)
          GOTO      RRXD9999
.
RRXD2004  RESET     RXD02004                     * load alt. identifier (ST)
          GOTO      RRXD9999
.
RRXD2005  RESET     RXD02005                     * load alternate text (ST)
          GOTO      RRXD9999
.
RRXD2006  RESET     RXD02006                     * load name alt. cod. sys. (ST)
          GOTO      RRXD9999
.
.         RXD.21 Indication (CE)
.
RRXD2100  BRANCH    COMPCNT,RRXD2101:            * identifier (ST)
                            RRXD2102:            * text (ST)
                            RRXD2103:            * name of coding system (ST)
                            RRXD2104:            * alternate identifier (ST)
                            RRXD2105:            * alternate text (ST)
                            RRXD2106             * name of alt. coding sys. (ST)
          GOTO      RRXD9999
.
RRXD2101  RESET     RXD02101                     * load identifier (ST)
          GOTO      RRXD9999
.
RRXD2102  RESET     RXD02102                     * load text (ST)
          GOTO      RRXD9999
.
RRXD2103  RESET     RXD02103                     * load name of coding sys. (ST)
          GOTO      RRXD9999
.
RRXD2104  RESET     RXD02104                     * load alt. identifier (ST)
          GOTO      RRXD9999
.
RRXD2105  RESET     RXD02105                     * load alternate text (ST)
          GOTO      RRXD9999
.
RRXD2106  RESET     RXD00206                     * load name alt. cod. sys. (ST)
          GOTO      RRXD9999
.
.         RXD.22 Dispense Package Size (NM)
.
RRXD2200  BRANCH    COMPCNT,RRXD2201
          GOTO      RRXD9999
.
RRXD2201  RESET     RXD02201                     * load dispense package size
          GOTO      RRXD9999
.
.         RXD.23 Dispense Package Size Unit (CE)
.
RRXD2300  BRANCH    COMPCNT,RRXD2301:            * identifier (ST)
                            RRXD2302:            * text (ST)
                            RRXD2303:            * name of coding system (ST)
                            RRXD2304:            * alternate identifier (ST)
                            RRXD2305:            * alternate text (ST)
                            RRXD2306             * name of alt. coding sys. (ST)
          GOTO      RRXD9999
.
RRXD2301  RESET     RXD02301                     * load identifier (ST)
          GOTO      RRXD9999
.
RRXD2302  RESET     RXD02302                     * load text (ST)
          GOTO      RRXD9999
.
RRXD2303  RESET     RXD02303                     * load name of coding sys. (ST)
          GOTO      RRXD9999
.
RRXD2304  RESET     RXD02304                     * load alt. identifier (ST)
          GOTO      RRXD9999
.
RRXD2305  RESET     RXD02305                     * load alternate text (ST)
          GOTO      RRXD9999
.
RRXD2306  RESET     RXD02306                     * load name alt. cod. sys. (ST)
          GOTO      RRXD9999
.
.         RXD.24 Dispense Package Method (ID)
.
RRXD2400  BRANCH    COMPCNT,RRXD2401
          GOTO      RRXD9999
.
RRXD2401  RESET     RXD02401                     * load dispense package method
          GOTO      RRXD9999
.
RRXD9999  RETURN
+
.*****************************************************************************
.*                                 RRXR0000        Called by: PROC0000       *
.*                          Reset the RXR fields                             *
.*****************************************************************************
.
RRXR0000  BRANCH    FIELDNO,RRXR0100:            * Route
                            RRXR0200:            * Site
                            RRXR0300:            * Administration Device
                            RRXR0400:            * Administration Method
                            RRXR0500             * Routing Instruction
.
.         Invalid RXR field received, so ignore it
.
          GOTO      RRXR9999
.
.         RXR.1 Route (CE)
.
RRXR0100  BRANCH    COMPCNT,RRXR0101:            * identifier (ST)
                            RRXR0102:            * text (ST)
                            RRXR0103:            * name of coding system (ST)
                            RRXR0104:            * alternate identifier (ST)
                            RRXR0105:            * alternate text (ST)
                            RRXR0106             * name of alt. coding sys. (ST)
          GOTO      RRXR9999
.
RRXR0101  RESET     RXR00101                     * load identifier (ST)
          GOTO      RRXR9999
.
RRXR0102  RESET     RXR00102                     * load text (ST)
          GOTO      RRXR9999
.
RRXR0103  RESET     RXR00103                     * load name of coding sys. (ST)
          GOTO      RRXR9999
.
RRXR0104  RESET     RXR00104                     * load alt. identifier (ST)
          GOTO      RRXR9999
.
RRXR0105  RESET     RXR00105                     * load alternate text (ST)
          GOTO      RRXR9999
.
RRXR0106  RESET     RXR00106                     * load name alt. cod. sys. (ST)
          GOTO      RRXR9999
.
.         RXR.2 Site (CE)
.
RRXR0200  BRANCH    COMPCNT,RRXR0201:            * identifier (ST)
                            RRXR0202:            * text (ST)
                            RRXR0203:            * name of coding system (ST)
                            RRXR0204:            * alternate identifier (ST)
                            RRXR0205:            * alternate text (ST)
                            RRXR0206             * name of alt. coding sys. (ST)
          GOTO      RRXR9999
.
RRXR0201  RESET     RXR00201                     * load identifier (ST)
          GOTO      RRXR9999
.
RRXR0202  RESET     RXR00202                     * load text (ST)
          GOTO      RRXR9999
.
RRXR0203  RESET     RXR00203                     * load name of coding sys. (ST)
          GOTO      RRXR9999
.
RRXR0204  RESET     RXR00204                     * load alt. identifier (ST)
          GOTO      RRXR9999
.
RRXR0205  RESET     RXR00205                     * load alternate text (ST)
          GOTO      RRXR9999
.
RRXR0206  RESET     RXR00206                     * load name alt. cod. sys. (ST)
          GOTO      RRXR9999
.
.         RXR.3 Administration Device (CE)
.
RRXR0300  BRANCH    COMPCNT,RRXR0301:            * identifier (ST)
                            RRXR0302:            * text (ST)
                            RRXR0303:            * name of coding system (ST)
                            RRXR0304:            * alternate identifier (ST)
                            RRXR0305:            * alternate text (ST)
                            RRXR0306             * name of alt. coding sys. (ST)
          GOTO      RRXR9999
.
RRXR0301  RESET     RXR00301                     * load identifier (ST)
          GOTO      RRXR9999
.
RRXR0302  RESET     RXR00302                     * load text (ST)
          GOTO      RRXR9999
.
RRXR0303  RESET     RXR00303                     * load name of coding sys. (ST)
          GOTO      RRXR9999
.
RRXR0304  RESET     RXR00304                     * load alt. identifier (ST)
          GOTO      RRXR9999
.
RRXR0305  RESET     RXR00305                     * load alternate text (ST)
          GOTO      RRXR9999
.
RRXR0306  RESET     RXR00306                     * load name alt. cod. sys. (ST)
          GOTO      RRXR9999
.
.         RXR.4 Administration Method (CE)
.
RRXR0400  BRANCH    COMPCNT,RRXR0401:            * identifier (ST)
                            RRXR0402:            * text (ST)
                            RRXR0403:            * name of coding system (ST)
                            RRXR0404:            * alternate identifier (ST)
                            RRXR0405:            * alternate text (ST)
                            RRXR0406             * name of alt. coding sys. (ST)
          GOTO      RRXR9999
.
RRXR0401  RESET     RXR00401                     * load identifier (ST)
          GOTO      RRXR9999
.
RRXR0402  RESET     RXR00402                     * load text (ST)
          GOTO      RRXR9999
.
RRXR0403  RESET     RXR00403                     * load name of coding sys. (ST)
          GOTO      RRXR9999
.
RRXR0404  RESET     RXR00404                     * load alt. identifier (ST)
          GOTO      RRXR9999
.
RRXR0405  RESET     RXR00405                     * load alternate text (ST)
          GOTO      RRXR9999
.
RRXR0406  RESET     RXR00406                     * load name alt. cod. sys. (ST)
          GOTO      RRXR9999
.
.         RXR.5 Routing Instruction (CE)
.
RRXR0500  BRANCH    COMPCNT,RRXR0501:            * identifier (ST)
                            RRXR0502:            * text (ST)
                            RRXR0503:            * name of coding system (ST)
                            RRXR0504:            * alternate identifier (ST)
                            RRXR0505:            * alternate text (ST)
                            RRXR0506             * name of alt. coding sys. (ST)
          GOTO      RRXR9999
.
RRXR0501  RESET     RXR00501                     * load identifier (ST)
          GOTO      RRXR9999
.
RRXR0502  RESET     RXR00502                     * load text (ST)
          GOTO      RRXR9999
.
RRXR0503  RESET     RXR00503                     * load name of coding sys. (ST)
          GOTO      RRXR9999
.
RRXR0504  RESET     RXR00504                     * load alt. identifier (ST)
          GOTO      RRXR9999
.
RRXR0505  RESET     RXR00505                     * load alternate text (ST)
          GOTO      RRXR9999
.
RRXR0506  RESET     RXR00506                     * load name alt. cod. sys. (ST)
          GOTO      RRXR9999
.
RRXR9999  RETURN
+
.*****************************************************************************
.*                                 ROBR0000        Called by: PROC0000       *
.*                          Reset the OBR fields                             *
.*****************************************************************************
.
ROBR0000  BRANCH    FIELDNO,ROBR0100:            * Set ID - OBR
                            ROBR0200:            * Placer Order Number
                            ROBR0300:            * Filler Order Number
                            ROBR0400:            * Universal Service ID
                            ROBR0500:            * Priority - OBR
                            ROBR0600:            * Requested Date/Time
                            ROBR0700:            * Observation Date/Time #
                            ROBR0800:            * Observation End Date/Time #
                            ROBR0900:            * Collection Volume
                            ROBR1000:            * Collector Identifier
                            ROBR1100:            * Specimen Action Code
                            ROBR1200:            * Danger Code
                            ROBR1300:            * Relevant Clinical Info
                            ROBR1400:            * Specimen Received Date/Time
                            ROBR1500:            * Specimen Source
                            ROBR1600:            * Ordering Provider
                            ROBR1700:            * Order Callback Phone Number
                            ROBR1800:            * Placer Field 1
                            ROBR1900:            * Placer Field 2
                            ROBR2000:            * Filler Field 1
                            ROBR2100:            * Filler Field 2
                            ROBR2200:            * Results Rpt/Status Chng -
.                                                  Date/Time
                            ROBR2300:            * Charge to Practice
                            ROBR2400:            * Diagnostic Serv Sect ID
                            ROBR2500:            * Result Status
                            ROBR2600:            * Parent Result
                            ROBR2700:            * Quantity/Timing
                            ROBR2800:            * Result Copies To
                            ROBR2900:            * Parent
                            ROBR3000:            * Transportation Mode
                            ROBR3100:            * Reason for Study
                            ROBR3200:            * Principal Result Interpreter
                            ROBR3300:            * Assistant Result Interpreter
                            ROBR3400:            * Technician
                            ROBR3500:            * Transcriptionist
                            ROBR3600:            * Scheduled Date/Time
                            ROBR3700:            * Number of Sample Containers
                            ROBR3800:            * Transport Logistics of
.                                                  Collected Sample
                            ROBR3900:            * Collector's Comment
                            ROBR4000:            * Transport Arrangement
.                                                  Responsibility
                            ROBR4100:            * Transport Arranged
                            ROBR4200:            * Escort Required
                            ROBR4300:            * Planned Patient Transport
.                                                  Comment
                            ROBR4400:            * Procedure Code
                            ROBR4500             * Procedure Code Modifier
.
.         Invalid OBR field received, so ignore it
.
.         OBR.1  Set ID (SI)
.
ROBR0100  BRANCH    COMPCNT,ROBR0101
          GOTO      ROBR9999
.
ROBR0101  RESET     OBR00101
          GOTO      ROBR9999
.
.         OBR.2  Placer Order Number (EI)
.
ROBR0200  BRANCH    COMPCNT,ROBR0201:            * entity identifier (ST)
                            ROBR0202:            * namespace id (IS)
                            ROBR0203:            * universal id (ST)
                            ROBR0204             * universal id type (ID)
          GOTO      ROBR9999
.
ROBR0201  RESET     OBR00201                     * load entity identifier (ST)
          GOTO      ROBR9999
.
ROBR0202  RESET     OBR00202                     * load namespace id (IS)
          GOTO      ROBR9999
.
ROBR0203  RESET     OBR00203                     * load universal id (ST)
          GOTO      ROBR9999
.
ROBR0204  RESET     OBR00204                     * load universal id type (ID)
          GOTO      ROBR9999
.
.         OBR.3  Filler Order Number (EI)
.
ROBR0300  BRANCH    COMPCNT,ROBR0301:            * entity identifier (ST)
                            ROBR0302:            * namespace id (IS)
                            ROBR0303:            * universal id (ST)
                            ROBR0304             * universal id type (ID)
          GOTO      ROBR9999
.
ROBR0301  RESET     OBR00301                     * load entity identifier (ST)
          GOTO      ROBR9999
.
ROBR0302  RESET     OBR00302                     * load namespace id (IS)
          GOTO      ROBR9999
.
ROBR0303  RESET     OBR00303                     * load universal id (ST)
          GOTO      ROBR9999
.
ROBR0304  RESET     OBR00304                     * load universal id type (ID)
          GOTO      ROBR9999
.
.         OBR.4 Universal Service ID (CE)
.
ROBR0400  BRANCH    COMPCNT,ROBR0401:            * identifier (ST)
                            ROBR0402:            * text (ST)
                            ROBR0403:            * name of coding system (ST)
                            ROBR0404:            * alternate identifier (ST)
                            ROBR0405:            * alternate text (ST)
                            ROBR0406             * name of alt. cod. system (ST)
          GOTO      ROBR9999
.
ROBR0401  RESET     OBR00401                     * load identifier (ST)
          GOTO      ROBR9999
.
ROBR0402  RESET     OBR00402                     * load text (ST)
          GOTO      ROBR9999
.
ROBR0403  RESET     OBR00403                     * load name of cod. system (ST)
          GOTO      ROBR9999
.
ROBR0404  RESET     OBR00404                     * load alt. identifier (ST)
          GOTO      ROBR9999
.
ROBR0405  RESET     OBR00405                     * load alternate text (ST)
          GOTO      ROBR9999
.
ROBR0406  RESET     OBR00406                     * load alt. cod. sys. name (ST)
          GOTO      ROBR9999
.
.         OBR.5  Priority (ID)
.
ROBR0500  BRANCH    COMPCNT,ROBR0501
          GOTO      ROBR9999
.
ROBR0501  RESET     OBR00501
          GOTO      ROBR9999
.
.         OBR.6  Requested Date/Time (TS)
.
ROBR0600  BRANCH    COMPCNT,ROBR0601
          GOTO      ROBR9999
.
ROBR0601  RESET     OBR00601
          GOTO      ROBR9999
.
.         OBR.7  Observation Date/Time (TS)
.
ROBR0700  BRANCH    COMPCNT,ROBR0701
          GOTO      ROBR9999
.
ROBR0701  RESET     OBR00701
          GOTO      ROBR9999
.
.         OBR.8  Observation End Date/Time (TS)
.
ROBR0800  BRANCH    COMPCNT,ROBR0801
          GOTO      ROBR9999
.
ROBR0801  RESET     OBR00801
          GOTO      ROBR9999
.
.         OBR.9 Collection Volume (CQ)
.
ROBR0900  BRANCH    COMPCNT,ROBR0901:            * quantity (NM)
                            ROBR0902             * units (CE)
.
ROBR0901  RESET     OBR00901                     * load quantity (NM)
          GOTO      ROBR9999
.
ROBR0902  RESET     OBR00902                     * load units (CE)
          GOTO      ROBR9999
.
.         OBR.10 Collector Identifier (XCN)
.
ROBR1000  BRANCH    COMPCNT,ROBR1001:            * id number (ST)
                            ROBR1002:            * family name (ST)
                            ROBR1003:            * given name (ST)
                            ROBR1004:            * middle name (ST)
                            ROBR1005:            * suffix (ST)
                            ROBR1006:            * prefix (ST)
                            ROBR1007:            * degree (IS)
                            ROBR1008:            * source table (IS)
                            ROBR1009:            * assigning authority (HD)
                            ROBR1010:            * name type code (ID)
                            ROBR1011:            * identifier check digit (ST)
                            ROBR1012:            * check digit scheme code (ID)
                            ROBR1013:            * identifier type code (IS)
                            ROBR1014:            * assigning facility (HD)
                            ROBR1015             * name representation code (ID)
          GOTO      ROBR9999
.
ROBR1001  RESET     OBR01001                     * load id number (ST)
          GOTO      ROBR9999
.
ROBR1002  RESET     OBR01002                     * load family name (ST)
          GOTO      ROBR9999
.
ROBR1003  RESET     OBR01003                     * load given name (ST)
          GOTO      ROBR9999
.
ROBR1004  RESET     OBR01004                     * load middle name (ST)
          GOTO      ROBR9999
.
ROBR1005  RESET     OBR01005                     * load suffix (ST)
          GOTO      ROBR9999
.
ROBR1006  RESET     OBR01006                     * load prefix (ST)
          GOTO      ROBR9999
.
ROBR1007  RESET     OBR01007                     * load degree (IS)
          GOTO      ROBR9999
.
ROBR1008  RESET     OBR01008                     * load source table (IS)
          GOTO      ROBR9999
.
ROBR1009  RESET     OBR01009                     * load assigning authority (HD)
          GOTO      ROBR9999
.
ROBR1010  RESET     OBR01010                     * load name type code (ID)
          GOTO      ROBR9999
.
ROBR1011  RESET     OBR01011                     * load ident. check digit (ST)
          GOTO      ROBR9999
.
ROBR1012  RESET     OBR01012                     * load chk dig scheme code (ID)
          GOTO      ROBR9999
.
ROBR1013  RESET     OBR01013                     * load ident. type code (IS)
          GOTO      ROBR9999
.
ROBR1014  RESET     OBR01014                     * load assigning facility (HD)
          GOTO      ROBR9999
.
ROBR1015  RESET     OBR01015                     * load name repres. code (ID)
          GOTO      ROBR9999
.
.         OBR.11  Specimen Action Code (ID)
.
ROBR1100  BRANCH    COMPCNT,ROBR1101
          GOTO      ROBR9999
.
ROBR1101  RESET     OBR01101
          GOTO      ROBR9999
.
.         OBR.12 Danger Code (CE)
.
ROBR1200  BRANCH    COMPCNT,ROBR1201:            * identifier (ST)
                            ROBR1202:            * text (ST)
                            ROBR1203:            * name of coding system (ST)
                            ROBR1204:            * alternate identifier (ST)
                            ROBR1205:            * alternate text (ST)
                            ROBR1206             * name of alt. cod. system (ST)
          GOTO      ROBR9999
.
ROBR1201  RESET     OBR01201                     * load identifier (ST)
          GOTO      ROBR9999
.
ROBR1202  RESET     OBR01202                     * load text (ST)
          GOTO      ROBR9999
.
ROBR1203  RESET     OBR01203                     * load name of cod. system (ST)
          GOTO      ROBR9999
.
ROBR1204  RESET     OBR01204                     * load alt. identifier (ST)
          GOTO      ROBR9999
.
ROBR1205  RESET     OBR01205                     * load alternate text (ST)
          GOTO      ROBR9999
.
ROBR1206  RESET     OBR01206                     * load alt. cod. sys. name (ST)
          GOTO      ROBR9999
.
.         OBR.13  Relevant Clinical Info (ST)
.
ROBR1300  BRANCH    COMPCNT,ROBR1301
          GOTO      ROBR9999
.
ROBR1301  RESET     OBR01301
          GOTO      ROBR9999
.
.         OBR.14  Specimen Received Date/Time (TS)
.
ROBR1400  BRANCH    COMPCNT,ROBR1401
          GOTO      ROBR9999
.
ROBR1401  RESET     OBR01401
          GOTO      ROBR9999
.
.         OBR.15 Specimen Source (CM)
.
ROBR1500  BRANCH    COMPCNT,ROBR1501:            * specimen source code (CE)
                            ROBR1502:            * additives (TX)
                            ROBR1503:            * freetext (TX)
                            ROBR1504:            * body site (CE)
                            ROBR1505:            * site modifier (CE)
                            ROBR1506:            * coll. method modifier (CE)
.
ROBR1501  RESET     OBR01501                     * load spec. source code (CE)
          GOTO      ROBR9999
.
ROBR1502  RESET     OBR01502                     * load additives (TX)
          GOTO      ROBR9999
.
ROBR1503  RESET     OBR01503                     * load freetext (TX)
          GOTO      ROBR9999
.
ROBR1504  RESET     OBR01504                     * load body site (CE)
          GOTO      ROBR9999
.
ROBR1505  RESET     OBR01505                     * load site modifier (CE)
          GOTO      ROBR9999
.
ROBR1506  RESET     OBR01506                     * load coll. method mod. (CE)
          GOTO      ROBR9999
.
.         OBR.16 Ordering Provider (XCN)
.
ROBR1600  BRANCH    COMPCNT,ROBR1601:            * id number (ST)
                            ROBR1602:            * family name (ST)
                            ROBR1603:            * given name (ST)
                            ROBR1604:            * middle name (ST)
                            ROBR1605:            * suffix (ST)
                            ROBR1606:            * prefix (ST)
                            ROBR1607:            * degree (IS)
                            ROBR1608:            * source table (IS)
                            ROBR1609:            * assigning authority (HD)
                            ROBR1610:            * name type code (ID)
                            ROBR1611:            * identifier check digit (ST)
                            ROBR1612:            * check digit scheme code (ID)
                            ROBR1613:            * identifier type code (IS)
                            ROBR1614:            * assigning facility (HD)
                            ROBR1615             * name representation code (ID)
          GOTO      ROBR9999
.
ROBR1601  RESET     OBR01601                     * load id number (ST)
          GOTO      ROBR9999
.
ROBR1602  RESET     OBR01602                     * load family name (ST)
          GOTO      ROBR9999
.
ROBR1603  RESET     OBR01603                     * load given name (ST)
          GOTO      ROBR9999
.
ROBR1604  RESET     OBR01604                     * load middle name (ST)
          GOTO      ROBR9999
.
ROBR1605  RESET     OBR01605                     * load suffix (ST)
          GOTO      ROBR9999
.
ROBR1606  RESET     OBR01606                     * load prefix (ST)
          GOTO      ROBR9999
.
ROBR1607  RESET     OBR01607                     * load degree (IS)
          GOTO      ROBR9999
.
ROBR1608  RESET     OBR01608                     * load source table (IS)
          GOTO      ROBR9999
.
ROBR1609  RESET     OBR01609                     * load assigning authority (HD)
          GOTO      ROBR9999
.
ROBR1610  RESET     OBR01610                     * load name type code (ID)
          GOTO      ROBR9999
.
ROBR1611  RESET     OBR01611                     * load ident. check digit (ST)
          GOTO      ROBR9999
.
ROBR1612  RESET     OBR01612                     * load chk dig scheme code (ID)
          GOTO      ROBR9999
.
ROBR1613  RESET     OBR01613                     * load ident. type code (IS)
          GOTO      ROBR9999
.
ROBR1614  RESET     OBR01614                     * load assigning facility (HD)
          GOTO      ROBR9999
.
ROBR1615  RESET     OBR01615                     * load name repres. code (ID)
          GOTO      ROBR9999
.
.         OBR.17 Order Callback Phone Number (XTN)
.
ROBR1700  BRANCH    COMPCNT,ROBR1701:            * text
                            ROBR1702:            * telecomm. use code (ID)
                            ROBR1703:            * telcomm. equipment type (ID)
                            ROBR1704:            * email address (ST)
                            ROBR1705:            * country code (NM)
                            ROBR1706:            * area/city code (NM)
                            ROBR1707:            * phone number (NM)
                            ROBR1708:            * extension (NM)
                            ROBR1709             * any text (ST)
          GOTO      ROBR9999
.
ROBR1701  RESET     OBR01701                     * load text
          GOTO      ROBR9999
.
ROBR1702  RESET     OBR01702                     * load telecomm. use code (ID)
          GOTO      ROBR9999
.
ROBR1703  RESET     OBR01703                     * load telcomm. equip.type (ID)
          GOTO      ROBR9999
.
ROBR1704  RESET     OBR01704                     * load email address (ST)
          GOTO      ROBR9999
.
ROBR1705  RESET     OBR01705                     * load country code (NM)
          GOTO      ROBR9999
.
ROBR1706  RESET     OBR01706                     * load area/city code (NM)
          GOTO      ROBR9999
.
ROBR1707  RESET     OBR01707                     * load phone number (NM)
          GOTO      ROBR9999
.
ROBR1708  RESET     OBR01708                     * load extension (NM)
          GOTO      ROBR9999
.
ROBR1709  RESET     OBR01709                     * load any text (ST)
          GOTO      ROBR9999
.
.         OBR.18  Placer Field 1 (ST)
.
ROBR1800  BRANCH    COMPCNT,ROBR1801
          GOTO      ROBR9999
.
ROBR1801  RESET     OBR01801
          GOTO      ROBR9999
.
.         OBR.19  Placer Field 2 (ST)
.
ROBR1900  BRANCH    COMPCNT,ROBR1901
          GOTO      ROBR9999
.
ROBR1901  RESET     OBR01901
          GOTO      ROBR9999
.
.         OBR.20  Filler Field 1 (ST)
.
ROBR2000  BRANCH    COMPCNT,ROBR2001
          GOTO      ROBR9999
.
ROBR2001  RESET     OBR02001
          GOTO      ROBR9999
.
.         OBR.21  Filler Field 2 (ST)
.
ROBR2100  BRANCH    COMPCNT,ROBR2101
          GOTO      ROBR9999
.
ROBR2101  RESET     OBR02101
          GOTO      ROBR9999
.
.         OBR.22  Results Rpt/Status Chng - Date/Time (TS)
.
ROBR2200  BRANCH    COMPCNT,ROBR2201
          GOTO      ROBR9999
.
ROBR2201  RESET     OBR02201
          GOTO      ROBR9999
.
.         OBR.23 Charge to Practice (CM)
.
ROBR2300  BRANCH    COMPCNT,ROBR2301:            * dollar amount (MO)
                            ROBR2302             * charge code (CE)
.
ROBR2301  RESET     OBR02301                     * load dollar amount
          GOTO      ROBR9999
.
ROBR2302  RESET     OBR02302                     * load charge code
          GOTO      ROBR9999
.
.         OBR.24  Diagnostic Serv Sect ID (ID)
.
ROBR2400  BRANCH    COMPCNT,ROBR2401
          GOTO      ROBR9999
.
ROBR2401  RESET     OBR02401
          GOTO      ROBR9999
.
.         OBR.25  Result Status (ID)
.
ROBR2500  BRANCH    COMPCNT,ROBR2501
          GOTO      ROBR9999
.
ROBR2501  RESET     OBR02501
          GOTO      ROBR9999
.
.         OBR.26 Parent Result (CM)
.
ROBR2600  BRANCH    COMPCNT,ROBR2601:            * OBX.3 obs. identifier (CE)
                            ROBR2602:            * OBX.4 sub-id (ST)
                            ROBR2603             * part of OBX.5 obs. (TX)
.
ROBR2601  RESET     OBR02601                     * load obs. identifier (CE)
          GOTO      ROBR9999
.
ROBR2602  RESET     OBR02602                     * load sub-id (ST)
          GOTO      ROBR9999
.
ROBR2603  RESET     OBR02603                     * load obs. (TX)
          GOTO      ROBR9999
.
.         OBR.27 Quantity/Timing (TQ)
.
ROBR2700  BRANCH    COMPCNT,ROBR2701:            * quantity (CQ)
                            ROBR2702:            * interval (CM)
                            ROBR2703:            * duration (ST)
                            ROBR2704:            * start date/time (TS)
                            ROBR2705:            * end date/time (TS)
                            ROBR2706:            * priority (ST)
                            ROBR2707:            * condition (ST)
                            ROBR2708:            * text (TX)
                            ROBR2709:            * conjunction (ST)
                            ROBR2710:            * order sequencing (CM)
                            ROBR2711:            * occurence duration (CE)
                            ROBR2712             * total occurrences (NM)
.
ROBR2701  RESET     OBR02701                     * load quantity (CQ)
          GOTO      ROBR9999
.
ROBR2702  RESET     OBR02702                     * load interval (CM)
          GOTO      ROBR9999
.
ROBR2703  RESET     OBR02703                     * load duration (ST)
          GOTO      ROBR9999
.
ROBR2704  RESET     OBR02704                     * load start date/time (TS)
          GOTO      ROBR9999
.
ROBR2705  RESET     OBR02705                     * load end date/time (TS)
          GOTO      ROBR9999
.
ROBR2706  RESET     OBR02706                     * load priority (ST)
          GOTO      ROBR9999
.
ROBR2707  RESET     OBR02707                     * load condition (ST)
          GOTO      ROBR9999
.
ROBR2708  RESET     OBR02708                     * load text (TX)
          GOTO      ROBR9999
.
ROBR2709  RESET     OBR02709                     * load conjunction (ST)
          GOTO      ROBR9999
.
ROBR2710  RESET     OBR02710                     * load order sequencing (CM)
          GOTO      ROBR9999
.
ROBR2711  RESET     OBR02711                     * load occurence duration (CE)
          GOTO      ROBR9999
.
ROBR2712  RESET     OBR02712                     * load total occurrences (NM)
          GOTO      ROBR9999
.
.         OBR.28 Result Copies To (XCN)
.
ROBR2800  BRANCH    COMPCNT,ROBR2801:            * id number (ST)
                            ROBR2802:            * family name (ST)
                            ROBR2803:            * given name (ST)
                            ROBR2804:            * middle name (ST)
                            ROBR2805:            * suffix (ST)
                            ROBR2806:            * prefix (ST)
                            ROBR2807:            * degree (IS)
                            ROBR2808:            * source table (IS)
                            ROBR2809:            * assigning authority (HD)
                            ROBR2810:            * name type code (ID)
                            ROBR2811:            * identifier check digit (ST)
                            ROBR2812:            * check digit scheme code (ID)
                            ROBR2813:            * identifier type code (IS)
                            ROBR2814:            * assigning facility (HD)
                            ROBR2815             * name representation code (ID)
          GOTO      ROBR9999
.
ROBR2801  RESET     OBR02801                     * load id number (ST)
          GOTO      ROBR9999
.
ROBR2802  RESET     OBR02802                     * load family name (ST)
          GOTO      ROBR9999
.
ROBR2803  RESET     OBR02803                     * load given name (ST)
          GOTO      ROBR9999
.
ROBR2804  RESET     OBR02804                     * load middle name (ST)
          GOTO      ROBR9999
.
ROBR2805  RESET     OBR02805                     * load suffix (ST)
          GOTO      ROBR9999
.
ROBR2806  RESET     OBR02806                     * load prefix (ST)
          GOTO      ROBR9999
.
ROBR2807  RESET     OBR02807                     * load degree (IS)
          GOTO      ROBR9999
.
ROBR2808  RESET     OBR02808                     * load source table (IS)
          GOTO      ROBR9999
.
ROBR2809  RESET     OBR02809                     * load assigning authority (HD)
          GOTO      ROBR9999
.
ROBR2810  RESET     OBR02810                     * load name type code (ID)
          GOTO      ROBR9999
.
ROBR2811  RESET     OBR02811                     * load ident. check digit (ST)
          GOTO      ROBR9999
.
ROBR2812  RESET     OBR02812                     * load chk dig scheme code (ID)
          GOTO      ROBR9999
.
ROBR2813  RESET     OBR02813                     * load ident. type code (IS)
          GOTO      ROBR9999
.
ROBR2814  RESET     OBR02814                     * load assigning facility (HD)
          GOTO      ROBR9999
.
ROBR2815  RESET     OBR02815                     * load name repres. code (ID)
          GOTO      ROBR9999
.
.         OBR.29 Parent (CM)
.
ROBR2900  BRANCH    COMPCNT,ROBR2901:            * parent's placer order # (EI)
                            ROBR2902             * parent's filler order # (EI)
.
ROBR2901  RESET     OBR02901                     * load parent's placer order #
          GOTO      ROBR9999
.
ROBR2902  RESET     OBR02902                     * load parent's filler order #
          GOTO      ROBR9999
.
.         OBR.30  Transportation Mode (ID)
.
ROBR3000  BRANCH    COMPCNT,ROBR3001
          GOTO      ROBR9999
.
ROBR3001  RESET     OBR03001
          GOTO      ROBR9999
.
.         OBR.31 Reason for Study (CE)
.
ROBR3100  BRANCH    COMPCNT,ROBR3101:            * identifier (ST)
                            ROBR3102:            * text (ST)
                            ROBR3103:            * name of coding system (ST)
                            ROBR3104:            * alternate identifier (ST)
                            ROBR3105:            * alternate text (ST)
                            ROBR3106             * name of alt. cod. system (ST)
          GOTO      ROBR9999
.
ROBR3101  RESET     OBR03101                     * load identifier (ST)
          GOTO      ROBR9999
.
ROBR3102  RESET     OBR03102                     * load text (ST)
          GOTO      ROBR9999
.
ROBR3103  RESET     OBR03103                     * load name of cod. system (ST)
          GOTO      ROBR9999
.
ROBR3104  RESET     OBR03104                     * load alt. identifier (ST)
          GOTO      ROBR9999
.
ROBR3105  RESET     OBR03105                     * load alternate text (ST)
          GOTO      ROBR9999
.
ROBR3106  RESET     OBR03106                     * load alt. cod. sys. name (ST)
          GOTO      ROBR9999
.
.         OBR.32 Principal Result Interpreter (CM)
.
ROBR3200  BRANCH    COMPCNT,ROBR3201:            * name (CN)
                            ROBR3202:            * start date/time (TS)
                            ROBR3203:            * end date/time (TS)
                            ROBR3204:            * point of care (IS)
                            ROBR3205:            * room (IS)
                            ROBR3206:            * bed (IS)
                            ROBR3207:            * facility (HD)
                            ROBR3208:            * location status (IS)
                            ROBR3209:            * patient location (IS)
                            ROBR3210:            * building (IS)
                            ROBR3211             * floor (IS)
.
ROBR3201  RESET     OBR03201                     * load name (CN)
          GOTO      ROBR9999
.
ROBR3202  RESET     OBR03202                     * load start date/time (TS)
          GOTO      ROBR9999
.
ROBR3203  RESET     OBR03203                     * load end date/time (TS)
          GOTO      ROBR9999
.
ROBR3204  RESET     OBR03204                     * load point of care (IS)
          GOTO      ROBR9999
.
ROBR3205  RESET     OBR03205                     * load room (IS)
          GOTO      ROBR9999
.
ROBR3206  RESET     OBR03206                     * load bed (IS)
          GOTO      ROBR9999
.
ROBR3207  RESET     OBR03207                     * load facility (HD)
          GOTO      ROBR9999
.
ROBR3208  RESET     OBR03208                     * load location status (IS)
          GOTO      ROBR9999
.
ROBR3209  RESET     OBR03209                     * load patient location (IS)
          GOTO      ROBR9999
.
ROBR3210  RESET     OBR03210                     * load building (IS)
          GOTO      ROBR9999
.
ROBR3211  RESET     OBR03211                     * load floor (IS)
          GOTO      ROBR9999
.
.         OBR.33 Assistant Result Interpreter (CM)
.
ROBR3300  BRANCH    COMPCNT,ROBR3301:            * name (CN)
                            ROBR3302:            * start date/time (TS)
                            ROBR3303:            * end date/time (TS)
                            ROBR3304:            * point of care (IS)
                            ROBR3305:            * room (IS)
                            ROBR3306:            * bed (IS)
                            ROBR3307:            * facility (HD)
                            ROBR3308:            * location status (IS)
                            ROBR3309:            * patient location (IS)
                            ROBR3310:            * building (IS)
                            ROBR3311             * floor (IS)
.
ROBR3301  RESET     OBR03301                     * load name (CN)
          GOTO      ROBR9999
.
ROBR3302  RESET     OBR03302                     * load start date/time (TS)
          GOTO      ROBR9999
.
ROBR3303  RESET     OBR03303                     * load end date/time (TS)
          GOTO      ROBR9999
.
ROBR3304  RESET     OBR03304                     * load point of care (IS)
          GOTO      ROBR9999
.
ROBR3305  RESET     OBR03305                     * load room (IS)
          GOTO      ROBR9999
.
ROBR3306  RESET     OBR03306                     * load bed (IS)
          GOTO      ROBR9999
.
ROBR3307  RESET     OBR03307                     * load facility (HD)
          GOTO      ROBR9999
.
ROBR3308  RESET     OBR03308                     * load location status (IS)
          GOTO      ROBR9999
.
ROBR3309  RESET     OBR03309                     * load patient location (IS)
          GOTO      ROBR9999
.
ROBR3310  RESET     OBR03310                     * load building (IS)
          GOTO      ROBR9999
.
ROBR3311  RESET     OBR03311                     * load floor (IS)
          GOTO      ROBR9999
.
.         OBR.34 Technician (CM)
.
ROBR3400  BRANCH    COMPCNT,ROBR3401:            * name (CN)
                            ROBR3402:            * start date/time (TS)
                            ROBR3403:            * end date/time (TS)
                            ROBR3404:            * point of care (IS)
                            ROBR3405:            * room (IS)
                            ROBR3406:            * bed (IS)
                            ROBR3407:            * facility (HD)
                            ROBR3408:            * location status (IS)
                            ROBR3409:            * patient location (IS)
                            ROBR3410:            * building (IS)
                            ROBR3411             * floor (IS)
.
ROBR3401  RESET     OBR03401                     * load name (CN)
          GOTO      ROBR9999
.
ROBR3402  RESET     OBR03402                     * load start date/time (TS)
          GOTO      ROBR9999
.
ROBR3403  RESET     OBR03403                     * load end date/time (TS)
          GOTO      ROBR9999
.
ROBR3404  RESET     OBR03404                     * load point of care (IS)
          GOTO      ROBR9999
.
ROBR3405  RESET     OBR03405                     * load room (IS)
          GOTO      ROBR9999
.
ROBR3406  RESET     OBR03406                     * load bed (IS)
          GOTO      ROBR9999
.
ROBR3407  RESET     OBR03407                     * load facility (HD)
          GOTO      ROBR9999
.
ROBR3408  RESET     OBR03408                     * load location status (IS)
          GOTO      ROBR9999
.
ROBR3409  RESET     OBR03409                     * load patient location (IS)
          GOTO      ROBR9999
.
ROBR3410  RESET     OBR03410                     * load building (IS)
          GOTO      ROBR9999
.
ROBR3411  RESET     OBR03411                     * load floor (IS)
          GOTO      ROBR9999
.
.         OBR.35 Transcriptionist (CM)
.
ROBR3500  BRANCH    COMPCNT,ROBR3501:            * name (CN)
                            ROBR3502:            * start date/time (TS)
                            ROBR3503:            * end date/time (TS)
                            ROBR3504:            * point of care (IS)
                            ROBR3505:            * room (IS)
                            ROBR3506:            * bed (IS)
                            ROBR3507:            * facility (HD)
                            ROBR3508:            * location status (IS)
                            ROBR3509:            * patient location (IS)
                            ROBR3510:            * building (IS)
                            ROBR3511             * floor (IS)
.
ROBR3501  RESET     OBR03501                     * load name (CN)
          GOTO      ROBR9999
.
ROBR3502  RESET     OBR03502                     * load start date/time (TS)
          GOTO      ROBR9999
.
ROBR3503  RESET     OBR03503                     * load end date/time (TS)
          GOTO      ROBR9999
.
ROBR3504  RESET     OBR03504                     * load point of care (IS)
          GOTO      ROBR9999
.
ROBR3505  RESET     OBR03505                     * load room (IS)
          GOTO      ROBR9999
.
ROBR3506  RESET     OBR03506                     * load bed (IS)
          GOTO      ROBR9999
.
ROBR3507  RESET     OBR03507                     * load facility (HD)
          GOTO      ROBR9999
.
ROBR3508  RESET     OBR03508                     * load location status (IS)
          GOTO      ROBR9999
.
ROBR3509  RESET     OBR03509                     * load patient location (IS)
          GOTO      ROBR9999
.
ROBR3510  RESET     OBR03510                     * load building (IS)
          GOTO      ROBR9999
.
ROBR3511  RESET     OBR03511                     * load floor (IS)
          GOTO      ROBR9999
.
.         OBR.36  Scheduled Date/Time (TS)
.
ROBR3600  BRANCH    COMPCNT,ROBR3601
          GOTO      ROBR9999
.
ROBR3601  RESET     OBR03601
          GOTO      ROBR9999
.
.         OBR.37  Number of Sample Containers (NM)
.
ROBR3700  BRANCH    COMPCNT,ROBR3701
          GOTO      ROBR9999
.
ROBR3701  RESET     OBR03701
          GOTO      ROBR9999
.
.         OBR.38 Reason for Study (CE)
.
ROBR3800  BRANCH    COMPCNT,ROBR3801:            * identifier (ST)
                            ROBR3802:            * text (ST)
                            ROBR3803:            * name of coding system (ST)
                            ROBR3804:            * alternate identifier (ST)
                            ROBR3805:            * alternate text (ST)
                            ROBR3806             * name of alt. cod. system (ST)
          GOTO      ROBR9999
.
ROBR3801  RESET     OBR03801                     * load identifier (ST)
          GOTO      ROBR9999
.
ROBR3802  RESET     OBR03802                     * load text (ST)
          GOTO      ROBR9999
.
ROBR3803  RESET     OBR03803                     * load name of cod. system (ST)
          GOTO      ROBR9999
.
ROBR3804  RESET     OBR03804                     * load alt. identifier (ST)
          GOTO      ROBR9999
.
ROBR3805  RESET     OBR03805                     * load alternate text (ST)
          GOTO      ROBR9999
.
ROBR3806  RESET     OBR03806                     * load alt. cod. sys. name (ST)
          GOTO      ROBR9999
.
.         OBR.39 Collector's Comment (CE)
.
ROBR3900  BRANCH    COMPCNT,ROBR3901:            * identifier (ST)
                            ROBR3902:            * text (ST)
                            ROBR3903:            * name of coding system (ST)
                            ROBR3904:            * alternate identifier (ST)
                            ROBR3905:            * alternate text (ST)
                            ROBR3906             * name of alt. cod. system (ST)
          GOTO      ROBR9999
.
ROBR3901  RESET     OBR03901                     * load identifier (ST)
          GOTO      ROBR9999
.
ROBR3902  RESET     OBR03902                     * load text (ST)
          GOTO      ROBR9999
.
ROBR3903  RESET     OBR03903                     * load name of cod. system (ST)
          GOTO      ROBR9999
.
ROBR3904  RESET     OBR03904                     * load alt. identifier (ST)
          GOTO      ROBR9999
.
ROBR3905  RESET     OBR03905                     * load alternate text (ST)
          GOTO      ROBR9999
.
ROBR3906  RESET     OBR03906                     * load alt. cod. sys. name (ST)
          GOTO      ROBR9999
.
.         OBR.40 Transport Arrangement Responsibility (CE)
.
ROBR4000  BRANCH    COMPCNT,ROBR4001:            * identifier (ST)
                            ROBR4002:            * text (ST)
                            ROBR4003:            * name of coding system (ST)
                            ROBR4004:            * alternate identifier (ST)
                            ROBR4005:            * alternate text (ST)
                            ROBR4006             * name of alt. cod. system (ST)
          GOTO      ROBR9999
.
ROBR4001  RESET     OBR04001                     * load identifier (ST)
          GOTO      ROBR9999
.
ROBR4002  RESET     OBR04002                     * load text (ST)
          GOTO      ROBR9999
.
ROBR4003  RESET     OBR04003                     * load name of cod. system (ST)
          GOTO      ROBR9999
.
ROBR4004  RESET     OBR04004                     * load alt. identifier (ST)
          GOTO      ROBR9999
.
ROBR4005  RESET     OBR04005                     * load alternate text (ST)
          GOTO      ROBR9999
.
ROBR4006  RESET     OBR04006                     * load alt. cod. sys. name (ST)
          GOTO      ROBR9999
.
.         OBR.41  Transport Arranged (ID)
.
ROBR4100  BRANCH    COMPCNT,ROBR4101
          GOTO      ROBR9999
.
ROBR4101  RESET     OBR04101
          GOTO      ROBR9999
.
.         OBR.42  Escort Required (ID)
.
ROBR4200  BRANCH    COMPCNT,ROBR4201
          GOTO      ROBR9999
.
ROBR4201  RESET     OBR04201
          GOTO      ROBR9999
.
.         OBR.43 Planned Patient Transport Comment (CE)
.
ROBR4300  BRANCH    COMPCNT,ROBR4301:            * identifier (ST)
                            ROBR4302:            * text (ST)
                            ROBR4303:            * name of coding system (ST)
                            ROBR4304:            * alternate identifier (ST)
                            ROBR4305:            * alternate text (ST)
                            ROBR4306             * name of alt. cod. system (ST)
          GOTO      ROBR9999
.
ROBR4301  RESET     OBR04301                     * load identifier (ST)
          GOTO      ROBR9999
.
ROBR4302  RESET     OBR04302                     * load text (ST)
          GOTO      ROBR9999
.
ROBR4303  RESET     OBR04303                     * load name of cod. system (ST)
          GOTO      ROBR9999
.
ROBR4304  RESET     OBR04304                     * load alt. identifier (ST)
          GOTO      ROBR9999
.
ROBR4305  RESET     OBR04305                     * load alternate text (ST)
          GOTO      ROBR9999
.
ROBR4306  RESET     OBR04306                     * load alt. cod. sys. name (ST)
          GOTO      ROBR9999
.
.         OBR.44 Procedure Code (CE)
.
ROBR4400  BRANCH    COMPCNT,ROBR4401:            * identifier (ST)
                            ROBR4402:            * text (ST)
                            ROBR4403:            * name of coding system (ST)
                            ROBR4404:            * alternate identifier (ST)
                            ROBR4405:            * alternate text (ST)
                            ROBR4406             * name of alt. cod. system (ST)
          GOTO      ROBR9999
.
ROBR4401  RESET     OBR04401                     * load identifier (ST)
          GOTO      ROBR9999
.
ROBR4402  RESET     OBR04402                     * load text (ST)
          GOTO      ROBR9999
.
ROBR4403  RESET     OBR04403                     * load name of cod. system (ST)
          GOTO      ROBR9999
.
ROBR4404  RESET     OBR04404                     * load alt. identifier (ST)
          GOTO      ROBR9999
.
ROBR4405  RESET     OBR04405                     * load alternate text (ST)
          GOTO      ROBR9999
.
ROBR4406  RESET     OBR04406                     * load alt. cod. sys. name (ST)
          GOTO      ROBR9999
.
.         OBR.45 Procedure Code Modifier (CE)
.
ROBR4500  BRANCH    COMPCNT,ROBR4501:            * identifier (ST)
                            ROBR4502:            * text (ST)
                            ROBR4503:            * name of coding system (ST)
                            ROBR4504:            * alternate identifier (ST)
                            ROBR4505:            * alternate text (ST)
                            ROBR4506             * name of alt. cod. system (ST)
          GOTO      ROBR9999
.
ROBR4501  RESET     OBR04501                     * load identifier (ST)
          GOTO      ROBR9999
.
ROBR4502  RESET     OBR04502                     * load text (ST)
          GOTO      ROBR9999
.
ROBR4503  RESET     OBR04503                     * load name of cod. system (ST)
          GOTO      ROBR9999
.
ROBR4504  RESET     OBR04504                     * load alt. identifier (ST)
          GOTO      ROBR9999
.
ROBR4505  RESET     OBR04505                     * load alternate text (ST)
          GOTO      ROBR9999
.
ROBR4506  RESET     OBR04506                     * load alt. cod. sys. name (ST)
          GOTO      ROBR9999
.
ROBR9999  RETURN
+
.*****************************************************************************
.*                            VMSH0000             Called by: PROC0000       *
.*      Validate that the mandatory MSH fields are populated or null.        *
.*****************************************************************************
.
.         Encoding Characters
.
VMSH0000  MOVELPTR  MSH00201,FORM3               * field populated ?
          COMPARE   FOUR,FORM3                   * all encoding chars present ?
          GOTO      VMSH2000 IF NOT LESS         * yes
.
          MOVE      "MSH.2: Encoding characters incomplete",ERRORDSC
          MOVE      "101",ERRORNUM
          CALL      EROR0000
.
.         Message Type - Component 1
.
VMSH2000  STRIP     MSH00901
          MOVELPTR  MSH00901,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "MSH.9: Message Type not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
          ENDIF
.
.         Message Type - Component 2
.
          STRIP     MSH00902
          MOVELPTR  MSH00902,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "MSH.9: Trigger Event not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VMSH5000
          ENDIF
          MOVE      MSH00902,MESSTYPE
.
          CALL      VTYP0000                     * valid message type ?
.
.         Message Control ID
.
VMSH5000  STRIP     MSH01001
          MOVELPTR  MSH01001,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "MSH.10: Message Control ID not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
          ENDIF
.
.         Processing Id
.
VMSH6000  STRIP     MSH01101
          MOVELPTR  MSH01101,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "MSH.11: Processing ID not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VMSH7000
          ENDIF
.
          MATCH     ANSP,MSH01101                * Production ?
          GOTO      VMSH7000 IF EQUAL            * yes - ok
.
          MATCH     ANSD,MSH01101                * Debugging ?
          GOTO      VMSH7000 IF EQUAL            * yes - ok
.
          MATCH     ANST,MSH01101                * Training ?
          GOTO      VMSH7000 IF EQUAL            * yes - ok
.
          MOVE      "MSH.11: Processing ID not valid",ERRORDSC
          MOVE      "202",ERRORNUM
          CALL      EROR0000
.
.         Version Id
.
VMSH7000  STRIP     MSH01201
          MOVELPTR  MSH01201,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "MSH.12: Version ID not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VMSH9999
          ENDIF
.
VMSH7100  IF        FORM3 <> 5
            MOVE      "MSH.12: Version ID incorrect length",ERRORDSC
            MOVE      "203",ERRORNUM
            CALL      EROR0000
            GOTO      VMSH9999
          ENDIF
.
          MATCH     "2.3.1",MSH01201
          GOTO      VMSH9999 IF EQUAL
.
VMSH7200  MOVE      "MSH.12: Version ID not valid",ERRORDSC
          MOVE      "203",ERRORNUM
          CALL      EROR0000
.
VMSH9999  RETURN
+
.*****************************************************************************
.*                            VPID0000             Called by: PROC0000       *
.*      Validate that the mandatory PID fields are populated or null.        *
.*****************************************************************************
.
VPID0000  MOVE      ONE,URNFOUND                 * initialise as U/R not found
.
          MOVE      ONE,COUNTER                  * initialise counter
          WHILE     COUNTER < 6
.
.           Patient ID (Internal ID) - Component 1 (Identifier)
.
            SQUEEZE   PID00301[COUNTER]          * remove spaces
            MOVELPTR  PID00301[COUNTER],FORM3    * field populated ?
            IF        FORM3 = 0
              GOTO      VPID0900                 * no - get next identifier
            ENDIF
.
.           The identifier is populated, so check if we have
.           an identifier type
.
            STRIP     PID00305[COUNTER]          * remove trailing blanks
            MOVELPTR  PID00305[COUNTER],FORM3    * field populated ?
            IF        FORM3 = 0
              GOTO      VPID0110                 * no
            ENDIF
.
            MATCH     BLANKSTR,PID00305[COUNTER] * null field ?
            GOTO      VPID0200 IF NOT EQUAL      * no
.           
VPID0110    MOVE      "PID.3: Patient Internal Identifier type not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VPID0900
.
.           There is an identifier type, so check what sort it is
.
VPID0200    MATCH     "MR",PID00305[COUNTER]     * U/R number ?
            GOTO      VPID0300 IF EQUAL          * yes - validate
.
            MATCH     "DV",PID00305[COUNTER]     * DVA number ?
            GOTO      VPID0270 IF EQUAL          * yes - validate
.
            MATCH     "MC",PID00305[COUNTER]     * Medicare number ?
            GOTO      VPID0270 IF EQUAL          * yes - validate
.
            MATCH     "PEN",PID00305[COUNTER]    * Pension number ?
            GOTO      VPID0270 IF EQUAL          * yes - validate
.
            MATCH     "SN",PID00305[COUNTER]     * Safety Net number ?
            GOTO      VPID0270 IF EQUAL          * yes - validate
.           
            MOVE      "PID.3: Patient Identifier type not valid",ERRORDSC
            MOVE      "103",ERRORNUM
            CALL      EROR0000
            GOTO      VPID0900
.
VPID0270    MATCH     BLANKSTR,PID00301[COUNTER] * null field ?
            IF        @EQUAL
              MOVE      "PID.3: Identifier is mandatory",ERRORDSC
              MOVE      "101",ERRORNUM
              CALL      EROR0000
            ENDIF
            GOTO      VPID0900
.
.           We have a U/R number, so validate it
.
VPID0300    MATCH     BLANKSTR,PID00301[COUNTER] * null field ?
            IF        @EQUAL
              MOVE      "PID.3: Patient UR is mandatory",ERRORDSC
              MOVE      "101",ERRORNUM
              CALL      EROR0000
              GOTO      VPID0900
            ENDIF
.
.           If we are sending the U/R check digit in PID.3 for broadcast
.           messages, and if the U/R is 9 characters long, then strip off the
.           last character to get the U/R (for Singapore Number)
.
            MOVELPTR  PID00301[COUNTER],FORM3
            IF        FORM3 = 9
              MATCH     "1",PTCNCKDG
              GOTO      VPID0400 IF EQUAL
            ENDIF
.
            IF        FORM3 > 0 & FORM3 < 9
              GOTO      VPID0400
            ENDIF
.
            MOVE      "PID.3: Patient Internal ID format not valid",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VPID9999
.
.           Right justify the U/R then validate that the patient exists on file
.
VPID0400    CALL      CLPATMAS                   * clear PMI fields
            CALL      CLPMSPX2
            MOVE      PID00301[COUNTER],KEY8
            RJUSTIFY  KEY8
            MOVE      KEY8,PURNO
            CALL      RDMAST1                    * is patient on file ?
            IF        OVRCD = 1 & MESSGNUM = 1
              MOVE      "PID.3: Patient Internal ID not on file",ERRORDSC
              MOVE      "204",ERRORNUM
              CALL      EROR0000
              GOTO      VPID9999
            ENDIF
.
            MOVE      PURNO,KEY8
            CALL      RDPMPX21                 * is patient on file ?
            IF        OVRCD = 1
              MOVE      "PID.3: Patient pmspx2af record not on file",ERRORDSC
              MOVE      "207",ERRORNUM
              CALL      EROR0000
              GOTO      VPID9999
            ENDIF
            MOVE      ZERO,URNFOUND
.
VPID0900    ADD       ONE,COUNTER                * increment counter
          DO
.
VPID1000  IF        URNFOUND = 1
            MOVE      "PID.3: Patient U/R not sent",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
          ENDIF
.
.         Patient Name - Component 1 (Surname)
.
VPID2000  STRIP     PID00501
          MOVELPTR  PID00501,FORM3               * field populated ?
          IF        FORM3 = 0
            GOTO      VPID2500                   * no - error
          ENDIF
.           
          MATCH     BLANKSTR,PID00501            * null field ?
          GOTO      VPID2500 IF EQUAL            * yes
.
.         Check if the surname has changed
.
          PACK      KEY40,PID00501,SP30
          MATCH     KEY40,PTMASNAM               * same surname ?
          IF        !@EQUAL
            MOVE       "PID.5: Patient Surname doesnt match",ERRORDSC
            MOVE       "207",ERRORNUM
            CALL       EROR0000
          ENDIF
          GOTO      VPID3000
.
VPID2500  MOVE      "PID.5: Patient Surname not populated",ERRORDSC
          MOVE      "101",ERRORNUM
          CALL      EROR0000
.
.         Patient Name - Component 2 (First Given Name)
.
VPID3000  STRIP     PID00502
          MOVELPTR  PID00502,FORM3               * field populated ?
          IF        FORM3 = 0
            GOTO      VPID3500                   * no - error
          ENDIF
.           
          MATCH     BLANKSTR,PID00502            * null field ?
          GOTO      VPID3500 IF EQUAL            * yes
.
          MOVE      PID00502,ANS
          MATCH     ANS,PMPXFNAM                 * same initial ?
          IF        !@EQUAL
            MOVE      "PID.5: Patient Initial doesnt match",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
          ENDIF
          GOTO      VPID5000
.
VPID3500  MOVE      "PID.5: Patient First Given Name not populated",ERRORDSC
          MOVE      "101",ERRORNUM
          CALL      EROR0000
.
.         Patient Date of Birth - Component 1
.
VPID5000  STRIP     PID00701
          MOVELPTR  PID00701,FORM3               * field populated ?
          IF        FORM3 = 0
            GOTO      VPID5500                   * no - error
          ENDIF
.           
          MATCH     BLANKSTR,PID00701            * null field ?
          GOTO      VPID5500 IF EQUAL            * yes
.
          MOVE      PID00701,DIM14
          MOVE      "PID.7",FIELDID
          MOVE      ONE,DATFLAG1
          MOVE      ZERO,DATFLAG2
          CALL      VDTM0000                     * date/time validation
.
VPID5400  MATCH     PBDATE,PID00701              * same dob ?
          IF        !@EQUAL
            MOVE      "PID.7: Patient Date of Birth doesnt match",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
          ENDIF
          GOTO      VPID6000
.
VPID5500  MOVE      "PID.7: Patient Date of Birth not populated",ERRORDSC
          MOVE      "101",ERRORNUM
          CALL      EROR0000
.
.         Patient Gender - Component 1
.
VPID6000  STRIP     PID00801
          MOVELPTR  PID00801,FORM3               * field populated ?
          IF        FORM3 = 0
            GOTO      VPID6900                   * no - error
          ENDIF
.           
          MATCH     BLANKSTR,PID00801            * null field ?
          GOTO      VPID6900 IF EQUAL            * yes
.
          MOVE      PID00801,ANS
          REP       "OI",ANS                     * O not valid in webPAS
          CALL      GENDR000                     * validate against Cat.G
          BRANCH    EXIT,VPID6800
.
.         For an O01 message, check the gender matches
.
          PACK      KEY5,ANSG,SP1,SPSEX,SP70
          CALL      RDCODE1                      * code on file ?
          BRANCH    OVRCD,VPID6500               * no
.
          MATCH     ANS,THCSCOD                  * matches current HDP default?
          GOTO      VPID9999 IF EQUAL            * yes
.
.         The code below has been put in place as there is a discrepancy
.         between what gets broadcast and what is valid for the receiver
.         in terms of gender.  Once the two are aligned at some point in
.         the future, this code can be fixed.  At the moment it only affects
.         a value of O coming in which may equate to an I or an R in webPAS.
.
          MATCH     ANSI,ANS
          GOTO      VPID6500 IF NOT EQUAL
.
          MATCH     ANSR,THCSCOD
          GOTO      VPID9999 IF EQUAL
.
VPID6500  MOVE      "PID.8: Patient Gender doesnt match",ERRORDSC
          MOVE      "207",ERRORNUM
          CALL      EROR0000
          GOTO      VPID9999
.
VPID6800  MOVE      "PID.8: Patient Gender not valid",ERRORDSC
          MOVE      "103",ERRORNUM
          CALL      EROR0000
          GOTO      VPID9999
.
VPID6900  MOVE      "PID.8: Patient Gender not populated",ERRORDSC
          MOVE      "101",ERRORNUM
          CALL      EROR0000
          GOTO      VPID9999
.
VPID9999  RETURN
+
.*****************************************************************************
.*                            VPV10000             Called by: PROC0000       *
.*      Validate that the mandatory PV1 fields are populated or null.        *
.* Returns: SAVHFUND - saved health fund from visit details                  *
.*          SAVHTBLE - saved health fund table from visit details            *
.*          SAVCLAIM - saved claim code from visit details                   *
.*****************************************************************************
.
.         Patient Class (PV1.2)
.
VPV10000  STRIP     PV100201
          MOVELPTR  PV100201,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "PV1.2: Patient Class not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VPV11000
          ENDIF
.
          MATCH     BLANKSTR,PV100201            * field blank ?
          IF        @EQUAL
            MOVE      "PV1.2: Patient Class is mandatory",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VPV11000
          ENDIF
.
          IF        FORM3 > 1
            MOVE      "PV1.2: Patient Class has too many characters",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VPV11000
          ENDIF
.
          MATCH     ANSI,PV100201                * Inpatient ?
          IF        !@EQUAL
            MOVE      "PV1.2: Patient Class not valid",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VPV11000
          ENDIF
.
.         Visit Number (PV1.19)
.
VPV11000  STRIP     PV101901
          MOVELPTR  PV101901,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "PV1.19: Visit Number not populated",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VPV19999
          ENDIF
.
          MATCH     BLANKSTR,PV101901            * field blank ?
          IF        @EQUAL
            MOVE      "PV1.19: Visit Number is mandatory",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VPV19999
          ENDIF
.
          IF        FORM3 > 8
            MOVE      "PV1.19: Visit Number has too many digits",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VPV19999
          ENDIF
.
          TYPE      PV101901
          IF        !@EQUAL
            MOVE      "PV1.19: Visit Number not numeric",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VPV19999
          ENDIF
.
          MOVE      PV101901,SAVVISIT            * save the visit number
          RJUSTIFY  SAVVISIT
.
          MOVE      SAVVISIT,KEY8
          RJUSTIFY  KEY8
          CALL      RDVISA1
          IF        OVRCD = 1
            MOVE      "PV1.19: No patvisaf record for visit number",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VPV19999
          ENDIF
.
          MOVE      SAVVISIT,KEY8
          RJUSTIFY  KEY8
          CALL      RDMISS1
          IF        OVRCD = 1
            MOVE      "PV1.19: No patmi1af record for visit number",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VPV19999
          ENDIF
.
          MATCH     AURNO,PURNO
          IF        !@EQUAL
            MOVE      "PV1.19: U/R for visit doesnt match patient UR",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VPV19999
          ENDIF
.
VPV19999  RETURN
+
.*****************************************************************************
.*                                 VORC0000        Called by: PROC0000       *
.*                          Validate the ORC fields                          *
.*****************************************************************************
.
.         Order Control (ORC.1)
.
VORC0000  STRIP     ORC00101
          MOVELPTR  ORC00101,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "ORC.1: Order Control not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VORC9999                   * no
          ENDIF
.
          MATCH     BLANKSTR,ORC00101            * null field ?
          IF        @EQUAL
            MOVE      "ORC.1: Order Control is mandatory",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VORC9999                   * no - finished
          ENDIF
.
          MATCH     "RE",ORC00101                * valid value ?
          IF        !@EQUAL
            MOVE      "ORC.1: Order Control is not valid for this message",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VORC9999                   * no - finished
          ENDIF
.
VORC9999  RETURN
+
.*****************************************************************************
.*                                 VRXD0000        Called by: PROC0000       *
.*                          Validate the RXD fields                          *
.*****************************************************************************
.
.         First, check if this is a "delete segment" where all fields are
.         null (..|""|...).
.
VRXD0000  MATCH     BLANKSTR,RXD00101            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD00201            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD00301            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD00401            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD00501            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD00601            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD00701            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD00801            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD00901            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD01001            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD01101            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD01201            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD01301            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD01401            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD01501            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD01601            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD01701            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD01801            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD01901            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD02001            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD02101            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD02201            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD02301            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
          MATCH     BLANKSTR,RXD02401            * null field ?
          GOTO      VRXD0005 IF NOT EQUAL        * no - proceed with validation
.
.         This is a delete segment, so make sure it's the first RXD segment
.
          COMPARE   ZERO,RXDCOUNT                * first RXD segment ?
          IF        @EQUAL
            ADD       ONE,RXDCOUNT               * increment RXD segment count
            GOTO      VRXD9999                   * yes - finished validation
          ENDIF
.
          MOVE      "RXD: Delete RXD segment out of sequence",ERRORDSC
          MOVE      "100",ERRORNUM
          CALL      EROR0000
          GOTO      VRXD9999
.
.         We have an RXD segment which contains data, so check that it's not
.         the first RXD segment (which should be a delete segment).
.
VRXD0005  ADD       ONE,RXDCOUNT                 * increment RXD segment count
          COMPARE   ONE,RXDCOUNT
          IF        @EQUAL
            MOVE      "RXD: RXD delete segment missing",ERRORDSC
            MOVE      "100",ERRORNUM
            CALL      EROR0000
          ENDIF
.
.         Dispense Sub-ID Counter (RXD.1)
.
          STRIP     RXD00101
          MOVELPTR  RXD00101,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "RXD.1: Dispense Counter not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD0500                   * no
          ENDIF
.
          MATCH     BLANKSTR,RXD00101            * null field ?
          iF        @EQUAL
            MOVE      "RXD.1: Dispense Counter is mandatory",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD0500                   * no - finished
          ENDIF
.
          TYPE      RXD00101                     * numeric ?
          IF        !@EQUAL
            MOVE      "RXD.1: Dispense Counter not numeric",ERRORDSC
            MOVE      "102",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD0500                   * no - finished
          ENDIF
.
.         Dispense/Give Code (RXD.2) - Component 1
.
VRXD0500  STRIP     RXD00201
          MOVELPTR  RXD00201,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "RXD.2: Dispense Code not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD1000                   * no
          ENDIF
.
          MATCH     BLANKSTR,RXD00201            * null field ?
          IF        @EQUAL
            MOVE      "RXD.2: Dispense Code is mandatory",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD1000                   * no - finished
          ENDIF
.
.         Component 1 is populated, so make sure that component 3 is also
.         populated (HL7 requirement)
.
VRXD1000  STRIP     RXD00203
          MOVELPTR  RXD00203,FORM3
          COMPARE   ZERO,FORM3                   * field populated ?
          IF        @EQUAL
            MOVE      "RXD.2: Dispense coding system not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD1100                   * no - finished
          ENDIF
.
          MATCH     BLANKSTR,RXD00203            * null field ?
          IF        @EQUAL
            MOVE      "RXD.2: Dispense coding system is mandatory",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD1100                   * no - finished
          ENDIF
.
.         Make sure that component 2 is also populated (webPAS requirement)
.
VRXD1100  STRIP     RXD00202
          MOVELPTR  RXD00202,FORM3
          COMPARE   ZERO,FORM3                   * field populated ?
          IF        @EQUAL
            MOVE      "RXD.2: Dispense code description not populated",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD1500                   * no - finished
          ENDIF
.
          MATCH     BLANKSTR,RXD00202            * null field ?
          IF        @EQUAL
            MOVE      "RXD.2: Dispense code description is mandatory",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD1500                   * no - finished
          ENDIF
.
          IF        FORM3 > 70
            MOVE      "RXD.2: Dispense description too long",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD1500
          ENDIF
.
.         Date/Time Dispensed (RXD.3)
.
VRXD1500  STRIP     RXD00301
          MOVELPTR  RXD00301,FORM3
          COMPARE   ZERO,FORM3                   * field populated ?
          IF        @EQUAL
            MOVE      "RXD.3: Date dispensed not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD1600                   * no - finished
          ENDIF
.
          MATCH     BLANKSTR,RXD00301
          IF        @EQUAL
            MOVE      "RXD.3: Date dispensed is mandatory",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD1600                   * no - finished
          ENDIF
.
          MOVE      RXD00301,DIM14
          MOVE      "RXD.3",FIELDID
          MOVE      ONE,DATFLAG1
          MOVE      ZERO,DATFLAG2
          CALL      VDTM0000                     * date/time validation
.
.         Actual Dispense Amount (RXD.4)
.
VRXD1600  STRIP     RXD00401
          MOVELPTR  RXD00401,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "RXD.4: Dispense Amount not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD2000                   * no
          ENDIF
.
          MATCH     BLANKSTR,RXD00401            * null field ?
          IF        @EQUAL
            MOVE      "RXD.4: Dispense Amount is mandatory",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD2000                   * no - finished
          ENDIF
.
          TYPE      RXD00401                     * numeric ?
          IF        !@EQUAL
            MOVE      "RXD.4: Dispense Amount not numeric",ERRORDSC
            MOVE      "102",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD2000                   * no - finished
          ENDIF
.
.         Prescription Number (RXD.7)
.
VRXD2000  STRIP     RXD00701
          MOVELPTR  RXD00701,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "RXD.7: Prescription Number not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD2500                   * no
          ENDIF
.
          MATCH     BLANKSTR,RXD00701            * null field ?
          IF        @EQUAL
            MOVE      "RXD.7: Prescription Number is mandatory",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD2500                   * no - finished
          ENDIF
.
.         Dispense Notes (RXD.9)
.
VRXD2500  STRIP     RXD00901
          MOVELPTR  RXD00901,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "RXD.9: Dispense Notes not populated",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD2700                   * no
          ENDIF
.
          MATCH     BLANKSTR,RXD00901            * null field ?
          IF        @EQUAL
            MOVE      "RXD.9: Dispense Notes is mandatory",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD2700                   * no - finished
          ENDIF
.
.         Substance Lot Number (RXD.18)
.
VRXD2700  STRIP     RXD01801
          MOVELPTR  RXD01801,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "RXD.18: Substance Lot Number not populated",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD3000                   * no
          ENDIF
.
          MATCH     BLANKSTR,RXD01801            * null field ?
          IF        @EQUAL
            MOVE      "RXD.18: Substance Lot Number is mandatory",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD3000                   * no - finished
          ENDIF
.
          IF        FORM3 > 40
            MOVE      "RXD.18: Substance lot number too long",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD3000
          ENDIF
.
.         Substance Manufacturer Name (RXD.20) - Component 1
.
VRXD3000  STRIP     RXD02001
          MOVELPTR  RXD02001,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "RXD.20: Manufacturer Name not populated",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD3500                   * no
          ENDIF
.
          MATCH     BLANKSTR,RXD02001            * null field ?
          IF        @EQUAL
            MOVE      "RXD.20: Manufacturer Name is mandatory",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD3500                   * no - finished
          ENDIF
.
.         Component 1 is populated, so make sure that component 3 is also
.         populated (HL7 requirement)
.
VRXD3500  STRIP     RXD02003
          MOVELPTR  RXD02003,FORM3
          COMPARE   ZERO,FORM3                   * field populated ?
          IF        @EQUAL
            MOVE      "RXD.20: Manufacturer Name coding system not populated",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD3600                   * no - finished
          ENDIF
.
          MATCH     BLANKSTR,RXD02003            * null field ?
          IF        @EQUAL
            MOVE      "RXD.20: Manufacturer Name coding system is mandatory",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD3600                   * no - finished
          ENDIF
.
.         Make sure that component 2 is also populated (webPAS requirement)
.
VRXD3600  STRIP     RXD02002
          MOVELPTR  RXD02002,FORM3
          COMPARE   ZERO,FORM3                   * field populated ?
          IF        @EQUAL
            MOVE      "RXD.20: Manufacturer description not populated",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD9999                   * no - finished
          ENDIF
.
          MATCH     BLANKSTR,RXD02002            * null field ?
          IF        @EQUAL
            MOVE      "RXD.20: Manufacturer description is mandatory",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD9999                   * no - finished
          ENDIF
.
          IF        FORM3 > 40
            MOVE      "RXD.20: Manufacturer description too long",ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VRXD9999
          ENDIF
.
VRXD9999  RETURN
+
.*****************************************************************************
.*                                 VRXR0000        Called by: PROC0000       *
.*                          Validate the RXR fields                          *
.*****************************************************************************
.
.         Route (RXR.1) - Component 1
.
VRXR0000  STRIP     RXR00101
          MOVELPTR  RXR00101,FORM3               * field populated ?
          IF        FORM3 = 0
            MOVE      "RXR.1: Route not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXR1500                   * no
          ENDIF
.
          MATCH     BLANKSTR,RXR00101            * null field ?
          IF        @EQUAL
            MOVE      "RXR.1: Route is mandatory",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXR1500                   * no - finished
          ENDIF
.
.         Make sure that component 3 is also populated (HL7 requirement)
.
VRXR1500  STRIP     RXR00103
          MOVELPTR  RXR00103,FORM3
          COMPARE   ZERO,FORM3                   * field populated ?
          IF        @EQUAL
            MOVE      "RXR.1: Route coding system not populated",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXR9999                   * no - finished
          ENDIF
.
          MATCH     BLANKSTR,RXR00103            * null field ?
          IF        @EQUAL
            MOVE      "RXR.1: Route coding system is mandatory",ERRORDSC
            MOVE      "101",ERRORNUM
            CALL      EROR0000
            GOTO      VRXR9999                   * no - finished
          ENDIF
.
.         This is the last segment for a set of repeating segments for the
.         individual drug records (ORC, RXD & RXR), so write a record to the
.         temp file for this medication
.
          CALL      WMED0000
.
VRXR9999  RETURN
+
.*****************************************************************************
.*                               WMED0000          Called by: VRXR0000       *
.*               Write a record to the temp file for this medication         *
.*****************************************************************************
.
WMED0000  ADD       ONE,TEMPUNIQ
.
          PACK      TEMPDRUG,RXD00202,SP70
          PACK      TEMPSCDT,RXD00301,SP70
          PACK      TEMPINST,RXD00901,SP70,SP70,SP70
          PACK      TEMPDOSE,RXD01801,SP70
          PACK      TEMPDRBR,RXD02002,SP70
.
          CALL      WRTEMP1
.
WMED9999  RETURN
+
.*****************************************************************************
.*                       VTYP0000                  Called by: VMSH0000       *
.*    Check if the message type (from MSH009) is one we are able to process  *
.* Requires:  MESSTYPE - 3 character message type (eg A28)                   *
.*****************************************************************************
.
VTYP0000  MOVE      ZERO,COUNTER                 * initialise counter
          MOVE      ZERO,MESSGNUM                * initialse message no.
          WHILE     COUNTER < 1
            ADD       ONE,COUNTER                * increment counter
            MATCH     MESSTYPE,MTYPARRY[COUNTER]
            IF        @EQUAL
              MOVE      COUNTER,MESSGNUM
.
              CALL      URST0000                 * update received stats
              GOTO      VTYP9999
            ENDIF
          DO
.
          MOVE      "MSH.9: Message Type not available",ERRORDSC
          MOVE      "200",ERRORNUM
          CALL      EROR0000
.
VTYP9999  RETURN
+
.*****************************************************************************
.*                                  GSEG0000       Called by: PROC0000       *
.*                        Get the next segment code                          *
.* This routine is called when we are expecting the next segment.  It will   *
.* get the next 3 characters in the message and use this as the segment id.  *
.*                                                                           *
.* Returns: EXIT   0 = segment id read                                       *
.*                 1 = connection timed out                                  *
.*                 2 = connection lost                                       *
.*                 3 = start of block found                                  *
.*                 4 = end of block found                                    *
.*                 5 = end of segment found (CR)                             *
.*                 6 = first segment is not MSH                              *
.*          SEGMENT = 3 character HL7 segment id (eg MSH)                    *
.*****************************************************************************
.
GSEG0000  CLEAR     SEGMENT
          MOVE      ZERO,COUNTER                 * initialise character counter
          WHILE     COUNTER < 3
            BUMP      TMPSTRNG                   * move to next character
            IF        @EOS
              CALL      GTSTR000                 * get next 4000 chars (or less)
              BRANCH    EXIT,GSEG9100:           * timeout
                             GSEG9200            * connection lost
            ENDIF
            MOVE      TMPSTRNG,ANS               * save character
.
            MATCH     CRETURN,ANS                * carriage return found ?
            GOTO      GSEG9500 IF EQUAL          * yes
.
            MATCH     ENDBLOCK,ANS               * end of block found ?
            IF        @EQUAL
              APPEND    ENDBLOCK,RECVMESS        * yes
              APPEND    CRETURN,RECVMESS
              GOTO      GSEG9400
            ENDIF
.
            MATCH     STRTBLOK,ANS               * start of block found ?
            GOTO      GSEG9300 IF EQUAL          * yes
.
            APPEND    ANS,SEGMENT                * load segment id
            ADD       ONE,COUNTER                * increment counter
          DO
.
          RESET     SEGMENT
          APPEND    SEGMENT,RECVMESS             * add seg. to full message
.
.         If this is the first segment, check to make sure it's an
.         MSH segment
.
          COMPARE   ZERO,SEGCOUNT
          GOTO      GSEG9000 IF NOT EQUAL
.
          MATCH     MSHSEGMT,SEGMENT
          IF        @EQUAL
            MOVE      MSHSEGMT,SAVSEGMT          * save first segment
            GOTO      GSEG9000
          ENDIF
.
          IF        DISPFLAG = 1
            DISPLAY   "MSH segment missing",*R,*N;
          ENDIF
          WRITE     TEXTFILE,SEQ;MSHMCAPT
          GOTO      GSEG9600
.
GSEG9000  MOVE      ZERO,EXIT
          GOTO      GSEG9999
.
GSEG9100  MOVE      ONE,EXIT
          GOTO      GSEG9999
.
GSEG9200  MOVE      TWO,EXIT
          GOTO      GSEG9999
.
GSEG9300  MOVE      THREE,EXIT
          GOTO      GSEG9999
.
GSEG9400  MOVE      FOUR,EXIT
          GOTO      GSEG9999
.
GSEG9500  MOVE      FIVE,EXIT
          GOTO      GSEG9999
.
GSEG9600  MOVE      SIX,EXIT
.
GSEG9999  RETURN
+
.*****************************************************************************
.*                          GCHR0000               Called by: PROC0000       *
.*                 Get the next character in the message string              *
.* Returns:  EXIT  0 = ok to continue                                        *
.*                 1 = connection timeout                                    *
.*                 2 = connection lost                                       *
.*                 3 = start of block                                        *
.*                 4 = end of block                                          *
.*                 5 = end of segment (CR)                                   *
.*                 6 = field separator blank (MSH00101 only)                 *
.*                 7 = encoding character(s) missing (MSH00201 only)         *
.*           ANS  - character just read in                                   *
.*****************************************************************************
.
GCHR0000  BUMP      TMPSTRNG                     * move to next field
          IF        @EOS
            CALL      GTSTR000                   * get next 4000 chars (or less)
            BRANCH    EXIT,GCHR9100:             * timeout
                           GCHR9200              * connection lost
          ENDIF
.
          MOVE      TMPSTRNG,ANS                 * save character
.
.         If this is the first field of the MSH segment, then we need to
.         load the field separator.
.
          MATCH     MSHSEGMT,SEGMENT             * MSH segment & first field?
          IF        @EQUAL
            IF        FIELDNO = 0
              MATCH     SP1,ANS                  * yes - blank separator ?
              GOTO      GCHR9600 IF EQUAL        * yes - error
.
              ADD       ONE,FIELDNO              * increment seg. field number
              MOVE      ANS,MSH00101             * no - load field separator
              MOVE      ZERO,COMPFLAG            * set for no component flag
              MOVE      SP1,PREVCHAR             * initialise previous character
            ENDIF
          ENDIF
.
.         Check if this is a field separator and if so, save to the full
.         message buffer (for message display later), increment the segment
.         field number, initialse the component count, then get the next
.         character.
.
          MATCH     MSH00101,ANS                 * field separator found ?
          IF        @EQUAL
            MATCH     PREVCHAR,ANS               * yes
            IF        !@EQUAL
              MATCH     PREVCHAR,COMSEPAR        * yes
              IF        !@EQUAL
                CALL      RFLD0000               * reset component just loaded
              ENDIF
            ENDIF
            ADD       ONE,FIELDNO                * increment seg. field number
            MOVE      ONE,COMPCNT                * init. field component count
            MOVE      ONE,REPTNCNT               * init. field repetition count
            APPEND    ANS,RECVMESS               * add to full message buffer
            MOVE      ANS,PREVCHAR
            GOTO      GCHR0000                   * get next field
          ENDIF
.
.         Check that the encoding characters have been sent in MSH.2 if we
.         have just started processing MSH.3 (component 1)
.
          MATCH     MSHSEGMT,SEGMENT
          IF        @EQUAL
            IF        FIELDNO = 3 & COMPCNT = 1 & COMPFLAG = 0
              RESET     MSH00201
              MOVELPTR  MSH00201,FORM3
              IF        FORM3 <> 4
                GOTO      GCHR9700
               ELSE
                UNPACK    MSH00201,COMSEPAR,REPSEPAR,ESCSEPAR,SUBSEPAR
                MOVE      ONE,COMPFLAG           * set component flag
              ENDIF
            ENDIF
          ENDIF
.
.         Check if end of segment found
.
          MATCH     CRETURN,ANS                  * carriage return found ?
          IF        @EQUAL
            APPEND    ANS,RECVMESS
            CALL      RFLD0000                   * reset component just loaded
            GOTO      GCHR9500
          ENDIF
.
.         Check if end of block (message) found
.
          MATCH     ENDBLOCK,ANS                 * end of block found ?
          IF        @EQUAL
            CALL      RFLD0000                   * reset component just loaded
            GOTO      GCHR9400
          ENDIF
.
.         Check if start of block found
.
          MATCH     STRTBLOK,ANS                 * start of block found ?
          IF        @EQUAL
            CALL      CLER0000                   * clear mess. buffers and flags
            GOTO      GCHR9300                   * start again
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      GCHR9999
.
GCHR9100  MOVE      ONE,EXIT
          GOTO      GCHR9999
.
GCHR9200  MOVE      TWO,EXIT
          GOTO      GCHR9999
.
GCHR9300  MOVE      THREE,EXIT
          GOTO      GCHR9999
.
GCHR9400  MOVE      FOUR,EXIT
          GOTO      GCHR9999
.
GCHR9500  MOVE      FIVE,EXIT
          GOTO      GCHR9999
.
GCHR9600  IF        DISPFLAG = 1
            DISPLAY   "MSH.1: Field Separator not set",*R,*N;
          ENDIF
          MOVE      SIX,EXIT
          GOTO      GCHR9999
.
GCHR9700  IF        DISPFLAG = 1
            DISPLAY   "MSH.2: Missing Encoding Character(s)",*R,*N;
          ENDIF
          MOVE      SEVEN,EXIT
.
GCHR9999  RETURN
+
.*****************************************************************************
.*                            CLER0000             Called by: GCHR0000       *
.*              Clear message buffers and flags               PROC0000       *
.*****************************************************************************
.
CLER0000  PACK      RECVMESS,SP100,SP100,SP100,SP100,SP100,SP100,SP100,SP100:
                             SP100,SP100,SP100,SP100,SP100,SP100,SP100,SP100:
                             SP100,SP100,SP100,SP100,SP100,SP100,SP100,SP100:
                             SP100,SP100,SP100,SP100,SP100,SP100,SP100,SP100:
                             SP100,SP100,SP100,SP100,SP100,SP100,SP100,SP100
          CLEAR     RECVMESS                     * clear full message buffer
          MOVE      ZERO,ERRORCNT                * initialise error flag
          MOVE      SP20,SAVMESID                * initialise message id
          MOVE      ZERO,SEGCOUNT                * initialise segment seq. count
.
          PACK      SEGSTRNG,SP100,SP100,SP100,SP100,SP100,SP100,SP100,SP100:
                             SP100,SP100,SP100,SP100,SP100,SP100,SP100,SP100:
                             SP100,SP100,SP100,SP100
          CLEAR     SEGSTRNG                     * clear segment string
          PACK      SENTMESS,SP100,SP100,SP100,SP100,SP100,SP100,SP100,SP100:
                             SP100,SP100,SP100,SP100,SP100,SP100,SP100,SP100:
                             SP100,SP100,SP100,SP100,SP100,SP100,SP100,SP100:
                             SP100,SP100,SP100,SP100,SP100,SP100,SP100,SP100:
                             SP100,SP100,SP100,SP100,SP100,SP100,SP100,SP100
          CLEAR     SENTMESS                     * clear full message buffer
.
          MOVE      SP100,ERORLINE               * clear first error
          CLEAR     ERORLINE
          MOVE      ZERO,ERORNUMB                * initialise first error
          MOVE      "Message accepted",ERORTEXT  * default for no error
.
          CALL      CTMP0000                     * clear drug temp file
.
          MOVE      SP3,SAVSEGMT
          MOVE      ZERO,MESSGNUM
          MOVE      ZERO,RXDCOUNT
          MOVE      ZERO,TEMPUNIQ                * initialise unique counter
.
.         Initialise the O01 mandatory segment array
.         
          MOVE      ANSN,O01ARRAY[1]
          MOVE      ANSN,O01ARRAY[2]
          MOVE      ANSN,O01ARRAY[3]
          MOVE      ANSN,O01ARRAY[4]
          MOVE      ANSN,O01ARRAY[5]
          MOVE      ANSN,O01ARRAY[6]
          MOVE      ZERO,O01ARRCT[1]
          MOVE      ZERO,O01ARRCT[2]
          MOVE      ZERO,O01ARRCT[3]
.         
CLER9999  RETURN
+
.*****************************************************************************
.*                              VSEG0000           Called by: PROC0000       *
.*   Validate that the segment found is relevant, and in the correct         *
.*   sequence, for the message type.                                         *
.* Requires:  SEGMENT - 3 character segment id                               *
.* Returns:   EXIT  0 = valid segment                                        *
.*                  1 = invalid segment                                      *
.*            SEGNUMBR - Segment number                                      *
.*                    0 = unknown segment                                    *
.*                    1 = MSH                                                *
.*                    2 = PID                                                *
.*                    3 = PV1                                                *
.*                    4 = ORC                                                *
.*                    5 = RXD                                                *
.*                    6 = RXR                                                *
.*****************************************************************************
.
VSEG0000  MATCH     MSHSEGMT,SEGMENT
          IF        @EQUAL
            MOVE      ONE,SEGNUMBR
            GOTO      VSEG9000
          ENDIF
.
          MATCH     PIDSEGMT,SEGMENT
          IF        @EQUAL
            MOVE      TWO,SEGNUMBR
            GOTO      VSEG9000
          ENDIF
.
          MATCH     PV1SEGMT,SEGMENT
          IF        @EQUAL
            MOVE      THREE,SEGNUMBR
            GOTO      VSEG9000
          ENDIF
.
          MATCH     ORCSEGMT,SEGMENT
          IF        @EQUAL
            MOVE      FOUR,SEGNUMBR
            GOTO      VSEG9000
          ENDIF
.
          MATCH     RXDSEGMT,SEGMENT
          IF        @EQUAL
            MOVE      FIVE,SEGNUMBR
            GOTO      VSEG9000
          ENDIF
.
          MATCH     RXRSEGMT,SEGMENT
          IF        @EQUAL
            MOVE      SIX,SEGNUMBR
            GOTO      VSEG9000
          ENDIF
.
          MOVE      "Segment not valid",ERRORDSC
          MOVE      "100",ERRORNUM
          CALL      EROR0000
          MOVE      ZERO,SEGNUMBR
.
          MOVE      ONE,EXIT
          GOTO      VSEG9999
.
VSEG9000  MOVE      ZERO,EXIT
.
VSEG9999  RETURN
+
.******************************************************************************
.*                                  BACK0000              Called by: INIT0000 *
.*                          Display Background Screen                         *
.******************************************************************************
.
BACK0000  DISPLAY   *P1:4,*EF
          BOX       16,2,2,79,24
          HLINE     *G33,5,2,2
          HLINE     *G37,5,3,39
          HLINE     *G31,5,40,40
          HLINE     *G37,5,41,78
          HLINE     *G34,5,79,79
          HLINE     *G30,24,40,40
          VLINE     *G39,40,6,23
          DISPLAY   *P30:3,*HON,*V2LON," MESSAGE STATISTICS ";
.
          CALL      IBACLOCK
          PACK      KEY8,CCC,CYY,CMM,CDD
          UNPACK    KEY8,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          REP       " 0",CPCDATE
          CLOCK     TIME,CTIMEIS
.
          DISPLAY   *P4:4,"Activated on ",*V2LON,CPCDATE,*HOFF:
                    "  @  ",*V2LON,CTIMEIS,*HOFF:
                    *P41:4,"Current status... ",*V2LON,*HON,"Waiting";
.
          DISPLAY   *P4:6,*V2LON,*ULON,"Message":
                    *P12:6,"Received",*P21:6,"Successful",*P32:6,"Rejected":
                    *P42:6,*V2LON,*ULON,"Message":
                    *P50:6,"Received",*P59:6,"Successful":
                    *P70:6,"Rejected",*HOFF:
                    *P6:7,"O01"
.
.         Initialise counters
.
          MOVE      ONE,FORM2
          REPEAT
            STORE     ZERO,FORM2,O01RECV:
                                 O01FAIL:
                                 O01SUCC
            ADD       ONE,FORM2
          UNTIL     FORM2 > 3
.
BACK9999  RETURN
+
.*****************************************************************************
.*                          WMSH0000               Called by: PROC0000       *
.*        Format and write the message header segment                        *
.* Returns:  EXIT   0 = message sent ok                                      *
.*                  1 = connection lost, message not sent                    *
.*                  2 = timeout, message not sent                            *
.*****************************************************************************
.
WMSH0000  CALL      GDTM0000                     * get message date/time
.
.         If displaying messages, prepare the reply message variable
.
          MOVE      PIPE,MSH001                  * set field delimiter
.
          MOVE      "^~\&",MSH002                * set encoding chars.
.
          MOVE      "webPAS",MSH003              * set sending application
          ENDSET    MSH003
          APPEND    CARET,MSH003
          APPEND    PRGID,MSH003
          APPEND    VERSION,MSH003
          APPEND    CARET,MSH003
          APPEND    ANSL,MSH003
          RESET     MSH003
.
          MOVE      CAPPRVNO,MSH004              * set sending facility
          STRIP     MSH004
.
          MOVE      SAVAPPLI,MSH005              * set receiving application
          STRIP     MSH005
.
          MOVE      SAVFACIL,MSH006              * set receiving facility
.
          MOVE      DATETIME,MSH007              * set message date/time
          STRIP     MSH007
.
          CLEAR     MSH008                       * set security
.
.         Set message type
.
          MOVE      "RRD^O02^RRD_O02",MSH009
.
.         Generate and set message id
.
          MOVE      "  0",PRXCODE                * System Lock Sector 0
          CALL      GETSLK00                     * Get System Lock-Sector 0
          READ      CONTROLF,ZERO;*87,IBCNMESI   * read next message id
          MOVE      IBCNMESI,MSH010              * set message id
          ADD       ONE,IBCNMESI
          WRITAB    CONTROLF,ZERO;*87,IBCNMESI
          CALL      RELSLK00                     * Release System Lock-Sector 0
          SQUEEZE   MSH010
.
          MOVE      SAVPRCID,MSH011              * set processing id
.
          MOVE      "2.3.1",MSH012               * set version id
.
          CLEAR     MSH013                       * set sequence number
.
          CLEAR     MSH014                       * set continuation pointer
.
          CLEAR     MSH015                       * set accept ackn. type
.
          CLEAR     MSH016                       * set applic. ackn. type
.
          CLEAR     MSH017                       * set country code
.
          CLEAR     MSH018                       * set character set
.
          MOVE      "en^^ISO 639-1",MSH019       * set principal language
.
          MOVE      "MSH",SEGMENT
          PACK      SEGSTRNG,STRTBLOK,SEGMENT:
                             MSH001,MSH002,PIPE,MSH003,PIPE,MSH004,PIPE:
                             MSH005,PIPE,MSH006,PIPE,MSH007,PIPE,MSH008,PIPE:
                             MSH009,PIPE,MSH010,PIPE,MSH011,PIPE,MSH012,PIPE:
                             MSH013,PIPE,MSH014,PIPE,MSH015,PIPE,MSH016,PIPE:
                             MSH017,PIPE,MSH018,PIPE,MSH019,CRETURN
.
          CALL      SEND0000                     * send message
          BRANCH    EXIT,WMSH9100:               * connection lost
                         WMSH9200                * timeout
.
          MOVE      ZERO,EXIT                    * sent ok
          GOTO      WMSH9999
.
WMSH9100  MOVE      ONE,EXIT
          GOTO      WMSH9999
.
WMSH9200  MOVE      TWO,EXIT
          GOTO      WMSH9999
.
WMSH9999  RETURN
+
.*****************************************************************************
.*                          WMSA0000               Called by: PROC0000       *
.*        Format and write the message acknowledgement segment               *
.* Returns:  EXIT   0 = message sent ok                                      *
.*                  1 = connection lost, message not sent                    *
.*                  2 = timeout, message not sent                            *
.*****************************************************************************
.
WMSA0000  MOVE      SP2,MSA001                   * clear all MSA fields
          MOVE      SP20,MSA002
          MOVE      SP100,MSA003
          MOVE      SP15,MSA004
          MOVE      SP1,MSA005
          MOVE      SP100,MSA006
          CLEAR     MSA001
          CLEAR     MSA002
          CLEAR     MSA003
          CLEAR     MSA004
          CLEAR     MSA005
          CLEAR     MSA006
.
.         Set MSA.1, Acknowledgement Code
.
          IF        ERRORCNT = 0
            MOVE      "AA",MSA001
          ELSE
            IF        ERORNUMB > 199
              MOVE      "AR",MSA001
            ELSE
              MOVE      "AE",MSA001
            ENDIF
          ENDIF
.
.         Set MSA.2, Message Control ID
.
          MOVE      SAVMESID,MSA002
.
.         Set MSA.3, Text message
.
          IF        ERRORCNT > 0
            MOVE      ERORLINE,MSA003
            STRIP     MSA003
          ENDIF
.
.         Set MSA.4, Expected Sequence Number
.
.         Set MSA.5, Delayed Acknowledgement Type
.
.         Set MSA.6, Error Condition
.
          MOVE      ERORNUMB,MSA006
          SQUEEZE   MSA006
          ENDSET    MSA006
          APPEND    CARET,MSA006
          APPEND    ERORTEXT,MSA006
          APPEND    CARET,MSA006
          APPEND    "HL7",MSA006
          RESET     MSA006
.
          MOVE      "MSA",SEGMENT
          PACK      SEGSTRNG,SEGMENT,PIPE:
                             MSA001,PIPE,MSA002,PIPE,MSA003,PIPE,MSA004,PIPE:
                             MSA005,PIPE,MSA006,CRETURN
.
          CALL      SEND0000                     * send message
          BRANCH    EXIT,WMSA9100:               * connection lost
                         WMSA9200                * timeout
.
          MOVE      ZERO,EXIT                    * sent ok
          GOTO      WMSA9999
.
WMSA9100  MOVE      ONE,EXIT
          GOTO      WMSA9999
.
WMSA9200  MOVE      TWO,EXIT
          GOTO      WMSA9999
.
WMSA9999  RETURN
+
.*****************************************************************************
.*                         VMES0000                Called by: PROC0000       *
.*          Validate message specific fields                                 *
.*   Previously, we have performed all the general HL7 validations.  Now we  *
.*   need to validate fields which are specific to the IBA database for      *
.*   the relevant messages.                                                  *
.*****************************************************************************
.
VMES0000  BRANCH    MESSGNUM,VMES9999:    * R01
                             VMES9999:    * O01
                             VMES9999     * I12
.
VMES9999  RETURN
+
.*****************************************************************************
.*                              VDTM0000           Called by: Lots           *
.*                  Validate a date/time field                               *
.* Requires:  DIM14 - Date in format ccyymmddhhmmss                          *
.*            FORM3 - Length of field passed                                 *
.*            FIELDID - Field being checked                                  *
.*            DATFLAG1 - Dates Allowed flag                                  *
.*                          0 = any date/time allowed                        *
.*                          1 = no future date/time allowed                  *
.*                          2 = future time only allowed                     *
.*                              (date must be past or current)               *
.*            DATFLAG2 - Date type                                           *
.*                          0 = Date only (ccyymmdd)                         *
.*                          1 = Date and Time (ccyymmddhhmmss)               *
.* Returns:   ERRORCNT - error count                                         *
.*****************************************************************************
.
VDTM0000  BRANCH    DATFLAG2,VDTM0050            * validate date and time
.
.         The field only requires date validation
.
          COMPARE   EIGHT,FORM3
          GOTO      VDTM0070 IF LESS
          GOTO      VDTM0100
.
.         The field requires a date and time
.
VDTM0050  MOVE      SP8,SAVEDATE                 * clear saved transaction date
          COMPARE   TEN4,FORM3
          GOTO      VDTM0100 IF NOT LESS
.
VDTM0070  MOVE      FIELDID,ERRORDSC
          ENDSET    ERRORDSC
          APPEND    ": Date is incomplete",ERRORDSC
          RESET     ERRORDSC
          MOVE      "207",ERRORNUM
          CALL      EROR0000
          GOTO      VDTM9999
.
.         Validate that the date/time is numeric
.
VDTM0100  TYPE      DIM14
          IF        !@EQUAL
            MOVE      FIELDID,ERRORDSC
            ENDSET    ERRORDSC
            APPEND    ": Date is not numeric",ERRORDSC
            RESET     ERRORDSC
            MOVE      "102",ERRORNUM
            CALL      EROR0000
            GOTO      VDTM9999
          ENDIF
.
          UNPACK    DIM14,DIM2C,DIM2Y,DIM2M,DIM2D,DIM2H,DIM2N,DIM2S
.
.         Validate the century is >= 19
.
          MOVE      DIM2C,FORM2
          IF        FORM2 < 19
            MOVE      FIELDID,ERRORDSC
            ENDSET    ERRORDSC
            APPEND    ": Century is not valid",ERRORDSC
            RESET     ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VDTM9999
          ENDIF
.
.         Validate the month
.
          MOVE      DIM2M,FORM2
          IF        FORM2 < 1 | FORM2 > 12
            MOVE      FIELDID,ERRORDSC
            ENDSET    ERRORDSC
            APPEND    ": Month is not valid",ERRORDSC
            RESET     ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VDTM9999
          ENDIF
.
.         Validate the day is:
.              < 32 for January, March, May, July, August, October & December
.              < 31 for April, June, September & November
.              < 29 for February, except in a leap year where it is < 30
.
          BRANCH    FORM2,VDTM1000:              * Jan
                          VDTM3000:              * Feb
                          VDTM1000:              * Mar
                          VDTM2000:              * Apr
                          VDTM1000:              * May
                          VDTM2000:              * Jun
                          VDTM1000:              * Jul
                          VDTM1000:              * Aug
                          VDTM2000:              * Sep
                          VDTM1000:              * Oct
                          VDTM2000:              * Nov
                          VDTM1000               * Dec
.
.         Validate days for month of 31 days
.
VDTM1000  MOVE      DIM2D,FORM2
          IF        FORM2 < 1 | FORM2 > 31
            GOTO      VDTM3900
          ENDIF
          GOTO      VDTM4000
.
.         Validate days for month of 30 days
.
VDTM2000  MOVE      DIM2D,FORM2
          IF        FORM2 < 1 | FORM2 > 30
            GOTO      VDTM3900
          ENDIF
          GOTO      VDTM4000
.
.         Validate days for February
.         A leap year is one where:
.           1. Every year divisible by 4 is a leap year.
.           2. But every year divisible by 100 is NOT a leap year
.           3. Unless the year is also divisible by 400, then it is still a
.              leap year.
.
VDTM3000  MOVE      DIM2D,FORM2
          PACK      DIM4,DIM2C,DIM2Y
          MOVE      DIM4,FORM4
          IF        (FORM4%4) = 0
            IF        (FORM4%100) = 0
              IF        (FORM4%400) = 0
                GOTO      VDTM3200
              ENDIF
            ELSE
              GOTO      VDTM3200
            ENDIF
          ENDIF
.
.         Check for normal Feb days
.
VDTM3100  IF        FORM2 < 1 | FORM2 > 28
            GOTO      VDTM3900
          ENDIF
          GOTO      VDTM4000
.
.         Check for leap year Feb days
.
VDTM3200  IF        FORM2 < 1 | FORM2 > 29
            GOTO      VDTM3900
          ENDIF
          GOTO      VDTM4000
.
VDTM3900  MOVE      FIELDID,ERRORDSC
          ENDSET    ERRORDSC
          APPEND    ": Day is not valid",ERRORDSC
          RESET     ERRORDSC
          MOVE      "207",ERRORNUM
          CALL      EROR0000
          GOTO      VDTM9999
.
VDTM4000  MOVE      DIM14,SAVEDATE               * save trans. date (FT1 only)
          CALL      IBACLOCK
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          MOVE      DIM14,DIM8
.
          BRANCH    DATFLAG1,VDTM5000:          * date cannot be in the future
                             VDTM5000           * time can only be in the future
          GOTO      VDTM8000                    * any date allowed
.
.         Make sure the date is not in the future
.
VDTM5000  MATCH     DIM8,CURRDATE
          IF        @LESS
            MOVE      FIELDID,ERRORDSC
            ENDSET    ERRORDSC
            APPEND    ": Date in the future",ERRORDSC
            RESET     ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VDTM9999
          ENDIF
.
VDTM8000  COMPARE   TEN4,FORM3                   * time populated ?
          GOTO      VDTM9999 IF LESS             * no - finished
.
.         Validate the hour
.
          MOVE      DIM2H,FORM2
          IF        FORM2 < 0 | FORM2 > 23
            MOVE      FIELDID,ERRORDSC
            ENDSET    ERRORDSC
            APPEND    ": Hour not valid",ERRORDSC
            RESET     ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VDTM9999
          ENDIF
.
.         Validate the minute
.
          MOVE      DIM2N,FORM2
          IF        FORM2 < 0 | FORM2 > 59
            MOVE      FIELDID,ERRORDSC
            ENDSET    ERRORDSC
            APPEND    ": Minutes not valid",ERRORDSC
            RESET     ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VDTM9999
          ENDIF
.
.         Validate the second
.
          MOVE      DIM2S,FORM2
          IF        FORM2 < 0 | FORM2 > 59
            MOVE      FIELDID,ERRORDSC
            ENDSET    ERRORDSC
            APPEND    ": Seconds not valid",ERRORDSC
            RESET     ERRORDSC
            MOVE      "207",ERRORNUM
            CALL      EROR0000
            GOTO      VDTM9999
          ENDIF
.
          BRANCH    DATFLAG1,VDTM9000:          * date cannot be in the future
                             VDTM9999           * time can only be in the future
          GOTO      VDTM9999                    * any date allowed
.
.         Make sure that the time is not in the future
.
VDTM9000  MATCH     DIM8,CURRDATE
          IF        @EQUAL
            PACK      DIM8,DIM2H,COLON,DIM2N,COLON,DIM2S
            MATCH     DIM8,CTIMEIS
            IF        @LESS
              MOVE      FIELDID,ERRORDSC
              ENDSET    ERRORDSC
              APPEND    ": Time in the future",ERRORDSC
              RESET     ERRORDSC
              MOVE      "207",ERRORNUM
              CALL      EROR0000
            ENDIF
          ENDIF
.
VDTM9999  RETURN
+
.*****************************************************************************
.*                              EROR0000           Called by:  Lots          *
.*                       Error handling routine                              *
.* Requires: ERRORCNT - current error count                                  *
.*           ERRORDSC - error description                                    *
.*           ERRORNUM - error number                                         *
.* Returns:  ERORLINE - error description for error count = 1 (to be         *
.*                      returned in acknowledgement message - MSA.3)         *
.*           ERRORCNT - updated error count                                  *
.*           ERORNUMB - first error number                                   *
.*****************************************************************************
.
EROR0000  IF        DISPFLAG = 1
            DISPLAY   *+,ERRORDSC,*-,*R,*N;
          ELSE
          ENDIF
          ADD       ONE,ERRORCNT                 * increment error count
.
.         Write the error to the log file
.
          WRITE     TEXTFILE,SEQ;ERRORNUM,SP2,ERRORDSC
.
.         If this is the first error message, then store this to send
.         back in the acknowledgement message - MSA.3 & MSA.6.
.
          IF        ERRORCNT = 1
            MOVE      ERRORDSC,ERORLINE
.
            MOVE      ERRORNUM,ERORNUMB
            IF        ERORNUMB = 100
              MOVE      "Segment sequence error",ERORTEXT
              GOTO      EROR9000
            ENDIF
            IF        ERORNUMB = 101
              MOVE      "Required field missing",ERORTEXT
              GOTO      EROR9000
            ENDIF
            IF        ERORNUMB = 102
              MOVE      "Data type error",ERORTEXT
              GOTO      EROR9000
            ENDIF
            IF        ERORNUMB = 103
              MOVE      "Table value not found",ERORTEXT
              GOTO      EROR9000
            ENDIF
            IF        ERORNUMB = 200
              MOVE      "Unsupported message type",ERORTEXT
              GOTO      EROR9000
            ENDIF
            IF        ERORNUMB = 201
              MOVE      "Unsupported event code",ERORTEXT
              GOTO      EROR9000
            ENDIF
            IF        ERORNUMB = 202
              MOVE      "Unsupported procssing id",ERORTEXT
              GOTO      EROR9000
            ENDIF
            IF        ERORNUMB = 203
              MOVE      "Unsupported version id",ERORTEXT
              GOTO      EROR9000
            ENDIF
            IF        ERORNUMB = 204
              MOVE      "Unknown key identifier",ERORTEXT
              GOTO      EROR9000
            ENDIF
            IF        ERORNUMB = 205
              MOVE      "Duplicate key identifier",ERORTEXT
              GOTO      EROR9000
            ENDIF
            IF        ERORNUMB = 206
              MOVE      "Application record locked",ERORTEXT
              GOTO      EROR9000
            ENDIF
            IF        ERORNUMB = 207
              MOVE      "Application internal error",ERORTEXT
              GOTO      EROR9000
            ENDIF
            MOVE      "Unknown internal error",ERORTEXT
.
.           If this is the first error message, then send an email alert.
.           Load the error description and replace blanks with underscores
.           so the description is passed as a single variable to the script
.           for an email alert to be sent
.
EROR9000    MOVE      ERRORDSC,ALTERDSC
            REP       " _",ALTERDSC
            CALL      ALTUSR00                   * email alert
          ENDIF
.
EROR9999  RETURN
+
.*****************************************************************************
.*                              VO010000           Called by: PROC0000       *
.*              Validate the RDS^O01 message segments                        *
.*     MSH (mandatory - 1 only)                                              *
.*     PID (mandatory - 1 only)                                              *
.*     PV1 (mandatory - 1 only)                                              *
.*     ORC (mandatory - 1 only)---                                           *
.*     RXD (mandatory - 1 only)   | Repeating group of fields                *
.*     RXR (mandatory - 1 only)---                                           *
.* Requires:  SAVSEGMT - saved previous segment id.                          *
.* Returns :  SAVSEGMT - updated current segment id.                         *
.*****************************************************************************
.
.         Check if this is a PID segment.
.
VO010000  MATCH     PIDSEGMT,SEGMENT             * PID segment ?
          GOTO      VO011000 IF NOT EQUAL        * no
.
.         Check the PID segment was preceeded by an MSH segment
.
          MATCH     MSHSEGMT,SAVSEGMT
          GOTO      VO019100 IF NOT EQUAL
.
          MOVE      ANSY,O01ARRAY[1]             * MSH mandatory
          MOVE      ANSY,O01ARRAY[2]             * PID mandatory
          MOVE      PIDSEGMT,SAVSEGMT            * save segment id
          GOTO      VO019999
.
.         Check if this is an PV1 segment
.
VO011000  MATCH     PV1SEGMT,SEGMENT
          GOTO      VO011500 IF NOT EQUAL
.
.         Check the PV1 segment was preceeded by a PID segment
.
          MATCH     PIDSEGMT,SAVSEGMT
          GOTO      VO019100 IF NOT EQUAL
.
          MOVE      ANSY,O01ARRAY[3]             * PV1 mandatory
          MOVE      PV1SEGMT,SAVSEGMT            * save segment id
          GOTO      VO019999
.
.         Check if this is an ORC segment
.
VO011500  MATCH     ORCSEGMT,SEGMENT
          GOTO      VO012000 IF NOT EQUAL
.
.         Check the ORC segment was preceeded by an appropriate segment.
.         If it's the first ORC, it should be preceded by a PV1 segment.
.         If it's the second ORC, then it should be preceded by an RXD segment
.         as part of a delete segment pairing.
.         Otherwise, it should be preceded by an RXR segment.
.
          IF        RXDCOUNT = 0
            MATCH     PV1SEGMT,SAVSEGMT
            GOTO      VO011700 IF EQUAL
            GOTO      VO019100
          ENDIF
.
          IF        RXDCOUNT = 1
            MATCH     RXDSEGMT,SAVSEGMT
            GOTO      VO011700 IF EQUAL
            GOTO      VO019100
          ENDIF
.
          MATCH     RXRSEGMT,SAVSEGMT
          GOTO      VO019100 IF NOT EQUAL
.
VO011700  MOVE      ANSY,O01ARRAY[4]             * ORC mandatory
          ADD       ONE,O01ARRCT[1]              * increment ORC count
          MOVE      ORCSEGMT,SAVSEGMT            * save segment id
          GOTO      VO019999
.
.         Check if this is an RXD segment
.
VO012000  MATCH     RXDSEGMT,SEGMENT
          GOTO      VO012500 IF NOT EQUAL
.
.         Check the RXD segment was preceeded by an ORC segment
.
          MATCH     ORCSEGMT,SAVSEGMT
          GOTO      VO019100 IF NOT EQUAL
.
          MOVE      ANSY,O01ARRAY[5]             * RXD mandatory
          ADD       ONE,O01ARRCT[2]              * increment RXD count
          MOVE      RXDSEGMT,SAVSEGMT            * save segment id
          GOTO      VO019999
.
.         Check if this is an RXR segment
.
VO012500  MATCH     RXRSEGMT,SEGMENT
          GOTO      VO019100 IF NOT EQUAL
.
.         Check the RXR segment was preceeded by an RXD segment
.
          MATCH     RXDSEGMT,SAVSEGMT
          GOTO      VO019100 IF NOT EQUAL
.
          MOVE      ANSY,O01ARRAY[6]             * RXR mandatory
          ADD       ONE,O01ARRCT[3]              * increment RXR count
          MOVE      RXRSEGMT,SAVSEGMT            * save segment id
          GOTO      VO019999
.
VO019100  MOVE      MSEQCAPT,ERRORDSC
          MOVE      "100",ERRORNUM
          CALL      EROR0000
.
VO019999  RETURN
+
.*****************************************************************************
.*                             URST0000            Called by: VTYP0000       *
.*        Update stats on screen for messages received                       *
.*****************************************************************************
.
URST0000  BRANCH    DISPFLAG,URST9999            * not displaying
.
          BRANCH    MESSGNUM,URST0100            * O01
.
          GOTO      URST9999                     * invalid message type
.
URST0100  ADD       ONE,O01RECV
          DISPLAY   *P12:7,O01RECV;
.
URST9999  RETURN
+
.*****************************************************************************
.*                             UFST0000            Called by: PROC0000       *
.*        Update stats on screen for messages which failed processing        *
.*****************************************************************************
.
UFST0000  BRANCH    DISPFLAG,UFST9999            * not displaying
.
          BRANCH    MESSGNUM,UFST0100            * O01
.
          GOTO      UFST9999                     * invalid message type
.
UFST0100  ADD       ONE,O01FAIL
          DISPLAY   *P32:7,O01FAIL;
.
UFST9999  RETURN
+
.*****************************************************************************
.*                             USST0000            Called by: PROC0000       *
.*        Update stats on screen for successfully processed messages         *
.*****************************************************************************
.
USST0000  BRANCH    DISPFLAG,USST9999            * not displaying
.
          BRANCH    MESSGNUM,USST0100            * O01
.
          GOTO      USST9999                     * invalid message type
.
USST0100  ADD       ONE,O01SUCC
          DISPLAY   *P21:7,O01SUCC;
.
USST9999  RETURN
+
.*****************************************************************************
.*                              PO010000           Called by: PROC0000       *
.*                     Process the RDS^O01 message                           *
.* Requires: Transmitted message variables                                   *
.*****************************************************************************
.
PO010000  CALL      CMED0000                     * remove curr. medication recs
.
          MOVE      SP3,KEY3
          CALL      RSTEMP1                      * pos'n at start of temp file
PO010500  CALL      RKTEMP1                      * read next record
          BRANCH    OVRCD,PO019999               * eof - finished
.
          CALL      CLOBSMED                     * clear obsmedaf variables
.
          MOVE      SAVVISIT,OBMEVISN            * load obsmedaf variables
          MOVE      TEMPUNIQ,OBMECNTR
          MOVE      TEMPDRUG,OBMEDRUG
          MOVE      TEMPSCDT,OBMESCDT
          MOVE      TEMPINST,OBMEINST
          MOVE      TEMPDOSE,OBMEDOSE
          MOVE      TEMPDRBR,OBMEDRBR
.
          CALL      WROBMED1                     * write medication record
          GOTO      PO010500                     * get next record
.
PO019999  RETURN
+
.*****************************************************************************
.*                               CMED0000     Called by: PO010000            *
.*      Clear any current medication records for this visit from obsmedaf    *
.* Requires: SAVVISIT - Visit number                                         *
.*****************************************************************************
.
CMED0000  PACK      KEY11,SAVVISIT,SP20
          CALL      RSOBMED1                     * position at start of visit
          CALL      RKOBMED1                     * read next record
          BRANCH    OVRCD,CMED9999               * eof - finished
.
          MATCH     SAVVISIT,OBMEVISN            * same visit still ?
          GOTO      CMED9999 IF NOT EQUAL        * no - finished
.
          PACK      KEY11,OBMEVISN,OBMECNTR
          CALL      DEOBMED1                     * delete record
          GOTO      CMED0000                     * get next record
.
CMED9999  RETURN
+
.*****************************************************************************
.*                          OLOG0000               Called by: PROC0000       *
.*                Create/Open Day log file                                   *
.*****************************************************************************
.
.         Get the current date for the log file name
.
OLOG0000  CALL      IBACLOCK                     * get current date/time
          MOVE      CTIMEIS,TIMSTAMP
          REP       " 0",TIMSTAMP
.
.         Load the filename with the path and current date
.
          MOVE      SP100,FULLPATH
          CLEAR     FULLPATH
          APPEND    CDDRCTRY,FULLPATH
          PACK      TXTFNAME,CCC,CYY,CMM,CDD
          REP       " 0",TXTFNAME
          APPEND    TXTFNAME,FULLPATH
          APPEND    ".res",FULLPATH
          RESET     FULLPATH
.
.         Open the file and if it doesn't exist, then PREP it.
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEXTFILE,FULLPATH            * open text file
          TRAPCLR   IO
          IF        OVRCD = 1
            PREP      TEXTFILE,FULLPATH          * create & open text file
            WRITE     TEXTFILE,MINUS3;DASHLINE   * write line to start new mess.
          ELSE
            WRITE     TEXTFILE,MINUS3;SP1        * move to new line
            WRITE     TEXTFILE,SEQ;DASHLINE      * write line to start new mess.
          ENDIF
.
OLOG9999  RETURN
+
.*****************************************************************************
.*                                 ALTUSR00        Called by: EROR0000       *
.*      Alert user of Interface error by executing a script to send an email *
.*****************************************************************************
.
ALTUSR00  MOVE      "hl7rslts.us1 ",KEY13
          PACK      CMDLINE,KEY13,PRGID,SP1,SAVMESID,SP1,ERRORNUM,SP1,ALTERDSC:
                    SP100
          EXECUTE   CMDLINE,TASKID
.
ALTUSR99  RETURN
+
.*****************************************************************************
.*                               CONV0000              Called by: Lots       *
.*        Convert escape sequences to their corresponding characters         *
.*        Field Separator         "\F\" becomes "|"                          *
.*        Component separator     "\S\" becomes "^"                          *
.*        Sub-component separator "\T\" becomes "&"                          *
.*        Repetition separator    "\R\" becomes "~"                          *
.*        Escape character        "\E\" becomes "\"                          *
.*        Hexidecimal Tab         "\X09\" becomes " "                        *
.* Requires:  OLDSTRNG  - field on which to check for escape sequences       *
.* Returns:   NEWSTRNG  - field with escape sequences converted              *
.*****************************************************************************
.
CONV0000  PACK      NEWSTRNG,SP100,SP100,SP100,SP100,SP100
          CLEAR     NEWSTRNG
.
          MOVELPTR  OLDSTRNG,FORM4               * get string length
CONV1000  COMPARE   ZERO,FORM4                   * end of string
          GOTO      CONV9000 IF EQUAL            * yes - finished
.
          COMPARE   THREE,FORM4                  * less than 3 characters left ?
          GOTO      CONV8000 IF LESS             * yes - load last characters
.
          MOVE      OLDSTRNG,DIM5                * load next 3 characters
          MATCH     PIPESEQN,DIM5                * field separator \F\ ?
          IF        @EQUAL
            APPEND    MSH00101,NEWSTRNG          * yes
            GOTO      CONV7000
          ENDIF
.
          MATCH     CARTSEQN,DIM5                * component separator \S\ ?
          IF        @EQUAL
            APPEND    COMSEPAR,NEWSTRNG          * yes
            GOTO      CONV7000
          ENDIF
.
          MATCH     AMPRSEQN,DIM5                * subcomponent separator \T\ ?
          IF        @EQUAL
            APPEND    SUBSEPAR,NEWSTRNG          * yes
            GOTO      CONV7000
          ENDIF
.
          MATCH     TILDSEQN,DIM5                * repetition separator \R\ ?
          IF        @EQUAL
            APPEND    REPSEPAR,NEWSTRNG          * yes
            GOTO      CONV7000
          ENDIF
.
          MATCH     BSLASEQN,DIM5                * escape character \E\ ?
          IF        @EQUAL
            APPEND    ESCSEPAR,NEWSTRNG          * yes
            GOTO      CONV7000
          ENDIF
.
          MATCH     TABSEQN,DIM5                 * hexidecimal tab \X09\ ?
          IF        @EQUAL
            APPEND    SP1,NEWSTRNG               * yes
            GOTO      CONV7500
          ENDIF
.
          GOTO      CONV8000                     * no special characters found
.
.         An escape sequence of 3 characters was found, so load the
.         corresponding character instead and jump 3 characters
.
CONV7000  BUMP      OLDSTRNG,3
          SUB       THREE,FORM4
          GOTO      CONV1000                     * get next character
.
.         An escape sequence of 5 characters was found, so load the
.         corresponding character instead and jump 3 characters
.
CONV7500  BUMP      OLDSTRNG,5
          SUB       FIVE,FORM4
          GOTO      CONV1000                     * get next character
.
.         No escape sequence was found, so load the single character
.
CONV8000  MOVE      OLDSTRNG,DIM1
          APPEND    DIM1,NEWSTRNG
          BUMP      OLDSTRNG
          SUB       ONE,FORM4
          GOTO      CONV1000                     * get next character
.
CONV9000  RESET     NEWSTRNG
          PACK      OLDSTRNG,NEWSTRNG,SP70
.
CONV9999  RETURN
+
.****************************************************************************
.*                              MANR0000               Called by: PROC0000  *
.*    Validate that mandatory segments have been received for the message   *
.****************************************************************************
.
MANR0000  BRANCH    MESSGNUM,MANR1000            * O01
.
.         Check that all O01 mandatory segments have been received
.
MANR1000  MATCH     ANSY,O01ARRAY[1]
          IF        !@EQUAL
            MOVE      MSHSEGMT,DIM3
            GOTO      MANR9100
          ENDIF
.
          MATCH     ANSY,O01ARRAY[2]
          IF        !@EQUAL
            MOVE      PIDSEGMT,DIM3
            GOTO      MANR9100
          ENDIF
.
          MATCH     ANSY,O01ARRAY[3]
          IF        !@EQUAL
            MOVE      PV1SEGMT,DIM3
            GOTO      MANR9100
          ENDIF
.
          MATCH     ANSY,O01ARRAY[4]
          IF        !@EQUAL
            MOVE      ORCSEGMT,DIM3
            GOTO      MANR9100
          ENDIF
.
          MATCH     ANSY,O01ARRAY[5]
          IF        !@EQUAL
            MOVE      RXDSEGMT,DIM3
            GOTO      MANR9100
          ENDIF
.
          MATCH     ANSY,O01ARRAY[6]
          IF        !@EQUAL
            MOVE      RXRSEGMT,DIM3
            GOTO      MANR9100
          ENDIF
.
.         Given that the ORC/RXD/RXR segments can repeat as a group,
.         check the segment count is the same for each.
.         We need to remember that there will also be an extra ORC/RXD
.         pair for the "delete' segment, so add "1" to the RXR count
.         to compensate.
.
          IF        O01ARRCT[1] = O01ARRCT[2]
            ADD       ONE,O01ARRCT[3]
            IF        O01ARRCT[1] = O01ARRCT[3]
              GOTO      MANR9999
            ENDIF
          ENDIF
.
MANR9100  MOVE      "Mandatory segment ",ERRORDSC
          ENDSET    ERRORDSC
          APPEND    DIM3,ERRORDSC
          APPEND    " missing",ERRORDSC
          RESET     ERRORDSC
          MOVE      "100",ERRORNUM
          CALL      EROR0000
.
MANR9999  RETURN
+
.*****************************************************************************
.*                              SEND0000           Called by: WMSH0000       *
.*         Send the message segment to Third Party receiver   WMSA0000       *
.* Requires:  SEGSTRNG - the segment string to be sent                       *
.* Returns:   EXIT    0 = message sent ok                                    *
.*                    1 = connection lost, message not sent                  *
.*                    2 = timeout occurred                                   *
.*****************************************************************************
.
SEND0000  MOVELPTR  SEGSTRNG,STRNGLEN            * get string length
.
          IF        DISPFLAG = 1
            DISPLAY   "Sending [",SEGMENT,"] segment",*R,*N;
            MOVE      ZERO,COUNTR
            MOVE      STRNGLEN,FORM4
            DISPLAY   "Sending ",FORM4," bytes: (* = carriage return)",*R,*N;
            WHILE     FORM4 > 0
              ADD       ONE,COUNTR
              MATCH     CRETURN,SEGSTRNG
              IF        @EQUAL
                MOVE      ASK,ANS
              ELSE
                MOVE      SEGSTRNG,ANS
              ENDIF
              IF        COUNTR = 1
                DISPLAY   "[";
              ENDIF
              DISPLAY   *HON,ANS,*HOFF;
              IF        COUNTR = 70
                DISPLAY   "]",*R,*N;
                MOVE      ZERO,COUNTR
              ENDIF
              SUB       ONE,FORM4
              BUMP      SEGSTRNG
            DO
            DISPLAY     "]",*R,*N;
            RESET       SEGSTRNG
          ENDIF
          APPEND      SEGSTRNG,SENTMESS
.
.         Set TRAP for loss of connection then send segment
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF SIGPIPE                  * set trap
          WRITE     COMSOCKT,STRNGLEN,RPLYTIME;SEGSTRNG; * send segment
          TRAPCLR   SIGPIPE                              * clear trap
          GOTO      SEND9200 IF TIMEOUT                  * timeout expired
          BRANCH    OVRCD,SEND9100                       * connection lost
.
          IF        DISPFLAG = 1
            DISPLAY   "[",SEGMENT,"] segment sent",*R,*N;
          ENDIF
.
.         Write the response to the log file
.
          WRITE     TEXTFILE,SEQ;*+,SEGSTRNG;
.
          PACK      SEGSTRNG,SP100,SP100,SP100,SP100,SP100,SP100,SP100,SP100:
                             SP100,SP100,SP100,SP100,SP100,SP100,SP100,SP100:
                             SP100,SP100,SP100,SP100
          CLEAR     SEGSTRNG                     * clear segment string
          MOVE      ZERO,EXIT                    * sent ok
          GOTO      SEND9999
.
SEND9100  MOVE      ONE,EXIT
          GOTO      SEND9999
.
SEND9200  MOVE      TWO,EXIT
          GOTO      SEND9999
.
SEND9999  RETURN
+
.****************************************************************************
.*                              GENDR000               Called by: VPID0000  *
.*    Validate PID.8 (patient sex) against Cat.G HDP default / indc.1       *
.****************************************************************************
.         Check for the first active Cat G code where the HDP Default or
.         indicator 1 matches the value sent
.
GENDR000  MOVE      SP1,D1
          PACK      KEY5,ANSG,SP5
          CALL      RDSCODE1                     * Position on Cat G
GENDR100  CALL      RDKCODE1                     * read next record
          BRANCH    OVRCD,GENDR950               * end of file
.
          MATCH     "G ",TCODE                   * category G still ?
          GOTO      GENDR950 IF NOT EQUAL        * no
.
          MATCH     ANS,THCSCOD                  * matches HDP default ?
          IF        !@EQUAL
            MATCH     ANS,TCINDC1                * matches indicator 1 ?
            GOTO      GENDR100 IF NOT EQUAL      * no - get next record
          ENDIF
.
          MOVE      ACODE,D1                     * save gender code
.
GENDR900  MOVE      ZERO,EXIT                    * valid
          GOTO      GENDR999
.
GENDR950  MOVE      ONE,EXIT                     * invalid
GENDR999  RETURN
+
.*****************************************************************************
.*                         Dummy routines                                    *
.*****************************************************************************
.RDPMQVI1
.EDG10000
.ODG10000
.OPV10000
.EPV10000
.TPV10000
.LOGM0000
.WEBERR00
.ALLBIL00
.ALIT0000
.DGCLII13
.LASTEN00
.WERR0000  RETURN
+
.****************************************************************************
.*        IO ROUTINES FOR TEMPORARY FILE                                    *
.****************************************************************************
.
RATEMP1   MOVE      ZERO,OVRCD
          READ      DRUGTMP1,KEY3;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RSTEMP1   READ      DRUGTMP1,KEY3;;
          RETURN
.
RDTEMP1   MOVE      ZERO,OVRCD
          READ      DRUGTMP1,KEY3;DTMPUNIQ,TEMPDRUG,TEMPSCDT,TEMPINST,TEMPDOSE:
                                  TEMPDRBR
          GOTO      OVERCOND IF OVER
          MOVE      DTMPUNIQ,TEMPUNIQ
          RETURN
.
RKTEMP1   MOVE      ZERO,OVRCD
          READKS    DRUGTMP1;DTMPUNIQ,TEMPDRUG,TEMPSCDT,TEMPINST,TEMPDOSE:
                             TEMPDRBR
          GOTO      OVERCOND IF OVER
          MOVE      DTMPUNIQ,TEMPUNIQ
          RETURN
.
RPTEMP1   MOVE      ZERO,OVRCD
          READKP    DRUGTMP1;DTMPUNIQ,TEMPDRUG,TEMPSCDT,TEMPINST,TEMPDOSE:
                             TEMPDRBR
          GOTO      OVERCOND IF OVER
          MOVE      DTMPUNIQ,TEMPUNIQ
          RETURN
.
WRTEMP1   MOVE      TEMPUNIQ,DTMPUNIQ
          WRITE     DRUGTMP1,KEY3;DTMPUNIQ,TEMPDRUG,TEMPSCDT,TEMPINST,TEMPDOSE:
                                  TEMPDRBR
          RETURN
.
UPTEMP1   MOVE      TEMPUNIQ,DTMPUNIQ
          UPDATE    DRUGTMP1;DTMPUNIQ,TEMPDRUG,TEMPSCDT,TEMPINST,TEMPDOSE:
                             TEMPDRBR
          RETURN
.
DETEMP1   DELETE    DRUGTMP1,KEY3
          RETURN
+
.*****************************************************************************
.         I/O Includes
.*****************************************************************************
.
          INC       STD002IO
.
          INC       ACTMSAV
          INC       CLOBSMED
          INC       CLPMSPX2
          INC       CLPATMAS
          INC       TFILENAM
.
          INC       IBAALVIO/INC
          INC       IBAPOSIO/INC
          INC       OBSMEDIO/INC
          INC       PATCODIO/INC
          INC       PATMA1IO/INC
          INC       PATMI1IO/INC
          INC       PATVISIO/INC
          INC       PMSHCPIO/INC
          INC       PMSPX2IO/INC
          INC       PMSTLEIO/INC
          INC       PMSVX1IO/INC
          INC       WEBERRIO/INC
+
