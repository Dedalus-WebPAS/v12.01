.******************************************************************************
.* System   : Accident & Emergency                                            *
.* Program  : IBAAAE98                                                        *
.* Desc     : System Parameter Maintenance                                    *
.******************************************************************************
.* Date     : 02/06/88                                                        *
.* Author   : Malcolm Hayse                                                   *
.* Function : This program performs maintenance on A&E parameters.            *
.* Mods     :                                                                 *
.*       V10.05.01  31/07/2014  Steve Armstrong  CAR 294204                   *
.*                  Replaced HETYPLAB with AECNLABL                           *
.******************************************************************************
.*        V9.02.01  10/08/2000  Tonii                                         *
.*                  Added HETYPLAB 9 - St Vincent's Labels                    *
.******************************************************************************
.*        V5.08.B01 16/04/2000  Davin                                         *
.*                  Added AECNAEIH & AECNAEIT for user defined invoice        *
.*                  headers/tails                                             *
.******************************************************************************
.*        V5.07.01  28/10/1999  Jill Habasque                                 *
.*                  Added AECNECSR & AECNRQDF                                 *
.******************************************************************************
.*        V5.04.04  19/05/1997  Steve Armstrong   WHL                         *
.*                  Mods for Eltron printer (AECNAELT)                        *
.*        V5.04.03  24/10/1996  Howellsy       srf 642182                     *
.*                  Added AECNPTRI                                            *
.*        V5.04.02  16/07/1996  Whirlpool    srf 641713                       *
.*                  Added AECNDPVI   - Default previous visit code            *
.*        V5.04.01  11/06/1996  Steve Armstrong  SRF 641618                   *
.*                  Added AECNLOCN                                            *
.******************************************************************************
.*        V5.03.03  16/04/1996    Howellsy   5.04                             *
.*                  Changed Accident & Emergency to Emergency.                *
.*        V5.03.02  04/01/1996  Greg Horvat                                   *
.*                  Removed the menu program, security key, IBA screen        *
.*                  password & data directory keyins & changed to use a       *
.*                  standard keyin for the IBA screen security password       *
.*        V5.03.01  27/07/1995  Greg Horvat                                   *
.*                  Added HETYPLAB 8 - Mersey labels                          *
.******************************************************************************
.*            V5.01 03/04/89 J.Tan (I.B.A.)                                   *
.*                  Add Using code U1 indicator SRF 5882                      *
.*            V5.02 05/04/89 J.Tan                                            *
.*                  Add type of label used SRF 5793                           *
.*            V5.03 17/04/89 J.Tan                                            *
.*                  Add HEMBSTHE   SRF 100014                                 *
.*            V5.04 18/04/89 K.Peak                                           *
.*                  Added HSTANDM  SRF (RENO)                                 *
.*            V5.05 20/04/89 K.Peak                                           *
.*                  Added Desc. on inv for Epw SRF 100081                     *
.*            V5.06 24/04/89 K.Peak                                           *
.*                  Added New Zealand to HSTANDM, HCOMDIG                     *
.*            V5.07 03/05/89 K.Peak                                           *
.*                  Added HNUMDES                                             *
.*            V5.08 12/05/89 K.Peak                                           *
.*                  Fixed HNUMDES SRF  100536                                 *
.*            V5.09 16/05/89 K.Peak                                           *
.*                  Fixed screen display , New Zealand Changes                *
.*            V5.10 23.05.89 S.Barcham                                        *
.*                  Fixed screen display SRF100664                            *
.*            V5.01.01 20/07/89 K.Peak   SRF 101632                           *
.*                     8 char Adm & UR, Removed desc for H.codes              *
.*                     08/08/89 K.Peak                                        *
.*                     Added HPRINV inv. at disc.                             *
.*                     16.08.89 S.Barcham                                     *
.*                     Remove CHOSTYP                                         *
.*            V5.01.02 05/09/89 K.Peak                                        *
.*                     Changed Help screen SRF 102208                         *
.*            V5.01.03 10/01/90 K.Peak                                        *
.*                     Add print of additional blank labels SRF 103240        *
.*            V5.01.04 10/01/90 J.Tan                                         *
.*                     Added Continous log for A+E SRF 103241                 *
.*            V5.01.05 12/02/90 DIG                                           *
.*                     Added User Defined Stationary Parameters               *
.*            V5.01.06 14/03/90 E.Phan  Quote 6650                            *
.*                     Added New Zealand Label Format.                        *
.*            V5.01.07 09/04/90 D.Di.Paola       SRF 104543                   *
.*                     Fixed spelling in iba screen 1. field 10....           *
.*            V5.01.08 02/05/90 Graeme Williams  SRF 104820                   *
.*                     Added case notes set ? sys. parameter AECNCASE         *
.*            V5.01.09 04/05/90 D.Di.Paola      SRF 103773                    *
.*                     Fixed bug in reading field 15. and 16.                 *
.*            V5.01.10 09/05/90  E.Phan                                       *
.*                     Activated Misc. Charges Audit & fixed "stationary".    *
.*            V5.01.11 06/06/90  D.Di.Paola     SRF 103773                    *
.*                     Added field 17. "Situation for discharges " to USER    * 
.*                     SCREEN 1...                                             *
.*            V5.01.12 26/06/90 J.Tan           SRF 4582                      *
.*                     Added HINPCLM - input Claim details                    *
.*        V5.01.13  15/05/1991    Justin Coates  Quote 6943 SRF 108605        *
.*                  Added keyin of AECNCHRS to IBA controlled screen          *
.*        V5.01.14  22/10/91    J.Tan                                         *
.*                  Added alert parameter                                     *
.*        V5.01.15  02/01/1992  Graeme Williams                               *
.*                  Added AECNUPVS, AECNUBRD, AECNFTYP for NZ billing         *
.*        V5.01.16  23/03/92    ROD                                           *
.*                  Added AECNSITM                                            *
.*        V5.01.17  04/06/92    CHUCK                                         *
.*                  Added AECNSQA3 & someone cant spel  continous???????????  *
.*        V5.01.18  05/08/92    ROD                                           *
.*                  Added AECNDDCQ, AECNDFDC                                  *
.*        V5.01.19  05/11/1992    Justin Coates  (HONG KONG changes)          *
.*                  Added HETYPLAB = 4 for Hong Kong                          *
.*        V5.01.20  14/09/1993    LOFTY          (DUDLEY changes)             *
.*                  added AECNUVPT to AECNUNNA                                *
.*        V5.01.21  19/10/1993    ROD            (DUDLEY changes)             *
.*                  added AECNWIDS                                            *
.*        V5.01.22  03/11/1993    ROD            (DUDLEY changes)             *
.*                  fixed bug when displaying priority                        *
.*        V5.01.23  29/11/1993    ROD            (DUDLEY changes)             *
.*                  fixed Cancel bug in user screen 1                         *
.*        V5.01.24  26/05/1994    Rob Leonard    (TARANAKI changes)           *
.*                  added Taranaki label option                               *
.*----------------------------------------------------------------------------*
.*        V5.02.00  03/11/1994   Rob Leonard                                  *
.*                  Added Port Macquarie label option  (HETYPLAB=7)           *
.*        V5.02.01  11/12/1994   Graeme Williams                              *
.*                  Added option for fifth priority code                      *
.*        V5.02.02  11/05/1995    Justin Coates                               *
.*                  Added AECNHOSP to IBA Screen                              *
.*                                                                            *
.******************************************************************************
.
          INC       STD001FD
          INC       STDHLPDF
          INC       AAECONFD/INC
          INC       IBACONFD/INC
          INC       IBATMHFD/INC
          INC       PATCODFD/INC
          INC       PATHSPFD/INC
          INC       PATCONFD/INC
.
.         variables
.
CASETYPE  DIM       30
CODE      DIM       2
COMDIG    DIM       10
DANS      DIM       3
DANS1     DIM       3
DANS10    DIM       3
DANS11    DIM       3
DANS12    DIM       3
DANS2     DIM       3
DANS3     DIM       3
DANS4     DIM       3
DANS5     DIM       3
DANS6     DIM       3
DANS7     DIM       3
DANS8     DIM       3
DANS9     DIM       3
DANSX     DIM       3
DFTYPE    DIM       8
DLSIZE    DIM       30
DSTAND    DIM       10
DSYST     DIM       12
ECSRDESC  DIM       30
FORM8     FORM      8
LAYOUT    DIM       20
NUMPRTY   FORM      1
PASS      DIM       8
REPFLAG   FORM      1
RQDFDESC  DIM       30
TDESCA    DIM       20
TDESCB    DIM       20
EPDESC    DIM       20
.
.         constants
.
ADAUSR1   INIT      "ADAUSR1"
ADAUSR2   INIT      "ADAUSR2"
ADAUSR3   INIT      "ADAUSR3"
ADAUSR4   INIT      "ADAUSR4"
ADAUSR5   INIT      "ADAUSR5"
ADASRC    INIT      "ADASRC"
CASE0     INIT      "Set case notes on discharge"
CASE1     INIT      "Don't set case notes       "
CATRQ     INIT      "RQ"
COMDIG0   INIT      "Compl'tn "
COMDIG1   INIT      "Diagnosis"
COMDIG2   INIT      "Neither  "
DFTYPE0   INIT      "PATNIPA1"
DFTYPE1   INIT      "AAEBCHA1"
DLSIZE1   INIT      "Small (37 Char Separation)  "
DLSIZE2   INIT      "Wide  (42 Char Separation)  "
DSTAND0   INIT      "Standard  "
DSTAND1   INIT      "Modbury   "
DSTAND2   INIT      "N.Zealand "
DSYST0    INIT      "Priv. Aust  "
DSYST1    INIT      "Modbury     "
DSYST2    INIT      "Wellington  "
DSYST3    INIT      "N.Zealand   "
DSYST4    INIT      "Hong Kong   "
DSYST5    INIT      "Hawkes Bay  "
DSYST6    INIT      "Taranaki    "
DSYST7    INIT      "Port Macqr  "
DSYST8    INIT      "Mersey      "
DSYST9    INIT      "St Vincent  "
DSYST10   INIT      "SJOG Geelong"
LAYTYP1   INIT      "Modbury"
LAYTYP2   INIT      "User Defined"
.
PRGID     INIT      "IBAAAE98"
PRGNAM    INIT      "System Parameter Maintenance"
VERSION   INIT      "V12.01.00"
.
.*********************************************************************
.         ML1000 OF PROGRAM
.*********************************************************************
ML0000    CALL      INIT0000
.
ML1000    CALL      OPTN0000
          BRANCH    EXIT,ML9999
          BRANCH    OPTION,ML1100,ML1200,ML1300,ML1400,ML1450,ML1500
.
.         Do THE Audit Flags Screen
.
ML1100    CALL      DAUD0000
          CALL      KAUD0000
          BRANCH    EXIT,ML1000             * cancel
          CALL      WAUD0000
          GOTO      ML1000
.
.         Do THE IBA  Controlled Screens
.
ML1200    CALL      IBASECUR                * Keyin IBA screen security passwd
          BRANCH    EXIT,ML1000
.
          CALL      IBAS0000
          GOTO      ML1000
.
.         Do THE User Controlled Screen 1
.
ML1300    CALL      DHSA0000
          CALL      KHSA0000
          BRANCH    EXIT,ML1000
          CALL      WHSA0000
          GOTO      ML1000
.
.         Do THE User Controlled Screen 2
.
ML1400    CALL      DHSB0000
          CALL      KHSB0000
          BRANCH    EXIT,ML1000
          CALL      WHSB0000
          GOTO      ML1000
.
.         Do THE User Controlled Screen 3
.
ML1450    CALL      DHSD0000
          CALL      KHSD0000
          BRANCH    EXIT,ML1000
          CALL      WHSD0000
          GOTO      ML1000
.
.         Do the User defined Fields
.
ML1500    CALL      DHSC0000
          CALL      KHSC0000
          BRANCH    EXIT,ML1000
          CALL      WHSC0000
          GOTO      ML1000
.
ML9999    CHAIN     PGM
+
.*********************************************************************
.         initilisation
.*********************************************************************
INIT0000  CALL      DISPHEAD
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P64:24,"ibatmhaf";
          OPEN      IBATMHA1,"ibatmhaf"
          DISPLAY   *P64:24,"patcodes";
          OPEN      PATCODE1,"patcodes"
          DISPLAY   *P64:24,"pathspaf";
          OPEN      PATHSPA1,"pathspaf"
          MOVE      ONE,CNEWDS
INIT9999  RETURN
+
.*********************************************************************
.         which option ??
.*********************************************************************
OPTN0000  MOVE      ZERO,OVRCD
          MOVE      ZERO,REPFLAG
          HLINE     *G37,2,54,80
          DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON,ZERO,*HOFF," = Exit":
                    *P1:5,*V2LON,ONE,*HOFF," = System Audits":
                    *P1:6,*V2LON,TWO,*HOFF:
                    " = I.B.A. Controlled Screens":
                    *P1:7,*V2LON,THREE,*HOFF:
                    " = User Controlled Parameter Screen 1":
                    *P1:8,*V2LON,FOUR,*HOFF:
                    " = User Controlled Parameter Screen 2":
                    *P1:9,*V2LON,FIVE,*HOFF:
                    " = User Controlled Parameter Screen 3":
                    *P1:10,*V2LON,SIX,*HOFF," = User Defined Fields"
.
OPTN1000  KEYIN     *P1:11,*EL,"Please Select : ",*V2LON,OPTION
          MOVE      ONE,EXIT
          COMPARE   ZERO,OPTION
          GOTO      OPTN9999 IF EQUAL
.
          MOVE      ZERO,EXIT
          BRANCH    OPTION,OPTN9999,OPTN9999,OPTN9999,OPTN9999,OPTN9999,OPTN9999
          BEEP
          GOTO      OPTN1000
.
OPTN9999  RETURN
+
.*********************************************************************
.         display the audit screen
.*********************************************************************
DAUD0000  READ      CONTROLF,THIRTY;*51,HEAUDA,HEAUDB,HEAUDC,HEAUDD,HEAUDE:
                                       HEAUDF,HEAUDG,HEAUDH,HEAUDI,HEAUDJ:
                                       HEAUDK,HEAUDL,HEAUDM,HEAUDN,HEAUDO:
                                       HEAUDP,HEAUDQ,HEAUDR,HEAUDS,HEAUDT:
                                       HEAUDU,HEAUDV,HEAUDW,HEAUDX,HEAUDY,HEAUDZ
          DISPLAY   *P1:3,*EF:
                    *P1:4," 1. Input Details      :":
                    *P1:5," 2. Audit B (Not Used) :":
                    *P1:6," 3. Charge File        :":
                    *P1:7," 4. Audit D (Not used) :":
                    *P1:8," 5. Audit E (Not used) :":
                    *P1:9," 6. Audit F (Not used) :":
                    *P1:10," 7. Audit G (Not used) :":
                    *P1:11," 8. Audit H (Not used) :":
                    *P1:12," 9. Audit I (Not Used) :":
                    *P1:13,"10. Audit J (Not used) :":
                    *P1:14,"11. Audit K (Not used) :":
                    *P1:15,"12. Audit L (Not used) :":
                    *P1:16,"13. Misc. Charges      :":
                    *P41:4,"14. Audit N (Not Used) :":
                    *P41:5,"15. Audit O (Not Used) :":
                    *P41:6,"16. Audit P (Not used) :":
                    *P41:7,"17. Audit Q (Not used) :":
                    *P41:8,"18. Audit R (Not used) :":
                    *P41:9,"19. Supervisor Correctn:":
                    *P41:10,"20. Audit T (Not Used) :":
                    *P41:11,"21. Audit U (Not used) :":
                    *P41:12,"22. Audit V (Not used) :":
                    *P41:13,"23. Waiting Times      :":
                    *P41:14,"24. Audit X (Not used) :":
                    *P41:15,"25. Audit Y (Not used) :":
                    *P41:16,"26. Audit Z (Not used) :"
.
          MOVE      ZERO,FORM2
          MOVE      THREE,CVERT
          MOVE      "26",CCOL
.
DAUD1000  ADD       ONE,FORM2
          ADD       ONE,CVERT
          COMPARE   TWENTY7,FORM2
          GOTO      DAUD9999 IF EQUAL
.
          COMPARE   TEN7,CVERT
          GOTO      DAUD2000 IF LESS
.
          MOVE      FOUR,CVERT
          MOVE      "66",CCOL
.
DAUD2000  LOAD      CCITEM,FORM2,HEAUDA,HEAUDB,HEAUDC,HEAUDD,HEAUDE:
                                 HEAUDF,HEAUDG,HEAUDH,HEAUDI,HEAUDJ:
                                 HEAUDK,HEAUDL,HEAUDM,HEAUDN,HEAUDO:
                                 HEAUDP,HEAUDQ,HEAUDR,HEAUDS,HEAUDT:
                                 HEAUDU,HEAUDV,HEAUDW,HEAUDX,HEAUDY,HEAUDZ
          MOVE      DYES,DANSX
          LOAD      DANSX,CCITEM,DNO
          DISPLAY   *PCCOL:CVERT,*V2LON,DANSX;
          GOTO      DAUD1000
.
DAUD9999  RETURN
+
.*********************************************************************
.         update the audit details
.*********************************************************************
KAUD0000  CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      KAUD9000 IF EQUAL
          GOTO      KAUD9100 IF LESS
.
          COMPARE   "27",CCITEM
          GOTO      KAUD2000 IF NOT LESS
.
          MOVE      THREE,CVERT
          MOVE      "26",CCOL
          ADD       CCITEM,CVERT
          COMPARE   "17",CVERT
          GOTO      KAUD1000 IF LESS
.
          MOVE      "66",CCOL
          SUB       "13",CVERT
.
KAUD1000  KEYIN     *PCCOL:CVERT,*DV,UNDLN3,*PCCOL:CVERT,*V2LON,ANS;
          CMATCH    ANSY,ANS
          GOTO      KAUD3000 IF EQUAL
          GOTO      KAUD3500
KAUD2000  BEEP
          GOTO      KAUD0000
.
KAUD3000  MOVE      DYES,DANSX
          MOVE      ZERO,FORM1
          GOTO      KAUD5000
.
KAUD3500  MOVE      DNO,DANSX
          MOVE      ONE,FORM1
.
KAUD5000  STORE     FORM1,CCITEM,HEAUDA,HEAUDB,HEAUDC,HEAUDD,HEAUDE:
                                 HEAUDF,HEAUDG,HEAUDH,HEAUDI,HEAUDJ:
                                 HEAUDK,HEAUDL,HEAUDM,HEAUDN,HEAUDO:
                                 HEAUDP,HEAUDQ,HEAUDR,HEAUDS,HEAUDT:
                                 HEAUDU,HEAUDV,HEAUDW,HEAUDX,HEAUDY,HEAUDZ
          DISPLAY   *PCCOL:CVERT,*V2LON,DANSX
          GOTO      KAUD0000
.
KAUD9000  MOVE      ZERO,EXIT
          GOTO      KAUD9999
KAUD9100  MOVE      ONE,EXIT
KAUD9999  RETURN
+
.*********************************************************************
.         write the audits
.*********************************************************************
WAUD0000  WRITAB    CONTROLF,THIRTY;*51,HEAUDA,HEAUDB,HEAUDC,HEAUDD,HEAUDE:
                                       HEAUDF,HEAUDG,HEAUDH,HEAUDI,HEAUDJ:
                                       HEAUDK,HEAUDL,HEAUDM,HEAUDN,HEAUDO:
                                       HEAUDP,HEAUDQ,HEAUDR,HEAUDS,HEAUDT:
                                       HEAUDU,HEAUDV,HEAUDW,HEAUDX,HEAUDY,HEAUDZ
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
WAUD9999  RETURN
.
.*********************************************************************
.         IBA screens
.*********************************************************************
IBAS0000  DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON,ZERO,*HOFF," = Exit":
                    *P1:5,*V2LON,ONE,*HOFF," = IBA screen 1":
                    *P1:6,*V2LON,TWO,*HOFF," = IBA screen 2":
                    *P1:8,"Select option : "
.
IBAS0050  KEYIN     *P17:8,*V2LON,OPTION
          COMPARE   ZERO,OPTION
          GOTO      IBAS9999 IF EQUAL
          BRANCH    OPTION,IBAS0100,IBAS0200
          BEEP
          GOTO      IBAS0050
.
IBAS0100  CALL      DIBA0000
          CALL      KIBA0000
          BRANCH    EXIT,IBAS0000
          CALL      WIBA0000
          GOTO      IBAS0000
.
IBAS0200  CALL      DIBB0000
          CALL      KIBB0000
          BRANCH    EXIT,IBAS0000
          CALL      WIBB0000
          GOTO      IBAS0000
.
IBAS9999  RETURN
+
.*********************************************************************
.*        display IBA screen 1                                       *
.********************************************************************* 
DIBA0000  READ      CONTROLF,THIRTY;*95,HESYST,*131,HEMBSTHE,*132,HSTANDM:
                             *178,HADDLAB,HCNTLOG,HPRNLOG,HLNOLOG:
                             *195,HINPCLM,*196,AECNCHRS,*200,AECNFTYP:
                             *202,AECNSQA3,AECNDDCQ,*207,AECNUVPT,*248,AECNDCUR:
                             *249,AECNNCDG
          MOVE      DSYST0,DSYST
          LOAD      DSYST,HESYST,DSYST1,DSYST2
.
          MOVE      DNO,DANS
          LOAD      DANS,HEMBSTHE,DYES,DNO
.
          MOVE      DNO,DANS1
          LOAD      DANS1,HCNTLOG,DYES,DNO
.
          MOVE      DNO,DANS2
          LOAD      DANS2,HINPCLM OF DYES,DNO
.
          MOVE      DSTAND0,DSTAND
          LOAD      DSTAND,HSTANDM,DSTAND1,DSTAND2
.
          MOVE      DNO,DANS3
          LOAD      DANS3,AECNCHRS,DYES 
.
          MOVE      DNO,DANS4
          LOAD      DANS4,AECNSQA3,DYES 
.
          MOVE      DFTYPE0,DFTYPE
          LOAD      DFTYPE,AECNFTYP,DFTYPE1
.
          MOVE      DNO,DANS5
          LOAD      DANS5,AECNDDCQ,DYES 
.
          MOVE      AECNUVPT,NUMPRTY
          ADD       THREE,NUMPRTY
          MOVE      DNO,DANS7
          LOAD      DANS7,AECNDCUR,DYES 
          MOVE      DNO,DANS8
          LOAD      DANS8,AECNNCDG,DYES 
.
          DISPLAY   *P54:2,*V2LON,"- I.B.A Screen 1 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. (No longer used)                            :":
                    *P1:5," 2. (No longer used)                            :":
                    *P1:6," 3. (No longer used)                            :":
                    *P1:7," 4. (No longer used)                            :":
                    *P1:8," 5. Charging Type if using PATNIPA1             :":
                    *P1:9," 6. Using TheatreFee file for MBS Item Code(Y/N):":
                    *P1:10," 7. Using Standard, Modbury or N.Zealand Emerg. :":
                    *P1:11," 8. Number of Additional Labels to Print        :":
                    *P1:12," 9. Using Continuous log of A+E patients  (Y/N) :":
                    *P1:13,"10. Printer,the Continuous log to be printed on :":
                    *P1:14,"11. Current line number for Continuous log      :":
                    *P1:15,"12. Input Claim details in IBAAAE01 ?     (Y/N) :":
                    *P1:16,"13. Charging by discharge status ?        (Y/N) :":
                    *P1:17,"14. Type of Emergency charging to be used       :":
                    *P1:18,"15. Supress '?' on User Defined field 'A3' (Y/N):":
                    *P1:19,"16. Using defaults for Department codes?   (Y/N):":
                    *P1:20,"17. Number of priority codes to be used    (3-5):":
                    *P1:21,"18. Entry by U/R in discharge program      (Y/N):":
                    *P1:22,"19. New coding option allowed              (Y/N):":
                    *P51:8,*V2LON,HESYST,*P60:8,DSYST:
                    *P51:9,DANS,*P51:10,HSTANDM,*P60:10,DSTAND:
                    *P51:11,HADDLAB:
                    *P51:12,DANS1,*P51:13,HPRNLOG,*P51:14,HLNOLOG:
                    *P51:15,DANS2,*P51:16,DANS3:
                    *P51:17,AECNFTYP,*P60:17,DFTYPE,*P51:18,DANS4,*P51:19,DANS5:
                    *P51:20,NUMPRTY,*P51:21,DANS7,*P51:22,DANS8
DIBA9999  RETURN
.
.*********************************************************************
.*        Update IBA screen 1 values                                 *
.*********************************************************************
KIBA0000  CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      KIBA9000 IF EQUAL
          GOTO      KIBA9100 IF LESS
          BRANCH    CCITEM,KIBA0100,KIBA0200,KIBA0300,KIBA0400,KIBA0500:
                           KIBA0600,KIBA0700,KIBA0800,KIBA0900,KIBA1000:
                           KIBA1100,KIBA1200,KIBA1300,KIBA1400,KIBA1500:
                           KIBA1600,KIBA1700,KIBA1800,KIBA1900
          BEEP
          GOTO      KIBA0000
.
KIBA0100  GOTO      KIBA0000
.
KIBA0200  GOTO      KIBA0000
.
KIBA0300  GOTO      KIBA0000
.
KIBA0400  GOTO      KIBA0000
.
KIBA0500  DISPLAY   *P1:23,*EL,"0 = Priv. Aust, 1 = Modbury, 2 = Wellington";
          KEYIN     *P51:8,*EL,*V2LON,FORM1
          ADD       ONE,FORM1
          BRANCH    FORM1,KIBA0510,KIBA0510,KIBA0510
          BEEP
          GOTO      KIBA0500
KIBA0510  SUB       ONE,FORM1
          MOVE      FORM1,HESYST
          MOVE      DSYST0,DSYST
          LOAD      DSYST,HESYST,DSYST1,DSYST2
          DISPLAY   *P51:8,*EL,*V2LON,HESYST,*P60:8,DSYST:
                    *P1:23,*EL
          GOTO      KIBA0000
.
KIBA0600  MOVE      "51",CCOL
          MOVE      "09",CVERT
          CALL      KYN0000
          MOVE      EXIT,HEMBSTHE
          GOTO      KIBA0000
.
KIBA0700  DISPLAY   *P1:23,*EL,"0 = Std, 1 = Mod, 2 = NZ";
          KEYIN     *P51:10,*EL,*V2LON,FORM1
          ADD       ONE,FORM1
          BRANCH    FORM1,KIBA0750,KIBA0750,KIBA0750
          BEEP
          GOTO      KIBA0700
KIBA0750  SUB       ONE,FORM1
          MOVE      FORM1,HSTANDM
          MOVE      DSTAND0,DSTAND
          LOAD      DSTAND,HSTANDM,DSTAND1,DSTAND2
          DISPLAY   *P51:10,*EL,*V2LON,HSTANDM,*P60:10,DSTAND,*P1:23,*EL
          GOTO      KIBA0000
.
KIBA0800  KEYIN     *P51:11,*EL,*V2LON,HADDLAB
          DISPLAY   *P51:11,*EL,*V2LON,HADDLAB
          GOTO      KIBA0000
.
KIBA0900  MOVE      "51",CCOL
          MOVE      "12",CVERT
          CALL      KYN0000
          MOVE      EXIT,HCNTLOG
          GOTO      KIBA0000
.
KIBA1000  KEYIN     *P51:13,*EL,*V2LON,HPRNLOG
          ENDSET    HPRNLOG
          APPEND    SP3,HPRNLOG
          RESET     HPRNLOG
          DISPLAY   *P51:13,*V2LON,HPRNLOG
          GOTO      KIBA0000
.
KIBA1100  KEYIN     *P51:14,*EL,*V2LON,HLNOLOG:
                    *P51:14,*DV,HLNOLOG
          GOTO      KIBA0000
.
. ------- Input Claim details in IBAAAE01 ? -------
.
KIBA1200  MOVE      "51",CCOL
          MOVE      "15",CVERT
          CALL      KYN0000
          MOVE      EXIT,HINPCLM             * Defaults to "No"
          GOTO      KIBA0000
.
.         Input Charging by discharge status
.
KIBA1300  MOVE      "51",CCOL
          MOVE      "16",CVERT
          CALL      KYN0000
          MOVE      EXIT,AECNCHRS
          GOTO      KIBA0000
.
KIBA1400  DISPLAY   *P1:23,*EL,"0 = ",DFTYPE0,", 1 = ",DFTYPE1;
          KEYIN     *P51:17,*EL,*V2LON,FORM1
          BRANCH    FORM1,KIBA1450
          COMPARE   ZERO,FORM1
          GOTO      KIBA1450 IF EQUAL
          BEEP
          GOTO      KIBA1400
.
KIBA1450  MOVE      FORM1,AECNFTYP
          MOVE      DFTYPE0,DFTYPE
          LOAD      DFTYPE,AECNFTYP,DFTYPE1
          DISPLAY   *P51:17,*EL,*V2LON,AECNFTYP,*P60:17,DFTYPE:
                    *P1:23,*EL;
          GOTO      KIBA0000
.
.         Input Supress "?" onm user defined field "A3"
.
KIBA1500  MOVE      "51",CCOL
          MOVE      "18",CVERT
          CALL      KYN0000
          MOVE      EXIT,AECNSQA3
          GOTO      KIBA0000
.
.         Using default deptartment codes?               
.
KIBA1600  MOVE      "51",CCOL
          MOVE      "19",CVERT
          CALL      KYN0000
          MOVE      EXIT,AECNDDCQ
          GOTO      KIBA0000
.
.         using four priorities
.
KIBA1700  KEYIN     *P51:20,*V2LON,*RV,NUMPRTY
          IF        NUMPRTY < 3 | NUMPRTY > 5
            DISPLAY   *P1:24,*EL,*B,"Must be between 3 and 5. ";
            CALL      HITENTER
            GOTO      KIBA1700
          ENDIF
          MOVE      NUMPRTY,AECNUVPT
          SUB       THREE,AECNUVPT
          GOTO      KIBA0000
.
.         entry by U/R in discharges
.
KIBA1800  MOVE      "51",CCOL
          MOVE      "21",CVERT
          CALL      KYN0000
          MOVE      EXIT,AECNDCUR
          GOTO      KIBA0000
.
.         new coding option allowed
.
KIBA1900  MOVE      "51",CCOL
          MOVE      "22",CVERT
          CALL      KYN0000
          MOVE      EXIT,AECNNCDG
          GOTO      KIBA0000
.
KIBA9000  MOVE      ZERO,EXIT
          GOTO      KIBA9999
KIBA9100  MOVE      ONE,EXIT
KIBA9999  RETURN
+
.*********************************************************************
.         write IBA SCREEN A
.*********************************************************************
WIBA0000  WRITAB    CONTROLF,THIRTY;*95,HESYST,*131,HEMBSTHE,*132,HSTANDM:
                             *178,HADDLAB,HCNTLOG,HPRNLOG,HLNOLOG:
                             *195,HINPCLM,*196,AECNCHRS,*200,AECNFTYP:
                             *202,AECNSQA3,AECNDDCQ,*207,AECNUVPT,*248,AECNDCUR:
                             *249,AECNNCDG
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
WIBA9999  RETURN
+
.*********************************************************************
.*        display IBA screen 2                                       *
.********************************************************************* 
DIBB0000  READ      CONTROLF,SEVENTY8;*4,AECNUNNA,*26,AECNHOSP
          MOVE      DNO,DANS1
          LOAD      DANS1,AECNUNNA,DYES 
.
          DISPLAY   *P54:2,*V2LON,"- I.B.A Screen 2 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Using Number of new attendances (Episodes)  :":
                    *P51:4,*V2LON,DANS1,*HOFF:
                    *P1:5," 2. Hospital where Emergency is situated        :":
                    *P51:5,*V2LON,AECNHOSP
DIBB9999  RETURN
.
.*********************************************************************
.*        Update IBA screen 2 values                                 *
.*********************************************************************
KIBB0000  CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      KIBB9000 IF EQUAL
          GOTO      KIBB9100 IF LESS
          BRANCH    CCITEM,KIBB0100,KIBB0200
          BEEP
          GOTO      KIBB0000
.
.         using number of new attendances - episodes
.
KIBB0100  MOVE      "51",CCOL
          MOVE      "04",CVERT
          CALL      KYN0000
          MOVE      EXIT,AECNUNNA
          GOTO      KIBB0000
.
.
.         hospital where A&E is situated
.
KIBB0200  MOVE      "51",ECOL
          MOVE      "05",EVERT
          MOVE      AECNHOSP,CKYIDEF3
          MOVE      ZERO,CKYIMAND
          CALL      PATHSPKY
          MOVE      PTHSHOSP,AECNHOSP
          GOTO      KIBB0000
.         
KIBB9000  MOVE      ZERO,EXIT
          GOTO      KIBB9999
KIBB9100  MOVE      ONE,EXIT
KIBB9999  RETURN
+
.*********************************************************************
.         write IBA SCREEN 2
.*********************************************************************
WIBB0000  WRITAB    CONTROLF,SEVENTY8;*4,AECNUNNA,*26,AECNHOSP
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
WIBB9999  RETURN
+
.*********************************************************************
.         USER SCREEN1
.*********************************************************************
DHSA0000  READ      CONTROLF,THIRTY;*77,HECWC,HECMAB,HECVA,HECDCS:
                             *89,HELPAGE,HELPRNT,HELSIZE,HEPMR5:
                             *110,HEAUSR1,HEAUSRD1,HEAUSRM1:
                             *133,HINVDES,*164,HCOMDIG,*194,HSITN
          READ      CONTROLF,SEVENTY8;*29,AECNPLOC,*35,AECNAELT,*64,AECNLABL
.
          MOVE      DNO,DANS3
          LOAD      DANS3,HEPMR5,DYES,DNO
.
          MOVE      DNO,DANS8
          LOAD      DANS8,HEAUSR1,DYES,DNO
.
          MOVE      DNO,DANS9
          LOAD      DANS9,HEAUSRM1,DYES,DNO
.
          MOVE      DSYST0,DSYST
          LOAD      DSYST,AECNLABL,DSYST1,DSYST2,DSYST3,DSYST4,DSYST5,DSYST6:
                                   DSYST7,DSYST8,DSYST9,DSYST10
.
          LOAD      DLSIZE,HELSIZE,DLSIZE1,DLSIZE2
.
          READ      CONTROLF,TEN9;*142,CHUSR1,CHDESC1,CHMAN1:
                                  *164,CHUSR2,CHDESC2,CHMAN2:
                                  *186,CHUSR3,CHDESC3,CHMAN3
          MOVE      DNO,DANS1
          LOAD      DANS1,CHUSR1,DYES,DNO
.
          MOVE      DNO,DANS2
          LOAD      DANS2,CHMAN1,DYES,DNO
.
          MOVE      DNO,DANS4
          LOAD      DANS4,CHUSR2,DYES,DNO
.
          MOVE      DNO,DANS5
          LOAD      DANS5,CHMAN2,DYES,DNO
.
          MOVE      DNO,DANS6
          LOAD      DANS6,CHUSR3,DYES,DNO
.
          MOVE      DNO,DANS7
          LOAD      DANS7,CHMAN3,DYES,DNO
.
          MOVE      COMDIG0,COMDIG
          LOAD      COMDIG,HCOMDIG,COMDIG1,COMDIG2
.
          MOVE      DNO,DANS10                          * situation (y/n)
          LOAD      DANS10,HSITN,DYES,DNO
.
          MOVE      SP20,TDESC
          MATCH     SP2,AECNPLOC
          IF        !@EQUAL
            PACK      KEY5,AECNPLOC,SP3
            CALL      RDCODE1
            IF        OVRCD = 1
              MOVE      "Unknown Category",TDESC
            ENDIF
          ENDIF
.
          MOVE      DNO,DANS11                          * using Eltron
          LOAD      DANS11,AECNAELT,DYES
.
          DISPLAY   *P54:2,*V2LON,"- User Screen 1 ",*P1:3,*EF,*HOFF:
                    *P1:4," 1. Emergency Labels - No Across Page        :":
                    *P1:5," 2. Emergency Labels - No to Print           :":
                    *P1:6," 3. Using MR-5 Forms             (Y/N)       :":
                    *P1:7," 4. Emerg. Label Size used in Hospital       :":
                    *P1:8," 5. Using Highlight Code 1       (Y/N)       :":
                    *P1:9," 6.                   Mandatory  (Y/N)       :":
                    *P1:10," 7. Using Highlight Code 2       (Y/N)       :":
                    *P1:11," 8.                   Mandatory  (Y/N)       :":
                    *P1:12," 9. Using Highlight Code 3       (Y/N)       :":
                    *P1:13,"10.                   Mandatory  (Y/N)       :":
                    *P1:14,"11. Using User Defined Code1 - U1(Y/N)       :":
                    *P1:15,"12.                   Description            :":
                    *P1:16,"13.                   Mandatory  (Y/N)       :":
                    *P1:17,"14. Label Type Used in Hospital              :":
                    *P1:18,"15. Description on Invoice                   :":
                    *P1:19,"16. Using Completion or Diagnosis code       :":
                    *P1:20,"17. Using Situation in Discharges(Y/N)       :":
                    *P1:21,"18. Category used for Patient Location       :":
                    *P1:22,"19. Using Eltron printer for A&E labels (Y/N):":
                    *P48:4,*V2LON,HELPAGE:
                    *P48:5,HELPRNT,*P48:6,DANS3,*P48:7,HELSIZE,*P56:7,DLSIZE:
                    *P48:8,DANS1,*P48:9,DANS2:
                    *P48:10,DANS4,*P48:11,DANS5:
                    *P48:12,DANS6,*P48:13,DANS7:
                    *P48:14,DANS8,*P48:15,HEAUSRD1,*P48:16,DANS9:
                    *P48:17,AECNLABL,*P51:17,DSYST,*P48:18,HINVDES:
                    *P48:19,HCOMDIG,*P51:19,COMDIG:
                    *P48:20,DANS10:
                    *P48:21,AECNPLOC,*P53:21,TDESC:
                    *P48:22,DANS11;
DHSA9999  RETURN
.
.*********************************************************************
.         update hospital screen A
.*********************************************************************
KHSA0000  CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      KHSA9000 IF EQUAL
          GOTO      KHSA9100 IF LESS
          BRANCH    CCITEM,KUSR11,KUSR12,KUSR13,KUSR14,KUSR15:
                           KUSR16,KUSR17,KUSR18,KUSR19,KUSR110:
                           KUSR111,KUSR112,KUSR113,KUSR114,KUSR115:
                           KUSR116,KUSR117,KUSR118,KUSR119
          BEEP
          GOTO      KHSA0000
.
KUSR11    KEYIN     *P48:4,*EL,*V2LON,HELPAGE
          COMPARE   FOUR,HELPAGE
          GOTO      EKUSR11 IF NOT LESS
          DISPLAY   *P48:4,*EL,*V2LON,HELPAGE
          GOTO      KHSA0000
.
EKUSR11   DISPLAY   *P1:24,*EL,*B,"Invalid Number of Labels.  ";
          CALL      HITENTER
          GOTO      KUSR11
.
KUSR12    KEYIN     *P48:5,*EL,*V2LON,HELPRNT
          DISPLAY   *P48:5,*EL,*V2LON,HELPRNT
          GOTO      KHSA0000
.
KUSR13    KEYIN     *P48:6,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR13Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR13N IF EQUAL
          BEEP
          GOTO      KUSR13
.
KUSR13Y   MOVE      ONE,HEPMR5
          GOTO      KUSR13DS
.
KUSR13N   MOVE      TWO,HEPMR5
.
KUSR13DS  LOAD      DANSX,HEPMR5,DYES,DNO
          DISPLAY   *P48:6,*EL,*V2LON,DANSX
          GOTO      KHSA0000
.
.         SIZE OF LABELS
.
KUSR14    DISPLAY   *P1:24,*EL,*V2LON,ONE,*HOFF,". = ",DLSIZE1:
                               *V2LON,TWO,*HOFF,". = ",DLSIZE2
          KEYIN     *P48:7,*EL,*V2LON,HELSIZE,*P1:24,*EL;
          BRANCH    HELSIZE,OKUSR14,OKUSR14
          BEEP
          GOTO      KUSR14
OKUSR14   LOAD      DLSIZE,HELSIZE,DLSIZE1,DLSIZE2
          DISPLAY   *P56:7,*V2LON,DLSIZE
          GOTO      KHSA0000
.
.         Highlight code 1 : used ? (Y/N)
.
KUSR15    KEYIN     *P48:8,*EL,*V2LON,ANS;        **ns**  highlight codes
          CMATCH    ANSY,ANS                      **ns    1,2 3 and descrip.
          GOTO      KUSR15Y IF EQUAL              **ns    and mandatories.
          CMATCH    ANSN,ANS
          GOTO      KUSR15N IF EQUAL
          BEEP
          GOTO      KUSR15
KUSR15Y   MOVE      ONE,CHUSR1
          GOTO      KUSR15S
KUSR15N   MOVE      ZERO,CHUSR1
KUSR15S   MOVE      DNO,DANS
          LOAD      DANS,CHUSR1,DYES,DNO
          DISPLAY   *P48:8,*V2LON,DANS
          GOTO      KHSA0000
.
.         Highlight code 1 : mandatory ? (Y/N)
.
KUSR16    KEYIN     *P48:9,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR16Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR16N IF EQUAL
          BEEP
          GOTO      KUSR16
KUSR16Y   MOVE      ONE,CHMAN1
          GOTO      KUSR16S
KUSR16N   MOVE      ZERO,CHMAN1
KUSR16S   MOVE      DNO,DANS
          LOAD      DANS,CHMAN1,DYES,DNO
          DISPLAY   *P48:9,*EL,*V2LON,DANS
          GOTO      KHSA0000
.
.         Highlight code 2 : used ? (Y/N)
.
KUSR17    KEYIN     *P48:10,*EL,*V2LON,ANS;       **ns**  highlight codes
          CMATCH    ANSY,ANS                      **ns    1,2 3 and descrip.
          GOTO      KUSR17Y IF EQUAL              **ns    and mandatories.
          CMATCH    ANSN,ANS
          GOTO      KUSR17N IF EQUAL
          BEEP
          GOTO      KUSR17
KUSR17Y   MOVE      ONE,CHUSR2
          GOTO      KUSR17S
KUSR17N   MOVE      ZERO,CHUSR2
KUSR17S   MOVE      DNO,DANS
          LOAD      DANS,CHUSR2,DYES,DNO
          DISPLAY   *P48:10,*V2LON,DANS
          GOTO      KHSA0000
.
.         Highlight code 2 : mandatory ? (Y/N)
.
KUSR18    KEYIN     *P48:11,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR18Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR18N IF EQUAL
          BEEP
          GOTO      KUSR18
KUSR18Y   MOVE      ONE,CHMAN2
          GOTO      KUSR18S
KUSR18N   MOVE      ZERO,CHMAN2
KUSR18S   MOVE      DNO,DANS
          LOAD      DANS,CHMAN2,DYES,DNO
          DISPLAY   *P48:11,*EL,*V2LON,DANS
          GOTO      KHSA0000
.
.         Highlight code 3 : used ? (Y/N)
.
KUSR19    KEYIN     *P48:12,*EL,*V2LON,ANS;       **ns**  highlight codes
          CMATCH    ANSY,ANS                      **ns    1,2 3 and descrip.
          GOTO      KUSR19Y IF EQUAL              **ns    and mandatories.
          CMATCH    ANSN,ANS
          GOTO      KUSR19N IF EQUAL
          BEEP
          GOTO      KUSR19
KUSR19Y   MOVE      ONE,CHUSR3
          GOTO      KUSR19S
KUSR19N   MOVE      ZERO,CHUSR3
KUSR19S   MOVE      DNO,DANS
          LOAD      DANS,CHUSR3,DYES,DNO
          DISPLAY   *P48:12,*V2LON,DANS
          GOTO      KHSA0000
.
.         Highlight code 3 : mandatory ? (Y/N)
.
KUSR110   KEYIN     *P48:13,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR110Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR110N IF EQUAL
          BEEP
          GOTO      KUSR110
KUSR110Y  MOVE      ONE,CHMAN3
          GOTO      KUSR110S
KUSR110N  MOVE      ZERO,CHMAN3
KUSR110S  MOVE      DNO,DANS
          LOAD      DANS,CHMAN3,DYES,DNO
          DISPLAY   *P48:13,*EL,*V2LON,DANS
          GOTO      KHSA0000                                **ns**
.
.         Using User defined code U1
.
KUSR111   KEYIN     *P48:14,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR111Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR111N IF EQUAL
          BEEP
          GOTO      KUSR111
KUSR111Y  MOVE      ONE,HEAUSR1
          GOTO      KUSR111S
KUSR111N  MOVE      ZERO,HEAUSR1
KUSR111S  MOVE      DNO,DANS
          LOAD      DANS,HEAUSR1,DYES,DNO
          DISPLAY   *P48:14,*EL,*V2LON,DANS
          GOTO      KHSA0000
.
.         User defined field 1 (CAT U1) description
.
KUSR112   MOVE      SP20,HEAUSRD1
          KEYIN     *P48:15,*EL,*V2LON,HEAUSRD1
          GOTO      KHSA0000
.
.         User defined field 1 (mandatory option)
.
KUSR113   KEYIN     *P48:16,*EL,*V2LON,ANS
          CMATCH    ANSY,ANS
          GOTO      KUSR113Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR113N IF EQUAL
          BEEP
          GOTO      KUSR113
KUSR113Y  MOVE      ONE,HEAUSRM1
          GOTO      KUSR113S
KUSR113N  MOVE      ZERO,HEAUSRM1
KUSR113S  MOVE      DNO,DANS
          LOAD      DANS,HEAUSRM1,DYES,DNO
          DISPLAY   *P48:16,*EL,*V2LON,DANS
          GOTO      KHSA0000
.
.         Label type used in hospital
.
KUSR114   DISPLAY   *P1:23,*EF:
                    *V2LON," 0",*HOFF,"=Priv. Aust.":
                    *V2LON," 1",*HOFF,"=MOD, ":
                    *V2LON," 2",*HOFF,"=WEL, ":
                    *V2LON," 3",*HOFF,"=New Zeald. ":
                    *V2LON," 4",*HOFF,"=H.K. ":
                    *V2LON," 5",*HOFF,"=HAW, ":
                    *V2LON," 6",*HOFF,"=THC, ":
                    *V2LON," 7",*HOFF,"=PMB, ":
                    *P1:24,*V2LON," 8",*HOFF,"=MCH, ":
                    *V2LON," 9",*HOFF,"=STV, ":
                    *V2LON,"10",*HOFF,"=SJOG Geelong";
          KEYIN     *P48:17,*EL,*V2LON,AECNLABL,*P1:23,*EF
          BRANCH    AECNLABL,EKUSR114,EKUSR114,EKUSR114,EKUSR114,EKUSR114:
                             EKUSR114,EKUSR114,EKUSR114,EKUSR114,EKUSR114
          COMPARE   ZERO,AECNLABL
          GOTO      EKUSR114 IF EQUAL
          BEEP
          GOTO      KUSR114
.
EKUSR114  MOVE      DSYST0,DSYST
          LOAD      DSYST,AECNLABL,DSYST1,DSYST2,DSYST3,DSYST4,DSYST5,DSYST6:
                                   DSYST7,DSYST8,DSYST9,DSYST10
          DISPLAY   *P51:17,*V2LON,DSYST
          GOTO      KHSA0000
.
KUSR115   MOVE      SP30,HINVDES
          KEYIN     *P48:18,*EL,*V2LON,HINVDES
          GOTO      KHSA0000
.
KUSR116   DISPLAY   *P48:19,*EL,*P51:19,"0=Comp, 1=Diag, 2=Neither";
          KEYIN     *P48:19,*V2LON,FORM1
          ADD       ONE,FORM1
          BRANCH    FORM1,KUSR116Y,KUSR116Y,KUSR116Y
          BEEP
          GOTO      KUSR116
.
KUSR116Y  SUB       ONE,FORM1
          MOVE      FORM1,HCOMDIG
          MOVE      COMDIG0,COMDIG
          LOAD      COMDIG,HCOMDIG,COMDIG1,COMDIG2
          DISPLAY   *P48:19,*EL,*V2LON,HCOMDIG,*P57:19,COMDIG
          GOTO      KHSA0000
.
KUSR117   KEYIN     *P48:20,*EL,*V2LON,ANS;
          CMATCH    ANSY,ANS
          GOTO      KUSR117Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR117N IF EQUAL
          BEEP      
          GOTO      KUSR117
KUSR117Y  MOVE      ONE,HSITN
          GOTO      KUSR117S
KUSR117N  MOVE      ZERO,HSITN
KUSR117S  MOVE      DNO,DANS10
          LOAD      DANS10,HSITN,DYES,DNO
          DISPLAY   *P48:20,*EL,*V2LON,DANS10;
          GOTO      KHSA0000 
.
.         Input Category for patient location (A1 - A5 valid)
.
KUSR118   KEYIN     *P48:21,*EL,*DV,UNDLN2:
                    *P48:21,*V2LON,AECNPLOC:
                    *P48:21,*DV,AECNPLOC
.
          PACK      AECNPLOC,AECNPLOC,SP3        * pack with spaces
          MATCH     SP3,AECNPLOC                 * anything entered ?
          GOTO      KHSA0000 IF EQUAL            * no
.
          CMATCH    ANSA,AECNPLOC                * first character "A" ?
          GOTO      KHSA118E IF NOT EQUAL        * no - error
.
          BUMP      AECNPLOC                     * position on second character
          TYPE      AECNPLOC                     * character a numeric ?
          GOTO      KHSA118E IF NOT EQUAL        * no - error
.
          MOVE      AECNPLOC,FORM1               * move to form field
          IF        FORM1 < 1 | FORM1 > 5
            GOTO      KHSA118E                   * number out of range
          ENDIF
.
.         Valid category entered, so make sure category is set up
.
          RESET     AECNPLOC
          PACK      KEY5,AECNPLOC,SP3
          CALL      RDCODE1
          IF        OVRCD = 1
            DISPLAY   *P1:24,*EL,*B,"Category ",AECNPLOC," not set up.  ";
            CALL      HITENTER
            GOTO      KHSA0000
          ENDIF 
.
          DISPLAY   *P53:21,*V2LON,TDESC
          GOTO      KHSA0000
.
.         Invalid category entered
.
KHSA118E  DISPLAY   *P1:24,*EL,*B,"Must be Cat A1 - A5.  ";
          CALL      HITENTER
          GOTO      KUSR118
.
KUSR119   KEYIN     *P48:22,*EL,*V2LON,ANS;
          CMATCH    ANSY,ANS
          GOTO      KUSR119Y IF EQUAL
          CMATCH    ANSN,ANS
          GOTO      KUSR119N IF EQUAL
          BEEP      
          GOTO      KUSR119
KUSR119Y  MOVE      ONE,AECNAELT
          GOTO      KUSR119S
KUSR119N  MOVE      ZERO,AECNAELT
KUSR119S  MOVE      DNO,DANS11
          LOAD      DANS11,AECNAELT,DYES
          DISPLAY   *P48:22,*EL,*V2LON,DANS11;
          GOTO      KHSA0000 
.
KHSA9000  MOVE      ZERO,EXIT
          GOTO      KHSA9999
KHSA9100  MOVE      ONE,EXIT
KHSA9999  RETURN
+
.*********************************************************************
.         write USER SCREEN
.*********************************************************************
WHSA0000  WRITAB    CONTROLF,THIRTY;*89,HELPAGE,HELPRNT,HELSIZE,HEPMR5:
                                    *110,HEAUSR1,HEAUSRD1,HEAUSRM1:
                                    *133,HINVDES,*164,HCOMDIG,*194,HSITN
          WRITAB    CONTROLF,TEN9;*142,CHUSR1,CHDESC1,CHMAN1:
                                  *164,CHUSR2,CHDESC2,CHMAN2:
                                  *186,CHUSR3,CHDESC3,CHMAN3
          WRITAB    CONTROLF,SEVENTY8;*29,AECNPLOC,*35,AECNAELT,*64,AECNLABL
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
WHSA9999  RETURN
+
.*********************************************************************
.         User Screen 2
.*********************************************************************
DHSB0000  READ      CONTROLF,THIRTY;*165,HNONRES,*168,HNUMDES,*177,HPRINV:
                             *186,HEMR5L,HEMR5COD,AECNCASE,*197,AEALERT:
                             *198,AECNUPVS,AECNUBRD,*201,AECNSITM,*204,AECNDFDC:
                             *208,AECNDXPA,AECNDXPB,AECNDXPC,AECNDXPD
          READ      CONTROLF,SEVENTY8;*1,AECNDFCL,*5,AECNWIDS,AECNDXPE:
                             *31,AECNDPVI,AECNPTRI
          STRIP     HNUMDES
          MOVE      DNO,DANS11
          LOAD      DANS11,HPRINV,DYES,DNO
.
          MOVE      LAYTYP1,LAYOUT
          LOAD      LAYOUT,HEMR5L,LAYTYP2
.
          MOVE      CASE0,CASETYPE
          LOAD      CASETYPE,AECNCASE,CASE1
.
          MOVE      DNO,DANS12
          LOAD      DANS12,AEALERT,DYES
.
          MOVE      DNO,DANS1
          LOAD      DANS1,AECNUPVS,DYES,DNO
.
          MOVE      DNO,DANS2
          LOAD      DANS2,AECNUBRD,DYES,DNO
.
          MOVE      DNO,DANS3
          LOAD      DANS3,AECNSITM,DYES,DNO
.
          MOVE      DNO,DANS4
          LOAD      DANS4,AECNWIDS,DYES,DNO
.
          MOVE      SP20,TDESCA
          PACK      KEY5,ANSC,ANSL,SP3
          CALL      RDCODE1
          MOVE      TDESC,TDESCA
.
          MOVE      SP20,TDESCB
          MOVE      SP20,TDESC 
          PACK      KEY5,ANSE,ANSP,SP3     
          CALL      RDCODE1
          MOVE      TDESC,TDESCB
          MOVE      SP20,EPDESC
          MOVE      SP20,TDESC
          MATCH     SP3,AECNDPVI
          IF        !@EQUAL
            PACK      KEY5,ANSE,ANSP,AECNDPVI
            CALL      RDCODE1
            IF        OVRCD =0
              MOVE      TDESC,EPDESC
            ENDIF
          ENDIF
.
          MOVE      SP20,TDESC
          MATCH     SP3,AECNDFDC
          IF        !@EQUAL
            PACK      KEY5,ANSA,SP1,AECNDFDC
            CALL      RDCODE1
          ENDIF
.
          MOVE      DNO,DANS5
          LOAD      DANS5,AECNPTRI,DYES
.
          DISPLAY   *P54:2,*V2LON,"- User Screen 2 ",*P1:3,*EF,*HOFF:
                    *P1:04," 1. No. Years for Non - Charging      :":
                    *P1:05," 2. Description for system number     :":
                    *P1:06," 3. Print Invoice at Discharge  (Y/N) :":
                    *P1:07," 4. Layout for MR5                    :":
                    *P1:08," 5. User Defined Stationery Code (MR5):":
                    *P1:09," 6. Setting of case notes indicator   :":
                    *P1:10," 7. Input Alert in IBAAAE01     (Y/N) :":
                    *P1:11," 8. Using previous no. of visits(Y/N) :":
                    *P1:12," 9. Using board                 (Y/N) :":
                    *P1:13,"10. Situation code Mandatory?   (Y/N) :":
                    *P1:14,"11. Default Department code           :":
                    *P1:15,"12. Priority One description          :":
                    *P1:16,"13. Priority Two description          :":
                    *P1:17,"14. Priority Three description        :":
                    *P1:18,"15. Priority Four description         :":
                    *P1:19,"16. Priority Five description         :":
                    *P1:20,"17. Default for ",TDESCA,"  : ":
                    *P1:21,"18. Give Id Sheet print Warning (Y/N) :":
                    *P1:22,"19. Default for ",TDESCB,"  : ":         
                    *P1:23,"20. Print Triage in Cont. Log   (Y/N) :":         
                    *P41:4,*V2LON,HNONRES:
                    *P41:5,HNUMDES,*P41:6,DANS11:
                    *P41:7,HEMR5L,*P50:7,*HOFF,LAYOUT:
                    *P41:8,*V2LON,HEMR5COD:
                    *P41:9,AECNCASE,*HOFF,*P50:9,CASETYPE:
                    *P41:10,*V2LON,DANS12,*P41:11,DANS1,*P41:12,DANS2:
                    *P41:13,DANS3,*P41:14,AECNDFDC,SP2,*HOFF,TDESC,*V2LON:
                    *P41:15,AECNDXPA,*P41:16,AECNDXPB,*P41:17,AECNDXPC:
                    *P41:18,AECNDXPD,*P41:19,AECNDXPE:
                    *P41:20,AECNDFCL,*P41:21,DANS4:
                    *P41:22,AECNDPVI,SP2,*HOFF,EPDESC:
                    *P41:23,*V2LON,DANS5
DHSB9999  RETURN
.
.*********************************************************************
.         update hospital screen 2
.*********************************************************************
KHSB0000  CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      KHSB9000 IF EQUAL
          GOTO      KHSB9100 IF LESS
          BRANCH    CCITEM,KUSR21,KUSR22,KUSR23,KUSR24,KUSR25:
                           KUSR26,KUSR27,KUSR28,KUSR29,KUS21000:
                           KUS22000,KHSB1200,KHSB1300,KHSB1400,KHSB1500:
                           KHSB1600,KHSB1700,KHSB1800,KHSB1900,KHSB2000
          BEEP
          GOTO      KHSB0000
.
KUSR21    KEYIN     *P41:4,*EL,*V2LON,HNONRES:
                    *P41:4,*DV,HNONRES
          GOTO      KHSB0000
.
KUSR22    MOVE      SP10,HNUMDES
          KEYIN     *P41:5,*EL,*V2LON,HNUMDES
          GOTO      KHSB0000
.
KUSR23    KEYIN     *P41:6,*EL,*V2LON,ANS
          CMATCH    "Y",ANS
          GOTO      KUSR23Y IF EQUAL
          CMATCH    "N",ANS
          GOTO      KUSR23N IF EQUAL
          BEEP
          GOTO      KUSR23
KUSR23Y   MOVE      ONE,HPRINV
          GOTO      KUSR23D
KUSR23N   MOVE      TWO,HPRINV
KUSR23D   MOVE      DNO,DANS11
          LOAD      DANS11,HPRINV,DYES,DNO
          DISPLAY   *P41:6,*EL,*V2LON,DANS11
          GOTO      KHSB0000
.
KUSR24    MOVE      ZERO,HEMR5L
          MOVE      SP20,LAYOUT
          DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF," = Modbury, ":
                               *V2LON,ONE,*HOFF," = User Defined";
          KEYIN     *P41:7,*EL,*DV,UNDLN1:
                    *P41:7,*V2LON,*RV,HEMR5L:
                    *P41:7,*DV,HEMR5L;
          COMPARE   ZERO,HEMR5L
          GOTO      KUSR24Y IF EQUAL
          BRANCH    HEMR5L,KUSR24Y
          BEEP
          GOTO      KUSR24
.
KUSR24Y   MOVE      LAYTYP1,LAYOUT
          LOAD      LAYOUT,HEMR5L,LAYTYP2
          DISPLAY   *P50:7,LAYOUT;
          GOTO      KHSB0000
.
KUSR25    MOVE      SP6,HEMR5COD
          KEYIN     *P41:8,*EL,*DV,UNDLN6:
                    *P41:8,*V2LON,*RV,HEMR5COD:
                    *P41:8,*DV,HEMR5COD;
          ENDSET    HEMR5COD
          APPEND    SP6,HEMR5COD
          RESET     HEMR5COD
          MATCH     SP6,HEMR5COD
          GOTO      KUSR25Y IF EQUAL
          MOVE      HEMR5COD,KEY6
          CALL      RDIBTH1
          BRANCH    OVRCD,KUSR25N
.
          COMPARE   TWO,IBTHSTFM
          GOTO      KUSR25Y IF EQUAL
.
          DISPLAY   *P1:24,*EL,*B,"Stationery Code is an incorrect type":
                    " - Hit <",*V2LON,"ENTER",*HOFF,"> to continue";
          KEYIN     ANS;
          DISPLAY   *P1:24,*EL;
          GOTO      KUSR25
.
KUSR25N   DISPLAY   *P1:24,*EL,*B,"Stationery Code not on file - Hit <":
                    *V2LON,"ENTER",*HOFF,"> to continue";
          KEYIN     ANS;
          DISPLAY   *P1:24,*EL;
          GOTO      KUSR25
.
KUSR25Y   MOVE      ZERO,OVRCD
          GOTO      KHSB0000
.
KUSR26    MOVE      ZERO,AECNCASE
          MOVE      SP30,CASETYPE
          DISPLAY   *P1:24,*EL,*V2LON,ZERO,*HOFF,"=",CASE0,", ":
                               *V2LON,ONE,*HOFF,"=",CASE1;
          KEYIN     *P41:9,*EL,*DV,UNDLN1:
                    *P41:9,*V2LON,AECNCASE:
                    *P41:9,*DV,AECNCASE;
          COMPARE   ZERO,AECNCASE
          GOTO      KUSR26Y IF EQUAL
          BRANCH    AECNCASE,KUSR26Y
          BEEP
          GOTO      KUSR26
.
KUSR26Y   MOVE      CASE0,CASETYPE
          LOAD      CASETYPE,AECNCASE,CASE1
          DISPLAY   *P50:9,CASETYPE;
          GOTO      KHSB0000
.
KUSR27    KEYIN     *P41:10,*EL,*V2LON,ANS
          CMATCH    "Y",ANS
          GOTO      KUSR27Y IF EQUAL
          CMATCH    "N",ANS
          GOTO      KUSR27N IF EQUAL
          BEEP
          GOTO      KUSR27
KUSR27Y   MOVE      ONE,AEALERT
          GOTO      KUSR27D
KUSR27N   MOVE      TWO,AEALERT
KUSR27D   MOVE      DNO,DANS12
          LOAD      DANS12,AEALERT,DYES,DNO
          DISPLAY   *P41:10,*EL,*V2LON,DANS12
          GOTO      KHSB0000
.
KUSR28    KEYIN     *P41:11,*EL,*V2LON,ANS
          REP       UPPLOW,ANS
.
          CMATCH    ANSY,ANS
          GOTO      KUSR28Y IF EQUAL
.
          CMATCH    ANSN,ANS
          GOTO      KUSR28N IF EQUAL
.
          BEEP
          GOTO      KUSR28
.
KUSR28Y   MOVE      ONE,AECNUPVS
          GOTO      KUSR28D
.
KUSR28N   MOVE      ZERO,AECNUPVS
.
KUSR28D   MOVE      DNO,DANS1
          LOAD      DANS1,AECNUPVS,DYES,DNO
          DISPLAY   *P41:11,*EL,*V2LON,DANS1
          GOTO      KHSB0000
.
KUSR29    MOVE      "41",CCOL
          MOVE      "12",CVERT
          CALL      KYN0000
          MOVE      EXIT,AECNUBRD
          GOTO      KHSB0000
.
KUS21000  MOVE      "41",CCOL
          MOVE      "13",CVERT
          CALL      KYN0000
          MOVE      EXIT,AECNSITM
          GOTO      KHSB0000
.
.  Default Department code
.
KUS22000  MOVE      "41",ECOL
          MOVE      "14",EVERT
          MOVE      "A ",CODE
          MOVE      SP3,CKYIDEF3
          MOVE      ZERO,CKYIMAND
.
          CALL      PATCODKY
          IF        EXIT=2
            GOTO      KUS22000
          ENDIF
.
          MOVE      ACODE,AECNDFDC                * default code
          DISPLAY   *P46:14,TDESC
          GOTO      KHSB0000
.
.         priority one description
.
KHSB1200  KEYIN     *P41:15,*V2LON,AECNDXPA
          PACK      AECNDXPA,AECNDXPA,SP10
          GOTO      KHSB0000
.
.         priority two description
.
KHSB1300  KEYIN     *P41:16,*V2LON,AECNDXPB
          PACK      AECNDXPB,AECNDXPB,SP10
          GOTO      KHSB0000
.
.         priority three description
.
KHSB1400  KEYIN     *P41:17,*V2LON,AECNDXPC
          PACK      AECNDXPC,AECNDXPC,SP10
          GOTO      KHSB0000
.
.         priority four description
.
KHSB1500  KEYIN     *P41:18,*V2LON,AECNDXPD
          PACK      AECNDXPD,AECNDXPD,SP10
          GOTO      KHSB0000
.
.         priority five description
.
KHSB1600  KEYIN     *P41:19,*V2LON,AECNDXPE
          PACK      AECNDXPE,AECNDXPE,SP10
          GOTO      KHSB0000
.
.         default admin category (Cat CL)
.
KHSB1700  MOVE      "41",ECOL
          MOVE      "20",EVERT
          MOVE      "CL",CODE
          MOVE      AECNDFCL,CKYIDEF3
          MOVE      ZERO,CKYIMAND
          CALL      PATCODKY
          IF        EXIT=2
            GOTO      KHSB0000
          ENDIF
          MOVE      ACODE,AECNDFCL                * default code
          DISPLAY   *P46:20,TDESC
          GOTO      KHSB0000
.
KHSB1800  MOVE      "41",CCOL
          MOVE      "21",CVERT
          CALL      KYN0000
          MOVE      EXIT,AECNWIDS
          GOTO      KHSB0000
.
.         default previous Visit  (Cat EP)
.
KHSB1900  MOVE      "41",ECOL
          MOVE      "22",EVERT
          MOVE      "EP",CODE
          MOVE      AECNDPVI,CKYIDEF3
          MOVE      ZERO,CKYIMAND
          CALL      PATCODKY
          IF        EXIT=2
            GOTO      KHSB0000
          ENDIF
          MOVE      ACODE,AECNDPVI                * default code
          DISPLAY   *P46:22,TDESC
          GOTO      KHSB0000
.
KHSB2000  MOVE      "41",CCOL
          MOVE      "23",CVERT
          CALL      KYN0000
          MOVE      EXIT,AECNPTRI
          GOTO      KHSB0000
.
KHSB9000  MOVE      ZERO,EXIT
          GOTO      KHSB9999
KHSB9100  MOVE      ONE,EXIT
KHSB9999  RETURN
+
.*********************************************************************
.         write Hospital Screen B
.*********************************************************************
WHSB0000  WRITAB    CONTROLF,THIRTY;*165,HNONRES,*168,HNUMDES,*177,HPRINV:
                             *186,HEMR5L,HEMR5COD,AECNCASE,*197,AEALERT:
                             *198,AECNUPVS,AECNUBRD,*201,AECNSITM,*204,AECNDFDC:
                             *208,AECNDXPA,AECNDXPB,AECNDXPC,AECNDXPD
          WRITAB    CONTROLF,SEVENTY8;*1,AECNDFCL,*5,AECNWIDS,AECNDXPE:
                                      *31,AECNDPVI,AECNPTRI
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
WHSB9999  RETURN
+
.*********************************************************************
.         User Screen 3
.*********************************************************************
DHSD0000  READ      CONTROLF,SEVENTY8;*36,AECNRQDF,AECNECSR:
                                      *40,AECNAEIH,*46,AECNAEIT
.
          MOVE      "Invalid Code ",RQDFDESC
          PACK      KEY5,CATRQ,AECNRQDF
          CALL      RDCODE1
          IF        OVRCD<>1
            MOVE      TDESC,RQDFDESC
          ENDIF
.
          LOAD      ECSRDESC,AECNECSR,ADAUSR1,ADAUSR2,ADAUSR3,ADAUSR3,ADAUSR5,ADASRC
.
          DISPLAY   *P54:2,*V2LON,"- User Screen 3 ",*P1:3,*EF,*HOFF:
                    *P1:04," 1. Default Code for Cat RQ in EOC01       :":
                    *P1:05," 2. Which field for Source of Ref in EOC01 :":
                    *P1:06," 3. User Defined A&E Invoice Header        :":
                    *P1:07," 4. User Defined A&E Invoice Tail          :":
                    *P46:4,*V2LON,AECNRQDF,*P50:4,RQDFDESC:
                    *P46:5,*V2LON,AECNECSR,*P50:5,ECSRDESC:
                    *P46:6,*V2LON,AECNAEIH:
                    *P46:7,*V2LON,AECNAEIT
.
DHSD9999  RETURN
+
.*********************************************************************
.         update hospital screen 3
.*********************************************************************
KHSD0000  CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      KHSD9000 IF EQUAL
          GOTO      KHSD9100 IF LESS
          BRANCH    CCITEM,KUSR31,KUSR32,KUSR33,KUSR34
          BEEP
          GOTO      KHSD0000
.
KUSR31    DISPLAY   *P50:4,*EL
          MOVE      "46",ECOL
          MOVE      "4",EVERT
          MOVE      CATRQ,CODE
          MOVE      ONE,CKYIMAND
          CALL      PATCODKY
          IF        EXIT=2
            GOTO      KUSR31
          ENDIF
.
          MOVE      ACODE,AECNRQDF
          PACK      KEY5,CATRQ,AECNRQDF
          CALL      RDCODE1
          IF        OVRCD=1
            DISPLAY   *P50:4,*EL
            DISPLAY   *P1:24,*EL,*V2LON,"Invalid Code. ";
            CALL      HITENTER
            GOTO      KUSR31
          ENDIF
.
          MOVE      TDESC,RQDFDESC
          DISPLAY   *P46:4,*EL,*V2LON,AECNRQDF,*P50:4,RQDFDESC
          GOTO      KHSD0000
.
KUSR32    DISPLAY   *P1:24,*EL,"1=ADAUSR1, 2=ADAUSR2, 3=ADAUSR3, 4=ADAUSR4, ":
                                "5=ADAUSR5, 6=ADASRC"
          KEYIN     *P46:5,*EL,*V2LON,AECNECSR
          IF        AECNECSR<0|AECNECSR>6
            DISPLAY   *P1:24,*EL,*V2LON,"Invalid field. ";
            CALL      HITENTER
            GOTO      KUSR32
          ENDIF
.
          LOAD      ECSRDESC,AECNECSR,ADAUSR1,ADAUSR2,ADAUSR3,ADAUSR3,ADAUSR5,ADASRC
.
          DISPLAY   *P46:5,*V2LON,AECNECSR,*P50:5,ECSRDESC
          GOTO      KHSD0000
.
KUSR33    MOVE      SP6,IBTHSCOD
          MOVE      ZERO,CKEYTYP
          MOVE      "46",CCOL
          MOVE      "6",CVERT
.
          CALL      KIBTHA00
          BRANCH    EXIT,KUSR33,KUSR331
.
          COMPARE   NINE,IBTHSTFM                * correct type ?
          IF        !@EQUAL
            DISPLAY   *P1:24,*EL,*B,*V2LON:
                      "Stationery Code is an invalid type.  ";
            CALL      HITENTER
            GOTO      KUSR33
          ENDIF
.
          MOVE      IBTHSCOD,AECNAEIH
KUSR331   GOTO      KHSD0000
.
KUSR34    MOVE      SP6,IBTHSCOD
          MOVE      ZERO,CKEYTYP
          MOVE      "46",CCOL
          MOVE      "7",CVERT
.
          CALL      KIBTHA00
          BRANCH    EXIT,KUSR34,KUSR341
.
          COMPARE   TEN,IBTHSTFM                * correct type ?
          IF        !@EQUAL
            DISPLAY   *P1:24,*EL,*B,*V2LON:
                      "Stationery Code is an invalid type.  ";
            CALL      HITENTER
            GOTO      KUSR34
          ENDIF
.
          MOVE      IBTHSCOD,AECNAEIT
KUSR341   GOTO      KHSD0000
.
KHSD9000  MOVE      ZERO,EXIT
          GOTO      KHSD9999
KHSD9100  MOVE      ONE,EXIT
KHSD9999  RETURN
+
.*********************************************************************
.         write Hospital Screen 3
.*********************************************************************
WHSD0000  WRITAB    CONTROLF,SEVENTY8;*36,AECNRQDF,AECNECSR:
                                      *40,AECNAEIH,*46,AECNAEIT
.
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
WHSD9999  RETURN
+
.*********************************************************************
.         display hospital screen C
.*********************************************************************
DHSC0000  READ      CONTROLF,THIRTY;*100,HEUSR1,HEUSR2,HEUSR3,HEUSR4,HEUSR5:
                                    HEMAND1,HEMAND2,HEMAND3,HEMAND4,HEMAND5
          DISPLAY   *P1:3,*EF:
                    *P1:4," 1.User Fields Cata A1 :":
                    *P1:5," 2.                 A2 :":
                    *P1:6," 3.                 A3 :":
                    *P1:7," 4.                 A4 :":
                    *P1:8," 5.                 A5 :":
                    *P41:4," 6. Mandatory Field  1 :":
                    *P41:5," 7.                  2 :":
                    *P41:6," 8.                  3 :":
                    *P41:7," 9.                  4 :":
                    *P41:8,"10.                  5 :"
.
          MOVE      ZERO,FORM2
          MOVE      THREE,CVERT
          MOVE      "26",CCOL
.
DHSC1000  ADD       ONE,FORM2
          ADD       ONE,CVERT
          COMPARE   "11",FORM2
          GOTO      DHSC9999 IF EQUAL
.
          COMPARE   "9",CVERT
          GOTO      DHSC2000 IF LESS
.
          MOVE      FOUR,CVERT
          MOVE      "66",CCOL
.
DHSC2000  LOAD      CCITEM,FORM2,HEUSR1,HEUSR2,HEUSR3,HEUSR4,HEUSR5:
                                 HEMAND1,HEMAND2,HEMAND3,HEMAND4,HEMAND5
          MOVE      DNO,DANSX
          LOAD      DANSX,CCITEM,DYES
          DISPLAY   *PCCOL:CVERT,*V2LON,DANSX;
          GOTO      DHSC1000
.
DHSC9999  RETURN
+
.*********************************************************************
.         update user defined screen
.*********************************************************************
KHSC0000  CALL      MAINQST
          COMPARE   ZERO,CCITEM
          GOTO      KHSC9000 IF EQUAL
          GOTO      KHSC9100 IF LESS
          COMPARE   "11",CCITEM
          GOTO      KHSC1500 IF NOT LESS
.
          MOVE      THREE,CVERT
          MOVE      "26",CCOL
          ADD       CCITEM,CVERT
          COMPARE   "9",CVERT
          GOTO      KHSC1000 IF LESS
.
          MOVE      "66",CCOL
          SUB       "5",CVERT
.
KHSC1000  KEYIN     *PCCOL:CVERT,*DV,UNDLN3,*PCCOL:CVERT,*V2LON,ANS;
          CMATCH    ANSY,ANS
          GOTO      KHSC2000 IF EQUAL
          GOTO      KHSC2500
KHSC1500  BEEP
          GOTO      KHSC0000
KHSC2000  MOVE      DYES,DANSX
          MOVE      ONE,FORM1
          GOTO      KHSC3000
KHSC2500  MOVE      DNO,DANSX
          MOVE      TWO,FORM1
.
KHSC3000  STORE     FORM1,CCITEM,HEUSR1,HEUSR2,HEUSR3,HEUSR4,HEUSR5:
                                 HEMAND1,HEMAND2,HEMAND3,HEMAND4,HEMAND5
          DISPLAY   *PCCOL:CVERT,*V2LON,DANSX
          GOTO      KHSC0000
.
KHSC9000  MOVE      ZERO,EXIT
          GOTO      KHSC9999
KHSC9100  MOVE      ONE,EXIT
KHSC9999  RETURN
+
.*********************************************************************
.         write hospital screen C
.*********************************************************************
WHSC0000  WRITAB    CONTROLF,THIRTY;*100,HEUSR1,HEUSR2,HEUSR3,HEUSR4,HEUSR5:
                                    HEMAND1,HEMAND2,HEMAND3,HEMAND4,HEMAND5
          DISPLAY   *P60:24,*EL,*V2LON,"*** Posted ***",*W2;
WHSC9999  RETURN
.
.*********************************************************************
.                   KYN0000
.         Yes/No standard keyin
.*********************************************************************
KYN0000  KEYIN      *PCCOL:CVERT,*DV,SP3:    * clear previous display
                    *PCCOL:CVERT,*DV,UNDLN1:
                    *PCCOL:CVERT,*V2LON,ANS:
                    *PCCOL:CVERT,*DV,ANS;
.
          TYPE      ANS                      * check if a number was input
          GOTO      KYN9000 IF EQUAL         * yes, invalid
.
          REP       "Y1y1N0n0",ANS           * convert valid answers to numerics
.
          TYPE      ANS                      * check if now a number
          GOTO      KYN9000 IF NOT EQUAL     * no, invalid
.
          MOVE      ANS,EXIT                 * set exit to Y/N value
.
          MOVE      DNO,DANS1                * assume answer was "No "
          LOAD      DANS1,EXIT,DYES,DNO      * unless otherwise stated
.
          DISPLAY   *PCCOL:CVERT,*V2LON,DANS1
          GOTO      KYN9999
.
KYN9000   BEEP
          GOTO      KYN0000
.
KYN9999   RETURN
+
          INC       STD001IO
          INC       STDHLPCD
          INC       IBASECUR                * Keyin IBA screen security passwd
          INC       IBATMHKY
          INC       PATCODKY
          INC       PATHSPKY
          INC       IBATMHIO/INC
          INC       PATCODIO/INC
          INC       PATHSPIO/INC
...........................................................................
