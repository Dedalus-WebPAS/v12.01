. ************************************************************
. *                P R O G R A M  S U M M A R Y              *
. *                - - - - - - -  - - - - - - -              *
. *                                                          *
. *     PROGRAM NAME:          MASTER                        *
. *                                                          *
. *     FUNCTION:              MASTER RETURN PROGRAM IF ERROR*
. *                                                          *
. *     AUTHOR:                M.HAYSE (I.B.A)               *
. *                                                          *
. *     WRITTEN:               08/03/88                      *
. *                                                          *
. *     MODIFICATIONS:                                       *
. *                                                          *
. *                     V5.01.01 05/04/90 PAUL BLACKMORE     *
. *                              Changed format of untrapped *
. *                              error message display to    *
. *                              enable UNIX/CISAM error     *
. *                              number to be displayed      *
. *       V6.01.01  01/03/1994  Graeme Williams              *
. *                 Allow for errors when in this program    *
. *                                                          *
. *                  * A T T E N T I O N *                   *
. *                  - - - - - - - - - - -                   *
. *            THIS PROGRAM IS THE PROPERTY OF               *
. *            INFORMATION BUILDERS (AUSTRALIA) PTY LTD      *
. *            AND MUST NOT BE UTILISED MODIFIED OR          *
. *            COPIED IN ANY MANNER WHATSOEVER WITHOUT       *
. *            THE EXPRESS WRITTEN PERMISSION OF             *
. *            INFORMATION BUILDERS (AUSTRALIA) PTY LTD.     *
. *                                                          *
. ************************************************************
.
. THIS IS THE MASTER PROGRAM FOR ALL PORTS
.
         INC       STD001FD
.
         INC       IBAPORFD/INC       **** PORT SCANNING
         INC       IBASYSFD/INC       **** TRACKS USERS ON SYSTEM
.
SPNAME   DIM       8
.
SP11     INIT      "           "
.
PRGNAM   INIT      "MASTER"
PRGID    INIT      "MASTER"
VERSION   INIT      "V12.01.00"
.
.        TRACK THE ERROR IF BOMBED   ANYWHERE
.
START    TRAP      ABORT IF IO
         TRAP      ENDIT IF CFAIL
         TRAP      ABORT IF FORMAT
         TRAP      ABORT IF PARITY
.
         OPEN      IBAPORT1,"ibaportf"
         OPEN      IBASYSA1,"ibasysaf"    *** SYSTEM TRACKING ERROR
.
         MOVE      ZERO,USERFLAG       ** WRITE TO SYSTEM TRACKING
         CALL      UPSYSA1             ** END OF LAST PROGRAM
.
         COMPARE   ONE,OVRCD
         CALL      WRSYSA1 IF EQUAL
.
         MATCH     SP11,ERROR
         GOTO      ABORT IF EQUAL
.
         KEYIN     *P1:24,*B,*EL,"Error: Call IBA Program is ":
                             *V2LON,*DV,SYSPROG," ",*DV,ERROR,*HOFF:
                             " Hit ",*V2LON,"<ENTER>",*HOFF:
                             " to continue ",*EOFF,ANS;
.
ABORT    CHAIN     "ANSWER"
.
ENDIT    SHUTDOWN  " "
.
        INC        IBAPORIO/INC       **** PORT SCANNING
        INC        IBASYSIO/INC       *** IO FOR SYSTEM AUDIT
.
        INC        STD001IO
.
