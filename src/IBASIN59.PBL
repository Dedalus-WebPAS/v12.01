.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.01.00"
.-------------------------------------------------------
. V10.02.01 19.05.2011 Sandra Barcham   239574
.           New printer/department table mods
.-------------------------------------------------------
. V9.09.01  24.09.2007 Sandra Barcham   CAR 147373
.           Changed Fax number from apmasfax to apmaur2
.-------------------------------------------------------
. V9.04.02  08.04.2005 Peter Vela CAR 59696
.           Changed commodity group from DIM 5 to DIM 6
. V9.04.01  26.10.2004  Mike Laming   CAR 54244
.           Re-compile for SINORDPR - changes no. lines in format "12"
.-------------------------------------------------------
. V9.03.03  13.07.2004  Steve Armstrong   CAR 51708
.           Added PATCONFD to replace SINCONFD Sector 13
. V9.03.02  13.08.2003  Mike Laming CAR 39306
.           Add SNCOSFYN functionallity to Screen 06 in RANPO000
. V9.03.01  18.03.2003  Davin Sloan Quote 15040
.           Recompiled for SINORDPR & SINORDFX (Multiple Delivery Points)
.           19.03.2003  Tonii Tang SRF 12580 (Rebound)
.           Re-added the below changes via Program Generator
.-------------------------------------------------------
. VF.09.04  30.04.2002 Tonii Tang SRF 12580 (Rebound)
.           Mods to allow for use of "\" to exit out of screen
. VF.09.03  12.04.2002 Tonii Tang SRF 12580 (Rebound- changes disappeared!!!)
.           Include new parameter SNCOSFYN - Confirm START to FINISH print
.           Checked new parameter, display appropriate message if applicable
. VF.09.02  26.03.2002 Sai HPS SRF 15893
.           Changed the print format for HPURCHP=16 in SINORDPR
.           in all the cases for part description.
.           also increased the width for quantity and cost per unit
.           Also removed IBACODFD/IO
. VF.09.01  14.02.2002 Tonii Tang SRF 12580 (Quote No: 10239-01)
.           Include new parameter SNCOSFYN - Confirm START to FINISH print
.           Checked new parameter, display appropriate message if applicable
. VF.09.B03 09.05.2001 Dave Matthews
.           Correct sender and receiver EAN codes - srf9902
. VF.09.B02 21.11.2000 Charles Handaya
.           Modification of Warehouse Security
. VF.09.B01 01.11.2000 Charles Handaya
.           Change P/O layout 10=STL, inside SINORDPR.PBL
.           from matrix printer Landscape to matrix printer Potrait
.           Added GST Unit Price in P/O Detail
.           Added Additional Comments in P/O Header
.           Quote 9871
.-------------------------------------------------------
. VF.01.05  30.10.2000 Sandra Barcham
.           Recompiled for IBACODIO & IBAPRNIO
. VF.01.04  07.09.2000 Charles Handaya
.           Fix PEG format, Stripped/Squeezed fields & delimited by "|"
. VF.01.03  11.08.2000 Charles Handaya
.           Fix PEG format
.           28.06.2000 Sandra Barcham
.           Fix tail extra line for MHG
. VF.01.02  27.06.2000 Sandra Barcham
.           Stop line wrap around for MHG
. VF.01.01  25.05.2000 Charles Handaya
.           Print 4 full COMMENTs in P/O Header for MHG instead of 2
.           19.05.2000 Charles Handaya
.           Add Export facility to write PEG format
.-------------------------------------------------------
. VF.00.10  22.03.2000 Sandra Barcham
.           Changed MHG layout to print comments
. VF.00.09  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.08  02.11.1999 Sandra Barcham
.           Change locked message to use X
. VF.00.07  02.09.1999 Sandra Barcham
.           Add in Creditor Keyword Search
.           srf 631485
. VF.00.06  16.08.1999 Sandra Barcham
.           Modify HRH purchase order for BHS
.           Modify MHG purchase order
. VF.00.05  06.08.1999 Sandra Barcham
.           Modify MHG purchase order
. VF.00.04  05.07.1999 Sandra Barcham
.           Modify MHG purchase order
. VF.00.03  02.07.1999 Sandra Barcham
.           Modify HWK purchase order
. VF.00.02  30.06.1999 Sandra Barcham
.           Modify MHG purchase order
. VF.00.01  22.05.1999 Sandra Barcham
.           New purchase Order for Mercy Health Group
.-------------------------------------------------------
COMMENT1  DIM       60
COMMENT2  DIM       60
COMMENT3  DIM       60
COMMENT4  DIM       60
DTOGST10  DIM       10
DUTPRC10  DIM       10
STRCRD    DIM       5
ENDCRD    DIM       5
STRPON    DIM       7
ENDPON    DIM       7
STRMSG    DIM       3
ENDMSG    DIM       3
F12       FORM      12
F15       FORM      15
F18P2     FORM      18.2
STRCON    DIM       3
ENDCON    DIM       3
SUPLIN1   DIM       35
SUPLIN2   DIM       35
SUPLIN3   DIM       35
SUPLIN4   DIM       35
SUPLIN5   DIM       35
FAXNUMB   DIM       30
.
COUNTING  FORM      1
D15A      DIM       15
D11       DIM       11
D12       DIM       12
D30       DIM       30
D35       DIM       35
D45A      DIM       45
D50       DIM       50
DELDET18  FORM      1
DIM15A    DIM       15
DIM15B    DIM       15
DIM30     DIM       30
DIM35     DIM       35
EARLYDEL  DIM       10
FORM3P2   FORM      3.2
FORM4P2   FORM      4.2
FORM5P2   FORM      5.2
FORM8P2   FORM      8.2
FORM12P2  FORM      12.2
HYPHEN    INIT      "-"
LINEUP    FORM      "0"
MHGPRT    DIM       9
MYCOL     FORM      2
MYVERT    FORM      2
OFFUSE    INIT      "Office Use Only: "
PEGTXTFL  FORM      5
PIPE      INIT      "|"
PNLN1     DIM       13
PNLN2     DIM       13
STARTA    INIT      "Start"
FINISH    INIT      "Finish"
STARS70   INIT      "***********************************":
                    "***********************************"
TILDA     INIT      "~"
TF7P2B    FORM      7.2
TF6P2     FORM      6.2
WVHAMESS  DIM       40
.
EXPORTFL  FILE      ASCII,FIXED=155
EXPORTFN  DIM       8
TABDELM   EQU       0x09
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN59
.   Function      :   Print Purchase Orders                   
.   Generated  On :   19/05/2011
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
          INC       APSPPDFD/INC
          INC       IBAPRNFD/INC
          INC       PATCONFD/INC
          INC       SINCCAFD/INC
          INC       SINCGAFD/INC
          INC       SINCIAFD/INC
          INC       SINCICFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINDPCFD/INC
          INC       SINNATFD/INC
          INC       SINORIFD/INC
          INC       SINPEGFD/INC
          INC       SINPOAFD/INC
          INC       SINPOBFD/INC
          INC       SINPOCFD/INC
          INC       SINPODFD/INC
          INC       SINSCDFD/INC
          INC       SINSUAFD/INC
          INC       SINTMPDF/INC
          INC       SINWARFD/INC
          INC       SINWSEFD/INC
.=========================
.Local Variable Definition
.-------------------------
FROMLAB   DIM       7 * Scr 02 Fld     4
TOLAB     DIM       7 * Scr 02 Fld     6
ORIGCODE  DIM       3 * Scr 02 Fld     7
PRTCOMP   FORM      1 * Scr 02 Fld     9
FROMPON   DIM       7 * Scr 03 Fld     4
TOPON     DIM       7 * Scr 03 Fld     5
INCPRTYN  FORM      1 * Scr 03 Fld     6
INCCOMYN  FORM      1 * Scr 03 Fld     9
FROMMSG   DIM      45 * Scr 03 Fld    11
TOMSG     DIM      45 * Scr 03 Fld    12
FROMCON   DIM      45 * Scr 03 Fld    13
TOCON     DIM      45 * Scr 03 Fld    14
CREDFROM  DIM      45 * Scr 05 Fld    15
CREDEND   DIM      45 * Scr 05 Fld    16
FORMATYP  FORM      1 * Scr 05 Fld    17
FORMDESC  DIM      20 * Scr 05 Fld    18
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN59"
PRGNAM    INIT      "Print Purchase Orders                   "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      SELPRT00
          CALL      SC00L000
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsppdaf";
          OPEN      APSPPDA1,"apsppdaf"
          MOVE      "   24",AUDTSECT
          MOVE      "201",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudga";
            OPEN      SINAUDGA,"sinaudga"
          ENDIF
          MOVE      "   24",AUDTSECT
          MOVE      "210",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudpa";
            OPEN      SINAUDPA,"sinaudpa"
          ENDIF
          MOVE      "   24",AUDTSECT
          MOVE      "210",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudpc";
            OPEN      SINAUDPC,"sinaudpc"
          ENDIF
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA1,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA2,"sinccaaf"
          DISPLAY   *P56:24,"Opening sincgaaf";
          OPEN      SINCGAA1,"sincgaaf"
          DISPLAY   *P56:24,"Opening sincgaaf";
          OPEN      SINCGAA2,"sincgaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA2,"sinciaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA3,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA1,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA2,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA3,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA4,"sincicaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA2,"sincodaf"
          DISPLAY   *P56:24,"Opening sindpcaf";
          OPEN      SINDPCA1,"sindpcaf"
          DISPLAY   *P56:24,"Opening sinoriaf";
          OPEN      SINORIA1,"sinoriaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA1,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA2,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA3,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA4,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpobaf";
          OPEN      SINPOBA1,"sinpobaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA1,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA2,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA3,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA4,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA5,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA6,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA7,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpodaf";
          OPEN      SINPODA1,"sinpodaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA1,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA2,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinscdaf";
          OPEN      SINSCDA3,"sinscdaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA2,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA3,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA2,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA1,"sinwseaf"
          DISPLAY   *P56:24,"Opening sinwseaf";
          OPEN      SINWSEA2,"sinwseaf"
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Main Screen                        
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Print Purchase Order               
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Print Orders Not Printed           
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Print Range of Purchase Orders     
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Fax Purcahse Orders                
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Export Purchase Orders             
          ENDIF
          MATCH     "06",SCRID
          IF         @EQUAL
            CALL       PS06L000   * Email/Fax/Print Purchase Orders    
          ENDIF
          RETURN
.--------------------------------
. Screen - Main Screen                        
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      ONAT0000
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Main Screen                        
.-------------------------------------------------------
CF00L000
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Main Screen                        
.--------------------------------------------------------
KY00L000
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Main Screen                        
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Main Screen                        
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Main Screen                        
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Main Screen                        
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Main Screen                        
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L107:
                            SF00L108
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          CALL      SC01L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
          CALL      SINORDPR
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L104
          CALL      SC02L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L105
          CALL      SC03L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L106
          CALL      SC04L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L107
          CALL      SC05L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L108
          CALL      SC06L000
          MOVE      ONE,EXIT
          GOTO      SF00L999
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Print Purchase Order               
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
          CALL      SETACCEP
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Print Purchase Order               
.-------------------------------------------------------
CF01L000
          MOVE      SP70,FROMCOD7
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Print Purchase Order               
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Print Purchase Order               
.---------------------------------------------------------
WP01L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Print Purchase Order               
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Print Purchase Order               
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Print Purchase Order               
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L999,PS01L999,PS01L999,PS01L101:
                            PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      FROMCOD7,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Print Purchase Order               
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L101,SF01L102,SF01L103:
                            SF01L104
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L103:
                            SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          MOVE      ZERO,EXIT
          GOTO      SF01L999
.
SF01L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SINPRT00
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF01L001
.
SF01L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCODS000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF01L103
            ENDIF
            BRANCH    EXIT,SF01L103,SF01L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF01L990 IF EQUAL
          ENDIF
          MOVE      FROMCOD7,VAR     
          CALL      DISPITEM
          GOTO     SF01L001
.
SF01L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SINORDLU
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF01L001
SF01L990  MOVE      FOUR,EXIT * Exit Char Exit
SF01L999  RETURN
.--------------------------------
. Screen - Print Orders Not Printed           
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC02L200
          CALL      CF02L000 * Clear Fields
          CALL      SETSCR02
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Print Orders Not Printed           
.-------------------------------------------------------
CF02L000
          MOVE      SP70,FROMLAB 
          MOVE      SP70,TOLAB   
          MOVE      SP70,ORIGCODE
          MOVE      SP70,SIORNAME
          MOVE      ZERO,PRTCOMP 
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Print Orders Not Printed           
.--------------------------------------------------------
KY02L000
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Print Orders Not Printed           
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Print Orders Not Printed           
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Print Orders Not Printed           
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Print Orders Not Printed           
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L999,PS02L999,PS02L101:
                            PS02L999,PS02L102,PS02L103,PS02L104:
                            PS02L105
          GOTO     PS02L999
.
PS02L101
          MOVE      FROMLAB,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      TOLAB,VAR        
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      ORIGCODE,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PRTCOMP,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Print Orders Not Printed           
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L104,SF02L105,SF02L106,SF02L006:
                            SF02L107
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L103:
                            SF02L020,SF02L105,SF02L106,SF02L020:
                            SF02L107
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ZERO,EXIT
          GOTO      SF02L999
.
SF02L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PROUT000
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF02L001
.
SF02L103
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCODF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L103
            ENDIF
            BRANCH    EXIT,SF02L103,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      FROMLAB,VAR      
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SINORDLU
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF02L001
.
SF02L105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KCODT000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L105
            ENDIF
            BRANCH    EXIT,SF02L105,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      TOLAB,VAR        
          CALL      DISPITEM
          GOTO     SF02L001
.
SF02L106
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIORNAME
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSIORA00
          MOVE      SIORORIG,ORIGCODE
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF02L106
            ENDIF
            BRANCH    EXIT,SF02L106,SF02L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF02L990 IF EQUAL
          ENDIF
          MOVE      ORIGCODE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIORNAME,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF02L001
.
SF02L107
          CALL      NYESNO00
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,PRTCOMP 
          CALL      CYESNO00
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      PRTCOMP,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF02L001
SF02L990  MOVE      FOUR,EXIT * Exit Char Exit
SF02L999  RETURN
.--------------------------------
. Screen - Print Range of Purchase Orders     
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC03L200
          CALL      CF03L000 * Clear Fields
          CALL      SETSCR03
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Print Range of Purchase Orders     
.-------------------------------------------------------
CF03L000
          MOVE      SP70,FROMPON 
          MOVE      SP70,TOPON   
          MOVE      ZERO,INCPRTYN
          MOVE      SP70,ORIGCODE
          MOVE      SP70,SIORNAME
          MOVE      ZERO,INCCOMYN
          MOVE      SP70,FROMMSG 
          MOVE      SP70,TOMSG   
          MOVE      SP70,FROMCON 
          MOVE      SP70,TOCON   
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Print Range of Purchase Orders     
.--------------------------------------------------------
KY03L000
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Print Range of Purchase Orders     
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Print Range of Purchase Orders     
.---------------------------------------------------------
LM03L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Print Range of Purchase Orders     
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Print Range of Purchase Orders     
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L999,PS03L999,PS03L999,PS03L101:
                            PS03L102,PS03L103,PS03L104,PS03L105:
                            PS03L106,PS03L999,PS03L107,PS03L108:
                            PS03L109,PS03L110
          GOTO     PS03L999
.
PS03L101
          MOVE      FROMPON,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      TOPON,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCPRTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      ORIGCODE,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCCOMYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L107
          MOVE      FROMMSG,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L108
          MOVE      TOMSG,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L109
          MOVE      FROMCON,VAR      
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L110
          MOVE      TOCON,VAR        
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Print Range of Purchase Orders     
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L101,SF03L102,SF03L103:
                            SF03L006,SF03L104,SF03L105,SF03L006:
                            SF03L106,SF03L107,SF03L108,SF03L006:
                            SF03L109,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L103:
                            SF03L020,SF03L104,SF03L105,SF03L020:
                            SF03L106,SF03L020,SF03L108,SF03L020:
                            SF03L109,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      PRNT0000
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF03L001
.
SF03L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOPON   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RANPO000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L103
            ENDIF
            BRANCH    EXIT,SF03L103,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      FROMPON,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOPON,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L104
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,INCPRTYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCPRTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L105
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIORNAME
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSIORA00
          MOVE      SIORORIG,ORIGCODE
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L105
            ENDIF
            BRANCH    EXIT,SF03L105,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      ORIGCODE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIORNAME,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L106
          CALL      NYESNO00
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,INCCOMYN
          CALL      CYESNO00
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCCOMYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF03L001
.
SF03L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SINORDLU
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF03L001
.
SF03L108
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOMSG   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RMESG000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L108
            ENDIF
            BRANCH    EXIT,SF03L108,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      FROMMSG,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOMSG,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
.
SF03L109
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCON   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCONF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF03L109
            ENDIF
            BRANCH    EXIT,SF03L109,SF03L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF03L990 IF EQUAL
          ENDIF
          MOVE      FROMCON,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCON,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF03L001
SF03L990  MOVE      FOUR,EXIT * Exit Char Exit
SF03L999  RETURN
.--------------------------------
. Screen - Fax Purcahse Orders                
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC04L200
          CALL      CF04L000 * Clear Fields
          CALL      SETSCR04
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Fax Purcahse Orders                
.-------------------------------------------------------
CF04L000
          MOVE      SP70,FROMPON 
          MOVE      SP70,ORIGCODE
          MOVE      ZERO,INCCOMYN
          MOVE      ZERO,INCPRTYN
          MOVE      SP70,FROMMSG 
          MOVE      SP70,FROMCON 
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Fax Purcahse Orders                
.--------------------------------------------------------
KY04L000
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Fax Purcahse Orders                
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Fax Purcahse Orders                
.---------------------------------------------------------
LM04L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Fax Purcahse Orders                
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Fax Purcahse Orders                
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L101:
                            PS04L102,PS04L999,PS04L103,PS04L104:
                            PS04L105,PS04L106,PS04L107,PS04L108:
                            PS04L109,PS04L110
          GOTO     PS04L999
.
PS04L101
          MOVE      FROMPON,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L102
          MOVE      TOPON,VAR        
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L103
          MOVE      ORIGCODE,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L104
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCCOMYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCPRTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L107
          MOVE      FROMMSG,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L108
          MOVE      TOMSG,VAR        
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L109
          MOVE      FROMCON,VAR      
          CALL      DISPITEM
          GOTO     PS04L999
.
PS04L110
          MOVE      TOCON,VAR        
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Fax Purcahse Orders                
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L101,SF04L102,SF04L103:
                            SF04L006,SF04L006,SF04L104,SF04L006:
                            SF04L105,SF04L106,SF04L107,SF04L006:
                            SF04L108,SF04L006
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L103:
                            SF04L020,SF04L020,SF04L104,SF04L020:
                            SF04L105,SF04L106,SF04L107,SF04L020:
                            SF04L108,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      FAXPO000
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF04L001
.
SF04L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOPON   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RANPO000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L103
            ENDIF
            BRANCH    EXIT,SF04L103,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      FROMPON,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOPON,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
.
SF04L104
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIORNAME
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSIORA00
          MOVE      SIORORIG,ORIGCODE
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L104
            ENDIF
            BRANCH    EXIT,SF04L104,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      ORIGCODE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIORNAME,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
.
SF04L105
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,INCCOMYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCCOMYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L106
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,INCPRTYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCPRTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF04L001
.
SF04L107
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOMSG   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RMESG000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L107
            ENDIF
            BRANCH    EXIT,SF04L107,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      FROMMSG,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOMSG,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
.
SF04L108
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCON   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCONF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF04L108
            ENDIF
            BRANCH    EXIT,SF04L108,SF04L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF04L990 IF EQUAL
          ENDIF
          MOVE      FROMCON,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCON,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF04L001
SF04L990  MOVE      FOUR,EXIT * Exit Char Exit
SF04L999  RETURN
.--------------------------------
. Screen - Export Purchase Orders             
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC05L200
          CALL      CF05L000 * Clear Fields
          CALL      SETSCR05
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Export Purchase Orders             
.-------------------------------------------------------
CF05L000
          MOVE      SP70,FROMPON 
          MOVE      SP70,ORIGCODE
          MOVE      ZERO,INCCOMYN
          MOVE      ZERO,INCPRTYN
          MOVE      SP70,FROMMSG 
          MOVE      SP70,FROMCON 
          MOVE      SP70,CREDFROM
          MOVE      ZERO,FORMATYP
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Export Purchase Orders             
.--------------------------------------------------------
KY05L000
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Export Purchase Orders             
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Export Purchase Orders             
.---------------------------------------------------------
LM05L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Export Purchase Orders             
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Export Purchase Orders             
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L999,PS05L999,PS05L101:
                            PS05L102,PS05L999,PS05L103,PS05L104:
                            PS05L105,PS05L106,PS05L107,PS05L108:
                            PS05L109,PS05L110,PS05L111,PS05L112:
                            PS05L113,PS05L114
          GOTO     PS05L999
.
PS05L101
          MOVE      FROMPON,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L102
          MOVE      TOPON,VAR        
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L103
          MOVE      ORIGCODE,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L104
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCCOMYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCPRTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L107
          MOVE      FROMMSG,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L108
          MOVE      TOMSG,VAR        
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L109
          MOVE      FROMCON,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L110
          MOVE      TOCON,VAR        
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L111
          MOVE      CREDFROM,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L112
          MOVE      CREDEND,VAR      
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L113
          MOVE      FORMATYP,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
.
PS05L114
          MOVE      FORMDESC,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Export Purchase Orders             
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L101,SF05L102,SF05L103:
                            SF05L006,SF05L006,SF05L104,SF05L006:
                            SF05L105,SF05L106,SF05L107,SF05L006:
                            SF05L108,SF05L006,SF05L109,SF05L006:
                            SF05L110,SF05L006
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L103:
                            SF05L020,SF05L020,SF05L104,SF05L020:
                            SF05L105,SF05L106,SF05L107,SF05L020:
                            SF05L108,SF05L020,SF05L109,SF05L020:
                            SF05L110,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          GOTO     SF05L001
.
SF05L101
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L102
          CALL      EXPOR000
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOPON   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RANPO000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L103
            ENDIF
            BRANCH    EXIT,SF05L103,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      FROMPON,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOPON,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
.
SF05L104
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIORNAME
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSIORA00
          MOVE      SIORORIG,ORIGCODE
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L104
            ENDIF
            BRANCH    EXIT,SF05L104,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      ORIGCODE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIORNAME,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
.
SF05L105
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,INCCOMYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCCOMYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L106
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,INCPRTYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCPRTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF05L001
.
SF05L107
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOMSG   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RMESG000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L107
            ENDIF
            BRANCH    EXIT,SF05L107,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      FROMMSG,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOMSG,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
.
SF05L108
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCON   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCONF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L108
            ENDIF
            BRANCH    EXIT,SF05L108,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      FROMCON,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCON,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
.
SF05L109
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CREDEND 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCRED000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L109
            ENDIF
            BRANCH    EXIT,SF05L109,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      CREDFROM,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CREDEND,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
.
SF05L110
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FORMDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KFORM000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF05L110
            ENDIF
            BRANCH    EXIT,SF05L110,SF05L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF05L990 IF EQUAL
          ENDIF
          MOVE      FORMATYP,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   18",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FORMDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF05L001
SF05L990  MOVE      FOUR,EXIT * Exit Char Exit
SF05L999  RETURN
.--------------------------------
. Screen - Email/Fax/Print Purchase Orders    
.--------------------------------
SC06L000
SC06L100
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC06L200
          CALL      CF06L000 * Clear Fields
          CALL      SETSCR06
SC06L300
          CALL      KY06L000 * Enter Key Fields
          BRANCH    EXIT,SC06L999,SC06L999
SC06L400
          CALL      WP06L000 * Load any WP Details
SC06L500
          CALL      LM06L000 * Load any Batch Details
SC06L600
          CALL      DF06L000 * Display Fields
SC06L700
          CALL      SF06L000 * Select Fields
          BRANCH    EXIT,SC06L100,SC06L100,SC06L200
          IF        EXIT=4
            MOVE      ONE,EXIT
          ENDIF
SC06L800
SC06L900
SC06L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Email/Fax/Print Purchase Orders    
.-------------------------------------------------------
CF06L000
          MOVE      SP70,FROMPON 
          MOVE      SP70,ORIGCODE
          MOVE      ZERO,INCCOMYN
          MOVE      ZERO,INCPRTYN
          MOVE      SP70,FROMMSG 
          MOVE      SP70,FROMCON 
          MOVE      SP70,CREDFROM
CF06L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Email/Fax/Print Purchase Orders    
.--------------------------------------------------------
KY06L000
          MOVE      ZERO,EXIT
          GOTO      KY06L999
.
KY06L900  MOVE      ONE,EXIT
KY06L999  RETURN
.---------------------------------------------------------
. Load WP files for : Email/Fax/Print Purchase Orders    
.---------------------------------------------------------
WP06L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Email/Fax/Print Purchase Orders    
.---------------------------------------------------------
LM06L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Email/Fax/Print Purchase Orders    
.---------------------------------------------------------
DF06L000
          BRANCH   ACCEPT,DF06L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF06L900
          MATCH    PRGID,SCPSPID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF06L010 IF NOT EQUAL
.
          CALL     PS06L000 * Display Field
          GOTO     DF06L010
DF06L900
DF06L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Email/Fax/Print Purchase Orders    
.---------------------------------------------------------
PS06L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS06L999,PS06L999,PS06L999,PS06L101:
                            PS06L102,PS06L999,PS06L103,PS06L104:
                            PS06L105,PS06L106,PS06L107,PS06L108:
                            PS06L109,PS06L110,PS06L111,PS06L112
          GOTO     PS06L999
.
PS06L101
          MOVE      FROMPON,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L102
          MOVE      TOPON,VAR        
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L103
          MOVE      ORIGCODE,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L104
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L105
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCCOMYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L106
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCPRTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L107
          MOVE      FROMMSG,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L108
          MOVE      TOMSG,VAR        
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L109
          MOVE      FROMCON,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L110
          MOVE      TOCON,VAR        
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L111
          MOVE      CREDFROM,VAR     
          CALL      DISPITEM
          GOTO     PS06L999
.
PS06L112
          MOVE      CREDEND,VAR      
          CALL      DISPITEM
          GOTO     PS06L999
PS06L999
          RETURN
.---------------------------------------------------------
. Selections for : Email/Fax/Print Purchase Orders    
.---------------------------------------------------------
SF06L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF06L001  BRANCH   ACCEPT,SF06L020
.
SF06L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L006,SF06L101,SF06L102,SF06L103:
                            SF06L006,SF06L006,SF06L104,SF06L006:
                            SF06L105,SF06L106,SF06L107,SF06L006:
                            SF06L108,SF06L006,SF06L109,SF06L006
SF06L006  BEEP
          GOTO     SF06L005
SF06L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF06L090
          MATCH    PRGID,SCSLPID
          GOTO     SF06L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF06L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L020,SF06L020,SF06L020,SF06L103:
                            SF06L020,SF06L020,SF06L104,SF06L020:
                            SF06L105,SF06L106,SF06L107,SF06L020:
                            SF06L108,SF06L020,SF06L109,SF06L020
          GOTO     SF06L020
SF06L090  MOVE     ZERO,ACCEPT
          GOTO     SF06L001
.
SF06L101
          MOVE      ZERO,EXIT
          GOTO      SF06L999
.
SF06L102
          CALL      VRTIN000
          MOVE      ZERO,EXIT
          GOTO      SF06L999
.
SF06L103
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOPON   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL      INDE0000
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RANPO000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF06L103
            ENDIF
            BRANCH    EXIT,SF06L103,SF06L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF06L990 IF EQUAL
          ENDIF
          MOVE      FROMPON,VAR      
          CALL      DISPITEM
.
.
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOPON,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF06L001
.
SF06L104
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,SIORNAME
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KSIORA00
          MOVE      SIORORIG,ORIGCODE
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF06L104
            ENDIF
            BRANCH    EXIT,SF06L104,SF06L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF06L990 IF EQUAL
          ENDIF
          MOVE      ORIGCODE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIORNAME,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF06L001
.
SF06L105
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,INCCOMYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCCOMYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF06L001
.
SF06L106
          CALL      DEFAULTN
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,INCPRTYN
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      INCPRTYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF06L001
.
SF06L107
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOMSG   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RMESG000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF06L107
            ENDIF
            BRANCH    EXIT,SF06L107,SF06L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF06L990 IF EQUAL
          ENDIF
          MOVE      FROMMSG,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   12",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOMSG,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF06L001
.
SF06L108
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,TOCON   
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCONF000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF06L108
            ENDIF
            BRANCH    EXIT,SF06L108,SF06L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF06L990 IF EQUAL
          ENDIF
          MOVE      FROMCON,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOCON,VAR        
            CALL      DISPITEM
          ENDIF
          GOTO     SF06L001
.
SF06L109
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,CREDEND 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      RCRED000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF06L109
            ENDIF
            BRANCH    EXIT,SF06L109,SF06L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF06L990 IF EQUAL
          ENDIF
          MOVE      CREDFROM,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      CREDEND,VAR      
            CALL      DISPITEM
          ENDIF
          GOTO     SF06L001
SF06L990  MOVE      FOUR,EXIT * Exit Char Exit
SF06L999  RETURN
.@@@@@ Function Restart Point @@@@@
.**********************************************************************
. SELPRT00 - select printer routine
. Requires IBACODFD/INC IBAPRNFD/INC
.          IBAIOCOD/INC IBAIOPRN/INC IBAPRINT
.  Note : already includes IBAPASFD & IBAPASIO
.**********************************************************************
SELPRT00  OPEN      IBACODE1,"ibacodef"     * open files
...       OPEN      IBAPRNT1,"ibaprntf"                               *D-239574
          MOVE      SP70,SPLFILE
          CALL      SELPRINT
          RETURN
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*143,HNONUSAG
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ONE,HNONUSAG
            WRITAB    CONTROLF,SIXTY3;*143,HNONUSAG
          ENDIF
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
.********************************************************************
. Set accept mode
.********************************************************************
SETACCEP  MOVE      ONE,ACCEPT
          RETURN
.********************************************************************
. Single Order Print
.********************************************************************
SINPRT00
          REP       " 0",SIPADCN
          MATCH     "00000000",SIPADCN           * cancelled ?
          IF        !@EQUAL
            CLEAR     DISPMSG
            APPEND    "Purchase Order Has Been Cancelled - ",DISPMSG
            CALL      MESSAGE4
            BRANCH    EXIT,SINPRT99
          ELSE
            REP       " 0",SIPADCM
            MATCH     "00000000",SIPADCM           * completed ?
            IF        !@EQUAL
              CLEAR     DISPMSG
              APPEND    "Purchase Order Has Been Completed - ",DISPMSG
              CALL      MESSAGE4
              BRANCH    EXIT,SINPRT99
            ENDIF
          ENDIF
.
          MOVE      ZERO,NOPRINT
          CALL      SINORDPR                     * print purchase order
          MOVE      ZERO,EXIT
.
SINPRT99  RETURN
.********************************************************************
. Keyin Single Code
.********************************************************************
KCODS000
          PACK      FROMCOD7,SP70
          CALL      KSIPAA00           * keyin purchase order
          BRANCH    EXIT,KCODS950,KCODS950
.
. check warehouse security
.
          MATCH     SP70,SIPAWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIPAWAR,SP70
            CALL      RDSIWS1
            IF        OVRCD=1
              CLEAR     DISPMSG
              APPEND    "You have no access for Warehouse ",DISPMSG
              APPEND    SIPAWAR,DISPMSG
              APPEND    " - ",DISPMSG
              CALL      MESSAGE1
              GOTO      KCODS950
            ENDIF
          ENDIF
.
          PACK      FROMCOD7,SIPAPON,SP70
.
KCODS900  MOVE      ZERO,EXIT
          GOTO      KCODS999
.
KCODS950  MOVE      TWO,EXIT
.
KCODS999  RETURN
.----------------------------------------------------------------------
. Set up screen 02
.----------------------------------------------------------------------
SETSCR02
          MOVE      ONE,ACCEPT              * set accept mode
.
          UNPACK    SP70,ORIGCODE,SIORNAME
          MOVE      ZERO,PRTCOMP
.
          RETURN
.----------------------------------------------------------------------
. Default DEFYESNO to "N"
.----------------------------------------------------------------------
NYESNO00  MOVE      "N",DEFYESNO
          RETURN
.----------------------------------------------------------------------
. Default DEFYESNO to "_"
.----------------------------------------------------------------------
CYESNO00  MOVE      "_",DEFYESNO
          RETURN
.********************************************************************
. PROUT - print report
.********************************************************************
PROUT000  MOVE      ONE,NOPRINT                  * we'll control printing here !
          CALL      OPNPRINT                     * open print file
.
          IF        OPTIONA=1
            PACK      TOCOD7,FROMCOD7,SP70
          ELSE
            MATCH     FROMCOD7,TOCOD7
            IF        @LESS
              DISPLAY   *P1:24,*EL,*B,"Illegal Purchase Order Range - ";
              CALL      HITENTER
              GOTO      PROUT950
            ENDIF
          ENDIF
.
          PACK      KEY15,SP8,FROMCOD7,SP70
          CALL      RSSIPA3
          CALL      RPSIPA3
.
PROUT100  CALL      RKSIPA3
          BRANCH    OVRCD,PROUT900
          MATCH     SIPADPR,SP70
          GOTO      PROUT900 IF NOT EQUAL        * no more outstanding ?
          MATCH     SIPAPON,TOCOD7
          GOTO      PROUT900 IF LESS             * out of range ?
.
. check warehouse security
.
          MATCH     SP70,SIPAWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIPAWAR,SP70
            CALL      RDSIWS1
            BRANCH    OVRCD,PROUT100
          ENDIF
.
          MATCH     ORIGCODE,SP70
          IF        !@EQUAL
            MATCH     ORIGCODE,SIPAORI
            GOTO      PROUT100 IF NOT EQUAL      * correct originator ?
          ENDIF
.
          IF        PRTCOMP=0
            REP       " 0",SIPADCM
            MATCH     "00000000",SIPADCM
            GOTO      PROUT100 IF NOT EQUAL      * completed ?
          ENDIF
.
          REP       " 0",SIPADCN
          MATCH     "00000000",SIPADCN
          GOTO      PROUT100 IF NOT EQUAL      * cancelled ?
.
          CALL      SINORDPR                     * print purchase order
.
          GOTO      PROUT100                     * get next record
.
PROUT900  MOVE      ZERO,EXIT
          GOTO      PROUT999
.
PROUT950  MOVE      ONE,EXIT
.
PROUT999  DISPLAY   *P1:24,*EL
          CALL      CLSPRINT                     * close print file & print
          RETURN
.********************************************************************
. Keyin From Code
.********************************************************************
KCODF000
          PACK      FROMCOD7,SP70
          PACK      FROMLAB,START,SP70
          CALL      KSIPAA00           * keyin purchase order
          BRANCH    EXIT,KCODF900,KCODF950
.
          PACK      FROMCOD7,SIPAPON,SP70
          PACK      FROMLAB,SIPAPON,SP70
.
KCODF900  MOVE      ZERO,EXIT
          GOTO      KCODF999
.
KCODF950  MOVE      TWO,EXIT
.
KCODF999  RETURN
.********************************************************************
. Keyin To Code
.********************************************************************
KCODT000
          PACK      TOCOD7,Z70
          PACK      TOLAB,END,SP70
          CALL      KSIPAA00           * keyin purchase order
          BRANCH    EXIT,KCODT900,KCODT950
.
          PACK      TOCOD7,SIPAPON,SP70
          PACK      TOLAB,SIPAPON,SP70
.
KCODT900  MOVE      ZERO,EXIT
          GOTO      KCODT999
.
KCODT950  MOVE      TWO,EXIT
.
KCODT999  RETURN
.----------------------------------------------------------------------
. Set up screen 03
.----------------------------------------------------------------------
SETSCR03  MOVE      ONE,ACCEPT              * set accept mode
.
          UNPACK    SP70,ORIGCODE,SIORNAME
          MOVE      SP70,STRPON
          MOVE      "Start",FROMPON
          MOVE      Z70,ENDPON
          MOVE      "Finish",TOPON
          UNPACK    SP70,ORIGCODE,SIORNAME
          MOVE      ZERO,INCCOMYN
          MOVE      ONE,INCPRTYN
.
          RETURN
.
DEFAULTN    MOVE     ANSN,DEFYESNO
            RETURN
.------------------------------------------------------------
. PRNT - print  P/O
.------------------------------------------------------------
PRNT0000  MOVE      ONE,NOPRINT                  * we'll control printing here !
          CALL      OPNPRINT                     * open print file
.
          IF        INCPRTYN=1
            CALL      PRNTA000
          ELSE
            CALL      PRNTO000
          ENDIF
.
PRNT9999  DISPLAY   *P1:24,*EL
          CALL      CLSPRINT                     * close print file & print
          RETURN
.------------------------------------------------------------
. Print All in Range
.------------------------------------------------------------
PRNTA000  PACK      KEY7,STRPON,SP70
          CALL      RSSIPA1
          CALL      RPSIPA1
PRNTA100  CALL      RKSIPA1
          BRANCH    OVRCD,PRNTA900
          MATCH     SIPAPON,ENDPON
          GOTO      PRNTA900 IF LESS             * out of range ?
.
. check warehouse security
.
          MATCH     SP70,SIPAWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIPAWAR,SP70
            CALL      RDSIWS1
            BRANCH    OVRCD,PRNTA100
          ENDIF
.
          CALL      PRRAN000
          BRANCH    EXIT,PRNTA100
.
          CALL      SINORDPR                     * print purchase order
.
          GOTO      PRNTA100                     * get next record
PRNTA900
PRNTA999  RETURN
.------------------------------------------------------------
. Print Outstanding Only
.------------------------------------------------------------
PRNTO000  PACK      KEY15,SP8,STRPON,SP70
          CALL      RSSIPA3
          CALL      RPSIPA3
.
PRNTO100  CALL      RKSIPA3
          BRANCH    OVRCD,PRNTO900
          MATCH     SIPADPR,SP70
          GOTO      PRNTO900 IF NOT EQUAL        * no more outstanding ?
          MATCH     SIPAPON,ENDPON
          GOTO      PRNTO900 IF LESS             * out of range ?
.
. check warehouse security
.
          MATCH     SP70,SIPAWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIPAWAR,SP70
            CALL      RDSIWS1
            BRANCH    OVRCD,PRNTO100
          ENDIF
.
          CALL      PRRAN000
          BRANCH    EXIT,PRNTO100
.
          CALL      SINORDPR                     * print purchase order
.
          GOTO      PRNTO100                     * get next record
PRNTO900
PRNTO999  RETURN
.--------------------------------------------------
. Check Range
.--------------------------------------------------
PRRAN000  MOVE      ZERO,EXIT
          MATCH     ORIGCODE,SP70
          IF        !@EQUAL
            MATCH     ORIGCODE,SIPAORI
            GOTO      PRRAN900 IF NOT EQUAL      * correct originator ?
          ENDIF
.
          IF        INCCOMYN=0
            REP       " 0",SIPADCM
            MATCH     "00000000",SIPADCM
            GOTO      PRRAN900 IF NOT EQUAL      * completed ?
          ENDIF
.
          MATCH     STRMSG,SIPAMES
          GOTO      PRRAN900 IF LESS
          MATCH     SIPAMES,ENDMSG
          GOTO      PRRAN900 IF LESS
.
          MATCH     STRCON,SIPACON
          GOTO      PRRAN900 IF LESS
          MATCH     SIPACON,ENDCON
          GOTO      PRRAN900 IF LESS
.
          REP       " 0",SIPADCN
          MATCH     "00000000",SIPADCN
          GOTO      PRRAN900 IF NOT EQUAL      * cancelled ?
          GOTO      PRRAN999
PRRAN900  MOVE      ONE,EXIT
PRRAN999  RETURN
.
.--------------------------------------------------
. Enter Range
.  where SIPA    = System & File for Keyin Routines
.        PON     = Field ID
.        RANPO   = Call Routine Label
.
.  Return Values
.        FROMPON  Code & Description for Start of Range
.        TOPON    Code & Description for End of Range
.        STRPON   Code for Start of Range
.        ENDPON   Code for End of Range
.--------------------------------------------------
RANPO000   READ     CONTROLF,HUND07;*81,SNCOSFYN
           MOVE     "    4",FLDID
           CALL     GETPOSIT
           CALL     KSIPAA00
           BRANCH   EXIT,RANPO100,RANPO999
           MOVE     SIPAPON,STRPON
           PACK     FROMPON,SIPAPON,SP70
           GOTO     RANPO140
RANPO100   MOVE     "Start  ",FROMPON
           MOVE     SP70,STRPON
.
RANPO140   MOVE     FROMPON,VAR
           CALL     DISPITEM
.
RANPO150   MOVE     "    5",FLDID
           CALL     GETPOSIT
           CALL     KSIPAA00
           BRANCH   EXIT,RANPO200,RANPO999
           MOVE     SIPAPON,ENDPON
           PACK     TOPON,SIPAPON,SP70
           MATCH    STRPON,ENDPON
           GOTO     RANPO990 IF EQUAL
           GOTO     RANPO990 IF NOT LESS
           BEEP
           MOVE     "To P/O Must Be > From P/O - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RANPO000
.
RANPO200   MOVE     "Finish             ",TOPON
           MOVE     Z70,ENDPON
.
           COMPARE   ONE,SNCOSFYN
           GOTO      RANPO990 IF NOT EQUAL
.
           MATCH     "04",SCRID
.....      GOTO      RANPO990 IF NOT EQUAL                              D-f1101
           IF        !@EQUAL
             MATCH     "06",SCRID                                      *I-f1101
             GOTO      RANPO990 IF NOT EQUAL                           *I-f1101
           ENDIF                                                       *I-f1101
.
           GETVAR    LINE24,ATTR24,1,24
.
RANPO210   MOVE      ANSN,ANS
           KEYIN     *P1:24,*EL,*V2LON,*RV:
                         "Continue with START to FINISH print (Y/N)? ",ANS
           REP       "yYnN",ANS
           MATCH     ANSY,ANS
           IF        @EQUAL
             PUTVAR    LINE24,ATTR24,1,24
             GOTO      RANPO990
           ENDIF
.
           MATCH     ANSN,ANS
           IF        @EQUAL
             PUTVAR    LINE24,ATTR24,1,24
             GOTO      RANPO150
           ENDIF
.
           GOTO     RANPO210
.
RANPO990   MOVE     "    4",FLDID
           CALL     GETPOSIT
RANPO999   RETURN
.
.------------------------------------------------------------
. Enter Message Code Range
.------------------------------------------------------------
RMESG000   MOVE     "   11",FLDID
           CALL     GETPOSIT
           MOVE     "ME ",SICDCATA
           CALL     KSICDB00
           BRANCH   EXIT,RMESG100,RMESG999
           MOVE     SICDCODE,STRMSG
           PACK     FROMMSG,SICDCODE,SP1,SICDDESC
           GOTO     RMESG140
RMESG100   MOVE     "Start             ",FROMMSG
           MOVE     SP70,STRMSG
.
RMESG140   MOVE     FROMMSG,VAR
           CALL     DISPITEM
.
RMESG150   MOVE     "   12",FLDID
           CALL     GETPOSIT
           MOVE     "ME ",SICDCATA
           CALL     KSICDB00
           BRANCH   EXIT,RMESG200,RMESG999
           MOVE     SICDCODE,ENDMSG
           PACK     TOMSG,SICDCODE,SP1,SICDDESC
           MATCH    STRMSG,ENDMSG
           GOTO     RMESG999 IF EQUAL
           GOTO     RMESG999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RMESG000
.
RMESG200   MOVE     "Finish             ",TOMSG
           MOVE     Z70,ENDMSG
.
RMESG999   MOVE     "   11",FLDID
           CALL     GETPOSIT
           RETURN
.
.------------------------------------------------------------
. Enter Message Code Range
.------------------------------------------------------------
RCONF000   MOVE     "   13",FLDID
           CALL     GETPOSIT
           MOVE     "CF ",SICDCATA
           CALL     KSICDB00
           BRANCH   EXIT,RCONF100,RCONF999
           MOVE     SICDCODE,STRCON
           PACK     FROMCON,SICDCODE,SP1,SICDDESC
           GOTO     RCONF140
RCONF100   MOVE     "Start             ",FROMCON
           MOVE     SP70,STRCON
.
RCONF140   MOVE     FROMCON,VAR
           CALL     DISPITEM
.
RCONF150   MOVE     "   14",FLDID
           CALL     GETPOSIT
           MOVE     "CF ",SICDCATA
           CALL     KSICDB00
           BRANCH   EXIT,RCONF200,RCONF999
           MOVE     SICDCODE,ENDCON
           PACK     TOCON,SICDCODE,SP1,SICDDESC
           MATCH    STRCON,ENDCON
           GOTO     RCONF999 IF EQUAL
           GOTO     RCONF999 IF NOT LESS
           BEEP
           MOVE     "To Code Must Be > From Code - ",DISPMSG
           CALL     MESSAGE1
           GOTO     RCONF000
.
RCONF200   MOVE     "Finish             ",TOCON
           MOVE     Z70,ENDCON
.
RCONF999   MOVE     "   13",FLDID
           CALL     GETPOSIT
           RETURN
.
.----------------------------------------------------------------------
. Set up screen 04
.----------------------------------------------------------------------
SETSCR04
          MOVE      ONE,ACCEPT              * set accept mode
.
          MOVE      SP70,STRPON
          MOVE      "Start",FROMPON
          MOVE      Z70,ENDPON
          MOVE      "Finish",TOPON
          UNPACK    SP70,ORIGCODE,SIORNAME
          MOVE      ZERO,INCCOMYN
          MOVE      ZERO,INCPRTYN
.
          RETURN
.------------------------------------------------------------
. FAXPO - Fax Purchase Orders.
.------------------------------------------------------------
FAXPO000  MOVE      ONE,NOPRINT                  * we'll control printing here !
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          IF        INCPRTYN=1
            CALL      FXALL000
          ELSE
            CALL      FXOUT000
          ENDIF
          CALL      PUTSCR00
          RETURN
.------------------------------------------------------------
. Fax Orders Not Yet Printed
.------------------------------------------------------------
FXOUT000  PACK      KEY15,SP8,STRPON,SP70
          CALL      RSSIPA3
          CALL      RPSIPA3
.
FXOUT100  CALL      RKSIPA3
          BRANCH    OVRCD,FXOUT900
          MATCH     SIPADPR,SP70
          GOTO      FXOUT900 IF NOT EQUAL        * no more outstanding ?
          MATCH     SIPAPON,ENDPON
          GOTO      FXOUT900 IF LESS             * out of range ?
.
. check warehouse security
.
          MATCH     SP70,SIPAWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIPAWAR,SP70
            CALL      RDSIWS1
            BRANCH    OVRCD,FXOUT100
          ENDIF
.
          CALL      FXRAN000
          BRANCH    EXIT,FXOUT100
.
          CALL      SINORDFX                     * fax purchase order
          GOTO      FXOUT100                     * get next record
.
FXOUT900  MOVE      ZERO,EXIT
          RETURN
.------------------------------------------------------------
. Fax All Orders in Range
.------------------------------------------------------------
FXALL000  PACK      KEY7,STRPON,SP70
          CALL      RDSIPA1
          IF        OVRCD=0
            CALL      RPSIPA1
          ENDIF
FXALL100  CALL      RKSIPA1
          BRANCH    OVRCD,FXALL900
          MATCH     SIPAPON,ENDPON
          GOTO      FXALL900 IF LESS             * out of range ?
.
. check warehouse security
.
          MATCH     SP70,SIPAWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIPAWAR,SP70
            CALL      RDSIWS1
            BRANCH    OVRCD,FXALL100
          ENDIF
.
          CALL      FXRAN000
          BRANCH    EXIT,FXALL100
.
          CALL      SINORDFX                     * fax purchase order
          GOTO      FXALL100                     * get next record
.
FXALL900  MOVE      ZERO,EXIT
          RETURN
.------------------------------------------------------------
. Check Range Details
.------------------------------------------------------------
FXRAN000  MOVE      ZERO,EXIT
          MATCH     ORIGCODE,SP70
          IF        !@EQUAL
            MATCH     ORIGCODE,SIPAORI
            GOTO      FXRAN900 IF NOT EQUAL   * correct originator ?
          ENDIF
.
          IF        INCCOMYN=0
            REP       " 0",SIPADCM
            MATCH     "00000000",SIPADCM
            GOTO      FXRAN900 IF NOT EQUAL   * completed ?
          ENDIF
.
          REP       " 0",SIPADCN
          MATCH     "00000000",SIPADCN
          GOTO      FXRAN900 IF NOT EQUAL     * cancelled ?
.
          MATCH     STRMSG,SIPAMES
          GOTO      FXRAN900 IF LESS
          MATCH     SIPAMES,ENDMSG
          GOTO      FXRAN900 IF LESS
.
          MATCH     STRCON,SIPACON
          GOTO      FXRAN900 IF LESS
          MATCH     SIPACON,ENDCON
          GOTO      FXRAN900 IF LESS
.
          MOVE      SIPASUP,KEY5
          CALL      RDAPMA1
          BRANCH    OVRCD,FXRAN900
          MATCH     SP70,APMAUR2              * Must have a Fax Number to Fax
          GOTO      FXRAN900 IF EQUAL
.
          GOTO      FXRAN999
.
FXRAN900  MOVE      ONE,EXIT
FXRAN999  RETURN
.
.
.----------------------------------------------------------------------
. Set up screen 05
.----------------------------------------------------------------------
.
SETSCR05  MOVE      ONE,ACCEPT              * set accept mode
.
          MOVE      SP70,STRPON
          MOVE      "Start",FROMPON
          MOVE      Z70,ENDPON
          MOVE      "Finish",TOPON
          UNPACK    SP70,ORIGCODE,SIORNAME
          MOVE      ZERO,INCCOMYN
          MOVE      ZERO,INCPRTYN
.
          MOVE      "Start    ",CREDFROM
          MOVE      "Finish   ",CREDEND
          MOVE      SP70,STRCRD
          MOVE      "~~~~~",ENDCRD
.
          MOVE      ONE,FORMATYP
.
          RETURN
.------------------------------------------------------------
. EXPOR - Export Purchase Orders.
.------------------------------------------------------------
EXPOR000  COMPARE   THREE,FORMATYP
          GOTO      EXPOR900 IF EQUAL
.
          MOVE      "EXPORT",KEY6
          PACK      EXPORTFN,KEY6,PORT
          REP       " 0",EXPORTFN
          PREP      EXPORTFL,EXPORTFN
          MOVE      ZERO,COUNTING
.
          IF        FORMATYP=2
            WRITE     EXPORTFL,SEQ;"HEADERINDICATOR=[DOCUMENT]"
            WRITE     EXPORTFL,SEQ;"DETAILINDICATOR=[DETAIL]"
          ENDIF
.
          IF        INCPRTYN=1
            CALL      EXALL000
          ELSE
            CALL      EXOUT000
          ENDIF
.
          CALL      EXTRN000  * TRANSMIT
          GOTO      EXPOR999
.
EXPOR900  CALL      EPEG0000           * PEG export file
.
EXPOR999  RETURN
.------------------------------------------------------------
. Export Orders Not Yet Printed
.------------------------------------------------------------
EXOUT000  PACK      KEY15,SP8,STRPON,SP70
          CALL      RSSIPA3
          CALL      RPSIPA3
.
EXOUT100  CALL      RKSIPA3
          BRANCH    OVRCD,EXOUT900
          MATCH     SIPADPR,SP70
          GOTO      EXOUT900 IF NOT EQUAL        * no more outstanding ?
          MATCH     SIPAPON,ENDPON
          GOTO      EXOUT900 IF LESS             * out of range ?
.
. check warehouse security
.
          MATCH     SP70,SIPAWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIPAWAR,SP70
            CALL      RDSIWS1
            BRANCH    OVRCD,EXOUT100
          ENDIF
.
          CALL      EXRAN000
          BRANCH    EXIT,EXOUT100
.
          CALL      ORDFX000                     * Export purchase order
.
          MOVE      "2",AUDTTYPE
          CALL      WASIPA00
.
          MOVE      SIPAPON,KEY7
          CALL      RDSIPA1
          IF        OVRCD=0
            PACK      SIPADPR,CCC,CYY,CMM,CDD
            REP       " 0",SIPADPR
            CALL      UPSIPA1
          ENDIF
.
          MOVE      "3",AUDTTYPE
          CALL      WASIPA00
.
          GOTO      EXOUT100                     * get next record
.
EXOUT900  MOVE      ZERO,EXIT
          RETURN
.------------------------------------------------------------
. Export All Orders in Range
.------------------------------------------------------------
EXALL000  PACK      KEY7,STRPON,SP70
          CALL      RDSIPA1
          IF        OVRCD=0
            CALL      RPSIPA1
          ENDIF
EXALL100  CALL      RKSIPA1
          BRANCH    OVRCD,EXALL900
          MATCH     SIPAPON,ENDPON
          GOTO      EXALL900 IF LESS             * out of range ?
.
. check warehouse security
.
          MATCH     SP70,SIPAWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIPAWAR,SP70
            CALL      RDSIWS1
            BRANCH    OVRCD,EXALL100
          ENDIF
.
          CALL      EXRAN000
          BRANCH    EXIT,EXALL100
.
          CALL      ORDFX000                     * Export purchase order
.
          PACK      DIM8,CCC,CYY,CMM,CDD
          REP       " 0",DIM8
          MATCH     DIM8,SIPADPR
          IF        !@EQUAL
            MOVE      "2",AUDTTYPE
            CALL      WASIPA00
.
            MOVE      SIPAPON,KEY7
            CALL      RDSIPA1
            IF        OVRCD=0
              PACK      SIPADPR,CCC,CYY,CMM,CDD
              REP       " 0",SIPADPR
              CALL      UPSIPA1
            ENDIF
.
            MOVE      "3",AUDTTYPE
            CALL      WASIPA00
          ENDIF
.
          GOTO      EXALL100                     * get next record
.
EXALL900  MOVE      ZERO,EXIT
          RETURN
.------------------------------------------------------------
. Check Range Details
.------------------------------------------------------------
EXRAN000  MOVE      ZERO,EXIT
          MATCH     ORIGCODE,SP70
          IF        !@EQUAL
            MATCH     ORIGCODE,SIPAORI
            GOTO      EXRAN900 IF NOT EQUAL   * correct originator ?
          ENDIF
.
          IF        INCCOMYN=0
            REP       " 0",SIPADCM
            MATCH     "00000000",SIPADCM
            GOTO      EXRAN900 IF NOT EQUAL   * completed ?
          ENDIF
.
          REP       " 0",SIPADCN
          MATCH     "00000000",SIPADCN
          GOTO      EXRAN900 IF NOT EQUAL     * cancelled ?
.
          MATCH     STRMSG,SIPAMES
          GOTO      EXRAN900 IF LESS
          MATCH     SIPAMES,ENDMSG
          GOTO      EXRAN900 IF LESS
.
          MATCH     STRCON,SIPACON
          GOTO      EXRAN900 IF LESS
          MATCH     SIPACON,ENDCON
          GOTO      EXRAN900 IF LESS
.
          MATCH     STRCRD,SIPASUP
          GOTO      EXRAN900 IF LESS
          MATCH     SIPASUP,ENDCRD
          GOTO      EXRAN900 IF LESS
.
          IF        FORMATYP=3
            PACK      KEY5,SIPASUP,SP70
            CALL      RDAPMA1
            BRANCH    OVRCD,EXRAN900
.
            MATCH     SP70,APMACEDI
            GOTO      EXRAN999 IF NOT EQUAL
.
            CLEAR     DISPMSG
            APPEND    "P/O No.",DISPMSG
            APPEND    SIPAPON,DISPMSG
            APPEND    ", Company EAN doesn't exist. - ",DISPMSG
            CALL      MESSAGE1
            GOTO      EXRAN900
          ENDIF
.
          GOTO      EXRAN999
.
EXRAN900  MOVE      ONE,EXIT
EXRAN999  RETURN
.
ORDFX000  MOVE      SP70,SICDDESC
          MATCH     SP70,SIPAMES
          IF        !@EQUAL
            MOVE      "ME ",KEY3
            PACK      KEY6,KEY3,SIPAMES,SP70
            CALL      RDSICD1
          ENDIF
          PACK      MESSDESK,SICDDESC,SP70
.
          MOVE     SP20,SIORNAME
          MATCH    SP70,SIPAORI
          IF       !@EQUAL
            PACK      KEY3,SIPAORI,SP70
            CALL      RDSIOR1
          ENDIF
.
          IF        FORMATYP=1
            WRITE     EXPORTFL,SEQ;"00",TABDELM:
                                   SIPAPON,TABDELM:
                                   SIPADIN,TABDELM:
                                   SIPASUP,TABDELM:
                                   SIPADEL,TABDELM:
                                   MESSDESK,TABDELM:
                                   SIORNAME,TABDELM
          ENDIF
          IF        FORMATYP=2
            WRITE     EXPORTFL,SEQ;"[DOCUMENT]<Description><Address1>":
                                   "<Special><Attention>"
            MOVE      SIPADEL,D30
            WRITE     EXPORTFL,SEQ;TABDELM,SIPAPON,TABDELM:
                                   D30,TABDELM:
                                   MESSDESK,TABDELM:
                                   SIORNAME,TABDELM
            WRITE     EXPORTFL,SEQ;"[DETAIL]<ProductCode><Quantity>"
            GOTO      ORDFX200
          ENDIF
.
          PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPB1
.
ORDFX100  CALL      RKSIPB1
          BRANCH    OVRCD,ORDFX200
.
          MATCH     SIPAPON,SIPBPON
          GOTO      ORDFX200 IF NOT EQUAL
.
          WRITE     EXPORTFL,SEQ;"01",TABDELM:
                                 SIPAPON,TABDELM:
                                 SIPBLIN,TABDELM:
                                 SIPBCOM,TABDELM
          GOTO      ORDFX100
.
ORDFX200  PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPC1
.
ORDFX210  CALL      RKSIPC1
          BRANCH    OVRCD,ORDFX999
.
          MATCH     SIPAPON,SIPCPON
          GOTO      ORDFX999 IF NOT EQUAL
.
          MOVE      SIPCOQT,F15
          MOVE      SIPCOQT,F8
          MOVE      SIPCOQT,F6
          MOVE      SIPCECT,F18P2
          MOVE      SIPCECT,F12P2
          MOVE      SIPCPN,D15A
.
          IF        FORMATYP=1
            WRITE     EXPORTFL,SEQ;"10",TABDELM:
                                   SIPAPON,TABDELM:
                                   SIPCITM,TABDELM:
                                   F8,TABDELM:
                                   SIPCSUT,TABDELM:
                                   F12P2,TABDELM:
                                   SIPCCAT,TABDELM:
                                   SIPCPN,TABDELM:
                                   SIPCPD,TABDELM:
                                   SIPCEDD,TABDELM:
                                   SIPCCST,TABDELM
          ENDIF
          IF        FORMATYP=2
            WRITE     EXPORTFL,SEQ;TABDELM,D15A,TABDELM:
                                   F6,TABDELM
            MOVE      ONE,COUNTING
            GOTO      ORDFX210
          ENDIF
.
          MOVE      ONE,COUNTING
          PACK      KEY13,SIPCPON,SIPCITM,SP70
          CALL      RSSIPD1
.
ORDFX300  CALL      RKSIPD1
          BRANCH    OVRCD,ORDFX210
.
          MATCH     SIPCPON,SIPDPON
          GOTO      ORDFX210 IF NOT EQUAL
          MATCH     SIPCITM,SIPDITM
          GOTO      ORDFX210 IF NOT EQUAL
.
          MATCH     SP70,SIPDCOM
          GOTO      ORDFX300 IF EQUAL
.
          WRITE     EXPORTFL,SEQ;"11",TABDELM:
                                 SIPDPON,TABDELM:
                                 SIPDITM,TABDELM:
                                 SIPDLIN,TABDELM:
                                 SIPDCOM,TABDELM
          GOTO      ORDFX300
.
ORDFX999  RETURN
.
EXTRN000  IF        COUNTING=0
            MOVE      "No Purchase Orders to Transfer ",DISPMSG
            CALL      MESSAGE1
            GOTO      EXTRN900
          ENDIF
.
          CLOSE     EXPORTFL
.
          DISPLAY  *P1:24,*EL,"Execute Transfer Now (":
                              *V2LON,"Y",*HOFF,"/":
                              *V2LON,"N",*HOFF,") ? "
          MOVE     "24",CVERT
          MOVE     "30",CCOL
          CALL     YORN0000
          COMPARE  ZERO,FYESNO
          GOTO     EXTRN999 IF EQUAL   *  No Transfer
.
          MOVE     ZERO,HLEF
          CALL     GETSCR00
.
          CLEAR     KEY80
          APPEND    "ibasin59.us2 ",KEY80
          APPEND    EXPORTFN,KEY80
          APPEND    ".txt",KEY80
          RESET     KEY80
          EXECUTE   KEY80,TASKID
.
          CALL     PUTSCR00
.
          DISPLAY  *P1:24,*EL,"Transfer Completed Ok (":
                              *V2LON,"Y",*HOFF,"/":
                              *V2LON,"N",*HOFF,") ? "
          MOVE     "24",CVERT
          MOVE     "31",CCOL
          CALL     YORN0000
          COMPARE  ZERO,FYESNO
          GOTO     EXTRN000 IF EQUAL   *  Not ok
.
EXTRN900  PREP     EXPORTFL,EXPORTFN
          CLOSE    EXPORTFL
.
EXTRN999  RETURN
.------------------------------------------------------------
. PEG export file process
.------------------------------------------------------------
EPEG0000  READ      CONTROLF,TEN3;CHADD1,CHADD2,CHPOST
          READ      CONTROLF,TWENTY3;*51,HSHORT
          READ      CONTROLF,SIXTY3;SNCOHEAN
.
          PACK      DISPMSG,SP70,SP70
          CALL      MESSAGE2
.
          MOVE      ZERO,PEGTXTFL
          IF        INCPRTYN=1
            CALL      EPALL000
          ELSE
            CALL      EPOUT000
          ENDIF
.
          DISPLAY   *P1:24,*EL,*V2LON,PEGTXTFL,*HOFF:
                    " File(s) succesfully Exported. - ";
          CALL      HITENTER
.
EPEG9999  CALL      MESSAGE3
          RETURN
.------------------------------------------------------------
. PEG - Export Orders Not Yet Printed
.------------------------------------------------------------
EPOUT000  PACK      KEY15,SP8,STRPON,SP70
          CALL      RSSIPA3
          CALL      RPSIPA3
.
EPOUT100  CALL      RKSIPA3
          BRANCH    OVRCD,EPOUT999
          MATCH     SIPADPR,SP70
          GOTO      EPOUT999 IF NOT EQUAL        * no more outstanding ?
          MATCH     SIPAPON,ENDPON
          GOTO      EPOUT999 IF LESS             * out of range ?
.
          CALL      EXRAN000
          BRANCH    EXIT,EPOUT100
.
          DISPLAY   *P1:24,*EL,"Exporting - P/0 : ",*V2LON,SIPAPON,*HOFF;
          CALL      PEGEX000                     * Export PEG purchase order
.
          MOVE      "2",AUDTTYPE
          CALL      WASIPA00
.
          MOVE      SIPAPON,KEY7
          CALL      RDSIPA1
          IF        OVRCD=0
            PACK      SIPADPR,CCC,CYY,CMM,CDD
            REP       " 0",SIPADPR
            CALL      UPSIPA1
          ENDIF
.
          MOVE      "3",AUDTTYPE
          CALL      WASIPA00
.
          GOTO      EPOUT100                     * get next record
.
EPOUT999  RETURN
.------------------------------------------------------------
. PEG - Export All Orders in Range
.------------------------------------------------------------
EPALL000  PACK      KEY7,STRPON,SP70
          CALL      RDSIPA1
          IF        OVRCD=0
            CALL      RPSIPA1
          ENDIF
EPALL100  CALL      RKSIPA1
          BRANCH    OVRCD,EPALL999
          MATCH     SIPAPON,ENDPON
          GOTO      EPALL999 IF LESS             * out of range ?
.
          CALL      EXRAN000
          BRANCH    EXIT,EPALL100
.
          DISPLAY   *P1:24,*EL,"Exporting - P/0 : ",*V2LON,SIPAPON,*HOFF;
          CALL      PEGEX000                     * Export PEG purchase order
.
          PACK      DIM8,CCC,CYY,CMM,CDD
          REP       " 0",DIM8
          MATCH     DIM8,SIPADPR
          IF        !@EQUAL
            MOVE      "2",AUDTTYPE
            CALL      WASIPA00
.
            MOVE      SIPAPON,KEY7
            CALL      RDSIPA1
            IF        OVRCD=0
              PACK      SIPADPR,CCC,CYY,CMM,CDD
              REP       " 0",SIPADPR
              CALL      UPSIPA1
            ENDIF
.
            MOVE      "3",AUDTTYPE
            CALL      WASIPA00
          ENDIF
.
          GOTO      EPALL100                     * get next record
.
EPALL999  RETURN
.------------------------------------------------------------
. Export PEG Purchase Orders
.------------------------------------------------------------
PEGEX000  MOVE      SIPAPON,DIM7
          REP       " 0",DIM7
          MOVE      "P",DIM1
          PACK      EXPORTFN,DIM1,DIM7,SP70
          PREP      PEGFILE,EXPORTFN
.
          CALL      WPEGH000
.
PEGEX200  PACK      KEY10,SIPAPON,SP70
          CALL      RSSIPC1
PEGEX210  CALL      RKSIPC1
          BRANCH    OVRCD,PEGEX900
.
          MATCH     SIPAPON,SIPCPON
          GOTO      PEGEX900 IF NOT EQUAL
.
          DISPLAY   *P26:24,", Line Item : ",*EL,*V2LON,SIPCITM,*HOFF;
          CALL      WPEGD000
          GOTO      PEGEX210
.
PEGEX900  CALL      WPEGE000
          ADD       ONE,PEGTXTFL
.
          CLOSE     PEGFILE
          CLEAR     KEY80
          APPEND    "ibasin59.us3 ",KEY80
          APPEND    EXPORTFN,KEY80
          APPEND    ".txt",KEY80
          RESET     KEY80
          EXECUTE   KEY80,TASKID
.
          PREP      PEGFILE,EXPORTFN
          CLOSE     PEGFILE
.
PEGEX999  RETURN
.------------------------------------------------------------
. Init & Write PEG P/O Header export file
.------------------------------------------------------------
WPEGH000  MOVE      SIPAPON,SIP0ORDN
          SQUEEZE   SIP0ORDN
.
          PACK      SIP0RCID,APMACEDI,SP70
          STRIP     SIP0RCID
.
          PACK      SIP0SNID,SNCOHEAN,SP70
          STRIP     SIP0SNID
.
          PACK      SIP0ORDT,SIPADIN,SP70
          STRIP     SIP0ORDT
.
          PACK      SIP0INDT,SP70
          STRIP     SIP0INDT
.
          PACK      SIP0EXDT,SP70
          STRIP     SIP0EXDT
.
          PACK      SIP0DEDT,SP70
          STRIP     SIP0DEDT
.
          PACK      SIP0AFDT,SP70
          STRIP     SIP0AFDT
.
          PACK      SIP0BFDT,SP70
          STRIP     SIP0BFDT
.
          PACK      SIP0PUCN,SIPAICN,SP70
          STRIP     SIP0PUCN
.
          PACK      SIP0PUEM,SP70
          STRIP     SIP0PUEM
.
          PACK      SIP0PUPH,SP70
          STRIP     SIP0PUPH
.
          PACK      SIP0SUCO,APMASN1,SP70
          STRIP     SIP0SUCO
.
          PACK      SIP0DESP,SNCOHEAN,SP70
          STRIP     SIP0DESP
.
          PACK      SIP0DENM,HSHORT,SP70
          STRIP     SIP0DENM
.
          PACK      SIP0DEA1,SIPADEL,SP70
          STRIP     SIP0DEA1
.
          PACK      SIP0DEA2,CHADD1,SP70
          STRIP     SIP0DEA2
.
          PACK      SIP0DEA3,CHADD2,SP70
          STRIP     SIP0DEA3
.
          MOVE      CHPOST,DIM4
          PACK      SIP0DEPC,DIM4,SP70
          STRIP     SIP0DEPC
.
          PACK      SIP0BICD,SNCOHEAN,SP70
          STRIP     SIP0BICD
.
          PACK      SIP0BINM,HSHORT,SP70
          STRIP     SIP0BINM
.
          PACK      SIP0BIA1,CHADD1,SP70
          STRIP     SIP0BIA1
.
          PACK      SIP0BIA2,SP70
          STRIP     SIP0BIA2
.
          PACK      SIP0BIA3,CHADD2,SP70
          STRIP     SIP0BIA3
.
          MOVE      CHPOST,DIM4
          PACK      SIP0BIPC,DIM4,SP70
          STRIP     SIP0BIPC
.
          PACK      SIP0ITAX,SP70
          STRIP     SIP0ITAX
.
          PACK      SICDDESC,SP70
          MATCH     SP70,SIPAMES
          IF        !@EQUAL
            MOVE      "ME ",DIM3
            PACK      KEY6,DIM3,SIPAMES,SP70
            CALL      RDSICD1
          ENDIF
          PACK      SIP0FTX1,SICDDESC,SP70
          STRIP     SIP0FTX1
.
          PACK      SICDDESC,SP70
          MATCH     SP70,SIPACON
          IF        !@EQUAL
            MOVE      "CF ",DIM3
            PACK      KEY6,DIM3,SIPACON,SP70
            CALL      RDSICD1
          ENDIF
          PACK      SIP0FTX2,SICDDESC,SP70
          STRIP     SIP0FTX2
.
WPEGH900  CALL      WRSIP01
.
WPEGH999  RETURN
.------------------------------------------------------------
. Init & Write PEG P/O Detail export file
.------------------------------------------------------------
WPEGD000  PACK      SIP1PEAN,SP70
          PACK      SIP1UOM,SP70
          PACK      KEY27,SIPCCAT,SIPASUP,SIPCSUT,SP70
          CALL      RDSIIC1
          IF        OVRCD=0
            PACK      SIP1UOM,SIICUOM,SP70
.
            PACK      SIP1PEAN,SIICUR1,SP70
            MATCH     SIICUR1,SP70
            IF        @EQUAL
              PACK      KEY7,SIPCCAT,SP70
              CALL      RDSIIA1
              PACK      SIP1PEAN,SIIAUR1,SP70
            ENDIF
          ENDIF
          STRIP     SIP1PEAN
          STRIP     SIP1UOM
.
          MOVE      SIPCITM,SIP1LINE
          SQUEEZE   SIP1LINE
.
          PACK      SIP1PDCD,SIPCCAT,SP70
          SQUEEZE   SIP1PDCD
.
          PACK      SIP1SPPC,SIPCPN,SP70
          STRIP     SIP1SPPC
.
          PACK      SIP1ITDS,SIPCPD,SP70
          STRIP     SIP1ITDS
.
          MOVE      SIPCOQT,F12
          MOVE      F12,SIP1QTY
          SQUEEZE   SIP1QTY
.
          PACK      SIP1DEDT,SIPCEDD,SP70
          STRIP     SIP1DEDT
.
          PACK      SIP1AFDT,SP70
          STRIP     SIP1AFDT
.
          PACK      SIP1BFDT,SP70
          STRIP     SIP1BFDT
.
          PACK      SIP1EXDT,SP70
          STRIP     SIP1EXDT
.
          MOVE      "CAT",SIP1PRTY
          MATCH     SIPCCON,SP70
          IF        !@EQUAL
            MOVE      "CON",SIP1PRTY
          ENDIF
.
          MOVE      SIPCECT,F12P2
          MOVE      F12P2,SIP1UNPR
          SQUEEZE   SIP1UNPR
.
          MOVE      ZERO,SIP1NUMP
          SQUEEZE   SIP1NUMP
.
          PACK      SIP1PACK,SP70
          STRIP     SIP1PACK
.
          PACK      SIP1FUOM,SP70
          STRIP     SIP1FUOM
.
          MOVE      ZERO,SIP1FQTY
          SQUEEZE   SIP1FQTY
.
          MOVE      ZERO,SIP1DISP
          SQUEEZE   SIP1DISP
.
          MOVE      ZERO,SIP1REBP
          SQUEEZE   SIP1REBP
.
          PACK      SIP1ITAX,SP70
          STRIP     SIP1ITAX
.
          PACK      SIP1FTX1,SP70
          STRIP     SIP1FTX1
.
          PACK      SIP1FTX2,SP70
          STRIP     SIP1FTX2
.
.
..          PACK      SIP1SPA1,SP70,SP70
..          PACK      SIP1SPA2,SP70,SP70
..          PACK      SIP1SPA3,SP70,SP70
..          PACK      SIP1SPA4,SP70,SP70
.
WPEGD900  CALL      WRSIP11
.
WPEGD999  RETURN
.------------------------------------------------------------
. Init & Write PEG P/O Tail (Ending) export file
.------------------------------------------------------------
..WPEGE000  PACK      SIP2SPA1,SP70,SP70
..          PACK      SIP2SPA2,SP70,SP70
..          PACK      SIP2SPA3,SP70,SP70
..          PACK      SIP2SPA4,SP70,SP70
..          PACK      SIP2SPA5,SP70,SP70
..          PACK      SIP2SPA6,SP70,SP70
..          PACK      SIP2SPA7,SP70,SP70
..          PACK      SIP2SPA8,SP70,SP70
.
WPEGE000  MOVE      SIPAPON,SIP2ORDN
          SQUEEZE   SIP2ORDN
.
WPEGE900  CALL      WRSIP21
.
WPEGE999  RETURN
.
.
.----------------------------------------------------------------------
. Enter Creditor Code Range
.----------------------------------------------------------------------
RCRED000  MOVE       "   15",FLDID
          CALL       GETPOSIT
          MOVE       SP70,VAR
          CALL       DISPITEM
          CALL       KAPMAA00
          BRANCH     EXIT,RCRED010,RCRED999
          MOVE       APMACRD,STRCRD
          PACK       CREDFROM,APMACRD,SP1,APMACN1
          GOTO       RCRED020
.
RCRED010  MOVE       SP70,STRCRD
          MOVE       "Start ",CREDFROM
.
RCRED020  MOVE       CREDFROM,VAR
          CALL       DISPITEM
.
RCRED030  MOVE       "   16",FLDID
          CALL       GETPOSIT
          MOVE       SP70,VAR
          CALL       DISPITEM
          CALL       KAPMAA00
          BRANCH     EXIT,RCRED900,RCRED999
          MOVE       APMACRD,ENDCRD
          PACK       CREDEND,APMACRD,SP1,APMACN1
          MATCH      STRCRD,ENDCRD
          GOTO       RCRED999 IF NOT LESS
.
          BEEP
          MOVE       "To Creditor Code Must Be > From Creditor Code - ",DISPMSG
          CALL       MESSAGE1
          CALL       GETPOSIT
          MOVE       SP70,VAR
          CALL       DISPITEM
          GOTO       RCRED000
.
RCRED900  MOVE       "~~~~~",ENDCRD
          MOVE       "Finish ",CREDEND
.
RCRED999  MOVE       "   15",FLDID
          RETURN
.
.------------------------------------------------------------
. KFORM - Keyin Format Type
.------------------------------------------------------------
.
KFORM000  CALL      FOLAY000
.
KFORM100  KEYIN     *PCCOL:CVERT,*V2LON,*RV,FORMATYP
.
          IF        FORMATYP=1
            MOVE      "Generic Format      ",FORMDESC
            GOTO      KFORM999
          ENDIF
          IF        FORMATYP=2
            MOVE      "ECO Export Format   ",FORMDESC
            GOTO      KFORM999
          ENDIF
          IF        FORMATYP=3
            MOVE      "PEG Export Format   ",FORMDESC
            GOTO      KFORM999
          ENDIF
.
          BEEP
          MOVE      "Format Type must be 1, 2, or 3 - ",DISPMSG
          CALL      MESSAGE1
          GOTO      KFORM100
.
KFORM999  CALL      PUTSCR00
          RETURN
.
FOLAY000  MOVE      "16",HTOP
          MOVE      "55",HLEF
          MOVE      "21",HBOT
          MOVE      "80",HRIG
          CALL      GETSCR00
.
          BOXCLR    HLEF,HTOP,HRIG,HBOT
          BOX       16,HLEF,HTOP,HRIG,HBOT
.
          DISPLAY   *P60:17,*V2LON,*ULON,"Format Type",*HOFF:
                    *P57:18,*V2LON," 1. ",*HOFF,"Generic":
                    *P57:19,*V2LON," 2. ",*HOFF,"ECO Format":
                    *P57:20,*V2LON," 3. ",*HOFF,"PEG Format"
          RETURN
.
.----------------------------------------------------------------------
. Set up screen 06
.----------------------------------------------------------------------
.
SETSCR06  MOVE      ONE,ACCEPT              * set accept mode
.
          MOVE      SP70,STRPON
          MOVE      "Start",FROMPON
          MOVE      Z70,ENDPON
          MOVE      "Finish",TOPON
          UNPACK    SP70,ORIGCODE,SIORNAME
          MOVE      ZERO,INCCOMYN
          MOVE      ZERO,INCPRTYN
.
          MOVE      "Start    ",CREDFROM
          MOVE      "Finish   ",CREDEND
          MOVE      SP70,STRCRD
          MOVE      "~~~~~",ENDCRD
.
          RETURN
.------------------------------------------------------------
. INDE0000 - Check Virtual Integration flag SNCOEMAL
.------------------------------------------------------------
INDE0000  MOVE      ZERO,EXIT
          READ      CONTROLF,SIXTY3;*242,SNCOEMAL
          BRANCH    SNCOEMAL,INDE9999
.
          CALL      GETSCR00
.
          DISPLAY   *P1:24,"Option not Available - ";
          CALL      HITENTER
          MOVE      ONE,EXIT
.
          CALL      PUTSCR00
.
INDE9999  RETURN
.------------------------------------------------------------
. VRTIN - Virtual Integration - E-mail/Fax/Print Purchase Orders
.------------------------------------------------------------
VRTIN000  MOVE      ZERO,EXIT
          CALL      INDE0000                     * Check SNCOEMAL indicator
          BRANCH    EXIT,VRTIN999
.
.....     MOVE      ONE,NOPRINT                  * we'll control printing here !
.....     CALL      OPNPRINT                     * open print file
.
.                                                * read PEG parameters
          READ      CONTROLF,TEN3;CHADD1,CHADD2,CHPOST
          READ      CONTROLF,TWENTY3;*51,HSHORT
          READ      CONTROLF,SIXTY3;SNCOHEAN
.
          MOVE      ZERO,PEGTXTFL                * initialise e-mail file no.
.
          IF        INCPRTYN=1
            CALL      VRTAL000                   * read file on index 1
          ELSE
            CALL      VRTOU000                   * read file on index 3
          ENDIF
.
VRTIN900  DISPLAY   *P1:24,*EL
.....     CALL      CLSPRINT                     * close print file & print
.
VRTIN999  RETURN
.
.------------------------------------------------------------
. Process All in Range
.------------------------------------------------------------
VRTAL000  PACK      KEY7,STRPON,SP70
          CALL      RSSIPA1
          CALL      RPSIPA1
.
VRTAL100  CALL      RKSIPA1
          BRANCH    OVRCD,VRTAL900
          MATCH     SIPAPON,ENDPON
          GOTO      VRTAL900 IF LESS             * out of range ?
.
          CALL      VRTRN000                     * check security & range
          BRANCH    EXIT,VRTAL100
.
          CALL      GETSCR00
          CALL      VRTXX000                     * direct purch.ord output
          CALL      PUTSCR00
.
          GOTO      VRTAL100                     * get next record
.
VRTAL900
VRTAL999  RETURN
.
.------------------------------------------------------------
. Process Orders not yet printed in Range
.------------------------------------------------------------
VRTOU000  PACK      KEY15,SP8,STRPON,SP70
          CALL      RSSIPA3
          CALL      RPSIPA3
.
VRTOU100  CALL      RKSIPA3
          BRANCH    OVRCD,VRTOU900
          MATCH     SIPAPON,ENDPON
          GOTO      VRTOU900 IF LESS             * out of range ?
.
          CALL      VRTRN000                     * check security & range
          BRANCH    EXIT,VRTOU100
.
          CALL      VRTXX000                     * direct purch.ord output
.
          GOTO      VRTOU100                     * get next record
.
VRTOU900
VRTOU999  RETURN
.
.------------------------------------------------------------
. Check Security & Range Details
.------------------------------------------------------------
VRTRN000  MOVE      ZERO,EXIT
.                                                *  check warehouse security
          MATCH     SP70,SIPAWAR
          IF        !@EQUAL
            PACK      KEY9,PASSCODE,SIPAWAR,SP70
            CALL      RDSIWS1
            BRANCH    OVRCD,VRTRN900
          ENDIF
.
.                                                * check ranges
VRTRN100  MOVE      ZERO,EXIT
          MATCH     ORIGCODE,SP70
          IF        !@EQUAL
            MATCH     ORIGCODE,SIPAORI
            GOTO      VRTRN900 IF NOT EQUAL      * correct originator ?
          ENDIF
.
          IF        INCCOMYN=0
            REP       " 0",SIPADCM
            MATCH     "00000000",SIPADCM         * Date Completed
            GOTO      VRTRN900 IF NOT EQUAL      * completed ?
          ENDIF
.
          REP       " 0",SIPADCN
          MATCH     "00000000",SIPADCN           * Date Cancelled
          GOTO      VRTRN900 IF NOT EQUAL        * cancelled ?
.
          MATCH     STRMSG,SIPAMES
          GOTO      VRTRN900 IF LESS
          MATCH     SIPAMES,ENDMSG
          GOTO      VRTRN900 IF LESS
.
          MATCH     STRCON,SIPACON
          GOTO      VRTRN900 IF LESS
          MATCH     SIPACON,ENDCON
          GOTO      VRTRN900 IF LESS
.
          MATCH     STRCRD,SIPASUP
          GOTO      VRTRN900 IF LESS
          MATCH     SIPASUP,ENDCRD
          GOTO      VRTRN900 IF LESS
.
          MOVE      SIPASUP,KEY5
          CALL      RDAPMA1                      * read Supplier Master
          BRANCH    OVRCD,VRTRN100               * if no supplier - bypass
.
          GOTO      VRTRN999
.
VRTRN900  MOVE      ONE,EXIT
.
VRTRN999  RETURN
.
.------------------------------------------------------------
. Identify output type and direct output
.------------------------------------------------------------
VRTXX000  MOVE      ZERO,EXIT
.                                           * Check if PO can be E-mailed
.                                           * Does Supplier have an EAN?
          MATCH     SP15,APMACEDI
          GOTO      VRTXX200 IF EQUAL       * No EAN
.
          SCAN      "@",APMAUR2             * Is there an Email Address
          GOTO      VRTXX200 IF NOT EQUAL   * No Email Address
          RESET     APMAUR2
.
          CALL      SINORDEM                * E-mail the Order
          GOTO      VRTXX999
.
VRTXX200  MATCH     SP30,APMAUR2            * Is there a Fax/Email Address
          GOTO      VRTXX300 IF EQUAL       * No Fax/Email Address
.
          CALL      SINORDFX                * E-mail the Order
          GOTO      VRTXX999
.
.                                           * Create a spool file for each
.                                           * printed Purchase Order
VRTXX300  MOVE      ONE,NOPRINT             * we'll control printing here !
          CALL      OPNPRINT                * open print file
.
          CALL      SINORDPR                * Create the printed Order
.
          DISPLAY   *P1:24,*EL
          CALL      CLSPRINT                * close print file & print
.
VRTXX999  RETURN
.
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSCKIKY    
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
          INC       APSPPDIO/INC
          INC       IBAPRINT    
          INC       IBAPRNIO/INC
          INC       SINCCAIO/INC
          INC       SINCGAIO/INC
          INC       SINCIAIO/INC
          INC       SINCICIO/INC
          INC       SINCODIO/INC
          INC       SINCODKY    
          INC       SINDPCIO/INC
          INC       SINNATIO/INC
          INC       SINORDEM    
          INC       SINORDFX    
          INC       SINORDPR    
          INC       SINORIIO/INC
          INC       SINORIKY    
          INC       SINPEGIO/INC
          INC       SINPOAIO/INC
          INC       SINPOAKY    
          INC       SINPOBIO/INC
          INC       SINPOCIO/INC
          INC       SINPODIO/INC
          INC       SINSCDIO/INC
          INC       SINSUAIO/INC
          INC       SINWARIO/INC
          INC       SINWSEIO/INC
.
          INC       STDGENCD
.
