.-------------------------------------------------------------------------------
. Program       : CASWEB01 
.
. Function      : Extract Analysis Maintenance
.
. Modifications : 
. V11.02.01 01/08/2022  Bella Turco    TSK 0921957
.           Added NOMORE00 - Display "No more records" at end of list
.           Added PTCNNRTD - Displays number of rows set by parameter value
.---------------------------------------------------------------------------
. V10.04.01 31.03.2014  B.G.Ackland  CAR 299363
.           Replace META Tag Redirect with Javascript in Common RDIREC00
.           Routine
.---------------------------------------------------------------------------
. V10.03.01 16/07/2013  Jill Parkinson CAR 287923
.           Added include of PATCONFD
.---------------------------------------------------------------------------
. V9.05.B01 30/01/2006  Ebon Clements CAR 93186
.           Mods for REDIRECT length change. Recompiled for IBAWEBDF
.---------------------------------------------------------------------------
. V5.08.00 25.07.2000 Bronko Sosic
.           Created Program                                      
.                    
.---------------------------------------------------------------------------
          INC       IBAWEBDF    
          INC       WEBDATDF
          INC       PATCONFD/INC
          INC       CASTEFFD/INC    * Type of Episode FD
          INC       CASSTYFD/INC    * Analysis Type FD
          INC       CASXHDFD/INC    * Analysis Codes File FD
          INC       CASAMEFD/INC    * Analysis Measures FD
          INC       CASAGEFD/INC    * Casemix Age Ranges FD
.---------------------------------------------------------------------------
.  CGI Variables
.
LETTNUMB  FORM      3
TABLTYPE  FORM      1       * Nextpage parameter CGI parameter
NEXTPAGE  DIM       1       * Nextpage parameter CGI parameter
UPDTTYPE  DIM       1       * Update Type
STARTKEY  DIM       10      * Starting Key
.
CSTEF001  DIM       3       * Type of Episode
CSTEF002  DIM       35      * Description    
.
CSSTY001  DIM       3       * Type of Episode
CSSTY002  DIM       3       * Analysis Type  
CSSTY003  DIM       35      * Description    
CSSTY004  FORM      3       * Feild Length
CSSTY005  DIM       1       * Justify Right 0=No
CSSTY006  DIM       1       * Zero Fill 0=No 
CSSTY007  DIM       1       * Digit Entry 0=No
CSSTY008  DIM       1       * Date Entry 0=No 1=Yes
.
CSXHD001  DIM       3       *Type of Episode
CSXHD002  DIM       3       *Analysis Type
CSXHD003  DIM       10      *Analysis Code  
CSXHD004  DIM       35      *Description    
CSXHD005  DIM       10      *Summary Casemix
CSXHD006  DIM       10      *Summary Type A 
CSXHD007  DIM       10      *Summary Type B 
CSXHD008  DIM       10      *Summary Type C 
.
CSAME001  DIM       3       * Type of Episode
CSAME002  DIM       3       * Analysis Measure
CSAME003  DIM       35      * Description    
CSAME004  FORM      1       * Decimal Placese
CSAME005  DIM       6       * Unit of Measure
CSAME006  DIM       10      * Short Description
.
CSAGE001  DIM       1       * Range Definition Number 0-9
CSAGE002  DIM       3       * Group Code
CSAGE003  DIM       35      * Description
CSAGE004  DIM       3       * To Age
CSAGE005  DIM       2       * To Number of Months
CSAGE006  DIM       3       * To Number of Days
.
.---------------------------------------------------------------------------
PRGID     INIT      "CASWEB01"
VERSION   INIT      "V12.01.00"
PRGNAM    INIT      "Extract Analysis"
.---------------------------------------------------------------------------
          CALL      WEBINT00       * Initialise Fifo Etc.
          CALL      INIT0000       * Open Files
.
MAIN1000  CALL      WEBRED00       * Read Fifo WEBPID and USERID
.
          COMPARE   "999",REPORTNO * End Server Process on Report Option 999
          GOTO      MAIN9999 IF EQUAL
.
          BRANCH    REPORTNO,MAIN1100,MAIN1200,MAIN1300,MAIN1400,MAIN1500
.
          PACK      WEBTITLE,PRGID,SP1,VERSION,SP1,PRGNAM,SP70
          MOVE      "Invalid Option",WEBTITLE
          CALL      WEBERR00   * Create Output File and Write HTML Page Header
          GOTO      MAIN1000
.
MAIN1100  CALL      TEFCAS00        * Type of Episode Maintenance              
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
. 
MAIN1200  CALL      STYCAS00        * Analysis Type Maintenance              
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
. 
MAIN1300  CALL      XHDCAS00        * Analysis Codes Maintenance              
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
. 
MAIN1400  CALL      AMECAS00        * Analysis Measure Maintenance              
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
. 
MAIN1500  CALL      AGECAS00        * Casemix Age Range Maintenance          
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
. 
MAIN9999  MOVE      "SERVER SHUTDOWN COMPLETE",WEBTITLE
          CALL      WEBERR00
          STOP
.------------------------------------------------------------
. Output Next Page Based on CGI Parameter nextpage
.------------------------------------------------------------
NXTPAG00  MOVE      ZERO,F1
          MOVE      NEXTPAGE,F1
          BRANCH    F1,NXTPAG10,NXTPAG20,NXTPAG30,NXTPAG40
.
          CALL      WINCLS00
          GOTO      NXTPAG99
.
NXTPAG10  CALL      RDIREC00
          GOTO      NXTPAG99
.
NXTPAG20  CALL      GOBACK00      * Go Back 1 Html page
          GOTO      NXTPAG99
.
NXTPAG30  CALL      DAH20000      * Go Back 2 html pages 
          GOTO      NXTPAG99
.
NXTPAG40  CALL      GOBACK00
          GOTO      NXTPAG99
.
NXTPAG99  RETURN
.-------------------------------------------------------------------------------
.  Goes back 1 page
.-------------------------------------------------------------------------------
GOBACK00  CALL      OPENHTML
          BRANCH    EXIT,GOBACK99
          WRITE     HTMLFILE;"<script type=#"text/javascript#"> {":
                             "    alert(#"",WEBTITLE,"#");":
                             "    self.close();":
                             "    opener.history.go(-1);": 
                             "}":
                             "</script>"
          CALL      CLOSHTML
GOBACK99  RETURN
.-------------------------------------------------------------------------------
. Open Files and Initialize Variables
.-------------------------------------------------------------------------------
INIT0000  OPEN      CASTEFA1,"castefaf"    
          OPEN      CASSTYA1,"casstyaf"
          OPEN      CASXHDA1,"casxhdaf"
          OPEN      CASAMEA1,"casameaf"
          OPEN      CASAGEA1,"casageaf"
          READ      CONTROLF,HUND25;*238,PTCNNRTD
.
          MOVE      ZERO,F2
          MOVE      PTCNNRTD,F2
          IF        F2 = 0
            MOVE      "10",PTCNNRTD
          ENDIF
.
INIT9999  RETURN
.-------------------------------------------------------------------------------
. Clear Parameters
.-------------------------------------------------------------------------------
CLRPAR00  MOVE      ZERO,STARTNUM
          MOVE      ZERO,NORECORD
          MOVE      ZERO,REPORTNO
          MOVE      SP70,TEMPLATE
          MOVE      SP70,UPDTTYPE
          MOVE      SP70,ADMISSNO
          MOVE      SP70,URNUMBER 
          MOVE      SP70,NEXTPAGE
          PACK      REDIRECT,SP70,SP70,SP70,SP70
          MOVE      SP70,STARTKEY
.
          MOVE      SP70,CSTEF001
          MOVE      SP70,CSTEF002
.
          MOVE      SP70,CSSTY001
          MOVE      SP70,CSSTY002
          MOVE      SP70,CSSTY003
          MOVE      SP70,CSSTY004
          MOVE      SP70,CSSTY005
          MOVE      SP70,CSSTY006
          MOVE      SP70,CSSTY007
          MOVE      SP70,CSSTY008
.
          MOVE      SP70,CSXHD001
          MOVE      SP70,CSXHD002
          MOVE      SP70,CSXHD003
          MOVE      SP70,CSXHD004
          MOVE      SP70,CSXHD005
          MOVE      SP70,CSXHD006
          MOVE      SP70,CSXHD007
          MOVE      SP70,CSXHD008
.
          MOVE      SP70,CSAME001
          MOVE      SP70,CSAME002
          MOVE      SP70,CSAME003
          MOVE      ZERO,CSAME004
          MOVE      SP70,CSAME005
          MOVE      SP70,CSAME006
.
          MOVE      SP70,CSAGE001
          MOVE      SP70,CSAGE002
          MOVE      SP70,CSAGE003
          MOVE      SP70,CSAGE004
          MOVE      SP70,CSAGE005
          MOVE      SP70,CSAGE006
.
CLRPAR99  RETURN
.-------------------------------------------------------------------------------
. Set Parameters
.-------------------------------------------------------------------------------
SETPAR00  MATCH     "reportno=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,REPORTNO
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "urnumber=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,URNUMBER
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "admissno=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,ADMISSNO
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "template=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,TEMPLATE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "updttype=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,UPDTTYPE
            GOTO      SETPAR99
          ENDIF
.   
          MATCH     "nextpage=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,NEXTPAGE
            GOTO      SETPAR99
          ENDIF  
.
          MATCH     "redirect=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,REDIRECT
            GOTO      SETPAR99
          ENDIF
. 
          MATCH     "norecord=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,NORECORD
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "startnum=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,STARTNUM
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "startkey=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,STARTKEY
            PACK      STARTKEY,STARTKEY,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "cstef",QRYNAME
          IF        @EQUAL
            CALL      STTEF000
            GOTO      SETPAR99 
          ENDIF
.
          MATCH     "cssty",QRYNAME
          IF        @EQUAL
            CALL      STSTY000
            GOTO      SETPAR99 
          ENDIF
.
          MATCH     "csxhd",QRYNAME
          IF        @EQUAL
            CALL      STXHD000
            GOTO      SETPAR99 
          ENDIF
.
          MATCH     "csame",QRYNAME
          IF        @EQUAL
            CALL      STAME000
            GOTO      SETPAR99 
          ENDIF
.
          MATCH     "csage",QRYNAME
          IF        @EQUAL
            CALL      STAGE000
            GOTO      SETPAR99 
          ENDIF
.
SETPAR99  RETURN
.-------------------------------------------------------------------------------
.   Set Parameters for Option 1 - Type of Episode Maintenance
.-------------------------------------------------------------------------------
STTEF000  UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STTEF001,STTEF002
.
          GOTO      STTEF999
.
STTEF001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,CSTEF001
          PACK      CSTEF001,CSTEF001,SP70
          GOTO      STTEF999
.
STTEF002  MOVE      QRYDATA,CSTEF002
          GOTO      STTEF999
.
STTEF999  RETURN
.-------------------------------------------------------------------------------
.   Set Parameters for Option 2 - Analysis Type Maintenance
.-------------------------------------------------------------------------------
STSTY000  UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STSTY001,STSTY002,STSTY003,STSTY004,STSTY005,STSTY006:
                       STSTY007,STSTY008
.
          GOTO      STSTY999
.
STSTY001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,CSSTY001
          PACK      CSTEF001,CSSTY001,SP70
          GOTO      STSTY999
.
STSTY002  SQUEEZE   QRYDATA
          MOVE      QRYDATA,CSSTY002
          PACK      CSTEF002,CSSTY002,SP70
          GOTO      STSTY999
.
STSTY003  MOVE      QRYDATA,CSSTY003
          GOTO      STSTY999
.
STSTY004  MOVE      QRYDATA,CSSTY004
          GOTO      STSTY999
.
STSTY005  MOVE      QRYDATA,CSSTY005
          GOTO      STSTY999
.
STSTY006  MOVE      QRYDATA,CSSTY006
          GOTO      STSTY999
.
STSTY007  MOVE      QRYDATA,CSSTY007
          GOTO      STSTY999
.
STSTY008  MOVE      QRYDATA,CSSTY008
          GOTO      STSTY999
.
STSTY999  RETURN
.-------------------------------------------------------------------------------
.   Set Parameters for Option 3 - Analysis Codes Maintenance
.-------------------------------------------------------------------------------
STXHD000  UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STXHD001,STXHD002,STXHD003,STXHD004,STXHD005,STXHD006:
                       STXHD007,STXHD008
.
          GOTO      STXHD999
.
STXHD001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,CSXHD001
          PACK      CSXHD001,CSXHD001,SP70
          GOTO      STXHD999
.
STXHD002  SQUEEZE   QRYDATA
          MOVE      QRYDATA,CSXHD002
          PACK      CSXHD002,CSXHD002,SP70
          GOTO      STXHD999
.
STXHD003  SQUEEZE   QRYDATA
          MOVE      QRYDATA,CSXHD003
          PACK      CSXHD003,CSXHD003,SP70
          GOTO      STXHD999
.
STXHD004  MOVE      QRYDATA,CSXHD004
          GOTO      STXHD999
.
STXHD005  MOVE      QRYDATA,CSXHD005
          GOTO      STXHD999
.
STXHD006  MOVE      QRYDATA,CSXHD006
          GOTO      STXHD999
.
STXHD007  MOVE      QRYDATA,CSXHD007
          GOTO      STXHD999
.
STXHD008  MOVE      QRYDATA,CSXHD008
          GOTO      STXHD999
.
STXHD999  RETURN
.-------------------------------------------------------------------------------
.   Set Parameters for Option 4 - Analysis Measures Maintenance
.-------------------------------------------------------------------------------
STAME000  UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STAME001,STAME002,STAME003,STAME004,STAME005,STAME006
.
          GOTO      STAME999
.
STAME001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,CSAME001
          PACK      CSAME001,CSAME001,SP70
          GOTO      STAME999
.
STAME002  SQUEEZE   QRYDATA
          MOVE      QRYDATA,CSAME002
          PACK      CSAME002,CSAME002,SP70
          GOTO      STAME999
.
STAME003  MOVE      QRYDATA,CSAME003
          GOTO      STAME999
.
STAME004  MOVE      QRYDATA,CSAME004
          GOTO      STAME999
.
STAME005  MOVE      QRYDATA,CSAME005
          GOTO      STAME999
.
STAME006  MOVE      QRYDATA,CSAME006
          GOTO      STAME999
.
STAME999  RETURN
.-------------------------------------------------------------------------------
.   Set Parameters for Option 5 - Casemix Age Range Maintenance
.-------------------------------------------------------------------------------
STAGE000  UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STAGE001,STAGE002,STAGE003,STAGE004,STAGE005,STAGE006
.
          GOTO      STAGE999
.
STAGE001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,CSAGE001
          PACK      CSAGE001,CSAGE001,SP70
          GOTO      STAGE999
.
STAGE002  SQUEEZE   QRYDATA
          MOVE      QRYDATA,CSAGE002
          PACK      CSAME002,CSAGE002,SP70
          GOTO      STAGE999
.
STAGE003  MOVE      QRYDATA,CSAGE003
          GOTO      STAGE999
.
STAGE004  MOVE      QRYDATA,CSAGE004
          GOTO      STAGE999
.
STAGE005  MOVE      QRYDATA,CSAGE005
          GOTO      STAME999
.
STAGE006  MOVE      QRYDATA,CSAGE006
          GOTO      STAME999
.
STAGE999  RETURN
.-------------------------------------------------------------------------------
. Type of Episode Maintenance: Display,Add,Update,Delete
.-------------------------------------------------------------------------------
TEFCAS00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      TEFCAS40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      TEFCAS10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      TEFCAS20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      TEFCAS30 IF EQUAL
.
          GOTO      TEFCAS93
.
.         ************ ADD FORMACTION ***********
.
TEFCAS10  CALL      CHKTEF00      * Checks mandatory fields
          BRANCH    EXIT,TEFCAS99
.
          PACK      KEY3,CSTEF001,SP70
          CALL      RDCATE1
          COMPARE   ZERO,OVRCD
          GOTO      TEFCAS92 IF EQUAL
          CALL      TEFSAV00      * Moves input variables to file variables
          PACK      KEY3,CSTEF001,SP70
          CALL      WRCATE1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      TEFCAS99
.
.         ************ UPDATE FORMACTION **********
.
TEFCAS20  PACK      KEY3,CSTEF001,SP70
          CALL      RDCATE1
          BRANCH    OVRCD,TEFCAS91
          CALL      CHKTEF00      * Checks mandatory fields
          BRANCH    EXIT,TEFCAS99
.
          CALL      TEFSAV00      * Moves input variables to file variables
          PACK      KEY3,CSTEF001,SP70
          CALL      UPCATE1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      TEFCAS99
.
.         ************ DELETE FORMACTION **********
.
TEFCAS30  PACK      KEY3,CSTEF001,SP70
          CALL      RDCATE1
          BRANCH    OVRCD,TEFCAS91
          CALL      DECATE1
.
          MOVE      ZERO,EXIT
          GOTO      TEFCAS99
.
.         ************ DISPLAY FORMACTION **********
.
TEFCAS40  PACK      KEY3,CSTEF001,SP70
          CALL      RDCATE1
          IF        OVRCD=1
            CALL      CLRTEF00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Episode Type File Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,TEFCAS99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      TEFCAS99
.
TEFCAS91  MOVE      "Type of Episode does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      TEFCAS99
.
TEFCAS92  MOVE      "Type of Episode exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      TEFCAS99
.
TEFCAS93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      TEFCAS99
.
TEFCAS99  RETURN
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRTEF00  MOVE      SP70,CATETOE
          MOVE      SP70,CATEDES
.
CLRTEF99  RETURN
.-----------------------------------------------------------
. Save routine - move cgi parameters into file variables
.-----------------------------------------------------------
TEFSAV00  MOVE      CSTEF001,CATETOE
          MOVE      CSTEF002,CATEDES
.
TEFSAV99  RETURN
.------------------------------------------------------------
. * Checks mandatory fields
.------------------------------------------------------------
CHKTEF00  RESET     CSTEF001
          MATCH     SP70,CSTEF001
          GOTO      CHKTEF90 IF EQUAL
.
          GOTO      CHKTEF98
.
CHKTEF90  MOVE      "Type of Episode cannot be blank!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKTEF99
.
CHKTEF98  MOVE      ZERO,EXIT
CHKTEF99  RETURN
.-------------------------------------------------------------------------------
. Analysis Type Maintenance: Display,Add,Update,Delete
.-------------------------------------------------------------------------------
STYCAS00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      STYCAS40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      STYCAS10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      STYCAS20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      STYCAS30 IF EQUAL
.
          GOTO      STYCAS93
.
.         ************ ADD FORMACTION ***********
.
STYCAS10  CALL      CHKSTY00      * Checks mandatory fields
          BRANCH    EXIT,STYCAS99
.
          PACK      KEY6,CSSTY001,CSSTY002,SP70
          CALL      RDCAST1
          COMPARE   ZERO,OVRCD
          GOTO      STYCAS92 IF EQUAL
          CALL      STYSAV00      * Moves input variables to file variables
          PACK      KEY6,CSSTY001,CSSTY002,SP70
          CALL      WRCAST1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      STYCAS99
.
.         ************ UPDATE FORMACTION **********
.
STYCAS20  PACK      KEY6,CSSTY001,CSSTY002,SP70
          CALL      RDCAST1
          BRANCH    OVRCD,STYCAS91
          CALL      CHKSTY00      * Checks mandatory fields
          BRANCH    EXIT,STYCAS99
.
          CALL      STYSAV00      * Moves input variables to file variables
          PACK      KEY6,CSSTY001,CSSTY002,SP70
          CALL      UPCAST1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      STYCAS99
.
.         ************ DELETE FORMACTION **********
.
STYCAS30  PACK      KEY6,CSSTY001,CSSTY002,SP70
          CALL      RDCAST1
          BRANCH    OVRCD,STYCAS91
          CALL      DECAST1
.
          MOVE      ZERO,EXIT
          GOTO      STYCAS99
.
.         ************ DISPLAY FORMACTION **********
.
STYCAS40  PACK      KEY3,CSSTY001,SP70
          CALL      RDCATE1
          BRANCH    OVRCD,STYCAS90

          PACK      KEY6,CSSTY001,CSSTY002,SP70
          CALL      RDCAST1
          IF        OVRCD=1
            CALL      CLRSTY00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Analysis Type File Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,STYCAS99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      STYCAS99
.
STYCAS90  MOVE      "Type of Episode does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      STYCAS99
.
STYCAS91  MOVE      "Analysis Type does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      STYCAS99
.
STYCAS92  MOVE      "Analysis Type exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      STYCAS99
.
STYCAS93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      STYCAS99
.
STYCAS99  RETURN
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRSTY00  MOVE      SP70,CASTTOE
          MOVE      SP70,CASTSTY
          MOVE      SP70,CASTDES
          MOVE      ZERO,CASTLEN
          MOVE      SP70,CASTJR 
          MOVE      SP70,CASTZF 
          MOVE      SP70,CASTDE 
          MOVE      SP70,CASTDAT
.
CLRSTY99  RETURN
.-----------------------------------------------------------
. Save routine - move cgi parameters into file variables
.-----------------------------------------------------------
STYSAV00  MOVE      CSSTY001,CASTTOE
          MOVE      CSSTY002,CASTSTY
          MOVE      CSSTY003,CASTDES
          MOVE      CSSTY004,CASTLEN
          MOVE      CSSTY005,CASTJR 
          MOVE      CSSTY006,CASTZF 
          MOVE      CSSTY007,CASTDE 
          MOVE      CSSTY008,CASTDAT
.
STYSAV99  RETURN
.------------------------------------------------------------
. * Checks mandatory fields
.------------------------------------------------------------
CHKSTY00  RESET     CSSTY001
          MATCH     SP70,CSSTY001
          GOTO      CHKSTY90 IF EQUAL
.
          RESET     CSSTY002
          MATCH     SP70,CSSTY002
          GOTO      CHKSTY91 IF EQUAL

          GOTO      CHKSTY98
.
CHKSTY90  MOVE      "Type of Episode cannot be blank!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKSTY99
.
CHKSTY91  MOVE      "Analysis Type cannot be blank!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKSTY99
.
CHKSTY98  MOVE      ZERO,EXIT
CHKSTY99  RETURN
.-------------------------------------------------------------------------------
. Analysis Code Maintenance: Display,Add,Update,Delete
.-------------------------------------------------------------------------------
XHDCAS00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      XHDCAS40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      XHDCAS10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      XHDCAS20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      XHDCAS30 IF EQUAL
.
          GOTO      XHDCAS93
.
.         ************ ADD FORMACTION ***********
.
XHDCAS10  CALL      CHKXHD00      * Checks mandatory fields
          BRANCH    EXIT,XHDCAS99
.
          PACK      KEY16,CSXHD001,CSXHD002,CSXHD003,SP70
          CALL      RDCAXH1
          COMPARE   ZERO,OVRCD
          GOTO      XHDCAS92 IF EQUAL
          CALL      XHDSAV00      * Moves input variables to file variables
          PACK      KEY16,CSXHD001,CSXHD002,CSXHD003,SP70
          CALL      WRCAXH1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      XHDCAS99
.
.         ************ UPDATE FORMACTION **********
.
XHDCAS20  PACK      KEY16,CSXHD001,CSXHD002,CSXHD003,SP70
          CALL      RDCAXH1
          BRANCH    OVRCD,XHDCAS91
          CALL      CHKXHD00      * Checks mandatory fields
          BRANCH    EXIT,XHDCAS99
.
          CALL      XHDSAV00      * Moves input variables to file variables
          PACK      KEY16,CSXHD001,CSXHD002,CSXHD003,SP70
          CALL      UPCAXH1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      XHDCAS99
.
.         ************ DELETE FORMACTION **********
.
XHDCAS30  PACK      KEY16,CSXHD001,CSXHD002,CSXHD003,SP70
          CALL      RDCAXH1
          BRANCH    OVRCD,XHDCAS91
          CALL      DECAXH1
.
          MOVE      ZERO,EXIT
          GOTO      XHDCAS99
.
.         ************ DISPLAY FORMACTION **********
.
XHDCAS40  PACK      KEY3,CSXHD001,SP70
          CALL      RDCATE1
          BRANCH    OVRCD,XHDCAS90
          
          PACK      KEY6,CSXHD001,CSXHD002,SP70
          CALL      RDCAST1
          BRANCH    OVRCD,XHDCAS90

          PACK      KEY16,CSXHD001,CSXHD002,CSXHD003,SP70
          CALL      RDCAXH1
          IF        OVRCD=1
            CALL      CLRXHD00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Analysis Code File Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,XHDCAS99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      XHDCAS99
.
XHDCAS90  MOVE      "Type of Episode does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      XHDCAS99
.
XHDCAS91  MOVE      "Analysis Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      XHDCAS99
.
XHDCAS92  MOVE      "Analysis Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      XHDCAS99
.
XHDCAS93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      XHDCAS99
.
XHDCAS99  RETURN
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRXHD00  MOVE      SP70,CAXHTOE
          MOVE      SP70,CAXHSTY
          MOVE      SP70,CAXHKEY
          MOVE      SP70,CAXHDES
          MOVE      SP70,CAXHSUM 
          MOVE      SP70,CAXHSUMA 
          MOVE      SP70,CAXHSUMB 
          MOVE      SP70,CAXHSUMC 
.
CLRXHD99  RETURN
.-----------------------------------------------------------
. Save routine - move cgi parameters into file variables
.-----------------------------------------------------------
XHDSAV00  MOVE      CSXHD001,CAXHTOE
          MOVE      CSXHD002,CAXHSTY
          MOVE      CSXHD003,CAXHKEY
          MOVE      CSXHD004,CAXHDES
          MOVE      CSXHD005,CAXHSUM 
          MOVE      CSXHD006,CAXHSUMA 
          MOVE      CSXHD007,CAXHSUMB 
          MOVE      CSXHD008,CAXHSUMC 
.
XHDSAV99  RETURN
.------------------------------------------------------------
. * Checks mandatory fields
.------------------------------------------------------------
CHKXHD00  RESET     CSXHD001
          MATCH     SP70,CSXHD001
          GOTO      CHKXHD90 IF EQUAL
.
          RESET     CSXHD002
          MATCH     SP70,CSXHD002
          GOTO      CHKXHD91 IF EQUAL
.
          RESET     CSXHD003
          MATCH     SP70,CSXHD003
          GOTO      CHKXHD92 IF EQUAL
.
          GOTO      CHKXHD98
.
CHKXHD90  MOVE      "Type of Episode cannot be blank!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKXHD99
.
CHKXHD91  MOVE      "Analysis Type cannot be blank!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKXHD99
.
CHKXHD92  MOVE      "Analysis Code cannot be blank!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKXHD99
.
CHKXHD98  MOVE      ZERO,EXIT
CHKXHD99  RETURN
.-------------------------------------------------------------------------------
. Analysis Measures Maintenance: Display,Add,Update,Delete
.-------------------------------------------------------------------------------
AMECAS00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      AMECAS40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      AMECAS10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      AMECAS20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      AMECAS30 IF EQUAL
.
          GOTO      AMECAS93
.
.         ************ ADD FORMACTION ***********
.
AMECAS10  CALL      CHKAME00      * Checks mandatory fields
          BRANCH    EXIT,AMECAS99
.
          PACK      KEY6,CSAME001,CSAME002,SP70
          CALL      RDCAAM1
          COMPARE   ZERO,OVRCD
          GOTO      AMECAS92 IF EQUAL
          CALL      AMESAV00      * Moves input variables to file variables
          PACK      KEY6,CSAME001,CSAME002,SP70
          CALL      WRCAAM1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      AMECAS99
.
.         ************ UPDATE FORMACTION **********
.
AMECAS20  PACK      KEY6,CSAME001,CSAME002,SP70
          CALL      RDCAAM1
          BRANCH    OVRCD,AMECAS91
          CALL      CHKAME00      * Checks mandatory fields
          BRANCH    EXIT,AMECAS99
.
          CALL      AMESAV00      * Moves input variables to file variables
          PACK      KEY6,CSAME001,CSAME002,SP70
          CALL      UPCAAM1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      AMECAS99
.
.         ************ DELETE FORMACTION **********
.
AMECAS30  PACK      KEY6,CSAME001,CSAME002,SP70
          CALL      RDCAAM1
          BRANCH    OVRCD,AMECAS91
          CALL      DECAAM1
.
          MOVE      ZERO,EXIT
          GOTO      AMECAS99
.
.         ************ DISPLAY FORMACTION **********
.
AMECAS40  PACK      KEY3,CSAME001,SP70
          CALL      RDCATE1
          BRANCH    OVRCD,AMECAS90

          PACK      KEY6,CSAME001,CSAME002,SP70
          CALL      RDCAAM1
          IF        OVRCD=1
            CALL      CLRAME00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Analysis Measures File Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,AMECAS99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      AMECAS99
.
AMECAS90  MOVE      "Type of Episode does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      AMECAS99
.
AMECAS91  MOVE      "Analysis Measures does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      AMECAS99
.
AMECAS92  MOVE      "Analysis Measures exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      AMECAS99
.
AMECAS93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      AMECAS99
.
AMECAS99  RETURN
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRAME00  MOVE      SP70,CAAMTOE
          MOVE      SP70,CAAMAM 
          MOVE      SP70,CAAMDES
          MOVE      ZERO,CAAMDEC
          MOVE      SP70,CAAMUNT
          MOVE      SP70,CAAMSDEC
.
CLRAME99  RETURN
.-----------------------------------------------------------
. Save routine - move cgi parameters into file variables
.-----------------------------------------------------------
AMESAV00  MOVE      CSAME001,CAAMTOE
          MOVE      CSAME002,CAAMAM 
          MOVE      CSAME003,CAAMDES
          MOVE      CSAME004,CAAMDEC
          MOVE      CSAME005,CAAMUNT
          MOVE      CSAME006,CAAMSDEC
.
AMESAV99  RETURN
.------------------------------------------------------------
. * Checks mandatory fields
.------------------------------------------------------------
CHKAME00  RESET     CSAME001
          MATCH     SP70,CSAME001
          GOTO      CHKAME90 IF EQUAL
.
          RESET     CSAME002
          MATCH     SP70,CSAME002
          GOTO      CHKAME91 IF EQUAL

          GOTO      CHKAME98
.
CHKAME90  MOVE      "Type of Episode cannot be blank!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKAME99
.
CHKAME91  MOVE      "Analysis Measure cannot be blank!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKAME99
.
CHKAME98  MOVE      ZERO,EXIT
CHKAME99  RETURN
.-------------------------------------------------------------------------------
. Casemix Age Range Maintenance: Display,Add,Update,Delete
.-------------------------------------------------------------------------------
AGECAS00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      AGECAS40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      AGECAS10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      AGECAS20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      AGECAS30 IF EQUAL
.
          GOTO      AGECAS93
.
.         ************ ADD FORMACTION ***********
.
AGECAS10  CALL      CHKAGE00      * Checks mandatory fields
          BRANCH    EXIT,AGECAS99
.
          PACK      KEY4,CSAGE001,CSAGE002,SP70
          CALL      RDCCAG1
          COMPARE   ZERO,OVRCD
          GOTO      AGECAS92 IF EQUAL
          CALL      AGESAV00      * Moves input variables to file variables
          PACK      KEY4,CSAGE001,CSAGE002,SP70
          CALL      WRCCAG1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      AGECAS99
.
.         ************ UPDATE FORMACTION **********
.
AGECAS20  PACK      KEY4,CSAGE001,CSAGE002,SP70
          CALL      RDCCAG1
          BRANCH    OVRCD,AGECAS91
          CALL      CHKAGE00      * Checks mandatory fields
          BRANCH    EXIT,AGECAS99
.
          CALL      AGESAV00      * Moves input variables to file variables
          PACK      KEY4,CSAGE001,CSAGE002,SP70
          CALL      UPCCAG1       * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      AGECAS99
.
.         ************ DELETE FORMACTION **********
.
AGECAS30  PACK      KEY4,CSAGE001,CSAGE002,SP70
          CALL      RDCCAG1
          BRANCH    OVRCD,AGECAS91
          CALL      DECCAG1
.
          MOVE      ZERO,EXIT
          GOTO      AGECAS99
.
.         ************ DISPLAY FORMACTION **********
.
AGECAS40  PACK      KEY4,CSAGE001,CSAGE002,SP70
          CALL      RDCCAG1
          IF        OVRCD=1
            CALL      CLRAGE00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Casemix Age Range File Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,AGECAS99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      AGECAS99
.
AGECAS91  MOVE      "Range Number does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      AGECAS99
.
AGECAS92  MOVE      "Range Number exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      AGECAS99
.
AGECAS93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      AGECAS99
.
AGECAS99  RETURN
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRAGE00  MOVE      SP70,CCAGDEF
          MOVE      SP70,CCAGGRP 
          MOVE      SP70,CCAGDES
          MOVE      SP70,CCAGTAGE
          MOVE      SP70,CCAGTMTH
          MOVE      SP70,CCAGTDAY
.
CLRAGE99  RETURN
.-----------------------------------------------------------
. Save routine - move cgi parameters into file variables
.-----------------------------------------------------------
AGESAV00  MOVE      CSAGE001,CCAGDEF
          MOVE      CSAGE002,CCAGGRP 
          MOVE      CSAGE003,CCAGDES
          MOVE      CSAGE004,CCAGTAGE
          MOVE      CSAGE005,CCAGTMTH
          MOVE      CSAGE006,CCAGTDAY
.
AGESAV99  RETURN
.------------------------------------------------------------
. * Checks mandatory fields
.------------------------------------------------------------
CHKAGE00  RESET     CSAGE001
          MATCH     SP70,CSAGE001
          GOTO      CHKAGE90 IF EQUAL
.
          RESET     CSAGE002
          MATCH     SP70,CSAGE002
          GOTO      CHKAGE91 IF EQUAL

          GOTO      CHKAGE98
.
CHKAGE90  MOVE      "Range Definition cannot be blank!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKAGE99
.
CHKAGE91  MOVE      "Group Code cannot be blank!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKAGE99
.
CHKAGE98  MOVE      ZERO,EXIT
CHKAGE99  RETURN
.-------------------------------------------------------------------------------
. Process Fields called from WEBBOD00 
.-------------------------------------------------------------------------------
PROFLD00  BRANCH    REPORTNO,PROFLD10,PROFLD20,PROFLD30,PROFLD40,PROFLD50
          GOTO      PROFLD99
.
.       Type of episode Maintenance
.
PROFLD10  CALL      CAST0000       * Type of Episode Maintanance
          GOTO      PROFLD99
.
.       Analysis Types Maintenance
.
PROFLD20  BRANCH    FLDSETNO,PROFLD21,PROFLD22
.
PROFLD21  CALL      CAST0000       * Type of Episode Maintanance
          GOTO      PROFLD99
.
PROFLD22  CALL      CASS0000       * Analysis Types Maintenance
          GOTO      PROFLD99
.
.       Analysis Code Maintenance
.
PROFLD30  BRANCH    FLDSETNO,PROFLD31,PROFLD32,PROFLD33
.
PROFLD31  CALL      CAST0000       * Type of Episode Maintanance
          GOTO      PROFLD99
.
PROFLD32  CALL      CASS0000       * Analysis Types Maintenance
          GOTO      PROFLD99
.
PROFLD33  CALL      CASX0000       * Analysis Codes Maintenance
          GOTO      PROFLD99
.
.       Analysis Measures Maintenance
.
PROFLD40  BRANCH    FLDSETNO,PROFLD41,PROFLD42
.
PROFLD41  CALL      CAST0000       * Type of Episode Maintanance
          GOTO      PROFLD99
.
PROFLD42  CALL      CASA0000       * Analysis Measures Maintenance
          GOTO      PROFLD99
.
.       Casemix Age Range Maintenance
.
PROFLD50  CALL      AGEC0000       * Casemix Age Range Maintanance
          GOTO      PROFLD99
.
PROFLD99  RETURN
.-----------------------------------------------------------
. Option 1 - Type of Episode Mantenance
.-----------------------------------------------------------
CAST0000  BRANCH    FLDITMNO,CAST0100,CAST0200,CAST0300,CAST0400,CAST0500
.
          GOTO      CAST9999
.
CAST0100  WRITE     HTMLFILE;CATETOE;    * Type of Episode
          GOTO      CAST9999
.
CAST0200  WRITE     HTMLFILE;CATEDES;    * Description
          GOTO      CAST9999
.
CAST0300  CALL      CASTB000     * Table 
          GOTO      CAST9999
.
CAST0400  CALL      NEXTPR00     * Link to Next Set of Codes
          GOTO      CAST9999
.
CAST0500  CALL      PREVPR00     * Link to Prev Set of Codes
          GOTO      CAST9999
.
CAST9999  RETURN
.-----------------------------------------------------------
. Option 2 - Analysis Type Maintenance
.-----------------------------------------------------------
CASS0000  BRANCH    FLDITMNO,CASS0100,CASS0200,CASS0300,CASS0400,CASS0500:
                             CASS0600,CASS0700,CASS0800,CASS0900,CASS1000:
                             CASS1100
.
          GOTO      CASS9999
.
CASS0100  WRITE     HTMLFILE;CASTTOE;   
          GOTO      CASS9999
.
CASS0200  WRITE     HTMLFILE;CASTSTY;   
          GOTO      CASS9999
.
CASS0300  WRITE     HTMLFILE;CASTDES;   
          GOTO      CASS9999
.
CASS0400  WRITE     HTMLFILE;CASTLEN;   
          GOTO      CASS9999
.
CASS0500  WRITE     HTMLFILE;CASTJR;   
          GOTO      CASS9999
.
CASS0600  WRITE     HTMLFILE;CASTZF;   
          GOTO      CASS9999
.
CASS0700  WRITE     HTMLFILE;CASTDE;   
          GOTO      CASS9999
.
CASS0800  WRITE     HTMLFILE;CASTDAT;   
          GOTO      CASS9999
.
CASS0900  CALL      STYTB000     * Table 
          GOTO      CASS9999
.
CASS1000  CALL      NEXTPR00     * Link to Next Set of Codes
          GOTO      CASS9999
.
CASS1100  CALL      PREVPR00     * Link to Prev Set of Codes
          GOTO      CASS9999
.
CASS9999  RETURN
.-----------------------------------------------------------
. Option 3 - Analysis Code Maintenance
.-----------------------------------------------------------
CASX0000  BRANCH    FLDITMNO,CASX0100,CASX0200,CASX0300,CASX0400,CASX0500:
                             CASX0600,CASX0700,CASX0800,CASX0900,CASX1000:
                             CASX1100
.
          GOTO      CASX9999
.
CASX0100  WRITE     HTMLFILE;CAXHTOE;   
          GOTO      CASX9999
.
CASX0200  WRITE     HTMLFILE;CAXHSTY;   
          GOTO      CASX9999
.
CASX0300  WRITE     HTMLFILE;CAXHKEY;   
          GOTO      CASX9999
.
CASX0400  WRITE     HTMLFILE;CAXHDES;   
          GOTO      CASX9999
.
CASX0500  WRITE     HTMLFILE;CAXHSUM;   
          GOTO      CASX9999
.
CASX0600  WRITE     HTMLFILE;CAXHSUMA;   
          GOTO      CASX9999
.
CASX0700  WRITE     HTMLFILE;CAXHSUMB;   
          GOTO      CASX9999
.
CASX0800  WRITE     HTMLFILE;CAXHSUMC;   
          GOTO      CASX9999
.
CASX0900  CALL      XHDTB000     * Table 
          GOTO      CASX9999
.
CASX1000  CALL      NEXTPR00     * Link to Next Set of Codes
          GOTO      CASX9999
.
CASX1100  CALL      PREVPR00     * Link to Prev Set of Codes
          GOTO      CASX9999
.
CASX9999  RETURN
.-----------------------------------------------------------
. Option 4 - Analysis Measures Maintenance
.-----------------------------------------------------------
CASA0000  BRANCH    FLDITMNO,CASA0100,CASA0200,CASA0300,CASA0400,CASA0500:
                             CASA0600,CASA0700,CASA0800,CASA0900
.
          GOTO      CASA9999
.
CASA0100  WRITE     HTMLFILE;CAAMTOE;   
          GOTO      CASA9999
.
CASA0200  WRITE     HTMLFILE;CAAMAM;   
          GOTO      CASA9999
.
CASA0300  WRITE     HTMLFILE;CAAMDES;   
          GOTO      CASA9999
.
CASA0400  WRITE     HTMLFILE;CAAMDEC;   
          GOTO      CASA9999
.
CASA0500  WRITE     HTMLFILE;CAAMUNT;   
          GOTO      CASA9999
.
CASA0600  WRITE     HTMLFILE;CAAMSDEC;   
          GOTO      CASA9999
.
CASA0700  CALL      AMETB000     * Table 
          GOTO      CASA9999
.
CASA0800  CALL      NEXTPR00     * Link to Next Set of Codes
          GOTO      CASA9999
.
CASA0900  CALL      PREVPR00     * Link to Prev Set of Codes
          GOTO      CASA9999
.
CASA9999  RETURN
.-----------------------------------------------------------
. Option 5 - Casemix Age Range Maintenance
.-----------------------------------------------------------
AGEC0000  BRANCH    FLDITMNO,AGEC0100,AGEC0200,AGEC0300,AGEC0400,AGEC0500:
                             AGEC0600,AGEC0700,AGEC0800,AGEC0900
.
          GOTO      AGEC9999
.
AGEC0100  WRITE     HTMLFILE;CCAGDEF;   
          GOTO      AGEC9999
.
AGEC0200  WRITE     HTMLFILE;CCAGGRP;   
          GOTO      AGEC9999
.
AGEC0300  WRITE     HTMLFILE;CCAGDES;   
          GOTO      AGEC9999
.
AGEC0400  WRITE     HTMLFILE;CCAGTAGE;   
          GOTO      AGEC9999
.
AGEC0500  WRITE     HTMLFILE;CCAGTMTH;   
          GOTO      AGEC9999
.
AGEC0600  WRITE     HTMLFILE;CCAGTDAY;   
          GOTO      AGEC9999
.
AGEC0700  CALL      AGETB000     * Table 
          GOTO      AGEC9999
.
AGEC0800  CALL      NEXTPR00     * Link to Next Set of Codes
          GOTO      AGEC9999
.
AGEC0900  CALL      PREVPR00     * Link to Prev Set of Codes
          GOTO      AGEC9999
.
AGEC9999  RETURN
.-----------------------------------------------------------
. Link to Next Group Codes           
.-----------------------------------------------------------
NEXTPR00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM+NORECORD,F3
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
.
          WRITE     HTMLFILE;"casweb01.pbl":
                                 "?reportno=",F1:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&csame001=",CSAME001:
                                 "&csame002=",CSAME002:
                                 "&csxhd001=",CSXHD001:
                                 "&csxhd002=",CSXHD002:
                                 "&csxhd003=",CSXHD003:
                                 "&cssty001=",CSSTY001:
                                 "&cssty002=",CSSTY002;
.
                                 
NEXTPR99  RETURN
.-----------------------------------------------------------
. Link to Prev Group Codes           
.-----------------------------------------------------------
PREVPR00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM-NORECORD,F3
          IF        F3<0
            MOVE      ZERO,F3
          ENDIF
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
.
          WRITE     HTMLFILE;"casweb01.pbl":
                                 "?reportno=",F1:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2: 
                                 "&csame001=",CSAME001:
                                 "&csame002=",CSAME002:
                                 "&csxhd001=",CSXHD001:
                                 "&csxhd002=",CSXHD002:
                                 "&csxhd003=",CSXHD003:
                                 "&cssty001=",CSSTY001:
                                 "&cssty002=",CSSTY002;
.
PREVPR99  RETURN
.------------------------------------------------------------
. NOMORE00 - Display "No more records" at end of list
.------------------------------------------------------------
NOMORE00  WRITE     HTMLFILE;"<tr>":
                             "<td class=RedCell colspan=20 align=center>":
                             "No more records</td>"
.
NOMORE99  RETURN
.-----------------------------------------------------------
. Link for Redirect            
.-----------------------------------------------------------
LNKPRI00  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127

          MOVE      REPORTNO,F1
.
          WRITE     HTMLFILE;LINKPRG,"#.pbl":
                                 "?reportno=",LINKREP:
                                 "&template=",LINKTEM;
.
LNKPRI99  RETURN
.------------------------------------------------------------
. Table of Type of Episode Files
.------------------------------------------------------------
CASTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      CASHD000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY3,STARTKEY,SP70
          CALL      RDCATE1
          IF        OVRCD=0
            CALL      RPCATE1 
          ENDIF
CASTB100  CALL      RKCATE1 
          BRANCH    OVRCD,CASTB900
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      CASTB100
          ENDIF
.
          CALL      CASRW000    * Display Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      CASTB100 IF NOT EQUAL
          GOTO      CASTB999
.
CASTB900  CALL      NOMORE00      * Display No More Records Message
.
CASTB999  RETURN
.------------------------------------------------------------
. Type of Episode Details (TABLE HEADING)
.------------------------------------------------------------
CASHD000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell width=15%>":
                               "Episode</td>":
                               "<td class=HeadingCell width=70%>":
                               "Description</td>":
                             "</tr>"
.
CASHD999  RETURN
.------------------------------------------------------------
. Type of Episode Maintenance (TABLE ROW)
.------------------------------------------------------------
CASRW000  MATCH     SP70,CATEDES 
          IF        @EQUAL
            MOVE      "&nbsp;",KEY35
          ELSE
            MOVE      CATEDES,KEY35
          ENDIF
.
          WRITE     HTMLFILE;"<tr><td nowrap>":
                             "<A HREF='javascript:ShowDetail01":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&cstef001=",CATETOE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif ":
                             "hspace=4 border=0 align=absmiddle></a>":
                             CATETOE,"</td>":
                             "<td>",KEY35,"</td>":
                             "</tr>";
.
CASRW999 RETURN
.------------------------------------------------------------
. Table of Analysis Type Files
.------------------------------------------------------------
STYTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      STYHD000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY6,CSSTY001,STARTKEY,SP70
          CALL      RDCAST1
          IF        OVRCD=0
            CALL      RPCAST1 
          ENDIF
STYTB100  CALL      RKCAST1 
          BRANCH    OVRCD,STYTB900
.
          MATCH     CSSTY001,CASTTOE
          GOTO      STYTB100 IF NOT EQUAL
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      STYTB100
          ENDIF
.
          CALL      STYRW000    * Display Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      STYTB100 IF NOT EQUAL
          GOTO      STYTB999
.
STYTB900  CALL      NOMORE00    * Display No More Records Message
.
STYTB999  RETURN
.------------------------------------------------------------
. Analysis Type Details (TABLE HEADING)
.------------------------------------------------------------
STYHD000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell width=30%>":
                               "Analysis Type</td>":
                               "<td class=HeadingCell width=70%>":
                               "Description</td>":
                             "</tr>"
.
STYHD999  RETURN
.------------------------------------------------------------
. Type of Episode Maintenance (TABLE ROW)
.------------------------------------------------------------
STYRW000  MATCH     SP70,CASTDES 
          IF        @EQUAL
            MOVE      "&nbsp;",KEY35
          ELSE
            MOVE      CASTDES,KEY35
          ENDIF
.
          WRITE     HTMLFILE;"<tr><td nowrap>":
                             "<A HREF='javascript:ShowDetail02":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&cssty002=",CASTSTY:
                             "&cssty001=",CASTTOE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif ":
                             "hspace=4 border=0 align=absmiddle></a>":
                             CASTSTY,"</td>":
                             "<td>",KEY35,"</td>":
                             "</tr>";
.
STYRW999 RETURN
.------------------------------------------------------------
. Table of Analysis Code Files
.------------------------------------------------------------
XHDTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      XHDHD000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY16,CSXHD001,CSXHD002,STARTKEY,SP70
          CALL      RDCAXH1
          IF        OVRCD=0
            CALL      RPCAXH1 
          ENDIF
XHDTB100  CALL      RKCAXH1 
          BRANCH    OVRCD,XHDTB900
.
          MATCH     CSXHD001,CAXHTOE
          GOTO      XHDTB100 IF NOT EQUAL
.
          MATCH     CSXHD002,CAXHSTY
          GOTO      XHDTB100 IF NOT EQUAL
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      XHDTB100
          ENDIF
.
          CALL      XHDRW000    * Display Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      XHDTB100 IF NOT EQUAL
          GOTO      XHDTB999
.
XHDTB900  CALL      NOMORE00    * Display No More Records Message
.
XHDTB999  RETURN
.------------------------------------------------------------
. Analysis Code Details (TABLE HEADING)
.------------------------------------------------------------
XHDHD000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell width=30%>":
                               "Analysis Code</td>":
                               "<td class=HeadingCell width=70%>":
                               "Description</td>":
                             "</tr>"
.
XHDHD999  RETURN
.------------------------------------------------------------
. Analysis Code Maintenance (TABLE ROW)
.------------------------------------------------------------
XHDRW000  MATCH     SP70,CAXHDES 
          IF        @EQUAL
            MOVE      "&nbsp;",KEY35
          ELSE
            MOVE      CAXHDES,KEY35
          ENDIF
.
          WRITE     HTMLFILE;"<tr><td nowrap>":
                             "<A HREF='javascript:ShowDetail03":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&csxhd003=",CAXHKEY:
                             "&csxhd002=",CAXHSTY:
                             "&csxhd001=",CAXHTOE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif ":
                             "hspace=4 border=0 align=absmiddle></a>":
                             CAXHKEY,"</td>":
                             "<td>",KEY35,"</td>":
                             "</tr>";
.
XHDRW999 RETURN
.------------------------------------------------------------
. Table of Analysis Measures Files
.------------------------------------------------------------
AMETB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      AMEHD000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY6,CSAME001,STARTKEY,SP70
          CALL      RDCAAM1
          IF        OVRCD=0
            CALL      RPCAAM1 
          ENDIF
AMETB100  CALL      RKCAAM1 
          BRANCH    OVRCD,AMETB900
.
          MATCH     CSAME001,CAAMTOE
          GOTO      AMETB100 IF NOT EQUAL
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      AMETB100
          ENDIF
.
          CALL      AMERW000    * Display Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      AMETB100 IF NOT EQUAL
          GOTO      AMETB999
.
AMETB900  CALL      NOMORE00    * Display No More Records Message
.
AMETB999  RETURN
.------------------------------------------------------------
. Analysis Measures Details (TABLE HEADING)
.------------------------------------------------------------
AMEHD000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell width=30%>":
                               "Analysis Measure</td>":
                               "<td class=HeadingCell width=70%>":
                               "Description</td>":
                             "</tr>"
.
AMEHD999  RETURN
.------------------------------------------------------------
. Analysis Measures Maintenance (TABLE ROW)
.------------------------------------------------------------
AMERW000  MATCH     SP70,CAAMDES 
          IF        @EQUAL
            MOVE      "&nbsp;",KEY35
          ELSE
            MOVE      CAAMDES,KEY35
          ENDIF
.
          WRITE     HTMLFILE;"<tr><td nowrap>":
                             "<A HREF='javascript:ShowDetail04":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&csame002=",CAAMAM:
                             "&csame001=",CAAMTOE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif ":
                             "hspace=4 border=0 align=absmiddle></a>":
                             CAAMAM,"</td>":
                             "<td>",KEY35,"</td>":
                             "</tr>";
.
AMERW999 RETURN
.------------------------------------------------------------
. Table of Casemix Age Ranges
.------------------------------------------------------------
AGETB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      AGEHD000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY4,STARTKEY,SP70
          CALL      RDCCAG1
          IF        OVRCD=0
            CALL      RPCCAG1 
          ENDIF
AGETB100  CALL      RKCCAG1 
          BRANCH    OVRCD,AGETB900
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      AGETB100
          ENDIF
.
          CALL      AGERW000    * Display Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      AGETB100 IF NOT EQUAL
          GOTO      AGETB999
.
AGETB900  CALL      NOMORE00    * Display No More Records Message
.
AGETB999  RETURN
.------------------------------------------------------------
. Casemix Age Ranges Details (TABLE HEADING)
.------------------------------------------------------------
AGEHD000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell width=30%>":
                               "Range Definition Number 0-9</td>":
                               "<td class=HeadingCell width=20%>":
                               "Group Code</td>":
                               "<td class=HeadingCell width=50%>":
                               "Description</td>":
                             "</tr>"
.
AGEHD999  RETURN
.------------------------------------------------------------
. Casemix Age Ranges Details (TABLE ROW)
.------------------------------------------------------------
AGERW000  MATCH     SP70,CCAGDES 
          IF        @EQUAL
            MOVE      "&nbsp;",KEY35
          ELSE
            MOVE      CCAGDES,KEY35
          ENDIF
.
          WRITE     HTMLFILE;"<tr><td nowrap>":
                             "<A HREF='javascript:ShowDetail05":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&csage002=",CCAGGRP:
                             "&csage001=",CCAGDEF,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif ":
                             "hspace=4 border=0 align=absmiddle></a>":
                             CCAGDEF,"</td>":
                             "<td>",CCAGGRP,"</td>":
                             "<td>",KEY35,"</td>":
                             "</tr>";
.
AGERW999 RETURN
.-------------------------------------------------------------------------
.
          INC       IBAWEBCD
          INC       NAMSTRCD
          INC       CASTEFIO/INC
          INC       CASSTYIO/INC
          INC       CASXHDIO/INC
          INC       CASAMEIO/INC
          INC       CASAGEIO/INC
.
