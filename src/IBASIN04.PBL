.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.01.00"
.-------------------------------------------------------
. V9.03.01  10.09.2003 Steve Downing (VF.11.01 CAR 9375)
.           Recompiled for SINREBFD & SINREBIO
.-------------------------------------------------------
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.00.03  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           23.12.1999 Sandra Barcham
.           Recompiled for FMSCCAFD
.           srf 646145
. VF.00.02  10.11.1999 Charles Handaya
.           Fix Y2K of Audit Files Date (CCYYMMDD)
. VF.00.01  02.11.1999 Sandra Barcham
.           Change locked message to use X
.-------------------------------------------------------
COUNT     FORM      2
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN04
.   Function      :   Cost Centre Maintenance                 
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       FMSAMADF    
          INC       FMSAMAFD/INC
          INC       FMSCCAFD/INC
          INC       FMSCONFD/INC
          INC       FMSLMAFD/INC
          INC       GETSTRDF    
          INC       SINCCAFD/INC
          INC       SINCCCFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINIMPFD/INC
          INC       SINREAFD/INC
          INC       SINREBFD/INC
.=========================
.Local Variable Definition
.-------------------------
IMPSUN    DIM       1 * Scr 00 Fld    12
IMPMON    DIM       1 * Scr 00 Fld    13
IMPTUE    DIM       1 * Scr 00 Fld    14
IMPWED    DIM       1 * Scr 00 Fld    15
IMPTHU    DIM       1 * Scr 00 Fld    16
IMPFRI    DIM       1 * Scr 00 Fld    17
IMPSAT    DIM       1 * Scr 00 Fld    18
.
.Word Processor File * Scr 00 Fld    19
.
NAMSICC1  INIT      "Wsicc1"
FILSICC1  DIM       8
.
COSTCOMM  DIM       5 * Scr 00 Fld    21
UDC1DESC  DIM      30 * Scr 00 Fld    38
UDC2DESC  DIM      30 * Scr 00 Fld    39
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN04"
PRGNAM    INIT      "Cost Centre Maintenance                 "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      RDCON000
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSICC1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          MOVE      "   24",AUDTSECT
          MOVE      "202",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudca";
            OPEN      SINAUDCA,"sinaudca"
          ENDIF
          MOVE      "   24",AUDTSECT
          MOVE      "204",AUDTPOST
          READ      CONTROLF,AUDTSECT;*AUDTPOST,AUDTFLAG
          IF        AUDTFLAG=1
            DISPLAY   *P56:24,"Opening sinaudim";
            OPEN      SINAUDIM,"sinaudim"
          ENDIF
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA1,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA2,"sinccaaf"
          DISPLAY   *P56:24,"Opening sincccaf";
          OPEN      SINCCCA1,"sincccaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA2,"sincodaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA1,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA2,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinimpaf";
          OPEN      SINIMPA3,"sinimpaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA1,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA2,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA3,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinreaaf";
          OPEN      SINREAA4,"sinreaaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA1,"sinrebaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA2,"sinrebaf"
          DISPLAY   *P56:24,"Opening sinrebaf";
          OPEN      SINREBA3,"sinrebaf"
.--------------------------------------------------------
. Initialise Wp Filename for Cost Centre Comments File          
.--------------------------------------------------------
          PACK      FILSICC1,NAMSICC1,PORT
          REP       " 0",FILSICC1
          DISPLAY   *P56:24,"Create & Open ",FILSICC1;
          PREP      TEMPWORD,FILSICC1
.
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Cost Centre Maintenance            
          ENDIF
          RETURN
.--------------------------------
. Screen - Cost Centre Maintenance            
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Cost Centre Maintenance            
.-------------------------------------------------------
CF00L000
          MOVE      SP70,SICACODE
          MOVE      SP70,SICADESC
          MOVE      SP70,SICATELE
          MOVE      SP70,SICACONT
          MOVE      SP70,SICAGL  
          MOVE      SP70,SICAIMPD
          MOVE      SP70,SICADAD1
          MOVE      SP70,SICADAD2
          MOVE      SP70,SICADAD3
          MOVE      ZERO,SICALOC 
          MOVE      SP70,SICAMES 
          MOVE      SP70,IMPSUN  
          MOVE      SP70,IMPMON  
          MOVE      SP70,IMPTUE  
          MOVE      SP70,IMPWED  
          MOVE      SP70,IMPTHU  
          MOVE      SP70,IMPFRI  
          MOVE      SP70,IMPSAT  
          MOVE      SP70,COSTCOMM
          MOVE      SP70,FMLALEDG
          MOVE      SP70,FMCCCOCE
          MOVE      SP70,FMLADESC
          MOVE      SP70,FMCCDESC
          MOVE      SP70,SICAUR1 
          MOVE      SP70,SICAUR2 
          MOVE      SP70,SICAUD1 
          MOVE      SP70,SICAUD2 
          MOVE      SP70,SICAUC1 
          MOVE      SP70,SICAUC2 
          MOVE      SP70,SICAUY1 
          MOVE      SP70,SICAUY2 
          MOVE      SP70,UDC1DESC
          MOVE      SP70,UDC2DESC
          MOVE      SP70,SICARID 
          MOVE      SP70,SICAPACC
          MOVE      SP70,FMAMDESC
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Cost Centre Maintenance            
.--------------------------------------------------------
KY00L000
.
KY00L110
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,COSTCOMM
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      ECOST000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      OVRCD,ACCEPT
          MOVE      SICACODE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   21",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      COSTCOMM,VAR     
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Cost Centre Maintenance            
.---------------------------------------------------------
WP00L000
          PREP     TEMPWORD,FILSICC1
          PACK     KEY8,SICACODE,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDSICC1 
          IF        OVRCD=0
            CALL      RPSICC1 
          ENDIF
WP00L100
          CALL     RKSICC1 
          BRANCH   OVRCD,WP00L105
          PACK     KEY8,SICCCST,SICCLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP00L105 IF NOT EQUAL
          PACK     VAR,SICCCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SICCCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP00L100
WP00L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Cost Centre Maintenance            
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Cost Centre Maintenance            
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Cost Centre Maintenance            
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L104,PS00L105,PS00L106,PS00L107:
                            PS00L108,PS00L109,PS00L110,PS00L111:
                            PS00L112,PS00L113,PS00L114,PS00L115:
                            PS00L116,PS00L117,PS00L118,PS00L999:
                            PS00L119,PS00L999,PS00L999,PS00L999:
                            PS00L120,PS00L121,PS00L122,PS00L123:
                            PS00L999,PS00L124,PS00L125,PS00L126:
                            PS00L127,PS00L128,PS00L129,PS00L130:
                            PS00L131,PS00L132,PS00L133,PS00L134:
                            PS00L135,PS00L136
          GOTO     PS00L999
.
PS00L101
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      SICATELE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      SICACONT,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      SICAGL,VAR       
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      SICAIMPD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      SICADAD1,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      SICADAD2,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      SICADAD3,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SICALOC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      SICAMES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPSUN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPMON,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPTUE,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPWED,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPTHU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPFRI,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPSAT,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE     FILSICC1,WORDNAME
          CALL     DISPWORD
          GOTO     PS00L999
.
PS00L119
          MOVE      COSTCOMM,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      FMLALEDG,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      FMCCCOCE,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      FMLADESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      FMCCDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      SICAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      SICAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          UNPACK    SICAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          UNPACK    SICAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          MOVE      SICAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L129
          MOVE      SICAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L130
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SICAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SICAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L132
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L133
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L134
          MOVE      SICARID,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L135
          MOVE      SICAPACC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L136
          MOVE      FMAMDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Cost Centre Maintenance            
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L107:
                            SF00L108,SF00L109,SF00L110,SF00L111:
                            SF00L112,SF00L113,SF00L114,SF00L115:
                            SF00L116,SF00L117,SF00L118,SF00L006:
                            SF00L006,SF00L119,SF00L120,SF00L121:
                            SF00L122,SF00L123,SF00L006,SF00L006:
                            SF00L006,SF00L124,SF00L125,SF00L126:
                            SF00L127,SF00L128,SF00L129,SF00L130:
                            SF00L131,SF00L006,SF00L006,SF00L132:
                            SF00L133,SF00L006
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L101,SF00L102,SF00L103:
                            SF00L104,SF00L105,SF00L106,SF00L107:
                            SF00L108,SF00L109,SF00L110,SF00L111:
                            SF00L112,SF00L113,SF00L114,SF00L115:
                            SF00L116,SF00L117,SF00L118,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L122,SF00L123,SF00L020,SF00L020:
                            SF00L020,SF00L124,SF00L125,SF00L126:
                            SF00L127,SF00L128,SF00L129,SF00L130:
                            SF00L131,SF00L020,SF00L020,SF00L132:
                            SF00L133,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          CALL     SELECTED
          STRIP     SICADESC
          SFORMAT   VAR,SCPSLEN
          MOVE      SICADESC,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SICADESC
          SFORMAT   VAR,127
          ENDSET    SICADESC
          APPEND    SP70,SICADESC
          RESET     SICADESC
          CMATCH    EXITCHAR,SICADESC
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SICADESC
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L101
            ENDIF
          ENDIF
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L102
          CALL     SELECTED
          STRIP     SICATELE
          SFORMAT   VAR,SCPSLEN
          MOVE      SICATELE,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SICATELE
          SFORMAT   VAR,127
          ENDSET    SICATELE
          APPEND    SP70,SICATELE
          RESET     SICATELE
          CMATCH    EXITCHAR,SICATELE
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SICATELE
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L102
            ENDIF
          ENDIF
          MOVE      SICATELE,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L103
          CALL     SELECTED
          STRIP     SICACONT
          SFORMAT   VAR,SCPSLEN
          MOVE      SICACONT,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SICACONT
          SFORMAT   VAR,127
          ENDSET    SICACONT
          APPEND    SP70,SICACONT
          RESET     SICACONT
          CMATCH    EXITCHAR,SICACONT
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SICACONT
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L103
            ENDIF
          ENDIF
          MOVE      SICACONT,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L104
          CALL     SELECTED
          STRIP     SICAGL  
          SFORMAT   VAR,SCPSLEN
          MOVE      SICAGL,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SICAGL  
          SFORMAT   VAR,127
          ENDSET    SICAGL  
          APPEND    SP70,SICAGL  
          RESET     SICAGL  
          CMATCH    EXITCHAR,SICAGL  
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SICAGL  
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L104
            ENDIF
          ENDIF
          MOVE      SICAGL,VAR       
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L105
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KIMP0000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L105
            ENDIF
            BRANCH    EXIT,SF00L105,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      SICAIMPD,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L106
          CALL     SELECTED
          STRIP     SICADAD1
          SFORMAT   VAR,SCPSLEN
          MOVE      SICADAD1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SICADAD1
          SFORMAT   VAR,127
          ENDSET    SICADAD1
          APPEND    SP70,SICADAD1
          RESET     SICADAD1
          CMATCH    EXITCHAR,SICADAD1
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SICADAD1
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L106
            ENDIF
          ENDIF
          MOVE      SICADAD1,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L107
          CALL     SELECTED
          STRIP     SICADAD2
          SFORMAT   VAR,SCPSLEN
          MOVE      SICADAD2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SICADAD2
          SFORMAT   VAR,127
          ENDSET    SICADAD2
          APPEND    SP70,SICADAD2
          RESET     SICADAD2
          CMATCH    EXITCHAR,SICADAD2
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SICADAD2
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L107
            ENDIF
          ENDIF
          MOVE      SICADAD2,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L108
          CALL     SELECTED
          STRIP     SICADAD3
          SFORMAT   VAR,SCPSLEN
          MOVE      SICADAD3,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SICADAD3
          SFORMAT   VAR,127
          ENDSET    SICADAD3
          APPEND    SP70,SICADAD3
          RESET     SICADAD3
          CMATCH    EXITCHAR,SICADAD3
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SICADAD3
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L108
            ENDIF
          ENDIF
          MOVE      SICADAD3,VAR     
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L109
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SICALOC 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SICALOC,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L110
          CALL     SELECTED
          STRIP     SICAMES 
          SFORMAT   VAR,SCPSLEN
          MOVE      SICAMES,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SICAMES 
          SFORMAT   VAR,127
          ENDSET    SICAMES 
          APPEND    SP70,SICAMES 
          RESET     SICAMES 
          CMATCH    EXITCHAR,SICAMES 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SICAMES 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L110
            ENDIF
          ENDIF
          MOVE      SICAMES,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L111
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,IMPSUN  
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPSUN,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L112
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,IMPMON  
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPMON,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L113
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,IMPTUE  
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPTUE,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L114
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,IMPWED  
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPWED,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L115
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,IMPTHU  
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPTHU,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L116
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,IMPFRI  
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPFRI,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L117
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,IMPSAT  
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      IMPSAT,FORM2     
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L118
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "18",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSICC1,WORDNAME
              MOVE     "  8",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSICC1,WORDNAME
            MOVE     "  8",WORDTYPE
            CALL     EDITWORD
          ENDIF
          GOTO     SF00L001
.
SF00L119
          CALL      CANC0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L120
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SAVE0000
          MOVE      EXIT,SECTOR
          IF        SECTOR=0
            CALL      FRESCR00
            GOTO      SF00L999
          ENDIF
          IF        SECTOR=1
            CALL      FRESCR00
            MOVE      ZERO,EXIT
            GOTO      SF00L001
          ENDIF
          IF        SECTOR=2
            CALL      FRESCR00
            MOVE      ONE,EXIT
            GOTO      SF00L999
          ENDIF
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          IF        SECTOR=4
            CALL      DF00L000
          ENDIF
          GOTO      SF00L001
.
SF00L121
          CALL      DELT0000
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L122
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMLADESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KFMLA000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L122
            ENDIF
            BRANCH    EXIT,SF00L122,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FMLALEDG,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   27",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMLADESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L123
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMCCDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KFMCC000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L123
            ENDIF
            BRANCH    EXIT,SF00L123,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      FMCCCOCE,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   28",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMCCDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L124
          CALL     SELECTED
          STRIP     SICAUR1 
          SFORMAT   VAR,SCPSLEN
          MOVE      SICAUR1,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SICAUR1 
          SFORMAT   VAR,127
          ENDSET    SICAUR1 
          APPEND    SP70,SICAUR1 
          RESET     SICAUR1 
          CMATCH    EXITCHAR,SICAUR1 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SICAUR1 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L124
            ENDIF
          ENDIF
          MOVE      SICAUR1,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L125
          CALL     SELECTED
          STRIP     SICAUR2 
          SFORMAT   VAR,SCPSLEN
          MOVE      SICAUR2,VAR
          KEYIN     *PCCOL:CVERT,*V2LON,*MASK,*RV,VAR
          MOVE      VAR,SICAUR2 
          SFORMAT   VAR,127
          ENDSET    SICAUR2 
          APPEND    SP70,SICAUR2 
          RESET     SICAUR2 
          CMATCH    EXITCHAR,SICAUR2 
          GOTO      SF00L990 IF EQUAL
          IF        SCPSMAN=1
            MATCH     SP70,SICAUR2 
            IF        @EQUAL
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L125
            ENDIF
          ENDIF
          MOVE      SICAUR2,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L126
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SICAUD1,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SICAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L127
          CALL     SELECTED
          CALL      KEYDATE
          PACK      SICAUD2,CCENT,CYEAR,CMON,CDAY           
          UNPACK    SICAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L128
.
.
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UDC1DESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOD1000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L128
            ENDIF
            BRANCH    EXIT,SF00L128,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      SICAUC1,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   38",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UDC1DESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L129
.
.
          MOVE      "   39",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,UDC2DESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      ECOD2000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L129
            ENDIF
            BRANCH    EXIT,SF00L129,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      SICAUC2,VAR      
          CALL      DISPITEM
.
.
          MOVE      "   39",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      UDC2DESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
.
SF00L130
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SICAUY1 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SICAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L131
          CALL     SELECTED
          CALL      YORN0000
          MOVE       FYESNO,SICAUY2 
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SICAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L132
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KPRID000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L132
            ENDIF
            BRANCH    EXIT,SF00L132,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      SICARID,VAR      
          CALL      DISPITEM
          GOTO     SF00L001
.
SF00L133
.
.
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,FMAMDESC
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          CALL     SELECTED
          MOVE      "0",CKEYTYP
          CALL      KFMAM000
          IF        SCPSMAN=1
            IF        EXIT=1
              MOVE      "Mandatory Field - ",DISPMSG
              BEEP
              CALL      MESSAGE1
              GOTO      SF00L133
            ENDIF
            BRANCH    EXIT,SF00L133,SF00L990
          ELSE
            COMPARE   TWO,EXIT
            GOTO      SF00L990 IF EQUAL
          ENDIF
          MOVE      SICAPACC,VAR     
          CALL      DISPITEM
.
.
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      FMAMDESC,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.@@@@@ Function Restart Point @@@@@
.----------------------------------------------------------------------
. Read controlf file data and open gl files
.----------------------------------------------------------------------
RDCON000
          MOVE      "23",SECTOR
          READ      CONTROLF,SECTOR;*95,HACCNT
          MOVE      "24",SECTOR
          READ      CONTROLF,SECTOR;*135,HACCDATA
          COMPARE   ONE,HACCNT
          GOTO      RDCON999 IF NOT EQUAL
.
.---- accounting system active ----
.
          CLOSE     CONTROLF           * get gl control file if possible
          MOVE      "controlf.txt",KEY12
          PACK      KEY80,HACCDATA,KEY12
          SQUEEZE   KEY80
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      CONTROLF,KEY80
          TRAPCLR   IO
          IF        OVRCD=1
            OPEN      CONTROLF,"controlf"
          ENDIF
.
          CALL      RDFMCO50           * Read Account Code Parameters
          CALL      RDFMCO51
          CALL      RDFMCO52
          CALL      RDFMCO65
          CLOSE     CONTROLF
          OPEN      CONTROLF,"controlf"
.
          MOVE      "fmsamaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSAMAA1,KEY80
          OPEN      FMSAMAA2,KEY80
          OPEN      FMSAMAA3,KEY80
          OPEN      FMSAMAA4,KEY80
.
          MOVE      "fmsccaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSCCAA1,KEY80
          OPEN      FMSCCAA2,KEY80
.
          MOVE      "fmslmaaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSLMAA1,KEY80
.
RDCON999  RETURN
ECOST000
          MOVE      TWO,CKEYTYP
          CALL      KSICAA00
          BRANCH    EXIT,ECOST999,ECOST999
          MOVE      SP70,COSTCOMM
          COMPARE   ONE,OVRCD
          GOTO      ECOST999 IF EQUAL
.
ECOST100  MOVE      SICACODE,KEY5
          CALL      RLSICA1
          BRANCH    OVRCD,ECOST999,ECOST200
          MOVE      TWO,AUDTTYPE
          CALL      WASICA00          * Write Before Audit
          MOVE      ZERO,EXIT
.
          CLEAR     KEY6
          APPEND    "ca1",KEY6
          APPEND    SICAUC1,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC1DESC
          ELSE
            MOVE      SP70,UDC1DESC
          ENDIF
.
          CLEAR     KEY6
          APPEND    "ca2",KEY6
          APPEND    SICAUC2,KEY6
          RESET     KEY6
          CALL      RDSICD1
          IF        OVRCD=0
            MOVE      SICDDESC,UDC2DESC
          ELSE
            MOVE      SP70,UDC2DESC
          ENDIF
          UNPACK   SICAIMPD,IMPSUN,IMPMON,IMPTUE,IMPWED,IMPTHU,IMPFRI,IMPSAT
          UNPACK   SICAGL,FMLALEDG,FMCCCOCE
.
.---- only read gl data if interface is on ----
.
          IF       HACCNT=1
            MOVE     SICAGL,KEY2
            CALL     RDFMLA1
.
            MOVE     SICAGL,KEY14
            CALL     RDFMCC1
.
            MOVE     SICAGL,KEY2
            PACK     KEY14,KEY2,SICAPACC,SP70
            CALL     RDFMAM1
          ENDIF
.
          PACK     KEY8,SICACODE,SP70
          CALL     RSSICC1
.
ECOST150  CALL     RKSICC1
          BRANCH   OVRCD,ECOST160
          MATCH    SICACODE,SICCCST
          GOTO     ECOST160 IF NOT EQUAL
          MATCH    SP70,SICCCOM
          GOTO     ECOST150 IF EQUAL
          MOVE     "Notes",COSTCOMM
.
ECOST160  MOVE      ZERO,OVRCD
          GOTO      ECOST999
.
ECOST200  MOVE      SP70,DISPMSG
          CALL      MESSAGE2
          KEYIN     *P1:24,*EL,"Record Locked - (":
                    *V2LON,"R",*HOFF,")etry or e(":
                    *V2LON,"X",*HOFF,")it ? ",ANS
          CALL      MESSAGE3
          REP       UPPLOW,ANS
          MATCH     ANSR,ANS
          GOTO      ECOST100 IF EQUAL
          MATCH     ANSX,ANS
          GOTO      ECOST000 IF EQUAL
          MATCH     ANSE,ANS
          GOTO      ECOST200 IF NOT EQUAL
          GOTO      ECOST000
.
ECOST999   RETURN
KIMP0000  IF        ACCEPT=1
            MOVE      "0000000",SICAIMPD
          ENDIF
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,SICAIMPD
          REP       " 0",SICAIMPD
          UNPACK    SICAIMPD,IMPSUN,IMPMON,IMPTUE,IMPWED,IMPTHU,IMPFRI,IMPSAT
.
          MOVE      ZERO,COUNT
KIMP1000  ADD       ONE,COUNT
          COMPARE   EIGHT,COUNT
          GOTO      KIMP9999 IF EQUAL
.
          RESET     SICAIMPD,COUNT
          CMATCH    "1",SICAIMPD
          GOTO      KIMP1000 IF EQUAL
          CMATCH    "0",SICAIMPD
          GOTO      KIMP1000 IF EQUAL
.
          MOVE      "Imprest indicator must be 0 or 1 - ",DISPMSG
          BEEP
          CALL      MESSAGE1
          GOTO      KIMP0000
.
KIMP9999  RESET     SICAIMPD
          RETURN
CANC0000  MOVE    SICACODE,KEY5
          CALL    RASICA1
          BRANCH  OVRCD,CANC9999
          CALL    UUSICA1
          CALL    DASICA00    * Delete Before Audit
CANC9999  RETURN

SAVE0000  PACK     SICAIMPD,IMPSUN,IMPMON,IMPTUE,IMPWED,IMPTHU,IMPFRI,IMPSAT
          PACK     SICAGL,FMLALEDG,FMCCCOCE,SP70
          PACK     SICAPACC,SICAPACC,SP70
.
. ------- Check Account Codes are Valid
          COMPARE   ONE,HACCNT
          GOTO      SAVE0500 IF NOT EQUAL
.
          MOVE      ZERO,EXIT
          MATCH     SICAPACC,SP70
          IF        @EQUAL
            MATCH     FMCCCOCE,SP70
            CALL      SETEX000 IF EQUAL
          ELSE
            MATCH     FMCCCOCE,SP70
            CALL      SETEX000 IF NOT EQUAL
          ENDIF
.
          IF        EXIT=1
            MOVE      "Use either FMS Cost Centre or FMS Posting. ",DISPMSG
            CALL      MESSAGE1
            GOTO      SAVE9999
          ELSE
            MOVE      TWO,EXIT
          ENDIF
.
SAVE0500  MOVE     SICACODE,KEY5
          CALL     RASICA1
          IF       OVRCD=0
            CALL     UPSICA1
            CALL     UUSICA1
            MOVE     THREE,AUDTTYPE
            CALL     WASICA00
          ELSE
            CALL     WRSICA1
            MOVE     ONE,AUDTTYPE
            CALL     WASICA00
          ENDIF
.
          PACK      KEY8,SICACODE,SP70
          CALL      RSSICC1
SAVE1000  CALL      RKSICC1
          BRANCH    OVRCD,SAVE1100
          MATCH     SICACODE,SICCCST
          GOTO      SAVE1100 IF NOT EQUAL
          PACK      KEY8,SICCCST,SICCLIN
          CALL      DESICC1
          GOTO      SAVE1000
.
SAVE1100  MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSICC1
          TRAPCLR   IO
          BRANCH    OVRCD,SAVE2100
          MOVE      ZERO,F3
SAVE2000  READ      TEMPWORD,SEQ;SICCCOM
          GOTO      SAVE2100 IF OVER
          MOVE      F3,SICCLIN
          PACK      KEY21,SICACODE,SICCLIN
          UNPACK    KEY21,SICCCST,SICCLIN
          CALL      WRSICC1
          ADD       ONE,F3
          GOTO      SAVE2000
SAVE2100
SAVE9999  RETURN

SETEX000  MOVE      ONE,EXIT
          RETURN
.------------------------------------------------------------
. Delete Cost Centre Details
.------------------------------------------------------------
DELT0000  MOVE     SP70,DISPMSG
          CALL     MESSAGE2
.
          CALL     CHKREQ00
          BRANCH   EXIT,DELT9000
.
          CALL     CHKIMP00
.
          CALL     DELQST
          CALL     MESSAGE3
          SUB      ONE,CEXIT
          BRANCH   CEXIT,DELT9999,DELT9000
.
          CALL     DELIMP00
          BRANCH   CEXIT,DELT9000
.
          MOVE     SICACODE,KEY5
          CALL     RASICA1
          IF       OVRCD=0
            CALL     DASICA00   * Delete Before Audit
            MOVE     FOUR,AUDTTYPE
            CALL     WASICA00   * Write Audit Record
            CALL     DESICA1
          ENDIF
.
          PACK      KEY8,SICACODE,SP70
          CALL      RSSICC1
DELT1000  CALL      RKSICC1
          BRANCH    OVRCD,DELT9999
          MATCH     SICACODE,SICCCST
          GOTO      DELT9999 IF NOT EQUAL
          PACK      KEY8,SICCCST,SICCLIN
          CALL      DESICC1
          GOTO      DELT1000
.
DELT9000  CALL      CANC0000
          GOTO      DELT9999
.
DELT9999  RETURN
.------------------------------------------------------------
. Check Requisition Details
.------------------------------------------------------------
CHKREQ00  MOVE      ZERO,EXIT
          PACK      KEY21,SICACODE,SP70
          CALL      RSSIRA4
.
CHKREQ10  CALL      RKSIRA4
          BRANCH    OVRCD,CHKREQ99
          MATCH     SICACODE,SIRACST
          GOTO      CHKREQ99 IF NOT EQUAL
.
          PACK      KEY20,SIRATYP,SIRAREQ
          CALL      RSSIRB1
.
CHKREQ20  CALL      RKSIRB1
          BRANCH    OVRCD,CHKREQ10
.
          MATCH     SIRATYP,SIRBTYP
          GOTO      CHKREQ10 IF NOT EQUAL
          MATCH     SIRAREQ,SIRBREQ
          GOTO      CHKREQ10 IF NOT EQUAL
.
          MATCH     SP2,SIRBLED
          GOTO      CHKREQ20 IF NOT EQUAL
.
          BEEP
          CLEAR     DISPMSG
          APPEND    "Requisition ",DISPMSG
          APPEND    SIRATYP,DISPMSG
          APPEND    SLASH,DISPMSG
          APPEND    SIRAREQ,DISPMSG
          APPEND    " has not been transferred to G/L - ",DISPMSG
          RESET     DISPMSG
          CALL      MESSAGE1
.
CHKREQ95  MOVE      ONE,EXIT
.
CHKREQ99  RETURN
.------------------------------------------------------------
. Check Imprest Details
.------------------------------------------------------------
CHKIMP00  PACK      KEY12,SICACODE,SP70
          CALL      RSSIIM1
          CALL      RKSIIM1
          BRANCH    OVRCD,CHKIMP99
          MATCH     SICACODE,SIIMCST
          GOTO      CHKIMP99 IF NOT EQUAL
.
          BEEP
          MOVE      "WARNING: Cost Centre has Imprest Items - ",DISPMSG
          MOVE      "WARNING: ALL Imprest Items will be Deleted - ",DISPMSG
          CALL      MESSAGE1
.
CHKIMP99  RETURN
.------------------------------------------------------------
. Delete Imprest Detials
.------------------------------------------------------------
DELIMP00  PACK      KEY12,SICACODE,SP70
          CALL      RSSIIM1
DELIMP10  CALL      RKSIIM1
          BRANCH    OVRCD,DELIMP99
          MATCH     SICACODE,SIIMCST
          GOTO      DELIMP99 IF NOT EQUAL
          PACK      KEY12,SIIMCST,SIIMCAT
          CALL      DESIIM1
          GOTO      DELIMP10
.
DELIMP99  RETURN
.
.----------------------------------------------------------------------
. Keyin FMLA
.----------------------------------------------------------------------
KFMLA000
          IF        HACCNT<>1
            IF        ACCEPT=1
              GOTO      KFMLA999
            ENDIF
            BEEP
            CLEAR     DISPMSG
            APPEND    "GL Interface Not Active - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            GOTO      KFMLA999
          ENDIF
.
          CALL      KFMLAA00                     * keyin FMLA
          BRANCH    EXIT,KFMLA910,KFMLA950
.
          MOVE      FMLALEDG,FMCCLEDG
          MOVE      FMLALEDG,FMAMLEDG
.
KFMLA900  MOVE      ZERO,EXIT
          GOTO      KFMLA999
.
KFMLA910  MOVE      ONE,EXIT
          GOTO      KFMLA999
.
KFMLA950  MOVE      TWO,EXIT
.
KFMLA999  RETURN
.----------------------------------------------------------------------
. Keyin FMCC
.----------------------------------------------------------------------
KFMCC000
          IF        HACCNT<>1
            IF        ACCEPT=1
              GOTO      KFMCC999
            ENDIF
            BEEP
            CLEAR     DISPMSG
            APPEND    "GL Interface Not Active - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            GOTO      KFMCC999
          ENDIF
.
          MOVE      FMLALEDG,FMCCLEDG
          CALL      KFMCCA00                     * keyin FMCC
          BRANCH    EXIT,KFMCC100,KFMCC999
.
          MOVE      SP70,FMCCDESC
          PACK      KEY14,FMLALEDG,FMCCCOCE,SP70
          CALL      RDFMCC1
          MOVE      ZERO,EXIT
          GOTO      KFMCC999
.
KFMCC100  MOVE      SP70,FMCCDESC
          MOVE      SP70,FMCCCOCE
          MOVE      ZERO,EXIT
          GOTO      KFMCC999
.
KFMCC999  RETURN
.----------------------------------------------
. Enter Code
.----------------------------------------------
ECOD1000  MOVE        ZERO,CKEYTYP
          MOVE        "ca1",SICDCATA
          MOVE        SP70,UDC1DESC
          CALL        KSICDB00
          BRANCH      EXIT,ECOD1999,ECOD1999
          MOVE        SICDCODE,SICAUC1
          MOVE        SICDDESC,UDC1DESC
.
ECOD1999  RETURN
.
.----------------------------------------------
. Enter Code
.----------------------------------------------
ECOD2000  MOVE        ZERO,CKEYTYP
          MOVE        "ca2",SICDCATA
          MOVE        SP70,UDC2DESC
          CALL        KSICDB00
          BRANCH      EXIT,ECOD2999,ECOD1999
          MOVE        SICDCODE,SICAUC2
          MOVE        SICDDESC,UDC2DESC
.
ECOD2999  RETURN
.
.----------------------------------------------------------------------
. Keyin PRID
.----------------------------------------------------------------------
KPRID000
          KEYIN     *PCCOL:CVERT,*V2LON,*DE,*JR,*ZF,SICARID
          PACK      SICARID,SICARID,SP70
          REP       " 0",SICARID
.
KPRID999  RETURN
.----------------------------------------------------------------------
. Keyin FMAM
.----------------------------------------------------------------------
KFMAM000
          IF        HACCNT<>1
            IF        ACCEPT=1
              GOTO      KFMAM999
            ENDIF
            BEEP
            CLEAR     DISPMSG
            APPEND    "GL Interface Not Active - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            GOTO      KFMAM999
          ENDIF
.
          COMPARE   "1",ACCEPT
          GOTO      KFMAM050 IF NOT EQUAL
.
          MATCH     SP70,FMCCCOCE
          GOTO      KFMAM999 IF NOT EQUAL
.
KFMAM050  MOVE      "1",CACCTIND                 * 1=posting accounts only
          MOVE      SP70,SICAPACC
          MOVE      FMLALEDG,FMAMLEDG
          CALL      KFMAMA00                     * keyin FMAM
          BRANCH    EXIT,KFMAM100,KFMAM999
.
          MOVE      FMAMACCT,SICAPACC
          MOVE      SP70,FMAMDESC
          PACK      KEY14,FMLALEDG,FMAMACCT
          CALL      RDFMAM1
          MOVE      ZERO,EXIT
          GOTO      KFMAM999
.
KFMAM100  MOVE      SP70,FMAMDESC
          MOVE      SP70,SICAPACC
          MOVE      ZERO,EXIT
          GOTO      KFMAM999
.
KFMAM999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       FMSAMAIO/INC
          INC       FMSAMAKY    
          INC       FMSCCAIO/INC
          INC       FMSCCAKY    
          INC       FMSCONIO/INC
          INC       FMSLMAIO/INC
          INC       FMSLMAKY    
          INC       GETSTRCD    
          INC       SINCCAIO/INC
          INC       SINCCAKY    
          INC       SINCCCIO/INC
          INC       SINCODIO/INC
          INC       SINCODKY    
          INC       SINIMPIO/INC
          INC       SINREAIO/INC
          INC       SINREBIO/INC
.
          INC       STDGENCD
.
