.-----------------------------------------------------------------------------
. Program        :  IBAPMS56                                                
. Description    :  Upload MH HoNOS Data                                       
.-----------------------------------------------------------------------------
. Modifications  :
.-----------------------------------------------------------------------------
. V12.00.01  10/11/2025  Bella Turco   TSK 0968532
.            Fixed incorrect spelling of 'HoNOS'
. V11.04.03  09/04/2024  Thanh T          TSK 0928468
.            Added validation for XHONDAYS (ADOM Number of Days covered)
. V11.04.02  27/03/2024  Thanh T          TSK 0928468
.            Added validation for XHONDAYS (ADOM Number of Days covered) 
. V11.04.01  22/02/2024  Thanh T          TSK 0923560
.            Recompiled as UPLVALDS changes. Moved CURRCENT variable to
.            UPLVALDW common variables
. V11.03.00 18/10/2023 Thanh T            TSK 0928468
.           Initial version 
.-----------------------------------------------------------------------------
.
          INC       STD001FD
.
          INC       IBACONFD/INC
          INC       PATCONFD/INC
          INC       PATCODFD/INC            
          INC       PATMA1FD/INC            
          INC       PATVISFD/INC            
          INC       PMSHCPFD/INC            
          INC       ALLCASFD/INC            
          INC       MEHHONFD/INC            . MH Honos
          INC       WEBSECFD/INC
.
          INC       UPLVALDW/INC
.
.         Temporary file for uploading MH HONOS data
.
.         MH HONOS upload file
.
HONOSTXT  FILE       HL7, FIXED=1000        . Upload file
.
.Name     Type      Length Physical Start Description
.----     ----      ------ -------- ----- -----------
XHONVISN  DIM       8      8        1     Visit Number                       
.XHONUNIQ  DIM       8      8        9     Unique Count                       
XHONHOTY  DIM       3      3        17    HoNOS Type (Cat hs)                
XHONACTV  DIM       1      1        20    Active 1=Yes                       
XHONSENT  DIM       1      1        21    Sent (1=Yes)                       
XHONHDAT  DIM       8      8        22    HoNOS Date (CCYYMMDD)              
XHONSSET  DIM       3      3        30    Service Setting (Cat ss)           
XHONREAS  DIM       3      3        33    Reason for Collection (Cat hp)     
XHONRHCP  DIM       10     10       36    Responsible HCP (pmshcpaf)         
XHONCAST  DIM       10     10       46    Case Team (allcasaf)               
XHONPHCP  DIM       10     10       56    Performing HCP (pmshcpaf)          
XHONWEBC  DIM       10     10       66    WEB User Created (websecaf)        
XHONCDTE  DIM       8      8        76    Date Created (CCYYMMDD)            
XHONCTIM  DIM       8      8        84    Time Created (HH:MM:SS)            
XHONCOMP  DIM       1      1        92    Completed (1=Yes)                  
XHONWEBF  DIM       10     10       93    Web User Completed (websecaf)      
XHONDATF  DIM       8      8        103   Date Completed (CCYYMMDD)          
XHONTIMF  DIM       8      8        111   Time Completed (HH:MM:SS)          
XHONWEBU  DIM       10     10       119   Web User ID Updated (websecaf)     
XHONDATU  DIM       8      8        129   Date Updated (CCYYMMDD)            
XHONTIMU  DIM       8      8        137   Time Updated (HH:MM:SS)            
XHONFOCU  DIM       3      3        145   Focus of Care (Cat hf)             
XHONCULS  DIM       3      3        148   Cultural Support (Cat hc)          
XHONNGOS  DIM       1      1        151   NGO Support (1=Yes)                
XHONNGOA  DIM       1      1        152   NGO Support Accommodation (1=Yes)  
XHONNGOW  DIM       1      1        153   NGO Comm Support Worker (1=Yes)    
XHONVOCA  DIM       1      1        154   Vocational Assistance (1=Yes)      
XHONNSNG  DIM       1      1        155   Non Specific NGO Service (1=Yes)   
XHONCOLS  DIM       3      3        156   Collection Status (Cat ht)         
XHONMODA  DIM       3      3        159   Mode of Administration (Cat hm)    
XHONADQ1  DIM       1      1        162   Adult Q1                           
XHONADQ2  DIM       1      1        163   Adult Q2                           
XHONADQ3  DIM       1      1        164   Adult Q3                           
XHONADQ4  DIM       1      1        165   Adult Q4                           
XHONADQ5  DIM       1      1        166   Adult Q5                           
XHONADQ6  DIM       1      1        167   Adult Q6                           
XHONADQ7  DIM       1      1        168   Adult Q7                           
XHONADQ8  DIM       1      1        169   Adult Q8                           
XHONAQ8A  DIM       1      1        170   Adult Q8A                          
XHONFREE  DIM       35     35       171   8A Free Text                       
XHONADQ9  DIM       1      1        206   Adult Q9                           
XHONAQ10  DIM       1      1        207   Adult Q10                          
XHONAQ11  DIM       1      1        208   Adult Q11                          
XHONAQ12  DIM       1      1        209   Adult Q12                          
XHONCYQ1  DIM       1      1        210   Child and Youth Q1                 
XHONCYQ2  DIM       1      1        211   Child and Youth Q2                 
XHONCYQ3  DIM       1      1        212   Child and Youth Q3                 
XHONCYQ4  DIM       1      1        213   Child and Youth Q4                 
XHONCYQ5  DIM       1      1        214   Child and Youth Q5                 
XHONCYQ6  DIM       1      1        215   Child and Youth Q6                 
XHONCYQ7  DIM       1      1        216   Child and Youth Q7                 
XHONCYQ8  DIM       1      1        217   Child and Youth Q8                 
XHONCYQ9  DIM       1      1        218   Child and Youth Q9                 
XHONCQ10  DIM       1      1        219   Child and Youth Q10                
XHONCQ11  DIM       1      1        220   Child and Youth Q11                
XHONCQ12  DIM       1      1        221   Child and Youth Q12                
XHONCQ13  DIM       1      1        222   Child and Youth Q13                
XHONCQ14  DIM       1      1        223   Child and Youth Q14                
XHONCQ15  DIM       1      1        224   Child and Youth Q15                
XHONLDQ1  DIM       1      1        225   Learning Disabilities Q1           
XHONLDQ2  DIM       1      1        226   Learning Disabilities Q2           
XHONLDQ3  DIM       1      1        227   Learning Disabilities Q3           
XHONLDQ4  DIM       1      1        228   Learning Disabilities Q4           
XHONLDQ5  DIM       1      1        229   Learning Disabilities Q5           
XHONLDQ6  DIM       1      1        230   Learning Disabilities Q6           
XHONLDQ7  DIM       1      1        231   Learning Disabilities Q7           
XHONLDQ8  DIM       1      1        232   Learning Disabilities Q8           
XHONLDQ9  DIM       1      1        233   Learning Disabilities Q9           
XHONLQ10  DIM       1      1        234   Learning Disabilities Q10          
XHONLQ11  DIM       1      1        235   Learning Disabilities Q11          
XHONLQ12  DIM       1      1        236   Learning Disabilities Q12          
XHONLQ13  DIM       1      1        237   Learning Disabilities Q13          
XHONLQ14  DIM       1      1        238   Learning Disabilities Q14          
XHONLQ15  DIM       1      1        239   Learning Disabilities Q15          
XHONLQ16  DIM       1      1        240   Learning Disabilities Q16          
XHONLQ17  DIM       1      1        241   Learning Disabilities Q17          
XHONLQ18  DIM       1      1        242   Learning Disabilities Q18          
XHONSCQ1  DIM       1      1        243   Secure Q1                          
XHONSCQ2  DIM       1      1        244   Secure Q2                          
XHONSCQ3  DIM       1      1        245   Secure Q3                          
XHONSCQ4  DIM       1      1        246   Secure Q4                          
XHONSCQ5  DIM       1      1        247   Secure Q5                          
XHONSCQ6  DIM       1      1        248   Secure Q6                          
XHONSCQ7  DIM       1      1        249   Secure Q7                          
XHONHVER  DIM       3      3        250   HoNOS Version (cat hv)             
XHONLD3A  DIM       3      3        253   LD Question 3A (Cat hl)            
XHONRDAT  DIM       8      8        256   Review Date (CCYYMMDD)             
XHONRFMV  DIM       2      2        264   ADOM Mandated / Voluntary
XHONDAYS  DIM       2      2        266   ADOM Number of Days covered (7-28)
XHONCEPS  DIM       2      2        268   ADOM Co-existing Problems (Yes/No)
XHONAM01  DIM       2      2        270   ADOM Q1
XHONAM02  DIM       2      2        272   ADOM Q2
XHONAM03  DIM       2      2        274   ADOM Q3
XHONAM04  DIM       2      2        276   ADOM Q4
XHONAM05  DIM       2      2        278   ADOM Q5
XHONAM06  DIM       2      2        280   ADOM Q6
XHONAM7A  DIM       2      2        282   ADOM Q7a
XHONAM7B  DIM       2      2        284   ADOM Q7b
XHONAM7C  DIM       2      2        286   ADOM Q7c
XHONAM7D  DIM       2      2        288   ADOM Q7d
XHONAM7E  DIM       2      2        290   ADOM Q7e
XHONAM7F  DIM       2      2        292   ADOM Q7f
XHONAM08  DIM       2      2        294   ADOM Q8
XHONAM9A  DIM       1      1        296   ADOM Q9a
XHONAM9B  DIM       1      1        297   ADOM Q9b
XHONAM9C  DIM       1      1        298   ADOM Q9c
XHONAM10  DIM       2      2        299   ADOM Q10
XHONAM11  DIM       1      1        301   ADOM Q11
XHONAM12  DIM       2      2        302   ADOM Q12
XHONAM13  DIM       2      2        304   ADOM Q13
XHONAM14  DIM       2      2        306   ADOM Q14
XHONAM15  DIM       2      2        308   ADOM Q15
XHONAM16  DIM       2      2        310   ADOM Q16
XHONAM17  DIM       2      2        312   ADOM Q17
XHONAM18  DIM       2      2        314   ADOM Q18
XHONAM19  DIM       2      2        316   ADOM Q19
XHONAM20  DIM       2      2        318   ADOM Q20
XHONURNO  DIM       8      8        320   U/R Number
XHONDELF  DIM       1      1        328   Delete Flag
XHONDUID  DIM       10     10       329   User who deleted assessment
XHONDDTE  DIM       8      8        339   Date assessment deleted
XHONDTME  DIM       8      8        347   Time assessment deleted
XHONDRES  DIM       3      3        355   Reason for delete
.
.End of Record                      398
.
. ----- Program Variables -----
.
CMDLINE   DIM       200
WORKLINE  DIM       200
.
CURRDATE  DIM       8
.
DIM3      DIM       3
DIM4      DIM       4
DIM15     DIM       15
DIM30     DIM       30
DIM80     DIM       80
DIM100    DIM       100
ADDCOUNT  FORM      8
UPDCOUNT  FORM      8
ERRCOUNT  FORM      8
LINECNTR  FORM      8
UNICOUNT  FORM      8
ERORFLAG  FORM      1
FNAMEI    DIM       500
.
OUTFNAME  DIM       8
PATHNAME  DIM       150
USERID    DIM       10
.
XFLD0001  DIM       30
XFLD0002  DIM       30
XFLD0003  DIM       30
XFLD0004  DIM       30
XFLD0005  DIM       30
XFLD0006  DIM       30
XFLD0007  DIM       30
XFLD0008  DIM       30
XFLD0009  DIM       30
XFLD0010  DIM       30
XFLD0011  DIM       30
XFLD0012  DIM       30
XFLD0013  DIM       30
XFLD0014  DIM       30
XFLD0015  DIM       30
XFLD0016  DIM       30
XFLD0017  DIM       30
XFLD0018  DIM       30
XFLD0019  DIM       30
XFLD0020  DIM       30
XFLD0021  DIM       30
XFLD0022  DIM       30
XFLD0023  DIM       30
XFLD0024  DIM       30
XFLD0025  DIM       30
XFLD0026  DIM       30
XFLD0027  DIM       30
XFLD0028  DIM       30
XFLD0029  DIM       30
XFLD0030  DIM       30
XFLD0031  DIM       30
XFLD0032  DIM       30
XFLD0033  DIM       30
XFLD0034  DIM       30
XFLD0035  DIM       30
XFLD0036  DIM       30
XFLD0037  DIM       30
XFLD0038  DIM       30
XFLD0039  DIM       30
XFLD0040  DIM       30
XFLD0041  DIM       30
XFLD0042  DIM       30
XFLD0043  DIM       30
XFLD0044  DIM       30
XFLD0045  DIM       30
XFLD0046  DIM       30
XFLD0047  DIM       30
XFLD0048  DIM       30
XFLD0049  DIM       30
XFLD0050  DIM       30
XFLD0051  DIM       30
XFLD0052  DIM       30
XFLD0053  DIM       30
XFLD0054  DIM       30
XFLD0055  DIM       30
XFLD0056  DIM       30
XFLD0057  DIM       30
XFLD0058  DIM       30
XFLD0059  DIM       30
XFLD0060  DIM       30
XFLD0061  DIM       30
XFLD0062  DIM       30
XFLD0063  DIM       30
XFLD0064  DIM       30
XFLD0065  DIM       30
XFLD0066  DIM       30
XFLD0067  DIM       30
XFLD0068  DIM       30
XFLD0069  DIM       30
XFLD0070  DIM       30
XFLD0071  DIM       30
XFLD0072  DIM       30
XFLD0073  DIM       30
XFLD0074  DIM       30
XFLD0075  DIM       30
XFLD0076  DIM       30
XFLD0077  DIM       30
XFLD0078  DIM       30
XFLD0079  DIM       30
XFLD0080  DIM       30
XFLD0081  DIM       30
XFLD0082  DIM       30
XFLD0083  DIM       30
XFLD0084  DIM       30
XFLD0085  DIM       30
XFLD0086  DIM       30
XFLD0087  DIM       30
XFLD0088  DIM       30
XFLD0089  DIM       30
XFLD0090  DIM       30
XFLD0091  DIM       30
XFLD0092  DIM       30
XFLD0093  DIM       30
XFLD0094  DIM       30
XFLD0095  DIM       30
XFLD0096  DIM       30
XFLD0097  DIM       30
XFLD0098  DIM       30
XFLD0099  DIM       30
XFLD0100  DIM       30
XFLD0101  DIM       30
XFLD0102  DIM       30
XFLD0103  DIM       30
XFLD0104  DIM       30
XFLD0105  DIM       30
XFLD0106  DIM       30
XFLD0107  DIM       30
XFLD0108  DIM       30
XFLD0109  DIM       30
XFLD0110  DIM       30
XFLD0111  DIM       30
XFLD0112  DIM       30
XFLD0113  DIM       30
XFLD0114  DIM       30
XFLD0115  DIM       30
XFLD0116  DIM       30
XFLD0117  DIM       30
XFLD0118  DIM       30
XFLD0119  DIM       30
XFLD0120  DIM       30
XFLD0121  DIM       30
XFLD0122  DIM       30
XFLD0123  DIM       30
XFLD0124  DIM       30
XFLD0125  DIM       30
XFLD0126  DIM       30
XFLD0127  DIM       30
XFLD0128  DIM       30
XFLD0129  DIM       30
XFLD0130  DIM       30
.
YFLD0001  DIM       100
.
.-----------------------------------------------------------------------------
PRGID     INIT      "IBAPMS56"
PRGNAM    INIT      "Upload MH HoNOS Data"
VERSION   INIT      "V12.01.00"
.-----------------------------------------------------------------------------
+
.-----------------------------------------------------------------------------
.         Main Module 
.-----------------------------------------------------------------------------
MAIN0000  CALL      INIT0000                . Initailize variables & open files
          CALL      KOPT0000                . Keyin Upload or Update option
          BRANCH    EXIT,MAIN9999
.
          BRANCH    COPTION,MAIN1000
          GOTO      MAIN9999
.
MAIN1000  CALL      KASC0000                . Keyin file
          BRANCH    EXIT,MAIN9900
.
MAIN1100  CALL      SCRD0000                . Display screen
          CALL      KUSR0000                . Keyin user id
          BRANCH    EXIT,MAIN0000
.
          CALL      KPTH0000                . Keyin pathname
          BRANCH    EXIT,MAIN0000
.
          CALL      SFLD0000
          BRANCH    EXIT,MAIN1100
.
          CALL      PRHD0000                . Print header
          CALL      CTOT0000                . Clear total vars
.
          CALL      PROC0000                . Process Updating file
.
          CALL      PTOT0000                . Print report totals
.
          GOTO      MAIN9999
.
MAIN9900  CALL      HEAD132
          PRINT     *N,"Failed to open upload file. "
.
MAIN9999  CHAIN     PGM
+
.-----------------------------------------------------------------------------
.         Initialize Variables & Open Files
.-----------------------------------------------------------------------------
INIT0000  CALL      DISPHEAD                . Display screen heading
.
          CALL      IBACLOCK
.
          DISPLAY   *P56:24,"Opening patcodes";
          OPEN      PATCODE1,"patcodes"
          OPEN      PATMA1A1,"patma1af"
          OPEN      PATMX1A1,"patmx1af"
          OPEN      PATVISA1,"patvisaf"
          OPEN      PMSHCPA1,"pmshcpaf"
          OPEN      ALLCASA1,"allcasaf"
.
          DISPLAY   *P64:24,"mehhonaf";
          OPEN      MEHHONA1,"mehhonaf"
          OPEN      MEHHONA3,"mehhonaf"
          OPEN      WEBSECA1,"websecaf"
.
          OPEN      CONTROLF,"controlf"
.
          CALL      IBACLOCK
          PACK      CURRDATE,CCC,CYY,CMM,CDD
          REP       " 0",CURRDATE
          MOVE      CCC,CURRCENT
.
          MOVE      SP70,VERRMSG
          MOVE      SP70,VERRMSG2
.
INIT9999  RETURN
+
.-----------------------------------------------------------------------------
.         Keyin option 
.-----------------------------------------------------------------------------
KOPT0000  MOVE      ZERO,EXIT
          MOVE      ZERO,COPTION
.
          DISPLAY   *P1:4,*EF:
                    *P1:4,*V2LON,"0",*HOFF," = Exit":
                    *P1:5,*V2LON,"1",*HOFF," = Upload MH HoNOS Data"
.
          DISPLAY   *P1:10,"Select Option : ";
.
KOPT1000  KEYIN     *P17:10,*V2LON,COPTION;
          BRANCH    COPTION,KOPT9999
.
          COMPARE   ZERO,COPTION
          GOTO      KOPT9000 IF EQUAL
          BEEP
          GOTO      KOPT1000
.
KOPT9000  MOVE      ONE,EXIT
KOPT9999  RETURN
+
.-----------------------------------------------------------------------------
.         Keyin input full path and file anme
.-----------------------------------------------------------------------------
KASC0000  MOVE      ZERO,EXIT
          PACK      FNAMEI WITH SP70,SP70,SP70
.
          IF        COPTION=1
            DISPLAY   *P26:12,*EF,"MH HoNOS Load File";
          ENDIF
.
          KEYIN     *P1:13,*EL,"Input Path & File Name : ",*V2LON,FNAMEI
.
          PACK      FNAMEI,FNAMEI,SP70,SP70,SP70
.
          MATCH     SP70,FNAMEI
          GOTO      KASC9000 IF EQUAL
.
          SCAN      ".txt",FNAMEI
          IF        !@EQUAL
            SQUEEZE   FNAMEI
            ENDSET    FNAMEI
            APPEND    ".txt",FNAMEI         . add ".txt" if there is a path
            APPEND    SP70,FNAMEI
            RESET     FNAMEI
          ENDIF
          RESET     FNAMEI
.
          IF        COPTION=1
            DISPLAY   *P26:13,*V2LON,*EL,FNAMEI;
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      HONOSTXT,FNAMEI
            TRAPCLR   IO
            BRANCH    OVRCD,KASC8000
          ENDIF
.
          CALL      KOUT0000                . Keyin output file
          BRANCH    EXIT,KASC9000
.
          CALL      EXCUS000
          MOVE      ZERO,EXIT
          GOTO      KASC9999
.
KASC8000  DISPLAY   *P1:24,*EL,*B,"File not found.  ";
          CALL      HITENTER
          GOTO      KASC0000
.
KASC9000  MOVE      ONE,EXIT
.
KASC9999  RETURN
+
.-----------------------------------------------------------------------------
.         Keyin output table name for backup
.-----------------------------------------------------------------------------
KOUT0000  BRANCH    COPTION,KOUT1000
          GOTO      KOUT9999
.
KOUT1000  MOVE      "mehhonaf",OUTFNAME
          GOTO      KOUT9000
.
KOUT9000  DISPLAY   *P1:14,"Output table file name : ";
          KEYIN     *P26:14,*RV,*V2LON,OUTFNAME;
          PACK      OUTFNAME,OUTFNAME,SP70
          MATCH     SP70,OUTFNAME
          GOTO      KOUT9500 IF EQUAL
.
          MOVE      ZERO,EXIT
          GOTO      KOUT9999
.
KOUT9500  MOVE      ONE,EXIT
.
KOUT9999  RETURN
+
.-----------------------------------------------------------------------------
. Prompt User ID and path name
.-----------------------------------------------------------------------------
SCRD0000  DISPLAY   *P1:15,*EF:
                    *P1:15," 1. User ID            :":
                    *P1:16," 2. Path name          :";
SCRD9999  RETURN
+
.-----------------------------------------------------------------------------
.         Keyin user id 
.-----------------------------------------------------------------------------
KUSR0000  KEYIN     *P26:15,*EL,*V2LON,USERID;
          PACK      USERID,USERID,SP70
          MATCH     SP70,USERID
          GOTO      KUSR9500 IF EQUAL
.
          MOVE      ZERO,EXIT
          GOTO      KUSR9999
.
KUSR9500  MOVE      ONE,EXIT
KUSR9999  RETURN
+
.-----------------------------------------------------------------------------
.         Keyin path name
.-----------------------------------------------------------------------------
KPTH0000  PACK      PATHNAME,SP70,SP70,SP70
          MOVE      FNAMEI,PATHNAME 
          KEYIN     *P26:16,*EL,*RV,*V2LON,PATHNAME;
          ENDSET    PATHNAME
          APPEND    SP70,PATHNAME
          APPEND    SP70,PATHNAME
          APPEND    SP70,PATHNAME
          RESET     PATHNAME
.
          MATCH     SP70,PATHNAME
          GOTO      KPTH9500 IF EQUAL
.
          MOVE      ZERO,EXIT
          GOTO      KPTH9999
.
KPTH9500  MOVE      ONE,EXIT
KPTH9999  RETURN
+
.-----------------------------------------------------------------------------
.         Select Field 
.-----------------------------------------------------------------------------
SFLD0000  CALL      MAINQST                 . Select Item, (P)ost, (C)ancel ?
.
          COMPARE   ZERO,CCITEM
          GOTO      SFLD9999 IF EQUAL
          GOTO      SFLD1000 IF LESS
.
          MOVE      ZERO,EXIT
.
          PERFORM   CCITEM,KUSR0000:        . Keyin user id
                           KPTH0000         . Keyin pathname
          BRANCH    EXIT,SFLD9999
          GOTO      SFLD0000
.
SFLD1000  MOVE      ONE,EXIT
SFLD9999  RETURN
+
.-----------------------------------------------------------------------------
. Print report sub heading 
.-----------------------------------------------------------------------------
PRHD0000  CALL      HEAD132
.
          BRANCH    COPTION,PRHD1000
          GOTO      PRHD9999
.
PRHD1000  STRIP     PATHNAME
          PRINT     *N,"MH HoNOS Load file : ",PATHNAME
          CALL      UND132
.
          PRINT     *1,"| Line No.",*12,"|  Adm No. |":
                    *25,"  U/R No.",*36,"|",*38,"HoNOS Date":
                    *48,"|",*50,"Error Message":
                    *132,"|"
.
PRHD9000  CALL      UND132
          GOTO      PRHD9999
.
PRHD9999  RETURN
+
.-----------------------------------------------------------------------------
. Processing Data
.-----------------------------------------------------------------------------
PROC0000  MOVE      ZERO,LINECNTR
.
          BRANCH    COPTION,PROC1000
          GOTO      PROC9999
.
PROC1000  CALL      HONO0000                . Process MH HONOS
          GOTO      PROC9999
.
PROC9999  RETURN
+
.-----------------------------------------------------------------------------
. Process MH HONOS data
.-----------------------------------------------------------------------------
HONO0000  OPEN      HONOSTXT,FNAMEI
.
HONO1000  READ      HONOSTXT,SEQ;XFLD0001,XFLD0003,XFLD0004,XFLD0005:
                                 XFLD0006,XFLD0007,XFLD0008,XFLD0009,XFLD0010:
                                 XFLD0011,XFLD0012,XFLD0013,XFLD0014,XFLD0015:
                                 XFLD0016,XFLD0017,XFLD0018,XFLD0019,XFLD0020:
                                 XFLD0021,XFLD0022,XFLD0023,XFLD0024,XFLD0025:
                                 XFLD0026,XFLD0027,XFLD0028,XFLD0029,XFLD0030:
                                 XFLD0031,XFLD0032,XFLD0033,XFLD0034,XFLD0035:
                                 XFLD0036,XFLD0037,XFLD0038,XFLD0039,YFLD0001:
                                 XFLD0041,XFLD0042,XFLD0043,XFLD0044,XFLD0045:
                                 XFLD0046,XFLD0047,XFLD0048,XFLD0049,XFLD0050:
                                 XFLD0051,XFLD0052,XFLD0053,XFLD0054,XFLD0055:
                                 XFLD0056,XFLD0057,XFLD0058,XFLD0059,XFLD0060:
                                 XFLD0061,XFLD0062,XFLD0063,XFLD0064,XFLD0065:
                                 XFLD0066,XFLD0067,XFLD0068,XFLD0069,XFLD0070:
                                 XFLD0071,XFLD0072,XFLD0073,XFLD0074,XFLD0075:
                                 XFLD0076,XFLD0077,XFLD0078,XFLD0079,XFLD0080:
                                 XFLD0081,XFLD0082,XFLD0083,XFLD0084,XFLD0085:
                                 XFLD0086,XFLD0087,XFLD0088,XFLD0089,XFLD0090:
                                 XFLD0091,XFLD0092,XFLD0093,XFLD0094,XFLD0095:
                                 XFLD0096,XFLD0097,XFLD0098,XFLD0099,XFLD0100:
                                 XFLD0101,XFLD0102,XFLD0103,XFLD0104,XFLD0105:
                                 XFLD0106,XFLD0107,XFLD0108,XFLD0109,XFLD0110:
                                 XFLD0111,XFLD0112,XFLD0113,XFLD0114,XFLD0115:
                                 XFLD0116,XFLD0117,XFLD0118,XFLD0119,XFLD0120:
                                 XFLD0121,XFLD0122,XFLD0123
.
          GOTO      HONO9000 IF OVER
.
          PACK      XFLD0001,XFLD0001,SP70
          MATCH     SP70,XFLD0001           . Visit Number
          GOTO      HONO2000 IF NOT EQUAL
.
          PACK      XFLD0003,XFLD0003,SP70
          MATCH     SP70,XFLD0003           . HONOS Type
          GOTO      HONO2000 IF NOT EQUAL
.
          PACK      XFLD0006,XFLD0006,SP70
          MATCH     SP70,XFLD0006           . HONOS Date
          GOTO      HONO2000 IF NOT EQUAL
.
          PACK      XFLD0118,XFLD0118,SP70
          MATCH     SP70,XFLD0118           . U/R Number
          GOTO      HONO2000 IF NOT EQUAL
.
          GOTO      HONO1000
.
HONO2000  ADD       ONE,LINECNTR            . Text file line counter for error
          CALL      PFLD0000                . pack fields with spaces
.
          CALL      VALD0000                . Validate fields
          BRANCH    ERORFLAG,HONO1000
.
          CALL      MOVFLD00  
.
          CALL      CLMEHHON                . clear table fields
.
HONO4000  PACK      KEY24,XHONVISN,XHONHDAT,Z70
          CALL      RSMHHON3
HONO4200  CALL      RPMHHON3
          BRANCH    OVRCD,HONO5000
.
          MATCH     XHONVISN,MHHNVISN
          GOTO      HONO5000 IF NOT EQUAL
.
          MATCH     XHONHDAT,MHHNHDAT
          GOTO      HONO5000 IF NOT EQUAL
.
          MATCH     XHONURNO,MHHNURNO
          GOTO      HONO6000 IF EQUAL
.
          GOTO      HONO4200 
.
. Insert New row
.
HONO5000  CALL      NXTUNI00
          MOVE      UNICOUNT,MHHNUNIQ          
.
          CALL      SETF0000
          ADD       ONE,ADDCOUNT            . Total records added
.
          PACK      KEY16,MHHNVISN,MHHNUNIQ,SP70
          CALL      WRMHHON1
          GOTO      HONO1000
.
. Update Existing row
.
HONO6000  PACK      KEY16,MHHNVISN,MHHNUNIQ,SP70
          CALL      RDMHHON1
.          
          CALL      SETF0000
          ADD       ONE,UPDCOUNT            . Total records updated
.
          CALL      UPMHHON1
          GOTO      HONO1000
.
HONO9000  CLOSE     HONOSTXT
HONO9999  RETURN
.
.-----------------------------------------------------------------------------
. Get next unique count number for a visit number  
.-----------------------------------------------------------------------------
NXTUNI00  MOVE      ZERO,UNICOUNT 
          PACK      KEY24,XHONVISN,Z70
          CALL      RSMHHON3
NXTUNI20  CALL      RPMHHON3
          BRANCH    OVRCD,NXTUNI80
.
          MATCH     XHONVISN,MHHNVISN
          GOTO      NXTUNI80 IF NOT EQUAL
.
          MOVE      ZERO,F8 
          MOVE      MHHNUNIQ,F8  
          ADD       ONE,F8  
          MOVE      F8,UNICOUNT
.
          GOTO      NXTUNI99
.
NXTUNI80  MOVE      ONE,UNICOUNT 
.
NXTUNI99  RETURN
.
.-----------------------------------------------------------------------------
. Move fields from input loading file to temporary file
.-----------------------------------------------------------------------------
MOVFLD00                                        . Visit Number
          PACK      XHONHOTY,XFLD0003,SP70      . HONOS Type (Cat hs)
          PACK      XHONACTV,XFLD0004,SP70      . Active 1=Yes    
          PACK      XHONSENT,XFLD0005,SP70      . Sent (1=Yes)
.                                               . HONOS Date (CCYYMMDD)
          PACK      XHONSSET,XFLD0007,SP70      . Service Setting (Cat ss)
          PACK      XHONREAS,XFLD0008,SP70      . Reason for Collection (Cat hp)
          PACK      XHONRHCP,XFLD0009,SP70      . Responsible HCP (pmshcpaf)
          PACK      XHONCAST,XFLD0010,SP70      . Case Team (allcasaf)
          PACK      XHONPHCP,XFLD0011,SP70      . Performing HCP (pmshcpaf)
          PACK      XHONWEBC,XFLD0012,SP70      . WEB User Created (websecaf)
          PACK      XHONCDTE,XFLD0013,SP70      . Date Created (CCYYMMDD)
          PACK      XHONCTIM,XFLD0014,SP70      . Time Created (HH:MM:SS)
          PACK      XHONCOMP,XFLD0015,SP70      . Completed (1=Yes)
          PACK      XHONWEBF,XFLD0016,SP70      . Web User Completed (websecaf)
          PACK      XHONDATF,XFLD0017,SP70      . Date Completed (CCYYMMDD)
          PACK      XHONTIMF,XFLD0018,SP70      . Time Completed (HH:MM:SS)
          PACK      XHONWEBU,XFLD0019,SP70      . Web User ID Updated (websecaf)
          PACK      XHONDATU,XFLD0020,SP70      . Date Updated (CCYYMMDD)
          PACK      XHONTIMU,XFLD0021,SP70      . Time Updated (HH:MM:SS)
          PACK      XHONFOCU,XFLD0022,SP70      . Focus of Care (Cat hf)
          PACK      XHONCULS,XFLD0023,SP70      . Cultural Support (Cat hc)
          PACK      XHONNGOS,XFLD0024,SP70      . NGO Support (1=Yes)
          PACK      XHONNGOA,XFLD0025,SP70      . NGO Support Accomm (1=Yes)
          PACK      XHONNGOW,XFLD0026,SP70      . NGO Comm Support Worker(1=Yes)
          PACK      XHONVOCA,XFLD0027,SP70      . Vocational Assistance (1=Yes)
          PACK      XHONNSNG,XFLD0028,SP70      . Non Spec NGO Service (1=Yes)
          PACK      XHONCOLS,XFLD0029,SP70      . Collection Status (Cat ht)
          PACK      XHONMODA,XFLD0030,SP70      . Mode of Admin (Cat hm)
          PACK      XHONADQ1,XFLD0031,SP70      . Adult Q1
          PACK      XHONADQ2,XFLD0032,SP70      . Adult Q2
          PACK      XHONADQ3,XFLD0033,SP70      . Adult Q3
          PACK      XHONADQ4,XFLD0034,SP70      . Adult Q4
          PACK      XHONADQ5,XFLD0035,SP70      . Adult Q5
          PACK      XHONADQ6,XFLD0036,SP70      . Adult Q6
          PACK      XHONADQ7,XFLD0037,SP70      . Adult Q7
          PACK      XHONADQ8,XFLD0038,SP70      . Adult Q8
          PACK      XHONAQ8A,XFLD0039,SP70      . Adult Q8A
          PACK      XHONFREE,YFLD0001,SP70      . 8A Free Text
          PACK      XHONADQ9,XFLD0041,SP70      . Adult Q9
          PACK      XHONAQ10,XFLD0042,SP70      . Adult Q10
          PACK      XHONAQ11,XFLD0043,SP70      . Adult Q11
          PACK      XHONAQ12,XFLD0044,SP70      . Adult Q12
          PACK      XHONCYQ1,XFLD0045,SP70      . Child and Youth Q1
          PACK      XHONCYQ2,XFLD0046,SP70      . Child and Youth Q2
          PACK      XHONCYQ3,XFLD0047,SP70      . Child and Youth Q3
          PACK      XHONCYQ4,XFLD0048,SP70      . Child and Youth Q4
          PACK      XHONCYQ5,XFLD0049,SP70      . Child and Youth Q5
          PACK      XHONCYQ6,XFLD0050,SP70      . Child and Youth Q6
          PACK      XHONCYQ7,XFLD0051,SP70      . Child and Youth Q7
          PACK      XHONCYQ8,XFLD0052,SP70      . Child and Youth Q8
          PACK      XHONCYQ9,XFLD0053,SP70      . Child and Youth Q9
          PACK      XHONCQ10,XFLD0054,SP70      . Child and Youth Q10
          PACK      XHONCQ11,XFLD0055,SP70      . Child and Youth Q11
          PACK      XHONCQ12,XFLD0056,SP70      . Child and Youth Q12
          PACK      XHONCQ13,XFLD0057,SP70      . Child and Youth Q13
          PACK      XHONCQ14,XFLD0058,SP70      . Child and Youth Q14
          PACK      XHONCQ15,XFLD0059,SP70      . Child and Youth Q15
          PACK      XHONLDQ1,XFLD0060,SP70      . Learning Disabilities Q1
          PACK      XHONLDQ2,XFLD0061,SP70      . Learning Disabilities Q2
          PACK      XHONLDQ3,XFLD0062,SP70      . Learning Disabilities Q3
          PACK      XHONLDQ4,XFLD0063,SP70      . Learning Disabilities Q4
          PACK      XHONLDQ5,XFLD0064,SP70      . Learning Disabilities Q5
          PACK      XHONLDQ6,XFLD0065,SP70      . Learning Disabilities Q6
          PACK      XHONLDQ7,XFLD0066,SP70      . Learning Disabilities Q7
          PACK      XHONLDQ8,XFLD0067,SP70      . Learning Disabilities Q8
          PACK      XHONLDQ9,XFLD0068,SP70      . Learning Disabilities Q9
          PACK      XHONLQ10,XFLD0069,SP70      . Learning Disabilities Q10
          PACK      XHONLQ11,XFLD0070,SP70      . Learning Disabilities Q11
          PACK      XHONLQ12,XFLD0071,SP70      . Learning Disabilities Q12
          PACK      XHONLQ13,XFLD0072,SP70      . Learning Disabilities Q13
          PACK      XHONLQ14,XFLD0073,SP70      . Learning Disabilities Q14
          PACK      XHONLQ15,XFLD0074,SP70      . Learning Disabilities Q15
          PACK      XHONLQ16,XFLD0075,SP70      . Learning Disabilities Q16
          PACK      XHONLQ17,XFLD0076,SP70      . Learning Disabilities Q17
          PACK      XHONLQ18,XFLD0077,SP70      . Learning Disabilities Q18
          PACK      XHONSCQ1,XFLD0078,SP70      . Secure Q1
          PACK      XHONSCQ2,XFLD0079,SP70      . Secure Q2
          PACK      XHONSCQ3,XFLD0080,SP70      . Secure Q3
          PACK      XHONSCQ4,XFLD0081,SP70      . Secure Q4
          PACK      XHONSCQ5,XFLD0082,SP70      . Secure Q5
          PACK      XHONSCQ6,XFLD0083,SP70      . Secure Q6
          PACK      XHONSCQ7,XFLD0084,SP70      . Secure Q7
          PACK      XHONHVER,XFLD0085,SP70      . Honos Version (cat hv)
          PACK      XHONLD3A,XFLD0086,SP70      . LD Question 3A (Cat hl)
          PACK      XHONRDAT,XFLD0087,SP70      . Review Date (CCYYMMDD)
          PACK      XHONRFMV,XFLD0088,SP70      . ADOM Mandated / Voluntary
          PACK      XHONDAYS,XFLD0089,SP70      . ADOM No of Days cover (7-28)
          PACK      XHONCEPS,XFLD0090,SP70      . ADOM Co-existing Prob (Yes/No)
          PACK      XHONAM01,XFLD0091,SP70      . ADOM Q1
          PACK      XHONAM02,XFLD0092,SP70      . ADOM Q2
          PACK      XHONAM03,XFLD0093,SP70      . ADOM Q3
          PACK      XHONAM04,XFLD0094,SP70      . ADOM Q4
          PACK      XHONAM05,XFLD0095,SP70      . ADOM Q5
          PACK      XHONAM06,XFLD0096,SP70      . ADOM Q6
          PACK      XHONAM7A,XFLD0097,SP70      . ADOM Q7a
          PACK      XHONAM7B,XFLD0098,SP70      . ADOM Q7b
          PACK      XHONAM7C,XFLD0099,SP70      . ADOM Q7c
          PACK      XHONAM7D,XFLD0100,SP70      . ADOM Q7d
          PACK      XHONAM7E,XFLD0101,SP70      . ADOM Q7e
          PACK      XHONAM7F,XFLD0102,SP70      . ADOM Q7f
          PACK      XHONAM08,XFLD0103,SP70      . ADOM Q8
          PACK      XHONAM9A,XFLD0104,SP70      . ADOM Q9a
          PACK      XHONAM9B,XFLD0105,SP70      . ADOM Q9b
          PACK      XHONAM9C,XFLD0106,SP70      . ADOM Q9c
          PACK      XHONAM10,XFLD0107,SP70      . ADOM Q10
          PACK      XHONAM11,XFLD0108,SP70      . ADOM Q11
          PACK      XHONAM12,XFLD0109,SP70      . ADOM Q12
          PACK      XHONAM13,XFLD0110,SP70      . ADOM Q13
          PACK      XHONAM14,XFLD0111,SP70      . ADOM Q14
          PACK      XHONAM15,XFLD0112,SP70      . ADOM Q15
          PACK      XHONAM16,XFLD0113,SP70      . ADOM Q16
          PACK      XHONAM17,XFLD0114,SP70      . ADOM Q17
          PACK      XHONAM18,XFLD0115,SP70      . ADOM Q18
          PACK      XHONAM19,XFLD0116,SP70      . ADOM Q19
          PACK      XHONAM20,XFLD0117,SP70      . ADOM Q20
.                                               . U/R Number
          PACK      XHONDELF,XFLD0119,SP70      . Delete Flag
          PACK      XHONDUID,XFLD0120,SP70      . User who deleted assessment
          PACK      XHONDDTE,XFLD0121,SP70      . Date assessment deleted
          PACK      XHONDTME,XFLD0122,SP70      . Time assessment deleted
          PACK      XHONDRES,XFLD0123,SP70      . Reason for delete
.
MOVFLD99  RETURN
.
.-----------------------------------------------------------------------------
. Move fields from temporray file to table file
.-----------------------------------------------------------------------------
SETF0000  BRANCH   COPTION,SETF1000
          GOTO     SETF9999
.
SETF1000  MOVE     XHONVISN,MHHNVISN  . Visit Number
.                                     . Unique Count
          MOVE     XHONHOTY,MHHNHOTY  . HONOS Type (Cat hs)
          MOVE     XHONACTV,MHHNACTV  . Active 1=Yes
          MOVE     XHONSENT,MHHNSENT  . Sent (1=Yes)
          MOVE     XHONHDAT,MHHNHDAT  . HONOS Date (CCYYMMDD)
          MOVE     XHONSSET,MHHNSSET  . Service Setting (Cat ss)
          MOVE     XHONREAS,MHHNREAS  . Reason for Collection (Cat hp)
          MOVE     XHONRHCP,MHHNRHCP  . Responsible HCP (pmshcpaf)
          MOVE     XHONCAST,MHHNCAST  . Case Team (allcasaf)
          MOVE     XHONPHCP,MHHNPHCP  . Performing HCP (pmshcpaf)
          MOVE     XHONWEBC,MHHNWEBC  . WEB User Created (websecaf)
          MOVE     XHONCDTE,MHHNCDTE  . Date Created (CCYYMMDD)
          MOVE     XHONCTIM,MHHNCTIM  . Time Created (HH:MM:SS)
          MOVE     XHONCOMP,MHHNCOMP  . Completed (1=Yes)
          MOVE     XHONWEBF,MHHNWEBF  . Web User Completed (websecaf)
          MOVE     XHONDATF,MHHNDATF  . Date Completed (CCYYMMDD)
          MOVE     XHONTIMF,MHHNTIMF  . Time Completed (HH:MM:SS)
          MOVE     XHONWEBU,MHHNWEBU  . Web User ID Updated (websecaf)
          MOVE     XHONDATU,MHHNDATU  . Date Updated (CCYYMMDD)
          MOVE     XHONTIMU,MHHNTIMU  . Time Updated (HH:MM:SS)
          MOVE     XHONFOCU,MHHNFOCU  . Focus of Care (Cat hf)
          MOVE     XHONCULS,MHHNCULS  . Cultural Support (Cat hc)
          MOVE     XHONNGOS,MHHNNGOS  . NGO Support (1=Yes)
          MOVE     XHONNGOA,MHHNNGOA  . NGO Support Accommodation (1=Yes)
          MOVE     XHONNGOW,MHHNNGOW  . NGO Comm Support Worker (1=Yes)
          MOVE     XHONVOCA,MHHNVOCA  . Vocational Assistance (1=Yes)
          MOVE     XHONNSNG,MHHNNSNG  . Non Specific NGO Service (1=Yes)
          MOVE     XHONCOLS,MHHNCOLS  . Collection Status (Cat ht)
          MOVE     XHONMODA,MHHNMODA  . Mode of Administration (Cat hm)
          MOVE     XHONADQ1,MHHNADQ1  . Adult Q1
          MOVE     XHONADQ2,MHHNADQ2  . Adult Q2
          MOVE     XHONADQ3,MHHNADQ3  . Adult Q3
          MOVE     XHONADQ4,MHHNADQ4  . Adult Q4
          MOVE     XHONADQ5,MHHNADQ5  . Adult Q5
          MOVE     XHONADQ6,MHHNADQ6  . Adult Q6
          MOVE     XHONADQ7,MHHNADQ7  . Adult Q7
          MOVE     XHONADQ8,MHHNADQ8  . Adult Q8
          MOVE     XHONAQ8A,MHHNAQ8A  . Adult Q8A
          MOVE     XHONFREE,MHHNFREE  . 8A Free Text
          MOVE     XHONADQ9,MHHNADQ9  . Adult Q9
          MOVE     XHONAQ10,MHHNAQ10  . Adult Q10
          MOVE     XHONAQ11,MHHNAQ11  . Adult Q11
          MOVE     XHONAQ12,MHHNAQ12  . Adult Q12
          MOVE     XHONCYQ1,MHHNCYQ1  . Child and Youth Q1
          MOVE     XHONCYQ2,MHHNCYQ2  . Child and Youth Q2
          MOVE     XHONCYQ3,MHHNCYQ3  . Child and Youth Q3
          MOVE     XHONCYQ4,MHHNCYQ4  . Child and Youth Q4
          MOVE     XHONCYQ5,MHHNCYQ5  . Child and Youth Q5
          MOVE     XHONCYQ6,MHHNCYQ6  . Child and Youth Q6
          MOVE     XHONCYQ7,MHHNCYQ7  . Child and Youth Q7
          MOVE     XHONCYQ8,MHHNCYQ8  . Child and Youth Q8
          MOVE     XHONCYQ9,MHHNCYQ9  . Child and Youth Q9
          MOVE     XHONCQ10,MHHNCQ10  . Child and Youth Q10
          MOVE     XHONCQ11,MHHNCQ11  . Child and Youth Q11
          MOVE     XHONCQ12,MHHNCQ12  . Child and Youth Q12
          MOVE     XHONCQ13,MHHNCQ13  . Child and Youth Q13
          MOVE     XHONCQ14,MHHNCQ14  . Child and Youth Q14
          MOVE     XHONCQ15,MHHNCQ15  . Child and Youth Q15
          MOVE     XHONLDQ1,MHHNLDQ1  . Learning Disabilities Q1
          MOVE     XHONLDQ2,MHHNLDQ2  . Learning Disabilities Q2
          MOVE     XHONLDQ3,MHHNLDQ3  . Learning Disabilities Q3
          MOVE     XHONLDQ4,MHHNLDQ4  . Learning Disabilities Q4
          MOVE     XHONLDQ5,MHHNLDQ5  . Learning Disabilities Q5
          MOVE     XHONLDQ6,MHHNLDQ6  . Learning Disabilities Q6
          MOVE     XHONLDQ7,MHHNLDQ7  . Learning Disabilities Q7
          MOVE     XHONLDQ8,MHHNLDQ8  . Learning Disabilities Q8
          MOVE     XHONLDQ9,MHHNLDQ9  . Learning Disabilities Q9
          MOVE     XHONLQ10,MHHNLQ10  . Learning Disabilities Q10
          MOVE     XHONLQ11,MHHNLQ11  . Learning Disabilities Q11
          MOVE     XHONLQ12,MHHNLQ12  . Learning Disabilities Q12
          MOVE     XHONLQ13,MHHNLQ13  . Learning Disabilities Q13
          MOVE     XHONLQ14,MHHNLQ14  . Learning Disabilities Q14
          MOVE     XHONLQ15,MHHNLQ15  . Learning Disabilities Q15
          MOVE     XHONLQ16,MHHNLQ16  . Learning Disabilities Q16
          MOVE     XHONLQ17,MHHNLQ17  . Learning Disabilities Q17
          MOVE     XHONLQ18,MHHNLQ18  . Learning Disabilities Q18
          MOVE     XHONSCQ1,MHHNSCQ1  . Secure Q1
          MOVE     XHONSCQ2,MHHNSCQ2  . Secure Q2
          MOVE     XHONSCQ3,MHHNSCQ3  . Secure Q3
          MOVE     XHONSCQ4,MHHNSCQ4  . Secure Q4
          MOVE     XHONSCQ5,MHHNSCQ5  . Secure Q5
          MOVE     XHONSCQ6,MHHNSCQ6  . Secure Q6
          MOVE     XHONSCQ7,MHHNSCQ7  . Secure Q7
          MOVE     XHONHVER,MHHNHVER  . Honos Version (cat hv)
          MOVE     XHONLD3A,MHHNLD3A  . LD Question 3A (Cat hl)
          MOVE     XHONRDAT,MHHNRDAT  . Review Date (CCYYMMDD)
          MOVE     XHONRFMV,MHHNRFMV  . ADOM Mandated / Voluntary
          MOVE     XHONDAYS,MHHNDAYS  . ADOM Number of Days covered (7-28)
          MOVE     XHONCEPS,MHHNCEPS  . ADOM Co-existing Problems (Yes/No)
          MOVE     XHONAM01,MHHNAM01  . ADOM Q1
          MOVE     XHONAM02,MHHNAM02  . ADOM Q2
          MOVE     XHONAM03,MHHNAM03  . ADOM Q3
          MOVE     XHONAM04,MHHNAM04  . ADOM Q4
          MOVE     XHONAM05,MHHNAM05  . ADOM Q5
          MOVE     XHONAM06,MHHNAM06  . ADOM Q6
          MOVE     XHONAM7A,MHHNAM7A  . ADOM Q7a
          MOVE     XHONAM7B,MHHNAM7B  . ADOM Q7b
          MOVE     XHONAM7C,MHHNAM7C  . ADOM Q7c
          MOVE     XHONAM7D,MHHNAM7D  . ADOM Q7d
          MOVE     XHONAM7E,MHHNAM7E  . ADOM Q7e
          MOVE     XHONAM7F,MHHNAM7F  . ADOM Q7f
          MOVE     XHONAM08,MHHNAM08  . ADOM Q8
          MOVE     XHONAM9A,MHHNAM9A  . ADOM Q9a
          MOVE     XHONAM9B,MHHNAM9B  . ADOM Q9b
          MOVE     XHONAM9C,MHHNAM9C  . ADOM Q9c
          MOVE     XHONAM10,MHHNAM10  . ADOM Q10
          MOVE     XHONAM11,MHHNAM11  . ADOM Q11
          MOVE     XHONAM12,MHHNAM12  . ADOM Q12
          MOVE     XHONAM13,MHHNAM13  . ADOM Q13
          MOVE     XHONAM14,MHHNAM14  . ADOM Q14
          MOVE     XHONAM15,MHHNAM15  . ADOM Q15
          MOVE     XHONAM16,MHHNAM16  . ADOM Q16
          MOVE     XHONAM17,MHHNAM17  . ADOM Q17
          MOVE     XHONAM18,MHHNAM18  . ADOM Q18
          MOVE     XHONAM19,MHHNAM19  . ADOM Q19
          MOVE     XHONAM20,MHHNAM20  . ADOM Q20
          MOVE     XHONURNO,MHHNURNO  . U/R Number
          MOVE     XHONDELF,MHHNDELF  . Delete Flag
          MOVE     XHONDUID,MHHNDUID  . User who deleted assessment
          MOVE     XHONDDTE,MHHNDDTE  . Date assessment deleted
          MOVE     XHONDTME,MHHNDTME  . Time assessment deleted
          MOVE     XHONDRES,MHHNDRES  . Reason for delete
.
          GOTO      SETF9999
.
SETF9999  RETURN
+
.-----------------------------------------------------------------------------
.         Execute us1 command before processing
.-----------------------------------------------------------------------------
EXCUS000  CLEAR     CMDLINE
          APPEND    "ibapms56.us1 ",CMDLINE
          SQUEEZE   FNAMEI
          APPEND    FNAMEI,CMDLINE
          APPEND    SP1,CMDLINE
          APPEND    OUTFNAME,CMDLINE
          APPEND    SP70,CMDLINE
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
EXCUS999  RETURN
+
.-----------------------------------------------------------------------------
. Validate input text file fields
.-----------------------------------------------------------------------------
VALD0000  MOVE      ZERO,EXIT
          MOVE      ZERO,ERORFLAG
.
          BRANCH    COPTION,VALD1000
          GOTO      VALD9999
.
VALD1000  CALL      VHONO000                . Validate MH Honos
          GOTO      VALD9999
.
VALD9999  RETURN
+
.-----------------------------------------------------------------------------
. Validate MH HONOS input text fields
.-----------------------------------------------------------------------------
VHONO000  MOVE      XFLD0001,XHONVISN       . Visit Number
          RJUSTIFY  XHONVISN
          MOVE      XFLD0118,XHONURNO       . U/R Number
          RJUSTIFY  XHONURNO 
          MOVE      XFLD0006,XHONHDAT       . HONOS Date
.
          MATCH     SP70,XFLD0001
          IF        @EQUAL
            MOVE      "Visit Number is blank",VERRMSG
            CALL      PERR0000
          ELSE
            MOVE      XFLD0001,VINFIELD
            MOVE      8,VINTLEN
            MOVE      "Visit Number",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      KEY8,XFLD0001,SP70
              RJUSTIFY  KEY8 
              CALL      RDVISA1 
              IF        OVRCD=1
                MOVE      "Invalid Visit Number - patvisaf",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          CALL      VHONTY00
.
          MATCH     SP70,XFLD0004
          IF        !@EQUAL
            MOVE      XFLD0004,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Active Flag",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              MATCH     "1",XFLD0004
              IF        !@EQUAL
                MOVE      "Active Flag must be '1'",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0005
          IF        !@EQUAL
            MOVE      XFLD0005,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Sent Flag",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              MATCH     "1",XFLD0005
              IF        !@EQUAL
                MOVE      "Sent Flag must be '1'",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0006
          IF        @EQUAL
            MOVE      "HoNOS Date is blank",VERRMSG
            CALL      PERR0000
          ELSE
            MOVE      XFLD0006,VINFIELD
            MOVE      8,VINTLEN
            MOVE      "HoNOS Date",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      TEMPDATE,XFLD0006,SP70
              MOVE      "HoNOS Date",VFLDNAME
              CALL      VDAT0000
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0007
          IF        @EQUAL
            MOVE      "Service Setting is blank",VERRMSG
            CALL      PERR0000
          ELSE
            MOVE      XFLD0007,VINFIELD
            MOVE      3,VINTLEN
            MOVE      "Service Setting",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              MOVE      "ss",KEY2
              UNPACK    XFLD0007,KEY3
              PACK      KEY5,KEY2,KEY3,SP70
              CALL      RDCODE1
              IF        OVRCD=1
                MOVE      "Invalid Service Setting Code",VERRMSG
                CALL      PERR0000
              ELSE
                MATCH     "I",PTCOACTV
                IF        @EQUAL
                  MOVE      "Service Setting Code is Inactive",VERRMSG
                  CALL      PERR0000
                ELSE
                  MATCH     "I",TCINDC2
                  IF        !@EQUAL
                    MOVE      "Invalid Service Setting - Indicator 2",VERRMSG
                    CALL      PERR0000  
                  ENDIF  
                ENDIF
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0008
          IF        @EQUAL
            MOVE      "Reason for Collection is blank",VERRMSG
            CALL      PERR0000
          ELSE
            MOVE      XFLD0008,VINFIELD
            MOVE      3,VINTLEN
            MOVE      "Reason for Collection",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              MOVE      "hp",KEY2
              UNPACK    XFLD0008,KEY3
              PACK      KEY5,KEY2,KEY3,SP70
              CALL      RDCODE1
              IF        OVRCD=1
                MOVE      "Invalid Reason for Collection Code",VERRMSG
                CALL      PERR0000
              ELSE
                MATCH     "I",PTCOACTV
                IF        @EQUAL
                  MOVE      "Reason for Collection is Inactive",VERRMSG
                  CALL      PERR0000
                ELSE
                  MATCH     "H",TCINDC5
                  IF        !@EQUAL
                    MOVE      "Invalid Reason for Collection - Indicator 5",VERRMSG
                    CALL      PERR0000
                  ENDIF
                ENDIF
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0009
          IF        !@EQUAL
            MOVE      XFLD0009,VINFIELD
            MOVE      10,VINTLEN
            MOVE      "Responsible HCP",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      KEY10,XFLD0009,SP70
              CALL      RDPMHCP1
              IF        OVRCD=1
                MOVE      "Invalid Responsible HCP - pmshcpaf",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0010
          IF        !@EQUAL
            MOVE      XFLD0010,VINFIELD
            MOVE      10,VINTLEN
            MOVE      "Case Team",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      KEY10,XFLD0010,SP70
              CALL      RDALCAS1
              IF        OVRCD=1
                MOVE      "Invalid Case Team - allcasaf",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0011
          IF        !@EQUAL
            MOVE      XFLD0011,VINFIELD
            MOVE      10,VINTLEN
            MOVE      "Performing HCP",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      KEY10,XFLD0011,SP70
              CALL      RDPMHCP1
              IF        OVRCD=1
                MOVE      "Invalid Performing HCP - pmshcpaf",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0012
          IF        !@EQUAL
            MOVE      XFLD0012,VINFIELD
            MOVE      10,VINTLEN
            MOVE      "WEB User Created",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      KEY10,XFLD0012,SP70
              CALL      RDWBSE1
              IF        OVRCD=1
                MOVE      "Invalid WEB User Created - websecaf",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0013
          IF        !@EQUAL
            MOVE      XFLD0013,VINFIELD
            MOVE      8,VINTLEN
            MOVE      "Date Created",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      TEMPDATE,XFLD0013,SP70
              MOVE      "Date Created",VFLDNAME
              CALL      VDAT0000
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0014
          IF        !@EQUAL
            MOVE      XFLD0014,VINFIELD
            MOVE      8,VINTLEN
            MOVE      "Time Created",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      TEMPTIME,XFLD0014,SP70
              MOVE      "Time Created",VFLDNAME
              CALL      VTIM0000
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0015
          IF        !@EQUAL
            MOVE      XFLD0015,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Complete Flag",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              MATCH     "1",XFLD0015
              IF        !@EQUAL
                MOVE      "Complete Flag must be '1'",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0016
          IF        !@EQUAL
            MOVE      XFLD0016,VINFIELD
            MOVE      10,VINTLEN
            MOVE      "Web User Completed",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      KEY10,XFLD0016,SP70
              CALL      RDWBSE1
              IF        OVRCD=1
                MOVE      "Invalid WEB User Completed - websecaf",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0017
          IF        !@EQUAL
            MOVE      XFLD0017,VINFIELD
            MOVE      8,VINTLEN
            MOVE      "Date Completed",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      TEMPDATE,XFLD0017,SP70
              MOVE      "Date Completed",VFLDNAME
              CALL      VDAT0000
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0018
          IF        !@EQUAL
            MOVE      XFLD0018,VINFIELD
            MOVE      8,VINTLEN
            MOVE      "Time Completed",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      TEMPTIME,XFLD0018,SP70
              MOVE      "Time Completed",VFLDNAME
              CALL      VTIM0000
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0019
          IF        !@EQUAL
            MOVE      XFLD0019,VINFIELD
            MOVE      10,VINTLEN
            MOVE      "Web User Updated",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      KEY10,XFLD0019,SP70
              CALL      RDWBSE1
              IF        OVRCD=1
                MOVE      "Invalid WEB User Updated - websecaf",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0020
          IF        !@EQUAL
            MOVE      XFLD0020,VINFIELD
            MOVE      8,VINTLEN
            MOVE      "Date Updated",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      TEMPDATE,XFLD0020,SP70
              MOVE      "Date Updated",VFLDNAME
              CALL      VDAT0000
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0021
          IF        !@EQUAL
            MOVE      XFLD0021,VINFIELD
            MOVE      8,VINTLEN
            MOVE      "Time Updated",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      TEMPTIME,XFLD0021,SP70
              MOVE      "Time Updated",VFLDNAME
              CALL      VTIM0000
            ENDIF
          ENDIF
.
          CALL       VFOCCA00
          CALL       VCULSP00
.
          MATCH     SP70,XFLD0024
          IF        !@EQUAL
            MOVE      XFLD0024,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "NGO Support",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              MATCH     "1",XFLD0024
              IF        !@EQUAL
                MOVE      "NGO Support must be '1'",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0025
          IF        !@EQUAL
            MOVE      XFLD0025,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "NGO Support Accommodation",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              MATCH     "1",XFLD0025
              IF        !@EQUAL
                MOVE      "NGO Support Accommodation must be '1'",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0026
          IF        !@EQUAL
            MOVE      XFLD0026,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "NGO Comm Support Worker",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              MATCH     "1",XFLD0026
              IF        !@EQUAL
                MOVE      "NGO Comm Support Worker must be '1'",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0027
          IF        !@EQUAL
            MOVE      XFLD0027,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Vocational Assistance",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              MATCH     "1",XFLD0027
              IF        !@EQUAL
                MOVE      "Vocational Assistance must be '1'",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0028
          IF        !@EQUAL
            MOVE      XFLD0028,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Non Specific NGO Service",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              MATCH     "1",XFLD0028
              IF        !@EQUAL
                MOVE      "Non Specific NGO Service must be '1'",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          CALL      VCOLST00
          CALL      VMODAD00 
.
. Field 31
.
VHONO031  MATCH     SP70,XFLD0031
          IF        !@EQUAL
            MOVE      XFLD0031,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Adult Q1",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0032
          IF        !@EQUAL
            MOVE      XFLD0032,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Adult Q2",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0033
          IF        !@EQUAL
            MOVE      XFLD0033,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Adult Q3",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0034
          IF        !@EQUAL
            MOVE      XFLD0034,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Adult Q4",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0035
          IF        !@EQUAL
            MOVE      XFLD0035,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Adult Q5",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0036
          IF        !@EQUAL
            MOVE      XFLD0036,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Adult Q6",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0037
          IF        !@EQUAL
            MOVE      XFLD0037,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Adult Q7",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0038
          IF        !@EQUAL
            MOVE      XFLD0038,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Adult Q8",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0039
          IF        !@EQUAL
            MOVE      XFLD0039,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Adult Q8A",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,YFLD0001
          IF        !@EQUAL
            MOVE      YFLD0001,VINFIELD
            MOVE      35,VINTLEN
            MOVE      "8A Free Text",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0041
          IF        !@EQUAL
            MOVE      XFLD0041,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Adult Q9",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0042
          IF        !@EQUAL
            MOVE      XFLD0042,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Adult Q10",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0043
          IF        !@EQUAL
            MOVE      XFLD0043,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Adult Q11",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0044
          IF        !@EQUAL
            MOVE      XFLD0044,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Adult Q12",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0045
          IF        !@EQUAL
            MOVE      XFLD0045,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Child and Youth Q1",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0046
          IF        !@EQUAL
            MOVE      XFLD0046,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Child and Youth Q2",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0047
          IF        !@EQUAL
            MOVE      XFLD0047,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Child and Youth Q3",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0048
          IF        !@EQUAL
            MOVE      XFLD0048,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Child and Youth Q4",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0049
          IF        !@EQUAL
            MOVE      XFLD0049,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Child and Youth Q5",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0050
          IF        !@EQUAL
            MOVE      XFLD0050,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Child and Youth Q6",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0051
          IF        !@EQUAL
            MOVE      XFLD0051,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Child and Youth Q7",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0052
          IF        !@EQUAL
            MOVE      XFLD0052,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Child and Youth Q8",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0053
          IF        !@EQUAL
            MOVE      XFLD0053,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Child and Youth Q9",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0054
          IF        !@EQUAL
            MOVE      XFLD0054,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Child and Youth Q10",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0055
          IF        !@EQUAL
            MOVE      XFLD0055,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Child and Youth Q11",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0056
          IF        !@EQUAL
            MOVE      XFLD0056,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Child and Youth Q12",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0057
          IF        !@EQUAL
            MOVE      XFLD0057,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Child and Youth Q13",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0058
          IF        !@EQUAL
            MOVE      XFLD0058,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Child and Youth Q14",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0059
          IF        !@EQUAL
            MOVE      XFLD0059,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Child and Youth Q15",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
. Field 60
.
          MATCH     SP70,XFLD0060
          IF        !@EQUAL
            MOVE      XFLD0060,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q1",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0061
          IF        !@EQUAL
            MOVE      XFLD0061,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q2",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0062
          IF        !@EQUAL
            MOVE      XFLD0062,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q3",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0063
          IF        !@EQUAL
            MOVE      XFLD0063,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q4",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0064
          IF        !@EQUAL
            MOVE      XFLD0064,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q5",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0065
          IF        !@EQUAL
            MOVE      XFLD0065,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q6",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0066
          IF        !@EQUAL
            MOVE      XFLD0066,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q7",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0067
          IF        !@EQUAL
            MOVE      XFLD0067,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q8",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0068
          IF        !@EQUAL
            MOVE      XFLD0068,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q9",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0069
          IF        !@EQUAL
            MOVE      XFLD0069,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q10",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0070
          IF        !@EQUAL
            MOVE      XFLD0070,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q11",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0071
          IF        !@EQUAL
            MOVE      XFLD0071,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q12",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0072
          IF        !@EQUAL
            MOVE      XFLD0072,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q13",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0073
          IF        !@EQUAL
            MOVE      XFLD0073,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q14",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0074
          IF        !@EQUAL
            MOVE      XFLD0074,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q15",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0075
          IF        !@EQUAL
            MOVE      XFLD0075,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q16",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0076
          IF        !@EQUAL
            MOVE      XFLD0076,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q17",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0077
          IF        !@EQUAL
            MOVE      XFLD0077,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Learning Disabilities Q18",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0078
          IF        !@EQUAL
            MOVE      XFLD0078,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Secure Q1",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0079
          IF        !@EQUAL
            MOVE      XFLD0079,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Secure Q2",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0080
          IF        !@EQUAL
            MOVE      XFLD0080,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Secure Q3",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0081
          IF        !@EQUAL
            MOVE      XFLD0081,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Secure Q4",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0082
          IF        !@EQUAL
            MOVE      XFLD0082,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Secure Q5",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0083
          IF        !@EQUAL
            MOVE      XFLD0083,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Secure Q6",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0084
          IF        !@EQUAL
            MOVE      XFLD0084,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Secure Q7",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
. Field 85 85 85 85 85 85 85 85 
.
          MATCH     SP70,XFLD0085
          IF        !@EQUAL
            MOVE      XFLD0085,VINFIELD
            MOVE      3,VINTLEN
            MOVE      "HoNOS Version",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              MOVE      "hv",KEY2
              UNPACK    XFLD0085,KEY3
              PACK      KEY5,KEY2,KEY3,SP70
              CALL      RDCODE1
              IF        OVRCD=1
                MOVE      "Invalid HoNOS Version Code",VERRMSG
                CALL      PERR0000
              ELSE
                MATCH     "I",PTCOACTV
                IF        @EQUAL
                  MOVE      "HoNOS Version is Inactive",VERRMSG
                  CALL      PERR0000
                ELSE
                  MATCH     "H",TCINDC5
                  IF        !@EQUAL
                    MOVE      "Invalid HoNOS Version - Indicator 5",VERRMSG
                    CALL      PERR0000
                  ENDIF
                ENDIF
              ENDIF
            ENDIF
          ENDIF
.
          CALL      VLDQ3A00
.
VHONO087  MATCH     SP70,XFLD0087
          IF        !@EQUAL
            MOVE      XFLD0087,VINFIELD
            MOVE      8,VINTLEN
            MOVE      "Review Date",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      TEMPDATE,XFLD0087,SP70
              MOVE      "Review Date",VFLDNAME
              CALL      VDAT0000
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0088
          IF        !@EQUAL
            MOVE      XFLD0088,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              MATCH     "M",XFLD0088
              IF        !@EQUAL
                MATCH     "V",XFLD0088
                IF        !@EQUAL
                  MOVE      "ADOM must be M or V",VERRMSG
                  CALL      PERR0000
                ENDIF
              ENDIF 
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0089
          IF        !@EQUAL
            MOVE      XFLD0089,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Number of Days covered (7-28)",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              MOVE      0,F2
              MOVE      XFLD0089,DIM2
              STRIP     DIM2
              MOVE      DIM2,F2
              IF        F2 < 7 | F2 > 28
                PACK      VERRMSG,CINVALID,SP1,VFLDNAME
                MOVE      "Must be between 7 to 28",VERRDESC
                PACK      VERRMSG2,HYPHEN,SP1,VERRDESC
                CALL      PERR0000
                CALL      PERS0000
              ENDIF
            ENDIF 
          ENDIF
.
          MATCH     SP70,XFLD0090
          IF        !@EQUAL
            MOVE      XFLD0090,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Co-existing Problems",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              MATCH     "0",XFLD0090
              IF        !@EQUAL
                MATCH     "1",XFLD0090
                IF        !@EQUAL
                  MOVE      "ADOM Co-existing Problems must be 0 or 1",VERRMSG
                  CALL      PERR0000
                ENDIF
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0091
          IF        !@EQUAL
            MOVE      XFLD0091,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q1",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0092
          IF        !@EQUAL
            MOVE      XFLD0092,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q2",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0093
          IF        !@EQUAL
            MOVE      XFLD0093,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q3",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0094
          IF        !@EQUAL
            MOVE      XFLD0094,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q4",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0095
          IF        !@EQUAL
            MOVE      XFLD0095,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q5",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0096
          IF        !@EQUAL
            MOVE      XFLD0096,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q6",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0097
          IF        !@EQUAL
            MOVE      XFLD0097,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q7a",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0098
          IF        !@EQUAL
            MOVE      XFLD0098,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q7b",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0099
          IF        !@EQUAL
            MOVE      XFLD0099,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q7c",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0100
          IF        !@EQUAL
            MOVE      XFLD0100,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q7d",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0101
          IF        !@EQUAL
            MOVE      XFLD0101,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q7e",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0102
          IF        !@EQUAL
            MOVE      XFLD0102,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q7f",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0103
          IF        !@EQUAL
            MOVE      XFLD0103,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q8",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0104
          IF        !@EQUAL
            MOVE      XFLD0104,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "ADOM Q9a",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0105
          IF        !@EQUAL
            MOVE      XFLD0105,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "ADOM Q9b",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0106
          IF        !@EQUAL
            MOVE      XFLD0106,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "ADOM Q9c",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0107
          IF        !@EQUAL
            MOVE      XFLD0107,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q10",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0108
          IF        !@EQUAL
            MOVE      XFLD0108,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "ADOM Q11",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0109
          IF        !@EQUAL
            MOVE      XFLD0109,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q12",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0110
          IF        !@EQUAL
            MOVE      XFLD0110,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q13",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0111
          IF        !@EQUAL
            MOVE      XFLD0111,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q14",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0112
          IF        !@EQUAL
            MOVE      XFLD0112,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q15",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0113
          IF        !@EQUAL
            MOVE      XFLD0113,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q16",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0114
          IF        !@EQUAL
            MOVE      XFLD0114,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q17",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0115
          IF        !@EQUAL
            MOVE      XFLD0115,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q18",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0116
          IF        !@EQUAL
            MOVE      XFLD0116,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q19",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
          MATCH     SP70,XFLD0117
          IF        !@EQUAL
            MOVE      XFLD0117,VINFIELD
            MOVE      2,VINTLEN
            MOVE      "ADOM Q20",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
. Field 118
.
          MATCH     SP70,XFLD0118
          IF        @EQUAL | @EOS
            MOVE      "U/R Number is blank",VERRMSG
            CALL      PERR0000
          ELSE
            MOVE      XFLD0118,VINFIELD
            MOVE      8,VINTLEN
            MOVE      "U/R Number",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      KEY8,XFLD0118,SP70
              RJUSTIFY  KEY8 
              CALL      RDMAST1
              IF        OVRCD=1
                MOVE      "Invalid U/R Number - patma1af",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0119
          IF        !@EQUAL
            MOVE      XFLD0119,VINFIELD
            MOVE      1,VINTLEN
            MOVE      "Delete Flag",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              MATCH     "1",XFLD0119
              IF        !@EQUAL
                MOVE      "Delete Flag must be '1'",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0120
          IF        !@EQUAL
            MOVE      XFLD0120,VINFIELD
            MOVE      10,VINTLEN
            MOVE      "User who deleted assessment",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      KEY10,XFLD0120,SP70
              CALL      RDWBSE1
              IF        OVRCD=1
                MOVE      "Invalid User who deleted assessment - websecaf",VERRMSG
                CALL      PERR0000
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0121
          IF        !@EQUAL
            MOVE      XFLD0121,VINFIELD
            MOVE      8,VINTLEN
            MOVE      "Date assessment deleted",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      TEMPDATE,XFLD0121,SP70
              MOVE      "Date assessment deleted",VFLDNAME
              CALL      VDAT0000
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0122
          IF        !@EQUAL
            MOVE      XFLD0122,VINFIELD
            MOVE      8,VINTLEN
            MOVE      "Time assessment deleted",VFLDNAME
            CALL      CCHLEN00
            IF        VERRFLAG = 0
              PACK      TEMPTIME,XFLD0122,SP70
              MOVE      "Time assessment deleted",VFLDNAME
              CALL      VTIM0000
            ENDIF
          ENDIF
.
          MATCH     SP70,XFLD0123
          IF        !@EQUAL
            MOVE      XFLD0123,VINFIELD
            MOVE      3,VINTLEN
            MOVE      "Reason for delete",VFLDNAME
            CALL      CCHLEN00
          ENDIF
.
.
VHONO999  RETURN
.
.-------------------------------------------------------------------------------
. Validate HONOS Type
.-------------------------------------------------------------------------------
VHONTY00  MATCH     SP70,XFLD0003
          IF        @EQUAL
            MOVE      "HoNOS Type is blank",VERRMSG
            CALL      PERR0000
            GOTO      VHONTY99
          ENDIF
.
          MOVE      XFLD0003,VINFIELD
          MOVE      3,VINTLEN
          MOVE      "HoNOS Type",VFLDNAME
          CALL      CCHLEN00
          BRANCH    VERRFLAG,VHONTY99
.
          MOVE      "hs",KEY2
          UNPACK    XFLD0003,KEY3
          PACK      KEY5,KEY2,KEY3,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      "Invalid HoNOS Type Code",VERRMSG
            CALL      PERR0000
            GOTO      VHONTY99
          ENDIF
.
          MATCH     "I",PTCOACTV
          IF        @EQUAL
            MOVE      "HoNOS Type Code is Inactive",VERRMSG
            CALL      PERR0000
            GOTO      VHONTY99
          ENDIF
.
          MATCH     "C",TCINDC1
          GOTO      VHONTY99 IF EQUAL
.
          MATCH     "A",TCINDC1
          GOTO      VHONTY99 IF EQUAL
.
          MATCH     "O",TCINDC1
          GOTO      VHONTY99 IF EQUAL
.
          MATCH     "L",TCINDC1
          GOTO      VHONTY99 IF EQUAL
.
          MATCH     "M",TCINDC1
          GOTO      VHONTY99 IF EQUAL
.
          MATCH     "S",TCINDC1
          GOTO      VHONTY99 IF EQUAL
.
          MATCH     "I",TCINDC1
          GOTO      VHONTY99 IF EQUAL
.
          MOVE      "Invalid HoNOS Type - Indicator 1",VERRMSG
          CALL      PERR0000
.
VHONTY99  RETURN
.
.-------------------------------------------------------------------------------
. Validate Focus of Care
.-------------------------------------------------------------------------------
VFOCCA00  MATCH     SP70,XFLD0022
          IF        @EQUAL
            MOVE      "Focus of Care is blank",VERRMSG
            CALL      PERR0000
            GOTO      VFOCCA99
          ENDIF
.
          MOVE      XFLD0022,VINFIELD
          MOVE      3,VINTLEN
          MOVE      "Focus of Care",VFLDNAME
          CALL      CCHLEN00
          BRANCH    VERRFLAG,VFOCCA99
.
          MOVE      "hf",KEY2
          UNPACK    XFLD0022,KEY3
          PACK      KEY5,KEY2,KEY3,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      "Invalid Focus of Care Code",VERRMSG
            CALL      PERR0000
            GOTO      VFOCCA99
          ENDIF
.
          MATCH     "I",PTCOACTV
          IF        @EQUAL
            MOVE      "Focus of Care Code is Inactive",VERRMSG
            CALL      PERR0000
            GOTO      VFOCCA99
          ENDIF
.
          MATCH     "01",THCSCOD
          GOTO      VFOCCA99 IF EQUAL
.
          MATCH     "02",THCSCOD
          GOTO      VFOCCA99 IF EQUAL
.
          MATCH     "03",THCSCOD
          GOTO      VFOCCA99 IF EQUAL
.
          MATCH     "04",THCSCOD
          GOTO      VFOCCA99 IF EQUAL
.
          MATCH     "05",THCSCOD
          GOTO      VFOCCA99 IF EQUAL
.
          MATCH     "08",THCSCOD
          GOTO      VFOCCA99 IF EQUAL
.
          MATCH     "09",THCSCOD
          GOTO      VFOCCA99 IF EQUAL
.
          MOVE      "Invalid Focus of Care - HDP",VERRMSG
          CALL      PERR0000
.
VFOCCA99  RETURN
.
.-------------------------------------------------------------------------------
. Validate Cultural Support
.-------------------------------------------------------------------------------
VCULSP00  MATCH     SP70,XFLD0023
          GOTO      VCULSP99 IF EQUAL
.
          MOVE      XFLD0023,VINFIELD
          MOVE      3,VINTLEN
          MOVE      "Cultural Support",VFLDNAME
          CALL      CCHLEN00
          BRANCH    VERRFLAG,VCULSP99
.
          MOVE      "hc",KEY2
          UNPACK    XFLD0023,KEY3
          PACK      KEY5,KEY2,KEY3,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      "Invalid Cultural Support Code",VERRMSG
            CALL      PERR0000
            GOTO      VCULSP99
          ENDIF
.
          MATCH     "I",PTCOACTV
          IF        @EQUAL
            MOVE      "Cultural Support Code is Inactive",VERRMSG
            CALL      PERR0000
            GOTO      VCULSP99
          ENDIF
.
          MATCH     "01",THCSCOD
          GOTO      VCULSP99 IF EQUAL
.
          MATCH     "02",THCSCOD
          GOTO      VCULSP99 IF EQUAL
.
          MATCH     "03",THCSCOD
          GOTO      VCULSP99 IF EQUAL
.
          MATCH     "04",THCSCOD
          GOTO      VCULSP99 IF EQUAL
.
          MATCH     "05",THCSCOD
          GOTO      VCULSP99 IF EQUAL
.
          MATCH     "06",THCSCOD
          GOTO      VCULSP99 IF EQUAL
.
          MATCH     "09",THCSCOD
          GOTO      VCULSP99 IF EQUAL
.
          MOVE      "Invalid Cultural Support - HDP",VERRMSG
          CALL      PERR0000
.
VCULSP99  RETURN
.
.-------------------------------------------------------------------------------
. Validate Collection Status
.-------------------------------------------------------------------------------
VCOLST00  MATCH     SP70,XFLD0029
          GOTO      VCOLST99 IF EQUAL
.
          MOVE      XFLD0029,VINFIELD
          MOVE      3,VINTLEN
          MOVE      "Collection Status",VFLDNAME
          CALL      CCHLEN00
          BRANCH    VERRFLAG,VCOLST99
.
          MOVE      "ht",KEY2
          UNPACK    XFLD0029,KEY3
          PACK      KEY5,KEY2,KEY3,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      "Invalid Collection Status Code",VERRMSG
            CALL      PERR0000
            GOTO      VCOLST99
          ENDIF
.
          MATCH     "I",PTCOACTV
          IF        @EQUAL
            MOVE      "Collection Status Code is Inactive",VERRMSG
            CALL      PERR0000
            GOTO      VCOLST99
          ENDIF
.
          MATCH     "01",THCSCOD
          GOTO      VCOLST99 IF EQUAL
.
          MATCH     "02",THCSCOD
          GOTO      VCOLST99 IF EQUAL
.
          MATCH     "03",THCSCOD
          GOTO      VCOLST99 IF EQUAL
.
          MATCH     "04",THCSCOD
          GOTO      VCOLST99 IF EQUAL
.
          MATCH     "07",THCSCOD
          GOTO      VCOLST99 IF EQUAL
.
          MATCH     "09",THCSCOD
          GOTO      VCOLST99 IF EQUAL
.
          MOVE      "Invalid Collection Status - HDP",VERRMSG
          CALL      PERR0000
.
VCOLST99  RETURN
.
.-------------------------------------------------------------------------------
. Validate Mode of Administration
.-------------------------------------------------------------------------------
VMODAD00  MATCH     SP70,XFLD0030
          GOTO      VMODAD99 IF EQUAL
.
          MOVE      XFLD0030,VINFIELD
          MOVE      3,VINTLEN
          MOVE      "Mode of Administration",VFLDNAME
          CALL      CCHLEN00
          BRANCH    VERRFLAG,VMODAD99
.
          MOVE      "hm",KEY2
          UNPACK    XFLD0030,KEY3
          PACK      KEY5,KEY2,KEY3,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      "Invalid Mode of Administration Code",VERRMSG
            CALL      PERR0000
            GOTO      VMODAD99
          ENDIF
.
          MATCH     "I",PTCOACTV
          IF        @EQUAL
            MOVE      "Mode of Administration Code is Inactive",VERRMSG
            CALL      PERR0000
            GOTO      VMODAD99
          ENDIF
.
          MATCH     "01",THCSCOD
          GOTO      VMODAD99 IF EQUAL
.
          MATCH     "02",THCSCOD
          GOTO      VMODAD99 IF EQUAL
.
          MATCH     "03",THCSCOD
          GOTO      VMODAD99 IF EQUAL
.
          MATCH     "04",THCSCOD
          GOTO      VMODAD99 IF EQUAL
.
          MATCH     "05",THCSCOD
          GOTO      VMODAD99 IF EQUAL
.
          MATCH     "06",THCSCOD
          GOTO      VMODAD99 IF EQUAL
.
          MATCH     "07",THCSCOD
          GOTO      VMODAD99 IF EQUAL
.
          MATCH     "09",THCSCOD
          GOTO      VMODAD99 IF EQUAL
.
          MOVE      "Invalid Mode of Administration - HDP",VERRMSG
          CALL      PERR0000
.
VMODAD99  RETURN
.
.-------------------------------------------------------------------------------
. Validate LD Question 3A
.-------------------------------------------------------------------------------
VLDQ3A00  MATCH     SP70,XFLD0086
          GOTO      VLDQ3A99 IF EQUAL
.
          MOVE      XFLD0086,VINFIELD
          MOVE      3,VINTLEN
          MOVE      "LD Question 3A",VFLDNAME
          CALL      CCHLEN00
          BRANCH    VERRFLAG,VLDQ3A99
.
          MOVE      "hl",KEY2
          UNPACK    XFLD0086,KEY3
          PACK      KEY5,KEY2,KEY3,SP70
          CALL      RDCODE1
          IF        OVRCD=1
            MOVE      "Invalid LD Question 3A Code",VERRMSG
            CALL      PERR0000
            GOTO      VLDQ3A99
          ENDIF
.
          MATCH     "I",PTCOACTV
          IF        @EQUAL
            MOVE      "LD Question 3A Code is Inactive",VERRMSG
            CALL      PERR0000
            GOTO      VLDQ3A99
          ENDIF
.
          MATCH     "A",THCSCOD
          GOTO      VLDQ3A99 IF EQUAL
.
          MATCH     "B",THCSCOD
          GOTO      VLDQ3A99 IF EQUAL
.
          MATCH     "C",THCSCOD
          GOTO      VLDQ3A99 IF EQUAL
.
          MATCH     "D",THCSCOD
          GOTO      VLDQ3A99 IF EQUAL
.
          MATCH     "E",THCSCOD
          GOTO      VLDQ3A99 IF EQUAL
.
          MATCH     "X",THCSCOD
          GOTO      VLDQ3A99 IF EQUAL
.
          MATCH     "Z",THCSCOD
          GOTO      VLDQ3A99 IF EQUAL
.
          MOVE      "Invalid LD Question 3A - HDP",VERRMSG
          CALL      PERR0000
.
VLDQ3A99  RETURN
.
.-------------------------------------------------------------------------------
. Write out error message(s) 
.-------------------------------------------------------------------------------
NERR0000  MOVE      ONE,VERRFLAG
          STRIP     VFLDNAME
          STRIP     VERRDESC
.
          BRANCH    COPTION,NERR1000
          GOTO      NERR9999
.
NERR1000  PACK      DIM100,CINVALID,SP1,VFLDNAME,SP1,HYPHEN,SP1,VERRDESC,SP70
          STRIP     DIM100
          MOVELPTR  DIM100,F3
          IF        F3 > 70
            PACK      VERRMSG,CINVALID,SP1,VFLDNAME
            PACK      VERRMSG2,HYPHEN,SP1,VERRDESC
            CALL      PERR0000 
            CALL      PERS0000 
          ELSE
            MOVE      DIM100,VERRMSG
            MOVE      SP70,VERRMSG2
            CALL      PERR0000
          ENDIF
.
NERR9999  RETURN
+
.-----------------------------------------------------------------------------
. Print error line
.-----------------------------------------------------------------------------
PERR0000  ADD       ONE,ERRCOUNT            . Total error count
          MOVE      ONE,ERORFLAG
.
          BRANCH    COPTION,PERR1000
          GOTO      PERR9999
.
PERR1000  PRINT     *1,"| ",*3,LINECNTR,*12,"|",*14,XHONVISN,*23,"|":
                    *26,XHONURNO,*36,"|",*39,XHONHDAT,*48,"|":
                    *50,VERRMSG,*132,"|"
          GOTO      PERR9999
.
PERR9999  RETURN
+
.-----------------------------------------------------------------------------
. Print 2nd error line
.-----------------------------------------------------------------------------
PERS0000  BRANCH    COPTION,PERS1000
          GOTO      PERS99999
.
PERS1000  PRINT     *1,"| ",*48,"|":
                    *50,VERRMSG2,*132,"|"
          GOTO      PERS9999
.
PERS9999  RETURN
+
.-----------------------------------------------------------------------------
. Pack upload fields with spaces
.-----------------------------------------------------------------------------
PFLD0000  BRANCH    COPTION,PFLD1000
          GOTO      PFLD9999
.
PFLD1000  PACK      XFLD0001,XFLD0001,SP70
          PACK      XFLD0002,XFLD0002,SP70
          PACK      XFLD0003,XFLD0003,SP70
          PACK      XFLD0004,XFLD0004,SP70
          PACK      XFLD0005,XFLD0005,SP70
          PACK      XFLD0006,XFLD0006,SP70
          PACK      XFLD0007,XFLD0007,SP70
          PACK      XFLD0008,XFLD0008,SP70
          PACK      XFLD0009,XFLD0009,SP70
          PACK      XFLD0010,XFLD0010,SP70
          PACK      XFLD0011,XFLD0011,SP70
          PACK      XFLD0012,XFLD0012,SP70
          PACK      XFLD0013,XFLD0013,SP70
          PACK      XFLD0014,XFLD0014,SP70
          PACK      XFLD0015,XFLD0015,SP70
          PACK      XFLD0016,XFLD0016,SP70
          PACK      XFLD0017,XFLD0017,SP70
          PACK      XFLD0018,XFLD0018,SP70
          PACK      XFLD0019,XFLD0019,SP70
          PACK      XFLD0020,XFLD0020,SP70
.
          PACK      XFLD0021,XFLD0021,SP70
          PACK      XFLD0022,XFLD0022,SP70
          PACK      XFLD0023,XFLD0023,SP70
          PACK      XFLD0024,XFLD0024,SP70
          PACK      XFLD0025,XFLD0025,SP70
          PACK      XFLD0026,XFLD0026,SP70
          PACK      XFLD0027,XFLD0027,SP70
          PACK      XFLD0028,XFLD0028,SP70
          PACK      XFLD0029,XFLD0029,SP70
          PACK      XFLD0030,XFLD0030,SP70
          PACK      XFLD0031,XFLD0031,SP70
          PACK      XFLD0032,XFLD0032,SP70
          PACK      XFLD0033,XFLD0033,SP70
          PACK      XFLD0034,XFLD0034,SP70
          PACK      XFLD0035,XFLD0035,SP70
          PACK      XFLD0036,XFLD0036,SP70
          PACK      XFLD0037,XFLD0037,SP70
          PACK      XFLD0038,XFLD0038,SP70
          PACK      XFLD0039,XFLD0039,SP70
          PACK      YFLD0001,YFLD0001,SP70
.
          PACK      XFLD0041,XFLD0041,SP70
          PACK      XFLD0042,XFLD0042,SP70
          PACK      XFLD0043,XFLD0043,SP70
          PACK      XFLD0044,XFLD0044,SP70
          PACK      XFLD0045,XFLD0045,SP70
          PACK      XFLD0046,XFLD0046,SP70
          PACK      XFLD0047,XFLD0047,SP70
          PACK      XFLD0048,XFLD0048,SP70
          PACK      XFLD0049,XFLD0049,SP70
          PACK      XFLD0050,XFLD0050,SP70
          PACK      XFLD0051,XFLD0051,SP70
          PACK      XFLD0052,XFLD0052,SP70
          PACK      XFLD0053,XFLD0053,SP70
          PACK      XFLD0054,XFLD0054,SP70
          PACK      XFLD0055,XFLD0055,SP70
          PACK      XFLD0056,XFLD0056,SP70
          PACK      XFLD0057,XFLD0057,SP70
          PACK      XFLD0058,XFLD0058,SP70
          PACK      XFLD0059,XFLD0059,SP70
          PACK      XFLD0060,XFLD0060,SP70
.
          PACK      XFLD0061,XFLD0061,SP70
          PACK      XFLD0062,XFLD0062,SP70
          PACK      XFLD0063,XFLD0063,SP70
          PACK      XFLD0064,XFLD0064,SP70
          PACK      XFLD0065,XFLD0065,SP70
          PACK      XFLD0066,XFLD0066,SP70
          PACK      XFLD0067,XFLD0067,SP70
          PACK      XFLD0068,XFLD0068,SP70
          PACK      XFLD0069,XFLD0069,SP70
          PACK      XFLD0070,XFLD0070,SP70
          PACK      XFLD0071,XFLD0071,SP70
          PACK      XFLD0072,XFLD0072,SP70
          PACK      XFLD0073,XFLD0073,SP70
          PACK      XFLD0074,XFLD0074,SP70
          PACK      XFLD0075,XFLD0075,SP70
          PACK      XFLD0076,XFLD0076,SP70
          PACK      XFLD0077,XFLD0077,SP70
          PACK      XFLD0078,XFLD0078,SP70
          PACK      XFLD0079,XFLD0079,SP70
          PACK      XFLD0080,XFLD0080,SP70
.
          PACK      XFLD0081,XFLD0081,SP70
          PACK      XFLD0082,XFLD0082,SP70
          PACK      XFLD0083,XFLD0083,SP70
          PACK      XFLD0084,XFLD0084,SP70
          PACK      XFLD0085,XFLD0085,SP70
          PACK      XFLD0086,XFLD0086,SP70
          PACK      XFLD0087,XFLD0087,SP70
          PACK      XFLD0088,XFLD0088,SP70
          PACK      XFLD0089,XFLD0089,SP70
          PACK      XFLD0090,XFLD0090,SP70
          PACK      XFLD0091,XFLD0091,SP70
          PACK      XFLD0092,XFLD0092,SP70
          PACK      XFLD0093,XFLD0093,SP70
          PACK      XFLD0094,XFLD0094,SP70
          PACK      XFLD0095,XFLD0095,SP70
          PACK      XFLD0096,XFLD0096,SP70
          PACK      XFLD0097,XFLD0097,SP70
          PACK      XFLD0098,XFLD0098,SP70
          PACK      XFLD0099,XFLD0099,SP70
          PACK      XFLD0100,XFLD0100,SP70
.
          PACK      XFLD0101,XFLD0101,SP70
          PACK      XFLD0102,XFLD0102,SP70
          PACK      XFLD0103,XFLD0103,SP70
          PACK      XFLD0104,XFLD0104,SP70
          PACK      XFLD0105,XFLD0105,SP70
          PACK      XFLD0106,XFLD0106,SP70
          PACK      XFLD0107,XFLD0107,SP70
          PACK      XFLD0108,XFLD0108,SP70
          PACK      XFLD0109,XFLD0109,SP70
          PACK      XFLD0110,XFLD0110,SP70
          PACK      XFLD0111,XFLD0111,SP70
          PACK      XFLD0112,XFLD0112,SP70
          PACK      XFLD0113,XFLD0113,SP70
          PACK      XFLD0114,XFLD0114,SP70
          PACK      XFLD0115,XFLD0115,SP70
          PACK      XFLD0116,XFLD0116,SP70
          PACK      XFLD0117,XFLD0117,SP70
          PACK      XFLD0118,XFLD0118,SP70
          PACK      XFLD0119,XFLD0119,SP70
          PACK      XFLD0120,XFLD0120,SP70
.
          PACK      XFLD0121,XFLD0121,SP70
          PACK      XFLD0122,XFLD0122,SP70
          PACK      XFLD0123,XFLD0123,SP70
.
PFLD9999  RETURN
+
.-----------------------------------------------------------------------------
. Clear total variables
.-----------------------------------------------------------------------------
CTOT0000  MOVE      ZERO,ERRCOUNT
          MOVE      ZERO,ADDCOUNT
          MOVE      ZERO,UPDCOUNT
.
CTOT999   RETURN
+
.-----------------------------------------------------------------------------
. Print total lines
.-----------------------------------------------------------------------------
PTOT0000  CALL      UND132
.
          PRINT     *1,"| Total Records Read    : ",LINECNTR,*132,"|"
          PRINT     *1,"| Total Records Added   : ",ADDCOUNT,*132,"|"
          PRINT     *1,"| Total Records Updated : ",UPDCOUNT,*132,"|"
          PRINT     *1,"| Total Errors Found    : ",ERRCOUNT,*132,"|"
.
          CALL      UND132
.
PTOT9999  RETURN
.
.-----------------------------------------------------------------------------
.
          INC       STD001IO
.
          INC       CLMEHHON
          INC       UPLVALDS
.
          INC       PATCODIO/INC
          INC       PATMA1IO/INC           
          INC       PATVISIO/INC           
          INC       PMSHCPIO/INC           
          INC       ALLCASIO/INC           
          INC       MEHHONIO/INC           
          INC       WEBSECIO/INC           
