.******************************************************************************
.* System    :   Accounting System                                            *
.* Program   :   IBASCS03                                                     *
.* Desc      :   Help  Routine Generation                                     *
.******************************************************************************
.* Date      :   23.04.91                                                     *
.* Author    :   B.G.Ackland (IBA)                                            *
.*                                                                            *
.* Mods      :                                                                *
.*                                                                            *
.* V10.12.01  12/02/2018 Ania P              TSK 0261630                      *
.*            Removed PORT                                                    *
.* V10.03.01  22/02/2013 Ania Pietrusewicz   CAR281434                        *
.*            Removed unnecessary modifications of constants.                 *
.******************************************************************************
.*  C2.00.01  09.09.1999 Sandra Barcham                                       *
.*            Change ITEMNO to XITEMNO for PATITMFD                           *
.******************************************************************************
.
          INC       STDGENDF
.
.==============================================================================
.FILE DESCRIPTION INCLUDES
.-------------------------
          INC       SYSSCFFD/INC
          INC       SYSFILFD/INC
          INC       SYSIDXFD/INC
          INC       SYSFLDFD/INC
          INC       SYSHVRFD/INC
          INC       SCRFMAFD/INC
          INC       IBASEQFD/INC
          INC       TFILEVAR/INC
          INC       WEBERRFD/INC
.
.==============================================================================
.LOCAL VARIABLE DEFINITION
.-------------------------
FSTHID     DIM       5
LSTHID     DIM       5
.
ACCEPT     FORM      1                  * accept mode (1=on)
CNUMOPT    FORM      2
PRNAME     DIM       12
TBSPOOL    INIT      "$TBSPOOL/"
FILENAME   DIM       8
COMMAND    DIM       80
TEMPFILE   FILE      ASCII,  FIXED=80
RM         INIT      "rm "
ED         INIT      "ed "
INPUT      INIT      " < "
CAT        INIT      "cat "
OUTPUT     INIT      " >> "
KYNAME     DIM       12
PBL        INIT      ".PBL"
PRT        INIT      ".prt"
TXT        INIT      ".txt"
KY         INIT      "KY"
VI         INIT      "vi "
.
OPT        DIM       10
OPT0       INIT      "Exit      "
OPT1       INIT      "Insert    "
OPT2       INIT      "Modify    "
OPT3       INIT      "Delete    "
OPT4       INIT      "Gen Code  "
OPT5       INIT      "Vi Code   "
OPT6       INIT      "Range     "
.
DTYPE      DIM       4
DTYPE0     INIT      "DIM "
DTYPE1     INIT      "FORM"
.
KTYPNAM    DIM       10
KTYPNAM0   INIT      "Normal  "
KTYPNAM1   INIT      "*JR     "
KTYPNAM2   INIT      "*JR,*ZF "
.
. Variables for Help Routine Code
.---------------------------------
S15       INIT      "15"
S90       INIT      "90"
S85       INIT      "85"
S37       INIT      "37"
S47       INIT      "47"
PACKKEY   DIM       80    * Validation Pack Key
PACSP70   DIM       80    * Validation Pack Key
PACKCHK   DIM       80    * Validation Pack Key
PACKZZZ   DIM       80    * Validation Pack Key
UNPKCHK   DIM       80    * Validation Pack Key
PSETLEN   DIM       80    * Validation Pack Key
PSTDCOL   DIM       8
LPSTDCOL  DIM       8
PPMATFLD  INIT      "          MATCH     SP70,"
PPMATKEY  INIT      "          MATCH     SAVKEY80,"
PSAVKEY   INIT      ",SAVKEY80,Z70"
PZ70      INIT      ",Z70"
PSP70     INIT      ",SP70"
PMATFLD   DIM       80
PMATKEY   DIM       80
PMATGOT1  DIM       80
PMATGOT2  DIM       80
PMATGOT3  DIM       80
PMATGOT4  DIM       80
PMATGOT5  DIM       80
PMATGOT6  DIM       80
PPSTDCOL  INIT      "STDCOL"
SETLEN    FORM      4
UNPACKKY  DIM       80
UNPACK    INIT      "          UNPACK    KEY"
PPSETLEN  INIT      "          SETLPTR   SAVKEY80,"
PPACKKEY  INIT      "          PACK      KEY"
PPACKCHK  INIT      "          PACK      SAVKEY80"
PUNPKCHK  INIT      "          UNPACK    SAVKEY80"
PBRANTYP  INIT      "          BRANCH    CKEYTYP,"
PBRANOV   INIT      "          BRANCH    OVRCD,"
PRETURN   INIT      "          RETURN"
PM0EXIT   INIT      "          MOVE      ZERO,EXIT"
PM1EXIT   INIT      "          MOVE      ONE,EXIT"
PM2EXIT   INIT      "          MOVE      TWO,EXIT"
UNDMV     INIT      "          MOVE      UNDLN70,"
PBLANK    INIT      "."
RACALLID  DIM       8
RDCALLID  DIM       8
RKCALLID  DIM       8
RSCALLID  DIM       8
RPCALLID  DIM       8
.
PGOTO     INIT      "          GOTO      "
PCALL     INIT      "          CALL      "
PIFEQU    INIT      " IF EQUAL"
PIFNOTEQ  INIT      " IF NOT EQUAL"
.
RA        INIT      "RA"
RS        INIT      "RS"
RK        INIT      "RK"
RP        INIT      "RP"
RDA       INIT      "RDA"
RDS       INIT      "RDS"
RDK       INIT      "RDK"
RDP       INIT      "RDP"
RD        INIT      "RD"
.
PLOAD1    INIT      "          LOAD      "
PLOAD2    INIT      ",CCITEM,ST1,ST2,ST3,ST4,ST5:"
PSTORE1   INIT      "          STORE     "
PSTORE2   INIT      ",XITEMNO,ST1,ST2,ST3,ST4,ST5:"
PSTORE3   INIT      "                                ST6,ST7,ST8,ST9,ST10:"
PSTORE4   INIT      "                                ST11,ST12,ST13,ST14,ST15:"
PSTORE5   INIT      "                                ST16,ST17"
PMOVE     INIT      "          MOVE      "
PQUOTE    INIT      "#""
HLABEL    DIM       6
KEYXX     DIM       5
DIM20     DIM       20
DIM80     DIM       80
COUNT     FORM      5
KEYLEN    FORM      4
SEGMENT   DIM       4
KEYFLD    DIM       8
DISFLD    DIM       8
ROUTINE   DIM       8
COLWIDTH  FORM      2
HELPFLD   DIM       8
.
PRGID     INIT      "IBASCS03"
PRGNAM    INIT      "Help Routine Maintenance"
VERSION   INIT      "V12.01.00"
.
.******************************************************************************
.*  MAINLINE - Controlling Logic                                              *
.******************************************************************************
ML0000    CALL      INIT0000           * display heading and open files
.
ML0100    CALL      NEWOPTN            * insert/modify/delete/exit ?
          COMPARE   ZERO,COPTION
          GOTO      ML9999 IF EQUAL    * exit program
          BRANCH    COPTION,ML0200,ML0200,ML0200,ML0200,ML0200,ML6000
.
ML0200    CALL      PROC0000           * get entry
          BRANCH    EXIT,ML0100,ML0100 * exit option
.
          LOAD      ACCEPT,COPTION,ONE,ZERO,ZERO * set up mode
          CALL      SCRA0000           * display screen A
.
          BRANCH    COPTION,ML1000,ML1000,ML2000,ML4000,ML5000
.
.---- add/modify data ----
.
ML1000    CALL      SELA0000           * modify screen A
          BRANCH    EXIT,ML0200        * don't save data
.
          CALL      POST0000           * post screen A data
          GOTO      ML0200             * get next entry
.
.---- delete data ----
.
ML2000    CALL      DELQST             * ok to delete (y/n/c) ?
          BRANCH    CEXIT,ML2100,ML0200,ML0100
.
ML2100    CALL      DELT0000           * delete screen A data
          GOTO      ML0200             * get next entry
.
ML4000    CALL      GENC0000           * Generate Keyin Code
          GOTO      ML0200
.
ML5000    CALL      VICD0000           * Vi Code
          GOTO      ML0200
.
ML6000    MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      RGEN0000
          CALL      PUTSCR00
          GOTO      ML0100
.
ML9999    CHAIN     PGM                * chain back to menu
.
.******************************************************************************
.* INIT - Open Files                             Called by ML0000             *
.******************************************************************************
INIT0000  CALL      DISPHEAD
.
          DISPLAY   *P50:24,"Opening sysscfa1";
          OPEN      SYSSCFA1,"sysscfaf"
          DISPLAY   *P58:24,"sysfila1";
          OPEN      SYSFILA1,"sysfilaf"
          DISPLAY   *P58:24,"sysfila2"; 
          OPEN      SYSFILA2,"sysfilaf"
          DISPLAY   *P58:24,"sysflda1";
          OPEN      SYSFLDA1,"sysfldaf"
          DISPLAY   *P58:24,"sysflda2"; 
          OPEN      SYSFLDA2,"sysfldaf"
          DISPLAY   *P58:24,"sysidxa1";
          OPEN      SYSIDXA1,"sysidxaf"
          DISPLAY   *P58:24,"syshvra1";
          OPEN      SYSHVRA1,"syshvraf"
          DISPLAY   *P58:24,"scrfmaa1";
          OPEN      SCRFMAA1,"scrfmaaf"
.
          CALL      TFILENAM
          MOVE      TFILNAME,FILENAME
.
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.******************************************************************************
.* SCRA - Display Screen A                       Called by SELA0000, redisps  *
.*       Requires : ACCEPT   (1=accept mode)                                  *
.******************************************************************************
SCRA0000  DISPLAY   *P1:4,*EF:
                    *P1:4,"    System               : ":
                    *V2LON,SYSCSYS,*HOFF,SP1,SYSCDES:
                    *P1:5,"    File                 : ":
                    *V2LON,SYFIFIL,*HOFF,SP1,SYFIDES:
                    *P1:6,"    Routine ID           : ",*V2LON,SYHVHID:
                    *P1:8," 1",*HOFF,". Description          : ",*V2LON:
                    *P1:9," 2",*HOFF,". Key Field            : ",*V2LON:
                    *P1:10," 3",*HOFF,". Index                : ",*V2LON:
                    *P1:11," 4",*HOFF,". Default Top/Left     : ",*V2LON:
                    *P1:12," 5",*HOFF,".         Bottom/Right : ",*V2LON:
                    *P40:11," 6",*HOFF,". Call Before Display  : ",*V2LON:
                    *P5:13,*V2LON,*ULON,"Column Heading":
                    *P26:13,"Field":
                    *P34:13,"Width":
                    *P45:13,"External Call",*HOFF:
                    *P1:14,*V2LON," 7",*HOFF,".":
                    *P1:15,*V2LON," 8",*HOFF,".":
                    *P1:16,*V2LON," 9",*HOFF,".":
                    *P1:17,*V2LON,"10",*HOFF,".":
                    *P1:18,*V2LON,"11",*HOFF,".":
                    *P1:19,*V2LON,"12",*HOFF,".":
                    *P1:20,*V2LON,"13",*HOFF,".":
                    *P1:21,*V2LON,"14",*HOFF,".":
                    *P1:22,*V2LON,"15",*HOFF,".":
                    *P1:23,*V2LON,"16",*HOFF,"."
.
          BRANCH    ACCEPT,SCRA9999    * accept mode
.
          PACK      KEY8,SYHVSYS,SYHVFIL,SYHVFLD
          CALL      RDSYFL2
          PACK      KEY5,SYHVSYS,SYHVFIL,SYHVIDX
          CALL      RDSYID1
          DISPLAY   *P28:8,*V2LON,SYHVDES:
                    *P28:9,*V2LON,SYHVFLD,*HOFF,SP1,SYFLDES:
                    *P28:10,*V2LON,SYHVIDX,*HOFF,SP1,SYIDDES:
                    *P28:11,*V2LON,SYHVDTOP,*HOFF,"/",*V2LON,SYHVDLEF:
                    *P68:11,*V2LON,SYHVCBF,*HOFF:
                    *P28:12,*V2LON,SYHVDBOT,*HOFF,"/",*V2LON,SYHVDRIG,*HOFF:
                     *P5:14,SYHVCH01,*P26:14,SYHVCF01,*P37:14,SYHVCW01:
                    *P45:14,SYHVER01:
                     *P5:15,SYHVCH02,*P26:15,SYHVCF02,*P37:15,SYHVCW02:
                    *P45:15,SYHVER02:
                     *P5:16,SYHVCH03,*P26:16,SYHVCF03,*P37:16,SYHVCW03:
                    *P45:16,SYHVER03:
                     *P5:17,SYHVCH04,*P26:17,SYHVCF04,*P37:17,SYHVCW04:
                    *P45:17,SYHVER04:
                     *P5:18,SYHVCH05,*P26:18,SYHVCF05,*P37:18,SYHVCW05:
                    *P45:18,SYHVER05:
                     *P5:19,SYHVCH06,*P26:19,SYHVCF06,*P37:19,SYHVCW06:
                    *P45:19,SYHVER06:
                     *P5:20,SYHVCH07,*P26:20,SYHVCF07,*P37:20,SYHVCW07:
                    *P45:20,SYHVER07:
                     *P5:21,SYHVCH08,*P26:21,SYHVCF08,*P37:21,SYHVCW08:
                    *P45:21,SYHVER08:
                     *P5:22,SYHVCH09,*P26:22,SYHVCF09,*P37:22,SYHVCW09:
                    *P45:22,SYHVER09:
                     *P5:23,SYHVCH10,*P26:23,SYHVCF10,*P37:23,SYHVCW10:
                    *P45:23,SYHVER10 

SCRA9999  RETURN
.******************************************************************************
.* PROC - Enter Dissection Code                  Called by ML0000             *
.*        Returns : EXIT     (2=EXITCHAR entered, 1=nothing entered, 0=cont.) *
.*                  FMDSDISS (variable entered)                               *
.******************************************************************************
PROC0000  DISPLAY   *P1:4,"    System               : ",*EF:
                    *P1:5,"    File                 : ":
                    *P1:6,"    Routine ID           : " 
.
PROC1000  MOVE      "28",CCOL          * set up screen address
          MOVE      "4",CVERT
.
          CALL      KSYSCA00
          BRANCH    EXIT,PROC9999,PROC9999
          DISPLAY   *PCCOL:CVERT,*V2LON,SYSCSYS,*HOFF,SP1,SYSCDES
          MOVE      SYSCSYS,SYFISYS
          MOVE      SYSCSYS,SYHVSYS
.
PROC2000  MOVE      "5",CVERT
          MOVE      ZERO,CKEYTYP
          CALL      KSYFIA00
          BRANCH    EXIT,PROC0000,PROC9999
          DISPLAY   *PCCOL:CVERT,*V2LON,SYFIFIL,*HOFF,SP1,SYFIDES
          MOVE      SYFIFIL,SYHVFIL
.
          MOVE      "6",CVERT
.
          MOVE      ZERO,CKEYTYP
          COMPARE   ONE,COPTION        * insert mode ?
          GOTO      PROC3000 IF NOT EQUAL
          MOVE      ONE,CKEYTYP
.
PROC3000  CALL      KSYHVA00
.
          MOVE      ZERO,CKEYTYP
PROC9999  RETURN
.------------------------------------------------------------
. Vi Help Routine to Allow External Routines to be Modified
.------------------------------------------------------------
VICD0000
          GETSCR    1,1,1,80,24
          PACK      COMMAND,VI,SYSCID3,SYFIID3,KY,PBL
          EXECUTE   COMMAND,TASKID
          PUTSCR    1,1,1,80,24
          RETURN
.******************************************************************************
.* SELA - Modify screen A data                   Called by ML0000             *
.*        Returns : EXIT     (2=EXITCHAR entered, 1=nothing entered, 0=cont.) *
.*                  FMDSDISS (variable entered)                               *
.******************************************************************************
SELA0000  MOVE      ZERO,CCITEM
.
.---- determine option to execute ----
.
SELA0100  ADD       ONE,CCITEM                   * get next option
          BRANCH    ACCEPT,SELA0500              * in accept mode ?
          CALL      MAINQST                      * select/post/cancel ?
.
          COMPARE   ZERO,CCITEM
          GOTO      SELA9000 IF EQUAL            * post ?
.
          COMPARE   SEQ,CCITEM
          GOTO      SELA9500 IF EQUAL            * cancel ?
.
SELA0500  MOVE      "28",CCOL                    * set up screen address
          MOVE      "7",CVERT
          ADD       CCITEM,CVERT
          BRANCH    CCITEM,SELA1100,SELA1200,SELA1300,SELA1400,SELA1500:
                           SELA1600,SELA1700,SELA1800,SELA1900,SELA2000:
                           SELA2100,SELA2200,SELA2300,SELA2400,SELA2500:
                           SELA2600
.
          BRANCH    ACCEPT,SELA0900              * finished accept mode ?
          BEEP                                   * illegal option
.
SELA0900  MOVE      ZERO,ACCEPT                  * clear accept mode
          GOTO      SELA0100                     * get next option
.
.---- option 1 ----
.
SELA1100  KEYIN     *PCCOL:CVERT,*V2LON,SYHVDES
          PACK      SYHVDES,SYHVDES,SP70
.
          MATCH     SYHVDES,SP70
          GOTO      SELA1150 IF NOT EQUAL        * description spaces ?
          PACK      SYHVDES,SYHVDES,UNDLN70
.
SELA1150  MATCH     SYHVDES,UNDLN70
          GOTO      SELA1190 IF EQUAL            * nothing entered ?
          GOTO      SELA0100
.
SELA1190  DISPLAY   *P1:24,*EL,*B:               * nothing entered
                    "A Description Must Be Entered - ";
          CALL      HITENTER
          GOTO      SELA1100
.
SELA1200  MOVE      SYFISYS,SYFLSYS
          MOVE      SYFIFIL,SYFLFIL
          CALL      KSYFLA00
          BRANCH    EXIT,SELA1250,SELA9500
          MOVE      SYFLFLD,SYHVFLD
.
          DISPLAY   *PCCOL:CVERT,*V2LON,SYHVFLD,*HOFF,SP1,SYFLDES
          GOTO      SELA0100
.
SELA1250  MOVE      SP70,SYHVFLD
          MOVE      "Full Key Returned",SYFLDES
          DISPLAY   *PCCOL:CVERT,*V2LON,SYHVFLD,*HOFF,SP1,SYFLDES
          GOTO      SELA0100
.
SELA1300  
          MOVE      SYFISYS,SYIDSYS
          MOVE      SYFIFIL,SYIDFIL
          CALL      KSYIDA00
          BRANCH    EXIT,SELA1300,SELA9500
          MOVE      SYIDIDX,SYHVIDX
          DISPLAY   *PCCOL:CVERT,*V2LON,SYHVIDX,*HOFF,SP1,SYIDDES
          GOTO      SELA0100
.
SELA1400  KEYIN     *PCCOL:CVERT,*V2LON,*JR,*ZF,*DE,SYHVDTOP,*HOFF,"/",*V2LON:
                                        *JR,*ZF,*DE,SYHVDLEF    
          DISPLAY   *PCCOL:CVERT,*V2LON,SYHVDTOP,*HOFF,"/",*V2LON,SYHVDLEF    
          MATCH     "00",SYHVDTOP
          GOTO      SELA1400 IF EQUAL
          MATCH     "00",SYHVDLEF
          GOTO      SELA1400 IF EQUAL
          GOTO      SELA0100
.
SELA1500  KEYIN     *PCCOL:CVERT,*V2LON,*JR,*ZF,*DE,SYHVDBOT,*HOFF,"/",*V2LON:
                                        *JR,*ZF,*DE,SYHVDRIG    
          DISPLAY   *PCCOL:CVERT,*V2LON,SYHVDBOT,*HOFF,"/",*V2LON,SYHVDRIG    
          MATCH     "00",SYHVDBOT
          GOTO      SELA1500 IF EQUAL
          MATCH     "00",SYHVDRIG
          GOTO      SELA1500 IF EQUAL
          GOTO      SELA0100
.
SELA1600  SUB       TWO,CVERT
          ADD       "40",CCOL
          KEYIN     *PCCOL:CVERT,*V2LON,"________":
                    *PCCOL:CVERT,*V2LON,SYHVCBF:
                    *PCCOL:CVERT,*DV,SYHVCBF
          ADD       TWO,CVERT
          SUB       "40",CCOL
          GOTO      SELA0100
.
SELA1700  
          KEYIN     *P5:CVERT,*V2LON,SYHVCH01;
          DISPLAY   *P5:CVERT,SYHVCH01;
          RESET     SYHVCH01
          GOTO      SELA0900 IF EOS
          MOVE      "26",CCOL
          MOVE      "2",CKEYTYP
          CALL      KSYFLB00
          MOVE      "0",CKEYTYP
          BRANCH    EXIT,SELA1700,SELA1700
          MOVE      KEY8,SYHVCF01
.
          KEYIN     *P37:CVERT,SYHVCW01,*P45:CVERT,SYHVER01 
          DISPLAY   *P26:CVERT,SYHVCF01:
                    *P37:CVERT,SYHVCW01,*P45:CVERT,SYHVER01 
          GOTO      SELA0100
.
SELA1800 
          KEYIN     *P5:CVERT,*V2LON,SYHVCH02;
          DISPLAY   *P5:CVERT,SYHVCH02;
          RESET     SYHVCH02
          GOTO      SELA0900 IF EOS
          MOVE      "26",CCOL
          MOVE      "2",CKEYTYP
          CALL      KSYFLB00
          MOVE      "0",CKEYTYP
          BRANCH    EXIT,SELA1700,SELA1700
          MOVE      KEY8,SYHVCF02
.
          KEYIN     *P37:CVERT,SYHVCW02,*P45:CVERT,SYHVER02 
          DISPLAY   *P26:CVERT,SYHVCF02:
                    *P37:CVERT,SYHVCW02,*P45:CVERT,SYHVER02 
          GOTO      SELA0100
.
SELA1900
          KEYIN     *P5:CVERT,*V2LON,SYHVCH03;
          DISPLAY   *P5:CVERT,SYHVCH03;
          RESET     SYHVCH03
          GOTO      SELA0900 IF EOS
          MOVE      "26",CCOL
          MOVE      "2",CKEYTYP
          CALL      KSYFLB00
          MOVE      "0",CKEYTYP
          BRANCH    EXIT,SELA1700,SELA1700
          MOVE      KEY8,SYHVCF03
.
          KEYIN     *P37:CVERT,SYHVCW03,*P45:CVERT,SYHVER03 
          DISPLAY   *P26:CVERT,SYHVCF03:
                          *P37:CVERT,SYHVCW03,*P45:CVERT,SYHVER03 
          GOTO      SELA0100
.
SELA2000  
          KEYIN     *P5:CVERT,*V2LON,SYHVCH04;
          DISPLAY   *P5:CVERT,SYHVCH04;
          RESET     SYHVCH04
          GOTO      SELA0900 IF EOS
          MOVE      "26",CCOL
          MOVE      "2",CKEYTYP
          CALL      KSYFLB00
          MOVE      "0",CKEYTYP
          BRANCH    EXIT,SELA1700,SELA1700
          MOVE      KEY8,SYHVCF04
.
          KEYIN     *P37:CVERT,SYHVCW04,*P45:CVERT,SYHVER04 
          DISPLAY   *P26:CVERT,SYHVCF04:
                          *P37:CVERT,SYHVCW04,*P45:CVERT,SYHVER04 
          GOTO      SELA0100
.
SELA2100 
          KEYIN     *P5:CVERT,*V2LON,SYHVCH05;
          DISPLAY   *P5:CVERT,SYHVCH05;
          RESET     SYHVCH05
          GOTO      SELA0900 IF EOS
          MOVE      "26",CCOL
          MOVE      "2",CKEYTYP
          CALL      KSYFLB00
          MOVE      "0",CKEYTYP
          BRANCH    EXIT,SELA1700,SELA1700
          MOVE      KEY8,SYHVCF05
.
          KEYIN     *P37:CVERT,SYHVCW05,*P45:CVERT,SYHVER05 
          DISPLAY   *P26:CVERT,SYHVCF05:
                          *P37:CVERT,SYHVCW05,*P45:CVERT,SYHVER05 
          SUB       ONE,CVERT
          GOTO      SELA0100
.
SELA2200  
          KEYIN     *P5:CVERT,*V2LON,SYHVCH06;
          DISPLAY   *P5:CVERT,SYHVCH06;
          RESET     SYHVCH06
          GOTO      SELA0900 IF EOS
          MOVE      "26",CCOL
          MOVE      "2",CKEYTYP
          CALL      KSYFLB00
          MOVE      "0",CKEYTYP
          BRANCH    EXIT,SELA1700,SELA1700
          MOVE      KEY8,SYHVCF06
.
          KEYIN     *P37:CVERT,SYHVCW06,*P45:CVERT,SYHVER06 
          DISPLAY   *P26:CVERT,SYHVCF06:
                          *P37:CVERT,SYHVCW06,*P45:CVERT,SYHVER06 
          GOTO      SELA0100
.
SELA2300  
          KEYIN     *P5:CVERT,*V2LON,SYHVCH07;
          DISPLAY   *P5:CVERT,SYHVCH07;
          RESET     SYHVCH07
          GOTO      SELA0900 IF EOS
          MOVE      "26",CCOL
          MOVE      "2",CKEYTYP
          CALL      KSYFLB00
          MOVE      "0",CKEYTYP
          BRANCH    EXIT,SELA1700,SELA1700
          MOVE      KEY8,SYHVCF07
.
          KEYIN     *P37:CVERT,SYHVCW07,*P45:CVERT,SYHVER07 
          DISPLAY   *P26:CVERT,SYHVCF07:
                          *P37:CVERT,SYHVCW07,*P45:CVERT,SYHVER07 
          GOTO      SELA0100
.
SELA2400  
          KEYIN     *P5:CVERT,*V2LON,SYHVCH08;
          DISPLAY   *P5:CVERT,SYHVCH08;
          RESET     SYHVCH08
          GOTO      SELA0900 IF EOS
          MOVE      "26",CCOL
          MOVE      "2",CKEYTYP
          CALL      KSYFLB00
          MOVE      "0",CKEYTYP
          BRANCH    EXIT,SELA1700,SELA1700
          MOVE      KEY8,SYHVCF08
.
          KEYIN     *P37:CVERT,SYHVCW08,*P45:CVERT,SYHVER08 
          DISPLAY   *P26:CVERT,SYHVCF08:
                          *P37:CVERT,SYHVCW08,*P45:CVERT,SYHVER08 
          GOTO      SELA0100
.
SELA2500  
          KEYIN     *P5:CVERT,*V2LON,SYHVCH09;
          DISPLAY   *P5:CVERT,SYHVCH09;
          RESET     SYHVCH09
          GOTO      SELA0900 IF EOS
          MOVE      "26",CCOL
          MOVE      "2",CKEYTYP
          CALL      KSYFLB00
          MOVE      "0",CKEYTYP
          BRANCH    EXIT,SELA1700,SELA1700
          MOVE      KEY8,SYHVCF09
.
          KEYIN     *P37:CVERT,SYHVCW09,*P45:CVERT,SYHVER09 
          DISPLAY   *P26:CVERT,SYHVCF09:
                          *P37:CVERT,SYHVCW09,*P45:CVERT,SYHVER09 
          GOTO      SELA0100
.
SELA2600  
          KEYIN     *P5:CVERT,*V2LON,SYHVCH10;
          DISPLAY   *P5:CVERT,SYHVCH10;
          RESET     SYHVCH10
          GOTO      SELA0900 IF EOS
          MOVE      "26",CCOL
          MOVE      "2",CKEYTYP
          CALL      KSYFLB00
          MOVE      "0",CKEYTYP
          BRANCH    EXIT,SELA1700,SELA1700
          MOVE      KEY8,SYHVCF10
.
          KEYIN     *P37:CVERT,SYHVCW10,*P45:CVERT,SYHVER10 
          DISPLAY   *P26:CVERT,SYHVCF10:
                          *P37:CVERT,SYHVCW10,*P45:CVERT,SYHVER10 
          GOTO      SELA0100
.
.---- exit points ----
.
SELA9000  MOVE      ZERO,EXIT                    * post
          GOTO      SELA9999
.
SELA9500  MOVE      ONE,EXIT                     * cancel
.
SELA9999  RETURN
.******************************************************************************
.* POST - Post data                              Called by ML0000             *
.******************************************************************************
POST0000  PACK      KEY5,SYHVSYS,SYHVFIL,SYHVHID,SP70
          CALL      DESYHV1                 * delete old record (if possible)
          CALL      WRSYHV1                 * write new record
          PACK      KEY8,ANSH,SYHVSYS,SYHVFIL,SYHVHID,ZERO,ZERO
          MOVE      KEY8,SCFMFID
          PACK      KEY16,SCFMFID,SP70
          MOVE      SP70,SCFMPID
          MOVE      FOUR,SCFMTYP
          CLEAR     SCFMDES
          APPEND    "Gen Help - ",SCFMDES
          APPEND    SYHVDES,SCFMDES
          RESET     SCFMDES
          PACK      SCFMSFI,SYHVSYS,SYHVFIL,SYHVIDX
          CALL      RASCFM1
          IF        OVRCD=0
            CALL      UPSCFM1
          ELSE
            CALL      WRSCFM1
          ENDIF
.
POST9999  RETURN
.******************************************************************************
.* DELT - Delete data                            Called by ML0000             *
.******************************************************************************
DELT0000  PACK      KEY5,SYHVSYS,SYHVFIL,SYHVHID,SP70
          CALL      DESYHV1                 * delete old record (if possible)
          PACK      KEY8,ANSH,SYHVSYS,SYHVFIL,SYHVHID,ZERO,ZERO
          PACK      KEY16,KEY8,SP70
          CALL      RASCFM1
          IF        OVRCD=0
            CALL      DESCFM1
          ENDIF
.
DELT9999  RETURN
.
NEWOPTN   MOVE      ZERO,COPTION
          DISPLAY   *P70:2,SP10
          DISPLAY   *P1:4,*EF,"Options: ":
                          *P10:4,OPT1:
                          *P20:4,OPT2:
                          *P30:4,OPT3:
                          *P40:4,OPT4:
                          *P50:4,OPT5:
                          *P60:4,OPT6:
                          *HON,*V2LON,*P70:4,OPT0
          HLINE     *G37,5,1,80
.
NEWO1000  KEYIN     *P1:4,*NOEDIT,*+,*EOFF,ANS
          GOTO      NEWO2000 IF RIGHT
          GOTO      NEWO3000 IF LEFT
          REP       UPPLOW,ANS
          PACK      ANS,ANS,SP70
          MATCH     SP70,ANS
          GOTO      NEWO9999 IF EQUAL
          MATCH     "I",ANS
          GOTO      NEWO9100 IF EQUAL
          MATCH     "M",ANS
          GOTO      NEWO9200 IF EQUAL
          MATCH     "D",ANS
          GOTO      NEWO9300 IF EQUAL
          MATCH     "G",ANS
          GOTO      NEWO9400 IF EQUAL
          MATCH     "E",ANS
          GOTO      NEWO9500 IF EQUAL
          MATCH     "V",ANS
          GOTO      NEWO9600 IF EQUAL
          MATCH     "R",ANS
          GOTO      NEWO9700 IF EQUAL
          GOTO      NEWO1000
.
NEWO2000  BRANCH    COPTION,NEWO2100,NEWO2200,NEWO2300,NEWO2400,NEWO2500:
                            NEWO2600
.
          DISPLAY   *P70:4,OPT0:
                    *HON,*V2LON,*P10:4,OPT1
          MOVE      "1",COPTION
          GOTO      NEWO1000
.
NEWO2100  DISPLAY   *P10:4,OPT1:
                    *HON,*V2LON,*P20:4,OPT2
          MOVE      "2",COPTION
          GOTO      NEWO1000
.
NEWO2200  DISPLAY   *P20:4,OPT2:
                    *HON,*V2LON,*P30:4,OPT3
          MOVE      "3",COPTION
          GOTO      NEWO1000
.
NEWO2300  DISPLAY   *P30:4,OPT3:
                    *HON,*V2LON,*P40:4,OPT4
          MOVE      "4",COPTION
          GOTO      NEWO1000
.
NEWO2400  DISPLAY   *P40:4,OPT4:
                    *HON,*V2LON,*P50:4,OPT5
          MOVE      "5",COPTION
          GOTO      NEWO1000
.
NEWO2500  DISPLAY   *P50:4,OPT5:
                    *HON,*V2LON,*P60:4,OPT6
          MOVE      "6",COPTION
          GOTO      NEWO1000
.
NEWO2600  DISPLAY   *P60:4,OPT6:
                    *HON,*V2LON,*P70:4,OPT0
          MOVE      "0",COPTION
          GOTO      NEWO1000
.
NEWO3000  BRANCH    COPTION,NEWO3100,NEWO3200,NEWO3300,NEWO3400,NEWO3500:
                            NEWO3600
.
          DISPLAY   *P70:4,OPT0:
                    *HON,*V2LON,*P60:4,OPT6
          MOVE      "6",COPTION
          GOTO      NEWO1000
.
NEWO3100  DISPLAY   *P10:4,OPT1:
                    *HON,*V2LON,*P70:4,OPT0
          MOVE      "0",COPTION
          GOTO      NEWO1000
NEWO3200  DISPLAY   *P20:4,OPT2:
                    *HON,*V2LON,*P10:4,OPT1
          MOVE      "1",COPTION
          GOTO      NEWO1000
NEWO3300  DISPLAY   *P30:4,OPT3:
                    *HON,*V2LON,*P20:4,OPT2
          MOVE      "2",COPTION
          GOTO      NEWO1000
NEWO3400  DISPLAY   *P40:4,OPT4:
                    *HON,*V2LON,*P30:4,OPT3
          MOVE      "3",COPTION
          GOTO      NEWO1000
NEWO3500  DISPLAY   *P50:4,OPT5:
                    *HON,*V2LON,*P40:4,OPT4
          MOVE      "4",COPTION
          GOTO      NEWO1000
NEWO3600  DISPLAY   *P60:4,OPT6:
                    *HON,*V2LON,*P50:4,OPT5
          MOVE      "5",COPTION
          GOTO      NEWO1000
.
NEWO9100  MOVE      "1",COPTION
          GOTO      NEWO9999
NEWO9200  MOVE      "2",COPTION
          GOTO      NEWO9999
NEWO9300  MOVE      "3",COPTION
          GOTO      NEWO9999
NEWO9400  MOVE      "4",COPTION
          GOTO      NEWO9999
NEWO9500  MOVE      "0",COPTION
          GOTO      NEWO9999
NEWO9600  MOVE      "5",COPTION
          GOTO      NEWO9999
NEWO9700  MOVE      "6",COPTION
          GOTO      NEWO9999
NEWO9999  MOVE      OPT0,OPT
          LOAD      OPT,COPTION,OPT1,OPT2,OPT3,OPT4,OPT5,OPT6
          DISPLAY   *P70:2,*HON,*V2LON,OPT
          RETURN
.----------------------------------------------------------------------
. GENC0000 - Generate Keyin Code
.----------------------------------------------------------------------
GENC0000  PACK      KYNAME,SYSCID3,SYFIID3,KY,SP70
          SPLOPEN   KYNAME
          CALL      GENF0000           * Generate File Heading.
.
          PACK      HLABEL,ANSH,SYHVSYS,SYHVFIL,SYHVHID
.
          PACK      KEYFLD,SYHVSYS,SYHVFIL,SYHVFLD
          PACK      HELPFLD,SYHVSYS,SYHVFIL,SYHVFLD
          BRANCH    SYFITIO,GENC0100,GENC0200
.
          PACK      RACALLID,RA,SYSCSYS,SYFIFIL,SYHVIDX
          PACK      RDCALLID,RD,SYSCSYS,SYFIFIL,SYHVIDX
          PACK      RSCALLID,RS,SYSCSYS,SYFIFIL,SYHVIDX
          PACK      RPCALLID,RP,SYSCSYS,SYFIFIL,SYHVIDX
          PACK      RKCALLID,RK,SYSCSYS,SYFIFIL,SYHVIDX
          GOTO      GENC0500
.
GENC0100  PACK      RACALLID,RA,SYSCSYS,SYFIID3,SYHVIDX
          PACK      RDCALLID,RD,SYSCSYS,SYFIID3,SYHVIDX
          PACK      RKCALLID,RK,SYSCSYS,SYFIID3,SYHVIDX
          PACK      RPCALLID,RP,SYSCSYS,SYFIID3,SYHVIDX
          PACK      RSCALLID,RS,SYSCSYS,SYFIID3,SYHVIDX
          GOTO      GENC0500
.
GENC0200  PACK      KEY8,SYHVSYS,SYHVFIL,SYHVFLD
          CALL      RDSYFL2
          MOVE      SYFLV4N,KEYFLD
          MOVE      SYFLV4N,HELPFLD
          PACK      RACALLID,RDA,SYFIID3,SYFIID4,SYHVIDX
          PACK      RSCALLID,RDS,SYFIID3,SYFIID4,SYHVIDX
          PACK      RKCALLID,RDK,SYFIID3,SYFIID4,SYHVIDX
          PACK      RPCALLID,RDP,SYFIID3,SYFIID4,SYHVIDX
          PACK      RDCALLID,RD,SYFIID3,SYFIID4,SYHVIDX
.
GENC0500  PACK      DIM80,SP70,SP70
          CLEAR     DIM80
          MOVE      ZERO,COUNT
          MOVE      ZERO,KEYLEN
GENC1000  ADD       ONE,COUNT
          LOAD      SEGMENT,COUNT,SYIDFL1,SYIDFL2,SYIDFL3,SYIDFL4:
                                  SYIDFL5,SYIDFL6,SYIDFL7,SYIDFL8
          MATCH     SP70,SEGMENT
          GOTO      GENC1100 IF EQUAL
.
          PACK      KEY8,SYIDSYS,SYIDFIL,SEGMENT
          CALL      RDSYFL2
          ADD       SYFLPHY,KEYLEN
          APPEND    COMMA,DIM80
          COMPARE   TWO,SYFITIO
          GOTO      GENC1010 IF NOT EQUAL
          MOVE      SYFLV4N,KEY8
.
GENC1010  APPEND    KEY8,DIM80
          CALL      SEND0000
.
          MATCH     SYHVFLD,SEGMENT
          GOTO      GENC1050 IF NOT EQUAL
.
          MOVE      KEYLEN,SETLEN
          SUB       SYFLPHY,SETLEN
.
GENC1050  COMPARE   EIGHT,COUNT
          GOTO      GENC1000 IF NOT EQUAL
.
GENC1100  MOVE      KEYLEN,DIM4
          CALL      FLEN0000
          RESET     DIM80
          PACK      UNPACKKY,UNPACK,DIM4,DIM80,SP70,SP70
          PACK      UNPKCHK,SP70,SP70
          PACK      UNPKCHK,PUNPKCHK,DIM80
.
          CALL      SEND0000
          APPEND    COMMA,DIM80
          CALL      SEND0000
          APPEND    "SP70",DIM80
          CALL      SEND0000
          RESET     DIM80
.       
          PACK      PACKKEY,SP70,SP70
          PACK      PACKKEY,PPACKKEY,DIM4,DIM80
          PACK      PACSP70,PPACKKEY,DIM4,PSP70
          PACK      PACKZZZ,SP70,SP70
          PACK      PACKZZZ,PPACKKEY,DIM4,PSAVKEY
          PACK      PACKCHK,SP70,SP70
          PACK      PACKCHK,PPACKCHK,DIM80
          CLEAR     KEYXX
          APPEND    "KEY",KEYXX
          APPEND    DIM4,KEYXX
          RESET     KEYXX
.
          MATCH     SP70,SYHVFLD
          GOTO      GENC1190 IF EQUAL
          COMPARE   ZERO,SETLEN
          GOTO      GENC1200 IF NOT EQUAL
GENC1190
          MOVE      PBLANK,PSETLEN
          PACK      UNPKCHK,PBLANK,SP70,SP70
          PACK      PACKCHK,PBLANK,SP70,SP70
          PACK      PACKZZZ,PPACKKEY,DIM4,PZ70
          PACK      PMATKEY,PBLANK,SP70    
          PACK      PMATFLD,PBLANK,SP70
          PACK      PMATGOT1,PBLANK,SP70
          PACK      PMATGOT2,PBLANK,SP70
          PACK      PMATGOT3,PBLANK,SP70
          PACK      PMATGOT4,PBLANK,SP70
          PACK      PMATGOT5,PBLANK,SP70
          PACK      PMATGOT6,PBLANK,SP70
          GOTO      GENC1300
.
GENC1200  MOVE      SETLEN,DIM4
          CALL      FLEN0000
          PACK      PSETLEN,PPSETLEN,DIM4
          PACK      PMATKEY,PPMATKEY,KEYXX
          PACK      PMATFLD,PPMATFLD,KEYFLD
          PACK      PMATGOT1,PGOTO,HLABEL,S15,PIFNOTEQ
          PACK      PMATGOT2,PGOTO,HLABEL,S90,PIFNOTEQ
          PACK      PMATGOT3,PGOTO,HLABEL,S85,PIFNOTEQ
          PACK      PMATGOT4,PGOTO,HLABEL,S37,PIFNOTEQ
          PACK      PMATGOT5,PGOTO,HLABEL,S47,PIFNOTEQ
          PACK      PMATGOT6,PGOTO,HLABEL,S85,PIFEQU
.
GENC1300  CALL      GENH0000 * Generate Standard Keyin
          SPLCLOSE
          PACK      PRNAME,SYSCID3,SYFIID3,KY,PRT
          PACK      KYNAME,SYSCID3,SYFIID3,KY,PBL
.
          DISPLAY   *P10:20;
          PREP      TEMPFILE,FILENAME
          WRITE     TEMPFILE,SEQ;"/^",HLABEL,"00/-6,/^",HLABEL,"99/+1d"
          WRITE     TEMPFILE,SEQ;"w"
          WRITE     TEMPFILE,SEQ;"q"
          CLOSE     TEMPFILE
          PACK      COMMAND,ED,KYNAME,INPUT,FILENAME,TXT
          EXECUTE   COMMAND,TASKID
.
GENC2000  PACK      COMMAND,CAT,TBSPOOL,PRNAME,OUTPUT,KYNAME  
          EXECUTE   COMMAND,TASKID
.
          PREP      TEMPFILE,FILENAME
          CLOSE     TEMPFILE
.
          PACK      COMMAND,RM,TBSPOOL,PRNAME
          EXECUTE   COMMAND,TASKID
.
          RETURN
.-------------------------------------------------
. FLEN0000 - Left Justify 4 Digit Form
.-------------------------------------------------
FLEN0000  MATCH     SP1,DIM4
          GOTO      FLEN9999 IF NOT EQUAL
          BUMP      DIM4
          GOTO      FLEN0000
FLEN9999  RETURN
.-------------------------------------------------
. SEND000 - Set end of DIM80 for APPENDs
.-------------------------------------------------
SEND0000  RESET     DIM80,80
SEND1000  
          CMATCH    SP1,DIM80
          GOTO      SEND2000 IF NOT EQUAL
.
          BUMP      DIM80,-1
          GOTO      SEND1000 IF NOT EOS
.
          CLEAR     DIM80
          GOTO      SEND9999
SEND2000  
SEND9999  RETURN
.-------------------------------------------------
. SE2D000 - Set end of DIM20 for APPENDs
.-------------------------------------------------
SE2D0000  RESET     DIM20,20
SE2D1000  
          CMATCH    SP1,DIM20
          GOTO      SE2D2000 IF NOT EQUAL
.
          BUMP      DIM20,-1
          GOTO      SE2D1000 IF NOT EOS
.
          CLEAR     DIM20
          GOTO      SE2D9999
SE2D2000  
SE2D9999  RETURN
.----------------------------------------------------------------------
. GENF0000 - Output File Heading Details
.----------------------------------------------------------------------
GENF0000  PRINT     ".-----------------------------------------":
                    "----------------------------------"
          PRINT     ".   System    :   ",SYSCDES
          PRINT     ".   Include   :   ",SYSCID3,SYFIID3,"KY"
          PRINT     ".   Routine   :   H",SYSCSYS,SYFIFIL,SYHVHID:
                    "00 ",SYHVDES
          PRINT     ".   Return    :   ",HELPFLD
          PRINT     ".-----------------------------------------":
                    "--------------------------------------"
          RETURN
.----------------------------------------------------------------------
. GENH0000 - Output Help Routine
.----------------------------------------------------------------------
GENH0000  
          PRINT     HLABEL,"00"
          MATCH     SP70,SYHVCBF
          GOTO      GENH0010 IF EQUAL
          PRINT     "          CALL      ",SYHVCBF
GENH0010  PRINT     "          MOVE      ZERO,CSCRSIZ"
          PRINT     "          IF        HTOP<3"
          PRINT     SP2,PMOVE,PQUOTE,SYHVDTOP,PQUOTE,",HTOP"
          PRINT     SP2,PMOVE,PQUOTE,SYHVDBOT,PQUOTE,",HBOT"
          PRINT     SP2,PMOVE,PQUOTE,SYHVDLEF,PQUOTE,",HLEF"
          PRINT     SP2,PMOVE,PQUOTE,SYHVDRIG,PQUOTE,",HRIG"
          PRINT     "          ENDIF"
.
          PRINT     HLABEL,"04"
          PRINT     "          CALL      GSCRN000"
          PRINT     "          BRANCH    EXIT,",HLABEL,"99"
.
          MOVE      ZERO,COUNT
GENH1000  COMPARE   TEN,COUNT
          GOTO      GENH2000 IF EQUAL
          ADD       ONE,COUNT
          PACK      DIM20,SP70,SP70
          LOAD      DIM20,COUNT,SYHVCH01,SYHVCH02,SYHVCH03,SYHVCH04,SYHVCH05:
                                SYHVCH06,SYHVCH07,SYHVCH08,SYHVCH09,SYHVCH10
          LOAD      COLWIDTH,COUNT,FIVE,SYHVCW01,SYHVCW02,SYHVCW03,SYHVCW04:
                                   SYHVCW05,SYHVCW06,SYHVCW07,SYHVCW08,SYHVCW09:
                                   SYHVCW10
          COMPARE   ZERO,COLWIDTH
          GOTO      GENH1000 IF EQUAL
          MOVE      COUNT,F2
          PACK      PSTDCOL,PPSTDCOL,F2
          REP       " 0",PSTDCOL
          SUB       ONE,F2
          PACK      LPSTDCOL,PPSTDCOL,F2
          REP       " 0",LPSTDCOL
.
          PRINT     "          MOVE      ",LPSTDCOL,COMMA,PSTDCOL
          PRINT     "          ADD       #"",COLWIDTH,PQUOTE,COMMA,PSTDCOL
          MATCH     SP70,DIM20
          GOTO      GENH1000 IF EQUAL
          CALL      SE2D0000
          APPEND    PQUOTE,DIM20
          PRINT     "          DISPLAY   *P",PSTDCOL:
                    ":STDROW,*V2LON,*ULON,#"",DIM20
          PRINT     PBLANK
          GOTO      GENH1000
. 
GENH2000  
          PRINT     HLABEL,"08"
          PRINT     "          MOVE      ZERO,XITEMNO"
          PRINT     "          MOVE      MINITEM,STDROW"
.
          MATCH     SP70,SYHVFLD 
          IF        @EQUAL
            PRINT     PACSP70     * Start Position
          ELSE
            PRINT     "          MOVE      SP70,",HELPFLD
            PRINT     PACKKEY     * Start Position
          ENDIF
.
          PRINT     PACKCHK     * Save Key to Check for End
          PRINT     PSETLEN     * Set Length of Save Key
.
          PRINT     PCALL,RSCALLID
.
          PRINT     HLABEL,"10"
          PRINT     PCALL,RKCALLID
          PRINT     "          BRANCH    OVRCD,",HLABEL,"15"
          PRINT     PACKKEY     * Check Against Key
.
          MATCH     SP70,SYHVFLD 
          IF        !@EQUAL
            PRINT     PMATKEY
            PRINT     PMATGOT1
          ENDIF
.
          PRINT     "          BRANCH    CSEARCH,",HLABEL,"12"
          PRINT     "          CALL      ",HLABEL,"60"
          PRINT     "          BRANCH    OVRCD,",HLABEL,"10"
          PRINT     HLABEL,"12"
          PRINT     "          ADD       ONE,XITEMNO"
          PRINT     "          ADD       ONE,STDROW"
          PACK      DIM80,SP70,SP70
          CLEAR     DIM80
          APPEND    PSTORE1,DIM80
          APPEND    KEYXX,DIM80
          CALL      SEND0000
          APPEND    PSTORE2,DIM80
          RESET     DIM80
          PRINT     DIM80
          PRINT     PSTORE3
          PRINT     PSTORE4
          PRINT     PSTORE5
          PRINT     "          DISPLAY   *PSTDCOL00:STDROW,SP1":
                    ",*V2LON,XITEMNO,DOT"
.
          MOVE      ZERO,COUNT
GENH3000  COMPARE   TEN,COUNT
          GOTO      GENH4000 IF EQUAL
          ADD       ONE,COUNT
          PACK      DIM80,SP70,SP70
          LOAD      DISFLD,COUNT,SYHVCF01,SYHVCF02,SYHVCF03,SYHVCF04,SYHVCF05:
                                 SYHVCF06,SYHVCF07,SYHVCF08,SYHVCF09,SYHVCF10
          LOAD      ROUTINE,COUNT,SYHVER01,SYHVER02,SYHVER03,SYHVER04,SYHVER05:
                                  SYHVER06,SYHVER07,SYHVER08,SYHVER09,SYHVER10
          MATCH     SP70,ROUTINE
          GOTO      GENH3100 IF EQUAL
          PRINT     PCALL,ROUTINE
.
GENH3100  MATCH     SP70,DISFLD
          GOTO      GENH3000 IF EQUAL
          MOVE      COUNT,F2
          PACK      PSTDCOL,PPSTDCOL,F2
          REP       " 0",PSTDCOL
          PRINT     "          DISPLAY   *P",PSTDCOL,":STDROW,",DISFLD
          GOTO      GENH3000
.
GENH4000  PRINT     "          COMPARE   MAXITEM,XITEMNO"
          PRINT     PGOTO,HLABEL,"10",PIFNOTEQ
.
          PRINT     HLABEL,"15"
          PRINT     UNPKCHK     * Un Pack Save Key
          PRINT     "          MOVE      ONE,DITEM"
          PRINT     "          MOVE      MINITEM,DROW"
          PRINT     "          ADD       ONE,DROW"
          PRINT     "          DISPLAY   *PSTDCOL00:DROW,*V2LON,*HON,SP1":
                    ",DITEM,DOT"
          PRINT     "          CLIP"
          PRINT     "          FLUSH     HLEF,HTOP,HRIG,HBOT"
          PRINT     PBLANK
          PRINT     HLABEL,"20"
          PRINT     "          CALL      HSCRI000"
          PRINT     "          BRANCH    EXIT,",HLABEL,"30,",HLABEL,"35,":
                    HLABEL,"40,",HLABEL,"45,",HLABEL,"04:"
          PRINT     SP10,SP10,SP10,HLABEL,"91,",HLABEL,"50"
          PRINT     PGOTO,HLABEL,"92"
.
          PRINT     HLABEL,"30"
          PRINT     PCALL,RKCALLID
          PRINT     PBRANOV,HLABEL,"85"
          PRINT     PACKKEY     * Check Against Key
          PRINT     PMATKEY
          PRINT     PMATGOT3
          PRINT     PCALL,RPCALLID
          PRINT     "          MOVE      ZERO,XITEMNO"
          PRINT     "          MOVE      MINITEM,STDROW"
          PRINT     "          SUSPEND"
          PRINT     "          CLIP      1,1,CRIG,24"
.
          PRINT     "          BOXCLR    CLEF,CTOP,CRIG,CBOT"
          PRINT     PGOTO,HLABEL,"10"
.
          PRINT     HLABEL,"35"
          PRINT     "          MOVE      ST1,",KEYXX
          PRINT     PCALL,RDCALLID
          PRINT     PCALL,RPCALLID
          PRINT     PBRANOV,HLABEL,"85"
          PRINT     PACKKEY     * Check Against Key
          PRINT     PMATKEY
          PRINT     PMATGOT3
          MATCH     SP70,SYHVFLD
          IF        !@EQUAL
            PRINT     PMATFLD
            PRINT     PMATGOT6
          ENDIF
.
          PRINT     "          SUSPEND"
          PRINT     "          CLIP      1,1,CRIG,24"
.
          PRINT     "          BOXCLR    CLEF,CTOP,CRIG,CBOT"
          PRINT     "          MOVE      MINITEM,STDROW"
          PRINT     "          MOVE      MAXITEM,XITEMNO"
          PRINT     HLABEL,"36"
          PRINT     PCALL,RPCALLID
          PRINT     PBRANOV,HLABEL,"37"
          PRINT     PACKKEY     * Check Against Key
          PRINT     PMATKEY
          PRINT     PMATGOT4
          PRINT     "          SUB       ONE,XITEMNO"
          PRINT     "          COMPARE   ZERO,XITEMNO"
          PRINT     PGOTO,HLABEL,"36",PIFNOTEQ
          PRINT     HLABEL,"37"
          PRINT     "          MOVE      ZERO,XITEMNO"
          PRINT     PGOTO,HLABEL,"10"
.
          PRINT     HLABEL,"40"
          PRINT     "          MOVE      ST1,",KEYXX
          PRINT     PCALL,RDCALLID
          PRINT     PCALL,RPCALLID
          PRINT     PBRANOV,HLABEL,"85"
          PRINT     PACKKEY     * Check Against Key
          PRINT     PMATKEY
          PRINT     PMATGOT3
          PRINT     "          SUSPEND"
          PRINT     "          CLIP      1,1,CRIG,24"
.
          PRINT     "          BOXCLR    CLEF,CTOP,CRIG,CBOT"
          PRINT     PGOTO,HLABEL,"08"
.
          PRINT     HLABEL,"45"
          PRINT     PCALL,RKCALLID
          PRINT     PBRANOV,HLABEL,"85"
          PRINT     PACKKEY     * Check Against Key
          PRINT     PMATKEY
          PRINT     PMATGOT3
          PRINT     "          SUSPEND"
          PRINT     "          CLIP      1,1,CRIG,24"
          PRINT     PBLANK
          PRINT     "          BOXCLR    CLEF,CTOP,CRIG,CBOT"
          PRINT     "          MOVE      ZERO,XITEMNO"
          PRINT     PACKZZZ
          PRINT     "          MOVE      MINITEM,STDROW"
          PRINT     "          MOVE      MAXITEM,XITEMNO"
          PRINT     PCALL,RSCALLID
          PRINT     HLABEL,"46"
          PRINT     PCALL,RPCALLID
          PRINT     PBRANOV,HLABEL,"47"
          PRINT     PACKKEY     * Check Against Key
          PRINT     PMATKEY
          PRINT     PMATGOT5
          PRINT     "          SUB       ONE,XITEMNO"
          PRINT     "          COMPARE   ZERO,XITEMNO"
          PRINT     PGOTO,HLABEL,"46",PIFNOTEQ
          PRINT     HLABEL,"47"
          PRINT     "          MOVE      ZERO,XITEMNO"
          PRINT     PGOTO,HLABEL,"10"
.
.
          PRINT     HLABEL,"50  COMPARE   ZERO,CSEARCH"
          PRINT     "          GOTO      ",HLABEL,"55 IF EQUAL"
.
          PRINT     "          MOVE      ZERO,CSEARCH"
          PRINT     "          MOVE      ZERO,XITEMNO"
          PRINT     "          MOVE      MINITEM,STDROW"
          PRINT     "          ADD       ONE,STDROW"
          PRINT     "          UNPACK    SP70,SCHFLD01,SCHFLD02,SCHFLD03":
                    ",SCHFLD04,SCHFLD05"
          PRINT     "          UNPACK    SP70,SCHFLD06,SCHFLD07,SCHFLD08":
                    ",SCHFLD09,SCHFLD10"
.
          PRINT     "          BOXCLR    CLEF,CTOP,CRIG,CBOT"
          PRINT     "          DISPLAY   *PSTDCOL00:STDROW,*V2LON,*HON,#"Sch#""
.
          MOVE      ZERO,COUNT
GENH5000  COMPARE   TEN,COUNT
          GOTO      GENH5900 IF EQUAL
          ADD       ONE,COUNT
          PACK      DIM80,SP70,SP70
          LOAD      DISFLD,COUNT,SYHVCF01,SYHVCF02,SYHVCF03,SYHVCF04,SYHVCF05:
                                 SYHVCF06,SYHVCF07,SYHVCF08,SYHVCF09,SYHVCF10
.
          MATCH     SP70,DISFLD
          GOTO      GENH5000 IF EQUAL
          MOVE      DISFLD,KEY8
          CALL      RDSYFL2
          BRANCH    OVRCD,GENH5100
.         
          BRANCH    SYFLTYP,GENH5000
GENH5100  MOVE      COUNT,F2
          PACK      PSTDCOL,PPSTDCOL,F2
          REP       " 0",PSTDCOL
          MOVE      F2,DIM2
          REP       " 0",DIM2
          PRINT     "          KEYIN     *P":
                    PSTDCOL,":STDROW,*V2LON,SCHFLD",DIM2
          PRINT     "          RESET     SCHFLD",DIM2
          GOTO      GENH5000
.
GENH5900  PRINT     "          PACK      KEY8,SP70"
          PRINT     "          SUSPEND"
          PRINT     "          CLIP      1,1,CRIG,24"
          PRINT     "          BOXCLR    CLEF,CTOP,CRIG,CBOT"
          PRINT     "          GOTO      ",HLABEL,"08"
.
          PRINT     HLABEL,"55  MOVE      ONE,CSEARCH"
          PRINT     "          PACK      KEY8,SP70"
          PRINT     "          SUSPEND"
          PRINT     "          CLIP      1,1,CRIG,24"
          PRINT     "          BOXCLR    CLEF,CTOP,CRIG,CBOT"
          PRINT     "          GOTO      ",HLABEL,"08"
.
          PRINT     HLABEL,"60  MOVE      ZERO,OVRCD"
.
          MOVE      ZERO,COUNT
GENH6000  COMPARE   TEN,COUNT
          GOTO      GENH6900 IF EQUAL
          ADD       ONE,COUNT
          PACK      DIM80,SP70,SP70
          LOAD      DISFLD,COUNT,SYHVCF01,SYHVCF02,SYHVCF03,SYHVCF04,SYHVCF05:
                                 SYHVCF06,SYHVCF07,SYHVCF08,SYHVCF09,SYHVCF10
          LOAD      ROUTINE,COUNT,SYHVER01,SYHVER02,SYHVER03,SYHVER04,SYHVER05:
                                  SYHVER06,SYHVER07,SYHVER08,SYHVER09,SYHVER10
.
          MOVE      COUNT,F2
          MATCH     SP70,DISFLD
          GOTO      GENH6800 IF EQUAL
          MOVE      DISFLD,KEY8
          CALL      RDSYFL2
          BRANCH    OVRCD,GENH6100
          BRANCH    SYFLTYP,GENH6800
          GOTO      GENH6200
GENH6100  MATCH     SP70,ROUTINE
          GOTO      GENH6200 IF EQUAL
          PRINT     "          CALL      ",ROUTINE
GENH6200  MOVE      F2,DIM2
          REP       " 0",DIM2
          PRINT     "          MATCH     SP70,SCHFLD",DIM2
          ADD       "60",F2
          MOVE      F2,DIM2
          REP       " 0",DIM2
          PRINT     "          GOTO      ",HLABEL,DIM2," IF EQUAL"
          SUB       "60",F2
          MOVE      F2,DIM2
          REP       " 0",DIM2
          PRINT     "          MATCH     SCHFLD",DIM2,",",DISFLD
          PRINT     "          GOTO      ",HLABEL,"72 IF NOT EQUAL"
.
GENH6800  ADD       "60",F2
          MOVE      F2,DIM2
          REP       " 0",DIM2
          PRINT     HLABEL,DIM2
          GOTO      GENH6000
.
GENH6900  PRINT     "          GOTO      ",HLABEL,"75"
.
          PRINT     HLABEL,"72  MOVE      ONE,OVRCD"
          PRINT     HLABEL,"75  RETURN"
.
          PRINT     HLABEL,"85"
          PACK      DIM80,SP70,SP70
          CLEAR     DIM80
          APPEND    PLOAD1,DIM80
          APPEND    KEYXX,DIM80
          CALL      SEND0000
          APPEND    PSTORE2,DIM80
          RESET     DIM80
          PRINT     DIM80
          PRINT     PSTORE3
          PRINT     PSTORE4
          PRINT     PSTORE5
          PRINT     UNPACKKY
          PRINT     PCALL,RDCALLID
.
          PRINT     HLABEL,"90"
          PRINT     UNPKCHK     * Un Pack Save Key
          PRINT     "          BEEP"
          PRINT     PGOTO,HLABEL,"20"
.
          PRINT     HLABEL,"91"
.
. Clear all Field on file
.
          CALL      CLRFLD00
.
          PRINT     "          MOVE      SP70,",KEYXX
          MATCH     SP70,SYHVFLD 
          IF        !@EQUAL
            PRINT     "          MOVE      SP70,",HELPFLD
          ENDIF
          PRINT     PGOTO,HLABEL,"96"
.
          PRINT     HLABEL,"92"
          PRINT     "          MOVE      SP70,",KEYXX
          MATCH     SP70,SYHVFLD 
          IF        !@EQUAL
            PRINT     "          MOVE      SP70,",HELPFLD
          ENDIF
          PACK      DIM80,SP70,SP70
          CLEAR     DIM80
          APPEND    PLOAD1,DIM80
          APPEND    KEYXX,DIM80
          CALL      SEND0000
          APPEND    PLOAD2,DIM80
          RESET     DIM80
          PRINT     DIM80
          PRINT     PSTORE3
          PRINT     PSTORE4
          PRINT     PSTORE5
          PRINT     UNPACKKY
.
          PRINT     HLABEL,"96"
          PRINT     "          PUTSCR    CSSCRNUM,HLEF,HTOP,HRIG,HBOT"
          PRINT     "          CALL      FRESCR00"
          PRINT     "          MOVE      ZERO,HTOP"
          PRINT     "          MOVE      ZERO,HLEF"
          PRINT     "          MOVE      ZERO,HBOT"
          PRINT     "          MOVE      ZERO,HRIG"
.
          PRINT     HLABEL,"99"
          PRINT     PRETURN
          RETURN
.
CLRFLD00  PACK      KEY8,SYSCSYS,SYFIFIL,SP70
          CALL      RDSYFL1
CLRFLD10  CALL      RKSYFL1
          BRANCH    OVRCD,CLRFLD99
          MATCH     SYSCSYS,SYFLSYS
          GOTO      CLRFLD99 IF NOT EQUAL
          MATCH     SYFIFIL,SYFLFIL
          GOTO      CLRFLD99 IF NOT EQUAL
          PACK      KEY8,SYFLSYS,SYFLFIL,SYFLFLD
.
. Dont Clear Index Segments
.
          MATCH     SYFLFLD,SYIDFL1
          GOTO      CLRFLD10 IF EQUAL
          MATCH     SYFLFLD,SYIDFL2
          GOTO      CLRFLD10 IF EQUAL
          MATCH     SYFLFLD,SYIDFL3
          GOTO      CLRFLD10 IF EQUAL
          MATCH     SYFLFLD,SYIDFL4
          GOTO      CLRFLD10 IF EQUAL
          MATCH     SYFLFLD,SYIDFL5
          GOTO      CLRFLD10 IF EQUAL
          MATCH     SYFLFLD,SYIDFL6
          GOTO      CLRFLD10 IF EQUAL
          MATCH     SYFLFLD,SYIDFL7
          GOTO      CLRFLD10 IF EQUAL
          MATCH     SYFLFLD,SYIDFL8
          GOTO      CLRFLD10 IF EQUAL
.
          IF        SYFITIO=2
            MOVE      SYFLV4N,KEY8
          ENDIF
          IF        SYFLTYP=0
            PRINT     "          MOVE      SP70,",KEY8
          ELSE
            PRINT     "          MOVE      ZERO,",KEY8
          ENDIF
          GOTO      CLRFLD10
CLRFLD99  RETURN
.
+
.----------------------------------------
. Generate a Range of Programs
.----------------------------------------
RGEN0000  HLINE     *G37,17,1,80
          DISPLAY   *P1:18,*EF:
                    *P1:19,*ULON,*V2LON,"Generate a Range of Help Routines":
                    *P1:21,*HOFF,*EL,"First Sys/Fil/ID : ":
                    *P1:22,*EL,"Last  Sys/Fil/ID : "
          MOVE      "20",CCOL
          MOVE      "21",CVERT
          CALL      KSYHVB00
          BRANCH    EXIT,RGEN9000,RGEN9000
          PACK      FSTHID,KEY5
          DISPLAY   *PCCOL:CVERT,*V2LON,KEY5,SP1,*HOFF,SYHVDES
.
          MOVE      "20",CCOL
          MOVE      "22",CVERT
          CALL      KSYHVB00
          BRANCH    EXIT,RGEN9000,RGEN9000
          PACK      LSTHID,KEY5
          DISPLAY   *PCCOL:CVERT,*V2LON,KEY5,SP1,*HOFF,SYHVDES
.
          DISPLAY   *P1:24,*EL,"Process (":
                    *V2LON,"Y",*HOFF,"/":
                    *V2LON,"N",*HOFF,") ? "
          MOVE      "17",CCOL
          MOVE      "24",CVERT
          CALL      YORN0000
          COMPARE   ZERO,FYESNO
          GOTO      RGEN9000 IF EQUAL
.
          MOVE      FSTHID,KEY5
          CALL      RDSYHV1
          COMPARE   ZERO,OVRCD
          GOTO      RGEN1100 IF EQUAL
RGEN1000  CALL      RKSYHV1
          BRANCH    OVRCD,RGEN9000
          PACK      KEY5,SYHVSYS,SYHVFIL,SYHVHID
          MATCH     KEY5,LSTHID
          GOTO      RGEN9000 IF LESS
RGEN1100
          MOVE      SYHVSYS,KEY2
          CALL      RDSYSC1
          PACK      KEY4,SYHVSYS,SYHVFIL
          CALL      RDSYFI1
          PACK      KEY5,SYHVSYS,SYHVFIL,SYHVIDX
          CALL      RDSYID1
          PACK      KEY8,SYHVSYS,SYHVFIL,SYHVFLD
          CALL      RDSYFL2
          IF        OVRCD=1
            MOVE      SP70,SYHVFLD
            MOVE      SP70,SYFLFLD
          ENDIF
          PACK      KEY5,SYHVSYS,SYHVFIL,SYHVHID
          CALL      RDSYHV1
          DISPLAY   *P1:1,*ES,"Generating : ",*V2LON,KEY5,*HOFF,SP1,SYHVDES
.
          CALL      GENC0000
.
          GOTO      RGEN1000
.
RGEN9000  
RGEN9999  RETURN
.
.******************************************************************************
.* INCLUDES FOR I/O'S                                                         *
.******************************************************************************
          INC       SYSSCFIO/INC
          INC       SYSFILIO/INC
          INC       SYSIDXIO/INC
          INC       SYSFLDIO/INC
          INC       SYSHVRIO/INC
          INC       SCRFMAIO/INC
          INC       IBASEQIO/INC
          INC       WEBERRIO/INC
.
          INC       TFILENAM
          INC       SYSSCFKY
          INC       SYSFILKY
          INC       SYSIDXKY
          INC       SYSFLDKY
          INC       SYSHVRKY
          INC       STDGENCD

