.*****************************************************************************
.* System    :   Inpatients       / WebServices                              *
.* Program   :   IBAWEB13                                                    *
.* Desc      :   WebServices IHCW Assessment Report Printing                 *
.*****************************************************************************
.* Date      :   07/05/2021                                                  *
.* Author    :   Peter Vela                                                  *
.* Function  :   This program will allow the user to report on the raw       *
.*               assessment details for a given IHCW claim.                  *
.* Mods      :                                                               *
.*       V11.01.01  07/05/2021  Peter Vela        TSK 0902857                *
.*                  Program created.                                         *
.*****************************************************************************
.
          INC       STD001FD
.
. FILE DESCRIPTION INCLUDES
. -------------------------
          INC       PATCONFD/INC
          INC       WEBPARFD/INC
          INC       WEBIHDFD/INC
          INC       WEBIHEFD/INC
          INC       WEBIHFFD/INC
          INC       WEBIHGFD/INC
          INC       WEBIHHFD/INC
.
. LOCAL VARIABLE DEFINITION
. -------------------------
ASSDESC2  DIM       45
.
DIM7      DIM       7
DIM10     DIM       10
DIM10A    DIM       10
DIM10B    DIM       10
DIM10C    DIM       10
DIM10D    DIM       10
DIM40     DIM       40
DIM40A    DIM       40
DISPDTE3  DIM       10
.
FORM7P2   FORM      7.2
.
.
. PROGRAM CONSTANTS
. -----------------
PIPE      INIT      "|"
SP32      INIT      "                                "
.
.
PRGID     INIT      "IBAWEB13"
PRGNAM    INIT      "WebServices IHCW Assessment Report Printing"
VERSION   INIT      "V12.01.00"
+
.*****************************************************************************
.*                              MAIN0000                                     *
.*                      Controlling Logic (Mainline code)                    *
.*****************************************************************************
.
MAIN0000  CALL      INIT0000               * initialisation and open files
.
          MATCH     "1",PTCNWSIN
          GOTO      MAIN9999 IF NOT EQUAL
.
          MATCH     "1",PTCNIHCW
          GOTO      MAIN9999 IF NOT EQUAL
.
          CALL      GASS0000               * get assessment header key
          BRANCH    EXIT,MAIN9999          * nothing/exitchar entered
.
          CALL      PRIN0000               * print assessment
.
MAIN9999  CHAIN     PGM                    * chain back to program
+
.*****************************************************************************
.*                                INIT0000                                   *
.*                             initialisation                                *
.*  The initialisation routine is used to display headings and open files.   *
.*****************************************************************************
.
INIT0000  CALL      DISPHEAD                  * display heading
.
          OPEN      CONTROLF,"controlf"
          READ      CONTROLF,HUND29;*1,PTCNWSDR,*61,PTCNWSIN,*73,PTCNIMCW:
                                                             *88,PTCNIHCW
.
          DISPLAY   *P56:24,*EL,"Opening ";
.
          MATCH     "1",PTCNIHCW
          IF        @EQUAL
            DISPLAY   *P64:24,"webihdaf";
            OPEN      WEBIHDA1,"webihdaf"
.
            DISPLAY   *P64:24,"webiheaf";
            OPEN      WEBIHEA1,"webiheaf"
.
            DISPLAY   *P64:24,"webihfaf";
            OPEN      WEBIHFA1,"webihfaf"
.
            DISPLAY   *P64:24,"webihgaf";
            OPEN      WEBIHGA1,"webihgaf"
.
            DISPLAY   *P64:24,"webihhaf";
            OPEN      WEBIHHA1,"webihhaf"
          ENDIF
.
          DISPLAY   *P64:24,"webparaf";
          OPEN      WEBPARA1,"webparaf"
          OPEN      WEBPARA2,"webparaf"
.
INIT9999  RETURN
+
.*****************************************************************************
.*                                GASS0000         Called by: MAIN0000       *
.*             Get the assessment key for the report                         *
.* Returns: EXIT    0 = valid webihdaf record read                           *
.*                  1 = nothing entered or webihdaf record not found         *
.*****************************************************************************
.
GASS0000  KEYIN     *P1:3,*EF:
                    *P1:4,"Assessment key: ",*V2LON,KEY41
.
          PACK      KEY41,KEY41,SP70
          MATCH     SP70,KEY41                   * anything entered ?
          GOTO      GASS9100 IF EQUAL            * no - finished        
.
.         Use KEY41 to read the assessment header record (webihdaf)     
.
          CALL      RDWBIHD1                     * header record found ?
          BRANCH    OVRCD,GASS9100               * no - finished
.
.         Now read the participant record to get the participant name
.                   
          MOVE      "Unknown Participant                     ",WBPRNAME
          MOVE      KEY41,KEY3
          CALL      RDWBPAR1
.
          MOVE      ZERO,EXIT
          GOTO      GASS9999
.
GASS9100  MOVE      ONE,EXIT
.
GASS9999  RETURN
+
.*****************************************************************************
.*                               PRIN0000                                    *
.*                  Process the records for printing                         *
.*****************************************************************************
.
PRIN0000  MOVE      ZERO,CPAGENO
          MOVE      ZERO,CNOUNDLN
          CALL      IBACLOCK
.
          CALL      WBID0000                * print assessment heading
          CALL      WBIE0000                * print med event details
          CALL      WBIF0000                * print med service details
          CALL      WBIG0000                * print hf event details
          CALL      WBIH0000                * print hf service details
.
          PRINT     *N,*1,"*** End of Report ***"
          DISPLAY   *P1:24,*EL,"Report printed.  ";
          CALL      HITENTER
.
PRIN9999  RETURN
+
.*****************************************************************************
.*                            WBID0000                                       *
.*                       Print page heading (webihdaf details)               *
.*****************************************************************************
.
WBID0000  CALL      HEAD132                      * display page header
.
          PRINT     *N,*40,"Account Reference ID: ",WBIKARID
.
          COMPARE   ONE,CPAGENO                  * first page ?
          GOTO      WBID9999 IF NOT EQUAL        * no
.
.         For first page only, print claim header details
.
          PRINT     *N,*1,"Claim Assessment"
          CALL      LINE0000                     * draw line across page
.
          MOVE      WBIKFSTX,DIM40
          MOVE      WBIKRSTA,DIM40A
.
          MOVE      SP70,DIM10
          RJUSTIFY  WBIKCPAM
          UNPACK    WBIKCPAM,DIM7,DIM2
          PACK      DIM10,DIM7,DOT,DIM2
.
          MOVE      SP70,DIM10A
          RJUSTIFY  WBIKEXAM
          UNPACK    WBIKEXAM,DIM7,DIM2
          PACK      DIM10A,DIM7,DOT,DIM2
.
          MOVE      SP70,DIM10B
          RJUSTIFY  WBIKTBAM
          UNPACK    WBIKTBAM,DIM7,DIM2
          PACK      DIM10B,DIM7,DOT,DIM2
.
          MOVE      SP70,DIM10C
          RJUSTIFY  WBIKTCAM
          UNPACK    WBIKTCAM,DIM7,DIM2
          PACK      DIM10C,DIM7,DOT,DIM2
.
.
          PRINT     *1,PIPE,*3,"Participant          : ",WBIKFBID,*30,WBPRNAME:
                    *76,PIPE,*78,"Fund Reference ID  : ",WBIKFRID,*132,PIPE,*N:
                    *1,PIPE,*3,"Fund Status Code     : ",WBIKFSCD:
                    *76,PIPE,*78,"Claim Trans. ID    : ",WBIKFTID,*132,PIPE,*N:
                    *1,PIPE,*3,"Claim Fund Assm.Code : ",WBIKCFAC:
                    *76,PIPE,*78,"CoPayment Amount   : ",DIM10,*132,PIPE,*N:
                    *1,PIPE,*3,"Fund Status Text     : ",WBIKFSTX,*132,PIPE,*N:
                    *1,PIPE,*3,"Transaction Status   : ",WBIKSTAT,*132,PIPE,*N:
                    *1,PIPE,*3,"IHCW Report Status   : ",WBIKRSTA,*132,PIPE,*N:
                    *1,PIPE,*3,"Excess Amount        : ",DIM10A:
                    *76,PIPE,*78,"Facility ID        : ",WBIKFCID,*132,PIPE,*N:
                    *1,PIPE,*3,"Total Benefit Amount : ",DIM10B,*132,PIPE,*N:
                    *1,PIPE,*3,"Total Charge Amount  : ",DIM10C,*132,PIPE
.
          CALL      LINE0000                     * draw line across page
.
WBID9999  RETURN
+
.*****************************************************************************
.*                               WBIE0000                                    *
.*                  Process the claim assessment details for printing        *
.*****************************************************************************
.
.         Print the claim assessment details
.
WBIE0000  IF        CPAGENO = 1
            PRINT     *N,*1,"Claim Assessment Details"
          ELSE
            PRINT     *N,*1,"Claim Assessment Details (contd.)"
          ENDIF
.
          CALL      LINE0000                     * draw line across page
.
          PRINT     *1,PIPE,*3,"Clm Counter",*20,PIPE,*22,"Element Name":
                    *82,PIPE,*84,"Message Part ID",*132,PIPE
.
          CALL      LINE0000                     * draw line across page
.
          IF        CPAGENO = 1
            MOVE      TWENTY1,CLNO               * initialise line count
          ELSE
            MOVE      TEN2,CLNO                  * initialise line count
          ENDIF
.
          PACK      KEY43,WBIKFBID,WBIKARID,WBIKFRID,WBIKRPTC,SP70
          CALL      RSWBIHE1                     * position on remittance
WBIE0500  CALL      RKWBIHE1                     * read next record
          BRANCH    OVRCD,WBIE9500               * eof - finished
.
          MATCH     WBIKFBID,WBILFBID            * same participant still ?
          GOTO      WBIE9500 IF NOT EQUAL        * no - finished
.
          MATCH     WBIKARID,WBILARID            * same Account Reference ID ?
          GOTO      WBIE9500 IF NOT EQUAL        * no - finished
.
          MATCH     WBIKFRID,WBILFRID            * same fund ref ID ?
          GOTO      WBIE9500 IF NOT EQUAL        * no - finished
.
          MATCH     WBIKRPTC,WBILRPTC            * same report counter ?
          GOTO      WBIE9500 IF NOT EQUAL        * no - finished
.
.         A valid record has been found, so print it
.
          COMPARE   SIXTY,CLNO                   * page full ?
          CALL      WBIE0000 IF NOT LESS         * yes
.
          CALL      DLIN0000                     * print assessment details line
          GOTO      WBIE0500                     * get next record
.
WBIE9500  CALL      LINE0000                     * draw line across page
.
WBIE9999  RETURN
+
.*****************************************************************************
.*                            DLIN0000                                       *
.*                  Valid assessment details record so print it              *
.*****************************************************************************
.
DLIN0000  PRINT     *1,PIPE,*3,WBILCACN,*20,PIPE,*22,WBILELNM:
                    *82,PIPE,*84,WBILMPID,*132,PIPE
.
          ADD       ONE,CLNO                     * increment line count
.
DLIN9999  RETURN
+
.*****************************************************************************
.*                            LINE0000                                       *
.*                      Draw line across page                                *
.*****************************************************************************
.
LINE0000  PRINT     "*-----------------------------------------------":
                    "------------------------------------------------":
                    "-----------------------------------*"
.
LINE9999  RETURN
+
.*****************************************************************************
.*                               WBIG0000                                    *
.*                  Process the service assessment  details for printing     *
.*****************************************************************************
.
.         Print the service assessment details
.
WBIG0000  IF        CPAGENO = 1
            PRINT     *N,*1,"Service Assessment Details"
          ELSE
            PRINT     *N,*1,"Service Assessment Details (contd.)"
          ENDIF
.
          CALL      LINE0000                     * draw line across page
.
          PRINT     *1,PIPE,*3,"Srv Counter",*15,PIPE,*17,"Charge Amount":
                    *30,PIPE,*32,"Service Code":
                    *44,PIPE,*46,"Service Desc",*132,PIPE,*N:
                    *1,PIPE,*3,"From Date",*15,PIPE,*17,"No of Serv":
                    *30,PIPE,*32,"Fund Bene Am":
                    *44,PIPE,*46,"Service Date":
                    *61,PIPE,*63,"To Date",*132,PIPE
.
          CALL      LINE0000                     * draw line across page
.
          IF        CPAGENO = 1
            MOVE      TWENTY1,CLNO               * initialise line count
          ELSE
            MOVE      TEN2,CLNO                  * initialise line count
          ENDIF
.
          PACK      KEY41,WBIKFBID,WBIKARID,WBIKFRID,WBIKRPTC,SP70
          CALL      RSWBIHG1                     * position on remittance
WBIG0500  CALL      RKWBIHG1                     * read next record
          BRANCH    OVRCD,WBIG9500               * eof - finished
.
          MATCH     WBIKFBID,WBIOFBID            * same participant still ?
          GOTO      WBIG9500 IF NOT EQUAL        * no - finished
.
          MATCH     WBIKARID,WBIOARID            * same Account Reference ID ?
          GOTO      WBIG9500 IF NOT EQUAL        * no - finished
.
          MATCH     WBIKFRID,WBIOFRID            * same fund ref ID ?
          GOTO      WBIG9500 IF NOT EQUAL        * no - finished
.
          MATCH     WBIKRPTC,WBIORPTC            * same report counter ?
          GOTO      WBIG9500 IF NOT EQUAL        * no - finished
.
.         A valid record has been found, so print it
.
          COMPARE   SIXTY,CLNO                   * page full ?
          CALL      WBIG0000 IF NOT LESS         * yes
.
          CALL      GLIN0000                     * print assessment details line
          GOTO      WBIG0500                     * get next record
.
WBIG9500  CALL      LINE0000                     * draw line across page
.
WBIG9999  RETURN
+
.*****************************************************************************
.*                               WBIF0000                                    *
.*                  Process the claim assessment exp det for printing        *
.*****************************************************************************
.
.         Print the claim assessment explanation details

WBIF0000  IF        CPAGENO = 1
            PRINT     *N,*1,"Claim Assessment Explanation Details"
          ELSE
            PRINT     *N,*1,"Claim Assessment Explanation Details (contd.)"
          ENDIF
.
          CALL      LINE0000                     * draw line across page
.
          PRINT     *1,PIPE,*3,"Clm Counter",*20,PIPE,*22,"Exp Counter":
                    *37,PIPE,*39,"Exp Code",*49,PIPE,*51,"Explanation Text":
                    *132,PIPE
.
          CALL      LINE0000                     * draw line across page
.
          IF        CPAGENO = 1
            MOVE      TWENTY1,CLNO               * initialise line count
          ELSE
            MOVE      TEN2,CLNO                  * initialise line count
          ENDIF
.
          PACK      KEY45,WBIKFBID,WBIKARID,WBIKFRID,WBIKRPTC,SP70
          CALL      RSWBIHF1                     * position on remittance
WBIF0500  CALL      RKWBIHF1                     * read next record
          BRANCH    OVRCD,WBIF9500               * eof - finished
.
          MATCH     WBIKFBID,WBINFBID            * same participant still ?
          GOTO      WBIF9500 IF NOT EQUAL        * no - finished
.
          MATCH     WBIKARID,WBINARID            * same Account Reference ID ?
          GOTO      WBIF9500 IF NOT EQUAL        * no - finished
.
          MATCH     WBIKFRID,WBINFRID            * same claim ID ?
          GOTO      WBIF9500 IF NOT EQUAL        * no - finished
.
          MATCH     WBIKRPTC,WBINRPTC            * same report counter ?
          GOTO      WBIF9500 IF NOT EQUAL        * no - finished
.
.         A valid record has been found, so print it
.
          COMPARE   SIXTY,CLNO                   * page full ?
          CALL      WBIF0000 IF NOT LESS         * yes
.
          CALL      FLIN0000                     * print assessment details line
          GOTO      WBIF0500                     * get next record
.
WBIF9500  CALL      LINE0000                     * draw line across page
.
WBIF9999  RETURN
+
.*****************************************************************************
.*                            FLIN0000                                       *
.*                  Valid assessment details record so print it              *
.*****************************************************************************
.
FLIN0000  PRINT     *1,PIPE,*3,WBINCACN,*20,PIPE,*22,WBINEXCN:
                    *37,PIPE,*39,WBINEXCD,*49,PIPE,*51,WBINEXTX:
                    *132,PIPE
.
          ADD       ONE,CLNO                     * increment line count
.
FLIN9999  RETURN
+
.*****************************************************************************
.*                            GLIN0000                                       *
.*                  Valid assessment details record so print it              *
.*****************************************************************************
.
GLIN0000  UNPACK    WBIOFDTE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,DIM10
.
          UNPACK    WBIOSDTE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,DIM10A
.
          UNPACK    WBIOTDTE,CCENT,CYEAR,CMON,CDAY
          CALL      PACDATE
          MOVE      CPCDATE,DIM10B
.
          MOVE      SP70,DIM10C
          RJUSTIFY  WBIOCAMT
          UNPACK    WBIOCAMT,DIM7,DIM2
          PACK      DIM10C,DIM7,DOT,DIM2
.
          MOVE      SP70,DIM10D
          RJUSTIFY  WBIOFBAM
          UNPACK    WBIOFBAM,DIM7,DIM2
          PACK      DIM10D,DIM7,DOT,DIM2
.
          PRINT     *1,PIPE,*3,WBIOSECN,*15,PIPE,*17,DIM10C:
                    *30,PIPE,*32,WBIOSCOD:
                    *44,PIPE,*46,WBIOSDSC,*132,PIPE,*N:
                    *1,PIPE,*3,DIM10,*15,PIPE,*17,WBIONOSV:
                    *30,PIPE,*32,DIM10D:
                    *44,PIPE,*46,DIM10A:
                    *61,PIPE,*63,DIM10B,*132,PIPE
.
          ADD       TWO,CLNO                     * increment line count
.
GLIN9999  RETURN
+
.*****************************************************************************
.*                               WBIH0000                                    *
.*                  Process the medicare event details for printing          *
.*****************************************************************************
.
.         Print the service assessment details
.
WBIH0000  IF        CPAGENO = 1
            PRINT     *N,*1,"Service Assessment Explanation Details"
          ELSE
            PRINT     *N,*1,"Service Assessment Explanation Details (contd.)"
          ENDIF
.
          CALL      LINE0000                     * draw line across page
.
          PRINT     *1,PIPE,*3,"Srv Counter",*20,PIPE,*22,"Exp Counter":
                    *37,PIPE,*39,"Exp Code",*49,PIPE,*51,"Explanation Text":
                    *132,PIPE
.
          CALL      LINE0000                     * draw line across page
.
          IF        CPAGENO = 1
            MOVE      TWENTY1,CLNO               * initialise line count
          ELSE
            MOVE      TEN2,CLNO                  * initialise line count
          ENDIF
.UPTOHERE
          PACK      KEY45,WBIKFBID,WBIKARID,WBIKFRID,WBIKRPTC,SP70
          CALL      RSWBIHH1                     * position on remittance
WBIH0500  CALL      RKWBIHH1                     * read next record
          BRANCH    OVRCD,WBIH9500               * eof - finished
.
          MATCH     WBIKFBID,WBIPFBID            * same participant still ?
          GOTO      WBIH9500 IF NOT EQUAL        * no - finished
.
          MATCH     WBIKARID,WBIPARID            * same Account Reference ID ?
          GOTO      WBIH9500 IF NOT EQUAL        * no - finished
.
          MATCH     WBIKFRID,WBIPFRID            * same claim ID ?
          GOTO      WBIH9500 IF NOT EQUAL        * no - finished
.
          MATCH     WBIKRPTC,WBIPRPTC            * same report counter ?
          GOTO      WBIH9500 IF NOT EQUAL        * no - finished
.
.         A valid record has been found, so print it
.
          COMPARE   SIXTY,CLNO                   * page full ?
          CALL      WBIH0000 IF NOT LESS         * yes
.
          CALL      HLIN0000                     * print assessment details line
          GOTO      WBIH0500                     * get next record
.
WBIH9500  CALL      LINE0000                     * draw line across page
.
WBIH9999  RETURN
+
.*****************************************************************************
.*                            HLIN0000                                       *
.*                  Valid assessment details record so print it              *
.*****************************************************************************
.
HLIN0000  PRINT     *1,PIPE,*3,WBIPSECN,*20,PIPE,*22,WBIPEXCN:
                    *37,PIPE,*39,WBIPEXCD,*49,PIPE,*51,WBIPEXTX:
                    *132,PIPE
.
          ADD       ONE,CLNO                     * increment line count
.
HLIN9999  RETURN
+
..*****************************************************************************
..*                            PRSH0000                                       *
..*                       Print page heading (pmseshaf details)               *
..*****************************************************************************
..
.PRSH0000  PRINT     *N,*1,"Claimed Services Summary"
..
.          CALL      LINE0000                     * draw line across page
..
.          PRINT     *1,PIPE,*3,"Service",*14,PIPE,*16,"Charge",*27,PIPE:
.                    *29,"Fund",*40,PIPE,*42,"Medicare",*53,PIPE:
.                    *55,"Medicare",*67,PIPE,*69,"Service Fund",*132,PIPE,*N:
..
.                    *1,PIPE,*3,"Date",*14,PIPE,*16,"Amount ($)",*27,PIPE:
.                    *29,"Benefit",*40,PIPE,*42,"Benefit",*53,PIPE:
.                    *55,"Explanation",*67,PIPE,*69,"Assessment",*132,PIPE,*N:
..
.                    *1,PIPE,*14,PIPE,*27,PIPE,*29,"Amount ($)",*40,PIPE:
.                    *42,"Amount ($)",*53,PIPE,*55,"Code",*67,PIPE:
.                    *69,"Code",*132,PIPE
..
.          CALL      LINE0000                     * draw line across page
..
.PRSH1000  PACK      KEY40,PRAHFBID,PRAHARID,PRAHCLID,PRAHRPTC,SP70
.          CALL      RSPRESH1                     * position on claim
.PRSH1500  CALL      RKPRESH1                     * read next record
.          BRANCH    OVRCD,PRSH9500               * eof - finished
..
.          MATCH     PRAHFBID,PRSHFBID            * same participant still ?
.          GOTO      PRSH9500 IF NOT EQUAL        * no - finished
..
.          MATCH     PRAHARID,PRSHARID            * same Account Reference ID ?
.          GOTO      PRSH9500 IF NOT EQUAL        * no - finished
..
.          MATCH     PRAHCLID,PRSHCLID            * same claim ID ?
.          GOTO      PRSH9500 IF NOT EQUAL        * no - finished
..
.          MATCH     PRAHRPTC,PRSHRPTC            * same report counter ?
.          GOTO      PRSH9500 IF NOT EQUAL        * no - finished
..
..         A valid record has been found, so print it
..
.          CALL      DSLN0000                     * print assessment details line
.          GOTO      PRSH1500                     * get next record
..
.PRSH9500  CALL      LINE0000                     * draw line across page
..
.PRSH9999  RETURN
.+
..*****************************************************************************
..*                               PRSD0000                                    *
..*                  Process the services details for printing                *
..*****************************************************************************
..
.PRSD0000  PRINT     *N,*1,"Claimed Services Details"
..
.          CALL      LINE0000                     * draw line across page
..
.          PRINT     *1,PIPE,*3,"Item",*10,PIPE,*12,"Service Fund":
.                    *29,PIPE,*31,"Service Fund",*132,PIPE,*N:
.                    *1,PIPE,*3,"Number",*10,PIPE,*12,"Explanation Code":
.                    *29,PIPE,*31,"Explanation Text",*132,PIPE
..
.          CALL      LINE0000                     * draw line across page
..
.PRSD1000  PACK      KEY47,PRAHFBID,PRAHARID,PRAHCLID,PRAHRPTC,SP70
.          CALL      RSPRESD1                     * position on service details
.PRSD0500  CALL      RKPRESD1                     * read next record
.          BRANCH    OVRCD,PRSD9500               * eof - finished
..
.          MATCH     PRAHFBID,PRSDFBID            * same participant still ?
.          GOTO      PRSD9500 IF NOT EQUAL        * no - finished
..
.          MATCH     PRAHARID,PRSDARID            * same Account Reference ID ?
.          GOTO      PRSD9500 IF NOT EQUAL        * no - finished
..
.          MATCH     PRAHCLID,PRSDCLID            * same claim ID ?
.          GOTO      PRSD9500 IF NOT EQUAL        * no - finished
..
.          MATCH     PRAHRPTC,PRSDRPTC            * same report counter ?
.          GOTO      PRSD9500 IF NOT EQUAL        * no - finished
..
..         A valid record has been found, so print it
..
.          CALL      DSDL0000                     * print services details line
.          GOTO      PRSD0500                     * get next record
..
.PRSD9500  CALL      LINE0000                     * draw line across page
..
.PRSD9999  RETURN
.+
..*****************************************************************************
..*                            DSLN0000                                       *
..*                  Valid claim services record so print it                  *
..*****************************************************************************
..
.DSLN0000  UNPACK    PRSHCAMT,DIM7,DIM2
.          PACK      DIM10A,DIM7,DOT,DIM2
.          MOVE      DIM10A,FORM7P2
.          IF        FORM7P2 = 0
.            PACK      DIM10A,SP6,ZERO,DOT,ZERO,ZERO
.          ELSE
.            MOVE    FORM7P2,DIM10A
.          ENDIF
..
.          UNPACK    PRSHFBAM,DIM7,DIM2
.          PACK      DIM10B,DIM7,DOT,DIM2
.          MOVE      DIM10B,FORM7P2
.          IF        FORM7P2 = 0
.            PACK      DIM10B,SP6,ZERO,DOT,ZERO,ZERO
.          ELSE
.            MOVE    FORM7P2,DIM10B
.          ENDIF
..
.          UNPACK    PRSHMBAM,DIM7,DIM2
.          PACK      DIM10C,DIM7,DOT,DIM2
.          MOVE      DIM10C,FORM7P2
.          IF        FORM7P2 = 0
.            PACK      DIM10C,SP6,ZERO,DOT,ZERO,ZERO
.          ELSE
.            MOVE    FORM7P2,DIM10C
.          ENDIF
..
.          UNPACK    PRSHSDTE,CCENT,CYEAR,CMON,CDAY
.          CALL      PACDATE
..
.          PRINT     *1,PIPE,*3,CPCDATE,*14,PIPE,*16,DIM10A,*27,PIPE,*29,DIM10B:
.                    *40,PIPE,*42,DIM10C,*53,PIPE,*55,PRSHMEXC,*67,PIPE:
.                    *69,PRSHSFAC,*132,PIPE
..
.          ADD       ONE,CLNO                     * increment line count
..
.DSLN9999  RETURN
.+
..*****************************************************************************
..*                            DSDL0000                                       *
..*            Valid claim services detail record so print it                 *
..*****************************************************************************
..
.DSDL0000  PRINT     *1,PIPE,*3,PRSDITMN,*10,PIPE,*12,PRSDSFEC:
.                   *29,PIPE,*31,PRSDSFET,*132,PIPE
..
.          ADD       ONE,CLNO                     * increment line count
..
.DSDL9999  RETURN
.+
. =========================================================================
.         I/O Includes
. =========================================================================
.
          INC       STD001IO
.
          INC       WEBPARIO/INC
          INC       WEBIHDIO/INC
          INC       WEBIHEIO/INC
          INC       WEBIHFIO/INC
          INC       WEBIHGIO/INC
          INC       WEBIHHIO/INC
+
