.------------------------------------------------------------
. Outpatient Booking Field
.V12.00.01 11/11/2025 Zumin Yu      TSK 0969239
.          Modified OOSE0500 & OOSE0600 to resolve the 12PM time display issue
. V9.03.02 19/09/2003 Ebon Clements CAR 22361  
.          Added new fileds OSESSHNO and OSESSDAT
. V9.03.01 26/08/2003 Ebon Clements CAR 41801
.          Added new filed OSESCTYP
.------------------------------------------------------------
OOSE0000  BRANCH    FLDITMNO,OOSE0100,OOSE0200,OOSE0300,OOSE0400,OOSE0500:
                             OOSE0600,OOSE0700,OOSE0800,OOSE0900,OOSE1000:
                             OOSE1100,OOSE1200,OOSE1300,OOSE1400,OOSE1500:
                             OOSE1600,OOSE1700,OOSE1800,OOSE1900,OOSE2000:
                             OOSE2100,OOSE2200
.
OOSE0100  REP       " +",SESSKEYS
          UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
          WRITE     HTMLFILE;LINKPRG,".pbl?reportno=",LINKREP:
                                 "&template=",LINKTEM:
                                 "&sesskeys=",SESSKEYS;
          REP       "+ ",SESSKEYS
          GOTO      OOSE9999
.
OOSE0200  WRITE     HTMLFILE;OSTDESC;
          GOTO      OOSE9999
.
OOSE0300  WRITE     HTMLFILE;OCTDESC;
          GOTO      OOSE9999
.
OOSE0400  UNPACK    OSEDATE,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OOSE9999
.
OOSE0500  UNPACK    OMASTART,DIMHRS,KEY1,DIMMIN
          MOVE      DIMHRS,F2
          IF        F2>=12
            IF        F2>12
              SUB       "12",F2
            ENDIF
            WRITE     HTMLFILE;F2,KEY1,DIMMIN," pm";
          ELSE
            WRITE     HTMLFILE;F2,KEY1,DIMMIN," am";
          ENDIF
          GOTO      OOSE9999
.
OOSE0600  UNPACK    OMAEND,DIMHRS,KEY1,DIMMIN
          MOVE      DIMHRS,F2
          IF        F2>=12
            IF        F2>12
              SUB       "12",F2
            ENDIF
            WRITE     HTMLFILE;F2,KEY1,DIMMIN," pm";
          ELSE
            WRITE     HTMLFILE;F2,KEY1,DIMMIN," am";
          ENDIF
          GOTO      OOSE9999
.
OOSE0700  LOAD      DAYNAM3,OSEDAY,MON,TUE,WED,THU,FRI,SAT,SUN
          WRITE     HTMLFILE;DAYNAM3;
          GOTO      OOSE9999
.
OOSE0800  WRITE     HTMLFILE;OSESLOTS;
          GOTO      OOSE9999
.
OOSE0900  WRITE     HTMLFILE;OSESLOTB;
          GOTO      OOSE9999
.
OOSE1000  WRITE     HTMLFILE;OSETIMES;
          GOTO      OOSE9999
.
OOSE1100  WRITE     HTMLFILE;OSETIMEU;
          GOTO      OOSE9999
.
OOSE1200  WRITE     HTMLFILE;OSEBNEW;
          GOTO      OOSE9999
.
OOSE1300  WRITE     HTMLFILE;OSEBRV;
          GOTO      OOSE9999
.
OOSE1400  WRITE     HTMLFILE;OSEBSPC;
          GOTO      OOSE9999
.
OOSE1500  WRITE     HTMLFILE;OSEANEW;
          GOTO      OOSE9999
.
OOSE1600  WRITE     HTMLFILE;OSEARV;
          GOTO      OOSE9999
.
OOSE1700  WRITE     HTMLFILE;OSEASPC;
          GOTO      OOSE9999
.
OOSE1800  WRITE     HTMLFILE;OMACOM1;
          GOTO      OOSE9999
.
OOSE1900  MOVE      "CI",CATEGORY
          MOVE      OMACIND,CODE
          CALL      CODITM00
          GOTO      OOSE9999
.
OOSE2000  WRITE     HTMLFILE;OSESCTYP;
          GOTO      OOSE9999
.
OOSE2100  WRITE     HTMLFILE;OSESSHNO;
          GOTO      OOSE9999
.
OOSE2200  MATCH     SP70,OSESSDAT
          GOTO      OOSE9999 IF EQUAL
.
          UNPACK    OSESSDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      OOSE9999
.
OOSE9999  RETURN
.
