.-------------------------------------------------------
          INC       STDGENDF     * Required Include
.
VERSION   INIT      "V12.01.00"
.-------------------------------------------------------
. V9.04.01  13.04.2005 Peter Vela CAR 59696
.           Recompiled for SISUAFD
. V9.02.00  03.05.2002  Glenn Saunders
.           Export to new release i.e. v9.02 from vf.09
.-------------------------------------------------------
. VF.09.B02 15.11.2000 Charles Handaya
.           Recompiled (Modification of Warehouse Security)
. VF.09.B01 31.10.2000 Sandra Barcham
.           Added ABN Number & GST Registered
.-------------------------------------------------------
. VF.01.01  18.05.2000 Charles Handaya
.           Add new item and painted it on screen
.-------------------------------------------------------
. VF.00.02  05.01.2000 Charles Handaya
.           Recompiled for APSMASIO change
.           22.12.1999 Charles Handaya
.           Recompiled for Fixing Audit Date (CCYYMMDD)
. VF.00.01  02.09.1999 Sandra Barcham
.           Add in Creditor Keyword Search
.           srf 631485
.-------------------------------------------------------
.@@@@@ Start of Generated Code @@@@@
. NB - Code & Comments Included Before the above line 
.      will not be overwritten by the generation of a 
.      program. The STDGENDF file and VERSION must appear
.      before the line. 
.-----------------------------------------
.   Program       :   IBASIN19
.   Function      :   Supplier Enquiries                      
.   Generated  On :   13/12/2005
.-----------------------------------------
.=========================
.File Description Includes
.-------------------------
          INC       APSCIOFD/INC
          INC       APSCNTFD/INC
          INC       APSCTSFD/INC
          INC       APSIMSFD/INC
          INC       APSISLFD/INC
          INC       APSMASFD/INC
          INC       APSMXRFD/INC
          INC       APSORDFD/INC
          INC       APSPPDFD/INC
          INC       APSSNTFD/INC
          INC       APSSUBFD/INC
          INC       FMSCODFD/INC
          INC       GPHSTDDF    
          INC       IBAPASFD/INC
          INC       SINCCAFD/INC
          INC       SINCIAFD/INC
          INC       SINCICFD/INC
          INC       SINCIDFD/INC
          INC       SINCODFD/INC
          INC       SINCONFD/INC
          INC       SINFACFD/INC
          INC       SINNATFD/INC
          INC       SINORIFD/INC
          INC       SINPERFD/INC
          INC       SINPOAFD/INC
          INC       SINPOCFD/INC
          INC       SINPODFD/INC
          INC       SINSUAFD/INC
          INC       SINTMPDF/INC
          INC       SINTRNFD/INC
          INC       SINWARFD/INC
.=========================
.Local Variable Definition
.-------------------------
CRDNAM80  DIM      80 * Scr 00 Fld    47
CRDADD80  DIM      80 * Scr 00 Fld    48
AMTWRK00  FORM     12.2 * Scr 00 Fld    49
OFFSDESC  DIM      20 * Scr 00 Fld    57
AMTOUT00  FORM     12.2 * Scr 00 Fld    58
AMTOUT30  FORM     12.2 * Scr 00 Fld    59
AMTOUT60  FORM     12.2 * Scr 00 Fld    60
AMTOUT90  FORM     12.2 * Scr 00 Fld    61
AMTOUT99  FORM     12.2 * Scr 00 Fld    62
UDDESC1   DIM      20 * Scr 00 Fld    63
UDDESC2   DIM      20 * Scr 00 Fld    64
CURJDAY   FORM      3 * Scr 00 Fld    65
CURJYEAR  FORM      4 * Scr 00 Fld    66
WRKJDAY   FORM      3 * Scr 00 Fld    67
WRKJYEAR  FORM      4 * Scr 00 Fld    68
SUPNAM80  DIM      80 * Scr 00 Fld    69
SUPADD80  DIM      80 * Scr 00 Fld    70
NOTEAPSN  DIM      15 * Scr 00 Fld    81
NOTEAPCN  DIM      15 * Scr 00 Fld    82
.
.Word Processor File * Scr 01 Fld    71
.
NAMAPCN1  INIT      "Wapcn1"
FILAPCN1  DIM       8
.
.
.Word Processor File * Scr 01 Fld    72
.
NAMAPSN1  INIT      "Wapsn1"
FILAPSN1  DIM       8
.
FINYEAR   DIM       4 * Scr 02 Fld     1
ACTPER01  FORM     12.2 * Scr 02 Fld    14
ACTPER02  FORM     12.2 * Scr 02 Fld    15
ACTPER03  FORM     12.2 * Scr 02 Fld    16
ACTPER04  FORM     12.2 * Scr 02 Fld    17
ACTPER05  FORM     12.2 * Scr 02 Fld    18
ACTPER06  FORM     12.2 * Scr 02 Fld    19
ACTPER07  FORM     12.2 * Scr 02 Fld    20
ACTPER08  FORM     12.2 * Scr 02 Fld    21
ACTPER09  FORM     12.2 * Scr 02 Fld    22
ACTPER10  FORM     12.2 * Scr 02 Fld    23
ACTPER11  FORM     12.2 * Scr 02 Fld    24
ACTPER12  FORM     12.2 * Scr 02 Fld    25
ACTPERXX  FORM     12.2 * Scr 02 Fld    26
BUDPER01  FORM     12.2 * Scr 02 Fld    27
BUDPER02  FORM     12.2 * Scr 02 Fld    28
BUDPER03  FORM     12.2 * Scr 02 Fld    29
BUDPER04  FORM     12.2 * Scr 02 Fld    30
BUDPER05  FORM     12.2 * Scr 02 Fld    31
BUDPER06  FORM     12.2 * Scr 02 Fld    32
BUDPER07  FORM     12.2 * Scr 02 Fld    33
BUDPER08  FORM     12.2 * Scr 02 Fld    34
BUDPER09  FORM     12.2 * Scr 02 Fld    35
BUDPER10  FORM     12.2 * Scr 02 Fld    36
BUDPER11  FORM     12.2 * Scr 02 Fld    37
BUDPER12  FORM     12.2 * Scr 02 Fld    38
BUDPERXX  FORM     12.2 * Scr 02 Fld    39
VARPER01  FORM     12.2 * Scr 02 Fld    40
VARPER02  FORM     12.2 * Scr 02 Fld    41
VARPER03  FORM     12.2 * Scr 02 Fld    42
VARPER04  FORM     12.2 * Scr 02 Fld    43
VARPER05  FORM     12.2 * Scr 02 Fld    44
VARPER06  FORM     12.2 * Scr 02 Fld    45
VARPER07  FORM     12.2 * Scr 02 Fld    46
VARPER08  FORM     12.2 * Scr 02 Fld    47
VARPER09  FORM     12.2 * Scr 02 Fld    48
VARPER10  FORM     12.2 * Scr 02 Fld    49
VARPER11  FORM     12.2 * Scr 02 Fld    50
VARPER12  FORM     12.2 * Scr 02 Fld    51
VARPERXX  FORM     12.2 * Scr 02 Fld    52
ACTPER13  FORM     12.2 * Scr 02 Fld    58
BUDPER13  FORM     12.2 * Scr 02 Fld    59
VARPER13  FORM     12.2 * Scr 02 Fld    60
.
.    Multi Item Key Fields Scr 03 Fld     6
.-------------------------------------------------------
APIM6NAM  INIT      "APIM6"
APIM6END  FORM      1   * End Display
APIM6SNO  FORM      5   * Number of Items on the Screen
APIM6MKY  DIM       127 * Match Key 
APIM6EKY  DIM       127 * End Key
APIM6SKY  DIM       127 * Start Key
APIM6IDX  INIT      " 132 UC1-5"
APIM6FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
APIM6FNM  DIM       8  * Filename
APIM6CNT  FORM      3  * Number of Items on Screen
DOCTYPE   DIM       4 * Scr 03 Fld     9
OUTSTTOT  FORM     12.2 * Scr 03 Fld    11
DUMMY     DIM       1 * Scr 03 Fld    20
.
.    Multi Item Key Fields Scr 04 Fld     1
.-------------------------------------------------------
APCI2NAM  INIT      "APCI2"
APCI2END  FORM      1   * End Display
APCI2SNO  FORM      5   * Number of Items on the Screen
APCI2MKY  DIM       127 * Match Key 
APCI2EKY  DIM       127 * End Key
APCI2SKY  DIM       127 * Start Key
APCI2IDX  INIT      " 132 UC1-5"
APCI2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
APCI2FNM  DIM       8  * Filename
APCI2CNT  FORM      3  * Number of Items on Screen
ORDTOTAL  FORM     12.2 * Scr 04 Fld     5
SCRTOTAL  FORM     12.2 * Scr 04 Fld     6
ORDSTAT   DIM       6 * Scr 04 Fld     9
CHEQUEYN  FORM      1 * Scr 05 Fld     1
DOCREFER  DIM      15 * Scr 05 Fld     2
.
.    Multi Item Key Fields Scr 05 Fld     3
.-------------------------------------------------------
APIM4NAM  INIT      "APIM4"
APIM4END  FORM      1   * End Display
APIM4SNO  FORM      5   * Number of Items on the Screen
APIM4MKY  DIM       127 * Match Key 
APIM4EKY  DIM       127 * End Key
APIM4SKY  DIM       127 * Start Key
APIM4IDX  INIT      " 132 UC1-5"
APIM4FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
APIM4FNM  DIM       8  * Filename
APIM4CNT  FORM      3  * Number of Items on Screen
DOCTOTAL  FORM     12.2 * Scr 05 Fld    10
.
.    Multi Item Key Fields Scr 06 Fld     1
.-------------------------------------------------------
APIM2NAM  INIT      "APIM2"
APIM2END  FORM      1   * End Display
APIM2SNO  FORM      5   * Number of Items on the Screen
APIM2MKY  DIM       127 * Match Key 
APIM2EKY  DIM       127 * End Key
APIM2SKY  DIM       127 * Start Key
APIM2IDX  INIT      " 132 UC1-5"
APIM2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
APIM2FNM  DIM       8  * Filename
APIM2CNT  FORM      3  * Number of Items on Screen
INVREFER  DIM      15 * Scr 07 Fld     1
.
.    Multi Item Key Fields Scr 07 Fld     2
.-------------------------------------------------------
APIM3NAM  INIT      "APIM3"
APIM3END  FORM      1   * End Display
APIM3SNO  FORM      5   * Number of Items on the Screen
APIM3MKY  DIM       127 * Match Key 
APIM3EKY  DIM       127 * End Key
APIM3SKY  DIM       127 * Start Key
APIM3IDX  INIT      " 132 UC1-5"
APIM3FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
APIM3FNM  DIM       8  * Filename
APIM3CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 08 Fld     1
.-------------------------------------------------------
SIIC3NAM  INIT      "SIIC3"
SIIC3END  FORM      1   * End Display
SIIC3SNO  FORM      5   * Number of Items on the Screen
SIIC3MKY  DIM       127 * Match Key 
SIIC3EKY  DIM       127 * End Key
SIIC3SKY  DIM       127 * Start Key
SIIC3IDX  INIT      " 132 UC1-5"
SIIC3FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIIC3FNM  DIM       8  * Filename
SIIC3CNT  FORM      3  * Number of Items on Screen
.
.    Multi Item Key Fields Scr 09 Fld     3
.-------------------------------------------------------
SIPA2NAM  INIT      "SIPA2"
SIPA2END  FORM      1   * End Display
SIPA2SNO  FORM      5   * Number of Items on the Screen
SIPA2MKY  DIM       127 * Match Key 
SIPA2EKY  DIM       127 * End Key
SIPA2SKY  DIM       127 * Start Key
SIPA2IDX  INIT      " 132 UC1-5"
SIPA2FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIPA2FNM  DIM       8  * Filename
SIPA2CNT  FORM      3  * Number of Items on Screen
ORDDTOT   DIM      12 * Scr 09 Fld    10
TRANSSTA  DIM      20 * Scr 09 Fld    28
.
.    Multi Item Key Fields Scr 14 Fld     1
.-------------------------------------------------------
SIPC1NAM  INIT      "SIPC1"
SIPC1END  FORM      1   * End Display
SIPC1SNO  FORM      5   * Number of Items on the Screen
SIPC1MKY  DIM       127 * Match Key 
SIPC1EKY  DIM       127 * End Key
SIPC1SKY  DIM       127 * Start Key
SIPC1IDX  INIT      " 132 UC1-5"
SIPC1FL1  IFILE     SQL, FIXED=132, KEY="U1-5"
SIPC1FNM  DIM       8  * Filename
SIPC1CNT  FORM      3  * Number of Items on Screen
UNITCOST  DIM      14 * Scr 14 Fld    14
CONFDESC  DIM      30 * Scr 14 Fld    50
MESSDESC  DIM      30 * Scr 14 Fld    51
.
.Word Processor File * Scr 15 Fld    41
.
NAMSIPD1  INIT      "Wsipd1"
FILSIPD1  DIM       8
.
TRANSST2  DIM      40 * Scr 16 Fld     3
SUSPDESC  DIM      25 * Scr 20 Fld     9
UDC1DESC  DIM      30 * Scr 20 Fld    29
UDC2DESC  DIM      30 * Scr 20 Fld    30
NOTESIID  DIM       5 * Scr 20 Fld    31
.
.Word Processor File * Scr 20 Fld    32
.
NAMSIID1  INIT      "Wsiid1"
FILSIID1  DIM       8
.
ISSLCOST  FORM     12.6 * Scr 20 Fld    36
ISSCCOST  FORM     12.6 * Scr 20 Fld    37
.
ACCEPT    FORM      1
SACCEPT   FORM      1
.
PRGID     INIT      "IBASIN19"
PRGNAM    INIT      "Supplier Enquiries                      "
.
.--------------------------------
. MAINLINE - Controlling Logic
.--------------------------------
          TOPIC     PRGID
          MOVE      PORT,PARENTID
          CLOCK     PORT,DIM2
          MOVE      DIM2,PORT
ML0000
          CALL      INIT0000
          CALL      RDCON000
          CALL      SC00L000
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPCN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILAPSN1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CLOSE     SIIC3FL1,DELETE
.
          CLOSE     SIPA2FL1,DELETE
.
          CLOSE     SIPC1FL1,DELETE
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIPD1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      TEMPWORD,FILSIID1
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     TEMPWORD,DELETE
          ENDIF
          CHAIN     PGM
.---------------------------------------
. INIT - Open Files & Display Heading
.---------------------------------------
INIT0000  CALL      DISPHEAD
          MOVE      ONE,CCENTRY
          MOVE      ONE,CCANLDTE
          MOVE      ONE,CDEFDTE
          MOVE      ZERO,CHIGHLT
          DISPLAY   *P56:24,"Opening controlf";
          OPEN      CONTROLF,"controlf"
          DISPLAY   *P56:24,"Opening scrsbga1";
          OPEN      SCRSBGA1,"scrsbgaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA1,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrpsta1";
          OPEN      SCRPSTA2,"scrpstaf"
          DISPLAY   *P56:24,"Opening scrslta1";
          OPEN      SCRSLTA1,"scrsltaf"
          DISPLAY   *P56:24,"Opening apscntaf";
          OPEN      APSCNTA1,"apscntaf"
          DISPLAY   *P56:24,"Opening apsctsaf";
          OPEN      APSCTSA1,"apsctsaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA1,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA2,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmasaf";
          OPEN      APSMASA3,"apsmasaf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA1,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsmxraf";
          OPEN      APSMXRA2,"apsmxraf"
          DISPLAY   *P56:24,"Opening apsppdaf";
          OPEN      APSPPDA1,"apsppdaf"
          DISPLAY   *P56:24,"Opening apssntaf";
          OPEN      APSSNTA1,"apssntaf"
          DISPLAY   *P56:24,"Opening apssubaf";
          OPEN      APSSUBA1,"apssubaf"
          DISPLAY   *P56:24,"Opening  fmscodaf           ";
          OPEN      FMSCODA1,"fmscodaf"          
          DISPLAY   *P56:24,"Opening  ihapassf           ";
          OPEN      IHAPASS1,"ihapassf"          
          DISPLAY   *P56:24,"Opening sinccaaf";
          OPEN      SINCCAA1,"sinccaaf"
          DISPLAY   *P56:24,"Opening sinciaaf";
          OPEN      SINCIAA1,"sinciaaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA1,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA2,"sincicaf"
          DISPLAY   *P56:24,"Opening sincicaf";
          OPEN      SINCICA3,"sincicaf"
          DISPLAY   *P56:24,"Opening sincidaf";
          OPEN      SINCIDA1,"sincidaf"
          DISPLAY   *P56:24,"Opening sincodaf";
          OPEN      SINCODA1,"sincodaf"
          DISPLAY   *P56:24,"Opening sinfacaf";
          OPEN      SINFACA1,"sinfacaf"
          DISPLAY   *P56:24,"Opening sinoriaf";
          OPEN      SINORIA1,"sinoriaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA1,"sinperaf"
          DISPLAY   *P56:24,"Opening sinperaf";
          OPEN      SINPERA2,"sinperaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA1,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA2,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA3,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpoaaf";
          OPEN      SINPOAA4,"sinpoaaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA1,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA3,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA6,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpocaf";
          OPEN      SINPOCA8,"sinpocaf"
          DISPLAY   *P56:24,"Opening sinpodaf";
          OPEN      SINPODA1,"sinpodaf"
          DISPLAY   *P56:24,"Opening sinsuaaf";
          OPEN      SINSUAA1,"sinsuaaf"
          DISPLAY   *P56:24,"Opening sintrnaf";
          OPEN      SINTRNA1,"sintrnaf"
          DISPLAY   *P56:24,"Opening sintrnaf";
          OPEN      SINTRNA2,"sintrnaf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA1,"sinwaraf"
          DISPLAY   *P56:24,"Opening sinwaraf";
          OPEN      SINWARA2,"sinwaraf"
.--------------------------------------------------------
. Initialise Wp Filename for Creditor Notes                     
.--------------------------------------------------------
          PACK      FILAPCN1,NAMAPCN1,PORT
          REP       " 0",FILAPCN1
          DISPLAY   *P56:24,"Create & Open ",FILAPCN1;
          PREP      TEMPWORD,FILAPCN1
.
.--------------------------------------------------------
. Initialise Wp Filename for Supplier Notes                     
.--------------------------------------------------------
          PACK      FILAPSN1,NAMAPSN1,PORT
          REP       " 0",FILAPSN1
          DISPLAY   *P56:24,"Create & Open ",FILAPSN1;
          PREP      TEMPWORD,FILAPSN1
.
.--------------------------------------------------------
. Initialise Batch Screen Invoice Reference                  
.--------------------------------------------------------
          MOVE     ZERO,APIM6SNO
          MOVE     "03    6",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APIM6SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Date Order Received                
.--------------------------------------------------------
          MOVE     ZERO,APCI2SNO
          MOVE     "04    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APCI2SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Invoice Reference                  
.--------------------------------------------------------
          MOVE     ZERO,APIM4SNO
          MOVE     "05    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APIM4SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Invoice Date                       
.--------------------------------------------------------
          MOVE     ZERO,APIM2SNO
          MOVE     "06    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APIM2SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Document Reference                 
.--------------------------------------------------------
          MOVE     ZERO,APIM3SNO
          MOVE     "07    2",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,APIM3SNO
            ENDIF
          ENDIF
.--------------------------------------------------------
. Initialise Batch Screen Catalog Code                       
.--------------------------------------------------------
          MOVE     ZERO,SIIC3SNO
          MOVE     "08    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIIC3SNO
            ENDIF
          ENDIF
          PACK      SIIC3FNM,ANST,SIIC3NAM,PORT
          REP       " 0",SIIC3FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIIC3FL1,SIIC3FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIIC3FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIIC3FNM,SIIC3IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIIC3FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIIC3FL1,SIIC3FNM
.--------------------------------------------------------
. Initialise Batch Screen Date Input                         
.--------------------------------------------------------
          MOVE     ZERO,SIPA2SNO
          MOVE     "09    3",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIPA2SNO
            ENDIF
          ENDIF
          PACK      SIPA2FNM,ANST,SIPA2NAM,PORT
          REP       " 0",SIPA2FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIPA2FL1,SIPA2FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIPA2FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIPA2FNM,SIPA2IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIPA2FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIPA2FL1,SIPA2FNM
.--------------------------------------------------------
. Initialise Batch Screen Item Number                        
.--------------------------------------------------------
          MOVE     ZERO,SIPC1SNO
          MOVE     "14    1",KEY7
          PACK     KEY15,PRGID,KEY7,SP70
          PACK     KEY20,PRGID,KEY7,SP70
          CALL     RSSCPS2
          CALL     RKSCPS2
          IF       OVRCD=0
            PACK     KEY20,SCPSPID,SCPSSID,SCPSITM
            MATCH    KEY15,KEY20
            IF       @EQUAL
              MOVE     SCPSNOR,SIPC1SNO
            ENDIF
          ENDIF
          PACK      SIPC1FNM,ANST,SIPC1NAM,PORT
          REP       " 0",SIPC1FNM
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF IO
          OPEN      SIPC1FL1,SIPC1FNM
          TRAPCLR   IO
          IF        OVRCD=0
            CLOSE     SIPC1FL1,DELETE
          ENDIF
          PACK      KEY80,SGENISB,SIPC1FNM,SIPC1IDX
          DISPLAY   *P1:3;
          DISPLAY   *P56:24,"Create & Open ",SIPC1FNM;
          EXECUTE   KEY80,TASKID
          OPEN      SIPC1FL1,SIPC1FNM
.--------------------------------------------------------
. Initialise Wp Filename for Purchase Order Item Comments       
.--------------------------------------------------------
          PACK      FILSIPD1,NAMSIPD1,PORT
          REP       " 0",FILSIPD1
          DISPLAY   *P56:24,"Create & Open ",FILSIPD1;
          PREP      TEMPWORD,FILSIPD1
.
.--------------------------------------------------------
. Initialise Wp Filename for Catalog/Supplier Notes             
.--------------------------------------------------------
          PACK      FILSIID1,NAMSIID1,PORT
          REP       " 0",FILSIID1
          DISPLAY   *P56:24,"Create & Open ",FILSIID1;
          PREP      TEMPWORD,FILSIID1
.
INIT9999  DISPLAY   *P1:24,*EL;
          RETURN
.
.------------------------------------
. Called for Print Screen Routine 
.------------------------------------
PRTSVARS
          MATCH     "00",SCRID
          IF         @EQUAL
            CALL       PS00L000   * Selections                         
          ENDIF
          MATCH     "01",SCRID
          IF         @EQUAL
            CALL       PS01L000   * Static Details                     
          ENDIF
          MATCH     "02",SCRID
          IF         @EQUAL
            CALL       PS02L000   * Purchasing Analysis                
          ENDIF
          MATCH     "03",SCRID
          IF         @EQUAL
            CALL       PS03L000   * Outstanding Invoice Details        
          ENDIF
          MATCH     "04",SCRID
          IF         @EQUAL
            CALL       PS04L000   * Orders Received Not Invoiced       
          ENDIF
          MATCH     "05",SCRID
          IF         @EQUAL
            CALL       PS05L000   * Search for Creditors Document      
          ENDIF
          MATCH     "06",SCRID
          IF         @EQUAL
            CALL       PS06L000   * Accounts Payable Transaction Detail
          ENDIF
          MATCH     "07",SCRID
          IF         @EQUAL
            CALL       PS07L000   * Invoice Reference Search           
          ENDIF
          MATCH     "08",SCRID
          IF         @EQUAL
            CALL       PS08L000   * Display Releated Catalog Codes     
          ENDIF
          MATCH     "09",SCRID
          IF         @EQUAL
            CALL       PS09L000   * Order History                      
          ENDIF
          MATCH     "14",SCRID
          IF         @EQUAL
            CALL       PS14L000   * Purchase Order Detail Display      
          ENDIF
          MATCH     "15",SCRID
          IF         @EQUAL
            CALL       PS15L000   * Purchase Order Detail Item         
          ENDIF
          MATCH     "16",SCRID
          IF         @EQUAL
            CALL       PS16L000   * Transmission Details               
          ENDIF
          MATCH     "20",SCRID
          IF         @EQUAL
            CALL       PS20L000   * Catalog Details                    
          ENDIF
          RETURN
.--------------------------------
. Screen - Selections                         
.--------------------------------
SC00L000
SC00L100
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC00L200
          CALL      CF00L000 * Clear Fields
          CALL      ONAT0000
SC00L300
          CALL      KY00L000 * Enter Key Fields
          BRANCH    EXIT,SC00L999,SC00L999
SC00L400
          CALL      WP00L000 * Load any WP Details
SC00L500
          CALL      LM00L000 * Load any Batch Details
SC00L600
          CALL      DF00L000 * Display Fields
SC00L700
          CALL      SF00L000 * Select Fields
          BRANCH    EXIT,SC00L100,SC00L100,SC00L200
SC00L800
SC00L900
SC00L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Selections                         
.-------------------------------------------------------
CF00L000  COMPARE   ZERO,ACCEPT
              GOTO      CF00L999 IF EQUAL
          MOVE      SP70,APMACRD 
          MOVE      SP70,APMATYP 
          MOVE      SP70,APMASKY 
          MOVE      SP70,APMACN1 
          MOVE      SP70,APMACN2 
          MOVE      SP70,APMACA1 
          MOVE      SP70,APMACA2 
          MOVE      SP70,APMACA3 
          MOVE      SP70,APMACPC 
          MOVE      SP70,APMACTEL
          MOVE      SP70,APMACFAX
          MOVE      SP70,APMACMOD
          MOVE      SP70,APMACEDI
          MOVE      SP70,APMACON 
          MOVE      SP70,APMASN1 
          MOVE      SP70,APMASN2 
          MOVE      SP70,APMASA1 
          MOVE      SP70,APMASA2 
          MOVE      SP70,APMASA3 
          MOVE      SP70,APMASPC 
          MOVE      SP70,APMASTEL
          MOVE      SP70,APMASFAX
          MOVE      SP70,APMASMOD
          MOVE      SP70,APMASEDI
          MOVE      SP70,APMASCON
          MOVE      SP70,APMABSB 
          MOVE      SP70,APMABAC 
          MOVE      SP70,APMAPNM 
          MOVE      ZERO,APMAPPT 
          MOVE      ZERO,APMAPOT 
          MOVE      ZERO,APMAHOR 
          MOVE      ZERO,APMAHIN 
          MOVE      ZERO,APMAHCR 
          MOVE      ZERO,APMAHPY 
          MOVE      SP70,APMAPPD 
          MOVE      SP70,APMADTM 
          MOVE      SP70,APMAUR1 
          MOVE      SP70,APMAUR2 
          MOVE      SP70,APMAUD1 
          MOVE      SP70,APMAUD2 
          MOVE      SP70,APMAUC1 
          MOVE      SP70,APMAUC2 
          MOVE      ZERO,APMAGREG
          MOVE      ZERO,APMAUY2 
          MOVE      ZERO,APMADIS 
          MOVE      SP70,APCTDESC
          MOVE      SP70,CRDNAM80
          MOVE      SP70,CRDADD80
          MOVE      ZERO,AMTWRK00
          MOVE      SP70,APPPDES 
          MOVE      ZERO,APPPDA1 
          MOVE      ZERO,APPPPE1 
          MOVE      ZERO,APPPDA2 
          MOVE      ZERO,APPPPE2 
          MOVE      ZERO,APPPDA3 
          MOVE      ZERO,APPPPE3 
          MOVE      SP70,OFFSDESC
          MOVE      ZERO,AMTOUT00
          MOVE      ZERO,AMTOUT30
          MOVE      ZERO,AMTOUT60
          MOVE      ZERO,AMTOUT90
          MOVE      ZERO,AMTOUT99
          MOVE      SP70,UDDESC1 
          MOVE      SP70,UDDESC2 
          MOVE      ZERO,CURJDAY 
          MOVE      ZERO,CURJYEAR
          MOVE      ZERO,WRKJDAY 
          MOVE      ZERO,WRKJYEAR
          MOVE      SP70,SUPNAM80
          MOVE      SP70,SUPADD80
          MOVE      SP70,NOTEAPSN
          MOVE      SP70,NOTEAPCN
CF00L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Selections                         
.--------------------------------------------------------
KY00L000
.
KY00L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      ECRED000
          BRANCH    EXIT,KY00L900,KY00L900
          MOVE      ZERO,ACCEPT
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY00L999
.
KY00L900  MOVE      ONE,EXIT
KY00L999  RETURN
.---------------------------------------------------------
. Load WP files for : Selections                         
.---------------------------------------------------------
WP00L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Selections                         
.---------------------------------------------------------
LM00L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Selections                         
.---------------------------------------------------------
DF00L000
          BRANCH   ACCEPT,DF00L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF00L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF00L900
          MATCH    PRGID,SCPSPID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF00L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF00L010 IF NOT EQUAL
.
          CALL     PS00L000 * Display Field
          GOTO     DF00L010
DF00L900
DF00L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Selections                         
.---------------------------------------------------------
PS00L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS00L999,PS00L101,PS00L102,PS00L103:
                            PS00L104,PS00L105,PS00L106,PS00L107:
                            PS00L108,PS00L109,PS00L110,PS00L111:
                            PS00L112,PS00L113,PS00L114,PS00L115:
                            PS00L116,PS00L117,PS00L118,PS00L119:
                            PS00L120,PS00L121,PS00L122,PS00L123:
                            PS00L124,PS00L125,PS00L126,PS00L127:
                            PS00L128,PS00L129,PS00L130,PS00L131:
                            PS00L132,PS00L133,PS00L134,PS00L135:
                            PS00L136,PS00L137,PS00L138,PS00L139:
                            PS00L140,PS00L141,PS00L142,PS00L143:
                            PS00L144,PS00L145,PS00L146,PS00L147:
                            PS00L148,PS00L149,PS00L150,PS00L151:
                            PS00L152,PS00L153,PS00L154,PS00L155:
                            PS00L156,PS00L157,PS00L158,PS00L159:
                            PS00L160,PS00L161,PS00L162,PS00L163:
                            PS00L164,PS00L165,PS00L166,PS00L167:
                            PS00L168,PS00L169,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L999,PS00L999,PS00L999,PS00L999:
                            PS00L170,PS00L171,PS00L999,PS00L999
          GOTO     PS00L999
.
PS00L101
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L102
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L103
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L104
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L105
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L106
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L107
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L108
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L109
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L110
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L111
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L112
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L113
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L114
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L115
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L116
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L117
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L118
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L119
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L120
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L121
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L122
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L123
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L124
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L125
          MOVE      APMABSB,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L126
          MOVE      APMABAC,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L127
          MOVE      APMAPNM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L128
          MOVE      APMAPPT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L129
          MOVE      APMAPOT,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L130
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L134
          MOVE      APMAPPD,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L135
          MOVE      APMADTM,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L136
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L137
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L138
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L139
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L140
          MOVE      APMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L141
          MOVE      APMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L144
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L145
          MOVE      APCTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L146
          MOVE      CRDNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L147
          MOVE      CRDADD80,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L148
          MOVE      AMTWRK00,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L149
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L150
          MOVE      APPPDA1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L151
          MOVE      APPPPE1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L152
          MOVE      APPPDA2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L153
          MOVE      APPPPE2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L154
          MOVE      APPPDA3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L155
          MOVE      APPPPE3,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L156
          MOVE      OFFSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L157
          MOVE      AMTOUT00,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L158
          MOVE      AMTOUT30,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L159
          MOVE      AMTOUT60,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L160
          MOVE      AMTOUT90,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L161
          MOVE      AMTOUT99,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L162
          MOVE      UDDESC1,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L163
          MOVE      UDDESC2,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L164
          MOVE      CURJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L165
          MOVE      CURJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L166
          MOVE      WRKJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L167
          MOVE      WRKJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L168
          MOVE      SUPNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L169
          MOVE      SUPADD80,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L170
          MOVE      NOTEAPSN,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
.
PS00L171
          MOVE      NOTEAPCN,VAR     
          CALL      DISPITEM
          GOTO     PS00L999
PS00L999
          RETURN
.---------------------------------------------------------
. Selections for : Selections                         
.---------------------------------------------------------
SF00L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF00L001  BRANCH   ACCEPT,SF00L020
.
SF00L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L006,SF00L006:
                            SF00L006,SF00L006,SF00L101,SF00L102:
                            SF00L103,SF00L104,SF00L105,SF00L106:
                            SF00L107,SF00L108,SF00L109,SF00L006:
                            SF00L006,SF00L006,SF00L110,SF00L111
SF00L006  BEEP
          GOTO     SF00L005
SF00L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF00L090
          MATCH    PRGID,SCSLPID
          GOTO     SF00L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF00L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020:
                            SF00L020,SF00L020,SF00L020,SF00L020
          GOTO     SF00L020
SF00L090  MOVE     ZERO,ACCEPT
          GOTO     SF00L001
.
SF00L101
          MOVE      ZERO,EXIT
          GOTO      SF00L999
.
SF00L102
          MOVE      ONE,EXIT
          GOTO      SF00L999
.
SF00L103
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC01L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L104
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC02L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L105
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC03L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L106
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC04L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC05L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L108
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC06L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L109
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC07L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L110
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC08L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
.
SF00L111
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC09L000
          MOVE      "00",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF00L001
SF00L990  MOVE      ONE,EXIT * Exit Char Restart
SF00L999  RETURN
.--------------------------------
. Screen - Static Details                     
.--------------------------------
SC01L000
SC01L100
          MOVE      "01",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   80",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      SBACK000 * Display Background
.
SC01L200
          CALL      CF01L000 * Clear Fields
SC01L300
          CALL      KY01L000 * Enter Key Fields
          BRANCH    EXIT,SC01L999,SC01L999
SC01L400
          CALL      WP01L000 * Load any WP Details
SC01L500
          CALL      LM01L000 * Load any Batch Details
SC01L600
          CALL      DF01L000 * Display Fields
SC01L700
          CALL      SF01L000 * Select Fields
          BRANCH    EXIT,SC01L100,SC01L100,SC01L200
SC01L800
SC01L900
SC01L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Static Details                     
.-------------------------------------------------------
CF01L000
CF01L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Static Details                     
.--------------------------------------------------------
KY01L000
          MOVE      ZERO,EXIT
          GOTO      KY01L999
.
KY01L900  MOVE      ONE,EXIT
KY01L999  RETURN
.---------------------------------------------------------
. Load WP files for : Static Details                     
.---------------------------------------------------------
WP01L000
          PREP     TEMPWORD,FILAPCN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPCN1 
          IF        OVRCD=0
            CALL      RPAPCN1 
          ENDIF
WP01L100
          CALL     RKAPCN1 
          BRANCH   OVRCD,WP01L105
          PACK     KEY8,APCNCRD,APCNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP01L105 IF NOT EQUAL
          PACK     VAR,APCNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APCNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L100
WP01L105  CLOSE    TEMPWORD
          PREP     TEMPWORD,FILAPSN1
          PACK     KEY8,APMACRD,SP70
          MOVE     KEY8,SAVKEY80
          SETLPTR  SAVKEY80,5 
          CALL      RDAPSN1 
          IF        OVRCD=0
            CALL      RPAPSN1 
          ENDIF
WP01L110
          CALL     RKAPSN1 
          BRANCH   OVRCD,WP01L115
          PACK     KEY8,APSNCRD,APSNLIN
          MATCH    SAVKEY80,KEY8    
          GOTO     WP01L115 IF NOT EQUAL
          PACK     VAR,APSNDAT,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     APSNDAT,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP01L110
WP01L115  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Static Details                     
.---------------------------------------------------------
LM01L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Static Details                     
.---------------------------------------------------------
DF01L000
          BRANCH   ACCEPT,DF01L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF01L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF01L900
          MATCH    PRGID,SCPSPID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF01L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF01L010 IF NOT EQUAL
.
          CALL     PS01L000 * Display Field
          GOTO     DF01L010
DF01L900
DF01L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Static Details                     
.---------------------------------------------------------
PS01L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS01L101,PS01L102,PS01L103,PS01L104:
                            PS01L105,PS01L106,PS01L107,PS01L108:
                            PS01L109,PS01L110,PS01L111,PS01L112:
                            PS01L113,PS01L114,PS01L115,PS01L116:
                            PS01L117,PS01L118,PS01L119,PS01L120:
                            PS01L121,PS01L122,PS01L123,PS01L124:
                            PS01L125,PS01L126,PS01L127,PS01L128:
                            PS01L129,PS01L130,PS01L131,PS01L132:
                            PS01L133,PS01L134,PS01L135,PS01L999:
                           PS01L136,PS01L137,PS01L138,PS01L139:
                            PS01L140,PS01L141,PS01L142,PS01L143:
                            PS01L144,PS01L145,PS01L146,PS01L147:
                            PS01L148,PS01L149,PS01L150,PS01L151:
                            PS01L152,PS01L153,PS01L154,PS01L155:
                            PS01L156,PS01L157,PS01L158,PS01L159:
                            PS01L160,PS01L161,PS01L162,PS01L163:
                            PS01L164,PS01L165,PS01L166,PS01L167:
                            PS01L168,PS01L169,PS01L170,PS01L171:
                            PS01L172,PS01L173,PS01L999,PS01L999:
                           PS01L999,PS01L999,PS01L999,PS01L999
          GOTO     PS01L999
.
PS01L101
          MOVE      APMACRD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L102
          MOVE      APMATYP,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L103
          MOVE      APMASKY,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L104
          MOVE      APMACN1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L105
          MOVE      APMACN2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L106
          MOVE      APMACA1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L107
          MOVE      APMACA2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L108
          MOVE      APMACA3,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L109
          MOVE      APMACPC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L110
          MOVE      APMACTEL,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L111
          MOVE      APMACFAX,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L112
          MOVE      APMACMOD,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L113
          MOVE      APMACEDI,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L114
          MOVE      APMACON,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L115
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L116
          MOVE      APMASN2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L117
          MOVE      APMASA1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L118
          MOVE      APMASA2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L119
          MOVE      APMASA3,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L120
          MOVE      APMASPC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L121
          MOVE      APMASTEL,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L122
          MOVE      APMASFAX,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L123
          MOVE      APMASMOD,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L124
          MOVE      APMASEDI,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L125
          MOVE      APMASCON,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L126
          MOVE      APMABSB,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L127
          MOVE      APMABAC,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L128
          MOVE      APMAPNM,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L129
          MOVE      APMAPPT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L130
          MOVE      APMAPOT,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L131
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHOR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L132
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHIN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L133
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHCR,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L134
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAHPY,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L135
          MOVE      APMAPPD,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L136
          MOVE      APMAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L137
          MOVE      APMAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L138
          UNPACK    APMAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L139
          UNPACK    APMAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L140
          MOVE      APMAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L141
          MOVE      APMAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L142
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L143
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L144
          MOVE      APMADIS,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L145
          MOVE      APCTDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L146
          MOVE      CRDNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L147
          MOVE      CRDADD80,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L148
          MOVE      AMTWRK00,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L149
          MOVE      APPPDES,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L150
          MOVE      APPPDA1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L151
          MOVE      APPPPE1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L152
          MOVE      APPPDA2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L153
          MOVE      APPPPE2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L154
          MOVE      APPPDA3,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L155
          MOVE      APPPPE3,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L156
          MOVE      OFFSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L157
          MOVE      AMTOUT00,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L158
          MOVE      AMTOUT30,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L159
          MOVE      AMTOUT60,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L160
          MOVE      AMTOUT90,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L161
          MOVE      AMTOUT99,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L162
          MOVE      UDDESC1,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L163
          MOVE      UDDESC2,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L164
          MOVE      CURJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L165
          MOVE      CURJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L166
          MOVE      WRKJDAY,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L167
          MOVE      WRKJYEAR,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L168
          MOVE      SUPNAM80,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L169
          MOVE      SUPADD80,VAR     
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L170
          MOVE     FILAPCN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
.
PS01L171
          MOVE     FILAPSN1,WORDNAME
          CALL     DISPWORD
          GOTO     PS01L999
.
PS01L172
          MOVE      APMAABN,VAR      
          CALL      DISPITEM
          GOTO     PS01L999
.
PS01L173
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      APMAGREG,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS01L999
PS01L999
          RETURN
.---------------------------------------------------------
. Selections for : Static Details                     
.---------------------------------------------------------
SF01L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF01L001  BRANCH   ACCEPT,SF01L020
.
SF01L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                            SF01L006,SF01L006,SF01L101,SF01L102:
                            SF01L006,SF01L006,SF01L006,SF01L006:
                           SF01L006,SF01L006,SF01L103,SF01L006
SF01L006  BEEP
          GOTO     SF01L005
SF01L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF01L090
          MATCH    PRGID,SCSLPID
          GOTO     SF01L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF01L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                            SF01L020,SF01L020,SF01L101,SF01L102:
                            SF01L020,SF01L020,SF01L020,SF01L020:
                           SF01L020,SF01L020,SF01L020,SF01L020
          GOTO     SF01L020
SF01L090  MOVE     ZERO,ACCEPT
          GOTO     SF01L001
.
SF01L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPCN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPCN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF01L001
.
SF01L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 5",SCPSROW
              MOVE     "  5",SCPSCOL
              MOVE     " 72",SCPSLEN
              MOVE     "16",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILAPSN1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILAPSN1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF01L001
.
SF01L103
          MOVE      ZERO,EXIT
          GOTO      SF01L999
SF01L990  MOVE      ONE,EXIT * Exit Char Restart
SF01L999  RETURN
.--------------------------------
. Screen - Purchasing Analysis                
.--------------------------------
SC02L000
SC02L100
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   53",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 5",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC02L200
          CALL      CF02L000 * Clear Fields
SC02L300
          CALL      KY02L000 * Enter Key Fields
          BRANCH    EXIT,SC02L999,SC02L999
SC02L400
          CALL      WP02L000 * Load any WP Details
SC02L500
          CALL      LM02L000 * Load any Batch Details
SC02L600
          CALL      DF02L000 * Display Fields
SC02L700
          CALL      SF02L000 * Select Fields
          BRANCH    EXIT,SC02L100,SC02L100,SC02L200
SC02L800
SC02L900
SC02L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchasing Analysis                
.-------------------------------------------------------
CF02L000
CF02L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchasing Analysis                
.--------------------------------------------------------
KY02L000
.
KY02L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EPYR0000
          BRANCH    EXIT,KY02L900,KY02L900
          MOVE      ZERO,ACCEPT
          MOVE      FINYEAR,VAR      
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY02L999
.
KY02L900  MOVE      ONE,EXIT
KY02L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchasing Analysis                
.---------------------------------------------------------
WP02L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchasing Analysis                
.---------------------------------------------------------
LM02L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchasing Analysis                
.---------------------------------------------------------
DF02L000
          BRANCH   ACCEPT,DF02L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF02L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF02L900
          MATCH    PRGID,SCPSPID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF02L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF02L010 IF NOT EQUAL
.
          CALL     PS02L000 * Display Field
          GOTO     DF02L010
DF02L900
DF02L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchasing Analysis                
.---------------------------------------------------------
PS02L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS02L999,PS02L101,PS02L102,PS02L103:
                            PS02L104,PS02L105,PS02L106,PS02L107:
                            PS02L108,PS02L109,PS02L110,PS02L111:
                            PS02L112,PS02L113,PS02L114,PS02L115:
                            PS02L116,PS02L117,PS02L118,PS02L119:
                            PS02L120,PS02L121,PS02L122,PS02L123:
                            PS02L124,PS02L125,PS02L126,PS02L127:
                            PS02L128,PS02L129,PS02L130,PS02L131:
                            PS02L132,PS02L133,PS02L134,PS02L135:
                            PS02L136,PS02L137,PS02L138,PS02L139:
                            PS02L140,PS02L141,PS02L142,PS02L143:
                            PS02L144,PS02L145,PS02L146,PS02L147:
                            PS02L148,PS02L149,PS02L150,PS02L151:
                            PS02L999,PS02L999,PS02L999,PS02L999:
                            PS02L152,PS02L153,PS02L154,PS02L155
          GOTO     PS02L999
.
PS02L101
          MOVE      HAPER1,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L102
          MOVE      HAPER2,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L103
          MOVE      HAPER3,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L104
          MOVE      HAPER4,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L105
          MOVE      HAPER5,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L106
          MOVE      HAPER6,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L107
          MOVE      HAPER7,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L108
          MOVE      HAPER8,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L109
          MOVE      HAPER9,VAR       
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L110
          MOVE      HAPER10,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L111
          MOVE      HAPER11,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L112
          MOVE      HAPER12,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L113
          MOVE      ACTPER01,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L114
          MOVE      ACTPER02,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L115
          MOVE      ACTPER03,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L116
          MOVE      ACTPER04,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L117
          MOVE      ACTPER05,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L118
          MOVE      ACTPER06,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L119
          MOVE      ACTPER07,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L120
          MOVE      ACTPER08,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L121
          MOVE      ACTPER09,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L122
          MOVE      ACTPER10,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L123
          MOVE      ACTPER11,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L124
          MOVE      ACTPER12,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L125
          MOVE      ACTPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L126
          MOVE      BUDPER01,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L127
          MOVE      BUDPER02,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L128
          MOVE      BUDPER03,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L129
          MOVE      BUDPER04,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L130
          MOVE      BUDPER05,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L131
          MOVE      BUDPER06,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L132
          MOVE      BUDPER07,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L133
          MOVE      BUDPER08,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L134
          MOVE      BUDPER09,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L135
          MOVE      BUDPER10,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L136
          MOVE      BUDPER11,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L137
          MOVE      BUDPER12,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L138
          MOVE      BUDPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L139
          MOVE      VARPER01,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L140
          MOVE      VARPER02,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L141
          MOVE      VARPER03,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L142
          MOVE      VARPER04,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L143
          MOVE      VARPER05,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L144
          MOVE      VARPER06,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L145
          MOVE      VARPER07,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L146
          MOVE      VARPER08,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L147
          MOVE      VARPER09,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L148
          MOVE      VARPER10,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L149
          MOVE      VARPER11,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L150
          MOVE      VARPER12,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L151
          MOVE      VARPERXX,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L152
          MOVE      HAPER13,VAR      
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L153
          MOVE      ACTPER13,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L154
          MOVE      BUDPER13,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
.
PS02L155
          MOVE      VARPER13,VAR     
          CALL      DISPITEM
          GOTO     PS02L999
PS02L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchasing Analysis                
.---------------------------------------------------------
SF02L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF02L001  BRANCH   ACCEPT,SF02L020
.
SF02L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L006,SF02L006,SF02L006:
                            SF02L006,SF02L101,SF02L102,SF02L103:
                            SF02L006,SF02L006,SF02L006,SF02L006
SF02L006  BEEP
          GOTO     SF02L005
SF02L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF02L090
          MATCH    PRGID,SCSLPID
          GOTO     SF02L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF02L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020:
                            SF02L020,SF02L020,SF02L020,SF02L020
          GOTO     SF02L020
SF02L090  MOVE     ZERO,ACCEPT
          GOTO     SF02L001
.
SF02L101
          MOVE      ONE,EXIT
          GOTO      SF02L999
.
SF02L102
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      GPHU0000
          MOVE      "02",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   53",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF02L001
.
SF02L103
          MOVE      ZERO,EXIT
          GOTO      SF02L999
SF02L990  MOVE      ONE,EXIT * Exit Char Restart
SF02L999  RETURN
.--------------------------------
. Screen - Outstanding Invoice Details        
.--------------------------------
SC03L000
SC03L100
          MOVE      "03",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC03L200
          CALL      CF03L000 * Clear Fields
SC03L300
          CALL      KY03L000 * Enter Key Fields
          BRANCH    EXIT,SC03L999,SC03L999
SC03L400
          CALL      WP03L000 * Load any WP Details
SC03L500
          CALL      LM03L000 * Load any Batch Details
SC03L600
          CALL      DF03L000 * Display Fields
SC03L700
          CALL      SF03L000 * Select Fields
          BRANCH    EXIT,SC03L100,SC03L100,SC03L200
SC03L800
SC03L900
SC03L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Outstanding Invoice Details        
.-------------------------------------------------------
CF03L000
CF03L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Outstanding Invoice Details        
.--------------------------------------------------------
KY03L000
.
KY03L110
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      SETSCR03
          BRANCH    EXIT,KY03L900,KY03L900
          MOVE      ZERO,ACCEPT
          MOVE      DUMMY,VAR        
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY03L999
.
KY03L900  MOVE      ONE,EXIT
KY03L999  RETURN
.---------------------------------------------------------
. Load WP files for : Outstanding Invoice Details        
.---------------------------------------------------------
WP03L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Outstanding Invoice Details        
.---------------------------------------------------------
LM03L000
.---------------------------------------------------------
. Load for :     6 Invoice Reference                  
.---------------------------------------------------------
          UNPACK    SP70,APIMOUT,APIMCRD,APIMREF,APIMDOC,APIMBCH
          PACK      KEY41,ONE,APMACRD,SP70
          MOVE      KEY41,APIM6EKY
          STRIP     APIM6SKY
          SETLPTR   APIM6EKY,6
          MOVE      APIM6EKY,APIM6SKY
          CALL      RDAPIM6 
          IF        OVRCD=0
            CALL      RPAPIM6 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP03L000
          MOVE     ZERO,APIM6CNT
          MOVE     ZERO,APIM6END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP03L600
          MATCH    PRGID,SCPSPID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP03L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP03L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP03L010,DP03L010,DP03L010,DP03L010:
                            DP03L010,DP03L101,DP03L102,DP03L103:
                            DP03L104,DP03L105,DP03L106,DP03L010:
                            DP03L010,DP03L107,DP03L108,DP03L010:
                            DP03L010,DP03L010,DP03L010,DP03L010
          GOTO      DP03L010
.
DP03L101
          IF        APIM6END=0
            CALL      RPAPIM6 
            IF        OVRCD=0
              PACK      APIM6MKY,APIMOUT,APIMCRD,APIMREF,APIMDOC,APIMBCH                                        
              MATCH     APIM6EKY,APIM6MKY
              IF        @EQUAL
                MOVE      ZERO,APIM6END
                ADD       ONE,APIM6CNT
                MOVE      APIMREF,VAR      
                CALL      DISPITEM
          CALL      TRNDET00
              ELSE
                MOVE      ONE,APIM6END
              ENDIF
            ELSE
              MOVE      ONE,APIM6END
            ENDIF
          ENDIF
          IF        APIM6END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L102
          IF        APIM6END=0
            MOVE      APIMBCH,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L103
          IF        APIM6END=0
            MOVE      APIMDOC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L104
          IF        APIM6END=0
            MOVE      DOCTYPE,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L105
          IF        APIM6END=0
            UNPACK    APIMPDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L106
          IF        APIM6END=0
            MOVE      OUTSTTOT,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L107
          IF        APIM6END=0
            UNPACK    APIMIDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
.
DP03L108
          IF        APIM6END=0
            MOVE      APIMICM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP03L010
DP03L600
          MATCH    "APIM6",NAMSSFFI
          GOTO     DP03L605 IF NOT EQUAL
          GOTO     DP03L999
DP03L605
DP03L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP03L000
.
          MATCH    "APIM6",NAMSSFFI
          GOTO     FP03L105 IF NOT EQUAL
          PACK     KEY41,APIM6SKY,Z70
          CALL     RDAPIM6  * Start
          IF       OVRCD=0
            CALL     RPAPIM6  * Start
          ENDIF
          CALL     DP03L000
          GOTO     FP03L999
FP03L105
FP03L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP03L000
.
          MATCH    "APIM6",NAMSSFFI
          GOTO     LP03L105 IF NOT EQUAL
          PACK     KEY41,APIM6SKY,SP70
          CALL     RSAPIM6  * End
          IF       OVRCD=1
            CALL     RKAPIM6 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM6SNO
            CALL     RKAPIM6 
            IF       OVRCD=1
              MOVE     APIM6SNO,SECTOR
            ENDIF
            PACK     APIM6MKY,APIMOUT,APIMCRD,APIMREF,APIMDOC,APIMBCH                                        
            MATCH    APIM6EKY,APIM6MKY
            IF       !@EQUAL
              MOVE     APIM6SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     LP03L999
LP03L105
LP03L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP03L000
.
          MATCH    "APIM6",NAMSSFFI
          GOTO     PP03L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP03L105
          COMPARE  SECTOR,APIM6SNO
          GOTO     PP03L110 IF EQUAL
          CALL     RKAPIM6 
          BRANCH   OVRCD,PP03L115
          PACK     APIM6MKY,APIMOUT,APIMCRD,APIMREF,APIMDOC,APIMBCH                                        
          MATCH    APIM6EKY,APIM6MKY
          GOTO     PP03L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP03L105
PP03L110
          MOVE     ZERO,SECTOR
          IF       APIM6CNT=APIM6SNO
            SUB      ONE,APIM6CNT
          ENDIF
          WHILE    SECTOR<=APIM6CNT
            CALL     RKAPIM6 
            IF       OVRCD=1
              MOVE     APIM6SNO,SECTOR
            ENDIF
            PACK     APIM6MKY,APIMOUT,APIMCRD,APIMREF,APIMDOC,APIMBCH                                        
            MATCH    APIM6EKY,APIM6MKY
            IF       !@EQUAL
              MOVE     APIM6SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP03L000
          GOTO     PP03L999
PP03L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM6SNO
            CALL     RPAPIM6 
            IF       OVRCD=1
              MOVE     APIM6SNO,SECTOR
            ENDIF
            PACK     APIM6MKY,APIMOUT,APIMCRD,APIMREF,APIMDOC,APIMBCH                                        
            MATCH    APIM6EKY,APIM6MKY
            IF       !@EQUAL
              MOVE     APIM6SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP03L999
PP03L120
PP03L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP03L000
          MATCH    "APIM6",NAMSSFFI
          GOTO     NP03L115 IF NOT EQUAL
NP03L105
          CALL     RPAPIM6 
          BRANCH   OVRCD,NP03L110
          PACK     APIM6MKY,APIMOUT,APIMCRD,APIMREF,APIMDOC,APIMBCH                                        
          MATCH    APIM6EKY,APIM6MKY
          GOTO     NP03L110 IF NOT EQUAL
          CALL     RKAPIM6 
          CALL     DP03L000
          GOTO     NP03L999
NP03L110
          CALL     RKAPIM6 
          BEEP
          GOTO     NP03L999
NP03L115
NP03L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT03L000
CT03L105
CT03L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Outstanding Invoice Details        
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Outstanding Invoice Details        
.---------------------------------------------------------
DF03L000
          BRANCH   ACCEPT,DF03L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF03L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF03L900
          MATCH    PRGID,SCPSPID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF03L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF03L010 IF NOT EQUAL
.
          CALL     PS03L000 * Display Field
          GOTO     DF03L010
DF03L900
          MOVE      "APIM6",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      FP03L000
DF03L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Outstanding Invoice Details        
.---------------------------------------------------------
PS03L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS03L101,PS03L102,PS03L103,PS03L104:
                            PS03L105,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999:
                            PS03L999,PS03L999,PS03L999,PS03L999
          GOTO     PS03L999
.
PS03L101
          MOVE      AMTOUT00,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L102
          MOVE      AMTOUT30,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L103
          MOVE      AMTOUT60,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L104
          MOVE      AMTOUT90,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
.
PS03L105
          MOVE      AMTOUT99,VAR     
          CALL      DISPITEM
          GOTO     PS03L999
PS03L999
          RETURN
.---------------------------------------------------------
. Selections for : Outstanding Invoice Details        
.---------------------------------------------------------
SF03L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF03L001  BRANCH   ACCEPT,SF03L020
.
SF03L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L006:
                            SF03L006,SF03L006,SF03L006,SF03L101:
                            SF03L006,SF03L006,SF03L006,SF03L102:
                            SF03L103,SF03L104,SF03L105,SF03L006
SF03L006  BEEP
          GOTO     SF03L005
SF03L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF03L090
          MATCH    PRGID,SCSLPID
          GOTO     SF03L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF03L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020:
                            SF03L020,SF03L020,SF03L020,SF03L020
          GOTO     SF03L020
SF03L090  MOVE     ZERO,ACCEPT
          MOVE      "APIM6",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L101
          MOVE      ZERO,EXIT
          GOTO      SF03L999
.
SF03L102
          MOVE      "APIM6",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      NP03L000
          GOTO     SF03L001
.
SF03L103
          MOVE      "APIM6",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      PP03L000
          GOTO     SF03L001
.
SF03L104
          MOVE      "APIM6",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      FP03L000
          GOTO     SF03L001
.
SF03L105
          MOVE      "APIM6",NAMSSFFI
          MOVE      "    6",ITMSSFFI
          CALL      LP03L000
          GOTO     SF03L001
SF03L990  MOVE      ONE,EXIT * Exit Char Restart
SF03L999  RETURN
.--------------------------------
. Screen - Orders Received Not Invoiced       
.--------------------------------
SC04L000
SC04L100
          MOVE      "04",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC04L200
          CALL      CF04L000 * Clear Fields
SC04L300
          CALL      KY04L000 * Enter Key Fields
          BRANCH    EXIT,SC04L999,SC04L999
SC04L400
          CALL      WP04L000 * Load any WP Details
SC04L500
          CALL      LM04L000 * Load any Batch Details
SC04L600
          CALL      DF04L000 * Display Fields
SC04L700
          CALL      SF04L000 * Select Fields
          BRANCH    EXIT,SC04L100,SC04L100,SC04L200
SC04L800
SC04L900
SC04L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Orders Received Not Invoiced       
.-------------------------------------------------------
CF04L000
CF04L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Orders Received Not Invoiced       
.--------------------------------------------------------
KY04L000
.
KY04L110
          MOVE      "   15",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      SETSCR04
          BRANCH    EXIT,KY04L900,KY04L900
          MOVE      ZERO,ACCEPT
          MOVE      DUMMY,VAR        
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY04L999
.
KY04L900  MOVE      ONE,EXIT
KY04L999  RETURN
.---------------------------------------------------------
. Load WP files for : Orders Received Not Invoiced       
.---------------------------------------------------------
WP04L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Orders Received Not Invoiced       
.---------------------------------------------------------
LM04L000
.---------------------------------------------------------
. Load for :     1 Date Order Received                
.---------------------------------------------------------
          UNPACK    SP70,APCICRD,APCIDAT,APCIISC,APCIORD
          PACK      KEY21,APMACRD,SP70
          MOVE      KEY21,APCI2EKY
          STRIP     APCI2SKY
          SETLPTR   APCI2EKY,5
          MOVE      APCI2EKY,APCI2SKY
          CALL      RDAPCI2 
          IF        OVRCD=0
            CALL      RPAPCI2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP04L000
          MOVE     ZERO,APCI2CNT
          MOVE     ZERO,APCI2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP04L600
          MATCH    PRGID,SCPSPID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP04L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP04L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP04L101,DP04L102,DP04L103,DP04L104:
                            DP04L105,DP04L010,DP04L010,DP04L010:
                            DP04L106,DP04L107,DP04L010,DP04L010:
                            DP04L010,DP04L010,DP04L010
          GOTO      DP04L010
.
DP04L101
          IF        APCI2END=0
            CALL      RPAPCI2 
            IF        OVRCD=0
              PACK      APCI2MKY,APCICRD,APCIDAT,APCIISC,APCIORD                                                
              MATCH     APCI2EKY,APCI2MKY
              IF        @EQUAL
                MOVE      ZERO,APCI2END
                ADD       ONE,APCI2CNT
                UNPACK    APCIDAT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
          CALL      ORDDET00
              ELSE
                MOVE      ONE,APCI2END
              ENDIF
            ELSE
              MOVE      ONE,APCI2END
            ENDIF
          ENDIF
          IF        APCI2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L102
          IF        APCI2END=0
            MOVE      APISISC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L103
          IF        APCI2END=0
            MOVE      APISDES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L104
          IF        APCI2END=0
            MOVE      APCIORD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L105
          IF        APCI2END=0
            MOVE      ORDTOTAL,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L106
          IF        APCI2END=0
            MOVE      ORDSTAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
.
DP04L107
          IF        APCI2END=0
            MOVE      KEY8,VAR         
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP04L010
DP04L600
          MATCH    "APCI2",NAMSSFFI
          GOTO     DP04L605 IF NOT EQUAL
.
.
          MOVE      "    6",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SCRTOTAL,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     DP04L999
DP04L605
DP04L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP04L000
.
          MATCH    "APCI2",NAMSSFFI
          GOTO     FP04L105 IF NOT EQUAL
          PACK     KEY21,APCI2SKY,Z70
          CALL     RDAPCI2  * Start
          IF       OVRCD=0
            CALL     RPAPCI2  * Start
          ENDIF
          CALL     DP04L000
          GOTO     FP04L999
FP04L105
FP04L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP04L000
.
          MATCH    "APCI2",NAMSSFFI
          GOTO     LP04L105 IF NOT EQUAL
          PACK     KEY21,APCI2SKY,SP70
          CALL     RSAPCI2  * End
          IF       OVRCD=1
            CALL     RKAPCI2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APCI2SNO
            CALL     RKAPCI2 
            IF       OVRCD=1
              MOVE     APCI2SNO,SECTOR
            ENDIF
            PACK     APCI2MKY,APCICRD,APCIDAT,APCIISC,APCIORD                                                
            MATCH    APCI2EKY,APCI2MKY
            IF       !@EQUAL
              MOVE     APCI2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     LP04L999
LP04L105
LP04L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP04L000
.
          MATCH    "APCI2",NAMSSFFI
          GOTO     PP04L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP04L105
          COMPARE  SECTOR,APCI2SNO
          GOTO     PP04L110 IF EQUAL
          CALL     RKAPCI2 
          BRANCH   OVRCD,PP04L115
          PACK     APCI2MKY,APCICRD,APCIDAT,APCIISC,APCIORD                                                
          MATCH    APCI2EKY,APCI2MKY
          GOTO     PP04L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP04L105
PP04L110
          MOVE     ZERO,SECTOR
          IF       APCI2CNT=APCI2SNO
            SUB      ONE,APCI2CNT
          ENDIF
          WHILE    SECTOR<=APCI2CNT
            CALL     RKAPCI2 
            IF       OVRCD=1
              MOVE     APCI2SNO,SECTOR
            ENDIF
            PACK     APCI2MKY,APCICRD,APCIDAT,APCIISC,APCIORD                                                
            MATCH    APCI2EKY,APCI2MKY
            IF       !@EQUAL
              MOVE     APCI2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP04L000
          GOTO     PP04L999
PP04L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APCI2SNO
            CALL     RPAPCI2 
            IF       OVRCD=1
              MOVE     APCI2SNO,SECTOR
            ENDIF
            PACK     APCI2MKY,APCICRD,APCIDAT,APCIISC,APCIORD                                                
            MATCH    APCI2EKY,APCI2MKY
            IF       !@EQUAL
              MOVE     APCI2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP04L999
PP04L120
PP04L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP04L000
          MATCH    "APCI2",NAMSSFFI
          GOTO     NP04L115 IF NOT EQUAL
NP04L105
          CALL     RPAPCI2 
          BRANCH   OVRCD,NP04L110
          PACK     APCI2MKY,APCICRD,APCIDAT,APCIISC,APCIORD                                                
          MATCH    APCI2EKY,APCI2MKY
          GOTO     NP04L110 IF NOT EQUAL
          CALL     RKAPCI2 
          CALL     DP04L000
          GOTO     NP04L999
NP04L110
          CALL     RKAPCI2 
          BEEP
          GOTO     NP04L999
NP04L115
NP04L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT04L000
CT04L105
CT04L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Orders Received Not Invoiced       
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Orders Received Not Invoiced       
.---------------------------------------------------------
DF04L000
          BRANCH   ACCEPT,DF04L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF04L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF04L900
          MATCH    PRGID,SCPSPID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF04L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF04L010 IF NOT EQUAL
.
          CALL     PS04L000 * Display Field
          GOTO     DF04L010
DF04L900
          MOVE      "APCI2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP04L000
DF04L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Orders Received Not Invoiced       
.---------------------------------------------------------
PS04L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L101,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999,PS04L999:
                            PS04L999,PS04L999,PS04L999
          GOTO     PS04L999
.
PS04L101
          MOVE      SCRTOTAL,VAR     
          CALL      DISPITEM
          GOTO     PS04L999
PS04L999
          RETURN
.---------------------------------------------------------
. Selections for : Orders Received Not Invoiced       
.---------------------------------------------------------
SF04L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF04L001  BRANCH   ACCEPT,SF04L020
.
SF04L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L006,SF04L006,SF04L006,SF04L006:
                            SF04L006,SF04L006,SF04L101,SF04L006:
                            SF04L006,SF04L006,SF04L102,SF04L103:
                            SF04L104,SF04L105,SF04L006
SF04L006  BEEP
          GOTO     SF04L005
SF04L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF04L090
          MATCH    PRGID,SCSLPID
          GOTO     SF04L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF04L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020,SF04L020:
                            SF04L020,SF04L020,SF04L020
          GOTO     SF04L020
SF04L090  MOVE     ZERO,ACCEPT
          MOVE      "APCI2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L101
          MOVE      ZERO,EXIT
          GOTO      SF04L999
.
SF04L102
          MOVE      "APCI2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP04L000
          GOTO     SF04L001
.
SF04L103
          MOVE      "APCI2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP04L000
          GOTO     SF04L001
.
SF04L104
          MOVE      "APCI2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP04L000
          GOTO     SF04L001
.
SF04L105
          MOVE      "APCI2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP04L000
          GOTO     SF04L001
SF04L990  MOVE      ONE,EXIT * Exit Char Restart
SF04L999  RETURN
.--------------------------------
. Screen - Search for Creditors Document      
.--------------------------------
SC05L000
SC05L100
          MOVE      "05",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    5",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC05L200
          CALL      CF05L000 * Clear Fields
SC05L300
          CALL      KY05L000 * Enter Key Fields
          BRANCH    EXIT,SC05L999,SC05L999
SC05L400
          CALL      WP05L000 * Load any WP Details
SC05L500
          CALL      LM05L000 * Load any Batch Details
SC05L600
          CALL      DF05L000 * Display Fields
SC05L700
          CALL      SF05L000 * Select Fields
          BRANCH    EXIT,SC05L100,SC05L100,SC05L200
SC05L800
SC05L900
SC05L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Search for Creditors Document      
.-------------------------------------------------------
CF05L000
CF05L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Search for Creditors Document      
.--------------------------------------------------------
KY05L000
.
KY05L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      SETSCR05
          BRANCH    EXIT,KY05L900,KY05L900
          MOVE      ZERO,ACCEPT
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      CHEQUEYN,FORM2   
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
.
KY05L120
          MOVE      "    2",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      EDOCR000
          BRANCH    EXIT,KY05L110,KY05L900
          MOVE      ZERO,ACCEPT
          MOVE      DOCREFER,VAR     
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY05L999
.
KY05L900  MOVE      ONE,EXIT
KY05L999  RETURN
.---------------------------------------------------------
. Load WP files for : Search for Creditors Document      
.---------------------------------------------------------
WP05L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Search for Creditors Document      
.---------------------------------------------------------
LM05L000
.---------------------------------------------------------
. Load for :     3 Invoice Reference                  
.---------------------------------------------------------
          UNPACK    SP70,APIMCRD,APIMDOC,APIMREF,APIMBCH
          PACK      KEY40,APMACRD,DOCREFER,SP70
          MOVE      KEY40,APIM4EKY
          STRIP     APIM4SKY
          SETLPTR   APIM4EKY,20
          MOVE      APIM4EKY,APIM4SKY
          CALL      RDAPIM4 
          IF        OVRCD=0
            CALL      RPAPIM4 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP05L000
          MOVE     ZERO,APIM4CNT
          MOVE     ZERO,APIM4END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP05L600
          MATCH    PRGID,SCPSPID
          GOTO     DP05L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP05L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP05L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP05L010,DP05L010,DP05L101,DP05L010:
                            DP05L010,DP05L102,DP05L103,DP05L104:
                            DP05L105,DP05L106,DP05L010,DP05L010:
                           DP05L010,DP05L010,DP05L010,DP05L010:
                            DP05L010,DP05L010
          GOTO      DP05L010
.
DP05L101
          IF        APIM4END=0
            CALL      RKAPIM4 
            IF        OVRCD=0
              PACK      APIM4MKY,APIMCRD,APIMDOC,APIMREF,APIMBCH                                                
              MATCH     APIM4EKY,APIM4MKY
              IF        @EQUAL
                MOVE      ZERO,APIM4END
                ADD       ONE,APIM4CNT
                MOVE      APIMREF,VAR      
                CALL      DISPITEM
          CALL      TRNDET00
              ELSE
                MOVE      ONE,APIM4END
              ENDIF
            ELSE
              MOVE      ONE,APIM4END
            ENDIF
          ENDIF
          IF        APIM4END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L102
          IF        APIM4END=0
            UNPACK    APIMDDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L103
          IF        APIM4END=0
            UNPACK    APIMIDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L104
          IF        APIM4END=0
            MOVE      APIMBCH,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L105
          IF        APIM4END=0
            MOVE      DOCTYPE,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
.
DP05L106
          IF        APIM4END=0
            MOVE      DOCTOTAL,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP05L010
DP05L600
          MATCH    "APIM4",NAMSSFFI
          GOTO     DP05L605 IF NOT EQUAL
.
.
          MOVE      "   13",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SCRTOTAL,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     DP05L999
DP05L605
DP05L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP05L000
.
          MATCH    "APIM4",NAMSSFFI
          GOTO     FP05L105 IF NOT EQUAL
          PACK     KEY40,APIM4SKY,SP70
          CALL     RDAPIM4  * Start
          IF       OVRCD=0
            CALL     RPAPIM4  * Start
          ENDIF
          CALL     DP05L000
          GOTO     FP05L999
FP05L105
FP05L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP05L000
.
          MATCH    "APIM4",NAMSSFFI
          GOTO     LP05L105 IF NOT EQUAL
          PACK     KEY40,APIM4SKY,Z70
          CALL     RSAPIM4  * End
          IF       OVRCD=1
            CALL     RPAPIM4 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM4SNO
            CALL     RPAPIM4 
            IF       OVRCD=1
              MOVE     APIM4SNO,SECTOR
            ENDIF
            PACK     APIM4MKY,APIMCRD,APIMDOC,APIMREF,APIMBCH                                                
            MATCH    APIM4EKY,APIM4MKY
            IF       !@EQUAL
              MOVE     APIM4SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP05L000
          GOTO     LP05L999
LP05L105
LP05L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP05L000
.
          MATCH    "APIM4",NAMSSFFI
          GOTO     PP05L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP05L105
          COMPARE  SECTOR,APIM4SNO
          GOTO     PP05L110 IF EQUAL
          CALL     RPAPIM4 
          BRANCH   OVRCD,PP05L115
          PACK     APIM4MKY,APIMCRD,APIMDOC,APIMREF,APIMBCH                                                
          MATCH    APIM4EKY,APIM4MKY
          GOTO     PP05L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP05L105
PP05L110
          MOVE     ZERO,SECTOR
          IF       APIM4CNT=APIM4SNO
            SUB      ONE,APIM4CNT
          ENDIF
          WHILE    SECTOR<=APIM4CNT
            CALL     RPAPIM4 
            IF       OVRCD=1
              MOVE     APIM4SNO,SECTOR
            ENDIF
            PACK     APIM4MKY,APIMCRD,APIMDOC,APIMREF,APIMBCH                                                
            MATCH    APIM4EKY,APIM4MKY
            IF       !@EQUAL
              MOVE     APIM4SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP05L000
          GOTO     PP05L999
PP05L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM4SNO
            CALL     RKAPIM4 
            IF       OVRCD=1
              MOVE     APIM4SNO,SECTOR
            ENDIF
            PACK     APIM4MKY,APIMCRD,APIMDOC,APIMREF,APIMBCH                                                
            MATCH    APIM4EKY,APIM4MKY
            IF       !@EQUAL
              MOVE     APIM4SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP05L999
PP05L120
PP05L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP05L000
          MATCH    "APIM4",NAMSSFFI
          GOTO     NP05L115 IF NOT EQUAL
NP05L105
          CALL     RKAPIM4 
          BRANCH   OVRCD,NP05L110
          PACK     APIM4MKY,APIMCRD,APIMDOC,APIMREF,APIMBCH                                                
          MATCH    APIM4EKY,APIM4MKY
          GOTO     NP05L110 IF NOT EQUAL
          CALL     RPAPIM4 
          CALL     DP05L000
          GOTO     NP05L999
NP05L110
          CALL     RPAPIM4 
          BEEP
          GOTO     NP05L999
NP05L115
NP05L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT05L000
CT05L105
CT05L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Search for Creditors Document      
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Search for Creditors Document      
.---------------------------------------------------------
DF05L000
          BRANCH   ACCEPT,DF05L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF05L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF05L900
          MATCH    PRGID,SCPSPID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF05L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF05L010 IF NOT EQUAL
.
          CALL     PS05L000 * Display Field
          GOTO     DF05L010
DF05L900
          MOVE      "APIM4",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP05L000
DF05L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Search for Creditors Document      
.---------------------------------------------------------
PS05L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS05L999,PS05L999,PS05L999,PS05L999:
                            PS05L999,PS05L999,PS05L999,PS05L999:
                            PS05L999,PS05L999,PS05L999,PS05L999:
                           PS05L101,PS05L999,PS05L999,PS05L999:
                            PS05L999,PS05L999
          GOTO     PS05L999
.
PS05L101
          MOVE      SCRTOTAL,VAR     
          CALL      DISPITEM
          GOTO     PS05L999
PS05L999
          RETURN
.---------------------------------------------------------
. Selections for : Search for Creditors Document      
.---------------------------------------------------------
SF05L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF05L001  BRANCH   ACCEPT,SF05L020
.
SF05L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L006,SF05L006,SF05L006,SF05L101:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                            SF05L006,SF05L006,SF05L006,SF05L006:
                           SF05L006,SF05L102,SF05L103,SF05L104:
                            SF05L105,SF05L106
SF05L006  BEEP
          GOTO     SF05L005
SF05L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF05L090
          MATCH    PRGID,SCSLPID
          GOTO     SF05L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF05L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020,SF05L020,SF05L020:
                           SF05L020,SF05L020,SF05L020,SF05L020:
                            SF05L020,SF05L020
          GOTO     SF05L020
SF05L090  MOVE     ZERO,ACCEPT
          MOVE      "APIM4",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP05L000
          GOTO     SF05L001
.
SF05L101
          MOVE      ZERO,EXIT
          GOTO      SF05L999
.
SF05L102
          MOVE      ONE,EXIT
          GOTO      SF05L999
.
SF05L103
          MOVE      "APIM4",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NP05L000
          GOTO     SF05L001
.
SF05L104
          MOVE      "APIM4",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PP05L000
          GOTO     SF05L001
.
SF05L105
          MOVE      "APIM4",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP05L000
          GOTO     SF05L001
.
SF05L106
          MOVE      "APIM4",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LP05L000
          GOTO     SF05L001
SF05L990  MOVE      ONE,EXIT * Exit Char Restart
SF05L999  RETURN
.--------------------------------
. Screen - Accounts Payable Transaction Detail
.--------------------------------
SC06L000
SC06L100
          MOVE      "06",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC06L200
          CALL      CF06L000 * Clear Fields
SC06L300
          CALL      KY06L000 * Enter Key Fields
          BRANCH    EXIT,SC06L999,SC06L999
SC06L400
          CALL      WP06L000 * Load any WP Details
SC06L500
          CALL      LM06L000 * Load any Batch Details
SC06L600
          CALL      DF06L000 * Display Fields
SC06L700
          CALL      SF06L000 * Select Fields
          BRANCH    EXIT,SC06L100,SC06L100,SC06L200
SC06L800
SC06L900
SC06L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Accounts Payable Transaction Detail
.-------------------------------------------------------
CF06L000
CF06L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Accounts Payable Transaction Detail
.--------------------------------------------------------
KY06L000
.
KY06L110
          MOVE      "   14",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "0",CKEYTYP
          CALL      SETSCR06
          BRANCH    EXIT,KY06L900,KY06L900
          MOVE      ZERO,ACCEPT
          MOVE      DUMMY,VAR        
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY06L999
.
KY06L900  MOVE      ONE,EXIT
KY06L999  RETURN
.---------------------------------------------------------
. Load WP files for : Accounts Payable Transaction Detail
.---------------------------------------------------------
WP06L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Accounts Payable Transaction Detail
.---------------------------------------------------------
LM06L000
.---------------------------------------------------------
. Load for :     1 Invoice Date                       
.---------------------------------------------------------
          UNPACK    SP70,APIMCRD,APIMIDT,APIMREF,APIMDOC,APIMBCH
          PACK      KEY48,APMACRD,SP70
          MOVE      KEY48,APIM2EKY
          STRIP     APIM2SKY
          SETLPTR   APIM2EKY,5
          MOVE      APIM2EKY,APIM2SKY
          CALL      RDAPIM2 
          IF        OVRCD=0
            CALL      RPAPIM2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP06L000
          MOVE     ZERO,APIM2CNT
          MOVE     ZERO,APIM2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP06L600
          MATCH    PRGID,SCPSPID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP06L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP06L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP06L101,DP06L102,DP06L103,DP06L104:
                            DP06L105,DP06L106,DP06L010,DP06L010:
                            DP06L107,DP06L010,DP06L010,DP06L010:
                            DP06L010,DP06L010
          GOTO      DP06L010
.
DP06L101
          IF        APIM2END=0
            CALL      RPAPIM2 
            IF        OVRCD=0
              PACK      APIM2MKY,APIMCRD,APIMIDT,APIMREF,APIMDOC,APIMBCH                                        
              MATCH     APIM2EKY,APIM2MKY
              IF        @EQUAL
                MOVE      ZERO,APIM2END
                ADD       ONE,APIM2CNT
                UNPACK    APIMIDT,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
          CALL      TRNDET00
              ELSE
                MOVE      ONE,APIM2END
              ENDIF
            ELSE
              MOVE      ONE,APIM2END
            ENDIF
          ENDIF
          IF        APIM2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L102
          IF        APIM2END=0
            MOVE      APIMREF,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L103
          IF        APIM2END=0
            MOVE      APIMDOC,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L104
          IF        APIM2END=0
            MOVE      DOCTYPE,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L105
          IF        APIM2END=0
            UNPACK    APIMDDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L106
          IF        APIM2END=0
            MOVE      DOCTOTAL,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
.
DP06L107
          IF        APIM2END=0
            UNPACK    APIMPDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP06L010
DP06L600
          MATCH    "APIM2",NAMSSFFI
          GOTO     DP06L605 IF NOT EQUAL
          GOTO     DP06L999
DP06L605
DP06L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP06L000
.
          MATCH    "APIM2",NAMSSFFI
          GOTO     FP06L105 IF NOT EQUAL
          PACK     KEY48,APIM2SKY,Z70
          CALL     RDAPIM2  * Start
          IF       OVRCD=0
            CALL     RPAPIM2  * Start
          ENDIF
          CALL     DP06L000
          GOTO     FP06L999
FP06L105
FP06L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP06L000
.
          MATCH    "APIM2",NAMSSFFI
          GOTO     LP06L105 IF NOT EQUAL
          PACK     KEY48,APIM2SKY,SP70
          CALL     RSAPIM2  * End
          IF       OVRCD=1
            CALL     RKAPIM2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM2SNO
            CALL     RKAPIM2 
            IF       OVRCD=1
              MOVE     APIM2SNO,SECTOR
            ENDIF
            PACK     APIM2MKY,APIMCRD,APIMIDT,APIMREF,APIMDOC,APIMBCH                                        
            MATCH    APIM2EKY,APIM2MKY
            IF       !@EQUAL
              MOVE     APIM2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     LP06L999
LP06L105
LP06L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP06L000
.
          MATCH    "APIM2",NAMSSFFI
          GOTO     PP06L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP06L105
          COMPARE  SECTOR,APIM2SNO
          GOTO     PP06L110 IF EQUAL
          CALL     RKAPIM2 
          BRANCH   OVRCD,PP06L115
          PACK     APIM2MKY,APIMCRD,APIMIDT,APIMREF,APIMDOC,APIMBCH                                        
          MATCH    APIM2EKY,APIM2MKY
          GOTO     PP06L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP06L105
PP06L110
          MOVE     ZERO,SECTOR
          IF       APIM2CNT=APIM2SNO
            SUB      ONE,APIM2CNT
          ENDIF
          WHILE    SECTOR<=APIM2CNT
            CALL     RKAPIM2 
            IF       OVRCD=1
              MOVE     APIM2SNO,SECTOR
            ENDIF
            PACK     APIM2MKY,APIMCRD,APIMIDT,APIMREF,APIMDOC,APIMBCH                                        
            MATCH    APIM2EKY,APIM2MKY
            IF       !@EQUAL
              MOVE     APIM2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP06L000
          GOTO     PP06L999
PP06L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM2SNO
            CALL     RPAPIM2 
            IF       OVRCD=1
              MOVE     APIM2SNO,SECTOR
            ENDIF
            PACK     APIM2MKY,APIMCRD,APIMIDT,APIMREF,APIMDOC,APIMBCH                                        
            MATCH    APIM2EKY,APIM2MKY
            IF       !@EQUAL
              MOVE     APIM2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP06L999
PP06L120
PP06L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP06L000
          MATCH    "APIM2",NAMSSFFI
          GOTO     NP06L115 IF NOT EQUAL
NP06L105
          CALL     RPAPIM2 
          BRANCH   OVRCD,NP06L110
          PACK     APIM2MKY,APIMCRD,APIMIDT,APIMREF,APIMDOC,APIMBCH                                        
          MATCH    APIM2EKY,APIM2MKY
          GOTO     NP06L110 IF NOT EQUAL
          CALL     RKAPIM2 
          CALL     DP06L000
          GOTO     NP06L999
NP06L110
          CALL     RKAPIM2 
          BEEP
          GOTO     NP06L999
NP06L115
NP06L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT06L000
CT06L105
CT06L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Accounts Payable Transaction Detail
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Accounts Payable Transaction Detail
.---------------------------------------------------------
DF06L000
          BRANCH   ACCEPT,DF06L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF06L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF06L900
          MATCH    PRGID,SCPSPID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF06L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF06L010 IF NOT EQUAL
.
          CALL     PS06L000 * Display Field
          GOTO     DF06L010
DF06L900
          MOVE      "APIM2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP06L000
DF06L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Accounts Payable Transaction Detail
.---------------------------------------------------------
PS06L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999,PS06L999,PS06L999:
                            PS06L999,PS06L999
          GOTO     PS06L999
PS06L999
          RETURN
.---------------------------------------------------------
. Selections for : Accounts Payable Transaction Detail
.---------------------------------------------------------
SF06L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF06L001  BRANCH   ACCEPT,SF06L020
.
SF06L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L006,SF06L006,SF06L006,SF06L006:
                            SF06L006,SF06L006,SF06L101,SF06L006:
                            SF06L006,SF06L102,SF06L103,SF06L104:
                            SF06L105,SF06L006
SF06L006  BEEP
          GOTO     SF06L005
SF06L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF06L090
          MATCH    PRGID,SCSLPID
          GOTO     SF06L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF06L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020,SF06L020,SF06L020:
                            SF06L020,SF06L020
          GOTO     SF06L020
SF06L090  MOVE     ZERO,ACCEPT
          MOVE      "APIM2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L101
          MOVE      ZERO,EXIT
          GOTO      SF06L999
.
SF06L102
          MOVE      "APIM2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP06L000
          GOTO     SF06L001
.
SF06L103
          MOVE      "APIM2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP06L000
          GOTO     SF06L001
.
SF06L104
          MOVE      "APIM2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP06L000
          GOTO     SF06L001
.
SF06L105
          MOVE      "APIM2",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP06L000
          GOTO     SF06L001
SF06L990  MOVE      ONE,EXIT * Exit Char Restart
SF06L999  RETURN
.--------------------------------
. Screen - Invoice Reference Search           
.--------------------------------
SC07L000
SC07L100
          MOVE      "07",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    8",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC07L200
          CALL      CF07L000 * Clear Fields
SC07L300
          CALL      KY07L000 * Enter Key Fields
          BRANCH    EXIT,SC07L999,SC07L999
SC07L400
          CALL      WP07L000 * Load any WP Details
SC07L500
          CALL      LM07L000 * Load any Batch Details
SC07L600
          CALL      DF07L000 * Display Fields
SC07L700
          CALL      SF07L000 * Select Fields
          BRANCH    EXIT,SC07L100,SC07L100,SC07L200
SC07L800
SC07L900
SC07L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Invoice Reference Search           
.-------------------------------------------------------
CF07L000
CF07L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Invoice Reference Search           
.--------------------------------------------------------
KY07L000
.
KY07L110
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=1
            MOVE      "Mandatory Field Missing. Fatal - ",DISPMSG
            BEEP
            CALL      MESSAGE1
            GOTO      FATALERR
          ENDIF
          MOVE      "2",CKEYTYP
          CALL      EIREF000
          BRANCH    EXIT,KY07L900,KY07L900
          MOVE      OVRCD,ACCEPT
          MOVE      INVREFER,VAR     
          CALL      DISPITEM
          MOVE      ZERO,EXIT
          GOTO      KY07L999
.
KY07L900  MOVE      ONE,EXIT
KY07L999  RETURN
.---------------------------------------------------------
. Load WP files for : Invoice Reference Search           
.---------------------------------------------------------
WP07L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Invoice Reference Search           
.---------------------------------------------------------
LM07L000
.---------------------------------------------------------
. Load for :     2 Document Reference                 
.---------------------------------------------------------
          UNPACK    SP70,APIMCRD,APIMREF,APIMDOC,APIMBCH
          PACK      KEY40,APMACRD,INVREFER,SP70
          MOVE      KEY40,APIM3EKY
          STRIP     APIM3SKY
          SETLPTR   APIM3EKY,20
          MOVE      APIM3EKY,APIM3SKY
          CALL      RDAPIM3 
          IF        OVRCD=0
            CALL      RPAPIM3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP07L000
          MOVE     ZERO,APIM3CNT
          MOVE     ZERO,APIM3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP07L600
          MATCH    PRGID,SCPSPID
          GOTO     DP07L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP07L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP07L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP07L010,DP07L101,DP07L102,DP07L103:
                            DP07L104,DP07L105,DP07L010,DP07L010:
                            DP07L106,DP07L010,DP07L107,DP07L108:
                            DP07L010,DP07L010,DP07L010,DP07L010:
                            DP07L010,DP07L010,DP07L010,DP07L010
          GOTO      DP07L010
.
DP07L101
          IF        APIM3END=0
            CALL      RKAPIM3 
            IF        OVRCD=0
              PACK      APIM3MKY,APIMCRD,APIMREF,APIMDOC,APIMBCH                                                
              MATCH     APIM3EKY,APIM3MKY
              IF        @EQUAL
                MOVE      ZERO,APIM3END
                ADD       ONE,APIM3CNT
                MOVE      APIMDOC,VAR      
                CALL      DISPITEM
          CALL      TRNDET00
              ELSE
                MOVE      ONE,APIM3END
              ENDIF
            ELSE
              MOVE      ONE,APIM3END
            ENDIF
          ENDIF
          IF        APIM3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L102
          IF        APIM3END=0
            UNPACK    APIMIDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L103
          IF        APIM3END=0
            MOVE      DOCTYPE,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L104
          IF        APIM3END=0
            UNPACK    APIMPDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L105
          IF        APIM3END=0
            MOVE      DOCTOTAL,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L106
          IF        APIM3END=0
            UNPACK    APIMDDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L107
          IF        APIM3END=0
            UNPACK    APIMTDT,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
.
DP07L108
          IF        APIM3END=0
            MOVE      APIMBCH,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP07L010
DP07L600
          MATCH    "APIM3",NAMSSFFI
          GOTO     DP07L605 IF NOT EQUAL
.
.
          MOVE      "   16",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SCRTOTAL,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     DP07L999
DP07L605
DP07L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP07L000
.
          MATCH    "APIM3",NAMSSFFI
          GOTO     FP07L105 IF NOT EQUAL
          PACK     KEY40,APIM3SKY,SP70
          CALL     RDAPIM3  * Start
          IF       OVRCD=0
            CALL     RPAPIM3  * Start
          ENDIF
          CALL     DP07L000
          GOTO     FP07L999
FP07L105
FP07L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP07L000
.
          MATCH    "APIM3",NAMSSFFI
          GOTO     LP07L105 IF NOT EQUAL
          PACK     KEY40,APIM3SKY,Z70
          CALL     RSAPIM3  * End
          IF       OVRCD=1
            CALL     RPAPIM3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM3SNO
            CALL     RPAPIM3 
            IF       OVRCD=1
              MOVE     APIM3SNO,SECTOR
            ENDIF
            PACK     APIM3MKY,APIMCRD,APIMREF,APIMDOC,APIMBCH                                                
            MATCH    APIM3EKY,APIM3MKY
            IF       !@EQUAL
              MOVE     APIM3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP07L000
          GOTO     LP07L999
LP07L105
LP07L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP07L000
.
          MATCH    "APIM3",NAMSSFFI
          GOTO     PP07L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP07L105
          COMPARE  SECTOR,APIM3SNO
          GOTO     PP07L110 IF EQUAL
          CALL     RPAPIM3 
          BRANCH   OVRCD,PP07L115
          PACK     APIM3MKY,APIMCRD,APIMREF,APIMDOC,APIMBCH                                                
          MATCH    APIM3EKY,APIM3MKY
          GOTO     PP07L115 IF NOT EQUAL
          ADD      ONE,SECTOR
          GOTO     PP07L105
PP07L110
          MOVE     ZERO,SECTOR
          IF       APIM3CNT=APIM3SNO
            SUB      ONE,APIM3CNT
          ENDIF
          WHILE    SECTOR<=APIM3CNT
            CALL     RPAPIM3 
            IF       OVRCD=1
              MOVE     APIM3SNO,SECTOR
            ENDIF
            PACK     APIM3MKY,APIMCRD,APIMREF,APIMDOC,APIMBCH                                                
            MATCH    APIM3EKY,APIM3MKY
            IF       !@EQUAL
              MOVE     APIM3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP07L000
          GOTO     PP07L999
PP07L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<APIM3SNO
            CALL     RKAPIM3 
            IF       OVRCD=1
              MOVE     APIM3SNO,SECTOR
            ENDIF
            PACK     APIM3MKY,APIMCRD,APIMREF,APIMDOC,APIMBCH                                                
            MATCH    APIM3EKY,APIM3MKY
            IF       !@EQUAL
              MOVE     APIM3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP07L999
PP07L120
PP07L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP07L000
          MATCH    "APIM3",NAMSSFFI
          GOTO     NP07L115 IF NOT EQUAL
NP07L105
          CALL     RKAPIM3 
          BRANCH   OVRCD,NP07L110
          PACK     APIM3MKY,APIMCRD,APIMREF,APIMDOC,APIMBCH                                                
          MATCH    APIM3EKY,APIM3MKY
          GOTO     NP07L110 IF NOT EQUAL
          CALL     RPAPIM3 
          CALL     DP07L000
          GOTO     NP07L999
NP07L110
          CALL     RPAPIM3 
          BEEP
          GOTO     NP07L999
NP07L115
NP07L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT07L000
CT07L105
CT07L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Invoice Reference Search           
.---------------------------------------------------------
.---------------------------------------------------------
. Display Fields for : Invoice Reference Search           
.---------------------------------------------------------
DF07L000
          BRANCH   ACCEPT,DF07L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF07L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF07L900
          MATCH    PRGID,SCPSPID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF07L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF07L010 IF NOT EQUAL
.
          CALL     PS07L000 * Display Field
          GOTO     DF07L010
DF07L900
          MOVE      "APIM3",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      FP07L000
DF07L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Invoice Reference Search           
.---------------------------------------------------------
PS07L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L999:
                            PS07L999,PS07L999,PS07L999,PS07L101:
                            PS07L999,PS07L999,PS07L999,PS07L999
          GOTO     PS07L999
.
PS07L101
          MOVE      SCRTOTAL,VAR     
          CALL      DISPITEM
          GOTO     PS07L999
PS07L999
          RETURN
.---------------------------------------------------------
. Selections for : Invoice Reference Search           
.---------------------------------------------------------
SF07L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF07L001  BRANCH   ACCEPT,SF07L020
.
SF07L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L101,SF07L006:
                            SF07L006,SF07L006,SF07L006,SF07L006:
                            SF07L006,SF07L006,SF07L102,SF07L006:
                            SF07L103,SF07L104,SF07L105,SF07L106
SF07L006  BEEP
          GOTO     SF07L005
SF07L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF07L090
          MATCH    PRGID,SCSLPID
          GOTO     SF07L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF07L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020:
                            SF07L020,SF07L020,SF07L020,SF07L020
          GOTO     SF07L020
SF07L090  MOVE     ZERO,ACCEPT
          MOVE      "APIM3",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      FP07L000
          GOTO     SF07L001
.
SF07L101
          MOVE      ZERO,EXIT
          GOTO      SF07L999
.
SF07L102
          MOVE      ONE,EXIT
          GOTO      SF07L999
.
SF07L103
          MOVE      "APIM3",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      NP07L000
          GOTO     SF07L001
.
SF07L104
          MOVE      "APIM3",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      PP07L000
          GOTO     SF07L001
.
SF07L105
          MOVE      "APIM3",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      FP07L000
          GOTO     SF07L001
.
SF07L106
          MOVE      "APIM3",NAMSSFFI
          MOVE      "    2",ITMSSFFI
          CALL      LP07L000
          GOTO     SF07L001
SF07L990  MOVE      ONE,EXIT * Exit Char Restart
SF07L999  RETURN
.--------------------------------
. Screen - Display Releated Catalog Codes     
.--------------------------------
SC08L000
SC08L100
          MOVE      "08",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC08L200
          CALL      CF08L000 * Clear Fields
SC08L300
          CALL      KY08L000 * Enter Key Fields
          BRANCH    EXIT,SC08L999,SC08L999
SC08L400
          CALL      WP08L000 * Load any WP Details
SC08L500
          CALL      LM08L000 * Load any Batch Details
SC08L600
          CALL      DF08L000 * Display Fields
SC08L700
          CALL      SF08L000 * Select Fields
          BRANCH    EXIT,SC08L100,SC08L100,SC08L200
SC08L800
SC08L900
SC08L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Display Releated Catalog Codes     
.-------------------------------------------------------
CF08L000
CF08L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Display Releated Catalog Codes     
.--------------------------------------------------------
KY08L000
          MOVE      ZERO,EXIT
          GOTO      KY08L999
.
KY08L900  MOVE      ONE,EXIT
KY08L999  RETURN
.---------------------------------------------------------
. Load WP files for : Display Releated Catalog Codes     
.---------------------------------------------------------
WP08L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Display Releated Catalog Codes     
.---------------------------------------------------------
LM08L000
.---------------------------------------------------------
. Load for :     1 Catalog Code                       
.---------------------------------------------------------
          UNPACK    SP70,SIICSUP,SIICCAT,SIICSUT
          PACK      KEY27,APMACRD,SP70
          MOVE      KEY27,SIIC3EKY
          STRIP     SIIC3SKY
          SETLPTR   SIIC3EKY,5
          MOVE      SIIC3EKY,SIIC3SKY
          CALL      RDSIIC3 
          IF        OVRCD=0
            CALL      RPSIIC3 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP08L000
          MOVE     ZERO,SIIC3CNT
          MOVE     ZERO,SIIC3END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP08L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP08L600
          MATCH    PRGID,SCPSPID
          GOTO     DP08L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP08L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP08L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP08L101,DP08L102,DP08L103,DP08L104:
                            DP08L105,DP08L106,DP08L107,DP08L108:
                            DP08L109,DP08L110,DP08L111,DP08L112:
                            DP08L113,DP08L114,DP08L115,DP08L116:
                            DP08L117,DP08L118,DP08L119,DP08L010:
                            DP08L010,DP08L010,DP08L010,DP08L010:
                           DP08L010,DP08L010,DP08L010
          GOTO      DP08L010
.
DP08L101
          PACK      SIIC3MKY,SP70,SP70
          CALL      UPTSIIC3
          IF        SIIC3END=0
            CALL      RKSIIC3 
            IF        OVRCD=0
              PACK      SIIC3MKY,SIICSUP,SIICCAT,SIICSUT                                                        
              MATCH     SIIC3EKY,SIIC3MKY
              IF        @EQUAL
                MOVE      ZERO,SIIC3END
                ADD       ONE,SIIC3CNT
                CALL      UPTSIIC3
                MOVE      SIICCAT,VAR      
                CALL      DISPITEM
          CALL      CATDET00
              ELSE
                MOVE      ONE,SIIC3END
              ENDIF
            ELSE
              MOVE      ONE,SIIC3END
            ENDIF
          ENDIF
          IF        SIIC3END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L102
          IF        SIIC3END=0
            MOVE      SIICSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L103
          IF        SIIC3END=0
            MOVE      SIICCCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L104
          IF        SIIC3END=0
            MOVE      SIICLCT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L105
          IF        SIIC3END=0
            MOVE      SIICLTM,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L106
          IF        SIIC3END=0
            MOVE      SIICPNO,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L107
          IF        SIIC3END=0
            MOVE      SIICPD1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L108
          IF        SIIC3END=0
            MOVE      SIICPD2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L109
          IF        SIIC3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIICMAN,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L110
          IF        SIIC3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIICAPO,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L111
          IF        SIIC3END=0
            MOVE      SIICUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L112
          IF        SIIC3END=0
            MOVE      SIICUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L113
          IF        SIIC3END=0
            UNPACK    SIICUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L114
          IF        SIIC3END=0
            UNPACK    SIICUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L115
          IF        SIIC3END=0
            MOVE      SIICUC1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L116
          IF        SIIC3END=0
            MOVE      SIICUC2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L117
          IF        SIIC3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIICUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L118
          IF        SIIC3END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIICUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
.
DP08L119
          IF        SIIC3END=0
            MOVE      SIIADES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP08L010
DP08L600
          MATCH    "SIIC3",NAMSSFFI
          GOTO     DP08L605 IF NOT EQUAL
          GOTO     DP08L999
DP08L605
DP08L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP08L000
.
          MATCH    "SIIC3",NAMSSFFI
          GOTO     FP08L105 IF NOT EQUAL
          PACK     KEY27,SIIC3SKY,SP70
          CALL     RDSIIC3  * Start
          IF       OVRCD=0
            CALL     RPSIIC3  * Start
          ENDIF
          CALL     DP08L000
          GOTO     FP08L999
FP08L105
FP08L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP08L000
.
          MATCH    "SIIC3",NAMSSFFI
          GOTO     LP08L105 IF NOT EQUAL
          PACK     KEY27,SIIC3SKY,Z70
          CALL     RSSIIC3  * End
          IF       OVRCD=1
            CALL     RPSIIC3 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIC3SNO
            CALL     RPSIIC3 
            IF       OVRCD=1
              MOVE     SIIC3SNO,SECTOR
            ENDIF
            PACK     SIIC3MKY,SIICSUP,SIICCAT,SIICSUT                                                        
            MATCH    SIIC3EKY,SIIC3MKY
            IF       !@EQUAL
              MOVE     SIIC3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP08L000
          GOTO     LP08L999
LP08L105
LP08L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP08L000
.
          MATCH    "SIIC3",NAMSSFFI
          GOTO     PP08L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP08L105
          CALL      RFTSIIC3
          BRANCH   OVRCD,PP08L115
          MOVE      SIIC3MKY,KEY27 
          CALL      RSSIIC3 
PP08L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIIC3SNO
            CALL     RPSIIC3 
            IF       OVRCD=1
              MOVE     SIIC3SNO,SECTOR
            ENDIF
            PACK     SIIC3MKY,SIICSUP,SIICCAT,SIICSUT                                                        
            MATCH    SIIC3EKY,SIIC3MKY
            IF       !@EQUAL
              MOVE     SIIC3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP08L000
          GOTO     PP08L999
PP08L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIIC3SNO
            CALL     RKSIIC3 
            IF       OVRCD=1
              MOVE     SIIC3SNO,SECTOR
            ENDIF
            PACK     SIIC3MKY,SIICSUP,SIICCAT,SIICSUT                                                        
            MATCH    SIIC3EKY,SIIC3MKY
            IF       !@EQUAL
              MOVE     SIIC3SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP08L999
PP08L120
PP08L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP08L000
          MATCH    "SIIC3",NAMSSFFI
          GOTO     NP08L115 IF NOT EQUAL
NP08L105
          CALL     RKSIIC3 
          BRANCH   OVRCD,NP08L110
          PACK     SIIC3MKY,SIICSUP,SIICCAT,SIICSUT                                                        
          MATCH    SIIC3EKY,SIIC3MKY
          GOTO     NP08L110 IF NOT EQUAL
          CALL     RPSIIC3 
          CALL     DP08L000
          GOTO     NP08L999
NP08L110
          CALL     RPSIIC3 
          BEEP
          GOTO     NP08L999
NP08L115
NP08L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT08L000
CT08L105
CT08L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Display Releated Catalog Codes     
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     1 Catalog Code                       
.---------------------------------------------------------
UPTSIIC3
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIC3FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIIC3FL1,KEY5;SCPSROW,SCPSCOL,SIIC3MKY
          ELSE
            UPDATE    SIIC3FL1;SCPSROW,SCPSCOL,SIIC3MKY
          ENDIF
          RETURN
RDTSIIC3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIIC3FL1,KEY5;SCPSROW,SCPSCOL,SIIC3MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIIC3
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIIC3FL1,KEY5;;
          READKS    SIIC3FL1;SCPSROW,SCPSCOL,SIIC3MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIIC3MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Display Releated Catalog Codes     
.---------------------------------------------------------
DF08L000
          BRANCH   ACCEPT,DF08L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF08L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF08L900
          MATCH    PRGID,SCPSPID
          GOTO     DF08L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF08L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF08L010 IF NOT EQUAL
.
          CALL     PS08L000 * Display Field
          GOTO     DF08L010
DF08L900
          MOVE      "SIIC3",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP08L000
DF08L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Display Releated Catalog Codes     
.---------------------------------------------------------
PS08L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                            PS08L999,PS08L999,PS08L999,PS08L999:
                           PS08L999,PS08L999,PS08L999
          GOTO     PS08L999
PS08L999
          RETURN
.---------------------------------------------------------
. Selections for : Display Releated Catalog Codes     
.---------------------------------------------------------
SF08L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF08L001  BRANCH   ACCEPT,SF08L020
.
SF08L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF08L101,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L006,SF08L006,SF08L006,SF08L006:
                            SF08L102,SF08L103,SF08L104,SF08L006:
                           SF08L006,SF08L105,SF08L106
SF08L006  BEEP
          GOTO     SF08L005
SF08L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF08L090
          MATCH    PRGID,SCSLPID
          GOTO     SF08L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF08L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF08L101,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                            SF08L020,SF08L020,SF08L020,SF08L020:
                           SF08L020,SF08L020,SF08L020
          GOTO     SF08L020
SF08L090  MOVE     ZERO,ACCEPT
          MOVE      "SIIC3",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP08L000
          GOTO     SF08L001
.
SF08L101
          CALL      SELECTED
          BRANCH    EXIT,SF08L001
          COMPARE   ONE,ACCEPT
          GOTO      SF08L001 IF EQUAL
          CALL      RDTSIIC3
          IF        OVRCD=1
            BEEP
            GOTO      SF08L001
          ENDIF
          MATCH     SP70,SIIC3MKY
          IF        @EQUAL
            BEEP
            GOTO      SF08L001
          ENDIF
          MOVE      SIIC3MKY,KEY27 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      CATSCR00
          MOVE      "08",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   20",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIIC3
          IF        OVRCD=1
            CALL      FP08L000
          ELSE
            MOVE      SIIC3MKY,KEY27 
            CALL      RSSIIC3 
            CALL      RPSIIC3 
            CALL      DP08L000
          ENDIF
          GOTO     SF08L001
.
SF08L102
          MOVE      ZERO,EXIT
          GOTO      SF08L999
.
SF08L103
          MOVE      "SIIC3",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP08L000
          GOTO     SF08L001
.
SF08L104
          MOVE      "SIIC3",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP08L000
          GOTO     SF08L001
.
SF08L105
          MOVE      "SIIC3",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP08L000
          GOTO     SF08L001
.
SF08L106
          MOVE      "SIIC3",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP08L000
          GOTO     SF08L001
SF08L990  MOVE      ONE,EXIT * Exit Char Restart
SF08L999  RETURN
.--------------------------------
. Screen - Order History                      
.--------------------------------
SC09L000
SC09L100
          MOVE      "09",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 6",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC09L200
          CALL      CF09L000 * Clear Fields
SC09L300
          CALL      KY09L000 * Enter Key Fields
          BRANCH    EXIT,SC09L999,SC09L999
SC09L400
          CALL      WP09L000 * Load any WP Details
SC09L500
          CALL      LM09L000 * Load any Batch Details
SC09L600
          CALL      DF09L000 * Display Fields
SC09L700
          CALL      SF09L000 * Select Fields
          BRANCH    EXIT,SC09L100,SC09L100,SC09L200
SC09L800
SC09L900
SC09L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Order History                      
.-------------------------------------------------------
CF09L000
CF09L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Order History                      
.--------------------------------------------------------
KY09L000
          MOVE      ZERO,EXIT
          GOTO      KY09L999
.
KY09L900  MOVE      ONE,EXIT
KY09L999  RETURN
.---------------------------------------------------------
. Load WP files for : Order History                      
.---------------------------------------------------------
WP09L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Order History                      
.---------------------------------------------------------
LM09L000
.---------------------------------------------------------
. Load for :     3 Date Input                         
.---------------------------------------------------------
          UNPACK    SP70,SIPASUP,SIPADIN,SIPAPON
          PACK      KEY20,APMACRD,SP70
          MOVE      KEY20,SIPA2EKY
          STRIP     SIPA2SKY
          SETLPTR   SIPA2EKY,5
          MOVE      SIPA2EKY,SIPA2SKY
          CALL      RDSIPA2 
          IF        OVRCD=0
            CALL      RPSIPA2 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP09L000
          MOVE     ZERO,SIPA2CNT
          MOVE     ZERO,SIPA2END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP09L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP09L600
          MATCH    PRGID,SCPSPID
          GOTO     DP09L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP09L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP09L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP09L010,DP09L010,DP09L101,DP09L102:
                            DP09L103,DP09L104,DP09L105,DP09L106:
                            DP09L107,DP09L108,DP09L109,DP09L110:
                            DP09L111,DP09L112,DP09L113,DP09L114:
                            DP09L115,DP09L116,DP09L117,DP09L118:
                            DP09L119,DP09L010,DP09L010,DP09L010:
                           DP09L010,DP09L010,DP09L010,DP09L010
          GOTO      DP09L010
.
DP09L101
          PACK      SIPA2MKY,SP70,SP70
          CALL      UPTSIPA2
          IF        SIPA2END=0
            CALL      RPSIPA2 
            IF        OVRCD=0
              PACK      SIPA2MKY,SIPASUP,SIPADIN,SIPAPON                                                        
              MATCH     SIPA2EKY,SIPA2MKY
              IF        @EQUAL
                MOVE      ZERO,SIPA2END
                ADD       ONE,SIPA2CNT
                CALL      UPTSIPA2
                UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
                CALL      PACDATE
                MOVE      CPCDATE,VAR
                CALL      DISPITEM
          CALL      ORDLIN00
              ELSE
                MOVE      ONE,SIPA2END
              ENDIF
            ELSE
              MOVE      ONE,SIPA2END
            ENDIF
          ENDIF
          IF        SIPA2END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L102
          IF        SIPA2END=0
            MOVE      SIPAPON,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L103
          IF        SIPA2END=0
            MOVE      SIPAORI,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L104
          IF        SIPA2END=0
            MOVE      SIPAICN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L105
          IF        SIPA2END=0
            MOVE      SIPASCN,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L106
          IF        SIPA2END=0
            MOVE      SIPADEL,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L107
          IF        SIPA2END=0
            MOVE      SIPAMES,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L108
          IF        SIPA2END=0
            MOVE      ORDDTOT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L109
          IF        SIPA2END=0
            UNPACK    SIPADPR,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L110
          IF        SIPA2END=0
            UNPACK    SIPADCN,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L111
          IF        SIPA2END=0
            UNPACK    SIPADCM,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L112
          IF        SIPA2END=0
            MOVE      SIPACON,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L113
          IF        SIPA2END=0
            MOVE      SIPAIDP,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L114
          IF        SIPA2END=0
            MOVE      SIPAUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L115
          IF        SIPA2END=0
            MOVE      SIPAUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L116
          IF        SIPA2END=0
            UNPACK    SIPAUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L117
          IF        SIPA2END=0
            UNPACK    SIPAUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L118
          IF        SIPA2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIPAUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
.
DP09L119
          IF        SIPA2END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIPAUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP09L010
DP09L600
          MATCH    "SIPA2",NAMSSFFI
          GOTO     DP09L605 IF NOT EQUAL
          GOTO     DP09L999
DP09L605
DP09L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP09L000
.
          MATCH    "SIPA2",NAMSSFFI
          GOTO     FP09L105 IF NOT EQUAL
          PACK     KEY20,SIPA2SKY,Z70
          CALL     RDSIPA2  * Start
          IF       OVRCD=0
            CALL     RPSIPA2  * Start
          ENDIF
          CALL     DP09L000
          GOTO     FP09L999
FP09L105
FP09L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP09L000
.
          MATCH    "SIPA2",NAMSSFFI
          GOTO     LP09L105 IF NOT EQUAL
          PACK     KEY20,SIPA2SKY,SP70
          CALL     RSSIPA2  * End
          IF       OVRCD=1
            CALL     RKSIPA2 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPA2SNO
            CALL     RKSIPA2 
            IF       OVRCD=1
              MOVE     SIPA2SNO,SECTOR
            ENDIF
            PACK     SIPA2MKY,SIPASUP,SIPADIN,SIPAPON                                                        
            MATCH    SIPA2EKY,SIPA2MKY
            IF       !@EQUAL
              MOVE     SIPA2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP09L000
          GOTO     LP09L999
LP09L105
LP09L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP09L000
.
          MATCH    "SIPA2",NAMSSFFI
          GOTO     PP09L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP09L105
          CALL      RFTSIPA2
          BRANCH   OVRCD,PP09L115
          MOVE      SIPA2MKY,KEY20 
          CALL      RSSIPA2 
PP09L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIPA2SNO
            CALL     RKSIPA2 
            IF       OVRCD=1
              MOVE     SIPA2SNO,SECTOR
            ENDIF
            PACK     SIPA2MKY,SIPASUP,SIPADIN,SIPAPON                                                        
            MATCH    SIPA2EKY,SIPA2MKY
            IF       !@EQUAL
              MOVE     SIPA2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP09L000
          GOTO     PP09L999
PP09L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPA2SNO
            CALL     RPSIPA2 
            IF       OVRCD=1
              MOVE     SIPA2SNO,SECTOR
            ENDIF
            PACK     SIPA2MKY,SIPASUP,SIPADIN,SIPAPON                                                        
            MATCH    SIPA2EKY,SIPA2MKY
            IF       !@EQUAL
              MOVE     SIPA2SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP09L999
PP09L120
PP09L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP09L000
          MATCH    "SIPA2",NAMSSFFI
          GOTO     NP09L115 IF NOT EQUAL
NP09L105
          CALL     RPSIPA2 
          BRANCH   OVRCD,NP09L110
          PACK     SIPA2MKY,SIPASUP,SIPADIN,SIPAPON                                                        
          MATCH    SIPA2EKY,SIPA2MKY
          GOTO     NP09L110 IF NOT EQUAL
          CALL     RKSIPA2 
          CALL     DP09L000
          GOTO     NP09L999
NP09L110
          CALL     RKSIPA2 
          BEEP
          GOTO     NP09L999
NP09L115
NP09L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT09L000
CT09L105
CT09L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Order History                      
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     3 Date Input                         
.---------------------------------------------------------
UPTSIPA2
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPA2FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIPA2FL1,KEY5;SCPSROW,SCPSCOL,SIPA2MKY
          ELSE
            UPDATE    SIPA2FL1;SCPSROW,SCPSCOL,SIPA2MKY
          ENDIF
          RETURN
RDTSIPA2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPA2FL1,KEY5;SCPSROW,SCPSCOL,SIPA2MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIPA2
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIPA2FL1,KEY5;;
          READKS    SIPA2FL1;SCPSROW,SCPSCOL,SIPA2MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIPA2MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Order History                      
.---------------------------------------------------------
DF09L000
          BRANCH   ACCEPT,DF09L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF09L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF09L900
          MATCH    PRGID,SCPSPID
          GOTO     DF09L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF09L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF09L010 IF NOT EQUAL
.
          CALL     PS09L000 * Display Field
          GOTO     DF09L010
DF09L900
          MOVE      "SIPA2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP09L000
DF09L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Order History                      
.---------------------------------------------------------
PS09L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                            PS09L999,PS09L999,PS09L999,PS09L999:
                           PS09L999,PS09L999,PS09L999,PS09L101
          GOTO     PS09L999
.
PS09L101
          MOVE      TRANSSTA,VAR     
          CALL      DISPITEM
          GOTO     PS09L999
PS09L999
          RETURN
.---------------------------------------------------------
. Selections for : Order History                      
.---------------------------------------------------------
SF09L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF09L001  BRANCH   ACCEPT,SF09L020
.
SF09L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF09L006,SF09L101,SF09L102,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L006,SF09L006,SF09L006:
                            SF09L006,SF09L103,SF09L104,SF09L006:
                           SF09L006,SF09L105,SF09L106,SF09L006
SF09L006  BEEP
          GOTO     SF09L005
SF09L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF09L090
          MATCH    PRGID,SCSLPID
          GOTO     SF09L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF09L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF09L020,SF09L020,SF09L102,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                            SF09L020,SF09L020,SF09L020,SF09L020:
                           SF09L020,SF09L020,SF09L020,SF09L020
          GOTO     SF09L020
SF09L090  MOVE     ZERO,ACCEPT
          MOVE      "SIPA2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP09L000
          GOTO     SF09L001
.
SF09L101
          MOVE      ZERO,EXIT
          GOTO      SF09L999
.
SF09L102
          CALL      SELECTED
          BRANCH    EXIT,SF09L001
          COMPARE   ONE,ACCEPT
          GOTO      SF09L001 IF EQUAL
          CALL      RDTSIPA2
          IF        OVRCD=1
            BEEP
            GOTO      SF09L001
          ENDIF
          MATCH     SP70,SIPA2MKY
          IF        @EQUAL
            BEEP
            GOTO      SF09L001
          ENDIF
          MOVE      SIPA2MKY,KEY20 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELORD00
          MOVE      "09",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIPA2
          IF        OVRCD=1
            CALL      FP09L000
          ELSE
            MOVE      SIPA2MKY,KEY20 
            CALL      RSSIPA2 
            CALL      RKSIPA2 
            CALL      DP09L000
          ENDIF
          GOTO     SF09L001
.
SF09L103
          MOVE      "SIPA2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      NP09L000
          GOTO     SF09L001
.
SF09L104
          MOVE      "SIPA2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      PP09L000
          GOTO     SF09L001
.
SF09L105
          MOVE      "SIPA2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      FP09L000
          GOTO     SF09L001
.
SF09L106
          MOVE      "SIPA2",NAMSSFFI
          MOVE      "    3",ITMSSFFI
          CALL      LP09L000
          GOTO     SF09L001
SF09L990  MOVE      ONE,EXIT * Exit Char Restart
SF09L999  RETURN
.--------------------------------
. Screen - Purchase Order Detail Display      
.--------------------------------
SC14L000
SC14L100
          MOVE      "14",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 4",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC14L200
          CALL      CF14L000 * Clear Fields
SC14L300
          CALL      KY14L000 * Enter Key Fields
          BRANCH    EXIT,SC14L999,SC14L999
SC14L400
          CALL      WP14L000 * Load any WP Details
SC14L500
          CALL      LM14L000 * Load any Batch Details
SC14L600
          CALL      DF14L000 * Display Fields
SC14L700
          CALL      SF14L000 * Select Fields
          BRANCH    EXIT,SC14L100,SC14L100,SC14L200
SC14L800
SC14L900
SC14L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Order Detail Display      
.-------------------------------------------------------
CF14L000
CF14L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Order Detail Display      
.--------------------------------------------------------
KY14L000
          MOVE      ZERO,EXIT
          GOTO      KY14L999
.
KY14L900  MOVE      ONE,EXIT
KY14L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Order Detail Display      
.---------------------------------------------------------
WP14L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Order Detail Display      
.---------------------------------------------------------
LM14L000
.---------------------------------------------------------
. Load for :     1 Item Number                        
.---------------------------------------------------------
          UNPACK    SP70,SIPCPON,SIPCITM
          PACK      KEY10,SIPAPON,SP70
          MOVE      KEY10,SIPC1EKY
          STRIP     SIPC1SKY
          SETLPTR   SIPC1EKY,7
          MOVE      SIPC1EKY,SIPC1SKY
          CALL      RDSIPC1 
          IF        OVRCD=0
            CALL      RPSIPC1 
          ENDIF
          RETURN
.--------------------------------------------------------
. Display Current Page of Multi Items
.--------------------------------------------------------
DP14L000
          MOVE     ZERO,SIPC1CNT
          MOVE     ZERO,SIPC1END
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DP14L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DP14L600
          MATCH    PRGID,SCPSPID
          GOTO     DP14L600 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DP14L600 IF NOT EQUAL
          MATCH    NAMSSFFI,SCPSMTY
          GOTO     DP14L010 IF NOT EQUAL
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,DP14L101,DP14L102,DP14L103,DP14L104:
                            DP14L105,DP14L106,DP14L107,DP14L108:
                            DP14L109,DP14L110,DP14L111,DP14L112:
                            DP14L113,DP14L114,DP14L115,DP14L116:
                            DP14L117,DP14L118,DP14L119,DP14L120:
                            DP14L010,DP14L010,DP14L010,DP14L010:
                            DP14L010,DP14L010,DP14L010,DP14L010:
                           DP14L010,DP14L010,DP14L010,DP14L010:
                            DP14L010,DP14L010,DP14L010,DP14L010:
                            DP14L010,DP14L010,DP14L010,DP14L010:
                            DP14L010,DP14L010,DP14L010,DP14L010:
                            DP14L010,DP14L010,DP14L010,DP14L010:
                            DP14L010,DP14L010,DP14L010,DP14L010:
                           DP14L010,DP14L010,DP14L010
          GOTO      DP14L010
.
DP14L101
          PACK      SIPC1MKY,SP70,SP70
          CALL      UPTSIPC1
          IF        SIPC1END=0
            CALL      RKSIPC1 
            IF        OVRCD=0
              PACK      SIPC1MKY,SIPCPON,SIPCITM                                                                
              MATCH     SIPC1EKY,SIPC1MKY
              IF        @EQUAL
                MOVE      ZERO,SIPC1END
                ADD       ONE,SIPC1CNT
                CALL      UPTSIPC1
                MOVE      SIPCITM,VAR      
                CALL      DISPITEM
          CALL      CHKPRICE
              ELSE
                MOVE      ONE,SIPC1END
              ENDIF
            ELSE
              MOVE      ONE,SIPC1END
            ENDIF
          ENDIF
          IF        SIPC1END=1
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L102
          IF        SIPC1END=0
            MOVE      SIPCCST,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L103
          IF        SIPC1END=0
            MOVE      SIPCPRD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L104
          IF        SIPC1END=0
            MOVE      SIPCDAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L105
          IF        SIPC1END=0
            MOVE      SIPCWAR,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L106
          IF        SIPC1END=0
            MOVE      SIPCCAT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L107
          IF        SIPC1END=0
            MOVE      SIPCPN,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L108
          IF        SIPC1END=0
            MOVE      SIPCPD,VAR       
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L109
          IF        SIPC1END=0
            MOVE      SIPCCON,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L110
          IF        SIPC1END=0
            MOVE      SIPCCDT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L111
          IF        SIPC1END=0
            MOVE      SIPCSUT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L112
          IF        SIPC1END=0
            MOVE      SIPCEDD,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L113
          IF        SIPC1END=0
            MOVE      SIPCOQT,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L114
          IF        SIPC1END=0
            MOVE      UNITCOST,VAR     
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L115
          IF        SIPC1END=0
            MOVE      SIPCUR1,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L116
          IF        SIPC1END=0
            MOVE      SIPCUR2,VAR      
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L117
          IF        SIPC1END=0
            UNPACK    SIPCUD1,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L118
          IF        SIPC1END=0
            UNPACK    SIPCUD2,CCENT,CYEAR,CMON,CDAY           
            CALL      PACDATE
            MOVE      CPCDATE,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L119
          IF        SIPC1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIPCUY1,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
.
DP14L120
          IF        SIPC1END=0
            MOVE      NO,YESNO
            MOVE      ZERO,FORM2
            MOVE      SIPCUY2,FORM2    
            LOAD      YESNO,FORM2,YES
            MOVE      YESNO,VAR
            CALL      DISPITEM
          ELSE
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
          GOTO      DP14L010
DP14L600
          MATCH    "SIPC1",NAMSSFFI
          GOTO     DP14L605 IF NOT EQUAL
          CALL      TOTORD00
.
.
          MOVE      "   29",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      TOTALORD,VAR     
            CALL      DISPITEM
          ENDIF
          CALL      GORIG000
.
.
          MOVE      "   49",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      SIORNAME,VAR     
            CALL      DISPITEM
          ENDIF
          GOTO     DP14L999
DP14L605
DP14L999
          RETURN
.--------------------------------------------------------
. Display First Page of Multi Items
.--------------------------------------------------------
FP14L000
.
          MATCH    "SIPC1",NAMSSFFI
          GOTO     FP14L105 IF NOT EQUAL
          PACK     KEY10,SIPC1SKY,SP70
          CALL     RDSIPC1  * Start
          IF       OVRCD=0
            CALL     RPSIPC1  * Start
          ENDIF
          CALL     DP14L000
          GOTO     FP14L999
FP14L105
FP14L999  RETURN
.--------------------------------------------------------
. Display Last Page of Multi Items
.--------------------------------------------------------
LP14L000
.
          MATCH    "SIPC1",NAMSSFFI
          GOTO     LP14L105 IF NOT EQUAL
          PACK     KEY10,SIPC1SKY,Z70
          CALL     RSSIPC1  * End
          IF       OVRCD=1
            CALL     RPSIPC1 
          ENDIF
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPC1SNO
            CALL     RPSIPC1 
            IF       OVRCD=1
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            PACK     SIPC1MKY,SIPCPON,SIPCITM                                                                
            MATCH    SIPC1EKY,SIPC1MKY
            IF       !@EQUAL
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP14L000
          GOTO     LP14L999
LP14L105
LP14L999  RETURN
.--------------------------------------------------------
. Display Previous Page  
.--------------------------------------------------------
PP14L000
.
          MATCH    "SIPC1",NAMSSFFI
          GOTO     PP14L120 IF NOT EQUAL
          MOVE     ZERO,SECTOR
PP14L105
          CALL      RFTSIPC1
          BRANCH   OVRCD,PP14L115
          MOVE      SIPC1MKY,KEY10 
          CALL      RSSIPC1 
PP14L110
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<=SIPC1SNO
            CALL     RPSIPC1 
            IF       OVRCD=1
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            PACK     SIPC1MKY,SIPCPON,SIPCITM                                                                
            MATCH    SIPC1EKY,SIPC1MKY
            IF       !@EQUAL
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          CALL     DP14L000
          GOTO     PP14L999
PP14L115
          BEEP
          MOVE     ZERO,SECTOR
          WHILE    SECTOR<SIPC1SNO
            CALL     RKSIPC1 
            IF       OVRCD=1
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            PACK     SIPC1MKY,SIPCPON,SIPCITM                                                                
            MATCH    SIPC1EKY,SIPC1MKY
            IF       !@EQUAL
              MOVE     SIPC1SNO,SECTOR
            ENDIF
            ADD      ONE,SECTOR
          DO
          GOTO     PP14L999
PP14L120
PP14L999  RETURN
.--------------------------------------------------------
. Display Next Page of Multi Items
.--------------------------------------------------------
NP14L000
          MATCH    "SIPC1",NAMSSFFI
          GOTO     NP14L115 IF NOT EQUAL
NP14L105
          CALL     RKSIPC1 
          BRANCH   OVRCD,NP14L110
          PACK     SIPC1MKY,SIPCPON,SIPCITM                                                                
          MATCH    SIPC1EKY,SIPC1MKY
          GOTO     NP14L110 IF NOT EQUAL
          CALL     RPSIPC1 
          CALL     DP14L000
          GOTO     NP14L999
NP14L110
          CALL     RPSIPC1 
          BEEP
          GOTO     NP14L999
NP14L115
NP14L999  RETURN
.--------------------------------------------------------
. Clear Page of Multi Items from Temp File
.--------------------------------------------------------
CT14L000
CT14L105
CT14L999  RETURN
.---------------------------------------------------------
. Batch IO for Screen : Purchase Order Detail Display      
.---------------------------------------------------------
.---------------------------------------------------------
. Batch IO for :     1 Item Number                        
.---------------------------------------------------------
UPTSIPC1
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPC1FL1,KEY5;ANS
          IF        @OVER
            WRITE     SIPC1FL1,KEY5;SCPSROW,SCPSCOL,SIPC1MKY
          ELSE
            UPDATE    SIPC1FL1;SCPSROW,SCPSCOL,SIPC1MKY
          ENDIF
          RETURN
RDTSIPC1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SCPSROW,SCPSCOL
          READ      SIPC1FL1,KEY5;SCPSROW,SCPSCOL,SIPC1MKY
          GOTO      OVERCOND IF OVER
          RETURN
RFTSIPC1
          MOVE      ZERO,OVRCD
          PACK      KEY5,SP70
          READ      SIPC1FL1,KEY5;;
          READKS    SIPC1FL1;SCPSROW,SCPSCOL,SIPC1MKY
          GOTO      OVERCOND IF OVER
          MATCH     SP70,SIPC1MKY
          GOTO      OVERCOND IF EQUAL
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Order Detail Display      
.---------------------------------------------------------
DF14L000
          BRANCH   ACCEPT,DF14L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF14L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF14L900
          MATCH    PRGID,SCPSPID
          GOTO     DF14L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF14L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF14L010 IF NOT EQUAL
.
          CALL     PS14L000 * Display Field
          GOTO     DF14L010
DF14L900
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP14L000
DF14L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Order Detail Display      
.---------------------------------------------------------
PS14L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS14L999,PS14L999,PS14L999,PS14L999:
                            PS14L999,PS14L999,PS14L999,PS14L999:
                            PS14L999,PS14L999,PS14L999,PS14L999:
                            PS14L999,PS14L999,PS14L999,PS14L999:
                            PS14L999,PS14L999,PS14L999,PS14L999:
                            PS14L999,PS14L999,PS14L999,PS14L999:
                            PS14L999,PS14L999,PS14L999,PS14L999:
                           PS14L101,PS14L102,PS14L103,PS14L104:
                            PS14L105,PS14L106,PS14L107,PS14L108:
                            PS14L109,PS14L999,PS14L110,PS14L111:
                            PS14L112,PS14L113,PS14L114,PS14L115:
                            PS14L116,PS14L117,PS14L118,PS14L119:
                            PS14L120,PS14L121,PS14L122,PS14L999:
                           PS14L123,PS14L124,PS14L999
          GOTO     PS14L999
.
PS14L101
          CALL      TOTORD00
          MOVE      TOTALORD,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L102
          MOVE      SIPAPON,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L103
          MOVE      SIPASUP,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L104
          MOVE      SIPAORI,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L105
          MOVE      SIPAICN,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L106
          MOVE      SIPASCN,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L107
          MOVE      SIPADEL,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L108
          MOVE      SIPAMES,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L109
          UNPACK    SIPADIN,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L110
          MOVE      SIPACON,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L111
          MOVE      SIPAIDP,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L112
          MOVE      SIPAUR1,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L113
          MOVE      SIPAUR2,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L114
          UNPACK    SIPAUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L115
          UNPACK    SIPAUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L116
          MOVE      SIPAUC1,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L117
          MOVE      SIPAUC2,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPAUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L120
          CALL      GORIG000
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L121
          MOVE      CONFDESC,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L122
          MOVE      MESSDESC,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L123
          MOVE      APMASN1,VAR      
          CALL      DISPITEM
          GOTO     PS14L999
.
PS14L124
          MOVE      TRANSSTA,VAR     
          CALL      DISPITEM
          GOTO     PS14L999
PS14L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Order Detail Display      
.---------------------------------------------------------
SF14L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF14L001  BRANCH   ACCEPT,SF14L020
.
SF14L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF14L101,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L102,SF14L103,SF14L104,SF14L105:
                            SF14L006,SF14L006,SF14L106,SF14L006:
                           SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                            SF14L006,SF14L006,SF14L006,SF14L006:
                           SF14L006,SF14L006,SF14L107
SF14L006  BEEP
          GOTO     SF14L005
SF14L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF14L090
          MATCH    PRGID,SCSLPID
          GOTO     SF14L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF14L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF14L101,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                           SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                            SF14L020,SF14L020,SF14L020,SF14L020:
                           SF14L020,SF14L020,SF14L020
          GOTO     SF14L020
SF14L090  MOVE     ZERO,ACCEPT
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP14L000
          GOTO     SF14L001
.
SF14L101
          CALL      SELECTED
          BRANCH    EXIT,SF14L001
          COMPARE   ONE,ACCEPT
          GOTO      SF14L001 IF EQUAL
          CALL      RDTSIPC1
          IF        OVRCD=1
            BEEP
            GOTO      SF14L001
          ENDIF
          MATCH     SP70,SIPC1MKY
          IF        @EQUAL
            BEEP
            GOTO      SF14L001
          ENDIF
          MOVE      SIPC1MKY,KEY10 
          MOVE      ZERO,HLEF
          CALL      GETSCR00
          CALL      SELITM00
          MOVE      "14",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          CALL      RFTSIPC1
          IF        OVRCD=1
            CALL      FP14L000
          ELSE
            MOVE      SIPC1MKY,KEY10 
            CALL      RSSIPC1 
            CALL      RPSIPC1 
            CALL      DP14L000
          ENDIF
          GOTO     SF14L001
.
SF14L102
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      NP14L000
          GOTO     SF14L001
.
SF14L103
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      PP14L000
          GOTO     SF14L001
.
SF14L104
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      FP14L000
          GOTO     SF14L001
.
SF14L105
          MOVE      "SIPC1",NAMSSFFI
          MOVE      "    1",ITMSSFFI
          CALL      LP14L000
          GOTO     SF14L001
.
SF14L106
.
.
          MOVE      "   53",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SP70,APMASN1 
            PACK      VAR,SP70,SP70
            CALL      DISPITEM
          ENDIF
.
.
          MOVE      "   53",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE      APMASN1,VAR      
            CALL      DISPITEM
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      SF14L999
.
SF14L107
            MOVE      ZERO,HLEF
            CALL      GETSCR00
          CALL      SC16L000
          MOVE      "14",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   25",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          CALL      PUTSCR00
          GOTO      SF14L001
SF14L990  MOVE      ONE,EXIT * Exit Char Restart
SF14L999  RETURN
.--------------------------------
. Screen - Purchase Order Detail Item         
.--------------------------------
SC15L000
SC15L100
          MOVE      "15",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   42",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC15L200
          CALL      CF15L000 * Clear Fields
SC15L300
          CALL      KY15L000 * Enter Key Fields
          BRANCH    EXIT,SC15L999,SC15L999
SC15L400
          CALL      WP15L000 * Load any WP Details
SC15L500
          CALL      LM15L000 * Load any Batch Details
SC15L600
          CALL      DF15L000 * Display Fields
SC15L700
          CALL      SF15L000 * Select Fields
          BRANCH    EXIT,SC15L100,SC15L100,SC15L200
SC15L800
SC15L900
SC15L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Purchase Order Detail Item         
.-------------------------------------------------------
CF15L000
CF15L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Purchase Order Detail Item         
.--------------------------------------------------------
KY15L000
          MOVE      ZERO,EXIT
          GOTO      KY15L999
.
KY15L900  MOVE      ONE,EXIT
KY15L999  RETURN
.---------------------------------------------------------
. Load WP files for : Purchase Order Detail Item         
.---------------------------------------------------------
WP15L000
          PREP     TEMPWORD,FILSIPD1
          PACK     KEY13,SIPCPON,SIPCITM,SP70
          MOVE     KEY13,SAVKEY80
          SETLPTR  SAVKEY80,10
          CALL      RDSIPD1 
          IF        OVRCD=0
            CALL      RPSIPD1 
          ENDIF
WP15L100
          CALL     RKSIPD1 
          BRANCH   OVRCD,WP15L105
          PACK     KEY13,SIPDPON,SIPDITM,SIPDLIN
          MATCH    SAVKEY80,KEY13   
          GOTO     WP15L105 IF NOT EQUAL
          PACK     VAR,SIPDCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIPDCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP15L100
WP15L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Purchase Order Detail Item         
.---------------------------------------------------------
LM15L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Purchase Order Detail Item         
.---------------------------------------------------------
DF15L000
          BRANCH   ACCEPT,DF15L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF15L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF15L900
          MATCH    PRGID,SCPSPID
          GOTO     DF15L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF15L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF15L010 IF NOT EQUAL
.
          CALL     PS15L000 * Display Field
          GOTO     DF15L010
DF15L900
DF15L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Purchase Order Detail Item         
.---------------------------------------------------------
PS15L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS15L101,PS15L102,PS15L103,PS15L104:
                            PS15L105,PS15L106,PS15L107,PS15L108:
                            PS15L109,PS15L110,PS15L111,PS15L112:
                            PS15L113,PS15L114,PS15L115,PS15L116:
                            PS15L117,PS15L118,PS15L119,PS15L120:
                            PS15L121,PS15L122,PS15L123,PS15L124:
                            PS15L125,PS15L126,PS15L127,PS15L128:
                            PS15L129,PS15L130,PS15L131,PS15L132:
                            PS15L133,PS15L134,PS15L135,PS15L136:
                            PS15L137,PS15L138,PS15L139,PS15L999:
                            PS15L140,PS15L999
          GOTO     PS15L999
.
PS15L101
          MOVE      SIPCITM,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L102
          MOVE      SIPCCST,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L103
          MOVE      SIPCPRD,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L104
          MOVE      SIPCDAT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L105
          MOVE      SIPCWAR,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L106
          MOVE      SIPCCAT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L107
          MOVE      SIPCPN,VAR       
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L108
          MOVE      SIPCPD,VAR       
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L109
          MOVE      SIPCCON,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L110
          UNPACK    SIPCCDT,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L111
          MOVE      SIPCSUT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L112
          UNPACK    SIPCEDD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L113
          UNPACK    SIPCFDD,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L114
          MOVE      SIPCOQT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L115
          MOVE      SIPCIQT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L116
          MOVE      SIPCRQT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L117
          MOVE      SIPCECT,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L118
          MOVE      SIPCTCR,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L119
          MOVE      SIPCTIN,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L120
          MOVE      SIPCOQO,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L121
          MOVE      SIPCOOP,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L122
          MOVE      SIPCUR1,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L123
          MOVE      SIPCUR2,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L124
          UNPACK    SIPCUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L125
          UNPACK    SIPCUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L126
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPCUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L127
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIPCUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L128
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L129
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L130
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L131
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L132
          MOVE      SIIANON,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L133
          MOVE      SIIASUS,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L134
          MOVE      SIWADES,VAR      
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L135
          MOVE      SICADESC,VAR     
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L136
          MOVE      SICATELE,VAR     
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L137
          MOVE      SICACONT,VAR     
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L138
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L139
          MOVE      SISACOMM,VAR     
          CALL      DISPITEM
          GOTO     PS15L999
.
PS15L140
          MOVE     FILSIPD1,WORDNAME
          CALL     DISPWORD
          GOTO     PS15L999
PS15L999
          RETURN
.---------------------------------------------------------
. Selections for : Purchase Order Detail Item         
.---------------------------------------------------------
SF15L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF15L001  BRANCH   ACCEPT,SF15L020
.
SF15L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L006:
                            SF15L006,SF15L006,SF15L006,SF15L101:
                            SF15L102,SF15L006
SF15L006  BEEP
          GOTO     SF15L005
SF15L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF15L090
          MATCH    PRGID,SCSLPID
          GOTO     SF15L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF15L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L020,SF15L020,SF15L020,SF15L020:
                            SF15L102,SF15L020
          GOTO     SF15L020
SF15L090  MOVE     ZERO,ACCEPT
          GOTO     SF15L001
.
SF15L101
          MOVE      ZERO,EXIT
          GOTO      SF15L999
.
SF15L102
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     "12",SCPSROW
              MOVE     " 10",SCPSCOL
              MOVE     " 60",SCPSLEN
              MOVE     "10",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIPD1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIPD1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF15L001
SF15L990  MOVE      ONE,EXIT * Exit Char Restart
SF15L999  RETURN
.--------------------------------
. Screen - Transmission Details               
.--------------------------------
SC16L000
SC16L100
          MOVE      "16",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "    1",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      "10",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC16L200
          CALL      CF16L000 * Clear Fields
          CALL      SETSCR16
SC16L300
          CALL      KY16L000 * Enter Key Fields
          BRANCH    EXIT,SC16L999,SC16L999
SC16L400
          CALL      WP16L000 * Load any WP Details
SC16L500
          CALL      LM16L000 * Load any Batch Details
SC16L600
          CALL      DF16L000 * Display Fields
SC16L700
          CALL      SF16L000 * Select Fields
          BRANCH    EXIT,SC16L100,SC16L100,SC16L200
SC16L800
SC16L900
SC16L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Transmission Details               
.-------------------------------------------------------
CF16L000
CF16L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Transmission Details               
.--------------------------------------------------------
KY16L000
          MOVE      ZERO,EXIT
          GOTO      KY16L999
.
KY16L900  MOVE      ONE,EXIT
KY16L999  RETURN
.---------------------------------------------------------
. Load WP files for : Transmission Details               
.---------------------------------------------------------
WP16L000
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Transmission Details               
.---------------------------------------------------------
LM16L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Transmission Details               
.---------------------------------------------------------
DF16L000
          BRANCH   ACCEPT,DF16L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF16L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF16L900
          MATCH    PRGID,SCPSPID
          GOTO     DF16L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF16L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF16L010 IF NOT EQUAL
.
          CALL     PS16L000 * Display Field
          GOTO     DF16L010
DF16L900
DF16L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Transmission Details               
.---------------------------------------------------------
PS16L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS16L999,PS16L999,PS16L101,PS16L102:
                            PS16L103,PS16L104,PS16L105,PS16L106:
                            PS16L107,PS16L108,PS16L109
          GOTO     PS16L999
.
PS16L101
          MOVE      TRANSST2,VAR     
          CALL      DISPITEM
          GOTO     PS16L999
.
PS16L102
          MOVE      SITRUSER,VAR     
          CALL      DISPITEM
          GOTO     PS16L999
.
PS16L103
          MOVE      SECUSER,VAR      
          CALL      DISPITEM
          GOTO     PS16L999
.
PS16L104
          MOVE      SITRCREA,VAR     
          CALL      DISPITEM
          GOTO     PS16L999
.
PS16L105
          MOVE      SITRORG,VAR      
          CALL      DISPITEM
          GOTO     PS16L999
.
PS16L106
          MOVE      SIORNAME,VAR     
          CALL      DISPITEM
          GOTO     PS16L999
.
PS16L107
          UNPACK    SITREDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS16L999
.
PS16L108
          UNPACK    SITRTDAT,CCENT,CYEAR,CMON,CDAY          
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS16L999
.
PS16L109
          MOVE      SITRTNUM,VAR     
          CALL      DISPITEM
          GOTO     PS16L999
PS16L999
          RETURN
.---------------------------------------------------------
. Selections for : Transmission Details               
.---------------------------------------------------------
SF16L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF16L001  BRANCH   ACCEPT,SF16L020
.
SF16L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF16L006,SF16L101,SF16L006,SF16L006:
                            SF16L006,SF16L006,SF16L006,SF16L006:
                            SF16L006,SF16L006,SF16L006
SF16L006  BEEP
          GOTO     SF16L005
SF16L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF16L090
          MATCH    PRGID,SCSLPID
          GOTO     SF16L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF16L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF16L020,SF16L020,SF16L020,SF16L020:
                            SF16L020,SF16L020,SF16L020,SF16L020:
                            SF16L020,SF16L020,SF16L020
          GOTO     SF16L020
SF16L090  MOVE     ZERO,ACCEPT
          GOTO     SF16L001
.
SF16L101
          MOVE      ZERO,EXIT
          GOTO      SF16L999
SF16L990  MOVE      ONE,EXIT * Exit Char Restart
SF16L999  RETURN
.--------------------------------
. Screen - Catalog Details                    
.--------------------------------
SC20L000
SC20L100
          MOVE      "20",SCRID
          MOVE      ZERO,PRCOL
          MOVE      ZERO,PRVERT
          MOVE      "   33",FLDID
          CALL      GETPOSIT
          IF        EXIT=0
            MOVE     SCPSCOL,PRCOL
            MOVE     SCPSROW,PRVERT
          ENDIF
          MOVE      "  1",CLEF
          MOVE      " 80",CRIG
          MOVE      " 7",CTOP
          MOVE      "24",CBOT
          CALL      VBACK000 * Display Background
          MOVE      ZERO,CLEF
          MOVE      ZERO,CTOP
          MOVE      ZERO,CRIG
          MOVE      ZERO,CBOT
.
SC20L200
          CALL      CF20L000 * Clear Fields
SC20L300
          CALL      KY20L000 * Enter Key Fields
          BRANCH    EXIT,SC20L999,SC20L999
SC20L400
          CALL      WP20L000 * Load any WP Details
SC20L500
          CALL      LM20L000 * Load any Batch Details
SC20L600
          CALL      DF20L000 * Display Fields
SC20L700
          CALL      SF20L000 * Select Fields
          BRANCH    EXIT,SC20L100,SC20L100,SC20L200
SC20L800
SC20L900
SC20L999  RETURN
.--------------------------------------------------------
. Clear Fields for Screen : Catalog Details                    
.-------------------------------------------------------
CF20L000
CF20L999  RETURN
.--------------------------------------------------------
. Enter Key Fields for Catalog Details                    
.--------------------------------------------------------
KY20L000
          MOVE      ZERO,EXIT
          GOTO      KY20L999
.
KY20L900  MOVE      ONE,EXIT
KY20L999  RETURN
.---------------------------------------------------------
. Load WP files for : Catalog Details                    
.---------------------------------------------------------
WP20L000
          PREP     TEMPWORD,FILSIID1
          PACK     KEY15,SIICCAT,SIICSUP,SP70
          MOVE     KEY15,SAVKEY80
          SETLPTR  SAVKEY80,12
          CALL      RDSIID1 
          IF        OVRCD=0
            CALL      RPSIID1 
          ENDIF
WP20L100
          CALL     RKSIID1 
          BRANCH   OVRCD,WP20L105
          PACK     KEY15,SIIDCAT,SIIDSUP,SIIDLIN
          MATCH    SAVKEY80,KEY15   
          GOTO     WP20L105 IF NOT EQUAL
          PACK     VAR,SIIDCOM,SP70,SP70
          STRIP    VAR
          MOVELPTR VAR,F3
          SFORMAT  VAR,F3
          MOVE     SIIDCOM,VAR
          IF       F3=0
            WRITE    TEMPWORD,SEQ;
          ELSE
            WRITE    TEMPWORD,SEQ;VAR
          ENDIF
          SFORMAT  VAR,127
          GOTO     WP20L100
WP20L105  CLOSE    TEMPWORD
          RETURN
.---------------------------------------------------------
. Load Batch Screen for : Catalog Details                    
.---------------------------------------------------------
LM20L000
          RETURN
.---------------------------------------------------------
. Display Fields for : Catalog Details                    
.---------------------------------------------------------
DF20L000
          BRANCH   ACCEPT,DF20L999
          PACK     KEY15,PRGID,SCRID,SP70
          CALL     RSSCPS1
DF20L010
          CALL     RKSCPS1
          BRANCH   OVRCD,DF20L900
          MATCH    PRGID,SCPSPID
          GOTO     DF20L900 IF NOT EQUAL
          MATCH    SCRID,SCPSSID
          GOTO     DF20L900 IF NOT EQUAL
          MATCH    SP70,SCPSMTY
          GOTO     DF20L010 IF NOT EQUAL
.
          CALL     PS20L000 * Display Field
          GOTO     DF20L010
DF20L900
DF20L999
          RETURN
.---------------------------------------------------------
. Display/Print Fields for : Catalog Details                    
.---------------------------------------------------------
PS20L000   PACK      VAR,SP70,SP70
          PACK     PRINTVAR,SP70,SP70
          MOVE     SCPSITM,FIELDNO
          BRANCH    FIELDNO,PS20L101,PS20L102,PS20L103,PS20L104:
                            PS20L105,PS20L106,PS20L107,PS20L108:
                            PS20L109,PS20L110,PS20L111,PS20L112:
                            PS20L113,PS20L114,PS20L115,PS20L116:
                            PS20L117,PS20L118,PS20L119,PS20L120:
                            PS20L121,PS20L122,PS20L123,PS20L124:
                            PS20L125,PS20L126,PS20L127,PS20L999:
                           PS20L128,PS20L129,PS20L130,PS20L131:
                            PS20L999,PS20L999,PS20L132,PS20L133:
                            PS20L134
          GOTO     PS20L999
.
PS20L101
          MOVE      SIIACAT,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L102
          MOVE      SIIADES,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L103
          MOVE      SIIASUB,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L104
          MOVE      SIIAISS,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L105
          MOVE      SIIAAVC,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L106
          MOVE      SISADESC,VAR     
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L107
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIIANON,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L108
          MOVE      SIIASUS,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L109
          MOVE      SUSPDESC,VAR     
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L110
          MOVE      SIICSUP,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L111
          MOVE      SIICSUT,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L112
          MOVE      SIICCCT,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L113
          MOVE      SIICLCT,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L114
          MOVE      SIICLTM,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L115
          MOVE      SIICPNO,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L116
          MOVE      SIICPD1,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L117
          MOVE      SIICPD2,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L118
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICMAN,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L119
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICAPO,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L120
          MOVE      SIICUR1,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L121
          MOVE      SIICUR2,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L122
          UNPACK    SIICUD1,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L123
          UNPACK    SIICUD2,CCENT,CYEAR,CMON,CDAY           
          CALL      PACDATE
          MOVE      CPCDATE,VAR
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L124
          MOVE      SIICUC1,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L125
          MOVE      SIICUC2,VAR      
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L126
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY1,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L127
          MOVE      NO,YESNO
          MOVE      ZERO,FORM2
          MOVE      SIICUY2,FORM2    
          LOAD      YESNO,FORM2,YES
          MOVE      YESNO,VAR
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L128
          MOVE      UDC1DESC,VAR     
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L129
          MOVE      UDC2DESC,VAR     
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L130
          CALL      NSIID000
          MOVE      NOTESIID,VAR     
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L131
          MOVE     FILSIID1,WORDNAME
          CALL     DISPWORD
          GOTO     PS20L999
.
PS20L132
          MOVE      SIFACTOR,VAR     
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L133
          MOVE      ISSLCOST,VAR     
          CALL      DISPITEM
          GOTO     PS20L999
.
PS20L134
          MOVE      ISSCCOST,VAR     
          CALL      DISPITEM
          GOTO     PS20L999
PS20L999
          RETURN
.---------------------------------------------------------
. Selections for : Catalog Details                    
.---------------------------------------------------------
SF20L000  PACK     KEY13,PRGID,SCRID,SP70
          CALL     RSSCSL1
SF20L001  BRANCH   ACCEPT,SF20L020
.
SF20L005  CALL     MTSTQ000
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF20L006,SF20L006,SF20L006,SF20L006:
                            SF20L006,SF20L006,SF20L006,SF20L006:
                            SF20L006,SF20L006,SF20L006,SF20L006:
                            SF20L006,SF20L006,SF20L006,SF20L006:
                            SF20L006,SF20L006,SF20L006,SF20L006:
                            SF20L006,SF20L006,SF20L006,SF20L006:
                            SF20L006,SF20L006,SF20L006,SF20L006:
                           SF20L006,SF20L006,SF20L006,SF20L101:
                            SF20L006,SF20L102,SF20L006,SF20L006:
                            SF20L006
SF20L006  BEEP
          GOTO     SF20L005
SF20L020  CALL     RKSCSL1
          BRANCH   OVRCD,SF20L090
          MATCH    PRGID,SCSLPID
          GOTO     SF20L090 IF NOT EQUAL
          MATCH    SCRID,SCSLSID
          GOTO     SF20L090 IF NOT EQUAL
          MOVE     SCSLITM,FIELDNO
          BRANCH    FIELDNO,SF20L020,SF20L020,SF20L020,SF20L020:
                            SF20L020,SF20L020,SF20L020,SF20L020:
                            SF20L020,SF20L020,SF20L020,SF20L020:
                            SF20L020,SF20L020,SF20L020,SF20L020:
                            SF20L020,SF20L020,SF20L020,SF20L020:
                            SF20L020,SF20L020,SF20L020,SF20L020:
                            SF20L020,SF20L020,SF20L020,SF20L020:
                           SF20L020,SF20L020,SF20L020,SF20L101:
                            SF20L020,SF20L020,SF20L020,SF20L020:
                            SF20L020
          GOTO     SF20L020
SF20L090  MOVE     ZERO,ACCEPT
          GOTO     SF20L001
.
SF20L101
          CALL     SELECTED
          IF       EXIT=1
            IF       ACCEPT=0
              MOVE     " 8",SCPSROW
              MOVE     "  1",SCPSCOL
              MOVE     " 78",SCPSLEN
              MOVE     "14",SCPSNOR
              MOVE     SCPSROW,CVERT
              MOVE     SCPSCOL,CCOL
              MOVE     ZERO,HLEF
              CALL     GETSCR00
              MOVE     FILSIID1,WORDNAME
              MOVE     " 12",WORDTYPE
              CALL     EDITWORD
              CALL     PUTSCR00
            ENDIF
          ELSE
            MOVE     FILSIID1,WORDNAME
            MOVE     " 12",WORDTYPE
            IF       ACCEPT=0
               CALL     EDITWORD
            ENDIF
          ENDIF
          GOTO     SF20L001
.
SF20L102
          MOVE      ZERO,EXIT
          GOTO      SF20L999
SF20L990  MOVE      ONE,EXIT * Exit Char Restart
SF20L999  RETURN
.@@@@@ Function Restart Point @@@@@
.----------------------------------------------------------------------
. Read controlf file data and open gl files
.----------------------------------------------------------------------
RDCON000  READ      CONTROLF,TWENTY3;*95,HACCNT
          READ      CONTROLF,TWENTY4;*135,HACCDATA
.
.---- note there files are opened regardless of GL system status ----
.
          IF        HACCNT<>1
            PACK      HACCDATA,SP70,SP70    * clear path if not active
          ENDIF
.
          MOVE      "fmscodaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      FMSCODA1,KEY80
.
          MOVE      "apsppdaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      APSPPDA1,KEY80
.
          MOVE      "apsctsaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      APSCTSA1,KEY80
.
          COMPARE   ONE,HACCNT
          GOTO      RDCON999 IF NOT EQUAL
.
.---- accounting system active ----
.
          MOVE      "apsislaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      APSISLA1,KEY80
.
          MOVE      "apscioaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      APSCIOA1,KEY80
          OPEN      APSCIOA2,KEY80
.
          MOVE      "apsordaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      APSORDA1,KEY80
.
          MOVE      "apsimsaf",KEY8
          PACK      KEY80,HACCDATA,KEY8
          SQUEEZE   KEY80
          OPEN      APSIMSA1,KEY80
          OPEN      APSIMSA2,KEY80
          OPEN      APSIMSA3,KEY80
          OPEN      APSIMSA4,KEY80
          OPEN      APSIMSA5,KEY80
          OPEN      APSIMSA6,KEY80
.
RDCON999  RETURN
.------------------------------------------------------------------------
. Open Nato X-Ref File if required
.------------------------------------------------------------------------
ONAT0000  OPEN      CONTROLF,"controlf"
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*143,HNONUSAG
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ONE,HNONUSAG
            WRITAB    CONTROLF,SIXTY3;*143,HNONUSAG
          ENDIF
.
          MOVE      ZERO,OVRCD
          TRAP      OVERCOND IF FORMAT
          READ      CONTROLF,SIXTY3;*141,INCNNATO
          TRAPCLR   FORMAT
          IF        OVRCD=1
            MOVE      ZERO,INCNNATO
            WRITAB    CONTROLF,SIXTY3;*141,INCNNATO
          ENDIF
.
          IF        INCNNATO=1
            MOVE      ZERO,OVRCD
            TRAP      OVERCOND IF IO
            OPEN      SINNATA1,"sinnataf"
            TRAPCLR   IO
            IF        OVRCD=1
              DISPLAY   *P1:24,*EL,*B,"Nato file does not exist. Run fixit.  ";
              CALL      HITENTER
              CHAIN     PGM
            ENDIF
.
            OPEN      SINNATA2,"sinnataf"
          ENDIF
.
ONAT9999  RETURN
.----------------------------------------------------------------------
. Enter Creditor Code for Enquiries and Read all Relevant Information
.----------------------------------------------------------------------
ECRED000
          MOVE      ZERO,CKEYTYP
          CALL      KAPMAB00
          BRANCH    EXIT,ECRED999,ECRED999
.
. Determine Notes Indicators
.
          MOVE      SP70,NOTEAPCN
          MOVE      SP70,NOTEAPSN
          PACK      KEY8,APMACRD,SP70
          CALL      RSAPCN1
.
ECRED010  CALL      RKAPCN1
          BRANCH    OVRCD,ECRED020
          MATCH     APMACRD,APCNCRD
          GOTO      ECRED020 IF NOT EQUAL
          MATCH     SP70,APCNDAT
          GOTO      ECRED010 IF EQUAL
          MOVE      "Creditor Notes",NOTEAPCN
.
ECRED020  PACK      KEY8,APMACRD,SP70
          CALL      RSAPSN1
ECRED030  CALL      RKAPSN1
          BRANCH    OVRCD,ECRED040
          MATCH     APMACRD,APSNCRD
          GOTO      ECRED040 IF NOT EQUAL
          MATCH     SP70,APSNDAT
          GOTO      ECRED030 IF EQUAL
          MOVE      "Supplier Notes",NOTEAPSN
ECRED040
.
. Determine Creditor Type Description
.
          MOVE      APMATYP,KEY3
          CALL      RDAPCT1
          IF        OVRCD=1
            MOVE      SP70,APCTDESC
            MOVE      SP70,APCTCODE
          ENDIF
.
. Default Payment Period Details
.
          MOVE      APMAPPD,KEY2
          CALL      RDAPPP1
          IF        OVRCD=1
            MOVE      SP70,OFFSDESC
            MOVE      SP70,APPPDES
            MOVE      ZERO,APPPTYP
            MOVE      ZERO,APPPDA1
            MOVE      ZERO,APPPPE1
            MOVE      ZERO,APPPDA2
            MOVE      ZERO,APPPPE2
            MOVE      ZERO,APPPDA3
            MOVE      ZERO,APPPPE3
          ELSE
            IF        APPPTYP=0
              MOVE     "Invoice Date      ",OFFSDESC
            ENDIF
            IF        APPPTYP=1
              MOVE     "Batch Entered Date",OFFSDESC
            ENDIF
            IF        APPPTYP=2
              MOVE     "Batch Period Date ",OFFSDESC
            ENDIF
            IF        APPPTYP=3
              MOVE     "Fixed Day of Month",OFFSDESC
            ENDIF
          ENDIF
.
. Combined Creditor Name and Address Details
.
          STRIP    APMACN1
          STRIP    APMACN2
          CLEAR    CRDNAM80
          APPEND   APMACN1,CRDNAM80
          APPEND   SP1,CRDNAM80
          APPEND   APMACN2,CRDNAM80
          RESET    CRDNAM80
.
          STRIP    APMACA1
          STRIP    APMACA2
          STRIP    APMACA3
          STRIP    APMACPC
          CLEAR    CRDADD80
          APPEND   APMACA1,CRDADD80
          APPEND   SP1,CRDADD80
          APPEND   APMACA2,CRDADD80
          APPEND   SP1,CRDADD80
          APPEND   APMACA3,CRDADD80
          APPEND   SP1,CRDADD80
          APPEND   APMACPC,CRDADD80
          RESET    CRDADD80
.
          CLEAR    KEY5
.
. Combined Suppliers Name and Address Details
.
          STRIP    APMASN1
          STRIP    APMASN2
          CLEAR    SUPNAM80
          APPEND   APMASN1,SUPNAM80
          APPEND   SP1,SUPNAM80
          APPEND   APMASN2,SUPNAM80
          RESET    SUPNAM80
.
          STRIP    APMASA1
          STRIP    APMASA2
          STRIP    APMASA3
          STRIP    APMASPC
          CLEAR    SUPADD80
          APPEND   APMASA1,SUPADD80
          APPEND   SP1,SUPADD80
          APPEND   APMASA2,SUPADD80
          APPEND   SP1,SUPADD80
          APPEND   APMASA3,SUPADD80
          APPEND   SP1,SUPADD80
          APPEND   APMASPC,SUPADD80
          RESET    SUPADD80
.
          CLEAR    KEY5
          APPEND   "a1",KEY5
          APPEND   APMAUC1,KEY5
          RESET    KEY5
          CALL     RDFMCD1
          IF       OVRCD=0
            MOVE     FMCDDESC,UDDESC1
          ELSE
            MOVE     SP70,UDDESC1
          ENDIF
.
          CLEAR    KEY5
          APPEND   "a2",KEY5
          APPEND   APMAUC2,KEY5
          RESET    KEY5
          CALL     RDFMCD1
          IF       OVRCD=0
            MOVE     FMCDDESC,UDDESC2
          ELSE
            MOVE     SP70,UDDESC2
          ENDIF
.
          IF        HACCNT=1
            CALL      COUTS000         * Calculate Outstanding for Creditor
          ENDIF
.
ECRED999  RETURN
EPYR0000  CALL      RINPECON
          MOVE      SIPECYR,FINYEAR
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,*JR,FINYEAR
          PACK      FINYEAR,FINYEAR,SP70
.
          MATCH     SP70,FINYEAR
          GOTO      EPYR0990 IF EQUAL
          PACK      KEY4,SP3,EXITCHAR
          MATCH     KEY4,FINYEAR
          GOTO      EPYR0990 IF EQUAL
.
          TYPE      FINYEAR
          GOTO      EPYR0050 IF EQUAL
.
          BEEP
          MOVE      "Invalid Financial Year - ",DISPMSG
          CALL      MESSAGE1
          GOTO      EPYR0000
.
EPYR0050  MOVE      FINYEAR,SIPEYF4
          IF        SIPEYF4<100
            SQUEEZE   FINYEAR
            MOVE      FINYEAR,FORM2
            PACK      FINYEAR,CCC,FORM2,SP70
          ENDIF
.
          REP       " 0",FINYEAR
          MOVE      ZERO,BUDPERXX
          MOVE      ZERO,ACTPERXX
          MOVE      ZERO,VARPERXX
.
          MOVE      ZERO,F2
EPYR0100  ADD       ONE,F2
          IF        F2>SIPENUM
            GOTO      EPYR0900
          ENDIF
          PACK      APSBDAT,FINYEAR,F2
          REP       " 0",APSBDAT
          PACK      KEY11,APMACRD,APSBDAT
          CALL      RDAPSB1
          IF        OVRCD=1
            MOVE      ZERO,APSBPBD
            MOVE      ZERO,APSBPAM
            MOVE      ZERO,APSBIAM
          ENDIF
.
          STORE     APSBPBD,F2,BUDPER01,BUDPER02,BUDPER03,BUDPER04:
                               BUDPER05,BUDPER06,BUDPER07,BUDPER08:
                               BUDPER09,BUDPER10,BUDPER11,BUDPER12,BUDPER13
          STORE     APSBPAM,F2,ACTPER01,ACTPER02,ACTPER03,ACTPER04:
                               ACTPER05,ACTPER06,ACTPER07,ACTPER08:
                               ACTPER09,ACTPER10,ACTPER11,ACTPER12,ACTPER13
          STORE     APSBIAM,F2,VARPER01,VARPER02,VARPER03,VARPER04:
                               VARPER05,VARPER06,VARPER07,VARPER08:
                               VARPER09,VARPER10,VARPER11,VARPER12,VARPER13
          ADD       APSBIAM,VARPERXX
          ADD       APSBPBD,BUDPERXX
          ADD       APSBPAM,ACTPERXX
          GOTO      EPYR0100
.
EPYR0900  GOTO      EPYR0999
.
EPYR0990  MOVE      TWO,EXIT
EPYR0999  RETURN
GPHU0000
.----------------------------------------------------------------------
. Create Temp File By Calling Following OPNGRAPH
.----------------------------------------------------------------------
          CALL      OPNGRAPH
.----------------------------------------------------------------------
. Insert Data to be Graphed into Temp File
.----------------------------------------------------------------------
          MOVE      ZERO,F3
.
GPHU1000  ADD       ONE,F3
          LOAD      SCGPDES,F3,HAPER1,HAPER2,HAPER3,HAPER4,HAPER5,HAPER6:
                               HAPER7,HAPER8,HAPER9,HAPER10,HAPER11,HAPER12:
                               HAPER13
          MOVE      F3,SCGPPER
          MOVE      "  1",SCGPITM * Actual
          LOAD      SCGPVAL,F3,ACTPER01,ACTPER02,ACTPER03,ACTPER04:
                               ACTPER05,ACTPER06,ACTPER07,ACTPER08:
                               ACTPER09,ACTPER10,ACTPER11,ACTPER12,ACTPER13
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
.
          MOVE      "  2",SCGPITM * Budget
          LOAD      SCGPVAL,F3,BUDPER01,BUDPER02,BUDPER03,BUDPER04:
                               BUDPER05,BUDPER06,BUDPER07,BUDPER08:
                               BUDPER09,BUDPER10,BUDPER11,BUDPER12,BUDPER13
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
.
          MOVE      "  3",SCGPITM * Invoiced
          LOAD      SCGPVAL,F3,VARPER01,VARPER02,VARPER03,VARPER04:
                               VARPER05,VARPER06,VARPER07,VARPER08:
                               VARPER09,VARPER10,VARPER11,VARPER12,VARPER13
          PACK      KEY6,SCGPPER,SCGPITM
          CALL      RASCGP1
          IF        OVRCD=0
            CALL      UPSCGP1
          ELSE
            CALL      WRSCGP1
          ENDIF
.
          COMPARE   SIPENUM,F3
          GOTO      GPHU1000 IF NOT EQUAL
.----------------------------------------------------------------------
. Setup Name of Graph and Legend
.----------------------------------------------------------------------
          STRIP     APMASN1
          CLEAR     GPHNAME
          APPEND    APMASN1,GPHNAME
          APPEND    " Purchases for the Year ",GPHNAME
          APPEND    FINYEAR,GPHNAME
          RESET     GPHNAME
          MOVE      "Ordered   ",GPHLEDG[1]
          MOVE      "Budget     ",GPHLEDG[2]
          MOVE      "Invoiced   ",GPHLEDG[3]
.
          MOVE      TEN,GPHNOCOY    * Width of Y Axis Description Display
          MOVE      THREE,GPHNTYP   * Number of Columns per Period
          IF        SIPENUM=12
            MOVE      SIX,GPHNOCOX  * Width of X Axis Description Display
          ELSE
            MOVE      FIVE,GPHNOCOX * Width of X Axis Description Display
          ENDIF
          MOVE      ZERO,GPHTYPE    * Initial Display Type 0=X 1=Y
          CALL      DISGRAPH        * Routine to Display Graph
.----------------------------------------------------------------------
. When Complete Call CLSGRAPH to Close and Delete Temp
.----------------------------------------------------------------------
          CALL      CLSGRAPH
.
          RETURN
.
.----------------------------------------------------------------------
. set up screen 03
.----------------------------------------------------------------------
SETSCR03  MOVE      ZERO,EXIT
          IF        HACCNT<>1
            BEEP
            CLEAR     DISPMSG
            APPEND    "GL Interface Not Active - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
          ENDIF
.
          CALL      CLRREF00
.
          RETURN
.----------------------------------------------------------------------
. set up screen 04
.----------------------------------------------------------------------
SETSCR04  MOVE      ZERO,EXIT
          IF        HACCNT<>1
            BEEP
            CLEAR     DISPMSG
            APPEND    "GL Interface Not Active - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
          ENDIF
.
          CALL      CLRREF00
.
          RETURN
.------------------------------------------------------------
. Calculate Outstanding for a Creditor
.
. AMTOUT00 - Current
. AMTOUT30 - 30 Days
. AMTOUT60 - 60 Days
. AMTOUT90 - 90 Days
. AMTOUT99 - Total
. AMTWRK00 - Working Variable
.
.------------------------------------------------------------
COUTS000  MOVE      ZERO,AMTOUT00
          MOVE      ZERO,AMTOUT30
          MOVE      ZERO,AMTOUT60
          MOVE      ZERO,AMTOUT90
          MOVE      ZERO,AMTOUT99
.
          MOVE      CCC,CC
          MOVE      CYY,YY
          MOVE      CMM,MM
          MOVE      CDD,DD
          CALL      DMYCON
          MOVE      JULDAY,CURJDAY
          ASSIGN    (JULCC*100)+JULYR,CURJYEAR
.
          PACK      KEY41,ONE,APMACRD,SP70
          CALL      RSAPIM6
COUTS100  CALL      RKAPIM6                  * Loop Through Outstanding Trans
          BRANCH    OVRCD,COUTS999
          MATCH     "1",APIMOUT
          GOTO      COUTS999 IF NOT EQUAL
          MATCH     APMACRD,APIMCRD
          GOTO      COUTS999 IF NOT EQUAL
.
          MATCH     "0",APIMTYP
          GOTO      COUTS110 IF EQUAL
          MATCH     "1",APIMTYP
          GOTO      COUTS100 IF NOT EQUAL
.
COUTS110  PACK      KEY41,APIMOUT,APIMCRD,APIMREF,APIMDOC,APIMBCH
          ASSIGN    APIMTOT-APIMDIS+APIMGST-APIMPAY,AMTWRK00
          COMPARE   ZERO,AMTWRK00
          GOTO      COUTS200 IF NOT EQUAL
.----------------------------------------
. Zero Outstanding so Update Flag
.----------------------------------------
COUTS150  PACK      KEY40,APIMBCH,APIMCRD,APIMREF,APIMDOC
          CALL      RDAPIM1
          IF        OVRCD=0
            MOVE      ZERO,APIMOUT
            CALL      UPAPIM1
          ENDIF
          PACK      KEY41,ONE,APIMCRD,APIMREF,APIMDOC,APIMBCH
          CALL      RSAPIM6
          GOTO      COUTS100
.
COUTS200  MATCH     "1",APIMTYP
          IF        @EQUAL
            MULT      SEQ,AMTWRK00
          ENDIF
.
          ADD       AMTWRK00,AMTOUT99
.
          UNPACK    APIMIDT,CCENT,CYEAR,CMON,CDAY
          MOVE      CCENT,CC
          MOVE      CYEAR,YY
          MOVE      CMON,MM
          MOVE      CDAY,DD
          CALL      DMYCON
          MOVE      JULDAY,WRKJDAY
          ASSIGN    (JULCC*100)+JULYR,WRKJYEAR
.
          IF        WRKJYEAR>CURJYEAR
            ADD       AMTWRK00,AMTOUT00
            GOTO      COUTS100
          ENDIF
          IF        WRKJYEAR+1<CURJYEAR
            ADD       AMTWRK00,AMTOUT90
            GOTO      COUTS100
          ENDIF
          IF        WRKJYEAR<CURJYEAR
            ASSIGN    WRKJDAY-LEAPYR-365,WRKJDAY
          ENDIF
.
          ASSIGN    CURJDAY-WRKJDAY,WRKJDAY
          IF        WRKJDAY<31
            ADD       AMTWRK00,AMTOUT00
            GOTO      COUTS100
          ENDIF
          IF        WRKJDAY<61
            ADD       AMTWRK00,AMTOUT30
            GOTO      COUTS100
          ENDIF
          IF        WRKJDAY<91
            ADD       AMTWRK00,AMTOUT60
            GOTO      COUTS100
          ENDIF
          ADD       AMTWRK00,AMTOUT90
          GOTO      COUTS100
.
COUTS999  RETURN
.--------------------------------------------------
. Clear Total
.--------------------------------------------------
CLRREF00   MOVE      ZERO,SCRTOTAL
           RETURN
.--------------------------------------------------
. Get Transaction Details
.--------------------------------------------------
TRNDET00
          ASSIGN   APIMTOT-APIMDIS+APIMGST,DOCTOTAL
          MOVE     ZERO,OUTSTTOT
          MOVE     APIMTYP,F1
          BRANCH   F1,TRNDET10,TRNDET20,TRNDET30,TRNDET40
.
          MOVE     "Inv ",DOCTYPE
          ADD      DOCTOTAL,SCRTOTAL
          ASSIGN   APIMTOT-APIMDIS+APIMGST-APIMPAY,OUTSTTOT
          GOTO     TRNDET99
.
TRNDET10  MOVE     "Crd ",DOCTYPE
          MULT     SEQ,DOCTOTAL
          ADD      DOCTOTAL,SCRTOTAL
          ASSIGN   APIMTOT-APIMDIS+APIMGST-APIMPAY,OUTSTTOT
          MULT     SEQ,OUTSTTOT
          GOTO     TRNDET99
.
TRNDET20  MOVE     "Pay ",DOCTYPE
          MOVE     APIMPAY,DOCTOTAL
          MULT     SEQ,DOCTOTAL
          ADD      DOCTOTAL,SCRTOTAL
          GOTO     TRNDET99
.
TRNDET30  MOVE     "Can ",DOCTYPE
          MOVE     APIMPAY,DOCTOTAL
          GOTO     TRNDET99
.
TRNDET40  MOVE     "Rein",DOCTYPE
          ADD      DOCTOTAL,SCRTOTAL
          GOTO     TRNDET99
.
TRNDET99
          RETURN
.--------------------------------------------------
. Display Order Details
.--------------------------------------------------
ORDDET00  MOVE       "No Inventory System Allocated           ",APISDES
          PACK       KEY1,APCIISC
          CALL       RDAPIS1
          PACK       KEY8,APCIISC,APCIORD
          PACK       KEY14,APCIISC,APCIORD,SP70
          MOVE       ZERO,ORDTOTAL
          MOVE       SP70,ORDSTAT
          CALL       RSAPOD1
.
ORDDET10  CALL       RKAPOD1
          BRANCH     OVRCD,ORDDET90
          PACK       KEY14,APODISC,APODORD,APODCAT
          MATCH      KEY8,KEY14
          GOTO       ORDDET90 IF NOT EQUAL
          IF         -1=APODUCT
            MOVE       "T.B.A.",ORDSTAT
            MOVE       ZERO,APODAMT
          ELSE
            MOVE       "      ",ORDSTAT
            ADD        APODAMT,ORDTOTAL
          ENDIF
          GOTO       ORDDET10
.
ORDDET90  ADD        ORDTOTAL,SCRTOTAL
          RETURN
.
.----------------------------------------------------------------------
. set up screen 05
.----------------------------------------------------------------------
SETSCR05  MOVE      ZERO,EXIT
          IF        HACCNT<>1
            BEEP
            CLEAR     DISPMSG
            APPEND    "GL Interface Not Active - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
            RETURN
          ENDIF
.
          CALL      CLRREF00
.
          CALL      YORN0000
          MOVE      FYESNO TO CHEQUEYN
.
          RETURN
.--------------------------------------------------
. Enter Document for Search
.--------------------------------------------------
EDOCR000
.         IF        HACCNT<>1
.           BEEP
.           CLEAR     DISPMSG
.           APPEND    "GL Interface Not Active - ",DISPMSG
.           RESET     DISPMSG
.           CALL      MESSAGE1
.           GOTO      EDOCR900
.         ENDIF
.
           MOVE      SP70,DOCREFER
           MOVE      ZERO,SCRTOTAL
           MOVE      SP70,KEY8
           BRANCH    CHEQUEYN,EDOCR500
           KEYIN     *PCCOL:CVERT,*V2LON,DOCREFER
           ENDSET    DOCREFER
           APPEND    SP70,DOCREFER
           RESET     DOCREFER
           MATCH     SP70,DOCREFER
           GOTO      EDOCR900 IF EQUAL
           MATCH     EXITCHAR,DOCREFER
           GOTO      EDOCR900 IF EQUAL
           MOVE      ZERO,EXIT
           GOTO      EDOCR950
.
EDOCR500   KEYIN     *PCCOL:CVERT,*V2LON,*JR,KEY8
           ENDSET    KEY8
           APPEND    SP70,KEY8
           RESET     KEY8
.
           MATCH     SP70,KEY8
           GOTO      EDOCR900 IF EQUAL
.
           ENDSET    KEY8
           CMATCH    EXITCHAR,KEY8
           GOTO      EDOCR900 IF EQUAL
           RESET     KEY8
           PACK      DOCREFER,SP7,KEY8
           MOVE      ZERO,EXIT
           GOTO      EDOCR950
.
EDOCR900   MOVE      TWO,EXIT
           GOTO      EDOCR999
EDOCR950
          PACK      KEY20,APMACRD,DOCREFER,SP70
          PACK      KEY40,APMACRD,DOCREFER,SP70
          CALL      RSAPIM4
EDOCR960  CALL      RKAPIM4
          BRANCH    OVRCD,EDOCR970
          PACK      KEY40,APIMCRD,APIMDOC,SP70
          MATCH     KEY20,KEY40
          GOTO      EDOCR999 IF EQUAL
EDOCR970  BEEP
          MOVE      "Document/Cheque Entered Not Found - ",DISPMSG
          CALL      MESSAGE1
          GOTO      EDOCR000
.
EDOCR999  RETURN
.
.----------------------------------------------------------------------
. set up screen 06
.----------------------------------------------------------------------
SETSCR06  MOVE      ZERO,EXIT
          IF        HACCNT<>1
            BEEP
            CLEAR     DISPMSG
            APPEND    "GL Interface Not Active - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            MOVE      ONE,EXIT
          ENDIF
.
          CALL      CLRREF00
.
          RETURN
.------------------------------------------------------------
. Enter Invoice Reference
.------------------------------------------------------------
EIREF000
          IF        HACCNT<>1
            BEEP
            CLEAR     DISPMSG
            APPEND    "GL Interface Not Active - ",DISPMSG
            RESET     DISPMSG
            CALL      MESSAGE1
            GOTO      EIREF900
          ENDIF
.
          MOVE      SP70,INVREFER
          MOVE      ZERO,SCRTOTAL
          KEYIN     *PCCOL:CVERT,*V2LON,*RV,INVREFER
          ENDSET    INVREFER
          APPEND    SP70,INVREFER
          RESET     INVREFER
          MATCH     SP70,INVREFER
          GOTO      EIREF900 IF EQUAL
          MATCH     EXITCHAR,INVREFER
          GOTO      EIREF900 IF EQUAL
          PACK      KEY20,APMACRD,INVREFER,SP70
          PACK      KEY40,APMACRD,INVREFER,SP70
          CALL      RSAPIM3
.
EIREF100  CALL      RKAPIM3
          BRANCH    OVRCD,EIREF200
          PACK      KEY40,APIMCRD,APIMREF,SP70
          MATCH     KEY20,KEY40
          GOTO      EIREF999 IF EQUAL
.
EIREF200  BEEP
          MOVE      "Invoice Reference Entered Not Found - ",DISPMSG
          CALL      MESSAGE1
          GOTO      EIREF000
.
EIREF900  MOVE      TWO,EXIT
.
EIREF999  RETURN
CATDET00  MOVE      SIICCAT,KEY7
          CALL      RDSIIA1
          RETURN
CATSCR00
          MOVE      SIIC3MKY,KEY27
          CALL      RDSIIC3
          IF        OVRCD=1
            BEEP
            MOVE      "Catalog Not Available - ",DISPMSG
            CALL      MESSAGE1
            GOTO      CATSCR99
          ENDIF
.
          MOVE      SIICCAT,KEY7
          CALL      RDSIIA1
          PACK      KEY30,SIIAISS,SIICSUT
          CALL      RDSIFA1
          ASSIGN    SIICCCT/SIFACTOR,ISSCCOST
          ASSIGN    SIICLCT/SIFACTOR,ISSLCOST
.
          CALL      SC20L000
.
CATSCR99  RETURN
ORDLIN00
          MOVE      "**  UNKNOWN  **    ",TRANSSTA
          UNPACK    SP70,SITRPURC,SITRSTAT,SITRUSER,SITRCREA:
                         SITRORG,SITREDAT,SITRTDAT
          MOVE      "000",SITRTNUM
          PACK      KEY7,SIPAPON,SP70
          CALL      RDSITR1
          IF        OVRCD=1
            MOVE      "No Transmission    ",TRANSSTA
          ELSE
            MATCH     "0",SITRSTAT
            IF        @EQUAL
              MOVE      "Await. Transmit    ",TRANSSTA
            ENDIF
            MATCH     "1",SITRSTAT
            IF        @EQUAL
              MOVE      "In Progress        ",TRANSSTA
            ENDIF
            MATCH     "2",SITRSTAT
            IF        @EQUAL
              MOVE      "Transmitted        ",TRANSSTA
            ENDIF
            MATCH     "9",SITRSTAT
            IF        @EQUAL
              MOVE      "Cancelled          ",TRANSSTA
            ENDIF
          ENDIF
.
          MOVE      SP70,SIORNAME
          PACK      KEY3,SIPAORI,SP70
          CALL      RDSIOR1
.
          PACK     KEY10,SIPAPON,SP70
          MOVE     ZERO,F12P2
          CALL     RSSIPC1
.
ORDLIN10  CALL     RKSIPC1
          BRANCH   OVRCD,ORDLIN20
          MATCH    SIPCPON,SIPAPON
          GOTO     ORDLIN20 IF NOT EQUAL
          IF       SIPCECT<0
            GOTO     ORDLIN80
          ENDIF
          MATCH    SP70,SIPCEDD
          IF       @EQUAL
            ASSIGN   F12P2+SIPCTCR,F12P2
          ELSE
            ASSIGN   F12P2+(SIPCECT*SIPCOQT),F12P2
          ENDIF
          GOTO     ORDLIN10
.
ORDLIN20  MOVE     "9,999,999.99",ORDDTOT
          FEDIT    F12P2,ORDDTOT
          MATCH    "*",ORDDTOT
          IF       @EQUAL
            MOVE     F12P2,F9P2
            MOVE     F9P2,ORDDTOT
          ENDIF
          GOTO     ORDLIN99
.
ORDLIN80  MOVE     "      T.B.A.",ORDDTOT
.
ORDLIN99  RETURN
.----------------------------------------------------------------------
. Selected Order Display
.----------------------------------------------------------------------
SELORD00  UNPACK   SIPA2MKY,SIPASUP,SIPADIN,SIPAPON
          PACK     KEY7,SIPAPON
          CALL     RDSIPA1
          IF       OVRCD=1
            BEEP
            MOVE     "Order Not Found - ",DISPMSG
            CALL     MESSAGE1
            GOTO     SELORD99
          ENDIF
.
          CALL     SC14L000
.
SELORD99  RETURN
.
CHKPRICE  IF        (SIPCECT<0)
            MOVE      "        T.B.A.",UNITCOST
          ELSE
            MOVE      "9,999,999.9999",UNITCOST
            FEDIT     SIPCECT,UNITCOST
            MATCH     "*",UNITCOST
            IF        @EQUAL
              MOVE      SIPCECT,F9P4
              MOVE      F9P4,UNITCOST
            ENDIF
          ENDIF
          RETURN
.
.--------------------------------------------------
. Total Cost of Order
.--------------------------------------------------
TOTORD00  MOVE     ZERO,TOTALORD
          PACK     KEY11,SIPCPON,SIPCITM,SP70
          PACK     KEY10,SIPAPON,SP70
          CALL     RSSIPC1
TOTORD10  CALL     RKSIPC1
          BRANCH   OVRCD,TOTORD90
          MATCH    SIPCPON,SIPAPON
          GOTO     TOTORD90 IF NOT EQUAL
          IF       SIPCECT>0
            ASSIGN   TOTALORD+(SIPCECT*SIPCOQT),TOTALORD
          ENDIF
          GOTO     TOTORD10
.
TOTORD90
          PACK     KEY10,KEY11,SP70
          CALL     RDSIPC1
.
          RETURN
.-----------------------------------------------------------------------
. Get Originator Info
.-----------------------------------------------------------------------
GORIG000  PACK      KEY3,SIPAORI
          CALL      RDSIOR1
          IF        OVRCD<>0
            MOVE      SP70,SIORNAME
          ENDIF
.
GORIG999  RETURN
SELITM00  MOVE      SIPC1MKY,KEY20
          CALL      RDSIPC1
          IF        OVRCD=1
            MOVE      "Invalid Selection - ",DISPMSG
            BEEP
            CALL      MESSAGE1
          ELSE
            CALL      REDITM00
            CALL      SC15L000
          ENDIF
.
SELITM99  RETURN
.
REDITM00  MATCH     SP70,SIPCCAT
          IF        @EQUAL
            MOVE      "N/A",SIPCCAT
            MOVE      SP70,SIIADES
            MOVE      SIPCSUT,SIIAISS
            MOVE      ZERO,SIIAAVC
            MOVE      ONE,SIIANON
          ELSE
            MOVE      SIPCCAT,KEY7
            CALL      RDSIIA1
            MOVE      SIIASUB,SIPCPRD
          ENDIF
.
          MOVE      SP70,SICADESC
          MOVE      SIPCCST,KEY5
          CALL      RDSICA1
.
          MATCH     SP70,SIPCWAR
          IF        @EQUAL
            MOVE      "N/A",SIPCWAR
            MOVE      SP70,SIWADES
          ELSE
            MOVE      SIPCWAR,KEY5
            CALL      RDSIWA1
          ENDIF
.
          MOVE      SIPCPRD,KEY5
          CALL      RDSISA1
.
REDITM99  RETURN
.
.----------------------------------------------------------------------
. Set up screen 16
.----------------------------------------------------------------------
SETSCR16
          MOVE      SP70,SIORNAME
          PACK      KEY3,SITRORG,SP70
          CALL      RDSIOR1
.
          MOVE      SP70,SECUSER
          PACK      KEY3,SITRUSER,SP70
          CALL      RDPASS1
.
          MOVE      "**  TRANSMISSION STATUS UNKNOWN  **   ",TRANSST2
          PACK      KEY7,SIPAPON,SP70
          CALL      RDSITR1
          IF        OVRCD=1
            MOVE      "Not to be Transmitted                   ",TRANSST2
          ELSE
            MATCH     "0",SITRSTAT
            IF        @EQUAL
              MOVE      "Awaiting Transmission                 ",TRANSST2
            ENDIF
            MATCH     "1",SITRSTAT
            IF        @EQUAL
              MOVE      "Transmission In Progress              ",TRANSST2
            ENDIF
            MATCH     "1",SITRSTAT
            IF        @EQUAL
              MOVE      "Transmission Completed                ",TRANSST2
            ENDIF
            MATCH     "1",SITRSTAT
            IF        @EQUAL
              MOVE      "Transmission Cancelled                ",TRANSST2
            ENDIF
          ENDIF
.
          RETURN
.----------------------------------------------
. Check for Notes
.----------------------------------------------
NSIID000  MOVE        SP70,NOTESIID
          MOVE        ZERO,OVRCD
          TRAP        OVERCOND IF IO
          OPEN        TEMPWORD,FILSIID1
          TRAPCLR     IO
          BRANCH      OVRCD,NSIID999
NSIID100  READ        TEMPWORD,SEQ;SIIDCOM
          GOTO        NSIID900 IF OVER
          MATCH       SP70,SIIDCOM
          GOTO        NSIID100 IF EQUAL
          MOVE        "Notes",NOTESIID
.
NSIID900  CLOSE       TEMPWORD
NSIID999  RETURN
.-------------------------------
. Includes for I/O and Keyins
.-------------------------------
          INC       APSCIOIO/INC
          INC       APSCKIKY    
          INC       APSCNTIO/INC
          INC       APSCTSIO/INC
          INC       APSIMSIO/INC
          INC       APSISLIO/INC
          INC       APSMASIO/INC
          INC       APSMASKY    
          INC       APSMXRIO/INC
          INC       APSORDIO/INC
          INC       APSPPDIO/INC
          INC       APSSNTIO/INC
          INC       APSSUBIO/INC
          INC       FMSCODIO/INC
          INC       GPHSTDCD    
          INC       IBAPASIO/INC
          INC       SINCCAIO/INC
          INC       SINCIAIO/INC
          INC       SINCICIO/INC
          INC       SINCIDIO/INC
          INC       SINCODIO/INC
          INC       SINFACIO/INC
          INC       SINNATIO/INC
          INC       SINORIIO/INC
          INC       SINPERCD    
          INC       SINPERIO/INC
          INC       SINPOAIO/INC
          INC       SINPOCIO/INC
          INC       SINPODIO/INC
          INC       SINSUAIO/INC
          INC       SINTRNIO/INC
          INC       SINWARIO/INC
.
          INC       STDGENCD
.
