.******************************************************************************
.* System         : Operating Rooms         Release 5.01                      *
.* Program        : IBAOPR75                                                  *
.* Name           : Clinic Type/Doctor Type Summary                           *
.******************************************************************************
.* Programmer     : Justin Coates      (Adapted from IBAOPR65)                *
.* Date           : 30/12/1991                                                *
.* Function       : Display the data from the OPRCTSFD file.                  *
.* Modifications  :                                                           *
.*       V10.04.01 23/06/2014   J.Tan        CAR 261630                       *
.*                 Removed port number from temp file name                    *
.*        V5.07.B01 18/01/1999  Nicole Harrington 507 rebound 089             *
.*                  Mods to include century on to and from dates              *
.******************************************************************************
.*        V5.01.002 20/07/92  ROD                                             *
.*                  Fixed Breakup E (was using B)                             *
.*        V5.01.03  07/11/1992    Lofty                                       *
.*                  made TEMP and temp file variables FORM 8                  *
.******************************************************************************
.
.$$$$$
.$$$$$
.
          INC       STD001FD
          INC       IBASEQFD/INC            * Sequential Numbers File
          INC       TFILEVAR/INC            * Generate Temp File Name
          INC       WEBERRFD/INC            * Web Server Error Logging
.
          INC       OPRCONFD/INC
          INC       OPRCLIFD/INC            * clinic file
          INC       OPRCTSFD/INC            * clinic type summary file
          INC       PATCODFD/INC            * codes file
          INC       PATDO1FD/INC            * doctor file
.
.         program variables
.
CMDLINE   DIM       70
CODE      DIM       2
COL       FORM      3         * column for clin/doct type keyin
DATEFR    DIM       8
DATETO    DIM       8
FORM6     FORM      6
FRTIME    DIM       5
LABEL     DIM       20
ENCODE    DIM       3
ENDESC    DIM       20
CFNAMEA   DIM       8         * temp file name A
CFNAMEB   DIM       8         * temp file name B
PRDTFR    DIM       10
PRDTTO    DIM       10
SCRNFLAG  FORM      1
SPSP      DIM       3
TEMP      FORM      8
TOTAL     FORM      8
TOTCAS    FORM      8
TOTIME    DIM       5
USERCAT   DIM       2
USERNO    DIM       17
USERYES   DIM       17
.
KEYA      INIT      " 41 U1-1,2-2,3-5"
TEMPA     IFILE     SQL, FIXED=41, KEY="U1-1,2-2,3-5"
.Name     Type      Length    Phys.  Start  Description
.-------  -----     ------    -----  -----  ------------------------------------
TEMPSUM   DIM       1           1        1  Breakdown code        (opotperd)
TEMPTYP   DIM       1           1        2  Cases/Minutes
TEMPUSER  DIM       3           3        3  User defined field    (opotuser)
TEMPMOCT  FORM      8           5        6  Total for Monday
TEMPTUCT  FORM      8           5       11  Total for Tuesday
TEMPWECT  FORM      8           5       16  Total for Wednesday
TEMPTHCT  FORM      8           5       21  Total for Thursday
TEMPFRCT  FORM      8           5       26  Total for Friday
TEMPSACT  FORM      8           5       31  Total for Saturday
TEMPSUCT  FORM      8           5       36  Total for Sunday
.                                       41  End of Record
.
KEYB      INIT      " 7 U1-6"
TEMPB     IFILE     SQL, FIXED=7, KEY="U1-6"
.Name     Type      Length    Phys.  Start  Description
.-------  -----     ------    -----  -----  ------------------------------------
XCODE     DIM       6           6        1  Doctor code
.                                        7  End of Record
.
.         program constants
.
CAS       INIT      " Number of Cases"
CATDT     INIT      "DT"
CATYG     INIT      "YG"
CATY6     INIT      "Y6"
CATY7     INIT      "Y7"
CATY8     INIT      "Y8"
CATY9     INIT      "Y9"
CATZ1     INIT      "Z1"
CATZ2     INIT      "Z2"
CATZ3     INIT      "Z3"
CATZ4     INIT      "Z4"
CATZ5     INIT      "Z5"
CATZ6     INIT      "Z6"
CATZ7     INIT      "Z7"
CATZ8     INIT      "Z8"
ISBUILD   INIT      "isbuild "
ISERASE   INIT      "iserase "
MIN       INIT      " Minutes Used"
OPCNBRKM  INIT      "23:59"
OY        INIT      "OY"
SP50      INIT      "                                        "
ST        INIT      "ST"
ZED       INIT      "z"
.
PRGID     INIT      "IBAOPR75"
PRGNAM1   INIT      " Type Summary"
PRGNAM    DIM       40
VERSION   INIT      "V12.01.00"
.
.*********************************************************************
.*                  MAIN LINE                                        *
.*********************************************************************
ML0000    CALL      INIT0000            
.
ML1000    CALL      SCRN0000                * Display main screen
          CALL      SLCT0000                * Get selection
          BRANCH    EXIT,ML9999             * exit?
.
ML2000    CALL      TYPE0000                * get clinic/operation type
          BRANCH    EXIT,ML1000             * exitchar entered
.
ML3000    CALL      DTRN0000                * get date range
          BRANCH    EXIT,ML2000             * no date entered
.
          CALL      CONTQST                 * Ok. to continue ?
          BRANCH    CEXIT,ML4000:           * 'Y'es
                          ML5000:           * 'N'o
                          ML1000            * 'C'ancel
.
ML4000    CALL      PROC0000                * process and write to tempfile
          CALL      TEMP0000                * output tempfile
          GOTO      ML1000
.
ML5000    CALL      CLR0000                 * clear working variables 
          CALL      DISP0000                * re-display screen
          GOTO      ML2000
.
ML9999    CALL      KILL0000
          CHAIN     PGM
.
.************************************************************************
.*                              INIT0000                                *
.*            Display head, open file and read control file             *
.************************************************************************
INIT0000  DISPLAY   *P50:24,"controlf"
          OPEN      CONTROLF,"controlf"          
.
          READ      CONTROLF,FORTY;*96,OPCNCDSC,*111,OPCNCLSU
.
.         make the program name
.
          MOVE      OPCNCDSC,PRGNAM
          REP       UPPLOW,PRGNAM
          ENDSET    PRGNAM
.
INIT0100  MATCH     SP1,PRGNAM
          GOTO      INIT0200 IF NOT EQUAL   * no more spaces
.
          BUMP      PRGNAM,-1
          GOTO      INIT0100 IF NOT EOS     * more blanks to remove
.
INIT0200  APPEND    PRGNAM1,PRGNAM
          RESET     PRGNAM
.
          CALL      DISPHEAD
          MOVE      ONE,CNOUNDLN
          MOVE      ONE,CNEWDS
.
          DISPLAY   *P50:24,"oprctsaf"
          OPEN      OPRCTSA1,"oprctsaf"
.
          DISPLAY   *P50:24,"oprcliaf"
          OPEN      OPRCLIA1,"oprcliaf"
.
          DISPLAY   *P50:24,"patcodes"
          OPEN      PATCODE1,"patcodes"
.
          DISPLAY   *P50:24,"patdo1af"
          OPEN      PATDO1A1,"patdo1af"
.
          READ      CONTROLF,FORTY;*143,OPCNBRKA:          * summary breakdowns
                                   *148,OPCNBRKB:
                                   *153,OPCNBRKC:
                                   *158,OPCNBRKD:
                                   *163,OPCNBRKE:
                                   *168,OPCNBRKF:
                                   *173,OPCNBRKG:
                                   *178,OPCNBRKH:
                                   *183,OPCNBRKI:
                                   *188,OPCNBRKJ:
                                   *193,OPCNBRKK:
                                   *198,OPCNBRKL
          READ      CONTROLF,FORTY2;*109,OPCNCTSU,*114,OPCNR75A,OPCNMM75
.
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,CFNAMEA
.
          CALL      TFILENAM                * Get temp file name
          MOVE      TFILNAME,CFNAMEB
.
.         remove trailing blanks from OPCNCDSC
.
          ENDSET    OPCNCDSC
.
INIT1000  MATCH     SP1,OPCNCDSC
          GOTO      INIT2000 IF NOT EQUAL   * no more spaces
.
          BUMP      OPCNCDSC,-1
          GOTO      INIT1000 IF NOT EOS     * More blanks to remove
.
INIT2000  LENSET    OPCNCDSC
          MOVELPTR  OPCNCDSC,COL            * length pointer value
          ADD       "9",COL                 * actual column
          RESET     OPCNCDSC
.
.         for report layout 2, set up major/minor cases description
.
          BRANCH    OPCNR75A,INIT9999
.
          MOVE      SP2,USERCAT
          LOAD      USERCAT,OPCNCTSU,CATZ1,CATZ2,CATZ3,CATZ4,CATZ5:
                                     CATZ6,CATZ7,CATZ8,CATY6,CATY7:
                                     CATY8,CATY9
.
          BRANCH    OPCNMM75,INIT3000
.
          MOVE      "Y  ",ACODE
          PACK      KEY5,USERCAT,ACODE
          CALL      RDCODE1
          MOVE      TDESC,USERYES
          MOVE      "N  ",ACODE
          PACK      KEY5,USERCAT,ACODE
          CALL      RDCODE1
          MOVE      TDESC,USERNO 
          GOTO      INIT9999
.
INIT3000  MOVE      "No of Major Cases",USERYES
          MOVE      "No of Minor Cases",USERNO 
.
INIT9999  RETURN
.
.*********************************************************************
.*                  SCRN0000                                         *
.*        Display main options screen                                *
.*********************************************************************
SCRN0000  DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON,ZERO,*HOFF," = Exit":
                    *P1:5,*V2LON,ONE,*HOFF," = By ",*+,OPCNCDSC," Type"
.
SCRN9999  RETURN
.
.*********************************************************************
.*                  SLCT0000                                         *
.*        Get main selection                                         *
.*********************************************************************
SLCT0000  KEYIN     *P1:7,*EL,"Select Option : _":
                    *P17:7,*V2LON,OPTION
.
          COMPARE   ZERO,OPTION
          GOTO      SLCT9000 IF EQUAL
.
          DISPLAY   *P17:7,*EL,*V2LON,OPTION
.
          BRANCH    OPTION,SLCT8000
          BEEP
          GOTO      SLCT0000
.
SLCT8000  MOVE      ZERO,EXIT               * don't exit
          GOTO      SLCT9999
.
SLCT9000  MOVE      ONE,EXIT                * chose exit
.
SLCT9999  RETURN
+
.*********************************************************************
.*                  CLR0000                  Called by : ML0000      *
.*        clear working variables                                    *
.*********************************************************************
CLR0000   MOVE      SP3,ENCODE   
          MOVE      SP20,ENDESC   
CLR9999   RETURN
.
.*********************************************************************
.*                  DISP0000                                         *
.*             Re-display screen                                     *
.*********************************************************************
DISP0000  DISPLAY   *P1:3,*EF:
                    *P1:4,*V2LON,ZERO,*HOFF," = Exit":
                    *P1:5,*V2LON,ONE,*HOFF," = By ",*+,OPCNCDSC," Type":
                    *P1:7,"Select Option : ",*V2LON,OPTION,*HOFF:
                    *P1:9,*+,OPCNCDSC," type : ",*V2LON,ENCODE:
                    *P30:9,*HOFF,ENDESC
.
DISP9999  RETURN
.
.*********************************************************************
.*                  DTRN0000                                         *
.*        Get date range to be printed                               *
.*********************************************************************
DTRN0000  DISPLAY   *P1:11,*EL,"From Date  :"
          DISPLAY   *P1:12,*EL,"To Date    :"
.
.**** set up keydate parametres
.
          MOVE      TEN4,CCOL
          MOVE      TEN1,CVERT
          UNPACK    SP20,CCENT,CDAY,CMON,CYEAR   * clear variables
          MOVE      ZERO,CHIGHLT                 * highlight on
          MOVE      CCC,CCENT                    * default century
.
          CALL      KEYDATE                      * get a date
          BRANCH    CQUEST,DTRN0000
          BRANCH    OVRCD,DTRN8000               * no input
.
          PACK      DATEFR,CCENT,CYEAR,CMON,CDAY       * set up date from
          CALL      PACDATE
          MOVE      CPCDATE,PRDTFR           * print from date
.
.**** set keydate parametres
.
DTRN1500  MOVE      TEN4,CCOL
          MOVE      TEN2,CVERT
          MOVE      ZERO,CHIGHLT            * highlight on
          MOVE      CCC,CCENT               * default century
.
          CALL      KEYDATE
          BRANCH    CQUEST,DTRN1500
          BRANCH    OVRCD,DTRN0000
.
          PACK      DATETO,CCENT,CYEAR,CMON,CDAY       * set up date to
          CALL      PACDATE
          MOVE      CPCDATE,PRDTTO           * print date
.
DTRN2000  MATCH     DATEFR,DATETO           * valid range?
          GOTO      DTRN3000 IF LESS
.
          MOVE      ZERO,EXIT
          GOTO      DTRN9999
.
DTRN3000  DISPLAY   *P1:24,*EL,*B,"Invalid date range.  ";
          CALL      HITENTER
          GOTO      DTRN0000
.
DTRN8000  MOVE      ONE,EXIT                  * no date entered

DTRN9999  RETURN
.
.*********************************************************************
.*                  CREA0000                                         *
.*        Create the Indexed Temp File                               *
.*********************************************************************
CREA0000  CALL      KILL0000                       * kill existing temp file
.
.------ Build new indexed temp file ------
.
          CLEAR     CMDLINE
          PACK      CMDLINE,ISBUILD,CFNAMEA,KEYA,SP30
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
          OPEN      TEMPA,CFNAMEA
.
          CLEAR     CMDLINE
          PACK      CMDLINE,ISBUILD,CFNAMEB,KEYB,SP30
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
          OPEN      TEMPB,CFNAMEB
.
CREA9999  RETURN
+
.*********************************************************************
.*                  KILL0000                                         *
.*        Kill the Tempfile if it Already Exists                     *
.*********************************************************************
KILL0000  CLEAR     CMDLINE
          CLOSE     TEMPA
          PACK      CMDLINE,ISERASE,CFNAMEA
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
          CLEAR     CMDLINE
          CLOSE     TEMPB
          PACK      CMDLINE,ISERASE,CFNAMEB
          RESET     CMDLINE
          EXECUTE   CMDLINE,TASKID
.
KILL9999  RETURN
+
.*********************************************************************
.*                  PROC0000                    Called by : ML4000   *
.*        Process data to the temp file.                             *
.*********************************************************************
PROC0000  CALL      CREA0000                * create tempfile
          CALL      GVCL0000                * get all valid clin/doct codes
          DISPLAY   *P50:24,*V2LON,"Processing";
.
.         loop over all valid doctor codes
. 
          MOVE      SP6,KEY6
          READ      TEMPB,KEY6;;
.
PROC1000  READKS    TEMPB;XCODE
          GOTO      PROC9999 IF OVER        * no more doctors
.
.         loop over OPRCTSFD for date and clin/doct
.
          PACK      KEY18,DATEFR,XCODE,SP10
          CALL      RSOPCTS1
.
PROC2000  CALL      RKOPCTS1                * read next record
          BRANCH    OVRCD,PROC1000
.
          MATCH     OPCTDATE,DATETO
          GOTO      PROC1000 IF LESS        * after end date
.
          MATCH     XCODE,OPCTCLIN
          GOTO      PROC2000 IF NOT EQUAL   * different clin/doct
.
.         set the key to temp file A
.
PROC3000  COMPARE   TWO,OPCNR75A
          GOTO      PROC4000 IF EQUAL       * want the actual code
          MOVE      "zzz",OPCTUSER          * set the code
.
.         add the number of cases for OPCTUSER
.
PROC4000  MOVE      OPCTPERD,TEMPSUM        * set up sum. breakdown
          MOVE      "C",TEMPTYP             * C = cases
          MOVE      OPCTUSER,TEMPUSER       * user defined code
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          MOVE      OPCTNCAS,FORM6          * set amount to add
          CALL      MTMP0000                * update temp file
.
.         GRAND TOTAL cases for OPCTUSER
.
          MOVE      ZED,TEMPSUM             * z = total 
          MOVE      "C",TEMPTYP             * C = cases
          MOVE      OPCTUSER,TEMPUSER       * user defined code
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          MOVE      OPCTNCAS,FORM6          * set amount to add
          CALL      MTMP0000                * update temp file
.
.         add minutes record for OPCTUSER
.
          MOVE      OPCTPERD,TEMPSUM        * breakdown period
          MOVE      "M",TEMPTYP             * M = minutes
          MOVE      "zzz",TEMPUSER          * set user to zzz
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          MOVE      OPCTTIME,FORM6          * set time to add
          CALL      MTMP0000
          MOVE      OPCTUSER,TEMPUSER       * restore user
.
.         GRAND TOTAL minutes for OPCTUSER
.
          MOVE      ZED,TEMPSUM             * z = total
          MOVE      "M",TEMPTYP             * M = minutes
          MOVE      "zzz",TEMPUSER          * set user to zzz
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          MOVE      OPCTTIME,FORM6          * set time to add
          CALL      MTMP0000
          MOVE      OPCTUSER,TEMPUSER       * restore user
.
.         the next two are only done for report type 2
.
          BRANCH    OPCNR75A,PROC2000       * in report layout 1
          MATCH     "zzz",TEMPUSER
          GOTO      PROC2000 IF EQUAL       * in report layout 1
.
.         TOTAL CASES for breakdown
.
          MOVE      OPCTPERD,TEMPSUM        * breakdown period
          MOVE      ANSC,TEMPTYP            * C = case record
          MOVE      "zzz",TEMPUSER          * total cases for temp user
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          MOVE      OPCTNCAS,FORM6          * set amount to add
          CALL      MTMP0000
.
.         GRAND TOTAL cases 
.
          MOVE      ZED,TEMPSUM             * z = total
          MOVE      ANSC,TEMPTYP            * C = case record
          MOVE      "zzz",TEMPUSER          * total cases for temp user
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          MOVE      OPCTNCAS,FORM6          * set amount to add
          CALL      MTMP0000
          GOTO      PROC2000
.
PROC9999  RETURN
.
.*********************************************************************
.*                  TEMP0000                    Called by : ML3000   *
.*        Print the contents of the tempfile                         *
.*********************************************************************
TEMP0000  CLOCK     TIME,CTIMEIS
          MOVE      ZERO,CPAGENO
          CALL      HEAD0000
.
          DISPLAY   *P50:24,*V2LON,*EL,"Printing"
          CALL      DOA0000                 * print summary breakdown A
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOB0000                 * print summary breakdown B
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOC0000                 * print summary breakdown C
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOD0000                 * print summary breakdown D
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOE0000                 * print summary breakdown E
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOF0000                 * print summary breakdown F
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOG0000                 * print summary breakdown G
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOH0000                 * print summary breakdown H
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOI0000                 * print summary breakdown I
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOJ0000                 * print summary breakdown J
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOK0000                 * print summary breakdown K
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOL0000                 * print summary breakdown L
          BRANCH    EXIT,TEMP1000           * last summary breakdown?
.
          CALL      DOM0000                 * print summary breakdown M
.        
TEMP1000  CALL      TOT0000                 * print totals
          DISPLAY   *P50:24,*EL
.
TEMP9999  RETURN        
.
.*************************************************************************
.*                           DOA0000                                     *
.*          Print the records in summary breakdown A                     *
.*************************************************************************
DOA0000   MOVE      "00:00",FRTIME          * set up from time
          MATCH     "00:00",OPCNBRKA        * set up to time
          GOTO      DOA0500 IF EQUAL
          MOVE      OPCNBRKA,TOTIME
          GOTO      DOA0700
.
DOA0500   MOVE      OPCNBRKM,TOTIME    
.
DOA0700   COMPARE   TWO,OPCNR75A
          GOTO      DOA6500 IF EQUAL        * report type 2
.
.         Report layout 1
.         print the cases
.
          MOVE      "A",TEMPSUM             * set up summary breakdown
          MOVE      "C",TEMPTYP             * C = cases
          MOVE      " - ",SPSP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1                
.
          MOVE      CAS,LABEL               * set up label 
          CALL      PRNT0000                * print a line of output
.
.         print the minutes
.
          MOVE      "A",TEMPSUM
          MOVE      "M",TEMPTYP
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME             * clear times to print
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set up label
          CALL      PRNT0000
          GOTO      DOA7000
.
.         Report Layout 2
.
DOA6500   MOVE      "A",DIM1                * breakdown A
          PRINT     FRTIME," - ",TOTIME;
          CALL      PRNT0000
.
.         see if any more breakdowns to go
.
DOA7000   MATCH     OPCNBRKA,OPCNBRKM
          GOTO      DOA9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKA        * last breakdown ?
          GOTO      DOA9000 IF EQUAL
.
          PRINT     *N;
          MOVE      FALSE,EXIT
          GOTO      DOA9999
.
DOA9000   MOVE      TRUE,EXIT
.         
DOA9999   RETURN
+
.*************************************************************************
.*                           DOB0000                                     *
.*          Print the records in summary breakdown B                     *
.*************************************************************************
DOB0000   MOVE      OPCNBRKA,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKB        * set up to time
          GOTO      DOB0500 IF EQUAL
          MOVE      OPCNBRKB,TOTIME
          GOTO      DOB0700
.
DOB0500   MOVE      OPCNBRKM,TOTIME    
.
DOB0700   COMPARE   TWO,OPCNR75A
          GOTO      DOB6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "B",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "B",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOB7000
.
.         Report Layout 2
.
DOB6500   MOVE      "B",DIM1                * breakdown B
          PRINT     FRTIME," - ",TOTIME;
          CALL      PRNT0000
.
DOB7000   MATCH     OPCNBRKB,OPCNBRKM
          GOTO      DOB9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKB
          GOTO      DOB9000 IF EQUAL
.
          PRINT     *N;
          MOVE      FALSE,EXIT
          GOTO      DOB9999
.
DOB9000   MOVE      TRUE,EXIT
.         
DOB9999   RETURN
+
.*************************************************************************
.*                           DOC0000                                     *
.*          Print the records in summary breakdown C                     *
.*************************************************************************
DOC0000   MOVE      OPCNBRKB,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKC        * set up to time
          GOTO      DOC0500 IF EQUAL
          MOVE      OPCNBRKC,TOTIME
          GOTO      DOC0700
.
DOC0500   MOVE      OPCNBRKM,TOTIME    
.
DOC0700   COMPARE   TWO,OPCNR75A
          GOTO      DOC6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "C",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "C",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOB7000
.
.         Report Layout 2
.
DOC6500   MOVE      "C",DIM1                * breakdown C
          PRINT     FRTIME," - ",TOTIME;
          CALL      PRNT0000
.
DOC7000   MATCH     OPCNBRKC,OPCNBRKM
          GOTO      DOC9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKC
          GOTO      DOC9000 IF EQUAL
.
          PRINT     *N;
          MOVE      FALSE,EXIT
          GOTO      DOC9999
.
DOC9000   MOVE      TRUE,EXIT
.         
DOC9999   RETURN
+
.*************************************************************************
.*                           DOD0000                                     *
.*          Print the records in summary breakdown D                     *
.*************************************************************************
DOD0000   MOVE      OPCNBRKC,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKD        * set up to time
          GOTO      DOD0500 IF EQUAL
          MOVE      OPCNBRKD,TOTIME
          GOTO      DOD0700
.
DOD0500   MOVE      OPCNBRKM,TOTIME    
.
DOD0700   COMPARE   TWO,OPCNR75A
          GOTO      DOD6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "D",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "D",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      MIN,LABEL               * set print type
          MOVE      SP3,SPSP
          CALL      PRNT0000
          GOTO      DOD7000
.
.         Report Layout 2
.
DOD6500   MOVE      "D",DIM1                * breakdown D
          PRINT     FRTIME," - ",TOTIME;
          CALL      PRNT0000
.
DOD7000   MATCH     OPCNBRKD,OPCNBRKM
          GOTO      DOD9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKD
          GOTO      DOD9000 IF EQUAL
.
          PRINT     *N;
          MOVE      FALSE,EXIT
          GOTO      DOD9999
.
DOD9000   MOVE      TRUE,EXIT
.         
DOD9999   RETURN
.
.*************************************************************************
.*                           DOE0000                                     *
.*          Print the records in summary breakdown E                     *
.*************************************************************************
DOE0000   MOVE      OPCNBRKD,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKE        * set up to time
          GOTO      DOE0500 IF EQUAL
          MOVE      OPCNBRKE,TOTIME
          GOTO      DOE0700
.
DOE0500   MOVE      OPCNBRKM,TOTIME    
.
DOE0700   COMPARE   TWO,OPCNR75A
          GOTO      DOE6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "E",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "E",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          REP       "C1M2",TEMPTYP
          CALL      PRNT0000
          GOTO      DOE7000
.
.         Report Layout 2
.
DOE6500   MOVE      "E",DIM1                * breakdown E
          PRINT     FRTIME," - ",TOTIME;
          CALL      PRNT0000
.
DOE7000   MATCH     OPCNBRKE,OPCNBRKM
          GOTO      DOE9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKE
          GOTO      DOE9000 IF EQUAL
.
          PRINT     *N;
          MOVE      FALSE,EXIT
          GOTO      DOE9999
.
DOE9000   MOVE      TRUE,EXIT
.         
DOE9999   RETURN
+
.*************************************************************************
.*                           DOF0000                                     *
.*          Print the records in summary breakdown F                     *
.*************************************************************************
DOF0000   MOVE      OPCNBRKE,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKF        * set up to time
          GOTO      DOF0500 IF EQUAL
          MOVE      OPCNBRKF,TOTIME
          GOTO      DOF0700
.
DOF0500   MOVE      OPCNBRKM,TOTIME    
.
DOF0700   COMPARE   TWO,OPCNR75A
          GOTO      DOF6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "F",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "F",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOF7000
.
.         Report Layout 2
.
DOF6500   MOVE      "F",DIM1                * breakdown F
          PRINT     FRTIME," - ",TOTIME;
          CALL      PRNT0000
.
DOF7000   MATCH     OPCNBRKF,OPCNBRKM
          GOTO      DOF9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKF
          GOTO      DOF9000 IF EQUAL
.
          PRINT     *N;
          MOVE      FALSE,EXIT
          GOTO      DOF9999
.
DOF9000   MOVE      TRUE,EXIT
.         
DOF9999   RETURN
+
.*************************************************************************
.*                           DOG0000                                     *
.*          Print the records in summary breakdown G                     *
.*************************************************************************
DOG0000   MOVE      OPCNBRKF,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKG        * set up to time
          GOTO      DOG0500 IF EQUAL
          MOVE      OPCNBRKG,TOTIME
          GOTO      DOG0700
.
DOG0500   MOVE      OPCNBRKM,TOTIME    
.
DOG0700   COMPARE   TWO,OPCNR75A
          GOTO      DOG6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "G",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "G",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOG7000
.
.         Report Layout 2
.
DOG6500   MOVE      "G",DIM1                * breakdown G
          PRINT     FRTIME," - ",TOTIME;
          CALL      PRNT0000
.
DOG7000   MATCH     OPCNBRKG,OPCNBRKM
          GOTO      DOG9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKG
          GOTO      DOG9000 IF EQUAL
.
          PRINT     *N;
          MOVE      FALSE,EXIT
          GOTO      DOG9999
.
DOG9000   MOVE      TRUE,EXIT
.         
DOG9999   RETURN
+
.*************************************************************************
.*                           DOH0000                                     *
.*          Print the records in summary breakdown H                     *
.*************************************************************************
DOH0000   MOVE      OPCNBRKG,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKH        * set up to time
          GOTO      DOH0500 IF EQUAL
          MOVE      OPCNBRKH,TOTIME
          GOTO      DOH0700
.
DOH0500   MOVE      OPCNBRKM,TOTIME    
.
DOH0700   COMPARE   TWO,OPCNR75A
          GOTO      DOH6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "H",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "H",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOH7000
.
.         Report Layout 2
.
DOH6500   MOVE      "H",DIM1                * breakdown H
          PRINT     FRTIME," - ",TOTIME;
          CALL      PRNT0000
.
DOH7000   MATCH     OPCNBRKH,OPCNBRKM
          GOTO      DOH9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKH
          GOTO      DOH9000 IF EQUAL
.
          PRINT     *N;
          MOVE      FALSE,EXIT
          GOTO      DOH9999
.
DOH9000   MOVE      TRUE,EXIT
.         
DOH9999   RETURN
+
.*************************************************************************
.*                           DOI0000                                     *
.*          Print the records in summary breakdown I                     *
.*************************************************************************
DOI0000   MOVE      OPCNBRKH,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKI        * set up to time
          GOTO      DOI0500 IF EQUAL
          MOVE      OPCNBRKI,TOTIME
          GOTO      DOI0700
.
DOI0500   MOVE      OPCNBRKM,TOTIME    
.
DOI0700   COMPARE   TWO,OPCNR75A
          GOTO      DOI6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "I",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "I",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOI7000
.
.         Report Layout 2
.
DOI6500   MOVE      "I",DIM1                * breakdown I
          PRINT     FRTIME," - ",TOTIME;
          CALL      PRNT0000
.
DOI7000   MATCH     OPCNBRKI,OPCNBRKM
          GOTO      DOI9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKI
          GOTO      DOI9000 IF EQUAL
.
          PRINT     *N;
          MOVE      FALSE,EXIT
          GOTO      DOI9999
.
DOI9000   MOVE      TRUE,EXIT
.         
DOI9999   RETURN
+
.*************************************************************************
.*                           DOJ0000                                     *
.*          Print the records in summary breakdown J                     *
.*************************************************************************
DOJ0000   MOVE      OPCNBRKI,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKJ        * set up to time
          GOTO      DOJ0500 IF EQUAL
          MOVE      OPCNBRKJ,TOTIME
          GOTO      DOJ0700
.
DOJ0500   MOVE      OPCNBRKM,TOTIME    
.
DOJ0700   COMPARE   TWO,OPCNR75A
          GOTO      DOJ6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "J",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "J",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOJ7000
.
.         Report Layout 2
.
DOJ6500   MOVE      "J",DIM1                * breakdown J
          PRINT     FRTIME," - ",TOTIME;
          CALL      PRNT0000
.
DOJ7000   MATCH     OPCNBRKJ,OPCNBRKM
          GOTO      DOJ9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKJ
          GOTO      DOJ9000 IF EQUAL
.
          PRINT     *N;
          MOVE      FALSE,EXIT
          GOTO      DOJ9999
.
DOJ9000   MOVE      TRUE,EXIT
.         
DOJ9999   RETURN
+
.*************************************************************************
.*                           DOK0000                                     *
.*          Print the records in summary breakdown K                     *
.*************************************************************************
DOK0000   MOVE      OPCNBRKJ,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKK        * set up to time
          GOTO      DOK0500 IF EQUAL
          MOVE      OPCNBRKK,TOTIME
          GOTO      DOK0700
.
DOK0500   MOVE      OPCNBRKM,TOTIME    
.
DOK0700   COMPARE   TWO,OPCNR75A
          GOTO      DOK6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "K",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "K",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOK7000
.
.         Report Layout 2
.
DOK6500   MOVE      "K",DIM1                * breakdown K
          PRINT     FRTIME," - ",TOTIME;
          CALL      PRNT0000
.
DOK7000   MATCH     OPCNBRKK,OPCNBRKM
          GOTO      DOK9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKK
          GOTO      DOK9000 IF EQUAL
.
          PRINT     *N;
          MOVE      FALSE,EXIT
          GOTO      DOK9999
.
DOK9000   MOVE      TRUE,EXIT
.         
DOK9999   RETURN
+
.*************************************************************************
.*                           DOL0000                                     *
.*          Print the records in summary breakdown L                     *
.*************************************************************************
DOL0000   MOVE      OPCNBRKK,FRTIME         * set up from time
          MATCH     "00:00",OPCNBRKL        * set up to time
          GOTO      DOL0500 IF EQUAL
          MOVE      OPCNBRKL,TOTIME
          GOTO      DOL0700
.
DOL0500   MOVE      OPCNBRKM,TOTIME    
.
DOL0700   COMPARE   TWO,OPCNR75A
          GOTO      DOL6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "L",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print the minutes
.
          MOVE      "L",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOL7000
.
.         Report Layout 2
.
DOL6500   MOVE      "L",DIM1                * breakdown L
          PRINT     FRTIME," - ",TOTIME;
          CALL      PRNT0000
.
DOL7000   MATCH     OPCNBRKL,OPCNBRKM
          GOTO      DOL9000 IF EQUAL
.
          MATCH     "00:00",OPCNBRKL
          GOTO      DOL9000 IF EQUAL
.
          PRINT     *N;
          MOVE      FALSE,EXIT
          GOTO      DOL9999
.
DOL9000   MOVE      TRUE,EXIT
.         
DOL9999   RETURN
+
.*************************************************************************
.*                           DOM0000                                     *
.*          Print the records in summary breakdown M                     *
.*************************************************************************
DOM0000   MOVE      OPCNBRKL,FRTIME         * set up from time
          MOVE      OPCNBRKM,TOTIME         * set up end time
.
          COMPARE   TWO,OPCNR75A
          GOTO      DOM6500 IF EQUAL        * report type 2
.
.         Report Layout 1
.         print the cases
.
          MOVE      "M",TEMPSUM
          MOVE      "C",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      OPCNBRKL,FRTIME
          MOVE      OPCNBRKM,TOTIME
          MOVE      " - ",SPSP
          MOVE      CAS,LABEL               * set the type to print
          CALL      PRNT0000
.
.         print minutes
.
          MOVE      "M",TEMPSUM
          MOVE      "M",TEMPTYP
          MOVE      "zzz",TEMPUSER
          CALL      CLVR0000                * clear variables
          PACK      KEY5,TEMPSUM,TEMPTYP,TEMPUSER
          CALL      RDOPTP1
.
          MOVE      SP10,FRTIME
          MOVE      SP10,TOTIME
          MOVE      SP3,SPSP
          MOVE      MIN,LABEL               * set print type
          CALL      PRNT0000
          GOTO      DOM9999
.
.         Report Layout 2
.
DOM6500   MOVE      "M",DIM1                * breakdown M
          PRINT     FRTIME," - ",TOTIME;
          CALL      PRNT0000
.
DOM9999   RETURN
+
.*********************************************************************
.*                  MTMP0000                    Called by : PROC0000 *
.*        Para's  : KEY5          period/type/user                   *
.*                  FORM6         amount to add                      *
.*********************************************************************
MTMP0000  CALL      RDOPTP1                 * record already there
          BRANCH    OVRCD,MTMP5000          * if not, go and write 
.
.         update record
.
          LOAD      TEMP,OPCTDOFW,TEMPMOCT,TEMPTUCT,TEMPWECT,TEMPTHCT:
                                  TEMPFRCT,TEMPSACT,TEMPSUCT
          ADD       FORM6,TEMP
          STORE     TEMP,OPCTDOFW,TEMPMOCT,TEMPTUCT,TEMPWECT,TEMPTHCT:
                                  TEMPFRCT,TEMPSACT,TEMPSUCT
.
          CALL      UPOPTP1
          CALL      CLVR0000                * clear variables
          GOTO      MTMP9999
.
.         write new record
.
MTMP5000  CALL      CLVR0000         
          LOAD      TEMP,OPCTDOFW,TEMPMOCT,TEMPTUCT,TEMPWECT,TEMPTHCT:
                                  TEMPFRCT,TEMPSACT,TEMPSUCT
          ADD       FORM6,TEMP
          STORE     TEMP,OPCTDOFW,TEMPMOCT,TEMPTUCT,TEMPWECT,TEMPTHCT:
                                  TEMPFRCT,TEMPSACT,TEMPSUCT
          CALL      WROPTP1
.
MTMP9999  RETURN
+
.*********************************************************************
.*                  TOT0000                     Called by : PROC2000 *
.*        Print the line of totals at bottom of page                 *
.*********************************************************************
TOT0000   BRANCH    OPCNR75A,TOT1000,TOT2000
          GOTO      TOT9999
.
.         Report Layout 1
.
TOT1000   CALL      UND132
          MOVE      "zzz",ACODE
          PACK      KEY5,ZED,ANSC,ACODE
          CALL      RDOPTP1
          PRINT     "Total Number of Cases",*37,TEMPMOCT,*49,TEMPTUCT:
                    *61,TEMPWECT:
                    *73,TEMPTHCT,*85,TEMPFRCT,*97,TEMPSACT,*109,TEMPSUCT;
          MOVE      ZERO,TOTCAS
          ADD       TEMPMOCT,TOTCAS
          ADD       TEMPTUCT,TOTCAS
          ADD       TEMPWECT,TOTCAS
          ADD       TEMPTHCT,TOTCAS
          ADD       TEMPFRCT,TOTCAS
          ADD       TEMPSACT,TOTCAS
          ADD       TEMPSUCT,TOTCAS
          PRINT     *123,TOTCAS
.
          MOVE      "zzz",ACODE
          PACK      KEY5,ZED,ANSM,ACODE
          CALL      RDOPTP1
          PRINT     "Total Minutes Used   ",*37,TEMPMOCT,*49,TEMPTUCT:
                    *61,TEMPWECT:
                    *73,TEMPTHCT,*85,TEMPFRCT,*97,TEMPSACT,*109,TEMPSUCT;
          MOVE      ZERO,TOTCAS
          ADD       TEMPMOCT,TOTCAS
          ADD       TEMPTUCT,TOTCAS
          ADD       TEMPWECT,TOTCAS
          ADD       TEMPTHCT,TOTCAS
          ADD       TEMPFRCT,TOTCAS
          ADD       TEMPSACT,TOTCAS
          ADD       TEMPSUCT,TOTCAS
          PRINT     *123,TOTCAS
.
          CALL      UND132
          PRINT     *N,"Total Minutes Used   = Theatre duration"
          PRINT     *N," *** End of Report ***",*N
          GOTO      TOT9999
.
.         Report Layout 2
.
TOT2000   CALL      UND132
          COMPARE   "55",CLNO
          CALL      HEAD0000 IF NOT LESS    * print new heading
.
          PRINT     "GRAND TOTAL   ";
          MOVE      ZED,DIM1
          CALL      PRNT0000
          CALL      UND132
          PRINT     *N," *** End of Report ***",*N
.
TOT9999   RETURN
+
.*********************************************************************
.*                  PRNT0000                    Called by : DOA6000  * 
.*        Print a line of code                                       *
.*        Para's  : DIM1          breakdown code for layout 2        *
.*********************************************************************
PRNT0000  BRANCH    OPCNR75A,PRNT1000,PRNT2000
          GOTO      PRNT9999
.
.         Report Layout 1
.
PRNT1000  PRINT     FRTIME,SPSP,TOTIME,LABEL,*37,TEMPMOCT,*49,TEMPTUCT:
                    *61,TEMPWECT:
                    *73,TEMPTHCT,*85,TEMPFRCT,*97,TEMPSACT,*109,TEMPSUCT;
          MOVE      ZERO,TOTAL
          ADD       TEMPMOCT,TOTAL
          ADD       TEMPTUCT,TOTAL
          ADD       TEMPWECT,TOTAL
          ADD       TEMPTHCT,TOTAL
          ADD       TEMPFRCT,TOTAL
          ADD       TEMPSACT,TOTAL
          ADD       TEMPSUCT,TOTAL
          PRINT     *123,TOTAL
          GOTO      PRNT9999
.
.         Report Layout 2
.
PRNT2000  COMPARE   "55",CLNO
          CALL      HEAD0000 IF NOT LESS    * print new heading
.
          MOVE      "Y  ",ACODE             * print number of major cases
          PACK      KEY5,DIM1,ANSC,ACODE
          CALL      RDOPTP1
          COMPARE   ONE,OVRCD
          CALL      CLVR0000 IF EQUAL       * no values
          PRINT     *15,USERYES,*37,TEMPMOCT,*49,TEMPTUCT,*61,TEMPWECT:
                    *73,TEMPTHCT,*85,TEMPFRCT,*97,TEMPSACT,*109,TEMPSUCT;
          MOVE      ZERO,TOTAL
          ADD       TEMPMOCT,TOTAL
          ADD       TEMPTUCT,TOTAL
          ADD       TEMPWECT,TOTAL
          ADD       TEMPTHCT,TOTAL
          ADD       TEMPFRCT,TOTAL
          ADD       TEMPSACT,TOTAL
          ADD       TEMPSUCT,TOTAL
          PRINT     *123,TOTAL
.
          MOVE      "N  ",ACODE             * print number of minor cases
          PACK      KEY5,DIM1,ANSC,ACODE
          CALL      RDOPTP1
          COMPARE   ONE,OVRCD
          CALL      CLVR0000 IF EQUAL       * no values
          PRINT     *15,USERNO,*37,TEMPMOCT,*49,TEMPTUCT,*61,TEMPWECT:
                    *73,TEMPTHCT,*85,TEMPFRCT,*97,TEMPSACT,*109,TEMPSUCT;
          MOVE      ZERO,TOTAL
          ADD       TEMPMOCT,TOTAL
          ADD       TEMPTUCT,TOTAL
          ADD       TEMPWECT,TOTAL
          ADD       TEMPTHCT,TOTAL
          ADD       TEMPFRCT,TOTAL
          ADD       TEMPSACT,TOTAL
          ADD       TEMPSUCT,TOTAL
          PRINT     *123,TOTAL
.
          MOVE      SP3,ACODE               * print number of unknown cases
          PACK      KEY5,DIM1,ANSC,ACODE
          CALL      RDOPTP1
          COMPARE   ONE,OVRCD
          CALL      CLVR0000 IF EQUAL       * no values
          PRINT     *15,"No Code Entered",*37,TEMPMOCT,*49,TEMPTUCT:
                    *61,TEMPWECT,*73,TEMPTHCT,*85,TEMPFRCT,*97,TEMPSACT:
                    *109,TEMPSUCT;
          MOVE      ZERO,TOTAL
          ADD       TEMPMOCT,TOTAL
          ADD       TEMPTUCT,TOTAL
          ADD       TEMPWECT,TOTAL
          ADD       TEMPTHCT,TOTAL
          ADD       TEMPFRCT,TOTAL
          ADD       TEMPSACT,TOTAL
          ADD       TEMPSUCT,TOTAL
          PRINT     *123,TOTAL
.
          MOVE      "zzz",ACODE             * print total number of cases
          PACK      KEY5,DIM1,ANSC,ACODE
          CALL      RDOPTP1
          COMPARE   ONE,OVRCD
          CALL      CLVR0000 IF EQUAL       * no values
          PRINT     *15,"Total Number of Cases",*37,TEMPMOCT,*49,TEMPTUCT:
                    *61,TEMPWECT:
                    *73,TEMPTHCT,*85,TEMPFRCT,*97,TEMPSACT,*109,TEMPSUCT;
          MOVE      ZERO,TOTAL
          ADD       TEMPMOCT,TOTAL
          ADD       TEMPTUCT,TOTAL
          ADD       TEMPWECT,TOTAL
          ADD       TEMPTHCT,TOTAL
          ADD       TEMPFRCT,TOTAL
          ADD       TEMPSACT,TOTAL
          ADD       TEMPSUCT,TOTAL
          PRINT     *123,TOTAL
.
          MOVE      "zzz",ACODE             * print total minutes used
          PACK      KEY5,DIM1,ANSM,ACODE
          CALL      RDOPTP1
          COMPARE   ONE,OVRCD
          CALL      CLVR0000 IF EQUAL       * no values
          PRINT     *15,"Total Minutes Used",*37,TEMPMOCT,*49,TEMPTUCT:
                    *61,TEMPWECT:
                    *73,TEMPTHCT,*85,TEMPFRCT,*97,TEMPSACT,*109,TEMPSUCT;
          MOVE      ZERO,TOTAL
          ADD       TEMPMOCT,TOTAL
          ADD       TEMPTUCT,TOTAL
          ADD       TEMPWECT,TOTAL
          ADD       TEMPTHCT,TOTAL
          ADD       TEMPFRCT,TOTAL
          ADD       TEMPSACT,TOTAL
          ADD       TEMPSUCT,TOTAL
          PRINT     *123,TOTAL
          ADD       "6",CLNO
          GOTO      PRNT9999
.
PRNT9999  RETURN
.
.*********************************************************************
.*                  HEAD0000                                         *
.*        Print Heading                                              *
.*********************************************************************
HEAD0000  BRANCH    OPCNR75A,HEAD1000,HEAD2000
          GOTO      HEAD9999
.
.         Report Layout 1
.
HEAD1000  CALL      HEAD132
          PRINT     *N,*40,*+,OPCNCDSC," Type : ",ENCODE,SP2,ENDESC:
                    *N,*40,"From : ",PRDTFR," To : ",PRDTTO,*N
          CALL      UND132
          PRINT     "Time Periods",*39,"Monday",*50,"Tuesday",*60:
                    "Wednesday",*73,"Thursday",*87,"Friday",*97,"Saturday":
                    *111,"Sunday",*126,"TOTAL"
          CALL      UND132
          MOVE      "10",CLNO
          GOTO      HEAD9999
.
.         Report Layout 2
.
HEAD2000  CALL      HEAD132
          PRINT     *N,*40,*+,OPCNCDSC," Type : ",ENCODE,SP2,ENDESC:
                    *N,*40,"From : ",PRDTFR," To : ",PRDTTO,*N
          CALL      UND132
          PRINT     "Time Periods",*39,"Monday",*50,"Tuesday",*60:
                    "Wednesday",*73,"Thursday",*87,"Friday",*97,"Saturday":
                    *111,"Sunday",*126,"TOTAL"
          CALL      UND132
          MOVE      "12",CLNO
          GOTO      HEAD9999
.
HEAD9999  RETURN
+
.*********************************************************************
.*                  TYPE0000                    Called by : ML2000   *
.*        Enter the clinic type (Cat YG) or Doctor type (Cat DT)     *
.*********************************************************************
TYPE0000  MOVE      CATYG,CODE
          LOAD      CODE,OPCNCLSU,CATDT
.
          DISPLAY   *P1:9,*+,OPCNCDSC," type : "
          CALL      KCOD0000                * enter the code
          DISPLAY   *P1:9,*+,OPCNCDSC," type : ",*V2LON,ENCODE,*HOFF:
                    *P30:9,ENDESC,*EL
.
TYPE9999  RETURN
+
.********************************************************************
.*                  KCOD0000                   Called by : ....0000 *
.*        Keyin a codes file entry                                  *
.*        Returns : EXIT  = 1     exitchar entered                  *
.*                  ENDESC        the description                   *
.*                  ENCODE        the entered code                  *
.********************************************************************
KCOD0000  MOVE      ONE,SCRNFLAG            * set ? as not performed
          MOVE      "9",CVERT               * set keyin row
          MOVE      COL,CCOL                * set keyin column
.
KCOD1000  KEYIN     *PCCOL:CVERT,*DV,UNDLN3:
                    *PCCOL:CVERT,*V2LON,ENCODE:
                    *PCCOL:CVERT,*DV,ENCODE;
.
          ENDSET    ENCODE
          APPEND    SP3,ENCODE
          RESET     ENCODE
.
          MATCH     EXITCHAR,ENCODE 
          GOTO      KCOD9000 IF EQUAL       * exitchar entered
.
          MATCH     SP3,ENCODE 
          GOTO      KCOD7900 IF EQUAL       * nothing entered
.
          MATCH     QUEST,ENCODE
          GOTO      KCOD2000 IF NOT EQUAL   * ? not entered
.
.         ? entered
.
          CALL      PATCODDS                * ? routine
          MOVE      TWENTY4,CVERT           * row for input
          MOVE      TEN8,CCOL               * column for input
          MOVE      ZERO,SCRNFLAG           * set ? as performed
          DISPLAY   *P1:24,"Input the code : ",*EL
          GOTO      KCOD1000
.
.         validate what was entered
.
KCOD2000  PACK      KEY5,CODE,ENCODE        * key of entered value
          CALL      RDCODE1                 * read code file
          BRANCH    OVRCD,KCOD7000          * invalid input
.
          MOVE      TDESC,ENDESC            * save description
          GOTO      KCOD8000                * valid input
.
.         ERROR: invalid code entered
.
KCOD7000  DISPLAY   *P1:24,*EL,*B,"Invalid code.  ",*EL;
          CALL      HITENTER
          BRANCH    SCRNFLAG,KCOD1000       * ? not entered
          DISPLAY   *P1:24,"Input the code : ",*EL
          GOTO      KCOD1000    
.
.         nothing was entered
.
KCOD7900  MOVE      "All Types",ENDESC      * clear the description
          MOVE      SP3,ENCODE              * clear the code
.
.         valid code entered
.
KCOD8000  MOVE      FALSE,EXIT              * valid input
          BRANCH    SCRNFLAG,KCOD9999       * ? not entered
.
          CALL      DISP0000                * redisplay rest of screen
          GOTO      KCOD9999
.
KCOD9000  MOVE      ONE,EXIT                * exitchar entered
          MOVE      SP20,ENDESC             * clear the description
          MOVE      SP3,ENCODE              * clear the code
.
KCOD9999  RETURN
+
.*********************************************************************
.*                  GVCL0000                    Called by : PROC0000 *
.*        Get all valid clinic/doctor codes for the type entered     *
.*********************************************************************
GVCL0000  MOVE      SP6,KEY6
          BRANCH    OPCNCLSU,GVCL1000       * doctor file
.
          CALL      RSOPCLI1
          GOTO      GVCL2000
.
GVCL1000  CALL      RDSDOCT1
.
.         do a next read
.
GVCL2000  BRANCH    OPCNCLSU,GVCL3000       * doctor file
.
.         loop over clinic file
.
          CALL      RKOPCLI1
          BRANCH    OVRCD,GVCL9999          * end of file
.
          MOVE      OPCLCLIN,KEY6           * set clinic
          MATCH     SP3,ENCODE
          GOTO      GVCL5000 IF EQUAL       * all codes
.
          MATCH     ENCODE,OPCLCAT
          GOTO      GVCL2000 IF NOT EQUAL   * invalid type
          GOTO      GVCL5000                * valid clinic type
.
.         loop over doctors file
.
GVCL3000  CALL      RDKDOCT1
          BRANCH    OVRCD,GVCL9999          * end of file
.
          MOVE      DCODE,KEY6
          MATCH     SP3,ENCODE
          GOTO      GVCL5000 IF EQUAL       * all codes
.
          MATCH     ENCODE,DRTYPE
          GOTO      GVCL3000 IF NOT EQUAL   * invalid type
.
.         have a valid clinic/doctor code
.
GVCL5000  WRITE     TEMPB,KEY6;KEY6
          GOTO      GVCL2000
.
GVCL9999  RETURN
+
.*********************************************************************
.*                  CLVR0000                                         *
.*        Clears working variables                                   *
.*********************************************************************
CLVR0000  MOVE      ZERO,TEMPMOCT
          MOVE      ZERO,TEMPTUCT
          MOVE      ZERO,TEMPWECT
          MOVE      ZERO,TEMPTHCT
          MOVE      ZERO,TEMPFRCT
          MOVE      ZERO,TEMPSACT
          MOVE      ZERO,TEMPSUCT
          MOVE      ZERO,TOTAL
CLVR9999  RETURN
.
.************************************************************************
.*                           I/O                                        *
.*               I/O routines for temp file                             *
.************************************************************************
.
.------ I/O Routines for temp file ------
.
RAOPTP1   MOVE      ZERO,OVRCD
          RESET     KEY5
          READ      TEMPA,KEY5;ANS
          GOTO      OVERCOND IF OVER
          RETURN
.
RSOPTP1   MOVE      ZERO,OVRCD
          RESET     KEY5
          READ      TEMPA,KEY5;;
          RETURN
.
RDOPTP1   MOVE      ZERO,OVRCD
          RESET     KEY5
          READ      TEMPA,KEY5;TEMPSUM,TEMPTYP,TEMPUSER,TEMPMOCT,TEMPTUCT:
                               TEMPWECT,TEMPTHCT,TEMPFRCT,TEMPSACT,TEMPSUCT
          GOTO      OVERCOND IF OVER
          RETURN
.
RKOPTP1   MOVE      ZERO,OVRCD
          RESET     KEY5
          READKS    TEMPA;TEMPSUM,TEMPTYP,TEMPUSER,TEMPMOCT,TEMPTUCT:
                          TEMPWECT,TEMPTHCT,TEMPFRCT,TEMPSACT,TEMPSUCT
          GOTO      OVERCOND IF OVER
          RETURN
.
RPOPTP1   MOVE      ZERO,OVRCD
          RESET     KEY5
          READKP    TEMPA;TEMPSUM,TEMPTYP,TEMPUSER,TEMPMOCT,TEMPTUCT:
                          TEMPWECT,TEMPTHCT,TEMPFRCT,TEMPSACT,TEMPSUCT
          GOTO      OVERCOND IF OVER
          RETURN
.
WROPTP1   MOVE      ZERO,OVRCD
          RESET     KEY5
          WRITE     TEMPA,KEY5;TEMPSUM,TEMPTYP,TEMPUSER,TEMPMOCT,TEMPTUCT:
                               TEMPWECT,TEMPTHCT,TEMPFRCT,TEMPSACT,TEMPSUCT
          RETURN
.
UPOPTP1   UPDATE    TEMPA;TEMPSUM,TEMPTYP,TEMPUSER,TEMPMOCT,TEMPTUCT:
                          TEMPWECT,TEMPTHCT,TEMPFRCT,TEMPSACT,TEMPSUCT
          RETURN
.
DEOPTP1   RESET     KEY5
          DELETE    TEMPA,KEY5
          RETURN
.
.         I/O includes
.
          INC       STD001IO
          INC       TFILENAM                * Generate Temp File Name
          INC       IBASEQIO/INC            * Sequential Numbers File
          INC       WEBERRIO/INC            * Web Server Error Logging
.
          INC       OPRCLIIO/INC            * clinic file
          INC       OPRCTSIO/INC            * clinic type summary
          INC       PATCODKY                * ? for codes file
          INC       PATCODIO/INC            * codes file
          INC       PATDO1IO/INC            * doctor file
................................................................................
