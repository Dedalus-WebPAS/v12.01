.-------------------------------------------------------------------------------
. Program       : PATWEB91
.
. Author        : Pat Dirito 
.
. Function      : Code Maintenance 
.
. Modifications :
.-------------------------------------------------------------------------------
. V11.05.02 08/10/2025 PJ Le Febour    TSK 0967900a 
.           PSHED000 - amended spelling of Post Code to Postcode           
. V11.05.01 20/03/2025 Nikitha B       TSK 0956697  
.           Removed "Max Bookings" COL8HEAD for catcode "BK". Defaulted to 
.           "Associated No" at CDHED000 
. V11.04.04 20/09/2024 J.Tan           TSK 0950577
.           Mod to update Claim code Hold Invoice Date/time/user id
. V11.04.03 26/04/2024  Thanh T        TSK 0946765 
.           Added CODX1500 to return an indicator for specifying that the code
.           record has watvwlaf data or not
. V11.04.02 04/04/2024  Thanh T        TSK 0940239
.           Changed VADKY000 for matching discharge destination type  
. V11.04.01 24/01/2024 Nikitha B        TSK 0941356
.           Added new tags at WLID0800 and WPAG1400 to display red colored
.           details button when contents exists.
. V11.03.03 05/04/2023 J.Tan            TSK 0911166
.           Recompiled for Hold invoice audit
. V11.03.02 20/03/2023  Peter Vela        0911166
.           Added clear of new variables in PATCFAFD
. V11.03.01 13/02/2023 Alina Bhari      TSK 0929055
.           Corrected start value to previous and next button
.           - PREVGR00,NEXTGR00
. V11.02.01 12/07/2022 Bella Turco      TSK 0921957
.           Added NOMORE00 - Display "No more records" at end of list
.           Added PTCNNRTD - Displays number of rows set by parameter value
. V11.01.02 22/06/2021 Ebon Clements    TSK 0907537
.           Removed yellow colour default in lookup maintenance - 
.           "FFFF00",WBLPCLOR
. V11.01.01 02/06/2021 Thanh T          TSK 0905753
.           Changed CODD0500 to writeout "0" if TCFORM6 = 0 instead of SPACE  
. V10.15.01 19/11/2019  Sunny           TSK 0884133
.           Fixed Form length of PTCOD035
. V10.14.02 09/09/2019  J.Tan           TSK 0857392
.           Recompiled for ABF invoice
. V10.14.01 25/03/2019  Peter Vela     Task 0857392
.           Added IBPORRAV - Regional and Remote Areas Value
. V10.13.01 07/08/2018  Don Nguyen     TSK 0853011
.           Added new tag output in CODD0000 for Indicator 21-41,
.           User Defined Field 5-14, and Associated Field 6-15.
.           Modified CDROW000 to output Indicator 22-41 values.
.           Added PTCOD043-PTCOD042 to store Indicator 22-41,
.           User Defined Field 5-14, and Associated Number 6-15.
. V10.11.01 02/10/2017  J.Tan          TSK 0847694
.           Mod to Check Alternate ID Category Code already exists for WA only
. V10.10.01 09/05/2017  Davin          TSK 0321570
.           Added category output tags for TCINDC8,TCINDC10,TCINDC11 (CATD0000)
. V10.08.01 03/11/2016  Don Nguyen     TSK 0822547
.           Modified PSROW000 to output SUBRBNME (suburb name); call URLESC00 to
.           to perform URL escape on some chars ("'" and "+").
.           02/11/2016  Peter Vela     TSK 0823385
.           Added validaton for category in VADKY000
. V10.07.07 17/03/2016  Ebon Clements  TSK 0815831
.           Changed LHOSPARR from 99 to 999
. V10.07.06 15/02/2016  Don Nguyen     TSK 0324569
.           Added OUTCOMEC to VADKY000 & VADDB000 to validate against Cat OZ
. V10.07.05 29/01/2016  Don Nguyen     TSK 0319052
.           Added CHKAIP00 - check Alternate ID prefix combination for Cat "AI"
. V10.07.04 21/01/2016  J.Tan          CAR 303942
.           Mods validating payment type catg Py
. V10.07.03 16/11/2015  Ebon Clements  CAR 320392
.           Added outcprty test to transfer source code search
. V10.07.02 12/11/2015  J.Tan          CAR 321534
.           Added CODINS00 - insurance selection for Claim code
. V10.07.01 12/11/2015  Don Nguyen     CAR 320393
.           Added PVAD2500 (VADOP000) - Transfer Source Codes (filter by
.           Category 'OZ'; indicator 12).
.-------------------------------------------------------------------------------
. V10.04.06 12/05/2014  Patrick Adair  CAR 297326
.           Added processing for User Defined Fields 3&4 and Associated Number
.           2-5.
. V10.04.05 31.03.2014  B.G.Ackland  CAR 299363
.           Replace META Tag Redirect with Javascript in Common RDIREC00
.           Routine
. V10.04.04 24/03/2014  Patrick Adair  CAR 297193
.           Correct SETPAR processing of cgi's patva013 & 14 to cater for null
.           entry
. V10.04.03 17/03/2014  patrick Adair  CAR 297193
.           Added establishment number to transfer source maintenance
. V10.04.02 17/01/2013  Ebon Clements  CAR 285465
.           Added associated number 1 to cat codes maintenance
. V10.04.01 15/01/2013  Peter Vela     CAR 296086
.           Added save variable for PTCDHOSS in CATEGR20
.-------------------------------------------------------------------------------
. V10.03.11 28/11/2013  Ebon Clements  CAR 276569
.           Added transfer codes by key word tag for maintenance - PVAD2300  
. V10.03.10 13/03/2013  Patrick Adair  CAR 240163
.           Add Active Check Box for Categories H1-H9
. V10.03.09 23/08/2012  Don Nguyen     CAR 239154
.           Added output for Transfer Destination Coded Name (PTVACNME)     
. V10.03.08 17/08/2012  Don Nguyen     CAR 263828
.           Added Health Fund Group selection (HFGSEL00, PTCFHFGC, PTCFA010)
. V10.03.07 05/06/2012  J.Tan          CAR 255708
.           Mods Changing Free text Claim reason for Hold Inv to upd Inv.Pending
. V10.03.06 01/06/2012  J.Tan             CAR 255708
.           Mods Changing Claim Code Hold Inv.Fromdate to upd Inv.Pending file
. V10.03.05 14/04/2012  J.Tan             CAR 255708
.           Added ptcfa009 - Hold Invoice from date
. V10.03.04 30/03/2011  Steve Armstrong    CAR 262898
.           Changed RDPCODE3 to RDPCODE4 for read on Index 4
. V10.03.03 06/12/2011  Mike Laming     CAR 240184
.           Further change to IBAPOSTF Post Code table - pack CGI variables  
. V10.03.02 15/11/2011  Mike Laming     CAR 240184
.           Changes to IBAPOSTF Post Code table - added State to Keys
. V10.02.07 22/07/2011  J.Tan           CAR 244159
.           Added Credit card surcharge
. V10.02.06 22/07/2011  J.Tan           CAR 244159
.           Added Credit card surcharge
. V10.02.05 12/07/2011 Peter Vela       CAR 246347
.           Added Mental Health Legal Status Matrix functionality
. V10.02.04 05/07/2011 Ebon Clements    CAR 240724
.           Added PTCOD034 - patcodes User Defined Field 2
. V10.02.03 24/06/2011 Pter McMullen    CAR 240725
.           Change ward select list to order by name, not code 
. V10.02.02 03/06/2011 J.Tan            CAR 239592
.           Renamed PTCDUDF1 to PTCDFELC
. V10.02.01 04/04/2011  Jill Parkinson    CAR 239574
.           Removed open of ibaprntf
. V10.01.03 01/03/2011  Ebon Clements     CAR 207295
.           Added key word search to transfer source codes
. V10.01.02 26/11/2010  Ebon Clements     CAR 234288
.           Schedule update claim code reason for hold inv 
. V10.01.01 12/11/2010  Ebon Clements  CAR 233038
.           Added claim code effective fields to PATCFAFD
. V10.00.04 13/05/2010  J.Tan
.           Added Codes enquiry template
. V10.00.03 17/05/2010  Ebon Clements CAR 220289
.           Added indicators TCINDC12 to TCINDC21
. V10.00.02 07/04/2010  Peter Vela    CAR 219433
.           Changed to use PTCOD002 instead of ACODE @ CODEGR70
.           Changed to use PTCOD001 instead of TCODE @ CODEGR70
. V10.00.01 24/03/2010 Ebon Clements  CAR 218544
.           Changed PMSDVAFD so the Eclipse DVA service code can be cat A or BT
.           24/03/2010  Steve Armstrong  CAR 218670
.           Added new PATCODFD variables to CLRCOD00 routine.
. V9.12.02  01/12/2009 WeeLee Koo     CAR 211370
.           Changed PMDVA001 from DIM3 to DIM9
.           Changed Cat A to Cat BT for Eclipse DVA service code(CODEGR80)
. V9.12.01  26/11/2009 Jill Parkinson CAR 174079
.           Mods to write to patcfaaf
. V9.11.02  07/04/2009 Jill Habasque  CAR 194105
.           Added <pre> before display of State hcp code                     
. V9.11.01  05/01/2009  Ebon Clements CAR 183976
.           Added Eclipse DVA accommodation service code maintenance (Cat A)
. V9.10.01  05/09/2008  Ebon Clements CAR 177922
.           Added clear of patcodes file vars to CODEGR10
. V9.09.08  23/04/2008  Ebon Clements CAR 166821
.           Fixed active filter goto in CODDS000
. V9.09.07  21/01/2007  Ebon Clements CAR 135519
.           Fixed admission source test at VADDB110
. V9.09.06  03/01/2008  Davin          CAR 153384
.           Added Default Fee Information Code (ptcddfic - Stationery Type 3)
. V9.09.05  17/12/2007  Ebon Clements CAR 157700
.           Fixed CODCD000 read of patcodes for goto button
. V9.09.04  09/10/2007  Peter McMullen CAR 147479
.           Add support for long descriptions (PTCDLDES)
. V9.09.03  01/09/2007  Ebon Clements CAR 146872
.           Added admsourc to NEXTGR00 and PREVGR00
. V9.09.02  26/06/2007  J.Tan   CAR 140282
.           Mods for Commission Account details for Credit Card
. V9.09.01  13/03/2007  Jill Habasque  CAR 135519
.           Added match for admission source in VADDB000
. V9.08.01  02/03/2007 Neelkamal Pyla CAR 117802
.           Mods to CODCD000, CODDS000 - Added functionality to filter the 
.           records based on Active Status
. V9.05.01  07/03/2006 Ebon Clements CAR 78533
.           Added hospital specific functionality to category codes
. V9.05.B02 07/02/2006 J.Tan  CAR 93540
.           Added Provider name & postcode to patvadaf file
. V9.05.B01 30/01/2006  Ebon Clements CAR 93186
.           Mods for REDIRECT length change. Recompiled for IBAWEBDF
. V9.04.02  22/02/2005 Peter Vela    CAR 57547
.           Added Provider Number - PATVA009 to Transfer Destination Codes
.           Maintenance (patweb9108002.html, patweb9108003.html)
. V9.04.01  20/12/2004 Mike Laming   CAR 55095
.           Change Headings for Categories "BK", "BT" and "J " at CDHED000
. V9.03.07  15/06/2004 Ebon Clements CAR 50687
.           Added grouper version to category codes maintenance
. V9.03.06  01/06/2004 Ebon Clements CAR 50332
.           Fixed transfer source code status display in VADTB000
. V9.03.05  14/04/2004 Davin         CAR 18702
.           Added category security ('chksec00' routine)
. V9.03.04  22/03/2004 Ebon Clements CAR 18703
.           Added transfer source start and end date functionality
. V9.03.03  12/11/2003 Ebon Clements CAR 40387
.           Added Report 9 post code maintenance
. V9.03.02  16/06/2003 Lina Vo       SRF 40370
.           Added Associated number (TCFORM6) to Category codes list.
. V9.03.01  16/05/2003 Pat Dirito    SRF 39121
.           Added MRT Location Selection & Ward Selection for Category  
.           "ap" Maintenance CODD2600 & 27
.-------------------------------------------------------------------------------
. V9.02.08  27/01/2003 Ebon Clements SRF 33415
.           Added ACTVFLAG to VADDB000 and created TAG PVAD1100
.           to not display inactive transfer sources in search
. V9.02.07  23/10/2002 Jill Habasque SRF 23610
.           Commented out check for inactive transfer source 
.           codes in VADDB000
. V9.02.06  16/09/2002 Peter Vela SRF/MOD 19400
.           Added PTCOD019 - HCP Equivalent 
. V9.02.05  06/03/2002 Ebon Clements 
.           Added JAVFMT00 to transfer source search
. V9.02.04  05/11/2001 Jill Habasque 
.           Commented out check for inactive transfer source 
.           codes in VADTB000
. V9.02.03  16/10/2001 Ebon Clements 
.           Mods to maintain PTCDDEFT for defualt category code
. V9.02.02  13/10/2001 Jill Habasque 
.           Mods to not display inactive codes                
. V9.02.01  01/10/2001 Ebon Clements 
.           Added update parent option to transfer source list
.-------------------------------------------------------------------------------
.                 V9.00.B03 04/07/2001 Ebon Clements 
.                           Added Indicator 11 to add and update codes    
.                 V9.00.B02 19/06/2001 Ebon Clements 
.                          Associated number defaulting to last entry value
.                          Fix clear of PTCOD005 move ZERO to is not SP70
.                 V5.08.02  16/08/2000  Caleb Sharman
.                          Changed Health Fund variables to be 8 chars
.                 V5.08.01 04/05/2000  B.G.Ackland
.                          Fix Image Path
.                 V5.07.10 10/03/2000  Katie Nelson             
.                          Added active indicator column to lookup detail line.
.                 V5.07.09 21/02/2000  Pat Dirito           
.                          Fixed report no 2: Table display (Active Indicator).
.                 V5.07.08 09/02/2000  Pat Dirito           
.                          Added Instances of ShowDetail Based on Report No.
.                 V5.07.07 08/02/2000  Nicole Harrington    
.                          Added Postcode Javascript Generation
.                 V5.07.06 20/12/1999  Katie Nelson         
.                          Recompiled for IBAWEBDF/IBAWEBCD 
.                 V5.07.05 03/11/1999  Katie Nelson         
.                          Recompiled for WEBDATCD/DAYOFWEK 
.                 V5.07.04 22/10/1999  Pat Dirito           
.                          Added Option 8 Transfer Codes 
.                 V5.07.03 05/10/1999  Nicole Harrington
.                          Fixed Warnings
.                 V5.07.02 26.07.1999 Pat Dirito  
.                          Added Update Parent to Category Search 
.
.                 V5.07.01 20.07.1999 B.G.Ackland  
.                          Added Category Lookup Generation
.
.                 V5.07.00 01.07.1999 Katie Nelson 
.                          Port from 6.06 to 5.07
.----------------------------------------------------------------------
.                 V6.06.00 12.05.1999 Pat Dirito
.                          Created Program
.                 V6.06.01 22.06.1999 Pat Dirito
.                          Changed Table Display    
.                 
.----------------------------------------------------------------------
          INC       IBAWEBDF  
          INC       WEBDATDF
          INC       RSHWEBDF
          
.....     INC       WEBRSHDF
           INC      WEBRSHFD/INC
SCHDPROG  DIM     8     * Program ID
SCHDNAME  DIM     50    * Description
PARAFILE  FILE    ASCII, FIXED=250
SCHDUDR1  DIM     30    * User Ref 1
SCHDUDR2  DIM     30    * User Ref 2
SCHDUDD1  DIM     8     * User Date 1
SCHDUDD2  DIM     8     * User Date 2
SCHDUDY1  DIM     1     * User Y/N 1
SCHDUDY2  DIM     1     * User Y/N 2
PARANAME  DIM     127
SCHDFILE  DIM     8     * Schedule File Number
          INC       IBAPOSFD/INC      *  Postcode File
          INC       IBACCSFD/INC      *  Category Security File
          INC       IBACGSFD/INC      *  Group Security File
          INC       IBACUSFD/INC      *  User Security File
          INC       PATCONFD/INC      *  Control File 
          INC       PATCFAFD/INC 
          INC       PATHGPFD/INC      * Patient Health Fund Group
          INC       PATHSPFD/INC      * Hospital File
          INC       PATIN1FD/INC      * Insurance file
          INC       PATWR1FD/INC      * Patient Ward/Bed File
          INC       PATVADFD/INC      *  Transfer Source Codes 
          INC       PMSCMMFD/INC      * Credit card commission details file
          INC       PMSDVAFD/INC
          INC       PMSVKIFD/INC
          INC       MEHLSMFD/INC
          INC       MEHLSMTD/INC
          INC       MLTSECFD/INC 
          INC       MRTLOCFD/INC
          INC       WATVWLFD/INC
          INC       WEBLDTFD/INC
          INC       WEBLIDFD/INC
          INC       WEBLPGFD/INC
.
.----------------------------------------------------------------------
. CGI Parameters
.----------------------------------------------------------------------
HOSPCODE  DIM       3
LHOSPARR  DIM       3[999]    * Array of hospital codes
.
PTCOD001  DIM       2        * Category
PTCOD002  DIM       3        * Code
PTCOD003  DIM       20       * Description
PTCOD004  DIM       4        * Hcs Equivalent
PTCOD005  FORM      6        * Assoc. No
PTCOD006  DIM       1        * Active Indicator A=Active I=Inactive
PTCOD007  DIM       1        * SPECIAL INDIC 1 (Categ depend)
PTCOD008  DIM       1        * SPECIAL INDIC 2 (Categ depend)
PTCOD009  DIM       1        * SPECIAL INDIC 3 (Categ depend)
PTCOD010  DIM       1        * SPECIAL INDIC 4 (Categ depend)
PTCOD011  DIM       1        * SPECIAL INDIC 5 (Categ depend)
PTCOD012  DIM       1        * SPECIAL INDIC 6 (Categ depend)
PTCOD013  DIM       1        * SPECIAL INDIC 7 (Categ depend)
PTCOD014  DIM       1        * SPECIAL INDIC 8 (Categ depend)
PTCOD015  DIM       1        * SPECIAL INDIC 9 (Categ depend)
PTCOD016  DIM       1        * SPECIAL INDIC10 (Categ depend)
PTCOD017  DIM       1        * SPECIAL INDIC11 (Categ depend)
PTCOD018  DIM       1        * Default category code flag
PTCOD019  DIM       4        * HCP Equivalent                                
PTCOD020  DIM       3        * GROUPER VERSION
PTCOD021  DIM       50       * Long Description PTCDLDES
PTCOD022  DIM       6        * Default Fee Information Code
PTCOD023  DIM       1        * SPECIAL INDIC12 (Categ depend)
PTCOD024  DIM       1        * SPECIAL INDIC13 (Categ depend)
PTCOD025  DIM       1        * SPECIAL INDIC14 (Categ depend)
PTCOD026  DIM       1        * SPECIAL INDIC15 (Categ depend)
PTCOD027  DIM       1        * SPECIAL INDIC16 (Categ depend)
PTCOD028  DIM       1        * SPECIAL INDIC17 (Categ depend)
PTCOD029  DIM       1        * SPECIAL INDIC18 (Categ depend)
PTCOD030  DIM       1        * SPECIAL INDIC19 (Categ depend)
PTCOD031  DIM       1        * SPECIAL INDIC20 (Categ depend)
PTCOD032  DIM       1        * SPECIAL INDIC21 (Categ depend)
PTCOD033  DIM      10        * Financial Election Stationery Form
PTCOD034  DIM      10        * User Defined Field 2
PTCOD035  FORM      2.2      * % Credit Card Surcharge
PTCOD036  DIM       6        * Associated Number 1
PTCOD037  DIM       6        * Associated Number 2
PTCOD038  DIM       6        * Associated Number 3
PTCOD039  DIM       6        * Associated Number 4
PTCOD040  DIM       6        * Associated Number 5
PTCOD041  DIM      10        * User Defined Field 3
PTCOD042  DIM      10        * User Defined Field 4
PTCOD043  DIM       1        * SPECIAL INDIC22 (Categ depend)
PTCOD044  DIM       1        * SPECIAL INDIC23 (Categ depend)
PTCOD045  DIM       1        * SPECIAL INDIC24 (Categ depend)
PTCOD046  DIM       1        * SPECIAL INDIC25 (Categ depend)
PTCOD047  DIM       1        * SPECIAL INDIC26 (Categ depend)
PTCOD048  DIM       1        * SPECIAL INDIC27 (Categ depend)
PTCOD049  DIM       1        * SPECIAL INDIC28 (Categ depend)
PTCOD050  DIM       1        * SPECIAL INDIC29 (Categ depend)
PTCOD051  DIM       1        * SPECIAL INDIC30 (Categ depend)
PTCOD052  DIM       1        * SPECIAL INDIC31 (Categ depend)
PTCOD053  DIM       1        * SPECIAL INDIC32 (Categ depend)
PTCOD054  DIM       1        * SPECIAL INDIC33 (Categ depend)
PTCOD055  DIM       1        * SPECIAL INDIC34 (Categ depend)
PTCOD056  DIM       1        * SPECIAL INDIC35 (Categ depend)
PTCOD057  DIM       1        * SPECIAL INDIC36 (Categ depend)
PTCOD058  DIM       1        * SPECIAL INDIC37 (Categ depend)
PTCOD059  DIM       1        * SPECIAL INDIC38 (Categ depend)
PTCOD060  DIM       1        * SPECIAL INDIC39 (Categ depend)
PTCOD061  DIM       1        * SPECIAL INDIC40 (Categ depend)
PTCOD062  DIM       1        * SPECIAL INDIC41 (Categ depend)
PTCOD063  DIM      10        * User Defined Field 5
PTCOD064  DIM      10        * User Defined Field 6
PTCOD065  DIM      10        * User Defined Field 7
PTCOD066  DIM      10        * User Defined Field 8
PTCOD067  DIM      10        * User Defined Field 9
PTCOD068  DIM      10        * User Defined Field 10
PTCOD069  DIM      10        * User Defined Field 11
PTCOD070  DIM      10        * User Defined Field 12
PTCOD071  DIM      10        * User Defined Field 13
PTCOD072  DIM      10        * User Defined Field 14
PTCOD073  DIM       6        * Associated Number 6
PTCOD074  DIM       6        * Associated Number 7
PTCOD075  DIM       6        * Associated Number 8
PTCOD076  DIM       6        * Associated Number 9
PTCOD077  DIM       6        * Associated Number 10
PTCOD078  DIM       6        * Associated Number 11
PTCOD079  DIM       6        * Associated Number 12
PTCOD080  DIM       6        * Associated Number 13
PTCOD081  DIM       6        * Associated Number 14
PTCOD082  DIM       6        * Associated Number 15
.
PTCFA001  DIM       3        * No days for payment (Cat CL)
PTCFA002  DIM       3        * Category FA (for Cat CL)
PTCFA003  DIM       3        * Category w0 (for Cat CL)
PTCFA004  DIM       1        * Contracts Effective From
PTCFA005  DIM       1        * Make CP and Search Matrix
PTCFA006  DIM       1        * Hold Invoice Until Coding Complete
PTCFA007  DIM       3        * Reason for Hold (Cat rh)
PTCFA008  DIM       80       * Reason for Hold Free Text
PTCFA009  DIM       8        * Hold Inv From date
PTCFA010  DIM       6        * Health Fund Group Code
.
PMDVA001  DIM       9        * Bed Type (Cat A or BT)
.
.  Credit Card Commission details file
.
PMCMM001  DIM       14       * Commission Account details
.
.  Post Code File Maintenance
.
PTPOS001  DIM       8        * Postcode
PTPOS002  DIM       45       * Suburb
PTPOS003  DIM       3        * State
PTPOS004  DIM       9        * ABS Aust Standard Geographical Classification
PTPOS005  DIM       5        * Regional and Remote Areas Value
.
WBLID001  DIM       8        * Lookup ID
WBLID002  DIM       50       * Lookup ID Description
WBPAG001  DIM       3        * Page Number
WBPAG002  DIM       50       * Page Title
WBPAG003  DIM       50       * Page Heading
WBPAG004  DIM       6        * Heading Color
WBPAG005  DIM       1        * Show Codes
WBPAG006  DIM       1        * Page Sequence
.
WBLDT001  DIM       3        * Unique ID
WBLDT002  DIM       10       * Code
WBLDT003  DIM       50       * Description
WBLDT004  DIM       1        * Type 0=Link 1=Detail Line 2=Checkbox line
WBLDT005  DIM       3        * Link Page
WBLDT006  DIM       1        * Active 0=No 1=Yes 
.
PATVA001  DIM       5        * Transfer Destination Code 
PATVA002  DIM       30       * Destination Description
PATVA003  DIM       4        * HDP Equivalent
PATVA004  DIM       1        * Active A=Active I=Inactive 
PATVA005  DIM       8        * Start Date                    
PATVA006  DIM       1        * Start Date Auto Update        
PATVA007  DIM       8        * End Date                    
PATVA008  DIM       1        * End Date Auto Update        
PATVA009  DIM       8        * Provider Number                         *I-57547
PATVA010  DIM       30       * Provider Name
PATVA011  DIM       8        * Provider Postcode
PATVA012  DIM       1        * Destination Type 
PATVA013  DIM       4        * Coded Name (4 alpha characters)
PATVA014  DIM       10       * Establishment Number
.
DIM8      DIM       8
DEFTHOSP  DIM       3        * Default Hospital
DISPDAT1  DIM       11       * Display date
DISPDAT2  DIM       11       * Display date
NEXTPAGE  DIM       1
UPDTTYPE  DIM       1        * Update Type
SAVEREAS  DIM       3
SAVEHOSS  DIM       1
STARTKEY  DIM       25       * Starting Key
STARTKY1  DIM       45       * Starting Key
LIDSTRCD  DIM       8        * Start GEN Lookup ID
LIDENDCD  DIM       8        * End GEN lookup ID 
CATSTRCD  DIM       2        * Start GEN Category
CATENDCD  DIM       2        * End GEN Category 
TYPEDESC  DIM       12
DEFTCODE  DIM       4        * Default postcode
DEFTSUBR  DIM       45       * Default Suburb
DEFTSTAT  DIM       3        * Default State
SAVKEY5   DIM       5
SAVEKEY5  DIM       5
SAVKEY35  DIM       35   
MENUFLAG  DIM       1        * Menu Type (Maintenance/Enquiry)
.----------------------------------------------------------------------
. Program Variables
.----------------------------------------------------------------------
ADMSOCAT  DIM       2
ADMSOURC  DIM       3        * Admission source (patvadaf search) 
DDSTTYPE  DIM       1        * Discharge destination type
...ARRCNT    FORM      3        * Array count
ACTVDESC  DIM       3        * Description for active indicator
ACTVFLAG  FORM      1        * Display inactive Codes 1=Yes 0= No
CATEDESC  DIM       25       * Current TCODE for Next & Prev pages 
CODESTAT  DIM       1        * Active Indicator
CURRCODE  DIM       2        * Current TCODE for Next & Prev pages 
COL3HEAD  DIM       20       * Codes column heading for HDP Default    *I-55095
COL7HEAD  DIM       20       * Codes column heading for HCP Equivalent *I-55095
COL8HEAD  DIM       20       * Codes column heading for Associated No. *I-55095
DFLTWARD  DIM       3        * Ward to be pre-selected on select list 
DISABLED  FORM      1        * Disable code editing? (1=Yes/0=No)
IDDESC    DIM       50       * Lookup ID description
LOOKID    DIM       8        * Lookup ID
LHOSPCNT  FORM      3        * Count of hospital array fields
INDEX     INIT      " Index"
PGNUM     INIT      "000"
PAGENO    DIM       3        * Lookup Page Number
PAGEHEAD  DIM       50       * Lookup Page Heading
REASHOLD  DIM       3
UNIQUEID  FORM      3        * Increment variable for UNIQUE ID
lOOKUPS   DIM       9
LINK      INIT      "Link - "
LNK2PRT   FORM      1
LINK2PRT  FORM      1        * Key for Keyword index
OUTCPRTY  DIM       3
OUTCOMEC  DIM       3        * Outcome code (Cat OZ)
.
JAVFNAME  DIM       70
STRTNAME  DIM       70
ENDNAME   DIM       70
.
STNTYPE   DIM       3        * Stationery Type
STNCODE   DIM       6        * Stationery Code
.
.
Cat_OZ    INIT      "OZ"
Cat_AI    INIT      "AI"
.
SUBRBNME  DIM       150      * Suburb Name (with URL escape chars for ' and +)
LOOPCNTR  FORM      2
CHRCOUNT  FORM      2
.
.-----------------------------------------------------------
PRGID     INIT      "PATWEB91" 
VERSION   INIT      "V12.01.00"
PRGNAM    INIT      "Code Search Server"
.-----------------------------------------------------------
.
          CALL      WEBINT00       * Initialise Fifo Etc.
          CALL      INIT0000       * Open Files
.
MAIN1000  CALL      WEBRED00       * Read Fifo WEBPID and USERID
.
          COMPARE   "999",REPORTNO * End Server Process on Report Option 999
          GOTO      MAIN9999 IF EQUAL
.
          BRANCH    REPORTNO,MAIN1100,MAIN1200,MAIN1300,MAIN1400,MAIN1500:
                             MAIN1600,MAIN1700,MAIN1800,MAIN1900,MAIN2000
.
          PACK      WEBTITLE,PRGID,SP1,VERSION,SP1,PRGNAM,SP70
          MOVE      "INVALID OPTION",WEBTITLE
          CALL      WEBERR00   * Create Output File and Write HTML Page Header
          GOTO      MAIN1000
.
MAIN1100  CALL      CATEGR00        * Category Code Maintenance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1200  CALL      CODEGR00        * Code Record Maintenance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1300  CALL      LKIDGR00        * Lookup ID Maintenance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1400  CALL      LKPAGR00        * Lookup Page Maintenance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1500  CALL      LKDETR00        * Lookup Details Maintenance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1600  CALL      LKHTML00        * Generate Lookup HTML
          GOTO      MAIN1000
.
MAIN1700  CALL      CTHTML00        * Generate Category HTML
          GOTO      MAIN1000
.
MAIN1800  CALL      PATVAD00        * Transfer Source Codes       
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN1900  CALL      IBAPOS00        * Postcode Maintanance
          BRANCH    EXIT,MAIN1000
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN2000  CALL      MEHLSM00        * Category Code Maintenance
          BRANCH    EXIT,MAIN1000
          MOVE      "Update Complete",WEBTITLE
          CALL      NXTPAG00
          GOTO      MAIN1000
.
MAIN9999  MOVE      "SERVER SHUTDOWN COMPLETE",WEBTITLE
          CALL      WEBERR00
          STOP
.------------------------------------------------------------
. Output Next Page Based on CGI Parameter nextpage
.------------------------------------------------------------
NXTPAG00  MOVE      ZERO,F1
          MOVE      NEXTPAGE,F1
          BRANCH    F1,NXTPAG10,NXTPAG20,NXTPAG30,NXTPAG40,NXTPAG50
.
          CALL      WINCLS00
          GOTO      NXTPAG99
.
NXTPAG10  CALL      RDIREC00
          GOTO      NXTPAG99
.
NXTPAG20  CALL      GOBACK00
          GOTO      NXTPAG99
.
NXTPAG30  CALL      GOBACK00
          GOTO      NXTPAG99
.
NXTPAG40  CALL      GOBACK00
          GOTO      NXTPAG99
.
NXTPAG50  CALL      RETURN00
          GOTO      NXTPAG99
.
NXTPAG99  RETURN
.-------------------------------------------------------------------------------
. Returns to Current Page After Alert for Update
.-------------------------------------------------------------------------------
RETURN00  CALL      OPENHTML
          BRANCH    EXIT,RETURN99
          MOVE      NEXTPAGE,F1
          SUB       TWO,F1
          WRITE     HTMLFILE;"<script type=#"text/javascript#"> {":
                             "    alert(#"",WEBTITLE,"#");":
                             "    self.close();":
                             "}":
                             "</script>"
          CALL      CLOSHTML
RETURN99  RETURN
.-------------------------------------------------------------------------------
.  Goes back x number of pages
.-------------------------------------------------------------------------------
GOBACK00  CALL      OPENHTML
          BRANCH    EXIT,GOBACK99
          MOVE      NEXTPAGE,F1
          SUB       TWO,F1
          WRITE     HTMLFILE;"<script type=#"text/javascript#"> {":
                             "    alert(#"",WEBTITLE,"#");":
.                            "    self.close();":
                             "    window.history.go(-",F1,");":
                             "}":
                             "</script>"
          CALL      CLOSHTML
GOBACK99  RETURN
.------------------------------------------------------------
. Open Files and Initialize Variables
.------------------------------------------------------------
INIT0000  OPEN      IBAPOST1,"ibapostf"
          OPEN      IBAPOST2,"ibapostf"
          OPEN      IBACCSA2,"ibaccsaf"
          OPEN      IBACGSA1,"ibacgsaf"
          OPEN      IBACUSA1,"ibacusaf"
          OPEN      PATCFAA1,"patcfaaf"
          OPEN      PATCODE1,"patcodes"
          OPEN      PATCODE2,"patcodes"
          OPEN      PATCODE3,"patcodes"
          OPEN      PATCODE4,"patcodes"
          OPEN      PATHGRP1,"pathgrpf"        * Health Fund Group
          OPEN      PATVADA1,"patvadaf"
          OPEN      PATVADA2,"patvadaf"
          OPEN      PATAUDVA,"pataudva"
          OPEN      WEBLIDA1,"weblidaf"
          OPEN      WEBLPGA1,"weblpgaf" 
          OPEN      WEBLDTA1,"webldtaf" 
          OPEN      MEHLSMA1,"mehlsmaf"
          OPEN      MRTLOCA1,"mrtlocaf"
          OPEN      WATVWLA2,"watvwlaf"
          OPEN      PATWR1A7,"patwr1af"
          OPEN      PATHSPA1,"pathspaf"
          OPEN      PMSVKIA1,"pmsvkiaf"
          OPEN      PMSVKIA2,"pmsvkiaf"
          OPEN      PMSCMMA1,"pmscmmaf"
          OPEN      MLTSECA1,"mltsecaf"
.
          OPEN      IBATMHA1,"ibatmhaf"
          OPEN      IBASPOL1,"ibaspolf"
          OPEN      IBAPRTA1,"ibaprtaf"        * For Printer Selection
          OPEN      IBACODE1,"ibacodef"        * For Printer Selection
          OPEN      IHAPASS1,"ihapassf"        * For Printer Selection
          OPEN      IBAPDFA1,"ibapdfaf"        * For default printer selection
          OPEN      WEBRSHA1,"webrshaf"
          OPEN      WEBRSHA2,"webrshaf"
          OPEN      PATIN1A1,"patin1af"
.
          OPEN      CONTROLF,"controlf";
          READ      CONTROLF,ZERO;*43,IBCNMHOS
          READ      CONTROLF,TEN;*205,CAUDE      * Audit switch
          READ      CONTROLF,FIFTY9;*60,PTCNUFMS
          READ      CONTROLF,EIGHTY;*250,PTCNHDPS
          READ      CONTROLF,HUND10;*115,PTCNUEDI
          READ      CONTROLF,HUND25;*238,PTCNNRTD
.
          MOVE      ZERO,F2
          MOVE      PTCNNRTD,F2
          IF        F2 = 0
            MOVE      "10",PTCNNRTD
          ENDIF
.
          IF        IBCNMHOS=1
            OPEN      MLTCODA1,"mltcodaf"
            OPEN      MLTCODA2,"mltcodaf"
          ENDIF
.
          IF        PTCNUEDI=1
            OPEN      PMSDVAA1,"pmsdvaaf"
          ENDIF
.        
          RETURN
.------------------------------------------------------------
. Clear Parameters
.------------------------------------------------------------
CLRPAR00  MOVE      ZERO,REPORTNO
          MOVE      SP70,TEMPLATE
          MOVE      ZERO,STARTNUM
          MOVE      ZERO,NORECORD
          MOVE      SP70,STARTKEY 
          MOVE      SP70,STARTKY1 
          MOVE      SP70,NEXTPAGE  
          PACK      REDIRECT,SP70,SP70,SP70,SP70
          MOVE      SP70,UPDTTYPE
          MOVE      SP70,CURRCODE 
          MOVE      SP70,ADMSOCAT
          MOVE      SP70,ADMSOURC 
          MOVE      SP70,DDSTTYPE 
          MOVE      SP70,MENUFLAG
          MOVE      SP70,OUTCPRTY
          MOVE      SP70,OUTCOMEC
.
          MOVE      SP70,PTCOD001 
          MOVE      SP70,PTCOD002
          MOVE      SP70,PTCOD003
          MOVE      SP70,PTCOD004
          MOVE      ZERO,PTCOD005 
          MOVE      SP70,PTCOD006 
          MOVE      SP70,PTCOD007
          MOVE      SP70,PTCOD008
          MOVE      SP70,PTCOD009
          MOVE      SP70,PTCOD010
          MOVE      SP70,PTCOD011
          MOVE      SP70,PTCOD012
          MOVE      SP70,PTCOD013
          MOVE      SP70,PTCOD014
          MOVE      SP70,PTCOD015
          MOVE      SP70,PTCOD016
          MOVE      SP70,PTCOD017
          MOVE      Z70,PTCOD018
          MOVE      SP70,PTCOD019
          MOVE      SP70,PTCOD020
          MOVE      Z70,PMCMM001
          MOVE      SP70,PTCOD021
          MOVE      SP70,PTCOD022
          MOVE      SP70,PTCOD023
          MOVE      SP70,PTCOD024
          MOVE      SP70,PTCOD025
          MOVE      SP70,PTCOD026
          MOVE      SP70,PTCOD027
          MOVE      SP70,PTCOD028
          MOVE      SP70,PTCOD029
          MOVE      SP70,PTCOD030
          MOVE      SP70,PTCOD031
          MOVE      SP70,PTCOD032
          MOVE      SP70,PTCOD033
          MOVE      SP70,PTCOD034
          MOVE      ZERO,PTCOD035
          MOVE      SP70,PTCOD036
          MOVE      SP70,PTCOD037
          MOVE      SP70,PTCOD038
          MOVE      SP70,PTCOD039
          MOVE      SP70,PTCOD040
          MOVE      SP70,PTCOD041
          MOVE      SP70,PTCOD042
          MOVE      SP70,PTCOD043
          MOVE      SP70,PTCOD044
          MOVE      SP70,PTCOD045
          MOVE      SP70,PTCOD046
          MOVE      SP70,PTCOD047
          MOVE      SP70,PTCOD048
          MOVE      SP70,PTCOD049
          MOVE      SP70,PTCOD050
          MOVE      SP70,PTCOD051
          MOVE      SP70,PTCOD052
          MOVE      SP70,PTCOD053
          MOVE      SP70,PTCOD054
          MOVE      SP70,PTCOD055
          MOVE      SP70,PTCOD056
          MOVE      SP70,PTCOD057
          MOVE      SP70,PTCOD058
          MOVE      SP70,PTCOD059
          MOVE      SP70,PTCOD060
          MOVE      SP70,PTCOD061
          MOVE      SP70,PTCOD062
          MOVE      SP70,PTCOD063
          MOVE      SP70,PTCOD064
          MOVE      SP70,PTCOD065
          MOVE      SP70,PTCOD066
          MOVE      SP70,PTCOD067
          MOVE      SP70,PTCOD068
          MOVE      SP70,PTCOD069
          MOVE      SP70,PTCOD070
          MOVE      SP70,PTCOD071
          MOVE      SP70,PTCOD072
          MOVE      SP70,PTCOD073
          MOVE      SP70,PTCOD074
          MOVE      SP70,PTCOD075
          MOVE      SP70,PTCOD076
          MOVE      SP70,PTCOD077
          MOVE      SP70,PTCOD078
          MOVE      SP70,PTCOD079
          MOVE      SP70,PTCOD080
          MOVE      SP70,PTCOD081
          MOVE      SP70,PTCOD082
.
          MOVE      SP70,PTCFA001
          MOVE      SP70,PTCFA002
          MOVE      SP70,PTCFA003
          MOVE      SP70,PTCFA004
          MOVE      ZERO,PTCFA005
          MOVE      ZERO,PTCFA006
          MOVE      SP70,PTCFA007
          MOVE      SP70,PTCFA008
          MOVE      SP70,PTCFA009
          MOVE      SP70,PTCFA010
.
          MOVE      SP70,WBLID001  
          MOVE      SP70,WBLID002  
          MOVE      SP70,WBPAG001  
          MOVE      SP70,WBPAG002  
          MOVE      SP70,WBPAG003  
          MOVE      SP70,WBPAG004  
          MOVE      SP70,WBPAG005  
          MOVE      SP70,WBPAG006  
          MOVE      SP70,WBLDT001  
          MOVE      SP70,WBLDT002  
          MOVE      SP70,WBLDT003  
          MOVE      SP70,WBLDT004  
          MOVE      SP70,WBLDT005  
          MOVE      SP70,WBLDT006  
.
          MOVE      SP70,PATVA001  
          MOVE      SP70,PATVA002  
          MOVE      SP70,PATVA003  
          MOVE      SP70,PATVA004  
          MOVE      SP70,PATVA005  
          MOVE      ZERO,PATVA006  
          MOVE      SP70,PATVA007  
          MOVE      ZERO,PATVA008  
          MOVE      SP70,PATVA009                                      *I-57547
          MOVE      SP70,PATVA010  
          MOVE      SP70,PATVA011  
          MOVE      SP70,PATVA012  
          MOVE      SP70,PATVA013  
          MOVE      SP70,PATVA014  
          MOVE      SP70,PMDVA001
.
          MOVE      SP70,IDDESC    
          MOVE      SP70,LOOKID    
          MOVE      SP70,PAGENO    
          MOVE      SP70,PAGEHEAD  
          MOVE      SP70,LIDSTRCD  
          MOVE      SP70,LIDENDCD  
          MOVE      SP70,CATSTRCD  
          MOVE      SP70,CATENDCD  
          MOVE      SP70,SCHDDATE
          MOVE      SP70,SCHDTIME
.
          MOVE      SP70,CODESTAT
.          
          MOVE      SP70,DEFTCODE
          MOVE      SP70,DEFTSUBR
.
          MOVE      Z70,PTPOS001
          MOVE      Z70,PTPOS002
          MOVE      Z70,PTPOS003
          MOVE      Z70,PTPOS004
          MOVE      Z70,PTPOS005
.
          MOVE      SP70,HOSPCODE
.
          MOVE      ONE,LHOSPCNT
          WHILE     LHOSPCNT <= 900
            MOVE      SP70,LHOSPARR[LHOSPCNT]
            ADD       ONE,LHOSPCNT
          DO
.
          MOVE      ZERO,LHOSPCNT
          MOVE      SP70,KEYWORDS
.
          CALL      CMHLSM00
.
          MOVE      SP70,PTCFHDAT
          MOVE      SP70,PTCFHFGC
.
CLRPAR99  RETURN
.------------------------------------------------------------
. Set Parameters
.------------------------------------------------------------
SETPAR00  MATCH     "reportno=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,REPORTNO
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "template=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,TEMPLATE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "schddate=",QRYNAME
          IF        @EQUAL
            UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
            CALL      SETMTH00
            PACK      SCHDDATE,CCENT,CYEAR,CMON,CDAY
            REP       " 0",SCHDDATE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "schdtime=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,SCHDTIME
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptcfa001=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,PTCFA001
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptcfa002=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,PTCFA002
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptcfa003=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,PTCFA003
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptcfa004=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,PTCFA004
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptcfa005=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,PTCFA005
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptcfa006=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,PTCFA006
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptcfa007=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,PTCFA007
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptcfa008=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,PTCFA008
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptcfa009=",QRYNAME
          IF        @EQUAL
            UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
            CALL      SETMTH00            * Set CMON from MTHNAM3
            PACK      PTCFA009,CCENT,CYEAR,CMON,CDAY,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptcfa010=",QRYNAME
          IF        @EQUAL
            MOVE    QRYDATA,PTCFA010
            GOTO    SETPAR99
          ENDIF
.
          MATCH     "startkey=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,STARTKEY
            PACK      STARTKEY,STARTKEY,SP70
            REP       "~'",STARTKEY
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "startky1=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,STARTKY1
            PACK      STARTKY1,STARTKY1,SP70
            REP       "~'",STARTKY1
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "updttype=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,UPDTTYPE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "menuflag=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,MENUFLAG
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "startnum=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,STARTNUM
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "norecord=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,NORECORD
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "nextpage=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,NEXTPAGE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "redirect=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,REDIRECT
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "admsocat=",QRYNAME
          IF        @EQUAL
            PACK      ADMSOCAT,QRYDATA,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "admsourc=",QRYNAME
          IF        @EQUAL
            PACK      ADMSOURC,QRYDATA,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ddsttype=",QRYNAME
          IF        @EQUAL
            PACK      DDSTTYPE,QRYDATA,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "wblid001=",QRYNAME
          IF        @EQUAL
            SQUEEZE   QRYDATA
            MOVE      QRYDATA,WBLID001
            PACK      WBLID001,WBLID001,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "wblid002=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,WBLID002
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "lidstrcd=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,LIDSTRCD
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "lidendcd=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,LIDENDCD
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "catstrcd=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,CATSTRCD
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "catendcd=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,CATENDCD
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptcod",QRYNAME
          IF        @EQUAL
            CALL      STCOD000
            COMPARE   ZERO,EXIT
            GOTO      SETPAR99 IF EQUAL
          ENDIF
.
          MATCH     "wbpag",QRYNAME
          IF        @EQUAL
            CALL      STPAG000
            COMPARE   ZERO,EXIT
            GOTO      SETPAR99 IF EQUAL
          ENDIF
.
          MATCH     "wbldt",QRYNAME
          IF        @EQUAL
            CALL      STLDT000
            COMPARE   ZERO,EXIT
            GOTO      SETPAR99 IF EQUAL
          ENDIF
.
          MATCH     "patva",QRYNAME
          IF        @EQUAL
            CALL      STVAD000
            GOTO      SETPAR99 
          ENDIF
.
          MATCH     "codestat=",QRYNAME
          IF        @EQUAL
            PACK      CODESTAT,QRYDATA,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "deftcode=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,DEFTCODE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "deftsubr=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,DEFTSUBR
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "ptpos",QRYNAME
          IF        @EQUAL
            CALL      STPOS000
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "lhosparr=",QRYNAME
          IF        @EQUAL
            COMPARE   "900",LHOSPCNT
            GOTO      SETPAR99 IF EQUAL
            ADD       ONE,LHOSPCNT
            PACK      LHOSPARR[LHOSPCNT],QRYDATA,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "hospcode=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,HOSPCODE
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "pmdva001=",QRYNAME
          IF        @EQUAL
            PACK      PMDVA001,QRYDATA,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "outcprty=",QRYNAME
          IF        @EQUAL
            PACK      OUTCPRTY,QRYDATA,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "outcomec=",QRYNAME
          IF        @EQUAL
            PACK      OUTCOMEC,QRYDATA,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "pmcmm001=",QRYNAME
          IF        @EQUAL
            SQUEEZE   QRYDATA
            MOVE      QRYDATA,PMCMM001
            PACK      PMCMM001,PMCMM001,SP70
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "keywords=",QRYNAME
          IF        @EQUAL
            MOVE      QRYDATA,KEYWORDS
            REP       "~'",KEYWORDS
            GOTO      SETPAR99
          ENDIF
.
          MATCH     "mhlsm",QRYNAME
          IF        @EQUAL
            CALL      SMHLSM00
            GOTO      SETPAR99
          ENDIF
.
SETPAR99  RETURN
.-------------------------------------------------------------------------------
.   Set Parameters for Emergency User Security Table
.-------------------------------------------------------------------------------
STCOD000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STCOD001,STCOD002,STCOD003,STCOD004,STCOD005:
                       STCOD006,STCOD007,STCOD008,STCOD009,STCOD010:
                       STCOD011,STCOD012,STCOD013,STCOD014,STCOD015:
                       STCOD016,STCOD017,STCOD018,STCOD019,STCOD020:
                       STCOD021,STCOD022,STCOD023,STCOD024,STCOD025:
                       STCOD026,STCOD027,STCOD028,STCOD029,STCOD030:
                       STCOD031,STCOD032,STCOD033,STCOD034,STCOD035:
                       STCOD036,STCOD037,STCOD038,STCOD039,STCOD040:
                       STCOD041,STCOD042,STCOD043,STCOD044,STCOD045:
                       STCOD046,STCOD047,STCOD048,STCOD049,STCOD050:
                       STCOD051,STCOD052,STCOD053,STCOD054,STCOD055:
                       STCOD056,STCOD057,STCOD058,STCOD059,STCOD060:
                       STCOD061,STCOD062,STCOD063,STCOD064,STCOD065:
                       STCOD066,STCOD067,STCOD068,STCOD069,STCOD070:
                       STCOD071,STCOD072,STCOD073,STCOD074,STCOD075:
                       STCOD076,STCOD077,STCOD078,STCOD079,STCOD080:
                       STCOD081,STCOD082
.
          MOVE      ONE,EXIT
          GOTO      STCOD999
.
STCOD001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PTCOD001
          PACK      PTCOD001,PTCOD001,SP70
          GOTO      STCOD999
STCOD002  MOVE      QRYDATA,PTCOD002
          GOTO      STCOD999
STCOD003  MOVE      QRYDATA,PTCOD003
          GOTO      STCOD999
STCOD004  MOVE      QRYDATA,PTCOD004
          GOTO      STCOD999
STCOD005  MOVE      QRYDATA,PTCOD005
          GOTO      STCOD999
STCOD006  MOVE      QRYDATA,PTCOD006     
          GOTO      STCOD999  
STCOD007  MOVE      QRYDATA,PTCOD007     
          GOTO      STCOD999  
STCOD008  MOVE      QRYDATA,PTCOD008     
          GOTO      STCOD999  
STCOD009  MOVE      QRYDATA,PTCOD009     
          GOTO      STCOD999  
STCOD010  MOVE      QRYDATA,PTCOD010     
          GOTO      STCOD999  
STCOD011  MOVE      QRYDATA,PTCOD011     
          GOTO      STCOD999  
STCOD012  MOVE      QRYDATA,PTCOD012     
          GOTO      STCOD999  
STCOD013  MOVE      QRYDATA,PTCOD013     
          GOTO      STCOD999  
STCOD014  MOVE      QRYDATA,PTCOD014     
          GOTO      STCOD999  
STCOD015  MOVE      QRYDATA,PTCOD015     
          GOTO      STCOD999  
STCOD016  MOVE      QRYDATA,PTCOD016     
          GOTO      STCOD999  
STCOD017  MOVE      QRYDATA,PTCOD017     
          GOTO      STCOD999  
STCOD018  MOVE      QRYDATA,PTCOD018     
          GOTO      STCOD999  
STCOD019  MOVE      QRYDATA,PTCOD019     
          GOTO      STCOD999  
STCOD020  MOVE      QRYDATA,PTCOD020     
          GOTO      STCOD999
STCOD021  MOVE      QRYDATA,PTCOD021     
          GOTO      STCOD999 
STCOD022  MOVE      QRYDATA,PTCOD022     
          GOTO      STCOD999 
STCOD023  MOVE      QRYDATA,PTCOD023     
          GOTO      STCOD999 
STCOD024  MOVE      QRYDATA,PTCOD024     
          GOTO      STCOD999 
STCOD025  MOVE      QRYDATA,PTCOD025     
          GOTO      STCOD999 
STCOD026  MOVE      QRYDATA,PTCOD026     
          GOTO      STCOD999 
STCOD027  MOVE      QRYDATA,PTCOD027     
          GOTO      STCOD999 
STCOD028  MOVE      QRYDATA,PTCOD028     
          GOTO      STCOD999 
STCOD029  MOVE      QRYDATA,PTCOD029     
          GOTO      STCOD999 
STCOD030  MOVE      QRYDATA,PTCOD030     
          GOTO      STCOD999 
STCOD031  MOVE      QRYDATA,PTCOD031     
          GOTO      STCOD999 
STCOD032  MOVE      QRYDATA,PTCOD032     
          GOTO      STCOD999 
STCOD033  MOVE      QRYDATA,PTCOD033     
          GOTO      STCOD999 
STCOD034  MOVE      QRYDATA,PTCOD034     
          GOTO      STCOD999 
STCOD035  MOVE      QRYDATA,PTCOD035
          GOTO      STCOD999
STCOD036  MOVE      QRYDATA,PTCOD036
          GOTO      STCOD999
STCOD037  MOVE      QRYDATA,PTCOD037
          GOTO      STCOD999
STCOD038  MOVE      QRYDATA,PTCOD038
          GOTO      STCOD999
STCOD039  MOVE      QRYDATA,PTCOD039
          GOTO      STCOD999
STCOD040  MOVE      QRYDATA,PTCOD040
          GOTO      STCOD999
STCOD041  MOVE      QRYDATA,PTCOD041
          GOTO      STCOD999
STCOD042  MOVE      QRYDATA,PTCOD042
          GOTO      STCOD999
STCOD043  MOVE      QRYDATA,PTCOD043
          GOTO      STCOD999
STCOD044  MOVE      QRYDATA,PTCOD044
          GOTO      STCOD999
STCOD045  MOVE      QRYDATA,PTCOD045
          GOTO      STCOD999
STCOD046  MOVE      QRYDATA,PTCOD046
          GOTO      STCOD999
STCOD047  MOVE      QRYDATA,PTCOD047
          GOTO      STCOD999
STCOD048  MOVE      QRYDATA,PTCOD048
          GOTO      STCOD999
STCOD049  MOVE      QRYDATA,PTCOD049
          GOTO      STCOD999
STCOD050  MOVE      QRYDATA,PTCOD050
          GOTO      STCOD999
STCOD051  MOVE      QRYDATA,PTCOD051
          GOTO      STCOD999
STCOD052  MOVE      QRYDATA,PTCOD052
          GOTO      STCOD999
STCOD053  MOVE      QRYDATA,PTCOD053
          GOTO      STCOD999
STCOD054  MOVE      QRYDATA,PTCOD054
          GOTO      STCOD999
STCOD055  MOVE      QRYDATA,PTCOD055
          GOTO      STCOD999
STCOD056  MOVE      QRYDATA,PTCOD056
          GOTO      STCOD999
STCOD057  MOVE      QRYDATA,PTCOD057
          GOTO      STCOD999
STCOD058  MOVE      QRYDATA,PTCOD058
          GOTO      STCOD999
STCOD059  MOVE      QRYDATA,PTCOD059
          GOTO      STCOD999
STCOD060  MOVE      QRYDATA,PTCOD060
          GOTO      STCOD999
STCOD061  MOVE      QRYDATA,PTCOD061
          GOTO      STCOD999
STCOD062  MOVE      QRYDATA,PTCOD062
          GOTO      STCOD999
STCOD063  MOVE      QRYDATA,PTCOD063
          GOTO      STCOD999
STCOD064  MOVE      QRYDATA,PTCOD064
          GOTO      STCOD999
STCOD065  MOVE      QRYDATA,PTCOD065
          GOTO      STCOD999
STCOD066  MOVE      QRYDATA,PTCOD066
          GOTO      STCOD999
STCOD067  MOVE      QRYDATA,PTCOD067
          GOTO      STCOD999
STCOD068  MOVE      QRYDATA,PTCOD068
          GOTO      STCOD999
STCOD069  MOVE      QRYDATA,PTCOD069
          GOTO      STCOD999
STCOD070  MOVE      QRYDATA,PTCOD070
          GOTO      STCOD999
STCOD071  MOVE      QRYDATA,PTCOD071
          GOTO      STCOD999
STCOD072  MOVE      QRYDATA,PTCOD072
          GOTO      STCOD999
STCOD073  MOVE      QRYDATA,PTCOD073
          GOTO      STCOD999
STCOD074  MOVE      QRYDATA,PTCOD074
          GOTO      STCOD999
STCOD075  MOVE      QRYDATA,PTCOD075
          GOTO      STCOD999
STCOD076  MOVE      QRYDATA,PTCOD076
          GOTO      STCOD999
STCOD077  MOVE      QRYDATA,PTCOD077
          GOTO      STCOD999
STCOD078  MOVE      QRYDATA,PTCOD078
          GOTO      STCOD999
STCOD079  MOVE      QRYDATA,PTCOD079
          GOTO      STCOD999
STCOD080  MOVE      QRYDATA,PTCOD080
          GOTO      STCOD999
STCOD081  MOVE      QRYDATA,PTCOD081
          GOTO      STCOD999
STCOD082  MOVE      QRYDATA,PTCOD082
          GOTO      STCOD999
.
STCOD999  RETURN
.-------------------------------------------------------------------------------
.   Set Parameters for Lookup Page Details Table
.-------------------------------------------------------------------------------
STPAG000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STPAG001,STPAG002,STPAG003,STPAG004,STPAG005:
                       STPAG006
.
          MOVE      ONE,EXIT
          GOTO      STPAG999
.
STPAG001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,WBPAG001
          PACK      WBPAG001,WBPAG001,SP70
          GOTO      STPAG999
STPAG002  MOVE      QRYDATA,WBPAG002
          GOTO      STPAG999
STPAG003  MOVE      QRYDATA,WBPAG003
          GOTO      STPAG999
STPAG004  PACK      WBPAG004,QRYDATA,SP70
          GOTO      STPAG999
STPAG005  MOVE      QRYDATA,WBPAG005
          GOTO      STPAG999
STPAG006  MOVE      QRYDATA,WBPAG006
          GOTO      STPAG999
.
STPAG999  RETURN
.-------------------------------------------------------------------------------
.   Set Parameters for Lookup Details Line Table
.-------------------------------------------------------------------------------
STLDT000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STLDT001,STLDT002,STLDT003,STLDT004,STLDT005:
                       STLDT006
.
          MOVE      ONE,EXIT
          GOTO      STLDT999
.
STLDT001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,WBLDT001
          PACK      WBLDT001,WBLDT001,SP70
          GOTO      STLDT999
STLDT002  MOVE      QRYDATA,WBLDT002
          GOTO      STLDT999
STLDT003  MOVE      QRYDATA,WBLDT003
          GOTO      STLDT999
STLDT004  MOVE      QRYDATA,WBLDT004
          GOTO      STLDT999
STLDT005  MOVE      QRYDATA,WBLDT005
          GOTO      STLDT999
STLDT006  MOVE      QRYDATA,WBLDT006
          GOTO      STLDT999
.
STLDT999  RETURN
.-------------------------------------------------------------------------------
.   Reportno 8: Set Parameters - Transfer Source Code File
.-------------------------------------------------------------------------------
STVAD000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STVAD001,STVAD002,STVAD003,STVAD004,STVAD005:
                       STVAD006,STVAD007,STVAD008,STVAD009,STVAD010:
                       STVAD011,STVAD012,STVAD013,STVAD014
.
          GOTO      STVAD999
.
STVAD001  SQUEEZE   QRYDATA
          MOVE      QRYDATA,PATVA001
          PACK      PATVA001,PATVA001,SP70
          GOTO      STVAD999
.
STVAD002  MOVE      QRYDATA,PATVA002
          GOTO      STVAD999
.
STVAD003  MOVE      QRYDATA,PATVA003
          GOTO      STVAD999
.
STVAD004  MOVE      QRYDATA,PATVA004
          GOTO      STVAD999
.
STVAD005  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00
          PACK      PATVA005,CCENT,CYEAR,CMON,CDAY
          GOTO      STVAD999
.
STVAD006  MOVE      QRYDATA,PATVA006
          GOTO      STVAD999
.
STVAD007  UNPACK    QRYDATA,CDAY,KEY1,MTHNAM3,KEY1,CCENT,CYEAR
          CALL      SETMTH00
          PACK      PATVA007,CCENT,CYEAR,CMON,CDAY
          GOTO      STVAD999
.
STVAD008  MOVE      QRYDATA,PATVA008
          GOTO      STVAD999
.
STVAD009  MOVE      QRYDATA,PATVA009                                   *I-57547
          GOTO      STVAD999
.
STVAD010  MOVE      QRYDATA,PATVA010
          GOTO      STVAD999
.
STVAD011  MOVE      QRYDATA,PATVA011
          GOTO      STVAD999
.
STVAD012  MOVE      QRYDATA,PATVA012
          GOTO      STVAD999
.
STVAD013  PACK      PATVA013,QRYDATA,SP70
          GOTO      STVAD999
.
STVAD014  PACK      PATVA014,QRYDATA,SP70
          GOTO      STVAD999
.
STVAD999  RETURN
.------------------------------------------------------------
. Categories: Display,Add,Update,Delete
.------------------------------------------------------------
CATEGR00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      CATEGR40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      CATEGR10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      CATEGR20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      CATEGR30 IF EQUAL
.
          GOTO      CATEGR93
.       
CATEGR10  CALL      CHKCAT00      * Checks mandatory fields
          BRANCH    EXIT,CATEGR99
          RESET     PTCOD001
          PACK      KEY5,PTCOD001,SP70
          CALL      RDCODE1 
          COMPARE   ZERO,OVRCD
          GOTO      CATEGR92 IF EQUAL
          CALL      CATSAV00      * Moves input variables to file variables
          PACK      KEY5,PTCOD001,SP70
          CALL      WRCODE1       * Writes away the data
          MOVE      ZERO,EXIT
          GOTO      CATEGR99
.
CATEGR20  PACK      KEY5,PTCOD001,SP70   * Update Formaction
          CALL      RDCODE1 
          BRANCH    OVRCD,CATEGR91
          CALL      CHKCAT00      * Checks mandatory fields
          BRANCH    EXIT,CATEGR99
.
          MOVE      PTCDHOSS,SAVEHOSS
          CALL      CATSAV00      * Moves input variables to file variables
          MOVE      SAVEHOSS,PTCDHOSS
.
          CALL      UPCODE1       * Writes away the data
          MOVE      ZERO,EXIT
          GOTO      CATEGR99
.
CATEGR30  PACK      KEY5,PTCOD001,SP70   * Delete Formaction
          CALL      RDCODE1 
          BRANCH    OVRCD,CATEGR91
          CALL      RDSCODE1
CATEGR31  CALL      RDKCODE1
          BRANCH    OVRCD,CATEGR32
          MATCH     PTCOD001,TCODE     
          GOTO      CATEGR32 IF NOT EQUAL  
          PACK      KEY5,TCODE,ACODE
          CALL      DECODE1       * Does Cascading delete on Codes 
          GOTO      CATEGR31
.
CATEGR32  PACK      KEY5,PTCOD001,SP70   * Delete Category
          CALL      DECODE1        
.
          COMPARE   ONE,IBCNMHOS
          GOTO      CATEGR35 IF NOT EQUAL
.
          PACK      KEY8,PTCOD001,SP70
          CALL      RSMLCOD2
CATEGR33  CALL      RKMLCOD2
          BRANCH    OVRCD,CATEGR35
.
          MATCH     PTCOD001,MLCOTCOD
          GOTO      CATEGR35 IF NOT EQUAL
.
          PACK      KEY8,MLCOTCOD,MLCOACOD,MLCOHOSP,SP70
          CALL      DEMLCOD2
.
          GOTO      CATEGR33
.
CATEGR35  MOVE      ZERO,EXIT
          GOTO      CATEGR99
.
CATEGR40  PACK      KEY5,PTCOD001,SP70
          CALL      RDCODE1 
          IF        OVRCD=1
            CALL      CLRCOD00    * Clear all the file variables
          ENDIF
.
          MATCH     "1",MENUFLAG
          IF        @EQUAL
            CLEAR     WEBTITLE
            MOVE      "Category Code Enquiry",WEBTITLE
            RESET     WEBTITLE
          ELSE
            CLEAR     WEBTITLE
            MOVE      "Category Code Maintenance",WEBTITLE
            RESET     WEBTITLE
          ENDIF
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,CATEGR99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      CATEGR99
.
CATEGR91  MOVE      "Category does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CATEGR99
.
CATEGR92  MOVE      "Category record exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CATEGR99
.
CATEGR93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CATEGR99
.
CATEGR99  RETURN
.------------------------------------------------------------
. Moves cgi variables into file variables
.------------------------------------------------------------
CATSAV00  MOVE      PTCOD001,KEY2
          SQUEEZE   KEY2
          MOVE      KEY2,TCODE
          MOVE      SP70,ACODE
          MOVE      PTCOD003,TDESC
          MOVE      PTCOD004,THCSCOD
          MOVE      SP70,ACODE
          MOVE      ZERO,TCFORM6
          MOVE      SP70,TCINDC1
          MOVE      SP70,TCINDC2
          MOVE      SP70,TCINDC3
          MOVE      SP70,TCINDC4
          MOVE      SP70,TCINDC5
          MOVE      PTCOD006,PTCOACTV
          MOVE      SP70,TCINDC6
          MOVE      SP70,TCINDC7
          MOVE      PTCOD014,TCINDC8
          MOVE      SP70,TCINDC9
          MOVE      PTCOD016,TCINDC10
          MOVE      PTCOD017,TCINDC11
          MOVE      SP70,PTCDDEFT
          MOVE      SP70,PTCDHOSS
          MOVE      ZERO,PTCDCRSC
          MOVE      SP70,PTCDASC1
          MOVE      SP70,PTCDASC2
          MOVE      SP70,PTCDASC3
          MOVE      SP70,PTCDASC4
          MOVE      SP70,PTCDASC5
          MOVE      SP70,TCSPARE
          MOVE      PTCOD021,PTCDLDES
.
CATSAV99  RETURN
.------------------------------------------------------------
. * Checks mandatory fields
.------------------------------------------------------------
CHKCAT00  RESET     PTCOD001  
          MATCH     SP70,PTCOD001
          GOTO      CHKCAT90 IF EQUAL
.
          RESET     PTCOD003
          MATCH     SP70,PTCOD003
          GOTO      CHKCAT91 IF EQUAL
.
          RESET     PTCOD021
          MATCH     SP70,PTCOD021
          GOTO      CHKCAT92 IF EQUAL
.
          GOTO      CHKCAT98
.
CHKCAT90  MOVE      "Category cannot be blank!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKCAT99
.
CHKCAT91  MOVE      "Category Description is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKCAT99
.
CHKCAT92  MOVE      "Long Category Description is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKCAT99
.
CHKCAT98  MOVE      ZERO,EXIT
CHKCAT99  RETURN
.------------------------------------------------------------
. Code Records: Display,Add,Update,Delete  
.------------------------------------------------------------
CODEGR00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      CODEGR80 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      CODEGR10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      CODEGR20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      CODEGR30 IF EQUAL
.
          MATCH     "H",UPDTTYPE    * Hospital Specific formaction
          GOTO      CODEGR40 IF EQUAL
.
          MATCH     "C",UPDTTYPE    * Copy Hospital Specific formaction
          GOTO      CODEGR50 IF EQUAL
.
          MATCH     "R",UPDTTYPE    * Delete Hospital Specific formaction
          GOTO      CODEGR60 IF EQUAL
.
          MATCH     "E",UPDTTYPE    * Eclipse DVA Service Code formaction
          GOTO      CODEGR70 IF EQUAL
.
          GOTO      CODEGR93
.
CODEGR10  CALL      CHKCOD00      * Checks mandatory fields & for Blank
          BRANCH    EXIT,CODEGR99
          PACK      KEY5,PTCOD001,PTCOD002,SP70 
          CALL      RDCODE1 
          COMPARE   ZERO,OVRCD
          GOTO      CODEGR92 IF EQUAL
.
          MATCH     "AI",PTCOD001
          GOTO      CODEGR11 IF NOT EQUAL
.
          CALL      CHKAIP00      * Check if Alternate ID Prefix already exists
          BRANCH    EXIT,CODEGR95
.
CODEGR11  CALL      CLRCOD00      * Clear all the file variables
.
          CALL      CODSAV00      * Moves input variables to file variables
          PACK      KEY5,PTCOD001,PTCOD002,SP70
          CALL      WRCODE1       * Writes away the data
.
.
. write to patcfaaf for category CL only
.
          MATCH     "CL",PTCOD001
          GOTO      CODEGR15 IF NOT EQUAL
.
          PACK      KEY3,PTCOD002,SP70
          CALL      RDPTCFA1
          IF        OVRCD=1
            CALL      MVPTCF00                 * Move cgi to file
.
            CALL      WRPTCFA1
          ENDIF
.
CODEGR15  CALL      CHKCMM00      * Check Commission Account
          MOVE      ZERO,EXIT
          GOTO      CODEGR99
.
CODEGR20  CALL      CHKCOD00      * Checks mandatory fields
.
          MATCH     "AI",PTCOD001
          GOTO      CODEGR21 IF NOT EQUAL
.
          CALL      CHKAIP00      * Check if Alternate ID Prefix already exists
          BRANCH    EXIT,CODEGR95
.
CODEGR21  PACK      KEY5,PTCOD001,PTCOD002,SP70
          CALL      RDCODE1 
          BRANCH    OVRCD,CODEGR91
          BRANCH    EXIT,CODEGR99
.
          CALL      CODSAV00      * Moves input variables to file variables
          CALL      UPCODE1       * Writes away the data
.
. write to patcfaaf for category CL only
.
          MATCH     "CL",PTCOD001
          GOTO      CODEGR25 IF NOT EQUAL
.
          PACK      KEY3,PTCOD002,SP70
          CALL      RDPTCFA1
          IF        OVRCD=1
            CALL      MVPTCF00                 * Move cgi to file
.
            CALL      WRPTCFA1
            GOTO      CODEGR25
          ELSE
            MOVE      PTCFCEFR,KEY1           * Save old Contract Eff.From
            MOVE      PTCFRHCD,SAVEREAS       * Save old reason for hold inv
            PACK      DIM8,PTCFHDAT,SP70      * Save Hold Inv From date
            PACK      KEY80,PTCFRHFT,SP70     * Save old hold inv.free text
            CALL      MVPTCF00                * Move cgi to file
.
            CALL      UPPTCFA1
          ENDIF
.
          MATCH     PTCFCEFR,KEY1
          GOTO      CODEGR23 IF NOT EQUAL   * Contract Eff.From has changed
.
          MATCH     PTCFRHCD,SAVEREAS
          GOTO      CODEGR23 IF NOT EQUAL   * Reason for hold has changed
.
          MATCH     PTCFHDAT,DIM8
          GOTO      CODEGR23 IF NOT EQUAL   * Hold Inv From date hold changed
.
          MATCH     PTCFRHFT,KEY80
          GOTO      CODEGR23 IF NOT EQUAL   * Hold Inv free text changed
.
          GOTO      CODEGR25
.
CODEGR23  CALL      RUNHLD00
.
CODEGR25  CALL      CHKCMM00      * Check Commission Account
          MOVE      ZERO,EXIT
          GOTO      CODEGR99
.
CODEGR30  PACK      KEY5,PTCOD001,PTCOD002,SP70
          CALL      RDCODE1 
          BRANCH    OVRCD,CODEGR91
          CALL      DECODE1       * Writes away the data
          CALL      DELCMM00      * Delete Commission Account
.
          CALL      DHOS0000      * Delete hospital specific details
          BRANCH    EXIT,CODEGR91
.
          IF        PTCNUEDI=1
            MATCH     "A ",PTCOD001
            IF        @EQUAL
              PACK      KEY5,PTCOD001,PTCOD002,SP70
              CALL      DEPMDVA1
            ENDIF
            MATCH     "BT",PTCOD001
            IF        @EQUAL
              PACK      KEY5,PTCOD001,PTCOD002,SP70
              CALL      DEPMDVA1
            ENDIF
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      CODEGR99
.
CODEGR40  CALL      LHOS0000      * Update hospital specific details
          BRANCH    EXIT,CODEGR91
.
          MOVE      ZERO,EXIT
          GOTO      CODEGR99
.
CODEGR50  CALL      HCOP0000      * Copy hospital specific details     
          BRANCH    EXIT,CODEGR91
.
          MOVE      ZERO,EXIT
          GOTO      CODEGR99
.
CODEGR60  CALL      HDEL0000      * Delete hospital specific details
          BRANCH    EXIT,CODEGR91
.
          MOVE      ZERO,EXIT
          GOTO      CODEGR99
.
CODEGR70  MATCH     SP70,PMDVA001
          IF        @EQUAL
            PACK      KEY5,PTCOD001,PTCOD002,SP70
            CALL      DEPMDVA1
            GOTO      CODEGR75
          ENDIF
.
          PACK      KEY5,PTCOD001,PTCOD002,SP70
          CALL      RDPMDVA1
          IF        OVRCD=1
            MOVE      PTCOD001,PMDVACAT
            MOVE      PTCOD002,PMDVACOD
            MOVE      PMDVA001,PMDVSERV
            MOVE      SP70,PMDVSPAR
            CALL      WRPMDVA1
          ELSE
            MOVE      PMDVA001,PMDVSERV
            CALL      UPPMDVA1
          ENDIF
.
CODEGR75  MOVE      ZERO,EXIT
          GOTO      CODEGR99
.
CODEGR80  PACK      KEY5,PTCOD001,SP70
          CALL      RDCODE1 
          BRANCH    OVRCD,CODEGR94
.
          PACK      KEY3,PTCOD002,SP70
          CALL      RDPTCFA1
          IF        OVRCD=1
            PACK      PTCFCLAI,SP70
            PACK      PTCFNDFP,SP70
            PACK      PTCFFACD,SP70
            PACK      PTCFOCGR,SP70
            PACK      PTCFCEFR,SP70
            PACK      PTCFMCPS,SP70
            PACK      PTCFHINV,SP70
            PACK      PTCFRHCD,SP70
            PACK      PTCFRHFT,SP70
          ENDIF
.
          MOVE      TCODE,CURRCODE    * Current TCODE for Next & Prev pages 
          MOVE      TDESC,CATEDESC    * Current Category Description
.
          PACK      KEY5,PTCOD001,PTCOD002,SP70
          CALL      RDCODE1 
          IF        OVRCD=1
            CALL      CLRCOD00    * Clear all the file variables
          ENDIF
.
          MATCH     SP70,PTCOD002
          IF        @EQUAL
            CALL      CLRCOD00    * Clear all the file variables
          ENDIF
.
.         Check for Credit Card Commission
.
          MATCH     "CR",TCODE
          IF        @EQUAL
            MOVE      ACODE,KEY3
            CALL      RDPMCMM1
            IF        OVRCD=1
              UNPACK    SP70,PMCMCRCD,PMCMCACC,PMCMSPAR
            ENDIF
          ENDIF
.
          IF        PTCNUEDI=1
            MATCH     "A ",PTCOD001
            IF        @EQUAL
              PACK      KEY5,PTCOD001,PTCOD002,SP70
              CALL      RDPMDVA1
              IF        OVRCD=1
                UNPACK    SP70,PMDVACAT,PMDVACOD,PMDVSERV,PMDVSPAR
              ENDIF
            ENDIF
            MATCH     "BT",PTCOD001
            IF        @EQUAL
              PACK      KEY5,PTCOD001,PTCOD002,SP70
              CALL      RDPMDVA1
              IF        OVRCD=1
                UNPACK    SP70,PMDVACAT,PMDVACOD,PMDVSERV,PMDVSPAR
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     "1",MENUFLAG
          IF        @EQUAL
            CLEAR     WEBTITLE
            MOVE      "Code Record Enquiry",WEBTITLE
            RESET     WEBTITLE
          ELSE
            CLEAR     WEBTITLE
            MOVE      "Code Record Maintenance",WEBTITLE
            RESET     WEBTITLE
          ENDIF
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,CODEGR99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      CODEGR99
.
CODEGR91  MOVE      "Code Record does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CODEGR99
.
CODEGR92  MOVE      "Code Record exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CODEGR99
.
CODEGR93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CODEGR99
.
CODEGR94  MOVE      "Invalid Category.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CODEGR99
.
CODEGR95  MOVE      "Alternate ID Prefix combination already exists.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CODEGR99
.
CODEGR99  RETURN
+
.------------------------------------------------------------------------------
.         Check if an Alternate ID Category Code already exists for the 
.         prefix combination (Indicator 1 & 3) posted from client browser.
.------------------------------------------------------------------------------
CHKAIP00  MOVE      ZERO,EXIT
          COMPARE   SIX,PTCNHDPS
          GOTO      CHKAIP99 IF NOT EQUAL        * Not WA
.
          PACK      KEY5,Cat_AI,SP10
          CALL      RDSCODE1
CHKAIP10  CALL      RDKCODE1
          BRANCH    OVRCD,CHKAIP99
.
          MATCH     Cat_AI,TCODE
          GOTO      CHKAIP99 IF NOT EQUAL
.
          MATCH     "U",UPDTTYPE            * Update formaction
          IF        @EQUAL
            MATCH     ACODE,PTCOD002
            GOTO      CHKAIP10 IF EQUAL     * Don't check our own code
          ENDIF
.
          MATCH     PTCOD009,SP1            * Any value posted for Indicator 3?
          GOTO      CHKAIP11 IF EOS         * null
          GOTO      CHKAIP11 IF EQUAL       * space
          GOTO      CHKAIP20                * got a value; check both indicators
.
.         Just check Indicator 1 value of existing code (where Indc 3 is blank)
.
CHKAIP11  MATCH     TCINDC1,SP1
          GOTO      CHKAIP10 IF EOS         * nothing stored in Indicator 1
          GOTO      CHKAIP10 IF EQUAL       * space stored
.
          MATCH     TCINDC3,SP1             * Indicator 3 is blank/null?
          GOTO      CHKAIP12 IF EOS         * yes; check indicator 1
          GOTO      CHKAIP12 IF EQUAL       * yes; check indicator 1
          GOTO      CHKAIP10                * no; skip check of this code
.
CHKAIP12  MATCH     TCINDC1,PTCOD007
          GOTO      CHKAIP10 IF NOT EQUAL
          GOTO      CHKAIP91                * Duplicate Indicator 1 found!
.
.         Check both Indicator 1 & 3 combination of existing code
.
CHKAIP20  MATCH     TCINDC1,PTCOD007        * Check Indicator 1 value
          GOTO      CHKAIP21 IF EQUAL       * same; so check indc 3 value
          GOTO      CHKAIP10 IF EOS         * nothing stored; read next code
          GOTO      CHKAIP10                * not same indc 1 value; Get next
.
CHKAIP21  MATCH     TCINDC3,SP1
          GOTO      CHKAIP10 IF EOS
          GOTO      CHKAIP10 IF EQUAL
.
          MATCH     TCINDC3,PTCOD009        * Check Indicator 3 value
          GOTO      CHKAIP91 IF EQUAL       * Duplicate combination found!
.
          GOTO      CHKAIP10                * Get next code
.
CHKAIP91  MOVE      ONE,EXIT
CHKAIP99  RETURN
+
.-----------------------------------------------------------
. Check if need to update/write Commission details file
.-----------------------------------------------------------
CHKCMM00  MATCH     "CR",TCODE
          GOTO      CHKCMM99 IF NOT EQUAL    * Not a credit card
.
          MATCH     "C",TCINDC1
          GOTO      CHKCMM20 IF NOT EQUAL    * Shouldn't have commission det.
.
          MATCH     Z70,PMCMM001
          GOTO      CHKCMM99 IF EQUAL        * Blank commission details
.
          MOVE      ACODE,KEY3
          CALL      RDPMCMM1
          IF        OVRCD=0
            MOVE      PMCMM001,PMCMCACC      * Commission Account
            CALL      UPPMCMM1
          ELSE
            MOVE      ACODE,PMCMCRCD         * Credit card code
            MOVE      PMCMM001,PMCMCACC      * Commission Account
            MOVE      SP70,PMCMSPAR
            CALL      WRPMCMM1
          ENDIF
          GOTO      CHKCMM99
.
CHKCMM20  CALL      DELCMM00                 * Delete it
CHKCMM99  RETURN
+
.-----------------------------------------------------------
. Delete Commission details file
.-----------------------------------------------------------
DELCMM00  MATCH     "CR",TCODE
          GOTO      DELCMM99 IF NOT EQUAL    * Not a credit card
.
          MOVE      ACODE,KEY3
          CALL      RDPMCMM1
          BRANCH    OVRCD,DELCMM99
          CALL      DEPMCMM1
DELCMM99  RETURN
+
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRCOD00  MOVE      SP70,TCODE     
          MOVE      SP70,ACODE    
          MOVE      SP70,TDESC   
          MOVE      SP70,THCSCOD 
          MOVE      ZERO,TCFORM6  
          MOVE      SP70,TCINDC1  
          MOVE      SP70,TCINDC2  
          MOVE      SP70,TCINDC3  
          MOVE      SP70,TCINDC4  
          MOVE      SP70,TCINDC5  
          MOVE      SP70,PTCOACTV 
          MOVE      SP70,TCINDC6  
          MOVE      SP70,TCINDC7  
          MOVE      SP70,TCINDC8  
          MOVE      SP70,TCINDC9  
          MOVE      SP70,TCINDC10 
          MOVE      SP70,TCINDC11 
          MOVE      SP70,PTCDDEFT 
          MOVE      SP70,PTCDGRPV
          MOVE      SP70,PTCDHOSS
          MOVE      SP70,PTCDDFIC
          MOVE      SP70,TCSPARE
          MOVE      SP70,TCINDC12
          MOVE      SP70,TCINDC13
          MOVE      SP70,TCINDC14
          MOVE      SP70,TCINDC15
          MOVE      SP70,TCINDC16
          MOVE      SP70,TCINDC17
          MOVE      SP70,TCINDC18
          MOVE      SP70,TCINDC19
          MOVE      SP70,TCINDC20
          MOVE      SP70,TCINDC21
          MOVE      SP70,TCINDC22
          MOVE      SP70,TCINDC23
          MOVE      SP70,TCINDC24
          MOVE      SP70,TCINDC25
          MOVE      SP70,TCINDC26
          MOVE      SP70,TCINDC27
          MOVE      SP70,TCINDC28
          MOVE      SP70,TCINDC29
          MOVE      SP70,TCINDC30
          MOVE      SP70,TCINDC31
          MOVE      SP70,TCINDC32
          MOVE      SP70,TCINDC33
          MOVE      SP70,TCINDC34
          MOVE      SP70,TCINDC35
          MOVE      SP70,TCINDC36
          MOVE      SP70,TCINDC37
          MOVE      SP70,TCINDC38
          MOVE      SP70,TCINDC39
          MOVE      SP70,TCINDC40
          MOVE      SP70,TCINDC41
.
          MOVE      SP70,PTCDFELC
          MOVE      SP70,PTCDUDF2
          MOVE      SP70,PTCDUDF3
          MOVE      SP70,PTCDUDF4
          MOVE      SP70,PTCDUDF5
          MOVE      SP70,PTCDUDF6
          MOVE      SP70,PTCDUDF7
          MOVE      SP70,PTCDUDF8
          MOVE      SP70,PTCDUDF9
          MOVE      SP70,PTCDUD10
          MOVE      SP70,PTCDUD11
          MOVE      SP70,PTCDUD12
          MOVE      SP70,PTCDUD13
          MOVE      SP70,PTCDUD14
.
          MOVE      ZERO,PTCDCRSC
          MOVE      SP70,PTCDASC1
          MOVE      SP70,PTCDASC2
          MOVE      SP70,PTCDASC3
          MOVE      SP70,PTCDASC4
          MOVE      SP70,PTCDASC5
          MOVE      SP70,PTCDASC6
          MOVE      SP70,PTCDASC7
          MOVE      SP70,PTCDASC8
          MOVE      SP70,PTCDASC9
          MOVE      SP70,PTCDAS10
          MOVE      SP70,PTCDAS11
          MOVE      SP70,PTCDAS12
          MOVE      SP70,PTCDAS13
          MOVE      SP70,PTCDAS14
          MOVE      SP70,PTCDAS15
.
CLRCOD99  RETURN
+
.------------------------------------------------------------
. Moves cgi variables into file variables
.------------------------------------------------------------
CODSAV00  MOVE      PTCOD001,KEY2
          SQUEEZE   KEY2
          MOVE      KEY2,TCODE
          MOVE      PTCOD002,ACODE
          MOVE      PTCOD003,TDESC
          MOVE      PTCOD004,THCSCOD
          MOVE      PTCOD005,TCFORM6
.
          MATCH     "A",PTCOD006
          IF        @EQUAL
            MOVE      "A",PTCOACTV
          ELSE
            MOVE      "I",PTCOACTV
          ENDIF
.
          MOVE      PTCOD007,TCINDC1
          MOVE      PTCOD008,TCINDC2
          MOVE      PTCOD009,TCINDC3
          MOVE      PTCOD010,TCINDC4
          MOVE      PTCOD011,TCINDC5
          MOVE      PTCOD012,TCINDC6
          MOVE      PTCOD013,TCINDC7
          MOVE      PTCOD014,TCINDC8
          MOVE      PTCOD015,TCINDC9
          MOVE      PTCOD016,TCINDC10
          MOVE      PTCOD017,TCINDC11
.
          MATCH     Z70,PTCOD018
          IF        !@EQUAL
            MOVE      PTCOD018,PTCDDEFT
          ELSE
            MOVE      ZERO,PTCDDEFT
          ENDIF
.
          MOVE      PTCOD019,PTCDNHCP
          MOVE      PTCOD020,PTCDGRPV
          MOVE      PTCOD021,PTCDLDES
          MOVE      PTCOD022,PTCDDFIC
          MOVE      PTCOD023,TCINDC12
          MOVE      PTCOD024,TCINDC13
          MOVE      PTCOD025,TCINDC14
          MOVE      PTCOD026,TCINDC15
          MOVE      PTCOD027,TCINDC16
          MOVE      PTCOD028,TCINDC17
          MOVE      PTCOD029,TCINDC18
          MOVE      PTCOD030,TCINDC19
          MOVE      PTCOD031,TCINDC20
          MOVE      PTCOD032,TCINDC21
          MOVE      PTCOD033,PTCDFELC
          MOVE      PTCOD034,PTCDUDF2
          MOVE      PTCOD035,PTCDCRSC
          MOVE      PTCOD036,PTCDASC1
          MOVE      PTCOD037,PTCDASC2
          MOVE      PTCOD038,PTCDASC3
          MOVE      PTCOD039,PTCDASC4
          MOVE      PTCOD040,PTCDASC5
          MOVE      PTCOD041,PTCDUDF3
          MOVE      PTCOD042,PTCDUDF4
          MOVE      PTCOD043,TCINDC22
          MOVE      PTCOD044,TCINDC23
          MOVE      PTCOD045,TCINDC24
          MOVE      PTCOD046,TCINDC25
          MOVE      PTCOD047,TCINDC26
          MOVE      PTCOD048,TCINDC27
          MOVE      PTCOD049,TCINDC28
          MOVE      PTCOD050,TCINDC29
          MOVE      PTCOD051,TCINDC30
          MOVE      PTCOD052,TCINDC31
          MOVE      PTCOD053,TCINDC32
          MOVE      PTCOD054,TCINDC33
          MOVE      PTCOD055,TCINDC34
          MOVE      PTCOD056,TCINDC35
          MOVE      PTCOD057,TCINDC36
          MOVE      PTCOD058,TCINDC37
          MOVE      PTCOD059,TCINDC38
          MOVE      PTCOD060,TCINDC39
          MOVE      PTCOD061,TCINDC40
          MOVE      PTCOD062,TCINDC41
          MOVE      PTCOD063,PTCDUDF5
          MOVE      PTCOD064,PTCDUDF6
          MOVE      PTCOD065,PTCDUDF7
          MOVE      PTCOD066,PTCDUDF8
          MOVE      PTCOD067,PTCDUDF9
          MOVE      PTCOD068,PTCDUD10
          MOVE      PTCOD069,PTCDUD11
          MOVE      PTCOD070,PTCDUD12
          MOVE      PTCOD071,PTCDUD13
          MOVE      PTCOD072,PTCDUD14
          MOVE      PTCOD073,PTCDASC6
          MOVE      PTCOD074,PTCDASC7
          MOVE      PTCOD075,PTCDASC8
          MOVE      PTCOD076,PTCDASC9
          MOVE      PTCOD077,PTCDAS10
          MOVE      PTCOD078,PTCDAS11
          MOVE      PTCOD079,PTCDAS12
          MOVE      PTCOD080,PTCDAS13
          MOVE      PTCOD081,PTCDAS14
          MOVE      PTCOD082,PTCDAS15
.
          MOVE      SP70,TCSPARE
.
CODSAV99  RETURN
.------------------------------------------------------------
. * Checks mandatory fields
.------------------------------------------------------------
CHKCOD00  RESET     PTCOD002
          MATCH     SP70,PTCOD002  
          GOTO      CHKCOD90 IF EQUAL 
.
          RESET     PTCOD003
          MATCH     SP70,PTCOD003
          GOTO      CHKCOD91 IF EQUAL
.
          RESET     PTCOD021
          MATCH     SP70,PTCOD021
          GOTO      CHKCOD92 IF EQUAL
.
          MATCH     "Py",PTCOD001
          GOTO      CHKCOD98 IF NOT EQUAL
.
.         Check if there is an existing record with same HCP Equiv.
.
          PACK      KEY5,PTCOD001,SP70
          CALL      RDSCODE1
CHKCOD10  CALL      RDKCODE1
          BRANCH    OVRCD,CHKCOD98
.
          MATCH     PTCOD001,TCODE
          GOTO      CHKCOD98 IF NOT EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          IF        @EQUAL
            MATCH     PTCOD002,ACODE
            GOTO      CHKCOD10 IF EQUAL
          ENDIF
.
          MATCH     "A",PTCOACTV            * ACTIVE INDICATOR, A = Active
          GOTO      CHKCOD10 IF NOT EQUAL
.
          SQUEEZE   PTCOD019
          MOVE      PTCOD019,FORM2
          SQUEEZE   PTCDNHCP
          MOVE      PTCDNHCP,F2
          COMPARE   FORM2,F2
          GOTO      CHKCOD10 IF NOT EQUAL
.
          GOTO      CHKCOD93
.
CHKCOD90  MOVE      "Code cannot be blank!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKCOD99
.
CHKCOD91  MOVE      "Code Description is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKCOD99
.
CHKCOD92  MOVE      "Long Code Description is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKCOD99
.
CHKCOD93  MOVE      "Code with same HCP Equivalent already exists !",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKCOD99
.
CHKCOD98  MOVE      ZERO,EXIT
CHKCOD99  RETURN
.------------------------------------------------------------
. Lookup ID: Display,Add,Update,Delete  
.------------------------------------------------------------
LKIDGR00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      LKIDGR40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      LKIDGR10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      LKIDGR20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      LKIDGR30 IF EQUAL
.
          GOTO      LKIDGR93
.
LKIDGR10  CALL      CHKLID00    * Checks mandatory fields and for blanks 
          BRANCH    EXIT,LKIDGR99  
          PACK      KEY8,WBLID001,SP70    * ADD FORMACTION 
          CALL      RDWBLI1 
          COMPARE   ZERO,OVRCD
          GOTO      LKIDGR92 IF EQUAL
          CALL      LIDSAV00      * Moves input variables to file variables
          PACK      KEY8,WBLID001,SP70
          CALL      WRWBLI1       * Writes away the data
          CALL      LIDSET00      * Sets an initial default Index Page record 
          PACK      KEY11,KEY8,PGNUM,SP70  * Packed with ID & "000"
          CALL      RAWBLP1       * Writes index page record...
          IF        OVRCD=1
            CALL      WRWBLP1       * Writes index page record...
          ENDIF
          MOVE      ZERO,EXIT
          GOTO      LKIDGR99
.
LKIDGR20  PACK      KEY8,WBLID001,SP70    * UPDATE FORMACTION
          CALL      RDWBLI1 
          BRANCH    OVRCD,LKIDGR91
          CALL      CHKLID00      * Checks mandatory fields
          BRANCH    EXIT,LKIDGR99
          CALL      RLWBLI1       * Readlock file record
          BRANCH    OVRCD,LKIDGR91
          CALL      LIDSAV00      * Moves input variables to file variables
          CALL      UPWBLI1       * Writes away the data
          CALL      UUWBLI1       * Unlock file record 
          MOVE      ZERO,EXIT
          GOTO      LKIDGR99
.
LKIDGR30  PACK      KEY8,WBLID001,SP70    * DELETE FORMACTION
          CALL      RDWBLI1 
          BRANCH    OVRCD,LKIDGR91
          CALL      DEWBLI1       * Deletes the data
.          **********  Drill down 2 levels delete all lookup Pages & details 
          PACK      KEY11,KEY8,SP70 
          CALL      DELALL00   * Deletes pages and detail lines
          MOVE      ZERO,EXIT     
          GOTO      LKIDGR99
.
LKIDGR40  PACK      KEY8,WBLID001,SP70
          CALL      RDWBLI1 
          IF        OVRCD=1
            CALL      CLRLID00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Lookup ID Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,LKIDGR99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      LKIDGR99
.
LKIDGR91  MOVE      "Lookup ID does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      LKIDGR99
.
LKIDGR92  MOVE      "Lookup ID exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      LKIDGR99
.
LKIDGR93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      LKIDGR99
.
LKIDGR99  RETURN
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRLID00  MOVE      SP70,WBLILKID
          MOVE      SP70,WBLIDESC
          MOVE      SP70,WBLISPAR      
.
          MOVE      SP70,WBLPLKID  
          MOVE      SP70,WBLPPGNO  
          MOVE      SP70,WBLPTITL  
          MOVE      SP70,WBLPHEAD  
          MOVE      SP70,WBLPCLOR  
          MOVE      SP70,WBLPSCOD  
          MOVE      SP70,WBLPPSEQ  
          MOVE      SP70,WBLPSPAR  
.
CLRLID99  RETURN
.------------------------------------------------------------
. Moves cgi variables into file variables
.------------------------------------------------------------
LIDSAV00  MOVE      WBLID001,KEY8
          SQUEEZE   KEY8
          MOVE      KEY8,WBLILKID
          MOVE      WBLID002,WBLIDESC
          MOVE      SP70,WBLISPAR
.
LIDSAV99  RETURN
.------------------------------------------------------------
. Sets an initial Index Page record 
.------------------------------------------------------------
LIDSET00  MOVE      WBLID001,KEY8
          SQUEEZE   KEY8
          MOVE      KEY8,WBLPLKID
          MOVE      PGNUM,WBLPPGNO  
          MOVE      WBLID002,WBLPTITL  
          PACK      WBLPHEAD,WBLID002,INDEX  
          MOVE      SP70,WBLPCLOR  
          MOVE      "0",WBLPSCOD  
          MOVE      "0",WBLPPSEQ  
          MOVE      SP70,WBLPSPAR  
.
LIDSET99  RETURN
.------------------------------------------------------------
. * Checks mandatory fields, Checks Lookup ID:cannot be blank     
.------------------------------------------------------------
CHKLID00  RESET     WBLID001            * Lookup ID cannot be blank
          MATCH     SP70,WBLID001 
          GOTO      CHKLID90 IF EQUAL 
. 
          RESET     WBLID002
          MATCH     SP70,WBLID002
          GOTO      CHKLID91 IF EQUAL
          GOTO      CHKLID98
.
CHKLID90  MOVE      "Lookup ID cannot be blank.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKLID99
.
CHKLID91  MOVE      "Lookup ID description is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKLID99
.
CHKLID98  MOVE      ZERO,EXIT
CHKLID99  RETURN
.--------------------------------------------------------------
. Deletes cascading Pages and Detail Lines
.--------------------------------------------------------------
DELALL00  CALL      RSWBLP1
DELALL10  CALL      RKWBLP1
          BRANCH    OVRCD,DELALL99 
          MATCH     KEY8,WBLPLKID
          GOTO      DELALL99 IF NOT EQUAL
          MOVE      WBLPLKID,KEY8
          MOVE      WBLPPGNO,KEY3
          PACK      KEY14,KEY8,KEY3,SP70 
          CALL      DLEVL000 * Delete all detail lines for Page No. 
          PACK      KEY11,KEY8,KEY3,SP70  
          CALL      DEWBLP1  * Delete Unique ID & Page No. 
          GOTO      DELALL10
.
DELALL99  RETURN 
.------------------------------------------------------------
. Lookup Pages: Display,Add,Update,Delete  
.------------------------------------------------------------
LKPAGR00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      LKPAGR40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      LKPAGR10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      LKPAGR20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      LKPAGR30 IF EQUAL
.
          GOTO      LKPAGR93
.
LKPAGR10  CALL      CHKPAG00  * Checks mandatory fields & checks for blank
          BRANCH    EXIT,LKPAGR99
          PACK      KEY11,WBLID001,WBPAG001,SP70    * ADD FORMACTION 
          CALL      RDWBLP1 
          COMPARE   ZERO,OVRCD
          GOTO      LKPAGR92 IF EQUAL
          CALL      PAGSAV00      * Moves input variables to file variables
          PACK      KEY11,WBLID001,WBPAG001,SP70
          CALL      WRWBLP1       * Writes away the data
          MOVE      ZERO,EXIT
          GOTO      LKPAGR99
.
LKPAGR20  PACK      KEY11,WBLID001,WBPAG001,SP70    * UPDATE FORMACTION
          CALL      RDWBLP1 
          BRANCH    OVRCD,LKPAGR91
          CALL      CHKPAG00      * Checks mandatory fields
          BRANCH    EXIT,LKPAGR99
          CALL      RLWBLP1       * Readlock file record
          BRANCH    OVRCD,LKPAGR91
          CALL      PAGSAV00      * Moves input variables to file variables
          CALL      UPWBLP1       * Writes away the data
          CALL      UUWBLP1       * Unlock file record 
          MOVE      ZERO,EXIT
          GOTO      LKPAGR99
.
LKPAGR30  PACK      KEY11,WBLID001,WBPAG001,SP70    * DELETE FORMACTION
          CALL      RDWBLP1 
          BRANCH    OVRCD,LKPAGR91
          CALL      DEWBLP1       * Deletes the data
.          **********  Drill down a level delete all lookup details 
          MOVE      WBLID001,KEY8
          MOVE      WBPAG001,KEY3 
          PACK      KEY14,KEY8,KEY3,SP70
          CALL      DLEVL000
          MOVE      ZERO,EXIT     
          GOTO      LKPAGR99
.
LKPAGR40  PACK      KEY8,WBLID001,SP70
          CALL      RDWBLI1 
          BRANCH    OVRCD,LKPAGR94
          MOVE      WBLILKID,LOOKID
          MOVE      WBLIDESC,IDDESC
.
          PACK      KEY11,WBLID001,WBPAG001,SP70
          CALL      RDWBLP1 
          IF        OVRCD=1
            CALL      CLRPAG00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Lookup Page Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,LKPAGR99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      LKPAGR99
.
LKPAGR91  MOVE      "Lookup Page does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      LKPAGR99
.
LKPAGR92  MOVE      "Lookup Page exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      LKPAGR99
.
LKPAGR93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      LKPAGR99
.
LKPAGR94  MOVE      "Invalid Lookup ID.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      LKPAGR99
.
LKPAGR99  RETURN
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRPAG00  MOVE      SP70,WBLPLKID  
          MOVE      SP70,WBLPPGNO  
          MOVE      SP70,WBLPTITL  
          MOVE      SP70,WBLPHEAD  
          MOVE      SP70,WBLPCLOR  
          MOVE      SP70,WBLPSCOD  
          MOVE      SP70,WBLPPSEQ  
          MOVE      SP70,WBLPSPAR  
.
CLRPAG99  RETURN
.------------------------------------------------------------
. Moves cgi variables into file variables
.------------------------------------------------------------
PAGSAV00  MOVE      WBLID001,KEY8
          SQUEEZE   KEY8
          MOVE      KEY8,WBLPLKID
          MOVE      WBPAG001,KEY3
          SQUEEZE   KEY3
          MOVE      KEY3,WBLPPGNO
          MOVE      WBPAG002,WBLPTITL  
          MOVE      WBPAG003,WBLPHEAD  
. 
          MOVE      WBPAG004,WBLPCLOR  
.
          MATCH     SP70,WBPAG005
          IF        @EQUAL
            MOVE      "0",WBLPSCOD
          ELSE
            MOVE      WBPAG005,WBLPSCOD  
          ENDIF
.
          MOVE      WBPAG006,WBLPPSEQ  
          MOVE      SP70,WBLPSPAR  
.
PAGSAV99  RETURN
.------------------------------------------------------------------
. * Checks Lookup Page:cannot be blank. And checks mandatory fields    
.------------------------------------------------------------------
CHKPAG00  RESET     WBPAG001
          MATCH     SP70,WBPAG001     * Check if Page No. is blank?
          GOTO      CHKPAG90 IF EQUAL 
.
          RESET     WBPAG002
          MATCH     SP70,WBPAG002
          GOTO      CHKPAG91 IF EQUAL
          GOTO      CHKPAG98
.
CHKPAG90  MOVE      "Page No. Cannot be blank!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKPAG99
.
CHKPAG91  MOVE      "Lookup Page Title is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKPAG99
.
CHKPAG98  MOVE      ZERO,EXIT
CHKPAG99  RETURN
.------------------------------------------------------------
. Deletes all Detail Lines for deleted page
.------------------------------------------------------------
DLEVL000  CALL      RSWBLD1
DLEVL100  CALL      RKWBLD1
          BRANCH    OVRCD,DLEVL999
          MATCH     KEY8,WBLDLKID 
          GOTO      DLEVL999 IF NOT EQUAL
          MATCH     KEY3,WBLDPAGE 
          GOTO      DLEVL999 IF NOT EQUAL
          PACK      KEY14,WBLDLKID,WBLDPAGE,WBLDUQID,SP70 
          CALL      DEWBLD1
          GOTO      DLEVL100
.
DLEVL999  RETURN
.------------------------------------------------------------
. Lookup Details: Display,Add,Update,Delete  
.------------------------------------------------------------
LKDETR00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      LKDETR40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      LKDETR10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      LKDETR20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      LKDETR30 IF EQUAL
.
          GOTO      LKDETR93
.
LKDETR10  CALL      CHKDET00  * Checks mandatory fields & checks for blank
          BRANCH    EXIT,LKDETR99
          CALL      DETINC00  * increments Unique ID 
          PACK      KEY14,WBLID001,WBPAG001,WBLDT001,SP70  * ADD FORMACTION 
          CALL      RDWBLD1 
          COMPARE   ZERO,OVRCD
          GOTO      LKDETR92 IF EQUAL
          CALL      DETSAV00      * Moves input variables to file variables
          CALL      WRWBLD1       * Writes away the data
          MOVE      ZERO,EXIT
          GOTO      LKDETR99
.
LKDETR20  PACK      KEY14,WBLID001,WBPAG001,WBLDT001,SP70  * UPDATE FORMACTION
          CALL      RDWBLD1 
          BRANCH    OVRCD,LKDETR91
          CALL      CHKDET00      * Checks mandatory fields
          BRANCH    EXIT,LKDETR99
          CALL      RLWBLD1       * Readlock file record
          BRANCH    OVRCD,LKDETR91
          CALL      DETSAV00      * Moves input variables to file variables
          CALL      UPWBLD1       * Writes away the data
          CALL      UUWBLD1       * Unlock file record 
          MOVE      ZERO,EXIT
          GOTO      LKDETR99
.
LKDETR30  PACK      KEY14,WBLID001,WBPAG001,WBLDT001,SP70   * DELETE FORMACTION
          CALL      RDWBLD1 
          BRANCH    OVRCD,LKDETR91
          CALL      DEWBLD1       * Deletes the data
          MOVE      ZERO,EXIT     
          GOTO      LKDETR99
.
LKDETR40  PACK      KEY11,WBLID001,WBPAG001,SP70
          CALL      RDWBLP1 
          BRANCH    OVRCD,LKDETR94
          MOVE      WBLPLKID,LOOKID
          MOVE      WBLPPGNO,PAGENO
          MOVE      WBLPHEAD,PAGEHEAD
.
          PACK      KEY14,WBLID001,WBPAG001,WBLDT001,SP70
          CALL      RDWBLD1 
          IF        OVRCD=1
            CALL      CLRDET00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Lookup Detail Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,LKDETR99

          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      LKDETR99
.
LKDETR91  MOVE      "Lookup Detail does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      LKDETR99
.
LKDETR92  MOVE      "Lookup Detail exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      LKDETR99
.
LKDETR93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      LKDETR99
.
LKDETR94  MOVE      "Invalid Page.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      LKDETR99
.
LKDETR99  RETURN
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRDET00  MOVE      SP70,WBLDLKID  
          MOVE      SP70,WBLDPAGE  
          MOVE      SP70,WBLDUQID  
          MOVE      SP70,WBLDCODE  
          MOVE      SP70,WBLDDESC  
          MOVE      SP70,WBLDTYPE  
          MOVE      SP70,WBLDLKPG  
          MOVE      SP70,WBLDACTV  
          MOVE      SP70,WBLDSPAR  
.
CLRDET99  RETURN
.------------------------------------------------------------
. Increments Unique ID for Add formaction..
.------------------------------------------------------------
DETINC00  MOVE      ZERO,UNIQUEID 
.
          PACK      KEY14,WBLID001,WBPAG001,Z70  * ADD FORMACTION 
          CALL      RSWBLD1
          CALL      RPWBLD1
          BRANCH    OVRCD,DETINC10     * If OVRCD then no records exist
          MATCH     WBLID001,WBLDLKID 
          GOTO      DETINC10 IF NOT EQUAL
          MATCH     WBPAG001,WBLDPAGE 
          GOTO      DETINC10 IF NOT EQUAL
          MOVE      WBLDUQID,UNIQUEID
.
DETINC10  ADD       ONE,UNIQUEID
          MOVE      UNIQUEID,WBLDT001
          GOTO      DETINC99
.
DETINC99  RETURN
.------------------------------------------------------------
. Moves cgi variables into file variables
.------------------------------------------------------------
DETSAV00  MOVE      WBLID001,KEY8
          SQUEEZE   KEY8
          MOVE      KEY8,WBLDLKID
          MOVE      WBPAG001,KEY3
          SQUEEZE   KEY3
          MOVE      KEY3,WBLDPAGE
          
          MOVE      WBLDT001,WBLDUQID 
          REP       " 0",WBLDUQID
          MOVE      WBLDT002,WBLDCODE  
          MOVE      WBLDT003,WBLDDESC  
          MOVE      WBLDT004,WBLDTYPE  
          MATCH     "0",WBLDTYPE  
          IF        @EQUAL   
            MOVE      WBLDT005,WBLDLKPG  
            CALL      SAVPAG00  * If Look Page does not exist save it. 
          ELSE
            MOVE      SP70,WBLDLKPG
          ENDIF
.
          MATCH     SP70,WBLDT006
          IF        @EQUAL
            MOVE      "0",WBLDACTV
          ELSE
            MOVE      WBLDT006,WBLDACTV  
          ENDIF
          MOVE      SP70,WBLDSPAR  
.
DETSAV99  RETURN
.------------------------------------------------------------------
. If Look Page does not exist it is created. 
.------------------------------------------------------------------
SAVPAG00  PACK      KEY11,WBLID001,WBLDLKPG,SP70    * ADD FORMACTION
          CALL      RDWBLP1
          IF        OVRCD=0
            GOTO      SAVPAG99   * Record found no need to create it.          
          ENDIF 
          CALL      CLRPAG00
.
          MOVE      WBLID001,KEY8
          SQUEEZE   KEY8
          MOVE      KEY8,WBLPLKID
          MOVE      WBLDLKPG,KEY3
          SQUEEZE   KEY3
          MOVE      KEY3,WBLPPGNO
          MOVE      WBLDDESC,WBLPTITL
          MOVE      WBLDDESC,WBLPHEAD
. 
          MOVE      WBPAG004,WBLPCLOR
.
          MOVE      "1",WBLPSCOD
.
          MOVE      "0",WBLPPSEQ
          MOVE      SP70,WBLPSPAR
.
          CALL      WRWBLP1       * Writes away the data
.
SAVPAG99  RETURN
.------------------------------------------------------------------
. * Checks Lookup Details:cannot be blank. And checks mandatory fields    
.------------------------------------------------------------------
CHKDET00  RESET     WBLDT003
          MATCH     SP70,WBLDT003
          GOTO      CHKDET90 IF EQUAL
.
          RESET     WBLDT004
          RESET     WBLDT005 
          MATCH     "0",WBLDT004
          IF        @EQUAL
            MATCH     SP70,WBLDT005
            GOTO      CHKDET91 IF EQUAL  
          ENDIF
.
          GOTO      CHKDET98
.
CHKDET90  MOVE      "Detail description is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKDET99
.
CHKDET91  MOVE      "If Type=Link then Link Page cannot be blank!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKDET99
.
CHKDET98  MOVE      ZERO,EXIT
CHKDET99  RETURN
.-------------------------------------------------------------
. Generate Lookup HTML
.------------------------------------------------------------
LKHTML00  MATCH     LIDSTRCD,LIDENDCD
          GOTO      LKHTML10 IF NOT LESS
          MOVE      "Invalid Lookup ID",WEBTITLE
          CALL      WEBERR00
          GOTO      LKHTML99
.
LKHTML10  MOVE      "GENWEB01",SCHDPROG
          MOVE      "Generate Lookup HTML",SCHDNAME
          MOVE      "2",SCHDTYPE
.
          CALL      NEWRSH00                 * 
.
.  Write Parameters for Lookup HTML 
.
          WRITE     PARAFILE,SEQ;"reportno=1"
          WRITE     PARAFILE,SEQ;"lidstrcd=",LIDSTRCD
          WRITE     PARAFILE,SEQ;"lidendcd=",LIDENDCD
.
          CLOSE     PARAFILE
.
          CALL      UUWBRS1                  * Unlock Record
.
          MOVE      "Lookup HTML Generation Scheduled",WEBTITLE
          CALL      WEBERR00
.
LKHTML99  RETURN
.-------------------------------------------------------------
. Generate Lookup HTML for Categories
.------------------------------------------------------------
CTHTML00  MATCH     CATSTRCD,CATENDCD
          GOTO      CTHTML10 IF NOT LESS
          MOVE      "Invalid Category Range",WEBTITLE
          CALL      WEBERR00
          GOTO      CTHTML99
.
CTHTML10  MOVE      "GENWEB01",SCHDPROG
          MOVE      "Generate Category Lookup HTML",SCHDNAME
          MOVE      "2",SCHDTYPE
.
          CALL      NEWRSH00                 * 
.
.  Write Parameters for Lookup HTML 
.
          WRITE     PARAFILE,SEQ;"reportno=2"
          WRITE     PARAFILE,SEQ;"catstrcd=",CATSTRCD
          WRITE     PARAFILE,SEQ;"catendcd=",CATENDCD
.
          CLOSE     PARAFILE
.
          CALL      UUWBRS1                  * Unlock Record
.
          MOVE      "Category HTML Generation Scheduled",WEBTITLE
          CALL      WEBERR00
.
CTHTML99  RETURN
.------------------------------------------------------------
. Transfer Codes: Display,Add,Update,Delete  
.------------------------------------------------------------
PATVAD00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      PATVAD40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      PATVAD10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      PATVAD20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      PATVAD30 IF EQUAL
.
          GOTO      PATVAD93
.
.         ************ ADD FORMACTION ***********
.
PATVAD10  CALL      CHKVAD00  * Checks mandatory fields & checks for blank
          BRANCH    EXIT,PATVAD99
.
          PACK      KEY5,PATVA001,SP70   
          CALL      RDPTVAD1
          COMPARE   ZERO,OVRCD
          GOTO      PATVAD92 IF EQUAL
.
          PACK      PTVACDAT,CCC,CYY,CMM,CDD
          REP       " 0",PTVACDAT 
          CLOCK     TIME,PTVACTIM
          MOVE      WBSEUID,PTVACUID
          MOVE      SP70,PTVAUDAT
          MOVE      SP70,PTVAUTIM
          MOVE      SP70,PTVAUUID
.
          CALL      VADSAV00      * Moves input variables to file variables
          PACK      KEY5,PATVA001,SP70
          CALL      WRPTVAD1      * Writes away the data
.
          MOVE      "A",KEY1      * Set Add Parameter for VADAUD00
          CALL      VADAUD00      * Write Audit File if Needed
.
          PROC      PMSVKIUP      * Update keyword index
.
          MOVE      ZERO,EXIT
          GOTO      PATVAD99
.
.         ************ UPDATE FORMACTION **********
.
PATVAD20  PACK      KEY5,PATVA001,SP70  
          CALL      RDPTVAD1
          BRANCH    OVRCD,PATVAD91
.
          CALL      CHKVAD00      * Checks mandatory fields
          BRANCH    EXIT,PATVAD99
.
          CALL      RLPTVAD1      * Readlock file record
          BRANCH    OVRCD,PATVAD91
.
          MOVE      "B",KEY1      * Set Before Changes Parameter for VADAUD00
          CALL      VADAUD00      * Write Audit File if Needed
.
          PACK      PTVAUDAT,CCC,CYY,CMM,CDD
          REP       " 0",PTVAUDAT 
          CLOCK     TIME,PTVAUTIM
          MOVE      WBSEUID,PTVAUUID
          MOVE      SP70,PTVACDAT
          MOVE      SP70,PTVACTIM
          MOVE      SP70,PTVACUID
.
          PACK      KEY5,PATVA001,SP70    
          CALL      VADSAV00      * Moves input variables to file variables
          CALL      UPPTVAD1      * Writes away the data
          CALL      ULPTVAD1      * Unlock file record 
.
          MOVE      "C",KEY1      * Set After Changes Parameter for VADAUD00
          CALL      VADAUD00      * Write Audit File if Needed
.
          PROC      PMSVKIUP      * Update keyword index
.
          MOVE      ZERO,EXIT
          GOTO      PATVAD99
.
.         ************ DELETE FORMACTION **********
.
PATVAD30  PACK      KEY5,PATVA001,SP70    
          CALL      RDPTVAD1
          BRANCH    OVRCD,PATVAD91
          CALL      DEPTVAD1      * Deletes the data
.
          MOVE      "D",KEY1      * Set Delete Parameter for VADAUD00
          CALL      VADAUD00      * Write Audit File if Needed
.
          PROC      PMSVKIUP      * Update keyword index
.
          MOVE      ZERO,EXIT     
          GOTO      PATVAD99
.
.         ************ DISPLAY FORMACTION **********
.
PATVAD40  PACK      KEY5,PATVA001,SP70
          CALL      RDPTVAD1
          IF        OVRCD=1
            CALL      CLRVAD00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Transfer Source Code Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,PATVAD99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      PATVAD99
.
PATVAD91  MOVE      "Transfer Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATVAD99
.
PATVAD92  MOVE      "Transfer Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATVAD99
.
PATVAD93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      PATVAD99
.
PATVAD99  RETURN
.-----------------------------------------------------------
. Initialize's file data
.-----------------------------------------------------------
CLRVAD00  MOVE      SP70,PTVACODE     * Transfer Destination Code
          MOVE      SP70,PTVADESC     * Destination Description 
          MOVE      SP70,PTVANHSC     * HDP Equivalent  
          MOVE      SP70,PTVAACTV     * Active A=Active I=Inactive
          MOVE      SP70,PTVASPAR     * Spare
.
CLRVAD99  RETURN
.------------------------------------------------------------
. Moves cgi variables into file variables
.------------------------------------------------------------
VADSAV00  MOVE      PATVA001,PTVACODE  * Transfer Destination Code
          MOVE      PATVA002,PTVADESC  * Destination Description 
          MOVE      PATVA003,PTVANHSC  * HDP Equivalent    
.
          MATCH     "A",PATVA004
          IF        @EQUAL
            MOVE      "A",PTVAACTV     * A=Active 
          ELSE
            MOVE      "I",PTVAACTV     * I=Inactive
          ENDIF
.
          MOVE      PATVA005,PTVASDAT   * Start Date
          MOVE      PATVA006,PTVASUPD   * Start Date Auto Update
          MOVE      PATVA007,PTVAEDAT   * End Date
          MOVE      PATVA008,PTVAEUPD   * End Date Auto Update
          MOVE      PATVA009,PTVAPROV   * Provider Number              *I-57547
          MOVE      PATVA010,PTVAPNAM   * Provider Name
          MOVE      PATVA011,PTVAPPCD   * Provider postcode
          MOVE      PATVA012,PTVADTYP   * Destination Type
          MOVE      PATVA013,PTVACNME   * Coded Name (4 alpha characters)
          MOVE      PATVA014,PTVAESTB   * Establishment Number
          MOVE      SP70,PTVASPAR       * Spare
.
VADSAV99  RETURN
.------------------------------------------------------------------
. * Checks mandatory fields    
.------------------------------------------------------------------
CHKVAD00  RESET     PATVA001
          MATCH     SP70,PATVA001     
          GOTO      CHKVAD90 IF EQUAL 
.
          RESET     PATVA002
          MATCH     SP70,PATVA002
          GOTO      CHKVAD91 IF EQUAL
.
          GOTO      CHKVAD98
.
CHKVAD90  MOVE      "Transfer Dest Code cannot be blank!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKVAD99
.
CHKVAD91  MOVE      "Description is mandatory!",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKVAD99
.
CHKVAD98  MOVE      ZERO,EXIT
CHKVAD99  RETURN
.---------------------------------------------------------------------
. Writes Transfer Source file Audit
.    Parameters :   KEY1 - Set Record Type
.---------------------------------------------------------------------
VADAUD00  BRANCH    CAUDE,VADAUD99  * Check if audit needs to be written
.
          CALL      IBACLOCK
          PACK      PTVAAUDD,CCC,CYY,CMM,CDD     * Date
          REP       " 0",PTVAAUDD
          MOVE      CTIMEIS,PTVAAUDT
.
          MOVE      PORT,PTVAAUDP                * Port
          MOVE      KEY1,PTVAAUDR                * Record Type
          MOVE      ONE,PTVAAUDS                 * Not Printed
          MOVE      PASSCODE,PTVAAUDO            * Operator ID
.
          PACK      KEY19,PTVAAUDD,PTVAAUDT,PTVAAUDP,PTVAAUDR
          CALL      AWPTVAD         * writes audit
.
VADAUD99  RETURN
.-------------------------------------------------------------
. Process Fields From Template Body
.-------------------------------------------------------------
PROFLD00  BRANCH    REPORTNO,PROFLD10,PROFLD20,PROFLD30,PROFLD40:
                             PROFLD50,PROFLD60,PROFLD60,PROFLD80:
                             PROFLD90,PROFL100
          GOTO      PROFLD99         
.
PROFLD10  CALL      CATD0000     * Category Codes
          GOTO      PROFLD99
.
PROFLD20  CALL      CODD0000     * Code Records
          GOTO      PROFLD99 
.
PROFLD30  CALL      WLID0000     * Lookup ID
          GOTO      PROFLD99
.
PROFLD40  CALL      WPAG0000     * Lookup Pages 
          GOTO      PROFLD99
.
PROFLD50  CALL      WLDT0000     * Lookup Details 
          GOTO      PROFLD99
.
PROFLD60                         * Dummy no Report Options 
          GOTO      PROFLD99
.
PROFLD80  CALL      PVAD0000     * Transfer Source Codes   
          GOTO      PROFLD99
.
PROFLD90  CALL      IBAP0000    * Post Code Maintenance
          GOTO      PROFLD99
.
PROFL100  BRANCH    FLDSETNO,PROFL101,PROFL102,PROFL103
          GOTO      PROFLD99
.
PROFL101  CALL      CODD0000
          GOTO      PROFLD99
.
PROFL102  CALL      MHLM0000
          GOTO      PROFLD99
.
PROFL103  CALL      MCLM0000
          GOTO      PROFLD99
.
PROFLD99  RETURN
.-----------------------------------------------------------
. Option 1: Category 
.-----------------------------------------------------------
CATD0000  BRANCH    FLDITMNO,CATD0100,CATD0200,CATD0300,CATD0400,CATD0500:
                             CATD0600,CATD0700,CATD0800,CATD0900,CATD1000:
                             CATD1100,CATD1200,CATD1300,CATD1400,CATD1500:
                             CATD1600,CATD1700

          GOTO      CATD9999
.
CATD0100  WRITE     HTMLFILE;TCODE; 
          GOTO      CATD9999
.
CATD0200  MATCH     SP70,TDESC
          GOTO      CATD9999 IF EQUAL
          WRITE     HTMLFILE;TDESC; 
          GOTO      CATD9999
.
CATD0300  MATCH     SP70,THCSCOD
          GOTO      CATD9999 IF EQUAL
          WRITE     HTMLFILE;THCSCOD; 
          GOTO      CATD9999
.
CATD0400  MOVE      ZERO,LNK2PRT 
          CALL      CATCT000        * Table of Categories by Category   
          GOTO      CATD9999
.
CATD0500  MOVE      ZERO,LNK2PRT
          CALL      CATDS000        * Table of Categories by Description   
          GOTO      CATD9999
.
CATD0600  CALL      NEXTGR00
          GOTO      CATD9999
.
CATD0700  CALL      PREVGR00
          GOTO      CATD9999
.
CATD0800  MATCH     SP70,STARTKEY
          GOTO      CATD9999 IF EQUAL
          WRITE     HTMLFILE;STARTKEY; 
          GOTO      CATD9999
.
CATD0900  MOVE      ONE,LNK2PRT  * Update Parent 
          CALL      CATCT000     * Table of Categories by Category 
          GOTO      CATD9999
.
CATD1000  CALL      SELCOD00     * Category Selection List
          GOTO      CATD9999
.
CATD1100  MATCH     "1",PTCDHOSS
          IF        @EQUAL
            WRITE     HTMLFILE;DYES; 
          ELSE
            WRITE     HTMLFILE;DNO; 
          ENDIF
          GOTO      CATD9999
.
CATD1200  MATCH     SP70,PTCDLDES      * Long Description 
          GOTO      CATD9999 IF EQUAL
          WRITE     HTMLFILE;PTCDLDES; 
          GOTO      CATD9999
.
CATD1300  WRITE     HTMLFILE;MENUFLAG;
          GOTO      CATD9999
.
CATD1400  WRITE     HTMLFILE;PTCOACTV;
          GOTO      CATD9999
.
CATD1500  WRITE     HTMLFILE;TCINDC8;
          GOTO      CATD9999
.
CATD1600  WRITE     HTMLFILE;TCINDC10;
          GOTO      CATD9999
.
CATD1700  WRITE     HTMLFILE;TCINDC11;
          GOTO      CATD9999
.
CATD9999  RETURN
.------------------------------------------------------------
. Category Selection List                     
.------------------------------------------------------------
SELCOD00  PACK      KEY5,SP70 
          CALL      RDSCODE3
SELCOD10  CALL      RDKCODE3
          BRANCH    OVRCD,SELCOD99
          MATCH     SP70,ACODE
          GOTO      SELCOD99 IF NOT EQUAL
          MATCH     "I",PTCOACTV
          GOTO      SELCOD10 IF EQUAL
.
          PACK      KEY4,QUOTE,TCODE,QUOTE
          WRITE     HTMLFILE;"<option value=",KEY4,">(",TCODE,") ":
                             TDESC,"</option>"
          GOTO      SELCOD10
.
SELCOD99  RETURN
.-----------------------------------------------------------
. Option 2: Code Record  
.-----------------------------------------------------------
CODD0000  BRANCH    FLDITMNO,CODD0100,CODD0200,CODD0300,CODD0400,CODD0500:
                             CODD0600,CODD0700,CODD0800,CODD0900,CODD1000:
                             CODD1100,CODD1200,CODD1300,CODD1400,CODD1500:
                             CODD1600,CODD1700,CODD1800,CODD1900,CODD2000: 
                             CODD2100,CODD2200,CODD2300,CODD2400,CODD2500:
                             CODD2600,CODD2700,CODD2800,CODD2900,CODD3000:
                             CODD3100,CODD3200,CODD3300,CODD3400,CODD3500:
                             CODD3600,CODD3700,CODD3800,CODD3900,CODD4000:
                             CODD4100,CODD4200,CODD4300,CODD4400,CODD4500:
                             CODD4600,CODD4700,CODD4800,CODD4900,CODD5000:
                             CODD5100,CODD5200,CODD5300,CODD5400,CODD5500:
                             CODD5600,CODD5700,CODD5800,CODD5900,CODD6000:
                             CODD6100,CODD6200,CODD6300,CODD6400,CODD6500:
                             CODD6600,CODD6700,CODD6800,CODD6900,CODD7000:
                             CODD7100,CODD7200,CODD7300,CODD7400,CODD7500:
                             CODD7600,CODD7700,CODD7800,CODD7900,CODD8000:
                             CODD8100,CODD8200,CODD8300,CODD8400,CODD8500:
                             CODD8600,CODD8700,CODD8800,CODD8900,CODD9000:
                             CODD9100,CODD9200,CODD9300,CODD9400,CODD9500:
                             CODD9600,CODD9700,CODD9800,CODD9900
          GOTO      CODD9999
.
CODD0100  WRITE     HTMLFILE;TCODE; 
          GOTO      CODD9999
.
CODD0200  WRITE     HTMLFILE;ACODE;  
          GOTO      CODD9999
.
CODD0300  MATCH     SP70,TDESC
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TDESC; 
          GOTO      CODD9999
.
CODD0400  MATCH     SP70,THCSCOD
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;THCSCOD; 
          GOTO      CODD9999
.
CODD0500  WRITE     HTMLFILE;TCFORM6; 
          GOTO      CODD9999
.
CODD0600  MATCH     SP70,PTCOACTV
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCOACTV; 
          GOTO      CODD9999
.
CODD0700  MATCH     SP70,TCINDC1 
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC1; 
          GOTO      CODD9999
.
CODD0800  MATCH     SP70,TCINDC2 
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC2; 
          GOTO      CODD9999
.
CODD0900  MATCH     SP70,TCINDC3 
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC3; 
          GOTO      CODD9999
.
CODD1000  MATCH     SP70,TCINDC4 
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC4; 
          GOTO      CODD9999
.
CODD1100  MATCH     SP70,TCINDC5 
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC5; 
          GOTO      CODD9999
.
CODD1200  MATCH     SP70,TCINDC6 
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC6; 
          GOTO      CODD9999
.
CODD1300  MATCH     SP70,TCINDC7 
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC7; 
          GOTO      CODD9999
.
CODD1400  MATCH     SP70,TCINDC8 
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC8; 
          GOTO      CODD9999
.
CODD1500  MATCH     SP70,TCINDC9 
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC9; 
          GOTO      CODD9999
.
CODD1600  MATCH     SP70,TCINDC10 
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC10; 
          GOTO      CODD9999
.
CODD1700  CALL      CODCD000        * Table of Codes by Code   
          GOTO      CODD9999
.
CODD1800  CALL      CODDS000        * Table of Codes by Description   
          GOTO      CODD9999
.
CODD1900  CALL      NEXTGR00
          GOTO      CODD9999
.
CODD2000  CALL      PREVGR00
          GOTO      CODD9999
.
CODD2100  WRITE     HTMLFILE;CURRCODE; 
          GOTO      CODD9999
.
CODD2200  WRITE     HTMLFILE;CATEDESC; 
          GOTO      CODD9999
.
CODD2300  MATCH     SP70,TCINDC11
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC11; 
          GOTO      CODD9999
.
CODD2400  MATCH     "1",PTCDDEFT
          IF        @EQUAL
            WRITE     HTMLFILE;ONE; 
          ELSE
            WRITE     HTMLFILE;ZERO; 
          ENDIF
          GOTO      CODD9999
.
CODD2500  WRITE     HTMLFILE;PTCDNHCP;
          GOTO      CODD9999
.
CODD2600  WRITE     HTMLFILE;PTCDNHCP;
          GOTO      CODD9999
.
CODD2700  PACK      DFLTWARD,THCSCOD
          CALL      WSEL0000        * Selection List of Wards         
          GOTO      CODD9999
.
CODD2800  WRITE     HTMLFILE;DISABLED;  * set in "chksec00" (codcd000/codds000)
          GOTO      CODD9999
.
CODD2900  MATCH     SP70,PTCDGRPV
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCDGRPV; 
          GOTO      CODD9999
.
CODD3000  MATCH     "1",PTCDHOSS
          IF        @EQUAL
            WRITE     HTMLFILE;DYES;
          ELSE 
            WRITE     HTMLFILE;DNO;
          ENDIF
          GOTO      CODD9999
.
CODD3100  COMPARE   ONE,IBCNMHOS
          GOTO      CODD9999 IF NOT EQUAL
.
          PACK      KEY8,PTCOD001,SP70
          CALL      RSMLCOD2
          CALL      RKMLCOD2
          BRANCH    OVRCD,CATEGR99
.
          MATCH     PTCOD001,MLCOTCOD
          GOTO      CATEGR99 IF NOT EQUAL
.
          WRITE     HTMLFILE;ONE;
          GOTO      CODD9999
.
CODD3200  CALL      HCOD0000                * Hospital Specific cat codes list
          GOTO      CODD9999
.
CODD3300  COMPARE   ONE,IBCNMHOS
          GOTO      CODD9999 IF NOT EQUAL
.
          WRITE     HTMLFILE;PTCDHOSS;
          GOTO      CODD9999
.
CODD3400  CALL      HHSL0000                * Hospital Selectin list
          GOTO      CODD9999
.
CODD3500  WRITE     HTMLFILE;CODESTAT;
          GOTO      CODD9999
.
CODD3600  WRITE     HTMLFILE;PTCNUFMS;
          GOTO      CODD9999
.
CODD3700  MATCH     SP70,PMCMCACC
          IF        !@EQUAL
            WRITE     HTMLFILE;PMCMCACC;
          ENDIF
          GOTO      CODD9999
.
CODD3800  MATCH     SP70,PTCDLDES
          IF        !@EQUAL
            WRITE     HTMLFILE;PTCDLDES;
          ENDIF
          GOTO      CODD9999
.
CODD3900  MOVE      "  3",STNTYPE        * Stationery Type 3
          MOVE      PTCDDFIC,STNCODE     * Default Fee Information Form
          CALL      STNCOD00
          GOTO      CODD9999
.
CODD4000  WRITE     HTMLFILE;PMDVSERV;
          GOTO      CODD9999
.
CODD4100  PACK      SAVKEY5,TCODE,ACODE,SP70
          MOVE      "FA",CATEGORY
          PACK      CODE,PTCFFACD,SP70
          CALL      CODITM00
          PACK      KEY5,SAVKEY5,SP70
          CALL      RDCODE1
          GOTO      CODD9999
.
CODD4200  WRITE     HTMLFILE;PTCFNDFP;
          GOTO      CODD9999
.
CODD4300  PACK      SAVKEY5,TCODE,ACODE,SP70
          MOVE      "w0",CATEGORY
          PACK      CODE,PTCFOCGR,SP70
          CALL      CODITM00
          PACK      KEY5,SAVKEY5,SP70
          CALL      RDCODE1
          GOTO      CODD9999
.
CODD4400  MATCH     SP70,TCINDC12
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC12; 
          GOTO      CODD9999
.
CODD4500  MATCH     SP70,TCINDC13
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC13; 
          GOTO      CODD9999
.
CODD4600  MATCH     SP70,TCINDC14
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC14; 
          GOTO      CODD9999
.
CODD4700  MATCH     SP70,TCINDC15
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC15; 
          GOTO      CODD9999
.
CODD4800  MATCH     SP70,TCINDC16
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC16; 
          GOTO      CODD9999
.
CODD4900  MATCH     SP70,TCINDC17
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC17; 
          GOTO      CODD9999
.
CODD5000  MATCH     SP70,TCINDC18
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC18; 
          GOTO      CODD9999
.
CODD5100  MATCH     SP70,TCINDC19
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC19; 
          GOTO      CODD9999
.
CODD5200  MATCH     SP70,TCINDC20
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC20; 
          GOTO      CODD9999
.
CODD5300  MATCH     SP70,TCINDC21
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC21; 
          GOTO      CODD9999
.
CODD5400  MATCH     SP70,PTCFCEFR
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCFCEFR; 
          GOTO      CODD9999
.
CODD5500  MATCH     SP70,PTCFMCPS
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCFMCPS; 
          GOTO      CODD9999
.
CODD5600  MATCH     SP70,PTCFHINV
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCFHINV; 
          GOTO      CODD9999
.
CODD5700  PACK      SAVKEY5,TCODE,ACODE,SP70
          MOVE      "rh",CATEGORY
          PACK      CODE,PTCFRHCD,SP70
          CALL      CODITM00
          PACK      KEY5,SAVKEY5,SP70
          CALL      RDCODE1
          GOTO      CODD9999
.
CODD5800  MATCH     SP70,PTCFRHFT
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCFRHFT; 
          GOTO      CODD9999
.
CODD5900  MOVE      "  5",STNTYPE        * Stationery Type 5
          MOVE      PTCDFELC,STNCODE     * Financial Election stationery Form
          CALL      STNCOD00
          GOTO      CODD9999
.
CODD6000  MOVE      PTCDUDF2,DEFTHOSP
          CALL      HSEL0000               * Hospital Selection List
          GOTO      CODD9999
.
CODD6100  WRITE     HTMLFILE;PTCDCRSC;
          GOTO      CODD9999
.
CODD6200  MATCH     PTCFHDAT,SP70
          GOTO      CODD9999 IF EQUAL
          UNPACK    PTCFHDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      CODD9999
.
CODD6300  CALL      HFGSEL00
          GOTO      CODD9999
.
CODD6400  WRITE     HTMLFILE;PTCFHFGC;
          GOTO      CODD9999
.
CODD6500  MATCH     SP70,PTCDASC1
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCDASC1;
          GOTO      CODD9999
.
CODD6600  MATCH     SP70,PTCDASC2
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCDASC2;
          GOTO      CODD9999
.
CODD6700  MATCH     SP70,PTCDASC3
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCDASC3;
          GOTO      CODD9999
.
CODD6800  MATCH     SP70,PTCDASC4
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCDASC4;
          GOTO      CODD9999
.
CODD6900  MATCH     SP70,PTCDASC5
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCDASC5;
          GOTO      CODD9999
.
CODD7000  MATCH     SP70,PTCDUDF3
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCDUDF3;
          GOTO      CODD9999
.
CODD7100  MATCH     SP70,PTCDUDF4
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCDUDF4;
          GOTO      CODD9999
.
CODD7200  CALL      CODINS00           * Insurance code
          GOTO      CODD9999
.
CODD7300  MATCH     SP70,TCINDC22
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC22;
          GOTO      CODD9999
.
CODD7400  MATCH     SP70,TCINDC23
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC23;
          GOTO      CODD9999
.
CODD7500  MATCH     SP70,TCINDC24
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC24;
          GOTO      CODD9999
.
CODD7600  MATCH     SP70,TCINDC25
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC25;
          GOTO      CODD9999
.
CODD7700  MATCH     SP70,TCINDC26
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC26;
          GOTO      CODD9999
.
CODD7800  MATCH     SP70,TCINDC27
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC27;
          GOTO      CODD9999
.
CODD7900  MATCH     SP70,TCINDC28
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC28;
          GOTO      CODD9999
.
CODD8000  MATCH     SP70,TCINDC29
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC29;
          GOTO      CODD9999
.
CODD8100  MATCH     SP70,TCINDC30
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC30;
          GOTO      CODD9999
.
CODD8200  MATCH     SP70,TCINDC31
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC31;
          GOTO      CODD9999
.
CODD8300  MATCH     SP70,TCINDC32
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC32;
          GOTO      CODD9999
.
CODD8400  MATCH     SP70,TCINDC33
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC33;
          GOTO      CODD9999
.
CODD8500  MATCH     SP70,TCINDC34
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC34;
          GOTO      CODD9999
.
CODD8600  MATCH     SP70,TCINDC35
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC35;
          GOTO      CODD9999
.
CODD8700  MATCH     SP70,TCINDC36
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC36;
          GOTO      CODD9999
.
CODD8800  MATCH     SP70,TCINDC37
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC37;
          GOTO      CODD9999
.
CODD8900  MATCH     SP70,TCINDC38
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC38;
          GOTO      CODD9999
.
CODD9000  MATCH     SP70,TCINDC39
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC39;
          GOTO      CODD9999
.
CODD9100  MATCH     SP70,TCINDC40
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC40; 
          GOTO      CODD9999
.
CODD9200  MATCH     SP70,TCINDC41
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;TCINDC41; 
          GOTO      CODD9999
.
CODD9300  MATCH     SP70,PTCDUDF5
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCDUDF5;
          GOTO      CODD9999
.
CODD9400  MATCH     SP70,PTCDUDF6
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCDUDF6;
          GOTO      CODD9999
.
CODD9500  MATCH     SP70,PTCDUDF7
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCDUDF7;
          GOTO      CODD9999
.
CODD9600  MATCH     SP70,PTCDUDF8
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCDUDF8;
          GOTO      CODD9999
.
CODD9700  MATCH     SP70,PTCDUDF9
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCDUDF9;
          GOTO      CODD9999
.
CODD9800  MATCH     SP70,PTCDUD10
          GOTO      CODD9999 IF EQUAL
          WRITE     HTMLFILE;PTCDUD10;
          GOTO      CODD9999
.
CODD9900  UNPACK    DIM127,D1,KEY3,DIM127
          MOVE      KEY3,FLDITMNO
          CALL      CODX0000
          GOTO      CODD9999
.
CODD9999  RETURN
+
.------------------------------------------------
.         Additional Code tags
.------------------------------------------------
CODX0000  BRANCH    FLDITMNO,CODX0100,CODX0200,CODX0300,CODX0400,CODX0500:
                             CODX0600,CODX0700,CODX0800,CODX0900,CODX1000:
                             CODX1100,CODX1200,CODX1300,CODX1400,CODX1500
          GOTO      CODX9999
.
CODX0100  MATCH     SP70,PTCDUD11
          GOTO      CODX9999 IF EQUAL
          WRITE     HTMLFILE;PTCDUD11;
          GOTO      CODX9999
.
CODX0200  MATCH     SP70,PTCDUD12
          GOTO      CODX9999 IF EQUAL
          WRITE     HTMLFILE;PTCDUD12;
          GOTO      CODX9999
.
CODX0300  MATCH     SP70,PTCDUD13
          GOTO      CODX9999 IF EQUAL
          WRITE     HTMLFILE;PTCDUD13;
          GOTO      CODX9999
.
CODX0400  MATCH     SP70,PTCDUD14
          GOTO      CODX9999 IF EQUAL
          WRITE     HTMLFILE;PTCDUD14;
          GOTO      CODX9999
.
CODX0500  MATCH     SP70,PTCDASC6
          GOTO      CODX9999 IF EQUAL
          WRITE     HTMLFILE;PTCDASC6;
          GOTO      CODX9999
.
CODX0600  MATCH     SP70,PTCDASC7
          GOTO      CODX9999 IF EQUAL
          WRITE     HTMLFILE;PTCDASC7;
          GOTO      CODX9999
.
CODX0700  MATCH     SP70,PTCDASC8
          GOTO      CODX9999 IF EQUAL
          WRITE     HTMLFILE;PTCDASC8;
          GOTO      CODX9999
.
CODX0800  MATCH     SP70,PTCDASC9
          GOTO      CODX9999 IF EQUAL
          WRITE     HTMLFILE;PTCDASC9;
          GOTO      CODX9999
.
CODX0900  MATCH     SP70,PTCDAS10
          GOTO      CODX9999 IF EQUAL
          WRITE     HTMLFILE;PTCDAS10;
          GOTO      CODX9999
.
CODX1000  MATCH     SP70,PTCDAS11
          GOTO      CODX9999 IF EQUAL
          WRITE     HTMLFILE;PTCDAS11;
          GOTO      CODX9999
.
CODX1100  MATCH     SP70,PTCDAS12
          GOTO      CODX9999 IF EQUAL
          WRITE     HTMLFILE;PTCDAS12;
          GOTO      CODX9999
.
CODX1200  MATCH     SP70,PTCDAS13
          GOTO      CODX9999 IF EQUAL
          WRITE     HTMLFILE;PTCDAS13;
          GOTO      CODX9999
.
CODX1300  MATCH     SP70,PTCDAS14
          GOTO      CODX9999 IF EQUAL
          WRITE     HTMLFILE;PTCDAS14;
          GOTO      CODX9999
.
CODX1400  MATCH     SP70,PTCDAS15
          GOTO      CODX9999 IF EQUAL
          WRITE     HTMLFILE;PTCDAS15;
          GOTO      CODX9999
.
CODX1500  PACK      KEY9,PTCOD002,SP70
          CALL      RSWTVWL2
          CALL      RKWTVWL2
          BRANCH    OVRCD,CODX9999
.
          MATCH     PTCOD002,WTVWLTYP
          GOTO      CODX9999 IF NOT EQUAL
.
          WRITE     HTMLFILE;ONE;
          GOTO      CODX9999
.
CODX9999  RETURN
+
.------------------------------------------------
. Add Selection Options to Form (Insurance Codes)
.------------------------------------------------
CODINS00  UNPACK    DIM127,D1,KEY1,DIM127
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,CODINS10
.
          MATCH     SP70,PTCDASC5
          GOTO      CODINS99 IF EQUAL       * Blank code
          PACK      KEY6,PTCDASC5,SP70
          CALL      RDINSR1
          BRANCH    OVRCD,CODINS99
          WRITE     HTMLFILE;PTCDASC5;
          GOTO      CODINS99
.
CODINS10  PACK      KEY6,SP70
          CALL      RDSINSR1
CODINS12  CALL      RDKINSR1
          BRANCH    OVRCD,CODINS99
          MATCH     SP70,ICODE
          GOTO      CODINS12 IF EQUAL
.
          MATCH     "1",PTINACTV
          GOTO      CODINS12 IF EQUAL
.
          PACK      PTCDASC5,PTCDASC5,SP70      * Assoc.number 5
.
          PACK      KEY8,QUOTE,ICODE,QUOTE
          MATCH     ICODE,PTCDASC5
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY8," selected>":
                               INAME,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY8,">",INAME,"</option>"
          ENDIF
          GOTO      CODINS12
CODINS99  RETURN
.------------------------------------------------------------
. Hospital Selection
.------------------------------------------------------------
HSEL0000  PACK      KEY3,SP70
          CALL      RSPTHSP1
HSEL0100  CALL      RKPTHSP1
          BRANCH    OVRCD,HSEL9999
.
          MOVE      PTHSNAME,KEY50
          PACK      KEY5,QUOTE,PTHSHOSP,QUOTE
.
          MATCH     DEFTHOSP,PTHSHOSP
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY5," selected>":
                               KEY50,"</option>"
          ELSE
            IF        IBCNMHOS=1
              PACK      KEY13,USERID,SP70            * All hospital access
              CALL      RDMLSEC1
              IF        OVRCD=1
                PACK      KEY13,USERID,PTHSHOSP,SP70 * This hospital access
                CALL      RDMLSEC1
                BRANCH    OVRCD,HSEL0100
              ENDIF
            ENDIF
.
            WRITE     HTMLFILE;"<option value=",KEY5,">",KEY50,"</option>"
          ENDIF
          GOTO      HSEL0100
.
HSEL9999  RETURN
.------------------------------------------------------------
. Ward selection Cat "ap"
.------------------------------------------------------------
WSEL0000  PACK      KEY29,SP70                                                                                                                     
          IF        IBCNMHOS = 1                                                                                                                   
            PACK      KEY29,SP3,WBSEHOSP,SP70                                                                                                      
          ENDIF                                                                                                                                    
          CALL      RDSWARD7                                                                                                                       
WSEL0100  CALL      RDKWARD7                                                                                                                       
          BRANCH    OVRCD,WSEL9999                                                                                                                 
.                                                                                                                                                  
.                         if we have a bed number we have passed all the ward                                                                      
.                         master records, so exit                                                                                                           
          MATCH     SP70,WBED                                                                                                                      
          GOTO      WSEL9999 IF NOT EQUAL                                                                                                          
.                                                                                                                                                  
          COMPARE   WACTIVE,ZERO                 *List only active wards                                                                           
          GOTO      WSEL0100 IF NOT EQUAL                                                                                                          
.                                                                                                                                                  
          IF        IBCNMHOS = 1                                                                                                                   
            MATCH      SP3,WBSEHOSP                                                                                                                
            IF        !@EQUAL                                                                                                                      
              MATCH     WBSEHOSP,PTWDHOSN                                                                                                          
              GOTO      WSEL9999 IF NOT EQUAL                                                                                                      
            ENDIF                                                                                                                                  
          ENDIF                                                                                                                                    
.                                                                                                                                                  
.                       write the select option.                                                                                                   
          WRITE     HTMLFILE;"<option value=#"",WWARD,"#"";                                                                                        
          MATCH     DFLTWARD,WWARD
          IF        @EQUAL                                                                                                                         
            WRITE     HTMLFILE;" selected";                                                                                                        
          ENDIF                                                                                                                                    
          WRITE     HTMLFILE;">",WBDESC;
.
          IF        IBCNMHOS = 1
            MATCH      SP3,WBSEHOSP
            IF        @EQUAL
              WRITE     HTMLFILE;" - ",PTWDHOSN;
            ENDIF
          ENDIF
.
          WRITE     HTMLFILE;"</option>"
          GOTO      WSEL0100                                                                                                                       
.                                                                                                                                                  
WSEL9999  RETURN 
.-----------------------------------------------------------
. Option 3: Lookup ID's 
.-----------------------------------------------------------
WLID0000  BRANCH    FLDITMNO,WLID0100,WLID0200,WLID0300,WLID0400,WLID0500:
                             WLID0600,WLID0700,WLID0800
          GOTO      WLID9999
.
WLID0100  CALL      ALTPAG00   * Link to Alternate page 
          GOTO      WLID9999
.
WLID0200  WRITE     HTMLFILE;WBLILKID; 
          GOTO      WLID9999
.
WLID0300  MATCH     SP70,WBLIDESC
          GOTO      WLID9999 IF EQUAL
          WRITE     HTMLFILE;WBLIDESC; 
          GOTO      WLID9999
.
WLID0400  CALL      LKTAB000        * Table of Lookup ID's   
          GOTO      WLID9999
.
WLID0500  CALL      NEXTID00
          GOTO      WLID9999
.
WLID0600  CALL      PREVID00
          GOTO      WLID9999
.
WLID0700  CALL      LKSELC00  * Selection list of Lookup ID's
          GOTO      WLID9999
.
WLID0800  PACK      KEY11,WBLID001,SP70     
          CALL      RSWBLP1 
          CALL      RKWBLP1
          BRANCH    OVRCD,WLID9999
          MATCH     WBLID001,WBLPLKID
          GOTO      WLID9999 IF NOT EQUAL
.
          WRITE     HTMLFILE;ONE; * to display red for details button
          GOTO      WLID9999
.
WLID9999  RETURN
.------------------------------------------------------------
. Selection List of Lookup ID's 
.------------------------------------------------------------
LKSELC00  PACK      KEY8,SP70
          CALL      RSWBLI1
LKSELC10  CALL      RKWBLI1
          BRANCH    OVRCD,LKSELC99
.          MATCH     SP70,WBLILKID
.          GOTO      LKSELC10 IF EQUAL
.
          WRITE     HTMLFILE;"<option value=",WBLILKID,">",WBLIDESC,"</option>"
          GOTO      LKSELC10
.
LKSELC99  RETURN
.-------------------------------------------------------------------------------
. Link to Alternate Page
.-------------------------------------------------------------------------------
ALTPAG00  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127 
.
          REP       " +",TEMPLATE
          REP       " +",WBLID001
.
          WRITE     HTMLFILE;LINKPRG,".pbl?reportno=",LINKREP:
                                         "&template=",LINKTEM:
                                         "&wblid001=",WBLID001;
.
          REP       "+ ",TEMPLATE
          REP       "+ ",WBLID001
.
ALTPAG99  RETURN
.-----------------------------------------------------------
. Option 4: Lookup Pages 
.-----------------------------------------------------------
WPAG0000  BRANCH    FLDITMNO,WPAG0100,WPAG0200,WPAG0300,WPAG0400,WPAG0500:
                             WPAG0600,WPAG0700,WPAG0800,WPAG0900,WPAG1000:
                             WPAG1100,WPAG1200,WPAG1300,WPAG1400  
          GOTO      WPAG9999
.
WPAG0100  CALL      LNKPAG00   * Link to Alternate page 
          GOTO      WPAG9999
.
WPAG0200  WRITE     HTMLFILE;WBLPLKID; 
          GOTO      WPAG9999
.
WPAG0300  MATCH     SP70,WBLPPGNO
          GOTO      WPAG9999 IF EQUAL
          WRITE     HTMLFILE;WBLPPGNO; 
          GOTO      WPAG9999
.
WPAG0400  MATCH     SP70,WBLPTITL
          GOTO      WPAG9999 IF EQUAL
          STRIP     WBLPTITL
          MOVELPTR  WBLPTITL,LENGTH
          SFORMAT   VAR,LENGTH
          MOVE      WBLPTITL,VAR
          WRITE     HTMLFILE;VAR; 
          SFORMAT   VAR,127
          GOTO      WPAG9999
.
WPAG0500  MATCH     SP70,WBLPHEAD
          GOTO      WPAG9999 IF EQUAL
          STRIP     WBLPHEAD
          MOVELPTR  WBLPHEAD,LENGTH
          SFORMAT   VAR,LENGTH
          MOVE      WBLPHEAD,VAR
          WRITE     HTMLFILE;VAR; 
          SFORMAT   VAR,127
          GOTO      WPAG9999
.
WPAG0600  MATCH     SP70,WBLPCLOR
          GOTO      WPAG9999 IF EQUAL
          WRITE     HTMLFILE;WBLPCLOR; 
          GOTO      WPAG9999
.
WPAG0700  UNPACK    DIM127,D1,KEY1,DIM127 
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,WPAG0750
          MATCH     "0",WBLPSCOD
          IF        @EQUAL 
            MOVE      "No",KEY3 
            PACK      KEY3,KEY3,SP70
          ELSE
            MOVE      "Yes",KEY3     
          ENDIF
          WRITE     HTMLFILE;KEY3
          GOTO      WPAG9999
WPAG0750  WRITE     HTMLFILE;WBLPSCOD; 
          GOTO      WPAG9999
.
WPAG0800  UNPACK    DIM127,D1,KEY1,DIM127 
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,WPAG0850
          MATCH     "0",WBLPPSEQ
          IF        @EQUAL 
            MOVE      "Description",KEY11 
          ELSE
            MOVE      "Code",KEY11     
            PACK      KEY11,KEY11,SP70 
          ENDIF
          WRITE     HTMLFILE;KEY11
          GOTO      WPAG9999 
WPAG0850  WRITE     HTMLFILE;WBLPPSEQ;
          GOTO      WPAG9999 
.
WPAG0900  CALL      LKPGT000        * Table of Lookup Pages   
          GOTO      WPAG9999
.
WPAG1000  CALL      NEXTID00        * Link to Next Group of ID's
          GOTO      WPAG9999
.
WPAG1100  CALL      PREVID00        * Link to Prev Group of ID's
          GOTO      WPAG9999
.
WPAG1200  WRITE     HTMLFILE;LOOKID;
          GOTO      WPAG9999 
.
WPAG1300  WRITE     HTMLFILE;IDDESC;
          GOTO      WPAG9999 
.
WPAG1400  PACK      KEY14,WBLID001,WBPAG001,SP70  
          CALL      RSWBLD1
          CALL      RKWBLD1
          BRANCH    OVRCD,WLID9999
.
          MATCH     WBLID001,WBLDLKID
          GOTO      WLID9999 IF NOT EQUAL 
.
          MATCH     WBPAG001,WBLDPAGE
          GOTO      WLID9999 IF NOT EQUAL 
.
          WRITE     HTMLFILE;ONE;   * Display red color details button
          GOTO      WPAG9999
.
WPAG9999  RETURN
.-------------------------------------------------------------------------------
. Link to Alternate Page
.-------------------------------------------------------------------------------
LNKPAG00  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127 
.
          REP       " +",TEMPLATE
          REP       " +",WBLID001
          REP       " +",WBPAG001
.
          WRITE     HTMLFILE;LINKPRG,".pbl?reportno=",LINKREP:
                                         "&template=",LINKTEM:
                                         "&wblid001=",WBLID001:
                                         "&wbpag001=",WBPAG001;
.
          REP       "+ ",TEMPLATE
          REP       "+ ",WBLID001
          REP       "+ ",WBPAG001
.
LNKPAG99  RETURN
.-----------------------------------------------------------
. Option 5: Lookup Details 
.-----------------------------------------------------------
WLDT0000  BRANCH    FLDITMNO,WLDT0100,WLDT0200,WLDT0300,WLDT0400,WLDT0500:
                             WLDT0600,WLDT0700,WLDT0800,WLDT0900,WLDT1000:
                             WLDT1100,WLDT1200,WLDT1300,WLDT1400,WLDT1500  
          GOTO      WLDT9999
.
WLDT0100  CALL      LNKDET00   * Link to Alternate page 
          GOTO      WLDT9999
.
WLDT0200  WRITE     HTMLFILE;WBLDLKID; 
          GOTO      WLDT9999
.
WLDT0300  MATCH     SP70,WBLDPAGE
          GOTO      WLDT9999 IF EQUAL
          WRITE     HTMLFILE;WBLDPAGE; 
          GOTO      WLDT9999
.
WLDT0400  MATCH     SP70,WBLDUQID
          GOTO      WLDT9999 IF EQUAL
          WRITE     HTMLFILE;WBLDUQID; 
          GOTO      WLDT9999
.
WLDT0500  MATCH     SP70,WBLDCODE
          GOTO      WLDT9999 IF EQUAL
          WRITE     HTMLFILE;WBLDCODE; 
          GOTO      WLDT9999
.
WLDT0600  MATCH     SP70,WBLDDESC
          GOTO      WLDT9999 IF EQUAL
          WRITE     HTMLFILE;WBLDDESC; 
          GOTO      WLDT9999
.
WLDT0700  UNPACK    DIM127,D1,KEY1,DIM127 
          MOVE      ZERO,F1
          MOVE      KEY1,F1
          BRANCH    F1,WLDT0750
          MOVE      WBLDTYPE,F1 
          BRANCH    F1,WLDT0710,WLDT0711 
.
          MOVE      "Link",KEY13 
          PACK      KEY13,KEY13,SP70 
          WRITE     HTMLFILE;KEY13
          GOTO      WLDT9999
.
WLDT0710  MOVE      "Detail Line",KEY13
          PACK      KEY13,KEY13,SP70 
          WRITE     HTMLFILE;KEY13
          GOTO      WLDT9999
.
WLDT0711  MOVE      "Checkbox Line",KEY13     
          WRITE     HTMLFILE;KEY13
          GOTO      WLDT9999 
.
WLDT0750  WRITE     HTMLFILE;WBLDTYPE;
          GOTO      WLDT9999 
.
WLDT0800  MATCH     SP70,WBLDLKPG 
          GOTO      WLDT9999 IF EQUAL
          WRITE     HTMLFILE;WBLDLKPG; 
          GOTO      WLDT9999 
.
WLDT0900  MATCH     SP70,WBLDACTV 
          GOTO      WLDT9999 IF EQUAL
          WRITE     HTMLFILE;WBLDACTV; 
          GOTO      WLDT9999 
.
WLDT1000  CALL      LKDET000        * Table of Lookup Details   
          GOTO      WLDT9999
.
WLDT1100  CALL      NEXTID00        * Link to Next Group of ID's
          GOTO      WLDT9999
.
WLDT1200  CALL      PREVID00        * Link to Prev Group of ID's
          GOTO      WLDT9999
.
WLDT1300  WRITE     HTMLFILE;LOOKID;
          GOTO      WLDT9999 
.
WLDT1400  WRITE     HTMLFILE;PAGENO;
          GOTO      WLDT9999 
.
WLDT1500  WRITE     HTMLFILE;PAGEHEAD;
          GOTO      WLDT9999 
.
WLDT9999  RETURN
.-----------------------------------------------------------
. Option 8: Transfer Source Codes  
.-----------------------------------------------------------
PVAD0000  BRANCH    FLDITMNO,PVAD0100,PVAD0200,PVAD0300,PVAD0400,PVAD0500:
                             PVAD0600,PVAD0700,PVAD0800,PVAD0900,PVAD1000:
                             PVAD1100,PVAD1200,PVAD1300,PVAD1400,PVAD1500:
                             PVAD1600,PVAD1700,PVAD1800,PVAD1900,PVAD2000:
                             PVAD2100,PVAD2200,PVAD2300,PVAD2400,PVAD2500
          GOTO      PVAD9999
.
PVAD0100  WRITE     HTMLFILE;PTVACODE;   * Transfer Destination Code 
          GOTO      PVAD9999
.
PVAD0200  MATCH     SP70,PTVADESC
          GOTO      PVAD9999 IF EQUAL
          WRITE     HTMLFILE;PTVADESC;   * Description 
          GOTO      PVAD9999
.
PVAD0300  MATCH     SP70,PTVANHSC        * HDP Equivalent 
          GOTO      PVAD9999 IF EQUAL
          WRITE     HTMLFILE;PTVANHSC;
          GOTO      PVAD9999
.
PVAD0400  MATCH     "I",PTVAACTV
          IF        @EQUAL  
            WRITE     HTMLFILE;"I";   * I=Inactive 
          ELSE
            WRITE     HTMLFILE;"A";   * A=Active
          ENDIF
          GOTO      PVAD9999
.
PVAD0500  MOVE      ZERO,LINK2PRT        * Link to alternate Program
          CALL      VADTB000             * Table of Transfer Source Codes
          GOTO      PVAD9999             * List by Code 
.
PVAD0600  CALL      PREVGR00             * Link to Prev group of codes
          GOTO      PVAD9999
.
PVAD0700  CALL      NEXTGR00             * Link to Next group of codes
          GOTO      PVAD9999
.
PVAD0800  MOVE      ZERO,LINK2PRT        * Link to alternate Program
          MOVE      ONE,ACTVFLAG         * Yes display inactive codes
          CALL      VADDB000             * Table of Transfer Source Codes
          GOTO      PVAD9999             * List by Description
.
PVAD0900  CALL      LNKPRO00             * Link to another program
          GOTO      PVAD9999             * List by Description
.
PVAD1000  MOVE      ONE,LINK2PRT         * Link to Parent
          MOVE      ONE,ACTVFLAG         * Yes display inactive codes
          CALL      VADDB000             * Table of Transfer Source Codes
          GOTO      PVAD9999             * List by Description
.
PVAD1100  MOVE      ONE,LINK2PRT         * Link to Parent
          MOVE      ZERO,ACTVFLAG        * Do not display inactive codes
          CALL      VADDB000             * Table of Transfer Source Codes
          GOTO      PVAD9999             * List by Description
.
PVAD1200  MATCH     PTVASDAT,SP70        * Start Date
          GOTO      PVAD9999 IF EQUAL
.
          UNPACK    PTVASDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PVAD9999
.
PVAD1300  WRITE     HTMLFILE;PTVASUPD;   * Start Date Auto Update    
          GOTO      PVAD9999
.
PVAD1400  MATCH     PTVAEDAT,SP70        * End Date
          GOTO      PVAD9999 IF EQUAL
.
          UNPACK    PTVAEDAT,CCENT,CYEAR,CMON,CDAY
          MOVE      CMON,F2
          LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
          WRITE     HTMLFILE;CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR;
          GOTO      PVAD9999
.
PVAD1500  WRITE     HTMLFILE;PTVAEUPD;   * End Date Auto Update      
          GOTO      PVAD9999
.
PVAD1600  WRITE     HTMLFILE;PTVAPROV;   * Provider Number             *I-57547
          GOTO      PVAD9999
.
PVAD1700  WRITE     HTMLFILE;PTVAPNAM;   * Provider Name
          GOTO      PVAD9999
.
PVAD1800  WRITE     HTMLFILE;PTVAPPCD;   * Provider Postcode
          GOTO      PVAD9999
.
PVAD1900  WRITE     HTMLFILE;PTVADTYP;   * Destination Type 
          GOTO      PVAD9999
.
PVAD2000  MOVE      ONE,LINK2PRT         * Link to Parent
          MOVE      ZERO,ACTVFLAG        * Do not display inactive codes
          CALL      VADKY000             * Table of Transfer Source Codes
          GOTO      PVAD9999             * keyword search
.
PVAD2100  WRITE     HTMLFILE;PTVACNME;   * Coded Name
          GOTO      PVAD9999
.
PVAD2200  WRITE     HTMLFILE;KEYWORDS;   * Keywords for keyword search
          GOTO      PVAD9999
.
PVAD2300  MOVE      ZERO,LINK2PRT        * Link to alternate Program
          MOVE      ONE,ACTVFLAG         * Yes display inactive codes
          CALL      VADKY000             * Table of Transfer Source Codes
          GOTO      PVAD9999             * List by Code
.
PVAD2400  WRITE     HTMLFILE;PTVAESTB;   * Establishment Number
          GOTO      PVAD9999
.
PVAD2500  MOVE      ONE,LINK2PRT         * Link to Parent
          MOVE      ZERO,ACTVFLAG        * Do not display inactive codes
          CALL      VADOP000             * Table of Transfer Source Codes
          GOTO      PVAD9999
.
PVAD9999  RETURN
.-----------------------------------------------------------
. Link to Another Program
.-----------------------------------------------------------
LNKPRO00  UNPACK    DIM127,D1,KEY8,DIM127
          UNPACK    DIM127,D1,KEY2,DIM127
          UNPACK    DIM127,D1,FLDPARA,DIM127
.
          REP       " +",STARTKEY
.
          WRITE     HTMLFILE;KEY8,".pbl?reportno=",KEY2:
                                   "&template=",FLDPARA:
                                   "&startkey=",STARTKEY;
.
          REP       "+ ",STARTKEY
.
LNKPRO99  RETURN
.-------------------------------------------------------------------------------
. Link to Alternate Page
.-------------------------------------------------------------------------------
LNKDET00  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127 
.
          REP       " +",TEMPLATE
          REP       " +",WBLID001
          REP       " +",WBPAG001
          REP       " +",WBLDT001
.
          WRITE     HTMLFILE;LINKPRG,".pbl?reportno=",LINKREP:
                                         "&template=",LINKTEM:
                                         "&wblid001=",WBLID001:
                                         "&wbpag001=",WBPAG001:
                                         "&wbldt001=",WBLDT001;
.
          REP       "+ ",TEMPLATE
          REP       "+ ",WBLID001
          REP       "+ ",WBPAG001
          REP       "+ ",WBLDT001
.
LNKDET99  RETURN
.-----------------------------------------------------------
. Link to Next Group of ID's
.-----------------------------------------------------------
NEXTID00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM+NORECORD,F3
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
          REP       " +",LOOKID
          REP       " +",PAGENO
.           
          WRITE     HTMLFILE;"patweb91.pbl":
                                 "?reportno=",F1:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&wblid001=",LOOKID:
                                 "&wbpag001=",PAGENO;
.
          REP       "+ ",LOOKID  
          REP       "+ ",PAGENO  
.
NEXTID99  RETURN
.-------------------------------------------------------------
. Link to Prev Group of ID's
.-------------------------------------------------------------
PREVID00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM-NORECORD,F3
          IF        F3<0
            MOVE      ZERO,F3
          ENDIF
          MOVE      F3,KEY3
          REP       " +",KEY3
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
          REP       " +",LOOKID
          REP       " +",PAGENO
.          
          WRITE     HTMLFILE;"patweb91.pbl":
                                 "?reportno=",F1:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY3:
                                 "&norecord=",KEY2:
                                 "&wblid001=",LOOKID:
                                 "&wbpag001=",PAGENO;
.
          REP       "+ ",LOOKID  
          REP       "+ ",PAGENO  
.
PREVID99  RETURN
.-----------------------------------------------------------
. Link to Next Group
.-----------------------------------------------------------
NEXTGR00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM+NORECORD,F4
          MOVE      F4,KEY4
          REP       " +",KEY4
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
.
          REP       " +",STARTKEY
          REP       " +",STARTKY1
.
          REP       " +",CURRCODE
          REP       " +",ADMSOURC
          REP       " +",DDSTTYPE
          REP       " +",ADMSOCAT
          REP       " +",OUTCPRTY
          REP       " +",OUTCOMEC
.
          REP       "'~",STARTKEY
          REP       "'~",STARTKY1
          REP       "'~",KEYWORDS
.           
          WRITE     HTMLFILE;"patweb91.pbl":
                                 "?reportno=",F1:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY4:
                                 "&norecord=",KEY2:
                                 "&startkey=",STARTKEY:
                                 "&ptcod001=",CURRCODE:
                                 "&startky1=",STARTKY1:
                                 "&admsourc=",ADMSOURC:
                                 "&ddsttype=",DDSTTYPE:
                                 "&admsocat=",ADMSOCAT:
                                 "&outcprty=",OUTCPRTY:
                                 "&outcomec=",OUTCOMEC:
                                 "&codestat=",CODESTAT:
                                 "&keywords=",KEYWORDS;
.
          MATCH     "1",MENUFLAG
          IF        @EQUAL
            WRITE     HTMLFILE;"&menuflag=1";
          ENDIF
.
          REP       "+ ",STARTKEY
          REP       "+ ",STARTKY1
          REP       "+ ",CURRCODE
          REP       "+ ",ADMSOURC
          REP       "+ ",DDSTTYPE
          REP       "+ ",ADMSOCAT
          REP       "~'",STARTKEY
          REP       "~'",KEYWORDS
          REP       "+ ",OUTCPRTY
          REP       "+ ",OUTCOMEC
.
NEXTGR99  RETURN
.-------------------------------------------------------------
. Link to Prev Group
.-------------------------------------------------------------
PREVGR00  MOVE      NORECORD,KEY2
          REP       " +",KEY2
          ASSIGN    STARTNUM-NORECORD,F4
          IF        F4<0
            MOVE      ZERO,F4
          ENDIF
          MOVE      F4,KEY4
          REP       " +",KEY4
          UNPACK    DIM127,D1,FLDPARA,DIM127
          MOVE      REPORTNO,F1
.
          REP       " +",STARTKEY
          REP       " +",STARTKY1
.
          REP       " +",CURRCODE
          REP       " +",ADMSOURC
          REP       " +",DDSTTYPE
          REP       " +",ADMSOCAT
          REP       " +",OUTCPRTY
          REP       " +",OUTCOMEC
.
          REP       "'~",STARTKEY
          REP       "'~",STARTKY1
          REP       "'~",KEYWORDS
.          
          WRITE     HTMLFILE;"patweb91.pbl":
                                 "?reportno=",F1:
                                 "&template=",FLDPARA:
                                 "&startnum=",KEY4:
                                 "&norecord=",KEY2:
                                 "&startkey=",STARTKEY:
                                 "&ptcod001=",CURRCODE:
                                 "&startky1=",STARTKY1:
                                 "&admsourc=",ADMSOURC:
                                 "&ddsttype=",DDSTTYPE:
                                 "&admsocat=",ADMSOCAT:
                                 "&outcprty=",OUTCPRTY:
                                 "&outcomec=",OUTCOMEC:
                                 "&codestat=",CODESTAT:
                                 "&keywords=",KEYWORDS;
.
          MATCH     "1",MENUFLAG
          IF        @EQUAL
            WRITE     HTMLFILE;"&menuflag=1";
          ENDIF
.
          REP       "+ ",STARTKEY
          REP       "+ ",STARTKY1
          REP       "+ ",CURRCODE
          REP       "+ ",ADMSOURC
          REP       "+ ",DDSTTYPE
          REP       "+ ",ADMSOCAT
          REP       "~'",STARTKEY
          REP       "~'",KEYWORDS
          REP       "+ ",OUTCPRTY
          REP       "+ ",OUTCOMEC
.
PREVGR99  RETURN
.------------------------------------------------------------
. Table of Lookup ID's 
.------------------------------------------------------------
LKTAB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      LKHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY8,STARTKEY,SP70
          CALL      RSWBLI1
          IF        OVRCD=0
            CALL      RPWBLI1 
          ENDIF
LKTAB100  CALL      RKWBLI1
          BRANCH    OVRCD,LKTAB900
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      LKTAB100
          ENDIF
.
          CALL      LKROW000      * Display Lookup ID Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      LKTAB100 IF NOT EQUAL
.
          GOTO      LKTAB999
.
LKTAB900  CALL      NOMORE00       * Display No More Records Message
.
LKTAB999  RETURN
.------------------------------------------------------------
. Lookup ID (TABLE HEADING)
.------------------------------------------------------------
LKHED000  WRITE     HTMLFILE;"<tr>":
                             "<td class=HeadingCell width=20%>Code</td>":
                             "<td class=HeadingCell width=40%>Description":
                             "</b></td>":
                             "</tr>"
.
LKHED999  RETURN
.------------------------------------------------------------
. Lookup ID (TABLE ROW)
.------------------------------------------------------------
LKROW000  MATCH     SP70,WBLIDESC
          IF        @EQUAL
            MOVE      "&nbsp;",WBLIDESC
          ENDIF
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail03":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&wblid001=",WBLILKID,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             WBLILKID,"</td>":
                             "<td>",WBLIDESC,"</td>":
                             "</tr>"
.
LKROW999 RETURN
.------------------------------------------------------------
. Table of Lookup Page's 
.------------------------------------------------------------
LKPGT000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      LPGHD000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY11,WBLILKID,STARTKEY,SP70
          CALL      RSWBLP1
          IF        OVRCD=0
            CALL      RPWBLP1
          ENDIF
LKPGT100  CALL      RKWBLP1
          BRANCH    OVRCD,LKPGT900
          MATCH     WBLILKID,WBLPLKID
          GOTO      LKPGT900 IF NOT EQUAL
          MATCH     SP70,WBLPPGNO
          GOTO      LKPGT100 IF EQUAL          
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      LKPGT100
          ENDIF
.
          CALL      LPROW000      * Display Lookup Page Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      LKPGT100 IF NOT EQUAL
.
          GOTO      LKPGT999
.
LKPGT900  CALL      NOMORE00      * Display No More Records Message
.
LKPGT999  RETURN
.------------------------------------------------------------
. Lookup Page (TABLE HEADING)
.------------------------------------------------------------
LPGHD000  WRITE     HTMLFILE;"<tr>":
                             "<td class=HeadingCell width=10%>Page No.":
                             "</td>":
                             "<td class=HeadingCell width=20%>Page Title":
                             "</td>":
                             "<td class=HeadingCell width=20%>Page Heading":
                             "</td>":
                             "</tr>"
.
LPGHD999  RETURN
.------------------------------------------------------------
. Lookup Page (TABLE ROW)
.------------------------------------------------------------
LPROW000  MATCH     SP70,WBLPTITL
          IF        @EQUAL
            MOVE      "&nbsp;",WBLPTITL
          ENDIF
.
          MATCH     SP70,WBLPHEAD
          IF        @EQUAL
            MOVE      "&nbsp;",WBLPHEAD
          ENDIF
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail04":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&wblid001=",WBLPLKID:
                             "&wbpag001=",WBLPPGNO,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             WBLPPGNO,"</td>":
                             "<td>",WBLPTITL,"</td>":
                             "<td>",WBLPHEAD,"</td>":
                             "</tr>"
.
LPROW999 RETURN
.------------------------------------------------------------
. Table of Lookup Details 
.------------------------------------------------------------
LKDET000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      LDETH000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY14,WBLPLKID,WBLPPGNO,STARTKEY,SP70
          CALL      RSWBLD1
          IF        OVRCD=0
            CALL      RPWBLD1
          ENDIF
LKDET100  CALL      RKWBLD1
          BRANCH    OVRCD,LKDET900
          MATCH     WBLPLKID,WBLDLKID
          GOTO      LKDET900 IF NOT EQUAL
          MATCH     WBLPPGNO,WBLDPAGE
          GOTO      LKDET900 IF NOT EQUAL

          MATCH     SP70,WBLDUQID
          GOTO      LKDET100 IF EQUAL          
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      LKDET100
          ENDIF
.
          CALL      LDROW000      * Display Lookup Page Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      LKDET100 IF NOT EQUAL
.
          GOTO      LKDET999
.
LKDET900  CALL      NOMORE00       * Display No More Records Message
.
LKDET999  RETURN
.------------------------------------------------------------
. Lookup Details (TABLE HEADING)
.------------------------------------------------------------
LDETH000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell>Unique ID</td>":
                               "<td class=HeadingCell>Code</td>":
                               "<td class=HeadingCell>Decription</td>":
                               "<td class=HeadingCell>Active</td>":
                               "<td class=HeadingCell>Type</td>":
                             "</tr>"
.
LDETH999  RETURN
.------------------------------------------------------------
. Lookup Details (TABLE ROW)
.------------------------------------------------------------
LDROW000  MATCH     SP70,WBLDCODE
          IF        @EQUAL
            MOVE      "&nbsp;",WBLDCODE
          ENDIF
.
          MATCH     SP70,WBLDDESC
          IF        @EQUAL
            MOVE      "&nbsp;",WBLDDESC
          ENDIF
.
          PACK      TYPEDESC,LINK,WBLDLKPG 
          MATCH     "1",WBLDTYPE
          IF        @EQUAL
            MOVE      "Detail",TYPEDESC
          ENDIF
.
          MATCH     "2",WBLDTYPE
          IF        @EQUAL
            MOVE      "Checkbox",TYPEDESC
          ENDIF
.
          MATCH     "0",WBLDACTV
          IF        @EQUAL
            MOVE      "No",ACTVDESC
          ELSE
            MOVE      "Yes",ACTVDESC
          ENDIF
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail05":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&wblid001=",WBLDLKID:
                             "&wbpag001=",WBLDPAGE:
                             "&wbldt001=",WBLDUQID,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             WBLDUQID,"</td>":
                             "<td>",WBLDCODE,"</td>":
                             "<td>",WBLDDESC,"</td>":
                             "<td>",ACTVDESC,"</td>":
                             "<td>",TYPEDESC,"</td>":
                             "</tr>"
.
LDROW999 RETURN
.------------------------------------------------------------
. Table of Categories by Category 
.------------------------------------------------------------
CATCT000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      CTHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY5,SP3,STARTKEY,SP70
          CALL      RDCODE3
          IF        OVRCD=0
            CALL      RDPCODE3
          ENDIF 
CATCT100  CALL      RDKCODE3
          BRANCH    OVRCD,CATCT900        * Display No More Records Message
.
          MATCH     SP70,ACODE
          GOTO      CATCT900 IF NOT EQUAL          
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      CATCT100
          ENDIF
.
          CALL      CTROW000      * Display Category Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      CATCT100 IF NOT EQUAL
.
          GOTO      CATCT999
.
CATCT900  CALL      NOMORE00
.
CATCT999  RETURN
.------------------------------------------------------------
. Table of Categories by Description 
.------------------------------------------------------------
CATDS000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      CTHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY25,SP3,STARTKEY,SP70
          CALL      RDSCODE4 
          IF        OVRCD=0
            CALL      RDPCODE4
          ENDIF 
CATDS100  CALL      RDKCODE4
          BRANCH    OVRCD,CATDS900
.
          MATCH     SP70,ACODE
          GOTO      CATDS900 IF NOT EQUAL          
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      CATDS100
          ENDIF
.
          CALL      CTROW000      * Display Category Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      CATDS100 IF NOT EQUAL
.
          GOTO      CATDS999
.
CATDS900  CALL      NOMORE00       * Display No More Records Message
.
CATDS999  RETURN
.------------------------------------------------------------
. Category Maintenance (TABLE HEADING)
.------------------------------------------------------------
CTHED000  WRITE     HTMLFILE;"<tr>":
                             "<td class=HeadingCell width=20%>Category":
                             "</td>":
                             "<td class=HeadingCell width=40%>Description":
                             "</td>":
                             "<td class=HeadingCell width=20%>HDP Default":
                             "</td>";
.
          IF        IBCNMHOS=1
            WRITE     HTMLFILE;"<td class=HeadingCell width=20%>":
                               "Hospital Specific</td>";
          ENDIF
.
          WRITE     HTMLFILE;"</tr>"
.
CTHED999  RETURN
.------------------------------------------------------------
. Category Maintenance (TABLE ROW)
.------------------------------------------------------------
CTROW000  MATCH     SP70,TDESC
          IF        @EQUAL
            MOVE      "&nbsp;",TDESC
          ENDIF
.
          MOVE      THCSCOD,KEY6
          MATCH     SP70,THCSCOD
          IF        @EQUAL
            MOVE      "&nbsp;",KEY6
          ENDIF
.
          BRANCH    LNK2PRT,CTROW100
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail01":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM;
.
          MATCH     "1",MENUFLAG
          IF        @EQUAL
            WRITE     HTMLFILE;"&menuflag=1";
          ENDIF
.
          WRITE     HTMLFILE;"&ptcod001=",TCODE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             TCODE,"</td>":
                             "<td>",TDESC,"</td>":
                             "<td>",KEY6,"</td>";
.
          IF        IBCNMHOS=1
            MATCH     "1",PTCDHOSS
            IF        @EQUAL
              WRITE     HTMLFILE;"<td>",DYES,"</td>";
            ELSE
              WRITE     HTMLFILE;"<td>",DNO,"</td>";
            ENDIF
          ENDIF
.
          WRITE     HTMLFILE;"</tr>";
.
          GOTO      CTROW999  
.
CTROW100  WRITE     HTMLFILE;"<tr valign=top>":
                              "<td><a href=#"#" ":
                              "OnClick=#"UpdateParent01('",TCODE:
                              "','",TDESC,"')#">":
                              "<img src=../images/MaintenanceIcon.gif hspace=4":
                              " border=0 align=absmiddle></a>":
                              TCODE,"</td>":
                              "<td>",TDESC,"</td>":
                              "<td>",KEY6,"</td>";
.
          IF        IBCNMHOS=1
            MATCH     "1",PTCDHOSS
            IF        @EQUAL
              WRITE     HTMLFILE;"<td>",DYES,"</td>";
            ELSE
              WRITE     HTMLFILE;"<td>",DNO,"</td>";
            ENDIF
          ENDIF
.
          WRITE     HTMLFILE;"</tr>"
.
CTROW999  RETURN
.
.------------------------------------------------------------
. NOMORE00 - Display "No more records" at end of list
.------------------------------------------------------------
NOMORE00  WRITE     HTMLFILE;"<tr>":
                             "<td class=RedCell colspan=20 align=center>":
                             "No more records</td>"
.
NOMORE99  RETURN
.
.------------------------------------------------------------
. Table of Codes by Code 
.------------------------------------------------------------
CODCD000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      CDHED000      * Output Table Heading
.
CODCD015  IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          CALL      CHKSEC00              * check category security
.
          PACK      KEY5,PTCOD001,STARTKEY,SP70
          CALL      RDCODE1 
          IF        OVRCD=0
            CALL      RDPCODE1
          ENDIF
CODCD100  CALL      RDKCODE1
          BRANCH    OVRCD,CODCD900
          MATCH     PTCOD001,TCODE
          GOTO      CODCD900 IF NOT EQUAL          
          MATCH     SP70,ACODE
          GOTO      CODCD100 IF EQUAL          
.
          MATCH     ANSI,CODESTAT
          IF        @EQUAL
            MATCH     PTCOACTV,ANSI 
            GOTO      CODCD100 IF NOT EQUAL    * Check InActive Status
          ENDIF
.
          MATCH     ANSA,CODESTAT
          IF        @EQUAL
            MATCH     PTCOACTV,ANSI 
            GOTO      CODCD100 IF EQUAL        * Check Active Status
          ENDIF
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      CODCD100
          ENDIF
.
          CALL      CDROW000      * Display Category Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      CODCD100 IF NOT EQUAL
.
          GOTO      CODCD999
.
CODCD900  CALL      NOMORE00       * Display No More Records Message
.
CODCD999  RETURN
+
.------------------------------------------------------------
. Check category security
. (returns DISABLED: 1=code editing disabled / 0=not disabled)
.------------------------------------------------------------
CHKSEC00  MOVE      "99 ",KEY3            * check admin group is set up
          CALL      RDIBCGS1
          BRANCH    OVRCD,CHKSEC90        * functionality not set up
.
          MOVE      "99 ",KEY3            * check for admin rights for user
          PACK      KEY13,KEY3,USERID,SP70
          CALL      RDIBCUS1
          COMPARE   ZERO,OVRCD
          GOTO      CHKSEC90 IF EQUAL     * user has admin rights
.
          MOVE      PTCOD001,KEY2
          PACK      KEY5,KEY2,SP70
          CALL      RSIBCCS2
CHKSEC10  CALL      RKIBCCS2
          BRANCH    OVRCD,CHKSEC90        * category has no security
.
          MATCH     KEY2,IBCCCATG
          GOTO      CHKSEC90 IF NOT EQUAL * category has no security
.
.         Security exists. Check what groups are set up against this category.
.
          MOVE      PTCOD001,KEY2
          PACK      KEY5,KEY2,SP70
          CALL      RSIBCCS2
CHKSEC50  CALL      RKIBCCS2              * loop through category security file
          BRANCH    OVRCD,CHKSEC95        * no more groups to check, so disable
.
          MATCH     KEY2,IBCCCATG
          GOTO      CHKSEC95 IF NOT EQUAL  * no more groups against this categ.
.
.         Now check if the user has permission to edit the category.
.
          PACK      KEY13,IBCCSGRP,USERID,SP70
          CALL      RDIBCUS1
          COMPARE   ZERO,OVRCD
          GOTO      CHKSEC90 IF EQUAL     * user can edit this category
.
          GOTO      CHKSEC50
.
CHKSEC90  MOVE      ZERO,DISABLED         * allow code editing
          GOTO      CHKSEC99
.
CHKSEC95  MOVE      ONE,DISABLED          * don't allow code editing
CHKSEC99  RETURN
+
.------------------------------------------------------------
. Table of Codes by Description 
.------------------------------------------------------------
CODDS000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      CDHED000      * Output Table Heading
.
CODDS005  IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          CALL      CHKSEC00              * check category security
.
          PACK      PTCDKEY2,PTCOD001,STARTKEY,SP70
          CALL      RDSCODE2 
          IF        OVRCD=0
            CALL      RDPCODE2
          ENDIF
CODDS100  CALL      RDKCODE2
          BRANCH    OVRCD,CODDS900
          MATCH     PTCOD001,TCODE
          GOTO      CODDS900 IF NOT EQUAL          
          MATCH     SP70,ACODE
          GOTO      CODDS100 IF EQUAL          
.
          MATCH     ANSI,CODESTAT
          IF        @EQUAL
            MATCH     PTCOACTV,ANSI
            GOTO      CODDS100 IF NOT EQUAL    * Check InActive Status
          ENDIF
.
          MATCH     ANSA,CODESTAT
          IF        @EQUAL
            MATCH     PTCOACTV,ANSI
            GOTO      CODDS100 IF EQUAL        * Check Active Status
          ENDIF
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      CODDS100
          ENDIF
.
          CALL      CDROW000      * Display Category Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      CODDS100 IF NOT EQUAL
.
          GOTO      CODDS999
.
CODDS900  CALL      NOMORE00      * Display No More Records Message
.
CODDS999  RETURN
.------------------------------------------------------------
. Code Record Maintenance (TABLE HEADING)
.------------------------------------------------------------
.* ****************************************** Start of Addition        *I-55095
CDHED000  MOVE      "HDP Default",COL3HEAD  * Standard column headings
          MOVE      "HCP Equivalent",COL7HEAD
          MOVE      "Associated No.",COL8HEAD
.
          MATCH     "BK",PTCOD001
          GOTO      CDHED100 IF EQUAL
          MATCH     "BT",PTCOD001
          GOTO      CDHED200 IF EQUAL
          MATCH     "J ",PTCOD001
          GOTO      CDHED300 IF EQUAL
          GOTO      CDHED500
.
.                                           * Headings for Cat."BK"
CDHED100  MOVE      "Booking Type",COL3HEAD
          MOVE      SP20,COL7HEAD
          GOTO      CDHED500
.                                           * Headings for Cat."BT"
CDHED200  MOVE      "Room Type",COL8HEAD
          GOTO      CDHED500
.                                           * Headings for Cat."J "
CDHED300  MOVE      "Journal Type",COL3HEAD
          MOVE      SP20,COL7HEAD
          GOTO      CDHED500
.* ******************************************   End of Addition        *I-55095
.
CDHED500  WRITE     HTMLFILE;"<tr>":
                             "<td class=HeadingCell width=8%>Actual Code":
                             "</td>":
                             "<td class=HeadingCell width=20%>Description":
                             "</td>":
                             "<td class=HeadingCell width=8%>",COL3HEAD:
                             "</td>":
                             "<td class=HeadingCell width=5%>Active":
                             "</td>":
                             "<td class=HeadingCell width=8%>Default Code":
                             "</td>":
                             "<td class=HeadingCell>Indicators":
                             "</td>":
                             "<td class=HeadingCell width=10%>",COL7HEAD:
                             "</td>":
                             "<td class=HeadingCell width=10%>",COL8HEAD:
                             "</td>";
.
          IF        IBCNMHOS=1
            WRITE     HTMLFILE;"<td class=HeadingCell width=10%>":
                               "Hospital Specific</td>";
          ENDIF
.
          WRITE     HTMLFILE;"</tr>"
.
CDHED999  RETURN
.------------------------------------------------------------
. Code Record Maintenance (TABLE ROW)
.------------------------------------------------------------
CDROW000  MATCH     SP70,TDESC
          IF        @EQUAL
            MOVE      "&nbsp;",TDESC
          ENDIF
.
          MOVE      THCSCOD,KEY6
          MATCH     SP70,THCSCOD
          IF        @EQUAL
            MOVE      "&nbsp;",KEY6
          ENDIF
.
          MOVE      "No ",KEY3
.
          MATCH     ANSA,PTCOACTV
          IF        @EQUAL
            MOVE      "Yes",KEY3
          ENDIF
.
          MATCH     " ",PTCOACTV
          IF        @EQUAL
            MOVE      "Yes",KEY3
          ENDIF
.
          MATCH     "1",PTCDDEFT
          IF        @EQUAL
            MOVE      "Yes",D3
          ELSE
            MOVE      "No ",D3
          ENDIF
.
          PACK      TCINDC1,TCINDC1,SP70
          PACK      TCINDC2,TCINDC2,SP70
          PACK      TCINDC3,TCINDC3,SP70
          PACK      TCINDC4,TCINDC4,SP70
          PACK      TCINDC5,TCINDC5,SP70
          PACK      TCINDC6,TCINDC6,SP70
          PACK      TCINDC7,TCINDC7,SP70
          PACK      TCINDC8,TCINDC8,SP70
          PACK      TCINDC9,TCINDC9,SP70
          PACK      TCINDC10,TCINDC10,SP70
          PACK      TCINDC11,TCINDC11,SP70
          PACK      KEY41,TCINDC1,TCINDC2,TCINDC3,TCINDC4,TCINDC5:
                          TCINDC6,TCINDC7,TCINDC8,TCINDC9,TCINDC10:
                          TCINDC11,TCINDC12,TCINDC13,TCINDC14,TCINDC15:
                          TCINDC16,TCINDC17,TCINDC18,TCINDC19,TCINDC20:
                          TCINDC21,TCINDC22,TCINDC23,TCINDC24,TCINDC25:
                          TCINDC26,TCINDC27,TCINDC28,TCINDC29,TCINDC30:
                          TCINDC31,TCINDC32,TCINDC33,TCINDC34,TCINDC35:
                          TCINDC36,TCINDC37,TCINDC38,TCINDC39,TCINDC40:
                          TCINDC41
                        
          MOVE      ZERO,D6
          MOVE      TCFORM6,D6
          SQUEEZE   D6
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail02":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM;
.
          MATCH     "1",MENUFLAG
          IF        @EQUAL
            WRITE     HTMLFILE;"&menuflag=1";
          ENDIF
.
          WRITE     HTMLFILE;"&ptcod001=",TCODE:
                             "&ptcod002=",ACODE:
                             "#"",COMMA,"#"",DISABLED,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             ACODE,"</td>":
                             "<td>",TDESC,"</td>":
                             "<td><pre>",KEY6,"</td></pre>":
                             "<td>",KEY3,"</td>":
                             "<td>",D3,"</td>":
                             "<td><pre>",KEY41,"</td></pre>":
                             "<td><pre>",PTCDNHCP,"</td></pre>":
                             "<td><pre>",D6,"</td></pre>";
.
          IF        IBCNMHOS=1
            MATCH     "1",PTCDHOSS
            IF        @EQUAL
              WRITE     HTMLFILE;"<td>",DYES,"</td>";
            ELSE
              WRITE     HTMLFILE;"<td>",DNO,"</td>";
            ENDIF
          ENDIF
.
          WRITE     HTMLFILE;"</tr>"
.
CDROW999 RETURN
.------------------------------------------------------------
. Table of Transfer Source Codes - List by code 
.------------------------------------------------------------
VADTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      VDHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY5,STARTKEY,SP70
          CALL      RSPTVAD1 
          IF        OVRCD=0
            CALL      RPPTVAD1
          ENDIF
VADTB100  CALL      RKPTVAD1
          BRANCH    OVRCD,VADTB900
.
.         MATCH     ANSI,PTVAACTV
.         GOTO      VADTB100 IF EQUAL
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      VADTB100
          ENDIF
.
          CALL      VDROW000      * Display Transfer Code Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      VADTB100 IF NOT EQUAL
.
          GOTO      VADTB999
.
VADTB900  CALL      NOMORE00       * Display No More Records Message
.
VADTB999  RETURN
.
.------------------------------------------------------------
. Table of Transfer Source Codes - List by Description
.------------------------------------------------------------
VADKY000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      VDHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD        * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          CALL      GETWRD00                * Get keywords
.
VADKY050  STRIP     KEYWRD01
          PACK      KEY35,KEYWRD01,SP70
          CALL      RSPMVKI2
VADKY100  CALL      RKPMVKI2
          BRANCH    OVRCD,VADKY900
.
          PACK      KEY5,PMVKCODE,SP70
          CALL      RDPTVAD1
          BRANCH    OVRCD,VADKY100
.
          CALL      VADKYA00
          BRANCH    EXIT,VADKY100,VADKY900
.
          BRANCH    ACTVFLAG,VADKY110       * 1 = Yes display inactive codes
.
          MATCH     ANSI,PTVAACTV
          GOTO      VADKY100 IF EQUAL
.
VADKY110  MATCH     SP70,ADMSOURC
          IF        !@EQUAL

            MATCH     SP70,ADMSOCAT
            IF        !@EQUAL
              PACK      KEY5,ADMSOCAT,ADMSOURC,SP70
              CALL      RDCODE1
              IF        OVRCD<>1
                MATCH     SP70,TCINDC7
                IF        !@EQUAL
                  MATCH     TCINDC7,PTVADTYP
                  GOTO      VADKY100 IF NOT EQUAL
                ENDIF
              ENDIF
            ELSE
              PACK      KEY5,ANSS,SP1,ADMSOURC,SP70
              CALL      RDCODE1
              IF        OVRCD<>1
                MATCH     SP70,TCINDC7
                IF        !@EQUAL
                  MATCH     TCINDC7,PTVADTYP
                  GOTO      VADKY100 IF NOT EQUAL
                ENDIF
              ENDIF
            ENDIF
          ENDIF  
.
          MATCH     SP70,OUTCPRTY
          IF        !@EQUAL
            PACK      KEY5,ANSA,ANSO,OUTCPRTY,SP70
            CALL      RDCODE1
            IF        OVRCD<>1
              MATCH     SP70,TCINDC12
              IF        !@EQUAL
                MATCH     TCINDC12,PTVADTYP
                GOTO      VADKY100 IF NOT EQUAL
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,OUTCOMEC                 * Outcome code?
          IF        !@EQUAL
            PACK      KEY5,Cat_OZ,OUTCOMEC,SP70
            CALL      RDCODE1
            IF        OVRCD<>1
              MATCH     SP70,TCINDC12
              IF        !@EQUAL
                MATCH     TCINDC12,PTVADTYP       * match Destination Type
                GOTO      VADKY100 IF NOT EQUAL
              ENDIF
            ENDIF
          ENDIF
.
VADKY600  MATCH     SP70,DDSTTYPE                * Discharge Destination Type
          IF        !@EQUAL
            MATCH     DDSTTYPE,PTVADTYP
            GOTO      VADKY100 IF NOT EQUAL
          ENDIF
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      VADKY100
          ENDIF
.
          CALL      VDROW000      * Display Transfer Code Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      VADKY100 IF NOT EQUAL
.
          GOTO      VADKY999
.
VADKY900  CALL      NOMORE00           * Display No More Records Message
.
VADKY999  RETURN
+
.------------------------------------------------------------------------------
.                   Table of Transfer Source Codes - List by Description
.
.         Filter by Outcome (Category 'OZ'); where Indicator 12 = PTVADTYP
.         Uses ADMSOURC field (passed in) for the Outcome code.
.------------------------------------------------------------------------------
VADOP000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      VDHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          CALL      GETWRD00                * Get keywords
.
          STRIP     KEYWRD01
          PACK      KEY35,KEYWRD01,SP70
          CALL      RSPMVKI2
VADOP100  CALL      RKPMVKI2
          BRANCH    OVRCD,VADOP999
.
          PACK      KEY5,PMVKCODE,SP70
          CALL      RDPTVAD1
          BRANCH    OVRCD,VADOP100
.
          CALL      VADKYA00
          BRANCH    EXIT,VADOP100,VADOP999
.
          BRANCH    ACTVFLAG,VADOP110       * 1 = Yes display inactive codes
.
          MATCH     ANSI,PTVAACTV
          GOTO      VADOP100 IF EQUAL
.
VADOP110  MATCH     SP70,ADMSOURC
          IF        !@EQUAL
            PACK      KEY5,Cat_OZ,ADMSOURC,SP70
            CALL      RDCODE1
            IF        OVRCD<>1
              MATCH     SP70,TCINDC12
              IF        !@EQUAL
                MATCH     TCINDC12,PTVADTYP       * match Destination Type
                GOTO      VADOP100 IF NOT EQUAL
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,OUTCPRTY
          IF        !@EQUAL
            PACK      KEY5,ANSA,ANSO,OUTCPRTY,SP70
            CALL      RDCODE1
            IF        OVRCD<>1
              MATCH     SP70,TCINDC12
              IF        !@EQUAL
                MATCH     TCINDC12,PTVADTYP
                GOTO      VADOP100 IF NOT EQUAL
              ENDIF
            ENDIF
          ENDIF
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      VADOP100
          ENDIF
.
          CALL      VDROW000      * Display Transfer Code Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      VADOP100 IF NOT EQUAL
.
VADOP999  RETURN
+
.------------------------------------------------------------
. Check Record
.------------------------------------------------------------
VADKYA00  MATCH     KEYWRD01,PMVKKKWD
          GOTO      VADKYA92 IF NOT EQUAL
.
          IF        KEYWRDNO>1
            PACK      SAVKEY35,PMVKKKWD,PMVKCODE
            CALL      VADKYB00
            BRANCH    EXIT,VADKYA91
.
            MOVE      SAVKEY35,KEY35
            CALL      RDPMVKI2
          ENDIF
.
          MOVE      ZERO,EXIT
          GOTO      VADKYA99
.
VADKYA91  MOVE      ONE,EXIT
          GOTO      VADKYA99
.
VADKYA92  MOVE      TWO,EXIT
.
VADKYA99  RETURN
.
.------------------------------------------------------------
. Check for Matching Words
.------------------------------------------------------------
VADKYB00  MOVE      ONE,F2
          MOVE      ZERO,EXIT
          PACK      SAVEKEY5,PTVACODE,SP70
.
VADKYB10  COMPARE   KEYWRDNO,F2           * Loop through each Key Word in Search
          GOTO      VADKYB99 IF EQUAL     * Exit OK
          ADD       ONE,F2
          LOAD      KEYWRDXX,F2,KEYWRD01,KEYWRD02,KEYWRD03,KEYWRD04,KEYWRD05:
                                KEYWRD06,KEYWRD07,KEYWRD08,KEYWRD09,KEYWRD10
.
          PACK      KEY35,PTVACODE,KEYWRDXX
          CALL      RDPMVKI1                * Check for Exact Match
          COMPARE   ZERO,OVRCD              * Ok so Continue Loop
          GOTO      VADKYB10 IF EQUAL
.
          CALL      RKPMVKI1                * Not Exact so Read Next Record
          BRANCH    OVRCD,VADKYB90          * No Match So Exit No Match
.
          PACK      KEY5,PMVKCODE,SP70
.
          MATCH     SAVEKEY5,KEY5           * Match Key Fields
          GOTO      VADKYB90 IF NOT EQUAL   * No Match So Exit
.
          STRIP     KEYWRDXX
.
          MATCH     PMVKKKWD,KEYWRDXX       * Check Key Word
          GOTO      VADKYB90 IF NOT EQUAL   * No Match So Exit
          GOTO      VADKYB10                * Check Next Search Word
.
VADKYB90  MOVE      ONE,EXIT
.
VADKYB99  RETURN
.
.------------------------------------------------------------
. Table of Transfer Source Codes - List by Description
.------------------------------------------------------------
VADDB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      VDHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY35,STARTKEY,SP70
          CALL      RSPTVAD2 
          IF        OVRCD=0
            CALL      RPPTVAD2
          ENDIF
VADDB100  CALL      RKPTVAD2
          BRANCH    OVRCD,VADDB900
.
          BRANCH    ACTVFLAG,VADDB110       * 1 = Yes display inactive codes
.
          MATCH     ANSI,PTVAACTV
          GOTO      VADDB100 IF EQUAL
.
VADDB110  MATCH     SP70,ADMSOURC
          IF        !@EQUAL
            PACK      KEY5,ANSS,SP1,ADMSOURC,SP70
            CALL      RDCODE1
            IF        OVRCD<>1
              MATCH     SP70,TCINDC7
              IF        !@EQUAL
                MATCH     TCINDC7,PTVADTYP
                GOTO      VADDB100 IF NOT EQUAL
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,OUTCPRTY
          IF        !@EQUAL
            PACK      KEY5,ANSA,ANSO,OUTCPRTY,SP70
            CALL      RDCODE1
            IF        OVRCD<>1
              MATCH     SP70,TCINDC12
              IF        !@EQUAL
                MATCH     TCINDC12,PTVADTYP
                GOTO      VADDB100 IF NOT EQUAL
              ENDIF
            ENDIF
          ENDIF
.
          MATCH     SP70,OUTCOMEC                 * Outcome code?
          IF        !@EQUAL
            PACK      KEY5,Cat_OZ,OUTCOMEC,SP70
            CALL      RDCODE1
            IF        OVRCD<>1
              MATCH     SP70,TCINDC12
              IF        !@EQUAL
                MATCH     TCINDC12,PTVADTYP       * match Destination Type
                GOTO      VADDB100 IF NOT EQUAL
              ENDIF
            ENDIF
          ENDIF
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      VADDB100
          ENDIF
.
          CALL      VDROW000      * Display Transfer Code Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      VADDB100 IF NOT EQUAL
.
          GOTO      VADDB999
.
VADDB900  CALL      NOMORE00      * Display No More Records Message
.
VADDB999  RETURN
.------------------------------------------------------------
. Transfer Source Code Maintenance (TABLE HEADING)
.------------------------------------------------------------
VDHED000  WRITE     HTMLFILE;"<tr>":
                             "<td class=HeadingCell width=20%>":
                             "Transfer Code</td>":
                             "<td class=HeadingCell width=40%>":
                             "Description</td>":
                             "<td class=HeadingCell width=15%>":
                             "Start Date</td>":
                             "<td class=HeadingCell width=15%>":
                             "End Date</td>":
                             "<td class=HeadingCell width=10%>":
                             "Active</td>":
                             "</tr>"
.
VDHED999  RETURN
.------------------------------------------------------------
. Transfer Source Code Maintenance (TABLE ROW)
.------------------------------------------------------------
VDROW000  MATCH     SP70,PTVADESC
          IF        @EQUAL
            MOVE      "&nbsp;",KEY30
          ELSE
            MOVE      PTVADESC,KEY30
          ENDIF
.
          MATCH     "A",PTVAACTV
          IF        @EQUAL
            MOVE      "Yes",KEY8 
          ELSE
            MOVE      "No",KEY8  
          ENDIF
.
          MOVE      "&nbsp",DISPDAT1
          MATCH     SP70,PTVASDAT
          IF        !@EQUAL
            UNPACK    PTVASDAT,CCENT,CYEAR,CMON,CDAY
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
            PACK      DISPDAT1,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR,SP70
          ENDIF
.
          MOVE      "&nbsp",DISPDAT2
          MATCH     SP70,PTVAEDAT
          IF        !@EQUAL
            UNPACK    PTVAEDAT,CCENT,CYEAR,CMON,CDAY
            MOVE      CMON,F2
            LOAD      MTHNAM3,F2,JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
            PACK      DISPDAT2,CDAY,SP1,MTHNAM3,SP1,CCENT,CYEAR,SP70
          ENDIF
.
          BRANCH    LINK2PRT,VDROW100
.
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail08":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&patva001=",PTVACODE,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             PTVACODE,"</td>":
                             "<td>",KEY30,"</td><td>",DISPDAT1,"</td>":
                             "<td>",DISPDAT2,"</td><td>",KEY8,"</td>":
                             "</tr>"
.
          GOTO      VDROW999
.
VDROW100  MOVE      PTVADESC,FORMATNM
          CALL      JAVFMT00
          MOVE      JAVFNAME,PTVADESC
          WRITE     HTMLFILE;"<tr><td nowrap>":
                               "<A HREF='javascript:updateParent":
                               "(#"",PTVACODE,"#",#"":
                               PTVADESC,"#")'>":
                               PTVACODE,"</a></td>":
                               "<td>",KEY30,"</td><td>",DISPDAT1,"</td>":
                             "<td>",DISPDAT2,"</td><td>",KEY8,"</td>":
                             "</tr>";
.
          GOTO      VDROW999
.
VDROW999 RETURN
.
.------------------------------------------------------------
. Format Name(for Javascript)
.*** format the name by changing any ' to %60
.---------------------------------------------------------------
JAVFMT00  MOVE      SP70,JAVFNAME
.
          MOVE      FORMATNM,JAVFNAME          * name
          SCAN      "'",JAVFNAME               * find any apostrophies
          GOTO      JAVFMT99 IF NOT EQUAL
.
          MOVE      JAVFNAME,ENDNAME
          REP       "' ",ENDNAME               * remove the apostrophy
.
          LENSET    JAVFNAME
          RESET     JAVFNAME                   * get all characters before '
          MOVE      JAVFNAME,STRTNAME
.
          REP       "'%",STRTNAME
          STRIP     STRTNAME
          PACK      JAVFNAME,STRTNAME,SIXTY,ENDNAME,SP70 * formatted name
.
JAVFMT99  RETURN
.
.------------------------------------------------------------
. Post Code Maintenance
.------------------------------------------------------------
IBAPOS00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      IBAPOS40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      IBAPOS10 IF EQUAL
.
          MATCH     "U",UPDTTYPE    * Update formaction
          GOTO      IBAPOS20 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      IBAPOS30 IF EQUAL
.
          GOTO      IBAPOS93
.
.
.         ************ ADD FORMACTION ***********
.
IBAPOS10  CALL      CHKPOS00      * Checks mandatory fields
          BRANCH    EXIT,IBAPOS99
          PACK      KEY56,PTPOS001,PTPOS002,PTPOS003,SP70             *C-240184
          CALL      RDIBPOS1
          COMPARE   ZERO,OVRCD
          GOTO      IBAPOS92 IF EQUAL
.
          CALL      CLRPOS00      * Clear all the file variables
.
          CALL      POSSAV00      * Moves input variables to file variables
          PACK      KEY56,PTPOS001,PTPOS002,PTPOS003,SP70             *C-240184
          CALL      WRIBPOS1      * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      IBAPOS99
.
.         ************ UPDATE FORMACTION **********
.
IBAPOS20  PACK      KEY56,PTPOS001,PTPOS002,PTPOS003,SP70             *C-240184
          CALL      RDIBPOS1
          BRANCH    OVRCD,IBAPOS91
          CALL      CHKPOS00      * Checks mandatory fields
          BRANCH    EXIT,IBAPOS99
.
          CALL      POSSAV00      * Moves input variables to file variables
          PACK      KEY56,PTPOS001,PTPOS002,PTPOS003,SP70             *C-240184
          CALL      UPIBPOS1      * Writes away the data
.
          MOVE      ZERO,EXIT
          GOTO      IBAPOS99
.
.         ************ DELETE FORMACTION **********
.
IBAPOS30  PACK      KEY56,PTPOS001,PTPOS002,PTPOS003,SP70             *C-240184
          CALL      RDIBPOS1
          BRANCH    OVRCD,IBAPOS91
          CALL      DEIBPOS1
.
          MOVE      ZERO,EXIT
          GOTO      IBAPOS99
.
.         ************ DISPLAY FORMACTION **********
.
IBAPOS40  PACK      KEY56,PTPOS001,PTPOS002,PTPOS003,SP70             *C-240184
          CALL      RDIBPOS1
          IF        OVRCD=1
            CALL      CLRPOS00    * Clear all the file variables
          ENDIF
.
          CLEAR     WEBTITLE
          MOVE      "Post Code Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,IBAPOS99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      IBAPOS99
.
IBAPOS91  MOVE      "Post Code does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      IBAPOS99
.
IBAPOS92  MOVE      "Post Code exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      IBAPOS99
.
IBAPOS93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      IBAPOS99
.
IBAPOS99  RETURN
.
.-----------------------------------------------------------
. Initialize's file data (Post Code Maintenace)
.-----------------------------------------------------------
CLRPOS00  MOVE      SP70,IBPOPCOD
          MOVE      SP70,IBPOSUBR
          MOVE      SP70,IBPOSTAT
          MOVE      SP70,IBPOASGC
          MOVE      SP70,IBPORRAV
          MOVE      SP70,IBPOSPAR
.
CLRPOS99  RETURN
.-----------------------------------------------------------------
. Moves cgi variables into file variables (Post Code Maintenance)
.-----------------------------------------------------------------
POSSAV00  MATCH     Z70,PTPOS001
          IF        !@EQUAL
           PACK      IBPOPCOD,PTPOS001,SP10                           *C-240184
          ENDIF
.
          MATCH     Z70,PTPOS002
          IF        !@EQUAL
            MOVE      PTPOS002,IBPOSUBR
          ENDIF
.
          MATCH     Z70,PTPOS003
          IF        !@EQUAL
            MOVE      PTPOS003,IBPOSTAT
          ENDIF
.
          MATCH     Z70,PTPOS004
          IF        !@EQUAL
            MOVE      PTPOS004,IBPOASGC
          ENDIF
.
          MATCH     Z70,PTPOS005
          IF        !@EQUAL
            MOVE      PTPOS005,IBPORRAV
          ENDIF
.
POSSAV99  RETURN
.
.------------------------------------------------------------
. * Checks mandatory fields (Post Code Maintenance)
.------------------------------------------------------------
CHKPOS00  MATCH     SP70,PTPOS001
          GOTO      CHKPOS90 IF EQUAL
.
          MATCH     Z70,PTPOS001
          GOTO      CHKPOS90 IF EQUAL
.
          MATCH     SP70,PTPOS002
          GOTO      CHKPOS91 IF EQUAL
.
          MATCH     Z70,PTPOS002
          GOTO      CHKPOS91 IF EQUAL
.
          GOTO      CHKPOS98
.
CHKPOS90  MOVE      "Post Code is mandatory",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKPOS99
.

CHKPOS91  MOVE      "Suburb is mandatory",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      CHKPOS99
.
CHKPOS98  MOVE      ZERO,EXIT
CHKPOS99  RETURN
.
.------------------------------------------------------------
. Option 6 : Post Code Maintenace
.------------------------------------------------------------
IBAP0000  BRANCH    FLDITMNO,IBAP0100,IBAP0200,IBAP0300,IBAP0400,IBAP0500:
                             IBAP0600,IBAP0700,IBAP0800,IBAP0900
          GOTO      IBAP9999
.
IBAP0100  WRITE     HTMLFILE;IBPOPCOD;
          GOTO      IBAP9999
.
IBAP0200  WRITE     HTMLFILE;IBPOSUBR;
          GOTO      IBAP9999
.
IBAP0300  WRITE     HTMLFILE;IBPOSTAT;
          GOTO      IBAP9999
.
IBAP0400  CALL      POSTB000    * Table of Post Code Maintenance By post Code
          GOTO      IBAP9999
.
IBAP0500  CALL      NEXTGR00    * Next set of Codes
          GOTO      IBAP9999
.
IBAP0600  CALL      PREVGR00    * Prev set of Codes
          GOTO      IBAP9999
.
IBAP0700  WRITE     HTMLFILE;IBPOASGC;
          GOTO      IBAP9999
.
IBAP0800  CALL      POSTS000    * Table of Post Code Maintenance By Suburb
          GOTO      IBAP9999
.
IBAP0900  WRITE     HTMLFILE;IBPORRAV;
          GOTO      IBAP9999
.
IBAP9999  RETURN
.
.------------------------------------------------------------
. Table of Post Code Maintanence
.------------------------------------------------------------
POSTB000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      PSHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY56,STARTKEY,SP70                               *C-240184
          CALL      RDIBPOS1
          IF        OVRCD=0
            CALL      RPIBPOS1
          ENDIF
POSTB100  CALL      RKIBPOS1
          BRANCH    OVRCD,POSTB900
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      POSTB100
          ENDIF
.
          CALL      PSROW000      * Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      POSTB100 IF NOT EQUAL
.
          GOTO      POSTB999
.
POSTB900  CALL      NOMORE00      * Display No More Records Message
.
POSTB999  RETURN
.
.------------------------------------------------------------
. Table of Post Code Maintanence
.------------------------------------------------------------
POSTS000  UNPACK    DIM127,D1,LINKPRG,DIM127
          UNPACK    DIM127,D1,LINKREP,DIM127
          UNPACK    DIM127,D1,LINKTEM,DIM127
.
          CALL      PSHED000      * Output Table Heading
.
          IF        NORECORD=0
            MOVE      PTCNNRTD,NORECORD      * Set Default No Records to Display
          ENDIF
          MOVE      ZERO,RECNUMB
          MOVE      ZERO,DISNUMB
.
          PACK      KEY56,STARTKY1,SP70                               *C-240184
          CALL      RDIBPOS2
          IF        OVRCD=0
            CALL      RPIBPOS2
          ENDIF
POSTS100  CALL      RKIBPOS2
          BRANCH    OVRCD,POSTS900
.
          ADD       ONE,RECNUMB
          IF        STARTNUM>=RECNUMB
            GOTO      POSTS100
          ENDIF
.
          CALL      PSROW000      * Table Details Row
          ADD       ONE,DISNUMB
          COMPARE   NORECORD,DISNUMB
          GOTO      POSTS100 IF NOT EQUAL
.
          GOTO      POSTS999
.
POSTS900  CALL      NOMORE00      * Display No More Records Message
.
POSTS999  RETURN
.------------------------------------------------------------
. Post Code Maintanance Details (TABLE HEADING)
.------------------------------------------------------------
PSHED000  WRITE     HTMLFILE;"<tr>":
                               "<td class=HeadingCell width=20%>":
                               "<b>Postcode</b></td>":
                               "<td class=HeadingCell width=30%>":
                               "<b>Suburb</b></td>":
                               "<td class=HeadingCell width=20%>":
                               "<b>State</b></td>":
                               "<td class=HeadingCell width=20%>":
                               "<b>ABS / ASGC</b></td>":
                               "<td class=HeadingCell width=10%>":
                               "<b>RRAV</b></td>":
                             "</tr>"
.
PSHED999  RETURN
.------------------------------------------------------------------------------
.         Takes a Source string and produces a Destination string (triple size)
.         with URL escaped equivalents for "'" and "+".
.
.         PARAMETERS:
.           IBPOSUBR - Source string
.
.         RETURNS:
.           SUBRBNME - Destination string; with "%27"
.------------------------------------------------------------------------------
URLESC00  STRIP     IBPOSUBR
          MOVE      ZERO,CHRCOUNT
          MOVELPTR  IBPOSUBR,CHRCOUNT
.
          COMPARE   ZERO,CHRCOUNT      * Bail if zero-length source string
          GOTO      URLESC99 IF EQUAL
.
          PACK      SUBRBNME,SP70,SP70
          RESET     IBPOSUBR
          RESET     SUBRBNME
.
          MOVE      ONE,LOOPCNTR
          WHILE     LOOPCNTR <= CHRCOUNT
            CMATCH    "'",IBPOSUBR          * Single quote? replace with %27
            IF        @EQUAL
              CMOVE     "%",SUBRBNME
              BUMP      SUBRBNME
              CMOVE     "2",SUBRBNME
              BUMP      SUBRBNME
              CMOVE     "7",SUBRBNME
              BUMP      SUBRBNME
            ELSE
              CMATCH    "+",IBPOSUBR        * + (plus character)?
              IF        @EQUAL
.
.               Convert the + to ` (URL encoded %60)
.
                CMOVE     "%",SUBRBNME
                BUMP      SUBRBNME
                CMOVE     "6",SUBRBNME
                BUMP      SUBRBNME
                CMOVE     "0",SUBRBNME
                BUMP      SUBRBNME
              ELSE
                CMOVE     IBPOSUBR,SUBRBNME      * just copy char
                BUMP      SUBRBNME
              ENDIF
            ENDIF
.
            BUMP      IBPOSUBR              * process next char
            ADD       ONE,LOOPCNTR
          DO
.
          RESET     IBPOSUBR
.
          MOVEFPTR  SUBRBNME,F2
          SUB       ONE,F2
          SETLPTR   SUBRBNME,F2
          RESET     SUBRBNME
.
URLESC99  RETURN
.------------------------------------------------------------
. Post Code Maintanance Details (TABLE ROW)
.------------------------------------------------------------
PSROW000  CALL      URLESC00           * Escape single-quotes with %27
          WRITE     HTMLFILE;"<tr><td nowrap><A HREF='javascript:ShowDetail06":
                             "(#"",LINKPRG,"#.pbl":
                             "?reportno=",LINKREP:
                             "&template=",LINKTEM:
                             "&ptpos002=",SUBRBNME:
                             "&ptpos001=",IBPOPCOD:
                             "&ptpos003=",IBPOSTAT,"#")'>":
                             "<img src=../images/MaintenanceIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             IBPOPCOD,"</td>":
                             "<td>&nbsp;",IBPOSUBR,"</td>":
                             "<td>&nbsp;",IBPOSTAT,"</td>":
                             "<td>&nbsp;",IBPOASGC,"</td>":
                             "<td>&nbsp;",IBPORRAV,"</td>":
                             "</tr>"
.
PSROW999 RETURN
.
.-------------------------------------------------------------------------------
. Option 6 : Set Parameters for Postcode Maintanance
.-------------------------------------------------------------------------------
STPOS000  MOVE      ZERO,EXIT
          UNPACK    QRYNAME,KEY5,KEY3
          MOVE      KEY3,F3
          BRANCH    F3,STPOS001,STPOS002,STPOS003,STPOS004,STPOS005
.
          MOVE      ONE,EXIT
          GOTO      STPOS999
.
STPOS001  PACK      PTPOS001,QRYDATA,SP70
          GOTO      STPOS999
STPOS002  PACK      PTPOS002,QRYDATA,SP70
          REP       "`+",PTPOS002           * where we've passed "+" as "`"
          GOTO      STPOS999
STPOS003  PACK      PTPOS003,QRYDATA,SP70
          GOTO      STPOS999
STPOS004  MOVE      QRYDATA,PTPOS004
          GOTO      STPOS999
STPOS005  MOVE      QRYDATA,PTPOS005
          GOTO      STPOS999
.
STPOS999  RETURN
.
.------------------------------------------------------------
. Table of Hospital Specific Cat Codes
.------------------------------------------------------------
HCOD0000  COMPARE   ONE,IBCNMHOS
          GOTO      HCOD9999 IF NOT EQUAL
.
          CALL      HHED0000      * Output Table Heading
.
          PACK      KEY3,SP70
          CALL      RSPTHSP1
HCOD1000  CALL      RKPTHSP1
          BRANCH    OVRCD,HCOD9999
.
          WRITE     HTMLFILE;"<tr><td>",PTHSNAME,"</td>":
                             "<td align=center>":
                             "<input type=checkbox name=lhosparr";
.
          PACK      KEY8,PTHSHOSP,PTCOD001,PTCOD002,SP70
          CALL      RDMLCOD1
          IF        OVRCD=0
            WRITE     HTMLFILE;" checked ";
          ENDIF
.
          WRITE     HTMLFILE;" value='",PTHSHOSP,"'>":
                             "</td></tr>"
.
          GOTO      HCOD1000
.
HCOD9999  RETURN
.
.------------------------------------------------------------
. Hospital Specific Category Codes (TABLE HEADING)
.------------------------------------------------------------
HHED0000  WRITE     HTMLFILE;"<tr>":
                             "<td class=HeadingCell width=60%>Hospital</td>":
                             "<td class=HeadingCell align=center width=40%>":
                             "Link</td>":
                             "</tr>"
.
HHED9999  RETURN
.
.------------------------------------------------------------
. Update Hospital Specific Details 
.------------------------------------------------------------
LHOS0000  COMPARE   ONE,IBCNMHOS
          GOTO      LHOS9999 IF NOT EQUAL
.
          PACK      KEY8,PTCOD001,PTCOD002,SP70
          CALL      RSMLCOD2
LHOS1000  CALL      RKMLCOD2                * Delete all linked codes
          BRANCH    OVRCD,LHOS3000
.
          MATCH     PTCOD001,MLCOTCOD
          GOTO      LHOS3000 IF NOT EQUAL
.
          MATCH     PTCOD002,MLCOACOD
          GOTO      LHOS3000 IF NOT EQUAL
.
          PACK      KEY8,MLCOTCOD,MLCOACOD,MLCOHOSP,SP70
          CALL      DEMLCOD2
.
          GOTO      LHOS1000
.
LHOS3000  MOVE      ZERO,ARRCNT
.
LHOS3100  ADD       ONE,ARRCNT                   * Write hospital links
          IF        ARRCNT>LHOSPCNT
            GOTO      LHOS6000
          ENDIF  
.
          MATCH     SP70,LHOSPARR[ARRCNT]
          GOTO      LHOS3100 IF EQUAL
.
          PACK      MLCOHOSP,LHOSPARR[ARRCNT],SP70
          PACK      MLCOTCOD,PTCOD001,SP70
          PACK      MLCOACOD,PTCOD002,SP70
          MOVE      SP70,MLCOSPAR
.
          PACK      KEY8,MLCOHOSP,MLCOTCOD,MLCOACOD,SP70
          CALL      RAMLCOD1
          IF        OVRCD=1
            CALL     WRMLCOD1
          ENDIF
.
          GOTO      LHOS3100   
.
LHOS6000  PACK      KEY5,PTCOD001,PTCOD002,SP70   * Update Hospital Specific 
          CALL      RDCODE1                       * Indicatory For Category and
          BRANCH    OVRCD,LHOS9000                * Code
.
          MOVE      ZERO,PTCDHOSS
          PACK      KEY8,PTCOD001,PTCOD002,SP70
          CALL      RSMLCOD2
          CALL      RKMLCOD2
          BRANCH    OVRCD,LHOS6500
.
          MATCH     PTCOD001,MLCOTCOD
          GOTO      LHOS6500 IF NOT EQUAL
.
          MATCH     PTCOD002,MLCOACOD
          GOTO      LHOS6500 IF NOT EQUAL
.
          MOVE      ONE,PTCDHOSS
.
LHOS6500  CALL      UPCODE1
.
LHOS7000  PACK      KEY5,PTCOD001,SP70            * Update Hospital Specific
          CALL      RDCODE1                       * Indicatory For Category
          BRANCH    OVRCD,LHOS9000 
.
          MOVE      ZERO,PTCDHOSS
          PACK      KEY8,PTCOD001,SP70
          CALL      RSMLCOD2
          CALL      RKMLCOD2
          BRANCH    OVRCD,LHOS7500
.         
          MATCH     PTCOD001,MLCOTCOD
          GOTO      LHOS7500 IF NOT EQUAL
.         
          MOVE      ONE,PTCDHOSS
.
LHOS7500  CALL      UPCODE1
.
          MOVE      ZERO,EXIT
          GOTO      LHOS9999
.
LHOS9000  MOVE      ONE,EXIT
          GOTO      LHOS9999
.
LHOS9999  RETURN
.
.------------------------------------------------------------
. Update Hospital Specific Details after delete of cat code
.------------------------------------------------------------
DHOS0000  COMPARE   ONE,IBCNMHOS
          GOTO      DHOS9999 IF NOT EQUAL
.
          PACK      KEY8,PTCOD001,PTCOD002,SP70
          CALL      RSMLCOD2
DHOS1000  CALL      RKMLCOD2                * Delete all linked codes
          BRANCH    OVRCD,DHOS3000
.
          MATCH     PTCOD001,MLCOTCOD
          GOTO      DHOS3000 IF NOT EQUAL
.
          MATCH     PTCOD002,MLCOACOD
          GOTO      DHOS3000 IF NOT EQUAL
.
          PACK      KEY8,MLCOTCOD,MLCOACOD,MLCOHOSP,SP70
          CALL      DEMLCOD2
.
          GOTO      DHOS1000
.
DHOS3000  PACK      KEY5,PTCOD001,SP70            * Update Hospital Specific
          CALL      RDCODE1                       * Indicatory For Category
          BRANCH    OVRCD,DHOS9000
.
          MOVE      ZERO,PTCDHOSS
          PACK      KEY8,PTCOD001,SP70
          CALL      RSMLCOD2
          CALL      RKMLCOD2
          BRANCH    OVRCD,DHOS7500
.
          MATCH     PTCOD001,MLCOTCOD
          GOTO      DHOS7500 IF NOT EQUAL
.
          MOVE      ONE,PTCDHOSS
.
DHOS7500  CALL      UPCODE1
.
          MOVE      ZERO,EXIT
          GOTO      DHOS9999
.
DHOS9000  MOVE      ONE,EXIT
          GOTO      DHOS9999
.
DHOS9999  RETURN
.
.------------------------------------------------------------
. Hospital Selection
.------------------------------------------------------------
HHSL0000  PACK      KEY3,SP70
          CALL      RSPTHSP1
HHSL0100  CALL      RKPTHSP1
          BRANCH    OVRCD,HHSL9999
.
          MOVE      PTHSNAME,KEY50
          PACK      KEY5,QUOTE,PTHSHOSP,QUOTE
          MATCH     HOSPCODE,PTHSHOSP
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY5," selected>":
                               KEY50,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY5,">",KEY50,"</option>"
          ENDIF
          GOTO      HHSL0100
.
HHSL9999  RETURN
.
.------------------------------------------------------------
. Copy codes to hospital specific details file 
.------------------------------------------------------------
HCOP0000  COMPARE   ONE,IBCNMHOS
          GOTO      HCOP9999 IF NOT EQUAL
.
          MATCH     SP70,HOSPCODE
          GOTO      HCOP9999 IF EQUAL
.
          MATCH     SP70,PTCOD001
          GOTO      HCOP9999 IF EQUAL
.
          PACK      KEY5,PTCOD001,SP70
          CALL      RDSCODE1
HCOP1000  CALL      RDKCODE1                     * Write all codes for this
          BRANCH    OVRCD,HCOP9000               * category to the
.                                                * hospital sepecific file
          MATCH     PTCOD001,TCODE
          GOTO      HCOP9000 IF NOT EQUAL
.
          PACK      MLCOHOSP,HOSPCODE,SP70
          PACK      MLCOTCOD,TCODE,SP70
          PACK      MLCOACOD,ACODE,SP70
          MOVE      SP70,MLCOSPAR
.
          PACK      KEY8,MLCOHOSP,MLCOTCOD,MLCOACOD,SP70
          CALL      RAMLCOD1
          IF        OVRCD=1
            CALL     WRMLCOD1
          ENDIF
.
          MOVE      ONE,PTCDHOSS
          CALL      UPCODE1
.
          GOTO      HCOP1000
.
HCOP9000  PACK      KEY5,PTCOD001,SP70            * Update Hospital Specific
          CALL      RDCODE1                       * Indicatory For Category
          BRANCH    OVRCD,HCOP9500
.
          MOVE      ZERO,PTCDHOSS
          PACK      KEY8,PTCOD001,SP70
          CALL      RSMLCOD2
          CALL      RKMLCOD2
          BRANCH    OVRCD,HCOP9100
.
          MATCH     PTCOD001,MLCOTCOD
          GOTO      HCOP9100 IF NOT EQUAL
.
          MOVE      ONE,PTCDHOSS
.
HCOP9100  CALL      UPCODE1
          MOVE      ZERO,EXIT
          GOTO      HCOP9999
.
HCOP9500  MOVE      ONE,EXIT
          GOTO      HCOP9999
.
HCOP9999  RETURN
.
.------------------------------------------------------------
. Delete codes from hospital specific details file 
.------------------------------------------------------------
HDEL0000  COMPARE   ONE,IBCNMHOS
          GOTO      HDEL9999 IF NOT EQUAL
.
          MATCH     SP70,HOSPCODE
          GOTO      HDEL9999 IF EQUAL
.
          MATCH     SP70,PTCOD001
          GOTO      HDEL9999 IF EQUAL
.
          PACK      KEY8,HOSPCODE,PTCOD001,SP70
          CALL      RSMLCOD1
HDEL1000  CALL      RKMLCOD1                     * Delete all hospital specific
          BRANCH    OVRCD,HDEL3000               * details fo this hospital and
.                                                * category
          MATCH     HOSPCODE,MLCOHOSP
          GOTO      HDEL3000 IF NOT EQUAL
.
          MATCH     PTCOD001,MLCOTCOD
          GOTO      HDEL3000 IF NOT EQUAL
.
          PACK      KEY8,MLCOHOSP,MLCOTCOD,MLCOACOD,SP70
          CALL      DEMLCOD1
.
          GOTO      HDEL1000
.
HDEL3000  PACK      KEY5,PTCOD001,SP70            * Update Hospital Specific
          CALL      RDSCODE1                      * Indicatory For Category and 
HDEL3100  CALL      RDKCODE1                      * Code 
          BRANCH    OVRCD,HDEL9000 
.
          MATCH     PTCOD001,TCODE
          GOTO      HDEL9000 IF NOT EQUAL
.
          MOVE      ZERO,PTCDHOSS
          PACK      KEY8,TCODE,ACODE,SP70
          CALL      RSMLCOD2
          CALL      RKMLCOD2
          BRANCH    OVRCD,HDEL8000
.
          MATCH     TCODE,MLCOTCOD
          GOTO      HDEL8000 IF NOT EQUAL
.
          MATCH     ACODE,MLCOACOD
          GOTO      HDEL8000 IF NOT EQUAL
.
          MOVE      ONE,PTCDHOSS
.
HDEL8000  CALL      UPCODE1 
          GOTO      HDEL3100
.
HDEL9000  PACK      KEY5,PTCOD001,SP70            * Update Hospital Specific
          CALL      RDCODE1                       * Indicatory For Category
          BRANCH    OVRCD,HDEL9600
.
          MOVE      ZERO,PTCDHOSS
          PACK      KEY8,PTCOD001,SP70
          CALL      RSMLCOD2
          CALL      RKMLCOD2
          BRANCH    OVRCD,HDEL9500 
.
          MATCH     PTCOD001,MLCOTCOD
          GOTO      HDEL9500 IF NOT EQUAL
.
          MOVE      ONE,PTCDHOSS
.
HDEL9500  CALL      UPCODE1
          MOVE      ZERO,EXIT
          GOTO      HDEL9999
.
HDEL9600  MOVE      ONE,EXIT
          GOTO      HDEL9999
.
HDEL9999  RETURN
+
.------------------------------------------------------------
. Stationery Codes
.------------------------------------------------------------
STNCOD00  MOVE      ZERO,KEY6
          CALL      RSIBTH1
STNCOD20  CALL      RKIBTH1
          BRANCH    OVRCD,STNCOD99
.
          MATCH     "1",IBTHACTV
          GOTO      STNCOD20 IF NOT EQUAL
.
          MATCH     STNTYPE,IBTHSTYP        * Stationery Type
          GOTO      STNCOD20 IF NOT EQUAL
.
          MATCH     STNCODE,IBTHSCOD        * Stationery Code
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=#"",IBTHSCOD,"#" selected>":
                               IBTHDESC,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=#"",IBTHSCOD,"#">",IBTHDESC:
                               "</option>"
          ENDIF
          GOTO      STNCOD20
.
STNCOD99  RETURN
+
.------------------------------------------------------------
. Health Fund Group Selection
.------------------------------------------------------------
HFGSEL00  PACK      KEY6,SP70
          CALL      RSPAHGP1
HFGSEL10  CALL      RKPAHGP1
          BRANCH    OVRCD,HFGSEL99
.
          MOVE      PTHGDESC,KEY50
          PACK      KEY8,QUOTE,PTHGCODE,QUOTE
          MATCH     PTCFHFGC,PTHGCODE
          IF        @EQUAL
            WRITE     HTMLFILE;"<option value=",KEY8," selected>":
                               KEY50,"</option>"
          ELSE
            WRITE     HTMLFILE;"<option value=",KEY8,">",KEY50,"</option>"
          ENDIF
          GOTO      HFGSEL10
.
HFGSEL99  RETURN
+
.------------------------------------------------------------
.                       RUNHLD00
.   Schedule update of health fund invoice pending on hold
.------------------------------------------------------------
RUNHLD00  MOVE      "IBAADT62",SCHDPGID
          MOVE      "Update Claim Code Invoice Pending",SCHDDESC
          PACK      SCHDDATE,CCC,CYY,CMM,CDD
          REP       " 0",SCHDDATE
          CLOCK     TIME,SCHDTIME
          MOVE      "S",SCHDPRNT             * Spool File
.
.         Write Keyin parameters for Extract
.
          MOVE      TWO,KEYSTARR[1]
          MOVE      ACODE,KEYSTARR[2]
          MOVE      SAVEREAS,KEYSTARR[3]
          MOVE      ANSY,KEYSTARR[4]
          MOVE      FOUR,KEYSTCNT               * Number of Keyins
.
          CALL      SCHPRO00   * Schedule Extract
.
RUNHLD99  RETURN
+
.------------------------------------------------------------
. Move Claim Code Future Actions cgi to file vars
.------------------------------------------------------------
MVPTCF00  PACK      PTCFCLAI,PTCOD002,SP70
          PACK      PTCFNDFP,PTCFA001,SP70
          PACK      PTCFFACD,PTCFA002,SP70
          PACK      PTCFOCGR,PTCFA003,SP70
          PACK      PTCFCEFR,PTCFA004,SP70
          PACK      PTCFMCPS,PTCFA005,SP70
          PACK      PTCFHINV,PTCFA006,SP70
          PACK      PTCFRHCD,PTCFA007,SP70
          PACK      PTCFRHFT,PTCFA008,SP70
          PACK      PTCFHDAT,PTCFA009,SP70
          PACK      PTCFHFGC,PTCFA010,SP70
.
          CALL      IBACLOCK
          PACK      PTCFOHDT,CCC,CYY,CMM,CDD,SP70
          REP       " 0",PTCFOHDT
          PACK      PTCFOHTM,CTIMEIS,SP70
          PACK      PTCFOHUI,USERID,SP70
. 
MVPTCF99  RETURN
+
.------------------------------------------------------------
. Mental Health Legal Status Matrix: Display,Add,Delete
.------------------------------------------------------------
MEHLSM00  RESET     UPDTTYPE
          MATCH     SP1,UPDTTYPE
          GOTO      MEHLSM40 IF EQUAL
.
          MATCH     "A",UPDTTYPE    * Add formaction
          GOTO      MEHLSM10 IF EQUAL
.
          MATCH     "D",UPDTTYPE    * Delete formaction
          GOTO      MEHLSM30 IF EQUAL
.
          GOTO      MEHLSM93
.
MEHLSM10  RESET     MHLSM001
          PACK      MHLSM001,MHLSM001,SP70
          RESET     MHLSM002
          PACK      MHLSM002,MHLSM002,SP70          
.
          PACK      KEY6,MHLSM001,MHLSM002,SP70
          CALL      RDMHLSM1
          COMPARE   ZERO,OVRCD
          GOTO      MEHLSM92 IF EQUAL
          CALL      MVMEHLSM      * Moves input variables to file variables
.
          MOVE      WBSEUID,MHLMCUID
          CALL      IBACLOCK
          PACK      MHLMCDAT,CCC,CYY,CMM,CDD
          REP       " 0",MHLMCDAT
          CLOCK     TIME,MHLMCTIM
.
          PACK      KEY6,MHLSM001,MHLSM002,SP70
          CALL      WRMHLSM1      * Writes away the data
          MOVE      ZERO,EXIT
          GOTO      MEHLSM99
.
MEHLSM30  PACK      KEY6,MHLSM001,MHLSM002,SP70   * Delete Formaction
          CALL      RDMHLSM1
          BRANCH    OVRCD,MEHLSM91
          CALL      DEMHLSM1      
          MOVE      ZERO,EXIT
          GOTO      MEHLSM99
.
MEHLSM40  PACK      KEY5,ANSL,ANSS,MHLSM001,SP70
          CALL      RDCODE1 
          BRANCH    OVRCD,MEHLSM94
.
          CLEAR     WEBTITLE
          MOVE      "Mental Health Legal Status Matrix Maintenance",WEBTITLE
          RESET     WEBTITLE
.
          CALL      WEBHED00   * Create Output File and Write HTML Page Header
          BRANCH    EXIT,MEHLSM99
          CALL      WEBBOD00   * Process Web Body
          CALL      WEBEND00   * Process End of HTML File
          MOVE      ONE,EXIT
          GOTO      MEHLSM99
.
MEHLSM91  MOVE      "Legal Status Matrix does not exist",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      MEHLSM99
.
MEHLSM92  MOVE      "Legal Status Matrix record exists",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      MEHLSM99
.
MEHLSM93  MOVE      "Invalid Form Action.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      MEHLSM99
.
MEHLSM94  MOVE      "Legal Status patcodes record not found.",WEBTITLE
          CALL      WEBERR00
          MOVE      ONE,EXIT
          GOTO      MEHLSM99
.
MEHLSM99  RETURN
.-----------------------------------------------------------
. Mental Health Legal Status Misc Tags
.-----------------------------------------------------------
MCLM0000  BRANCH    FLDITMNO,MCLM0100
          GOTO      MCLM9999
.
MCLM0100  CALL      LMTAB000
          GOTO      MCLM9999
.
MCLM9999  RETURN
.------------------------------------------------------------
. Table of Mental Health Legal Status Matrix Records
.------------------------------------------------------------
LMTAB000  PACK      KEY6,MHLSM001,SP70
          CALL      RSMHLSM1
LMTAB100  CALL      RKMHLSM1
          BRANCH    OVRCD,LMTAB999
.
          MATCH     MHLSM001,MHLMCRLS
          GOTO      LMTAB999 IF NOT EQUAL
.
          PACK      KEY5,ANSL,ANSS,MHLMVNLS,SP70
          CALL      RDCODE1
          BRANCH    OVRCD,LMTAB100
.
          CALL      LMROW000      * Display Lookup ID Row
          GOTO      LMTAB100
.
LMTAB999  RETURN
.
.------------------------------------------------------------
. Mental Health Legal Status Matrix  (TABLE ROW)
.------------------------------------------------------------
LMROW000  WRITE     HTMLFILE;"<tr><td nowrap colspan=2><A HREF='javascript:DeleteLSM":
                             "(#"",MHLMCRLS:
                             "#",#"",MHLMVNLS:
                             "#")'>":
                             "<img src=../images/DeleteIcon.gif hspace=4":
                             " border=0 align=absmiddle></a>":
                             ACODE," - ",TDESC,"</td>":
                             "</tr>"
.
LMROW999 RETURN
.--------------------------------------------------------------------------
          INC       IBAWEBCD
          INC       MEHLSMTM
.
          INC       IBAPOSIO/INC
          INC       IBACCSIO/INC      *  Category Security File
          INC       IBACGSIO/INC      *  Group Security File
          INC       IBACUSIO/INC      *  User Security File
          INC       MEHLSMIO/INC
          INC       MLTSECIO/INC
          INC       PATCFAIO/INC
          INC       PATHGPIO/INC      * Patient Health Fund Group
          INC       PATHSPIO/INC
          INC       PATIN1IO/INC      * Insurance file
          INC       PATVADIO/INC      * Transfer Source Codes IO 
          INC       PMSCMMIO/INC      * Credit card commission details file
          INC       PMSDVAIO/INC
          INC       PMSVKIIO/INC
          INC       WEBLDTIO/INC
          INC       WEBLIDIO/INC
          INC       WEBLPGIO/INC
          INC       MRTLOCIO/INC
          INC       WATVWLIO/INC
          INC       PATWR1IO/INC      * Ward Bed File
.
          INC       PMSVKIPR
          INC       WEBRSHCD
          INC       DAYOFWEK
          INC       WEBDATCD 
          INC       RSHWEBCD
.
