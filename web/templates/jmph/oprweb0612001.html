<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="jmph">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb06.js"> </script>
<script type="text/javascript">
function chkMan() {
  var depTime = document.getElementById('opard085');
  var exitTime = document.getElementById('opard080');
  var varianceMinutes = document.getElementById('opcnvrrd');
  var delayCode = document.getElementById('opard084');
  var dateDiffSeconds = null;
  var dateDiffMilliseconds = null;

  if(isWhitespace(depTime.value)){return;}

  //convert to time
  var date1 = new Date();
  var date2 = new Date();

  //depTime
  date1.setHours(depTime.value.substr(0,2));
  date1.setMinutes(depTime.value.substr(3,2));
  date1.setSeconds(depTime.value.substr(6,2));

  //exitTime
  date2.setHours(exitTime.value.substr(0,2));
  date2.setMinutes(exitTime.value.substr(3,2));
  date2.setSeconds(exitTime.value.substr(6,2));

  dateDiffMilliseconds = (date2 - date1);
  dateDiffSeconds = (dateDiffMilliseconds/1000);

  //convert minute to seconds and then compare dateDiffSeconds
  if( (varianceMinutes.value * 60) > dateDiffSeconds) {
    delayCode.className="";
  }else {
    delayCode.className="Mandatory";
  }
}
function chkMan2() {
  var recTime = document.getElementById('opard077');

  if (isWhitespace(recTime.value)) {return;}

  var exitTime = document.getElementById('opard080');
  var varianceMinutes = document.getElementById('opcnldae');
//  var delayCode = document.getElementById('opard084');
  var dateDiffSeconds = null;
  var dateDiffMilliseconds = null;

  //convert to time
  var date1 = new Date();
  var date2 = new Date();

  //recTime
  date1.setHours(recTime.value.substr(0,2));
  date1.setMinutes(recTime.value.substr(3,2));
  date1.setSeconds(recTime.value.substr(6,2));

  //exitTime
  date2.setHours(exitTime.value.substr(0,2));
  date2.setMinutes(exitTime.value.substr(3,2));
  date2.setSeconds(exitTime.value.substr(6,2));

  dateDiffMilliseconds = (date2 - date1);
  dateDiffSeconds = (dateDiffMilliseconds/1000);

  //convert minute to seconds and then compare dateDiffSeconds
  if( (varianceMinutes.value * 60) > dateDiffSeconds) {
//    delayCode.className="";
  }else {
//    delayCode.className="Mandatory";
//    adverseEventDiv.style.display = "";
    if(usingRecoveryAnaestheticParameter != '1') {
      return;
    }
    var url = "oprweb06.pbl?reportno=10&template=011";

    url += "&urnumber="+PatientURN;
    url += "&admissno="+PatientVIS;
    url += "&casekeys="+UpdateForm.casekeys.value;

//    adverseEventDiv.style.display = "none";

    SetCookie("recoveryDFrameCookie","");
    ShowDetail01(url);
  }
}
function validateNurse(code,name) {
  validateCode('17',code,name,document.UpdateForm.gnm);
  SetNurseName(name);
}
function SetNurseName(name) {
  name.value=UpdateForm.gnm.value.replace(/\s*$/g,"") + " " +
             name.value.replace(/\s*$/g,"")
}

function chkTime(field){
  if(isWhitespace(field.value))
    return;
  endTime=UpdateForm.opsrg006.value.replace(/:/g,"");
  if(isWhitespace(endTime)){
     alert("Surgery End Time must be entered first");
     field.value=""
     return;
  }
  OperDate=document.UpdateForm.casekeys.value.substring(3,11);
  if(document.UpdateForm.currdate.value > OperDate) {
    return;
  }
  if(field.value.replace(/:/g,"")<=endTime){
    if(!confirm(""+field.title+" must be after Surgery End Time." +
                "\n Do you want to override")) {
      field.value="";
    }
  }
}

function ChgSurgeon() {
  document.UpdateForm.checksub.value=1
  AJAXPosting();
  if (xmlHttp.status == "200") {
    UpdateForm.target="PopUpFrame"
    if (UpdateDayProc()) {
      setTimeout('showChgSur()',100);
    }
    UpdateForm.target="";
  } else {
    alert("Web Service Not Available. Check your Connection and Try Again.");
  }
  document.UpdateForm.checksub.value=0
}

function showChgSur() {
  caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
  teamNumb=UpdateForm.teamnumb.value;
  linkurl="oprweb06.pbl?reportno=12&template=005&casekeys="+caseKeys+
          "&teamnumb="+teamNumb;
  Left=(document.body.clientWidth-750)/2
  DFrameLink(linkurl,100,Left,750,350)
}

// Change Theatre
function ChgOpr() {
  document.UpdateForm.checksub.value=1
  AJAXPosting();
  if (xmlHttp.status == "200") {
    UpdateForm.target="PopUpFrame"
    if (UpdateDayProc()) {
      setTimeout('showChgOpr()',100);
    }
    UpdateForm.target="";
  } else {
      alert("Web Service Not Available. Check your Connection and Try Again.");
  }
  document.UpdateForm.checksub.value=0
}

function showChgOpr() {
  linkurl="oprweb01.pbl?reportno=4&template=014&casekeys="
           +UpdateForm.casekeys.value; 
  Left=(document.body.clientWidth-350)/2
  DFrameLink(linkurl,100,Left,350,180)
}

function showItem() {
  caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
  teamNumb=UpdateForm.teamnumb.value;
  Left=(document.body.clientWidth-800)/2
  DFrameLink("oprweb06.pbl?reportno=02&template=003&casekeys="+caseKeys +
             "&teamnumb="+teamNumb,100,Left,850,350);
}

function ChkRecovDelay() {
  var timeInRec = UpdateForm.opard077.value;
  var timeThrExit = UpdateForm.opard080.value;
  if ((isWhitespace(timeInRec)) || (isWhitespace(timeThrExit))) {
    UpdateForm.opard084.className="";
    return;
  }

  var recTime = new Date();
  var exitTime = new Date();

  // Set Recovery-Day Time
  recTime.setHours(timeInRec.substr(0,2));
  recTime.setMinutes(timeInRec.substr(3,2));
  recTime.setSeconds(timeInRec.substr(6,2));
  var recTimeSec = recTime.getTime();

  // Set Theatre Exit Time
  exitTime.setHours(timeThrExit.substr(0,2));
  exitTime.setMinutes(timeThrExit.substr(3,2));
  exitTime.setSeconds(timeThrExit.substr(6,2));
  var exitTimeSec = exitTime.getTime();

  // Calculate difference
  var timeDif = exitTimeSec - recTimeSec;
  // If time difference is greater than 6 hours then set 'Recovery Delay 
  // Reason' to be a mandatory field
  if (timeDif > 21600000)              // 6 hours = 21600000 miliseconds
    UpdateForm.opard084.className="Mandatory";
  else
    UpdateForm.opard084.className="";
}
function SetPrinter(SelectList) {
 if (SelectList.className=="SelectBig") {
     SelectList.className="Mandatory SelectBig" }
 else {
     SelectList.className="SelectBig" }
}

// Update Day Procedure Details
function UpdateDayProc() {

   if (!checkVisitDatesTimes()) {return;}

   document.UpdateForm.updatety.value="U";

   // Set Anaesthetic Prep Time to be equal to Anaesthetic Start Time.  
   document.UpdateForm.opard041.value = document.UpdateForm.opard042.value;

   // Set Prep Time to be equal to Surgery Start Time. This is required
   // for calculation of Actual Operation Minutes.
   document.UpdateForm.opsrg003.value = document.UpdateForm.opsrg005.value;

   // Set Dressing Time to be equal to Surgery End Time. This is required
   // for calculation of Actual Operation Minutes.
   document.UpdateForm.opsrg004.value = document.UpdateForm.opsrg006.value;

   // Set Ready To Depart Time to be equal to the Exit Theatre Complex Time.
   //This is needed as opard085 is not displayed on the screen
  if(isWhitespace(document.UpdateForm.opard085.value)) {
     document.UpdateForm.opard085.value = document.UpdateForm.opard080.value;
   }

   if (isWhitespace(document.getElementById("opard077").value)) {
     if (document.getElementById('opard071').value ==
         document.getElementById('opard074').value &&
         document.getElementById('opard074').value ==
         document.getElementById('opard077').defaultValue &&
         document.getElementById('opard077').defaultValue ==
         document.getElementById('opard071').value) {
       document.getElementById('opard071').value = "";
       document.getElementById('opard074').value = "";
     }
   }

   return(formSubmit());

}

function chkAnaesTime() {
  if(!isWhitespace(UpdateForm.opard042.value)) {
    if(isWhitespace(UpdateForm.opard002.value)) {
      alert("Arrival Time must be entered first.");
      UpdateForm.opard042.value="";
      UpdateForm.opard002.focus();
      return;
    }
    ArrivT= UpdateForm.opard002.value.replace(/:/g,"");
    AnaesT= UpdateForm.opard042.value.replace(/:/g,"");
    if(AnaesT < ArrivT) {
      if(confirm("Anaesthetic Started should be greater than Arrival Time."
                 + "\n Do you want to override")) {
        return;
      }
      UpdateForm.opard042.value="";
      UpdateForm.opard042.focus();
    }
  }
}

// Validate Surgery Start Time
function chkSurgStart() {
  if(!isWhitespace(UpdateForm.opsrg005.value)) {
    if(isWhitespace(UpdateForm.opard042.value)) {
      alert("Anaesthetic Started must be entered first.");
      UpdateForm.opsrg005.value="";
      UpdateForm.opard042.focus(); 
      return;
    }
    var anaeTime = trim(UpdateForm.opard042.value.replace(/:/g,""))
    var surgStrt = trim(UpdateForm.opsrg005.value.replace(/:/g,""))
    anaeTime=anaeTime.substr(0,4)
    surgStrt=surgStrt.substr(0,4)
    anaeTime=anaeTime - 0;
    surgStrt=surgStrt - 0;
    if(anaeTime > surgStrt) {
      if(!confirm("Surgery Start Time should be greater than Anaesthetic/Prep"+
                  " Time.\n Do you want to override")) {
        UpdateForm.opsrg005.value="";
        UpdateForm.opsrg005.focus()
        return;
      }
    }
  }
}

// Validate Surgery End Time
function chkSurgEnd() {
  if(!isWhitespace(UpdateForm.opsrg006.value)) {
    if(isWhitespace(UpdateForm.opsrg005.value)) {
      alert("Surgery Start Time must be entered first.");
      UpdateForm.opsrg006.value="";
      UpdateForm.opsrg005.focus(); 
      return;
    }
    valPrepDress();
  }
}

function setETTime(extime) {
  document.UpdateForm.opard080.value=extime.value;
  ChgRTD();
}

function ChgRTD() {
  if(!isWhitespace(UpdateForm.opard080.value)) {
    UpdateForm.opard080.className= "Mandatory"
  }
  else {
    UpdateForm.opard080.className=" "
  }
}

// Refresh Page
function RefreshPage() {
  document.UpdateForm.checksub.value=1
  document.UpdateForm.method="get"
  document.UpdateForm.updatety.value="";
  document.UpdateForm.submit();
}
// Full Time Out
function FullTimeOut(){
  document.UpdateForm.checksub.value=1
  caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
  UpdateForm.redirect.value="oprweb01.pbl?reportno=04&template=035&casekeys="+caseKeys;
  UpdateDayProc();
}
// Clinical Details
function ClinicalDetails(){
  document.UpdateForm.checksub.value=1
  AJAXPosting();
  if (xmlHttp.status == "200") {
    caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
    UpdateForm.redirect.value="oprweb06.pbl?reportno=08&template=002&casekeys="+caseKeys;
    UpdateDayProc();
  } else {
     alert("Web Service Not Available. Check your Connection and Try Again.");
  }
}
// Link To Staff List
function goToStaff() {
  document.UpdateForm.checksub.value=1
  AJAXPosting();
  if (xmlHttp.status == "200") {
    caseKey=UpdateForm.casekeys.value.replace(/ /g,"+")
    temp=document.UpdateForm.teamnumb.value;
    supr=document.UpdateForm.suprlevl.value;
    jmph=document.UpdateForm.jmphflag.value;
    UpdateForm.redirect.value="oprweb06.pbl?reportno=12&template=2&casekeys="+
               caseKey+"&teamnumb="+temp+"&suprlevl="+supr+"&jmphflag="+jmph;
    SetCookie("addStaffCOOKIE","1");
    UpdateDayProc();
  } else {
    alert("Web Service Not Available. Check your Connection and Try Again.");
  }
}

function goToTimeOut() {
  document.UpdateForm.checksub.value=1
  AJAXPosting();
  if (xmlHttp.status == "200") {
    UpdateForm.target="PopUpFrame"
    if (UpdateDayProc()) {
      setTimeout('showTimeOut()',100);
    }
    UpdateForm.target="";
  } else {
    alert("Web Service Not Available. Check your Connection and Try Again.");
  }
  document.UpdateForm.checksub.value=0
}

function showTimeOut() {
  caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
  teamNumb=UpdateForm.teamnumb.value;
  linkurl="oprweb01.pbl?reportno=4&template=035&casekeys="+caseKeys+
          "&teamnumb="+teamNumb;
  Left=(document.body.clientWidth-850)/2
  DFrameLink(linkurl,100,Left,850,480)
}


// Form Submit
function formSubmit() {
   if(validateMandatory(UpdateForm)) {
      casekey=UpdateForm.casekeys.value.substr(0,26);
      casekey=casekey.replace(/ /g,"+");
      uniqkey=UpdateForm.uniqueky.value
      uniqkey=uniqkey.replace(/ /g,"+");
      if (isWhitespace(UpdateForm.redirect.value)) {
        UpdateForm.redirect.value="oprweb06.pbl?reportno=12&template=001"+
                                  "&uniqueky="+uniqkey+"&teamnumb="; 
      }
      document.UpdateForm.submit();
      return true;
    }
    else
      return false;
}
// Set Team no.
function set(){
 PatientLinks.teamnumb.value=UpdateForm.teamnumb.value;
}

// Procedure Description to be made Mandatory
function ProcMan() {
  if(!isWhitespace(UpdateForm.opsrg006.value))  
    UpdateForm.opdea014.className="Mandatory";
  else
    UpdateForm.opdea014.className="";
}

// Validate Prep Start/Surgery Start and Dressing/Surgery End Times
function valPrepDress() {
  var prepTime = trim(document.UpdateForm.opsrg005.value.replace(/:/g,""));
  var dressTime = trim(document.UpdateForm.opsrg006.value.replace(/:/g,""));
  if (isWhitespace(dressTime) || isWhitespace(prepTime))
    return;
}
function AnaestheticMand() {
  if(!isWhitespace(UpdateForm.opsrg006.value)) {
    UpdateForm.opdea003.className="Mandatory";
  } else {
    UpdateForm.opdea003.className="";
  }
}
function checkVisitDatesTimes() {
  if (!CheckDateRange(document.getElementById('admndate'),
                      document.getElementById('opsework'))) {
    return false;
  }

  if (SetDateYYYYMMDD(document.getElementById('admndate').value) ==
      SetDateYYYYMMDD(document.getElementById('opsework').value)) {
    if (!isWhitespace(document.getElementById('opard002').value)) {
      if (document.getElementById('opard002').value <
          document.getElementById('admntime').value) {
        alert('Invalid Range Entered Admission Time and Time Arrived');
        return false;
      }
    }
  }

  if (!isWhitespace(document.getElementById('discdate').value)) {

    if (!CheckDateRange(document.getElementById('opsework'),
                        document.getElementById('discdate'))) {
      document.getElementById('opsework').value=
      document.getElementById('opsework').defaultValue;
      return false;
    }

    if (SetDateYYYYMMDD(document.getElementById('opsework').value) ==
        SetDateYYYYMMDD(document.getElementById('discdate').value)) {
      if (!isWhitespace(document.getElementById('opsrg006').value)) {
        if (document.getElementById('disctime').value <
            document.getElementById('opsrg006').value) {
          alert('Invalid Range Entered Surgery End and Discharge Time');
          document.getElementById('opsework').value=
          document.getElementById('opsework').defaultValue;
          return false;
        }
      }
    }
  }

  return true;
}
function displayCRRHI() {

  if (document.getElementById("opcncrrh").value=="2") {
    linkurl = document.getElementById("recrmurl").value +
              "&casekeys=" +
              document.PatientLinks.casekeys.value.replace(/ /g,"+") +
              "&uniqueky=" +
              document.PatientLinks.uniqueky.value.replace(/ /g,"+") +
              "&urnumber=" +
              document.PatientLinks.urnumber.value.replace(/ /g,"+") +
              "&admissno=" +
              document.PatientLinks.admissno.value.replace(/ /g,"+");

    Left=(document.body.clientWidth-800)/2;
    DFrameLink(linkurl,50,Left,800,600)
  }

}
function ShowDetail01(linkurl)
{
  Left=(document.body.clientWidth-900)/2
  var frame = document.getElementById("PopUpFrame");
  frame.style.overflow = "auto";
  frame.style.height = 600 +"px";

  DFrameLink(linkurl,0,Left,900,600)
}
function checksubind() {
  document.UpdateForm.checksub.value=1
}
function submitFormRedirect() {
  if (document.UpdateForm.checksub.value==1) {
      return;
  }

  if (confirm("Warning: You have selected a new option." +
     "\nDo you want to save the existing details?" +
     "\n\nClick OK to save and exit or CANCEL to exit only.")) {

     if (!checkVisitDatesTimes()) {return;}

     document.UpdateForm.updatety.value="U";

     // Set Anaesthetic Prep Time to be equal to Anaesthetic Start Time.
     document.UpdateForm.opard041.value = document.UpdateForm.opard042.value;

     // Set Prep Time to be equal to Surgery Start Time. This is required
     // for calculation of Actual Operation Minutes.
     document.UpdateForm.opsrg003.value = document.UpdateForm.opsrg005.value;

     // Set Dressing Time to be equal to Surgery End Time. This is required
     // for calculation of Actual Operation Minutes.
     document.UpdateForm.opsrg004.value = document.UpdateForm.opsrg006.value;

     // Set Ready To Depart Time to be equal to the Exit Theatre Complex Time.
     //This is needed as opard085 is not displayed on the screen
    if(isWhitespace(document.UpdateForm.opard085.value)) {
       document.UpdateForm.opard085.value = document.UpdateForm.opard080.value;
     }

    if (isWhitespace(document.getElementById("opard077").value)) {
      if (document.getElementById('opard071').value ==
          document.getElementById('opard074').value &&
          document.getElementById('opard074').value ==
          document.getElementById('opard077').defaultValue &&
          document.getElementById('opard077').defaultValue ==
          document.getElementById('opard071').value) {
          document.getElementById('opard071').value = "";
          document.getElementById('opard074').value = "";
      }
    }
  AJAXPosting();
  }
}
function AJAXPosting() {
  var theURL="oprweb06.pbl";
  var postStr=AJAXPostString(document.UpdateForm)
  var xmlHttp = createHttpObject();
  xmlHttp.open("POST", theURL, false);
  xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded;");
  xmlHttp.send(encodeURI(postStr));
}
function CountCorrect() {
  if (document.UpdateForm.opsrg008.value == "1") {
    document.getElementById("countcorrect").style.display = "";
  } else {
    document.getElementById("countcorrect").style.display = "none";
  }
}
function CountCorrectPopUp() {
  if (document.UpdateForm.opsrg008.value == "1") {
    document.getElementById("countcorrect").style.display = "";
    CountCorrectDFrame();
  } else {
    document.getElementById("countcorrect").style.display = "none";
  }
}
function CountCorrectDFrame() {
  linkurl="oprweb06.pbl?reportno=8&template=008&casekeys="
           +UpdateForm.casekeys.value;
  Left=(document.body.clientWidth-800)/2
  DFrameLink(linkurl,100,Left,800,350);
}
function ChgOverCount() {
  linkurl="oprweb06.pbl?reportno=8&template=009&casekeys="
           +UpdateForm.casekeys.value;
  Left=(document.body.clientWidth-800)/2
  DFrameLink(linkurl,100,Left,800,350);
}
function AddMBSItem() {
  caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
  teamNumb=UpdateForm.teamnumb.value;
  linkurl="oprweb06.pbl?reportno=02&template=001&casekeys="+caseKeys +
          "&teamnumb="+teamNumb;
  Left=(document.body.clientWidth-600)/2
  DFrameLink(linkurl,100,Left,600,430);
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);UpdateForm.opard039.focus();set();ProcMan();
              ChkRecovDelay();AnaestheticMand();LoadDefTeam();chkMan();
              CountCorrect();"
      onunload="submitFormRedirect();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB06.12.003";
PatientVIS="%OPRWEB06.12.081";
PatientNAM="%OPRWEB06.12.002";
PatientSTA="%OPRWEB06.12.086.078";
PatientALT="%OPRWEB06.12.084";
PatientSEX="%OPRWEB06.12.019";
PatientDOB="%OPRWEB06.12.020";
PatientAGE="%OPRWEB06.12.021";
PatientLOC="%OPRWEB06.12.083";
PatientPRI="%OPRWEB06.12.086.066.1";
PatientUNT="%OPRWEB06.12.066.0";
DoctorCOD="%OPRWEB06.12.082.003";
DoctorNAM="%OPRWEB06.12.082.002";
PatientAID="%OPRWEB06.12.086.090";
PatientIND="%OPRWEB06.12.086.091";
PatientCUR="%OPRWEB06.12.086.092";
PatientCLC="%OPRWEB06.12.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB06.12.086.094";
PatientCDM="%OPRWEB06.12.086.095";
PatientVDH="%OPRWEB06.12.086.099.015";
usingRecoveryAnaestheticParameter ='%STANDARD.01.025.113.015.0.1';
InsertPatientHeader()
</script>
<div id="PatientMenu"></div>

<div id=PageBodySection>
<form name=UpdateForm method=post action="oprweb06.pbl" style="margin:0"
 autocomplete="off">
<input type=hidden name=reportno value=12>
<input type=hidden name=template value=1>
<input type=hidden name=updatety value="">
<input type=hidden name=urnumber value='%OPRWEB06.12.003'>
<input type=hidden name=casekeys value="%OPRWEB06.12.101">
<input type=hidden name=uniqueky value='%OPRWEB06.12.110'>
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value=1>
<input type=hidden name=jmphflag value="1">
<input type=hidden name=checksub value="0">
<input type=hidden name=gnm>
<input type=hidden name=suprlevl value="%OPRWEB06.12.313">
<input type=hidden name=opdunqid value="">
<input type=hidden name=teamnumb value="%OPRWEB06.12.334">
<input type=hidden name=currdate value="%STANDARD.01.013">
<input type=hidden name=opard041>
<input type=hidden name=opsrg003>
<input type=hidden name=opsrg004>
<input type=hidden name=opard085 id=opard085 value="%OPRWEB06.12.585">
<input type=hidden name=opcncomb id=opcncomb value="%STANDARD.01.025.113.003.0.1">
<input type=hidden name=opsedtcm id=opsedtcm value="%OPRWEB06.12.483">
<input type=hidden name=opard071 id=opard071 value="%OPRWEB06.12.571">
<input type=hidden name=opard074 id=opard074 value="%OPRWEB06.12.574">
<input type=hidden name=opcnvrrd id=opcnvrrd 
 value="%STANDARD.01.025.113.017.0.2">
<input type=hidden name=opsework id=opsework value='%OPRWEB06.12.402'
 title="Session Date">
<input type=hidden name="admndate" id="admndate" value="%OPRWEB06.12.351"
 title="Admission Date">
<input type=hidden name="admntime" id="admntime" value="%OPRWEB06.12.352">
<input type=hidden name="discdate" id="discdate" value="%OPRWEB06.12.353"
 title="Discharge Date">
<input type=hidden name="disctime" id="disctime" value="%OPRWEB06.12.354">
<input type=hidden name=opcnctin id=opcnctin
 value="%STANDARD.01.025.113.032.0.1">
<input type=hidden name=opcncoso id=opcncoso
 value="%STANDARD.01.025.113.033.0.1">
<input type=hidden name=opcncrrh id=opcncrrh
 value="%STANDARD.01.025.113.034.0.1">
<input type=hidden name=opcnldae id=opcnldae
 value="%STANDARD.01.025.113.035.0.3">
<input type=hidden name=pocrect2 id=pocrect2
 value="%OPRWEB06.12.359">

<table border="0" cellpadding="0" cellspacing="0" width="100%" align=center>
<tr><td class=HeadingCell align=left>
    <img src=../images/ListIcon.gif class=Icon onclick='SessCaseList();'></td>
    <td align=center class=HeadingCell width=85%>
    Jessie McPherson In-Theatre Details
    </td>
    <td align=right class=HeadingCell><font color=red>
     %OPRWEB06.12.208</font></td>
</tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%" align=center>
<tr><td class=DataLabel>Consultant</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.12.404.003")'>
    %OPRWEB06.12.404.002 </a></td>
    <td class=DataLabel>Operating Surgeon</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.12.311.003")'>
    %OPRWEB06.12.311.002 </a></td>
    <td class=DataField>
    <input type=button value="Change Surgeon" class="button" id="changesurg"
     onclick="tempDisable(this);ChgSurgeon();"></td>
</tr>

<tr><td class=DataLabel>Unit</td>
    <td class="DataField">
       <select name=opses012 title="Unit" class=SelectBig>
        <option></option>
         %OPRWEB06.12.413.2
        </select></td>
    <td class=DataLabel>Theatre</td>
    <td class=DataField>%OPRWEB06.12.302</td>
    <td class=DataField>
       <input type=button value="Change Theatre" class="button" id="changethe"
        onclick="tempDisable(this);ChgOpr();"></td>
</tr> 

<tr><td class=DataLabel>Date </td>
    <td class=DataField>%OPRWEB06.12.406 %OPRWEB06.12.402</td>
    <td class=DataLabel>Time </td>
    <td class=DataField>%OPRWEB06.12.403</td>
    <td><input class="button" type=button value="Add Staff" id="addstaff"
         tabindex=-1 onclick="tempDisable(this);goToStaff();">
    </td>
</tr>
</table>

<hr>

<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td class=DataLabel>Procedure&nbsp;</td>
    <td> <input type=text size=116 name=opdea014 maxlength=55
          title="Procedure Description" value="%OPRWEB06.12.305"></td></tr>
<tr><td class=DataLabel>&nbsp;&nbsp;</td>
    <td> <input type=text size=116 name=opdea015 maxlength=55
     title="Procedure Description" value="%OPRWEB06.12.343"></td></tr> 
<tr><td class=DataLabel>&nbsp;&nbsp;</td>
    <td> <input type=text size=116 name=opdea016 maxlength=55
         title="Procedure Description" value="%OPRWEB06.12.344">
    </td></tr>
</table>

<br>
<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>

<tr><td class=DataLabel>Time Sent</td>
    <td class=DataField>
      <input type=text name=opard039 id=opard039 size=8 maxlength=8
       title="Time Sent" value="%OPRWEB06.12.539" tabindex=1
       onblur="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard039);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard039);"></td>

    <td class=DataLabel>Admitting Nurse</td>
    <td class=DataField>
      <input type=text name=opard003 id=opard003 title="Admitting Nurse Code" 
       size=6 class=DataField  maxlength=6 value="%OPRWEB06.12.503.1" 
       tabindex=10
       onblur="validateNurse(opard003,name_opard003);">
      <input type=text name=name_opard003 id=name_opard003 
       title="Admitting Nurse" tabindex=-1 class=ReadOnly readonly size=20 
       maxlength=30 value="%OPRWEB06.12.503.0">
      <img src="../images/SearchIcon.gif" class=Icon
       onclick="NurseSearchFrame(opard003,name_opard003);"></td>

    <td class=DataLabel>MBS Items</td>
    <td><input type=text size=15 class=Readonly readonly name=mbsitem
         tabindex=-1 value="%OPRWEB06.12.202" title="MBS item"></td>
    <td><input class="button" type=button name="itembutton" value="CMBS"
         id="itembutton" tabindex=-1
         onclick="tempDisable(this);AddMBSItem();"></td>
</tr>

<tr><td class=DataLabel>Time Arrived</td>
    <td class=DataField>
      <input type=text name=opard002 id=opard002 size=8 maxlength=8
       title="Time Arrived" value="%OPRWEB06.12.502" tabindex=2
       class="Mandatory" onblur="checkTime(this,this.title);chkAnaesTime();">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard002);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard002);"></td>

    <td>&nbsp;</td>
    <td>&nbsp;</td>

    <td class=DataLabel>Implant Items</td>
    <td><input type=text size=15 readonly tabindex=-1 class=Readonly 
         value=%OPRWEB06.12.204></td>
    <td><input class="button" type=button value="Full Time Out" id="fulltimeout"
         tabindex=-1 onclick="tempDisable(this);goToTimeOut();">
    </td>
</tr>

<tr><td class=DataLabel>Time into Theatre</td>
    <td class=DataField>
      <input type=text name=opard033 id=opard033 size=8 maxlength=8 tabindex=3
       title="Time into Theatre" value="%OPRWEB06.12.533" 
       onblur="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opard033);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opard033);"></td>

    <td>&nbsp;</td>
    <td>&nbsp;</td>

    <td class=DataLabel>Expensive Items</td>
    <td><input type=text size=15 readonly tabindex=-1 class=Readonly
         value=%OPRWEB06.12.206></td>

    <td><input class="button" type=button value="Incorrect Count"
         id="countcorrect" onclick="CountCorrectDFrame();">
    </td>
</tr>

<tr><td class=DataLabel>Anaesthetic Started</td>
    <td class=DataField>
      <input type=text name=opard042 id=opard042 size=8 maxlength=8 
       class="Mandatory" title="Anaesthetic Started" value="%OPRWEB06.12.542" 
       tabindex=4
       onblur="checkTime(this,this.title);chkAnaesTime();">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opard042);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opard042);"></td>

    <td class=DataLabel>Anaesthetic</td>
    <td class=DataField>
      <select name=opdea003 id=opdea003 title="Anaesthetic" tabindex=13>
        <option></option>
         %OPRWEB06.12.113.2
      </select></td>

    <td class=DataLabel>Time to ICU</td>
    <td class=DataField>
      <input type=text name=opard083 id=opard083 size=8 maxlength=8
       title="Time to ICU" value="%OPRWEB06.12.583" tabindex=22
       onblur="checkTime(this,this.title);chkTime(this);setETTime(this);">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard083);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard083);"></td>

    <td><input class="button" type=button value="Chg Over Count"
         id="chgovercount" onclick="ChgOverCount();"></td>
</tr>

<tr><td class=DataLabel>Time Out Performed</td>
    <td class=DataField><input type=text name=opard029 id=opard029 size=8 
       maxlength=8 title="Time Out Performed" value="%OPRWEB06.12.529" 
       tabindex=5
       onblur="checkTime(this,this.title);goToTimeOut();">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opard029);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opard029);"></td>

    <td>%STANDARD.01.017.ok</td>
    <td><select name=opard045 id=opard045 title="%STANDARD.01.017.ok" tabindex=14>
        <option></option>
         %OPRWEB06.12.545.2
      </select></td>

    <td class=DataLabel>Time Patient Died</td>
    <td class=DataField>
      <input type=text name=opard082 id=opard082 size=8 maxlength=8  tabindex=23
       title="Time Patient Died" value="%OPRWEB06.12.582" 
       onblur="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard082);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard082);"></td>

    <td><input class="button" type=button value="Clinical Details"
         id="clinicaldetails" tabindex=-1 
         onclick="tempDisable(this);ClinicalDetails();"></td>
</tr>

<tr><td class=DataLabel>Surgery Start</td>
    <td class=DataField>
      <input type=text name=opsrg005 id=opsrg005 id=opsrg005 size=8 maxlength=8
       title="Surgery Start Time" value="%OPRWEB06.12.337" tabindex=6
       onblur="checkTime(this,this.title);chkSurgStart();">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opsrg005);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opsrg005);"></td>

    <td class=DataLabel>Throat Pack In</td>
    <td class=DataField><input type=text name=opard031 id=opard031 size=8 
       maxlength=8 title="Throat Pack In" value="%OPRWEB06.12.531" tabindex=15
       onblur="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opard031);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opard031);"></td>

    <td class=DataLabel>Time into Recovery</td>
    <td class=DataField>

    <table border="0" cellpadding="0" cellspacing="0" width="100%" align=left>
    <tr><td class=DataField width=70%>
      <input type=text name=opard077 id=opard077 size=8 maxlength=8 tabindex=24
       onclick="displayCRRHI();"
       title="Time into Recovery - Day" value="%OPRWEB06.12.577"
       onblur="checkTime(this,this.title);chkTime(this);
               ChkRecovDelay()">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard077);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard077);">
    </td>
    <td class=DataField align=left>
      <div id=crrhiDIV></div>
    </td>
    </tr>
    </table>
    </td>
</tr>

<tr><td class=DataLabel>Surgery End</td>
    <td class=DataField>
      <input type=text name=opsrg006 id=opsrg006 size=8 maxlength=8
       title="Surgery End Time" value="%OPRWEB06.12.338" tabindex=7
       onblur="checkTime(this,this.title);chkSurgEnd();AnaestheticMand();
               ProcMan();">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opsrg006);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opsrg006);"></td>

    <td class=DataLabel>Throat Pack Out</td>
    <td class=DataField><input type=text name=opard032 id=opard032 size=8 
       maxlength=8 title="Throat Pack Out" value="%OPRWEB06.12.532" tabindex=16
       onblur="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opard032);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opard032);"></td>

    <td class=DataLabel>Exit Theatre Complex</td>
    <td class=DataField>
      <input type=text name=opard080 id=opard080 size=8 maxlength=8 tabindex=25
       title="Exit Theatre Complex Time" value="%OPRWEB06.12.580"
       onblur="if (checkTime(this,this.title)) {
                 chkTime(this);ChkRecovDelay();
                 ChgRTD();chkMan();chkMan2();}">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard080);">
      <img src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(opard080);"></td>
</tr>

<tr><td class=DataLabel>Anaesthetic Stop / Out</td>
    <td class=DataField>
      <input type=text name=opard043 id=opard043 size=8 maxlength=8 tabindex=8
       title="Anaesthetic Stop" value="%OPRWEB06.12.543"
       onblur="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,opard043);">
      <img src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(opard043);"></td>

    <td class=DataLabel>Count correct</td>
    <td class=DataField>
       <select name=opsrg008 title="Count Correct" tabindex=17
        onchange="CountCorrectPopUp();">
       <option></option>
       <option value=1>No</option>
       <option value=2>Yes</option>
      </select></td>

    <td class=DataLabel>Recovery Delay Reason</td>
    <td class=DataField colspan=2>
      <select name=opard084 id=opard084 title="Recovery Delay Reason" 
        tabindex=26>
        <option></option>
         %OPRWEB06.12.584.2
      </select></td>
</tr>

<tr><td class=DataLabel>Surgery Delay Reason</td>
    <td class=DataField>
    <select name=opsrg007 tabindex=9 title="Surgery Delay Reason">
    <option></option>
    %OPRWEB06.12.339.2
    </select></td>

    <td class="DataLabel">Wound Classification</td>
    <td><select name=opsrg060 title="Wound Classification" tabindex=18>
        <option></option>
         %OPRWEB06.12.660.2
        </select>
    </td>
</tr>

<tr>
  <td>&nbsp;</td>
</tr>

</table>

<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr valign=top><td class=DataLabel>Comments</td>
    <td class=DataField tabindex=28>
        <div id=CommentText></div> 
    </td></tr>

<tr><td colspan=2 align=center><br>
    <input type=button value=Update class="button" tabindex=40 id="opr06sub"
     onclick="tempDisable(this);checksubind();CheckDefaultTeamCompleted();UpdateDayProc();">
    <input type=button value=Cancel class="button" tabindex=50 
     onclick="RefreshPage();">
</td></tr>
</table>
</form>
</div>

<form  name=PatientLinks method=get>
<input type=hidden name=reportno value=12>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value='%OPRWEB06.12.003'>
<input type=hidden name=admissno value='%OPRWEB06.12.081'>
<input type=hidden name=MenuType value='%OPRWEB06.12.088'>
<input type=hidden name=casekeys value='%OPRWEB06.12.101'>
<input type=hidden name=sesskeys value='%OPRWEB06.12.102.oprweb01.03.003'>
<input type=hidden name=uniqueky value='%OPRWEB06.12.110'>
<input type=hidden name=teamnumb value='%OPRWEB06.12.334'>
<input type=hidden name=recrmurl id=recrmurl
 value='%OPRWEB06.12.102.oprweb01.04.029'>
</form>

<span id=ThtrCom style="display:none">
  <textarea wrap=hard cols=70 rows=3 name=opcom008> 
%OPRWEB06.12.143.008
  </textarea>
</span>

<span id=BookCom style="display:none">
  <textarea wrap=hard cols=70 rows=3 name=opcom008> 
%OPRWEB06.12.143.009
  </textarea>
</span>

<span id=crrhiSPAN style="display:none">
<img src=../images/CaseNoteIcon.gif class=Icon onclick="displayCRRHI();">
</span>

<script type="text/javascript">
// Default MBS Item from Booking
if (isWhitespace(document.UpdateForm.mbsitem.value))
  document.UpdateForm.mbsitem.value="%OPRWEB06.12.345";

// Default Comment from Booking
if (%OPRWEB06.12.211 == 0)                       // First display of this page?
  CommentText.innerHTML = BookCom.innerHTML;     // Yes, default from booking
else
  CommentText.innerHTML = ThtrCom.innerHTML;     // No, use Day Proc comments
// Set exit theatre complex time to be mandatory if there is a time to ICU
  if(!isWhitespace(UpdateForm.opard083.value)) {
    UpdateForm.opard080.className= "Mandatory"
  }

if (document.getElementById("opcncrrh").value=="2") {
  if (document.getElementById("pocrect2").value=="1") {
    crrhiDIV.innerHTML=crrhiSPAN.innerHTML;
  }
}
CorrectCount="%OPRWEB06.12.340"
UpdateForm.opsrg008.selectedIndex =CorrectCount ;

if ("%OPRWEB06.12.230.1" == "1") {
  document.getElementById('countcorrect').className="RedButton";
}

if ("%OPRWEB06.12.230.2" == "1") {
  document.getElementById('chgovercount').className="RedButton";
}

</script>

