<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="hea">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/TableSort.js></script>
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientClinicId.js"></script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link  
//  1 - Patient Name
//  2 - Sex
//  3 - DOB
//  4 - U/R
//  5 - Referral Date
//  6 - Last EOC
//  7 - Problem
//  8 - Healthcare Professional
//---------------------------------------------------------------------------
function InitTable(TableView) {
  ShowWaitScreen();

  window.setTimeout(function() {
    t = new Table(1,0,2,"100%","center",45,45);
    t.addColumn("Patient","ImageText",1,1,"left","PatientFolder","0",160,29)
    t.addColumn("From Hospital","String",28,28,"left","","",45)
    t.addColumn("Referral Date","Date",5,5,"left","","",65)
    t.addColumn("Expected Admit Date","Date",22,22,"left","","",65)
    t.addColumn(document.PatientLinks.cat_la.value,"String",25,25,"left","","",40)
    t.addColumn("Assessment Date","Date",21,21,"left","","",65)
    t.addColumn("Assessor","String",19,19,"left","","",40)
    t.addColumn("Fund","String",27,27,"left","","",25)
    t.addColumn(document.PatientLinks.cat_lb.value,"String",26,26,"left","","",40)
    t.addColumn("Status","String",18,18,"left","","",40)
    t.addColumn("Comments","String",20,20,"left","","",55)
    AddTableRows()
    TableOutput(2,0);    // Order Column,Asc Dsc
    TableSort(3)
    HideWaitScreen();
  },50);
}
//
function SelectPeriodSubmit() {
 SelectPeriod.submit();
}
//
function UpdateReferral(urn,adn,dpc) {
   PatientLinks.urnumber.value=urn;
   PatientLinks.admissno.value=adn;
   PatientLinks.deptcode.value=dpc;
   PatientLinks.submit();
}
//
function AddNewReferral() {
   AddReferral.doctcode.value=SelectPeriod.doctcode.value;
   Left=(document.body.clientWidth-900)/2;
   DFrameSubmit(AddReferral,0,Left,900,550);
}
function AddUserReferral() {
   if(isWhitespace(document.PatientLinks.wbsedall.value)) {
     alert("User does not have a default department.");
     return;
   }
   document.AddReferral.allrf001.value=document.PatientLinks.wbsedall.value;
   Left=(document.body.clientWidth-900)/2;
   DFrameSubmit(AddReferral,0,Left,900,550);
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);">
<div id="HeadingSection"> 
<div id="PHeadingSection">

<form name=PatientLinks action=allweb02.pbl method=get style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=2>
<input type=hidden name=urnumber>
<input type=hidden name=admissno>
<input type=hidden name=deptcode>
<input type=hidden name=wbsedall value="%STANDARD.01.028">
<input type=hidden name=cat_la value="%STANDARD.01.017.la">
<input type=hidden name=cat_lb value="%STANDARD.01.017.lb">
</form>

<form name=SelectPeriod action=allweb02.pbl method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=23>
<input type=hidden name=viewtype value="%ALLWEB02.01.008">
<input type=hidden name=ovrddept value="1">

<table width=100% cellspacing=0 border=0 bgcolor=#cccccc>
<tr><td>Department</td>
    <td><select class=PMenuSelectList name=deptcode 
         onchange="SelectPeriodSubmit()">
        <option value=" " >All</option>
         %ALLWEB02.01.012.2
        </select></td>

    <td class=DataLabel>Status</td>
    <td><select name=filtstat onchange="SelectPeriodSubmit();">
        <option value=" ">All</option>
        <option value="0">Waiting</option>
        <option value="1">Active</option>
        <option value="2">Closed</option>
        <option value="3">Inactive</option>
        <option value="4">Cancelled</option>
        <option value="5">Rejected</option>
        </select> </td>

    <td>Referral Date<input type=button value="<<" class=SmallButton
        oncLick='location.href="%ALLWEB02.01.002"'>
        %ALLWEB02.01.007 
       <input type=button value=">>" class=SmallButton
        onclick='location.href="%ALLWEB02.01.001"'>

    <align=right>
        <a href='javascript:SelectDateFrame();'>
        <img src="../images/DateLookup.gif" class="Icon"
         alt="Select Date"></a>
        <a href='javascript:SelectView("0");'>
        <img src=../images/DayIcon.gif class="Icon"
         alt="View Today"></a>
        <a href='javascript:SelectView("1");'>
        <img src=../images/WeekIcon.gif class="Icon"
         alt="View This Week"></a>
        <a href='javascript:SelectView("2");'>
        <img src=../images/MonthIcon.gif class="Icon"
         alt="View This Month"></a> </td>
</tr>
</table>
</form>
</div>

<form name=AddReferral method=get action=allweb02.pbl style="margin:0">
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=2>
<input type=hidden name=doctcode value="">
<table width=100% cellspacing=0 border=1 bgcolor=#cccccc>
<!--
<tr><td align=right class=HeadingCell colspan=2 >Add Referral
       <input type=button class=SlimButton value="Add"
        title="Add referral for users department" onclick="AddUserReferral();">
        <select class=PMenuSelectList name=allrf001 
         onmouseover='MenuOver(event,this)'
         onchange="AddNewReferral();">
        <option></option>
        ALLWEB02.01.012
        </select></td></tr>
-->
<tr><td width=95% class=HeadingCell align=center> 
        %ALLWEB02.01.023  Referrals - By Status & Referral Date</td> </tr>

</table>
</form>
</div>

<div id=TableLocation></div>

<span id=WaitBoxDisplay class=WaitBox style="display:none">
<img class=WaitImage src="../images/wait.gif">
<p>Please Wait ...</p>
</span>

<div id=PageLayer class=DimmedLayer style="display:none"></div>

<script type="text/javascript">
function AddTableRows() {
%ALLWEB02.01.034.1
}
 stat="%ALLWEB02.01.035";
 for (var i =0 ; i < document.SelectPeriod.filtstat.length; i++) {
  if (document.SelectPeriod.filtstat.options[i].value==stat.substr(0,3)) {
       document.SelectPeriod.filtstat.selectedIndex=i } };
</script>
