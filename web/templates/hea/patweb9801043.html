<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="hea">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">

<script type="text/javascript">
function setElect(){
  document.PrintLabels.labeltyp.value=document.PrintLabels.templab1.value;
  document.PrintLabels.labelty2.value=document.PrintLabels.templab2.value;
  document.PrintLabels.setdfpr2.value=document.PrintLabels.schdprn2.value;
  document.PrintLabels.setdfpr3.value=document.PrintLabels.schdprn3.value;

  if(document.PrintLabels.d_printmrt.checked!=true) {
    if((isWhitespace(document.PrintLabels.templab1.value)) ||
       (document.PrintLabels.d_multlt08.checked== false)){
      if((isWhitespace(document.PrintLabels.templab2.value)) ||
         (document.PrintLabels.d_multlt09.checked == false)) {
        if (document.PrintLabels.check_multlt02.checked == false) {
          if (document.PrintLabels.check_multlt03.checked == false) {
            if (document.PrintLabels.check_multlt04.checked == false) {
              if (document.PrintLabels.check_multlt05.checked == false) {
                if (document.PrintLabels.check_multlt06.checked == false) {
                 if (document.PrintLabels.check_multlt07.checked == false) {
                   if((isWhitespace(document.PrintLabels.statncoa.value)) ||
                     (document.PrintLabels.d_multlt10.checked == false)) {
                       alert("Please Select Label or Form to Print !");
                       return;
                   }
                 }
               }
              }
            }
          }
        }
      }
    }
  }
  
  if(document.PrintLabels.d_multlt10.checked == true){
    if(document.PrintLabels.statncoa.value==''){
      alert("Please Select Stationery form to Print!");
      return;
    }
    document.PrintLabels.schdprna.disabled=false;
    document.PrintLabels.schdprna.value=
    document.PrintLabels.d_schdprna.value;
  }
  else{document.PrintLabels.statncoa.value=''; }


  if ((isWhitespace(document.PrintLabels.templab1.value)) ||
      (document.PrintLabels.d_multlt08.checked==false)) {
    document.PrintLabels.schdprn1.disabled=true;
    document.PrintLabels.schdcop1.disabled=true;
    document.PrintLabels.labeltyp.disabled=true;
    document.PrintLabels.setdefp1.disabled=true;
  }

  if ((isWhitespace(document.PrintLabels.templab2.value)) ||
      (document.PrintLabels.d_multlt09.checked==false)) {
    document.PrintLabels.schdprn8.disabled=true;
    document.PrintLabels.schdcop8.disabled=true;
    document.PrintLabels.labelty2.disabled=true;
    document.PrintLabels.setdefp8.disabled=true;
  }

  if (document.PrintLabels.check_multlt02.value == false) {
    document.PrintLabels.schdprn2.disabled=true;
    document.PrintLabels.schdcop2.disabled=true;
    document.PrintLabels.setdefp2.disabled=true;
    document.PrintLabels.statnco2.disabled=true;
  }

  if (document.PrintLabels.check_multlt03.value == false) {
    document.PrintLabels.schdprn3.disabled=true;
    document.PrintLabels.schdcop3.disabled=true;
    document.PrintLabels.setdefp3.disabled=true;
    document.PrintLabels.statnco3.disabled=true;
  }

  if (document.PrintLabels.check_multlt04.checked == false) {
    document.PrintLabels.schdprn4.disabled=true;
    document.PrintLabels.schdcop4.disabled=true;
    document.PrintLabels.setdefp4.disabled=true;
    document.PrintLabels.statnco4.disabled=true;
  }

  if (document.PrintLabels.check_multlt05.checked == false) {
    document.PrintLabels.schdprn5.disabled=true;
    document.PrintLabels.schdcop5.disabled=true;
    document.PrintLabels.setdefp5.disabled=true;
    document.PrintLabels.statnco5.disabled=true;
  }

  if (document.PrintLabels.check_multlt06.checked == false) {
    document.PrintLabels.schdprn6.disabled=true;
    document.PrintLabels.schdcop6.disabled=true;
    document.PrintLabels.setdefp6.disabled=true;
    document.PrintLabels.statnco6.disabled=true;
  }

  if (document.PrintLabels.check_multlt07.checked == false) {
    document.PrintLabels.schdprn7.disabled=true;
    document.PrintLabels.schdcop7.disabled=true;
    document.PrintLabels.setdefp7.disabled=true;
    document.PrintLabels.statnco7.disabled=true;
  }


  if(validateMandatory(PrintLabels)) {
     FaxToLocalGP();
     if(document.PrintLabels.faxtolgp.checked == true) {
        if(isWhitespace(document.PrintLabels.freetxt6.value)){
           alert("Error - no GP fax number available to fax admission notification ");
           return;
        }
     }
     clearBrackets();
     if(RSPrintDocs()) {
        printMrtBarcode();
        PrintLabels.submit();
     }
  }
}
function clearBrackets(){
  p=document.PrintLabels
  p.freetxt5.value=p.freetxt5.value.replace(/\(/g,"");
  p.freetxt5.value=p.freetxt5.value.replace(/\)/g,"");
  p.freetxt6.value=p.freetxt6.value.replace(/\(/g,"");
  p.freetxt6.value=p.freetxt6.value.replace(/\)/g,"");
}
function changeValueForm() {
  if(document.PrintLabels.check_multlt02.checked == false) {
    document.PrintLabels.multlt02.disabled=true;
    document.PrintLabels.schdprn2.disabled=true;
    document.PrintLabels.schdcop2.disabled=true;
    document.PrintLabels.statnco2.disabled=true;
    document.PrintLabels.setdefp2.disabled=true;
    document.PrintLabels.schdprn2.className="";
    document.PrintLabels.schdcop2.className="SelectTny";
  }
  else {
    document.PrintLabels.multlt02.disabled=false;
    document.PrintLabels.schdprn2.disabled=false;
    document.PrintLabels.schdcop2.disabled=false;
    document.PrintLabels.statnco2.disabled=false;
    document.PrintLabels.setdefp2.disabled=false;
    document.PrintLabels.schdprn2.className="Mandatory";
    document.PrintLabels.schdcop2.className="Mandatory SelectTny";
  }
}
function changeValueClaim() {
  if(document.PrintLabels.check_multlt03.checked == false) {
    document.PrintLabels.multlt03.disabled=true;
    document.PrintLabels.schdprn3.disabled=true;
    document.PrintLabels.schdcop3.disabled=true;
    document.PrintLabels.setdefp3.disabled=true;
    document.PrintLabels.statnco3.disabled=true;
    document.PrintLabels.schdprn3.className="";
    document.PrintLabels.schdcop3.className="SelectTny";
  }
  else {
    document.PrintLabels.multlt03.disabled=false;
    document.PrintLabels.schdprn3.disabled=false;
    document.PrintLabels.schdcop3.disabled=false;
    document.PrintLabels.setdefp3.disabled=false;
    document.PrintLabels.statnco3.disabled=false;
    document.PrintLabels.schdprn3.className="Mandatory";
    document.PrintLabels.schdcop3.className="Mandatory SelectTny";
  }
}
function changeValueMedHis() {
  if(document.PrintLabels.check_multlt05.checked == false) {
    document.PrintLabels.schdprn5.disabled=true;
    document.PrintLabels.schdcop5.disabled=true;
    document.PrintLabels.setdefp5.disabled=true;
    document.PrintLabels.statnco5.disabled=true;
    document.PrintLabels.schdprn5.className="";
    document.PrintLabels.schdcop5.className="SelectTny";
  }
  else {
    document.PrintLabels.schdprn5.disabled=false;
    document.PrintLabels.schdcop5.disabled=false;
    document.PrintLabels.statnco5.disabled=false;
    document.PrintLabels.schdprn5.className="Mandatory";
    document.PrintLabels.schdcop5.className="Mandatory SelectTny";
  }
}

function changeValueConsent() {
  if(document.PrintLabels.check_multlt06.checked == false) {
    document.PrintLabels.schdprn6.disabled=true;
    document.PrintLabels.schdcop6.disabled=true;
    document.PrintLabels.setdefp6.disabled=true;
    document.PrintLabels.statnco6.disabled=true;
    document.PrintLabels.schdprn6.className="";
    document.PrintLabels.schdcop6.className="SelectTny";
  }
  else {
    document.PrintLabels.schdprn6.disabled=false;
    document.PrintLabels.schdcop6.disabled=false;
    document.PrintLabels.statnco6.disabled=false;
    document.PrintLabels.schdprn6.className="Mandatory";
    document.PrintLabels.schdcop6.className="Mandatory SelectTny";
  }
}

function changeValueSupDoc() {
  if(document.PrintLabels.check_multlt07.checked == false) {
    document.PrintLabels.schdprn7.disabled=true;
    document.PrintLabels.schdcop7.disabled=true;
    document.PrintLabels.setdefp7.disabled=true;
    document.PrintLabels.statnco7.disabled=true;
    document.PrintLabels.schdprn7.className="";
    document.PrintLabels.schdcop7.className="SelectTny";
  }
  else {
    document.PrintLabels.schdprn7.disabled=false;
    document.PrintLabels.schdcop7.disabled=false;
    document.PrintLabels.statnco7.disabled=false;
    document.PrintLabels.schdprn7.className="Mandatory";
    document.PrintLabels.schdcop7.className="Mandatory SelectTny";
  }
}

function changeValueLetter() {

  if (document.PrintLabels.check_multlt04.checked == false) {
    document.PrintLabels.multlt04.value="";
    document.PrintLabels.schdprn4.disabled=true;
    document.PrintLabels.schdcop4.disabled=true;
    document.PrintLabels.setdefp4.disabled=true;
    document.PrintLabels.statnco4.disabled=true;
    document.PrintLabels.statnco4.value='';
    document.PrintLabels.freetxt4.value='';
    document.PrintLabels.schdprn4.className="";
    document.PrintLabels.schdcop4.className="SelectTny";
  }
  else {
    document.PrintLabels.multlt04.value="ADLET1";
    document.PrintLabels.schdprn4.disabled=false;
    document.PrintLabels.schdcop4.disabled=false;
    document.PrintLabels.setdefp4.disabled=false;
    document.PrintLabels.statnco4.disabled=false;
    document.PrintLabels.statnco4.value=document.PrintLabels.multlt04.value;
    document.PrintLabels.freetxt4.value=document.PrintLabels.multlt04.value;
    document.PrintLabels.schdprn4.className="Mandatory";
    document.PrintLabels.schdcop4.className="Mandatory SelectTny";
  }
}
function setMrtFields() {
  if(document.PrintLabels.d_printmrt.checked==true) {
     document.PrintLabels.d_mrtprntr.disabled=false;
     document.PrintLabels.d_mrtprntr.className="Mandatory";
     document.PrintLabels.d_mrtms001.disabled=false;
     document.PrintLabels.d_mrtms001.className="Mandatory";
     document.PrintLabels.d_nomrtlab.disabled=false;
     document.PrintLabels.d_nomrtlab.className="Mandatory SelectTny";
     document.PrintLabels.d_mrtms002.disabled=false;
     document.PrintLabels.d_mrtms002.className="Mandatory";
     document.PrintLabels.d_mrtms003.disabled=false;
     document.PrintLabels.d_mrtms003.className="Mandatory";
     getLinkedMR();
  } else {
     document.PrintLabels.d_mrtprntr.disabled=true;
     document.PrintLabels.d_mrtprntr.className="";
     document.PrintLabels.d_mrtms008.value=" "
     document.PrintLabels.d_mrtms001.disabled=true;
     document.PrintLabels.d_mrtms001.className="";
     document.PrintLabels.d_mrtms001.length=0;
     document.PrintLabels.d_nomrtlab.disabled=true;
     document.PrintLabels.d_nomrtlab.className="SelectTny";
     document.PrintLabels.d_mrtms002.disabled=true;
     document.PrintLabels.d_mrtms002.className="";
     document.PrintLabels.d_mrtms002.length=0;
     document.PrintLabels.d_mrtms003.disabled=false;
     document.PrintLabels.d_mrtms003.className="";
     document.PrintLabels.d_mrtms003.length=0;
  }
}
function getLinkedMR() {
  p=document.PrintLabels;
  p.d_mrtms001.length=0;
  p.d_mrtms002.length=0;
  p.d_mrtms003.length=0;
  var serverURL = "../cgi-bin/mrtweb01.pbl?reportno=20&updttype=C&admissno=" + p.admissno.value.replace(/ /g,"+");
  var returnValue = RSExecute(serverURL);
  ReturnValue=returnValue.return_value.split("|");

  if(returnValue.status==0) {
     HomeHosp=ReturnValue[1];
     HomeLoc=ReturnValue[3];
     DocType=ReturnValue[5];
     Volume=ReturnValue[7];
     p.d_mrtms008.value=HomeHosp;
     getLinkedHomeLoc();

     for(var i=0; i<document.PrintLabels.d_mrtms001.length; i++) {
       if(document.PrintLabels.d_mrtms001.options[i].value==HomeLoc) {
          document.PrintLabels.d_mrtms001.selectedIndex = i;
       }
     }
     getLinkedDocTypes();
     for(var i=0; i<document.PrintLabels.d_mrtms002.length; i++) {
       if(document.PrintLabels.d_mrtms002.options[i].value==DocType) {
          document.PrintLabels.d_mrtms002.selectedIndex = i;
       }
     }
     getLinkedVolumes();
     for(var i=0; i<document.PrintLabels.d_mrtms003.length; i++) {
       if(document.PrintLabels.d_mrtms003.options[i].value==Volume) {
          document.PrintLabels.d_mrtms003.selectedIndex = i;
       }
     }
  }
}
function getLinkedHomeLoc() {
  p = document.PrintLabels;
  var serverURL = "../cgi-bin/mrtweb01.pbl?reportno=20&updttype=H" +
                  "&urnumber=" + p.urnumber.value.replace(/ /g,"+") +
                  "&mrtms008=" + p.d_mrtms008.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  ReturnValue=returnValue.return_value.split("|");
  p.d_mrtms001.length=0;
  if(returnValue.status==0) {
    for(var j=0; j<ReturnValue.length; j++) {
      if(!isWhitespace(ReturnValue[j])) {
         SelectValue=ReturnValue[j].split(",");
         p.d_mrtms001.options[p.d_mrtms001.options.length]= new Option(SelectValue[1],SelectValue[0]);
      }
    }
  }
}
function getLinkedDocTypes() {
  p = document.PrintLabels;
  if(isWhitespace(p.d_mrtms001.value)) {
     p.d_mrtms002.length=0;
     return;
  }
  var serverURL = "../cgi-bin/mrtweb01.pbl?reportno=20&updttype=T" +
                  "&urnumber=" + p.urnumber.value.replace(/ /g,"+") +
                  "&mrtms008=" + p.d_mrtms008.value.replace(/ /g,"+") +
                  "&mrtms001=" + p.d_mrtms001.value.replace(/ /g,"+") 
  var returnValue = RSExecute(serverURL);
  ReturnValue=returnValue.return_value.split("|");
  p.d_mrtms002.length=0;
  if(returnValue.status==0) {
    for(var j=0; j < ReturnValue.length; j++) {
      if(!isWhitespace(ReturnValue[j])) {
        SelectValue=ReturnValue[j].split(",");
        p.d_mrtms002.options[p.d_mrtms002.options.length]=new Option(SelectValue[1],SelectValue[0]);
      }
    }
  }
}
function getLinkedVolumes() {
  p = document.PrintLabels;
  if(isWhitespace(p.d_mrtms001.value) || isWhitespace(p.d_mrtms002.value)) {
    p.d_mrtms003.length = 0;
    return;
  }
  var serverURL = "../cgi-bin/mrtweb01.pbl?reportno=20&updttype=V" +
                  "&urnumber=" + p.urnumber.value.replace(/ /g,"+") +
                  "&mrtms008=" + p.d_mrtms008.value.replace(/ /g,"+") +
                  "&mrtms001=" + p.d_mrtms001.value.replace(/ /g,"+") +
                  "&mrtms002=" + p.d_mrtms002.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  ReturnValue = returnValue.return_value.split("|");
  p.d_mrtms003.length = 0;
  if(returnValue.status==0) {
    for(var j=0; j < ReturnValue.length; j++) {
      if(!isWhitespace(ReturnValue[j])) {
        p.d_mrtms003.options[p.d_mrtms003.options.length] = new Option(ReturnValue[j],ReturnValue[j]);
      }
    } 
  }
}
function printMrtBarcode() { 
  p = document.PrintLabels;
  if(document.PrintLabels.d_printmrt.checked!=true) {
     return;
  }
  <!-- home hospital -->
  document.pbarcode.mrtms008.value=p.d_mrtms008.value.replace(/ /g,"+");
  <!-- home location -->
  document.pbarcode.mrtms001.value=p.d_mrtms001.value.replace(/ /g,"+");
  <!-- document type -->
  document.pbarcode.mrtms002.value=p.d_mrtms002.value.replace(/ /g,"+");
  <!-- volume -->
  document.pbarcode.mrtms003.value=p.d_mrtms003.value.replace(/ /g,"+");
  <!-- printer -->
  document.pbarcode.selprint.value=p.d_mrtprntr.value;
  <!-- number of labels -->
  document.pbarcode.nolabels.value=p.d_nomrtlab.value;
  var theURL="mrtweb01.pbl";
  var postStr=AJAXPostString(document.pbarcode);
  xmlHttp = createHttpObject();
  xmlHttp.open("POST", theURL, false);
  xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded;");
  xmlHttp.send(postStr);
  if(xmlHttp.status=="200") {
    if(xmlHttp.responseText.match(/alert/i)){
     alert( xmlHttp.responseText.replace(/.*alert../i,"").replace(/.\).*/i,"") );
    }
  } 
  else {
    alert("Barcode Printing Web Service Not Available. Check your Connection and Try Again.");
  }
}
function ResetForm(){
  document.PrintLabels.multlt02.disabled=false;
  document.PrintLabels.schdprn2.disabled=false;
  document.PrintLabels.schdprn2.className="";
  document.PrintLabels.schdcop2.disabled=false;
  document.PrintLabels.statnco2.disabled=false;

  document.PrintLabels.multlt03.disabled=false;
  document.PrintLabels.schdprn3.disabled=false;
  document.PrintLabels.schdprn3.className="";
  document.PrintLabels.schdcop3.disabled=false;
  document.PrintLabels.statnco3.disabled=false;

  document.PrintLabels.multlt10.value=0;
  document.PrintLabels.multlt10.disabled=true;
  document.PrintLabels.statncoa.disabled=true;
  document.PrintLabels.schdcopa.disabled=true;
  document.PrintLabels.schdprna.disabled=true;
  document.PrintLabels.d_schdprna.disabled=true;
  document.PrintLabels.schdcopa.className="SelectTny";
  document.PrintLabels.schdprna.className="";
  document.PrintLabels.d_schdprna.className="";


  if (!document.PrintLabels.check_multlt04.disabled) {
    document.PrintLabels.multlt04.value="ADLET1";
    document.PrintLabels.schdprn4.disabled=false;
    document.PrintLabels.schdprn4.className="";
    document.PrintLabels.schdcop4.disabled=false;
    document.PrintLabels.setdefp4.disabled=false;
    document.PrintLabels.statnco4.disabled=false;
    document.PrintLabels.freetxt4.disabled=false;
  }
  document.PrintLabels.reset();
  LastLabelType="LABELINP04";
  if(!isWhitespace(LastLabelType)) {
    for(var i=0; i<document.PrintLabels.templab1.length; i++) {
      if(document.PrintLabels.templab1.options[i].value==LastLabelType) {
         document.PrintLabels.templab1.selectedIndex = i;
      }
    }
    for(var i=0; i<document.PrintLabels.templab2.length; i++) {
      if(document.PrintLabels.templab2.options[i].value==LastLabelType) {
         document.PrintLabels.templab2.selectedIndex = i;
      }
    }
  }
  FixRow1();  
  FixRow2();
  changeValueMedHis();
  changeValueConsent();
  changeValueSupDoc();
  SetDeflteAdmisSelns();
}
//
function FaxToLocalGP(){
  if(document.PrintLabels.faxtolgp.checked == true) {
     document.PrintLabels.freetxt4.value = document.PrintLabels.statnco4.value;
  } 
  else {
     document.PrintLabels.freetxt4.value = "";
  }
}
function Init() {
    document.PrintLabels.schdprn5.disabled=true;
    document.PrintLabels.schdcop5.disabled=true;
    document.PrintLabels.setdefp5.disabled=true;
    document.PrintLabels.statnco5.disabled=true;
    document.PrintLabels.schdprn5.className="";
    document.PrintLabels.schdcop5.className="SelectTny";

    document.PrintLabels.schdprn6.disabled=true;
    document.PrintLabels.schdcop6.disabled=true;
    document.PrintLabels.setdefp6.disabled=true;
    document.PrintLabels.statnco6.disabled=true;
    document.PrintLabels.schdprn6.className="";
    document.PrintLabels.schdcop6.className="SelectTny";

    document.PrintLabels.schdprn7.disabled=true;
    document.PrintLabels.schdcop7.disabled=true;
    document.PrintLabels.setdefp7.disabled=true;
    document.PrintLabels.statnco7.disabled=true;
    document.PrintLabels.schdprn7.className="";
    document.PrintLabels.schdcop7.className="SelectTny";
}

// init eAdmission document type (Past Medical, Consent Form, Supporting Docs)
function SetDeflteAdmisSelns() {
  if(document.PrintLabels.pmhdocex.value == "1") {
    document.PrintLabels.schdprn5.disabled = false;
    document.PrintLabels.schdprn5.className="";
    document.PrintLabels.schdcop5.disabled = false;
    document.PrintLabels.check_multlt05.checked = true;
  }
  else {
    document.getElementById('trPastMedHis').disabled = true;
  }

  if(document.PrintLabels.condocex.value == "1") {
    document.PrintLabels.schdprn6.disabled = false;
    document.PrintLabels.schdprn6.className="";
    document.PrintLabels.schdcop6.disabled = false;
    document.PrintLabels.check_multlt06.checked = true;
  }
  else {
    document.getElementById('trConsFrm').disabled = true;
  }

  if(document.PrintLabels.supdocex.value == "1") {
    document.PrintLabels.schdprn7.disabled = false;
    document.PrintLabels.schdprn7.className="";
    document.PrintLabels.schdcop7.disabled = false;
    document.PrintLabels.check_multlt07.checked = true;
  }
  else {
    document.getElementById('trSuppDocs').disabled = true;
  }
}

//
// Validate eAdmission document printers have a selection if print is selected
function eAdmissPrntSelected() {
  var p = document.PrintLabels;

  if(p.check_multlt05.checked) {
    if(isWhitespace(p.schdprn5.value)) {
       p.schdprn5.className = "Mandatory";
       alert(p.schdprn5.title + " is a required field.");
       p.schdprn5.focus();
       return false;
    }
  }

  if(p.check_multlt06.checked) {
    if(isWhitespace(p.schdprn6.value)) {
       p.schdprn6.className = "Mandatory";
       alert(p.schdprn6.title + " is a required field.");
       p.schdprn6.focus();
       return false;
    }
  }

  if(p.check_multlt07.checked) {
    if(isWhitespace(p.schdprn7.value)) {
       p.schdprn7.className = "Mandatory";
       alert(p.schdprn7.title + " is a required field.");
       p.schdprn7.focus();
       return false;
    }
  }

  return true;
}

//
// Remote script function to print eAdmission documents by type.
//  Type:
//   1 - Past Medical History
//   2 - Consent Form
//   3 - Supporting Documents
function RSPrintDocs() {
  var p = document.PrintLabels;
  var result = 0;
  var doctyp;  // document type
  var prtcod;  // printer code
  var nocpys;  // number of copies
  var urno = p.urnumber.value.replace(/ /g,"+");
  var admno = p.admissno.value.replace(/ /g,"+");

  if (!eAdmissPrntSelected()) {
    return false;
  }

  // Print Past Medical History
  if (p.check_multlt05.checked) {
    doctyp = '1';
    prtcod = p.schdprn5.options[p.schdprn5.selectedIndex].value;
    nocpys = p.schdcop5.options[p.schdcop5.selectedIndex].value;

    var serverURL = "../cgi-bin/patweb14.pbl?reportno=7&websrvno=3" +
                    "&prnturno=" + urno + "&prntvisn=" + admno +
                    "&prntdtyp=" + doctyp + "&prntprtc=" + prtcod + 
                    "&prntcpys=" + trim(nocpys);
   
    var returnValue = RSExecute(serverURL);
    if (returnValue.status != 0) {
      alert("Unable to print Past Medical History documents. \n" +
	"Please check that PATWEB14 is running.");
      return false;
    }
  }

  //
  // Print Consent Form
  if (p.check_multlt06.checked) {
    doctyp = '2';
    prtcod = p.schdprn6.options[p.schdprn6.selectedIndex].value;
    nocpys = p.schdcop6.options[p.schdcop6.selectedIndex].value;

    var serverURL = "../cgi-bin/patweb14.pbl?reportno=7&websrvno=3" +
                    "&prnturno=" + urno + "&prntvisn=" + admno +
                    "&prntdtyp=" + doctyp + "&prntprtc=" + prtcod + 
                    "&prntcpys=" + trim(nocpys);
   
    var returnValue = RSExecute(serverURL);
    if(returnValue.status != 0) {
       alert("Unable to print Consent Form documents. \n" +
       "Please check that PATWEB14 is running.");
       return false;
    }
  }

  //
  // Print Supporting Documents
  if (p.check_multlt07.checked) {
    doctyp = '3';
    prtcod = p.schdprn7.options[p.schdprn7.selectedIndex].value;
    nocpys = p.schdcop7.options[p.schdcop7.selectedIndex].value;

    var serverURL = "../cgi-bin/patweb14.pbl?reportno=7&websrvno=3" +
                    "&prnturno=" + urno + "&prntvisn=" + admno +
                    "&prntdtyp=" + doctyp + "&prntprtc=" + prtcod + 
                    "&prntcpys=" + trim(nocpys);
   
    returnValue = RSExecute(serverURL);
    if(returnValue.status != 0) {
       alert("Unable to print Supporting Documents. \n" +
       "Please check that PATWEB14 is running.");
       return false;
    }
  }


  return true;
}

function PrinterChange(ddl) {
  if(isWhitespace(ddl.options[ddl.selectedIndex].value)){
     ddl.className = "Mandatory";
  }
  else{
     ddl.className = "";
  }
}
function FixRow1() {
 if ((document.PrintLabels.d_multlt08.checked==false)) {
    document.PrintLabels.templab1.disabled=true;
    document.PrintLabels.schdprn1.disabled=true;
    document.PrintLabels.schdprn1.className="";
    document.PrintLabels.schdcop1.disabled=true;
    document.PrintLabels.schdcop1.className="SelectTny";
    document.PrintLabels.setdefp1.disabled=true;
    document.PrintLabels.labeltyp.value="";
    document.PrintLabels.labeltyp.disabled=true;

 } else {
    document.PrintLabels.templab1.disabled=false;
    if((isWhitespace(document.PrintLabels.templab1.value))){
      document.PrintLabels.schdprn1.disabled=true;
      document.PrintLabels.schdprn1.className="";
      document.PrintLabels.schdcop1.disabled=true;
      document.PrintLabels.schdcop1.className="SelectTny";
      document.PrintLabels.setdefp1.disabled=true;
      document.PrintLabels.labeltyp.disabled=true;
    }
    else{
      document.PrintLabels.schdprn1.disabled=false;
      document.PrintLabels.schdprn1.className="Mandatory";
      document.PrintLabels.schdcop1.disabled=false;
      document.PrintLabels.schdcop1.className="Mandatory SelectTny";
      document.PrintLabels.setdefp1.disabled=false;
      document.PrintLabels.labeltyp.disabled=false;
    }
 }
}
function FixRow2() {
 if ((document.PrintLabels.d_multlt09.checked==false)) {
    document.PrintLabels.templab2.disabled=true;
    document.PrintLabels.schdprn8.disabled=true;
    document.PrintLabels.schdprn8.className="";
    document.PrintLabels.schdcop8.disabled=true;
    document.PrintLabels.schdcop8.className="SelectTny";
    document.PrintLabels.setdefp8.disabled=true;
    document.PrintLabels.labelty2.value="";
    document.PrintLabels.labelty2.disabled=true;
 } else {
      document.PrintLabels.templab2.disabled=false;
    if((isWhitespace(document.PrintLabels.templab2.value))){
      document.PrintLabels.schdprn8.disabled=true;
      document.PrintLabels.schdprn8.className="";
      document.PrintLabels.schdcop8.disabled=true;
      document.PrintLabels.schdcop8.className="SelectTny";
      document.PrintLabels.setdefp8.disabled=true;
      document.PrintLabels.labelty2.disabled=true;
    }
    else{
      document.PrintLabels.schdprn8.disabled=false;
      document.PrintLabels.schdprn8.className="Mandatory";
      document.PrintLabels.schdcop8.disabled=false;
      document.PrintLabels.schdcop8.className="Mandatory SelectTny";
      document.PrintLabels.setdefp8.disabled=false;
      document.PrintLabels.labelty2.disabled=false;
   }
 }
}
function printForm(bool){
    if(document.PrintLabels.d_multlt10.checked == false){
       document.PrintLabels.statncoa.disabled=true;
       document.PrintLabels.multlt10.value=0;
       document.PrintLabels.multlt10.disabled=true;  
       document.PrintLabels.schdcopa.disabled=true;  
       document.PrintLabels.d_schdprna.disabled=true;  
       document.PrintLabels.schdcopa.className="SelectTny";
 //      document.PrintLabels.statncoa.className="";
       document.PrintLabels.d_schdprna.className="";
    }
    else{
         document.PrintLabels.statncoa.disabled=false;
       if(document.PrintLabels.statncoa.value==''){
         document.PrintLabels.multlt10.value=0;
         document.PrintLabels.multlt10.disabled=true;
         document.PrintLabels.schdcopa.disabled=true;
         document.PrintLabels.d_schdprna.disabled=true;
         document.PrintLabels.schdcopa.className="SelectTny";
         document.PrintLabels.d_schdprna.className="";
       }
       else{
         document.PrintLabels.multlt10.value=1; 
         document.PrintLabels.d_multlt10.value=1; 
         document.PrintLabels.multlt10.disabled=false;  
         document.PrintLabels.schdcopa.disabled=false;
         document.PrintLabels.d_schdprna.disabled=false;
         document.PrintLabels.schdcopa.className="SelectTny Mandatory";
//       document.PrintLabels.statncoa.className="Mandatory";
         document.PrintLabels.d_schdprna.className="Mandatory";     
       }
    }
  }

function fixPrintform(){
  if(document.PrintLabels.d_multlt10.checked == true){
    document.PrintLabels.schdprna.disabled=false;
    document.PrintLabels.schdprna.value=
    document.PrintLabels.d_schdprna.value;
  }
  else{
      document.PrintLabels.schdprna.disabled=true;
  }
}
</script>
%START.OF.PAGE
</head>
<body onload="PageLoad(event);">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB98.01.003";
PatientVIS="%PATWEB98.01.081";
PatientNAM="%PATWEB98.01.002";
PatientSTA="%PATWEB98.01.086.078";
PatientALT="%PATWEB98.01.084";
PatientSEX="%PATWEB98.01.019";
PatientDOB="%PATWEB98.01.020";
PatientAGE="%PATWEB98.01.021";
PatientLOC="%PATWEB98.01.083";
PatientPRI="%PATWEB98.01.086.066.1";
PatientUNT="%PATWEB98.01.066.0";
DoctorCOD="%PATWEB98.01.082.003";
DoctorNAM="%PATWEB98.01.082.002";
PatientAID="%PATWEB98.01.086.090";
PatientIND="%PATWEB98.01.086.091";
PatientCUR="%PATWEB98.01.086.092";
PatientCLC="%PATWEB98.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB98.01.086.094";
PatientCDM="%PATWEB98.01.086.095";
PatientVDH="%PATWEB98.01.086.099.015";
PatienCLC="%PATWEB98.01.126.1";
InsertPatientHeader();
</script>

<div id=PatientMenu></div>

<form name=PrintLabels action=rshweb02.pbl method=get style="margin:0"
 onsubmit='return validateMandatory(this);'>
<input type=hidden name=reportno value="02">
<input type=hidden name=template value=001>
<input type=hidden name=updttype value="L">
<input type=hidden name=multprnt value="1">
<input type=hidden name=sbwindow value=1>
<input type=hidden name=nextpage value="1">
<input type=hidden name=urnumber value="%PATWEB98.01.003">
<input type=hidden name=admissno value="%PATWEB98.01.081">
<input type=hidden name=redirect value="%PATWEB98.01.001.patweb98.01.002">
<input type=hidden name=setdfpg2 value="">
<input type=hidden name=setdfrep value="01">
<input type=hidden name=setdfpr2>
<input type=hidden name=setdfpr3>
<input type=hidden name=freetxt4 value="">
<input type=hidden name=freetxt5 value="%PATWEB98.01.784.081">
<input type=hidden name=freetxt6 value="">
<input type=hidden name=pmhdocex value="%PATWEB98.01.899.013">
<input type=hidden name=condocex value="%PATWEB98.01.899.014">
<input type=hidden name=supdocex value="%PATWEB98.01.899.015">

<table cellspacing=0 cellpadding=1 border=0 width=100%>
<tr><td class=HeadingCell align=center width=100%>Final Admission</td></tr>
</table>
<table cellspacing=0 cellpadding=0 border=0 width=90% align=center>

<tr>
  <td class=DataLabel><b>Patient Label</b></td>
  <td><input type=hidden name=multlt08 value=1>
      <input type=checkbox name=d_multlt08 checked value=1
      onclick="FixRow1();">
    <select name=templab1 width=50% onchange="FixRow1();">
      <option></option>
      %STANDARD.01.019.LABELINP.1
      %STANDARD.01.019.LABELPMI.1
    </select>
  </td>
  <td class=DataLabel>Printer</td>
  <td>
    <select name=schdprn1 title="Patient Label Printer" disabled>
      <option></option>
      %STANDARD.01.001.FINALADM.01
    </select>
  </td>
  <td>&nbsp;</td>
  <td>&nbsp;
    <input type=hidden name=labeltyp value="">
    <input type=hidden name=setdefp1 value="FINALADM01"></td>
  <td class=DataLabel>Number of Labels</td>
  <td>
    <select name=schdcop1 class=SelectTny disabled>
      %STANDARD.01.027.3.1
    </select>
  </td>
</tr>

<tr>
  <td class=DataLabel><b>Other Label</b></td>
  <td><input type=hidden name=multlt09 value=1>
      <input type=checkbox name=d_multlt09 checked value=1
      onclick="FixRow2();">
    <select name=templab2 width=50% onchange="FixRow2();">
      <option></option>
      %STANDARD.01.019.LABELINP.1
      %STANDARD.01.019.LABELPMI.1
    </select>
  </td>
  <td class=DataLabel>Printer</td>
  <td>
    <select name=schdprn8 title="Other Label Printer" disabled>
      <option></option>
      %STANDARD.01.001.FINALADM.02
    </select>
  </td>
  <td>&nbsp;</td>
  <td>&nbsp;
    <input type=hidden name=labelty2 value="">
    <input type=hidden name=setdefp8 value="FINALADM02"></td>
  <td class=DataLabel>Number of Labels</td>
  <td>
    <select name=schdcop8 class=SelectTny disabled>
    %STANDARD.01.027.3.1
    </select>
  </td>
</tr>

<tr>
  <td class=DataLabel><b>Front Sheet</b></td>
  <td>
    <input type=checkbox checked value="1" name=check_multlt02
     onclick="changeValueForm();">
    <input type=hidden name=multlt02 value="1">
  </td>
  <td class=DataLabel>Printer</td>
  <td>
    <select name=schdprn2 onchange="PrinterChange(this);" title="Front Sheet Printer">
      <option></option>
      %STANDARD.01.001.FORMFRNT.01
    </select>

  <input type=hidden name=statnco2 value="%STANDARD.01.025.059.141.0.6">
  <input type=hidden name=setdefp2 value="FORMFRNT01">
  </td>

  <td>&nbsp;</td>
  <td>&nbsp;</td>
  <td class=DataLabel>Number of Copies</td>
  <td>
    <select name=schdcop2 class=SelectTny>
      <option value=" 1" selected>1</option>
      <option value=" 2">2</option>
      <option value=" 3">3</option>
      <option value=" 4">4</option>
      <option value=" 5">5</option>
      <option value=" 10">10</option>
      <option value=" 15">15</option>
      <option value=" 20">20</option>
      <option value=" 25">25</option>
      <option value=" 30">30</option>
      <option value=" 35">35</option>
      <option value=" 40" >40</option>
    </select>
  </td>
</tr>

<tr>
  <td class=DataLabel><b>Claim Form</b></td>
  <td>
    <input type=checkbox checked value="1" name=check_multlt03
     onclick="changeValueClaim();">
    <input type=hidden name=multlt03 value="1">
  </td>
  <td class=DataLabel>Printer</td>
  <td>
    <select name=schdprn3 onchange="PrinterChange(this);" title="Claim Form Printer">
      <option></option>
      %STANDARD.01.001.FORMCLAM.01
    </select>
  <input type=hidden name=statnco3 value="NCFP2">
  <input type=hidden name=setdefp3 value="FORMCLAM01">
  </td>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
  <td class=DataLabel>Number of Copies</td>
  <td>
    <select name=schdcop3 class=SelectTny>
      <option value=" 1" selected>1</option>
      <option value=" 2">2</option>
      <option value=" 3">3</option>
      <option value=" 4">4</option>
      <option value=" 5">5</option>
      <option value=" 10">10</option>
      <option value=" 15">15</option>
      <option value=" 20">20</option>
      <option value=" 25">25</option>
      <option value=" 30">30</option>
      <option value=" 35">35</option>
      <option value=" 40" >40</option>
    </select>
  </td>
</tr>

<tr id=trPastMedHis>
  <td class=DataLabel><b>Past Medical History</b></td>
  <td>
    <input type=checkbox value="1" name=check_multlt05 onclick="changeValueMedHis();">
  </td>
  <td class=DataLabel>Printer</td>
  <td>
    <select name=schdprn5 onchange="PrinterChange(this);" title="Past Medical History Printer" disabled>
      <option></option>
      %STANDARD.01.001.FORMMHIS.01
    </select>
  <input type=hidden name=statnco5 value="FORMMHIS">
  <input type=hidden name=setdefp5 value="FORMMHIS01">
  </td>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
  <td class=DataLabel>Number of Copies</td>
  <td>
    <select name=schdcop5 class=SelectTny disabled>
      <option value=" 1" selected>1</option>
      <option value=" 2">2</option>
      <option value=" 3">3</option>
      <option value=" 4">4</option>
      <option value=" 5">5</option>
      <option value=" 10">10</option>
      <option value=" 15">15</option>
      <option value=" 20">20</option>
      <option value=" 25">25</option>
      <option value=" 30">30</option>
      <option value=" 35">35</option>
      <option value=" 40" >40</option>
    </select>
  </td>
</tr>

<tr id=trConsFrm>
  <td class=DataLabel><b>Consent Form</b></td>
  <td>
    <input type=checkbox value="1" name=check_multlt06 onclick="changeValueConsent();">
  </td>
  <td class=DataLabel>Printer</td>
  <td>
    <select name=schdprn6 onchange="PrinterChange(this);" title="Consent Form Printer" disabled>
      <option></option>
      %STANDARD.01.001.FORMCONS.01
    </select>
  <input type=hidden name=statnco6 value="FORMCONS">
  <input type=hidden name=setdefp6 value="FORMCONS01">
  </td>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
  <td class=DataLabel>Number of Copies</td>
  <td>
    <select name=schdcop6 class=SelectTny disabled>
      <option value=" 1" selected>1</option>
      <option value=" 2">2</option>
      <option value=" 3">3</option>
      <option value=" 4">4</option>
      <option value=" 5">5</option>
      <option value=" 10">10</option>
      <option value=" 15">15</option>
      <option value=" 20">20</option>
      <option value=" 25">25</option>
      <option value=" 30">30</option>
      <option value=" 35">35</option>
      <option value=" 40" >40</option>
    </select>
  </td>
</tr>

<tr id=trSuppDocs>
  <td class=DataLabel><b>Supporting Documents</b></td>
  <td>
    <input type=checkbox value="1" name=check_multlt07 onclick="changeValueSupDoc();">
  </td>
  <td class=DataLabel>Printer</td>
  <td>
    <select name=schdprn7 onchange="PrinterChange(this);"
      title="Supporting Documents Printer" disabled>
      <option></option>
      %STANDARD.01.001.FORMSDOC.01
    </select>
  <input type=hidden name=statnco7 value="FORMSDOC">
  <input type=hidden name=setdefp7 value="FORMSDOC01">
  </td>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
  <td class=DataLabel>Number of Copies</td>
  <td>
    <select name=schdcop7 class=SelectTny disabled>
      <option value=" 1" selected >1</option>
      <option value=" 2">2</option>
      <option value=" 3">3</option>
      <option value=" 4">4</option>
      <option value=" 5">5</option>
      <option value=" 10">10</option>
      <option value=" 15">15</option>
      <option value=" 20">20</option>
      <option value=" 25">25</option>
      <option value=" 30">30</option>
      <option value=" 35">35</option>
      <option value=" 40" >40</option>
    </select>
  </td>
</tr>

<tr id=trAdmLtr>
  <td class=DataLabel>
    <b>
    Admission Letter</b>
  </td>
  <td>
    <input type=checkbox checked value="1" name=check_multlt04
     onclick="changeValueLetter();">
  </td>
  <td class=DataLabel>Printer</td>
  <td>
    <select name=schdprn4 onchange="PrinterChange(this);" id="AdmLtrPrt" title="Admission Letter Printer">
      <option></option>
      %STANDARD.01.001.FORMLETT.02
    </select>
  </td>
  <td colspan=2>&nbsp;
  <input type=hidden name=multlt04 value="ADLET1">
  <input type=hidden name=statnco4 value="ADLET1">
  <input type=hidden name=setdefp4 value="FORMLETT02"></td>
  <td class=DataLabel>Number of Copies</td>
  <td>
    <select name=schdcop4 class=SelectTny>
      <option value=" 1">1</option>
      <option value=" 2">2</option>
      <option value=" 3">3</option>
      <option value=" 4">4</option>
      <option value=" 5">5</option>
      <option value=" 10">10</option>
      <option value=" 15">15</option>
      <option value=" 20">20</option>
      <option value=" 25">25</option>
      <option value=" 30">30</option>
      <option value=" 35">35</option>
      <option value=" 40">40</option>
    </select>
  </td>
</tr>

<tr id="trFaxToGP">
  <td>&nbsp;</td>
  <td>
    <input type=checkbox checked value="1" name=faxtolgp onclick="FaxToLocalGP();">
  </td>
  <td class=DataLabel>Fax to Local GP</td>
  <td class="DataField">
    <a href='javascript:HCPViewFrame("%PATWEB98.01.784.001","%PATWEB98.01.785.001","%PATWEB98.01.785.002")'>
     %PATWEB98.01.784.081
    </a>
  </td>
  <td class=DataLabel>Surgery Fax</td>
  <td class=DataField>
    <div id=SurgFaxNo></div>
  </td>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
</tr>

 <tr>
    <td class=DataLabel width=15%><b>Print Forms</b></td>
    <td><input type=hidden name=multlt10 value=0 id=multlt10>
        <input type=checkbox name=d_multlt10 value=0 id=d_multlt10
      onclick="printForm();">      
      <input type=hidden name=schdprna  id=schdprna>
    <select id=statncoa  name=statncoa  onchange="printForm();"
         title="Print Form" disabled>
        <option></option>
         %STANDARD.01.020.  3
         %STANDARD.01.020.  5
        </select>
    </td>
    <td class=DataLabel>Printer</td>
    <td>
     <select name=d_schdprna  onchange="fixPrintform();"
      title="Print Forms Printer" disabled>
        <option></option>
        %STANDARD.01.001.FORMSDOC.01
      </select>
    </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td class=DataLabel>Number of Copies</td>
    <td>
      <select name=schdcopa class=SelectTny 
      title="Print Form No of Copies" disabled>
      <option value=" 1">1</option>
      <option value=" 2">2</option>
      <option value=" 3">3</option>
      <option value=" 4">4</option>
      <option value=" 5">5</option>
      <option value=" 10">10</option>
      <option value=" 15">15</option>
      <option value=" 20">20</option>
      <option value=" 25">25</option>
      <option value=" 30">30</option>
      <option value=" 35">35</option>nn
      <option value=" 40">40</option>
      </select>
    </td>
</tr>

  <tr>
  <td class=DataLabel><b>Print MRT Barcode Label</b></td>
  <td class=DataField>
    <input type=checkbox value="1" name=d_printmrt onclick="setMrtFields();">
  </td>
  <td class=DataLabel>Printer</td>
  <td class=DataField>
    <select name=d_mrtprntr colspan=2 disabled>
      %STANDARD.01.001.MRTWEB01.15
    </select>
  </td>
  <td class=DataLabel>Home Location</td>
  <td class=DataField>
    <input type=hidden name=d_mrtms008 value="1  ">
    <select name=d_mrtms001 title="Home Location" disabled onclick="getLinkedDocTypes();getLinkedVolumes();">
      <option value="MR "></option>
    </select>
  </td>
  <td class=DataLabel>Number of Labels</td>
  <td class=DataField>
    <select name=d_nomrtlab width=50% class="SelectTny" disabled>
      %STANDARD.01.027.4.1
    </select>
  </td>
</tr>

<tr>
  <td class=DataLabel></td>
  <td class=DataField></td>
  <td class=DataLabel></td>
  <td class=DataField></td>
  <td class=DataLabel>Type of Document</td>
  <td class=DataField>
    <select name=d_mrtms002 title="Type of Document" disabled
      onchange="getLinkedVolumes();">
      <option value="MRE"></option>
    </select>
  </td>
  <td class=DataLabel>&nbsp;</td>
  <td class=DataField>&nbsp;</td>
</tr>

<tr>
  <td class=DataLabel></td>
  <td class=DataField></td>
  <td class=DataLabel></td>
  <td class=DataField></td>
  <td class=DataLabel>Volume Number</td>
  <td class=DataField>
    <select name=d_mrtms003 title="Volume Number" disabled>
      <option value=" 1"></option>
    </select>
  </td>
  <td class=DataLabel>&nbsp;</td>
  <td class=DataField>&nbsp;</td>
</tr>

<tr><td colspan=9>&nbsp;</td></tr>

<tr>
  <td colspan=8 align=center>
    <input type=button class="button" value="Process" id="pat98proc"
     onclick="tempDisable(this);setElect();">
    <input type=button class="button" value="Reset" onclick="ResetForm();">
    <input type=button value="Cancel" class="button" tabindex=28
     onclick="PatientLinkTo('patweb98.pbl',1,2,0);">
  </td>
</tr>
</table>
</form>

<form name=pbarcode action="mrtweb01.pbl" method=post>
<input type=hidden name=reportno value=15>
<input type=hidden name=template value=001>
<input type=hidden name=updttype value="U">
<input type=hidden name=urnumber value="%PATWEB98.01.003">
<input type=hidden name=mrtms008 value=""> <!-- home hospital -->
<input type=hidden name=mrtms001 value=""> <!-- home location -->
<input type=hidden name=mrtms002 value=""> <!-- document type -->
<input type=hidden name=mrtms003 value=""> <!-- volume -->
<input type=hidden name=selprint value=""> <!-- printer -->
<input type=hidden name=nolabels value=""> <!-- number of labels -->
</form>

<span class=DataField id=hcgfaxn style="display:none">
  %PATWEB98.01.785.016
</span>

<span class=DataField id=hcpfaxn style="display:none">
  %PATWEB98.01.784.040
</span>

<script type="text/javascript">

AdmStatus = trim("%PATWEB98.01.104").toUpperCase();
if (AdmStatus == "PRE-ADMISSION") {
  // Don't allow printing of the Admission Letter if Pre-Admission
  document.PrintLabels.check_multlt04.checked = false;
  document.PrintLabels.check_multlt04.disabled = true;
  document.getElementById('trAdmLtr').style.display = "none";

  // Also don't allow faxing
  document.PrintLabels.faxtolgp.checked = false;
  document.getElementById('trFaxToGP').disabled = true;
  document.getElementById('trFaxToGP').style.display = "none";
  changeValueLetter();
}

// Default fax number
FaxHCG="%PATWEB98.01.785.016";
if(isWhitespace(FaxHCG)){
   SurgFaxNo.innerHTML=hcpfaxn.innerHTML;
   document.PrintLabels.freetxt6.value="%PATWEB98.01.784.040";

} 
else {
   SurgFaxNo.innerHTML=hcgfaxn.innerHTML;
   document.PrintLabels.freetxt6.value="%PATWEB98.01.785.016";
}

//Patient Label - Name
LastLabelType="%STANDARD.01.036.FINALADM.01";
if(isWhitespace(LastLabelType)) {
  LastLabelType="LABELINP04";
}
 
if(!isWhitespace(LastLabelType)) {
  for(var i=0; i<document.PrintLabels.templab1.length; i++) {
    if(document.PrintLabels.templab1.options[i].value==LastLabelType) {
       document.PrintLabels.templab1.selectedIndex = i;
       FixRow1();
    }
  }
}

//Patient Label - Number of Labels
LastLabelCop="%STANDARD.01.034.FINALADM.01";
for(var i=0; i<document.PrintLabels.schdcop1.length;i++){
  if(document.PrintLabels.schdcop1.options[i].value.replace(/ /g,"")==LastLabelCop.replace(/ /g,"")){
     document.PrintLabels.schdcop1.selectedIndex = i;
  }
}

//Other Label - Name
OTLastLabelType="%STANDARD.01.036.FINALADM.02"
if(!isWhitespace(OTLastLabelType)) {
  for(var i=0; i<document.PrintLabels.templab2.length; i++) {
    if(document.PrintLabels.templab2.options[i].value==OTLastLabelType) {
       document.PrintLabels.templab2.selectedIndex = i;
       FixRow2();
    }
  }
}

//Other Label - Number of Labels
OTLastLabelCop="%STANDARD.01.034.FINALADM.02";
for(var i=0; i<document.PrintLabels.schdcop8.length;i++){
  if(document.PrintLabels.schdcop8.options[i].value.replace(/ /g,"")==OTLastLabelCop.replace(/ /g,"")){
     document.PrintLabels.schdcop8.selectedIndex = i;
  }
}


DefFrontCopies="%STANDARD.01.034.FORMFRNT.01";
for(var i=0; i<document.PrintLabels.schdcop2.length;i++){
  if(document.PrintLabels.schdcop2.options[i].value.replace(/ /g,"")==DefFrontCopies.replace(/ /g,"")){
     document.PrintLabels.schdcop2.selectedIndex = i;
  }
}

DefFrontForm="%STANDARD.01.033.FORMFRNT.01";
for(var i=0; i<document.PrintLabels.multlt02.length;i++){
  if(document.PrintLabels.multlt02.options[i].value.replace(/ /g,"")==DefFrontForm.replace(/ /g,"")){
      document.PrintLabels.multlt02.selectedIndex = i;
  }
}

DefClaimCopies="%STANDARD.01.034.FORMCLAM.01";
for(var i=0; i<document.PrintLabels.schdcop3.length;i++){
  if(document.PrintLabels.schdcop3.options[i].value.replace(/ /g,"")==DefClaimCopies.replace(/ /g,"")){
     document.PrintLabels.schdcop3.selectedIndex = i;
  }
}

DefClaimForm="%STANDARD.01.033.FORMCLAM.01";
for(var i=0; i<document.PrintLabels.multlt03.length;i++){
  if(document.PrintLabels.multlt03.options[i].value.replace(/ /g,"")==DefClaimForm.replace(/ /g,"")){
     document.PrintLabels.multlt03.selectedIndex = i;
  }
}

DefMedHisCopies="%STANDARD.01.034.FORMMHIS.01";
for(var i=0; i<document.PrintLabels.schdcop5.length;i++){
  if(document.PrintLabels.schdcop5.options[i].value.replace(/ /g,"")==DefMedHisCopies.replace(/ /g,"")){
     document.PrintLabels.schdcop5.selectedIndex = i;
  }
}

DefConsCopies="%STANDARD.01.034.FORMCONS.01";
for(var i=0; i<document.PrintLabels.schdcop6.length;i++){
  if(document.PrintLabels.schdcop6.options[i].value.replace(/ /g,"")==DefConsCopies.replace(/ /g,"")){
     document.PrintLabels.schdcop6.selectedIndex = i;
  }
}

DefSupDocCopies="%STANDARD.01.034.FORMSDOC.01";
for(var i=0; i<document.PrintLabels.schdcop7.length;i++){
  if(document.PrintLabels.schdcop7.options[i].value.replace(/ /g,"")==DefSupDocCopies.replace(/ /g,"")){
     document.PrintLabels.schdcop7.selectedIndex = i;
  }
}

// Default admission letter
DefForm3Copies="%STANDARD.01.034.FORMLETT.02";
for(var i=0; i<document.PrintLabels.schdcop4.length;i++){
  if(document.PrintLabels.schdcop4.options[i].value.replace(/ /g,"")==DefForm3Copies.replace(/ /g,"")){
     document.PrintLabels.schdcop4.selectedIndex = i;
  }
}
// Check inform gp
InformGP="%PATWEB98.01.925.0";
if (InformGP!="1") {
  document.PrintLabels.check_multlt04.checked = false;
  document.PrintLabels.check_multlt04.disabled = true;
  document.PrintLabels.faxtolgp.checked = false;
  document.getElementById('trFaxToGP').disabled = true;
  document.getElementById('trAdmLtr').disabled = true;
  document.getElementById('AdmLtrPrt').disabled = true;
  changeValueLetter(); 
}

changeValueForm();
changeValueClaim();

// Remove 'Spool Report' option for eAdmission document printer selections
RemoveListOptions("schdprn5","S     ");
RemoveListOptions("schdprn6","S     ");
RemoveListOptions("schdprn7","S     ");
//document.PrintLabels.schdcop8.selectedIndex = 0;
SetDeflteAdmisSelns();

</script>

<form name="PatientLinks" method="get">
<input type="hidden" name="reportno" value="1">
<input type="hidden" name="template" value="004">
<input type="hidden" name="urnumber" value="%PATWEB98.01.003">
<input type="hidden" name="admissno" value="%PATWEB98.01.081">
<input type="hidden" name="MenuType" value="%PATWEB98.01.088">
</form>
