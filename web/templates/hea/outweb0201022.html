<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="hea">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientClinicId.js"></script>
<script type="text/javascript" src="../js/IBA_Category_CT.js"></script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link
//---------------------------------------------------------------------------
var view;
var flag=1;
function InitTable(TableView) {
  document.title="Follow Up Referral List";
  switch (TableView) {
    case 0:
      view=0;
      t = new Table(1,0,2,"100%","center",35,40);
      t.addColumn("Time","String",1,1,"left","AppointmentIcon.gif","0",40)
      t.addColumn("Type","String",2,2,"left","","",25)
      t.addColumn("U/R","String",3,3,"left","","",40)
      t.addColumn("Patient","ImageText",4,4,"left","PatientFolder","16",120,5)
      t.addColumn("Claim Code","Date",9,9,"left","","",25)
      t.addColumn("Linked Ref","Date",13,13,"left","","",35)
      t.addColumn("Expiry Ind.","Image",12,12,"center","ExpiryIcon","",25)
      t.addColumn("Referral Expiry","Date",8,8,"left","","",65)
      t.addColumn("Medicare #","String",6,6,"left","","",70)
      t.addColumn("Medicare Expiry","String",7,7,"left","","",35)
      t.addColumn("Patient Home/Work/Mobile","String",22,22,"left","","",65)
      t.addColumn("Contact 1 Work/Mobile","String",23,23,"left","","",65)
      AddTableRows()
      TableOutput(0,1);    // Order Column,Asc Dsc
      break;
  }
}
function init() {
 SetClinicType(SelectPeriod.srchclty,SelectPeriod.defctype.value,SelectPeriod.usersite.value);

  if (SelectPeriod.ibcnmhos.value=="1") {
    SelectOptionsHospCatCode(SelectPeriod.ctcode,SelectPeriod.wbsehosp,SelectPeriod.srchltyp);
    SelectPeriod.srchltyp.options[0]=new Option("Select Location","  ");

    SelectPeriod.srchltyp.selectedIndex=0;
    if (!isWhitespace(SelectPeriod.defltype.value)) {
      for (var i =0 ; i < SelectPeriod.srchltyp.length; i++) {
        if (SelectPeriod.srchltyp.options[i].value.substr(0,3)==SelectPeriod.defltype.value) {
          SelectPeriod.srchltyp.selectedIndex=i
        }
      }
    }
  } else {
    SetCategoryCT(SelectPeriod.srchltyp,SelectPeriod.defltype.value);
  }

 if (isWhitespace(SelectPeriod.srchclid.value)) {
   if (!isWhitespace(SelectPeriod.deftclid.value)) {
     SelectPeriod.srchclid.value=SelectPeriod.deftclid.value;
     validateCode(25,SelectPeriod.srchclid,SelectPeriod.clindesc);
   }
 }
}
function UpdateRef(urno,admis,dp,exp) {
    linkUrl="allweb02.pbl?reportno=2&template=003" +
            "&urnumber=" + urno.replace(/ /g,"+") +
            "&admissno=" + admis.replace(/ /g,"+") +
            "&deptcode=" + dp.replace(/ /g,"+") +
            "&exprflag=" + exp.replace(/ /g,"+");
  Left=(document.body.clientWidth-1000)/2
  DFrameLink(linkUrl,0,Left,1000,900)
}
function LinkRef(urno,admis) {
  linkUrl="outweb02.pbl?reportno=3&template=001" +
          "&urnumber=" + urno.replace(/ /g,"+") +
          "&admissno=" + admis.replace(/ /g,"+")
  location.href=linkUrl
}
function onClinicID(){
  validId=""+validateCode(25,SelectPeriod.srchclid,SelectPeriod.clindesc);
  if(validId!='false'){ 
     SelectPeriod.submit();
  }
}
function PageSubmit() {
  SelectPeriod.submit();
}
</script>
</head>
%START.OF.PAGE
<body onload='PageLoad(event);InitTable(0);SetOutpatientList();'>
<div id=HeadingSection>
<form id=SelectPeriod name=SelectPeriod action=outweb02.pbl method=get 
 style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=22>
<input type=hidden name=defctype value="%OUTWEB02.01.025">
<input type=hidden name=showflag value="%OUTWEB02.01.063">
<input type=hidden name=deftclid value="%OUTWEB02.01.064">
<input type=hidden name=defltype value="%OUTWEB02.01.065">
<input type=hidden name=viewtype value="%OUTWEB02.01.011">
<input type=hidden name=usersite value="%STANDARD.01.023">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=wbsehosp value="%STANDARD.01.032">
<input type=hidden name=ctcode id=ctcode value="CT">

<table width="100%" bgcolor=#cccccc align=center cellpadding=2 cellspacing=0
 border=0>
<tr><td><b>Views</b>
  <a href="javascript:InitTable(0)">
  <img src='../images/TableViewIcon.gif' class=Icon></a>
  </td>
  <td class=DataLabel>Clinic Type</td>
  <td class=DataField>
    <select name=srchclty id=srchclty class=SelectBig
     onchange='SelectPeriod.submit();'>
      <option value="  ">Select Clinic Type</option>
    </select>
  </td>
  <td class=DataLabel>Location</td>
  <td class=DataField>
    <select name=srchltyp id=srchltyp class=SelectBig
     onchange='SelectPeriod.submit();'>
      <option value="  ">Select Location</option>
    </select>
  </td>
  <td class=DataLabel>Clinic ID</td>
  <td class=DataField>
    <input type=text maxlength=6 name=srchclid id=srchclid size=6
     title="Clinic ID" value="%OUTWEB02.01.022.1"
     onblur="UpCase(this);onClinicID();">
    <input type=text maxlength=25 name=clindesc id=clindesc size=25 
     value="%OUTWEB02.01.022.0" class=Readonly readonly>
    <img src="../images/SearchIcon.gif" class=Icon title="Clinic Search"
     onclick="ClinicSessionSearchFrame(srchclid,clindesc,onClinicID);">
    <img src="../images/erase.gif" class=Icon title="Clear"
     onclick="clrFields(srchclid,clindesc,PageSubmit);">
  </td>
  <td align=right>
    <input type=button value="<<" class=SmallButton
     onclick='location.href="%OUTWEB02.01.002"'>
    %OUTWEB02.01.007
    <input type=button value=">>" class=SmallButton
     onclick='location.href="%OUTWEB02.01.001"'>
  <a href='javascript:SelectDateFrame();'>
  <img src="../images/DateLookup.gif" class=Icon
   alt="Select Date" title="Select Date"></a>
  <a href='javascript:SelectView("0");'>
  <img src=../images/DayIcon.gif class=Icon
   alt="View Today" title="View Today"></a>
  <a href='javascript:SelectView("1");'>
  <img src=../images/WeekIcon.gif class=Icon
  alt="View This Week" title="View This Week"></a>
  </td>
</tr>
</table>
</form>
</div>

<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows() {
%OUTWEB02.01.062.outweb02.03.001
}
</script>
