<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="hea">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/emrweb0201011.js"></script>
<script type="text/javascript">
function MOAChange(SelectList) {

  var bEditable = false;

  if (document.UpdateForm.ptcnhdps.value == "3") {
    var TCINDC1 = SelectList.value.substr(3,1);
    if (TCINDC1 == "A") {
      bEditable = true;
    }
  } else {
    var HDPEquiv = SelectList.value.substr(14,2);
    if (HDPEquiv == "01" || HDPEquiv == "04" || HDPEquiv == "05") {
      bEditable = true;
    }
  }

  ToggleAmbFields(bEditable);
}
function ToggleAmbFields(Editable) {
  var p = document.UpdateForm;

  if (Editable) {
    p.emvis156.readOnly = false;
    p.emvis157.readOnly = false;
    p.emvis034.readOnly = false;

    p.emvis156.className = "Date";
    p.emvis157.className = "Time";
    p.emvis034.className = "Mandatory";
  }
  else {
    p.emvis156.value = "";
    p.emvis157.value = "";
    p.emvis034.value = "";

    p.emvis156.readOnly = true;
    p.emvis157.readOnly = true;
    p.emvis034.readOnly = true;

    p.emvis156.className = "Readonly";
    p.emvis157.className = "Readonly";
    p.emvis034.className = "Readonly";
  }
}
function displayServiceType() {
  if (document.UpdateForm.ptcnhdps.value == "3") {
    if (!isWhitespace(document.UpdateForm.defsrtyp.value)) {
      document.getElementById("ServiceTypeFieldDIV").innerHTML=
      document.getElementById("ServiceTypeFieldHiddenSPAN").innerHTML;
      document.UpdateForm.emvis177.value=document.UpdateForm.defsrtyp.value;
    } else {
      document.getElementById("ServiceTypeTitleDIV").innerHTML=
      document.getElementById("ServiceTypeTitleSPAN").innerHTML;
      document.getElementById("ServiceTypeFieldDIV").innerHTML=
      document.getElementById("ServiceTypeFieldVisibleSPAN").innerHTML;
    }
  }
}
function CheckTextLimit(TextArea) {
  if (!LimitText(TextArea,6,300)) {
    TextArea.onblur = null;  // clear to prevent infinite loop with alerts
    window.setTimeout(function () {
      TextArea.onblur = function() {
        TextareaBlurHandler(TextArea);
        prcom001TopFrame();
      }
    },100);
  }
}
function prcom001TopFrame() {
// Note: formateText() function used because wrap=hard does not do wrapping
//       when form not submited.
  var formatedtext=formateText(UpdateForm.prcom001,'50');
  if ((formatedtext.split(/[\r\n]/).length > 6)) {
    alert("Presenting Complaint Comments - Max 6 lines." +
          "\nPlease remove extra line(s) to continue.");
    FocusDelay(document.UpdateForm.prcom001);
    return;
  }
  else if (formatedtext.replace(/\r?\n/gm,"").length > 300) {
    alert("Presenting Complaint Comments - Max 300 characters." +
          "\nPlease remove the extra character(s) to continue.");
    FocusDelay(document.UpdateForm.prcom001);
    return;
  }

  var serverURL="../cgi-bin/emrweb02.pbl?reportno=11" +
                "&admissno=" + UpdateForm.admissno.value.replace(/ /g,"+") +
                "&updateky=" + UpdateForm.updateky.value.replace(/ /g,"+") +
                "&webuseid=" + PatientLinks.webuseid.value.replace(/ /g,"+") +
                "&updttype=PRCOM" +
                "&prcom001=" + escape(formatedtext)
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
     ReturnValue=returnValue.return_value.split("|")
     UpdateForm.updateky.value = ReturnValue[0];
  }
  else {
     alert("The screen will now be refreshed.\n" +
           " Changes have not been retained.");
     location.reload();
     ReturnCode.select();
     return; }
  if (top.menu==undefined){ return; }
  if (top.menu.document.all.EmergencyFrame==undefined){ return; }
  if (top.menu.document.all.EmergencyFrame.src==""){ return; }
  if (top.menu.EmergencyFrame.document.UpdateForm==undefined){return;}
  if (top.menu.EmergencyFrame.document.UpdateForm.prcom001==undefined){return;}
  ClinicalPage="emrweb02.pbl?reportno=1&template=100"
  if (top.menu.document.all.EmergencyFrame.src.substr(0,36)==ClinicalPage) {
   top.menu.EmergencyFrame.document.UpdateForm.prcom001.value=
                  UpdateForm.prcom001.value }
}
function ValidatePasteData(TextArea) {
  var evt = window.event;
  var clipboard = evt.clipboardData;
  var clipData = clipboard.getData('text/plain');
  var title = TextArea.title;

  var maxRows=6;
  if ((clipData.split(/\r?\n/).length > maxRows)) {
    alert("Maximum " + maxRows + " lines reached for " + title + "." +
          "\nPlease remove the extra line(s) to continue.");
    FocusDelay(TextArea);
    return;
  }

  var maxChars=300;
  if (clipData.replace(/\r?\n/gm,"").length > maxChars) {
    alert("Maximum " + maxChars + " characters reached for " + title + "." +
          "\nPlease remove the extra character(s) to continue.");
    FocusDelay(TextArea);
    return;
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);displayServiceType();" 
              onBeforeUnload="submitFormRedirect();" >
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%EMRWEB02.01.003";
PatientVIS="%EMRWEB02.01.081";
PatientNAM="%EMRWEB02.01.002";
PatientSTA="%EMRWEB02.01.086.078";
PatientALT="%EMRWEB02.01.084";
PatientSEX="%EMRWEB02.01.019";
PatientDOB="%EMRWEB02.01.020";
PatientAGE="%EMRWEB02.01.021";
PatientLOC="%EMRWEB02.01.083";
PatientPRI="%EMRWEB02.01.086.066.1";
PatientUNT="%EMRWEB02.01.066.0";
PatientIND="%EMRWEB02.01.086.091";
GpCOD="%EMRWEB02.01.086.084.001";
GpNAM="%EMRWEB02.01.086.084.081";
GpPRAC="%EMRWEB02.01.086.085.001";
GpPRACCNT="%EMRWEB02.01.086.085.002";
GpPRACNAM="%EMRWEB02.01.086.085.005";
PatientARR="%EMRWEB02.01.101.0 %EMRWEB02.01.102";
PatientSEE="%EMRWEB02.01.130.0 %EMRWEB02.01.131";
PatientTRI="%EMRWEB02.01.103.3";
PatientECLC="%EMRWEB02.01.484.1";
PatientCLH="%STANDARD.01.017.CL";
PatientEHFT="%EMRWEB02.01.485";
InsertEmergencyHeader()
</script>
</table>

<form name=UpdateForm action="emrweb02.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="01">
<input type=hidden name=resavail value="0">
<input type=hidden name=template value="011">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=formactn value="C1">
<input type=hidden name=redirect value="emrweb02.pbl?reportno=1&template=4">
<input type=hidden name=updateky value="%EMRWEB02.01.404">
<input type=hidden name=updttype value="UPDAT">
<input type=hidden name=nextpage value=12>
<input type=hidden name=no_map_reload id="no_map_reload" value=1>
<input type=hidden name=pmpxi067 value="%EMRWEB02.01.667.0">
<input type=hidden name=username>
<input type=hidden name=password>
<input type=hidden name=dummy2>
<input type=hidden name=emvis004>
<input type=hidden name=emvis005>
<input type=hidden name=emvis135>
<input type=hidden name=emvis136>
<input type=hidden name=emvis137>
<input type=hidden name=emvis138>
<input type=hidden name=emvis147>
<input type=hidden name=emvis118 value="%EMRWEB02.01.003">
<input type=hidden name=savdesc1>
<input type=hidden name=savmanag>
<input type=hidden name=searchgn value="%EMRWEB02.01.009">
<input type=hidden name=searchsn value="%EMRWEB02.01.010">
<input type=hidden name=searchps value="%EMRWEB02.01.019">
<input type=hidden name=searchpd value="%EMRWEB02.01.020">
<input type=hidden name=discstat value="%EMRWEB02.01.147">
<input type=hidden name=emcndoct value="%EMRWEB02.01.455">
<input type=hidden name=emvis001 value="%EMRWEB02.01.101.0">
<input type=hidden name=emvis002 value="%EMRWEB02.01.102">
<input type=hidden name=securety value="2">
<input type=hidden name=triguser value="1">
<input type=hidden name=emrviscat value="el">
<input type=hidden name=name_emvis006 title="Location"
 value="%EMRWEB02.01.106.0">
<input type=hidden name=savelocn value="%EMRWEB02.01.106.1">
<input type=hidden name=name_emvis069>
<input type=hidden name=ptcnhdps value="%STANDARD.01.025.080.250.1.1">
<input type=hidden name=defsrtyp value="%EMRWEB02.01.932">

<table width=95% align=center border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=15%>User Id </td>
    <td width=25%>
      <input type=text size=12 name=secureid class=Mandatory tabindex=1
       title="User ID">Password
      <input type=password size =12 name=securepw class=Mandatory tabindex=2
       title="Password" onblur="checkPass();">
    </td>
</tr>

<tr valign=top><td class=DataLabel>Presenting Complaint</td>
    <td>
      <input type="text" size=10 name=test class=Mandatory 
       title="Presenting Complaint" tabindex=3 value="%EMRWEB02.01.220.0"
       onblur="emvis060TopFrame();DisplayDiv();"
      onKeyUp="UpCase(this);getPresentCom(this,UpdateForm.emvis060,
               UpdateForm.emrviscat);">
      <select name=emvis060 class=SelectBig 
       onblur="emvis060TopFrame();DisplayDiv();">
        <option value="%EMRWEB02.01.220.1">%EMRWEB02.01.220.0</option>
      </select>
    </td>
    <td rowspan=2>
      <textarea name=prcom001 id=prcom001 wrap=hard cols=50 rows=6 tabindex=4
       title="Presenting Complaint Comments"
       onkeydown="CheckTextLimit(this);" onpaste="ValidatePasteData(this)"
       onblur="TextareaBlurHandler(this);prcom001TopFrame();">
      </textarea> 
    </td>
</tr>
</table>

<div id=Triage></div>

<table align=center width=95% align=center border=0 cellspacing=0 cellpadding=1>
<tr><td class=DataLabel width=15%>Triage Category</td>
    <td width=25%>
      <table border=0 cellspacing=0>
      <tr><td class=Triage1><i>1</i>
            <input type=radio name=emvis003 value=1 title="Triage Category"
             tabindex=11>
          </td>
          <td class=Triage2><i>2</i>
            <input type=radio name=emvis003 value=2 title="Triage Category"
             tabindex=11>
          </td>
          <td class=Triage3><i>3</i>
            <input type=radio name=emvis003 value=3 title="Triage Category"
             tabindex=11>
          </td>
          <td class=Triage4><i>4</i>
            <input type=radio name=emvis003 value=4 title="Triage Category"
             tabindex=11>
          </td>
          <td class=Triage5><i>5</i>
            <input type=radio name=emvis003 value=5 title="Triage Category"
             tabindex=11>
          </td>
      </tr>
      </table>
    </td>
</tr>

<tr><td class=DataLabel>Location</td>
    <td nowrap>
      <select class="SelectMed Mandatory" name=emvis006 title="Location" 
       tabindex=12 
       onchange="validateLocation(UpdateForm.emvis006,
                                  UpdateForm.name_emvis006);">
       %EMRWEB02.01.106.2
      </select>
    <td class=DataLabel width=10%>Number of Labels</td>
    <td width=5%>
      <select name=nolabels width=50% tabindex=14>
        <option></option>
        %STANDARD.01.027.1.1
      </select>
    </td>
    <td width=20%>
      Type
      <select name=labeltyp class=SelectBig tabindex=15>
        %STANDARD.01.019.LABELEMR.1
        %STANDARD.01.019.LABELKNX.1
      </select>
    </td>
    <td>Printer</td>
    <td>
      <select name=lblprint class=SelectBig tabindex=16>
        %EMRWEB02.01.145.EMRTLBLS.01
      </select>
    </td>
</tr>

<tr><td class=DataLabel>Triage Date</td>
    <td class=DataLabel>
      <input type="text" name=emvis128 size="12" value="%STANDARD.01.015"
       title="Triage Date" class="Mandatory PastDate" tabindex=17>
      <img src=../images/DateLookup.gif class=Icon
       date=document.UpdateForm.emvis128>
      Time
      <input type="text" name=emvis129 size="8" value="%STANDARD.01.016"
       title="Traige Time" tabindex=18>
      <img notab src=../images/DateTimeStamp.gif class=Icon 
       onclick="SetCurrentDateTime(UpdateForm.emvis128,UpdateForm.emvis129);">
      <img notab src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(UpdateForm.emvis129);">
    </td>

    <td class=DataLabel>Number of Copies</td>
    <td>
      <select name=nolabelf tabindex=19>
        <option></option>
        <option value="  1" selected>1</option>
        <option value="  2">2</option>
        <option value="  3">3</option>
        <option value="  4">4</option>
        <option value="  5">5</option>
        <option value="  6">6</option>
        <option value="  7">7</option>
        <option value="  8">8</option>
        <option value="  9">9</option>
        <option value=" 10">10</option>
      </select>
    </td>

    <td>Form
      <select name=statncod class=SelectBig tabindex=20>
        <option></option>
        %STANDARD.01.020.  7
      </select>
    </td>

    <td>Printer</td>
    <td>
      <select name=frmprint class=SelectBig tabindex=21>
        %EMRWEB02.01.145.EMRTFRMS.02
      </select>
    </td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.035.eh</td>
    <td><select name=emvis056 title="%STANDARD.01.035.eh" tabindex=22
         class="SelectBig">
          <option></option>
          %EMRWEB02.01.216.2
        </select>
    </td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.035.eu</td>
    <td><select name=emvis069 title="%STANDARD.01.035.eu" tabindex=23
         class="SelectBig Mandatory">
          <option></option>
          %EMRWEB02.01.229.2
        </select>
    </td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.017.EA</td>
    <td><select name=emvis013 title="%STANDARD.01.017.EA" tabindex=30
         class="SelectBig Mandatory" onchange="MOAChange(this);">
          <option></option>
          %EMRWEB02.01.113.2
        </select>
    </td>
</tr>

<tr><td class="DataLabel" width=15%>Ambulance Transfer of Care Date</td>
    <td nowrap>
      <input type=text size=12 max=11 name="emvis156" value="%EMRWEB02.01.277"
       title="Ambulance Transfer of Care Date" class="Date" tabindex=24>
      <img notab src="../images/DateLookup.gif" class="Icon"
       alt="Show Calendar" date="UpdateForm.emvis156">
      Time
      <input type=text size=8 max=8 name="emvis157" tabindex=25 class=""
       value="%EMRWEB02.01.278" title="Ambulance Transfer of Care Time">
      <img notab src="../images/DateTimeStamp.gif" class="Icon"
       alt="Current" date="UpdateForm.emvis156" time="UpdateForm.emvis157">
      <img notab src="../images/TimeLookup.gif" class="Icon"
       alt="Time Select" time="UpdateForm.emvis157">
    </td>
</tr>

<tr><td class=DataLabel>Amb. Case No</td>
    <td><input type=text size=12 maxlength=15 name=emvis034 tabindex=26
         value="%EMRWEB02.01.134" title="Ambulance Case Number"
         class="Mandatory">
    </td>
</tr>

<tr>
  <td>
    <div id=ServiceTypeTitleDIV></div>
  </td>
  <td>
    <div id=ServiceTypeFieldDIV></div>
  </td>

</tr>

</table>

<table width=95% align=center border=0 cellspacing=0 cellpadding=0>
<tr><td align=center>
    <input type=button class="button" value="Update" tabindex=30
     id="emr02upd"
     onclick="tempDisable(this);onUpdateHEA();">
    <input type=reset class="button" value="Cancel" tabindex=31
     onclick="history.go(-1);">
    </td>
</tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=webuseid value="%STANDARD.01.008">
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=MenuType value="11">
<input type=hidden name=checksub value="0">
<input type=hidden name=emvis147>
</form>

<form name=HiddenFields>
<input type=hidden name=InjuryIndicator value="%EMRWEB02.01.447">
<input type=hidden name=CheckUr value="%EMRWEB02.01.448">
<input type=hidden name=DoctorCode value="%EMRWEB02.01.107.001">
<input type=hidden name=NurseCode value="%EMRWEB02.01.164.1">
<input type=hidden name=Location value="%EMRWEB02.01.083">
<input type=hidden name=DischargeComplete value="%EMRWEB02.01.147">
<input type=hidden name=Pres01 value="%EMRWEB02.01.104">
<input type=hidden name=Pres02 value="%EMRWEB02.01.105">
<input type=hidden name=Pres03 value="%EMRWEB02.01.174">
<input type=hidden name=Pres04 value="%EMRWEB02.01.175">
<input type=hidden name=Pres05 value="%EMRWEB02.01.176">
<input type=hidden name=Pres06 value="%EMRWEB02.01.177">
<input type=hidden name=linkadmn value="%EMRWEB02.01.081">
</form>

<span id=EmergencyProc style="display:none;">
<table align=center cellspacing=0 cellpadding=0 border=0 width=95%>
<tr><td class=DataLabel width=15%>Place Where Injury Occurred</td>
    <td width=25%>
      <select name="emvis021" class=SelectBig tabindex=5
       title="Place Where Injury Occurred">
        <option></option>
        %EMRWEB02.01.121.2
      </select>
    </td>
    <td class=DataLabel>Activity When Injured</td>
    <td>
      <select name="injur006" class=SelectBig tabindex=6
       title="Activity When Injured">
        <option></option>
        %EMRWEB02.01.183.2
      </select>
    </td>
    <td class=DataLabel> Injury Cause</td>
    <td>
      <select name="injur004" class=SelectBig tabindex=7 title="Injury Cause">
        <option></option>
        %EMRWEB02.01.181.2
      </select>
    </td>
</tr>

<tr valign=top><td class=DataLabel>Human Intent</td>
    <td>
      <select name="injur005" class=SelectBig tabindex=8 title="Human Intent">
        <option></option>
        %EMRWEB02.01.182.2
      </select>
    </td>
    <td class=DataLabel>Desc. of Injury Event</td>
    <td colspan=3>
      <input type="text" name="injur002" maxlength="50" size="40"
       title="Description of Injury Event" value="" tabindex=9>
      <input type="text" name="injur003" maxlength="50" size="40" value=""
       tabindex=10>
    </td>
</tr>
</table>
</span>

<span id=ServiceTypeTitleSPAN style="display:none;">
%STANDARD.01.035.YW
</span>

<span id=ServiceTypeFieldHiddenSPAN style="display:none;">
<input type=hidden name=emvis177 value="">
</span>

<span id=ServiceTypeFieldVisibleSPAN style="display:none;">
<select name="emvis177" class="SelectBig Mandatory"
 title="%STANDARD.01.035.YW" tabindex=27>
<option></option>
%STANDARD.01.021.YW
</select>
</span>

<script type="text/javascript">
  var p = document.UpdateForm;

  CTypeAdm = "%EMRWEB02.01.252";
  if (CTypeAdm == "Yes") {
    p.emvis147.value = 1;
    document.PatientLinks.emvis147.value = 1;
  }
  else { 
    p.emvis147.value = 0;
    document.PatientLinks.emvis147.value = 0;
  }

  LabelCop = "%STANDARD.01.034.EMRTLBLS.01";
  for (var i=0; i < p.nolabels.length; i++) {
    if (p.nolabels.options[i].value.replace(/ /g,"")==LabelCop.replace(/ /g,""))
    {
      p.nolabels.selectedIndex = i;
    }
  }

  LabelNam = "%STANDARD.01.036.EMRTLBLS.01";
  for (var i=0; i < p.labeltyp.length; i++) {
    if (p.labeltyp.options[i].value.replace(/ /g,"")==LabelNam.replace(/ /g,""))
    {
      p.labeltyp.selectedIndex = i;
    }
  }

  FormCop = "%STANDARD.01.034.EMRTFRMS.02";
  for (var i=0; i < p.nolabelf.length; i++) {
    if (p.nolabelf.options[i].value.replace(/ /g,"")==FormCop.replace(/ /g,""))
    {
      p.nolabelf.selectedIndex = i;
    }
  }

  FormNam = "%STANDARD.01.033.EMRTFRMS.02";
  for (var i=0; i < p.statncod.length; i++) {
    if (p.statncod.options[i].value.replace(/ /g,"")==FormNam.replace(/ /g,""))
    {
      p.statncod.selectedIndex = i;
    }
  }

  ArrivalMode = "%EMRWEB02.01.113.1";
  for (var i=0; i < p.emvis013.length; i++) {
    if (p.emvis013.options[i].value == ArrivalMode) {
       p.emvis013.selectedIndex = i;
    }
  }

  MOAChange(p.emvis013);
</script>
