<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="hea">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/EmrMandatory.js"></script>
<script type="text/javascript" src="../js/emrweb0202003.js"></script>
<script type="text/javascript">
function TriageComplete() {
 UpdateForm.AddButton.disabled=true;
 document.UpdateForm.redirect.value="emrweb02.pbl?reportno=1&template=4&triredir=3"
    if (setFormactnHEA()) { 
     UpdateForm.AddButton.disabled=false; 
  } else {
     setTimeout('UpdateForm.AddButton.disabled=false;',5000);
 }
}
function Validateprecom001() {
  var formatedtext=formateText(UpdateForm.prcom001,UpdateForm.prcom001.cols);

  UpdateForm.prcom001.value = formatedtext;

  if (formatedtext.split(/[\r?\n]/).length > 6) {
    alert("Presenting Complaint Comments - Max 6 lines." +
          "\nPlease remove the extra line(s) to continue.");
    FocusDelay(document.UpdateForm.prcom001);
    return;
  }
  else if (formatedtext.replace(/\r?\n/gm,"").length > 300) {
    alert("Presenting Complaint Comments - Max 300 characters." +
          "\nPlease remove the extra character(s) to continue.");
    FocusDelay(document.UpdateForm.prcom001);
    return;
  }
}
function FocusUser() {
  document.UpdateForm.secureid.focus();
} 
function genderName(){
/*
  if (document.UpdateForm.ptcnhdps.value=="3") {
    intersexoption = document.createElement("option");
    intersexoption.text = "Other";
    intersexoption.value = "R";
    document.UpdateForm.emexp004.add(intersexoption);
  } else {
    intersexoption = document.createElement("option");
    intersexoption.text = "Intersex";
    intersexoption.value = "R";
    document.UpdateForm.emexp004.add(intersexoption);
  }
*/
}

function MOAChange(SelectList) {

  var bEditable = false;

  if (document.UpdateForm.ptcnhdps.value == "3") {
    var TCINDC1 = SelectList.value.substr(3,1);
    if (TCINDC1 == "A") {
      bEditable = true;
    }
  } else {
    var HDPEquiv = SelectList.value.substr(14,2);
    if (HDPEquiv == "01" || HDPEquiv == "04" || HDPEquiv == "05") {
      bEditable = true;
    }
  }

  ToggleAmbFields(bEditable);
}
function ToggleAmbFields(Editable) {
  var p = document.UpdateForm;

  if (Editable) {
    p.emvis156.readOnly = false;
    p.emvis157.readOnly = false;
    p.emvis034.readOnly = false;

    p.emvis156.className = "Date";
    p.emvis157.className = "Time";
    p.emvis034.className = "Mandatory";
  }
  else {
    p.emvis156.value = "";
    p.emvis157.value = "";
    p.emvis034.value = "";

    p.emvis156.readOnly = true;
    p.emvis157.readOnly = true;
    p.emvis034.readOnly = true;

    p.emvis156.className = "Readonly";
    p.emvis157.className = "Readonly";
    p.emvis034.className = "Readonly";
  }
}
function displayServiceType() {
  if (document.UpdateForm.ptcnhdps.value == "3") {
    if (!isWhitespace(document.UpdateForm.defsrtyp.value)) {
      ServiceTypeFieldDIV.innerHTML=ServiceTypeFieldHiddenSPAN.innerHTML; 
      document.UpdateForm.emvis177.value=document.UpdateForm.defsrtyp.value;
    } else {
      ServiceTypeTitleDIV.innerHTML=ServiceTypeTitleSPAN.innerHTML;
      ServiceTypeFieldDIV.innerHTML=ServiceTypeFieldVisibleSPAN.innerHTML;
    }
  }
}
function CheckTextLimit(TextArea) {
  if (!LimitText(TextArea,6,300)) {
    TextArea.onblur = null;  // clear to prevent infinite loop with alerts
    window.setTimeout(function () {
      TextArea.onblur = function() {
        TextareaBlurHandler(TextArea);
        Validateprecom001();
      }
    },100);
  }
}
function ValidatePasteData(TextArea) {
  var evt = window.event;
  var clipboard = evt.clipboardData;
  var clipData = clipboard.getData('text/plain');
  var title = TextArea.title;

  var maxRows=6;
  if ((clipData.split(/\r?\n/).length > maxRows)) {
    alert("Maximum " + maxRows + " lines reached for " + title + "." +
          "\nPlease remove the extra line(s) to continue.");
    FocusDelay(TextArea);
    return;
  }

  var maxChars=300;
  if (clipData.replace(/\r?\n/gm,"").length > maxChars) {
    alert("Maximum " + maxChars + " characters reached for " + title + "." +
          "\nPlease remove the extra character(s) to continue.");
    FocusDelay(TextArea);
    return;
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);refreshTop();genderName();
              setTimeout('FocusUser()',100);displayServiceType();">
<span class=DFrameTitleBar>
Emergency Triage
</span>

<div id=PageBodySection>
<form name=UpdateForm action="emrweb02.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="02">
<input type=hidden name=template value="001">
<input type=hidden name=formactn>
<input type=hidden name=updttype>
<input type=hidden name=updateky value="">
<input type=hidden name=nextpage value="14">
<input type=hidden name=returnfm value=1>
<input type=hidden name=redirect>
<input type=hidden name=deceased>
<input type=hidden name=selsex>
<input type=hidden name=gname>
<input type=hidden name=sname>
<input type=hidden name=dummyadm>
<input type=hidden name=dummy>
<input type=hidden name=pfgname>
<input type=hidden name=pfsname>
<input type=hidden name=dummsrch value="1">
<input type=hidden name=fpatname>
<input type=hidden name=urnumber>
<input type=hidden name=emvis004>
<input type=hidden name=emvis005>
<input type=hidden name=emvis128>
<input type=hidden name=emvis129>
<input type=hidden name=emvis135>
<input type=hidden name=emvis136>
<input type=hidden name=emvis137>
<input type=hidden name=emvis138>
<input type=hidden name=patsname>
<input type=hidden name=patgname>
<input type=hidden name=emexp001 value="">
<input type=hidden name=heaambin value="1">
<input type=hidden name=ptcnhdps value="%STANDARD.01.025.080.250.1.1">
<input type=hidden name=securety value="2">
<input type=hidden name=triguser value="1">
<input type=hidden name=emrviscat value="el">
<input type=hidden name=name_emvis006 value="%EMRWEB02.02.106.0">
<input type=hidden name=defsrtyp value="%EMRWEB02.02.932">
<input type=hidden name=ptcnnmpr value="%STANDARD.01.025.128.226.1.1">

<table align=center width=95% border=0 cellspacing=0 cellpadding=1>
<tr><td class=DataLabel width=15% nowrap>User Id</td>
    <td width=20% nowrap>
      <input type=text size=12 name=secureid class=Mandatory tabindex=1
       title="User ID">
    Password
    <input type=password size =12 name=securepw class=Mandatory tabindex=2
         title="Password" onblur="checkPass();">
    </td>
    <td class=DataLabel width=15% nowrap>U/R
      <input type="text" size=10 maxlength=8 name=emvis118 tabindex=3
       onblur="justifyRight(this);PatientReturnAU();" title="U/R">
      <img src=../images/SearchIcon.gif class=Icon onclick="PatientSearchAU()">
    <td class=DataLabel>Surname</td>
    <td><input type=text size=25 max=25 name=emvis111 tabindex=4 title="Surname"
         onblur="UpCase(this);TextBlurHandler(this);"></td>
    <td class=DataLabel>Given Name</td>
    <td><input type=text size=25 max=25 name=emvis112 tabindex=5
         title="Given Name" onblur="UpCase(this);TextBlurHandler(this);"></td></tr>

<tr id=PrefNamesBoth style="display:none">
    <td>&nbsp;</td><td>&nbsp;</td>
    <td>&nbsp;</td>
    <td class=DataLabel>Preferred Surname</td>
    <td><input type=text size=20 maxlength=20 name=pmpxi82b id=pmpxi82b
         title="Preferred Surname" tabindex=3 class=Readonly></td>
    <td class=DataLabel>Preferred Given Name</td>
    <td><input type=text size=25 maxlength=25 name=pmpxi83b id=pmpxi83b
         title="Preferred Given Name" tabindex=3 class=Readonly></td>
</tr>

<tr id=PrefNamesGiven style="display:none">
    <td>&nbsp;</td><td>&nbsp;</td>
    <td>&nbsp;</td><td>&nbsp;</td>
    <td>&nbsp;</td>
    <td class=DataLabel>Preferred Given Name</td>
    <td><input type=text size=25 maxlength=25 name=pmpxi83g id=pmpxi83g
         title="Preferred Given Name" tabindex=3 class=Readonly></td>
</tr>

<tr id=PrefNamesSurname style="display:none">
    <td>&nbsp;</td><td>&nbsp;</td>
    <td>&nbsp;</td>
    <td class=DataLabel>Preferred Surname</td>
    <td><input type=text size=20 maxlength=20 name=pmpxi82s id=pmpxi82s
         title="Preferred Surname" tabindex=3 class=Readonly></td>
    <td>&nbsp;</td><td>&nbsp;</td>
</tr>

<tr><td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td class=DataLabel nowrap>%STANDARD.01.017.G </td>
    <td><select name=emexp004 class=SelectSml tabindex=6 
             title="%STANDARD.01.017.G ">
           <option></option>
     %EMRWEB02.02.086.099.061.9.1.19.3.H
        </select></td>
    <td class=DataLabel nowrap>Date of Birth </td>
    <td><input type="text" size=12 max=11 name=emexp005  
         title="Date of Birth" class="Past Date" tabindex=7>
        <img src=../images/DateLookup.gif class=Icon
         date=document.UpdateForm.emexp005>
        </td></tr>
</table>

<table align=center width=95% border=0 cellspacing=0 cellpadding=1>
<tr valign=top>
    <td class=DataLabel width=15%>Presenting Complaint</td>
    <td width=20% nowrap>
      <input type="text" size=10 tabindex=11 title="Presenting Complaint"
       onkeyup="UpCase(this);getPresentCom(this,UpdateForm.emvis060,
                UpdateForm.emrviscat);"
       onblur="DisplayDiv()">
     <select name=emvis060 class="SelectBig Mandatory" onchange="DisplayDiv();">
     </select>
    </td>
    <td colspan=5>
      <textarea type="text" name=prcom001 id=prcom001 wrap=hard tabindex=12
       cols=50 rows=6 style="overflow-y:hidden"
       title="Presenting Complaint Comments"
       onkeydown="ValidateKeyInput(this);"
       onblur="TextareaBlurHandler(this);ValidateTextLimits(this);">
      </textarea>
    </td>
</tr>
</table>

<div id=Triage></div>

<table align=center width=95% border=0 cellspacing=0 cellpadding=1>
<tr><td class=DataLabel width=15%>Location</td>
    <td width=20% nowrap>
      <select name=emvis006 title="Location" class="SelectMed Mandatory" 
     tabindex=21
     onchange="validateLocation(UpdateForm.emvis006,UpdateForm.name_emvis006);">
        <option></option>
        %EMRWEB02.02.106.3
      </select>
    </td>
    <td class=DataLabel width=10% nowrap>Number of Labels</td>
    <td width=5%>
      <select name=nolabels width=50% tabindex=22>
        <option></option>
        %STANDARD.01.027.1.1
      </select>
    </td>
    <td width=20% nowrap>Type
      <select name=labeltyp class=SelectBig tabindex=23>
        %STANDARD.01.019.LABELEMR.1
        %STANDARD.01.019.LABELKNX.1
      </select>
    </td>
    <td>Printer</td>
    <td>
      <select name=lblprint colspan=2 tabindex=24>
        %EMRWEB02.02.145.EMRTLBLS.01
      </select>
    </td>
</tr>

<tr><td class=DataLabel>Triage Category</td>
    <td>
      <table border=0 cellspacing=0>
      <tr><td class=Triage1><i>1</i>
            <input type=radio name=emvis003 value=1 title="Triage Category"
             tabindex=25 onclick="CheckMan();">
          </td>
          <td class=Triage2><i>2</i>
            <input type=radio name=emvis003 value=2 title="Triage Category"
             tabindex=25 onclick="unCheck();">
          </td>
          <td class=Triage3><i>3</i>
            <input type=radio name=emvis003 value=3 title="Triage Category"
             tabindex=25 onclick="unCheck();">
          </td>
          <td class=Triage4><i>4</i>
            <input type=radio name=emvis003 value=4 title="Triage Category"
             tabindex=25 onclick="unCheck();">
          </td>
          <td class=Triage5><i>5</i>
            <input type=radio name=emvis003 value=5 title="Triage Category"
             tabindex=25 onclick="unCheck();">
          </td>
      </tr>
      </table>
    </td>

    <td nowrap>Number of Copies</td>
    <td>
      <select name=nolabelf tabindex=26>
        <option></option>
        <option value="  1" selected>1</option>
        <option value="  2">2</option>
        <option value="  3">3</option>
        <option value="  4">4</option>
        <option value="  5">5</option>
        <option value="  6">6</option>
        <option value="  7">7</option>
        <option value="  8">8</option>
        <option value="  9">9</option>
        <option value=" 10">10</option>
      </select>
    </td>

    <td nowrap>Form
      <select name=statncod class=SelectBig tabindex=27>
        <option></option>
        %STANDARD.01.020.  7
      </select>
    </td>

    <td>Printer</td>
    <td>
      <select name=frmprint tabindex=28>
        %EMRWEB02.02.145.EMRTFRMS.02
      </select>
    </td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.035.eh</td>
    <td><select name=emvis056 title="%STANDARD.01.035.eh" tabindex=29
         class="SelectBig">
          <option></option>
          %EMRWEB02.02.216.2
        </select>
    </td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.035.eu</td>
    <td><select name=emvis069 id=emvis069 title="%STANDARD.01.035.eu" 
         tabindex=30 class="SelectBig Mandatory">
          <option></option>
          %EMRWEB02.02.229.2
        </select>
    </td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.017.EA</td>
    <td><select name=emvis013 id=emvis013 title="%STANDARD.01.017.EA" 
         tabindex=30 class="SelectBig Mandatory" onchange="MOAChange(this);">
          <option></option>
          %EMRWEB02.02.113.2
        </select>
    </td>
</tr>

<tr><td class="DataLabel">Ambulance Transfer of Care Date</td>
    <td nowrap><input type=text size=12 max=11 name="emvis156" tabindex=31
     title="Ambulance Transfer of Care Date" class="Date Readonly" readonly>
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Show Calendar" date="UpdateForm.emvis156">
    Time
    <input type=text size=8 max=8 name="emvis157" tabindex=32
     title="Ambulance Transfer of Care Time" class="Readonly" readonly>
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="UpdateForm.emvis156" time="UpdateForm.emvis157">
    <img notab src="../images/TimeLookup.gif" class="Icon"
     alt="Time Select" time="UpdateForm.emvis157">
     </td>
</tr>

<tr><td class=DataLabel>Amb. Case No</td>
    <td><input type=text size=12 maxlength=15 name=emvis034 tabindex=33
         title="Ambulance Case Number" class="Readonly" readonly>
    </td>
</tr>

<tr>
  <td>
    <div id=ServiceTypeTitleDIV></div>
  </td>
  <td>
    <div id=ServiceTypeFieldDIV></div>
  </td>

</tr>

<tr><td colspan=7 align=center>
      <input type=button value="Add" class="button" tabindex=40 name="AddButton"
       onclick="TriageComplete();">
      <input type=reset value="Cancel" class="button" tabindex=41>
    </td>
</tr>
</table>
</form>
</div>

<span id=ServiceTypeTitleSPAN style="display:none;">
%STANDARD.01.035.YW 
</span>

<span id=ServiceTypeFieldHiddenSPAN style="display:none;">
<input type=hidden name=emvis177 value="">
</span>

<span id=ServiceTypeFieldVisibleSPAN style="display:none;">
<select name="emvis177" class="SelectBig Mandatory" title="%STANDARD.01.035.YW"
 tabindex=34>
<option></option>
%STANDARD.01.021.YW
</select>
</span>

<span id=EmergencyProc style="display:none;">
<table align=center cellspacing=1 cellpadding=0 border=0 width=95%>
<tr><td class=DataLabel width=15%>Place Where Injury Occurred</td>
    <td width=20% nowrap>
      <select name="emvis021" class=SelectBig tabindex=15
       title="Place Where Injury Occurred">
        <option></option>
        %EMRWEB02.02.121.2
      </select>
    </td>
    <td class=DataLabel width=10%>Activity When Injured</td>
    <td width=15%>
      <select name="injur006" class=SelectBig title="Activity When Injured"
       tabindex=16>
        <option></option>
        %EMRWEB02.02.183.2
      </select>
    </td>
    <td class=DataLabel width=10%>Injury Cause</td>
    <td><select name="injur004" class=SelectBig title="Injury Cause" 
         tabindex=17>
     <option></option>
     %EMRWEB02.02.181.2
     </select>
     </td></tr>

<tr valign=top><td class=DataLabel>Human Intent</td>
    <td><select name="injur005" class=SelectBig title="Human Intent"
         tabindex=18>
    <option></option>
     %EMRWEB02.02.182.2
      </select></td>
    <td class=DataLabel>
    Desc. of Injury Event</td>
    <td colspan=3><input type="text" name="injur002" maxlength="50" size="40"
         title="Description of Injury Event" value="" tabindex=19>
    <input type="text" name="injur003" maxlength="50" size="40" value=""
     tabindex=20></td></tr>
</table>
</span>

<script type="text/javascript">
 LabelCop="%STANDARD.01.034.EMRTLBLS.01"
 for (var i=0;i<document.UpdateForm.nolabels.length;i++){
  if (document.UpdateForm.nolabels.options[i].value.replace(/ /g,"")==
      LabelCop.replace(/ /g,"")){
      document.UpdateForm.nolabels.selectedIndex=i}};

 LabelNam="%STANDARD.01.036.EMRTLBLS.01"
 for (var i=0;i<document.UpdateForm.labeltyp.length;i++){
  if (document.UpdateForm.labeltyp.options[i].value.replace(/ /g,"")==
      LabelNam.replace(/ /g,"")){
      document.UpdateForm.labeltyp.selectedIndex=i}};
//
 FormCop="%STANDARD.01.034.EMRTFRMS.02"
 for (var i=0;i<document.UpdateForm.nolabelf.length;i++){
  if (document.UpdateForm.nolabelf.options[i].value.replace(/ /g,"")==
      FormCop.replace(/ /g,"")){
      document.UpdateForm.nolabelf.selectedIndex=i}};

 FormNam="%STANDARD.01.033.EMRTFRMS.02"
 for (var i=0;i<document.UpdateForm.statncod.length;i++){
  if (document.UpdateForm.statncod.options[i].value.replace(/ /g,"")==
      FormNam.replace(/ /g,"")){
      document.UpdateForm.statncod.selectedIndex=i}};
</script>
