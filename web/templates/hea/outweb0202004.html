<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="hea">
<meta name="HelpFileName"    content="NoContextSet.html"> 
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/outweb0202.js"></script>
<script type="text/javascript" src="../js/outweb02.js"></script>
<script type="text/javascript" src="../js/outweb0202004.js"></script>

<link rel="stylesheet" media="print" href="../html/printWithHeader.css"
      type="text/css">

<style type="text/css">
td { vertical-align: text-top; }

img.ListIcon {
 border:0px;
 cursor:hand;
 margin-top:0px; 
 margin-bottom:2px; 
 margin-left:0px; 
 margin-right:3px; 
 vertical-align: text-top;
}
</style>

<script type="text/javascript">
function SummaryPage() {
  location.href="outweb02.pbl?reportno=1&template=5" +
                "&frstdate=" + UpdateStatus.sesskeys.value.substr(12,8) +
                "&lastdate=" + UpdateStatus.sesskeys.value.substr(12,8) 
}
function UpdateSlot(A,B,C) {
   UpdateStatus.casekeys.value=A
   LinkURL='patweb90.pbl?reportno=1&template=200'
   DFrameLink(LinkURL,25,50,700,420)
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link
//  1 - date/time
//  2 - slot
//  3 - visit type code
//  4 - visit type desc
//  5 - formatted name
//  6 - ur
//  7 - outpatient visit number
//  8 - sex
//  9 - age
//  10- space
//  11- space
//  12- space
//  13- space
//  14- time actually seen
//  15- check in time
//  16- time of departure
//  17- slot status
//  18- space
//  19- space
//  20- follow up appointment made
//  21- DNA or spaces
//  22- visit extension user defined free format 1
//  23- diagnosis comments
//  24- alerts string
//  25- home phone
//  26- business phone
//  27- mobile phone
//  28- casekeys
//  29- language
//  30- special arrangements
//  31- status
//  32- patient folder extension
//  33- outcome code
//  34- coloured visit number
//  35- coloured visit type
//  36- diagnosis comments
//  37- claim code
//  38- claim comment flag
//  39- highlight colours
//  40- referral expiry
//  41- claim status
//  42- cmbs item
//  43- batch number
//  44- print checkbox disabled
//  45- print checkbox ticked
//  46- print checkbox unticked
//  47 - Referral Number
//  48 - Referral Number
//  49 - Referral Dept
//  50 - Using med claim
//  51 - A/H Departmetn
//  52 - Collect Enc
//  53 - Linked Enc
//  54 - source of ref
//  55 - update array javascript
//----------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
  // Booking Details
  case "0":
   t = new Table(1,0,2,"100%","center",40,45);

   t.addColumn("Time","Time",1,1,"left","AppointmentIcon.gif","Slot",50)
   t.addColumn("Type","String",34,34,"left","","",35)
   t.addColumn("U/R","String",6,6,"left","","",50)
t.addColumn("Patient","StringPatient",5,5,"left","PatientFolder","Patient",170)
   if (document.UpdateStatus.othecpmi.value=="1") {
     t.addColumn("Confirm PMI","ButtonLinkWide",65,66,"left","","ConfirmPMI",80)
   }
   t.addColumn("Check-In","ButtonLink",15,-1,"left","","CheckIn",50)
   t.addColumn("Time Seen","ButtonLink",14,-1,"left","","TimeSeen",50)
   t.addColumn("Departure","ButtonLink",16,-1,"left","","Departure",50)
   t.addColumn("Follow Up","ButtonLink",20,-1,"left","","FollowUp",50)
   t.addColumn("Non Attend","ButtonLink",21,-1,"left","","NonAttend",50)
   t.addColumn("Alerts","Image",22,-1,"left","alert","",50)
   t.addColumn(UpdateStatus.dummyclm.value,"String",83,83,"left","","",25)
   AddTableRows();
   TableOutput(0,1);    // Order Column,Asc Dsc
   break;

  // Diagnosis Details
  case "1":
   t = new Table(1,0,2,"100%","center",40);
   t.addColumn("Time","Time",1,1,"left","AppointmentIcon.gif","Slot",60)
   t.addColumn("Type","String",34,34,"left","","",50)
   t.addColumn("U/R","String",6,6,"left","","",60)
t.addColumn("Patient ","StringPatient",5,5,"left","PatientFolder","Patient","23%")
   if (document.UpdateStatus.othecpmi.value=="1") {
     t.addColumn("Confirm PMI","ButtonLinkWide",65,66,"left","","ConfirmPMI",85)
   }
   t.addColumn("Check-In","ButtonLink",15,-1,"left","","CheckIn",70)
   t.addColumn("Time Seen","ButtonLink",14,-1,"left","","TimeSeen",70)
   t.addColumn("Diagnosis/Complaint","String",22,22,"","","","22%")
   t.addColumn("Comments","String",36,36,"","","","22%")
   t.addColumn("Alerts","Image",22,-1,"left","alert","","15%")
   AddTableRows();
   TableOutputDynamicRow(0,1,63);    // Order Column,Asc Dsc
   break;

  // Contact Details
  case "2":
   t = new Table(1,0,2,"100%","center",40,45);
   t.addColumn("Time","Time",1,1,"left","AppointmentIcon.gif","Slot",55)
   t.addColumn("Type","String",34,34,"left","","",45)
   t.addColumn("U/R","String",6,6,"left","","",55)
   t.addColumn("Patient ","StringPatient",5,5,"left","PatientFolder","Patient",180)
   t.addColumn("Private","String",25,25,"","","",75)
   t.addColumn("Business","String",26,26,"","","",75)
   t.addColumn("Mobile","String",27,27,"","","",75)
   AddTableRows();
   TableOutput(0,1);    // Order Column,Asc Dsc
   break;
 }
}
function initA(){
  if (document.UpdateStatus.othecenc.value=="1") {
     SelectPeriod.viewlink.options[SelectPeriod.viewlink.options.length]=
     new Option("Bulk Contact","14");
  }
}
function assignHCPdiv() {
  viewLink.innerHTML = viewlinknormal.innerHTML;
  if (document.UpdateStatus.kydoccod.value=="Y") {
    viewLink.innerHTML = assignhcp.innerHTML;
  }
}
function getmtvcookie() {
  mtvcckie = GetCookieData('mtvctcookie');
  if (!isWhitespace(mtvcckie) && mtvcckie != 'unknown') {
    document.UpdateStatus.mtvcckie.value = mtvcckie;
    document.cookie='mtvctcookie=;';
  }
  mtvlckie = GetCookieData('mtvldcookie');
  if (!isWhitespace(mtvlckie) && mtvlckie != 'unknown') {
    document.UpdateStatus.mtvlckie.value = mtvlckie;
    document.cookie='mtvldcookie=;';
  }
}
function SetMTVCookie() {
  if (document.SelectPeriod.viewlink.value=='15') {
    document.cookie='mtvctcookie='+escape(document.UpdateStatus.mtvcckie.value);
    document.cookie='mtvldcookie='+escape(document.UpdateStatus.mtvlckie.value);
  }
}
</script>
</head>
%START.OF.PAGE
<body onload='PageLoad(event);
              assignHCPdiv();
              LoadTable("%OUTWEB02.02.044");
              SetPageRefreshOut(90);
              initA();
              getmtvcookie();
              showTodayButton();'>
<div id=HeadingSection>
<form name=UpdateStatus action=outweb02.pbl method=post style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=1>
<input type=hidden name=redirect value="">
<input type=hidden name=updatety value="">
<input type=hidden name=casekeys value="">
<input type=hidden name=sesskeys value="%OUTWEB02.02.004">
<input type=hidden name=sessupdt value="">
<input type=hidden name=bookstat value="">
<input type=hidden name=urnumber value="">
<input type=hidden name=admissno value="">
<input type=hidden name=patfname value="">
<input type=hidden name=dummyadm value="">
<input type=hidden name=dummyclm value="%STANDARD.01.017.CL">
<input type=hidden name=othecenc value="%OUTWEB02.02.051">
<input type=hidden name=othedurn value="%OUTWEB02.02.053">
<input type=hidden name=xocadoct value="%OUTWEB02.02.199.003.1">
<input type=hidden name=xocahcp1 value="%OUTWEB02.02.140.056">
<input type=hidden name=xocahcp2 value="%OUTWEB02.02.140.057">
<input type=hidden name=xocahcp3 value="%OUTWEB02.02.140.058">
<input type=hidden name=xocahcp4 value="%OUTWEB02.02.140.059">
<input type=hidden name=kydoccod value="%OUTWEB02.02.150">
<input type=hidden name=mtvcckie value="">
<input type=hidden name=mtvlckie value="">
<input type=hidden name=othecpmi value="%OUTWEB02.02.058">
</form>

<form name=SelectPeriod action=outweb02.pbl method=get style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=4>
<input type=hidden name=contview value="%OUTWEB02.02.057">
<input type=hidden name=tablview value="%OUTWEB02.02.044">
<input type=hidden name=sesskeyt value="%OUTWEB02.02.071">
<input type=hidden name=loctoday value="%OUTWEB02.02.072">
<input type=hidden name=otcndtdy id=otcndtdy
       value="%STANDARD.01.025.032.148.1.1">
<input type=hidden name="show_refxwarn" id="show_refxwarn" value="1">

<table cellspacing=0 cellpadding=1 bgcolor=#CCCCCC border=0 width=100%>
<tr><td class=HeadingCell width=10%>
    <img src="../images/ListIcon.gif" class=Icon title="Clinic Timetable"
     onclick='GoOutpatientListSTV();'>
    <img src="../images/RefreshIcon.gif" class=Icon title="Refresh"
     onclick='location.reload();'></td>
    <td class=HeadingCell align=center>
    Clinic for %OUTWEB02.02.014 (%OUTWEB02.02.018) - %OUTWEB02.02.151</td>
    <td class=HeadingCell width=10%></td></tr>
</table>

<table cellspacing=0 cellpadding=1 bgcolor=#CCCCCC border=0 width=100%>
<tr><td width=10% class=DataLabel>Views</td>
    <td width=35% class=DataField>
    <div id=viewLink></div>
    </td>
    <td class=DataLabel>Date & Start Time</td>
    <td align=right>
    <span id=TodayButSpan style="display:none">
      <input type=button name=btnToday id=btnToday value="Today" class=button
       title="Switch to today's clinic"
       onclick='setTodayDate();'>
    </span>
    <input type=button value="<<" class=SmallButton
     onclick='location.href="%OUTWEB02.02.002"'>
    <select name=sesskeys onchange='document.SelectPeriod.submit();'>
      %OUTWEB02.02.003
    </select>
    <input type=button value=">>" class=SmallButton
    onclick='location.href="%OUTWEB02.02.001"'>
    </td></tr>

<tr><td class=DataLabel>Clinic Type</td>
    <td class=DataField>%OUTWEB02.02.027.0</td>
    <td class=DataLabel>Location</td>
    <td class=DataField>%OUTWEB02.02.029.0</td></tr>

<tr><td class=DataLabel>Session Status</td>
    <td class=DataField>%OUTWEB02.02.020.0</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td></tr>

<tr valign=top>
    <td class=DataLabel>Comments</td>
    <td class=DataField>
    %OUTWEB02.02.026
    <td class=DataLabel>Instructions
    </td> <td> 
    <b> %OUTWEB02.02.028</b> <br></td> </tr> 

<tr><td></td><td>
    <b>%OUTWEB02.02.021<br>
    %OUTWEB02.02.022 </b> 
    </td></tr>
</table>

</form>
</div>

<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows(){
%OUTWEB02.02.009.outweb02.03.001
}
</script>

<span id="assignhcp" style="display:none">
    <select name=viewlink onchange="SetMTVCookie();ViewLink(this.value);" >
    <option value=0>Bookings Details</option>
    <option value=1>Diagnosis Details</option>
    <option value=2>Contact Details</option>
    <option value=3>Update Slots</option>
    <option value=4>Reschedule</option>
    <option value=5>Update All Non Attended</option>
    <option value=6>Update Comments</option>
    <option value=7>Suspend Clinic</option>
    <option value=8>Print Group Labels</option>
    <option value=9>Clinic Usage</option>
    <option value=10>Bulk Attendance</option>
    <option value=11>Bulk Departure</option>
    <option value=17>Bulk Discharge</option>
    <option value=12>Bulk Follow Up</option>
    <option value=13>Confirmed Appointments</option>
    <option value=15>Assign Health Care Prof</option>
    <option value=16>Multi Therapist View</option>
    </select>
</span>
<span id="viewlinknormal" style="display:none">
    <select name=viewlink onchange="SetMTVCookie();ViewLink(this.value);" >
    <option value=0>Bookings Details</option>
    <option value=1>Diagnosis Details</option>
    <option value=2>Contact Details</option>
    <option value=3>Update Slots</option>
    <option value=4>Reschedule</option>
    <option value=5>Update All Non Attended</option>
    <option value=6>Update Comments</option>
    <option value=7>Suspend Clinic</option>
    <option value=8>Print Group Labels</option>
    <option value=9>Clinic Usage</option>
    <option value=10>Bulk Attendance</option>
    <option value=11>Bulk Departure</option>
    <option value=12>Bulk Follow Up</option>
    <option value=13>Confirmed Appointments</option>
    <option value=16>Multi Therapist View</option>
    </select>
</span>
