<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="hea">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/OutExtraTemplates.js"></script>
<script type="text/javascript" src="../js/outweb0803.js"></script>
<script type="text/javascript" src="../js/outweb0803003.js"></script>
<script type="text/javascript" src="../js/patweb69.js"></script>
%START.OF.PAGE
<script type="text/javascript">
function valClaimCode() {
  validateCode(41,AddForm.urnumber,AddForm.claimc);
  for (var i =0 ; i < document.AddForm.outbb002.length; i++) {
    if (document.AddForm.claimc.value==
        trim(document.AddForm.outbb002.options[i].value.substr(0,3))){
          document.AddForm.outbb002.selectedIndex=i;
    }
  }
}

function SubmitFinalA() {
  setRedirect()
  if (!validateMandatory(AddForm)) {
     return;
  }
  p=document.AddForm
  if(p.d_pmsvx093.checked==true) {
    p.pmsvx093.value="1"
  } else {
    p.pmsvx093.value="0"
  }
  p.dummydat.value=p.firstbok.value.substr(4,11);
  HealthFundProgramOP(p.urnumber,p.outbb003,p.outbb002,p.outbb008,
                      p.outbb009,p.dummydat,p.outbb047);
  AddForm.submit()
}

function Ipreter() {
 if (document.AddForm.pmpxintr.value== 1)
  { document.AddForm.d_pmsvx093.checked=true; }
}

function SendLetter(theForm) {
 if(theForm.outbb047.value.substr(10,1) == "C" ) { // Ind 8 - Chart Only
    theForm.sendlett.selectedIndex=3;              // set send letter to N/A
    theForm.sendlett.className="Readonly";
    theForm.sendlett.disabled=true;
  } else {
    if(theForm.sendlett.disabled==true) {          // Defalut send letter to
       theForm.sendlett.selectedIndex=0;           // Blank when re enabled
    }
    theForm.sendlett.className="";
    theForm.sendlett.disabled=false;
  }
}

function SearchRedirect() {
  var p = document.AddForm;

  var sURL = "patweb69.pbl?reportno=01&template=001" +
             "&srchsnam=" + p.srchsnam.value +
             "&srchgnam=" + p.srchgnam.value +
             "&srchmnam=" + p.srchmnam.value +
             "&srchpsex=" + p.srchpsex.value +
             "&srchpdob=" + p.srchpdob.value +
             "&srchmedi=" + p.srchmedi.value + "&srchtype=1";

  var sRedirectURL = "outweb08.pbl?reportno=01&template=002" +
                     "&urnumber=" + p.urnumber.value.replace(/ /g,"+") +
                     "&admissno=" + p.admissno.value.replace(/ /g,"+");

  sURL += "&redirect=" + encodeURIComponent(sRedirectURL);

  DFrameExit();

  setTimeout(function() {
    top.content.location.href = sURL;
  }, 100);
}

</script>
</head>
<body onload="PageLoad(event);valClaimCode();GetBookings();
              DisplayXCmbs();DisplayCarer();
              Ipreter();claimHF(AddForm);
              checkBasicCoverRate(document.AddForm.outbb002);
              FilterClaimType(document.AddForm.outbb002);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Make A Series Appointment
</span>

<div id=PageBodySection style="overflow: auto;">
<form name=AddForm action=outweb08.pbl method=post style="margin:0"
 onsubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value="04">
<input type=hidden name=template value="003">
<input type=hidden name=urnumber value="%OUTWEB08.03.003">
<input type=hidden name=admissno value="%OUTWEB08.03.081">
<input type=hidden name=bookflag value="%OUTWEB08.03.214">
<input type=hidden name=refrlvis value="%OUTWEB08.03.353.001">
<input type=hidden name=refrdate value="%OUTWEB08.03.353.019">
<input type=hidden name=refrexpd value="%OUTWEB08.03.353.087">
<input type=hidden name=refrclin value="%OUTWEB08.03.353.088.1">
<input type=hidden name=refrctyp value="%OUTWEB08.03.353.067.1">
<input type=hidden name=updttype value="5">
<input type=hidden name=nextpage value="8">
<input type=hidden name=redirect value="%OUTWEB08.03.001.patweb98.01.001">
<input type=hidden name=dummy value="">
<input type=hidden name=firstbok value="">
<input type=hidden name=seriflag value="1">
<input type=hidden name=claimc>
<input type=hidden name=clinctyp value="%OUTWEB08.03.205.1">
<input type=hidden name=otheccar value="%OUTWEB08.03.218">
<input type=hidden name=pmpxintr value="%OUTWEB08.03.219">
<input type=hidden name=dummydat value="">
<input type=hidden name=tmotfrst value="30">
<input type=hidden name=tmotnext value="30">
<input type=hidden name=ptcnuepm value="%STANDARD.01.025.125.155.0.1">
<input type=hidden name=srchsnam value="%OUTWEB08.03.009">
<input type=hidden name=srchgnam value="%OUTWEB08.03.086.099.001">
<input type=hidden name=srchmnam value="%OUTWEB08.03.086.099.002">
<input type=hidden name=srchpsex value="%OUTWEB08.03.086.082">
<input type=hidden name=srchpdob value="%OUTWEB08.03.020">
<input type=hidden name=srchmedi value="%OUTWEB08.03.027">
<input type=hidden name=clinindc value="%OUTWEB08.03.235">
<input type=hidden name=ptcnuebb value="%STANDARD.01.025.127.122.0.1">
<input type=hidden name=dateclin value="%OUTWEB08.03.104">
<input type=hidden name=nslotkey value="%OUTWEB08.03.166">
<input type=hidden name=dumdate value="">
<input type=hidden name=dumInput value="">
<input type=hidden name=bookalla value="1">

<table cellspacing=0 cellpadding=0 border=0 width=95% align=center>
<tr><td>
<div id=Appointments></div>
</td></tr>

<tr><td class=DataLabe width=15%>Visit Type</td>
    <td class=DataField colspan=3>
    <select name=outbb047 title="Visit Type" class="SelectBig Mandatory"
     onchange="SendLetter(AddForm);">
    <option> </option>
    %OUTWEB08.03.199
    </select>
    </td></tr>

<tr valign=top>
    <td class=DataLabel>Presenting Complaint</td>
    <td class=DataField colspan=3>
    <input type=text name=pmsvx052 size=50 maxlength=50 value="">
    </td></tr>

<tr valign=top>
    <td class=DataLabel>Diagnosis</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb045 value=""
     onblur="validateCode(6,AddForm.outbb045,AddForm.outbb046);">
    <input type=text name=outbb046 size=65 maxlength=50
     readonly class=Readonly value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb045,AddForm.outbb046);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb045,AddForm.outbb046);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb055 value=""
     onblur="validateCode(6,AddForm.outbb055,AddForm.outbb056);">
    <input type=text name=outbb056 readonly class=Readonly 
                                   size=65 maxlength=50 value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb055,AddForm.outbb056);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb055,AddForm.outbb056);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb057 value=""
     onblur="validateCode(6,AddForm.outbb057,AddForm.outbb058);">
    <input type=text size=65 maxlength=50 name=outbb058 
                             readonly class=Readonly value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb057,AddForm.outbb058);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb057,AddForm.outbb058);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb059 value=""
     onblur="validateCode(6,AddForm.outbb059,AddForm.outbb060);">
    <input type=text size=65 maxlength=50 name=outbb060 
                                  readonly class=Readonly value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb059,AddForm.outbb060);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb059,AddForm.outbb060);">
    </td></tr>

<tr><td class=DataLabel>Transport</td>
    <td class=DataField><select name=outbb023 class=selectBig>
        <option></option>
        %OUTWEB08.03.142.2
        </select></td>
    <td class=DataLabel>Priority</td>
    <td class=DataField><select name=outbb013 class=SelectBig>
	<option></option>
	%OUTWEB08.03.132.2
	</select>
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField><select name=outbb002 class="Mandatory SelectBig"
        title="%STANDARD.01.017.CL" 
        onchange="DisplayXCmbs();claimHF(AddForm);">
        <option></option>
        %OUTWEB08.03.197.2
        </select></td>
    <td class=DataLabel>Unit</td>
    <td class=DataField><select name=outbb022 class="SelectBig"
                         title="Unit">
	<option></option>
	%OUTWEB08.03.141.2
	</select></td></tr>

<tr><td class=DataLabel>Health Fund</td>
    <td>
      <input type=text size=6 maxlength=6 name=outbb008 title="Health Fund"
       onchange="validateCode(16,document.AddForm.outbb008,
       AddForm.funddesc);
       checkHFTable(AddForm);" value="%OUTWEB08.03.040.0">
      <input type=text size=30 maxlength=30 name=funddesc class=readonly
       Readonly notab value="%OUTWEB08.03.040.1" tabindex=-1>
    </td>
    <td class=DataLabel>Attending Doctor</td>
    <td class=DataField>
    <input type=text name=outbb006 size=8 maxlength=6
     onblur="validateCode(31,AddForm.outbb006,AddForm.n_outbb006);">
    <input type=text name=n_outbb006 size=30 readonly class="ReadOnly">
    <img src="../images/SearchIcon.gif" class="Icon"
     onclick="DoctorSearchFrame(AddForm.outbb006,AddForm.n_outbb006);">
    <img src="../images/erase.gif" class="Icon"
     onclick="clrFields(AddForm.outbb006,AddForm.n_outbb006);">
    </td></tr>

<tr><td class=DataLabel>Level</td>
    <td>
      <input name="outbb009" maxlength=8 value="%OUTWEB08.03.041.0"
       title="Level"
       onblur="validateHFT(20,AddForm.outbb008,AddForm.outbb009,
       AddForm.funddesc,AddForm.tabldesc);
       checkHFTable(AddForm);" size=8>
      <input type="text" size=20 maxlength=17 name="tabldesc" class=readonly
       Readonly notab value="%OUTWEB08.03.041.1" tabindex=-1>
      <img src=../images/SearchIcon.gif class="Icon"
       onclick="HealthFundSearchFrame(AddForm.outbb008,AddForm.funddesc,
                AddForm.outbb009,AddForm.tabldesc);">
      <img src="../images/erase.gif" class="Icon" 
       onclick="clrDoc(AddForm.outbb008,AddForm.outbb009);
       clrDoc(AddForm.funddesc,AddForm.tabldesc);checkHFTable(AddForm);">
    </td>
    <td class=DataLabel>Referring GP</td>
    <td class=DataField>
    <input type=hidden name=dummy1 value="6">
    <input type=hidden name=outbb029 >
    <input type=text readonly name=name_outbb029
     value="%OUTWEB08.03.148.004" class=Readonly>
    <img src="../images/SearchIcon.gif" class="Icon"
     onclick="HCPSearchFrame(AddForm.outbb029,AddForm.name_outbb029,
              AddForm.dummy1.value)">
    <img src="../images/erase.gif" class="Icon"
     onclick="clrFields(AddForm.outbb029,AddForm.name_outbb029);">
    </td></tr>

<tr><td class=DataLabel>Source of Referral</td>
    <td class=DataField><select name=outbb018 class="SelectBig"
        title="Source of Referral">
        <option></option>
        %OUTWEB08.03.137.2
        </select></td>
    <td class=DataLabel>Program Code</td>
    <td class=DataField><select name=outbb003 title="Program Code"
                         class="SelectBig">
                        <option></option>
                        %OUTWEB08.03.122.2
                        </select>
    </td></tr>

<tr><td class=DataLabel>Special Arrangements</td>
    <td class=DataField><select name=outbb054 class=SelectBig>
    <option> </option>
    %OUTWEB08.03.178.2
    </select></td>
    <td class=DataLabel>New Program</td>
    <td class=DataField><input type="checkbox" name="addnewpg" value="1"
                         onclick="MandProgram();"></td>
    </tr>

<tr><td class=DataLabel>Notify GP</td>
    <td><input type=checkbox value=1 name=outbb036></td>
    <td class=DataLabel>Send Letter</td>
    <td><select name=sendlett tabindex=25
         title="Send Letter - Generate letter date will be calculated">
        <option></option>
        <option value="0">No</option>
        <option value="1">Yes</option>
        <option value="2">N/A</option>
        </select>
    </td>
    </tr>

<tr><td class=DataLabel>Interpreter Required</td>
    <td class=DataField><input type=hidden name="pmsvx093" value="">
                        <input type="checkbox" name="d_pmsvx093" value="1"></td>
    <td class=DataLabel></td>
    <td class=DataField></td>
    </tr>

<tr valign=top><td class=DataLabel>Comments</td>
    <td class=DataField colspan=3>
    <textarea name=outptcom wrap=hard cols=70 rows=3></textarea>
    </td></tr>
</table>
     
<div id=ShowXCmbs></div>
<div id=ShowCarer></div>
    
<table border=0 width=95% cellspacing=0 cellpadding=0 align=center>
<tr><td colspan=4 align=center>
    <input type=button class="button" value="Ok" 
    onclick="SubmitFinalA();" disabled name=okbutton>
    <input type=button class="button" value="Cancel" onclick='DFrameClose();'>
    </td></tr>
</table>

</form>
</div>

<span id=extracmbs style="display:none">
<table border=0 width=95% cellspacing=0 cellpadding=0 align=center>

<tr><td width=15% class=DataLabel>CMBS Code</td>
    <td class=DataField>
    <input type=hidden name=otbit001 title="Item Type" value="MBS">
    <input type=text size=9 name=otbit002 title="Item Code" value=""
     onchange="validatePMBS(AddForm.otbit002,AddForm.mbsdesc1,
               AddForm.otbit001,AddForm.otbit003,
               AddForm.dateclin,AddForm.mbsamnt1);">
    <input type=text size=3 name=otbit003 title="Sub-Item Code" value=""
     onchange="validatePMBS(AddForm.otbit002,AddForm.mbsdesc1,
               AddForm.otbit001,AddForm.otbit003,
               AddForm.dateclin,AddForm.mbsamnt1);">
    <input type=text size=30 name=mbsdesc1 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt1 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
     onclick="PriMbsSearchFrame(AddForm.otbit001,AddForm.otbit002,
              AddForm.otbit003,AddForm.dumdate,
              AddForm.mbsdesc1,AddForm.dumInput,TypeDesc1);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.otbit002,AddForm.otbit003,
                        AddForm.mbsdesc1,AddForm.mbsamnt1,AddForm.otbit016);">
    <input type=text maxlength=20 size=22 name=otbit016 title="Provider Usage"
     tabindex=91 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit004 title="Item Type 2" value="MBS">
    <input type=text size=9 name=otbit005 title="Item Code 2" value=""
     onchange="validatePMBS(AddForm.otbit005,AddForm.mbsdesc2,
               AddForm.otbit004,AddForm.otbit006,
               AddForm.dateclin,AddForm.mbsamnt2);">
    <input type=text size=3 name=otbit006 title="Sub-Item Code 2" value=""
     onchange="validatePMBS(AddForm.otbit005,AddForm.mbsdesc2,
               AddForm.otbit004,AddForm.otbit006,
               AddForm.dateclin,AddForm.mbsamnt2);">
    <input type=text size=30 name=mbsdesc2 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt2 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick="PriMbsSearchFrame(AddForm.otbit004,AddForm.otbit005,
             AddForm.otbit006,AddForm.dumdate,
             AddForm.mbsdesc2,AddForm.dumInput,TypeDesc2);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.otbit005,AddForm.otbit006,
              AddForm.mbsdesc2,AddForm.mbsamnt2,AddForm.otbit017);">
    <input type=text maxlength=20 size=22 name=otbit017 title="Provider Usage 2"
     tabindex=92 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit007 title="Item Type 3" value="MBS">
    <input type=text size=9 name=otbit008 title="Item Code 3" value=""
     onchange="validatePMBS(AddForm.otbit008,AddForm.mbsdesc3,
               AddForm.otbit007,AddForm.otbit009,
               AddForm.dateclin,AddForm.mbsamnt3);">
    <input type=text size=3 name=otbit009 title="Sub-Item Code 3" value=""
     onchange="validatePMBS(AddForm.otbit008,AddForm.mbsdesc3,
               AddForm.otbit007,AddForm.otbit009,
               AddForm.dateclin,AddForm.mbsamnt3);">
    <input type=text size=30 name=mbsdesc3 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt3 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick="PriMbsSearchFrame(AddForm.otbit007,AddForm.otbit008,
             AddForm.otbit009,AddForm.dumdate,
             AddForm.mbsdesc3,AddForm.dumInput,TypeDesc3);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.otbit008,AddForm.otbit009,
              AddForm.mbsdesc3,AddForm.mbsamnt3,AddForm.otbit018);">
    <input type=text maxlength=20 size=22 name=otbit018 title="Provider Usage 3"
     tabindex=93 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit010 title="Item Type 4" value="MBS">
    <input type=text size=9 name=otbit011 title="Item Code 4" value=""
     onchange="validatePMBS(AddForm.otbit011,AddForm.mbsdesc4,
               AddForm.otbit010,AddForm.otbit012,
               AddForm.dateclin,AddForm.mbsamnt4);">
    <input type=text size=3 name=otbit012 title="Sub-Item Code 4" value=""
     onchange="validatePMBS(AddForm.otbit011,AddForm.mbsdesc4,
               AddForm.otbit010,AddForm.otbit012,
               AddForm.dateclin,AddForm.mbsamnt4);">
    <input type=text size=30 name=mbsdesc4 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt4 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick="PriMbsSearchFrame(AddForm.otbit010,AddForm.otbit011,
             AddForm.otbit012,AddForm.dumdate,
             AddForm.mbsdesc4,AddForm.dumInput,TypeDesc4);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.otbit011,AddForm.otbit012,
              AddForm.mbsdesc4,AddForm.mbsamnt4,AddForm.otbit019);">
    <input type=text maxlength=20 size=22 name=otbit019 title="Provider Usage 4"
     tabindex=94 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit013 title="Item Type 5" value="MBS">
    <input type=text size=9 name=otbit014 title="Item Code 5" value=""
     onchange="validatePMBS(AddForm.otbit014,AddForm.mbsdesc5,
               AddForm.otbit013,AddForm.otbit015,
               AddForm.dateclin,AddForm.mbsamnt5);">
    <input type=text size=3 name=otbit015 title="Sub-Item Code 5" value=""
     onchange="validatePMBS(AddForm.otbit014,AddForm.mbsdesc5,
               AddForm.otbit013,AddForm.otbit015,
               AddForm.dateclin,AddForm.mbsamnt5);">
    <input type=text size=30 name=mbsdesc5 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt5 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick="PriMbsSearchFrame(AddForm.otbit013,AddForm.otbit014,
             AddForm.otbit015,AddForm.dumdate,
             AddForm.mbsdesc5,AddForm.dumInput,TypeDesc5);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.otbit014,AddForm.otbit015,
              AddForm.mbsdesc5,AddForm.mbsamnt5,AddForm.otbit020);">
    <input type=text maxlength=20 size=22 name=otbit020 title="Provider Usage 5"
     tabindex=95 value="">
    </td>
    </tr>

<tr><td>Use CMBS Template</td>
    <td><input type=checkbox value=1 name=cmbsload onclick="TemplateCmbs();">
    &nbsp;
    <select class="SelectBig" name=cmbstemp title="CMBS Template"
         onchange="TemplateCmbs();">
          <option></option>
          %OUTWEB08.03.236
          </select></td>
    </tr>

</table>
</span>

<span id=sendcarer style="display:none">
<table border=0 width=95% cellspacing=0 cellpadding=0 align=center>
<tr><td width=15% class=DataLabel>Send Correspondence to Carer</td>
    <td class=DataField>
      <input type=checkbox value=1 name=outbb065 id=outbb065 checked>
    </td></tr>
</table>
</span>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=003>
<input type=hidden name=urnumber value="%OUTWEB08.03.003">
<input type=hidden name=admissno value="%OUTWEB08.03.081">
<input type=hidden name=MenuType value="%OUTWEB08.03.088">
</form>

<script type="text/javascript">
 if ("%OUTWEB08.03.086.001.0" == "1") {
    document.AddForm.d_pmsvx093.checked = 1
 } else {
    document.AddForm.d_pmsvx093.disabled=true;
 }
</script>
