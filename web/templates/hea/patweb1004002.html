<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="hea">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/AutoPostCode.js"> </script>
<script type="text/javascript" src="../js/patweb1004002.js"> </script>
<script type="text/javascript">
function LinkDFrameExit() {
 if(document.AddForm.trnsflag.value!="0") {
   location.href="outweb02.pbl?reportno=03&template=013" +
                 "&admissno=" + AddForm.pmtsp002.value.replace(/ /g,"+") +
                 "&waitflag=" + AddForm.waitflag.value.replace(/ /g,"+");
   parent.document.getElementById('PopUpScreen').style.width=700;
   parent.document.getElementById('PopUpScreen').style.height=400;
   Left=(parent.document.body.clientWidth-700)/2;
   parent.document.getElementById('PopUpScreen').style.left=Left;
 } else {
   DFrameClose();
 }  
} 
function BookAllTransport() {
  document.AddForm.updttype.value="S";   // Series
  AddTransportRed();
}
//
function AddTransportRed() {
  if(!validateMandatory(AddForm)) {
    return;
  }
  hv = document.hiddenvalues;
  if(!isWhitespace(hv.obadate.value) &&
     !isWhitespace(hv.obatime.value)) {
     if(document.AddForm.pmtsp004.value != hv.obadate.value ||
        document.AddForm.pmtsp005.value.substr(0,5) != 
        hv.obatime.value.substr(0,5)) {
        if(!confirm("Warning - Transport date/time is not equal to the " +
                    "appointment date/time.\n" +
                    "Click Ok to Continue, Cancel to abort")) {
          return;
        }
     }
  }
  if(document.AddForm.trnsflag.value!="0") {
    AddForm.redirect.value="outweb02.pbl?reportno=03&template=013" +
                 "&admissno=" + AddForm.pmtsp002.value.replace(/ /g,"+") +
                 "&waitflag=" + AddForm.waitflag.value.replace(/ /g,"+");
    AddForm.nextpage.value="1";
    parent.document.getElementById('PopUpScreen').style.width=700;
    parent.document.getElementById('PopUpScreen').style.height=400;
    Left=(parent.document.body.clientWidth-700)/2;
    parent.document.getElementById('PopUpScreen').style.left=Left;
  }
  AddTransport();
}
function CheckSeries() {
  if(document.AddForm.trnsflag.value=="2") {
    if(!confirm("Warning - This is a series booking.\n" +
            "Click OK to continue, CANCEL to exit")) {
            LinkDFrameExit()
   
    } 
    document.AddForm.pmtsp004.className="Readonly";
    document.AddForm.pmtsp004.readOnly=true;
    document.AddForm.pmtsp005.className="Readonly";
    document.AddForm.pmtsp005.readOnly=true;
    InsertBookAll.style.display="";
  } else if(document.AddForm.isseries.value=="2") {
    if(!confirm("Warning - This is a series booking.\n" +
            "Click OK to continue, CANCEL to exit")) {
             LinkDFrameExit()
    } else {
      InsertBookAll.style.display="";
    } 
  } else if(document.AddForm.isseries.value=="1") {
     if(!confirm("Warning - This is a series booking.\n" +
        "Click OK to continue, CANCEL to exit")) {
        LinkDFrameExit();
    }
  }
}
</script>
%START.OF.PAGE
</HEAD>
<body onload="PageLoad(event);CheckSeries();InitPostCodes();PickSelf();
      ReturnSelf();MandContractor();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="LinkDFrameExit();">
Add Transport Details - Visit %PATWEB10.04.081 - %PATWEB10.04.212.1
</span>
<div id=PageBodySection style="overflow: auto;">

<form name=AddForm method=post action=patweb10.pbl style="margin:0"
  onsubmit='return validateMandatory(this);'>
<input type=hidden name=reportno value="4">
<input type=hidden name=template value="003">
<input type=hidden name=updttype value="A">
<input type=hidden name=admissno value="%PATWEB10.04.081">
<input type=hidden name=urnumber value="%PATWEB10.04.003">
<input type=hidden name=pmtsp001 value="%PATWEB10.04.003">
<input type=hidden name=pmtsp002 value="%PATWEB10.04.081">
<input type=hidden name=pmtsp026 value="">
<input type=hidden name=pmtsp040 value="">
<input type=hidden name=pmtsp046 value="">
<input type=hidden name=pmtsp048 value="">
<input type=hidden name=pmtsp056 value="">
<input type=hidden name=trnsflag value="%PATWEB10.04.210">
<input type=hidden name=waitflag value="%PATWEB10.04.211">
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value="0">
<input type=hidden name=isseries value="%PATWEB10.04.212.2">

<table align=center cellspacing=0 cellpadding=0 width=100% border=1>
<tr><td class=HeadingCell align=center>Pick Up Address</td>
    <td class=HeadingCell align=center>Return Address</td></tr>

<tr><td>
    <table border=0 width=100% cellspacing=0>
    <tr><td class=DataLabel>Address</td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp006 tabindex=1
             value="%PATWEB10.04.106" onchange="UpCase(this);MandContractor();">
         </td>
        <td class=DataLabel>Private Ph</td>
        <td><input type="text" size=15 maxlength=20 name=pmtsp011 tabindex=7
             value="%PATWEB10.04.111"></td></tr>

    <tr><td class=DataLabel></td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp007 tabindex=2
            value="%PATWEB10.04.107" onchange="UpCase(this);MandContractor();">
        </td>
        <td class=DataLabel>Work Ph</td>
        <td><input type="text" size=15 maxlength=20 name=pmtsp012 tabindex=8
             value="%PATWEB10.04.112"></td></tr>

    <tr><td class=DataLabel>Suburb</td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp008 tabindex=3
             value="%PATWEB10.04.108" onchange="UpCase(this);MandContractor();"
             onblur="SetFields1();"></td>
        <td>Mobile</td>
        <td><input type="text" size=15 maxlength=20 name=pmtsp013 tabindex=9
             value="%PATWEB10.04.113"></td></tr>

    <tr><td class=DataLabel>State</td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp009 tabindex=4
             value="%PATWEB10.04.109" onchange="MandContractor();">
        <td>Melway</td>
        <td><input type="text" size=15 maxlength=20 name=pmtsp015 tabindex=10
             value="%PATWEB10.04.115"></td></tr>
    <tr><td>Post Code</td>
        <td><input type="text" size=4 maxlength=8 name=pmtsp010 tabindex=5
             value="%PATWEB10.04.110" onchange="MandContractor();"></td>
        <td></td></tr>

    <tr><td colspan=4 align=right>
        <input type=button class="button" value="Alternate" tabindex=11
         onclick="PickAlt();MandContractor();">
        <input type=button class="button" value="Clear" tabindex=12
         onclick="PickClear();MandContractor();">
        <input type=button class="button" value="Default" tabindex=13
         onclick="PickSelf();MandContractor();">
    </td></tr>

    <tr><td class=DataLabel>Run Number</td>
        <td><input type=text size=5 name=pmtsp051 maxlength=3
          title="Run Number(Pick Up)"
          tabindex=16 value="%PATWEB10.04.151"></td>
        <td>Contractor</td>
        <td><select name=pmtsp038 tabindex=17 title="Contractor (Pick Up)">
            <option></option>
            %PATWEB10.04.342.2
            </select></td></tr>

    <tr><td class=DataLabel>Transport Booked</td>
        <td><input type=checkbox name=d_pmtsp040 tabindex=18></td>
        <td></td>
        <td></td></tr>

    <tr><td class=DataLabel>Transport Date</td>
         <td colspan=3><input type=text size=12 name=pmtsp004 tabindex=19
             class="Mandatory Date" title="Transport Date"
             value="%PATWEB10.04.304">
         <img notab src=../images/DateLookup.gif class="Icon"
          onclick="DateLookupFrame(AddForm.pmtsp004);">
          Time
      <input class=Mandatory type=text name=pmtsp005 size=8 tabindex=20
          value="%PATWEB10.04.316" title="Transport Time">
       <img notab src=../images/DateTimeStamp.gif class="Icon"
          onclick="SetCurrentDateTime(AddForm.pmtsp004,AddForm.pmtsp005);">
       <img notab src=../images/TimeLookup.gif class="Icon"
        onclick="TimeLookupFrame(AddForm.pmtsp005);">
          </td>
    </tr>

    </table></td>

    <td>
    <table border=0 width=100% cellspacing=0>
    <tr><td class=DataLabel>Address</td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp016 tabindex=25
             value="%PATWEB10.04.116" onchange="UpCase(this);MandContractor();">
        </td>
        <td class=DataLabel>Private Ph</td>
        <td><input type="text" size=15 maxlength=20 name=pmtsp021 tabindex=30
             value="%PATWEB10.04.121"></td></tr>

    <tr><td class=DataLabel></td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp017 tabindex=26
             value="%PATWEB10.04.117" onchange="UpCase(this);MandContractor();">
        </td>
        <td class=DataLabel>Work Ph</td>
        <td><input type="text" size=15 maxlength=20 name=pmtsp022 tabindex=31
             value="%PATWEB10.04.122"></td></tr>

    <tr><td class=DataLabel>Suburb</td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp018 tabindex=27
             value="%PATWEB10.04.118" onchange="UpCase(this);MandContractor();"
             onblur="SetFields2();"></td>
        <td>Mobile</td>
        <td><input type="text" size=15 maxlength=20 name=pmtsp023 tabindex=32
             value="%PATWEB10.04.123"></td></tr>

    <tr><td class=DataLabel>State</td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp019 tabindex=28
             value="%PATWEB10.04.119" onchange="MandContractor();">
        </td>
        <td>Melway</td>
        <td><input type="text" size=15 maxlength=20 name=pmtsp025 tabindex=33
             value="%PATWEB10.04.125"></td></tr>

    <tr><td>Post Code</td>
        <td><input type="text" size=4 maxlength=8 name=pmtsp020 tabindex=29
             value="%PATWEB10.04.120" onchange="MandContractor();"></td>
        <td>Same as Pick Up</td>
        <td><input type=checkbox name=d_pmtsp026 value="1" tabindex=34
             onclick="SamePick();"></td></tr>

    <tr><td colspan=4 align=right>
        <input type=button class="button" value="Alternate" tabindex=35
         name=returnalt onclick="ReturnAlt();MandContractor();">
        <input type=button class="button" name=returnbut tabindex=36
         value="Clear" onclick="ReturnClear();MandContractor();">
        <input type=button class="button" name=returndef tabindex=37
         value="Default" onclick="ReturnSelf();MandContractor();">
    </td></tr>

   <tr><td class=DataLabel>Run Number</td>
    <td><input type=text size=5 name=pmtsp052 maxlength=3
          title="Run Number (Return)"
          tabindex=38 value="%PATWEB10.04.158"></td>
        <td>Contractor</td>
        <td><select name=pmtsp053 tabindex=39 title="Contractor (Return)">
            <option></option>
            %PATWEB10.04.342.2
            </select></td>
        </tr>

    <tr><td class=DataLabel>Transport Booked</td>
        <td><input type=checkbox name=d_pmtsp056 tabindex=40></td>
        </tr>

    <tr><td class=DataLabel>Transport Date</td>
        <td colspan=3><input type=text size=12 name=pmtsp054 tabindex=41
             class="Mandatory Date" title="Transport Date"
             value="%PATWEB10.04.304">
        <img notab src=../images/DateLookup.gif class="Icon"
         onclick="DateLookupFrame(AddForm.pmtsp054);">
        Time
       <input class=Mandatory type=text name=pmtsp055 size=8 tabindex=42
          value="%PATWEB10.04.316" title="Transport Time">
       <img notab src=../images/DateTimeStamp.gif class="Icon"
          onclick="SetCurrentDateTime(AddForm.pmtsp054,AddForm.pmtsp055);">
       <img notab src=../images/TimeLookup.gif class="Icon"
        onclick="TimeLookupFrame(AddForm.pmtsp055);">
          </td>
        </tr>
    </table>
</td></tr>

<tr><td class=HeadingCell align=center colspan=2>Destination Address</td>
    </tr>
</table>

<table align=center cellspacing=0 cellpadding=0 width=100% border=0>
<tr><td class=DataLabel>Facility</td>
    <td><select name=pmtsp037 tabindex=43
        onchange="setDefaultAddress(AddForm.pmtsp037,AddForm.pmtsp027,
                  AddForm.pmtsp028,AddForm.pmtsp029,
                  AddForm.pmtsp030,AddForm.pmtsp031);">
        <option></option>
        %PATWEB10.04.137.2
        </select></td>
    <td class=DataLabel>Pension Number</td>
    <td><input type=text notab class=Readonly readonly
         value="%PATWEB10.04.028"></td>
    <td class=DataLabel>Mobility</td>
    <td><select name=pmtsp039 tabindex=54 title="Mobility" class="Mandatory">
        <option></option>
        %PATWEB10.04.139.4
        </select></td>
    </tr>

<tr><td class=DataLabel>Address</td>
    <td><input type="text" size=33 maxlength=35 name=pmtsp027 tabindex=44
         value="%PATWEB10.04.127" onchange="UpCase(this);"></td>
    <td class=DataLabel>%STANDARD.01.017.CL</td>
    <td><select name=pmtsp045 tabindex=50 title="%STANDARD.01.017.CL"
         class="Mandatory">
        <option></option>
        %PATWEB10.04.321.9.1.10.2.X
        </select></td>
    <td class=DataLabel>Aids</td>
    <td><select name=pmtsp041 tabindex=55>
        <option></option>
        %PATWEB10.04.141.9.1.10.2.X
        </select></td>
    </tr>

<tr><td class=DataLabel></td>
    <td><input type="text" size=33 maxlength=35 name=pmtsp028 tabindex=45
         value="%PATWEB10.04.128" onchange="UpCase(this);"></td>
    <td class=DataLabel>Cost Centre</td>
    <td><input type=text name=pmtsp044 size=12 maxlength=10
         title="Cost Centre"
         value="%PATWEB10.04.144" tabindex=51></td>
    <td class=DataLabel>Special Arrangements</td>
    <td><select name=pmtsp043 tabindex=56>
        <option></option>
        %PATWEB10.04.378.2
        </select></td>
    </tr>

<tr><td class=DataLabel>Suburb</td>
    <td><input type="text" size=33 maxlength=35 name=pmtsp029 tabindex=46
         value="%PATWEB10.04.129" onchange="UpCase(this);"
         onblur="SetFields3();"></td>
    <td class=DataLabel>M40 Card Holder</td>
    <td><input type=checkbox tabindex=52 name=d_pmtsp048 onclick="CheckM40();">
         <input type=text size=22 name=pmtsp049 maxlength=20
          title="M40"
          class=Readonly readonly value="%PATWEB10.04.149"></td>
    <td class=DataLabel>Cognitive State</td>
    <td><select name=pmtsp042 tabindex=57>
        <option></option>
        %PATWEB10.04.142.2
        </select></td>
    </tr>

<tr><td class=DataLabel>State</td>
    <td><input type="text" size=33 maxlength=35 name=pmtsp030 tabindex=47
         value="%PATWEB10.04.130"></td>
   <td class=DataLabel>Ambulance Subscriber</td>
    <td><input type=checkbox tabindex=53 name=d_pmtsp046 onclick="CheckAmb();">
         <input type=text size=12 name=pmtsp047 maxlength=10
          title="Ambulance"
          class=Readonly readonly value="%PATWEB10.04.147"></td>
    <td class=DataLabel>&nbsp;</td>
    <td>&nbsp;</td>
    </tr>

<tr><td>Post code</td>
    <td><input type="text" size=4 maxlength=8 name=pmtsp031 tabindex=48
         value="%PATWEB10.04.131"></td>
    <td class=DataLabel>&nbsp;</td>
    <td>&nbsp;</td>
    <td class=DataLabel>&nbsp;</td>
    <td>&nbsp;</td>
    </tr>

<tr><td class=HeadingCell align=center colspan=6>Pickup Comments</td>
    </tr>

<tr><td class=DataLabel align=center colspan=6>
    <textarea name=transcom wrap=hard cols=60 
     rows=2 tabindex=68></textarea>
</td></tr>

<tr><td class=HeadingCell align=center colspan=6>Return Comments</td>
    </tr>

<tr><td class=DataLabel align=center colspan=6>
    <textarea name=rettscom wrap=hard cols=60
     rows=2 tabindex=69></textarea>
</td></tr>

<tr><td colspan=6 align=center><br>
    <input type=button value=Add class="button"  tabindex=71
     onclick="AddTransportRed();">

    <span id=InsertBookAll style="display: none">
    <input type=button value="Book All" class="button"  tabindex=72
     onclick="BookAllTransport();">
    </span>

    <input type=button value=Close class="button" tabindex=73 
     onclick="LinkDFrameExit();">
    </td></tr>
    
</table>
</form>
</div>

<form name=hiddenvalues>
<input type=hidden name=padd1 value="%PATWEB10.04.012">
<input type=hidden name=padd2 value="%PATWEB10.04.013">
<input type=hidden name=padd3 value="%PATWEB10.04.014">
<input type=hidden name=padd4 value="%PATWEB10.04.015">
<input type=hidden name=ppost value="%PATWEB10.04.016">
<input type=hidden name=ptelep value="%PATWEB10.04.017">
<input type=hidden name=pteleb value="%PATWEB10.04.018">
<input type=hidden name=ptelem value="%PATWEB10.04.085.043">
<input type=hidden name=altpadd1 value="%PATWEB10.04.406">
<input type=hidden name=altpadd2 value="%PATWEB10.04.407">
<input type=hidden name=altpadd3 value="%PATWEB10.04.408">
<input type=hidden name=altpadd4 value="%PATWEB10.04.409">
<input type=hidden name=altppost value="%PATWEB10.04.410">
<input type=hidden name=obadate value="%PATWEB10.04.304">
<input type=hidden name=obatime value="%PATWEB10.04.316">
</form>

<script type="text/javascript">
 PickUp="%PATWEB10.04.126"
 if(PickUp == "1") {
   document.AddForm.d_pmtsp026.checked=true;
 }
 Booked="%PATWEB10.04.140"
 if(Booked == "1") {
   document.AddForm.d_pmtsp040.checked=true;
 }
 Amb="%PATWEB10.04.146"
 if(Amb == "1") {
   document.AddForm.d_pmtsp046.checked=true;
   document.AddForm.pmtsp047.readonly=false;
   document.AddForm.pmtsp047.className="mandatory";
 }
 M40="%PATWEB10.04.148"
 if(M40 == "1") {
   document.AddForm.d_pmtsp048.checked=true;
   document.AddForm.pmtsp049.readonly=false;
   document.AddForm.pmtsp049.className="mandatory";
 }
</script>
