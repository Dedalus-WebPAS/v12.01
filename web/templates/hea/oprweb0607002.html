<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="hea">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb06.js"></script>
<script type="text/javascript">
function Add(finished) {
 if (document.AddForm.opcnsivb.value == 1) {
    document.AddForm.oppim010.value=document.AddForm.opthi012.value;
    if(document.AddForm.d_oppim011.checked==false) {
       document.AddForm.oppim011.value="0";
    } else {
       document.AddForm.oppim011.value="1";
    }
    document.AddForm.oppim001.value=document.AddForm.eannumbr.value;
 } else {
    document.AddForm.oppim001.value=document.AddForm.opthi001.value;
 }
 if (document.AddForm.ptcnpros.value == 1) {
    document.AddForm.opdea043.value=document.AddForm.d_opdea043.value;
 }
    if(finished=="A") {
      SubmitFormNew();
    } else {
      SubmitForm();
    }
}

function RoundOff(field){
   if(isNaN(field.value)){
     alert(field.title+" must be numeric");
     field.select();
   } 
   else{
     field.value=Math.round(field.value*100)/100;
   }
}
function ChkReas() {
  if (document.AddForm.d_oppim011.checked==true) {
    document.AddForm.oppim012.disabled=false;
    document.getElementById('oppim012').className="Mandatory";
  } else {
    document.AddForm.oppim012.value="";
    document.AddForm.oppim012.disabled=true;
    document.getElementById('oppim012').className="";
  }
}
function clrDetails() {
   clrFields(AddForm.opthi012,AddForm.opthi002,AddForm.opthi003);
   clrFields(AddForm.opthi007,AddForm.opthi005,AddForm.opthi008);
   clrFields(AddForm.opthi006,AddForm.opthi004,AddForm.eannumbr);

   AddForm.opthi012.readOnly=false;
   AddForm.opthi012.className="Mandatory";
   AddForm.opthi002.readOnly=false;
   AddForm.opthi002.className="Mandatory";
   AddForm.opthi003.disabled=false;
   AddForm.opthi004.disabled=false;
   AddForm.miscbutt.disabled=false;
   AddForm.opthi005.readOnly=false;
   AddForm.opthi005.className="";
   AddForm.opthi006.readOnly=false;
   AddForm.opthi006.className="";
   AddForm.opthi007.readOnly=false;
   AddForm.opthi007.className="";
   AddForm.opthi008.readOnly=false;
   AddForm.opthi008.className="";
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img border=0 align=right src=../images/ExitIcon.gif onclick=DFrameExit()
 class="MenuIcon" alt="Exit">
Patient Implant Maintenance
</span>

<form name=AddForm action="oprweb06.pbl" method=post style="margin:0"
 onSubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value=7>
<input type=hidden name=updatety value="A">
<input type=hidden name=oppim001 >
<input type=hidden name=oppim010 >
<input type=hidden name=oppim011 >
<input type=hidden name=dummy >
<input type=hidden name=admissno value="%OPRWEB06.07.081">
<input type=hidden name=multhosp value="%OPRWEB06.07.398.013.1">
<input type=hidden name=casekeys value='%OPRWEB06.07.101'>
<input type=hidden name=uniqueky value='%OPRWEB06.07.110'>
<input type=hidden name=teamnumb value='%OPRWEB06.07.206'>
<input type=hidden name=ptcnpros value="%STANDARD.01.025.118.115.0.1">
<input type=hidden name=opcnsivb value="%STANDARD.01.025.113.048.0.1">
<input type=hidden name=opdea043 value="%OPRWEB06.07.174">
<input type=hidden name=eannumbr value="">

<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td class=DataLabel><div id=UseBarcode1></div></td>
    <td><div id=UseBarcode2></div></td>
    <td class=DataLabel>Description</td>
    <td class=DataField>
    <input type=text size=65 class=Mandatory title="Description" 
     name="opthi002" maxlength=60> </td></tr>

<tr><td class=DataLabel>Type of Implant</td>
    <td class=DataField>
        <select name="opthi003" title="Type of Implant">
        <option ></option>
         %OPRWEB06.07.214.2
        </select></td>
    <td class=DataLabel>Size</td>
    <td class=DataField><input type=text size=12 name="opthi006" title="Size"
         maxlength=10></td></tr>
<tr><td class=DataLabel>Supplier</td>
    <td class=DataField><input type=text size=32 name="opthi007" maxlength=30
         title="Supplier"></td>
    <td class=DataLabel>Manufacture</td>
    <td class=DataField><input type=text size=65 name="opthi005" maxlength=60
        title="Manufacture"></td></tr>
<tr><td class=DataLabel>Cost</td>
    <td class=DataField><input type=text size=16 name="opthi008" maxlength=15
        title="Cost" min=0 max=999999999999.99
        onblur="RoundOff(this);"></td>
     <td class=DataLabel>Misc.Charge Code</td>
     <td class=DataField><input type=text size=10 name="opthi004" 
        title="Misc.Charge Code" maxlength=9 
        onblur="validateMisc(AddForm.opthi004,AddForm.dummy,AddForm.multhosp);">
     <img src=../images/SearchIcon.gif class=Icon name=miscbutt
      onclick="DefMiscChargeSearchFrame(AddForm.opthi004,AddForm.dummy,
                                     AddForm.multhosp);"></td></tr>
<tr><td></td>
    <td></td>
    <td class=DataLabel>Reference Number</td>
    <td class=DataField><input type=text size=15 name="dtrre001" 
        title="Reference Number" maxlength=12></td></tr>
</table>

<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td cellspacing=0 cellpadding=2 colspan=4><hr></td></tr>
<tr><td class=DataLabel width=20%>Team</td>
    <td class=DataField width=25%> %OPRWEB06.07.206 </td>
    <td width=25%>&nbsp</td>
    <td>&nbsp</td></tr>

<tr><td class=DataLabel>Quantity</td>
    <td class=DataField><input type=text size=3 name="oppim002" align=left 
        title="Quantity" value="1" maxlength=3  min=1 class=Mandatory
        onblur="checkInteger(this,this.title);"></td>
    <td class=DataLabel><div id=ProComp1></div></td>
    <td><div id=ProComp2></div></td></tr>

<tr><td class=DataLabel>Lot/Serial No</td>
    <td class=DataField><input type=text size=25 name="oppim003" 
        title="Lot/Serial No" maxlength=20></td></tr>

<tr><td class=DataLabel>Location</td>
    <td class=DataField><select name="oppim005" title="Location">
        <option></option>
          %OPRWEB06.07.212.2
        </select></td></tr>

<tr><td class=DataLabel>Not Used</td>
    <td class=DataField><input type=checkbox name=d_oppim011 value=1 
        title="Not Used"
        onblur="ChkReas();"></td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.oE</td>
    <td><select name=oppim012 disabled>
        <option> </option>
         %OPRWEB06.07.228.2
        </select></td></tr>
</table>

<table align=center cellspacing=0 cellpadding=3 border=0 width=100%>
<tr><td colspan=2 align=center>
        <input type=button Value="Add" id="opr06sub" class="button" 
        onclick="tempDisable(this);Add('A');">
        <input type=button Value="Finish" id="opr06sub2" class="button" 
        onclick="tempDisable(this);Add('F');">
        <input type=button Value="Close" class="button" 
        onclick="DFrameCloseRefresh();"></td></tr>
</table>
</form>

<span id=EANDesc style="display:none">
    EAN Number
</span>

<span id=EANField style="display:none">
    <input type=text size=18 name="opthi001" class=Mandatory
     title="EAN Number" maxlength=15 onblur=CheckEAN(AddForm)>
    <img src=../images/SearchIcon.gif class=Icon
     onclick="ImplantSearchFrame(AddForm.opthi001,AddForm.opthi002,'11');">
</span>

<span id=BarcodeDesc style="display:none">
    Barcode
</span>

<span id=BarcodeField style="display:none">
    <input type=text size=60 name="opthi012" class=Mandatory
     title="Barcode" maxlength=60 onblur=CheckBarcode(AddForm)>
    <img src=../images/SearchIcon.gif class=Icon
     onclick="ImplantSearchFrameBar(AddForm.eannumbr,AddForm.opthi012,'11');">
    <img src="../images/erase.gif" align=absmiddle name=barcodeerase
     onclick="clrDetails()">
</span>

<span id=ProsCompDesc style="display:none">
    Prosthetic Input Complete
</span>

<span id=ProsCompField style="display:none">
    <select name=d_opdea043 class="Mandatory" title="Prosthetic Input Complete">
     <option></option>
     <option value="0">No</option>
     <option value="1">Yes</option>
     <option value="2">N/A</option>
     </select>
</span>
<span id=Blank style="display:none">
  <input type=hidden name=opdea043 value="0">
</span>


<script type="text/javascript">
 if (document.AddForm.ptcnpros.value == 1) {
   ProComp1.innerHTML = ProsCompDesc.innerHTML;
   ProComp2.innerHTML = ProsCompField.innerHTML;
   for (var i =0 ; i < document.AddForm.d_opdea043.length; i++) {
    if (trim(document.AddForm.d_opdea043.options[i].value)==
        trim(document.AddForm.opdea043.value)){
        document.AddForm.d_opdea043.selectedIndex=i } };
 } else {
   ProComp1.innerHTML = Blank.innerHTML;
   ProComp2.innerHTML = "";
 }

 if (document.AddForm.opcnsivb.value == 1) {
   UseBarcode1.innerHTML = BarcodeDesc.innerHTML;
   UseBarcode2.innerHTML = BarcodeField.innerHTML;
 } else {
   UseBarcode1.innerHTML = EANDesc.innerHTML;
   UseBarcode2.innerHTML = EANField.innerHTML;
 }

 UsedImp="%OPRWEB06.07.227"
 if(UsedImp == "1") {
   document.AddForm.d_oppim011.checked=1;
 }

 for (var i=0;i<document.AddForm.oppim012.length;i++){
 if (document.AddForm.oppim012.options[i].value=="%OPRWEB06.07.228.1"){
     document.AddForm.oppim012.selectedIndex=i}};

</script>


