<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="hea">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
function UpdateCondition(urnumber,admissno) {
  linkurl="patweb93.pbl?reportno=5&template=001" +
          "&urnumber=" + urnumber + "&admissno=" + admissno
  Width=1000;
  Height=800;
  Left=(document.body.clientWidth-Width)/2;
  DFrameLink(linkurl,50,Left,Width,Height);
}
function TickPrintAll() {
  var c = new Array();
  c = document.getElementsByTagName('INPUT');

  for (var i = 0; i < c.length; i++) {
    if (c[i].type == 'checkbox') {
      if (c[i].name.substring(0,5) == 'prt00') {
        if (document.SelectPeriod.printall.checked==true) {
          c[i].checked=true;
        } else {
          c[i].checked=false;
        }
      }
    }
  }
}
function NotPrintAll() {
  document.SelectPeriod.printall.checked=false;
}
function GoProcess() {
  var printstat = ChkPrtBox();

  if (printstat==true) {
    var serverURL = "../cgi-bin/patweb62.pbl?reportno=4" +
                    "&progname=PATWEB71" +
                    "&reptnumb=19" +
          "&prntcode=" + document.SelectPeriod.selprint.value.replace(/ /g,"+");

    if (IEBrowser) {
      var returnValue = RSExecute(serverURL);

      if (returnValue.status==0) {
        SubmitPrintJobs();
      }
    }
    else {
      var returnValue = RSExecuteFetch(serverURL);

      returnValue.then(
        function (returnValue) {
          returnValue = ParseFetchData(returnValue);  // parse fetch() result

          if (returnValue.status==0) {
            SubmitPrintJobs();
          }
        }
      );
    }
  }
}
function SubmitPrintJobs() {
  var c = new Array();
  c = document.getElementsByTagName('INPUT');

  for (var i = 0; i < c.length; i++) {
    if (c[i].type == 'checkbox') {
      if (c[i].name.substring(0,5) == 'prt00') {
        y=(c[i].name);
        x= 'adm00' + c[i].name.substring(5,8);

        if (c[i].checked==true) {
          AddField(y,1);
          AddField(x,c[i].value);
        } else {
          AddField(y,0);
          AddField(x,c[i].value);
        }
      }
    }
  }

  document.PrintForm.selprint.value=document.SelectPeriod.selprint.value;
  SubmitHidden(PrintForm);
}
function ChkPrtBox() {
  var c = new Array();
  c = document.getElementsByTagName('INPUT');
  for (var i = 0; i < c.length; i++) {

   if (c[i].type == 'checkbox') {
    if (c[i].name.substring(0,5) == 'prt00' && c[i].checked==true) {
        return true;
    }
   }
  }
  alert('No Patient selected.');
  return false;
}
function AddField(a,b) {
  var the_field;
  var billingForm = document.getElementById('PrintForm');

  the_field = document.createElement('INPUT');
  the_field.setAttribute('type','hidden');
  the_field.setAttribute('name',a);
  the_field.id = a;
  the_field.setAttribute('value',b);
  the_field.value = b;
  billingForm.appendChild(the_field);
}
function CheckPrint() {
  f = document.SelectPeriod;

  document.getElementById('BillStat').innerHTML = "";
  document.getElementById('ExpDischarge').innerHTML
    = document.getElementById('hideExpDischarge').innerHTML;

  if (f.deftview.value == "1") {
    document.getElementById('BillStat').innerHTML
      = document.getElementById('PrtBillStat').innerHTML;
  }
  else {
    if (f.deftview.value == "2") {
      document.getElementById('ExpDischarge').innerHTML
        = document.getElementById('showExpDischarge').innerHTML;
      if (f.showflag.value == 0) {
        f.d_filtexdy.checked = false;
      }
      else {
        if (f.filtexdy.value == 1) {
          f.d_filtexdy.checked = true;
        }
        else {
          f.d_filtexdy.checked = false;
        }
      }
    }
  }
}
function ShowUpdateCatVI(urno,admno) {
  linkurl = "../cgi-bin/patweb93.pbl?reportno=21&template=001" +
            "&admissno=" + admno +
            "&urnumber=" + urno;
  Left=(document.body.clientWidth-560)/2;
  DFrameLink(linkurl,100,Left,560,250);
}
function openDocument(urno,admno) {
  LinkUrl="cliweb08.pbl?reportno=1&template=048&urnumber="+urno+"&admissno="+admno;
  Left=(document.body.clientWidth-810)/2
  DFrameLink(LinkUrl,0,Left,1000,550)
}
function ResubmitForm() {
  f = document.SelectPeriod;

  if (f.deftview.value == 2) {
    if (f.d_filtexdy.checked==false){
      f.filtexdy.value = "0";
    }
    else {
      f.filtexdy.value = "1";
    }
  }
  else {
//    f.filtexpd.selectedIndex = -1;
//    f.filtexdy.value = "0";
  }

  SelectPeriod.submit();
}
function FirstTimeSetup() {
  f = document.SelectPeriod;
  if (f.deftview.value == 2) {
    if (f.showflag.value == 0) {
      f.d_filtexdy.checked = true;
      f.showflag.value = 1;
      ResubmitForm();   
    }
    else {
      if (f.filtexdy.value == 1) {
        f.d_filtexdy.checked = true;
      }
      else {
        f.d_filtexdy.checked = false;
      }
    }     
  }
  else {
    if (f.d_filtexdy != undefined) {
      f.d_filtexdy.checked = false;
    }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="initTable(%PATWEB93.11.016);ShowTentativeCound();">
<div id=HeadingSection>
<form name=SelectPeriod action=patweb93.pbl method=get style="margin:0">
<input type=hidden name=reportno value=11>
<input type=hidden name=template value=1>
<input type=hidden name=viewtype id=viewtype value="%PATWEB93.11.011">
<input type=hidden name=deftview id=deftview value="%PATWEB93.11.016">
<input type=hidden name=filtexdy id=filtexdy value="%PATWEB93.11.021">
<input type=hidden name=showflag id=showflag value="%PATWEB93.11.019">
<input type=hidden name=nextpatn id=nextpatn value="">
<input type=hidden name=donotref id=donotref>

<table cellpadding=3 bgcolor=#CCCCCC border=0 width=100%>
<tr>
  <td>
    <img src="../images/TableViewIcon.gif" class=Icon
     alt="Default View" title="Default View"
     onclick="initTable(0);CheckPrint();">
    <img src="../images/TableViewIcon.gif" class=Icon
     alt="View 1" title="View 1" onclick="initTable(1);CheckPrint();">
    <img src="../images/TableViewIcon.gif" class=Icon
     alt="View 2" title="View 2" onclick="initTable(2);CheckPrint();">
  </td>
  <td class=DataLabel>Discharge Preparation Status&nbsp;&nbsp;
    <select name=filtdpst id=filtdpst class=SelectMed
     title="Discharge Preparation Status" onchange="ResubmitForm();" >
      <option value="">All</option>
      %PATWEB93.11.013.2
    </select>
  </td>
  <td class=DataLabel>Claim Code&nbsp;&nbsp;
    <select name=filtclai id=filtclai class=SelectMed
     title="Claim Code" onchange="ResubmitForm();">
      <option value="  ">ALL</option>
      %PATWEB93.11.014.2
    </select>
  </td>
  <td class=DataLabel>Ward&nbsp;&nbsp;
    <select name=wardcode id=wardcode class=SelectMed
     title="Ward" onchange="ResubmitForm();">
      <option value="  ">ALL</option>
      %PATWEB93.11.015
    </select>
  </td>

  <td class=DataLabel><div id=ExpDischarge></div></td>
  <td class=DataLabel><div id=BillStat></div></td>

  <td align=right>
    <input type=button value="<<" class=SmallButton
     onclick='location.href="%PATWEB93.11.002"'>
    %PATWEB93.11.007
    <input type=button value=">>" class=SmallButton
     onclick='location.href="%PATWEB93.11.001"'>
    <a href='javascript:SelectDateFrame();'>
    <img src="../images/DateLookup.gif" class=Icon 
     alt="Select Date" title="Select Date"></a>
    <a href='javascript:SelectView("0");'>
    <img src="../images/DayIcon.gif" class=Icon
     alt="View Today" title="View Today"></a>
    <a href='javascript:SelectView("1");'>
    <img src="../images/WeekIcon.gif" class=Icon 
     alt="View This Week" title="View This Week"></a>
    <a href='javascript:SelectView("2");'>
    <img src="../images/MonthIcon.gif" class=Icon 
     alt="View This Month" title="View This Month"></a>
  </td>
</tr>
</table>

<table cellpadding=1 cellspacing=1 border=0 width=100%>
<tr id=TentativeCount>
  <td class=HeadingCell width=80%>
  </td>
  <td class=HeadingCell>Tentative</td>
  <td class=HeadingCell width=10%>
    <input type=text name=tentacnt id=tentacnt readOnly size=6 value="">
  </td>
  <td class=HeadingCell>Confirmed</td>
  <td class=HeadingCell width=10%>
    <input type=text name=confmcnt id=confmcnt readOnly size=6 value="">
  </td>
</tr>
</table>

</form>
</div>

<div id=TableLocation></div>

<span id=PrtBillStat style="display:none">
  Select all to Print Billing Statement
  <input type=checkbox name=printall value="0" onclick="TickPrintAll();">
  &nbsp;&nbsp;&nbsp;Printer&nbsp;
  <select class="Mandatory" name="selprint" title="Printer">
   %STANDARD.01.001.PATWEB71.19
  </select>&nbsp;
  <input type=button value="Go" class=SlimButton onclick="GoProcess();">
</span>

<span>
  <input type=hidden name=selprint value="">
</span>

<span id=showExpDischarge style="display:none">
  Exp Discharge Destination&nbsp;
  <select name=filtexpd id=filtexpd class=SelectMed onchange="ResubmitForm();">
    <option value="  ">ALL</option>
    %PATWEB93.11.020.2
  </select>
  &nbsp;&nbsp;&nbsp;Exclude Day Only Wards
  <input type=checkbox name=d_filtexdy id=d_filtexdy
   value="1" title="Exclude Day Only Wards" onclick="ResubmitForm();">
</span>

<span id=hideExpDischarge style="display:none">
  <input type=hidden name=filtexpd value="">  
</span>

<script type="text/javascript">
function initTable(TableView) {
 document.title="Expected Discharges " 
 t = new Table(1,0,1,"100%","center",30,45);    // Create New Table Object
 template = 1

switch (TableView) {
case 0: {
  document.SelectPeriod.deftview.value="0";
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column,Align
//
 t.addColumn("Patient Name","ImageText",0,0,"left","PatientFolder","8",140,15)
 t.addColumn("U/R","String",10,10,"left","","",30)
 t.addColumn("Doctor","String",4,4,"left","","",90)
 t.addColumn("Ward/Bed","String",11,11,"left","","",30)
 t.addColumn("Diagnosis","String",3,3,"left","","",70)
 t.addColumn("Patient Condition","ImageText",13,13,"left","","12",90,14)
 t.addColumn("%STANDARD.01.017.U2","String",18,18,"left","","",55)
 t.addColumn("Discharge Preparation Status","String",17,17,"left","","",55)
 t.addColumn("Exp Disch.Date","DateTime",9,9,"left","","",80,"","","",16)
 AddTableRows()
 TableOutput(3,1);    // By Ward
 t.sortTable(2,1);    // By Doctor
 t.sortTable(6,1);    // By Date
 break; }

case 1: {
 document.SelectPeriod.deftview.value="1";
 t = new Table(1,0,1,"100%","center",30,45);    // Create New Table Object
 t.addColumn("Patient Name","ImageText",0,0,"left","PatientFolder","8",140,15)
 t.addColumn("Doctor","String",4,4,"left","","",90)
 t.addColumn("Ward/Bed","String",11,11,"left","","",50)
 t.addColumn("Diagnosis","String",3,3,"left","","",70)
 t.addColumn("Patient Condition","ImageText",13,13,"left","","12",90,14)
 t.addColumn("%STANDARD.01.017.U2","String",18,18,"left","","",40)
 t.addColumn("Discharge Preparation Status","String",17,17,"left","","",55)
 t.addColumn("Claim Code","String",19,19,"left","","",40)
 t.addColumn("Health Fund","String",20,20,"left","","",40)
 t.addColumn("Total OOP","String",21,21,"right","","",40)
 t.addColumn("Payment Received","String",22,22,"right","","",40)
 t.addColumn("Print Billing Statement","String",23,23,"center","","",50)
 t.addColumn("Exp Disch.Date","DateTime",9,9,"left","","",80,"","","",16)
 AddTableRows()
 TableOutput(2,1);    // By Ward
 t.sortTable(1,1);    // By Doctor
 t.sortTable(5,1);    // By Date
 break; }

case 2: {
 document.SelectPeriod.deftview.value="2";
 t = new Table(1,0,1,"100%","center",30,45); 
 t.addColumn("Patient Name","ImageText",0,0,"left","PatientFolder","8",120,15)
 t.addColumn("Doctor","String",4,4,"left","","",90)
 t.addColumn("Ward/Bed","String",11,11,"left","","",50)
 t.addColumn("Diagnosis","String",3,3,"left","","",70)
 t.addColumn("Patient Condition","ImageText",13,13,"left","","12",90,14)
 t.addColumn("Expected Destination","String",25,25,"left","","",70)
 t.addColumn("Document","ImageText",29,29,"left","historyreceived","28","50",27)
 t.addColumn("%STANDARD.01.035.U2","String",18,18,"","","",60)
 t.addColumn("%STANDARD.01.035.vi","String",26,26,"left","","",55)
 t.addColumn("Exp Disch.Date","String",24,24,"left","","",80)
 AddTableRows()
 TableOutput(2,1);    // By Ward
 t.sortTable(1,1);    // By Doctor
 t.sortTable(5,1);    // By Date
 break; }

 }
}

function AddTableRows() {
  %PATWEB93.11.008.patweb98.01.001
}
function ShowTentativeCound() {
  f = document.SelectPeriod;
  if (f.deftview.value == 2) {
    document.getElementById('TentativeCount').style.display = "";
    f.tentacnt.value = "%PATWEB93.11.022";
    f.confmcnt.value = "%PATWEB93.11.023"; 
  }
  else {
    document.getElementById('TentativeCount').style.display = "none";
  }
}
//

CheckPrint();

FirstTimeSetup();
</script>

<form name=PrintForm id=PrintForm method=post action=patweb71.pbl
 style="margin:0">
  <input type=hidden name=reportno value=19>
  <input type=hidden name=template value=036>
  <input type=hidden name=nextpage value="0">
  <input type=hidden name=admissno value="">
  <input type=hidden name=selprint value="">
 <input type=hidden name=redirect value="patweb93.pbl?reportno=11&template=001">
</form>
