<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="hea">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="RefreshTime" content="90">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/SmallTable.js"></script>
<script type="text/javascript" src="../js/EmergencyMapSetupHEAK.js"></script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<script type="text/javascript">
 InvalidEMRCode="0"
 EmrSiteCode="%EMRWEB01.01.039"
 PatientCellLine3="%STANDARD.01.025.089.225.0.1"
 var obj = new Map("paper.gif");
 immediate = 0
 emergency = 0
 urgent = 20
 semi = 50
 non = 110

<!-- Paste below from site file emrergencymap.txt-->

addLoc(obj,EmrSiteCode);

<!-- Paste above from site file emergencymap.txt -->
//
// Output Expected Patients
//
%EMRWEB01.01.043
//
//  Patients
//  Name, Location Code, U/R, Triage, Arrival, Time,Sex, Age, Complaint, Doctor
%EMRWEB01.01.006
//
// Output Map View
//
ShowMap(immediate,emergency,urgent,semi,non,EmrSiteCode,InvalidEMRCode);
//
// Output Hall of Shame
//
// t = new Table(1,0,1,"100%","center","Incomplete Patients")
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column,Align
//
// t.addColumn("Incomplete Patients","String",1,1,"left","EditIcon.gif","0",150)
// t.addColumn("Patients","String",2,2,"right","","",40)
//
// Add Rows to Table (Output from Web Server)
//
//EMRWEB01.01.032
// TableOutput(1,0)

// ****** HEALTHSCOPE KNOX ******

  if (EmrSiteCode=="KNX") {
    InvalidEMRCode="1";
    displaySystemComments(SystemComments,"Emergency Department Notices",
                          "%EMRWEB01.01.053","%EMRWEB01.01.031");

    displayEmergencyCount(EmergencyCount,"%EMRWEB01.01.007",
                          "%EMRWEB01.01.009","%EMRWEB01.01.010",
                          "%EMRWEB01.01.008");

    displayBlackHole(BlackHole,"1","SSWWardList()",
                     "SSW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
                     "%EMRWEB01.01.054.SSW");

    displayBlackHole(BlackHole1,"%EMRWEB01.01.045.IMG","OtherLocations('IMG')",
                     "Medical Imaging","%EMRWEB01.01.044.IMG");

    displayBlackHole(BlackHole2,"%EMRWEB01.01.045.ULT","OtherLocations('ULT')",
                     "Ultrasound&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
                     "%EMRWEB01.01.044.ULT");

    displayBlackHole(BlackHole3,"%EMRWEB01.01.045.CT ","OtherLocations('CT')",
                     "CT Scan&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
                     "%EMRWEB01.01.044.CT ");

    displayBlackHole(BlackHole4,"%EMRWEB01.01.045.MRI","OtherLocations('MRI')",
                     "MRI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
                     "%EMRWEB01.01.044.MRI");

    displayBlackHole(BlackHole5,"%EMRWEB01.01.045.OVR","OtherLocations('OVR')",
                     "Overflow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
                     "%EMRWEB01.01.044.OVR");

  }

// ****** HEALTHSCOPE NORWEST ******

  if (EmrSiteCode=="NOR") {
    InvalidEMRCode="1";
    displaySystemComments(SystemComments,"Emergency Department Notices",
                          "%EMRWEB01.01.053","%EMRWEB01.01.031");

    displayBlackHole(BlackHole,"%EMRWEB01.01.045.XRY","OtherLocations('XRY')",
                     "Radiology/Xray ","%EMRWEB01.01.044.XRY");

    displayEmergencyCount(EmergencyCount,"%EMRWEB01.01.007",
                          "%EMRWEB01.01.009","%EMRWEB01.01.010",
                          "%EMRWEB01.01.008");

  }

// ****** HEALTHSCOPE ALLAMANDA ******

  if (EmrSiteCode=="ALP") {
    InvalidEMRCode="1";
    displaySystemComments(SystemComments,"Emergency Department Notices",
                          "%EMRWEB01.01.053","%EMRWEB01.01.031");

    displayBlackHole(BlackHole,"%EMRWEB01.01.045.ULT","OtherLocations('ULT')",
                     "Ultrasound&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
                     "%EMRWEB01.01.044.ULT");

    displayBlackHole(BlackHole1,"%EMRWEB01.01.045.CT ","OtherLocations('CT')",
                     "CT Scan&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
                     "%EMRWEB01.01.044.CT ");

    displayBlackHole(BlackHole2,"%EMRWEB01.01.045.IMG","OtherLocations('IMG')",
                     "Medical Imaging","%EMRWEB01.01.044.IMG");

    displayBlackHole(BlackHole3,"%EMRWEB01.01.045.MRI","OtherLocations('MRI')",
                   "MRI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+
                   "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
                     "%EMRWEB01.01.044.MRI");

    displayBlackHole(BlackHole4,"%EMRWEB01.01.045.WCL","OtherLocations('WCL')",
                     "Ward Calls &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;","%EMRWEB01.01.044.WCL");

    displayEmergencyCount(EmergencyCount,"%EMRWEB01.01.007",
                          "%EMRWEB01.01.009","%EMRWEB01.01.010",
                          "%EMRWEB01.01.008");

  }

// ****** HEALTHSCOPE JOHN FAWKNER ******

  if (EmrSiteCode=="JFK") {
    InvalidEMRCode="1";
    displaySystemComments(SystemComments,"Emergency Department Notices",
                          "%EMRWEB01.01.053","%EMRWEB01.01.031");

    displayEmergencyCount(EmergencyCount,"%EMRWEB01.01.007",
                          "%EMRWEB01.01.009","%EMRWEB01.01.010",
                          "%EMRWEB01.01.008");
  }

// ****** HEALTHSCOPE HOBART ******

  if (EmrSiteCode=="HOB") {
    InvalidEMRCode="1";
    displaySystemComments(SystemComments,"Emergency Department Notices",
                          "%EMRWEB01.01.053","%EMRWEB01.01.031");

    displayBlackHole(BlackHole,"%EMRWEB01.01.045.IMG","OtherLocations('IMG')",
                     "Medical Imaging&nbsp;","%EMRWEB01.01.044.IMG");

    displayBlackHole(BlackHole1,"%EMRWEB01.01.045.ODP","OtherLocations('ODP')",
                     "Other Department","%EMRWEB01.01.044.ODP");

    displayBlackHole(BlackHole2,"1","SSWWardList()",
                    "SSW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
                     "%EMRWEB01.01.054.SSW");

    displayEmergencyCount(EmergencyCount,"%EMRWEB01.01.007",
                          "%EMRWEB01.01.009","%EMRWEB01.01.010",
                          "%EMRWEB01.01.008");

  }

// ****** HEALTHSCOPE ASH ******

  if (EmrSiteCode=="ASH") {
    InvalidEMRCode="1";
    displaySystemComments(SystemComments,"Emergency Department Notices",
                          "%EMRWEB01.01.053","%EMRWEB01.01.031");

    displayEmergencyCount(EmergencyCount,"%EMRWEB01.01.007",
                          "%EMRWEB01.01.009","%EMRWEB01.01.010",
                          "%EMRWEB01.01.008");

    displayBlackHoleASH(BlackHole,"1","SSWWardList()",
                     "Emergency Ward&nbsp;&nbsp;",
                     "%EMRWEB01.01.054.SSW");

    displayBlackHoleASH(BlackHole1,"%EMRWEB01.01.045.RGF","OtherLocations('RGF')",
                     "RAD Gnd Flr","%EMRWEB01.01.044.RGF");

    displayBlackHoleASH(BlackHole2,"%EMRWEB01.01.045.R1F","OtherLocations('R1F')",
                     "RAD 1st Flr&nbsp;&nbsp;","%EMRWEB01.01.044.R1F");

    displayBlackHoleASH(BlackHole3,"%EMRWEB01.01.045.ULT","OtherLocations('ULT')",
                     "Ultrasound&nbsp;&nbsp;&nbsp;&nbsp;",
                     "%EMRWEB01.01.044.ULT");

    displayBlackHoleASH(BlackHole4,"%EMRWEB01.01.045.CAT","OtherLocations('CAT')",
                     "CAT Scan&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
                     "%EMRWEB01.01.044.CAT");

    displayBlackHoleASH(BlackHole5,"%EMRWEB01.01.045.MRI","OtherLocations('MRI')",
                     "MRI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
                     "%EMRWEB01.01.044.MRI");

    displayBlackHoleASH(BlackHole6,"%EMRWEB01.01.045.SAH","OtherLocations('SAH')",
                     "SA Heart&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",
                     "%EMRWEB01.01.044.SAH");

  }

// ****** INVALID SITE CODE ******

  if (InvalidEMRCode=="0") {

    displayInvalidEMRCode();

  }

EmergencyMenu.innerHTML=parent.MenuList.innerHTML 

//NextEmergency.innerHTML=
//"<table border=1 cellpadding=2 width=250 height=110 cellspacing=0>" +
//"<tr height=28><td bgcolor=#ffff00 align=center><b>NEXT</b></td>" +
//"<td class=DataField nowrap bgcolor=#ffff00>%EMRWEB01.01.015</td></tr>" +
//"<tr height=28><td class=DataLabel>Location</td>" +
//"<td class=DataField>" + '%EMRWEB01.01.017' + "</td></tr>" +
//"<tr><td class=DataLabel>Doctor</td>" +
//"<td><input type=text size=6 maxlength=6 name=doctor " +
//"onblur='updDoc(this);'></td></tr>" +
//"</table>"

</script>

<script type="text/javascript">
function ShowPatientDetails(PatientNo) {
  if(!isWhitespace(obj.patients[PatientNo][4])) {
    PageLocation="?reportno=1&template=4" +
                 "&urnumber=" + obj.patients[PatientNo][0].replace(/ /g,"+") +
                 "&admissno=" + obj.patients[PatientNo][1].replace(/ /g,"+") 
  } else {
     PageLocation="?reportno=1&template=11" +
                  "&urnumber=" + obj.patients[PatientNo][0].replace(/ /g,"+") +
                  "&admissno=" + obj.patients[PatientNo][1].replace(/ /g,"+") 
  }
  globalLinkType=0;
  globalLinkUrl="../cgi-bin/emrweb02.pbl" + PageLocation
  top.content.location="../cgi-bin/emrweb02.pbl" + PageLocation
}
function SelectPatient(admissno) {
 url = "../cgi-bin/emrweb02.pbl?reportno=01&template=100" +
       "&admissno=" + admissno.replace(/ /g,"+") 
 parent.menu.EmergencyMenu.innerHTML=""
 EmergencyFrameLink(url,1,1,1004,525)
}
function updDoc(doctor) {
if(isWhitespace(doctor.value)){return;}
doctor=doctor.value.toUpperCase()
admissno='%EMRWEB01.01.021';
emcndoct='%EMRWEB01.01.040';
// validate doctor exists in patdo1af
  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=3" +
                    "&valdcode=" + doctor.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status!=0) {  return; }   

// validate doctor exists in emrdocaf
  if (emcndoct==1) {
    var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=11" +
                      "&valdcode=" + doctor.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) { return; }   
  }

  var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=3" +
                    "&admissno=" + admissno +
                    "&doctcode=" + doctor +
                    "&updttype=ALDOC" +
                    "&updateky=1"
  var returnValue = RSExecute(serverURL);

  if(top.content.location.search.substring(1,22)=="reportno=1&template=4"){
    admissno=admissno - 0
    if (top.content.PatientLinks.admissno.value == admissno) {
        top.content.location.reload();
    }
  }

  location.reload();
}
function SelectDoctor(doctcode) {
 if(top.content.location.search.substring(1,23)=="reportno=2&template=3"){
 if (IsDirtyTriage(top.content.UpdateForm)==true) { return; }} 
  var url = "../cgi-bin/emrweb01.pbl?" +
            "reportno=1&template=16" +
            "&doctcode=" + doctcode.replace(/ /g,"+")
 parent.content.location=url
}
function IsDirtyTriage(eForm) {
  for (var i=0; i < eForm.length; i++) {
    var eElem = eForm.elements[i];
    if ("text" == eElem.type || "textarea" == eElem.tagName)
    {
      if (eElem.value.replace(/ /g,"") != eElem.defaultValue.replace(/ /g,""))  {
      return true;}
    }
    else if ("checkbox" == eElem.type || "radio" == eElem.type)
    {
      if (eElem.checked != eElem.defaultChecked) return true;
    }
  }
  return false;
}
</script>
<form name=defPatientLink method=get>
<input type=hidden name=serverid value="emrweb02">
<input type=hidden name=reportno value="01">
<input type=hidden name=template value="100">
<input type=hidden name=nextseq value="%EMRWEB01.01.021">
<input type=hidden name=waiting> 
</form>
