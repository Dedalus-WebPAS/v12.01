<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nsw">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/preadmission.js"></script>
%START.OF.PAGE
<script type="text/javascript">
if("%STANDARD.01.025.119.182.0.1"=="1") { // Episoft ptcnepis
  var src="../js/eAdmissionReg.js";
} else {
  var src="../js/DefaultOnlineAdm.js";
}
var script = document.createElement("script");
             script.setAttribute("src", src);
             script.setAttribute("type", "text/javascript");
document.getElementsByTagName("head")[0].appendChild(script);
function SubmitAdm() {
    MandatoryOk=true;
    p=document.UpdateForm
    validateSuspension(p.urnumber,p.ptmis001,p.datefrom,p.dateto);
    if(p.datefrom.value!='0'){
      if(p.admitbox.value=="1"){
         document.UpdateForm.admitbox.value="0";
         ans=confirm("Warning : Patient has a Suspension record for period \n" +
               "\t" + p.datefrom.value  + " - " + p.dateto.value + "\n" +
               "\tPatient will not be admitted");
         }else{
         ans=confirm("Warning : Patient has a Suspension record for period \n" +
               "\t" + p.datefrom.value  + " - " + p.dateto.value);}
         if (ans!=true) {
            return;
         }
    }
    if (!validateMandatory(document.UpdateForm)) {
       return;
    }
    if (!isWhitespace(UpdateForm.ptmis013.value)) {
        if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
                       UpdateForm.funddesc,UpdateForm.tabldesc)) {
           ans=confirm("Select another active health fund table? ");
           if (ans==true) {
              return;
           } 
        } 
    }

  if (document.UpdateForm.mvmedre1.checked == true) {
    document.UpdateForm.mvmedrec.value="1";
  } else {
    document.UpdateForm.mvmedrec.value="0";
  }

  //TSK 0889961
  if(document.UpdateForm.admitbox.checked == true) {
    if(checkMultipleAdmission(UpdateForm)){
      return;
    }
  }

  if (MandatoryOk) {
    setRedirect();
    UpdateForm.ptmis004.value=UpdateForm.ptmis068.value;
    UpdateForm.ptmis005.value=UpdateForm.ptmis076.value;
    document.UpdateForm.ptvis115.value=document.UpdateForm.d_ptvis115.value;
    if(document.getElementById("ptcnepis").value == "1") {  // Episoft ptcnepis
      if (!isWhitespace(document.UpdateForm.admisnid.value)) {
        SetCookie("eAdmission",eAdmCookie);
      }
    }
    SubmitHidden(UpdateForm);
    }
}
function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
  selectOptions("30",UpdateForm.ptmis007,UpdateForm.ptmis024);
  UpdateForm.ptmis024.selectedIndex=1
}
function AdmitMandatory() {
 if(document.UpdateForm.admitbox.checked == true) {
     document.UpdateForm.admitbox.value="1";
     UpdateForm.ptmis011.className="Mandatory";  //admission type
     UpdateForm.ptmis009.className="Mandatory";  //admission source
     UpdateForm.ptvis041.className="Mandatory";  //criteria for admission
     UpdateForm.ptmis012.className="Mandatory";  //care type
     UpdateForm.ptmis068.className="Mandatory";  //ward
     UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor description
     UpdateForm.ptmis024.className="Mandatory";  //Unit
     UpdateForm.ptmis027.className="Mandatory";  //Financial Class
     UpdateForm.ptmis010.className="Mandatory";  //CMBS Class
     UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
//   UpdateForm.ptvis046.className="Mandatory";  //Admitting Point
  } else {
     document.UpdateForm.admitbox.value="0";
     UpdateForm.ptmis011.className="";  //admission type
     UpdateForm.ptmis009.className="";  //admission source
     UpdateForm.ptvis041.className="";  //criteria for admission
     UpdateForm.ptmis012.className="";  //care type
     UpdateForm.ptmis068.className="";  //ward
     UpdateForm.ptmis007.className="";  //Admitting Doctor
     UpdateForm.doctnam2.className="";  //Admitting Doctor description
     UpdateForm.ptmis024.className="";  //Unit
     UpdateForm.ptmis027.className="";  //Financial Class
     UpdateForm.ptmis010.className="";  //CMBS Class
     UpdateForm.ptvis043.className="";  //Intended Stay
//   UpdateForm.ptvis046.className="";  //Admitting Point
  }
  defaultMoveMedRec(document.UpdateForm.admitbox,document.UpdateForm.mvmedre1);
  UpdateForm.ptmis001.focus();
}
function valClaimCode() {
  validateCode(41,UpdateForm.urnumber,UpdateForm.claimc);
  for (var i =0 ; i < document.UpdateForm.ptmis027.length; i++) {
//    alert(UpdateForm.ptmis027.options[i].value.substr(0,3));
    if (document.UpdateForm.claimc.value==
        trim(document.UpdateForm.ptmis027.options[i].value.substr(0,3))){
          document.UpdateForm.ptmis027.selectedIndex=i;
    }
  }
}
function OnlinePreadmissionA() {
  if (isWhitespace(document.UpdateForm.admisnid.value)){
    return;
  }
  AdmissionID=GetCookieData("AdmissionID")
  if (!isWhitespace(AdmissionID)&&AdmissionID!="unknown") {
    DefaultOnlineAdm(AdmissionID);
    UpdateProcessedA(AdmissionID);
    SetCookie("AdmissionID","");
    checkInd=document.UpdateForm.ptmis027.value.substr(3,5);
    if (checkInd.search(/W/g) >= 0) return;
    if (checkInd.search(/M/g) >= 0) return;
    SetCookie("AdmissionID","");
  }
}
function UpdateProcessedA(AdmissionID) {
  UpdateForm.ptmis054.value=AdmissionID; /* User UK GP Fund Holder Field to Store */
  theURL="preadm01.php"+
         "?reportno=3" +
         "&status=3" +
         "&admissionid="+AdmissionID +
         "&urnumber="+PatientURN+
         "&admissno="+PatientVIS;
  xmlHttp = createHttpObject();
  xmlHttp.open("GET", theURL, false);
  xmlHttp.send();
  if (!isWhitespace(xmlHttp.responseText)) {
    alert(xmlHttp.responseText)
  }
  theURL="preadm01.php"+
         "?reportno=9" +
         "&SaveFile=Y" +
         "&admissionid="+AdmissionID;
  theURL="preadm01.php"+
         "?reportno=9" +
         "&SaveFile=Y" +
         "&admissionid="+AdmissionID;
  xmlHttp = createHttpObject();
  xmlHttp.open("GET", theURL, false);
  xmlHttp.send();
  if (xmlHttp.responseText.split(':')[0]=="FILE") {
    if (typeof eAdmDocTypeCode == 'undefined') {
      alert("ERROR:eAdmDocTypeCode has not been defined in Custom.js")
      eAdmDocTypeCode = "001";
    }
    var filename=xmlHttp.responseText.split(':')[1]
    document.getElementById("corsp001").value=filename;
    document.getElementById("corsp003").value=eAdmDocTypeCode;
  }
}
function init() {
  document.UpdateForm.ptmis001.focus();
  valClaimCode();
  displayRegime();
  setHF();
  DispContractACT();
  setTimeout('portalADM()',700);
}
function portalADM() {
  if(document.getElementById("ptcnepis").value=="1") {  // Episoft ptcnepis
    OnlinePreadmission();
    eAdmPreList();
  } else {
    OnlinePreadmissionA();
  }
}

function MyHealthRec() {
  document.getElementById('MyhealthRecLebel').innerHTML=DescriptionPCEHR;
  document.UpdateForm.d_ptvis115.title=DescriptionPCEHR;
}
function chkeAdmCanceButton() {
  if(document.getElementById("ptcnepis").value == "1") {  // Episoft ptcnepis
    chkeAdmCancel();
  } else {
    PatientLinkTo('patweb98.pbl',1,1,0);
  }
}
// eAdmission change of health fund
function findHFunddesc() {
  if (!isWhitespace(document.UpdateForm.admisnid.value)) {
     if (document.UpdateForm.ptmis013.value !=
                  document.UpdateForm.d_ptmis013.value ) {
        if (!isWhitespace(document.UpdateForm.ptmis013.value)) {
            if (!validateCode(16,document.UpdateForm.ptmis013,document.UpdateForm.funddesc)) {
                document.UpdateForm.ptmis013.value="";
                document.UpdateForm.funddesc.value="";
            }
            if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,UpdateForm.funddesc,UpdateForm.tabldesc)) {
                document.UpdateForm.ptmis014.value="";
                document.UpdateForm.tabldesc.value="";
            }
        } else {
          document.UpdateForm.ptmis013.value="";
          document.UpdateForm.funddesc.value="";
          document.UpdateForm.ptmis014.value="";
          document.UpdateForm.tabldesc.value="";
       }
     }
  }
}
</script>
</head>
<body onload="PageLoad(event);setPST();MyHealthRec();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.03.003";
PatientVIS="%PATWEB89.03.081";
PatientNAM="%PATWEB89.03.002";
PatientSTA="%PATWEB89.03.086.078";
PatientALT="%PATWEB89.03.084";
PatientSEX="%PATWEB89.03.019";
PatientDOB="%PATWEB89.03.020";
PatientAGE="%PATWEB89.03.021";
PatientLOC="%PATWEB89.03.083";
PatientPRI="%PATWEB89.03.086.066.1";
PatientUNT="%PATWEB89.03.066.0";
DoctorCOD="%PATWEB89.03.082.003";
DoctorNAM="%PATWEB89.03.082.002";
PatientAID="%PATWEB89.03.086.090";
PatientIND="%PATWEB89.03.086.091";
PatientCUR="%PATWEB89.03.086.092";
PatientCLC="%PATWEB89.03.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.03.086.094";
PatientCDM="%PATWEB89.03.086.095";
PatientVDH="%PATWEB89.03.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form name=linkForm action=patweb89.pbl method=post style=margin:0>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.081">
</form>
<form name=UpdateForm method=post action=patweb89.pbl style=margin:0>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.081">
<input type=hidden id=corsp001 name=corsp001 value="">
<input type=hidden id=corsp003 name=corsp003 value="">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value="001">
<input type="hidden" name="updatety" value="1">
<input type="hidden" name="redirect">
<input type="hidden" name="ptmis054">
<input type="hidden" name="allocate" value="1">
<input type="hidden" name="chckname" value="0">
<input type="hidden" name="emradmit" value="0">
<input type="hidden" name="emradmis" value="0">
<input type="hidden" name="admitnow" value="1">
<input type="hidden" name="newbmand" value="0">
<input type="hidden" name="agebmand" value="0">
<input type="hidden" name="tmotfrst" value="10">
<input type="hidden" name="tmotnext" value="10">
<input type=hidden name=ptmas046 value="0">
<input type="hidden" name="mvmedrec">
<input type="hidden" name="cfinan" value="%PATWEB89.03.932">
<input type="hidden" name="claimc">
<input type="hidden" name="dummy">
<input type="hidden" name="leavhosp">
<input type="hidden" name="leavadmn">
<input type="hidden" name="leavtype">
<input type="hidden" name="contmult" value="1">
<input type="hidden" name="exstward" value="%PATWEB89.03.449.1">
<input type=hidden name=admisnid id=admisnid value="%PATWEB89.03.999.036">
<input type="hidden" name="datefrom" />
<input type="hidden" name="dateto" />
<input type="hidden" name="ptcnepis" id="ptcnepis"
 value="%STANDARD.01.025.119.182.0.1" />

<input type="hidden" name="ptcndumh" id="ptcndumh"
                                 value="%STANDARD.01.025.124.240.0.1">

<input type="hidden" name="showflag" value="0" />
<input type=hidden name=ptpra001 value=""
                                     title="Person Responsible for Account" />
<input type=hidden name=ptpra002 value=""
                                     title="PRFA Address" />
<input type=hidden name=ptpra004 value=""
                                     title="PRFA Suburb" />
<input type=hidden name=state    value=""
                                     title="PRFA State" />
<input type=hidden name=ptpra006 value=""
                                     title="PRFA Post code" />
<input type=hidden name=ptpra007 value=""
                                     title="PRFA Home Phone" />
<input type=hidden name=ptpra008 value=""
                                     title="PRFA Work Phone" />
<input type=hidden name=ptpra009 value=""
                                     title="PRFA Relationship" />
<input type=hidden name=ptpra010 value=""
                                     title="PRFA Mobile" />
<input type=hidden name=d_ptmis013 value="%PATWEB89.03.040.0">
<table border=0 colspan=0 width=100% cellspacing=0 cellpadding=0 >

<tr><td class=HeadingCell align=center>
    Patient Pre-Admission Details (New) </tr>
<tr>
<tr><td>
    <table width=100%  border=0 class=TableBody cellpadding=0 cellspacing=0>
     <tr><td>&nbsp;</td><td>&nbsp;</td>
         <td align=left><b>Admit Now?</b></td>
        <td align=left>
        <input type="checkbox" name="admitbox" value="0" notab
           onclick='AdmitMandatory();'>
        </td></tr>

     <tr><td class=DataLabel>Admission Date </td>
         <td><input type=text size=12 name=ptmis001 tabindex=1 
             class="Mandatory Date" title="Admission Date" id=ptmis001
             value="%STANDARD.01.015">
         <img notab src=../images/DateLookup.gif 
          class=Icon onclick="DateLookupFrame(ptmis001);">     
          Time 
       <input class=Mandatory type=text name=ptmis002 size=8 tabindex=2
          value="%STANDARD.01.016" title="Admission Time" id=ptmis002>
        <img notab src=../images/DateTimeStamp.gif border=0 hspace=4 
         class=Icon onclick="SetCurrentDateTime(null,ptmis002);">
       <img notab src=../images/TimeLookup.gif class=Icon
        onclick="TimeLookupFrame(ptmis002);">
          </td>

       <td class=DataLabel>Ward / Bed </td>
         <td><input type=hidden name=bedstat1 id=bedstat1>
           <input type=hidden name=ptmis004 id=ptmis004>
           <input type=hidden name=ptmis005 title="Bed" id=ptmis005>
           <input type=hidden name=warddesc id=warddesc>
           <select name=ptmis068 tabindex=21 title="Ward" id=ptmis068>
            <option> </option>
            %PATWEB89.03.449.2
           </select>
           <input type=text name=ptmis076 readonly maxlength=3 size=3
                  title="Bed" id=ptmis076>
           <img notab src=../images/SearchIcon.gif class=Icon
            onclick="WardBedSearchFrame(ptmis068,warddesc,ptmis076,bedstat1);">
          </td>
      </tr>

<tr>
          <td class=DataLabel>Admission Criteria</td>
          <td>
          <select name=ptvis041 tabindex=3 title="Criteria for Admission">
          <option> </option>
          %PATWEB89.03.244.2
          </select>
          </td>
          <td class=DataLabel>Attending Doctor</td>
          <td><input type="text" size=8 maxlength=6 name="ptmis007" tabindex=22
              title="Admitting Doctor" id=ptmis007
              onblur="UpCase(this);valDoctorUnit();">
              <input type=text readonly size=25 notab name=doctnam2
               title="Admitting Doctor" id=doctnam2>
              <img notab src="../images/SearchIcon.gif" class=Icon
             onclick="DoctorSearchFrame(ptmis007,doctnam2)">
          </td>
</tr>


          <tr><td class=DataLabel>%STANDARD.01.017.P </td>
          <td><select name=ptmis011 tabindex=4
               title="%STANDARD.01.017.P ">
              <option> </option>
                 %PATWEB89.03.112.2
              </select></td>
          <td class="DataLabel">Unit</td>
          <td><select name="ptmis024" tabindex="22"
               title="Unit">
              <option> </option>
                 %PATWEB89.03.124.2
              </select>
          </td></tr>

      <tr>
        <td class=DataLabel>Admission Source</td>
          <td><select name=ptmis009 tabindex=5
               onchange="DisplayTrnSrc();" title="Admission Source">
               <option> </option>
               %PATWEB89.03.110.2
               </select></td>
        <td class=DataLabel>Referring Doctor</td>
        <td><input type="text" size=10 maxlength=10 name="ptvis028" tabindex=23
             title="Referring Doctor"
             onblur="ValidateHCP(18,0,ptvis028,doctnam1);">
            <input type="text" size=25 notab readonly name="doctnam1">
            <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(UpdateForm.ptvis028,UpdateForm.doctnam1,0);">
          <td>
</tr>
          <tr>
          <td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>
          <td class=DataLabel>Admission Diagnosis </td>
          <td><input tabindex=24 type=text name="ptmis020" size=50 maxlength=80
               title="Diagnosis">
          </td>
</tr>

<tr>
          <td class=DataLabel> Intended Length of Stay </td>
          <td class=DataLabel>
             <select name=ptvis043 tabindex=7 title="Intended Length of Stay">
             <option> </option>
              %PATWEB89.03.246.2
             </select>
        </td>
          <td class="DataLabel">Provisional DRG</td>
          <td class="DataLabel">
       <input type="text" name="ptmis066" size="5" maxlength="4" tabindex="25"
        title="Provisional DRG"
               onblur="validateCode(5,ptmis066,drgdesc1)" />
          <input type="text" notab readonly name="drgdesc1" size="35" value="" />
              <img notab src="../images/SearchIcon.gif" class=Icon
           onclick="DrgSearchFrame(UpdateForm.ptmis066,UpdateForm.drgdesc1);" />
          </td>
</tr>

<tr>
       <td>Admitting Point</td>
       <td><select name="ptvis046" tabindex="8" title="Admitting Point"
          onchange="defaultWard()">
           <option></option>
            %PATWEB89.03.290.2
         </select>
      </td>
      <td class=DataLabel>Unplanned Theatre Visit</td>
      <td><select name=ptvis079 tabindex=26
           title="Unplanned Theatre Visit" >
          <option> </option>
           %PATWEB89.03.295.4
          </select></td>
</tr>

<tr>
 <td>&nbsp;</td><td>&nbsp;</td>
      <td class=DataLabel>Usual Accommodation - Psych Only</td>
      <td><select name=ptvis095 tabindex=27
           title="Usual Accommodation - Psych Only" >
           <option></option>
           %PATWEB89.03.298.017.2
           </select></td>
</tr>

<tr>
      <td class=DataLabel>%STANDARD.01.017.KM</td>
      <td><select name=ptvis094 tabindex=9 title="%STANDARD.01.017.KM">
           <option></option>
           %PATWEB89.03.298.016.2
           </select></td>
 <td class=DataLabel>%STANDARD.01.017.KD</td>
 <td>
 <select name=ptvis104 tabindex=27 class=SelectBig title="%STANDARD.01.017.KD">
 <option></option>
%PATWEB89.03.298.026.4
 </select></td>
</tr>

<tr>
      <td class=DataLabel>Discharge Intention on Admission</td>
      <td><select name=ptvis076 tabindex=10
           title="Discharge Intention on Admission">
          <option> </option>
           %PATWEB89.03.292.2
          </select></td>
      <td class=DataLabel>Unplanned Readmission</td>
      <td><select name=ptvis078 tabindex=28
           title="Unplanned Readmission">
          <option> </option>
           %PATWEB89.03.294.4
          </select></td>
</tr>

  <tr>
      <td class=DataLabel>Program</td>
      <td><input type=text size=8 maxlength=8 name=ptvis099
         title="Program" tabindex=11 value="%PATWEB89.03.298.021.1"
          onchange="findPrgmdesc();">
          <select name=prgmcode Readonly class=readonly
          onchange="savePrgmcode();">
          <option> </option>
           %PATWEB89.03.298.021.2
          </select></td>
      <td class=DataLabel>%STANDARD.01.017.LS</td>
      <td><select name=ptvis074 tabindex=29 title="%STANDARD.01.017.LS">
          <option></option>
          %PATWEB89.03.289.4
          </select>
      </td>
      </tr>

      <tr>
       <td align=left>3B Days of hospitalisation</td>
       <td align=left>
       <input type=text name=ptmis082 title='3B No. days of hospitalisation'
       class=Integer size=5 maxlength=4 tabindex=12
       onblur=checkInteger(this,this.title)>
       </td>
        <td class=DataLabel> Planned Length of Stay</td>
        <td><input type=text size=5 maxlength=5 name=ptmis030 id=ptmis030
         tabindex=30 title='Planned Length of Stay'
         class=Integer onblur="checkInteger(this,this.value);">
        </td></tr>

  <tr>
       <td class=DataLabel>Religious Visit</td>
       <td>
         <select name=ptmis017 tabindex=13 title="Religious Visit">
          <option value="2">NO</option>
          <option value="1">YES</option>
         </select>
       </td>
       <td><div id=MyhealthRecLebel
           title="Consent to upload Episode documents/results to MyHR"></div></td>
       <td><input type=hidden name=ptvis115>
           <select name=d_ptvis115 tabindex=30>
           <option value=" "></option>
           <option value="1">Yes</option>
           <option value="0">No</option>
           </select></td>
  </tr>

<tr align=left>
         <td align=center colspan="4">
         <hr>
         </td>
</tr>

<tr>
         <td class=DataLabel>%STANDARD.01.017.CL</td>
         <td><select name=ptmis027 title="%STANDARD.01.017.CL" 
              tabindex=41 onchange="setHF();DispContractACT();">
               <option> </option>
                %PATWEB89.03.126.9.1.10.2.X
             </select>
         </td>
    <td class=DataLabel>Health Fund
        <input type="hidden" name="ptmis013" id=ptmis013
          value="%PATWEB89.03.040.0" title="Health Fund"></td>
    <td class=DataLabel colspan=2>
        <input type=text size=35 name="funddesc" maxlength="30" id=funddesc
         title="Health Fund" value="%PATWEB89.03.040.1" readonly notab> Level
        <input type="hidden" name="ptmis014" value="%PATWEB89.03.041.0"
          id=ptmis014 title="Level">
        <input type="text" size=20 maxlength=30 name="tabldesc" id=tabldesc
         value="%PATWEB89.03.041.1" readonly notab>
        <img src=../images/SearchIcon.gif  class=Icon
         onclick="HealthFundSearchFrameNoFocus(ptmis013,funddesc,
                                               ptmis014,tabldesc);">
        <img src="../images/erase.gif" class=Icon 
         onclick="clrFields(ptmis013,funddesc,ptmis014,tabldesc);">
    </td>
</tr>

<tr>
          <td class=DataLabel>%STANDARD.01.017.A </td>
          <td><select name=ptmis010 tabindex=42 onchange="setPST()"
               title="%STANDARD.01.017.A ">
              <option> </option>
                 %PATWEB89.03.111.2
              </select></td>
      <td class=DataLabel> Member Number </td>
      <td><input type=text size=20 maxlength=19 name=ptmis015 tabindex=52
       value="%PATWEB89.03.042" title="Member Number">
      </td>
</tr>
<tr id="PST" style="display:none">
  <td>%STANDARD.01.035.YE</td>
   <td>
     <select class=Mandatory name="ptvis134" title="%STANDARD.01.035.YE"
             tabindex=42>
       <option></option>
         %STANDARD.01.018.YE.   .2
     </select>
   </td>
   <td>&nbsp;</td>
   <td>&nbsp;</td>
 </tr>


<!-- Service Unit Type for PUBLIC HOSPITALS ONLY-->
<tr>
          <td class=DataLabel>Service Category</td>
          <td><select name=ptmis012 tabindex=43 title="Service Category"
               onchange=displayRegime();>
              <option></option>
              %PATWEB89.03.113.2
              </select></td>
         <td align=left>Prior Days Hospitalisation</td>
         <td align=left>
           <input type=text name=ptmis031 title='Prior Days Hospitalisation'
            class=Integer size=5 maxlength=4 tabindex=53
            onblur=checkInteger(this,this.title)>
         </td>
</tr>

<tr>
      <td class=DataLabel>Casepayment Y/N</td>
      <td><select name=ptmis075 title="Casepayment Y/N" 
           tabindex=44>
          <option> </option>
           %PATWEB89.03.197.2
          </select>
        </td>
      <td class=DataLabel>GST Applicable</td>
      <td><select name=ptmis074 tabindex=54 title="GST Applicable">
          <option> </option>
           %PATWEB89.03.189.2
          </select>
        </td>
</tr>

<tr>
      <td class=DataLabel>Casemix Code</td>
          <td class=DataLabel>
       <input type=text name=ptmis073 size=10 maxlength=9 tabindex=45
        title="Casemix Code" id=ptmis073
        onblur='if (!isWhitespace(this.value)) {
                    validateCode(35,ptmis073,cmixdesc1);
                  }'> 
          <input type=text notab readonly name=cmixdesc1 
             id=cmixdesc1 size=35 value="">
              <img notab src="../images/SearchIcon.gif" class=Icon
               onclick="CmixSearchFrameLOS(ptmis073,cmixdesc1)">
          </td>
      <td class=DataLabel>Palliative Care Status</td>
      <td><select name=ptvis077 tabindex=55 title="Palliative Care Status">
          <option> </option>
           %PATWEB89.03.293.4
          </select>
        </td>
</tr>

<tr>
  <td class=DataLabel>Continuous Billing</td>
  <td><select name=ptmis081 tabindex=46 title="Continuous Billing">
        <option> </option>
         %PATWEB89.03.199.014.2
        </select>
  </td>
  <td align=left>Move Medical Record</td>
  <td align=left>
    <input type="checkbox" name="mvmedre1" value="1" tabindex=56>
  </td>
</tr>

 <tr><td class=DataLabel><div id=ContrHeading></div></td>
     <td><div id=ContrId></div></td>
     <td class=DataLabel><div id=Contr1Heading></div></td>
     <td><div id=ContrType></div></td>
 </tr>

 <tr><td class=DataLabel><div id=Contr2Heading></div></td>
     <td><div id=ContrRole></div></td>
     <td class=DataLabel><div id=Contr3Heading></div></td>
     <td><div id=ContrUR></div></td>
 </tr>


 <tr> <td><div id=RegimeHead1></div></td>
      <td><div id=RegimeCode1></div></td>     
      <td><div id=UserNameHead></div></td>
      <td><div id=UserNameCode></div></td></tr>

  <tr><td><div id=RegimeHead2></div></td>
      <td><div id=RegimeCode2></div></td>
      <td><div id=PasswordHead></div></td>
      <td><div id=PasswordCode></div></td></tr>

  <tr><td><div id=RegimeHead3></div></td>
      <td><div id=RegimeCode3></div></td></tr>

<!-- END HEALTH FUND STUFF -->

<!--<tr>
      <td class=DataLabel>Unplanned Readmission within 28 days</td>
      <td><select name=ptvis078 tabindex=32
           title="Unplanned Readmission within 28 days"
           >
          <option> </option>
           PATWEB89.03.294.2
          </select></td>
</tr>-->

<!--<tr><td class=DataLabel>Type of Usual Accommodation - Psych Only</td>
          <td><select name=ptmis040 tabindex=33
               title="Type of Usual Accommodation - Psych Only"
               onchange="">
              <option> </option>
                 PATWEB89.03.136.2
              </select></td>
      </tr>-->

<tr><td class=DataLabel> Admission Comments </td>
<td colspan=6 align=left>
<textarea wrap=hard name=adcommnt rows=4 cols=70 tabindex=60>
</textarea></td></tr>

      <tr align=center>
       <td colspan=4 align=center><br>
       <input tabindex=61 type=button value="Ok" class="button"
        id="pat89sub"
        onclick="tempDisable(this);checkBedStatus(UpdateForm.ptmis068.value,
                 UpdateForm.ptmis076.value,UpdateForm.ptmis001.value,
                 UpdateForm.ptmis030.value,UpdateForm.ptmis002.value,
                 UpdateForm.ptrgm001.value,UpdateForm.ptrgm002.value,
                 UpdateForm.ptrgm003.value,SubmitAdm);">
       <input tabindex=62 type=button value="Cancel" class="button"
             onclick="chkeAdmCanceButton();">
    </table>
</td></tr>
</table>
</form>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.101">
<input type=hidden name=MenuType value="%PATWEB89.03.088">
</form>
</div>
<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 tabindex=19 id=ptmis058
         title="Referral Date">
         <img notab src=../images/DateLookup.gif
          class=Icon onclick="DateLookupFrame(ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
    <td><input type=text size=12 name=ptmis059 tabindex=20 id=ptmis059
         title="Consultation Date">
         <img notab src=../images/DateLookup.gif 
          class=Icon onclick="DateLookupFrame(ptmis059);"></td></tr>
</table>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Admission Weight</td>
    <td><input type=text name=ptmis051 size=8 maxlength=6
         onchange=justifyRight(this);>grams</td></tr>
</table>
</span>

<span id=NewBorn style="display:none">
<table width=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
    <td><input type=text name=ptmis041 maxlength=3 size=4 tabindex=21> weeks
    </td></tr>
</table>
</span>


<script type="text/javascript">
MergePsy="%PATWEB89.03.050"
  if(MergePsy=="Yes"){
    document.UpdateForm.ptmas046.value="1"
  }
 if(MergePsy=="No "){
    document.UpdateForm.ptmas046.value="0"
  }
 if ("%PATWEB89.03.903" == "1") {
  alert("Warning: Patient has a Waiting List Procedure");
 }
 if ("%PATWEB89.03.904" == "1") {
  alert("Warning: Patient has a Booking");
 }
 if ("%PATWEB89.03.905" == "1") {
  alert("Warning: Patient is currently admitted");
 }
 if ("%PATWEB89.03.908" == "1") {
  alert("Warning: Patient has a pre-admission record");
 }
  Day=document.UpdateForm.ptmis001.value.substr(0,2).replace(/ /g,"0")
  Dat=document.UpdateForm.ptmis001.value.substr(2)
  document.UpdateForm.ptmis001.value=Day + Dat

var p = document.UpdateForm;
var PCEHR = trim("%PATWEB89.03.298.037"); //pmsvx125/ptvis115
valMYHR(p.d_ptvis115,PCEHR,p.ptcndumh.value);
//Upload myhr - Set mandatory/non-mandatory
if (p.ptcndumh.value > 2){
  p.d_ptvis115.className="Mandatory";}
else{
  p.d_ptvis115.className="";}


</script>
<span id=transferhd style="display:none" class=DataLabel>
Transfer Source
</span>
<span id=transfersrc style="display:none">
<input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
      title="Transfer Source" tabindex=6 id=trnsfsrc
      onchange="validateCode(9,trnsfsrc,trandesc);">
     <input type=text size=27 name=trandesc notab id=trandesc
      class=Readonly readonly>
     <img src="../images/SearchIcon.gif" class=Icon
      onclick="TransferSourceFrame(trnsfsrc,trandesc)">
</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>

<span id=blanklabel style="display:none">&nbsp;</span>
<span id=regimehd1 style="display:none" class=DataLabel>
Regime Code 1
</span>
<span id=regimecod1 style="display:none">
<input type="text" size=15 maxlength=10
     name=ptrgm001 tabindex=47 id=ptrgm001
     onblur=validateCode(75,UpdateForm.ptrgm001,UpdateForm.dummy);>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(ptrgm001,dummy);">
    <img src="../images/erase.gif" class=Icon onclick="clrFields(ptrgm001,dummy);">
</span>

<span id=regimehd2 style="display:none" class=DataLabel>
Regime Code 2
</span>
<span id=regimecod2 style="display:none">
<input type="text" size=15 maxlength=10
     name=ptrgm002 tabindex=48 id=ptrgm002
     onblur=validateCode(75,UpdateForm.ptrgm002,UpdateForm.dummy);>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(ptrgm002,dummy);">
    <img src="../images/erase.gif" class=Icon onclick="clrFields(ptrgm002,dummy);">
</span>

<span id=regimehd3 style="display:none" class=DataLabel>
Regime Code 3
</span>
<span id=regimecod3 style="display:none">
<input type="text" size=15 maxlength=10
     name=ptrgm003 tabindex=49 id=ptrgm003
     onblur=validateCode(75,UpdateForm.ptrgm003,UpdateForm.dummy);>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(ptrgm003,dummy);">
    <img src="../images/erase.gif" class=Icon onclick="clrFields(ptrgm003,dummy);">
</span>

<span id=regimeblank1 style="display:none">
<input type=hidden name=ptrgm001 value="">
</span>

<span id=regimeblank2 style="display:none">
<input type=hidden name=ptrgm002 value="">
</span>

<span id=regimeblank3 style="display:none">
<input type=hidden name=ptrgm003 value="">
</span>

<!--
  
Commented the user name/password spans out as it appears that they are not
being used in this template. The password manager seems to be filling the hidden
password field, so these fields have been commented out.

<span id=usernamehd style="display:none">
User Name
</span>

<span id=usernamcd style="display:none">
<input size=12 type=text name=username class=Mandatory title="UserName">
</span>

<span id=passwordhd style="display:none" class=DataLabel>
Password
</span>

<span id=passwordcd style="display:none">
<input size=12 type=password name=password onblur="checkPass();" class=Mandatory
     title="Password">
</span>
-->

<span id=contrihd style="display:none">
Contract ID
</span>

<span id=contrthd style="display:none">
Contract Type
</span>

<span id=contrrhd style="display:none">
Contract Role
</span>

<span id=contrhhd style="display:none">
Contract Hospital UR
</span>

<span id=contrid style="display:none">
  <select name=ptasf003 title="Contract Id" tabindex=47>
  <option> </option>
   %PATWEB89.03.199.003
  </select>
</span>

<span id=contrtype style="display:none">
  <input type="text" name=ptasf001 size=2 maxlength=1
   value="%PATWEB89.03.199.001" tabindex=57
   title="Contract Type"
   onblur="ContType(this);">
   <img src="../images/SearchIcon.gif" class=Icon
   onclick="ContTypeAlert();">
</span>

<span id=contrrole style="display:none">
  <input type="text" name=ptasf002 size=2 maxlength=1
   value="%PATWEB89.03.199.002" tabindex=48
   title="Contract Role"
   onblur="ContRole(this);">
   <img src="../images/SearchIcon.gif" class=Icon
   onclick="ContRoleAlert();">
</span>

<span id=contrur style="display:none">
  <input type="text" name=ptvis105 size=12 maxlength=12
   value="%PATWEB89.03.298.027" tabindex=58
   title="Contract Hospital UR">
</span>


