<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="crdhb">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true"> 
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>

<script type="text/javascript">
function OffDuty() {
  if(AddForm.offdutyb!=undefined){
    if(AddForm.offdutyb.checked==true){
      alert("Error: Claim Type invalid for 'Off Duty' personnel.")
      return true;
    }
  }
  return false;
}
function SetList() {
  p=AddForm
  p.otart010.options.length=1;
  SetClinicType(p.otart010,p.defctype.value,p.otart009.value);
//
  SetList2();
}
function SetList2() {
  p=AddForm
  p.otart011.options.length=1;
  SetTypeClinic(p.otart011,p.deftclid.value,p.otart009.value,p.otart010.value);
  SelectSourceOfReferral(p.otart009,p.otart008,p.otart017) 
  for (var i =0 ; i < p.otart017.length; i++) {
  if (p.otart017.options[i].value.substr(0,3)==p.d_otart017.value.substr(0,3)) {
       p.otart017.selectedIndex=i } };
}
function MandatoryReason() {
  if(document.AddForm.d_cancelrq.checked==true) {
    document.AddForm.otart022.disabled=false;
    document.AddForm.otart022.className="selectBig Mandatory";
  } else {
    document.AddForm.otart022.selectedIndex=0;
    document.AddForm.otart022.className="selectBig";
    document.AddForm.otart022.disabled=true;
  }
}
function CloseRequest() {
  parent.location.href=document.AddForm.redirect.value;
}
function CloseRequestConfirm() {
  if(confirm("Are you sure you want to Close?")) {
     CloseRequest();
  }
}
function showFundingSource() {
   i=document.AddForm.otart015.selectedIndex;
   ind=document.AddForm.otart015.options[i].value.substring(3,4)
   if (ind=="A") {
     FundingHeading.innerHTML=offdutyhd.innerHTML;
     FundingId.innerHTML=offdutyid.innerHTML;
   } else {
     if (ind=="P") {
       FundingHeading.innerHTML=fundinghd.innerHTML;
       FundingId.innerHTML=fundingid.innerHTML;
       document.AddForm.otart037.className="Mandatory";
     } else {
       FundingHeading.innerHTML=blanklabel.innerHTML;
       FundingId.innerHTML=blanklabel.innerHTML;
     }
   }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);SetList();showFundingSource();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="CloseRequest();">
<script type="text/javascript">
  document.write('Appointment Request - %OUTWEB08.08.002 (%OUTWEB08.08.003)');</script>
</span>

<form name=AddForm id=AddForm method=post action=outweb08.pbl style="margin:0">
<input type=hidden name=reportno id=reportno value="08">
<input type=hidden name=template id=template value="002">
<input type=hidden name=updttype id=updttype value="A">
<input type=hidden name=urnumber id=urnumber value="%OUTWEB08.08.003">
<input type=hidden name=admissno id=admissno value="%OUTWEB08.08.081">
<input type=hidden name=otart001 id=otart001 value="%OUTWEB08.08.003">
<input type=hidden name=otart002 id=otart002 value="%OUTWEB08.08.081">
<input type=hidden name=dummy1 id=dummy1 value="">
<input type=hidden name=otart020 id=otart020 value="0">
<input type=hidden name=defctype id=defctype value="%OUTWEB08.08.167.1">
<input type=hidden name=deftclid id=deftclid value="%OUTWEB08.08.188.1">
<input type=hidden name=nextpage id=nextpage value="6">
<input type=hidden name=redirect id=redirect value="%OUTWEB08.08.001.outweb08.08.001">
<input type=hidden name=d_otart017 id=d_otart017 value="%OUTWEB08.08.134.1">

<table align=center width=98% border=0 cellspacing=0 cellpadding=1>
<tr><td class=DataLabel>Requesting Department</td>
    <td class=DataField>
    <select class="SelectBig Mandatory" name=otart005 id=otart005
     title="Requesting Department">
    <option></option>
     %OUTWEB08.08.125.2
    </select>
    </td>
    <td class=DataLabel>Requested By</td>
    <td class=DataField>%STANDARD.01.009</td>
    <td class=DataLabel>Request Date</td>
    <td class=DataField><input type=text name=otart003 id=otart003 value="%STANDARD.01.015"
     title="Request Date" class="PastDate Mandatory">
    <img src="../images/DateLookup.gif" class=Icon date=date1
     align=absmiddle onclick="DateLookupFrame(otart003);">
     Time&nbsp;<input type=text size=6 title="Time" value="%STANDARD.01.016"
        class="Mandatory" name=otart004 id=otart004>
    <img src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(otart003,otart004);">
    <img src="../images/TimeLookup.gif" class=Icon time=time1
      onclick="TimeLookupFrame(otart004);">
    </td>
    </tr>

<tr><td class=DataLabel>Reason for Request</td>
    <td class=DataField>
    <select class="SelectBig Mandatory" name=otart021 id=otart021 
     title="Reason for Request">
    <option></option>
     %OUTWEB08.08.221.2
    </select>
    </td>
    <td class=DataLabel>Linked Referral Number</td>
    <td class=DataField>%OUTWEB08.08.081</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    </tr>

<tr><td colspan=6 align=center><hr></td></tr>
</table>

<table align=center width=98% border=0 cellspacing=0 cellpadding=1>
<tr><td class=DataLabel>Department Required</td>
    <td class=DataField>
    <select class="SelectBig Mandatory" name=otart006 id=otart006
     title="Appointment Required For Department">
    <option></option>
     %OUTWEB08.08.125.2
    </select>
    </td>
<!-- 01 : DXC : changed label from Preferred Date and made mandatory -->
    <td class=DataLabel>Target Date</td>
    <td class=DataField>
    <input type=text name=otart007 id=otart007 value="%OUTWEB08.08.207"
     title="Target Date" class="Mandatory">
    <img src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(otart007,null);">
    <img src="../images/DateLookup.gif" class=Icon date=date1
     align=absmiddle onclick="DateLookupFrame(otart007);">
    </td>
    </tr>

<tr><td class=DataLabel>Clinic Type</td>
    <td class=DataField>
    <select name=otart010 id=otart010 title="Clinic Type" class="Mandatory"
     onchange="SetList2();">
    <option></option>
    </select>
    </td>
    <td class=DataLabel>Preferred Hospital</td>
    <td class=DataField>
    <select name=otart008 id=otart008 title="Preferred Hospital" class="Mandatory">
    <option></option>
    %OUTWEB08.08.170.2
    </select>
    </td>
    </tr>

<tr><td class=DataLabel>Clinic Id</td>
    <td class=DataField>
    <select name=otart011 id=otart011 title="Clinic ID">
    <option></option>
    </select>
    </td>
    <td class=DataLabel>Preferred Site</td>
    <td class=DataField>
    <select name=otart009 id=otart009 title="Preferred Site" class="Mandatory"
     onchange="SetList();">
    %OUTWEB08.08.182.2
    </select>
    </td>
    </tr>

<tr><td class=DataLabel>Visit Type</td>
    <td class=DataField>
    <select name=otart012 id=otart012 title="Visit Type" class="selectBig Mandatory">
    <option></option>
    %OUTWEB08.08.212.2
    </select>
    </td>
    <td class=DataLabel>Presenting Complaint</td>
    <td class=DataField>
    <input type=text name=otart014 id=otart014 size=45 maxlength=50
     title="Presenting Complaint" value="%OUTWEB08.08.149">
    </td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField>

    <table cellspacing=0 cellpadding=0 width=100%>
    <tr><td>
    <select name=otart015 id=otart015 title="%STANDARD.01.017.CL"
     class="Mandatory selectBig" onchange="showFundingSource();">
    <option></option>
    %OUTWEB08.08.135.2
    </select></td>
    <td><div id=FundingHeading style="white-space:nowrap"></div></td>
    <td><div id=FundingId></div></td></tr>
    </table>

    </td>
    <td class=DataLabel>Transport</td>
    <td class=DataField>
    <select name=otart013 id=otart013 title="Transport"
     class="selectBig">
    <option></option>
    %OUTWEB08.08.213.2
    </select>
    </td>
    </tr>

<tr><td class=DataLabel>Source of Referral</td>
    <td class=DataField>
    <select name=otart017 id=otart017 title="Source of Referral"
     class="Mandatory selectBig">
    <option></option>
    </select>
    </td>
    <td class=DataLabel>Special Arrangements</td>
    <td class=DataField>
    <select name=otart018 id=otart018 title="Special Arrangements"
     class="selectBig">
    <option></option>
    %OUTWEB08.08.218.2
    </select>
    </td>
    </tr>

<tr><td class=DataLabel>Priority</td>
    <td class=DataField>
    <select name=otart016 id=otart016 title="Priority"
     class="selectBig Mandatory">
    <option></option>
    %STANDARD.01.007.PR 
    </select>
    </td>
    <td class=DataLabel></td>
    <td class=DataField></td>
    </tr>

<tr><td class=DataLabel>Cancel Request</td>
    <td class=DataField>
    <input type=checkbox name=d_cancelrq id=d_cancelrq value="1"
     onclick="MandatoryReason();">
    </td>
    <td class=DataLabel>Reason for Removal</td>
    <td class=DataField>
    <select name=otart022 id=otart022 title="Reason for Removal"
     class="selectBig">
    <option></option>
    %OUTWEB08.08.222.2
    </select>
    </td>
    </tr>

<tr><td class=DataLabel>Comments</td>
    <td class=DataField colspan=3>
    <textarea name=otrcmcom id=otrcmcom wrap=hard cols=60 rows=3>%OUTWEB08.08.247</textarea>
    </td></tr>

<tr><td colspan=6 align=center><br>
    <input type=button value="Add" class="button" id="out08add"
    onclick="if (!OffDuty()) {tempDisable(this);SubmitForm();}">
    <input type=button value=Cancel class="button" 
     onclick="CloseRequestConfirm()">
    </td></tr>
</table>
</form>

<span id=blanklabel style="display:none">
<input type=hidden name=otart037 id=otart037 value=" ">
</span>

<span id=fundinghd style="display:none">
&nbsp;Funding Source&nbsp;
</span>

<span id=fundingid style="display:none">
<select name=otart037 id=otart037 title="%STANDARD.01.017.cx">
<option> </option>
%OUTWEB08.08.499.009.5
</select>
</span>

<span id=offdutyhd style="display:none">
&nbsp;Off Duty&nbsp;
</span>

<span id=offdutyid style="display:none">
<input type="checkbox" name="offdutyb" id="offdutyb" value="0">
</span>
