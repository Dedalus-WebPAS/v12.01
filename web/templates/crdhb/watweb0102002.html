<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript">
function showACC(theForm) {
  checkInd=theForm.wattx026.value.substr(3,5)
  if (checkInd.search(/W/g) >= 0) {
      ACCHeading.innerHTML=acchd.innerHTML;
      ACCId.innerHTML=accorderid.innerHTML;
    } else {
      ACCHeading.innerHTML=blanklabel.innerHTML;
      ACCId.innerHTML=blanklabel.innerHTML;
    }
}
//function checkPriority() {
//  if (trim(AddForm.wattr014.value.substr(6,1))=="T") {
//    AddForm.wattr025.className="Mandatory NotFuturEdate";
//  }
//  else if (trim(AddForm.wattr014.value.substr(6,1))=="P") {
//    AddForm.wattr025.className="Mandatory NotFuturEdate";
//  }
//  else {
//    AddForm.wattr025.className="NotFuturEdate";
//  }
//}
// 04 : TAS : WP2-282 Change Priorty check function to make Certainty date mandatory
//  * except when Active review is selected
function checkPriorityTAS() {
  if (trim(AddForm.wattr014.value.substr(0,1))=="A") {
    AddForm.wattr025.className="NotFuturEdate";
  }
  else {
    AddForm.wattr025.className="Mandatory NotFuturEdate";
  }
}

function SubForm(AddForm) {
// 01 : CTAS : set faster treatment field value from checkbox
	updateFasterTreatmentValue();
// end of change  

  if (!validateMandatory(document.AddForm)) {
    return
  }
//
  datechk=validateOpDate();
  if (!datechk) { 
      return
  };
//
  datechk=validateRefDOBDate();
  if (!datechk) {
      return
  }
//
  datechk=validateFSARefRefDate();
  if (!datechk) {
      return
  }
//
  datechk=validateFSAFSARefDate();
  if (!datechk) {
      return
  }
//
  datechk=validateFSARefPreDOBDate();
  if (!datechk) {
      return
  }
//
  datechk=validateFSARefDate();
  if (!datechk) {
      return
  }
//
  if (!isWhitespace(document.AddForm.wattr025.value)) {
    datechk=validateCertRefDate();
    if (!datechk) {
       return
    }
    //
    datechk=validateCertFSARefDate();
    if (!datechk) {
       return
    }
    //
    datechk=validateCertFSADate();
    if (!datechk) {
       return
    }
  }
//
  result=validateTime();

  if (result) {
    var date = SetDateYYYYMMDD(document.AddForm.wattr006.value.replace(/ /g,"+"));
    var serverURL = "../cgi-bin/watweb01.pbl?reportno=22&valdtype=1" +
                   "&urnumber="+
                    document.AddForm.urnumber.value.replace(/ /g,"+") +
                   "&proccode="+
                    document.AddForm.wattr001.value.replace(/ /g,"+") +
                   "&lastdate="+date;
                    

    var returnValue = RSExecute(serverURL);
    var msg  = "Waiting list entry already exists."+
               "\nOK will create a duplicate."

    if (returnValue.return_value == -1) {
     if (!confirm(msg)) 
       return false;
    }
    
    document.AddForm.nextpage.value="9";
    document.AddForm.redirect.value="watweb01.pbl?reportno=4&template=4"

    linkACC();
    SubmitHidden(document.AddForm);

    return true;
  }
}

function linkACC() {
  if (AddForm.wattx026.value.substr(3,1)=='W') {
    document.AddForm.nextpage.value="9";
    AddForm.redirect.value="patweb89.pbl?reportno=01&template=005&systflag=4" +
                "&urnumber="+document.AddForm.urnumber.value.replace(/ /g,"+")
// 05 : TAS : set LinkACCCookie instead of AccRefNoCookie
//    SetCookie("AccRefNoCookie",document.getElementById("accrefno").value);
	SetCookie("LinkACCCookie","");
// end of change
  }
}

function UpdateUnit(){
  for (var i =0 ; i < document.AddForm.wattr011.length; i++) {
    if(trim(AddForm.unit.value)==trim(AddForm.wattr011.options[i].value.substr(0,3))) {
      document.AddForm.wattr011.selectedIndex=i;
    }
  };
}

function valUnit() {
  if (isWhitespace(document.AddForm.wattr012.value)) {
    AddForm.wattr011.options.length=0;
    return;
  }
  AddForm.unit.value=AddForm.wattr011.value.substr(0,3);
  selectOptions("30",AddForm.wattr012,AddForm.wattr011);
  validateCode(31,AddForm.wattr012,AddForm.name_wattr012,AddForm.specialty)

  for (var i =0 ; i < document.AddForm.wattr017.length; i++) {
    if(trim(AddForm.specialty.value)==trim(AddForm.wattr017.options[i].value.substr(0,3))) {
      document.AddForm.wattr017.selectedIndex=i;
    }
  };

  if (isWhitespace(document.AddForm.unit.value)) {
    AddForm.wattr011.selectedIndex=1;
  } else {
    UpdateUnit();
  }
  AddForm.unit.value="";
}

function valProc(thefield,thedesc) {
  validateCode(27,thefield,thedesc);
}

function valProc1(thefield,thedesc) {
  validateCode(27,thefield,thedesc,AddForm.wpgrp,AddForm.wattr013,AddForm.wattr002);
}

function set003(){
  AddForm.wattr003.value=AddForm.d_wattr001.value;
  // 01 : CTAS : Add into comments as well
   AddForm.wattrcom.value=AddForm.d_wattr001.value;
  // end of change
}

function valDoc() {
  var serverURL = "../cgi-bin/watweb01.pbl?reportno=13&valdtype=1" +
          "&wattr011="+document.AddForm.wattr011.value +
          "&wattr012="+document.AddForm.wattr012.value;
  var returnValue = RSExecute(serverURL);
  if (returnValue.return_value == -1) {
    return true;
  }
  return false;
}

function DefStat(){
  ChgStat();
}

function ChgStat() {
  var ind=document.AddForm.wattx004.value.substr(3,1)
  if (ind == "C"|| ind =="D" || ind =="S") {
    document.getElementById('NRFCLabel1').innerHTML="NRFC To Date";
    document.getElementById('NRFCLabel2').innerHTML="Auto Update RFC";
    document.getElementById('NRFCLabel3').innerHTML="NRFC Reason";
    document.getElementById('NRFCField1').innerHTML=
      document.getElementById('InNRFCField1').innerHTML;
    document.getElementById('NRFCField2').innerHTML=
      document.getElementById('InNRFCField2').innerHTML;
    document.getElementById('NRFCField3').innerHTML=
      document.getElementById('InNRFCField3').innerHTML;
    AddForm.watsu003.className="Mandatory";
  }
  else {
    document.getElementById('NRFCLabel1').innerHTML="";
    document.getElementById('NRFCLabel2').innerHTML="";
    document.getElementById('NRFCLabel3').innerHTML="";
    document.getElementById('NRFCField1').innerHTML="";
    document.getElementById('NRFCField2').innerHTML="";
    document.getElementById('NRFCField3').innerHTML="";
  } 

  if (ind == "S"){
    AddForm.watsu003.selectedIndex=1;
  }
  if (ind == "C"){
    AddForm.watsu003.selectedIndex=2;
  }
  if (ind == "D"){
    AddForm.watsu003.selectedIndex=3;
  }
}

function RemoveQuote(Field) {
  Field.value=Field.value.replace(/\"/g,"");
}
function DefaultReferral() {
  if(isWhitespace(AddForm.refrlvis.value)) {
    return;
  }
  for (var i=0; i < document.AddForm.wattr038.length; i++) {
  if (document.AddForm.wattr038.options[i].value.substr(0,3)==
      document.AddForm.d_alrepsit.value.substr(0,3)){
      document.AddForm.wattr038.selectedIndex=i;
  }}
  document.AddForm.wattr012.value=document.AddForm.d_alrehcp.value;
  document.AddForm.wattr012.onblur();
  for (var i=0; i < document.AddForm.wattx026.length; i++) {
  if (document.AddForm.wattx026.options[i].value.substr(0,3)==
      document.AddForm.d_alrecomp.value.substr(0,3)){
      document.AddForm.wattx026.selectedIndex=i;
  }}
  for (var i=0; i < document.AddForm.wattr053.length; i++) {
  if (document.AddForm.wattr053.options[i].value.substr(0,3)==
      document.AddForm.d_alrepurc.value.substr(0,3)){
      document.AddForm.wattr053.selectedIndex=i;
  }}
   for (var i=0; i < document.AddForm.wattx052.length; i++) {
  if (document.AddForm.wattx052.options[i].value.substr(0,3)==
      document.AddForm.c_alreuc22.value.substr(0,3)){
      document.AddForm.wattx052.selectedIndex=i;
  }}													
}

// 01 : CTAS : if suspicion of cancer high or confirmed 
//	make faster cancer treatment checkbox editable

// update value written to database
function updateFasterTreatmentValue() {
	if (document.AddForm.d_wattx056.checked) {
		document.AddForm.wattx056.value = "R01";
	} else {
		document.AddForm.wattx056.value = "R02";
	}
}

// update faster treatment check box with value from database
function setFasterCancerTreatment() {
	if (document.AddForm.wattx056.value) {
		var val = document.AddForm.wattx056.value.substr(0,3);	
		if (val === "R01")
			document.AddForm.d_wattx056.checked = true;
		else
			document.AddForm.d_wattx056.checked = false;
	}
}

// enable faster treatment option if cancer suspicion high or confirmed
function enableFasterCancerTreatment() {
	var suspicion = document.AddForm.wattx052.value.substr(0,3);
	if (suspicion === "R01" || suspicion === "R02") {
		document.AddForm.d_wattx056.disabled = false;
	} else {
		document.AddForm.d_wattx056.checked = false;
		document.AddForm.d_wattx056.disabled = true;
	}
}

function setDefaults() {
	DefaultReferral();
	setFasterCancerTreatment();
	enableFasterCancerTreatment();
}
// end of change
</script>
</head>
%START.OF.PAGE
<!-- 01 : CTAS : add faster cancer check to load 
<body onload="PageLoad(event);DefaultReferral();showACC();"> -->
<body onload="PageLoad(event);setDefaults();showACC(AddForm);">
<!-- end of change -->
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%WATWEB01.02.003";
PatientVIS="%WATWEB01.02.081";
PatientNAM="%WATWEB01.02.002";
PatientSTA="%WATWEB01.02.086.078";
PatientALT="%WATWEB01.02.084";
PatientSEX="%WATWEB01.02.019";
PatientDOB="%WATWEB01.02.020";
PatientAGE="%WATWEB01.02.021";
PatientLOC="%WATWEB01.02.083";
DoctorCOD="%WATWEB01.02.082.003";
DoctorNAM="%WATWEB01.02.082.002";
PatientAID="%WATWEB01.02.086.090";
PatientIND="%WATWEB01.02.086.091";
PatientCUR="%WATWEB01.02.086.092";
PatientCLC="%WATWEB01.02.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%WATWEB01.02.086.094";
PatientCDM="%WATWEB01.02.086.095";
PatientVDH="%WATWEB01.02.086.099.015";
PatientUNT="%WATWEB01.02.066.0";
PatientPRI="%WATWEB01.02.086.066.1";
InsertPatientHeader();
</script>

<div id=PatientMenu></div>
<div id=PageBodySection style="overflow: auto;">

<form name=AddForm action="watweb01.pbl" method=post>
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=001>
<input type=hidden name=updttype value="A">
<input type=hidden name=urnumber value="%WATWEB01.02.003">
<input type=hidden name=dummy value="">
<input type=hidden name=dummy1 value="">
<input type=hidden name=unit value="">
<input type=hidden name=wpgrp value="">
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value="1">
<input type=hidden name=specialty value="">
<input type=hidden name=wattr008 value="">
<input type=hidden name=wattr022 value="">
<input type=hidden name=wattr028 value="">
<input type=hidden name=d_pbdate value="%WATWEB01.02.020">
<input type=hidden name=refrlvis value="%WATWEB01.02.373">
<input type=hidden name=d_alrepsit value="%WATWEB01.02.374">
<input type=hidden name=d_alrehcp value="%WATWEB01.02.375">
<input type=hidden name=d_alrecomp value="%WATWEB01.02.376">
<input type=hidden name=d_alrepurc value="%WATWEB01.02.377">
<input type=hidden name=c_alreuc22 value="%WATWEB01.02.385">
<input type=hidden name=accrefno value="%WATWEB01.02.381">
  <!-- 01 : CTAS : wattx056 = faster cancer treatment -->
 <input type=hidden name=wattx056 value="%WATWEB01.02.557.3">
  <!-- end of change -->

<table border=0 width=100% cellspacing="0" cellpadding="1" align=center>
<tr><td align=center class=HeadingCell>Add Waiting List Entry </td></tr>

<table border=0 width=95% cellspacing=0 cellpadding=1 align=center>
<tr><td class=DataLabel>Referral Date</td>
    <td class=DataField>
      <input type=text name=wattr006 size=12 tabindex=1
       onblur="checkDate(this,'Date')" value="%STANDARD.01.015"
       class= "PastDate Mandatory" title="Date on List">
      <img src=../images/DateTimeStamp.gif class=Icon date=AddForm.wattr006
       time=null>
      <img src=../images/DateLookup.gif class=Icon date=AddForm.wattr006>
    </td>
    <td class=DataLabel>Comments</td>
</tr>

<tr><td class=DataLabel>Intended Hospital</td>
    <td class=DataField>
      <select name=wattr038 tabindex=2 title="Intended Hospital"
       class="Mandatory"
	   onchange="selectOptions2('3',AddForm.wattr038,AddForm.wattx005);">
	  <option value=""></option>
        %WATWEB01.02.148.2
      </select>
    </td>
</tr>

<tr><td>Consultant</td>
    <td class=DataField>
      <input type=text name=wattr012 size=6 maxlength=8 title="Consultant"
       class=Mandatory tabindex=5 onblur="UpCase(this);valUnit();">
      <input type=text name=name_wattr012 notab size=20 maxlength=30
       title="Consultant Name" >
      <img src=../images/SearchIcon.gif class=Icon
       onclick="WaitConSearchFrame(AddForm.wattr012,
                                   AddForm.name_wattr012,
                                   AddForm.wattr011);">
    </td>
    <td class=DataField rowspan=3 colspan=2>
      <textarea wrap=hard name=wattrcom cols=50 rows=6 tabindex=135></textarea>
    </td>
</tr>

<tr><td class=DataLabel>Unit</td>
    <td class=DataField>
      <select name=wattr011 title="Unit" tabindex=10
       class="Mandatory selectBig">
        <option></option>
        %WATWEB01.02.114.2
      </select>
    </td>
</tr>

<!-- 164870 NZ enchancement -->

<!-- 01 : CTAS : replace default WL unit procedure lookup with ICD10 search
<tr><td class="DataLabel">Procedure Code 1</td>
    <td class="DataField">
      <input type="text" id="wattr001" name="wattr001" class="Mandatory" 
       tabindex="15" title="Procedure Code" size="6"
       onblur="valProc1(AddForm.wattr001,AddForm.d_wattr001);set003();"/>
      <input type="text" id="d_wattr001" name="d_wattr001" size="50" 
       maxlength="50" readOnly class=readonly notab
       onblur="RemoveQuote(this);"/>
      <img src="../images/SearchIcon.gif" class="Icon"
       onclick="WaitProNoUnitSearchFrameK(AddForm.wattr001,
       AddForm.d_wattr001,AddForm.wattr013,AddForm.dummy);"/>
      <img src="../images/erase.gif" align=absmiddle
       onclick="clrFields(wattr001,d_wattr001);">
  </td>
</tr>

<tr><td class="DataLabel">Procedure Code 2</td>
    <td class="DataField">
      <input type="text" id="wattr040" name="wattr040" class=""  
       tabindex="20" title="Procedure Code 2" size="6"
       onblur="valProc(AddForm.wattr040,AddForm.d_wattr040);"/>
      <input type="text" id="d_wattr040" name="d_wattr040" size="50" 
       maxlength="50" notab readOnly 
       class=readOnly onblur="RemoveQuote(this);"/>
      <img src="../images/SearchIcon.gif" class="Icon"
       onclick="WaitProNoUnitSearchFrameK(AddForm.wattr040,
                AddForm.d_wattr040,AddForm.wattr013,AddForm.dummy);"/>
      <img src="../images/erase.gif" align=absmiddle
       onclick="clrFields(wattr040,d_wattr040);">
     </td>
     <td class=DataLabel>Preadmission Notes</td>
</tr>

<tr><td class="DataLabel">Procedure Code 3</td>
    <td class="DataField">
      <input type="text" id="wattr041" name="wattr041" class=""
       tabindex="25" title="Procedure Code 3" size="6"
       onblur="valProc(AddForm.wattr041,AddForm.d_wattr041);"/>
      <input type="text" id="d_wattr041" name="d_wattr041" size="50"
       maxlength="50" notab readOnly 
       class=readonly onblur="RemoveQuote(this);"/>
      <img src="../images/SearchIcon.gif" class="Icon"
       onclick="WaitProNoUnitSearchFrameK(AddForm.wattr041,
                AddForm.d_wattr041,AddForm.wattr013,AddForm.dummy);"/>
      <img src="../images/erase.gif" align=absmiddle
       onclick="clrFields(wattr041,d_wattr041);">
    </td>
-->
<tr>
  <td class="DataLabel">Procedure Code 1</td>
  <td class="DataField">
    <input type="text" id="wattr001" name="wattr001" class="Mandatory" 
           tabindex="15" title="Procedure Code" 
           onblur="validateCode(7,AddForm.wattr001,AddForm.d_wattr001);set003();" 
           size="6"/>
    <input type="text" id="d_wattr001" name="d_wattr001" size="50" 
           maxlength="50" readOnly class=readonly notab 
           onblur="RemoveQuote(this);"/>
    <img src="../images/SearchIcon.gif" class="Icon"
         onclick="Icd10ProSearchFrame(AddForm.wattr001,AddForm.d_wattr001);"/>
       <img src="../images/erase.gif" align=absmiddle onClick="clrFields(wattr001,d_wattr001);">
  </td>
</tr>
<tr>
  <td class="DataLabel">Procedure Code 2</td>
  <td class="DataField">
    <input type="text" id="wattr040" name="wattr040" class=""  
           tabindex="20" title="Procedure Code 2" 
           onblur="validateCode(7,AddForm.wattr040,AddForm.d_wattr040);" 
           size="6"/>
    <input type="text" id="d_wattr040" name="d_wattr040" size="50" 
           maxlength="50" notab readOnly 
           class=readOnly onblur="RemoveQuote(this);"/>
    <img src="../images/SearchIcon.gif" class="Icon"
         onclick="Icd10ProSearchFrame(AddForm.wattr040,AddForm.d_wattr040);" />
       <img src="../images/erase.gif" align=absmiddle onClick="clrFields(wattr040,d_wattr040);">
    </td>
     <valign=top><td class=DataLabel>Preadmission Notes</td>
</tr>
<tr>
  <td class="DataLabel">Procedure Code 3</td>
  <td class="DataField">
    <input type="text" id="wattr041" name="wattr041" class=""
           tabindex="25" title="Procedure Code 3" 
           onblur="validateCode(7,AddForm.wattr041,AddForm.d_wattr041);" 
           size="6"/>
    <input type="text" id="d_wattr041" name="d_wattr041" size="50"
           maxlength="50" notab readOnly 
           class=readonly onblur="RemoveQuote(this);"/>
    <img src="../images/SearchIcon.gif" class="Icon"
         onclick="Icd10ProSearchFrame(AddForm.wattr041,AddForm.d_wattr041);" />
       <img src="../images/erase.gif" align=absmiddle onClick="clrFields(wattr041,d_wattr041);">
 </td>
<!-- end of change -->
 
    <td class="DataField" rowspan="3" colspan="2">
      <textarea wrap="hard" name="wtpccomm" cols="50" rows="6" tabindex="140">
      </textarea>
    </td>
</tr>

<tr><td>Procedure Description</td>
    <td><input type="text" id="wattr003" name="wattr003" size="70" 
           maxlength="80" tabindex=30 onblur="RemoveQuote(this);"/>
    </td>
</tr>
<!-- End Multiple Procedures -->
<!-- 06 : TAS : Remove Reason/Diagnosis field
<tr><td class=DataLabel>Reason/Diagnosis</td>
    <td class=DataField colspan=3>
    <input type=text id=wattr004 name=wattr004 size=60 value="WATWEB01.02.383"
           maxlength=40 tabindex=31 onblur="RemoveQuote(this);"/>  
    </td>-->
</tr>
<!-- 06 End of change -->
<tr><td class=DataLabel>Duration of Procedure</td>
    <td class=DataField>
      <input type=text name=wattr002 size=10 tabindex=35 maxlength=5
       title="Estimated Operating time" class=Integer min=0>
    </td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.017.TP</td>
    <td class=DataField>
      <select name=wattr014 class=Mandatory tabindex=40 
       title="%STANDARD.01.017.TP" onchange=checkPriorityTAS();>
        <option></option>
        %WATWEB01.02.117.2
      </select>
    </td>
</tr>

<tr><td class=DataLabel>Score</td>
    <td class=DataLabel>
	  <!-- 01 : CTAS : Set to mandatory
      <input type=text name=wattr047 size=5 maxlength=5 tabindex=45
       class="Integer" min=0 title="Rank">
	  -->
	  <!-- 06 : Prevent score from defaulting from referral
	   <input type=text name=wattr047 size=5 maxlength=5 tabindex=45
       value="WATWEB01.02.384"
	   class="Integer Mandatory" min=1 max=100 title="Score">-->
	  <!-- 01 : end of change -->
	  <input type=text name=wattr047 size=5 maxlength=5 tabindex=45
      class="Integer Mandatory" min=1 max=100 title="Score">
	  <!-- 06 : End of change --> 
    </td>
</tr>

<!-- 01 : CTAS : add faster cancer treatment checkbox
<tr><td class=DataLabel>%STANDARD.01.017.X9</td>
    <td class=DataField>
      <select name=wattx052 tabindex=46 class="selectBig"
       title="STANDARD.01.017.X9">
        <option></option>
        WATWEB01.02.553.2
      </select>
    </td>
</tr>
-->
<tr><td class=DataLabel>%STANDARD.01.017.X9</td>
    <td class=DataField>
      <select name=wattx052 tabindex=46 class="selectBig"
	  onchange="enableFasterCancerTreatment();"
       title="%STANDARD.01.017.X9">
        <option></option>
        %WATWEB01.02.553.2
      </select>
    </td>
</tr>
<!-- end of change -->

<!-- 01 : CTAS : add faster cancer treatment checkbox -->
<tr><td class=DataLabel colspan=2>Faster Cancer Treatment (2 Weeks)&nbsp;
	<input type=checkbox value="" name=d_wattx056
			title="Faster Cancer Treatment (2 Weeks)">
</td></tr>
<!-- end of change -->

<tr><td class=DataLabel>%STANDARD.01.017.P   </td>
    <td class=DataField>
      <select name=wattr024  tabindex=50 class="selectBig"
       title="%STANDARD.01.017.P ">
        <option></option>
        %WATWEB01.02.131.2
      </select>
    </td>
</tr>

<tr><td class=DataLabel>Admitting Point  </td>
    <td class=DataField>
    <select name=wattx006  tabindex=55 class="selectBig"
     title="Admitting Point">
      <option></option> 
      %WATWEB01.02.506.2
    </select></td>  
</tr>

<tr><td class=DataLabel>Exp. Post Op Ward  </td>
    <td class=DataField>
      <select name=wattx005 tabindex=60 class="selectBig"
       title="Exp. Post Op Ward" >
        <option></option>
        %WATWEB01.02.505.2
      </select>
    </td>
</tr>

<tr><td class=DataLabel>Planned LOS</td>
    <td class=DataLabel>
      <input type=text name=wattr013 size=5 maxlength=5 tabindex=65
       class="Integer" min=0 title="Planned Length of Stay">(days)
    </td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.017.A </td>
    <td class=DataField>
      <select name=wattr017  tabindex=70 class="Mandatory selectBig"
       title="%STANDARD.01.017.A ">
        <option></option>
        %WATWEB01.02.120.2
      </select>
    </td>
</tr>

<tr><td class=DataLabel>%WATWEB01.02.187.8 </td>
    <td class=DataField>
      <select name=wattr050 tabindex=70 title="Referral Source" 
       class="Mandatory selectBig">
        <option></option>
        %WATWEB01.02.187.2
      </select>
    </td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL  </td>
    <td class=DataField> 
<!-- 01 : CTAS : Claim Type (cat code CL) made mandatory
      <select name=wattx026 tabindex=75 class=selectBig>
-->
      <select name=wattx026 tabindex=75 class="Mandatory selectBig" 
		title="%STANDARD.01.017.CL" onchange=showACC(AddForm);>
<!-- end of change -->
        <option></option>
        %WATWEB01.02.526.2  
      </select>
    </td>
    <td class="DataLabel">%STANDARD.01.017.WS</td>
    <td class="DataField">
      <select name="wattr015" tabindex="150" class="SelectBig" >
        <option></option>
        %WATWEB01.02.118.2
      </select>
    </td>
</tr>

     <tr><td><div id=ACCHeading></div></td>
         <td><div id=ACCId></div></tr>



<tr><td class=DataLabel>Certainty Date</td>
    <td class=DataField>
      <input type=text name=wattr025 size=12 class="NotFuturEdate"
       onblur="checkDate(this,'Certainty Date');"
       title="Decision to Admit Date" tabindex=80>
      <img src=../images/DateTimeStamp.gif class=Icon date=AddForm.wattr025
       time=null>
      <img src=../images/DateLookup.gif class=Icon date=AddForm.wattr025>
    </td>
    <td class=DataLabel>Principal Purchaser</td>
    <td class=DataField>
      <select name=wattr053 tabindex=155 title="Principal Purchaser" 
       class=Mandatory>
        <option></option>
        %WATWEB01.02.190.2
      </select>
    </td>
</tr>

<tr><td class=DataLabel>FSA Referral</td>
    <td class=DataField>
      <input type=text name=wattr051 size=12 value=""
       onblur="checkDate(this,'Date');"
       title="FSA Referral" tabindex=85 class=Mandatory>
      <img src=../images/DateTimeStamp.gif class=Icon date=AddForm.wattr051
       time=null>
      <img src=../images/DateLookup.gif class=Icon date=AddForm.wattr051>
    </td>
    <td class=DataLabel>FSA Date</td>
    <td class=DataField>
      <input type=text name=wattr052 size=12 class=Mandatory value=""
       onblur="checkDate(this,'Date');" title="FSA Date" tabindex=160>
      <img src=../images/DateTimeStamp.gif class=Icon date=AddForm.wattr052
       time=null>
      <img src=../images/DateLookup.gif class=Icon date=AddForm.wattr052>
    </td>
</tr>

<tr><td class=DataLabel>Date Keyed</td>
    <td class=DataField><input type=text size=12 maxlength=12 readonly
     class=ReadOnly value="%STANDARD.01.015">
    </td>
    <td class=DataLabel>Assessor Code</td>
    <td>
      <input type="text" size=10 maxlength=10 name=wattr056
       onblur="UpCase(this); ValidateHCP(18,19,wattr056,doctnam2)"
       class="Mandatory" title="Assessor Code"
       value="%WATWEB01.02.197.1" tabindex=165>
      <input type=text readonly size=25 notab name=doctnam2
       value="%WATWEB01.02.197.0">
      <img notab src="../images/SearchIcon.gif" class=Icon
       onclick="HCPSearchFrame(wattr056,doctnam2,19)">
    </td>
</tr>

<tr><td><div id=NRFCLabel1></div></td>
    <td><div id=NRFCField1></div></td>
    <td><div id=NRFCLabel2></div></td>
    <td><div id=NRFCField2></div></td>
</tr>

<tr><td><div id=NRFCLabel3></div></td>
    <td><div id=NRFCField3></div></td>
</tr>

<tr><td class=DateLabel>Operator ID</td>
    <td class=DataField>
      <input type=text size=12 maxlength=12 readonly class=ReadOnly
       value="%WATWEB01.02.310" notab>
    </td>
    <td class="DataLabel">%STANDARD.01.017.OA</td>
    <td class="DataField">
      <select name="wattx033" tabindex=170>
        <option></option>
        %STANDARD.01.007.OA
      </select>
    </td>
</tr>

<tr><td colspan=8>&nbsp;</td></tr>

<tr><td colspan=8 align=center>
      <input type=button id=subBtn class="button" value="Add" tabindex=180 
       onclick="tempDisable(this); return SubForm(this);">
      <input type=button value="Cancel" class="button" 
       tabindex=185 onclick='PatientLinkTo("watweb01.pbl",2,10,0,0,0);'>
    </td>
</tr>
</table>
</form>

<span id=InNRFCField1 style="display:none">
  <input type=text name=watsu002 id=watsu002 size=12 maxlength=12
   title="ToDate">
  <img src=../images/DateTimeStamp.gif class=Icon 
   date=AddForm.watsu002 time=null>
  <img src=../images/DateLookup.gif class=Icon date=AddForm.watsu002>
</span>

<span id=InNRFCField2 style="display:none">
  <input type=checkbox name=watsu005 id=watsu005 value="1">
</span>

<span id=InNRFCField3 style="display:none">
  <select name=watsu003 id=watsu003>
    <option></option>
    %WATWEB01.02.605.2
  </select>
</span>
<span id=blanklabel style="display:none">
</span>
<span id=acchd style="display:none">
ACC Purchase Order Number
</span>

<span id=accorderid style="display:none">
  <input type=text name=accpordn id=accpordn title="ACC Purchase Order Number" 
  maxlength=20 size=25>
</span>



<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%WATWEB01.02.003">
<input type=hidden name=admissno value="%WATWEB01.02.081">
<input type=hidden name=MenuType value="%WATWEB01.02.088">
</form>

<script type="text/javascript">
function ChkDateTime1(strtDate,endDate) {
  var strtDay  = strtDate.substring(0,2);
  var strtMon  = strtDate.substring(3,6);
  var strtYear = strtDate.substring(7,11);

  var endDay   = endDate.substring(0,2);
  var endMon   = endDate.substring(3,6);
  var endYear  = endDate.substring(7,11);

  strtMon = GetMonthNumber(strtMon);
  endMon  = GetMonthNumber(endMon);

  var strtDateTime = strtYear + strtMon + strtDay 
  var endDateTime  = endYear + endMon + endDay 
  if (endDateTime <= strtDateTime ) return false;
  return true;
}

function validateTime(){
   date1=AddForm.wattr022.value;
   date2=AddForm.wattr006.value;
   if(ChkDateTime1(date1,date2)) {
     message=" \"Preadmission Date\" cannot be before";
     message+="\"Date on List\"";
     alert(message);
     return false;
   }
  return true;
}

function validateOpDate(){
   date1=AddForm.wattr022.value;
   date2=AddForm.wattr028.value;
   if(ChkDateTime2(date1,date2)) {
     message=" \"Proposed Operation Date\" should be equal to or greater than ";
     message+="\"Preadmission Date\"";
     alert(message);
     return false;
   }
  return true;
}
 
function validateRefDOBDate(){
   date1=AddForm.d_pbdate.value;
   date2=AddForm.wattr006.value;
   if(ChkDateTime2(date1,date2)) {
     message=" \"Referral Date\" must be equal to or greater than ";
     message+="\"Date of Birth\"";
     alert(message);
     return false;
   }
  return true;
}
//
function validateCertRefDate(){
   date1=AddForm.wattr006.value;
   date2=AddForm.wattr025.value;
   if(ChkDateTime2(date1,date2)) {
     message=" \"Certainty Date\" must be equal to or greater than ";
     message+="\"Referral Date\"";
     alert(message);
     return false;
   }
  return true;
}
//
function validateCertFSARefDate(){
   date1=AddForm.wattr051.value;
   date2=AddForm.wattr025.value;
   if(ChkDateTime2(date1,date2)) {
     message=" \"Certainty Date\" must be equal to or greater than ";
     message+="\"FSA Referral Date\"";
     alert(message);
     return false;
   }
  return true;
}
//
function validateCertFSADate(){
   date1=AddForm.wattr052.value;
   date2=AddForm.wattr025.value;
   if(ChkDateTime2(date1,date2)) {
     message=" \"Certainty Date\" must be equal to or greater than ";
     message+="\"FSA Date\"";
     alert(message);
     return false;
   }
  return true;
}
//
function validateFSAFSARefDate(){
   date1=AddForm.wattr051.value;
   date2=AddForm.wattr052.value;
   if(ChkDateTime2(date1,date2)) {
     message=" \"FSA Date\" must be equal to or greater than ";
     message+="\"FSA Referral Date\"";
     alert(message);
     return false;
   }
  return true;
}
//
function validateFSARefDOBDate(){
   date1=AddForm.d_pbdate.value;
   date2=AddForm.wattr051.value;
   if(ChkDateTime2(date1,date2)) {
     message=" \"FSA Referral Date\" must be equal to or greater than ";
     message+="\"Date of Birth\"";
     alert(message);
     return false;
   }
  return true;
}
//
function ChkDateTime2(strtDate,endDate) {
  var strtDay  = strtDate.substring(0,2);
  var strtMon  = strtDate.substring(3,6);
  var strtYear = strtDate.substring(7,11);

  var endDay   = endDate.substring(0,2);
  var endMon   = endDate.substring(3,6);
  var endYear  = endDate.substring(7,11);

  strtMon = GetMonthNumber(strtMon);
  endMon  = GetMonthNumber(endMon);

  var strtDateTime = strtYear + strtMon + strtDay
  var endDateTime  = endYear + endMon + endDay
  if (endDateTime >= strtDateTime ) {
     return false;
  }
  return true;
}
//
function validateFSARefDate(){
   date1=AddForm.wattr006.value;
   date2=AddForm.wattr052.value;
   if(ChkDateTime3(date1,date2)) {
     message=" \"FSA Date\" must be equal to or less than ";
     message+="\"Referral Date\"";
     alert(message);
     return false;
   }
  return true;
}
//
function validateFSARefRefDate(){
   date1=AddForm.wattr006.value;
   date2=AddForm.wattr051.value;
   if(ChkDateTime3(date1,date2)) {
     message=" \"FSA Referral Date\" must be equal to or less than ";
     message+="\"Referral Date\"";
     alert(message);
     return false;
   }
  return true;
}
//
function ChkDateTime3(strtDate,endDate) {
  var strtDay  = strtDate.substring(0,2);
  var strtMon  = strtDate.substring(3,6);
  var strtYear = strtDate.substring(7,11);

  var endDay   = endDate.substring(0,2);
  var endMon   = endDate.substring(3,6);
  var endYear  = endDate.substring(7,11);

  strtMon = GetMonthNumber(strtMon);
  endMon  = GetMonthNumber(endMon);

  var strtDateTime = strtYear + strtMon + strtDay;
  var endDateTime  = endYear + endMon + endDay;
  if (endDateTime <= strtDateTime ) {
     return false;
  }
  return true;
}
function validateFSARefPreDOBDate(){
   date1=AddForm.d_pbdate.value;
   date2=AddForm.wattr051.value;
   if(ChkDateTime4(date1,date2)) {
     message=" \"FSA Referral Date\" must not be more than 238 days before the ";
     message+="\"Date of Birth\"";
     alert(message);
     return false;
   }
  return true;
}
//
function ChkDateTime4(dobDate,refDate) {
  var refDay  = refDate.substring(0,2);
  var refMon  = refDate.substring(3,6);
  var refYear = refDate.substring(7,11);

  var dobDay   = dobDate.substring(0,2);
  var dobMon   = dobDate.substring(3,6);
  var dobYear  = dobDate.substring(7,11);

  refMon = GetMonthNumber(refMon)-1;
  dobMon  = GetMonthNumber(dobMon)-1;

  var rDate = new Date();
  var dDate = new Date();
  rDate.setFullYear(refYear,refMon,refDay);
  dDate.setFullYear(dobYear,dobMon,dobDay);

  dDate.setDate(dDate.getDate()-238);

  if(rDate>=dDate)
  {
    return false;
  }
  return true;
}
</script>
