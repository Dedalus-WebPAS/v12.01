<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName"    content="NoContextSet.html">
<script type="text/javascript">
%START.OF.PAGE
// 01 : CTAS : add javascript functions to apply business rules
function ChkArrv() {
	if(isWhitespace(UpdateForm.opard002.value)) {
	   alert("Please enter Check In details.");
	   DFrameExit();
	}
}

// 02: DXC : Added call to validateMandatory 
function SetValue() {
	if(validateMandatory(UpdateForm)){
		UpdateForm.submit();
	}
}

function CheckTheatreTime(timefield) {
	var t = timefield.value.replace(/:/g,"");
	if (!isWhitespace(t)) {
		if (t < UpdateForm.opard002.value.replace(/:/g,"")) {
			alert(timefield.title + " cannot be earlier than Time Checked In.");
		}
	}
}
// end of change

/* 01 : CTAS : remove javascript functions
 function ChkAnaes(){
   if((!isWhitespace(UpdateForm.opdea022.value)) &&
      (isWhitespace(UpdateForm.opdea021.value))) {
      alert("Anaesthetic Prep should be entered");
      UpdateForm.opdea022.value="";
      UpdateForm.opdea021.focus();
      return;
   }
   if(!isWhitespace(UpdateForm.opdea022.value)) {
   AnaesP= UpdateForm.opdea021.value.replace(/:/g,"");  
   AnaesC= UpdateForm.opdea022.value.replace(/:/g,"");  
   if(AnaesC < AnaesP) {
     if(confirm("Anaesthetic Commenced should be greater than Anaesthetic Prep"+
       "\n Do you want to override")) {
      return;
      }
      UpdateForm.opdea022.value="";
      UpdateForm.opdea022.focus();
     }
   }  
 }
function ChkPrep() {
if(!isWhitespace(UpdateForm.opdea021.value)) {
  ArrivT= UpdateForm.opard002.value.replace(/:/g,"");
  AnaesP= UpdateForm.opdea021.value.replace(/:/g,"");
  if(AnaesP < ArrivT) {
      if(confirm("Anaesthetic Prep should be greater than Arrival Time "
               + UpdateForm.opard002.value +
       "\n Do you want to override")) {
        return;
      }
      UpdateForm.opdea021.value="";
      UpdateForm.opdea021.focus();
     }
  }
}
function ChkArrv() {
if(isWhitespace(UpdateForm.opard002.value)) {
   alert("Arrival Details Missing");
   DFrameExit();
  }
if(!isWhitespace(UpdateForm.opdea022.value)) {
 //   Bug no SV47
 //   UpdateForm.opard045.className="Mandatory";
  }
}
function SetValue(){
UpdateForm.opard041.value=UpdateForm.opdea021.value;     
UpdateForm.opard042.value=UpdateForm.opdea022.value;
UpdateForm.opard044.value=UpdateForm.opdea009.value;

if(validateMandatory(UpdateForm)){
   UpdateForm.submit();
}
}
function ManASA() {
if(!isWhitespace(UpdateForm.opdea022.value)) {
 //   Bug no SV47
//UpdateForm.opard045.className="Mandatory";
}}
*/
// end of change
</script>
<!--<script>
function TimeCheck(){

  var fieldElement;
  var theatreDate = "OPRWEB01.04.301".slice(3,8);
  var fieldName = "timecheckSTANDARD.01.044.113.064.002".replace(" ", "0");

  try{
    if(!this.event.srcElement.value){
      return;
    }
    if(this.event.srcElement.id!=fieldName){
      return;
    }
    if(!Get("discdate").value){
      return;
    }
    fieldElement = Get(fieldName);
    var dateArray = Get("discdate").value.split(" ");
    var monthNumber = new Date(Date.parse(dateArray[1] +" 1, 2012")).getMonth()+1;
    var monthString = monthNumber<10? "0" + monthNumber : "" + monthNumber
    var dDate = dateArray[2] + monthString + dateArray[0];
    if(theatreDate + fieldElement.value > dDate+Get("disctime").value){
       alert(fieldElement.title + " cannot be after the discharge date."+
               "\nDo you want to override?");
       fieldElement.value = "";
       fieldElement.focus();
    }
  }catch(e){}
}
function Get(el){return document.getElementById(el);}
</script>
-->
</head>
<body onload="PageLoad(event);ChkArrv()">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
<!-- 01 : CTAS : rename screen to Patient Into Theatre Details
Theatre Case Anaesthetic Details
-->
Patient Into Theatre Details
<!-- end of change -->
</span>

<table border="0" cellpadding="2" cellspacing="0" width="95%" align=center >
<form name=UpdateForm method=post action=oprweb01.pbl 
onsubmit='return validateMandatory(this);'>
<input type=hidden name=reportno value=5>
<input type=hidden name=template value=1>
<input type=hidden name=updatedb value="1">
<input type=hidden name=urnumber value="%OPRWEB01.04.003">
<input type=hidden name=admissno value="%OPRWEB01.04.081">
<input type=hidden name=casekeys value="%OPRWEB01.04.101">
<input type=hidden name=opsedate value="%OPRWEB01.04.302">
<input type=hidden name=currdate value="%STANDARD.01.013">
<input type=hidden name=currtime>
<!-- 03 : DXC : removed hidden values, causing IE error -->
<!--
<input type=hidden name=opard041 value=>
<input type=hidden name=opard042 value=> 
-->
<!-- end of change -->
<input type=hidden name=opard044 value=>
<input type=hidden name=prepasec value=0>
<input type=hidden name=commesec value=0>
<input type=hidden name=opard002 value="%OPRWEB01.04.402">

<!-- 01 : CTAS : add fields:  pt into theatre, anaesthetic type, 
			anaesthetic commenced, ASA score, reason for delay, sign-in -->
<!-- 03 : DXC : corrected for attribute. Was for=opard042 -->

<tr>  
    <td class=DataLabel><label for=opard064>Sign In</label></td>
    <td class=DataField><input type=text name=opard064 id=opard064
		value="%OPRWEB01.04.464" size=8 title="Sign In" 
		onblur="checkTime(this, this.title);CheckTheatreTime(this);">
      <img src="../images/DateTimeStamp.gif"
      onClick="SetCurrentDateTime(null,opard064);">
      <img src="../images/TimeLookup.gif" 
      onclick="TimeLookupFrame(opard064);"></td>
</tr>

<!-- end of change -->
<tr><td class=DataLabel><label for=opard041>Patient into Theatre</label></td>
  <td class=DataField><input type=text name=opard041 id=opard041
		value="%OPRWEB01.04.441" size=8 title="Patient into Theatre"
		onblur="checkTime(this, this.title);CheckTheatreTime(this);">
      <img src="../images/DateTimeStamp.gif"
      onClick="SetCurrentDateTime(null,opard041);">
      <img src="../images/TimeLookup.gif"
      onclick="TimeLookupFrame(opard041);"></td>
</tr>

<tr>  
    <td class=DataLabel><label for=opard042>Anaesthetic Commenced</label></td>
    <td class=DataField><input type=text name=opard042 id=opard042
		value="%OPRWEB01.04.442" class=Mandatory
       size=8 title="Anaesthetic Commenced" 
	   onblur="checkTime(this, this.title);CheckTheatreTime(this);">
      <img src="../images/DateTimeStamp.gif"
      onClick="SetCurrentDateTime(null,opard042);">
      <img src="../images/TimeLookup.gif" 
      onclick="TimeLookupFrame(opard042);"></td>
</tr>
	  
<tr><td class=DataLabel><label for=opdea003>Anaesthetic Type</label></td>
    <td class=DataField>
    <select name=opdea003 id=opdea003 title="Anaesthetic Type" >
    <option></option>
      %OPRWEB01.04.113.2
    </select></td>
</tr>
<!-- 02: DXC : ASA score mandatory -->
<tr><td class=DataLabel><label for=opard045>ASA Score</label></td>
    <td class=DataField>
    <select name=opard045 id=opard045 title="ASA Score" class="Mandatory">
    <option></option>
      %OPRWEB01.04.445.2
    </select></td>
</tr>
<!-- end of change -->
<!-- Patient Level -->
<tr><td class=DataLabel>%OPRWEB01.04.493.8</td>
    <td class=DataField>
    <select name=opard093 id=opard093 title="%OPRWEB01.04.493.8">
    <option></option>
      %OPRWEB01.04.493.2
    </select></td>
</tr>

<tr><td class=DataLabel><label for=opard087>Reason for Delay</label></td>
    <td class=DataField>
    <select name=opard087 id=opard087 title="Reason for Delay">
    <option></option>
      %OPRWEB01.04.487.2
    </select></td>
</tr>	
<!-- end of change -->

<!-- 01 : CTAS : remove standard fields
<tr><td class=DataLabel>Anaesthetic Prep Commenced</td>
  <td class=DataField>
  <input type=text name=opdea021 value="OPRWEB01.04.441" id="timecheck03"
  size=8 title="Anaesthetic Prep Commenced" onblur="checkTime(this);ChkPrep();
  CheckFutureTime(UpdateForm,document.UpdateForm.opsedate.value,opdea021);TimeCheck()">
      <img src="../images/DateTimeStamp.gif"
      onClick="SetCurrentDateTime(null,opdea021);">
      <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle
      onclick="TimeLookupFrame(opdea021);"></td>
    <td class=DataLabel>Anaesthetic Commenced</td>
    <td class=DataField>
    <input type=text name=opdea022 value="OPRWEB01.04.442" id="timecheck04"
     size=8 title="Anaesthetic Commenced" onblur="checkTime(this);ChkAnaes();ManASA();
     CheckFutureTime(UpdateForm,document.UpdateForm.opsedate.value,opdea022);TimeCheck()">
      <img src="../images/DateTimeStamp.gif"
      onClick="SetCurrentDateTime(null,opdea022);">
      <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle
      onclick="TimeLookupFrame(opdea022);"></td></tr>
	  
<tr>
    <td class=DataLabel>Anaesthetic Time Out</td>
    <td class=DataField><input type=text name=opard061 size=8 maxlength=8
       title="Anaesthetic Time Out" value="OPRWEB01.04.461" 
       onblur="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon align=absmiddle
       onClick="SetCurrentDateTime(null,opard061);">
      <img src=../images/TimeLookup.gif border=0 class=Icon align=absmiddle
       onclick="TimeLookupFrame(opard061);"></td>
</tr>

<tr><td class=DataLabel>Anaesthetic Type</td>
    <td class=DataField>
    <select name=opdea003 title="Anaesthetic Type" >
    <option></option>
      OPRWEB01.04.113.2
    </select></td>

    <td class=DataLabel>Intubated</td>
    <td class=DataField>
    <select name=opdea009 title="Intubated">
    <option></option>
    OPRWEB01.04.119.2
    </select>
    </td></tr>

<tr><td class=DataLabel>ASA Score</td>
    <td class=DataField>
    <select name=opard045 title="ASA Score">
    <option></option>
      OPRWEB01.04.445.2
    </select></td></tr>

<tr valign=top><td class=DataLabel>Preadmission and<br> Operation Notes
    <td colspan=3>
<textarea wrap=hard cols=60 rows=5 name=opcom002>OPRWEB01.04.143.002</textarea>
<a href='javascript:LookupPage(null,UpdateForm.opcom002,"Lookup_00100000_000")'>
    <img src="../images/LookupIcon.gif" border=0></a>
    </td></tr>
-->
<!-- end of change -->

<tr><td colspan=4 align=center>
    <input class="button" type=button id="opr01sub" value="OK" onclick="tempDisable(this);SetValue();">
    <input class="button" type=button value="Cancel" onclick=DFrameClose()>
    </td></tr>
</form>
</table>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OPRWEB01.04.003">
<input type=hidden name=admissno value="%OPRWEB01.04.081">
<input type=hidden name=casekeys value="%OPRWEB01.04.101">
<input type=hidden name=MenuType value="%OPRWEB01.04.088">
<input type=hidden name=opdeb001>
</form>



