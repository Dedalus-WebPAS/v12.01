<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName" content="NoContextSet.html">
%START.OF.PAGE
<script type="text/javascript">
function showACC(theForm) {
  checkInd=theForm.bkrec023.value.substr(3,5)
  if (checkInd.search(/W/g) >= 0) {
      ACCHeading.innerHTML=acchd.innerHTML;
      ACCId.innerHTML=accorderid.innerHTML;
    } else {
      ACCHeading.innerHTML=blanklabel.innerHTML;
      ACCId.innerHTML=blanklabel.innerHTML;
    }
}

function checkBookingDates(){
 if(ChkDateTime(AddForm.bkrec004,null,AddForm.bkrec039,null)){
    if(validateMandatory(AddForm)){
       if(document.getElementById('admitnow').checked){
          admission = "%WATWEB01.02.701";
          document.AddForm.redirect.value="patweb89.pbl?reportno=1&template=20"
          + "&urnumber="+document.AddForm.urnumber.value.replace(/ /g,"+")
          + "&admissno=" + admission.replace(/ /g,"+");
          document.AddForm.nextpage.value="3";
          AddForm.submit();
       }
       else{
          AddForm.submit();
       }
    }
 }
 else {
    alert("Treatment Date cannot be before Scheduled Admission Date");
 }
}
function DeleteBooking(){
    LinkUrl="patweb92.pbl?reportno=06&template=005&urnumber=" +
            document.AddForm.urnumber.value.replace(/ /g,"+") +
            "&admissno=" + document.AddForm.admissno.value.replace(/ /g,"+");
    Left=(document.body.clientWidth-700)/2;
    DFrameLink(LinkUrl,100,Left,700,250);
}
function ReasonRequired() {
if(document.AddForm.oldsch.value!=document.AddForm.bkrec004.value){
   document.AddForm.wathi001.className="Mandatory"
 } else {
   document.AddForm.wathi001.className="         "}
}
function CheckBooking() {
if (AddForm.bkrec008.value.substr(0,2)=="TH") {
  DOCTCODE=AddForm.bkrec002.value
  LinkUrl="oprweb01.pbl?reportno=2&template=3&doctcode="+DOCTCODE
  DFrameLink(LinkUrl,0,0,740,390)
 }
}
function init(){
for (var i =0 ; i < document.AddForm.bkrec015.length; i++) {
    if (trim(document.AddForm.exptward.value)==
        trim(document.AddForm.bkrec015.options[i].value.substr(0,3))){
          document.AddForm.bkrec015.selectedIndex=i;
    }
 }
}
</script>
</head>
<body onload="PageLoad(event);showACC(AddForm);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Booking Details
</span>

<form name=AddForm action=watweb01.pbl method=post
 onsubmit="return validateMandatory(this)">
<input type=hidden name=reportno value=7>
<input type=hidden name=template value=201>
<input type=hidden name=updttype value=U>
<input type=hidden name=exptward value="%WATWEB01.02.719">
<input type=hidden name=casekeys value="%WATWEB01.02.101">
<input type=hidden name=wattr004 value="%WATWEB01.02.107">
<input type=hidden name=bokrx006 value="">
<input type=hidden name=oldsch   value="%WATWEB01.02.706">
<input type=hidden name=urnumber value="%WATWEB01.02.702">
<input type=hidden name=admissno>
<input type=hidden name=nextpage>
<input type=hidden name=redirect>

<table border=0 width="95%" cellspacing="0" cellpadding="1" align=center>
<tr><td class=DataLabel>Booking Type</td>
   <td class=DataField colspan=3>
   <select name=bkrec008 onchange=CheckBooking()
    class=Mandatory title="Booking Type">
   <option></option>
    %WATWEB01.02.329
   </select></td></tr>

<!-- 01 : DXC : Change field label from 'Coded Diagnosis' to 'Procedure'
<tr><td class=DataLabel>Coded Diagnosis</td>
-->
<tr><td class=DataLabel>Procedure</td>
<!-- end of change -->
   <td class=DataField colspan=3>
   <input type=text size=12 name=bkrec035 value="%WATWEB01.02.731">
   <input type=text name=bkrec036 size=70 maxlength=80 value="%WATWEB01.02.732">
   <a href="javascript:Icd10ProSearchFrame(AddForm.bkrec035,AddForm.bkrec036)">
   <img src=../images/SearchIcon.gif class=Icon border=0 hspace=4>
   </a></td></tr>

<tr><td class=DataLabel>Diagnosis</td>
   <td class=DataField colspan=3>
   <input type=text name=bkrec037 size=70 maxlength=80 value="%WATWEB01.02.733">
   </a></td></tr>

<tr><td class=DataLabel>Pre-Assessment</td>
    <td class=DataLabel colspan=3>
    <input type=text name=bkrec006 size=12
     title="Pre-Assessment Date" value="%WATWEB01.02.708">
    <a href='javascript:DateLookupFrame(AddForm.bkrec006)'>
    <img src=../images/DateLookup.gif border=0 hspace=4 align=absmiddle></a>
    Time
    <input type=text name=bkrec007 size=6
     title="Pre-Assessment Time" value="%WATWEB01.02.709">
    <img src=../images/DateTimeStamp.gif  border=0 hspace=4 align=absmiddle
    onclick="SetCurrentDateTime(bkrec006,bkrec007);">
    <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle
    onclick="TimeLookupFrame(bkrec007);">
    </td></tr>

<tr><td class=DataLabel>Scheduled Admission</td>
    <td class=DataLabel>
    <input type=text name=bkrec004 size=12 value="%WATWEB01.02.706"
     class=Mandatory title="Scheduled Adm Date"
           onblur='ReasonRequired();checkDate(this,this.title);'>
    <a href='javascript:DateLookupFrame(AddForm.bkrec004);'>
    <img src=../images/DateLookup.gif border=0 hspace=4 align=absmiddle></a>
    Time
    <input type=text name=bkrec005 size=6 value="%WATWEB01.02.707"
    class=Mandatory title="Scheduled Admission Time">
    <img src=../images/DateTimeStamp.gif  border=0 hspace=4 align=absmiddle
    onclick="SetCurrentDateTime(bkrec004,bkrec005);">
    <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle
    onclick="TimeLookupFrame(bkrec005);">
    </td>
    <td class=DataLabel>Reason for Change</td>
    <td class=DataLabel>
    <select name=wathi001 title="Reason for Change">
    <option></option>
    %STANDARD.01.007.WD
    </select>
    </td></tr>
<tr><td class=DataLabel>Treatment Date </td>
    <td class=DataLabel colspan=3>
    <input type=text name=bkrec039 size=12 tabindex=2
     class=Mandatory title="Proposed Procedure Date"
     onblur="checkDate(this,'Date');" value="%WATWEB01.02.710">
    <img src=../images/DateLookup.gif class=Icon date=AddForm.bkrec039>
    </td></tr>
<tr><td class=DataLabel>Expected Ward</td>
    <td class=DataField>
    <select name=bkrec015 class=Mandatory title="Expected Ward">
    <option></option>
    %WATWEB01.02.302
    </select></td>
    <td class=DataLabel>Intended Length of Stay </td>
    <td class=DataLabel>
    <input type=text name=bkrec033 size=4 maxlength=4
     value="%WATWEB01.02.116">(days)</td></tr>

<tr><td class=DataLabel>Consultant</td>
    <td class=DataField colspan=3>
<input type=text name=bkrec002 size=8 maxlength=8 value="%WATWEB01.02.704.003"
 onblur="UpCase(this);validateCode(3,AddForm.bkrec002,AddForm.n_bkrec002);">
<input type=text name=n_bkrec002 size=40 value="%WATWEB01.02.704.002">
<a href="javascript:DoctorSearchFrame(AddForm.bkrec002,AddForm.n_bkrec002)">
 <img src=../images/SearchIcon.gif class=Icon border=0></a></td></tr>

<tr><td class=DataLabel>Referring Doctor</td>
    <td class=DataField colspan=3>
<input type=text name=bkrec003 size=8 maxlength=8 value="%WATWEB01.02.705.003"
 onblur="UpCase(this);validateCode(3,AddForm.bkrec003,AddForm.n_bkrec003);">
<input type=text name=n_bkrec003 size=40 value="%WATWEB01.02.705.002">
<a href="javascript:DoctorSearchFrame(AddForm.bkrec003,AddForm.n_bkrec003)">
 <img src=../images/SearchIcon.gif class=Icon border=0></a></td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.P </td>
    <td class=DataField>
    <select name=bkrec019>
    <option></option>
    %WATWEB01.02.723.2
    </select></td>
    <td class=DataLabel>Speciality</td>
    <td class=DataField>
    <select name=bkrec021>
    <option></option>
    %WATWEB01.02.725.2
    </select></td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField >
    <select name=bkrec023 onchange=showACC(AddForm);>
    <option></option>
    %WATWEB01.02.727.2
    </select></td>
    <td class=DataLabel>Model of Care</td>
    <td class=DataField >
    <select name=bokrx008>
    <option></option>
    %WATWEB01.02.408.2
    </select></td></tr>

     <tr><td><div id=ACCHeading></div></td>
         <td><div id=ACCId></div></tr>


<tr><td class=DataLabel>Admitting Point</td>
    <td class=DataField>
    <select name=bokrx003>
    <option></option>
    %WATWEB01.02.403.2
    </select></td></tr>

<tr valign=top><td class=DataLabel>Comments</td>
    <td class=DataField colspan=3>
<textarea wrap=virtual name=wattrcom cols=60 rows=4>%WATWEB01.02.161</textarea>
    </td></tr>

<tr valign=top><td class=DataLabel>Waiting List Pre-admission Notes</td>
  <td class=DataField colspan=3>
    <textarea wrap=virtual name=prenotes class=Readonly readonly
      cols=60 rows=3>%WATWEB01.02.199.009</textarea>
  </td></tr>

 <tr id="p_adm_now"><td class=DataLabel>Create Pre-admission now</td>
 <td><input type=checkbox id=admitnow checked></td>
 <td>&nbsp;</td>
 <td>&nbsp;</td>
 </tr>

<tr><td colspan=4 align=center>
    <input type=button value=Ok class="button" onclick='checkBookingDates();'>
    <input type=button value=Cancel class="button" onclick='DFrameExit()'>
    <input type=button value=Delete class="button" onclick='DeleteBooking();'>
    </td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%WATWEB01.02.003">
<input type=hidden name=admissno value="%WATWEB01.02.081">
<input type=hidden name=MenuType value="%WATWEB01.02.088">
<input type=hidden name=casekeys value="%WATWEB01.02.101">
</form>
<span id=blanklabel style="display:none">
</span>
<span id=acchd style="display:none">
ACC Purchase Order Number
</span>

<span id=accorderid style="display:none">
  <input type=text name=accpordn id=accpordn title="ACC Purchase Order Number"
         value="%WATWEB01.02.992" maxlength=20 size=25>
</span>


<script type="text/javascript">
var bookingStatus = "%WATWEB01.02.713";
if(bookingStatus=="Booked"){
   document.getElementById("p_adm_now").style.visibility="visible";
   document.getElementById("admitnow").checked=true;
}
else{
   document.getElementById("p_adm_now").style.visibility="hidden";
   document.getElementById("admitnow").checked=false;
}
</script>
