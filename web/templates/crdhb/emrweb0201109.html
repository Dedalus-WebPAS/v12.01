<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/emrweb0201101.js"></script>
<!-- 01 : CTAS : added link to CTAS custom javascript file -->
<script type="text/javascript" src="../js/ctascustom.js"></script>
<!-- end of change -->
<script type="text/javascript">
function DisplayPresentComplaintAddInfo() {
  f = document.UpdateForm;
  if (f.emcprcmp.value == "1") {
    document.getElementById('PresentComplaintAddInfo').style.display = "";
  }
  else {
    document.getElementById('PresentComplaintAddInfo').style.display = "none";
  }
}
// 01 : CTAS : constant values section
var DISCH_IND = 21;				// Cat ED Indicator 21
var DISCH_IND_SHOW_DEST = "1";	// Cat ED Indicator 21 => (1 == show destination)
// end of change

function init() {
  PageLocation="?reportno=1&template=4" +
               "&urnumber=" + PatientURN.replace(/ /g,"+") +
               "&admissno=" + PatientVIS.replace(/ /g,"+")
  if (top.content.location.href!=this.location.href) {
    top.content.location.href="emrweb02.pbl" + PageLocation }
// if (document.HiddenFields.DischargeComplete.value=="3") {
//   DisableForm(UpdateForm) ;
//   return; }

 document.UpdateForm.brcom001.value=document.UpdateForm.dummy1.value + 
                                    document.UpdateForm.dummy2.value
 document.UpdateForm.prcompad.value=document.UpdateForm.pcompadd.value;
//
//if (UpdateForm.ongoingc.value==0) {
//      document.UpdateForm.emvis100.selectedIndex=2;
//  }
//if (UpdateForm.ongoingc.value==1) {
//      document.UpdateForm.emvis100.selectedIndex=1;
//  }
//
//i=document.UpdateForm.emvis026.selectedIndex
//ind=trim(document.UpdateForm.emvis026.options[i].value.substr(14,4));
//  if (ind==4) {
//   document.all.Departure.style.display="";
//   document.all.Departure.innerHTML=document.all.ShowDeparture.innerHTML;
//  } else {
//   document.all.Departure.style.display="none";
//   document.all.Departure.innerHTML="";
//   document.all.Departure.innerHTML=document.all.ShowDeparture.innerHTML;
//   document.UpdateForm.emvis033.className="Readonly"
//   document.UpdateForm.emvis050.className="Readonly"
//   document.UpdateForm.emvis049.className="Readonly"
//   document.UpdateForm.emvis052.className="Readonly"
//  }
  CheckDepartureDateNZ();
}
//
function checktransfer() {
  alert("Check Transfer Destination.");
  alert(document.UpdateForm.emvis033.value);
}

function checkDateFunction() {
  if(isWhitespace(document.UpdateForm.emvis074.value)) {
    return;
  } else {
    checkDate(document.UpdateForm.emvis074,'Ward Allocated Date');
  }
}
function checkDept()
{
 ShowDeptStatReason();
 deceasedIndicator = document.UpdateForm.emvis026.value.substr(3,1);
 checkDeceasedEMR(deceasedIndicator);
}

function EventTimeCheckDepartureDateNZ() {
  if(ValTime(document.UpdateForm.emvis024,document.UpdateForm.emvis025)){
    CheckDepartureDateNZ();
  }
}
function DepartureTimeCheckDepartureDateNZ() {
  if(ValTime(document.UpdateForm.emvis150,document.UpdateForm.emvis151)){
    CheckDepartureDateNZ();
  }
}
// 01 : CTAS : add function showDestination()
// show Transfer destination field or not based on discharge status 
function showDestination() {
	showDest = getIndicatorValue(document.UpdateForm.emvis026, DISCH_IND);
	if (showDest == DISCH_IND_SHOW_DEST) {
		// document.getElementById("trandest").style.display = "";
		TransferDestDesc.innerHTML=ShowTransferDestDesc.innerHTML;
		TransferDestField.innerHTML=ShowTransferDestField.innerHTML;
	} else {
		// document.getElementById("trandest").style.display = "none";
		TransferDestDesc.innerHTML="";
		TransferDestField.innerHTML=ShowTransferDestBlank.innerHTML;
	}
}
// end of change
//03 : TAS : 30-MAY-2018 : Task 0856522
//Add updated valtime function to prevent future time entries to discharge time
//add updated function for discharge button that incorporates valtime
function ValTime(dateField,timeField) {
  if (!checkTime(timeField,timeField.title)) {
     return true;
  }

  SetCurrentDateTimeNoFocus(null,document.UpdateForm.currtime);
  var curDate = document.UpdateForm.currdate.value;
  var curTime = trim(document.UpdateForm.currtime.value.replace(/:/g,"")) - 0;
  var newTime = trim(timeField.value.replace(/:/g,"")) - 0;

  if (SetDateYYYYMMDD(dateField.value) == curDate) {
    if (newTime > curTime) {
      alert("Time is in the future");
      timeField.value = "";
      timeField.focus();
      return false;
    }
  }

  return true;
}
// 03 : End of change
// 06 Merge checks to integrate into discharge
function BtnUpdateClick()
{
// 04 : Merge Task 0856678  
// if (!ValTime(document.UpdateForm.emvis024,document.UpdateForm.emvis025))
//   {return};
//  if (!ValTime(document.UpdateForm.emvis150,document.UpdateForm.emvis151))
//    {return};
//  UpdateDischargeNZ();
if(CheckDepartureDateNZ()){
  //06 : Both changes merged into new function structure 
 if (!ChkDisStat()){
  return;
  }
  else{
  if(CheckDepartVsTriage()){
// 08 : TAS : 02-10-2019 : Merge Task 0880273 
//  UpdateDischargeNZ();
   UpdateDischargeNZ();
  }
}
}
}

// 04 : End of change
// 06 : End of change
// 01 : CTAS : Overloaded from ../js/emrweb0201101.js
// to correct name
function CheckDepartureDateNZ() {

  var ExtDesc = document.getElementById('ExtDesc');
  var ExtField = document.getElementById('ExtField');
  var DelayDesc = document.getElementById('DelayDesc');
  var DelayField = document.getElementById('DelayField');

  if(isWhitespace(UpdateForm.emvis024.value) ||
     isWhitespace(UpdateForm.emvis025.value)) {
     ExtDesc.style.display="none";
     ExtField.style.display="none";
     DelayDesc.style.display="none";
     DelayField.style.display="none";
     ExtField.disabled=true;
     DelayField.disabled=true;
     ExtField.className="";
     DelayField.className="";
     return true;
  }
  if(!checkDate(UpdateForm.emvis024,UpdateForm.emvis024.title)) { 
     ExtDesc.style.display="none";
     ExtField.style.display="none";
     DelayDesc.style.display="none";
     DelayField.style.display="none";
     ExtField.disabled=true;
     DelayField.disabled=true;
     ExtField.className="";
     DelayField.className="";
     return true;
  }
  if(!checkTime(UpdateForm.emvis025,UpdateForm.emvis025.title)) { 
     ExtDesc.style.display="none";
     ExtField.style.display="none";
     DelayDesc.style.display="none";
     DelayField.style.display="none";
     ExtField.disabled=true;
     DelayField.disabled=true;
     ExtField.className="";
     DelayField.className="";
     return true;
  }
  CheckEventEndDateNZ();

  if(isWhitespace(UpdateForm.emvis150.value) ||
     isWhitespace(UpdateForm.emvis151.value)){ 
     DelayDesc.style.display="none";
     DelayField.style.display="none";
     DelayField.disabled=true;
     DelayField.className="";
     return true;
  }
  if(!checkDate(UpdateForm.emvis150,UpdateForm.emvis150.title)) { 
     DelayDesc.style.display="none";
     DelayField.style.display="none";
     DelayField.disabled=true;
     DelayField.className="";
     return true;
  }
  if(!checkTime(UpdateForm.emvis151,UpdateForm.emvis151.title)) { 
     DelayDesc.style.display="none";
     DelayField.style.display="none";
     DelayField.disabled=true;
     DelayField.className="";
     return true;
  }

  if(!ChkDateTime(UpdateForm.emvis024,UpdateForm.emvis025,
                 UpdateForm.emvis150,UpdateForm.emvis151)) {
    alert("Departure date/time must be equal to or greater than " +
          "the event end date/time");
    UpdateForm.emvis151.focus();
    return false;
  }
//
   var delay="0";
//
   stime = new Date();
   stime.setFullYear(UpdateForm.emvis024.value.substr(7,4));
   monstr= UpdateForm.emvis024.value.substr(3,3)
   if (monstr=="Jan" || monstr=="JAN" || monstr=="jan") mon=00
   if (monstr=="Feb" || monstr=="FEB" || monstr=="feb") mon=01
   if (monstr=="Mar" || monstr=="MAR" || monstr=="mar") mon=02
   if (monstr=="Apr" || monstr=="APR" || monstr=="apr") mon=03
   if (monstr=="May" || monstr=="MAY" || monstr=="may") mon=04
   if (monstr=="Jun" || monstr=="JUN" || monstr=="jun") mon=05
   if (monstr=="Jul" || monstr=="JUL" || monstr=="jul") mon=06
   if (monstr=="Aug" || monstr=="AUG" || monstr=="aug") mon=07
   if (monstr=="Sep" || monstr=="SEP" || monstr=="sep") mon=08
   if (monstr=="Oct" || monstr=="OCT" || monstr=="oct") mon=09
   if (monstr=="Nov" || monstr=="NOV" || monstr=="nov") mon=10
   if (monstr=="Dec" || monstr=="DEC" || monstr=="dec") mon=11
   stime.setMonth(mon);
   stime.setDate(UpdateForm.emvis024.value.substr(0,2));
   stime.setHours(UpdateForm.emvis025.value.substr(0,2));
   stime.setMinutes(UpdateForm.emvis025.value.substr(3,2));
   stime.setSeconds(UpdateForm.emvis025.value.substr(6,2));

   etime = new Date();
   etime.setFullYear(UpdateForm.emvis150.value.substr(7,4));
   monstr= UpdateForm.emvis150.value.substr(3,3)
   if (monstr=="Jan" || monstr=="JAN" || monstr=="jan") mon=00
   if (monstr=="Feb" || monstr=="FEB" || monstr=="feb") mon=01
   if (monstr=="Mar" || monstr=="MAR" || monstr=="mar") mon=02
   if (monstr=="Apr" || monstr=="APR" || monstr=="apr") mon=03
   if (monstr=="May" || monstr=="MAY" || monstr=="may") mon=04
   if (monstr=="Jun" || monstr=="JUN" || monstr=="jun") mon=05
   if (monstr=="Jul" || monstr=="JUL" || monstr=="jul") mon=06
   if (monstr=="Aug" || monstr=="AUG" || monstr=="aug") mon=07
   if (monstr=="Sep" || monstr=="SEP" || monstr=="sep") mon=08
   if (monstr=="Oct" || monstr=="OCT" || monstr=="oct") mon=09
   if (monstr=="Nov" || monstr=="NOV" || monstr=="nov") mon=10
   if (monstr=="Dec" || monstr=="DEC" || monstr=="dec") mon=11
   etime.setMonth(mon);
   etime.setDate(UpdateForm.emvis150.value.substr(0,2));
   etime.setHours(UpdateForm.emvis151.value.substr(0,2));
   etime.setMinutes(UpdateForm.emvis151.value.substr(3,2));
   etime.setSeconds(UpdateForm.emvis151.value.substr(6,2));
   delay = etime.getTime() - stime.getTime();
   delay = Math.floor(delay / (1000));

  if (delay <= "60") {
     DelayDesc.style.display="none";
     DelayField.style.display="none";
     DelayField.disabled=true;
     DelayField.className="";
  } 
  else {
     DelayDesc.style.display="";
     DelayField.style.display="";
     DelayField.disabled=false;
     DelayDesc.disabled=false;
     DelayField.className="Mandatory";
  }
  return true;
}
// 05 : TAS : Make Referred to on departure non-mandatory if patient deceased
function checkTrans()
{
 deceasedIndicator = document.UpdateForm.emvis026.value.substr(3,1);
 var doa = (trim(document.UpdateForm.emvis026.value));
 checkDeceasedEMR(deceasedIndicator);
 if (deceasedIndicator=="D" || doa.substr(0,3)=="R02") {
        document.UpdateForm.emvis051.className="";
	} 
 else { document.UpdateForm.emvis051.className="Mandatory";
	}
}
// 06 : TAS Check that departure date/time after triage date/time
   function CheckDepartVsTriage() {
  if(isWhitespace(UpdateForm.emvis024.value) ||
     isWhitespace(UpdateForm.emvis025.value)) {
     return true;
  }
  if(!checkDate(UpdateForm.emvis024,UpdateForm.emvis024.title)) { return true};
  if(!checkTime(UpdateForm.emvis025,UpdateForm.emvis025.title)) { return true};

  
  if(isWhitespace(UpdateForm.emvis128.value) ||
     isWhitespace(UpdateForm.emvis129.value)){
     return true;
  }
  if(!checkDate(UpdateForm.emvis128,UpdateForm.emvis128.title)) { return true};
  if(!checkTime(UpdateForm.emvis129,UpdateForm.emvis129.title)) { return true};


    if(ChkDateTime(UpdateForm.emvis024,UpdateForm.emvis025,
                 UpdateForm.emvis128,UpdateForm.emvis129)) {
	alert("Treatment Completed date/time must be equal to or greater than " +
          "the Triage date/time");
	UpdateForm.emvis025.focus();
    return false;
  }
  else
  return true;
  }
// end of change
//06:  Check ED discharge - if not DOA or DNW time doctor first seen
//    must be populated
function ChkDisStat() {
    var optDis = (trim(document.UpdateForm.emvis026.value));
    var fstSen = (trim(document.UpdateForm.ptdocsee.value));
    var fstTst;
    var optDistst;
    if (fstSen != "") {
        fstTst = true;
        return true;
        }else {
        fstTst = false;
        }
    if (!optDis || optDis.substr(0,3)=="R02" || optDis.substr(0,3)=="R03") {
        optDistst = true;
        return true;
        } else {
		optDistst = false;
        }
    if (!optDistst && !fstTst) {
                alert("First doctor seen date required for discharge");
        return false;
        }
}
</script>
</head>
%START.OF.PAGE
<!-- 01 : CTAS : call showDestination() in body.onload
<body onload="PageLoad(event);"checkDepartureDateNZ();>
-->
<body onload="PageLoad(event);showDestination();
	CheckDepartureDateNZ();checkTrans();DisplayPresentComplaintAddInfo();">
<!-- end of change -->
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%EMRWEB02.01.003";
PatientVIS="%EMRWEB02.01.081";
PatientNAM="%EMRWEB02.01.002";
PatientSTA="%EMRWEB02.01.086.078";
PatientALT="%EMRWEB02.01.084";
PatientSEX="%EMRWEB02.01.019";
PatientDOB="%EMRWEB02.01.020";
PatientAGE="%EMRWEB02.01.021";
PatientLOC="%EMRWEB02.01.083";
PatientPRI="%EMRWEB02.01.086.066.1";
PatientUNT="%EMRWEB02.01.066.0";
PatientIND="%EMRWEB02.01.086.091";
GpCOD="%EMRWEB02.01.086.084.001";
GpNAM="%EMRWEB02.01.086.084.081";
GpPRAC="%EMRWEB02.01.086.085.001";
GpPRACCNT="%EMRWEB02.01.086.085.002";
GpPRACNAM="%EMRWEB02.01.086.085.005";
PatientARR="%EMRWEB02.01.101.0 %EMRWEB02.01.102";
PatientSEE="%EMRWEB02.01.130.0 %EMRWEB02.01.131";
PatientTRI="%EMRWEB02.01.103.3";
PatientECLC="%EMRWEB02.01.484.1";
PatientCLH="%STANDARD.01.017.CL";
PatientEHFT="%EMRWEB02.01.485";
InsertEmergencyHeader();
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<table width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td class=HeadingCell align=center>
    Emergency Patient Discharge </td></tr>
</table>
<!-- 01 : CTAS : Move table tag inside form
<table width=95% align=center border=0 cellspacing=0 cellpadding=1>
-->
<form name=UpdateForm action=emrweb02.pbl method=post style="margin:0">
 <input type=hidden name=reportno value="01">
 <input type=hidden name=template value="001">
 <input type=hidden name=formactn>
 <input type=hidden name=updttype>
 <input type=hidden name=emvis133>
 <input type=hidden name=admissno value="%EMRWEB02.01.081">
 <input type=hidden name=updateky value="%EMRWEB02.01.404">
 <input type=hidden name=urnumber value="%EMRWEB02.01.003">
 <input type=hidden name=emvis118 value="%EMRWEB02.01.003">
 <input type=hidden name=nextpage value="2">
 <input type=hidden name=redirect value="%EMRWEB02.01.001.emrweb02.01.109">
 <input type=hidden name=chkdot value="%EMRWEB02.01.107.001">
 <input type=hidden name=chknur value="%EMRWEB02.01.164.1">
 <input type=hidden name=dummy1
  value="%EMRWEB02.01.104%EMRWEB02.01.105%EMRWEB02.01.174">
 <input type=hidden name=dummy2
  value="%EMRWEB02.01.175%EMRWEB02.01.176%EMRWEB02.01.177">
 <input type=hidden name=pcompadd
  value="%EMRWEB02.01.955.023.0">
 <input type=hidden name=waittime value="%EMRWEB02.01.701">
 <input type=hidden name=loadflag >
 <input type=hidden name=reloadfg value="%EMRWEB02.01.446">
 <input type=hidden name=ongoingc value="%EMRWEB02.01.260.1">
 <input type=hidden name=ctypeadm value="%EMRWEB02.01.252">
 <input type=hidden name=calcwait value="1">
 <input type=hidden name=ptdocsee value="%EMRWEB02.01.130.0 %EMRWEB02.01.131">
 <input type=hidden name=ptnursee value="%EMRWEB02.01.128.0 %EMRWEB02.01.129">
 <input type=hidden name=pmpxi067 value="%EMRWEB02.01.667.0">
 <input type=hidden name=ptcnhdps value="%STANDARD.01.025.080.250.1.1">
 <input type=hidden name=emvis147 value="0">
 <input type=hidden name=emcnevrm value="%STANDARD.01.025.089.226.0.4">
 <input type=hidden name="d_emvis024" value="%EMRWEB02.01.124.0">
 <input type=hidden name="d_emvis025" value="%EMRWEB02.01.125">
 <input type=hidden name="d_emvis026" value="%EMRWEB02.01.126.1">
 <input type=hidden name=updfld01 value="">
 <input type=hidden name=reasfc01 value="">
 <input type=hidden name=updfld02 value="">
 <input type=hidden name=reasfc02 value="">
 <input type=hidden name=currdate value="%STANDARD.01.013">
 <input type=hidden name=currtime value="">
<!-- 06 : Add values to use in triage vs discharge check -->
 <input type=hidden name=emvis128 value="%EMRWEB02.01.162.0">
 <input type=hidden name=emvis129 value="%EMRWEB02.01.163">		   
 <input type=hidden name=emcprcmp id=emcprcmp
        value="%STANDARD.01.025.122.051.1.1">

 <!-- 01 : CTAS : Move table tag inside form -->
<table width=95% align=center border=0 cellspacing=0 cellpadding=1>
<!-- end of change -->
<tr valign=top><td>
<table width=100% border=0 cellspacing=0 cellpadding=2>
<tr valign=top><td class=DataLabel width=15%>Presenting Complaint </td>
    <td><input type=text name=emvis060 class=ReadOnly max=3 size=3 
	value="%EMRWEB02.01.220.1" readonly>
        <input type=text name=v060name class=ReadOnly value="%EMRWEB02.01.220.0" readonly>
    </td>
	<!-- 01 : CTAS : add field label:  triage notes
    <td colspan=2><textarea name=brcom001 readonly cols=50 rows=4></textarea>
	-->
	<!-- 07 : TAS : Make triage notes display as ready-only -->
	<td class=DataLabel>Triage Notes</td>
    <td><textarea name=brcom001 class=Readonly readonly cols=50 rows=6
         title="Triage Notes"></textarea>
	<!-- end of change -->
    </td></tr>
<tr valign=top id=PresentComplaintAddInfo><td></td>
    <td></td>
    <td></td>
    <td colspan=2><textarea name=prcompad readonly cols=50 rows=6
     class="Readonly" title="Triage Notes - Additional Information">
    </textarea>
    </td></tr>
<!-- 01 : CTAS : Move Primary Diagnosis, rename -->
<tr>
	<td class=DataLabel>Provisional Diagnosis</td>
    <td><input type=text name=dummy5 title="Provisional Diagnosis"
         size=52 value="%EMRWEB02.01.187" class=ReadOnly readonly>
    </td>
	<td></td><td></td>
</tr>
<!-- end of change -->
<!-- 01 : CTAS : rename fields 
<tr><td class=DataLabel>Event End Date </td>
    <td width=30%>
	<input type=text size=12 name=emvis024
     class="Mandatory PastDate" title="Event End Date" value="EMRWEB02.01.124.0"
     onblur=""> 
-->
<!-- 03 : TAS : Add valtime function -->
<tr><td class=DataLabel>Treatment Completed</td>
    <td width=30%><input type=text size=12 name=emvis024
     class="Mandatory PastDate" title="Treatment Completed Date" value="%EMRWEB02.01.124.0"
     onblur=""
     onchange="if(ValTime(emvis024,emvis025)){CheckDepartureDateNZ();CheckDepartVsTriage();}">
<img notab src=../images/DateLookup.gif class=Icon
      onclick="DateLookupFrame(emvis024,CheckDepartureDateNZ);CheckDepartVsTriage();">
     <input class=Mandatory type=text name=emvis025
     size=8 value="%EMRWEB02.01.125" title="Event End Time"
     onchange="if(ValTime(emvis024,emvis025)){CheckDepartureDateNZ();CheckDepartVsTriage();}">
     <img class=Icon src="../images/erase.gif"
	 onclick="clrFields(emvis024,emvis025);CheckDepartureDateNZ();CheckDepartVsTriage();">
	 <img notab src=../images/DateTimeStamp.gif class=Icon
     onclick="SetCurrentDateTime(emvis024,emvis025);CheckDepartureDateNZ();CheckDepartVsTriage()">
     <img notab src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(emvis025,CheckDepartureDateNZ);CheckDepartVsTriage();">
  </td>
  <td class=DataLabel id="ExtDesc" disabled=true>%STANDARD.01.017.RX</td>
  <td>
    <select class="Mandatory" name=emvis152 title="%STANDARD.01.017.RX" disabled=true id="ExtField">
      <option></option>
      %EMRWEB02.01.193.2
    </select>
  </td>
</tr>					   

<!-- 01 : Move Event End Reason 
Rename field to Treatment Completed Reason -->
<tr>
	<td class=DataLabel>Treatment Completed Reason</td>
    <td><select name=reason07 title="Treatment Completed Reason" disabled
         onchange="DeptDateReason();">
         <option></option>
         %STANDARD.01.007.FW
        </select></td>
	<td colspan=2></td>
</tr>
<!-- end of change -->
	
<tr><td class=DataLabel>Departure Date </td>
    <td width=30%>
	<input type=text size=12 name=emvis150 class="Mandatory PastDate" onblur=""
		title="Departure Date" value="%EMRWEB02.01.191" onchange="checkDate(this,'Date');
			if(ValTime(emvis150,emvis151)){CheckDepartureDateNZ();}">
        <img notab src=../images/DateLookup.gif class=Icon 
			onclick="DateLookupFrame(emvis150,DepartureTimeCheckDepartureDateNZ);">
        <input class=Mandatory type=text name=emvis151 size=8 title="Departure Time" 
		 value="%EMRWEB02.01.192"
         onchange="if(ValTime(emvis150,emvis151)){CheckDepartureDateNZ();}">
    <img class=Icon src="../images/erase.gif"
     onclick="clrFields(emvis150,emvis151);CheckDepartureDateNZ();">
    <img notab src=../images/DateTimeStamp.gif class=Icon
    onclick="SetCurrentDateTime(emvis150,emvis151);CheckDepartureDateNZ();">
    <img notab src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(emvis151,DepartureTimeCheckDepartureDateNZ);">
    <img notab src=../images/SwapIcon.gif class=Icon
     onclick="SetDepartureDateNZ();CheckDepartureDateNZ();">
  </td>
  <td class=DataLabel id="DelayDesc" disabled=true>%STANDARD.01.017.RY</td>
  <td>
    <select class="Mandatory" name=emvis153 title="%STANDARD.01.017.RY" disabled=true id="DelayField">
      <option></option>
      %EMRWEB02.01.194.2
    </select>
  </td>
    </tr>
<!-- 01 : CTAS : rename fields
<tr><td class=DataLabel>Departure Status</td>
    <td><select name=emvis026
        class=Mandatory title="Departure Status" 
        onchange="checkDept();">
        <option></option>
        EMRWEB02.01.126.2
        </select></td>
-->
<!-- 05: TAS : WP2-453 Add new function checkTrans-->
<tr><td class=DataLabel>%STANDARD.01.017.ED</td>
    <td><select name=emvis026 class=Mandatory 
		onchange="checkTrans();checkDept();showDestination();"
		title="%STANDARD.01.017.ED">
        <option></option>
        %EMRWEB02.01.126.2
        </select></td>
<!-- end of change -->
	<!-- 01 : CTAS : Move field below
	Add conditional display for Transfer Dest
    <td class=DataLabel width=15%>Departure Status Reason</td>
    <td><select name=reason10 title="Departure status reason" disabled
         onchange="DeptStatReason();">
         <option></option>
         STANDARD.01.007.FW
        </select></td>
	-->
	<td class=DataLabel><div id=TransferDestDesc></div></td>
    <td><div id=TransferDestField></div></td>
	<!-- end of change -->
</tr>

<!-- 01 : CTAS : Move Departure Status Reason here -->
<tr>
	<td class=DataLabel width=15%>%STANDARD.01.017.ED Reason</td>
    <td><select name=reason10 title="%STANDARD.01.017.ED Reason" disabled
         onchange="DeptStatReason();">
         <option></option>
         %STANDARD.01.007.FW
        </select></td>
	<td colspan=2></td>
</tr>
<!-- end of change -->

<tr><td class=DataLabel>Referred to on Departure</td>
    <td><select class=Mandatory name=emvis051
         title="Referred to on Departure" >
        <option></option>
        %EMRWEB02.01.211.2
        </select></td>
	<!-- 01 : CTAS : Move Event End Reason up
    <td class=DataLabel>Event End Reason</td>
	
    <td><select name=reason07 title="Departure date/time reason" disabled
         onchange="DeptDateReason();">
         <option></option>
         STANDARD.01.007.FW
        </select></td>
	-->
	<td></td><td></td>
	<!-- end of change -->
 </tr>

 <!-- 01 : CTAS : Remove table tag, retain only one table
 Remove un-used div
</table>
<div id=Departure></div>
<table width=100% border=0 cellspacing=0 cellpadding=2>
end of change -->

<tr>
	<!-- 01 : CTAS : Add Smoking Status -->
	<td class=DataLabel><label for=emvis047>%STANDARD.01.017.A7</label></td>
	<td><select name=emvis047 id=emvis047
		class="Mandatory" title="%STANDARD.01.017.A7">
		<option></option>
		%EMRWEB02.01.207.2
	</select></td>
	<!-- end of change -->
	<td class=DataLabel width=15%>Unit Request Date</td>
    <td class=DataLabel width=30%><select name=emvis073>
         %EMRWEB02.01.233.1
        </select>
    Time
    <input type="text" name=emvis083 size="8" value="%EMRWEB02.01.243">
    <img src="../images/DateTimeStamp.gif" class=Icon
     date=UpdateForm.emvis073 time=UpdateForm.emvis083>
    <img src=../images/TimeLookup.gif class=Icon time=UpdateForm.emvis083>
    </td>
	<!-- 01 : CTAS : Remove field
    <td class=DataLabel width=15%>Ward Allocated Date</td>
    <td class=DataLabel><select name=emvis074 title="Ward Allocated Date"
         onchange="checkDateFunction();">
         EMRWEB02.01.234.1
    </select>
    Time
   <input type="text" name=emvis084 size="8" title="Bed Ready time" 
      value="EMRWEB02.01.244" onblur="checkTime(emvis084,'Bed Ready Time')">

    <img src="../images/DateTimeStamp.gif" class=Icon
     date=UpdateForm.emvis074 time=UpdateForm.emvis084>
    <img src=../images/TimeLookup.gif class=Icon time=UpdateForm.emvis084>
    </td>
	end of change -->
</tr>
<tr>
	<!-- 01 : CTAS : Remove field, Add Alcohol Involved
	<td class=DataLabel>Expected Unit</td>
    <td><select name=emvis134 class=SelectBig title="Expected Unit">
        <option></option>
        EMRWEB02.01.173.2
        </select></td>
	-->
	<!-- 02 : DXC : removed call to updateAlcoholInvolvedStatus() -->
	 <td>Alcohol Involved</td>
	  <td>
		<select name=emvis067 id=emvis067
			title="Alcohol Involved" class="Mandatory">
		  <option></option>
		  %EMRWEB02.01.227.2
		</select>
	  </td>	
	<!-- end of change -->
    <td class=DataLabel>Expected Ward</td>
    <td class=DataLabel>
    <select name=emvis116 class=SelectBig title="Expected Ward">
<option></option>
      %EMRWEB02.01.149.2
         </select>
    </td></tr>

<!-- 01 : CTAS : Move Primary Diagnosis up, Remove Claim Type -->
<!-- 02 : DXC : Reinstated Claim type -->
<tr> <!--<td class=DataLabel>Primary Diagnosis</td>
    <td><input type=text name=dummy5 title="Primary Diagnosis"
         size=52 value="EMRWEB02.01.187" class=ReadOnly readonly>
    </td>-->
    <td class=DataLabel>%STANDARD.01.017.CL</td>
    <td><select class="Mandatory SelectMed" name=emvis008 
         title="%STANDARD.01.017.CL">
    <option></option>
    %EMRWEB02.01.108.2
    </select></td>
    </tr>
<!-- end of change -->
<!-- 01 : CTAS : Remove HP
<tr>
  <td>STANDARD.01.017.HP</td>
  <td>
    <select name=emvis160 class=Mandatory>
      <option value=""></option>
      EMRWEB02.01.281.2
    </select>
  </td>
end of change -->
<!-- Alcohol Involved - CAR 312772/TSK 0817059 -->
<!--
  <td>STANDARD.01.017.es</td>
  <td>
    <select name=emvis067 class=Mandatory>
      <option value=""></option>
      EMRWEB02.01.227.2
    </select>
  </td>
-->
<!-- 01 : CTAS : Comment tags
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
end of change -->

<!-- 01 : CTAS : add field Surveillance -->
<tr>
	<td></td><td></td>
	<td class=DataLabel><label for=emvis069>%STANDARD.01.017.eu</label></td>
    <input type=hidden name=name_emvis069>
    <td><select name=emvis069 title="%STANDARD.01.017.eu" 
		id=emvis069 class="SelectBig">
        <option></option>
        %EMRWEB02.01.229.2
        </select>
	</td>	
</tr>
<!-- end of change -->

<tr><td colspan=4 align=center><br>
    <input type=button value="Update" class="button" 
         onclick="BtnUpdateClick()">
    <input type=button value="Cancel" class="button" 
     onclick='fnPatientLink("%EMRWEB02.01.003","%EMRWEB02.01.081");'>
</td></tr>
</table>
<!-- 01 : CTAS : Close tags -->
</td></tr>
<!-- end of change -->
</table>
</form>

<!-- 01 : CTAS : hide unused fields
<span id=ShowDeparture style="display:none;">
<table width=100% border=0 cellspacing=0 cellpadding=2>
<tr><td class=DataLabel width=15%>Transfer Destination</td>
    <td width=30%><input type=text size=6 maxlength=6 name=emvis033
         title="Transfer Destination" value="EMRWEB02.01.133.1"
         onchange="validateCode(9,emvis033,name_emvis033n);">
        <input type=text size=30 name=name_emvis033n readonly
         value="EMRWEB02.01.133.0">
        <img src=../images/SearchIcon.gif 
         onClick="TransferSourceFrame(emvis033,name_emvis033n);">
        </td>
    <td class=DataLabel width=15%>Reason for Transfer</td>
    <td><select class=SelectBig name=emvis052>
        <option></option>
        EMRWEB02.01.212.2
        </select></td></tr>

<tr><td class=DataLabel>Escort Source</td>
    <td><select class="Mandatory SelectBig" title="Escort Source"
         name=emvis050 >
        <option></option>
         EMRWEB02.01.210.2
        </select></td>
    <td class=DataLabel>Transport Mode</td>
    <td><select class=SelectBig name=emvis049>
        <option></option>
        EMRWEB02.01.209.2
        </select></td></tr>
</table>
</span>
end of change -->

<form name=HiddenFields method=get>
<input type=hidden name=DischargeComplete value="%EMRWEB02.01.147">
<input type=hidden name=HospitalAdmission value="%EMRWEB02.01.148">
<input type=hidden name=ctypmand value="%EMRWEB02.01.460.   77">
</form>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=emrgflag value="Y">
<input type=hidden name=nextpage value="4">
<input type=hidden name=MenuType value="11">
</form>

<!-- 01 : CTAS : Conditional Display of Transfer Destination -->
<span id=ShowTransferDestBlank style="display:none">
  <input type=hidden name=emvis033 value=" ">
</span>

<span id=ShowTransferDestDesc style="display:none">
  Transfer Destination
</span>

<span id=ShowTransferDestField style="display:none">
	<input type=text size=6 maxlength=6 name=emvis033 id=emvis033
         title="Transfer Destination" value="%EMRWEB02.01.133.1"
         onchange="validateCode(9,emvis033,name_emvis033n);"
		 class="Mandatory">
        <input type=text size=30 name=name_emvis033n readonly
         value="%EMRWEB02.01.133.0"
		 class="Readonly">
    <img src=../images/SearchIcon.gif 
         onClick="TransferSourceFrame(emvis033,name_emvis033n);">
</span>
<!-- end of change -->

<script type="text/javascript">
// 01 : CTAS : Remove HP
/*
for(var i=0; i<document.UpdateForm.emvis160.length; i++){
  if(document.UpdateForm.emvis160.options[i].value.substring(0,3)=="%EMRWEB02.01.281.0"){
     document.UpdateForm.emvis160.selectedIndex=i;
     break;
  }
}
*/
// end of change
</script>

</body></html>
