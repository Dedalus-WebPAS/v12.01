<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">										 
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
function UpdatePatient(UrNumber,Admissno,CrdNote) {
  if (CrdNote == 1) {
    alert("Patient has got a Credit Note, Can Not Cancel Preadmission.");
    return;
  }

  linkURL="patweb89.pbl?reportno=01&template=010&urnumber=" + UrNumber +
          "&admissno=" + Admissno;
  DFrameLink(linkURL,100,200,400,100); 
}
function NewPreadmit() {
   linkUrl="patweb90.pbl?reportno=1&template=201"
   DFrameLink(linkUrl,0,50,1100,450)
}
function LinkPatient(linkurl) {
  SetCookiePath("PreAdmList");
  location.href=linkurl;
}
function LoadCookiePath() {
 Path=GetContentCookie("PreAdmList");
 if (Path!="unknown") {
   getTop().content.location.href=Path
 } 
 ExpireCookiePath("PreAdmList")
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - Link
//  1 - Patient
//  2 - U/R
//  3 - Admission Date & Time
//  4 - Expected Ward
//  5 - Sex
//  6 - Age
//  7 - Doctor
//  8 - Reason For Admission
//                         9 - Update Patient js link        ??????????
//  9 - Unit                   
// 10 - Ward                   
// 11 - Admission Point         
// 12 - Parent Staying
// 13 - Update Patient Link
// 14 - Cancel - Folder colour suffix
// 15 - Admission Type
// 16 - Expected Ward/Bed
// 17 - Patient Link  
// 18 - Doctor - link to DoctorView
// 19 - NZ full Procedure Description
// 20 - Visit Icons (Alternate Id & Legacy Visits)
// 21 - Patient Alert Icons (Patient Alerts & Hearing Alert)
// 22 - LOS
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",35,35);
 t.addColumn("Name","ImageText",1,1,"left","PatientFolder","17",160,14)
 t.addColumn("Adm.Date","DateTime",3,3,"left","","",70)
 t.addColumn("Sex","String",5,5,"left","","",40)
 t.addColumn("Age","String",6,6,"center","","",40)
 t.addColumn("Reason For Admission","String",8,8,"left","","",120)
 t.addColumn(document.PatientLinks.admtype.value,"String",15,15,"left","","",70)
 t.addColumn("Adm. Point","String",11,11,"left","","",50)
 t.addColumn("Post-op Ward","String",4,4,"left","","",50)
 t.addColumn("Cancel","IconLink",14,14,"left","MaintenanceIcon.gif","13",40)
 AddTableRows()
 TableOutput(1,2);    // Order Column,Asc Dsc
 break; }
case 1: {
 t = new Table(1,0,2,"100%","center",35,35);
 t.addColumn("Name","ImageText",1,1,"left","PatientFolder","17",155,14)
 t.addColumn("UR","String",2,2,"left","","",35)
 t.addColumn("Adm.Date","DateTime",3,3,"left","","",70)
 t.addColumn("Sex","String",5,5,"left","","",35)
 t.addColumn("Age","String",6,6,"center","","",40)
 t.addColumn("Doctor","String",7,7,"left nowrap","","",100)
 t.addColumn("Reason For Admission","String",8,8,"left","","",90)
 t.addColumn(document.PatientLinks.admtype.value,"String",15,15,"left","","",70)
 t.addColumn("Adm. Point","String",11,11,"left","","",40)
 AddTableRows()
 TableOutput(2,2);    // Order Column,Asc Dsc
 break; }
 }
}
function SelectSubmit() {
  document.SelectPeriod.submit();
}

function isReadOnly() {
	return (document.PatientLinks.occGroup.value.replace(/ /g,"") === "GE");
}

function SetReadOnly() {
	if (isReadOnly()) {
		document.getElementById("btnPreAdmis").style.visibility = "hidden";
		var anchors = document.links;
		for (var i=0; i<anchors.length; i++) {
			if (anchors[i].getAttribute("href").indexOf("LinkPatient") != -1) {
				anchors[i].setAttribute("href", "javascript:void(0);");
				//anchors[i].style.visibility = "hidden";
			} else if (anchors[i].getAttribute("href").indexOf("UpdatePatient") != -1) {
				anchors[i].setAttribute("href", "javascript:void(0);");
				anchors[i].style.visibility = "hidden";
			}
		}
	}
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);LoadCookiePath();SetReadOnly();">

<div id=HeadingSection>
<form name=SelectPeriod action=patweb92.pbl method=get style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=1>
<input type=hidden name=viewtype value="%PATWEB92.04.011">

<table cellpadding=1 cellspacing=1 bgcolor=#CCCCCC border=1 width=100%>
<tr><td>
<table cellpadding=0 cellspacing=0 bgcolor=#CCCCCC border=0 width=100%>
  <tr><td>
    <a href=javascript:InitTable(0)>
    <img src=../images/TableViewIcon.gif class=Icon
     alt="Default View" title="Default View" border=0></a>
    <a href=javascript:InitTable(1)>
    <img src=../images/TableViewIcon.gif class=Icon 
     alt="Show Doctors" title="Show Doctors" border=0></a>
    <input type=button value="<<" class=SmallButton style="width:20px"
     onclick='location.href="%PATWEB92.04.002"'>
    %PATWEB92.04.007
    <input type=button value=">>" class=SmallButton style="width:20px"
     onclick='location.href="%PATWEB92.04.001"'>
    <input type=button id=btnPreAdmis class="button" value="New Pre-Admiss" 
     style="width:100px" onclick="NewPreadmit();">
    </td>
   <td align=right>
    <a href='javascript:SelectDateFrame();'>
    <img src="../images/DateLookup.gif" class=Icon
     alt="Select Date" title="Select Date" ></a>
    <a href='javascript:SelectView("0");'>
    <img src=../images/DayIcon.gif class=Icon
     alt="View Today" title="View Today" ></a>
    <a href='javascript:SelectView("1");'>
    <img src=../images/WeekIcon.gif class=Icon 
     alt="View This Week" title="View This Week" ></a>
    <a href='javascript:SelectView("2");'>
    <img src=../images/MonthIcon.gif class=Icon 
     alt="View This Month" title="View This Month" ></a>
    </td></tr>
</table>
<table cellpadding=0 cellspacing=0 bgcolor=#CCCCCC border=0 width=100%>
 <tr>
  <td class=DataLabel align=center> Admitting Point
   <select name=adpoints class=SelectMed onchange="SelectSubmit();">
   <option value="  ">All</option>
    %PATWEB92.04.015.2
   </select></td>
  <td class=DataLabel align=center> Post-op Ward
   <select name=wardcode class=SelectMed onchange="SelectSubmit();">
   <option value="  ">All</option>
   %PATWEB92.04.013
   </select></td> 
</table>
</td></tr>
</table>
</form>
</div>

<form name=LinkForm method=post action=patweb89.pbl style="margin:0">
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="">
</form>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=admtype value="%STANDARD.01.017.A ">
<input type=hidden name=occGroup id=occGroup value="%STANDARD.01.012.1">
</form>

<div id=TableLocation></div>
<script type="text/javascript">
function AddTableRows() {
%PATWEB92.04.008.patweb89.04.002
}
</script>
