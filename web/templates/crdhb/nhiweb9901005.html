<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/nhiesam.js"></script>
<!-- The json2.js file is a gap-filler for older browsers that do not 
     natively support JSON. This will not be needed when IE is 
     finally retired. PMc 20170529 -->
<script type="text/javascript" src="../js/json2.js"></script>
<script type="text/javascript" src="../js/IBA_Category_C_.js"></script>
<script type="text/javascript">
function checkPreferred(field){
if(field=="1"){
  if(document.NHIUpdate.ptcnnmpr.value=="1") {
    document.getElementById("savvloc2").style.display="none";
    document.getElementById("savvloc3").style.display="none";
    document.NHIUpdate.saveloc2.type="hidden";
    document.NHIUpdate.saveloc2.checked=false;
    document.NHIUpdate.saveloc3.type="hidden";
    document.NHIUpdate.saveloc3.checked=false;
  }
 }
if(field=="2"){
  if(document.NHIUpdate.ptcnnmpr.value=="1") {
    document.getElementById("savvloc2").style.display="inline";
    document.getElementById("savvloc3").style.display="none";
    document.NHIUpdate.saveloc2.type="checkbox";
    document.NHIUpdate.saveloc2.checked=false;
    document.NHIUpdate.saveloc3.type="hidden";
    document.NHIUpdate.saveloc3.checked=false;
  }
}
if(field=="3"){
  if(document.NHIUpdate.ptcnnmpr.value=="1") {
    document.getElementById("savvloc2").style.display="none";
    document.getElementById("savvloc3").style.display="inline";
    document.NHIUpdate.saveloc2.type="hidden";
    document.NHIUpdate.saveloc2.checked=false;
    document.NHIUpdate.saveloc3.type="checkbox";
    document.NHIUpdate.saveloc3.checked=false;
  }
 }
}
function subUpdate(){
  if(document.NHIUpdate.saveloc2.checked==true || document.NHIUpdate.saveloc3.checked==true) {
    document.NHIUpdate.savelocl.value="Y";
  }
  document.NHIUpdate.ptmas021.value=document.NHIUpdate.dtmas021.value;
  UpdateForm();
}
function submitSearch(){
  document.nhisrch.nzsrh004.value=document.NHIUpdate.nhmas001.value;
  document.nhisrch.nzsrh005.value=document.NHIUpdate.nhmas002.value;
  document.nhisrch.nzsrh006.value=document.NHIUpdate.nhmas011.value;
  for (var i =0 ; i < document.NHIUpdate.nhmas015.length; i++) {
    if (document.NHIUpdate.nhmas015[i].checked=="1" ) {
      document.nhisrch.nzsrh009.value=document.NHIUpdate.nhmas015[i].value;
    }
  }
  document.nhisrch.submit();
}
function UpCase(str){
  str.value=str.value.toUpperCase();
  str.value=str.value.replace(/ *$/,"");
}
function FormatGiven() {
UpCase(document.NHIUpdate.nhmas002)
UpCase(document.NHIUpdate.nhmas003)
UpCase(document.NHIUpdate.nhmas004)
document.NHIUpdate.fgiven.value=document.NHIUpdate.nhmas002.value + " " +
                                document.NHIUpdate.nhmas003.value + " " +
                                document.NHIUpdate.nhmas004.value
}
function FormatAddress() {
UpCase(document.NHIUpdate.nhmas006)
UpCase(document.NHIUpdate.nhmas007)
UpCase(document.NHIUpdate.nhmas008)
UpCase(document.NHIUpdate.nhmas009)
UpCase(document.NHIUpdate.nhmas010)
document.NHIUpdate.fadd1.value=document.NHIUpdate.nhmas006.value 
document.NHIUpdate.fadd2.value=document.NHIUpdate.nhmas007.value
document.NHIUpdate.fadd3.value=document.NHIUpdate.nhmas008.value
document.NHIUpdate.fadd4.value=document.NHIUpdate.nhmas009.value
AddLine4 = document.NHIUpdate.nhmas009.value
AddLine5 = document.NHIUpdate.nhmas010.value
if (document.NHIUpdate.nhmas010.value != " ") {
 if (document.NHIUpdate.fadd4.value == "") {
   document.NHIUpdate.fadd4.value = document.NHIUpdate.nhmas010.value  }
 else {
   document.NHIUpdate.fadd4.value += ", " + document.NHIUpdate.nhmas010.value }
}
}
//
// If Save Alia Checked then Just Submit the Form
//
function UpdateForm() {

UpCase(document.NHIUpdate.nhmas001)
UpCase(document.NHIUpdate.nhmas002)
UpCase(document.NHIUpdate.nhmas003)
UpCase(document.NHIUpdate.nhmas004)
UpCase(document.NHIUpdate.nhmas006)
UpCase(document.NHIUpdate.nhmas007)
UpCase(document.NHIUpdate.nhmas008)
UpCase(document.NHIUpdate.nhmas009)
UpCase(document.NHIUpdate.nhmas010)

if(document.NHIUpdate.dtmas021.value.substr(3,1)=="1"){
    document.NHIUpdate.nhmas014.value="Y"}
  else if (document.NHIUpdate.dtmas021.value.substr(3,1)=="2"){
    document.NHIUpdate.nhmas014.value="N"}

updateFormFlag=checkString(document.NHIUpdate.nhmas001,"Surname") &&
               checkString(document.NHIUpdate.nhmas002,"Given Name") &&
               checkString(document.NHIUpdate.nhmas011,"Date of Birth") &&
               checkString(document.NHIUpdate.nhmas006,"Address Line 1") &&
               checkGender()

if(updateFormFlag){ 
   document.NHIUpdate.dtmas021.disabled=false;
   SubmitHidden(document.NHIUpdate);  
}
}
function checkGender() {
GenderSet=false
for ( i=0 ; i < document.NHIUpdate.nhmas015.length ; i++ ) {
  if (document.NHIUpdate.nhmas015[i].checked) {
     GenderSet=true }
  }
if (GenderSet==false) { warnEmpty(document.NHIUpdate.nhmas001,"Gender")  }
return(GenderSet)
}
function ShowPreAllocated() {
  if(document.NHIUpdate.asprenhi.checked==true) {
    PreAllocatedNHI.innerHTML=ShowPreAllocatedNHI.innerHTML;
  } else {
    PreAllocatedNHI.innerHTML="";
  }
}
function motherAdmitted() {
  p=document.NHIUpdate;
  if(isWhitespace(p.d_mumadmis.value)) {
    alert("Mother is not currently admitted.");
    history.go(-1);
    return;
  }
  ans=validateCode(45,p.d_mumadmis,p.dummy,p.dummy,p.dummy,p.dummy,p.dummy,p.dummy,p.dummy,p.d_mumastat);
  if(!ans || trim(p.d_mumastat.value) != "Admitted") { 
    alert("Mother is not currently admitted.");
    history.go(-1);
    return;
  }
}
function SetAliasFlag() {
  f = document.NHIUpdate;
  if (VariableNameExists('SaveAliasToTicked')) {
    if (SaveAliasToTicked == true) {
      f.nhmas019.checked = true;
    }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);FormatAddress();DisplayResidency();
              SetAliasFlag();
              motherAdmitted();
              document.NHIUpdate.nhmas001.focus();"
      onclick="clearEsam();">
<!-- div for popup address panel for NHI eSAM interface-->
<div id="esamPanel"></div>

<table border=1 width="100%" cellspacing="0" cellpadding="1">
<tr><td class=HeadingCell align=center>NHI/MWS New Born Registration</td>
</table>
<table cellspacing=0 cellpadding=1 border=1 width=100%>
<tr valign=top><td>
<form name=NHIUpdate action="nhiweb99.pbl" method="get">
<input type=hidden name=reportno value="1">
<input type=hidden name=template value="002">
<input type=hidden name=updttype value="A">
<input type=hidden name=nhmaslup value="%NHIWEB99.01.119">
<input type=hidden name=gendermf value="%NHIWEB99.01.118">
<input type=hidden name=nextpage value="3">
<input type=hidden name=override value="   ">
<input type=hidden name=addrwarn value=" ">
<input type=hidden name=updkwarn value=" ">
<input type=hidden name=duplwarn value=" ">
<input type=hidden name=murnumbr value="%NHIWEB99.01.003">
<input type=hidden name=redirect value="%NHIWEB99.01.001.patweb83.01.002">
<input type="hidden" name="ptcnrerd" value="%STANDARD.01.025.118.250.0.1">
<input type="hidden" name="dummy" value="">
<input type="hidden" name="d_mumadmis" value="%NHIWEB99.01.081">
<input type="hidden" name="d_mumastat" value="">
<input type=hidden name=savelocl value=" ">
<input type=hidden name=ptcnnmpr value="%STANDARD.01.025.128.226.1.1">

<table cellspacing=0 cellpadding=0 border=0 width=100%>
<tr><td class=DataLabel>Surname </td>
    <td><input type=text name=nhmas001 
         size=25 maxlength=25 onblur='UpCase(this);'
         value="%NHIWEB99.01.101"></td></tr>
<tr><td class=DataLabel>Given 1st </td>
    <td class=DataLabel><input type=text name=nhmas002 
         size=20 maxlength=20 onblur='FormatGiven();'
         value="%NHIWEB99.01.147">
        <input type=radio name=nhmas005 value="1" checked onclick="checkPreferred('1')">Preferred</td></tr>
<tr><td class=DataLabel>Given 2nd </td>
    <td><input type=text name=nhmas003 
         size=20 maxlength=20 onblur='FormatGiven();'>
        <input type=radio name=nhmas005 value="2" onclick="checkPreferred('2')">
         Preferred
        <input type=hidden name="saveloc2" value="0"
         onclick="">
        <p id=savvloc2 style="display:none">Save to Local</p></td></tr>
<tr><td class=DataLabel>Given 3rd </td>
    <td><input type=text name=nhmas004 
         size=20 maxlength=20 onblur='FormatGiven();'>
        <input type=radio name=nhmas005 value="3" onclick="checkPreferred('3')">
         Preferred
        <input type=hidden name="saveloc3" value="0"
         onclick="">
        <p id=savvloc3 style="display:none">Save to Local</p></td></tr>
<tr><td class=DataLabel>Save Alias</td>
    <td><input type=checkbox name=nhmas019 value="1"></td></tr>

<!--  fields for the NHI eSAM interface -->
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="DataLabel">Address Type</td>
<td><select name="type" onchange="suggestAddress">
      <option value="B" selected>All Address types</option>
      <option value="L">Physical (LINZ) only</option>
      <option value="P">Postal (NZPost) only</option>
    </select>
    <input type="hidden" name="esamorg" value="%NHIWEB99.01.205.026"/>
    </td>
</tr>
<tr><td class="DataLabel">Suggest Address</td>
   <td><input type="text" name="esam0" id="esam0" value="" size="60" onkeyup="esamSuggestAddress();"/></td>
</tr>
<tr><td class="DataLabel" style="vertical-align: top">or Find Address</td><td style="1px solid black">
    <input type="text" name="esam1" value="" size="60" onkeyup="esamFindAddress();"/><br />
    <input type="text" name="esam2" value="" size="60" onkeyup="esamFindAddress();"/><br />
    <input type="text" name="esam3" value="" size="60" onkeyup="esamFindAddress();"/><br />
    <input type="text" name="esam4" value="" size="60" onkeyup="esamFindAddress();"/><br />
    <input type="text" name="esam5" value="" size="60" onkeyup="esamFindAddress();"/></td>
</tr>
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>

<tr valign=top><td class=DataLabel>Address </td>
    <td class=DataLabel>
        <input type=text name=nhmas006 value="%NHIWEB99.01.126"
               size=35 maxlength=35 
               onblur='FormatAddress();'>
        <br>
         <input type=text name=nhmas007 value="%NHIWEB99.01.127" 
                size=30 maxlength=30 
                onblur='FormatAddress();'>
         <br>
         <input type=text name=nhmas008 value="%NHIWEB99.01.128"
                size=30 maxlength=30 
                onblur='FormatAddress();'>
         Suburb<br>
         <input type=text name=nhmas009 value="%NHIWEB99.01.129"
                size=30 maxlength=30 
                onblur='FormatAddress();'>
         City<br>
         <input type=text name=nhmas010 value="%NHIWEB99.01.130"
                size=30 maxlength=30 
                onblur='FormatAddress();'>
         Country
    </td></tr>
</table>
</td>
<td>
Formatted Given Name<br>
<input type=text readonly name=fgiven size=25 ><br>
Formatted Address<br>
<input type=text readonly name=fadd1 size=35 ><br>
<input type=text readonly name=fadd2 size=35 ><br>
<input type=text readonly name=fadd3 size=35 ><br>
<input type=text readonly name=fadd4 size=35 ><br>
</td></tr>
<tr><td colspan=2>
<table cellspacing=0 cellpadding=0 border=0 width=100%>
    <input type=hidden name=nhmas014>
<!--
<tr><td class=DataLabel>Resident </td>
    <td><input type=checkbox name=nhmas014 value="1" checked></td>
-->
<tr><td class=DataLabel>Domicile &nbsp;&nbsp;&nbsp;&nbsp;</td>
    <td colspan=3><input type=text name=nhmas013 id=nhmas013 size=4 maxlength=4 
                   value="%NHIWEB99.01.113">
            <img src="../images/SearchIcon.gif" class=Icon
         onclick="DomicileSearchFrame(nhmas013);"></td></tr>
<tr><td class=DataLabel>Gender </td>
    <td><input type=radio name=nhmas015 value="F">Female
        <input type=radio name=nhmas015 value="M">Male
        <input type=radio name=nhmas015 value="U">Unknown
        </td>
    <td class=DataLabel>Date of Birth </td>
    <td><input type=text name=nhmas011 id=nhmas011 size=12 maxlength=12
        onblur="checkDate(this,'Date of Birth')" value="%STANDARD.01.015">
        <img src=../images/DateLookup.gif border=0 hspace=4 align=absmiddle
         onclick="DateLookupFrame(nhmas011);">
        </td>
	<!-- 01 : TAS : WP2-1184 - Hide deceased field 	
    <td class=DataLabel>Deceased </td>
    <td><input type=text name=nhmas012 size=12 maxlength=12
        onblur="checkDate(this,'Date of Death')" >
        <img src=../images/DateLookup.gif border=0 hspace=4 align=absmiddle
         onclick="DateLookupFrame(nhmas012);"></td>
        </td>
	End of Change -->
</tr>
<tr><td class=DataLabel>Ethnicity</td>
    <td colspan=5><select name=nhmas016>
        <option></option>
          %NHIWEB99.01.135.2
        </select>
        <select name=nhmas017>
        <option></option>
          %NHIWEB99.01.136.2
        </select>
        <select name=nhmas018>
        <option></option>
          %NHIWEB99.01.137.2
        </select>
        </td></tr>
</table>
<tr><td colspan=2>

<table border=0 width=100% cellspacing=0 cellpadding=0>
  <tr><td colspan=8 class=HeadingCell align=center>Residency Details</td></tr>

  <tr><td class=DataLabel>Country of Birth</td>
      <td><select name="ptmas019" class="select120" tabindex=39
                 title="Country of Birth">
           <option></option>
          %NHIWEB99.01.022.4
          </select>
      <td class=DataLabel><div id=CountryHeading></div></td>
      <td><div id=CountryResidence></div></td>
      <td class=DataLabel>&nbsp;</td>
      <td>&nbsp;</td>
      <td class=DataLabel>&nbsp;</td>
      <td>&nbsp;</td>
  </tr>

  <tr><td class=DataLabel>Type of Residency</td>
          <input type=hidden name=ptmas021>
      <td><select name=dtmas021 class=Mandatory tabindex=40 
           title="Type of Resident" onchange="DisplayResidency();">
           <option></option>
            %NHIWEB99.01.024.5
          </select></td>
      <td class=DataLabel><div id=ExpiryHeading></div></td>
      <td><div id=ExpiryDate></div></td>

      <td class=DataLabel><div id=VisaHeading></div></td>
      <td><div id=Visa></div></td>

      <td class=DataLabel><div id=NZISHeading></div></td>
      <td><div id=NZIS></div></td></tr>

  <tr><td class=DataLabel>Residency Comments</td>
      <td colspan=7><input type="text" name="pmres004" size=145 maxlength=127
       tabindex=41></td></tr>
</table>
</td></tr>

<tr><td colspan=2><table cellspacing="0" cellpadding="0">
<table cellspacing="0" cellpadding="0">
<tr><td class=DataLabel>Assign Pre-Allocated NHI Number</td>
    <td><input type=checkbox name=asprenhi value="1"
         onclick="ShowPreAllocated();"></td>
    <td><div id="PreAllocatedNHI"></div></td>
    </tr>
</table>
</td></tr>

<tr><td colspan=2 align=center>
<input type=button value=Add class="button" id="AddButton"
 onClick='tempDisable(this);subUpdate()'>
<input type=button value=Cancel class="button"
 onClick='history.back()'>
</table>
</form>
 <form name=nhisrch method=get action=nhiweb96.pbl
  onsubmit='return validateMandatory(this)'>
 <input type=hidden name=reportno value=1>
 <input type=hidden name=template value=1>
 <input type=hidden name=norecord value=10>
 <input type=hidden name=nzsrh001 value=0>
 <input type=hidden name=nzsrh002 value="">
 <input type=hidden name=nzsrh003 value="">
 <input type=hidden name=nzsrh004 value="">
 <input type=hidden name=nzsrh005 value="">
 <input type=hidden name=nzsrh006 value="">
 <input type=hidden name=nzsrh007 value="">
 <input type=hidden name=nzsrh008 value="">
 <input type=hidden name=nzsrh009 value="">
 </form>
<script type="text/javascript">

/*   for (var i =0 ; i < document.NHIUpdate.nhmas015.length; i++) {
     if (document.NHIUpdate.nhmas015[i].value=="%NHIWEB99.01.118") {
         document.NHIUpdate.nhmas015[i].checked="1" } };*/
function DisplayResidency() {
  i=document.NHIUpdate.dtmas021.selectedIndex;
  ind=document.NHIUpdate.dtmas021.options[i].value.substring(5,6)
  if (ind=="T") {
    ExpiryHeading.innerHTML=expiryhd.innerHTML;
    ExpiryDate.innerHTML=expirydate.innerHTML;
    VisaHeading.innerHTML=visahd.innerHTML;
    Visa.innerHTML=visano.innerHTML;
    CountryResidence.innerHTML=countryblank.innerHTML;
    CountryHeading.innerHTML="";
    document.getElementById('pmres001').value="";
    NZISHeading.innerHTML="";
    NZIS.innerHTML=NZISblank.innerHTML;
    document.getElementById('pmres014').className="";
  } else if (ind=="N"){
    CountryResidence.innerHTML=countryresidence.innerHTML;
    CountryHeading.innerHTML=countryheading.innerHTML;
    Visa.innerHTML=visablank.innerHTML;
    VisaHeading.innerHTML="";
    document.getElementById('pmres005').value="";
    ExpiryDate.innerHTML=expiryblank.innerHTML;
    ExpiryHeading.innerHTML="";
    document.getElementById('pmres002').value="";
    SetCategoryC_(document.NHIUpdate.pmres001,"%NHIWEB99.01.301.1")
    NZISHeading.innerHTML="";
    NZIS.innerHTML=NZISblank.innerHTML;
    document.getElementById('pmres014').className="Mandatory";
  } else if (ind=="V") {
    ExpiryHeading.innerHTML=expiryhd.innerHTML;
    ExpiryDate.innerHTML=expirydate.innerHTML;
    VisaHeading.innerHTML=visahd.innerHTML;
    Visa.innerHTML=visano.innerHTML;
    CountryResidence.innerHTML=countryresidence.innerHTML;
    CountryHeading.innerHTML=countryheading.innerHTML;
    SetCategoryC_(document.NHIUpdate.pmres001,"%NHIWEB99.01.301.1")
    NZISHeading.innerHTML=NZIShd.innerHTML;
    NZIS.innerHTML=NZISno.innerHTML;
    document.getElementById('pmres014').className="Mandatory";
  } else {
    ExpiryDate.innerHTML=expiryblank.innerHTML;
    ExpiryHeading.innerHTML="";
    Visa.innerHTML=visablank.innerHTML;
    VisaHeading.innerHTML="";
    document.getElementById('pmres005').value="";
    document.getElementById('pmres002').value="";
    CountryResidence.innerHTML=countryblank.innerHTML;
    CountryHeading.innerHTML="";
    document.getElementById('pmres001').value="";
    NZISHeading.innerHTML="";
    NZIS.innerHTML=NZISblank.innerHTML;
    document.getElementById('pmres014').className="";
  }
  if(document.NHIUpdate.ptcnrerd.value=="1"){
    document.NHIUpdate.dtmas021.disabled=true;
    document.NHIUpdate.dtmas021.className="ReadOnly";
    document.NHIUpdate.dtmas021.readOnly=true;
    document.getElementById('pmres001').className="ReadOnly select120";
    document.getElementById('pmres001').readOnly=true;
    document.getElementById('pmres002').className="ReadOnly Date";
    document.getElementById('pmres002').readOnly=true;
    document.getElementById('pmres005').className="ReadOnly";
    document.getElementById('pmres005').readOnly=true;
    document.getElementById('pmres014').className="ReadOnly";
    document.getElementById('pmres014').readOnly=true;
  }
}
</script>
<span id=expiryhd style="display:none">
<td class=DataLabel>Expiry Date</td>
</span>
<span id=expirydate style="display:none">
    <td><input type=text size=12 name=pmres002 id=pmres002 tabindex=1
         class="Mandatory Date" title="Expiry Date" 
        value="%NHIWEB99.01.302" onblur="checkDate(this,'Expiry Date');">
        <img notab src=../images/DateLookup.gif border=0 hspace=4
         align=absmiddle onclick="DateLookupFrame(pmres002);">
        <img notab src=../images/DateTimeStamp.gif border=0 hspace=4
         align=absmiddle onClick="SetCurrentDateTime(pmres002,null);">
    </td></tr>
</span>
<span id=expiryblank style="display:none">
   <input type=hidden name=pmres002 id=pmres002>
</span>
<span id=countryblank style="display:none">
   <input type=hidden name=pmres001 id=pmres001>
</span>
<span id=countryheading style="display:none">
<td class=DataLabel>Country of Residence</td>
</span>
<span id=countryresidence style="display:none">
    <td><select name=pmres001 id=pmres001 tabindex=16
          class="select120 Mandatory"
                 title="Country of Residence">
        <option></option>
        </select></td>
</span>
<span id=visablank style="display:none">
   <input type=hidden name=pmres005 id=pmres005>
</span>
<span id=visahd style="display:none">
<td class=DataLabel>Passport/Visa Number</td>
</span>
<span id=visano style="display:none">
    <td><input type=text size=12 name=pmres005 id=pmres005 tabindex=2
         class="Mandatory" title="Passport/Visa Number"
         value="%NHIWEB99.01.306">
    </td></tr>
</span>
<span id=NZISblank style="display:none">
  <input type=hidden name=pmres014 id=pmres014>
</span>
<span id=NZIShd style="display:none">NZIS Client Number</span>
<span id=NZISno style="display:none">
  <input type=text size=20 maxlength=20 name=pmres014 id=pmres014 class=""
   title="NZIS Client Number" value="%NHIWEB99.01.308">
</span>
<span id="ShowPreAllocatedNHI" style="display:none">
<td>&nbsp;<input type=text size=12 class="Mandatory"
     name=pallcnhi id=pallcnhi maxlength=8 title="Pre-Allocated NHI Number"
    onblur="validateNHIFormat(this);">
</td>
</span>
