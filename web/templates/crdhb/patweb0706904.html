<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript" src="../js/eReferralReg.js"></script>
%START.OF.PAGE
<script type="text/javascript">

function getPortalCookie() {
  if (GetCookieData("sjogwaPortalCOOKIE") != 'unknown') {
    ExpireCookiePath("sjogwaPortalCOOKIE");
    sjogprtl = "1";
  }
}

var sjogprtl = "";
getPortalCookie();

if("%STANDARD.01.025.119.182.0.1" == "1" &&
   sjogprtl != "1") {  // ptcnepis
  var src="../js/eAdmissionReg.js"
} else {
  var src="../js/DefaultOnlineNok.js";
}
var script = document.createElement("script");
             script.setAttribute("src", src);
             script.setAttribute("type", "text/javascript");
document.getElementsByTagName("head")[0].appendChild(script);
function UpdatePRFA(linkurl) {
  linkurl.replace(/ /,"+");
  Left=(document.body.clientWidth-650)/2;
  DFrameLink(linkurl,0,Left,650,350);
}
function refresh(){
  document.ViewForm.inactive.value='0';
  if(document.ViewForm.d_inactive.checked==true){
    document.ViewForm.inactive.value='Y';
  }
  linkurl="patweb07.pbl?reportno=06&template=004" +
          "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")+
          "&admissno=" + PatientLinks.admissno.value.replace(/ /g,"+")+
          "&cpmiskey=" + document.PatientLinks.cpmiskey.value.replace(/ /,"+") +
          "&inactive=" + document.ViewForm.inactive.value
  location.href=linkurl;
}
function AddContact(urnumber) {
  linkurl="patweb07.pbl?reportno=06&template=002" +
          "&urnumber=" + urnumber.replace(/ /g,"+")
  Left=(document.body.clientWidth-650)/2;
  DFrameLink(linkurl,0,Left,650,400);
}
function ShowContact(urnumber,type,count) {
  linkurl="patweb07.pbl?reportno=06&template=003" +
          "&urnumber=" + urnumber.replace(/ /g,"+")+
          "&pmcex001=" + urnumber.replace(/ /g,"+")+
          "&pmcex002=" + type.replace(/ /g,"+")+
          "&pmcex003=" + count.replace(/ /g,"+")
  Left=(document.body.clientWidth-650)/2
  DFrameLink(linkurl,0,Left,750,500)
}
function CheckDFrameExit() {
  if(document.PatientLinks.shwprint.value=="1" &&
    !isWhitespace(document.PatientLinks.casekeys.value)) {
    if(PatientLinks.trnsflag.value!="0") {
      location.href="patweb10.pbl?reportno=04&template=002" +
                  "&admissno=" + PatientLinks.admissno.value.replace(/ /g,"+") +
                  "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
                  "&waitflag=" + PatientLinks.waitflag.value.replace(/ /g,"+") +
                  "&trnsflag=" + PatientLinks.trnsflag.value.replace(/ /g,"+")
      parent.document.getElementById('PopUpScreen').style.width=950;
      parent.document.getElementById('PopUpScreen').style.height=650;
      Left=(parent.document.body.clientWidth-950)/2
      parent.document.getElementById('PopUpScreen').style.left=Left

    } else {
      LinkURL="outweb02.pbl?reportno=03&template=013" +
        "&casekeys=" + PatientLinks.casekeys.value.replace(/ /g,"+") +
        "&waitflag=" + PatientLinks.waitflag.value.replace(/ /g,"+") +
        "&shwprint=1"
        location.href=LinkURL;
    }
  } else {
    DFrameExit();
  }
}
function GoClinicList() {
  ClinicList=GetContentCookie("OutpatientClinicList");
  if (ClinicList!="unknown") {
      ExpireCookiePath("OutpatientClinicList"); 
      getTop().content.location.href=ClinicList;
      return;
  }
  OutpatientList=GetContentCookie("OutpatientList");
  if (OutpatientList!="unknown") {
      getTop().content.location.href=OutpatientList;
  } else {
    linkUrl="outweb02.pbl?reportno=2&template=004" +
          "&sesskeys=" + document.PatientLinks.cpmiskey.value.replace(/ /,"+");
    location.href=linkUrl;
  }
}
function ClickCancelButton() {

  if(GetCookieData("BHSRedirect")=="1"){
     linkUrl="patweb98.pbl?reportno=01&template=001"+
     "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+") +
     "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+");
     ExpireCookiePath("BHSRedirect");
     location.href=linkUrl;
     return;
  }

  if((top.menu.EmergencyFrameLink != undefined) &&
     (top.TogglePanel != undefined)){
      top.TogglePanel();       // Emergency Map
      return;
  }

  if(document.getElementById("ptcnepis").value=="1" &&
     sjogprtl != "1") {
    if(!isWhitespace(document.PatientLinks.admisnid.value)) {
        SetCookie("eAdmission",eAdmCookie);
        linkUrl="patweb14.pbl?reportno=03&template=001&urnumber="
        +PatientURN.replace(/ /g,"+")+"&admisnid="+getQueryString('admisnid');
        location.href=linkUrl;
        return;
    }
    if(!isWhitespace(document.PatientLinks.erefrlid.value)) {
        SetCookie("eRefeerral",eRefCookie);
        linkUrl="comweb10.pbl?reportno=04&template=001&urnumber="
        +PatientURN.replace(/ /g,"+")+"&erefrlid="+getQueryString('erefrlid');
        location.href=linkUrl;
        return;
    }
  }
  if(document.PatientLinks.othrcont.value=="1") {
    linkUrl="patweb92.pbl?reportno=12&template=1" +
         "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+") +
         "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+")
  } else {
    linkUrl="patweb89.pbl?reportno=1&template=002" +
         "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+") +
         "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+") +
         "&cpmiskey=" + document.PatientLinks.cpmiskey.value.replace(/ /,"+");
  }

  location.href=linkUrl;
}
function LinkContactHistory() {
  linkurl="patweb07.pbl?reportno=06&template=005" +
          "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")+
          "&admissno=" + PatientLinks.admissno.value.replace(/ /g,"+") +
          "&cpmiskey=" + document.PatientLinks.cpmiskey.value.replace(/ /,"+");
  location.href=linkurl;
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link
//  1 - Contact Type
//  2 - Relationship
//  3 - Name
//  4 - Home Phone
//  5 - Work Phone
//  6 - Mobile Phone
//  7 - Address
//  8 - Send Letter
//  9 - Active
//  10 - Contact Type associated number
//---------------------------------------------------------------------------

function InitTable(TableView) {
document.title="Contact Details Maintenance";
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",40,30);
 t.addColumn("Contact Type","String",1,10,"left","MaintenanceIcon.gif","0",130)
 t.addColumn("Relationship","String",2,2,"left","","",60)
 t.addColumn("Name","String",3,3,"left","","",120)
 t.addColumn("Home Phone","String",4,4,"left","","",70)
 t.addColumn("Mobile Phone","String",6,6,"left","","",70)
 t.addColumn("Address","String",7,7,"left","","",115)
 t.addColumn("Send Letter","String",8,8,"left","","",35)
 if(document.getElementById("ptcnsmsn").value == "1") {
   t.addColumn("Send SMS","String",12,12,"left","","",35)
 }
 t.addColumn("Inactive","String",9,9,"left","","",40)

 AddTableRows()
 TableOutput(0,1);    // Order Column,Asc  Dsc
 break;}
 }
}
function OnlinePreadmissionSJOG() {
  if (isWhitespace(document.PatientLinks.admisnid.value)){
    return;
  }
  var AdmissionID=GetCookieData("AdmissionID");
  var RegistrationType=GetCookieData("RegistrationType");
  SetCookie("RegistrationType","");
  if (!isWhitespace(AdmissionID)&&AdmissionID!="unknown") {
    DefaultOnlineCon(AdmissionID);
  }
}
function portalContacts() {
  if(!isWhitespace(document.PatientLinks.erefrlid.value)) {
    OnlineReferralContact();
    eRefPreList(); 
    return;
  }
  if(document.getElementById("ptcnepis").value=="1" &&
     sjogprtl != "1") {
    OnlinePreadmissionContact();
    eAdmPreList();
  } else {
    OnlinePreadmissionSJOG();
  }
}
</script>
</head>

<body onload="PageLoad(event);InitTable(0);ConfirmPMI();
 setTimeout('portalContacts()',700);">
<div id=HeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB07.06.003";
PatientVIS="%PATWEB07.06.081";
PatientNAM="%PATWEB07.06.002";
PatientSTA="%PATWEB07.06.086.078";
PatientALT="%PATWEB07.06.084";
PatientSEX="%PATWEB07.06.019";
PatientDOB="%PATWEB07.06.020";
PatientAGE="%PATWEB07.06.021";
PatientLOC="%PATWEB07.06.083";
PatientPRI="%PATWEB07.06.086.066.1";
PatientUNT="%PATWEB07.06.066.0";
DoctorCOD="%PATWEB07.06.082.003";
DoctorNAM="%PATWEB07.06.082.002";
PatientAID="%PATWEB07.06.086.090";
PatientIND="%PATWEB07.06.086.091";
PatientCUR="%PATWEB07.06.086.092";
PatientCLC="%PATWEB07.06.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB07.06.086.094";
PatientCDM="%PATWEB07.06.086.095";
PatientVDH="%PATWEB07.06.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<form name=ViewForm style="margin:0">
<input type="hidden" name="ptcnsmsn" id="ptcnsmsn"
 value="%STANDARD.01.025.120.243.0.1">
<input type=hidden name=ptcnuepm value="%STANDARD.01.025.125.155.0.1">
<input type=hidden name=upinumbr value="%PATWEB07.06.231">

<table width=100% cellspacing=0 cellpadding=0 bgcolor=#cccccc>
<tr><td align=left width=10%>
      <span id=InsertHistoryButton style="display: none">
      <input type=button class="button NoAutoFocus" value="Contact History"
       title="Contact History"
       onclick="LinkContactHistory();">
      </span>
      <span id=InsertOpClinic style="display: none">
      <input type=button class="button NoAutoFocus" value="Return to List"
       title="Return to List"
       onclick="GoClinicList();">
      </span>
    </td>
    <td width=70% align=right>Inactive
      <input type=hidden name=inactive>
      <input type=checkbox name=d_inactive value="Y" onclick='refresh();'>
    </td>
    <td align=right>
      <input type=button class="button" value="Add Contact"
       onclick="AddContact('%PATWEB07.06.001.patweb07.06.002');">
    </td>
</tr>
</table>
</form>
</div>

<table width=100% border=0 cellpadding=0 cellspacing=0>
<tr><td align=center>
     <!-- Add new button to send user to EMR summmary screen -->
	 <input type=button class="button" value="OK"
     onClick='PatientLinkTo("emrweb02.pbl",1,105,0,0,0);'>
     <input type=button class="button NoAutoFocus" value="Cancel"
      title="Return to previous screen"
      onclick="ClickCancelButton();">
    </td></tr>
</table>

<div id=ShowPRFA></div>
<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows() {
%PATWEB07.06.207.patweb07.06.003
}
</script>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value="%PATWEB07.06.003">
<input type=hidden name=admissno id=admissno value="%PATWEB07.06.081">
<input type=hidden name=casekeys value="%PATWEB07.06.203">
<input type=hidden name=shwprint value="%PATWEB07.06.202">
<input type=hidden name=waitflag value="%PATWEB07.06.205">
<input type=hidden name=trnsflag value="%PATWEB07.06.206">
<input type=hidden name=MenuType value="%PATWEB07.06.088">
<input type=hidden name=cpmiskey value="%PATWEB07.06.210">
<input type=hidden name=othrcont value="%PATWEB07.06.211">
<input type=hidden name=ptcnnwca value="%STANDARD.01.025.118.167.0.1">
<input type=hidden name=admisnid value="%PATWEB07.06.223">
<input type=hidden name=erefrlid value="%PATWEB07.06.229">
<input type="hidden" name="ptcnepis" id="ptcnepis"
 value="%STANDARD.01.025.119.182.0.1" />
<input type=hidden name=ptcnhdps value="%STANDARD.01.025.080.250.1.1">
</form>
<span id=PRFA style="display:none;">
<table width=100% border=1 cellpadding=0 cellspacing=0>
<tr><td colspan=6 class=HeadingCell align=center >
      Person Responsible for Account </td></tr>
<tr><td class=HeadingCell>Name </td>
    <td class=HeadingCell>Address</td>
    <td class=HeadingCell>Home Phone</td>
    <td class=HeadingCell>Work Phone </td>
    <td class=HeadingCell>Mobile </td></tr>
    %PATWEB07.06.208
</table>
</span>

<script type=text/javascript>
if(document.PatientLinks.admissno.value!=""){
  ShowPRFA.innerHTML=document.getElementById('PRFA').innerHTML;
}
inactive="%PATWEB07.06.209"
if(inactive=="Y"){
  document.ViewForm.d_inactive.checked=true;
}
if(!isWhitespace(document.PatientLinks.cpmiskey.value)) {
   InsertOpClinic.style.display="";
}
if(document.PatientLinks.ptcnnwca.value == "1") {
   InsertHistoryButton.style.display="";
}
if (parent.TogglePanel!=null) {
  if(top.content.location.search.substring(1,24)=="reportno=2&template=020"||
   top.content.location.search.substring(1,24)=="reportno=2&template=010") {
   top.content.UpdateForm.emexp018.value=PatientURN;
   top.content.UpdateForm.emexp018.onblur();
  }
}
function ConfirmPMI() {
  if(document.PatientLinks.ptcnhdps.value!="1") {
    return;
  }
  if(!isWhitespace(document.PatientLinks.cpmiskey.value)) {
    document.getElementById("PatientMenu").innerHTML="";
  }
}
</script>
