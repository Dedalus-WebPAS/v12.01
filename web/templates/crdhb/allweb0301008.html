<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName"    content="NoContextSet.html">
<script language=javascript src="../js/TableSort.js"></script>
<script language="javascript">
function AddExisting() {
  linkurl = "../cgi-bin/allweb03.pbl?reportno=16&template=001" +
            "&admissno=" + PatientLinks.admissno.value.replace(/ /g,"+") +
            "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
  Left=(document.body.clientWidth-900)/2
  DFrameLink(linkurl,0,Left,900,450)
}
function AddNewAdmission() {
  if(document.PatientLinks.ind_deptcode.value.substr(6,1)=="M") {
    PatientLinkTo('patweb89.pbl',3,2,0,0,0);
  } else {
    PatientLinkTo('patweb89.pbl',3,1,0,0,0);
  }
}
// 01 : CTAS : Add new function for MH Admit and Gen Admit
// assumption that only MH can access this page
function AddMHAdmit() {
	PatientLinkTo('patweb89.pbl',3,2,0,0,0);
}
function AddGenAdmit() {
    PatientLinkTo('patweb89.pbl',3,1,0,0,0);
}
// end of change
function AdmissionLink(VisitNo) {
   document.PatientLinks.action="patweb98.pbl"
   document.PatientLinks.reportno.value="1"
   document.PatientLinks.template.value="002"
   document.PatientLinks.admissno.value=VisitNo
   document.PatientLinks.submit()
}


function removeLink(linkNo)
{
   if(confirm("Are you sure you want to remove this link?"))
   { 
        //setup the url string
        var serverURL = "../cgi-bin/allweb03.pbl?reportno=16&updatety=D" +
                        "&alrsa001="+PatientLinks.admissno.value.replace(/ /g,"+") +
                        "&alrsa002="+linkNo.replace(/ /g,"+");

        //execute the remote call
        var returnValue = RSExecute(serverURL);
    
        //check if call was successfull
        if(returnValue.status == -1)
           alert("Something went wrong! contact ISoft support");

        //refresh the page
        location.reload();
   }
}

//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
// 1. Admission Number
// 2. Admission date
// 3. Admission Time
// 4. Unit Description (Cat AC)
// 5. Discharge Date
// 6. Doctor
// 7. Specialty (Cat A)
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 document.title=window.ResidentialAdmDescription;
 t = new Table(1,0,2,"100%","center",35,35);
 t.addColumn("Admission Number","String",1,1,"left","EditIcon.gif","0",110)
 t.addColumn("Admission Date","Date",2,2,"left","","",90)
 t.addColumn("Admission Time","String",3,3,"left","","",90)
 t.addColumn("Unit","String",4,4,"left","","",90)
 t.addColumn("Discharge Date","Date",5,5,"left","","",90)
 t.addColumn("Doctor","String",6,6,"left","","",90)
 t.addColumn("Specialty","String",7,7,"left","","",90)
 t.addColumn("Remove Link","String","","","left","MaintenanceIcon.gif","8",29)
 AddTableRows()
 t.sortTable(1,1);    // By Department
 TableOutput(0,1);    // By Date Order Column,Asc Dsc
 break; }
 }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%ALLWEB03.01.003";
PatientVIS="%ALLWEB03.01.081";
PatientNAM="%ALLWEB03.01.002";
PatientSTA="%ALLWEB03.01.086.078";
PatientALT="%ALLWEB03.01.084";
PatientSEX="%ALLWEB03.01.019";
PatientDOB="%ALLWEB03.01.020";
PatientAGE="%ALLWEB03.01.021";
PatientLOC="%ALLWEB03.01.125.0";
PatientPRI="%ALLWEB03.01.086.066.1";
PatientUNT="%ALLWEB03.01.066.0";
DoctorCOD="%ALLWEB03.01.082.003";
DoctorNAM="%ALLWEB03.01.082.002";
PatientAID="%ALLWEB03.01.086.090";
PatientIND="%ALLWEB03.01.086.091";
PatientCUR="%ALLWEB03.01.086.092";
PatientCLC="%ALLWEB03.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%ALLWEB03.01.086.094";
PatientCDM="%ALLWEB03.01.086.095";
PatientVDH="%ALLWEB03.01.086.099.015";
InsertPatientHeader()
</script>

<div id=HeadingSection></div>
<div id=PatientMenu></div>
<table width=100% cellspacing=0 cellpadding=1 border=0>
<tr><td class=HeadingCell align=center>
     %ALLWEB03.01.125.0 Referral Details  
    </td></tr> 
</table>

<table width=95% align=center cellspacing=0 cellpadding=1 border=0>
<tr><td class=DataLabel>Referral Date</td>
    <td class=DataField>%ALLWEB03.01.119</td>
    <td class=DataLabel>Referral Source</td>
    <td class=DataField>%ALLWEB03.01.134.0</td></tr>
<tr><td class=DataLabel>Referred By</td>
    <td class=DataField>%ALLWEB03.01.122.0</td>
    <td class=DataLabel>Problem</td>
    <td class=DataField>%ALLWEB03.01.128.0</td>
</tr>
<tr><td align=center colspan=6><br>
      <input type=button class="button" value="Cancel" name=cancbutt
        onclick="PatientLinkTo('allweb02.pbl',2,2,0,0,0);">
    </td>
</tr>
</table>

<table width=100% border=1 cellspacing=0 cellpadding=1>
<tr><td colspan=4 bgcolor=#cccccc align=right>
   <input type=button class="button" value="Link Existing Adm"
    onclick="AddExisting();">
	<!-- 01 : CTAS : Add new buttons
   <input type=button class="button" value="New Admission"
    onclick="AddNewAdmission();">
	-->
	  <input type=button class="button" value="Gen Admission"
    onclick="AddGenAdmit();">
	  <input type=button class="button" value="New MH Admit"
    onclick="AddMHAdmit();">
	<!-- end of change -->
   </td></tr>
</table> 
<div id=TableLocation></div>
<script language="javascript">
function AddTableRows() {
%ALLWEB03.01.313
}
</script>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value="1">
<input type=hidden name=template value="001">
<input type=hidden name=urnumber value="%ALLWEB03.01.003">
<input type=hidden name=admissno value="%ALLWEB03.01.081">
<input type=hidden name=refvisno value="%ALLWEB03.01.081">
<input type=hidden name=MenuType value="%ALLWEB03.01.088">
<input type=hidden name=depttype value="%ALLWEB03.01.307">
<input type=hidden name=deptcode value="%ALLWEB03.01.125.1">
<input type=hidden name=ind_deptcode value="%ALLWEB03.01.125.3">
<input type=hidden name=residadm value="1">
<input type=hidden name=refrdate value="%ALLWEB03.01.119">														  
</form>
