<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src=../js/TableSort.js></script>
<script type="text/javascript" src="../js/allweb06.js"></script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
//---------------------------------------------------------------------------
function InitTable(TableView) {
 switch (TableView) {
 case 0: {
  document.title="Group Session Patients";
  t = new Table(1,0,2,"100%","center",35,45);
  t.addColumn("Patient","ImageText",1,1,"left","PatientFolder","0",160,8,"","",7)
  t.addColumn("U/R","String",3,3,"left","","",80,"","","",7)
  t.addColumn("Referral Number","String",4,4,"left","","",80,"","","",7)
  t.addColumn("Department","String",5,5,"left","","",80,"","","",7)
  t.addColumn("Active","String",6,6,"left","","",30,"","","",7)
  AddTableRows()
  TableOutput(0,1);    // Order Column,Asc Dsc
  TableSort(4)
  break; }
 case 1: {
  document.title="Group Session HCPs";
  t = new Table(1,0,2,"100%","center",35,45);
  t.addColumn("HCP","String",1,1,"left","MaintenanceIcon.gif","0",160,"","",""
,4)
  t.addColumn(document.UpdateForm.DTdesc.value,"String",2,2,"left","","",80,"","","",4)
  t.addColumn("Active","String",3,3,"left","","",30,"","","",4)
  AddTableRows()
  TableOutput(0,1);    // Order Column,Asc Dsc
  TableSort(2)
  break; }
 }
}
function selectOptionsContract() {
  if (document.UpdateForm.algro012==undefined) { return; }
  if (isWhitespace(document.UpdateForm.algro009.value)) return;;
  var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=45" +
                    "&valdcode=" + 
                    document.UpdateForm.algro009.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    document.UpdateForm.algro012.options.length=0;
    document.UpdateForm.algro012.options[document.UpdateForm.algro012.options.length]=
    new Option("","");
    ReturnValue=returnValue.return_value.split("|");
    for (var j=0; j < ReturnValue.length; j++) {
       if (!isWhitespace(ReturnValue[j])) {
         SelectValue=ReturnValue[j].split(",");
         document.UpdateForm.algro012.options[document.UpdateForm.algro012.options.length]=
          new Option(SelectValue[1],SelectValue[0]); } } }
  else {
    ReturnCode.select();  }

  if (!isWhitespace(document.UpdateForm.d_algro12.value)) {
    for (var i =0 ; i < document.UpdateForm.algro012.length; i++) {
      if (document.UpdateForm.algro012.options[i].value.substr(0,3)==
          document.UpdateForm.d_algro012.value) {
        document.UpdateForm.algro012.selectedIndex=i
      }
    }
  }

}
// TAS : 02 : Overload AddPatientHCP to fix problem with Merging Task 0881839
function AddPatientHCP() {
 view=UpdateForm.listview.value
 if(view=="0") {
    linkurl = "../cgi-bin/allweb06.pbl?reportno=1&template=004" +
              "&algro001=" + UpdateForm.algro001.value.replace(/ /g,"+")
 }
 if(view=="1") {
    linkurl = "../cgi-bin/allweb06.pbl?reportno=1&template=006" +
              "&algro001=" + UpdateForm.algro001.value.replace(/ /g,"+")
 }
 Left=(document.body.clientWidth-750)/2
 DFrameLink(linkurl,50,Left,950,550)
 }
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(%ALLWEB06.01.114);selectOptionsContract();">
<div id="HeadingSection">
<form name=UpdateForm action=allweb06.pbl method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=003>
<input type=hidden name=algro001 value="%ALLWEB06.01.001">
<input type=hidden name=algro011 value="">
<input type=hidden name=redirect value="">
<input type=hidden name=updttype value=" ">
<input type=hidden name=nextpage value="1">
<input type=hidden name=DTdesc   value="%STANDARD.01.017.DT">
<input type=hidden name=listview value="%ALLWEB06.01.114">
<input type=hidden name=d_algro12 id=d_algro012 value="%ALLWEB06.01.024.1">


<table border=1 width=100% cellspacing=0 cellpadding=0>
<tr><td colspan=6 align=left class=MaintenanceHeading>
     Group Session Maintenance - %ALLWEB06.01.002 </td>
    </tr>
</table>
<table border=0 width=90% cellspacing=0 cellpadding=0 align=center>
<tr><td class=DataLabel>Session Description</td>
    <td><input type=text name=algro002 title="Session Description"
         value="%ALLWEB06.01.002" size=62 maxlength=60 class=Mandatory>
    </td>
    <td class=DataLabel>Department</td>
    <td><select name=algro009 title="Department" class=Mandatory
         onchange="selectOptionsContract();">
        <option value="   "></option>
        %ALLWEB06.01.009.2
        </select>
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.gy</td>
    <td><select name=algro003 title="%STANDARD.01.017.gy" class=Mandatory>
        <option value="   "></option>
        %ALLWEB06.01.003.2
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.017.PO</td>
    <td><select name=algro004 title="%STANDARD.01.017.PO" class=Mandatory>
        <option value="   "></option>
        %ALLWEB06.01.004.9.1.04.1.G
        </select>
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.fr</td>
    <td><select name=algro010 title="%STANDARD.01.017.fr" class=Mandatory>
        <option value="   "></option>
        %ALLWEB06.01.010.2
        </select>
    </td>
    <td class=DataLabel>Day</td>
    <td><select name=algro005 title="Day" class=Mandatory>
        <option value=" "></option>
        <option value="1">Monday</option>
        <option value="2">Tuesday</option>
        <option value="3">Wednesday</option>
        <option value="4">Thursday</option>
        <option value="5">Friday</option>
        <option value="6">Saturday</option>
        <option value="7">Sunday</option>
        </select>
    </td></tr>

<tr><td class=DataLabel>Start Date</td>
    <td><input type=text size=12 maxlength=8 name=algro006
         value="%ALLWEB06.01.006" title="Start Date" class=Mandatory>
        <img src=../images/DateTimeStamp.gif class=Icon
         date=UpdateForm.algro006>
        <img class=Icon src=../images/DateLookup.gif class=Icon
         date=UpdateForm.algro006>
    </td>
    <td class=DataLabel>Start Time</td>
    <td><input type=text size=8 name=algro007 class=Mandatory
         value="%ALLWEB06.01.007" title="Start Time">
        <img src=../images/TimeLookup.gif class=Icon
         time=UpdateForm.algro007>
    </td></tr>

<tr><td class=DataLabel>Duration</td>
    <td><input type=text name=algro008 class="Mandatory Number"
         value="%ALLWEB06.01.008" title="Duration" size=4  maxlength=3>mins
    </td>
    <td class=DataLabel>Active</td>
    <td><input type=checkbox name=d_algro011 title="Active" value="0">
    </td></tr>
<!-- 01 : CTAS : Add Contract field -->
<tr><td class=DataLabel>%STANDARD.01.017.gb</td>
    <td><select name="algro012" id="algro012" 
		title="%STANDARD.01.017.gb" class="Mandatory">
		<option value="   "></option>
        </select>
    <td colspan=2></td>
</tr>
<!-- end of change -->
<tr><td class=DataLabel colspan=4 align=center>
    <input type=button value="Update" class="button"
     onclick="PostSession();">

    <input type=button value="Delete" class="button"
     onclick="DeleteSession();">

    <input type=button value="Open Session List" class="button" 
     onclick="OpenProgList();">

    <input type=button value="Cancel" class="button" 
     onclick="SessionList();">
     &nbsp;&nbsp;&nbsp;
    <input type=button value="List" class="button" name=listbutn
     onclick="ListView();">
    <input type=button value="Add" class="button" name=addbuttn 
     onclick="AddPatientHCP()">
    </td></tr>
</form>
</table>
</div>

<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows() {
 %ALLWEB06.01.111
}
 Day="%ALLWEB06.01.005.1";
 for (var i =0 ; i < document.UpdateForm.algro005.length; i++) {
  if (document.UpdateForm.algro005.options[i].value==Day.substr(0,1)) {
       document.UpdateForm.algro005.selectedIndex=i } };
 Active="%ALLWEB06.01.011.1";
 if(Active=="0") {
   document.UpdateForm.d_algro011.checked=true;
 } else {
   document.UpdateForm.addbuttn.disabled=true;
 }
 View="%ALLWEB06.01.114";
 if(View=="0") {
   document.UpdateForm.listbutn.value="HCP List";
   document.UpdateForm.addbuttn.value="Add Patient";
 } else {
   document.UpdateForm.listbutn.value="Patient List";
   document.UpdateForm.addbuttn.value="Add HCP";
 }
</script>
