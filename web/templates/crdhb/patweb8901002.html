<meta name="TemplateVersion" content="V12.01.01">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<link rel="stylesheet" href="../html/postcode.css" type="text/css">
<script type="text/javascript" src="../js/IBA_Category_C_.js"></script>
<script type="text/javascript" src="../js/patweb89.js"></script>
<!-- 01 : CTAS : added link to CTAS custom javascript file -->
<script type="text/javascript" src="../js/ctascustom.js"></script>
<!-- end of change -->
<script type="text/javascript">

function updateNHI02() {
   
   if(document.UpdateForm.ptmas012.value == ""){
      document.UpdateForm.ptmas012.classList.remove("Mandatory");
   }

   updateNHI01();
}

function updatePatDetails() {
  document.UpdateForm.ptmas021.value=document.UpdateForm.dtmas021.value;
  var ethindex = document.UpdateForm.ethncty1.selectedIndex;
  var ethvalue = document.UpdateForm.ethncty1.options[ethindex].value;
  if (isWhitespace(ethvalue))
    if (!confirm("Ethnicity not specified!" + "\n" +
                "Do you wish to continue?"))
      return;

  validateDemographicsConfirmedDate();
  if (!validateMandatory(UpdateForm)) {
     return;
  }
/*08 : Suppress previous address message, still update previous address
  if (document.UpdateForm.preaddset.value==1) {
    ans=confirm("Do you want to update the Previous Address details?");
  if (ans) {  
      document.UpdateForm.prevaddr.value="1";
//    }
//  } */ 

  validateDeath01();
  SetOptOutSMS();
  UpCase(document.getElementById('ptmas007'));
  UpdHealthFund();
  if(!IsDirtyNHI(UpdateForm)) { UpdateForm.nzpmichg.value = "1"; }

  document.UpdateForm.submit();
}
function validateDemographicsConfirmedDate() {
  f = document.UpdateForm;
  if (f.ptcnavcd.value == "1") {
    f.ptmas069.value = f.currdate.value;
    return;
  }
  else {
    if (f.ptcnavcd.value == "2") {
      if (!isWhitespace(f.ptmas069.value)) {
        if (f.ptmas069.value !=
            f.currdate.value ) {
          alert("Warning: Confirm Demographics date has not been updated");
          f.ptmas069.value = f.ptmas069.defaultValue;
        }
      }
      return;
    }
  }
}
function setNotForResus() {
  if (typeof document.UpdateForm.nfresusc == "undefined")
   return;
  if (document.UpdateForm.nfresusc.checked == true)
    document.UpdateForm.pmpmi064.value = 1;
  else
    document.UpdateForm.pmpmi064.value = 0;
}
function SetMedRec() {
  if (document.UpdateForm.crmedtkb.checked == true)
    document.UpdateForm.crmedrec.value = 1;
  else
    document.UpdateForm.crmedrec.value = 0;
//alert(document.UpdateForm.crmedrec.value);
}
function checkAllEthnicityField() {
  var ethncty1 = document.getElementById("ethncty1");
  if (!ethncty1) return; 
  var dummy1 = document.getElementById("dummy1");
  var dummy2 = document.getElementById("dummy2");
  var pmpmi078 = document.getElementById("pmpmi078");


  if(ethncty1[ethncty1.selectedIndex].value == 21 ||
     dummy1[dummy1.selectedIndex].value == 21 ||
     dummy2[dummy2.selectedIndex].value == 21)
  {
     pmpmi078.className = "Mandatory";
  }
}
function PageLoadExtended() {
  PageLoad();
  DisplayResidency();
  checkAllEthnicityField();
  defaultSmokerField();
  UpCase(document.getElementById('ptmas007'));
  ConfirmPMI();
  DispMailingAddress();
  DispPrefGivenName();
  setGPBlank();
  ChkIdentifyGenderPronounTitle(document.UpdateForm);
  addSelectedAttr(UpdateForm);
}
function updateNHI22() {
  urno = trim(PatientLinks.urnumber.value)

  if(document.getElementById('ptcnnewc').value==1) {
    document.UpdateForm.redirect.value="patweb07.pbl?reportno=06&template=004"
    + "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+")
    + "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+")
    + "&cpmiskey=" + document.PatientLinks.cpmiskey.value.replace(/ /g,"+");
    updatePatDetails();}
  else {
   if (urno.substr(0,2) != "T-") {
    document.UpdateForm.redirect.value="patweb89.pbl?reportno=01&template=022" +
    "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+") +
    "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+") +
    "&cpmiskey=" + document.PatientLinks.cpmiskey.value.replace(/ /g,"+");
    updatePatDetails();}
  }
}
function defaultSmokerField() {
  var ptmas027 = document.getElementById("ptmas027");
  var temp = SMOKER.replace(/ /g,"");

  for(var i = 0; i < ptmas027.length; i++)
  {
    if(ptmas027[i].value == temp)
    {
       ptmas027.selectedIndex = i;
       break;;
    }
  }
}
// to retain data when clicked on NHI fields
// not used yet
function serialiseForm() {
  var form = document.UpdateForm;
  var count = 0;
  var serialisedString = "";

  for(var i = 0; i < form.elements.length; i++)
  {
    if(form.elements[i].type != "button")
    {
      if(form.elements[i].name != "redirect")
         serialisedString += form.elements[i].name+"="+form.elements[i].value.replace(/ /g,"+")+"&";
    }
  }
  var returnValue = RSExecute("../cgi-bin/patweb89.pbl?"+serialisedString);
  if(returnValue.status != -1)
    updateNHI02();
  else
    alert("Something went wrong! Please contact ISoft support");
}
// 01 : CTAS : add setGPBlank function
function setGPBlank() {
	// if GP Name contains 'Unknown' blank out GP and Prac fields
	var gp = document.UpdateForm.genpname.value.toLowerCase().indexOf("unknown");
	if (gp != -1) {
		document.UpdateForm.pmpmi059.value = "";
		document.UpdateForm.genpname.readOnly = false;
		document.UpdateForm.genpname.value = "";
		document.UpdateForm.genpname.readOnly = true;
		document.UpdateForm.genpprac.value = "";
		document.UpdateForm.pmpmi059.focus();
	}
}
// end of change

// 01 : CTAS : copied ReadDoc() from preadmission.js for GP lookup
function ReadDoc(OptionNumber,OptionType,ReturnCode,ReturnName,
ReturnPrac,ReturnPnam,ReturnPcnt,ReturnProv) {
  ReturnName.value="";
  ReturnPrac.value="";
  ReturnPnam.value="";
  ReturnPcnt.value="";
  ReturnProv.value="";
  if (isWhitespace(ReturnCode.value)) return;;
  var serverURL  = "../cgi-bin/patweb80.pbl?reportno=" + OptionNumber +
               "&returnfm=2" + "&valdtype=" + OptionType +
               "&valdcode=" + ReturnCode.value.replace(/ /g,"+")

  var returnValue = RSExecute(serverURL);

  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    ReturnName.value=trim(ReturnValue[0]);
    ReturnPrac.value=ReturnValue[1];
    ReturnPnam.value=ReturnValue[2];
    ReturnPcnt.value=ReturnValue[3];
    ReturnProv.value=ReturnValue[4]; }
 else {
    ReturnCode.value="";
    ReturnCode.select();
    return false; }
}
// end of change
// 11 : TAS : Overload of mobile field validation from Standard.js modified to accept 8-13 digits
//========================================================================
// Validate a Mobile Phone Number (basic edit) - Only contain numbers & spaces.
// Can (optionally) start with a + followed by country code (up to 3 digits).
// Number without country code can be up to 13 digits long.
// <input type=text name=xxxxxxx class=MobilePhone
//========================================================================
function checkMobilePhone(theField) {
  if (isWhitespace(theField.value))
    return true;

   //match=theField.value.match(/^\+?[0-9 ]*$/);

   var theNum = trim(theField.value);  // trim any trailing spaces

   //Regex for AU and NZ mobile phone numbers
   match=theNum.match(/^(?:\+[0-9]{1,3})?((?:[0-9]\s*){10,13}|(?:[0-9]\s*){8,13})$/);

  if (!match) {
    alert(theField.title + " is an invalid mobile phone number")

    var agentStr = window.navigator.userAgent;

    // For Chrome use Focus Delay to prevent looping
    if (agentStr.indexOf("Chrome") != -1) {
      FocusDelay(theField);
    }
    else {
      theField.focus();
    }
    return false;
  }

  return true;
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoadExtended();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
InsertPatientHeader()
</script>
<script>
 SMOKER="%PATWEB89.01.031.1";
</script>
<div id=PatientMenu></div>

<div id=PageBodySection>
<form name=UpdateForm action=patweb89.pbl method=post style="margin:0">
 <input type=hidden name=reportno value="2">
 <input type=hidden name=template value="002">
 <input type=hidden name=updatety value="4">
 <input type=hidden name=urnumber value="%PATWEB89.01.003">
 <input type=hidden name="redirect" value="%PATWEB89.01.001.patweb98.01.001">
 <input type=hidden name="savealia" value="0">
 <input type=hidden name="aliasset" value="0">
 <input type=hidden name="prevaddr" value="0">
 <input type=hidden name="preaddset" value="0">
 <input type=hidden name="pmpmi064" value="%PATWEB89.01.864">
 <input type=hidden name="crmedrec" value="0">
 <input type=hidden name=d_ptmas061 value="%PATWEB89.01.064">
 <input type=hidden name="ptcnnewc" id=ptcnnewc
   value="%STANDARD.01.025.118.138.0.1">
 <input type=hidden name=confdemo id=confdemo value="0">
 <input type=hidden name="ptcnrerd" value="%STANDARD.01.025.118.250.0.1">
 <input type=hidden name=updhfund value="">
 <input type=hidden name=admhfund value="%PATWEB89.01.114.0">
 <input type=hidden name=admhftab value="%PATWEB89.01.115.0">
 <input type=hidden name=admnstat value="%PATWEB89.01.199.020">
 <input type=hidden name=admninvc value="%PATWEB89.01.950">
 <input type=hidden name="ptcnvshf" id="ptcnvshf"
   value="%STANDARD.01.025.124.158.0.1">
 <input type=hidden name=pmpmi060 id=pmpmi060 value="%PATWEB89.01.885.001">
 <input type=hidden name=pmpmi061 id=pmpmi061 value="%PATWEB89.01.861">
 <input type=hidden name=genpprov id=genpprov value="">
 <input type=hidden name=cpmiskey value="%PATWEB89.01.999.001">
 <input type=hidden name=ptcnsmsn id=ptcnsmsn
        value="%STANDARD.01.025.120.243.0.1">
 <input type=hidden name=ptmsx050 id=ptmsx050
        value="%PATWEB89.01.085.066.1">
 <input type=hidden name=pchgdte id=pchgdte value="%PATWEB89.01.085.070">
 <input type=hidden name=ptmautim id=ptmautim value="%PATWEB89.01.085.071">
 <input type=hidden name=ptmauuid id=ptmauuid value="%PATWEB89.01.085.072.0">
 <input type=hidden name=d_ptmauuid id=d_ptmauuid
   value="%PATWEB89.01.085.072.1">
 <input type=hidden name=sjogaudt value="1">
  <input type=hidden name=currdate value="%STANDARD.01.015">
  <input type=hidden name=ptcnavcd value="%STANDARD.01.025.125.183.0.1">
  <input type=hidden name=ptcnnmpr value="%STANDARD.01.025.128.226.1.1">
  <input type=hidden name=ptcndfgn value="%STANDARD.01.025.120.182.0.1">
  <input type=hidden name=nhmas002 value="%PATWEB89.01.070.004">
  <input type=hidden name=nhmas003 value="%PATWEB89.01.070.005">
  <input type=hidden name=nhmas004 value="%PATWEB89.01.070.006">
  <input type=hidden name=nhmas005 value="%PATWEB89.01.070.007">
  <input type=hidden name=nzpmichg value="">

<table border=0 width=100% cellspacing=0 cellpadding=1>
<tr><td colspan=7 class=HeadingCell align=center>Demographic Details</td></tr>

<tr><td class=DataLabel width=11%>Title</td>
    <td width=20%>
       <select title="Patient Title" name=ptmas001 id=ptmas001 tabindex=1>
        <option></option>
        %STANDARD.01.029
       </select></td>
    <td class=DataLabel width=11%>Address Line 1</td>
    <td width=20%>
       <input type=text size=25 maxlength=35 name="ptmas008" tabindex=8
         title="Address Line 1" class=Mandatory value="%PATWEB89.01.012"
         onclick="updateNHI02();"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI02();"></td>
    <td class=DataLabel width=5%>Mailing / Postal&nbsp;</td>
    <td class=DataLabel width=11%>Address Line 1</td>
    <td width=22%><div id=MPostAdd1></div></td><tr>

<tr><td class=DataLabel> Surname</td>
    <td><input type=text size=40 name=ptmas005 title="Patient Surname"
         maxlength=40 class=Mandatory value="%PATWEB89.01.009" tabindex=2
         onclick="updateNHI02()"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI02();"></td>
    <td class=DataLabel>Address Line 2</td>
    <td><input type=text size=25 maxlength=30 name=ptmas009 tabindex=8
         title="Address Line 2" value="%PATWEB89.01.013"
         onclick="updateNHI02()"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI02();"></td>
    <td></td>
    <td class=DataLabel>Address Line 2</td>
    <td><div id=MPostAdd2></div></td></tr>

<tr><td class=DataLabel>Given Names</td>
    <td><input type=text size=25 maxlength=25 name=ptmas006 class=Mandatory
         title="Patient Given Names" value="%PATWEB89.01.010" tabindex=3
         onclick="updateNHI02()"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI02();"></td>
    <td class=DataLabel>Suburb</td>
    <td><input type=text size=25 maxlength=30 name=ptmas010 tabindex=9
         title="Address Line 3" value="%PATWEB89.01.014" readonly
         onclick="updateNHI02()"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI02();"></td>
    <td></td>
    <td class=DataLabel>Suburb</td>
    <td><div id=MPostAdd3></div></td></tr>

<tr id=PrefGivenName style="display:none">
    <td class=DataLabel>Preferred Given Name</td>
    <td><input type=text size=25 maxlength=25 name=pmpmi083
         title="Preferred Given Name" value="%PATWEB89.01.898"
         tabindex=3 onchange="UpCase(this);checkPrefGivenName('%PATWEB89.01.898');"></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.G </td>
    <td><select name="ptmas015" tabindex=4 title="%STANDARD.01.017.G " 
         class=Mandatory
         onchange="ChkIdentifyGenderPronounTitle(document.UpdateForm);"
         onclick="updateNHI02()"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI02();">
         <option></option>
          %PATWEB89.01.086.099.061.9.1.19.3.H
         </select></td>
    <td class=DataLabel>Town / City / Post Code / Country</td>
    <td><input type=text size=25 maxlength=30 name=ptmas011 tabindex=10
         title="Address Line 4" value="%PATWEB89.01.015"
         onclick="updateNHI02()"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI02();"></td>
    <td></td>
    <td class=DataLabel>Town / City / Post Code / Country</td>
    <td><div id=MPostAdd4></div></td></tr>

<tr><td class=DataLabel>Date of Birth</td>
    <td><input type=text size=12 name=ptmas017 class=Mandatory tabindex=5
         title="Date of Birth" value="%PATWEB89.01.020"
         onclick="updateNHI02()"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI02();"></td>
    <td class=DataLabel>Domicile</td>
    <td><input type=text size=5 maxlength=4 name=ptmas012 class=Mandatory
         title="Domicile" value="%PATWEB89.01.070.015" tabindex=11 
         onclick="updateNHI02()" 
         onKeyUp="if (IsEditKeyPress(event)) updateNHI02();">
         <input readonly class="Readonly" value="%PATWEB89.01.070.024"></td>
    <td></td>
    <td class=DataLabel>Mobile Phone</td>
    <td><input type=text size=17 maxlength=20 name=ptmsx039 tabindex=19
                 class=MobilePhone title="Mobile Phone No"
                 value="%PATWEB89.01.643">
          <span id=DisplaySMS style="display: none">
            Opt-Out SMS
            <input type=checkbox name=d_ptmsx050 id=d_ptmsx050 value=""
              tabindex=19
              onclick="checkAdd01();">
          </span>
    </td>
</tr>
<!-- 12 : Merge task 0893679 Extra contacts functionality for NZ 
	Hide post code field to match our change in the new contacts screen
    <td class=DataLabel>Post Code</td>
    <td><div id=MPostCode></div></td></tr> --> 

  <tr><td class=DataLabel>Private Phone</td>
      <td><input type=text size=12 maxlength=12 name=ptmas013 tabindex=6
                 title="Private Phone No" value="%PATWEB89.01.017"></td>
      <td class=DataLabel>Business Phone</td>
      <td><input type=text size=12 maxlength=12 name=ptmas014 tabindex=12
                 title="Business Phone No" value="%PATWEB89.01.018"></td>
      <td></td>
      <td class=DataLabel>%STANDARD.01.017.P2</td>
      <td><select title="%STANDARD.01.017.P2" name=ptmas040 tabindex=>
         <option></option>
        %PATWEB89.01.044.2
        </select>
       </td>
  </tr>

  <tr><td class=DataLabel>E-Mail</td>
    <td><input type=text size=23 maxlength=80 name=pmpmi005 tabindex=7
               title="E-Mail" value="%PATWEB89.01.805"></td>
    <td class=DataLabel id=DemogDateLbl>Demographics Confirmed Date</td>
    <td class=DataLabel id=DemogDateLblBlue>
      <font color=#1E90FF>Demographics Confirmed Date</td>
    <td>
          <input type=text class="PastDate" name=ptmas069 id=ptmas069
               tabindex=20 title="Demographics Confirmed Date"
               value="%PATWEB89.01.085.059"
               onblur="checkDate(this,this.title);
                       document.UpdateForm.confdemo.value=1">
          <img src="../images/DateTimeStamp.gif" class=Icon
               onclick="SetCurrentDateTime(ptmas069,null);">
          <img src="../images/DateLookup.gif" class=Icon
               onclick="DateLookupFrame(ptmas069);">
    </td>
    <td></td>
    <td class=DataLabel>%STANDARD.01.017.P4</td>
          <td><select title="%STANDARD.01.017.P4" name=ptmas042 tabindex=>
         <option></option>
          %PATWEB89.01.046.2
          </select>
    </td>
  </tr>
<!-- 05 : TAS : 12-05-2020 : Add Telehealth fields -->
</table>
<!-- End of Change -->				   

<table border=0 width=100% cellspacing=0 cellpadding=1>
<tr>
  <td width=42%></td>
  <td><div class="DataLabel" id="lstuptdg"></div></td>
</tr>
</table>

<table border=0 width=100% cellspacing=0 cellpadding=1>
<tr id=GenderExtra>
  <td width=11%><div id=IdenGenLbl></div></td>
  <td width=20%><div id=IdenGenDetail></div></td>
  <td width=11%><div id=IdenProLbl></div></td>
  <td width=11%><div id=IdenProDetail></div></td>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
</tr>
</table>

<table border=0 width=100% cellspacing=0 cellpadding=1>
<tr><td colspan=7 class=HeadingCell align=center>PMI Details</td></tr>

  <tr><td class=DataLabel>Previous Name</td>
      <td><input type="text" name="ptmas007" 
           id="ptmas007" title="Previous Name" tabindex=20
           value="%PATWEB89.01.011" onblur="UpCase(this);"></td>
      <td class=DataLabel>Marital Status</td>
      <td><select name=ptmas016 class=select120 tabindex=27>
           <option></option>
            %PATWEB89.01.069.2
          </select></td>
      <td class=DataLabel colspan=2>Occupation</td>
      <td><select name="ptmas044" class=select120 tabindex=33>
           <option></option>
            %PATWEB89.01.048.2
          </select></td></tr>
							  
	   

  <tr><td class=DataLabel>Ethnicity 1</td>
      <td><select name=ethncty1 id=ethncty1 readonly tabindex=21
                  onclick="updateNHI02()"
                  onKeyUp="if (IsEditKeyPress(event)) updateNHI02();">
           <option></option>
            %PATWEB89.01.070.020.2
          </select></td>
<!-- 06 : TAS : use long desription -->
      <td class=DataLabel>Iwi 1</td>
      <td><select title="Iwi 1" name=pmpmi078 id=pmpmi078 tabindex=28>
           <option></option>
            %PATWEB89.01.886.9.2
          </select></td>
      <td class=DataLabel colspan=2>Religion</td>
      <td><select name=ptmas020 class=select120 tabindex=34>
           <option></option>
            %PATWEB89.01.023.2
          </select></td></tr>
					 
	   

  <tr><td class=DataLabel>Ethnicity 2</td>
      <td><select name=dummy1 id=dummy1 readonly tabindex=22
                  onclick="updateNHI02()"
                  onKeyUp="if (IsEditKeyPress(event)) updateNHI02();">
           <option></option>
            %PATWEB89.01.070.021.2
          </select></td>
<!-- 06 : TAS : use long desription -->		  
      <td class=DataLabel>Iwi 2</td>
      <td><select title="Iwi 1" name=pmpmi079 tabindex=29>
           <option></option>
            %PATWEB89.01.887.9.2
          </select></td>
 <!-- <td class=DataLabel>&nbsp;</td>
      <td>&nbsp;</td> -->
	  <td class=DataLabel colspan=2>Interpreter Required</td>
	  <td><select title="Interpreter Required" name=pmpmi001 tabindex=35>
                  %PATWEB89.01.801.2
          </select></td></tr>

  <tr><td class=DataLabel>Ethnicity 3</td>
      <td><select name=dummy2 id=dummy2 readonly tabindex=23
                  onclick="updateNHI02()"
                  onKeyUp="if (IsEditKeyPress(event)) updateNHI02();">
           <option></option>
            %PATWEB89.01.070.022.2
          </select></td>
<!-- 06 : TAS : use long desription -->
      <td class=DataLabel>Iwi 3</td>
      <td><select title="Iwi 1" name=pmpmi080 tabindex=30>
           <option></option>
            %PATWEB89.01.888.9.2
          </select></td>
      <td class=DataLabel colspan=2>Pref Language 1</td>
      <td><select name=pmpmi002 class="select120" tabindex=36
                  title="Preferred Language">
           <option></option>
            %PATWEB89.01.802.2
          </select></td>
					 
      </tr>

<!-- 01 : CTAS : add iwi provider label and cat code field (patma1af.pusr3, code P3) -->

<tr>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel>%STANDARD.01.017.P3</td>
    <td><select title="%STANDARD.01.017.P3" name=ptmas041 tabindex=31>
         <option></option>
        %PATWEB89.01.045.2
        </select>
    </td>
<!--<td class=DataLabel></td>
    <td></td> -->
	<td class=DataLabel colspan=2>Pref Language 2</td>
      <td><select name=pmpmi003 class=select120 tabindex=37
                  title="Preferred Language">
           <option></option>
            %PATWEB89.01.803.2
          </select></td>
</tr>
<!-- end of change -->			  
		  
  <tr><td class=DataLabel>Local GP</td>
  
<!-- 01 : CTAS : make GP code field pmpmi059 visible   
				and made GP code and name mandatory 			 
      <td><input type=hidden name=pmpmi059 value="PATWEB89.01.884.001">
          <input type=text readonly name=genpname tabindex=24
                 value="PATWEB89.01.884.081">				 
-->
      <td><input type=hidden name=pmpmi059 id=pmpmi059 value="%PATWEB89.01.884.001"
		onchange="ReadDoc(18,0,pmpmi059,genpname,pmpmi060,genpprac,pmpmi061,genpprov);"
		class="Mandatory" Title="Local GP">	  
          <input type=text readonly name=genpname tabindex=24
			class="Mandatory"
            value="%PATWEB89.01.884.081" Title="Local GP">
<!-- end of change -->  
        <img src="../images/SearchIcon.gif" class=Icon
                 onclick="GPHCPSearchFrame(pmpmi059,genpname,genpprov,pmpmi060,
	    genpprac,pmpmi061,3);">
            <img src="../images/erase.gif" class=Icon
                 onclick="clrFields(pmpmi059,genpname);"></td>
            
      <td class=DataLabel>%STANDARD.01.017.P8</td>
      <td><select name="pmpmi073" title="%STANDARD.01.017.P8" tabindex=31>
          <option></option>
           %PATWEB89.01.873.2
          </select></td>
      <td class=DataLabel colspan=2>Smoker</td>
      <td><select name=ptmas027 id=ptmas027 title="Smoker ?" tabindex=38 >
           <option value=""></option>
           <option value="1">Yes</option>
           <option value="2">No</option>
          </select></td></tr>

   <tr><td class=DataLabel>Practice</td>
		   
       <td><input type=text readonly name=genpprac id=genpprac 
            value="%PATWEB89.01.885.005" tabindex=25>
             <img src="../images/SearchIcon.gif" class=Icon
                  onclick="GPHCGSearchFrame(pmpmi059,genpname,genpprov,pmpmi060,
                                            genpprac,pmpmi061);">
             <img src="../images/erase.gif" class=Icon
                  onclick="clrFields(pmpmi060,genpprac,pmpmi061,genpprov);"></td>
      <td class=DataLabel>Folder Selection</td>
      <td><select name=pmpmi077 title="Folder Selection" tabindex=32>
           <option></option>
            %PATWEB89.01.879.2
          </select></td>
<!-- TAS 12 V2
     <td class=DataLabel colspan=2>Pref Language 2</td>
      <td><select name=pmpmi003 class=select120 tabindex=37
                  title="Preferred Language">
           <option></option>
            PATWEB89.01.803.2
          </select></td> -->
		<td class=DataLabel colspan=2>BMI</td>
        <td class=DataField>%PATWEB89.01.999. 65</td>
		</tr>

<!-- 01 : CTAS : add Privacy Indicator field from standard template
  <tr><td class=DataLabel>GP Other</td>
      <td colspan="2">
          <input type="text" size="50" name="ptmas035" tabindex=26
                 maxlength="50" title="GP Other" value="PATWEB89.01.039"></td>
      <td>&nbsp;</td>
     <td class=DataLabel colspan=2>Pref Language 2</td>
      <td><select name=pmpmi003 class=select120 tabindex=37
                  title="Preferred Language">
           <option></option>
            PATWEB89.01.803.2
          </select></td></tr>
-->
  <tr><td class=DataLabel>GP Other</td>
      <td>
          <input type="text" size="50" name="ptmas035" tabindex=26
                 maxlength="50" title="GP Other" value="%PATWEB89.01.039"></td>
    <td class=DataLabel>Privacy Indicator</td>
    <td><select name=pmpmi066 class=select120 tabindex=33>
        <option></option>
         %PATWEB89.01.866.2
        </select></td>
      <td class=DataLabel colspan=2>BMI Date/Time</td>
      <td class=DataField>%PATWEB89.01.999. 66</td></tr>
<!-- TAS 12 V2
  <tr><td class=DataLabel>&nbsp;</td>
      <td>&nbsp;</td>
      <td class=DataLabel>&nbsp;</td>
      <td>&nbsp;</td>
      <<td class=DataLabel>&nbsp;</td>
      <td>&nbsp;</td></tr> end of change --> 
	   

  <tr><td class=DataLabel>Weight</td>
      <td class=DataField>%PATWEB89.01.999. 49</td>
      <td class=DataLabel>Height</td>
	  <td class=DataField>%PATWEB89.01.999. 48</td>
      <td class=DataLabel>&nbsp;</td>
														
      <td>&nbsp;</td>
      <td class=DataLabel>&nbsp;</td>
      <td>&nbsp;</td></tr>

<!--  TAS 12 V2
 <tr><td class=DataLabel>&nbsp;</td>
      <td class=DataField>&nbsp;</td>
      <td class=DataLabel>&nbsp;</td>
      <td class=DataField>&nbsp;</td>
      <td class=DataLabel colspan=2>BMI Date/Time</td>
      <td class=DataField>PATWEB89.01.999. 66</td></tr> -->
					 
	   
</table>
<!-- 05 : TAS : Telehealth Fields  -->
<table border=0 width=100% cellspacing=0 cellpadding=0>
  <tr><td colspan=8 class=HeadingCell align=center>Telehealth Details</td></tr>
  
  <tr>
	  <!-- CTAS : add technican check P1 (patma1af.pusr1, code P1) -->
       <td class=DataLabel>%STANDARD.01.017.P1</td>
       <td><select title="%STANDARD.01.017.P1" name=ptmas039 tabindex=>
         <option></option>
        %PATWEB89.01.043.2
        </select>
       </td>
	   <!-- : CTAS : add Telehealth platform VA (patmi1af.ausr7, code VA) -->
	     <td class=DataLabel>%STANDARD.01.017.VA</td>
         <td><select title="%STANDARD.01.017.VA" name=pmpmi065 tabindex=>
         <option></option>
        %PATWEB89.01.865.2
        </select>
        </td>
		<!-- : CTAS : add Consent Telehealth P5 (patma1af.pusr5, code P5) -->
	     <td class=DataLabel colspan=1>%STANDARD.01.017.P5</td>
         <td><select title="%STANDARD.01.017.P5" name=ptmas043 tabindex=>
         <option></option>
        %PATWEB89.01.047.2
        </select>
        </td>
		
        <td class=DataLabel colspan=2>&nbsp;</td>
		<td<td class=DataField>&nbsp;
	</tr>
    <tr><!-- Used Australian Date field - pmspx2af.pmpxrcrp -->
	   <td class=DataLabel>Date of Technician Check</td>
	   <td><input type="text" class="PastDate" name="pmpmi016" id=pmpmi016
            title="Date of Technician Check" value="%PATWEB89.01.816">
            <img src="../images/DateTimeStamp.gif" class=Icon
                 onclick="SetCurrentDateTime(pmpmi016,null);">
            <img src="../images/DateLookup.gif" class=Icon
                 onclick="DateLookupFrame(pmpmi016);"></td>
	  <td class=DataField>&nbsp;</td>
      <td class=DataLabel>&nbsp;</td>
      <td class=DataField>&nbsp;</td>
	  <td class=DataField>&nbsp;</td>
  </tr>	
 </table>
<!-- 05 : End of Change -->
<table border=0 width=100% cellspacing=0 cellpadding=0>
  <tr><td colspan=8 class=HeadingCell align=center>Residency Details</td></tr>

  <tr><td class=DataLabel width=11%>Country of Birth</td>
      <td width=20%>
         <select name="ptmas019" id=ptmas019 class="select120" tabindex=39
                 title="Country of Birth">
           <option></option>
          </select>
          <script type="text/javascript"> {
            SetCategoryC_(document.UpdateForm.ptmas019,"%PATWEB89.01.022.1") }
          </script></td>
      <td class=DataLabel width=11%><div id=CountryHeading></div></td>
      <td width=20%><div id=CountryResidence></div></td>
      <td width=8%>&nbsp;</td>
      <td width=11%>&nbsp;</td>
      <td width=8%>&nbsp;</td>
      <td width=11%>&nbsp;</td>
  </tr>
  <tr><td class=DataLabel>Type of Residency</td>
          <input type=hidden name=ptmas021>
      <td><select name=dtmas021 class=Mandatory tabindex=39 
           title="Type of Resident" onclick="updateNHI02();"
           onKeyUp="if (IsEditKeyPress(event)) updateNHI02();">
            <option></option>
            %PATWEB89.01.024.5
          </select></td>

      <td class=DataLabel><div id=ExpiryHeading></div></td>
      <td><div id=ExpiryDate></div></td>

      <td class=DataLabel><div id=VisaHeading></div></td>
      <td><div id=Visa></div></td>

      <td class=DataLabel><div id=NZISHeading></div></td>
      <td><div id=NZIS></div></td></tr>
</table>

<table border=0 width=100% cellspacing=0 cellpadding=0>
  <tr><td class=DataLabel width=11%>Residency Comments</td>
      <td width=40%>
        <input type="text" name="pmres004" size=145 maxlength=127
           value="%PATWEB89.01.946" tabindex=41></td>
      <td width=8%>&nbsp;</td>
      <td width=8%>&nbsp;</td>
      <td width=8%>&nbsp;</td>
      <td width=8%>&nbsp;</td>
      <td width=8%>&nbsp;</td>
      <td width=9%>&nbsp;</td>
  </tr>
</table>

 <table border=0 width=100% cellspacing=0 cellpadding=0>
  <tr><td colspan=8 class=HeadingCell align=center>Death Details</td></tr>

<!-- 01 : CTAS : restore old pre-CAR313313 editable death fields -->																
  <tr><td class=DataLabel width=11%>Date of Death</td>
      <td width=20%>
          <input type=hidden name=ptmas029>
          <input type=text size=12 name=ptmas061 tabindex=62
                 value="%PATWEB89.01.064" 
				 onBlur="confirmDeath(this,'DeathDate')"
                 title="Date of Death">
		  <img src="../images/DateLookup.gif" class=icon
		  onclick="DateLookupFrame(ptmas061);">
      </td>
      <td class=DataLabel>Unknown Date of Death</td>
      <td><input type=checkbox name=ptmas067 value="Y" tabindex=43 
                 onclick="confirmUnknownDeath();"></td>
      <td class=DataLabel>Death Notification</td>
      <td><select name=pmpmi017 class=select120 tabindex=44 disabled
                  title="Death Notification">
           <option></option>
            %PATWEB89.01.817.2
          </select></td>
	   
      <td class=DataLabel>Relatives Contacted</td>
      <td><select name=pmpmi072 tabindex=45 >
           <option></option>
             %PATWEB89.01.872.2
          </select></td>
<!-- end of change -->
		  
  </tr>
</table>

<table border=0 width=100% cellspacing=0 cellpadding=0>
  <tr><td colspan=8 class=HeadingCell align=center>
    <script type="text/javascript">URDesc();</script> Comments</td></tr>

  <tr>
    <td valign=top width=11%>
      <input type=button value="Add Comments" class="button" tabindex=67
       name="AddComm" id="AddComm"
       onclick="tempDisable(this);AddURComment();"></td>
    <td width=35%><textarea wrap=hard name=urcommna class=Readonly readonly
         rows=4 cols=70 tabindex=68>%PATWEB89.01.068.005</textarea>
    </td>
    <td width=9%>&nbsp;</td>
    <td width=9%>&nbsp;</td>
    <td width=9%>&nbsp;</td>
    <td width=9%>&nbsp;</td>
    <td width=9%>&nbsp;</td>
    <td width=9%>&nbsp;</td>
  </tr>

  <tr><td>&nbsp;</td></tr>

  <tr><td>&nbsp;</td></tr>
  <tr>
    <td colspan=8 align=center>
<!-- 01 : CTAS : changed Update button onclick
          <input type=button class="button" value=Update nz="pat89sub"
                 onclick="tempDisable(this);updatePatDetails()" tabindex=47>				 
-->			 
          <input type=button class="button" name=btnUpdt id=btnUpdt 
		  value=Update nz="pat89sub"
                 onclick="if (CheckPhoneFields()) {tempDisable(this);
				 updatePatDetails(); }"
				 tabindex=47>
<!-- end of change -->	  
  
          <input type=button class="button" value="Alias" name="aliasbut"
                 onClick='PatientLinkTo("patweb89.pbl",6,1,1,550,300);' tabindex=48>
          <input type=button class="button" value="Links" name="linksbut"
                 onClick='PatientLinkTo("patweb96.pbl",2,1,1,600,400);' tabindex=49>
          <input type=button class="Bigbutton" value="Emerge Contact" name="emergbut"
                 onClick='contacts();' tabindex=50>
<!-- 09 : TAS : Increase previous address window size 
          <input type=button class="button" value="Prev Address" name="preadbut"
                 onClick='PatientLinkTo("patweb98.pbl",1,38,1,700,400);' tabindex=51>
-->
		  <input type=button class="button" value="Prev Address" name="preadbut"
                 onClick='PatientLinkTo("patweb98.pbl",1,38,1,900,400);' tabindex=51>
<!-- end of change -->	
          <input type=button class="button" value="BMI" name=bmibuttn tabindex=55
                 onClick='PatientLinkTo("patweb07.pbl",17,1,1,700,400);'>
          <input type=button class="button" value="Prev GP" name=pregpbut tabindex=56
                 style="display:none"
                 onClick='PatientLinkTo("patweb98.pbl",1,99,1,700,400);'>
		<!-- 03 : Add Deceased Details button to page --> 
		  <input type=button class="button"  value="Deceased Details" tabindex=54
	             onClick='PatientLinkTo("patweb89.pbl",1,38,1,700,400);' />
		<input type=button class=button value="PMI Audit" name=pmiabutt
				tabindex=77
				onclick='PatientLinkTo("patweb98.pbl",01,330,1,950,400);'>
          <input type=button class="button" value="Cancel" tabindex=58
                 onclick='PatientLinkTo("patweb98.pbl",1,1,0,0,0);'/>
      </td></tr>
 </table>
</form>

<div id=SelectHeading></div>
<div id=SelectLocation></div>
</div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
<input type=hidden name=MenuType value="%PATWEB89.01.088">
<input type=hidden name=cpmiskey value="%PATWEB89.01.999.001">
</form>

<script type="text/javascript">
 f=document.UpdateForm;

 if ("%PATWEB89.01.033" == "Yes") {
   alert("Warning: Patient is Deceased");
 }
 if ("%PATWEB89.01.947" == "1") {
   alert("Warning: Resident Status Expiry Imminent");
 }
 if ("%PATWEB89.01.947" == "2") {
   alert("Warning: Resident Status Expired");
 }
 if (typeof document.UpdateForm.nfresusc != "undefined") {
   if (document.UpdateForm.ptpmi064.value == "1")
     document.UpdateForm.nfresusc.checked = true;
 }
 for (var i=0; i < document.UpdateForm.ptmas001.length; i++) {
  if (document.UpdateForm.ptmas001.options[i].value=="%PATWEB89.01.005.0") {
    document.UpdateForm.ptmas001.selectedIndex=i;
  }
 }
// PatientSex="%PATWEB89.01.019"
// for (var i =0 ; i < document.UpdateForm.ptmas015.length; i++) {
//  if (document.UpdateForm.ptmas015.options[i].value==PatientSex.substr(0,1)) {
//     document.UpdateForm.ptmas015.selectedIndex=i }
// };
//
// MergePsych="%PATWEB89.01.050"
// if ( MergePsych == "Yes") {
//   document.UpdateForm.ptmas046.checked=true;
// }
// InterpReq="%PATWEB89.01.049"
// if ( InterpReq == "Yes") {
//   document.UpdateForm.ptmas045.checked=true;
// }
//
 AliasIndicator="%PATWEB89.01.093";
 if ( AliasIndicator =="1" ) {
   document.UpdateForm.aliasbut.className="RedButton";
 }
//
 LinksIndicator="%PATWEB89.01.094";
 if ( LinksIndicator =="1" ) {
   document.UpdateForm.linksbut.className="RedButton";
 }
//
 PreAddIndicator="%PATWEB89.01.095";
 if ( PreAddIndicator =="1" ) {
   document.UpdateForm.preadbut.className="RedButton";
 }
//
 EmergeIndicator="%PATWEB89.01.096";
 if ( EmergeIndicator =="1" ) {
   document.UpdateForm.emergbut.className="RedButton";
 }
 BMIIndicator="%PATWEB89.01.999. 43";
 if ( BMIIndicator =="1" ) {
   document.UpdateForm.bmibuttn.className="RedButton";
 }
 PrevGP="%PATWEB89.01.999.053";
 if ( PrevGP == "1"  ) {
   document.UpdateForm.pregpbut.style.display="";
   document.UpdateForm.pregpbut.className="RedButton";
 }
 PMIAuditIndicator = "%PATWEB89.01.999.117";
 if ( PMIAuditIndicator == "1" ) {
   document.UpdateForm.pmiabutt.className="RedButton";
 }

 DateofDeath="%PATWEB89.01.064"
 if (!isWhitespace(DateofDeath)) {
   document.UpdateForm.ptmas067.checked=false;
//   document.UpdateForm.ptmas067.disabled=true;
//   document.UpdateForm.pmpmi017.disabled=false;
 }
 UnknownDDeath="%PATWEB89.01.079.0";
 if ( UnknownDDeath == "Y") {
   document.UpdateForm.ptmas067.checked=true;
//   document.UpdateForm.pmpmi017.className="Mandatory";
//   document.UpdateForm.pmpmi017.disabled=false;
 }
// if (UnknownDDeath=="N") {
//   if (isWhitespace(DateofDeath)) {
//     document.UpdateForm.pmpmi017.disabled=true;
//   }
// }

 ShowOptOutSMS();

if (isWhitespace(f.pchgdte.value) || isWhitespace(f.ptmauuid.value)) {
  var lstupd = "Demographics Last updated by () on "
}
else {
  var lstupd = "Demographics Last updated by " + trim(f.ptmauuid.value) +
               " (" + trim(f.d_ptmauuid.value) + ") " +
               f.ptmautim.value.substr(0,5) + " on " + f.pchgdte.value;
}
document.getElementById('lstuptdg').innerText = lstupd;
document.getElementById('lstuptdg').className = "RedText";
document.getElementById('DemogDateLbl').style.display = "none";
document.getElementById('DemogDateLblBlue').style.display = "";

function DisplayResidency() {
  i=document.UpdateForm.dtmas021.selectedIndex;
  ind=document.UpdateForm.dtmas021.options[i].value.substring(5,6)
  if (ind=="T") {
    ExpiryHeading.innerHTML=expiryhd.innerHTML;
    ExpiryDate.innerHTML=expirydate.innerHTML;
    VisaHeading.innerHTML=visahd.innerHTML;
    Visa.innerHTML=visano.innerHTML;
    CountryResidence.innerHTML=country_blank.innerHTML;
    CountryHeading.innerHTML="";
    document.UpdateForm.pmres001.value="";
    NZISHeading.innerHTML="";
    NZIS.innerHTML=NZISblank.innerHTML;
    document.UpdateForm.pmres014.className="";
  } else if (ind=="N"){
    CountryResidence.innerHTML=country_residence.innerHTML;
    CountryHeading.innerHTML=country_heading.innerHTML;
    Visa.innerHTML=visablank.innerHTML;
    VisaHeading.innerHTML="";
    document.UpdateForm.pmres005.value="";
    ExpiryDate.innerHTML=expiryblank.innerHTML;
    ExpiryHeading.innerHTML="";
    NZISHeading.innerHTML="";
    NZIS.innerHTML=NZISblank.innerHTML;
    document.UpdateForm.pmres002.value="";
    SetCategoryC_(document.UpdateForm.pmres001,"%PATWEB89.01.943.1")
    document.UpdateForm.pmres014.className="";
  } else if (ind=="V") {
    ExpiryHeading.innerHTML=expiryhd.innerHTML;
    ExpiryDate.innerHTML=expirydate.innerHTML;
    VisaHeading.innerHTML=visahd.innerHTML;
    Visa.innerHTML=visano.innerHTML;
    CountryResidence.innerHTML=country_residence.innerHTML;
    CountryHeading.innerHTML=country_heading.innerHTML;
    SetCategoryC_(document.UpdateForm.pmres001,"%PATWEB89.01.943.1")
    NZISHeading.innerHTML=NZIShd.innerHTML;
    NZIS.innerHTML=NZISno.innerHTML;
    document.UpdateForm.pmres014.className="Mandatory";
    } else {
    ExpiryDate.innerHTML=expiryblank.innerHTML;
    ExpiryHeading.innerHTML="";
    Visa.innerHTML=visablank.innerHTML;
    VisaHeading.innerHTML="";
    document.UpdateForm.pmres005.value="";
    document.UpdateForm.pmres002.value="";
    CountryResidence.innerHTML=country_blank.innerHTML;
    CountryHeading.innerHTML="";
    document.UpdateForm.pmres001.value="";
    NZISHeading.innerHTML="";
    NZIS.innerHTML=NZISblank.innerHTML;
    document.UpdateForm.pmres014.className="";
  }
  if(document.UpdateForm.ptcnrerd.value=="1"){
    document.UpdateForm.dtmas021.className="ReadOnly";
    document.UpdateForm.dtmas021.disabled=true;
    document.UpdateForm.dtmas021.style.setProperty('color','black');
    document.UpdateForm.dtmas021.readOnly=true;
    document.UpdateForm.pmres001.className="ReadOnly select120";
    document.UpdateForm.pmres001.readOnly=true;
    document.UpdateForm.pmres001.disabled=true;
    document.UpdateForm.pmres001.style.setProperty('color','black');
    document.UpdateForm.pmres002.className="ReadOnly Date";
    document.UpdateForm.pmres002.readOnly=true;
    document.UpdateForm.pmres004.className="ReadOnly";
    document.UpdateForm.pmres004.readOnly=true;
    document.UpdateForm.pmres005.className="ReadOnly";
    document.UpdateForm.pmres005.readOnly=true;
    document.UpdateForm.pmres014.className="ReadOnly";
    document.UpdateForm.pmres014.readOnly=true;
  }
}
function contacts() {
 if (document.UpdateForm.ptcnnewc.value=='1') {
   location.href='patweb07.pbl?reportno=06&template=004&urnumber='+
                 '%PATWEB89.01.003&admissno=%PATWEB89.01.081&othrcont=0' +
                 "&cpmiskey=" +
                  document.PatientLinks.cpmiskey.value.replace(/ /g,"+");
 } else {
   location.href='patweb89.pbl?reportno=01&template=022&urnumber='+
                 '%PATWEB89.01.003&admissno=%PATWEB89.01.081&othrcont=0' +
                 "&cpmiskey=" +
                  document.PatientLinks.cpmiskey.value.replace(/ /g,"+");
 }
}
function ConfirmPMI() {
  if(!isWhitespace(document.PatientLinks.cpmiskey.value)) {
    document.getElementById("PatientMenu").innerHTML="";
    document.UpdateForm.redirect.value="patweb98.pbl?reportno=1&template=001" +
    "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+") +
    "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+") +
    "&cpmiskey=" + document.PatientLinks.cpmiskey.value.replace(/ /g,"+");
  }
}
function DispMailingAddress(){

//Using Mailing address information from patm1af table
 if (document.getElementById('ptcnnewc').value!='1'){
  MPostAdd1.innerHTML=MPAdd1_ptmsx040.innerHTML;
  MPostAdd2.innerHTML=MPAdd2_ptmsx041.innerHTML;
  MPostAdd3.innerHTML=MPAdd3_ptmsx042.innerHTML;
  MPostAdd4.innerHTML=MPAdd4_ptmsx043.innerHTML;
  MPostCode.innerHTML=MPCode_ptmsx044.innerHTML;
  return;
 }

//Using Mailing Address information from new contact table pmscexaf table
  MPostAdd1.innerHTML=MPAdd1_pmcex007.innerHTML;
  MPostAdd2.innerHTML=MPAdd2_pmcex008.innerHTML;
  MPostAdd3.innerHTML=MPAdd3_pmcex009.innerHTML;
  MPostAdd4.innerHTML=MPAdd4_pmcex010.innerHTML;
//  MPostCode.innerHTML=MPCode_pmcex011.innerHTML;
  
  var serverURL = "../cgi-bin/comweb81.pbl?reportno=26&urnumber=" +
                  document.PatientLinks.urnumber.value.replace(/ /g,"+");

  var returnValue = RSExecute(serverURL);
  if (returnValue.status==-1){return;}      //Error found

  ReturnValue=returnValue.return_value.split("|");
  if (trim(ReturnValue[0])== '0'){return;} //No data found

  document.getElementById('pmcex007').value=trim(ReturnValue[1]); 
  document.getElementById('pmcex008').value=trim(ReturnValue[2]); 
  document.getElementById('pmcex009').value=trim(ReturnValue[3]); 
  document.getElementById('pmcex010').value=trim(ReturnValue[4]); 
//  document.getElementById('pmcex011').value=trim(ReturnValue[5]); 
}

</script>
<span id=expiryhd style="display:none">Expiry Date</span>

<span id=expirydate style="display:none">
  <input type=text size=12 name=pmres002 id=pmres002 tabindex=39
         class="Mandatory Date" title="Expiry Date"
         value="%PATWEB89.01.944" onblur="checkDate(this,'Expiry Date');">
    <img src="../images/DateLookup.gif" class=Icon
         onclick="DateLookupFrame(pmres002);">
    <img src="../images/DateTimeStamp.gif" class=Icon
         onclick="SetCurrentDateTime(pmres002,null);">
</span>

<span id=expiryblank style="display:none">
  <input type=hidden name=pmres002 id=pmres002>
</span>

<span id=country_blank style="display:none">
  <input type=hidden name=pmres001 id=pmres001>
</span>

<span id=country_heading style="display:none">Country of Residence</span>

<span id=country_residence style="display:none">
  <select name=pmres001 id=pmres001 class="select120 Mandatory"
   title="Country of Residence" tabindex=39>
   <option></option>
  </select>
</span>

<span id=visablank style="display:none">
  <input type=hidden name=pmres005 id=pmres005>
</span>

<span id=visahd style="display:none">Passport/Visa Number</span>

<span id=visano style="display:none">
  <input type=text size=12 name=pmres005 id=pmres005 class="Mandatory"
         tabindex=39
         title="Passport/Visa Number" value="%PATWEB89.01.951">
</span>
<span id=NZISblank style="display:none">
  <input type=hidden name=pmres014 id=pmres014>
</span>
<span id=NZIShd style="display:none">NZIS Client Number</span>
<span id=NZISno style="display:none">
  <input type=text size=20 maxlength=20 name=pmres014 id=pmres014 class=""
   title="NZIS Client Number" value="%PATWEB89.01.999.003.014">
</span>

<!-- DIV for Mailing/Postal Address - Start -->
<div id=MPAdd1_ptmsx040 style="display:none">
        <input type=text maxlength=35 size=25 name=ptmsx040 tabindex=14
         title="Postal Address" value="%PATWEB89.01.644"
         onclick="updateNHI22();"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI22();">
</div>
<div id=MPAdd1_pmcex007 style="display:none">
        <input type=text maxlength=35 size=25 name=pmcex007 tabindex=14
         title="Postal Address" value="" id=pmcex007
         onclick="updateNHI22();"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI22();">
</div>

<div id=MPAdd2_ptmsx041 style="display:none">
        <input type=text maxlength=30 size=25 name=ptmsx041 tabindex=15
         title="Postal Address 2" value="%PATWEB89.01.645"
         onclick="updateNHI22();"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI22();">
</div>
<div id=MPAdd2_pmcex008 style="display:none">
        <input type=text maxlength=30 size=25 name=pmcex008 tabindex=15
         title="Postal Address 2" value="" id=pmcex008
         onclick="updateNHI22();"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI22();">
</div>

<div id=MPAdd3_ptmsx042 style="display:none">
        <input type=text maxlength=30 size=25 name=ptmsx042 tabindex=16
         title="Postal Address 3" value="%PATWEB89.01.646"
         onclick="updateNHI22();"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI22();">
</div>
<div id=MPAdd3_pmcex009 style="display:none">
        <input type=text maxlength=30 size=25 name=pmcex009 tabindex=16
         title="Postal Address 3" value="" id=pmcex009
         onclick="updateNHI22();"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI22();">
</div>

<div id=MPAdd4_ptmsx043 style="display:none">
        <input type=text maxlength=30 size=25 name=ptmsx043 tabindex=17
         title="Postal Address 4" value="%PATWEB89.01.647"
         onclick="updateNHI22();"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI22();">
</div>
<div id=MPAdd4_pmcex010 style="display:none">
        <input type=text maxlength=30 size=25 name=pmcex010 tabindex=17
         title="Postal Address 4" value="" id=pmcex010
         onclick="updateNHI22();"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI22();">
</div>

<div id=MPCode_ptmsx044 style="display:none">
        <input type=text maxlength=30 size=5 tabindex=18 name=ptmsx044
         title="Postal Post Code" value="%PATWEB89.01.648"
         onclick="updateNHI22();"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI22();">
</div>
<div id=MPCode_pmcex011 style="display:none">
        <input type=text maxlength=30 size=5 tabindex=18 name=pmcex011
         title="Postal Post Code" value="" id=pmcex011
         onclick="updateNHI22();"
         onKeyUp="if (IsEditKeyPress(event)) updateNHI22();">
</div>
<!-- DIV for Mailing/Postal Address - End -->

<span id=idenGenLblShow style="display:none">
  <td class=DataLabel>%STANDARD.01.035.Gi</td>
</span>
<span id=idenGenDetailShow style="display:none">
  <td><select name=pmpmi125 id=pmpmi125 class=Mandatory tabindex=7
       title="%STANDARD.01.035.Gi"
       onchange="IdenGenderChange(document.UpdateForm);">
      <option></option>
       %PATWEB89.01.086.099.063.9.2
      </select><br>
      <span id=IdenGenFreeTxt></span>
  </td>
</span>
<span id=idenGenDetailBlank style="display:none">
  <td><input type=hidden name=pmpmi125 id=pmpmi125 value=""></td>
  <td><input type=hidden name=pmpmi126 id=pmpmi126 value=""></td>
</span>
<span id=idenGenFreeTxtShow style="display:none">
  <input type=text name=pmpmi126 id=pmpmi126 size=80 maxlength=80
   class=Mandatory tabindex=7
   title="Identifying Gender Free Text"
   value="%PATWEB89.01.086.099.065">
</span>
<span id=idenGenFreeTxtBlank style="display:none">
  <td><input type=hidden name=pmpmi126 id=pmpmi126 value=""></td>
</span>

<span id=idenProLblShow style="display:none">
  <td class=DataLabel>%STANDARD.01.035.Gp</td>
</span>
<span id=idenProDetailShow style="display:none">
  <td><select name=pmpmi127 id=pmpmi127 class=Mandatory tabindex=13
       title="%STANDARD.01.035.Gp"
       onchange="IdenPronounChange(document.UpdateForm);">
      <option></option>
       %PATWEB89.01.086.099.064.9.2
      </select><br>
      <span id=IdenProFreeTxt></span>
  </td>
</span>
<span id=idenProDetailBlank style="display:none">
  <td><input type=hidden name=pmpmi127 id=pmpmi127 value=""></td>
  <td><input type=hidden name=pmpmi128 id=pmpmi128 value=""></td>
</span>
<span id=idenProFreeTxtShow style="display:none">
  <input type=text name=pmpmi128 id=pmpmi128 size=80 maxlength=80
   class=Mandatory tabindex=13
   title="Identifying Pronoun Free Text"
   value="%PATWEB89.01.086.099.066">
</span>
<span id=idenProFreeTxtBlank style="display:none">
  <td><input type=hidden name=pmpmi128 id=pmpmi128 value=""></td>
</span>

