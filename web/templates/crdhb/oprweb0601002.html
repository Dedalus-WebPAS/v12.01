<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="crdhb">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb06.js"></script>
<script type="text/javascript" >
function validateData() {
  if(validateMandatory(AddForm)) {
     bool1=isWhitespace(AddForm.optsm005.value);
     bool2=!isWhitespace(AddForm.optsm006.value); 
     if(bool1&&bool2){
      alert("End Date must be entered with End Time");
      AddForm.optsm005.select();
      return;
     }
     if((!bool1) && (!bool2)){
       alert("End Time must be entered with End Date");
       AddForm.optsm006.focus();
       return;
     }   
    strtDate = AddForm.optsm003;
    strtTime = AddForm.optsm004;
    endDate  = AddForm.optsm005;
    endTime  = AddForm.optsm006;
    if(!ChkDateTime(strtDate,strtTime,endDate,endTime)) {
       alert("Start Date/Time must be before End Date/Time");
       AddForm.optsm003.select();
       return;
     }
     AssignVal();
     document.AddForm.nextpage.value="6"
// 01 : CTAS : update redirects to oprweb0601901 not oprweb0601001
/*
     document.AddForm.redirect.value="oprweb06.pbl?reportno=1&template=001&"+
                             "uniqueky="+document.AddForm.uniqueky.value +
                             "&teamnumb="+document.AddForm.teamnumb.value +
                             "&suprlevl="+document.AddForm.suprlevl.value;
*/
     document.AddForm.redirect.value="oprweb06.pbl?reportno=1&template=901&"+
                             "uniqueky="+document.AddForm.uniqueky.value +
                             "&teamnumb="+document.AddForm.teamnumb.value +
                             "&suprlevl="+document.AddForm.suprlevl.value;
// end of change
     validateFF();
     AddForm.submit();    
  }
}   
function validateFF() {
  if (document.AddForm.optsm008.value.substr(5,1) == "F") {

    document.AddForm.updatety.value = "F";
    document.AddForm.opsdt001.value = document.AddForm.uniqueky.value;
    document.AddForm.opsdt002.value = document.AddForm.teamnumb.value;
    document.AddForm.opsdt003.value = document.AddForm.optsm001.value;
    document.AddForm.opsdt004.value = document.AddForm.stffname.value;
    document.AddForm.opsdt005.value = document.AddForm.optsm003.value;
    document.AddForm.opsdt006.value = document.AddForm.optsm004.value;
    document.AddForm.opsdt007.value = document.AddForm.optsm005.value;
    document.AddForm.opsdt008.value = document.AddForm.optsm006.value;
    document.AddForm.opsdt009.value = document.AddForm.optsm007.value;
    document.AddForm.opsdt010.value = document.AddForm.optsm008.value;

    if (document.AddForm.optsm009 != undefined) {
      document.AddForm.opsdt011.value = document.AddForm.optsm009.value;
    }

  } 
}
function displayFF() {
  if (document.AddForm.optsm008.value.substr(5,1) == "F") {
    staffcodetitleDIV.innerHTML = staffnametitleSPAN.innerHTML;
    staffcodefieldDIV.innerHTML = staffnamefieldSPAN.innerHTML;
  } else {
    staffcodetitleDIV.innerHTML = staffcodetitleSPAN.innerHTML;
    staffcodefieldDIV.innerHTML = staffcodefieldSPAN.innerHTML;
    document.AddForm.optsm002.value = document.AddForm.oldtm002.value;
    document.AddForm.stafdesc.value = document.AddForm.d_oldtm002.value;
  }
}
function valfirst() {
  if(document.AddForm.optsm001.value=="")
    alert(" Select StaffType First");
  else return true;
}
function validateNurse() {
  var hcpnurse = chkHcpOTNurse();
  if (hcpnurse==true){
     validateCode('18',document.AddForm.optsm002,
                       document.AddForm.stafdesc);
  }
  else {
     validateCode('17',document.AddForm.optsm002,
                       document.AddForm.stafdesc,
                       document.AddForm.gnm,
                       SetNurseName);
  }
}
function SetNurseName() {
AddForm.stafdesc.value=AddForm.gnm.value.replace(/\s*$/g,"")+
                              " " +
                            AddForm.stafdesc.value.replace(/\s*$/g,"")
}
function SearchCode(flag) {
if(valfirst()) {
   if ((document.AddForm.optsm001.value)==1) {
      if(flag==0)  
      DoctorSearchFrame(document.AddForm.optsm002,document.AddForm.stafdesc); 
      if(flag==1){
        validateCode(31,document.AddForm.optsm002,document.AddForm.stafdesc);
      }
   }
else { 
      if((document.AddForm.optsm001.value)==2) {
        if(flag==0)
        SearchOTNurse(document.AddForm.optsm002,document.AddForm.stafdesc); 
        if(flag==1) {
        validateNurse(document.AddForm.optsm002,document.AddForm.stafdesc) 
        }
      }
      else {
        if(flag==0)
        HCPSearchFrame(document.AddForm.optsm002,document.AddForm.stafdesc,4);
        if(flag==1) {
        ValidateHCP(18,13,document.AddForm.optsm002,document.AddForm.stafdesc)
        }
      }
    }
  }
}
function StaffType() {
  if (AddForm.optsm001.value=="2") {
    document.all.StaffOption.innerHTML=document.all.NurseType.innerHTML }
  else{
     document.all.StaffOption.innerHTML="";
   }
}
function showLayer(AddForm) {
  if ((document.AddForm.optsm001.value)==1) {
    document.all.StaffTypeOption.innerHTML=document.all.StaffCat1.innerHTML }
  else {
    if ((document.AddForm.optsm001.value)==2) {
       document.all.StaffTypeOption.innerHTML=document.all.StaffCat2.innerHTML }
    else {
      if ((document.AddForm.optsm001.value)==3) { 
       document.all.StaffTypeOption.innerHTML=document.all.StaffCat3.innerHTML }
      } 
   }
  if (document.AddForm.optsm002 != undefined) {
    document.AddForm.optsm002.value="";
    document.AddForm.stafdesc.value="";
  }
}
function SubmitMain() {
    parent.UpdateForm.updatety.value="U"
    casekey=parent.UpdateForm.casekeys.value.substr(0,26);
    casekey=casekey.replace(/ /g,"+");
// 01 : CTAS : update redirects to oprweb0601901 not oprweb0601001
/*
    parent.UpdateForm.redirect.value="oprweb06.pbl?reportno=1&template=1"+
                             "&suprlevl="+document.AddForm.suprlevl.value +
                                     "&casekeys="+casekey+"&teamnumb=";
*/
    parent.UpdateForm.redirect.value="oprweb06.pbl?reportno=1&template=901"+
                             "&suprlevl="+document.AddForm.suprlevl.value +
                                     "&casekeys="+casekey+"&teamnumb=";
// end of change
    parent.UpdateForm.submit();
}

// 01 : CTAS : remove removed oprweb0601901 fields from AssignVal()
/*
function AssignVal() {
         AddForm.teamnumb.value=parent.UpdateForm.teamnumb.value;
         AddForm.opsrg003.value=parent.UpdateForm.opsrg003.value
         AddForm.opsrg005.value=parent.UpdateForm.opsrg005.value
         AddForm.opsrg006.value=parent.UpdateForm.opsrg006.value
         if (parent.UpdateForm.opsrg004 != undefined) {
         AddForm.opsrg004.value=parent.UpdateForm.opsrg004.value
         }
         AddForm.opsrg007.value=parent.UpdateForm.opsrg007.value
         AddForm.opsrg008.value=parent.UpdateForm.opsrg008.value
         AddForm.opsrg050.value=parent.UpdateForm.opsrg050.value
         AddForm.opsrg051.value=parent.UpdateForm.opsrg051.value
         if (parent.UpdateForm.opsrg052 != undefined) {
         AddForm.opsrg052.value=parent.UpdateForm.opsrg052.value
         }
         AddForm.opsrg060.value=parent.UpdateForm.opsrg060.value
         AddForm.opsrg071.value=parent.UpdateForm.opsrg071.value
         AddForm.opdea014.value=parent.UpdateForm.opdea014.value
         AddForm.opdea015.value=parent.UpdateForm.opdea015.value
         AddForm.opdea016.value=parent.UpdateForm.opdea016.value
         AddForm.optsm007.value=parent.UpdateForm.optsm007.value
    }
*/
function AssignVal() {
         AddForm.teamnumb.value=parent.UpdateForm.teamnumb.value;
         AddForm.optsm007.value=parent.UpdateForm.optsm007.value
    }
// end of change


// 01 : CTAS : remove Other option from Staff Type list
function setStaffTypeList() {
        var stafflist = AddForm.optsm001;
        for (var i=0; i<stafflist.options.length; i++) {
                if (stafflist.options[i].value === "3")
                        stafflist.remove(i);
        }
}
// end of change


//C-0825792 - Check parameter to use pmshcpaf/oprnuraf for OT Nurse
function chkHcpOTNurse(){
  if (document.getElementById('opcnurse')) {
      if (document.getElementById('opcnurse').value == "1") {
        return true;
      }
      else {
        return false;
      }
  }
  else {
      return false;
  }
}
//C-0825792 - Search Nurse from pmshcpaf/oprnuraf for OT Nurse
function SearchOTNurse(NurseId,ReturnNurseName) {
  var hcpnurse = chkHcpOTNurse();
  if (hcpnurse==true){
     HCPSearchFrame(NurseId,ReturnNurseName,20);
  }
  else {
     NurseSearchFrame(NurseId,ReturnNurseName);
  }
}
</script>
</head>
%START.OF.PAGE
<!-- 01 : CTAS : call setStaffTypeList when page loaded
<body onload="PageLoad(event);" onsubmit='return validateMandatory(this);'>
-->
<body onload="PageLoad(event);setStaffTypeList();" onsubmit='return validateMandatory(this);'>
<!-- end of change -->
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="SubmitMain();">
Staff Members Maintenance
</span>

<form  id=AddForm name=AddForm action="oprweb06.pbl" method=post
 onsubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=002>
<input type=hidden name=updatety value="S">
<input type=hidden name=casekeys value="%OPRWEB06.01.101">
<input type=hidden name=uniqueky value='%OPRWEB06.01.110'>
<input type=hidden name=teamnumb value="%OPRWEB06.01.334">
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value="">
<!-- 03 : DXC : add value to hidden time fields -->
<input type=hidden name=opsrg003 value="%OPRWEB06.01.203">
<!-- end of change -->
<!-- 04 : TAS : add value to hidden time fields -->
<input type=hidden name=opsrg004 value="%OPRWEB06.01.204">
<!-- end of change -->
<!-- 03 : DXC : add value to hidden fields -->
<input type=hidden name=opsrg005 value="%OPRWEB06.01.205">
<input type=hidden name=opsrg006 value="%OPRWEB06.01.206">
<input type=hidden name=opsrg007 value="%OPRWEB06.01.207">
<!-- end of change -->
<input type=hidden name=opsrg008>
<input type=hidden name=opsrg050>
<input type=hidden name=opsrg051>
<input type=hidden name=opsrg052>
<!-- 03 : DXC : add value to hidden fields -->
<input type=hidden name=opsrg060 value="%OPRWEB06.01.246">
<input type=hidden name=opsrg076 value="%OPRWEB06.01.276">
<!-- end of change -->
<input type=hidden name=opsrg071>
<!-- CTAS 02: Add values to hidden fields -->
<input type=hidden name=opdea014 id=opdea014  value="%OPRWEB06.01.124">
<input type=hidden name=opdea015 id=opdea015  value="%OPRWEB06.01.125">
<input type=hidden name=opdea016 id=opdea016  value="%OPRWEB06.01.126">
<input type=hidden name=optsm007>
<input type=hidden name=suprlevl value="%OPRWEB06.01.313">
<input type=hidden name=gnm>
<input type=hidden name=opsdt001 value="">
<input type=hidden name=opsdt002 value="">
<input type=hidden name=opsdt003 value="">
<input type=hidden name=opsdt004 value="">
<input type=hidden name=opsdt005 value="">
<input type=hidden name=opsdt006 value="">
<input type=hidden name=opsdt007 value="">
<input type=hidden name=opsdt008 value="">
<input type=hidden name=opsdt009 value="">
<input type=hidden name=opsdt010 value="">
<input type=hidden name=opsdt011 value="">
<input type=hidden name=opsdt012 value="">
<input type=hidden name=oldtm002 value="">
<input type=hidden name=d_oldtm002 value="">
<input type=hidden name=opcnurse id=opcnurse
       value="%STANDARD.01.025.113.051.0.1">

<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td class=DataLabel width=21%>Staff Type</td>
    <td class=DataField>
    <select id=optsm001 name=optsm001 class=Mandatory title="Staff Type"
      onchange="showLayer(AddForm);StaffType()">
    <option selected ></option>
     %OPRWEB06.01.318.1    
    </select></td></tr>
<tr><td class=DataLabel><div id="staffcodetitleDIV">Staff Code</div></td>
    <td>
    <div id="staffcodefieldDIV">
    <input type=text  id=optsm002 name=optsm002  size=6 title="Staff Code" 
     class=Mandatory onblur="SearchCode(1);
            document.AddForm.oldtm002.value=this.value;
            document.AddForm.d_oldtm002.value=document.AddForm.stafdesc.value;">
    <input type=text name=stafdesc class=ReadOnly readonly> 
    <img src=../images/SearchIcon.gif class=Icon onclick="SearchCode(0);">
    </div>
    </td></tr>
<tr><td class=DataLabel>Start Date</td>
    <td class=DataLabel>
    <input type=text size=12 name=optsm003 title="Start Date" class=Mandatory
     id=optsm003 value="%OPRWEB06.01.104">
    <img src=../images/DateLookup.gif class=Icon date=AddForm.optsm003>
    Time <input type=text size=12 id=optsm004 name=optsm004 
      title="Start Time" class=Mandatory value="%OPRWEB06.01.111">
    <img src=../images/DateTimeStamp.gif class=Icon  
     date=AddForm.optsm003 time=AddForm.optsm004 >
    <img src=../images/TimeLookup.gif class=Icon time=AddForm.optsm004>
    </td></tr>
<tr><td class=DataLabel>End Date</td>
    <td class=DataLabel>
    <input type=text size=12 id=optsm005 name=optsm005 title="End Date">
    <img src=../images/DateLookup.gif class=Icon date=AddForm.optsm005>
    Time <input type=text size=12 id=optsm006 name=optsm006 title="End Time">
    <img src=../images/DateTimeStamp.gif class=Icon
     date=AddForm.optsm005  time=AddForm.optsm006>
    <img src=../images/TimeLookup.gif class=Icon time=AddForm.optsm006>
    </td></tr>
</table>
<span id=StaffTypeOption></span>
<span id=StaffOption></span>
<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td colspan=2 align=center>
<br><input type=button value="Add" class="button" id="opr06sub" 
    onclick="tempDisable(this);validateData();">
  <input type=button value="Cancel" class="button" onclick="SubmitMain()">
    </td></tr>
</table>
</form>
<span id=NurseType style="display:none">
<table width=95% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel width=21%>Final Instrument Count</td>
    <td class=DataField><input type=checkbox name=optsm009
         title="Instrument Count" value="1"></td></tr>
</table>
</span>
<span id=StaffCat1 style="display:none">
<table width=95% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel width=21%>Staff Category</td>
    <td class=DataField>
    <select  name=optsm008 title="Staff Category" class=Mandatory 
     onchange="displayFF();">
    <option selected></option>
     %OPRWEB06.01.331.2
    </select>
</td></tr>
</table>
</span>
<span id=StaffCat2 style="display:none">
<table width=95% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel width=21%>Staff Category</td>
    <td class=DataField>
    <select name=optsm008 title="Staff Category" class=Mandatory 
     onchange="displayFF();">
    <option selected></option>
     %OPRWEB06.01.332.2
    </select>
</td></tr>
</table>
</span>
<span id=StaffCat3 style="display:none">
<table width=95% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel width=21%>Staff Category</td>
    <td class=DataField>
    <select name=optsm008 title="Staff Category" class=Mandatory 
     onchange="displayFF();">
    <option selected></option>
<!-- %OPRWEB06.01.327.2  -->
<!--          Cat."OF" reject Ind.1 = "R" (Reason for Referral) -->
     %OPRWEB06.01.327.9.1.01.2.R
    </select>
</td></tr>
</table>
</span>

<span id="staffcodetitleSPAN" style="display:none">Staff Code</span>

<span id="staffcodefieldSPAN" style="display:none">
    <input type=text  id=optsm002 name=optsm002  size=6 title="Staff Code"
     class=Mandatory onblur="SearchCode(1);
            document.AddForm.oldtm002.value=this.value;
            document.AddForm.d_oldtm002.value=document.AddForm.stafdesc.value;">
    <input type=text id=stafdesc name=stafdesc class=ReadOnly readonly>
    <img src=../images/SearchIcon.gif class=Icon onclick="SearchCode(0);">
</span>

<span id="staffnametitleSPAN" style="display:none">Staff Member Name</span>

<span id="staffnamefieldSPAN" style="display:none">
    <input type=text id=stffname name=stffname size=80 title="Staff Member Name"
     maxlength=60 class=Mandatory>
</span>
