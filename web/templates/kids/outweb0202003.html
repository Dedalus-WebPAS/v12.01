<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="kids">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
var SlotCode;
var SlotDate;
var SlotName;
var SlotVist;
var SlotCtyp;
var SlotCcod;
function updateParent(code,name,date,vist,clint,clinc,clinind,clinbst,hic) {
    var clindate = code.substr(12,8);
    var FollowEdit=document.getElementById("otcnfoll").value;
    if(parent.document.getElementById("d_followdt")) {
      var bookin_date=parent.document.getElementById("d_followdt").value;
      if(SetDateYYYYMMDD(bookin_date) > clindate) {
        if(FollowEdit==1) {
          if(!confirm("Warning: Follow up date selected is prior to the " +
                "date of the original booking. \nPress CANCEL to " +
                "select another date.")) {
            return;
          }
        }
        if(FollowEdit==2) {
          alert("Error Message: Follow up date selected is prior to the " +
                "date of the original booking. \nPlease select another " +
                "date.");
          return;
        }
      }
    }
    SlotCode=code
    SlotDate=date
    SlotName=name
//    SlotVist=vist
//    SlotCtyp=clint
//    SlotCcod=clinc
if (typeof(parent.AddForm)=='object' &&
   typeof(parent.AddForm.clinindi)=='object') {
   parent.AddForm.clinindi.value=clinind
}
//Clinic Indicator (billing status=P ?)
if (typeof(parent.AddForm)=='object' &&
   typeof(parent.AddForm.clinindc)=='object') {
       parent.AddForm.clinindc.value=clinbst;
    }

//New Slot key
if (typeof(parent.AddForm)=='object' &&
   typeof(parent.AddForm.nslotkey)=='object') {
       parent.AddForm.nslotkey.value=code;
    }

//visit type
 if(typeof(parent.AddForm)=='object' && parent.AddForm.outbb047.type=='select-one') {
     for (var i =0 ; i < parent.AddForm.outbb047.length; i++) {
     if (trim(parent.AddForm.outbb047.options[i].value.substr(0,3))==trim
(vist)) {
       parent.AddForm.outbb047.selectedIndex=i }
     }
    }

//clinic type
 if(typeof(parent.AddForm)=='object' && parent.AddForm.clintype.type=='text' && typeof(parent.AddForm.clintype)=='object') {
       parent.AddForm.clintype.value=clinc
       parent.AddForm.outbb016.value=clint
    }
// Added for diagnosis search
//
if (typeof(parent.AddForm)=='object' && 
   typeof(parent.AddForm.defclnty)=='object') {
       parent.AddForm.defclnty.value=clint;
    }
//
// Clinic using medclaims )
if (typeof(parent.AddForm)=='object' &&
   typeof(parent.AddForm.otmaumci)=='object') {
       parent.AddForm.otmaumci.value=hic;
    }
//
    reserveSlot(code,"","","",UpdatePage)
}
function UpdatePage() {
  if (typeof(parent.ReturnFunction) == 'function'){
     parent.ReturnFunction()
  }
    parent.ReturnCode.value=SlotCode
    parent.ReturnName.value=SlotName
    parent.ReturnDate.value=SlotDate
    parent.document.getElementById('PopUpScreen').style.display="none"
} 
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<div id=PageHeadingSection>
<span class=DFrameTitleBar>
  <img align="right" alt="Exit" class="MenuIcon" 
  src="../images/ExitIcon.gif" onclick="DFrameExit();">
  <script type="text/javascript">document.write(self.document.title);
  </script>
</span>
<form name=SelectPeriod action=outweb02.pbl method=get style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=003>
<input type=hidden name=otcnfoll id=otcnfoll
 value="%STANDARD.01.025.032.147.0.1">
<table cellspacing=0 cellpadding=1 bgcolor=#CCCCCC border=1 width=100%>
<tr><td class=DataField>%OUTWEB02.02.006 Appointment List &nbsp; </td>
    <td><input type=button value="<<" class=SmallButton
        onClick='location.href="%OUTWEB02.02.002"'>
        <select name=sesskeys onchange='document.SelectPeriod.submit();'>
        %OUTWEB02.02.003
        </select>
        <input type=button value=">>" class=SmallButton
        onClick='location.href="%OUTWEB02.02.001"'></td></tr>
</table>
</form>
</div>
<div id=PageBodySection>
<table cellspacing=0 cellpadding=1 width=100% border=1>
<tr>
    <td align=center width=60 nowrap class=HeadingCell>Time</td>
    <td class=HeadingCell>Visit Type</td>
    <td class=HeadingCell>Patient</td>
    <td class=HeadingCell>Status</td>
</tr>

%OUTWEB02.02.032                 
</table>
</div>
<script type="text/javascript">
PageBodySection.style.height=document.body.clientHeight - 
                             PageHeadingSection.clientHeight 
</script>
