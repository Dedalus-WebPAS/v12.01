<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="kids">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/preadmission.js">   </script>
<script type="text/javascript" src="../js/ndis.js"></script>
<script language="javascript">
function SubmitAdm() {
    MandatoryOk=true;
    if (!validateMandatory(document.UpdateForm)) {
       return;
    }
    if (!isWhitespace(UpdateForm.ptmis013.value)) {
        if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
                       UpdateForm.funddesc,UpdateForm.tabldesc)) {
           ans=confirm("Select another active health fund table? ");
           if (ans==true) {
              return;
           } 
        } 
    }

  if(document.UpdateForm.mvmedre1.checked == true) {
     document.UpdateForm.mvmedrec.value="1";
  } else {
     document.UpdateForm.mvmedrec.value="0";
  }
if (MandatoryOk) {
    ValMedicare01();
    if (ans==false){
       return;
    }
    CheckPreadmitDate();
    if (ans==false){
       return;
    }
    setRedirect();
    UpdateForm.ptmis004.value=UpdateForm.ptmis068.value;
    UpdateForm.ptmis005.value=UpdateForm.ptmis076.value;
    SubmitHidden(UpdateForm);
   }
}
function checkZeroTime(){
  time=document.UpdateForm.ptmis002.value.substr(0,5)
  if(time=="00:00"){
     alert("Invalid Time.")
     document.UpdateForm.ptmis002.focus();
    }
}
function AdmitMandatory() {
 if(document.UpdateForm.admitbox.checked == true) {
     document.UpdateForm.admitbox.value="1";
     document.UpdateForm.ptmis013.className="Mandatory";
     document.UpdateForm.ptmis014.className="Mandatory";
     document.UpdateForm.mvmedre1.checked=true;
   } else {
     document.UpdateForm.admitbox.value="0";
     document.UpdateForm.mvmedre1.checked=false;
     document.UpdateForm.ptmis013.className="";
     document.UpdateForm.ptmis014.className="";
   }
}
function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
  selectOptions("30",UpdateForm.ptmis007,UpdateForm.ptmis024);
  UpdateForm.ptmis024.selectedIndex=1
}
function valClaimCode() {
  validateCode(41,UpdateForm.urnumber,UpdateForm.claimc);
  for (var i =0 ; i < document.UpdateForm.ptmis027.length; i++) {
//    alert(UpdateForm.ptmis027.options[i].value.substr(0,3));
    if (document.UpdateForm.claimc.value==
        trim(document.UpdateForm.ptmis027.options[i].value.substr(0,3))){
          document.UpdateForm.ptmis027.selectedIndex=i;
    }
  }
}
function defaultLOS() {
    validateCatCode(UpdateForm.pw,UpdateForm.ptvis023,UpdateForm.dummy, + 
                    UpdateForm.dummy,UpdateForm.dummy,UpdateForm.assoc)
    document.UpdateForm.ptmis030.value=UpdateForm.assoc.value
}
function DefaultCMBS() {
    if(UpdateForm.ptvis043.value.substr(3,1)=="2"){
    for (var i =0 ; i < document.UpdateForm.ptmis010.length; i++) {
    if (document.UpdateForm.ptmis010.options[i].value.substr(0,3)=="Z3 ") {
       document.UpdateForm.ptmis010.selectedIndex=i } };
   }
   if(UpdateForm.ptvis043.value.substr(3,1)=="1"){
    for (var i =0 ; i < document.UpdateForm.ptmis010.length; i++) {
    if (document.UpdateForm.ptmis010.options[i].value.substr(0,3)=="D  ") {
       document.UpdateForm.ptmis010.selectedIndex=i } };
   }
}
function validateExternalVisitID(externalID) {
  if (isWhitespace(externalID.value)) {
    return;
  }
  var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=49" +
                   "&valdalvn=" +
                   externalID.value.replace(/ /g,"+");
  var returnValue = RSExecute(serverURL);
  if (returnValue.status!=0) {
    externalID.value="";
    externalID.focus();
  }
}
function defProgramID() {
  if (trim(PatientSPF)=="1") {
    for (var i =0 ; i < document.UpdateForm.ptvis110.length; i++) {
      if (trim(document.UpdateForm.ptvis110.options[i].value.substr(14,4))=="07"){
        document.UpdateForm.ptvis110.selectedIndex=i;
      }
    }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisplayTrnSrc();
              document.UpdateForm.ptmis001.focus();
              valClaimCode();DisplayContractSTV();defProgramID();
              ShowNdisPart();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.03.003";
PatientVIS="%PATWEB89.03.081";
PatientNAM="%PATWEB89.03.002";
PatientSTA="%PATWEB89.03.086.078";
PatientALT="%PATWEB89.03.084";
PatientSEX="%PATWEB89.03.019";
PatientDOB="%PATWEB89.03.020";
PatientAGE="%PATWEB89.03.021";
PatientLOC="%PATWEB89.03.083";
PatientPRI="%PATWEB89.03.086.066.1";
PatientUNT="%PATWEB89.03.066.0";
DoctorCOD="%PATWEB89.03.082.003";
DoctorNAM="%PATWEB89.03.082.002";
PatientAID="%PATWEB89.03.086.090";
PatientIND="%PATWEB89.03.086.091";
PatientCUR="%PATWEB89.03.086.092";
PatientCLC="%PATWEB89.03.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.03.086.094";
PatientCDM="%PATWEB89.03.086.095";
PatientVDH="%PATWEB89.03.086.099.015";
PatientSPF="%PATWEB89.03.085.067";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form name=linkForm action=patweb89.pbl method=post style=margin:0>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.081">
</form>
<form name=UpdateForm method=post action=patweb89.pbl style=margin:0>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.081">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value="001">
<input type=hidden name="updatety" value="1">
<input type=hidden name="redirect">
<input type=hidden name="allocate" value="1">
<input type=hidden name="chckname" value="0">
<input type=hidden name="emradmit" value="0">
<input type=hidden name="emradmis" value="0">
<input type=hidden name="admitnow" value="1">
<input type=hidden name="newbmand" value="0">
<input type=hidden name="agebmand" value="0">
<input type=hidden name="mvmedrec">
<input type=hidden name="cfinan" value="%PATWEB89.03.932">
<input type=hidden name="preadbok" value="0">
<input type=hidden name="ptmas017" value="%PATWEB89.03.020">
<input type=hidden name="ptmas021" value="%PATWEB89.03.024.3">
<input type=hidden name="ptmas023" value="%PATWEB89.03.027">
<input type=hidden name="ptmsx045" value="%PATWEB89.03.649">
<input type=hidden name="dummy">
<input type=hidden name="assoc">
<input type=hidden name="claimc">
<input type=hidden name="exstward" value="%PATWEB89.03.449.1">
<input type=hidden name="ibaalvin" id="ibaalvin" value="1">
<input type=hidden name=ptcnhdps id=ptcnhdps
       value="%STANDARD.01.025.080.250.1.1">

<input type=hidden name=ptcndigp id=ptcndigp
       value="%STANDARD.01.025.124.122.0.1">

<table border=1 colspan=1 width=100% cellspacing=1 cellpadding=1 >
<tr><td class=HeadingCell align=center>
    Patient Pre-Admission Details (New) </tr>
<tr>
<tr><td>
    <table width=100%  border=0 class=TableBody cellpadding=0 cellspacing=0>
     <tr> <td>&nbsp;</td><td>&nbsp;</td>
         <td align=left><b>Admit Now?</b></td>
        <td align=left>
        <input type="checkbox" name="admitbox" value="1" notab
           onclick='AdmitMandatory()';>
        </td></tr>
     <tr><td class=DataLabel>Admission Date </td>
         <td><input type=text size=12 name=ptmis001 tabindex=1 id=ptmis001
             class="Mandatory Date" title="Admission Date" 
             value="%STANDARD.01.015">
         <img notab src=../images/DateLookup.gif class=Icon
              onclick="DateLookupFrame(ptmis001);">     
              Time 
         <input class=Mandatory type=text name=ptmis002 size=8 tabindex=2
              value="%STANDARD.01.016" title="Admission Time" id=ptmis002
              onblur="checkZeroTime();">
         <img notab src=../images/DateTimeStamp.gif class=Icon 
              onClick="SetCurrentDateTime(null,ptmis002);">
         <img notab src=../images/TimeLookup.gif class=Icon 
              onclick="TimeLookupFrame(ptmis002);">
         </td>
             <td>%STANDARD.01.017.PK</td>
             <td><select name=ptvis110 tabindex=5>
             <option></option>
              %STANDARD.01.007.PK
             </select></td>
     </tr>
     <tr><td class=DataLabel>Admission Source</td>
         <td><select name=ptmis009 tabindex=3 class=Mandatory
               onchange="DisplayTrnSrc()" title='Admission Source'>
               <option> </option>
               %PATWEB89.03.110.2
               </select></td>
          <td class=DataLabel>%STANDARD.01.017.P </td>
          <td><select name=ptmis011 tabindex=6 class=Mandatory 
               title="%STANDARD.01.017.P ">
              <option> </option>
                 %PATWEB89.03.112.2
              </select></td>
      </tr>
      <tr> 
          <td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>

          <td class=DataLabel>Criteria for Admission</td>
          <td>
          <select name=ptvis041 tabindex=7 class=Mandatory 
                  title='Criteria for Admission'>
          <option> </option>
          %PATWEB89.03.244.2
          </select>
          </td><tr>
       <tr><td align=left>Prior Days Hospitalisation</td>
       <td align=left>
       <input name=ptmis031 title='Prior Days Hospitalisation' tabindex=4
       class=Integer size=5 maxlength=4 onblur="checkInteger(this,this.value);">
       </td>

          <td class=DataLabel>Intended Stay</td>
          <td>
          <select name=ptvis043 tabindex=8 class=Mandatory 
                  title='Intended Stay' onchange="DefaultCMBS();">
          <option> </option>
          %PATWEB89.03.246.2
          </select>
          </td>
          </tr>
       <tr align=left>
       <td align=center colspan="4">
       <hr>
       </td>
      <tr><td class=DataLabel>Attending Doctor</td>
          <td><input type="text" size=8 maxlength=6 name="ptmis007" tabindex=9
               class=Mandatory title='Attending Doctor' id=ptmis007
               onblur="UpCase(this);valDoctorUnit();">
              <input type=text readonly class="Mandatory" size=25 
                     notab name=doctnam2 id=doctnam2>
              <img notab src="../images/SearchIcon.gif" class=Icon
               onClick="DoctorSearchFrame(ptmis007,doctnam2)"></td>
          <td class=DataLabel>Unit</td>
          <td><select name=ptmis024 tabindex=10 class="Mandatory SelectBig"
                title='Unit'>
                <option> </option>
                 %PATWEB89.03.124.2
              </select>
          </td></tr>
      <tr><td class=DataLabel>Diagnosis </td>
          <td><input tabindex=11 type=text name="ptmis020" 
                     class=Mandatory title='Diagnosis' size=50 maxlength=80>
          </td>
          <td class=DataLabel>Procedure </td>
          <td><input tabindex=12 type=text name="ptvis064" size=30 maxlength=30>
          </td>
    <tr><td class=DataLabel>Clinical Pathway</td>
        <td><input type=hidden name=pw value="PW">
            <select name=ptvis023 tabindex=13 onchange=defaultLOS();>
            <option value=""></option>
            %PATWEB89.03.226.2
            </select></td>
       <td class=DataLabel> Expected Length of Stay</td>
        <td><input type=text size=5 maxlength=5 name=ptmis030
             tabindex=14 title='Expected Length of Stay'
             class=Integer onblur="checkInteger(this,this.value);">
            </td></tr>
        <tr><td>Admitting Point</td>
        <td><select name="ptvis046" tabindex=15 class=Mandatory 
            title='Admitting Point' onChange="defaultWard()">
            <option value=""> </option>
            <option value="DSU                   ">Day Surgery Unit    </option>
            %PATWEB89.03.290.4
          </select>
        </td>
         <td class=DataLabel>Ward / Bed </td>
         <td><input type=hidden name=bedstat1 id=bedstat1>
           <input type=hidden name=ptmis004 id=ptmis004>
           <input type=hidden name=ptmis005 title="Bed" id=ptmis005>
           <input type=hidden name=warddesc id=warddesc>
           <select name=ptmis068 id=ptmis068 tabindex=16 class=Mandatory title='Ward'>
            <option value=""> </option>
                %PATWEB89.03.449.2
           </select>
           <input type=text name=ptmis076 notab title="Bed"  id=ptmis076
                  maxlength=3 size=3>
           <img notab src=../images/SearchIcon.gif class=Icon
            onClick="WardBedSearchFrame(ptmis068,warddesc,ptmis076,bedstat1);">
          </td>
      </tr>
       <tr align=left>
       <td align=center colspan="4">
       <hr>
       </td>
        <tr><td>Care Managed</td>
        <td>&nbsp; </td>
        <td class=DataLabel>Referring GP</td>
        <td><input type="text" size=10 maxlength=10 name="ptvis028" tabindex=17
             onblur="ValidateHCP(18,0,ptvis028,doctnam1);">
            <input type="text" size=25 notab readonly name="doctnam1">
            <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(UpdateForm.ptvis028,UpdateForm.doctnam1,0);">
          <td></tr>
        <tr><td>RMO Responsible</td>
        <td>&nbsp; </td>
          <td class=DataLabel>Inform GP</td>
          <td>
          <select name=ptvis022 tabindex=18>
          <option value="0">No</option>
          <option value="1">Yes</option>
          </select>
          </td></tr>

    <tr><td class=DataLabel></td>
        <td></td>
        <td class=DataLabel>Program</td>
        <td><input type=text size=8 maxlength=8 name=ptvis099
             title="Program" tabindex=19 value="%PATWEB89.03.298.021.1"
             onchange="findPrgmdesc();">
            <select name=prgmcode Readonly class=readonly
             onchange="savePrgmcode();">
              <option> </option>
              %PATWEB89.03.298.021.2
            </select>
        </td>
    </tr>

    <tr id=ndispart style="display:none"><td>&nbsp;</td>
        <td>&nbsp;</td>
        <td class=DataLabel>%STANDARD.01.035.N </td>
        <td><select name=ptvis121 id=ptvis121 title="%STANDARD.01.017.N "
             tabindex=20>
            <option> </option>
             %PATWEB89.03.298.066.9.2
            </select></td></tr>

    <tr align=left>
      <td align=center colspan="4"><hr></td>
    </tr>

    <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
        <td align=left>
          <select name=ptmis027 tabindex=20 title="%STANDARD.01.017.CL" 
           class=Mandatory>
            <option> </option>
            %PATWEB89.03.126.4
          </select>
        </td>
        <td class=DataLabel>Claim form Signed</td>
        <td>
          <select name=ptvis021 tabindex=26 class=Mandatory 
           title="Claim form signed">
            <option value=0> NO </option>
            <option value=1> YES </option>
          </select>
        </td>
    </tr>

    <tr><td class=DataLabel>%STANDARD.01.017.A </td>
        <td><select name=ptmis010 tabindex=21 title="%STANDARD.01.017.A "
             class=Mandatory onchange="DisplayContractSTV();">
              <option> </option>
              %PATWEB89.03.111.4
            </select>
        </td>
        <td class="DataLabel"><div id="Contrac2Heading"></div></td>
        <td><div id="ContractId"></div></td>
    </tr>

    <tr><td class="DataLabel"><div id="ContractHeading"></div></td>
        <td><div id="ContractType"></div></td>
        <td class="DataLabel"><div id="Contrac1Heading"></div></td>
        <td><div id="ContractRole"></div></td>
    </tr>

    <tr><td class=DataLabel>Health Fund </td>
        <td><input type=text size=6 maxlength=6 name=ptmis013  id=ptmis013
             title="Health Fund" tabindex=23
             onchange="validateCode(16,document.UpdateForm.ptmis013,funddesc);
             checkTableadm();" value="%PATWEB89.03.040.0">
            <input type=text size=30 maxlength=30 name=funddesc class=readonly
             Readonly notab value="%PATWEB89.03.040.1" id=funddesc>
        </td>
        <td class=DataLabel>External Visit ID</td>
        <td><input type=text size=30 maxlength=20 name=ibalv001 id=ibalv001
             title="External Visit ID" tabindex=28
             onblur="validateExternalVisitID(this);">
        </td>
    </tr>

<tr><td class=DataLabel>Level of Insurance</td>
    <td width=22%>
        <input name="ptmis014" size=8 maxlength=8  id=ptmis014
         tabindex=24 value="%PATWEB89.03.041.0"
         title="Level of Insurance"
         onblur="validateHFT(20,ptmis013,ptmis014,funddesc,tabldesc);">
        <input type="text" size=15 maxlength=17 name="tabldesc" id=tabldesc
         class=readonly Readonly notab value="%PATWEB89.03.041.1" >
        <img src=../images/SearchIcon.gif class=Icon 
         onClick="HealthFundSearchFrame(ptmis013,funddesc,ptmis014,tabldesc);">
        <img src="../images/erase.gif"  class=Icon
         onClick="clrDoc(ptmis013,ptmis014);clrDoc(funddesc,tabldesc);
                  checkTableadm();">
    </td>
    <td class=DataLabel>Care Type</td>
    <td>
        <table width=100%  border=0 class=TableBody cellpadding=0 cellspacing=0>
        <tr><td>
        <select name=ptmis012 tabindex=29 class=Mandatory title='Care Type'> 
        <option> </option>
         %PATWEB89.03.113.4
        </select>
            </td>
          </tr>
          </table>
    </td>
</tr>
   <tr><td class=DataLabel> Member Number</td>
      <td><input type=text size=20 maxlength=19 name=ptmis015 tabindex=25
       value="%PATWEB89.03.042">
      </td>
        <td align=left>Move Medical Record</td>
        <td align=left>
        <input type="checkbox" name="mvmedre1" value="1" tabindex=30>
        </td></tr>


      <tr align=center>
       <td colspan=4 align=center><br>
       <input type=button value="Ok" class="button" tabindex=35
        id="pat89sub"
        onClick="tempDisable(this);checkBedStatus(UpdateForm.ptmis068.value,
                 UpdateForm.ptmis076.value,UpdateForm.ptmis001.value,
                 UpdateForm.ptmis030.value,SubmitAdm)";>
       <input type=button value="Cancel" class="button" tabindex=36
             onclick="PatientLinkTo('patweb98.pbl',1,1,0);">

    </table>
</td></tr>
</table>
</form>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.101">
<input type=hidden name=MenuType value="%PATWEB89.03.088">
</form>
</div>
<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 tabindex=19  id=ptmis058
         title="Referral Date">
         <img notab src=../images/DateLookup.gif class=Icon
          onclick="DateLookupFrame(ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
    <td><input type=text size=12 name=ptmis059 tabindex=20  id=ptmis059
         title="Consultation Date">
         <img notab src=../images/DateLookup.gif class=Icon
          onclick="DateLookupFrame(ptmis059);"></td></tr>
</table>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Admission Weight</td>
    <td><input type=text name=ptmis051 size=5 maxlength=4>grams</td></tr>
</table>
</span>

<span id=NewBorn style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
    <td><input type=text name=ptmis041 maxlength=3 size=4 tabindex=21> weeks
    </td></tr>
</table>
</span>

<script type="text/javascript">

function init(){
 document.UpdateForm.admitbox.checked = false;
 document.UpdateForm.admitbox.value="0";
 document.UpdateForm.mvmedre1.checked = false;
}
 if ("%PATWEB89.03.905" == "1") {
  alert("Warning: Patient is currently admitted");
 }
 if ("%PATWEB89.03.903" == "1") {
  alert("Warning: Patient has a Waiting List Procedure");
 }
 if ("%PATWEB89.03.904" == "1") {
  alert("Warning: Patient has a Booking");
 }
  Day=document.UpdateForm.ptmis001.value.substr(0,2).replace(/ /g,"0")
  Dat=document.UpdateForm.ptmis001.value.substr(2)
  document.UpdateForm.ptmis001.value=Day + Dat
  
 var p = document.UpdateForm;

 var informGP = "%PATWEB89.03.225.0";      //ptvis022
 valInformGP(p.ptvis022,informGP,p.ptcndigp.value);

</script>
<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</tr>
</span>
<span id=transfersrc style="display:none">
<td><input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
      title="Transfer Source" tabindex=4 id=trnsfsrc
      onchange="validateCode(9,trnsfsrc,trandesc);">
     <input type=text size=27 name=trandesc notab id=trandesc
      class=Readonly readonly>
     <img src="../images/SearchIcon.gif" class=Icon
      onClick="TransferSourceFrame(trnsfsrc,trandesc)"></td>
</tr>
</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>

<span id="contracthd" style="display:none">
Contract Type
</span>

<span id="contracrhd" style="display:none">
Contract Role
</span>

<span id="contracihd" style="display:none">
 Contract Id
</span>

<span id="contracttype" style="display:none">
  <input type="text" name="ptasf001" size="2" maxlength="1" class="Mandatory"
   value="%PATWEB89.03.199.001" tabindex=22
   title="Contract Type" onblur="ContType(this);" />
  <img src="../images/SearchIcon.gif" class=Icon onClick="ContTypeAlert();" />
</span>

<span id="contractid" style="display:none">
<td><input type="text" size="7" maxlength="5" name="ptasf003"
     title="Contract Id" tabindex=27 id=ptasf003
     onblur="validateCode(9,ptasf003,d_ptasf003);" />
    <input type="text" size="27" name="d_ptasf003" notab id=d_ptasf003
     class="Readonly" readonly />
    <img src="../images/SearchIcon.gif" class=Icon
     onClick="TransferSourceFrame(ptasf003,d_ptasf003)" /></td>
</span>

<span id="contractrole" style="display:none">
  <input type="text" name="ptasf002" size="2" maxlength="1" class="Mandatory"
   value="%PATWEB89.03.199.002" tabindex=28
   title="Contract Role" onblur="ContRole(this);" />
  <img src="../images/SearchIcon.gif" class=Icon onClick="ContRoleAlert();" />
</span>

<span id="blanklabel" style="display:none">&nbsp;</span>
