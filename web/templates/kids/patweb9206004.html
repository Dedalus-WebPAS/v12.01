<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="kids">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function selectView(viewTypeValue) {
  document.SelectView.viewtype.value=viewTypeValue
  document.SelectView.submit();
}
//
function SelectView2(ViewType) {
  document.SelectPeriod.viewtype.value=ViewType
  if (document.SelectPeriod.lastdate!=undefined) {
     document.SelectPeriod.lastdate.value="" }
  if (document.SelectPeriod.vyearmth!=undefined) {
     document.SelectPeriod.vyearmth.value="" }
  UpdateFields()
  document.SelectPeriod.submit();
}
//
function clearData(){
  for(var i=0;i<window.document.ProcessForm.elements.length;i++)
  {   
     var e= window.document.ProcessForm.elements[i];
     if (e.type=="checkbox")
     e.checked=1;
     if (e.type=="select-one"||e.type=="select")
     e.selectedIndex=0;
  }
}
//
function SubmitSelection() {
  UpdateFields()
  document.SelectPeriod.submit();
}
//
function UpdateFields() {
  document.SelectPeriod.schdprn1.value=document.ProcessForm.schdprn1.value
  document.SelectPeriod.schdprn2.value=document.ProcessForm.schdprn2.value
  document.SelectPeriod.schdprn3.value=document.ProcessForm.schdprn3.value
  document.SelectPeriod.labeltyp.value=document.ProcessForm.labeltyp.value
  document.SelectPeriod.statnco1.value=document.ProcessForm.statnco1.value
  document.SelectPeriod.statnco2.value=document.ProcessForm.statnco2.value
  document.SelectPeriod.schdcop1.value=document.ProcessForm.schdcop1.value
  document.SelectPeriod.schdcop2.value=document.ProcessForm.schdcop2.value
  document.SelectPeriod.schdcop3.value=document.ProcessForm.schdcop3.value
}
//
function setRedirect(serverURL) {
  prt1=serverURL.substring(146,149);
  prt2=serverURL.substring(159,162);
  prt3=serverURL.substring(172,175);
  lab1=serverURL.substring(185,195);
  sta1=serverURL.substring(205,211);
  sta2=serverURL.substring(221,227);
  num1=serverURL.substring(237,240);
  num2=serverURL.substring(250,253);
  num3=serverURL.substring(263,266);

  oldURL=serverURL
  schdprn1=document.ProcessForm.schdprn1.value
  repStr=new RegExp("schdprn1=" + prt1 + "");
  newStr="schdprn1=" + schdprn1 + "";
  serverURL=oldURL.replace(repStr,newStr)
 
  oldURL=serverURL
  schdprn2=document.ProcessForm.schdprn2.value
  repStr=new RegExp("schdprn2=" + prt2 + "");
  newStr="schdprn2=" + schdprn2 + "";
  serverURL=oldURL.replace(repStr,newStr)

  oldURL=serverURL
  schdprn3=document.ProcessForm.schdprn3.value
  repStr=new RegExp("schdprn3=" + prt3 + "");
  newStr="schdprn3=" + schdprn3 + "";
  serverURL=oldURL.replace(repStr,newStr)

  oldURL=serverURL
  labeltyp=document.ProcessForm.labeltyp.value
  repStr=new RegExp("labeltyp=" + lab1 + "");
  newStr="labeltyp=" + labeltyp + "";
  serverURL=oldURL.replace(repStr,newStr)

  oldURL=serverURL
  statnco1=document.ProcessForm.statnco1.value
  repStr=new RegExp("statnco1=" + sta1 + "");
  newStr="statnco1=" + statnco1 + "";
  serverURL=oldURL.replace(repStr,newStr)

  oldURL=serverURL
  statnco2=document.ProcessForm.statnco2.value
  repStr=new RegExp("statnco2=" + sta2 + "");
  newStr="statnco2=" + statnco2 + "";
  serverURL=oldURL.replace(repStr,newStr)

  oldURL=serverURL
  schdcop1=document.ProcessForm.schdcop1.value
  repStr=new RegExp("schdcop1=" + num1 + "");
  newStr="schdcop1= " + schdcop1 + "";
  serverURL=oldURL.replace(repStr,newStr)

  oldURL=serverURL
  schdcop2=document.ProcessForm.schdcop2.value
  repStr=new RegExp("schdcop2=" + num2 + "");
  newStr="schdcop2= " + schdcop2 + "";
  serverURL=oldURL.replace(repStr,newStr)

  oldURL=serverURL
  schdcop3=document.ProcessForm.schdcop3.value
  repStr=new RegExp("schdcop3=" + num3 + "");
  newStr="schdcop3= " + schdcop3 + "";
  serverURL=oldURL.replace(repStr,newStr)

  location.href=serverURL
}
function DispMapping() {
  LinkUrl="patweb92.pbl?reportno=4&template=3"
  Left=(((document.body.clientWidth-400)/2)+ document.body.scrollLeft)
  DFrameLink(LinkUrl,0,Left,400,250)
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ProcessLoad2();SetCop();">
<form name=SelectPeriod action=patweb92.pbl method=get style="margin:0;">
 <input type=hidden name=reportno value=6>
 <input type=hidden name=template value=4>
 <input type=hidden name=viewtype value="%PATWEB92.06.011">
 <input type=hidden name=schdprn1 value="">
 <input type=hidden name=schdprn2 value="">
 <input type=hidden name=schdprn3 value="">
 <input type=hidden name=labeltyp value="">
 <input type=hidden name=statnco1 value="">
 <input type=hidden name=statnco2 value="">
 <input type=hidden name=schdcop1 value="">
 <input type=hidden name=schdcop2 value="">
 <input type=hidden name=schdcop3 value="">
 
 <table cellpadding=3 bgcolor=#CCCCCC border=0 width=100%>
 
  <tr><td class=DataLabel>Admitting Point</td>
      <td><select name=adpoints class=SelectMed
                  onChange="SubmitSelection();">
           <option value="   ">ALL</option>
           <option value="A~D">ALL (except DSU)</option>    
            %PATWEB92.06.014.2
          </select></td>
      <td class=DataLabel> Ward </td>
      <td><select name=wardcode class=SelectMed
                  onChange="SubmitSelection();">
           <option value="  ">ALL</option>
            %PATWEB92.06.012.2
         </select></td>
      <td align=right>
          <input type=button value="<<" class=SmallButton
                 onClick='setRedirect("%PATWEB92.06.002")'>
          %PATWEB92.06.007
          <input type=button value=">>" class=SmallButton
                 onClick='setRedirect("%PATWEB92.06.001")'>
          <a href='javascript:SelectDateFrame();'>
             <img src="../images/DateLookup.gif" border=0 hspace=1 align=absmiddle
                  alt="Select Date"></a>
          <a href='javascript:SelectView2("0");'>
             <img src=../images/DayIcon.gif border=0 hspace=1 align=absmiddle
                  alt="View Today"></a>
          <a href='javascript:SelectView2("1");'>
             <img src=../images/WeekIcon.gif border=0 hspace=1 align=absmiddle
                  alt="View This Week"></a>
         <a href='javascript:SelectView2("2");'>
            <img src=../images/MonthIcon.gif border=0 hspace=1 align=absmiddle
                 alt="View This Month"></a></td>
      <td class="DataLabel" align="right">Legend
          <img src="../images/Help16.gif" border="0" hspace=2 align=absmiddle
               onClick="DispMapping();" /></td></tr>
 </table>
</form>

<form name=ProcessForm method=post action=rshweb02.pbl>
 <input type=hidden name=reportno value=2>
 <input type=hidden name=updttype value="L">
 <input type=hidden name=redirect
        value="patweb92.pbl?reportno=6&template=4&viewtype=%PATWEB92.06.011">
 <input type=hidden name=nextpage value="7">
 <table cellspacing=0 border=1 width=100%>
  <tr><td class=HeadingCell align=center colspan=6>Bulk Print List</td></tr>

  <tr><td class=HeadingCell><b>Visit No.</b></td>
      <td class=HeadingCell><b>Patient Name</b></td>
      <td class=HeadingCell><b>Status</b></td>
      <td class=HeadingCell><b>Admitting Point</b></td>
      <td class=HeadingCell><b>Expected Ward</b></td>
      <td class=HeadingCell><b>Expected Date</b></td>
      <td class=HeadingCell><b>Print</b></td></tr>
  %PATWEB92.06.033
 </table>

 <table cellspacing=0 border=0 width=100%>
  <tr><td class=DataLabel>Printer</td>
      <td><select name=schdprn1 class=SelectMed
                   onchange="UpdateFields();">
           %STANDARD.01.001.PATWEB70.01
          </select></td>
      <td class=DataLabel><b>Type of Label</b></td>
      <td><select name=labeltyp class=SelectMed
                  onchange="UpdateFields();">
           %STANDARD.01.019.LABELPMI
          </select></td>
      <td>Number of Label Sheets</td>
      <td><select name=schdcop1 title='Number of Copies'
                  onchange="UpdateFields();">
           <option value=" 0">0</option>
           <option value="12">1/2</option>
           <option value="24" selected>1</option>
           <option value="48">2</option>
          </select></td></tr>

  <tr><td>Printer</td>
      <td><select name=schdprn2 class=SelectMed
                  onchange="UpdateFields();">
           %STANDARD.01.001.PATWEB70.02
          </select></td>
      <td><b>Front Sheet Stationery Code</b></td>
      <td><select name=statnco1 class=SelectMed
                  onchange="UpdateFields();">
           %STANDARD.01.020.000
          </select></td>
       <td>Number of Copies</td>
       <td><select name=schdcop2 title='Number of Copies'
                   onchange="UpdateFields();">
           </select></td></tr>

   <tr><td class=DataLabel>Printer</td>
       <td><select name=schdprn3 class=SelectMed title="Printer" 
                   onchange="UpdateFields();">
            %STANDARD.01.001.PATWEB70.02
           </select></td>
       <td><b>Election Form Stationery Code</b></td> 
       <td><select name=statnco2 class=SelectMed>
            %STANDARD.01.020.000
           </select></td>
       <td class=DataLabel>Number of Copies</td>
       <td><select name=schdcop3 title='Number of Copies'
                   onchange="UpdateFields();">
           </select></td></tr>

   <tr><td align=center colspan=6>
           <input type=button class="button" Value="Print"
                   onclick="SubmitHidden(ProcessForm);">
           <input class="button" type=button value=Reset
                  onClick="clearData();">
           <input type=button value="Cancel" class="button" tabindex=28
                  onclick=""></td></tr>
 </table>
</form>

<script type="text/javascript">
//
 Printer1="%PATWEB92.06.016";
 for (var i =0 ; i < document.ProcessForm.schdprn1.length; i++) {
  if (document.ProcessForm.schdprn1.options[i].value==Printer1) {
       document.ProcessForm.schdprn1.selectedIndex=i } };
//
 Printer2="%PATWEB92.06.017";
 for (var i =0 ; i < document.ProcessForm.schdprn2.length; i++) {
  if (document.ProcessForm.schdprn2.options[i].value==Printer2) {
       document.ProcessForm.schdprn2.selectedIndex=i } };
//
 Printer3="%PATWEB92.06.018";
 for (var i =0 ; i < document.ProcessForm.schdprn3.length; i++) {
  if (document.ProcessForm.schdprn3.options[i].value==Printer3) {
       document.ProcessForm.schdprn3.selectedIndex=i } };
//
 Labeltyp="%PATWEB92.06.019";
 for (var i =0 ; i < document.ProcessForm.labeltyp.length; i++) {
  if (document.ProcessForm.labeltyp.options[i].value==Labeltyp) {
       document.ProcessForm.labeltyp.selectedIndex=i } };
//
 Statnco1="%PATWEB92.06.020";
 for (var i =0 ; i < document.ProcessForm.statnco1.length; i++) {
  if (document.ProcessForm.statnco1.options[i].value==Statnco1) {
       document.ProcessForm.statnco1.selectedIndex=i } };
//
 Statnco2="%PATWEB92.06.021";
 for (var i =0 ; i < document.ProcessForm.statnco2.length; i++) {
  if (document.ProcessForm.statnco2.options[i].value==Statnco2) {
       document.ProcessForm.statnco2.selectedIndex=i } };
//

function SetCop() {
//
 Schdcop1="%PATWEB92.06.022";
 for (var i =0 ; i < document.ProcessForm.schdcop1.length; i++) {
   if (trim(document.ProcessForm.schdcop1.options[i].value)==trim(Schdcop1)) {
       document.ProcessForm.schdcop1.selectedIndex=i } };

 Schdcop2="%PATWEB92.06.023";
 X = Schdcop2 - 1
 for (var i =0 ; i < document.ProcessForm.schdcop2.length; i++) {
  if (i==X) {
       document.ProcessForm.schdcop2.selectedIndex=i } };
//
 Schdcop3="%PATWEB92.06.024";
 X = Schdcop3 - 1
 for (var i =0 ; i < document.ProcessForm.schdcop3.length; i++) {
  if (i==X) {
       document.ProcessForm.schdcop3.selectedIndex=i } };
//
//
 for (var i=0; i < document.SelectPeriod.adpoints.length; i++) {
  if (document.SelectPeriod.adpoints.options[i].value=="%PATWEB92.06.032"){
      document.SelectPeriod.adpoints.selectedIndex=i;
  }
 }
//
}
</script>
