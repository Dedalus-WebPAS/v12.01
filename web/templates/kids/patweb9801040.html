<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="kids">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/patweb9801040.js"></script>
<script type="text/javascript">
function ChangePatient() {
  p = document.Patient;
  // Right justify Admission Number in the 8 character variable
  var sPad = "        ";
  var sAdmNo = p.admissno.value;
  var sAdmNo = sPad.substr(0,(8 - sAdmNo.length)) + sAdmNo;

  if (!CheckOutpatientCancel(sAdmNo)) {return;}

  if (!validateVisit()) {return; }

  if(!validateMandatory(Patient)) {return;}

  setNextTemplate(sAdmNo);
  document.Patient.submit();
}
function setNextTemplate(AdmNo) {
  Patient.action=parent.TemplateFile.content.substr(0,8) + ".pbl";
  Patient.reportno.value=parent.TemplateFile.content.substr(8,2);
  Patient.template.value=parent.TemplateFile.content.substr(10,3);

  if (parent.TemplateFile.content.substr(0,13)=="patweb9801001"  ||
      parent.TemplateFile.content.substr(0,13)=="outweb0203020"  ||
      parent.TemplateFile.content.substr(0,13)=="outweb0203001"  ||
      parent.TemplateFile.content.substr(0,13)=="allweb0202014"  ||
      parent.TemplateFile.content.substr(0,13)=="allweb0202002") {
    Patient.action="patweb98.pbl";
    Patient.reportno.value="01";
    Patient.template.value="001";
    CheckSwitchOutpatientReferral(AdmNo);
  }
}
function setForm() {
  ExpireCookiePath("CasePath");
}
function UpdateUR() {
 document.Patient.urnumber.value=document.Patient.dum.value;
}
function SubmitUR() {
 validateUR();
 return validateMandatory(document.Patient);
}
function CheckUR() {
 document.Patient.admissno.value=" ";
 validateUR();
}
function validateUR() {
  p=document.Patient;
  justifyRight(p.urnumber);
  if (isWhitespace(p.admissno.value)){
      validateCode(8,p.urnumber,p.fnam,UpdateUR,p.sex,p.dob,p.pce,p.dum,p.admissno,
                   p.dat,p.typ,p.d,p.d,p.d,p.d,p.d,p.d,p.d,p.m);
     if (p.m.value=="1") {
         alert("Warning : This U/R Number is merged with " + p.urnumber.value);
     }
  } else {
     validateVisit();
  }
}
function validateVisit() {
  p=document.Patient;
  x=p.urnumber.value;
  y=p.fnam.value;
  justifyRight(p.admissno);

  // Right justify Admission Number in the 8 character variable
  var sPad = "        ";
  var sAdmNo = p.admissno.value;
  var sAdmNo = sPad.substr(0,(8 - sAdmNo.length)) + sAdmNo;

  if (!CheckOutpatientCancel(sAdmNo)) {return false;}

  validateCode(12,p.admissno,p.fnam,p.sex,p.dob,p.pce,p.urnumber,p.dum,p.dat,p.typ);
  if (isWhitespace(p.urnumber.value)) {
     p.urnumber.value=x;
     p.fnam.value=y;
  }
  return true;
}
function checkIfEnter(e){
  if(event.keyCode=="13"){
    if (document.activeElement.name=="admissno") {
      if (!validateVisit()) {
        return false;
      }
      ChangePatient();
    } else {
      if (document.activeElement.name!="OKButton") {
        CheckUR();
        ChangePatient();
      }
    }
    return true;
  }
  else{
    return false;
  }
}

</script>
</head>
%START.OF.PAGE
<body onKeyPress="checkIfEnter(event)"
      onLoad="PageLoad(event);setForm();clrFields()">
<span class=DFrameTitleBar>
 <img align="right" alt="Exit" class="MenuIcon"
      src="../images/ExitIcon.gif" onclick="DFrameExit();">
 Change Patient
</span>
<form name=Patient method=get target="content" style="margin:0"
      onsubmit="return SubmitUR();">
 <input type=hidden name=reportno value=1>
 <input type=hidden name=template value=1>
 <input type=hidden name=visittyp value=1>
 <input type=hidden name=sex>
 <input type=hidden name=dob>
 <input type=hidden name=pce>
 <input type=hidden name=dum>
 <input type=hidden name=d>
 <input type=hidden name=m value="">
 <input type=hidden name=ptcnvsro value="%STANDARD.01.025.124.245.0.1">
 <input type=hidden name=ptcnvsrr value="%STANDARD.01.025.124.246.0.1">

 <table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
  <tr><td width=30% class=DataLabel>U/R Number</td>
      <td><input type=text name=urnumber value="" size=10 maxlength=8
                 title="Patient U/R" class="Mandatory" tabindex=1
                 onkeydown="TruncateMrtLf(this);"
                 onblur="CheckUR();">
          <input type=text name=fnam value="" size=30 readonly tabindex=-1
                 class="readonly"></td></tr>

  <tr><td class=DataLabel>Visit Number </td>
      <td><input type=text name=admissno value="" size=10 maxlength=8
                  title="Patient Visit No" tabindex=2"
                  onblur="validateVisit();">
          <input type=text name=dat value="" size=12 readonly tabindex=-1
                 class="readonly">
          <input type=text name=typ value="" size=15 readonly tabindex=-1
                 class="readonly"></td></tr>

  <tr><td colspan=2 align=center><br>
          <input type=button class="button" value="Ok" name=OKButton tabindex=3
                 onclick="ChangePatient();">
          <input type=button tabindex=4 Value="Cancel" class="button"
                 onClick="DFrameExit();"></td></tr>
 </table>
</form>
