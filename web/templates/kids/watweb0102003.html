<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="kids">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function ChgReason() {
  UpdateForm.wathi001.className="Mandatory";
}

function EnterSus() {
  i=document.UpdateForm.wattx004.selectedIndex;
  ind=document.UpdateForm.wattx004.options[i].value.substring(3,4);

  if (ind !="R") {
    CASEKEYS=PatientLinks.casekeys.value.replace(/ /g,"+");
    LinkUrl="watweb01.pbl?reportno=5&template=002&casekeys="+CASEKEYS;
    Left=(document.body.clientWidth-650)/2;
    DFrameLink(LinkUrl,50,Left,650,400);
  }
}

function ChgStat() {
  UpdateForm.watsu003.readOnly=false;
  UpdateForm.rfcdate.readOnly=false;
  UpdateForm.watsu003.className=" ";
  UpdateForm.rfcdate.className=" ";
}

function valUnit() {
  validateCode(3,UpdateForm.wattr012,UpdateForm.n_wattr012);
}

function valDoc() {
  var serverURL = "../cgi-bin/watweb01.pbl?reportno=13&valdtype=1" +
          "&wattr011="+document.UpdateForm.wattr011.value +
          "&wattr012="+document.UpdateForm.wattr012.value;
  var returnValue = RSExecute(serverURL);
  if (returnValue.return_value == -1) {
    return false;
  }
  return true;
} 

function RFCStat() {
  i=document.UpdateForm.ListStat.selectedIndex;
  document.UpdateForm.wattx004.value=
    document.UpdateForm.ListStat.options[i].value.substring(3,6);
}

function DefaultLosfromInt() {
  SameDay=document.UpdateForm.wattx008.value.substr(3,1);
  DefLos=document.UpdateForm.deflos.value.replace(/ /g,"");

  if (SameDay == "1") {
    document.UpdateForm.wattr013.value="0";
  } else {
    document.UpdateForm.wattr013.value="1";
  }
}

function UpdateWat() {
  if (!validateReferalAcctptDate()) {return;}

  SubmitHidden(document.UpdateForm);
}

function validateReferalAcctptDate() {
  date1=UpdateForm.wattr006.value;
  date2=UpdateForm.wattr059.value;
  date3=UpdateForm.date_keyed.value;

  if (isWhitespace(date1)) {return true;}
  if (isWhitespace(date2)) {return true;}

  if (ChkDateTime2(date1,date2)) {
     message="Referral Accepted Date should be equal to or greater than ";
     message+="Date On List";
     alert(message);
     return false;
  }

  if (isWhitespace(date3)) {return true;}

  if (ChkDateTime2(date2,date3)) {
     message="Referral Accepted Date should be equal to or less than ";
     message+="Date Keyed";
     alert(message);
     return false;
  }

  return true;

}

function ChkDateTime2(strtDate,endDate) {
  var strtDay  = strtDate.substring(0,2);
  var strtMon  = strtDate.substring(3,6);
  var strtYear = strtDate.substring(7,11);

  var endDay   = endDate.substring(0,2);
  var endMon   = endDate.substring(3,6);
  var endYear  = endDate.substring(7,11);

  strtMon = GetMonthNumber(strtMon);
  endMon  = GetMonthNumber(endMon);

  var strtDateTime = strtYear + strtMon + strtDay
  var endDateTime  = endYear + endMon + endDay
  if (endDateTime >= strtDateTime ) {
     return false;
  }
  return true;
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisplayTrnSrc(UpdateForm.wattr050);
  referralAcceptedMandatory();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%WATWEB01.02.003";
PatientVIS="%WATWEB01.02.081";
PatientNAM="%WATWEB01.02.002";
PatientSTA="%WATWEB01.02.086.078";
PatientALT="%WATWEB01.02.084";
PatientSEX="%WATWEB01.02.019";
PatientDOB="%WATWEB01.02.020";
PatientAGE="%WATWEB01.02.021";
PatientLOC="%WATWEB01.02.083";
DoctorCOD="%WATWEB01.02.082.003";
DoctorNAM="%WATWEB01.02.082.002";
PatientAID="%WATWEB01.02.086.090";
PatientIND="%WATWEB01.02.086.091";
PatientCUR="%WATWEB01.02.086.092";
PatientCLC="%WATWEB01.02.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%WATWEB01.02.086.094";
PatientCDM="%WATWEB01.02.086.095";
PatientVDH="%WATWEB01.02.086.099.015";
PatientUNT="%WATWEB01.02.066.0";
PatientPRI="%WATWEB01.02.086.066.1";
InsertPatientHeader();
</script>
<div id=PatientMenu></div>
<div id=PageBodySection style="overflow: auto;">

<form name=UpdateForm action="watweb01.pbl" method=post
 onsubmit="RFCStat();return validateMandatory(this);">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=1>
<input type=hidden name=casekeys value="%WATWEB01.02.101">
<input type=hidden name=updttype value="U">
<input type=hidden name=dummy value="">
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value="7">
<input type=hidden name=wattx004 value="">
<input type=hidden name=bokrx006 value="%WATWEB01.02.406">
<input type=hidden name=deflos value="">

<table border=0 width="100%" cellspacing="0" cellpadding="1" align=center>
<tr><td align=center class=HeadingCell>Update Waiting List Entry </td></tr>
</table>

<table border=0 width="95%" cellspacing="0" cellpadding="0" align=center>
<tr><td class=DataLabel width=15%>Consultant</td> 
    <td class=DataField width=30%>   
    <input type=text name=wattr012 size=8 maxlength=8  tabindex=1
     title="Consultant"  value="%WATWEB01.02.115.003"
     class=Readonly readonly> 
    <input type=text name=n_wattr012 size=40 readonly class=Readonly
     title="Consultant Name" value="%WATWEB01.02.115.002">
    </td>
<td class=DataLabel width=15%>Referral Source</td>
    <td class=DataField>
    <select name=wattr050 tabindex=2 class="selectBig"
     title="Referral Source" onchange="DisplayTrnSrc(this)">
    <option></option>
    %WATWEB01.02.187.2
    </select></td></tr>
<tr><td></td><td></td>
    <td><div id=divTransferLabel></div></td>
    <td><div id=divTransferSource></div></td></tr>
<input type=hidden name=date_keyedCCYYMMDD value="%WATWEB01.02.126" 
     id='date_keyedCCYYMMDD'>

<tr id="previous_twt" style="display:none">
   <td></td><td></td>
  <td>
  Previous Total Waiting Time</td>
  <td><input type="text" size=10
   maxlength=4 name=prevtt01 id=prevtt01 tabindex=13
   title="Previous Total Waiting Days" value=%WATWEB01.02.379>
</td></tr>

<tr><td class=DataLabel>Unit</td>
    <td class=DataField>
    <input type=hidden name=wattr011 value="%WATWEB01.02.114.1" tabindex=3>
    <input type=text size=30 name=xxxtr011 value="%WATWEB01.02.114.0" 
         class=Readonly readonly>
    <td class=DataLabel>%STANDARD.01.017.TP    </td>
    <td Class=DataField>
    <select name=wattr014 tabindex=4 class="Readonly selectBig" disabled>
    <option></option> 
     %WATWEB01.02.117.2 
    </select></td></tr>
<tr><td class=DataLabel>
      <script type="text/javascript">DoLDesc();</script>
    </td>
    <td class=DataField>
    <input type=text name=wattr006 size=12  title="Date on List" tabindex=5
     class=Readonly readonly  value="%WATWEB01.02.109"></td>
<td class=DataLabel>Ins Status     </td>
    <td class=DataField><select name=wattx026 class="Mandatory selectBig"
        title="Ins Status" tabindex=6>
    <option></option> 
     %WATWEB01.02.526.9.1.10.2.X
    </select><td></tr>

<tr><td class=DataLabel>Referral Accepted Date</td>
    <td class=DataField>
     <input type=text name=wattr059 size=12 tabindex=3 colspan=3
      value="%WATWEB01.02.199.010"
      onblur="checkDate(this,'Date');"
      title="Referral Accepted Date">
     <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.wattr059
      time=null>
     <img src=../images/DateLookup.gif class=Icon date=UpdateForm.wattr059>
    </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>

<tr><td class=DataLabel>Short Notice Code</td>
    <td class=DataField>
    <select name=wattr015 tabindex=7 class=selectBig>
    <option></option>
    %WATWEB01.02.118.2
    </select></td>
    <td class=DataLabel>
      <script type="text/javascript">RFCColDesc();</script> Status
    </td>
    <td class=DataField>
    <select name=ListStat class=selectBig
            tabindex=6 class=Readonly readonly disabled>
    <option></option>   
     %WATWEB01.02.312.2
    </select></td></tr>
<tr><td class=DataLabel>Admitting Point   </td>
    <td class=DataField>
    <select name=wattx006 class="Mandatory selectBig" title="Admitting Point"
            tabindex=7>
    <option></option>
    %WATWEB01.02.506.2
    </select></td>
<td class=DataLabel>
      <script type="text/javascript">NRFCColDesc();</script> Reason
    </td>
    <td class=DataField>
    <input type=text name=watsu003 class=Readonly readonly size=30 tabindex=8 
     value="%WATWEB01.02.610.0">
    </td></tr>
<tr><td class=DataLabel>Pre Op Ward</td>
    <td class=DataField>
    <select name=wattx005 tabindex=9 class="Mandatory selectBig" 
            title="Pre Op Ward">
    <option></option>
    %WATWEB01.02.505.2
    </select></td></tr>
<tr><td class=DataLabel>Intended Stay</td>
    <td class=DataField>
    <select name=wattx008 tabindex=9 class="Mandatory selectBig" 
            title="Intended Stay" onchange="DefaultLosfromInt();">
    <option></option>
    %WATWEB01.02.508.2
    </select></td>
    <td class=DataLabel>Planned Length of Stay </td>
    <td class=DataField> <input type=text name=wattr013 size=5 maxlength=5 
    tabindex=11 class="Mandatory Integer" min=0 value="%WATWEB01.02.116"
    title="Planned Length of Stay" > (days)</td>
    </tr>

<tr valign=top><td class=DataLabel>Reason/Diagnosis</td>
<td class=DataField colspan=3>
<input type=text name=wattr004 size=70 maxlength=40 tabindex=13
       class="Mandatory" title="Reason/Diagnosis" value="%WATWEB01.02.107">
       </td></tr>
<tr><td class=DataLabel>ESIS Code             </td>
<td class=DataLabel>
<input type=text size=12 name=wattr001 value="%WATWEB01.02.103  "
       readonly title="Procedure Code" class=Readonly tabindex=14>
    </td>
    <td class=DataLabel>%STANDARD.01.017.As</td>
    <td class=DataField>
      <select name=wattx057 tabindex=10 title="%STANDARD.01.017.As" 
       class="selectBig Mandatory">
      <option></option>
      %WATWEB01.02.560.9.5
      </select>
    </td>
</tr>
<tr><td class=DataLabel>Procedure</td>
    <td class=DataLabel colspan=3>
    <input  type=text name=wattr003 size=70  tabindex=16
     maxlength=50 value="%WATWEB01.02.106" class="Mandatory" title="Procedure">
     </td></tr>
<tr><td class=DataLabel>Estimated Procedure Time  </td>
    <td class=DataField>
    <input type=text name=wattr002 size=10 class=Integer tabindex=17 maxlength=5
     min=0 title="Estimated Operating time" value=%WATWEB01.02.105></td>
    <td class=DataLabel>Outpatient Review Date </td>
    <td class=DataField>
    <input type=text name=wattr007 size=12 tabindex=17 value="%WATWEB01.02.110"
     onblur="checkDate(this,'Date');">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.wattr007
    time=null>
    <img src=../images/DateLookup.gif class=Icon date= UpdateForm.wattr007>
    </td></tr>

<tr><td class=DataLabel>Consent signed</td>
 <td><select name=wattr054 class=Mandatory title="Consent Signed" tabindex=19>
        <option></option>
        <option value="0">No</option>
        <option value="1">Yes</option>
        </select></td>
    <td class=DataLabel>Notify GP     </td>
    <td class=DataField>
    <select name=wattx014 tabindex=20 title="Notify GP">
    <option></option>
    <option value=0>No </option>
    <option value=1>Yes</option>
    </select>
    </td></tr>

<tr><td class=DataLabel>Forms </td>
    <td class=DataField>
    <select name=wattx009 tabindex=21 class=Mandatory title="Forms">
    <option></option>
     %WATWEB01.02.509.2
    </select></td>

<td class=DataLabel>GP</td>
    <td class=DataField colspan=3>
    <input type=text name=wattr033 size=8 maxlength=8 tabindex=22
  value="%WATWEB01.02.140.1" onblur="ValidateHCP(18,0,wattr033,name_wattr033);">
    <input type=text name=name_wattr033 size=20 maxlength=20 >
    <img src=../images/SearchIcon.gif class=Icon
     onclick="HCPSearchFrame(UpdateForm.wattr033,UpdateForm.name_wattr033);">
    </td></tr>

<tr><td class=DataLabel>Proposed Admission </td>
    <td class=DataLabel colspan=3>
    <input type=text name=wattr008 size=12 tabindex=23
    onblur="checkDate(this,'Date');" value="%WATWEB01.02.111" > 
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.wattr008>
    Time 
    <input type=text name=wattx015 size=9 tabindex=24
     title="Proposed Admission Time" value="%WATWEB01.02.515">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.wattr008
     time=UpdateForm.wattx015>
    <img src=../images/TimeLookup.gif class=Icon time=UpdateForm.wattx015>
    </td></tr>

<tr><td class=DataLabel>Proposed Procedure</td>
    <td class=DataLabel colspan=3>
    <input readonly class=Readonly type=text size=12
     value="%WATWEB01.02.423" tabindex=25> 
     &nbsp; Session
    <input readonly class=Readonly type=text size=20
     value="%WATWEB01.02.424.0" tabindex=26>
    </td></tr>

<tr><td class=DataLabel>
    <script type="text/javascript">DaKDesc();</script>
    </td>
    <td class=DataField>
    <input type=text class=Readonly readonly size=12   maxlength=12
     tabindex=25 value="%WATWEB01.02.126" name=date_keyed id=date_keyed
     title="Date Keyed"></td>
    <td class=DateLabel>Operator ID </td>
    <td class=DataField>
    <input type=text size=12 maxlength=12 class=Readonly readonly
      tabindex=26 value= '%WATWEB01.02.310' ></td></tr>

<tr><td class=DataLabel>Referring Clinician</td>
    <td class=DataField>
       <input type=text name=wattx046 id=wattx046 tabindex=37
        size=12 maxlength=10 title="Referring Clinician"
        value="%WATWEB01.02.546.001"
        onblur="validateCode(18,wattx046,n_wattx046,dummy,dummy,dummy);">
       <input type=text name=n_wattx046 id=n_wattx046 title="Clinican Name"
        size=35 class=Readonly readonly value="%WATWEB01.02.546.081">
       <img src="../images/SearchIcon.gif" class=Icon
        onclick="GPHCPSearchFrame(wattx046,n_wattx046,dummy,dummy,dummy,
                 dummy,0);">
       <img src="../images/erase.gif" class=Icon
        onclick="clrFields(wattx046,n_wattx046);"></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td></tr>

<tr><td colspan=4>&nbsp;</td></tr>

<tr><td colspan=4 align=center>
    <input type=button class="button" value="Ok" tabindex=26
     onclick="UpdateWat();">
    <input type=button value="Cancel" class="button" tabindex=27
     onclick='PatientLinkTo("watweb01.pbl",2,1,0,0,0);'>
    </td></tr>
</table>
</form>
</div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%WATWEB01.02.003">
<input type=hidden name=admissno value="%WATWEB01.02.081">
<input type=hidden name=MenuType value="%WATWEB01.02.088">
<input type=hidden name=casekeys value="%WATWEB01.02.101">
</form>

<script type="text/javascript">
function init() {
  var title= trim("%WATWEB01.02.140.0.003");
  var name = trim("%WATWEB01.02.140.0.004");
  var surname = trim("%WATWEB01.02.140.0.005");

  UpdateForm.name_wattr033.value= title+" "+name+" "+surname;
  UpdateForm.redirect.value+="watweb01.pbl?reportno=2&template=1&casekeys=" + PatientLinks.casekeys.value.replace(/ /g,"+");
  
  Consent="%WATWEB01.02.193";
  if ( Consent == "Yes") {
    document.UpdateForm.wattr054.selectedIndex=2;
  } else {
    document.UpdateForm.wattr054.selectedIndex=1;
  }
  Notify="%WATWEB01.02.514";
  if ( Notify == "Yes") {
    document.UpdateForm.wattx014.selectedIndex=2;
  } else {
    document.UpdateForm.wattx014.selectedIndex=1;
  }
  checkDate(document.getElementById('date_keyed'),
            'Date Keyed',
            document.getElementById('date_keyedCCYYMMDD'));
  if (UpdateForm.date_keyedCCYYMMDD.value < DOYR2020) {
    UpdateForm.wattr059.className=""
  }
}
function referralAcceptedMandatory(){
  if(UpdateForm.date_keyedCCYYMMDD.value >= DOYR2021){
    UpdateForm.wattr059.className="Mandatory";
  }
}

function DisplayTrnSrc(field) {
  i=field.selectedIndex;
  ind=field.options[i].value.substring(4,5);

  if (ind!="1") {
    document.getElementById('divTransferSource').innerHTML=
      document.getElementById('spTransferBlank').innerHTML;
    document.getElementById('divTransferLabel').innerHTML="";
   document.getElementById('previous_twt').style.display="none";
   document.getElementById('prevtt01').value="";
   document.getElementById('prevtt01').className="";
  } else {
    document.getElementById('divTransferSource').innerHTML=
      document.getElementById('spTransfer').innerHTML;
    document.getElementById('divTransferLabel').innerHTML=
      document.getElementById('spTransferLabel').innerHTML;
   if(document.getElementById('date_keyedCCYYMMDD').value>'20160630'){
     document.getElementById('previous_twt').style.display="";
     document.getElementById('prevtt01').className="Mandatory";
   }
  }
}

document.UpdateForm.wattr006.title=DoLDescription;

</script>

<span id=spTransferLabel style="display:none">
Transfer Source
</span>

<span id=spTransfer style="display:none">
  <input type="text" size=7 maxlength=5 name=trnsfsrc id=trnsfsrc 
   class=Mandatory title="Transfer Source" tabindex=5
   onchange="validateCode(9,trnsfsrc,trandesc)" value="%WATWEB01.02.179">
  <input type=text size=20 name=trandesc id=trandesc notab
   class=Readonly readonly value="%WATWEB01.02.180">
  <img src="../images/SearchIcon.gif" class=Icon
   onclick="TransferSourceFrame(trnsfsrc,trandesc)">&nbsp;Previous ID&nbsp;
  <input type="text" size=15 maxlength=9 name=previd01 id=previd01
   class=Mandatory title="Previous ID" value=%WATWEB01.02.330>
</span>

<span id=spTransferBlank style="display:none">
  <input type=hidden name=trnsfsrc id=trnsfsrc>
</span>
