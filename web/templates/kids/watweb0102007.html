<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="kids">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript"> 
  function init() {
    AddForm.redirect.value="watweb01.pbl?reportno=2&template=1&casekeys=" +
                             PatientLinks.casekeys.value.replace(/ /g,"+");
  }
  function LinkProcedure() {
    ReturnCode=AddForm.wattx018;
    ReturnName=AddForm.Nwattx018;
    PatientLinkTo("watweb01.pbl",2,14,1,700,300);
  }
  function DefProDate() {
    document.AddForm.bokrx023.value=document.AddForm.bkrec004.value; 
  }
  function AddBook() {
        
   if (validateMandatory(document.AddForm)) {
       if(ChkDateTime(AddForm.bkrec004,AddForm.bkrec005,AddForm.bkrec034,null)){
         alert("Date booking keyed cannot be after Admission date.")
         return;}
       if(days_between(document.AddForm.bkrec034.value,document.AddForm.bkrec004.value)>365){
   alert("Error: Over one year difference between data entry and Admission Date");
   return;}
         ChkBookDate(); } 
  }

  function ChkBookDate(ReturnCode) {
    ans=true;
    i=document.AddForm.wattr014.selectedIndex;
    code=document.AddForm.wattr014.options[i].value.substring(5,6);
    if ( code=="1" || code=="2" ) {
      var serverURL   = "../cgi-bin/watweb01.pbl?reportno=11" +
                       "&xmldate1=" + AddForm.wattr006.value +
                       "&xmldate2=" + AddForm.bkrec004.value +
                       "&xmlcode1=" + code;
      var returnValue = RSExecute(serverURL);
      ReturnValue=returnValue.return_value.split("|");
      if (returnValue.status==0) {
        if (ReturnValue[0]==1) {
          ans=confirm("Warning : You are booking a " +
                      "category 1 patient to a date" +
                      " greater than 30 days from the date on list!"); }
        if (!ans) {
          return }
        if (ReturnValue[0]==2) {
          ans=confirm("Warning : You are booking a " +
                      "category 2 patient to a date" +
                      " greater than 90 days from the date on list!");
          if (!ans) { return }
        }
        AddForm.submit();
        }
        else {
        ReturnCode.focus(); }
      } 
    else {
        AddForm.submit(); 
    }
  }
function CheckPrinter() {
  if(document.AddForm.lettreqd.value==1) {
    document.AddForm.selprint.className="Mandatory";
  } else {
    document.AddForm.selprint.className="";
  }
}
function SetContactDate(SelectList,DateField) {
  if (SelectList.value=="") {
    DateField.value=""; }
  else {
    SetCurrentDateTime(DateField,null) }
}
function valClaimCode() {
  if (AddForm.wattx026.value=="") {
  validateCode(41,PatientLinks.urnumber,AddForm.claimc);
//alert(AddForm.claimc.value);
  for (var i =0 ; i < document.AddForm.wattx026.length; i++) {
//    alert(AddForm.bkrec023.options[i].value.substr(0,3));
    if (document.AddForm.claimc.value==
        trim(document.AddForm.wattx026.options[i].value.substr(0,3))){
          document.AddForm.wattx026.selectedIndex=i;
    }
  } }
}
</script>  
</head>
%START.OF.PAGE
<body onload="PageLoad(event);valClaimCode();
              document.AddForm.bkrec004.focus();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%WATWEB01.02.003";
PatientVIS="%WATWEB01.02.081";
PatientNAM="%WATWEB01.02.002";
PatientSTA="%WATWEB01.02.086.078";
PatientALT="%WATWEB01.02.084";
PatientSEX="%WATWEB01.02.019";
PatientDOB="%WATWEB01.02.020";
PatientAGE="%WATWEB01.02.021";
PatientLOC="%WATWEB01.02.083";
DoctorCOD="%WATWEB01.02.082.003";
DoctorNAM="%WATWEB01.02.082.002";
PatientAID="%WATWEB01.02.086.090";
PatientIND="%WATWEB01.02.086.091";
PatientCUR="%WATWEB01.02.086.092";
PatientCLC="%WATWEB01.02.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%WATWEB01.02.086.094";
PatientCDM="%WATWEB01.02.086.095";
PatientVDH="%WATWEB01.02.086.099.015";
PatientUNT="%WATWEB01.02.066.0";
PatientPRI="%WATWEB01.02.086.066.1";
InsertPatientHeader();
</script>
<div id=PatientMenu></div>
<div id=PageBodySection style="overflow: auto;">

<form name=AddForm action=watweb01.pbl method=post style="margin:0">
<input type=hidden name=reportno value=7>
<input type=hidden name=template value=4>
<input type=hidden name=setbookf value=1>
<input type=hidden name=updttype value=A>
<input type=hidden name=nextpage value=1>
<input type=hidden name=redirect value="">
<input type=hidden name=casekeys value="%WATWEB01.02.101">
<input type=hidden name=bkrec008 value="M">
<input type=hidden name=claimc>

<table border=0 width="100%" cellspacing="0" cellpadding="1" align=center>
<tr><td align=center class=HeadingCell>Make a Waiting List Booking
</td></tr>
</table>

<table border=0 width="95%" cellspacing="0" cellpadding="0" align=center>
<tr><td class=DataLabel>Consultant</td>
    <td class=DataField colspan=3>
    <input class=Readonly type=text name=bkrec002 size=8 maxlength=8 
    readonly value="%WATWEB01.02.115.003">
    <input type=text name=n_bkrec002 size=40 
    readonly class=Readonly value="%WATWEB01.02.115.002">
    </td></tr>
<tr><td class=DataLabel>Unit</td>
    <td class=DataField>
    <select name=bkrec021 class=Readonly title="Unit"  
    readonly disabled>
    <option></option>
    %WATWEB01.02.114.2
    </select></td> 

<td class=DataLabel>%STANDARD.01.017.TP    </td>
    <td Class=DataField>
    <select name=wattr014  class=Readonly readonly disabled>
    <option></option>
    %WATWEB01.02.117.2
    </select></td></tr>

<tr><td class=DataLabel>Date on List</td>
    <td class=DataField>
    <input type=text name=wattr006 size=12  value='%WATWEB01.02.109'
     onblur="checkDate(this,'Date');" class=Readonly title="Date on List"
     readonly > </td>
    <td class=DataLabel>Ins Class </td>
    <td class=DataField><select name=wattx026 tabindex=1 >
    <option></option>
    %WATWEB01.02.526.9.1.10.2.X
    </select></td> </tr>

<tr><td class=DataLabel>Admitting Point   </td>
    <td class=DataField>
    <select name=wattx006 class="Mandatory selectBig" title="Admitting Point"
            tabindex=2>
    <option></option>
    %WATWEB01.02.506.2
    </select></td>

<td class=DataLabel>RFC Status </td>
    <td class=DataField>
    <select name=wattx004 class=selectBig tabindex=2>
    <option></option>
    %WATWEB01.02.312.2
    </select></td></tr>

<tr><td class=DataLabel>Pre Op Ward</td>
    <td class=DataField>
    <select name=wattx005 tabindex=3 class=Mandatory title="Pre Op Ward">
    <option></option>
    %WATWEB01.02.505.2  
    </select></td>

<td class=DataLabel>NRFC Reason</td>
    <td class=DataField>
    <input type=text name=xxxxxxxx  size=25   
    class=Readonly readonly value="%WATWEB01.02.316.0">
    </td></tr>

<tr><td class=DataLabel>Planned Length of Stay </td>
    <td class=DataField> <input type=text name=wattr013 size=5 maxlength=5
    tabindex=3 class=Integer min=0 value="%WATWEB01.02.116" > (days)</td>
    <td class=DataLabel>RFC Date   </td>
    <td class=DataField><input type=text name=rfcdate  size=14   
     class=Readonly readonly value="%WATWEB01.02.316.1"></td></tr>

<tr> <td class=DataLabel> Overdue Date </td>
    <td class=DataField colspan=3>
    <input type=text name=xxxxxxxx size=14  class=Readonly readonly
     value="%WATWEB01.02.176">
    </td></tr>

<tr valign=top><td class=DataLabel>Reason/Diagnosis</td>
    <td class=DataField colspan=3>
    <input type=text name=wattr004 class=Mandatory title="Reason/Diagnosis"
     size=70 maxlength=40 tabindex=6
     value="%WATWEB01.02.107"></td></tr>

<tr><td class=DataLabel>ESIS Code             </td>
    <td class=DataLabel colspan=3>
    <input type=text size=12 name=bkrec035 title="CMBS Code"
     class=Readonly readonly  value="%WATWEB01.02.103">
    </td></tr>
    
<tr><td class=DataLabel>Procedure</td>
    <td class=DataLabel colspan=3>
    <input type=text name=bkrec036 size=70 maxlength=50 tabindex=7
      class=Mandatory title="Procedure" value="%WATWEB01.02.106">
    </td></tr>

<tr><td class=DataLabel>Estimated Procedure Time  </td>
    <td class=DataField colspan=3>
  <input type=text name=wattr002 size=10 class=Integer tabindex=8 maxlength=5
     min=0 title="Estimated Operating time" value=%WATWEB01.02.105></td></tr>
<tr><td class=DataLabel>Special Requirements 1 </td>
    <td class=DataField >
    <select name=wattx010 tabindex=9>
    <option></option> 
    %WATWEB01.02.510.2
    </select>
    </td>
    <td class=DataLabel>Special Requirements 2 </td>
    <td class=DataField >
    <select name=wattx011 tabindex=10>
    <option></option>
    %WATWEB01.02.511.2
    </select>
    </td></tr>


<tr><td class=DataLabel>Proposed Admission Date</td>
    <td class=DataLabel>
    <input type=text name=bkrec004 id=bkrec004 
          size=12 tabindex=11 value="%WATWEB01.02.111" 
     class=Mandatory title="Scheduled Admission Date" 
     onblur="DefProDate();checkDate(this,'Date');">
    <img src=../images/DateLookup.gif class=Icon date=AddForm.bkrec004>
    Time
    <input type=text name=bkrec005 id=bkrec005 
           size=8 tabindex=12 value="%WATWEB01.02.515"
    title="Proposed Admission Time" class=Mandatory>
    <img src=../images/DateTimeStamp.gif class=Icon date=AddForm.bkrec004
     time=AddForm.bkrec005>
    <img src=../images/TimeLookup.gif class=Icon time=AddForm.bkrec005> 
    </td></tr>

<tr><td class=DataLabel>Proposed Procedure Date </td>
    <td class=DataLabel colspan=3>
    <input type=text name=bokrx023 id=bokrx023 size=12 tabindex=13 
     title="Proposed Procedure Date"
     value="%WATWEB01.02.111" onblur="checkDate(this,'Date');">
    <img src=../images/DateLookup.gif class=Icon date=AddForm.bokrx023>
    Time
    <select name=bokrx024 title="Procedure time" tabindex=14>
    <option></option>
    %WATWEB01.02.424.2
    </select></td></tr>

<tr><td class=DataLabel>Contact Type </td>
    <td class=DataField>
    <select name=bokrx033 title="Contact Type" tabindex=15
     class=Mandatory onchange='SetContactDate(this,AddForm.bokrx004);'>
    <option></option>
     %WATWEB01.02.318.2
    </select></td> 

<td class=DataLabel> Confirmation Date </td>
    <td class=DataLabel>
    <input type=text name=bokrx006 size=12 tabindex=17 class="CurrentDate" 
     title="Confirmed Admission Date"         
     onblur="checkDate(this,'Date');">
    Time
    <input type=text name=bokrx035 size=8 tabindex=18 
    title="Confirmed Operation Time">
    <img src=../images/DateTimeStamp.gif class=Icon date=AddForm.bokrx006
     time=AddForm.bokrx035>
    </td></tr>

<tr><td class=DataLabel> Contact Date </td>
    <td class=DataLabel>
    <input type=text name=bokrx004 id=bokrx004 size=12 class=Mandatory
     title="Contact Date" tabindex=16 onblur="checkDate(this,'Date');">
    <img src=../images/DateTimeStamp.gif  class=Icon
     date=AddForm.bokrx004 time=null>
    <img src=../images/DateLookup.gif class=Icon
     date=AddForm.bokrx004>
    </td>

<td class=DataLabel> Parent Staying </td>
    <td><input type=checkbox name=bokrx005 title="Parent Staying" value="1"
     tabindex=19>
    </td>  </tr>

<tr><td class=DataLabel> Letter Required </td>                                 
    <td><select name=lettreqd class=Mandatory tabindex=20
         title="Letter Required" onChange="CheckPrinter();">
        <option></option>
        <option value=0>No </option>
        <option value=1>Yes</option>
        </select></td>
    <td class=DataLabel>Printer</td>
    <td><select name=selprint notab>
        <option></option>
        %STANDARD.01.001.WATWEB03.00
        </select></td></tr>

<tr><td class=DataLabel>Combined Procedure </td>
    <td class=DataLabel colspan=3>  
    <input type=hidden name=wattx018 id=wattx018>
    <input type=text size=30 name=Nwattx018 id=Nwattx018 
           title="Combine Procedure" 
     notab>
    <img src=../images/SearchIcon.gif class=Icon
     onclick='LinkProcedure();'>
    </td></tr>

<tr><td class=DataLabel>Date Booking Keyed        </td>
    <td class=DataField><input type=text name=bkrec034 size=12 maxlength=12 
         class=Mandatory title="Date booking keyed"
     value='%STANDARD.01.015'></td>

    <td class=DateLabel>Operator ID       </td>
    <td class=DataField><input type=text size=12 maxlength=12 readonly
         class=Readonly value='%WATWEB01.02.310' ></td></tr>

<tr><td colspan=4 align=center> 
    <input type=button value=Ok class="button" tabindex=32
     onclick='AddBook();'>
    <input type=button value=Cancel class="button" tabindex=33
     onclick='PatientLinkTo("watweb01.pbl",2,1,0,0,0);'>
    </td></tr>
</table>
</form>
</div>
 
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%WATWEB01.02.003">
<input type=hidden name=admissno value="%WATWEB01.02.081">
<input type=hidden name=MenuType value="%WATWEB01.02.088">
<input type=hidden name=casekeys value="%WATWEB01.02.101">
</form>

