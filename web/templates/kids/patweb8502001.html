<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="kids">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language=javascript src=../js/TableSort.js></script>
<script type="text/javascript" src="../js/patweb85.js"></script>
<script type="text/javascript" src="../js/MrtLocations.js"></script>
<script type="text/javascript" src="../js/MrtMultiLocations.js"></script>
<script language=javascript>
function ValidateMRTS() {
  var serverURL = "../cgi-bin/mrtweb04.pbl?reportno=6" +
                  "&valdmrts=" + SelectPeriod.mrtsecno.value.replace(/ /g,"+")

  var returnValue = RSExecute(serverURL);

  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    SelectPeriod.mrtsecid.value=ReturnValue[0];
    return true;
  } else {
    SelectPeriod.mrtsecno.select();
    return false }
}

function moveRecords() {
  if (validateMandatory(SelectPeriod)) {

    if (SelectPeriod.mrtsecno!=undefined) {
      ans=ValidateMRTS();
      if (ans==false) { return; }
    }
    document.SelectPeriod.submit();
  }
}

function UpdateFilled(CheckBox){

  if (!validateMandatory(SelectPeriod)) {
    if (CheckBox.checked) {
        CheckBox.checked=false; }
    else {
        CheckBox.checked=true; }
        return;
    }

    if (SelectPeriod.mrtsecno!=undefined) {
      ans=ValidateMRTS();
      if (ans==false) { 
        if (CheckBox.checked) {
            CheckBox.checked=false; }
        else {
            CheckBox.checked=true; }
            return;
      }
    }
    UpdateSeque=1
    UpdateValue=0
    if (CheckBox.checked) {
       eval("can"+CheckBox.name.substr(3,4)).checked=false
       eval("prc"+CheckBox.name.substr(3,4)).checked=false
       UpdateValue=1 }
    var serverURL = "../cgi-bin/patweb85.pbl?reportno=3" +
                  "&mrtrecky=" + CheckBox.value.replace(/ /g,"+") +
                  "&checkbox=" + UpdateValue +
                  "&sequence=" + UpdateSeque +
                  "&mrtsecid=" + SelectPeriod.mrtsecid.value.replace(/ /g,"+") +
                  "&mrtsecno=" + SelectPeriod.mrtsecno.value.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {
      ReturnCode.select();  }
}

function UpdateCancel(CheckBox){

  if (!validateMandatory(SelectPeriod)) {
    if (CheckBox.checked) {
        CheckBox.checked=false; }
    else {
        CheckBox.checked=true; }
        return;
    }

    if (SelectPeriod.mrtsecno!=undefined) {
      ans=ValidateMRTS();
      if (ans==false) { 
        if (CheckBox.checked) {
            CheckBox.checked=false; }
        else {
            CheckBox.checked=true; }
            return;
      }
    }

    UpdateSeque=2
    UpdateValue=0
    if (CheckBox.checked) {
       eval("fil"+CheckBox.name.substr(3,4)).checked=false
       eval("prc"+CheckBox.name.substr(3,4)).checked=false
       UpdateValue=1 }
    var serverURL = "../cgi-bin/patweb85.pbl?reportno=3" +
                  "&mrtrecky=" + CheckBox.value.replace(/ /g,"+") +
                  "&checkbox=" + UpdateValue +
                  "&sequence=" + UpdateSeque +
                  "&mrtsecid=" + SelectPeriod.mrtsecid.value.replace(/ /g,"+") +
                  "&mrtsecno=" + SelectPeriod.mrtsecno.value.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {
      ReturnCode.select();  }
}

function UpdateProgrs(CheckBox){

  if (!validateMandatory(SelectPeriod)) {
    if (CheckBox.checked) {
        CheckBox.checked=false; }
    else {
        CheckBox.checked=true; }
        return;
    }

    if (SelectPeriod.mrtsecno!=undefined) {
      ans=ValidateMRTS();
      if (ans==false) { 
        if (CheckBox.checked) {
            CheckBox.checked=false; }
        else {
            CheckBox.checked=true; }
            return;
      }
    }

    UpdateSeque=3
    UpdateValue=0
    if (CheckBox.checked) {
       eval("can"+CheckBox.name.substr(3,4)).checked=false
       eval("fil"+CheckBox.name.substr(3,4)).checked=false
       UpdateValue=1 }
    var serverURL = "../cgi-bin/patweb85.pbl?reportno=3" +
                  "&mrtrecky=" + CheckBox.value.replace(/ /g,"+") +
                  "&checkbox=" + UpdateValue +
                  "&sequence=" + UpdateSeque +
                  "&mrtsecid=" + SelectPeriod.mrtsecid.value.replace(/ /g,"+") +
                  "&mrtsecno=" + SelectPeriod.mrtsecno.value.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {
      ReturnCode.select();  }
}
function UpdateHeader(mrtkey,urno){
  SelectPeriod.template.value=2
  SelectPeriod.mrtrecky.value=mrtkey
  SelectPeriod.urnumber.value=urno
  Left=(document.body.clientWidth-450)/2
  DFrameSubmit(SelectPeriod,100,Left,450,250)
}
function SetHos() {
  SetFiltLocn(SelectPeriod);
}
function CheckHosp() {
  if (document.SelectPeriod.ibcnmhos.value=="1") {
     if (isWhitespace(document.SelectPeriod.filthosp.value)) {
         alert("A valid Hospital must be selected");
         document.SelectPeriod.filtlocn.selectedIndex=0;
         return;
     }
  }
  if (document.SelectPeriod.ibcnmhos.value=="1") {
    document.SelectPeriod.dflthosp.value = document.SelectPeriod.filthosp.value;
    document.SelectPeriod.dfltlocn.value = document.SelectPeriod.filtlocn.value;
  } else {
    document.SelectPeriod.dflthosp.value = "    ";
  }
  reSubmit()
}
function reSubmit() {
  document.SelectPeriod.updatety.value="";
  document.SelectPeriod.submit();
}
// ------------------------------------------------------------
// Columns Available
//  0 - HTML Link    
//  1 - Request No  
//  2 - UR          
//  3 - Date/Time           
//  4 - Movement Reasion Description
//  5 - Current Location
//  6 - Destination    
//  7 - Volume Number 
//  8 - Filled Status
//  9 - Filled     
// 10 - Cancel           
// 11 - Cancel           
// 12 - Movement Reason Code      
// 13 - Patient Name     
// ------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 t = new Table(1,0,1,"100%","center");
 t.addColumn("Request No.","String",1,1,"left","MaintenanceIcon.gif","0",70)
 t.addColumn("UR No.","String",2,8,"center","","",50)
 t.addColumn("Patient Name","String",13,13,"left","","",110)
 t.addColumn("Date/Time","DateTime",3,3,"","","",98)
 t.addColumn("Reason","String",12,12,"left","","",45)
 t.addColumn("Destination","String",6,6,"","","",60)
 t.addColumn("Current Location","String",5,5,"","","",60)
 t.addColumn("Vol.","String",7,7,"center","","",25)
 t.addColumn("Status","String",25,25,"center","","",60)
 t.addColumn("Process","String",9,9,"center","","",47)
 t.addColumn("Filled","String",10,10,"center","","",35)
 t.addColumn("Cancel","String",11,11,"center","","",40)
 AddTableRows()
 TableOutput(0,1);    // Order Column,Asc Dsc
 break;
 }
 }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);SetHos();InitTable(0);">
<div id=HeadingSection>
<form name="SelectPeriod" action="patweb85.pbl" method="get" style="margin:0">
 <input type="hidden" name="reportno" value="2">
 <input type="hidden" name="template" value="1">
 <input type="hidden" name="viewtype" value="%PATWEB85.02.210">
 <input type="hidden" name="mrtrecky">
 <input type="hidden" name="urnumber">
 <input type="hidden" name="mrtsecid" value="">
 <input type="hidden" name="updatety" value="">
 <input type="hidden" name="ibcnmhos" value="%STANDARD.01.025.000.043.1.1">
 <input type="hidden" name="showflag" value="1">
 <input type="hidden" name="dflthosp" value="%PATWEB85.02.134.0">
 <input type="hidden" name="dflthhos" value="%PATWEB85.02.134.2">
 <input type="hidden" name="dfltlocn" value="%PATWEB85.02.141">
 <input type="hidden" name="superlev" value="%PATWEB85.02.135">
 <input type="hidden" name="mrcntday" value="%STANDARD.01.025.097.170.0.2">

<table cellpadding=1 cellspacing=1 bgcolor=#CCCCCC border=1 width=100%>
<tr><td>
 <table cellpadding=1 cellspacing=1 bgcolor=#CCCCCC border=0 width=100%>
 <tr><td id="Hospital"></td>
   <td id="HospitalReq"></td>
   <td>Destination<br>
     <select name="filtlocn" id=filtlocn onchange="CheckHosp();">
     <option value="   ">All</option>
<!--   <select name=location onchange='this.form.submit()'>
   <option value="    ">All</option>
   %PATWEB85.02.103     -->
   </select></td>
   <td>Filled<br>
   <select name=filledrc id=filledrc onchange='this.form.submit()'>
    %PATWEB85.02.220
   </select></td>

   <td class=DataLabel><br><input type=button value="<<" class=smallbutton
    onclick='%PATWEB85.02.202'>
    %PATWEB85.02.207
    <input type=button value=">>" class=smallbutton
    onclick='%PATWEB85.02.201'>
    </td>
   <td>
   <br>
   <a href='javascript:SelectDateFrame();'>
   <img src="../images/CalendarLookup.gif" border=0
    alt="Select Date" align=absmiddle></a>
   <a href='javascript:SelectView("0");'>
   <img src=../images/DayIcon.gif border=0
    alt="View Today" align=absmiddle></a>
   <a href='javascript:SelectView("1");'>
   <img src=../images/WeekIcon.gif border=0
    alt="View This Week" align=absmiddle></a>
   <a href='javascript:SelectView("2");'>
   <img src=../images/MonthIcon.gif border=0
    alt="View This Month" align=absmiddle></a>
   </td>

   <td align=right class=DataLabel>MRT Security Number<br>
       <input type=password name=mrtsecno id=mrtsecno size=16 maxlength=8
        title="MRT Security Number" class=Mandatory
        onkeyDown="return TrapEnterKey();">
   </td>
   <td align=center><br><input type=button class=SmallButton value="Move"
       onclick="moveRecords();"></td>
<!--
   <td><br><input type=submit value="Move" class=refreash();></td>
   <td><br><input type=submit value="Print" class="button"></td>
-->
   </tr>
   </table>
</td></tr>
</table>
</form>
</div>
<div id="TableLocation"></div>
    
  <span id="ShowHomeHosp" style="display:none">
    Hospital<br>
    <select name="filthhos" id=filthhos title="Hospital" class="Mandatory"
     onchange="reSubmit();">
    <option value="   ">All</option>
    %PATWEB85.02.139
    </select>
  </span>   

  <span id="ShowNoHomeHosp" style="display:none">
     <input type=hidden name=filthhos id=filthhos value="    ">
  </span>
           
  <span id="ShowRequHosp" style="display:none">
    Requesting Hospital<br>
    <select name="filthosp" id=filthosp title="Hospital" class="Mandatory"
     onchange="ResetLocn(SelectPeriod);reSubmit();">
    <option value="   ">All</option>
    %PATWEB85.02.140
    </select>
  </span>

  <span id="ShowNoRequHosp" style="display:none">
     <input type=hidden name=filthosp id=filthosp value="    ">
  </span>

<script language="Javascript">
function AddTableRows() {
%PATWEB85.02.211.patweb85.02.002
}

  var ibcnmhos=%STANDARD.01.025.000.043.1.1;
  if (ibcnmhos == "1") {
    document.getElementById('Hospital').innerHTML=
      document.getElementById('ShowHomeHosp').innerHTML;
    document.getElementById('HospitalReq').innerHTML=
      document.getElementById('ShowRequHosp').innerHTML;
  } else {
    document.getElementById('Hospital').innerHTML=
      document.getElementById('ShowNoHomeHosp').innerHTML;
    document.getElementById('HospitalReq').innerHTML=
      document.getElementById('ShowNoRequHosp').innerHTML;
  }
</script>
