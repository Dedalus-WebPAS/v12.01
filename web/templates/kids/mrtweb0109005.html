<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="kids">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/mrtweb01.js"></script>
<script type="text/javascript" src="../js/mrtweb0109.js"></script>
<script type="text/javascript" src="../js/MrtHomeLocns.js"></script>
<script type="text/javascript" src="../js/MrtLocations.js"></script>
<script type="text/javascript" src="../js/MrtMultiHomeLocns.js"></script>
<script type="text/javascript" src="../js/MrtMultiLocations.js"></script>
<script type="text/javascript">
function Set() {
  SetHospital(AddForm);
  SetDestination(AddForm);
  SetHomeHosp(AddForm);
  SetHomeLocn(AddForm);
}
function SetDestination(p) {
//  if(p.ibcnmhos.value=="1") {
    if (!isWhitespace(p.mrtme019.value)) {
         p.desthosp.value = p.mrtme019.value; }
//    }
  if (!isWhitespace(p.mrtme003.value)) {
       p.destlocn.value = p.mrtme003.value; }

  p.mrtme003.options.length=0;
  p.mrtme003.options[p.mrtme003.options.length]=new Option(" "," ");
  if(p.ibcnmhos.value=="1") {
    MrtMultiLocations(p.mrtme003,p.destlocn.value,p.desthosp.value)
  } else {
    MrtLocations(p.mrtme003,p.destlocn.value)
  }
}
function OutputTableHom(ReturnCode) { 
    if (isWhitespace(AddForm.mrtme003.value)) {
    c=c+1
    if (c==1) {
    alert("Destination is required !");
    c=c+1
    }
    AddForm.mrtme003.focus();
    AddForm.URNumber.value="";
    return;
  }  
  if (ItemCnt>=99) {
    alert("Page Limit Reached");
    return;
  }
  if (isWhitespace(ReturnCode.value)) return;;
  var MrKeyRecord="";
  var PatientName="";
  var CurrentHosp="";
  var CurrentLoct="";
  var LastMovDate="";
  var Description="";
  var Flag=0;
  var serverURL = "../cgi-bin/mrtweb01.pbl?reportno=14" +
                  "&mrkeyarr=" + ReturnCode.value.replace(/ /g,"+") +
                  "&docmtype=" + AddForm.mrtme010.value.replace(/ /g,"+") +
                  "&volumeno=" + AddForm.mrtme011.value.replace(/ /g,"+") +
                  "&mrtme001=" + AddForm.mrtme001.value.replace(/ /g,"+") +
                  "&mrtme002=" + AddForm.mrtme002.value.replace(/ /g,"+") +
                  "&mrtme019=" + AddForm.mrtme019.value.replace(/ /g,"+") +
                  "&mrtme003=" + AddForm.mrtme003.value.replace(/ /g,"+") +
                  "&homehosp=" + AddForm.mrtme020.value.replace(/ /g,"+") +
                  "&location=" + AddForm.mrtme017.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  ReturnValue=returnValue.return_value.split("|");
  if (returnValue.status==0) {
    ItemCnt++

  for (var i=0; i < document.AddForm.length; i++) {
    if (document.AddForm.elements[i].name.match(/mrkeyarr/)) {
      enterur=ReturnValue[0].substring(0,8);
      checkey=document.AddForm.elements[i].value.substring(0,8);
      if (enterur == checkey) {
        alert("Warning: U/R already entered!"); 
        document.AddForm.URNumber.value="";
        document.AddForm.URNumber.focus();
        break; } } }

    var mrtkey=new Object();     
    mrtkey.value=ReturnValue[0].replace(/\+/g," "); 
    filreqed=ReturnValue[18];   
    OutputArrayHomSCol(ReturnValue[0],ReturnValue[1],ReturnValue[2],
                   ReturnValue[3],ReturnValue[4],ReturnValue[5],ReturnValue[19],
                   ReturnValue[32])
    OutputDivisionHom()
    AlertErrors(ReturnValue[6],ReturnValue[8],ReturnValue[9],ReturnValue[10],
                ReturnValue[11],ReturnValue[12],ReturnValue[13],ReturnValue[14],
                ReturnValue[15],ReturnValue[16],ReturnValue[0],ReturnValue[17],
                ReturnValue[20],ReturnValue[21],ReturnValue[22],ReturnValue[23],
                ReturnValue[24],ReturnValue[25],ReturnValue[26])

    if (filreqed=="Y") {
      CheckLoc(mrtkey,AddForm);   // Check for Outstanding Filing?
    }
    ReturnCode.value="";
    ReturnCode.focus();
    if (!isWhitespace(document.AddForm.mrtme011.value)){
      document.AddForm.mrtme011.value=""; }
  }
  else {
    ReturnCode.focus();
    ReturnCode.value="";
    if (!isWhitespace(document.AddForm.mrtme011.value)){
      document.AddForm.mrtme011.value=""; }
    ReturnCode.select();  }
}

function SetUrEventHomKids() {
  if (event.keyCode == 13) {  // Carriage Return
    FormatURScan(document.AddForm.URNumber);
    validateHomLocKids();
  } else if (event.keyCode == 9) {  // Tab
    FormatURScan(document.AddForm.URNumber);
    validateHomLocKids();
    setTimeout('document.AddForm.URNumber.focus()',100);
  }
}

function OutputTableHomKids(ReturnCode) {
  if (isWhitespace(AddForm.mrtme003.value)) {
    c=c+1
    if (c==1) {
    alert("Destination is required !");
    c=c+1
    }
    AddForm.mrtme003.focus();
    AddForm.URNumber.value="";
    return;
  }  
  if (ItemCnt>=99) {
    alert("Page Limit Reached");
    return;
  }
  if (isWhitespace(ReturnCode.value)) return;;
  var MrKeyRecord="";
  var PatientName="";
  var CurrentHosp="";
  var CurrentLoct="";
  var LastMovDate="";
  var Description="";
  var Flag=0;
  var serverURL = "../cgi-bin/mrtweb01.pbl?reportno=14" +
                  "&mrkeyarr=" + ReturnCode.value.replace(/ /g,"+") +
                  "&docmtype=" + AddForm.mrtme010.value.replace(/ /g,"+") +
                  "&volumeno=" + AddForm.mrtme011.value.replace(/ /g,"+") +
                  "&mrtme001=" + AddForm.mrtme001.value.replace(/ /g,"+") +
                  "&mrtme002=" + AddForm.mrtme002.value.replace(/ /g,"+") +
                  "&mrtme019=" + AddForm.mrtme019.value.replace(/ /g,"+") +
                  "&mrtme003=" + AddForm.mrtme003.value.replace(/ /g,"+") +
                  "&homehosp=" + AddForm.mrtme020.value.replace(/ /g,"+") +
                  "&location=" + AddForm.mrtme017.value.replace(/ /g,"+") 
                  
  var returnValue = RSExecute(serverURL);
  ReturnValue=returnValue.return_value.split("|");
  if (returnValue.status==0) {
    ItemCnt++
//
//  Check for an already entered U/R
//
  for (var i=0; i < document.AddForm.length; i++) {
    if (document.AddForm.elements[i].name.match(/mrkeyarr/)) {
      enterur=ReturnValue[0].substring(0,8);
      checkey=document.AddForm.elements[i].value.substring(0,8);
      if (enterur == checkey) {
        alert("Warning: U/R already entered!"); 
        document.AddForm.URNumber.value="";
        document.AddForm.URNumber.focus();
        break; } } }
//
// Note CheckLoc accepts first parameter as an object so using obj mrtkey!!
//
    var mrtkey=new Object();     
    mrtkey.value=ReturnValue[0].replace(/\+/g," "); 
    filreqed=ReturnValue[18];   
    OutputArrayHomKids(ReturnValue[0],ReturnValue[1],ReturnValue[2],
                   ReturnValue[3],ReturnValue[4],ReturnValue[5],ReturnValue[19])
    OutputDivisionHom()
    AlertErrorsKids(ReturnValue[6],ReturnValue[8],ReturnValue[9],
                    ReturnValue[10],ReturnValue[11],ReturnValue[12],
                    ReturnValue[13],ReturnValue[14],ReturnValue[15],
                    ReturnValue[16],ReturnValue[0],ReturnValue[17],
                    ReturnValue[20],ReturnValue[21],ReturnValue[22],
                    ReturnValue[23],ReturnValue[24],ReturnValue[25],
                    ReturnValue[26])

    if (filreqed=="Y") {
      CheckLoc(mrtkey,AddForm);   // Check for Outstanding Filing?
    }
    ReturnCode.value="";
    ReturnCode.focus();
    if (!isWhitespace(document.AddForm.mrtme011.value)){
      document.AddForm.mrtme011.value=""; }
  }
  else {
    ReturnCode.focus();
    ReturnCode.value="";
    if (!isWhitespace(document.AddForm.mrtme011.value)){
      document.AddForm.mrtme011.value=""; }
    ReturnCode.select();  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);setTimeout('Set()',100);">
<table border=0 align=center width=100% cellpadding=0 cellspacing=0> 
<tr><td class=HeadingCell align=center>
Change Home Locations
</td></tr>
</table>

<form name=AddForm method=post action=mrtweb01.pbl style="margin:0">
<input type=hidden name=reportno value="9">
<input type=hidden name=template value="005">
<input type=hidden name=updttype value="H">
<input type=hidden name=redirect value="5">
<input type=hidden name=nextpage value="">
<input type=hidden name=urnumber value="%MRTWEB01.09.111">
<input type=hidden name=Mergedur value="">
<input type=hidden name=Merged value="">
<input type=hidden name=mrrecord value="">
<input type=hidden name=mrtsecid value="">
<input type=hidden name=mrcnwnhl value="%MRTWEB01.09.305">
<input type=hidden name=mrcnibap value="%STANDARD.01.025.097.165.0.1">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=dflthosp value="%MRTWEB01.09.137.0">
<input type=hidden name=dfltlocn value="%MRTWEB01.09.137.1">
<input type=hidden name=desthosp value="%MRTWEB01.09.137.0">
<input type=hidden name=destlocn value="%MRTWEB01.09.137.1">
<input type=hidden name=superlev value="%MRTWEB01.09.136">

<table border=0 align=center width=90% cellpadding=1> 
<tr><td class=DataLabel>Date Required</td>
    <td><input type=text size=12 name=mrtme001 id=mrtme001
         class="Mandatory Date" title="Date Required" 
         value="%STANDARD.01.015" onblur='AlertDate(this);'>
         <img notab src=../images/DateLookup.gif border=0 hspace=4 
         align=absmiddle onclick="DateLookupFrame(mrtme001);"> 
                                                      
        <input class=Mandatory type=text name=mrtme002 id=mrtme002
         size=8 value="%STANDARD.01.016" title="Time">
        <img notab src=../images/DateTimeStamp.gif class=Icon
         onclick="SetCurrentDateTime(mrtme001,mrtme002);">     
        <img notab src=../images/TimeLookup.gif class=Icon
         onclick="TimeLookupFrame(mrtme002);">                 
    </td>                                                  
   <td>Reason</td>     
    <td><select name=mrtme005 id=mrtme005 title="Reason">
    <option></option>
    %MRTWEB01.09.204
    </select>
    </td>                                                  
</tr>

<tr><td>Home Location</td>
    <td><input type=hidden name=d_mrtme017 id=d_mrtme017
         value="%MRTWEB01.09.201.3">
    <select name=mrtme017 id=mrtme017 class="Mandatory" title="Home Location"
         onchange=ResetHomeLocn(AddForm);>
    <option></option>
<!--    %MRTWEB01.09.123    -->
    </select>
    </td>                                                  

    <td>Ignore Incomplete Coding</td>     
    <td><input type=checkbox name=ignorcod id=ignorcod
         title="Ignore Icomplete Coding">  
    </td>                                                  
    <td class=DataLabel><div id=HomeHospTitle></div></td>
    <td><div id=HomeHosp></div></td>
</tr>                                                  

<tr><td>Destination</td>
    <td><input type=hidden name=d_mrtme003 id=d_mrtme003
         value="%MRTWEB01.09.201.3">
        <select name=mrtme003 id=mrtme003 class="Mandatory" title="Destination">  
    <option></option>
<!--   %MRTWEB01.09.201.2  -->
    </select>
    </td>                                                  
    <td class=DataLabel>MRT Security Number</td>
    <td><input type=password name=mrtsecno id=mrtsecno size=16 maxlength=8
         title="MRT Security Number" class=Mandatory>
    </td>
    <tr><td class=DataLabel><div id=HospitalTitle></div></td>
        <td><div id=Hospital></div></td>
</tr>                                                  

<tr><td>Document Type</td>     
    <td><select name=mrtme010 id=mrtme010 class=Mandatory title="Document Type">            
    <option></option>
    %MRTWEB01.09.202.2
    </select>
    </td>                                                  
</tr>
 
<tr><td>U/R Number</td>
    <td><input type=text name=URNumber id=URNumber title="UR"
         onKeyDown="SetUrEventHomKids();"> 
        <input type=hidden name=d1 id=d1>
        <input type=hidden name=d2 id=d2>
        <input type=hidden name=mrtme011 id=mrtme011>
        <img src=../images/SearchIcon.gif class=Icon notab
         onclick="SearchPatientHomKids();">
    </td>
</tr>                                 
</table>

<div id=Results></div>

<table border=0 align=center width=100% cellspacing=1>
<tr><td colspan=2 align=center><br>
   <input type=button value="Change" class="button" onclick="ChangeHome()">
   <input type=button value="Continue" class="button" onclick="ConChangeHome()">
   <input type=button value="Clear" class="button" onclick="location.reload()">
</td></tr>
</table>
</form>
<script type="text/javascript">
document.AddForm.mrtme017.selectedIndex=0;
</script>

<span id=ShowHospitalTitle style="display:none">
   Destination Hospital
</span>

<span id=ShowHospital style="display:none">
  <select name=mrtme019 id=mrtme019 title="Hospital" class="Mandatory"
   onchange="SetDestination(AddForm);">
  %MRTWEB01.09.307
  </select>
</span>

<span id=ShowNoHospital style="display:none">
<!--   <input type=hidden name=desthosp id=desthosp value="    ">-->
       <input type=hidden name=mrtme019 id=mrtme019 value="    ">
</span>

<span id=ShowHomeHospTitle style="display:none">
  Home Hospital
</span>

<span id=ShowHomeHosp style="display:none">
  <select name=mrtme020 id=mrtme020 title="Home Hospital" class="Mandatory"
   onchange="SetHomeLocn(AddForm);">
  %MRTWEB01.09.307
  </select>
</span>

<span id=ShowNoHomeHosp style="display:none">
   <input type=hidden name=mrtme020 id=mrtme020 value="    ">
</span>
