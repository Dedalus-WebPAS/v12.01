<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="svmp">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/preadmission.js"></script>
%START.OF.PAGE
<script type="text/javascript">
if("%STANDARD.01.025.119.182.0.1"=="1") { // Episoft ptcnepis
  var src="../js/eAdmissionReg.js";
} else {
  var src="../js/DefaultOnlineAdm.js";
}
var script = document.createElement("script");
             script.setAttribute("src", src);
             script.setAttribute("type", "text/javascript");
document.getElementsByTagName("head")[0].appendChild(script);
function switchPresIll() {
  if (document.UpdateForm.presilsw.checked==true) {
    PresIllCodHdr.innerHTML=presillnumhdr.innerHTML;
    PresIllCod.innerHTML=presillnum.innerHTML;
  } else {
    PresIllCodHdr.innerHTML=presillcodhdr.innerHTML;
    PresIllCod.innerHTML=presillcod.innerHTML;
  }

}
function chkDOS(datefield) {
  if(!isWhitespace(datefield.value)){
    if(!ChkDateTime(UpdateForm.ptmis001,null,datefield,null)){
      alert(datefield.title+" cannot be before Admission Date");
      return false;
    }
  }
  return true;
}
function mandatoryItemCode(ItemCode,DateofService,ServiceQuantity) {

  if(!isWhitespace(ItemCode.value)) {
    DateofService.className="Mandatory FutureDate";
    ServiceQuantity.className="Mandatory Integer";
  } else {
    DateofService.className="FutureDate";
    ServiceQuantity.className="Integer";
  }

}
function ItemCodeSearchFrame(ItemType,ItemCode,ItemDescription) {

  if (ItemType.value=="6") {
    MiscChargeSearchFrame(ItemCode,ItemDescription);
  }

  if (ItemType.value=="3") {
    MbsSearchFrame(ItemCode,ItemDescription);
  }

}
function validateItemCode(ItemType,ItemCode,ItemClam,ItemFund,ItemTabl,ItemDescription) {

  if (ItemType.value=="6") {
    validateMsc1(ItemCode,ItemClam,ItemFund,ItemTabl,ItemDescription);
  }

    if (ItemType.value=="3") {
    validateCode(4,ItemCode,ItemDescription);
  }

}
function validateOECRequired(theForm) {
  for (i=0; i<theForm.elements.length; i++) {
    el=theForm.elements[i]
    if (el.className.match(/OECRequired/)) {
      if (!checkOECString(el,el.title)) {
         return false } }
    }

    if (isWhitespace(document.UpdateForm.patsurnm.value)) {
      alertOEC(document.UpdateForm.patsurnm);
      return false;
    }

    if (isWhitespace(document.UpdateForm.patgivnm.value)) {
      alertOEC(document.UpdateForm.patgivnm);
      return false;
    }

    if (isWhitespace(document.UpdateForm.patntdob.value)) {
      alertOEC(document.UpdateForm.patntdob);
      return false;
    }

//  if (isWhitespace(document.UpdateForm.medicrdn.value)) {
//    alertOEC(document.UpdateForm.medicrdn);
//    return false;
//  }

//  if (isWhitespace(document.UpdateForm.medicrdr.value)) {
//    alertOEC(document.UpdateForm.medicrdr);
//    return false;
//  }

  return true;
}
function alertOEC(OECpmifield) {
  alert("Online Eligibility Details Incomplete. Request Not Processed.\n"+
        OECpmifield.title+" is a required OEC PMI field.\n"+
        "Please enter it now.");
}
function checkOECString (theField, s, emptyOK) {
if (checkOECString.arguments.length == 2) emptyOK = false;
 if ((emptyOK == true) && (isEmpty(theField.value))) return true;
 if (isWhitespace(theField.value))
   return warnOECEmpty (theField, s);
 else return true;
}
function warnOECEmpty (theField, s) {
 alert("Online Eligibility Details Incomplete. Request Not Processed.\n"
       + s + " is a required OEC field.\nPlease enter it now." )
 theField.focus()
 return false
}
function OECRequired() {
 if(document.UpdateForm.oecchbox.checked == true) {

     if (UpdateForm.ptvis043.className=="Mandatory") {
       UpdateForm.ptvis043.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptvis043.className="OECRequired";  //Intended Stay
     }

     if (UpdateForm.ptmis007.className=="Mandatory") {
       UpdateForm.ptmis007.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis007.className="OECRequired";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="Mandatory") {
       UpdateForm.doctnam2.className="OECRequired Mandatory";
     } else {
       UpdateForm.doctnam2.className="OECRequired";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis020.className=="Mandatory") {
       UpdateForm.ptmis020.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis020.className="OECRequired";  //Diagnosis
     }

     if (UpdateForm.ptmis027.className=="Mandatory") {
       UpdateForm.ptmis027.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis027.className="OECRequired";  //Claim Type
     }

     if (UpdateForm.funddesc.className=="Mandatory") {
       UpdateForm.funddesc.className="OECRequired Mandatory";
     } else {
       UpdateForm.funddesc.className="OECRequired";  //Health Fund Code
     }

     if (UpdateForm.tabldesc.className=="Mandatory") {
       UpdateForm.tabldesc.className="OECRequired Mandatory";
     } else {
       UpdateForm.tabldesc.className="OECRequired";  //Health Fund Code
     }

     UpdateForm.ptmis030.className="OECRequired Integer";    //Planned Length
     UpdateForm.ptvis076.className="OECRequired";            //Discharge Inten
     UpdateForm.ptmis015.className="OECRequired";            //Member Nunber

  } else {

     if (UpdateForm.ptvis043.className=="OECRequired Mandatory") {
       UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
     } else {
       UpdateForm.ptvis043.className="";  //Intended Stay
     }

     if (UpdateForm.ptmis007.className=="OECRequired Mandatory") {
       UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     } else {
       UpdateForm.ptmis007.className="";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="OECRequired Mandatory") {
       UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor Desc
     } else {
       UpdateForm.doctnam2.className="";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis020.className=="OECRequired Mandatory") {
       UpdateForm.ptmis020.className="Mandatory";  //Diagnosis
     } else {
       UpdateForm.ptmis020.className="";  //Diagnosis
     }

     if (UpdateForm.ptmis027.className=="OECRequired Mandatory") {
       UpdateForm.ptmis027.className="Mandatory";  //Claim Type
     } else {
       UpdateForm.ptmis027.className="";  //Claim Type
     }

     if (UpdateForm.funddesc.className=="OECRequired Mandatory") {
       UpdateForm.funddesc.className="Mandatory";  //Health Fund
     } else {
       UpdateForm.funddesc.className="";  //Health Fund
     }

     if (UpdateForm.tabldesc.className=="OECRequired Mandatory") {
       UpdateForm.tabldesc.className="Mandatory";  //Health Fund
     } else {
       UpdateForm.tabldesc.className="";  //Health Fund
     }

     UpdateForm.ptmis030.className="Integer";    //Planned Length of Stay
     UpdateForm.ptvis076.className="";           //Discharge Inten
     UpdateForm.ptmis015.className="";           //Member Number
  }
}
function ShowOECFields() {
  if(document.UpdateForm.oecchbox.checked == true) {
    PreExistAilHdr.innerHTML=preexisthdr.innerHTML;
    PreExistAilmnt.innerHTML=preexistail.innerHTML;
    EmerAdmHdr.innerHTML=emeradmnhdr.innerHTML;
    EmerAdmssn.innerHTML=emeradmissn.innerHTML;
    PresIllCodHdr.innerHTML=presillcodhdr.innerHTML;
    PresIllCod.innerHTML=presillcod.innerHTML;
    SwiPresIll.innerHTML=swipresill.innerHTML;
    LongLine.innerHTML=longline.innerHTML;
    OESServices.innerHTML=oesservices.innerHTML;
  } else {
    PreExistAilHdr.innerHTML=blanklabel.innerHTML;
    PreExistAilmnt.innerHTML=blanklabel.innerHTML;
    EmerAdmHdr.innerHTML=blanklabel.innerHTML;
    EmerAdmssn.innerHTML=blanklabel.innerHTML;
    PresIllCodHdr.innerHTML=blanklabel.innerHTML;
    PresIllCod.innerHTML=blanklabel.innerHTML;
    SwiPresIll.innerHTML=blanklabel.innerHTML;
    LongLine.innerHTML=blanklabel.innerHTML;
    OESServices.innerHTML=blanklabel.innerHTML;
  }
}
function SubmitAdm() {
  MandatoryOk=true;
  if (!validateMandatory(document.UpdateForm)) {
    return;
  }

  p = document.UpdateForm
  validateSuspension(p.urnumber,p.ptmis001,p.datefrom,p.dateto);
  if (p.datefrom.value!='0') {
    if (p.admitbox.value=="1") {
      document.UpdateForm.admitbox.value="0";
      ans=confirm("Warning : Patient has a Suspension record for period \n" +
            "\t" + p.datefrom.value  + " - " + p.dateto.value + "\n" +
            "\tPatient will not be admitted");
    }
    else {
      ans=confirm("Warning : Patient has a Suspension record for period \n" +
            "\t" + p.datefrom.value  + " - " + p.dateto.value);
    }
    if (ans!=true) {
      return;
    }
  }

    if (document.UpdateForm.oecchbox.checked==true) {
      if (!validateOECRequired(document.UpdateForm)) {
         return;
      }
      if (!validateParticipant(document.UpdateForm.ptmis013.value,"OEC")) {
         return;
      }
    }
    if (!isWhitespace(UpdateForm.ptmis013.value)) {
        if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
                       UpdateForm.funddesc,UpdateForm.tabldesc)) {
           ans=confirm("Select another active health fund table? ");
           if (ans==true) {
              return;
           } 
        } 
    }

  if (UpdateForm.oes01007!=undefined) {

    if (!chkDOS(UpdateForm.oes01007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes02007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes03007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes04007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes05007)) {
      return;
    }
  }

  if(document.UpdateForm.mvmedre1.checked == true) {
     document.UpdateForm.mvmedrec.value="1";
  } else {
     document.UpdateForm.mvmedrec.value="0";
  }
  if(document.UpdateForm.oecchbox.checked == true) {
     document.UpdateForm.ptvis109.value="1";
  }
 
  if(document.UpdateForm.admitbox.checked == true) {
    if(checkMultipleAdmission(UpdateForm)){
      return;
    }
  }
  
  if (MandatoryOk) {
    setRedirect();
    UpdateForm.ptmis004.value=UpdateForm.ptmis068.value;
    UpdateForm.ptmis005.value=UpdateForm.ptmis076.value;
    if(document.getElementById("ptcnepis").value == "1") {  // Episoft ptcnepis
      if (!isWhitespace(document.UpdateForm.admisnid.value)) {
        SetCookie("eAdmission",eAdmCookie);
      }
    }
    SubmitHidden(UpdateForm);
    }
}
function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
  selectOptions("30",UpdateForm.ptmis007,UpdateForm.ptmis024);
  UpdateForm.ptmis024.selectedIndex=1
}
function AdmitMandatory() {
 if(document.UpdateForm.admitbox.checked == true) {
     document.UpdateForm.admitbox.value="1";
     UpdateForm.ptmis011.className="Mandatory";  //admission type
     UpdateForm.ptmis009.className="Mandatory";  //admission source
     UpdateForm.ptvis041.className="Mandatory";  //criteria for admission
     UpdateForm.ptmis012.className="Mandatory";  //care type
     UpdateForm.ptmis068.className="Mandatory";  //ward

     if (UpdateForm.ptmis007.className=="OECRequired") {
       UpdateForm.ptmis007.className="OECRequired Mandatory";  //Admitting Doc
     } else {
       UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="OECRequired") {
       UpdateForm.doctnam2.className="OECRequired Mandatory";  //Admitting Doc
     } else {
       UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor Desc
     }

     UpdateForm.ptmis024.className="Mandatory";  //Unit

     if (UpdateForm.ptmis027.className=="OECRequired") {
       UpdateForm.ptmis027.className="OECRequired Mandatory";  //Admitting Doc
     } else {
       UpdateForm.ptmis027.className="Mandatory";  //Admitting Doctor Desc
     }

     UpdateForm.ptmis010.className="Mandatory";  //CMBS Class

     if (UpdateForm.ptvis043.className=="OECRequired") {
       UpdateForm.ptvis043.className="OECRequired Mandatory";  //Intended Stay
     } else {
       UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
     }

     UpdateForm.ptvis046.className="Mandatory";  //Admitting Point
  } else {
     document.UpdateForm.admitbox.value="0";
     UpdateForm.ptmis011.className="";  //admission type
     UpdateForm.ptmis009.className="";  //admission source
     UpdateForm.ptvis041.className="";  //criteria for admission
     UpdateForm.ptmis012.className="";  //care type
     UpdateForm.ptmis068.className="";  //ward

     if (UpdateForm.ptmis007.className=="OECRequired Mandatory") {
       UpdateForm.ptmis007.className="OECRequired";  //Admitting Doctor
     } else {
       UpdateForm.ptmis007.className="";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="OECRequired Mandatory") {
       UpdateForm.doctnam2.className="OECRequired";  //Admitting Doctor Desc
     } else {
       UpdateForm.doctnam2.className="";  //Admitting Doctor Desc
     }

     UpdateForm.ptmis024.className="";  //Unit

     if (UpdateForm.ptmis027.className=="OECRequired Mandatory") {
       UpdateForm.ptmis027.className="OECRequired";  //Claim Type
     } else {
       UpdateForm.ptmis027.className="";  //Claim Type
     }

     UpdateForm.ptmis010.className="";  //CMBS Class

     if (UpdateForm.ptvis043.className=="OECRequired Mandatory") {
       UpdateForm.ptvis043.className="OECRequired";  //Intended Stay
     } else {
       UpdateForm.ptvis043.className="";  //Intended Stay
     }

     UpdateForm.ptvis046.className="";  //Admitting Point
  }
}
function valClaimCode() {
  if (document.UpdateForm.newbornf.value !=1) {
    validateCode(41,UpdateForm.urnumber,UpdateForm.claimc);
    for (var i =0 ; i < document.UpdateForm.ptmis027.length; i++) {
  //    alert(UpdateForm.ptmis027.options[i].value.substr(0,3));
      if (document.UpdateForm.claimc.value==
          trim(document.UpdateForm.ptmis027.options[i].value.substr(0,3))){
            document.UpdateForm.ptmis027.selectedIndex=i;
      }
    }
  }
}
function portalADM() {
  if(document.getElementById("ptcnepis").value=="1") {  // Episoft ptcnepis
    OnlinePreadmission();
    eAdmPreList();
  } else {
    OnlinePreadmissionA();
  }
}
function OnlinePreadmissionA() {
  if (isWhitespace(document.UpdateForm.admisnid.value)){
    return;
  }
  AdmissionID=GetCookieData("AdmissionID")
  if (!isWhitespace(AdmissionID)&&AdmissionID!="unknown") {
    document.getElementById('admiscki').value=AdmissionID;
    DefaultOnlineAdm(AdmissionID);
    UpdateForm.ptmis054.value=AdmissionID;
//    UpdateProcessedA(AdmissionID)
    var el=document.getElementById("ptmis027");
    var checkInd=el.options[el.selectedIndex].value.substr(3,5);
    if (checkInd.search(/W/g) >= 0) return;
    if (checkInd.search(/M/g) >= 0) return;
    SetCookie("AdmissionID","")
  }
}
//function UpdateProcessedA(AdmissionID) {
//  UpdateForm.ptmis054.value=AdmissionID; /* User UK GP Fund Holder Field to Store */
//  theURL="preadm01.php"+
//         "?reportno=3" +
//         "&status=3" +
//         "&admissionid="+AdmissionID +
//         "&urnumber="+PatientURN;
//  xmlHttp = createHttpObject();
//  xmlHttp.open("GET", theURL, false);
//  xmlHttp.send();
//  if (!isWhitespace(xmlHttp.responseText)) {
//    alert(xmlHttp.responseText)
//  }
//}
function CheckPastDate(admissionDate){

  today = new Date();
  admDate = new Date(admissionDate);

  if((admDate<today) && (admDate.toDateString()!=today.toDateString())){
      alert("Warning: Admission Date is in the past");
  }
}
function DateEdits() {
  if (!checkDate(document.UpdateForm.ptmis001,"Admission Date")) {
    return;
  }

  CheckPastDate(document.UpdateForm.ptmis001.value);
  validateMbsCode(4,
                  document.UpdateForm.ptmis026,
                  document.UpdateForm.mbsdesc1,
                  document.UpdateForm.ptmis001);
}
function chkeAdmCanceButton() {
  if(document.getElementById("ptcnepis").value == "1") {  // Episoft ptcnepis
    chkeAdmCancel();
  } else {
    PatientLinkTo('patweb98.pbl',1,1,0);
  }
}
// eAdmission change of health fund
function findHFunddesc() {
  if (!isWhitespace(document.UpdateForm.admisnid.value)) {
     if (document.UpdateForm.ptmis013.value !=
                  document.UpdateForm.d_ptmis013.value ) {
        if (!isWhitespace(document.UpdateForm.ptmis013.value)) {
            if (!validateCode(16,document.UpdateForm.ptmis013,document.UpdateForm.funddesc)) {
                document.UpdateForm.ptmis013.value="";
                document.UpdateForm.funddesc.value="";
            }
            if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,UpdateForm.funddesc,UpdateForm.tabldesc)) {
                document.UpdateForm.ptmis014.value="";
                document.UpdateForm.tabldesc.value="";
            }
        } else {
          document.UpdateForm.ptmis013.value="";
          document.UpdateForm.funddesc.value="";
          document.UpdateForm.ptmis014.value="";
          document.UpdateForm.tabldesc.value="";
       }
     }
  }
}
</script>
</head>
<body onload="PageLoad(event);DisplayTrnSrc();valClaimCode();
 setTimeout('portalADM()',700);document.UpdateForm.ptmis001.focus();
 displayRegime();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.03.003";
PatientVIS="%PATWEB89.03.081";
PatientNAM="%PATWEB89.03.002";
PatientSTA="%PATWEB89.03.086.078";
PatientALT="%PATWEB89.03.084";
PatientSEX="%PATWEB89.03.019";
PatientDOB="%PATWEB89.03.020";
PatientAGE="%PATWEB89.03.021";
PatientLOC="%PATWEB89.03.083";
PatientPRI="%PATWEB89.03.086.066.1";
PatientUNT="%PATWEB89.03.066.0";
DoctorCOD="%PATWEB89.03.082.003";
DoctorNAM="%PATWEB89.03.082.002";
PatientAID="%PATWEB89.03.086.090";
PatientIND="%PATWEB89.03.086.091";
PatientCUR="%PATWEB89.03.086.092";
PatientCLC="%PATWEB89.03.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.03.086.094";
PatientCDM="%PATWEB89.03.086.095";
PatientVDH="%PATWEB89.03.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form name=linkForm id=linkForm action=patweb89.pbl method=post
 style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.081">
</form>

<form name=UpdateForm id=UpdateForm method=post action=patweb89.pbl
 style="margin:0">
<input type=hidden name=urnumber id=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno id=admissno value="%PATWEB89.03.081">
<input type=hidden name=reportno id=reportno value=2>
<input type=hidden name=template id=template value="001">
<input type="hidden" name="updatety" id="updatety" value="1">
<input type="hidden" name="redirect" id="redirect">
<input type=hidden name=ptmis054 id=ptmis054 value="">
<input type="hidden" name="allocate" id="allocate" value="1">
<input type="hidden" name="chckname" id="chckname" value="0">
<input type="hidden" name="emradmit" id="emradmit" value="0">
<input type="hidden" name="emradmis" id="emradmis" value="0">
<input type="hidden" name="admitnow" id="admitnow" value="1">
<input type="hidden" name="newbmand" id="newbmand" value="0">
<input type="hidden" name="agebmand" id="agebmand" value="0">
<input type=hidden name=ptmas046 id=ptmas046 value="0">
<input type="hidden" name="mvmedrec" id="mvmedrec">
<input type="hidden" name="cfinan" id="cfinan" value="%PATWEB89.03.932">
<input type="hidden" name="claimc" id="claimc">
<input type="hidden" name="exstward" id="exstward" value="%PATWEB89.03.449.1">
<input type="hidden" name="ptvis109" id="ptvis109">
<input type="hidden" name="dummy" id="dummy">
<input type="hidden" name="patsurnm" id="patsurnm"
       title="Patient Surname" value="%PATWEB89.03.009">
<input type="hidden" name="patgivnm" id="patgivnm"
       title="Patient Given Name" value="%PATWEB89.03.010">
<input type="hidden" name="patntdob" id="patntdob"
       title="Patient Date of Birth" value="%PATWEB89.03.020">
<input type="hidden" name="medicrdn" id="medicrdn"
       title="Medicare Card Number" value="%PATWEB89.03.027">
<input type="hidden" name="medicrdr" id="medicrdr"
       title="Medicare Card Reference Number" value="%PATWEB89.03.649">
<input type=hidden name=admisnid id=admisnid value="%PATWEB89.03.999.036">
<input type=hidden name=svhaonpr id=svhaonpr value="1">
<input type=hidden name=admiscki id=admiscki value="            ">
<input type="hidden" name="contmult" value="1">
<input type="hidden" name="leavhosp" id=leavhosp>
<input type="hidden" name="leavadmn" id=leavadmn>
<input type="hidden" name="leavtype" id=leavtype>
<input type="hidden" name="newbornf" id=newbornf value="%PATWEB89.03.941">
<input type=hidden name=datefrom id=datefrom>
<input type=hidden name=dateto id=dateto>
<input type=hidden name=ptcndigp id=ptcndigp
 value="%STANDARD.01.025.124.122.0.1">
<input type="hidden" name="ptcnepis" id="ptcnepis"
 value="%STANDARD.01.025.119.182.0.1" />
<input type="hidden" name="showflag" value="0" />
<input type=hidden name=ptpra001 value=""
                                     title="Person Responsible for Account" />
<input type=hidden name=ptpra002 value=""
                                     title="PRFA Address" />
<input type=hidden name=ptpra004 value=""
                                     title="PRFA Suburb" />
<input type=hidden name=state    value=""
                                     title="PRFA State" />
<input type=hidden name=ptpra006 value=""
                                     title="PRFA Post code" />
<input type=hidden name=ptpra007 value=""
                                     title="PRFA Home Phone" />
<input type=hidden name=ptpra008 value=""
                                     title="PRFA Work Phone" />
<input type=hidden name=ptpra009 value=""
                                     title="PRFA Relationship" />
<input type=hidden name=ptpra010 value=""
                                     title="PRFA Mobile" />
<input type=hidden name=d_ptmis013 value="%PATWEB89.03.040.0">

<table border=0 colspan=0 width=100% cellspacing=0 cellpadding=0 >
<tr><td class=HeadingCell align=center>
    Patient Pre-Admission Details (New) </tr>
<tr>
<tr><td>
    <table width=100%  border=0 class=TableBody cellpadding=0 cellspacing=0>
     <tr><td>&nbsp;</td><td>&nbsp;</td>
         <td align=left><b>Admit Now?</b></td>
        <td align=left>
        <input type="checkbox" name="admitbox" id="admitbox" value="0" notab
         onclick='AdmitMandatory();'>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <b>Patient OEC Consent</b>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <input type="checkbox" name="oecchbox" id="oecchbox" value="0" notab
         onclick='ShowOECFields();OECRequired();'>
        </td></tr>

     <tr><td class=DataLabel>Admission Date </td>
         <td><input type=text size=12 name=ptmis001 id=ptmis001 tabindex=1 
              class="Mandatory Date" title="Admission Date"
              value="%STANDARD.01.015"
              onblur="DateEdits();">
             <img notab src="../images/DateLookup.gif" class=Icon
              onclick="DateLookupFrame(UpdateForm.ptmis001);">     
          Time 
       <input class=Mandatory type=text name=ptmis002 id=ptmis002 size=8 tabindex=2
          value="%STANDARD.01.016" title="Admission Time">
        <img notab src="../images/DateTimeStamp.gif" class=Icon 
         onclick="SetCurrentDateTime(null,UpdateForm.ptmis002);">
       <img notab src="../images/TimeLookup.gif" class=Icon
        onclick="TimeLookupFrame(UpdateForm.ptmis002);">
          </td>

       <td>Admitting Point</td>
         <td><select name=ptvis046 id=ptvis046 tabindex=12 title="Admitting Point"
                     onchange="defaultWard()">
           <option></option>
            %PATWEB89.03.290.5
         </select></td></tr>

      <tr><td class=DataLabel>%STANDARD.01.017.P </td>
          <td><select name=ptmis011 id=ptmis011 tabindex=3  
               title="%STANDARD.01.017.P ">
              <option> </option>
                 %PATWEB89.03.112.5
              </select></td>
       <td class=DataLabel>Ward / Bed </td>
         <td><input type=hidden name=bedstat1 id=bedstat1>
           <input type=hidden name=ptmis004 id=ptmis004>
           <input type=hidden name=ptmis005 id=ptmis005 title="Bed">
           <input type=hidden name=warddesc id=warddesc>
           <select name=ptmis068 id=ptmis068 tabindex=13 title="Ward">
            <option> </option>
            %PATWEB89.03.449.2
           </select>
           <input type=text name=ptmis076 id=ptmis076 readonly maxlength=3 size=3
                  title="Bed">
           <img notab src="../images/SearchIcon.gif" class=Icon
            onclick="WardBedSearchFrame(UpdateForm.ptmis068,
                                        UpdateForm.warddesc,
                                        UpdateForm.ptmis076,
                                        UpdateForm.bedstat1);">
          </td></tr>
          <tr><td class=DataLabel>Admission Source</td>
          <td><select name=ptmis009 id=ptmis009 tabindex=4 
               onchange="DisplayTrnSrc()" title="Admission Source">
               <option> </option>
               %PATWEB89.03.110.5
               </select></td>
          <td class=DataLabel>Admitting Doctor</td>
          <td><input type="text" size=8 maxlength=6 name="ptmis007" 
              id="ptmis007" value="%PATWEB89.03.108.003"
              tabindex=13 title="Admitting Doctor"
              onblur="UpCase(this);valDoctorUnit();">
              <input type=text readonly size=25 notab name=doctnam2 id=doctnam2
               title="Admitting Doctor" value="%PATWEB89.03.108.002">
              <img notab src="../images/SearchIcon.gif" class=Icon
             onclick="DoctorSearchFrame(UpdateForm.ptmis007,UpdateForm.doctnam2)">
          </td></tr>

          <tr><td>
          <div id=TranSrcHeading></div>
          <td><div id=TranSrc></div></td>
          <td class=DataLabel>Unit</td>
          <td><select name=ptmis024 id=ptmis024 tabindex=14
               title="Unit">
              <option> </option>
                 %PATWEB89.03.124.2
              </select>    
          </td></tr>
         <tr><td align=left>Bed Days at Previous Hospital</td>
         <td align=left>
           <input type=text name=ptmis031 id=ptmis031
            title='Bed Days at Previous Hospital'
            class=Integer size=5 maxlength=4 tabindex=6
            onblur="checkInteger(this,this.title)">
         </td>
          <td class=DataLabel>Diagnosis </td>
          <td><input tabindex=15 type=text name="ptmis020" id="ptmis020" 
               size=50 title="Diagnosis" maxlength=80
               value="%PATWEB89.03.121">
          </td></tr>

     <tr><td class=DataLabel>Mode of Arrival</td>
       <td>
         <select name=ptvis054 id=ptvis054 tabindex=7 title="Mode of Arrival">
         <option></option>
          %PATWEB89.03.257.4
         </select>
       </td>
      <td class=DataLabel>Provisional DRG</td>
      <td class=DataLabel>
       <input type=text name=ptmis066 id=ptmis066 size=5 maxlength=4 tabindex=16
        value="%PATWEB89.03.140.0" title="Provisional DRG"
        onblur='validateCode(5,UpdateForm.ptmis066,UpdateForm.drgdesc1)'>
       <input type=text notab readonly name=drgdesc1 id=drgdesc1 size=35 
        value="%PATWEB89.03.140.1">
       <img notab src="../images/SearchIcon.gif" class=Icon 
        onclick="DrgSearchFrame(UpdateForm.ptmis066,UpdateForm.drgdesc1)">
       </td></tr>

      <tr><td class=DataLabel>Admission Criteria</td>
          <td>
          <select name=ptvis041 id=ptvis041 tabindex=8
           title="Criteria for Admission">
          <option> </option>
          %PATWEB89.03.244.5
          </select>
          </td>
         <td class=DataLabel> Diet Code </td>
        <td>
           <select name=ptmis028 id=ptmis028 tabindex=17 title="Diet Code">
           <option> </option>
            %PATWEB89.03.127.5
            </select>
         </td></tr>

     <tr><td class=DataLabel>Care Type</td>
          <td><select name=ptmis012 id=ptmis012 tabindex=9 title="Care Type" 
               onchange="displayRegime();">
              <option> </option>
               %PATWEB89.03.113.5
              </select></td>
        <td class=DataLabel>Referring GP</td>
        <td><input type="text" size=10 maxlength=10 name="ptvis028" 
             id="ptvis028" tabindex=18 value="%PATWEB89.03.231.1"
             title="Referring GP"
            onblur="ValidateHCP(18,0,UpdateForm.ptvis028,UpdateForm.doctnam1);">
            <input type="text" size=25 notab readonly name="doctnam1" 
             id="doctnam1" value="%PATWEB89.03.231.0">
            <img src="../images/SearchIcon.gif" class=Icon
           onclick="HCPSearchFrame(UpdateForm.ptvis028,UpdateForm.doctnam1,0);">
      </td></tr>

      <tr><td class=DataLabel> Intended Stay </td>
          <td class=DataLabel>
             <select name=ptvis043 id=ptvis043 tabindex=10 title="Intended Stay">
             <option> </option>
              %PATWEB89.03.246.5
             </select>
        </td>
      <td class=DataLabel>Inform GP</td>
      <td>
        <select name=ptvis022 id=ptvis022 tabindex=19 title="Inform GP">
        <option value="2"></option>
        <option value="0">No</option>
        <option value="1">Yes</option>
        </select>
        </td></tr>

       <tr><td class=DataLabel> Planned Length of Stay</td>
        <td>
        <input type=text size=5 maxlength=5 name=ptmis030 id=ptmis030
         tabindex=10 title='Planned Length of Stay'
         class=Integer onblur="checkInteger(this,this.value);">
        </td>
       <td class=DataLabel>Religious Visit</td>
       <td>
         <select name=ptmis017 id=ptmis017 tabindex=20 title="Religious Visit">
          <option value="2">No</option>
          <option value="1">Yes</option>
         </select>
       </td></tr>

       <tr><td class=DataLabel>Discharge Intention</td>
          <td><select name=ptvis076 id=ptvis076 tabindex=10
               title="Discharge Intention"> 
              <option> </option>
               %PATWEB89.03.292.4
              </select></td>
           <td class=DataLabel>Foundation</td>
           <td><select name=ptmis071 id=ptmis071 tabindex=21 title="Foundation">
               <option value="0">No</option>
               <option value="1">Yes</option>
               </select></td>
       </tr>

       <tr><td class=DataLabel>Palliative Care Status</td>
          <td><select name=ptvis077 id=ptvis077 tabindex=10 
               title="Palliative Care Status"> 
              <option> </option>
               %PATWEB89.03.293.4
              </select></td>
      <td class=DataLabel>Mailing List</td>
      <td>
        <select name=ptmis072 id=ptmis072 tabindex=21 title="Mailing List">
        <option value="0">No</option>
        <option value="1">Yes</option>
        </select>
        </td>
       </tr>

       <tr><td class=DataLabel>Preferred Accommodation</td>
          <td><select name=ptvis093 id=ptvis093 tabindex=11
               title="Preferred Accommodation">
              <option> </option>
               %PATWEB89.03.298.012.5
              </select></td>
           <td class=DataLabel>%STANDARD.01.017.U1</td>
          <td><select name=ptmis037 id=ptmis037 title="%STANDARD.01.017.U1" 
               tabindex=22>
                <option> </option>
                 %PATWEB89.03.133.2
              </select>
           </td>
       </tr>
   <tr><td class="DataLabel">%STANDARD.01.017.PK</td>
       <td><select name=ptvis110 id=ptvis110 tabindex="12"
            title="%STANDARD.01.017.PK">
             <option></option>
               %STANDARD.01.007.PK
            </select></td></tr>

      <tr><td class=DataLabel><div id=RegimeHead1></div></td>
          <td><div id=RegimeCode1></div></td>
        <td class=DataLabel>Program</td>
        <td><input type=text size=8 maxlength=8 name=ptvis099 id=ptvis099
         title="Program" tabindex=22 value="%PATWEB89.03.298.021.1"
          onchange="findPrgmdesc();">
          <select name=prgmcode id=prgmcode Readonly class=readonly tabindex=166
          onchange="savePrgmcode();">
          <option> </option>
           %PATWEB89.03.298.021.2
          </select></td>
       </tr>

       <tr><td class=DataLabel><div id=RegimeHead2></div></td>
           <td><div id=RegimeCode2></div></td>
           <td class=DataLabel>&nbsp;</td>
           <td>&nbsp;</td> 
       </tr>

       <tr><td class=DataLabel><div id=RegimeHead3></div></td>
           <td><div id=RegimeCode3></div></td>
           <td class=DataLabel>&nbsp;</td>
           <td>&nbsp;</td> 

       <tr align=left>
         <td align=center colspan="4">
         <hr>
         </td>
       </tr>

     <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
          <td><select name=ptmis027 id=ptmis027 id=ptmis027
               title="%STANDARD.01.017.CL" 
               tabindex=22>
                <option> </option>
                 %PATWEB89.03.126.9.1.10.2.X
              </select>
           </td>

      <td class=DataLabel>Casepayment</td>
      <td><select name=ptmis075 id=ptmis075 tabindex=27 title="Casepayment">
          <option> </option>
           %PATWEB89.03.197.2
          </select>
        </td></tr>


      <tr><td class=DataLabel>%STANDARD.01.017.A </td>
          <td><select name=ptmis010 id=ptmis010 tabindex=23  
               title="%STANDARD.01.017.A " onchange="DisplayContract();"> 
              <option> </option>
                 %PATWEB89.03.111.5
              </select></td>

       <td class=DataLabel>Casemix Code</td>
       <td class=DataLabel>
        <input type=text name=ptmis073 id=ptmis073 size=10 maxlength=9 
         tabindex=28 value="%PATWEB89.03.198.2" title="Casemix Code"
         onblur='validateCode(35,UpdateForm.ptmis073,UpdateForm.cmixdesc1)'>
        <input type=text notab readonly name=cmixdesc1 id=cmixdesc1 size=35
         value="%PATWEB89.03.198.1">
        <img notab src="../images/SearchIcon.gif" class=Icon
         onclick="CmixSearchFrame(UpdateForm.ptmis073,UpdateForm.cmixdesc1)">
          </td></tr>

   <tr><td class="DataLabel"><div id="ContractHeading"></div></td>
       <td><div id="ContractType"></div></td>
       <td class="DataLabel"><div id="Contrac1Heading"></div></td>
       <td><div id="ContractRole"></div></td></tr>
   <tr><td class="DataLabel"><div id="Contrac2Heading"></div></td>
       <td><div id="ContractId"></div></td></tr>

<tr><td class=DataLabel>Health Fund</td>
        <input type="hidden" name="ptmis013" id="ptmis013"
         value="%PATWEB89.03.040.0" title="Health Fund">
    <td class=DataLabel colspan=2>
        <input type=text size=35 name="funddesc" id="funddesc" maxlength="30"
         title="Health Fund"
         value="%PATWEB89.03.040.1" readonly> Level
        <input type="hidden" name="ptmis014" id="ptmis014"
         value="%PATWEB89.03.041.0">
        <input type="text" size=20 maxlength=30 name="tabldesc" id="tabldesc"
         value="%PATWEB89.03.041.1" readonly>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HealthFundSearchFrameNoFocus(UpdateForm.ptmis013,
                                               UpdateForm.funddesc,
                                               UpdateForm.ptmis014,
                                               UpdateForm.tabldesc);">
        <img src="../images/erase.gif" class=Icon 
         onclick="clrFields(UpdateForm.ptmis013,
                            UpdateForm.funddesc,
                            UpdateForm.ptmis014,
                            UpdateForm.tabldesc);"> 
    </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>

  <tr><td class=DataLabel> Member Number </td>
      <td><input type=text size=20 maxlength=19 name=ptmis015 id=ptmis015 tabindex=24
       title="Member Number" value="%PATWEB89.03.042">
      </td>
        <td align=left>Move Medical Record</td>
        <td align=left>
        <input type="checkbox" name="mvmedre1" id="mvmedre1" value="1" tabindex=30>
        </td></tr>

  <tr><td class=DataLabel>GST Applicable</td>
      <td><select name=ptmis074 id=ptmis074 tabindex=24 title="GST Applicable">
          <option> </option>
           %PATWEB89.03.189.2
          </select>
        </td>
      <td>&nbsp;</td>
      <td>&nbsp;</td></tr>

  <tr><td></td>
      <td></td>
      <td class=DataLabel><div id=PreExistAilHdr></div></td>
      <td><div id=PreExistAilmnt></div></td>
      </tr>

  <tr><td></td>
      <td></td>
      <td class=DataLabel><div id=EmerAdmHdr></div></td>
      <td><div id=EmerAdmssn></div></td>
      </tr>

  <tr><td></td>
      <td align=right><div id=SwiPresIll></div></td>
      <td class=DataLabel><div id=PresIllCodHdr></div></td>
      <td><div id=PresIllCod></div></td>
      </tr>

  <tr><td>&nbsp;</td></tr>

  <tr><td align=center colspan="4"><div id=LongLine></div></td>

  <tr><td align=center colspan="4"><div id=OESServices></div></td>

      <tr align=center>
       <td colspan=4 align=center><br>
       <input tabindex=30 type=button value="Ok" class="button"
        name="admbuttn" id="admbuttn"
        onclick="tempDisable(this,10);
                 checkBedStatus(UpdateForm.ptmis068.value,
                                UpdateForm.ptmis076.value,
                                UpdateForm.ptmis001.value,
                                UpdateForm.ptmis030.value,
                                SubmitAdm);">
       <input tabindex=31 type=button value="Cancel" class="button"
        onclick="chkeAdmCanceButton();">
    </table>
   </td></tr>
  </table>
</form>

<form name=PatientLinks id=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.101">
<input type=hidden name=MenuType value="%PATWEB89.03.088">
</form>
</div>

<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 id=ptmis058 tabindex=19 
         title="Referral Date">
         <img notab src="../images/DateLookup.gif" class=Icon
          onclick="DateLookupFrame(UpdateForm.ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
    <td><input type=text size=12 name=ptmis059 id=ptmis059 tabindex=20 
         title="Consultation Date">
         <img notab src="../images/DateLookup.gif" class=Icon
          onclick="DateLookupFrame(UpdateForm.ptmis059);"></td></tr>
</table>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Admission Weight</td>
    <td><input type=text name=ptmis051 id=ptmis051 size=5 maxlength=4>grams</td></tr>
</table>
</span>

<span id=NewBorn style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
    <td><input type=text name=ptmis041 id=ptmis041 maxlength=3 size=4
         tabindex=21> weeks
    </td></tr>
</table>
</span>


<script type="text/javascript">
MergePsy="%PATWEB89.03.050"
  if(MergePsy=="Yes"){
    document.UpdateForm.ptmas046.value="1"
  }
 if(MergePsy=="No "){
    document.UpdateForm.ptmas046.value="0"
  }
 if ("%PATWEB89.03.903" == "1") {
  alert("Warning: Patient has a Waiting List Procedure");
 }
 if ("%PATWEB89.03.904" == "1") {
  alert("Warning: Patient has a Booking");
 }
 if ("%PATWEB89.03.905" == "1") {
  alert("Warning: Patient is currently admitted");
 }
 if ("%PATWEB89.03.908" == "1") {
  alert("Warning: Patient has a pre-admission record");
 }
  Day=document.UpdateForm.ptmis001.value.substr(0,2).replace(/ /g,"0")
  Dat=document.UpdateForm.ptmis001.value.substr(2)
  document.UpdateForm.ptmis001.value=Day + Dat

var p = document.UpdateForm;
var informGP = "%PATWEB89.03.225.1";               //ptvis022
valInformGP(p.ptvis022,informGP,p.ptcndigp.value);

</script>
<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</span>
<span id=transfersrc style="display:none">
<td><input type="text" size=7 maxlength=5 name=trnsfsrc id=trnsfsrc class=Mandatory
      title="Transfer Source" tabindex=5
      onchange="validateCode(9,UpdateForm.trnsfsrc,UpdateForm.trandesc);">
     <input type=text size=27 name=trandesc id=trandesc notab
      class=Readonly readonly>
     <img src="../images/SearchIcon.gif" class=Icon
      onclick="TransferSourceFrame(UpdateForm.trnsfsrc,UpdateForm.trandesc)"></td>
</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc id=trnsfsrc>
</span>

<span id=preexisthdr style="display:none">
 <b>PEA Indicator</b>
</span>

<span id=emeradmnhdr style="display:none">
 <b>Emergency Admission</b>
</span>

<span id=presillcodhdr style="display:none">
 <b>Presenting Illness Code</b>
</span>

<span id=presillnumhdr style="display:none">
 <b>Presenting Illness Number (MBS)</b>
</span>

<span id=swipresillhdr style="display:none">
 <b>Switch to MBS Presenting Illness Number &nbsp;</b>
</span>

<span id=preexistail style="display:none">
  <select name=ptelg014 id=ptelg014 title="PEA Indicator" class="OECRequired">
  <option value="0">No</option>
  <option value="1">Yes</option>
  </select>
</span>

<span id=emeradmissn style="display:none">
  <select name=ptelg033 id=ptelg033 title="Emergency Admission" class="OECRequired">
  <option value="0">No</option>
  <option value="1">Yes</option>
  </select>
</span>

<span id=presillcod style="display:none">
  <select name=ptvis111 id=ptvis111 title="Presenting Illness" class="OECRequired">
  <option value=" "></option>
   %PATWEB89.03.298.034.2
  </select>
</span>

<span id=swipresill style="display:none">
 <b>Switch to MBS Presenting Illness Number &nbsp;</b>
 <input type="checkbox" name="presilsw" id="presilsw" value="1"
  title="Presenting Illness MBS"
  onclick="switchPresIll();"> &nbsp; &nbsp;
</span>

<span id=presillnum style="display:none">
    <input type=text name=ptmis026 id=ptmis026 size=10 maxlength=9
     title="Presenting Illness Number (MBS)"
     onblur='validateCode(4,
                          UpdateForm.ptmis026,
                          UpdateForm.mbsdesc1,
                          UpdateForm.ptmis001)' class="OECRequired">
    <input type=text notab readonly name=mbsdesc1 id=mbsdesc1 size=35
     class="OECRequired">
    <img notab src="../images/SearchIcon.gif" class=Icon
     onclick="MbsSearchFrame(UpdateForm.ptmis026,
                             UpdateForm.mbsdesc1,
                             UpdateForm.ptmis001)">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.ptmis026,UpdateForm.mbsdesc1);">
</span>

<span id=oesservices style="display:none">
<table border=0 colspan=0 width=70% cellspacing=0 cellpadding=0 >
  <tr><td><b>Date</b></td>
      <td><b>Type</b></td>
                   <td><b>Item / Description</b></td>
                   <td><b>Quantity</b></td></tr>
  <tr><td width=20%>
     <input type=text size=12 name=oes01007 id=oes01007
      class="FutureDate" title="OES Service 1 Date"
      onblur="checkDate(this,this.title);">
     <img notab src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(UpdateForm.oes01007,null);">
     <img notab src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(UpdateForm.oes01007);">
     </td>
     <td width=12%>
    <select name=oes01004 id=oes01004 title="Type"
     onchange="clrFields(UpdateForm.oes01005,UpdateForm.d_oes01005);
               mandatoryItemCode(document.UpdateForm.oes01005,
                                 document.UpdateForm.oes01007,
                                 document.UpdateForm.oes01006);">
     <option value="6">Misc.Item</option>
     <!--<option value="3">MBS Item</option>-->
     </select>
                   </td>
                   <td>
    <input type=text name=oes01005 id=oes01005 title="Item Code" size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes01004,
                              document.UpdateForm.oes01005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes01005);
             mandatoryItemCode(this,document.UpdateForm.oes01007,
                                    document.UpdateForm.oes01006);
             document.UpdateForm.oes01006.value=1;
             justifyRight(document.UpdateForm.oes01006);">
    <input type=text name=d_oes01005 id=d_oes01005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes01004,
                                  document.UpdateForm.oes01005,
                                  document.UpdateForm.d_oes01005);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.oes01005,UpdateForm.d_oes01005);
              mandatoryItemCode(document.UpdateForm.oes01005,
                                document.UpdateForm.oes01007,
                                document.UpdateForm.oes01006);">
    </td>
    <td>
    <input type=text name=oes01006 id=oes01006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
    </td></tr>
  <tr><td>
     <input type=text size=12 name=oes02007 id=oes02007
      class="FutureDate" title="OES Service 2 Date"
      onblur="checkDate(this,this.title);">
     <img notab src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(UpdateForm.oes02007,null);">
     <img notab src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(UpdateForm.oes02007);">
     </td>
    <td width=12%>
    <select name=oes02004 id=oes02004 title="Type"
     onchange="clrFields(UpdateForm.oes02005,UpdateForm.d_oes02005);
               mandatoryItemCode(document.UpdateForm.oes02005,
                                 document.UpdateForm.oes02007,
                                 document.UpdateForm.oes02006);">
     <option value="6">Misc.Item</option>
     <!--<option value="3">MBS Item</option>-->
     </select>
                   </td>
                   <td>
    <input type=text name=oes02005 id=oes02005 title="Item Code" size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes02004,
                              document.UpdateForm.oes02005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes02005);
             mandatoryItemCode(this,document.UpdateForm.oes02007,
                                    document.UpdateForm.oes02006);
             document.UpdateForm.oes02006.value=1;
             justifyRight(document.UpdateForm.oes02006);">
    <input type=text name=d_oes02005 id=d_oes02005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes02004,
                                  document.UpdateForm.oes02005,
                                  document.UpdateForm.d_oes02005);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.oes02005,UpdateForm.d_oes02005);
              mandatoryItemCode(document.UpdateForm.oes02005,
                                document.UpdateForm.oes02007,
                                document.UpdateForm.oes02006);">
    </td>
    <td>
    <input type=text name=oes02006 id=oes02006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
    </td></tr>
  <tr><td>
     <input type=text size=12 name=oes03007 id=oes03007
      class="FutureDate" title="OES Service 3 Date"
      onblur="checkDate(this,this.title);">
     <img notab src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(UpdateForm.oes03007,null);">
     <img notab src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(UpdateForm.oes03007);">
     </td>
    <td width=12%>
    <select name=oes03004 id=oes03004 title="Type"
     onchange="clrFields(UpdateForm.oes03005,UpdateForm.d_oes03005);
               mandatoryItemCode(document.UpdateForm.oes03005,
                                 document.UpdateForm.oes03007,
                                 document.UpdateForm.oes03006);">
     <option value="6">Misc.Item</option>
     <!--<option value="3">MBS Item</option>-->
     </select>
    </td>
    <td>
    <input type=text name=oes03005 id=oes03005 title="Item Code" size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes03004,
                              document.UpdateForm.oes03005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes03005);
             mandatoryItemCode(this,document.UpdateForm.oes03007,
                                    document.UpdateForm.oes03006);
             document.UpdateForm.oes03006.value=1;
             justifyRight(document.UpdateForm.oes03006);">
    <input type=text name=d_oes03005 id=d_oes03005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes03004,
                                  document.UpdateForm.oes03005,
                                  document.UpdateForm.d_oes03005);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.oes03005,UpdateForm.d_oes03005);
              mandatoryItemCode(document.UpdateForm.oes03005,
                                document.UpdateForm.oes03007,
                                document.UpdateForm.oes03006);">
    </td>
    <td>
    <input type=text name=oes03006 id=oes03006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
    </td></tr>
  <tr><td>
     <input type=text size=12 name=oes04007 id=oes04007
      class="FutureDate" title="OES Service 4 Date"
      onblur="checkDate(this,this.title);">
     <img notab src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(UpdateForm.oes04007,null);">
     <img notab src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(UpdateForm.oes04007);">
    </td>
    <td width=12%>
    <select name=oes04004 id=oes04004 title="Type"
     onchange="clrFields(UpdateForm.oes04005,UpdateForm.d_oes04005);
               mandatoryItemCode(document.UpdateForm.oes04005,
                                 document.UpdateForm.oes04007,
                                 document.UpdateForm.oes04006);">
     <option value="6">Misc.Item</option>
     <!--<option value="3">MBS Item</option>-->
     </select>
    </td>
    <td>
    <input type=text name=oes04005 id=oes04005 title="Item Code" size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes04004,
                              document.UpdateForm.oes04005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes04005);
             mandatoryItemCode(this,document.UpdateForm.oes04007,
                                    document.UpdateForm.oes04006);
             document.UpdateForm.oes04006.value=1;
             justifyRight(document.UpdateForm.oes04006);">
    <input type=text name=d_oes04005 id=d_oes04005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes04004,
                                  document.UpdateForm.oes04005,
                                  document.UpdateForm.d_oes04005);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.oes04005,UpdateForm.d_oes04005);
              mandatoryItemCode(document.UpdateForm.oes04005,
                                document.UpdateForm.oes04007,
                                document.UpdateForm.oes04006);">
    </td>
    <td>
    <input type=text name=oes04006 id=oes04006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
    </td></tr>
  <tr><td>
     <input type=text size=12 name=oes05007 id=oes05007
      class="FutureDate" title="OES Service 5 Date"
      onblur="checkDate(this,this.title);">
     <img notab src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(UpdateForm.oes05007,null);">
     <img notab src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(UpdateForm.oes05007);">
    </td>
    <td width=12%>
    <select name=oes05004 id=oes05004 title="Type"
     onchange="clrFields(UpdateForm.oes05005,UpdateForm.d_oes05005);
               mandatoryItemCode(document.UpdateForm.oes05005,
                                 document.UpdateForm.oes05007,
                                 document.UpdateForm.oes05006);">
     <option value="6">Misc.Item</option>
     <!--<option value="3">MBS Item</option>-->
     </select>
    </td>
    <td>
    <input type=text name=oes05005 id=oes05005 title="Item Code" size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes05004,
                              document.UpdateForm.oes05005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes05005);
             mandatoryItemCode(this,document.UpdateForm.oes05007,
                                    document.UpdateForm.oes05006);
             document.UpdateForm.oes05006.value=1;
             justifyRight(document.UpdateForm.oes05006);">
    <input type=text name=d_oes05005 id=d_oes05005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes05004,
                                  document.UpdateForm.oes05005,
                                  document.UpdateForm.d_oes05005);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.oes05005,UpdateForm.d_oes05005);
              mandatoryItemCode(document.UpdateForm.oes05005,
                                document.UpdateForm.oes05007,
                                document.UpdateForm.oes05006);">
    </td>
    <td>
    <input type=text name=oes05006 id=oes05006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
    </td></tr>
</table>
</span>

<span id=itemtype1misc style="display:none">
    <input type=text name=oes01005 title="Misc.Item 1"
     size=10 maxlength=10
     onblur="validateCode(40,UpdateForm.oes01005,UpdateForm.dummy);">
</span>

<span id=longline style="display:none"><hr></span>
<span id=blanklabel style="display:none">&nbsp;</span>

<span id=regimehd1 style="display:none">Regime Code 1</span>

<span id=regimecod1 style="display:none">
 <input type="text" size=15 maxlength=10 name=ptrgm001 id=ptrgm001 tabindex=136
  onblur="validateCode(75,UpdateForm.ptrgm001,UpdateForm.dummy);">
 <img src="../images/SearchIcon.gif" class=Icon
  onclick="RegimeSearchFrame(UpdateForm.ptrgm001,UpdateForm.dummy);">
 <img src="../images/erase.gif" class=Icon
  onclick="clrFields(UpdateForm.ptrgm001,UpdateForm.dummy);">
</span>

<span id=regimehd2 style="display:none">Regime Code 2</span>

<span id=regimecod2 style="display:none">
 <input type="text" size=15 maxlength=10 name=ptrgm002 id=ptrgm002 tabindex=139
  onblur="validateCode(75,UpdateForm.ptrgm002,UpdateForm.dummy);">
 <img src="../images/SearchIcon.gif" class=Icon
  onclick="RegimeSearchFrame(UpdateForm.ptrgm002,UpdateForm.dummy);">
 <img src="../images/erase.gif" class=Icon
  onclick="clrFields(UpdateForm.ptrgm002,UpdateForm.dummy);">
</span>

<span id=regimehd3 style="display:none">Regime Code 3</span>

<span id=regimecod3 style="display:none">
 <input type="text" size=15 maxlength=10 name=ptrgm003 id=ptrgm003 tabindex=142
  onblur="validateCode(75,UpdateForm.ptrgm003,UpdateForm.dummy);">
 <img src="../images/SearchIcon.gif" class=Icon
  onclick="RegimeSearchFrame(UpdateForm.ptrgm003,UpdateForm.dummy);">
 <img src="../images/erase.gif" class=Icon
  onclick="clrFields(UpdateForm.ptrgm003,UpdateForm.dummy);">
</span>

<span id=regimeblank1 style="display:none">
 <input type=hidden name=ptrgm001 id=ptrgm001 value="">
</span>

<span id=regimeblank2 style="display:none">
 <input type=hidden name=ptrgm002 id=ptrgm002 value="">
</span>

<span id=regimeblank3 style="display:none">
 <input type=hidden name=ptrgm003 id=ptrgm003 value="">
</span>
<span id="contracihd" style="display:none">Contract Id</span>

<span id="contractid" style="display:none">
  <input type="text" size="7" maxlength="5" name="ptasf003" id="ptasf003"
   title="Contract Id" tabindex="50"
   onblur="validateCode(9,UpdateForm.ptasf003,UpdateForm.d_ptasf003);">
  <input type="text" size="27" name="d_ptasf003" id="d_ptasf003" tabindex=-1
   class="Readonly" readonly>
  <img src="../images/SearchIcon.gif" class="Icon" tabindex=-1
   onclick="TransferSourceFrame(UpdateForm.ptasf003,UpdateForm.d_ptasf003);">
</span>

<span id="contracthd" style="display:none">Contract Type</span>

<span id="contracttype" style="display:none">
  <input type="text" name="ptasf001" id="ptasf001" size="2" maxlength="1"
   class="Mandatory" value="%PATWEB89.03.199.001" tabindex="42" title="Contract Type"
   onblur="ContType(this);">
  <img src="../images/SearchIcon.gif" class="Icon" tabindex=-1
   onclick="ContTypeAlert();">
</span>

<span id="contracrhd" style="display:none">Contract Role</span>

<span id="contractrole" style="display:none">
  <input type="text" name="ptasf002" id="ptasf002" size="2" maxlength="1"
   class="Mandatory" value="%PATWEB89.03.199.002" tabindex="51" title="Contract Role"
   onblur="ContRole(this);">
  <img src="../images/SearchIcon.gif" class="Icon" tabindex=-1
   onclick="ContRoleAlert();">
</span>
