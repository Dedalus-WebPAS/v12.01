<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="svmp">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
%START.OF.PAGE
<script type="text/javascript"> 
if ("%STANDARD.01.025.119.182.0.1" == "1") {  // Episoft ptcnepis
  var src="../js/eAdmissionReg.js"
  var script = document.createElement("script");
               script.setAttribute("src", src);
               script.setAttribute("type", "text/javascript");
  document.getElementsByTagName("head")[0].appendChild(script);
}
function validateOECRequired(theForm) {
  for (i=0; i<theForm.elements.length; i++) {
    el=theForm.elements[i]
    if (el.className.match(/OECRequired/)) {
      if (!checkOECString(el,el.title)) {
         return false } }
    }

    if (isWhitespace(document.AddForm.patsurnm.value)) {
      alertOEC(document.AddForm.patsurnm);
      return false;
    }

    if (isWhitespace(document.AddForm.patgivnm.value)) {
      alertOEC(document.AddForm.patgivnm);
      return false;
    }

    if (isWhitespace(document.AddForm.patntdob.value)) {
      alertOEC(document.AddForm.patntdob);
      return false;
    }

  return true;
}
function alertOEC(OECpmifield) {
  alert("Online Eligibility Details Incomplete. Request Not Processed.\n"+
        OECpmifield.title+" is a required OEC PMI field.\n"+
        "Please enter it now.");
}
function checkOECString (theField, s, emptyOK) {
if (checkOECString.arguments.length == 2) emptyOK = false;
 if ((emptyOK == true) && (isEmpty(theField.value))) return true;
 if (isWhitespace(theField.value))
   return warnOECEmpty (theField, s);
 else return true;
}
function warnOECEmpty (theField, s) {
 alert("Online Eligibility Details Incomplete. Request Not Processed.\n"
       + s + " is a required OEC field.\nPlease enter it now." )
 theField.focus()
 return false
}
function mandatoryItemCode(ItemCode,ServiceQuantity) {

  if(!isWhitespace(ItemCode.value)) {
    ServiceQuantity.className="Mandatory Integer";
  } else {
    ServiceQuantity.className="Integer";
  }

}
function switchPresIll() {
  if (document.AddForm.presilsw.checked==true) {
    presentingillnesstitleDIV.innerHTML=presillnumhdr.innerHTML;
    presentingillnessfieldDIV.innerHTML=presillnum.innerHTML;
    validateCode(4,document.AddForm.ptelf017,document.AddForm.mbsdesc1);
  } else {
    presentingillnesstitleDIV.innerHTML=presillcodhdr.innerHTML;
    presentingillnessfieldDIV.innerHTML=presillcod.innerHTML;
  }

}
function ShowOECFields() {
  if (document.AddForm.oecchbox.checked==true) {
    document.AddForm.ffoecind.value="1";
    intendedstaytitleDIV.innerHTML=intendedstaytitleSPAN.innerHTML;
    intendedstayfieldDIV.innerHTML=intendedstayfieldSPAN.innerHTML;
    patientcategorytitleDIV.innerHTML=patientcategorytitleSPAN.innerHTML;
    patientcategoryfieldDIV.innerHTML=patientcategoryfieldSPAN.innerHTML;
    peaindicatortitleDIV.innerHTML=peaindicatortitleSPAN.innerHTML;
    peaindicatorfieldDIV.innerHTML=peaindicatorfieldSPAN.innerHTML;
    emergencyadmissiontitleDIV.innerHTML=emergencyadmissiontitleSPAN.innerHTML;
    emergencyadmissionfieldDIV.innerHTML=emergencyadmissionfieldSPAN.innerHTML;
    presentingillnesstitleDIV.innerHTML=presillcodhdr.innerHTML;
    presentingillnessfieldDIV.innerHTML=presillcod.innerHTML;
    switchpresentingillnessfieldDIV.innerHTML=
    switchpresentingillnessfieldSPAN.innerHTML;
    dvanumbertitleDIV.innerHTML=dvanumbertitleSPAN.innerHTML;
    dvanumberfieldDIV.innerHTML=dvanumberfieldSPAN.innerHTML;
    miscchargecode1titleDIV.innerHTML=miscchargecode1titleSPAN.innerHTML;
    miscchargecode1fieldDIV.innerHTML=miscchargecode1fieldSPAN.innerHTML;
   miscchargecode1quanfieldDIV.innerHTML=miscchargecode1quanfieldSPAN.innerHTML;
    miscchargecode2titleDIV.innerHTML=miscchargecode2titleSPAN.innerHTML;
    miscchargecode2fieldDIV.innerHTML=miscchargecode2fieldSPAN.innerHTML;
   miscchargecode2quanfieldDIV.innerHTML=miscchargecode2quanfieldSPAN.innerHTML;
    miscchargecode3titleDIV.innerHTML=miscchargecode3titleSPAN.innerHTML;
    miscchargecode3fieldDIV.innerHTML=miscchargecode3fieldSPAN.innerHTML;
   miscchargecode3quanfieldDIV.innerHTML=miscchargecode3quanfieldSPAN.innerHTML;
    miscchargecode4titleDIV.innerHTML=miscchargecode4titleSPAN.innerHTML;
    miscchargecode4fieldDIV.innerHTML=miscchargecode4fieldSPAN.innerHTML;
   miscchargecode4quanfieldDIV.innerHTML=miscchargecode4quanfieldSPAN.innerHTML;
    miscchargecode5titleDIV.innerHTML=miscchargecode5titleSPAN.innerHTML;
    miscchargecode5fieldDIV.innerHTML=miscchargecode5fieldSPAN.innerHTML;
   miscchargecode5quanfieldDIV.innerHTML=miscchargecode5quanfieldSPAN.innerHTML;
  }
  else
  {
    document.AddForm.ffoecind.value="";
    intendedstaytitleDIV.innerHTML="";
    intendedstayfieldDIV.innerHTML="";
    patientcategorytitleDIV.innerHTML="";
    patientcategoryfieldDIV.innerHTML="";
    peaindicatortitleDIV.innerHTML="";
    peaindicatorfieldDIV.innerHTML="";
    emergencyadmissiontitleDIV.innerHTML="";
    emergencyadmissionfieldDIV.innerHTML="";
    presentingillnesstitleDIV.innerHTML="";
    presentingillnessfieldDIV.innerHTML="";
    switchpresentingillnessfieldDIV.innerHTML="";
    dvanumbertitleDIV.innerHTML="";
    dvanumberfieldDIV.innerHTML="";
    miscchargecode1titleDIV.innerHTML="";
    miscchargecode1fieldDIV.innerHTML="";
    miscchargecode1quanfieldDIV.innerHTML="";
    miscchargecode2titleDIV.innerHTML="";
    miscchargecode2fieldDIV.innerHTML="";
    miscchargecode2quanfieldDIV.innerHTML="";
    miscchargecode3titleDIV.innerHTML="";
    miscchargecode3fieldDIV.innerHTML="";
    miscchargecode3quanfieldDIV.innerHTML="";
    miscchargecode4titleDIV.innerHTML="";
    miscchargecode4fieldDIV.innerHTML="";
    miscchargecode4quanfieldDIV.innerHTML="";
    miscchargecode5titleDIV.innerHTML="";
    miscchargecode5fieldDIV.innerHTML="";
    miscchargecode5quanfieldDIV.innerHTML="";
  }
}
function OECRequired() {
  if(document.AddForm.oecchbox.checked == true) {
     if (AddForm.bkrec004.className=="Mandatory") {
       AddForm.bkrec004.className="OECRequired Mandatory";
     } else {
       AddForm.bkrec004.className="OECRequired";
     }
     if (AddForm.bkrec005.className=="Mandatory") {
       AddForm.bkrec005.className="OECRequired Mandatory";
     } else {
       AddForm.bkrec005.className="OECRequired";
     }
     if (AddForm.bkrec023.className=="Mandatory") {
       AddForm.bkrec023.className="OECRequired Mandatory";
     } else {
       AddForm.bkrec023.className="OECRequired";
     }
     if (AddForm.bkrec033.className=="Mandatory") {
       AddForm.bkrec033.className="OECRequired Mandatory";
     } else {
       AddForm.bkrec033.className="OECRequired";
     }
     if (AddForm.bkrec035.className=="Mandatory") {
       AddForm.bkrec035.className="OECRequired Mandatory";
     } else {
       AddForm.bkrec035.className="OECRequired";
     }
     if (AddForm.bkrec036.className=="Mandatory") {
       AddForm.bkrec036.className="OECRequired Mandatory";
     } else {
       AddForm.bkrec036.className="OECRequired";
     }
  }
  else
  {
     if (AddForm.bkrec004.className=="OECRequired Mandatory") {
       AddForm.bkrec004.className="Mandatory";
     } else {
       AddForm.bkrec004.className="";
     }
     if (AddForm.bkrec005.className=="OECRequired Mandatory") {
       AddForm.bkrec005.className="Mandatory";
     } else {
       AddForm.bkrec005.className="";
     }
     if (AddForm.bkrec023.className=="OECRequired Mandatory") {
       AddForm.bkrec023.className="Mandatory";
     } else {
       AddForm.bkrec023.className="";
     }
     if (AddForm.bkrec033.className=="OECRequired Mandatory") {
       AddForm.bkrec033.className="Mandatory";
     } else {
       AddForm.bkrec033.className="";
     }
     if (AddForm.bkrec035.className=="OECRequired Mandatory") {
       AddForm.bkrec035.className="Mandatory";
     } else {
       AddForm.bkrec035.className="";
     }
     if (AddForm.bkrec036.className=="OECRequired Mandatory") {
       AddForm.bkrec036.className="Mandatory";
     } else {
       AddForm.bkrec036.className="";
     }
  }
}
function checkMaxPat() {
  var serverURL="../cgi-bin/patweb96.pbl?reportno=12&remoteno=7" +
                "&wardcode="+AddForm.bkrec015.value.replace(/ /g,"+") +
                "&admisdte="+AddForm.bkrec004.value.replace(/ /g,"+");

  var returnValue=RSExecute(serverURL);
  if (returnValue.status==0) {
    if (returnValue.return_value==1) {
      alert("Warning: Maximum number of Patients exceeded.");
    }
  }

  return;
}
function defaultWard() {
    j=document.AddForm.bkrec008.value.substr(14,3);
    if (j.replace(/ /g,"") !="") {
      document.AddForm.bkrec015.selectedIndex=0;
      for (var i =0 ; i < document.AddForm.bkrec015.length; i++) {
        if (document.AddForm.bkrec015.options[i].value==
            document.AddForm.bkrec008.value.substr(14,3)) {
          document.AddForm.bkrec015.selectedIndex=i;
        }
      }
    }
} // end defaultWard
function checkBedManagement() {
  admissno=PatientLinks.admissno.value.replace(/ /g,"+")
  prnxindi="0";

  if (isWhitespace(document.AddForm.bkrec015.value)) {
    if (document.getElementById("ptcnepis").value=="1") { // Episoft ptcnepis
      if (document.AddForm.admisnid != undefined ) {
         if (!isWhitespace(AddForm.admisnid.value)) {
            eAdmCookie=GetContentCookie("eAdmission");
            if (eAdmCookie!="unknown") {
               ExpireCookiePath("eAdmission");
               document.AddForm.nextpage.value="6";
               document.AddForm.redirect.value=eAdmCookie;
            }
         }
      }
    }
    document.AddForm.submit();
    return;
  }

  if (isWhitespace(document.AddForm.bkrec018.value)) {
    if (document.getElementById("ptcnepis").value=="1") { // Episoft ptcnepis
      if (document.AddForm.admisnid != undefined ) {
         if (!isWhitespace(AddForm.admisnid.value)) {
            eAdmCookie=GetContentCookie("eAdmission");
            if (eAdmCookie!="unknown") {
               ExpireCookiePath("eAdmission"); }
            document.AddForm.nextpage.value="6";
            document.AddForm.redirect.value=eAdmCookie;
         }
      }
    }
    document.AddForm.submit();
    return;
  }

  if (AddForm.pswdindc.value==0) {
    var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=5" +
                    "&wardcode="+AddForm.bkrec015.value.replace(/ /g,"+") +
                    "&beddcode="+AddForm.bkrec018.value.replace(/ /g,"+") +
                    "&admissno="+admissno.replace(/ /g,"+") +
                    "&admisdte="+AddForm.bkrec004.value.replace(/ /g,"+") +
//                    "&staydays="+AddForm.bkrec033.value.replace(/ /g,"+") +
                    "&admistme="+AddForm.bkrec005.value.replace(/ /g,"+") +
                    "&ptrgm001="+AddForm.ptrgm001.value.replace(/ /g,"+") +
                    "&ptrgm002="+AddForm.ptrgm002.value.replace(/ /g,"+") +
                    "&ptrgm003="+AddForm.ptrgm003.value.replace(/ /g,"+") +
                    "&prnxindi="+prnxindi.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      if (returnValue.return_value==1) {
        if (!confirm("Warning: Pre-Adm/Admission will override a previous bed managment record.")) {
          return;
        }
      }
      prevretval=returnValue.return_value;
      prnxindi="1";
      var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=5" +
                      "&wardcode="+AddForm.bkrec015.value.replace(/ /g,"+") +
                      "&beddcode="+AddForm.bkrec018.value.replace(/ /g,"+") +
                      "&admissno="+admissno.replace(/ /g,"+") +
                      "&admisdte="+AddForm.bkrec004.value.replace(/ /g,"+") +
//                      "&staydays="+AddForm.bkrec033.value.replace(/ /g,"+") +
                      "&admistme="+AddForm.bkrec005.value.replace(/ /g,"+") +
                      "&ptrgm001="+AddForm.ptrgm001.value.replace(/ /g,"+") +
                      "&ptrgm002="+AddForm.ptrgm002.value.replace(/ /g,"+") +
                      "&ptrgm003="+AddForm.ptrgm003.value.replace(/ /g,"+") +
                      "&prnxindi="+prnxindi.replace(/ /g,"+")
      var returnValue = RSExecute(serverURL);
      if (returnValue.status==0) {
        if (returnValue.return_value==1) {
          if (!confirm("Warning: Pre-Adm/Adm will override a following bed managment record.")) {
            return;
          }
        }

        if (prevretval==1 || returnValue.return_value==1) {
          AddForm.pswdindc.value="1";
          PasswordHead.innerHTML=passwordhd.innerHTML;
          PasswordCode.innerHTML=passwordcd.innerHTML;
          UserNameHead.innerHTML=usernamehd.innerHTML;
          UserNameCode.innerHTML=usernamcd.innerHTML;
          return;
        }
        checkMaxPat();
        if (document.getElementById("ptcnepis").value=="1") { // Episoft ptcnepis
          if (document.AddForm.admisnid != undefined ) {
             if (!isWhitespace(AddForm.admisnid.value)) {
                eAdmCookie=GetContentCookie("eAdmission");
                if (eAdmCookie!="unknown") {
                   ExpireCookiePath("eAdmission"); }
                document.AddForm.nextpage.value="6";
                document.AddForm.redirect.value=eAdmCookie;
             }
           }
        }
        document.AddForm.submit();
        return;
      }
    }
  } else {
    checkMaxPat();
    if (document.getElementById("ptcnepis").value=="1") { // Episoft ptcnepis
      if (document.AddForm.admisnid != undefined ) {
         if (!isWhitespace(AddForm.admisnid.value)) {
            eAdmCookie=GetContentCookie("eAdmission");
            if (eAdmCookie!="unknown") {
               ExpireCookiePath("eAdmission"); }
            document.AddForm.nextpage.value="6";
            document.AddForm.redirect.value=eAdmCookie;
         }
      }
    }
    document.AddForm.submit();
    return;
  }
}


function displayRegime() {
    x=document.AddForm.bkrec008.value.substring(3,4);
    if(x=="O") {
      RegimeHead1.innerHTML=regimehd1.innerHTML;
      RegimeCode1.innerHTML=regimecod1.innerHTML;
      RegimeHead2.innerHTML=regimehd2.innerHTML;
      RegimeCode2.innerHTML=regimecod2.innerHTML;
      RegimeHead3.innerHTML=regimehd3.innerHTML;
      RegimeCode3.innerHTML=regimecod3.innerHTML;
    if (isWhitespace(AddForm.ptrgm001.value)) AddForm.ptrgm001.value="";
    if (isWhitespace(AddForm.ptrgm002.value)) AddForm.ptrgm002.value="";
    if (isWhitespace(AddForm.ptrgm003.value)) AddForm.ptrgm003.value="";
    } else {
      RegimeHead1.innerHTML="";
      RegimeCode1.innerHTML=regimeblank1.innerHTML;
      RegimeHead2.innerHTML="";
      RegimeCode2.innerHTML=regimeblank2.innerHTML;
      RegimeHead3.innerHTML="";
      RegimeCode3.innerHTML=regimeblank3.innerHTML;
    }
}
function CheckBooking() {
    if (AddForm.bkrec008.value.substr(14,3)=="THE") {
     DOCTCODE=AddForm.bkrec002.value;
     LinkUrl="oprweb01.pbl?reportno=2&template=3&doctcode="+DOCTCODE+
             "&admisnid="+AddForm.admisnid.value.replace(/ /g,"+");
     DFrameLink(LinkUrl,0,0,740,390);
    } else {
      displayRegime();
      defaultWard();
    }
  }
function valClaimCode() {
  if (AddForm.bkrec023.value=="") {
  validateCode(41,LinkForm.urnumber,AddForm.claimc);
  for (var i =0 ; i < document.AddForm.bkrec023.length; i++) {
    if (document.AddForm.claimc.value==
        trim(document.AddForm.bkrec023.options[i].value.substr(0,3))){
          document.AddForm.bkrec023.selectedIndex=i;
    }
  } }
}
function submitForm(){
    if (!validateMandatory(document.AddForm)) {
      return;
    }

    if (document.AddForm.oecchbox.checked==true) {
      if (!validateOECRequired(document.AddForm)) {
         return;
      }
      if (!validateParticipant(document.AddForm.ptelf019.value,"OEC")) {
         return;
      }
    }


    p=document.AddForm
    validateSuspension(p.urnumber,p.bkrec004,p.datefrom,p.dateto);
    if(p.datefrom.value!='0'){
         ans=confirm("Warning : Patient has a Suspension record for period \n" +
               "\t" + p.datefrom.value  + " - " + p.dateto.value);
         if (ans!=true) {
            return;
            }
         } 

    var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=6" +
                    "&wardcode="+AddForm.bkrec015.value.replace(/ /g,"+") +
                    "&beddcode="+AddForm.bkrec018.value.replace(/ /g,"+") +
                    "&admisdte="+AddForm.bkrec004.value.replace(/ /g,"+") +
                    "&admistme="+AddForm.bkrec005.value.replace(/ /g,"+")

    var returnValue = RSExecute(serverURL); 
    if (returnValue.status==0) {
      if (returnValue.return_value==1) {
        alert("Selected Bed is closed during this date/time.");
        return;
      }
    }

    checkBedManagement();
}
function valDoctorUnit() {
  validateCode(31,AddForm.bkrec002,AddForm.n_bkrec002);
  selectOptions("30",AddForm.bkrec002,AddForm.bkrec021);
  AddForm.bkrec021.selectedIndex=1;
}
function CheckPastDate(admissionDate){

  today = new Date();
  admDate = new Date(admissionDate);

  if((admDate<today) && (admDate.toDateString()!=today.toDateString())){
      alert("Warning: Admission Date is in the past");
  }
}
function PageInit() {
  setTimeout('portalBook()',700);
}
function portalBook() {
  if(document.getElementById("ptcnepis").value=="1") {  // Episoft ptcnepis
    OnlinePreadmission();
    eAdmPreList();
    setTimeout('CheckBooking();',500)
  }
}
function clrCookieReturn() {
  eAdmCookie=GetContentCookie("eAdmission");
  eRefCookie=GetContentCookie("eReferral");
  if (eAdmCookie!="unknown") {
      ExpireCookiePath("eAdmission");
      getTop().content.location.href=eAdmCookie; }
  else if(eRefCookie!="unknown") {
      ExpireCookiePath("eReferral");
      getTop().content.location.href=eRefCookie; }
  else
  { DFrameExit(); }
}
</script>
</head>
<body onload="PageLoad(event);valClaimCode();displayRegime();defaultWard();
              PageInit();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="clrCookieReturn();">
Booking Details
</span>

<!--<div id=PageBodySection style="overflow: auto;"></div>-->
<form name=LinkForm action=oprweb01.pbl method=get target=content>
<input type=hidden name=reportno value=9>
<input type=hidden name=template value=2>
<input type=hidden name=urnumber value="%WATWEB01.02.003">
<input type=hidden name=sesskeys value="">
<input type=hidden name=wattrkey value="%WATWEB01.02.101">
<input type=hidden name=admisnid id=admisnid value="%WATWEB01.02.360" />
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="%WATWEB01.02.001.patweb98.01.001">
</form>

<form name=AddForm action=oprweb01.pbl method=post style="margin:0" 
 onsubmit="return validateMandatory(this);">
<input type=hidden name=reportno value=7>
<input type=hidden name=template value=4>
<input type=hidden name=setbookf value=1>
<input type=hidden name=updttype value=A>
<input type=hidden name=datefrom>
<input type=hidden name=dateto>
<input type=hidden name=urnumber value="%WATWEB01.02.003">
<input type=hidden name=claimc>
<input type=hidden name=dummy>
<input type=hidden name=bdmnindc value="1">
<input type=hidden name=pswdindc value="0">
<input type=hidden name=ptelf019 value="%WATWEB01.02.040.0">
<input type=hidden name=ptelf020 value="%WATWEB01.02.041.0">
<input type="hidden" name="dobkindc" value="1" />
<input type="hidden" name="ffoecind">
<input type="hidden" name="patsurnm"
       title="Patient Surname" value="%WATWEB01.02.009">
<input type="hidden" name="patgivnm"
       title="Patient Given Name" value="%WATWEB01.02.010">
<input type="hidden" name="patntdob"
       title="Patient Date of Birth" value="%WATWEB01.02.020">
<input type="hidden" name="medicrdn"
       title="Medicare Card Number" value="%WATWEB01.02.027">
<input type="hidden" name="medicrdr"
       title="Medicare Card Reference Number" value="%WATWEB01.02.249">
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden name="admisnid" value="%WATWEB01.02.360" />
<input type="hidden" name="eautoadd" value="eAutoAdd" />
<input type="hidden" name="ptcnepis" id="ptcnepis"
 value="%STANDARD.01.025.119.182.0.1" />
<input type="hidden" name="nextpage" value="" />
<input type="hidden" name="redirect" value="" />

<table border=0 width="95%" cellspacing="0" cellpadding="1" align=center>
<tr><td>&nbsp;</td><td>&nbsp;</td>
        <td colspan=3><b>Free Format Patient OEC Consent</b>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <input type="checkbox" name="oecchbox" value="0" notab
           onclick='ShowOECFields();OECRequired();'>
        </td></tr>
<tr><td class=DataLabel>Booking Type</td>
   <td class=DataField >
   <select name=bkrec008 onchange="CheckBooking();"
    class=Mandatory title="Booking Type">
   <option></option>
    %STANDARD.01.021.BK
   </select></td>
   <td><div id=RegimeHead1></div></td>
   <td><div id=RegimeCode1></div></td>
   </tr>

<tr><td class=DataLabel>Admission Date</td>
    <td class=DataLabel>
    <input type=text name=bkrec004 id=bkrec004 size=12 value="%WATWEB01.02.111"
     class=Mandatory title="Scheduled Admission Date"
     onblur="checkDate(this,this.title);CheckPastDate(this.value);">
    <img src=../images/DateLookup.gif class=Icon date=AddForm.bkrec004>
    Time
    <input type=text name=bkrec005 id=bkrec005 size=6
    class=Mandatory title="Scheduled Admission Time">
    <img src=../images/DateTimeStamp.gif class=Icon date=AddForm.bkrec004
     time=AddForm.bkrec005>
    <img src=../images/TimeLookup.gif class=Icon time=AddForm.bkrec005>
    </td>
    <td><div id=RegimeHead2></div></td>
    <td><div id=RegimeCode2></div></td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.A </td>
    <td class=DataField>
    <select name=bkrec020>
    <option></option>
     %WATWEB01.02.301.A 
    </select></td>
    <td><div id=RegimeHead3></div></td>
    <td><div id=RegimeCode3></div></td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.S </td>
    <td class=DataField>
    <select name=bokrx031>
    <option></option>
     %WATWEB01.02.301.S 
    </select></td>
    <td><div id=UserNameHead></div></td>
    <td><div id=UserNameCode></div></td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.017.ap</td>
    <td class=DataField>
    <select name=bokrx003>
    <option></option>
    %WATWEB01.02.403.2
    </select></td>
    <td><div id=PasswordHead></div></td>
    <td><div id=PasswordCode></div></td>
</tr>

<tr><td class=DataLabel>Expected Ward/Bed</td>
    <td class=DataField><input type=hidden name=bedstat1 id=bedstat1>
                        <input type=hidden name=warddesc id=warddesc>
    <select name=bkrec015 id=bkrec015
    onchange="document.AddForm.bkrec018.value='';">
    <option></option>
     %WATWEB01.02.302
    </select>
    <input type=text name=bkrec018 id=bkrec018 readonly 
           maxlength=3 size=3 title="Bed">
    <img notab src=../images/SearchIcon.gif border=0 class=Icon
     onclick="WardBedSearchFrame(bkrec015,warddesc,bkrec018,bedstat1,bkrec004,bkrec005);">
    </td>

<tr><td class=DataLabel>Consultant</td>
    <td class=DataField colspan=3>
    <input type=text name=bkrec002 id=bkrec002 size=8 maxlength=8
     value="%WATWEB01.02.115.003"
     onblur="UpCase(this);valDoctorUnit();">
    <input type=text name=n_bkrec002 id=n_bkrec002 size=40 readonly notab
     value="%WATWEB01.02.115.002">
    <a href="javascript:DoctorSearchFrame(AddForm.bkrec002,AddForm.n_bkrec002)">
    <img src=../images/SearchIcon.gif class=Icon></a></td></tr>

<tr><td class=DataLabel>Unit</td>
    <td class=DataField>
    <select name=bkrec021>
    <option></option>
     %WATWEB01.02.114.2
    </select>
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField colspan=3>
    <select name=bkrec023>
    <option></option>
    %WATWEB01.02.133.9.1.10.2.X
    </select></td></tr>

<tr><td class=DataLabel>Intended Length of Stay </td>
    <td class=DataLabel>
    <input type=text name=bkrec033 size=4 maxlength=5
     value="%WATWEB01.02.116">(days)</td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CC</td>
    <td><select name=bkrec028 title="%STANDARD.01.017.CC" 
         onchange="">
         <option> </option>
         %WATWEB01.02.301.CC
         </select></td></tr>

<tr><td class=DataLabel>Admitting Diagnosis</td>
   <td class=DataField colspan=3>
   <input type=text size=12 name=bkrec035 value="%WATWEB01.02.103">
   <input type=text name=bkrec036 id=bkrec036 size=70 maxlength=50 
      value="%WATWEB01.02.106">
   <a href="javascript:Icd10DisSearchFrame(AddForm.bkrec035,AddForm.bkrec036);">
   <img src=../images/SearchIcon.gif class=Icon>
   </a></td></tr>

  <tr><td><div id=intendedstaytitleDIV></div></td>
      <td><div id=intendedstayfieldDIV></div></td>
      <td><div id=dvanumbertitleDIV></div></td>
      <td><div id=dvanumberfieldDIV></div></td>
  </tr>
  <tr>
      <td><div id=patientcategorytitleDIV></div></td>
      <td><div id=patientcategoryfieldDIV></div></td>
      <td><div id=peaindicatortitleDIV></div></td>
      <td><div id=peaindicatorfieldDIV></div></td>
  </tr>
  <tr>
      <td><div id=presentingillnesstitleDIV></div></td>
      <td><div id=presentingillnessfieldDIV></div></td>
      <td colspan=2><div id=switchpresentingillnessfieldDIV></div></td>
  </tr>
  <tr>
      <td><div id=emergencyadmissiontitleDIV></div></td>
      <td><div id=emergencyadmissionfieldDIV></div></td>
  </tr>
  <tr>
      <td><div id=miscchargecode1titleDIV></div></td>
      <td colspan=2><div id=miscchargecode1fieldDIV></div></td>
      <td><div id=miscchargecode1quanfieldDIV></div></td>
  </tr>
  <tr>
      <td><div id=miscchargecode2titleDIV></div></td>
      <td colspan=2><div id=miscchargecode2fieldDIV></div></td>
      <td><div id=miscchargecode2quanfieldDIV></div></td>
  </tr>
  <tr>
      <td><div id=miscchargecode3titleDIV></div></td>
      <td colspan=2><div id=miscchargecode3fieldDIV></div></td>
      <td><div id=miscchargecode3quanfieldDIV></div></td>
  </tr>
  <tr>
      <td><div id=miscchargecode4titleDIV></div></td>
      <td colspan=2><div id=miscchargecode4fieldDIV></div></td>
      <td><div id=miscchargecode4quanfieldDIV></div></td>
  </tr>
  <tr>
      <td><div id=miscchargecode5titleDIV></div></td>
      <td colspan=2><div id=miscchargecode5fieldDIV></div></td>
      <td><div id=miscchargecode5quanfieldDIV></div></td>
  </tr>

<tr><td colspan=4 align=center> 
    <input type=button value=Ok class="button" onclick='submitForm();'>
    <input type=button value=Cancel class="button" 
     onclick='clrCookieReturn();'>
    </td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%WATWEB01.02.003">
<input type=hidden name=admissno value="%WATWEB01.02.081">
<input type=hidden name=MenuType value="%WATWEB01.02.088">
<input type=hidden name=casekeys value="%WATWEB01.02.101">
</form>
<script type="text/javascript" >
  ExpireCookiePath("CasePath");
</script>

<span id=regimehd1 style="display:none">
<td class=DataLabel>Regime Code 1</td>
</span>
<span id=regimecod1 style="display:none">
<td><input type="text" size=5 maxlength=10
     name=ptrgm001 id=ptrgm001 tabindex=30 
     onblur=validateCode(75,AddForm.ptrgm001,AddForm.t_ptrgm001);>
     <input type=text name=t_ptrgm001 id=t_ptrgm001 size=15 readonly
      class=Readonly title="Regime Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(ptrgm001,t_ptrgm001);">
    <img src="../images/erase.gif" onclick="clrFields(ptrgm001,t_ptrgm001);" 
         class=Icon>
</td>
</span>

<span id=regimehd2 style="display:none">
<td class=DataLabel>Regime Code 2</td>
</span>
<span id=regimecod2 style="display:none">
<td><input type="text" size=5 maxlength=10
     name=ptrgm002 id=ptrgm002 tabindex=30
     onblur=validateCode(75,AddForm.ptrgm002,AddForm.t_ptrgm002);>
     <input type=text name=t_ptrgm002 id=t_ptrgm002 size=15 readonly
      class=Readonly title="Regime Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(ptrgm002,t_ptrgm002);">
    <img src="../images/erase.gif" onclick="clrFields(ptrgm002,t_ptrgm002);"
         class=Icon>
</td>
</span>

<span id=regimehd3 style="display:none">
<td class=DataLabel>Regime Code 3</td>
</span>
<span id=regimecod3 style="display:none">
<td><input type="text" size=5 maxlength=10
     name=ptrgm003 id=ptrgm003 tabindex=30
     onblur=validateCode(75,AddForm.ptrgm003,AddForm.t_ptrgm003);>
     <input type=text name=t_ptrgm003 id=t_ptrgm003 size=15 readonly
      class=Readonly title="Regime Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(ptrgm003,t_ptrgm003);">
    <img src="../images/erase.gif" onclick="clrFields(ptrgm003,t_ptrgm003);"
         class=Icon>
</td>
</span>

<span id=regimeblank1 style="display:none">
<td><input type=hidden name=ptrgm001 value=""></td>
</span>

<span id=regimeblank2 style="display:none">
<td><input type=hidden name=ptrgm002 value=""></td>
</span>

<span id=regimeblank3 style="display:none">
<td><input type=hidden name=ptrgm003 value=""></td>
</span>


<span id=usernamehd style="display:none">
<td class=DataLabel>User Name</td>
</span>

<span id=usernamcd style="display:none">
<td><input size=12 type=text name=username class=Mandatory title="UserName">
</td>
</span>

<span id=passwordhd style="display:none">
<td class=DataLabel>Password</td>
</span>

<span id=passwordcd style="display:none">
<td><input size=12 type=password name=password onblur=checkPass(); class=Mandatory
     title="Password"></td>
</span>

<span id=intendedstaytitleSPAN style="display:none">
  %STANDARD.01.017.VI
</span>

<span id=intendedstayfieldSPAN style="display:none">
  <select name="ptelf011" title="%STANDARD.01.017.VI" class="OECRequired">
    <option> </option>
    %STANDARD.01.007.VI
  </select>
</span>

<span id=patientcategorytitleSPAN style="display:none">
  %STANDARD.01.017.P
</span>

<span id=patientcategoryfieldSPAN style="display:none">
  <select name="ptelf013" title="%STANDARD.01.017.P " class="OECRequired">
    <option> </option>
    %STANDARD.01.007.P
  </select>
</span>

<span id=peaindicatortitleSPAN style="display:none">
  PEA Indicator
</span>

<span id=peaindicatorfieldSPAN style="display:none">
  <select name=ptelf014 title="PEA Indicator" class="OECRequired">
    <option value=0>No</option>
    <option value=1>Yes</option>
    <option value=2>Query</option>
  </select>
</span>

<span id=emergencyadmissiontitleSPAN style="display:none">
  Emergency Admission
</span>

<span id=emergencyadmissionfieldSPAN style="display:none">
  <select name=ptelf015 title="Emergency Admission" class="OECRequired">
    <option value=0>No</option>
    <option value=1>Yes</option>
  </select>
</span>

<span id=switchpresentingillnessfieldSPAN style="display:none">
  <input type="checkbox" name="presilsw" value="1"
   title="Presenting Illness MBS"
   onclick="switchPresIll();">
  <b>Switch to MBS Presenting Illness Number &nbsp;</b>
</span>

<span id=presillcodhdr style="display:none">
 Presenting Illness Code
</span>

<span id=presillnumhdr style="display:none">
 Presenting Illness Number (MBS)
</span>

<span id=presillcod style="display:none">
  <select name=ptelf016 title="Presenting Illness" class="OECRequired">
  <option value=" "></option>
    %STANDARD.01.007.il
  </select>
<input type=hidden name=ptelf017 value=" ">
</span>

<span id=presillnum style="display:none">
  <input type=text name=ptelf017 size=10 maxlength=9
   onblur='validateCode(4,ptelf017,mbsdesc1)' class="OECRequired"
   title="Presenting Illness">
  <input type=text notab readonly name=mbsdesc1 id=mbsdesc1 size=35 
       class="Readonly">
  <img notab src="../images/SearchIcon.gif" class=Icon
   onclick="MbsSearchFrame(ptelf017,mbsdesc1,currdate)" name=mbsserch 
       id=mbsserch>
  <img src="../images/erase.gif" align=absmiddle
   onclick="clrFields(ptelf017,mbsdesc1);" name=erasembs id=erasembs>
  <input type=hidden name=ptelf016 value=" ">
</span>

<span id=dvanumbertitleSPAN style="display:none">
  DVA Number
</span>

<span id=dvanumberfieldSPAN style="display:none">
  <input type=text name="ptelf033" size=15 maxlength=10
   title="DVA Number">
</span>

<span id=miscchargecode1titleSPAN style="display:none">
  Misc Charge Code 1
</span>

<span id=miscchargecode1fieldSPAN style="display:none">
  <input type=text name=ptelf023 title="Item Code" size=9 maxlength=9
   onBlur="validateMsc1(document.AddForm.ptelf023,
           document.AddForm.bkrec023,
           document.AddForm.ptelf019,
           document.AddForm.ptelf020,
           document.AddForm.d_ptelf023);
   mandatoryItemCode(this,document.AddForm.ptelf028);
           document.AddForm.ptelf028.value=1;
           justifyRight(document.AddForm.ptelf028);">
  <input type=text name=d_ptelf023 id=d_ptelf023 size=50 readonly
   class=Readonly tabindex=-1 title="Item Description">
  <img src="../images/SearchIcon.gif" class=Icon
   onclick="MiscChargeSearchFrame(document.AddForm.ptelf023,
                                  document.AddForm.d_ptelf023);">
  <img src="../images/erase.gif"
   onclick="clrFields(document.AddForm.ptelf023,
                      document.AddForm.d_ptelf023,
                      document.AddForm.ptelf028);
   mandatoryItemCode(document.AddForm.ptelf023,
                     document.AddForm.ptelf028);">
</span>

<span id=miscchargecode1quanfieldSPAN style="display:none">
  No.&nbsp;of&nbsp;Items&nbsp;<input type=text name=ptelf028 title="Quantity" size=5 maxlength=3
   onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
</span>

<span id=miscchargecode2titleSPAN style="display:none">
  Misc Charge Code 2
</span>

<span id=miscchargecode2fieldSPAN style="display:none">
  <input type=text name=ptelf024 title="Item Code" size=9 maxlength=9
   onBlur="validateMsc1(document.AddForm.ptelf024,
           document.AddForm.bkrec023,
           document.AddForm.ptelf019,
           document.AddForm.ptelf020,
           document.AddForm.d_ptelf024);
   mandatoryItemCode(this,document.AddForm.ptelf029);
           document.AddForm.ptelf029.value=1;
           justifyRight(document.AddForm.ptelf029);">
  <input type=text name=d_ptelf024 id=d_ptelf024 size=50 readonly
   class=Readonly tabindex=-1 title="Item Description">
  <img src="../images/SearchIcon.gif" class=Icon
   onclick="MiscChargeSearchFrame(document.AddForm.ptelf024,
                                  document.AddForm.d_ptelf024);">
  <img src="../images/erase.gif"
   onclick="clrFields(document.AddForm.ptelf024,
                      document.AddForm.d_ptelf024,
                      document.AddForm.ptelf029);
   mandatoryItemCode(document.AddForm.ptelf024,
                     document.AddForm.ptelf029);">
</span>

<span id=miscchargecode2quanfieldSPAN style="display:none">
  No.&nbsp;of&nbsp;Items&nbsp;<input type=text name=ptelf029 title="Quantity" size=5 maxlength=3
   onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
</span>

<span id=miscchargecode3titleSPAN style="display:none">
  Misc Charge Code 3
</span>

<span id=miscchargecode3fieldSPAN style="display:none">
  <input type=text name=ptelf025 title="Item Code" size=9 maxlength=9
   onBlur="validateMsc1(document.AddForm.ptelf025,
           document.AddForm.bkrec023,
           document.AddForm.ptelf019,
           document.AddForm.ptelf020,
           document.AddForm.d_ptelf025);
   mandatoryItemCode(this,document.AddForm.ptelf030);
           document.AddForm.ptelf030.value=1;
           justifyRight(document.AddForm.ptelf030);">
  <input type=text name=d_ptelf025 id=d_ptelf025 size=50 readonly
   class=Readonly tabindex=-1 title="Item Description">
  <img src="../images/SearchIcon.gif" class=Icon
   onclick="MiscChargeSearchFrame(document.AddForm.ptelf025,
                                  document.AddForm.d_ptelf025);">
  <img src="../images/erase.gif"
   onclick="clrFields(document.AddForm.ptelf025,
                      document.AddForm.d_ptelf025,
                      document.AddForm.ptelf030);
   mandatoryItemCode(document.AddForm.ptelf025,
                     document.AddForm.ptelf030);">
</span>

<span id=miscchargecode3quanfieldSPAN style="display:none">
  No.&nbsp;of&nbsp;Items&nbsp;<input type=text name=ptelf030 title="Quantity" size=5 maxlength=3
   onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
</span>

<span id=miscchargecode4titleSPAN style="display:none">
  Misc Charge Code 4
</span>

<span id=miscchargecode4fieldSPAN style="display:none">
  <input type=text name=ptelf026 title="Item Code" size=9 maxlength=9
   onBlur="validateMsc1(document.AddForm.ptelf026,
           document.AddForm.bkrec023,
           document.AddForm.ptelf019,
           document.AddForm.ptelf020,
           document.AddForm.d_ptelf026);
   mandatoryItemCode(this,document.AddForm.ptelf031);
           document.AddForm.ptelf031.value=1;
           justifyRight(document.AddForm.ptelf031);">
  <input type=text name=d_ptelf026 id=d_ptelf026 size=50 readonly
   class=Readonly tabindex=-1 title="Item Description">
  <img src="../images/SearchIcon.gif" class=Icon
   onclick="MiscChargeSearchFrame(document.AddForm.ptelf026,
                                  document.AddForm.d_ptelf026);">
  <img src="../images/erase.gif"
   onclick="clrFields(document.AddForm.ptelf026,
                      document.AddForm.d_ptelf026,
                      document.AddForm.ptelf031);
   mandatoryItemCode(document.AddForm.ptelf026,
                     document.AddForm.ptelf031);">
</span>

<span id=miscchargecode4quanfieldSPAN style="display:none">
  No.&nbsp;of&nbsp;Items&nbsp;<input type=text name=ptelf031 title="Quantity" size=5 maxlength=3
   onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
</span>

<span id=miscchargecode5titleSPAN style="display:none">
  Misc Charge Code 5
</span>

<span id=miscchargecode5fieldSPAN style="display:none">
  <input type=text name=ptelf027 title="Item Code" size=9 maxlength=9
   onBlur="validateMsc1(document.AddForm.ptelf027,
           document.AddForm.bkrec023,
           document.AddForm.ptelf019,
           document.AddForm.ptelf020,
           document.AddForm.d_ptelf027);
   mandatoryItemCode(this,document.AddForm.ptelf032);
           document.AddForm.ptelf032.value=1;
           justifyRight(document.AddForm.ptelf032);">
  <input type=text name=d_ptelf027 id=d_ptelf027 size=50 readonly
   class=Readonly tabindex=-1 title="Item Description">
  <img src="../images/SearchIcon.gif" class=Icon
   onclick="MiscChargeSearchFrame(document.AddForm.ptelf027,
                                  document.AddForm.d_ptelf027);">
  <img src="../images/erase.gif"
   onclick="clrFields(document.AddForm.ptelf027,
                      document.AddForm.d_ptelf027,
                      document.AddForm.ptelf032);
   mandatoryItemCode(document.AddForm.ptelf027,
                     document.AddForm.ptelf032);">
</span>

<span id=miscchargecode5quanfieldSPAN style="display:none">
  No.&nbsp;of&nbsp;Items&nbsp;<input type=text name=ptelf032 title="Quantity" size=5 maxlength=3
   onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
</span>
