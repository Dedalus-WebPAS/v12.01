<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="sjog-nsw">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/preadmission.js"></script>
<script type="text/javascript" src="../js/OECpreadmission.js"></script>
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function switchPresIll() {
  if (document.UpdateForm.presilsw.checked==true) {


    PresIllCodHdr.innerHTML=presillnumhdr.innerHTML;
    PresIllCod.innerHTML=presillnum.innerHTML;
  } else {
    PresIllCodHdr.innerHTML=presillcodhdr.innerHTML;
    PresIllCod.innerHTML=presillcod.innerHTML;
  }

}
function OECRequired() {
 if(document.UpdateForm.oecchbox.checked == true) {

     if (UpdateForm.ptvis043.className=="Mandatory") {
       UpdateForm.ptvis043.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptvis043.className="OECRequired";  //Intended Stay
     }

     if (UpdateForm.ptmis007.className=="Mandatory") {
       UpdateForm.ptmis007.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis007.className="OECRequired";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="Mandatory") {
       UpdateForm.doctnam2.className="OECRequired Mandatory";
     } else {
       UpdateForm.doctnam2.className="OECRequired";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis020.className=="Mandatory") {
       UpdateForm.ptmis020.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis020.className="OECRequired";  //Diagnosis
     }

     if (UpdateForm.ptmis027.className=="Mandatory") {
       UpdateForm.ptmis027.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis027.className="OECRequired";  //Claim Type
     }

     if (UpdateForm.funddesc.className=="Mandatory") {
       UpdateForm.ptmis013.className="OECRequired Mandatory";  //HF
       UpdateForm.funddesc.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis013.className="OECRequired";  //HF
       UpdateForm.funddesc.className="OECRequired";  //Health Fund Code
     }

     if (UpdateForm.tabldesc.className=="Mandatory") {
       UpdateForm.ptmis014.className="OECRequired Mandatory";  //HF Level
       UpdateForm.tabldesc.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis014.className="OECRequired";            //HF Level
       UpdateForm.tabldesc.className="OECRequired";  //Health Fund Code
     }

     UpdateForm.ptmis030.className="OECRequired Integer";    //Planned Length
     UpdateForm.ptvis076.className="OECRequired";            //Discharge Inten
     UpdateForm.ptmis015.className="OECRequired";            //Member Nunber

  } else {

     if (UpdateForm.ptvis043.className=="OECRequired Mandatory") {
       UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
     } else {
       UpdateForm.ptvis043.className="";  //Intended Stay
     }

     if (UpdateForm.ptmis007.className=="OECRequired Mandatory") {
       UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     } else {
       UpdateForm.ptmis007.className="";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="OECRequired Mandatory") {
       UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor Desc
     } else {
       UpdateForm.doctnam2.className="";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis020.className=="OECRequired Mandatory") {
       UpdateForm.ptmis020.className="Mandatory";  //Diagnosis
     } else {
       UpdateForm.ptmis020.className="";  //Diagnosis
     }

     if (UpdateForm.ptmis027.className=="OECRequired Mandatory") {
       UpdateForm.ptmis027.className="Mandatory";  //Claim Type
     } else {
       UpdateForm.ptmis027.className="";  //Claim Type
     }

     if (UpdateForm.funddesc.className=="OECRequired Mandatory") {
       UpdateForm.ptmis013.className="Mandatory";  //HF
       UpdateForm.funddesc.className="Mandatory";  //Health Fund
     } else {
       UpdateForm.ptmis013.className="";  //HF
       UpdateForm.funddesc.className="";  //Health Fund
     }

     if (UpdateForm.tabldesc.className=="OECRequired Mandatory") {
       UpdateForm.ptmis014.className="Mandatory";  //HF Level
       UpdateForm.tabldesc.className="Mandatory";  //Health Fund
     } else {
       UpdateForm.ptmis014.className="";  //HF Level
       UpdateForm.tabldesc.className="";  //Health Fund
     }

     UpdateForm.ptmis030.className="Integer";    //Planned Length of Stay
     UpdateForm.ptvis076.className="";           //Discharge Inten
     UpdateForm.ptmis015.className="";           //Member Number

     setHF();
  }
}
function ShowOESmbs() {
  if(document.UpdateForm.showmbsc.checked == true) {
    OESMBSitems.innerHTML=oesmbsitems.innerHTML;
  } else {
    OESMBSitems.innerHTML=blanklabel.innerHTML;
  }
}
function ShowOECFields() {
  if(document.UpdateForm.oecchbox.checked == true) {
    PreExistAilHdr.innerHTML=preexisthdr.innerHTML;
    PreExistAilmnt.innerHTML=preexistail.innerHTML;
    EmerAdmHdr.innerHTML=emeradmnhdr.innerHTML;
    EmerAdmssn.innerHTML=emeradmissn.innerHTML;
    PresIllCodHdr.innerHTML=presillcodhdr.innerHTML;
    PresIllCod.innerHTML=presillcod.innerHTML;
    SwiPresIll.innerHTML=swipresill.innerHTML;
    LongLine.innerHTML=longline.innerHTML;
    OESMBSitems.innerHTML=blanklabel.innerHTML;
    OESHeadings.innerHTML=oesheadings.innerHTML;
    OESServices.innerHTML=oesservices.innerHTML;
  } else {
    PreExistAilHdr.innerHTML=blanklabel.innerHTML;
    PreExistAilmnt.innerHTML=blanklabel.innerHTML;
    EmerAdmHdr.innerHTML=blanklabel.innerHTML;
    EmerAdmssn.innerHTML=blanklabel.innerHTML;
    PresIllCodHdr.innerHTML=blanklabel.innerHTML;
    PresIllCod.innerHTML=blanklabel.innerHTML;
    SwiPresIll.innerHTML=blanklabel.innerHTML;
    LongLine.innerHTML=blanklabel.innerHTML;
    OESMBSitems.innerHTML=blanklabel.innerHTML;
    OESHeadings.innerHTML=blanklabel.innerHTML;
    OESServices.innerHTML=blanklabel.innerHTML;
  }
}
function displayWardDiet() {
  if (document.UpdateForm.ptcndwdc.value=="1") {
    warddietcodetitleDIV.innerHTML=warddietcodetitleSPAN.innerHTML;
    warddietcodeDIV.innerHTML=warddietcodeSPAN.innerHTML;
    dietcommenttitleDIV.innerHTML=dietcommenttitleSPAN.innerHTML;
    dietcommentfieldDIV.innerHTML=dietcommentfieldSPAN.innerHTML;
  }
}
function SubmitAdm() {
  if(document.UpdateForm.mvmedre1.checked == true) {
     document.UpdateForm.mvmedrec.value="1";
  } else {
     document.UpdateForm.mvmedrec.value="0";
  }
  MandatoryOk=true;
  if  (!validateMandatory(UpdateForm)) {
      return;
  }

  if (document.UpdateForm.admitbox.value==1) {
    dateDiff=parseInt(SetDateYYYYMMDD(document.UpdateForm.ptmis001.value)) -
             parseInt(DemConDate);
    if (checkDemographicsUpdated(dateDiff,NoDayDemVl,ConfDemogs)){
      return;
    }
  }

  if (document.UpdateForm.oecchbox.checked==true) {
    if (!validateOECRequired(document.UpdateForm)) {
       return;
    }
    if (!validateParticipant(document.UpdateForm.ptmis013.value,"OEC")) {
       return;
    }
  }
  if (!isWhitespace(UpdateForm.ptmis013.value)) {
      if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
                          UpdateForm.funddesc,UpdateForm.tabldesc)) {
         ans=confirm("Select another active health fund table? ");
         if (ans==true) {
            return;
         }
      }
  }
  if (UpdateForm.oes01007!=undefined) {

    if (!chkDOS(UpdateForm.oes01007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes02007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes03007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes04007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes05007)) {
      return;
    }
  }

 if (UpdateForm.extrprov!=undefined) {

  if (!isWhitespace(UpdateForm.extrprov.value)) {
    document.UpdateForm.oeceprov.value="1";
  }

  if (!isWhitespace(UpdateForm.extrprv2.value)) {
    document.UpdateForm.oeceprv2.value="1";
  }

  if (!isWhitespace(UpdateForm.extrprv3.value)) {
    document.UpdateForm.oeceprv3.value="1";
  }

  if (!isWhitespace(UpdateForm.extrprv4.value)) {
    document.UpdateForm.oeceprv4.value="1";
  }

  if (!isWhitespace(UpdateForm.extrprv5.value)) {
    document.UpdateForm.oeceprv5.value="1";
  }
 }
  if(document.UpdateForm.oecchbox.checked == true) {
     document.UpdateForm.ptvis109.value="1";
  }

  if (MandatoryOk) {
    setRedirect();
    UpdateForm.ptmis004.value=UpdateForm.ptmis068.value;
    checkPrevPRFA();
    CheckPrevDefDetail();
    SubmitHidden(UpdateForm);
   }
}
function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
  selectOptions("30",UpdateForm.ptmis007,UpdateForm.ptmis024);
 UpdateForm.ptmis024.selectedIndex=1
}
function AdmitMandatory() {
 if(document.UpdateForm.admitbox.checked == true) {
     document.UpdateForm.admitbox.value="1";
     UpdateForm.ptmis011.className="Mandatory";  //admission type
     UpdateForm.ptmis009.className="Mandatory";  //admission source
     UpdateForm.ptmis012.className="Mandatory";  //care type
     UpdateForm.ptmis068.className="Mandatory";  //ward
     UpdateForm.ptmis005.className="mandatory";  //bed
     UpdateForm.ptmis024.className="Mandatory";  //Unit
     UpdateForm.ptmis027.className="Mandatory";  //Financial Class
     UpdateForm.ptmis010.className="Mandatory";  //CMBS Class
     UpdateForm.ptmis064.className="Mandatory";  //Food Allergy

     var className = (UpdateForm.ptcndigp.value >= 3) ? "Mandatory" : "";
     UpdateForm.ptvis022.className = className;  //Inform GP
     if (className == "Mandatory") {
       UpdateForm.ptvis022.options[0].value = " ";
     }

     if (UpdateForm.ptmis007.className=="OECRequired") {
       UpdateForm.ptmis007.className="OECRequired Mandatory";  //Admitting Doc
     } else {
       UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="OECRequired") {
       UpdateForm.doctnam2.className="OECRequired Mandatory";  //Admitting Doc
     } else {
       UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis027.className=="OECRequired") {
       UpdateForm.ptmis027.className="OECRequired Mandatory";  //Admitting Doc
     } else {
       UpdateForm.ptmis027.className="Mandatory";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptvis043.className=="OECRequired") {
       UpdateForm.ptvis043.className="OECRequired Mandatory";  //Intended Stay
     } else {
       UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
     }

  } else {
     document.UpdateForm.admitbox.value="0";
     UpdateForm.ptmis011.className="";  //admission type
     UpdateForm.ptmis009.className="";  //admission source
     UpdateForm.ptmis012.className="";  //care type
     UpdateForm.ptmis068.className="";  //ward
     UpdateForm.ptmis005.className="";  //bed
     UpdateForm.ptmis024.className="";  //Unit
     UpdateForm.ptmis010.className="";  //CMBS Class
     UpdateForm.ptvis022.className="";  //Inform GP
     UpdateForm.ptmis064.className="";  //Food Allergy
     UpdateForm.ptvis022.options[0].value = "2";

     if (UpdateForm.ptmis007.className=="OECRequired Mandatory") {
       UpdateForm.ptmis007.className="OECRequired";  //Admitting Doctor
     } else {
       UpdateForm.ptmis007.className="";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="OECRequired Mandatory") {
       UpdateForm.doctnam2.className="OECRequired";  //Admitting Doctor Desc
     } else {
       UpdateForm.doctnam2.className="";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis027.className=="OECRequired Mandatory") {
       UpdateForm.ptmis027.className="OECRequired";  //Claim Type
     } else {
       UpdateForm.ptmis027.className="";  //Claim Type
     }

     if (UpdateForm.ptvis043.className=="OECRequired Mandatory") {
       UpdateForm.ptvis043.className="OECRequired";  //Intended Stay
     } else {
       UpdateForm.ptvis043.className="";  //Intended Stay
     }
  }

  if (!isWhitespace(document.getElementById('ptcnnssi').value)){
    if (document.UpdateForm.admitbox.value =="1") {
       document.getElementById('ptvis074').className="Mandatory";}
    else{
       document.getElementById('ptvis074').className="";}
  }

}
function selectUnit(){
  for (var i =0 ; i < document.UpdateForm.ptmis024.length; i++) {
    if (document.UpdateForm.ptmis024.options[i].value.substr(0,3)==
                 document.UpdateForm.deftunit.value.substr(0,3)) {
       document.UpdateForm.ptmis024.selectedIndex=i } };
}

function valReferGP(){
   p=document.UpdateForm;
   if (!isWhitespace(p.ptvis028.value)) {
      ValidateHCP(18,0,p.ptvis028,p.doctnam1);
   }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);document.UpdateForm.ptmis001.focus();
 DisplayTrnSrc();defaultWard();displayRegime();displayWardDiet();
 setHF();setPSTSjogNsw(); DispContractACT();
 valDoctorUnit();selectUnit();valReferGP();
 dispLSFieldNSW();dispBirthFieldsNSW();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
ConfDemogs="%STANDARD.01.045.PTCNCDOA";
NoDayDemVl=trim("%STANDARD.01.045.PTCNNDCD");
DemConDate=SetDateYYYYMMDD("%PATWEB89.01.085.059");
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>

<form name=UpdateForm id=UpdateForm method=post action=patweb89.pbl
 style="margin:0">
<input type=hidden name=reportno id=reportno value="2">
<input type=hidden name=updatety id=updatety value="1">
<input type=hidden name=redirect id=redirect
 value="%PATWEB89.01.001.patweb98.01.001">
<input type=hidden name=urnumber id=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno id=admissno value="%PATWEB89.01.101">
<input type=hidden name=allocate id=allocate value="1">
<input type=hidden name=chckname id=chckname value="0">
<input type=hidden name=emradmit id=emradmit value="0">
<input type=hidden name=emradmis id=emradmis value="0">
<input type=hidden name=admitnow id=admitnow value="1">
<input type=hidden name=newbmand id=newbmand value="0">
<input type=hidden name=agebmand id=agebmand value="0">
<input type=hidden name=ptmis004 id=ptmis004 value="0">
<input type=hidden name=ptmas046 id=ptmas046 value="0">
<input type=hidden name=mvmedrec id=mvmedrec>
<input type=hidden name=dummy id=dummy>
<input type=hidden name=prevdeta id=prevdeta value="1">
<input type=hidden name=cfinan id=cfinan value="%PATWEB89.01.932">
<input type=hidden name=exstward id=exstward value="%PATWEB89.01.449.1">
<input type=hidden name=prevprfa id=prevprfa value="%PATWEB89.01.999.045. 1">
<input type=hidden name=prprfad1 id=prprfad1 value="%PATWEB89.01.999.045. 2">
<input type=hidden name=prprfad2 id=prprfad2 value="%PATWEB89.01.999.045. 3">
<input type=hidden name=prprfsub id=prprfsub value="%PATWEB89.01.999.045. 4">
<input type=hidden name=prprfpos id=prprfpos value="%PATWEB89.01.999.045. 5">
<input type=hidden name=prprfad4 id=prprfad4 value="%PATWEB89.01.999.045. 6">
<input type=hidden name=prprfrel id=prprfrel value="%PATWEB89.01.999.045. 7">
<input type=hidden name=prprfnam id=prprfnam value="%PATWEB89.01.999.045. 8">
<input type=hidden name=ptvis047 id=ptvis047 size=3>
<input type=hidden name=bedstat1 id=bedstat1>
<input type=hidden name=warddesc id=warddesc>
<input type=hidden name=popwdesc id=popwdesc>
<input type=hidden name=popbstat id=popbstat>
<input type=hidden name=ptcndigp id=ptcndigp
                                       value="%STANDARD.01.025.124.122.0.1">
<input type=hidden name=deftunit id=deftunit value="%PATWEB89.01.124.1">
<input type=hidden name=ptcndwdc id=ptcndwdc
 value="%STANDARD.01.025.124.148.0.1">
<input type="hidden" name="ptvis109" id="ptvis109">
<input type=hidden name=oeceprov id=oeceprov>
<input type=hidden name=oeceprv2 id=oeceprv2>
<input type=hidden name=oeceprv3 id=oeceprv3>
<input type=hidden name=oeceprv4 id=oeceprv4>
<input type=hidden name=oeceprv5 id=oeceprv5>
<input type="hidden" name="patsurnm" id="patsurnm"
       title="Patient Surname" value="%PATWEB89.01.009">
<input type="hidden" name="patgivnm" id="patgivnm"
       title="Patient Given Name" value="%PATWEB89.01.010">
<input type="hidden" name="patntdob" id="patntdob"
       title="Patient Date of Birth" value="%PATWEB89.01.020">
<input type=hidden name=ptcnnssi id=ptcnnssi
       value="%STANDARD.01.044.125.093.020">
<input type=hidden name=copypdef  id=copypdef  value="0">

<table width=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=HeadingCell align=center>
    Patient Pre-Admission Details(from Inpatient Details)
</td></tr>

<tr><td>
      <table border=0 width=100% class=TableBody cellpadding=0 cellspacing=0>
      <tr><td>&nbsp;</td><td>&nbsp;</td>
          <td align=left><b>Admit Now?</b></td>
          <td align=left>
            <input type="checkbox" name="admitbox" id="admitbox" value="0"
             tabindex=26
             onclick='AdmitMandatory();'>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <b>Patient OEC Consent</b>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <input type="checkbox" name="oecchbox" id="oecchbox" value="0" notab
           onclick='ShowOECFields();OECRequired();'>
          </td></tr>

        <tr><td class=DataLabel>Admission Date</td>
            <td class=DataLabel><input type="text" size="12" tabindex=1
             name=ptmis001 id=ptmis001 value="%STANDARD.01.015" class=Mandatory 
             title="Admission Date"
             onblur="checkDate(this,'Admission Date')">
            <img src="../images/DateLookup.gif" class=Icon
             onclick="DateLookupFrame(UpdateForm.ptmis001);"> 
             Time <input type=text name=ptmis002 id=ptmis002 tabindex=2 size=8
                   value="%STANDARD.01.016" class=Mandatory title="Admission 
                    Time">
            <img src="../images/DateTimeStamp.gif" class=Icon 
             onclick="SetCurrentDateTime(null,UpdateForm.ptmis002);">
            <img src="../images/TimeLookup.gif" class=Icon
             onclick="TimeLookupFrame(UpdateForm.ptmis002);"> 
            </td>
       <td>Admitting Point</td>
       <td><select name=ptvis046 id=ptvis046 tabindex=11
            onchange="defaultWard()">
           <option></option>
            %PATWEB89.01.290.2
           </select>
       </td></tr>
      <tr><td class=DataLabel>%STANDARD.01.017.P </td>
          <td><select name=ptmis011 id=ptmis011 tabindex=3 
               title="%STANDARD.01.017.P ">
              <option> </option>
                 %PATWEB89.01.112.2
              </select></td>
        <td class=DataLabel>Ward / Bed </td>
        <td>
         <select name=ptmis068 id=ptmis068 tabindex=12 title="Ward">
         <option> </option>
            %PATWEB89.01.449.2
         </select>
         <input type=text name=ptmis005 id=ptmis005 maxlength=3 size=3 
                title="Bed">
         <img src=../images/SearchIcon.gif class=Icon
          onclick="WardBedSearchFrame(UpdateForm.ptmis068,
                                      UpdateForm.warddesc,
                                      UpdateForm.ptmis005,
                                      UpdateForm.bedstat1);">
       </td></tr>
        <tr><td class=DataLabel>Admission Source</td>
            <td><select name=ptmis009 id=ptmis009 tabindex=3
                 onchange="DisplayTrnSrc()" 
             class=SelectBig>
                <option> </option>
                %PATWEB89.01.110.2
               </select>
            </td>
           <td class=DataLabel>Admitting Doctor</td>
            <td>
               <input type="text" size=8 maxlength=6 name="ptmis007"
                 id="ptmis007" tabindex=13
                 value="%PATWEB89.01.108.003" 
                 title='Admitting Doctor'
                 onblur="UpCase(this);valDoctorUnit();">
               <input type=text readonly size=25 name=doctnam2 id=doctnam2
                 value="%PATWEB89.01.108.002">
               <img src="../images/SearchIcon.gif" class=Icon
                 onclick="DoctorSearchFrame(UpdateForm.ptmis007,
                                            UpdateForm.doctnam2)"></td></tr>
         <tr>
          <td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>
          <td class=DataLabel>Unit</td>
           <td><select name=ptmis024 id=ptmis024 tabindex=14
               title='Unit'>
               <option> </option>
                %PATWEB89.01.124.2
               </select>
           </td><tr>
      <tr><td class=DataLabel>%STANDARD.01.017.KO</td>
      <td><select name=ptvis078 id=ptvis078 tabindex=8 class=Mandatory
           title="%STANDARD.01.017.KO">
           <option></option>
           %PATWEB89.01.294.2
           </select></td>
       <td class=DataLabel>Diagnosis </td>
           <td><input type=text name="ptmis020" id="ptmis020"
                size=50 maxlength=80 tabindex=15
                value="%PATWEB89.01.121"></td></tr>
       <tr><td></td>
       <td>
       </td>
       <td class=DataLabel>Provisional DRG</td>
       <td><input type=text name=ptmis066 id=ptmis066 size=5 maxlength=4
           tabindex=16
           onblur="validateCode(5,UpdateForm.ptmis066,UpdateForm.drgdesc1);"
           value="%PATWEB89.01.140.0">
          <input type=text notab readonly name=drgdesc1 id=drgdesc1 size=35
              value="%PATWEB89.01.140.1">
          <img src="../images/SearchIcon.gif" class=Icon
           onclick="DrgSearchFrame(UpdateForm.ptmis066,
                                   UpdateForm.drgdesc1)">
       </td></tr>
       <tr><td>%STANDARD.01.017.U7</td>
         <td><select name=ptmis043 id=ptmis043 tabindex=22>
           <option></option>
            %PATWEB89.01.139.2
         </select></td>
           <td class=DataLabel>Admission Diet</td>
       <td><select name=ptmis028 id=ptmis028 tabindex=17>
           <option> </option>
            %PATWEB89.01.127.2
           </select>
           %STANDARD.01.017.U9
           <select name=ptmis064 id=ptmis064 tabindex=22 onchange="setAlert();"
                   title="%STANDARD.01.017.U9">
           <option></option>
            %PATWEB89.01.155.5
           </select>
         </td></tr>
         <tr><td align=left>Prior Days Hospitalisation</td>
          <td><input type=text name=ptmis031 id=ptmis031 
            title='Prior Days Hospitalisation'
            class=Integer size=5 maxlength=4 tabindex=5
            onblur="checkInteger(this,this.title);" value="%PATWEB89.01.130">
         </td>
         <td class=DataLabel><div id=warddietcodetitleDIV></div></td>
         <td><div id=warddietcodeDIV></div></td>
       </tr>
       <tr><td class=DataLabel>Care Type</td>
            <td><select name=ptmis012 id=ptmis012 tabindex=8 class=SelectBig
                onchange="displayRegime();dispBirthFieldsNSW();">
              <option> </option>
               %PATWEB89.01.113.2
            </select></td>
          <td class=DataLabel><div id=dietcommenttitleDIV></div></td>
          <td><div id=dietcommentfieldDIV></div></td>
          </tr>
          <tr><td class=DataLabel>Intended Stay </td>
          <td><select name=ptvis043 id=ptvis043 tabindex=9
               title="Intended Stay">
              <option> </option>
               %PATWEB89.01.246.2
              </select>
          </td>
             <td class=DataLabel>Referring Doctor</td>
         <td><input type="text" size=10 maxlength=10 name="ptvis028"
              id="ptvis028" tabindex=17
              value="%PATWEB89.01.231.1"
              onblur="ValidateHCP(18,
                                  0,
                                  UpdateForm.ptvis028,
                                  UpdateForm.doctnam1);">
             <input type="text" size=25 name="doctnam1" id="doctnam1"
              value="%PATWEB89.01.231.0">
             <img src="../images/SearchIcon.gif" class=Icon
              onclick="HCPSearchFrame(UpdateForm.ptvis028,
                                      UpdateForm.doctnam1,
                                      0);">
          </td>
       </tr>
       <tr><td class=DataLabel> Planned Length of Stay</td>
        <td>
        <input type=text size=5 maxlength=5 name=ptmis030 id=ptmis030
         tabindex=9 title='Expected Length of Stay' value="%PATWEB89.01.129"
         class=Integer onblur="checkInteger(this,this.value);">
        </td>
           <td class=DataLabel>Inform GP</td>
          <td><select name=ptvis022 id=ptvis022 tabindex=19 title="Inform GP">
              <option value="2"> </option>
              <option value="0">No</option>
              <option value="1">Yes</option>
              </select></td>
</tr>
       <tr>
          <td class=DataLabel>Discharge Intention</td>
          <td><select name=ptvis076 id=ptvis076 tabindex=9
               title="Discharge Intention">
              <option> </option>
               %PATWEB89.01.292.2
              </select></td>
           <td class=DataLabel>Religious Visit</td>
       <td><select name=ptmis017 id=ptmis017 tabindex=20>
           <option value="3">Unk</option>
           <option value="0">No</option>
           <option value="1">Yes</option>
           </select>
       </td>
       </tr>

       <tr>
          <td class=DataLabel>Preferred Accommodation</td>
          <td><select name=ptvis093 id=ptvis093 tabindex=9
               title="Preferred Accommodation">
              <option> </option>
               %PATWEB89.01.298.012.2
              </select></td>
          <td class=DataLabel>Research Contact</td>
          <td class=DataField><select name=ptvis084 id=ptvis084 tabindex=20>
           %PATWEB89.01.298.003.2</select></td>
       </tr>

 <tr> <td class=DataLabel>Valuables Location</td>
      <td><input type="text" size=40 maxlength=40 name=ptvis020 id=ptvis020
           tabindex=21
           value="%PATWEB89.01.223"></td>
      <td class=DataLabel>Research Use</td>
        <td class=DataField><select name=ptvis085 id=ptvis085 tabindex=20>
         %PATWEB89.01.298.004.2</select></td> 
</tr>

<tr><td class=DataLabel>Exp.Post Op Ward/Bed</td>
     <td>
         <select name=ptvis048 id=ptvis048 tabindex=12>
         <option></option>
         %PATWEB89.01.251.2
         </select>
         <input type=text name=ptvis049 id=ptvis049 maxlength=3 size=3
          value="%PATWEB89.01.252.0" tabindex=12>
         <img src=../images/SearchIcon.gif class=Icon
          onclick="WardBedSearchFrame(UpdateForm.ptvis048,
                                      UpdateForm.popwdesc,
                                      UpdateForm.ptvis049,
                                      UpdateForm.popbstat);">
     </td>
     <td class=DataLabel>Foundation</td>
           <td><select name=ptmis071 id=ptmis071 tabindex=20>
               <option value="0">No</option>
               <option value="1">Yes</option>
               </select>
     </td>     
</tr>

     <tr><td><div id=nswLegalStatusDL></div></td>
         <td><div id=nswLegalStatusDF></div></td>
         <td class=DataLabel>Mailing List</td>
         <td>
         <select name=ptmis072 id=ptmis072 tabindex=21>
          <option value="0">No</option>
          <option value="1">Yes</option>
         </select>
         </td>
     </tr>

     <tr><td><div id=nswNumOfBabiesDL></div></td>
         <td><div id=nswNumOfBabiesDF></div></td>
     </tr>

     <tr><td><div id=nswBirthOrderDL></div></td>
         <td><div id=nswBirthOrderDF></div></td>
        <td class=DataLabel>Type of Usual Accom</td>
      <td><select name=ptvis095 id=ptvis095 tabindex=26
           title="Usual Accommodation" class=Mandatory>
           <option></option>
           %PATWEB89.01.298.017.2
           </select></td> 
    </tr>

     <tr><td><div id=nswBirthWeightDL></div></td>
         <td><div id=nswBirthWeightDF></div></td>
         <td class=DataLabel>Program</td>
         <td><input type=text size=8 maxlength=8 name=ptvis099 id=ptvis099
         title="Program" tabindex=26 value="%PATWEB89.01.298.021.1"
         onchange="findPrgmdesc();">
        <select name=prgmcode id=prgmcode Readonly class=readonly tabindex=166
         onchange="savePrgmcode();">
        <option> </option>
         %PATWEB89.01.298.021.2
        </select></td> 
    </tr>

<tr><td></td>
    <td></td>
    <td class=DataLabel>3B Days of hospitalisation</td>
     <td><input type=text name=ptmis082 title='3B days of hospitalisation' 
           size=5 maxlength=4 tabindex=12 value="%PATWEB89.01.199.015"
           class=Integer id=ptmis082
            onblur="checkInteger(this,this.title);">
    </td>
    </tr>

   <tr align=left><td align=center colspan="4"><hr></td></tr>
 
   <tr align=left><td class=DataLabel>%STANDARD.01.017.CL</td>
       <td align=left><select name=ptmis027 id=ptmis027 tabindex=22 
         title="%STANDARD.01.017.CL" 
         onchange="if (document.UpdateForm.ptmis013.className != 'OECRequired')
                   {setHF();}; DispContractACT();">
         <option> </option>
         %PATWEB89.01.126.9.1.10.2.X
         </select>
         </td>

      <td class=DataLabel>Casepayment</td>
      <td>
        <select name=ptmis075 id=ptmis075 tabindex=26>
        <option value="0">No</option>
        <option value="1">Yes</option>
        </select></td></tr>

       <tr><td class=DataLabel>%STANDARD.01.017.A </td>
           <td><select name=ptmis010 id=ptmis010 tabindex=23
                 onchange="setPSTSjogNsw()" 
                 title="%STANDARD.01.017.A " >
                <option> </option>
                 %PATWEB89.01.111.2
                </select>

      <td class=DataLabel>Casemix Code</td>
      <td class=DataLabel>
       <input type=text name=ptmis073 id=ptmis073 size=10 maxlength=9
        tabindex=27 value=""
        onblur="validateCode(35,UpdateForm.ptmis073,UpdateForm.cmixdesc1);">
       <input type=text notab readonly name=cmixdesc1 id=cmixdesc1
         size=35 value="">
       <img notab src="../images/SearchIcon.gif" class=Icon
         onclick="CmixSearchFrame(UpdateForm.ptmis073,UpdateForm.cmixdesc1)">
      </td></tr>
<tr>
  <td><span id=spnPrevTreatLbl></span></td>
  <td><span id=spnPrevTreat></span></td>
  <td class=DataLabel>%STANDARD.01.017.KD</td>
    <td class=DataField>
    <select name=ptvis104 id=ptvis104 tabindex=28 title="%STANDARD.01.017.KD">
    <option></option>
    %PATWEB89.01.298.026.5
    </select></td></tr>

<tr>
    <td class=DataLabel>Health Fund </td>
    <td colspan=2><input type=text size=6 maxlength=6 name=ptmis013 id=ptmis013
         title="Health Fund" tabindex=23
         onchange="validateCode(16,UpdateForm.ptmis013,UpdateForm.funddesc);
                   checkTableadm();" value="%PATWEB89.01.114.0">
    <input type=text size=25 maxlength=30 name=funddesc id=funddesc
     class=readonly Readonly notab value="%PATWEB89.01.114.1">
    Level
        <input name="ptmis014" id="ptmis014" size=8 maxlength=8
         tabindex=23 value="%PATWEB89.01.115.0"
         title="Level"
         onblur="validateHFT(20,
                             UpdateForm.ptmis013,
                             UpdateForm.ptmis014,
                             UpdateForm.funddesc,
                             UpdateForm.tabldesc);">
        <input type="text" size=15 maxlength=17 name="tabldesc" id="tabldesc"
         class=readonly Readonly notab value="%PATWEB89.01.115.1" >
        <img src=../images/SearchIcon.gif class=Icon
         onclick="HealthFundSearchFrame(UpdateForm.ptmis013,
                                        UpdateForm.funddesc,
                                        UpdateForm.ptmis014,
                                        UpdateForm.tabldesc);">
        <img src="../images/erase.gif" class=Icon
         onclick="clrDoc(UpdateForm.ptmis013,UpdateForm.ptmis014);
                  clrDoc(UpdateForm.funddesc,UpdateForm.tabldesc);
                  checkTableadm();">
    </td>

</tr>
    <tr align=left><td class=DataLabel>Member Number &nbsp; </td>
        <td class=DataLabel>
        <input type=text size=20 maxlength=19 
        value="%PATWEB89.01.116" name='ptmis015' id='ptmis015' tabindex=24></td>
        <td align=left>Move Medical Record</td>
        <td align=left>
        <input type="checkbox" name="mvmedre1" id="mvmedre1" value="1"
         tabindex=29>
        </td></tr>
<tr>
      <td><td class=DataLabel>&nbsp;</td>
      <td class=DataLabel>Continuous Billing</td>
         <td><select name=ptmis081 id=ptmis081 tabindex=30>
           <option> </option>
            %PATWEB89.01.199.014.2
           </select>
         </td>
</tr>

  <tr><td class=DataLabel>GST Applicable</td>
      <td><select name=ptmis074 id=ptmis074 tabindex=25>
          <option> </option>
           %PATWEB89.01.189.2
          </select>
        </td>
      <td><div id=RegimeHead1></div></td>
      <td><div id=RegimeCode1></div></td></tr>

 <tr><td class=DataLabel><div id=ContrHeading></div></td>
     <td><div id=ContrId></div></td>
     <td class=DataLabel><div id=Contr1Heading></div></td>
     <td><div id=ContrType></div></td>
 </tr>
 <tr><td class=DataLabel><div id=Contr2Heading></div></td>
     <td><div id=ContrRole></div></td>
     <td class=DataLabel><div id=Contr3Heading></div></td>
     <td><div id=ContrUR></div></td>
 </tr>



  <tr><td><div id=UserNameHead></div></td>
      <td><div id=UserNameCode></div></td>
      <td><div id=RegimeHead2></div></td>
      <td><div id=RegimeCode2></div></td></tr>

  <tr><td><div id=PasswordHead></div></td>
      <td><div id=PasswordCode></div></td>
      <td><div id=RegimeHead3></div></td>
      <td><div id=RegimeCode3></div></td></tr>

  <tr><td></td>
      <td></td>
      <td class=DataLabel><div id=PreExistAilHdr></div></td>
      <td><div id=PreExistAilmnt></div></td>
      </tr>

  <tr><td></td>
      <td></td>
      <td class=DataLabel><div id=EmerAdmHdr></div></td>
      <td><div id=EmerAdmssn></div></td>
      </tr>

  <tr><td></td>
      <td align=right><div id=SwiPresIll></div></td>
      <td class=DataLabel><div id=PresIllCodHdr></div></td>
      <td><div id=PresIllCod></div></td>
      </tr>

  <tr><td>&nbsp;</td></tr>

  <tr><td><div id=AddMBScodes></div></td>
  <tr><td align=center colspan="4"><div id=LongLine></div></td>
  <tr><td align=center colspan="4"><div id=OESMBSitems></div></td></tr>
  <tr><td align=center colspan="5"><div id=OESHeadings></div></td></tr>
  <tr><td align=center colspan="4"><div id=OESServices></div></td>

    <tr align=left><td align=left> </td>
        <td align=left> </td>
    <tr align=left><td colspan=4 align=center><br>
        <input type=button value="Ok" class="button" tabindex=30
         id="pat89sub"
         onclick="tempDisable(this);
         checkBedStatus(UpdateForm.ptmis068.value,
                        UpdateForm.ptmis005.value,
                        UpdateForm.ptmis001.value,
                        UpdateForm.ptmis030.value,
                        UpdateForm.ptmis002.value,
                        UpdateForm.ptrgm001.value,
                        UpdateForm.ptrgm002.value,
                        UpdateForm.ptrgm003.value,
                        SubmitAdm);">
        <input tabindex=31 type=button value="Cancel" class="button"
         onclick="PatientLinkTo('patweb98.pbl',1,1,0);">
    </table></td></tr>

</table>
</form>
</div>

<form name=linkForm id=linkForm action=patweb89.pbl method=post>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.101">
</form>

<form name=PatientLinks id=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
<input type=hidden name=MenuType value="%PATWEB89.01.088">
</form>

<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 id=ptmis058 tabindex=18
         onblur="checkDate(this,'ReferralDate')">
        <img notab src="../images/DateLookup.gif" class=Icon
         onclick="DateLookupFrame(UpdateForm.ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
    <td><input type=text size=12 name=ptmis059 id=ptmis059 tabindex=19
         onblur="checkDate(this,'SpecConDate')">
        <img notab src="../images/DateLookup.gif" class=Icon
         onclick="DateLookupFrame(UpdateForm.ptmis059);"></td></tr>
</table>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr>
  <td class=DataLabel width=37%>Admission Weight</td>
  <td>
   <input type=text name=ptmis051 id=ptmis051 size=5 maxlength=4
    tabindex=20>grams</td></tr>
</table>
</span>

<span id=NewBorn style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
  <td><input type=text name=ptmis041 id=ptmis041 maxlength=3 size=4 tabindex=21> weeks
    </td></tr>
</table>
</span>

<script type="text/javascript">
 if ("%PATWEB89.01.905" == "1") {
  alert("Warning: Patient is currently admitted");
 }
 if ("%PATWEB89.01.908" == "1") {
  alert("Warning: Patient has a pre-admission record");
 }
</script>

<span id=transferhd style="display:none">
Transfer Source
</span>

<span id=transfersrc style="display:none">
  <input type="text" size=7 maxlength=5 name=trnsfsrc id=trnsfsrc
   class=Mandatory
   title="Transfer Source" tabindex=5 value="%PATWEB89.01.193.0"
   onchange="validateCode(9,UpdateForm.trnsfsrc,UpdateForm.trandesc);">
  <input type=text size=27 name=trandesc id=trandesc notab
   class=Readonly readonly value="%PATWEB89.010193.1">
  <img src="../images/SearchIcon.gif" class=Icon
   onclick="TransferSourceFrame(UpdateForm.trnsfsrc,UpdateForm.trandesc)">
</span>

<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc id=trnsfsrc>
</span>

<span id=preexisthdr style="display:none">
 <b>PEA Indicator</b>
</span>

<span id=emeradmnhdr style="display:none">
 <b>Emergency Admission</b>
</span>

<span id=presillcodhdr style="display:none">
 <b>Presenting Illness Code</b>
</span>

<span id=presillnumhdr style="display:none">
 <b>Presenting Illness Number (MBS)</b>
</span>

<span id=swipresillhdr style="display:none">
 <b>Switch to MBS Presenting Illness Number &nbsp;</b>
</span>

<span id=preexistail style="display:none">
  <select name=ptelg014 id=ptelg014 title="PEA Indicator" class="OECRequired">
  <option value="0">No</option>
  <option value="1">Yes</option>
  </select>
</span>

<span id=emeradmissn style="display:none">
  <select name=ptelg033 id=ptelg033 title="Emergency Admission"
   class="OECRequired">
  <option value="0">No</option>
  <option value="1">Yes</option>
  </select>
</span>

<span id=presillcod style="display:none">
  <select name=ptvis111 id=ptvis111 title="Presenting Illness"
   class="OECRequired">
  <option value=" "></option>
   %PATWEB89.01.298.034.2
  </select>
</span>

<span id=swipresill style="display:none">
 <b>Switch to MBS Presenting Illness Number &nbsp;</b>
 <input type="checkbox" name="presilsw" id="presilsw" value="1"
  title="Presenting Illness MBS"
  onclick="switchPresIll();"> &nbsp; &nbsp;
</span>

<span id=presillnum style="display:none">
    <input type=text name=ptmis026 id=ptmis026 size=10 maxlength=9
     onblur='validateCode(4,
                          UpdateForm.ptmis026,
                          UpdateForm.mbsdesc1,
                          UpdateForm.ptmis001)'
     class="OECRequired">
    <input type=text notab readonly name=mbsdesc1 id=mbsdesc1 size=35
     class="OECRequired">
    <img notab src="../images/SearchIcon.gif" class=Icon
     onclick="MbsSearchFrame(UpdateForm.ptmis026,
                             UpdateForm.mbsdesc1,
                             UpdateForm.ptmis001)">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.ptmis026,UpdateForm.mbsdesc1);">
</span>

<span id=addmbscodes style="display:none">
<table>
  <tr><td class=DataLabel>Show Extra MBS Codes</td>
      <td><input type="checkbox" name="showmbsc" id="showmbsc" value="1"
       onclick="ShowOESmbs();">
      </td></tr>
</table>
</span>

<span id=oesheadings style="display:none">
<table border=0 colspan=0 width=70% cellspacing=0 cellpadding=0 >
  <tr><td width=20%><b>Date</b></td>
      <td width=12%><b>Type</b></td>
      <td width=60%><b>Item / Description</b></td>
                   <td><b>Quantity</b></td></tr>
</table>
</span>

<span id=oesservices style="display:none">
<table border=0 colspan=0 width=70% cellspacing=0 cellpadding=0 >
  <tr><td width=20%>
     <input type=text size=12 name=oes01007 id=oes01007
      class="FutureDate" title="OES Service 1 Date"
      onblur="checkDate(this,this.title);">
     <img notab src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(UpdateForm.oes01007,null);">
     <img notab src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(UpdateForm.oes01007);">
  <input type=hidden name=oes01004 id=oes01004 value="6">
     </td>
      <td width=12%><b>Misc.Item</b></td>
      <td>
    <input type=text name=oes01005 id=oes01005 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes01004,
                              document.UpdateForm.oes01005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes01005);
             mandatoryItemCode(this,
                               document.UpdateForm.oes01007,
                               document.UpdateForm.oes01006);
             document.UpdateForm.oes01006.value=1;
             justifyRight(document.UpdateForm.oes01006);">
    <input type=text name=d_oes01005 id=d_oes01005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes01004,
                                  document.UpdateForm.oes01005,
                                  document.UpdateForm.d_oes01005);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.oes01005,UpdateForm.d_oes01005);
              mandatoryItemCode(document.UpdateForm.oes01005,
                                document.UpdateForm.oes01007,
                                document.UpdateForm.oes01006);">
                   </td>
                   <td>
    <input type=text name=oes01006 id=oes01006 title="Quantity"
     size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes02007 id=oes02007
      class="FutureDate" title="OES Service 2 Date"
      onblur="checkDate(this,this.title);">
     <img notab src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(UpdateForm.oes02007,null);">
     <img notab src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(UpdateForm.oes02007);">
  <input type=hidden name=oes02004 id=oes02004 value="6">
     </td>
      <td width=12%><b>Misc.Item</b></td>
      <td>
    <input type=text name=oes02005 id=oes02005 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes02004,
                              document.UpdateForm.oes02005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes02005);
             mandatoryItemCode(this,
                               document.UpdateForm.oes02007,
                               document.UpdateForm.oes02006);
             document.UpdateForm.oes02006.value=1;
             justifyRight(document.UpdateForm.oes02006);">
    <input type=text name=d_oes02005 id=d_oes02005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes02004,
                                  document.UpdateForm.oes02005,
                                  document.UpdateForm.d_oes02005);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.oes02005,UpdateForm.d_oes02005);
              mandatoryItemCode(document.UpdateForm.oes02005,
                                document.UpdateForm.oes02007,
                                document.UpdateForm.oes02006);">
                   </td>
                   <td>
    <input type=text name=oes02006 id=oes02006 title="Quantity"
     size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes03007 id=oes03007
      class="FutureDate" title="OES Service 3 Date"
      onblur="checkDate(this,this.title);">
     <img notab src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(UpdateForm.oes03007,null);">
     <img notab src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(UpdateForm.oes03007);">
  <input type=hidden name=oes03004 id=oes03004 value="6">
     </td>
      <td width=12%><b>Misc.Item</b></td>
      <td>
    <input type=text name=oes03005 id=oes03005 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes03004,
                              document.UpdateForm.oes03005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes03005);
             mandatoryItemCode(this,
                               document.UpdateForm.oes03007,
                               document.UpdateForm.oes03006);
             document.UpdateForm.oes03006.value=1;
             justifyRight(document.UpdateForm.oes03006);">
    <input type=text name=d_oes03005 id=d_oes03005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes03004,
                                  document.UpdateForm.oes03005,
                                  document.UpdateForm.d_oes03005);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(oes03005,d_oes03005);
              mandatoryItemCode(document.UpdateForm.oes03005,
                                document.UpdateForm.oes03007,
                                document.UpdateForm.oes03006);">
                   </td>
                   <td>
    <input type=text name=oes03006 id=oes03006 title="Quantity"
     size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes04007 id=oes04007
      class="FutureDate" title="OES Service 4 Date"
      onblur="checkDate(this,this.title);">
     <img notab src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(UpdateForm.oes04007,null);">
     <img notab src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(UpdateForm.oes04007);">
  <input type=hidden name=oes04004 id=oes04004 value="6">
     </td>
      <td width=12%><b>Misc.Item</b></td>
      <td>
    <input type=text name=oes04005 id=oes04005 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes04004,
                              document.UpdateForm.oes04005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes04005);
             mandatoryItemCode(this,
                               document.UpdateForm.oes04007,
                               document.UpdateForm.oes04006);
             document.UpdateForm.oes04006.value=1;
             justifyRight(document.UpdateForm.oes04006);">
    <input type=text name=d_oes04005 id=d_oes04005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes04004,
                                  document.UpdateForm.oes04005,
                                  document.UpdateForm.d_oes04005);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.oes04005,UpdateForm.d_oes04005);
              mandatoryItemCode(document.UpdateForm.oes04005,
                                document.UpdateForm.oes04007,
                                document.UpdateForm.oes04006);">
                   </td>
                   <td>
    <input type=text name=oes04006 id=oes04006 title="Quantity"
     size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes05007 id=oes05007
      class="FutureDate" title="OES Service 5 Date"
      onblur="checkDate(this,this.title);">
     <img notab src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(UpdateForm.oes05007,null);">
     <img notab src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(UpdateForm.oes05007);">
  <input type=hidden name=oes05004 id=oes05004 value="6">
     </td>
      <td width=12%><b>Misc.Item</b></td>
      <td>
    <input type=text name=oes05005 id=oes05005 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes05004,
                              document.UpdateForm.oes05005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes05005);
             mandatoryItemCode(this,
                               document.UpdateForm.oes05007,
                               document.UpdateForm.oes05006);
             document.UpdateForm.oes05006.value=1;
             justifyRight(document.UpdateForm.oes05006);">
    <input type=text name=d_oes05005 id=d_oes05005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes05004,
                                  document.UpdateForm.oes05005,
                                  document.UpdateForm.d_oes05005);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.oes05005,UpdateForm.d_oes05005);
              mandatoryItemCode(document.UpdateForm.oes05005,
                                document.UpdateForm.oes05007,
                                document.UpdateForm.oes05006);">
                   </td>
                   <td>
    <input type=text name=oes05006 id=oes05006 title="Quantity"
     size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
</table>
</span>

<span id=oesmbsitems style="display:none">
<table border=0 colspan=0 width=70% cellspacing=0 cellpadding=0 >
  <tr><td width=20%>
  <input type=hidden name=mbstypes id=mbstypes value="3"></td>
      <td width=12%><b>MBS Item</b></td>
    <td>
    <input type=text name=extrprov id=extrprov title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.mbstypes,
                              document.UpdateForm.extrprov,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_extrprov);">
    <input type=text name=d_extrprov id=d_extrprov size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.mbstypes,
                                  document.UpdateForm.extrprov,
                                  document.UpdateForm.d_extrprov);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.extrprov,UpdateForm.d_extrprov);">
                   </td></tr>
  <tr><td width=20%></td>
      <td width=12%><b>MBS Item</b></td>
    <td>
    <input type=text name=extrprv2 id=extrprv2 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.mbstypes,
                              document.UpdateForm.extrprv2,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_extrprv2);">
    <input type=text name=d_extrprv2 id=d_extrprv2 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.mbstypes,
                                  document.UpdateForm.extrprv2,
                                  document.UpdateForm.d_extrprv2);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.extrprv2,UpdateForm.d_extrprv2);">
                   </td></tr>
  <tr><td width=20%></td>
      <td width=12%><b>MBS Item</b></td>
    <td>
    <input type=text name=extrprv3 id=extrprv3 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.mbstypes,
                              document.UpdateForm.extrprv3,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_extrprv3);">
    <input type=text name=d_extrprv3 id=d_extrprv3 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.mbstypes,
                                  document.UpdateForm.extrprv3,
                                  document.UpdateForm.d_extrprv3);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.extrprv3,UpdateForm.d_extrprv3);">
                   </td></tr>
  <tr><td width=20%></td>
      <td width=12%><b>MBS Item</b></td>
    <td>
    <input type=text name=extrprv4 id=extrprv4 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.mbstypes,
                              document.UpdateForm.extrprv4,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_extrprv4);">
    <input type=text name=d_extrprv4 id=d_extrprv4 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.mbstypes,
                                  document.UpdateForm.extrprv4,
                                  document.UpdateForm.d_extrprv4);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.extrprv4,UpdateForm.d_extrprv4);">
                   </td></tr>
  <tr><td width=20%></td>
      <td width=12%><b>MBS Item</b></td>
    <td>
    <input type=text name=extrprv5 id=extrprv5 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.mbstypes,
                              document.UpdateForm.extrprv5,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_extrprv5);">
    <input type=text name=d_extrprv5 id=d_extrprv5 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.mbstypes,
                                  document.UpdateForm.extrprv5,
                                  document.UpdateForm.d_extrprv5);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.extrprv5,UpdateForm.d_extrprv5);">
                   </td></tr>
    <tr><td align=center colspan="4"><hr width=100%></td></tr>

</table>
</span>

<span id=longline style="display:none"><hr></span>

<span id=contracthd style="display:none">
Contract Type
</span>

<span id=contracrhd style="display:none">
Contract Role
</span>

<span id=contracihd style="display:none">
 Contract Id
</span>

<span id=contractid style="display:none">
  <select name=ptasf003 id=ptasf003 title="Contract Spoke Id"
   class=Mandatory tabindex=26>
  <option> </option>
   %PATWEB89.01.199.003.0
  </select>
</span>

<span id=contracttype style="display:none">
  <input type="text" name=ptasf001 id=ptasf001 size=2 maxlength=1
   class=Mandatory
   value="%PATWEB89.01.199.001" tabindex=27
   title="Contract Type"
   onblur="ContType(this);">
   <img src="../images/SearchIcon.gif" class=Icon
   onclick="ContTypeAlert();">
</span>

<span id=contractrole style="display:none">
  <input type="text" name=ptasf002 id=ptasf002 size=2 maxlength=1
   class=Mandatory
   value="%PATWEB89.01.199.002" tabindex=28
   title="Contract Role"
   onblur="ContRole(this);">
   <img src="../images/SearchIcon.gif" class=Icon
   onclick="ContRoleAlert();">
</span>

<span id=blanklabel style="display:none">&nbsp;</span>
<span id=regimehd1 style="display:none" class=DataLabel>
Regime Code 1
</span>
<span id=regimecod1 style="display:none">
<input type="text" size=15 maxlength=10
     name=ptrgm001 id=ptrgm001 tabindex=29
     onblur="validateCode(75,UpdateForm.ptrgm001,UpdateForm.dummy);"
     value="%PATWEB89.01.973. 1">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(UpdateForm.ptrgm001,UpdateForm.dummy);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.ptrgm001,UpdateForm.dummy);">
</span>

<span id=regimehd2 style="display:none" class=DataLabel>
Regime Code 2
</span>
<span id=regimecod2 style="display:none">
<input type="text" size=15 maxlength=10
     name=ptrgm002 id=ptrgm002 tabindex=29
     onblur="validateCode(75,UpdateForm.ptrgm002,UpdateForm.dummy);"
     value="%PATWEB89.01.973. 2">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(UpdateForm.ptrgm002,UpdateForm.dummy);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.ptrgm002,UpdateForm.dummy);">
</span>

<span id=regimehd3 style="display:none" class=DataLabel>
Regime Code 3
</span>
<span id=regimecod3 style="display:none">
<input type="text" size=15 maxlength=10
     name=ptrgm003 id=ptrgm003 tabindex=29
     onblur="validateCode(75,UpdateForm.ptrgm003,UpdateForm.dummy);"
     value="%PATWEB89.01.973. 3">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(UpdateForm.ptrgm003,UpdateForm.dummy);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.ptrgm003,UpdateForm.dummy);">
</span>

<span id=regimeblank1 style="display:none">
<input type=hidden name=ptrgm001 id=ptrgm001 value="">
</span>

<span id=regimeblank2 style="display:none">
<input type=hidden name=ptrgm002 id=ptrgm002 value="">
</span>

<span id=regimeblank3 style="display:none">
<input type=hidden name=ptrgm003 id=ptrgm003 value="">
</span>

<span id=usernamehd style="display:none" class=DataLabel>
User Name
</span>

<span id=usernamcd style="display:none">
<input size=12 type=text name=username id=username class=Mandatory
 title="UserName">
</span>

<span id=passwordhd style="display:none" class=DataLabel>
Password
</span>

<span id=passwordcd style="display:none">
<input size=12 type=password name=password id=password
     onblur="checkPass();"
     class=Mandatory title="Password">
</span>
<script type="text/javascript">
function init() {
  var p = document.UpdateForm;
  DefaultInformGP(p.ptvis022,p.ptcndigp.value);
}

RelVisit="%PATWEB89.01.118.1"
if(RelVisit=="Yes"){
  RelVisit="1"
}

if(RelVisit=="No "){
  RelVisit="0";
}

for (var i =0 ; i < document.UpdateForm.ptmis017.length; i++) {
  if (document.UpdateForm.ptmis017.options[i].value==RelVisit.substr(0,1)) {
     document.UpdateForm.ptmis017.selectedIndex=i } };

CasePaym="%PATWEB89.01.197.1"
if(CasePaym=="Yes"){
  CasePaym="1"
}
if(CasePaym=="No "){
  CasePaym="0";
}
for (var i =0 ; i < document.UpdateForm.ptmis075.length; i++) {
  if (document.UpdateForm.ptmis075.options[i].value==CasePaym.substr(0,1)) {
     document.UpdateForm.ptmis075.selectedIndex=i } };

MergePsy="%PATWEB89.01.050"
if(MergePsy=="Yes"){
  document.UpdateForm.ptmas046.value="1"
}
if(MergePsy=="No "){
  document.UpdateForm.ptmas046.value="0"
}

for (var i=0;i<document.UpdateForm.ptmis072.length;i++){
if (document.UpdateForm.ptmis072.options[i].value=="%PATWEB89.01.162"){
    document.UpdateForm.ptmis072.selectedIndex=i}};

for (var i=0;i<document.UpdateForm.ptmis071.length;i++){
if (document.UpdateForm.ptmis071.options[i].value=="%PATWEB89.01.161"){
    document.UpdateForm.ptmis071.selectedIndex=i}};

var informGP = "%PATWEB89.01.225.0";               //ptvis022
valInformGP(document.UpdateForm.ptvis022,informGP,document.UpdateForm.ptcndigp.value);

</script>

<span id=warddietcodetitleSPAN style="display:none">
Ward Diet
</span>

<span id=warddietcodeSPAN style="display:none">
  <select name=dietdtyp id=dietdtyp tabindex=17 title="Ward Diet"
         onchange="">
         <option> </option>
          %PATWEB89.01.999.062.5
  </select>
</span>

<span id=dietcommenttitleSPAN style="display:none">
Diet Comment
</span>

<span id=dietcommentfieldSPAN style="display:none">
  <input type="text" name=dietcomm id=dietcomm size=40 maxlength=40
   tabindex=17 title="Diet Comment" value="%PATWEB89.01.999.063">
</span>

<!-- EDW data collection fields when ptcnnssi is set - START -->
<span id=nswLSLabel style="display:none">
      %STANDARD.01.035.LS</span>
<span id=nswLSData style="display:none">
      <select name=ptvis074 id=ptvis074 tabindex=17
       title="%STANDARD.01.017.LS">
      <option> </option>
      %PATWEB89.01.289.2
      </select></span>

<span id=nswNumBabiesLabel style="display:none">
      No. of babies Born with this Baby</span>
<span id=nswNumBabiesData style="display:none">
      <input type=hidden name=d_ptmis036 id=d_ptmis036
       value="%PATWEB89.01.199.022">
      <select name=ptmis036 id=ptmis036 tabindex=18
      title="No. of babies Born with this Baby">
      <option value="0"></option>
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5</option>
      <option value="6">6</option>
      <option value="7">7</option>
      <option value="8">8</option>
      <option value="9">9</option>
      <option value="10">10</option>
      </select></span>

<span id=nswBirthOrderLabel style="display:none">
      %STANDARD.01.017.U6</span>
<span id=nswBirthOrderData style="display:none">
      <input type=hidden name=d_ptmis042 id=d_ptmis042
       value="%PATWEB89.01.138.1">
      <select name=ptmis042 id=ptmis042 tabindex=19
       title="%STANDARD.01.017.U6">
      <option> </option>
       %PATWEB89.01.138.2
      </select></span>

<span id=nswBirthWeightLabel style="display:none">
      Birth Weight</span>
<span id=nswBirthWeightData style="display:none">
      <input type=text size=7 maxlength=8 name=ptmis051
         tabindex=11 title='Birth Weight' value="%PATWEB89.01.186"
         class=Integer onblur="checkInteger(this,this.value);">&nbsp;grams
      </span>

<!-- EDW data collection fields when ptcnnssi is set - END -->

<span id=PrevTreatLbl style="display:none">
%STANDARD.01.035.YE
</span>
<span id=PrevTreat style="display:none">
   <select name=ptvis134 id=ptvis134 title="%STANDARD.01.035.YE"
    class=Mandatory tabindex=23>
    <option></option>
     %PATWEB89.01.298.060.2  
   </select>
</span>
<span id=PrevTreatLblBlank style="display:none">
</span>
<span id=PrevTreatBlank style="display:none">
   <input type=hidden name=ptvis134 id=ptvis134 value="">
</span>

<span id=contrihd style="display:none">
Contract ID
</span>

<span id=contrthd style="display:none">
Contract Type
</span>

<span id=contrrhd style="display:none">
Contract Role
</span>

<span id=contrhhd style="display:none">
Contract Hospital UR
</span>

<span id=contrid style="display:none">
  <select name=ptasf003 id=ptasf003 title="Contract Id" tabindex=47>
  <option> </option>
   %PATWEB89.01.199.003
  </select>
</span>

<span id=contrtype style="display:none">
  <input type="text" name=ptasf001 id=ptasf001 size=2 maxlength=1
   value="%PATWEB89.01.199.001" tabindex=57
   title="Contract Type"
   onblur="ContType(this);">
  <img src="../images/SearchIcon.gif" class=Icon
   onclick="ContTypeAlert();">
</span>

<span id=contrrole style="display:none">
  <input type="text" name=ptasf002 id=ptasf002 size=2 maxlength=1
   value="%PATWEB89.01.199.002" tabindex=48
   title="Contract Role"
   onblur="ContRole(this);">
   <img src="../images/SearchIcon.gif" class=Icon
   onclick="ContRoleAlert();">
</span>

<span id=contrur style="display:none">
  <input type="text" name=ptvis105 id=ptvis105 size=12 maxlength=12
   value="%PATWEB89.01.298.027" tabindex=58
   title="Contract Hospital UR">
</span>

