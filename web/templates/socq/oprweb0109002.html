<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="socq">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb0109002.js"> </script>
%START.OF.PAGE
<script type="text/javascript" >
if("%STANDARD.01.025.119.182.0.1" == "1") {  // Episoft ptcnepis
  var src="../js/eAdmissionReg.js";
  var script = document.createElement("script");
               script.setAttribute("src", src);
               script.setAttribute("type", "text/javascript");
  document.getElementsByTagName("head")[0].appendChild(script);
}
function switchPresIll() {
  if (document.AddForm.presilsw.checked==true) {
    document.AddForm.operprv1.className="OECRequired";
    document.AddForm.mbsdesc1.className="OECRequired";
    document.AddForm.ptvis111.className="";
    document.AddForm.ptvis111.selectedIndex=0;
    document.AddForm.ptvis111.style.visibility="hidden";
    document.getElementById("catillab").style.display = 'none';
  } else {
    document.AddForm.operprv1.className="";
    document.AddForm.mbsdesc1.className="";
    if (!document.AddForm.ptvis111.disabled) {
      document.AddForm.ptvis111.className="OECRequired";
    }
    document.AddForm.ptvis111.style.visibility="visible";
    document.getElementById("catillab").style.display = '';
  }
}
function chkDOS(datefield) {
  if(!isWhitespace(datefield.value)){
    if(!ChkDateTime(AddForm.ptmis001,null,datefield,null)){
      alert(datefield.title+" cannot be before Admission Date");
      return false;
    }
  }
  return true;
}
function ItemCodeSearchFrame(ItemType,ItemCode,ItemDescription) {
  if (ItemType.value=="6") {
    MiscChargeSearchFrame(ItemCode,ItemDescription);
  }
  if (ItemType.value=="3") {
    MbsSearchFrame(ItemCode,ItemDescription);
  }
}
function validateItemCode(ItemType,ItemCode,ItemClam,ItemFund,ItemTabl,ItemDescription) {
  if (ItemType.value=="6") {
    validateMsc1(ItemCode,ItemClam,ItemFund,ItemTabl,ItemDescription);
  }
    if (ItemType.value=="3") {
    validateCode(4,ItemCode,ItemDescription);
  }
}
function mandatoryItemCode(ItemCode,DateofService,ServiceQuantity) {
  if(!isWhitespace(ItemCode.value)) {
    DateofService.className="Mandatory FutureDate";
    ServiceQuantity.className="Mandatory Integer";
  } else {
    DateofService.className="FutureDate";
    ServiceQuantity.className="Integer";
  }
}
function validateOECRequired(theForm) {
  for (i=0; i<theForm.elements.length; i++) {
    el=theForm.elements[i]
    if (el.className.match(/OECRequired/)) {
      if (!checkOECString(el,el.title)) {
         return false } }
    }
    if (isWhitespace(document.AddForm.patsurnm.value)) {
      alertOEC(document.AddForm.patsurnm);
      return false;
    }
    if (isWhitespace(document.AddForm.patgivnm.value)) {
      alertOEC(document.AddForm.patgivnm);
      return false;
    }
    if (isWhitespace(document.AddForm.patntdob.value)) {
      alertOEC(document.AddForm.patntdob);
      return false;
    }
    if (isWhitespace(document.AddForm.ptvis111.value) &&
        isWhitespace(document.AddForm.operprv1.value)) {
      alert("Both Presenting Illness Code and MBS Code cannot be blank.");
      return;
    }
  return true;
}
function checkOECString (theField, s, emptyOK) {
  if (checkOECString.arguments.length == 2) emptyOK = false;
   if ((emptyOK == true) && (isEmpty(theField.value))) return true;
   if (isWhitespace(theField.value))
     return warnOECEmpty (theField, s);
   else return true;
}
function warnOECEmpty (theField, s) {
  alert("Patient OEC mandatory fields are incomplete. Request Not Processed.\n"
        + s + " is a required OEC field.\nPlease enter it now." )
  theField.focus()
  return false
}
function disableOECRequired() {
  if(document.AddForm.oecchbox.checked == true) {
     AddForm.ptvis111.disabled=true;
     AddForm.ptvis043.disabled=true;
     AddForm.ptmis020.disabled=true;
     AddForm.ptmis027.disabled=true;
//     AddForm.ptmis013.disabled=true;
//     AddForm.ptmis014.disabled=true;
     AddForm.ptmis030.disabled=true;
     AddForm.ptvis076.disabled=true;
//     AddForm.ptmis015.disabled=true;
     AddForm.ptmis001.disabled=true;
     AddForm.ptmis002.disabled=true;
     AddForm.ptelg014.className="OECRequired";
     AddForm.ptelg033.className="OECRequired";
     AddForm.admdteicon.disabled=true;
     AddForm.curtimeicon.disabled=true;
     AddForm.admtmeicon.disabled=true;
     AddForm.hlthfndicon.disabled=true;
     AddForm.hlthfnderase.disabled=true;
  }
}
function OECRequired() {
  if(document.AddForm.oecchbox.checked == true) {
     if (AddForm.ptvis111.className=="Mandatory") {
       AddForm.ptvis111.className="OECRequired Mandatory";
     } else {
       AddForm.ptvis111.className="OECRequired";  //Presenting Illness
     }
     if (AddForm.ptvis043.className=="Mandatory") {
       AddForm.ptvis043.className="OECRequired Mandatory";
     } else {
       AddForm.ptvis043.className="OECRequired";  //Intended Stay
     }
     if (AddForm.ptmis020.className=="Mandatory") {
       AddForm.ptmis020.className="OECRequired Mandatory";
     } else {
       AddForm.ptmis020.className="OECRequired";  //Diagnosis
     }
     if (AddForm.ptmis027.className=="Mandatory") {
       AddForm.ptmis027.className="OECRequired Mandatory";
     } else {
       AddForm.ptmis027.className="OECRequired";  //Claim Type
     }
     if (AddForm.ptmis013.className=="Mandatory") {
       AddForm.ptmis013.className="OECRequired Mandatory";
     } else {
       AddForm.ptmis013.className="OECRequired";  //Health Fund Code
     }
     if (AddForm.ptmis014.className=="Mandatory") {
       AddForm.ptmis014.className="OECRequired Mandatory";
     } else {
       AddForm.ptmis014.className="OECRequired";  //Health Fund Code
     }
     AddForm.ptmis030.className="OECRequired Integer";    //Planned Length
     AddForm.ptvis076.className="OECRequired";            //Discharge Inten
     AddForm.ptmis015.className="OECRequired";            //Member Nunber
     AddForm.ptmis001.className="OECRequired Mandatory Date";
     AddForm.ptmis002.className="OECRequired Mandatory ";
     AddForm.ptelg014.className="OECRequired";
     AddForm.ptelg033.className="OECRequired";
  }
}
function defTypeOECFields() {
//  if (document.AddForm.adstat.value=="1") {
//    OECRequired();
//  }
  if (document.AddForm.adstat.value=="2") {
    disableOECRequired();
  } else {
    OECRequired();
  }
}
function checkTableadm() {
  if(!isWhitespace(document.AddForm.ptmis013.value)) {
    document.AddForm.ptmis014.className="Mandatory";
  } else {
    document.AddForm.ptmis014.value="";
    document.AddForm.ptmis014.className="";
    document.AddForm.tabldesc.value="";
  }
}
function defaultOECFields() {
  for (var i =0 ; i < document.AddForm.ptvis111.length; i++) {
    if (document.AddForm.ptvis111.options[i].value.substring(0,3)==
        document.AddForm.presill.value.substring(0,3)){
          document.AddForm.ptvis111.selectedIndex=i;
    }
  }
  for (var i =0 ; i < document.AddForm.ptvis043.length; i++) {
    if (document.AddForm.ptvis043.options[i].value.substring(0,3)==
        document.AddForm.intdstay.value.substring(0,3)){
          document.AddForm.ptvis043.selectedIndex=i;
    }
  }
  for (var i =0 ; i < document.AddForm.ptelg014.length; i++) {
    if (document.AddForm.ptelg014.options[i].value ==
        document.AddForm.peaindic.value){
          document.AddForm.ptelg014.selectedIndex=i;
    }
  }
  document.AddForm.ptmis030.value=document.AddForm.ploastay.value;
  for (var i =0 ; i < document.AddForm.ptelg033.length; i++) {
    if (document.AddForm.ptelg033.options[i].value ==
        document.AddForm.emeradm.value){
          document.AddForm.ptelg033.selectedIndex=i;
    }
  }
  for (var i =0 ; i < document.AddForm.ptvis076.length; i++) {
    if (document.AddForm.ptvis076.options[i].value.substring(0,3)==
        document.AddForm.disinten.value.substring(0,3)){
          document.AddForm.ptvis076.selectedIndex=i;
    }

  }
  if (!isWhitespace(document.AddForm.hlthfnd.value)) {
    document.AddForm.ptmis013.value=document.AddForm.hlthfnd.value;

  }
  validateCode(16,document.AddForm.ptmis013,document.AddForm.funddesc);
  checkTableadm();

  if (!isWhitespace(document.AddForm.hlthftbl.value)) {  
    document.AddForm.ptmis014.value=document.AddForm.hlthftbl.value;
  }

  validateHFT(20,document.AddForm.ptmis013,
                 document.AddForm.ptmis014,
                 document.AddForm.funddesc,
                 document.AddForm.tabldesc);
  document.AddForm.ptmis001.value=document.AddForm.patadmdt.value;
  document.AddForm.ptmis002.value=document.AddForm.bkrec005.value;

  if (!isWhitespace(document.AddForm.hlthfnmn.value)) {
    document.AddForm.ptmis015.value=trim(document.AddForm.hlthfnmn.value);
  }

  for (var i =0 ; i < document.AddForm.ptmis027.length; i++) {
    if (document.AddForm.ptmis027.options[i].value.substring(0,3)==
        document.AddForm.patclaim.value.substring(0,3)){
          document.AddForm.ptmis027.selectedIndex=i;
    }
  }
  document.AddForm.ptmis020.value=document.AddForm.diagno.value;
}
function ShowOECFields() {

  if (document.AddForm.oecchbox == undefined) {return;}

  if(document.AddForm.oecchbox.checked == true) {
    OECFields.innerHTML=oecfields.innerHTML;
    OECFields2.innerHTML=oecfields2.innerHTML;
    OECFields3.innerHTML=oecfields3.innerHTML;
    defaultOECFields();
    defTypeOECFields();
    if (!isWhitespace(document.AddForm.operprv1.value)) {
      document.AddForm.presilsw.checked=true;
      switchPresIll();
    }
  } else {
    OECFields.innerHTML=blanklabel.innerHTML;
    OECFields2.innerHTML=blanklabel.innerHTML;
    OECFields3.innerHTML=blanklabel.innerHTML;
    AddForm.operprv1.className="";
    AddForm.mbsdesc1.className="ReadOnly";
 
  }
}
function CheckAdmisChBox() {
//  if (document.AddForm.adstat.value!="1" &&
//      document.AddForm.adstat.value!="2") {
//    alert("Patient OEC Consent: Booking must use a current pre-admission/admission.");
//    document.AddForm.oecchbox.checked=false;
//    return;
//  }
/////////
  ShowOECFields();
}
function CheckAdmis() {
//  if (document.AddForm.adstat.value!="1" &&
//      document.AddForm.adstat.value!="2") {
//    alert("Patient OEC Consent: Booking must use a current pre-admission/admission.");
//    document.AddForm.oecchbox.checked=false;
//    return;
//  }
/////////

  validateOEC();

/////////
//  ShowOECFields();
}
function validateOECHF() {

  if (isWhitespace(document.AddForm.ptmis013.value) &&
      document.AddForm.patclaim.value.substr(3,1) == 'H' ) {

    document.AddForm.oecchbox.checked=false;
    ShowOECFields();
    return;

  }

  if (validateParticipantNoErrors(document.AddForm.ptmis013.value,"OEC")) {
//    document.AddForm.oecchbox.checked=true;
//    ShowOECFields();
//    OECRequired();
  } else {
    document.AddForm.oecchbox.checked=false;
    ShowOECFields();
//    OECRequired();
//    document.AddForm.oecchbox.disabled=true;
//    oecTitleDIV.innerHTML="";
//    oecChBoxDIV.innerHTML="";
  }

}
function validateOEC() {

  if (isWhitespace(document.AddForm.mastfnd.value) &&
      isWhitespace(document.AddForm.hlthfnd.value) &&
      document.AddForm.patclaim.value.substr(14,1) == 'P' ) {

    document.AddForm.oecchbox.checked=false;
    ShowOECFields();
    return;

  }

  if (validateParticipantNoErrors(document.AddForm.hlthfnd.value,"OEC")) {
    document.AddForm.oecchbox.checked=true;
    ShowOECFields();
//    OECRequired();
  } else {
    if (validateParticipantNoErrors(document.AddForm.mastfnd.value,"OEC")) {
      document.AddForm.oecchbox.checked=true;
      ShowOECFields();
//    OECRequired();
    } else {
      document.AddForm.oecchbox.checked=false;
      ShowOECFields();
//      OECRequired();
//      document.AddForm.oecchbox.disabled=true;
//      oecTitleDIV.innerHTML="";
//      oecChBoxDIV.innerHTML="";
    }
  }
}
function validateOECCL() {

  if (document.AddForm.oecchbox == undefined) {return};

  if (document.AddForm.ptmis013 != undefined) {
    if (isWhitespace(document.AddForm.ptmis013.value) &&
        document.AddForm.patclaim.value.substr(3,1) == 'H' ) {

      document.AddForm.oecchbox.checked=false;
      ShowOECFields();

    }
  } else {
    if (isWhitespace(document.AddForm.hlthfnd.value) &&
        document.AddForm.patclaim.value.substr(3,1) == 'H' ) {

      document.AddForm.oecchbox.checked=false;
      ShowOECFields();

    }
  }

}
function alertOEC(OECpmifield) {
  alert("Patient OEC mandatory fields are incomplete. Request Not Processed.\n"+
        OECpmifield.title+" is a required OEC PMI field.\n"+
        "Please enter it now.");
}
//------------------------------------------------------------
// Validate Operation Duration Average
//------------------------------------------------------------
function validateOprDurAve(ReturnCode,ReturnDoct,ReturnName) {
  if (isWhitespace(ReturnCode.value)) return;;
  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=78" +
                    "&valdcode=" + ReturnCode.value.replace(/ /g,"+") +
                    "&valddoct=" + ReturnDoct.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
    if (!isWhitespace(ReturnValue[0])) {
        ReturnName.value=trim(ReturnValue[0])
    }
    return true;
  } else {
    ReturnCode.select();
    ReturnCode.focus();
    return false;
  }
}
function RemoveQuote(Field) {
    Field.value=Field.value.replace(/\"/g,"");
}
function changeOperation(theForm) {   
for (var i = 0; i < theForm.operpref.length; i++) {
 if (theForm.operpref.options[i].selected == true) {
  theForm.elements["operdes1"].value=theForm.operpref.options[i].text }
 }
}
function changeAdmitDate(theForm) {   
for (var i = 0; i < theForm.patadmdt.length; i++) {
 if (theForm.patadmdt.options[i].selected == true) {
  theForm.elements["operdes3"].value="Admit:"+theForm.patadmdt.options[i].text }
  }
}
function Check(){

 if (document.AddForm.oecchbox != undefined) {
   if (document.AddForm.oecchbox.checked==true) {
     if (!validateOECRequired(document.AddForm)) {
       return;
     }
     if (!validateParticipant(document.AddForm.ptmis013.value,"OEC")) {
       return;
     }
   }
 }

 if(!validateMandatory(AddForm)) 
   return; 
 AddForm.bkrec006.disabled=false
 AddForm.bkrec007.disabled=false
 AddForm.patadmdt.disabled=false
 AddForm.bkrec005.disabled=false
//
 if(!CheckBookDate()) {
   return;
 }
//
  if (AddForm.oes01007!=undefined) {
    if (!chkDOS(AddForm.oes01007)) {
      return;
    }
    if (!chkDOS(AddForm.oes02007)) {
      return;
    }
    if (!chkDOS(AddForm.oes03007)) {
      return;
    }
    if (!chkDOS(AddForm.oes04007)) {
      return;
    }
    if (!chkDOS(AddForm.oes05007)) {
      return;
    }
  }
//
var timecalc = parseInt(AddForm.operexpd.value) + 
                parseInt(AddForm.sesendtm.value) +
                parseInt(AddForm.sesprptm.value)
if (timecalc > AddForm.sesdurtm.value) {
   if(confirm("Session will be Overbooked, Ok to Continue")) {
       formSubmit();
       }
   else document.CancelBook.submit();
    }
else formSubmit();
}
function chkDOL() {
if(!isWhitespace(AddForm.listdate.value)){
  if(!ChkDateTime(AddForm.listdate,null,AddForm.patadmdt,null)){
      alert("Confirmed admission date cannot be before Date on List");}
  }
}

function formSubmit() {
if(!isWhitespace(AddForm.listdate.value)){
  if(!ChkDateTime(AddForm.listdate,null,AddForm.patadmdt,null)){
      alert("Confirmed admission date cannot be before Date on List");
      return;}
 }
 if(isWhitespace(AddForm.patadmdt.value)) {
        if(document.getElementById("ptcnepis").value=="1" &&
            typeof eAdmCookie != 'undefined' && eAdmCookie!="unknown" &&
            !isWhitespace(AddForm.admisnid.value)) {
              document.AddForm.nextlink.value=eAdmCookie;
        } else {
            CaseList=GetContentCookie("CasePath");
            if (CaseList!="unknown") {
              AddForm.nextlink.value=CaseList;
            }
        }
        AddForm.submit();
        return;
 }
 if(ChkDateTime(AddForm.patadmdt,null,AddForm.bookdate,null)){
    if(document.getElementById("ptcnepis").value=="1" &&
          typeof eAdmCookie != 'undefined' && eAdmCookie!="unknown" &&
          !isWhitespace(AddForm.admisnid.value)) {
            document.AddForm.nextlink.value=eAdmCookie;
      } else {
        CaseList=GetContentCookie("CasePath");
        if (CaseList!="unknown") {
          AddForm.nextlink.value=CaseList;
        }
      }
        if (document.AddForm.oecchbox != undefined) {
          if(document.AddForm.oecchbox.checked == true) {

            if (trim(document.AddForm.ptmis013.defaultValue) !=
                trim(document.AddForm.ptmis013.value) ||
                trim(document.AddForm.ptmis014.defaultValue) !=
                trim(document.AddForm.ptmis014.value) ||
                trim(document.AddForm.ptmis015.defaultValue) !=
                trim(document.AddForm.ptmis015.value)) {

              if(confirm("Update Patient Master File Health Fund Details?")) {

                document.AddForm.ptmis013.disabled=false;
                document.AddForm.ptmis014.disabled=false;
                document.AddForm.ptmis015.disabled=false;

                document.AddForm.oecmindc.value="1";
              }

            }

            document.AddForm.bokrx039.value="1";
          } else {
            document.AddForm.bokrx039.value="0";
          }
        }
        AddForm.submit(); }
 else {
       alert("Theatre Booking cannot be before Admission Date");
  }
}
function setCombo(){
  MenuOver(AddForm.operknow);
}
function checkWatEntry(){
   if (AddForm.bkrec006.value != "") {
     AddForm.bkrec006.disabled=true
     AddForm.bokrx002.focus()
   }else {
     AddForm.bkrec006.focus()
   }
   if (AddForm.bkrec007.value != "") {
     AddForm.bkrec007.disabled=true
   }
   if (AddForm.patadmdt.value != "") {
     AddForm.patadmdt.disabled=true
   }
   if (AddForm.bkrec005.value != "") {
     AddForm.bkrec005.disabled=true
   }
  AddForm.watread1.disabled=true;
}
function DisableIcon(field) {
  if (field.disabled == true) {
    alert(field.title+" is for display only")
    AddForm.bokrx002.focus()
  }
}
// Check if booking date is in the past (warning)
function CheckBookDate(){
      var strtDay  = document.AddForm.bookdate.value.substring(0,2);
      var strtMon  = document.AddForm.bookdate.value.substring(3,6);
      var strtYear = document.AddForm.bookdate.value.substring(7,11);
      strtMon = GetMonthNumber(strtMon);

      var strtDate = strtYear + strtMon + strtDay
      if(!CheckFuture(strtDate)){
        if(!confirm("Warning: Booking date is prior to current date.")){
          return false;
        }
      }
      return true;
}
function valClaimCode() {
  if (document.AddForm.patclaim.value=="") {
  validateCode(41,AddForm.urnumber,AddForm.claimc);
  for (var i =0 ; i < document.AddForm.patclaim.length; i++) {
    if (document.AddForm.claimc.value==
        trim(document.AddForm.patclaim.options[i].value.substr(0,3))){
          document.AddForm.patclaim.selectedIndex=i;
    }
  }
 }
}
function ShowMBSFields1() {
  if (document.AddForm.mbsbox1.checked == true) {
    ExtraMBS1.innerHTML=extrambs1.innerHTML;
  } else {
    ExtraMBS1.innerHTML=blanklabel.innerHTML;
  }
}
function ShowMBSFields2() {
  if (document.AddForm.mbsbox2.checked == true) {
    ExtraMBS2.innerHTML=extrambs2.innerHTML;
    document.AddForm.mbsbox1.disabled = true;
  } else {
    ExtraMBS2.innerHTML=blanklabel.innerHTML;
    document.AddForm.mbsbox1.disabled = false;
  }
}
function portalBooking() {
  if(document.getElementById("ptcnepis").value=="1") { // Episoft ptcnepis
    OnlinePreadmission();
    eAdmPreList();
  }
}
function clrCookieReturn() {
  if(document.getElementById("ptcnepis").value=="1" &&
     typeof eAdmCookie != 'undefined' && eAdmCookie!="unknown" &&
     !isWhitespace(document.AddForm.admisnid.value)) {
     document.AddForm.showflag.value = "1";
     getTop().content.location.href=eAdmCookie;
  } else {
    window.history.go(-1);
  }
}
function checkOECParameter() {
  if (document.AddForm.ptcnoect.value != "1") {
    oecTitleDIV.innerHTML="";
    oecChBoxDIV.innerHTML="";
  }

  CheckAdmis();

}
</script>
</head>
<body onload="PageLoad(event);checkWatEntry();
              setCombo();
              GetTheatreRequestCookies();
              ChkInp();valClaimCode();
              setTimeout('portalBooking()',700);
              selectOptions2('31',AddForm.bkrec015,AddForm.bkrec018);
              selectOptions2('31',AddForm.bokrx002,AddForm.bokrx038);
              checkOECParameter();">
<div id=PageHeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB01.09.003";
PatientVIS="%OPRWEB01.09.081";
PatientNAM="%OPRWEB01.09.002";
PatientSTA="%OPRWEB01.09.086.078";
PatientALT="%OPRWEB01.09.084";
PatientSEX="%OPRWEB01.09.019";
PatientDOB="%OPRWEB01.09.020";
PatientAGE="%OPRWEB01.09.021";
PatientLOC="%OPRWEB01.09.083";
PatientPRI="%OPRWEB01.09.086.066.1";
PatientUNT="%OPRWEB01.09.066.0";
DoctorCOD="%OPRWEB01.09.082.003";
DoctorNAM="%OPRWEB01.09.082.002";
PatientAID="%OPRWEB01.09.086.090";
PatientIND="%OPRWEB01.09.086.091";
PatientCUR="%OPRWEB01.09.086.092";
PatientCLC="%OPRWEB01.09.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB01.09.086.094";
PatientCDM="%OPRWEB01.09.086.095";
PatientVDH="%OPRWEB01.09.086.099.015";
InsertPatientHeader()
</script>

<div id=PatientMenu></div>
</div>
<div id=PageBodySection>

<form name=AddForm  method=post action=oprweb01.pbl>
<input type=hidden name=reportno value=10>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%OPRWEB01.09.003">
<input type=hidden name=admissno value="%OPRWEB01.09.081">
<input type=hidden name=nextlink value="%OPRWEB01.09.102.oprweb01.03.003">
<input type=hidden name=bkrec008 value="THE">
<input type=hidden name=sesskeys value="%OPRWEB01.09.101">
<input type=hidden name=wattrkey value="%OPRWEB01.09.301">
<input type=hidden name=casekeys value="%OPRWEB01.09.301">
<input type=hidden name=bookdate value="%OPRWEB01.09.202">
<input type=hidden name=admisnum >
<input type=hidden name=ptcnubap value="%STANDARD.01.025.114.086.0.1">
<input type=hidden name=admndate value="%OPRWEB01.09.702">
<input type=hidden name=admntime value="%OPRWEB01.09.703">
<input type=hidden name=bkrec002 value="%OPRWEB01.09.204.003">
<input type=hidden name=sesdurtm value="%OPRWEB01.09.209">
<input type=hidden name=sesprptm value="%OPRWEB01.09.211">
<input type=hidden name=sesendtm value="%OPRWEB01.09.218">
<!--<input type=hidden name=ptmis027 value="%OPRWEB01.09.726.1">--> 
<input type=hidden name=ptmis068 value="%OPRWEB01.09.705.1">
<!--<input type=hidden name=ptvis043 value="%OPRWEB01.09.729">-->
<input type=hidden name=ptmis009 value="%OPRWEB01.09.710.1">
<input type=hidden name=ptmis010 value="%OPRWEB01.09.711.1">
<input type=hidden name=admpoint value="%OPRWEB01.09.503.1">
<input type=hidden name=listdate value="%OPRWEB01.09.309">
<input type=hidden name=caretype value="%OPRWEB01.09.713.3">
<input type=hidden name=ptcnhdps value="%OPRWEB01.09.801">
<input type=hidden name=currflag value="%OPRWEB01.09.802">
<input type=hidden name=claimc>
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect >
<input type="hidden" name="ptcnepis" id="ptcnepis"
 value="%STANDARD.01.025.119.182.0.1" />
<input type=hidden name=admisnid id=admisnid value="%OPRWEB01.09.820">
<input type=hidden name=showflag value="0">
<input type=hidden name=ptcndwaw value="">
  <input type=hidden name=admstats value="%OPRWEB01.09.799. 20">
  <input type=hidden name=adstat>
  <input type=hidden name=intdstay>
  <input type=hidden name=disinten>
  <input type=hidden name=diagno>
  <input type=hidden name=peaindic>
  <input type=hidden name=emeradm>
  <input type=hidden name=hlthfnd>
  <input type=hidden name=hlthftbl>
  <input type=hidden name=hlthfnmn>

  <input type=hidden name=mastfnd value="%OPRWEB01.09.040.0">
  <input type=hidden name=mastftbl value="%OPRWEB01.09.041.0">
  <input type=hidden name=mastfnmn value="%OPRWEB01.09.042">

  <input type=hidden name=ploastay>
  <input type=hidden name=bokrx039>
  <input type=hidden name=presill>
  <input type="hidden" name="patsurnm"
         title="Patient Surname" value="%OPRWEB01.09.009">
  <input type="hidden" name="patgivnm"
         title="Patient Given Name" value="%OPRWEB01.09.010">
  <input type="hidden" name="patntdob"
         title="Patient Date of Birth" value="%OPRWEB01.09.020">
  <input type="hidden" name="medicrdn"
         title="Medicare Card Number" value="%OPRWEB01.09.027">
  <input type="hidden" name="medicrdr"
         title="Medicare Card Reference Number" value="%OPRWEB01.09.085.049">
<input type=hidden name=ptcnoect value="%STANDARD.01.025.128.196.0.1">
<input type=hidden name=oecmindc value=" ">
<input type=hidden name=bkthvick value=" ">
<input type=hidden name=bkthrdck value=" ">
<input type=hidden name=requestn value=" ">
<input type=hidden name=thetrqin id=thetrqin value=" ">
<input type=hidden name=thetrqvl id=thetrqvl value=" ">

<table border="0" cellpadding="1" cellspacing="0" width="100%">
<tr><td align=center class=HeadingCell>Theatre Booking Form</td></tr>
</table>

<table border="0" cellpadding="1" cellspacing="0" width="95%" align=center>
<tr><td width=15% class=DataLabel>Surgeon   </td>
    <td ><a href='javascript:DoctorViewFrame("%OPRWEB01.09.204.003")'>
         <b>%OPRWEB01.09.204.002 &nbsp; </a></td>
    <td width=10%>Anaesthetist   </td>
    <td><a href='javascript:DoctorViewFrame("%OPRWEB01.09.216.003")'>
         %OPRWEB01.09.216.002</a></td></tr>
<tr><td class=DataLabel>Unit</td>
    <td class=DataField>%OPRWEB01.09.213  </td></tr>

<tr><td width=15% class=DataLabel>Theatre  </td>
    <td class=DataField> %OPRWEB01.09.214.0 </td>
    <td class=DataLabel>Session Type</td>
    <td class=DataField>%OPRWEB01.09.269.0  </td></tr>

<tr><td class=DataLabel>Date  </td>
    <td class=DataField>%OPRWEB01.09.206 %OPRWEB01.09.202</td>
    <td class=DataLabel>Time  </td>
    <td class=DataField> %OPRWEB01.09.203 to %OPRWEB01.09.208</td></tr>

<tr><td colspan=4 align=center><hr width=100%></td></tr>

  <tr><td class=DataLabel></td>
      <td></td>
    <td><div id="oecTitleDIV"><strong>Patient OEC Consent</strong></div></td>
    <td><div id="oecChBoxDIV"><input type="checkbox" name="oecchbox" value="0"
                  onclick='CheckAdmisChBox();'></div></td>
  </tr>

<tr><td class=DataLabel>Pre-Admission</td>
    <td class=DataLabel>
    <input type=text name=bkrec006 size=12 maxlength=11 class=""
     onblur="checkDate(this,'Date')"
     title="Pre-Admission Date" value="%OPRWEB01.09.327">
    <img src=../images/DateLookup.gif border=0 hspace=4 align=absmiddle
    onclick='javascript:DateLookupFrame(AddForm.bkrec006)'
     onFocus='javascript:DisableIcon(AddForm.bkrec006)' tabindex=-1>
    Time
    <input type=text name=bkrec007 size=7 class="" 
     title="Pre-Admission Time" value="%OPRWEB01.09.428">
    <img src=../images/DateTimeStamp.gif  border=0 hspace=4 align=absmiddle
    onclick='javascript:SetCurrentDateTime(AddForm.bkrec006,AddForm.bkrec007)'
     onFocus='javascript:DisableIcon(AddForm.bkrec007)' tabindex=-1> 
    <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle
    onclick='javascript:TimeLookupFrame(AddForm.bkrec007)'
    onFocus='javascript:DisableIcon(AddForm.bkrec007)' tabindex=-1> 
    </td>
    <td class=DataLabel>Confirmed Admission</td>
    <td class=DataLabel>
     <input type=text name=patadmdt size=12 maxlength=11 class=Mandatory
     onblur="checkDate(this,'Date');chkDOL();"
     title="Admission Date" value="%OPRWEB01.09.506">
    <img src=../images/DateLookup.gif border=0 hspace=4 align=absmiddle
     onclick='javascript:DateLookupFrame(AddForm.patadmdt)'
     onFocus='javascript:DisableIcon(AddForm.patadmdt)' tabindex=-1>
    Time
    <input type=text name=bkrec005 size=6
            title="Admission Time" class=Mandatory>
    <img src=../images/DateTimeStamp.gif  border=0 hspace=4 align=absmiddle
     onclick='javascript:SetCurrentDateTime(AddForm.patadmdt,AddForm.bkrec005)'
     onFocus='javascript:DisableIcon(AddForm.bkrec005)'>
    <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle
    onclick='javascript:TimeLookupFrame(AddForm.bkrec005)'
     onFocus='javascript:DisableIcon(AddForm.bkrec005)'>
    </td></tr>

<tr><td class=DataLabel>Pre-Admission Status</td>
    <td class=DataField>
    <select name=watread1 title="Pre-Admission Status">
     <option></option>
     %OPRWEB01.09.412.2
     </select></td>
    <td class=DataLabel>Proposed Admission</td>
    <td class=DataLabel>
     <input type=text name=watread2 size=12 maxlength=11
     class=Readonly readonly onblur="checkDate(this,'Date')"
     title="Proposed Admission Date" value="%OPRWEB01.09.311">
    </td></tr>

<tr><td class=DataLabel>Admitting Point</td>
    <td class=DataField>
    <select name=bokrx003 title="Admitting Point"  class=Mandatory>
    <option></option>
    %OPRWEB01.09.406.2
    </select></td>
    <td class=DataLabel>Proposed Operation</td>
    <td class=DataLabel>
     <input type=text name=watread3 size=12 maxlength=11
     class=Readonly readonly onblur="checkDate(this,'Date')"
     title="Proposed Operation Date" value="%OPRWEB01.09.335"></td></tr>

<tr><td class=DataLabel>Expected Ward</td>
    <td>
    <select name=bkrec015 title="Expected Ward"
     onchange="selectOptions2('31',AddForm.bkrec015,AddForm.bkrec018);">
    <option></option>
    %OPRWEB01.09.405.2
    </select>
    Bed
    <select name=bkrec018 title="Expected Bed" >
    <option></option>
    </select>
    </td>
    <td class=DataLabel>Exp.Post Op Ward</td>
    <td>
    <select name=bokrx002 title="Exp.Post Op Ward"
     onchange="selectOptions2('31',AddForm.bokrx002,AddForm.bokrx038);">
    <option></option>
    %OPRWEB01.09.405.2
    </select>
    Bed
    <select name=bokrx038 title="Expected Post-Op Bed">
    <option></option>
    </select>
    </td></tr>

<tr><td class=DataLabel>Intended Length of Stay </td>
    <td class=DataLabel>
    <input type=text name=bkrec033 size=4 maxlength=3 class=Integer
    value=%OPRWEB01.09.316 title="Intended Length of Stay">(days)</td>
     <td class=DataLabel>Admission Source</td>
     <td class=DataField>
     <select name="opdea037" title="Admission Source" class=Mandatory >
     <option></option>
     %OPRWEB01.09.655.2
     </select></td>

    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.A </td>
    <td class=DataField>
    <select name=bkrec020 title="%STANDARD.01.017.A ">
    <option></option>
    %STANDARD.01.007.A 
    </select></td>
    <td class=DataLabel>Operating Unit</td>
    <td class=DataField>
    <select name=opdea036 title="Operating Unit" class="Mandatory">
    <option></option>
     %OPRWEB01.09.213.2
    </select></td>
 </tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField>
    <select name="patclaim" title="Ins Class" class=Mandatory 
     onchange='validateOECCL();'>
     <option></option>
     %OPRWEB01.09.115.9.1.10.2.X
     </select></td>
    <td class=DataLabel> Duration </td>
    <td><input type=text name="operexpd" size=6 maxlength=4 min=0
             title="Operation Expected Duration" class="Mandatory Integer">
        (minutes)
    </td>

</tr>

<tr><td class=DataLabel>Anaesthetic Type</td>
    <td><select name="operanae" 
             title="Anaesthetic"
             class=Mandatory>
    <option></option>
    %OPRWEB01.09.106.2
    </select></td>
    <td class=DataLabel> Blood Type </td>
    <td><select name="bokrx032" 
             title="Blood Type">
    <option></option>
    %OPRWEB01.09.532.2
    </select>
    </td>
</tr>

<!-- Transport code (OR) is used for Booking Type -->
<tr><td class=DataLabel>Booking Type</td>
    <td><select name="opertran" 
             title="Booking Type"
             class=Mandatory>
    <option></option>
    %OPRWEB01.09.108.2
    </select></td>
    <td class=DataLabel>Operation Type</td>
    <td><select name="opertype" 
             title="Operation Type"
             class=Mandatory>
    <option></option>
    %OPRWEB01.09.107.2
    </select></td>
</tr>

<tr><td class=DataLabel>MBS Codes</td>
    <td><input type=text name=operprv1 size=9 value="%OPRWEB01.09.303"
           onblur='validateCode(4,
                                AddForm.operprv1,
                                AddForm.mbsdesc1,
                                AddForm.bookdate);
           validateOprDurAve(operprv1,bkrec002,operexpd);'
           title="Expected MBS Item 1" >
        <input type=text readonly name=mbsdesc1 size=30 class=Readonly
           title="Expected MBS Item 1 Name" tabindex=-1
              value="%OPRWEB01.09.306" >
     <img src="../images/SearchIcon.gif" class=Icon
     onclick="MbsSearchFrame(AddForm.operprv1,
                             AddForm.mbsdesc1,
                             AddForm.bookdate)"></td>
    <td class=DataLabel>Infection Status </td>
    <td><select name="operknow" 
             title="Infection Status">
    <option></option>
    %OPRWEB01.09.640.2
    </select>
    </td></tr>

<tr><td></td><td><input type=text name=operprv2 size=9
           onblur='validateCode(4,
                                AddForm.operprv2,
                                AddForm.mbsdesc2,
                                AddForm.bookdate)'
           title="Expected MBS Item 2" >
    <input type=text readonly name=mbsdesc2 size=30 class=Readonly
           title="Expected MBS Item 2 Name" tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="MbsSearchFrame(AddForm.operprv2,
                             AddForm.mbsdesc2,
                             AddForm.bookdate)"></td>
    <td class=DataLabel>Equipment Required 1</td>
    <td><select name="opdea032" 
             title="Equipment Required 1">
    <option></option>
    %OPRWEB01.09.645.2
    </select>
    </td></tr>

<tr><td></td><td><input type=text name=operprv3 size=9
           onblur='validateCode(4,
                                AddForm.operprv3,
                                AddForm.mbsdesc3,
                                AddForm.bookdate)'
           title="Expected MBS Item 3" >
    <input type=text readonly name=mbsdesc3 size=30 class=Readonly
           title="Expected MBS Item 3 Name" tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="MbsSearchFrame(AddForm.operprv3,
                             AddForm.mbsdesc3,
                             AddForm.bookdate)"></td>
    <td class=DataLabel>Equipment Required 2</td>
    <td><select name="opdea033" 
             title="Equipment Required 2">
    <option></option>
    %OPRWEB01.09.646.2
    </select>
    </td></tr>

  <tr><td>&nbsp;</td>
      <td><input type=text name=operprv4 size=9 title="Expected MBS Item 4"
           onblur='validateCode(4,
                                AddForm.operprv4,
                                AddForm.mbsdesc4,
                                AddForm.bookdate)'>
          <input type=text class=Readonly readonly name=mbsdesc4 size=30
           title="Expected MBS Item 4 Name">
          <img src="../images/SearchIcon.gif" class=Icon
           border=0 hspace=0 align=absmiddle
           onclick="MbsSearchFrame(AddForm.operprv4,
                                   AddForm.mbsdesc4,
                                   AddForm.bookdate)"></td>
    <td class=DataLabel>Equipment Required 3</td>
    <td><select name="opdea035"
             title="Equipment Required 3">
    <option></option>
    %OPRWEB01.09.649.2
    </select>
    </td>
          </tr>

   <tr><td>&nbsp;</td>
       <td><input type=text name=operprv5 size=9 title="Expected MBS Item 5"
            onblur='validateCode(4,
                                 AddForm.operprv5,
                                 AddForm.mbsdesc5,
                                 AddForm.bookdate)'>
           <input type=text class=Readonly readonly name=mbsdesc5 size=30
            title="Expected MBS Item 5 Name">
           <img src="../images/SearchIcon.gif" class=Icon
            border=0 hspace=0 align=absmiddle
            onclick="MbsSearchFrame(AddForm.operprv5,
                                    AddForm.mbsdesc5,
                                    AddForm.bookdate)"></td>
     <td class=DataLabel>Equipment Loaned</td>
    <td><select name="opdea034"
             title="Equipment Loaned">
    <option></option>
    %OPRWEB01.09.647.2
    </select>
    </td>
          </tr>

<tr valign=top>
    <td class=DataLabel>Full Description</td>
    <td><input type="text" size="45" maxlength=80 name="operdes1" 
           value="%OPRWEB01.09.306" 
           title="Operation Description 1" onblur="RemoveQuote(this);"></td>
    </tr>


<tr><td></td><td><input type="text" size="45" maxlength=80 name="operdes2" 
           title="Operation Description 2" onblur="RemoveQuote(this);"></td>
    </tr>


<tr><td></td><td><input type="text" size="45" maxlength=80 name="operdes3" 
           title="Operation Description 2" onblur="RemoveQuote(this);"></td>
    <td class=DataLabel>&nbsp; </td>
    <td class=DataField>&nbsp; </td>
    </tr>

<tr><td class=DataLabel>Prosthesis Required</td>
    <td> <input type="text" size="45" maxlength=40 name="opercomm" 
           title="Prosthesis Comment " > </td>
    <td class=DataLabel>Date Booking Keyed        </td>
    <td class=DataField><input type=text size=12 name=bkrec034 class=Mandatory
        title="Date Booking Keyed" value="%STANDARD.01.015">
        <img notab src=../images/DateLookup.gif border=0 hspace=4
        align=absmiddle onclick="DateLookupFrame(AddForm.bkrec034);">
        </td></tr>
<tr><td class=DataLabel>Comments</td>
    <td>
<textarea wrap=hard cols=60 rows=3 name=opcom009>%OPRWEB01.09.643.009</textarea>
    </td>
   <td colspan=2 valign=top><div id=OECFields3></div></td>
   </tr>

   <tr><td colspan=4><div id=OECFields></div></td></tr>

  <tr><td>Show Extra MBS Codes
          <input type="checkbox" name="mbsbox1" value="0"
                 onclick="ShowMBSFields1();"></td>
      <td class=DataLabel></td>
      <td></td></tr>

  <tr><td colspan=4><div id=ExtraMBS1></div></td></tr>
  <tr><td colspan=4><div id=ExtraMBS2></div></td></tr>

   <tr><td colspan=4 align=center><div id=OECFields2></div></td></tr>

<tr><td colspan=4>&nbsp;</td></tr>

<tr><td colspan=4 align="center">
  <input type=button id="opr01sub" class="button" value="Ok"
  onclick="tempDisable(this);Check();">
  <input type=button class="button" value="Cancel"
   onclick="clrCookieReturn();">
    </td></tr>
</table>
</form>
</div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=9>
<input type=hidden name=template value=002>
<input type=hidden name=urnumber value="%OPRWEB01.09.003">
<input type=hidden name=admissno value="%OPRWEB01.09.081">
<input type=hidden name=MenuType value="%OPRWEB01.09.088">
<input type=hidden name=casekeys value="%OPRWEB01.09.101">
<input type=hidden name=sesskeys value="%OPRWEB01.09.101">
</form>

<form name=CancelBook method=get>
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=003>
<input type=hidden name=sesskeys value="%OPRWEB01.09.101">
</form>

<form name=LinkForm method=get action=oprweb02.pbl>
<input type=hidden name=reportno value=03>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value="%OPRWEB01.09.003">
<input type=hidden name=admissno value="%OPRWEB01.09.081">
</form>

<span id=extrambs1 style="display:none">
 <table border="0" cellpadding="1" cellspacing="0" width="100%">

  <tr align=left>
     <td align=center colspan="4"><hr></td></tr>

   <tr><td class=DataLabel width=30%></td>
       <td width=5%>MBS Item</td><td><input type=text name=operprv6 id=operprv6 size=9
            onblur='validateCode(4,
                                 AddForm.operprv6,
                                 AddForm.mbsdesc6,
                                 AddForm.bookdate)'
            title="Expected MBS Item 6" >
           <input type=text readonly name=mbsdesc6 id=mbsdesc6 size=30
            class=Readonly
            title="Expected MBS Item 6 Name" tabindex=-1>
           <img src="../images/SearchIcon.gif" class=Icon
            onclick="MbsSearchFrame(AddForm.operprv6,
                                    AddForm.mbsdesc6,
                                    AddForm.bookdate)"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td>&nbsp;</td>
       <td width=5%>MBS Item</td><td><input type=text name=operprv7 id=operprv7 size=9
            onblur='validateCode(4,
                                 AddForm.operprv7,
                                 AddForm.mbsdesc7,
                                 AddForm.bookdate)'
            title="Expected MBS Item 7" >
           <input type=text readonly name=mbsdesc7 id=mbsdesc7 size=30
            class=Readonly
            title="Expected MBS Item 7 Name" tabindex=-1>
           <img src="../images/SearchIcon.gif" class=Icon
            onclick="MbsSearchFrame(AddForm.operprv7,
                                    AddForm.mbsdesc7,
                                    AddForm.bookdate)"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td>&nbsp;</td>
       <td width=5%>MBS Item</td><td><input type=text name=operprv8 id=operprv8 size=9
            onblur='validateCode(4,
                                 AddForm.operprv8,
                                 AddForm.mbsdesc8,
                                 AddForm.bookdate)'
            title="Expected MBS Item 8" >
           <input type=text readonly name=mbsdesc8 id=mbsdesc8 size=30
            class=Readonly
            title="Expected MBS Item 8 Name" tabindex=-1>
           <img src="../images/SearchIcon.gif" class=Icon
            onclick="MbsSearchFrame(AddForm.operprv8,
                                    AddForm.mbsdesc8,
                                    AddForm.bookdate)"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td>&nbsp;</td>
       <td width=5%>MBS Item</td><td><input type=text name=operprv9 id=operprv9 size=9
            onblur='validateCode(4,
                                 AddForm.operprv9,
                                 AddForm.mbsdesc9,
                                 AddForm.bookdate)'
            title="Expected MBS Item 9" >
           <input type=text readonly name=mbsdesc9 id=mbsdesc9 size=30
            class=Readonly
            title="Expected MBS Item 9 Name" tabindex=-1>
           <img src="../images/SearchIcon.gif" class=Icon
            onclick="MbsSearchFrame(AddForm.operprv9,
                                    AddForm.mbsdesc9,
                                    AddForm.bookdate)"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td>&nbsp;</td>
       <td width=5%>MBS Item</td><td><input type=text name=operpr10 id=operpr10 size=9
            onblur='validateCode(4,
                                 AddForm.operpr10,
                                 AddForm.mbsdes10,
                                 AddForm.bookdate)'
            title="Expected MBS Item 10" >
           <input type=text readonly name=mbsdes10 id=mbsdes10 size=30
            class=Readonly
            title="Expected MBS Item 10 Name" tabindex=-1>
           <img src="../images/SearchIcon.gif" class=Icon
            onclick="MbsSearchFrame(AddForm.operpr10,
                                    AddForm.mbsdes10,
                                    AddForm.bookdate)"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td>&nbsp;</td>
       <td colspan=2>Show Extra MBS Codes
           <input type="checkbox" name="mbsbox2" id="mbsbox2" value="0"
                  onclick='ShowMBSFields2();'></td>
       <td >&nbsp;</td></tr>

 </table>
</span>

<span id=extrambs2 style="display:none">
 <table border="0" cellpadding="1" cellspacing="0" width="100%">
  <tr><td class=DataLabel width=30%></td>

      <td width=5%>MBS Item</td><td><input type=text name=operpr11 size=9 title="Expected MBS Item 11"
           onblur="validateCode(4,
                                AddForm.operpr11,
                                AddForm.mbsdes11,
                                AddForm.bookdate)">
           <input type=text class=Readonly readonly name=mbsdes11 size=30
            title="Expected MBS Item 1 Name">
           <img src="../images/SearchIcon.gif" class=Icon
            border=0 hspace=0 align=absmiddle
            onclick="MbsSearchFrame(AddForm.operpr11,
                                    AddForm.mbsdes11,
                                    AddForm.bookdate)"></td>
      <td colspan=2>&nbsp;</td></tr>

  <tr><td>&nbsp;</td>
      <td width=5%>MBS Item</td><td><input type=text name=operpr12 size=9 title="Expected MBS Item 12"
           onblur="validateCode(4,
                                AddForm.operpr12,
                                AddForm.mbsdes12,
                                AddForm.bookdate)">
          <input type=text class=Readonly readonly name=mbsdes12 size=30
           title="Expected MBS Item 12 Name">
           <img src="../images/SearchIcon.gif" class=Icon
            border=0 hspace=0 align=absmiddle
            onclick="MbsSearchFrame(AddForm.operpr12,
                                    AddForm.mbsdes12,
                                    AddForm.bookdate)"></td>
      <td colspan=2>&nbsp;</td></tr>

  <tr><td>&nbsp;</td>
      <td width=5%>MBS Item</td><td><input type=text name=operpr13 size=9 title="Expected MBS Item 13"
           onblur="validateCode(4,
                                AddForm.operpr13,
                                AddForm.mbsdes13,
                                AddForm.bookdate)">
          <input type=text class=Readonly readonly name=mbsdes13 size=30
           title="Expected MBS Item 13 Name">
           <img src="../images/SearchIcon.gif" class=Icon
            border=0 hspace=0 align=absmiddle
            onclick="MbsSearchFrame(AddForm.operpr13,
                                    AddForm.mbsdes13,
                                    AddForm.bookdate)"></td>
      <td colspan=2>&nbsp;</td></tr>

  <tr><td>&nbsp;</td>
      <td width=5%>MBS Item</td><td><input type=text name=operpr14 size=9 title="Expected MBS Item 14"
           onblur="validateCode(4,
                                AddForm.operpr14,
                                AddForm.mbsdes14,
                                AddForm.bookdate)">
          <input type=text class=Readonly readonly name=mbsdes14 size=30
           title="Expected MBS Item 14 Name">
           <img src="../images/SearchIcon.gif" class=Icon
            border=0 hspace=0 align=absmiddle
            onclick="MbsSearchFrame(AddForm.operpr14,
                                    AddForm.mbsdes14,
                                    AddForm.bookdate)"></td>
      <td colspan=2>&nbsp;</td></tr>

  <tr><td>&nbsp;</td>
      <td width=5%>MBS Item</td><td><input type=text name=operpr15 size=9 title="Expected MBS Item 15"
           onblur="validateCode(4,
                                AddForm.operpr15,
                                AddForm.mbsdes15,
                                AddForm.bookdate)">
          <input type=text class=Readonly readonly name=mbsdes15 size=30
           title="Expected MBS Item 15 Name">
           <img src="../images/SearchIcon.gif" class=Icon
            border=0 hspace=0 align=absmiddle
            onclick="MbsSearchFrame(AddForm.operpr15,
                                    AddForm.mbsdes15,
                                    AddForm.bookdate)"></td>
      <td colspan=2>&nbsp;</td></tr>
 </table>
</span>

<span id=oecfields style="display:none">
 <table border="0" cellpadding="1" cellspacing="0" width="100%">
  <tr><td width=15%>&nbsp;</td>
      <td width=49%>&nbsp;</td>
      <td width=10%>&nbsp;</td>
      <td>&nbsp;</td></tr>

  <tr><td class=DataLabel></td>
      <td></td>
      <td class=DataLabel>Health Fund </td>
      <td colspan=2>
         <input type=text size=6 maxlength=6 name=ptmis013
                title="Health Fund" value="%OPRWEB01.09.040.0"
                onblur="validateCode(16,document.AddForm.ptmis013,funddesc);
                checkTableadm();validateOECHF();">
          <input type=text size=25 maxlength=30 name=funddesc class=readonly
                  Readonly></td></tr>

  <tr><td class=DataLabel> Member Number </td>
      <td><input type=text size=20 maxlength=19 name=ptmis015
           value="%OPRWEB01.09.042"
           title="Member Number"></td>
      <td>Level of Insurance</td>
          <td><input name="ptmis014" size=8 maxlength=8 title="Level"
                 value="%OPRWEB01.09.041.0"
                 onblur="validateHFT(20,ptmis013,ptmis014,funddesc,tabldesc);">
          <input type="text" size=15 maxlength=17 name="tabldesc"
                 class=readonly Readonly>
            <img src=../images/SearchIcon.gif class=Icon
                 border=0 hspace=0 align=absmiddle name=hlthfndicon
                 onclick="HealthFundSearchFrame(ptmis013,funddesc,
                                                ptmis014,tabldesc);">
            <img src="../images/erase.gif" align=absmiddle name=hlthfnderase
                 onclick="clrDoc(ptmis013,ptmis014);clrDoc(funddesc,tabldesc);
                  checkTableadm();"></td></tr>

  <tr><td class=DataLabel>Diagnosis </td>
      <td><input type=text name="ptmis020" size=50 maxlength=80
                 title="Diagnosis"></td>
     <td class=DataLabel><b> PEA Indicator </b></td>
     <td><select name=ptelg014 title="PEA Indicator">
          <option value="0">No</option>
          <option value="1">Yes</option>
         </select></td></tr>

  <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
      <td><select name=ptmis027 title="%STANDARD.01.017.CL">
            <option> </option>
              %STANDARD.01.007.CL
              </select></td>
       <td class=DataLabel><b> Emergency Admission </b></td>
       <td><select name=ptelg033 title="Emergency Admission">
            <option value="0">No</option>
            <option value="1">Yes</option>
           </select></td></tr>

  <tr><td></td>
      <td align=right>
       <b>Switch to MBS Presenting Illness Number</b>
          <input type="checkbox" name="presilsw" value="1"
                 title="Presenting Illness MBS"
                 onclick="switchPresIll();"> &nbsp;
                 </td>
      <td class=DataLabel><b><div id=catillab>  %STANDARD.01.017.il </div></b></td>
      <td><select name=ptvis111  title="%STANDARD.01.017.il">
           <option> </option>
             %STANDARD.01.007.il
          </select></td>
  </tr>

 </table>
</span>

<span id=oecfields2 style="display:none">
 <table border=0 colspan=0 width=80% cellspacing=0 cellpadding=1>

  <tr align=left>
     <td align=center colspan="4"><hr></td></tr>

  <tr><td colspan=4>&nbsp;</td></tr>

  <tr><td><b>Date</b></td>
      <td><b>Type</b></td>
      <td><b>Item / Description</b></td>
      <td><b>Quantity</b></td></tr>

  <tr><td width=20%>
         <input type=text size=12 name=oes01007 id=oes01007
                class="FutureDate" title="OES Service 1 Date"
                onblur=checkDate(this,this.title);>
           <img src=../images/DateTimeStamp.gif border=0 hspace=4
                align=absmiddle onclick="SetCurrentDateTime(AddForm.oes01007,null);">
           <img src=../images/DateLookup.gif border=0 hspace=4
               align=absmiddle onclick="DateLookupFrame(AddForm.oes01007);"></td>
      <td width=12%>
          <select name=oes01004 title="Type"
                 onchange="clrFields(oes01005,d_oes01005);
                 mandatoryItemCode(document.AddForm.oes01005,
                                   document.AddForm.oes01007,
                                   document.AddForm.oes01006);">
           <option value="6">Misc.Item</option>
           <option value="3">MBS Item</option>
          </select></td>
      <td><input type=text name=oes01005 title="Item Code" size=10
                 maxlength=10
                 onblur="validateItemCode(document.AddForm.oes01004,
                                          document.AddForm.oes01005,
                                          document.AddForm.ptmis027,
                                          document.AddForm.ptmis013,
                                          document.AddForm.ptmis014,
                                          document.AddForm.d_oes01005);
                 mandatoryItemCode(this,document.AddForm.oes01007,
                                        document.AddForm.oes01006);
                 document.AddForm.oes01006.value=1;
                 justifyRight(document.AddForm.oes01006);">
          <input type=text name=d_oes01005 size=50 readonly
                 class=Readonly tabindex=-1 title="Item Description">
            <img src="../images/SearchIcon.gif" class=Icon
                 onclick="ItemCodeSearchFrame(document.AddForm.oes01004,
                                              document.AddForm.oes01005,
                                              document.AddForm.d_oes01005);">
            <img src="../images/erase.gif"
                  onclick="clrFields(oes01005,d_oes01005);
                  mandatoryItemCode(document.AddForm.oes01005,
                                    document.AddForm.oes01007,
                                    document.AddForm.oes01006);"></td>
      <td><input type=text name=oes01006 title="Quantity" size=5 maxlength=3
                 onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
           </td></tr>

  <tr><td><input type=text size=12 name=oes02007 id=oes02007
                 class="FutureDate" title="OES Service 2 Date"
                 onblur=checkDate(this,this.title);>
            <img src=../images/DateTimeStamp.gif border=0 hspace=4
                 align=absmiddle onclick="SetCurrentDateTime(AddForm.oes02007,null);">
            <img src=../images/DateLookup.gif border=0 hspace=4
                 align=absmiddle onclick="DateLookupFrame(AddForm.oes02007);"></td>
      <td><select name=oes02004 title="Type"
                  onchange="clrFields(oes02005,d_oes02005);
                  mandatoryItemCode(document.AddForm.oes02005,
                                    document.AddForm.oes02007,
                                    document.AddForm.oes02006);">
           <option value="6">Misc.Item</option>
           <option value="3">MBS Item</option>
          </select></td>
      <td><input type=text name=oes02005 title="Item Code" size=10 maxlength=10
                 onblur="validateItemCode(document.AddForm.oes02004,
                                          document.AddForm.oes02005,
                                          document.AddForm.ptmis027,
                                          document.AddForm.ptmis013,
                                          document.AddForm.ptmis014,
                                          document.AddForm.d_oes02005);
                 mandatoryItemCode(this,document.AddForm.oes02007,
                                        document.AddForm.oes02006);
                                        document.AddForm.oes02006.value=1;
                 justifyRight(document.AddForm.oes02006);">
          <input type=text name=d_oes02005 size=50 readonly
                 class=Readonly tabindex=-1 title="Item Description">
            <img src="../images/SearchIcon.gif" class=Icon
                 onclick="ItemCodeSearchFrame(document.AddForm.oes02004,
                                              document.AddForm.oes02005,
                                              document.AddForm.d_oes02005);">
           <img src="../images/erase.gif" onclick="clrFields(oes02005,d_oes02005);
                mandatoryItemCode(document.AddForm.oes02005,
                                  document.AddForm.oes02007,
                                  document.AddForm.oes02006);"></td>
      <td><input type=text name=oes02006 title="Quantity" size=5 maxlength=3
                 onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
          </td></tr>

  <tr><td><input type=text size=12 name=oes03007 id=oes03007
                 class="FutureDate" title="OES Service 3 Date"
                 onblur=checkDate(this,this.title);>
            <img src=../images/DateTimeStamp.gif border=0 hspace=4
                 align=absmiddle onclick="SetCurrentDateTime(AddForm.oes03007,null);">
            <img src=../images/DateLookup.gif border=0 hspace=4
                 align=absmiddle onclick="DateLookupFrame(AddForm.oes03007);"></td>
      <td><select name=oes03004 title="Type"
                  onchange="clrFields(oes03005,d_oes03005);
                  mandatoryItemCode(document.AddForm.oes03005,
                                    document.AddForm.oes03007,
                                    document.AddForm.oes03006);">
           <option value="6">Misc.Item</option>
           <option value="3">MBS Item</option>
          </select></td>
      <td><input type=text name=oes03005 title="Item Code" size=10 maxlength=10
                 onblur="validateItemCode(document.AddForm.oes03004,
                                          document.AddForm.oes03005,
                                          document.AddForm.ptmis027,
                                          document.AddForm.ptmis013,
                                          document.AddForm.ptmis014,
                                          document.AddForm.d_oes03005);
                 mandatoryItemCode(this,document.AddForm.oes03007,
                                        document.AddForm.oes03006);
                                        document.AddForm.oes03006.value=1;
                justifyRight(document.AddForm.oes03006);">
         <input type=text name=d_oes03005 size=50 readonly
                class=Readonly tabindex=-1 title="Item Description">
           <img src="../images/SearchIcon.gif" class=Icon
                onclick="ItemCodeSearchFrame(document.AddForm.oes03004,
                                             document.AddForm.oes03005,
                                             document.AddForm.d_oes03005);">
           <img src="../images/erase.gif" onclick="clrFields(oes03005,d_oes03005);
                mandatoryItemCode(document.AddForm.oes03005,
                                  document.AddForm.oes03007,
                                  document.AddForm.oes03006);"></td>
      <td><input type=text name=oes03006 title="Quantity" size=5 maxlength=3
                 onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
          </td></tr>

  <tr><td><input type=text size=12 name=oes04007 id=oes04007
                 class="FutureDate" title="OES Service 4 Date"
                 onblur=checkDate(this,this.title);>
            <img src=../images/DateTimeStamp.gif border=0 hspace=4
                 align=absmiddle onclick="SetCurrentDateTime(AddForm.oes04007,null);">
            <img src=../images/DateLookup.gif border=0 hspace=4
                 align=absmiddle onclick="DateLookupFrame(AddForm.oes04007);"></td>
      <td><select name=oes04004 title="Type"
                  onchange="clrFields(oes04005,d_oes04005);
                  mandatoryItemCode(document.AddForm.oes04005,
                                    document.AddForm.oes04007,
                                    document.AddForm.oes04006);">
           <option value="6">Misc.Item</option>
           <option value="3">MBS Item</option>
          </select></td>
      <td><input type=text name=oes04005 title="Item Code" size=10 maxlength=10
                 onblur="validateItemCode(document.AddForm.oes04004,
                                          document.AddForm.oes04005,
                                          document.AddForm.ptmis027,
                                          document.AddForm.ptmis013,
                                          document.AddForm.ptmis014,
                                          document.AddForm.d_oes04005);
                 mandatoryItemCode(this,document.AddForm.oes04007,
                                        document.AddForm.oes04006);
                                        document.AddForm.oes04006.value=1;
                justifyRight(document.AddForm.oes04006);">
         <input type=text name=d_oes04005 size=50 readonly
                class=Readonly tabindex=-1 title="Item Description">
           <img src="../images/SearchIcon.gif" class=Icon
                onclick="ItemCodeSearchFrame(document.AddForm.oes04004,
                                             document.AddForm.oes04005,
                                             document.AddForm.d_oes04005);">
           <img src="../images/erase.gif" onclick="clrFields(oes04005,d_oes04005);
                mandatoryItemCode(document.AddForm.oes04005,
                                  document.AddForm.oes04007,
                                  document.AddForm.oes04006);"></td>
      <td><input type=text name=oes04006 title="Quantity" size=5 maxlength=3
                 onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
          </td></tr>

  <tr><td><input type=text size=12 name=oes05007 id=oes05007
                 class="FutureDate" title="OES Service 5 Date"
                 onblur=checkDate(this,this.title);>
            <img src=../images/DateTimeStamp.gif border=0 hspace=4
                 align=absmiddle onclick="SetCurrentDateTime(AddForm.oes05007,null);">
            <img src=../images/DateLookup.gif border=0 hspace=4
                 align=absmiddle onclick="DateLookupFrame(AddForm.oes05007);"></td>
      <td><select name=oes05004 title="Type"
                  onchange="clrFields(oes05005,d_oes05005);
                  mandatoryItemCode(document.AddForm.oes05005,
                                    document.AddForm.oes05007,
                                    document.AddForm.oes05006);">
           <option value="6">Misc.Item</option>
           <option value="3">MBS Item</option>
          </select></td>
      <td><input type=text name=oes05005 title="Item Code" size=10 maxlength=10
                 onblur="validateItemCode(document.AddForm.oes05004,
                                          document.AddForm.oes05005,
                                          document.AddForm.ptmis027,
                                          document.AddForm.ptmis013,
                                          document.AddForm.ptmis014,
                                          document.AddForm.d_oes05005);
                 mandatoryItemCode(this,document.AddForm.oes05007,
                                        document.AddForm.oes05006);
                                        document.AddForm.oes05006.value=1;
                justifyRight(document.AddForm.oes05006);">
          <input type=text name=d_oes05005 size=50 readonly
                 class=Readonly tabindex=-1 title="Item Description">
            <img src="../images/SearchIcon.gif" class=Icon
                 onclick="ItemCodeSearchFrame(document.AddForm.oes05004,
                                              document.AddForm.oes05005,
                                              document.AddForm.d_oes05005);">
            <img src="../images/erase.gif" onclick="clrFields(oes05005,d_oes05005);
                 mandatoryItemCode(document.AddForm.oes05005,
                                   document.AddForm.oes05007,
                                   document.AddForm.oes05006);"></td>
      <td><input type=text name=oes05006 title="Quantity" size=5 maxlength=3
                 onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
          </td></tr>
 </table>
</span>

<span id=oecfields3 style="display:none">
 <table border=0 colspan=0 width=80% cellspacing=0 cellpadding=1>
   <tr>
      <td class=DataLabel width=35%>Admission Date </td>
      <td><input type=text size=12 name=ptmis001 id=ptmis001
                 class="Mandatory Date" title="Admission Date">
            <img src=../images/DateLookup.gif border=0 hspace=4
                 align=absmiddle onclick="DateLookupFrame(AddForm.ptmis001);"
                 name=admdteicon>
          Time
          <input class=Mandatory type=text name=ptmis002 id=ptmis002 size=8
                 title="Admission Time">
            <img src=../images/DateTimeStamp.gif border=0 hspace=4
                 align=absmiddle onclick="SetCurrentDateTime(null,AddForm.ptmis002);"
                 name=curtimeicon>
            <img src=../images/TimeLookup.gif border=0 hspace=4
                 align=absmiddle
                 onclick="TimeLookupFrame(ptmis002);" name=admtmeicon></td>
   </tr>
  <tr>
<td class=DataLabel> Planned Length of Stay</td>
       <td><input type=text size=5 maxlength=5 name=ptmis030
                  title='Planned Length of Stay'
                  class=Integer onblur="checkInteger(this,this.value);">
       &nbsp; %STANDARD.01.017.VI &nbsp;
          <select name=ptvis043 title="%STANDARD.01.017.VI">
           <option> </option>
             %STANDARD.01.007.VI
          </select></td>
  </tr>
  <tr>
<td class=DataLabel>Discharge Intention</td>
      <td><select name=ptvis076 title="Discharge Intention">
           <option> </option>
             %STANDARD.01.007.KN
          </select></td>
  </tr>
 </table>
</span>

<span id=blanklabel style="display:none">&nbsp;</span>

<script type="text/javascript" >
for (var i =0 ; i < document.AddForm.bokrx002.length; i++) {
     if (document.AddForm.bokrx002.options[i].value=="%OPRWEB01.09.405.1") {
         document.AddForm.bokrx002.selectedIndex=i } };

//alert("a"+%OPRWEB01.09.305+"b")
for (var i =0 ; i < document.AddForm.operexpd.length; i++) {
x=trim(document.AddForm.operexpd.options[i].value)
     if (x==trim(%OPRWEB01.09.305)){
         document.AddForm.operexpd.options[i].selected=true;
         break;} };

function AdmissionLinkSearchFrame(urnumb,session,RETadmis,RETdate,RETtime,
                                  RETacare,RETaclaim){
 DFrameStart();
  window.urnumber=urnumb;
  window.sesskeys=session; 
  document.getElementById('PopUpFrame').src="../lookups/AdmissionLinkSearchFrame.html";
  SearchFrameShow();
}

function ChkInp() {
 if (AddForm.currflag.value=="2") {
   if(confirm("Use the current Admission or Create a new booking\n" +
              "   Ok to use the Current, Cancel to Create New")) {
  AdmissionLinkSearchFrame(AddForm.urnumber,AddForm.sesskeys,AddForm.admissno,
                           AddForm.admndate,AddForm.admntime);
   return;
   }
  }
  if (AddForm.currflag.value!="1") {
     return; }
  if (AddForm.admissno.value=="") {
     return; }
  if(confirm("Use the current Admission or Create a new booking\n" +
           "   Ok to use the Current, Cancel to Create New")) {
    if(document.AddForm.ptcnhdps.value=="3"){
      if(document.AddForm.caretype.value.substr(14,1)!="4"&&
         document.AddForm.caretype.value.substr(14,1)!="5"&&
         document.AddForm.caretype.value.substr(14,1)!="8"){
         alert("Unable to use the current admission, invalid care type.")
         return; }
      }
   defaultAdmission();
  }
}
function defaultAdmission(){
   AddForm.admisnum.value=AddForm.admissno.value
   AddForm.patadmdt.value=AddForm.admndate.value
   AddForm.bkrec005.value=AddForm.admntime.value
   AddForm.adstat.value=AddForm.admstats.value;
//Intended Length of Stay
//AddForm.bkrec033.value=AddForm.ptvis043.value
//Financial Class
//   for (var i =0 ; i < document.AddForm.patclaim.length; i++) {
//     if (document.AddForm.patclaim.options[i].value.substr(0,3)==document.AddForm.ptmis027.value.substr(0,3)) {
//         document.AddForm.patclaim.selectedIndex=i } };
//Admitting Point
   for (var i =0 ; i < document.AddForm.bokrx003.length; i++) {
     if (document.AddForm.bokrx003.options[i].value.substr(0,3)==document.AddForm.admpoint.value.substr(0,3)) {
         document.AddForm.bokrx003.selectedIndex=i } };
//Expected Ward  
   for (var i =0 ; i < document.AddForm.bokrx002.length; i++) {
     if (document.AddForm.bokrx002.options[i].value.substr(0,3)==document.AddForm.ptmis068.value.substr(0,3)) {
         document.AddForm.bokrx002.selectedIndex=i } };
//Admission Source  
   for (var i =0 ; i < document.AddForm.opdea037.length; i++) {
     if (document.AddForm.opdea037.options[i].value.substr(0,3)==document.AddForm.ptmis009.value.substr(0,3)) {
         document.AddForm.opdea037.selectedIndex=i } };
//Admission Type (Cat. A )
   for (var i =0 ; i < document.AddForm.bkrec020.length; i++) {
     if (document.AddForm.bkrec020.options[i].value.substr(0,3)==document.AddForm.ptmis010.value.substr(0,3)) {
         document.AddForm.bkrec020.selectedIndex=i } };
}
</script>
