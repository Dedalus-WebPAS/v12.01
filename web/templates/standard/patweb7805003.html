<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function chkEndTime() {
  if (!isWhitespace(UpdateForm.ptven005.value)) {
    UpdateForm.ptven004.className="Mandatory PastDate";
    if (isWhitespace(UpdateForm.ptven004.value)) {
      UpdateForm.ptven004.focus();
    }
  } else {
    UpdateForm.ptven004.className="PastDate";
  }
}
function chkEndDate() {
  if (!isWhitespace(UpdateForm.ptven004.value)) {
    UpdateForm.ptven005.className="Mandatory";
  }
  else {
    UpdateForm.ptven005.className="";
  }
}
function SubmitForm() {
   chkEndDate();
   chkEndTime();

   if(!validateMandatory(UpdateForm))
     return;   

   var strtDay = UpdateForm.ptven002.value.substring(0,3);
   var endDay  = UpdateForm.ptven004.value.substring(0,3);
   var strtMon = UpdateForm.ptven002.value.substring(3,6);
   var endMon  = UpdateForm.ptven004.value.substring(3,6);
   var strtYear= UpdateForm.ptven002.value.substring(7,11);
   var endYear = UpdateForm.ptven004.value.substring(7,11);
   var strtMonNum;
   var endMonNum;
   var strtDateStr;
   var endDateStr;

   strtMonNum = GetMonthNumber(strtMon);
   endMonNum  = GetMonthNumber(endMon);
   strtDateStr = strtYear + strtMonNum + strtDay;
   endDateStr  = endYear + endMonNum + endDay;

  if (!isWhitespace(UpdateForm.ptven004.value) &&
      !isWhitespace(UpdateForm.ptven005.value)) {

   /*
   if (strtDateStr > endDateStr) {
     UpdateForm.ptven004.focus();
     alert("End Date must be greater than Start Date");
     return;
      }
   else {
     if (strtDateStr == endDateStr) {
       CalcDura(UpdateForm.ptven003,UpdateForm.ptven005,UpdateForm.duration);
       if (UpdateForm.duration.value < 0) {
         UpdateForm.ptven004.focus();
         alert("End Time must be greater than Start Time");
         return;
       }
     }
   }
   */

    if (strtDateStr == endDateStr) {
      CalcDura(UpdateForm.ptven003,UpdateForm.ptven005,UpdateForm.duration);
      if (UpdateForm.duration.value < 0) {
        UpdateForm.ptven004.focus();
        alert("End Time must be greater than Start Time");
        return;
      }
    }
    else if (strtDateStr > endDateStr) {
      UpdateForm.ptven004.focus();
      alert("End Date must be greater than Start Date");
      return;
    }
  }
  UpdateForm.updttype.value="U"
  UpdateForm.submit();
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
 Ventilation Times
</span>

<div id=PageBodySection style="overflow: auto;">
<form  name=UpdateForm method=post action=patweb78.pbl style="margin:0">
<input type=hidden name=reportno value="5">
<input type=hidden name=template value="003">
<input type=hidden name=updttype value="">
<input type=hidden name=urnumber value="%PATWEB78.05.003">
<input type=hidden name=admissno value="%PATWEB78.05.081">
<input type=hidden name=ptven001 value="%PATWEB78.05.201.1">
<input type=hidden name=startdat value="%PATWEB78.05.202.1">
<input type=hidden name=ptven002 value="%PATWEB78.05.202.0">
<input type=hidden name=ptven003 value="%PATWEB78.05.203">
<input type=hidden name=duration value="">

<table align=center width=95% border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel>Ventilation Type</td>
    <td><input type=text name=d_ptven001 class="Readonly" readonly size=20
         title="Ventilation Type" value="%PATWEB78.05.201.0">

<tr><td class=DataLabel>Start Date</td>
    <td><input type=text name=d_ptven002 class="Readonly" readonly size=12
         title="Start Date" value="%PATWEB78.05.202.0">

<tr><td class=DataLabel>Start Time</td>
    <td><input type=text name=d_ptven003 class="Readonly" readonly size=8
         title="Start Time" value="%PATWEB78.05.203">

<tr><td colspan="4"><hr></td></tr>

<tr><td class=DataLabel>End Date</td>
    <td class=DataField><input type=text size=12 maxlength=12 width=30% 
        name=ptven004 title="End Date" value="%PATWEB78.05.204"
        tabindex=4 onchange="chkEndDate();" class=PastDate>
       <img src="../images/DateLookup.gif" class=Icon
       onclick="DateLookupFrame(UpdateForm.ptven004);">
     </td></tr>

<tr><td class=DataLabel>End Time</td>
    <td class=DataField><input type=text size=8 maxlength=8 width=30% 
        name=ptven005 title="End Time" value="%PATWEB78.05.205"
        tabindex=5 onchange="chkEndTime();">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,UpdateForm.ptven005);chkEndTime();">
      <img src="../images/TimeLookup.gif" class=Icon 
       onclick="TimeLookupFrame(UpdateForm.ptven005);">
     </td></tr>

<tr><td class=DataLabel>ICU Status</td>
    <td class=DataField><select name=ptven007 tabindex=7 
        class="SelectBig" title="ICU Status">
        <option> </option>
        %PATWEB78.05.207.2
        </select></td></tr>

<tr><td class=DataLabel>Initiation Site</td>
    <td class=DataField><select name=ptven008 tabindex=8 
        class="SelectBig" title="Initiation Status">
        <option> </option>
        %PATWEB78.05.208.2
        </select></td></tr>
</table>

<table cellspacing=0 cellpadding=1 border=0 width=95% align=center>
<tr>
  <td colspan=3 align=center><br>
   <input type=button class="button" value="Update" name=UpdButtn
    onclick="tempDisable(this);SubmitForm();">
   <input type=button class="button" value="Delete" onclick="setFormactn('D');">
   <input type=button value=Close class="button" onclick="DFrameClose();">
  </td>
</tr>
</table>
</form>
</div>

