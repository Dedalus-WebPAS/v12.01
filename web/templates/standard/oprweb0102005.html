<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/TableSort.js></script>
<script type="text/javascript">
function updateParent(code,disp,finaldate) {

 if (!isWhitespace(finaldate)) {
   alert("ERROR - Session is finalised - No new bookings can be made.\n" +
         "Please reset to Provisional to make changes to this session.");
   return;
 }
// 
// assign parent.parent when sjog-standard is running & parent when standard
//
p=parent;
   if (parent.parent.document.getElementById("sessidisp")) {
      p=parent.parent;
   }
    p.UpdateForm.sessidisp.value=disp;
    p.UpdateForm.newsessi.value=code;
//  
//  Set focus to the first input field on the parent page
//
    FirstField=true
    for (var e = 0; e < p.UpdateForm.elements.length; e++) {
      var el=p.UpdateForm.elements[e] ;
      if (el.type != "hidden" && !el.readOnly && !el.disabled) {
        if (FirstField) {
          FirstField=false
          el.focus()
        } 
      }
    }
    DFrameExit()
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link   
//  1 - Session Date & Time
//  2 - Surgeon
//  3 - Anaesthetist
//  4 - Theatre
//  5 - Session Type
//  6 - Status
//  7 - Booking Graph 0 - 120
//  8 - Available Min
//  9 - Booked Min
// 10 - Actual Min
//---------------------------------------------------------------------------
function InitTable(TableView) {
 t = new Table(1,0,2,"100%","center",35,36);
 t.addColumn("Session","DateTime",1,1,"left","AppointmentIcon.gif","0",130)
 t.addColumn("Surgeon","String",2,2,"left","","",135)
 t.addColumn("Anaesthetist","String",3,3,"left","","",135)
 t.addColumn("Theatre","String",4,4,"left","","",135)
 t.addColumn("Bookings","String",11,11,"left","","",55)
 AddTableRows()
 TableOutput(1,2);

/*
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",25,25);
 t.addColumn("Session","DateTime",1,1,"left","AppointmentIcon.gif","0",140)
 t.addColumn("Anaesthetist","String",3,3,"left","","",150)
 t.addColumn("Theatre","String",4,4,"left","","",150)
 t.addColumn("Status","Graph",7,7,"left","bar1.gif","",120)
 AddTableRows()
 TableOutput(1,2);
 break; }
case 1: {
 t = new Table(1,0,2,"100%","center",35,25);
 t.addColumn("Session","DateTime",1,1,"left","AppointmentIcon.gif","0",140)
 t.addColumn("Anaesthetist","String",3,3,"left","","",150)
 t.addColumn("Theatre","String",4,4,"left","","",150)
 t.addColumn("Avail. Op Min","String",8,8,"right","","",45)
 t.addColumn("Booked Op Min","String",9,9,"right","","",45)
 t.addColumn("Actual Op Min","String",10,10,"right","","",45)
 AddTableRows()
 TableOutput(1,2);
 break; }
case 2: {
 t = new Table(1,0,2,"100%","center",35,25);
 t.addColumn("Session","DateTime",1,1,"left","AppointmentIcon.gif","0",140)
 t.addColumn("Surgeon","String",2,2,"left","","",150)
 t.addColumn("Anaesthetist","String",3,3,"left","","",150)
 t.addColumn("Theatre","String",4,4,"left","","",150)
 AddTableRows()
 TableOutput(1,2);
 break; }
 }
*/
}
function TableOutput(OrderColumn,AscDsc) {
  if ((window.navigator.userAgent.indexOf("MSIE 6.0")>=1
      || window.navigator.userAgent.indexOf("MSIE 7.0")>=1)
      && window.navigator.userAgent.indexOf("compatible")<0) {
      showTableFilterSearch=false;
   }
lastOrderColumn=OrderColumn;
if (t.rows.length != 0 ) {
   t.sortTable(OrderColumn,AscDsc);
   TableHeading(OrderColumn);
   TableBody();
   if (t.tableTotals.length != 0 ) {
      TableTotals(); }
   TableEnding(); }
else {
   TableHeading(OrderColumn);
   TableEnding(); }

  if (document.all.BodyDivision!=undefined) {
     BodyDivision.style.height=document.body.clientHeight - 65 -
                               BodyDivision.offsetTop
  }

}
</script>
</head>
%START.OF.PAGE
<body onload=PageLoad(event);InitTable(1);>
<div id=HeadingSection>
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Theatre Session Search
</span>

  <form name=SelectPeriod action=oprweb01.pbl method=get>
  <input type=hidden name=reportno value=2>
  <input type=hidden name=template value=5>
  <input type=hidden name=viewtype value="%OPRWEB01.02.011">
<table cellpadding=3 cellspacing=0 bgcolor=#CCCCCC border=0 width=100%>
<tr>
  <td width=25%>Unit&nbsp;
  <select id=docttype name=docttype onchange=SelectPeriod.submit(this)>
  <option value="   ">All</option>
  %OPRWEB01.02.013
  </select>
  </td>
  <td>Doctor&nbsp;
    <select name=doctcode id=doctcode title="Doctor"
     onchange=SelectPeriod.submit(this)>
  <option value="  ">All</option>
  %OPRWEB01.02.012
  </select>
  </td>
  <td colspan=5 align=right>
  <input type=button value="<<" class=SmallButton
  onclick='location.href="%OPRWEB01.02.002"'>
  %OPRWEB01.02.007
  <input type=button value=">>" class=SmallButton
  onclick='location.href="%OPRWEB01.02.001"'>
  </td>
  <td align="right">
  <a href='javascript:SelectDateFrame();'>
  <img src="../images/DateLookup.gif" class=Icon
   alt="Select Date" align=absmiddle></a>
  <a href='javascript:SelectView("0");'>
  <img src=../images/DayIcon.gif class=Icon
   alt="View Today" align=absmiddle></a>
  <a href='javascript:SelectView("1");'>
  <img src=../images/WeekIcon.gif class=Icon
   alt="View This Week" align=absmiddle></a>
  <a href='javascript:SelectView("2");'>
  <img src=../images/MonthIcon.gif class=Icon
   alt="View This Month" align=absmiddle></a>
  </td>
  </tr>

</table>
  </form>
</div>

<div id=TableLocation></div>
<script type="text/javascript">
function AddTableRows() {
%OPRWEB01.02.021.oprweb01.03.003
}
</script>
