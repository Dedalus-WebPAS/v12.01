<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript" src="../js/patweb98.js"></script>
<script type="text/javascript">
function SelectSubmit() {
   document.SelectPeriod.submit();
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link                   
//  1 - Visit Number
//  2 - Visit Date
//  3 - Discharge Date
//  4 - Visit Desc
//  5 - Ward
//  6 - Doctor
//  7 - Admission Type (CMBS Class)
//  8 - Claim Type
//  9 - Coded
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 document.title="Discharged Inpatient Admissions"
 t = new Table(1,0,2,"100%","center",35,35);
//
 if(document.SelectPeriod.mrcnepsc.value=="1") {
   t.addColumn("Visit No","Number",41,41,"left","EditIcon.gif","0",65,"","","",54)
 } else {
   t.addColumn("Visit No","Number",1,1,"left","EditIcon.gif","0",65,"","","",54)
 }
//
 if(document.SelectPeriod.ibcnmhos.value=="1") {
   t.addColumn("Hospital","String",35,35,"left","","",40,"","","",54)
 }
//
 if(document.SelectPeriod.mrcnepsc.value=="1") {
     t.addColumn("Care Type","String",42,42,"left","","",50,"","","",54)
     t.addColumn("Admission","String",37,38,"left","","",100,"","","",54)
     t.addColumn("Discharge","String",39,40,"left","","",90,"","","",54)
 } else {
     t.addColumn("Admission","DateTime",2,2,"left","","",100,"","","",54)
     t.addColumn("Discharge","DateTime",36,36,"left","","",90,"","","",54)
 }
//
 t.addColumn("Unit","String",10,10,"left","","",50,"","","",54)
 t.addColumn("Coded","Image",9,9,"center","CodedIcon","",30,"","","",54)
 t.addColumn("Coder Id","String",27,27,"left","","",50,"","","",54)
 t.addColumn("Coding","Date",25,25,"left","","",65,"","","",54)
 t.addColumn("Coder Snag","String",24,24,"left","","",50,"","","",54)
 t.addColumn("Audit Date","Date",32,32,"left","","",65,"","","",54)
 t.addColumn("Volume","String",26,26,"center","","",30,"","","",54)
 AddTableRows()
  if (document.SelectPeriod.mrcnepsc.value=="0") {
   if (document.SelectPeriod.ibcnmhos.value=="0") {
     TableOutput(1,2);    // Order Column,Asc Dsc
   } else {
     TableOutput(2,2);    // Order Column,Asc Dsc
   }
 } else {
   if (document.SelectPeriod.ibcnmhos.value=="0") {
     TableOutput(2,2);    // Order Column,Asc Dsc
   } else {
     TableOutput(3,2);    // Order Column,Asc Dsc
   }
 }
 break; }
case 1: {
 document.title="Discharged Inpatient Admissions"
 t = new Table(1,0,2,"100%","center",35,35);
 t.addColumn("Visit No","Number",1,1,"left","EditIcon.gif","0",65,"","","",54)
//
 if(document.SelectPeriod.ibcnmhos.value=="1") {
   t.addColumn("Hospital","String",35,35,"left","","",40,"","","",54)
 }
//
 if(document.SelectPeriod.mrcnepsc.value=="1") {
     t.addColumn("Care Type","String",42,42,"left","","",50,"","","",54)
     t.addColumn("Admission","String",37,38,"left","","",100,"","","",54)
     t.addColumn("Discharge","String",39,40,"left","","",90,"","","",54)
 } else {
     t.addColumn("Admission","DateTime",2,2,"left","","",100,"","","",54)
     t.addColumn("Discharge","DateTime",36,36,"left","","",90,"","","",54)
 }
//
 t.addColumn("Unit","String",10,10,"left","","",85,"","","",54)
 t.addColumn("Diagnosis","String",21,21,"left","","",120,"","","",54)
 t.addColumn("Coding","Date",25,25,"left","","",65,"","","",54)
 t.addColumn("Coder Id","String",27,27,"left","","",50,"","","",54)
 AddTableRows()
 if (document.SelectPeriod.mrcnepsc.value=="0") {
   if (document.SelectPeriod.ibcnmhos.value=="0") {
     TableOutput(1,2);    // Order Column,Asc Dsc
   } else {
     TableOutput(2,2);    // Order Column,Asc Dsc
   }
 } else {
   if (document.SelectPeriod.ibcnmhos.value=="0") {
     TableOutput(2,2);    // Order Column,Asc Dsc
   } else {
     TableOutput(3,2);    // Order Column,Asc Dsc
   }
 }
 break; }
 }
}
</script>
<script type="text/javascript">
function linkPatient(Urnumber,VisitNo,VisitType,SecOpt,Casekeys,Site,
         AAEFlag,EVNTFlag,Episode,Emvisite,NoAccDsc) {
  if (VisitType=="3") {
    if(!isWhitespace(NoAccDsc)) {
      alert(NoAccDsc);
      return;
    }
    p=document.PatientLinks
    document.PatientLinks.admissno.value=VisitNo
    document.PatientLinks.epscd001.value=Episode
    validateThis2(2,p.admissno,p.epscd001,p.dum,p.dum,p.dum,p.dum,p.dum,p.dum,
                 p.dum,p.dum,p.dum,p.EpsFlag,p.EpsNo);
    if(p.EpsFlag.value=="1") {
       ServerPage="mrtweb02.pbl?reportno=01&template=001"
       location.href=ServerPage +
          "&urnumber="+document.PatientLinks.urnumber.value.replace(/ /g,"+") +
          "&admissno="+document.PatientLinks.admissno.value.replace(/ /g,"+") +
          "&epscd001="+document.PatientLinks.EpsNo.value; }
    else {
       ServerPage="mrtweb02.pbl?reportno=03&template=001"
       location.href=ServerPage +
          "&urnumber="+document.PatientLinks.urnumber.value.replace(/ /g,"+") +
          "&admissno="+document.PatientLinks.admissno.value.replace(/ /g,"+") +
          "&epscd001="+document.PatientLinks.EpsNo.value; }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);">
<div id=HeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB98.01.003";
PatientVIS="%PATWEB98.01.081";
PatientNAM="%PATWEB98.01.002";
PatientSTA="%PATWEB98.01.086.078";
PatientALT="%PATWEB98.01.084";
PatientSEX="%PATWEB98.01.019";
PatientDOB="%PATWEB98.01.020";
PatientAGE="%PATWEB98.01.021";
PatientLOC="%PATWEB98.01.083";
PatientPRI="%PATWEB98.01.086.066.1";
PatientUNT="%PATWEB98.01.066.0";
DoctorCOD="%PATWEB98.01.082.003";
DoctorNAM="%PATWEB98.01.082.002";
PatientAID="%PATWEB98.01.086.090";
PatientIND="%PATWEB98.01.086.091";
PatientCUR="%PATWEB98.01.086.092";
PatientCLC="%PATWEB98.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB98.01.086.094";
PatientCDM="%PATWEB98.01.086.095";
PatientVDH="%PATWEB98.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>

<form name=SelectPeriod action=patweb98.pbl method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=039>
<input type=hidden name=urnumber value="%PATWEB98.01.003">
<input type=hidden name=admissno value="%PATWEB98.01.081">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=mrcnepsc value="%STANDARD.01.025.060.133.1.1">

<table cellpadding=3 bgcolor=#CCCCCC border=0 width=100%>
<tr><td>
    <a href="javascript:InitTable(0)">
    <img src='../images/TableViewIcon.gif' class=Icon
     alt="Default View"></a>
    <a href="javascript:InitTable(1)">
    <img src='../images/TableViewIcon.gif' class=Icon
     alt="Show Diagnosis"></a></td>
    <td>Coder Snags
 <select name=pmsvx044 class=SelectMed onchange=SelectSubmit()>
 <option value=" ">All</option>
  %PATWEB98.01.816
 </select></td>

 <td class=DataLabel align=right>Incomplete Coded Episodes</td>
 <td><select name=codedflg class=SelectMed onchange=SelectSubmit()>
  %PATWEB98.01.815
 </select></td>
 </tr>

</table>
</form>
</div>
<div id=TableLocation></div>
<script type="text/javascript">
function AddTableRows() {
%PATWEB98.01.301.mrtweb02.01.001.3.3. . . . . .1
}
</script>
<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB98.01.003">
<input type=hidden name=admissno value="%PATWEB98.01.081">
<input type=hidden name=MenuType value="%PATWEB98.01.088">
<input type=hidden name=epscd001 value="">
<input type=hidden name=dum value="">
<input type=hidden name=EpsFlag value="">
<input type=hidden name=EpsNo value="">
</form>
