<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
%START.OF.PAGE
<script type="text/javascript">

function getPortalCookie() {
  if (GetCookieData("sjogwaPortalCOOKIE") != 'unknown') {
    ExpireCookiePath("sjogwaPortalCOOKIE");
    sjogprtl = "1";
  }
}

var sjogprtl = "";
getPortalCookie();

var extraContacts = eval(%PATWEB07.06.224);
var upiContacts = parent.upiObj ? parent.upiObj : null;

function init() {
  OS="<table cellpadding=2 cellspacing=0 width=100% border='1' style='table-layout:fixed;'>"+
         "<tr height=35><td width='15%' class=HeadingCell>Contact Type</td>"+
         "<td width='10%' class=HeadingCell>Relationship</td>"+
         "<td width='15%' class=HeadingCell>Name</td>"+
         "<td width='10%' class=HeadingCell>Home Phone</td>"+
         "<td width='10%' class=HeadingCell>Work Phone</td>"+
         "<td width='10%' class=HeadingCell>Mobile Phone</td>"+
         "<td class=HeadingCell>Address</td></tr>";
  for (var i = 0; i < extraContacts.length; i++) {
    OS+="<tr height=35 class=TableRowEven><td>"+
          extraContacts[i]['contactTypeDesc']+"&nbsp;</td>"+
            "<td>"+extraContacts[i]['contactRelationshipDesc']+"&nbsp;</td>"+
            "<td>"+extraContacts[i]['contactName'].toUpperCase()+"&nbsp;</td>"+
            "<td>"+extraContacts[i]['contactHomePhone']+"&nbsp;</td>"+
            "<td>"+extraContacts[i]['contactWorkPhone']+"&nbsp;</td>"+
            "<td>"+extraContacts[i]['contactMobilePhone']+"&nbsp;</td>"+
            "<td>"+extraContacts[i]['contactAddress'].toUpperCase()+"&nbsp;</td></tr>";

    assignCounter(i);

  }
  OS+="</table>";
  var el=document.getElementById("Existing");
  el.innerHTML=OS;

  populateHiddenContactDetails();

  OS="<table cellpadding=2 cellspacing=0 width=100% border='1' style='table-layout:fixed;'>"+
         "<tr height=35><td width='15%' class=HeadingCell>Contact Type</td>"+
         "<td width='10%' class=HeadingCell>Relationship</td>"+
         "<td width='18%' class=HeadingCell>Name</td>"+
         "<td width='10%' class=HeadingCell>Home Phone</td>"+
         "<td width='10%' class=HeadingCell>Work Phone</td>"+
         "<td width='10%' class=HeadingCell>Mobile Phone</td>"+
         "<td class=HeadingCell colspan=2>Address</td></tr>";

  getPostalAddress();
  getPRFA();                             //Person Responsbile for Account
  getNOK();                              //Next of Kin
  getEmergencyContact();
  getPOA();

  LoadUPIContacts(upiContacts);

  OS+="</table>";
  var el=document.getElementById("EnteredOnline");
  el.innerHTML=OS;
}
function getContactCode(selectedType) {
  var el = document.getElementById("ContactTypes");
  for (var i=0;i<el.options.length;i++) {
    if (trim(selectedType.toString())==trim(el.options[i].value.substr(3,1))) {
      return el.options[i].value.substr(0,3);
    }
  }
  return selectedType;
}
function getRelationshipCode(selectedType) {
  var el = document.getElementById("RelationshipTypes");
  for (var i=0;i<el.options.length;i++) {
    if (trim(selectedType.toString())==trim(el.options[i].value)) {
      return el.options[i].text;
    }
  }
  return selectedType;
}
function UpdateCard(indexNo) {
  var cardType=parent.patientObj[0]['CONCESSIONCODE0'+indexNo];
  var cardNo=parent.patientObj[0]['CONCESSIONCARD0'+indexNo];
  var cardExpiry=parent.patientObj[0]['CONCESSIONEXPR0'+indexNo];
  for (var i = 0; i < extraContacts.length; i++) {
    if (trim(cardType)==trim(extraContacts[i]['cardType'])) {
      if (confirm("Contact Details already exist.\n"+
            "Click OK to Delete and Replace the Card Details.")) {
        var deleteURL='patweb07.pbl?reportno=4&template=6&calltype=1&updttype=D'+
                      '&urnumber='+parent.PatientURN.replace(/ /g,"+")+
                      '&pmccd002='+extraContacts[i]['cardType'].replace(/ /g,"+")+
                      '&pmccd003='+extraContacts[i]['cardNo'].replace(/ /g,"+")+
                      '&pmccd004='+extraContacts[i]['cardExpiry'].replace(/ /g,"+")
        RSExecute(deleteURL);
      }
    }
  }
  var addURL='patweb07.pbl?reportno=4&template=6&calltype=1&updttype=A'+
             '&urnumber='+parent.PatientURN.replace(/ /g,"+")+
             '&pmccd002='+getCardCode(cardType).replace(/ /g,"+")+
             '&pmccd003='+cardNo.replace(/ /g,"+")+
             '&pmccd004='+cardExpiry+'01';
  var returnValue = RSExecute(addURL);
  if (returnValue.status==0) {
    location.reload();
  }
}
function UpdateContact(contactTypeInd,contactType,contactCounter,updateType) {

  if (updateType=="U") {
    if (confirm("Contact Details already exist.\n"+
                "Click OK to Delete and Replace the Contact Details.")) {
      var deleteURL='patweb07.pbl?reportno=6&template=8&calltype=1&updttype=D'+
                 '&urnumber='+parent.PatientURN.replace(/ /g,"+")+
                 '&pmcex001='+parent.PatientURN.replace(/ /g,"+")+
                 '&pmcex002='+contactType.replace(/ /g,"+")+
                 '&pmcex003='+contactCounter.replace(/ /g,"+")
      RSExecute(deleteURL);
    }
    else return;
  }

  var addURL='patweb07.pbl?reportno=6&template=8&calltype=1&updttype=A'+
             '&urnumber='+parent.PatientURN.replace(/ /g,"+")+
             '&pmcex001='+parent.PatientURN.replace(/ /g,"+")+
             '&pmcex002='+contactType.replace(/ /g,"+");

  if (contactTypeInd=="2") {

    addURL += '&pmcex007=' +

         document.getElementById('ptmsx040').value.toUpperCase().replace(/ /g,"+")+
     '&pmcex008='+
         document.getElementById('ptmsx041').value.toUpperCase().replace(/ /g,"+")+
     '&pmcex009='+
         document.getElementById('ptmsx042').value.toUpperCase().replace(/ /g,"+")+
     '&pmcex010='+
         document.getElementById('ptmsx043').value.toUpperCase().replace(/ /g,"+")+
     '&pmcex011='+
         document.getElementById('ptmsx044').value.toUpperCase().replace(/ /g,"+");
  }

  if (contactTypeInd=="6") {

    addURL += "&pmcex004="+document.getElementById("pratitle").value;
    if (document.getElementById('ptpra001').value.split(" ").length>1) {
      if(!isWhitespace(document.getElementById('prfagnam').value)) {
          var l=trim(document.getElementById('prfagnam').value).length;
          addURL += '&pmcex005=' +
          document.getElementById('ptpra001').value.toUpperCase().substr(l+1).replace(/ /g,"+")+
          '&pmcex006='+
          document.getElementById('ptpra001').value.toUpperCase().substr(0,l).replace(/ /g,"+");
      } else {
        var l=document.getElementById('ptpra001').value.split(" ")[0].length;
        addURL += '&pmcex005=' +
        document.getElementById('ptpra001').value.toUpperCase().substr(l+1).replace(/ /g,"+")+
        '&pmcex006='+
        document.getElementById('ptpra001').value.toUpperCase().split(" ")[0].replace(/ /g,"+");
      }
    } else {
      addURL += '&pmcex005=' +
      document.getElementById('ptpra001').value.toUpperCase().split(" ")[0].replace(/ /g,"+");
    }

    addURL += '&pmcex007=' +

      document.getElementById('ptpra002').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex008='+ 
         document.getElementById('ptpra003').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex009='+
         document.getElementById('ptpra004').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex010='+
         document.getElementById('ptpra005').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex011='+document.getElementById('ptpra006').value.replace(/ /g,"+")+
      '&pmcex012='+document.getElementById('ptpra007').value.replace(/ /g,"+")+
      '&pmcex013='+document.getElementById('ptpra008').value.replace(/ /g,"+")+
      '&pmcex014='+document.getElementById('ptpra010').value.replace(/ /g,"+")+
      '&pmcex015='+document.getElementById('ptpra009').value.replace(/ /g,"+");
  }

  if (contactTypeInd=="1") {
    addURL += "&pmcex004="+document.getElementById("noktitle").value;
    if (document.getElementById('ptmas049').value.split(" ").length>1) {
      if(!isWhitespace(document.getElementById('contgnam').value)) {
        var l=trim(document.getElementById('contgnam').value).length;
        addURL += '&pmcex005=' +
        document.getElementById('ptmas049').value.toUpperCase().substr(l+1).replace(/ /g,"+")+
        '&pmcex006='+
        document.getElementById('ptmas049').value.toUpperCase().substr(0,l).replace(/ /g,"+");
      } else {
        var l=document.getElementById('ptmas049').value.split(" ")[0].length;
        addURL += '&pmcex005=' +
        document.getElementById('ptmas049').value.toUpperCase().substr(l+1).replace(/ /g,"+")+
        '&pmcex006='+
        document.getElementById('ptmas049').value.toUpperCase().split(" ")[0].replace(/ /g,"+");
     }
    } else {
      addURL += '&pmcex005=' +
      document.getElementById('ptmas049').value.toUpperCase().split(" ")[0].replace(/ /g,"+");
    }

    addURL += '&pmcex007=' +

         document.getElementById('ptmas050').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex008='+
         document.getElementById('ptmas051').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex009='+
         document.getElementById('ptmas052').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex010='+
         document.getElementById('ptmas053').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex011='+document.getElementById('ptmas054').value.replace(/ /g,"+")+
      '&pmcex012='+document.getElementById('ptmas055').value.replace(/ /g,"+")+
      '&pmcex013='+document.getElementById('ptmas056').value.replace(/ /g,"+")+
      '&pmcex014='+document.getElementById('pmpmi010').value.replace(/ /g,"+")+
      '&pmcex015='+document.getElementById('ptmas057').value.replace(/ /g,"+")+
      '&pmcex016='+document.getElementById('pmpmi011').value.replace(/ /g,"+");
  }
 
  if (contactTypeInd=="3") {

    addURL += "&pmcex004="+document.getElementById("cottitle").value;
    if (document.getElementById('ptmsx010').value.split(" ").length>1) {
      if(!isWhitespace(document.getElementById('cothgnam').value)) {
        var l=trim(document.getElementById('cothgnam').value).length;
        addURL += '&pmcex005=' +
        document.getElementById('ptmsx010').value.toUpperCase().substr(l+1).replace(/ /g,"+")+
        '&pmcex006='+
        document.getElementById('ptmsx010').value.toUpperCase().substr(0,l).replace(/ /g,"+");
      } else {
        var l=document.getElementById('ptmsx010').value.split(" ")[0].length;
        addURL += '&pmcex005=' +
        document.getElementById('ptmsx010').value.toUpperCase().substr(l+1).replace(/ /g,"+")+
        '&pmcex006='+
        document.getElementById('ptmsx010').value.toUpperCase().split(" ")[0].replace(/ /g,"+");
      }
    } else {
      addURL += '&pmcex005=' +
      document.getElementById('ptmsx010').value.toUpperCase().split(" ")[0].replace(/ /g,"+");
    }

    addURL += '&pmcex007=' +

         document.getElementById('ptmsx011').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex008='+
         document.getElementById('ptmsx012').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex009='+
         document.getElementById('ptmsx013').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex010='+
         document.getElementById('ptmsx014').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex011='+document.getElementById('ptmsx015').value.replace(/ /g,"+")+
      '&pmcex012='+document.getElementById('ptmsx016').value.replace(/ /g,"+")+
      '&pmcex013='+document.getElementById('ptmsx017').value.replace(/ /g,"+")+
      '&pmcex014='+document.getElementById('pmpmi007').value.replace(/ /g,"+")+
      '&pmcex015='+document.getElementById('ptmsx018').value.replace(/ /g,"+")+
      '&pmcex016='+document.getElementById('pmpmi008').value.replace(/ /g,"+");
  }

  if (contactTypeInd=="E") {

    if (document.getElementById('ptmsx019').value.split(" ").length>1) {
      var l=document.getElementById('ptmsx019').value.split(" ")[0].length;
      addURL += '&pmcex005=' +
      document.getElementById('ptmsx019').value.toUpperCase().substr(l+1).replace(/ /g,"+")+
      '&pmcex006='+
      document.getElementById('ptmsx019').value.toUpperCase().split(" ")[0].replace(/ /g,"+");
    } else {
      addURL += '&pmcex005=' +
      document.getElementById('ptmsx019').value.toUpperCase().split(" ")[0].replace(/ /g,"+");
    }

    addURL += '&pmcex007=' +

         document.getElementById('ptmsx020').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex008='+
         document.getElementById('ptmsx021').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex009='+
         document.getElementById('ptmsx022').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex010='+
         document.getElementById('ptmsx023').value.toUpperCase().replace(/ /g,"+")+
      '&pmcex011='+document.getElementById('ptmsx024').value.replace(/ /g,"+")+
      '&pmcex012='+document.getElementById('ptmsx025').value.replace(/ /g,"+")+
      '&pmcex013='+document.getElementById('ptmsx026').value.replace(/ /g,"+")+
      '&pmcex014='+document.getElementById('pmpmi013').value.replace(/ /g,"+")+
      '&pmcex015='+document.getElementById('ptmsx027').value.replace(/ /g,"+")+
      '&pmcex016='+document.getElementById('pmpmi014').value.replace(/ /g,"+");
  }
 
  var returnValue = RSExecute(addURL);
  if (returnValue.status==0) {
    SetCookie("eAdmCookieContact"," ","8");    // Set load contact cookie
    parent.location.reload();
  }
}
function populateHiddenContactDetails() {
  if (parent.patientObj == undefined)
    return;

  //
  // Using 'Interface to Episoft' (i.e. eAdmission)
  //
  if (document.getElementById("ptcnepis").value=="1" && sjogprtl != "1") {
    for (var i = 0; i < parent.patientObj.length;i++) {
      if (typeof parent.patientObj[i] == 'undefined') {
        continue; 
      }

      var el = document.getElementsByName(parent.patientObj[i].name);
      el = el[0];
      if (typeof el == 'undefined') {
        continue;
      }

      var eAdmissionValue = typeof parent.patientObj[i].value != 'undefined' ?
                            parent.patientObj[i].value : "";
      if (el != null) {
        if (el.type == "hidden") {
          el.value = eAdmissionValue;
        }
      }
    }

    return;
  }


  //
  // NOT using 'Interface to Episoft' (i.e. Patient Portal) ...
  //
  for (var key in parent.patientObj[0]) {
    var value = parent.patientObj[0][key];

    var el = document.getElementsByName(key);
    el = el[0];

    if (el == undefined) {
      continue;
    }

    var newVal = (value != undefined) ? value : "";
    if (el.type == "hidden") {
      el.value = newVal;
    }
  }
}
function getPostalAddress() {

  if (!isWhitespace(document.getElementById('ptmsx040').value) ||
      !isWhitespace(document.getElementById('ptmsx041').value) ||
      !isWhitespace(document.getElementById('ptmsx042').value) ||
      !isWhitespace(document.getElementById('ptmsx043').value) ||
      !isWhitespace(document.getElementById('ptmsx044').value)) {
    OS+="<tr height=35 class=TableRowEven><td>Postal Address</td>"+
        "<td>&nbsp;</td>"+
        "<td>&nbsp;</td>"+
        "<td>&nbsp;</td>"+
        "<td>&nbsp;</td>"+
        "<td>&nbsp;</td>"+
        "<td>"+document.getElementById('ptmsx040').value.toUpperCase()+" "+
               document.getElementById('ptmsx041').value.toUpperCase()+" "+
               document.getElementById('ptmsx042').value.toUpperCase()+" "+
               document.getElementById('ptmsx043').value.toUpperCase()+" "+
               document.getElementById('ptmsx044').value.toUpperCase()+" "+
        "&nbsp;</td>"+
        "<td style='text-align:center'>";
        addFlag=true;

        for (var j = 0; j < extraContacts.length; j++) {
          if (trim(extraContacts[j]['contactTypeInd'])=="2") {
            addFlag=false;
            addressString=document.getElementById('ptmsx040').value+" "+
                          document.getElementById('ptmsx041').value+" "+
                          document.getElementById('ptmsx042').value+" "+
                          document.getElementById('ptmsx043').value+" "+
                          document.getElementById('ptmsx044').value+" ";
            if (addressString.replace(/ /g,'')==
                extraContacts[j]['contactAddress'].replace(/ /g,'')) {
              OS+="Matched</td></tr>";
            } else {
              OS+="<input type=button class=button value=Update"+
                  " onclick='UpdateContact(\""+
                                     extraContacts[j]['contactTypeInd']+"\",\""+
                                     extraContacts[j]['contactType']+"\",\""+
                                     extraContacts[j]['contactCounter']+"\",\""+
                                     "U\");'></td></tr>";
            }
          }
        }
        if (addFlag) {
          OS+="<input type=button class=button value=Add"+
              " onclick='UpdateContact(\"2\",\""+getContactCode("2")+
                         "\",\"  1\",\"A\");'></td></tr>";
        } 
  }
}
function getPRFA() {

  if (!isWhitespace(document.getElementById('ptpra009').value) ||
      !isWhitespace(document.getElementById('ptpra001').value) ||
      !isWhitespace(document.getElementById('ptpra007').value) ||
      !isWhitespace(document.getElementById('ptpra010').value) ||
      !isWhitespace(document.getElementById('ptpra008').value) ||
      !isWhitespace(document.getElementById('ptpra002').value) ||
      !isWhitespace(document.getElementById('ptpra003').value) ||
      !isWhitespace(document.getElementById('ptpra004').value) ||
      !isWhitespace(document.getElementById('ptpra005').value) ||
      !isWhitespace(document.getElementById('ptpra006').value)) {
    OS+="<tr height=45 class=TableRowEven><td>Person Responsible for Account</td>"+
        "<td>"+getRelationshipCode(document.getElementById('ptpra009').value)+
        "&nbsp;</td>"+
      "<td>"+document.getElementById('ptpra001').value.toUpperCase()+"&nbsp;</td>"+
        "<td>"+document.getElementById('ptpra007').value+"&nbsp;</td>"+
        "<td>"+document.getElementById('ptpra008').value+"&nbsp;</td>"+
        "<td>"+document.getElementById('ptpra010').value+"&nbsp;</td>"+
        "<td>"+document.getElementById('ptpra002').value.toUpperCase()+" "+
               document.getElementById('ptpra003').value.toUpperCase()+" "+
               document.getElementById('ptpra004').value.toUpperCase()+" "+
               document.getElementById('ptpra005').value.toUpperCase()+" "+
               document.getElementById('ptpra006').value.toUpperCase()+" "+
        "&nbsp;</td>"+
        "<td style='text-align:center'>";
        addFlag=true;
        for (var j = 0; j < extraContacts.length; j++) {
          if (trim(extraContacts[j]['contactTypeInd'])=="6") {
            addFlag=false;
            relationshipString=document.getElementById('ptpra009').value;
            nameString=document.getElementById('ptpra001').value;
            homephoneString=document.getElementById('ptpra007').value;
            workphoneString=document.getElementById('ptpra008').value;
            cellphoneString=document.getElementById('ptpra010').value;
            addressString=document.getElementById('ptpra002').value+" "+
                          document.getElementById('ptpra003').value+" "+
                          document.getElementById('ptpra004').value+" "+
                          document.getElementById('ptpra005').value+" "+
                          document.getElementById('ptpra006').value+" ";
            if (relationshipString.replace(/ /g,'')==
                extraContacts[j]['contactRelationship'].replace(/ /g,'') &&
                nameString.replace(/ /g,'')==
                extraContacts[j]['contactName'].replace(/ /g,'') &&
                homephoneString.replace(/ /g,'')==
                extraContacts[j]['contactHomePhone'].replace(/ /g,'') &&
                workphoneString.replace(/ /g,'')==
                extraContacts[j]['contactWorkPhone'].replace(/ /g,'') &&
                cellphoneString.replace(/ /g,'')==
                extraContacts[j]['contactMobilePhone'].replace(/ /g,'') &&
                addressString.replace(/ /g,'')==
                extraContacts[j]['contactAddress'].replace(/ /g,'')) {
              OS+="Matched</td></tr>";
            } else {
              OS+="<input type=button class=button value=Update"+
                  " onclick='UpdateContact(\""+
                                     extraContacts[j]['contactTypeInd']+"\",\""+
                                     extraContacts[j]['contactType']+"\",\""+
                                     extraContacts[j]['contactCounter']+"\",\""+
                                     "U\");'></td></tr>";
            }
          }
        }
        if (addFlag) {
          OS+="<input type=button class=button value=Add"+
              " onclick='UpdateContact(\"6\",\""+getContactCode("6")+
                         "\",\"  1\",\"A\");'></td></tr>";
        }
  }
}
function getNOK() {
  if (!isWhitespace(document.getElementById('ptmas057').value) ||
      !isWhitespace(document.getElementById('ptmas049').value) ||
      !isWhitespace(document.getElementById('ptmas055').value) ||
      !isWhitespace(document.getElementById('pmpmi010').value) ||
      !isWhitespace(document.getElementById('ptmas056').value) ||
      !isWhitespace(document.getElementById('pmpmi011').value) ||
      !isWhitespace(document.getElementById('ptmas050').value) ||
      !isWhitespace(document.getElementById('ptmas051').value) ||
      !isWhitespace(document.getElementById('ptmas052').value) ||
      !isWhitespace(document.getElementById('ptmas053').value) ||
      !isWhitespace(document.getElementById('ptmas054').value)) {
    OS+="<tr height=45 class=TableRowEven><td>Next of Kin</td>"+
        "<td>"+getRelationshipCode(document.getElementById('ptmas057').value)+
        "&nbsp;</td>"+
      "<td>"+document.getElementById('ptmas049').value.toUpperCase()+"&nbsp;</td>"+
        "<td>"+document.getElementById('ptmas055').value+"&nbsp;</td>"+
        "<td>"+document.getElementById('ptmas056').value+"&nbsp;</td>"+
        "<td>"+document.getElementById('pmpmi010').value+"&nbsp;</td>"+
        "<td>"+document.getElementById('ptmas050').value.toUpperCase()+" "+
               document.getElementById('ptmas051').value.toUpperCase()+" "+
               document.getElementById('ptmas052').value.toUpperCase()+" "+
               document.getElementById('ptmas053').value.toUpperCase()+" "+
               document.getElementById('ptmas054').value.toUpperCase()+" "+
        "&nbsp;</td>"+
        "<td style='text-align:center'>";
        addFlag=true;
        for (var j = 0; j < extraContacts.length; j++) {
          if (trim(extraContacts[j]['contactTypeInd'])=="1") {
            addFlag=false;
            relationshipString=document.getElementById('ptmas057').value;
            nameString=document.getElementById('ptmas049').value;
            homephoneString=document.getElementById('ptmas055').value;
            workphoneString=document.getElementById('ptmas056').value;
            cellphoneString=document.getElementById('pmpmi010').value;
            emailString=document.getElementById('pmpmi011').value;
            addressString=document.getElementById('ptmas050').value+" "+
                          document.getElementById('ptmas051').value+" "+
                          document.getElementById('ptmas052').value+" "+
                          document.getElementById('ptmas053').value+" "+
                          document.getElementById('ptmas054').value+" ";
            if (relationshipString.replace(/ /g,'')==
                extraContacts[j]['contactRelationship'].replace(/ /g,'') &&
                nameString.replace(/ /g,'')==
                extraContacts[j]['contactName'].replace(/ /g,'') &&
                homephoneString.replace(/ /g,'')==
                extraContacts[j]['contactHomePhone'].replace(/ /g,'') &&
                workphoneString.replace(/ /g,'')==
                extraContacts[j]['contactWorkPhone'].replace(/ /g,'') &&
                cellphoneString.replace(/ /g,'')==
                extraContacts[j]['contactMobilePhone'].replace(/ /g,'') &&
                emailString.replace(/ /g,'')==
                extraContacts[j]['contactEmail'].replace(/ /g,'') &&
                addressString.replace(/ /g,'')==
                extraContacts[j]['contactAddress'].replace(/ /g,'')) {
              OS+="Matched</td></tr>";
            } else {
              OS+="<input type=button class=button value=Update"+
                  " onclick='UpdateContact(\""+
                                     extraContacts[j]['contactTypeInd']+"\",\""+
                                     extraContacts[j]['contactType']+"\",\""+
                                     extraContacts[j]['contactCounter']+"\",\""+
                                     "U\");'></td></tr>";
            }
          }
        }
        if (addFlag) {
          OS+="<input type=button class=button value=Add"+
              " onclick='UpdateContact(\"1\",\""+getContactCode("1")+
                         "\",\"  1\",\"A\");'></td></tr>";
        }
  }
}
function getEmergencyContact() {

  if (!isWhitespace(document.getElementById('ptmsx018').value) ||
      !isWhitespace(document.getElementById('ptmsx010').value) ||
      !isWhitespace(document.getElementById('ptmsx016').value) ||
      !isWhitespace(document.getElementById('pmpmi007').value) ||
      !isWhitespace(document.getElementById('ptmsx017').value) ||
      !isWhitespace(document.getElementById('pmpmi008').value) ||
      !isWhitespace(document.getElementById('ptmsx011').value) ||
      !isWhitespace(document.getElementById('ptmsx012').value) ||
      !isWhitespace(document.getElementById('ptmsx013').value) ||
      !isWhitespace(document.getElementById('ptmsx014').value) ||
      !isWhitespace(document.getElementById('ptmsx015').value)) {
    OS+="<tr height=45 class=TableRowEven><td>Emergency Contact</td>"+
        "<td>"+getRelationshipCode(document.getElementById('ptmsx018').value)+
        "&nbsp;</td>"+
      "<td>"+document.getElementById('ptmsx010').value.toUpperCase()+"&nbsp;</td>"+
        "<td>"+document.getElementById('ptmsx016').value+"&nbsp;</td>"+
        "<td>"+document.getElementById('ptmsx017').value+"&nbsp;</td>"+
        "<td>"+document.getElementById('pmpmi007').value+"&nbsp;</td>"+
        "<td>"+document.getElementById('ptmsx011').value.toUpperCase()+" "+
               document.getElementById('ptmsx012').value.toUpperCase()+" "+
               document.getElementById('ptmsx013').value.toUpperCase()+" "+
               document.getElementById('ptmsx014').value.toUpperCase()+" "+
               document.getElementById('ptmsx015').value.toUpperCase()+" "+
        "&nbsp;</td>"+
        "<td style='text-align:center'>";
        addFlag=true;
        for (var j = 0; j < extraContacts.length; j++) {
          if (trim(extraContacts[j]['contactTypeInd'])=="3") {
            addFlag=false;
            relationshipString=document.getElementById('ptmsx018').value;
            nameString=document.getElementById('ptmsx010').value;
            homephoneString=document.getElementById('ptmsx016').value;
            workphoneString=document.getElementById('ptmsx017').value;
            cellphoneString=document.getElementById('pmpmi007').value;
            emailString=document.getElementById('pmpmi008').value;
            addressString=document.getElementById('ptmsx011').value+" "+
                          document.getElementById('ptmsx012').value+" "+
                          document.getElementById('ptmsx013').value+" "+
                          document.getElementById('ptmsx014').value+" "+
                          document.getElementById('ptmsx015').value+" ";
            if (relationshipString.replace(/ /g,'')==
                extraContacts[j]['contactRelationship'].replace(/ /g,'') &&
                nameString.replace(/ /g,'')==
                extraContacts[j]['contactName'].replace(/ /g,'') &&
                homephoneString.replace(/ /g,'')==
                extraContacts[j]['contactHomePhone'].replace(/ /g,'') &&
                workphoneString.replace(/ /g,'')==
                extraContacts[j]['contactWorkPhone'].replace(/ /g,'') &&
                cellphoneString.replace(/ /g,'')==
                extraContacts[j]['contactMobilePhone'].replace(/ /g,'') &&
                emailString.replace(/ /g,'')==
                extraContacts[j]['contactEmail'].replace(/ /g,'') &&
                addressString.replace(/ /g,'')==
                extraContacts[j]['contactAddress'].replace(/ /g,'')) {
              OS+="Matched</td></tr>";
            } else {
              OS+="<input type=button class=button value=Update"+
                  " onclick='UpdateContact(\""+
                                     extraContacts[j]['contactTypeInd']+"\",\""+
                                     extraContacts[j]['contactType']+"\",\""+
                                     extraContacts[j]['contactCounter']+"\",\""+
                                     "U\");'></td></tr>";
            }
          }
        }
        if (addFlag) {
          OS+="<input type=button class=button value=Add"+
              " onclick='UpdateContact(\"3\",\""+getContactCode("3")+
                         "\",\"  1\",\"A\");'></td></tr>";
        }
  }
}
function getPOA() {

  if (!isWhitespace(document.getElementById('ptmsx027').value) ||
      !isWhitespace(document.getElementById('ptmsx019').value) ||
      !isWhitespace(document.getElementById('ptmsx025').value) ||
      !isWhitespace(document.getElementById('pmpmi013').value) ||
      !isWhitespace(document.getElementById('ptmsx026').value) ||
      !isWhitespace(document.getElementById('pmpmi014').value) ||
      !isWhitespace(document.getElementById('ptmsx020').value) ||
      !isWhitespace(document.getElementById('ptmsx021').value) ||
      !isWhitespace(document.getElementById('ptmsx022').value) ||
      !isWhitespace(document.getElementById('ptmsx023').value) ||
      !isWhitespace(document.getElementById('ptmsx024').value)) {
    OS+="<tr height=45 class=TableRowEven><td>Enduring Power of Attorney</td>"+
        "<td>"+getRelationshipCode(document.getElementById('ptmsx027').value)+
        "&nbsp;</td>"+
      "<td>"+document.getElementById('ptmsx019').value.toUpperCase()+"&nbsp;</td>"+
        "<td>"+document.getElementById('ptmsx025').value+"&nbsp;</td>"+
        "<td>"+document.getElementById('ptmsx026').value+"&nbsp;</td>"+
        "<td>"+document.getElementById('pmpmi013').value+"&nbsp;</td>"+
        "<td>"+document.getElementById('ptmsx020').value.toUpperCase()+" "+
               document.getElementById('ptmsx021').value.toUpperCase()+" "+
               document.getElementById('ptmsx022').value.toUpperCase()+" "+
               document.getElementById('ptmsx023').value.toUpperCase()+" "+
               document.getElementById('ptmsx024').value.toUpperCase()+" "+
        "&nbsp;</td>"+
        "<td style='text-align:center'>";
        addFlag=true;
        for (var j = 0; j < extraContacts.length; j++) {
          if (trim(extraContacts[j]['contactTypeInd'])=="E") {
            addFlag=false;
            relationshipString=document.getElementById('ptmsx027').value;
            nameString=document.getElementById('ptmsx019').value;
            homephoneString=document.getElementById('ptmsx025').value;
            workphoneString=document.getElementById('ptmsx026').value;
            cellphoneString=document.getElementById('pmpmi013').value;
            emailString=document.getElementById('pmpmi014').value;
            addressString=document.getElementById('ptmsx020').value+" "+
                          document.getElementById('ptmsx021').value+" "+
                          document.getElementById('ptmsx022').value+" "+
                          document.getElementById('ptmsx023').value+" "+
                          document.getElementById('ptmsx024').value+" ";
            if (relationshipString.replace(/ /g,'')==
                extraContacts[j]['contactRelationship'].replace(/ /g,'') &&
                nameString.replace(/ /g,'')==
                extraContacts[j]['contactName'].replace(/ /g,'') &&
                homephoneString.replace(/ /g,'')==
                extraContacts[j]['contactHomePhone'].replace(/ /g,'') &&
                workphoneString.replace(/ /g,'')==
                extraContacts[j]['contactWorkPhone'].replace(/ /g,'') &&
                cellphoneString.replace(/ /g,'')==
                extraContacts[j]['contactMobilePhone'].replace(/ /g,'') &&
                emailString.replace(/ /g,'')==
                extraContacts[j]['contactEmail'].replace(/ /g,'') &&
                addressString.replace(/ /g,'')==
                extraContacts[j]['contactAddress'].replace(/ /g,'')) {
              OS+="Matched</td></tr>";
            } else {
              OS+="<input type=button class=button value=Update"+
                  " onclick='UpdateContact(\""+
                                     extraContacts[j]['contactTypeInd']+"\",\""+
                                     extraContacts[j]['contactType']+"\",\""+
                                     extraContacts[j]['contactCounter']+"\",\""+
                                     "U\");'></td></tr>";
            }
          }
        }
        if (addFlag) {
          OS+="<input type=button class=button value=Add"+
              " onclick='UpdateContact(\"E\",\""+getContactCode("E")+
                         "\",\"  1\",\"A\");'></td></tr>";
        }
  }
}
function assignCounter(i) {
  if(extraContacts[i]['contactTypeInd']=='2') {
    document.getElementById('pstaddcn').value=
    extraContacts[i]['contactCounter'];
  }

  if(extraContacts[i]['contactTypeInd']=='6') {
    document.getElementById('prrsfacn').value=
    extraContacts[i]['contactCounter'];
  }

  if(extraContacts[i]['contactTypeInd']=='1') {
    document.getElementById('nextkncn').value=
    extraContacts[i]['contactCounter'];
  }

  if(extraContacts[i]['contactTypeInd']=='3') {
    document.getElementById('emercncn').value=
    extraContacts[i]['contactCounter'];
  }

  if(extraContacts[i]['contactTypeInd']=='E') {
    document.getElementById('endpowcn').value=
    extraContacts[i]['contactCounter'];
  }

}
function Process() {
  var erefrlid = getQueryString('erefrlid'); 
  if (!isWhitespace(erefrlid)) {
     parent.location.href = "comweb10.pbl?reportno=4&template=001"+
                            '&urnumber='+parent.PatientURN.replace(/ /g,"+")+
                            '&erefrlid='+erefrlid.replace(/ /g,"+");
  } else {
     var admisnid = parent.document.getElementById('admisnid');
     if (admisnid != undefined) {
       parent.location.href = "patweb14.pbl?reportno=3&template=001"+
                              '&urnumber='+parent.PatientURN.replace(/ /g,"+")+
                              '&admisnid='+admisnid.value.replace(/ /g,"+")
    }
  }
}

var CONTACT_TYPE_NOK = '1';  // Next Of Kin
var CONTACT_TYPE_POA = '2';  // Postal Address
var CONTACT_TYPE_EMR = '3';  // Emergency Contact
var CONTACT_TYPE_PRA = '6';  // Person Responsible for Account
var CONTACT_TYPE_EPA = 'E';  // Enduring Power of Attorney

function GetContactTypeString(ContactTypeInd) {
  var sTypeDesc;

  switch (ContactTypeInd) {
    case CONTACT_TYPE_NOK:
      sTypeDesc = "Next of Kin";
      break;

    case CONTACT_TYPE_POA:
      sTypeDesc = "Postal Address";
      break;

    case CONTACT_TYPE_EMR:
      sTypeDesc = "Emergency Contact";
      break;

    case CONTACT_TYPE_PRA:
      sTypeDesc = "Person Responsible for Account";
      break;

    case CONTACT_TYPE_EPA:
      sTypeDesc = "Enduring Power of Attorney";
      break;

    default:
      sTypeDesc = "";
      break;
  }

  return sTypeDesc;
}

function LoadUPIContacts(UPIContactsObj) {

  if (UPIContactsObj == null)
    return;

  for (var i=0; i < UPIContactsObj.length; i++)
  {
    var sContactType = GetContactTypeString(UPIContactsObj[i]['contactTypeInd'])
    var sUPIContactName = UPIContactsObj[i]['contactName'].toUpperCase();
    var sUPIHomePhone = UPIContactsObj[i]['contactHomePhone'];
    var sUPIWorkPhone = UPIContactsObj[i]['contactWorkPhone'];
    var sUPIMobilePhone = UPIContactsObj[i]['contactMobilePhone'];
 var sUPIAddress = trim(UPIContactsObj[i]['contactAddress1'].toUpperCase()) + " " +
                   trim(UPIContactsObj[i]['contactAddress2'].toUpperCase()) + " " +
                   trim(UPIContactsObj[i]['contactAddress3'].toUpperCase()) + " " +
                   trim(UPIContactsObj[i]['contactAddress4'].toUpperCase()) + " " +
                   trim(UPIContactsObj[i]['contactAddress5'].toUpperCase());
    var sUPIRelationship = UPIContactsObj[i]['contactRelationship'];

    OS += "<tr height=45 class=TableRowEven>" +
          "<td>" + sContactType + "</td>" +
          "<td>" + getRelationshipCode(sUPIRelationship) + "</td>" +
          "<td>" + sUPIContactName + "</td>" +
          "<td>" + sUPIHomePhone + "</td>" +
          "<td>" + sUPIWorkPhone + "</td>" +
          "<td>" + sUPIMobilePhone + "</td>" +
          "<td>" + sUPIAddress + "</td>" +
          "<td style='text-align:center'>";

    addFlag = true;  // reset Add flag


    // See if we already have a matching 'Existing Contact' record (by Type)
    for (var j = 0; j < extraContacts.length; j++)
    {
      if (extraContacts[j]['contactTypeInd'] == 
          UPIContactsObj[i]['contactTypeInd'])
      {
        addFlag = false;  // don't show Add button

        relationshipString = sUPIRelationship;
        nameString = sUPIContactName;
        homephoneString = sUPIHomePhone;
        workphoneString = sUPIWorkPhone;
        cellphoneString = sUPIMobilePhone;
        addressString = sUPIAddress;

        if (relationshipString.replace(/ /g,'') ==
            extraContacts[j]['contactRelationship'].replace(/ /g,'') &&

            nameString.replace(/ /g,'') ==
            extraContacts[j]['contactName'].replace(/ /g,'') &&

            homephoneString.replace(/ /g,'') ==
            extraContacts[j]['contactHomePhone'].replace(/ /g,'') &&

            workphoneString.replace(/ /g,'') ==
            extraContacts[j]['contactWorkPhone'].replace(/ /g,'') &&

            cellphoneString.replace(/ /g,'') ==
            extraContacts[j]['contactMobilePhone'].replace(/ /g,'') &&

            addressString.replace(/ /g,'') ==
            extraContacts[j]['contactAddress'].replace(/ /g,'')) 
        {
          OS += "Matched</td></tr>";  // show in place of Add button
        } 
        else {
          OS += "<input type=button class=button value=Update " +
                " onclick='UpdateUPIContact(" +
                "\"U\"," +
                "\"" + extraContacts[j]['contactTypeInd'] + "\"," +
                "\"" + extraContacts[j]['contactType'] + "\"," +
                "\"" + extraContacts[j]['contactCounter'] + "\"," +
                "\"" + i + "\");'></td></tr>";
        }
      }
    }

    if (addFlag) {
      OS += "<input type=button class=button value=Add " +
            " onclick='UpdateUPIContact(" +
            "\"A\"," + 
            "\"" + UPIContactsObj[i]['contactTypeInd'] + "\"," +
            "\"" + getContactCode(UPIContactsObj[i]['contactTypeInd']) + "\"," +
            "\"" + UPIContactsObj[i]['contactCounter'] + "\"," +
            "\"" + i + "\");'></td></tr>";
    }
  }
}

function UpdateUPIContact(UpdateType, ContactTypeInd, ContactType, ContactCounter, ArrayIndex)
{
  if (UpdateType == "U") {
    // Confirm delete existing Extra Contact ...
    if (confirm("Contact Details already exist.\n" +
                "Click OK to Delete and Replace the Contact Details.")) 
    {
      var deleteURL='patweb07.pbl?reportno=6&template=8&calltype=1&updttype=D'+
                 '&urnumber=' + parent.PatientURN.replace(/ /g,"+") +
                 '&pmcex001=' + parent.PatientURN.replace(/ /g,"+") +
                 '&pmcex002=' + ContactType.replace(/ /g,"+") +
                 '&pmcex003=' + ContactCounter.replace(/ /g,"+");

      RSExecute(deleteURL);
    } else {
      return;
    }
  }


  // Now prepare the data for the new Extra Contact ...
  var addURL = 'patweb07.pbl?reportno=6&template=8&calltype=1&updttype=A' +
               '&urnumber=' + parent.PatientURN.replace(/ /g,"+") +
               '&pmcex001=' + parent.PatientURN.replace(/ /g,"+") +
               '&pmcex002=' + ContactType.replace(/ /g,"+");


  addURL += '&pmcex004=' + upiContacts[ArrayIndex]['contactTitle'];

  var sContactName = upiContacts[ArrayIndex]['contactName'];
  var oNames = sContactName.split(" ");

  if (oNames.length > 1) {
    addURL += '&pmcex006=' + oNames[0].toUpperCase().replace(/ /g,"+");//Given Name
    addURL += '&pmcex019=' + oNames[1].toUpperCase().replace(/ /g,"+");//SecondName
    addURL += '&pmcex005=' + oNames[2].toUpperCase().replace(/ /g,"+");  // Surname
  } else {
    addURL += '&pmcex006=' + sContactName.toUpperCase().replace(/ /g,"+");//Given Name
  }

  addURL += '&pmcex007=' +
  trim(upiContacts[ArrayIndex]['contactAddress1']).toUpperCase().replace(/ /g,"+")+
  '&pmcex008=' +
  trim(upiContacts[ArrayIndex]['contactAddress2']).toUpperCase().replace(/ /g,"+")+
  '&pmcex009=' +
  trim(upiContacts[ArrayIndex]['contactAddress3']).toUpperCase().replace(/ /g,"+")+
  '&pmcex010=' +
  trim(upiContacts[ArrayIndex]['contactAddress4']).toUpperCase().replace(/ /g,"+")+
  '&pmcex011=' +
  trim(upiContacts[ArrayIndex]['contactAddress5']).toUpperCase().replace(/ /g,"+")+
  '&pmcex012=' +
            trim(upiContacts[ArrayIndex]['contactHomePhone']).replace(/ /g,"+")+
  '&pmcex013=' +
            trim(upiContacts[ArrayIndex]['contactWorkPhone']).replace(/ /g,"+")+
  '&pmcex014=' +
          trim(upiContacts[ArrayIndex]['contactMobilePhone']).replace(/ /g,"+")+
  '&pmcex015=' +
          trim(upiContacts[ArrayIndex]['contactRelationship']).replace(/ /g,"+")
//'&pmcex016=' +
//          trim(upiContacts[ArrayIndex]['contactEmail']).replace(/ /g,"+")

  
  // Remote script Add ...
  var returnValue = RSExecute(addURL);
  if (returnValue.status==0) {
    SetCookie("eAdmCookieContact"," ","8");    // Set load contact cookie
    parent.location.reload();
  }
}


</script>
</head>
<body onload="PageLoad(event);">
<span class=DFrameTitleBar id=DFrameHeading>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Update Contact Details
</span>
<div id=PageBodySection style="overflow: auto;">
<p style='margin:10px;font-size:12px;font-weight:bold'>Existing Contact Details</p>
<div id=Existing></div>
<p style='margin:10px;font-size:12px;font-weight:bold'>Patient Entered Contact Details</p>
<div id=EnteredOnline></div>
<p style='text-align:center;margin:10px;'>
<input type=button class=button value=Close onclick='Process();'></p>
</div>
<div style='display:none'>
<select id=ContactTypes name=ContactTypes>
%STANDARD.01.007.tc
</select>
</div>
<div style='display:none'>
<select id=RelationshipTypes name=RelationshipTypes>
%STANDARD.01.030
</select>
</div>

<input type="hidden" name="ptcnepis" id="ptcnepis"
 value="%STANDARD.01.025.119.182.0.1" />

<input type="hidden" name="ptmsx040" id="ptmsx040" value=" ">
<input type="hidden" name="ptmsx041" id="ptmsx041" value=" ">
<input type="hidden" name="ptmsx042" id="ptmsx042" value=" ">
<input type="hidden" name="ptmsx043" id="ptmsx043" value=" ">
<input type="hidden" name="ptmsx044" id="ptmsx044" value=" ">
<input type="hidden" name="pstaddcn" id="pstaddcn" value=" ">

<input type="hidden" name="pratitle" id="pratitle" value=" ">
<input type="hidden" name="ptpra001" id="ptpra001" value=" ">
<input type="hidden" name="prfagnam" id="prfagnam" value=" ">
<input type="hidden" name="ptpra002" id="ptpra002" value=" ">
<input type="hidden" name="ptpra003" id="ptpra003" value=" ">
<input type="hidden" name="ptpra004" id="ptpra004" value=" ">
<input type="hidden" name="ptpra005" id="ptpra005" value=" ">
<input type="hidden" name="ptpra006" id="ptpra006" value=" ">
<input type="hidden" name="ptpra007" id="ptpra007" value=" ">
<input type="hidden" name="ptpra008" id="ptpra008" value=" ">
<input type="hidden" name="ptpra009" id="ptpra009" value=" ">
<input type="hidden" name="ptpra010" id="ptpra010" value=" ">
<input type="hidden" name="prrsfacn" id="prrsfacn" value=" ">

<input type="hidden" name="ptmas057" id="ptmas057" value=" ">
<input type="hidden" name="ptmas049" id="ptmas049" value=" ">
<input type="hidden" name="noktitle" id="noktitle" value=" ">
<input type="hidden" name="contgnam" id="contgnam" value=" ">
<input type="hidden" name="ptmas055" id="ptmas055" value=" ">
<input type="hidden" name="cottitle" id="cottitle" value=" ">
<input type="hidden" name="pmpmi010" id="pmpmi010" value=" ">
<input type="hidden" name="ptmas056" id="ptmas056" value=" ">
<input type="hidden" name="pmpmi011" id="pmpmi011" value=" ">
<input type="hidden" name="ptmas050" id="ptmas050" value=" ">
<input type="hidden" name="ptmas051" id="ptmas051" value=" ">
<input type="hidden" name="ptmas052" id="ptmas052" value=" ">
<input type="hidden" name="ptmas053" id="ptmas053" value=" ">
<input type="hidden" name="ptmas054" id="ptmas054" value=" ">
<input type="hidden" name="nextkncn" id="nextkncn" value=" ">

<input type="hidden" name="ptmsx018" id="ptmsx018" value=" ">
<input type="hidden" name="ptmsx010" id="ptmsx010" value=" ">
<input type="hidden" name="cothgnam" id="cothgnam" value=" ">
<input type="hidden" name="ptmsx016" id="ptmsx016" value=" ">
<input type="hidden" name="pmpmi007" id="pmpmi007" value=" ">
<input type="hidden" name="ptmsx017" id="ptmsx017" value=" ">
<input type="hidden" name="pmpmi008" id="pmpmi008" value=" ">
<input type="hidden" name="ptmsx011" id="ptmsx011" value=" ">
<input type="hidden" name="ptmsx012" id="ptmsx012" value=" ">
<input type="hidden" name="ptmsx013" id="ptmsx013" value=" ">
<input type="hidden" name="ptmsx014" id="ptmsx014" value=" ">
<input type="hidden" name="ptmsx015" id="ptmsx015" value=" ">
<input type="hidden" name="emercncn" id="emercncn" value=" ">

<input type="hidden" name="ptmsx027" id="ptmsx027" value=" ">
<input type="hidden" name="ptmsx019" id="ptmsx019" value=" ">
<input type="hidden" name="ptmsx025" id="ptmsx025" value=" ">
<input type="hidden" name="pmpmi013" id="pmpmi013" value=" ">
<input type="hidden" name="ptmsx026" id="ptmsx026" value=" ">
<input type="hidden" name="pmpmi014" id="pmpmi014" value=" ">
<input type="hidden" name="ptmsx020" id="ptmsx020" value=" ">
<input type="hidden" name="ptmsx021" id="ptmsx021" value=" ">
<input type="hidden" name="ptmsx022" id="ptmsx022" value=" ">
<input type="hidden" name="ptmsx023" id="ptmsx023" value=" ">
<input type="hidden" name="ptmsx024" id="ptmsx024" value=" ">
<input type="hidden" name="endpowcn" id="endpowcn" value=" ">
