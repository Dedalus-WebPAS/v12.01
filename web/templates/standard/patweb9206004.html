<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
%START.OF.PAGE
<script type="text/javascript">
function selectView(viewTypeValue) {
  document.SelectView.viewtype.value=viewTypeValue
  document.SelectView.submit();
}
//
function SelectView2(ViewType) {
  document.SelectPeriod.viewtype.value=ViewType
  if (document.SelectPeriod.lastdate!=undefined) {
    document.SelectPeriod.lastdate.value="" }
  if (document.SelectPeriod.vyearmth!=undefined) {
    document.SelectPeriod.vyearmth.value="" }

  f = document.ProcessForm;
  i = f.schdprn1.selectedIndex;
  document.SelectPeriod.sschdpr1.value = f.schdprn1.options[i].value;
  i = f.schdprn2.selectedIndex;
  document.SelectPeriod.sschdpr2.value = f.schdprn2.options[i].value;
  i = f.schdprn3.selectedIndex;
  document.SelectPeriod.sschdpr3.value = f.schdprn3.options[i].value;
  i = f.labeltyp.selectedIndex;
  document.SelectPeriod.slabelty.value = f.labeltyp.options[i].value;
  i = f.statnco1.selectedIndex;
  document.SelectPeriod.sstatnc1.value = f.statnco1.options[i].value;
  i = f.statnco2.selectedIndex;
  document.SelectPeriod.sstatnc2.value = f.statnco2.options[i].value;

  UpdateFields()
  document.SelectPeriod.submit();
}
//
function clearData(){
  for (var i=0;i<window.document.ProcessForm.elements.length;i++) {   
     var e= window.document.ProcessForm.elements[i];
     if (e.type=="checkbox")
       e.checked=1;
     if (e.type=="select-one"||e.type=="select")
       e.selectedIndex=0;
  }

  disablePrintFields();

}
//
function SubmitSelection() {
  UpdateFields()
  document.SelectPeriod.submit();
}
//
function UpdateFields() {
  document.SelectPeriod.schdprn1.value=document.ProcessForm.schdprn1.value
  document.SelectPeriod.schdprn2.value=document.ProcessForm.schdprn2.value
  document.SelectPeriod.schdprn3.value=document.ProcessForm.schdprn3.value
  document.SelectPeriod.labeltyp.value=document.ProcessForm.labeltyp.value
  document.SelectPeriod.statnco1.value=document.ProcessForm.statnco1.value
  document.SelectPeriod.statnco2.value=document.ProcessForm.statnco2.value
  document.SelectPeriod.schdcop1.value=document.ProcessForm.schdcop1.value
  document.SelectPeriod.schdcop2.value=document.ProcessForm.schdcop2.value
  document.SelectPeriod.schdcop3.value=document.ProcessForm.schdcop3.value
}
//
function DispMapping() {
  LinkUrl="patweb92.pbl?reportno=4&template=3"
  Left=(((document.body.clientWidth-400)/2)+ document.body.scrollLeft)
  DFrameLink(LinkUrl,0,Left,400,250)
}
function disablePrintFields() {
  if (document.ProcessForm.multlt01.checked==false) {
    document.ProcessForm.schdprn1.disabled=true;
    document.ProcessForm.labeltyp.disabled=true;
    document.ProcessForm.schdcop1.disabled=true;
  } else {
    document.ProcessForm.schdprn1.disabled=false;
    document.ProcessForm.labeltyp.disabled=false;
    document.ProcessForm.schdcop1.disabled=false;
  }
  if (document.ProcessForm.multlt02.checked==false) {
    document.ProcessForm.schdprn2.disabled=true;
    document.ProcessForm.statnco1.disabled=true;
    document.ProcessForm.schdcop2.disabled=true;
  } else {
    document.ProcessForm.schdprn2.disabled=false;
    document.ProcessForm.statnco1.disabled=false;
    document.ProcessForm.schdcop2.disabled=false;
  }
  if (document.ProcessForm.multlt03.checked==false) {
    document.ProcessForm.schdprn3.disabled=true;
    document.ProcessForm.statnco2.disabled=true;
    document.ProcessForm.schdcop3.disabled=true;
  } else {
    document.ProcessForm.schdprn3.disabled=false;
    document.ProcessForm.statnco2.disabled=false;
    document.ProcessForm.schdcop3.disabled=false;
  }

  if (document.ProcessForm.multlt01.checked==true &&
      isWhitespace(document.ProcessForm.schdcop1.value)) {
    document.ProcessForm.prntbttn.disabled=true;     
    return;
  }

  if (document.ProcessForm.multlt02.checked==true &&
      isWhitespace(document.ProcessForm.schdcop2.value)) {
    document.ProcessForm.prntbttn.disabled=true;
    return;
  }

  if (document.ProcessForm.multlt03.checked==true &&
      isWhitespace(document.ProcessForm.schdcop3.value)) {
    document.ProcessForm.prntbttn.disabled=true;
    return;
  }

  if (document.ProcessForm.multlt01.checked==false &&
      document.ProcessForm.multlt02.checked==false &&
      document.ProcessForm.multlt03.checked==false) {
    document.ProcessForm.prntbttn.disabled=true;
    return;
  }

    document.ProcessForm.prntbttn.disabled=false;

}
function bulkPrint() {
  f = document.ProcessForm;

  var num_patients = 0
  for(var e = 0; e < ProcessForm.elements.length; e++) {
    var el=ProcessForm.elements[e] ;
    if(el.name.match(/admissno/) && el.checked==true) {
      num_patients++
    }
  }
  if(num_patients > 95) {
    alert("A maximum of 95 patients can be selected for " +
          "bulk printing.\n" +
          "You currently have " + num_patients  + " selected.\n" +
          "Please print the labels in two batches");
  }

  if(validateMandatory(ProcessForm)) {
    i = f.schdprn1.selectedIndex;
    f.redirect.value += '&sschdpr1=' + f.schdprn1.options[i].value;
    i = f.schdprn2.selectedIndex;
    f.redirect.value += '&sschdpr2=' + f.schdprn2.options[i].value;
    i = f.schdprn3.selectedIndex;
    f.redirect.value += '&sschdpr3=' + f.schdprn3.options[i].value;
    i = f.labeltyp.selectedIndex;
    f.redirect.value += '&slabelty=' + f.labeltyp.options[i].value;
    i = f.statnco1.selectedIndex;
    f.redirect.value += '&sstatnc1=' + f.statnco1.options[i].value;
    i = f.statnco2.selectedIndex;
    f.redirect.value += '&sstatnc2=' + f.statnco2.options[i].value;

    ProcessForm.submit();
  }
}
function SetUpLabelForm() {
  f = document.ProcessForm;
  for (var i=0; i < f.schdprn1.length; i++) {
    if (trim(f.schdprn1.options[i].value) == trim(f.sschdpr1.value)) {
      f.schdprn1.selectedIndex=i;
    }
  }
  for (var i=0; i < f.schdprn2.length; i++) {
    if (trim(f.schdprn2.options[i].value) == trim(f.sschdpr2.value)) {
      f.schdprn2.selectedIndex=i;
    }
  }
  for (var i=0; i < f.schdprn3.length; i++) {
    if (trim(f.schdprn3.options[i].value) == trim(f.sschdpr3.value)) {
      f.schdprn3.selectedIndex=i;
    }
  }
  for (var i=0; i < f.labeltyp.length; i++) {
    if (trim(f.labeltyp.options[i].value) == trim(f.slabelty.value)) {
      f.labeltyp.selectedIndex=i;
    }
  }
  for (var i=0; i < f.statnco1.length; i++) {
    if (trim(f.statnco1.options[i].value) == trim(f.sstatnc1.value)) {
      f.statnco1.selectedIndex=i;
    }
  }
  for (var i=0; i < f.statnco2.length; i++) {
    if (trim(f.statnco2.options[i].value) == trim(f.sstatnc2.value)) {
      f.statnco2.selectedIndex=i;
    }
  }
}
function bulkPrintA4Sheet() {
  var num_patients = 0
  for(var e = 0; e < ProcessForm.elements.length; e++) {
    var el=ProcessForm.elements[e] ;
    if(el.name.match(/admissno/) && el.checked==true) {
      num_patients++
    }
  }
  if(num_patients == 0) {
     alert("No Print Label (Patient) checkboxes selected!");
     return;
  }
  var template="452";
  var PTCNA4TM=trim("%STANDARD.01.045.PTCNA4TM");
  if(!isWhitespace(PTCNA4TM)) {
     template=PTCNA4TM;
  }
  linkurl="patweb98.pbl?reportno=01&template=" + template + "&nourselc=1";
  Left=(document.body.clientWidth-390)/2;
  DFrameLink(linkurl,100,Left,390,140);
}
</script>
</head>
<body onload="PageLoad(event);
              ProcessLoad2();
              SetCop();
              disablePrintFields();
              SetUpLabelForm()">
<form name=SelectPeriod action=patweb92.pbl method=get style="margin:0">
 <input type=hidden name=reportno value=6>
 <input type=hidden name=template value=4>
 <input type=hidden name=viewtype value="%PATWEB92.06.011">
 <input type=hidden name=schdprn1 value="">
 <input type=hidden name=schdprn2 value="">
 <input type=hidden name=schdprn3 value="">
 <input type=hidden name=labeltyp value="">
 <input type=hidden name=statnco1 value="">
 <input type=hidden name=statnco2 value="">
 <input type=hidden name=schdcop1 value="">
 <input type=hidden name=schdcop2 value="">
 <input type=hidden name=schdcop3 value="">
 <input type=hidden name=sschdpr1 id=sschdpr1 value="%PATWEB92.06.055">
 <input type=hidden name=sschdpr2 id=sschdpr2 value="%PATWEB92.06.056">
 <input type=hidden name=sschdpr3 id=sschdpr3 value="%PATWEB92.06.057">
 <input type=hidden name=slabelty id=slabelty value="%PATWEB92.06.052">
 <input type=hidden name=sstatnc1 id=sstatnc1 value="%PATWEB92.06.053">
 <input type=hidden name=sstatnc2 id=sstatnc2 value="%PATWEB92.06.054">
 <input type=hidden name=ptcnhdps value="%STANDARD.01.025.080.250.1.1">

 <table cellpadding=3 bgcolor=#CCCCCC border=0 width=100%>
  <tr><td class=DataLabel>Ward</td>
      <td><select name=wardcode class=SelectMed
                  onChange="SubmitSelection();">
            <option value="  ">ALL</option>
             %PATWEB92.06.012.2
           </select></td>
      <td align=right>
          <input type=button value="<<" class=SmallButton
                 onClick='location.href="%PATWEB92.06.002"'>
          %PATWEB92.06.007
          <input type=button value=">>" class=SmallButton
                 onClick='location.href="%PATWEB92.06.001"'>
          <a href='javascript:SelectDateFrame();'>
             <img src="../images/DateLookup.gif" border=0 hspace=1 align=absmiddle
                  alt="Select Date"></a>
          <a href='javascript:SelectView2("0");'>
             <img src=../images/DayIcon.gif border=0 hspace=1 align=absmiddle
                  alt="View Today"></a>
          <a href='javascript:SelectView2("1");'>
             <img src=../images/WeekIcon.gif border=0 hspace=1 align=absmiddle
                  alt="View This Week"></a>
          <a href='javascript:SelectView2("2");'>
             <img src=../images/MonthIcon.gif border=0 hspace=1 align=absmiddle 
                  alt="View This Month"></a></td>
      <td class="DataLabel" align="right">Legend
          <img src="../images/Help16.gif" border="0" hspace=2 align=absmiddle
               onClick="DispMapping();" /></td></tr>
 </table>
</form>

<form name=ProcessForm method=post action=rshweb02.pbl style="margin:0">
 <input type=hidden name=reportno value=2>
 <input type=hidden name=updttype value="L">
 <input type=hidden name=redirect
               value="patweb92.pbl?reportno=6&template=4&viewtype=%PATWEB92.06.011">
 <input type=hidden name=nextpage value="5">
 <input type=hidden name=sschdpr1 id=sschdpr1 value="%PATWEB92.06.055">
 <input type=hidden name=sschdpr2 id=sschdpr2 value="%PATWEB92.06.056">
 <input type=hidden name=sschdpr3 id=sschdpr3 value="%PATWEB92.06.057">
 <input type=hidden name=slabelty id=slabelty value="%PATWEB92.06.052">
 <input type=hidden name=sstatnc1 id=sstatnc1 value="%PATWEB92.06.053">
 <input type=hidden name=sstatnc2 id=sstatnc2 value="%PATWEB92.06.054">

 <table cellspacing=0 border=1 width=100%>
  <tr><td class=HeadingCell align=center colspan=6>Bulk Print List</td></tr>
 </table>

 <table id=tblPatients cellspacing=0 border=1 width=100%>
  <tr id=spnAus><td class=HeadingCell><b>Visit No.</b></td>
      <td class=HeadingCell><b>Patient Name</b></td>
      <td class=HeadingCell><b>Status</b></td>
      <td class=HeadingCell><b>Expected Ward</b></td>
      <td class=HeadingCell><b>Expected Date</b></td>
      <td class=HeadingCell><b>Print</b></td></tr>
  <tr id=spnNz><td class=HeadingCell><b>Visit No.</b></td>
      <td class=HeadingCell><b>Patient Name</b></td>
      <td class=HeadingCell><b>Full Procedure Description</b></td>
      <td class=HeadingCell><b>Status</b></td>
      <td class=HeadingCell><b>Expected Ward</b></td>
      <td class=HeadingCell><b>Expected Date</b></td>
      <td class=HeadingCell><b>Print</b></td></tr>
  %PATWEB92.06.015
 </table>

 <table cellspacing=0 border=0 width=100%>
  <tr><td class=DataLabel>Printer</td>
      <td><input type=checkbox checked value="1"
          name=multlt01 id=multlt01 onclick='disablePrintFields();'>
          <select name=schdprn1 id=schdprn1  class=SelectBig
                  onchange="UpdateFields();">
           %STANDARD.01.001.PATWEB70.01
          </select></td>
      <td class=DataLabel><b>Type of Label</b></td>
      <td><select name=labeltyp id=labeltyp class=SelectBig
                  onchange="UpdateFields();">
           %STANDARD.01.019
          </select></td>
      <td>Number of Labels</td>
      <td><select name=schdcop1 id=schdcop1 title='Number of Copies'
                  onchange="UpdateFields();disablePrintFields();">
          <option></option>
           %STANDARD.01.027.3.1
          </select></td></tr>

  <tr><td>Printer</td>
      <td><input type=checkbox checked value="1"
          name=multlt02 id=multlt02 onclick='disablePrintFields();'>
          <select name=schdprn2 id=schdprn2 class=SelectBig
                  onchange="UpdateFields();">
           %STANDARD.01.001.PATWEB70.02
          </select></td>
      <td><b>Front Sheet Stationery Code</b></td>
      <td><select name=statnco1 id=statnco1  class=SelectBig
                  onchange="UpdateFields();">
           %STANDARD.01.020.000
          </select></td>
      <td>Number of Copies</td>
      <td><select name=schdcop2 id=schdcop2 title='Number of Copies'
                  onchange="UpdateFields();disablePrintFields();">
           <option></option>
          </select></td></tr>

  <tr><td class=DataLabel>Printer</td>
      <td><input type=checkbox checked value="1"
          name=multlt03 id=multlt03 onclick='disablePrintFields();'>
          <select name=schdprn3 id=schdprn3 class=SelectBig title="Printer" 
                  onchange="UpdateFields();">
            %STANDARD.01.001.PATWEB70.02
          </select></td>
      <td><b>Election Form Stationery Code</b></td> 
      <td><select name=statnco2 id=statnco2 class=SelectBig
                   onchange="UpdateFields();">
           %STANDARD.01.020.000
          </select></td>
      <td class=DataLabel>Number of Copies</td>
      <td><select name=schdcop3 id=schdcop3 title='Number of Copies'
                  onchange="UpdateFields();disablePrintFields();">
           <option></option>
          </select></td></tr>

  <tr><td align=center colspan=6>
          <input type=button class="button" id="prntbttn" Value="Print"
           onclick="bulkPrint();">
          <input class="button" type=button value=Reset
                 onClick="clearData();">
          <span id="InsertA4LabelButton" style="display: none">
          <input type=button class="button" id="prntbttn"
           value="Print A4 Labels" onclick="bulkPrintA4Sheet();">
          </span>
      </td></tr>
 </table>
</form>

<script type="text/javascript">
 var PTCNA4LB="%STANDARD.01.045.PTCNA4LB";
 if(PTCNA4LB == "1") {
   document.getElementById("InsertA4LabelButton").style.display="";
 }
 ptcnhdps="%STANDARD.01.025.080.250.1.1";
 if (ptcnhdps==1) {
   document.getElementById('spnNz').style.display = "";
   document.getElementById('spnAus').style.display = "none";
 }
 else {
   document.getElementById('spnNz').style.display = "none";
   document.getElementById('spnAus').style.display = "";
 }    
function SetCop() {
//
 Schdcop2="%PATWEB92.06.023";
 X = Schdcop2 - 1
 for (var i =0 ; i < document.ProcessForm.schdcop2.length; i++) {
  if (i==X) {
       document.ProcessForm.schdcop2.selectedIndex=i } };
//
 Schdcop3="%PATWEB92.06.024";
 X = Schdcop3 - 1
 for (var i =0 ; i < document.ProcessForm.schdcop3.length; i++) {
  if (i==X) {
       document.ProcessForm.schdcop3.selectedIndex=i } };
//
}
</script>
