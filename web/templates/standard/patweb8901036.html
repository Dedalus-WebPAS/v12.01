<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/preadmission.js"></script>
<script type="text/javascript">
function switchPresIll() {
  if (document.UpdateForm.presilsw.checked==true) {
    PresIllCodHdr.innerHTML=presillnumhdr.innerHTML;
    PresIllCod.innerHTML=presillnum.innerHTML;
    validateCode(4,document.UpdateForm.ptmis026,document.UpdateForm.mbsdesc1);
    if (isWhitespace(document.UpdateForm.ptmis026.value)) {
      document.UpdateForm.ptmis026.value="";
    }
  } else {
    PresIllCodHdr.innerHTML=presillcodhdr.innerHTML;
    PresIllCod.innerHTML=presillcod.innerHTML;
  }

  if(isWhitespace(document.UpdateForm.ptmis026.value)) {
    document.UpdateForm.ptmis026.value=""
  }
}
function chkDOS(datefield) {
  if (!isWhitespace(datefield.value)) {
    if (!ChkDateTime(UpdateForm.ptmis001,null,datefield,null)) {
      alert(datefield.title+" cannot be before Admission Date");
      return false;
    }
  }
  return true;
}
function mandatoryItemCode(ItemCode,DateofService,ServiceQuantity) {
  if (!isWhitespace(ItemCode.value)) {
    DateofService.className="Mandatory FutureDate";
    ServiceQuantity.className="Mandatory Integer";
    ServiceQuantity.value=1;
    justifyRight(ServiceQuantity);
  } else {
    DateofService.className="FutureDate";
    ServiceQuantity.className="DefaultBlank";
  }
}
function ItemCodeSearchFrame(ItemType,ItemCode,ItemDesc) {
  if (ItemType.value=="6") {
    MiscChargeSearchFrame(ItemCode,ItemDesc);
  }
  if (ItemType.value=="3") {
    MbsSearchFrame(ItemCode,ItemDesc);
  }
}
function validateItemCode(ItemType,ItemCode,ItemClam,ItemFund,ItemTabl,ItemDesc) {
  ItemCode.value = ItemCode.value.replace(/ /g,"");
  if (ItemType.value=="6") {
    validateMsc1(ItemCode,ItemClam,ItemFund,ItemTabl,ItemDesc);
  }
  if (ItemType.value=="3") { validateCode(4,ItemCode,ItemDesc); }
}
function disableAllAdmFields() {
  if (document.UpdateForm.admnstat.value!="1") {

//    document.UpdateForm.ptmis001.disabled=true;
    document.UpdateForm.ptmis001.className="Readonly";
    document.UpdateForm.ptmis001.readOnly=true;

//  document.UpdateForm.ptmis002.disabled=true;
    document.UpdateForm.ptmis002.className="Readonly";
    document.UpdateForm.ptmis002.readOnly=true;

//  document.UpdateForm.ptvis043.disabled=true;
    IntendedStayDIV.innerHTML=IntendedStaySPAN.innerHTML;

//    document.UpdateForm.ptmis030.disabled=true;
    document.UpdateForm.ptmis030.className="Readonly";
    document.UpdateForm.ptmis030.readOnly=true;

//  document.UpdateForm.ptvis076.disabled=true;
    DischargeIntentionDIV.innerHTML=DischargeIntentionSPAN.innerHTML;

//  document.UpdateForm.ptelg014.disabled=true;
    PEAIndicatorDIV.innerHTML=PEAIndicatorSPAN.innerHTML;

//  document.UpdateForm.ptelg033.disabled=true;
    EmergencyAdmissionDIV.innerHTML=EmergencyAdmissionSPAN.innerHTML;

//  document.UpdateForm.ptmis027.disabled=true;
    ClaimTypeDIV.innerHTML=ClaimTypeSPAN.innerHTML;

//    document.UpdateForm.ptmis013.disabled=true;
//    document.UpdateForm.ptmis014.disabled=true;

//    document.UpdateForm.ptmis015.disabled=true;
    document.UpdateForm.ptmis015.className="Readonly";
    document.UpdateForm.ptmis015.readOnly=true;

//  document.UpdateForm.ptmis020.disabled=true;
    document.UpdateForm.ptmis020.className="Readonly";
    document.UpdateForm.ptmis020.readOnly=true;
//  document.UpdateForm.ptmis021.disabled=true;
    document.UpdateForm.ptmis021.className="Readonly";
    document.UpdateForm.ptmis021.readOnly=true;

//  document.UpdateForm.funddesc.disabled=true;
//  document.UpdateForm.tabldesc.disabled=true;
    document.UpdateForm.funddesc.className="Readonly";
    document.UpdateForm.tabldesc.className="Readonly";
    document.UpdateForm.funddesc.readOnly=true;
    document.UpdateForm.tabldesc.readOnly=true;

    document.UpdateForm.HealthFundIMG.disabled=true;
    document.UpdateForm.eraseimg.disabled=true;
  }
}
function validateOECRequired(theForm) {
  for (i=0; i<theForm.elements.length; i++) {
    el=theForm.elements[i]
    if (el.className.match(/OECRequired/)) {
      if (!checkOECString(el,el.title)) { return false; }
    }
  }
  return true;
}
function alertOEC(OECpmifield) {
  alert("Online Eligibility Details Incomplete. Request Not Processed.\n"+
        OECpmifield.title+" is a required OEC PMI field.\n"+
        "Please enter it now.");
}
function checkOECString (theField, s, emptyOK) {
  if (checkOECString.arguments.length == 2) { emptyOK = false; }
  if ((emptyOK == true) && (isEmpty(theField.value))) { return true; }
  if (isWhitespace(theField.value)) {
    return warnOECEmpty (theField, s);
  } else {
    return true;
  }
}
function warnOECEmpty (theField, s) {
  alert("Online Eligibility Details Incomplete. Request Not Processed.\n"
        + s + " is a required OEC field.\nPlease enter it now." )
  theField.focus()
  return false
}
function OECRequired() {
 if (document.UpdateForm.oecchbox.checked == true) {
   if (UpdateForm.ptvis111.type!="hidden") {
     if (UpdateForm.ptvis111.className=="Mandatory") {
       UpdateForm.ptvis111.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptvis111.className="OECRequired";      //Presenting Illness
     }
   } else {
     if (UpdateForm.ptmis026.className=="Mandatory") {
       UpdateForm.ptmis026.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis026.className="OECRequired";      //Presenting Illness
     }
     if (UpdateForm.mbsdesc1.className=="Mandatory") {
       UpdateForm.mbsdesc1.className="OECRequired Mandatory";
     } else {
       UpdateForm.mbsdesc1.className="OECRequired";      //Presenting Illness
     }
   }
   if (UpdateForm.ptvis043.className=="Mandatory") {
     UpdateForm.ptvis043.className="OECRequired Mandatory";
   } else {
     UpdateForm.ptvis043.className="OECRequired";        //Intended Stay
   }
   if (UpdateForm.ptmis020.className=="Mandatory") {
     UpdateForm.ptmis020.className="OECRequired Mandatory";
   } else {
     UpdateForm.ptmis020.className="OECRequired";        //Diagnosis
   }
   if (UpdateForm.ptmis027.className=="Mandatory") {
     UpdateForm.ptmis027.className="OECRequired Mandatory";
   } else {
     UpdateForm.ptmis027.className="OECRequired";        //Claim Type
   }
   if (UpdateForm.funddesc.className=="Mandatory") {
     UpdateForm.funddesc.className="OECRequired Mandatory";
   } else {
     UpdateForm.funddesc.className="OECRequired";        //Health Fund Code
   }
   if (UpdateForm.tabldesc.className=="Mandatory") {
     UpdateForm.tabldesc.className="OECRequired Mandatory";
   } else {
     UpdateForm.tabldesc.className="OECRequired";        //Health Fund Code
   }
   UpdateForm.ptmis030.className="OECRequired Integer";  //Planned Length
   UpdateForm.ptvis076.className="OECRequired";          //Discharge Intention
   UpdateForm.ptmis015.className="OECRequired";          //Member Number
   UpdateForm.ptelg014.className="OECRequired";          //Member Number
   UpdateForm.ptelg033.className="OECRequired";          //Member Number
   } else {
    if (UpdateForm.ptvis111.type!="hidden") {
      if (UpdateForm.ptvis111.className=="OECRequired Mandatory") {
        UpdateForm.ptvis111.className="Mandatory";       //Intended Stay
      } else {
        UpdateForm.ptvis111.className="";                //Intended Stay
      }
    } else {
      if (UpdateForm.ptmis026.className=="OECRequired Mandatory") {
        UpdateForm.ptmis026.className="Mandatory";
      } else {
        UpdateForm.ptmis026.className="";                //Presenting Illness
      }
      if (UpdateForm.mbsdesc1.className=="OECRequired Mandatory") {
        UpdateForm.mbsdesc1.className="Mandatory";
      } else {
        UpdateForm.mbsdesc1.className="";                //Presenting Illness
      }
    }
    if (UpdateForm.ptvis043.className=="OECRequired Mandatory") {
      UpdateForm.ptvis043.className="Mandatory";         //Intended Stay
    } else {
      UpdateForm.ptvis043.className="";                  //Intended Stay
    }
    if (UpdateForm.ptmis020.className=="OECRequired Mandatory") {
      UpdateForm.ptmis020.className="Mandatory";         //Diagnosis
    } else {
      UpdateForm.ptmis020.className="";                  //Diagnosis
    }
    if (UpdateForm.ptmis027.className=="OECRequired Mandatory") {
      UpdateForm.ptmis027.className="Mandatory";         //Claim Type
    } else {
      UpdateForm.ptmis027.className="";                  //Claim Type
    }
    if (UpdateForm.funddesc.className=="OECRequired Mandatory") {
      UpdateForm.funddesc.className="Mandatory";         //Health Fund
    } else {
      UpdateForm.funddesc.className="";                  //Health Fund
    }
    if (UpdateForm.tabldesc.className=="OECRequired Mandatory") {
      UpdateForm.tabldesc.className="Mandatory";         //Health Fund
    } else {
      UpdateForm.tabldesc.className="";                  //Health Fund
    }
    UpdateForm.ptmis030.className="Integer";             //Planned Length of Stay
    UpdateForm.ptvis076.className="";                    //Discharge Intention
    UpdateForm.ptmis015.className="";                    //Member Number
    UpdateForm.ptelg014.className="";                    //Member Number
    UpdateForm.ptelg033.className="";                    //Member Number
  }
}
function disableReqBtn() {
  if (document.UpdateForm.oecchbox.checked==true) {
    document.UpdateForm.ReqButtn.disabled=false;
  } else {
    document.UpdateForm.ReqButtn.disabled=true;
  }
}
function SubmitUpd() {

  if (document.UpdateForm.ptvis043.value.substr(3,1)=='1' &&
      document.UpdateForm.ptmis030.value <= 0) {
    alert('Planned Length of Stay must be more than 0 for Overnight Patient.');
    return;
  } 

  if (document.UpdateForm.ptvis043.value.substr(3,1)=='2' &&
      document.UpdateForm.ptmis030.value != 0) {
    alert('Planned Length of Stay must be 0 for Same Day Patient.');
    return;
  }

  if (isWhitespace(document.UpdateForm.admissno.value)) {
    alert("Invalid Admission Number.");
    return;
  }
  if (!validateMandatory(document.UpdateForm)) { return; }
  if (!validateOECRequired(document.UpdateForm)) { return; }
  if (!isWhitespace(document.UpdateForm.ptmis013.value)) {
    if (!validateParticipant(document.UpdateForm.ptmis013.value,"OEC")) {
      return;
    }
  }
  if (!isWhitespace(UpdateForm.ptmis013.value)) {
    if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
                       UpdateForm.funddesc,UpdateForm.tabldesc)) {
      ans=confirm("Select another active health fund table? ");
      if (ans==true) { return; }
    }
  }
  if (UpdateForm.oes01007!=undefined) {
    if (!chkDOS(UpdateForm.oes01007)) { return; }
    if (!chkDOS(UpdateForm.oes02007)) { return; }
    if (!chkDOS(UpdateForm.oes03007)) { return; }
    if (!chkDOS(UpdateForm.oes04007)) { return; }
    if (!chkDOS(UpdateForm.oes05007)) { return; }
  }
  if (document.UpdateForm.oecchbox.checked==true) {
    document.UpdateForm.ptvis109.value="1";
  } else {
    document.UpdateForm.ptvis109.value="0";
  }
  if (document.UpdateForm.admnstat.value=='1') {
    if (confirm("Do you want to update the preadmission with\n" +
                "changes made on the OEC request?\n\n" +
                "OK to update the preadmission or\n" +
                "CANCEL to proceed without the preadmission update")==true) {
      document.UpdateForm.updtadmn.value="1";
    } else {
      document.UpdateForm.updtadmn.value="0";
    }
  } else {
    document.UpdateForm.updtadmn.value="0";
  }
  SubmitHidden(UpdateForm);
}
function ShowMBSFields() {
  if(document.getElementById("mbsbox").checked == true) {
    ExtraMBS.innerHTML=mbscodes.innerHTML;
  } else {
    ExtraMBS.innerHTML=blanklabel.innerHTML;
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);
 checkBasicCoverRate(document.UpdateForm.ptmis027);">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form name=linkForm action=patweb89.pbl method=post style="margin:0">
 <input type=hidden name=reportno value=1>
 <input type=hidden name=template value=1>
 <input type=hidden name=urnumber value="%PATWEB89.01.003">
 <input type=hidden name=admissno value="%PATWEB89.01.101">
</form>
<form name=PatientLinks method=get style="margin:0">
 <input type=hidden name=reportno value=1>
 <input type=hidden name=template value=004>
 <input type=hidden name=urnumber value="%PATWEB89.01.003">
 <input type=hidden name=admissno value="%PATWEB89.01.081">
 <input type=hidden name=MenuType value="%PATWEB89.01.088">
</form>
<form name=UpdateForm method=post action=patweb89.pbl style="margin:0">
 <input type=hidden name=reportno value="2">
 <input type=hidden name=template value="036">
 <input type=hidden name=urnumber value="%PATWEB89.01.003">
 <input type=hidden name=admissno value="%PATWEB89.01.081">
 <input type="hidden" name="updatety" value="6">
 <input type="hidden" name="redirect" value="%PATWEB89.01.001.patweb78.06.006">
 <input type="hidden" name="admnstat" value="%PATWEB89.01.924">
 <input type="hidden" name="ptvis109" value="%PATWEB89.01.298.032">
 <input type="hidden" name="ptvis022" value="%PATWEB89.01.225.0">
 <input type="hidden" name="pillcode" value="%PATWEB89.01.298.034.1">
 <input type="hidden" name="pillcmbs" value="%PATWEB89.01.125">
 <input type="hidden" name="trnsfsrc" value="%PATWEB89.01.193.0">
 <input type="hidden" name="medicrdn"
        title="Medicare Card Number" value="%PATWEB89.01.027">
 <input type="hidden" name="medicrdr"
        title="Medicare Card Reference Number" value="%PATWEB89.01.649">
 <input type="hidden" name="ptmis017" value="%PATWEB89.01.118.0">
 <input type=hidden name=updtadmn value="1">

 <table border=0 colspan=1 width=100% cellspacing=1 cellpadding=1>
  <tr><td class=HeadingCell align=center>
          Single Online Eligibility Request - Health Fund</td></tr>

  <tr><td align=center>
   <table border=0 width=80% cellpadding=0 cellspacing=0>
    <tr><td>Patient OEC Consent</td>
        <td colspan=2>
            <input type="checkbox" name="oecchbox" value="0" tabindex=1
                   onclick="disableReqBtn();OECRequired();"></td></tr>

    <tr><td>Title</td>
        <td colspan=2><b>%PATWEB89.01.005.1</b></td></tr>

    <tr><td>Surname</td>
        <td colspan=2><b>%PATWEB89.01.009</b></td></tr>

    <tr><td>Given Names</td>
        <td colspan=2><b>%PATWEB89.01.010</b></td></tr>

    <tr><td>Sex</td>
        <td colspan=2><b>%PATWEB89.01.019</b></td></tr>

    <tr><td> Date of Birth</td>
        <td colspan=2><b>%PATWEB89.01.020</b></td></tr>

    <tr><td class=DataLabel>Admission Date</td>
        <td colspan=2>
            <input type="text" size="12" tabindex=2 name=ptmis001
                   value="%PATWEB89.01.102" class=Mandatory
                   title="Admission Date"
                   onblur="checkDate(this,'Admission Date')">
              <img src="../images/DateLookup.gif" class=Icon
                   onclick="DateLookupFrame(UpdateForm.ptmis001);">
            Time&nbsp;&nbsp;
            <input type=text name=ptmis002 tabindex=3 size=8
                   value="%PATWEB89.01.103" class=Mandatory title="Admission Time">
              <img src="../images/DateTimeStamp.gif" class=Icon
                   onclick="SetCurrentDateTime(null,UpdateForm.ptmis002);">
              <img src="../images/TimeLookup.gif" class=Icon
                   onclick="TimeLookupFrame(UpdateForm.ptmis002);">
        </td>
    </tr>

    <tr><td class=DataLabel>Intended Stay </td>
        <td colspan=2>
            <div id=IntendedStayDIV>
            <select name=ptvis043 tabindex=5 title="Intended Stay">
             <option> </option>
              %PATWEB89.01.246.2
            </select>
            </div>
        </td>
    </tr>

    <tr><td class=DataLabel>Planned Length of Stay</td>
        <td colspan=2>
            <input type=text size=5 maxlength=3 name=ptmis030
                    tabindex=10 title='Expected Length of Stay'
                    class=Integer value="%PATWEB89.01.129"
                    onblur="checkInteger(this,this.value);">
        </td>
    </tr>

    <tr><td class=DataLabel>Discharge Intention</td>
        <td colspan=2>
            <div id=DischargeIntentionDIV>
            <select name=ptvis076 tabindex=15 title="Discharge Intention">
             <option> </option>
              %PATWEB89.01.292.2
            </select>
            </div>
        </td>
    </tr>

    <tr><td class=DataLabel>PEA Indicator</td>
        <td colspan=2>
            <div id=PEAIndicatorDIV>
            <select name=ptelg014 title="PEA Indicator" tabindex=20>
              %PATWEB89.01.977
             </select>
            </div>
        </td>
    </tr>

    <tr><td class=DataLabel>Emergency Admission</td>
        <td colspan=2>
            <div id=EmergencyAdmissionDIV>
            <select name=ptelg033 title="Emergency Admission" tabindex=25>
             %PATWEB89.01.978
            </select>
            </div>
        </td>
    </tr>

    <tr><td class=DataLabel><div id=PresIllCodHdr></div></td>
        <td><div id=PresIllCod></div></td>
        <td><input type="checkbox" name="presilsw" value="1" tabindex=35
                   title="Presenting Illness MBS"
                   onclick="switchPresIll();OECRequired();">
            <b>Switch to MBS Presenting Illness Number &nbsp;</b></td></tr>

    <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
        <td colspan=2>
            <div id=ClaimTypeDIV>
            <select name=ptmis027 tabindex=40 title="%STANDARD.01.017.CL">
             <option> </option>
              %PATWEB89.01.126.2
            </select>
            </div>
        </td>
    </tr>

    <tr><td class=DataLabel>Health Fund
        <input type="hidden" name="ptmis013" value="%PATWEB89.01.114.0"></td>
        <td colspan=2>
            <input type=text size=35 name="funddesc" maxlength="30"
                   value="%PATWEB89.01.114.1" readonly tabindex=45
                   title="Health Fund">
            &nbsp;&nbsp;Level&nbsp;&nbsp;
            <input type="hidden" name="ptmis014" value="%PATWEB89.01.115.0">
            <input type="text" size=20 maxlength=30 name="tabldesc"
                   value="%PATWEB89.01.115.1" readonly>
              <img src="../images/SearchIcon.gif" class=Icon
                   name="HealthFundIMG"
                   onclick="HealthFundSearchFrameNoFocus(UpdateForm.ptmis013,
                                                         UpdateForm.funddesc,
                                                         UpdateForm.ptmis014,
                                                         UpdateForm.tabldesc);">
              <img src="../images/erase.gif" name="eraseimg" class=Icon
                   onclick="clrFields(UpdateForm.ptmis013,
                                      UpdateForm.funddesc,
                                      UpdateForm.ptmis014,
                                      UpdateForm.tabldesc);"></td></tr>

    <tr><td class=DataLabel>Member Number</td>
        <td colspan=2>
            <input type=text size=20 maxlength=19 value="%PATWEB89.01.116"
                   name=ptmis015 tabindex=50 title="Member Number">
        </td></tr>

    <tr><td class=DataLabel>Diagnosis</td>
        <td colspan=2>
            <input type=text name="ptmis020" size=50 maxlength=80 tabindex=55
                   value="%PATWEB89.01.121" title="Diagnosis">
        </td>
    </tr>
  
    <tr><td class=DataLabel>
       <div id=Diagnosis2Label>Diagnosis Line 2 - view only</div></td>
        <td colspan=2>
          <div id=Diagnosis2Field> 
          <input type="text" id="ptmis021" name="ptmis021" size=50 maxlength=80
           value="%PATWEB89.01.122" readonly title="Diagnosis2">
        </td>
       </div>
    </tr>

   <tr><td class=DataLabel><div id=MBSOptionHdr style="width:350p;color:red;">
       </div></td>
       <td><div id=MBSOption></div></td>
   </tr>

   <tr><td align=center colspan="3"><hr></td></tr>

   <tr><td colspan=2><div id=ExtraMBS></div></td></tr>

   </table></td></tr>
  <tr><td align=center>
   <table border=0 colspan=0 width=70% cellspacing=0 cellpadding=0>
    <tr><td><b>Date</b></td>
        <td><b>Type</b></td>
        <td><b>Item / Description</b></td>
        <td><b>Quantity</b></td></tr>

    <tr><td width=20%>
            <input type=text size=12 name=oes01007 tabindex=60
                   class="FutureDate" title="OES Service 1 Date"
                   onblur="checkDate(this,this.title);">
              <img src="../images/DateTimeStamp.gif" class=Icon
                   onclick="SetCurrentDateTime(UpdateForm.oes01007,null);">
              <img src="../images/DateLookup.gif" class=Icon
                   onclick="DateLookupFrame(UpdateForm.oes01007);"></td>
        <td width=12%>
            <select name=oes01004 title="Type" tabindex=65>
             <option value="6">Misc.Item</option>
            </select></td>
        <td><input type=text name=oes01005 title="Item Code" size=10 maxlength=10
                   tabindex=70
                   onblur="validateItemCode(document.UpdateForm.oes01004,
                                            document.UpdateForm.oes01005,
                                            document.UpdateForm.ptmis027,
                                            document.UpdateForm.ptmis013,
                                            document.UpdateForm.ptmis014,
                                            document.UpdateForm.d_oes01005);
                          mandatoryItemCode(this,document.UpdateForm.oes01007,
                                            document.UpdateForm.oes01006);">
            <input type=text name=d_oes01005 size=50 readonly
                   class=Readonly tabindex=-1 title="Item Description">
              <img src="../images/SearchIcon.gif" class=Icon
                   onclick="ItemCodeSearchFrame(document.UpdateForm.oes01004,
                                                document.UpdateForm.oes01005,
                                                document.UpdateForm.d_oes01005);">
              <img src="../images/erase.gif" class=Icon
                   onclick="clrFields(UpdateForm.oes01005,
                                      UpdateForm.d_oes01005,
                                      UpdateForm.oes01006);
                            mandatoryItemCode(UpdateForm.oes01005,
                                              UpdateForm.oes01007,
                                              UpdateForm.oes01006);"></td>
        <td><input type=text name=oes01006 title="Quantity" size=5 maxlength=3
                   tabindex=75
                   onblur="if (checkInteger(this,this.value))
                             {justifyRight(this);}"></td></tr>

    <tr><td><input type=text size=12 name=oes02007 class="FutureDate"
                   title="OES Service 2 Date" tabindex=80
                   onblur="checkDate(this,this.title);">
              <img src="../images/DateTimeStamp.gif" class=Icon
                   onclick="SetCurrentDateTime(UpdateForm.oes02007,null);">
              <img src="../images/DateLookup.gif" class=Icon
                   onclick="DateLookupFrame(UpdateForm.oes02007);"></td>
        <td><select name=oes02004 title="Type" tabindex=85>
             <option value="6">Misc.Item</option>
            </select></td>
        <td><input type=text name=oes02005 title="Item Code" size=10 maxlength=10
                   tabindex=90
                   onblur="validateItemCode(document.UpdateForm.oes02004,
                                            document.UpdateForm.oes02005,
                                            document.UpdateForm.ptmis027,
                                            document.UpdateForm.ptmis013,
                                            document.UpdateForm.ptmis014,
                                            document.UpdateForm.d_oes02005);
                          mandatoryItemCode(this,document.UpdateForm.oes02007,
                                            document.UpdateForm.oes02006);">
            <input type=text name=d_oes02005 size=50 readonly
                   class=Readonly tabindex=-1 title="Item Description">
              <img src="../images/SearchIcon.gif" class=Icon
                   onclick="ItemCodeSearchFrame(document.UpdateForm.oes02004,
                                                document.UpdateForm.oes02005,
                                                document.UpdateForm.d_oes02005);">
              <img src="../images/erase.gif" class=Icon
                   onclick="clrFields(UpdateForm.oes02005,
                                      UpdateForm.d_oes02005,
                                      UpdateForm.oes02006);
                            mandatoryItemCode(UpdateForm.oes02005,
                                              UpdateForm.oes02007,
                                              UpdateForm.oes02006);"></td>
        <td><input type=text name=oes02006 title="Quantity" size=5 maxlength=3
                   tabindex=95
                   onblur="if (checkInteger(this,this.value))
                             {justifyRight(this);}"></td></tr>
    <tr><td><input type=text size=12 name=oes03007 class="FutureDate"
                   title="OES Service 3 Date" tabindex=100
                   onblur="checkDate(this,this.title);">
              <img src="../images/DateTimeStamp.gif" class=Icon
                   onclick="SetCurrentDateTime(UpdateForm.oes03007,null);">
              <img src="../images/DateLookup.gif" class=Icon
                   onclick="DateLookupFrame(UpdateForm.oes03007);"></td>
        <td><select name=oes03004 title="Type" tabindex=105>
             <option value="6">Misc.Item</option>
            </select></td>
        <td><input type=text name=oes03005 title="Item Code" size=10 maxlength=10
                   tabindex=110
                   onblur="validateItemCode(document.UpdateForm.oes03004,
                                            document.UpdateForm.oes03005,
                                            document.UpdateForm.ptmis027,
                                            document.UpdateForm.ptmis013,
                                            document.UpdateForm.ptmis014,
                                            document.UpdateForm.d_oes03005);
                          mandatoryItemCode(this,document.UpdateForm.oes03007,
                                            document.UpdateForm.oes03006);">
            <input type=text name=d_oes03005 size=50 readonly
                   class=Readonly tabindex=-1 title="Item Description">
              <img src="../images/SearchIcon.gif" class=Icon
                   onclick="ItemCodeSearchFrame(document.UpdateForm.oes03004,
                                                document.UpdateForm.oes03005,
                                                document.UpdateForm.d_oes03005);">
              <img src="../images/erase.gif" class=Icon
                   onclick="clrFields(UpdateForm.oes03005,
                                      UpdateForm.d_oes03005,
                                      UpdateForm.oes03006);
                            mandatoryItemCode(document.UpdateForm.oes03005,
                                              document.UpdateForm.oes03007,
                                              document.UpdateForm.oes03006);"></td>
        <td><input type=text name=oes03006 title="Quantity" size=5 maxlength=3
                   tabindex=115
                   onblur="if (checkInteger(this,this.value))
                             {justifyRight(this);}"></td></tr>

    <tr><td><input type=text size=12 name=oes04007 class="FutureDate"
                   title="OES Service 4 Date" tabindex=120
                   onblur="checkDate(this,this.title);">
              <img src="../images/DateTimeStamp.gif" class=Icon
                   onclick="SetCurrentDateTime(UpdateForm.oes04007,null);">
              <img src="../images/DateLookup.gif" class=Icon
                   onclick="DateLookupFrame(UpdateForm.oes04007);"></td>
        <td><select name=oes04004 title="Type" tabindex=125>
             <option value="6">Misc.Item</option>
            </select></td>
        <td><input type=text name=oes04005 title="Item Code" size=10 maxlength=10
                   tabindex=130
                   onblur="validateItemCode(document.UpdateForm.oes04004,
                                            document.UpdateForm.oes04005,
                                            document.UpdateForm.ptmis027,
                                            document.UpdateForm.ptmis013,
                                            document.UpdateForm.ptmis014,
                                            document.UpdateForm.d_oes04005);
                          mandatoryItemCode(this,document.UpdateForm.oes04007,
                                            document.UpdateForm.oes04006);">
            <input type=text name=d_oes04005 size=50 readonly class=Readonly
                   tabindex=-1 title="Item Description">
              <img src="../images/SearchIcon.gif" class=Icon
                   onclick="ItemCodeSearchFrame(document.UpdateForm.oes04004,
                                                document.UpdateForm.oes04005,
                                                document.UpdateForm.d_oes04005);">
              <img src="../images/erase.gif" class=Icon
                   onclick="clrFields(UpdateForm.oes04005,
                                      UpdateForm.d_oes04005,
                                      UpdateForm.oes04006);
                            mandatoryItemCode(document.UpdateForm.oes04005,
                                              document.UpdateForm.oes04007,
                                              document.UpdateForm.oes04006);"></td>
        <td><input type=text name=oes04006 title="Quantity" size=5 maxlength=3
                   tabindex=135
                   onblur="if (checkInteger(this,this.value))
                             {justifyRight(this);}"></td></tr>

    <tr><td><input type=text size=12 name=oes05007 class="FutureDate"
                   title="OES Service 5 Date" tabindex=140
                   onblur="checkDate(this,this.title);">
              <img src="../images/DateTimeStamp.gif" class=Icon
                   onclick="SetCurrentDateTime(UpdateForm.oes05007,null);">
              <img src="../images/DateLookup.gif" class=Icon 
                   onclick="DateLookupFrame(UpdateForm.oes05007);"></td>
        <td><select name=oes05004 title="Type" tabindex=145>
             <option value="6">Misc.Item</option>
            </select></td>
        <td><input type=text name=oes05005 title="Item Code" size=10 maxlength=10
                   tabindex=150
                   onblur="validateItemCode(document.UpdateForm.oes05004,
                                            document.UpdateForm.oes05005,
                                            document.UpdateForm.ptmis027,
                                            document.UpdateForm.ptmis013,
                                            document.UpdateForm.ptmis014,
                                            document.UpdateForm.d_oes05005);
                          mandatoryItemCode(this,document.UpdateForm.oes05007,
                                            document.UpdateForm.oes05006);">
            <input type=text name=d_oes05005 size=50 readonly class=Readonly
                   tabindex=-1 title="Item Description">
              <img src="../images/SearchIcon.gif" class=Icon
                   onclick="ItemCodeSearchFrame(document.UpdateForm.oes05004,
                                                document.UpdateForm.oes05005,
                                                document.UpdateForm.d_oes05005);">
              <img src="../images/erase.gif" class=Icon
                   onclick="clrFields(oes05005,d_oes05005,oes05006);
                            mandatoryItemCode(document.UpdateForm.oes05005,
                                              document.UpdateForm.oes05007,
                                              document.UpdateForm.oes05006);"></td>
        <td><input type=text name=oes05006 title="Quantity" size=5 maxlength=3
                   tabindex=155
                   onblur="if (checkInteger(this,this.value))
                             {justifyRight(this);}"></td></tr>

    <tr><td colspan=4 align=center><br>
            <input type=button value="Request" class="button" tabindex=300
                   id="pat89req" name="ReqButtn"
                   onclick="tempDisable(this);SubmitUpd()">
            <input type=button value="Cancel" class="button" tabindex=310
                   onclick="history.go(-1);"></td></tr>
   </table></td></tr>
 </table>
</form>
</div>

<span id=presillcodhdr style="display:none">Presenting Illness Code</span>

<span id=presillcod style="display:none">
  <select name=ptvis111 title="Presenting Illness" tabindex=30>
   <option value=" "></option>
    %PATWEB89.01.298.034.2
  </select>
  <input type=hidden name=ptmis026 value=" ">
</span>

<span id=presillnumhdr style="display:none">Presenting Illness Number (MBS)</span>

<span id=presillnum style="display:none">
  <input type=text name=ptmis026 size=10 maxlength=9 value="%PATWEB89.01.125"
         title="Presenting Illness Number" tabindex=30
         onblur='validateCode(4,
                              UpdateForm.ptmis026,
                              UpdateForm.mbsdesc1,
                              UpdateForm.ptmis001);'>
  <input type=text readonly name=mbsdesc1 size=35>
    <img src="../images/SearchIcon.gif" name=mbsserch class=Icon
         onclick="MbsSearchFrame(UpdateForm.ptmis026,
                                 UpdateForm.mbsdesc1,
                                 UpdateForm.ptmis001)">
    <img src="../images/erase.gif" name=erasembs class=Icon 
         onclick="clrFields(UpdateForm.ptmis026,UpdateForm.mbsdesc1);">
  <input type=hidden name=ptvis111 value=" ">
</span>

<span id=IntendedStaySPAN style="display:none">
<input type=text name=d_ptvis043 title="Intended Stay"
 value="%PATWEB89.01.246.0" class=Readonly readOnly>
<input type=hidden name=ptvis043 value="%PATWEB89.01.246.3">
</span>

<span id=DischargeIntentionSPAN style="display:none">
<input type=text name=d_ptvis076 title="Discharge Intention"
 value="%PATWEB89.01.292.0" class=Readonly readOnly>
<input type=hidden name=ptvis076 value="%PATWEB89.01.292.1">
</span>

<span id=PEAIndicatorSPAN style="display:none">
<input type=text name=d_ptelg014 title="PEA Indicator"
 value="%PATWEB89.01.977.1" class=Readonly readOnly>
<input type=hidden name=ptelg014 value="%PATWEB89.01.977.2">
</span>

<span id=EmergencyAdmissionSPAN style="display:none">
<input type=text name=d_ptelg033 title="Emergency Admission"
 value="%PATWEB89.01.978.1" class=Readonly readOnly>
<input type=hidden name=ptelg033 value="%PATWEB89.01.978.2">
</span>

<span id=ClaimTypeSPAN style="display:none">
<input type=text name=d_ptmis027 title="Claim Type"
 value="%PATWEB89.01.126.0" class=Readonly readonly>
<input type=hidden name=ptmis027 value="%PATWEB89.01.126.1">
</span>

<span id=redmbs class=DataLabel style="display:none">
    Show Extra MBS Codes
</span>

<span id=redbmschkbox class=DataField style="display:none">
<input type=checkbox id="mbsbox" name="mbsbox" value=1
     onclick="ShowMBSFields();" />
</span>

<span id=mbscodes style="display:none">
<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td class=DataLabel colspan=3>Perform OEC Requests for each MBS Items</td></tr>
 %PATWEB89.01.999.078
<tr><td align=center colspan="3"><hr></td></tr>
<tr align=left><td align=center colspan="6"><hr></td></tr>
</table>
</span>

<span id=blanklabel style="display:none">&nbsp;</span>

<span id=diagnosis2label style="display:none"></span>

<span id=diagnosis2field style="display:none">
  <td class=DataField>%PATWEB89.01.122</td> 
</span>

<script type="text/javascript">
  if (document.UpdateForm.ptvis109.value=="1") {
    document.UpdateForm.oecchbox.checked=true;
  }
  disableReqBtn();
  if (!isWhitespace(document.UpdateForm.pillcmbs.value)) {
    document.UpdateForm.presilsw.checked=true;
  }
  switchPresIll();
  if (document.UpdateForm.admnstat.value=='1') 
  { 
    OECRequired(); 
  } else { 
    document.UpdateForm.updtadmn.value="0";
    OECRequired();
//    disableAllAdmFields(); 
  }

  var XtraMBS = "%PATWEB89.01.999.077";

  if ( XtraMBS =="1" ) {
    MBSOptionHdr.innerHTML=redmbs.innerHTML;
    MBSOption.innerHTML=redbmschkbox.innerHTML;
  } else {
    MBSOptionHdr.innerHTML=blanklabel.innerHTML;
    MBSOption.innerHTML=blanklabel.innerHTML;
  }

  if (isWhitespace(document.UpdateForm.ptmis021.value)) {
     document.getElementById("Diagnosis2Label").innerHTML=""; 
     document.getElementById("diagnosis2label").innerHTML=""; 
     document.getElementById("Diagnosis2Field").innerHTML=""; 
     document.getElementById("diagnosis2field").innerHTML="";
  }

</script>
