<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
function SessionLink(SessionKey,FinalDate) {
 if (!isWhitespace(FinalDate)) {
   alert("ERROR - Session is finalized - No new bookings can be made.\n" +
         "Please reset to Provisional to make changes to this session.");
 }
 else {
   if (!isWhitespace(document.SelectPeriod.bkthurck.value)) {
     parent.LinkForm.urnumber.value=
     document.SelectPeriod.bkthurck.value.replace(/\+/g," ");
     parent.LinkForm.reportno.value=9;
     parent.LinkForm.template.value=2;
   } 
   parent.LinkForm.sesskeys.value=SessionKey;

   SetCookie("BookTheatreReqVisitnoCookie",
             document.SelectPeriod.bkthvick.value);
   SetCookie("BookTheatreReqReqnumCookie",
             document.SelectPeriod.bkthrqck.value);
   SetCookie("TheatreRequestRedirect",
             document.SelectPeriod.bkthrdck.value);
   parent.LinkForm.submit();
   DFrameExit();
 }
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link   
//  1 - Session Date & Time
//  2 - Surgeon
//  3 - Anaesthetist
//  4 - Theatre
//  5 - Session Type
//  6 - Status
//  7 - Booking Graph 0 - 120
//  8 - Available Min
//  9 - Booked Min
// 10 - Actual Min
//---------------------------------------------------------------------------
function InitTable(TableView) {
  switch (TableView) {
    case 0: {
      t = new Table(1,0,2,"100%","center",25,25);
      t.addColumn("Session","DateTime",1,1,"left","AppointmentIcon.gif","0",140)
      t.addColumn("Surgeon","String",2,2,"left","","",150)
      t.addColumn("Anaesthetist","String",3,3,"left","","",150)
      t.addColumn("Theatre","String",4,4,"left","","",150)
      t.addColumn("Status","Graph",7,7,"left","bar1.gif","",120)
      AddTableRows()
      TableOutput(1,2);
      break;
    }
    case 1: {
      t = new Table(1,0,2,"100%","center",35,25);
      t.addColumn("Session","DateTime",1,1,"left","AppointmentIcon.gif","0",140)
      t.addColumn("Anaesthetist","String",3,3,"left","","",150)
      t.addColumn("Theatre","String",4,4,"left","","",150)
      t.addColumn("Avail. Op Min","String",8,8,"right","","",45)
      t.addColumn("Booked Op Min","String",9,9,"right","","",45)
      t.addColumn("Actual Op Min","String",10,10,"right","","",45)
      AddTableRows()
      TableOutput(1,2);
      break;
    }
  }
}
function GetTheatreRequestCookies() {
  if (GetCookieData("BookTheatreReqUrnumberCookie")!="unknown") {
    document.SelectPeriod.bkthurck.value=
    GetCookieData("BookTheatreReqUrnumberCookie");
  }
  ExpireCookiePath("BookTheatreReqUrnumberCookie");

  if (GetCookieData("BookTheatreReqVisitnoCookie")!="unknown") {
    document.SelectPeriod.bkthvick.value=
    GetCookieData("BookTheatreReqVisitnoCookie");
  }
  ExpireCookiePath("BookTheatreReqVisitnoCookie");

  if (GetCookieData("BookTheatreReqReqnumCookie")!="unknown") {
    document.SelectPeriod.bkthrqck.value=
    GetCookieData("BookTheatreReqReqnumCookie");
  }
  ExpireCookiePath("BookTheatreReqReqnumCookie");

  if (GetCookieData("TheatreRequestRedirect")!="unknown") {
    document.SelectPeriod.bkthrdck.value=
    GetCookieData("TheatreRequestRedirect");
  }
  ExpireCookiePath("TheatreRequestRedirect");
}
function SetTheatreRequestCookies() {
  SetCookie("BookTheatreReqUrnumberCookie",
            document.SelectPeriod.bkthurck.value);
  SetCookie("BookTheatreReqVisitnoCookie",
            document.SelectPeriod.bkthvick.value);
  SetCookie("BookTheatreReqReqnumCookie",
            document.SelectPeriod.bkthrqck.value);
  SetCookie("TheatreRequestRedirect",
            document.SelectPeriod.bkthrdck.value);
}
function AddEventToDate() {
  if (document.SelectPeriod.vyearmth != undefined) {
    document.SelectPeriod.vyearmth.onchange = 
    function () { SetTheatreRequestCookies(); this.form.submit(); };
  }
  if (document.SelectPeriod.lastdate != undefined) {
    document.SelectPeriod.lastdate.onchange = 
    function () { SetTheatreRequestCookies(); this.form.submit(); };
  }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);
              GetTheatreRequestCookies();AddEventToDate();
              DisplaySurgTypeFilterDefaults();">
<div id=HeadingSection>
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Theatre Session Search
</span>
<form name=SelectPeriod action=oprweb01.pbl method=get 
onsubmit="SetTheatreRequestCookies();" style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=3>
<input type=hidden name=viewtype value="%OPRWEB01.02.011">
<input type=hidden name=doctcode value="%OPRWEB01.02.103">
<input type=hidden name=bkthurck value=" ">
<input type=hidden name=bkthvick value=" ">
<input type=hidden name=bkthrqck value=" ">
<input type=hidden name=bkthrdck value=" ">
<input type=hidden name=filtsety id=filtsety value="%OPRWEB01.02.020">
<table border=0 cellpadding=3 cellspacing=3 width=100% bgcolor=#cccccc>
<tr>
  <td width=6%>
    <a href=javascript:InitTable(0)>
     <img src="../images/TableViewIcon.gif" class=Icon
      alt="Default View" title="Default View" border=0></a>
    <a href=javascript:InitTable(1)>
     <img src="../images/TableViewIcon.gif" class=Icon
      alt="Show Times" title="Show Times"></a>
  </td>
  <td width=25%>Unit&nbsp;
    <select name=docttype id=docttype title="Unit"
     onchange="SetTheatreRequestCookies();SelectPeriod.submit(this);">
     <option value=" "> </option>
     %OPRWEB01.02.013
    </select>
  </td>
  <td width=25%>Doctor&nbsp;
    <select name=doctcode id=doctcode title="Doctor"
     onchange="SetTheatreRequestCookies();SelectPeriod.submit(this);">
     <option value="  "> </option>
     %OPRWEB01.02.012
    </select>
  </td>
  <td>
    <div id='DisplaySurgTypeDIV'></div>
  </td>
  <td width=11% align=right style="vertical-align:bottom">
    <a href='javascript:SetTheatreRequestCookies();SelectDateFrame();'>
     <img src="../images/DateLookup.gif" class=Icon 
      alt="Select Date" title="Select Date"></a>
    <a href='javascript:SetTheatreRequestCookies();SelectView("0");'>
     <img src="../images/DayIcon.gif" class=Icon
      alt="View Today" title="View Today"></a>
    <a href='javascript:SetTheatreRequestCookies();SelectView("1");'>
     <img src="../images/WeekIcon.gif" class=Icon
      alt="View This Week" title="View This Week"></a>
    <a href='javascript:SetTheatreRequestCookies();SelectView("2");'>
     <img src="../images/MonthIcon.gif" class=Icon 
      alt="View This Month" title="View This Month"></a>
  </td>
</tr>
<tr>
  <td colspan=5 align=right>
  <input type=button value="<<" class=SmallButton title="Previous"
  onclick='SetTheatreRequestCookies();location.href="%OPRWEB01.02.002";'>
  %OPRWEB01.02.007
  <input type=button value=">>" class=SmallButton title="Next"
  onclick='SetTheatreRequestCookies();location.href="%OPRWEB01.02.001";'>
  </td>
</tr>
</table>
</form>
</div>

<div id=TableLocation></div>

<!--Surgery Type/Cat YD-->
<span id="DisplaySurgType" style="display:none;"> 
  %STANDARD.01.017.YD&nbsp;
  <select name=filtlocn id=filtlocn title="%STANDARD.01.017.YD"
   onchange="SetTheatreRequestCookies();SelectPeriod.submit(this);">
  <option value="  ">All</option>
  %OPRWEB01.02.022.2
  </select>
</span>
  

<script type="text/javascript">
function AddTableRows() {
%OPRWEB01.02.014.oprweb01.03.003
}

function DisplaySurgTypeFilterDefaults() {
  if (typeof DisplaySurgTypeFilter != "undefined" && 
                DisplaySurgTypeFilter == true) {
    document.getElementById('DisplaySurgTypeDIV').innerHTML=
      document.getElementById('DisplaySurgType').innerHTML;
  } else {
    document.getElementById('DisplaySurgTypeDIV').innerHTML='';
  }
}
</script>
