<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/TableSort.js></script>
<script type="text/javascript" src=../js/oprweb03.js></script>
<script type="text/javascript">
function frmSubmit() {
 SelectPeriod.submit()
}
//----------------------------------------------------------------------------
// Columns Available
//  0 - HTML Link
//  1 - Theatre
//  2 - Date & Time
//  3 - Duration
//  4 - Surgeon
//  5 - Anaesthetist
//  6 - Patient Name
//  7 - U/R
//  8 - Operation Desc
//  9 - Anaesthetic Type
// 10 - Unit
// 11 - Primary MBS 
// 12 - Procedure Description
// 13 - Current Status
// 14 - Nursing Status Ext
// 15 - Time
// 16 - Ward/Bed
// 17 - User defined time field 11
// 18 - Surgeon link
// 19 - Anaesthetist link  
// 20/1/2 - Patient alerts?
// 23 - Admitting Time
// 24 - Fasting Time Food
// 25 - Fasting Time Fluid
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",35);
 t.addColumn("Date Time","DateTime",2,2,"left nowrap ","AppointmentIcon.gif","36",70)
 t.addColumn("Admitting Time","String",23,23,"left","","",40)
 t.addColumn("Fasting Time Food","String",24,24,"left","","",40)
 t.addColumn("Fasting Time Fluids","String",25,25,"left","","",40)
 t.addColumn("Patient","String",6,6,"left","","",100)
 t.addColumn("Contact Numbers","String",31,31,"left","","",50)
 t.addColumn("Current Status","String",13,13,"left","","",40)
 t.addColumn("List Final","String",32,32,"left","","",20)
 t.addColumn("Theatre","String",29,29,"left","","",30)
 t.addColumn("List Order","String",34,34,"left","","",50)
 t.addColumn("Duration (Mins)","String",3,3,"left","","",30)
 t.addColumn("Surgeon/Anaesthetist","String",33,33,"left","","",60)
 t.addColumn("Procedure","String",8,8,"left","","",80)
 t.addColumn("Post Op Ward","String",35,35,"left","","",30)
 AddTableRows()
 t.sortTable(0,1);    // By Date and Time
 TableOutput(9,1);    // List Order
 break; }
 case 1: {
 t = new Table(1,0,2,"100%","center",25,35);
 t.addColumn("Date Time","DateTime",2,2,"left","AppointmentIcon.gif","36",150)
 t.addColumn("U/R","String",7,7,"left","","",60)
 t.addColumn("Patient","String",6,6,"left","","",150)
 t.addColumn("Anaesthetist","String",5,5,"left","","",120)
 t.addColumn("Anaesthetic","String",9,9,"left","","",120)
 AddTableRows()
 TableOutput(2,1);
 break; }
 }
}
function UpdFastingTimes(opdunqid) {
  linkurl="oprweb01.pbl?reportno=24&template=001" +
          "&valduniq=" + opdunqid
  DFrameLink(linkurl,0,75,450,350)
}
function linkToCase(LinkURL) {
  SetCookiePath("TheatreBookingList")
  location.href=LinkURL;
}
function getPreviousFilter() {
  Path=GetContentCookie("TheatreBookingList");
  if(isWhitespace(Path) || Path=="unknown") {
    ShowPage();
    return;
  }
  ExpireCookiePath("TheatreBookingList");
  getTop().content.location.href=Path;
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);
              getPreviousFilter();dispDayCmt();">
<div id=HeadingSection>
<form name=SelectPeriod action=oprweb03.pbl method=get style="margin:0">
 <input type=hidden name=reportno value=3>
 <input type=hidden name=template value=7>
 <input type=hidden name=viewtype value="%OPRWEB03.03.010">
 <input type=hidden name=deftview value="%OPRWEB03.03.027">
 <input type=hidden name=opcnscom id=opcnscom
        value="%STANDARD.01.025.042.241.0.1">
 <input type=hidden name=dispdayc id=dispdayc
        value="%OPRWEB03.03.030.023" >
 <input type=hidden name=daycmcnt id=daycmcnt
        value="%OPRWEB03.03.030.024">
 <input type=hidden name=currdate id=currdate
        value="%STANDARD.01.015">
     
 <table cellpadding=3 cellspacing=0 bgcolor=#CCCCCC border=0 width=100%>
  <tr><td><a href=javascript:InitTable(0)>
           <img src=../images/TableViewIcon.gif class=Icon 
                 alt="Default View" ></a>
              <a href=javascript:InitTable(1)>
            <img src=../images/TableViewIcon.gif class=Icon 
                 alt="Anaesthetic Details" ></a>
          <input type=button value="<<" class=SmallButton
                 onClick='location.href="%OPRWEB03.03.002"'>
          %OPRWEB03.03.007
          <input type=submit value="Go" class=SmallButton>
          <input type=button value=">>" class=SmallButton
                 onClick='location.href="%OPRWEB03.03.001"'>
          &nbsp;&nbsp;
          %STANDARD.01.017.YD
          <select class=PMenuSelectList name=surgtype onchange="frmSubmit();">
           <option value="ALL">All</option>
            %OPRWEB03.03.018.2
          </select>
          &nbsp;&nbsp;
     Theatre
     <select class=PMenuSelectList name=theacode onchange='frmSubmit()'>
     <option value=" ">All </option>
     %OPRWEB03.03.026
     </select>
     &nbsp;&nbsp;
     Surgeon
     <input type=text name=filtsurg id=filtsurg title="Surgeon"
      value="%OPRWEB03.03.024.003" size=6 maxlength=6
      onblur="UpCase(this);
      validateCode(31,SelectPeriod.filtsurg,SelectPeriod.d_filtsurg,frmSubmit)">
     <input type=text name=d_filtsurg id=d_filtsurg class=Readonly readonly
      value="%OPRWEB03.03.024.002" size=22 maxlength=30>
     <img src="../images/SearchIcon.gif" class=Icon
      onClick="DoctorSearchFrame(filtsurg,d_filtsurg,frmSubmit);">
     <img src="../images/erase.gif" class=Icon
      onClick="clrFields(filtsurg,d_filtsurg,frmSubmit);">
     &nbsp;&nbsp;
     Exclude Cancelled/Transferred Patients
     <input type="checkbox" name="exclcanc" id="exclcanc" value="1"
      onclick="frmSubmit();">
      </td>

  <!--T0846427-start-->
  <td align=left id="dispdcmmt" style="display:none"><b>Comments for today: </b>
   &nbsp;&nbsp;%OPRWEB03.03.030.022</td>
  <td align=left id="dispdcmbt" style="display:none"><b>Comments for today: </b>
      &nbsp;&nbsp;%OPRWEB03.03.030.022
      &nbsp;&nbsp;<input type=button name=daycmtbutton id=daycmtbutton
       class=button value="Day Comments"
       onClick="DayCommentsUpd(currdate);"></td>
  <!--T0846427-end-->

      <td align=right>
          <a href='javascript:SelectDateFrame();'>
             <img src="../images/DateLookup.gif" class=Icon
                  alt="Select Date"></a>
          <a href='javascript:SelectView("0");'>
             <img src=../images/DayIcon.gif class=Icon
                  alt="View Today"></a>
          <a href='javascript:SelectView("1");'>
             <img src=../images/WeekIcon.gif class=Icon
                  alt="View This Week"></a>
          <a href='javascript:SelectView("2");'>
             <img src=../images/MonthIcon.gif class=Icon
                  alt="View This Month"></a></td></tr>
 </table>
</form>
</div>

<div id=TableLocation></div>
<script type="text/javascript">
function AddTableRows() {
  %OPRWEB03.03.012.oprweb01.04.001
}
function ShowPage() { 
  InitTable(%OPRWEB03.03.027);
}
ExcludeCancelled="%OPRWEB03.03.025";
if(ExcludeCancelled=="1") {
  document.getElementById('exclcanc').checked=true;
}
</script>
