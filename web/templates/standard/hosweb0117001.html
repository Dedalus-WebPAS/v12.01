<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
//------------------------------------------------------------
// Function : Eclipse Participant Search Frame
//------------------------------------------------------------
function EclipseParticipantSearchFrame(ReturnCode,ReturnName)
{
  var PopUpFrameDoc = DFrameStart();
  window.ReturnCode=ReturnCode ;
  window.ReturnName=ReturnName ;
  window.ReturnFunction="" ;
  if (EclipseParticipantSearchFrame.arguments.length > 2)
  {
    window.ReturnFunction=EclipseParticipantSearchFrame.arguments[2]
  }
  PopUpFrameDoc.location.href = "../lookups/WebServicesParticipantSearchFrame.html";
  SearchFrameShow();
}
function subPartCode() {
  document.SelectPeriod.submit();
}
function displayProH(partcode,invno,claimid,repcount,templno) {
  DFrameStart()

  linkurl="../cgi-bin/hosweb01.pbl?reportno=17&template="+templno+
          "&ecprptcd="+partcode+
          "&ecprinvn="+invno+
          "&ecprclid="+claimid+
          "&ecprrept="+repcount+
          "&updttype=D";
  Left=(document.body.clientWidth-1000)/2
  DFrameLink(linkurl,100,Left,1000,450)
}
function displayProE(partcode,invno,claimid,repcount,templno) {
  DFrameStart()

  linkurl="../cgi-bin/hosweb01.pbl?reportno=17&template="+templno+
          "&ecprptcd="+partcode+
          "&ecprinvn="+invno+
          "&ecprclid="+claimid+
          "&ecprrept="+repcount;
  Left=(document.body.clientWidth-1000)/2
  DFrameLink(linkurl,100,Left,1000,450)
}
function validateExtractType() {
  partcodeDIV.style.display="none";
  document.getElementById('partcode').value="";
  document.getElementById('d_partcode').value="";

//  if (isWhitespace(document.getElementById('extrtype').value)) {
//    return;
//  }

  if (document.getElementById('extrtype').value=='2') {
    subPartCode();
    return;
  }
  partcodeDIV.style.display="";
  subPartCode();
}
function validateParticipant(ReturnCode) {
  var serverURL ="../cgi-bin/eclweb02.pbl?reportno=02&valdtype=1" +
                 "&valdcode=" + ReturnCode.value.replace(/ /g,"+");

  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
    document.SelectPeriod.d_partcode.value=ReturnValue;
  } else {
    document.SelectPeriod.partcode.value="";
    document.SelectPeriod.d_partcode.value="";
    ReturnCode.select();
    return false;
  }
  return true;
}
</script>
</head>
%START.OF.PAGE
<body onload=PageLoad(event);InitTable(0);>

<div id=HeadingSection>
<form name=SelectPeriod action=hosweb01.pbl method=get style="margin:0">
  <input type=hidden name=reportno value=17>
  <input type=hidden name=template value=1>
  <input type=hidden name=updttype value=" ">
  <input type=hidden name=nextpage value="6">
<table cellpading=0 cellspacing=0 bgcolor=#CCCCCC border=0 width=100%>
  <tr><td align=right width=50%>
     IMCW Extract Type
     <select name="extrtype" id="extrtype" title="IMCW Extract Type"
          onchange="validateExtractType();">
           <option></option>
           <option  value="1">Health Fund & Medicare</option>
           <option  value="2">Medicare Only</option>
         </select></td>
     <td align=left><div id=partcodeDIV style="display:none;">
     &nbsp;Organisation&nbsp;
    <input type=text name=partcode id="partcode" size=5 maxlength=3 
     onchange="validateParticipant(this);subPartCode();"
     value="%HOSWEB01.17.001.0">
    <input type=text size=25 maxlength=30 name=d_partcode id=d_partcode 
     class=Readonly
     readonly notab value="%HOSWEB01.17.001.1"> 
     <img src=../images/SearchIcon.gif class=Icon
 onclick="EclipseParticipantSearchFrame(partcode,d_partcode,subPartCode);">
    <img src="../images/erase.gif" class=Icon
         onclick="clrFields(partcode,d_partcode,subPartCode);">
  </div></td></tr>
</table>
</form>
</div>

<div id=TableLocation></div>

<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//---------------------------------------------------------------------------
function InitTable(TableView) {
 document.title="WebServices IMCW Assessment Reports";
 t = new Table(1,0,1,"100%","center",55,45);
 t.addColumn("Account Reference ID","String",0,0,"left","","")
 t.addColumn("Claim ID","String",1,1,"left","","")
 t.addColumn("Report Number","String",2,2,"left","","",50)
// t.addColumn("Claim&nbsp;Fund<br>Assessment","String",3,3,"left","","",70)
 t.addColumn("Process Status<br>Code Description","String",14,14,"left","","",175)
 t.addColumn("Current Patient<br>First Name","String",4,4,"left","","")
 t.addColumn("Current Patient<br>Medicare Number","String",5,5,"left","","")
 t.addColumn("Current Patient<br>Reference Number","String",6,6,"left","","")
 t.addColumn("Fund Status<br>Code","String",7,7,"left","","")
// t.addColumn("Medicare Card<br>Flag Desc.","String",8,8,"left","","",100)
 t.addColumn("Medicare Status<br>Code","String",9,9,"left","","")
 t.addColumn("Family<br>Name","String",10,10,"left","","")
 t.addColumn("First<br>Name","String",11,11,"left","","")
 t.addColumn("Medicare Card<br>Number","String",12,12,"left","","")
 t.addColumn("Reference<br>Number","String",13,13,"left","","")
 t.addColumn("Claim Tran ID","String",15,15,"left","","",200)
 t.addColumn("Medicare Lodgement Date","String",16,16,"left","","")
 t.addColumn("Medicare Details","String",17,17,"center","","")
 t.addColumn("Health Fund Details","String",18,18,"center","","")
 AddTableRows()
 TableOutput(0,1);    // Order Column,Asc Dsc
}
function AddTableRows() {
%HOSWEB01.17.002
}

  IMCExtractType="%HOSWEB01.17.023";

  for(var i=0; i<document.getElementById('extrtype').length; i++){
      if(document.getElementById('extrtype').options[i].value==IMCExtractType){
         document.getElementById('extrtype').selectedIndex=i;
      }
  }

  if (!isWhitespace(document.getElementById('extrtype').value) &&
      document.getElementById('extrtype').value!='2') {
    partcodeDIV.style.display="";   
  }  

</script>

