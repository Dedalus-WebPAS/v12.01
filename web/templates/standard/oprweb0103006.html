<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
%START.OF.PAGE
<script type="text/javascript">
function SummaryPage() {
  GoCookiePath("ReturnPath");
}
function fnPatientSearch() {
if("%OPRWEB01.03.176.2"!="        "){
   alert("ERROR - Session is finalized - No new bookings can be made.\n" +
         "Please reset to Provisional to make changes to this session.");
   return false;
}
if (ChkLock(0)) {
   if(LinkForm.cancsess.value==0) {
     alert("Cannot book Theatre, Session is Cancelled");
   }
   else {
   linkUrl="patweb90.pbl?reportno=1&template=201"
   DFrameLink(linkUrl,0,50,1100,450)
   }
 }
}
function ChkLock(flag) {
  numlock=parseInt(LinkForm.sesslock.value)
  daylock=parseInt(LinkForm.noofdays.value)
  if(numlock>daylock) {
    if (flag==0) alert("Session is locked. Cannot Book patients");
    else alert("Session is locked. Cannot Cancel Session");
    return false;
 }
  else return true;
}
function InputActuals(SessionKey) {
  if(LinkForm.cancsess.value==0) {
      alert("Cannot Perform Input Actuals. Session is Cancelled");
      return;
  }
  opses074=SessionKey.substr(0,3).replace(/ /g,"+");
  opses001=SessionKey.substr(3,8).replace(/ /g,"+");
  opses002=SessionKey.substr(11,5).replace(/ /g,"+");
  opses003=SessionKey.substr(16,6).replace(/ /g,"+");
// this link needs to be changed when the rest of opr is done
  LinkUrl="oprweb05.pbl?reportno=2&template=6&opses074="+opses074+
                                            "&opses001="+opses001+
                                            "&opses002="+opses002+
                                            "&opses003="+opses003
  Left=(document.body.clientWidth-425)/2
  DFrameLink(LinkUrl,0,Left,425,300)
}
function DefaultTeam(SessionKey) {
  if (document.LinkForm.cancsess.value==0) {
    alert('Cannot Perform Default Team. Session is Cancelled.');
    return;
  }
  opses074=SessionKey.substr(0,3).replace(/ /g,"+");
  opses001=SessionKey.substr(3,8).replace(/ /g,"+");
  opses002=SessionKey.substr(11,5).replace(/ /g,"+");
  opses003=SessionKey.substr(16,6).replace(/ /g,"+");
// this link needs to be changed when the rest of opr is done
  LinkUrl="oprweb05.pbl?reportno=2&template=7&opses074="+opses074+
                                            "&opses001="+opses001+
                                            "&opses002="+opses002+
                                            "&opses003="+opses003
  Left=(document.body.clientWidth-700)/2
  DFrameLink(LinkUrl,0,Left,800,525)
}
function EditStartTime(CaseKey) {
  if(LinkForm.cancsess.value==0) {
      alert("Cannot Edit Time, Session is Cancelled");
      return;
  }
  LinkUrl="oprweb01.pbl?reportno=4&template=19&casekeys="
                        + CaseKey.replace(/ /g,"+");
  Left=(document.body.clientWidth-410)/2
  DFrameLink(LinkUrl,100,Left,410,300)
}
function AdjustStartTime(SessionKey) {
  if(LinkForm.cancsess.value==0) {
      alert("Cannot Adjust Time, Session is Cancelled");
      return;
  }
  LinkUrl="oprweb01.pbl?reportno=19&template=1&sesskeys="
                       + SessionKey.replace(/ /g,"+");
  Left=(document.body.clientWidth-410)/2
  DFrameLink(LinkUrl,100,Left,410,300)
}
function Finalisation(SessionKey) {
  opses074=SessionKey.substr(0,3).replace(/ /g,"+");
  opses001=SessionKey.substr(3,8).replace(/ /g,"+");
  opses002=SessionKey.substr(11,5).replace(/ /g,"+");
  opses003=SessionKey.substr(16,6).replace(/ /g,"+");
// this link needs to be changed when the rest of opr is done
  LinkUrl="oprweb05.pbl?reportno=2&template=9&opses074="+opses074+
                                            "&opses001="+opses001+
                                            "&opses002="+opses002+
                                            "&opses003="+opses003;
  Left=(document.body.clientWidth-390)/2
  DFrameLink(LinkUrl,100,Left,390,320)
}
function ChangeTheatre(SessionKey) {
  if(LinkForm.cancsess.value==0) {
     alert("Cannot Change Theater, Session is Cancelled");
     return;
  }
  opses074=SessionKey.substr(0,3).replace(/ /g,"+");
  opses001=SessionKey.substr(3,8).replace(/ /g,"+");
  opses002=SessionKey.substr(11,5).replace(/ /g,"+");
  opses003=SessionKey.substr(16,6).replace(/ /g,"+");
  LinkUrl="oprweb05.pbl?reportno=2&template=4&opses074="+opses074+
                                            "&opses001="+opses001+
                                            "&opses002="+opses002+
                                            "&opses003="+opses003
  Left=(document.body.clientWidth-480)/2;
  DFrameLink(LinkUrl,0,Left,480,380);
}
function CancelSession(SessionKey) {
   if (ChkLock(1)) {
  opses074=SessionKey.substr(0,3).replace(/ /g,"+");
  opses001=SessionKey.substr(3,8).replace(/ /g,"+");
  opses002=SessionKey.substr(11,5).replace(/ /g,"+");
  opses003=SessionKey.substr(16,6).replace(/ /g,"+");
  LinkUrl="oprweb05.pbl?reportno=2&template=5&opses074="+opses074+
                                            "&opses001="+opses001+
                                            "&opses002="+opses002+
                                            "&opses003="+opses003
  Left=(document.body.clientWidth-410)/2
  DFrameLink(LinkUrl,0,Left,410,320)
  }
}
function DisplayCommentsButton() {
  if(document.theatreForm.opcnscom.value==1) {
    if(document.theatreForm.comindic.value==1) {
      CommentsDiv.innerHTML=redcommentsdiv.innerHTML;
    } else {
      CommentsDiv.innerHTML=commentsdiv.innerHTML;
    }
    if(document.theatreForm.commtday.value==1) {
      CommentsDay.innerHTML=redcommentsday.innerHTML;
    } else {
      CommentsDay.innerHTML=commentsday.innerHTML;
    }
  } else {
    CommentsDiv.innerHTML=blanklabel.innerHTML;
    CommentsDay.innerHTML=blanklabel.innerHTML;
  }
}
function disComments() {
  Left=(document.body.clientWidth-510)/2
  DFrameSubmit(SelectCode,0,Left,630,500)
}
function dayComments() {
  Left=(document.body.clientWidth-510)/2
  DFrameSubmit(DayComm,0,Left,630,500)
}
function PatientAlerts(urnumber,admissno) {
  linkurl="patweb98.pbl?reportno=1&template=003" +
          "&urnumber=" + urnumber + "&admissno=" + admissno
  location.href=linkurl
}
function CheckFin(form){
  if("%OPRWEB01.03.176.2"!="        "){
     alert("ERROR - Session is Finalized - No changes can be made.\n"+
           "Please reset to Provisional to make changes to this session.");
     return false;
  }
  form.submit();
}
function UpdateCaseNo(updateCaseNoForm){
  if("%OPRWEB01.03.176.2"!="        "){
     alert("ERROR - Session is Finalized - No changes can be made.\n"+
           "Please reset to Provisional to make changes to this session.");
     return false;
  }
  updateCaseNoForm.submit();
}
</script>
</head>
<body onload="PageLoad(event);DisplayCommentsButton();SetCookiePath('CasePath');">
<form name=theatreForm method=get style="margin:0">
<input type=hidden name=opcnscom value="%OPRWEB01.03.006">
<input type=hidden name=comindic value="%OPRWEB01.03.007">
<input type=hidden name=commtday value="%OPRWEB01.03.009">
<input type=hidden name=sesskeys value="%OPRWEB01.03.101">
</form>

<table width=100% cellspacing=0 border=0 bgcolor=#CCCCCC>
<tr><td class=HeadingCell align=left>
    <img src=../images/ListIcon.gif class=Icon onclick='SummaryPage();'></td>
    <td class=HeadingCell width=100% align=center>
    Day Session Case List %OPRWEB01.03.174 - %OPRWEB01.03.117.0</td>
    <td class=HeadingCell align=right>%OPRWEB01.03.176.1</td></tr>
</table>

<table width=100% cellspacing=0 border=0 bgcolor=#CCCCCC>
<tr><td width=15% class=DataLabel>Surgeon   </td>  
    <td ><a href='javascript:DoctorViewFrame("%OPRWEB01.03.104.003")'>
         <b>%OPRWEB01.03.104.002 &nbsp; </a></td>
    <td width=15%>Anaesthetist   </td>
    <td ><a href='javascript:DoctorViewFrame("%OPRWEB01.03.116.003")'>
         %OPRWEB01.03.116.002</a></td></tr>

<tr><td width=15% class=DataLabel>Theatre  </td>
    <td class=DataField>%OPRWEB01.03.114.0 </td>
    <td class=DataLabel>Session Type</td>
    <td class=DataField>%OPRWEB01.03.169.0  </td>
    <td><div id=CommentsDiv></div></td></tr>

<tr><td class=DataLabel>Date  </td>
    <td class=DataField>%OPRWEB01.03.106 %OPRWEB01.03.102</td>
    <td class=DataLabel>Time  </td>
    <td class=DataField> %OPRWEB01.03.103 to %OPRWEB01.03.108</td>
    <td><div id=CommentsDay></div></td></tr>

<tr><td class=DataLabel>Special Instructions</td>
    <td class=DataField>%OPRWEB01.03.166</td>
    <td class=DataLabel>Unit</td>   
    <td class=DataField>%OPRWEB01.03.113.0  </td></tr>
    <td></td><td class=DataField>%OPRWEB01.03.167</td></tr>
</table>

<table width=100% border=1 cellspacing=0 >
<tr><td class=HeadingCell align=center>Time</td>
    <td class=HeadingCell align=center>Duration</td>
    <td class=HeadingCell>Name</td>
    <td class=HeadingCell>Alerts</td>
    <td class=HeadingCell>Adm No</td>
    <td class=HeadingCell>Operation</td>
    <td class=HeadingCell>Anaesthetic Type</td>
    <td class=HeadingCell>Usage</td>
    <td class=HeadingCell>Theatre</td>
    <td class=HeadingCell>Case No</td>
    <td class=HeadingCell>Status</td></tr>
%OPRWEB01.03.001.oprweb06.12.001
</table>

<table width=100% cellspacing=0 border=0 bgcolor=#CCCCCC>
<tr><td align=center>
    <input type=button class="button" value="New"
     onclick=fnPatientSearch();>
    <input type=button class="button" value="Change Theatre"
     onclick='ChangeTheatre("%OPRWEB01.03.101");'>
    <input type=button class="button" value="Cancel Session"
     onclick='CancelSession("%OPRWEB01.03.101");'>
    <input type=button class="button" value="Input Actuals"
     onclick='InputActuals("%OPRWEB01.03.101");'>
    <input type=button class="button" value="Default Team"
     onclick='DefaultTeam("%OPRWEB01.03.101");'>
    <input type=button class="button" value="Adjust Times"
     onclick='AdjustStartTime("%OPRWEB01.03.101");'>
    <input type=button class="button" value="Finalisation"
     onclick='Finalisation("%OPRWEB01.03.101");' id="FinBut">
    <input type=button class="button" value="Exit" onclick="fnReturnPath();">
</td></tr>
</table>
<form name=LinkForm method=post action=oprweb01.pbl>
<input type=hidden name=reportno value=9>
<input type=hidden name=template value=2>
<input type=hidden name=urnumber value="">
<input type=hidden name=sesskeys value="%OPRWEB01.03.101">
<input type=hidden name=cancsess value="%OPRWEB01.03.117.1">
<input type=hidden name=sesslock value="%OPRWEB01.03.168">
<input type=hidden name=noofdays value="%OPRWEB01.03.005">
</form>
<form name=Registration method=get action="patweb89.pbl">
<input type=hidden name=reportno value=05>
<input type=hidden name=template value=001>
<input type=hidden name=srchsnam value="">
<input type=hidden name=srchgnam value="">
<input type=hidden name=srchpdob value="">
<input type=hidden name=srchpage value="">
<input type=hidden name=srchpsex value="">
<input type=hidden name=temporar value="0">
<input type=hidden name=sesskeys value="%OPRWEB01.03.101">
<input type=hidden name=cancsess value="%OPRWEB01.03.117.1">
<input type=hidden name=sesslock value="%OPRWEB01.03.168">
<input type=hidden name=noofdays value="%OPRWEB01.03.005">
<input type=hidden name=theaflag value="1">
</form>
<form name=NewRegistration method=get action=patweb89.pbl>
<input type=hidden name=reportno value=05>
<input type=hidden name=template value=004>
<input type=hidden name=srchsnam value="">
<input type=hidden name=srchgnam value="">
<input type=hidden name=srchpdob value="">
<input type=hidden name=srchpage value="">
<input type=hidden name=srchpsex value="">
<input type=hidden name=temporar value="1">
<input type=hidden name=sesskeys value="%OPRWEB01.03.101">
<input type=hidden name=cancsess value="%OPRWEB01.03.117.1">
<input type=hidden name=sesslock value="%OPRWEB01.03.168">
<input type=hidden name=noofdays value="%OPRWEB01.03.005">
<input type=hidden name=theaflag value="1">
</form>
<span id=commentsdiv style="display:none">
   <input type=button value="Session Comments"
    class="Largebutton" onclick="disComments();">
</span>

<span id=redcommentsdiv style="display:none">
   <input type=button value="Session Comments"
    class="Red Largebutton" onclick="disComments();">
</span>

<span id=commentsday style="display:none">
   <input type=button value="Day Comments"
    class="Largebutton" onclick="dayComments();">
</span>

<span id=redcommentsday style="display:none">
   <input type=button value="Day Comments"
    class="Red Largebutton" onclick="dayComments();">
</span>


<span id=blanklabel style="display:none">&nbsp;</span>

<form name=SelectCode method=get action=oprweb05.pbl>
<input type=hidden name=reportno value="2">
<input type=hidden name=template value="008">
<input type=hidden name=opses001 value="%OPRWEB01.03.102">
<input type=hidden name=opses002 value="%OPRWEB01.03.103">
<input type=hidden name=opses003 value="%OPRWEB01.03.104.003">
<input type=hidden name=opses074 value="%OPRWEB01.03.179.1">
</form>

<form name=DayComm method=get action=oprweb05.pbl>
<input type=hidden name=reportno value="2">
<input type=hidden name=template value="010">
<input type=hidden name=opses001 value="%OPRWEB01.03.102">
<input type=hidden name=opses002 value="">
<input type=hidden name=opses003 value="">
<input type=hidden name=opses074 value="%OPRWEB01.03.179.1">
</form>

<script type="text/javascript">
if("%OPRWEB01.03.176.2"!="        "){
   document.getElementById("FinBut").className = "RedButton";
}
</script>
