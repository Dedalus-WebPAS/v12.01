<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<script type="text/javascript">
function SelectDateFramePreCheck() {
  if(!EditSearchRules()) {
    return false;
  } else {
    return true;
  }
}
function EditSearchRules() {
  if(isWhitespace(SelectPeriod.srchclty.value) &&
     isWhitespace(SelectPeriod.srchclid.value)) {
     alert("Clinic Type or Clinic ID are mandatory for search.");
     return false;
  }
//
  if(SelectPeriod.deftovrd.value=="1") { // Don't Allow override of ref default
    if(!isWhitespace(SelectPeriod.defctype.value)) {
      if(SelectPeriod.defctype.value == SelectPeriod.srchclty.value) {
         return true;
      }
    }
    if(!isWhitespace(SelectPeriod.deftclid.value)) {
      if(SelectPeriod.deftclid.value == SelectPeriod.srchclid.value) {
         return true;
      }
    }
    if(!isWhitespace(SelectPeriod.defctype.value) ||
       !isWhitespace(SelectPeriod.deftclid.value)) {
       alert("Invalid referral clinic type & clinic for search .");
       return false;
    }
  }
  return true;
}
function SubmitSearch() {
  if(!EditSearchRules()) {
    return;
  }
  SelectPeriod.submit();
}
function SetLists() {
 SetClinicType(SelectPeriod.srchclty,
               SelectPeriod.defctype.value,
               SelectPeriod.usersite.value);
 SetLists2();
}
function SetLists2() {
 p=SelectPeriod
 p.srchclid.options.length=1;
 SetTypeClinic(p.srchclid,p.deftclid.value,p.usersite.value,p.srchclty.value);
 setVisitTypeList(p.usersite,p.srchclty,p.srchvtyp,p.deftvtyp);
}
function ShowSession(linkurl) {
  var clindate = linkurl.substr(59,8);
  if(!CheckReferralDate(SelectPeriod.srchrefd.value,clindate)) {
    return;
  }
  var FollowEdit=document.getElementById("otcnfoll").value;
  if(parent.document.getElementById("d_followdt") && FollowEdit !=0) {
    var bookin_date=parent.document.getElementById("d_followdt").value;
    if(SetDateYYYYMMDD(bookin_date) > clindate) {
      if(FollowEdit==1) {
        if(!confirm("Warning: Follow up date selected is prior to the " +
              "date of the original booking. \nPress CANCEL to " +
              "select another date.")) {
          return;
        }
      }
      if(FollowEdit==2) {
        alert("Error Message: Follow up date selected is prior to the " +
              "date of the original booking. \nPlease select another " +
              "date.");
        return;
      }
    }
  }
  SetCookie("ClinicListCookie",location.href);
  location.href=linkurl
}
function CheckReferralDate(ref,clin)
{
  if (isWhitespace(ref) || isWhitespace(clin)) {
    return true;
  }
  if (ref > clin)
  {
    alert("Clinic Date must not be before Referral Date (" + SetDateDDMMMYYYY(ref) + ")");
    return false;
  }

  return true;
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);setTimeout('SetLists()',100);">
<div id=HeadingSection >
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Clinic Search
</span>
</div>
<div id=PageBodySection style="overflow: auto;">
<form name=SelectPeriod action=outweb02.pbl method=get style="margin:0">
<input type=hidden name=reportno value=01>
<input type=hidden name=template value=002>
<input type=hidden name=viewtype value="%OUTWEB02.01.011">
<input type=hidden name=usersite value="%STANDARD.01.023">
<input type=hidden name=defctype value="%OUTWEB02.01.025">
<input type=hidden name=deftclid value="%OUTWEB02.01.022.1">
<input type=hidden name=deftovrd value="%OUTWEB02.01.045">
<input type=hidden name=deftvtyp value="%OUTWEB02.01.060">
<input type=hidden name=wbseclid value="%STANDARD.01.026">
<input type=hidden name=norecord value="10">
<input type=hidden name=srchrefn value="%OUTWEB02.01.053">
<input type=hidden name=srchrefd value="%OUTWEB02.01.059">
<input type=hidden name=otcnfoll id=otcnfoll
 value="%STANDARD.01.025.032.147.0.1">
<input type=hidden name=mosaiqrs value="%OUTWEB02.01.067">

<table width="100%" bgcolor=#cccccc align=center cellpadding=0 
 cellspacing=0 border=0>
<tr><td class=DataLabel>Clinic Type</td>
    <td class=DataItem>
    <select name=srchclty onchange="SetLists2();"> <option value=""></option>
    </select> </td> <td class=DataItem> <input type=button value="<<" class=SmallButton
    onClick='location.href="%OUTWEB02.01.002"'>
    %OUTWEB02.01.007
    <input type=button value=">>" class=SmallButton
     onClick='location.href="%OUTWEB02.01.001"'>
       <a href='javascript:SelectDateFrame();'>
       <img src="../images/DateLookup.gif" class="Icon"></a>
  </td>
  </tr>

<tr><td class=DataLabel>Clinic ID</td>
    <td class=DataItem>
    <select name=srchclid>
    <option value=""></option>
    </select>
    </td>
    <td>Clinic
    <input type=radio name=srchempt title="Clinic" checked value=0>
     &nbsp;Next Available&nbsp;<input type=radio name=srchempt 
          title="Next Available" value=1></td>
    </tr>

<tr><td class=DataLabel>Visit Type</td>
    <td class=DataItem>
    <select name=srchvtyp>
    <option value=""></option>
    %OUTWEB02.01.34
    </select>
    </td>
    <td>
    <script type="text/javascript">
      if(%STANDARD.01.044.032.144.001){
         document.write("&nbsp;");
      }
      else{
         document.write("<input type=button class='button' value='Search' onclick='SubmitSearch();'>");
      }
    </script>
    </td>
    </tr>
    <script type="text/javascript">
      if(%STANDARD.01.044.032.144.001){
         document.write("<tr style='visiiblity:visible'>");
      }
      else{
         document.write("<tr style='visibility:hidden'>");
      }
    </script>
    <td class=DataLabel>Location</td>
    <td class=DataItem>
    <select name=srchltyp onchange="SubmitSearch();">
    <option value=""></option>
    %STANDARD.01.007.CT
    </select>
    </td>
    <td>
      <input type=button class="button" value="Search" id="out02s"
       onclick="tempDisable(this);SubmitSearch();">
    </td>
    <td>&nbsp;</td>
</tr>
</table>
</form>

<table cellspacing=0 border=1 width=100%>
<tr><td class=HeadingCell>Start</td>
    <td class=HeadingCell>Clinic Type</td>
    <td class=HeadingCell>Clinic</td>
    <td class=HeadingCell>Location</td>
    <td class=HeadingCell width=5%>Empty</td>
    <td class=HeadingCell width=5%>New</td>
    <td class=HeadingCell width=5%>Review</td>
    <td class=HeadingCell width=5%>Special</td></tr>
%OUTWEB02.01.041.outweb02.02.003
</table>

<table width=100% bgcolor=#CCCCCC><tr>
  <td align=center>
  <input type=button value="<< Previous" class="button"
   onClick='location.href="%OUTWEB02.01.043.002"'>
  <input type=button value="Next >>" class="button"
   onclick='location.href="%OUTWEB02.01.042.002"'>
</td></tr>
</table>

<script type="text/javascript">
var RadioIndex="%OUTWEB02.01.035"
if(RadioIndex==1) {
 document.SelectPeriod.srchempt[RadioIndex].checked=1
}
  if(%STANDARD.01.044.032.144.001){
     locationCode = "%OUTWEB02.01.026";
     ds = document.SelectPeriod;

     for(i=0; i<ds.srchltyp.length; i++) {
         if(ds.srchltyp.options[i].value.substr(0,3)==locationCode){
            ds.srchltyp.selectedIndex = i;
         }
     }
  }
  if(document.getElementById("lastdate")) {
     document.getElementById("lastdate").onchange=SubmitSearch;
  }
</script>

