<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/patweb8508.js"></script>
<script type="text/javascript" src="../js/MrtLocations.js"></script>
<script type="text/javascript" src="../js/MrtMultiLocations.js"></script>
<script type="text/javascript" src="../js/MrtHomeLocns.js"></script>
<script type="text/javascript" src="../js/MrtMultiHomeLocns.js"></script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);SetHospitals(1);ModifyLists();
              SetRecord();">
<div id=HeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB85.08.103";
PatientVIS="%PATWEB85.08.181";
PatientNAM="%PATWEB85.08.102";
PatientSTA="%PATWEB85.08.186.078";
PatientALT="%PATWEB85.08.184";
PatientSEX="%PATWEB85.08.119";
PatientDOB="%PATWEB85.08.120";
PatientAGE="%PATWEB85.08.121";
PatientLOC="%PATWEB85.08.183";
PatientPRI="%PATWEB85.08.186.066.1";
PatientUNT="%PATWEB85.08.166.0";
DoctorCOD="%PATWEB85.08.182.003";
DoctorNAM="%PATWEB85.08.182.002";
PatientAID="%PATWEB85.08.186.090";
PatientIND="%PATWEB85.08.186.091";
PatientCUR="%PATWEB85.08.186.092";
PatientCLC="%PATWEB85.08.186.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB85.08.186.094";
PatientCDM="%PATWEB85.08.186.095";
PatientVDH="%PATWEB85.08.186.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
</div>
<form name=AddForm method=post action=patweb85.pbl style="margin:0">
<input type=hidden name=reportno value="8">
<input type=hidden name=template value="002">
<input type=hidden name=urnumber value="%PATWEB85.08.103">
<input type=hidden name=admissno value="%PATWEB85.08.181">
<input type=hidden name=updatety value="A">
<input type=hidden name=redirect value="%PATWEB85.08.101.patweb85.08.002">
<input type=hidden name=nextpage value="6">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=ibcnccmr value="%STANDARD.01.025.097.167.1.1">
<input type=hidden name=d_recvlocn value="%PATWEB85.08.003">
<input type=hidden name=d_homelocn value="%PATWEB85.08.004.1">
<input type=hidden name=d_doctype value=" ">
<input type=hidden name=mrcnlzer value="%STANDARD.01.025.097.168.0.1">
<input type=hidden name=mrcnibap value="%STANDARD.01.025.097.165.0.1">
<input type=hidden name=recvdate value="%STANDARD.01.015">
<input type=hidden name=recvtime value="%STANDARD.01.016">
<input type=hidden name=superlev value="%PATWEB85.08.001">
<input type=hidden name=recdirec value="0">
<input type=hidden name=cat_TY value="TY">

<table border=0 align=center width=100% cellpadding=0 cellspacing=0> 
<tr><td class=HeadingCell align=center>
Medical Records Received
</td>
<td class=HeadingCell align=right>
 <input type=button value="Chg Dflt Rec loc" name=ReqButton id=ReqButton
  class="button" style="display:none;" onclick="ChangeReceive();">
</td>
</tr>
</table>

<table border=0 align=center width=90% cellpadding=1> 
<tr><td class=DataLabel>Received Date</td>
    <td class=DataField>%STANDARD.01.015 at Time %STANDARD.01.016
    </td>                                                  
    <td class=DataLabel>Received By</td>
    <td class=DataField>%STANDARD.01.009</td>
    </tr>

<tr><td class=DataLabel><div id=RecvHospitalTitle></div></td>
    <td><div id=RecvHospital></div></td>
    <td class=DataLabel><div id=HomeHospTitle></div></td>
    <td><div id=HomeHosp></div></td>
    </tr>

<tr><td class=DataLabel>Receiving Location</td>
    <td><select name=recvlocn id=recvlocn class="Mandatory"
         title="Location Required">  
        <option></option>
        </select></td> 
    <td class=DataLabel><div id=HomeLocTitle></div></td>
    <td><div id=HomeLoc></div></td>
    </tr>

<tr><td class=DataLabel>Receive Direct Reason</td>
    <td><select name=recvreas id=recvreas title="Receive Direct Reason">
        <option></option>
        %PATWEB85.08.006.0
        </select></td>
    <td class=DataLabel>Document Type</td>
    <td><select name=docmtype id=docmtype class=Mandatory title="Document Type"
         onchange="filterMRTable();">
        <option></option>
        %PATWEB85.08.005.2
        </select></td>
    </tr>

<tr><td class=DataLabel>Movement Comments</td>
    <td><input type=text size=60 maxlength=50 name=mvmtcomm id=mvmtcomm
      title="Movement Comments"></td>
</tr>

<tr><td colspan="4" align="center"><hr></td></tr>
</table>

<table width=90% align=center cellspacing=0 border=0 id=mrrectbl>
  <tr>
    <td class=HeadingCell id=orighosp 
        style="display: none">Originating Hospital</td>
    <td class=HeadingCell>Document Type
    <td class=HeadingCell align=center>Volume</td>
    <td class=HeadingCell>Comments</td>
    <td class=HeadingCell>Current Location</td>
    <td class=HeadingCell>Status</td>
    <td class=HeadingCell>Required</td>
  </tr>
  <tbody>
  %PATWEB85.08.007
  </tbody>
<table>

<table border=0 align=center width=100% cellspacing=1>
<tr><td colspan=2 align=center><br>
    <input type=button value="Accept" name=ReqButton id=ReqButton
     class="button" onclick="PostReceiveRecords();">
    <input type=button value="Clear All" class="button" 
     onclick="location.reload()">
</td></tr>
</table>
</form>

<span id=ShowHomeHospTitle style="display:none">
  Home Hospital
</span>
    
<span id=ShowHomeHosp style="display:none">
  <select name=homehosp id=homehosp title="Home Hospital" class="Mandatory"
   onchange="SetHomeLocn(AddForm);">
   %PATWEB85.08.004.0
  </select>
</span>

<span id=ShowNoHospital style="display:none">
  <input type=hidden name=homehosp id=homehosp value="    ">
</span>

<span id=ShowReceiveHospTitle style="display:none">
  Receiving Hospital
</span>

<span id=ShowReceiveHosp style="display:none">
  <select name=recvhosp id=recvhosp title="Receive Hospital" class="Mandatory"
   onchange="SetReceiveLoc(AddForm);">
   %PATWEB85.08.002
  </select>
</span>

<span id=ShowNoReceiveHospital style="display:none">
  <input type=hidden name=recvhosp id=recvhosp value="    ">
</span>

<span id=ShowHomeLocTitle style="display:none">
  Home Location
</span>

<span id=ShowHomeLoc style="display:none">
  <select name=homelocn id=homelocn class=Mandatory title="Home Location"
    onchange="filterMRTable();">
    <option></option>
  </select>
<script>


if (document.AddForm.ibcnmhos.value == "1" && 
    document.AddForm.ibcnccmr.value == "1") {
  document.getElementById("ReqButton").style.display = ""; 
}
function SetRecord() {
  for (var i=0; i < document.AddForm.length; i++) {
    if (document.AddForm.elements[i].name.match(/mrkeyarr/)) {
      document.AddForm.elements[i].checked=true;
      break;         // Only set the first one found which is latest volume!
    }
  }
}
function ModifyLists() {
  p=document.AddForm
  var serverURL = 'patweb85.pbl?reportno=9&updatety=L';
  var returnValue = RSExecute(serverURL);
  ReturnValue=returnValue.return_value.split("|");
  for (var i=0; i < p.recvlocn.options.length; i++) {
    for (var j=0; j < ReturnValue.length; j++) {
      var f = ReturnValue[j].split(",");
      if (p.recvlocn.options[i].value == f[0]) {
        if (isWhitespace(f[1])) {
          p.recvlocn.options[i].remove(i)
          i--;
        }
      }
    }  
  }
}

function filterMRTable() {
  var homeLocation = document.AddForm.homelocn.value;
  var documentType = document.AddForm.docmtype.value.substr(0, 4);
  var urNo = document.AddForm.urnumber.value.replace(/ /g,"+");
  var admNo = document.AddForm.admissno.value.replace(/ /g,"+");
  var tableEl = document.getElementById('mrrectbl');
  tableEl.getElementsByTagName('tbody')[1].innerHTML = '';
  var serverURL = 'patweb85.pbl?reportno=9&updatety=M&homlocrm=' +
                   homeLocation + '&doctyprm=' + documentType +
                  '&urnumber=' + urNo + '&admissno=' + admNo
  var returnValue=RSExecute(serverURL);
  ReturnValue=returnValue.return_value.split("|");
  if (returnValue.status == 0) {
    tableEl.getElementsByTagName('tbody')[1].innerHTML =
    ReturnValue[0];
  }
}

if (document.AddForm.ibcnmhos.value == "1") {
  document.getElementById("orighosp").style.display = ""; 
}
</script>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=002>
<input type=hidden name=urnumber value="%PATWEB85.08.103">
<input type=hidden name=admissno value="%PATWEB85.08.181">
<input type=hidden name=MenuType value="%PATWEB85.08.188">
</form>

