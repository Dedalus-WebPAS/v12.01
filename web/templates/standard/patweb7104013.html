<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript">
//---------------------------------------------------------------------
// This function validate and do the subtraction (fee1-fee2=total)
//---------------------------------------------------------------------

function GenBFee() {
  if (UpdateForm.casmxflg.value!="1") {
    if (validateBedFee(UpdateForm.claimcod,UpdateForm.fundcode,
                       UpdateForm.tabcode,UpdateForm.admsstyp,
                       UpdateForm.newbtype)) {
      UpdateForm.submit();
    }
    else {
      for (i=0; i<UpdateForm.newbtype.length; i++) {
        if (UpdateForm.newbtype.options[i].value.substr(0,3)==
            UpdateForm.bedtype.value.substr(0,3)) {
          UpdateForm.newbtype.selectedIndex=i;
        }
      }
    }
  }
  else {
    UpdateForm.submit();
  }
}

function validateBedFee(clmtyp,hfund,hftabl,admtyp,bedtyp) {
  if (isWhitespace(clmtyp.value) &&
      isWhitespace(hfund.value) &&
      isWhitespace(hftabl.value) &&
      isWhitespace(admtyp.value) &&
      isWhitespace(bedtyp.value)) {
    return;;
  }
  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=64" +
                 "&valdceff=" + UpdateForm.ceffdate.value.replace(/ /g,"+") +
                 "&valdclmt=" + clmtyp.value.substr(0,3).replace(/ /g,"+") +
                 "&valdfund=" + hfund.value.substr(0,6).replace(/ /g,"+") +
                 "&valdtabl=" + hftabl.value.substr(0,8).replace(/ /g,"+") +
                 "&valdadmt=" + admtyp.value.substr(0,3).replace(/ /g,"+") +
                 "&valdbedt=" + bedtyp.value.substr(0,3).replace(/ /g,"+") +
                 "&multhosp=" + UpdateForm.multhosp.value.replace(/ /g,"+");
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    return true;
  }
  else {
    bedtyp.focus();
    return false;
  }
}

function SetupFee(sbfeekey,bfecolno,totfee,pporamnt,rporamnt,totalfee,discamnt,edayrang,pdiemkey) {

  var serverURL = "../cgi-bin/patweb71.pbl?reportno=5" +
                  "&sbfeekey=" + sbfeekey.value.replace(/ /g,"+") +
                  "&bfecolno=" + bfecolno.value.replace(/ /g,"+") +
                  "&multhosp=" + UpdateForm.multhosp.value.replace(/ /g,"+") +
                  "&pdiemkey=" + pdiemkey.value.replace(/ /g,"+");

  var returnValue = RSExecute(serverURL);    //Remote Script To get bed fees

  if (returnValue.status==0) {
   ReturnValue=returnValue.return_value.split("|")
   pporamnt.value=ReturnValue[0];
   rporamnt.value=ReturnValue[1];
   edayrang.value=ReturnValue[2];

   AddTotal(totfee,pporamnt,rporamnt);

   DailyTot(totalfee,totfee,discamnt,pporamnt);

   }
}

function DailyTot(totalfee,fee1,fee2,pporamnt) {

  if (parseFloat(fee2.value)>parseFloat(pporamnt.value)) {
    alert("Discount can not be greater than Patient Portion.");
      fee2.focus();
      return;
   }


totalfee.value=0;
  if(!isWhitespace(fee1.value)) {
    if (checkNumber(fee1)) {
      RoundNumber(fee1,2);
      totalfee.value=parseFloat(totalfee.value) +
                  parseFloat(fee1.value)
    }
    else {
      fee1.value="";
      fee1.focus();
      return;
    }
  }
  if(!isWhitespace(fee2.value)) {
    if (checkNumber(fee2)) {
      totalfee.value=parseFloat(totalfee.value) -
                  parseFloat(fee2.value) 
    }
    else {
      fee2.value="";
      fee2.focus();      
      return;
    }
  }

  RoundNumber(totalfee,2);
  justifyRight(totalfee);
  justifyRight(fee1);
  justifyRight(fee2);
}

function SubmitForm() {
   document.UpdateForm.nextpage.value=1;
   setRedirect();
   document.UpdateForm.updatety.value="4";
   UpdateForm.submit();
}

function setRedirect() {
  checkInd=document.UpdateForm.ptmis027.value.substr(3,5)
  checkCVT=document.UpdateForm.ptmis027.value.substr(8,1)
  if (checkInd.search(/M/g) >= 0) {
     document.UpdateForm.redirect.value="patweb89.pbl?reportno=01&template=006"
     + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
     + "&mvmedrec=" + document.UpdateForm.mvmedrec.value.replace(/ /g,"+") 
     + "&returncd=" + document.UpdateForm.returncd.value.replace(/ /g,"+") 
     + "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+");
   } else if (checkInd.search(/V/g) >= 0) {
     document.UpdateForm.redirect.value="patweb89.pbl?reportno=01&template=007"
     + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
     + "&mvmedrec=" + document.UpdateForm.mvmedrec.value.replace(/ /g,"+") 
     + "&returncd=" + document.UpdateForm.returncd.value.replace(/ /g,"+") 
     + "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+");
   } else if (checkInd.search(/W/g) >= 0) {
     document.UpdateForm.redirect.value="patweb89.pbl?reportno=01&template=005"
     + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
     + "&mvmedrec=" + document.UpdateForm.mvmedrec.value.replace(/ /g,"+") 
     + "&returncd=" + document.UpdateForm.returncd.value.replace(/ /g,"+") 
     + "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+");
   } else if (checkInd.search(/E/g) >= 0) {
     document.UpdateForm.redirect.value="patweb78.pbl?reportno=06&template=002"
     + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
     + "&mvmedrec=" + document.UpdateForm.mvmedrec.value.replace(/ /g,"+") 
     + "&returncd=" + document.UpdateForm.returncd.value.replace(/ /g,"+") 
     + "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+");
   } else if (checkCVT.search(/C/g) >= 0) {
     document.UpdateForm.redirect.value="patweb89.pbl?reportno=01&template=021"
     + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
     + "&mvmedrec=" + document.UpdateForm.mvmedrec.value.replace(/ /g,"+") 
     + "&returncd=" + document.UpdateForm.returncd.value.replace(/ /g,"+") 
     + "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+");
   } else if (document.UpdateForm.mvmedrec.value == "1") {
     document.UpdateForm.redirect.value="mrtweb01.pbl?reportno=09&template=004"
     + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
     + "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+");
   } else if (document.UpdateForm.returncd.value == "MEH") {
     document.UpdateForm.redirect.value="patweb89.pbl?reportno=07&template=001"
     + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
     + "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+");
   } else {
     document.UpdateForm.redirect.value="patweb98.pbl?reportno=01&template=043"
     + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
     + "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+");
   }
}
</script>
%START.OF.PAGE
<body onload="PageLoad(event);">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB71.04.003";
PatientVIS="%PATWEB71.04.081";
PatientNAM="%PATWEB71.04.002";
PatientSTA="%PATWEB71.04.086.078";
PatientALT="%PATWEB71.04.084";
PatientSEX="%PATWEB71.04.019";
PatientDOB="%PATWEB71.04.020";
PatientAGE="%PATWEB71.04.021";
PatientLOC="%PATWEB71.04.083";
PatientPRI="%PATWEB71.04.086.066.1";
PatientUNT="%PATWEB71.04.066.0";
DoctorCOD="%PATWEB71.04.082.003";
DoctorNAM="%PATWEB71.04.082.002";
PatientAID="%PATWEB71.04.086.090";
PatientIND="%PATWEB71.04.086.091";
PatientCUR="%PATWEB71.04.086.092";
PatientCLC="%PATWEB71.04.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB71.04.086.094";
PatientCDM="%PATWEB71.04.086.095";
PatientVDH="%PATWEB71.04.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<form name=UpdateForm action=patweb71.pbl method=get>
<input type=hidden name=reportno value="4">
<input type=hidden name=template value="013">
<input type=hidden name=nextpage value="0">
<input type=hidden name=redirect value="">
<input type=hidden name=updatety value="0">
<input type=hidden name=urnumber value="%PATWEB71.04.003">
<input type=hidden name=admissno value="%PATWEB71.04.081">
<input type=hidden name=multhosp value="%PATWEB71.04.598.013.1">
<input type=hidden name=dummy1 value="0.00">
<input type=hidden name=dummy2 value="0.00">
<input type=hidden name=chngdate value="%PATWEB71.04.411">
<input type=hidden name=chngtime value="%PATWEB71.04.412">
<input type=hidden name=pporamnt value="%PATWEB71.04.413">
<input type=hidden name=rporamnt value="%PATWEB71.04.414">
<input type=hidden name=edayrang value="%PATWEB71.04.415">
<input type=hidden name=claimcod value="%PATWEB71.04.126.1">
<input type=hidden name=fundcode value="%PATWEB71.04.114.0">
<input type=hidden name=tabcode value="%PATWEB71.04.115.0">
<input type=hidden name=admsstyp value="%PATWEB71.04.432">
<input type=hidden name=bedtype value="%PATWEB71.04.433">
<input type=hidden name=casmxflg value="%PATWEB71.04.434">
<input type=hidden name=ptmis027 value="%PATWEB71.04.126.3">
<input type=hidden name=mvmedrec value="%PATWEB71.04.436">
<input type=hidden name=returncd value="%PATWEB71.04.437">
<input type=hidden name=sbfeekey value="%PATWEB71.04.441">
<input type=hidden name=pdiemkey value="%PATWEB71.04.447">
<input type=hidden name=ceffdate value="%PATWEB71.04.444">
<table align=center width=100% border=0>
<tr><td class=HeadingCell align=center>Admission Bed Fees</td></tr>
</table>

<table cellspacing=0 cellpadding=1 border=0 width=100% align=center>
%PATWEB71.04.401
</table>

<table cellspacing=0 cellpadding=1 border=0 width=90% align=center>
<tr><td width=75% align=right class=DataLabel>No of days of hospitalisation</td>
    <td align=right>
        <input type=text name=newdhosp title='No of days of hospitalisation'
        class=Integer size=5 maxlength=3 value="%PATWEB71.04.440"
        onchange="checkInteger(this,this.title);GenBFee()">
    </td>

    <td width=75% align=right class=DataLabel>Bed Type</td>
    <td align=right><select name=newbtype title="Bed Type" class=Mandatory
         onchange="GenBFee()">
         <option></option>
         %PATWEB71.04.417.2
         </select>
    </td></tr>
</table>

<table border=0 align=center width=90% align=center cellspacing=0>
<tr valign=bottom><td align=center colspan=2>
    <input type=button value=Ok class="button" onclick="SubmitForm();">
    </td></tr>
</table>

</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB71.04.003">
<input type=hidden name=admissno value="%PATWEB71.04.101">
<input type=hidden name=MenuType value="%PATWEB71.04.088">
</form>
