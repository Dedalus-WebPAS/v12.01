<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function ReportSeq() {
  var fe=document.getElementById('ReportForm').elements;
  var RangeOption  = document.getElementById('RangeOption');
  var RangeOptionA = document.getElementById('RangeOptionA');
  var RangeOptionB = document.getElementById('RangeOptionB');
  var RangeOptionC = document.getElementById('RangeOptionC');
  if (fe.namedItem('keystr01').value == 1) {
     RangeOption.innerHTML  = document.getElementById('HospID').innerHTML;
     RangeOptionA.innerHTML = "";
     RangeOptionB.innerHTML = "";
     RangeOptionC.innerHTML = ""; }
  else if(fe.namedItem('keystr01').value == 2) {
     RangeOption.innerHTML  = document.getElementById('ClinicID').innerHTML;
     RangeOptionA.innerHTML = document.getElementById('ClinicIDA').innerHTML;
     RangeOptionB.innerHTML ="";
     RangeOptionC.innerHTML =""; }
  else {
     RangeOption.innerHTML  = document.getElementById('HospID').innerHTML;
     RangeOptionA.innerHTML =
       document.getElementById('ClinicIDRange').innerHTML;
     RangeOptionB.innerHTML = document.getElementById('ClinicType').innerHTML;
     RangeOptionC.innerHTML = document.getElementById('EmptySlots').innerHTML;
   }

   SetReportDates();
}
function ProcessReport() {
  var fe=document.getElementById('ReportForm').elements;
  if (fe.namedItem('keystr01').value==1) {
       if (fe.namedItem('schdrdat').value=="") {
         fe.namedItem('keystr02').value=fe.namedItem('datran02').value
         fe.namedItem('keystr02').title="Date"
       } else {
         fe.namedItem('keystr02').value=fe.namedItem('dummydat').value
         fe.namedItem('keystr02').title="Schedule"
       }
       fe.namedItem('keystr03').value=fe.namedItem('hospfrom').value
       fe.namedItem('keystr04').value=fe.namedItem('hospitto').value
       fe.namedItem('keystr05').value="Y"
   } else if (fe.namedItem('keystr01').value==2){
       fe.namedItem('keystr02').value=fe.namedItem('clinicid').value
       if(fe.namedItem('schdrdat').value=="") {
         fe.namedItem('keystr03').value=fe.namedItem('datran02').value
         fe.namedItem('keystr03').title="Date"
       } else {
         fe.namedItem('keystr03').value=fe.namedItem('dummydat').value
         fe.namedItem('keystr03').title="Schedule"
       }
       fe.namedItem('keystr04').value=fe.namedItem('clinictm').value.substr(0,2) +
                               fe.namedItem('clinictm').value.substr(3,2);
       fe.namedItem('keystr05').value="Y"
  } else {
       fe.namedItem('keystr02').value=fe.namedItem('hospfrom').value
       fe.namedItem('keystr03').value=fe.namedItem('hospitto').value
       if ( fe.namedItem('keystr03').value  >  " "  &&
            !CheckRange(fe.namedItem('keystr02'),fe.namedItem('keystr03'))) {
         return;
       }
       fe.namedItem('keystr04').value=fe.namedItem('clinicfr').value
       fe.namedItem('keystr05').value=fe.namedItem('clinicto').value
       if ( fe.namedItem('keystr05').value  >  " "  &&
           !CheckRange(fe.namedItem('keystr04'),fe.namedItem('keystr05'))) {
         return;
       }
       if (fe.namedItem('schdrdat').value=="") {
         fe.namedItem('keystr06').title="From Date"
         fe.namedItem('keystr07').title="To Date"
         fe.namedItem('keystr06').value=fe.namedItem('datran01').value
         fe.namedItem('keystr07').value=fe.namedItem('datran02').value
         if(!CheckDateRange(fe.namedItem('keystr06'),fe.namedItem('keystr07'))) {
           return;
         }
       } 
       else {
         fe.namedItem('keystr06').title="From Schedule"
         fe.namedItem('keystr07').title="To Schedule"
       }
       fe.namedItem('keystr08').value=fe.namedItem('clintyfr').value
       fe.namedItem('keystr09').value=fe.namedItem('clintyto').value
       if ( fe.namedItem('keystr09').value  >  " "  &&
            !CheckRange(fe.namedItem('keystr08'),fe.namedItem('keystr09'))) {
         return;
       }
       if(fe.namedItem('printemp').checked==true) {
         fe.namedItem('keystr10').value="Y"
       }
       else {
         fe.namedItem('keystr10').value="N"
       }
       fe.namedItem('keystr11').value="Y"
  }

  SubmitReport(document.getElementById('ReportForm'))
}
function SetReportDates() {
  var fe=document.getElementById('ReportForm').elements;
  var spDays = document.getElementById('days');

  if (fe.namedItem('schdrdat').value=="") {
    if (spDays != undefined) {
      fe.namedItem('schdrdat').parentElement.removeChild(spDays);
    }
  }
  else {
    if (fe.namedItem('schdrdat').value=="O1O0O0") {
      Exclusions="&nbsp;&nbsp;&nbsp;<span id=days>" +
      "Exclude  " +
      "Pub Holidays<input type=checkbox value=1 name=exceptpb>" +
      "Exclude Mon-Sun<input type=checkbox value=1 name=exceptmo>" +
      "<input type=checkbox value=1 name=excepttu>" +
      "<input type=checkbox value=1 name=exceptwe>" +
      "<input type=checkbox value=1 name=exceptth>" +
      "<input type=checkbox value=1 name=exceptfr>" +
      "<input type=checkbox value=1 name=exceptsa>" +
      "<input type=checkbox value=1 name=exceptsu>" +
      "</span>"
      if (spDays == undefined) {
        fe.namedItem('schdrdat').insertAdjacentHTML('AfterEnd',Exclusions);
      }
    }
    else { 
      if (spDays != undefined) {
        fe.namedItem('schdrdat').parentElement.removeChild(spDays);
      }
    }
  }

  var DateRange = document.getElementById('DateRange');
  if (DateRange != null)
  {
    if (fe.namedItem('schdrdat').value == "")
    {
      fe.namedItem('schdrend').value = "";
      if (fe.namedItem('keystr01').value == "3") {
        DateRange.innerHTML = 
         document.getElementById('SetDateRange3').innerHTML;
                                                      // From and to date
      } 
      else {
        DateRange.innerHTML = document.getElementById('SetDateRange').innerHTML;
      }
    }
    else
    {
      if (fe.namedItem('keystr01').value == "3") {
        DateRange.innerHTML = 
          document.getElementById('SetScheduleRange3').innerHTML; 
                                                      // From and to date
      }
      else {
        DateRange.innerHTML = 
          document.getElementById('SetScheduleRange').innerHTML;
      }
      SetReportSchedule(fe.namedItem('datsch01'));
      if (fe.namedItem('datsch01').onchange == null) {
        fe.namedItem('datsch01').onchange = fe.namedItem('datsch01').onblur;
      }
    }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ReportLoad();ReportSeq();
 document.getElementById('ReportForm').elements.namedItem('schddate').focus();">
<form name=ReportForm id=ReportForm method=post action=rshweb02.pbl
      style="margin:0">
<input type=hidden name=reportno id=reportno value=4>
<input type=hidden name=template id=template value=001>
<input type=hidden name=updttype id=updttype value="A">
<input type=hidden name=setdfprg id=setdfprg value="IBAOUT77">
<input type=hidden name=setdfrep id=setdfrep value="01">
<input type=hidden name=schdpgid id=schdpgid value="IBAOUT77">
<input type=hidden name=schddesc id=schddesc value="Clinic List">
<input type=hidden name=nextpage id=nextpage value="1">
<input type=hidden name=redirect id=redirect
       value="rshweb02.pbl?reportno=1&template=1">
<input type=hidden name=dummy id=dummy value="1">
<input type=hidden name=dummydat id=dummydat value="">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>Clinic List</td></tr>

<tr><td>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text name=schddate id=schddate size=12 title="Schedule Date"
    value="%STANDARD.01.015"
    onblur="checkDate(this,'Schedule Date');">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schddate">
    Time
    <input type=text name=schdtime id=schdtime size=12 title="Schedule Time"
    value="%STANDARD.01.016">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schddate" time="ReportForm.schdtime">
    <img notab src="../images/TimeLookup.gif" class="Icon" 
     alt="Time Select" time="ReportForm.schdtime">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><select name=schdprnt id=schdprnt title="Printer" class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBAOUT77.01
        </select>
    </td></tr>
 
<tr><td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy id=schdcopy title='Number of Copies' 
          class=Mandatory>
        </select>
    </td></tr>
 
<tr><td class=DataLabel>Re-schedule Type</td> 
    <td class=DataLabel colspan=3> 
    <select name=schdrdat id=schdrdat title="Schedule Type" 
      onchange="SetReportDates()"> 
    <option></option> 
    </select> 
    </td></tr> 
<tr><td class=DataLabel>Re-schedule Until Date</td>
    <td class=DataLabel colspan=3>
    <input type=text name=schdrend id=schdrend size=12
     onblur="checkDate(this,'Re-schedule Until Date');">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schdrend">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Show Calendar" date="ReportForm.schdrend">
    </td></tr> 

<tr><td colspan=2 align=center><hr width=80%></td></tr>
<tr><td class=DataLabel width=25%>Clinic List</td>
    <td><select name=keystr01 id=keystr01 onchange="ReportSeq()">
        <option value="1">All Clinics</option>
        <option value="2">Single Clinic</option>
        <option value="3">Range of Clinics</option>
        </select>
         <input type=hidden name=keystr02 id=keystr02 value="">
         <input type=hidden name=keystr03 id=keystr03 value="">
         <input type=hidden name=keystr04 id=keystr04 value="">
         <input type=hidden name=keystr05 id=keystr05 value="">
         <input type=hidden name=keystr06 id=keystr06 value="">
         <input type=hidden name=keystr07 id=keystr07 value="">
         <input type=hidden name=keystr08 id=keystr08 value="">
         <input type=hidden name=keystr09 id=keystr09 value="">
         <input type=hidden name=keystr10 id=keystr10 value="">
         <input type=hidden name=keystr11 id=keystr11 value="">
         <input type=hidden name=keystr12 id=keystr12 value="">
    </td></tr>
</table>

<span id=RangeOption></span>
<span id=DateRange></span>
<span id=RangeOptionA></span>
<span id=RangeOptionB></span>
<span id=RangeOptionC></span>

<table width=80% align=center border=0 cellspacing=0>
<tr><td align=center colspan=2><br>
    <input type=button value=Ok class="button" onclick='ProcessReport();'>
    <input type=button value=Cancel class="button"
     onclick='location.href="../lookups/blank.html"' >
    </td></tr>
</table>

</td></tr>

</table>
</form>

<span id=HospID style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Hospital ID</td>
    <td><select name=hospfrom id=hospfrom>
        <option value=" ">Start</option>
        %RSHWEB02.01.122
        </select>
        &nbsp;To&nbsp;
        <select name=hospitto id=hospitto>
        <option value=" ">Finish</option>
        %RSHWEB02.01.122
        </select></td>
    </tr>
</table>
</span>

<span id=ClinicID style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Clinic ID.</td>
    <td><select name=clinicid id=clinicid title="Clinic ID." class="Mandatory">
        <option></option>
        %RSHWEB02.01.110
        </select> 
        </td></tr>
</table>
</span>

<span id=ClinicIDA style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Session Start Time</td>
    <td><input type=text name=clinictm id=clinictm size=10 class="Mandatory"
          onblur="checkTime(this,'Time')" title="Session Start Time"  value="">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="" time="ReportForm.clinictm">
    <img notab src="../images/TimeLookup.gif" class="Icon"
     alt="Time Select" time="ReportForm.clinictm">
    </td></tr>
</table>
</span>

<span id=ClinicIDRange style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>From Clinic ID</td>
    <td><select name=clinicfr id=clinicfr title="From Clinic ID">
        <option value=" ">Start</option>
        %RSHWEB02.01.110
        </select>
        &nbsp;To&nbsp;
        <select name=clinicto id=clinicto title="To Clinic ID">
        <option value=" ">Finish</option>
        %RSHWEB02.01.110
        </select>
    </td>
    </tr>
</table>
</span>

<span id=ClinicType style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>From Clinic Type</td>
    <td><select name=clintyfr id=clintyfr title="From Clinic Type">
        <option value=" ">Start</option>
        %RSHWEB02.01.124
        </select>
        &nbsp;To&nbsp;
        <select name=clintyto id=clintyto title="To Clinic Type">
        <option value=" ">Finish</option>
        %RSHWEB02.01.124
        </select>
    </td>
    </tr>
</table>
</span>

<span id=EmptySlots style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Print Empty Slots</td>
    <td><input type=checkbox name=printemp id=printemp value="1"></td>
    </tr>
</table>
</span>

<span id=SetDateRange3 style="display:none;">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Date</td>
    <td class=DataLabel>
    <input type=text size=15 maxlength=20 name=datran01 id=datran01
    onblur="checkDate(this,'Date')"
    class="Mandatory Date" title="From Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.datran01">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.datran01">
    To
    <input type=text size=15 maxlength=20 name=datran02 id=datran02
    onblur="checkDate(this,'Date')" class="Mandatory Date" title="To Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.datran02">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.datran02">
    </td></tr>
</table>
</span>

<span id=SetScheduleRange3 style="display:none;">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Date</td>
    <td class=DataLabel>
    <select name=datsch01 id=datsch01 title="Schedule Range" class=Mandatory
      onblur="UpReportSchedule(this,
                               document.ReportForm.keystr06,
                               document.ReportForm.keystr07)">
      <option></option>
    </select>
    Sample Range
    <input type=text name=SampleFrom id=SampleFrom size=12> To
    <input type=text name=SampleTo id=SampleTo size=12>
    </td></tr>
</table>
</span>

<span id=SetDateRange style="display:none;">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Date</td>
    <td class=DataLabel>
    <input type=text size=15 maxlength=12 name=datran02 id=datran02
    onblur="checkDate(this,'Date')" class="Mandatory Date" title="Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.datran02">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.datran02">
    </td></tr>
</table>
</span>

<div id=SetScheduleRange style="display:none;">
  <table width=80% align=center border=0 cellspacing=2 cellpadding=1>
  <tr><td class=DataLabel width=25%>Date</td>
      <td class=DataLabel>
         <select name=datsch01 id=datsch01 title="Schedule Range"
           class=Mandatory
           onblur="UpReportSchedule(this,
                                    document.ReportForm.SampleFrom,
                                    document.ReportForm.dummydat)">
          <option></option></select>
          Sample
        <input type=hidden name=SampleFrom id=SampleFrom size=12>
        <input type=text name=SampleTo id=SampleTo size=12>
      </td>
  </tr>
</table>
</div>
