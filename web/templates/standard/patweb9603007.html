<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<style type=text/css> 
.TransferOption {
position: relative; 
}
</style>
<script type="text/javascript">

//Checks indicator 16 of Code BT and displays Admission & Care if flagged
//And makes them mandatory if flagged
function checkBedType(bedTypeValue) {

  if (bedTypeValue.substr(32,1) == 1) {
    displayCabFields("AdmissionType","Q");
    displayCabFields("CareType","4");
    cabFieldsRemoveMandatory("AdmissionType");
    cabFieldsRemoveMandatory("CareType");
  } else if (bedTypeValue.charAt(32,1) == 2) {
    displayCabFields("AdmissionType","Q");
    displayCabFields("CareType","4");
    cabFieldsAddMandatory("AdmissionType");
    cabFieldsAddMandatory("CareType");
  } else {
    hideCabFields("AdmissionType");
    hideCabFields("CareType");
  }
}

function displayCabFields(Title,filtValue) {
  document.getElementById(Title+"Title").innerHTML =
    document.getElementById("Display"+Title+"Title").innerHTML;
  document.getElementById(Title+"Body").innerHTML =
    document.getElementById("Display"+Title+"Body").innerHTML;
  filterCatCodeList(document.getElementById(Title+"Body").childNodes[1],
                    "HCP1",filtValue,"6");

}

function hideCabFields(Title) {
  document.getElementById(Title+"Title").innerHTML = "";
  document.getElementById(Title+"Body").innerHTML = "";
}

function cabFieldsAddMandatory(Title) {
  document.getElementById(Title+"Body").childNodes[1].classList.add("Mandatory");
}

function cabFieldsRemoveMandatory(Title) {
  document.getElementById(Title+"Body").childNodes[1].classList.remove("Mandatory");
}

function GetBedType() {
  if(isWhitespace(pat96btf.trntowrd.value)) {
    return;
  }
  if((document.pat96btf.cfinan.value=="0") ||
     (document.pat96btf.cfinan.value=="1")) {
    return;
  }
  var serverURL   = "../cgi-bin/comweb80.pbl?reportno=39" + 
                    "&valdward=" + pat96btf.trntowrd.value.replace(/ /g,"+") +
                    "&valdabed=" + pat96btf.trntobed.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
    for (var i =0 ; i < pat96btf.newbtype.length; i++) {
      if (pat96btf.newbtype.options[i].value.substr(0,3)==ReturnValue[0]) {
          pat96btf.newbtype.selectedIndex=i; 
          checkBedType(pat96btf.newbtype.value);
     } };
  }
   else {
      pat96btf.newbtype.value="";}
}

function Update(bttn) {
  var p = document.pat96btf;
  tempDisable(bttn);
  checkBedStatus(p.trntowrd.value,p.trntobed.value,
                 p.trandate.options[p.trandate.selectedIndex].text,
                 p.dummy.value,p.trantime.value,SubmitTransfer);
}
function SubmitTransfer() {
  if (validateMandatory(pat96btf)) {
    if(pat96btf.ptcnbedm.value=="1") {
      validateBedRequestUpdate(pat96btf.admissno,pat96btf.trntowrd,
                               pat96btf.trntobed,pat96btf.valdindc);
      WardbedreqUpdate(pat96btf.admissno,pat96btf.trntowrd,pat96btf.trntobed,
                       pat96btf.valdindc)
    }
    SetHousekeeping();
    SetRedirectTrans();
    SubmitHidden(pat96btf);
  }
}
function checkVisitor() {
    pat96btf.pmsvx039.value="0";
    if(pat96btf.d_pmsvx039.checked==1) {
       pat96btf.pmsvx039.value="1" }
}
function checkPhonCal() {
    pat96btf.pmsvx040.value="0";
    if(pat96btf.d_pmsvx040.checked==1) {
       pat96btf.pmsvx040.value="1" }
}
function ShowHouse() {
  if(document.pat96btf.ptcnchot.value=="1") {
    Housekeeping1.innerHTML=Displayhousekeeping1.innerHTML;
    Housekeeping2.innerHTML=Displayhousekeeping2.innerHTML;
    Housekeeping3.innerHTML=Displayhousekeeping3.innerHTML;
    Housekeeping4.innerHTML=Displayhousekeeping4.innerHTML;
  }
}
function HouseMandatory() {
  if(document.pat96btf.notifyhs.value=="1") {
     document.pat96btf.pmhrd006.className="Mandatory"
     document.pat96btf.pmhrd006.disabled=false;
  } else {
     document.pat96btf.pmhrd006.selectedIndex=0;
     document.pat96btf.pmhrd006.className="Readonly"
     document.pat96btf.pmhrd006.disabled=true;
  }
}
function SetHousekeeping() {
  if(document.pat96btf.ptcnchot.value=="1" &&
    document.pat96btf.notifyhs.value=="1") {
    i=document.pat96btf.trandate.selectedIndex;
    document.pat96btf.pmhrd004.value=document.pat96btf.trandate.options[i].text;
    document.pat96btf.pmhrd005.value=document.pat96btf.trantime.value;
  }
}
function ShowBedType() {
  if((document.pat96btf.cfinan.value=="2") ||
     (document.pat96btf.cfinan.value=="3")) {
    DaysHos1.innerHTML=DisplayDaysHos1.innerHTML;
    DaysHos2.innerHTML=DisplayDaysHos2.innerHTML;
    BedType1.innerHTML=DisplayBedType1.innerHTML;
    BedType2.innerHTML=DisplayBedType2.innerHTML;
  }
}
function SummaryPage() {
  CaseList=GetContentCookie("CasePath");
  if (CaseList=="unknown") {
    location.href="patweb98.pbl?reportno=01&template=049" +
    "&urnumber=" + PatientLinks.urnumber.value +
    "&admissno=" + PatientLinks.admissno.value +
    "&MenuType=" + PatientLinks.MenuType.value
  }
  else {
    location.href=CaseList
  }
}
function SetRedirectTrans() {
  if (document.pat96btf.cfinan.value=="1") {
   if (document.pat96btf.casepaym.value=="1") {
     document.pat96btf.redirect.value="patweb71.pbl?reportno=04&template=015"
     + "&urnumber=" + document.pat96btf.urnumber.value
     + "&admissno=" + document.pat96btf.admissno.value
     + "&chngdate=" + document.pat96btf.trandate.value
     + "&chngtime=" + document.pat96btf.trantime.value
   } else {
     document.pat96btf.redirect.value="patweb71.pbl?reportno=04&template=014"
     + "&urnumber=" + document.pat96btf.urnumber.value
     + "&admissno=" + document.pat96btf.admissno.value
     + "&chngdate=" + document.pat96btf.trandate.value
     + "&chngtime=" + document.pat96btf.trantime.value
   }
  }
}

function HideTReason(){
  if(document.getElementById('ptcnbtre')) {
    if(document.getElementById('ptcnbtre').value=="1") {
       document.getElementById('trnttype').className="Mandatory";
       document.getElementById('trnttype').disabled=false;
       return;
    }
  }
  document.getElementById('tReasHd').style.display="none";
  document.getElementById('tReason').style.display="none";
  document.getElementById('trnttype').className="Readonly";
  document.getElementById('trnttype').disabled=true;
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ShowHouse();ShowBedType(); HideTReason();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB96.03.003";
PatientVIS="%PATWEB96.03.081";
PatientNAM="%PATWEB96.03.002";
PatientSTA="%PATWEB96.03.086.078";
PatientALT="%PATWEB96.03.084";
PatientSEX="%PATWEB96.03.019";
PatientDOB="%PATWEB96.03.020";
PatientAGE="%PATWEB96.03.021";
PatientLOC="%PATWEB96.03.083";
PatientPRI="%PATWEB96.03.086.066.1";
PatientUNT="%PATWEB96.03.066.0";
DoctorCOD="%PATWEB96.03.082.003";
DoctorNAM="%PATWEB96.03.082.002";
PatientAID="%PATWEB96.03.086.090";
PatientIND="%PATWEB96.03.086.091";
PatientCUR="%PATWEB96.03.086.092";
PatientCLC="%PATWEB96.03.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB96.03.086.094";
PatientCDM="%PATWEB96.03.086.095";
PatientVDH="%PATWEB96.03.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>

<form name=pat96btf id=pat96btf style="margin:0" %PATWEB96.03.201.001
<input type=hidden name=urnumber id=urnumber value="%PATWEB96.03.003">
<input type=hidden name=admissno id=admissno value="%PATWEB96.03.081">
<input type=hidden name=redirect id=redirect value="%PATWEB96.03.001.patweb96.03.004">
<input type=hidden name=mhredirc id=mhredirc value="%PATWEB96.03.001.patweb89.07.001">
<input type=hidden name=nextpage id=nextpage value="7">
<input type=hidden name=trnleave id=trnleave value="0">
<input type=hidden name=wbedswap id=wbedswap value="0">
<input type=hidden name=bedstat1 id=bedstat1>
<input type=hidden name=warddesc id=warddesc >
<input type=hidden name=formactn id=formactn value="Transfer">
<input type=hidden name=chngunit id=chngunit value="%PATWEB96.03.124.1">
<input type=hidden name=wardcode id=wardcode value="%PATWEB96.03.105.1">
<input type=hidden name=casepaym id=casepaym value="%PATWEB96.03.232">
<input type=hidden name=ptcnbedm id=ptcnbedm value="%STANDARD.01.025.112.106.0.1">
<input type=hidden name=pmsvx039 id=pmsvx039 value="0">
<input type=hidden name=pmsvx040 id=pmsvx040 value="0">
<input type=hidden name=ptcnchot id=ptcnchot value="%STANDARD.01.025.114.138.0.1">
<input type=hidden name=cfinan id=cfinan value="%STANDARD.01.025.018.206.1.1">
<input type=hidden name=ptrgm001 id=ptrgm001 value="%PATWEB96.03.229. 1">
<input type=hidden name=ptrgm002 id=ptrgm002 value="%PATWEB96.03.229. 2">
<input type=hidden name=ptrgm003 id=ptrgm003 value="%PATWEB96.03.229. 3">
<input type=hidden name=dummy id=dummy value="">
<input type=hidden name=ptcnbtre id=ptcnbtre 
       value="%STANDARD.01.025.125.173.0.1">
<input type=hidden name=valdindc id=valdindc value="">

<table border=1 width=100% cellspacing=0 cellpadding=1 >
<tr><td class=HeadingCell align=left>
        <img src="../images/ListIcon.gif" class=Icon 
         onclick='SummaryPage();'></td>
    <td class=HeadingCell align=center colspan=2 width=100%>
        Bed Transfer & Leave Maintenance </td></tr>
</table>

<table border=0 width=100% cellspacing=1>
<tr><td class=HeadingCell align=center colspan=2>Current Status</td>
    <td align=center class=HeadingCell colspan=2>Bed Transfer</td></tr>

<tr><td class=DataLabel>Ward / Bed </td>      
    <td><input type=text size=25 readonly value="%PATWEB96.03.105.0">
        <input type=text size=15 name=beddcode id=beddcode readonly 
         value="%PATWEB96.03.106"></td>

    <td class=DataLabel> Ward / Bed</td>
    <td><select name=trntowrd id=trntowrd class=Mandatory title="Ward"
         onblur="GetBedType();">
        <option></option>
         %PATWEB96.03.210
        </select>
        <input type=text name=trntobed id=trntobed maxlength=3 size=3 
         onblur="GetBedType();">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="WardBedSearchFrame(pat96btf.trntowrd,
                                     pat96btf.warddesc,
                                     pat96btf.trntobed,
                                     pat96btf.bedstat1);">
        </td></tr>

<tr><td class=DataLabel>Transfer In Date & Time </td>
    <td><input type=text size=11 readonly value="%PATWEB96.03.204" 
        tabindex=-1>
        <input type=text size=5 readonly value="%PATWEB96.03.205"
         tabindex=-1></td>

    <td class=DataLabel>Transfer out Date & Time </td>
    <td><select name=trandate id=trandate class=Mandatory title="Transfer date">
         %PATWEB96.03.202
        </select>
        <input type=text size=8 name=trantime id=trantime class=Mandatory 
         title="Transfer Time" value="%STANDARD.01.016">
        <img src="../images/DateTimeStamp.gif" class=Icon
        onclick="SetCurrentDateTime(null,pat96btf.trantime);">
        <img src="../images/TimeLookup.gif" class=Icon
        onclick="TimeLookupFrame(pat96btf.trantime);"></td></tr>

<tr><td class=DataLabel>Attending Doctor</td>
    <td><input type=text size=35 readonly value="%PATWEB96.03.108.002"
         tabindex=-1></td>
    <td id=tReasHd class=DataLabel>%STANDARD.01.017.RB</td>
    <td id=tReason><select name=trnttype id=trnttype 
        title="%STANDARD.01.017.RB" >
        <option value="  "></option>
         %PATWEB96.03.281.4
        </select></td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.A </td>
        <td><input type=text readonly size=30 tabindex=-1
             value="%PATWEB96.03.111.0"> </td>
    <td class=DataLabel>Visitors Allowed ? </td>
    <td><input type=checkbox name=d_pmsvx039 id=d_pmsvx039 value="1"
         onclick="checkVisitor();"> </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CC</td>
    <td><input type=text readonly size=30 tabindex=-1
         value="%PATWEB96.03.113.0"></td>
    <td class=DataLabel>Phone Calls Allowed ? </td>
    <td><input type=checkbox name=d_pmsvx040 id=d_pmsvx040 value="1"
         onclick="checkPhonCal();"> </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.AC</td>
    <td><input type=text readonly size=30 tabindex=-1
         value="%PATWEB96.03.124.0"></td>
    <td><div id="Housekeeping1"></div></td>
    <td><div id="Housekeeping2"></div></td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td><input type=text value="%PATWEB96.03.126.0" tabindex=-1></td>
    <td><div id="Housekeeping3"></div></td>
    <td><div id="Housekeeping4"></div></td></tr>

<tr><td class=DataLabel>Health Fund</td>
    <td><input type="hidden" value="%PATWEB96.03.114.0">
        <input type=text size=35 name="funddesc" id="funddesc" maxlength="30" 
         tabindex=-1 value="%PATWEB96.03.114.1"></td>
    <td><div id="DaysHos1"></div></td>
    <td><div id="DaysHos2"></div></td></tr>

<tr><td>Table</td>
    <td><input type="hidden" value="%PATWEB96.03.115.0">
        <input type="text" size=20 maxlength=30 name="tabldesc" id="tabldesc"
         value="%PATWEB96.03.115.1"></td>
    <td><div id="BedType1"></div></td>
    <td><div id="BedType2"></div></td></tr>

<tr><td></td>
    <td></td>
    <td><div id="AdmissionTypeTitle"></div></td>
    <td><div id="AdmissionTypeBody"></div></td></tr>

<tr><td></td>
    <td></td>
    <td><div id="CareTypeTitle"></div></td>
    <td><div id="CareTypeBody"></div></td></tr>

    <td align=center colspan=3>
        <input type=button value=Update class="button" id='updatebutton'
          onclick="tempDisable(this);Update(this);">
        <input type=button value=Swap class="button" id='swapbutton'
          onclick="tempDisable(this);document.pat96btf.wbedswap.value='1';
                   checkClosedBeds(wardcode.value, beddcode.value,
                                   trntowrd.value, trntobed.value,
                                   SubmitTransfer);">
        <input type=button value=Cancel class="button"
         onclick="PatientLinkTo('patweb96.pbl',3,4,0);"></td></tr>
</table>
</form>
</div>

<form name=PatientLinks id=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB96.03.003">
<input type=hidden name=admissno value="%PATWEB96.03.081">
<input type=hidden name=MenuType value="%PATWEB96.03.088">
<input type=hidden name=alert001 value="">
</form>

<script type="text/javascript">

if ("%PATWEB96.03.539.0" == "1") {
   pat96btf.d_pmsvx039.checked=1 
   pat96btf.pmsvx039.value="1"
}
if ("%PATWEB96.03.540.0" == "1") {
   pat96btf.d_pmsvx040.checked=1 
   pat96btf.pmsvx040.value="1"
}
if ("%PATWEB96.03.230" == "1") {
   alert('Patient linked to a boarder.  '+
        'You may need to transfer the boarder also. ')
}

if("%PATWEB96.03.231" == "1") {
     alert("Patient has a mother/child link. "+
           "You may need to transfer that patient also.");
}

</script>

<div id="Displayhousekeeping1" style="display:none">
Notify Housekeeping
</div>

<div id="Displayhousekeeping2" style="display:none">
  <select name=notifyhs id=notifyhs title="Notify Housekeeping"
   class=Mandatory onchange="HouseMandatory();">
  <option> </option>
  <option value="0">No</option>
  <option value="1">Yes</option>
  </select>
</div>

<div id="Displayhousekeeping3" style="display:none">
Housekeeping Status
</div>

<div id="Displayhousekeeping4" style="display:none">
    <input type=hidden name=pmhrd001 id=pmhrd001 value="%PATWEB96.03.599.004">
    <input type=hidden name=pmhrd002 id=pmhrd002 value="%PATWEB96.03.105.1">
    <input type=hidden name=pmhrd003 id=pmhrd003 value="%PATWEB96.03.106">
    <input type=hidden name=pmhrd004 id=pmhrd004 value="">
    <input type=hidden name=pmhrd005 id=pmhrd005 value=""> 
    <select name=pmhrd006 id=pmhrd006 title="Housekeeping Status" class=Readonly disabled>
      <option> </option>
      %STANDARD.01.007.BV
      </select>
</div>

<div id="DisplayDaysHos1" style="display:none">
No of days of hospitalisation
</div>

<div id="DisplayDaysHos2" style="display:none">
  <input type=text name=dayshosp id=dayshosp title='No of days of hospitalisation'
  class=ReadOnly readonly size=5 value="%PATWEB96.03.130">
</div>

<div id="DisplayBedType1" style="display:none">
Bed Type
</div>

<div id="DisplayBedType2" style="display:none">
  <select name=newbtype id=newbtype title="Bed Type" value="%PATWEB96.03.234"
   onchange="checkBedType(this.value)">
  <option> </option>
     %PATWEB96.03.233.2
  </select>
</div>

<div id="DisplayAdmissionTypeTitle" style="display:none">
%STANDARD.01.017.A
</div>  

<div id="DisplayAdmissionTypeBody" style="display:none">
  <select name=specialt id=specialt title="Admission Type" 
          value="">
  <option></option>
     %PATWEB96.03.209.2
  </select>
</div>

<div id="DisplayCareTypeTitle" style="display:none">
%STANDARD.01.017.CC
</div>

<div id="DisplayCareTypeBody" style="display:none">
  <select name=trnacare id=trnacare title="Care Type"
          value="">
  <option></option>
     %PATWEB96.03.113.2
  </select>
</div>

