<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function submitFilter() {
  hospcodevar = " ";
  if (document.ReportForm.hospcode!=undefined) {
    hospcodevar = document.ReportForm.hospcode.value;
  }
  wardcodevar = " ";
  if (document.ReportForm.wardcode!=undefined) {
    wardcodevar = document.ReportForm.wardcode.value;
  }
  location.href='rshweb02.pbl?reportno=1&template=1&reportid=ibapat40&hospcode='
                +hospcodevar+'&wardoptn='+document.ReportForm.wardoption.value
                +'&wardcode='+wardcodevar;
}
function singleOpat() {
 if (ReportForm.wardoption.value==2){
       document.getElementById('setWardOption').innerHTML=""; }                              
 else{                                                                         
       document.getElementById('setWardOption').innerHTML=document.getElementById('SetWard').innerHTML }
}

function ProcessReport() {
SubmitPage=true
  if (ReportForm.wardoption.value==1) {
    if (document.ReportForm.ibcnmhos.value!=1) {
       ReportForm.keystr01.value=ReportForm.wardoption.value;
       ReportForm.keystr02.value=ReportForm.wardcode.value;
       ReportForm.keystr03.value=ReportForm.wardseq.value; 
       ReportForm.keystr04.value=ReportForm.filtunit.value; 
       ReportForm.keystr05.value=ReportForm.filtclam.value; 
       if (ReportForm.schdrdat.value!="") {
           ReportForm.keystr06.title="From Schedule"
           ReportForm.keystr07.title="To Schedule"
           UpReportSchedule(ReportForm.datsch01,ReportForm.fromkey,
                                                  ReportForm.tokey)
           ReportForm.keystr06.value=ReportForm.fromkey.value;
           ReportForm.keystr07.value=ReportForm.tokey.value;
       }else{
           ReportForm.keystr06.value=SetDateDDMMYYYY(ReportForm.datran01.value);
           ReportForm.keystr07.value=SetDateDDMMYYYY(ReportForm.datran02.value);
       }
       ReportForm.keystr08.value="Y";
       ReportForm.keystr09.value=" ";
       if (ReportForm.schdrdat.value=="") {
         SubmitPage=CheckDateRange(ReportForm.datran01,ReportForm.datran02); }
     }
  }
  if (ReportForm.wardoption.value!=1) {
    if (document.ReportForm.ibcnmhos.value!=1) {
       ReportForm.keystr01.value=ReportForm.wardoption.value;                  
       ReportForm.keystr02.value=ReportForm.wardseq.value;                    
       ReportForm.keystr03.value=ReportForm.filtunit.value; 
       ReportForm.keystr04.value=ReportForm.filtclam.value; 
       if (ReportForm.schdrdat.value!="") {
           ReportForm.keystr05.title="From Schedule"
           ReportForm.keystr06.title="To Schedule"
           UpReportSchedule(ReportForm.datsch01,ReportForm.fromkey,
                                                  ReportForm.tokey)
           ReportForm.keystr05.value=ReportForm.fromkey.value;
           ReportForm.keystr06.value=ReportForm.tokey.value;
       }else{
           ReportForm.keystr05.value=SetDateDDMMYYYY(ReportForm.datran01.value);
           ReportForm.keystr06.value=SetDateDDMMYYYY(ReportForm.datran02.value);
       }
       ReportForm.keystr07.value="Y"; 
       ReportForm.keystr08.value=" ";
       if (ReportForm.schdrdat.value=="") {
         SubmitPage=CheckDateRange(ReportForm.datran01,ReportForm.datran02); }
     }
  }
  if (ReportForm.wardoption.value==1) {
    if (document.ReportForm.ibcnmhos.value==1) {
       ReportForm.keystr01.value=ReportForm.hospcode.value;
       ReportForm.keystr02.value=ReportForm.wardoption.value;
       ReportForm.keystr03.value=ReportForm.wardcode.value;
       ReportForm.keystr04.value=ReportForm.wardseq.value; 
       ReportForm.keystr05.value=ReportForm.filtunit.value; 
       ReportForm.keystr06.value=ReportForm.filtclam.value; 
       if (ReportForm.schdrdat.value!="") {
           ReportForm.keystr07.title="From Schedule"
           ReportForm.keystr08.title="To Schedule"
           UpReportSchedule(ReportForm.datsch01,ReportForm.fromkey,
                                                  ReportForm.tokey)
           ReportForm.keystr07.value=ReportForm.fromkey.value;
           ReportForm.keystr08.value=ReportForm.tokey.value;
       }else{
           ReportForm.keystr07.value=SetDateDDMMYYYY(ReportForm.datran01.value);
           ReportForm.keystr08.value=SetDateDDMMYYYY(ReportForm.datran02.value);
       }
       ReportForm.keystr09.value="Y";
       ReportForm.keystr10.value=" ";
       if (ReportForm.schdrdat.value=="") {
         SubmitPage=CheckDateRange(ReportForm.datran01,ReportForm.datran02); }
     }
  }
  if (ReportForm.wardoption.value!=1) {
    if (document.ReportForm.ibcnmhos.value==1) {
       ReportForm.keystr01.value=ReportForm.hospcode.value;
       ReportForm.keystr02.value=ReportForm.wardoption.value;                  
       ReportForm.keystr03.value=ReportForm.wardseq.value;                    
       ReportForm.keystr04.value=ReportForm.filtunit.value; 
       ReportForm.keystr05.value=ReportForm.filtclam.value; 
       if (ReportForm.schdrdat.value!="") {
           ReportForm.keystr06.title="From Schedule"
           ReportForm.keystr07.title="To Schedule"
          UpReportSchedule(ReportForm.datsch01,ReportForm.fromkey,
                                                  ReportForm.tokey)
           ReportForm.keystr06.value=ReportForm.fromkey.value;
           ReportForm.keystr07.value=ReportForm.tokey.value;
       }else{
           ReportForm.keystr06.value=SetDateDDMMYYYY(ReportForm.datran01.value);
           ReportForm.keystr07.value=SetDateDDMMYYYY(ReportForm.datran02.value);
       }
       ReportForm.keystr08.value="Y"; 
       ReportForm.keystr09.value=" ";
       if (ReportForm.schdrdat.value=="") {
         SubmitPage=CheckDateRange(ReportForm.datran01,ReportForm.datran02); }
     }
  }
 if (SubmitPage) {
     SubmitReport(ReportForm) }
}
</script>
</head>
%START.OF.PAGE
<body onload=PageLoad(event);ReportLoad();document.ReportForm.schddate.focus();>
<form name=ReportForm method=post action=rshweb02.pbl style="margin:0">
  <input type=hidden name=reportno value=4>
  <input type=hidden name=template value=001>
  <input type=hidden name=updttype value="A">
  <input type=hidden name=setdfprg value="IBAPAT40">
  <input type=hidden name=setdfrep value="01">
  <input type=hidden name=schdpgid value="IBAPAT40">    
  <input type=hidden name=schddesc value="Admission Listing">    
  <input type=hidden name=nextpage value="1">
  <input type=hidden name=ibcnmhos value="%RSHWEB02.01.118.000.043.1.1">
  <input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=1">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>
    Admission Listing</td></tr>
</table>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>

<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text name=schddate size=12 title="Schedule Date"
    value="%STANDARD.01.015"
    onblur="checkDate(this,'Schedule Date');">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schddate">
    Time
    <input type=text name=schdtime size=12 title="Schedule Time"
    value="%STANDARD.01.016">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schddate" time="ReportForm.schdtime">
    <img notab src="../images/TimeLookup.gif" class="Icon" 
     alt="Time Select" time="ReportForm.schdtime">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><select name=schdprnt title="Printer" class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBAPAT40.01
        </select>
    </td></tr>
 
<tr><td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy title='Number of Copies' class=Mandatory>
        </select>
    </td></tr>

<tr><td class=DataLabel>Re-schedule Type</td>
    <td class=DataLabel colspan=3>
    <select name=schdrdat title="Schedule Type" onchange=SetReportDates()>
    <option></option>
    </select>
    </td></tr>

<tr><td class=DataLabel>Re-schedule Until Date</td>
    <td class=DataLabel colspan=3>
    <input type=text name=schdrend size=12 
     onblur="checkDate(this,'Re-schedule Until Date');">  
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schdrend">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schdrend">
    </td></tr>

  <input type=hidden name=keystr01 value="">           
  <input type=hidden name=keystr02 value="">           
  <input type=hidden name=keystr03 value="">           
  <input type=hidden name=keystr04 value="">           
  <input type=hidden name=keystr05 value="">           
  <input type=hidden name=keystr06 value="">           
  <input type=hidden name=keystr07 value="">           
  <input type=hidden name=keystr08 value="">           
  <input type=hidden name=keystr09 value="">           
  <input type=hidden name=keystr10 value="">           
  <input type=hidden name=fromkey  value="">       
  <input type=hidden name=tokey    value="">       

<tr><td colspan=2 align=center><hr width=80%></td></tr>

</table>

<span id=HospitalID></span>

<table width=80% align=center border=0 cellspacing=0>
<tr><td class=DataLabel width=25%>Ward Option</td>
    <td><select name=wardoption title="Ward Option" 
         onchange="singleOpat();submitFilter();">
        <option value="2">All Wards</option>      
        <option value="1">Single Ward</option>      
        </select></td></tr>
</table>

<span id=setWardOption></span>

<table width=80% align=center border=0 cellspacing=0>
<tr><td class=DataLabel width=25%>Sequence </td>
    <td><select name=wardseq title="Report Option">
        <option value="1">Admission Number</option>      
        <option value="2">Patient Surname</option>      
        <option value="3">Attending Doctor</option>      
        <option value="4">Unit</option>      
        </select></td></tr>

<tr><td class=DataLabel width=25%>Unit </td>
    <td><select name=filtunit title="Report Option">
        <option value=" ">All</option>
        %STANDARD.01.007.AC
        </select></td></tr>

<tr><td class=DataLabel width=25%>%STANDARD.01.017.CL</td>
    <td><select name=filtclam title="%STANDARD.01.017.CL">
        <option value=" ">All</option>
        %STANDARD.01.007.CL
        </select></td></tr>

<tr><td class=DataLabel>Admission Date Range</td>
    <td><span id=DateRange></span>
    </td></tr>

<tr><td align=center colspan=2><br>
    <input type=button value=Ok class="button" name=formactn
    onclick='tempDisable(this);ProcessReport();'>
    <input type=button value=Cancel class="button" 
     onclick='location.href="../lookups/blank.html"' >
    </td></tr>

</table>
</form>

<div id=SetWard style="display:none;">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Ward </td>
    <td><select name=wardcode title="Ward" class=Mandatory>
        %RSHWEB02.01.171
        </select>
        </td></tr>
</table>
</div>

<div id=SetDateRange style="display:none;">
    <input type=text size=15 maxlength=12 name=datran01
    onblur="checkDate(this,'Date')"
    class="Mandatory PastDate" title="From Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.datran01">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.datran01">
    To
    <input type=text size=15 maxlength=12 name=datran02
    onblur="checkDate(this,'Date')" 
    class="Mandatory PastDate" title="To Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.datran02">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.datran02">
</div>

<div id=SetScheduleRange style="display:none;">
    <select name=datsch01 title="Schedule Range" class=Mandatory
    onblur=UpReportSchedule(this,ReportForm.fromkey,ReportForm.tokey)>
    <option></option></select>
    Sample Range
    <input type=text name=SampleFrom size=12> To
    <input type=text name=SampleTo size=12>
</div>

<span id=HospID style="display:none;">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
    <tr><td class=DataLabel width=25%>Hospital ID</td>
    <td><select name=hospcode title="Hospital ID " onchange="submitFilter();">
    <option value="">All</option>
    %RSHWEB02.01.170
    </select>
    </td></tr>
</table>
</span>

<script language=javascript>
 if (document.ReportForm.ibcnmhos.value==1) {
     HospitalID.innerHTML = HospID.innerHTML; }

 WRDoption = "%RSHWEB02.01.172";
 for (var x=0; x < document.ReportForm.wardoption.length; x++) {
//alert(document.ReportForm.wardoption.options[x].value);
    if (WRDoption==document.ReportForm.wardoption.options[x].value) {
      document.ReportForm.wardoption.selectedIndex=x;
    }
 }
 singleOpat();
</script>
