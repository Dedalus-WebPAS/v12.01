<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientClinicId.js"></script>
<script language="javascript" src="../js/allweb02.js"></script>
<script type="text/javascript">
function SetList()
{
  p=InternalReferral
  var SetSite

  if(p.alcndevp.value=="1") {
    document.getElementById("EventProgramLabel").innerHTML=
    document.getElementById("ShowEventProgramLabel").innerHTML
    document.getElementById("EventProgramField").innerHTML=
    document.getElementById("ShowEventProgramField").innerHTML
  }

  if(isWhitespace(p.alref119.value))
    SetSite=p.wbsesite.value;
  else
    SetSite=p.alref119.value;

 for (var i =0 ; i < document.InternalReferral.alref119.length; i++)
  if (document.InternalReferral.alref119.options[i].value==SetSite.substr(0,6))
    document.InternalReferral.alref119.selectedIndex=i


  p.alref106.options.length=1;
 // SetClinicType(p.alref106,p.defctype.value,p.alref119.value);
  SetClinicType(p.alref106,null,p.alref119.value);

  if(p.alref120.type=="select-one") {
    p.alref120.options.length=1;
    SetClinicId(p.alref120,p.deftclid.value,p.alref119.value);
  } else {
    UpCase(p.alref120);validateClinic(p.alref119,p.alref120,p.name_alref120)
  }
}
function AddCombinedReferral() {
  if(!validateMandatory(MasterReferral)) {
    return;
  }
  if(!validateMandatory(InternalReferral)) {
    return;
  }

  if(!isWhitespace(InternalReferral.alref161.value) &&
     !isWhitespace(InternalReferral.alref090.value)) {
     if(SetDateYYYYMMDD(InternalReferral.alref090.value) >
        SetDateYYYYMMDD(InternalReferral.alref161.value)) {
        alert(InternalReferral.alref161.title + " must be after " +
        InternalReferral.alref090.title);
        return;
     }
  }

  if(!isWhitespace(InternalReferral.alref159.value) &&
     !isWhitespace(InternalReferral.alref090.value)) {
     if(SetDateYYYYMMDD(InternalReferral.alref090.value) >
        SetDateYYYYMMDD(InternalReferral.alref159.value)) {
        alert(InternalReferral.alref159.title + " must be after " +
        InternalReferral.alref090.title);
        return;
     }
  }
    if(!isWhitespace(InternalReferral.alref159.value) &&
       !isWhitespace(InternalReferral.alref161.value)) {
       if(SetDateYYYYMMDD(InternalReferral.alref161.value) >
          SetDateYYYYMMDD(InternalReferral.alref159.value)) {
          alert(InternalReferral.alref159.title + " must be after " +
          InternalReferral.alref161.title);
          return;
       }
    }

    if(!isWhitespace(InternalReferral.alref039.value) &&
       !isWhitespace(InternalReferral.alref090.value)) {
       if(SetDateYYYYMMDD(InternalReferral.alref039.value) >
          SetDateYYYYMMDD(InternalReferral.alref090.value)) {
          alert(InternalReferral.alref039.title + " must be before " +
          InternalReferral.alref090.title);
          return;
       }
    }

    if(!isWhitespace(MasterReferral.alref039.value) &&
       !isWhitespace(MasterReferral.alref132.value)) {
       if(SetDateYYYYMMDD(MasterReferral.alref039.value) >
          SetDateYYYYMMDD(MasterReferral.alref132.value)) {
          alert(MasterReferral.alref132.title + " must be after " +
          MasterReferral.alref039.title);
          return;
       }
    }

  if(isWhitespace(InternalReferral.sacsvisn.value)) {
    if(!AddMasterReferral()) {
      return;
    }
  }
  if (SetDateYYYYMMDD(MasterReferral.alref019.value) > 
      SetDateYYYYMMDD(InternalReferral.alref019.value)) {
    alert("Program referral date can't be after the episode referral date.");
    return;
  }

  if(isWhitespace(InternalReferral.sacsvisn.value)) {
    alert("Error adding progam referral.");
    return;
  }

    if (MasterReferral.alref075.value.substr(14,1)=="1") {
      if (MasterReferral.alref074.value.substr(14,1)=="9") {
      alert("Carer Resident Status is incompatible with Carer Availability.\n" +
            "Please select alternate Carer Resident Status value");
        return;
      }
    }

   //check for ticked restart box and do expiry date calculation
   //check for ticked renew referral box do expiry date calculation
  if(typeofreferraltitlespan.style.display!=='none')
  {
    document.InternalReferral.renewref.value="0";
    if(document.InternalReferral.alref155.checked==true) {
       document.InternalReferral.renewref.value="1";
       calculateRestartRefExpiryDate();
    }
  }

  window.PageUpdateForm=InternalReferral
  InternalReferral.target="PopUpFrame1";
  InternalReferral.submit(); 
}

//========================================================================
// AJAX post funtion to add master referral and return it's visit number
//========================================================================
function AddMasterReferral() {
  var theURL="allweb02.pbl";
  var postStr=AJAXPostString(document.MasterReferral)
  xmlHttp = createHttpObject();
  xmlHttp.open("POST", theURL, false);
  xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded;");
  xmlHttp.send(postStr);
  if (xmlHttp.status=="200") {
    if (xmlHttp.responseText.match(/PROCESSING_OK/i)) {
       responseArray=xmlHttp.responseText.split("|");
       InternalReferral.sacsvisn.value=responseArray[0].substr(14,8);
       for (var i=1; i < responseArray.length; i++) {
          if(!isWhitespace(responseArray[i])) {
             alert(responseArray[i]);
          }
       }
    return true;
    }
    else {
      alert(xmlHttp.responseText.replace(/.*alert../i,"").replace(/.\).*/i,""));
      return false;
    }
  }
  else {
    alert("Web Service Not Available. Check your Connection and Try Again.");
   return false;
  }
}
function init() {
  p=InternalReferral
  var SetSite

  if(p.alcndevp.value=="1") {
    document.getElementById("EventProgramLabel").innerHTML=
    document.getElementById("ShowEventProgramLabel").innerHTML
    document.getElementById("EventProgramField").innerHTML=
    document.getElementById("ShowEventProgramField").innerHTML
  }

  if(isWhitespace(p.alref119.value)) {
      SetSite=p.wbsesite.value;
  } else {
      SetSite=p.alref119.value;
  }

  for (var i =0 ; i < p.alref119.length; i++)
   if (p.alref119.options[i].value==SetSite.substr(0,6))
     p.alref119.selectedIndex=i

  p.alref106.options.length=1;
  SetClinicType(p.alref106,p.defctype.value,p.alref119.value);
  if(p.alref120.type=="select-one") {
    p.alref120.options.length=1;
    SetClinicId(p.alref120,p.deftclid.value,p.alref119.value);
  }
}
function DefRefDate() {
  if(!checkDate(MasterReferral.alref019,'Referral Date')) {
    return;
  }
  InternalReferral.alref019.value=MasterReferral.alref019.value;
  checkTriageDate();
}
function checkTriageDate() {
  InternalReferral.alref187.value=MasterReferral.alref187.value;

  if(!document.getElementById("alref187")) {  // Triage Date
    return;
  }
  triageD=document.getElementById("alref187");
  if(isWhitespace(triageD.value)) {
    return;
  }
  if(!checkDate(triageD,triageD.title)) {
    return;
  }
  if(!document.getElementById("alref019")) {   // Referral Date
    return;
  }
  referralD=document.getElementById("alref019");
  if (SetDateYYYYMMDD(referralD.value) > SetDateYYYYMMDD(triageD.value)) {
    alert("Triage date must be after the referral date");
    triageD.value="";
    triageD.focus();
  }
}
function DefRefRecDate() {
  if(!checkDate(MasterReferral.alref039,'Referral In Received Date')) {
    return;
  }
  InternalReferral.alref039.value=MasterReferral.alref039.value;
}
function DefRefPriority() {
  InternalReferral.alref027.value=MasterReferral.alref027.value;
}
function SetInternalDept() {
  InternalReferral.deptcode.value=InternalReferral.allrf001.value;
  selectOptions2(59,InternalReferral.deptcode,InternalReferral.alref028);
  validateCode2(60,InternalReferral.deptcode,InternalReferral.d_alref028)
  if(!isWhitespace(InternalReferral.d_alref028.value)) {
    for (var i =0 ; i < InternalReferral.alref028.length; i++) {
    if (trim(InternalReferral.alref028.options[i].value)==
        trim(InternalReferral.d_alref028.value)) {
        InternalReferral.alref028.selectedIndex=i } };
  }
  for (var i =0 ; i < document.InternalReferral.deptlcod.length; i++)
  {
    if (document.InternalReferral.deptlcod.options[i].value.substr(0,3)==
        document.InternalReferral.deptcode.value.substr(0,3))
    {
        document.InternalReferral.deptlcod.selectedIndex=i;
    }
  }
  displayClinicId();
  displayReason();
  displaySourceOfReferral();
  filterNDISEpsRef(InternalReferral);    // Filter NDIS claim codes
  displayCarePlan2(InternalReferral);
  mandReasonForRefEPS();
}
function openHealthConditionAddV() {
  if(isWhitespace(document.InternalReferral.deptcode.value)) {
     alert("Please select an Episode Program Stream.");
    return;
  }
  var alref090 = document.getElementById("alref090");
  var linkUrl = "allweb02.pbl?reportno=03&template=004&chkvinah=1&deptcode="+
                 document.InternalReferral.deptcode.value +
                 "&valddate="+ alref090.value;

  displayDiagnosisPopupFrame(linkUrl);
}
function openOtherFactorsAffectingHealthAdd() {
  if(isWhitespace(document.InternalReferral.deptcode.value)) {
     alert("Please select an Episode Program Stream.");
    return;
  }
  var linkUrl = "allweb02.pbl?reportno=03&template=006&deptcode="+
                 document.InternalReferral.deptcode.value;

  displayDiagnosisPopupFrame(linkUrl);
}
function openReferralDestinationAdd() {
  if(isWhitespace(document.InternalReferral.deptcode.value)) {
     alert("Please select an Episode Program Stream.");
    return;
  }
  var linkUrl = "allweb02.pbl?reportno=03&template=008&deptcode="+
                 document.InternalReferral.deptcode.value;

  displayDiagnosisPopupFrame(linkUrl);

}
function displayClinicId() {
  if (document.InternalReferral.deptlcod.value.substr(34,1)  == "2") {
    clinicidtitlespan.style.display="";
    clinicidfieldspan.style.display="";
    return;
  }
  if (document.InternalReferral.deptlcod.value.substr(34,1)  == "1") {
    clinicidtitlespan.style.display="";
    clinicidfieldspan.style.display="";
    document.InternalReferral.alref120.className="Mandatory";
    return;
  }
  clinicidtitlespan.style.display="none";
  clinicidfieldspan.style.display="none";
  document.InternalReferral.alref120.className="";
  return;

}
function displayReason() {
  if (document.InternalReferral.deptlcod.value.substr(30,1) == "2" ||
      document.InternalReferral.deptlcod.value.substr(30,1) == "3") {
    reasontitlespan.style.display="";
    reasonfieldspan.style.display="";
    document.InternalReferral.alref028.className="SelectBig";
    return;
  }

  if (document.InternalReferral.deptlcod.value.substr(30,1)  == "1") {
    reasontitlespan.style.display="";
    reasonfieldspan.style.display="";
    document.InternalReferral.alref028.className="SelectBig Mandatory";
    return;
  }

  reasontitlespan.style.display="none";
  reasonfieldspan.style.display="none";
  document.InternalReferral.alref028.className="SelectBig";
  return;

}
function displaySourceOfReferral() {
  if (document.InternalReferral.deptlcod.value.substr(35,1)  == "2") {
    sourceofreferraltitlespan.style.display="";
    sourceofreferralfieldspan.style.display="";
    return;
  }
  if (document.InternalReferral.deptlcod.value.substr(35,1)  == "1") {
    sourceofreferraltitlespan.style.display="";
    sourceofreferralfieldspan.style.display="";
    document.InternalReferral.alref034.className="SelectBig Mandatory";
    return;
  }
  sourceofreferraltitlespan.style.display="none";
  sourceofreferralfieldspan.style.display="none";
  document.InternalReferral.alref034.className="SelectBig";
  return;

}
function displayTypeOfReferral() {
  if (document.MasterReferral.deptlcod.value.substr(33,1)  == "2") {
    typeofreferraltitlespan.style.display="";
    typeofreferralfieldspan.style.display="";
    typeofreferraltitlespan1.style.display="";
    typeofreferralfieldspan1.style.display="";
    typeofreferraltitlespan2.style.display="";
    typeofreferralfieldspan2.style.display="";
    typeofreferraltitlespan3.style.display="";
    typeofreferralfieldspan3.style.display="";
    displayRenewedReferral();
    return;
  }
  if (document.MasterReferral.deptlcod.value.substr(33,1)  == "1") {
    typeofreferraltitlespan.style.display="";
    typeofreferralfieldspan.style.display="";
    typeofreferraltitlespan1.style.display="";
    typeofreferralfieldspan1.style.display="";
    document.InternalReferral.alref124.className="SelectBig Mandatory";
    typeofreferraltitlespan2.style.display="";
    typeofreferralfieldspan2.style.display="";
    typeofreferraltitlespan3.style.display="";
    typeofreferralfieldspan3.style.display="";
    displayRenewedReferral();
    return;
  }
}
function displayRenewedReferral(){
  if((document.MasterReferral.deptlcod.value.substr(10,1)  == 'O') ||
    (document.MasterReferral.deptlcod.value.substr(10,1)  == 'S')){
    typeofreferralfieldspan4.style.display="";
    typeofreferraltitlespan5.style.display="";
    typeofreferralfieldspan5.style.display="";
  }
}
function calculateRestartRefExpiryDate() {
  if(isWhitespace(document.InternalReferral.alref124.value)) {return;}
  if(isWhitespace(document.InternalReferral.alref168.value)) {return;}
  if(parseInt(document.InternalReferral.alref124.value.substr(25,6))=="0") {
    document.InternalReferral.alref125.value="";
    return;
  }
//
  save_renewal_date = document.InternalReferral.alref168.value;

  AddSubtractDate(document.InternalReferral.alref168,
                  document.InternalReferral.alref124.value.substr(22,6),
                  "A");

  document.InternalReferral.alref125.value=document.InternalReferral.alref168.value;
  document.InternalReferral.alref168.value=save_renewal_date;
}
function MandatoryRenewalDate() {
  if(typeofreferraltitlespan.style.display!=='none')
  { 
    if(document.InternalReferral.alref155.checked!=true) {
      document.InternalReferral.alref168.className="Readonly Date";
  //   document.UpdateForm.alref168.value=document.UpdateForm.d_alref168.value;
      document.InternalReferral.alref168.readOnly=true;
    } else {
      document.InternalReferral.alref168.className="Mandatory Date";
      document.InternalReferral.alref168.readOnly=false;
    }
  }
}
function UpdateGP(){
    if(isWhitespace(InternalReferral.alref022.value)) {
        alert("Referring HCP is a required field");
        InternalReferral.rusualgp.checked=false;
        return;
    }
    if(InternalReferral.rusualgp.checked==true) {
      if(!confirm("This will update the PMI Usual GP field?")) {
        InternalReferral.rusualgp.checked=false;
        return;
      }
    }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);displayReason();displayClinicId();
              displaySourceOfReferral();CommonProgramRefComb();
              ShowRelationship(document.MasterReferral.alref075);
              showPriorityOption(InternalReferral);ValidatePriority();
              displayTypeOfReferral();">
<span class=DFrameTitleBar>
<img border=0 align=right src="../images/ExitIcon.gif" onclick="DFrameExit();">
%ALLWEB02.03.125.0  Referral
</span>
<div id=PageBodySection style="overflow: auto;">
<form name=MasterReferral action="allweb02.pbl" method=post>
<input type=hidden name=reportno value="2">
<input type=hidden name=updatety value="A">
<input type=hidden name=nextpage value="6">
<input type=hidden name=urnumber value="%ALLWEB02.03.003">
<input type=hidden id=deptcode name=deptcode value="%ALLWEB02.03.125.1">
<input type=hidden name=dummy>
<input type=hidden name=alref083 value="1">
<input type=hidden name=alref028 value=" ">
<input type=hidden name=override value="2">
<input type=hidden name=referlin value="1" />
<input type=hidden name=deptlcod id=deptlcod value="%ALLWEB02.03.125.3">

<input type="hidden" name="d_aldeutrs" id="d_aldeutrs"
       value="%ALLWEB02.03.762.3">
<input type="hidden" name="d_alrestat" id="d_alrestat"
       value="%ALLWEB02.03.199.027">
<input type="hidden" name="d_aldeuprt" id="d_aldeuprt"
       value="%ALLWEB02.03.762.4">
<input type=hidden name=ptcnhdps id=ptcnhdps 
       value="%STANDARD.01.025.080.250.1.1">

<table align=center cellspacing=0 cellpadding=0 border=0 width=100%>
<tr><td class=DataLabel width=15%>Referral In Program</td>
    <td width=35%><input name=allrf001 type=text value="%ALLWEB02.03.125.0" 
          readonly class=Readonly></td>
    <td class=DataLabel width=17%>Entered by</td>
    <td width=33%><input type=text value="%ALLWEB02.03.168" readonly 
	  class=Readonly></td></tr>

<tr><td class=DataLabel><div id="tsHeading"></div></td>
    <td><div id="tsField"></div></td>
    <td class=DataLabel><div id="tdHeading"></div></td>
    <td><div id="tdField"></div></td>
    </tr>

<tr><td class=DataLabel><div id="prHeading"></div></td>
    <td><div id="prField"></div></td>
    <td class=DataLabel>&nbsp;</td>
    <td>&nbsp;</td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.zU</td>
    <td><select title="%STANDARD.01.017.zU" id=rfdtr001 name=rfdtr001
         class="Mandatory SelectBig"
   onchange="SetCurrentDateTimeNoFocus(document.MasterReferral.rfdat001,null);">
        <option></option>
         %STANDARD.01.018.zU.   .9.1.01.2.O
        </select>
	<input type=hidden name=rfdat001 value="">
        <input type=hidden name=rfdpl001 value="">
    </td>
    <td class=DataLabel>Referral Date</td>
    <td class=DataField>
    <input type=text id=alref019 name=alref019 size=12 id=alref019
     onblur="DefRefDate();"
     class= "PastDate Mandatory" title="Referral Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=MasterReferral.alref019
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=MasterReferral.alref019>
    </td></tr>

<tr><td class=DataLabel>Referral In Receipt<br />Acknowledgement Date</td>
    <td class=DataField>
    <input type=text id=alref132 name=alref132 size=12
     onblur="checkDate(this,'Date')" value=""
     class="PastDate" title="Date of Referral Receipt Acknowledgement">
    <img src=../images/DateTimeStamp.gif class=Icon date=MasterReferral.alref132
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=MasterReferral.alref132>
    </td>
    <td class=DataLabel>Referral In Received Date</td>
    <td class=DataField>
    <input type=text id=alref039 name=alref039 size=12
     onblur="DefRefRecDate();" value="%ALLWEB02.03.139"
     class="Mandatory PastDate" title="Referral In Received Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=MasterReferral.alref039
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=MasterReferral.alref039>
    </td></tr>

<tr><td class=DataLabel>Carer Availability</td>
    <td><select title="Carer Availability" id=alref075 name=alref075 
         class="SelectBig" onchange="ShowRelationship(this);">
        <option></option>
         %ALLWEB02.03.140.36.4
        </select></td>
    <td class=DataLabel>
    <span id="careplantitlespan" style="display:none">
    Care Plan Documented Date
    </span>
    </td>
    <td class=DataField>
    <span id="careplanfieldspan" style="display:none">
    <input type=text id=alref096 name=alref096 size=12
     onblur="checkDate(this,'Date')" value=""
     class="PastDate" title="Care Plan Documented Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=MasterReferral.alref096
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=MasterReferral.alref096>
    </span>
    </td>
    </tr>

<tr><td class=DataLabel><div id="CarerRelHeading"></div></td>
    <td><div id="CarerRel"></div></td>
    <td class=DataLabel>Living Arrangement</td>
    <td><select title="Living Arrangement" name=alref077
         class="SelectBig">
        <option></option>
         %ALLWEB02.03.140.38.4
        </select></td>
    </tr>

<tr><td class=DataLabel><div id="CarerResHeading"></div></td>
    <td><div id="CarerRes"></div></td>
    <td class=DataLabel>Accommodation</td>
    <td><select title="Accommodation" name=alref078
         class="SelectBig">
        <option></option>
         %ALLWEB02.03.140.39.4
        </select></td>
    </tr>

<tr><td class=DataLabel></td>
    <td></td>
    <td class=DataLabel>Hospital Discharge Date</td>
    <td class=DataField> <input type=text id=alref165 name=alref165 size=12
     onblur="checkDate(this,'Date')" value=""
     class="PastDate" title="Hospital Discharge Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=MasterReferral.alref165
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=MasterReferral.alref165>
   </td>
   </tr>

<tr><td colspan=4 align=center><hr>
    </td></tr>

</table>
</form>

<form name=InternalReferral action="allweb02.pbl" method=post>
<input type=hidden name=reportno value="2">
<input type=hidden name=updatety value="A">
<input type=hidden name=nextpage value="5">
<input type=hidden name=redirect value="%ALLWEB02.03.001.allweb02.02.001">
<input type=hidden name=urnumber value="%ALLWEB02.03.003">
<input type=hidden name=deptcode value="">
<input type=hidden name=dummy>
<input type="hidden" name=sacsvisn value=" ">
<input type=hidden name=override value="2">
<input type=hidden name=alcndevp value="%STANDARD.01.025.106.225.0.1">
<input type=hidden name=wbsesite value="%STANDARD.01.023">
<input type=hidden name=defctype value="">
<input type=hidden name=d_alref028 value="">
<input type=hidden name=deftclid value="">
<input type=hidden name=CATEG_CL value="CL">
<input type=hidden name=renewref value="">

<table align=center cellspacing=0 cellpadding=0 border=0 width=100%>
<tr><td class=DataLabel></td>
    <td>
    <span id="deptlcodfieldspan" style="display:none">
      <select name=deptlcod tabindex=-1 class="Select">
        <option></option>
         %STANDARD.01.007.CG
      </select>
    </span>
    </td>
</tr>

<tr><td class=DataLabel width=15%>Episode Program Stream</td>
    <td width=35%><select title="Epsiode Program Stream" name=allrf001
         id=allrf001 class="SelectBig Mandatory" onchange="SetInternalDept();">
        <option></option>
         %ALLWEB02.03.218
        </select>
        </td>
    <td class=DataLabel width=17%>Entered By</td>
    <td width=33%><input type=text value="%ALLWEB02.03.168" readonly
          class=Readonly>
    </td></tr>

<tr><td class=DataLabel>
    <span id="reasontitlespan" style="display:none">
    Reason for Referral
    </span>
    </td>
    <td>
    <span id="reasonfieldspan" style="display:none">
      <select title="Reason for Referral" name=alref028 id="alref028"
         class="SelectBig" maxlength=49>
        <option></option>
      </select>
    </span>
    </td>
    <td class=DataLabel>Preferred Site</td>
    <td class=DataField><select id=alref119 name=alref119 title="Preferred Site" 
     onchange="SetList();" >
     <option></option>
      %ALLWEB02.03.182.2
     </select>
     </td></tr>

<tr><td class=DataLabel><div id="tsHeadingEps"></div></td>
    <td><div id="tsFieldEps"></div></td>
    <td class=DataLabel><div id="tdHeadingEps"></div></td>
    <td><div id="tdFieldEps"></div></td>
    </tr>

<tr><td class=DataLabel><div id="prHeadingEps"></div></td>
    <td><div id="prFieldEps"></div></td>
    <td class=DataLabel>Referral Date</td>
    <td class=DataField>
    <input type=text name=alref019 size=12 id="alref019eps"
     onblur="checkDate(this,'Date')"
     class= "PastDate Mandatory" title="Referral Date">
    <img src=../images/DateTimeStamp.gif class=Icon
     date=InternalReferral.alref019
     time=null>
    <img src=../images/DateLookup.gif class=Icon
     date=InternalReferral.alref019>
    </td></tr>

<tr><td class=DataLabel>
    <span id="sourceofreferraltitlespan" style="display:none">
    Source of Referral
    </span>
    </td>
    <td>
    <span id="sourceofreferralfieldspan" style="display:none">
      <select title="Source of Referral" name=alref034
        class="SelectBig">
        <option></option>
        %ALLWEB02.03.134.4
      </select>
    </span>
    </td>
    <td class=DataLabel>Referral In Received Date</td>
    <td class=DataField>
    <input type=text id=alref039 name=alref039 size=12
     onblur="checkDate(this,'Date')" value="%ALLWEB02.03.139"
     class="Mandatory PastDate" title="Referral In Received Date">
    <img src=../images/DateTimeStamp.gif class=Icon 
     date=InternalReferral.alref039
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=InternalReferral.alref039>
    </td></tr>

<tr><td class=DataLabel>Referred By</td>
    <td><input type=hidden id=alref022 name=alref022
         value="%ALLWEB02.03.122.1">
        <input type=text name=n_alref022 readonly title="HCP Name"
         id=n_alref022 value="%ALLWEB02.03.122.0" notab>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(InternalReferral.alref022,InternalReferral.n_alref022,0);">
        <img src="../images/ClearIcon.gif" class=Icon
        onclick="clrFields(alref022,n_alref022);">
        </td>
    <td class=DataLabel>Case Manager</td>
    <td><input type=text id=alref086 name=alref086 size=10 maxlength=10
          value="%ALLWEB02.03.147.1"
         onblur="ValidateHCP(18,13,alref086,n_alref086);">
        <input type=text name=n_alref086 size=20 readonly title="HCP Name"
         id=n_alref086 class=Readonly value="%ALLWEB02.03.147.0">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(InternalReferral.alref086,InternalReferral.n_alref086,4);">
         <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(alref086,n_alref086);">
        </td>
        <tr>

<tr><td class=DataLabel>
    <span id="typeofreferraltitlespan" style="display:none">
    Type of Referral
    </span>
    </td>
    <td>
    <span id="typeofreferralfieldspan" style="display:none">
    <select name=alref124 title="Type of Referral" tabindex=21>
        <option></option>
         %ALLWEB02.03.186.2
        </select>
    </span>
    </td>
    <td class=DataLabel>
    <span id="typeofreferraltitlespan2" style="display:none">
    Provider Number
    </span>
    </td>
    <td><span id="typeofreferralfieldspan2" style="display:none">
        <input type=text size=21 maxlength=8
         title="Provider Number" id=hcpprovno name=hcpprovno
       onchange="ReadDoc2(18,0,alref022,n_alref022,alref023,n_alref023,alref024,hcpprovno);">
         &nbsp;Retain as Usual GP?
        <input type=checkbox value="0" id=rusualgp name=rusualgp
         title="Retain as Usual GP" onclick="UpdateGP();">
    </span>
    </td>
    </tr>

<tr><td class=DataLabel>
    <span id="typeofreferraltitlespan1" style="display:none">
    Referral Expiry Date
    </span>
    </td>
    <td>
    <span id="typeofreferralfieldspan1" style="display:none">
    <input type=text id=alref125 name=alref125 size=12 class=Readonly readonly
         tabindex=23  title="Referral Expiry Date">
    </span>
    <span id="typeofreferralfieldspan4" style="display:none">
    Referral Renewal Date
    <input type=text id=alref168 name=alref168 size=12 tabindex=23
     class="Readonly Date" readonly
     title="Referral Renewal Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=InternalReferral.alref168
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=InternalReferral.alref168>
    </span>
    </td>
    <td class=DataLabel>
    <span id="typeofreferraltitlespan3" style="display:none">
    Referred By Practice
    </span>
    </td>
    <td><span id="typeofreferralfieldspan3" style="display:none">
        <input type=text size=10 class=readonly
         title="Referred By Practice" readonly id=alref023 name=alref023>
        <input type=text size=20 class=readonly
         title="Practice Name" readonly id=n_alref023 name=n_alref023>
        <input type=hidden id=alref024 name=alref024
         title="Practice Count" >
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="GPHCGSearchFrame(alref022,n_alref022,hcpprovno,alref023,n_alref023,alref024)">
        <img src="../images/erase.gif" class=Icon
         onclick="clrFields(alref023,n_alref023,alref024,hcpprovno);">
    </span>
    </td></tr>

<tr><td class=DataLabel>Responsible HCP</td>
    <td><input type=text name=alref038 size=10 maxlength=10
         id=alref038 title="Responsible HCP"
         value="%ALLWEB02.03.138.1" class=Mandatory
          onblur="ValidateHCP(18,0,alref038,n_alref038);">
        <input type=text name=n_alref038 size=23 readonly title="HCP Name"
         id=n_alref038 value="%ALLWEB02.03.138.0" class=Readonly>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(InternalReferral.alref038,InternalReferral.n_alref038,0);">
         <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(alref038,n_alref038);">
        </td>
    <td><div id="EventProgramLabel"></div></td>
    <td><div id="EventProgramField"></div></td>
    <tr>

<tr><td class=DataLabel>Clinic Type </td>
    <td><select class="SelectBig Mandatory" name=alref106 maxlength=45 
         title="Clinic Type">
        <option></option>
        </select></td>
    <td class=DataLabel>%STANDARD.01.017.CL</td>
    <td><select title="%STANDARD.01.017.CL" name=alref035 
         class="Mandatory SelectBig">
        <option></option>
         %ALLWEB02.03.135.9.1.10.2.X
        </select></td>
    <tr>

    <tr><td class=DataLabel>Case Team</td>
    <td><input type=text name=alref087 size=11 maxlength=10 title="Case Team"
         id=alref087 onblur="validateCode2(7,alref087,n_alref087)">
        <input type=text id=n_alref087 name=n_alref087 size=22 readonly
         class=Readonly notab title="Team Description">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="TeamSearchFrame(alref087,n_alref087)">
         <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(alref087,n_alref087);">
        </td>
    <td class=DataLabel>
    <span id="clinicidtitlespan" style="display:none">
    Clinic ID
    </span>
    </td>
    <td class=DataField>
    <span id="clinicidfieldspan" style="display:none">
    <select name=alref120 title="Clinic ID" tabindex=23>
                          <option></option>
                        </select>
    </span>
    </td>
    </tr>

<tr>
    <td class=DataLabel>Case Review Date</td>
    <td class=DataField><input type=text name=alref139 size=12
     id=alref139 onblur="checkDate(this,'Date');" value=""
     class="Date" title="Case Review Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=InternalReferral.alref139
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=InternalReferral.alref139>
    </td>

    <td></td>
    <td><input type="button" class="Extralargebutton" id="btnMainHealth"
         value="Episode Health Conditions"
         onclick="openHealthConditionAddV();" />
    </td>
    </tr>

<tr><td></td>
    <td></td>
    <td>Episode Health Condition 1</td>
    <td>
    <input type="text" id="mhcon001" name="mhcon001" size="10"
      title="Episode Health Condition Code 1"
     value=""
     onblur="validateAHDiagV(deptcode,mhcon001,d_mhcon001,alref090);" />
    <input type="text" id="d_mhcon001" name="d_mhcon001" class="ReadOnly"
     value="" readonly="true" size="20" tabindex=-1/>
    <img src="../images/SearchIcon.gif" class="Icon" id="imgSearch"
     onclick="AHDiagSearchFrameV(deptcode,mhcon001,d_mhcon001,alref090);" />
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(mhcon001,d_mhcon001);">
    </td>
    </tr>

<tr><td></td>
    <td></td>
    <td>Episode Health Condition 2</td>
    <td>
    <input type="text" id="mhcon002" name="mhcon002" size="10"
     id=mhcon002 title="Episode Health Condition Code 2" value=""
     onblur="validateAHDiagV(deptcode,mhcon002,d_mhcon002,alref090);" />
    <input type="text" id="d_mhcon002" name="d_mhcon002" class="ReadOnly"
     id=d_mhcon002 value=""  readonly="true" size="20" tabindex=-1/>
    <img src="../images/SearchIcon.gif" class="Icon" id="imgSearch"
     onclick="AHDiagSearchFrameV(deptcode,mhcon002,d_mhcon002,alref090);" />
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(mhcon002,d_mhcon002);">
    </td>
    <tr>
       
<tr><td class=DataLabel>Date Referral Accepted</td>
    <td class=DataField> <input type=text name=alref090 size=12
     id=alref090 onblur="checkDate(this,'Date')" value=""
     class="PastDate" title="Date Referral Accepted">
    <img src=../images/DateTimeStamp.gif class=Icon 
     date=InternalReferral.alref090
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=InternalReferral.alref090>
    </td>
    <td></td>
    <td><input type="button" class="Extralargebutton" id="btnOtherFactors"
         value="Other Factors Affecting Health"
         onclick="openOtherFactorsAffectingHealthAdd();"/></td>
    </tr>

<tr><td class=DataLabel>First Appointment Booked</td>
    <td class=DataField><input type=text name=alref159 size=12
     id=alref159 onblur="checkDate(this,'Date');MandatoryAccepted();" value=""
     class="Date" title="Episode First Appointment Booked Date">
    <img src=../images/DateTimeStamp.gif class=Icon 
     date=InternalReferral.alref159
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=InternalReferral.alref159>
    </td>
    <td></td>
    <td><input type="button" class="Extralargebutton"
         id="btnReferralDestination" name="btnReferralDestination"
         value="Referral Out"
         onclick="openReferralDestinationAdd();"/>
    </td>
    </tr>
 
<tr><td class=DataLabel>Notified of First Appointment</td>
    <td class=DataField><input type=text name=alref161 size=12
     id=alref161 onblur="checkDate(this,'Date')" value=""
     class="PastDate" title="Notified of First Appointment">
    <img src=../images/DateTimeStamp.gif class=Icon 
     date=InternalReferral.alref161 time=null>
    <img src=../images/DateLookup.gif class=Icon date=InternalReferral.alref161>
    </td>
    <td class=DataLabel>
    <span id="careplantitlespan2" style="display:none">
    Episode Care Plan Documented
    </span>
    </td>
    <td class=DataField>
    <span id="careplanfieldspan2" style="display:none">
    <input type=text id=alref096 name=alref096 size=12
     onblur="checkDate(this,'Date')" value=""
     class="PastDate" title="Episode Care Plan Documented">
    <img src=../images/DateTimeStamp.gif class=Icon 
     date=InternalReferral.alref096
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=InternalReferral.alref096>
    </span>
    </td>
    </tr>

<tr>
  <td class=DataLabel>Advanced Care Plan Documented Date</td>
  <td>
    <input type=text title="Advanced Care Plan Documented Date"
     id=alref164 name=alref164 size=12 class="Date">
    <img src=../images/DateTimeStamp.gif class=Icon
     date=InternalReferral.alref164 time=null>
    <img src=../images/DateLookup.gif class=Icon date=InternalReferral.alref164>
  </td>
  <td class=DataLabel></td>
  <td></td>
</tr>

<tr><td class=DataLabel>Comments 1</td>
    <td colspan=3><input type=text size=65 maxlength=62 name=alref088>
    </td></tr>

<tr><td class=DataLabel>Comments 2</td>
    <td colspan=2><input type=text size=65 maxlength=62 name=alref089>
    </td>
    </tr>
<tr><td class=DataLabel>
     <span id="typeofreferraltitlespan5" style="display:none">
     Restart Referral Period
     </span>
    </td>
    <td><span id="typeofreferralfieldspan5" style="display:none">
        <input type=checkbox id=alref155 name=alref155 value="1"
         title="Restart Referral Period" onclick="MandatoryRenewalDate();"
         tabindex=12>
        </span>
      </td>
      <td class=DataLabel></td>
      <td class=DataLabel></td>
</tr>

<tr><td class=DataLabel
     colspan=2>Print Referral Letter to Patient&nbsp;&nbsp;&nbsp;&nbsp;
     <input type=checkbox name=prtnewpt
      title="New Referral to pat" value="1">
      </td>
      <td class=DataLabel>Printer </td>
      <td><select name=prtpsl01 class=SelectBig >
      %STANDARD.01.001.ALLNEWPT.01
      </select></td></tr>

<tr><td class=DataLabel colspan=2>Print Referral Letter to Referrer&nbsp;
      <input type=checkbox name=prtnewrf
       title="New Referral to pat" value="1">
      </td>
      <td class=DataLabel>Printer </td>
      <td><select name=prtpsl02 class=SelectBig >
      %STANDARD.01.001.ALLNEWRF.01
      </select></td></tr>

<tr><td class=DataLabel colspan=2>Referral Labels
    <input type=checkbox value="1" name=prtreflb width=30% 
     onclick="SetPrinter(InternalReferral.prtpno07,InternalReferral.prtpsl07);">
    Copies
    <select name=prtpno07 width=20% >
        %STANDARD.01.027.2.1
    </select></td>
    <td class=DataLabel>Printer</td>
    <td><select class="SelectBig" name=prtpsl07 title="Printer" width=17%>
         
        <option></option>
        %STANDARD.01.001.LABELALL.01
        </select></td></tr>

<tr><td colspan=4 align=center><br>
    <input type=button name=formactn value="Add" class="button" id="all02sub"
    onclick="tempDisable(this);AddCombinedReferral();">
    <input type=button Value="Cancel" class="button"
     onclick="DFrameCloseRefresh();">
    </td></tr>

</table>
</form>
</div>

<span id="ShowCarerRelHD" style="display:none">
%STANDARD.01.017.lE
</span>

<span id="ShowCarerRel" style="display:none">
  <select title="%STANDARD.01.017.lE" name=alref070 
   class="SelectBig Mandatory">
   <option></option>
   %ALLWEB02.03.140.31.2
   </select>
</span>

<span id="ShowCarerRelBlank" style="display:none">
  <input type="hidden" name="alref070" value=" ">
</span>

<span id="ShowCarerResHD" style="display:none">
%STANDARD.01.017.lI
</span>

<span id="ShowCarerRes" style="display:none">
  <select title="%STANDARD.01.017.lI" name=alref074
   class="SelectBig Mandatory">
  <option></option>
  %ALLWEB02.03.140.35.2
  </select>
</span>

<span id="ShowCarerResBlank" style="display:none">
   <input type="hidden" name="alref074" value=" ">
</span>

<span id="ShowEventProgramLabel" style="display:none">
  Event Program
</span>

<span id="ShowEventProgramField" style="display:none">
  <select class="Mandatory SelectBig" name=alref145 title="Event Program"
   id=alref145 onchange="filterNDISEpsRefCL(InternalReferral);">
  <option></option>
  %ALLWEB02.03.199.016.4
  </select>
</span>

<span id="showtsHeading" style="display:none">
Triage Status
</span>

<span id="showtsField" style="display:none">
<select title="Triage Status" name=alref186 class="Mandatory SelectBig"
 id="alref186" onchange="showPriorityTriage();setEpisodeTriage();">
<option></option>
%ALLWEB02.03.199.066.2
</select>
</span>

<span id="showtdHeading" style="display:none">
Triage Date
</span>

<span id="showtdField" style="display:none">
<input type=text name=alref187 id=alref187 size=12 title="Triage Date"
 value="%ALLWEB02.03.199.067" class="PastDate"
 onblur="checkTriageDate(this);">
<img src=../images/DateTimeStamp.gif class=Icon
 date=MasterReferral.alref187 time=null>
<img src=../images/DateLookup.gif class=Icon date=MasterReferral.alref187>
</span>

<span id="showprHeading" style="display:none">
Priority
</span>

<span id="showprField" style="display:none">
<select class="Mandatory selectBig" name=alref027 id=alref027
 title="Priority" onchange="DefRefPriority();ValidatePriority();">
<option></option>
 %ALLWEB02.03.127.2
</select>
</span>

<span id="showtdHeadingEps" style="display:none">
Triage Date
</span>

<span id="showtdFieldEps" style="display:none">
<input type=text name=alref187 id=alref187eps size=12 title="Triage Date"
 value="%ALLWEB02.03.199.067" class="PastDate"
 onblur="checkTriageDateEpisode(this);">
<img src=../images/DateTimeStamp.gif class=Icon
 date=InternalReferral.alref187 time=null>
<img src=../images/DateLookup.gif class=Icon date=InternalReferral.alref187>
</span>

<span id="showtsHeadingEps" style="display:none">
Triage Status
</span>

<span id="showtsFieldEps" style="display:none">
<select title="Triage Status" name=alref186 class="Mandatory SelectBig"
 id="alref186Eps" onchange="showPriorityTriageEps()">
<option></option>
%ALLWEB02.03.199.066.2
</select>
</span>

<span id="showtdHeadingEps" style="display:none">
Triage Date
</span>

<span id="showtdFieldEps" style="display:none">
<input type=text name=alref187 id=alref187eps size=12 title="Triage Date"
 value="%ALLWEB02.03.199.067" class="PastDate"
 onblur="checkTriageDateEpisode(this);">
<img src=../images/DateTimeStamp.gif class=Icon
 date=InternalReferral.alref187 time=null>
<img src=../images/DateLookup.gif class=Icon date=InternalReferral.alref187>
</span>

<span id="showprHeadingEps" style="display:none">
Priority
</span>

<span id="showprFieldEps" style="display:none">
<select title="Priority" name=alref027 class="Mandatory SelectBig"
 id="alref027Eps">
<option></option>
%ALLWEB02.03.127.2
</select>
</span>
