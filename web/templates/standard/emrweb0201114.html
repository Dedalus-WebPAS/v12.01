<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function clrFieldsCheck() {
  if(UpdateForm.linkvist.readOnly==true) {
    alert("Link to visit is a readonly field");
    return;
  }
  clrFields(UpdateForm.linkvist);
}
function SearchCheck() {
  if(UpdateForm.linkvist.readOnly==true) {
    alert("Link to visit is a readonly field");
    return;
  }
  VisitSearchFrame(UpdateForm.urnumber,UpdateForm.linkvist);
}
function UpdateLink() {
 if(!isWhitespace(parent.document.UpdateForm.username.value)) {
 getUserIDForLoginName(parent.document.UpdateForm.username,UpdateForm.webuseid);
 }
 if(validateMandatory(UpdateForm)) {
   document.UpdateForm.submit();
 }
}
//------------------------------------------------------------
// Validate a visit number and check it is for this U/R
//------------------------------------------------------------
function ValidateVisit(ValidateV,ValidateUR,ReturnName) {
  ReturnFunction="" ;
  ReturnName.value="";
  for (var i=3; i < ValidateVisit.arguments.length; i++) {
    if (typeof(ValidateVisit.arguments[i]) == 'function') {
      ReturnFunction=ValidateVisit.arguments[i] }
    else {
      ValidateVisit.arguments[i].value=""; }  }
  if (isWhitespace(ValidateV.value)) return;;
  var admissNo=document.getElementById('admissno');
  var serverURL = "../cgi-bin/emrweb08.pbl?reportno=18&valdcode=" +
                    ValidateV.value.replace(/ /g,"+") +
                    "&valdurno=" + ValidateUR.value.replace(/ /g,"+")+
                    "&admissno=" + admissNo.value.replace(/ /g,"+")+
                    "&mhosflag=1"
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    ReturnName.value=ReturnValue[0];
    j=0
    for (var i=3; i < ValidateVisit.arguments.length; i++) {
       if (typeof(ValidateVisit.arguments[i]) != 'function') {
         j++
         ValidateVisiValidateVisit.arguments[i].value=ReturnValue[j] } }
    if (typeof(ReturnFunction) == 'function') {
       ReturnFunction() } }
  else {
    ValidateV.value="";
    ValidateV.focus();;
    return false;}
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Link to Inpatient Admission
</span>

<form name="UpdateForm" action="emrweb02.pbl" method="post" style="margin:0">
<input type="hidden" name="reportno" value="18">
<input type="hidden" name="template" value="114">
<input type="hidden" name="admissno" id="admissno" value="%EMRWEB02.01.081">
<input type="hidden" name="urnumber" value="%EMRWEB02.01.003">
<input type="hidden" name="updttype" value="ERROR">
<input type="hidden" name=webuseid value="">
<input type="hidden" name=dummy>
<input type="hidden" name=d_linkvist value="%EMRWEB02.01.148">

<table width="95%" border="0" cellspacing="0" cellpadding="0" align=center>
<tr><td class=DataLabel>Link to visit</td>
    <td>
    <input type=text maxlength=8 class="DataField" Title="Link to Visit" 
     size=10
     name=linkvist value="%EMRWEB02.01.148" onblur="justifyRight(this);
     ValidateVisit(UpdateForm.linkvist,UpdateForm.urnumber,dummy);">
    <img src="../images/SearchIcon.gif" class=Icon onclick="SearchCheck();">
    <img src="../images/erase.gif" class=Icon onclick="clrFieldsCheck();">
  </td>
</tr>

<tr><td align=center colspan=2> 
    <input type="button" value="OK" class="button" name=OkButton id="emr02ok"
     onclick="tempDisable(this);UpdateLink();">
    <input type="button" value="Cancel" class="button" name=CanButton
     onclick="DFrameClose();">
  </td>
</tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=MenuType value="%EMRWEB02.01.088">
<input type=hidden name=webuseid value="%STANDARD.01.008">
</form>
