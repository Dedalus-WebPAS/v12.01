<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb06.js"> </script>
<script type="text/javascript">
//=============================================================================
//  Set option for a combo box - match based on first 3 characters.
//=============================================================================
function Update() {
    document.UpdateForm.oppim001.value=document.UpdateForm.opthi001.value;

    document.UpdateForm.oppim001.value=document.UpdateForm.opthi001.value;

    UpdateForm.updatety.value="H";
    if(validateMandatory(UpdateForm))
       UpdateForm.submit();
  }

function RoundOff(field){
   if(isNaN(field.value)){
     alert(field.title+" must be numeric");
     field.select();
   } 
   else{
     field.value=Math.round(field.value*100)/100;
   }
}
function CheckEAN(FormName){

//  if(isWhitespace(FormName.opthi001.value)) { return; }

  var serverURL= "../cgi-bin/patweb80.pbl?reportno=22&valdcode=" +
                 FormName.opthi001.value +
                 "&valbcode=" + FormName.pbarcode.value +
                 "&valdtype=1" ;
  ReturnValue=RSExecute(serverURL);

  if(ReturnValue.status==0){
    Value=ReturnValue.return_value.split("|");

    if (Value[0]!=0){
      FormName.opthi002.value=Value[0];
      FormName.opthi002.readOnly=true;
      FormName.opthi002.className="Readonly";
      FormName.opthi002.tabIndex="-1";

      FormName.opthi003.value=Value[1];
      SetCombo3(FormName.opthi003,Value[1])
      FormName.opthi003.readOnly=true;
      FormName.opthi003.className="Readonly";
      FormName.opthi003.selectedIndex=i;
      FormName.opthi003.tabIndex="-1";

      FormName.opthi004.value=Value[2];
      FormName.opthi004.readOnly=true;
      FormName.opthi004.className="Readonly";
      FormName.opthi004.tabIndex="-1";
      FormName.miscbutt.disabled=true;

      FormName.opthi005.value=Value[3];
      FormName.opthi005.readOnly=true;
      FormName.opthi005.className="Readonly";
      FormName.opthi005.tabIndex="-1";

      FormName.opthi006.value=Value[4];
      FormName.opthi006.readOnly=true;
      FormName.opthi006.className="Readonly";
      FormName.opthi006.tabIndex="-1";

      FormName.opthi007.value=Value[5];
      FormName.opthi007.readOnly=true;
      FormName.opthi007.className="Readonly";
      FormName.opthi007.tabIndex="-1";

      FormName.opthi008.value=Value[6];
      FormName.opthi008.readOnly=true;
      FormName.opthi008.className="Readonly";
      FormName.opthi008.tabIndex="-1";
      FormName.opthi008.value=FormName.opthi008.value.replace(/ /g,"");

    } else {
     SetFlds();
     return;
    }
  }
  else{
    FormName.opthi001.select();
  }
}
function SetFlds() {
//   clrFields(UpdateForm.opthi002,UpdateForm.opthi003);
//   clrFields(UpdateForm.opthi007,UpdateForm.opthi005,UpdateForm.opthi008);
//   clrFields(UpdateForm.opthi006,UpdateForm.opthi004);

   UpdateForm.opthi002.readOnly=false;
   UpdateForm.opthi002.className="Mandatory";
   UpdateForm.opthi002.value=UpdateForm.olddesc.value

   UpdateForm.opthi003.className="";
   UpdateForm.opthi003.disabled=false;
   SetCombo3(UpdateForm.opthi003,UpdateForm.oldtype.value)

   UpdateForm.opthi004.className="";
   UpdateForm.opthi004.readOnly=false;
   UpdateForm.opthi004.value=UpdateForm.oldmisc.value
   UpdateForm.miscbutt.disabled=false;

   UpdateForm.opthi005.readOnly=false;
   UpdateForm.opthi005.className="";
   UpdateForm.opthi005.value=UpdateForm.oldmanuf.value

   UpdateForm.opthi006.readOnly=false;
   UpdateForm.opthi006.className="";
   UpdateForm.opthi006.value=UpdateForm.oldsize.value

   UpdateForm.opthi007.readOnly=false;
   UpdateForm.opthi007.className="";
   UpdateForm.opthi007.value=UpdateForm.oldsuppl.value

   UpdateForm.opthi008.readOnly=false;
   UpdateForm.opthi008.className="";
   UpdateForm.opthi008.value=UpdateForm.oldcost.value
}
function GenericPass() {
  var serverURL  = "../cgi-bin/patweb80.pbl?reportno=11" +
              "&secureid=" + document.UpdateForm.username.value +
              "&securepw=" + document.UpdateForm.password.value +
              "&valdtype=1";

  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    return true;
  }
  else {
    document.UpdateForm.password.value="";
    return false;
  }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);CheckEAN(UpdateForm);">
<span class=DFrameTitleBar>
<img border=0 align=right src=../images/ExitIcon.gif onclick=DFrameExit()
 class="MenuIcon" alt="Exit">
%OPRWEB06.07.002 (%OPRWEB06.07.003) - Assign Ad-hoc Implant 
</span>

<form id=UpdateForm name=UpdateForm action="oprweb06.pbl" method=post 
 onSubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value=7>
<input type=hidden name=updatety >
<input type=hidden name=oppim001 value='%OPRWEB06.07.208'>
<input type=hidden name=ocpim010 value='%OPRWEB06.07.229'>
<input type=hidden name=icounter value='%OPRWEB06.07.221'>
<input type=hidden name=casekeys value='%OPRWEB06.07.101'>
<input type=hidden name=teamnumb value='%OPRWEB06.07.206'>
<input type=hidden name=multhosp value="%OPRWEB06.07.398.013.1">
<input type=hidden name=pbarcode value="%OPRWEB06.07.229">
<input type=hidden name=dummy value="">
<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
</table>

<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td>&nbsp;</td></tr>
</table>

<table align=center cellspacing=0 cellpadding=0 bgcolor=#cccccc width=95%>
<tr><td align=center>Ad-hoc Details</td></tr>
</table>

<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td>&nbsp;</td></tr>
</table>

<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td width=15% class=DataLabel>Barcode</td>
    <td width=25%>
     <input type=text size=60 class=Readonly readonly
     value='%OPRWEB06.07.229'  title="Barcode" maxlength=60></td>
    <td width=15% class=DataLabel>Description</td>
    <td class=DataField>
    <input type=text size=65 class=Readonly value='%OPRWEB06.07.213' readonly
     name=olddesc title="Description">
    </td>
</tr>

<tr><td class=DataLabel>Type of Implant</td>
    <td><input type=text size=20 title="Type of Implant" name=oldtype
         value='%OPRWEB06.07.214.0' class=Readonly readonly></td>
    <td class=DataLabel>Size</td>
    <td><input type=text size=12 title="Size" name=oldsize
     value='%OPRWEB06.07.217' class=Readonly readonly >
    </td></tr>
<tr><td class=DataLabel>Supplier</td>
    <td><input type=text size=32 name=oldsuppl
     value='%OPRWEB06.07.218'  title="Supplier" 
     class=Readonly readonly></td>
    <td class=DataLabel>Manufacturer</td>
    <td><input type=text size=65 name=oldmanuf
     value='%OPRWEB06.07.216'  title="Manufacturer" class=Readonly readonly></td>
    </tr>
<tr><td class=DataLabel>Cost</td>
    <td><input type=text size=16 name=oldcost
     value='%OPRWEB06.07.219'  title="Cost"
      class="Number Readonly" readonly></td>
    <td class=DataLabel>Misc.Charge Code</td>
    <td><input type=text size=10 readonly name=oldmisc
     class=Readonly title="Misc.Charge Code"  value='%OPRWEB06.07.215'>
    &nbsp;Reference Number
     <input type=text size=15 title="Reference Number"
        value='%OPRWEB06.07.222' readonly class=Readonly>
    </td>
</tr>
</table>

<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td>&nbsp;</td></tr>
</table>

<table align=center cellspacing=0 cellpadding=0 bgcolor=#cccccc width=95%>
<tr><td align=center>New Details</td></tr>
</table>

<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td>&nbsp;</td></tr>
</table>

<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td width=12% class=DataLabel>EAN Number</td>
    <td width=33% class=DataField>
     <input type=text size=18 id=opthi001 name="opthi001" class=Mandatory
     title="EAN Number" maxlength=15 onblur="CheckEAN(UpdateForm)">
    <img src=../images/SearchIcon.gif class=Icon
    onclick="ImplantSearchFrameEANBar(UpdateForm.opthi001,UpdateForm.pbarcode,'11');">
    </td>
    <td width=12% class=DataLabel>Description</td>
    <td class=DataField>
    <input type=text size=65 class=Mandatory title="Description"
     name="opthi002" maxlength=60></td></tr>

<tr><td class=DataLabel>Type of Implant</td>
    <td class=DataField><select name="opthi003" title="Type of Implant">
    <option ></option>
     %OPRWEB06.07.230.2
    </select></td>

    <td class=DataLabel>Size</td>
    <td class=DataField><input type=text size=12 name="opthi006" title="Size"
     maxlength=10>
    </td></tr>
<tr><td class=DataLabel>Supplier</td>
    <td class=DataField><input type=text size=32 name="opthi007" maxlength=30
     title="Supplier"> </td>
    <td class=DataLabel>Manufacture</td>
    <td class=DataField><input type=text size=65 name="opthi005" maxlength=60
    title="Manufacturer"> </td></tr>
<tr> <td class=DataLabel>Cost</td>
    <td class=DataField><input type=text size=16 name="opthi008" maxlength=15
     title="Cost" onblur=RoundOff(this) min=0 max=999999999999.99></td>
     <td class=DataLabel>Misc.Charge Code</td>
     <td><input type=text size=10 id=opthi004 name="opthi004" 
	title="Misc.Charge Code"
        maxlength=9 onblur="validateMisc(UpdateForm.opthi004,UpdateForm.dummy,
                                         UpdateForm.multhosp);">
     <img src=../images/SearchIcon.gif class=Icon id=miscbutt name=miscbutt
   onclick="DefMiscChargeSearchFrame(UpdateForm.opthi004,UpdateForm.dummy,
                                     UpdateForm.multhosp);">
    &nbsp;Reference Number
     <input type=text size=15 name="dtrre001" title="Reference Number"
        value='%OPRWEB06.07.222' maxlength=12>
    </td>
 </tr>
</table>

<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td cellspacing=0 cellpadding=2 colspan=4><hr></td></tr>

<tr><td class=DataLabel width=12%>Team</td>
    <td class=DataField width=33%>%OPRWEB06.07.206 </td>
    <td class=DataLabel width=12%>Username</td>
    <td><input type=text size=12 name=username class=Mandatory
         value="%STANDARD.01.008" title="User ID">
    &nbsp;Password
        <input type=password size =12 name=password class=Mandatory
         title="Password" onblur="GenericPass();"></td>
    </tr>

<tr><td class=DataLabel>Quantity</td>
    <td class=DataField>
    <input type=text size=3 name="oppim002" align=left title="Quantity" min=1
     value='%OPRWEB06.07.209' maxlength=3   class="Integer Mandatory">
     </td>
    <td class=DataLabel><div id=ProComp1></div></td>
    <td><div id=ProComp2></div></td></tr>

<tr><td class=DataLabel>Lot/Serial No</td>
    <td class=DataField>
    <input type=text size=25 name="oppim003" title="Lot/Serial No" maxlength=20
     value='%OPRWEB06.07.210'>
    </td></tr>
<tr><td class=DataLabel>Location</td>
    <td class=DataField>
    <select name="oppim005" title="Location">
    <option></option>
     %OPRWEB06.07.212.2
    </select>
    </td></tr>

</table>
<table align=center cellspacing=0 cellpadding=3 border=0 width=45%>
<tr><td align=center>
    <input type=button Value="Assign" id="opr06sub" class="button" onclick="tempDisable(this);Update();">
    <input type=button Value="Close" class="button" onclick="DFrameClose();">
    </td></tr>
    </table>
</form>

<script type="text/javascript">

</script>



