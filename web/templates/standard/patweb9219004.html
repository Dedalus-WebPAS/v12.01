<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript" src="../js/patweb92.js"></script>
<script type="text/javascript">
function switchView() {
  document.SelectPeriod.template.value="3"; 
  SelectSubmit();  
}
function displayOEC(weboecky,urnumber,admissno) {
//alert(weboecky);
  DFrameStart()
  linkurl="../cgi-bin/eclweb02.pbl?reportno=5&template=2"+
          "&weboecky=" + weboecky.replace(/ /g,"+") +
          "&urnumber=" + urnumber.replace(/ /g,"+") +
          "&admissno=" + admissno.replace(/ /g,"+");
//alert(linkurl);
  Left=(document.body.clientWidth-1300)/2;
  DFrameLink(linkurl,0,Left,1300,700);
}
function UpdateOECConsent(oecconsent) {

  if (oecconsent.checked) { x = "1"; } else { x = " "; }

  var serverURL = "../cgi-bin/comweb81.pbl?reportno=25" +
                  "&valdcode=" + x +
                  "&valdadmn=" + oecconsent.value.replace(/ /g,"+");

  var returnValue = RSExecute(serverURL);

  location.reload();

}	
function UpdateOECConsentBook(oecconsent) {

  if (oecconsent.checked) { x = "1"; } else { x = " "; }

  var serverURL = "../cgi-bin/comweb81.pbl?reportno=44" +
                  "&valdcode=" + x +
                  "&valdadmn=" + oecconsent.value.replace(/ /g,"+");

  var returnValue = RSExecute(serverURL);

  location.reload();

}
function pad(num, size) {
    var s = num+"";
    while (s.length < size) s = "0" + s;
    return s;
}
function GetMBSDescriptions() {

  var inputs = document.getElementsByTagName('input');

  for (var i = 0; i < inputs.length; i++) {
        if (inputs[i].name.substr(0,5)=='oecmb') {
          validateCode(4,eval("TableForm.oecmb"+inputs[i].name.substr(5,8)),
                         eval("TableForm.oecds"+inputs[i].name.substr(5,8)),
                         eval("TableForm.oecdt"+inputs[i].name.substr(5,8)));
//      alert(inputs[i].name+" "+eval("TableForm.oecdt"+inputs[i].name.substr(5,8)));
        }
  }

}
function checkPresillMBS(presill,mbs,admissno,counter) {

  if(!isWhitespace(presill.value) && !isWhitespace(mbs.value)) {
    alert("Both Presenting Illness and MBS cannot be populated at the same time."); 
    location.reload();
    return;
  }

  var serverURL = "../cgi-bin/comweb81.pbl?reportno=24" +
                  "&valdcode=" + presill.value.replace(/ /g,"+") +
                  "&valdcod2=" + mbs.value.replace(/ /g,"+") +
                  "&valdcod3=" + counter.value.replace(/ /g,"+") +
                  "&valdadmn=" + admissno.value.replace(/ /g,"+");

//alert(serverURL);


  var returnValue = RSExecute(serverURL);
  location.reload();
}
function checkPresillMBSBook(presill,mbs,admissno,counter) {

  if(!isWhitespace(presill.value) && !isWhitespace(mbs.value)) {
    alert("Both Presenting Illness and MBS cannot be populated at the same time.");
    location.reload();
    return;
  }

  var serverURL = "../cgi-bin/comweb81.pbl?reportno=43" +
                  "&valdcode=" + presill.value.replace(/ /g,"+") +
                  "&valdcod2=" + mbs.value.replace(/ /g,"+") +
                  "&valdcod3=" + counter.value.replace(/ /g,"+") +
                  "&valdadmn=" + admissno.value.replace(/ /g,"+");

//alert(serverURL);


  var returnValue = RSExecute(serverURL);
  location.reload();
}
function disOEC(urnumbr,visitno,repcount) {
//  linkurl="patweb78.pbl?reportno=9&template=004" +
//          "&oecnumbr=" + eligibilitynumber
//  Left=(document.body.clientWidth-800)/2;
//  DFrameLink(linkurl,10,Left,800,400)

  document.PatientLinks.urnumber.value=urnumbr.replace(/\+/g," ");
  document.PatientLinks.admissno.value=visitno.replace(/\+/g," ");
  document.PatientLinks.repcount.value=repcount.replace(/\+/g," ");


  PatientLinkTo('patweb78.pbl',6,3,1,900,900);

}
function UpdateElgCheck(hospcheckchbox) {
//  alert(hospcheckchbox.value+" "+hospcheckchbox.checked);

  var hcchbox = " ";

  if (hospcheckchbox.checked) {
    hcchbox = "1";
  }

  var serverURL = "../cgi-bin/comweb81.pbl?reportno=23" +
                  "&valdcode=" + hospcheckchbox.value.replace(/ /g,"+") +
                  "&valdcod2=" + hcchbox.replace(/ /g,"+");
                 

  var returnValue = RSExecute(serverURL);

  location.reload();
}
function InclHospComp() {
 if (document.SelectPeriod.t_hospcomp.checked==true) {
   document.SelectPeriod.hospcomp.value="1";
 } else {
   document.SelectPeriod.hospcomp.value="0";
 }
}
function PrintBOECR() {
 if (document.SelectPeriod.t_oecrprnt.checked==true) {
   document.SelectPeriod.oecrprnt.value="1";
   document.SelectPeriod.selprint.className="Mandatory";
 } else {
   document.SelectPeriod.oecrprnt.value="0";
   document.SelectPeriod.selprint.className="";
 }
}
function ViewRequest(vis,cnt) {
  linkurl="patweb92.pbl?reportno=19&template=002&updttype=D" +
          "&pmsoc001=" + vis.replace(/ /g,"+") +
          "&pmsoc002=" + cnt.replace(/ /g,"+")
  Left=(document.body.clientWidth-600)/2
  DFrameLink(linkurl,50,Left,600,300)
}
function SelectSubmit() {
  document.SelectPeriod.submit();
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 document.title="Booking/Pre Adm. Bulk Eligibility Request"
 t = new Table(1,0,2,"100%","center",50,50);
 t.addColumn("Booking/ Visit No.","String",1,1,"center","","",45)
 t.addColumn("Patient Name","ImageText",2,2,"left","PatientFolder","12",140,13)
 t.addColumn("Presenting Illness","String",19,19,"left","","",100)
 t.addColumn("MBS","String",20,20,"left","","",150)
 t.addColumn("Doctor","String",15,15,"left","","",60)
 t.addColumn("Reason for Admission","String",14,14,"left","","",80)
 t.addColumn("Claim Code","String",3,3,"left","","",60)
 t.addColumn("Health Fund","String",4,4,"left","","",30)
 t.addColumn("Admission Status","String",5,5,"left","","",50)
 t.addColumn("Expected Admission Date","Date",6,6,"left","","",60)
 t.addColumn("OEC Consent","String",21,21,"left","","",40)
 t.addColumn("Hospital Check","String",16,16,"left","","",40)
// t.addColumn("Request Status","ImageText",8,8,"left","MaintenanceIcon","0",45,10)
 t.addColumn("Request Status","String",18,18,"left","","",50)
 t.addColumn("Eligibility Response","String",17,17,"left","","",70)
 t.addColumn("Request Response Date","DateTime",9,9,"left","","",60)
 t.addColumn("Request Eligibility","String",11,11,"left","","",40)
 AddTableRows()
 TableOutput(5,1);    // Order Column,Asc Dsc
 break; }
 }
}
</script>
</head>
%START.OF.PAGE
<body onload=PageLoad(event);InitTable(0);GetMBSDescriptions();>
<div id=HeadingSection>
<form name=SelectPeriod action=patweb92.pbl method=get style="margin:0">
 <input type=hidden name=reportno value=19>
 <input type=hidden name=template value=4>
 <input type=hidden name=updttype value=" ">
 <input type=hidden name=redirect value="patweb92.pbl?reportno=19&template=004">
 <input type=hidden name=nextpage value="1">
 <input type=hidden name=viewtype value="%PATWEB92.19.011">
 <input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
 <input type=hidden name=hospcomp value="%PATWEB92.19.013">
 <input type=hidden name=oecrprnt value="%PATWEB92.19.015">
 <input type=hidden name=startlst value="%PATWEB92.19.016">
 <input type=hidden name=endoflst value="%PATWEB92.19.017">
<table cellpadding=1 cellspacing=1 bgcolor=#CCCCCC border=0 width=100%>
<tr><td>
<table cellpading=0 cellspacing=0 bgcolor=#CCCCCC border=0 width=100%>
  <tr>
  <td class=DataLabel><span id=HospitalID></span></td>
    <td class=DataLabel>Include Hospital Check Complete
    <input type=checkbox name=t_hospcomp title="Include Hospital Check Complete"
           value="1" onclick="InclHospComp();SelectSubmit();">
    </td>
  <td class=DataLabel>Health Fund</td>
    <td><select name=healthfn title="Health Fund"
         onchange="SelectSubmit();" class="SelectBig">
    <option value="      ">All</option>
    %PATWEB92.19.244
    </select>
    </td>
  <td class=DataLabel> Request Status </td>
   <td>
   <select name=requstat class=SelectBig onchange="SelectSubmit();">
     <option value="  ">All</option>
     <option value="99">None</option>
     <option value=" 0">Waiting</option>
     <option value=" 1">Extracted</option>
     <option value=" 2">Received</option>
     <option value=" 3">SA Error</option>
     <option value=" 4">Data Error</option>
     <option value=" 5">Rejected Reported</option>
     <option value=" 6">Complete Reported</option>
     <option value=" 7">Health Fund Unavailable</option>
   </select></td> 
   <td class=DataLabel>Date Booking Created
   </td>
   <td>
    <input type=radio checked>
   </td>
   <td>
   </td> 
   <td>
   </td>
  </tr>
<tr>
    <td class=DataLabel> Print Report
    <input type=checkbox name=t_oecrprnt title="Print Report"
           value="1" onclick="PrintBOECR();">
        <select name=selprint title="Printer">
        <option></option>
        %STANDARD.01.001.IBAPMS84.19
        </select></td>
    <td>&nbsp;</td>
    <td>Booking Type</td>
   <td class=DataField >
   <select name=filtbook onchange="SelectSubmit();"
    class=SelectBig title="Booking Type">
   <option value="   ">All</option>
    %STANDARD.01.007.BK
   </select></td>
<td class=DataLabel>Claim Type</td>
      <td><select name=claimtyp class=SelectBig
           onchange="SelectSubmit();">
           <option value="  ">All</option>
            %PATWEB92.19.237.2
          </select></td>
    <td class=DataLabel>
    Expected Admission/Theatre Date
    </td>
    <td>
    <input type=radio onclick="switchView();">
    </td>
    <td>
    <input type=button value="<<" class=SmallButton
     onclick='location.href="%PATWEB92.19.002"'>
    %PATWEB92.19.007
    <input type=button value=">>" class=SmallButton
     onclick='location.href="%PATWEB92.19.001"'>
    <a href='javascript:SelectDateFrame();'>
    <img src="../images/DateLookup.gif" class="Icon"
     alt="Select Date" align=absmiddle></a>
    <a href='javascript:SelectView("0");'>
    <img src=../images/DayIcon.gif class="Icon"
     alt="View Today" align=absmiddle></a>
    <a href='javascript:SelectView("1");'>
    <img src=../images/WeekIcon.gif class="Icon"
     alt="View This Week" align=absmiddle></a>
    </td>
    <td align=right>
        <input type=button name=requbutt class="button" value="Request"
         onclick="RequestRecordsBookingDBC();">
    </td>
</tr>
</table>
<div id=Results></div>
</td></tr>
</table>
</form>
</div>

<form name=TableForm style="margin:0"> 
<div id=TableLocation></div>
</form>

<script type="text/javascript">
function AddTableRows() {
%PATWEB92.19.019.patweb98.01.001
}
</script>

<span id=HospID style="display:none;">
<table width=100% border=0 cellspacing=0 cellpadding=0>
    <tr><td class=DataLabel >Hospital ID</td>
    <td><select name=filthosp class=SelectBig onchange=SelectSubmit()>
        <option value="   ">All</option>
        %PATWEB92.19.012
    </select>
    </td></tr>
</table>
</span>

<script type="text/javascript">
 if (document.SelectPeriod.ibcnmhos.value==1) {
     HospitalID.innerHTML = HospID.innerHTML;
 }
//
 RequestStatus="%PATWEB92.19.014";
 for (var i =0 ; i < document.SelectPeriod.requstat.length; i++) {
  if (document.SelectPeriod.requstat.options[i].value==RequestStatus) {
       document.SelectPeriod.requstat.selectedIndex=i } };
//
if (document.SelectPeriod.hospcomp.value=="1") {
  document.SelectPeriod.t_hospcomp.checked=true;
}
if (document.SelectPeriod.oecrprnt.value=="1") {
  document.SelectPeriod.t_oecrprnt.checked=true;
  document.SelectPeriod.selprint.className="Mandatory";
}
 BookingTypeFilter="%PATWEB92.19.251";
 for (var i =0 ; i < document.SelectPeriod.filtbook.length; i++) {
  if (document.SelectPeriod.filtbook.options[i].value.substr(0,3)==BookingTypeFilter) {
       document.SelectPeriod.filtbook.selectedIndex=i } };
</script>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value="">
<input type=hidden name=admissno value="">
<input type=hidden name=MenuType value="">
<input type=hidden name=formactn value="OECLS">
<input type=hidden name=repcount value=" ">
</form>
