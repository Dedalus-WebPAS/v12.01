<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
function updateParent(admision,adate,atime,aclaim,acare,acarehdp,astay,
                      admpoint,expward,asrce,aclss,atype,atypin15,pthvflag,ambs,
                      expbed,postward,postbed,adstat,intdstay,disinten,
                      diagno,peaindic,emeradm,hlthfnd,hlthftbl,hlthfnmn,
                      oecbox,presill,tsrce,adocta,aclssft,regime01,regime02,
                      regime03,pmvxrhc1,pmvxidus){

    parent.parent.AddForm.admisnum.value = admision;

    var serverURL = "../cgi-bin/comweb81.pbl?reportno=4&admissno=" +
                    admision.replace(/ /g,"+");

    var returnValue = RSExecute(serverURL);

    if (returnValue.status!=0) { 
      parent.parent.AddForm.admisnum.value="";
    } else {

//    Add code to update fields in watweb0102023.html

//    ADMISSION TYPE
      if (parent.parent.AddForm.bkrec020 != undefined) {
        for (var i=0; i < parent.parent.AddForm.bkrec020.length; i++) {
          if (parent.parent.AddForm.bkrec020.options[i].value.substr(0,3)==
              atype){
            parent.parent.AddForm.bkrec020.selectedIndex=i;
          }  
        }
      }

//    ADMISSION SOURCE
      if (parent.parent.AddForm.bokrx031 != undefined) {
        for (var i=0; i < parent.parent.AddForm.bokrx031.length; i++) {
          if (parent.parent.AddForm.bokrx031.options[i].value.substr(0,3)==
              asrce){
            parent.parent.AddForm.bokrx031.selectedIndex=i;
          }
        }
      }

//    CONSULTANT / ADMISSION DOCTOR
      if (parent.parent.AddForm.bkrec002 != undefined) {
        parent.parent.AddForm.bkrec002.value = adocta;
        UpCase(parent.parent.AddForm.bkrec002);
        parent.parent.valDoctorUnit();
      } 

//    UNIT / SPECIALTY
      if (parent.parent.AddForm.bkrec021 != undefined) {
        for (var i=0; i < parent.parent.AddForm.bkrec021.length; i++) {
          if (parent.parent.AddForm.bkrec021.options[i].value.substr(0,3)==
              aclssft){
            parent.parent.AddForm.bkrec021.selectedIndex=i;
          }
        }
      }

//    CLAIM CODE
      if (parent.parent.AddForm.bkrec023 != undefined) {
        for (var i=0; i < parent.parent.AddForm.bkrec023.length; i++) {
          if (parent.parent.AddForm.bkrec023.options[i].value.substr(0,3)==
              aclaim){
            parent.parent.AddForm.bkrec023.selectedIndex=i;
          }
        }
      }

//    CARE CLASS
      if (parent.parent.AddForm.bkrec028 != undefined) {
        for (var i=0; i < parent.parent.AddForm.bkrec028.length; i++) {
          if (parent.parent.AddForm.bkrec028.options[i].value.substr(0,3)==
              acare){
            parent.parent.AddForm.bkrec028.selectedIndex=i;
          }
        }
      }

//    REGIME 01
      if (parent.parent.AddForm.ptrgm001 != undefined &&
          !isWhitespace(regime01)) {
        parent.parent.AddForm.ptrgm001.value = regime01;
        parent.parent.validateCode(75,parent.parent.AddForm.ptrgm001,
                                      parent.parent.AddForm.t_ptrgm001);
      }

//    REGIME 02
      if (parent.parent.AddForm.ptrgm002 != undefined &&
          !isWhitespace(regime02)) {
        parent.parent.AddForm.ptrgm002.value = regime02;
        parent.parent.validateCode(75,parent.parent.AddForm.ptrgm002,
                                      parent.parent.AddForm.t_ptrgm002);
      }

//    REGIME 03
      if (parent.parent.AddForm.ptrgm003 != undefined &&
          !isWhitespace(regime03)) {
        parent.parent.AddForm.ptrgm003.value = regime03;
        parent.parent.validateCode(75,parent.parent.AddForm.ptrgm003,
                                      parent.parent.AddForm.t_ptrgm003);
      }

//    REFERRING GP
      if (parent.parent.AddForm.bkrec024 != undefined &&
          !isWhitespace(pmvxrhc1)) {
        parent.parent.AddForm.bkrec024.value = pmvxrhc1;
        UpCase(parent.parent.AddForm.bkrec024);
        parent.parent.ValidateHCP(18,0,parent.parent.AddForm.bkrec024,
                                       parent.parent.AddForm.n_bkrec024);
      }

//    SAME DAY STATUS
      if (parent.parent.AddForm.bokrx011 != undefined) {
        for (var i=0; i < parent.parent.AddForm.bokrx011.length; i++) {
          if (parent.parent.AddForm.bokrx011.options[i].value.substr(0,3)==
              pmvxidus){
            parent.parent.AddForm.bokrx011.selectedIndex=i;
          }
        }
      }

    }



    SearchFrameExit();
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<input type=hidden name=atypdesc id=atypdesc value="%STANDARD.01.017.A ">
<table cellspacing=0 colspan=4 border=1 width=100%>
<tr><td class=HeadingCell>Admission Date</td>
    <td class=HeadingCell>Status</td>
    <td class=HeadingCell>Doctor</td>
    <td class=HeadingCell>Care Type</td>
    <td class=HeadingCell>%STANDARD.01.017.CL</td>
    <td class=HeadingCell>%STANDARD.01.017.A </td></tr>
%OPRWEB02.03.004
</table>
