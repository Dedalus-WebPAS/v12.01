<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function linkPatient(Urnumber,VisitNo,VisitType,SecOpt,Casekeys,Site,AAEFlag,
                     EVNTFlag,placehld,placehld,RequestN,HospFlag,WaitFlag) {

//Emergency
  if (VisitType=="1") {
    if (AAEFlag=="0") {
      if (HospFlag=="1")
      {
        document.PatientLinks.action="emrweb02.pbl"
        document.PatientLinks.reportno.value="1"
        document.PatientLinks.template.value="017"
        document.PatientLinks.admissno.value=VisitNo
        document.PatientLinks.urnumber.value=Urnumber
        document.PatientLinks.target="content"
        document.PatientLinks.submit()
        return;
      } else
      {
        document.PatientLinks.action="emrweb02.pbl"
        document.PatientLinks.reportno.value="1"
        document.PatientLinks.template.value="022"
        document.PatientLinks.admissno.value=VisitNo
        document.PatientLinks.urnumber.value=Urnumber
        Left=(document.body.clientWidth-650)/2
        DFrameSubmit(PatientLinks,0,Left,650,400)
        return;
      }
    }
    else
    {
      document.PatientLinks.action="patweb98.pbl"
      document.PatientLinks.reportno.value="1"
      document.PatientLinks.template.value="070"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
        document.PatientLinks.target="content"
      document.PatientLinks.submit()
    }
  }
// Outpatient
  if (VisitType=="2") {
    if (document.UpdateForm.outpsite.value!=Site) {
      alert("Invalid Outpatient Site Security.")
      return;
    }
    if(HospFlag=="1")
    {
      document.PatientLinks.action="outweb02.pbl"
      document.PatientLinks.reportno.value="3"
      document.PatientLinks.template.value="020" 
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.target="content"
      document.PatientLinks.submit()
    }
    else
    {
      document.PatientLinks.action="outweb02.pbl"
      document.PatientLinks.reportno.value="3"
      document.PatientLinks.template.value="022"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.invadmno.value=VisitNo
      Left=(document.body.clientWidth-650)/2
      DFrameSubmit(PatientLinks,0,Left,650,400)
      return;
    }
  }
// Outpatient
  if (VisitType=="4") {
    if (document.UpdateForm.outpsite.value!=Site) {
      alert("Invalid Outpatient Site Security.")
      return;
    }
    document.PatientLinks.action="outweb02.pbl"
    document.PatientLinks.reportno.value="3"
    document.PatientLinks.template.value="015"
    document.PatientLinks.admissno.value=VisitNo
    document.PatientLinks.urnumber.value=Urnumber
    document.PatientLinks.target="content"
    document.PatientLinks.submit()
  }

//Inpatient
  if (VisitType=="3") {
    if(HospFlag=="1")
    {
      document.PatientLinks.action="patweb98.pbl"
      document.PatientLinks.reportno.value="1"
      document.PatientLinks.template.value="049"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.target="content"
      document.PatientLinks.submit()
    }
    else
    {
      document.PatientLinks.action="patweb98.pbl"
      document.PatientLinks.reportno.value="1"
      document.PatientLinks.template.value="191"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      Left=(document.body.clientWidth-750)/2
      DFrameSubmit(PatientLinks,0,Left,750,500)
      return;
    }
  }
//Community Health
  if (VisitType=="6") {
    alert("This is a community health visit.  Details not available");
  }
//inpatient booking
  if (VisitType=="7") {
    if(WaitFlag=="1")
    {
      if(HospFlag=="1")
      {
        document.PatientLinks.action="watweb01.pbl"
        document.PatientLinks.reportno.value="2"
        document.PatientLinks.template.value="033"
        document.PatientLinks.admissno.value=VisitNo
        document.PatientLinks.urnumber.value=Urnumber
        document.PatientLinks.casekeys.value=Casekeys
        document.PatientLinks.target="content"
        document.PatientLinks.submit()
      }
      else
      {
        document.PatientLinks.action="watweb01.pbl"
        document.PatientLinks.reportno.value="2"
        document.PatientLinks.template.value="032"
        document.PatientLinks.admissno.value=VisitNo
        document.PatientLinks.urnumber.value=Urnumber
        document.PatientLinks.casekeys.value=Casekeys
        Left=(document.body.clientWidth-650)/2
        DFrameSubmit(PatientLinks,0,Left,650,400)
        return;
      }
    }
    else
    {
      if(HospFlag=="1")
      {
        document.PatientLinks.action="patweb98.pbl"
        document.PatientLinks.reportno.value="1"
        document.PatientLinks.template.value="262"
        document.PatientLinks.admissno.value=VisitNo
        document.PatientLinks.urnumber.value=Urnumber
        document.PatientLinks.target="content"
        document.PatientLinks.submit()
      }
      else
      {
        document.PatientLinks.action="patweb98.pbl"
        document.PatientLinks.reportno.value="1"
        document.PatientLinks.template.value="263"
        document.PatientLinks.admissno.value=VisitNo
        document.PatientLinks.urnumber.value=Urnumber
        Left=(document.body.clientWidth-650)/2
        DFrameSubmit(PatientLinks,0,Left,650,400)
        return;
      }
    }
  }
//waiting list
  if (VisitType=="8") {
    if(HospFlag=="1")
    {
      document.PatientLinks.action="watweb01.pbl"
      document.PatientLinks.reportno.value="2"
      document.PatientLinks.template.value="033"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.casekeys.value=Casekeys
      document.PatientLinks.target="content"
      document.PatientLinks.submit()
    }
    else
    {
      document.PatientLinks.action="watweb01.pbl"
      document.PatientLinks.reportno.value="2"
      document.PatientLinks.template.value="032"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.casekeys.value=Casekeys
      Left=(document.body.clientWidth-650)/2
      DFrameSubmit(PatientLinks,0,Left,650,400)
      return;
    }
  }
//Events
  if (VisitType=="9") {
//Emergency
    if (EVNTFlag=="1") {
      document.PatientLinks.action="patweb81.pbl"
      document.PatientLinks.reportno.value="1"
      document.PatientLinks.template.value="11"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.hospflag.value=HospFlag
      document.PatientLinks.target="content"
      document.PatientLinks.submit()
      return;
    }
//Outpatient
    if (EVNTFlag=="2") {
      document.PatientLinks.action="patweb81.pbl"
      document.PatientLinks.reportno.value="1"
      document.PatientLinks.template.value="13"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.hospflag.value=HospFlag
      document.PatientLinks.target="content"
      document.PatientLinks.submit()
      return;
    }
//Inpatient
    if (EVNTFlag=="3") {
      document.PatientLinks.action="patweb81.pbl"
      document.PatientLinks.reportno.value="1"
      document.PatientLinks.template.value="12"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.hospflag.value=HospFlag
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.target="content"
      document.PatientLinks.submit()
      return;
    }
    if (SecOpt=="2") {
      document.PatientLinks.action="patweb81.pbl"
      document.PatientLinks.reportno.value="1"
      document.PatientLinks.template.value="1"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.target="content"
      document.PatientLinks.submit()
    }
    if (SecOpt=="0") {
      if(HospFlag=="1")
      {
        document.PatientLinks.action="allweb02.pbl"
        document.PatientLinks.reportno.value="02"
        document.PatientLinks.template.value="014"
        document.PatientLinks.admissno.value=VisitNo
        document.PatientLinks.urnumber.value=Urnumber
        document.PatientLinks.target="content"
        document.PatientLinks.submit()
      }
      else
      {
        document.PatientLinks.action="allweb02.pbl"
        document.PatientLinks.reportno.value="02"
        document.PatientLinks.template.value="032"
        document.PatientLinks.admissno.value=VisitNo
        document.PatientLinks.urnumber.value=Urnumber
        Left=(document.body.clientWidth-650)/2
        DFrameSubmit(PatientLinks,0,Left,650,450)
        return;
      }
    }
    if (SecOpt!="0" && SecOpt!="2") {
      alert("Screen is not viewable by all departments")
    }
  }
//Referral
  if (VisitType=="10") {
    if(HospFlag=="1")
    {
      document.PatientLinks.action="allweb02.pbl"
      document.PatientLinks.reportno.value="02"
      document.PatientLinks.template.value="014"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.target="content"
      document.PatientLinks.submit()
    }
    else
    {
      document.PatientLinks.action="allweb02.pbl"
      document.PatientLinks.reportno.value="02"
      document.PatientLinks.template.value="032"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      Left=(document.body.clientWidth-600)/2
      DFrameSubmit(PatientLinks,0,Left,650,400)
      return;
    }
  }
}
function ShowVisits() {
  document.UpdateForm.submit();
}
function ResetSearch() {
  serverURL   = "../cgi-bin/patweb98.pbl?reportno=01&template=261" +
                "&filtvtyp=" + UpdateForm.filtvtyp.value +
                "&norecord=" + UpdateForm.norecord.value +
                "&admissno=" + UpdateForm.admissno.value.replace(/ /g,"+") +
                "&urnumber=" + UpdateForm.urnumber.value.replace(/ /g,"+") +
                "&nocanvis=" + UpdateForm.nocanvis.value.replace(/ /g,"+") 
  location.href=serverURL
}
function DispMapping() {
  LinkUrl="patweb92.pbl?reportno=4&template=3"
  Left=(((document.body.clientWidth-400)/2)+ document.body.scrollLeft)
  DFrameLink(LinkUrl,0,Left,400,250)
}
</script>
</head>
%START.OF.PAGE
<body style="overflow:hidden;" onload="PageLoad(event);">
<div id=HeadingSection></div>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB98.01.003";
PatientVIS="%PATWEB98.01.081";
PatientNAM="%PATWEB98.01.002";
PatientSTA="%PATWEB98.01.086.078";
PatientALT="%PATWEB98.01.084";
PatientSEX="%PATWEB98.01.019";
PatientDOB="%PATWEB98.01.020";
PatientAGE="%PATWEB98.01.021";
PatientLOC="%PATWEB98.01.083";
PatientPRI="%PATWEB98.01.086.066.1";
PatientUNT="%PATWEB98.01.066.0";
DoctorCOD="%PATWEB98.01.082.003";
DoctorNAM="%PATWEB98.01.082.002";
PatientAID="%PATWEB98.01.086.090";
PatientIND="%PATWEB98.01.086.091";
PatientCUR="%PATWEB98.01.086.092";
PatientCLC="%PATWEB98.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB98.01.086.094";
PatientCDM="%PATWEB98.01.086.095";
PatientVDH="%PATWEB98.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<form name=UpdateForm action=patweb98.pbl style="margin:0;">
 <input type=hidden name=reportno value="1">
 <input type=hidden name=template value="261">
 <input type=hidden name=urnumber value="%PATWEB98.01.003">
 <input type=hidden name=admissno value="%PATWEB98.01.081">
 <input type=hidden name=norecord value="10">
 <input type=hidden name=outpsite value="%STANDARD.01.023">
 <input type=hidden name=nocanvis value="%PATWEB98.01.886">
 <input type=hidden name=ptcnhdps value="%STANDARD.01.025.080.250.1.1">
 <table cellspacing=0 cellpadding=2 border=1 width=100%>
  <tr><td align=right class=HeadingCell colspan=9>Visit Type
          <select class=PMenuSelectList name=filtvtyp id=filtvtyp
                  onchange='ShowVisits();'>
           <option></option>
           <option value="1">All (excluding bookings)</option>
           <option value="2">Inpatient</option>
           <option value="3">Outpatient</option>
           <option value="4">Emergency</option>
           <option value="5">Bookings (Inpatient)</option>
           <option value="6">Referrals</option>
           <option value="7">Events</option>
           <option value="8">Waiting Lists</option>
           <option value="9">Cancelled Admissions</option>
           <option value="12">All Cancelled Events</option>
           <option value="10">All Site Outpatient Bookings</option>
         </select></td>
      <td class="HeadingCell" align="right">Legend
          <img src="../images/Help16.gif" border="0" hspace=4 align=absmiddle
               onClick="DispMapping();" /></td></tr>

  <tr><td class=HeadingCell width=25%>Admission/Visit Date</td>
      <td class=HeadingCell width=5%>Day</td>
      <td class=HeadingCell width=5%>Type</td>
      <td class=HeadingCell width=5%>Unit</td>
      <td class=HeadingCell width=15%>HCP</td>
      <td class=HeadingCell width=10%>Location</td>
      <td class=HeadingCell width=5%>Ins Class</td>
      <td class=HeadingCell width=15%>Status</td>
      <td class=HeadingCell width=10%>Visit No</td>
      <td class=HeadingCell width=5%>Med Rec</td></tr>

%PATWEB98.01.327.0.0.0.0.0.0.1

  <tr bgcolor=#CCCCCC><td align=center colspan=10>
          <input type=button value="Previous" class="button"
                 onClick='checkNoCanVis("%PATWEB98.01.328.261");'>
          <input type=button value="Start" class="button"
                 onClick="ResetSearch();">
          <input type=button value="Next" class="button"
                 onclick='checkNoCanVis("%PATWEB98.01.329.261");'></td></tr>
 </table>
</form>

<form name=PatientLinks method=post>
 <input type=hidden name=reportno value=1>
 <input type=hidden name=template value=004>
 <input type=hidden name=urnumber value="%PATWEB98.01.003">
 <input type=hidden name=admissno value="%PATWEB98.01.081">
 <input type=hidden name=casekeys value="">
 <input type=hidden name=MenuType value="%PATWEB98.01.088">
 <input type=hidden name=hospflag value="">
 <input type=hidden name=invadmno value="">
 <input type=hidden name=requestn value="">
</form>

<script type="text/javascript">
//
 FilterVis="%PATWEB98.01.330";
 for (var i =0 ; i < document.UpdateForm.filtvtyp.length; i++) {
  if (document.UpdateForm.filtvtyp.options[i].value==trim(FilterVis)) {
    document.UpdateForm.filtvtyp.selectedIndex=i } };
//
function checkNoCanVis(locstring) {
  location.href=locstring +
                "&nocanvis=" +
                document.UpdateForm.nocanvis.value.replace(/ /g,"+");
}
  if(document.UpdateForm.ptcnhdps.value=="6")
  {
    var sel = document.UpdateForm.filtvtyp;
    for (var i = 0; i < sel.length; i++) 
    {
      if(sel.options[i].value=="12")
      {
        sel.remove(i);
      }  
    } 
  }
</script>
