<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>

<script type="text/javascript">

function init() {
  if (document.ReportForm.ibcnmhos.value==1) {
     document.getElementById('HospitalIDHeading').innerHTML=document.getElementById('HospIDHeading').innerHTML;
     document.getElementById('HospitalID').innerHTML=document.getElementById('HospID').innerHTML;
     getPRS2Details(ReportForm.keyhosp,ReportForm.dummy,ReportForm.dummy,ReportForm.dummy,ReportForm.fromdat);
  }
  else {
     document.getElementById('HospitalID').innerHTML="";
     document.getElementById('HospitalIDHeading').innerHTML="";
  }
}

function ProcessReport(){

  document.ReportForm.fromdat.title = "From Date";
  document.ReportForm.ttodate.title = "To Date";
  mthnam1 = document.ReportForm.fromdat.value.substr(3,3);
  mthnam2 = document.ReportForm.ttodate.value.substr(3,3);

  if(mthnam1!=mthnam2){
     if(!confirm("Warning: PHISCo Extract not closed on end of month")){
        return;
     }
  }

  if(CheckDateRange(document.ReportForm.fromdat,document.ReportForm.ttodate)){
   if (document.ReportForm.ibcnmhos.value==1) {
     document.ReportForm.keystr02.value=document.ReportForm.keyhosp.value;
     document.ReportForm.keystr03.value=SetDateDDMMYYYY(document.ReportForm.ttodate.value);
     document.ReportForm.keystr04.value=document.ReportForm.extrname.value;
     document.ReportForm.keystr05.value=document.ReportForm.extrtype.value;
     document.ReportForm.keystr06.value="Y";
     document.ReportForm.keystr07.value="Y";
     document.ReportForm.keystr08.value="Y";
     document.ReportForm.keystr09.value="Y";
   } else {
     document.ReportForm.keystr02.value=SetDateDDMMYYYY(document.ReportForm.ttodate.value);
     document.ReportForm.keystr03.value=document.ReportForm.extrname.value;
     document.ReportForm.keystr04.value=document.ReportForm.extrtype.value;
     document.ReportForm.keystr05.value="Y";
     document.ReportForm.keystr06.value="Y";
     document.ReportForm.keystr07.value="Y";
     document.ReportForm.keystr08.value="Y";
   }
   SubmitReport(document.ReportForm);
  }
}
function checkHosp(){
 p=document.ReportForm
 getPRS2Details(p.keyhosp,p.dummy,p.dummy,p.dummy,p.fromdat);
}

</script>
</head>

%START.OF.PAGE
<body onload="PageLoad(event);ReportLoad();document.ReportForm.schddate.focus();">
  <form name=ReportForm method=post action=rshweb02.pbl style="margin:0">
  <input type=hidden name=reportno value=4>
  <input type=hidden name=template value=001>
  <input type=hidden name=updttype value="A">
  <input type=hidden name=setdfprg value="IBABIL50">
  <input type=hidden name=setdfrep value="01">
  <input type=hidden name=schdpgid value="IBABIL50">
  <input type=hidden name=schddesc value="Process New Run For NSW PHISCo Extract">
  <input type=hidden name=nextpage value="1">
  <input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=1">
  <input type=hidden name=ibcnmhos value="%RSHWEB02.01.118.000.043.1.1">
  <input type=hidden name=keystr01 value="1">
  <input type=hidden name=keystr02>
  <input type=hidden name=keystr03>
  <input type=hidden name=keystr04>
  <input type=hidden name=keystr05>
  <input type=hidden name=keystr06>
  <input type=hidden name=keystr07>
  <input type=hidden name=keystr08>
  <input type=hidden name=keystr09>
  <input type=hidden name=dummy value="">

  <table width=100% align=center border=0 cellspacing=0>
  <tr>
    <td class=HeadingCell align=center colspan=2>
      Process New Run For NSW PHISCo Extract
    </td>
  </tr>
  <tr>
    <td>
      <table width=80% align=center border=0 cellspacing=2 cellpadding=1>
        <tr>
          <td class=DataLabel width=25%>Schedule Date</td>
          <td class=DataLabel>
            <input type=text name=schddate size=12 title="Schedule Date"
              value="%STANDARD.01.015"
              onblur="checkDate(this,'Schedule Date');">
            <img notab src="../images/DateLookup.gif" class="Icon"
              alt="Show Calendar" date="ReportForm.schddate">
            Time
            <input type=text name=schdtime size=12 title="Schedule Time"
              value="%STANDARD.01.016">
            <img notab src="../images/DateTimeStamp.gif" alt="Current" 
             class="Icon" date="ReportForm.schddate" time="ReportForm.schdtime">
            <img notab src="../images/TimeLookup.gif" class="Icon"
              alt="Time Select" time="ReportForm.schdtime">
          </td>
        </tr>
        <tr>
          <td class=DataLabel>Printer</td>
          <td>
            <select name=schdprnt title="Printer" class=Mandatory>
              <option></option>
              %STANDARD.01.001.IBABIL50.01
            </select>
          </td>
        </tr>
        <tr>
          <td class=DataLabel>Number of Copies</td>
          <td>
            <select name=schdcopy title='Number of Copies' class=Mandatory>
            </select>
          </td>
        </tr>
        <tr>
          <td class=DataLabel>Re-schedule Type</td>
          <td class=DataLabel colspan=3>
            <select name=schdrdat title="Schedule Type" 
             onchange="SetReportDates();">
              <option></option>
            </select>
          </td>
        </tr>
        <tr>
          <td class=DataLabel>Re-schedule Until Date</td>
          <td class=DataLabel colspan=3>
            <input type=text name=schdrend size=12
              onblur="checkDate(this,'Re-schedule Until Date');">
            <img notab src="../images/DateTimeStamp.gif" class="Icon"
              alt="Current" date="ReportForm.schdrend">
            <img notab src="../images/DateLookup.gif" class="Icon"
              alt="Show Calendar" date="ReportForm.schdrend">
          </td>
        </tr>
        <tr>
          <td colspan=2 align=center>
            <hr width=80%>
          </td>
        </tr>
        <tr><td> <span id=HospitalIDHeading></span></td>
            <td><span id=HospitalID></span>
        </td></tr>
        <tr>
          <td class=DataLabel width=25%>Date Range</td>
          <td>
            <input type=text size=15 maxlength=12 name=fromdat 
              value="%RSHWEB02.01.121">
            To
            <input type=text size=15 maxlength=12 name=ttodate title="End Date"
              onblur="checkDate(this,'Date')" class="Mandatory PastDate">
            <img src="../images/DateTimeStamp.gif"  class="Icon"
              alt="Current" date="ReportForm.ttodate">
            <img src="../images/DateLookup.gif" class="Icon"
              alt="Calendar" date="ReportForm.ttodate">
          </td>
        </tr>
        <tr>
          <td class=DataLabel>Extract Filename</td>
          <td>
            <input name=extrname type=text size=8 maxlength=8 class=Mandatory
             title="Extract Filename">
          </td>
        </tr>
          <tr>
            <td class=DataLabel width=25%>Extract Type</td>
            <td>
              <select name=extrtype class=Mandatory  title="Type">
                <option value=1>All Patients</option>
                <option value=2>Public Patients</option>
                <option value=3>Private Patients</option>
              </select>
            </td>
          </tr>
      </table>
      <table width=80% align=center border=0 cellspacing=0>
        <tr>
          <td align=center colspan=2>
            <br>
            <input type=button value="Ok" class="button" 
              onclick="ProcessReport();">
            <input type=button value="Cancel" class="button"
              onclick='location.href="../lookups/blank.html"'>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  </table>
  </form>
<span id=HospIDHeading style="display:none;">
    <tr><td class=DataLabel>Hospital ID</td>
</span>
<span id=HospID style="display:none;">
    <td><select name=keyhosp title="Hospital ID" class=Mandatory
         onchange='checkHosp();'>
    <option ></option>
    %RSHWEB02.01.122
    </select>
    </td>
</span>
