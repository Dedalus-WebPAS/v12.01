<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function checkMaxPat() {
  var serverURL="../cgi-bin/patweb96.pbl?reportno=12&remoteno=7" +
                "&wardcode="+UpdateForm.bkrec015.value.replace(/ /g,"+") +
                "&admisdte="+UpdateForm.bkrec004.value.replace(/ /g,"+");
  
  var returnValue=RSExecute(serverURL);
  if (returnValue.status==0) {
    if (returnValue.return_value==1) {
      alert("Warning: Maximum number of Patients exceeded.");
    }               
  }                 
  
  return;
} 
function checkBedManagement() {
  if(!validateMandatory(document.UpdateForm)) {
    return;
  }
  admissno=PatientLinks.admissno.value.replace(/ /g,"+")
  prnxindi="0";

  if (isWhitespace(document.UpdateForm.bkrec015.value)) {
    document.UpdateForm.submit();
    return;
  }

  if (isWhitespace(document.UpdateForm.bkrec018.value)) {
    document.UpdateForm.submit();
    return;
  }

  var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=6" +
                  "&wardcode="+UpdateForm.bkrec015.value.replace(/ /g,"+") +
                  "&beddcode="+UpdateForm.bkrec018.value.replace(/ /g,"+") +
                  "&admisdte="+UpdateForm.bkrec004.value.replace(/ /g,"+") +
                  "&admistme="+UpdateForm.bkrec005.value.replace(/ /g,"+")

  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    if (returnValue.return_value==1) {
      alert("Selected Bed is closed during this date/time.");
      return;
    }
  }

  if (UpdateForm.pswdindc.value==0) {
    var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=5" +
                    "&wardcode="+UpdateForm.bkrec015.value.replace(/ /g,"+") +
                    "&beddcode="+UpdateForm.bkrec018.value.replace(/ /g,"+") +
                    "&admissno="+admissno.replace(/ /g,"+") +
                    "&admisdte="+UpdateForm.bkrec004.value.replace(/ /g,"+") +
//                    "&staydays="+UpdateForm.bkrec033.value.replace(/ /g,"+") +
                    "&admistme="+UpdateForm.bkrec005.value.replace(/ /g,"+") +
                    "&ptrgm001="+UpdateForm.ptrgm001.value.replace(/ /g,"+") +
                    "&ptrgm002="+UpdateForm.ptrgm002.value.replace(/ /g,"+") +
                    "&ptrgm003="+UpdateForm.ptrgm003.value.replace(/ /g,"+") +
                    "&prnxindi="+prnxindi.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      if (returnValue.return_value==1) {
        if (!confirm("Warning: Another patient booked at this time. Do you want to override?")) {
          return;
        }
      }
      prevretval=returnValue.return_value;
      prnxindi="1";
      var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=5" +
                      "&wardcode="+UpdateForm.bkrec015.value.replace(/ /g,"+") +
                      "&beddcode="+UpdateForm.bkrec018.value.replace(/ /g,"+") +
                      "&admissno="+admissno.replace(/ /g,"+") +
                      "&admisdte="+UpdateForm.bkrec004.value.replace(/ /g,"+") +
//                      "&staydays="+UpdateForm.bkrec033.value.replace(/ /g,"+")
 +
                      "&admistme="+UpdateForm.bkrec005.value.replace(/ /g,"+") +
                      "&ptrgm001="+UpdateForm.ptrgm001.value.replace(/ /g,"+") +
                      "&ptrgm002="+UpdateForm.ptrgm002.value.replace(/ /g,"+") +
                      "&ptrgm003="+UpdateForm.ptrgm003.value.replace(/ /g,"+") +
                      "&prnxindi="+prnxindi.replace(/ /g,"+")
      var returnValue = RSExecute(serverURL);
      if (returnValue.status==0) {
        if (returnValue.return_value==1) {
          if (!confirm("Warning: Another patient booked at this time. Do you want to override?")) {
            return;
          }
        }

        if (prevretval==1 || returnValue.return_value==1) {
          UpdateForm.pswdindc.value="1";
          PasswordHead.innerHTML=passwordhd.innerHTML;
          PasswordCode.innerHTML=passwordcd.innerHTML;
          UserNameHead.innerHTML=usernamehd.innerHTML;
          UserNameCode.innerHTML=usernamcd.innerHTML;
          return;
        }
        checkMaxPat();
        PostData();
      }
    }
  } else {
    checkMaxPat();
    PostData();
  }
}
function init(){
  for (var i =0 ; i < document.UpdateForm.bkrec015.length; i++) {
    if (trim(document.UpdateForm.exptward.value) ==
        trim(document.UpdateForm.bkrec015.options[i].value.substr(0,3))){
          document.UpdateForm.bkrec015.selectedIndex = i;
    }
  }
 if (document.UpdateForm.ibcnmhos.value == "1")
    UpdateForm.bkrec015.className = "Mandatory";
  selectOptions2('43',UpdateForm.bkrec015,UpdateForm.bkrec018);
}
function PostData()
{
UpdateForm.submit();
}
</script>
</head>
%START.OF.PAGE
<body onload=PageLoad(event);>
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Update Expected Bed
</span>
<form name=LinkForm action=oprweb01.pbl method=get target=content style="margin:0">
<input type=hidden name=reportno value=9>
<input type=hidden name=template value=2>
<input type=hidden name=urnumber value="%OPRWEB01.07.003">
<input type=hidden name=sesskeys value="">
</form>

<form name=UpdateForm action=oprweb01.pbl method=post
 onsubmit="return validateMandatory(this);" style="margin:0">
<input type=hidden name=reportno value=7>
<input type=hidden name=template value=1>
<input type=hidden name=setbookf value=1>
<input type=hidden name=updttype value=U>
<input type=hidden name=urnumber value="%OPRWEB01.07.003">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=claimc>
<input type=hidden name=exptward value="%OPRWEB01.07.119">
<input type=hidden name=admissno value="%OPRWEB01.07.081">
<input type=hidden name=redirect value="%OPRWEB01.07.001.patweb98.01.001">
<input type=hidden name=ptcnbman value="%STANDARD.01.025.112.107.0.1">
<input type=hidden name=pswdindc value="0">
<input type="hidden" name="bktype"   value="%OPRWEB01.07.111.3" />
<input type=hidden name=ptrgm001 value="%OPRWEB01.07.309. 1">
<input type=hidden name=ptrgm002 value="%OPRWEB01.07.309. 2">
<input type=hidden name=ptrgm003 value="%OPRWEB01.07.309. 3">

<input type=hidden name=bkrec008 value="%OPRWEB01.07.111.3">
<input type=hidden name=bkrec004 value="%OPRWEB01.07.106">
<input type=hidden name=bkrec005 value="%OPRWEB01.07.107">
<input type=hidden name=bkrec033 value="%OPRWEB01.07.130">
<input type=hidden name=bkrec002 value="%OPRWEB01.07.104.003">
<input type=hidden name=bkrec021 value="%OPRWEB01.07.125.0">
<input type=hidden name=bkrec003 value="%OPRWEB01.07.105.003">
<input type=hidden name=bkrec019 value="%OPRWEB01.07.123.0">
<input type=hidden name=bkrec023 value="%OPRWEB01.07.127.0">
<input type=hidden name=bokrx003 value="%OPRWEB01.07.203.0">
<input type=hidden name=bkrec038 value="%OPRWEB01.07.134">

<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class=DataLabel style="text-align:center">Expected Ward</td>
    <td class=DataField><input type=hidden name=bedstat1>
                        <input type=hidden name=warddesc>
    <select name=bkrec015 class=Mandatory title=Ward
    onchange="selectOptions2('43',UpdateForm.bkrec015,UpdateForm.bkrec018);">
    <option></option>
     %OPRWEB01.07.202.2
    </select>
    <select name=bkrec018 maxlength=3 title="Bed"
     value="%OPRWEB01.07.122" class=Mandatory>
    <option></option>
    </select>

    <img notab src=../images/SearchIcon.gif class=Icon 
     onclick="WardBedSearchFrame(bkrec015,warddesc,bkrec018,bedstat1);">
    </td>
</tr>

<tr><td>&nbsp;</td><td>&nbsp;</td></tr>

<tr>
  <td class=DataLabel style="text-align:center">
    <div id="UserNameHead"></div>
  </td>
  <td class=DataField><div id="UserNameCode"></div></td>
</tr>

<tr>
  <td class=DataLabel style="text-align:center">
    <div id="PasswordHead"></div>
  </td>
  <td class=DataField><div id="PasswordCode"></div></td>
</tr>

<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td colspan=10 align=center> 
    <input type=button id="opr01web" 
     onclick="tempDisable(this);checkBedManagement();"
     value=Ok class="button">
    <input type=button value=Cancel class="button" onclick="history.go(-2);">
    </td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OPRWEB01.07.003">
<input type=hidden name=admissno value="%OPRWEB01.07.081">
<input type=hidden name=MenuType value="%OPRWEB01.07.088">
</form>

<span class=DataLabel id=usernamehd style="display:none">
User Name
</span>

<span id=usernamcd style="display:none">
<input size=12 type=text name=username class=Mandatory title="User Name">
</span>

<span class=DataLabel id=passwordhd style="display:none">
Password
</span>

<span id=passwordcd style="display:none">
<input size=12 type=password name=password onblur="checkPass();" class=Mandatory
     title="Password" id=password>
</span>
