<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName"    content="NoContextSet.html">
<script type="text/javascript" src="../js/json-viewer.js"></script>
<link rel="stylesheet" href="../html/json-viewer.css" type="text/css">
</head>
<style>
#IHCWJSONHEAD {
  position: absolute;
  z-index: 9;
  background-color: #f1f1f1;
  border: 1px solid #d3d3d3;
  text-align: center;
}

#IHCWJSONDRAG {
  padding: 10px;
  cursor: move;
  z-index: 10;
  background-color: #2196F3;
  color: #fff;
}
</style>
<script type="text/javascript">
function linkInvoice(Invoice,Visittyp,URNumber) {
  document.ShowInvoice.invoicen.value=Invoice;
  document.ShowInvoice.visittyp.value=Visittyp;
  document.ShowInvoice.urnumber.value=URNumber;
  document.ShowInvoice.submit();
}
function getEclipseClaimCookie() {
  document.MiscVars.eclipath.value=GetCookieData('EclipseClaimPath');
  ExpireCookiePath('EclipseClaimPath');
  if (document.MiscVars.eclipath.value=="unknown") {
    document.MiscVars.eclipath.value="eclweb24.pbl?reportno=6&template=1" +
                                     "&viewtype=0&exdtblnk=1&invnumbr=" +
                             document.MiscVars.mavinvce.value.replace(/ /g,"+");
  } else {
     if(document.MiscVars.eclipath.value.search("&invnumbr=&")!=-1 ||
        document.MiscVars.eclipath.value.search("&invnumbr=") == -1) {
        return; // No invoice in url so return to cookie url
     }
     if(document.MiscVars.eclipath.value.substr(
        document.MiscVars.eclipath.value.search("&invnumbr=")+10,8) !=
        document.MiscVars.mavinvce.value.replace(/ /g,"+")) {
      if (document.MiscVars.eclipath.value.search("&template=4") == -1) {
      document.MiscVars.eclipath.value="eclweb24.pbl?reportno=6&template=1" +
                                       "&viewtype=0&exdtblnk=1&invnumbr=" +
                             document.MiscVars.mavinvce.value.replace(/ /g,"+");
      }
    }
  }
}
function setEclipseClaimCookie() {
  document.cookie = "EclipseClaimPath=" + document.MiscVars.eclipath.value  + ";"
}
function ProcReportPopupFrame() {
  DFrameStart()

  linkurl="../cgi-bin/eclweb24.pbl?reportno=5&template=003"+
          "&mavbatch="+document.MiscVars.mavbatch.value+
          "&mavinvce="+document.MiscVars.mavinvce.value+
          "&urnumber="+document.PatientLinks.urnumber.value+
          "&admissno="+document.PatientLinks.admissno.value;
  Left=(document.body.clientWidth-1300)/2
  DFrameLink(linkurl,0,Left,1300,700)
}
function EDIHistoryPopupFrame() {
  DFrameStart()

  linkurl="../cgi-bin/eclweb24.pbl?reportno=5&template=002"+
          "&mavbatch="+document.MiscVars.mavbatch.value.replace(/ /g,"+") +
          "&mavinvce="+document.MiscVars.mavinvce.value.replace(/ /g,"+") +
          "&urnumber="+document.PatientLinks.urnumber.value.replace(/ /g,"+") +
          "&admissno="+document.PatientLinks.admissno.value.replace(/ /g,"+");
  Left=(document.body.clientWidth-1000)/2
  DFrameLink(linkurl,100,Left,975,400)
}
function displayExType() {
    if (document.MiscVars.ecextype.value=="0") {
      HFCCDiv.innerHTML = HealthFundSpan.innerHTML;
    } else {
      HFCCDiv.innerHTML = ClaimCodeSpan.innerHTML;
    } 
}
function JSONPopupFrame() {
  DFrameStart()

  linkurl="../cgi-bin/eclweb24.pbl?reportno=5&template=009"+
          "&mavbatch="+document.MiscVars.mavbatch.value+
          "&mavinvce="+document.MiscVars.mavinvce.value+
          "&urnumber="+document.PatientLinks.urnumber.value+
          "&admissno="+document.PatientLinks.admissno.value;
  Left=(document.body.clientWidth-1300)/2
  DFrameLink(linkurl,0,Left,1300,1000)
}
function dragElement(elmnt) {
  var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
  if (document.getElementById(elmnt.id + "DRAG")) {
    // if present, the header is where you move the DIV from:
    document.getElementById(elmnt.id + "DRAG").onmousedown = dragMouseDown;
  } else {
    // otherwise, move the DIV from anywhere inside the DIV:
    elmnt.onmousedown = dragMouseDown;
  }

  function dragMouseDown(e) {
    e = e || window.event;
    e.preventDefault();
    // get the mouse cursor position at startup:
    pos3 = e.clientX;
    pos4 = e.clientY;
    document.onmouseup = closeDragElement;
    // call a function whenever the cursor moves:
    document.onmousemove = elementDrag;
  }

  function elementDrag(e) {
    e = e || window.event;
    e.preventDefault();
    // calculate the new cursor position:
    pos1 = pos3 - e.clientX;
    pos2 = pos4 - e.clientY;
    pos3 = e.clientX;
    pos4 = e.clientY;
    // set the element's new position:
    elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
    elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
  }

  function closeDragElement() {
    // stop moving when mouse button is released:
    document.onmouseup = null;
    document.onmousemove = null;
  }
}
function ClaimViewer() {

  if((window.navigator.appName == "Microsoft Internet Explorer" &&
       (document.documentMode || document.compatMode))) {
    alert("Claim Viewer only works with compatibility view off. Please use JSON Details.");
    return;
  }

  if (isWhitespace(document.getElementById("rtvwjson").value)) {
    alert("Claim not available.");
    return;
  }

//  if (document.getElementById("rtvwjson").value.search("Can't")
//      != -1) {
//    alert("Claim not available.");
//    return;
//  } 

  try {  
    var json = JSON.parse(document.getElementById("rtvwjson").value);  
  } catch (e) {  
    alert("Claim JSON not viewable. \n" + e);
    return;
  }

  if (IHCWJSON.innerHTML != "" ) {IHCWJSON.innerHTML = ""; return;}
  
  var jsonViewer = new JSONViewer();

  document.querySelector("#IHCWJSON").appendChild(jsonViewer.getContainer());

  jsonViewer.showJSON(JSON.parse(document.getElementById("rtvwjson").value),
                                -1,2);


}
</script>
%START.OF.PAGE
<body onload="PageLoad(event);displayExType();getEclipseClaimCookie();"
      onunload="setEclipseClaimCookie();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%ECLWEB24.05.003";
PatientVIS="%ECLWEB24.05.081";
PatientNAM="%ECLWEB24.05.002";
PatientSTA="%ECLWEB24.05.086.078";
PatientALT="%ECLWEB24.05.084";
PatientSEX="%ECLWEB24.05.019";
PatientDOB="%ECLWEB24.05.020";
PatientAGE="%ECLWEB24.05.021";
PatientLOC="%ECLWEB24.05.083";
PatientPRI="%ECLWEB24.05.086.066.1";
PatientUNT="%ECLWEB24.05.066.0";
DoctorCOD="%ECLWEB24.05.082.003";
DoctorNAM="%ECLWEB24.05.082.002";
PatientAID="%ECLWEB24.05.086.090";
PatientIND="%ECLWEB24.05.086.091";
PatientCUR="%ECLWEB24.05.086.092";
PatientCLC="%ECLWEB24.05.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%ECLWEB24.05.086.094";
PatientCDM="%ECLWEB24.05.086.095";
PatientVDH="%ECLWEB24.05.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=IHCWJSONHEAD style="background-color: lightblue;">
<table border="0" colspan=0 cellspacing="0" cellpadding="0" >
<tr><td>
<div id=IHCWJSON></div>
</tr></td>
</table>

</div>
<div id=PageBodySection>
<table border=0 width=100% cellspacing="0" cellpadding="1">
<tr><td class=HeadingCell align=center>WebServices IHCW Claim Details
    for %ECLWEB24.05.102 at %ECLWEB24.05.103 </td>
</tr>
</table>
<table border=0 width=95% align=center cellspacing="0" cellpadding="1">
    <tr><td class="DataLabel">Status</td>
        <td class="DataField">%ECLWEB24.05.202</td>
        <td class="DataLabel"></td>
        <td class="DataField"></td>
    </tr>
    <tr><td class="DataLabel"><div id="HFCCDiv"></div></td>
        <td class="DataField">%ECLWEB24.05.206.0</td>
        <td class="DataLabel">Amount Claimed</td>
        <td class="DataField">%ECLWEB24.05.213</td>
    </tr>
    <tr><td class="DataLabel">Invoice Number</td>
        <td class="DataField">%ECLWEB24.05.207</td>
        <td class="DataLabel" colspan=2><hr></td>
    </tr>
    <tr><td class="DataLabel">Batch Number</td>
        <td class="DataField">%ECLWEB24.05.208</td>
        <td class="DataLabel">Invoice Total</td>
        <td class="DataField">%ECLWEB24.05.214</td>
    </tr>
    <tr><td class="DataLabel">Previous Batch Number</td>
        <td class="DataField">%ECLWEB24.05.209</td>
        <td class="DataLabel">Amount Paid by Patient</td>
        <td class="DataField">%ECLWEB24.05.215</td>
    </tr>
    <tr><td class="DataLabel">Next Batch Number</td>
        <td class="DataField">%ECLWEB24.05.210</td>
        <td class="DataLabel">Amount Paid by Health Fund</td>
        <td class="DataField">%ECLWEB24.05.216</td>
    </tr>
    <tr><td class="DataLabel">Contiguous Claim Flag</td>
        <td class="DataField">%ECLWEB24.05.203</td>
        <td class="DataLabel">Other Amount</td>
        <td class="DataField">%ECLWEB24.05.217</td>
    </tr>
    <tr><td class="DataLabel">Claim Transaction ID</td>
        <td class="DataField">%ECLWEB24.05.211</td>
        <td class="DataLabel">Journal Amount</td>
        <td class="DataField">%ECLWEB24.05.218</td>
    </tr>
    <tr><td class="DataLabel">Fund Transaction ID</td>
        <td class="DataField">%ECLWEB24.05.212</td>
        <td class="DataLabel">Credt Note Amount</td>
        <td class="DataField">%ECLWEB24.05.226</td>
    </tr>
    <tr><td class="DataLabel">&nbsp;</td>
        <td class="DataField">&nbsp;</td>
        <td class="DataLabel">Amount Outstanding</td>
        <td class="DataField">%ECLWEB24.05.201</td>
    </tr>
    <tr><td class="DataLabel" colspan=4><hr></td>
    </tr>
</table>
<table border=0 width=95% align=center cellspacing="0" cellpadding="1">
    <tr>
        <td><div id="PaymentDetailsDiv"></div></td>
        <td></td>
    </tr>
</table>
<table border="0" colspan=0 width="95%" cellspacing="0" cellpadding="0" >
    <tr align="center">
      <td align="center">
         <input type="button" value="Assessment Rep" class="button"
                onclick="ProcReportPopupFrame()">
         <input type="button" value="EDI History" class="button"
                onclick="EDIHistoryPopupFrame();">
      </td>
    </tr>
    <tr>
      <td align="center">
         <input type="button" value="Back to Enquiries" class="button"
                onclick="location.href=document.MiscVars.eclipath.value;">
         <input type="button" value="Invoice" class="button"
                onclick="linkInvoice('%ECLWEB24.05.207','3','%ECLWEB24.05.003');">
      </td>
    </tr>
      <tr>
        <td align="center">
           <input type="button" value="JSON Details" class="Largebutton"
                  onclick="JSONPopupFrame()">
        </td>
      </tr>
      <tr>
        <td align="center">
         <input type="button" value="Close Eclipse Claim" class="Largebutton"
          id="closebut"
                onclick="if (confirm('Confirm Eclipse Claim Close?'))
                {tempDisable(this);CloseEclipseClaim.submit();}">
        </td>
      </tr>
    <tr>
      <td align="center">
         <input type="button" value="Eclipse Adjustment" class="Largebutton"
                id="ihcadjbt"
                onclick="SetCookie('WBSAdjustCookie','%ECLWEB24.05.211');
                         SetCookie('WBSAdjustCookieIN','%ECLWEB24.05.207');
                         SetCookie('WBSAdjustCookieBN','%ECLWEB24.05.208');
                linkInvoice('%ECLWEB24.05.207','3','%ECLWEB24.05.003');">
      </td>
    </tr>
    <tr>
      <td align="center">
         <input type="button" value="Claim Viewer" class="Largebutton"
                onclick="ClaimViewer()">
      </td>
    </tr>
    <tr><td>
        <textarea hidden name=rtvwjson rows=0 cols=0 readonly
         id=rtvwjson
         class="ReadOnly">%ECLWEB24.05.242</textarea>
        </td>
    </tr>
</table>

</div>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%ECLWEB24.05.003">
<input type=hidden name=admissno value="%ECLWEB24.05.081">
<input type=hidden name=MenuType value="%ECLWEB24.05.088">
</form>

<form name=MiscVars>
<input type=hidden name=ecextype value="%ECLWEB24.05.205">
<input type=hidden name=paymdate value="%ECLWEB24.05.204">
<input type=hidden name=mavbatch value="%ECLWEB24.05.208">
<input type=hidden name=mavinvce value="%ECLWEB24.05.207">
<input type=hidden name=eclipath value=" ">
</form>

<form name="CloseEclipseClaim" method="post" action="eclweb24.pbl" 
      style="margin:0">
<input type="hidden" name="urnumber" value="%ECLWEB24.05.003">
<input type="hidden" name="admissno" value="%ECLWEB24.05.081">
<input type="hidden" name="reportno" value="5">
<input type="hidden" name="template" value="001">
<input type="hidden" name="updattyp" value="C">
<input type="hidden" name="redirect">
<input type="hidden" name="nextpage" value="1">
<input type="hidden" name="mavbatch" value="%ECLWEB24.05.208">
<input type="hidden" name="mavinvce" value="%ECLWEB24.05.207">
</form>

<span id="HealthFundSpan" style="display:none">
Health Fund / Level
</span>

<span id="ClaimCodeSpan" style="display:none">
Claim Code
</span>

<span id="PaymentDetailsSpan" style="display:none">
<table width="30%" border="0" cellspacing="0" cellpadding="0">
<tr><td><b>Payment Details</b></td>
    <td></td>
</tr>
<tr><td class="DataLabel">Amount Paid</td>
    <td class="DataField">%ECLWEB24.05.219</td>
</tr>
<tr><td class="DataLabel">Payment Date</td>
    <td class="DataField">%ECLWEB24.05.204</td>
</tr>
<tr><td class="DataLabel">Closed With</td>
    <td class="DataField">%ECLWEB24.05.220</td>
</tr>
<tr><td class="DataLabel" colspan=2><hr></td>
</tr>
</table>
</span>

<script type="text/javascript">

    visit="%ECLWEB24.05.101"
    if(isWhitespace(visit)){
      alert("No Inpatient details.")
      }
    if(visit=="       0"){
      alert("No Inpatient details.") 
      } 
    if (!isWhitespace(document.MiscVars.paymdate.value)) {
      PaymentDetailsDiv.innerHTML=PaymentDetailsSpan.innerHTML; 
    }

    document.CloseEclipseClaim.redirect.value=
        "eclweb24.pbl?reportno=5&template=001&urnumber=" +
        document.PatientLinks.urnumber.value.replace(/ /g,"+") +
        "&admissno=" +
        document.PatientLinks.admissno.value.replace(/ /g,"+") +
        "&mavbatch=" +
        document.MiscVars.mavbatch.value.replace(/ /g,"+") +
        "&mavinvce=" +
        document.MiscVars.mavinvce.value.replace(/ /g,"+");

    if ('%ECLWEB24.05.228' != ' 2' &&
        '%ECLWEB24.05.228' != ' 4' &&
        '%ECLWEB24.05.228' != ' 5' &&
        '%ECLWEB24.05.228' != ' 6' &&
        '%ECLWEB24.05.228' != ' 7' &&
        '%ECLWEB24.05.228' != ' 8') {
      document.getElementById('ihcadjbt').disabled=true;  
    }    

    if (isWhitespace('%ECLWEB24.05.211')) {
      document.getElementById('ihcadjbt').disabled=true;
    }

    if (!isWhitespace('%ECLWEB24.05.229')) {
      document.getElementById('ihcadjbt').disabled=true;
    }


    document.getElementById("rtvwjson").style.visibility="hidden";

// Make the DIV element draggable:
    if(!(window.navigator.appName == "Microsoft Internet Explorer" &&
       (document.documentMode || document.compatMode))) {
      dragElement(document.getElementById("IHCWJSONHEAD"));
    }

</script>

<form name=ShowInvoice action=patweb76.pbl method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=updatety value=1>
<input type=hidden name=invoicen value="">
<input type=hidden name=visittyp value="">
<input type=hidden name=cfeetype value="%ECLWEB24.05.227">
<input type=hidden name=urnumber value="%ECLWEB24.05.003">
<input type=hidden name=admissno value="%ECLWEB24.05.081">
<input type=hidden name=norecord value="10">
</form>
