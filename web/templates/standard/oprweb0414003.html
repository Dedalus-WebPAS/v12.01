<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb04.js"></script>
<script type="text/javascript">

function UpdateActive(){
  if(document.UpdateForm.t_opeqp030.checked==true){
     document.UpdateForm.opeqp030.value=0;
  }
  else{
     document.UpdateForm.opeqp030.value=1;
  }
}
function DisplayHospitalList() {
  f = document.UpdateForm;
  if (f.ibcnmhos.value==1) {
    if (isWhitespace(f.currhosp.value)) {
      document.getElementById('HospitalList').style.display = "";
      AddClassName(f.hospcods,"Mandatory");
      document.getElementById('HospitalName').style.display = "none";
    }
    else {
      document.getElementById('HospitalName').style.display = "";
      document.getElementById('HospitalList').style.display = "none";
    }
  }
  else {
    document.getElementById('HospitalList').style.display = "none";
    document.getElementById('HospitalName').style.display = "none";
  }
}
function TraySearchFrameClick(f) {
  hospcode = "";
  if (f.ibcnmhos.value==1) {
    if (!isWhitespace(f.currhosp.value)) {
      hospcode = f.currhosp.value;
    }
    else {
      i =  document.getElementById('hospcods').selectedIndex;
      if (i == -1) {
        hospcode = "";
      }
      else {
        hospcode = document.getElementById('hospcods').options[i].value;
      }
      if (isWhitespace(hospcode)) {
        alert('Hospital must be entered for Tray Search')
        return false;
      }
    }
  }

  ShowTraySearchFrame(f.opeqp008,
                      f.d_opeqp008,
                      "7",
                      hospcode);
}
function HospitalChanged(f) {
  if (f.ibcnmhos.value==0) {return true;}

  if (!isWhitespace(f.currhosp.value)) {
    hospcode = f.currhosp.value;
  }
  else {
    i =  document.getElementById('hospcods').selectedIndex;
    if (i == -1) {
      hospcode = "";
    }
    else {
      hospcode = document.getElementById('hospcods').options[i].value;
    }
  }

  if (isWhitespace(hospcode)) {
    f.opeqp008.value = "";
    f.d_opeqp008.value = "";
    return true;
  }

  return ValidateTrayCode(f);
}
function ValidateTrayCode(f) {
  if (isWhitespace(f.opeqp008.value)) {
    f.d_opeqp008.value = "";
    return true;
  }

  hospcode = "";
  if (f.ibcnmhos.value==1) {
    if (!isWhitespace(f.currhosp.value)) {
      hospcode = f.currhosp.value;
    }
    else {
      i =  document.getElementById('hospcods').selectedIndex;
      if (i == -1) {
        hospcode = "";
      }
      else {
        hospcode = document.getElementById('hospcods').options[i].value;
      }
      if (isWhitespace(hospcode)) {
        alert('Hospital must be entered for Tray')
        f.opeqp008.value = "";
        return false;
      }
    }
  }

  return ValidateTrayHospital(f.opeqp008,f.d_opeqp008,hospcode);
}
function btnUpdateClick(f) {
  if (!validateMandatory(f)) {return;}
  if (!ValidateTrayCode(f)) {return;}

  SetupHospCode(f)

  f.updttype.value = "U";
  f.submit();
}
function SetupHospCode(f) {
  hospcode = "";
  if (f.ibcnmhos.value==1) {
    if (!isWhitespace(f.currhosp.value)) {
      hospcode = f.currhosp.value;
    }
    else {
      i =  document.getElementById('hospcods').selectedIndex;
      if (i == -1) {
        hospcode = "";
      }
      else {
        hospcode = document.getElementById('hospcods').options[i].value;
      }
    }
  }
  f.updthosp.value = hospcode;
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisplayHospitalList();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
<script type="text/javascript">document.write(self.document.title);</script>
</span>

<form name=UpdateForm method=post action=oprweb04.pbl>
<input type=hidden name=reportno value="14">
<input type=hidden name=template value="003">
<input type=hidden name=updttype value="U">
<input type=hidden name=opeqp030>
<input type=hidden name=ibcnmhos id=ibcnmhos
  value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=currhosp id=currhosp value="%OPRWEB04.14.031.1">
<input type=hidden name=updthosp id=updthosp value="%OPRWEB04.14.031.1">

<table align=center width=98% border=0>
<tr><td>
<table align=center width=100% border=0>
<tr><td class=DataLabel>Equipment Code</td>
  <td><input type=text name=opeqp001 class=Readonly title="Item Code"
       size=15 maxlength=15 value="%OPRWEB04.14.001"></td></tr>

<tr><td class=DataLabel>Equipment Description</td>
    <td><input type=text name=opeqp002 class=Mandatory title="Item Description"
         size=30 maxlength=30 value="%OPRWEB04.14.002"></td></tr>

<tr id=HospitalName>
    <td class=DataLabel>Hospital</td>
    <td>
      <input type=hidden name=hospcode id=hospcode value="%OPRWEB04.14.031.1">
      <input type=text name=hospname id=hospname class=Readonly readonly
       value="%OPRWEB04.14.031.0" size=35 tabindex=-1>
    </td>
</tr>
<tr id=HospitalList>
    <td class=DataLabel>Hospital</td>
    <td colspan=2>
       <select name=hospcods id=hospcods class="SelectBig"
        title="Hospital"
        onchange="HospitalChanged(document.UpdateForm);">
        <option value="  "></option>
         %OPRWEB04.14.032
       </select>
    </td>
</tr>

<tr><td class=DataLabel>Equipment Type</td>
    <td><select name=opeqp003 title="Equipment Type">
         <option></option>
         %OPRWEB04.14.003.2
         </select>
    </td></tr>               

<tr><td class=DataLabel>Current Status</td> 
    <td><select name=opeqp006 title="Current Status">
         <option></option>
         %OPRWEB04.14.006.2
         </select>
    </td></tr>

<tr><td class=DataLabel>Date Status Changed</td>
    <td><input type=text name=opeqp007 title="Date Status Changed"
         class=Readonly readonly tabindex=-1 size=12 maxlength=11 
         value="%OPRWEB04.14.007">
    </td></tr>

<tr><td class=DataLabel>Usual Location/Tray</td>
    <td><input type=text name=opeqp008 title="Usual Location/Tray"
         size=15 maxlength=15
         onblur="ValidateTrayCode(document.UpdateForm);" 
         id=opeqp008 value="%OPRWEB04.14.008.0">
        <input type=text name=d_opeqp008 title="Usual Location/Tray Desc"
         id=d_opeqp008 size=30 class=Readonly readonly tabindex=-1
         value="%OPRWEB04.14.008.1">
        <img src=../images/SearchIcon.gif class=Icon 
         onclick="TraySearchFrameClick(document.UpdateForm);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(opeqp008,d_opeqp008);">
    </td></tr>

<tr><td class=DataLabel>Current Location/Tray</td>
    <td><input type=text name=opeqp009 title="Current Location/Tray"
         size=15 maxlength=15 class=Readonly readonly tabindex=-1
         value="%OPRWEB04.14.009.0">
        <input type=text name=d_opeqp009 title="Current Location/Tray Desc"
         size=30 class=Readonly readonly tabindex=-1
         value="%OPRWEB04.14.009.1">
    </td></tr>

<tr><td class=DataLabel>Date Equipment 1st Used</td>
    <td><input type=text name=opeqp010 title="Date Equipment 1st Used"
         size=12 maxlength=11 class=PastDate value="%OPRWEB04.14.010"
         onblur="checkDate(this,this.title)" >
        <img notab src="../images/DateLookup.gif" class="Icon"
         alt="Show Calendar" date="UpdateForm.opeqp010">
    </td></tr>

<tr><td class=DataLabel>Maximum Number of Uses</td>
    <td><input type=text name=opeqp011 class=Integer min=0 max=99999  
         title="Maximum Number of Uses" size=5 maxlength=5
         value="%OPRWEB04.14.011"></td></tr>

<tr><td class=DataLabel>Equipment Expiry Date</td>
    <td><input type=text name=opeqp012 title="Equipment Expiry Date"
         size=12 maxlength=11 onblur="checkDate(this,'Date')" 
         value="%OPRWEB04.14.012">
        <img notab src="../images/DateLookup.gif" class="Icon"
         alt="Show Calendar" date="UpdateForm.opeqp012">
    </td></tr>

<tr><td class=DataLabel>Number of Uses Remaining</td>
    <td><input type=text name=opeqp013 class=Integer min=0 max=99999 
         title="Maximum Number of Uses" size=5 maxlength=5
         value="%OPRWEB04.14.013"></td></tr>

<tr><td class=DataLabel>Last Sterilisation Date</td>
    <td><input type=text name=opeqp014 title="Last Sterilisation Date"
         size=12 maxlength=11 class=PastDate value="%OPRWEB04.14.014"
         onblur="checkDate(this,this.title)" >
        <img notab src="../images/DateLookup.gif" class="Icon"
         alt="Show Calendar" date="UpdateForm.opeqp014">
    </td></tr>

<tr><td class=DataLabel>Total No. Uses Since Last Sterilisation</td>
    <td><input type=text name=opeqp015 class=Readonly readonly tabindex=-1 
         title="Total No. Uses Since Last Sterilisation" size=5 
         maxlength=5 value="%OPRWEB04.14.015"></td></tr>

<tr><td class=DataLabel>Last Maintenance Date</td>
    <td><input type=text name=opeqp016 title="Last Maintenance Date"
         size=12 maxlength=11 class=PastDate value="%OPRWEB04.14.016" 
         onblur="checkDate(this,this.title)" >
        <img notab src="../images/DateLookup.gif" class="Icon"
         alt="Show Calendar" date="UpdateForm.opeqp016">
    </td></tr>

<tr><td class=DataLabel>Total No. Uses Since Last Maintained</td>
    <td><input type=text name=opeqp017 class=Readonly readonly tabindex=-1 
         title="Total No. Uses Since Last Sterilisation" size=5 
         maxlength=5 value="%OPRWEB04.14.017"></td></tr>

<tr><td class=DataLabel>Equipment Serial Number</td>
    <td><input type=text name=opeqp018 title="Equipment Serial Number"
         size=15 maxlength=15 value="%OPRWEB04.14.018"></td></tr>

<tr><td class=DataLabel>Supplier Catalog Number</td>
    <td><input type=text name=opeqp019 title="Supplier Catalog Number"
         size=15 maxlength=15 value="%OPRWEB04.14.019"></td></tr>

<tr><td class=DataLabel>Supplier Details</td>
    <td><input type=text name=opeqp020 title="Supplier Details"
         size=50 maxlength=50 value="%OPRWEB04.14.020"></td></tr>

<tr><td class=DataLabel>Notes</td>
    <td><input type=text name=opeqp021 title="Notes"
         size=50 maxlength=50 value="%OPRWEB04.14.021"></td></tr>

<tr><td class=DataLabel>Active</td>
    <td><input type=checkbox name=t_opeqp030 title="Active"
         onClick="UpdateActive();"></td></tr>

<tr><td colspan=2 align=center><br>
    <input type=button value="Update" class="button" 
     onclick="UpdateActive();btnUpdateClick(document.UpdateForm);">
    <input type=button value="Delete" class="button" onclick="setFormactn('D')">
    <input type=button value="Close" class="button" 
     onclick='DFrameCloseRefresh()'>
</td></tr>
</table>
</td></tr>
</table>
</form>

<script type="text/javascript">

active = "%OPRWEB04.14.030";
if(active!="1"){
   document.UpdateForm.t_opeqp030.checked=true;
   document.UpdateForm.opeqp030.value="0";
}
else{
   document.UpdateForm.t_opeqp030.checked=false;
   document.UpdateForm.opeqp030.value="1";
}
</script>
