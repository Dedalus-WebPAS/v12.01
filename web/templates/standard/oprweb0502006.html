<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function setCgiVar() {
  UpdateForm.opses003.value = UpdateForm.sesskeys.value.substring(16,22);
}

function setDropdown1() {
  if (isWhitespace(UpdateForm.opses018.value)) {
    UpdateForm.opses018.value=UpdateForm.StartTime.value+":00";
  }
  setEnable();
}
function setDropdown2() {
  if (isWhitespace(UpdateForm.opses019.value)) {
    UpdateForm.opses019.value=UpdateForm.EndTime.value+":00";
  }
  setEnable();
}
function setEnable() {
  Start = new Date();
  ActualStart = new Date();
//
  Start.setFullYear(UpdateForm.opses001.value.substring(6,11));
  monstr= UpdateForm.opses001.value.substring(3,6)
  if (monstr=="Jan" || monstr=="JAN" || monstr=="jan") mon=00
  if (monstr=="Feb" || monstr=="FEB" || monstr=="feb") mon=01
  if (monstr=="Mar" || monstr=="MAR" || monstr=="mar") mon=02
  if (monstr=="Apr" || monstr=="APR" || monstr=="apr") mon=03
  if (monstr=="May" || monstr=="MAY" || monstr=="may") mon=04
  if (monstr=="Jun" || monstr=="JUN" || monstr=="jun") mon=05
  if (monstr=="Jul" || monstr=="JUL" || monstr=="jul") mon=06
  if (monstr=="Aug" || monstr=="AUG" || monstr=="aug") mon=07
  if (monstr=="Sep" || monstr=="SEP" || monstr=="sep") mon=08
  if (monstr=="Oct" || monstr=="OCT" || monstr=="oct") mon=09
  if (monstr=="Nov" || monstr=="NOV" || monstr=="nov") mon=10
  if (monstr=="Dec" || monstr=="DEC" || monstr=="dec") mon=11
  Start.setMonth(mon);
  Start.setDate(UpdateForm.opses001.value.substring(0,2));
  Start.setHours(UpdateForm.opses002.value.substr(0,2));
  Start.setMinutes(UpdateForm.opses002.value.substr(3,2));
  Start.setSeconds(UpdateForm.opses002.value.substr(6,2));
//
  ActualStart.setFullYear(UpdateForm.opses065.value.substring(6,11));
  monstr= UpdateForm.opses065.value.substring(3,6)
  if (monstr=="Jan" || monstr=="JAN" || monstr=="jan") mon=00
  if (monstr=="Feb" || monstr=="FEB" || monstr=="feb") mon=01
  if (monstr=="Mar" || monstr=="MAR" || monstr=="mar") mon=02
  if (monstr=="Apr" || monstr=="APR" || monstr=="apr") mon=03
  if (monstr=="May" || monstr=="MAY" || monstr=="may") mon=04
  if (monstr=="Jun" || monstr=="JUN" || monstr=="jun") mon=05
  if (monstr=="Jul" || monstr=="JUL" || monstr=="jul") mon=06
  if (monstr=="Aug" || monstr=="AUG" || monstr=="aug") mon=07
  if (monstr=="Sep" || monstr=="SEP" || monstr=="sep") mon=08
  if (monstr=="Oct" || monstr=="OCT" || monstr=="oct") mon=09
  if (monstr=="Nov" || monstr=="NOV" || monstr=="nov") mon=10
  if (monstr=="Dec" || monstr=="DEC" || monstr=="dec") mon=11
  ActualStart.setMonth(mon);
  ActualStart.setDate(UpdateForm.opses065.value.substring(0,2));
  ActualStart.setHours(UpdateForm.opses018.value.substr(0,2));
  ActualStart.setMinutes(UpdateForm.opses018.value.substr(3,2));
  ActualStart.setSeconds(UpdateForm.opses018.value.substr(6,2));
//
  var start_difference =(ActualStart.getTime()-Start.getTime());
      start_difference = Math.floor(start_difference / (1000 * 60));
//
  End = new Date();
  ActualEnd = new Date();
//
  End.setFullYear(UpdateForm.opses001.value.substring(6,11));
  monstr= UpdateForm.opses001.value.substring(3,6)
  if (monstr=="Jan" || monstr=="JAN" || monstr=="jan") mon=00
  if (monstr=="Feb" || monstr=="FEB" || monstr=="feb") mon=01
  if (monstr=="Mar" || monstr=="MAR" || monstr=="mar") mon=02
  if (monstr=="Apr" || monstr=="APR" || monstr=="apr") mon=03
  if (monstr=="May" || monstr=="MAY" || monstr=="may") mon=04
  if (monstr=="Jun" || monstr=="JUN" || monstr=="jun") mon=05
  if (monstr=="Jul" || monstr=="JUL" || monstr=="jul") mon=06
  if (monstr=="Aug" || monstr=="AUG" || monstr=="aug") mon=07
  if (monstr=="Sep" || monstr=="SEP" || monstr=="sep") mon=08
  if (monstr=="Oct" || monstr=="OCT" || monstr=="oct") mon=09
  if (monstr=="Nov" || monstr=="NOV" || monstr=="nov") mon=10
  if (monstr=="Dec" || monstr=="DEC" || monstr=="dec") mon=11
  End.setMonth(mon);
  End.setDate(UpdateForm.opses001.value.substring(0,2));
  End.setHours(UpdateForm.opses007.value.substr(0,2));
  End.setMinutes(UpdateForm.opses007.value.substr(3,2));
  End.setSeconds(UpdateForm.opses007.value.substr(6,2));
//
//if end < start assume overnight so add 1 day to get expected end date
//
  if(End.getTime() <  Start.getTime()) {
    End.setTime(End.getTime() + 86400000);
  }
//
  ActualEnd.setFullYear(UpdateForm.opses066.value.substring(6,11));
  monstr= UpdateForm.opses066.value.substring(3,6)
  if (monstr=="Jan" || monstr=="JAN" || monstr=="jan") mon=00
  if (monstr=="Feb" || monstr=="FEB" || monstr=="feb") mon=01
  if (monstr=="Mar" || monstr=="MAR" || monstr=="mar") mon=02
  if (monstr=="Apr" || monstr=="APR" || monstr=="apr") mon=03
  if (monstr=="May" || monstr=="MAY" || monstr=="may") mon=04
  if (monstr=="Jun" || monstr=="JUN" || monstr=="jun") mon=05
  if (monstr=="Jul" || monstr=="JUL" || monstr=="jul") mon=06
  if (monstr=="Aug" || monstr=="AUG" || monstr=="aug") mon=07
  if (monstr=="Sep" || monstr=="SEP" || monstr=="sep") mon=08
  if (monstr=="Oct" || monstr=="OCT" || monstr=="oct") mon=09
  if (monstr=="Nov" || monstr=="NOV" || monstr=="nov") mon=10
  if (monstr=="Dec" || monstr=="DEC" || monstr=="dec") mon=11
  ActualEnd.setMonth(mon);
  ActualEnd.setDate(UpdateForm.opses066.value.substring(0,2));
  ActualEnd.setHours(UpdateForm.opses019.value.substr(0,2));
  ActualEnd.setMinutes(UpdateForm.opses019.value.substr(3,2));
  ActualEnd.setSeconds(UpdateForm.opses019.value.substr(6,2));
//
  var end_difference =(ActualEnd.getTime()-End.getTime());
      end_difference = Math.floor(end_difference / (1000 * 60));
//
  delaytrigger=trim(UpdateForm.opcndovr.value) - 0;
//
  if(start_difference <= delaytrigger) {
    UpdateForm.opses022.disabled=true;
    UpdateForm.opses022.className="";
    MenuOver(UpdateForm.opses022);
  } else {
    UpdateForm.opses022.disabled=false;
    UpdateForm.opses022.className="Mandatory";
  }
  if(end_difference <= delaytrigger) {
    UpdateForm.opses021.disabled=true;
    UpdateForm.opses021.className="";
    MenuOver(UpdateForm.opses021);
  } else {
    UpdateForm.opses021.disabled=false;
    UpdateForm.opses021.className="Mandatory";
  }
}
function setTimeFormat() {
  UpdateForm.opses018.value = UpdateForm.opses018.value + ":00";
  UpdateForm.opses019.value = UpdateForm.opses019.value + ":00";
}
function validateData() {
  if(!validateMandatory(UpdateForm))
    return;   
  var strtDay = UpdateForm.opses065.value.substring(0,3);
  var endDay  = UpdateForm.opses066.value.substring(0,3);
  var strtMon = UpdateForm.opses065.value.substring(3,6);
  var endMon  = UpdateForm.opses066.value.substring(3,6);
  var strtYear= UpdateForm.opses065.value.substring(7,11);
  var endYear = UpdateForm.opses066.value.substring(7,11);
  var strtMonNum;
  var endMonNum;
  var strtDateStr;
  var endDateStr;
  strtMonNum = getMonthNumber (strtMon);
  endMonNum  = getMonthNumber (endMon);
  strtDateStr = strtYear + strtMonNum + strtDay;
  endDateStr  = endYear + endMonNum + endDay;
  if (strtDateStr > endDateStr) {
    UpdateForm.opses065.focus();
    alert("Actual Start Date must be less than Actual End Date");
  } else {
    if (strtDateStr == endDateStr) {
      CalcDura(UpdateForm.opses018,UpdateForm.opses019,UpdateForm.duration);
      if (UpdateForm.duration.value < 0) {
        alert("Actual Start Date must be less than Actual End Date");
      } else {
        UpdateForm.opses021.disabled=false;  
        UpdateForm.opses022.disabled=false;  
        setFormactn('U');
      }
    } else {
      UpdateForm.opses021.disabled=false;  
      UpdateForm.opses022.disabled=false;  
      setFormactn('U');
    }
  }
}
function getMonthNumber (mon) {
   switch(mon) {
     case "Jan": return "01";
     case "Feb": return "02";
     case "Mar": return "03";
     case "Apr": return "04";
     case "May": return "05";
     case "Jun": return "06";
     case "Jul": return "07";
     case "Aug": return "08";
     case "Sep": return "09";
     case "Oct": return "10";
     case "Nov": return "11";
     case "Dec": return "12";
   }
 }
function setDateTime(){
 SessDate= UpdateForm.opses001.value.substring(0,13);
 if(isWhitespace(UpdateForm.opses065.value)) {
      UpdateForm.opses065.value=SessDate;        // Start Date
 }
 if(isWhitespace(UpdateForm.opses018.value)) {
      UpdateForm.opses018.value=UpdateForm.StartTime.value;     // Start Time
 }
//
 if(isWhitespace(UpdateForm.opses066.value)) {
      UpdateForm.opses066.value=SessDate;        // End Date
 }
 if(isWhitespace(UpdateForm.opses019.value)) {
      UpdateForm.opses019.value=UpdateForm.EndTime.value;       // End Time
      CalcDura(UpdateForm.opses018,UpdateForm.opses019,UpdateForm.d_duration);
      var timediff=UpdateForm.d_duration.value
      if (timediff<0){
         AddOneDay();   // Overnight
      }
 }
}
function AddOneDay() {
  var NextDay=new Date();
  NextDay.setFullYear(UpdateForm.opses066.value.substring(6,11));
  monstr= UpdateForm.opses066.value.substring(3,6)
  if (monstr=="Jan" || monstr=="JAN" || monstr=="jan") mon=00
  if (monstr=="Feb" || monstr=="FEB" || monstr=="feb") mon=01
  if (monstr=="Mar" || monstr=="MAR" || monstr=="mar") mon=02
  if (monstr=="Apr" || monstr=="APR" || monstr=="apr") mon=03
  if (monstr=="May" || monstr=="MAY" || monstr=="may") mon=04
  if (monstr=="Jun" || monstr=="JUN" || monstr=="jun") mon=05
  if (monstr=="Jul" || monstr=="JUL" || monstr=="jul") mon=06
  if (monstr=="Aug" || monstr=="AUG" || monstr=="aug") mon=07
  if (monstr=="Sep" || monstr=="SEP" || monstr=="sep") mon=08
  if (monstr=="Oct" || monstr=="OCT" || monstr=="oct") mon=09
  if (monstr=="Nov" || monstr=="NOV" || monstr=="nov") mon=10
  if (monstr=="Dec" || monstr=="DEC" || monstr=="dec") mon=11
  NextDay.setMonth(mon);
  NextDay.setDate(UpdateForm.opses066.value.substring(0,2));
  NextDay.setTime(NextDay.getTime() + 86400000);
  day=NextDay.getDate();
  if(day<10) {
    day="0" + day
  }
  mon="";
  if(NextDay.getMonth()=="0") mon="Jan"
  if(NextDay.getMonth()=="1") mon="Feb"
  if(NextDay.getMonth()=="2") mon="Mar"
  if(NextDay.getMonth()=="3") mon="Apr"
  if(NextDay.getMonth()=="4") mon="May"
  if(NextDay.getMonth()=="5") mon="Jun"
  if(NextDay.getMonth()=="6") mon="Jul"
  if(NextDay.getMonth()=="7") mon="Aug"
  if(NextDay.getMonth()=="8") mon="Sep"
  if(NextDay.getMonth()=="9") mon="Oct"
  if(NextDay.getMonth()=="10") mon="Nov"
  if(NextDay.getMonth()=="11") mon="Dec"
  year=NextDay.getFullYear();
  nextdaydate = day + " " + mon + " " + year
  document.UpdateForm.opses066.value=nextdaydate;
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);setDateTime();setEnable(); setCgiVar(); 
   setTimeFormat();">
<span class=DFrameTitleBar>
<img border=0 align=right src="../images/ExitIcon.gif" 
     onclick="DFrameExit();">
<script language=javascript>
  document.write("Input Session Actuals for %OPRWEB05.02.002");
</script>
</span>
<form name=UpdateForm method=get action=oprweb05.pbl style="margin:0"> 
     <input type=hidden name=reportno value="02">
     <input type=hidden name=template value="006">
     <input type=hidden name=updttype value="">
     <input type=hidden name=opses001 value="%OPRWEB05.02.102">
     <input type=hidden name=opses002 value="%OPRWEB05.02.103">
     <input type=hidden name=sesstime value="%OPRWEB05.02.103">
     <input type=hidden name=opses003 value="">
     <input type=hidden name=opses007 value="%OPRWEB05.02.108">
     <input type=hidden name=opses008 value="%OPRWEB05.02.109">
     <input type=hidden name=opses009 value="%OPRWEB05.02.110">
     <input type=hidden name=opses010 value="%OPRWEB05.02.111">
     <input type=hidden name=opses011 value="%OPRWEB05.02.112.1">
     <input type=hidden name=opses012 value="%OPRWEB05.02.113.1">
     <input type=hidden name=sesskeys value="%OPRWEB05.02.101">
     <input type=hidden name=StartTime value="%OPRWEB05.02.172">
     <input type=hidden name=EndTime   value="%OPRWEB05.02.173">
     <input type=hidden name=duration value="">
     <input type=hidden name=d_duration value="">
     <input type=hidden name=opcndovr value="%STANDARD.01.025.113.008.0.2">
     <input type=hidden name=teamupdt value="1">
     <input type=hidden name=opses074 value="%OPRWEB05.02.179.1">

<table align=center cellspacing=0 cellpadding=1 border=0 width=90%>
<tr><td class=DataLabel>Actual Start Date</td>
    <td><input type=text name=opses065 title="Actual Start Date" maxlength=11
         class="PastDate Mandatory" value="%OPRWEB05.02.170"> 
        <img src="../images/DateLookup.gif" class=Icon 
         onclick="DateLookupFrame(UpdateForm.opses065);">
        Time
        <input type=text size=8  title="Actual Start Time" 
         class="Mandatory Time" name=opses018 value="%OPRWEB05.02.119"
         onblur="checkTime(this,this.title);setDropdown1();">
        <img src=../images/DateTimeStamp.gif class=Icon  
         onclick="SetCurrentDateTime(null,UpdateForm.opses018);">
        <img src=../images/TimeLookup.gif class=Icon
         onclick="TimeLookupFrame(UpdateForm.opses018);"></td></tr>
<tr><td class=DataLabel>Start Late Delay code</td>
    <td><select name=opses022 class=DataField title="Start Late Delay code">
        <option></option>
         %OPRWEB05.02.123.2
        </select></td></tr>
<tr><td class=DataLabel>Actual End Date</td>
    <td><input type=text name=opses066 value="%OPRWEB05.02.171" maxlength=11
         title="Actual End Date" class="PastDate Mandatory">
        <img src="../images/DateLookup.gif" class=Icon 
         onclick="DateLookupFrame(UpdateForm.opses066);">
        Time
        <input type=text size=8  title="Actual End Time" 
         value='%OPRWEB05.02.120' class="Mandatory Time" name=opses019 
         onblur="checkTime(this,this.title);setDropdown2();">
        <img src=../images/DateTimeStamp.gif class=Icon 
         onclick="SetCurrentDateTime(null,UpdateForm.opses019);">
        <img src=../images/TimeLookup.gif class=Icon 
         onclick="TimeLookupFrame(UpdateForm.opses019);"></td></tr>
<tr><td class=DataLabel>End Late Delay code</td>
    <td><select name=opses021 class=DataField title="End Late Delay code">
        <option></option>
         %OPRWEB05.02.122.2
        </select></td></tr>
<tr><td colspan=2 align=center><br>
        <input type=button value="Ok" class="button" id=formactn
         onClick="tempDisable(this);validateData();">
        <input type=button value="Cancel" class="button" 
         onClick="DFrameClose();"></td></tr>
</table>
</form>
