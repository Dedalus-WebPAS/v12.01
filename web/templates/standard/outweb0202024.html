<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/outweb02.js"></script>
<script type="text/javascript">
function postTimeSeen() {
  if(!validateMandatory(UpdateForm)) {
    return;
  }
  if(!checkFutureTimeSeenTime()){ return; }
  RemoveAppointments(UpdateForm);
  if(!GetAppointments(UpdateForm)) {
    return;
  }
  UpdateForm.redirect.value="outweb02.pbl?reportno=2&template=22" +
  "&sesskeys=" + UpdateForm.sesskeys.value.replace(/ /g,"+") 
  "&redirflg=" + UpdateForm.redirflg.value.replace(/ /g,"+");
  document.UpdateForm.submit();
}
function checkFutureTimeSeenTime() {
  p=document.UpdateForm;
  if(isWhitespace(p.d_sessdate.value) || isWhitespace(p.outbb033.value)) {
     return true;
  }
  SetCurrentDateTimeNoFocus(p.currdate,p.currtime);// UNIX time
  if(SetDateYYYYMMDD(p.d_sessdate.value)>SetDateYYYYMMDD(p.currdate.value)) {
    alert("Time seen date should not be in future");
    p.outbb033.focus();
    return false;
  }
  if (SetDateYYYYMMDD(p.d_sessdate.value)==SetDateYYYYMMDD(p.currdate.value)) {
    var newttime=trim(p.outbb033.value.replace(/:/g,"")) - 0
    var currentt=trim(p.currtime.value.replace(/:/g,"")) - 0
    if(newttime>currentt){
      alert("Time seen should not be in future");
      p.outbb033.focus();
      return false;
    }
  }
  return true;
}
function RemoveAppointments(theForm) {
  var appts = document.getElementsByTagName("input");
  for (i=0; i<appts.length; i++) {
    if(appts[i].type=="hidden" &&
       appts[i].id.substr(0,16)=="selectedslotkeys"){
       theForm.removeChild(appts[i]);
    }
  }
}
function GetAppointments(theForm) {
  var appts =parent.document.getElementsByTagName("input");
  var y=0;
  for (i=0; i<appts.length; i++) {
    if(appts[i].type=="checkbox" &&
       appts[i].checked==true &&
       appts[i].name=="slotkeys") {
       y++;
  var newid="selectedslotkeys" + y;
  var the_field = document.createElement('INPUT');
      the_field.setAttribute('value',appts[i].value);
      the_field.setAttribute('name','slotkeys');
      the_field.setAttribute('id',newid);
      the_field.setAttribute('type','hidden');
      theForm.appendChild(the_field);
    }
  }
  if(y==0) {
   alert("Please select at least one patient")
   return false;
  } else {
   return true;
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Bulk Time Seen - %OUTWEB02.02.014
</span>
<div id=PageBodySection style="overflow: auto;">
<form name=UpdateForm action=outweb02.pbl method=post target=_parent>
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=018>
<input type=hidden name=updatety value=17>
<input type=hidden name=redirect value="">
<input type=hidden name=sesskeys value='%OUTWEB02.02.004'>
<input type=hidden name=newsltyp value="">
<input type=hidden name=nextpage value=1>
<input type=hidden name=redirflg value="%OUTWEB02.02.136">
<input type=hidden name=d_sessdate value='%OUTWEB02.02.063'>
<input type=hidden name=currdate value=''>
<input type=hidden name=currtime value=''>
<table cellspacing=0 cellpadding=1 border=0 width=95% align=center>
<tr><td width=20% class=DataLabel>Date</td>
    <td width=30%><input type=text size=11 value="%OUTWEB02.02.063"
                  readonly  class=Readonly></td> 
    <td  width=20% class=DataLabel>&nbsp; </td>
    <td>&nbsp;</td>
    </tr>
<tr><td width=20% class=DataLabel>Time Seen</td>
    <td width=30%>
    <input type=text name=outbb033 value="" size=8 class="Mandatory Time"
     title="Time Seen" onblur="checkTime(this,this.title);">
    <img src=../images/DateTimeStamp.gif  border=0 hspace=4 align=absmiddle
    onclick="SetCurrentDateTimeMin(null,UpdateForm.outbb033);">
    <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle
    onclick="TimeLookupFrameMin(UpdateForm.outbb033);">
    </td>
    <td class=DataLabel width=20%></td>
    <td></td></tr>
<tr><td colspan=4 align=center><br>
    <input type=button class="button" value="Ok" id="out02sub"
     onclick="tempDisable(this);postTimeSeen();">
    <input type=button class="button" Value="Cancel" 
     onclick="DFrameCloseRefresh();"></td></tr>
</table>
</form>
</div>
