<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function chkEndTime() {
  if (!isWhitespace(AddForm.ptven005.value)) {
    AddForm.ptven004.className="Mandatory PastDate";
    if (isWhitespace(AddForm.ptven004.value)) {
      AddForm.ptven004.focus();
    }
  } else {
    AddForm.ptven004.className="PastDate";
  }
}
function chkEndDate() {
  if (!isWhitespace(AddForm.ptven004.value)) {
    AddForm.ptven005.className="Mandatory";
  }
  else {
    AddForm.ptven005.className="";
  }
}
function SubmitForm() {
   chkEndDate();
   chkEndTime();

   if(!validateMandatory(AddForm))
     return;   

   var strtDay = AddForm.ptven002.value.substring(0,3);
   var endDay  = AddForm.ptven004.value.substring(0,3);
   var strtMon = AddForm.ptven002.value.substring(3,6);
   var endMon  = AddForm.ptven004.value.substring(3,6);
   var strtYear= AddForm.ptven002.value.substring(7,11);
   var endYear = AddForm.ptven004.value.substring(7,11);
   var strtMonNum;
   var endMonNum;
   var strtDateStr;
   var endDateStr;

   strtMonNum = GetMonthNumber(strtMon);
   endMonNum  = GetMonthNumber(endMon);
   strtDateStr = strtYear + strtMonNum + strtDay;
   endDateStr  = endYear + endMonNum + endDay;

   if (strtDateStr > endDateStr) {
     AddForm.ptven002.focus();
     alert("Start Date must be less than End Date");
     return;
      }
   else {
     if (strtDateStr == endDateStr) {
       CalcDura(AddForm.ptven003,AddForm.ptven005,AddForm.duration);
       if (AddForm.duration.value < 0) {
         alert("Start Time must be less than End Time");
         return;
       }
     }
   }
    AddForm.updttype.value="A"
    AddForm.submit();
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
 Ventilation Times
</span>

<div id=PageBodySection style="overflow: auto;">
<form  name=AddForm method=post action=patweb78.pbl style="margin:0">
<input type=hidden name=reportno value="5">
<input type=hidden name=template value="001">
<input type=hidden name=updttype value="A">
<input type=hidden name=urnumber value="%PATWEB78.05.003">
<input type=hidden name=admissno value="%PATWEB78.05.081">
<input type=hidden name=duration value="">
<input type=hidden name=ptcnicut value="%STANDARD.01.025.105.173.0.1">
<input type=hidden name=ptcnmvhc value="%STANDARD.01.025.124.120.0.1">
<input type=hidden name=icubedtp value="%PATWEB78.05.212.0">
<input type=hidden name=ccubedtp value="%PATWEB78.05.212.2">

<table align=center width=95% border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel>Ventilation Type</td>
    <td class=DataField><select name=ptven001 tabindex=1
        class="SelectBig Mandatory" title="Ventilation Type">
        <option> </option>
        %PATWEB78.05.201.2
        </select></td></tr>

<tr><td class=DataLabel>Start Date</td>
    <td class=DataField><input type=text size=12 maxlength=12 width=30% 
        name=ptven002 title="Start Date" class="Mandatory PastDate" tabindex=2>
       <img src="../images/DateLookup.gif" class=Icon
       onclick="DateLookupFrame(AddForm.ptven002);">
     </td></tr>

<tr><td class=DataLabel>Start Time</td>
    <td class=DataField><input type=text size=8 maxlength=8 width=30% 
        name=ptven003 title="Start Time" class=Mandatory tabindex=3>
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,AddForm.ptven003);">
      <img src="../images/TimeLookup.gif" class=Icon 
       onclick="TimeLookupFrame(AddForm.ptven003);"></td>
     </td></tr>

<tr><td colspan="4"><hr></td></tr>

<tr><td class=DataLabel>End Date</td>
    <td class=DataField><input type=text size=12 maxlength=12 width=30% 
        name=ptven004 title="End Date" class=PastDate tabindex=4
        onchange="chkEndDate();">
       <img src="../images/DateLookup.gif" class=Icon
       onclick="DateLookupFrame(AddForm.ptven004);">
     </td></tr>

<tr><td class=DataLabel>End Time</td>
    <td class=DataField><input type=text size=8 maxlength=8 width=30%  
        name=ptven005 title="End Time" tabindex=5 onchange="chkEndTime();">
      <img src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(null,AddForm.ptven005);chkEndTime();">
      <img src="../images/TimeLookup.gif" class=Icon 
       onclick="TimeLookupFrame(AddForm.ptven005);"></td>
     </td></tr>

<tr><td class=DataLabel>ICU Status</td>
    <td class=DataField><select name=ptven007 tabindex=7 
        class="SelectBig" title="ICU Status">
        <option> </option>
        %PATWEB78.05.207.2
        </select></td></tr>

<tr><td class=DataLabel>Initiation Site</td>
    <td class=DataField><select name=ptven008 tabindex=8 
        class="SelectBig" title="Initiation Status">
        <option> </option>
        %PATWEB78.05.208.2
        </select></td></tr>

</table>

<table cellspacing=0 cellpadding=1 border=0 width=95% align=center>
<tr><td colspan=3 align=center><br>
    <input type=button class="button" value="Add" name=AddButtn
     onclick="tempDisable(this);SubmitForm();">
    <input type=button value=Close class="button" onclick="DFrameClose()">
   </td></tr>
</table>
</form>
</div>

<script type="text/javascript">
function init(){
  if(document.AddForm.ptcnmvhc.value!="1"){
   if(document.AddForm.ptcnicut.value=="1"){
     if(document.AddForm.icubedtp.value=="0" && 
      document.AddForm.ccubedtp.value=="0"){
    alert("Error: No ICU bed. Ventilation hours cannot be added.");
    DFrameExit();}
   }
  }
}
</script>
