<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language=javascript src=../js/outweb0602001.js></script>
<script language=javascript src=../js/TableSort.js></script>
<script language=javascript>
// ------------------------------------------------------------
// Columns Available
//  0 - HTML Link    
//  1 - UR No  
//  2 - Visit No
//  3 - Patient's Name          
//  4 - App Time           
//  5 - Admitting Point
//  6 - Current Location
//  7 - Type of document
//  8 - Filled Status
// ------------------------------------------------------------
function InitTable(TableView) {
document.SelectPeriod.deftview.value=TableView
switch (TableView) {
case 0: {
 t = new Table(1,0,1,"100%","center");
 t.addColumn("UR No.","String",1,15,"left","","",50)
 t.addColumn("Visit No.","String",2,2,"left","","",50)
 t.addColumn("Patient's Name","ImageText",3,3,"left","PatientFolder","18",140,"19")
 t.addColumn("Adm.Book Time","String",4,4,"left","","",100)
 t.addColumn("Admitting Point","String",5,5,"left","","",60)
 t.addColumn("Current Location","String",6,6,"left","","",140)
 t.addColumn("Document Type","String",7,7,"left","","",60)

// if (document.getElementById("superlev").value=="1") {
//    t.addColumn("Volume","String",12,12,"center","","",40)
// }
 t.addColumn("Vol.","String",12,12,"left","","",60)
 t.addColumn("Status","String",17,17,"center","","",60)

 t.addColumn("Filled","String",8,8,"center","","",40)
 t.addColumn("Keep on List","String",22,22,"center","","",40)
 t.addColumn("Remove from List","String",23,23,"center","","",40)
 t.addColumn("Microfilm","ImageText",9,9,"center","ConditionIcon_","10",45,11)
 t.addColumn("Last Mv Date","Date",16,16,"center","","",65)

 AddTableRows()
 TableOutput(0,1);    // Order Column,Asc Dsc
 break;
 }
case 1: {
 t = new Table(1,0,1,"100%","center");
 t.addColumn("UR No.","String",1,15,"left","","",50)
 t.addColumn("Visit No.","String",2,2,"left","","",50)
 t.addColumn("Patient's Name","ImageText",3,3,"left","PatientFolder","18",140,"19")
 t.addColumn("Adm.Book Time","String",4,4,"left","","",100)
 t.addColumn("Adm. Doctor","String",20,20,"left","","",140)
 t.addColumn("Diagnosis","String",21,21,"left","","",140)
 t.addColumn("Admitting Point","String",5,5,"left","","",60)
 t.addColumn("Current Location","String",6,6,"left","","",140)
 t.addColumn("Document Type","String",7,7,"left","","",60)

 if (document.getElementById("superlev").value=="1") {
    t.addColumn("Volume","String",12,12,"center","","",40)
 }

 t.addColumn("Filled","String",8,8,"center","","",40)
 t.addColumn("Keep on List","String",22,22,"center","","",40)
 t.addColumn("Remove from List","String",23,23,"center","","",40)
 t.addColumn("Microfilm","ImageText",9,9,"center","ConditionIcon_","10",45,11)
 t.addColumn("Last Mv Date","Date",16,16,"center","","",65)

 AddTableRows()
 TableOutput(0,1);    // Order Column,Asc Dsc
 break;
 }
}
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(%OUTWEB06.02.022);getCheckBoxes();">
<div id=HeadingSection>
<form name=SelectPeriod action=outweb06.pbl method=get style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=1>
<input type=hidden name=viewtype value="%OUTWEB06.02.010">
<input type=hidden name=updatety value="">
<input type=hidden name=unitcode>
<input type=hidden name=wardcode>
<input type=hidden name=locnhosp>
<input type=hidden name=location>
<input type=hidden name=allhomeh value="%OUTWEB06.02.020">
<input type=hidden name=superlev id=superlev value="%OUTWEB06.02.021">
<input type=hidden name=deftview value="">
<input type=hidden name=incladms id=incladms value="%OUTWEB06.02.023">

<table cellpadding=1 cellspacing=1 bgcolor=#CCCCCC border=1 width=100%>
<tr><td>
 <table cellpadding=0 cellspacing=0 bgcolor=#CCCCCC border=0 width=100%>
<tr><td colspan=3> 
    <a href=javascript:InitTable(0)>
    <img src=../images/TableViewIcon.gif align=absmiddle
     alt="Default View" border=0></a>
    <a href=javascript:InitTable(1)>
    <img src=../images/TableViewIcon.gif align=absmiddle
     alt="Admitting Doctor and Diagnosis" border=0></a>

    <input type=button value="<<" class=smallbutton
    onclick='%OUTWEB06.02.002'>
    %OUTWEB06.02.007
    <input type=button value=">>" class=smallbutton
    onclick='%OUTWEB06.02.001'>
    
   <a href='javascript:SelectDateFrame();'>
   <img src="../images/CalendarLookup.gif" border=0
    alt="Select Date" align=absmiddle></a>
   <a href='javascript:SelectView("0");'>
   <img src=../images/DayIcon.gif border=0
    alt="View Today" align=absmiddle></a>
   <a href='javascript:SelectView("1");'>
   <img src=../images/WeekIcon.gif border=0
    alt="View This Week" align=absmiddle></a>
   <a href='javascript:SelectView("2");'>
   <img src=../images/MonthIcon.gif border=0
    alt="View This Month" align=absmiddle></a>
   </td>
 <td align=right><input type=button class="button" value="Move Records"
     onclick="moveRecords();"></td>
 </tr>

<tr><td>Unit<br>
   <select name=unitcode id=unitcode class=SelectBig
    onchange='this.form.submit()'>
   <option value="      ">All           </option>
   %OUTWEB06.02.012.2
   </select></td>


   <td>Admitting Point<br>
   <select name=admittpt id=admittpt class=SelectBig
    onchange='this.form.submit()'>
   <option value="      ">All           </option>
    %OUTWEB06.02.014.2
   </select></td>

   <td>Post-Op Ward<br>
   <select name=postward id=postward class=SelectBig
    onchange='this.form.submit()'>
   <option value="      ">All           </option>
    %OUTWEB06.02.015
   </select></td>

   <td>Include Current Admissions<br>
   <input type=checkbox value=1 name=incCurAd id=incCurad
          title="Include Current Admissions"
          onchange='updateInclAdmis(this)'></td>

   <td>Exceptions<br>
   <input type=checkbox value=1 name=exceptns id=exceptns
          title="Show Exceptions" onclick='this.form.submit()'></td>
   </tr>

<tr><td>Document Type<br>
    <select name=filtdoty id=filtdoty onchange='this.form.submit()'>
    <option value="   ">All</option>
    %OUTWEB06.02.019.2
    </select>
    </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    </tr>

</table>
</td></tr>
</table>
<div id=PostResults></div>
</form>
</div>

<div id=Results></div>

<div id=TableLocation></div>
<script language="Javascript">
function AddTableRows() {
%OUTWEB06.02.011.patweb98.01.001
}
Except="%OUTWEB06.02.018";
if ( Except == "1") {
  document.SelectPeriod.exceptns.checked=1;
}

if (document.getElementById("incladms").value == 1) {
  document.getElementById("incCurad").checked = true;
}

function getCheckBoxes() {
  var inputs = document.getElementsByTagName("input");
  var checkboxes = new Array();

  for (var i=0;i<inputs.length;i++) {
    if(inputs[i].type == "checkbox") {
      if (inputs[i].checked == true) {
        checkboxes.push(inputs[i]);
      }
    }
  }

  for (var i=0;i<checkboxes.length;i++){
    createOutputArray(checkboxes[i]);
  }
  OutputDivision();
}
</script>
