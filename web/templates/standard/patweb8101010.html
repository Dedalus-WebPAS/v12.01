<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/preadmission.js"></script>
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<script type="text/javascript">
function submitAdd(){
  if (!validateMandatory(document.AddForm)) {
     return;
  }
  document.AddForm.psevt001.disabled=false;
  document.AddForm.submit();
}
 function SetList() {
   p=AddForm;
   p.psevt013.options.length=1;
   SetClinicType(p.psevt013,p.defctype.value,p.wbsesite.value);
   SetList2();
 }
 function SetList2() {
   p=AddForm;
   p.psevt014.options.length=1;
   SetTypeClinic(p.psevt014,p.deftclid.value,p.wbsesite.value,p.psevt013.value);
 }
 function ValidateData(formName) {
   admDate = formName.psevt002;
   admTime = formName.psevt003;
   dscDate = formName.psevt009;
   dscTime = formName.psevt010;
   if(validateMandatory(formName)) {
      if(dscDate.value.replace(/ /g,"") != "" &&
         dscTime.value.replace(/ /g,"") == "") {
         alert("Discharge Time cannot be empty when Discharge Date is entered");
         return false;
      }
      if(dscDate.value.replace(/ /g,"") == "" &&
         dscTime.value.replace(/ /g,"") != "") {
         alert("Discharge Date cannot be empty when Discharge Time is entered");
         return false;
      }
      if(!ChkDateTime(admDate,admTime,dscDate,dscTime)) {
        alert("Discharge Date cannot be before Admission Date");
        return false;
      }
      return true;
   }
   else {
     return false;
   }
 }
function defOutBookEvent() {
  if (document.AddForm.tmbkevin.value=="1") { 
         
    if (!isWhitespace(document.AddForm.tmconsul.value)) {
      document.AddForm.psevt004.value=document.AddForm.tmconsul.value;
      ValidateHCP(18,14,document.AddForm.psevt004,document.AddForm.psevt000);
    } 
         
    if (!isWhitespace(document.AddForm.tmuntdep.value)) {
      for (var i =0 ; i < document.AddForm.psevt006.length; i++) {
        if(document.AddForm.psevt006.options[i].value.substr(0,3)==
           document.AddForm.tmuntdep.value) {
          document.AddForm.psevt006.selectedIndex=i
        }
      }
    }

    if (!isWhitespace(document.AddForm.tmclmtyp.value)) {
      for (var i =0 ; i < document.AddForm.psevt015.length; i++) {
        if(document.AddForm.psevt015.options[i].value.substr(0,3)==
           document.AddForm.tmclmtyp.value) {
          document.AddForm.psevt015.selectedIndex=i
        }
      }
    }

  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);defOutBookEvent();">
<div id="PatientHeading"></div>
<script type="text/javascript">
PatientURN="%PATWEB81.01.003";
PatientVIS="%PATWEB81.01.081";
PatientNAM="%PATWEB81.01.002";
PatientSTA="%PATWEB81.01.086.078";
PatientALT="%PATWEB81.01.084";
PatientSEX="%PATWEB81.01.019";
PatientDOB="%PATWEB81.01.020";
PatientAGE="%PATWEB81.01.021";
PatientLOC="%PATWEB81.01.083";
PatientPRI="%PATWEB81.01.086.066.1";
PatientUNT="%PATWEB81.01.066.0";
DoctorCOD="%PATWEB81.01.082.003";
DoctorNAM="%PATWEB81.01.082.002";
PatientAID="%PATWEB81.01.086.090";
PatientIND="%PATWEB81.01.086.091";
PatientCUR="%PATWEB81.01.086.092";
PatientCLC="%PATWEB81.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB81.01.086.094";
PatientCDM="%PATWEB81.01.086.095";
PatientVDH="%PATWEB81.01.086.099.015";
InsertPatientHeader()
</script>
<div id="PatientMenu"></div>
<div id="PageBodySection">
<form name=AddForm method=post action=patweb81.pbl style="margin:0"
 onsubmit="return ValidateData(this);">
<input type=hidden name=reportno value="01">
<input type=hidden name=template value="010">
<input type=hidden name=updttype value="A">
<input type=hidden name=urnumber value="%PATWEB81.01.003">
<input type=hidden name=admissno value="%PATWEB81.01.081">
<input type=hidden name=wbsesite value="%STANDARD.01.023">
<input type=hidden name=defctype value="">
<input type=hidden name=deftclid value="">
<input type=hidden name=bookedfl value="1">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="%PATWEB81.01.001.patweb81.01.001">
<input type=hidden name=tmbkevin value="%PATWEB81.01.131">
<input type=hidden name=tmconsul value="%PATWEB81.01.136">
<input type=hidden name=tmuntdep value="%PATWEB81.01.137">
<input type=hidden name=tmclmtyp value="%PATWEB81.01.138">
<table align=center width=95% border=0 cellpadding=1 cellspacing=0>
<tr><td class=DataLabel>Add Event</td>
     <td><select name=psevt001>
         <option></option>
          %STANDARD.01.018.EV.   .9.1. 1.1.O
         </select>
    </td></tr>

<tr><td class=DataLabel>Attendance Date</td>
    <td>
    <input type=text name=psevt002 class=Mandatory
     title="Admission Date" size=12 value="%STANDARD.01.015">
    <img src=../images/DateLookup.gif class=Icon date=AddForm.psevt002>
    Time
    <input type=text name=psevt003 class=Mandatory title="Admission Time"
     size=8 maxlength=8 value="%STANDARD.01.016">
    <img src=../images/DateTimeStamp.gif class=Icon
     date=AddForm.psevt002 time=AddForm.psevt003>
    <img src=../images/TimeLookup.gif class=Icon time=AddForm.psevt003>
    </td></tr>
<tr><td class=DataLabel>Attending HCP</td>
    <td><input type=text name=psevt004 class=DataField title="Attending HCP"
     size=10 maxlength=10 
     onblur="ValidateHCP(18,14,AddForm.psevt004,AddForm.psevt000);">
    <input type=text name=psevt000 class=ReadOnly readonly title="Attending HCP"
     size=24 maxlength=24>
    <img src="../images/SearchIcon.gif" class="Icon"
     onclick="HCPSearchFrame(AddForm.psevt004,AddForm.psevt000,1);"> </td></tr>
<tr><td class=DataLabel>Presenting Problem</td>
    <td><input type=text name=psevt005 title="Presenting Problem"
         size=50 maxlength=60 value=""> </td></tr>
     <tr><td class=DataLabel>Appointment Type</td>
    <td><select name=psevt016 title="Appointment Type">
    <option></option>
    %PATWEB81.01.130
    </select>
   </td></tr>
<tr><td class=DataLabel>Unit</td>
    <td><select name=psevt006 title="Unit">
        <option></option>
        %PATWEB81.01.105.2
        </select> </td></tr>
<tr><td class=DataLabel>Clinic Type</td>
    <td>
    <select name=psevt013 title="Clinic Type"
            class="Mandatory" onchange="SetList2();">
        <option></option>
        </select>
    </td></tr>

<tr><td class="DataLabel">Clinic ID</td>
    <td><select name=psevt014 title="Clinic ID">
        <option></option>
        </select>
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td><select name=psevt015 title="%STANDARD.01.017.CL" class=Mandatory>
        <option></option>
        %PATWEB81.01.114.9.1.10.2.X
        </select> </td></tr>
<!--Defect No. 1578
<tr><td class=DataLabel>Admit Type</td>
    <td><select name=psevt018 title="Admit Type">
        <option></option>
        PATWEB81.01.117.2
        </select> </td></tr>
<tr><td class=DataLabel>Admit Source</td>
    <td><select name=psevt019 title="Admit Source">
        <option></option>
        PATWEB81.01.118.2
        </select> </td></tr>
-->
<tr><td class=DataLabel>Referred By</td>
     <td>
     <input name=psevt020 type=hidden>
     <input type=text name=name_psevt020 class=ReadOnly readonly
      title="Referred By" size=24 maxlength=24>
     <img src="../images/SearchIcon.gif" class="Icon"
      onclick="HCPSearchFrame(AddForm.psevt020,AddForm.name_psevt020,2);"> 
     </td></tr>
<tr><td class=DataLabel>Staff Phone Number</td>
    <td>
    <input type=text name=psevt007 title="Staff Phone Number"
     size=20 maxlength=20 > </td></tr>
<tr><td class=Mandatory>Patient Location</td>
    <td><select name=psevt008 title="Patient Location" class=Mandatory>
        <option></option>
        %PATWEB81.01.107.2
        </select> </td></tr>

<tr><td class=DataLabel>Attendance Status</td>
    <td><select name=psevt017 title="Attendance Status" >
        <option></option>
         <option value="0">Attended</option>
         <option value="1">Not Attended</option>
         <option value="2">Cancelled</option>
        </select> </td></tr>

<tr><td class=DataLabel>Discharge Date</td>
    <td><input type=text name=psevt009 title="Departure Date" size=12
         class="PastDate">
    <img src=../images/DateLookup.gif class=Icon date=AddForm.psevt009>
    Time
    <input type=text name=psevt010 title="Departure Time"
     size=8 maxlength=8 >
    <img src=../images/DateTimeStamp.gif class=Icon
     date=AddForm.psevt009 time=AddForm.psevt010>
    <img src=../images/TimeLookup.gif class=Icon time=AddForm.psevt010>
    </td></tr>
<tr><td class=DataLabel>Discharge Status</td>
    <td><select name=psevt021 title="Discharge Status">
        <option></option>
        %PATWEB81.01.120.2
        </select> </td></tr>
<tr><td colspan=4 align=center><br>
    <input type=button name=add value="Add" class="button" id="btnAdd"
     onclick="tempDisable(this);submitAdd();">
     <input tabindex="85" type="button" value="Cancel" class="button"
             onclick="PatientLinkTo('patweb98.pbl',1,1,0);" /></td>
    </tr>
</table>
</form>
<script type="text/javascript">
  SetList();
//for (var i =0 ; i < document.AddForm.psevt001.length; i++) {
//  if(document.AddForm.psevt001.options[i].value.substr(3,1)=="O") {
//       document.AddForm.psevt001.selectedIndex=i } };
  //document.AddForm.psevt001.disabled="true";
</script>
<form name="PatientLinks" method="get" style="margin:0">
<input type="hidden" name="reportno" value="1" />
<input type="hidden" name="template" value="004" />
<input type="hidden" name="urnumber" value="%PATWEB81.01.003" />
<input type="hidden" name="admissno" value="%PATWEB81.01.081" />
<input type="hidden" name="MenuType" value="%PATWEB81.01.088" />
</form>
</div>
