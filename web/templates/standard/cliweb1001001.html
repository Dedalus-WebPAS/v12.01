<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<style type=text/css>
.ResultID {
  white-space:nowrap;
  font-weight:bold;
  vertical-align:top;
}
.ResultTX {
  vertical-align:top;
  width:80%;
}
</style>
<script type="text/javascript">
//------------------------------------------------------------
// Print Page with Divisions from Window with Overflow handling
//------------------------------------------------------------
function PrintThisPage() {
  SaveHeight=PageBodySection.style.height
  PageBodySection.style.height="auto"
  PageBodySection.style.overflow="visible"
  print()
  PageBodySection.style.height=SaveHeight
  PageBodySection.style.overflow="auto"
}
function OpenDocument(LinkToURL) {
  var PopUpFrameDoc  = ibaGetIframeDoc('PopUpFrame');
  var PatientMenu = document.getElementById('PatientMenu');
  var PopUpScreen = document.getElementById('PopUpScreen');
  var FrameWidth=document.body.clientWidth*0.8;
  var FrameHeight=document.body.clientHeight*0.8;
  var FrameLeft = (document.body.clientWidth - FrameWidth)/2 ;
  var FrameTop = (document.body.clientHeight-FrameHeight)-25;
  var PDFHeight=FrameHeight-35;
  PopUpScreen.style.display = "none";
  PopUpFrameDoc.open();
  PopUpFrameDoc.write('')
  PopUpFrameDoc.write('<link rel="stylesheet" href="../html/standard.css" type="text/css">' +
   '<link rel="stylesheet" href="../html/custom.css" type="text/css">' +
   '<script type="text/javascript" src="../js/Standard.js"><\/script>' +
   '<script type="text/javascript" src="../js/Custom.js"><\/script>' +
   '<body style="background-color:black;" onload=\'PageLoad(event);\'>' +
   '<span class="DFrameTitleBar">' +
   '<img border="0" align="right" src="../images/ExitIcon.gif" ' + 
   'onclick="DFrameExit();">Document View</span>' +
   '<iframe src="' + LinkToURL + '" width="100%" fromeborder=0 ' +
   'style="border:0;margin:0;padding:0;height:'+PDFHeight+'px;background:white;">'+
   '</iframe></body>');
  PopUpFrameDoc.close();
  PopUpScreen.style.top     = FrameTop + "px";
  PopUpScreen.style.left    = FrameLeft + "px";
  PopUpScreen.style.height  = FrameHeight + "px";
  PopUpScreen.style.width   = FrameWidth  + "px";
  PopUpScreen.style.display = "";
}
function init() {
  var urlRegex= new RegExp("(https?://.*\\s)","gi");
  var val=document.getElementById("resultText");
  var textLinkURL=val.innerHTML.match(urlRegex);
  var OS=val.outerHTML.replace(urlRegex, "<a target='_blank' href='$1'>$1</a>");
  val.outerHTML=OS;
  if (resultOpenDocument) {
    var docTable=document.getElementById("DocumentTable");
    var docRegex = /.*OpenDocument\(([^)]+)\).+/g;

    if (typeof docTable.rows[1] != "undefined") { 
      if (typeof docTable.rows[1].cells[0] != "undefined") { 
        if (docTable.rows[1].cells[0].innerHTML.match(docRegex)) {
          var docURL = docTable.rows[1].cells[0].innerHTML.replace(docRegex,"$1").replace(/\"?(\&quot;)?/g,"");
 //         OpenDocument(docURL);
        }
      }
    }
  }
}
function CancelOrder() {
  if (typeof OrderFormEnabled === 'undefined') {
    alert("Diagnostic Orders are not available on this system.")
    return;
  }
  var SecurityLevel=PatientLinks.SecurityLevel.value;
  var CurrentUserName=PatientLinks.CurrentUserName.value.replace(/ *$/,"");
  var CurrentDoctor=PatientLinks.doctorcd.value;
  var OrderedBy=PatientLinks.orderedby.value;
  var StatusCode=PatientLinks.statuscd.value;
  var EnableCancel=false;
  var at=document.getElementById("AuditTable");
  var trows=at.getElementsByTagName("tr");
  var OrderedByUserName="";
  for (i=1;i<trows.length;i++) {
    var tcells=trows[i].getElementsByTagName("td")
    if (tcells.length>1) OrderedByUserName=tcells[0].innerText.replace(/ *$/,"");
  }
  if (SecurityLevel=="99")                { EnableCancel=true; }
  if (CurrentDoctor==OrderedBy )          { EnableCancel=true; }
  if (CurrentUserName==OrderedByUserName) { EnableCancel=true; }
  if (!EnableCancel) {
    alert("Requests can only be cancelled by the requesting clinician.")
    return;
  }
  if (StatusCode.match(/S/)||StatusCode.match(/ZZ/)||StatusCode.match(/X/)) {
    confirmMsg="This action will cancel all items on this request.\r"+
               "Click Ok to Continue."
    if (confirm(confirmMsg)) {
      var xmlHttp = createHttpObject();
      var theURL   = "cliweb06.pbl";
      parameters  ="reportno=1";
      parameters+="&template=1";
      parameters+="&formactn=C2";
      parameters+="&urnumber="+encodeURIComponent(document.PatientLinks.urnumber.value);
      parameters+="&admissno="+encodeURIComponent(document.PatientLinks.admissno.value);
      parameters+="&resultky="+encodeURIComponent(document.PatientLinks.resultky.value);
      xmlHttp.open("POST", theURL, false);
      xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
      xmlHttp.send(parameters);
      var resultText=xmlHttp.responseText;
      if (resultText.match(/ERROR/i)) {
        alert(resultText.replace(/.*alert\(\"/i,"").replace(/\".*/,""));
      } else {
        GoCookiePath('ResultList');
      }
    }
  } else {
    alert("Status Invalid. This is not a request that can be cancelled.");
  }
}
function viewCliDoc(obsaudky) {
  var serverURL   = "../cgi-bin/comweb80.pbl?reportno=91" +
                    "&valdcode=" + obsaudky.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
}
function ToggleHeader(){
  if(document.MarkSeen.deltview.value=="1"){
     var titleBar = document.getElementById("PatientHeading");
     titleBar.outerHTML = '<span class="DFrameTitleBar">'+
     '<img border="0" align="right" src="../images/ExitIcon.gif" '+
     'onclick="DFrameExit();">Document View</span>';
     document.body.disabled = true;
  }
}
function submitonEnter(e){
 var key = (window.event) ? window.event.keyCode : e.which;
 if (key == 13) {
  DFrameSubmit(MarkSeen,30,30,10,10);
 }
 return true;
}


</script>
</head>
%START.OF.PAGE
<body onload="ToggleHeader();PageLoad(event);">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%CLIWEB10.01.003";
PatientVIS="%CLIWEB10.01.081";
PatientNAM="%CLIWEB10.01.002";
PatientSTA="%CLIWEB10.01.086.078";
PatientALT="%CLIWEB10.01.084";
PatientSEX="%CLIWEB10.01.019";
PatientDOB="%CLIWEB10.01.020";
PatientAGE="%CLIWEB10.01.021";
PatientLOC="%CLIWEB10.01.083";
PatientPRI="%CLIWEB10.01.086.066.1";
PatientUNT="%CLIWEB10.01.066.0";
DoctorCOD="%CLIWEB10.01.082.003";
DoctorNAM="%CLIWEB10.01.082.002";
PatientAID="%CLIWEB10.01.086.090";
PatientIND="%CLIWEB10.01.086.091";
PatientCUR="%CLIWEB10.01.086.092";
PatientCLC="%CLIWEB10.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%CLIWEB10.01.086.094";
PatientCDM="%CLIWEB10.01.086.095";
PatientVDH="%CLIWEB10.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form name=MarkSeen action=cliweb10.pbl method=post style=margin:0>
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=001>
<input type=hidden name=markalll value=1>
<input type=hidden name=auditkey value="%CLIWEB10.01.152">
<input type=hidden name=deltview value="%CLIWEB10.01.168">
<table border=0 width="100%" cellspacing=0 cellpadding=0>
<tr><td width=30% class=HeadingCell>
    <input type=button name=markseen value="Mark as Read" 
    class="button MarkAsRead" onkeydown="return TrapEnterKey();"
    onkeyup="return submitonEnter(event);"
    onclick="DFrameSubmit(MarkSeen,30,30,10,10);">
    <input type=button class=button value="Print View"
     onclick="PrintThisPage();">
    <input type=button class=button value="List View"
     onclick="GoCookiePath('ResultList');">
     </td>
    <td class=HeadingCell align=center>
     Diagnostic Service: %CLIWEB10.01.128.0 <br>
     Panel: %CLIWEB10.01.115 (%CLIWEB10.01.114)</td>
    <td class=HeadingCell width=30% align=right>
    <input type=button class=button value="Cancel Request"
     onclick="CancelOrder();">
    </td></tr>
</table>
</form>

<table border=1 width="100%" cellspacing=0 cellpadding=1>
<tr><td class=DataLabel>Laboratory Reference </td>
    <td class=DataField>%CLIWEB10.01.113 </td>
    <td class=DataLabel>Collection Date & Time</td>
    <td class=DataField>%CLIWEB10.01.102 at %CLIWEB10.01.103</td>
    </tr>

<tr><td class=DataLabel>Ordering Provider</td>
    <td class=DataField>
        %CLIWEB10.01.125 %CLIWEB10.01.124(%CLIWEB10.01.123)</td>
    <td class=DataLabel>Status </td>
    <td colspan=3 class=DataField> %CLIWEB10.01.131.1 %CLIWEB10.01.131.0</td>
    </tr>

<tr><td colspan=4>
      <pre>%CLIWEB10.01.133</pre>
    </td></tr>
</table>

<table cellspacing=0 cellpadding=0 border=0 width=100% bgcolor=#CCCCCC>
<tr><td>
<table width=100% border=1 cellspacing=0 cellpadding=1 id=resultText>
%CLIWEB10.01.165  
</table>
</td></tr>
</table>

<form name=MarkActn action=cliweb10.pbl method=post style=margin:0>
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=001>
<input type=hidden name=auditkey value="%CLIWEB10.01.152">
<table cellspacing=0 cellpadding=0 border=0 width=100% bgcolor=#CCCCCC>
<tr><td align=center>
<input type=button name=previous Value="<< Last Panel" class="button"
 onclick='%CLIWEB10.01.153.cliweb10.01.001'>
<input type=button name=summary Value="Patient Summary" class="Bigbutton"
 onclick='location.href="%CLIWEB10.01.001.cliweb03.01.001"'>
<input type=button name=summary Value="Cumulative" class="button"
 onclick='location.href="%CLIWEB10.01.101.cliweb10.03.001"'>
<input type=button name=summary Value="Coll. Summary" class="button"
 onclick='location.href="%CLIWEB10.01.101.cliweb10.01.002"'>
<input type=button name=previous Value="Next Panel >>" class="button"
 onclick='%CLIWEB10.01.154.cliweb10.01.001'>
</td></tr>
<tr><td align=center bgcolor=#CCCCCC>
Action Type
<select name=actncode>
<option></option>
%CLIWEB10.01.156.2
</select>
Comment
<input type=text name=actncomm size=40 maxsize=50>
<input type=button name=markactn Value="Save Action" class="button"
 onclick="DFrameSubmit(MarkActn,10,10,10,10);">
</td></tr>
</table>
</form>

<form name=AddDocumentLink action=cliweb08.pbl method=get style=margin:0>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=10>
<input type=hidden name=urnumber value="%CLIWEB10.01.003">
<input type=hidden name=admissno value="%CLIWEB10.01.081">
<input type=hidden name=resultky value="%CLIWEB10.01.151">
<table id=DocumentTable width=100% border=1 cellspacing=0 cellpadding=1>
<tr><td class=HeadingCell>Linked Documents</td>
    <td class=HeadingCell>Description</td>
    <td class=HeadingCell>Date Input</td>
    <td class=HeadingCell>Input By</td></tr>
%CLIWEB10.01.158
<tr><td colspan=4 bgcolor=#cccccc align=right>
    <input type=button class="button" value="Add Document" 
    onclick='DFrameSubmit(AddDocumentLink,100,150,500,250);'>
    </td></tr>
</table>
</form>

<table width=100% border=1 cellspacing=0 cellpadding=0 id=AuditTable>
%CLIWEB10.01.149
</table>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%CLIWEB10.01.003">
<input type=hidden name=admissno value="%CLIWEB10.01.081">
<input type=hidden name=MenuType value="%CLIWEB10.01.088">
<input type=hidden name=username value="%STANDARD.01.008">
<input type=hidden name=SecurityLevel value="%STANDARD.01.042.CLIWEB10">
<input type=hidden name=CurrentUserName value="%STANDARD.01.009">
<input type=hidden name=doctorcd value="%STANDARD.01.010">
<input type=hidden name=orderedby value="%CLIWEB10.01.123">
<input type=hidden name=labtype  value="%CLIWEB10.01.128.1   ">
<input type=hidden name=labfolio value="%CLIWEB10.01.119">
<input type=hidden name=labrefno value="%CLIWEB10.01.113">
<input type=hidden name=statuscd value="%CLIWEB10.01.131.1">
<input type=hidden name=resultky value="%CLIWEB10.01.151">
</form>
</div>
