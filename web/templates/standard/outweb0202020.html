%START.OF.PAGE
<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html"> 
<meta name="CrossBrowser" content="true">
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
<link rel="stylesheet" media="print" href="../html/printWithHeader.css" type="text/css">
<script type="text/javascript" src="../js/outweb02.js"></script>
<script type="text/javascript" src="../js/outweb0202004.js"></script>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3&key=%STANDARD.01.044.124.161.050"></script>
<script type="text/javascript" src="../js/GoogleLibrary.js"> </script>
<style type=text/css>
.InformationIcon {
  background: url("../images/AlertSprite.png") -0px -140px no-repeat;
  width:20px;
  height:20px;
}
</style>
<script type="text/javascript">
function InitTable() {
  getClinicSearchCookie();
  AddViews();
  el=document.getElementById("MapLocation");
  el.innerHTML="<span style='font-size:12px;background-color:#111;color:eee;"+
               "border:1px solid grey;position:absolute;"+
               "text-align:center;height:50px;width:300px;"+
               "margin-left:200px;margin-top:100px;padding:50px;'>"+
               "<img src='../images/loading.gif'><br><br>Geo Coding in Progress<br>Please Wait</span>";
  setTimeout(function(){ DisplayTable(); }, 100);
}
function DisplayTable() {
 t = new Table();    // Create New Table Object
 el=document.SelectPeriod;
 sesskeys=el.sesskeys.value;
 theURL="geocod01.php?reportno=5"+
        "&sesskeys="+sesskeys.replace(/ /g,"+")
 var xmlHttp = createHttpObject();
 xmlHttp.open("GET", theURL, false);
 xmlHttp.send();
 if (xmlHttp.responseText!=""&&xmlHttp.status == 200) {
    h = document.getElementsByTagName("head")[0];
    s = document.createElement("script");
    s.type="text/javascript";
    h.appendChild(s);
    s.text=xmlHttp.responseText;
    AddRows();
 }
 ShowList();
 DisplayMap();
}
function ShowList() {
 var OS = "<dl>";
 LinkFlag=false;
 for(var i = 0; i < t.rows.length; i++) {
   sAlpha=getMarkerColor(i);
   OS += "<dt onclick='LinkPatient(\""+i+"\");'>" +
         "<span style='padding:5px;display:inline-block;vertical-align:top'><img "+
         "src='https://maps.gstatic.com/mapfiles/marker"+sAlpha+".png'></span>"+
         "<span style='width:80%;padding:5px;display:inline-block;vertical-align:top'>"+t.rows[i][2] +
         "<br>"+t.rows[i][3]
   if (t.rows[i][6]=="1") {
      OS += "<span class=InformationIcon title='Partial Address Match\n"+t.rows[i][7]+"'></span>"
   }
   if (!isWhitespace(t.rows[i][8])) {
      OS += " ("+t.rows[i][8]+")"
   }
   OS += "<br>Appointment : "+ t.rows[i][10]+ " at " + t.rows[i][9] + "</span>"+
         "<dt>"
 }
 if (t.rows.length==0) {
    OS+="<dt style='text-align:center;color:darkred;'>"+
        "No Patients Matching."+
        "</dt>";
 }
 OS += "</dl>";
 document.getElementById("TableLocation").innerHTML=OS;
}


function SummaryPage() {
  location.href="outweb02.pbl?reportno=1&template=5" +
                "&frstdate=" + UpdateStatus.sesskeys.value.substr(12,8) +
                "&lastdate=" + UpdateStatus.sesskeys.value.substr(12,8) 
}
function UpdateSlot(A,B,C) {
   UpdateStatus.casekeys.value=A
   LinkURL='patweb90.pbl?reportno=1&template=200'
   DFrameLink(LinkURL,25,50,700,420)
}
function AddViews(){
  if(document.UpdateStatus.othecenc.value=="1") {
     SelectPeriod.viewlink.options[SelectPeriod.viewlink.options.length]=
     new Option("Bulk Contact","14");
  }
}
function getClinicSearchCookie() {
  document.UpdateStatus.clinsrch.value=GetCookieData("clinicSearchPath");
//alert(document.UpdateStatus.clinsrch.value);
  document.cookie="clinicSearchPath=;"
}
function GoClinicSearchPath() {
  if (document.UpdateStatus.clinsrch.value != "unknown") {
    location.href = document.UpdateStatus.clinsrch.value;
  } else {
    GoOutpatientListSTV();
  }
}
</script>
</head>
<body onload='PageLoad(event);InitTable()'>
<table cellspacing=0 cellpadding=1 bgcolor=#CCCCCC border=0 width=100%>
<form name=UpdateStatus action=outweb02.pbl method=post>
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=1>
<input type=hidden name=redirect value="">
<input type=hidden name=updatety value="">
<input type=hidden name=casekeys value="">
<input type=hidden name=sesskeys value="%OUTWEB02.02.004">
<input type=hidden name=sessupdt value="">
<input type=hidden name=bookstat value="">
<input type=hidden name=urnumber value="">
<input type=hidden name=admissno value="">
<input type=hidden name=patfname value="">
<input type=hidden name=dummyadm value="">
<input type=hidden name=dummyclm value="%STANDARD.01.017.CL">
<input type=hidden name=othecenc value="%OUTWEB02.02.051">
<input type=hidden name=othedurn value="%OUTWEB02.02.053">
<input type=hidden name=xocadoct value="%OUTWEB02.02.054">
<input type=hidden name=xocahcp1 value="%OUTWEB02.02.140.056">
<input type=hidden name=xocahcp2 value="%OUTWEB02.02.140.057">
<input type=hidden name=xocahcp3 value="%OUTWEB02.02.140.058">
<input type=hidden name=xocahcp4 value="%OUTWEB02.02.140.059">
<input type=hidden name=clinsrch value="">
<input type=hidden name=othecpmi value="%OUTWEB02.02.058">
</form>

<form name=SelectPeriod action=outweb02.pbl method=get>
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=20>
<input type=hidden name=contview value="%OUTWEB02.02.057">
<input type=hidden name=tablview value="%OUTWEB02.02.044">
<tr><td class=HeadingCell width=10%>
    <img src=../images/ListIcon.gif class=Icon
     onclick='GoClinicSearchPath();'>
    <img src=../images/RefreshIcon.gif class=Icon
     onClick='document.cookie="clinicSearchPath="+escape(document.UpdateStatus.clinsrch.value)+";";location.reload();'></td>
    <td class=HeadingCell align=center>
    Clinic for %OUTWEB02.02.014 (%OUTWEB02.02.018)</td>
    <td class=HeadingCell width=10%></td></tr>
</table>

<table cellspacing=0 cellpadding=1 bgcolor=#CCCCCC border=0 width=100%>
<tr><td width=10% class=DataLabel>Clinic Views</td>
    <td width=35% class=DataField>
    <select name=viewlink onchange="ViewLink(this.value);" >
    <option value=19>Mapping View</option>
    <option value=0>Bookings Details</option>
    <option value=1>Diagnosis Details</option>
    <option value=2>Contact Details</option>
    <option value=3>Update Slots</option>
    <option value=4>Reschedule</option>
    <option value=5>Update All Non Attended</option>
    <option value=6>Update Comments</option>
    <option value=7>Suspend Clinic</option>
    <option value=8>Print Group Labels</option>
    <option value=9>Clinic Usage</option>
    <option value=10>Bulk Attendance</option>
    <option value=11>Bulk Departure</option>
    <option value=17>Bulk Discharge</option>
    <option value=12>Bulk Follow Up</option>
    <option value=13>Confirmed Appointments</option>
    </select></td>
    <td class=DataLabel>Date & Start Time</td>
    <td align=right>
    <input type=button value="<<" class=SmallButton
     onClick='location.href="%OUTWEB02.02.002"'>
    <select name=sesskeys onchange='document.SelectPeriod.submit();'>
    %OUTWEB02.02.003
    </select>
    <input type=button value=">>" class=SmallButton
    onClick='location.href="%OUTWEB02.02.001"'>
    </td></tr>

<tr><td class=DataLabel>Clinic Type</td>
    <td class=DataField>%OUTWEB02.02.027.0</td>
    <td class=DataLabel>Location</td>
    <td class=DataField>%OUTWEB02.02.029.0</td></tr>

<!--
<tr><td class=DataLabel>Session Status</td>
    <td class=DataField>OUTWEB02.02.020.0</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td></tr>

<tr valign=top>
    <td class=DataLabel>Comments</td>
    <td class=DataField>
    OUTWEB02.02.026
    <td class=DataLabel>Instructions
    </td> <td> 
    <b> OUTWEB02.02.028</b> <br></td> </tr> 
<tr><td></td><td>
    <b>OUTWEB02.02.021<br>
       OUTWEB02.02.022 </b> 
    </td></tr>
-->
</form>
</table>

<table width=100% border=1 cellpadding=0 cellspacing=0 style='border:1px solid #ccc;'>
<tr valign=top><td width=30%><div id="TableLocation"></div></td>
    <td><div id=MapLocation style='width:100%;height:600px;'></div></td>
</table>


