<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src=../js/cliweb0101.js></script>

<script type="text/javascript">
  function submitAlert(){
  if(checkAlphanumSpec3NoClear(document.AddForm.alcommnt)==false){
     return;
  }
    if(document.AddForm.admalert.value=="1"){
       document.AddForm.nextpage.value="6"
    }
    if(!checkAlertValid(AddForm)){
       return;
    }
    if(!CheckDateRules()){
       return false;
    } 
    if(validateMandatory(AddForm)) {
      document.AddForm.submit();
    }
  }

function CheckDateRules(){

  var start = new Date(document.AddForm.alert003.value);
  var middle = new Date(document.AddForm.alert008.value);
  var end = new Date(document.AddForm.alert011.value);
  var errorString = ""

  if((start>middle)&&(start!=NaN)&&(middle!=NaN)){
      errorString+="Next Review Date cannot be before Date Activated\n";
  }
  if((start>end)&&(start!="")&&(end!="")){
      errorString+="End Date cannot be before Date Activated\n";
  }
  if((middle>end)&&(middle!="")&&(end!="")){
      errorString+="End Date cannot be before Next Review Date\n";
  }
  
  if(errorString!=""){
     alert("Please fix the following before proceeding:\n"+errorString);
     return false;
  }
  return true;
}

function checkComments() {
  if (document.getElementById('alert002').value.substr(11,1)==1) {
     document.getElementById('alcommnt').className="Readonly";
     document.getElementById('alcommnt').readOnly=true;
     document.getElementById('alcommnt').value="";
  } else {
     document.getElementById('alcommnt').className="";
     document.getElementById('alcommnt').readOnly=false;
  }
}
function filterCatwn() {
 filterInd1 = document.getElementById('alert001').value.substr(1,1);  // Ind 1
 p=document.AddForm;
 if(p.alert005.readOnly==true) {
   return;
 }
 filterCatCodeList(p.alert005,"1",filterInd1,"2");
}

//TSK 0891498
function checkInfectionStatusInd(indicator){
  var val = indicator.value.substring(14,15);
  if(val == 'S'){
    document.getElementById('alert005').className="Mandatory";
  } else {
    document.getElementById('alert005').className="";
  }
}

</script>

%START.OF.PAGE
</HEAD>
<body onload="PageLoad(event);filterCatwn();">

<span class=DFrameTitleBar>
  <img align="right" alt="Exit" class="MenuIcon" 
   src="../images/ExitIcon.gif" onclick="DFrameExit();">
  Add Alert
</span>

<form name=AddForm method=post action=cliweb01.pbl style="margin:0">
  <input type=hidden name=reportno value="1">
  <input type=hidden name=template value="002">
  <input type=hidden name=updttype value="A">
  <input type=hidden name=urnumber value="%CLIWEB01.01.003">
  <input type=hidden name=admissno value="%CLIWEB01.01.081">
  <input type=hidden name=alert001 id=alert001 value="%CLIWEB01.01.107">
  <input type=hidden name=nextpage value="5">
  <input type=hidden name=admalert value="%CLIWEB01.01.119">

  <table align=center cellspacing=0 cellpadding=1 width=95% border=0>

  <tr>
    <td class=DataLabel>Alert</td>
    <td>
      <select name=alert002 id=alert002 title="Alert Code" class=Mandatory
        onchange="checkComments();checkInfectionStatusInd(this);">
        <option selected></option>
        %CLIWEB01.01.113  
      </select>
    </td>
  </tr>

<tr><td class=DataLabel>Alert Requested By</td>
    <td colspan=4><input type=text name=alert012 id=alert012 size=10 maxlength=8
        title="Alert Requested By"
        onblur="ValidateHCP(18,12,alert012,d_alert012);">
       <input type=text size=35 name=d_alert012 id=d_alert012
        class=Readonly readonly>
    <img src=../images/SearchIcon.gif class=Icon
     onclick="HCPSearchFrame(alert012,d_alert012,7);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(alert012,d_alert012);">
    </td></tr>

  <tr>
    <td class=DataLabel>Date Activated</td>
    <td>
      <input type=text name=alert003 size=12 maxlength=12 
       class="Mandatory PastDate"
       title="Date Activated">
      <img src=../images/DateTimeStamp.gif class=Icon 
       onclick="SetCurrentDateTime(AddForm.alert003,null);">
      <img src=../images/DateLookup.gif class=Icon
       onclick="DateLookupFrame(AddForm.alert003);">
    </td>
  </tr>

  <tr>
    <td class=DataLabel>Next Review Date</td>
   <td>
      <input type=text name=alert008 size=12 maxlength=12
       title="Next Review Date" class="Date">
      <img src=../images/DateTimeStamp.gif class=Icon 
       onclick="SetCurrentDateTime(AddForm.alert008,null);">
      <img src=../images/DateLookup.gif class=Icon 
       onclick="DateLookupFrame(AddForm.alert008);">
    </td>
  </tr>

  <tr>
    <td class=DataLabel>End Date</td>
    <td>
      <input type=text name=alert011 size=12 maxlength=12 title="End Date"
      class="PastDate">       
      <img src=../images/DateTimeStamp.gif class=Icon 
       onclick="SetCurrentDateTime(AddForm.alert011,null);">
      <img src=../images/DateLookup.gif class=Icon 
       onclick="DateLookupFrame(AddForm.alert011);">
    </td>
  </tr>

  <tr>
    <td class=DataLabel>%STANDARD.01.017.wn</td>
    <td>
      <select name=alert005 id=alert005 title="%STANDARD.01.017.wn">
        <option></option>
        %CLIWEB01.01.104.2
      </select>
    </td>
  </tr>

  <tr>
    <td class=DataLabel>Site</td>
    <td>
      <input type=text name=alert007 size=20 maxlength=20>
    </td>
  </tr>

  <tr valign=top>
    <td class=DataLabel>Severity Level</td>
    <td>
      <select name=alert006>
        <option value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
      </select>
    </td>
  </tr>

  <tr>
    <td colspan=2 class=DataLabel>Reaction Comment/lab. No</td>
  </tr>

  <tr>
    <td colspan=2 align=center>
    <textarea wrap=hard name=alcommnt id=alcommnt rows=4 cols=70 title=Comment> %CLIWEB01.01.111</textarea>
    </td>
  </tr>

  <tr>
    <td colspan=2 align=center>
      <br>
      <input type=button name=formactn value=Add class="button" id="addbtn"
       onclick="tempDisable(this);submitAlert();">
      <input type=button value=Close class="button" onclick="DFrameClose()">
    </td>
  </tr>
</table>
</form>

