<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="">
<meta name="CrossBrowser" content="true">
<script language="javascript" src="../js/allweb03.js"></script>
<script type="text/javascript">
function removeReferralDestination(code)
{
 DeleteForm.diagcode.value = code.replace(/ /g,"");

 if(confirm("Are you sure you want to Delete?"))
           SubmitHiddenNew(DeleteForm);
}

function sendReferralDestinationToParentFrame()
{
 var updateSACFlag = parent.document.getElementById("refrflag");

 if(updateSACFlag)
 {
   itemExistInCollection("btnReferralDestination",REFERRALDESTINATION);
   DFrameExit();
 }
 else
   DFrameExitRefresh();
}

function itemExistInCollection(id,variable)
{
  var btn = parent.document.getElementById(id);

  if(btn)
  {
    if(variable==1)
      btn.style.color = "red";
    else
      btn.style.color = "black";
  }
}

function getDeptcodeQueryString()
{
  UpdateForm.deptcode.value = getQueryString("deptcode");
  AddForm.deptcode.value =  UpdateForm.deptcode.value;
  DeleteForm.deptcode.value =  UpdateForm.deptcode.value;
//
  p=UpdateForm;
  validateCatCode(p.cat_CG,p.deptcode,p.dummy,p.deptindi);
  UpdateForm.deptindi.value = "   " + UpdateForm.deptindi.value;
  AddForm.deptindi.value =  UpdateForm.deptindi.value;
  DeleteForm.deptindi.value =  UpdateForm.deptindi.value;
  if(UpdateForm.vinaherr.value == "1") {  // VINAH error correction
    return;
  }
  if(UpdateForm.deptindi.value.substr(10,1)=="O") { // SOP
    filterCatCodeList(UpdateForm.diagcode,"3","O","1"); // Exclude from SOP
  } else {
    filterCatCodeList(UpdateForm.diagcode,"2","O","1"); // Remove SOP options
  }
  if(UpdateForm.deptindi.value.substr(10,1)=="T") { // TCP
    document.UpdateForm.diagdate.className="PastDate";
    document.UpdateForm.diagcode.className="";
  }
}

function addReferralDestination()
{
  if(validateMandatory(UpdateForm))
  { 
    var index = UpdateForm.diagcode.selectedIndex;
    var index2 = UpdateForm.diagcod2.selectedIndex;

    AddForm.diagdate.value = UpdateForm.diagdate.value;
    AddForm.diagcode.value = UpdateForm.diagcode[index].value.substr(0,3);
    AddForm.diagcod2.value = UpdateForm.diagcod2[index2].value.substr(0,3);
    SubmitHiddenNew(AddForm);
  }
}

function valDate(obj,str)
{
 checkDate(obj,str);
}

function openEditDateFrame(code,num)
{
  var admissno = document.getElementById("admissno");
  num = num.replace(/ /g,"+");

  var linkUrl = "allweb02.pbl?reportno=03&template=010&admissno="
                +admissno.value+"&diagcode="+code
                +"&uniqcode="+num+
                "&deptcode="+UpdateForm.deptcode.value;

  displayDiagnosisPopupFrame(linkUrl);

}

function displayDiagnosisPopupFrame(linkUrl)
{
  var left = (document.body.clientWidth-780)/2;
  DFrameLink(linkUrl,25,left,400,250);
}

function setReferralOutPlace() {
    var deptIndicator = parent.document.UpdateForm.deptIndi.value;

    if(typeof deptIndicator != 'undefined') {
      if(deptIndicator.substr(10,1) == "T") {
          document.UpdateForm.diagcod2.className = "Mandatory";
      }else {
          document.UpdateForm.diagcod2.className = "";
      }
    }
}

function PageLoadExtended(event)
{
  PageLoad(event);
  getDeptcodeQueryString();
  setReferralOutPlace();
  setRMRefOutServiceTypeDate();
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoadExtended(event);">
<script>
REFERRALDESTINATION="%ALLWEB02.03.613";
</script>
<span class=DFrameTitleBar>
<img border=0 align=right src=../images/ExitIcon.gif onclick="sendReferralDestinationToParentFrame();">
Referral Out Service Types
</span>
<div id=PageBodySection>
<form id=AddForm name=AddForm action="allweb02.pbl" method=post
 onsubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=009>
<input type=hidden name=updatety value="X">
<input type=hidden name=nextpage value=0>
<input type=hidden name=redirect value="">
<input type=hidden id=admissno name=admissno value="%ALLWEB02.03.081" />
<input type=hidden name=deptcode value="" />
<input type=hidden name=diagcode value="" />
<input type=hidden name=diagcod2 value="" />
<input type=hidden name=diagdate value="" />
<input type=hidden name=deptindi value="" />
</form>
<form id=DeleteForm name=DeleteForm action="allweb02.pbl" method=post
 onsubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=009>
<input type=hidden name=updatety value="Y">
<input type=hidden name=nextpage value=0>
<input type=hidden name=redirect value="">
<input type=hidden name=admissno value="%ALLWEB02.03.081" />
<input type=hidden name=deptcode value="" />
<input type=hidden name=diagcode value="" />
<input type=hidden name=deptindi value="" />
</form>


<form id=UpdateForm name=UpdateForm action="allweb03.pbl" method=post
 onsubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=009>
<input type=hidden name=nextpage value=0>
<input type=hidden name=redirect value="">
<input type=hidden name=urnumber value='%ALLWEB02.03.003'>
<input type=hidden name=admissno value='%ALLWEB02.03.081'>
<input type=hidden name=updatety value="A">
<input type=hidden name=deptcode value="" />
<input type=hidden name=cat_CG value="CG" />
<input type=hidden name=deptindi value="" />
<input type=hidden name=dummy value="" />
<input type=hidden name=vinaherr value="%ALLWEB02.03.826" />

<table align=center cellspacing=0 cellpadding=1 border=1 width=100%>
<tr>
  <td class="HeadingCell">Date</td>
  <td class="HeadingCell">Referral Out Service Type</td>
  <td class="HeadingCell">Referral Place</td>
</tr>
<tr>
<!-- 20191219 CGA ME#77247 Remove input date (value="%STANDARD.01.015") -->
  <td class="DataLabel">
    <input type="text" name="diagdate" id="diagdate"
           size="10" onblur="valDate(this,'Date');" value="" 
           title="Referral Out Service Type Date" 
     />
    <img src=../images/DateTimeStamp.gif class=Icon 
         date=UpdateForm.diagdate
         time=null />
    <img src=../images/DateLookup.gif class=Icon 
         date="UpdateForm.diagdate" />
  </td>
  <td class="DataLabel">
    <select id="diagcode" name="diagcode" class="Mandatory" 
            title="Referral Out Service Type">
    <option></option>
      %ALLWEB02.03.611.9.1.01.2.I
    </select>
  </td>
  <td class="DataLabel">
    <select id="diagcod2" name="diagcod2" 
            title="Referral Place">
    <option></option>
      %ALLWEB02.03.615.2
    </select>
    &nbsp;
    <input type="button" class="button" value="Add" 
           onclick="addReferralDestination();"/>
    <input type="button" class="button" value="Ok" 
           onclick="sendReferralDestinationToParentFrame()"/>
  </td>
</tr>
</table>
</form>

<script type="text/javascript">
function setRMRefOutServiceTypeDate(){
  if(RMRefOutServiceTypeDateDefault){
    document.UpdateForm.diagdate.value="%STANDARD.01.015";
  }

  if(RMRefOutServiceTypeDateMandatory){
    document.UpdateForm.diagdate.className="Mandatory PastDate";
  }
}

</script>




<br />
<div style="height:300px;overflow:auto;">
<table id="referralDestinationTable" border="1" cellspacing="0" width="99%">
<tr><td class="HeadingCell" width="50">Remove</td>
<td class="HeadingCell" width="25">Edit</td>
<td class="HeadingCell" width="50">Code</td>
<td class="HeadingCell">Referral Out Service Type</td>
<td class="HeadingCell" width="50">Code</td>
<td class="HeadingCell">Referral Out Place</td>
<td class="HeadingCell">Date</td>
</tr>
      %ALLWEB02.03.612
</table>
</div>

</div>
