<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript">
function InitTable() {
 document.title="Message Actions List";
//
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//
 t = new Table(1,0,1,"100%","center",35,40);
 t.addColumn("Action Type","String",2,2,"left","MaintenanceIcon.gif","0",70)
 t.addColumn("U/R","String",17,17,"left","","",50)
 t.addColumn("Patient","ImageText",15,15,"left","PatientFolder","18",90,16)
 t.addColumn("Clinic","String",6,6,"left","","",75)
 t.addColumn("Hospital","String",5,5,"left","","",60)
 t.addColumn("Appointment Date","DateTime",7,7,"left","","",80)
 t.addColumn("Action Date","DateTime",9,9,"left","","",80)
 t.addColumn("Message","String",3,3,"left","","",90)
 t.addColumn("Requestor","String",19,19,"left","","",70)
 t.addColumn("App Canc","String",8,8,"left","","",25)
 t.addColumn("Pend Resch","String",12,12,"left","","",25)
 t.addColumn("High Risk","String",10,10,"left","","",25)
 t.addColumn("Action Complete","ImageText",11,11,"left","CommentIcon","14",40,"13")
 AddTableRows();
 TableOutput(0,2);
}

function FilterSubmit() {
  SelectPeriod.submit();
}
function SetList() {
  p=SelectPeriod
  p.filtclty.options.length=1;
  SetClinicType(p.filtclty,p.deftclty.value,p.wbsesit.value);
//
  SetList2();
}
function SetList2() {
  p=SelectPeriod
  p.filtclid.options.length=1;
  SetTypeClinic(p.filtclid,p.deftclid.value,p.wbsesit.value,p.filtclty.value);
}
function ViewComplete(ur,adate,atime,atype,vis) {
linkurl="outweb09.pbl?reportno=03&template=003" +
            "&urnumber=" + ur.replace(/ /g,"+") +
            "&admissno=" + vis.replace(/ /g,"+") +
            "&otdan001=" + ur.replace(/ /g,"+") +
            "&otdan002=" + adate.replace(/ /g,"+") +
            "&otdan003=" + atime.replace(/ /g,"+") +
            "&otdan004=" + atype.replace(/ /g,"+") +
            "&otdan005=" + vis.replace(/ /g,"+") ;
    Left=(document.body.clientWidth-650)/2
    DFrameLink(linkurl,50,Left,650,150)
}
function UpdateAction(ur,adate,atime,atype,vis) {
  if(atype==" 0") {
    linkurl="outweb09.pbl?reportno=01&template=003&returnfl=1" +
            "&urnumber=" + ur.replace(/ /g,"+") +
            "&admissno=" + vis.replace(/ /g,"+") +
            "&otdem001=" + ur.replace(/ /g,"+") +
            "&otdem002=" + adate.replace(/ /g,"+") +
            "&otdem003=" + atime.replace(/ /g,"+") ;
    location.href=linkurl;
  }
  if(atype==" 1" || atype==" 2" || atype==" 3" || atype==" 4" || atype==" 5") {
    linkurl="outweb09.pbl?reportno=03&template=002" +
            "&urnumber=" + ur.replace(/ /g,"+") +
            "&admissno=" + vis.replace(/ /g,"+") +
            "&otdan001=" + ur.replace(/ /g,"+") +
            "&otdan002=" + adate.replace(/ /g,"+") +
            "&otdan003=" + atime.replace(/ /g,"+") +
            "&otdan004=" + atype.replace(/ /g,"+") +
            "&otdan005=" + vis.replace(/ /g,"+") ;
    Left=(document.body.clientWidth-650)/2
    DFrameLink(linkurl,50,Left,650,550)
  }
}
function OPDActionList(ur,vis) {
    linkurl="patweb98.pbl?reportno=01&template=001" +
            "&urnumber=" + ur.replace(/ /g,"+") +
            "&admissno=" + vis.replace(/ /g,"+") 
    location.href=linkurl;
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);SetList();">
<div id=HeadingSection>
<form name=SelectPeriod action=outweb09.pbl method=get style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=1>
<input type=hidden name=viewtype id=viewtype value="%OUTWEB09.04.020">
<input type=hidden name=deftclid id=deftclid value="%OUTWEB09.04.024">
<input type=hidden name=deftclty id=deftclty value="%OUTWEB09.04.025">
<input type=hidden name=wbsesit id=wbsesit value="%STANDARD.01.023">
<input type=hidden name=showflag id=showflag value="1">

<table cellspacing=0 cellpadding=0 border=0 width=100% bgcolor=#cccccc>
<tr><td class=Datalabel>Hospital</td>
    <td class=DataField>
    <select name=filthosp id=filthosp onchange="FilterSubmit();">
     %OUTWEB09.04.019
    </select></td>

    <td class=Datalabel>Clinic Type</td>
    <td class=DataField>
    <select name=filtclty id=filtclty onchange="FilterSubmit();">
    <option value=" ">All</option>
    </select>
    </td>

    <td class=DataLabel align=right>Action Date
    <input type=checkbox name=filtadat id=filtadat value="1"
     onclick="FilterSubmit();">
     Appointment Date
    <input type=checkbox name=filtvdat id=filtvdat value="1"
     onclick="FilterSubmit();">

    <input type=button value="<<" class=SmallButton
     onclick='location.href="%OUTWEB09.04.023"'>
     %OUTWEB09.04.021
    <input type=button value=">>" class=SmallButton
     onclick='location.href="%OUTWEB09.04.022"'>
    <a href='javascript:SelectDateFrame();'>
    <img src="../images/DateLookup.gif" border=0
     alt="Select Date" title="Select Date" align=absmiddle></a>
    <a href='javascript:SelectView("0");'>
    <img src=../images/DayIcon.gif border=0
     alt="View Today" title="View Today" align=absmiddle></a>
    <a href='javascript:SelectView("1");'>
    <img src=../images/WeekIcon.gif border=0 
     alt="View This Week" title="View This Week" align=absmiddle></a>
    <a href='javascript:SelectView("2");'>
    <img src=../images/MonthIcon.gif border=0 
     alt="View This Month" title="View This Month" align=absmiddle></a>
    </td></tr>

<tr><td class=Datalabel>Action Type</td>
    <td class=DataField>
    <select name=filtatyp id=filtatyp onchange="FilterSubmit();">
    <option value="  ">All</option>
    <option value=" 0">PMI Update</option>
    <option value=" 1">Appointment Message</option>
    <option value=" 2">Reschedule Appointment</option>
    <option value=" 3">Cancel Appointment</option>
    <option value=" 4">Pending Reschedule</option>
    <option value=" 5">Close Referral</option>
    </select></td>

    <td class=Datalabel>Clinic Id</td>
    <td class=DataField>
    <select name=filtclid id=filtclid onchange="FilterSubmit();">
    <option value=" ">All</option>
    </select>
    </td>
    <td class=DataField>&nbsp;</td>
    </tr>

<tr><td class=Datalabel>Action Completed</td>
    <td class=DataField>
    <input type=checkbox name=filtcomp id=filtcomp value="1"
     onclick="FilterSubmit();">
    </td>
    <td class=Datalabel>Location</td>
    <td class=DataField>
    <select name=filtloca id=filtloca onchange="FilterSubmit();">
    <option value=" ">All</option>
     %STANDARD.01.007.CT
    </select>
    </td>

    </tr>
</table>
</form>
</div>

<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows() {
%OUTWEB09.04.028
}
//
ActionFilter="%OUTWEB09.04.014"
for (var i =0 ; i < document.SelectPeriod.filtatyp.length; i++) {
 if (document.SelectPeriod.filtatyp.options[i].value==ActionFilter) {
      document.SelectPeriod.filtatyp.selectedIndex=i } };
FiltComp="%OUTWEB09.04.027"
if(FiltComp=="1") {
  document.SelectPeriod.filtcomp.checked=true;
}
///
FiltAdat="%OUTWEB09.04.029"
if(FiltAdat=="1") {
  document.SelectPeriod.filtadat.checked=true;
}
FiltVdat="%OUTWEB09.04.030"
if(FiltVdat=="1") {
  document.SelectPeriod.filtvdat.checked=true;
}
FiltLoca="%OUTWEB09.04.033";
for (var i =0 ; i < document.SelectPeriod.filtloca.length; i++) {
 if (document.SelectPeriod.filtloca.options[i].value.substring(0,3)==FiltLoca) {
      document.SelectPeriod.filtloca.selectedIndex=i } };
</script>
