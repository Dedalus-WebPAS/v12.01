<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript" src="../js/ReportStandard.js"> </script>
<script type="text/javascript">
function addSelection() {
  linkurl="emrweb06.pbl?reportno=06&template=004" +
          "&emres001=" + document.UpdateForm.emres001.value.replace(/ /g,"+") +
          "&emres002=" + document.UpdateForm.emres002.value.replace(/ /g,"+")
  Left=(document.body.clientWidth-550)/2;
  DFrameLink(linkurl,50,Left,550,200);
}
function updateSelection(research,start_date,type,from,to) {
  linkurl="emrweb06.pbl?reportno=06&template=005" +
          "&emres001=" + research.replace(/ /g,"+") +
          "&emres002=" + start_date.replace(/ /g,"+") +
          "&emrsl001=" + research.replace(/ /g,"+") +
          "&emrsl002=" + start_date.replace(/ /g,"+") +
          "&emrsl003=" + type.replace(/ /g,"+") +
          "&emrsl004=" + from.replace(/ /g,"+") +
          "&emrsl005=" + to.replace(/ /g,"+") 
  Left=(document.body.clientWidth-550)/2;
  DFrameLink(linkurl,50,Left,550,200);
}
function InitTable() {
 document.title="Research Project Selection Criteria";
 t = new Table(1,0,1,"100%","center",35,35);    // Create New Table Object
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column,Align
//
 t.addColumn("Selection Type","String",1,1,"left","MaintenanceIcon.gif","0",100)
 t.addColumn("From","String",2,2,"left","","",90)
 t.addColumn("To","String",3,3,"left","","",90)
 t.addColumn("Status","String",4,4,"left","","",90)
//
 AddTableRows()
 TableOutput(0,1)
}
function updateResearch() {
 if(!validateMandatory(UpdateForm)) {
   return;
 }
 if(document.UpdateForm.d_emres004.checked==true) {
   document.UpdateForm.emres004.value="0";
 } else {
   document.UpdateForm.emres004.value="1";
 }
 if(!isWhitespace(UpdateForm.emres003.value)) {
   if(!CheckDateRange(UpdateForm.emres002,UpdateForm.emres003)) {
     return;
   }
 }
 document.UpdateForm.nextpage.value="1";
 document.UpdateForm.redirect.value="emrweb06.pbl?reportno=06&template=003" +
          "&emres001=" + document.UpdateForm.emres001.value.replace(/ /g,"+") +
          "&emres002=" + document.UpdateForm.emres002.value.replace(/ /g,"+")
 
 document.UpdateForm.submit();
}
function listResearch() {
 location.href="emrweb06.pbl?reportno=06&template=001";
}
function generateResearch() { 
 if(!confirm("Are you sure you want to load patient for " +
             "this research project?")) {
   return;
 }
 p=UpdateForm;
 document.GenerateForm.redirect.value="emrweb06.pbl?reportno=06&template=003" +
        "&emres001=" + p.emres001.value.replace(/ /g,"+") +
        "&emres002=" + p.emres002.value.replace(/ /g,"+")
 document.GenerateForm.keystr01.value="1";
 document.GenerateForm.keystr02.value=p.emres001.value
 document.GenerateForm.keystr03.value=SetDateDDMMYYYY(p.emres002.value);
 document.GenerateForm.submit(); 
}
function reGenerateResearch() {
 if(!confirm("Are you sure you want to reset this research project?")) {
   return;
 }
 p=UpdateForm;
 document.GenerateForm.redirect.value="emrweb06.pbl?reportno=06&template=003" +
        "&emres001=" + p.emres001.value.replace(/ /g,"+") +
        "&emres002=" + p.emres002.value.replace(/ /g,"+")
 document.GenerateForm.keystr01.value="2";
 document.GenerateForm.keystr02.value=p.emres001.value
 document.GenerateForm.keystr03.value=SetDateDDMMYYYY(p.emres002.value);
 document.GenerateForm.submit();
}
function deleteResearch() {
 if(confirm("Are you sure you want to delete this research project?")) {
   document.UpdateForm.nextpage.value="1";
   document.UpdateForm.redirect.value="emrweb06.pbl?reportno=06&template=001" 
   document.UpdateForm.updatety.value="D";
   document.UpdateForm.submit();
 }
}
function patientResearch() {
  location.href="emrweb06.pbl?reportno=06&template=006" +
          "&emres001=" + document.UpdateForm.emres001.value.replace(/ /g,"+") +
          "&emres002=" + document.UpdateForm.emres002.value.replace(/ /g,"+")
}
</script>
</head>
%START.OF.PAGE
<body onload=PageLoad(event);InitTable();>
<div id=HeadingSection>
<table cellpadding=3 border=0 width=100%>
<tr><td class=HeadingCell colspan=3 align=center>
     Research Project Selection Criteria</td>
    </tr>
</table>

<form name=UpdateForm method=post action=emrweb06.pbl style="margin:0">
<input type=hidden name=reportno value="6">
<input type=hidden name=template value="003">
<input type=hidden name=updatety value="U">
<input type=hidden name=emres001 value="%EMRWEB06.06.001.1">
<input type=hidden name=emres002 value="%EMRWEB06.06.002"
 title="Research Project Start">
<input type=hidden name=emres004 value="">
<input type=hidden name=nextpage value="">
<input type=hidden name=redirect value="">

<table align=center width=80% border=0>
<tr><td class=DataLabel width=20%>Research Code</td>
    <td class=DataField width=20%>%EMRWEB06.06.001.0</td>
    </tr>

<tr><td class=DataLabel>Research Project Start</td>
    <td class=DataField>%EMRWEB06.06.002</td>
    </tr>

<tr><td class=DataLabel>End Date</td>
    <td><input type=text size=12 name=emres003 class="Date"
         title="End Date" value="%EMRWEB06.06.003">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.emres003>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.emres003>
    </td>
    </tr>

<tr><td class=DataLabel>Active</td>
    <td><input type=checkbox size=12 name=d_emres004 value="0">
    </td>
    </tr>

<tr><td class=DataLabel>Generation Date/Time</td>
    <td class=DataField>%EMRWEB06.06.005 %EMRWEB06.06.006</td>
    </tr>

<tr><td colspan=4 align=center><br>
    <input type=button value="Update" class="button"
     onclick="updateResearch();">
    <input type=button value="Load Patients" class="button"
     onclick="generateResearch();">
    <input type=button value="Reset Project" class="button"
     onclick="reGenerateResearch();">
    <input type=button value="Delete Project" class="button"
     onclick="deleteResearch();">
    <input type=button value="Patients" class="button"
     onclick="patientResearch();">
    <input type=button value="Cancel" class="button"
     onclick="listResearch();">
    </td></tr>
</table>
</form>

<form name=SelectPeriod action=emrweb06.pbl method=get style="margin:0">
<input type=hidden name=reportno value=6>
<input type=hidden name=template value=3>
<input type=hidden name=emres001 value="%EMRWEB06.06.001.1">
<input type=hidden name=emres002 value="%EMRWEB06.06.002">

<table cellpadding=3 bgcolor=#CCCCCC border=0 width=100%>
<tr><td>Selection Type
    <select name=filttype onchange='SelectPeriod.submit();'>
    <option value=" ">All</option>
    %EMRWEB06.06.203.2
    </select>
    </td>
    <td>Status
    <select name=filtstat onchange='SelectPeriod.submit();'>
    <option value=" ">All</option>
    <option value="0">Active</option>
    <option value="1">Inactive</option>
    </select>
    </td>
    <td align=right>
    <input type=button value="Add Selection" class=Button
    onclick="addSelection();">
    </td>
    </tr>
</table>
</form>
</div>
<div id="TableLocation" >
</div>

<script type="text/javascript">
function AddTableRows() {
%EMRWEB06.06.104
}
 FiltStat="%EMRWEB06.06.102";
 for (var i =0 ; i < document.SelectPeriod.filtstat.length; i++) {
  if (document.SelectPeriod.filtstat.options[i].value==FiltStat.substr(0,1)) {
       document.SelectPeriod.filtstat.selectedIndex=i } };
 FiltType="%EMRWEB06.06.103";
 for (var i =0 ; i < document.SelectPeriod.filttype.length; i++) {
  if (document.SelectPeriod.filttype.options[i].value==FiltType.substr(0,2)) {
       document.SelectPeriod.filttype.selectedIndex=i } };
 Status="%EMRWEB06.06.004";
 if(Status!="Inactive") {
   document.UpdateForm.d_emres004.checked=true;
 }
</script>

<form name=GenerateForm method=post action=rshweb02.pbl style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=001>
<input type=hidden name=updttype value="A">
<input type=hidden name=setdfprg value="IBAEMR30">
<input type=hidden name=setdfrep value="01">
<input type=hidden name=schdpgid value="IBAEMR30">
<input type=hidden name=schddesc value="Research Project Visit Selection">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="">
<input type=hidden name=schdprnt value="S  ">
<input type=hidden name=schddate value="%STANDARD.01.015">
<input type=hidden name=schdtime value="%STANDARD.01.016">
<input type=hidden name=keystr01 value="">
<input type=hidden name=keystr02 value="">
<input type=hidden name=keystr03 value="">
<input type=hidden name=keystr04 value="%STANDARD.01.008">
<input type=hidden name=keystr05 value="Y">
<input type=hidden name=keystr06 value="">
</form>
