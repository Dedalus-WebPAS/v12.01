<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language="javascript" src="../js/allweb0604.js"></script>
<script type="text/javascript">
function SubmitHON(){
  f = document.UpdateForm;
  if(!isWhitespace(document.UpdateForm.mhhon006.value)&&
     !isWhitespace(document.UpdateForm.mhhon017.value)) {

    var strtDay = document.UpdateForm.mhhon006.value.substring(0,2);
    var strtMon = document.UpdateForm.mhhon006.value.substring(3,6);
    var strtYear = document.UpdateForm.mhhon006.value.substring(7,11);

    strtMon = GetMonthNumber(strtMon);

    var CollDate = strtYear+strtMon+strtDay;

    strtDay = document.UpdateForm.mhhon017.value.substring(0,2);
    strtMon = document.UpdateForm.mhhon017.value.substring(3,6);
    strtYear = document.UpdateForm.mhhon017.value.substring(7,11);

    strtMon = GetMonthNumber(strtMon);

    var CompDate = strtYear+strtMon+strtDay;

    if (CompDate < CollDate) {
      alert("Completion Date must be equal or after Collection Date.");
      return;
    }
  }
  if(!isWhitespace(document.UpdateForm.mhhon006.value)&&
     !isWhitespace(document.UpdateForm.inpadate.value)) {

    var strtDay = document.UpdateForm.mhhon006.value.substring(0,2);
    var strtMon = document.UpdateForm.mhhon006.value.substring(3,6);
    var strtYear = document.UpdateForm.mhhon006.value.substring(7,11);
    strtMon = GetMonthNumber(strtMon);
    var CollDate = strtYear+strtMon+strtDay;
    var inpadate = document.UpdateForm.inpadate.value;

    if (CollDate < inpadate) {
      alert("Collection Date cannot be before Admission Date.");
      return;
    }
  }
  if(!isWhitespace(document.UpdateForm.mhhon006.value)&&
     !isWhitespace(document.UpdateForm.inpddate.value)) {

    var strtDay = document.UpdateForm.mhhon006.value.substring(0,2);
    var strtMon = document.UpdateForm.mhhon006.value.substring(3,6);
    var strtYear = document.UpdateForm.mhhon006.value.substring(7,11);
    strtMon = GetMonthNumber(strtMon);
    var CollDate = strtYear+strtMon+strtDay;
    var inpddate = document.UpdateForm.inpddate.value;

    if (inpddate < CollDate) {
      alert("Collection Date cannot be After Discharge Date.");
      return;
    }
  }
  if(!isWhitespace(document.UpdateForm.mhhon006.value)&&
     !isWhitespace(document.UpdateForm.alrerdat.value)) {

    var strtDay = document.UpdateForm.mhhon006.value.substring(0,2);
    var strtMon = document.UpdateForm.mhhon006.value.substring(3,6);
    var strtYear = document.UpdateForm.mhhon006.value.substring(7,11);
    strtMon = GetMonthNumber(strtMon);
    var CollDate = strtYear+strtMon+strtDay;

    strtDay = document.UpdateForm.alrerdat.value.substring(0,2);
    strtMon = document.UpdateForm.alrerdat.value.substring(3,6);
    strtYear = document.UpdateForm.alrerdat.value.substring(7,11);
    strtMon = GetMonthNumber(strtMon);
    var DteStart = strtYear+strtMon+strtDay;
    if (CollDate < DteStart) {
      alert("Collection Date cannot be before Referral Start Date...");
      return;
    }
  }
  if(document.UpdateForm.d_mhhon004.checked==true){
     document.UpdateForm.mhhon004.value="1" }
    else {
     document.UpdateForm.mhhon004.value="0" }
  if(document.UpdateForm.d_mhhon015.checked==true){
     document.UpdateForm.mhhon015.value="1" }
    else {
     document.UpdateForm.mhhon015.value="0" }

//T0858390-Start
  document.getElementById('excladom').value='';
  Cathp=document.getElementById("mhhon008"); //Reason for Collection Cat hp
  if (Cathp.value.substring(9,10)=="X"){     //ind7=X - Exclude ADOM rec?
    document.getElementById('excladom').value='Y';
  }
//T0858390-End

  if (!validateMandatory(f)) {return;}

  var i = f.mhhon007.selectedIndex;
  var ind2 = f.mhhon007.options[i].value.substring(4,5);
  if (!CheckMHServiceSettingForUpdate(ind2,f.ptvitype.value)) {
    return;
  }

  f.submit();
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisableADOMSupv();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Update Outcome Measure
</span>
<div id=PageBodySection>
<form name=UpdateForm method=post action=allweb06.pbl style="margin:0">
<input type=hidden name=urnumber value="%ALLWEB06.04.003">
<input type=hidden name=admissno value="%ALLWEB06.04.101">
<input type=hidden name=mhhon001 value="%ALLWEB06.04.101">
<input type=hidden name=mhhon002 value="%ALLWEB06.04.102">
<input type=hidden name=mhhon005 value="0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value="016">
<input type=hidden name=updttype value="U">
<input type=hidden name=dateclsd value="%ALLWEB06.04.214">
<input type=hidden name=alrerdat value="%ALLWEB06.04.519">
<input type=hidden name=inpadate value="%ALLWEB06.04.604">
<input type=hidden name=inpddate value="%ALLWEB06.04.605">
<input type=hidden name=ptvitype id=ptvitype value="%ALLWEB06.04.606">
<input type=hidden name=excladom id=excladom value="">

<table cellspacing=0 cellpadding=1 border=0 width=100%>
  <tr><td class=DataLabel width=30%>%STANDARD.01.017.ss</td>
    <td><select name=mhhon007 class=Mandatory
         title="%STANDARD.01.017.ss">
         <option> </option>
         %ALLWEB06.04.107.2
         </select></td>
   </tr>
  <tr><td class=DataLabel>%STANDARD.01.035.hp</td>
    <td><select name=mhhon008 class=Mandatory id=mhhon008 
         title="%STANDARD.01.035.hp" 
         onchange="DisableADOMSupv();">
         <option></option>
         %ALLWEB06.04.108.2
         </select></td>
   </tr>
    <tr><td class=DataLabel>Collection Date</td>
        <td><input type=text size=12 name=mhhon006 class="Mandatory PastDate" 
             title="Collection Date" value="%ALLWEB06.04.106">
          <img notab src=../images/DateLookup.gif class="Icon"
           onclick="DateLookupFrame(UpdateForm.mhhon006);">
          <img notab src=../images/DateTimeStamp.gif class="Icon"
           onclick="SetCurrentDateTime(UpdateForm.mhhon006,null);">
        </td>
      </tr>

<tr><td class=DataLabel>Responsible Service Team</td>
    <td colspan=5><input type=text name=mhhon010 size=11 maxlength=11 
     title="Responsible Service Team"
     class=Readonly readonly value="%ALLWEB06.04.110.0"
       onblur="validateCode2(7,mhhon010,n_mhhon010)">
       <input type=text name=n_mhhon010 size=42 readonly
        value="%ALLWEB06.04.110.1"
        class=Readonly tabindex=-1 title="Team Description" value="">
       <img src="../images/SearchIcon.gif" class=Icon
        onclick="TeamSearchFrame(UpdateForm.mhhon010,UpdateForm.n_mhhon010);">
        <img src="../images/ClearIcon.gif" class=Icon
        onclick="clrFields(UpdateForm.mhhon010,UpdateForm.n_mhhon010);">
    </td><tr>

<tr><td class=DataLabel>Responsible HCP</td>
    <td><input type=text name=mhhon009 value="%ALLWEB06.04.109.0"
         class=DataField size=10 maxlength=10  
         onchange="UpCase(this);ValidateHCP(18,0,UpdateForm.mhhon009,
                   UpdateForm.doctname);">
        <input type=text name=doctname title="Responsible HCP" readonly
         value="%ALLWEB06.04.109.1">
        <img src="../images/SearchIcon.gif" class=Icon
        onclick="HCPSearchFrame(UpdateForm.mhhon009,UpdateForm.doctname,0);">
        <img src="../images/ClearIcon.gif" class=Icon
        onclick="clrFields(UpdateForm.mhhon009,UpdateForm.doctname);"></td></tr>

<tr><td id=phLabel></td><td id=phData></td></tr>
  
<tr><td class=DataLabel>%STANDARD.01.035.hf</td>
    <td><select name=mhhon022 id=mhhon022 title="%STANDARD.01.035.hf">
         <option> </option>
         %ALLWEB06.04.122.2
         </select></td>
  </tr>

  <tr><td id=csLabel></td><td id=csData></td></tr>
  <tr><td id=rfLabel></td><td id=rfData></td></tr>
  <tr><td id=ceLabel></td><td id=ceData></td></tr>
  <tr><td id=daLabel></td><td id=daData></td></tr>

  <tr><td class=DataLabel>%STANDARD.01.035.ht</td>
    <td><select name=mhhon029 id=mhhon029
         title="%STANDARD.01.035.ht">
         <option> </option>
         %ALLWEB06.04.129.2
         </select></td>
   </tr>
    <tr><td class=DataLabel>Completion Date</td>
        <td><input type=text size=12 name=mhhon017
             title="Completion Date" value="%ALLWEB06.04.117">
          <img notab src=../images/DateLookup.gif class="Icon"
           onclick="DateLookupFrame(UpdateForm.mhhon017);">
          <img notab src=../images/DateTimeStamp.gif class="Icon"
           onclick="SetCurrentDateTime(UpdateForm.mhhon017,null);">
        </td>
      </tr>
  <tr><td class=DataLabel>%STANDARD.01.035.hm</td>
    <td><select name=mhhon030 id=mhhon030
         title="%STANDARD.01.035.hm">
         <option> </option>
         %ALLWEB06.04.130.2
         </select></td>
   </tr>
<tr><td class=DataLabel>Active</td>
    <td><input type=hidden name=mhhon004>
        <input type=checkbox name=d_mhhon004 title="Active" value="1">
    </td></tr>

<tr><td class=DataLabel>Completed</td>
    <td><input type=hidden name=mhhon015>
        <input type=checkbox name=d_mhhon015 title="Active" value="1">
    </td></tr>

    <tr><td align=center colspan=2>
       <input type=button value="Update" class="button" 
        onclick="SubmitHON();">
       <input type=button value=Close class="button"
        onclick="DFrameCloseRefresh()">
     </td></tr>
</table>
</form>
</div>

<span id="csLabel2" style="display:none">
   %STANDARD.01.035.hc
</span>
<span id=csData2 style="display:none"> 
  <select name=mhhon023 id=mhhon023 title="%STANDARD.01.035.hc">
    <option></option>
    %ALLWEB06.04.123.2
  </select>
</span>

<span id="phLabel1" style="display:none">
   Performing HCP
</span>
<span id="phData1" style="display:none">
   <input type=text name=mhhon011 value="%ALLWEB06.04.111.1"
       class=DataField size=10 maxlength=10
       onchange="UpCase(this);ValidateHCP(18,0,UpdateForm.mhhon011,
                   UpdateForm.pdocname);"/>
   <input type=text name=pdocname title="Performing HCP" readonly
       value="%ALLWEB06.04.111.0">
       <img src="../images/SearchIcon.gif" class=Icon
       onclick="HCPSearchFrame(UpdateForm.mhhon011,UpdateForm.pdocname,0);">
       <img src="../images/ClearIcon.gif" class=Icon
       onclick="clrFields(UpdateForm.mhhon011,UpdateForm.pdocname);">
</span>

<span id="rfLabel2" style="display:none">
Referral Mandated/Voluntary<
</span>
<span id="rfData2" style="display:none">
    <input type=radio name=mhhon087 value="M" id=m_mhhon087
     class=Mandatory tabindex=8>Mandated
    <input type=radio name=mhhon087 value="V" id=v_mhhon087
     class=Mandatory tabindex=9>Voluntary
</span>

<span id="ceLabel2" style="display:none">
Co-existing Problems
</span>
<span id="ceData2" style="display:none">
    <input type=radio name=mhhon089 value="1" id=y_mhhon089 class=Mandatory
     tabindex=10>
     Yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <input type=radio name=mhhon089 value="0" id=n_mhhon089 class=Mandatory
     tabindex=11>
     No &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>

<span id="daLabel2" style="display:none">
Number of Days Covered (7-28)
</span>
<span id="daData2" style="display:none">
    <select name=mhhon088 id=mhhon088 title="Number of Days Covered" 
      class=Mandatory tabindex=12>
      <option value=""></option>
      <script type="text/javascript">
        selectVal = "%ALLWEB06.04.195.02.0";
        for(i=7; i<29; i++){
            if(i.toString()==trim(selectVal.toString())){
               document.write("<option value='"+i+"' selected>"+i+" Days</option>");
            }
            else{
               document.write("<option value='"+i+"'>"+i+" Days</option>");
            }
        }
      </script>
    </select>
</span>

<script type=text/javascript>
  ngonone="%ALLWEB06.04.104.0"
  if(ngonone=="1"){
    document.UpdateForm.d_mhhon004.checked="true"}
  ngosupp="%ALLWEB06.04.115.0"
  if(ngosupp=="1"){
    document.UpdateForm.d_mhhon015.checked="true"}

var caths= "%ALLWEB06.04.103.3";
caths = caths.substring(3,4);
hp = document.getElementById("mhhon008");
hf = document.getElementById("mhhon022");

if(caths=="M"){

   for(i=1; i<hp.options.length; i++){
       if(hp.options[i].value.substring(7,8)!="A"){
          hp.options[i] = null;
          i--;
       }
   }
   for(i=1; i<hf.options.length; i++){
       if(hf.options[i].value.substring(7,8)!="A"){
          hf.options[i] = null;
          i--;
       }
   }
}
else if(caths=="A"||caths=="C"||caths=="L"||caths=="O"||caths=="S"){
   for(i=1; i<hp.options.length; i++){
       if(hp.options[i].value.substring(7,8)!="H"){
          hp.options[i] = null;
          i--;
       }
   }
   for(i=1; i<hf.options.length; i++){
       if(hf.options[i].value.substring(7,8)!="H"){
          hf.options[i] = null;
          i--;
       }
   }
}

if(caths!="M"){
   document.getElementById("csLabel").innerHTML = document.getElementById("csLabel2").innerHTML;
   document.getElementById("csData").innerHTML = document.getElementById("csData2").innerHTML;
}
else{
  //T0858390-start
  document.getElementById("rfLabel").innerHTML = document.getElementById("rfLabel2").innerHTML;
  document.getElementById("rfData").innerHTML = document.getElementById("rfData2").innerHTML;
  document.getElementById("ceLabel").innerHTML = document.getElementById("ceLabel2").innerHTML;
  document.getElementById("ceData").innerHTML = document.getElementById("ceData2").innerHTML;
  document.getElementById("daLabel").innerHTML = document.getElementById("daLabel2").innerHTML;
  document.getElementById("daData").innerHTML = document.getElementById("daData2").innerHTML;
  //T0858390-end

  //T0898069
  document.getElementById("phLabel").innerHTML = 
                  document.getElementById("phLabel1").innerHTML;
  document.getElementById("phData").innerHTML = 
                  document.getElementById("phData1").innerHTML;


  rfmv = "%ALLWEB06.04.195.01.0";
  if(trim(rfmv)=="M"){
     document.getElementById("m_mhhon087").checked = true;
  }
  else if(trim(rfmv)=="V"){
     document.getElementById("v_mhhon087").checked = true;
  }

  ceps = "%ALLWEB06.04.195.03.0";
  if(trim(ceps)=="1"){
     document.getElementById("y_mhhon089").checked = true;
  }
  else if(trim(ceps)=="0"){
     document.getElementById("n_mhhon089").checked = true;
  }

//T0858390-Start
//Moved to top of this else statement as the spans are only available after the checkboxes
//are checked, therefore the values will not be displayed when the page loads
//document.getElementById("rfLabel").innerHTML = document.getElementById("rfLabel2").innerHTML;
//document.getElementById("rfData").innerHTML = document.getElementById("rfData2").innerHTML;
//document.getElementById("ceLabel").innerHTML = document.getElementById("ceLabel2").innerHTML;
//document.getElementById("ceData").innerHTML = document.getElementById("ceData2").innerHTML;
//document.getElementById("daLabel").innerHTML = document.getElementById("daLabel2").innerHTML;
//document.getElementById("daData").innerHTML = document.getElementById("daData2").innerHTML;
//T0858390-end
}

</script>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value="004">
<input type=hidden name=urnumber value="%ALLWEB06.04.003">
<input type=hidden name=admissno value="%ALLWEB06.04.081">
<input type=hidden name=MenuType value="%ALLWEB06.04.088">
<input type=hidden name=webuseid value="%STANDARD.01.008">
</form>
