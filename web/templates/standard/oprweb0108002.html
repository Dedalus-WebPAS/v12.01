<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function TranSource (){
  i=document.CancelBooking.cpadm003.selectedIndex;
  ind=document.CancelBooking.cpadm003.options[i].value.substr(5,1)
  if (ind!="X"&&ind!="T"&&ind!="N") {
    document.CancelBooking.cpadm004.className="Readonly";
    document.CancelBooking.cpadm004.value="";
    document.CancelBooking.trandesc.value="";
    document.CancelBooking.cpadm004.readOnly=true;
  } else {
    document.CancelBooking.cpadm004.className="Mandatory";
    document.CancelBooking.cpadm004.readOnly=false;
  }
}
function CheckRemove() {
  if (document.CancelBooking.cpadm002[1].checked) {
     document.CancelBooking.cpadm003.className="Mandatory";
     document.CancelBooking.cpadm003.disabled=false;
     document.CancelBooking.cpadm004.className="";
     document.CancelBooking.cpadm004.readOnly=false;
     document.CancelBooking.cpadm008.className="Mandatory";
     document.CancelBooking.cpadm008.value="";
     document.CancelBooking.cpadm008.readOnly=false;
  } else {
     document.CancelBooking.cpadm003.className="Readonly";
     document.CancelBooking.cpadm003.selectedIndex="0";
     document.CancelBooking.cpadm003.disabled=true;
     document.CancelBooking.cpadm004.className="Readonly";
     document.CancelBooking.cpadm004.readOnly=true;
     document.CancelBooking.cpadm004.value="";
     document.CancelBooking.trandesc.value="";
     document.CancelBooking.cpadm008.className="Readonly";
     document.CancelBooking.cpadm008.value="";
     document.CancelBooking.cpadm008.readOnly=true;
  }
}
function CheckPread() {
  if (document.CancelBooking.pread002[0].checked) {
     document.CancelBooking.pread003.className="Mandatory";
  } else {
     document.CancelBooking.pread003.className="";
  }
}
function setClassType() {
  if (CancelBooking.canadmis.checked == true) {
    CancelBooking.patcanad.className="Mandatory"; }
  else {
    CancelBooking.patcanad.className="Datafield"; }
}
function ChkLock() {
  numlock=parseInt(CancelBooking.sesslock.value)
  daylock=parseInt(CancelBooking.noofdays.value)
  if(numlock>daylock) {
    alert("Session is locked. Cannot Cancel patient");
    DFrameExit()
   }
  if(!isWhitespace(CancelBooking.chkprept.value)) {
    alert("Patient has Usage Details. Cannot Cancel patient");
    DFrameExit()
   }
}
function formSubmit() {
  CaseList=GetContentCookie("CasePath");
  if (CaseList!="unknown") {
     CancelBooking.redirect.value=CaseList;
  }
  CancelBooking.submit(); 
}
function ChkCancelled() {
  if(document.CancelBooking.d_opdastat.value=="Cancelled") {
    document.getElementById("bookhd").innerHTML = "";
    document.getElementById("booking").innerHTML = "";
    document.getElementById("adjusttitleDIV").innerHTML = "";
    document.getElementById("adjustfieldDIV").innerHTML = "";
    document.getElementById("waiting").innerHTML = "";
    document.getElementById("preadmission").innerHTML = "";
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ChkLock();ChkCancelled();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Cancel Theatre Booking
</span>

<form name=CancelBooking method=post action=oprweb01.pbl
 onsubmit="return validateMandatory(this);" style="margin:0">
  <input type=hidden name=reportno value=13>
  <input type=hidden name=template value=1>
  <input type=hidden name=casekeys value="%OPRWEB01.08.001">
  <input type=hidden name=nextpage value="0">
  <input type=hidden name=redirect value="%OPRWEB01.08.002.oprweb01.03.003">
  <input type=hidden name=chkblock value="0">
  <input type=hidden name=sesslock value="%OPRWEB01.08.368">
  <input type=hidden name=noofdays value="%OPRWEB01.08.006">
  <input type=hidden name=chkprept value="%OPRWEB01.08.007">
  <input type=hidden name=opdea031 value="%STANDARD.01.013">
  <input type=hidden name=d_opdastat id=d_opdastat value="%OPRWEB01.08.207">

<table width="95%" cellpadding=0 cellspacing=0 border=0 align=center>
<tr><td colspan=2>
  <table width=100%>
<tr><td class=DataLabel>Theatre Cancellation Reason</td>
    <td><select name=patcanth class=Mandatory title="Reason for Cancellation">
        <option></option>
        %OPRWEB01.08.004.9.1.03.2.T
        </select></td></tr>

<tr><td><div id=bookhd></div></td>
    <td><div id=booking></div></td>
    <td class=DataLabel></td>
    <td class=DataField></td>
    </tr>

<!--
<tr><td class=DataLabel>Cancel Admission Booking</td>
    <td><input type=checkbox name=canadmis value=1 onclick="setClassType();">
        </td></tr>
-->

<tr><td class=DataLabel>
    <div id=adjusttitleDIV>Adjust Subsequent Start Times
    </div></td>
    <td><div id=adjustfieldDIV>
    <input type=checkbox name=adjstart value=1 >
    </div></td>
    <td class=DataLabel></td>
    <td class=DataField></td>
    </tr>
</table>
</td></tr>
<tr><td colspan=2><div id=waiting></div></td></tr>
<tr><td colspan=2><div id=preadmission></div></td></tr>
<!--</table>-->

<tr><td align="center" colspan=2>
    <br>
    <input type="button" id="opr01sub" class="button" value="Ok"
    onclick="tempDisable(this);formSubmit();">
    <input type="button" class="button" value="Cancel" 
    onclick="DFrameClose()">
</td></tr>
</table>
</form>

<div name=bookhead id=bookhead style="display: none;" class="DisplayLocation">
<td class=DataLabel>Booking Cancellation Reason</td>
</div>

<div name=bookdets id=bookdets style="display: none;" class="DisplayLocation">
<td><select name=patcanad title="Booking Cancellation Reason"
         class=Mandatory>
         <option></option>
         %OPRWEB01.08.512.2
         </select></td>
</div>

<div name=waitdets id=waitdets style="display: none;" class="DisplayLocation">
<table width=100%>
  <tr><td width=50% class=DataLabel>Do you want to return this patient to
                          the Waiting List? </td>
      <td>Yes<input type=radio name=cpadm002 value="Y" checked
              onclick="CheckRemove();">
          No <input type=radio name=cpadm002 value="N" 
              onclick="CheckRemove();">
      </td></tr>

  <tr><td class=DataLabel>Removal Reason </td>
      <td align=left>
      <select name="cpadm003" title="Removal Reason" class=Readonly disabled
               onchange="TranSource();">
        <option> </option>
        %STANDARD.01.007.WR
      </select>
      </td></tr>
    <tr>
      <td class=DataLabel>Transfer Source</td>
      <td><input type="text" size=7 maxlength=5 name=cpadm004 id=cpadm004 
      title="Transfer Source" tabindex=3 readonly class=Readonly
      onchange="validateCode(9,cpadm004,trandesc);">
     <input type=text size=27 name=trandesc notab
      class=Readonly readonly>
     <img src="../images/SearchIcon.gif"
      onClick="TransferSourceFrame(cpadm004,trandesc)"></td>
   </tr>

  <tr><td class=DataLabel>Removal Date</td>
    <td><input type="text" name="cpadm008" id=cpadm008 
         title="Removal Date" size="12" class=Readonly readonly maxlength="11" 
         onblur="checkDate(this,'Removal Date');">
        <img src=../images/DateTimeStamp.gif class=Icon 
         date="CancelBooking.cpadm008" time=null>
        <img notab src="../images/DateLookup.gif" class="Icon"
         alt="Calendar" date="CancelBooking.cpadm008"></td></tr>
</table>
</div>
<div name=preadmis id=preadmis style="display: none;" class="DisplayLocation">
<table width=100%>
  <tr><td width=50% class=DataLabel>Do you want to cancel the preadmission?</td>
      <td>Yes<input type=radio name=pread002 value="Y" checked
              onclick="CheckPread();">
          No <input type=radio name=pread002 value="N" 
              onclick="CheckPread();">
      </td></tr>

  <tr><td width=50% class=DataLabel>Reason for Patient Cancellation </td>
      <td align=left>
        <select name="pread003" class=Mandatory title="Cancellation Reason">
        <option> </option>
        %STANDARD.01.007.PC
        </select>
      </td></tr>
</table>
</div>

<script type="text/javascript">
  if ( "%OPRWEB01.08.402" == "1")  {
    document.getElementById("waiting").innerHTML=
    document.getElementById("waitdets").innerHTML;
  }
  if ( "%OPRWEB01.08.401" == "1")  {
    document.getElementById("preadmission").innerHTML=
    document.getElementById("preadmis").innerHTML;
  }
  if ( "%OPRWEB01.08.403" == "1")  {
    document.getElementById("bookhd").innerHTML=
    document.getElementById("bookhead").innerHTML;
    document.getElementById("booking").innerHTML=
    document.getElementById("bookdets").innerHTML;
  }
</script>
