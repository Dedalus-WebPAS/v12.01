<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function PostUpd() {
  if(document.UpdateForm.mloln008.value=="0" &&
     document.UpdateForm.mloln009.value=="0" &&
     document.UpdateForm.mloln011.value=="0" &&
     document.UpdateForm.mloln013.value=="0" &&
     document.UpdateForm.mloln015.value=="0") {
     alert("At least one send to field must be Yes.");
     return;
  }
  if(document.UpdateForm.d_mloln017.checked==true) {
     document.UpdateForm.mloln017.value="1";
  } else {
     document.UpdateForm.mloln017.value="0";
  }
  setFormactn('U');
}
function ManMobile(yesno,mobnumb){
  if(yesno.value=="1") {
    mobnumb.className="Mandatory MobilePhone";
    mobnumb.readOnly=false;
    mobnumb.tabIndex="";
    mobnumb.focus();
  } else {
    mobnumb.className="Readonly";
    mobnumb.value="";
    mobnumb.readOnly=true;
    mobnumb.tabIndex=-1;
    yesno.focus();
  }
}
function ShowHosp() {
  if(document.getElementById("ibcnmhos").value == "1") {  
    document.getElementById("HospTitle").innerHTML=
    document.getElementById("ShowHospTitle").innerHTML;
    document.getElementById("HospField").innerHTML=
    document.getElementById("ShowHospField").innerHTML;
  }
}
function CopyLeave() {
  linkurl="comweb09.pbl?reportno=01&template=004" +
          "&mloln001=" + UpdateForm.mloln001.value.replace(/ /g,"+") +
          "&mloln002=" + UpdateForm.mloln002.value.replace(/ /g,"+") +
          "&mloln003=" + UpdateForm.mloln003.value.replace(/ /g,"+") +
          "&mloln004=" + UpdateForm.mloln004.value.replace(/ /g,"+")
  Left=(document.body.clientWidth-450)/2;
  DFrameLink(linkurl,20,Left,450,200);
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ShowHosp();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Update Overdue Leave Notification Setting
</span>
<form name=UpdateForm method=post action=comweb09.pbl style="margin:0">
<input type=hidden name=reportno value="1">
<input type=hidden name=template value="003">
<input type=hidden name=nextpage value="0">
<input type=hidden name=updttype value="">
<input type=hidden name=ibcnmhos id=ibcnmhos
 value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=mloln001 value="%COMWEB09.01.001.1">
<input type=hidden name=mloln002 value="%COMWEB09.01.002.1">
<input type=hidden name=mloln003 value="%COMWEB09.01.003.1">
<input type=hidden name=mloln004 value="%COMWEB09.01.004">
<input type=hidden name=mloln017 value="">

<table align=center width=95% border=0>
<tr><td class=DataLabel><span id="HospTitle"></span></td>
    <td class=DataField><span id="HospField"></span></td>
    </tr>

<tr><td width=25% class=DataLabel>Ward</td>
    <td class=DataField>%COMWEB09.01.002.0</td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.035.TL</td>
    <td class=DataField>%COMWEB09.01.003.0</td>
    </tr>

<tr><td class=DataLabel>Overdue Duration</td>
    <td class=DataField>%COMWEB09.01.004</td>
    </tr>

<tr><td class=DataLabel>Greater than Duration</td>
    <td class=DataField>%COMWEB09.01.005.0
    </td></tr>

<tr><td class=DataLabel colspan=2><hr width=100%></td>
    </tr>

<tr><td class=DataLabel>SMS Message to Send</td>
    <td class=DataField>
    <select name=mloln006 class="Mandatory" title="SMS Message to Send">
    <option value=""></option>
    %COMWEB09.01.109
    </select>
    </td></tr>

<tr><td class=DataLabel>Reminder Number</td>
    <td class=DataField>%COMWEB09.01.007</td>
    </tr>

<tr><td class=DataLabel>Send to Patient and Carer</td>
    <td class=DataField>
    <select name=mloln008 class="Mandatory SelectTny"
     title="Send to Patient and Carer">
    <option value=""></option>
    <option value="0">No</option>
    <option value="1">Yes</option>
    </select>
    </td></tr>

<tr><td class=DataLabel>Send to Ward Staff</td>
    <td class=DataField>
    <select name=mloln009 class="Mandatory SelectTny"
     title="Send to Ward Staff" onchange="ManMobile(this,UpdateForm.mloln010);">
    <option value=""></option>
    <option value="0">No</option>
    <option value="1">Yes</option>
    </select>&nbsp;&nbsp;
    <input type=text name=mloln010 class=Readonly readonly tabindex=-1
     title="Send to Ward Staff Mobile Number" size=23 maxlength=20
     value="%COMWEB09.01.010">
    </td></tr>

<tr><td class=DataLabel>Send to Supervisor</td>
    <td class=DataField>
    <select name=mloln011 class="Mandatory SelectTny"
     title="Send to Supervisor" onchange="ManMobile(this,UpdateForm.mloln012);">
    <option value=""></option>
    <option value="0">No</option>
    <option value="1">Yes</option>
    </select>&nbsp;&nbsp;
    <input type=text name=mloln012 class=Readonly readonly tabindex=-1
     title="Send to Supervisor Mobile Number" size=23 maxlength=20
     value="%COMWEB09.01.012">
    </td></tr>

<tr><td class=DataLabel>Send to Manager</td>
    <td class=DataField>
    <select name=mloln013 class="Mandatory SelectTny"
     title="Send to Manager" onchange="ManMobile(this,UpdateForm.mloln014);">
    <option value=""></option>
    <option value="0">No</option>
    <option value="1">Yes</option>
    </select>&nbsp;&nbsp;
    <input type=text name=mloln014 class=Readonly readonly tabindex=-1
     title="Send to Manager Mobile Number" size=23 maxlength=20
     value="%COMWEB09.01.014">
    </td></tr>

<tr><td class=DataLabel>Send to Other</td>
    <td class=DataField>
    <select name=mloln015 class="Mandatory SelectTny"
     title="Send to Other" onchange="ManMobile(this,UpdateForm.mloln016);">
    <option value=""></option>
    <option value="0">No</option>
    <option value="1">Yes</option>
    </select>&nbsp;&nbsp;
    <input type=text name=mloln016 class=Readonly readonly tabindex=-1
     title="Send to Other Mobile Number" size=23 maxlength=20
     value="%COMWEB09.01.016">
    </td></tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    </tr>

<tr><td class=DataLabel>Inactive</td>
    <td class=DataField>
    <input type=checkbox name=d_mloln017 title="Inactive" value="1">
    </td></tr>
</table>

<table align=center width=95% border=0>
<tr><td colspan=2 align=center><br>
    <input type=button value="Update" class="button" id="com09upd"
     onclick="tempDisable(this);PostUpd();">
    <input type=button value="Delete" class="button" id="com09del"
     onclick="tempDisable(this);setFormactn('D');">
    <input type=button value="Cancel" class="button"
     onclick="DFrameCloseRefresh();">
    </td></tr>
<tr><td colspan=2 align=center>
    <input type=button value="Copy" class="button" id="com09upd"
     onclick="CopyLeave();">
    </td></tr>
</table>
</form>

<span id="ShowHospTitle" style="display:none">
Hospital
</span>

<span id="ShowHospField" style="display:none">
%COMWEB09.01.001.0
</span>

<script type="text/javascript">
  SMS="%COMWEB09.01.006.1";
  for (var i=0; i < document.UpdateForm.mloln006.length; i++) {
   if (document.UpdateForm.mloln006.options[i].value==SMS){
       document.UpdateForm.mloln006.selectedIndex=i;
   }
  }
  SendPC="%COMWEB09.01.008.1";
  for (var i=0; i < document.UpdateForm.mloln008.length; i++) {
   if (document.UpdateForm.mloln008.options[i].value==SendPC){
       document.UpdateForm.mloln008.selectedIndex=i;
   }
  }
  SendWS="%COMWEB09.01.009.1";
  for (var i=0; i < document.UpdateForm.mloln009.length; i++) {
   if (document.UpdateForm.mloln009.options[i].value==SendWS){
       document.UpdateForm.mloln009.selectedIndex=i;
   }
  }
  ManMobile(UpdateForm.mloln009,UpdateForm.mloln010);
  SendSup="%COMWEB09.01.011.1";
  for (var i=0; i < document.UpdateForm.mloln011.length; i++) {
   if (document.UpdateForm.mloln011.options[i].value==SendSup){
       document.UpdateForm.mloln011.selectedIndex=i;
   }
  }
  ManMobile(UpdateForm.mloln011,UpdateForm.mloln012);
  SendMan="%COMWEB09.01.013.1";
  for (var i=0; i < document.UpdateForm.mloln013.length; i++) {
   if (document.UpdateForm.mloln013.options[i].value==SendMan){
       document.UpdateForm.mloln013.selectedIndex=i;
   }
  }
  ManMobile(UpdateForm.mloln013,UpdateForm.mloln014);
  SendOth="%COMWEB09.01.015.1";
  for (var i=0; i < document.UpdateForm.mloln015.length; i++) {
   if (document.UpdateForm.mloln015.options[i].value==SendOth){
       document.UpdateForm.mloln015.selectedIndex=i;
   }
  }
  ManMobile(UpdateForm.mloln015,UpdateForm.mloln016);
  Inactive="%COMWEB09.01.017.1";
  if(Inactive=="1") {
    document.UpdateForm.d_mloln017.checked=true;
  }
</script>
