<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/allweb03.js></script>
<script type="text/javascript">
function AttendanceMessage() {
  alert("Attendance Details have been Updated. Use Supervisor Update to remove Attendance Details.");
}
function checkLastCon() {
   if (!isWhitespace(document.getElementById("alref006").value)) {
    document.AddForm.checkbx3.checked=true;
    manReasonforClosure();
  }
}

function ShowHCPfields() {
  if(document.AddForm.hcpchbox.checked==true){
    document.getElementById("AddHCP1TitleDIV").innerHTML=
    document.getElementById("AddHCP1TitleSPAN").innerHTML;
    document.getElementById("AddHCP1FieldDIV").innerHTML=
    document.getElementById("AddHCP1FieldSPAN").innerHTML;

    document.getElementById("AddHCP2TitleDIV").innerHTML=
    document.getElementById("AddHCP2TitleSPAN").innerHTML;
    document.getElementById("AddHCP2FieldDIV").innerHTML=
    document.getElementById("AddHCP2FieldSPAN").innerHTML;

    document.getElementById("AddHCP3TitleDIV").innerHTML=
    document.getElementById("AddHCP3TitleSPAN").innerHTML;
    document.getElementById("AddHCP3FieldDIV").innerHTML=
    document.getElementById("AddHCP3FieldSPAN").innerHTML;

    document.getElementById("AddHCP4TitleDIV").innerHTML=
    document.getElementById("AddHCP4TitleSPAN").innerHTML;
    document.getElementById("AddHCP4FieldDIV").innerHTML=
    document.getElementById("AddHCP4FieldSPAN").innerHTML;
  } else {
    document.getElementById("AddHCP1TitleDIV").innerHTML="";
    document.getElementById("AddHCP1FieldDIV").innerHTML="";

    document.getElementById("AddHCP2TitleDIV").innerHTML="";
    document.getElementById("AddHCP2FieldDIV").innerHTML="";

    document.getElementById("AddHCP3TitleDIV").innerHTML="";
    document.getElementById("AddHCP3FieldDIV").innerHTML="";

    document.getElementById("AddHCP4TitleDIV").innerHTML="";
    document.getElementById("AddHCP4FieldDIV").innerHTML="";
  }
}
function manReasonforClosure() {
  if(document.AddForm.checkbx3.checked==true){
    document.getElementById("alref006").className="Mandatory SelectBig";
    document.getElementById("RFCTitleSPAN").style.display="";
    document.getElementById("RFCFieldSPAN").style.display="";
    document.getElementById("RFCFieldSPAN").innerHTML=
    document.getElementById("RFCFieldSPANReasonFClosure").innerHTML;
  } else {
    document.AddForm.alref006.className="SelectBig";
    document.AddForm.alref006.selectedIndex="0";
    document.getElementById("RFCTitleSPAN").style.display="none";
    document.getElementById("RFCFieldSPAN").style.display="none";
    document.getElementById("RFCFieldSPAN").innerHTML="";
  }
}
function PackComments(){
AddForm.alenc107.value=AddForm.comments.value.substring(0,80);
AddForm.alenc108.value=AddForm.comments.value.substring(80,160);
}
function GetBookings() {
//  if(document.AddForm.alcndevp.value=="1") {
//    document.getElementById("EventProgramLabel").innerHTML=
//    document.getElementById("ShowEventProgramLabel").innerHTML
//    document.getElementById("EventProgramField").innerHTML=
//    document.getElementById("ShowEventProgramField").innerHTML
//  }
//  if(document.AddForm.alcndoos.value=="1") {
//   document.getElementById("OccasionOfServiceLabel").innerHTML=
//   document.getElementById("ShowOccasionOfServiceLabel").innerHTML
//   document.getElementById("OccasionOfServiceField").innerHTML=
//   document.getElementById("ShowOccasionOfServiceField").innerHTML
//  }
  if(!isWhitespace(AddForm.bulkenck.value)) {
    p=parent
    if(p.UpdateStatus==undefined) {
      p=parent.parent
    }
    Appointments.innerHTML+="<input type=hidden name=bulkekey" +
                            " value='" + AddForm.bulkenck.value + "'>"
//    document.AddForm.alenc011.value=p.UpdateStatus.othedurn.value;
//
    if (p.SelectPeriod.sesskeys != undefined) {
      EDate=p.SelectPeriod.sesskeys.options[p.SelectPeriod.sesskeys.selectedIndex].text;
    document.AddForm.alenc005.value=EDate.substr(4,11);
    } else {
      EDate=p.SelectPeriod.lastdate.options[p.SelectPeriod.lastdate.selectedIndex].text;
    document.AddForm.alenc005.value=EDate.substr(4,11);
    }

//    if(!isWhitespace(p.UpdateStatus.xocadoct.value)) {
//      document.AddForm.alenc004.value=p.UpdateStatus.xocadoct.value;
//    }
//
    document.AddForm.AddButton.disabled=false;
    return;
  }
  Flag=0
  Appointments.innerHTML="";
  if(parent.AddForm != undefined) {
  for (var e = 0; e < parent.AddForm.elements.length; e++) {
    var el=parent.AddForm.elements[e] ;
    if(el.name.match(/referral/) && el.checked==true) {
    Appointments.innerHTML+="<input type=hidden name=bulkekey" +
                            " value='" + el.value + "'>"
    }
  }
  } else {
    for (var e = 0; e < parent.UpdateForm.elements.length; e++) {
      var el=parent.UpdateForm.elements[e] ;
      if(el.name.match(/referral/) && el.checked==true) {
      Appointments.innerHTML+="<input type=hidden name=bulkekey" +
                              " value='" + el.value + "'>"
      }
    }
  }
//  document.AddForm.alenc011.value=parent.AddForm.othedurn.value;
//
  Edate=parent.SelectPeriod.sesskeys.options[parent.SelectPeriod.sesskeys.selectedIndex].text;
  document.AddForm.alenc005.value=Edate.substr(4,11);
  if(!isWhitespace(parent.SelectPeriod.xocadoct.value)) {
//    document.AddForm.alenc004.value=parent.SelectPeriod.xocadoct.value;
  }
//
  document.AddForm.AddButton.disabled=false;
}
function AddEncounter() {
//  if(document.AddForm.checkbx3.checked==true){
//    if(confirm("Would you like to return to the patient's Patient " +
//               "Referral List to close the referral?")){
//      document.AddForm.redirect.value="allweb03.pbl?reportno=01&template=003";
//      document.AddForm.nextpage.value="1";
//           if (parent.name=="PopUpFrame") {
//             document.AddForm.nextpage.value="7";
//         }
//    }
//  }
  if(!validateContactTime()) { return; }
  if(!checkFutureContactTime()) { return; }
  getCheckInTimeCookie();
  getTimeSeenCookie();
//  getDepartureTimeCookie();
  SetCookie("DepartmentFieldCookie",'1');

  if (!isWhitespace(document.AddForm.deprtred.value)) {
    SetCookie("DeprtRedCookie",document.AddForm.deprtred.value);
  }

  SubmitHidden(AddForm);
}
function getCookies() {
//  alert(GetCookieData("SlotTimeAllocCookie"));

  if (GetCookieData("SlotTimeAllocCookie")!="unknown") {
    document.AddForm.alenc011.value=
    GetCookieData("SlotTimeAllocCookie");
    document.AddForm.alenc011.value=
    document.AddForm.alenc011.value.replace(/\+/g,'');
    justifyLeft(document.AddForm.alenc011);
  }

  ExpireCookiePath("SlotTimeAllocCookie"); 

//  alert(GetCookieData("SlotDateTimeCookie"));

  if (GetCookieData("SlotDateTimeCookie")!="unknown") {
    document.AddForm.alenc006.value=
    GetCookieData("SlotDateTimeCookie").substr(8,13);
    document.AddForm.alenc006.value=
    document.AddForm.alenc006.value.replace(/\+/g,'');
  }

  ExpireCookiePath("SlotDateTimeCookie");

  if (GetCookieData("DeprtRedCookie")!="unknown") {
    document.AddForm.deprtred.value=GetCookieData("DeprtRedCookie");
  }

  ExpireCookiePath("DeprtRedCookie");

}
function MessageExitRefresh() {
  AttendanceMessage();
  DFrameExitRefresh();
}
</script>
</head>

%START.OF.PAGE
<body onload="PageLoad(event);GetBookings();getCookies();
      ValidateHCP(18,13,document.AddForm.alenc004,document.AddForm.SProvider);
      checkLastCon();">
<span class=DFrameTitleBar>
<img border=0 align=right src=../images/ExitIcon.gif 
 onclick="MessageExitRefresh();">
Add Contact for %ALLWEB03.13.017 %ALLWEB03.13.216 %ALLWEB03.13.217
</span>

<form name=AddForm action="allweb03.pbl" method=post>
<input type=hidden name=reportno value=13>
<input type=hidden name=deptcode value="%ALLWEB03.13.012">
<input type=hidden name=updatety value="A">
<input type=hidden name=flag value="%ALLWEB03.13.023">
<input type=hidden name=alenc107 value="">
<input type=hidden name=alenc108 value="">
<input type=hidden name=bulkenck value="%ALLWEB03.13.030">
<input type=hidden name=alcndevp value="%STANDARD.01.025.106.225.0.1">
<input type=hidden name=alcndoos value="%STANDARD.01.025.106.226.0.1">
<input type=hidden name=redirect value="">
<input type=hidden name=urnumber value="%ALLWEB03.13.015">
<input type=hidden name=admissno value="%ALLWEB03.13.035">
<input type=hidden name=nextpage value="">
<input type=hidden name=enctredr value="1">
<input type=hidden name=urnockie value="">
<input type=hidden name=admnckie value="">
<input type=hidden name=rwnockie value="">
<input type=hidden name=clnockie value="">
<input type=hidden name=caseckie value="">
<input type=hidden name=deprtred value="">
<input type=hidden name=d_otbbcitm value="%ALLWEB03.13.038">
<input type=hidden name=currdate value="">
<input type=hidden name=currtime value="">

<table align=center cellspacing=0 cellpadding=1 border=0 width=100%>
<tr><td>
<div id=Appointments></div>
</td></tr>

<tr>
  <td class=DataLabel>Contact Date</td>
    <td class=DataLabel>
    <input type=text readonly name=alenc005 value=""
     title="Contact Date" class="ReadOnly" Size=12
     onblur="checkDate(this,'Date');">
     Time
    <input type=text size=8 title="Time" value="" class="Mandatory"
     Name=alenc006 tabindex=1>
    <img notab src=../images/DateTimeStamp.gif class="Icon"
         onclick="SetCurrentDateTime(null,AddForm.alenc006);">
    <img src="../images/TimeLookup.gif" class=Icon
     onclick="TimeLookupFrame(AddForm.alenc006);">
   </td>
  <td class=DataLabel>Entered By</td>
  <td>
    <input type=text readonly size=25 name=usnm class="ReadOnly"
     value="%STANDARD.01.009"> 
  </td>
</tr>

<tr><td class=DataLabel>Department</td>
<td><input type=text readonly size=40 name=dept class="ReadOnly"
     value="%ALLWEB03.13.017">
        </td>
    <td class=DataLabel>Linked Visit Number</td>
    <td colspan=3>
    <input type = text size = 20 readonly name=lvis
    value="" class = Readonly>
    </td>
</tr>

<tr><td class=DataLabel>Seen By</td>
    <td class=DataLabel>
      <input type=text name=alenc004 size=10 maxlength=10 class=Mandatory
       onblur="ValidateHCP(18,13,AddForm.alenc004,AddForm.SProvider);" 
       title="Health Care Provider" tabindex=2>
      <input type=text name=SProvider size=25 class=Readonly readonly
        title="Health Care Provider">

      <img src=../images/SearchIcon.gif class=Icon
       onclick="HCPSearchFrame(AddForm.alenc004,AddForm.SProvider,4);" >
      <img src="../images/ClearIcon.gif" class=Icon
       onclick="clrFields(AddForm.alenc004,AddForm.SProvider);">
    </td>
    <td class=DataLabel>Direct Units</td>
    <td class=DataField>
      <input type=text size=12 name=alenc011 maxlength=6
       class=Mandatory title="Direct Units" min=0
       onblur="checkNumber(this);" tabindex=9>
    </td>
</tr>

<tr><td>
      Service Type
    </td>
    <td>
      <select class="Mandatory SelectBig" name=alenc010
       title="Occasion of Service" tabindex=3>
        <option></option>
        %ALLWEB03.13.110.2
      </select>
    </td>

    <td class=DataLabel>Indirect Units</td>
    <td class=DataField>
      <input type=text size=12 name=alenc013 maxlength=6 min=0
       onblur="checkNumber(this);" tabindex=10>
    </td>
</tr>

<tr>
  <td>
    Event Type
  </td>
  <td>
    <select class="Mandatory SelectBig" name=alenc048
     title="Event Type" tabindex=4>
      <option></option>
      %ALLWEB03.13.147. 2.2
    </select>
  </td>
  <td class=DataLabel>Last Contact</td>
  <td class=DataField>
    <input type=checkbox name=checkbx3 value="1" tabindex=11 
     onclick="manReasonforClosure();">
  </td>
</tr>

<tr>
  <td>
    Related Activity
  </td>
  <td>
    <select class="Mandatory SelectBig" name=alenc047
     title="Related Activity" tabindex=5>
      <option></option>
      %ALLWEB03.13.147. 1.4
    </select>
  </td>
  <td>
    <span id="RFCTitleSPAN" style="display:none">
      Reason for Closure
    </span>
  </td>
  <td>
    <span id="RFCFieldSPAN" style="display:none">
    </span>
  </td>
</tr>

<tr>
  <td>
    Event Program
  </td>
  <td>
    <select class="SelectBig" name=alenc079 title="Event Program" tabindex=6>
      <option></option>
      %ALLWEB03.13.147.33.22
    </select>
  </td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.035.zc</td>
    <td DataField>
    <select name=alenc049 class="SelectHugE" tabindex=7
     title="%STANDARD.01.035.zc">
    <option></option>
    %ALLWEB03.13.147. 3.9.2
    </select></td>
    <td class=DataLabel>&nbsp;</td>
    <td DataField>&nbsp;</td>
    </tr>

<tr valign=top><td class=DataLabel>Comments</td>
    <td class=DataField colspan=3>
    <textarea rows=3 cols=60 onblur="PackComments();" name=comments tabindex=8
     onkeydown="LimitText(this,3,160);"></textarea>
    </td>
</tr>
</table>
<div id="HCPcheckbox">
<table align=center cellspacing=0 cellpadding=1 border=0 width=100%>
<tr><td class=DataLabel width=13%>Additional HCP</td>
    <td><input type=checkbox name=addithcp value="1"
         onclick="CheckAddHCP();"></td></tr>
</table>
</div>

<div id=AdditionalHCP></div>

<table align=center cellspacing=0 cellpadding=1 border=0 width=100%>
<tr><td colspan=4 align=center><br>
    <input type=button value="Add" class="button" id="all03a"
     disabled name=AddButton onclick="tempDisable(this);AddEncounter()"
     tabindex=20>
    <input type=button Value="Cancel" class="button" 
     onclick="AttendanceMessage();DFrameCloseRefresh();" tabindex=21>
    </td></tr>
</table>
</form>

<span id="ShowAdditionalHCP" style="display:none;">
<table align=center cellspacing=0 cellpadding=1 border=0 width=100%>
<tr><td class=DataLabel width=15%>Additional HCP 1</td>
    <td><input type=text name=alenc025 size=10 maxlength=10
         title="Additional HCP 1"
         onblur="ValidateHCP(18,0,AddForm.alenc025,AddForm.d_alenc025);">
        <input type=text name=d_alenc025 size=20 class=Readonly readonly
         title="Additional HCP 1">
        <img src=../images/SearchIcon.gif class=Icon
         onclick="HCPSearchFrame(AddForm.alenc025,AddForm.d_alenc025,0);" >
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(AddForm.alenc025,AddForm.d_alenc025);">
    </td>
    <td class=DataLabel width=15%>Additional HCP 2</td>
    <td><input type=text name=alenc026 size=10 maxlength=10
         title="Additional HCP 2"
         onblur="ValidateHCP(18,0,AddForm.alenc026,AddForm.d_alenc026);">
        <input type=text name=d_alenc026 size=20 class=Readonly readonly
         title="Additional HCP 2">
        <img src=../images/SearchIcon.gif class=Icon
         onclick="HCPSearchFrame(AddForm.alenc026,AddForm.d_alenc026,0);" >
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(AddForm.alenc026,AddForm.d_alenc026);">
    </td></tr>

<tr><td class=DataLabel width=15%>Additional HCP 3</td>
    <td><input type=text name=alenc027 size=10 maxlength=10
         title="Additional HCP 3"
         onblur="ValidateHCP(18,0,AddForm.alenc027,AddForm.d_alenc027);">
        <input type=text name=d_alenc027 size=20 class=Readonly readonly
         title="Additional HCP 3">
        <img src=../images/SearchIcon.gif class=Icon
         onclick="HCPSearchFrame(AddForm.alenc027,AddForm.d_alenc027,0);" >
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(AddForm.alenc027,AddForm.d_alenc027);">
    </td>
    <td class=DataLabel width=15%>Additional HCP 4</td>
    <td><input type=text name=alenc028 size=10 maxlength=10
         title="Additional HCP 4"
         onblur="ValidateHCP(18,0,AddForm.alenc028,AddForm.d_alenc028);">
        <input type=text name=d_alenc028 size=20 class=Readonly readonly
         title="Additional HCP 4">
        <img src=../images/SearchIcon.gif class=Icon
         onclick="HCPSearchFrame(AddForm.alenc028,AddForm.d_alenc028,0);" >
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(AddForm.alenc028,AddForm.d_alenc028);">
    </td></tr>
</table>
</span>

<span id="RFCFieldSPANReasonFClosure" style="display:none">
      <select class="SelectBig" name=alref006 id=alref006
       title="Reason for Closure" tabindex=12>
        <option></option>
        %STANDARD.01.007.LL
      </select>
</span>

<script type="text/javascript">
  document.AddForm.lvis.value=document.AddForm.bulkenck.value.substr(8,16);

if(%ALLWEB03.13.400.12!=1){
  document.getElementById("HCPcheckbox").style.display="none";
}
</script>
