<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb04.js"> </script>
<script type="text/javascript">
function DisplayHospitalList() {
  f = document.UpdateForm;
  if (f.ibcnmhos.value==1) {
    if (isWhitespace(f.currhosp.value)) {
      document.getElementById('HospitalList').style.display = "";
      AddClassName(f.hospcods,"Mandatory");
      document.getElementById('HospitalName').style.display = "none";
    }
    else {
      document.getElementById('HospitalName').style.display = "";
      document.getElementById('HospitalList').style.display = "none";
    }
  }
  else {
    document.getElementById('HospitalList').style.display = "none";
    document.getElementById('HospitalName').style.display = "none";
  }
}
function TraySearchFrameClick(f) {
  hospcode = "";
  if (f.ibcnmhos.value==1) {
    if (!isWhitespace(f.currhosp.value)) {
      hospcode = f.currhosp.value;
    }
    else {
      i =  document.getElementById('hospcods').selectedIndex;
      if (i == -1) {
        hospcode = "";
      }
      else {
        hospcode = document.getElementById('hospcods').options[i].value;
      }
      if (isWhitespace(hospcode)) {
        alert('Hospital must be entered for Tray Search')
        return false;
      }
    }
  }

  ShowTraySearchFrame(f.optps002,
                      f.d_optps002,
                      "7",
                      hospcode);
}
function HospitalChanged(f) {
  if (f.ibcnmhos.value==0) {return true;}

  if (!isWhitespace(f.currhosp.value)) {
    hospcode = f.currhosp.value;
  }
  else {
    i =  document.getElementById('hospcods').selectedIndex;
    if (i == -1) {
      hospcode = "";
    }
    else {
      hospcode = document.getElementById('hospcods').options[i].value;
    }
  }

  if (isWhitespace(hospcode)) {
    f.optps002.value = "";
    f.d_optps002.value = "";
    return true;
  }

  return ValidateTrayCode(f);
}
function ValidateTrayCode(f) {
  if (isWhitespace(f.optps002.value)) {
    f.d_optps002.value = "";
    return true;
  }

  hospcode = "";
  if (f.ibcnmhos.value==1) {
    if (!isWhitespace(f.currhosp.value)) {
      hospcode = f.currhosp.value;
    }
    else {
      i =  document.getElementById('hospcods').selectedIndex;
      if (i == -1) {
        hospcode = "";
      }
      else {
        hospcode = document.getElementById('hospcods').options[i].value;
      }
      if (isWhitespace(hospcode)) {
        alert('Hospital must be entered for Tray')
        f.optps002.value = "";
        return false;
      }
    }
  }

  return ValidateTrayHospital(f.optps002,f.d_optps002,hospcode);
}
function btnUpdateClick(f) {
  if (!validateMandatory(f)) {return;}
  if (!ValidateTrayCode(f)) {return;}

  SetupHospCode(f)

  f.updttype.value = "U";
  f.submit();
}
function SetupHospCode(f) {
  hospcode = "";
  if (f.ibcnmhos.value==1) {
    if (!isWhitespace(f.currhosp.value)) {
      hospcode = f.currhosp.value;
    }
    else {
      i =  document.getElementById('hospcods').selectedIndex;
      if (i == -1) {
        hospcode = "";
      }
      else {
        hospcode = document.getElementById('hospcods').options[i].value;
      }
    }
  }
  f.updthosp.value = hospcode;
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisplayHospitalList();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
<script type="text/javascript">document.write(self.document.title);</script>
</span>

<form name=UpdateForm method=post action=oprweb04.pbl>
<input type=hidden name=reportno value="13">
<input type=hidden name=template value="003">
<input type=hidden name=updttype value="">
<input type=hidden name=optps001 value="%OPRWEB04.13.001.1">
<input type=hidden name=ibcnmhos id=ibcnmhos
  value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=currhosp id=currhosp value="%OPRWEB04.13.006.1">
<input type=hidden name=updthosp id=updthosp value="%OPRWEB04.13.006.1">

<table align=center width=95% border=0>
<tr><td>
<table align=center width=100% border=0>
<tr><td class=DataLabel>Specialty</td>
    <td><input type=text name=d_optps001 class=Readonly title="Specialty"
         size=30 maxlength=30 readonly tabindex=-1 value="%OPRWEB04.13.001.0">
    </td></tr>

<tr><td class=DataLabel>Tray Preference</td>
    <td><input type=text name=optps002 id=optps002
         class=Mandatory title="Tray Preference"
         size=15 maxlength=15
         onblur="ValidateTrayCode(document.UpdateForm);"
         value="%OPRWEB04.13.002.0">
        <input type=text name=d_optps002 id=d_optps002
         class=Readonly readonly tabindex=-1
         title="Tray Description" size=30 maxlength=30
         value="%OPRWEB04.13.002.1">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="TraySearchFrameClick(document.UpdateForm);">
    </td></tr>

<tr id=HospitalName>
    <td class=DataLabel>Hospital</td>
    <td>
      <input type=hidden name=hospcode id=hospcode value="%OPRWEB04.13.006.1">
      <input type=text name=hospname class=Readonly readonly
       value="%OPRWEB04.13.006.0" size=35 tabindex=-1>
    </td>
</tr>
<tr id=HospitalList>
    <td class=DataLabel>Hospital</td>
    <td colspan=2>
       <select name=hospcods id=hospcods class="SelectBig"
        title="Hospital"
        onchange="HospitalChanged(document.UpdateForm);">
        <option value="  "></option>
         %OPRWEB04.13.007
       </select>
    </td>
</tr>

<tr><td colspan=2 align=center><br>
<input type=button value="Update" class=button
  onclick="btnUpdateClick(document.UpdateForm);">
<input type=button value="Delete" class=button onclick="setFormactn('D');">
<input type=button value="Cancel" class=button onclick="DFrameCloseRefresh();">
</td></tr>
</table>
</td></tr>
</table>

</form>
