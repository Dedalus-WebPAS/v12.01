<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function SearchCheck() {
  VisitSearchFrame(UpdateForm.urnumber,UpdateForm.linkvist);
}
function UpdateLink() {
 if(validateMandatory(UpdateForm)) {
   document.UpdateForm.submit();
 }
}
//------------------------------------------------------------
// Validate a visit number and check it is for this U/R
//------------------------------------------------------------
function ValidateVisit(ValidateV,ValidateUR,ValidateCase,ReturnName) {
  ReturnFunction="" ;
  ReturnName.value="";
  for (var i=4; i < ValidateVisit.arguments.length; i++) {
    if (typeof(ValidateVisit.arguments[i]) == 'function') {
      ReturnFunction=ValidateVisit.arguments[i] }
    else {
      ValidateVisit.arguments[i].value=""; }  }
  if (isWhitespace(ValidateV.value)) return;;
  var serverURL = "../cgi-bin/oprweb01.pbl?reportno=20&valdcode=" +
                    ValidateV.value.replace(/ /g,"+") +
                    "&valdurno=" + ValidateUR.value.replace(/ /g,"+") +
                    "&valduniq=" + ValidateCase.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    ReturnName.value=ReturnValue[0];
    j=0
    for (var i=4; i < ValidateVisit.arguments.length; i++) {
       if (typeof(ValidateVisit.arguments[i]) != 'function') {
         j++
         ValidateVisit.arguments[i].value=ReturnValue[j] } }
    if (typeof(ReturnFunction) == 'function') {
       ReturnFunction() } }
  else {
    ValidateV.value="";
    ValidateV.focus();;
    return false;}
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Link to Inpatient Admission
</span>
<form name="UpdateForm" action="oprweb01.pbl" method="post" style="margin:0">
<input type="hidden" name="reportno" value="05">
<input type="hidden" name="template" value="021">
<input type="hidden" name="admissno" value="%OPRWEB01.04.081">
<input type="hidden" name="urnumber" value="%OPRWEB01.04.003">
<input type="hidden" name="caseuniq" value="%OPRWEB01.04.110">
<input type="hidden" name="casekeys" value="%OPRWEB01.04.101">
<input type="hidden" name="updttype" value="M">
<input type=hidden name=dummy>
<input type="hidden" name="nextpage" value="6">
<input type="hidden" name="redirect" value="%OPRWEB01.04.001.oprweb06.11.001">
<table width="95%" align=center border="0" cellspacing="0">

<tr><td class=DataLabel>Link to visit</td>
    <td><input type=text size=10 maxlength=8 class="Mandatory DataField"
         Title="Link to Visit" name=linkvist 
          onblur="justifyRight(this);
          ValidateVisit(UpdateForm.linkvist,UpdateForm.urnumber,
                        UpdateForm.caseuniq,UpdateForm.dummy);">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="SearchCheck();" >
        <img src="../images/erase.gif" class=Icon
         onClick="clrFields(UpdateForm.linkvist);">
    </td></tr>

<tr><td align=center colspan=2>
    <input type="button" id="opr01sub" value="OK" class="button" name=OkButton
     onclick="tempDisable(this);UpdateLink();">
    <input type="button" value="Cancel" class="button" name=CanButton
     onclick="DFrameClose()">
    </td></tr>

</table>
</form>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=021>
<input type=hidden name=urnumber value="%OPRWEB01.04.003">
<input type=hidden name=admissno value="%OPRWEB01.04.081">
<input type=hidden name=MenuType value="%OPRWEB01.04.088">
<input type=hidden name=webuseid value="%STANDARD.01.008">
</form>
