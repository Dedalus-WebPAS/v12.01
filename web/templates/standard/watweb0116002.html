<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript"> 
  function UpdateBooking() {
        
   if (validateMandatory(document.UpdateForm)) {
      ans=true;

// Check if dates are before date on list
      var DOLDay  = document.UpdateForm.wattr006.value.substring(0,2);
      var DOLMon  = document.UpdateForm.wattr006.value.substring(3,6);
      var DOLYear = document.UpdateForm.wattr006.value.substring(7,11);
      DOLMon = GetMonthNumber(DOLMon);
      var DOLDate = DOLYear + DOLMon + DOLDay

      var CADDay  = document.UpdateForm.bkrec004.value.substring(0,2);
      var CADMon  = document.UpdateForm.bkrec004.value.substring(3,6);
      var CADYear = document.UpdateForm.bkrec004.value.substring(7,11);
      CADMon = GetMonthNumber(CADMon);
      var CADDate = CADYear + CADMon + CADDay

      var CODDay  = document.UpdateForm.bkrec039.value.substring(0,2);
      var CODMon  = document.UpdateForm.bkrec039.value.substring(3,6);
      var CODYear = document.UpdateForm.bkrec039.value.substring(7,11);
      CODMon = GetMonthNumber(CODMon);
      var CODDate = CODYear + CODMon + CODDay

      var DBDay  = document.UpdateForm.bkrec034.value.substring(0,2);
      var DBMon  = document.UpdateForm.bkrec034.value.substring(3,6);
      var DBYear = document.UpdateForm.bkrec034.value.substring(7,11);
      DBMon = GetMonthNumber(DBMon);
      var DBDate = DBYear + DBMon + DBDay

      if(DOLDate>CADDate){
        alert("Error: Confirmed admission before date on list.")
         ans="false";
      }
      if(DOLDate>CODDate){
        alert("Error: Confirmed operation date is before date on list.")
         ans="false";
      }
      if(DOLDate>DBDate){
        alert("Error: Date booking made is before date on list.")
         ans="false";
      }
      if(CADDate>CODDate){
        alert("Error: Confirmed Operation date is before Confirmed Admission.")
         ans="false";
      }

      if(DBDate>CADDate){
        alert("Error: Date booking made must be before the confirmed admission date.")
         ans="false";
      }
      if(ans==true){
      document.UpdateForm.redirect.value="watweb01.pbl?reportno=16&template=1"+
               "&casekeys=" + PatientLinks.casekeys.value.replace(/ /g,"+");
        document.UpdateForm.submit(); 
      }
  }
}
//
function DeleteBooking() {
if (confirm('This will Delete the booking.\nClick Ok to Continue ?')) {
  UpdateForm.updttype.value="D";
  UpdateForm.submit() }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
    Take Up Bookings
</span>
<table border=0 width="100%" cellspacing="0" cellpadding="1" align=center>
<form name=UpdateForm action="watweb01.pbl" method=post>
<input type=hidden name=reportno value=16>
<input type=hidden name=template value=2>
<input type=hidden name=setbookf value=1>
<input type=hidden name=updttype value=U>
<input type=hidden name=nextpage value=0>
<input type=hidden name=redirect>
<input type=hidden name=casekeys value="%WATWEB01.16.101">
<input type=hidden name=bkrec008 value="S  ">
<input type=hidden name=takeupfl value="1">
<input type=hidden name=admissno value="%WATWEB01.16.401">

<tr><td align=center class=HeadingCell>Update Booking
</td></tr>
</table>
<table border=0 width="95%" cellspacing="0" cellpadding="0" align=center>

<tr><td class=DataLabel>Date on List</td>
    <td class=DataField>
    <input type=text name=wattr006 size=12  value='%WATWEB01.16.109'
     onblur="checkDate(this,'Date');" class=Readonly title="Date on List"
     readonly > </td>
    </select></td> </tr>

<tr><td class=DataLabel>Confirmed Admission Date</td>
    <td class=DataLabel>
    <input type=text name=bkrec004 size=12 tabindex=11
     class=Mandatory value='%WATWEB01.16.406' title="Scheduled Admission Date" 
     checkDate(this,'Date');>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.bkrec004>
    </td></tr>

<tr><td class=DataLabel>Confirmed Operation Date </td>
    <td class=DataLabel colspan=3>
    <input type=text name=bkrec039 size=12 tabindex=13 
     class=Mandatory value='%WATWEB01.16.410' title="Proposed Procedure Date"
     onblur="checkDate(this,'Date');">
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.bkrec039>
    </td></tr>

<tr><td class=DataLabel>Date Booking Keyed</td>
    <td class=DataField>
      <input type=text size=12 name=bkrec034 id=bkrec034 class=Mandatory
       title="Date Booking Keyed" value='%WATWEB01.16.437'>
      <img notab src=../images/DateLookup.gif class=Icon 
       align=absmiddle onclick="DateLookupFrame(bkrec034);">
    </td>
<tr><td class=DataLabel>Cancellation Reason</td>
    <td class=DataField>
    <select name=bkrec009 title="Cancellation Reason">
    <option></option>
      %WATWEB01.16.412.2
    </select></td></tr>
<tr><td>&nbsp;</td></tr>


<tr><td colspan=4 align=center>
    <input type=button value=Ok class="button" tabindex=32
     onclick='UpdateBooking();'>
    <input type=button value=Cancel class="button" tabindex=33
     onclick='DFrameExit();'>
    <input type=button Value="Delete" class="button" onClick="DeleteBooking();">
    </td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%WATWEB01.16.003">
<input type=hidden name=admissno value="%WATWEB01.16.081">
<input type=hidden name=MenuType value="%WATWEB01.16.088">
<input type=hidden name=casekeys value="%WATWEB01.16.101">
</form>
