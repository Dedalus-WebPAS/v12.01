<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/comweb9819.js"></script>
<script type="text/javascript">
function SubmitAdd(){
  if(!validateMandatory(AddForm)){
     return;
  }
  if(document.AddForm.cmpar005.value=="  1") {          // Format date
     document.AddForm.cmpar004.value=
     SetDateYYYYMMDD(document.AddForm.d_cmpar004.value);
  } else if (document.AddForm.cmpar005.value=="  4") {  // Cat Code
    document.AddForm.cmpar004.value=document.AddForm.d_category.value +
                                    document.AddForm.d_cmpar004.value;
  } else if (document.AddForm.cmpar005.value=="  6") {  // Numeric
    justifyRight(document.AddForm.d_cmpar004);
    document.AddForm.cmpar004.value=document.AddForm.d_cmpar004.value;
    justifyRight(document.AddForm.cmpar004);
  } else if (document.AddForm.cmpar005.value=="  7") {
    if (document.AddForm.exceptpb.checked==true) {a="1"}else{a="0"}
    if (document.AddForm.exceptmo.checked==true) {b="1"}else{b="0"}
    if (document.AddForm.excepttu.checked==true) {c="1"}else{c="0"}
    if (document.AddForm.exceptwe.checked==true) {d="1"}else{d="0"}
    if (document.AddForm.exceptth.checked==true) {e="1"}else{e="0"}
    if (document.AddForm.exceptfr.checked==true) {f="1"}else{f="0"}
    if (document.AddForm.exceptsa.checked==true) {g="1"}else{g="0"}
    if (document.AddForm.exceptsu.checked==true) {h="1"}else{h="0"}
    document.AddForm.d_cmpar004.value=a+b+c+d+e+f+g+h;
    document.AddForm.cmpar004.value=document.AddForm.d_cmpar004.value;
  } else {
    document.AddForm.cmpar004.value=document.AddForm.d_cmpar004.value;
  }
  AddForm.submit();
}
function SetFields() {
  NewParameter=document.getElementById('cmpar002');
  if(isWhitespace(NewParameter.value)) {
    document.getElementById('cmpar003').value="";
    document.getElementById('ParameterValue').innerHTML="";
    return;
  }
  SelectOption = NewParameter.value.split("|");
  document.getElementById('cmpar003').value=SelectOption[2];

  document.getElementById('cmpar005').value=SelectOption[1];
  justifyRight(document.AddForm.cmpar005);
  ShowValues(SelectOption[3],SelectOption[4]);
}
function ShowValues(category,defvalue) {
  ParameterType=document.getElementById('cmpar005').value;
  ParameterV=document.getElementById('ParameterValue');
  if(ParameterType =="  0") {
    ParameterV.innerHTML=document.getElementById('ShowTextValue').innerHTML;
    document.AddForm.d_cmpar004.value=defvalue;
  } else if(ParameterType =="  1") {
    ParameterV.innerHTML=document.getElementById('ShowDateValue').innerHTML;
    document.AddForm.d_cmpar004.value=SetDateDDMMMYYYY(defvalue);
  } else if(ParameterType =="  2") {
    ParameterV.innerHTML=document.getElementById('ShowTimeValue').innerHTML;
    document.AddForm.d_cmpar004.value=defvalue;
  } else if(ParameterType =="  3") {
    ParameterV.innerHTML=document.getElementById('ShowHCPValue').innerHTML;
    document.AddForm.d_cmpar004.value=defvalue;
    ValidateHCP(18,0,AddForm.d_cmpar004,AddForm.n_cmpar004);
  } else if(ParameterType =="  4") {
    ParameterV.innerHTML=document.getElementById('ShowCatCodeValue').innerHTML;
    document.AddForm.d_category.value=category;
    SelectOptionsHospCatCode1(AddForm.d_category,AddForm.cmpar001,
                              AddForm.d_cmpar004);
    for (var i=0; i < document.AddForm.d_cmpar004.length; i++) {
     if (document.AddForm.d_cmpar004.options[i].value.substr(0,3)==
         defvalue){
         document.AddForm.d_cmpar004.selectedIndex=i;
     }
    }
  } else if(ParameterType =="  5") {
    ParameterV.innerHTML=document.getElementById('ShowYesNoValue').innerHTML;
    document.AddForm.d_cmpar004.value=defvalue;
  } else if(ParameterType =="  6") {
    ParameterV.innerHTML=document.getElementById('ShowNumericValue').innerHTML;
    document.AddForm.d_cmpar004.value=defvalue;
  } else if(ParameterType =="  7") {
  ParameterV.innerHTML=document.getElementById('ShowDaysOfWeekValue').innerHTML;
  } else if(ParameterType =="  8") {
    ParameterV.innerHTML=document.getElementById('ShowSelectionList').innerHTML;
    parameterName=document.AddForm.cmpar002.value.split("|")[0];
    defaultValue=document.AddForm.cmpar002.value.split("|")[4];
    Type8SelectionList(parameterName,document.AddForm.d_cmpar004,defaultValue);
  } else {
    ParameterV.innerHTML="";
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);AddParameters(document.AddForm.cmpar002);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Add Hospital Parameter
</span>
<form name=AddForm action="comweb98.pbl" method=post style="margin:0">
<input type=hidden name=reportno value=19>
<input type=hidden name=template value=2>
<input type=hidden name=updttype value="A">
<input type=hidden name=ibcnmhos id=ibcnmhos
 value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=cmpar004 value="">
<input type=hidden name=cmpar005 id=cmpar005 maxlength=3 value="">
<input type=hidden name=d_category value="">

<table width=100% cellpadding="0" cellspacing="0" border=0>
<tr><td class=DataLabel><div id="HospLabel"></div></td>
    <td class=DataField><div id="HospField"></div></td></tr>

<tr><td class=DataLabel width=16%>Parameter</td>
    <td class=DataLabel>
    <select name=cmpar002 id=cmpar002 class="Mandatory" title="Parameter"
     onchange="SetFields();">
    <option value=""></option>
    </select>
    </td></tr>

<tr><td class=DataLabel>Description</td>
    <td class=DataLabel>
    <input type=text size=100 maxlength=256 name=cmpar003 id=cmpar003
     title="Description" class="Readonly" readonly>
    </td></tr>

<tr><td class=DataLabel>Value</td>
    <td class=DataField><div id="ParameterValue"></div>
    </td></tr>

<tr><td class=DataLabel>Active</td>
    <td class=DataField><input type=checkbox name=cmpar006 checked
     title="Active" value="0">
    </td></tr>

<tr><td colspan=4 align=center>
    <input type=button class="button" value="Add" id="com98add"
     onclick="tempDisable(this);SubmitAdd();">
    <input type=button value="Cancel" class="button"
     onclick="DFrameExit();">
    </td></tr>
</table>
</form>

<div id="ShowHospLabel" style="display: none">
 Hospital
</div>

<div id="ShowHospField" style="display: none">
 <select name=cmpar001 class="mandatory selectBig" title="Hospital">
 <option value=" ">Default - All Hospitals</option>
  %COMWEB98.19.012
 </select>
</div>

<div id="ShowNoHospField" style="display: none">
 <input type=hidden  name=cmpar001 value=" ">
</div>

<div id="ShowTextValue" style="display: none">
 <input type=text size=100 maxlength=256 name=d_cmpar004
 class="Mandatory" title="Value">
</div>

<div id="ShowDateValue" style="display: none">
 <input type="text" size="12" name="d_cmpar004"
 class="Mandatory Date" title="Date">
 <img notab src="../images/DateLookup.gif" class=Icon
  onclick="DateLookupFrame(AddForm.d_cmpar004);" >
</div>

<div id="ShowTimeValue" style="display: none">
 <input type=text name="d_cmpar004" size=8  class="Mandatory Time"
  value="" title="Time">
 <img notab src=../images/TimeLookup.gif class=Icon
  onclick="TimeLookupFrame(AddForm.d_cmpar004);">
</div>

<div id="ShowHCPValue" style="display: none">
 <input type=text name="d_cmpar004" size=10 maxlength=10 title="HCP Code"
 class=Mandatory
 onchange="ValidateHCP(18,0,AddForm.d_cmpar004,AddForm.n_cmpar004);">
 <input type=text name=n_cmpar004 size=35 readonly title="HCP Name"
 class=Readonly tabindex=-1>
 <img src="../images/SearchIcon.gif" class=Icon
  onclick="HCPSearchFrame(AddForm.d_cmpar004,AddForm.n_cmpar004,0);">
 <img class=Icon src="../images/erase.gif"
     onclick="clrDoc(AddForm.d_cmpar004,AddForm.n_cmpar004);">
</div>

<div id="ShowCatCodeValue" style="display: none">
 <select name=d_cmpar004 class="Mandatory" title="Selection">
 </select>
</div>

<div id="ShowYesNoValue" style="display: none">
 <select name=d_cmpar004 class="Mandatory" title="Yes/No">
 <option value="   "></option>
 <option value="0">No</option>
 <option value="1">Yes</option>
 </select>
</div>

<div id="ShowNumericValue" style="display: none">
 <input type="text" size="14" maxlength="12" class="Mandatory Integer" 
  min=0 max=99999999 title="Number" name=d_cmpar004
  onblur="checkInteger(this,this.title);">
</div>

<div id="ShowDaysOfWeekValue" style="display: none">
  Exclude Pub Holidays <input type=checkbox value=1 name=exceptpb>
  Exclude Mon-Sun<input type=checkbox value=1 name=exceptmo>
  <input type=checkbox value=1 name=excepttu>
  <input type=checkbox value=1 name=exceptwe>
  <input type=checkbox value=1 name=exceptth>
  <input type=checkbox value=1 name=exceptfr>
  <input type=checkbox value=1 name=exceptsa>
  <input type=checkbox value=1 name=exceptsu> 
  <input type=hidden name=d_cmpar004 value="00000000">
</div>

<div id="ShowSelectionList" style="display: none">
 <select name=d_cmpar004 class="Mandatory" title="Value">
 <option value="   "></option>
 </select>
</div>

<script type="text/javascript">
if(document.AddForm.ibcnmhos.value=="1") {
   document.getElementById('HospLabel').innerHTML=
   document.getElementById('ShowHospLabel').innerHTML;
   document.getElementById('HospField').innerHTML=
   document.getElementById('ShowHospField').innerHTML;
} else {
   document.getElementById('HospField').innerHTML=
   document.getElementById('ShowNoHospField').innerHTML;
}
</script>
