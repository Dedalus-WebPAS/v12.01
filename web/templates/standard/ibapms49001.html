<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function checkHosp(){
 p=document.ReportForm
 getPRS2Details(document.getElementById('keyhosp'),p.dummy,p.dummy,
                p.ptcneflg,p.fromdat);
 if (p.ptcnprsm.value=="1" && p.ptcneflg.value=="1") {
    SubmitPage=false
    alert("Errors still exist in the previous run.")
    return;
    }
}
function ReportType() {
 p=document.ReportForm
 if (p.ibcnmhos.value=="1" && p.ptcnprsm.value=="1") {
     document.getElementById('HospitalIDHeading').innerHTML = document.getElementById('HospIDHeading').innerHTML; 
     document.getElementById('HospitalID').innerHTML = document.getElementById('HospID').innerHTML; 
    getPRS2Details(document.getElementById('keyhosp'),p.dummy,p.dummy,
                   p.ptcneflg,p.fromdat);
    if (p.ptcnprsm.value=="1" && p.ptcneflg.value=="1") {
      SubmitPage=false
      alert("Errors still exist in the previous run.")
      return;
    }
 }
 SubmitPage=true
 if(p.ptcneflg.value==1) {
    SubmitPage=false
    alert("Errors still exist in the previous run.") }
}
function ReportSeq() {
  if (ReportForm.keystr06.value==1) {
    document.getElementById('RangeOption').innerHTML=document.getElementById('NameRange').innerHTML }
  else{
     document.getElementById('RangeOption').innerHTML="";
  }
}
function ProcessReport() {
  p=document.ReportForm
  if (p.keystr06.value==1) {
      p.keystr07.value=p.sent.value
      p.keystr08.value="Y"
  } 
  else {
      p.keystr07.value="Y"                       
  } 
  p.fromdat.title="From Date"
  p.keystr03.title="To Date"
  mthnam1=p.fromdat.value.substr(3,3);
  mthnam2=p.keystr03.value.substr(3,3);
  if(mthnam1 != mthnam2){
     if(!confirm("Warning: Not Closed the PRS extract on an end of Month")){
        return;
     }
  }

  SubmitPage=CheckDateRange(p.fromdat,p.keystr03)
  if (SubmitPage) {
    if(p.ibcnmhos.value=="1"  && p.ptcnprsm.value=="1"){
       p.keystr02.value=document.getElementById('keyhosp').value}
    else {
       p.keystr02.value="Y"}
   
    SubmitReport(p) 
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ReportType();ReportLoad();
              document.ReportForm.schddate.focus();ReportSeq();">
<form name=ReportForm method=post action=rshweb02.pbl style="margin:0">
  <input type=hidden name=reportno value=4>
  <input type=hidden name=template value=001>
  <input type=hidden name=updttype value="A">
  <input type=hidden name=setdfprg value="IBAPMS49">
  <input type=hidden name=setdfrep value="01">
  <input type=hidden name=schdpgid value="IBAPMS49">    
  <input type=hidden name=fromdate value="">    
  <input type=hidden name=todate value="">    
  <input type=hidden name=error value="">    
  <input type=hidden name=dummy value="">    
  <input type=hidden name=schddesc value="Process New Run For PRS/2">    
  <input type=hidden name=ptcneflg value="%RSHWEB02.01.118.010.243.1.1">
  <input type=hidden name=ptcnprsm value="%RSHWEB02.01.118.110.247.0.1">
  <input type=hidden name=ibcnmhos value="%RSHWEB02.01.118.000.043.1.1">
  <input type=hidden name=nextpage value="1">
  <input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=1">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>Process New Run For PRS/2</td></tr>
<tr><td>
</table>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text name=schddate size=12 title="Schedule Date"
    value="%STANDARD.01.015"
    onblur="checkDate(this,'Schedule Date');">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schddate">
    Time
    <input type=text name=schdtime size=12 title="Schedule Time"
    value="%STANDARD.01.016">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schddate" time="ReportForm.schdtime">
    <img notab src="../images/TimeLookup.gif" class="Icon" 
     alt="Time Select" time="ReportForm.schdtime">
    </td></tr>
<tr><td class=DataLabel>Printer</td>
    <td><select name=schdprnt title="Printer" class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBAPMS49.01
        </select>
    </td></tr>
<tr><td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy title='Number of Copies' class=Mandatory>
        </select>
    </td></tr>
<tr><td class=DataLabel>Re-schedule Type</td> 
    <td class=DataLabel colspan=3> 
    <select name=schdrdat title="Schedule Type" onchange="SetReportDates();"> 
    <option></option> 
    </select> 
    </td></tr> 
<tr><td class=DataLabel>Re-schedule Until Date</td> 
    <td class=DataLabel colspan=3> 
    <input type=text name=schdrend size=12 
     onblur="checkDate(this,'Re-schedule Until Date');"> 
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schdrend">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schdrend">
    </td></tr>
<tr><td colspan=2 align=center><hr width=80%></td></tr>
   <input type=hidden name=keystr01 value="1">
   <input type=hidden name=keystr02 value="">    
<tr><td> <span id=HospitalIDHeading></span></td>
<td><span id=HospitalID></span>
</td></tr>
<tr><td class=DataLabel width=25%>Date Range</td>
    <td><input type=text size=15 maxlength=12 name=fromdat readonly
    value="%RSHWEB02.01.121">
    To
    <input type=text size=15 maxlength=12 name=keystr03
    onblur="checkDate(this,'Date')" class="Mandatory PastDate" title="End Date">
    <img src="../images/DateTimeStamp.gif"  class="Icon"
     alt="Current" date="ReportForm.keystr03">
    <img src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.keystr03">
    </td></tr>
   <input type=hidden name=keystr04 value=" ">
   <input type=hidden name=keystr05 value="Y">
<tr><td class=DataLabel width=25%>Type</td>
    <td>
   <select name=keystr06 class=Mandatory  title="Type" onchange="ReportSeq();">
    <option value=1>Produce PRS/2 extract file</option>
    </select>
    </td></tr>
   <input type=hidden name=keystr07 value=" ">
   <input type=hidden name=keystr08 value=" ">
   <input type=hidden name=keystr09 value=" ">           
   <input type=hidden name=keystr10 value=" ">           
   <input type=hidden name=keystr11 value=" ">           
<span id=RangeOption></span>
<tr><td align=center colspan=2><br>
    <input type=button value=Ok class="button" onclick='ProcessReport();'>
    <input type=button value=Cancel class="button" 
     onclick='location.href="../lookups/blank.html"' >
    </td></tr>
</table>
</form>

<span id=NameRange style="display:none">
<input type=hidden name=sent value="2"; 
</span>
<span id=HospIDHeading style="display:none;">
    <tr><td class=DataLabel>Hospital ID</td>
</span>
<span id=HospID style="display:none;">
    <td><select name=keyhosp id='keyhosp' title="Hospital ID " 
         onchange="checkHosp();">
    <option value=""></option>
    %RSHWEB02.01.122
    </select>
    </td></tr>
</table>
</span>
