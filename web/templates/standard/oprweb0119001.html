<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript">
function UpdateStartTimes() {
  if (validateMandatory(UpdateForm)) {
    if ((UpdateForm.currcase.value=='  1') && (UpdateForm.opcnastd.value==1)){
      if (!confirm("Warning: This will Update session start time and duration"))
        return;;
    }
    if ((UpdateForm.currcase.value=='  1') && (UpdateForm.opcnasln.value==1)) {
      if (!confirm("Warning: This will Update session start time and end time"))
        return;;
    }
    if (validateSessTimes(UpdateForm.sesskeys,
                          UpdateForm.currcase,
                          UpdateForm.duration)) {
      document.UpdateForm.redirect.value=parent.location.href;
      UpdateForm.submit();
    }
    else {
      return;
    }
  }
}
function validateSessTimes(SessKeys,CurrCase,Duration) {
  if ((isWhitespace(SessKeys.value)) ||
      (isWhitespace(CurrCase.value)) ||
      (isWhitespace(Duration.value))) {
    return;
  }
  var serverURL   = "../cgi-bin/comweb80.pbl?reportno=6" +
                    "&valdcode=" + SessKeys.value.replace(/ /g,"+") +
                    "&currcase=" + CurrCase.value.replace(/ /g,"+") +
                    "&duration=" + Duration.value;
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
    if (ReturnValue[0]==1) {
      if (confirm("Warning: "+ReturnValue[1])) {
        return true;   // Continue dispite Warning message
      }
      else {
        return false;  // Do not Continue after Warning message
      }
    }
    else {
      return true;  // No Error & No Warning from remote script
    }
  }
  else {
    return false;   // Error from remote script
  }
}
</script>
</head>
%START.OF.PAGE
<body  onLoad="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Adjust Start Times for all subsequent bookings
</span>
<form name=UpdateForm action="oprweb01.pbl" method=post style="margin:0">
<input type=hidden name=reportno value=19>
<input type=hidden name=template value=001>
<input type=hidden name=updttype value="S">
<input type=hidden name=sbwindow value=1>
<input type=hidden name=opcnastd value="%OPRWEB01.19.404">
<input type=hidden name=opcnasln value="%OPRWEB01.19.405">
<input type=hidden name=sesskeys value="%OPRWEB01.19.301">
<input type=hidden name=redirect value="">

<table align=center cellspacing=0 cellpadding=3 border=0 width=95%>
<tr><td class=DataLabel>Starting Case Number</td>
    <td><select name=currcase id=currcase class=Mandatory>
          <option></option>
          %OPRWEB01.19.403
        </select>
    </td>
</tr>

<tr><td class=DataLabel>Adjustment for start times </td> 
    <td><input type=text name=duration id=duration size=4 maxlength=4 
         class="Mandatory Integer" title="Adjustment"> minutes </td>
</tr>

<tr><td colspan=2 align=center><br>
      <input type=button id="opr01sub" value="Update" class="button" 
       onclick="tempDisable(this);UpdateStartTimes();">
      <input type=button value="Cancel" class="button" onclick="DFrameExit();">
    </td>
</tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OPRWEB01.19.003">
<input type=hidden name=admissno value="%OPRWEB01.19.081">
<input type=hidden name=casekeys value="%OPRWEB01.19.101">
<input type=hidden name=sesskeys value="%OPRWEB01.19.301">
<input type=hidden name=MenuType value="%OPRWEB01.19.088">
</form>
<script type="text/javascript">
  if (UpdateForm.currcase.length>1) {  
    UpdateForm.currcase.selectedIndex=1;
  }
</script>
