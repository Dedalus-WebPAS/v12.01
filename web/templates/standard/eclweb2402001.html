<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName"    content="NoContextSet.html">
<script type="text/javascript" src="../js/json-viewer.js"></script>
<link rel="stylesheet" href="../html/json-viewer.css" type="text/css">
</head>
<style>
#IMCWJSONHEAD {
  position: absolute;
  z-index: 9;
  background-color: #f1f1f1;
  border: 1px solid #d3d3d3;
  text-align: center;
}

#IMCWJSONDRAG {
  padding: 10px;
  cursor: move;
  z-index: 10;
  background-color: #2196F3;
  color: #fff;
}
</style>
<script type="text/javascript">
function linkInvoice(Invoice,Visittyp,URNumber) {
  document.ShowInvoice.invoicen.value=Invoice;
  document.ShowInvoice.visittyp.value=Visittyp;
  document.ShowInvoice.urnumber.value=URNumber;
  document.ShowInvoice.submit();
}
function getEclipseClaimCookie() {
  document.MiscVars.eclmpath.value=GetCookieData('EclipseIMCClaimPath'); 
  ExpireCookiePath('EclipseIMCClaimPath');
  if (document.MiscVars.eclmpath.value=="unknown") {
    document.MiscVars.eclmpath.value="eclweb24.pbl?reportno=03&template=1" +
                                     "&viewtype=0&exdtblnk=1&invnumbr=" +
                             document.MiscVars.mavinvce.value.replace(/ /g,"+");
  } else {
//  alert(document.MiscVars.eclmpath.value);
//  alert(document.MiscVars.eclmpath.value.search("&invnumbr="));
//  alert(document.MiscVars.eclmpath.value.substr(
//        document.MiscVars.eclmpath.value.search("&invnumbr=")+10,8))

//alert(document.MiscVars.eclmpath.value);

    if (document.MiscVars.eclmpath.value.search("&invnumbr=") == -1 ||
        document.MiscVars.eclmpath.value.substr(
        document.MiscVars.eclmpath.value.search("&invnumbr=")+10,8) !=
        document.MiscVars.mavinvce.value.replace(/ /g,"+")) {
      if (document.MiscVars.eclmpath.value.search("&template=3") == -1 &&
          document.MiscVars.eclmpath.value.search("&template=003") == -1) {
        document.MiscVars.eclmpath.value="eclweb24.pbl?reportno=03&template=1" +
                                         "&viewtype=0&exdtblnk=1&invnumbr=" +
                             document.MiscVars.mavinvce.value.replace(/ /g,"+");
      }
    }
  }
//alert(document.MiscVars.eclmpath.value);
}
function setEclipseClaimCookie() {
  document.cookie = "EclipseIMCClaimPath=" + document.MiscVars.eclmpath.value  + ";"
}
function ProcReportPopupFrame() {
  DFrameStart()

  linkurl="../cgi-bin/eclweb24.pbl?reportno=02&template=003"+
          "&mavbatch="+document.MiscVars.mavbatch.value.replace(/ /g,"+") +
          "&mavinvce="+document.MiscVars.mavinvce.value.replace(/ /g,"+") +
          "&urnumber="+document.PatientLinks.urnumber.value.replace(/ /g,"+") +
          "&uniqnumb="+document.MiscVars.uniqnumb.value.replace(/ /g,"+") +
          "&prhre001="+document.MiscVars.prhre001.value.replace(/ /g,"+") +
          "&prhre002="+document.MiscVars.prhre002.value.replace(/ /g,"+") +
          "&prhre003="+document.MiscVars.prhre003.value.replace(/ /g,"+");
  Left=(document.body.clientWidth-1300)/2
  DFrameLink(linkurl,0,Left,1300,700)
}
function EDIHistoryPopupFrame() {
  DFrameStart()

  linkurl="../cgi-bin/eclweb24.pbl?reportno=02&template=002"+
          "&mavbatch="+document.MiscVars.mavbatch.value.replace(/ /g,"+") +
          "&mavinvce="+document.MiscVars.mavinvce.value.replace(/ /g,"+") +
          "&urnumber="+document.PatientLinks.urnumber.value.replace(/ /g,"+") +
          "&uniqnumb="+document.MiscVars.uniqnumb.value.replace(/ /g,"+") +
          "&prhre001="+document.MiscVars.prhre001.value.replace(/ /g,"+") +
          "&prhre002="+document.MiscVars.prhre002.value.replace(/ /g,"+") +
          "&prhre003="+document.MiscVars.prhre003.value.replace(/ /g,"+");
  Left=(document.body.clientWidth-1000)/2
  DFrameLink(linkurl,100,Left,975,400)
}
function displayExType() {
//    if (document.MiscVars.ecextype.value=="0") {
      HFCCDiv.innerHTML = HealthFundSpan.innerHTML;
//    } else {
//      HFCCDiv.innerHTML = ClaimCodeSpan.innerHTML;
//    } 
}
function JSONPopupFrame() {
  DFrameStart()

  linkurl="../cgi-bin/eclweb24.pbl?reportno=02&template=009"+
          "&mavbatch="+document.MiscVars.mavbatch.value.replace(/ /g,"+") +
          "&mavinvce="+document.MiscVars.mavinvce.value.replace(/ /g,"+") +
          "&urnumber="+document.PatientLinks.urnumber.value.replace(/ /g,"+") +
          "&uniqnumb="+document.MiscVars.uniqnumb.value.replace(/ /g,"+") +
          "&prhre001="+document.MiscVars.prhre001.value.replace(/ /g,"+") +
          "&prhre002="+document.MiscVars.prhre002.value.replace(/ /g,"+") +
          "&prhre003="+document.MiscVars.prhre003.value.replace(/ /g,"+");
  Left=(document.body.clientWidth-1300)/2
  DFrameLink(linkurl,0,Left,1300,1000)
}
function dragElement(elmnt) {
  var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
  if (document.getElementById(elmnt.id + "DRAG")) {
    // if present, the header is where you move the DIV from:
    document.getElementById(elmnt.id + "DRAG").onmousedown = dragMouseDown;
  } else {
    // otherwise, move the DIV from anywhere inside the DIV:
    elmnt.onmousedown = dragMouseDown;
  }

  function dragMouseDown(e) {
    e = e || window.event;
    e.preventDefault();
    // get the mouse cursor position at startup:
    pos3 = e.clientX;
    pos4 = e.clientY;
    document.onmouseup = closeDragElement;
    // call a function whenever the cursor moves:
    document.onmousemove = elementDrag;
  }

  function elementDrag(e) {
    e = e || window.event;
    e.preventDefault();
    // calculate the new cursor position:
    pos1 = pos3 - e.clientX;
    pos2 = pos4 - e.clientY;
    pos3 = e.clientX;
    pos4 = e.clientY;
    // set the element's new position:
    elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
    elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
  }

  function closeDragElement() {
    // stop moving when mouse button is released:
    document.onmouseup = null;
    document.onmousemove = null;
  }
}
function ClaimViewer() {

  if((window.navigator.appName == "Microsoft Internet Explorer" &&
       (document.documentMode || document.compatMode))) {
    alert("Claim Viewer only works with compatibility view off. Please use JSON Details.");
    return;
  }

  if (isWhitespace(document.getElementById("rtvwjson").value)) {
    alert("Claim not available.");
    return;
  }

//  if (document.getElementById("rtvwjson").value.search("Can't")
//      != -1) {
//    alert("Claim not available.");
//    return;
//  }

  try {
    var json = JSON.parse(document.getElementById("rtvwjson").value);
  } catch (e) {
    alert("Claim JSON not viewable. \n" + e);
    return;
  }

  if (IMCWJSON.innerHTML != "" ) {IMCWJSON.innerHTML = ""; return;}

  var jsonViewer = new JSONViewer();

  document.querySelector("#IMCWJSON").appendChild(jsonViewer.getContainer());

  jsonViewer.showJSON(JSON.parse(document.getElementById("rtvwjson").value),
                                -1,2);


}
</script>
%START.OF.PAGE
<body onload="PageLoad(event);displayExType();getEclipseClaimCookie();"
      onunload="setEclipseClaimCookie();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%ECLWEB24.02.003";
PatientVIS="%ECLWEB24.02.081";
PatientNAM="%ECLWEB24.02.002";
PatientSTA="%ECLWEB24.02.086.078";
PatientALT="%ECLWEB24.02.084";
PatientSEX="%ECLWEB24.02.019";
PatientDOB="%ECLWEB24.02.020";
PatientAGE="%ECLWEB24.02.021";
PatientLOC="%ECLWEB24.02.083";
PatientPRI="%ECLWEB24.02.086.066.1";
PatientUNT="%ECLWEB24.02.066.0";
DoctorCOD="%ECLWEB24.02.082.003";
DoctorNAM="%ECLWEB24.02.082.002";
PatientAID="%ECLWEB24.02.086.090";
PatientIND="%ECLWEB24.02.086.091";
PatientCUR="%ECLWEB24.02.086.092";
PatientCLC="%ECLWEB24.02.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%ECLWEB24.02.086.094";
PatientCDM="%ECLWEB24.02.086.095";
PatientVDH="%ECLWEB24.02.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=IMCWJSONHEAD style="background-color: lightblue;">
<table border="1" colspan=0 cellspacing="0" cellpadding="0" >
<tr><td>
<div id=IMCWJSON></div>
</tr></td>
</table>

</div>
<div id=PageBodySection>
<table border=0 width=100% cellspacing="0" cellpadding="1">
<tr><td class=HeadingCell align=center>WebServices IMCW Claim Details</td>
</tr>
</table>
  <table cellspacing="0" cellpadding="1" border="0" width="100%" bgcolor="#CCCCCC">
    <tr><td width="25%" class="DataLabel">Medical Practice</td>
        <td width="25%" class="DataField">%ECLWEB24.02.101.1</td>
        <td class="DataLabel">Patient Indicator</td>
        <td class="DataField">%ECLWEB24.02.103.0</td>
    </tr>

    <tr><td class="DataLabel">Service HCP</td>
        <td class="DataField">%ECLWEB24.02.102.081</td>
        <td class="DataLabel">%STANDARD.01.017.CL</td>
        <td class="DataField">%ECLWEB24.02.229.0</td>
    </tr>

    <tr><td class="DataLabel"><div id=hftitleDIV>Health Fund</div></td>
        <td class="DataField"><div id=hffieldDIV>%ECLWEB24.02.230.1</div></td>
        <td class="DataLabel"></td>
        <td class="DataField"></td>
    </tr>
  </table>
<table border=0 width=100% align=center cellspacing="0" cellpadding="1">
    <tr><td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
    <tr><td width="25%" class="DataLabel">Status</td>
        <td width="25%" class="DataField">%ECLWEB24.02.202</td>
        <td class="DataLabel">Amount Claimed</td>
        <td class="DataField">%ECLWEB24.02.213</td>
    </tr>
    <tr><td class="DataLabel"><div id="HFCCDiv"></div></td>
        <td class="DataField">%ECLWEB24.02.206</td>
        <td class="DataLabel"></td>
        <td class="DataField"></td>
    </tr>
    <tr><td class="DataLabel">Invoice Number</td>
        <td class="DataField">%ECLWEB24.02.207</td>
        <td class="DataLabel" colspan=2><hr></td>
    </tr>
    <tr><td class="DataLabel">Batch Number</td>
        <td class="DataField">%ECLWEB24.02.208</td>
        <td class="DataLabel">Invoice Total</td>
        <td class="DataField">%ECLWEB24.02.214</td>
    </tr>
    <tr><td class="DataLabel">Previous Batch Number</td>
        <td class="DataField">%ECLWEB24.02.209</td>
        <td class="DataLabel">Amount Paid by Patient</td>
        <td class="DataField">%ECLWEB24.02.215</td>
    </tr>
    <tr><td class="DataLabel">Next Batch Number</td>
        <td class="DataField">%ECLWEB24.02.210</td>
        <td class="DataLabel">Amount Paid by Health Fund</td>
        <td class="DataField">%ECLWEB24.02.216</td>
    </tr>
    <tr><td class="DataLabel">Linked Visit Number</td>
        <td class="DataField">%ECLWEB24.02.235</td>
        <td class="DataLabel">Other Amount</td>
        <td class="DataField">%ECLWEB24.02.217</td>
    </tr>
    <tr><td class="DataLabel">Claim Transaction ID</td>
        <td class="DataField">%ECLWEB24.02.211</td>
        <td class="DataLabel">Journal Amount</td>
        <td class="DataField">%ECLWEB24.02.218</td>
    </tr>
    <tr><td class="DataLabel">Fund Transaction ID</td>
        <td class="DataField">%ECLWEB24.02.212</td>
        <td class="DataLabel">Credit Note Amount</td>
        <td class="DataField">%ECLWEB24.02.226</td>
    </tr>
    <tr><td class="DataLabel">&nbsp;</td>
        <td class="DataField">&nbsp;</td>
        <td class="DataLabel">Amount Outstanding</td>
        <td class="DataField">%ECLWEB24.02.201</td>
    </tr>
    <tr><td class="DataLabel" colspan=4><hr></td>
    </tr>
</table>
<table border=0 width=95% align=center cellspacing="0" cellpadding="1">
    <tr>
        <td><div id="PaymentDetailsDiv"></div></td>
        <td></td>
    </tr>
</table>
<table border="0" colspan=0 width="95%" cellspacing="0" cellpadding="0" >
    <tr align="center">
      <td align="center">
         <input type="button" value="Assessment Rep" class="button"
                onclick="ProcReportPopupFrame()">
         <input type="button" value="EDI History" class="button"
                onclick="EDIHistoryPopupFrame();">
      </td>
    </tr>
    <tr>
      <td align="center">
         <input type="button" value="Back to Enquiries" class="button"
                onclick="location.href=document.MiscVars.eclmpath.value;">
         <input type="button" value="Invoice" id=invbtn class="button"
                onclick="tempDisable(this);linkInvoice('%ECLWEB24.02.207','4','%ECLWEB24.02.003');">
      </td>
    </tr>
      <tr>
        <td align="center">
           <input type="button" value="JSON Details" class="Largebutton"
                  onclick="JSONPopupFrame()">
        </td>
      </tr>
      <tr>
        <td align="center">
         <input type="button" value="Close Eclipse Claim" class="Largebutton"
          id="closebut"
                onclick="if (confirm('Confirm Eclipse Claim Close?'))
                {tempDisable(this);CloseEclipseClaim.submit();}">
        </td>
      </tr>
    <tr>
      <td align="center">
         <input type="button" value="Claim Viewer" class="Largebutton"
                onclick="ClaimViewer()">
      </td>
    </tr>
    <tr><td>
        <textarea hidden name=rtvwjson rows=0 cols=0 readonly
         id=rtvwjson
         class="ReadOnly">%ECLWEB24.02.248</textarea>
        </td>
    </tr>
</table>

</div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%ECLWEB24.02.003">
<input type=hidden name=admissno value="%ECLWEB24.02.081">
<input type=hidden name=MenuType value="%ECLWEB24.02.088">
</form>

<form name=MiscVars>
<input type=hidden name=ecextype value="%ECLWEB24.02.205">
<input type=hidden name=paymdate value="%ECLWEB24.02.204">
<input type=hidden name=mavbatch value="%ECLWEB24.02.208">
<input type=hidden name=mavinvce value="%ECLWEB24.02.207">
<input type=hidden name=eclmpath value=" ">
<input type=hidden name=uniqnumb value="%ECLWEB24.02.231">
<input type=hidden name=prhre001 value="%ECLWEB24.02.232">
<input type=hidden name=prhre002 value="%ECLWEB24.02.233">
<input type=hidden name=prhre003 value="%ECLWEB24.02.234">
</form>

<form name="CloseEclipseClaim" method="post" style="margin:0"
      action="eclweb24.pbl">
<input type="hidden" name="urnumber" value="%ECLWEB24.02.003">
<input type="hidden" name="admissno" value="%ECLWEB24.02.081">
<input type="hidden" name="reportno" value="2">
<input type="hidden" name="template" value="001">
<input type="hidden" name="updattyp" value="C">
<input type="hidden" name="redirect">
<input type="hidden" name="nextpage" value="1">
<input type="hidden" name="mavbatch" value="%ECLWEB24.02.208">
<input type="hidden" name="mavinvce" value="%ECLWEB24.02.207">
</form>

<span id="HealthFundSpan" style="display:none">
Health Fund
</span>

<span id="ClaimCodeSpan" style="display:none">
Claim Code
</span>

<span id="PaymentDetailsSpan" style="display:none">
<table width="30%" border="0" cellspacing="0" cellpadding="0">
<tr><td><b>Payment Details</b></td>
    <td></td>
</tr>
<tr><td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr><td class="DataLabel">Amount Paid by Health Fund</td>
    <td class="DataField">%ECLWEB24.02.219</td>
</tr>
<tr><td class="DataLabel">Amount Paid by Medicare</td>
    <td class="DataField">%ECLWEB24.02.228</td>
</tr>
<tr><td class="DataLabel">Payment Date</td>
    <td class="DataField">%ECLWEB24.02.204</td>
</tr>
<tr><td class="DataLabel">Closed With</td>
    <td class="DataField">%ECLWEB24.02.220</td>
</tr>
<tr><td class="DataLabel" colspan=2><hr></td>
</tr>
</table>
</span>

<script type="text/javascript">

    if (!isWhitespace(document.MiscVars.paymdate.value)) {
      PaymentDetailsDiv.innerHTML=PaymentDetailsSpan.innerHTML; 
    }

//    document.CloseEclipseClaim.redirect.value=
//        "eclweb24.pbl?reportno=03&template=001&urnumber=" +
//        document.PatientLinks.urnumber.value.replace(/ /g,"+") +
////        "&admissno=" +
////        document.PatientLinks.admissno.value.replace(/ /g,"+") +
//        "&mavbatch=" +
//        document.MiscVars.mavbatch.value.replace(/ /g,"+") +
//        "&mavinvce=" +
//        document.MiscVars.mavinvce.value.replace(/ /g,"+");

    document.CloseEclipseClaim.redirect.value=location.href;

    if (trim('%ECLWEB24.02.202')=='Waiting') {
      document.getElementById('closebut').disabled=true; 
    }

    if (trim('%ECLWEB24.02.202')=='Ext. Error') {
      document.getElementById('closebut').disabled=true;
    }

    document.getElementById("rtvwjson").style.visibility="hidden";

// Make the DIV element draggable:
    if(!(window.navigator.appName == "Microsoft Internet Explorer" &&
       (document.documentMode || document.compatMode))) {
      dragElement(document.getElementById("IMCWJSONHEAD"));
    }

</script>

<form name=ShowInvoice action=patweb76.pbl method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=updatety value=1>
<input type=hidden name=invoicen value="">
<input type=hidden name=visittyp value="">
<input type=hidden name=cfeetype value="%ECLWEB24.02.227">
<input type=hidden name=urnumber value="%ECLWEB24.02.003">
<input type=hidden name=admissno value="%ECLWEB24.02.081">
<input type=hidden name=norecord value="10">
</form>
