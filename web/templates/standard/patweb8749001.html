<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript" src="../js/patweb87.js"></script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link
//  1 - Value Set ID Name
//  2 - Code
//  3 - Preferred Team
//  4 - Fully Specified Name
//  5 - Active
//---------------------------------------------------------------------------
function InitTable() {
  t = new Table(1,0,2,"100%","center",25,35);
  t.addColumn("Value Set ID","String",1,1,"left","MaintenanceIcon.gif","0",70,"","","");
  t.addColumn("Code","String",2,2,"left","","",70);
  t.addColumn("Preferred Term","String",3,3,"left","","",100);
  t.addColumn("Fully Specified Name","String",4,4,"left","","",100);
  t.addColumn("Active","String",5,5,"left","","",15);

  AddTableRows();
  TableOutput(0,2);    // Order Column,Asc Dsc

}
function SetListHeight() {
  // Resize the sort list height so we have enough room at bottom of screen 
  // for Add button
  var BodyDivision = document.getElementById('BodyDivision');
  var tblAddBtn = document.getElementById('tblAddBtn');
  var rh = tblAddBtn.offsetHeight + 2;  // Add button row height

  BodyDivision.style.height = BodyDivision.offsetHeight - rh + "px";
}
function SubmitSearch() {
  var p = document.SelectCode;
  if (validateMandatory(p)) {
    if (isWhitespace(p.filtvscd.value) && isWhitespace(p.filtvspt.value)) {
      alert("Please fill in either the Code or Key Words Search field");
    } else {
      p.submit();
    }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable();SetListHeight();">
<form name=SelectCode action=patweb87.pbl method=get style="margin:0">
<input type=hidden name=reportno value="49">
<input type=hidden name=template value="001">

<div id=HeadingSection>
<table width="100%" cellpadding=2 cellspacing=0 border=0 bgcolor=#CCCCCC>
<tr><td class=MaintenanceHeading colspan=3>Value Set Code Maintenance</td></tr>
<tr><td colspan=3>&nbsp;</td></tr>
<tr><td align=center colspan=3>
      <table cellpadding=0 cellspacing=0 border=0>
      <tr><td class=DataLabel>Active Status &nbsp;
	  <select name=filtvact>
	    <option value=" ">All</option>
	    <option value="1">Yes</option>
	    <option value="0">No</option>
	  </select>
	  &nbsp;&nbsp;&nbsp; Value Set ID &nbsp;
	  <select name=filtvsid class=Mandatory title="Value Set ID">
	    <option value=" "></option>
	    %PATWEB87.49.006
	  </select>
	</td>
      </tr>
      </table>
  </td>
</tr>
<tr><td align=center>
      <table cellpadding=0 cellspacing=0 border=0>
      <tr><td class=DataField>Code &nbsp;
            <input type=text name=filtvscd id=filtvscd size=31 maxlength=30
             value="%PATWEB87.49.010" onkeyup="clrFields(filtvspt);">
          </td>
          <td style="width:40px">&nbsp;</td>
          <td class=DataField>Enter Key Words for Search &nbsp;
            <input type=text name=filtvspt id=filtvspt size=60
             value="%PATWEB87.49.011" onkeyup="clrFields(filtvscd);">
          </td>
          <td style="width:20px" align=right>&nbsp;</td>
          <td>
            <input type=button class=button value=Search onclick="SubmitSearch();">
          </td>
      </tr>
      </table>
    </td>
</tr>
</table>
</div>

<div id=TableLocation></div>

<table id=tblAddBtn width=100% cellpadding=0 cellspacing=0 border=0 bgcolor=#CCCCCC>
<tr>
  <td align=center>
    <input type=button value=Add class="button"
     onclick="AddDetail49(SelectCode.filtvsid.value);">
  </td>
</tr>
</table>

</form>

<script type="text/javascript">
function AddTableRows() {
  %PATWEB87.49.007.patweb87.49.003
}

Active="%PATWEB87.49.008";
for (var i=0 ; i < document.SelectCode.filtvact.length; i++) {
  if (document.SelectCode.filtvact.options[i].value == Active) {
    document.SelectCode.filtvact.selectedIndex=i;
  } 
};

ValSetID="%PATWEB87.49.009";
for (var i=0 ; i < document.SelectCode.filtvsid.length; i++) {
  if (document.SelectCode.filtvsid.options[i].value == ValSetID) {
    document.SelectCode.filtvsid.selectedIndex=i;
  } 
};
</script>

