<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function AddContact(){
  if(!validateMandatory(AddForm)) {
    return;
  }
  p=document.AddForm;
  if(!CheckDateTimeRange(p.d_adate,p.d_atime,p.pmenc005,p.pmenc006)) {
    alert("Contact date/time can't be prior to admission date/time");
    return;
  }
  if(p.d_astat.value=="3") {
    if(CheckDateTimeRange(p.d_ddate,p.d_dtime,p.pmenc005,p.pmenc006)) {
      alert("Contact date/time can't be after the discharge date/time");
      return;
    }
  }
  SubmitHidden(AddForm);
}
function CheckAddHCP() {
  if(document.AddForm.addithcp.checked==true) {
     document.getElementById("AdditionalHCP").style.display="";
     document.getElementById("AdditionalHCP").innerHTML=
     ShowAdditionalHCP.innerHTML;
  } else {
     document.getElementById("AdditionalHCP").innerHTML="";
    document.getElementById("AdditionalHCP").style.display="none";
  }
}

//BHS Customisation - TSK 0901084
function setLocationCodeMandatory(){
  if(RMLocationCodeMandatory){
    document.AddForm.pmenc007.className="SelectBig Mandatory";
  } else {
  document.AddForm.pmenc007.className="SelectBig";
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);setLocationCodeMandatory();">
<span class=DFrameTitleBar>
<img border=0 align=right src="../images/ExitIcon.gif" class=Icon
     onclick="DFrameExit()">
Add Contact for Inpatient Admission %ALLWEB03.18.081
</span>
<div id=PageBodySection>
<form name=AddForm action="allweb03.pbl" method=post style="margin:0">
<input type=hidden name=reportno value=18>
<input type=hidden name=template value=002>
<input type=hidden name=urnumber value="%ALLWEB03.18.003">
<input type=hidden name=admissno value="%ALLWEB03.18.081">
<input type=hidden name=pmenc001 value="%ALLWEB03.18.081">
<input type=hidden name=updatety value="A">
<input type=hidden name=d_astat value="%ALLWEB03.18.399.020">
<input type=hidden name=d_adate value="%ALLWEB03.18.302">
<input type=hidden name=d_atime value="%ALLWEB03.18.303">
<input type=hidden name=d_ddate value="%ALLWEB03.18.401">
<input type=hidden name=d_dtime value="%ALLWEB03.18.402">

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel width=15%>Contact Date</td>
    <td><input type=text name=pmenc005 id=pmenc005 value="%STANDARD.01.015"
         size=12 title="Contact Date" class="PastDate Mandatory">
         <img src="../images/DateLookup.gif" class=Icon
          onclick="DateLookupFrame(AddForm.pmenc005);">
    Time
    <input type=text size=8 class=Mandatory title="Contact Time"
     name=pmenc006 id=pmenc006 value="%STANDARD.01.016">
    <a href="javascript:SetCurrentDateTime(null,AddForm.pmenc006);">
    <img src="../images/DateTimeStamp.gif" class=Icon></a>
    <a href="javascript:TimeLookupFrame(AddForm.pmenc006);">
    <img src="../images/TimeLookup.gif" class=Icon></a>
    </td>
    <td class=DataLabel width=15%>Entered by</td>
    <td><input type=text name=userid value="%STANDARD.01.009"
         class=ReadOnly readonly>
    </td></tr>

<tr><td class=DataLabel>Health Care Provider</td>
    <td colspan=3>
    <input type=text name=pmenc004 id=pmenc004 size=10 maxlength=10
     class=Mandatory
     onblur="if (checkAlphanumDesc(event,this) != false) {
             ValidateHCP(18,0,AddForm.pmenc004,AddForm.SProvider);}"
     title="Health Care Provider" value="">
    <input type=text name=SProvider id=SProvider size=24
     class=Readonly readonly
     tabindex=-1
     title="Health Care Provider" value="">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="HCPSearchFrame(AddForm.pmenc004,AddForm.SProvider,0);">
    <img src="../images/ClearIcon.gif" class=Icon
     onClick="clrFields(AddForm.pmenc004,AddForm.SProvider);">
    <td></tr>


<tr><td class=DataLabel>Department</td>
    <td class=DataField>
    <select name=pmenc003 id=pmenc003 title="Department"
     class="Mandatory SelectBig"
     onchange="selectOptions('14',AddForm.pmenc003,AddForm.pmenc008);">
      <option></option>
      %ALLWEB03.18.103.2
      </select></td>
    <td class=DataLabel></td>
    <td class=DataField></td>
    </tr>

<tr><td class=DataLabel>Service Type</td>
    <td class=DataField>
    <select name=pmenc008 id=pmenc008 title="Service Type"
      class="Mandatory SelectBig">
      <option></option>
      </select>
    </td>
    <td class=DataLabel></td>
    <td class=DataField></td>
    </tr>

<tr><td class=DataLabel>Direct Minutes</td>
    <td class=DataField>
    <input type=text name=pmenc010 size=8 maxlength=6
     class="Mandatory Integer DefaultBlank"
     title="Direct Minutes" value="">
    </td>
    <td class=DataLabel>Indirect Minutes</td>
    <td class=DataField>
    <input type=text name=pmenc012 size=8 maxlength=6
     class="Integer DefaultBlank"
     title="Indirect Minutes"  value="">
    </td></tr>

<tr><td class=DataLabel>Admission Diagnosis</td>
    <td colspan=3>
    <input type=text name=pmenc039 size=80 maxlength=80
     value="%ALLWEB03.18.321">
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField>
    <select name=pmenc014 class="SelectBig" title="%STANDARD.01.017.CL">
      <option></option>
      %ALLWEB03.18.326.2
      </select>
    </td>
  <!-- CGA 260719 ME#64484 - Location Field Mandatory -->
    <td class=DataLabel>%STANDARD.01.017.LD</td>
    <td class=DataField>
    <select name=pmenc007 id=pmenc007 
            title="%STANDARD.01.017.LD">
      <option></option>
      %ALLWEB03.18.107.2
      </select>
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.OZ</td>
    <td class=DataField>
    <select name=pmenc127 class="SelectBig" 
            title="%STANDARD.01.017.OZ">
      <option></option>
      %ALLWEB03.18.199.029.2
      </select>
    </td>
    <td class=DataLabel></td>
    <td class=DataField>
    </td></tr>
</table>

<div id=AdditionalHCP></div>

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td colspan=4 align=center><br>
    <input type=button name=formactn value="Add" class="button" id=all03sub
     onclick="tempDisable(this);AddContact();">
    <input type=button Value="Cancel" class="button"
     onClick="DFrameClose();">
    </td></tr>
</table>
</form>
</div>

<span id="ShowAdditionalHCP" style="display:none;">
<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel width=15%>Additional HCP 1</td>
    <td><input type=text name=pmenc028 id=pmenc028 size=10 maxlength=10
         title="Additional HCP 1" value="%ALLWEB03.18.128.001"
         onblur="ValidateHCP(18,0,pmenc028,d_pmenc028);">
        <input type=text name=d_pmenc028 id=d_pmenc028 size=20
         class=Readonly readonly
         value="%ALLWEB03.18.128.081" title="Additional HCP 1">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(pmenc028,d_pmenc028,0);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(pmenc028,d_pmenc028);">
    </td>
    <td class=DataLabel width=15%>Additional HCP 2</td>
    <td><input type=text name=pmenc029 id=pmenc029 size=10 maxlength=10
         title="Additional HCP 2" value="%ALLWEB03.18.129.001"
         onblur="ValidateHCP(18,0,pmenc029,d_pmenc029);">
        <input type=text name=d_pmenc029 id=d_pmenc029 size=20
         class=Readonly readonly
         value="%ALLWEB03.18.129.081" title="Additional HCP 2">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(pmenc029,d_pmenc029,0);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(pmenc029,d_pmenc029);">
    </td></tr>

<tr><td class=DataLabel width=15%>Additional HCP 3</td>
    <td><input type=text name=pmenc030 id=pmenc030 size=10 maxlength=10
         title="Additional HCP 3" value="%ALLWEB03.18.130.001"
         onblur="ValidateHCP(18,0,pmenc030,d_pmenc030);">
        <input type=text name=d_pmenc030 id=d_pmenc030 size=20
         class=Readonly readonly
         value="%ALLWEB03.18.130.081"  title="Additional HCP 3">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(pmenc030,d_pmenc030,0);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(pmenc030,d_pmenc030);">
    </td>
    <td class=DataLabel width=15%>Additional HCP 4</td>
    <td><input type=text name=pmenc031 id=pmenc031 size=10 maxlength=10
         title="Additional HCP 4" value="%ALLWEB03.18.131.001"
         onblur="ValidateHCP(18,0,pmenc031,d_pmenc031);">
        <input type=text name=d_pmenc031 id=d_pmenc031 size=20
         class=Readonly readonly
         value="%ALLWEB03.18.131.081" title="Additional HCP 4">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(pmenc031,d_pmenc031,0);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(pmenc031,d_pmenc031);">
    </td></tr>
</table>
</span>

<script type="text/javascript">
 UserDept="%STANDARD.01.028";
 for (var i=0; i < document.AddForm.pmenc003.length; i++) {
  if (document.AddForm.pmenc003.options[i].value==UserDept){
      document.AddForm.pmenc003.selectedIndex=i;
  }
 }
 selectOptions('14',AddForm.pmenc003,AddForm.pmenc008);
</script>
