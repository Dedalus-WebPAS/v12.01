<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/TableSort.js></script>
<script type="text/javascript">
function setType(thefield,type) {

  // Checkbox unchecked
  if(!thefield.checked){
    document.AddReferral._checkno.value--;
    if(document.AddReferral._checkno.value==0){
      document.AddReferral.graphtype.value="";
    }
  }

  // Checkbox checked
  else{
    if((document.AddReferral.graphtype.value!=type)&&(document.AddReferral.graphtype.value!="")){
      alert("Only those Assessments of the same Type can be graphed");
      thefield.checked=false;
      return;
    }
    // Handle single element case
    document.AddReferral.graphtype.value=type;
    document.AddReferral._checkno.value++;
  } 
}
function ReturnRef() {
  if(PatientLinks.admissno.value==""){
    alert("Invalid Referral");
    return;
  }
  var uno=PatientLinks.urnumber.value.replace(/ /g,"+");
  var adm=PatientLinks.admissno.value.replace(/ /g,"+");
  location.href="../cgi-bin/allweb02.pbl?reportno=02&template=002&urnumber="+
  uno+"&admissno="+adm
}
function GraphMultiple() {
  var uno=PatientLinks.urnumber.value.replace(/ /g,"+");
  var adm=PatientLinks.admissno.value.replace(/ /g,"+");
  var temp="011";
  if(document.AddReferral.graphtype.value=="005"){
      temp="012";}
  else if(document.AddReferral.graphtype.value=="007"){
      temp="013";}
  else if(document.AddReferral.graphtype.value=="019"){
      temp="021";}
  else if(document.AddReferral.graphtype.value=="023"){
      temp="024";}

  linkurl="../cgi-bin/allweb06.pbl?reportno=04&template="+temp+
          "&urnumber="+uno+"&admissno="+adm+"&mhhon001="+adm;
 n=0;
 for (var e = 0; e < document.all.length; e++) {
   if(document.all[e].name!=undefined) {
     var el=document.all[e] ;
     if (el.name.match(/prc/)) {
       if(el.checked==true){
         n++;
       }
     }
   }
 }

 a=0;
 for (var e = 0; e < document.all.length; e++) {
   if(document.all[e].name!=undefined) {
    var el=document.all[e] ;
    if (el.name.match(/prc/)) {
      if(el.checked==true){
        el.value.replace(/ /g,"+");
        n--;
        linkurl+="&dataset" + n  + "="+el.value;
        a++;}
    }
   }
 }
  if(document.AddReferral.graphtype.value=="023"){
     var NewWindow=window.open(linkurl,"ScreenLink",
     "width=700,height=768,location=no,resizable=yes,scrollbars=yes,titlebar=no");
  }
  else{
     Left=(document.body.clientWidth-1200)/2;
     DFrameLink(linkurl,100,Left,1200,680);
  }
}
function SupplConsumer() {
  var uno=PatientLinks.urnumber.value.replace(/ /g,"+");
  var adm=PatientLinks.admissno.value.replace(/ /g,"+");
  var temp="001";
  linkurl="../cgi-bin/mehweb02.pbl?reportno=03&template="+temp+
          "&urnumber="+uno+"&admissno="+adm;
  location.href=linkurl;
}
function HONOSLink(ur,adm,uniq,temp) {
  var uno=PatientLinks.urnumber.value.replace(/ /g,"+");
  var adm=PatientLinks.admissno.value.replace(/ /g,"+");
  var unq=uniq.replace(/ /g,"+");
  linkurl="../cgi-bin/allweb06.pbl?reportno=04&template="+temp+
          "&urnumber="+uno+"&admissno="+adm+"&mhhon002="+unq+"&mhhon001="+adm;
  Left=(document.body.clientWidth-1000)/2
  DFrameLink(linkurl,0,Left,1000,1200);
}

function AddHONOS(honostype) {
  if(document.AddReferral.honavail.value!="1"){
     alert("Invalid visit selected");
     return;
  }
  var temp="002";
  hontype=honostype.substr(3,1);
  if(hontype=="C"){
     temp="004";}
  if(hontype=="L"){
     temp="006";}
  if(hontype=="S"){
     temp="018";}
  if(hontype=="M"){
     temp="022";}

  linkurl="allweb06.pbl?reportno=04&template=" + temp +
           "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
           "&admissno=" + PatientLinks.admissno.value.replace(/ /g,"+") +
           "&honostyp=" + document.AddReferral.honostyp.value.replace(/ /g,"+");
  Left=(document.body.clientWidth-900)/2
  DFrameLink(linkurl,0,Left,900,640);
}
function SingleGraphLink(ur,adm,uniq,temp) {
  var uno=PatientLinks.urnumber.value.replace(/ /g,"+");
  var adm=PatientLinks.admissno.value.replace(/ /g,"+");
  var unq=uniq.replace(/ /g,"+");
  var template="008"
  if(temp=="005"){
     template="009"}
  else if(temp=="007"){
     template="010"}
  else if(temp=="019"){
     template="020"}
  else if(temp=="023"){
     template="024"}

  linkurl="../cgi-bin/allweb06.pbl?reportno=04&template="+template+
          "&urnumber="+uno+"&mhhon002="+unq+"&mhhon001="+adm+
          "&admissno="+adm;
  if(temp=="023"){
     linkurl = linkurl+"&dataset0="+adm+uniq;
  }
  if(temp=="023"){
     var NewWindow=window.open(linkurl,"ScreenLink",
     "width=700,height=768,location=no,resizable=yes,scrollbars=yes,titlebar=no");
  }
  else{
     Left=(document.body.clientWidth-1000)/2;
     DFrameLink(linkurl,100,Left,1000,680);
  }
}

//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
// 0. Link
// 1. HONOS collection date
// 2. Service Setting
// 3. HONOS Type
// 4. Responsible HCP
// 5. Sent          
// 6. Completed
// 7. Single Graph Link
// 8. Multiple Graph
// 9. Add Template No.
//10. Honos activity
//11. Total Score
//12. Collection Reason
//13. ?
//14. Conditional Display of Single Graph Link
//15. Conditional Display of Multiple Graph Checkbox
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 t = new Table(1,0,5,"100%","center",30,30);
 t.addColumn("Date","Date",1,1,"left","EditIcon.gif","0",85)
 t.addColumn("Service Setting","String",2,2,"left","","",100)
 t.addColumn("Collection Reason","String",12,12,"left","","",100)
 t.addColumn("Outcome Measure","String",3,3,"left","","",100)
 t.addColumn("Responsible HCP","String",4,4,"left","","",100)
 t.addColumn("Performing HCP","String",13,13,"left","","",90)
 t.addColumn("Total Score","String",11,11,"center","","",40)
 t.addColumn("Completed","String",6,6,"left","","",40)
//t.addColumn("Graph","String","",1,"left","Column1GraphIcon.gif","7",40)
//t.addColumn("Multiple Graph","String",8,8,"center","","",40)
 t.addColumn("Graph","String",14,1,"left","","",40)
 t.addColumn("Multiple Graph","String",15,15,"center","","",40)

 AddTableRows()
 TableOutput(0,2);    // Order Column,Asc Dsc
 break; }
 }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);SetCookiePath('RefList');">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
 Outcome Measure List for %ALLWEB06.04.002
</span>
<div id=PageBodySection >

<form name=AddReferral method=get action=allweb06.pbl style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%ALLWEB06.04.003">
<input type=hidden name=admissno value="%ALLWEB06.04.081">
<input type=hidden name=dataset0>
<input type=hidden name=dataset1>
<input type=hidden name=dataset2>
<input type=hidden name=dataset3>
<input type=hidden name=dataset4>
<input type=hidden name=graphtype>
<input type=hidden name=honavail value="%ALLWEB06.04.213">
<input type=hidden name=_checkno value=0>
 
<table cellspacing=0 cellpadding=0 border=1 width=100% class=HeadingCell>
  <tr>
    <td>
    <table cellspacing=0 cellpadding=0 border=0 width=100%>
      <tr align=right bgcolor=#CCCCCC>
        <td>
         <input type=button value=Close class=button
          onclick="DFrameCloseRefresh()">
      </tr>
      <tr>
            <td class=HeadingCell>
              <div align=right>Add Outcome
                <select name=honostyp
                  onchange='AddHONOS(AddReferral.honostyp.value);'
                  onmouseover='MenuOver(event,this)'>
                  <option></option>
                  %ALLWEB06.04.103.2
                </select>
              </div>
        </td>
      </tr>
    </table>
    </td>
  </tr>
</table>
</form>
<div id=TableLocation></div>
<script type="text/javascript">
function AddTableRows() {
%ALLWEB06.04.201.0
}
</script>
</div>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value="1">
<input type=hidden name=template value="009">
<input type=hidden name=urnumber value="%ALLWEB06.04.003">
<input type=hidden name=admissno value="%ALLWEB06.04.081">
<input type=hidden name=MenuType value="%ALLWEB06.04.088">
</form>
