<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<script type="text/javascript">
function ChangeURFrame(linkurl) {
  Left=(document.body.clientWidth-600)/2
  DFrameLink(linkurl,0,Left,600,370)
}
 function ValidateData(formName) {
   admDate = formName.psevt002;
   admTime = formName.psevt003;
   dscDate = formName.psevt009;
   dscTime = formName.psevt010;
   if(validateMandatory(formName)) {
      if(dscDate.value.replace(/ /g,"") != "" && 
         dscTime.value.replace(/ /g,"") == "") {
         alert("Discharge Time cannot be empty when Discharge Date is entered");
         return false;
      }
      if(dscDate.value.replace(/ /g,"") == "" && 
         dscTime.value.replace(/ /g,"") != "") {
         alert("Discharge Date cannot be empty when Discharge Time is entered");
         return false;
      }
      if(!ChkDateTime(admDate,admTime,dscDate,dscTime)) {
        alert("Discharge Date cannot be before Attendance Date");
        return false;
      }
      return true;
   }
   else {
     return false;
   }
 }
function SetList() {
  p=UpdateForm;
  if(isWhitespace(p.psevt012.value)) {
    p.psevt012.value=p.wbsesite.value;
  }
  p.psevt013.options.length=1;
  SetClinicType(p.psevt013,p.defctype.value,p.psevt012.value);
  SetList2();
}    
function SetList2() {
  p=UpdateForm;
  p.psevt014.options.length=1;
  SetTypeClinic(p.psevt014,p.deftclid.value,p.psevt012.value,p.psevt013.value);
}  
function EventSubmit(type) {
 document.UpdateForm.updttype.value=type;
  if (type=="U") {
    if (ValidateData(UpdateForm)) {
       document.UpdateForm.submit(); } }
  else {
    if (type=="D") {
      ans=confirm("Are you sure you want to Delete ?")
      if (ans) { document.UpdateForm.submit() } }
      else {
        document.UpdateForm.submit(); } }
}
</script>

</head>
%START.OF.PAGE            <!--Outpatient Update Form-->  
<body onload="PageLoad(event);SetList();">    
<div id="PageHeadingSection">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB81.01.003";
PatientVIS="%PATWEB81.01.081";
PatientNAM="%PATWEB81.01.002";
PatientSTA="%PATWEB81.01.086.078";
PatientALT="%PATWEB81.01.084";
PatientSEX="%PATWEB81.01.019";
PatientDOB="%PATWEB81.01.020";
PatientAGE="%PATWEB81.01.021";
PatientLOC="%PATWEB81.01.083";
PatientPRI="%PATWEB81.01.086.066.1";
PatientUNT="%PATWEB81.01.066.0";
DoctorCOD="%PATWEB81.01.082.003";
DoctorNAM="%PATWEB81.01.082.002";
PatientAID="%PATWEB81.01.086.090";
PatientIND="%PATWEB81.01.086.091";
PatientCUR="%PATWEB81.01.086.092";
PatientCLC="%PATWEB81.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB81.01.086.094";
PatientCDM="%PATWEB81.01.086.095";
PatientVDH="%PATWEB81.01.086.099.015";
InsertPatientHeader()
</script>

<div id=PatientMenu></div>
<div id=HeadingSection>
</div>
<table width="100%" cellpadding=0 cellspacing=0 border=0 bgcolor=#CCCCCC>
<tr><td width=55% class=HeadingCell align=center>Update Outpatient Event</td></tr>
</table>

<form name=UpdateForm method=post action=patweb81.pbl style="margin:0">
<input type=hidden name=reportno value="01">
<input type=hidden name=template value="005">
<input type=hidden name=updttype value="">
<input type=hidden name=evnttype value="%PATWEB81.01.129">
<input type=hidden name=psevt001 value="004">
<input type=hidden name=urnumber value="%PATWEB81.01.003">
<input type=hidden name=admissno value="%PATWEB81.01.081">
<input type=hidden name=wbsesite value="%STANDARD.01.023">
<input type=hidden name=psevt012 value="%PATWEB81.01.141">
<input type=hidden name=defctype value="%PATWEB81.01.139">
<input type=hidden name=deftclid value="%PATWEB81.01.140">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="%PATWEB81.01.001.patweb81.01.001">

<table align=center width=95% border=0 cellpadding=1 cellspacing=0>
<tr><td class=Mandatory>Attendance Date</td>
    <td>
    <input type=text name=psevt002 class="Mandatory PastDate"
     title="Attendance Date" size=12 value="%PATWEB81.01.101">
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.psevt002>
    Time
    <input type=text name=psevt003 class=Mandatory 
     title="Attendance Time" size=8 maxlength=8 value="%PATWEB81.01.102">
    <img src=../images/DateTimeStamp.gif class=Icon
     date=UpdateForm.psevt002 time=UpdateForm.psevt003>
    <img src=../images/TimeLookup.gif class=Icon time=UpdateForm.psevt003>
    </td></tr>    
<tr><td class=DataLabel>Attending HCP</td>
    <td>
    <input type=text name=psevt004 id=psevt004
     class=DataField title="Attending HCP"
     size=10 maxlength=10 value="%PATWEB81.01.103" 
     onblur="ValidateHCP(18,14,psevt004,hcp);">
    <input type=text name=hcp id=hcp
     class=ReadOnly readonly title="Attending HCP"
     size=24 maxlength=24 value="%PATWEB81.01.122" >
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="HCPSearchFrame(psevt004,hcp,1);"></td></tr>
<tr><td class=DataLabel>Presenting Problem</td>
    <td><input type=text name=psevt005 title="Presenting Problem"
     size=50 maxlength=60 value="%PATWEB81.01.104"> </td></tr>
    <tr><td class=DataLabel>Appointment Type</td>
    <td><select name=psevt016 title="Appointment Type">
    <option></option>
    %PATWEB81.01.130
    </select>
   </td></tr>
<tr><td class=DataLabel>Unit</td>
    <td><select name=psevt006 title="Unit">
        <option></option>
        %PATWEB81.01.105.2
        </select> </td></tr>
<tr><td class=DataLabel>Clinic Type</td>
    <td><select name=psevt013 title="Clinic Type" class="Mandatory"
         onchange="SetList2();">
        <option></option>
        </select> 
        </td></tr>
<tr><td class="DataLabel">Clinic ID</td>
    <td><select name=psevt014 title="Clinic ID">
        <option></option>
        </select>
    </td></tr>
<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td><select name=psevt015 title="%STANDARD.01.017.CL" class=Mandatory>
         <option></option>
        %PATWEB81.01.114.9.1.10.2.X
        </select> </td></tr>
<!-- defect no. 1578
<tr><td class=DataLabel>Admit Type</td>
    <td><select name=psevt018 title="Admit Type">
        <option></option>
        PATWEB81.01.117.2
        </select></td></tr>
<tr><td class=DataLabel>Admit Source</td>
    <td><select name=psevt019 title="Admit Source">
        <option></option>
        PATWEB81.01.118.2
        </select></td></tr>
-->
<tr><td class=DataLabel>Referred By</td>
    <td>
    <input name=psevt020 id=psevt020 type=hidden value="%PATWEB81.01.119.1">
    <input type=text name=name_psevt020 id=name_psevt020
     class=ReadOnly readonly 
     title="Referred By" size=24 maxlength=24 value="%PATWEB81.01.119.0">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="HCPSearchFrame(psevt020,name_psevt020,2);"></td></tr>
<tr><td class=DataLabel>Staff Phone Number</td>
    <td>
    <input type=text name=psevt007 title="Staff Phone Number"
     size=20 maxlength=20 value="%PATWEB81.01.106"></td></tr>
<tr><td class=Mandatory>Patient Location</td>
    <td><select name=psevt008 title="Patient Location" class=Mandatory>
        <option></option>
        %PATWEB81.01.107.2
        </select> </td></tr>
<tr><td class=DataLabel>Attendance Status</td>
    <td><select name=psevt017 title="Attendance Status" >
        <option></option>
         <option value="0">Attended</option>
         <option value="1">Not Attended</option>
         <option value="2">Cancelled</option>
        </select> </td></tr>

<tr><td class=DataLabel>Discharge Date</td>
    <td>
    <input type=text name=psevt009 title="Discharge Date" size=12 
     value="%PATWEB81.01.108" class="PastDate">
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.psevt009>
    Time
    <input type=text name=psevt010
     title="Discharge Time" size=8 maxlength=8 value="%PATWEB81.01.109"> 
    <img src=../images/DateTimeStamp.gif class=Icon
     date=UpdateForm.psevt009 time=UpdateForm.psevt010>
    <img src=../images/TimeLookup.gif class=Icon time=UpdateForm.psevt010>
    </td></tr>
<tr><td class=DataLabel>Discharge Status</td>
    <td><select name=psevt021 title="Discharge Status">
        <option></option>
        %PATWEB81.01.120.2
        </select></td></tr>    
<tr><td colspan=4 align=center><br>
     <input type=button value="Update" class="button" id=updbtn
      onclick="tempDisable(this);EventSubmit('U');">
     <input type=button value="Delete" class="button" id=delbtn 
      onclick="tempDisable(this);EventSubmit('D');">
     <input type=button value="Cancel" class="button"
     onclick="location.href=UpdateForm.redirect.value;" > </td></tr>

<tr><td colspan=4 align=center>
    <input type=button Value="Change U/R" class=button
     onclick='ChangeURFrame("%PATWEB81.01.001.patweb98.01.083")'></td></tr>
</table>
</form>
</div>

<form name="PatientLinks" method="get" action=patweb81.pbl >
<input type="hidden" name="reportno" value="1">
<input type="hidden" name="template" value="001">
<input type="hidden" name="urnumber" value="%PATWEB81.01.003">
<input type="hidden" name="admissno" value="%PATWEB81.01.081">
<input type="hidden" name="MenuType" value="%PATWEB81.01.088">
<input type="hidden" name="evnttype">
<input type="hidden" name="psevt001">
</form>

<script type="text/javascript">
AttendanceStatus="%PATWEB81.01.128"
for (var i=0;i<document.UpdateForm.psevt017.length;i++){
if (document.UpdateForm.psevt017.options[i].value==AttendanceStatus){
    document.UpdateForm.psevt017.selectedIndex=i}};

</script>
