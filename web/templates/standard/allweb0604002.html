<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language="javascript" src="../js/HONOSAlerts.js"></script>
<script language="javascript" src="../js/allweb0604.js"></script>
<script type="text/javascript">
function init(){
  ans=false;
  if(document.AddForm.prevhon.value=="1"){
     ans=confirm("Do you want to use previous scores from "+
                 "the last HoNOS assessment?");
  }
  if(ans){
     var serverURL = "../cgi-bin/allweb06.pbl?reportno=4&updttype=R" +
                     "&admissno="+document.AddForm.admissno.value.replace(/ /g,"+")+
                     "&honostyp="+document.AddForm.honostyp.value;
     var returnValue = RSExecute(serverURL);
     if(returnValue.status==0){
        ReturnValue=returnValue.return_value.split("|")
        for(var i=0 ; i<document.AddForm.mhhon030.length; i++) {
            if(trim(document.AddForm.mhhon030.options[i].value.substr(0,3))==
               trim(ReturnValue[0])){
               document.AddForm.mhhon030.selectedIndex=i; 
            } 
        }
        document.AddForm.mhhon031.value=trim(ReturnValue[1]);
        document.AddForm.mhhon032.value=trim(ReturnValue[2]);
        document.AddForm.mhhon033.value=trim(ReturnValue[3]);
        document.AddForm.mhhon034.value=trim(ReturnValue[4]);
        document.AddForm.mhhon035.value=trim(ReturnValue[5]);
        document.AddForm.mhhon036.value=trim(ReturnValue[6]);
        document.AddForm.mhhon037.value=trim(ReturnValue[7]);
        document.AddForm.mhhon038.value=trim(ReturnValue[8]);
        document.AddForm.mhhon041.value=trim(ReturnValue[9]);
        document.AddForm.mhhon042.value=trim(ReturnValue[10]);
        document.AddForm.mhhon043.value=trim(ReturnValue[11]);
        document.AddForm.mhhon044.value=trim(ReturnValue[12]);

        Q8A = trim(ReturnValue[59]);
        mhhon039 = document.AddForm.mhhon039;
 
        for(i=0; i<mhhon039.options.length; i++){
            if(mhhon039.options[i].value.substring(0,1)==Q8A){
               mhhon039.selectedIndex=i;
               Display8A();
               break;
            }
        }
        if(typeof document.AddForm.mhhon040 != 'undefined'){
           document.AddForm.mhhon040.value=trim(ReturnValue[60]);
        }
     }
  }
}
function SubmitHON(){
  f = document.AddForm;
  if(!isWhitespace(document.AddForm.mhhon006.value)&&
     !isWhitespace(document.AddForm.mhhon017.value)) {

    var strtDay = document.AddForm.mhhon006.value.substring(0,2);
    var strtMon = document.AddForm.mhhon006.value.substring(3,6);
    var strtYear = document.AddForm.mhhon006.value.substring(7,11);
    strtMon = GetMonthNumber(strtMon);
    var CollDate = strtYear+strtMon+strtDay;
    strtDay = document.AddForm.mhhon017.value.substring(0,2);
    strtMon = document.AddForm.mhhon017.value.substring(3,6);
    strtYear = document.AddForm.mhhon017.value.substring(7,11);
    strtMon = GetMonthNumber(strtMon);
    var CompDate = strtYear+strtMon+strtDay;

    if (CompDate < CollDate) {
      alert("Completion Date must be equal or after Collection Date.");
      return;
    }
  }
  if(!isWhitespace(document.AddForm.mhhon006.value)&&
     !isWhitespace(document.AddForm.inpadate.value)) {

    var strtDay = document.AddForm.mhhon006.value.substring(0,2);
    var strtMon = document.AddForm.mhhon006.value.substring(3,6);
    var strtYear = document.AddForm.mhhon006.value.substring(7,11);
    strtMon = GetMonthNumber(strtMon);
    var CollDate = strtYear+strtMon+strtDay;
    var inpadate = document.AddForm.inpadate.value;

    if (CollDate < inpadate) {
      alert("Collection Date cannot be before Admission Date.");
      return;
    }
  }
  if(!isWhitespace(document.AddForm.mhhon006.value)&&
     !isWhitespace(document.AddForm.inpddate.value)) {

    var strtDay = document.AddForm.mhhon006.value.substring(0,2);
    var strtMon = document.AddForm.mhhon006.value.substring(3,6);
    var strtYear = document.AddForm.mhhon006.value.substring(7,11);
    strtMon = GetMonthNumber(strtMon);
    var CollDate = strtYear+strtMon+strtDay;
    var inpddate = document.AddForm.inpddate.value;

    if (inpddate < CollDate) {
      alert("Collection Date cannot be After Discharge Date.");
      return;
    }
  }
  if(!isWhitespace(document.AddForm.mhhon006.value)&&
     !isWhitespace(document.AddForm.alrerdat.value)&&
      isWhitespace(document.AddForm.inpddate.value)) {

    var strtDay = document.AddForm.mhhon006.value.substring(0,2);
    var strtMon = document.AddForm.mhhon006.value.substring(3,6);
    var strtYear = document.AddForm.mhhon006.value.substring(7,11);
    strtMon = GetMonthNumber(strtMon);
    var CollDate = strtYear+strtMon+strtDay;

    strtDay = document.AddForm.alrerdat.value.substring(0,2);
    strtMon = document.AddForm.alrerdat.value.substring(3,6);
    strtYear = document.AddForm.alrerdat.value.substring(7,11);
    strtMon = GetMonthNumber(strtMon);
    var DteStart = strtYear+strtMon+strtDay;
    if (CollDate < DteStart) {
      alert("Collection Date cannot be before Referral Start Date.");
      return;
    }
  }
  if(!isWhitespace(document.AddForm.mhhon006.value)&&
     !isWhitespace(document.AddForm.dateclsd.value)&& 
      isWhitespace(document.AddForm.inpadate.value)) {
    var strtDay = document.AddForm.mhhon006.value.substring(0,2);
    var strtMon = document.AddForm.mhhon006.value.substring(3,6);
    var strtYear = document.AddForm.mhhon006.value.substring(7,11);

    strtMon = GetMonthNumber(strtMon);

    var CollDate = strtYear+strtMon+strtDay;

    var DteClosd = document.AddForm.dateclsd.value;

    if (DteClosd < CollDate) {
      alert("Collection Date cannot be after Referral Close Date.");
      return;
    }
  }

  if(document.AddForm.d_mhhon015.checked==true){
     document.AddForm.mhhon015.value="1" }
  else {
     document.AddForm.mhhon015.value="0" } 
  if(document.AddForm.d_mhhon024.checked==true){
     document.AddForm.mhhon024.value="1" }
  else {
     document.AddForm.mhhon024.value="0" }
  if(document.AddForm.d_mhhon025.checked==true){
     document.AddForm.mhhon025.value="1" }
  else {
     document.AddForm.mhhon025.value="0" }
  if(document.AddForm.d_mhhon026.checked==true){
     document.AddForm.mhhon026.value="1" }
  else {
     document.AddForm.mhhon026.value="0" }
  if(document.AddForm.d_mhhon027.checked==true){
     document.AddForm.mhhon027.value="1" }
  else {
     document.AddForm.mhhon027.value="0" }
  if(document.AddForm.d_mhhon028.checked==true){
     document.AddForm.mhhon028.value="1" }
  else {
     document.AddForm.mhhon028.value="0" }

  if (!validateMandatory(f)) {return;}

  var i = f.mhhon007.selectedIndex;
  var ind2 = f.mhhon007.options[i].value.substring(4,5);
  if (!CheckMHServiceSettingForAdd(ind2,f.ptvitype.value)) {
    if (ind2 == "I") {  
      VisitSearchFrameDeftSearchView(f.urnumber,f.lnkadmno,"2")
    }
    else {
      if (ind2 == "R") {
        VisitSearchFrameDeftSearchView(f.urnumber,f.lnkadmno,"6")
      }
    }
    return;
  }

  f.submit();
}

function Display8A() {

  i = document.AddForm.mhhon039.selectedIndex;
  ind = document.AddForm.mhhon039.options[i].value.substring(14,15);

  if(ind!="J"){
     Quest8A.innerHTML=quest8ablank.innerHTML;
     document.AddForm.mhhon040.value="";
  } 
  else{
     Quest8A.innerHTML=quest8a.innerHTML;
  }
}

function checkSecure() {
  if(document.AddForm.d_secure.checked==true){
     Secure.innerHTML=secure.innerHTML;
  } 
  else {
     Secure.innerHTML=secureblank.innerHTML;
     document.AddForm.mhhon078.value="";
     document.AddForm.mhhon079.value="";
     document.AddForm.mhhon080.value="";
     document.AddForm.mhhon081.value="";
     document.AddForm.mhhon082.value="";
     document.AddForm.mhhon083.value="";
     document.AddForm.mhhon084.value="";
  }
}
function checkRating(field){
  if(isWhitespace(field.value)){
    return;}
  if(field.value=="0"){
    return;}
  if(field.value=="1"){
    return;}
  if(field.value=="2"){
    return;}
  if(field.value=="3"){
    return;}
  if(field.value=="4"){
    return;}
  if(field.value=="7"){
    return;}
  if(field.value=="8"){
    if (document.AddForm.mhhon008.value.substr(5,1)=="Z") {
       return;}
  }
  alert("'"+field.value+"' - "+"Invalid Rating");
  field.value="";
  field.focus();
}

function Set8A(val){

  var mhhon039 = document.AddForm.mhhon039;

  if(val!=0){
     return false;
  }
  for(i=0; i<mhhon039.options.length; i++){
      if(mhhon039.options[i].value.substring(3,4)=="X"){
         mhhon039.selectedIndex=i;
         break;
      }
  }
}
</script>
</head>

%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Add HoNOS Assessment for %ALLWEB06.04.002
</span>
<div id=PageBodySection >
<form name=AddForm method=post action=allweb06.pbl style="margin:0">
<input type=hidden name=urnumber value="%ALLWEB06.04.003">
<input type=hidden name=admissno value="%ALLWEB06.04.081">
<input type=hidden name=mhhon001 value="%ALLWEB06.04.081">
<input type=hidden name=mhhon003 value="%ALLWEB06.04.210">
<input type=hidden name=prevhon value="%ALLWEB06.04.190">
<input type=hidden name=mhhon004 value="1">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value="002">
<input type=hidden name=updttype value="A">
<input type=hidden name=inpstats value="%ALLWEB06.04.086.092">
<input type=hidden name=dateclsd value="%ALLWEB06.04.214">
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden name=honostyp value="%ALLWEB06.04.210">
<input type=hidden name=ptcnhdps id=ptcnhdps
       value="%STANDARD.01.025.080.250.1.1">
<input type=hidden name=honosin1 id=honosin1
       value="%ALLWEB06.04.221.0">
<input type=hidden name=alrerdat value="%ALLWEB06.04.519">
<input type=hidden name=inpadate value="%ALLWEB06.04.604">
<input type=hidden name=inpddate value="%ALLWEB06.04.605">
<input type=hidden name=ptvitype id=ptvitype value="%ALLWEB06.04.606">
<input type=hidden name=lnkadmno id=lnkadmno value="">

<table cellspacing=0 cellpadding=2 border=0 width=95% align=center>
  <tr><td class=DataLabel width 30%>%STANDARD.01.035.ss</td>
      <td><select name=mhhon007 class=Mandatory
           title="%STANDARD.01.035.ss">
          <option> </option>
           %ALLWEB06.04.107.4
          </select>
      </td></tr>
  <tr><td class=DataLabel>%STANDARD.01.035.hp</td>
      <td><select name=mhhon008 class=Mandatory id=mhhon008
           title="%STANDARD.01.035.hp" onchange="SetCompDate();">
          <option> </option>
           %ALLWEB06.04.108.4
          </select>
      </td></tr>
  <tr><td class=DataLabel >Collection Date </td>
      <td><input type=text size=12 name=mhhon006 id=mhhon006
           class="Mandatory PastDate" title="Collection Date"
           value="%STANDARD.01.015">
          <img notab src="../images/DateLookup.gif" class=Icon
               onclick="DateLookupFrame(AddForm.mhhon006);">
          <img notab src="../images/DateTimeStamp.gif" class=Icon
               onclick="SetCurrentDateTime(AddForm.mhhon006,null);">
      </td></tr>

  <tr><td class=DataLabel> Responsible Service Team </td>
      <td colspan=5><input type=text name=mhhon010 id=mhhon010
          size=11 maxlength=11 
          title="Responsible Service Team"
          class=Readonly readonly value="%ALLWEB06.04.548.1"
          onblur="validateCode2(7,AddForm.mhhon010,AddForm.n_mhhon010)">
         <input type=text name=n_mhhon010 id=n_mhhon010 size=42 readonly
          value="%ALLWEB06.04.548.0"
          class=Readonly tabindex=-1 title="Team Description" value="">
         <img src="../images/SearchIcon.gif" class=Icon
          onclick="TeamSearchFrame(AddForm.mhhon010,AddForm.n_mhhon010)">
         <img src="../images/ClearIcon.gif" class=Icon
          onClick="clrFields(AddForm.mhhon010,AddForm.n_mhhon010);">
    </td></tr>

  <tr><td class=DataLabel>Responsible HCP</td>
      <td colspan=5><input type=text name=mhhon009 id=mhhon009 
          class=DataField size=10 maxlength=10
          value="%ALLWEB06.04.538.1"
          onchange="UpCase(this);ValidateHCP(18,0,AddForm.mhhon009,AddForm.doctname);">
        <input type=text name=doctname id=doctname title="Responsible HCP"
          value="%ALLWEB06.04.538.0" readonly>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(AddForm.mhhon009,AddForm.doctname,0);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(AddForm.mhhon009,AddForm.doctname);">
      </td></tr>

  <tr><td class=DataLabel>%STANDARD.01.035.hf</td>
      <td><select name=mhhon022 id=mhhon022 title="%STANDARD.01.035.hf">
          <option> </option>
           %ALLWEB06.04.122.4
          </select>
      </td></tr>
  <tr><td class=DataLabel>%STANDARD.01.035.hc</td>
      <td><select name=mhhon023
           title="%STANDARD.01.035.hc">
          <option> </option>
           %ALLWEB06.04.123.4
          </select>
      </td></tr>
  <tr><td class=DataLabel>NGO Involvement
        <input type=hidden name=mhhon015>
        <input type=hidden name=mhhon024>
        <input type=hidden name=mhhon025>
        <input type=hidden name=mhhon026>
        <input type=hidden name=mhhon027>
        <input type=hidden name=mhhon028></td>
        <td class=DataLabel colspan=4>None
      <input type=checkbox name=d_mhhon024 title="None" value="1"
         onclick="SetChkBox(this,'1');">
         Supported Accommodation
      <input type=checkbox name=d_mhhon025 title="Supported Accommodation"
         value="1" onclick="SetChkBox(this,'2');">
         Community Worker
      <input type=checkbox name=d_mhhon026 title="Community Worker"
         value="1" onclick="SetChkBox(this,'3');">
         Vocational Assistance
      <input type=checkbox name=d_mhhon027 title="Vocational Assistance"
         value="1" onclick="SetChkBox(this,'4');">
         Non-specific
      <input type=checkbox name=d_mhhon028 title="Non-specific"
         value="1" onclick="SetChkBox(this,'5');">
      </td></tr>
  <tr><td class=DataLabel>%STANDARD.01.035.ht</td>
      <td><select name=mhhon029
           title="%STANDARD.01.035.ht">
          <option> </option>
           %ALLWEB06.04.129.2
          </select>
      </td></tr>
  <tr><td class=DataLabel>%STANDARD.01.035.hm</td>
    <td><select name=mhhon030
         title="%STANDARD.01.035.hm">
         <option> </option>
         %ALLWEB06.04.130.4
         </select></td>
   </tr>
 </table>

 <table width=95% align=center>
    <tr><td><hr /></td></tr>
 </table>
 <table width=95% align=center>
    <tr><td width=50%>
 <table>
  <tr><td class=DataLabel>1.&nbsp;Overactive, aggressive, disruptive or
                           agitated</td>
      <td><input type=text name=mhhon031 size=4 maxlength=1 title="1"
           onblur='checkRating(mhhon031);'>
          <img src="../images/HelpIcon.gif" class=Icon 
           onclick="if(document.AddForm.honosin1.value=='A')
                      {Alert1();}
                    else{H65Alert1();}"></td>
  </tr>
  <tr><td class=DataLabel>2.&nbsp;Non-accidental self-injury</td>
      <td><input type=text name=mhhon032 size=4 maxlength=1 title="2"
           onblur='checkRating(mhhon032);'>
          <img src="../images/HelpIcon.gif" class=Icon 
           onclick="if(document.AddForm.honosin1.value=='A')
                      {Alert2();}
                    else{H65Alert2();}"></td>
  </tr>
  <tr><td class=DataLabel>3.&nbsp;Problem drinking or drug-taking</td>
     <td><input type=text name=mhhon033 size=4 maxlength=1 title="3"
          onblur='checkRating(mhhon033);'>
         <img src="../images/HelpIcon.gif" class=Icon 
          onclick="if(document.AddForm.honosin1.value=='A')
                     {Alert3();}
                   else{H65Alert3();}"></td>
  </tr>  
  <tr><td class=DataLabel>4.&nbsp;Cognitive problems</td>
      <td><input type=text name=mhhon034 size=4 maxlength=1 title="4"
           onblur='checkRating(mhhon034);'>
          <img src="../images/HelpIcon.gif" class=Icon 
           onclick="if(document.AddForm.honosin1.value=='A')
                      {Alert4();}
                    else{H65Alert4();}"></td>
  </tr>
  <tr><td class=DataLabel>5.&nbsp;Physical illness or disability problems</td>
      <td><input type=text name=mhhon035 size=4 maxlength=1 title="5"
           onblur='checkRating(mhhon035);'>
          <img src="../images/HelpIcon.gif" class=Icon 
           onclick="if(document.AddForm.honosin1.value=='A')
                      {Alert5();}
                    else{H65Alert5();}"></td>
  </tr>  
  <tr><td class=DataLabel>6.&nbsp;Problems with hallucinations and 
                delusions</td>
      <td><input type=text name=mhhon036 size=4 maxlength=1 title="6"
           onblur='checkRating(mhhon036);'>
          <img src="../images/HelpIcon.gif" class=Icon 
           onclick="if(document.AddForm.honosin1.value=='A')
                      {Alert6();}
                    else{H65Alert6();}"></td>
  </tr>    
  <tr><td class=DataLabel>7.&nbsp;Problems with depressed mood</td>
      <td><input type=text name=mhhon037 size=4 maxlength=1 title="7"
           onblur='checkRating(mhhon037);'>
          <img src="../images/HelpIcon.gif" class=Icon 
           onclick="if(document.AddForm.honosin1.value=='A')
                       {Alert7();}
                    else{H65Alert7();}"></td>
  </tr>
 </table>  
 </td>  
   
 <td width=50%>
  <table>
  <tr><td class=DataLabel>8.&nbsp;Other mental and behavioural problems</td>
      <td><input type=text name=mhhon038 size=4 maxlength=1 title="8"
           onblur='checkRating(mhhon038);Set8A(this.value);'>
          <img src="../images/HelpIcon.gif" class=Icon 
           onclick="if(document.AddForm.honosin1.value=='A')
                      {Alert8();}
                    else{H65Alert8();}"></td>
  </tr>
  <tr><td class=DataLabel>8a.</td>
      <td colspan=2><select name=mhhon039 onchange="Display8A();"
          title="%STANDARD.01.035.hb">
          <option></option>
            %ALLWEB06.04.139.2 </select>
          <div id=Quest8A></div></td>
  </tr>
  <tr><td class=DataLabel>9.&nbsp;Problems with relationships</td>
      <td><input type=text name=mhhon041 size=4 maxlength=1 title="9"
           onblur='checkRating(mhhon041);'>
          <img src="../images/HelpIcon.gif" class=Icon 
           onclick="if(document.AddForm.honosin1.value=='A')
                      {Alert9();}
                    else{H65Alert9();}"></td>
  </tr>
  <tr><td class=DataLabel>10.&nbsp;Problems with activities of daily living</td>
      <td><input type=text name=mhhon042 size=4 maxlength=1 title="10"
           onblur='checkRating(mhhon042);'>
      <img src="../images/HelpIcon.gif" class=Icon 
       onclick="if(document.AddForm.honosin1.value=='A')
                  {Alert10();}
                else{H65Alert10();}"></td>
  </tr>      
  <tr><td class=DataLabel>11.&nbsp;Problems with living conditions</td>
      <td><input type=text name=mhhon043 size=4 maxlength=1 title="11"
           onblur='checkRating(mhhon043);'>
          <img src="../images/HelpIcon.gif" class=Icon 
           onclick="if(document.AddForm.honosin1.value=='A')
                      {Alert11();}
                    else{H65Alert11();}"></td>
  </tr>
  <tr><td class=DataLabel>12.&nbsp;Problems with occupation and activities</td>
      <td><input type=text name=mhhon044 size=4 maxlength=1 title="12"
           onblur='checkRating(mhhon044);'>
          <img src="../images/HelpIcon.gif" class=Icon 
           onclick="if(document.AddForm.honosin1.value=='A')
                      {Alert12();}
                    else{H65Alert12();}"></td>
  </tr>
  </table>
 </td>
</tr>
</table>
 <table width=95% align=center>
    <tr><td><hr /></td></tr>
 </table>
<table cellspacing=0 cellpadding=2 border=0 width=95% align=center>
  <tr><td class=DataLabel>HoNOS Completed</td>
      <td colspan=5><input type=checkbox name=d_mhhon015 id=d_mhhon015 value="1"
          title="HoNOS Completed" onclick='SetCompDate();'>
          Completion Date
         <input width=30% type=text size=12 name=mhhon017 id=mhhon017
          title="Completion Date" class=PastDate>
         <img notab src="../images/DateLookup.gif" class=Icon
              onclick="DateLookupFrame(AddForm.mhhon017);">
         <img notab src="../images/DateTimeStamp.gif" class=Icon
              onclick="SetCurrentDateTime(AddForm.mhhon017,null);">
      </td></tr>
 <tr><td class=DataLabel>%STANDARD.01.035.hv</td>
      <td><select name=mhhon085 id=mhhon085 title="%STANDARD.01.035.hv" class="Mandatory">
         <option> </option>
         %ALLWEB06.04.185.4
         </select></td>
  </tr>
</table>
   
   <div id=Secure></div>
   <table width=100%>
    <tr><td align=center colspan=2>
       <input type=button id=btnAdd value="Add" class=button 
        onclick="tempDisable(this);SubmitHON();">
       <input type=button value="Close" class=button
        onclick="DFrameCloseRefresh()">
       <input type=button id=btnPrint value="Print Screen" class=button
        onclick="tempDisable(this);DFrameImgPrint();">
     </td></tr>
</table>

</form>
</div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value="004">
<input type=hidden name=urnumber value="%ALLWEB06.04.003">
<input type=hidden name=admissno value="%ALLWEB06.04.081">
<input type=hidden name=MenuType value="%ALLWEB06.04.088">
<input type=hidden name=webuseid value="%STANDARD.01.008">
</form>
<span id=quest8a style="display:none">
   <input type=text size=40 maxlength=35 name=mhhon040 class=Mandatory>
</span>
<span id=quest8ablank style="display:none">
   <input type=hidden name=mhhon040 class="">
</span>
<span id=secure style="display:none">
   <table width=100%>
   <tr><td class=DataLabel width=30%>Rate potential harm to others</td>
       <td><input type=text name=mhhon078 size=4 maxlength=1
            onblur='checkRating(mhhon078);'></td></tr>
   <tr><td class=DataLabel>Rate potential self-harm or self-neglect</td>
       <td><input type=text name=mhhon079 size=4 maxlength=1
            onblur='checkRating(mhhon079);'></td></tr>
   <tr><td class=DataLabel>Rate need for building security to prevent 
                           physical escape</td>
       <td><input type=text name=mhhon080 size=4 maxlength=1
            onblur='checkRating(mhhon080);'></td></tr>
   <tr><td class=DataLabel>Rate need for safely staffed living environment</td>
       <td><input type=text name=mhhon081 size=4 maxlength=1
            onblur='checkRating(mhhon081);'></td></tr>
   <tr><td class=DataLabel>Rate need for escort on leave (beyond secure 
                           perimeter) </td>
       <td><input type=text name=mhhon082 size=4 maxlength=1
            onblur='checkRating(mhhon082);'></td></tr>
   <tr><td class=DataLabel>Rate potential harm to individual from others</td>
       <td><input type=text name=mhhon083 size=4 maxlength=1
            onblur='checkRating(mhhon083);'></td></tr>
   <tr><td class=DataLabel>Rate the need for specialist clinical procedures</td>
       <td><input type=text name=mhhon084 size=4 maxlength=1
            onblur='checkRating(mhhon084);'></td></tr>
   </table>
</span>
<span id=secureblank style="display:none">
   <input type=hidden name=mhhon078 class="">
   <input type=hidden name=mhhon079 class="">
   <input type=hidden name=mhhon080 class="">
   <input type=hidden name=mhhon081 class="">
   <input type=hidden name=mhhon082 class="">
   <input type=hidden name=mhhon083 class="">
   <input type=hidden name=mhhon084 class="">
</span>

<script type="text/javascript">
function SetCompDate() {
  if (document.AddForm.d_mhhon015.checked==true) 
  {
    document.AddForm.mhhon017.value="%STANDARD.01.015";
    document.AddForm.mhhon017.className="Mandatory PastDate";
    document.AddForm.mhhon017.disabled=false;
    if(document.AddForm.mhhon008.value.substr(6,1)=="M")
    {
      document.AddForm.mhhon029.className="Mandatory";
      document.AddForm.mhhon030.className="Mandatory";
      document.AddForm.mhhon031.className="Mandatory";
      document.AddForm.mhhon032.className="Mandatory";
      document.AddForm.mhhon033.className="Mandatory";
      document.AddForm.mhhon034.className="Mandatory";
      document.AddForm.mhhon035.className="Mandatory";
      document.AddForm.mhhon036.className="Mandatory";
      document.AddForm.mhhon037.className="Mandatory";
      document.AddForm.mhhon038.className="Mandatory";
      document.AddForm.mhhon039.className="Mandatory";
      document.AddForm.mhhon041.className="Mandatory";
      document.AddForm.mhhon042.className="Mandatory";
      document.AddForm.mhhon043.className="Mandatory";
      document.AddForm.mhhon044.className="Mandatory";
    }
    else
    {
      document.AddForm.mhhon029.className="";
      document.AddForm.mhhon030.className="";
      document.AddForm.mhhon031.className="";
      document.AddForm.mhhon032.className="";
      document.AddForm.mhhon033.className="";
      document.AddForm.mhhon034.className="";
      document.AddForm.mhhon035.className="";
      document.AddForm.mhhon036.className="";
      document.AddForm.mhhon037.className="";
      document.AddForm.mhhon038.className="";
      document.AddForm.mhhon039.className="";
      document.AddForm.mhhon041.className="";
      document.AddForm.mhhon042.className="";
      document.AddForm.mhhon043.className="";
      document.AddForm.mhhon044.className="";
    }
    if((document.AddForm.mhhon008.value.substr(8,1)=="M") &&
      ((document.AddForm.honosin1.value=="A")||
       (document.AddForm.honosin1.value=="O")||
       (document.AddForm.honosin1.value=="S")||
       (document.AddForm.honosin1.value=="L")))
    {
      document.AddForm.mhhon022.className="Mandatory";
    }
    else
    {
      document.AddForm.mhhon022.className="";
    }
  } 
  else 
  {
    document.AddForm.mhhon017.value="";
    document.AddForm.mhhon017.className="";
    document.AddForm.mhhon017.disabled=true;
    document.AddForm.mhhon022.className="";
    document.AddForm.mhhon029.className="";
    document.AddForm.mhhon030.className="";
    document.AddForm.mhhon031.className="";
    document.AddForm.mhhon032.className="";
    document.AddForm.mhhon033.className="";
    document.AddForm.mhhon034.className="";
    document.AddForm.mhhon035.className="";
    document.AddForm.mhhon036.className="";
    document.AddForm.mhhon037.className="";
    document.AddForm.mhhon038.className="";
    document.AddForm.mhhon039.className="";
    document.AddForm.mhhon041.className="";
    document.AddForm.mhhon042.className="";
    document.AddForm.mhhon043.className="";
    document.AddForm.mhhon044.className="";
  }
}

function SetChkBox(thisone,numb) {
  if (thisone.checked==true) {
      if (numb=="1") {
          document.AddForm.d_mhhon024.checked=true;
          document.AddForm.d_mhhon025.checked=false;
          document.AddForm.d_mhhon026.checked=false;
          document.AddForm.d_mhhon027.checked=false;
          document.AddForm.d_mhhon028.checked=false;
          document.AddForm.d_mhhon025.disabled=true;
          document.AddForm.d_mhhon026.disabled=true;
          document.AddForm.d_mhhon027.disabled=true;
          document.AddForm.d_mhhon028.disabled=true;
      } else {
          document.AddForm.d_mhhon024.checked=false;
          document.AddForm.d_mhhon024.disabled=true;
          document.AddForm.d_mhhon025.disabled=false;
          document.AddForm.d_mhhon026.disabled=false;
          document.AddForm.d_mhhon027.disabled=false;
          document.AddForm.d_mhhon028.disabled=false;
      }
  } else {
      document.AddForm.d_mhhon025.disabled=false;
      document.AddForm.d_mhhon026.disabled=false;
      document.AddForm.d_mhhon027.disabled=false;
      document.AddForm.d_mhhon028.disabled=false;
  }
  if ((document.AddForm.d_mhhon025.checked==false) &&
      (document.AddForm.d_mhhon026.checked==false) &&
      (document.AddForm.d_mhhon027.checked==false) &&
      (document.AddForm.d_mhhon028.checked==false)) {
        document.AddForm.d_mhhon024.disabled=false;
  } else {
        document.AddForm.d_mhhon024.disabled=true;
  }
}

if ((document.AddForm.d_mhhon025.checked==false) &&
    (document.AddForm.d_mhhon026.checked==false) &&
    (document.AddForm.d_mhhon027.checked==false) &&
    (document.AddForm.d_mhhon028.checked==false)) {
      document.AddForm.d_mhhon024.disabled=false;
} else {
      document.AddForm.d_mhhon024.disabled=true;
}
//   Set MH Service Setting if Patient is a Current Inpatient
if(document.AddForm.inpstats.value == "(Current IP)") {
   for(var i=0 ; i<document.AddForm.mhhon007.length; i++) {
       if(document.AddForm.mhhon007.options[i].value.substr(3,1)=="C") {
          document.AddForm.mhhon007.selectedIndex=i; 
       }
   }
}  

hp = document.getElementById("mhhon008");
hf = document.getElementById("mhhon022");
hv = document.getElementById("mhhon085");

for(i=1; i<hp.options.length; i++){
    if(hp.options[i].value.substring(7,8)!="H"){
       hp.options[i] = null;
       i--;
    }
}
for(i=1; i<hf.options.length; i++){
    if(hf.options[i].value.substring(7,8)!="H"){
       hf.options[i] = null;
       i--;
    }
}
for(i=1; i<hv.options.length; i++){
    if(hv.options[i].value.substring(7,8)!="H"){
       hv.options[i] = null;
       i--;
    }
}
</script>
