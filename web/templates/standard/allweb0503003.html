<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript" src="../js/allweb05.js"></script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link               
//  1 - Patient Name (UR) Age Sex
//  2 - Movement Date & Time
//  3 - Due Date
//  4 - Home Location
//  5 - Destination
//  6 - Receiver
//  7 - Movement Reason
//---------------------------------------------------------------------------
function InitTable(TableView) {
document.title="Extract Message List By Batch"
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",35,35);
 t.addColumn("Message Id","String",7,7,"left","MaintenanceIcon.gif","0",80)
 t.addColumn("Status","String",9,9,"left","","",110)
 t.addColumn("Date Time","DateTime",3,3,"left","","",120)
 t.addColumn("Visit","String",8,8,"left","","",45)
 t.addColumn("U/R","String",2,2,"left","MaintenanceIcon.gif","15",40)
 t.addColumn("Department","String",13,13,"left","","",90)
 t.addColumn("Record Source","String",14,14,"left","","",55)
 t.addColumn("Message Type","String",10,10,"left","","",45)
 t.addColumn("Record Type","String",11,11,"left","","",55)
 AddTableRows()
 t.sortTable(2,1);
 t.sortTable(3,1);
 TableOutput(4,1);    // Order Column,Asc Dsc
 
 break; }
 }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);SetCookiePath('VINAHList');">
<div id=HeadingSection>
<form name=SelectPeriod action=allweb05.pbl method=get style="margin:0">
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=3>

<table cellpadding=1 cellspacing=1 bgcolor=#CCCCCC border=0 width=100%>
<tr><td class=DataLabel>Extract File</td>
    <td><input type=text name=bfilname size=20 maxlength=17 class=Readonly
         readonly title="Extract File" value="%ALLWEB05.03.003">
        </td>
    <td class=DataLabel>Batch Number</td>
    <td><input type=text name=batchnum size=22 maxlength=20
         title="Batch Number" value="%ALLWEB05.03.104"
         onchange="validateBatch(SelectPeriod.batchnum,
                   SelectPeriod.bfilname,SelectSubmit);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(SelectPeriod.bfilname,
                  SelectPeriod.batchnum,SelectSubmit);">
        </td>
    <td>Department </td>
    <td><select name=deptcode onchange="SelectSubmit()" >
        <option value="">All</option>
        %ALLWEB05.03.207
        </select></td>
    <td class=DataLabel>Status</td>
    <td><select name="filtstat" title="Status" onchange="SelectSubmit();">
         <option value=" ">Select Status</option>
         <option value="~~">All</option>
         <option value=" 0">Waiting</option>
         <option value=" 1">Ignore (printed error)</option>
         <option value=" 2">Ignore (non VINAH record)</option>
         <option value=" 3">Ignore (not required)</option>
         <option value=" 4">Ignore (later message)</option>
         <option value=" 5">Ignore (associated deletion)</option>
         <option value=" 6">Extracted</option>
         <option value=" 7">Submitted</option>
         <option value=" 8">Rejected</option>
         <option value=" 9">Resubmitted</option>
         <option value="10">Accepted</option>
         </select>
     </td>
     <td class=DataLabel><input type=button value="Reset All Errors" 
                          name=resetbut class="button" onclick="ErrorLink();">
     </td>
     </tr>
</table>
</form>
</div>

<div id=TableLocation></div>
<script type="text/javascript">
function AddTableRows() {
%ALLWEB05.03.208
}
//
 Status="%ALLWEB05.03.002";
 for (var i =0 ; i < document.SelectPeriod.filtstat.length; i++) {
  if (document.SelectPeriod.filtstat.options[i].value==Status.substr(0,2)) {
       document.SelectPeriod.filtstat.selectedIndex=i } };
//
 if(!isWhitespace(SelectPeriod.batchnum.value)) {
   document.SelectPeriod.resetbut.disabled=true;
 }
</script>
