<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/PatientSortWidget.js"></script>
<script type="text/javascript">
function PatientTableLink(Urnumber,Admissno,Server,Option,Template,Frame) {
  if (getTop().menu.defPatientLink.serverid==undefined) {
    serverid=Server
    reportno=Option
    template=Template; 
  }
  else {
    serverid=getTop().menu.defPatientLink.serverid.value;
    reportno=getTop().menu.defPatientLink.reportno.value;
    template=getTop().menu.defPatientLink.template.value;
  }
  url=serverid + ".pbl?reportno=" + reportno +
                 "&template=" + template +
                 "&urnumber="  + Urnumber.replace(/ /g,"+") +
                 "&admissno="  + Admissno.replace(/ /g,"+") 
  getTop().content.document.location.href=url
}
function GetOptions() {
  theURL = "patweb02.pbl?reportno=2&template=5";
  theURL = theURL + '&httprand='+Math.random();
  xmlHttp = createHttpObject();
  xmlHttp.open("GET", theURL, false);
  xmlHttp.send();
  var $str=xmlHttp.responseText.replace(/\n/,"")
  $str=$str.replace(/<\/option>/g,"|");
  $arr=$str.split("|");
  for (i=0;i<$arr.length;i++) {
    var y=document.createElement('option');
    y.text=$arr[i].replace(/<option.*>/,"");
    y.value=$arr[i].replace(/<option value="/,"").replace(/">.*/,"");
    if (y.value.match(/\w/)!=null) {
      DisplayForm.webpd002.add(y);
    }
  }
}
function InitTable(TableView) {
  //------------------------------------------------------------
  // Table - Current Admission by Doctor
  // Columns
  //  0 - UR
  //  1 - Admission No
  //  2 - Indicators
  //  3 - Name
  //  4 - Ward Bed
  //  5 - Admission Date & Time
  //  6 - Sex
  //  7 - Age
  //  8 - Diagnosis
  //------------------------------------------------------------
  switch (TableView) {
    case 0:
      t = new Table(1,0,1,"100%","center",24,24);
      t.addColumn("Recently Accessed Patient Records","Checkbox",3,3,"left nowrap","","0","90%")
      t.addLink("patweb98.pbl","01","001","PatientFolder.gif")
      AddTableRows();
      TableOutput(0,1);
      GetOptions()
      break;
  }
}
function AddTableRows() {
  elTable=document.getElementById("PatientList");
  elRows=elTable.getElementsByTagName("TR");
  for (i=0; i < elRows.length; i++) {
    elCols=elRows[i].getElementsByTagName("TD");
    urnumber="";
    admissno="";
    PatientName="";
    for (j=0; j < elCols.length; j++) {
      if (elCols[j].className != "HeadingCell") {
        switch (j) {
          case 0:
            urnumber = elCols[j].innerHTML.replace(/^.*ShowPatient\((.*),.+\)['"].*/i,"$1").replace(/\"?(\&quot;)?/g,"");
            admissno = elCols[j].innerHTML.replace(/^.*ShowPatient\(.*,(.+)\)['"].*/i,"$1").replace(/\"?(\&quot;)?/g,"");
            break;
          case 1:
            PatientName=elCols[j].innerHTML;
            break;
        }
      }
    }

    if (urnumber != "") {
      t.addRow(urnumber,admissno,"",PatientName);
    }
  }
}
function AddPatients() {
  xmlHttp = createHttpObject();
  var theURL = "patweb02.pbl";
  paraStatic = "reportno="+encodeURI(AddForm.reportno.value);
  paraStatic += "&template="+encodeURI(AddForm.template.value);
  paraStatic += "&updttype="+encodeURI(AddForm.updttype.value);
  paraStatic += "&webpt002="+encodeURI(DisplayForm.webpd002.options[DisplayForm.webpd002.selectedIndex].value);
  paraStatic += "&webpt005=";
  paraStatic += "&webpt006=";
  paraStatic += "&webpt007=";
  paraStatic += "&webpt008=";
  paraStatic += "&webpt009=";
  paraStatic += "&webpt009=";

  sl = document.getElementsByTagName("INPUT");
  for (i=0; i < sl.length; i++) {
    if (sl[i].type=="checkbox") {
      if (sl[i].checked) {
       parameters = paraStatic +
                    "&webpt003="+encodeURI(sl[i].urnumber) +
                    "&webpt004="+encodeURI(sl[i].admissno);
       xmlHttp.open("POST", theURL, false);
       xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
       xmlHttp.send(parameters);
      }
    }
  }
  DisplayForm.submit();
}
function SelectOption(el) {
  linkTo=el.options[el.selectedIndex].value
  if (linkTo.match(/\?/)) {
    location.href=el.options[el.selectedIndex].value
  }
  else {
   eval(linkTo); 
  }
}
function ManagePatientFavorites() {
  DisplayForm.submit();
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);">
<span class=TitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Ward Patient Lists
</span>

<form name=AddForm method= post action=patweb02.pbl style="margin:0">
<input type=hidden name=reportno value="2">
<input type=hidden name=template value="004">
<input type=hidden name=updttype value="A">
<input type=hidden name=webpt002 value="">
<input type=hidden name=webpt003 >
<input type=hidden name=webpt004 >
<input type=hidden name=webpt007 >
<input type=hidden name=webpt008 >
<input type=hidden name=webpt009 >
<input type=hidden name=webpt010 >
</form>

<form name=DisplayForm action=patweb02.pbl method=get style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=4>
<input type=hidden name=updttype value=" ">
<table border=0 cellpadding=1 cellspacing=0 width=100%>
<tr>
  <td style='border:0;font-weight:bold;width:20%;' nowrap>Add Patients to List </td>
  <td>
     <select name=webpd002 class=SelectBig></select>
     <input type=button value=Add onclick='AddPatients();'>
  </td>
  <td style='border:0;' align=right>
    <select name=PatientLists onchange='SelectOption(this);' class=SelectBig>
      <option value='ManagePatientFavorites();'>My Patient Lists</option>
      <option value='patweb07.pbl?reportno=02&template=004' selected>My Recently Viewed</option>
      <option value='patweb97.pbl?reportno=01&template=011'>My Admitted Patients</option>
      <option value='patweb93.pbl?reportno=01&template=014'>Ward Patient List</option>
    </select>
  </td>
</tr>
</table>
</form>

<div id=TableLocation style='height:89%;overflow:auto;'></div>

<div style='display:none;'>
<table id=PatientList cellspacing=0 cellpadding=2 border=1 width=100%>
%PATWEB07.02.001
</table>
</div>
