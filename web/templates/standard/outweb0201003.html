<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true"> 
<script type="text/javascript" src="../js/ClinicList.js"></script>
<script type="text/javascript">
function init() {
  SetCookie("clinicSearchPath",document.URL);
  var selectedClinicGroup = GetCookieData("clinicGroup");
  if(document.SelectPeriod.filtercg.value!="1") { return; }
  if(selectedClinicGroup=="unknown") { return;}
  if(selectedClinicGroup.substr(0,3) !=
     document.SelectPeriod.srchcgrp.value.substr(0,3)) {
     var cgselect = document.SelectPeriod.srchcgrp;
     for (var i =0 ; i < cgselect.length; i++) {
        if (cgselect.options[i].value.substr(0,3)==
            selectedClinicGroup.substr(0,3)) {
            cgselect.selectedIndex=i } };
     document.SelectPeriod.submit();
  }
}
function GroupChange() {
 var temp = document.SelectPeriod.srchcgrp.value.substr(0,3);
 SetCookie("clinicGroup",temp);
 document.SelectPeriod.submit();
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link
//  1 - Day of Week
//  2 - Date & Start Time
//  3 - End Time
//  4 - Clinic Type
//  5 - Clinic
//  6 - Location 
//  7 - Empty Slots 
//  8 - New Patient
//  9 - Review Patient
// 10 - Special Patient	
// 11 - Doctor	
// 12 - Available Time	 
// 13 - Used Time	
//---------------------------------------------------------------------------
var view;
var flag=1;
function InitTable(TableView) {
  switch (TableView) {
    case 0:
      view=0;
      t = new Table(1,0,2,"100%","center",35,35);
      t.addColumn("Start","DateTime",2,2,"left","OPSessionIcon.gif","0",165);
      t.addColumn("End","String",24,24,"left","","",40);
      t.addColumn("Clinic Type","String",4,4,"left","","",160);
      t.addColumn("Clinic","String",5,5,"left","","",180);
      t.addColumn("Location","String",6,6,"left","","",130);
      t.addColumn("Empty","String",7,7,"right","","",40);
      t.addColumn(NewSlotDesc,"String",9,9,"right","","",40);
      t.addColumn(ReviewSlotDesc,"String",10,10,"right","","",40);
      t.addColumn(SpecialSlotDesc,"String",11,11,"right","","",40);
      AddTableRows();
      TableOutput(0,1);    // Order Column,Asc Dsc
      break;

    case 1:
      view=1;
      t = new Table(1,0,2,"100%","center",25,35);
      t.addColumn("Start","DateTime",2,2,"left","OPSessionIcon.gif","0",165);
      t.addColumn("End","String",24,24,"left","","",40);
      t.addColumn("Clinic Type","String",4,4,"left","","",160);
      t.addColumn("Clinic","String",5,5,"left","","",180);
      t.addColumn("Time Avail","String",13,13,"right","","",80);
      t.addColumn("Time Used","String",14,14,"right","","",80);
      AddTableRows();
      TableOutput(0,1);    // Order Column,Asc Dsc
      break;

    case 2:
      view=2;
      t = new Table(1,0,2,"100%","center",35,35);
      t.addColumn("Start","DateTime",2,2,"left","OPSessionIcon.gif","0",165);
      t.addColumn("End","String",24,24,"left","","",40);
      t.addColumn("Clinic Type","String",4,4,"left","","",160);
      t.addColumn("Clinic ","String",5,5,"left","","",180);
      t.addColumn("Doctor","String",12,12,"left","","",220);
      AddTableRows();
      TableOutput(0,1);    // Order Column,Asc Dsc
      break;
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);SetOutpatientList();">
<div id=HeadingSection>
<form name=SelectPeriod action=outweb02.pbl method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=3>
<input type=hidden name=viewtype value="%OUTWEB02.01.011">
<input type=hidden name=filtercg value="%OUTWEB02.01.055">
<input type=hidden name=viewopcl value="%OUTWEB02.01.061">

<table width="100%" bgcolor=#cccccc align=center cellpadding=2
 cellspacing=0 border=0>
<tr>
  <td><b>Views</b>
      <a href="javascript:InitTable(0)">
        <img src='../images/TableViewIcon.gif' border=0></a>
      <a href="javascript:InitTable(1)">
        <img src='../images/TableViewIcon.gif' border=0></a>
      <a href="javascript:InitTable(2)">
        <img src='../images/TableViewIcon.gif' border=0></a>
      <input type=button value="<<" class=SmallButton
       onclick='location.href="%OUTWEB02.01.002"'>
      %OUTWEB02.01.007
      <input type=button value=">>" class=SmallButton
       onclick='location.href="%OUTWEB02.01.001"'>
  </td>
  <td><span id="ClinicGroup" style="display:none">
      <table>
      <tr>
        <td class=DataLabel>%STANDARD.01.017.CG</td>
        <td><select name=srchcgrp class="Select" onchange="GroupChange()">
              <option value="   ">All</option>
              %STANDARD.01.007.CG
            </select>
        </td>
      </tr>
      </table>
      </span>
  </td>
  <td align=right>
    <a href='javascript:SelectDateFrame();'>
      <img src="../images/DateLookup.gif" border=0 align=absmiddle
       alt="Select Date" title="Select Date"></a>
    <a href='javascript:SelectView("0");'>
      <img src=../images/DayIcon.gif border=0 align=absmiddle
       alt="View Today" title="View Today"></a>
    <a href='javascript:SelectView("1");'>
      <img src=../images/WeekIcon.gif border=0 align=absmiddle
       alt="View This Week" title="View This Week"></a>
    <a href='javascript:SelectView("2");'>
      <img src=../images/MonthIcon.gif border=0 align=absmiddle
       alt="View This Month" title="View This Month"></a>
  </td>
</tr>
</table>
</form>
</div>

<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows() {
  %OUTWEB02.01.019.outweb02.02.004
}

DisplayClinicGroup="%OUTWEB02.01.055";
if (DisplayClinicGroup == "1") {
  ClinicGroup.style.display="";
  Group="%OUTWEB02.01.056";
  for (var i =0 ; i < document.SelectPeriod.srchcgrp.length; i++) {
    if (document.SelectPeriod.srchcgrp.options[i].value.substr(0,3)==
        Group.substr(0,3)) {
      document.SelectPeriod.srchcgrp.selectedIndex = i;
    }
  };
}
</script>

