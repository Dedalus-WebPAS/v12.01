<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);changeTitle();">

<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Update Pre By-Pass/By-Pass Details
</span>

<script type="text/javascript">
function setFormactn(type) 
{
  document.UpdateForm.updttype.value=type;

  if (type == "D")
  {
    ans=confirm("Are you sure you want to Delete?")
    if (ans) {
      document.UpdateForm.submit();  
    }
  }

  if (type == "U") 
  {  
    if (!validateMandatory(UpdateForm))
    {
      return; 
    }   
    f=document.UpdateForm;
    // if off date is not blank and off time is blank
    if(!isWhitespace(f.embps006.value) && isWhitespace(f.embps007.value)) {
      alert("Can't enter Off Pre/By-Pass date without time.");
      f.embps007.focus();
      return;
    }
    // if off date is blank and off time is not blank
    if(isWhitespace(f.embps006.value) && !isWhitespace(f.embps007.value)) {
      alert("Can't enter Off Pre/By-Pass time without date.");
      f.embps006.focus();
      return;
    }
    // check if off date/time is before on date/time
    if(!CheckDateTimeRange(f.embps003,f.embps004,f.embps006,f.embps007)) {
      alert("Off Pre/By-Pass date/time can't be before " + 
            "On Pre/By-Pass date/time.");
      f.embps006.focus();
      return;
    }

    validatePrinterCheckBox();
    if (!Validateresontxt()) { return; }
    document.UpdateForm.submit();  
  }
}

function init()
{
  var str1= trim("%EMRWEB07.03.018")
  var str2= trim("%EMRWEB07.03.019")
  var str3= trim("%EMRWEB07.03.020")
  var str4= trim("%EMRWEB07.03.021")
  var str5= trim("%EMRWEB07.03.022")

  if (!isWhitespace(str1) || !isWhitespace(str2) ||
      !isWhitespace(str3) || !isWhitespace(str4) ||
      !isWhitespace(str5))
  { 
    str1+="\n"
  }

  if (!isWhitespace(str2) || !isWhitespace(str3) || 
      !isWhitespace(str4) || !isWhitespace(str5))
  {
    str2+="\n"
  }

  if (!isWhitespace(str3) || !isWhitespace(str4) || 
      !isWhitespace(str5))
  {
    str3+="\n"
  }

  if (!isWhitespace(str4) || !isWhitespace(str5))
  { 
    str4+="\n"
  }

  UpdateForm.resontxt.value=str1+str2+str3+str4+str5;
}

function Validateresontxt()
{
  onblurHandler();
  var formatedtext=formateText(UpdateForm.resontxt,'100')
  if ((formatedtext.split(/[\r\n]/).length>5) ||
      (UpdateForm.resontxt.value.length > 500))
  {   
    alert("Reason for Pre/By-Pass comments - Max 5 lines."
           +"\nPlease remove extra rows to continue.");
    document.UpdateForm.resontxt.focus();
    return false;
  }
  return true;
}
</script>

<form name=UpdateForm method=post action=emrweb07.pbl style="margin:0">
 <input type=hidden name=reportno value="3">
 <input type=hidden name=template value="003">
 <input type=hidden name=updttype value="">
 <input type=hidden name=recordky value="%EMRWEB07.03.030">
 <input type=hidden name=embps001 value="%EMRWEB07.03.029">
 <input type=hidden name=d_embps002 value="%EMRWEB07.03.025">
 <input type=hidden name=embps008 value="%EMRWEB07.03.018">
 <input type=hidden name=embps009 value="%EMRWEB07.03.019">
 <input type=hidden name=embps010 value="%EMRWEB07.03.020">
 <input type=hidden name=embps011 value="%EMRWEB07.03.021">
 <input type=hidden name=embps012 value="%EMRWEB07.03.022">
 <input type=hidden name=printchk value=" ">

<table align=center width=100% border=0 cellspacing=1 cellpadding=1>
<tr>
  <td class=DataLabel>By-Pass Type</td>
  <td colspan=5>
    <input type="text" name=typedesc size=12 title="Type" 
     class="ReadOnly" value="%EMRWEB07.03.012">
  </td>
</tr>

<tr>
  <td class=DataLabel nowrap>
    <span id ="onDateTime">On Pre By-Pass Date/Time&nbsp;</span>
  </td>
  <td>
    <input type="text" name=embps003 size=12
     value="%EMRWEB07.03.013" class="Mandatory PastDate" title="Date">
    <img src=../images/DateLookup.gif class=Icon
     onclick="DateLookupFrame(UpdateForm.embps003);">
    <input type="text" name=embps004 size=8 class=Mandatory title="Time"
     value="%EMRWEB07.03.014">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(UpdateForm.embps003,UpdateForm.embps004);">
    <img src="../images/TimeLookup.gif" class=Icon
     onclick="TimeLookupFrame(UpdateForm.embps004);">
  </td>

  <td class=DataLabel nowrap align=center>
    <span id="prtlabel">Print Pre By-Pass Report</span>
  </td>
  <td>
    <input type="checkbox" class="checkbox" name="chkprint" 
     title="By-Pass Type" onclick="validatePrinterCheckBox();">
  </td>

  <td class=DataLabel style="text-align:right">Printer&nbsp;</td>
  <td>
    <select name=schdprnt title="Printer">
      <option></option>
      %STANDARD.01.001.IBAEMR23.01
    </select>
  </td>
</tr>

<tr>
  <td class=DataLabel nowrap>
    <span id="offDateTime">Off Pre By-Pass Date/Time&nbsp;</span>
  </td>
  <td>
    <input type="text" name=embps006 size=12 class="Date"
     value="%EMRWEB07.03.016" title="Date">
    <img src=../images/DateLookup.gif class=Icon
     onclick="DateLookupFrame(UpdateForm.embps006);">
    <input type="text" name=embps007 size=8 title="Time"
     value="%EMRWEB07.03.017">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(UpdateForm.embps006,UpdateForm.embps007);">
    <img src="../images/TimeLookup.gif" class=Icon
     onclick="TimeLookupFrame(UpdateForm.embps007);">
  </td>
  <td class=DataLabel style="text-align:center">Number of Ambulances</td>
  <td colspan=3>
    <input type=text name=embps013 value="%EMRWEB07.03.023"
     title="Ambulances" size=3 maxlength=3>
  </td>
</tr>

<tr>
  <td class=DataLabel><span id="reason">Reason for Pre By-Pass</span></td>
  <td colspan=5>
    <select name=embps005 class=Mandatory title="Reason">
      %EMRWEB07.03.015.2
    </select>
  </td>
</tr>

<tr>
  <td class=DataLabel>Doctor</td>
  <td nowrap>
    <input type="text" name=embps020 class=Mandatory title="Doctor Code" 
     size="8" maxlength="6" value="%EMRWEB07.03.031.0"
     onblur="ValidateHCP(18,0,UpdateForm.embps020,UpdateForm.doctname);"/>
    <input type="text" readonly class="ReadOnly" size="25"
     value="%EMRWEB07.03.031.1"
     title="Doctor Name" name="doctname" tabindex="-1"
     onfocus="this.blur();UpdateForm.embps020.focus();" />
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="HCPSearchFrame(UpdateForm.embps020,UpdateForm.doctname,0);" />
    <img src="../images/erase.gif" class=Icon
     onclick="clrDoc(UpdateForm.embps020,UpdateForm.doctname);" />
  </td>
  <td class=DataLabel style="text-align:right">Nurse&nbsp;&nbsp;&nbsp;</td>
  <td>
    <input type="text" name=embps021 size="20" maxlength="45" class="Mandatory"
     title="Nurse (Authorisation)" value="%EMRWEB07.03.032"/>
  </td>
  <td class=DataLabel nowrap style="text-align:right">Co-ordinator&nbsp;</td>
  <td>
    <input type="text" name=embps022 size="20" maxlength="45" class="Mandatory"
     title="Co-ordinator (Authorisation)" value="%EMRWEB07.03.033"/>
  </td>
</tr>

<tr>
  <td class=DataLabel>&nbsp;</td>
  <td colspan=5>
    <textarea type="text" name=resontxt wrap=hard cols=100 rows=5
     onkeydown="LimitText(this,5,500);" onblur="Validateresontxt();">
    </textarea>
  </td>
</tr>

<tr>
  <td colspan=6 align=center><br>
    <input type=button value="Update" class=button id="emr07u"
     onclick="tempDisable(this);setFormactn('U');">
    <input type=button value="Delete" class=button
     onclick="setFormactn('D');">
    <input type=button value="Cancel" class=button
     onclick="DFrameCloseRefresh();" >
  </td>
</tr>
</table>
</form>

<script type="text/javascript">
function validatePrinterCheckBox() 
{
  if (document.UpdateForm.chkprint!=undefined )
  {
    if(document.UpdateForm.chkprint.checked==true)
    {
      document.UpdateForm.printchk.value="1";
      document.UpdateForm.schdprnt.className = "Mandatory";
    }
    else
    {
      document.UpdateForm.printchk.value="0";
      document.UpdateForm.schdprnt.className = " ";
    }
  }
}

function changeTitle()
{
  if (document.UpdateForm.d_embps002.value=="0")
  {
    obj=document.getElementById("onDateTime");
    obj.innerText="On Pre By-Pass Date/Time";
    obj=document.getElementById("offDateTime");
    obj.innerText="Off Pre By-Pass Date/Time";
    obj=document.getElementById("reason");
    obj.innerText="Reason for Pre By-Pass";
    obj=document.getElementById("prtlabel");
    obj.innerText="Print Pre By-Pass Report";
  }
  else 
  {
    obj=document.getElementById("onDateTime");
    obj.innerText="On By-Pass Date/Time";
    obj=document.getElementById("offDateTime");
    obj.innerText="Off By-Pass Date/Time";
    obj=document.getElementById("reason");
    obj.innerText="Reason for By-Pass";
    obj=document.getElementById("prtlabel");
    obj.innerText="Print By-Pass Report";
  }
}
</script>
