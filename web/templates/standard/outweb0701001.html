<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">

function init() {
    if (UpdateForm.prntflag.value==1) {
        UpdateForm.printbut.disabled=true;
        UpdateForm.selprint.disabled=true;
        UpdateForm.selprint.className="Readonly";
        UpdateForm.nocopies.disabled=true;
    }
}

function DeleteItem(admissno,transnum) {
   ans=confirm("Are you sure you want to Delete this Item ?")
   if (ans) {
     ItemForm.updttype.value="D";
     ItemForm.transnum.value=transnum;
     ItemForm.submit();
    }
}

function UpdateItem(admissno,transnum) {
  var linkUrl="outweb07.pbl?reportno=03&template=001" +
              "&admissno=" + admissno.replace(/ /g,"+") +
              "&transnum=" + transnum.replace(/ /g,"+")
  var Left=(document.body.clientWidth-500)/2;
  DFrameLink(linkUrl,100,Left,500,350);
}

function SubmitPrt() {
  if(document.UpdateForm.invtotal.value<0) {
      ans= confirm("This invoice will be raised with a credit balance." +
          " \n\n Click OK to continue with raising an invoice or " +
          " Cancel to go back.")
       if (!ans) { return }
  }

  if (!validateVouchersandServices()) {return;}

  if (document.UpdateForm.ptcnppin.value=="1" &&
      document.UpdateForm.ppayable!=undefined) {

   if (trim(document.UpdateForm.ppayable.value) != ".00") {
      if(!confirm("'OK' to raise Health Fund Invoice with patient portion " +
        "included. \n " +
        "Cancel to Review Patient Only Invoice. "))
        {
        location.href="outweb07.pbl?reportno=1&template=003" +
           "&urnumber="+document.PatientLinks.urnumber.value.replace(/ /g,"+") +
           "&admissno="+document.PatientLinks.admissno.value.replace(/ /g,"+")
        return;
        }
     }
   }

  SubmitHidden(UpdateForm);
}
function validateVouchersandServices() {

//  var itemcount = 0;
//  var elementString = "";
//
//  if ( document.UpdateForm.ptcnuebb.value!="1") {return true;}
//
//  var elements = document.getElementsByTagName("img")
//  var dbselements = document.getElementsByTagName("dbsdate");
////alert(dbselements.length);
////alert(dbselements[0].value);
//  for (var i = 0; i < elements.length; i++) {
//
//    elementString = elements[i].src.toString();
//
//    if(elementString.indexOf("EditIcon") >= 0) {
////alert(elementString);
//      itemcount++;
//    }
//
//  }
////alert(itemcount);
//  if (itemcount > 14) {
//      alert(" Item count cannot exceed 14.");
//      return false;
//    }
//
//  return true;



  if (document.ItemForm.ecliuebb.value!="1" && 
      document.ItemForm.ecliudva.value!="1") {return true;}

  var vchsrvarray = new Array();

//  vchsrvarray[0] = new Array();
//  vchsrvarray[0][0] = document.ItemForm.vchseg26.value;
//  vchsrvarray[0][1] = document.ItemForm.vchseg05.value.substr(3,1);
//  vchsrvarray[0][2] = document.ItemForm.prhdclam.value;

  var elements = document.getElementsByTagName("dbsdate");
  var itemelements = document.getElementsByTagName("dbsitem");

  for (var i = 0; i < elements.length; i++) {

        itemfound = 0;

        for (var x = 0; x < vchsrvarray.length; x++) {
          if (vchsrvarray[x][0] == elements[i].value) {

            vchsrvarray[x][vchsrvarray[x].length] = itemelements[i].value
            itemfound = 1;
          }
        }

        if (itemfound == 0) {
          al = vchsrvarray.length;
          vchsrvarray[al] = new Array();
          vchsrvarray[al][0] = elements[i].value;
          vchsrvarray[al][1] = itemelements[i].value;
        }



  }

//alert(vchsrvarray.length);
//    for (x=0; x < vchsrvarray.length; x++) {
//      alert(vchsrvarray[x].length);
//      for (i=0; i < vchsrvarray[x].length; i++) {
//         alert(vchsrvarray[x][i]);
//      }
//    }

//alert(vchsrvarray.length);

  if (vchsrvarray.length > 80) {
    alert("Number of Vouchers cannot exceed 80.");
    return false;
  }

  for (x=0; x < vchsrvarray.length; x++) {
//alert(vchsrvarray[x].length);
    if (vchsrvarray[x].length > 14) {
      alert("Number of services for Voucher " +
            vchsrvarray[x][0].substr(6,2) + "/" +
            vchsrvarray[x][0].substr(4,2) + "/" +
            vchsrvarray[x][0].substr(0,4) +
            " cannot exceed 14.");
      return false;
    }
  }

  return true;


}
function RaiseABF() {
  document.UpdateForm.prabfinv.value="1";
  SubmitPrt();
}

function ABFDetail() {
    Left=(document.body.clientWidth-600)/2
    LinkURL="outweb07.pbl?reportno=01&template=002&urnumber=" +
             document.UpdateForm.urnumber.value.replace(/ /g,"+") +
            "&admissno=" +
             document.UpdateForm.admissno.value.replace(/ /g,"+")
      Left=(document.body.clientWidth-550)/2;
      DFrameLink(LinkURL,100,Left,550,350);
}

</script>
</head>
<body onload="PageLoad(event);setTimeout('init();',350);">
%START.OF.PAGE
<table cellspacing=0 cellpadding=1 border=0 width=100%>
<tr><td>
<div id=PatientHeading></div>
</td></tr>
</table>
<script type="text/javascript">
PatientURN="%OUTWEB07.01.003";
PatientVIS="%OUTWEB07.01.081";
PatientNAM="%OUTWEB07.01.002";
PatientSTA="%OUTWEB07.01.086.078";
PatientALT="%OUTWEB07.01.084";
PatientSEX="%OUTWEB07.01.019";
PatientDOB="%OUTWEB07.01.020";
PatientAGE="%OUTWEB07.01.021";
PatientLOC="%OUTWEB07.01.083";
PatientPRI="%OUTWEB07.01.086.066.1";
PatientUNT="%OUTWEB07.01.066.0";
DoctorCOD="%OUTWEB07.01.082.003";
DoctorNAM="%OUTWEB07.01.082.002";
PatientAID="%OUTWEB07.01.086.090";
PatientIND="%OUTWEB07.01.086.091";
PatientCUR="%OUTWEB07.01.086.092";
PatientCLC="%OUTWEB07.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OUTWEB07.01.086.094";
PatientCDM="%OUTWEB07.01.086.095";
PatientVDH="%OUTWEB07.01.086.099.015";
InsertPatientHeader()
</script>
<div id="PatientMenu"></div>

<div id="PageBodySection">
<table cellspacing=0 cellpadding=1 border=0 width=100%>
  <tr><td align=center class=HeadingCell>
    Outpatient Invoice</td>
      <td align=center class=HeadingCell>
          %OUTWEB07.01.105</td>
    </tr>
</table>

<form name=UpdateForm action="outweb07.pbl" method=post
 onsubmit="return validateMandatory(this);">
    <input type=hidden name=reportno value=2>
    <input type=hidden name=template value=001>
    <input type=hidden name=nextpage value="4">
    <input type=hidden name=prntflag value="%OUTWEB07.01.104">
    <input type=hidden name=pabfflag value="%OUTWEB07.01.119">
    <input type=hidden name=urnumber value="%OUTWEB07.01.003">
    <input type=hidden name=admissno value="%OUTWEB07.01.081">
    <input type=hidden name=invtotal value="%OUTWEB07.01.116">
    <input type="hidden" name=redirect value="%OUTWEB07.01.001.patweb98.01.001">
    <input type=hidden name=clinindc value="%OUTWEB07.01.202">
    <input type=hidden name=ptcnuebb value="%STANDARD.01.025.127.122.0.1">
    <input type=hidden name=ptcndvaw value="%STANDARD.01.025.129.249.0.1">
    <input type=hidden name=obacompd value="%OUTWEB07.01.201">
    <input type="hidden" name=racluebb id=racluebb value="0">
    <input type="hidden" name=racludva id=racludva value="0">
  <input type=hidden name=ptcnuabf id=ptcnuabf
   value="%STANDARD.01.025.128.105.0.1">
  <input type="hidden" name=abfindic id=abfindic value="%OUTWEB07.01.204">
  <input type="hidden" name=prabfinv value="%OUTWEB07.01.118">
  <input type=hidden name=ptcnppin id=ptcnppin
   value="%STANDARD.01.025.129.089.0.1">
  <input type=hidden name=inviactv id=inviactv value="%OUTWEB07.01.206">

<table border=1 cellspacing=0 cellpadding=2 width=100%>
%OUTWEB07.01.102
</table>

<table border=0 cellpadding=2 cellspacing=0 width=95% align=center>
<tr><td class=DataLabel>Printer</td> 
    <td><select name=selprint class=Mandatory> 
        %STANDARD.01.001.OUTWEB07.02
        </select></td>
    <td DataLabel>Copies</td>
    <td><select name=nocopies>
        <option value=" 1">1</option>
        <option value=" 2">2</option>
        <option value=" 3">3</option>
        <option value=" 4">4</option>
        <option value=" 5">5</option>
        <option value=" 6">6</option>
        <option value=" 7">7</option>
        <option value=" 8">8</option>
        <option value=" 9">9</option>
        <option value=" 10">10</option>
        </select></td></tr>
<tr><td align=center colspan=4>
    <input type=button value="Raise" class="button" name=printbut
     id=printbut
     onclick='tempDisable(this,30);SubmitPrt();'>
    <div id="RaiseClaimDBSDIV" style="display: inline"></div>
    <div id="RaiseClaimDVWDIV" style="display: inline"></div>
    <div id="ABFMTXDIV" style="display: inline"></div>
    <input type=button value="Add Items" class="button" 
     onclick="tempDisable(this);AddItem();"
     name=addbuttn id=addbuttn>
    <input type=button class="button" name=comntbut value="Billing Comments"
     id=comntbut onclick="tempDisable(this);Comments();">
  </td></tr>
</table>
</form>
</div>
<form name="PatientLinks" method="get">
<input type="hidden" name="reportno" value="1">
<input type="hidden" name="template" value="004">
<input type="hidden" name="urnumber" value="%OUTWEB07.01.003">
<input type="hidden" name="admissno" value="%OUTWEB07.01.081">
<input type="hidden" name="MenuType" value="%OUTWEB07.01.088">
</form>

<form name="ItemForm" method=post action="patweb71.pbl">
<input type="hidden" name="reportno" value="1">
<input type="hidden" name="template" value="001">
<input type="hidden" name="urnumber" value="%OUTWEB07.01.003">
<input type="hidden" name="admissno" value="%OUTWEB07.01.081">
<input type="hidden" name="updttype" value="D">
<input type="hidden" name="transnum" value="">
<input type="hidden" name="redirect" value="%OUTWEB07.01.001.outweb07.01.001">
<input type="hidden" name="nextpage" value="1">
<input type="hidden" name=ecliuebb value="%OUTWEB07.01.203">
<input type="hidden" name=ecliudva value="%OUTWEB07.01.207">
</form>

<span id=RaiseClaimDBSSPAN style="display:none">
    <input type=button value="Raise and Claim" class="button" name=printinvdbs
     id="raiseandcbutton" onclick='tempDisable(this);
                               document.UpdateForm.racluebb.value="1";
                               SubmitPrt();'>
</span>

<span id=RaiseClaimDVWSPAN style="display:none">
    <input type=button value="Raise and Claim" class="button" name=printinvdvw
     id="raiseandcbutton" onclick='tempDisable(this);
                               document.UpdateForm.racludva.value="1";
                               SubmitPrt();'>
</span>

<span id=ABFSPAN style="display:none">
    <input type="button" value="Raise ABF" name="printabf" class="button"
                  id="printabf"
                  onclick="tempDisable(this);RaiseABF();" />
    <input type="button" value="ABF Details" name="abfbutton" class="button"
                  id="abfbutton"
                  onclick="tempDisable(this);ABFDetail();" />
</span>

<span id=NONABFSPAN style="display:none">
</span>

<script type="text/javascript">

function AddItem() {
    Urnumber=UpdateForm.urnumber.value.replace(/ /g,"+");
    Admissno=UpdateForm.admissno.value.replace(/ /g,"+");
    Left=(document.body.clientWidth-940)/2
    if (document.ItemForm.ecliuebb.value==1) {
      LinkURL="patweb75.pbl?reportno=01&template=010&urnumber=" + Urnumber +
              "&admissno=" + Admissno
    } else {
      LinkURL="patweb75.pbl?reportno=01&template=001&urnumber=" + Urnumber +
              "&admissno=" + Admissno
    }
    DFrameLink(LinkURL,50,Left,940,400);
 }

CmntIndic="%OUTWEB07.01.117";
if ( CmntIndic =="1" ) {
   document.UpdateForm.comntbut.className="RedButton";
}

function Comments() {
  LinkURL="cliweb06.pbl?reportno=12&template=007&urnumber=" +
           document.UpdateForm.urnumber.value.replace(/ /g,"+") +
          "&admissno=" +
           document.UpdateForm.admissno.value.replace(/ /g,"+") +
          "&notetype=003"
  Left=(document.body.clientWidth-880)/2
  DFrameLink(LinkURL,50,Left,880,300);
}

if (document.ItemForm.ecliuebb.value==1) {
  RaiseClaimDBSDIV.innerHTML=RaiseClaimDBSSPAN.innerHTML;
  if (UpdateForm.prntflag.value==1) {
    UpdateForm.printinvdbs.disabled=true;
  }
}

if (document.ItemForm.ecliudva.value==1) {
  RaiseClaimDVWDIV.innerHTML=RaiseClaimDVWSPAN.innerHTML;
  if (UpdateForm.prntflag.value==1) {
    UpdateForm.printinvdvw.disabled=true;
  }
}

if((document.getElementById('ptcnuabf').value == "1") &&
   (document.getElementById('abfindic').value == "1")) {
        ABFMTXDIV.innerHTML=ABFSPAN.innerHTML;
       if (UpdateForm.pabfflag.value==1) {
         UpdateForm.printabf.disabled=true;
       }
} else {
        ABFMTXDIV.innerHTML=NONABFSPAN.innerHTML;
}

if (UpdateForm.inviactv.value == "1") {
  UpdateForm.printbut.disabled = true;
  if (document.getElementById('raiseandcbutton') != undefined) {
    document.getElementById('raiseandcbutton').disabled = true;
  }
}

</script>

