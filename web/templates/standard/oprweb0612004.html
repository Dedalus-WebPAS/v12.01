<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb06.js"></script>
<script type="text/javascript">
function validateFF() {
  if (!isWhitespace(document.UpdateForm.opsdt001.value)) {

    document.UpdateForm.updatety.value = "P";
    document.UpdateForm.opsdt004.value = document.UpdateForm.stffname.value;
    document.UpdateForm.opsdt005.value = document.UpdateForm.optsm003.value;
    document.UpdateForm.opsdt006.value = document.UpdateForm.optsm004.value;
    document.UpdateForm.opsdt007.value = document.UpdateForm.optsm005.value;
    document.UpdateForm.opsdt008.value = document.UpdateForm.optsm006.value;

    if (document.UpdateForm.optsm009 != undefined) {
      if (document.UpdateForm.optsm009.checked) {
        document.UpdateForm.opsdt011.value = 1;
      } else {
        document.UpdateForm.opsdt011.value = 0;
      }
    }

  }
}
function validateData() {
  strtDate = UpdateForm.optsm003;
  strtTime = UpdateForm.optsm004;
  endDate  = UpdateForm.optsm005;
  endTime  = UpdateForm.optsm006;
  if(!ChkDateTime(strtDate,null,endDate,null)) {
    alert("Start Date must be before End Date");
    UpdateForm.optsm003.select();
    return;
  }
     bool1=isWhitespace(UpdateForm.optsm005.value);
     bool2=!isWhitespace(UpdateForm.optsm006.value); 
     if(bool1&&bool2){
       alert("End time cannot be entered without End Date");
       UpdateForm.optsm005.select();
       return;
     } 
     if((!bool1) && (!bool2)){
       alert("End time must be entered with End Date");
       UpdateForm.optsm006.select();
       return;
     } 

  validateFF();

  UpdateForm.optsm001.disabled=false
  UpdateForm.submit();    
}
function showLayer(UpdateForm) {
  if ((document.UpdateForm.optsm001.value)==0 || 
      (document.UpdateForm.optsm001.value)==1) {
    Layer1.style.display='';
    Layer2.style.display='none'; 
    Layer3.style.display='none'; 
    move(UpdateForm.combo1);
    UpdateForm.combo1.className="Mandatory"
    UpdateForm.combo2.className="";
    UpdateForm.combo3.className="";
  }
  else {
       if ((document.UpdateForm.optsm001.value)==2) {
            Layer2.style.display='';
            Layer1.style.display='none'; 
            Layer3.style.display='none'; 
            move(UpdateForm.combo2);
            UpdateForm.combo1.className="";
            UpdateForm.combo2.className="Mandatory";
            UpdateForm.combo3.className="";}
         else {
              if ((document.UpdateForm.optsm001.value)==3) {
                   Layer3.style.display='';
                   Layer1.style.display='none'; 
                   Layer2.style.display='none'; 
                   move(UpdateForm.combo3);
                   UpdateForm.combo1.className="";
                   UpdateForm.combo2.className="";
                   UpdateForm.combo3.className="Mandatory"} } }
}
function move(comb) {
    UpdateForm.optsm008.value=comb.value;
}
function valfirst() {
    if(document.UpdateForm.optsm001.value=="")
       alert(" Select StaffType First");
    else return true;
}
function getCode(flag) {
if(valfirst()) {
 if (((document.UpdateForm.optsm001.value)==0) || 
     ((document.UpdateForm.optsm001.value)==1)){
   if(flag==0)
   DoctorSearchFrame(document.UpdateForm.optsm002,document.UpdateForm.stafdesc);
   if(flag==1){
   validateCode(3,document.UpdateForm.optsm002,document.UpdateForm.stafdesc);
      }
   }
else {
  if((document.UpdateForm.optsm001.value)==2) {
    if(flag==0)
    SearchOTNurse(document.UpdateForm.optsm002,document.UpdateForm.stafdesc);
    if(flag==1) {
    validateNurse(document.UpdateForm.optsm002,document.UpdateForm.stafdesc)
    }
  }
  else {
    if(flag==0)
    HCPSearchFrame(document.UpdateForm.optsm002,document.UpdateForm.stafdesc,0);
    if(flag==1) {
    ValidateHCP(18,0,document.UpdateForm.optsm002,document.UpdateForm.stafdesc)
    }
  }
    }
  }
}
function validateNurse() {
  var hcpnurse = chkHcpOTNurse();
  if  (hcpnurse==true){
      validateCode('18',document.UpdateForm.optsm002,
                        document.UpdateForm.stafdesc);
  }
  else {
      validateCode('17',document.UpdateForm.optsm002,
                        document.UpdateForm.stafdesc,
                        document.UpdateForm.gnm,
                        SetNurseName);
  }
}
function SetNurseName() {
UpdateForm.stafdesc.value=UpdateForm.gnm.value.replace(/\s*$/g,"")+
                              " " +
                            UpdateForm.stafdesc.value.replace(/\s*$/g,"")
}
function update(type) {
    if(type=="M") {
       if(validateMandatory(UpdateForm)) {
         UpdateForm.updatety.value=type;
         validateData(); 
       }
    }
    else {
      if (UpdateForm.optsm001.value=="0") {
         alert("Cannot Delete Operating Surgeon");
        }
      else {
           ans=confirm("Are you sure you want to delete");
           if(ans) {
             UpdateForm.updatety.value=type;

             if (!isWhitespace(document.UpdateForm.opsdt001.value)) {
               UpdateForm.updatety.value="T";
             }

             UpdateForm.optsm001.disabled=false
             UpdateForm.submit();
           }
        }
    }
}
function StaffType() {
  if (UpdateForm.optsm001.value=="2") {
    document.all.StaffOption.innerHTML=document.all.NurseType.innerHTML 
    if (UpdateForm.finalcnt.value=="1") UpdateForm.optsm009.checked=1;
   }
  else{
     document.all.StaffOption.innerHTML="";
  }
}
function StaffLook() {
//  if (UpdateForm.optsm001.value=="0") 
    document.all.StaffCode.innerHTML=document.all.StaffIcon.innerHTML;
//  else 
//    document.all.StaffCode.innerHTML=document.all.StaffNoIcon.innerHTML;
}
function init() {
    showLayer(UpdateForm)
    StaffType();
    StaffLook();
}

function valDoctor(dcode) {
  var code = dcode.value.toUpperCase();
  document.UpdateForm.optsm002.value = code;
  getCode(1);
}
function displayFF() {
  if (!isWhitespace(document.UpdateForm.opsdt001.value)) {
    document.UpdateForm.optsm001.disabled = false;

    for (var i =0 ; i < document.UpdateForm.optsm001.length; i++) {
      if (document.UpdateForm.optsm001.options[i].value==
          document.UpdateForm.opsdt003.value.substr(1,1)) {
        document.UpdateForm.optsm001.selectedIndex=i;
      }
    }

    staffcodetitleDIV.innerHTML = staffnametitleSPAN.innerHTML;
    StaffCode.innerHTML = staffnamefieldSPAN.innerHTML;
    document.UpdateForm.stffname.value = document.UpdateForm.opsdt004.value;
    document.UpdateForm.optsm003.value = document.UpdateForm.opsdt005.value;
    document.UpdateForm.optsm004.value = document.UpdateForm.opsdt006.value;
    document.UpdateForm.optsm005.value = document.UpdateForm.opsdt007.value;
    document.UpdateForm.optsm006.value = document.UpdateForm.opsdt008.value;

    showLayer(UpdateForm);

    if (document.UpdateForm.combo1 != undefined) {
      for (var i =0 ; i < document.UpdateForm.combo1.length; i++) {
        if (document.UpdateForm.combo1.options[i].value.substr(0,3)==
            document.UpdateForm.opsdt010.value) {
          document.UpdateForm.combo1.selectedIndex=i;
        }
      }
    }
    if (document.UpdateForm.combo2 != undefined) {
      for (var i =0 ; i < document.UpdateForm.combo2.length; i++) {
        if (document.UpdateForm.combo2.options[i].value.substr(0,3)==
            document.UpdateForm.opsdt010.value) {
          document.UpdateForm.combo2.selectedIndex=i;
        }
      }
    }
    if (document.UpdateForm.combo3 != undefined) {
      for (var i =0 ; i < document.UpdateForm.combo3.length; i++) {
        if (document.UpdateForm.combo3.options[i].value.substr(0,3)==
            document.UpdateForm.opsdt010.value) {
          document.UpdateForm.combo3.selectedIndex=i;
        }
      }
    }

    StaffType();
    if (document.UpdateForm.optsm009 != undefined) {
      if (document.UpdateForm.opsdt011.value == "1") {
        document.UpdateForm.optsm009.checked = true;
      }
    }


    document.UpdateForm.optsm001.disabled = true;
  }


  if (document.UpdateForm.combo1 != undefined) {
    if (document.UpdateForm.combo1.value.substr(6,1) == "R") {
      document.UpdateForm.combo1.disabled = true;
    }
  }
  if (document.UpdateForm.combo2 != undefined) {
    if (document.UpdateForm.combo2.value.substr(6,1) == "R") {
      document.UpdateForm.combo2.disabled = true;
    }
  }
  if (document.UpdateForm.combo3 != undefined) {
    if (document.UpdateForm.combo3.value.substr(6,1) == "R") {
      document.UpdateForm.combo3.disabled = true;
    }
  }
}
function getaddStaffCOOKIE() {
  if (GetCookieData("addStaffCOOKIE") != "unknown") {
    ExpireCookiePath("addStaffCOOKIE");
    StaffHeading.innerHTML = JMPHHead.innerHTML;
    return;
  } else {
    if (document.UpdateForm.jmphflag!="undefined") {
      if (document.UpdateForm.jmphflag.value=="1") {
          StaffHeading.innerHTML = JMPHHead.innerHTML;
          return;
      }
    }
  }
  StaffHeading.innerHTML = StdHead.innerHTML;
}
//C-0825792 - Check parameter to Use pmshcpaf/oprnuraf for OT Nurse
function chkHcpOTNurse(){
  if (document.getElementById('opcnurse')) {
      if (document.getElementById('opcnurse').value == "1") {
        return true;
      }
      else {
        return false;
      }
  }
  else {
      return false;
  }
}
//C-0825792 - Search Nurse from pmshcpaf/oprnuraf for OT Nurse
function SearchOTNurse(NurseId,ReturnNurseName) {
  var hcpnurse = chkHcpOTNurse();
  if (hcpnurse==true){
     HCPSearchFrame(NurseId,ReturnNurseName,20);
  }
  else {
     NurseSearchFrame(NurseId,ReturnNurseName);
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);getaddStaffCOOKIE();showLayer(UpdateForm);displayFF();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
<div id=StaffHeading></div>
</span>
<form id=UpdateForm name=UpdateForm action="oprweb06.pbl" method=post 
onsubmit="return validateMandatory(this)">
<input type=hidden name=reportno value=12>
<input type=hidden name=template value=004>
<input type=hidden name=updatety value="">
<input type=hidden name=casekeys value="%OPRWEB06.12.101">
<input type=hidden name=teamnumb value="%OPRWEB06.12.334">
<input type=hidden name=optsm008 > 
<input type=hidden name=finalcnt value="%OPRWEB06.12.310"> 
<input type=hidden name=savkey01 value="%OPRWEB06.12.312">
<input type=hidden name=savkey76 value="%OPRWEB06.12.228">
<input type=hidden name=gnm id=gnm>
<input type=hidden name=opsdt001 value="%OPRWEB06.12.901">
<input type=hidden name=opsdt002 value="%OPRWEB06.12.902">
<input type=hidden name=opsdt003 value="%OPRWEB06.12.903">
<input type=hidden name=opsdt004 value="%OPRWEB06.12.904">
<input type=hidden name=opsdt005 value="%OPRWEB06.12.905">
<input type=hidden name=opsdt006 value="%OPRWEB06.12.906">
<input type=hidden name=opsdt007 value="%OPRWEB06.12.907">
<input type=hidden name=opsdt008 value="%OPRWEB06.12.908">
<input type=hidden name=opsdt009 value="%OPRWEB06.12.909">
<input type=hidden name=opsdt010 value="%OPRWEB06.12.910">
<input type=hidden name=opsdt011 value="%OPRWEB06.12.911">
<input type=hidden name=opsdt012 value="%OPRWEB06.12.912">
<input type=hidden name=updopsdt value="%OPRWEB06.12.229">
<input type=hidden name=jmphflag value="%OPRWEB06.12.361">
<input type=hidden name=opcnurse id=opcnurse
       value="%STANDARD.01.025.113.051.0.1">

<table align=center cellspacing=0 cellpadding=3 border=0 width=95%>
<tr><td class=DataLabel>Staff Type</td>
    <td class=DataField colspan=2>
    <select name=optsm001 class=Mandatory disabled>
     %OPRWEB06.12.318.0
    </select></td></tr>
<tr><td class=DataLabel><div id="staffcodetitleDIV">Staff Code</div></td>
    <td><span id=StaffCode></span></td>
</tr>

<tr><td class=DataLabel>Start Date</td>
    <td class=DataLabel colspan=2>
    <input type=text size=12 id=optsm003 name=optsm003
     value="%OPRWEB06.12.320"  title="start date" class=Mandatory>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.optsm003>
    Time
    <input type=text size=12 id=optsm004 name=optsm004
     value="%OPRWEB06.12.321" title="start Time" class=Mandatory>
    <img src=../images/DateTimeStamp.gif class=Icon 
     date=UpdateForm.optsm003 time=UpdateForm.optsm004> 
    <img src=../images/TimeLookup.gif class=Icon time=UpdateForm.optsm004>
    </td></tr>
<tr><td class=DataLabel>End Date</td>
    <td class=DataLabel colspan=2>
    <input type=text size=12 id=optsm005 name=optsm005
     value="%OPRWEB06.12.322"  title="End Date" >
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.optsm005>
    Time
    <input type=text size=12 id=optsm006 name=optsm006
     value="%OPRWEB06.12.323" title="End Time" >
    <img src=../images/DateTimeStamp.gif class=Icon 
     date=UpdateForm.optsm005 time=UpdateForm.optsm006>
    <img src=../images/TimeLookup.gif class=Icon time=UpdateForm.optsm006>
    </td></tr>
<tr><td class=DataLabel>Staff Category</td>
    <td class=DataField colspan=2>
    <div id="Layer1" style="display: none;">
    <select id=combo1 name=combo1 onchange=move(combo1) title="Staff Category">
    <option></option>
     %OPRWEB06.12.331.2
    </select>
    </div>
    <div id="Layer2" style="display: none;">
    <select id=combo2 name=combo2 onchange=move(combo2) title="Staff Category">
    <option></option>
     %OPRWEB06.12.332.2
    </select>
    </div>
    <div id="Layer3" style="display: none;">
    <select id=combo3 name=combo3 onchange=move(combo3) title="Staff Category">
    <option></option>
<!-- %OPRWEB06.12.327.2  -->
<!--          Cat."OF" reject Ind.1 = "R" (Reason for Referral) -->
     %OPRWEB06.12.327.9.1.01.2.R
    </select>
    </div>
    </td></tr>
</table>
<span id=StaffOption></span>
<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td colspan=3 align=center>
<br><input type=button id="opr06sub" value="Update" class="button" 
    onclick="tempDisable(this);update('M');">
    <input type=button value="Delete" class="button" onclick="update('R')">
    <input type=button value="Cancel" class="button" 
     onclick="DFrameExitRefresh();">
    </td></tr>
</table>
</form>
<span id=NurseType style="display:none">
<table width=95% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel width=22%>Final Instrument Count</td>
    <td class=DataField><input type=checkbox name=optsm009
         title="Instrument Count" value="1"></td></tr>
</table>
</span>

<span id=StaffIcon style="display:none">
    <input type=text  name=optsm002 size=6 value="%OPRWEB06.12.319.1"
     title="Staff Code" class="Mandatory" onblur="valDoctor(this);">
    <input type=text name=stafdesc class=ReadOnly readonly
     value="%OPRWEB06.12.319.0">
    <img src=../images/SearchIcon.gif class=Icon onclick="getCode(0);">
</span>
<span id=StaffNoIcon style="display:none">
    <input type=text  name=optsm002 size=6 value="%OPRWEB06.12.319.1"
     title="Staff Code" class="ReadOnly" readonly >
    <input type=text name=stafdesc class=ReadOnly readonly
     value="%OPRWEB06.12.319.0">
</span>

<span id="staffnametitleSPAN" style="display:none">Staff Member Name</span>

<span id="staffnamefieldSPAN" style="display:none">
    <input type=text  name=stffname  size=80 title="Staff Member Name"
     maxlength=60 class=Mandatory>
</span>
<span id=JMPHHead style="display:none">
    Jessie McPerson In - Theatre Details - Update Staff
</span>

<span id=StdHead style="display:none">
    Day Procedures - Staff Member Maintenance
</span>

