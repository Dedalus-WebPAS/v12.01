<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" > 
function UpdateClosure() {
  if (validateMandatory(UpdateForm)) 
    if (chkClosurePeriod()) {
      UpdateForm.updttype.value = "U";
      UpdateForm.submit();
    }
}

function DeleteClosure() {
  if(document.UpdateForm.superflg.value=="1"){
    setFormactn('D');
  } else {
    if (UpdateForm.profrind.value == "0" &&
      UpdateForm.protoind.value == "0"){    // Closure has not been processed
       setFormactn('D');
    } else {
      SetCurrentDateTimeNoFocus(document.getElementById('currdate'), null);
      if (SetDateYYYYMMDD(document.getElementById('currdate').value) ==
          SetDateYYYYMMDD(document.getElementById('pmsbc003').value) &&
          SetDateYYYYMMDD(document.getElementById('currdate').value) ==
          SetDateYYYYMMDD(document.getElementById('pmsbc005').defaultValue)) {
        alert("Bed Closure partially processed - can not delete.");
      } else {
        if (SetDateYYYYMMDD(document.getElementById('pmsbc003').value) <=
            SetDateYYYYMMDD(document.getElementById('currdate').value) &&
            SetDateYYYYMMDD(document.getElementById('currdate').value) <=
            SetDateYYYYMMDD(document.getElementById('pmsbc005').defaultValue)) {
          alert("Bed Closure partially processed - can not delete.");
        } else {
          setFormactn('D');   
        }
      }
    }
  }
}

function chkClosurePeriod() {
  var frmDate = document.UpdateForm.pmsbc003;
  var frmTime = document.UpdateForm.pmsbc004;
  var toDate = document.UpdateForm.pmsbc005;
  var toTime = document.UpdateForm.pmsbc006;

  // Ensure that all fields that specify the Closure period are entered.
  if (isWhitespace(frmDate.value)) {
    alert("Close From Date must be entered in order to close beds.");
    return false;
  }
  if (isWhitespace(frmTime.value)) {
    alert("Close From Time must be entered in order to close beds.");
    return false;
  }
  if (isWhitespace(toDate.value)) {
    alert("Close To Date must be entered in order to close beds.");
    return false;
  }
  if (isWhitespace(toTime.value)) {
    alert("Close To Time must be entered in order to close beds.");
    return false;
  }

  // "Close To Date and Time" must be greater than "Close From Date and Time".
  if(ChkDateTime(frmDate,frmTime,toDate,toTime))
    return true;
  else
    alert("Close To Date/Time must be greater then Close From Date/Time.");
  
  return false;
}
function CheckFree() {
  if(document.UpdateForm.pmsbc007.value.substr(4,1)=="F") {
      document.getElementById("FreeFormat").innerHTML=
      document.getElementById("DisplayFreeFormat").innerHTML;
  } else if (document.UpdateForm.pmsbc007.value.substr(3,1)=="H") {
      document.getElementById("FreeFormat").innerHTML=
      document.getElementById("DisplayHoldHCP").innerHTML;
  } else {
      document.getElementById("FreeFormat").innerHTML=
      document.getElementById("NoFreeFormat").innerHTML;
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);CheckFree();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Bed Closure Maintenance
</span>

<form name=UpdateForm method=post action=patweb95.pbl style="margin:0">
<input type=hidden name=reportno value="6">
<input type=hidden name=template value="001">
<input type=hidden name=updttype value="">
<input type=hidden name=pmsbc001 value="%PATWEB95.06.001">
<input type=hidden name=pmsbc002 value="%PATWEB95.06.002">
<input type=hidden name=profrind value="%PATWEB95.06.014">
<input type=hidden name=protoind value="%PATWEB95.06.015">
<input type=hidden name=superflg value="%PATWEB95.06.101">
<input type=hidden name=currdate id=currdate value="">

<table align=center width=95% border=0 cellpadding=1 cellspacing=1>
<tr><td class=DataLabel width=35%>Close From Date</td>
    <td class=DataField>
      <input type=text name=pmsbc003 id=pmsbc003 title="Closed From Date"
       size=12 class=ReadOnly readonly value="%PATWEB95.06.003"></td></tr>

<tr><td class=DataLabel>Close From Time</td>
    <td class=DataField>
      <input type=text name=pmsbc004 title="Close From Time"
       size=12 class=ReadOnly readonly value="%PATWEB95.06.004"></td></tr>

<tr><td class=DataLabel>Close To Date</td>
    <td class=DataField>
      <input type=text name=pmsbc005 id=pmsbc005 title="Closed From Date" 
       size=12 maxlength=12 class=Mandatory value="%PATWEB95.06.005">
      <img src=../images/CalendarLookup.gif class="Icon"
       onclick="DateLookupFrame(UpdateForm.pmsbc005);"></td></tr>

<tr><td class=DataLabel>Close To Time</td>
    <td class=DataField>
      <input type=text name=pmsbc006 title="Close From Time"
       size=12 maxlength=12 class=Mandatory value="%PATWEB95.06.006">
      <img src=../images/DateTimeStamp.gif class="Icon"
       onclick="SetCurrentDateTime(null,UpdateForm.pmsbc006);">
      <img src=../images/TimeLookup.gif class="Icon"
       onclick="TimeLookupFrame(UpdateForm.pmsbc006);"></td></tr>

<tr><td class=DataLabel>Reason</td>
    <td class=DataField>
      <select name=pmsbc007 title="Reason" onchange="CheckFree();">
         %PATWEB95.06.007.2
        </select></td></tr>
</table>

<div id=FreeFormat></div>
<div id=HoldHCP></div>

<table align=center width=95% border=0 cellpadding=1 cellspacing=1>
<tr><td colspan=2 align=center><br>
   <input type=button value="Update" class="button" id="btnUpd"
    onclick="tempDisable(this);UpdateClosure();">
   <input type=button value="Delete" class="button"
    onclick="DeleteClosure();">
   <input type=button value="Cancel" class="button" 
    onclick="DFrameCloseRefresh();">
</td></tr>

</table>
</form>

<span id="DisplayFreeFormat" style="display:none;">
<table align=center width=95% border=0 cellpadding=1 cellspacing=1>
<tr><td class=DataLabel width=35%>Reason Comments</td>
    <td class=DataField><input type=text name=pmsbc014 class=Mandatory
     value="%PATWEB95.06.016" size=52 maxlength=50 title="Reason Comments">
    <input type=hidden name=pmsbc015 value="">
    </td></tr>
</table>
</span>

<span id="NoFreeFormat" style="display:none;">
<input type=hidden name=pmsbc014 value="">
<input type=hidden name=pmsbc015 value="">
</span>

<span id="DisplayHoldHCP" style="display:none;">
<table align=center width=95% border=0 cellpadding=1 cellspacing=1>
<tr><td class=DataLabel width=35%>HCP</td>
    <td class=DataField>
    <input type=hidden name=pmsbc014 value="">
    <input type=text name=pmsbc015 class=Mandatory title="HCP"
     size=10 maxlength=10 value="%PATWEB95.06.017.1"
     onblur="ValidateHCP(18,14,UpdateForm.pmsbc015,UpdateForm.hcp);">
    <input type=text name=hcp class=Readonly readonly title="HCP"
     size=24 maxlength=24 value="%PATWEB95.06.017.0">
    <img src="../images/SearchIcon.gif" class="Icon"
     onclick="HCPSearchFrame(UpdateForm.pmsbc015,UpdateForm.hcp,1);">
    <img src="../images/erase.gif" class="Icon"
     onclick="clrFields(UpdateForm.pmsbc015,UpdateForm.hcp);" />
    </td></tr>
</table>
</span>

<span id="NoHoldHCP" style="display:none;">
<input type=hidden name=pmsbc015 value="">
</span>
