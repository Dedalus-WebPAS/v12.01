<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<link rel="stylesheet" href="../html/postcode.css" type="text/css">
<script type="text/javascript" src=../js/AutoPostCode.js>  </script>
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function init() {
  InitPostCodes();
//  document.all.repoption.innerHTML=document.all.URSpan.innerHTML; 
  disableTF(ReportForm.gstapl01,ReportForm.gstcod01)
  disableTF(ReportForm.gstapl02,ReportForm.gstcod02)
  disableTF(ReportForm.gstapl03,ReportForm.gstcod03)
  disableTF(ReportForm.gstapl04,ReportForm.gstcod04)
  disableTF(ReportForm.gstapl05,ReportForm.gstcod05)
  disableTF(ReportForm.gstapl06,ReportForm.gstcod06)

  disableTF(ReportForm.gstapm01,ReportForm.gstcom01)
  disableTF(ReportForm.gstapm02,ReportForm.gstcom02)
  disableTF(ReportForm.gstapm03,ReportForm.gstcom03)
  disableTF(ReportForm.gstapm04,ReportForm.gstcom04)
  disableTF(ReportForm.gstapm05,ReportForm.gstcom05)
  disableTF(ReportForm.gstapm06,ReportForm.gstcom06)

  document.ReportForm.schdprnt.focus();
}
function SetPostCode01() {
 suburb   = ReportForm.address2;
 state    = ReportForm.address3;
 postcode = ReportForm.postcode;
}
function valSuburb(){
  if (isWhitespace(ReportForm.address2.value)) {
    return;
  }
  UpCase(ReportForm.address2);
  if(ReportForm.postcode.value!="8888"){
    LookupPostCode(ReportForm.address2.value);
  }
}
function valPostCode(){
  if (isWhitespace(ReportForm.postcode.value)) {
    return;
  }
  LookupSuburb(ReportForm.postcode.value)
}
function checkOpt() {
  if (ReportForm.keystr01.value==1){
    document.all.repoption.innerHTML=document.all.URSpan.innerHTML; 
  }
  else {
    document.all.repoption.innerHTML=document.all.NameSpan.innerHTML; 
    SetPostCode01();
  }
}
function checkUR() {
   p=ReportForm;
   if (isWhitespace(p.urnumber.value)) {
     return;
   }
   justifyRight(p.urnumber);
   if (!validateCode(13,p.urnumber,p.patname,
                       p.dummy,p.dummy,p.dummy,p.dummy,p.admissno)) {
     p.urnumber.focus();
     return;
   }
//
// Get last visit default Health Fund & Table
//
   if (isWhitespace(p.admissno.value)) {
     return;
   }
   if ((isWhitespace(p.fundcode.value)) &&
       (isWhitespace(p.tabcode.value))) { 
     if (!validateCode(66,p.admissno,p.fundcode,p.funddesc,
                                     p.tabcode,p.tabdesc)) {
       p.urnumber.focus();
       return;
     }
   }
}
function validateHFund() {
  if (isWhitespace(ReportForm.fundcode.value)) {
     ReportForm.tabcode.className="";
     clrDoc(ReportForm.fundcode,ReportForm.funddesc);
     clrDoc(ReportForm.tabcode,ReportForm.tabdesc);
  }
  else {
     if (validateCode(16,ReportForm.fundcode,ReportForm.funddesc)) {
       ReportForm.tabcode.className="Mandatory";
     }
     else {
       clrHFundvars();
     }
  }
}
  
function clrHFundvars() {
  ReportForm.tabcode.className="";
  clrDoc(ReportForm.fundcode,ReportForm.funddesc);
  clrDoc(ReportForm.tabcode,ReportForm.tabdesc);
  ReportForm.fundcode.select();
}
function validateBedFee(clmtyp,hfund,hftabl,admtyp,bedtyp) {
  if (isWhitespace(clmtyp.value) &&
      isWhitespace(hfund.value) &&
      isWhitespace(hftabl.value) &&
      isWhitespace(admtyp.value) &&
      isWhitespace(bedtyp.value)) {
    return;;
  }
  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=64" +
                 "&valdclmt=" + clmtyp.value.substr(0,3).replace(/ /g,"+") +
                 "&valdfund=" + hfund.value.substr(0,6).replace(/ /g,"+") +
                 "&valdtabl=" + hftabl.value.substr(0,8).replace(/ /g,"+") +
                 "&valdadmt=" + admtyp.value.substr(0,3).replace(/ /g,"+") +
                 "&valdbedt=" + bedtyp.value.substr(0,3).replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {    
    return true;
  }
  else {
    bedtyp.focus();
    return false;
  }
}
function checkTheatre(ReturnCode,ReturnName,GSTAppl,GSTCode) {
  if (validateMbs(ReturnCode,ReturnName,ReportForm.tempamnt,
                  ReportForm.tempgsta,ReportForm.tempgstc,
                  ReportForm.suggclss)) {
    if (ReportForm.tempgsta.value==2) {
      GSTAppl.disabled=false;
      GSTAppl.className="Mandatory";
      GSTCode.disabled=false;
      for (var i =0 ; i < GSTCode.length; i++) {
          if (GSTCode.options[i].value==ReportForm.tempgstc.value) {
            GSTCode.selectedIndex=i } };
    }
    else {
      disableTF(GSTAppl,GSTCode);
    }
//
//  only get Admission type default on first theatre fee item
//
    if (ReturnCode.name=="thefee01") {
      if (isWhitespace(ReportForm.suggclss.value)) {
        ReportForm.fundcode.value=ReportForm.fundcode.value+"      ";
        ReportForm.dummy.value=ReportForm.fundcode.value.substr(0,6)
                              +ReportForm.thefee01.value;
        validateCode(67,ReportForm.dummy,ReportForm.suggclss)
      }
      if (!isWhitespace(ReportForm.suggclss.value)) {
        for (i=0; i<ReportForm.admissty.length; i++) {
          if (ReportForm.admissty.options[i].value.substr(0,3)==
              ReportForm.suggclss.value) {
            ReportForm.admissty.selectedIndex=i;
          }
        }
      }
    }
//
  }
}
function validateMbs(ReturnCode,ReturnName,Amount,GSTAppl,GSTCode,suggClass) {
  if (isWhitespace(ReturnCode.value)) {
    return;;
  }
  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=4" +
                 "&valdcode=" + ReturnCode.value.replace(/ /g,"+") 
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {    
    ReturnValue=returnValue.return_value.split("|");
    ReturnName.value=trim(ReturnValue[0]);
    Amount.value=ReturnValue[1];
    GSTAppl.value=ReturnValue[2];
    GSTCode.value=ReturnValue[3];
    suggClass.value=ReturnValue[4];

    if (ReturnValue[6]==1) {
      alert("Warning: A Prosthetic may need to be entered.");
    }

    return true;
  }
  else {
    ReturnCode.focus();
    return false;
  }
}

function checkMisc(ReturnCode,ReturnName,GSTAppl,GSTCode) {
  if (validateMisc(ReturnCode,ReturnName,
                  ReportForm.tempgsta,
                  ReportForm.tempgstc)) {

    if (ReportForm.tempgsta.value==2) {
      GSTAppl.disabled=false;
      GSTAppl.className="Mandatory";
      GSTCode.disabled=false;
      for (var i =0 ; i < GSTCode.length; i++) {
          if (GSTCode.options[i].value==ReportForm.tempgstc.value) {
            GSTCode.selectedIndex=i } };
    }
    else {
      disableTF(GSTAppl,GSTCode);
    }
 }
}

function validateMisc(ReturnCode,ReturnName,GSTAppl,GSTCode) {
  if (isWhitespace(ReturnCode.value)) {
    return;;
  }
  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=40" +
                 "&valdcode=" + ReturnCode.value.replace(/ /g,"+") +
                 "&valdtype=1"

  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {    
    ReturnValue=returnValue.return_value.split("|");
    ReturnName.value=trim(ReturnValue[0]);
    GSTAppl.value=ReturnValue[1];
    GSTCode.value=ReturnValue[2];
    return true;
  }
  else {
    ReturnCode.focus();
    return false;
  }
}

function disableTF(GSTAppl,GSTCode) {
  GSTAppl.className="";
  GSTAppl.selectedIndex=0;
  GSTAppl.disabled=true;
  GSTCode.className="";
  GSTCode.selectedIndex=0;
  GSTCode.disabled=true;
}

function checkGST(GSTAppl,GSTCode) {
  if (GSTAppl.selectedIndex==1) {
    GSTCode.className="Mandatory";
  }
  else {
    GSTCode.className="";
  }
}
function ProcessReport() {
 if (validateMandatory(ReportForm)) {
   if (isWhitespace(ReportForm.fundcode.value) &&
      !isWhitespace(ReportForm.tabcode.value)) {
     alert("Cannot have Table without Health Fund.")
     ReportForm.tabcode.focus();
     return;
   }
   if (!isWhitespace(ReportForm.fundcode.value)) {
     if (isWhitespace(ReportForm.tabcode.value)) {
       alert("Must have Health Fund Table.");
       ReportForm.tabcode.focus();
       return;
     }
//     if (!validateHFT(20,ReportForm.fundcode,ReportForm.tabcode,
//                         ReportForm.funddesc,ReportForm.tabdesc)) {
//       return;
//     }
   }
   if (isWhitespace(ReportForm.thefee01.value)) {
     if (!isWhitespace(ReportForm.thefee02.value) ||
         !isWhitespace(ReportForm.thefee03.value) ||
         !isWhitespace(ReportForm.thefee04.value) ||
         !isWhitespace(ReportForm.thefee05.value) ||
         !isWhitespace(ReportForm.thefee06.value)) {
       alert("Must have Theatre Fee Code 1 first.");
       ReportForm.thefee01.focus();
       return;
     }
   }
//   if (!validateBedFee(ReportForm.claimtyp,ReportForm.fundcode,
//                             ReportForm.tabcode,ReportForm.admissty,
//                             ReportForm.bedfeety)) {
//     return;
//   }
   if (!checkTheatreFee(ReportForm.thefee01)) {
     return;
   }
   if (!checkTheatreFee(ReportForm.thefee02)) {
     return;
   }
   if (!checkTheatreFee(ReportForm.thefee03)) {
     return;
   }
   if (!checkTheatreFee(ReportForm.thefee04)) {
     return;
   }
   if (!checkTheatreFee(ReportForm.thefee05)) {
     return;
   }

   setKeystrokes();
   ReportForm.redirect.value="patweb98.pbl?reportno=1&template=1&urnumber="+ReportForm.urnumber.value.replace(/ /g,"+");
   SubmitReport(ReportForm) 
 }
}
function checkTheatreFee(tfeecode) {
  if (isWhitespace(tfeecode.value)) {
    return true;
  }
  var admsdate=SetDateYYYYMMDD(ReportForm.admissdt.value);
  if (ReportForm.noofstay.value==0) {
    var dcaseflg="D";
  }
  else {
    var dcaseflg=" ";
  }
  var serverURL   = "../cgi-bin/rshweb02.pbl?reportno=11" +
        "&dcaseflg=" + dcaseflg.replace(/ /g,"+") +
        "&admsdate=" + admsdate.replace(/ /g,"+") +
        "&hlthfund=" + ReportForm.fundcode.value.substr(0,6).replace(/ /g,"+") +
        "&hlthtabl=" + ReportForm.tabcode.value.substr(0,8).replace(/ /g,"+") +
        "&tfeecode=" + tfeecode.value.replace(/ /g,"+") +
        "&csmxcode=" + ReportForm.casemixc.value.replace(/ /g,"+") +
        "&clmtcode=" + ReportForm.claimtyp.value.substr(0,3).replace(/ /g,"+"); 
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {    
    return true;
  }
  else {
    tfeecode.focus();
    return false;
  }
}
function setKeystrokes() {
  var keystrokes="";
//
//  Report Option - By UR or Free Format Name
//
  if (ReportForm.keystr01.value==1) {
    keystrokes=ReportForm.urnumber.value; 
  }
  else {
    keystrokes=ReportForm.title.value + "|" + ReportForm.given.value 
                                      + "|" + ReportForm.surname.value 
                                      + "|" + ReportForm.address1.value 
                                      + "|" + ReportForm.address2.value 
                                      + "|" + ReportForm.address3.value 
                                      + "|" + ReportForm.postcode.value 
                                      + "|" + ReportForm.postaddr.value; 
  }
//
// Number of Nights Stay & Admission Date Keystrokes
//
  keystrokes=keystrokes + "|" + ReportForm.noofstay.value;  
  keystrokes=keystrokes + "|" + SetDateDDMMYYYY(ReportForm.admissdt.value); 
//
// Claim Type Keystroke
//
  if (!isWhitespace(ReportForm.claimtyp.value)) {
    keystrokes=keystrokes+"|"+ReportForm.claimtyp.value.substr(0,3);
  }
//
// Health Fund Keystrokes
//
  if (!isWhitespace(ReportForm.fundcode.value)) {
    keystrokes=keystrokes + "|" + ReportForm.fundcode.value 
                          + "|" + ReportForm.tabcode.value;
  }
  else {
    keystrokes=keystrokes + "|      SPACE";
  }
//
// Theatre Fee Keystrokes
//
  var nooffees=0;
  if (!isWhitespace(ReportForm.thefee01.value)) {
    nooffees=nooffees+1;
    keystrokes=keystrokes + "|" + ReportForm.thefee01.value;
    if (!isWhitespace(ReportForm.gstapl01.value)) {
       keystrokes=keystrokes + "|" + ReportForm.gstapl01.value;
       if (ReportForm.gstapl01.value=="Y") {
         keystrokes=keystrokes + "|" + ReportForm.gstcod01.value;
       }
    }
  }
  if (!isWhitespace(ReportForm.thefee02.value)) {
    nooffees=nooffees+1;
    keystrokes=keystrokes + "|" + ReportForm.thefee02.value;
    if (!isWhitespace(ReportForm.gstapl02.value)) {
      keystrokes=keystrokes+"|"+ReportForm.gstapl02.value;
      if (ReportForm.gstapl02.value=="Y") {
        keystrokes=keystrokes+"|"+ReportForm.gstcod02.value;
      }
    }
  }
  if (!isWhitespace(ReportForm.thefee03.value)) {
    nooffees=nooffees+1;
    keystrokes=keystrokes+"|"+ReportForm.thefee03.value;
    if (!isWhitespace(ReportForm.gstapl03.value)) {
      keystrokes=keystrokes+"|"+ReportForm.gstapl03.value;
      if (ReportForm.gstapl03.value=="Y") {
        keystrokes=keystrokes+"|"+ReportForm.gstcod03.value;
      }
    }
  }
  if (!isWhitespace(ReportForm.thefee04.value)) {
    nooffees=nooffees+1;
    keystrokes=keystrokes+"|"+ReportForm.thefee04.value;
    if (!isWhitespace(ReportForm.gstapl04.value)) {
      keystrokes=keystrokes+"|"+ReportForm.gstapl04.value;
      if (ReportForm.gstapl04.value=="Y") {
        keystrokes=keystrokes+"|"+ReportForm.gstcod04.value;
      }
    }
  }
  if (!isWhitespace(ReportForm.thefee05.value)) {
    nooffees=nooffees+1;
    keystrokes=keystrokes+"|"+ReportForm.thefee05.value;
    if (!isWhitespace(ReportForm.gstapl05.value)) {
      keystrokes=keystrokes+"|"+ReportForm.gstapl05.value;
      if (ReportForm.gstapl05.value=="Y") {
        keystrokes=keystrokes+"|"+ReportForm.gstcod05.value;
      }
    }
  }
  if (!isWhitespace(ReportForm.thefee06.value)) {
    nooffees=nooffees+1;
    keystrokes=keystrokes+"|"+ReportForm.thefee06.value;
    if (!isWhitespace(ReportForm.gstapl06.value)) {
      keystrokes=keystrokes+"|"+ReportForm.gstapl06.value;
      if (ReportForm.gstapl06.value=="Y") {
        keystrokes=keystrokes+"|"+ReportForm.gstcod06.value;
      }
    }
  }  
  if (nooffees<6) {              //  have enter when less than 6 theatre fee
    keystrokes=keystrokes+"| ";
  } 

// Miscellaneous Charge code Keystrokes
//
  var nooffees=0;
  if (!isWhitespace(ReportForm.mischg01.value)) {
    nooffees=nooffees+1;
    keystrokes=keystrokes + "|" + ReportForm.mischg01.value;
    if (!isWhitespace(ReportForm.gstapm01.value)) {
       keystrokes=keystrokes + "|" + ReportForm.gstapm01.value;
       if (ReportForm.gstapm01.value=="Y") {
         keystrokes=keystrokes + "|" + ReportForm.gstcom01.value;
       }
    }
  }

  if (!isWhitespace(ReportForm.mischg02.value)) {
    nooffees=nooffees+1;
    keystrokes=keystrokes + "|" + ReportForm.mischg02.value;
    if (!isWhitespace(ReportForm.gstapm02.value)) {
       keystrokes=keystrokes + "|" + ReportForm.gstapm02.value;
       if (ReportForm.gstapm02.value=="Y") {
         keystrokes=keystrokes + "|" + ReportForm.gstcom02.value;
       }
    }
  }

  if (!isWhitespace(ReportForm.mischg03.value)) {
    nooffees=nooffees+1;
    keystrokes=keystrokes + "|" + ReportForm.mischg03.value;
    if (!isWhitespace(ReportForm.gstapm03.value)) {
       keystrokes=keystrokes + "|" + ReportForm.gstapm03.value;
       if (ReportForm.gstapm03.value=="Y") {
         keystrokes=keystrokes + "|" + ReportForm.gstcom03.value;
       }
    }
  }

  if (!isWhitespace(ReportForm.mischg04.value)) {
    nooffees=nooffees+1;
    keystrokes=keystrokes + "|" + ReportForm.mischg04.value;
    if (!isWhitespace(ReportForm.gstapm04.value)) {
       keystrokes=keystrokes + "|" + ReportForm.gstapm04.value;
       if (ReportForm.gstapm04.value=="Y") {
         keystrokes=keystrokes + "|" + ReportForm.gstcom04.value;
       }
    }
  }

  if (!isWhitespace(ReportForm.mischg05.value)) {
    nooffees=nooffees+1;
    keystrokes=keystrokes + "|" + ReportForm.mischg05.value;
    if (!isWhitespace(ReportForm.gstapm05.value)) {
       keystrokes=keystrokes + "|" + ReportForm.gstapm05.value;
       if (ReportForm.gstapm05.value=="Y") {
         keystrokes=keystrokes + "|" + ReportForm.gstcom05.value;
       }
    }
  }

  if (!isWhitespace(ReportForm.mischg06.value)) {
    nooffees=nooffees+1;
    keystrokes=keystrokes + "|" + ReportForm.mischg06.value;
    if (!isWhitespace(ReportForm.gstapm06.value)) {
       keystrokes=keystrokes + "|" + ReportForm.gstapm06.value;
       if (ReportForm.gstapm06.value=="Y") {
         keystrokes=keystrokes + "|" + ReportForm.gstcom06.value;
       }
    }
  }

  if (nooffees<6) {              //  have enter when less than 6 Misc.Charge
    keystrokes=keystrokes+"| ";
  } 

//
// Casemix Keystrokes
//
  if (!isWhitespace(ReportForm.casemixc.value)) {
    keystrokes=keystrokes+"|"+ReportForm.casemixc.value;
  }
  else {
    keystrokes=keystrokes+"| ";
  }
//

// Prosthetic Keystrokes
//
  if (!isWhitespace(ReportForm.prosthet.value)) {
    keystrokes=keystrokes+"|"+ReportForm.prosthet.value;
  }
  else {
    keystrokes=keystrokes+"| ";
  }
//

// Pharmacy Keystrokes
//
  if (!isWhitespace(ReportForm.pharmacy.value)) {
    keystrokes=keystrokes+"|"+ReportForm.pharmacy.value;
  }
  else {
    keystrokes=keystrokes+"| ";
  }
//

// Bed Type Keystroke
//
  if (!isWhitespace(ReportForm.bedfeety.value)) {
    keystrokes=keystrokes+"|"+ReportForm.bedfeety.value.substr(0,3);
  }
//
// Admission Type Keystroke
//
  if (!isWhitespace(ReportForm.admissty.value)) {
    keystrokes=keystrokes+"|"+ReportForm.admissty.value.substr(0,3);
  }
//
// Accommodation GST Keystroke
//
  if (!isWhitespace(ReportForm.accomgst.value)) {
    keystrokes=keystrokes+"|"+ReportForm.accomgst.value;
  }
//
// Post Keystroke
//
  keystrokes=keystrokes+"|P| ";
//
//  Split and Set Keystrokes
//
  KeyStrArray=keystrokes.split("|");
  var i=0;
  if (i<KeyStrArray.length) {
    ReportForm.keystr02.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr03.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr04.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr05.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr06.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr07.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr08.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr09.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr10.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr11.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr12.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr13.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr14.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr15.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr16.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr17.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr18.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr19.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr20.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr21.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr22.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr23.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr24.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr25.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr26.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr27.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr28.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr29.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr30.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr31.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr32.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr33.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr34.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr35.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr36.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr37.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr38.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr39.value=KeyStrArray[i];
    i++
  }
  if (i<KeyStrArray.length) {
    ReportForm.keystr40.value=KeyStrArray[i];
    i++
  }
}
</script>
</head>
%START.OF.PAGE
<body onload=PageLoad(event);ReportLoad();>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PRSWEB01.01.003";
PatientVIS="%PRSWEB01.01.081";
PatientNAM="%PRSWEB01.01.002";
PatientSTA="%PRSWEB01.01.086.078";
PatientALT="%PRSWEB01.01.084";
PatientSEX="%PRSWEB01.01.019";
PatientDOB="%PRSWEB01.01.020";
PatientAGE="%PRSWEB01.01.021";
PatientLOC="%PRSWEB01.01.083";
PatientPRI="%PRSWEB01.01.086.066.1";
PatientUNT="%PRSWEB01.01.066.0";
DoctorCOD="%PRSWEB01.01.082.003";
DoctorNAM="%PRSWEB01.01.082.002";
PatientAID="%PRSWEB01.01.086.090";
PatientIND="%PRSWEB01.01.086.091";
PatientCUR="%PRSWEB01.01.086.092";
PatientCLC="%PRSWEB01.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PRSWEB01.01.086.094";
PatientCDM="%PRSWEB01.01.086.095";
PatientVDH="%PRSWEB01.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
  <form name=ReportForm method=post action=prsweb01.pbl style=margin:0>
  <input type=hidden name=reportno value=1>
  <input type=hidden name=template value=006>
  <input type=hidden name=updttype value="R">
  <input type=hidden name=setdfprg value="IBAADT21">
  <input type=hidden name=setdfrep value="01">
  <input type=hidden name=schdpgid value="IBAADT21">    
  <input type=hidden name=schddesc value="Fees Estimations">    
  <input type=hidden name=nextpage value="1">
  <input type=hidden name=tabfrom   value="">
  <input type=hidden name=n_tabfrom value="">
  <input type=hidden name=redirect value="patweb98.pbl?reportno=1&template=1">
  <input type=hidden name=dummy value="">
  <input type=hidden name=tempamnt value="">
  <input type=hidden name=tempgsta value="">
  <input type=hidden name=tempgstc value="">
  <input type=hidden name=suggclss value="">
  <input type=hidden name=multhosp value="   " id=multhosp>
<table width=100% align=center border=0 cellspacing=0>

<tr><td class=HeadingCell align=center colspan=2>
    Fees Estimations</td></tr>
<tr><td>
    <input type=hidden name=schdcopy value="1"> 
    <input type=hidden name=schdrdat value="">
    <input type=hidden name=schdrend value="">
    <input type=hidden name=urnumber value="%PRSWEB01.01.003">
    <input type=hidden name=admissno value="%PRSWEB01.01.081">

<table width=90% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel>Number of Nights Stay </td>
    <td><input type=text name=noofstay size=4 maxlength=4 
         title='Number of Nights Stay' class="Integer" min=0 max=9999
         value='0'> 
         &nbsp; 0=Daycase &nbsp;
    </td>
    <td class=DataLabel>Accommodation GST</td>
    <td><select name=accomgst class=Mandatory>
    <option value=N>No</option>
    <option value=Y>Yes</option>
    </select>
    </td>      
</tr>

<tr><td class=DataLabel>Admission Date</td>     
    <td><input type=text size=15 maxlength=12 name=admissdt
         class="Mandatory Date" title="Admission Date"
         onblur="checkDate(this,'Admission Date');">
        <img notab src="../images/DateTimeStamp.gif" class="Icon"
         alt="Current" date="ReportForm.admissdt">
        <img notab src="../images/DateLookup.gif" class="Icon"
         alt="Calendar" date="ReportForm.admissdt">
    </td>
    <td class=DataLabel>Bed Type</td>
    <td><select name=bedfeety class=Mandatory title="Bed Type">
        <option value=" "></option>
        %STANDARD.01.007.BT
        </select></td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td><select name=claimtyp class=Mandatory title="%STANDARD.01.017.CL">
        <option value=" "></option>
         %STANDARD.01.007.CL
        </select></td>
    <td class=DataLabel>%STANDARD.01.017.A </td>
    <td><select name=admissty class=Mandatory title="%STANDARD.01.017.A ">
        <option value=" "></option>
         %STANDARD.01.007.A
        </select></td>
    </tr>

<tr><td class=DataLabel>Health Fund</td>
    <td><input type=text name=fundcode size=6 maxlength=6 id=fundcode
         title="Health Fund"  
         onblur='validateHFund();'>
        <input type=text class=readonly readonly name=funddesc size=35
         title="Health Fund Description" tabindex=-1 id=funddesc ></td>
        <td class=DataLabel>Table</td>
        <td><input type=text name=tabcode size=8 maxlength=8 id=tabcode
         title="Fund Table"
         onblur='validateHFT(20,fundcode,tabcode,funddesc,tabdesc);'>
        <input type=text class=readonly readonly name=tabdesc size=20
         title="Table Description" tabindex=-1 id=tabdesc>
        <img src=../images/SearchIcon.gif class=Icon
         onclick="HealthFundSearchFrame(fundcode,funddesc,tabcode,tabdesc);">
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick='clrHFundvars();'>
    </td>
</tr>


  <input type=hidden name=keystr01 value="1">
  <input type=hidden name=keystr02 value=" ">
  <input type=hidden name=keystr03 value=" ">
  <input type=hidden name=keystr04 value=" ">
  <input type=hidden name=keystr05 value=" ">
  <input type=hidden name=keystr06 value=" ">
  <input type=hidden name=keystr07 value=" ">
  <input type=hidden name=keystr08 value=" ">
  <input type=hidden name=keystr09 value=" ">
  <input type=hidden name=keystr10 value=" ">
  <input type=hidden name=keystr11 value=" ">
  <input type=hidden name=keystr12 value=" ">
  <input type=hidden name=keystr13 value=" ">
  <input type=hidden name=keystr14 value=" ">
  <input type=hidden name=keystr15 value=" ">
  <input type=hidden name=keystr16 value=" ">
  <input type=hidden name=keystr17 value=" ">
  <input type=hidden name=keystr18 value=" ">
  <input type=hidden name=keystr19 value=" ">
  <input type=hidden name=keystr20 value=" ">
  <input type=hidden name=keystr21 value=" ">
  <input type=hidden name=keystr22 value=" ">
  <input type=hidden name=keystr23 value=" ">
  <input type=hidden name=keystr24 value=" ">
  <input type=hidden name=keystr25 value=" ">
  <input type=hidden name=keystr26 value=" ">
  <input type=hidden name=keystr27 value=" ">
  <input type=hidden name=keystr28 value=" ">
  <input type=hidden name=keystr29 value=" ">
  <input type=hidden name=keystr30 value=" ">
  <input type=hidden name=keystr31 value=" ">
  <input type=hidden name=keystr32 value=" ">
  <input type=hidden name=keystr33 value=" ">
  <input type=hidden name=keystr34 value=" ">
  <input type=hidden name=keystr35 value=" ">
  <input type=hidden name=keystr36 value=" ">
  <input type=hidden name=keystr37 value=" ">
  <input type=hidden name=keystr38 value=" ">
  <input type=hidden name=keystr39 value=" ">
  <input type=hidden name=keystr40 value=" ">


<tr><td class=DataLabel >Theatre Fee Code 1</td>
    <td><input type=text name=thefee01 size=9 maxlength=9  id=thefee01
         title='Theatre Fee Code 1' 
         onblur='checkTheatre(thefee01,thedesc01,gstapl01,gstcod01);'> 
        <input type=text name=thedesc01 size=35 class=Readonly readonly 
         id=thedesc01 title='Theatre Fee Code 1 description' value="" tabindex=-1>
        <img src="../images/SearchIcon.gif" class="Icon" alt="Search"
         onclick='MbsSearchFrame(thefee01,thedesc01);'>
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick='clrDoc(thefee01,thedesc01);disableTF(gstapl01,gstcod01);'>
         </td><td>Is GST Payable
        <select name=gstapl01 title="Is GST applicable?" id=gstap101
                onchange='checkGST(gstapl01,gstcod01);'>
        <option value="">   </option>
        <option value=Y>Yes</option>
        <option value=N>No </option>
        </select>
        </td><td>GST Code
        <select name=gstcod01 title="GST Code" id=gstcod01>
        <option value=""> </option>
         %PRSWEB01.01.252
        </select>
    </td>
</tr>

<tr><td class=DataLabel >Theatre Fee Code 2</td>
    <td><input type=text name=thefee02 size=9 maxlength=9  id=thefee01
         title='Theatre Fee Code 2'
         onblur='checkTheatre(thefee02,thedesc02,gstapl02,gstcod02);'> 
        <input type=text name=thedesc02 size=35 class=Readonly readonly 
         id=thedesc02 title='Theatre Fee Code 2 description' value="" tabindex=-1>
        <img src="../images/SearchIcon.gif" class="Icon" alt="Search"
         onclick='MbsSearchFrame(thefee02,thedesc02);'>
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick='clrDoc(thefee02,thedesc02);disableTF(gstapl02,gstcod02);'>
         </td><td>Is GST Payable
        <select name=gstapl02 title="Is GST applicable?" id=gstap102
                onchange='checkGST(gstapl02,gstcod02);'>
        <option value="">   </option>
        <option value=Y>Yes</option>
        <option value=N>No </option>
        </select>
        </td><td>GST Code
        <select name=gstcod02 title="GST Code" id=gstcod02>
        <option value=""> </option>
         %PRSWEB01.01.252
        </select>
    </td>
</tr>

<tr><td class=DataLabel >Theatre Fee Code 3</td>
    <td><input type=text name=thefee03 size=9 maxlength=9  id=thefee03
         title='Theatre Fee Code 3'
         onblur='checkTheatre(thefee03,thedesc03,gstapl03,gstcod03);'> 
        <input type=text name=thedesc03 size=35 class=Readonly readonly 
         id=thedesc03 title='Theatre Fee Code 3 description' value="" tabindex=-1>
        <img src="../images/SearchIcon.gif" class="Icon" alt="Search"
         onclick='MbsSearchFrame(thefee03,thedesc03);'>
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick='clrDoc(thefee03,thedesc03);disableTF(gstapl03,gstcod03);'>
         </td><td>Is GST Payable
        <select name=gstapl03 title="Is GST applicable?" id=gstap103
                onchange='checkGST(gstapl03,gstcod03);'>
        <option value="">   </option>
        <option value=Y>Yes</option>
        <option value=N>No </option>
        </select>
        </td><td>GST Code
        <select name=gstcod03 title="GST Code">
        <option value=""> </option>
         %PRSWEB01.01.252
        </select>
    </td>
</tr>

<tr><td class=DataLabel >Theatre Fee Code 4</td>
    <td><input type=text name=thefee04 size=9 maxlength=9  
         title='Theatre Fee Code 4' 
         onblur='checkTheatre(thefee04,thedesc04,gstapl04,gstcod04);'> 
        <input type=text name=thedesc04 size=35 class=Readonly readonly 
         title='Theatre Fee Code 4 description' value="" tabindex=-1>
        <img src="../images/SearchIcon.gif" class="Icon" alt="Search"
         onclick='MbsSearchFrame(thefee04,thedesc04);'>
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick='clrDoc(thefee04,thedesc04);disableTF(gstapl04,gstcod04);'>
         </td><td>Is GST Payable
        <select name=gstapl04 title="Is GST applicable?"
                onchange='checkGST(gstapl04,gstcod04);'>
        <option value="">   </option>
        <option value=Y>Yes</option>
        <option value=N>No </option>
        </select>
        </td><td>GST Code
        <select name=gstcod04 title="GST Code">
        <option value=""> </option>
         %PRSWEB01.01.252
        </select>
    </td>
</tr>

<tr><td class=DataLabel >Theatre Fee Code 5</td>
    <td><input type=text name=thefee05 size=9 maxlength=9  
         title='Theatre Fee Code 5' 
         onblur='checkTheatre(thefee05,thedesc05,gstapl05,gstcod05);'> 
        <input type=text name=thedesc05 size=35 class=Readonly readonly 
         title='Theatre Fee Code 5 description' value="" tabindex=-1>
        <img src="../images/SearchIcon.gif" class="Icon" alt="Search"
         onclick='MbsSearchFrame(thefee05,thedesc05);'>
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick='clrDoc(thefee05,thedesc05);disableTF(gstapl05,gstcod05);'>
         </td><td>Is GST Payable
        <select name=gstapl05 title="Is GST applicable?"
                onchange='checkGST(gstapl05,gstcod05);'>
        <option value="">   </option>
        <option value=Y>Yes</option>
        <option value=N>No </option>
        </select>
        </td><td>GST Code
        <select name=gstcod05 title="GST Code">
        <option value=""> </option>
         %PRSWEB01.01.252
        </select>
    </td>
</tr>

<tr><td class=DataLabel >Theatre Fee Code 6</td>
    <td><input type=text name=thefee06 size=9 maxlength=9  
         title='Theatre Fee Code 6'
         onblur='checkTheatre(thefee06,thedesc06,gstapl06,gstcod06);'> 
        <input type=text name=thedesc06 size=35 class=Readonly readonly 
         title='Theatre Fee Code 6 description' value="" tabindex=-1>
        <img src="../images/SearchIcon.gif" class="Icon" alt="Search"
         onclick='MbsSearchFrame(thefee06,thedesc06);'>
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick='clrDoc(thefee06,thedesc06);disableTF(gstapl06,gstcod06);'>
         </td><td>Is GST Payable
        <select name=gstapl06 title="Is GST applicable?"
                onchange='checkGST(gstapl06,gstcod06);'>
        <option value="">   </option>
        <option value=Y>Yes</option>
        <option value=N>No </option>
        </select>
        </td><td>GST Code
        <select name=gstcod06 title="GST Code">
        <option value=""> </option>
         %PRSWEB01.01.252
        </select>
    </td>
</tr>

<tr><td class=DataLabel>Misc Charge Code 1</td>
    <td><input type=text name=mischg01 size=9 maxlength=9 
         class="SelectBig"
         onblur='checkMisc(mischg01,misdes01,gstapm01,gstcom01)'
         title="Misc Charge Code" >
        <input type=text readonly name=misdes01 size=35 class=Readonly
         title="Misc Charge Code Description" tabindex=-1>
        <img src=../images/SearchIcon.gif class=Icon
         onclick="DefMiscChargeSearchFrame(mischg01,misdes01,multhosp);">
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick='clrDoc(mischg01,misdes01);disableTF(gstapm01,gstcom01);'>
         </td><td>Is GST Payable
        <select name=gstapm01 title="Is GST applicable?" id=gstapm01
                onchange='checkGST(gstapm01,gstcom01);'>
        <option value="">   </option>
        <option value=Y>Yes</option>
        <option value=N>No </option>
        </select>
        </td><td>GST Code
        <select name=gstcom01 title="GST Code" id=gstcom01>
        <option value=""> </option>
         %PRSWEB01.01.252
        </select>
</td></tr>

<tr><td class=DataLabel>Misc Charge Code 2</td>
    <td><input type=text name=mischg02 size=9 maxlength=9 id=mischg02
         class="SelectBig"
         onblur='checkMisc(mischg02,misdes02,gstapm02,gstcom02)'
         title="Misc Charge Code" >
        <input type=text readonly name=misdes02 size=35 class=Readonly
         title="Misc Charge Code Description" tabindex=-1 id=misdes02>
        <img src=../images/SearchIcon.gif class=Icon
         onclick="DefMiscChargeSearchFrame(mischg02,misdes02,multhosp);">
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick='clrDoc(mischg02,misdes02);disableTF(gstapm02,gstcom02);'>
         </td><td>Is GST Payable
        <select name=gstapm02 title="Is GST applicable?"
                onchange='checkGST(gstapm02,gstcom02);'>
        <option value="">   </option>
        <option value=Y>Yes</option>
        <option value=N>No </option>
        </select>
        </td><td>GST Code
        <select name=gstcom02 title="GST Code">
        <option value=""> </option>
         %PRSWEB01.01.252
        </select>
</td></tr>

<tr><td class=DataLabel>Misc Charge Code 3</td>
    <td><input type=text name=mischg03 size=9 maxlength=9 id=mischg03
         class="SelectBig"
         onblur='checkMisc(mischg03,misdes03,gstapm03,gstcom03)'
         title="Misc Charge Code" >
        <input type=text readonly name=misdes03 size=35 class=Readonly
         title="Misc Charge Code Description" tabindex=-1 id=misdes03>
        <img src=../images/SearchIcon.gif class=Icon
         onclick="DefMiscChargeSearchFrame(mischg03,misdes03,multhosp);">
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick='clrDoc(mischg03,misdes03);disableTF(gstapm03,gstcom03);'>
         </td><td>Is GST Payable
        <select name=gstapm03 title="Is GST applicable?"
                onchange='checkGST(gstapm03,gstcom03);'>
        <option value="">   </option>
        <option value=Y>Yes</option>
        <option value=N>No </option>
        </select>
        </td><td>GST Code
        <select name=gstcom03 title="GST Code">
        <option value=""> </option>
         %PRSWEB01.01.252
        </select>
</td></tr>

<tr><td class=DataLabel>Misc Charge Code 4</td>
    <td><input type=text name=mischg04 size=9 maxlength=9 id=mischg04
         class="SelectBig"
         onblur='checkMisc(mischg04,misdes04,gstapm04,gstcom04)'
         title="Misc Charge Code" >
        <input type=text readonly name=misdes04 size=35 class=Readonly
         title="Misc Charge Code Description" tabindex=-1 id=misdes04>
        <img src=../images/SearchIcon.gif class=Icon
         onclick="DefMiscChargeSearchFrame(mischg04,misdes04,multhosp);">
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick='clrDoc(mischg04,misdes04);disableTF(gstapm04,gstcom04);'>
         </td><td>Is GST Payable
        <select name=gstapm04 title="Is GST applicable?"
                onchange='checkGST(gstapm04,gstcom04);'>
        <option value="">   </option>
        <option value=Y>Yes</option>
        <option value=N>No </option>
        </select>
        </td><td>GST Code
        <select name=gstcom04 title="GST Code">
        <option value=""> </option>
         %PRSWEB01.01.252
        </select>
</td></tr>

<tr><td class=DataLabel>Misc Charge Code 5</td>
    <td><input type=text name=mischg05 size=9 maxlength=9 id=mischg05
         class="SelectBig"
         onblur='checkMisc(mischg05,misdes05,gstapm05,gstcom05)'
         title="Misc Charge Code" >
        <input type=text readonly name=misdes05 size=35 class=Readonly
         title="Misc Charge Code Description" tabindex=-1 id=misdes05>
        <img src=../images/SearchIcon.gif class=Icon
         onclick="DefMiscChargeSearchFrame(mischg05,misdes05,multhosp);">
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick='clrDoc(mischg05,misdes05);disableTF(gstapm05,gstcom05);'>
         </td><td>Is GST Payable
        <select name=gstapm05 title="Is GST applicable?"
                onchange='checkGST(gstapm05,gstcom05);'>
        <option value="">   </option>
        <option value=Y>Yes</option>
        <option value=N>No </option>
        </select>
        </td><td>GST Code
        <select name=gstcom05 title="GST Code">
        <option value=""> </option>
         %PRSWEB01.01.252
        </select>
</td></tr>

<tr><td class=DataLabel>Misc Charge Code 6</td>
    <td><input type=text name=mischg06 size=9 maxlength=9 id=mischg06
         class="SelectBig"
         onblur='checkMisc(mischg06,misdes06,gstapm06,gstcom06)'
         title="Misc Charge Code" >
        <input type=text readonly name=misdes06 size=35 class=Readonly
         title="Misc Charge Code Description" tabindex=-1 id=misdes06>
        <img src=../images/SearchIcon.gif class=Icon
         onclick="DefMiscChargeSearchFrame(mischg06,misdes06,multhosp);">
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick='clrDoc(mischg06,misdes06);disableTF(gstapm06,gstcom06);'>
         </td><td>Is GST Payable
        <select name=gstapm06 title="Is GST applicable?"
                onchange='checkGST(gstapm06,gstcom06);'>
        <option value="">   </option>
        <option value=Y>Yes</option>
        <option value=N>No </option>
        </select>
        </td><td>GST Code
        <select name=gstcom06 title="GST Code">
        <option value=""> </option>
         %PRSWEB01.01.252
        </select>
</td></tr>

<tr><td class=DataLabel >Casemix Code</td>
    <td><input type=text name=casemixc size=9 maxlength=9 title='Casemix Code'
         id=casemixc onblur='validateCode(35,casemixc,cmixdesc);'>
        <input type=text name=cmixdesc size=35 class=readonly readonly
         id=cmixdesc title='Casemix Description' tabindex=-1>
        <img src="../images/SearchIcon.gif" class="Icon" alt="Search"
         onclick='CmixSearchFrame(casemixc,cmixdesc);'>
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick='clrDoc(casemixc,cmixdesc);'>
    </td>
</tr>
  <tr><td class=DataLabel >Prosthetics</td>
      <td class=DataField>
        <input type=text name=prosthet size=8 maxlength=8 
         title='Prosthetics' class="Number" min=0 max=99999.99></td>
      <td class=DataLabel> Pharmacy</td>
      <td class=DataField>
        <input type=text name=pharmacy size=8 maxlength=8
         title='Pharmacy' class="Number" min=0 max=99999.99></td>
  </tr>

<tr><td class=DataLabel >Estimate Date</td>
    <td class=DataLabel>
    <input type=text name=schddate size=12 title="Estimate Date"
    value="%STANDARD.01.015"
    onblur="checkDate(this,'Estimate Date');">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Show Calendar" date="ReportForm.schddate">
    Time
    <input type=text name=schdtime size=12 title="Schedule Time"
    value="%STANDARD.01.016">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schddate" time="ReportForm.schdtime">
    <img notab src="../images/TimeLookup.gif" class="Icon"
     alt="Time Select" time="ReportForm.schdtime">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><select name=schdprnt title="Printer" class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBAADT21.01
        </select>
    </td></tr>

<tr><td align=center colspan=2><br>
    <input type=button value=Ok class="button" onclick='ProcessReport();'>
    <input type=button value=Cancel class="button" 
     onclick='location.href="../lookups/blank.html"' >
    </td></tr>
</table>
</td></tr>
</table>
</form>
</div>

<span id=SetDateRange style="display:none;">
    <input type=text size=15 maxlength=12 name=datran02
     onblur="checkDate(this,'Date')" class="Mandatory Date" title="Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.datran02">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.datran02">
</span>

<span id=SetScheduleRange style="display:none;">
    <select name=datsch01 title="Schedule Range" class=Mandatory
     onblur=UpReportSchedule(this,ReportForm.keystr07,ReportForm.keystr08)>
    <option></option></select>
     Sample Range
    <input type=text name=SampleFrom size=12> To
    <input type=text name=SampleTo size=12>
</span>

<span id=URSpan style="display:none;">
<table width=90% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel >U/R Number</td>
    <td><input type=hidden name=admissno id=admissno>
        <input type=text name=urnumber size=10 maxlength=8 id=urnumber
         title='U/R Number' class=Mandatory
         onblur='checkUR();'>
        <input type=text name=patname class=readonly readonly size=35 
         title='Patient Name' tabindex=-1 id=patname>
        <img src="../images/SearchIcon.gif" class="Icon" alt="Search"
         onclick='PatientSearchFrame(patname,urnumber,admissno,checkUR);'>
    </td>
</tr>
</table>
</span>

<span id=NameSpan style="display:none;">
<table width=90% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel >Title</td>
    <td><input type=text name=title size=4 maxlength=4></td></tr>
<tr><td class=DataLabel >Given</td>
    <td><input type=text name=given size=25 maxlength=25></td></tr>
<tr><td class=DataLabel >Surname</td>
    <td><input type=text name=surname size=20 maxlength=20></td></tr>
<tr><td class=DataLabel >Address</td>
    <td><input type=text name=address1 size=35 maxlength=35></td></tr>
<tr><td class=DataLabel >Suburb</td>
    <td><input type=text name=address2 size=35 maxlength=35 
               onblur="valSuburb();"></td></tr>
<tr><td class=DataLabel >     </td>    
<td ><input type=text name=address3 size=35 maxlength=35
               onChange="UpCase(this);"></td>
<td class=DataLabel  align=right>Postcode</td>
    <td><input type=text name=postcode size=8 maxlength=8
               onChange="valPostCode()"></td></tr>
  <input type=hidden name=postaddr value="P">
</table>
</span>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PRSWEB01.01.003">
<input type=hidden name=admissno value="%PRSWEB01.01.081">
<input type=hidden name=MenuType value="%PRSWEB01.01.088">
</form>
