<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript">
function validateFocus() {
  if (document.AddForm.bmiindic.value=="1") {
    document.AddForm.ptatr007.focus();
  } else {
    document.AddForm.ptatr006.focus();
  }
}
function validateAttribute() {
  var serverURL   = "../cgi-bin/patweb07.pbl?reportno=17" +
              "&ptatr006=" + document.AddForm.ptatr006.value.replace(/ /g,"+") +
              "&ptatr007=" + document.AddForm.ptatr007.value.replace(/ /g,"+") +
                    "&updttype=R" +
                    "&remoteno=2"
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    bmiDIV.innerHTML=returnValue.return_value;
  }
}
function SubmitAddAttribute() {
  p=document.AddForm

  if(!CheckDateRange(p.patntdob,p.ptatr003)) {
    return;
  }

  if (document.AddForm.ptatr006.value < 50 &&
      !isWhitespace(document.AddForm.ptatr006.value)) {
    alert("Warning: Height is less than 50cm.");
  }

  if (document.AddForm.ptatr007.value < 10 &&
      !isWhitespace(document.AddForm.ptatr007.value)) {
    alert("Warning: Weight is less than 10kg.");
  }

  if(validateMandatory(p)) {
    PostAddAttribute();
  }

}
function PostAddAttribute() {
  SubmitHidden(AddForm);
}
</script>
</head>

%START.OF.PAGE
<body onload="PageLoad(event);validateFocus();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Add Height / Weight Details - %PATWEB07.17.002 (UR Number %PATWEB07.17.003  Visit Number %PATWEB07.17.081)
</span>

<div id=PageBodySection>
<form name=AddForm id=AddForm method=post action=patweb07.pbl>
<input type=hidden name=reportno id=reportno value="17">
<input type=hidden name=template id=template value="002">
<input type=hidden name=urnumber id=urnumber value="%PATWEB07.17.003">
<input type=hidden name=admissno id=admissno value="%PATWEB07.17.081">
<input type=hidden name=updttype id=updttype value="A">
<input type=hidden name=ptatr001 id=ptatr001 value="%PATWEB07.17.003">
<input type=hidden name=ptatr002 id=ptatr002 value="%PATWEB07.17.081">
<input type=hidden name=ptatr005 id=ptatr005 value="001">
<input type=hidden name=patntdob id=patntdob value="%PATWEB07.17.020">
<input type=hidden name=bmiindic id=bmiindic value="%PATWEB07.17.218">

<table align=center width=90% border=0>
<tr><td class="DataLabel">Date</td>
    <td><input type="text" size="12" name="ptatr003" id="ptatr003"
          class="Mandatory PastDate" title="Date"
          value="%STANDARD.01.015" />
        <img notab src="../images/DateLookup.gif" class=Icon
          onclick="DateLookupFrame(AddForm.ptatr003);" />
        Time
        <input class="Mandatory" type="text" name="ptatr004" id="ptatr004"
         size="8" value="%STANDARD.01.016" title="Time">
        <img notab src="../images/DateTimeStamp.gif" class=Icon
         onclick="SetCurrentDateTime(null,AddForm.ptatr004);" />
        <img notab src="../images/TimeLookup.gif" class=Icon
         onclick="TimeLookupFrame(AddForm.ptatr004);" />
    </td>
</tr>

<tr><td class="DataLabel">Height</td>
    <td><input type="text" size="6" name="ptatr006" id="ptatr006" maxlength="6"
          class="Mandatory" title="Height" min="20.0" max="999.9"
          value="%PATWEB07.17.220" 
          onblur="if(isWhitespace(this.value)){return;}
                  if(checkNumber(this)){this.value=
                                        parseFloat(this.value).toFixed(1);
                                        validateAttribute();}"/> &nbsp; %PATWEB07.17.220 &nbsp; cm
    </td>
</tr>

<tr><td class="DataLabel">Weight</td>
    <td><input type="text" size="6" name="ptatr007" id="ptatr007" maxlength="6"
          class="Mandatory" title="Weight" min="0" max="999.9"
          value="" 
          onblur="if(isWhitespace(this.value)){return;}
                  if(checkNumber(this)){this.value=
                                        parseFloat(this.value).toFixed(1);
                                        validateAttribute();}"/> &nbsp; %PATWEB07.17.221 &nbsp; kg
    </td>
</tr>

<tr><td class="DataLabel">BMI</td>
    <td>
      <div id="bmiDIV"></div>
    </td>
</tr>

<tr><td colspan=4 align=center><br>
   <input type=button value="Add" class="button" id="pat07add"
    onclick="tempDisable(this);SubmitAddAttribute();">&nbsp;
   <input type=button value="Cancel" class="button" 
    onclick="DFrameCloseRefresh();">
   </td></tr>
</table>
</form>
</div>
