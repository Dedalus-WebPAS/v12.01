<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">

<script type="text/javascript" >
function DeleteData() {
  LinkUrl = "oprweb01.pbl?reportno=22&template=9&urnumber=" +
             document.AddForm.urnumber.value.replace(/ /g,"+") +
             "&admissno=" +
             document.AddForm.admissno.value.replace(/ /g,"+") +
             "&requestn=" +
             document.AddForm.requestn.value.replace(/ /g,"+");

  Left=(document.body.clientWidth-300)/2
  DFrameLink(LinkUrl,0,Left,300,300)
}
function PostData() {

  if(!validateMandatory(AddForm)) return;

    document.AddForm.submit();

}
function valDoctorUnit() {
  ValidateHCP(18,0,AddForm.bkreq012,AddForm.doctnam1);
  selectOptions("30",AddForm.bkreq012,AddForm.bkreq013);

  for (var i=0; i < document.AddForm.bkreq013.length; i++) {
    if (document.AddForm.bkreq013.options[i].value.substr(0,3)==
        document.AddForm.d_bkreq013.value){
      document.AddForm.bkreq013.selectedIndex=i;
    }
  }

}
function GetRequestCookie() {
  if (GetCookieData("TheatreRequestRedirect")!="unknown") {
    document.AddForm.redirect.value=GetCookieData("TheatreRequestRedirect");
    document.AddForm.thereqin.value="1";
  }
  ExpireCookiePath("TheatreRequestRedirect");
}
function ChkInp() {

  if (document.AddForm.thereqin.value != "1") {return;}

  if (AddForm.currflag.value=="1" ||AddForm.currflag.value=="2") {
    if(confirm("Use the current Admission or Create a new booking\n" +
               "   Ok to use the Current, Cancel to Create New")) {
      AdmissionLinkSearchFrame();
      return;
    }
  }
}
function AdmissionLinkSearchFrame(){
  DFrameStart();
  document.getElementById('PopUpFrame').src =
  "../lookups/AdmissionLinkReqSearchFrame.html";
  SearchFrameShow();
}
function MandatoryTheatreField() {
  f = document.AddForm;
  if (VariableNameExists('OTMandatoryonRequest')) {
    if (OTMandatoryonRequest == true) {
      AddClassName(f.bkreq021,"Mandatory");
    }
    else {
      RemoveClassName(f.bkreq021,"Mandatory");
    }
  }
  else {
    AddClassName(f.bkreq021,"Mandatory");
  }
}

</script>

</head>
%START.OF.PAGE
<body onload="PageLoad(event);valDoctorUnit();ValidateHCP(18,0,
                                          document.AddForm.bkreq020,
                                          document.AddForm.doctnam2);
              validateCode(4,document.AddForm.bkreq023,
                             document.AddForm.mbsdesc1,
                             document.AddForm.bkreq014);
              validateCode(4,document.AddForm.bkreq024,
                             document.AddForm.mbsdesc2,
                             document.AddForm.bkreq014);
              validateCode(4,document.AddForm.bkreq025,
                             document.AddForm.mbsdesc3,
                             document.AddForm.bkreq014);
              GetRequestCookie();ChkInp();
              MandatoryTheatreField();">
<div id=PageHeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB01.22.003";
PatientVIS="%OPRWEB01.22.081";
PatientNAM="%OPRWEB01.22.002";
PatientSTA="%OPRWEB01.22.086.078";
PatientALT="%OPRWEB01.22.084";
PatientSEX="%OPRWEB01.22.019";
PatientDOB="%OPRWEB01.22.020";
PatientAGE="%OPRWEB01.22.021";
PatientLOC="%OPRWEB01.22.083";
PatientPRI="%OPRWEB01.22.086.066.1";
PatientUNT="%OPRWEB01.22.066.0";
DoctorCOD="%OPRWEB01.22.082.003";
DoctorNAM="%OPRWEB01.22.082.002";
PatientAID="%OPRWEB01.22.086.090";
PatientIND="%OPRWEB01.22.086.091";
PatientCUR="%OPRWEB01.22.086.092";
PatientCLC="%OPRWEB01.22.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB01.22.086.094";
PatientCDM="%OPRWEB01.22.086.095";
PatientVDH="%OPRWEB01.22.086.099.015";
InsertPatientHeader()
</script>

<div id=PatientMenu></div>
</div>
<div id=PageBodySection>

<form name=AddForm  method=post action=oprweb01.pbl>
<input type=hidden name=reportno value=22>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%OPRWEB01.22.003">
<input type=hidden name=admissno value="%OPRWEB01.22.081">
<input type=hidden name=requestn value="%OPRWEB01.22.104">
<input type=hidden name=updttype value="U">
<input type=hidden name=nextpage value="1">
<input type=hidden name=dummy id=dummy>
<input type=hidden name=redirect value="%OPRWEB01.22.001.patweb98.01.001">
<input type=hidden name=bkreq001 value="%OPRWEB01.22.101">
<input type=hidden name=bkreq002 value="%OPRWEB01.22.102">
<input type=hidden name=bkreq003 value="%OPRWEB01.22.103">
<input type=hidden name=bkreq004 value="%OPRWEB01.22.104">
<input type=hidden name=bkreq005 value="%OPRWEB01.22.105">
<input type=hidden name=bkreq006 value="%OPRWEB01.22.106">
<input type=hidden name=bkreq008 value="%OPRWEB01.22.108">
<input type=hidden name=bkreq009 value="%OPRWEB01.22.109">
<input type=hidden name=bkreq010 value="%OPRWEB01.22.110">
<input type=hidden name=bkreq011 value="%OPRWEB01.22.111">
<input type=hidden name=d_bkreq013 value="%OPRWEB01.22.187.1">
<input type=hidden name=bkreq035 value="%OPRWEB01.22.135">
<input type=hidden name=bkreq036 value="%OPRWEB01.22.136">
<input type=hidden name=bkreq037 value="%OPRWEB01.22.137">
<input type=hidden name=bkreq038 value="%OPRWEB01.22.138">
<input type=hidden name=bkreq039 value="%OPRWEB01.22.139">
<input type=hidden name=bkreq040 value="%OPRWEB01.22.140">
<input type=hidden name=bkreq041 value="%OPRWEB01.22.141">
<input type=hidden name=bkreq042 value="%OPRWEB01.22.142">
<input type=hidden name=bkreq043 value="%OPRWEB01.22.143">
<input type=hidden name=bkreq035 value="%OPRWEB01.22.135">
<input type=hidden name=bkreq036 value="%OPRWEB01.22.136">
<input type=hidden name=bkreq037 value="%OPRWEB01.22.137">
<input type=hidden name=bkreq038 value="%OPRWEB01.22.138">
<input type=hidden name=bkreq039 value="%OPRWEB01.22.139">
<input type=hidden name=bkreq040 value="%OPRWEB01.22.140">
<input type=hidden name=bkreq041 value="%OPRWEB01.22.141">
<input type=hidden name=bkreq042 value="%OPRWEB01.22.142">
<input type=hidden name=bkreq043 value="%OPRWEB01.22.143">
<input type=hidden name=bkreq044 value="%OPRWEB01.22.144">
<input type=hidden name=bkreq045 value="%OPRWEB01.22.145">
<input type=hidden name=bkreq046 value="%OPRWEB01.22.146">
<input type=hidden name=bkreq047 value="%OPRWEB01.22.147">
<input type=hidden name=bkreq048 value="%OPRWEB01.22.148">
<input type=hidden name=bkreq049 value="%OPRWEB01.22.149">
<input type=hidden name=bkreq050 value="%OPRWEB01.22.150">
<input type=hidden name=bkreq051 value="%OPRWEB01.22.151">
<input type=hidden name=bkreq052 value="%OPRWEB01.22.152">
<input type=hidden name=bkreq053 value="%OPRWEB01.22.153">
<input type=hidden name=bkreq054 value="%OPRWEB01.22.154">
<input type=hidden name=bkreq055 value="%OPRWEB01.22.155">
<input type=hidden name=bkreq056 value="%OPRWEB01.22.156">
<input type=hidden name=bkreq057 value="%OPRWEB01.22.157">
<input type=hidden name=d_bkreq058 value="%OPRWEB01.22.158">
<input type=hidden name=refrshin>
<input type=hidden name=thereqin value=" ">
<input type=hidden name=currflag value="%OPRWEB01.22.202">
<input type=hidden name=ptcnhdps value="%OPRWEB01.22.201">
<table border="0" cellpadding="0" cellspacing="0" width="98%">


<tr><td align=center class=HeadingCell>Update Theatre Request</td></tr>
</table>

<table border="0" cellpadding="0" cellspacing="0" width="90%" align=center>

<tr>
  <td class=DataLabel>
    Priority
  </td>
  <td class=DataField>
    <select name=bkreq007 title="Priority"  class="Mandatory SelectBig">
    <option></option>
    %OPRWEB01.22.160.2
    </select>
  </td>
</tr>

<tr>
  <td class=DataLabel>
    Clock Start
  </td>
  <td class=DataField>
    <input type=text name=bkreq014 size=12 maxlength=11
     class="readOnly" readOnly
     onblur="checkDate(this,'Date')"
     title="Clock Start Date" value="%OPRWEB01.22.114">
<!--<img src=../images/DateLookup.gif border=0 hspace=4 align=absmiddle
     onclick='javascript:DateLookupFrame(bkreq014)'
     tabindex=-1>-->
    Time
    <input type=text name=bkreq015 size=7 class="readOnly" readOnly
     title="Clock Start Time" value="%OPRWEB01.22.115">
<!--<img src=../images/DateTimeStamp.gif  border=0 hspace=4 align=absmiddle
     onclick='javascript:SetCurrentDateTime(bkreq014,bkreq015)'
     tabindex=-1>
    <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle
     onclick='javascript:TimeLookupFrame(bkreq015)'
     tabindex=-1>-->
  </td>
</tr>

<tr>
    <td class="DataLabel">Requesting Doctor</td>
    <td><input type="text" size="10" maxlength="10"
         name="bkreq012" value="%OPRWEB01.22.112"
         onblur="valDoctorUnit();" />
        <input type="text" size="25" notab readonly name="doctnam1"
         value="%OPRWEB01.22.186"/>
         <img src="../images/SearchIcon.gif" class="Icon"
         onclick="HCPSearchFrame(AddForm.bkreq012,AddForm.doctnam1,0);" />
    <td>
</tr>

<tr>
  <td class=DataLabel>Unit</td>
    <td class=DataField>
    <select name=bkreq013>
    <option></option>
     %OPRWEB01.22.187.2
    </select>
    </td>
</tr>

<tr>
   <td class=DataLabel>Contact</td>
   <td>
   <input type=text name=bkreq016 size=50 maxlength=100
    title="Contact" value="%OPRWEB01.22.116">
   </td>
</tr>

<tr>
    <td class=DataLabel>Patient Location</td>
    <td class=DataLabel>
    <input type=text name=bkreq017 size=50 maxlength=50
     title="Patient Location" value="%OPRWEB01.22.117">
    </td>
</tr>

<tr><td colspan=4 align=center><hr width=100%></td></tr>

<tr><td class=DataLabel>Admitting Point</td>
    <td class=DataField>
    <select name=bkreq018 title="Admitting Point" class="SelectBig">
    <option></option>
    %OPRWEB01.22.161.2
    </select></td>
    <td class=DataLabel>Duration</td>
    <td class=DataLabel>
    <input type=text name=bkreq030 size=5 maxlength=3 value="%OPRWEB01.22.130"
     title="Duration"> &nbsp; (minutes)
    </td>
</tr>

<tr>
    <td class=DataLabel>Exp. Post Op Ward</td>
    <td class=DataField>
    <select name=bkreq019 title="Exp. Post Op Ward" class="SelectBig">
    <option></option>
    %OPRWEB01.22.119.2
    </select></td>
    <td class=DataLabel>Infection Status</td>
    <td class=DataField>
    <select name=bkreq031 title="Infection Status" class="SelectBig">
    <option></option>
    %OPRWEB01.22.167.2
    </select></td>
</tr>

<tr>
    <td class="DataLabel">Surgeon</td>
    <td><input type="text" size="10" maxlength="10"
         name="bkreq020" value="%OPRWEB01.22.120"
         onblur="ValidateHCP(18,0,bkreq020,doctnam2);" />
        <input type="text" size="25" notab readonly name="doctnam2" />
         <img src="../images/SearchIcon.gif" class="Icon"
         onclick="HCPSearchFrame(AddForm.bkreq020,AddForm.doctnam2,0);" />
    </td>
    <td class=DataLabel>Equipment Required 1</td>
    <td class=DataField>
    <select name=bkreq032 title="Equipment Required 1" class="SelectBig">
    <option></option>
    %OPRWEB01.22.164.2
    </select></td>
</tr>

<tr>
    <td class=DataLabel>Theatre</td>
    <td class=DataField>
    <select name=bkreq021 id=bkreq021 title="Theatre" class="SelectBig">
    <option></option>
    %OPRWEB01.22.162
    </select></td>
    <td class=DataLabel>Equipment Required 2</td>
    <td class=DataField>
    <select name=bkreq033 title="Equipment Required 2" class="SelectBig">
    <option></option>
    %OPRWEB01.22.165.2
    </select></td>
</tr>

<tr>
    <td class="DataLabel">Consent Obtained</td>
    <td>
    <select name="bkreq058" class="SelectBig">
    <option></option>
    <option value="N">No</option>
    <option value="Y">Yes</option>
    </select>
    </td>
  <td class=DataLabel>Equipment Required 3</td>
  <td class=DataField>
  <select name=bkreq034 title="Equipment Required 3" class="SelectBig">
  <option></option>
  %OPRWEB01.22.166.2
  </select></td>
</tr>

<tr>
    <td class=DataLabel>Consent Date</td>
    <td class=DataLabel>
    <input type=text name=bkreq059 size=12 maxlength=11 id=bkreq059
     onblur="checkDate(this,'Date')" value="%OPRWEB01.22.159"
     title="Consent Date">
    <img src=../images/DateTimeStamp.gif  class=Icon
     onclick='javascript:SetCurrentDateTimeNoFocus(bkreq059,dummy)'
     tabindex=-1>
    <img src=../images/DateLookup.gif class=Icon
     onclick='javascript:DateLookupFrame(bkreq059)'
     tabindex=-1>
    </td>
</tr>

<tr>
    <td class=DataLabel>Anaesthetic Type</td>
    <td class=DataField>
    <select name=bkreq022 title="Anaesthetic Type" class="SelectBig">
    <option></option>
    %OPRWEB01.22.163.2
    </select></td>

</tr>

<tr>
<td class=DataLabel>MBS Codes</td>
    <td><input type=text name=bkreq023 size=9
           onblur='validateCode(4,
                                AddForm.bkreq023,
                                AddForm.mbsdesc1,
                                AddForm.bkreq014)'
           title="Expected MBS Item 1" value="%OPRWEB01.22.123">
        <input type=text readonly name=mbsdesc1 size=50
           title="Expected MBS Item 1 Name" tabindex=-1>
         <img src="../images/SearchIcon.gif" class=Icon
           onClick="MbsSearchFrame(AddForm.bkreq023,
                                   AddForm.mbsdesc1,
                                   AddForm.bkreq014)"></td>
</tr>

<tr>
<td class=DataLabel></td>
    <td><input type=text name=bkreq024 size=9
           onblur='validateCode(4,
                                AddForm.bkreq024,
                                AddForm.mbsdesc2,
                                AddForm.bkreq014)'
           title="Expected MBS Item 2" value="%OPRWEB01.22.124">
        <input type=text readonly name=mbsdesc2 size=50
           title="Expected MBS Item 2 Name" tabindex=-1>
         <img src="../images/SearchIcon.gif" class=Icon
           onClick="MbsSearchFrame(AddForm.bkreq024,
                                   AddForm.mbsdesc2,
                                   AddForm.bkreq014)"></td>
</tr>

<tr>
<td class=DataLabel></td>
    <td><input type=text name=bkreq025 size=9
           onblur='validateCode(4,
                                AddForm.bkreq025,
                                AddForm.mbsdesc3,
                                AddForm.bkreq014)'
           title="Expected MBS Item 3" value="%OPRWEB01.22.125">
        <input type=text readonly name=mbsdesc3 size=50
           title="Expected MBS Item 3 Name" tabindex=-1>
         <img src="../images/SearchIcon.gif" class=Icon
           onClick="MbsSearchFrame(AddForm.bkreq025,
                                   AddForm.mbsdesc3,
                                   AddForm.bkreq014)"></td>
</tr>

<tr>
    <td class=DataLabel>Full Description</td>
    <td class=DataLabel>
    <input type=text name=bkreq026 size=80 maxlength=80
     title="MBS Full Description 1" value="%OPRWEB01.22.126">
    </td>
</tr>

<tr>
    <td class=DataLabel></td>
    <td class=DataLabel>
    <input type=text name=bkreq027 size=80 maxlength=80
     title="MBS Full Description 2" value="%OPRWEB01.22.127">
    </td>
</tr>

<tr>
    <td class=DataLabel></td>
    <td class=DataLabel>
    <input type=text name=bkreq028 size=80 maxlength=80
     title="MBS Full Description 3" value="%OPRWEB01.22.128">
    </td>
</tr>

<tr>
    <td class=DataLabel>Prosthesis Required</td>
    <td class=DataLabel>
    <input type=text name=bkreq029 size=80 maxlength=40
     value="%OPRWEB01.22.129" title="Prosthesis Required">
    </td>
</tr>

<tr>
   <td class=DataLabel>Comments</td>
   <td colspan=3>
   <textarea wrap=hard cols=60 rows=3 name=opcom012>
%OPRWEB01.22.188.012
   </textarea>
   </td>
</tr>

<tr><td colspan=4 align="center">
    <input type=button class="button" value="Ok"
     onclick="tempDisable(this);PostData();">
    <input type=button id="opr01del" name=delbuttn value="Delete"
    onclick="tempDisable(this);DeleteData();" class="button">
    <input type=button class="button" value="Cancel" 
     onClick=window.history.go(-1)>
    </td>
</tr>

</table>

</form>
</div>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=22>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value="%OPRWEB01.22.003">
<input type=hidden name=admissno value="%OPRWEB01.22.081">
<input type=hidden name=MenuType value="%OPRWEB01.22.088">
</form>

<span id=blanklabel style="display:none">&nbsp;</span>

<script type="text/javascript" >
for (var i=0; i < document.AddForm.bkreq058.length; i++) {
  if (document.AddForm.bkreq058.options[i].value==
      document.AddForm.d_bkreq058.value){
    document.AddForm.bkreq058.selectedIndex=i;
  }
}
</script>
