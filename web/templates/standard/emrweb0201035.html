<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function doctorName(doctor) {
if (isWhitespace(doctor.value)) { return;;}
doctor=doctor.value.toUpperCase()
admissno=document.PatientLinks.admissno.value;
user=document.PatientLinks.webuseid.value;
//  validate doctor exists in patdo1af
  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=3" +
                    "&valdcode=" + doctor.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status!=0) { 
    DoctorForm.emvis007.value="";   
    DoctorForm.dummy3.value="";
    DoctorForm.emvis007.focus();   
    return;
  }
//  validate doctor exists in emrdocaf
  if (DoctorForm.emcndoct.value==1) {
    var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=11" +
                      "&valdcode=" + doctor.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) { 
      DoctorForm.emvis007.value="";   
      DoctorForm.dummy3.value="";
      DoctorForm.emvis007.focus();   
      return;
    }
  }
  ReturnValue=returnValue.return_value.split("|");
  DoctorForm.dummy3.value=ReturnValue[0];
}
function UpdDoc(doctor) {
if (isWhitespace(doctor.value)) { return;;}
doctor=doctor.value.toUpperCase()
admissno=document.PatientLinks.admissno.value;
user=document.PatientLinks.webuseid.value;
//  validate doctor exists in patdo1af
  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=3" +
                    "&valdcode=" + doctor.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status!=0) { 
    DoctorForm.emvis007.value="";   
    DoctorForm.emvis007.focus();   
    return;
  }
//  validate doctor exists in emrdocaf
  if (DoctorForm.emcndoct.value==1) {
    var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=11" +
                      "&valdcode=" + doctor.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) { 
      DoctorForm.emvis007.value="";   
      DoctorForm.emvis007.focus();   
      return;
    }
  }

  var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=3" +
                   "&admissno=" + admissno.replace(/ /g,"+") +
                   "&doctcode=" + doctor.replace(/ /g,"+") +
                   "&webuseid=" + user.replace(/ /g,"+") +
                   "&updttype=ALDOC" +
                   "&updateky=" + PatientLinks.updateky.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);

  DFrameExitRefresh();
  ReloadSingleClick();
}
function ReloadSingleClick() {
  if(!getTop().location.pathname.match(/EmergencyMap/g) ||
     getTop().content == "undefined") {
     return;
  }
  if(parent.location.search.substring(1,24) == "reportno=1&template=100" ||
     parent.location.search.substring(1,25) == "reportno=01&template=100" ||
     parent.location.search.substring(1,24) == "reportno=1&template=100" ||
     parent.location.search.substring(1,25) == "reportno=01&template=110") {
     getTop().content.location.reload();
  }
}
function SearchDoctor() {
  if (DoctorForm.emcndoct.value==1) {
    DoctorEmrSearchFrame(DoctorForm.emvis007,DoctorForm.dummy3);
  }
  else {
    DoctorSearchFrame(DoctorForm.emvis007,DoctorForm.dummy3);
  }
}

function ChangeDoc(DoctorFld) {
  var bUsingDocHandovrFrm = document.DoctorForm.usingdhf.value;
  var prevDoc = document.DoctorForm.prevdoct.value;
  var bMapView = false;

  bMapView = (parent.parent.document.getElementById('EmergencyScreen') != null)
  if (bUsingDocHandovrFrm == "1") {
    if ( (parent.DocHandoverForm != undefined) && 
         (parent.PatientLinks.newdoctr != undefined) &&
         (trim(parent.PatientLinks.urnumber.value) != '0') &&
         !isWhitespace(prevDoc) ) {
      if (!isWhitespace(document.DoctorForm.emvis007.value)) {
        parent.DocHandoverForm(document.DoctorForm.emvis007.value,bMapView);
      }
    }
    else {
      UpdDoc(DoctorFld);
    }
  }
  else {
    UpdDoc(DoctorFld);
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Doctor Handover, Current Doctor : %EMRWEB02.01.107.003
</span>
<div id=PageBodySection style="overflow: auto;">
<form name=DoctorForm>
  <input type=hidden name=usingdhf value="%STANDARD.01.025.122.005.0.1">
  <input type=hidden name=prevdoct value="%EMRWEB02.01.107.003">

  <table border=1 width=100% cellspacing=0 cellpadding=0>
  <tr><td class=HeadingCell align=center colspan=4>
    Attending Doctor History</td></tr>
  <tr><td class=HeadingCell align=left>Arrival Date & Time</td>
    <td class=HeadingCell align=left>Attending Doctor</td>
    <td class=HeadingCell align=left>Seen Date & Time</td>
  </tr>
  %EMRWEB02.01.407
  </table>

  <table border=0 width=100% cellspacing=0 cellpadding=0>
  <tr align=center><td class=DataLabel>Doctor
      <input type=hidden name=emcndoct value="%EMRWEB02.01.455">
      <input type=text size=6 maxlength=6 name=emvis007 title="Doctor Code"
      onblur="UpCase(this);doctorName(DoctorForm.emvis007);">
      <input type=text size=30 name=dummy3 title="Doctor Name"
      value="" readonly class=Readonly>
      <img src="../images/SearchIcon.gif" class=Icon
       onClick="SearchDoctor();">
    </td>
  </tr>

  <tr><td align=center><input type=button class="button" value="Change"
     name="changeButton" id="changeButton"
     onclick="tempDisable(this);ChangeDoc(emvis007);">
     <input type=button class="button" value="Close"
     onclick="DFrameExitRefresh();">
      </td>
  </tr>
  </table>
</form>
</div>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=webuseid value="%STANDARD.01.008">
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=MenuType value="%EMRWEB02.01.088">
<input type=hidden name=updateky value="%EMRWEB02.01.404">
</form>
