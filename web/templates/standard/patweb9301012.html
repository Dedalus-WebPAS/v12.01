<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
%START.OF.PAGE
<script type="text/javascript">
function submitPrgplb() {
  if (validateMandatory(PrintLabels) && validateSelections()) {
    PrintLabels.redirect.value += "&formtype=" + PrintLabels.formtype.value;
    PrintLabels.submit();
  }
}
function validateSelections() {
  var bSelected = false;
  var elems = null;

  // We'll check all the Print Label checkboxes to see if any are selected
  var tblPatients = document.getElementById('tblPatients');
  if (tblPatients == undefined)
    return false;

  elems = tblPatients.getElementsByTagName('input');
  for (var i = 0; i < elems.length; i++) {
    if (elems[i].type == 'checkbox') {
      if (elems[i].checked == true) {
        bSelected = true;
        break;
      }
    }
  }

  if (!bSelected) {
    alert("No Print Label (Patient) checkboxes selected!");
    return false;
  }

  // Now we'll check to see if any Print Options are selected...
  bSelected = false;
  var tblPrtOptns = document.getElementById('tblPrintOptions');
  if (tblPrtOptns == undefined)
    return false;

  elems = tblPrtOptns.getElementsByTagName('input');
  for (var i = 0; i < elems.length; i++) {
    if (elems[i].type == 'checkbox') {
      if (elems[i].checked == true) {
        bSelected = true;
        break;
      }
    }
  }

  if (!bSelected) {
    alert("No Print Option checkboxes selected!");
    return false;
  }

  return true;
}
function SetPrinter(SelectList,Nolabel) {
 if (SelectList.className=="Mandatory SelectBig") {
     SelectList.className="SelectBig" }
 else {
     SelectList.className="Mandatory SelectBig" }
 if (Nolabel.className=="Mandatory") {
     Nolabel.className=""
 } else {
     Nolabel.className="Mandatory" }
}
function UpdateCondition(urnumber,admissno) {
  linkurl="patweb93.pbl?reportno=5&template=001" +
          "&urnumber=" + urnumber + "&admissno=" + admissno
  DFrameLink(linkurl,50,250,500,300)
}
function UpdateDiet(urnumber,admissno) { 
  linkurl="patweb98.pbl?reportno=4&template=003" +
          "&urnumber=" + urnumber + "&admissno=" + admissno
  DFrameLink(linkurl,0,75,300,150)
}
function PatientAlerts(urnumber,admissno) { 
  linkurl="patweb98.pbl?reportno=1&template=003" +
          "&urnumber=" + urnumber + "&admissno=" + admissno
  location.href=linkurl
}
function MHLegStat(urnumber,admissno) {
  linkurl="mehweb01.pbl?reportno=9&template=001" +
          "&urnumber=" + urnumber + "&admissno=" + admissno
  location.href=linkurl
}
function PatientResults(urnumber,admissno) { 
  linkurl="cliweb03.pbl?reportno=1&template=001" +
          "&urnumber=" + urnumber + "&admissno=" + admissno
  location.href=linkurl
}
function BedAllocation(urnumber,admissno) {
  linkurl="patweb96.pbl?reportno=3&template=005" +
          "&urnumber=" + urnumber + "&admissno=" + admissno
  DFrameLink(linkurl,50,250,300,120)
}
function InitTable(TableView) {
  ward=document.SelectWard.wardcode.value;
  bed=document.SelectWard.wbedtype.value;
  if (TableView==0) {
      linkurl="patweb93.pbl?reportno=1&template=012" +
              "&wardcode=" + ward +
              "&wbedtype=" + bed +
              "&formtype=" + document.PrintLabels.formtype.value;
      }
  location.href=linkurl;
}
function ModBeds() {
  document.cookie = "WardListPath=" + escape(location.href) + ";";
  var ward = document.SelectWard.wardcode.value.replace(/ /g,"+");
  location.href="patweb95.pbl?reportno=5&template=001&wardcode=" + ward;
}
function SetFormsPrint() {
  var bShowFrmsPrnt = (document.PrintLabels.formtype.value == "1");
  if (!bShowFrmsPrnt) {
    document.getElementById('spFormsPrint').innerHTML = "";
  }
  else {
    // default no printer selected
    document.getElementById('frmpsl01').selectedIndex = 0;
    document.getElementById('frmpsl02').selectedIndex = 0;
    document.getElementById('frmpsl03').selectedIndex = 0;
  }
}
function SetFormsPrintMand(SelCopies,SelStatCod,SelPrinter) {
  if (SelCopies.className=="Mandatory") {
    SelCopies.className=""
  }
  else {
    SelCopies.className="Mandatory" 
  }

  if (SelStatCod.className=="Mandatory") {
    SelStatCod.className=""
  } else {
    SelStatCod.className="Mandatory"
  }

  if (SelPrinter.className=="Mandatory SelectBig") {
    SelPrinter.className="SelectBig"
  } else {
    SelPrinter.className="Mandatory SelectBig"
  }
}
function bulkPrintA4Sheet() {
  var num_patients = 0
  for(var e = 0; e < PrintLabels.elements.length; e++) {
    var el=PrintLabels.elements[e] ;
    if(el.name.match(/inplabar/) && el.checked==true) {
      num_patients++
    }
  }
  if(num_patients == 0) {
     alert("No Print Label (Patient) checkboxes selected!");
     return;
  }
  var template="452";
  var PTCNA4TM=trim("%STANDARD.01.045.PTCNA4TM");
  if(!isWhitespace(PTCNA4TM)) {
     template=PTCNA4TM;

  }
  linkurl="patweb98.pbl?reportno=01&template=" + template + "&nourselc=1";
  Left=(document.body.clientWidth-390)/2;
  DFrameLink(linkurl,100,Left,390,140);
}
</script>
<body onload="PageLoad(event);SetCount();SetFormsPrint();">

<form name=SelectWard action=patweb93.pbl method=get style="margin:0">
<input type=hidden name=reportno value="1">
<input type=hidden name=template value="12">
<input type=hidden name=formtype value="%PATWEB93.01.061">

<table width=100% cellspacing=0 border=0>
<tr><td class=HeadingCell>
        <img src="../images/TableViewIcon.gif" class=Icon
             alt="Default View" border=0 onclick='InitTable(0);'></td>
    <td class=HeadingCell align=center>
        Current Admission for %PATWEB93.01.102</td>
    <td class=HeadingCell width=10%><input type=button value="Mod Avail Beds"
        class="button" onclick="ModBeds();"></td>
    </tr>
</table>
<table width=100% cellspacing=0 border=0>
<tr><td class=HeadingCell> Ward
        <select name=wardcode onchange="SelectWard.submit();" >
         %PATWEB93.01.001
        </select></td>

    <td class=HeadingCell> Type of Bed
        <select name=wbedtype onchange="SelectWard.submit();" >
                <option value="0">All Beds</option>
                <option value="1">Open Beds</option>
                <option value="2">Empty Beds Only</option>
    </select></td>

    <td class=HeadingCell> Number of Patients 
        <input type=text readonly name=numofpat size=3></td>

    <td class=HeadingCell>Patients in Un-Allocated Beds
        <input type=text readonly name=numunbed size=3></td>
</tr>
</table>
</form>

<form name=PrintLabels action=patweb93.pbl method=get style="margin:0">
 <input type=hidden name=reportno value=12>
 <input type=hidden name=template value=2>
 <input type=hidden name=updatety value=1>
 <input type=hidden name=redirect value="patweb93.pbl?reportno=1&template=012">
 <input type=hidden name=nextpage value="1">
 <input type=hidden name=formtype value="%PATWEB93.01.061">

<table id=tblPatients cellspacing=0 cellpadding=2 border=1 width=100%>
%PATWEB93.01.009.patweb98.01.001.patweb99.01.001.0.1. . . .1. 
</table>

<table cellspacing=0 cellpadding=2 border=0 width=100%>
<tr><td colspan=7>
    <table border=0 align=center width=100%>
       <tr align=center height=35>
           <td width=25%></td>     
           <td width=10% class=AvailableCell align=center>
               Available Bed</td>
           <td width=10% class=ClosedCell align=center bgcolor=gray>
               Closed Bed</td>
           <td width=10% class=StandbyCell align=center>
               Standby Patient</td>
           <td width=10% class=PastDischDate align=center>
               Past Date </td>
           <td width=10% class=CurrDischDate align=center>
               Current Date </td>
           <td width=25%></td>
       </tr>
    </table>
    </td>
</tr>
</table>

<table id=tblPrintOptions width=%100>
<tr><td class=DataLabel>Address </td>
    <td><input type=checkbox value="1" name=labprt01
         onclick="SetPrinter(PrintLabels.labpsl01,PrintLabels.labpno01);">
        No of Labels <select name=labpno01>
         %STANDARD.01.027.3.1
    </select></td>
    <td class=DataLabel style="text-align:right">Printer</td>
    <td><select class="SelectBig" name=labpsl01 title="Printer">
        <option></option>
        %STANDARD.01.001.LABELADD.01
        </select></td></tr>

<tr><td class=DataLabel>PMI Label</td>
    <td><input type=checkbox value="1" name=labprt02
         onclick="SetPrinter(PrintLabels.labpsl02,PrintLabels.labpno02);">
        No of Labels <select name=labpno02>
         %STANDARD.01.027.3.1
    </select></td>
    <td class=DataLabel style="text-align:right">Printer</td>
    <td><select class="SelectBig" name=labpsl02 title="Printer">
        <option></option>
        %STANDARD.01.001.LABELPMI.01
        </select></td></tr>

<tr><td class=DataLabel>Inpatient Label</td>
    <td><input type=checkbox value="1" name=labprt03
         onclick="SetPrinter(PrintLabels.labpsl03,PrintLabels.labpno03);">
        No of Labels <select name=labpno03>
         %STANDARD.01.027.3.1
    </select></td>
    <td class=DataLabel style="text-align:right">Printer</td>
    <td><select class="SelectBig" name=labpsl03 title="Printer">
        <option></option>
        %STANDARD.01.001.LABELINP.01
        </select></td></tr>

<span id="spFormsPrint">
<tr><td class=DataLabel>Form 1</td>
    <td><input type=checkbox value="1" name=frmprt01
         onclick="SetFormsPrintMand(PrintLabels.frmpno01,PrintLabels.frmcod01,PrintLabels.frmpsl01);">
        No of Copies <select name=frmpno01>
          <option value=" 1">1</option>
          <option value=" 2">2</option>
          <option value=" 3">3</option>
          <option value=" 4">4</option>
          <option value=" 5">5</option>
          <option value=" 6">6</option>
          <option value=" 7">7</option>
          <option value=" 8">8</option>
          <option value=" 9">9</option>
          <option value=" 10">10</option>
        </select>
    </td>
    <td class=DataLabel>Stationery Code</td>
    <td colspan=2>
      <select name=frmcod01 title="Stationery Code">
        <option></option>
        %STANDARD.01.020.  3
        %STANDARD.01.020.  5
      </select>
    </td>
    <td class=DataLabel>Printer</td>
    <td><select class="SelectBig" name=frmpsl01 id=frmpsl01 title="Printer">
        <option></option>
        %STANDARD.01.001
        </select></td>
</tr>
<tr><td class=DataLabel>Form 2</td>
    <td><input type=checkbox value="1" name=frmprt02
         onclick="SetFormsPrintMand(PrintLabels.frmpno02,PrintLabels.frmcod02,PrintLabels.frmpsl02);">
        No of Copies <select name=frmpno02>
          <option value=" 1">1</option>
          <option value=" 2">2</option>
          <option value=" 3">3</option>
          <option value=" 4">4</option>
          <option value=" 5">5</option>
          <option value=" 6">6</option>
          <option value=" 7">7</option>
          <option value=" 8">8</option>
          <option value=" 9">9</option>
          <option value=" 10">10</option>
        </select>
    </td>
    <td class=DataLabel>Stationery Code</td>
    <td colspan=2>
      <select name=frmcod02 title="Stationery Code">
        <option></option>
        %STANDARD.01.020.  3
        %STANDARD.01.020.  5
      </select>
    </td>
    <td class=DataLabel>Printer</td>
    <td><select class="SelectBig" name=frmpsl02 id=frmpsl02 title="Printer">
        <option></option>
        %STANDARD.01.001
        </select></td>
</tr>
<tr><td class=DataLabel>Form 3</td>
    <td><input type=checkbox value="1" name=frmprt03
         onclick="SetFormsPrintMand(PrintLabels.frmpno03,PrintLabels.frmcod03,PrintLabels.frmpsl03);">
        No of Copies <select name=frmpno03>
          <option value=" 1">1</option>
          <option value=" 2">2</option>
          <option value=" 3">3</option>
          <option value=" 4">4</option>
          <option value=" 5">5</option>
          <option value=" 6">6</option>
          <option value=" 7">7</option>
          <option value=" 8">8</option>
          <option value=" 9">9</option>
          <option value=" 10">10</option>
        </select>
    </td>
    <td class=DataLabel>Stationery Code</td>
    <td colspan=2>
      <select name=frmcod03 title="Stationery Code">
        <option></option>
        %STANDARD.01.020.  3
        %STANDARD.01.020.  5
      </select>
    </td>
    <td class=DataLabel>Printer</td>
    <td><select class="SelectBig" name=frmpsl03 id=frmpsl03 title="Printer">
        <option></option>
        %STANDARD.01.001
        </select></td>
</tr>
</span>
<tr>
  <td>
    <input type=button value=Ok class="button" onclick="submitPrgplb();">
    <span id="InsertA4LabelButton" style="display: none">
    <input type=button class="button" id="prntbttn"
     value="Print A4 Labels" onclick="bulkPrintA4Sheet();">
    </span>
  </td>
</tr>
</table>
</form>

<script type="text/javascript">
var PTCNA4LB="%STANDARD.01.045.PTCNA4LB";
if(PTCNA4LB == "1") {
  document.getElementById("InsertA4LabelButton").style.display="";
}
function SetCount() {
  SelectWard.numofpat.value="%PATWEB93.01.012" 
  SelectWard.numunbed.value="%PATWEB93.01.010" 
}

BedType="%PATWEB93.01.013"
for (var i =0 ; i < document.SelectWard.wbedtype.length; i++) {
  if (document.SelectWard.wbedtype.options[i].value==BedType.substr(0,1)) {
       document.SelectWard.wbedtype.selectedIndex=i;
  } 
};
</script>
