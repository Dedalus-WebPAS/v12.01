<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/rcpweb0306.js"></script>
<script type="text/javascript" src="../js/rcpweb03.js"></script>
<script type="text/javascript">
function init() {

setInsurance();

    AddForm.rcpbk002.value=AddForm.currdate.value;
  //
  // Display previously selected register
  //
  if (!isWhitespace(AddForm.register.value)) {
    for (var i=0; i < AddForm.rcpde004.length; i++) {
      if (AddForm.rcpde004.options[i].value.substr(0,3)==
          AddForm.register.value){
        AddForm.rcpde004.selectedIndex=i; }
    }
  }
  else {
    if (AddForm.rcpde004.length==2) {
      AddForm.rcpde004.selectedIndex=1;
    }
  }
  //
  // set visit number
  //
  if (isWhitespace(AddForm.rcpde006.value)) {
    AddForm.rcpde006.value=AddForm.admissno.value;
  }
  //
  // set UR number
  //
  if (isWhitespace(AddForm.rcpde007.value)) {
    AddForm.rcpde007.value=AddForm.urnumber.value;
  }
  //
  // Disable header if receipt already allocated.
  //
  if (!isWhitespace(AddForm.rcpbk001.value)) {   // Receipt Number Allocated
    if (AddForm.rcpbk007.value==1) {             // Received from Health Fund
      AddForm.patdebtr.checked=false;
      AddForm.hlthfund.value=AddForm.rcpbk008.value;
      AddForm.insrcode.value="";
//      AddForm.govtagnc.value="";
    }
    else if (AddForm.rcpbk007.value==2) {        // Received from Insurance
      AddForm.patdebtr.checked=false;
      AddForm.hlthfund.value="";
      AddForm.insrcode.value=AddForm.rcpbk008.value;
//      AddForm.govtagnc.value="";
    }
    else if (AddForm.rcpbk007.value==3) {        // Received from Govt Agency
      AddForm.patdebtr.checked=false;
      AddForm.hlthfund.value="";
      AddForm.insrcode.value="";
//      AddForm.govtagnc.value=AddForm.rcpbk008.value;
    }
    else {                                       // Receiver from Patient
      AddForm.patdebtr.checked=true;
      AddForm.hlthfund.value="";
      AddForm.insrcode.value="";
    }
  // disable receipt header
    GetCookieCashierPassword();
    AddForm.rcpbk004.className="Readonly";      // Drawer
    AddForm.rcpbk004.disabled=true;
    AddForm.password.className="Readonly";      // Password
    AddForm.password.readOnly=true;
    AddForm.rcpbk014.className="Readonly";      // cheque account number
    AddForm.rcpbk014.readOnly=true;
    AddForm.rcpbk014.disabled=true;
    AddForm.patdebtr.disabled=true;             // Received From Patient debtor
    AddForm.hlthfund.className="Readonly";      // Received From Health fund
    AddForm.hlthfund.readOnly=true;
    AddForm.hlthbutt.disabled=true;
    AddForm.clhfbutt.disabled=true;
    AddForm.insrcode.className="Readonly";      // Received From Insurance
    AddForm.insrcode.readOnly=true;
    AddForm.insrbutt.disabled=true;
    AddForm.clicbutt.disabled=true;
//    AddForm.govtagnc.className="Readonly";      // Received From Govt Agency
//    AddForm.govtagnc.readOnly=true;
//    AddForm.govtagnc.disabled=true;
//    AddForm.rcpbk002.className="Readonly";      // Payment Date
//    AddForm.rcpbk002.readOnly=true;
//    AddForm.currbutt.disabled=true;
//    AddForm.cldtbutt.disabled=true;
    AddForm.finshbut.disabled=false;            // Allocate Button
    AddForm.finshbut.focus();
  }
  else {                                        // Receipt Not Allocated yet
    GetCookieCashierPassword();
    if (isWhitespace(AddForm.rcpbk014.value)) {
      for (var i=0; i < AddForm.rcpbk014.length; i++) {
        if (AddForm.rcpbk014.options[i].value==AddForm.defchqno.value){
        AddForm.rcpbk014.selectedIndex=i; }
      }
    }
    AddForm.patdebtr.checked=true;
    checkOtherFields();
//    AddForm.rcpbk002.value=AddForm.currdate.value;
    AddForm.finshbut.disabled=true;
    if (AddForm.outstamt.value>0) {
      AddForm.rcpde018.value=AddForm.outstamt.value;
    }
  }
  if ((AddForm.invwarng.value==1) &&
      (isWhitespace(AddForm.rcpbk004.value))) {
    alert("WARNING: An Invoice already exists for this visit.");
  }
  AddForm.rcpbt023.value="";
}
//------------------------------------------------------------
//  Function : When Patient/Debtor box is checked
//  Health Fund, Insr, and Gov't Agency are disabled
//------------------------------------------------------------
function checkOtherFields() {
  if (AddForm.patdebtr.checked==true) {
    AddForm.hlthfund.value="";
    AddForm.hlthfund.className="Readonly";      // Received From Health fund
    AddForm.hlthfund.readOnly=true;
    AddForm.hlthbutt.disabled=true;
    AddForm.clhfbutt.disabled=true;
    AddForm.insrcode.value="";
    AddForm.insrcode.className="Readonly";      // Received From Insurance
    AddForm.insrcode.readOnly=true;
    AddForm.insrbutt.disabled=true;
    AddForm.clicbutt.disabled=true;
//    AddForm.govtagnc.selectedIndex=0;
//    AddForm.govtagnc.className="Readonly";      // Received From Govt Agency
//    AddForm.govtagnc.readOnly=true;
//    AddForm.govtagnc.disabled=true;
  }
  else {
    AddForm.hlthfund.className="";      // Received From Health fund
    AddForm.hlthfund.readOnly=false;
    AddForm.hlthbutt.disabled=false;
    AddForm.clhfbutt.disabled=false;
    AddForm.insrcode.className="";      // Received From Insurance
    AddForm.insrcode.readOnly=false;
    AddForm.insrbutt.disabled=false;
    AddForm.clicbutt.disabled=false;
//    AddForm.govtagnc.className="";      // Received From Govt Agency
//    AddForm.govtagnc.readOnly=false;
//    AddForm.govtagnc.disabled=false;
  }
}
function AddReceipt() {
  if (isWhitespace(AddForm.rcpbt023.value)) {
    return;
  }
  if (ValidateReceipt()) {
     linkurl="rcpweb03.pbl?reportno=6&template=002" +
             "&paymtype=" + AddForm.rcpbt023.value.replace(/ /g,"+") +
             "&urnumber=" + encodeURIComponent(AddForm.urnumber.value) +
             "&admissno=" + encodeURIComponent(AddForm.admissno.value) +
             "&rcpbk014=" + encodeURIComponent(AddForm.rcpbk014.value) +
             "&rcpbk004=" + encodeURIComponent(AddForm.rcpbk004.value);
     ShowDetail(linkurl);
  }
}
function UpdateReceipt(receiptno,uniqueno,paycode) {
     linkurl="rcpweb03.pbl?reportno=6&template=003" +
             "&paymtype=" + paycode.replace(/ /g,"+") +
             "&rcpbk001=" + encodeURIComponent(receiptno) +
             "&rcpbt003=" + encodeURIComponent(uniqueno) +
             "&urnumber=" + encodeURIComponent(AddForm.urnumber.value) +
             "&admissno=" + encodeURIComponent(AddForm.admissno.value) +
             "&rcpbk004=" + encodeURIComponent(AddForm.rcpbk004.value);
     ShowDetail(linkurl);
}
function CancelReceipt() {
    AddForm.updttype.value="C";
    AddForm.submit();
}
function ShowDetail(linkurl) {
  Left=(document.body.clientWidth-400)/2
  DFrameLink(linkurl,150,Left,400,340);
}
function FinishReceipt() {
  // disable button to avoid double clicking
  DisButton();
  if (parseFloat(AddForm.rcpde018.value)!=
      parseFloat(AddForm.accmtotl.value)) {
    alert("Amount does not match Accumulative Amount.");
    return;
  }
  if (parseFloat(AddForm.rcpde018.value)==0) {
    alert("Amount cannot be zero.");
    AddForm.rcpde018.focus();
    return;
  }
  AddForm.rcpbt023.className="";
  if (validateMandatory(AddForm)) {
    AddForm.updttype.value="F";
    AddForm.submit();
  }
}
function DisButton() {
  document.AddForm.finshbut.disabled=true;
  setInterval('document.AddForm.finshbut.disabled=false',6000);
}
function SetMedicalPrac() {
   medprac=AddForm.dmedprac.value
   selectOptions("94",AddForm.rcpde007,AddForm.rcpde027);
   for (var i=0 ; i < AddForm.rcpde027.length; i++) {
     if (AddForm.rcpde027.options[i].value==medprac) {
        AddForm.rcpde027.selectedIndex=i }};
}
function SetServDoct() {
   servdoc=AddForm.dservdoc.value
   selectOptions4("87",AddForm.rcpde007,AddForm.rcpde027,AddForm.rcpde038);
   for (var i=0 ; i < AddForm.rcpde038.length; i++) {
     if (trim(AddForm.rcpde038.options[i].value)==trim(servdoc)) {
        AddForm.rcpde038.selectedIndex=i }};
}

function ListServDoct() {
   if (!isWhitespace(AddForm.rcpde027.value)) {
     selectOptions4("87",AddForm.rcpde007,AddForm.rcpde027,AddForm.rcpde038);
     if(2<(document.AddForm.rcpde038.options.length)){
       document.AddForm.rcpde038.selectedIndex=0;
     }
     else{
       document.AddForm.rcpde038.selectedIndex=1;
     }
  } else {
    AddForm.rcpde038.options.length=0
    AddForm.rcpde038.options[AddForm.rcpde038.options.length]=new Option("","");
  }
}
function setInsurance() {
  document.getElementById('InsuranceDIV').innerHTML=
                document.getElementById('InsuranceSPAN1').innerHTML;
  if (InsuranceKeywordSearch){
    document.getElementById('InsuranceDIV').innerHTML=
                document.getElementById('InsuranceSPAN2').innerHTML;
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);SetMedicalPrac();ShowDiscount(AddForm);i
              SetURRef();removePaymentType('rcpbt023');SetServDoct();
              setInsurance();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%RCPWEB03.06.003";
PatientVIS="%RCPWEB03.06.081";
PatientNAM="%RCPWEB03.06.002";
PatientSTA="%RCPWEB03.06.086.078";
PatientALT="%RCPWEB03.06.084";
PatientSEX="%RCPWEB03.06.019";
PatientDOB="%RCPWEB03.06.020";
PatientAGE="%RCPWEB03.06.021";
PatientLOC="%RCPWEB03.06.083";
PatientPRI="%RCPWEB03.06.086.066.1";
PatientUNT="%RCPWEB03.06.066.0";
DoctorCOD="%RCPWEB03.06.082.003";
DoctorNAM="%RCPWEB03.06.082.002";
PatientAID="%RCPWEB03.06.086.090";
PatientIND="%RCPWEB03.06.086.091";
PatientCUR="%RCPWEB03.06.086.092";
PatientCLC="%RCPWEB03.06.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%RCPWEB03.06.086.094";
PatientCDM="%RCPWEB03.06.086.095";
PatientVDH="%RCPWEB03.06.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection >

<form name=AddForm method=get action=rcpweb03.pbl>
<input type=hidden name=reportno value=6>
<input type=hidden name=template value=004>
<input type=hidden name=updttype>
<input type=hidden name=nextpage value=1>
<input type=hidden name=redirect value="rcpweb03.pbl?reportno=6&template=4">
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden id=dummy name=dummy>
<input type=hidden name=accmtotl value="%RCPWEB03.06.306">
<input type=hidden id=defchqno name=defchqno value="%RCPWEB03.06.309">
<input type=hidden name=rcpbk001 value="%RCPWEB03.06.101">
<input type=hidden name=rcpbk003 value="%RCPWEB03.06.103">
<input type=hidden name=rcpbk007 value="%RCPWEB03.06.107">
<input type=hidden name=rcpbk008 value="%RCPWEB03.06.108">
<input type=hidden name=rcpde006 value="%RCPWEB03.06.406">
<input type=hidden name=rcpde007 value="%RCPWEB03.06.407">
<input type=hidden name=admissno value="%RCPWEB03.06.342">
<input type=hidden name=urnumber value="%RCPWEB03.06.341">
<input type=hidden name=rcpde005 value="%RCPWEB03.06.405">
<input type=hidden name=visittyp value="%RCPWEB03.06.343">
<input type=hidden name=register value="%RCPWEB03.06.404.0">
<input type=hidden name=outstamt value="%RCPWEB03.06.346">
<input type=hidden name=invwarng value="%RCPWEB03.06.347">
<input type=hidden name=rccndref value="%STANDARD.01.025.036.222.0.1">
<input type=hidden name=defltref value="%RCPWEB03.06.371">
<input type=hidden name=dmedprac value="%RCPWEB03.06.378">
<input type=hidden name=dservdoc value="%RCPWEB03.06.386.0">
<input type=hidden name=rccndisc value="%STANDARD.01.025.036.227.0.1">
<input type=hidden id=rccnrcct name=rccnrcct 
      value="%STANDARD.01.025.108.096.0.1" />
<input type=hidden id=defdeprg name=defdeprg value="">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>
     Input Private Practice Deposit</td></tr>
<tr><td>
</table>

<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=12%>Cash Drawer</td>
    <td width=35%><select name=rcpbk004 title="Cash Drawer" class=Mandatory 
      onchange="getChqAcctDepReg(rcpbk004,rcpbk014,defchqno,rcpde004,defdeprg);
                checkPR(rcpbk004,password);" id=rcpbk004>
        <option value=""></option>
        %RCPWEB03.06.301.1
        </select></td>
    <td class=DataLabel width=12%>Password</td>
    <td><input size=12 type=password id=password name=password title="Password" 
               onblur="checkPasswrd(rcpbk004,password);"></td>
    <td colspan=4>&nbsp;</td>     
    <td width=12%>Receipt Number</td>
    <td align=right width=8%>&nbsp;<b>%RCPWEB03.06.101</b></td>
</tr>
</table>
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=12%>Cheque Account</td>
    <td><select name=rcpbk014 title="Cheque Account Number" class=Mandatory
	id=rcpbk014>
        <option value=""></option>
        %RCPWEB03.06.327
        </select>
    </td>
    <td colspan=6>&nbsp;</td>     
    <td width=12%>Accumulative Total</td>
    <td align=right width=8%><b>%RCPWEB03.06.306</b></td>
</tr>
</table>
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=12%>Cashier</td>
    <td><input size=20 type=text name=wusrname title="Cashier" 
               value="%RCPWEB03.06.303" class=readOnly readonly tabindex=-1>
    </td>
    <td colspan=6>&nbsp;</td>     
</tr>
<tr><td class=DataLabel width=12%>Received From</td>
    <td width=15%>Patient/Debtor&nbsp;<input type=checkbox name=patdebtr 
             title="Patient/Debtor" value="1" checked id=patdebtr 
             onclick="checkOtherFields();"></td>
    <td width=7%>Health Fund</td>
    <td><input type=text name=hlthfund title="Health Fund" id=hlthfund
               size=6 maxlength=6 onblur='validateCode(16,hlthfund,dummy)'>
        <img src=../images/SearchIcon.gif class=Icon name=hlthbutt
             onclick="HFundSearchFrame(hlthfund,dummy);">
        <img src="../images/erase.gif" class=Icon name=clhfbutt
             onclick="clrFields(hlthfund);">
    </td>
    <td>Insurance</td>
    <td><div id="InsuranceDIV"></div></td>
<!--<td>Gov't Agency</td>
    <td><select name=govtagnc title="Gov't Agency">
        <option value=""></option>
        RCPWEB03.06.304
        </select>
    </td>-->
</tr>
<tr><td class=DataLabel>Date of Payment</td>
    <td><input type=text name=rcpbk002 title="Date of Payment"
               value="%RCPWEB03.06.102" size=12 class=readonly readonly></td>
<!--
               maxlength=12 class="Mandatory PastDate"
               onblur="checkDate(this,'Date of Payment');">
        <img notab src="../images/DateTimeStamp.gif" class="Icon" name=currbutt
             alt="Current" date="AddForm.rcpbk002">
        <img notab src="../images/DateLookup.gif" class="Icon" name=cldtbutt
             alt="Show Calendar" date="AddForm.rcpbk002"></td>
 -->
    <td colspan=6>&nbsp;</td>     
</tr>
</table>
<table width=95% align=center border=0 cellspacing=0 cellpadding=0>
<tr><td colspan=8 align=center><hr width=100%></td></tr>
<!-- PRI Deposits (96) Registers -->
<tr><td class=DataLabel width=12%>Register</td>
    <td><select name=rcpde004 title="Register" class=Mandatory
	id=rcpde004>
        <option value=""></option>
        %RCPWEB03.06.339.96
        </select></td>
    <td class=DataLabel>Reference</td>
    <td><input type=text id=rcpde015 name=rcpde015 title="Reference" size=17
               value="%RCPWEB03.06.415"
               maxlength=20>
    </td>
    <td class=DataLabel>Amount</td>
    <td><input type=text id=rcpde018 name=rcpde018 title="Amount" size=15
               value="%RCPWEB03.06.418" onblur="RoundNumber(this,2);"
               maxlength=12 class="Mandatory Number" max=999999999999.99>
    </td>
    <td class=DataLabel><span id=DiscountName style="display:none">
     Discount
     </span></td>
    <td><span id=Discount style="display:none">
        <input type=text id=rcpde019 name=rcpde019 title="Discount" size=8
               value="%RCPWEB03.06.419" onblur="RoundNumber(this,2);"
               maxlength=8 class=Number max=99999.99>
        </span>
    </td></tr>
<tr><td class=DataLabel>Medical Practice</td>
    <td><select name=rcpde027 class=Mandatory title="Medical Practice"
         id=rcode027 onchange=ListServDoct();>
        <option value=""></option>
        </select></td>
    <td class=DataLabel>Print Receipt</td>
    <td><select name=printflg>
       <option value="1">Yes</option>
       <option value="0">No</option>
       </select></td>
    <td class=DataLabel>Select Printer </td>
    <td><select name=selprint>
        %STANDARD.01.001.RCPWEB03.06
        </select></td>
    <td class=DataLabel id=copies>Copies</td>
    <td><select name=nocopies>
       <option value=" 1">1</option>
       <option value=" 2">2</option>
       <option value=" 3">3</option>
       <option value=" 4">4</option>
       <option value=" 5">5</option>
       <option value=" 6">6</option>
       <option value=" 7">7</option>
       <option value=" 8">8</option>
       <option value=" 9">9</option>
       <option value=" 10">10</option>
       </select></td>
</tr>
<tr>
    <td class=DataLabel>Deposit Type</td>
    <td><select name=rcpde034 title="Deposit Type" class=Mandatory>
        <option value=""></option>
         %RCPWEB03.06.434.2
        </select></td>
    <td class=DataLabel>Service Doctor</td>
    <td><select name=rcpde038 class=Mandatory title="Service Doctor">
        <option value=""></option>
        </select>
    </td>
    </tr>
</table>

<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td align=center><br>
    <input type=button value=Ok class="button" id=btnAdd name=finshbut
     onclick='tempDisable(this); FinishReceipt();'>
    <input type=button value=Cancel class="button"
     onclick='CancelReceipt();' >
    </td>
</tr>
</table>

<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td colspan=3 align=center><hr width=100%></td></tr>
    <tr><td class=HeadingCell width=12%>&nbsp;Payment Type</td>
    <td class=HeadingCell width=10% align=right>Amount&nbsp;</td>
    <td class=HeadingCell width=75%>&nbsp;Reference</td></tr>
    %RCPWEB03.06.305.1
<tr><td><select name=rcpbt023 title="Payment Type" class=Mandatory
                id=rcpbt023 onchange="AddReceipt();">
        <option value=""></option>
        %RCPWEB03.06.223.2
        </select></td>
    <td colspan=2>&nbsp;</td>
</tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=6>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value="%RCPWEB03.06.003">
<input type=hidden name=admissno value="%RCPWEB03.06.081">
<input type=hidden name=MenuType value="%RCPWEB03.06.088">
</form>
</div>

<span id="InsuranceSPAN1" style="display:none">
    <td><input type=text name=insrcode title="Insurance"
               size=6 maxlength=6 onblur="validateCode(36,
                                          document.AddForm.insrcode,
                                          document.AddForm.dummy);">
        <img src="../images/SearchIcon.gif" name=insrbutt
             onclick="InsuranceCodeSearch(document.AddForm.insrcode,
                                          document.AddForm.dummy);" class=Icon>
        <img src="../images/erase.gif" name=clicbutt
             onclick="clrFields(document.AddForm.insrcode);" class=Icon>
    </td>
</span>

<span id="InsuranceSPAN2" style="display:none">
    <td><input type=text name=insrcode title="Insurance"
               size=6 maxlength=6 >
        <img src="../images/SearchIcon.gif" name=insrbutt
             onclick="InsuranceSearchFrame(document.AddForm.insrcode,
                                          document.AddForm.dummy);" class=Icon>
        <img src="../images/erase.gif" name=clicbutt
             onclick="clrFields(document.AddForm.insrcode);" class=Icon>
    </td>
</span>

<script type="text/javascript">
printflag="%RCPWEB03.06.336";
for (var i=0; i<AddForm.printflg.length; i++) {
  if (AddForm.printflg.options[i].value==printflag){
        AddForm.printflg.selectedIndex=i; }
}
selectprinter="%RCPWEB03.06.337";
for (var i=0; i<AddForm.selprint.length; i++) {
  if (AddForm.selprint.options[i].value==selectprinter){
        AddForm.selprint.selectedIndex=i; }
}
numbercopies="%RCPWEB03.06.338";
for (var i=0; i<AddForm.nocopies.length; i++) {
  if (parseInt(AddForm.nocopies.options[i].value)==parseInt(numbercopies)){
        AddForm.nocopies.selectedIndex=i; }
}
</script>
