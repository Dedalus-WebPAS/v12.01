<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard" />
<meta name="HelpFileName" content="NoContextSet.html" />
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript">
function SelectSubmit() {
  document.SelectPeriod.submit();
}
function ToggleDateFields() {
  var spDateFlds = document.getElementById('spPeriodDateFlds');
  if (spDateFlds == undefined)
    return;

  if (document.SelectPeriod.optncode.selectedIndex == 1) {
    SetChildNodesDisable(spDateFlds, true);
    document.getElementById("icon1").style.display = "none";
    document.getElementById("icon2").style.display = "none";
    document.getElementById("icon3").style.display = "none";
    document.getElementById("icon4").style.display = "none";
  }
  else {
    SetChildNodesDisable(spDateFlds, false);
  }
}
function SetChildNodesDisable(Node, Disabled) {
  if (Node) {
    if (Node.childNodes) {
      for (var i=0; i < Node.childNodes.length; i++) {
        el = Node.childNodes[i];
        if (el.nodeType == 1) {
          el.disabled = Disabled;
          if (el.childNodes) {
            SetChildNodesDisable(el, Disabled);
          }
        }
      }
    }
  }
}
function addContact(ur,vis) {
  var LinkURL = "allweb03.pbl?reportno=18&template=002" +
            "&admissno=" + vis.replace(/ /g,"+") +
            "&urnumber=" + ur.replace(/ /g,"+");
  Left=(document.body.clientWidth-850)/2;
  DFrameLink(LinkURL,75,Left,850,500);
}
function linkPatient(ur,vis) {
  var LinkURL = "allweb03.pbl?reportno=18&template=001" +
            "&admissno=" + vis.replace(/ /g,"+") +
            "&urnumber=" + ur.replace(/ /g,"+");
  location.href=LinkURL;
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);ToggleDateFields();
 getScrollPosition();"
 onunload="saveScrollPosition();">
<div id="HeadingSection">
 <form name="SelectPeriod" action="patweb03.pbl" method="get" style="margin:0">
  <input type="hidden" name="reportno" value="15" />
  <input type="hidden" name="template" value="01" />
  <input type="hidden" name="viewtype" value="%PATWEB03.15.010" />

  <table cellpadding="3" bgcolor="#CCCCCC" border="0" width="100%">
   <tr><td>
         <span id=spPeriodDateFlds>
           <input type="button" value="<<" class=SmallButton
                  onclick='location.href="%PATWEB03.15.002"' />
           %PATWEB03.15.005
           <input type="button" value=">>" class=SmallButton
                  onclick='location.href="%PATWEB03.15.001"' />
           <a id="icon1" href='javascript:SelectDateFrame();'>
             <img src="../images/DateLookup.gif" class=Icon 
              alt="Select Date"></a>
           <a id="icon2" href='javascript:SelectView("0");'>
             <img src="../images/DayIcon.gif" class=Icon
               alt="View Today"></a>
           <a id="icon3" href='javascript:SelectView("1");'>
             <img src="../images/WeekIcon.gif" class=Icon
              alt="View This Week"></a>
           <a id="icon4" href='javascript:SelectView("2");'>
             <img src="../images/MonthIcon.gif" class=Icon
              alt="View This Month"></a>
         </span>
       </td>
       <td class="DataLabel" align="left">%STANDARD.01.017.CC&nbsp;&nbsp;
           <select name="carecode" class="SelectMed" onchange="SelectSubmit();">
             <option value="  ">All</option>
               %PATWEB03.15.011.2
           </select></td>
       <td class="DataLabel" align="left">Ward&nbsp;&nbsp;
           <select name="wardcode" class="SelectMed" onchange="SelectSubmit();">
             <option value="  ">All</option>
               %PATWEB03.15.007
           </select></td>
       <td class="DataLabel" align="left">Option&nbsp;&nbsp;
           <select name="optncode" class="SelectMed" onchange="SelectSubmit();">
             <option value=" ">Discharged</option>
             <option value="1">Current</option>
           </select></td></tr>
  </table>
 </form>
</div>

<div id="TableLocation"></div>

<script type="text/javascript">
for (var i =0 ; i < SelectPeriod.optncode.length; i++) {
  if (document.SelectPeriod.optncode.options[i].value=="%PATWEB03.15.009"){
      document.SelectPeriod.optncode.selectedIndex=i } };
if(document.SelectPeriod.optncode.value=="1") {
 document.title="Current Admissions";
} else {
 document.title="Discharged Admissions for %PATWEB03.15.003 to " +
                "%PATWEB03.15.004";
}
function InitTable(TableView) {
  document.title="IP Contacts for Patient Admissions";
  switch (TableView) {
   case 0: {
    t = new Table(1,0,1,"100%","center",35);
    t.addColumn("Name","ImageText",1,1,"left","PatientFolder","13",130,8)
    t.addColumn("Visit Number","String",2,2,"left nowrap","","",40)
    t.addColumn("Last IP Contact","DateTime",11,11,"left nowrap","","",60)
    t.addColumn("Add IP Contact","String",12,12,"center","EditIcon.gif","0",30)
    t.addColumn("Admission Date","DateTime",9,9,"left nowrap","","",60)
    t.addColumn("Discharge Date","DateTime",10,10,"left nowrap","","",60)
    t.addColumn("Doctor","String",5,5,"left","","",80)
    t.addColumn("%STANDARD.01.017.CC","String",6,6,"left","","",80)
    t.addColumn("Ward","String",7,7,"left","","",80)
    AddTableRows()
    TableOutput(0,1);    // Order Column,Asc Dsc
    break; }
 }
}
function AddTableRows() {
 %PATWEB03.15.006
}
</script>
