<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language="javascript" src="../js/allweb02.js"></script>
<script type="text/javascript">
function UpdateReferral(theForm) {
  if (validateMandatory(theForm)) {
    if (isWhitespace(theForm.alref094.value)) {
      alert("Warning: Referral In Clinical Referral Date field is empty.");
    }

    if(!isWhitespace(theForm.alref039.value) &&
       !isWhitespace(theForm.alref132.value)) {
       if(SetDateYYYYMMDD(theForm.alref039.value) >
          SetDateYYYYMMDD(theForm.alref132.value)) {
          alert(theForm.alref132.title + " must be after " +
          theForm.alref039.title);
          return;
       }
    }

    if(!isWhitespace(theForm.alref039.value) &&
       !isWhitespace(theForm.alref094.value)) {
       if(SetDateYYYYMMDD(theForm.alref094.value) >
          SetDateYYYYMMDD(theForm.alref039.value)) {
          alert(theForm.alref039.title + " must be after " +
          theForm.alref094.title);
          return;
       }
    }
    enablePostField();
    theForm.submit(); 
  }
}
function pageLoadExtended(event)
{
  PageLoad(event);
  validateFirstEnc();
}
function validateFirstEnc()
{
  var isRejected = false;
  var alref132 = document.getElementById("alref132");

  isRejected = checkReferralStatus();
  MandatoryScreen(UpdateForm);

  if(isRejected)
    alref132.className = "Mandatory";
}

function checkReferralStatus()
{
  var reflstat = document.getElementById("reflstat");
  var tmp =  reflstat.value.replace(/ /g,"");
  var alref132 = document.getElementById("alref132");

  if(tmp == "Rejected" || tmp == "Cancelled")
  {
      return true;
  }
  return false;
}
function displayCarePlan() {
//alert(document.UpdateForm.deptlcod.value.substr(28,1));
  if (document.UpdateForm.deptlcod.value.substr(28,1)  == "1") {
    careplantitlespan.style.display="";
    careplanfieldspan.style.display="";
  }
}
</script>
</head>

%START.OF.PAGE
<body onload="pageLoadExtended(event);displayCarePlan();CommonProgramRef();">

<span class=DFrameTitleBar>
  <img border=0 align=right src="../images/ExitIcon.gif" onclick="DFrameExit();">
  %ALLWEB02.02.125.0 Referral
</span>

<div id=PageBodySection style="overflow: auto;">

<form id=UpdateForm name=UpdateForm onsubmit='return validateMandatory(this)' 
 action="allweb02.pbl" method=post>
  <input type=hidden name=reportno value="2">
  <input type=hidden name=updatety value="U">
  <input type=hidden name=urnumber value="%ALLWEB02.02.003">
  <input type=hidden name=admissno value="%ALLWEB02.02.081">
  <input type=hidden name=deptcode value="%ALLWEB02.02.125.1">
  <input type=hidden name=deptlcod id=deptlcod value="%ALLWEB02.02.125.3">
  <input type=hidden name=activref value="0">
  <input type=hidden name=alref083 value="">
  <input type=hidden name=redirect value="allweb02.pbl?reportno=2&template=3">
  <input type=hidden name=dummy>
  <input type=hidden name=wbsesite value="%STANDARD.01.023">
  <input type=hidden name=alref028 value="">
  <input type=hidden name=alrestat value="%ALLWEB02.02.199.027">
  <input type=hidden name=refrflag value="1">
  <input type=hidden name=override value="2">
  <input type=hidden name=firstenc value="%ALLWEB02.02.244">
  <input type="hidden" name="d_aldeutrs" id="d_aldeutrs"
   value="%ALLWEB02.02.262.3">
  <input type="hidden" name="d_alrestat" id="d_alrestat"
   value="%ALLWEB02.02.199.027">
  <input type="hidden" name="d_aldeuprt" id="d_aldeuprt"
   value="%ALLWEB02.02.262.4">

<table align=center cellspacing=0 cellpadding=0 border=0 width=95%>
  <tr>
    <td class=DataLabel width=15%>Referral In Program</td>
    <td>
      <input type=text value="%ALLWEB02.02.125.0" readonly class=Readonly>
    </td>
    <td class=DataLabel>Entered by</td>
    <td>
      <input type=text name=alref000 value="%ALLWEB02.02.163" readonly 
       class=Readonly>
    </td>
  </tr>

  <tr><td class=DataLabel width=15%><div id="tsHeading"></div></td>
      <td><div id="tsField"></div></td>
      <td class=DataLabel><div id="tdHeading"></div></td>
      <td><div id="tdField"></div></td>
      </tr>

  <tr><td class=DataLabel><div id="prHeading"></div></td>
      <td><div id="prField"></div></td>
    <td class=DataLabel>%STANDARD.01.017.zU</td>
    <td>
      <select title="%STANDARD.01.017.zU" id=rfdtr001 name=rfdtr001 
       class="Mandatory SelectBig"
       onchange="SetCurrentDateTimeNoFocus(document.UpdateForm.rfdat001,null);">
        <option></option>
        %ALLWEB02.02.517.9.1.01.2.O
      </select>
    <input type=hidden name=rfdat001 value="">
    <input type=hidden name=rfdpl001 value="">
    </td>
  </tr>

  <tr>
    <td class=DataLabel>
      Referral In Receipt <br/>
      Acknowledgement Date
    </td>
    <td class=DataField>
      <input type=text id=alref132 name=alref132 size=12
       onblur="checkDate(this,'Date')" value="%ALLWEB02.02.199.003"
       class="PastDate" title="Referral In Receipt Acknowledgement Date">
      <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref132
       time=null>
      <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref132>
    </td>
    <td class=DataLabel>Referral Date</td>
    <td>
      <input type=text name=d_alref019 value="%ALLWEB02.02.119" 
       id=alref019 title="Referral Date" readonly class=Readonly size=12>
    </td>
  </tr>

  <tr>
    <td class=DataLabel>
    <span id="careplantitlespan" style="display:none">
    Care Plan Documented
    </span>
    </td>
    <td class=DataField>
    <span id="careplanfieldspan" style="display:none">
      <input type=text name=alref096 size=12 onblur="checkDate(this,'Date')"
       id=alref096 value="%ALLWEB02.02.157" class="PastDate"
       title="Care Plan Documented">
      <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref096
       time=null>
      <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref096>
    </span>
  </tr>

  <tr>
    <td class=DataLabel>Referral In Clinical Referral Date</td>
    <td class=DataField>
      <input type=text name=alref094 size=12 onblur="checkDate(this,'Date')"
       id=alref094 value="%ALLWEB02.02.155" class="PastDate"
       title="Referral In Clinical Referral Date">
      <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref094
       time=null>
      <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref094>
    <td class=DataLabel>Referral In Received Date</td>
    <td class=DataField>
      <input type=text name=alref039 size=12 onblur="checkDate(this,'Date')" 
       id=alref039 value="%ALLWEB02.02.139" class="Mandatory PastDate" 
       title="Referral In Received Date">
      <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref039
       time=null>
      <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref039>
    </td>
  </tr>

  <tr>
    <td class=DataLabel width=15%>Status</td>
    <td>
      <input type=text name=reflstat value="%ALLWEB02.02.103" tabindex=-1
       id=reflstat readonly class=Readonly>
    </td>
    <td class=DataLabel>VINAH Referral</td>
    <td>
      <input type=text name=d_alref083 size=3 readonly class=Readonly
       title="VINAH Referral" value="%ALLWEB02.02.144" tabindex=-1>
    </td>
  </tr>

  <tr>
    <td class=DataLabel width=15% id=InsertActive style="display:none;">
      Activate Referral
    </td>
    <td>
      <input type=checkbox name=activref title="Activate Referral" value="1" 
       id="activeref" style="display:none;">
    </td>
  </tr>

<tr>
   <td class=DataLabel></td>
    <td></td> 
   <td class=DataLabel>Living Arrangement</td>
    <td><select title="Living Arrangement" name=alref077 tabindex=34
         class="SelectBig">
        <option></option>
         %ALLWEB02.02.140.38.2
        </select></td>
    </tr>
<tr>
    <td class=DataLabel></td>
    <td></td>
    <td class=DataLabel>Accommodation</td>
    <td><select title="Accommodation" name=alref078 tabindex=35
         class="SelectBig">
        <option></option>
         %ALLWEB02.02.140.39.2
        </select></td>
    </tr>

  <tr>
    <td colspan=4 align=center>
      <br>
      <input type=button name=formactn value="OK" class="button" 
       id=btnAdd onclick="tempDisable(this); UpdateReferral(UpdateForm);">
      <input type=button Value="Close" class="button" onclick="DFrameClose();">
    </td>
  </tr>

</table>

</form>
</div>

<span id="showtsHeading" style="display:none">
Triage Status
</span>

<span id="showtsField" style="display:none">
<select title="Triage Status" name=alref186 class="Mandatory SelectBig"
 id="alref186" onchange="showPriorityTriage()">
<option></option>
%ALLWEB02.02.199.066.2
</select>
</span>

<span id="showtdHeading" style="display:none">
Triage Date
</span>

<span id="showtdField" style="display:none">
<input type=text name=alref187 id=alref187 size=12 title="Triage Date"
 value="%ALLWEB02.02.199.067" class="PastDate"
 onblur="checkTriageDate();">
<img src=../images/DateTimeStamp.gif class=Icon
 date=UpdateForm.alref187 time=null>
<img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref187>
</span>

<span id="showprHeading" style="display:none">
Priority
</span>

<span id="showprField" style="display:none">
<select class="Mandatory selectBig" name=alref027 id=alref027
 title="Priority">
<option></option>
 %ALLWEB02.02.127.2
</select>
</span>


<script type="text/javascript">
//
 SACSRef="%ALLWEB02.02.144";
 if ( SACSRef == "Yes") {
   document.UpdateForm.alref083.value=1;
 }
//
  if ("%ALLWEB02.02.103" == "Waiting   ") {
  InsertActive.style.display='';
  document.getElementById("activeref").style.display='';
}
</script>
