Content-Type: text/html
Cache-Control: no-cache

%START.OF.PAGE
<!DOCTYPE html>
<html>
<head>
<title>Portal Configuration</title>
<meta name="ServerID"        content="%STANDARD.01.004">
<meta name="ServerName"      content="%STANDARD.01.005">
<meta name="ServerVersion"   content="%STANDARD.01.006">
<meta name="ServerOption"    content="%STANDARD.01.002">
<meta name="ServerTemplate"  content="%STANDARD.01.003">
<meta name="TemplateFile"    content="websec0106105.html">
<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/Standard.js"></script>
<script type="text/javascript" src="../js/Custom.js"></script>
<script type="text/javascript" src="../js/json2.js"></script>
<link rel="stylesheet" href="../html/standard.css" type="text/css">
<link rel="stylesheet" href="../html/custom.css" type="text/css">
<style type=text/css>
.FreeTextEditor {
  width:800px;
  height:600px;
  background-color:white;
  border:3px outset silver;
}
.FreeTextEditorHeading {
 font-weight:bold;
 background-color: #99CCFF;
 padding-top:3px;
 padding-bottom:3px;
 text-align:center;
}
.FreeTextEditorFooter {
 text-align:center;
 padding:10px;
}
.Label {
  font-weight:bold;
}
</style>
<script type=text/javascript>

var portal_type = "";
var theURL = "PortalConfiguration.php?reportno=15&inivar=portal_type";
var xmlHttp = new XMLHttpRequest(); // Firefox, Opera 8.0+, Safari
xmlHttp.open("GET", theURL, false);
xmlHttp.send();
if (xmlHttp.status == 200) {
  portal_type = xmlHttp.responseText;
}

function Save() {
  var url="PortalConfiguration.php" 
  var el;
  var qry="reportno=5"

  if (portal_type == "sqlsrv") {
    el=document.getElementById('db_host');
    qry=qry+"&db_host="+encodeURIComponent(el.value);
  }

  el=document.getElementById('db_server');
  qry=qry+"&db_server="+encodeURIComponent(el.value);
  el=document.getElementById('db_username');
  qry=qry+"&db_username="+encodeURIComponent(el.value);
  el=document.getElementById('db_password');
  qry=qry+"&db_password="+encodeURIComponent(el.value);
  el=document.getElementById('security_token');
  qry=qry+"&security_token="+encodeURIComponent(el.value);
  el=document.getElementById('site_domain');
  qry=qry+"&site_domain="+encodeURIComponent(el.value);
  el=document.getElementById('multi_hospital_database');
  qry=qry+"&multi_hospital_database="+encodeURIComponent(el.value);
  el=document.getElementById('master_hospital_code');
  qry=qry+"&master_hospital_code="+encodeURIComponent(el.value);
  el=document.getElementById('exclude_hospital_codes');
  qry=qry+"&exclude_hospital_codes="+encodeURIComponent(el.value);
  el=document.getElementById('site_url');
  qry=qry+"&site_url="+encodeURIComponent(el.value);
  el=document.getElementById('site_email');
  qry=qry+"&site_email="+encodeURIComponent(el.value);
  el=document.getElementById('site_logo');
  qry=qry+"&site_logo="+encodeURIComponent(el.value);
  el=document.getElementById('site_name');
  qry=qry+"&site_name="+encodeURIComponent(el.value);
  el=document.getElementById('site_timeout');
  qry=qry+"&site_timeout="+encodeURIComponent(el.value);
  el=document.getElementById('google_api_key');
  qry=qry+"&google_api_key="+encodeURIComponent(el.value);

  var xmlHttp = createHttpObject();
  xmlHttp.open("POST",url,false);
  xmlHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
  xmlHttp.send(qry);
  if (xmlHttp.status == 200) {
    if (xmlHttp.responseText=="COMPLETE") {
      alert("Update Complete");
      location.reload();
      return;
    } 
  } else {
    alert("ERROR : A problem occurred saving the records Try Again.");
    return;
  }
}
function init() {
  var theURL   = "PortalConfiguration.php?reportno=5" 
  var xmlHttp=new XMLHttpRequest(); // Firefox, Opera 8.0+, Safari
  xmlHttp.open("GET", theURL, false);
  xmlHttp.send();
  if (xmlHttp.status == 200) {
    var configure = JSON.parse(xmlHttp.responseText);
    var el=document.getElementById('db_server');
    el.value = configure[0].db_server;

    if (portal_type == "sqlsrv") {
      el=document.getElementById('db_host');
      el.value = configure[0].db_host;
    }

    el=document.getElementById('db_username');
    el.value = configure[0].db_username;
    el=document.getElementById('db_password');
    el.value = configure[0].db_password;
    el=document.getElementById('security_token');
    el.value = configure[0].security_token;
    el=document.getElementById('multi_hospital_database');
    el.value = configure[0].multi_hospital_database;
    el=document.getElementById('master_hospital_code');
    el.value = configure[0].master_hospital_code;
    el=document.getElementById('exclude_hospital_codes');
    el.value = configure[0].exclude_hospital_codes;
    el=document.getElementById('site_domain');
    el.value = configure[0].site_domain;
    el=document.getElementById('site_url');
    el.value = configure[0].site_url;
    el=document.getElementById('site_email');
    el.value = configure[0].site_email;
    el=document.getElementById('site_logo');
    el.value = configure[0].site_logo;
    el=document.getElementById('site_timeout');
    el.value = configure[0].site_timeout;
    el=document.getElementById('google_api_key');
    el.value = configure[0].google_api_key;
    el=document.getElementById('site_name');
    el.value = configure[0].site_name;
  }
}
</script>
</head>
<body onload="PageLoad(event);">
<form name=PageEdit action=PortalConfiguration.php method=POST>
<input type=hidden name=reportno value=5>
<table width=100% >
<tr valign=top><td>
<table width=100% cellpadding=4 border=1 style='border:1px #ccc solid'>
<tr class=FreeTextEditorHeading><td colspan=2>Portal Configuration</td></tr>
<script type="text/javascript">
  if (portal_type == "sqlsrv") { 
    document.write("<tr><td class=Label>Database Host</td>" + 
"<td><input type=text id=db_host name=db_host size=30></td></tr>");
  }
</script>
<tr><td class=Label>Database SID</td>
    <td><input type=text id=db_server name=db_server size=30></td></tr>
<tr><td class=Label>Database User</td><td>
    <input type=text id=db_username name=db_username size=30></td></tr>
<tr><td class=Label>Database Password</td>
    <td><input type=password id=db_password name=db_password size=30></td></tr>
<tr><td class=Label>Integration Security Token</td>
    <td><input type=password id=security_token name=security_token size=50></td></tr>
<tr><td class=Label>Multi Hospital Database</td>
    <td><input type=text id=multi_hospital_database name=multi_hospital_database size=50></td></tr>
<tr><td class=Label>Master Hospital Site</td><td>
    <input type=text id=master_hospital_code name=master_hospital_code size=10></td></tr>
<tr><td class=Label>Exclude Hospital Codes</td><td>
    <input type=text id=exclude_hospital_codes name=exclude_hospital_codes size=30></td></tr>
<tr><td class=Label>Home Page URL</td> 
    <td><input type=text id=site_url name=site_url size=50></td></tr>
<tr><td class=Label>Admissions Online URL</td> 
    <td><input type=text id=site_domain name=site_domain size=50></td></tr>
<tr><td class=Label>Site Logo URL</td> 
    <td><input type=text id=site_logo name=site_logo size=50></td></tr>
<tr><td class=Label>Site Name</td> 
    <td><input type=text id=site_name name=site_name size=30></td></tr>
<tr><td class=Label>Site Email</td> 
    <td><input type=text id=site_email name=site_email size=50></td></tr>
<tr><td class=Label>Site Timeout</td><td> 
    <input type=text id=site_timeout name=site_timeout size=10></td></tr>
<tr><td class=Label>Google API Key</td><td> 
    <input type=text id=google_api_key name=google_api_key size=50></td></tr>
</table>
</td></tr>
<tr><td style='text-align:center;'>
  <input type=button class=button value=Save onclick='Save();'>
  <input type=button class=button value=Cancel onclick='location.reload();'>
</td></tr>
<table>
</form>
