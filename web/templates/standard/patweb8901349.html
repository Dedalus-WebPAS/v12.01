<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<link rel="stylesheet" href="../html/postcode.css" type="text/css">
<script type="text/javascript" src="../js/AutoPostCode.js"> </script>
<script type="text/javascript" src=../js/IBA_Category_C_.js>  </script>
<script type="text/javascript" src=../js/Comp_OV.js>  </script>

<!-- Overseas Visitor -->

<style type=text/css>

#SelectHeading{
position: absolute;
visibility: hidden;
top: 120px;
left: 320px;
height: 20px;
width: 350px;
overflow: none;
}

#SelectLocation{
position: absolute;
visibility: hidden;
top: 140px;
left: 320px;
height: 150px;
width: 350px;
overflow: auto;
}

</style>

<script type="text/javascript">

function SubmitClaim() {
  ReturnPath=GetCookieData('InvoiceReturn');
  if (!isWhitespace(ReturnPath) && ReturnPath!='unknown') {
     document.cookie="InvoiceReturn=;"            // clear cookie
     document.UpdateForm.redirect.value=ReturnPath; // return to invoice scr
 } else if(document.UpdateForm.mvmedrec.value == "1") {
     document.UpdateForm.redirect.value="mrtweb01.pbl?reportno=09&template=004"
     + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
     + "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+")
 } else if (document.UpdateForm.mhadmflg.value == "1") {
     document.UpdateForm.redirect.value="patweb89.pbl?reportno=07&template=001"
     + "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+")
     + "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+")
 } else {
     document.UpdateForm.redirect.value="patweb98.pbl?reportno=01&template=043"
     + "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+")
     + "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+")
 }

  p=document.UpdateForm
  p.pmext032.value="0";
  if(p.d_pmext032.checked==true){
    p.pmext032.value="1";
  }

  p.pmext033.value="0";
  if(p.d_pmext033.checked==true){
    p.pmext033.value="1";
  }

  UpdateForm.updatety.value="5";
  SubmitHidden(UpdateForm);
}

function InitCountry()
{
  // Set Country field type...
  if (trim(document.UpdateForm.ptmas012.value)=="8888")
  {
    // Overseas post code; use dropdown
    spCountryVal.innerHTML = spCountrySel.innerHTML;
  }
  else
  {
    // Local post code; use input field
    spCountryVal.innerHTML = spCountryInp.innerHTML;
  }

  // Make Country field Mandatory if applicable...
  SetCountryMandatory(document.UpdateForm.ptmas012);
}

function SetCountryMandatory(postcode) {
  if (!postcode || postcode == undefined) return;

  if (trim(postcode.value) == "8888") {
    document.UpdateForm.ptmas011.className =
      document.UpdateForm.ptmas011.className + " Mandatory";
  }
  else {
    document.UpdateForm.ptmas011.className =
      document.UpdateForm.ptmas011.className.replace("Mandatory","");
  }
}

</script>
%START.OF.PAGE
<body onLoad="PageLoad(event);DisplayIns();DispReciprocal();InitPostCodes();
              SetLocal();InitCountry();">

<div id=PageHeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
</div>
<div id=PageBodySection>
<form name=UpdateForm action="patweb89.pbl" method=post
 onsubmit='return validateMandatory(this); '>
  <input type=hidden name=reportno value="02">
  <input type=hidden name=template value="080">
  <input type=hidden name=updatety value="5">
  <input type=hidden name=urnumber value="%PATWEB89.01.003">
  <input type=hidden name=pmext017 value="%PATWEB89.01.003">
  <input type=hidden name=pmext018 value="%PATWEB89.01.102">
  <input type=hidden name=admissno value="%PATWEB89.01.101">
  <input type=hidden name=pmext001 value="%PATWEB89.01.101">
  <input type=hidden name=pmext002 value="%PATWEB89.01.126.1">
  <input type=hidden name=pmext032 value=" ">
  <input type=hidden name=pmext033 value=" ">
  <input type=hidden name=nextpage value=2>
  <input type=hidden name=mvmedrec value="%PATWEB89.01.902">
  <input type=hidden name=mhadmflg value="%PATWEB89.01.999.008">
  <input type=hidden name=claimtyp value="G">
  <input type=hidden name=returncd value="%PATWEB89.01.933">
  <input type=hidden name=redirect value="%PATWEB89.01.001.patweb98.01.001">
  <input type=hidden name=pmext080 value="">
  <input type=hidden name=statncod value="%PATWEB89.01.999.004.0">
  <input type=hidden name=statndes value="%PATWEB89.01.999.004.1">

<table align=center width=100% border=1 cellspacing=0 cellpadding=2>
<tr><td class=HeadingCell align=center>
    Overseas Visitor Details</td></tr>
<tr><td>
    <table width=100% border=0>

<tr><td class=DataLabel>Send Bill to Local Address</td>
    <td><input type=checkbox name=d_pmext032 tabindex=1
         title="Send Bill to Local Address" value="1" onclick="SetLocal();">
    <td class=DataLabel>Travel Insurance</td>
    <td><input type=checkbox name=d_pmext033 tabindex=20
         title="Travel Insurance" value="1">
     </td></tr>

<tr><td class=DataLabel>Local Address</td>
    <td><input type="text" size="40" maxlength="35" name=pmcex007 tabindex=3
        value="%PATWEB89.01.980.007" 
        title="Local Address line 1"
        onchange="UpCase(this);"></td>
    <td class=DataLabel>Insurance Company</td>
    <td><select name="pmext012" title="Insurance Company" tabindex=21
         value="%PATWEB89.01.384.012.0" id="pmext012"
         onchange="DisplayIns();">
        <option> </option>
         %PATWEB89.01.999.011.0 
        </select></td>
</tr>

<tr><td>&nbsp;</td>
    <td><input type="text" size="40" maxlength="35" name=pmcex008 tabindex=4
        value="%PATWEB89.01.980.008" title="Address line 2"
        onchange="UpCase(this);"></td>
    <td>Insurance Address</td>
    <td><input type="text" size="35" maxlength="35" name=insadd1
        class=ReadOnly readonly title="Insurance Address 1"></td>
</tr>

<tr><td>Suburb</td>
    <td><input type="text" size="40" maxlength="35" name=pmcex009 tabindex=5
        value="%PATWEB89.01.980.009" title="Suburb"
        onchange="valPostCode();"></td>
    <td>&nbsp;</td>
    <td><input type="text" size="35" maxlength="35" name=insadd2
        class=ReadOnly readonly title="Insurance Address 2"></td>
</tr>

<tr><td>&nbsp;</td>
    <td><input type="text" size="40" maxlength="35" name=pmcex010 tabindex=6
        value="%PATWEB89.01.980.010" title="Address line 4"
        onchange="UpCase(this);"></td>
    <td>Suburb</td>
    <td><input type="text" size="35" maxlength="35" name=insadd3
        class=ReadOnly readonly title="Insurance Suburb"></td>
</tr>

<tr><td>Post Code</td>
    <td><input type="text" size="8" maxlength="8" name=pmcex011 tabindex=6
        value="%PATWEB89.01.980.011" title="Postcode"
        onchange="LocalSuburb(UpdateForm.pmcex011.value);"></td>
    <td>&nbsp;</td>
    <td><input type="text" size="35" maxlength="35" name=insadd4
        class=ReadOnly readonly title="Insurance Suburb"></td>
</tr>

<tr><td>Overseas Address</td>
    <td><input type=text size=35 maxlength=35 tabindex=8
        name="ptmas008" title="Overseas Address Line 1"
        class=Mandatory 
        value="%PATWEB89.01.012" onchange="UpCase(this);"></td>
    <td>Post Code</td>
    <td><input type="text" size="8" maxlength="8" name=inspcode
        class=ReadOnly readonly title="Insurance Postcode"></td>
</tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td><input type=text size=35 maxlength=35
        name=ptmas009 title="Address Line 2" tabindex=9
        value="%PATWEB89.01.013" onchange="UpCase(this);"></td>
    <td class=DataLabel>Contact Name</td>
    <td><input type="text" size="50" maxlength="50" name=inscname
        class=ReadOnly readonly title="Insurance Contact Name"></td>
</tr>

<tr><td class=DataLabel>Suburb</td>
    <td><input type=text size=35 maxlength=35 title="Suburb"
       name=ptmas010 class=Mandatory tabindex=10
        value="%PATWEB89.01.014" onchange="valPMIPostCode();">
    <td class=DataLabel>Contact Phone</td>
    <td><input type="text" size="20" maxlength="20" name=insctelp
        class=ReadOnly readonly title="Insurance Contact Phone"></td>
</tr>

<tr><td class=DataLabel>Country</td>
    <td><span id="spCountryVal"></span></td>
    <td class=DataLabel>Fax Number</td>
    <td><input type="text" size="20" maxlength="20" name=inscfaxn
        class=ReadOnly readonly title="Insurance Contact Fax No"></td>
</tr>

<tr><td class=DataLabel>Post code</td>
    <td><input type=text size=4 maxlength=4
        name=ptmas012 title="Post Code" class=Mandatory tabindex=12
        value="%PATWEB89.01.016" 
        onchange="OverseasSuburb(UpdateForm.ptmas012.value);
                  SetCountryMandatory(this);">
    </td>
    <td class=DataLabel>Insurance Policy Number</td>
    <td><input type="text" size="25" maxlength="20" name=pmext034 tabindex=22
        value="%PATWEB89.01.384.034" title="Insurance Policy Number"></td>
</tr>

<tr><td class=DataLabel>Passport Number</td>
    <td><input type="text" size="25" maxlength="20" name=pmext074 tabindex=13
        value="%PATWEB89.01.384.074" title="Passport Number"></td>
    <td class=DataLabel>Insurance Expiry Date</td>
    <td><input type=text size=12 name=pmext031 tabindex=23
         value="%PATWEB89.01.384.031" class="Date" title="Date">
        <img notab src=../images/DateLookup.gif class="Icon"
         onclick="DateLookupFrame(UpdateForm.pmext031);">
        </td>
</tr>

<tr><td class=DataLabel>Passport Country</td>
    <td><select name="pmext075" title="Passport Country" tabindex=14
         class=Mandatory onchange="DispReciprocal();">
        <option> </option>
         %PATWEB89.01.384.075.2
        </select>
        <div id=reciphd></div>
        </td>
    <td class=DataLabel>Employers Name</td>
    <td><input type="text" size="55" maxlength="50" name=pmext078 tabindex=24
        value="%PATWEB89.01.384.078" title="Employer Name"></td>
</tr>

<tr><td class=DataLabel>Visa Type</td>
    <td><select name="pmext072" title="Visa Type" tabindex=15>
        <option> </option>
         %PATWEB89.01.384.072.2
        </select></td>
    <td class=DataLabel>Employers Address</td>
    <td><input type="text" size="40" maxlength="35" name=pmext080 tabindex=25
        value="%PATWEB89.01.384.080" title="Employer Address line 1"></td>
</tr>

<tr><td class=DataLabel>Visa Expiry Date</td>
    <td><input type=text size=12 name=pmext073 tabindex=16
         value="%PATWEB89.01.384.073" class="Date" title="Date">
        <img notab src=../images/DateLookup.gif class="Icon"
         onclick="DateLookupFrame(UpdateForm.pmext073);">
        </td>
    <td>&nbsp;</td>
    <td><input type="text" size="40" maxlength="35" name=pmext081 tabindex=26
        value="%PATWEB89.01.384.081" title="Employer Address line 2"></td>
</tr>

<tr><td class=DataLabel>Comments</td>
    <td><input type="text" size="55" maxlength="50" name=pmext059 tabindex=17
        value="%PATWEB89.01.384.059" title="Comments"></td>
    <td>Suburb</td>
    <td><input type="text" size="40" maxlength="35" name=pmext082 tabindex=27
        value="%PATWEB89.01.384.082" title="Suburb"
        onblur="valEmplPostCode();"></td>
</tr>

<tr><td>&nbsp;</td>
    <td><input type="text" size="55" maxlength="50" name=pmext060 tabindex=18
        value="%PATWEB89.01.384.060" title="Comments"></td>
    <td>&nbsp;</td>
    <td><input type="text" size="40" maxlength="35" name=pmext083 tabindex=28
        value="%PATWEB89.01.384.083" title="Employer Address line 4"></td>
</tr>

<tr><td>&nbsp;</td>
    <td><input type="text" size="55" maxlength="50" name=pmext061 tabindex=19
        value="%PATWEB89.01.384.061" title="Comments"></td>
    <td>Post Code</td>
    <td><input type="text" size="10" maxlength="8" name=pmext084 tabindex=29
        value="%PATWEB89.01.384.084" title="Employer Postcode"
        onchange="EmployerSuburb(UpdateForm.pmext084.value);"></td>
</tr>

<tr><td>&nbsp;</td>
    <td>&nbsp;</td>
    <td class=DataLabel><font color=red>Update PMI Details</td>
    <td><input type=checkbox name=updatpmi tabindex=30
     title="Update PMI" value="0"></td>
</tr>

<tr><td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>
</table>
</td></tr>
</table>

<table cellspacing=0 cellpadding=1 border=0 align=center width=100%>
<tr><td>&nbsp;</td></tr>
<tr><td class=DataLabel width=15%>Print %STANDARD.01.017.CL Form</td>
    <td><input type=checkbox name=prntform value="1"
         onclick="SetPrinter();">
    </td>
    <td class=DataLabel>Stationery Code</td>
    <td><input type=text name=d_statncod size=30
     class=ReadOnly readonly></td>
    <td class=DataLabel>Printer</td>
    <td><select name=schdprnt title="Printer" disabled>
        <option></option>
         %STANDARD.01.001.ELECTFRM.0G
        </select>
    </td>
</tr>
<tr><td>&nbsp;</td></tr>

<tr><td colspan=4 align=center>
    <input type=button value="Update" tabindex=35 class="button" 
    id="pat89sub" onclick="tempDisable(this);SubmitClaim();">
    <input type=button value="Cancel" tabindex=36 
     onclick="SetCancel();" class="button">
</td></tr>
</table>
</form>
<div id=SelectHeading></div>
<div id=SelectLocation></div>

<span id="spCountrySel" style="display:none;">
  <select name="ptmas011" tabindex=11 class="select120"
   title="Country Address">
    <option></option>
    %PATWEB89.01.085.060
  </select>
</span>

<span id="spCountryInp" style="display:none;">
  <input name="ptmas011" tabindex=11 type=text size=25 maxlength=25
   title="Country Address" value="%PATWEB89.01.015" onchange="UpCase(this);"/>
</span>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
<input type=hidden name=MenuType value="%PATWEB89.01.088">
</form>
<script type="text/javascript">
function SetCancel() {
 if(!confirm("Warning: Overseas Visitor data will not be updated!\n" + 
             "Ok to Continue ?")){
   return;
 } 
 ReturnPath=GetCookieData('InvoiceReturn');
 if (!isWhitespace(ReturnPath) && ReturnPath!='unknown') {
   document.cookie="InvoiceReturn=;" // clear cookie
   var link=ReturnPath;              // return to invoice scr
 }
 else {
   var urnumber ="%PATWEB89.01.003";
   var admissno ="%PATWEB89.01.101";
   var link = "patweb98.pbl?reportno=01&template=001&urnumber="+urnumber
             +"&admissno="+admissno;
 }
 location.href= link;
}
 billocal = "%PATWEB89.01.384.032";
 if(billocal == "1") {
   document.UpdateForm.d_pmext032.checked=1;
 }

 travelin ="%PATWEB89.01.384.033";
 if(travelin == "1") {
   document.UpdateForm.d_pmext033.checked=1;
 }

</script>

<div name=recipfl id=recipfl style="display: none;" class="DisplayLocation">
Reciprocal
</div>
