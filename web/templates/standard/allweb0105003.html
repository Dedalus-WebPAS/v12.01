<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/allweb0105.js"></script>
<script type="text/javascript">
function UpdateEquipment() {
  if (document.UpdateForm.c_alequ018.checked == true) {
    document.UpdateForm.alequ018.value = "1";
  } else {
    document.UpdateForm.alequ018.value = "0";
  }
  if(document.UpdateForm.c_alequ021.checked == true) {
    document.UpdateForm.alequ021.value = "1";
  } else {
    document.UpdateForm.alequ021.value = "0";
  }
  if (isWhitespace(document.UpdateForm.alequ022.value)) {
    document.UpdateForm.alequ022.value = "1";
  }
  setFormactn('U');
}
function DeleteEquipment() {
  document.UpdateForm.alequ027.value="1";
  setFormactn('D');
}

function ShowCons() {
  if(document.UpdateForm.c_alequ021.checked==true) {
    document.getElementById("ReorderLH").innerHTML=
    document.getElementById("ReolHead").innerHTML;
    document.getElementById("ReorderL").innerHTML=
    document.getElementById("ReolInput").innerHTML;
    document.getElementById("ReorderQH").innerHTML=
    document.getElementById("ReoqHead").innerHTML;
    document.getElementById("ReorderQ").innerHTML=
    document.getElementById("ReoqInput").innerHTML;
    document.UpdateForm.alequ022.readOnly=false;
    document.UpdateForm.alequ022.className="JustifyLeft Integer";
    document.UpdateForm.alequ012.options[0].text="Available";
    document.UpdateForm.alequ012.options[1].text="Not available";
  } else {
    document.getElementById("ReorderLH").innerHTML=
    document.getElementById("Blank").innerHTML;
    document.getElementById("ReorderL").innerHTML=
    document.getElementById("Blank").innerHTML;
    document.getElementById("ReorderQH").innerHTML=
    document.getElementById("Blank").innerHTML;
    document.getElementById("ReorderQ").innerHTML=
    document.getElementById("Blank").innerHTML;
    document.UpdateForm.alequ022.readOnly=true;
    document.UpdateForm.alequ022.className="Readonly JustifyLeft Integer";
    document.UpdateForm.alequ012.options[0].text="Available for Loan";
    document.UpdateForm.alequ012.options[1].text="Currently on Loan";
   }
}
function checkStatus() 
{
  var balance = document.UpdateForm.alequ022.value;
  var eqStatus  = document.UpdateForm.alequ012.value;

  if (eqStatus == "2" || eqStatus == "4") 
  {
    if (balance == document.UpdateForm.dummybal.value && balance > 0)
      document.UpdateForm.alequ022 -= 1;
    document.UpdateForm.alequ022.readOnly  = false;  
    document.UpdateForm.alequ022.className = "JustifyLeft Integer";
    document.UpdateForm.alequ022.focus();  
  }
}
function Service() {
  parent.location.href="allweb04.pbl?reportno=02&template=001&almai001=" +
                document.UpdateForm.alequ001.value.replace(/ /g,"+"); 
  DFrameExit();
}
function PrintLab() {
  linkurl="allweb01.pbl?reportno=05&template=004&deptcode=" +
                document.UpdateForm.deptcode.value.replace(/ /g,"+") +
                "&alequ001=" + 
                document.UpdateForm.alequ001.value.replace(/ /g,"+");
      Left=(document.body.clientWidth-400)/2;
      DFrameLink(linkurl,0,Left,350,200);
}
</script>
</head>
%START.OF.PAGE
<body onload=PageLoad(event);>
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
<script type="text/javascript">
document.write('%ALLWEB01.05.007.0 Equipment Maintenance');</script>
</span>
<div id=PageBodySection style="overflow: auto;">
<form name=UpdateForm method=post action=allweb01.pbl style="margin:0">
<input type=hidden name=reportno value="5">
<input type=hidden name=template value="003">
<input type=hidden name=updttype value="">
<input type=hidden name=deptcode value="%ALLWEB01.05.007.1">
<input type=hidden name=alequ007 value="%ALLWEB01.05.007.1">
<input type=hidden name=alequ018 value="">
<input type=hidden name=alequ021 value="">
<input type=hidden name=alequ027 value="%ALLWEB01.05.037">
<input type=hidden name=dummyret value="">
<input type=hidden name=dummysit value="">
<input type=hidden name=dummydat value="">
<input type=hidden name=dummybal value="%ALLWEB01.05.022">
<input type=hidden name=mbs value="M">

<table align=center width=100% border=0>
<tr><td class=DataLabel>Equipment Code   </td>
    <td><input type=text name=alequ001 class=Readonly title="Equipment code"
         size=13 maxlength=10 readonly value="%ALLWEB01.05.001">
    </td>
    <td class=DataLabel>Description</td>
    <td><input type=text name=alequ002 class="Mandatory AlphanumDesc"
         title="Description" size=45 maxlength=40 value="%ALLWEB01.05.002">
    </td></tr>

<tr><td class=DataLabel>Loan group</td>
    <td><select name=alequ003 title="Loan Group" 
         class="Mandatory SelectBig">
        <option></option>
         %ALLWEB01.05.003.2
        </select>
    </td>
    <td class=DataLabel>Equipment Type</td>
    <td><select name=alequ004 title="Equipment Type" 
         class="Mandatory SelectBig">
        <option></option>
         %ALLWEB01.05.004.2
        </select>
    </td>
    </tr>

<tr><td class=DataLabel>Equipment Sub-Type</td>
    <td><select name=alequ005 title="Equipment Sub-Type" 
         class="Mandatory SelectBig">
        %ALLWEB01.05.005.2
        </select>
    </td>
    <td class=DataLabel>Home Location</td>
    <td><select name=alequ006 title="Home Location" 
         class="Mandatory SelectBig">
        <option></option>
         %ALLWEB01.05.006.2
        </select>
    </td>
    </tr>

<tr><td class=DataLabel>Item Code</td>
    <td colspan=3>
    <input type=text name=alequ008 title="Item Code"
     size=11 maxlength=9 value="%ALLWEB01.05.008.1"
     onblur="validatePMBS(UpdateForm.alequ008,UpdateForm.dummy);">
    <input type=text size=50 name=dummy value="%ALLWEB01.05.008.0" readonly 
     class=Readonly>
    <img src=../images/SearchIcon.gif class=Icon
     onclick='PriMbsSearchFrame(UpdateForm.dummyret,UpdateForm.alequ008,
      UpdateForm.dummysit,UpdateForm.dummyret,UpdateForm.dummy,UpdateForm.mbs)'>
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(UpdateForm.alequ008,UpdateForm.dummy);">
    </td></tr>

<tr><td class=DataLabel>Supplier Code</td>
    <td colspan=3>
    <input type=text name=alequ009 title="Supplier Code"
     size=11 maxlength=5 value="%ALLWEB01.05.009"
     onblur="ValidateSupplier(UpdateForm.alequ009,UpdateForm.dummy1);">
    <input type=text size=50 name=dummy1 
                value="%ALLWEB01.05.036" readonly class=Readonly>
    <img src=../images/SearchIcon.gif class=Icon
     onclick='SuppSearchFrame(UpdateForm.alequ009,UpdateForm.dummy1)'>
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(UpdateForm.alequ009,UpdateForm.dummy1);">
    </td></tr>

<tr><td class=DataLabel>Supplier Product Code</td>
    <td><input type=text name=alequ010
         title="Supplier Product Code"
         size=23 maxlength=20 value="%ALLWEB01.05.010">
    </td>
    <td class=DataLabel>Serial Number</td>
    <td><input type=text name=alequ011 title="Serial Number"
         size=23 maxlength=20 value="%ALLWEB01.05.011">
    </td></tr>

<tr><td class=DataLabel>Purchase Date</td>
    <td><input type=text name=alequ014 title="Purchase Date"
         size=10 maxlength=10 class=PastDate value="%ALLWEB01.05.014">
        <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alequ014
         time=null>
        <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alequ014>
    </td>
    <td class=DataLabel>Maintenance Period(months)</td>
    <td><input type=text name=alequ015 title="Maintenance Period"
         size=5 maxlength=3 class=Integer value="%ALLWEB01.05.015">
    </td></tr>

<tr><td class=DataLabel>Unit Cost</td>
    <td><input type=text name=alequ016 title="Unit Cost" class="Number" min=0
         max=99999999999999.99 size=19 maxlength=17 value="%ALLWEB01.05.016"
         onblur="RoundNumber(this,2);">
    </td>
    <td class=DataLabel>Deposit</td>
    <td><input type=text name=alequ017 title="Deposit" class="Number" min=0
         max=99999999.99 size=13 maxlength=11 value="%ALLWEB01.05.017"
         onblur="RoundNumber(this,2);">
    </td></tr>

<tr><td class=DataLabel>Special Funding</td>
    <td><input type=checkbox name=c_alequ018 title="Active" size=40 
          maxlength=40 value="1">
    </td>
    <td class=DataLabel>Re-Condition Date</td>
    <td><input type=text name=alequ020 title="Re-Condition Date"
         size=10 maxlength=8 class=PastDate value="%ALLWEB01.05.020">
        <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alequ020
         time=null>
        <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alequ020>
    </td>
    </tr>

<tr><td class=DataLabel>Loan Authorisation Level</td>
    <td><select name=alequ019 title="Authorisation Level">
        <option></option>
        <option value="0">0 </option>
        <option value="1">1 </option>
        <option value="2">2 </option>
        <option value="3">3 </option>
        <option value="4">4 </option>
        <option value="5">5 </option>
        <option value="6">6 </option>
        <option value="7">7 </option>
        <option value="8">8 </option>
        <option value="9">9 </option>
        </select>
    </td>
    </td>
    <td class=DataLabel>Status</td>
    <td><select name=alequ012 title="Status" onchange="checkStatus();">
          <option value="0" selected >Available for Loan </option>
          <option value="1">Currently on Loan </option>
          <option value="2">Inactive/Written Off </option>
          <option value="3">Needs Maintenance </option>
          <option value="4">Delete -strike out-</option>
        </select> 
    </td></tr>

<tr><td class=DataLabel>Consumable</td>
    <td><input type=checkbox name=c_alequ021 title="Consumable" value="1"
         onclick="ShowCons();">
    </td>
  <td class=DataLabel>Current Balance</td>
    <td><input type=text name=alequ022 title="Current Balance"
         size=10 maxlength=8 min=0 max=99999999 
         class="Readonly JustifyLeft Integer" readonly
         value="%ALLWEB01.05.022"
         onblur="checkInteger(this,this.title);checkStatus();">
    </td>

    </tr>

<tr><td><div id="ReorderLH"></div></td>
    <td><div id="ReorderL"></div></td>
    <td><div id="ReorderQH"></div></td>
    <td><div id="ReorderQ"></div></td>
    </tr>

<tr><td colspan=4 align=center><br>
   <input type=button value="Update" class="button" id="all01upd"
    onclick="tempDisable(this);UpdateEquipment();">
   <input type=button value="Delete" class="button" id="all01del"
    name=deletebut onclick="tempDisable(this);DeleteEquipment();">
   <input type=button value="Cancel" class="button" 
    onclick=DFrameCloseRefresh();>
   <input type=button value="Asset Labels" class="button" onclick='PrintLab();'>
   <input type=button value="Maintenance" class="button" onclick='Service();'>
   </td></tr>

</table>
</form>

<span id=Blank style="display:none">
  <input type=hidden name=alequ023 value="0">
  <input type=hidden name=alequ024 value="0">
</span>

<span id=BalHead style="display:none">
  <td class=DataLabel>Current Balance</td>
  </tr>
</span>
<span id=BalInput style="display:none">
    <td><input type=text name=alequ022 title="Current Balance"
         size=10 maxlength=8 class="JustifyLeft Integer" 
         value="%ALLWEB01.05.022"
         onblur="checkInteger(this,this.title);">
    </td>
</span>

<span id=ReolHead style="display:none">
  <td class=DataLabel>Re-Order Level</td>
  </tr>
</span>
<span id=ReolInput style="display:none">
    <td><input type=text name=alequ023 title="Re-Order Level"
         size=10 maxlength=8 class="Integer" value="%ALLWEB01.05.023"
         onblur="checkInteger(this,this.title);">
    </td>
</span>

<span id=ReoqHead style="display:none">
  <td class=DataLabel>Re-Order Quantity</td>
  </tr>
</span>
<span id=ReoqInput style="display:none">
    <td><input type=text name=alequ024 title="Re-Order Quantity"
         size=10 maxlength=8 class="Integer" value="%ALLWEB01.05.023"
         onblur="checkInteger(this,this.title);">
    </td>
</span>

<script type="text/javascript">
function init() {
  StatusFlag = "%ALLWEB01.05.012" 
  if (trim(document.UpdateForm.dummybal.value)=="0") {
     if (StatusFlag == "0") {
         StatusFlag = "1"; }
  } else {
     if (StatusFlag == "1") {
         StatusFlag = "0"; }
  }
  for (var i =0 ; i < document.UpdateForm.alequ012.length; i++) {
    if(document.UpdateForm.alequ012.options[i].value==StatusFlag.substr(0,1)) {
       document.UpdateForm.alequ012.selectedIndex=i } };
//
  Authorisation= "%ALLWEB01.05.019"
  for (var i =0 ; i < document.UpdateForm.alequ019.length; i++) {
  if(document.UpdateForm.alequ019.options[i].value==Authorisation.substr(0,1)) {
       document.UpdateForm.alequ019.selectedIndex=i } };
}
// Consumable
if ("%ALLWEB01.05.021" == "1") {           
  document.UpdateForm.c_alequ021.checked="1";  
  ShowCons();
}
// Special Funding
if ("%ALLWEB01.05.018" == "1") {           
  document.UpdateForm.c_alequ018.checked="1";  
  document.UpdateForm.alequ022.readOnly=false;  
  document.UpdateForm.alequ022.className="JustifyLeft Integer";  
}
// Deleted Record
if ("%ALLWEB01.05.037" == "1") {           
  document.UpdateForm.deletebut.disabled=true;  
}
</script>
