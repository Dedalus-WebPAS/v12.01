<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<link rel="stylesheet" href="../html/postcode.css" type="text/css">
<script type="text/javascript" src=../js/AutoPostCode.js></script>
<script type="text/javascript" src=../js/IBA_Category_C_.js>  </script>
<script type="text/javascript" src=../js/patweb0706.js>  </script>
<script  type="text/javascript">
function validateAttribute() {
  var serverURL   = "../cgi-bin/patweb07.pbl?reportno=17" +
           "&ptatr006=" + document.UpdateForm.ptatr006.value.replace(/ /g,"+") +
           "&ptatr007=" + document.UpdateForm.ptatr007.value.replace(/ /g,"+") +
                    "&updttype=R" +
                    "&remoteno=2"
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    bmiDIV.innerHTML=returnValue.return_value;
  }
}
function getTimeDifference() {
  AttrDateObj=GetDateObj(document.UpdateForm.attrdate.value,
                         document.UpdateForm.attrtime.value );

  CurrDateObj=GetDateObj(document.UpdateForm.currdate.value,
                         document.UpdateForm.currtime.value );


  diff= Math.abs(CurrDateObj-AttrDateObj);
  minutes=diff/60000;

  if (minutes>15) {
    document.UpdateForm.pat07upd.disabled=true;    
    document.UpdateForm.ptatr018.value="1";
    document.UpdateForm.ptatr003.className="Readonly";
    document.UpdateForm.ptatr003.readOnly=true;
    document.UpdateForm.ptatr004.className="Readonly";
    document.UpdateForm.ptatr004.readOnly=true;
    document.UpdateForm.ptatr006.className="Readonly";
    document.UpdateForm.ptatr006.readOnly=true;
    document.UpdateForm.ptatr007.className="Readonly";
    document.UpdateForm.ptatr007.readOnly=true;

  }

}
function submitUpdAttribute() {
  p=document.UpdateForm

  document.UpdateForm.ptatr018.value="";

  if (document.UpdateForm.ptatr006.value < 50 &&
      !isWhitespace(document.UpdateForm.ptatr006.value)) {
    alert("Warning: Height is less than 50cm.");
  }

  if (document.UpdateForm.ptatr007.value < 10 &&
      !isWhitespace(document.UpdateForm.ptatr007.value)) {
    alert("Warning: Weight is less than 10kg.");
  }

  if (validateMandatory(p)){
    PostUpdAttribute()
  }

}
function PostUpdAttribute(){
  setFormactn('U');
}
</script>
</head>

%START.OF.PAGE
<body onload="PageLoad(event);getTimeDifference();validateAttribute();
              getCalculatedBMI();document.UpdateForm.ptatr007.focus();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Update Height / Weight Details - %PATWEB07.17.002 (UR Number %PATWEB07.17.003  Visit Number %PATWEB07.17.081)
</span>

<div id=PageBodySection>
<form name=UpdateForm id=UpdateForm method=post action=patweb07.pbl>
<input type=hidden name=reportno id=reportno value="17">
<input type=hidden name=template id=template value="003">
<input type=hidden name=urnumber id=urnumber value="%PATWEB07.17.003">
<input type=hidden name=admissno id=admissno value="%PATWEB07.17.081">
<input type=hidden name=updttype id=updttype value="">
<input type=hidden name=attrdate id=attrdate value="%PATWEB07.17.103">
<input type=hidden name=attrtime id=attrtime value="%PATWEB07.17.104">
<input type=hidden name=currdate id=currdate value="%STANDARD.01.015">
<input type=hidden name=currtime id=currtime value="%STANDARD.01.016">
<input type=hidden name=ptatr001 id=ptatr001 value="%PATWEB07.17.101">
<input type=hidden name=ptatr002 id=ptatr002 value="%PATWEB07.17.102">
<input type=hidden name=ptatr005 id=ptatr005 value="%PATWEB07.17.105">
<input type=hidden name=ptatr018 id=ptatr018 value="%PATWEB07.17.118">
<input type=hidden name=ptatr019 id=ptatr019 value="%PATWEB07.17.119">
<input type=hidden name=ptatr020 id=ptatr020 value="%PATWEB07.17.120">
<input type=hidden name=ptatr021 id=ptatr021 value="%PATWEB07.17.121">

<table align=center width=90% border=0>
<tr><td class="DataLabel">Date</td>
    <td><input type="text" size="12" name="ptatr003" id="ptatr003"
          class="Mandatory PastDate" title="Date"
          value="%PATWEB07.17.103" />
        <img notab src="../images/DateLookup.gif" class=Icon
         onclick="DateLookupFrame(UpdateForm.ptatr003);" />
        Time
        <input class="Mandatory" type="text" name="ptatr004" id="ptatr004"
         size="8" value="%PATWEB07.17.104" title="Time">
        <img notab src="../images/DateTimeStamp.gif" class=Icon
         onclick="SetCurrentDateTime(null,UpdateForm.ptatr004);" />
        <img notab src="../images/TimeLookup.gif" class=Icon
         onclick="TimeLookupFrame(UpdateForm.ptatr004);" />
    </td>
</tr>

<tr><td class="DataLabel">Height</td>
    <td><input type="text" size="6" name="ptatr006" id="ptatr006" maxlength="6"
          class="Mandatory" title="Height" min="20.0" max="999.9"
          value="%PATWEB07.17.106"
          onblur="if(isWhitespace(this.value)){return;}
                  if(checkNumber(this)){this.value=
                                        parseFloat(this.value).toFixed(1);
                                        validateAttribute();}"/> &nbsp; %PATWEB07.17.106 &nbsp; cm
    </td>
</tr>

<tr><td class="DataLabel">Weight</td>
    <td><input type="text" size="6" name="ptatr007" id="ptatr007" maxlength="6"
          class="Mandatory" title="Weight" min="0" max="999.9"
          value="%PATWEB07.17.107" 
          onblur="if(isWhitespace(this.value)){return;}
                  if(checkNumber(this)){this.value=
                                        parseFloat(this.value).toFixed(1);
                                        validateAttribute();}"/>&nbsp; %PATWEB07.17.107 &nbsp; kg
    </td>
</tr>

<tr><td class="DataLabel">BMI</td>
    <td>
      <div id="bmiDIV"></div>
    </td>
</tr>

<tr><td colspan=4 align=center><br>
   <input type=button value="Update" class="button" id="pat07upd"
    onclick="tempDisable(this);submitUpdAttribute();">&nbsp;
   <input type=button value="Cancel" class="button"
    onclick="DFrameCloseRefresh();"><br>
   <input type=button value="Delete" class="button"
    onclick="setFormactn('D');">
   </td></tr>
</table>
</form>
</div>

<script type="text/javascript">
function getCalculatedBMI() {
  var calculatedBMI = "%PATWEB07.17.222";

  if (!isWhitespace(calculatedBMI)) {
    bmiDIV.innerHTML=calculatedBMI;
  }
}
</script>

