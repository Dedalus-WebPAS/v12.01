<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function Init() {
 if (document.ReportForm.ibcnmhos.value==1) {
   document.getElementById('HospitalID').innerHTML=document.getElementById('HospID').innerHTML; 
 }
}

function TranFeeOpt() {
 hosid=(document.ReportForm.ibcnmhos.value);
 if (ReportForm.keystr01.value==2) {
   if (hosid==1) {
     var serverURL = "../cgi-bin/patweb80.pbl?reportno=74" 
                   + "&valdcode=" 
                   + document.getElementById('hospid').value.replace(/ /g,"+");
   } else {
     var serverURL = "../cgi-bin/patweb80.pbl?reportno=74" 
                   + "&valdcode=" 
                   + document.ReportForm.dummy.value.replace(/ /g,"+");
   }

   var returnValue = RSExecute(serverURL);
   if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|");

      document.ReportForm.tbinvopt.value = ReturnValue[0];
   } else {
      document.ReportForm.tbinvopt.value = "";
   }

   if (document.ReportForm.tbinvopt.value==1) {
     document.getElementById('TransOption').innerHTML=document.getElementById('TransFee').innerHTML;
     return; 
   }
 }
 document.getElementById('TransOption').innerHTML="";  
}

function FinOpt() {
  var p = document.ReportForm;
  if (p.d_menufl.value == '1' && p.keystr01.value == '2') {
    document.getElementById('ADT36Option').innerHTML = document.getElementById('RunFin').innerHTML
    document.getElementById('SummaryOption').innerHTML = document.getElementById('FinSummary').innerHTML;
    document.getElementById('SetDateRange').className = "Mandatory PastDate";   
    document.getElementById('SetScheduleRange').className = "Mandatory PastDate";
    SetReportDates();
    if (p.schdrdat.value == "") {
      GetFinDate();
    }
  } 
  else {
    document.getElementById('ADT36Option').innerHTML="";  
    document.getElementById('SummaryOption').innerHTML="";
  }

  if (p.exportde.value == '1' & p.keystr01.value == '2') {
    document.getElementById('showdesc').style.display = "";
    document.getElementById('d_exdesc').checked = true;
  } else {
    document.getElementById('showdesc').style.display = "none";
    document.getElementById('d_exdesc').checked = false;
  }
}

function SummOpt() {
  var p = document.ReportForm;
  var chkRun = document.getElementById('runsummary');

  if (chkRun != undefined) {
    if (chkRun.checked == true) {
      document.getElementById('SummaryOption').innerHTML = document.getElementById('FinSummary').innerHTML;
      document.getElementById('SetDateRange').className = "Mandatory PastDate";   
      document.getElementById('SetScheduleRange ').className = "Mandatory PastDate";   
      SetReportDates();
      if (p.schdrdat.value == "") {
        GetFinDate();
      }
    } 
    else {
      document.getElementById('SummaryOption').innerHTML="";  
    }
  }
}

function GetFinDate() {
  var p = document.ReportForm;
  var i = p.patopt.selectedIndex;
  var ind = trim(p.patopt.options[i].value.substr(3,1));

  var serverURL   = "../cgi-bin/comweb81.pbl?reportno=5" +
                    "&valdindc=" + ind.replace(/ /g,"+");

  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    document.getElementById('datran01').value = ReturnValue[0];
    document.getElementById('datran02').value = p.d_curdat.value;
  } 
  else {
    document.getElementById('datran01').value = "";
    document.getElementById('datran02').value = "";
  }
}

function ProcessReport() {
 SubmitPage=true

 var p = document.ReportForm;
 var pdesc = document.getElementById('d_exdesc');
 var chkRun = document.getElementById('runsummary');
 
 if (p.keystr01.value==2) {  // Print and Reset
   if (p.d_menufl.value == '1') {
     if (chkRun.checked == true) {
       if (p.schdrdat.value == "") {
         ffindate=SetDateDDMMYYYY(document.getElementById('datran01').value);
         tfindate=SetDateDDMMYYYY(document.getElementById('datran02').value);
       }
       else {  // Re-schedule Type selected
         ffindate=document.getElementById('datran01').value;
         tfindate=document.getElementById('datran02').value;
       }
     }
   }
 }

// 1 - Outpatient - all Department
if ((document.ReportForm.keystr01.value == 1) ||
    ((document.ReportForm.keystr01.value == 2) &&
        (document.ReportForm.tbinvopt.value != 1))) {
    i = document.ReportForm.patopt.selectedIndex
    ind = trim(document.ReportForm.patopt.options[i].value.substr(3, 1));
    hosid = (document.ReportForm.ibcnmhos.value);
    if (ind == 2) {
        if (document.getElementById('outpat').value == 1) {
            document.ReportForm.keystr02.value = document.ReportForm.patopt.value;
            document.ReportForm.keystr03.value =
                document.getElementById('outpat').value;
            document.ReportForm.keystr04.value = document.ReportForm.getyear.value;
            if (hosid == 1) {
                document.ReportForm.keystr05.value =
                    document.getElementById('hospid').value;
                if (document.ReportForm.exportfl.value == "Y") {
                    document.ReportForm.keystr06.value = "Y"
                } else {
                    document.ReportForm.keystr06.value = "N"
                }

                if (document.ReportForm.keystr01.value == 2) {

                    //  keystr01 = 2 (Print & Reset)
                    if (document.getElementById('ptcnuabf').value == "1") {
                        if (pdesc.checked) {
                          document.ReportForm.keystr07.value = "Y"
                        } else {
                          document.ReportForm.keystr07.value = "N"
                        }
                        document.ReportForm.keystr08.value =
                            document.getElementById('inclbook').value;
                        if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                            document.ReportForm.keystr09.value = "Y"
                            document.ReportForm.keystr10.value =
                                document.getElementById('trantype').value;
                            document.ReportForm.keystr11.value = ffindate
                            document.ReportForm.keystr12.value = tfindate
                        } else {
                            document.ReportForm.keystr09.value = "N"
                            document.ReportForm.keystr10.value = " "
                            document.ReportForm.keystr11.value = " "
                            document.ReportForm.keystr12.value = " "
                        }
                    } else {
                        if (pdesc.checked) {
                          document.ReportForm.keystr07.value = "Y"
                        } else {
                          document.ReportForm.keystr07.value = "N"
                        }
                        if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                            document.ReportForm.keystr08.value = "Y"
                            document.ReportForm.keystr09.value =
                                document.getElementById('trantype').value
                            document.ReportForm.keystr10.value = ffindate
                            document.ReportForm.keystr11.value = tfindate
                        } else {
                            document.ReportForm.keystr08.value = "N"
                            document.ReportForm.keystr09.value = " "
                            document.ReportForm.keystr10.value = " "
                            document.ReportForm.keystr11.value = " "
                        }
                    }

                    //  Keystr01 <> 1 (Print Only)
                } else {
                    if (document.getElementById('ptcnuabf').value == "1") {
                        document.ReportForm.keystr07.value = "N"
                        document.ReportForm.keystr08.value =
                            document.getElementById('inclbook').value;
                    }

                }

                // hosid <> 1

            } else {
                if (document.ReportForm.exportfl.value == "Y") {
                    document.ReportForm.keystr05.value = "Y"
                } else {
                    document.ReportForm.keystr05.value = "N"
                }
                if (document.ReportForm.keystr01.value == 2) {

                    //  keystr01 = 2 (print * reset)

                    if (document.getElementById('ptcnuabf').value == "1") {
                        if (pdesc.checked) {
                            document.ReportForm.keystr06.value = "Y"
                        } else {
                            document.ReportForm.keystr06.value = "N"
                        }
                        document.ReportForm.keystr07.value =
                            document.getElementById('inclbook').value;
                        /////
                        if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                            document.ReportForm.keystr08.value = "Y";
                            document.ReportForm.keystr09.value =
                                document.getElementById('trantype').value;
                            document.ReportForm.keystr10.value = ffindate;
                            document.ReportForm.keystr11.value = tfindatie;
                        } else {
                            document.ReportForm.keystr08.value = "N";
                            document.ReportForm.keystr09.value = " ";
                            document.ReportForm.keystr10.value = " ";
                            document.ReportForm.keystr11.value = " ";
                        }
                    } else {
                        if (pdesc.checked) {
                            document.ReportForm.keystr06.value = "Y"
                        } else {
                            document.ReportForm.keystr06.value = "N"
                        }
                        if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                            document.ReportForm.keystr07.value = "Y";
                            document.ReportForm.keystr08.value =
                                document.getElementById('trantype').value;
                            document.ReportForm.keystr09.value = ffindate;
                            document.ReportForm.keystr10.value = tfindate;
                        } else {
                            document.ReportForm.keystr07.value = "N";
                            document.ReportForm.keystr08.value = " ";
                            document.ReportForm.keystr09.value = " ";
                            document.ReportForm.keystr10.value = " ";
                        }
                        document.ReportForm.keystr11.value = " ";
                    }

                    // keystr01<>2 (print only)

                } else {
                    if (pdesc.checked) {
                    document.ReportForm.keystr06.value = "N"
                    if (document.getElementById('ptcnuabf').value == "1") {
                        document.ReportForm.keystr07.value =
                            document.getElementById('inclbook').value;
                    }
                }
            }
            document.ReportForm.keystr12.value = " "
            document.ReportForm.keystr13.value = " "
            document.ReportForm.keystr14.value = " "
            document.ReportForm.keystr15.value = " "
            document.ReportForm.keystr16.value = " "
            if (SubmitPage) {
                SubmitReport(document.ReportForm)
                return;
            }
        }
    }
}
}

// 2 - Outpatient & Single Department/sites

if ((document.ReportForm.keystr01.value == 1) ||
    ((document.ReportForm.keystr01.value == 2) &&
        (document.ReportForm.tbinvopt.value != 1))) {
    i = document.ReportForm.patopt.selectedIndex
    ind = trim(document.ReportForm.patopt.options[i].value.substr(3, 1));
    hosid = (document.ReportForm.ibcnmhos.value);
    if (ind == 2) {
        if (document.getElementById('outpat').value != 1) {
            document.ReportForm.keystr02.value = document.ReportForm.patopt.value;
            document.ReportForm.keystr03.value =
                document.getElementById('outpat').value;
            document.ReportForm.keystr04.value =
                document.getElementById('outcode').value;
            document.ReportForm.keystr05.value = document.ReportForm.getyear.value;
            if (hosid == 1) {
                // hosid=1
                document.ReportForm.keystr06.value =
                    document.getElementById('hospid').value;
                if (document.ReportForm.exportfl.value == "Y") {
                    document.ReportForm.keystr07.value = "Y"
                } else {
                    document.ReportForm.keystr07.value = "N"
                }
                if (document.ReportForm.keystr01.value == 2) {
                    // keystr01 =2
                    if (document.getElementById('ptcnuabf').value == "1") {
                        if (pdesc.checked) {
                            document.ReportForm.keystr08.value = "Y"
                        } else {
                            document.ReportForm.keystr08.value = "N"
                        }
                        document.ReportForm.keystr09.value =
                            document.getElementById('inclbook').value;
                        if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                            document.ReportForm.keystr10.value = "Y"
                            document.ReportForm.keystr11.value =
                                document.getElementById('trantype').value
                            document.ReportForm.keystr12.value = ffindate
                            document.ReportForm.keystr13.value = tfindate
                        } else {
                            document.ReportForm.keystr10.value = "N"
                            document.ReportForm.keystr11.value = " "
                            document.ReportForm.keystr12.value = " "
                            document.ReportForm.keystr13.value = " "
                        }
                    } else {
                        if (pdesc.checked) {
                            document.ReportForm.keystr08.value = "Y"
                        } else {
                            document.ReportForm.keystr08.value = "N"
                        }
                        if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                            document.ReportForm.keystr09.value = "Y"
                            document.ReportForm.keystr10.value =
                                document.getElementById('trantype').value
                            document.ReportForm.keystr11.value = ffindate
                            document.ReportForm.keystr12.value = tfindate
                        } else {
                            document.ReportForm.keystr09.value = "N"
                            document.ReportForm.keystr10.value = " "
                            document.ReportForm.keystr11.value = " "
                            document.ReportForm.keystr12.value = " "
                        }
                    }

                } else {
                    // keystr01<>2
                    if (document.getElementById('ptcnuabf').value == "1") {
                        document.ReportForm.keystr08.value = "N"
                        document.ReportForm.keystr09.value =
                            document.getElementById('inclbook').value;
                    }
                }
            } else {
                // hosid <> 1
                if (document.ReportForm.exportfl.value == "Y") {
                    document.ReportForm.keystr06.value = "Y"
                } else {
                    document.ReportForm.keystr06.value = "N"
                }

                if (document.ReportForm.keystr01.value == 2) {
                    // keystr01 =2
                    if (document.getElementById('ptcnuabf').value == "1") {
                        if (pdesc.checked) {
                            document.ReportForm.keystr07.value = "Y"
                        } else {
                            document.ReportForm.keystr07.value = "N"
                        }
                        document.ReportForm.keystr08.value =
                            document.getElementById('inclbook').value;
                        if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                            document.ReportForm.keystr09.value = "Y"
                            document.ReportForm.keystr10.value =
                                document.getElementById('trantype').value
                            document.ReportForm.keystr11.value = ffindate
                            document.ReportForm.keystr12.value = tfindate
                        } else {
                            document.ReportForm.keystr09.value = "N"
                            document.ReportForm.keystr10.value = " "
                            document.ReportForm.keystr11.value = " "
                            document.ReportForm.keystr12.value = " "
                        }
                    } else {
                        if (pdesc.checked) {
                            document.ReportForm.keystr07.value = "Y"
                        } else {
                            document.ReportForm.keystr07.value = "N"
                        }
                        if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                            document.ReportForm.keystr08.value = "Y"
                            document.ReportForm.keystr09.value =
                                document.getElementById('trantype').value
                            document.ReportForm.keystr10.value = ffindate
                            document.ReportForm.keystr11.value = tfindate
                        } else {
                            document.ReportForm.keystr08.value = "N"
                            document.ReportForm.keystr09.value = " "
                            document.ReportForm.keystr10.value = " "
                            document.ReportForm.keystr11.value = " "
                        }
                    }
                    document.ReportForm.keystr12.value = " "
                } else {
                    // keystr<> 2
                    if (document.getElementById('ptcnuabf').value == "1") {
                        document.ReportForm.keystr07.value = "N"
                        document.ReportForm.keystr08.value =
                            document.getElementById('inclbook').value;
                    }
                }
            }
            document.ReportForm.keystr13.value = " "
            document.ReportForm.keystr14.value = " "
            document.ReportForm.keystr15.value = " "
            document.ReportForm.keystr16.value = " "
            if (SubmitPage) {
                SubmitReport(document.ReportForm)
                return;
            }
        }
    }
}

// 3 - Not Outpatient

if ((document.ReportForm.keystr01.value == 1) ||
    ((document.ReportForm.keystr01.value == 2) &&
        (document.ReportForm.tbinvopt.value != 1))) {
    i = document.ReportForm.patopt.selectedIndex
    ind = trim(document.ReportForm.patopt.options[i].value.substr(3, 1));
    hosid = (document.ReportForm.ibcnmhos.value);
    if (ind != 2) {
        document.ReportForm.keystr02.value = document.ReportForm.patopt.value
        document.ReportForm.keystr03.value = document.ReportForm.getyear.value
        if (hosid == 1) {
            // hosid=1
            document.ReportForm.keystr04.value =
                document.getElementById('hospid').value;
            if (document.ReportForm.exportfl.value == "Y") {
                document.ReportForm.keystr05.value = "Y"
            } else {
                document.ReportForm.keystr05.value = "N"
            }
            if (document.ReportForm.keystr01.value == 2) {

                // keystr01=2
                if ((ind == 0) && (document.getElementById('ptcnuabf').value == "1")) {
                    if (pdesc.checked) {
                        document.ReportForm.keystr06.value = "Y"
                    } else {
                        document.ReportForm.keystr06.value = "N"
                    }
                    document.ReportForm.keystr07.value =
                        document.getElementById('inclbook').value;
                    if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                        document.ReportForm.keystr08.value = "Y"
                        document.ReportForm.keystr09.value =
                            document.getElementById('trantype').value
                        document.ReportForm.keystr10.value = ffindate
                        document.ReportForm.keystr11.value = tfindate
                    } else {
                        document.ReportForm.keystr08.value = "N"
                        document.ReportForm.keystr09.value = " "
                        document.ReportForm.keystr10.value = " "
                        document.ReportForm.keystr11.value = " "
                    }
                } else {
                    if (pdesc.checked) {
                        document.ReportForm.keystr06.value = "Y"
                    } else {
                        document.ReportForm.keystr06.value = "N"
                    }
                    if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                        document.ReportForm.keystr07.value = "Y"
                        document.ReportForm.keystr08.value =
                            document.getElementById('trantype').value
                        document.ReportForm.keystr09.value = ffindate
                        document.ReportForm.keystr10.value = tfindate
                    } else {
                        document.ReportForm.keystr07.value = "N"
                        document.ReportForm.keystr08.value = " "
                        document.ReportForm.keystr09.value = " "
                        document.ReportForm.keystr10.value = " "
                    }
                }
            }
        } else {
            if (document.ReportForm.exportfl.value == "Y") {
                document.ReportForm.keystr04.value = "Y"
            } else { 
                document.ReportForm.keystr04.value = "N"
            }
            if (document.ReportForm.keystr01.value == 2) {
                if ((ind == 0) && (document.getElementById('ptcnuabf').value == "1")) {
                    if (pdesc.checked) {
                        document.ReportForm.keystr05.value = "Y"
                    } else {
                        document.ReportForm.keystr05.value = "N"
                    }
                    document.ReportForm.keystr06.value =
                        document.getElementById('inclbook').value;
                    if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                        document.ReportForm.keystr07.value = "Y"
                        document.ReportForm.keystr08.value =
                            document.getElementById('trantype').value
                        document.ReportForm.keystr09.value = ffindate
                        document.ReportForm.keystr10.value = tfindate
                    } else {
                        document.ReportForm.keystr07.value = "N"
                        document.ReportForm.keystr08.value = " "
                        document.ReportForm.keystr09.value = " "
                        document.ReportForm.keystr10.value = " "
                    }
                } else {
                    if (pdesc.checked) {
                        document.ReportForm.keystr05.value = "Y"
                    } else {
                        document.ReportForm.keystr05.value = "N"
                    }
                    if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                        document.ReportForm.keystr06.value = "Y"
                        document.ReportForm.keystr07.value =
                            document.getElementById('trantype').value
                        document.ReportForm.keystr08.value = ffindate
                        document.ReportForm.keystr09.value = tfindate
                    } else {
                        document.ReportForm.keystr06.value = "N"
                        document.ReportForm.keystr07.value = " "
                        document.ReportForm.keystr08.value = " "
                        document.ReportForm.keystr09.value = " "
                    }
                }
            }
        }
        document.ReportForm.keystr11.value = " "
        document.ReportForm.keystr12.value = " "
        document.ReportForm.keystr13.value = " "
        document.ReportForm.keystr14.value = " "
        document.ReportForm.keystr15.value = " "
        document.ReportForm.keystr16.value = " "
        if (SubmitPage) {
            SubmitReport(document.ReportForm)
            return;
        }
    }
}

// 4 - Outpatient - all Department - with tobe invoiced

if ((document.ReportForm.keystr01.value == 2) &&
    (document.ReportForm.tbinvopt.value == 1)) {
    i = document.ReportForm.patopt.selectedIndex
    ind = trim(document.ReportForm.patopt.options[i].value.substr(3, 1));
    hosid = (document.ReportForm.ibcnmhos.value);
    if (ind == 2) {
        if (document.getElementById('outpat').value == 1) {
            document.ReportForm.keystr02.value = document.ReportForm.patopt.value;
            document.ReportForm.keystr03.value =
                document.getElementById('outpat').value;
            document.ReportForm.keystr04.value = document.ReportForm.getyear.value;
            if (hosid == 1) {
                // hosid =1
                document.ReportForm.keystr05.value =
                    document.getElementById('hospid').value
                document.ReportForm.keystr06.value =
                    document.getElementById('transfees').value
                if (document.ReportForm.exportfl.value == "Y") {
                    document.ReportForm.keystr07.value = "Y"
                } else {
                    document.ReportForm.keystr07.value = "N"
                }
                if (document.getElementById('ptcnuabf').value == "1") {
                    if (pdesc.checked) {
                        document.ReportForm.keystr08.value = "Y"
                    } else {
                        document.ReportForm.keystr08.value = "N"
                    }
                    document.ReportForm.keystr09.value =
                        document.getElementById('inclbook').value;
                    if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                        document.ReportForm.keystr10.value = "Y"
                        document.ReportForm.keystr11.value =
                            document.getElementById('trantype').value
                        document.ReportForm.keystr12.value = ffindate
                        document.ReportForm.keystr13.value = tfindate
                    } else {
                        document.ReportForm.keystr10.value = "N"
                        document.ReportForm.keystr11.value = " "
                        document.ReportForm.keystr12.value = " "
                        document.ReportForm.keystr13.value = " "
                    }
                } else {
                    if (pdesc.checked) {
                        document.ReportForm.keystr08.value = "Y"
                    } else {
                        document.ReportForm.keystr08.value = "N"
                    }
                    if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                        document.ReportForm.keystr09.value = "Y"
                        document.ReportForm.keystr10.value =
                            document.getElementById('trantype').value
                        document.ReportForm.keystr11.value = ffindate
                        document.ReportForm.keystr12.value = tfindate
                    } else {
                        document.ReportForm.keystr09.value = "N"
                        document.ReportForm.keystr10.value = " "
                        document.ReportForm.keystr11.value = " "
                        document.ReportForm.keystr12.value = " "
                    }
                    document.ReportForm.keystr13.value = " "
                }
                // hosid<>1
            } else {
                document.ReportForm.keystr05.value =
                    document.getElementById('transfees').value;
                if (document.ReportForm.exportfl.value == "Y") {
                    document.ReportForm.keystr06.value = "Y"
                } else {
                    document.ReportForm.keystr06.value = "N"
                }

                if (document.getElementById('ptcnuabf').value == "1") {
                    if (pdesc.checked) {
                        document.ReportForm.keystr07.value = "Y"
                    } else {
                        document.ReportForm.keystr07.value = "N"
                    }
                    document.ReportForm.keystr08.value =
                        document.getElementById('inclbook').value;
                    if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                        document.ReportForm.keystr09.value = "Y"
                        document.ReportForm.keystr10.value =
                            document.getElementById('trantype').value
                        document.ReportForm.keystr11.value = ffindate
                        document.ReportForm.keystr12.value = tfindate
                    } else {
                        document.ReportForm.keystr09.value = "N"
                        document.ReportForm.keystr10.value = " "
                        document.ReportForm.keystr11.value = " "
                        document.ReportForm.keystr12.value = " "
                    }
                } else {
                    if (pdesc.checked) {
                        document.ReportForm.keystr07.value = "Y"
                    } else {
                        document.ReportForm.keystr07.value = "N"
                    }
                    if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                        document.ReportForm.keystr08.value = "Y"
                        document.ReportForm.keystr09.value =
                            document.getElementById('trantype').value
                        document.ReportForm.keystr10.value = ffindate
                        document.ReportForm.keystr11.value = tfindate
                    } else {
                        document.ReportForm.keystr08.value = "N"
                        document.ReportForm.keystr09.value = " "
                        document.ReportForm.keystr10.value = " "
                        document.ReportForm.keystr11.value = " "
                    }
                }
                document.ReportForm.keystr12.value = " "
            }

            document.ReportForm.keystr13.value = " "
            document.ReportForm.keystr14.value = " "
            document.ReportForm.keystr15.value = " "
            document.ReportForm.keystr16.value = " "
            if (SubmitPage) {
                SubmitReport(document.ReportForm)
                return;
            }
        }
    }
}

//5 - Outpatient & Single Department/sites with tobe inv.

if ((document.ReportForm.keystr01.value == 2) &&
    (document.ReportForm.tbinvopt.value == 1)) {
    i = document.ReportForm.patopt.selectedIndex
    ind = trim(document.ReportForm.patopt.options[i].value.substr(3, 1));
    hosid = (document.ReportForm.ibcnmhos.value);
    if (ind == 2) {
        if (document.getElementById('outpat').value != 1) {
            document.ReportForm.keystr02.value = document.ReportForm.patopt.value;
            document.ReportForm.keystr03.value =
                document.getElementById('outpat').value;
            document.ReportForm.keystr04.value =
                document.getElementById('outcode').value;
            document.ReportForm.keystr05.value = document.ReportForm.getyear.value;
            if (hosid == 1) {
                // hosid=1
                document.ReportForm.keystr06.value =
                    document.getElementById('hospid').value;
                document.ReportForm.keystr07.value =
                    document.getElementById('transfees').value
                if (document.ReportForm.exportfl.value == "Y") {
                    document.ReportForm.keystr08.value = "Y"
                } else {
                    document.ReportForm.keystr08.value = "N"
                }
                if (document.getElementById('ptcnuabf').value == "1") {
                    if (pdesc.checked) {
                        document.ReportForm.keystr09.value = "Y"
                    } else {
                        document.ReportForm.keystr09.value = "N"
                    }
                    document.ReportForm.keystr10.value =
                        document.getElementById('inclbook').value;
                    if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                        document.ReportForm.keystr11.value = "Y"
                        document.ReportForm.keystr12.value =
                            document.getElementById('trantype').value
                        document.ReportForm.keystr13.value = ffindate
                        document.ReportForm.keystr14.value = tfindate
                    } else {
                        document.ReportForm.keystr11.value = "N"
                        document.ReportForm.keystr12.value = " "
                        document.ReportForm.keystr13.value = " "
                        document.ReportForm.keystr14.value = " "
                    }
                } else {
                    if (pdesc.checked) {
                        document.ReportForm.keystr09.value = "Y"
                    } else {
                        document.ReportForm.keystr09.value = "N"
                    }
                    if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                        document.ReportForm.keystr10.value = "Y"
                        document.ReportForm.keystr11.value =
                            document.getElementById('trantype').value
                        document.ReportForm.keystr12.value = ffindate
                        document.ReportForm.keystr13.value = tfindate
                    } else {
                        document.ReportForm.keystr10.value = "N"
                        document.ReportForm.keystr11.value = " "
                        document.ReportForm.keystr12.value = " "
                        document.ReportForm.keystr13.value = " "
                    }
                }
            } else {
                // hosid<>1
                document.ReportForm.keystr06.value =
                    document.getElementById('transfees').value;
                if (document.ReportForm.exportfl.value == "Y") {
                    document.ReportForm.keystr07.value = "Y"
                } else {
                    document.ReportForm.keystr07.value = "N"
                }
                if (document.getElementById('ptcnuabf').value == "1") {
                    if (pdesc.checked) {
                        document.ReportForm.keystr08.value = "Y"
                    } else {
                        document.ReportForm.keystr08.value = "N"
                    }
                    document.ReportForm.keystr09.value =
                        document.getElementById('inclbook').value;
                    if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                        document.ReportForm.keystr10.value = "Y"
                        document.ReportForm.keystr11.value =
                            document.getElementById('trantype').value
                        document.ReportForm.keystr12.value = ffindate
                        document.ReportForm.keystr13.value = tfindate
                    } else {
                        document.ReportForm.keystr10.value = "N"
                        document.ReportForm.keystr11.value = " "
                        document.ReportForm.keystr12.value = " "
                        document.ReportForm.keystr13.value = " "
                    }
                } else {
                    if (pdesc.checked) {
                        document.ReportForm.keystr08.value = "Y"
                    } else {
                        document.ReportForm.keystr08.value = "N"
                    }
                    if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                        document.ReportForm.keystr09.value = "Y"
                        document.ReportForm.keystr10.value =
                            document.getElementById('trantype').value
                        document.ReportForm.keystr11.value = ffindate
                        document.ReportForm.keystr12.value = tfindate
                    } else {
                        document.ReportForm.keystr09.value = "N"
                        document.ReportForm.keystr10.value = " "
                        document.ReportForm.keystr11.value = " "
                        document.ReportForm.keystr12.value = " "
                    }
                }
            }
            document.ReportForm.keystr14.value = " "
            document.ReportForm.keystr15.value = " "
            if (SubmitPage) {
                SubmitReport(document.ReportForm)
                return;
            }
        }
    }
}

//6 - Not outpatient with tobe invoiced

if ((document.ReportForm.keystr01.value == 2) &&
    (document.ReportForm.tbinvopt.value == 1)) {
    i = document.ReportForm.patopt.selectedIndex
    ind = trim(document.ReportForm.patopt.options[i].value.substr(3, 1));
    hosid = (document.ReportForm.ibcnmhos.value);
    if (ind != 2) {
        document.ReportForm.keystr02.value = document.ReportForm.patopt.value
        document.ReportForm.keystr03.value = document.ReportForm.getyear.value
        if (hosid == 1) {
            // hosid =1
            document.ReportForm.keystr04.value =
                document.getElementById('hospid').value;
            document.ReportForm.keystr05.value =
                document.getElementById('transfees').value;
            if (document.ReportForm.exportfl.value == "Y") {
                document.ReportForm.keystr06.value = "Y"
            } else {
                document.ReportForm.keystr06.value = "N"
            }
            if ((ind == 0) && (document.getElementById('ptcnuabf').value == "1")) {
                if (pdesc.checked) {
                    document.ReportForm.keystr07.value = "Y"
                } else {
                    document.ReportForm.keystr07.value = "N"
                }
                document.ReportForm.keystr08.value =
                    document.getElementById('inclbook').value;
                if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                    document.ReportForm.keystr09.value = "Y"
                    document.ReportForm.keystr10.value =
                        document.getElementById('trantype').value
                    document.ReportForm.keystr11.value = ffindate
                    document.ReportForm.keystr12.value = tfindate
                } else {
                    document.ReportForm.keystr09.value = "N"
                    document.ReportForm.keystr10.value = " "
                    document.ReportForm.keystr11.value = " "
                    document.ReportForm.keystr12.value = " "
                }
            } else {
                if (pdesc.checked) {
                    document.ReportForm.keystr07.value = "Y"
                } else {
                    document.ReportForm.keystr07.value = "N"
                }
                if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                    document.ReportForm.keystr08.value = "Y"
                    document.ReportForm.keystr09.value =
                        document.getElementById('trantype').value
                    document.ReportForm.keystr10.value = ffindate
                    document.ReportForm.keystr11.value = tfindate
                } else {
                    document.ReportForm.keystr08.value = "N"
                    document.ReportForm.keystr09.value = " "
                    document.ReportForm.keystr10.value = " "
                    document.ReportForm.keystr11.value = " "
                }
            }
        } else {
            // hosid <>1
            document.ReportForm.keystr04.value =
                document.getElementById('transfees').value;
            if (document.ReportForm.exportfl.value == "Y") {
                document.ReportForm.keystr05.value = "Y"
            } else {
                document.ReportForm.keystr05.value = "N"
            }
            if ((ind == 0) && (document.getElementById('ptcnuabf').value == "1")) {
                if (pdesc.checked) {
                    document.ReportForm.keystr06.value = "Y"
                } else {
                    document.ReportForm.keystr06.value = "N"
                }
                document.ReportForm.keystr07.value =
                    document.getElementById('inclbook').value;
                if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                    document.ReportForm.keystr08.value = "Y"
                    document.ReportForm.keystr09.value =
                        document.getElementById('trantype').value
                    document.ReportForm.keystr10.value = ffindate
                    document.ReportForm.keystr11.value = tfindate
                } else {
                    document.ReportForm.keystr08.value = "N"
                    document.ReportForm.keystr09.value = " "
                    document.ReportForm.keystr10.value = " "
                    document.ReportForm.keystr11.value = " "
                }
            } else {
                if (pdesc.checked) {
                    document.ReportForm.keystr06.value = "Y"
                } else {
                    document.ReportForm.keystr06.value = "N"
                }
                if ((p.d_menufl.value == '1') && (chkRun.checked == true)) {
                    document.ReportForm.keystr07.value = "Y"
                    document.ReportForm.keystr08.value =
                        document.getElementById('trantype').value
                    document.ReportForm.keystr09.value = ffindate
                    document.ReportForm.keystr10.value = tfindate
                } else {
                    document.ReportForm.keystr07.value = "N"
                    document.ReportForm.keystr08.value = " "
                    document.ReportForm.keystr09.value = " "
                    document.ReportForm.keystr10.value = " "
                }
            }
            document.ReportForm.keystr11.value = " "
        }
        document.ReportForm.keystr12.value = " "
        document.ReportForm.keystr13.value = " "
        document.ReportForm.keystr14.value = " "
        document.ReportForm.keystr15.value = " "
        document.ReportForm.keystr16.value = " "
        if (SubmitPage) {
            SubmitReport(document.ReportForm)
            return;
        }
    }
}
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ReportLoad();Init();ReportOpat();
 document.ReportForm.schddate.focus();">

<form name=ReportForm method=post action=rshweb02.pbl style="margin:0">
  <input type=hidden name=reportno value=4>
  <input type=hidden name=template value=001>
  <input type=hidden name=ibcnmhos value="%RSHWEB02.01.118.000.043.1.1">
  <input type=hidden name=updttype value="A">
  <input type=hidden name=setdfprg value="IBABIL19">
  <input type=hidden name=setdfrep value="01">
  <input type=hidden name=schdpgid value="IBABIL19">
  <input type=hidden name=schddesc value="Fees Invoiced Report">
  <input type=hidden name=nextpage value="1">
  <input type=hidden name=period01 value="01">
  <input type=hidden name=dummy value="">
  <input type=hidden name=tbinvopt value="">
  <input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=1">
  <input type=hidden name=currdate value="%STANDARD.01.013">
  <input type=hidden name=d_menufl value="%RSHWEB02.01.020">
  <input type=hidden name=exportde value="%RSHWEB02.01.021">
  <input type=hidden name=exdescst value="">
  <input type=hidden name=d_curdat value="%STANDARD.01.015">
  <input type=hidden name=ptcnuabf id=ptcnuabf
   value="%STANDARD.01.025.128.105.0.1">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>
     Fees Invoiced Reports <span style="display: none" 
     id="exdetil">(Exp. Full Desc)</span></td></tr>
<tr><td>
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>

<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text name=schddate id=schddate size=12 
           title="Schedule Date"  value="%STANDARD.01.015"
    onblur="checkDate(this,'Schedule Date');">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Show Calendar" date="document.ReportForm.schddate">
    Time
    <input type=text name=schdtime id=schdtime size=12 
           title="Schedule Time" value="%STANDARD.01.016">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="document.ReportForm.schddate" 
               time="document.ReportForm.schdtime">
    <img notab src="../images/TimeLookup.gif" class="Icon"
     alt="Time Select" time="document.ReportForm.schdtime">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><select name=schdprnt id=schdprnt title="Printer" 
                 class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBABIL18.01
        </select>
    </td></tr>

<tr><td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy id=schdcopy 
              title='Number of Copies' class=Mandatory>
        </select>
    </td></tr>

<tr><td class=DataLabel>Re-schedule Type</td>
    <td class=DataLabel colspan=3>
    <select name=schdrdat id=schdrdat title="Schedule Type" 
                 onchange="SetReportDates();">
    <option></option>
    </select>
    </td></tr>

<tr><td class=DataLabel>Re-schedule Until Date</td>
    <td class=DataLabel colspan=3>
    <input type=text name=schdrend id=schdrend size=12
     onblur="checkDate(this,'Re-schedule Until Date');">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="document.ReportForm.schdrend">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Show Calendar" date="document.ReportForm.schdrend">
    </td></tr>

<tr><td colspan=2 align=center><hr width=80%></td></tr>
</table>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>

<tr><td class=DataLabel>Report Type</td>
    <td><select name=keystr01 id=keystr01 onchange="TranFeeOpt();FinOpt();">
        <option value=1>Print Only</option>
        <option value=2>Print and Reset</option>
        </select></td></tr>

    <input type=hidden name=keystr02 value="">
    <input type=hidden name=keystr03 value="">
    <input type=hidden name=keystr04 value="">
    <input type=hidden name=keystr05 value="">
    <input type=hidden name=keystr06 value="">
    <input type=hidden name=keystr07 value="">
    <input type=hidden name=keystr08 value="">
    <input type=hidden name=keystr09 value="">
    <input type=hidden name=keystr10 value="">
    <input type=hidden name=keystr11 value="">
    <input type=hidden name=keystr12 value="">
    <input type=hidden name=keystr13 value="">
    <input type=hidden name=keystr14 value="">
    <input type=hidden name=keystr15 value="">
    <input type=hidden name=keystr16 value="">


<tr><td class=DataLabel width=25%>Type of Report</td>
    <td><select name=patopt id=patopt title="Report Option" class=Mandatory
        onchange="ReportOpat();">
        <option value=""> </option>
        %STANDARD.01.024.RP.000.4
        </select>
</td></tr>

<tr><td class=DataLabel>Year </td>
    <td><input type=text name=getyear id=getyear size=4 maxlength=4 
               class=Mandatory  value="%RSHWEB02.01.155"
    onblur="validatePeriod(period01,getyear,dummy,dummy,dummy);">
    </td></tr>
</table>

<span id=OutpatientOption></span>
<span id=singleOutpatient></span>
<span id=HospitalID></span>
<span id=TransOption></span>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Create Export File</td>
    <td><select name=exportfl id=exportfl>
        <option value="N">No</option>
        <option value="Y">Yes</option>
        </select>
    </td></tr>
</table>

<span id=showdesc style="display:none">
  <table width=80% align=center border=0 cellspacing=2 cellpadding=1>
    <tr><td class=DataLabel width=25%>Show Description on G/L Extract</td>
        <td><input type="checkbox" name="d_exdesc" id="d_exdesc"></td></tr>
  </table>
</span>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td colspan=2 align=center><hr width=80%></td></tr>
</table>

<span id=IncBookedOPtobeInv></span>
<span id=ADT36Option></span>
<span id=SummaryOption></span>

<table width=80% align=center border=0 cellspacing=0>
<tr><td align=center colspan=2><br>
    <input type=button value=Ok class="button" onclick='ProcessReport();'>
    <input type=button value=Cancel class="button" 
     onclick='location.href="../lookups/blank.html"' >
    </td></tr>
</table>
</td></tr>
</table>
</form>

<span id=OpatRange style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Outpatient Options</td>
    <td><select name=outpat id=outpat title="Report Option" 
                onchange="singleOpat();">
        <option value="1">All Outpatient Depts</option>
        <option value="2">Single Outpatient Dept</option>
        <option value="3">Single Outpatient Site</option>
        </select></td>
    </tr>
</table>
</span>

<span id=siteCode style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Site Code</td>
    <td><select name=outcode id=outcode title="Site Code">
        <option value=""></option>
        %RSHWEB02.01.109
        </select>
        </td></tr>
</table>
</span>

<span id=deptCode style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Department Code</td>
    <td><select name=outcode id=outcode title='Department Code'> 
        <option value=""></option>
        %STANDARD.01.007.O 
        </select></td></tr>
</table>
</span>

<span id=TransFee style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>
     Transfer Fees to be Invoiced to Finance System? </td>
    <td><select name=transfees id=transfees>
        <option value="Y">Yes</option>
        <option value="N">No</option>
        </select>
    </td></tr>
</table>
</span>

<span id=RunFin style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>
     Run Financial Summary Report (IBAADT36) </td>
    <td><input type="checkbox" name=runsummary id=runsummary value="1" checked
         onclick="SummOpt();">
    </td></tr>
</table>
</span>

<span id=FinSummary style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Transaction Type</td>
    <td><select name=trantype id=trantype>
        <option value=1>All</option>
        <option value=2>Accommodation(Inpatient Only)</option>
        <option value=3>Item Charges</option>
        <option value=4>Journal</option>
        </select></td></tr>

<tr><td class=DataLabel>Date Range</td>
    <td><span id=DateRange></span></td></tr>
</table>
</span>

<span id=HospID style="display:none;">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
    <tr><td class=DataLabel width=25%>Hospital ID</td>
    <td><select name=hospid id=hospid title="Hospital ID" 
                onchange="TranFeeOpt();">
    <option value="">All</option>
    %RSHWEB02.01.122
    </select>
    </td></tr>
</table>
</span>

<span id=incbookedop style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Include Booked Outpatients in the  'To Be Invoiced' Section (Y/N) ?</td>
    <td><select name=inclbook id=inclbook 
 title="Include Booked Outpatients in the 'To Be Invoiced' Section (Y/N) ?">
        <option value="N">No</option>
        <option value="Y">Yes</option>
        </select>
    </td></tr>
</table>
</span>

<div id=SetScheduleRange style="display:none;">
    <select name=datsch01 id=datsch01 title="Schedule Range" 
     onblur="UpReportSchedule(this,document.getElementById('datran01'),document.getElementById('datran02'));">
    <option></option></select>
    Sample Range
    <input type=text name=SampleFrom id=SampleFrom size=12> To
    <input type=text name=SampleTo id=SampleTo size=12>
</div>

<div id=SetDateRange style="display:none;">
    <input type=text size=15 maxlength=12 name=datran01 id=datran01
    onblur="checkDate(this,'From Date')"
     title="From Date">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="document.ReportForm.datran01">
    To
   <input type=text size=15 maxlength=12 name=datran02 id=datran02
    value="%STANDARD.01.015" onblur="checkDate(this,'To Date')"
     title="To Date">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="document.ReportForm.datran02">
</div>

<script language=javascript>

function ReportOpat() {
  var p = document.ReportForm;

  var i = p.patopt.selectedIndex;
  var ind = trim(p.patopt.options[i].value.substr(3,1));

  if (ind == '2') {
    document.getElementById('OutpatientOption').innerHTML = 
      document.getElementById('OpatRange').innerHTML;

   if(document.getElementById('ptcnuabf').value == "1") {
    document.getElementById('IncBookedOPtobeInv').innerHTML=document.getElementById('incbookedop').innerHTML;
   } else {
     document.getElementById('IncBookedOPtobeInv').innerHTML="";
   }

  }
  else {

    if(document.getElementById('ptcnuabf').value == "1" && ind==0) {
    document.getElementById('IncBookedOPtobeInv').innerHTML=document.getElementById('incbookedop').innerHTML;

    } else {

     document.getElementById('IncBookedOPtobeInv').innerHTML="";
     document.getElementById('OutpatientOption').innerHTML="";
     document.getElementById('singleOutpatient').innerHTML="";
    }
  }

  if (p.d_menufl.value == '1') {
    var chkRun = document.getElementById('runsummary');
    if ((p.keystr01.value==2) && (chkRun.checked == true)) {
      if (p.schdrdat.value == "") {
        GetFinDate();
      }
    }
  }
}

function singleOpat() {
 var ddlFromClaim = document.getElementById('outpat');
 if (ddlFromClaim.value==1){
   document.getElementById('singleOutpatient').innerHTML=""; 
 }
 else if (ddlFromClaim.value==3){
   document.getElementById('singleOutpatient').innerHTML=document.getElementById('siteCode').innerHTML;
   document.getElementById('outcode').className = "Mandatory";
 }else{//ddlFromClaim.value==2
   document.getElementById('singleOutpatient').innerHTML=document.getElementById('deptCode').innerHTML;
   document.getElementById('outcode').className = "Mandatory";
 } 
}


    if(document.getElementById('ptcnuabf').value == "1") {
    document.getElementById('IncBookedOPtobeInv').innerHTML=document.getElementById('incbookedop').innerHTML;

    } else {
     document.getElementById('IncBookedOPtobeInv').innerHTML="";
    }
</script>
