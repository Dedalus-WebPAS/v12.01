<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="">
<meta name="CrossBrowser" content="true">
<script language="javascript" src="../js/allweb03.js"></script>
<script type="text/javascript">
function removeReferralDestination(code)
{
 DeleteForm.diagcode.value = code.replace(/ /g,"");

 if(confirm("Are you sure you want to Delete?"))
           SubmitHiddenNew(DeleteForm);
}

function sendReferralDestinationToParentFrame()
{
 var updateSACFlag = parent.document.getElementById("refrflag");

 if(updateSACFlag)
 {
   itemExistInCollection("btnReferralInDestination",REFERRALDESTINATION);
   DFrameExit();
 }
 else
   DFrameExitRefresh();
}

function itemExistInCollection(id,variable)
{
  var btn = parent.document.getElementById(id);

  if(btn)
  {
    if(variable==1)
      btn.style.color = "red";
    else
      btn.style.color = "black";
  }
}

function getDeptcodeQueryString()
{
  UpdateForm.deptcode.value = getQueryString("deptcode");
  AddForm.deptcode.value =  UpdateForm.deptcode.value;
  DeleteForm.deptcode.value =  UpdateForm.deptcode.value;
}

function addReferralDestination()
{
  if(validateMandatory(UpdateForm))
  { 
    var index = UpdateForm.diagcode.selectedIndex;

    AddForm.diagdate.value = UpdateForm.diagdate.value;
    AddForm.diagcode.value = UpdateForm.diagcode[index].value.substr(0,3);
    AddForm.diagcod2.value = UpdateForm.diagcod2.value;
    SubmitHiddenNew(AddForm);
  }
}

function valDate(obj,str)
{
 checkDate(obj,str);
}

function openEditDateFrame(code,num)
{
  var admissno = document.getElementById("admissno");
  num = num.replace(/ /g,"+");

  var linkUrl = "allweb02.pbl?reportno=03&template=013&admissno="
                +admissno.value+"&diagcode="+code
                +"&uniqcode="+num+"&referlin=1";

  displayDiagnosisPopupFrame(linkUrl);

}

function displayDiagnosisPopupFrame(linkUrl)
{
  var left = (document.body.clientWidth-780)/2;
  DFrameLink(linkUrl,25,left,400,250);
}

function PageLoadExtended(event)
{
  PageLoad(event);
  getDeptcodeQueryString();
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoadExtended(event);">
<script>
REFERRALDESTINATION="%ALLWEB02.03.616";
</script>
<span class=DFrameTitleBar>
<img border=0 align=right src=../images/ExitIcon.gif onclick="sendReferralDestinationToParentFrame();">
Referral In Service Type 
</span>
<div id=PageBodySection>
<form id=AddForm name=AddForm action="allweb02.pbl" method=post
 onsubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=009>
<input type=hidden name=updatety value="X">
<input type=hidden name=referlin value="1">
<input type=hidden name=nextpage value=0>
<input type=hidden name=redirect value="">
<input type=hidden id=admissno name=admissno value="%ALLWEB02.03.081" />
<input type=hidden name=deptcode value="" />
<input type=hidden name=diagcode value="" />
<input type=hidden name=diagcod2 value="" />
<input type=hidden name=diagdate value="" />
</form>
<form id=DeleteForm name=DeleteForm action="allweb02.pbl" method=post
 onsubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=009>
<input type=hidden name=updatety value="Y">
<input type=hidden name=referlin value="1">
<input type=hidden name=nextpage value=0>
<input type=hidden name=redirect value="">
<input type=hidden name=admissno value="%ALLWEB02.03.081" />
<input type=hidden name=deptcode value="" />
<input type=hidden name=diagcode value="" />
</form>


<form id=UpdateForm name=UpdateForm action="allweb03.pbl" method=post
 onsubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=009>
<input type=hidden name=nextpage value=0>
<input type=hidden name=redirect value="">
<input type=hidden name=urnumber value='%ALLWEB02.03.003'>
<input type=hidden name=admissno value='%ALLWEB02.03.081'>
<input type=hidden name=updatety value="A">
<input type=hidden name=deptcode value="" />
<input type="hidden" id="diagcod2" name="diagcod2">
<table align=center cellspacing=0 cellpadding=1 border=1 width=100%>
<tr>
  <td class="HeadingCell">Date</td>
  <td class="HeadingCell">Service Type</td>
  <td class="HeadingCell">&nbsp;</td>
</tr>
<tr>
  <td class="DataLabel">
    <input type="text" name="diagdate" 
           class="Mandatory PastDate" size="10"
           onblur="valDate(this,'Date');" 
           value="%STANDARD.01.015"
           title="Referral Destination Date" 
     />
    <img src=../images/DateTimeStamp.gif class=Icon 
         date=UpdateForm.diagdate
         time=null />
    <img src=../images/DateLookup.gif class=Icon 
         date="UpdateForm.diagdate" />
  </td>
  <td class="DataLabel">
    <select id="diagcode" name="diagcode" class="Mandatory" 
            title="Referral In Service Type">
    <option></option>
      %ALLWEB02.03.611.9.1.01.2.O
    </select>
  </td>
  <td class="DataLabel">
    <input type="button" id=btnAdd class="button" value="Add" 
           onclick="tempDisable(this); addReferralDestination();"/>
    <input type="button" class="button" value="Ok" 
           onclick="tempDisable(this); sendReferralDestinationToParentFrame()"/>
  </td>
</tr>
</table>
<br />
<div style="height:300px;overflow:auto;">
<table id="referralDestinationTable" border="1" cellspacing="0" width="99%">
<tr><td class="HeadingCell" width="50">Remove</td>
<td class="HeadingCell" width="25">Edit</td>
<td class="HeadingCell" width="50">Code</td>
<td class="HeadingCell">Service Type</td>
<td class="HeadingCell">Date</td>
</tr>
      %ALLWEB02.03.617
</table>
</div>
</form>
</div>
