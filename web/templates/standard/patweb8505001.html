<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language=javascript src=../js/TableSort.js></script>
<script language=javascript>
function UpdateFilled(CheckBox){
  if(document.SelectPeriod.mrcnureq.value=="1") {
    if(CheckBox.checked==true) {
       return;
     } 
  } 
  UpdateSeque=1
  UpdateValue=0
  if (CheckBox.checked) {
     eval("can"+CheckBox.name.substr(3,4)).checked=false
     eval("prc"+CheckBox.name.substr(3,4)).checked=false
     UpdateValue=1 }
  var serverURL   = "../cgi-bin/patweb85.pbl?reportno=3" +
                    "&mrtrecky=" + CheckBox.value.replace(/ /g,"+") +
                    "&checkbox=" + UpdateValue +
                    "&sequence=" + UpdateSeque
  var returnValue = RSExecute(serverURL);
  if (returnValue.status!=0) {
    ReturnCode.select();  }
}
function UpdateCancel(CheckBox){
  UpdateSeque=2
  UpdateValue=0
  if (CheckBox.checked) {
     eval("fil"+CheckBox.name.substr(3,4)).checked=false
     eval("prc"+CheckBox.name.substr(3,4)).checked=false
     UpdateValue=1 }
  var serverURL   = "../cgi-bin/patweb85.pbl?reportno=3" +
                    "&mrtrecky=" + CheckBox.value.replace(/ /g,"+") +
                    "&checkbox=" + UpdateValue +
                    "&sequence=" + UpdateSeque
  var returnValue = RSExecute(serverURL);
  if (returnValue.status!=0) {
    ReturnCode.select();  }
}
function UpdateProgrs(CheckBox){
  UpdateSeque=3
  UpdateValue=0
  if (CheckBox.checked) {
     eval("can"+CheckBox.name.substr(3,4)).checked=false
     eval("fil"+CheckBox.name.substr(3,4)).checked=false
     UpdateValue=1 }
  var serverURL   = "../cgi-bin/patweb85.pbl?reportno=3" +
                    "&mrtrecky=" + CheckBox.value.replace(/ /g,"+") +
                    "&checkbox=" + UpdateValue +
                    "&sequence=" + UpdateSeque
  var returnValue = RSExecute(serverURL);
  if (returnValue.status!=0) {
    ReturnCode.select();  }
}
function UpdateHeader(mrtkey,urno){
  SelectPeriod.reportno.value=2
  SelectPeriod.template.value=2
  SelectPeriod.mrtrecky.value=mrtkey
  SelectPeriod.urnumber.value=urno
  Left=(document.body.clientWidth-450)/2
  DFrameSubmit(SelectPeriod,100,Left,450,350)
}
function returnPrevious() {
if (document.SelectPeriod.viewtype.value==2) {
 linkurl="patweb85.pbl?reportno=2&template=003&" +                   
        "&viewtype=" + document.SelectPeriod.viewtype.value.replace(/ /g,"+") +
        "&vyearmth=" + document.SelectPeriod.vyearmth.value.replace(/ /g,"+") +
        "&filledrc=" + document.SelectPeriod.filledrc.value.replace(/ /g,"+") +
        "&superlev=" + document.SelectPeriod.superlev.value.replace(/ /g,"+")
 }                                                                             
else {
 linkurl="patweb85.pbl?reportno=2&template=003" +                              
        "&viewtype=" + document.SelectPeriod.viewtype.value.replace(/ /g,"+") +
        "&lastdate=" + document.SelectPeriod.lastdate.value.replace(/ /g,"+") +
        "&filledrc=" + document.SelectPeriod.filledrc.value.replace(/ /g,"+") +
        "&superlev=" + document.SelectPeriod.superlev.value.replace(/ /g,"+")
 }
 
  if (document.SelectPeriod.alldckie.value=="1") {
    linkurl=linkurl + "&alldflag=1"; 
  }

 linkurl+="&showflag=1" + 
          "&docutype=" + 
          document.SelectPeriod.docutype.value.replace(/ /g,"+") +
          "&filthosp=" +
          document.SelectPeriod.filthosp.value.replace(/ /g,"+") +
          "&filtlocn=" + 
          document.SelectPeriod.filtlocn.value.replace(/ /g,"+") +
          "&filthhos=" + 
          document.SelectPeriod.filthhos.value.replace(/ /g,"+");
 location.href=linkurl
}
function CheckBulkMove() {
 if(document.SelectPeriod.mrcnureq.value=="1") {
   for(var e = 0; e < document.all.length; e++) {
     if(document.all[e].name!=undefined) {
       var el=document.all[e] ;
       if(el.name.match(/fil/) && el.type=="checkbox") {
         if(el.checked==true && el.defaultChecked==false) {
            BulkMove();
            return;
         }
       }
     }
   }
 } 
 document.SelectPeriod.submit();
}
function BulkMove() {
  linkUrl="mrtweb01.pbl?reportno=09&template=007" +
          "&requestn=" + SelectPeriod.requestn.value.replace(/ /g,"+") +
          "&superlev=" + SelectPeriod.superlev.value.replace(/ /g,"+")
  Left=(document.body.clientWidth-700)/2
  DFrameLink(linkUrl,100,Left,800,550)
}
// ------------------------------------------------------------
// Columns Available
//  0 - HTML Link    
//  1 - Request No  
//  2 - UR          
//  3 - Date/Time           
//  4 - Movement Reasion Description
//  5 - Current Location
//  6 - Destination    
//  7 - Volume Number 
//  8 - Filled Status
//  9 - Process    
// 10 - Filled           
// 11 - Cancel           
// 12 - Movement Reason Code      
// 13 - Patient Name     
// ------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 document.title="Bulk Request Reservation Fill List For Request No : " +
                document.SelectPeriod.requestn.value;
 t = new Table(1,0,1,"100%","center");
 t.addColumn("UR No.","String",2,8,"left","MaintenanceIcon.gif","0",90)
// t.addColumn("UR No.","String",2,8,"center","","",50)
 t.addColumn("Patient Name","ImageText",14,14,"left","PatientFolder","17",170,16)
// t.addColumn("Date/Time","DateTime",3,3,"","","",98)
 t.addColumn("Reason","String",13,13,"left","","",45)
 t.addColumn("Destination","String",6,6,"","","",55)
 t.addColumn("Held by","String",9,9,"","","",55)
 t.addColumn("Current Location","String",5,5,"left","","",150,"","","",19)
 t.addColumn("Document Type","String",20,20,"","","",50)
//
 if(parseInt(SelectPeriod.mrcntday.value,10)>0) {
 t.addColumn("Outstanding Requests","String",18,18,"left","","",200,"","","",19)
 }
//
 t.addColumn("Vol.","String",7,7,"center","","",25)
 t.addColumn("Status","String",21,21,"center","","",60)
 t.addColumn("Process","String",10,10,"center","","",47)
 t.addColumn("Filled","String",11,11,"center","","",35)
 t.addColumn("Cancel","String",12,12,"center","","",40)
 AddTableRows()
 TableOutput(0,1);    // Order Column,Asc Dsc
 break;
 }
 }
}
function getalldflagCOOKIE() {
  if (GetCookieData("alldflagCOOKIE") != "unknown") {
    ExpireCookiePath("alldflagCOOKIE");
    document.SelectPeriod.alldckie.value="1"; 
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);getalldflagCOOKIE();">
<div id=HeadingSection>
<form name=SelectPeriod action=patweb85.pbl method=get style="margin:0">
<input type=hidden name=reportno value=5>
<input type=hidden name=template value=1>
<input type=hidden name=viewtype value="%PATWEB85.05.210">
<input type=hidden name=vyearmth value="%PATWEB85.05.225">
<input type=hidden name=lastdate value="%PATWEB85.05.226">
<input type=hidden name=mrtrecky>
<input type=hidden name=urnumber>
<input type=hidden name=requestn value="%PATWEB85.05.001">
<input type=hidden name=mrcnureq value="%STANDARD.01.025.097.164.0.1">
<input type=hidden name=mrcntday value="%STANDARD.01.025.097.170.0.2">
<input type=hidden name=superlev value="%PATWEB85.05.135">
<input type=hidden name=alldckie value="">
<input type=hidden name=docutype value="%PATWEB85.05.123.1">
<input type=hidden name=filthosp value="%PATWEB85.05.134.0">
<input type=hidden name=filtlocn value="%PATWEB85.05.134.3">
<input type=hidden name=filthhos value="%PATWEB85.05.144">

<table cellpadding=1 cellspacing=1 bgcolor=#CCCCCC border=1 width=100%>
<tr><td>
<table cellpadding=1 cellspacing=1 bgcolor=#CCCCCC border=0 width=100%>
<tr><td>Filled<br>
   <select name=filledrc id=filledrc onchange='this.form.submit()'>
    %PATWEB85.05.220
   </select></td>
   <td align=center><br><input type=button value="Return to Request Summary" 
      onclick="returnPrevious();"></td>
   <td align=right><br><input type=button value="Move" 
      onclick="CheckBulkMove();"></td>
</tr>
</table>
</td></tr>
</table>
</form>
</div>
<div id=TableLocation></div>

<script language="Javascript">
function AddTableRows() {
%PATWEB85.05.011
}
</script>
