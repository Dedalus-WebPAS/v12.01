<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"      content="true">
<script type="text/javascript" src="../js/rcpweb03.js"></script>
<script type="text/javascript">
function init() {
  showPayments(UpdateForm);
  if (UpdateForm.rcpbt023.value.substr(3,1)==6) {
    if(UpdateForm.eftpostp.value=="1") {
      document.UpdateForm.rcpbt016[0].checked=1;
      document.UpdateForm.rcpbt013.value="";
      document.UpdateForm.rcpbt013.disabled=true;
      document.UpdateForm.rcpbt013.className="Readonly";
    } else {
      document.UpdateForm.rcpbt016[1].checked=1;
      document.UpdateForm.rcpbt013.disabled=false;
      document.UpdateForm.rcpbt013.className="Mandatory";
      checkctype();
      checkEFTType(document.UpdateForm.rcpbt013,
                   document.UpdateForm.rcpbt007,
                   document.UpdateForm.rcpercent,
                   document.UpdateForm.crtotpay,
                   document.UpdateForm.crsurchr);
    }
  } else {
    if (UpdateForm.rcpbt023.value.substr(3,1)==7) {
      checkCARDType(document.UpdateForm.rcpbt013,document.UpdateForm.rcpbt007);
    }
 }
  setTimeout('document.UpdateForm.rcpbt007.select();',250);
  setTimeout('document.UpdateForm.rcpbt007.focus();',250);
}
function checkctype() {
  if ((document.UpdateForm.eftpostp.value=="2") && (document.UpdateForm.cardtype.value!=0)) {
    SurchargeOption.innerHTML=CreditSurcharge.innerHTML;
  } else {
    SurchargeOption.innerHTML=""; 
  }                
}

function checkCARDType(ReturnCode,ReturnAmnt) {
    var serverURL   = "../cgi-bin/rcpweb03.pbl?reportno=1"
                    + "&valdtype=1"
                    + "&valdcode=" + document.UpdateForm.rcpbt023.value.substr(0,3).replace(/ /g,"+")
                    + "&tpayamnt=" + ReturnAmnt.value.replace(/ /g,"+")

    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|");

     if (ReturnValue[0]!=0) {
         document.UpdateForm.rcpercent.value=ReturnValue[0];
         document.UpdateForm.crsurchr.value=ReturnValue[1];
         document.UpdateForm.crtotpay.value=ReturnValue[2];
     }
   }
}

function checkEFTType(ReturnCode,ReturnAmnt,Percent,TotPayment,Surchrg) {
  if (UpdateForm.rcpbt016[0].checked==1) {
    document.UpdateForm.rcpbt013.value="";
    SurchargeOption.innerHTML="";
    return;
  }

  if ((UpdateForm.rcpbt016[1].checked==1) &&
      (!isWhitespace(ReturnCode.value)))
   {
    var serverURL   = "../cgi-bin/rcpweb03.pbl?reportno=1" +
                   "&valdcode=" + ReturnCode.value.replace(/ /g,"+") +
                   "&tpayamnt=" + ReturnAmnt.value.replace(/ /g,"+")

    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|");

     if (ReturnValue[0]!=0) {
       if (UpdateForm.drwercrd.value==0) {
//         Percent.value=ReturnValue[0];
//         Surchrg.value=ReturnValue[1];
//         TotPayment.value=ReturnValue[2];

         if ((SurchargeOption.innerHTML=="") ||
             ((document.UpdateForm.d_rcpbt013.value) ==
              (document.UpdateForm.rcpbt013.value.substr(0,3)))) {
               SurchargeOption.innerHTML=CreditSurcharge.innerHTML;
         }

            document.UpdateForm.rcpercent.value=ReturnValue[0];
            document.UpdateForm.crsurchr.value=ReturnValue[1];
            document.UpdateForm.crtotpay.value=ReturnValue[2];

         return;
       }
     }
   }
  }
  SurchargeOption.innerHTML="";
  document.UpdateForm.d_rcpbt013.value="";
}

function valCrCard(ReturnCode,ReturnAmnt,Percent,TotPayment,Surchrg) {

 if (document.UpdateForm.rcpbt023.value.substr(3,1)==7) {
   var serverURL   = "../cgi-bin/rcpweb03.pbl?reportno=1"
                    + "&valdtype=1"
                    + "&valdcode=" + document.UpdateForm.rcpbt023.value.substr(0,3).replace(/ /g,"+")
                    + "&tpayamnt=" + ReturnAmnt.value.replace(/ /g,"+");
 } else {

  if (ReturnCode == undefined) {return;}
  if (isWhitespace(ReturnCode.value)) {
    return;;
  }

  var serverURL   = "../cgi-bin/rcpweb03.pbl?reportno=1" +
                 "&valdcode=" + ReturnCode.value.replace(/ /g,"+") +
                 "&tpayamnt=" + ReturnAmnt.value.replace(/ /g,"+")
 }

  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    if (ReturnValue[2]==0) {
      return;
    }
    Percent.value=ReturnValue[0];
    Surchrg.value=ReturnValue[1];
    TotPayment.value=ReturnValue[2];
  }
}
</script>
</head>
%START.OF.PAGE
</HEAD>
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
<script type="text/javascript">

  paydesc = "%RCPWEB03.02.387.0";
  if(!isWhitespace(paydesc)){
    document.write('Payment Type: %RCPWEB03.02.387.0');
  } else {
    document.write(self.document.title);
  }

</script>
</span>
<form name=UpdateForm method=post action=rcpweb03.pbl style="margin:0">
<table align=center width=95% border=0 cellspacing=2 cellpadding=1>
<tr><td>
 <input type=hidden name=reportno value="2">
 <input type=hidden name=template value="003">
 <input type=hidden name=updttype value="U">
 <input type=hidden name=nextpage value="4">
 <input type=hidden name=redirect value="rcpweb03.pbl?reportno=02&template=001">
 <input type=hidden name=accmtotl value="%RCPWEB03.02.306">
 <input type=hidden name=rcpbk001 value="%RCPWEB03.02.001"> <!--receipt no-->
 <input type=hidden name=rcpbk002 value="%RCPWEB03.02.002"> <!--payment date-->
 <input type=hidden name=rcpbk003 value="%RCPWEB03.02.003"> <!--total amount-->
 <input type=hidden name=rcpbk004 value="%RCPWEB03.02.004.0"> <!--drawer-->
 <input type=hidden name=rcpbk007 value="%RCPWEB03.02.007"> <!--recd frm type-->
 <input type=hidden name=rcpbk008 value="%RCPWEB03.02.008"> <!--recd frm code-->
 <input type=hidden name=rcpbk014 value="%RCPWEB03.02.014"> <!--chq acc no-->
 <input type=hidden name=rcpbt003 value="%RCPWEB03.02.103"> <!--unique no-->
<input type=hidden name=rcpbt023 value="%RCPWEB03.02.123.3"> <!--payment Type-->
 <input type=hidden name=eftpostp value="%RCPWEB03.02.116"> <!--eftpos type-->
 <input type=hidden name=cardtype value="%RCPWEB03.02.380"> <!--card type-->
 <input type=hidden name=d_rcpbt013 value="%RCPWEB03.02.307.1">
 <input type=hidden name=printflg value="%RCPWEB03.02.336">
 <input type=hidden name=selprint value="%RCPWEB03.02.337">
 <input type=hidden name=nocopies value="%RCPWEB03.02.338">
 <input type=hidden name=drwercrd value="%RCPWEB03.02.381">
 <input type=hidden name=surchamt value="%RCPWEB03.02.388">

<table align=center width=95% border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=30%>Payment Amount</td>
    <td><input type=text name=rcpbt007 title="Payment Amount" size=15
               maxlength=15 class="Mandatory Number" max=999999999999.99
               value="%RCPWEB03.02.107"
               onchange="RoundNumber(this,2);
               valCrCard(document.UpdateForm.rcpbt013,
                         document.UpdateForm.rcpbt007,
                         document.UpdateForm.rcpercent,
                         document.UpdateForm.crtotpay,
                         document.UpdateForm.crsurchr);">
    </td></tr>

</table>

<span id=PaymentOption></span>
<span id=SurchargeOption></span>
<span id=PayerOption></span>

<table align=center width=95% border=0 cellspacing=2 cellpadding=1>
<tr><td colspan=2 align=center><br>
    <input type=button value="Update" class="button" 
     name=updtbutt id=updtbutt onclick="tempDisable(this);setFormactn('U')">
    <input type=button value="Delete" class="button" 
     name=delebutt id=delebutt onclick="tempDisable(this);setFormactn('D')">
    <input type=button value=Close class="button" 
     name=closbutt id=closbutt onclick="tempDisable(this);DFrameClose()">
</td></tr>
</table>
</td></tr>
</table>
</form>


<span id=CashPayment style="display:none">
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr valign=top><td class=DataLabel width=30%>Payer</td>
    <td><input type=text name=rcpbt008 class=Mandatory title="Payer"
         value="%RCPWEB03.02.108" size=50 maxlength=50>
</td></tr>
</table>
</span>

<span id=ChequePayment style="display:none">
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=30%>Cheque Number</td>
    <td><input type=text name=rcpbt009 class=Mandatory title="Cheque Number"
         value="%RCPWEB03.02.109"
         size=15 maxlength=12>
</td></tr>
<tr><td class=DataLabel>Drawer</td>
    <td><input type=text name=rcpbt010 class=Mandatory title="Drawer"
         value="%RCPWEB03.02.110"
         size=50 maxlength=50>
</td></tr>
<tr><td class=DataLabel>Bank</td>
    <td><input type=text name=rcpbt011 class=Mandatory title="Bank"
         value="%RCPWEB03.02.111"
         size=35 maxlength=30>
</td></tr>
<tr><td class=DataLabel>Branch</td>
    <td><input type=text name=rcpbt012 class=Mandatory title="Branch"
         value="%RCPWEB03.02.112"
         size=35 maxlength=30>
</td></tr>
</table>
</span>

<span id=CreditPayment style="display:none">
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=30%>Card Type</td>
    <td><select name=rcpbt013 class=Mandatory title="Card Type">
        <option value=""></option>
        %RCPWEB03.02.307.9.1.02.0
        </select>
</td></tr>
<tr><td class=DataLabel>Payer</td>
    <td><input type=text name=rcpbt008 class=Mandatory title="Payer"
         value="%RCPWEB03.02.108"
         size=50 maxlength=50>
</td></tr>
</table>
</span>

<span id=DirDepositPayment style="display:none">
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr valign=top><td class=DataLabel width=30%>Payer</td>
    <td><input type=text name=rcpbt008 class=Mandatory title="Payer"
         value="%RCPWEB03.02.108" size=50 maxlength=50>
</td></tr>
<tr><td class=DataLabel width=30%>Statement Reference</td>
    <td><input type=text name=rcpbt014 class=Mandatory 
         value="%RCPWEB03.02.114"
               title="Statement Reference" size=40 maxlength=40>
</td></tr>
</table>
</span>

<span id=MoneyOrderPayment style="display:none">
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=30%>Money Order Number</td>
    <td><input type=text name=rcpbt009 class=Mandatory 
         value="%RCPWEB03.02.109"
         title="Money Order Number" size=15 maxlength=12>
</td></tr>
</table>
</span>

<span id=EFTPOSPayment style="display:none">
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=30%>EFT Type</td>
   <td>Chq/Savings
   <input type=radio name=rcpbt016 value="1" notab tabindex=-1 
          onclick="checkCard(UpdateForm);
                   checkEFTType(document.UpdateForm.rcpbt013,
                                document.UpdateForm.rcpbt007,
                                document.UpdateForm.rcpercent,
                                document.UpdateForm.crtotpay,
                                document.UpdateForm.crsurchr);">
    &nbsp;&nbsp;&nbsp;Credit
   <input type=radio name=rcpbt016 value="2" notab tabindex=-1
          onclick="checkCard(UpdateForm);
                   checkEFTType(document.UpdateForm.rcpbt013,
                                document.UpdateForm.rcpbt007,
                                document.UpdateForm.rcpercent,
                                document.UpdateForm.crtotpay,
                                document.UpdateForm.crsurchr);"></td>
</tr>

<tr valign=top><td class=DataLabel>Card Type</td>
    <td><select name=rcpbt013 class=Mandatory title="Card Type"
      onchange="checkEFTType(document.UpdateForm.rcpbt013,
                             document.UpdateForm.rcpbt007,
                             document.UpdateForm.rcpercent,
                             document.UpdateForm.crtotpay,
                             document.UpdateForm.crsurchr);">
        <option value=""></option>
        %RCPWEB03.02.307.9.1.02.1.E
        </select>
</td></tr>
</table>
</span>

<span id=CreditSurcharge style="display:none">
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=50%>% Surcharge</td>
    <td><input type=text name=rcpercent size=15
        class="Readonly JustifyRight" readonly
        title='Percentage Surcharge' tabindex=-1></td></tr>
<tr><td>Plus Surcharge</td>
    <td><input type=text name=crsurchr size=15 class=readonly readonly
         title='Surcharge' tabindex=-1></td></tr>
<tr><td>Total Payment amount will be </td>
    <td><input type=text name=crtotpay size=15 class=readonly readonly
         title='Total Payment Amount' tabindex=-1></td></tr>
</table>
</span>

<span id=EFTPOSPayer style="display:none">
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel>Payer</td>
    <td><input type=text name=rcpbt008 class=Mandatory title="Payer"
         value="%RCPWEB03.02.108"
         size=50 maxlength=50>
</td></tr>
<tr><td class=DataLabel>Reference</td>
    <td><input type=text name=rcpbt014  
         value="%RCPWEB03.02.114"
         title="Reference" size=40 maxlength=40>
</td></tr>
</table>
</span>

<span id=CARDPayer style="display:none">
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
  <tr>
    <td class=DataLabel width=30%>Payer</td>
    <td>
      <input type=text name=rcpbt008 class=Mandatory title="Payer"
       value="%RCPWEB03.02.108"
         size=50 maxlength=50>
    </td>
  </tr>
  <tr>
    <td class=DataLabel width=30%>Reference</td>
    <td>
      <input type=text name=rcpbt014
       value="%RCPWEB03.02.114"
       title="Reference" size=40 maxlength=40>
    </td>
  </tr>
</table>
</span>

