<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language=javascript src="../js/TableSort.js"></script>
<script type="text/javascript" src="../js/outweb0808.js"></script>
<script language="Javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//---------------------------------------------------------------------------
function InitTable(TableView) {
var multiHospParam = document.AddRequest.ibcnmhos.value;
document.title="Requested Appointments";
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",35,45);
 t.addColumn("Date","DateTime",1,11,"left","AppointmentIcon.gif","0",140)
 t.addColumn("Department Requested","String",2,2,"left","","",50)
 t.addColumn("Request Reason","String",3,3,"left","","",50)
 t.addColumn("Requested By","String",4,4,"left","","",40)
 if ( multiHospParam.replace(/ /g,"")  == "1" ) {
   t.addColumn("Preferred Hospital","String",5,5,"left","","",50)
 }
 t.addColumn("Clinic Type","String",6,6,"left","","",60)
 t.addColumn("Clinic Id","String",7,7,"left","","",60)
 t.addColumn("Visit Type","String",8,8,"left","","",50)
 t.addColumn("Status","String",10,10,"left","","",70)
 AddTableRows()
 TableOutput(0,1);    // By Date Order Column,Asc Dsc
 break; }
 }
}
function UpdateRequest(ur,ref,date,time) {
  linkurl="../cgi-bin/outweb08.pbl?reportno=08&template=003" +
          "&urnumber=" + ur.replace(/ /g,"+") +
          "&admissno=" + ref.replace(/ /g,"+") +
          "&otart001=" + ur.replace(/ /g,"+") +
          "&otart002=" + ref.replace(/ /g,"+") +
          "&otart003=" + date.replace(/ /g,"+") +
          "&otart004=" + time.replace(/ /g,"+");
  Left=(document.body.clientWidth-850)/2;
  DFrameLink(linkurl,50,Left,850,550);
}
function AppointLink(CaseKeys) {
 CASEKEYS=CaseKeys.replace(/ /g,"+");
 location.href="outweb02.pbl?reportno=3&template=1&casekeys="+CASEKEYS;
}
function ShowAddRequest() {
  if(!isWhitespace(document.PatientLinks.popupapp.value)) {
    PatientLinkTo("outweb08.pbl",08,2,1,850,550);
     return;
  }
  if(!isWhitespace(document.PatientLinks.popupreq.value)) {
    PatientLinkTo("outweb08.pbl",08,3,1,850,550);
     return;
  }
}
function RequestApptCheck() {
  //alert to deny Request Appts when referal closed
  if(document.AddRequest.d_alrestat.value == "2") {
    alert("This referral was closed on " +
    document.AddRequest.d_alredclo.value);
    return;
  }
  //alert to deny Request Appts when referal inactive
  if(document.AddRequest.d_alrestat.value == "3") {
    alert("This referral was made inactive on " +
    document.AddRequest.d_alredina.value);
    return;
  }
  //alert to deny Request Appts when referal cancelled
  if(document.AddRequest.d_alrestat.value == "4") {
    alert("This referral was cancelled on " +
    document.AddRequest.d_alredcan.value);
    return;
  }
  //alert to deny Request Appts when referal rejected
  if(document.AddRequest.d_alrestat.value == "5") {
    alert("This referral was rejected on " +
    document.AddRequest.d_alresrdt.value);
    return;
  }
  PatientLinkTo('outweb08.pbl',08,2,1,900,550);
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);ShowAddRequest();">
<div id="HeadingSection">
<div id="PageHeadingSection">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OUTWEB08.08.003";
PatientVIS="%OUTWEB08.08.081";
PatientNAM="%OUTWEB08.08.002";
PatientSTA="%OUTWEB08.08.086.078";
PatientALT="%OUTWEB08.08.084";
PatientSEX="%OUTWEB08.08.019";
PatientDOB="%OUTWEB08.08.020";
PatientAGE="%OUTWEB08.08.021";
PatientLOC="%OUTWEB08.08.083";
PatientPRI="%OUTWEB08.08.086.066.1";
PatientUNT="%OUTWEB08.08.066.0";
DoctorCOD="%OUTWEB08.08.082.003";
DoctorNAM="%OUTWEB08.08.082.002";
PatientAID="%OUTWEB08.08.086.090";
PatientIND="%OUTWEB08.08.086.091";
PatientCUR="%OUTWEB08.08.086.092";
PatientCLC="%OUTWEB08.08.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OUTWEB08.08.086.094";
PatientCDM="%OUTWEB08.08.086.095";
PatientVDH="%OUTWEB08.08.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
</div>

<table width=100% cellspacing=0 cellpadding=1 border=0>
<tr><td class=HeadingCell align=center>
    %OUTWEB08.08.125.0   Referral Details
    </td></tr>
</table>
<table width=98% align=center cellspacing=0 cellpadding=1 border=0>

<tr><td class=DataLabel>Referral Date</td>
    <td class=DataField>  %OUTWEB08.08.119   </td>
    <td class=DataLabel>Referral Source</td> 
    <td class=DataField> %OUTWEB08.08.134.0    </td></tr>
<tr><td class=DataLabel>Referred By</td>
    <td class=DataField> %OUTWEB08.08.122.0   </td>
    <td class=DataLabel>Problem</td>
    <td class=DataField>  %OUTWEB08.08.128.0   </td></tr>
</table>

<table width=100% border=1 cellspacing=0 cellpadding=1>
<tr>
    <td bgcolor=#cccccc align=left width=20%>

    <input type=button class="button" value="Action List" 
     title="Return to appointment action list" 
     onclick="GoActionList();">

    <input type=button class="bigbutton" value="OP Appointment" 
     title="Return to outpatient appointment" 
     onclick="GoAppointment();">

    <td bgcolor=#cccccc align=right>
    <input type=button class="button" value="Referral" 
      title="Return to referral"
     onclick="PatientLinkTo('allweb02.pbl',2,2,0,0,0);">
    <input type=button class="button" value="Request Appt"
      title="Add appointment request"
     onclick="RequestApptCheck();">
    </td></tr>
</table>

<form name=AddRequest method=get action=outweb08.pbl style="margin:0">
<input type=hidden name=reportno value=8>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%OUTWEB08.08.003">
<input type=hidden name=admissno value="%OUTWEB08.08.081">
<input type=hidden name=showflag value="1">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=d_alredclo value="%OUTWEB08.08.107">
<input type=hidden name=d_alredcan value="%OUTWEB08.08.111">
<input type=hidden name=d_alredina value="%OUTWEB08.08.115">
<input type=hidden name=d_alresrdt value="%OUTWEB08.08.198">
<input type=hidden name=d_alrestat value="%OUTWEB08.08.199.027">

<table width=100% border=1 cellspacing=0 cellpadding=1>
<tr><td class=HeadingCell align=left >Status
    <select class=PMenuSelectList name=filtstat
     onchange="document.AddRequest.submit();">
    <option value=" ">All</option>
    <option value="0">Requested</option>
    <option value="1">Pending Reschedule</option>
    <option value="2">Booked</option>
    <option value="3">Cancelled</option>
    </select>
    &nbsp;&nbsp;&nbsp;&nbsp;Include Suspended Appointments&nbsp;&nbsp;
    <input type=checkbox name=inclsusp value="1" 
     onclick="document.AddRequest.submit();">
    </td>
    </tr>
</table>
</form>
</div>

<div id=TableLocation></div>
<script language="Javascript">
function AddTableRows() {
%OUTWEB08.08.301
%OUTWEB08.08.303
}
</script>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=01>
<input type=hidden name=template value=002>
<input type=hidden name=urnumber value="%OUTWEB08.08.003">
<input type=hidden name=admissno value="%OUTWEB08.08.081">
<input type=hidden name=popupapp value="%OUTWEB08.08.320">
<input type=hidden name=popupreq value="%OUTWEB08.08.321">
</form>

<script type="text/javascript">
 StatusFilter="%OUTWEB08.08.302";
 for (var i =0 ; i < document.AddRequest.filtstat.length; i++) {
  if (document.AddRequest.filtstat.options[i].value==StatusFilter.substr(0,1)) {
       document.AddRequest.filtstat.selectedIndex=i } };
//
 IncSuspended="%OUTWEB08.08.304";
 if(IncSuspended=="1") {
   document.AddRequest.inclsusp.checked=true;
 }
</script>
