<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript" src=../js/hosweb0101.js></script>
<script type="text/javascript">

function samedate(){
ReportForm.Keystr06.value=ReportForm.Keystr05.value;
}

function datemsg(){
if(checkDate(document.ReportForm.Keystr05,'Starting Theatre Date'))
samedate();
}

function ProcessDate(){
  var today=new Date();
  var tomorrow=new Date();
  OneDaySeconds = 86400000
  todayseconds = today.getTime();
  tomorrowseconds = Math.floor(todayseconds + OneDaySeconds);
  tomorrow.setTime(tomorrowseconds);
  day=tomorrow.getDate();
  if(day<10) {
    day="0" + day
  }
  mon="";
  if(tomorrow.getMonth()=="0") mon="Jan"
  if(tomorrow.getMonth()=="1") mon="Feb"
  if(tomorrow.getMonth()=="2") mon="Mar"
  if(tomorrow.getMonth()=="3") mon="Apr"
  if(tomorrow.getMonth()=="4") mon="May"
  if(tomorrow.getMonth()=="5") mon="Jun"
  if(tomorrow.getMonth()=="6") mon="Jul"
  if(tomorrow.getMonth()=="7") mon="Aug"
  if(tomorrow.getMonth()=="8") mon="Sep"
  if(tomorrow.getMonth()=="9") mon="Oct"
  if(tomorrow.getMonth()=="10") mon="Nov"
  if(tomorrow.getMonth()=="11") mon="Dec"
  year=tomorrow.getFullYear();
  tomorrowdate = day + " " + mon + " " + year
  document.ReportForm.Keystr05.value=tomorrowdate
  document.ReportForm.Keystr06.value=tomorrowdate
}

function ProcessReport() {
if(document.ReportForm.schdrdat.value=="") {
if(document.ReportForm.Keystr05.value==""){
ProcessDate();
}
if(ReportForm.ibcnmhos.value=="1"){
if(document.ReportForm.Keystr01.value=="2"){
document.ReportForm.keystr01.value=ReportForm.hospital.value;
document.ReportForm.keystr02.value=2;
document.ReportForm.keystr03.title=Date;
document.ReportForm.keystr04.title=Date;
document.ReportForm.keystr03.value=document.ReportForm.Keystr05.value;
document.ReportForm.keystr04.value=document.ReportForm.Keystr06.value;
document.ReportForm.keystr05.value="Y";
document.ReportForm.keystr06.value="";
document.ReportForm.keystr07.value="";
}
if((document.ReportForm.Keystr01.value=="1")||
(document.ReportForm.Keystr01.value=="3")){
document.ReportForm.keystr01.value=ReportForm.hospital.value;
document.ReportForm.keystr02.value=document.ReportForm.Keystr01.value;
document.ReportForm.keystr06.title=Date;
document.ReportForm.keystr07.title=Date;
document.ReportForm.keystr03.value=document.ReportForm.Keystr02.value;
document.ReportForm.keystr04.value=document.ReportForm.Keystr03.value;
document.ReportForm.keystr05.value=document.ReportForm.Keystr04.value;
document.ReportForm.keystr06.value=document.ReportForm.Keystr05.value;
document.ReportForm.keystr07.value=document.ReportForm.Keystr06.value;
document.ReportForm.keystr08.value=document.ReportForm.Keystr07.value;
document.ReportForm.keystr09.value=document.ReportForm.Keystr08.value;
document.ReportForm.keystr10.value=document.ReportForm.Keystr09.value;
document.ReportForm.keystr11.value="P";
document.ReportForm.keystr12.value="";
document.ReportForm.keystr13.value="";
}
}else{
if(document.ReportForm.Keystr01.value=="2"){
document.ReportForm.keystr01.value=2;
document.ReportForm.keystr02.title=Date;
document.ReportForm.keystr03.title=Date;
document.ReportForm.keystr02.value=document.ReportForm.Keystr05.value;
document.ReportForm.keystr03.value=document.ReportForm.Keystr06.value;
document.ReportForm.keystr04.value="Y";
document.ReportForm.keystr05.value="";
document.ReportForm.keystr06.value="";
}
if((document.ReportForm.Keystr01.value=="1")||
(document.ReportForm.Keystr01.value=="3")){
document.ReportForm.keystr01.value=ReportForm.Keystr01.value;
document.ReportForm.keystr05.title=Date;
document.ReportForm.keystr06.title=Date;
document.ReportForm.keystr02.value=document.ReportForm.Keystr02.value;
document.ReportForm.keystr03.value=document.ReportForm.Keystr03.value;
document.ReportForm.keystr04.value=document.ReportForm.Keystr04.value;
document.ReportForm.keystr05.value=document.ReportForm.Keystr05.value;
document.ReportForm.keystr06.value=document.ReportForm.Keystr06.value;
document.ReportForm.keystr07.value=document.ReportForm.Keystr07.value;
document.ReportForm.keystr08.value=document.ReportForm.Keystr08.value;
document.ReportForm.keystr09.value=document.ReportForm.Keystr09.value;
}}
   SubmitReport(ReportForm) 
}
else {
if(document.ReportForm.ibcnmhos.value=="1"){
if(document.ReportForm.Keystr01.value=="2"){
document.ReportForm.keystr01.value=ReportForm.hospital.value;
document.ReportForm.keystr02.value=2;
document.ReportForm.keystr03.title=Date;
document.ReportForm.keystr04.title=Date;
document.ReportForm.keystr03.value=document.ReportForm.SampleFrom.value;
document.ReportForm.keystr04.value=document.ReportForm.SampleTo.value;
document.ReportForm.keystr05.value="Y";
document.ReportForm.keystr06.value="";
document.ReportForm.keystr07.value="";
}
if((document.ReportForm.Keystr01.value=="1")||
(document.ReportForm.Keystr01.value=="3")){
document.ReportForm.keystr01.value=ReportForm.hospital.value;
document.ReportForm.keystr02.value=ReportForm.Keystr01.value;
document.ReportForm.keystr03.value=ReportForm.Keystr02.value;
document.ReportForm.keystr06.title=Date;
document.ReportForm.keystr07.title=Date;
document.ReportForm.keystr04.value=document.ReportForm.Keystr03.value;
document.ReportForm.keystr05.value=document.ReportForm.Keystr04.value;
document.ReportForm.keystr06.value=document.ReportForm.SampleFrom.value;
document.ReportForm.keystr07.value=document.ReportForm.SampleTo.value;
document.ReportForm.keystr08.value=document.ReportForm.Keystr07.value;
document.ReportForm.keystr09.value=document.ReportForm.Keystr08.value;
document.ReportForm.keystr10.value=document.ReportForm.Keystr09.value;
document.ReportForm.keystr11.value="P";
document.ReportForm.keystr12.value="";
document.ReportForm.keystr13.value="";
}
}else{
if(document.ReportForm.Keystr01.value=="2"){
document.ReportForm.keystr01.value=2;
document.ReportForm.keystr02.title=Date;
document.ReportForm.keystr03.title=Date;
document.ReportForm.keystr02.value=document.ReportForm.SampleFrom.value;
document.ReportForm.keystr03.value=document.ReportForm.SampleTo.value;
document.ReportForm.keystr04.value="Y";
document.ReportForm.keystr05.value="";
document.ReportForm.keystr06.value="";
}
if((document.ReportForm.Keystr01.value=="1")||
(document.ReportForm.Keystr01.value=="3")){
document.ReportForm.keystr01.value=ReportForm.Keystr01.value;
document.ReportForm.keystr05.title=Date;
document.ReportForm.keystr06.title=Date;
document.ReportForm.keystr02.value=document.ReportForm.Keystr02.value;
document.ReportForm.keystr03.value=document.ReportForm.Keystr03.value;
document.ReportForm.keystr04.value=document.ReportForm.Keystr04.value;
document.ReportForm.keystr05.value=document.ReportForm.SampleFrom.value;
document.ReportForm.keystr06.value=document.ReportForm.SampleTo.value;
document.ReportForm.keystr07.value=document.ReportForm.Keystr07.value;
document.ReportForm.keystr08.value=document.ReportForm.Keystr08.value;
document.ReportForm.keystr09.value=document.ReportForm.Keystr09.value;
}}
   SubmitReport(ReportForm) 
}
}

function loadfunc(){
if(document.ReportForm.Keystr01.value==2){
document.getElementById('Keystr02').style.display="none";
document.getElementById('VacantText').innerHTML="";
document.getElementById('Keystr03').style.display="none";
document.getElementById('CancelText').innerHTML="";
document.getElementById('Keystr04').style.display="none";
document.getElementById('PrintText').innerHTML="";
document.getElementById('Keystr07').style.display="none";
document.getElementById('StartTheatre').innerHTML="";
document.getElementById('Keystr08').style.display="none";
document.getElementById('EndTheatre').innerHTML="";
document.getElementById('Keystr09').style.display="none";
document.getElementById('n_Keystr09').style.display="none";
document.getElementById('NightAnas').innerHTML="";
document.getElementById('ImgText').style.display="none";
}
else{
document.getElementById('Keystr02').style.display="inline";
document.getElementById('VacantText').innerHTML="Do you want to include vacant sessions";
document.getElementById('Keystr03').style.display="inline";
document.getElementById('CancelText').innerHTML="Do you want to include cancelled sessions";
document.getElementById('Keystr04').style.display="inline";
document.getElementById('PrintText').innerHTML="Print each period on a separate page";
document.getElementById('Keystr07').style.display="inline";
document.getElementById('StartTheatre').innerHTML="Starting Theatre";
document.getElementById('Keystr08').style.display="inline";
document.getElementById('EndTheatre').innerHTML="Ending Theatre";
document.getElementById('Keystr09').style.display="inline";
document.getElementById('n_Keystr09').style.display="inline";
document.getElementById('NightAnas').innerHTML="Night Anaesthetist";
document.getElementById('ImgText').style.display="inline";
}
}

function ChkDteRange(FromInput,ToInput) {
  if (SetDateYYYYMMDD(FromInput.value) > SetDateYYYYMMDD(ToInput.value)) {
    alert("Invalid Range Entered ");
    ToInput.focus();
    return false }
  else {
    return true }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);
              ReportLoad();
              ProcessDate();
              document.ReportForm.schddate.focus();">
<form name=ReportForm method=post action=rshweb02.pbl style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=001>
<input type=hidden name=updttype value="A">
<input type=hidden name=setdfprg value="IBAOPR54">
<input type=hidden name=setdfrep value="01">
<input type=hidden name=schdpgid value="IBAOPR54">
<input type=hidden name=schddesc value="Daily Theatre List">    
<input type=hidden name=ibcnmhos value="%RSHWEB02.01.118.000.043.1.1">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=1">
<input type=hidden name=dummy1>
<input type=hidden name=keystr01 value="">
<input type=hidden name=keystr02 value="" >
<input type=hidden name=keystr03 value="" >
<input type=hidden name=keystr04 value="">
<input type=hidden name=keystr05 value="">
<input type=hidden name=keystr06 value="">
<input type=hidden name=keystr07 value="">
<input type=hidden name=keystr08 value="">
<input type=hidden name=keystr09 value="">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>
    Daily Theatre List 
    </td></tr>
<tr><td>
<table width=85% align=center border=0 cellspacing=2 cellpadding=1>

<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text name=schddate size=12 title="Schedule Date"
    value="%STANDARD.01.015"
    onblur="checkDate(this,'Schedule Date');">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schddate">
    Time
    <input type=text name=schdtime size=12 title="Schedule Time"
    value="%STANDARD.01.016">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schddate" time="ReportForm.schdtime">
    <img notab src="../images/TimeLookup.gif" class="Icon" 
     alt="Time Select" time="ReportForm.schdtime">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><select name=schdprnt title="Printer" class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBAOPR54.01
        </select>
    </td></tr>
 
<tr><td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy title='Number of Copies' class=Mandatory>
        </select>
    </td></tr>
 
<tr><td class=DataLabel>Re-schedule Type</td> 
    <td class=DataLabel colspan=3> 
    <select name=schdrdat title="Schedule Type" onchange="SetReportDates();"> 
    <option></option> 
    </select> 
    </td></tr> 

<tr><td class=DataLabel>Re-schedule Until Date</td> 
    <td class=DataLabel colspan=3> 
    <input type=text name=schdrend size=12 
     onblur="checkDate(this,'Re-schedule Until Date');"> 
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schdrend">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schdrend">
    </td></tr>

<tr><td colspan=2 align=center><hr width=85%></td></tr> 

</table>
<span id=HospitalID></span>

<table width=85% align=center border=0 cellspacing=2 cellpadding=1>

<tr><td class=DataLabel>Report Option</td>
    <td><select name=Keystr01 title="Report Option" class="Mandatory"
         onchange="loadfunc();">
       <option value="1">By Daily List plus Medical Admissions</option>
       <option value="2">By Medical Admissions Report</option>
       <option value="3">By Daily List without Medical Admissions</option>
       </select>

</td></tr>
<tr><td class=DataLabel id=VacantText style="display:inline" 
  width=25%>Do you want to include vacant sessions</td>
    <td><select name=Keystr02 id=Keystr02 style="display:inline">
        <option value="N">No</option>
        <option value="Y">Yes</option>
        </select>
</td></tr>

<tr><td class=DataLabel id=CancelText style="display:inline"
  width=25%>Do you want to include cancelled sessions</td>
    <td><select name=Keystr03 id=Keystr03 style="display:inline">
        <option value="N">No</option>
        <option value="Y">Yes</option>
        </select>
</td></tr>

<tr><td class=DataLabel id=PrintText style="display:inline"
 width=25%>Print each period on a separate page</td>
    <td><select name=Keystr04 id=Keystr04 style="display:inline">
        <option value="N">No</option>
        <option value="Y">Yes</option>
        </select>
</td></tr>

<tr><td class=DataLabel width=25%>Theatre Date
    </td>
    <td><span id=DateRange></span>
</td></tr>

<tr><td class=DataLabel id=StartTheatre style="display:inline"
 width=25%>Starting Theatre</td>
    <td><select name=Keystr07 title="Starting Theatre" id=Keystr07
 style="display:inline">
        <option value="">Start</option>
        %RSHWEB02.01.125
        </select> </td></tr>

<tr><td class=DataLabel width=25% id=EndTheatre 
style="display:inline">Ending Theatre</td>
       <td><select name=Keystr08 title="Ending Theatre"
  id=Keystr08 style="display:inline">
        <option value="">Finish</option>
        %RSHWEB02.01.125
        </select>
        </td></tr>

<tr><td class=DataLabel id=NightAnas style="display:inline"
  >Night Anaesthetist</td>
  <td><input type=text name=Keystr09 id=Keystr09 style="display:inline"
       size=8 title='Night Anaesth Code'
       onblur="validateCode(3,ReportForm.Keystr09,ReportForm.n_Keystr09);">
  <input type=text name=n_Keystr09 id=n_Keystr09 style="display:inline"
  size=30 class=Readonly readonly title='
Night Anaesth Name'>
  <img src="../images/SearchIcon.gif" class=Icon alt="Search"
   id=ImgText style="display:inline"
   onclick='DoctorSearchFrame(ReportForm.Keystr09,ReportForm.n_Keystr09);'>
    </td></tr>

  <input type=hidden name=keystr10 value="P">           
  <input type=hidden name=keystr11 value=" ">           
  <input type=hidden name=keystr12 value=" ">           
  <input type=hidden name=keystr13 value=" ">           

<tr><td align=center colspan=2><br>
    <input type=button value=Ok class=button id=btnOk
     onclick="tempDisable(this);ProcessReport();">
    <input type=button value=Cancel class=button 
     onclick='location.href="../lookups/blank.html"'>
    </td></tr>
</table>

</td></tr>
</table>
</form>

<span id=HospID style="display:none;">
<table width=85% align=center border=0 cellspacing=2 cellpadding=1>
    <tr><td class=DataLabel width=25%>Hospital ID</td>
    <td><select name=hospital class=Mandatory title="Hospital ID ">
    <option></option>
    %RSHWEB02.01.122
    </select>
    </td></tr>
</table>
</span>

<div id=SetDateRange style="display:none;">
<tr><td><input type=text size=15 maxlength=12 name=Keystr05 id=Keystr05
   style="display:inline" onblur="datemsg();"
          title="Starting Theatre Date">
         <img src="../images/DateTimeStamp.gif" class="Icon"
          alt="Current" date="ReportForm.Keystr05">
         <img src="../images/DateLookup.gif" class="Icon"
          alt="Calendar" date="ReportForm.Keystr05">
      To <input type=text size=15 maxlength=12 name=Keystr06
          onblur="checkDate(this,this.title);
                  ChkDteRange(ReportForm.Keystr05,ReportForm.Keystr06);"
          title="Ending Theatre Date">
         <img notab src="../images/DateTimeStamp.gif" class="Icon"
          alt="Current" date="ReportForm.Keystr06">
         <img notab src="../images/DateLookup.gif" class="Icon"
          alt="Calendar" date="ReportForm.Keystr06">
     </td></tr>
</div>

<div id=SetScheduleRange style="display:none;">
    <select name=datsch01 title="Date Range" class=Mandatory
    onblur="UpReportSchedule(this,ReportForm.SampleFrom,ReportForm.SampleTo);">
    <option></option></select>
    Sample Range
    <input type=text name=SampleFrom size=12> To
    <input type=text name=SampleTo size=12 >
    <input type=hidden name=Keystr10 value="">
</div>
<script language=Javascript>
if(ReportForm.ibcnmhos.value==1){
HospitalID.innerHTML=HospID.innerHTML;
}

</script>
