<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<link rel="stylesheet" href="../html/postcode.css" type="text/css">
<script type="text/javascript" src="../js/IBA_Category_C_.js"></script>
<script type="text/javascript" src="../js/IBA_Category_LA.js"></script>
<script type="text/javascript" src="../js/AutoPostCode.js"></script>
<script type="text/javascript" src="../js/patweb89.js"></script>
<script type="text/javascript" src="../js/AddressSearch.js"></script>

<script type="text/javascript">
function checkNames()
{
  var str = document.AddForm.ptmas006.value;
  document.AddForm.ptmas006.value = str.replace(/^\s+|\s+$/g,'');
  str = document.AddForm.pmpmi084.value;
  document.AddForm.pmpmi084.value = str.replace(/^\s+|\s+$/g,'');

  checkSecondName(document.AddForm.ptcnusgn,
                   document.AddForm.ptmas006,document.AddForm.pmpmi084,
                   document.AddForm.pmpmi085);

}
function clickRegisterButton() {
  if (document.getElementById('ptcnuadv').value != "1" &&
      !CheckValPostCode()) {
    return;
  }

  checkSecondName(document.AddForm.ptcnusgn,document.AddForm.ptmas006,
                  document.AddForm.pmpmi084,document.AddForm.pmpmi085);

  DisButton();
  CheckVerifiedAddr();
  SubmitHidden05(document.AddForm);
}
function DisButton() {
  AddForm.RegisterButton.disabled=true;
  setInterval('AddForm.RegisterButton.disabled=false',6000);
}
function valPostCode(){
  UpCase(AddForm.ptmas010);
  if(trim(AddForm.ptmas012.value)!="8888"){
    LookupPostCode(AddForm.ptmas010.value);
  }
}
function SubmitHidden05(theForm) {
  CheckLeadingSpace(document.AddForm.ptmas005);
  if(ans==false){return;}

  if(document.AddForm.ptmas006!=undefined){ //wa template
     CheckLeadingSpace(document.AddForm.ptmas006);
     if(ans==false){
        return;
     }
  }
  if(document.AddForm.pmpmi084!=undefined){ //non-wa template
     CheckLeadingSpace(document.AddForm.pmpmi084);
     if(ans==false){
        return;
     }
  }
  var dA = document.AddForm;
  if(!isWhitespace(dA.ptmas017)){
     checkAge(dA.ptmas017.value,dA.maxage.value);
  }
  if (validateMandatory(theForm)) {
    theForm.target="PopUpFrame"
    theForm.submit();
  }
}
function init() {
  SetPostCode05();
  InitPostCodes();
  InitAddressSearch();
}
function checkContactCorrespondence() {
  if (document.AddForm.pmpmi095.value.substring(3,4)=='E') {
     document.AddForm.pmpmi005.className="Mandatory";
  } else {
    if (document.AddForm.pmpmi096.value.substring(3,4)=='E') {
       document.AddForm.pmpmi005.className="Mandatory";
    } else {
       document.AddForm.pmpmi005.className="";
    }
  }
  if (document.AddForm.pmpmi095.value.substring(3,4)=='H') {
     document.AddForm.ptmas013.className="Mandatory";
  } else {
     document.AddForm.ptmas013.className="";
  }
  if (document.AddForm.pmpmi095.value.substring(3,4)=='M') {
     document.AddForm.ptmsx039.className="Mandatory";
  } else {
    if (document.AddForm.pmpmi095.value.substring(3,4)=='S') {
       document.AddForm.ptmsx039.className="Mandatory";
    } else {
       document.AddForm.ptmsx039.className="";
    }
  }
  if (document.AddForm.pmpmi095.value.substring(3,4)=='W') {
     document.AddForm.ptmas014.className="Mandatory";
  } else {
     document.AddForm.ptmas014.className="";
  }
}
function ShowSpan(showoption) {
  if (showoption.value=="1") {
    LanguageHD.innerHTML=LanguageHead.innerHTML
    LanguageBox.innerHTML=LanguageSel.innerHTML
    SetCategoryLA(document.AddForm.pmpmi002,"","");
  } else {
    LanguageHD.innerHTML=LanguageNoHead.innerHTML
    LanguageBox.innerHTML=LanguageNul.innerHTML
  }
}

//
// Functions called from AddressSearch.js
//
function InitAddressSearch() {
  // line1 - 'ptmas008'
  // line2 - 'ptmas009'
  // suburb - 'ptmas010'
  // state - 'ptmas011'
  // postcode - 'ptmas012'

  InitAddressSearchFields('trAddrSrch','ptmas008','ptmas009','ptmas010','ptmas011','ptmas012');
}
function ShowAddressSearch() {
  OpenAddressSearch('2',PopulateAddress,ClearSearchAddress);
}
function PopulateAddress(StreetLine, Suburb, State, Postcode) {
  LookupSuburb(Postcode);  // validate Postcode with our Lookup values
  if (SelectPC.length == 0) return;  // no match found

  LookupPostCode(Suburb);  // validate Suburb
  if (SelectPC.length == 0) return;  // no match found

  ToggleFieldReadOnly('ptmas008', true);
  ToggleFieldReadOnly('ptmas009', false);
  ToggleFieldReadOnly('ptmas010', true);
  ToggleFieldReadOnly('ptmas011', true);
  ToggleFieldReadOnly('ptmas012', true);

  SetFieldValue('ptmas008',StreetLine);
  SetFieldValue('ptmas009','');
  SetFieldValue('ptmas010',Suburb);
  SetFieldValue('ptmas011',State);
  SetFieldValue('ptmas012',Postcode);

  document.getElementById('verifiedLabl').style.display = "";
}
function ClearSearchAddress() {
  ToggleFieldReadOnly('ptmas008', false);
  ToggleFieldReadOnly('ptmas009', false);
  ToggleFieldReadOnly('ptmas010', false);
  ToggleFieldReadOnly('ptmas011', false);
  ToggleFieldReadOnly('ptmas012', false);

  SetFieldValue('ptmas008','');
  SetFieldValue('ptmas009','');
  SetFieldValue('ptmas010','');
  SetFieldValue('ptmas011','');
  SetFieldValue('ptmas012','');

  document.getElementById('verifiedLabl').style.display = "none";
}
function CheckVerifiedAddr() {
  if (document.getElementById('ptcnuadv').value == "1") {
    if (document.getElementById('verifiedLabl').style.display == "") {
      document.getElementById('pmpmi113').value = "1";  // verified address
    }
    else {
      document.getElementById('pmpmi113').value = "0";  // address not verified
    }
  }
  else {
    document.getElementById('pmpmi113').disabled = true;
  }
}
function ClearVerified() {
  if (document.getElementById('ptcnuadv').value != "1")
    return;

  document.getElementById('verifiedLabl').style.display = "none";
}
function ToggleSearchAddressFields(ReadOnly) {
  ToggleFieldReadOnly('ptmas008', ReadOnly);
  ToggleFieldReadOnly('ptmas009', ReadOnly);
  ToggleFieldReadOnly('ptmas010', ReadOnly);
  ToggleFieldReadOnly('ptmas011', ReadOnly);
  ToggleFieldReadOnly('ptmas012', ReadOnly);
}
function ToggleSearchAddress(Show) {
  ToggleSearchAddressRow('trAddrSrch', Show);
  ToggleSearchAddressFields(Show);
}
function ToggleOverseas() {
  if (document.getElementById('ptcnuadv').value == "1") {
    if (document.getElementById('oseasflg').checked) {  // Overseas address
      ToggleSearchAddress(false);  // hide 'Search Address' row
    }
    else {
      ToggleSearchAddress(true);  // show 'Search Address' row
      SetFieldValue('ptmas010','');  // Suburb
      SetFieldValue('ptmas011','');  // State
      SetFieldValue('ptmas012','');  // Post Code
    }
  }

  setAddrLine4(AddForm);

  CheckReadOnly();
}
function checkOverseas(){
  if (trim(document.AddForm.ptmas012.value)=="8888"){
    document.AddForm.oseasflg.checked=true;
  }
  else{
    document.AddForm.oseasflg.checked=false;
  }

  setAddrLine4(AddForm);

  CheckReadOnly();
}
function CheckReadOnly() {
  if (document.getElementById('ptcnuadv').value != "1") return;

  if (document.getElementById('ptmas008').readOnly) {
    // preserve 'readonly' state of address fields
    ToggleSearchAddressFields(true);  // readonly address fields
  }
}
function ToggleSearchRow() {
  if (document.getElementById('ptcnuadv').value != "1") return;

  if (trim(document.getElementById('ptmas012').value) != "8888") {
    ToggleSearchAddressRow('trAddrSrch',true);  // show 'Search Address' row
  }
  else {
    ToggleSearchAddressRow('trAddrSrch',false);  // hide 'Search Address' row
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);
turnOnSecondGivenName(document.AddForm.ptcnusgn.value,
                      document.AddForm.ptmas006,
                      document.AddForm.pmpmi084,
                      document.AddForm.pmpmi085);
displayPrefNames(document.AddForm.ptcnnmpr.value);">
<form name=AddForm action="patweb89.pbl" method=post style="margin:0"
 onsubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value="05">
<input type=hidden name=formactn value="NR">
<input type=hidden name=updttype value="">
<input type=hidden name=chckname>
<input type=hidden name=redirflg value="1">
<input type=hidden name=nextpage value="3">
<input type=hidden name=updateky value="%PATWEB89.05.700">
<input type=hidden name=redirect value="patweb15.pbl?reportno=1&template=001">
<input type=hidden name=dummy    value="">
<input type=hidden name=pmpmi076 value="">
<input type=hidden name=praflag  value="0">
<input type=hidden name=temporar value="2">
<input type=hidden name=sesskeys value="%PATWEB89.05.918">
<input type=hidden name=noofdays value="%PATWEB89.05.919">
<input type=hidden name=theaflag value="%PATWEB89.05.920">
<input type=hidden name=admissno value="%PATWEB89.05.081">
<input type=hidden name=hidsname value="%PATWEB89.05.009">
<input type=hidden name=hidgname value="%PATWEB89.05.010">
<input type=hidden name=ptcnusgn value="%STANDARD.01.025.114.219.0.1">
<input type=hidden name=otptflag value="%PATWEB89.05.942">
<input type=hidden name=ptcnnmpr value="%STANDARD.01.025.128.226.1.1">
<input type=hidden name=casekeys value="%PATWEB89.05.907">
<input type=hidden name=ptcnuadv id=ptcnuadv
 value="%STANDARD.01.025.123.247.0.1">
<input type=hidden name=pmpmi113 id=pmpmi113 value="%PATWEB89.01.899.049">

<table align=center width=100% border=1 cellspacing=0 cellpadding=0>
<tr><td class=HeadingCell colspan=6 align=center>
     Admission Request New Patient Details </td>
</tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=2>
<tr><td colspan=2>
      <div id=URField></div>
    </td>
    <td class=DataLabel>Overseas Address</td>
    <td><input type=checkbox name=oseasflg id=oseasflg tabindex=6
         onclick='ToggleOverseas();'>
    </td>
    <td class=DataLabel></td>
    <td></td>
</tr>

<tr id=trAddrSrch style="display:none">
    <td class=DataLabel></td>
    <td class=DataLabel></td>
    <td class=DataLabel nowrap>Search Address</td>
    <td><input type=text readonly size=42 tabindex="-1"
         style="cursor:pointer;text-align:center;"
         value="Click here to search for an address"
         title="Click here to search for an address"
         onclick="ShowAddressSearch();">
    </td>
</tr>

<tr><td class=DataLabel>Title</td>
    <td><select title="Patient Title"
         name=ptmas001 id=ptmas001 tabindex=2>
          <option></option>
          %STANDARD.01.029
        </select>
    </td>
    <td class=DataLabel>Address&nbsp;
      <span id=verifiedLabl style="display:none;color:red">(Verified)</span>
    </td>
    <td><input type=text size=42 maxlength=35 class=Mandatory tabindex=6
         name=ptmas008 id=ptmas008 title="Address Line 1"
         onchange="UpCase(this);ClearVerified();">
    </td>
    <td class=DataLabel>Home Phone</td>
    <td><input type=text size=23 maxlength=20 tabindex=9
         name=ptmas013 id=ptmas013 title="Home Phone Number">
    </td>
</tr>

<tr><td class=DataLabel>Surname</td>
    <td><input type=text size=42 maxlength=40 class=Mandatory tabindex=2
         name=ptmas005 id=ptmas005 value="%PATWEB89.05.009"
         title="Patient Surname" onblur="UpCase(this)">
    </td>
    <td class=DataLabel></td>
    <td><input type=text size=42 maxlength=35 tabindex=7 
         name=ptmas009 id=ptmas009 title="Address Line 2"
         onchange="UpCase(this)">
    </td>
    <td class=DataLabel>Work Phone</td>
    <td><input type=text size=23 maxlength=20 tabindex=10
         name=ptmas014 id=ptmas014 title="Work Phone Number"></td>
</tr>

<tr id=PrefSurname style="display:none">
  <td class=DataLabel>Preferred Surname</td>
  <td><input type=text size=20 maxlength=20 name=pmpmi082
       title="Preferred Surname"
       tabindex=2 onchange="UpCase(this);"></td>
  <td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td>
</tr>

<tr><td class=DataLabel id="givenNameLabel">Given Names</td>
    <td><input type=hidden name=ptmas006 id=ptmas006 title="Given Name"
         value="%PATWEB89.05.010">
        <input type=text size=42 maxlength=40 class=Mandatory tabindex=3
         name=pmpmi084 id=pmpmi084 title="First Given Name"
         value="%PATWEB89.05.010" onblur="UpCase(this)">
    </td>
    <td class=DataLabel>Suburb</td>
    <td><input type=text size=42 maxlength=35 class=Mandatory tabindex=8
         name=ptmas010 id=ptmas010 title="Suburb"
         value="%PATWEB89.05.015" onchange="valPostCode();ClearVerified();">
    </td>
    <td class=DataLabel>Mobile Phone</td>
    <td><input type=text size=23 maxlength=20 class=MobilePhone tabindex=11
         name=ptmsx039 id=ptmsx039 title="Mobile Phone Number"></td>
</tr>

<tr><td class=DataLabel id="secondGivenNameLabel">Second Given Name</td>
    <td><input type=text size=42 maxlength=40 id="secondGivenName" tabindex=4
         name=pmpmi085 id=pmpmi085 title="Second Given Name" tabindex=4
         onblur="UpCase(this);">
    </td>
    <td class=DataLabel><div id=AddressLine4H></div></td>
    <td><div id=AddressLine4></div></td>
    <td class=DataLabel>E-Mail</td>
    <td><input type=text size=23 maxlength=80 tabindex=11
         name=pmpmi005 id=pmpmi005 title="E-Mail">
    </td>
</tr>

<tr id=PrefGivenName style="display:none">
  <td class=DataLabel>Preferred Given Name</td>
  <td><input type=text size=25 maxlength=25 name=pmpmi083
       title="Preferred Given Name"
       tabindex=4 onchange="UpCase(this);"></td>
  <td>&nbsp;</td><td>&nbsp;</td>
  <td>&nbsp;</td><td>&nbsp;</td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.017.G </td>
    <td><select name=ptmas015 id=ptmas015 class=Mandatory tabindex=4
         title="%STANDARD.01.017.G " onchange="checkGenderInd(this);">
          <option></option>
          %PATWEB89.05.086.099.061.9.1.19.3.H 
        </select>
    </td>
    <td class=DataLabel>Post Code</td>
    <td><input type=text size=4 maxlength=4 class=Mandatory tabindex=8
         name=ptmas012 id=ptmas012 title="Post Code" value="%PATWEB89.05.016"
         onchange="checkOverseas();LookupSuburb(this.value);
                   ClearVerified();ToggleSearchRow();">
    </td>
    <td class=DataLabel>%STANDARD.01.035.Pn </td>
    <td><select name=pmpmi095 id=pmpmi095 class="SelectBig" tabindex=12
         title="%STANDARD.01.017.Pn"
         onchange="checkContactCorrespondence();">
        <option></option>
        %STANDARD.01.007.Pn
        </select>
    </td>
</tr>

<tr><td class=DataLabel>Date of Birth</td>
    <td><input type=text size=12 class="Mandatory PastDate" tabindex=5
         name=ptmas017 id=ptmas017 title="Date of Birth"
         value="%PATWEB89.05.020" onblur="checkDate(this,'Date of Birth');">
    </td>
    <td class=DataLabel>Interpreter Required</td>
    <td><select name=pmpmi001 id=pmpmi001 title="Interpreter Required" 
         onchange="ShowSpan(this);" class="Mandatory" tabindex=8>
          <option value="" selected> </option>
          <option value="U">Not Stated </option>
          <option value="0">No</option>
          <option value="1">Yes</option>
        </select>
    </td>
    <td class=DataLabel>%STANDARD.01.035.Pr </td>
    <td>
      <select name=pmpmi096 id=pmpmi096 class="SelectBig" tabindex=12
       title="%STANDARD.01.017.Pr" onchange="checkContactCorrespondence();">
        <option></option>
        %STANDARD.01.007.Pr
      </select>
    </td>
</tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    <td><span id=LanguageHD></span></td>
    <td><span id=LanguageBox></span></td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
</tr>
</table>

<table width=100% border=0>
<tr><td align=center>
    <input type=button value="Register" class="button" tabindex=47 
     name=RegisterButton id=RegisterButton onclick="clickRegisterButton();">
    <input type=button value="Cancel" class="button" tabindex=48
     onclick="history.go(-1)">
    </td>
</tr>
</table>

</form>

<span id=AustStateH style="display:none">
  State
</span>
<span id=AustState style="display:none">
  <input type=text size=42 maxlength=35 tabindex=8
   name=ptmas011 id=ptmas011 title="State"
   onchange="UpCase(this);ClearVerified();">
</span>

<span id=OseasCountryH style="display:none">
  Country
</span>
<span id=OseasCountry style="display:none">
  <select name=ptmas011 id=ptmas011 tabindex=8 class="Mandatory"
   title="Country Address">
    <option></option>
    %PATWEB89.05.085.060
  </select>
</span>

<span id=LanguageNoHead style="display:none;"> </span>
<span id=LanguageNul style="display:none;">
    <input type=hidden name=pmpmi002 id=pmpmi002 value="">
</span>

<span id=LanguageHead style="display:none;">
  Language
</span>
<span id=LanguageSel style="display:none;">
  <select name=pmpmi002 id=pmpmi002 class="select120 Mandatory" tabindex=8
   title="Preferred Language">
    <option></option>
  </select>
</span>
