<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language="javascript" src="../js/allweb02.js"></script>
<script type="text/javascript">
function UpdateReferral(theForm) {
  if (validateMandatory(theForm)) {

    if (theForm.alref132!=undefined) {
      if(!isWhitespace(theForm.alref039.value) &&
         !isWhitespace(theForm.alref132.value)) {
          if(SetDateYYYYMMDD(theForm.alref039.value) >
           SetDateYYYYMMDD(theForm.alref132.value)) {
            alert(theForm.alref132.title + " must be after " +
            theForm.alref039.title);
            return;
         }
      }
    }

    if (theForm.alref075.value.substr(14,1)=="1") {
      if (theForm.alref074.value.substr(14,1)=="9") {
      alert("Carer Resident Status is incompatible with Carer Availability.\n" +
            "Please select alternate Carer Resident Status value");
        return;
      }
    }
    enablePostField();
    theForm.submit(); }
}
function pageLoadExtended(event)
{
  PageLoad(event);
  validateFirstEnc();
  ShowRelationship(document.UpdateForm.alref075);
}
function validateFirstEnc()
{
  var isRejected = false;
  var alref132 = document.getElementById("alref132");

  isRejected = checkReferralStatus();

  MandatoryScreen(UpdateForm);

  if(isRejected)
    alref132.className = "Mandatory";
}

function checkReferralStatus()
{
  var reflstat = document.getElementById("reflstat");
  var tmp =  reflstat.value.replace(/ /g,"");
  var alref132 = document.getElementById("alref132");


  if(tmp == "Rejected" || tmp == "Cancelled")
  {
      return true;
  }
  return false;
}
</script>
</head>
%START.OF.PAGE
<body onload="pageLoadExtended(event);CommonProgramRef();">
<span class=DFrameTitleBar>
<img border=0 align=right src="../images/ExitIcon.gif" onclick="DFrameExit();">
 %ALLWEB02.02.125.0  Referral  </span>
<div id=PageBodySection style="overflow: auto;">
<form id=UpdateForm name=UpdateForm onsubmit='return validateMandatory(this)' 
            action="allweb02.pbl" method=post>
<input type=hidden name=reportno value="2">
<input type=hidden name=updatety value="U">
<input type=hidden name=urnumber value="%ALLWEB02.02.003">
<input type=hidden name=admissno value="%ALLWEB02.02.081">
<input type=hidden name=deptcode value="%ALLWEB02.02.125.1">
<input type=hidden name=deptlcod id=deptlcod value="%ALLWEB02.02.125.3">
<input type=hidden name=activref value="0">
<input type=hidden name=alref083 value="">
<input type=hidden name=redirect value="allweb02.pbl?reportno=2&template=3">
<input type=hidden name=dummy>
<input type=hidden name=wbsesite value="%STANDARD.01.023">
<input type=hidden name=alref028 value="" />
<input type=hidden name=alrestat value="%ALLWEB02.02.199.027" />
<input type=hidden name=refrflag  value="1">
<input type=hidden name=override value="2">
<input type=hidden name=firstenc value="%ALLWEB02.02.244">
<input type="hidden" name="d_aldeutrs" id="d_aldeutrs"
 value="%ALLWEB02.02.262.3">
<input type="hidden" name="d_alrestat" id="d_alrestat"
 value="%ALLWEB02.02.199.027">
<input type="hidden" name="d_aldeuprt" id="d_aldeuprt"
 value="%ALLWEB02.02.262.4">
<input type=hidden name=palcarpg value="1">
<input type="hidden" name="d_aldeprgs" id="d_aldeprgs"
 value="%ALLWEB02.02.262.5.3">

<table align=center cellspacing=0 cellpadding=0 border=0 width=95%>
<tr><td class=DataLabel width=15%>Department Code</td>
    <td><input type=text value="%ALLWEB02.02.125.0"
          readonly class=Readonly ></td>
    <td class=DataLabel>Entered by</td>
    <td><input type=text name=alref000 
         value="%ALLWEB02.02.163" readonly class=Readonly></td>
    </tr>

<tr><td class=DataLabel width=15%><div id="tsHeading"></div></td>
       <td><div id="tsField"></div></td>
       <td class=DataLabel><div id="tdHeading"></div></td>
       <td><div id="tdField"></div></td>
       </tr>

 <tr><td class=DataLabel><div id="prHeading"></div></td>
     <td><div id="prField"></div></td>
    <td class=DataLabel>Referral Date</td>
    <td><input type=text name=d_alref019 value="%ALLWEB02.02.119" 
         id=alref019
         title="Referral Date" readonly class=Readonly size=12></td>
    </tr>

<tr><td class=DataLabel>Referral Source</td>
    <td><select Title="Referral Source" name=alref034  tabindex=2
         class="Mandatory selectBig">
        <option></option>
         %ALLWEB02.02.134.2
        </select></td>
    <td class=DataLabel>Referred By</td>
    <td><input type=hidden id=alref022 name=alref022 
         value="%ALLWEB02.02.122.1">
        <input type=text name=n_alref022 readonly title="HCP Name" size=14
         id=n_alref022 value="%ALLWEB02.02.122.0">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(UpdateForm.alref022,UpdateForm.n_alref022,7);">
        <img src="../images/ClearIcon.gif" class=Icon
        onclick="clrFields(alref022,n_alref022);">
        </td></tr>

<tr><td class=DataLabel>Case Manager</td>
    <td><input type=text name=alref086 size=10 maxlength=10 tabindex=3
          id=alref086 value="%ALLWEB02.02.147.1" title="Case Manager"
         onblur="ValidateHCP(18,13,alref086,n_alref086);">
        <input type=text name=n_alref086 size=30 readonly title="HCP Name"
         id=n_alref086 class=Readonly value="%ALLWEB02.02.147.0">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(UpdateForm.alref086,UpdateForm.n_alref086,4);">
        </td>
    <td class=DataLabel>Referral In Received Date</td>
    <td class=DataField>
    <input type=text id=alref039 name=alref039 size=12 tabindex=30
     onblur="checkDate(this,'Date')" value="%ALLWEB02.02.139"
     class="Mandatory PastDate" title="Referral In Received Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref039
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref039>
    </td></tr>

<tr><td class=DataLabel>Responsible HCP</td>
    <td><input type=text name=alref038 size=10 maxlength=10 tabindex=4
         id=alref038 value="%ALLWEB02.02.138.1" title="Responsible HCP"
         onblur="ValidateHCP(18,13,alref038,n_alref038);" >
        <input type=text name=n_alref038 size=30 readonly title="HCP Name"
         id=n_alref038 value="%ALLWEB02.02.138.0" class=Readonly>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(UpdateForm.alref038,UpdateForm.n_alref038,4);">
        </td>
    <td class=DataLabel>Referral In First Triage Score</td>
    <td><select title="Referral In First Triage Score" name=alref192
         id="alref192" tabindex=30 class="">
        <option value=" "></option>
        </select></td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td><select title="%STANDARD.01.017.CL" name=alref035 tabindex=5
         class="SelectBig">
        <option></option>
         %ALLWEB02.02.135.9.1.10.2.X
        </select></td>
    <td class=DataLabel>VINAH Referral</td>
    <td><input type=text name=d_alref083 size=3 readonly class=Readonly
         title="VINAH Referral" value="%ALLWEB02.02.144" tabindex=-1></td>
    </tr>

<tr>
<!--<td></td>
    <td><input type="button" class="Largebutton"
         id="btnReferralInDestination" name="btnReferralInDestination"
         value="Referral In Details" 
         onclick="openReferralInDestination();"/>
    </td>-->

    <td class=DataLabel>%STANDARD.01.017.zU</td>
    <td><select title="%STANDARD.01.017.zU" name=rfdtr001 tabindex=6
         id=rfdtr001 class="Mandatory SelectBig"
    onchange="SetCurrentDateTimeNoFocus(document.UpdateForm.rfdat001,null);">
        <option></option>
         %ALLWEB02.02.517.9.1.01.2.O
        </select>
	<input type=hidden name=rfdat001 value="">
	<input type=hidden name=rfdpl001 value="">
	</td>
    <td class=DataLabel>Living Arrangement</td>
    <td><select title="Living Arrangement" name=alref077 tabindex=34
         class="SelectBig">
        <option></option>
         %ALLWEB02.02.140.38.2
        </select></td>
    </tr>

<tr><td class=DataLabel width=15%>Referral Acknowledgement Received By</td>
    <td><input type=text size=65 maxlength=60 name=alref089 tabindex=11
         value="%ALLWEB02.02.150" title="Referral Acknowledgement Received By">
    </td>
    <td class=DataLabel>Referral Acknowledged By</td>
    <td><input type=text name=n_alref135 title="Referral Acknowledged By"
         value="%ALLWEB02.02.199.006" readonly class=Readonly tabindex=-1></td>
    </tr>

<tr><td class=DataLabel>
    <span id="careplantitlespan" style="display:none">
    Care Plan Documented
    </span>
    </td>
    <td class=DataField>
    <span id="careplanfieldspan" style="display:none">
    <input type=text name=alref096 size=12 onblur="checkDate(this,'Date')"
     id=alref096 value="%ALLWEB02.02.157" class="PastDate" tabindex=12
     title="Care Plan Documented">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref096
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref096>
    </span>
    </td>
    <td class=DataLabel>Referral Acknowledged Via</td>
    <td><select title="Referral Acknowledged Via" name=alref076 tabindex=37
         class="SelectBig">
        <option></option>
         %ALLWEB02.02.140.37.2
        </select></td></tr>

<tr><td class=DataLabel>Case Team</td>
   <td><input type=text name=alref087 size=11 maxlength=11 title="Case Team"
        id=alref087 value="%ALLWEB02.02.148.1" tabindex=13
        onblur="validateCode2(7,alref087,n_alref087)">
       <input type=text id=n_alref087 name=n_alref087 size=30 readonly
        class=Readonly tabindex=-1 title="Team Description"
        value="%ALLWEB02.02.148.0">
       <img src="../images/SearchIcon.gif" class=Icon
        onclick="TeamSearchFrame(alref087,n_alref087)">
        <img src="../images/ClearIcon.gif" class=Icon
        onclick="clrFields(alref087,n_alref087);">
       </td>
    <td class=DataLabel>Carer Availability</td>
    <td><select title="Carer Availability" name=alref075 tabindex=38
         id=alref075 class="SelectBig" onchange="ShowRelationship(this);">
        <option></option>
         %ALLWEB02.02.140.36.2
        </select></td></tr>

</table>

<div id=InsertActive style="display:none;">
<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel width=15%>Activate Referral</td>
      <td><input type=checkbox name=activref tabindex=13
       title="Activate Referral" value="1">
      </td></tr>
</table>
</div>

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel width=15%>Comments</td>
    <td><input type=text size=65 maxlength=62 name=alref088 tabindex=14
         value="%ALLWEB02.02.149">
    </td>
    <td class=DataLabel><div id="CarerRelHeading"></div></td>
    <td><div id="CarerRel"></div></td>
    </tr>

<tr><td class=DataLabel>Status</td>
   <td><input type=text name=reflstat value="%ALLWEB02.02.103" tabindex=-1
          id=reflstat readonly class=Readonly ></td>
    <td class=DataLabel><div id="CarerResHeading"></div></td>
    <td><div id="CarerRes"></div></td>
    </tr>
</table>

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td colspan=4 align=center><br>
    <input type=button name=formactn value="OK" class="button" tabindex=100
     id=btnAdd onclick="tempDisable(this); UpdateReferral(UpdateForm);">
    <input type=button Value="Close" class="button" tabindex=101
     onclick="DFrameClose();">
    </td></tr>
</table>
</form>

<span id="ShowCarerRelHD" style="display:none">
%STANDARD.01.017.lE
</span>

<span id="ShowCarerRel" style="display:none">
  <select title="%STANDARD.01.017.lE" name=alref070 tabindex=39
   class="SelectBig Mandatory">
   <option></option>
   %ALLWEB02.02.140.31.2
   </select>
</span>

<span id="ShowCarerRelBlank" style="display:none">
   <input type="hidden" name="alref070" value=" ">
</span>

<span id="ShowCarerResHD" style="display:none">
%STANDARD.01.017.lI
</span>

<span id="ShowCarerRes" style="display:none">
  <select title="%STANDARD.01.017.lI" name=alref074 tabindex=39
   class="SelectBig Mandatory">
  <option></option>
  %ALLWEB02.02.140.35.2
  </select>
</span>

<span id="ShowCarerResBlank" style="display:none">
   <input type="hidden" name="alref074" value=" ">
</span>

<span id="showtsHeading" style="display:none">
Triage Status
</span>

<span id="showtsField" style="display:none">
<select title="Triage Status" name=alref186 class="Mandatory SelectBig"
 tabindex=1 id="alref186" onchange="showPriorityTriage();">
<option></option>
%ALLWEB02.02.199.066.2
</select>
</span>

<span id="showtdHeading" style="display:none">
Triage Date
</span>

<span id="showtdField" style="display:none">
<input type=text name=alref187 id=alref187 size=12 title="Triage Date"
 value="%ALLWEB02.02.199.067" class="PastDate"
 onblur="checkTriageDate(this);">
<img src=../images/DateTimeStamp.gif class=Icon
 date=UpdateForm.alref187 time=null>
<img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref187>
</span>

<span id="showprHeading" style="display:none">
Priority
</span>

<span id="showprField" style="display:none">
<select class="Mandatory selectBig" name=alref027 id=alref027
 title="Priority" tabindex=2>
<option></option>
 %ALLWEB02.02.127.2
</select>
</span>

<script type="text/javascript">
//
 SACSRef="%ALLWEB02.02.144";
 if ( SACSRef == "Yes") {
   document.UpdateForm.alref083.value=1;
 }
// referralInDestination="%ALLWEB02.02.816"
// var btnreferralInDestination = document.getElementById("btnReferralInDestination");

// if(referralInDestination == 1)
//  btnreferralInDestination.style.color = "red";
// else
//  btnreferralInDestination.style.color = "black"; 
//
  if ("%ALLWEB02.02.103" == "Waiting   ") {
  InsertActive.style.display='';
}
SelectNumbers(UpdateForm.alref192,0,101,1,"%ALLWEB02.02.199.072");
UpdateForm.alref192.options[UpdateForm.alref192.options.length]
=new Option('999', '999');
if("%ALLWEB02.02.199.072" == "999") {
  for(var i =0 ; i < UpdateForm.alref192.length; i++) {
      if (UpdateForm.alref192.options[i].value=="%ALLWEB02.02.199.072") {
          UpdateForm.alref192.selectedIndex=i 
      } 
  }
}
</script>
