<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/websec01.js"></script>
%START.OF.PAGE
<script type="text/javascript">
  function DisplayHospital() {
    var p = document.changesite;
    if(p.ibcnmhos.value=="1") {
      document.getElementById("InsertHospital").innerHTML=
      document.getElementById("Hospital").innerHTML;
    } else {
      document.getElementById("InsertHospital").innerHTML=
      document.getElementById("NoHospital").innerHTML;
    }
  }
  function LoadHospDetails(){

    var p = document.changesite;
    var l = "%WEBSEC01.05.035.1";
    var d = "%WEBSEC01.05.051.1";

    if(!isWhitespace(p.d_redirect.value)) {
      p.target="";
      p.redirect.value=p.d_redirect.value        // Update redirect 
    }
    ChangeHospital();

    for(var j=0; j<p.wbsec032.options.length; j++){
      var locationOption = p.wbsec032.options[j].value.substr(0,3);
      if(l==locationOption){
        p.wbsec032.selectedIndex = j;
        break;
      }
    }

    for(var i=0; i<p.wbsec021.options.length; i++){
      var departmentOption = p.wbsec021.options[i].value.substr(0,3);
      if(d==departmentOption){
        p.wbsec021.selectedIndex = i;
        break;
      }
    }

  }

  function ChangeHospital(){

    var p = document.changesite;
    var hospcode = p.wbsec031;
    var reportnumber = "68";
    selectOptions2(reportnumber,hospcode,p.wbsec021);
    filterCatCodeList(p.wbsec021,"3"," ","1");
//
    if(p.ibcnmhos.value=="1") {
      SelectOptionsHospCatCode(p.ctcode,hospcode,p.wbsec032);
    } else {
      selectOptions3('15',p.ctcode,p.wbsec032);
    }
  }

  function ClearClinic(){

    document.changesite.wbsec007.value = "";
    document.changesite.name_wbsec007.value = "";

  }

  function ValidateOC(field){

    var p = document.changesite;

    if(p.wbsec007.value!=""){
      UpCase(field);
      validateClinic(p.wbsec006,p.wbsec007,p.name_wbsec007);
    }

  }
function PostChangeSite() {
  if(validateMandatory(changesite)) {
     ExpireCookiePath("FilterColumn");
     ExpireCookiePath("FilterValue");
     ExpireCookiePath("FilterLocation");
     document.changesite.submit();
  }
}
</script>
</head>

<body onLoad="DisplayHospital();LoadHospDetails();PageLoad();">
  <br>
  <br>

  <form name=changesite method=post target=_top >
  <table border=2 cellspacing=0 align=center bgcolor=#CCCCCC>

    <tr>
      <td align=center class=HeadingCell>Change Outpatient Site</td>
    </tr>

    <tr>
      <td>
        <input type=hidden name=reportno value="5">
        <input type=hidden name=template value="1">
        <input type=hidden name=updttype value="U">
        <input type=hidden name=wbsec011 value=1>
        <input type=hidden name=username value="%WEBSEC01.05.001">
        <input type=hidden name=wbsec029 value="%WEBSEC01.05.032">
        <input type=hidden name=nextpage value="1">
        <input type=hidden name=redirect 
         value="websec01.pbl?reportno=1&template=1">
        <input type=hidden name=wbsec014 value="%WEBSEC01.05.017.1">
        <input type=hidden name=wbsec015 value="%WEBSEC01.05.018">
        <input type=hidden name=cgcode value="CG">
        <input type=hidden name=ctcode value="CT">
        <input type=hidden name=chnghosp value=1>
        <input type=hidden name=d_redirect value="%WEBSEC01.05.077">
        <input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">

        <table width=500>

          <tr>
            <td class=DataLabel width=30%>User</td>
            <td>
              <input type=text name=name class="Readonly" style="width: 80px;" 
               value="%WEBSEC01.05.002" readonly>
            </td>
          </tr>
        </table>

        <div id=InsertHospital></div>

        <table width=500>
          <tr>
            <td class=DataLabel>Outpatient Site</td>
            <td>
              <select name=wbsec006 onchange="ClearClinic();" 
               class="Mandatory" title="Outpatient Site" style="width: 200px;">
                <option></option>
                %WEBSEC01.05.076
              </select>
            </td>
          </tr>
          <tr>
            <td class=DataLabel width=30%>Outpatient Clinic</td>
            <td>
              <input type=text name=wbsec007 title="Clinic ID" 
               style="width: 80px;" maxlength=6 value="%WEBSEC01.05.007"
               onblur="ValidateOC(this)"> 
              <input type=text name=name_wbsec007 class="Readonly" title="Clinic Id"
               size=30 maxlength=25 value="" readonly>
 <img class=Icon src=../images/SearchIcon.gif
  onClick="ClinicSessionSearchFrameSite(changesite.wbsec006,changesite.wbsec007,changesite.name_wbsec007);">
              <img src="../images/erase.gif" class="Icon"
               onClick="clrDoc(changesite.wbsec007,changesite.name_wbsec007);">
            </td>
          </tr>
          <tr>
            <td>Clinic Location</td>
            <td>
              <select name=wbsec032 style="width: 200px;">
                <option></option>
              </select>
            </td>
          </tr>

          <tr>
            <td class=DataLabel>Department</td>
            <td>
              <select name=wbsec021 style="width: 200px;">
                <option></option>
              </select>
            </td>
          </tr>
        </table>

        <br>

        <table border=0 cellspacing=0 align=center bgcolor=#CCCCCC>
          <tr>
            <td colspan=2 align=center>
              <input type=button class="button" value="Change" id="Changbutton"
               onclick="tempDisable(this);PostChangeSite();">
            </td>
          </tr>
        </table>

      </td>
    </tr>
  </table>
</form>

<div id=Hospital style="display: none">
<table width=500>
<tr>
   <td class=DataLabel width=30%>Hospital ID</td>
   <td>
   <select name=wbsec031 onchange="ChangeHospital()" 
    class="Mandatory" title="Hospital ID" style="width: 200px;">
   <option></option>
    %WEBSEC01.05.034.5
   </select>
   </td></tr>
</table>
</div>

<div id=NoHospital style="display: none">
<input type=hidden name=wbsec031 value="  ">
</div>

<script type="text/javascript">
 var p = document.changesite;
   // Populate the Outpatient Clinic Description
   // if both the O/P Site & O/P Clinic Code exist
 if(p.wbsec006.value!="" && p.wbsec007.value!=""){
   validateClinic(p.wbsec006,p.wbsec007,p.name_wbsec007);
 }
 var p = document.changesite;
 filterCatCodeList(p.wbsec021,"3"," ","1");
</script>
