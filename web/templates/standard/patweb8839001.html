<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript">
function checkUser(userId,userName) {
  if (isWhitespace(userId.value)) {
    userName.value = "";
    return;
  }
  var serverURL = "../cgi-bin/patweb80.pbl?reportno=61" +
                  "&valdcode=" + userId.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
    userName.value=trim(ReturnValue[0])
  }
  else {
    userId.value="";
    userName.value="";
    userId.focus();
  }
}
function UserIdSearchFrame(ReturnCode,ReturnName) {
  var PopUpFrameDoc = DFrameStart();
  window.ReturnCode=ReturnCode;
  window.ReturnName=ReturnName;
  PopUpFrameDoc.location.href = "../cgi-bin/websec01.pbl?reportno=03" +
                                "&template=011"
  SearchFrameShow();
}
function ShowSpans(showoption) {
  f = document.UpdateForm;
  if (showoption.value == "1") {
    UpdOptions.innerHTML=UpdPrefItem.innerHTML;
    DisplayHospIdDetail();
    for (var i =0 ; i < f.hospcode.length; i++) {
      if (f.hospcode.options[i].value == f.multhosp.value) {
        f.hospcode.selectedIndex = i;
      }
    }
  }
  else {
    if (showoption.value=="2") {
      UpdOptions.innerHTML=UpdFavItem.innerHTML;
    }
    else {
      UpdOptions.innerHTML="";
    }
  }
}
function ProcessReport() {
  f = document.UpdateForm;
  if (validateMandatory(UpdateForm)) {
    if (f.updttype.value == "1") {
      if (trim(f.fvgrp007.value) == trim(f.fvgrp008.value)) {
        alert('Item to be Replaced cannot be the same as New Item Code');
      }
      else {
        f.submit();
      }
    }
    else {
      if (trim(f.fvgrp005.value) == trim(f.fvgrp006.value)) {
        alert('Item to be Replaced cannot be the same as New Item Code');
      }
      else {
        f.submit();
      }
    }
  }
}
function searchPrefItem(itemCode,itemName) {
  f = document.UpdateForm;
  f.hospid.value = f.hospcode.value;

  if (f.opcnptmc.value=="1") {
    if (f.ibcnmhos.value == "1" && f.cfeetyp.value == "5") {
      DefMiscChargeSearchFrame(itemCode,itemName,f.hospid);
    }
    else {
      DefMiscChargeSearchFrame(itemCode,itemName,f.multhosp);
    }
  } 
  else {
    TheatItemSearchFrame(itemCode,itemName,'8');
  }
}
function validatePrefItem(itemCode,itemName) {
  f = document.UpdateForm;
  if (isWhitespace(itemCode.value)) {
    itemName.value = "";
    return;
  }

  if (f.opcnptmc.value=="1") {
    if (f.ibcnmhos.value == "1" && f.cfeetyp.value == "5") {
      f.hospid.value = f.hospcode.value;
      if (isWhitespace(f.hospid.value)) {
        itemName.value = "";
        return;
      }
      validateItemHosp(itemCode,itemName,f.hospid);
    }
    else {
      validateCode(40,itemCode,itemName);
    }
  }
  else {
    validateCode(23,itemCode,itemName);
  }
}
function DisplayHospIdDetail() {
  f = document.UpdateForm;
  if (f.ibcnmhos.value == "1") {
    document.getElementById('HospIdDetail').style.display = "";
    AddClassName(f.hospcode,"Mandatory");
    document.getElementById('HospitalList').style.display = "";
  }
  else {
    document.getElementById('HospIdDetail').style.display = "none";
    document.getElementById('HospitalList').style.display = "none";
  }
}
function PrefHospitalChanged() {
  f = document.UpdateForm;
  if (f.ibcnmhos.value == "0") {return;}
  if (isWhitespace(f.hospcode.value)) {
    f.fvgrp007.value = "";        
    f.d_fvgrp007.value = "";        
    f.fvgrp008.value = "";        
    f.d_fvgrp008.value = "";        
    return;
  }

  validatePrefItem(f.fvgrp007,f.d_fvgrp007);
  validatePrefItem(f.fvgrp008,f.d_fvgrp008);
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisplayHospIdDetail();">
<form name=UpdateForm method=post action=patweb88.pbl style="margin:0">
<input type=hidden name=reportno value=39>
<input type=hidden name=template value=001>
<input type=hidden name=multhosp id=multhosp value="%STANDARD.01.032">
<input type=hidden name=hospd id=hospid value="">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=opcnptmc id=opcnptmc
                   value="%STANDARD.01.025.113. 66.0.1">
<input type=hidden name=cfeetyp value="%STANDARD.01.025.019.212.0.1">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=001">
<input type=hidden name=cancflag value=0>

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>
  Surgical Preference/Favourite Items Global Functions</td></tr>
</table>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>

<tr><td colspan=2>&nbsp;</td></tr>

<tr>
  <td class=DataLabel width=25%>Charge Items Update Function</td>
  <td>
    <select name=updttype title="Report Option" class=Mandatory 
      onchange="ShowSpans(this);">
      <option></option>
      <option value="1">Global Update of Preference/Tray Items</option>
      <option value="2">Global Update of Favourite Charge Items</option>
    </select>
  </td>
</tr>
<tr><td colspan=2 align=center><hr width=100%></td></tr>

<tr>
  <td colspan=2>
    <span id=UpdOptions></span>
  </td>
</tr>

<tr>
  <td align=center colspan=2>
    <input type=button value=Ok class="button" onclick="ProcessReport();">
    <input type=button value=Cancel class="button"
      onclick="UpdateForm.cancflag.value=1;ClearForm.submit();">
  </td>
</tr>
</table>
</form>

<form name=ClearForm method=post action=patweb62.pbl>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=001>
<input type=hidden name=updttype value="I">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="../lookups/blank.html">
</form>

<span id=UpdPrefItem style="display:none">
<table width=100% align=center border=0 cellspacing=2 cellpadding=1>
<tr id=HospitalList>
  <td class=DataLabel>Hospital</td>
  <td><select name=hospcode
       title="Hospital" tabindex=1
       onchange="PrefHospitalChanged();">
       <option value="   "></option>
        %PATWEB88.39.001
      </select>
  </td>
</tr>
<tr>
  <td class=DataLabel>Item to be Replaced</td>
  <td>
    <input type=text name=fvgrp007 id=fvgrp007 size=20 maxlength=15
      title="Item to be Replaced" class=Mandatory
      onblur="validatePrefItem(fvgrp007,d_fvgrp007);">
    <input type=text size=90 name=d_fvgrp007 id=d_fvgrp007
      title="Item to be Replaced Description"
      class=Readonly readonly notab>
    <img src=../images/SearchIcon.gif class=Icon notab
      onclick="searchPrefItem(fvgrp007,d_fvgrp007);">
    <img src="../images/erase.gif" class=Icon notab
      onclick="clrFields(fvgrp007,d_fvgrp007);">
    </td>
</tr>
<tr>
  <td class=DataLabel>New Item Code</td>
  <td>
    <input type=text name=fvgrp008 id=fvgrp008 size=20 maxlength=15
      title="New Item Code" class=Mandatory
      onblur="validatePrefItem(fvgrp008,d_fvgrp008);">
    <input type=text size=90 name=d_fvgrp008 id=d_fvgrp008
      title="New Item Code Description"
      class=Readonly readonly notab>
    <img src=../images/SearchIcon.gif class=Icon notab
      onclick="searchPrefItem(fvgrp008,d_fvgrp008);">
    <img src="../images/erase.gif" class=Icon notab
      onclick="clrFields(fvgrp008,d_fvgrp008);">
    </td>
</tr>
</table>
</span>

<span id=UpdFavItem style="display:none">
<table width=100% align=center border=0 cellspacing=2 cellpadding=1>
<tr id=HospIdDetail>
  <td class=DataLabel>Hospital</td>
  <td><select name=fvgrp001 title="Hospital"
        tabindex=1>
      <option value="   ">All</option>
        %PATWEB88.39.001
      </select>
  </td>
</tr>
<tr>
  <td class=DataLabel>Occupational Group</td>
  <td><select name=fvgrp002 title="Occupational Group">
      <option value="   ">All</option>
        %PATWEB88.39.002.9.2
      </select>
  </td>
</tr>
<tr>
  <td class=DataLabel>User ID</td>
  <td class=DataField>
    <input type=text name=fvgrp003 id=fvgrp003 size=12 maxlength=10
      title="User ID" value=""
      onblur="checkUser(fvgrp003,d_fvgrp003);">
    <input type=text name=d_fvgrp003 id=d_fvgrp003 size=40
      title="User Name"
      class=Readonly readonly notab value="">
    <img src="../images/SearchIcon.gif" class=Icon
      notab
      onclick="UserIdSearchFrame(fvgrp003,d_fvgrp003);">
    <img src="../images/erase.gif" class=Icon
      onclick="clrFields(fvgrp003,d_fvgrp003);">
  </td>
</tr>
<tr>
  <td class=DataLabel>Favourite Group</td>
  <td><select name=fvgrp004 title="Favourite Group">
      <option value="   ">All</option>
        %PATWEB88.39.003.9.2
      </select>
  </td>
</tr>
<tr>
  <td class=DataLabel>Item to be Replaced</td>
  <td>
    <input type=text name=fvgrp005 id=fvgrp005 size=9 maxlength=9
      title="Item to be Replaced" class=Mandatory
      onblur="validateCode(40,fvgrp005,d_fvgrp005);">
    <input type=text size=90 name=d_fvgrp005 id=d_fvgrp005
      title="Item to be Replaced Description"
      class=Readonly readonly notab tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon notab
      onclick="DefMiscChargeSearchFrame(fvgrp005,d_fvgrp005,multhosp);">
    <img src="../images/erase.gif" class=Icon notab
      onclick="clrFields(fvgrp005,d_fvgrp005);">
    </td>
</tr>
<tr>
  <td class=DataLabel>New Item Code</td>
  <td>
    <input type=text name=fvgrp006 id=fvgrp006 size=9 maxlength=9
      title="New Item Code" class=Mandatory
      onblur="validateCode(40,fvgrp006,d_fvgrp006);">
    <input type=text size=90 name=d_fvgrp006 id=d_fvgrp006
      title="New Item Code Description"
      class=Readonly readonly notab tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon notab
      onclick="DefMiscChargeSearchFrame(fvgrp006,d_fvgrp006,multhosp);">
    <img src="../images/erase.gif" class=Icon notab
      onclick="clrFields(fvgrp006,d_fvgrp006);">
    </td>
</tr>
</table>
</span>
