<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript">
function SetClinicT() {
  p=AddForm
  p.otcmn008.options.length=1;
  SetClinicType(p.otcmn008,p.defctype.value,p.otcmn007.value);
}
function checkDateValidation(theField)
{
 if (isWhitespace(theField.value)){ return true; }
 var currentYear=parent.document.getElementById('MaintenanceHeading').innerText;
     currentYear=trim(currentYear);
 var userYear=new Date(theField.value).getFullYear();
     userYear=userYear.toString();
 if(userYear !==currentYear){
  theField.value='';
   alert("System Wide Comments can only be added from 1 " +
          "January to 31 December for the current year.");
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);SetClinicT();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Add System Wide Comments 
</span>

<form name=AddForm method=post action=outweb04.pbl style="margin:0">
<input type=hidden name=reportno value="3">
<input type=hidden name=template value="002">
<input type=hidden name=updttype value="A">
<input type=hidden name=defctype value=" ">
<table align=center width=100% border=0> 

<tr><td class=DataLabel>Active From Date</td>
    <td><input type=text name=otcmn002  
         title="Active From Date" size=12 maxlength=10 class=Mandatory
         onblur="checkDateValidation(this);" >
         <img  src='../images/DateTimeStamp.gif'
          onclick="SetCurrentDateTime(AddForm.otcmn002,null);">
         <img src=../images/DateLookup.gif class="Icon"
          onclick="DateLookupFrame(AddForm.otcmn002);">
    </td></tr>

<tr><td class=DataLabel>Active To Date</td>                       
    <td><input type=text name=otcmn001
         title="Active To Date" size=12 maxlength=10 class=Mandatory 
         onblur="checkDateValidation(this);" >
        <img  src='../images/DateTimeStamp.gif'
         onclick="SetCurrentDateTime(AddForm.otcmn001,null);">
        <img src=../images/DateLookup.gif class="Icon"
         onclick="DateLookupFrame(AddForm.otcmn001);">
    </td></tr>

<tr><td class=DataLabel>Active For Site</td>                       
    <td><select name=otcmn007 title="Active For Site" id="otcmn007"
         onchange="SetClinicT();">
          <option value="      ">All</option>
           %OUTWEB04.03.015
      </select>
    </td></tr>

<tr><td class=DataLabel>Active For Clinic Type</td>
    <td><select name=otcmn008 title="Clinic Type" id="otcmn008">
          <option value="      ">All</option>
        </select>
    </td></tr>

<tr><td class=DataLabel>Comments</td>
    <td><input type=text name=otcmn003 class = Mandatory 
         title="Outpatient System Wide Comments" size=40  maxlength=60>
    </td></tr>

<tr><td class=DataLabel></td>
    <td><input type=text name=otcmn004
         title="Outpatient System Wide Comments" size=40 maxlength=60>
    </td></tr>

<tr><td class=DataLabel></td>
    <td><input type=text name=otcmn005 
         title="Outpatient System Wide Comments" size=40 maxlength=60>
    </td></tr>

<tr><td class=DataLabel></td>
    <td><input type=text name=otcmn006 
         title="Outpatient System Wide Comments" size=40 maxlength=60>
    </td></tr>

<tr><td  colSpan=2 align=center><br>
    <input type=button value="Add" class="button" id="out04add"
     onclick="tempDisable(this);RefreshSubmit()">
    <input type=button value="Close" class="button" 
     onclick="DFrameCloseRefresh()">
    </td></tr>
</table>
</form>

<script>
function RefreshSubmit() {
var Flag = DateValidation();
  if (Flag < 0){
       return 0;
  }
  else {
    if (validateMandatory(AddForm)) {
       document.AddForm.submit(); } 
 }
}
function DateValidation(){
   var fromdate = new Date(AddForm.otcmn002.value);
   var enddate = new Date(AddForm.otcmn001.value);
   var gap=enddate.getTime()-fromdate.getTime();
   gap = gap/(1000*60*60*24);
   if (gap < 0){
      alert("The From Date Should be less than To Date");
      AddForm.otcmn002.value="";
      return -1;
   }
   else {
      return 1;
   }
}
</Script>
