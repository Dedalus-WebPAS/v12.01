<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/EmrMandatory.js"></script>
<script type="text/javascript" src="../js/emrweb0202010.js"></script>
<script type="text/javascript">
function CancelAction() {
location.href='emrweb01.pbl?reportno=01&template=035';
//window.history.go(-1);

/*
  if (top.TogglePanel==null) {
    top.location.reload();
  } else {
    top.TogglePanel();
  }
*/
}
function chkFormSend() {
}
function SubmitForm() {
  var check=false;
  for(var i = 0; i < UpdateForm.emexp028.length; i++) {
     if (UpdateForm.emexp028[i].checked==true) {
      check=true;
     }
  }
  if (check==false) {
    alert("Expected Patient, Advice Call or Contact List" +
          " has not been selected !");
    return true;
  }
  setRedirect();
  setFormactn();
}
function IsDirty(eForm) {
  for (var i=0; i < eForm.length; i++) {
    var eElem = eForm.elements[i];
    if ("text" == eElem.type || "textarea" == eElem.tagName)
    {
      if (eElem.value != eElem.defaultValue)  {return true;}
    }
    else if ("checkbox" == eElem.type || "radio" == eElem.type)
    {
      if (eElem.checked != eElem.defaultChecked) return true;
    }
  }
  return false;
}
function Validateprecom001() {
  onblurHandler()
  var formatedtext=formateText(UpdateForm.prcom001,'50')
  if ((formatedtext.split(/[\r\n]/).length>6) || 
        (UpdateForm.prcom001.value.length > 300)) {
    alert("Presenting Complaint comments - Max 6 lines."
           +"\nPlease remove extra rows to continue.");
    document.UpdateForm.prcom001.focus();
    return; }
}
function Validateaddcom001() {
  onblurHandler()
  var formatedtext=formateText(UpdateForm.adcom001,'100')
  if ((formatedtext.split(/[\r\n]/).length>5) ||
        (UpdateForm.adcom001.value.length > 500)) {
    alert("Additional Information comments - Max 5 lines."
           +"\nPlease remove extra rows to continue.");
    document.UpdateForm.adcom001.focus();
    return; }
}
function onblurSpclChar(el) {
  el.value=el.value.replace(/@/g,'');
  el.value=el.value.replace(/\*/g,'');
  el.value=el.value.replace(/\//g,'');
  el.value=el.value.replace(/:/g,'');
  el.value=el.value.replace(/\\/g,'');
  el.value=el.value.replace(/\$/g,'');
  el.value=el.value.replace(/\%/g,'');
  el.value=el.value.replace(/&/g,'');
  el.value=el.value.replace(/#/g,'');
}

function LookupCleanup()
{
  var txtSearch = document.getElementById('txtPresComp');
  if (txtSearch == undefined) return;

  txtSearch.value = ""; 
}
function CheckAmbType() {
  if(document.UpdateForm.emexp014.value.substr(3,1)=="A") {
    document.UpdateForm.emexp026.readOnly=false;
    if(document.UpdateForm.emexp014.value.substr(4,1)=="N") {
      document.UpdateForm.emexp026.className="";
    } else {
      document.UpdateForm.emexp026.className="Mandatory";
    }
  } else {
    document.UpdateForm.emexp026.value="";
    document.UpdateForm.emexp026.className="ReadOnly";
    document.UpdateForm.emexp026.readOnly=true;
  }
}
function checkSOR() {
  if (document.getElementById("emexp019").value.substr(5,1)=="1") {
    document.getElementById("TranSrcHeading").innerHTML=document.getElementById("transferhd").innerHTML;
    document.getElementById("TranSrc").innerHTML=document.getElementById("transfersrc").innerHTML;
 
  } else {
    document.getElementById("TranSrcHeading").innerHTML="";
    document.getElementById("TranSrc").innerHTML=document.getElementById("transferblank").innerHTML;
  } 
}
function checkrR() {
  if (!isWhitespace(document.getElementById("emexp030").value)) {
    document.getElementById("emexp029").value="0";
  } else {
    document.getElementById("emexp029").value="";
  }
}
function RemoteEmrLocation(valdcode,valdrtyp,ReturnSelect) {
  ReturnFunction="" ;
  for (var i=1; i < RemoteEmrLocation.arguments.length; i++) {
  if (typeof(RemoteEmrLocation.arguments[i]) == 'function') {
     ReturnFunction=RemoteEmrLocation.arguments[i] } }
  var serverURL = "../cgi-bin/emrweb08.pbl?reportno=30" +
                  "&valdcode=" + valdcode.value.replace(/ /g,"+") +
                  "&valdrtyp=" + valdrtyp.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  ReturnValue=returnValue.return_value.split("|")
  if (returnValue.status==0) {
    ReturnSelect.options.length=0
    ReturnValue=returnValue.return_value.split("|");
    for (var j=0; j < ReturnValue.length; j++) {
       if (!isWhitespace(ReturnValue[j])) {
         SelectValue=ReturnValue[j].split(",");
         ReturnSelect.options[ReturnSelect.options.length]=
          new Option(SelectValue[1],SelectValue[0]);
       }
     }
  }
}
function PatientReturnCheck() {
  f = document.UpdateForm;
  if (f.emcnalex.value == '1') {
    PatientReturnWANoVisitCheck();
  }
  else {
    PatientReturnWA();
  }
}
function SetExpectedLocation() {
  f = document.UpdateForm;
  RemoteEmrLocation(f.emvis132,f.valdrtyp,f.emvis006);
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);CheckAmbType();SetExpectedLocation();"> 
<span class=DFrameTitleBar>
ETS Add Expected, Advice, Contact Details
</span>

<form name=UpdateForm action="emrweb02.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="02">
<input type=hidden name=template value="010">
<input type=hidden name=formactn>
<input type=hidden name=updttype>
<input type=hidden name=updateky value="">
<input type=hidden name=nextpage value="0">
<input type=hidden name=redirect>
<input type=hidden name=deceased>
<input type=hidden name=selsex>
<input type=hidden name=gname>
<input type=hidden name=sname>
<input type=hidden name=patgname>
<input type=hidden name=patsname>
<input type=hidden name=dummy>
<input type=hidden name=dummyadm> 
<input type=hidden name=emexpsit value="%STANDARD.01.041">
<input type=hidden name=emexp029 id=emexp029 value="">
<input type=hidden name=valdrtyp value="E">
<input type=hidden name=ptcnhdps id=ptcnhdps
       value="%STANDARD.01.025.080.250.1.1">
<input type=hidden name=emcnalex id=emcnalex
       value="%STANDARD.01.025.122.017.1.1">
  
<table align=center width=100% border=0 cellspacing=0
 cellpadding=0>
<tr>
  <td class=DataLabel>Site ID</td>
  <td>
    <input type=hidden name=name_emvis132 title="Site ID">
    <select class="Mandatory" name=emvis132 id=emvis132 tabindex=1
      title="Site ID"
      onchange="RemoteEmrLocation(this,UpdateForm.valdrtyp,
                UpdateForm.emvis006);">
      %EMRWEB02.02.185.2
    </select>
  </td>
</tr>
<tr>
    <td class=DataLabel>Username</td>
    <td><input type=hidden name=securety value="2">
        <input type=text size=12 name=secureid class="Mandatory NoAutoFocus"
          tabindex=1 title="User ID" value="%STANDARD.01.043">
    Password
      <input type=password size =12 name=securepw class=Mandatory tabindex=2
        onfocus="SetCaretPosition('securepw',-1);"
        title="Password" onblur=checkPass();>
    </td>

   <td class=DataLabel>U/R</td> 
   <td><input type=text size=10 maxlength=8 name=emexp018 tabindex=2
       onblur="UpCase(this);justifyRight(this);PatientReturnCheck();">
       <img class=Icon src=../images/SearchIcon.gif onclick="PatientSearchWA();">
</td>
    <td class=DataLabel>Surname </td>
    <td><input type=text size=25 max=25 name=emexp002 tabindex=3
         onblur="UpCase(this);onblurHandler();onblurSpclChar(this);"></td>
    <td class=DataLabel>Given Name </td>
    <td><input type=text size=25 max=25 name=emexp003 tabindex=4
         onblur="UpCase(this);onblurHandler();onblurSpclChar(this);"></td>
    </tr>

<tr><td></td>
    <td></td>
    <td></td>
    <td></td>
    <td class=DataLabel>%STANDARD.01.017.G </td>
    <td><div id="sexfieldDIV">
          <select name=emexp004 class=SelectSml tabindex=6>
            <option> </option>
             %EMRWEB02.02.086.099.061.9.1.19.3.H
          </select>
        </div>
    </td>
    <td class=DataLabel>Date of Birth </td>
    <td><input type=text size=12 max=11 name=emexp005 
         title="Date of Birth" class="Past Date" tabindex=7>
        <img class=Icon src=../images/DateTimeStamp.gif
         date=document.UpdateForm.emexp005>
        <img class=Icon src=../images/DateLookup.gif 
         date=document.UpdateForm.emexp005>
        </td>
    </tr>
</table>
<table align=center width=100% border=0 cellspacing=0 
 cellpadding=0>
<tr><td colspan=6><hr></td>
</tr>

<tr><td class=DataLabel>Date Notified</td>
    <td><input type="text" name=emexp015 size="12"  tabindex=9
         class="Mandatory FutureDate" title="Expected Date" 
         value="%STANDARD.01.015"
         onblur="checkDate(UpdateForm.emexp015,'Expected Date')">
         <img class=Icon src=../images/DateLookup.gif
         onclick="DateLookupFrame(UpdateForm.emexp015);">
         Time 
         <input type="text" name=emexp016 size="8"  tabindex=10
         class=Mandatory title="Expected Time" value="%STANDARD.01.016" 
         onblur="checkTime(UpdateForm.emexp016,'Expected Time')">
         <img class=Icon src=../images/TimeLookup.gif 
         onclick="TimeLookupFrame(UpdateForm.emexp016);">
         <img class=Icon src="../images/stopwat1.gif"
         onclick="SetCurrentDateTime(UpdateForm.emexp015,UpdateForm.emexp016);">
    </td>
    <td class=DataLabel>ETA</td>
    <td nowrap>
    <input type="text" name=emexp022 size="12"  tabindex=11
    class="Date" title="ETA Date" value=""
    onblur="checkDate(UpdateForm.emexp022,'ETA Date');" >
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.emexp022>
    Time <input type="text" name=emexp023 size="8"  tabindex=12
    title="ETA Time" value=""
    onblur="checkTime(UpdateForm.emexp023,'Triage Time');">
    <img src=../images/TimeLookup.gif class=Icon time=UpdateForm.emexp023>
    <img src="../images/DateTimeStamp.gif" class=Icon
    date=UpdateForm.emexp022 time=UpdateForm.emexp023>
    </td>
    <td class=DataLabel>%STANDARD.01.017.ZQ </td>
    <td><select name=emexp020 class=SelectMed tabindex=23
         title="%STANDARD.01.017.ZQ ">
        <option></option>
        %STANDARD.01.007.ZQ 
        </select></td>
</tr>

<tr><td class=DataLabel>Presenting Complaint</td>
    <td colspan=3 rowspan=2>
      <textarea name=prcom001 id=prcom001 valign=top tabindex=16
       wrap=hard cols=50 rows=6 style="overflow-y:hidden" class=AsciiOnly
       title="Presenting Complaint Comments"
       onkeydown="ValidateKeyInput(this);"
       onblur="TextareaBlurHandler(this);ValidateTextLimits(this);">
      </textarea>
    </td>
    <td class=DataLabel>%STANDARD.01.017.EA </td>
    <td>
      <select name=emexp014 tabindex=24 class="SelectMed"
       title="%STANDARD.01.017.EA "
       onchange="document.UpdateForm.emexp026.disabled=0;CheckAmbType();"
       onFocus="CheckAmbType();" >
      <option></option>
      %STANDARD.01.007.EA   
      </select>
    </td>
</tr>
<tr>
    <td></td>
    <td class=DataLabel>Amb Case No</td>
    <td><input type=text size=20 maxlength=15 name=emexp026 tabindex=25
         value="" title="Amb Case No">
    </td>
</tr>

<tr>
    <td class=DataLabel valign=top>Additional Information</td>
    <td colspan=3 rowspan=3>
      <textarea type=text valign=top name=adcom001 id=adcom001 tabindex=19
       wrap=hard cols=100 rows=5 style="overflow-y:hidden" class=AsciiOnly
       title="Additional Information"
       onkeydown="ValidateKeyInput(this);"
       onblur="TextareaBlurHandler(this);ValidateTextLimits(this);">
      </textarea>
    </td>
    <td>%STANDARD.01.017.em </td>
    <td>
      <select name=emexp019 id=emexp019 tabindex=26 class="SelectMed"
       title="%STANDARD.01.017.em " onchange="checkSOR();">
      <option></option>
      %STANDARD.01.007.em
      </select>
    </td>
</tr>

<tr>
  <td></td>
  <td class=DataLabel>Expected Location</td>
    <td><input type=hidden name=name_emvis006 title="Expected Location"
         value="%EMRWEB02.02.106.0">
    <select class="Mandatory" name=emvis006 tabindex=27
     title="Expected Location">
    </select>
  </td>
</tr>

<tr>
    <td></td>
    <td height=25><div id=TranSrcHeading></div></td>
    <td><div id=TranSrc></div></td>
</tr>

<tr>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td>%STANDARD.01.017.rR </td>
    <td>
      <select name=emexp030 id=emexp030 tabindex=29 class="SelectMed"
       title="%STANDARD.01.017.rR " onchange="checkrR();">
      <option></option>
      %STANDARD.01.007.rR
      </select>
    </td>
</tr>

<tr>
  <td nowrap>
    Caller Name and Contact Number
  </td>
  <td>
    <input type=text size=80 maxlength=100 name=emexp032 tabindex=20
     title="Caller Name and Contact Number"> 
  </td>
  <td></td>
  <td></td>
  <td nowrap>
<input type=radio name=emexp028 value="1" tabindex=30>Expected Patient<br>
<input type=radio name=emexp028 value="2" tabindex=31>Advice Call     <br>
<input type=radio name=emexp028 value="3" tabindex=32>Contact List
  </td>
</tr>

<tr>
  <td>
    &nbsp;
  </td>
</tr>

<tr><td colspan=6 align=center><br>
    <input type=button value="Add" class="button" tabindex=40 id="emr02a"
     onclick='tempDisable(this);SubmitForm();' >
    <input type=button value="Cancel" class="button" tabindex=41
     onclick="CancelAction();">
    </td></tr>
</table>
</form>

<span id=sexfieldSPAN1 style="display:none;">
<input type=text size=15 max=20 name=d_emexp004 tabindex=6 class=Readonly
 readonly value=%EMRWEB02.02.086.099.061.3>
<input type=hidden name=emexp004>
</span>

<span id=sexfieldSPAN2 style="display:none;">
  <select name=emexp004 class=SelectSml tabindex=6>
    <option value=" "></option>
        %EMRWEB02.02.086.099.061.9.1.19.3.H
  </select>
</span>

<span id=transferhd style="display:none">
Transfer Source
</span>

<span id=transferblank style="display:none">
    <input type=hidden name=emexp031 value="" notab>
</span>

<span id=transfersrc style="display:none">
     <input type="text" size=8 maxlength=6 name="emexp031"
      id=emexp031 tabindex=28 title="Transfer Source" class=Mandatory
      onchange='validateCode(9,UpdateForm.emexp031,UpdateForm.trnsfsrc);'>
     <input type=text  size=20 name=trnsfsrc notab readonly>
     <img class=Icon src="../images/SearchIcon.gif"
      onclick=" TransferSourceFrame(UpdateForm.emexp031,UpdateForm.trnsfsrc);">
</span>
