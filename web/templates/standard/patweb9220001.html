<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/TableSort.js></script>
<style type=text/css>
#BodyDivision td {
 text-wrap: wrap;
 word-wrap: break-word;
}
</style>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable();">
<form name=SelectForm action=patweb92.pbl method=get style="margin:0">
<input type=hidden name=reportno value="20">
<input type=hidden name=template value="001">
<input type=hidden name=updttype value=" ">

<div id=HeadingSection>
<table width="100%" cellpadding=2 cellspacing=0 border=0 bgcolor=#CCCCCC>
<tr>
  <td class=DataLabel>&nbsp;Status&nbsp;
    <select name=filtstat onchange="RefreshPage();">
      <option value="1">Parked</option>
      <option value="3">Cancelled</option>
    </select>
  </td>
</tr>
</table>
</div>
</form>

<div id=TableLocation></div>
<script type="text/javascript">
function InitTable() {
 document.title="Parked ACC List";
 t = new Table(1,0,2,"100%","center",25);
//
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
//
 t.addColumn("ACC Number","String",2,2,"left","AppointmentIcon.gif","7",75)
 t.addColumn("Patient","ImageText",0,0,"left","PatientFolder","7",170,1)
 t.addColumn("Description of Injury","String",6,6,"left","","",200)
 t.addColumn("Date of Accident","Date",3,3,"left","","",80)
 t.addColumn("HCP Treatment Provider","String",5,5,"left","","",100)
 t.addColumn("ACC Decline Date","DateTime",4,4,"left","","",80)
 t.addColumn("Visit Number","String",8,8,"left","","",80)
 t.addColumn("Status","String",10,11,"left","EditIcon.gif","12",80)
//
// Add Rows to Table (Output from Web Server)
//
 %PATWEB92.20.001.patweb89.01.005
 OrderColumn=0; 
 AscDsc=1;
 lastOrderColumn=OrderColumn;
 TableOutput(OrderColumn,AscDsc);
}

function EditStatus(UR, VisitNo) {
  linkurl="patweb92.pbl?reportno=20&template=002" + 
          "&urnumber=" + UR + "&admissno=" + VisitNo;

  Width = 450;
  Height = 250;
  Top = (document.body.clientHeight-Height)/2;
  Left = (document.body.clientWidth-Width)/2;
  
  DFrameLink(linkurl,Top,Left,Width,Height);
}

function RefreshPage() {
  document.SelectForm.submit();
}

var p = document.SelectForm;
var filtStatus = "%PATWEB92.20.002";
if (!isWhitespace(filtStatus)) {
  for (var i = 0; i < p.filtstat.length; i++) {
    if (p.filtstat.options[i].value == filtStatus) {
      p.filtstat.selectedIndex = i;
    }
  }
}

function TableBody() {
 filteredRows=0;
 RowClass="TableRowEven"

 var STATUS_COL_NUM = 7;    // Claim Status column number
 var STATUS_COMPLETE = 2;   // Completed
 var STATUS_CANCELLED = 3;  // Cancelled
 var ClaimStatus = "";
 var bShowUpdtIcon = false;

 for(var i = 0; i < t.rows.length; i++) {
  if (TableFilter(t.rows[i])){
   filteredRows++;

   if (RowClass=="TableRowEven") { RowClass="TableRowOdd" }
   else                          { RowClass="TableRowEven" }

   TableString[TableString.length] = "<tr id='row_"+i+"' height=" + t.RowHeight + " class=" + RowClass + ">" ;
   for(var j = 0; j < t.columns.length; j++) {
     TableString[TableString.length] = "<td style='padding:0px 5px' align=" + t.columns[j][4];
     if(t.columns[j][11]!=undefined) {
       if(!isWhitespace(t.rows[i][t.columns[j][11]])) {
         TableString[TableString.length] = " class=" + 
                                           t.rows[i][t.columns[j][11]]  ;
       }
     }
     if(t.columns[j][12]!=undefined) {
       if(!isWhitespace(t.rows[i][t.columns[j][12]])) {
         TableString[TableString.length] = " title=" +
                         t.rows[i][t.columns[j][12]].replace(/ /g,"&nbsp;");
       }
     }

     ClaimStatus = t.rows[i][5];
     bShowUpdtIcon = (ClaimStatus != STATUS_COMPLETE)? true : false;

     if (ClaimStatus == STATUS_CANCELLED) {  // Cancelled Claim Status?
       if (j == STATUS_COL_NUM) {
         TableString[TableString.length] = " style='font:bold'";  // bold text
       }
       else {
         TableString[TableString.length] = " style='text-decoration:line-through'";
       }
     }

     TableString[TableString.length] = " width=" + t.columns[j][7] + ">" ;
     LinkColumn = t.columns[j][6];
     LinkFlag = 0
     ImgString = t.columns[j][5];
     onmouseind = t.columns[j][10];

     if (LinkColumn != "" && j != STATUS_COL_NUM) {
       LinkHref = t.rows[i][t.columns[j][6]];
       if (LinkHref != ""){ 
         TableString[TableString.length] = "<a href=\"" +
                                           LinkHref.replace(/\s*$/,"") + "\">"
         LinkFlag = 1 }
     }

     switch(t.columns[j][1]) {
       case "MaxLimit" :  
         FormatIcon(i);
         ThisValue=t.rows[i][t.columns[j][2]];
         MaxValue=t.columns[j][8];
         HighLightColor=t.columns[j][9];
         if (ThisValue>MaxValue) {
            TableString[TableString.length] = "<font color="+HighLightColor+"><b>"
            TableString[TableString.length] = t.rows[i][t.columns[j][2]];
            TableString[TableString.length] = "</font><b>" }
         else {
            TableString[TableString.length] = t.rows[i][t.columns[j][2]]; }
         if ( LinkFlag ) { TableString[TableString.length] = "</a>"; }
         break;
       case "MinLimit" :  
         FormatIcon(i);
         ThisValue=t.rows[i][t.columns[j][2]];
         MaxValue=t.columns[j][8];
         HighLightColor=t.columns[j][9];
         if (ThisValue<MaxValue) {
            TableString[TableString.length] = "<font color=" +
                                              HighLightColor+"><b>"
            TableString[TableString.length] = t.rows[i][t.columns[j][2]];
            TableString[TableString.length] = "</font><b>" }
         else {
            TableString[TableString.length] = t.rows[i][t.columns[j][2]]; }
         if ( LinkFlag ) { TableString[TableString.length] = "</a>"; }
         break;
       case "Date" :  
         FormatIcon(i);
         TableString[TableString.length] = FormatDate(t.rows[i][t.columns[j][2]]);
         break;
       case "DateTime" :  
         FormatIcon(i);
         TableString[TableString.length] = FormatDateTime(t.rows[i][t.columns[j][2]]);
         break;
       case "DateTimeImg" :
         if (t.columns[j][5] == "") {
           ImgString=t.rows[i][t.columns[j][8]];
         }
         else {
           ImgString=t.columns[j][5] +
                       t.rows[i][t.columns[j][8]] + ".gif"
         }
         FormatIcon(i);
         TableString[TableString.length] = FormatDateTime(t.rows[i][t.columns[j][2]]);
         break;
       case "Time" :  
         FormatIcon(i);
         TableString[TableString.length] = FormatTime(t.rows[i][t.columns[j][2]]);
         break;
       case "Name" :  
         FormatIcon(i);
         TableString[TableString.length] = FormatName(t.rows[i][t.columns[j][2]]);
         break;
       case "ImageText" :
         if (t.columns[j][5] == "") {
           ImgString=t.rows[i][t.columns[j][8]];
         }
         else {
           ImgString=t.columns[j][5] +
                       t.rows[i][t.columns[j][8]] + ".gif"
         }
         FormatIcon(i);
         TableString[TableString.length] = (t.rows[i][t.columns[j][2]]);
         break;
       case "NameAll" :  
         FormatIcon(i);
         TableString[TableString.length] = FormatNameAll(t.rows[i][t.columns[j][2]]);
         break;
       case "Graph":  
         TableString[TableString.length] = FormatGraph(t.rows[i][t.columns[j][2]],t.columns[j][5]);
         break;
       case "IconLink":  
         FormatIcon(i);
         break;
       case "Image":  
         if (t.columns[j][5] == "") {
           ImageString=t.rows[i][t.columns[j][2]];
         }
         else {
           ImageString=t.columns[j][5] + t.rows[i][t.columns[j][2]] + ".gif"
         }
         TableString[TableString.length] = FormatImage(ImageString);
         break;
       case "Patient":   
         FormatPatientIcon(t.rows[i][t.columns[j][8]])
         TableString[TableString.length] = t.rows[i][t.columns[j][2]];
         if ( LinkFlag ) { TableString[TableString.length] = "</a>"; }
         break;
       default    :   
         if (j == STATUS_COL_NUM) {  // Claim Status column
           TableString[TableString.length] = "<span " +
            " style='display:inline-block;width:55px;vertical-align:text-top'>"+
             t.rows[i][t.columns[j][2]] + "</span>";

           if (bShowUpdtIcon) {
             LinkHref = t.rows[i][t.columns[j][6]];
             if (LinkHref != "") { 
               TableString[TableString.length] = "<a href=\"" +
                 LinkHref.replace(/\s*$/,"") + "\">"
               LinkFlag = 1;
             }
             FormatIcon(i);
           }
         }
         else {
           FormatIcon(i);
           TableString[TableString.length] = t.rows[i][t.columns[j][2]];
         }

         if ( LinkFlag ) { TableString[TableString.length] = "</a>"; }
         break;
       }
       if (isWhitespace(t.rows[i][t.columns[j][2]])) {
         TableString[TableString.length] = "&nbsp;" 
       }
       TableString[TableString.length] = "</td>" ;
     }
     TableString[TableString.length] = "</tr>" ;
   }
  }
}

</script>
