<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/patweb03.js"></script>
</head>
%START.OF.PAGE

<body onload="PageLoad(event);copyDisch(FIMForm);copyPrev(FIMForm);
      chgReadOnly(FIMForm);calcFIMScores(FIMForm);">
<span class=DFrameTitleBar>
  <img align="right" alt="Exit" class="MenuIcon"
   src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();" />
  <script type="text/javascript">
   var FIMType="%PATWEB03.09.110"
   if (FIMType == "A") {
       document.write('Admission FIM Scores'); }
   if (FIMType == "D") {
       document.write('Discharge FIM Scores'); }
   if (FIMType == "P") {
       document.write('Progress FIM Scores'); }
  </script>
 </span>

<div id=PageBodySection style="overflow: auto;">
 <form name="FIMForm" method="post" action="patweb03.pbl">
  <input type="hidden" name="reportno" value="09">
  <input type="hidden" name="template" value="002">
  <input type="hidden" name="updttype" value=" ">
  <input type="hidden" name="urnumber" value="%PATWEB03.09.003">
  <input type="hidden" name="admissno" value="%PATWEB03.09.081">
  <input type="hidden" name="ptfim001" value="%PATWEB03.09.081">
  <input type="hidden" name="ptfim004" value="%PATWEB03.09.110">
  <input type="hidden" name="ptfim062" value=" ">
  <input type="hidden" name="copydisc" value="%PATWEB03.09.113">
  <input type="hidden" name="chkdelet" value="%PATWEB03.09.114">
  <input type="hidden" name="copyprev" value="%PATWEB03.09.115">
  <input type="hidden" name="admexist" value="%PATWEB03.09.111">
  <input type="hidden" name="dscexist" value="%PATWEB03.09.112">
  <input type="hidden" name="admisdte" value="%PATWEB03.09.117">
  <input type="hidden" name="admistme" value="%PATWEB03.09.121.2">
  <input type="hidden" name="dischdte" value="%PATWEB03.09.122.3">
  <input type="hidden" name="dischtme" value="%PATWEB03.09.122.2">
  <input type="hidden" name="d_FIMtyp" value="%PATWEB03.09.110">

  <table align="center" width="97%" border="0">
   <tr><td class="DataLabel" id="title001">Admission Date</td>
       <td class="DataLabel">%PATWEB03.09.117</td>
       <td>&nbsp;</td>
       <td><img src="../images/SelectLink.gif" class=Icon align="right"
           onclick="DispNotes('FIM_Score_Notes');"></td></tr>

   <tr><td class="DataLabel" id="title002">Assessment Date</td>
       <td class="DataField">
           <input type="text" name="ptfim002" value="%PATWEB03.09.202"
                  title="Assessment Date" class="PastDate Mandatory"
                  onfocus="chkBlur(FIMForm);EnableValidation();">
           <img src="../images/DateLookup.gif" class="Icon" align="absmiddle"
                onclick="DateLookupFrame(FIMForm.ptfim002);"></td>
       <td class="DataLabel" id="title003">Time</td>
       <td class="DataField">
           <input type="text" name="ptfim003" value="%PATWEB03.09.203"
                  title="Time" class="Mandatory Time" 
                  onfocus="chkBlur(FIMForm);EnableValidation();">
           <img src="../images/DateTimeStamp.gif" class=Icon
                onclick="SetCurrentDateTime(FIMForm.ptfim002,FIMForm.ptfim003);">
           <img src="../images/TimeLookup.gif" class=Icon
                onclick="TimeLookupFrame(FIMForm.ptfim003);"></td></tr>

   <tr><td class="DataLabel">&nbsp;</td>
       <td class="Subheading" id="title004">Actual</td>
       <td class="Subheading" id="title005">Goal</td>
       <td class="Subheading" id="title006">Comments</td></tr>

   <tr><td class="DataLabel" id="title007">Eating</td>
       <td class="DataField"><input name="ptfim005"
           class="Mandatory Number" value="%PATWEB03.09.205"
           title="Eating Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);"></td>
       <td class="DataField"><input name="ptfim006" tabindex="-1"
           class=Number size="1" maxlength="1" value="%PATWEB03.09.206"
           title="Eating Goal"></td>
       <td class="DataField"><input type="text" name="ptfim007" tabindex="-1"
           size="50" maxlength="50" value="%PATWEB03.09.207"
           title="Eating Comments"></td></tr>

   <tr><td class="DataLabel" id="title008">Grooming</td>
       <td class="DataField"><input name="ptfim008"
           class="Mandatory Number" value="%PATWEB03.09.208"
           title="Grooming Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);"></td>
       <td class="DataField"><input name="ptfim009" tabindex="-1"
           class=Number size="1" maxlength="1" value="%PATWEB03.09.209"
           title="Grooming Goal"></td>
       <td class="DataField"><input type="text" name="ptfim010" tabindex="-1"
           size="50" maxlength="50" value="%PATWEB03.09.210"
           title="Grooming Comments"></td></tr>

   <tr><td class="DataLabel" id="title009">Bathing</td>
       <td class="DataField"><input name="ptfim011"
           class="Mandatory Number" value="%PATWEB03.09.211"
           title="Bathing Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);"></td>
       <td class="DataField"><input name="ptfim012" class=Number tabindex="-1"
           value="%PATWEB03.09.212" title="Bathing Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim013" tabindex="-1"
           value="%PATWEB03.09.213" title="Bathing Comments" size="5"
           maxlength="50"></td></tr>

   <tr><td class="DataLabel" id="title010">Dressing (Upper)</td>
       <td class="DataField"><input name="ptfim014"
           class="Mandatory Number" value="%PATWEB03.09.214"
           title="Dressing (Upper) Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);"></td>
       <td class="DataField"><input name="ptfim015" class=Number tabindex="-1"
           value="%PATWEB03.09.215" title="Dressing (Upper) Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim016" tabindex="-1"
           value="%PATWEB03.09.216" title="Dressing (Upper) Comments" size="50"
           maxlength="50"></td></tr>

   <tr><td class="DataLabel" id="title011">Dressing (Lower)</td>
       <td class="DataField"><input name="ptfim017"
           class="Mandatory Number" value="%PATWEB03.09.217"
           title="Dressing (Lower) Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);"></td>
       <td class="DataField"><input name="ptfim018" class=Number tabindex="-1"
           value="%PATWEB03.09.218" title="Dressing (Lower) Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim019" tabindex="-1"
           value="%PATWEB03.09.219" title="Dressing (Lower) Comments" size="50"
           maxlength="50"></td></tr>

   <tr><td class="DataLabel" id="title012">Toileting</td>
       <td class="DataField"><input name="ptfim020"
           class="Mandatory Number" value="%PATWEB03.09.220"
           title="Toileting Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);"></td>
       <td class="DataField"><input name="ptfim021" class=Number tabindex="-1"
           value="%PATWEB03.09.221" title="Toileting Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim022" tabindex="-1"
           value="%PATWEB03.09.222" title="Toileting Comments" size="50"
           maxlength="50"></td></tr>

   <tr><td class=SubHeading colspan=4 id="title013">SPHINCTER CONTROL</td></tr>

   <tr><td class="DataLabel" id="title014">Bladder</td>
       <td class="DataField"><input name="ptfim023"
           class="Mandatory Number" value="%PATWEB03.09.223"
           title="Bladder Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);"></td>
       <td class="DataField"><input name="ptfim024" class=Number tabindex="-1"
           value="%PATWEB03.09.224" title="Bladder Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim025" tabindex="-1"
           value="%PATWEB03.09.225" title="Bladder Comments" size="50"
           maxlength="50"></td></tr>

   <tr><td class="DataLabel" id="title015">Bowel</td>
       <td class="DataField"><input name="ptfim026"
           class="Mandatory Number" value="%PATWEB03.09.226"
           title="Bowel Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);"></td>
       <td class="DataField"><input name="ptfim027" class=Number tabindex="-1"
           value="%PATWEB03.09.227" title="Bowel Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim028" tabindex="-1"
           value="%PATWEB03.09.228" title="Bowel Comments" size="50"
           maxlength="50"></td></tr>

   <tr><td class=Subheading colspan=4 id="title016">TRANSFERS</td></tr>

   <tr><td class="DataLabel" id="title017">Bed/Chair/Wheelchair</td>
       <td class="DataField"><input name="ptfim029"
           class="Mandatory Number" value="%PATWEB03.09.229"
           title="Bed/Chair/Wheelchair Actual" size="1" maxlength="1"
           min="1" max="7" onblur="valFIMScores(FIMForm,this);"></td>
       <td class="DataField"><input name="ptfim030" class=Number tabindex="-1"
           value="%PATWEB03.09.230" title="Bed/Chair/Wheelchair Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim031" tabindex="-1"
           value="%PATWEB03.09.231" title="Bed/Chair/Wheelchair Comments"
           size="50" maxlength="50"></td></tr>

   <tr><td class="DataLabel" id="title018">Toilet</td>
       <td class="DataField"><input name="ptfim032"
           class="Mandatory Number" value="%PATWEB03.09.232"
           title="Toilet Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);"></td>
       <td class="DataField"><input name="ptfim033" class=Number tabindex="-1"
           value="%PATWEB03.09.233" title="Toilet Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim034" tabindex="-1"
           value="%PATWEB03.09.234" title="Toilet Comments" size="50"
           maxlength="50"></td></tr>

   <tr><td class="DataLabel" id="title019">Tub/Shower</td>
       <td class="DataField"><input name="ptfim035"
           class="Mandatory Number" value="%PATWEB03.09.235"
           title="Tub/Shower Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);"></td>
       <td class="DataField"><input name="ptfim036" class=Number tabindex="-1"
           value="%PATWEB03.09.236" title="Tub/Shower Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim037" tabindex="-1"
           value="%PATWEB03.09.237" title="Tub/Shower Comments" size="50"
           maxlength="50"></td></tr>

   <tr><td class="SubHeading" colspan="4" id="title020">LOCOMOTION</td></tr>

   <tr><td class="DataLabel" id="title021">%STANDARD.01.017.SM</td>
       <td><select name="ptfim038" title="%STANDARD.01.017.SM">
           <option></option>
             %PATWEB03.09.238.2
           </select></td>
       <td colspan="2">&nbsp;</td></tr>

   <tr><td class="DataLabel" id="title022">Locomotion Score</td>
       <td class="DataField"><input name="ptfim039"
           class="Mandatory Number" value="%PATWEB03.09.239"
           title="Locomotion Score Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);"></td>
       <td class="DataField"><input name="ptfim040" class=Number tabindex="-1"
           value="%PATWEB03.09.240" title="Locomotion Score Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim041" tabindex="-1"
           value="%PATWEB03.09.241" title="Locomotion Score Comments" size="50"
           maxlength="50"></td></tr>

   <tr><td class="DataLabel" id="title023">Stairs</td>
       <td class="DataField"><input name="ptfim042"
           class="Mandatory Number" value="%PATWEB03.09.242"
           title="Stairs Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);"></td>
       <td class="DataField"><input name="ptfim043" class=Number tabindex="-1"
           value="%PATWEB03.09.243" title="Stairs Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim044" tabindex="-1"
           value="%PATWEB03.09.244" title="Stairs Comments" size="50"
           maxlength="50"></td></tr>

   <tr><td class="SubHeading" colspan="4" id="title024">
           COMMUNICATION (A=Auditory, V=Visual, B=Both)</td></tr>

   <tr><td class="DataLabel">%STANDARD.01.017.SJ</td>
       <td><select name="ptfim045" title="%STANDARD.01.017.SJ">
           <option></option>
             %PATWEB03.09.245.2
           </select></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td class="DataLabel" id="title025">Comprehension Score</td>
       <td class="DataField"><input name="ptfim046"
           class="Mandatory Number" value="%PATWEB03.09.246"
           title="Comprehension Score Actual" size="1" maxlength="1"
           min="1" max="7" onblur="valFIMScores(FIMForm,this);" /></td>
       <td class="DataField"><input name="ptfim047" class=Number tabindex="-1"
           value="%PATWEB03.09.247" title="Comprehension Score Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim048" tabindex="-1"
           value="%PATWEB03.09.248" title="Comprehension Score Comments"
           size="50" maxlength="50"></td></tr>

   <tr><td class="DataLabel" id="title026">%STANDARD.01.017.SK</td>
       <td><select name="ptfim049" title="%STANDARD.01.017.SK">
           <option></option>
             %PATWEB03.09.249.2
           </select></td>
       <td colspan="2">&nbsp;</td></tr>

   <tr><td class="DataLabel" id="title027">Expression Score</td>
       <td class="DataField"><input name="ptfim050"
           class="Mandatory Number" value="%PATWEB03.09.250"
           title="Expression Score Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);" /></td>
       <td class="DataField"><input name="ptfim051" class=Number tabindex="-1"
           value="%PATWEB03.09.251" title="Expression Score Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim052" tabindex="-1"
           value="%PATWEB03.09.252" title="Expression Score Comments" size="50"
           maxlength="50"></td></tr>

   <tr><td class="SubHeading" colspan="4" id="title028">SOCIAL COGNITION</td></tr>

   <tr><td class="DataLabel">Social</td>
       <td class="DataField"><input name="ptfim053"
           class="Mandatory Number" value="%PATWEB03.09.253"
           title="Social Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);" /></td>
       <td class="DataField"><input name="ptfim054" class=Number tabindex="-1"
           value="%PATWEB03.09.254" title="Social Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim055" tabindex="-1"
           value="%PATWEB03.09.255" title="Social Comments" size="50"
           maxlength="50"></td></tr>

   <tr><td class="DataLabel" id="title029">Problem Solving</td>
       <td class="DataField"><input name="ptfim056"
           class="Mandatory Number" value="%PATWEB03.09.256"
           title="Problem Solving Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);" /></td>
       <td class="DataField"><input name="ptfim057" class=Number tabindex="-1"
           value="%PATWEB03.09.257" title="Problem Solving Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim058" tabindex="-1"
           value="%PATWEB03.09.258" title="Problem Solving Comments" size="50"
           maxlength="50"></td></tr>

   <tr><td class="DataLabel" id="title030">Memory</td>
       <td class="DataField"><input name="ptfim059"
           class="Mandatory Number" value="%PATWEB03.09.259"
           title="Memory Actual" size="1" maxlength="1" min="1" max="7"
           onblur="valFIMScores(FIMForm,this);"></td>
       <td class="DataField"><input name="ptfim060" class=Number tabindex="-1"
           value="%PATWEB03.09.260" title="Memory Goal" size="1"
           maxlength="1"></td>
       <td class="DataField"><input type="text" name="ptfim061" tabindex="-1"
           value="%PATWEB03.09.261" title="Memory Comments" size="50"
           maxlength="50"></td></tr>

   <tr><td class="Subheading" id="title031">Motor Sub Score</td>
       <td class="DataField"><input class="ReadOnly" title="Motor Sub Score"
           name="MSTotal" size="3" maxlength="3" tabindex="-1"
           onfocus="this.blur();"></td>
       <td colspan="2">&nbsp;</td></tr>

   <tr><td class="Subheading" id="title032">Cognitive Sub Score</td>
       <td class="DataField"><input class="ReadOnly" title="Cognitive Sub Score"
           name="CSTotal" size="3" maxlength="3" tabindex="-1"
           onfocus="this.blur();"></td>
       <td colspan="2">&nbsp;</td></tr>

   <tr><td class="Subheading" id="title033"> FIM Total</td>
       <td class="DataField">

       <input class="ReadOnly" title=" FIM Total" name="FIMTotal" size="3"
        maxlength="3" tabindex="-1" onfocus="this.blur();" id="FIMlabel"></td>
       <td colspan="2">&nbsp;</td></tr>

   <tr><td colspan="4" align="center"><hr></td></tr>

   <tr><td class="DataLabel" id="title034">Assessment Only</td>
       <td class=DataItem><input type="checkbox" name="d_ptfim062"
           title="Assessment Only" value="1"></td>
       <td class="DataLabel">Assessor</td>
       <td nowrap><input type="text" size="10" maxlength="10" name="ptfim063" id=ptfim063
            title="Assessor Code" value="%PATWEB03.09.263.1"
            onblur="UpCase(this); ValidateHCP(18,0,ptfim063,d_ptfim063);
            showPass(FIMForm)">
           <input type="text" readonly size="50" name="d_ptfim063" id=d_ptfim063
            value="%PATWEB03.09.263.0">
           <img notab src="../images/SearchIcon.gif" class=Icon
            onclick="HCPSearchFrame(FIMForm.ptfim063,FIMForm.d_ptfim063,0)">
           <img src="../images/erase.gif" class=Icon
            onclick="clrFields(FIMForm.ptfim063,FIMForm.d_ptfim063);"></td></tr>

   <tr><td class="DataLabel" id="title035">%STANDARD.01.017.ad</td>
       <td colspan="3">
           <select name="ptfim064" title="%STANDARD.01.017.ad">
             <option></option>
               %PATWEB03.09.264.2
           </select></td></tr>

   <tr><td class="DataLabel" id="title036">Nurse</td>
       <td colspan="3"><input type="text" size="10" maxlength="10"
        name="ptfim065" id=ptfim065 title="Nurse Code" value="%PATWEB03.09.265.1"
        onblur="UpCase(this); validateNurse(ptfim065,d_ptfim065);showPass(FIMForm)">
       <input type="text" readonly size="60" notab name="d_ptfim065" id=d_ptfim065
         value="%PATWEB03.09.265.0">
       <img notab src="../images/SearchIcon.gif" class=Icon
        onclick="NurseSearchFrame(FIMForm.ptfim065,FIMForm.d_ptfim065)">
       <img src="../images/erase.gif" class=Icon
        onclick="clrFields(FIMForm.ptfim065,FIMForm.d_ptfim065);"></td></tr>

   <tr><td class="DataLabel" id="title037">Physiotherapist</td>
       <td colspan="3"><input type="text" size="10" maxlength="10"
            name="ptfim069" id=ptfim069 title="Physiotherapist" value="%PATWEB03.09.269.1"
            onblur="UpCase(this); ValidateHCP(18,0,ptfim069,d_ptfim069);
                   showPass(FIMForm)">
           <input type="text" readonly size="60" notab name="d_ptfim069" id=d_ptfim069
                  value="%PATWEB03.09.269.0">
            <img notab src="../images/SearchIcon.gif" class=Icon
                 onclick="HCPSearchFrame(FIMForm.ptfim069,FIMForm.d_ptfim069,0)">
            <img src="../images/erase.gif" class=Icon
                 onclick="clrFields(FIMForm.ptfim069,FIMForm.d_ptfim069);"></td></tr>

   <tr><td class="DataLabel" id="title038">Occupational Therapist</td>
       <td colspan="3"><input type="text" size="10" maxlength="10"
           name="ptfim072" id=ptfim072 title="Occupational Therapist"
           value="%PATWEB03.09.272.1" onblur="UpCase(this);
                  ValidateHCP(18,0,ptfim072,d_ptfim072);showPass(FIMForm)">
           <input type="text" readonly size="60" notab name="d_ptfim072" id=d_ptfim072
                  value="%PATWEB03.09.272.0">
            <img notab src="../images/SearchIcon.gif" class=Icon
                 onclick="HCPSearchFrame(FIMForm.ptfim072,FIMForm.d_ptfim072,0)">
            <img src="../images/erase.gif" class=Icon
                 onclick="clrFields(FIMForm.ptfim072,FIMForm.d_ptfim072);"></td></tr>

   <tr><td><div id="UserNameHead"></div></td>
       <td><div id="UserNameCode"></div></td>
       <td><div id="PasswordHead"></div></td>
       <td><div id="PasswordCode"></div></td></tr>

   <tr><td colspan="4" align="center"><br>
        <input type="button" value="Ok" class="button"
               onclick="submitFIM(FIMForm);">
        <span id="DeleteButton" style="display: none">
         <input type="button" value="Delete" class="button"
                onclick="Delete(FIMForm);">
        </span>
        <input type="button" value="Cancel" class="button"
               onclick="DFrameCloseRefresh();">
       </td></tr>

  </table>
 </form>

<span id="usernamehd" style="display:none">
 <td class="DataLabel">User Name</td>
</span>

<span id="usernamcd" style="display:none">
 <td><input size="12" type="text" name="username" class=ReadOnly title="UserName"
            readOnly value="%STANDARD.01.043" onfocus="this.blur();"></td>
</span>

<span id="passwordhd" style="display:none">
 <td class="DataLabel">Password</td>
</span>

<span id="passwordcd" style="display:none">
 <td><input size="12" type="password" name="password" class=Mandatory
            title="Password" onchange="checkPass(FIMForm);"></td>
</span>

<script type="text/javascript">

var elAssesDate = document.FIMForm.ptfim002;
var elAssesTime = document.FIMForm.ptfim003;
var bEnableValidation = false;

if(document.FIMForm.d_FIMtyp.value == "A") {

document.getElementById("FIMlabel").title = "Admission FIM Total";
document.getElementById("title033").innerHTML = "Admission FIM Total";

}
if (document.FIMForm.d_FIMtyp.value == "D"){

document.getElementById("FIMlabel").title = "Discharge FIM Total";
document.getElementById("title033").innerHTML = "Discharge FIM Total";

}
if (document.FIMForm.d_FIMtyp.value == "P"){

document.getElementById("FIMlabel").title = "Progress FIM Total";
document.getElementById("title033").innerHTML = "Progress FIM Total";

}

if (elAssesDate && elAssesDate.addEventListener) {
  elAssesDate.addEventListener("blur", function(){setTimeout(ValidateDateTime, 25)}, false);
  elAssesTime.addEventListener("blur", function(){setTimeout(ValidateDateTime, 25)}, false);
}
else {
  elAssesDate.attachEvent("onblur", function(){setTimeout(ValidateDateTime,25)});
  elAssesTime.attachEvent("onblur", function(){setTimeout(ValidateDateTime,25)});
}


if ("%PATWEB03.09.262" == "1") {
  document.FIMForm.d_ptfim062.checked="1"; 
}

if (! "%PATWEB03.09.202" == "") {
  DeleteButton.style.display="";
  document.FIMForm.updttype.value="U"; 
}
else {
  document.FIMForm.updttype.value="A"; 
}

function EnableValidation() {
  if (!bEnableValidation)
    bEnableValidation = true;
}

function ValidateDateTime()
{
  if ( !bEnableValidation || document.FIMForm.ptfim002.value == "" || 
       document.FIMForm.ptfim003.value == "" ) {
    return;
  }

  var FIMType="%PATWEB03.09.110";

  if (!ValidateAdmisDate()) {
    return;
  }

  if (!ValidateDischDate()) {
    return;
  }

  if (FIMType == "A") {
    ValidateAdmPeriod();
  }
  if (FIMType == "D") {
    ValidateDisPeriod();
  }
}

function ClearDateFields() {
  document.FIMForm.ptfim002.value = "";
  document.FIMForm.ptfim003.value = "";
  document.FIMForm.ptfim002.focus();
}

function ValidateAdmisDate() {
  // validates assessment date/time against admission date/time
  var assDate = GetDateObj(document.FIMForm.ptfim002.value,
                          document.FIMForm.ptfim003.value);

  var admDate = GetDateObj(document.FIMForm.admisdte.value,
                          document.FIMForm.admistme.value);

  if (assDate == null || admDate == null)
    return true;

  if (assDate < admDate) {
    alert("Error: Assessment date/time is before the admission date/time.");
    ClearDateFields();
    bEnableValidation = false;
    return false;
  }

  return true;  // success
}

function ValidateDischDate() {
  // validates assessment date/time against discharge date/time
  var assDate = GetDateObj(document.FIMForm.ptfim002.value,
                          document.FIMForm.ptfim003.value);

  var disDate = GetDateObj(document.FIMForm.dischdte.value,
                          document.FIMForm.dischtme.value);

  if (assDate == null || disDate == null)
    return true;

  if (assDate > disDate) {
    alert("Error: Assessment date/time is after the discharge date/time.");
    ClearDateFields();
    bEnableValidation = false;
    return false;
  }

  return true;  // success
}

function ValidateAdmPeriod() {
  // Validates if Assessment date/time is within 72 hrs from Admission date/time

  var timeDiff = 0;  // time difference b/n the 2 dates (milliseconds)
  var period = (60*60*24)*3*1000;  // 72 hrs in milliseconds
  var bOK = true;

  // set up admisison date obj
  var admDate  = GetDateObj(document.FIMForm.admisdte.value, 
                            document.FIMForm.admistme.value);

  // set up assessment date obj
  var assDate = GetDateObj(document.FIMForm.ptfim002.value,
                           document.FIMForm.ptfim003.value);

  if (assDate == null || admDate == null)
    return true;

  timeDiff = assDate.getTime() - admDate.getTime();

  if (timeDiff > period) {
    bOK = confirm("Warning - Admission FIM Assessment not within 72 hrs of admission. OK to continue?");
  }

  if (!bOK) {
    ClearDateFields();
  }
  else {
    document.FIMForm.ptfim005.focus();  // focus on 1st FIM score field
  }

  bEnableValidation = false;
  return bOK;
}

function ValidateDisPeriod() {
  // Validates if Assessment date/time is within 72 hrs from Discharge date/time

  var timeDiff = 0;  // time difference b/n the 2 dates (milliseconds)
  var period = (60*60*24)*3*1000;  // 72 hrs in milliseconds
  var bOK = true;

  // set up assessment date obj
  var assDate  = GetDateObj(document.FIMForm.ptfim002.value,
                            document.FIMForm.ptfim003.value);

  // set up discharge date obj
  var disDate = GetDateObj(document.FIMForm.dischdte.value,
                           document.FIMForm.dischtme.value);

  if (assDate == null || disDate == null)
    return true;

  timeDiff = disDate.getTime() - assDate.getTime();

  if (timeDiff > period) {
    bOK = confirm("Warning - Discharge FIM Assessment not within 72 hrs prior to discharge. OK to continue?");
  }

  if (!bOK) {
    ClearDateFields();
  }
  else {
    document.FIMForm.ptfim005.focus();  // focus on 1st FIM score field
  }

  bEnableValidation = false;
  return bOK;
}
</script>

</div>
