<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/patweb90.js"></script>
<script type="text/javascript" src="../js/patweb69.js"></script>
<script type="text/javascript">
function getPatientSearch2Cookie() {
  if (GetCookieData("PatientSearch2Cookie")!="unknown") {
    document.search.PtSrCkie.value = GetCookieData("PatientSearch2Cookie");
    ExpireCookiePath("PatientSearch2Cookie");
  }
}
function newRegistration() {
  document.Registration.emexp001.value=top.content.UpdateForm.emexp001.value;
  document.Registration.srchsnam.value=document.search.srchsnam.value;
  document.Registration.srchgnam.value=document.search.srchgnam.value;
  document.Registration.srchpage.value=document.search.srchpage.value;
  document.Registration.srchpdob.value=document.search.srchpdob.value;
  document.Registration.srchpsex.value=" ";
  if(document.search.srchpsex[1].checked==true) {
     document.Registration.srchpsex.value="M";
   }
  if(document.search.srchpsex[2].checked==true) {
     document.Registration.srchpsex.value="F";
  }
  document.Registration.submit();
} 
//
function updateParent(Name,urnumber,admissno) {
  ans=confirm("Allocate to Emergency Registration" +
              "\nU/R " + urnumber + 
              "\nName  " + Name )
  if (ans) {
    top.content.UpdateForm.emexp018.value=urnumber
    if (document.search.PtSrCkie.value=="1") {
      if(top.content.PatientReturnWA()) {
        if ( (top.menu.EmergencyFrameLink != undefined) &&
             (top.TogglePanel != undefined) ) {
          top.TogglePanel();       // Emergency Map 
        } else {
          DFrameExit()
        }
      }
    } else {
      if(top.content.PatientReturnAU()) {
        if ( (top.menu.EmergencyFrameLink != undefined) &&
             (top.TogglePanel != undefined) ) {
          top.TogglePanel();       // Emergency Map 
        } else {
          DFrameExit()
        }
      }
    }
    
  }
}
//----------------------------------------------------------------
// Function to ignore Enter key when doing urnumber/DOB search 
//----------------------------------------------------------------
function onKeyDown() {
  if ( (event.keyCode == 13) && (event.srcElement.name=="urnumber") ) {
     event.keyCode = 0;
     event.returnValue = false; }
}
function setURNumber(urnumber) {
  if(document.search.aisearch.value>1){
    return;}
  if (isWhitespace(urnumber)){ return;}
  p=document.search
  justifyRight(p.urnumber)
  if (validateCode(8,p.urnumber,p.test,p.dum1,p.dum2,p.dum3)) {

    ans=confirm("Allocate to Emergency Registration - " + p.test.value +
                "\nU/R : " + trim(urnumber) + 
                "\nDOB : " + trim(p.dum2.value) + 
                "\nSEX : " + trim(p.dum1.value) ) 
    if (ans) {
      top.content.UpdateForm.emexp018.value=urnumber
      if (document.search.PtSrCkie.value=="1") {
        if(top.content.PatientReturnWA()) {
            DFrameExitRefresh()
        }
      } else {
        if(top.content.PatientReturnAU()) {
            DFrameExitRefresh()
        }
      }
    }
    else {
      search.urnumber.value="";
      search.template.value="060";
    }
  }
  else {
    search.urnumber.value="";
    search.template.value="060";
  }
}
function ProcessSubmit() {
  var p = document.search;
  if (p.ptcnuepm.value == "1") {
    p.showblhd.value = "1";  // show LHD search button on submit return
  }

  setUR();
  setBirth(p.srchpdob);
  UpCase(p.srchsnam);
  SetCookie("PatientSearch2Cookie",p.PtSrCkie.value);
  return true;
}
function checkbirthdate() {
 if(checkDate(document.search.srchpdob,'Date of Birth')) {
    setBirth(document.search.srchpdob);
    }
  else {
    document.search.srchpdob.value="          ";
    document.search.srchpdob.focus();
  }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);setUR();setTimeout('setDefault()',100);
              getPatientSearch2Cookie();">
<div id=PatientHeading></div>
<!--
<div id=PatientMenu></div>
-->
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit()">
Emergency Registration Patient Search
</span>

<form name=search method=get action=patweb90.pbl style="margin:0"
 onsubmit="return ProcessSubmit();;">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=060>
<input type=hidden name=norecord value="%PATWEB90.01.032">
<input type=hidden name=test> 
<input type=hidden name=dum> 
<input type=hidden name=dum1> 
<input type=hidden name=dum2> 
<input type=hidden name=dum3> 
<input type=hidden name=ptcnualt value="%PATWEB90.01.023">
<input type=hidden name=alternid value="">
<input type=hidden name=aisearch value="">
<input type=hidden name=redirect value="patweb98.pbl?reportno=1&template=001">
<input type=hidden name=PtSrCkie value="">
<input type=hidden name=ptcnuepm value="%STANDARD.01.025.125.155.0.1">
<input type=hidden name=showblhd value="%PATWEB90.01.036">

<table align="center" width=100% border=1 cellspacing=0 
 cellpadding=0 bgcolor=#CCCCCC>
<tr><td>
<table width=100% border=0 cellpadding=0 cellspacing=0 bgcolor=#CCCCCC>
<tr><td class=DataLabel>Surname<br>
    <input type=text name=srchsnam size=15 tabindex=1
     onblur="UpCase(this);TextBlurHandler(this);"></td>
    <td class=DataLabel>Given Name<br>
    <input type=text name=srchgnam size=15 tabindex=2
     onblur="UpCase(this);TextBlurHandler(this);"></td>
    <td class=DataLabel>U/R Number<br>
    <input type=text name=urnumber maxlength=8 size=10 tabindex=3
     onblur="setUR();setURNumber(this.value);"></td>
    <td class=DataLabel>Medicare No.<br>
    <input type=text name=srchmedi maxlength=17 size=12 tabindex=4
     value="%PATWEB90.01.016"
     onblur="setMedicare(this);"></td>


<td rowspan=2>
    <input type=radio name=srchpsex value=" " checked tabindex=9> All <br>
    <input type=radio name=srchpsex value="M"> Male <br>
    <input type=radio name=srchpsex value="F"> Female</td>
    <td align=center valign=middle rowspan=2>
    <input type=submit value=Search class="button" tabindex=10><br>
    <span id=spLHDSrchBtn></span>
    <input type=reset value=Reset class="button" 
     onclick='SetCookie("PatientSearch2Cookie",document.search.PtSrCkie.value);
              location.href="patweb90.pbl?reportno=1&template=060&nodetail=R"'>
    </td></tr>
<tr><td class=DataLabel>Date of Birth<br>
       <input type="text" size="12" name="srchpdob" tabindex=5
       onchange="checkbirthdate();"></td>
    <td>Age<br>
       <input type=text name=srchpage class="JustifyLeft Integer" 
         size=4 tabindex=6 title="Age"></td>
    <td class=DataLabel>Range<br>
       <select name=srcharan tabindex=7 > 
       <option value=2 selected>2 years</option>
       <option value=4>4 years</option>
       <option value=6>6 years</option>
       <option value=8>8 years</option>
       <option value=10>10 years</option>
       </select></td>
    <td class=DataLabel colspan=2>Search Type<br>
       <select name=srchtype tabindex=8 onchange="checkType();">
       <option value=1>Surname</option>
       <option value=2>Sound-Ex</option>
       <option value=3>Date of Birth</option>
       <option value=4>U/R Number</option>
       <option value=5>Medicare No</option>
       <option value=6>Sound-Ex(Strict Given)</option>
       </select></td></tr>
</table>
%PATWEB90.01.011.300.0
<table width=100% border=1 cellspacing=0 cellpadding=0>
  <tr><td>
  <table width=100% bgcolor=#CCCCCC><tr>
     <td align=center>
     <input type=button value="<< Previous" class="button"
      onclick='location.href="%PATWEB90.01.002.060"'></td>
     <td align=center width=20%><div id=RegOption></div></td>
     <td align=center>
     <input type=button value="Next >>" class="button"
     onclick='location.href="%PATWEB90.01.001.060"'>
  </td></tr>
  </table>
</td></tr>
</table>
</td></tr>
</table>
</form>

<form name=Registration method=get action=patweb89.pbl>
<input type=hidden name=reportno value=05>
<input type=hidden name=template value=3>
<input type=hidden name=admissno value="%PATWEB90.01.013">
<input type=hidden name=srchsnam value="">
<input type=hidden name=srchgnam value="">
<input type=hidden name=srchpdob value="">
<input type=hidden name=srchpage value="">
<input type=hidden name=srchpsex value="">
<input type=hidden name=emexp001 value="">
</form>

<form name=linkForm action=patweb98.pbl method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=060>
<input type=hidden name=urnumber value="">
<input type=hidden name=admissno value="">
<input type=hidden name=nodetail value="%PATWEB90.01.022">
</form>

<div id=YesReg style="display:none">
  <input type=button value="New Registration" class="Bigbutton"
   onclick="newRegistration()">
</div>

<span id=NewReg style="display:none">
  <input type=button value="New Registration" class="Bigbutton"
   onclick="newRegistration();">
</span>

<span id=spLHDSrch style="display:none">
  <input type=button value="%PATWEB90.01.035" class="button"
   onclick="LHDSearchFrame('RegOption','NewReg','patweb90.pbl?reportno=1&template=060');"><br>
</span>

<script type="text/javascript">
function setDefault() {
  if (document.all.BodyDivision!=undefined) {
     BodyDivision.style.height=document.body.clientHeight - 86 -
                               BodyDivision.offsetTop
  }
  if(document.search.ptcnualt.value=="1"){
    document.search.urnumber.maxLength=20;
    document.search.urnumber.size=20;
  }
  if (document.linkForm.nodetail.value == "R") { return;}

   document.search.srchsnam.value="%PATWEB90.01.003";
   if (document.search.ptcnuepm.value == "1") {
     if (document.search.showblhd.value == "1") {
       document.getElementById('spLHDSrchBtn').innerHTML =
        document.getElementById('spLHDSrch').innerHTML;
     }
     else {
       document.getElementById('spLHDSrchBtn').innerHTML = "";
     }
   }
   else if (top.content.location.search.substring(1,24)!="reportno=2&template=010")
   {
     ind=document.search.srchsnam.value;
     if (ind !="") {
      RegOption.innerHTML=YesReg.innerHTML;
     } else {
      RegOption.innerHTML="";
     }
   }
   if (isWhitespace(document.search.srchsnam.value)){
     document.search.srchsnam.value=trim(top.content.UpdateForm.emexp002.value)
   }
   document.search.srchgnam.value="%PATWEB90.01.004";
   if (isWhitespace(document.search.srchgnam.value)){
     document.search.srchgnam.value=trim(top.content.UpdateForm.emexp003.value)
   }
   document.search.srchpage.value="%PATWEB90.01.006";
   document.search.srchpdob.value="%PATWEB90.01.007";
//
   if (isWhitespace(document.search.srchpdob.value)){
     document.search.srchpdob.value=trim(top.content.UpdateForm.emexp005.value)
   }
//
   for (var i =0 ; i < document.search.srcharan.length; i++) {
     if (document.search.srcharan.options[i].value==trim("%PATWEB90.01.008")) {
         document.search.srcharan.selectedIndex=i } };

   for (var i =0 ; i < document.search.srchtype.length; i++) {
     if (document.search.srchtype.options[i].value=="%PATWEB90.01.009.2") {
         document.search.srchtype.selectedIndex=i; 
         checkType(); }  };

   if (document.search.ptcnuepm.value == "1") {
     document.search.srchmedi.value="%PATWEB90.01.016";

     for (var i =0 ; i < document.search.srchpsex.length; i++) {
       if (document.search.srchpsex[i].value=="%PATWEB90.01.005") {
         document.search.srchpsex[i].checked="1" } };
   }

// STV request, do not default sex from triage - always default to all
// document.search.srchpsex.value=trim(top.content.UpdateForm.searchps.value)
// for (var i =0 ; i < document.search.srchpsex.length; i++) {
//   if (document.search.srchpsex[i].value==
//       top.content.UpdateForm.searchps.value.substr(0,1)) {
//       document.search.srchpsex[i].checked="1" } };
//
//  document.linkForm.admissno.value=top.content.PatientLinks.admissno.value;
//  document.PatientLinks.admissno.value=top.content.PatientLinks.admissno.value;
}
</script>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=urnumber>
<input type=hidden name=admissno>
<input type=hidden name=MenuType value="11">
</form>
