<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript" src="../js/mrtweb04.js"></script>
<script type="text/javascript" src="../js/MrtHomeLocns.js"></script>
<script type="text/javascript" src="../js/MrtMultiHomeLocns.js"></script>
<script type="text/javascript" src="../js/MrtLocations.js"></script>
<script type="text/javascript" src="../js/MrtMultiLocations.js"></script>
<script type="text/javascript">
function verifyDates()
{
  if (!isWhitespace(document.AddForm.mrtme007.value))
  {
    var d1 = new Date(document.AddForm.mrtme001.value);
    var d7 = new Date(document.AddForm.mrtme007.value);
    if (d7 < d1) 
    {
      alert("Due Date cannot be earlier than \n Movement  Date: "
            + document.AddForm.mrtme001.value); 
      document.AddForm.mrtme007.focus();
      return false;
    }
  } 
    
  p=document.AddForm
  p.redirect.value="mrtweb04.pbl?reportno=05&template=001" +
                   "&superlev=" + p.superlev.value.replace(/ /g,"+")
  SubMov(); // dates OK, so submit form
}

function SetReqA() {
  SetHomeHosp(SendForm);
  selectHHosp(SendForm);
  SetHomeLocn(SendForm);
  SetHospital(AddForm);
  SetDestination(AddForm);
  SetReq();
}
function CheckLocType() {
 if (document.AddForm.superlev.value=="2") {
  if(!isWhitespace(document.AddForm.mrtme003.value))
  {
    var locationfield1 = document.getElementById("locationtype1");
    var locationdata1 = document.getElementById("locationdesc1");
    var locationfield2 = document.getElementById("locationtype2");
    var locationdata2 = document.getElementById("locationdesc2");

    var serverURL = "../cgi-bin/mrtweb04.pbl?reportno=4" +
            "&updttype=1" +
            "&homeloct=" + document.SendForm.homeloct.value.replace(/ /g,"+") +
            "&homehosp=" + document.SendForm.homehosp.value.replace(/ /g,"+") +
            "&urnumber=" + document.SendForm.urnumber.value.replace(/ /g,"+") +
            "&docmtype=" + document.SendForm.docmtype.value.replace(/ /g,"+") +
            "&volumeno=" + document.SendForm.volumeno.value.replace(/ /g,"+") +
            "&desthosp=" + document.AddForm.mrtme019.value.replace(/ /g,"+") +
            "&location=" + document.AddForm.mrtme003.value.replace(/ /g,"+")

    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
     ReturnValue=returnValue.return_value.split("|")
     if((!isWhitespace(ReturnValue[0]))) {
        locationfield1.innerHTML=trim(ReturnValue[0]);
        locationfield2.innerHTML=trim(ReturnValue[0]);

        locationdata1.innerHTML=trim(ReturnValue[2]);
        if(trim(ReturnValue[1])=="V") {
          locationdata2.innerHTML=InputVol.innerHTML;
          document.AddForm.mrtms005.value=trim(ReturnValue[2]);
        } else {
          if(trim(ReturnValue[1])=="M") {
            locationdata2.innerHTML=InputFilm.innerHTML;
            document.AddForm.mrtms007.value=trim(ReturnValue[2]);
          } else {
            locationdata1.innerHTML="";
            document.AddForm.mrtms005.value="";
            document.AddForm.mrtms007.value="";
          }
        }
        return;
     }
    }
  locationfield1.innerHTML="";
  locationfield2.innerHTML="";
  locationdata1.innerHTML="";
  locationdata2.innerHTML="";
  }
 }
}

function ClearDest() {
  var locationfield1 = document.getElementById("locationtype1");
  var locationfield2 = document.getElementById("locationtype2");
  locationfield1.innerHTML="";
  locationfield2.innerHTML="";
  ClearComment();
}
function ClearComment() {
  var locationdata1 = document.getElementById("locationdesc1");
  var locationdata2 = document.getElementById("locationdesc2");
  locationdata1.innerHTML="";
  locationdata2.innerHTML="";
  if(document.AddForm.mrtms007 != undefined ) {
   document.AddForm.mrtms007.value="";
  }
  if(document.AddForm.mrtms005 != undefined ) {
   document.AddForm.mrtms005.value="";
  }
}

//----------------------------------------------------------------------------
// Columns Available
//  0 - HTML Link
//  1 - Movement Date & Time
//  2 - Due Date & Time
//  3 - Location
//  4 - Requested By
//  5 - Reason
//  6 - Web User
//  7 - Status
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
  case 0: {
    document.title="Movement History"
    if(document.SendForm.mrcntrec.value!="1") {
      t = new Table(1,0,2,"100%","center",35,45);
      t.addColumn("Movement Date","DateTime",1,1,"left","","",115)
      t.addColumn("Due Date","Date",2,2,"left","","",55)
      t.addColumn("Location","String",3,3,"left","","",115)
      t.addColumn("Requested By","String",4,4,"left","","",77)
      t.addColumn("Reason","String",5,5,"left","","",90)
      t.addColumn("Movement Comment","String",8,8,"left","","",140)
      t.addColumn("Moved by User","String",6,6,"left","","",77)
      AddTableRows()
      TableOutput(0,2);    // Order Column,Asc Dsc
    } else {
      t = new Table(1,0,2,"100%","center",35,45);
      t.addColumn("Movement Date","DateTime",1,1,"left","","",115)
      t.addColumn("Due Date","Date",2,2,"left","","",70)
      t.addColumn("Location","String",3,3,"left","","",60)
//
      t.addColumn("Receipt Status","String",9,9,"left","","",60)
      t.addColumn("Receipt Date","DateTime",10,10,"left","","",70)
      t.addColumn("Received By","String",11,11,"left","","",60)
//
      t.addColumn("Requested By","String",4,4,"left","","",50)
      t.addColumn("Reason","String",5,5,"left","","",55)
      t.addColumn("Movement Comment","String",8,8,"left","","",50)
      t.addColumn("Moved by User","String",6,6,"left","","",50)
      AddTableRows()
      TableOutput(0,2);    // Order Column,Asc Dsc
    }
    break; }
  }
}

</script>
</head>
<body onload="PageLoad(event);SetForm();setTimeout('SetReqA()',100);setTimeout('InitTable(0)',200);">
%START.OF.PAGE
<div id="HeadingSection">
<form name=SendForm method=post action=mrtweb04.pbl style="margin:0">
<input type=hidden name=reportno value="5">
<input type=hidden name=template value="001">
<input type=hidden name=updttype value="L">
<input type=hidden name=nextpage value="">
<input type=hidden name=medrecky value="">
<input type=hidden name=mrcnlzer value="%STANDARD.01.025.097.168.0.1">
<input type=hidden name=mrcnibap value="%STANDARD.01.025.097.165.0.1">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=wbsehosp value="%STANDARD.01.032">
<input type=hidden name=homehosp value="%MRTWEB04.05.114.2">
<input type=hidden name=homeloct value="%MRTWEB04.05.114.3">
<input type=hidden name=superlev value="%MRTWEB04.05.117">
<input type=hidden name=mrcntrec value="%STANDARD.01.025.097.176.0.1">

<table border=0 align=center width=100% cellpadding=0 cellspacing=0> 
<tr><td class=HeadingCell align=center>
Single Record Movement
</td></tr>
</table>

<table border=0 align=center width=90% cellpadding=1> 
<tr><td width=15%>Document Type</td>
    <td width=40%>
    <select name=docmtype id=docmtype class=Mandatory title="Document Type">
    <option></option>
    %MRTWEB04.05.102.2
    </select>
    </td>
    <td width=15% class=DataLabel>Name</td>
    <td class=DataField>%MRTWEB04.05.010 %MRTWEB04.05.009</td></tr>

<tr><td class=DataLabel><div id=HomeHospTitle></div></td>
    <td><div id=HomeHosp></div></td>

    <td>Address</td>
    <td class=DataField>%MRTWEB04.05.012</td></tr>

<tr><td>Home Location</td>
    <td><select name=mrtme017 id=mrtme017 class=Mandatory title="Home Location"
         onchange="ResetHomeLocn();">
    <option></option>
    </select>
    </td>

    <td>&nbsp;</td>
    <td class=DataField>%MRTWEB04.05.013</td></tr>

<tr><td>U/R Number</td>                                     
    <td><input type=text name=urnumber id=urnumber title="UR"
         value="%MRTWEB04.05.103" 
               onfocus="ClearVol();ClearComment();"
               onkeyDown="SetUrEvent();">
        <input type=hidden name=patname id=patname>
        <input type=hidden name=d2 id=d2>
        <input type=hidden name=Merged id=Merged>
        <input type=hidden name=Mergedur id=Mergedur>
        <input type=hidden name=mrrecord id=mrrecord>
        <img src=../images/SearchIcon.gif class=Icon notab  
         onclick="SearchPatient();">

        <img src="../images/erase.gif" alt="Clear" class="Icon"
      onclick='clrFields(AddForm.urnumber,AddForm.medrecky,SendForm.urnumber,
                         SendForm.medrecky);'>
    </td>
    <td></td><td class=DataField>%MRTWEB04.05.014</td></tr>

<tr><td>Medical Record Scan</td><td>
       <input type=text name=RecordKey id=RecordKey
         maxlength=22 size=27 tabindex=-1
         onfocus="CheckMaxLength(this);" notab
         onkeyDown="SetMedEvent();" title="Record Key">
    </td>
    <td></td><td class=DataField>%MRTWEB04.05.015 %MRTWEB04.05.016</td></tr>

<tr><td>Volume</td>
    <td><select name=volumeno id=volumeno title="Volume"
      onchange="setvol(this);"> 
     <option></option>
     %MRTWEB04.05.104
    </select> 
    </td>
    <td><div id=locationtype1></div></td>
    <td><div id=locationdesc1></div></td>
</tr>

<tr><td colspan=4 align=center><hr width=80%></td></tr>

</table>
</form>

<form name=AddForm method=post action=mrtweb04.pbl style="margin:0">
<input type=hidden name=reportno value="5">
<input type=hidden name=template value="001">
<input type=hidden name=updttype value="A">
<input type=hidden name=nextpage value="5">
<input type=hidden name=redirect value="mrtweb04.pbl?reportno=5&template=1">
<input type=hidden name=volumeno>
<input type=hidden name=medrecky value="%MRTWEB04.05.109">
<input type=hidden name=urnumber value="%MRTWEB04.05.003">
<input type=hidden name=filreqed value="%MRTWEB04.05.085.051">
<input type=hidden name=requtype value="%MRTWEB04.05.111">
<input type=hidden name=mrcnwnhl value="%MRTWEB04.05.113">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=wbsehosp value="%STANDARD.01.032">
<input type=hidden name=desthosp value="%MRTWEB04.05.114.0">
<input type=hidden name=destlocn value="   ">
<input type=hidden name=superlev value="%MRTWEB04.05.117">

<table border=0 align=center width=90% cellpadding=1> 
<tr><td width=15% class=DataLabel>Movement Date</td>
    <td width=40%><input type=text size=12 name=mrtme001 id=mrtme001
         class="Mandatory Date" title="Movement Date" value="%STANDARD.01.015">
         <img notab src=../images/DateLookup.gif class=Icon
          onclick="DateLookupFrame(mrtme001);"> 
                                                      
        <input class=Mandatory type=text name=mrtme002 id=mrtme002
         size=8 value="%STANDARD.01.016" title="Time">
        <img notab src=../images/DateTimeStamp.gif class=Icon
         onclick="SetCurrentDateTime(mrtme001,mrtme002);">     
        <img notab src=../images/TimeLookup.gif class=Icon
         onclick="TimeLookupFrame(mrtme002);">                 
    </td>                                                  
    <td width=15%>Requested By</td>
    <td><div id=RequestType></div></td>
</tr>
<tr><td>Destination</td>
    <td><select name=mrtme003 id=mrtme003 title="Destination" class=Mandatory
     onchange="DisplayTrackingAlert(mrtme019,this,urnumber);
               CheckLocType();">  
    <option></option>
    </select>
    </td>

    <td class=DataLabel><div id=HospitalTitle></div></td>
    <td><div id=Hospital></div></td>
    </tr>                                                  

<tr><td>Reason</td>     
    <td><select name=reasonmv id=reasonmv title="Reason" class=Mandatory  
         onchange='DueDateMand(this);'>       
    <option></option>
    %MRTWEB04.05.105.1
    </select>
    </td>                                                  
    <td>Due Date</td>
    <td><input type=text name=mrtme007 id=mrtme007 size=12 
         class="Mandatory Date" title="Due Date" value="">
         <img notab src=../images/DateLookup.gif class=Icon
         onclick="DateLookupFrame(mrtme007);"> 
    </td></tr>                                                  

<tr><td class=DataLabel>Extension #</td>
    <td><input type=text name=mrtme013 id=mrtme013 size=15 maxlength=20
         title="Extension"></td>
    <td class=DataLabel>Pager #</td>
    <td><input type=text name=mrtme014 id=mrtme014 size=15 maxlength=20
         title="Pager Number"></td></tr>
 
<tr><td class=DataLabel>Movement Comments</td>
    <td><input type=text size=60 maxlength=50 name=mrtme018 id=mrtme018
     value="" title="Movement Comments">
    </td>

    <td><div id=locationtype2></div></td>
    <td><div id=locationdesc2></div></td>
</tr>

<tr><td class=DataLabel id=recordalert colspan=3></td>
    <td>&nbsp;</td>
    </tr>
</table>

<table border=0 align=center width=100% cellspacing=1>
<tr><td colspan=2 align=center><br>
    <input type=button value="Move" class="button" onclick="verifyDates();">
    <input type=button value="Clear" class="button" onclick="ClearForm();">
    <input type=button value="Cancel" class="button" 
     onclick='location.href="../lookups/blank.html"'>
</td></tr>
</table>
</form>
</div>

<span id=TableLocation></span>
<script type="text/javascript">
function AddTableRows() {
   %MRTWEB04.05.107
}
</script>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%MRTWEB04.05.003">
<input type=hidden name=admissno value="%MRTWEB04.05.081">
<input type=hidden name=MenuType value="%MRTWEB04.05.088">
</form>

<span id=ReqFree style="display:none">
  <input type=text name=mrtme016 id=mrtme016 title="Requested By"
   size=35 maxlength=35 value="%STANDARD.01.009">
</span>
<span id=ReqSelect style="display:none">
  <select name=mrtme016 id=mrtme016 title="Requested By">
    <option></option>
    %MRTWEB04.05.112
  </select>
</span>

<span id=ShowHospitalTitle style="display:none">
  Hospital
</span>

<span id=ShowHospital style="display:none">
  <select name=mrtme019 id=mrtme019 title="Hospital" class="Mandatory"
   onchange="SetDestination(AddForm);ClearDest();">
   %MRTWEB04.05.115
  </select>
</span>

<span id=ShowNoHospital style="display:none">
   <input type=hidden name=mrtme019 id=mrtme019 value="    ">
</span>
   
<span id=ShowHomeHospTitle style="display:none">
  Hospital
</span>

<span id=ShowHomeHosp style="display:none">
  <select name=mrtme020 id=mrtme020 title="Hospital" class="Mandatory"
   onchange="SetHomeLocn(SendForm);">
   %MRTWEB04.05.115 
  </select>
</span>

<span id=ShowNoHomeHosp style="display:none">
   <input type=hidden name=mrtme020 id=mrtme020 value="    ">
</span>

<span id=InputVol style="display:none">
   <input type=text size=20 maxlength=20 name=mrtms005 id=mrtms005
     value="" title="Volume Comments">
</span>

<span id=InputFilm style="display:none">
   <input type=text size=25 maxlength=25 name=mrtms007 id=mrtms007
     value="" title="Microfilm">
</span>

<script type="text/javascript">
function ResetHomeLocn() {
   document.SendForm.homeloct.value = document.SendForm.mrtme017.value;
}
</script>
