<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">

function selectEnquiryBy(objSelectionBy)
{
   var arrayString = new Array();
  
   arrayString.push("selectBySessionDate");
   arrayString.push("selectByTheatre");
   arrayString.push("selectBySurgeon");
   arrayString.push("selectByService");
   
   //hide all other divs
   for(var i = 0; i < arrayString.length; i++)
   { 
     if(objSelectionBy.selectedIndex == i)
       (document.getElementById(arrayString[i])).style.display = "";
     else
       (document.getElementById(arrayString[i])).style.display = "none";
   }
}

function processReport(reportType)
{

  var fromMonth = "";
  var toMonth = "";
  var fromDate = "";
  var toDate = "";
  var fromYear = "";
  var toYear = "";

  var fullFromDate = "";
  var fullToDate = "";
   
  fromMonth = GetMonthNumber(ReportForm.fromDate.value.substr(3,3));
  toMonth = GetMonthNumber(ReportForm.toDate.value.substr(3,3));

  fromDate = ReportForm.fromDate.value.substr(0,2);
  toDate = ReportForm.toDate.value.substr(0,2);

  fromYear = ReportForm.fromDate.value.substr(7,4);
  toYear = ReportForm.toDate.value.substr(7,4);

  fullFromDate = fromDate+fromMonth+fromYear;
  fullToDate = toDate+toMonth+toYear;

  if(reportType.value == "1" )
  {
     ReportForm.keystr01.title = "Report Type";
     ReportForm.keystr01.value = reportType.value;

     ReportForm.keystr02.title = "Form Date";
     ReportForm.keystr02.value =  fullFromDate;

     ReportForm.keystr03.title = "To Date";
     ReportForm.keystr03.value = fullToDate;

     ReportForm.keystr04.title = "Period";
     ReportForm.keystr04.value = ReportForm.period.value.substr(0,3);

     ReportForm.keystr05.title = "Min % Free";
     ReportForm.keystr05.value = ReportForm.minFree.value;

     ReportForm.keystr06.title = "Print";
     ReportForm.keystr06.value = "P";

     ReportForm.keystr07.title = "Exit";
     ReportForm.keystr07.value = "E";

     ReportForm.surgeon.className = "";
     ReportForm.service.className = "";
     ReportForm.theatre.className = "";

  }
  else
  { 
     switch(reportType.value)
     {
        case "2": ReportForm.keystr02.title = "By Theatre";
                  ReportForm.keystr02.value = ReportForm.theatre.value;
                  ReportForm.surgeon.className = "";
                  ReportForm.service.className = "";
                  break;

        case "3": ReportForm.keystr02.title = "By Surgeon";
                  ReportForm.keystr02.value = ReportForm.surgeon.value;
                  ReportForm.theatre.className = "";
                  ReportForm.service.className = "";
                  break;


        case "4": ReportForm.keystr02.title = "By Service";
                  ReportForm.keystr02.value = ReportForm.service.value;
                  ReportForm.theatre.className = "";
                  ReportForm.surgeon.className = "";
                  break;
 
        default:  return;;
     }

     ReportForm.keystr01.title = "Report Type";
     ReportForm.keystr01.value = reportType.value;
 
     ReportForm.keystr03.title = "Form Date";
     ReportForm.keystr03.value =  fullFromDate;

     ReportForm.keystr04.title = "To Date";
     ReportForm.keystr04.value = fullToDate;

     ReportForm.keystr05.title = "Period";
     ReportForm.keystr05.value = ReportForm.period.value.substr(0,3);

     ReportForm.keystr06.title = "Min % Free";
     ReportForm.keystr06.value = ReportForm.minFree.value;

     ReportForm.keystr07.title = "Print";
     ReportForm.keystr07.value = "P";

     ReportForm.keystr08.title = "Exit";
     ReportForm.keystr08.value = "E";

  }
  
  if(validateMandatory(ReportForm))
          ReportForm.submit();
   
}
</script>
</head>
<body onload="PageLoad(event);ReportLoad();">
%START.OF.PAGE

<form name=ReportForm method=post action=rshweb02.pbl>

<input type=hidden name=reportno value=4>
<input type=hidden name=template value=001>
<input type=hidden name=updttype value="A">
<input type=hidden name=setdfprg value="IBAOPR22">
<input type=hidden name=setdfrep value="01">
<input type=hidden name=schdpgid value="IBAOPR22">    
<input type=hidden name=schddesc value="Session Enquiry">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=1">
<input type=hidden name=keystr01 value="" />
<input type=hidden name=keystr02 value="" />
<input type=hidden name=keystr03 value="" />
<input type=hidden name=keystr04 value="" />
<input type=hidden name=keystr05 value="" />
<input type=hidden name=keystr06 value="" />
<input type=hidden name=keystr07 value="" />
<input type=hidden name=keystr08 value="" />
<input type=hidden name=keystr09 value="" />
<input type=hidden name=keystr10 value="" />
<input type=hidden name=keystr11 value="" />

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>
    Session Enquiry</td></tr>
<tr><td>
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text name=schddate size=12 title="Schedule Date"
    value="%STANDARD.01.015"
    onblur="checkDate(this,'Schedule Date');">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schddate">
    Time
    <input type=text name=schdtime size=12 title="Schedule Time"
    value="%STANDARD.01.016">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schddate" time="ReportForm.schdtime">
    <img notab src="../images/TimeLookup.gif" class="Icon" 
     alt="Time Select" time="ReportForm.schdtime">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><select name=schdprnt title="Printer" class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBAOPR22.01
        </select>
    </td></tr>
<tr><td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy title='Number of Copies'>
        </select>
    </td></tr>
<tr><td class=DataLabel>Re-schedule Type</td> 
    <td class=DataLabel colspan=3> 
    <select name=schdrdat title="Schedule Type" onchange=SetReportDates()> 
    <option></option> 
    </select> 
    </td></tr> 
 
<tr><td class=DataLabel>Re-schedule Until Date</td> 
    <td class=DataLabel colspan=3> 
    <input type=text name=schdrend size=12 
     onblur="checkDate(this,'Re-schedule Until Date');"> 
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schdrend">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schdrend">
    </td></tr>
 
<tr><td colspan=2 align=center><hr width=80%></td></tr>

<tr>
  <td class=DataLabel>Report Type</td>
  <td>
    <select name="repType" 
            title="Report Type" 
            class=Mandatory"
            onchange="selectEnquiryBy(this);"
    >
      <option value="1">By Session Date</option>
      <option value="2">By Theatre</option>
      <option value="3">By Surgeon</option>
      <option value="4">By Service</option>
    </select>
  </td>
</tr>
</table>
</td></tr>
</table>


<div id="selectBySessionDate">
 <table width=80% align=center border=0 cellspacing=2 cellpadding=1>
   <tr>
      <td class="DataLabel">By Session Date</td>
   </tr>
 </table>
</div>

<div id="selectByTheatre" style="display:none;" class="">
 <table width=80% align=center border=0 cellspacing=2 cellpadding=1>
   <tr>
      <td  class="DataLabel" width="25%">By Theatre</td>
   </tr>
   <tr>
     <td class="DataLabel">Theatre</td>
     <td class="DataField">
       <select name="theatre" class="Mandatory">
         <option></option>
         %RSHWEB02.01.125.1
       </select>
     </td>
   </tr>
 </table>
</div>

<div id="selectBySurgeon" style="display:none;" class="">
 <table width=80% align=center border=0 cellspacing=2 cellpadding=1>
  <tr>
      <td  class="DataLabel" width="25%">By Surgeon</td>
   </tr>
   <tr>
      <td class="DataLabel">Surgeon</td>
      <td>
        <select name="surgeon" class="Mandatory">
          %RSHWEB02.01.137
        </select>
      </td>
   </tr>
 </table>
</div>

<div id="selectByService" style="display:none;" class="">
 <table width=80% align=center border=0 cellspacing=2 cellpadding=1>
   <tr>
      <td  class="DataLabel" width="25%" >By Service</td>
  </tr>
   <tr>
      <td class="DataLabel">Service</td>
      <td>
        <select name="service" class="Mandatory">
          %RSHWEB02.01.124
        </select>
      </td>
   </tr>
 </table>
</div>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
   <tr>
      
      <td class=DataLabel width=25%>From Date</td>
      <td class=DataField>
        <input type="text" 
               name="fromDate" 
               title="From Date" 
               size="10" 
               class="Mandatory"
               onblur="checkDate(this,this.title);"
        />

        <img notab src="../images/DateTimeStamp.gif" class="Icon"
             alt="Current" date="ReportForm.fromDate" />
        <img notab src="../images/DateLookup.gif" class="Icon"
             alt="Show Calendar" date="ReportForm.fromDate" />

        <span style="font-weight:normal">To Date</span>

        <input type="text" 
               name="toDate"
               title="To Date"
               size="10"
               class="Mandatory"
               onblur="checkDate(this,'Re-schedule Until Date');"
         />

        <img notab src="../images/DateTimeStamp.gif" class="Icon"
             alt="Current" date="ReportForm.toDate">
        <img notab src="../images/DateLookup.gif" class="Icon"
              alt="Show Calendar" date="ReportForm.toDate">
      </td>
   </tr>
   <tr>
      <td class=DataLabel>Period</td>
      <td class=DataField>
        <select name="period" 
                title="Period"
                class="Mandatory"
        >
          <option>
            %STANDARD.01.007.SP
          </option>
        </select>
      </td>
   </tr>
   <tr>
      <td class=DataLabel>Min % Free</td>
      <td class=DataField>

        <input type="text" 
               name="minFree"
               title="Min % Free"
               class="Mandatory Integer"
               size="10"
        />

      </td>
   </tr>
   <tr><td>&nbsp;</td></tr>
   <tr><td>&nbsp;</td>
       <td>
         <input type="button" 
                class="button"
                value="Ok"
                onclick="processReport(ReportForm.repType)"
         />
         <input type="reset"
                class="button"
                value="Cancel"
         />
       </td>
   </tr>
 </table>
</form>

<div id=SetDateRange style="display:none;">
    <input type=text size=15 maxlength=12 name=datran02
    onblur="checkDate(this,'Date')" class="Mandatory" title="Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.datran02">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.datran02">
</div>

<div id=SetScheduleRange style="display:none;">
    <select name=datsch01 title="Schedule Range" class=Mandatory
    onblur=UpReportSchedule(this,ReportForm.SampleFrom,ReportForm.keystr02)>
    <option></option></select>
    Sample 
    <input type=hidden name=SampleFrom size=12> 
    <input type=text name=SampleTo size=12>
</div>


