<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">

<style type="text/css">
#box1{
   position: absolute;
   top: 100px;
   left: 100px;
   border-style: outset;
   background-color: #fff8ff;
   padding: 3px;
   visibility: hidden;
}
</style>
<script type="text/javascript">
var box1;
var mousex = 0;
var mousey = 0;
var maxx = 0;
var maxy = 0;

function init()
{
  box1 = document.getElementById('box1');
  document.onmousemove = getMouseXY;
  maxx = getClientWidth();
  maxy = getClientHeight();
}

function getMouseXY(e) // works on IE6,FF,Moz,Opera7
{
  if (!e) e = window.event; // works on IE only (others rely on browser passing us the event)

  if (e)
  {
    if (e.pageX || e.pageY)
    { // this doesn't work on IE6!! (works on FF,Moz,Opera7)
      mousex = e.pageX;
      mousey = e.pageY;
    }
    else if (e.clientX || e.clientY )
    { // works on IE6,FF,Moz,Opera7
      mousex = e.clientX + document.body.scrollLeft;
      mousey = e.clientY + document.body.scrollTop;
    }
  }
}

function show_it(txt) {

  box1.innerHTML  = txt;
  var x = mousex;
  var y = mousey;
  // rendered dimensions or estimates;
  var rx = ( box1.sclrollLeft ) ?  box1.scrollLeft : 200;
  var ry = ( box1.scrollHeight ) ? box1.scrollHeight : 300;

  x = (maxx - x - 70  < rx ) ? x - 70  - rx : x + 70;
  y = (maxy - y < ry)         ? y - ry : y ;

  box1.style.top  =  y + 'px';
  box1.style.left =  x + 'px';
  box1.style.visibility = "visible";
}

function hide_it(){
  box1.style.visibility = "hidden";
}

function hoveringOver() {
  status="Testing Status Line";
}
function hoverOut() {
  status="";
}
function NewBooking() {
   linkUrl="watweb01.pbl?reportno=2&template=023";
   location.href=linkUrl;
}
function NewPreadmit() {
   linkUrl="patweb90.pbl?reportno=1&template=201"
   DFrameLink(linkUrl,0,50,1100,450)
}
function UpdateCondition(urnumber,admissno) {
  linkurl="patweb93.pbl?reportno=5&template=001" +
          "&urnumber=" + urnumber + "&admissno=" + admissno
  DFrameLink(linkurl,50,250,500,300)
}
function UpdateDiet(urnumber,admissno) { 
  linkurl="patweb98.pbl?reportno=4&template=003" +
          "&urnumber=" + urnumber + "&admissno=" + admissno
  DFrameLink(linkurl,0,75,300,150)
}
function PatientAlerts(urnumber,admissno) { 
  linkurl="patweb98.pbl?reportno=1&template=003" +
          "&urnumber=" + urnumber + "&admissno=" + admissno
  location.href=linkurl
}
function PatientResults(urnumber,admissno) { 
  linkurl="cliweb03.pbl?reportno=1&template=001" +
          "&urnumber=" + urnumber + "&admissno=" + admissno
  location.href=linkurl
}
function BedAllocation(urnumber,admissno) {
  linkurl="patweb96.pbl?reportno=3&template=005" +
          "&urnumber=" + urnumber + "&admissno=" + admissno
  DFrameLink(linkurl,50,250,300,120)
}
//function initTable(TableView) {
//  ward=document.SelectPeriod.wardcode.value;
//  bed=document.SelectPeriod.wbedtype.value;
//  if (TableView==0) {
//      linkurl="patweb93.pbl?reportno=1&template=010" +
//              "&wardcode=" + ward +
//              "&wbedtype=" + bed 
//      }
//  location.href=linkurl;
//}
function ModBeds() {
  document.cookie = "WardListPath=" + escape(location.href) + ";";
  var ward = document.SelectPeriod.wardcode.value.replace(/ /g,"+");
  location.href="patweb95.pbl?reportno=5&template=001&wardcode=" + ward;
}
function AJAXOutliers() {
   startDate = new Date();
   startTime = startDate.getTime();
   ProgressBar.innerHTML='Loading Page ....';
   ProgressBar.style.backgroundImage='url(../images/ProgressBar.gif)';
   theURL = "patweb93.pbl?reportno=13&template=05" +
            "&wardcode=" + SelectPeriod.wardcode.value.replace(/ /g,"+") +
            "&viewtype=" + SelectPeriod.viewtype.value.replace(/ /g,"+") +
            "&lastdate=" + SelectPeriod.lastdate.value.replace(/ /g,"+") +
            "&outltype=" + SelectPeriod.outltype.value.replace(/ /g,"+");
   xmlHttp = createHttpObject();
   theURL = theURL + '&httprand='+Math.random();
   xmlHttp.open("GET", theURL, true);
   xmlHttp.onreadystatechange=function() {
    if (xmlHttp.readyState==4) {
      if (xmlHttp.responseText!="") {
        OutlierListResults.innerHTML   = xmlHttp.responseText;
        startDate = new Date();
        endTime = startDate.getTime();
        ProgressBar.style.backgroundImage='url()';
        ProgressBar.innerHTML='Load Time: '+((endTime-startTime)/1000)+' sec';
      }
    }
  }
  xmlHttp.send();
}
</script>
%START.OF.PAGE
<body class=land onload="PageLoad(event);AJAXOutliers();">

<form name=SelectPeriod action=patweb93.pbl method=get style=margin:0>
<input type=hidden name=reportno value="13">
<input type=hidden name=template value="3">
<input type=hidden name=viewtype value="0">

<table width=100% cellspacing=0 border=0>
<tr><td class=HeadingCell>
    </td>
    <td class=HeadingCell align=center>
        Expected/Admitted Patient by Ward</td>
    <td class=HeadingCell width=10%>
        </td>
    </tr>
</table>
<table width=100% cellspacing=0 border=1>
<tr><td class=HeadingCell> 
    <input type=button value="<<" class=SmallButton
    onclick='location.href="%PATWEB93.13.202"'>
         %PATWEB93.13.207
    <input type=submit value="Go" class=SmallButton>
    <input type=button value=">>" class=SmallButton
    onclick='location.href="%PATWEB93.13.201"'>
    <a href='javascript:SelectDateFrame();'>
    <img src="../images/DateLookup.gif" border=0
     alt="Select Date" class=Icon></a>
         Ward
        <select name=wardcode onchange="SelectPeriod.submit();" >
         %PATWEB93.13.001
        </select>
<!--
    <input type=button class="button" value="Create Pre-Admission"
     onclick="NewPreadmit();">
-->
    <input type=button class="button" value="Create Booking"
     onclick="NewBooking();"></td>
    <td class=HeadingCell>No. of Patients: %PATWEB93.13.031 
     &nbsp; &nbsp;  <font color=red>%PATWEB93.13.032</font></td>
</tr>
</table>
<table cellspacing=0 cellpadding=0 border=1 width=100%>

%PATWEB93.13.028.patweb98.01.001

</table>
<table width=100% cellspacing=0 border=1>
<tr><td class=HeadingCell align=center colspan=8>
        <select name=outltype onchange="AJAXOutliers();">
        %STANDARD.01.007.BK
        </select>Outliers</td>
    <td class=HeadingCell align=right width=10%>
    <span id=ProgressBar class=ProgressBar>Loading Page... </span>
    </td>
    </tr>
</td></tr>
</table>

<div id="OutlierListResults"></div>

</form>
<table cellspacing=0 cellpadding=2 border=0 width=40%>
<tr><td width=10% class=AdmittedCell align=center></td>
    <td>Current Inpatient</td></tr>

<tr><td width=10% class=BedReqCell align=center></td>
    <td>Booking Linked to Current Inpatient in Other Ward</td></tr>

<tr><td width=10% class=ExpectedCell align=center></td>
    <td>Expected Patients (Booked and Pre-Admitted)</td></tr>
</table>

<span id=Bone style="display: none">
<table cellspacing=0 cellpadding=2 border=0 width=40%>
<tr><td width=10% class=BoneMarCell align=center></td>
    <td id=bonetext></td></tr>
</table>
</span>

<span id=Bladder style="display: none">
<table cellspacing=0 cellpadding=2 border=0 width=40%>
<tr><td width=10% class=BladderCell align=center></td>
    <td id=bladdertext></td></tr>
</table>
</span>

<span id=AutoVen style="display: none">
<table cellspacing=0 cellpadding=2 border=0 width=40%>
<tr><td width=10% class=AutoVenCell align=center></td>
    <td id=autotext></td></tr>
</table>
</span>

<table cellspacing=0 cellpadding=2 border=0 width=40%>
<tr><td width=10% align=center></td>
    <td>Booked Only will appear in <b>Bold</b></td></tr>
</table>

<script type="text/javascript">
function SetCount() {
  SelectPeriod.numofpat.value="%PATWEB93.13.012" 
  SelectPeriod.numunbed.value="%PATWEB93.13.010" 
}
BoneDesc="%PATWEB93.13.033.M";
if(!isWhitespace(BoneDesc)) {
 Bone.style.display=""; 
 document.getElementById('bonetext').innerHTML=BoneDesc;
}
BladderDesc="%PATWEB93.13.033.B";
if(!isWhitespace(BladderDesc)) {
 Bladder.style.display=""; 
 document.getElementById('bladdertext').innerHTML=BladderDesc;
}
AutoDesc="%PATWEB93.13.033.A";
if(!isWhitespace(AutoDesc)) {
 AutoVen.style.display=""; 
 document.getElementById('autotext').innerHTML=AutoDesc;
}
Outlier="%PATWEB93.13.035";
for (var i =0 ; i < document.SelectPeriod.outltype.length; i++) {
  if (document.SelectPeriod.outltype.options[i].value.substr(0,3)==Outlier) {
       document.SelectPeriod.outltype.selectedIndex=i } };
//BedType="%PATWEB93.13.013"
//for (var i =0 ; i < document.SelectPeriod.wbedtype.length; i++) {
//  if (document.SelectPeriod.wbedtype.options[i].value==BedType.substr(0,1)) {
//       document.SelectPeriod.wbedtype.selectedIndex=i } };
</script>
<form name=LinkForm method=post action=patweb89.pbl>
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="">
</form>
<div id="box1"></div>
<form name=Registration method=get action="patweb89.pbl">
<input type=hidden name=reportno value=05>
<input type=hidden name=template value=001>
<input type=hidden name=srchsnam value="">
<input type=hidden name=srchgnam value="">
<input type=hidden name=srchpdob value="">
<input type=hidden name=srchpage value="">
<input type=hidden name=srchpsex value="">
<input type=hidden name=temporar value="0">
</form>
<form name=NewRegistration method=get action=patweb89.pbl>
<input type=hidden name=reportno value=05>
<input type=hidden name=template value=004>
<input type=hidden name=srchsnam value="">
<input type=hidden name=srchgnam value="">
<input type=hidden name=srchpdob value="">
<input type=hidden name=srchpage value="">
<input type=hidden name=srchpsex value="">
<input type=hidden name=temporar value="1">
</form>
