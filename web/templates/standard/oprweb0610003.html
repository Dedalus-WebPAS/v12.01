<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb06.js"> </script>
<script type="text/javascript">
%START.OF.PAGE
function init() {
  if (isWhitespace(UpdateForm.opcom003.value)) {
    UpdateForm.opcom003.value= PatientNotes.Prothesis.value + "\n" +
                               PatientNotes.AnaeNote.value + "\n" +
                               PatientNotes.WaitNote.value 
  }
}
function SetPrinter(SelectList) {
 if (SelectList.className=="SelectBig") {
     SelectList.className="Mandatory SelectBig" }
 else {
     SelectList.className="SelectBig" }
}
function ChkReg() {
  if(isWhitespace(document.UpdateForm.opard080.value)) {
     PrintReg.innerHTML="";
     PrintReg.style.display="none";
  } else {
     PrintReg.style.display="";
     PrintReg.innerHTML=ShowPrintReg.innerHTML;
  }
}
function chkTime(field){
  if(isWhitespace(field.value))
   return;
  endTime=UpdateForm.suentime.value.replace(/:/g,"");
  if(isWhitespace(endTime)){
    if (UpdateForm.d_opsguy05.value!= "Yes") {
      alert("Surgery End Time must be entered first");
      field.value=""
      return;
    }
  }
  if(field.value.replace(/:/g,"")<=endTime){
//
  if(!confirm(""+field.title+" must be after Surgery End Time " +
          UpdateForm.suentime.value +
  "\n Do you want to override")) {
  field.value="";
  }
//
  }
}
function setETTime(extime) {
document.UpdateForm.opard080.value=extime.value;
document.UpdateForm.opard085.value=extime.value;
 ChgRTD();
}
function valTime(){
  RecFront=UpdateFront.opard071.value.replace(/:/g,"");
  RecBack=UpdateFront.opard074.value.replace(/:/g,"");
  DepartTime=UpdateFront.opard085.value.replace(/:/g,"");
}
function ChkFront() {
  if (isWhitespace(UpdateForm.opard071.value)) {
     alert("Time in Recovery - Front need to be entered")
     UpdateForm.opard074.value=""
     UpdateForm.opard071.focus()
     }
}
function ChgRTD() {
if(!isWhitespace(UpdateForm.opard080.value)) {
     UpdateForm.opard080.className= "Mandatory"
     UpdateForm.opard085.className= "Mandatory"
     }
else {
     UpdateForm.opard080.className=" "
     UpdateForm.opard085.className=" "
     }
}
function chkMan() {
  var depTime = UpdateForm.opard085;

  if (isWhitespace(depTime.value)) {return;}

  var exitTime = UpdateForm.opard080;
  var varianceMinutes = document.getElementById('opcnvrrd');
  var delayCode = document.getElementById('opard084');
  var dateDiffSeconds = null;
  var dateDiffMilliseconds = null;

  //convert to time
  var date1 = new Date();
  var date2 = new Date();

  //depTime
  date1.setHours(depTime.value.substr(0,2));
  date1.setMinutes(depTime.value.substr(3,2));
  date1.setSeconds(depTime.value.substr(6,2));

  //exitTime
  date2.setHours(exitTime.value.substr(0,2));
  date2.setMinutes(exitTime.value.substr(3,2));
  date2.setSeconds(exitTime.value.substr(6,2));

  dateDiffMilliseconds = (date2 - date1);
  dateDiffSeconds = (dateDiffMilliseconds/1000);

  //convert minute to seconds and then compare dateDiffSeconds
  if( (varianceMinutes.value * 60) > dateDiffSeconds) {
    delayCode.className="";
  }else {
    delayCode.className="Mandatory";
  }
}
function displayCRRHI() {

  if (document.getElementById("opcncrrh").value=="2" ||
      document.getElementById("opcncrrh").value=="1") {
    linkurl = document.getElementById("recrmurl").value +
              "&casekeys=" +
              document.PatientLinks.casekeys.value.replace(/ /g,"+") +
              "&uniqueky=" +
              document.PatientLinks.uniqueky.value.replace(/ /g,"+") +
              "&urnumber=" +
              document.PatientLinks.urnumber.value.replace(/ /g,"+") +
              "&admissno=" +
              document.PatientLinks.admissno.value.replace(/ /g,"+");

    Left=(document.body.clientWidth-800)/2;
    DFrameLink(linkurl,50,Left,800,600)
  }

}
function chkMan2() {
  var recTime = UpdateForm.opard077;

  if (isWhitespace(recTime.value)) {return;}

  var exitTime = UpdateForm.opard080;
  var varianceMinutes = document.getElementById('opcnldae');
//  var delayCode = document.getElementById('opard084');
  var dateDiffSeconds = null;
  var dateDiffMilliseconds = null;

  //convert to time
  var date1 = new Date();
  var date2 = new Date();

  //recTime
  date1.setHours(recTime.value.substr(0,2));
  date1.setMinutes(recTime.value.substr(3,2));
  date1.setSeconds(recTime.value.substr(6,2));

  //exitTime
  date2.setHours(exitTime.value.substr(0,2));
  date2.setMinutes(exitTime.value.substr(3,2));
  date2.setSeconds(exitTime.value.substr(6,2));

  dateDiffMilliseconds = (date2 - date1);
  dateDiffSeconds = (dateDiffMilliseconds/1000);

  //convert minute to seconds and then compare dateDiffSeconds
  if( (varianceMinutes.value * 60) > dateDiffSeconds) {
//    delayCode.className="";
  }else {
//    delayCode.className="Mandatory";
//    adverseEventDiv.style.display = "";
    if(usingRecoveryAnaestheticParameter != '1') {
      return;
    }
    var url = "oprweb06.pbl?reportno=10&template=011";

    url += "&urnumber="+PatientURN;
    url += "&admissno="+PatientVIS;
    url += "&casekeys="+UpdateForm.casekeys.value;

//    adverseEventDiv.style.display = "none";

    SetCookie("recoveryDFrameCookie","");
    ShowDetail01(url);
  }
}
function ShowDetail01(linkurl)
{
  Left=(document.body.clientWidth-900)/2
  var frame = document.getElementById("PopUpFrame");
  frame.style.overflow = "auto";
  frame.style.height = 600 +"px";

  DFrameLink(linkurl,0,Left,900,600)
}
function formSubmit() {
  if(validateMandatory(UpdateForm)) {
    if(checkTimeOrder())
    {
      saveOvrNight();
      if(!checkSurgeryEndTime())
      {
        document.UpdateForm.submit();
      }
    }
  }
}
function checkTimeOrder(){

 var recovFrontTime = UpdateForm.opard071;
 var recovBackTime = UpdateForm.opard074;
 var recovDayPrTime = UpdateForm.opard077;
 var readyDepartTime = UpdateForm.opard085;
 var exitTheatreTime = UpdateForm.opard080;
 var ICUTime = UpdateForm.opard083;
 var overNightIndicator = document.getElementById("d_opsrg071");

 if((recovFrontTime.value == "") && (recovBackTime.value == "") &&
    (recovDayPrTime.value == "") && (ICUTime.value != "")) {
     return true;
 }

 var arrayObj = new Array();

 arrayObj.push(recovFrontTime);
 if(recovBackTime.value != "")
 {
    arrayObj.push(recovBackTime);
 }
 if(recovDayPrTime.value != "")
 {
   arrayObj.push(recovDayPrTime);
 }

 arrayObj.push(readyDepartTime);
 arrayObj.push(exitTheatreTime);
 arrayObj.push(ICUTime);

 if(overNightIndicator.checked)
 {
   alert("Warning: over night indicator is switch on, check your times carefully");
   return true;
 }

 for(var i = 1; i < arrayObj.length; i++)
 {
   if(arrayObj[i].value != "")
   {

     if(checkTimeEnter(arrayObj[i-1]))
       return false;

     if(validateGreatestTime(arrayObj[i-1],arrayObj[i]))
       return false;
    }
 }

 return true;

}
function checkTimeEnter(obj)
{
   if(obj.value == 0)
   {
     alert(obj.title+" must be entered first");
     obj.focus();
     obj.select();
     return true;
   }
  return false;
}

function convertOvrnightToInteger()
{
 var overNightField = document.getElementById("d_opsrg071");
 var opsrg071 =  document.getElementById("opsrg071");
 if(opsrg071.value == "Yes")
   overNightField.checked = true;
 else
   overNightField.checked = false;

}

function saveOvrNight()
{
 var overNightField = document.getElementById("d_opsrg071");
 var opsrg071 =  document.getElementById("opsrg071");
 if(overNightField.checked)
  opsrg071.value  = 1;
 else
  opsrg071.value  = 0;
}

function checkSurgeryEndTime()
{
  var DressingTime    = document.getElementById('opsrg004');
  var surgeryEndTime    = document.getElementById('opsrg006');
  var recoveryFrontTime = document.UpdateForm.opard071;
  var recoveryDayTime   = document.UpdateForm.opard077;

  var tempDressingTime   = DressingTime.value.replace(/\:/g,"");
  var tempSurgeryTime   = surgeryEndTime.value.replace(/\:/g,"");
  var tempRecoveryTime  = recoveryFrontTime.value.replace(/\:/g,"");
  var tempRecoveryTimeDay = recoveryDayTime.value.replace(/\:/g,"");
  var overNightIndicator = document.getElementById("d_opsrg071");

  tempDressingTime.replace(/ /g,"");
  tempSurgeryTime.replace(/ /g,"");
  tempRecoveryTime.replace(/ /g,"");
  tempRecoveryTimeDay.replace(/ /g,"");

  tempDressingTime = parseInt(tempDressingTime,10);
  tempSurgeryTime = parseInt(tempSurgeryTime,10);
  tempRecoveryTime = parseInt(tempRecoveryTime,10);
  tempRecoveryTimeDay = parseInt(tempRecoveryTimeDay,10);

  if(!overNightIndicator.checked)
  {

  if(!isWhitespace(document.UpdateForm.opsrg004.value)) {
    if(tempDressingTime >= tempRecoveryTime)
    {
      alert(recoveryFrontTime.title+" has to be after Dressing Time " + document.UpdateForm.opsrg004.value );
      recoveryFrontTime.focus();
      recoveryFrontTime.select();
      return true;
    }
   }

    if(tempSurgeryTime >= tempRecoveryTime)
    {
      alert(recoveryFrontTime.title+" has to be after Surgery End Time.");
      recoveryFrontTime.focus();
      recoveryFrontTime.select();
      return true;
    }

    if(tempSurgeryTime >= tempRecoveryTimeDay)
    {
      alert(recoveryDayTime.title+" has to be after Surgery End Time.");
      recoveryFrontTime.focus();
      recoveryFrontTime.select();
      return true;
    }
  }

  return false;


}
function chkHcpOTNurse(){
  if (document.getElementById('opcnurse')) {
      if (document.getElementById('opcnurse').value == "1") {
        return true;
      }
      else {
        return false;
      }
  }
  else {
      return false;
  }
}
function SearchOTNurse(NurseId,ReturnNurseName) {
  var hcpnurse = chkHcpOTNurse();
  if (hcpnurse==true){
     HCPSearchFrame(NurseId,ReturnNurseName,20);
  }
  else {
     NurseSearchFrame(NurseId,ReturnNurseName);
  }
}

function validateNurse(code,name) {
  var hcpnurse = chkHcpOTNurse();
  if  (hcpnurse==true){
      validateCode('18',code,name);
  }
  else {
      validateCode('17',code,name,document.UpdateForm.gnm);
      SetNurseName(name);
  }
}
function SetNurseName(name) {
  name.value=UpdateForm.gnm.value.replace(/\s*$/g,"") + " " +
             name.value.replace(/\s*$/g,"")
}

function TimeCheck(){

  var fieldElement;
  var theatreDate = "%OPRWEB06.10.101".slice(3,8);
  var fieldName = "timecheck%STANDARD.01.044.113.064.002".replace(" ", "0");

  try{
    if(!this.event.srcElement.value){
      return;
    }
    if(this.event.srcElement.id!=fieldName){
      return;
    }
    if(!Get("discdate").value){
      return;
    }
    fieldElement = Get(fieldName);
    var dateArray = Get("discdate").value.split(" ");
    var monthNumber = new Date(Date.parse(dateArray[1] +" 1, 2012")).getMonth()+1;
    var monthString = monthNumber<10? "0" + monthNumber : "" + monthNumber
    var dDate = dateArray[2] + monthString + dateArray[0];
    if(theatreDate + fieldElement.value > dDate+Get("disctime").value){
       alert(fieldElement.title + " cannot be after the discharge date."+
             "\nDo you want to override?");
       fieldElement.value = "";
       fieldElement.focus();
    }
  }catch(e){}
}
function Get(el){return document.getElementById(el);}
</script></head>
<body onload="PageLoad(event);setTimeout('ChkReg()',100);
      convertOvrnightToInteger();showDelay();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Theatre Case Recovery Details
</span>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB06.10.003";
PatientVIS="%OPRWEB06.10.081";
PatientNAM="%OPRWEB06.10.002";
PatientSTA="%OPRWEB06.10.086.078";
PatientALT="%OPRWEB06.10.084";
PatientSEX="%OPRWEB06.10.019";
PatientDOB="%OPRWEB06.10.020";
PatientAGE="%OPRWEB06.10.021";
PatientLOC="%OPRWEB06.10.083";
PatientPRI="%OPRWEB06.10.086.066.1";
PatientUNT="%OPRWEB06.10.066.0";
DoctorCOD="%OPRWEB06.10.082.003";
DoctorNAM="%OPRWEB06.10.082.002";
PatientAID="%OPRWEB06.10.086.090";
PatientIND="%OPRWEB06.10.086.091";
PatientCUR="%OPRWEB06.10.086.092";
PatientCLC="%OPRWEB06.10.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB06.10.086.094";
PatientCDM="%OPRWEB06.10.086.095";
PatientVDH="%OPRWEB06.10.086.099.015";

usingRecoveryAnaestheticParameter ='%STANDARD.01.025.113.015.0.1';

InsertPatientHeader()
</script>
<div id="PatientMenu"></div>

<div id="TheatreCaseHeading"></div>
<script type="text/javascript">
TheatreHeading="Theatre Case Recovery Details"
</script>
<div id=PageBodySection>
<form name=UpdateForm method=post action=oprweb06.pbl style="margin:0" 
 onSubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value=10>
<input type=hidden name=template value=001>
<input type=hidden name=updatety value="U">
<input type=hidden name=casekeys value="%OPRWEB06.10.101">
<input type=hidden name=nextpage value="0">
<input type=hidden name=suentime value="%OPRWEB06.10.306">
<input type=hidden name=opcnvrrd id=opcnvrrd
 value="%STANDARD.01.025.113.017.0.2">
<input type=hidden name=opcnctin id=opcnctin
 value="%STANDARD.01.025.113.032.0.1">
<input type=hidden name=opcncoso id=opcncoso
 value="%STANDARD.01.025.113.033.0.1">
<input type=hidden name=opcncrrh id=opcncrrh
 value="%STANDARD.01.025.113.034.0.1">
<input type=hidden name=opcnldae id=opcnldae
 value="%STANDARD.01.025.113.035.0.3">
<input type=hidden name=pocrect2 id=pocrect2
 value="%OPRWEB06.10.859">
<input type=hidden name=currdate value='%STANDARD.01.013'>
<input type=hidden name=currtime>
<input type=hidden name=opsrg004 id=opsrg004 value="%OPRWEB06.10.304">
<input type=hidden name=opsrg071 id=opsrg071 value="%OPRWEB06.10.371" />
<input type=hidden name=opsrg006 id=opsrg006 value="%OPRWEB06.10.306" />
<input type=hidden name=gnm id=gnm>
<input type=hidden name=opcnurse id=opcnurse
       value="%STANDARD.01.025.113.051.0.1">
<input type=hidden name="discdate" id="discdate" value="%OPRWEB06.10.853">
<input type=hidden name="disctime" id="disctime" value="%OPRWEB06.10.854">
<input type=hidden name=exittime value='%OPRWEB06.10.299.017'>
<input type=hidden name=d_opsguy05 value="%OPRWEB06.10.374">

<table border=0 cellpadding=2 cellspacing=0 width="100%" align=center >
<tr><td class=DataLabel width=20%>Time in Recovery - Front </td>
    <td class=DataField width=20%>
    <input type=text name=opard071 size=8 title="Time in Recovery - Front"
     value='%OPRWEB06.10.271' id="timecheck10" 
     onblur="checkTime(this);chkTime(this);showDelay();TimeCheck();">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(null,UpdateForm.opard071);">
    <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(UpdateForm.opard071);">
    </td><td class=DataLabel width=20%>Nurse Attending Patient</td>
    <td><input type=text name=opard072 size=6 value="%OPRWEB06.10.272.1"
     id=opard072 onblur="validateNurse(opard072,name_opard072);">
    <input type=text readonly name=name_opard072 class=Readonly size=30
     id=name_opard072 value="%OPRWEB06.10.272.0" notab>
    <img src="../images/SearchIcon.gif" class=Icon notab
     onclick="SearchOTNurse(opard072,name_opard072);">
    </td></tr>
<tr><td class=DataLabel> &nbsp; </td>
    <td class=DataField> &nbsp; </td>
    <td class=DataLabel>Nurse Attending Patient</td>
    <td><input type=text name=opard073 size=6 value="%OPRWEB06.10.273.1"
     id=opard073 onblur="validateNurse(opard073,name_opard073);">
    <input type=text readonly name=name_opard073 class=Readonly size=30
     id=name_opard073 value="%OPRWEB06.10.273.0">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="SearchOTNurse(opard073,name_opard073);">
    </td></tr>
<tr><td class=DataLabel>Time in Recovery - Back </td>
    <td class=DataField>
    <input type=text name=opard074 size=8 title="Time in Recovery - Back"
     value='%OPRWEB06.10.274' id="timecheck11"
     onblur="checkTime(this);chkTime(this);ChkFront();showDelay();TimeCheck()">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(null,UpdateForm.opard074);">
    <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(UpdateForm.opard074);">
    </td><td class=DataLabel>Nurse Attending Patient</td>
    <td><input type=text name=opard075 size=6 value="%OPRWEB06.10.275.1"
     id=opard075 onblur="validateNurse(opard075,name_opard075);">
    <input type=text readonly name=name_opard075 class=Readonly size=30
     id=name_opard075 value="%OPRWEB06.10.275.0">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="SearchOTNurse(opard075,name_opard075);">
    </td></tr>
<tr><td class=DataLabel> &nbsp; </td>
    <td class=DataField> &nbsp; </td>
    <td class=DataLabel>Nurse Attending Patient</td>
    <td><input type=text name=opard076 size=6 value="%OPRWEB06.10.276.1"
     id=opard076 onblur="validateNurse(opard076,name_opard076);">
    <input type=text readonly name=name_opard076 class=Readonly size=30
     id=name_opard076 value="%OPRWEB06.10.276.0">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="SearchOTNurse(opard076,name_opard076);">
    </td></tr>
<tr><td class=DataLabel>Time in Recovery - Day Procedure </td>
    <td class=DataField width=25%>
    <table border="0" cellpadding="1" cellspacing="0" width="80%" align=left>
    <tr><td class=DataField>
    <input type=text name=opard077 size=8 title="Time in Recovery - Day"
     onclick="displayCRRHI();" value='%OPRWEB06.10.277' id="timecheck12"
     onblur="checkTime(this);chkTime(this);showDelay();TimeCheck()">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(null,UpdateForm.opard077);">
    <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(UpdateForm.opard077);">
    </td>
    <td class=DataField align=left>
      <div id=crrhiDIV></div>
    </td>
    </tr>
    </table>
    </td><td class=DataLabel>Nurse Attending Patient</td>
    <td><input type=text name=opard078 size=6 value="%OPRWEB06.10.278.1"
     id=opard078 onblur="validateNurse(opard078,name_opard078);">
    <input type=text readonly name=name_opard078 class=Readonly size=30
     id=name_opard078 value="%OPRWEB06.10.278.0">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="SearchOTNurse(opard078,name_opard078);">
    </td></tr>
<tr><td class=DataLabel> &nbsp; </td>
    <td class=DataField> &nbsp; </td>
    <td class=DataLabel>Nurse Attending Patient</td>
    <td><input type=text name=opard079 size=6 value="%OPRWEB06.10.279.1"
     id=opard079 onblur="validateNurse(opard079,name_opard079);">
    <input type=text readonly name=name_opard079 class=Readonly size=30
     id=name_opard079 value="%OPRWEB06.10.279.0">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="SearchOTNurse(opard079,name_opard079);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td>&nbsp;</td>
    <td class=DataLabel>Time Patient Went to ICU</td>
    <td class=DataField>
    <input type=text name=opard083 size=8 title="Time Patient Went to ICU"
     value='%OPRWEB06.10.283' id=opard083
     onblur="checkTime(this);chkTime(this);setETTime(this);">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(null,opard083);">
    <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(opard083);">
    </td></tr>

<tr><td class=DataLabel>Ready to Depart Time</td>
    <td class=DataField>
    <input type=text name=opard085 size=8 title="Ready to Depart Time"
     value='%OPRWEB06.10.285' onblur="checkTime(this);chkTime(this);ChgRTD();
     checkRecoveryTime(this);TimeCheck()" id="timecheck13" id=opard085>
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(null,UpdateForm.opard085);">
    <img src=../images/TimeLookup.gif border=0 class=Icon
     onclick="TimeLookupFrame(UpdateForm.opard085);">
    </td>
   <td class=DataLabel>Prosthesis</td>
   <td class=DataField >
   <input type=text name=opard013 value="%OPRWEB06.10.213" maxlength=40 size=40>
   </td></tr>

<tr><td class=DataLabel>Exit Theatre Complex Time</td>
    <td class=DataField>
    <input type=text name=opard080 size=8 title="Exit Theatre Complex Time"
     value='%OPRWEB06.10.280' id="timecheck14" onblur="if (checkTime(this)){
     chkTime(this);ChgRTD();chkMan();ChkReg();checkRecoveryTime(this);
     chkMan2();}TimeCheck()">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(null,UpdateForm.opard080);">
    <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(UpdateForm.opard080);"></td>
    <td class=DataLabel>Time Patient Died </td>
    <td class=DataField>
    <input type=text name=opard082 size=8 title="Time Patient Died" id=opard082
     value='%OPRWEB06.10.282' onblur="checkTime(this);chkTime(this);">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(null,opard082);">
    <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(opard082);">
    </td>
</tr>

<tr><td class=DataLabel>Overnight Indicator</td>
    <td class="DataField">
    <input type="checkbox" name="d_opsrg071" id="d_opsrg071"
     onchange="saveOvrNight();"/></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>

</table>

<div id=PrintReg></div>

<table border=0 cellpadding=2 cellspacing=0 width="100%" align=center >
<tr valign=top>
    <td class=DataLabel width=20%>Preadmission and<br> Operation Notes
    <td colspan=3>
    <textarea wrap=hard cols=60 rows=3 
     name=opcom003>%OPRWEB06.10.143.003</textarea>
    <img src="../images/LookupIcon.gif" class=Icon
     onclick='LookupPage(null,UpdateForm.opcom003,"Lookup_00300000_000");'>
    </td></tr>

<tr><td>%STANDARD.01.017.oc</td>
    <td><select name=opard016 title="%STANDARD.01.017.oc">
        <option></option>
        %OPRWEB06.10.216.2
        </select>
    </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td></tr>

<tr><td>%STANDARD.01.017.od</td>
    <td><select name=opard017 title="%STANDARD.01.017.od">
        <option></option>
        %OPRWEB06.10.217.2
        </select>
    </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td></tr>
</table>

<div id="DelayReason"></div>

<table border=0 cellpadding=2 cellspacing=0 width="100%" align=center >
<tr><td colspan=4 align=center>
    <input class="button" type=button value="Ok" id="opr06sub"
     onclick="tempDisable(this);formSubmit();">
    <input class="button" type=button value="Cancel" onclick=DFrameExit()>
    </td></tr>
</table>
</form>

<form name=PatientNotes method=get>
<textarea wrap=hard cols=60 rows=3 style='display:none;'
name=Prothesis>%OPRWEB06.10.128
</textarea>
<textarea wrap=hard cols=60 rows=3 style='display:none;'
name=AnaeNote>%OPRWEB06.10.143.002</textarea>
<textarea wrap=hard cols=60 rows=3 style='display:none;'
name=WaitNote>%OPRWEB06.10.459</textarea>
</form>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=10>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value='%OPRWEB06.10.003'>
<input type=hidden name=admissno value='%OPRWEB06.10.081'>
<input type=hidden name=MenuType value='%OPRWEB06.10.088'>
<input type=hidden name=casekeys value='%OPRWEB06.10.101'>
<input type=hidden name=teamnumb value="1">
<input type=hidden name=uniqueky value='%OPRWEB06.10.110'>
<input type=hidden name=recrmurl id=recrmurl
 value='%OPRWEB06.10.102.oprweb01.04.029'>

</form>
</div>
<div id="ShowPrintReg" style="display:none;">
<table border=0 cellpadding=2 cellspacing=0 width="100%" align=center >
<tr><td class=DataLabel width=20%>Op Registration Form</td>
    <td class=DataField width=20%>
    <input type=checkbox name=printreg value="1"
    onclick="SetPrinter(UpdateForm.schdprnt);"></td>
    <td class=DataLabel width=20%>Printer</td>
    <td><select name=schdprnt title="Printer" class="SelectBig">
        <option></option>
        %STANDARD.01.001.IBAOPR45.01
        </select>
    </td>
    </tr>
</table>
</div>

<span id=crrhiSPAN style="display:none">
<img src=../images/CaseNoteIcon.gif class=Icon onclick="displayCRRHI();">
</span>

<div id="ShowDelayReason" style="display:none;">
<table border=0 cellpadding=2 cellspacing=0 width="100%" align=center >
<tr><td width=20%>%STANDARD.01.017.Ou</td>
    <td><select name=opard084 id="opard084" title="%STANDARD.01.017.Ou">
        <option></option>
        %OPRWEB06.10.284.2
        </select>
    </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td></tr>

<tr><td>Clinical Review Date</td>
    <td><input type=text name=opard030 size=12 value="%OPRWEB06.10.230"
     class="Date PastDate" title="Clinical Review Date"
     onblur="checkReviewTime(UpdateForm.opard030,UpdateForm.opard031);">
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.opard030>
    Time
    <input type=text name=opard031 size=6 value="%OPRWEB06.10.231"
     onblur="checkReviewTime(UpdateForm.opard030,this);"
     title="Clinical Review Time">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.opard030
     time=UpdateForm.opard031>
    <img src=../images/TimeLookup.gif class=Icon time=UpdateForm.opard031>
    </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td></tr>
</table>
</div>

<div id="NoDelayReason" style="display:none;">
<input type="hidden" name="opard084" value=" ">
<input type="hidden" name="opard030" value=" ">
<input type="hidden" name="opard031" value=" ">
</div>

<script type="text/javascript">

if(isWhitespace(document.UpdateForm.opard080.value)) {
   document.UpdateForm.opard080.value = document.UpdateForm.exittime.value;
}

if (document.getElementById("opcncrrh").value=="2" ||
    document.getElementById("opcncrrh").value=="1") {
  if (document.getElementById("pocrect2").value=="1") {
    crrhiDIV.innerHTML=crrhiSPAN.innerHTML;
  }
}


</script>
