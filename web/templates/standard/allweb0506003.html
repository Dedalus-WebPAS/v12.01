<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script language="javascript" src="../js/allweb05.js"></script>
<script type="text/javascript">

function UpdateReferral() {
  if (!validateMandatory(UpdateForm)) {
     return;
  }
  if(!isWhitespace(UpdateForm.alref161.value) &&
     !isWhitespace(UpdateForm.alref090.value)) {
     if(SetDateYYYYMMDD(UpdateForm.alref090.value) >
        SetDateYYYYMMDD(UpdateForm.alref161.value)) {
        alert(UpdateForm.alref161.title + " must be after " +
        UpdateForm.alref090.title);
        return;
     }
  }
//
  if(!isWhitespace(UpdateForm.alref159.value) &&
     !isWhitespace(UpdateForm.alref090.value)) {
     if(SetDateYYYYMMDD(UpdateForm.alref090.value) >
        SetDateYYYYMMDD(UpdateForm.alref159.value)) {
        alert(UpdateForm.alref159.title + " must be after " +
        UpdateForm.alref090.title);
        return;
     }
  }
//
  if(!isWhitespace(UpdateForm.alref159.value) &&
     !isWhitespace(UpdateForm.alref161.value)) {
     if(SetDateYYYYMMDD(UpdateForm.alref161.value) >
        SetDateYYYYMMDD(UpdateForm.alref159.value)) {
        alert(UpdateForm.alref159.title + " must be after " +
        UpdateForm.alref161.title);
        return;
     }
  }
  UpdateForm.target="PopUpFrame1"
  UpdateForm.submit(); 
}
function ForceUpdate(){
  document.UpdateForm.forceflg.value="1";
  UpdateReferral();
}
function displayReason() {
  if (document.UpdateForm.deptlcod.value.substr(30,1)  == "2" ||
      document.UpdateForm.deptlcod.value.substr(30,1)  == "3") {
    reasontitlespan.style.display="";
    reasonfieldspan.style.display="";
    return;
  }
  if (document.UpdateForm.deptlcod.value.substr(30,1)  == "1") {
    reasontitlespan.style.display="";
    reasonfieldspan.style.display="";
    document.UpdateForm.alref028.className="SelectBig Mandatory";
    return;
  }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);setMandEpRef();showTriageStatus();
              displayReason();">
<span class=DFrameTitleBar>
<img border=0 align=right src="../images/ExitIcon.gif" onclick="DFrameExit();">
 %ALLWEB05.06.125.0  Episode Referral - %ALLWEB05.06.081</span>
<div id=PageBodySection style="overflow: auto;">

<form name=UpdateForm action="allweb05.pbl" method=post>
<input type=hidden name=reportno value="6">
<input type=hidden name=updttype value="U">
<input type=hidden name=urnumber value="%ALLWEB05.06.003">
<input type=hidden name=admissno id="admissno" value="%ALLWEB05.06.081">
<input type=hidden name=deptcode id="deptcode" value="%ALLWEB05.06.125.3">
<input type=hidden name=deptIndi id="deptIndi" value="%ALLWEB05.06.125.3">
<input type=hidden name=deptlcod id="deptlcod" value="%ALLWEB05.06.125.3">
<input type=hidden name=alref036 value="">
<input type=hidden name=alref080 value="">
<input type=hidden name=alref081 value="">
<input type=hidden name=alref082 value="">
<input type=hidden name=alref083 value="">
<input type=hidden name=d_alref106 value="%ALLWEB05.06.167.1">
<input type=hidden name=alref138 value="">
<input type=hidden name=alref147 value="">
<input type=hidden name=alref148 value="">
<input type=hidden name=alref149 value="">
<input type=hidden name=nextpage value="5">
<input type=hidden name=alcndevp id=alcndevp 
 value="%STANDARD.01.025.106.225.0.1">
<input type=hidden name=alrestat value="%ALLWEB05.06.199.027">
<input type=hidden name=forceflg value="0">
<input type="hidden" name="d_aldeutrs" id="d_aldeutrs"
 value="%ALLWEB05.06.307.3">
<input type="hidden" name="d_alrestat" id="d_alrestat"
 value="%ALLWEB05.06.199.027">
<input type="hidden" name="d_aldeuprt" id="d_aldeuprt"
 value="%ALLWEB05.06.307.4">

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel>First Consultancy</td>
    <td><input type=checkbox name=alref134 title="First Consultancy"
        value="1">
    </td>
    <td class=DataLabel>%STANDARD.01.017.lG</td>
    <td><select class="SelectMed Readonly" name=alref072 
         title="%STANDARD.01.017.lG" disabled>
        <option></option>
         %ALLWEB05.06.140.33.2
        </select></td>
    </tr>

<tr><td class=DataLabel>Impairment Onset Date</td>
    <td class=DataField>
    <input type=text name=alref163 size=12
     onblur="checkDate(this,'Date')" value="%ALLWEB05.06.199.038"
     class="PastDate" title="Impairment Onset Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref163
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref163>
    </td>
    <td class=DataLabel>Adv. Care Plan Documented Date</td>
    <td class=DataField>
    <input type=text name=alref164 size=12
     onblur="checkDate(this,'Date')" value="%ALLWEB05.06.199.039"
     class="PastDate" title="Advanced Care Plan Documented Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref164
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref164>
    </td>
    </tr>

<tr><td class=DataLabel>Care Plan Documented Date</td>
    <td class=DataField> <input type=text name=alref096 size=12
     onblur="checkDate(this,'Date')" value="%ALLWEB05.06.157"
     class="PastDate" title="Care Plan Documented Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref096
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref096>
    </td>
    <td class=DataLabel>First Appointment Booked Date</td>
    <td class=DataField><input type=text name=alref159 size=12
     onblur="checkDate(this,'Date');" value="%ALLWEB05.06.199.034"
     class="Date Readonly" readonly title="First Appointment Booked Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref159
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref159></td>
    </tr>

<tr><td class=DataLabel>Hospital Discharge Date</td>
    <td class=DataField> <input type=text name=alref165 size=12
     onblur="checkDate(this,'Date')" value="%ALLWEB05.06.199.040"
     class="PastDate" title="Hospital Discharge Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref165
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref165>
    </td>
    <td class=DataLabel>Notified of First Appointment Date</td>
    <td class=DataField><input type=text name=alref161 size=12
     onblur="checkDate(this,'Date')" value="%ALLWEB05.06.199.036"
     class="PastDate Readonly" readonly 
     title="Notified of First Appointment Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref161
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref161>
    </td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.LL</td>
    <td><select name=alref006 class="selectMed Readonly" 
         title="%STANDARD.01.017.LL" disabled>
        <option></option>
         %ALLWEB05.06.106.2
        </select>
    </td>
    <td class=DataLabel>Malignancy Flag</td>
    <td><select name=alref154 title="Malignancy Flag" class="SelectMed Readonly"
         disabled>
        <option></option>
        <option value="0">No</option>
        <option value="1">Yes</option>
       </select></td>
     </tr>

<tr><td class=DataLabel><span id="nameEpRefEvp" style="display:none">
                        %STANDARD.01.017.zG
                        </span>
    </td>
    <td><span id="fieldEpRefEvp" style="display:none">
        <select class="SelectMed Readonly" name=alref145
         title="%STANDARD.01.017.zG" disabled>
        <option></option>
         %ALLWEB05.06.199.016.2
        </select>
        </span>
    </td>
    <td class=DataLabel>Preferred Site</td>
    <td><select name=alref119 class="SelectMed Readonly" disabled
         title="Preferred Site" onchange="SetClinicTypeListRef();">
     <option></option>
      %ALLWEB05.06.182.2
     </select>
    </td>
    </tr>

<tr>
  <td class=DataLabel>Date Referral Accepted</td>
  <td class=DataField>
    <input type=text name=alref090 size=12 onblur="checkDate(this,'Date')"
     value="%ALLWEB05.06.151" class="PastDate" title="Date Referral Accepted">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref090 time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref090>
  </td>
  <td class=DataLabel>Clinic Type</td>
  <td>
    <select name=alref106 class="SelectMed Readonly" disabled
     title="Clinic Type">
    </select>
  </td>
</tr>

<tr><td class=DataLabel><div id="tdHeading"></div></td>
    <td><div id="tdField"></div></td>

    <td class=DataLabel>Referral Date</td>
    <td class=DataField>
    <input type=text title="Referral Date" class="Date Readonly" readonly
     name=d_alref019 value="%ALLWEB05.06.119"></td>
    </tr>

<tr>
  <td class=DataLabel>Episode Patient Ready for Care Date</td>
  <td class=DataField>
    <input type=text name=alref092 size=12
     onblur="checkDate(this,this.title);"
     value="%ALLWEB05.06.153" class="PastDate"
     title="Episode Patient Ready for Care Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref092 
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref092>
  </td>
  <td class=DataLabel><span id="reasontitlespan" style="display:none">
                      Reason for Referral
                      </span>
                     </td>
  <td class=DataField>
    <span id="reasonfieldspan" style="display:none">
      <select title="Reason for Referral" name=alref028 id="alref028"
       class="SelectBig" maxlength=49>
       <option></option>
        %ALLWEB05.06.128.2
       </select>
    </span>
    </td>
</tr>

<tr><td class=DataLabel width=20%>&nbsp;</td>
    <td colspan=3><input type="button" class="Largebutton" id="btnMainHealth"
         value="Episode Health Conditions" onclick="openHealthCondition();" />
    </td>
    </tr>

<tr><td class=DataLabel width=20%>&nbsp;</td>
    <td colspan=3><input type="button" class="Largebutton" id="btnOtherFactors"
         value="Other Factors Affecting Health"
         onclick="openOtherFactorsAffectingHealth();"/>
    </td>
    </tr>

<tr><td class=DataLabel width=20%>&nbsp;</td>
    <td colspan=3><input type="button" class="Largebutton"
         id="btnReferralDestination" name="btnReferralDestination"
         value="Referral Out" onclick="openReferralDestination();"/>
    </td>
    </tr>
</table>

<span id=InsertAssessButton style="display: none">
<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td class=DataLabel width=20%>&nbsp;</td>
    <td colspan=3>
    <input type="button" class="Largebutton" id="btnAssessments" 
     name="btnAssessments" value="Assessments" onclick="openAssessments();"/>
    </td>
    </tr>
</table>
</span>

<table align=center cellspacing=0 cellpadding=1 border=0 width=95%>
<tr><td align=center><br>
    <input type=button name=formactn value="Force Update" class="button"
     id="all05f" onclick="tempDisable(this);ForceUpdate();">
    <input type=button name=formactn value="OK" class="button"
     id="all05u" onclick="tempDisable(this);UpdateReferral();">
    <input type=button Value="Close" class="button"
     onclick="DFrameClose();">
    </td></tr>
</table>
</form>

<span id="showtdHeading" style="display:none">
Triage Date
</span>

<span id="showtdField" style="display:none">
<input type=text name=alref187 id=alref187 size=12 title="Triage Date"
 value="%ALLWEB05.06.199.067" class="PastDate"
 onblur="checkTriageDate();">
<img src=../images/DateTimeStamp.gif class=Icon
 date=UpdateForm.alref187 time=null>
<img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref187>
</span>

<script type="text/javascript">
 BulkBill="%ALLWEB05.06.136";
 if ( BulkBill == "Yes") {
   document.UpdateForm.alref036.value=1;
 }
//
 UYN1="%ALLWEB05.06.141";
 if ( UYN1 == "Yes") {
   document.UpdateForm.alref080.value=1;
 }
//
 UYN2="%ALLWEB05.06.142";

 if ( UYN2 == "Yes") {
   document.UpdateForm.alref081.value=1;
 }
//
 UYN3="%ALLWEB05.06.143";
 if ( UYN3 == "Yes") {
   document.UpdateForm.alref082.value=1;
 }
//
 MasterRef="%ALLWEB05.06.144";
 if ( MasterRef == "Yes") {
   document.UpdateForm.alref083.value=1;
 } else {
   document.UpdateForm.alref083.value=0;
 }
//
 UYN5="%ALLWEB05.06.199.005";
 if ( UYN5 == "Yes") {
   document.UpdateForm.alref134.checked=1;
 }
//
 UYN6="%ALLWEB05.06.199.009";
 if ( UYN6 == "Yes") {
   document.UpdateForm.alref138.value=1;
 }
//
 UYN7="%ALLWEB05.06.199.019";
 if ( UYN7 == "Yes") {
   document.UpdateForm.alref147.value=1;
 }
//
 UYN8="%ALLWEB05.06.199.020";
 if ( UYN8 == "Yes") {
   document.UpdateForm.alref148.value=1;
 }
//
 UYN9="%ALLWEB05.06.199.021";
 if ( UYN9 == "Yes") {
   document.UpdateForm.alref149.value=1;
 }
//
 Malignancy="%ALLWEB05.06.199.029";
 if ( Malignancy == "Yes") {
   document.UpdateForm.alref154.selectedIndex=2;
 } else if (Malignancy == "No ") {
   document.UpdateForm.alref154.selectedIndex=1;
 }
//
 REFERRALDESTINATION="%ALLWEB05.06.413";
 MAINHEALTH="%ALLWEB05.06.408";
 OTHERFACTORS="%ALLWEB05.06.410";
 itemExistInCollection("btnReferralDestination",REFERRALDESTINATION);
 itemExistInCollection("btnMainHealth",MAINHEALTH);
 itemExistInCollection("btnOtherFactors",OTHERFACTORS);
//
Assessments=document.UpdateForm.deptcode.value.substr(10,1);
if ( ("%ALLWEB05.06.304.3" == "1") ||
     (Assessments == "T" || Assessments == "H") ) {
  InsertAssessButton.style.display="";
  AssessInd="%ALLWEB05.06.305";
  if ( AssessInd =="1" ) {
    document.all.btnAssessments.style.color = "red";
  }
}
</script>
