<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/mrtweb05.js"></script>
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">

var TypeOfChangeArray = new Array();
var TypeOfChangeObject = new Object();
var TOCProperty = "";
var TOCValue = "";
var option = new Option();

function loadTypeOfChange() {

  for (x=0; x<document.AddForm.mrauc011.length; x++) {
    TypeOfChangeObject = new Object();
    TypeOfChangeObject.TOCProperty=document.AddForm.mrauc011[x].innerHTML; 
    TypeOfChangeObject.TOCValue=document.AddForm.mrauc011[x].value;

    TypeOfChangeArray.push(TypeOfChangeObject);
  }     

}
function modifyTypeOfChange() {

  for (x=document.AddForm.mrauc011.length; x>=0; x--) {
      document.AddForm.mrauc011.remove(x); 
  }

  if (isWhitespace(document.AddForm.mrauc010.value)) {
    return;
  }

  if (document.AddForm.mrauc010.value.substr(3,1) == 0 &&
      !isWhitespace(document.AddForm.mrauc010.value)) {
    for (x=0; x<TypeOfChangeArray.length; x++) {
      option = new Option();
      option.text = TypeOfChangeArray[x].TOCProperty;
      option.value = TypeOfChangeArray[x].TOCValue;
      document.AddForm.mrauc011.add(option);
    }
    return;
  }

  for (x=0; x<TypeOfChangeArray.length; x++) {

    if (isWhitespace(TypeOfChangeArray[x].TOCValue) ||
        TypeOfChangeArray[x].TOCValue.substr(3,1) == 0) {
      option = new Option();
      option.text = TypeOfChangeArray[x].TOCProperty;
      option.value = TypeOfChangeArray[x].TOCValue;
      document.AddForm.mrauc011.add(option); 
    } else { 
      if (TypeOfChangeArray[x].TOCValue.substr(3,1) ==
          document.AddForm.mrauc010.value.substr(3,1)) {
          option = new Option();
          option.text = TypeOfChangeArray[x].TOCProperty; 
          option.value = TypeOfChangeArray[x].TOCValue;
          document.AddForm.mrauc011.add(option);
      }  
    }
  }
}
function afterNewDRG() {
 a=AddForm;
 getWIES(a.admissno,a.mrauc006,a.d_mrauc006,a.mrauc007);
 clearNWAU(a.mrauc007);
 getDiff(a.mrauc007,a.mrauc005,a.mrauc008);
}

function afterOrigDRG() {
 a=AddForm;
 getWIES(a.admissno,a.mrauc004,a.d_mrauc004,a.mrauc005);
 clearNWAU(a.mrauc005);
 getDiff(a.mrauc007,a.mrauc005,a.mrauc008);
}
function clearNWAU(nwau) {
 if(document.getElementById('using_nwau').value!="1") {
   return;
 }
 nwau.value="";
}

function setMandatoryFields() {
  AddForm.mrauc006.className="Mandatory"
  AddForm.mrauc007.className="Mandatory Number"
  AddForm.mrauc004.className="Mandatory"
  AddForm.mrauc005.className="Mandatory Number"
  AddForm.mrauc009.className="Mandatory"
  AddForm.mrauc011.className="Mandatory";
  AddForm.chckchng.checked=false;
  AddForm.mrauc012.value="N";
}
function setNoChangeField() {
  AddForm.chckchng.checked=true;
  AddForm.mrauc012.value="Y";
}

function SubmitAdd() {
  var a=document.AddForm;
  if (validateMandatory(a)) {
    UpdateDiff(a);
    a.submit();
  }
  return
}

function UpdateDiff(theForm) {
  // Updates the differences for New/Original WIES and $ fields
  if (!theForm || theForm == undefined)
    return;

  RoundNumber(theForm.mrauc007,'4');
  RoundNumber(theForm.mrauc005,'4');
  getDiff(theForm.mrauc007,theForm.mrauc005,theForm.mrauc008);

  RoundNumber(theForm.mrauc023,'2');
  RoundNumber(theForm.mrauc022,'2');
  getDiff(theForm.mrauc023,theForm.mrauc022,theForm.mrauc024);
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);loadTypeOfChange();modifyTypeOfChange()">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
<script type="text/javascript">document.write(self.document.title);</script>
</span>

<form name=AddForm method=post action=mrtweb05.pbl style="margin:0">
 <input type=hidden name=reportno value="1">
 <input type=hidden name=template value="002">
 <input type=hidden name=updttype value="A">
 <input type=hidden name=urnumber value="%MRTWEB05.01.003">
 <input type=hidden name=admissno value="%MRTWEB05.01.081">
 <input type=hidden name=admissdt value="%MRTWEB05.01.102">
 <input type=hidden name=defltman value="%MRTWEB05.01.405">
 <input type=hidden name=d_mrcnunwa id=d_mrcnunwa
 value="%STANDARD.01.025.061.240.0.1">
 <input type=hidden name=d_mrcnenwa id=d_mrcnenwa
  value="%STANDARD.01.025.061.241.0.8">
 <input type=hidden name=d_discdate id=d_discdate
  value="%MRTWEB05.01.201">
 <input type=hidden name=using_nwau id=using_nwau
  value="0">

<table align=center width=98% border=0>
<tr><td>
<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Admission</td>
    <td class=DataField>%MRTWEB05.01.081</td>
    <td align=center colspan=2>Admission Date - Discharge Date<br>
    <b>%MRTWEB05.01.102 - %MRTWEB05.01.201</b></td></tr>

<tr valign=top><td class=DataLabel width=20%>Discharge Unit</td>
    <td class=DataField>%MRTWEB05.01.066.0</td></tr>

<tr><td class=DataLabel width=20%>Audit Date</td>
    <td><input type=text name=mrauc003 id=mrauc003 title="Audit Date"
         size=12 maxlength=12 class="Mandatory PastDate"
         value="%STANDARD.01.015"
         onblur="checkDate(this,'Audit Date');checkBefAdm(mrauc003,admissdt);"> 
        <img notab src="../images/DateTimeStamp.gif" class="Icon"
         alt="Current" date="AddForm.mrauc003">
        <img notab src="../images/DateLookup.gif" class="Icon"
         alt="Calendar" date="AddForm.mrauc003"></td> 
    <td class=DataLabel width=20%>Type of Audit</td>
    <td><select name=mrauc010 id=mrauc010 class=Mandatory title="Type of Audit"
         onchange="modifyTypeOfChange();"> 
        <option></option>
        %MRTWEB05.01.310.4
        </select></td></tr>
</table>

<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>New DRG</td>
    <td colspan=3>
        <input type=text name=mrauc006 id=mrauc006 size=11 maxlength=4 
         title='New DRG' value="%MRTWEB05.01.402.1"
         onchange="getWIES(admissno,mrauc006,d_mrauc006,mrauc007);
                   clearNWAU(AddForm.mrauc007);">
        <input type=text name=d_mrauc006 id=d_mrauc006 size=60 
         title='DRG Description' readOnly class=Readonly 
         value="%MRTWEB05.01.402.0" tabindex=-1>
        <img src="../images/SearchIcon.gif" class="Icon" alt="Search"
         onclick='DrgSearchFrame(mrauc006,d_mrauc006,afterNewDRG)'></td></tr>

<tr><td class=DataLabel id="WIESLabel">New WIES</td>
    <td><input type=text name=mrauc007 id=mrauc007 size=11 maxlength=11 
         title='New WIES' class="Number" value="%MRTWEB05.01.403"
         onblur="RoundNumber(mrauc007,'4');
                 getDiff(mrauc007,mrauc005,mrauc008);"></td>
    <td class=DataLabel>New $ Value</td>
    <td><input type=text name=mrauc023 id=mrauc023 size=15 maxlength=15 
         title='New $ Value' class="Number" value="0"
         onblur="RoundNumber(mrauc023,'2');
                 getDiff(mrauc023,mrauc022,mrauc024);"></td></tr>

<tr><td class=DataLabel>Original DRG</td>
    <td colspan=3>
        <input type=text name=mrauc004 id=mrauc004 size=11 maxlength=4 
         title='Original DRG' value="" 
         onchange="getWIES(admissno,mrauc004,d_mrauc004,mrauc005);
                   clearNWAU(AddForm.mrauc005);">
        <input type=text name=d_mrauc004 id=d_mrauc004 size=60 
         title='DRG Description' readOnly class=Readonly tabindex=-1 value="">
        <img src="../images/SearchIcon.gif" class="Icon" alt="Search"
         onclick='DrgSearchFrame(mrauc004,d_mrauc004,afterOrigDRG)'></td></tr>

<tr><td class=DataLabel id="WIESLabel1">Original WIES</td>
    <td><input type=text name=mrauc005 id=mrauc005 size=11 maxlength=11 
         title='Original WIES' class="Number" value=""
         onblur="RoundNumber(mrauc005,'4');
                 getDiff(mrauc007,mrauc005,mrauc008);"></td>
    <td class=DataLabel>Orig $ Value</td>
    <td><input type=text name=mrauc022 id=mrauc022 size=15 maxlength=15
         title='Orig $ Value' class="Number" value="0"
         onblur="RoundNumber(mrauc022,'2');
                 getDiff(mrauc023,mrauc022,mrauc024);"></td></tr>

<tr><td class=DataLabel id="WIESLabel2">WIES Difference</td>
    <td><input type=text name=mrauc008 id=mrauc008 size=11 maxlength=11 
         tabindex=-1 title='WIES difference' class="Readonly Number" readOnly>
    </td>
    <td class=DataLabel>$ Difference</td>
    <td><input type=text name=mrauc024 id=mrauc024 size=15 maxlength=15 
         tabindex=-1 title='$ difference' class="Readonly Number" readOnly 
         value="0"></td></tr>

<tr><td class=DataLabel>Clinician</td>
    <td colspan=3>
        <input type=text name=mrauc009 id=mrauc009 class=DataField size=11 
         maxlength=10 value="%MRTWEB05.01.108.003" title="Clinician Code"
         onblur="ValidateHCP(18,0,mrauc009,d_mrauc009);">
        <input type=text name=d_mrauc009 id=d_mrauc009 class=Readonly 
         title="Clinician" value="%MRTWEB05.01.108.002" readonly size=37 
         maxlength=35 tabindex=-1>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(mrauc009,d_mrauc009,1);" >
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(mrauc009,d_mrauc009);"></td></tr>

<tr><td class=DataLabel>Auditor</td>
    <td colspan=3>
      <input type=text name=mrauc021 id=mrauc021 class=Mandatory size=30 
       maxlength=30 value="%STANDARD.01.009" title="Auditor"></td></tr>

<tr><td class=DataLabel>Type of Change</td>
    <td colspan=3><select name=mrauc011 id=mrauc011 title="Type of Change"> 
        <option></option>
        %MRTWEB05.01.311.2
        </select> 
    &nbsp;&nbsp;&nbsp;
    No Change &nbsp;&nbsp;
    <input type=hidden name=mrauc012 id=mrauc012 value="N">
    <input type=checkbox name=chckchng id=chckchng title="No Change"
     onclick="CheckChange(AddForm);"></td></tr>

<tr><td class=DataLabel>Comment</td> 
    <td colspan=3><textarea name=mrauc013 id=mrauc013 cols=50 rows=2 wrap=hard 
     title="Comments" onblur="checkMaxComm(mrauc013);"></textarea>
     &nbsp;&nbsp;&nbsp;PRS2 Sent Date&nbsp;&nbsp;<b>%MRTWEB05.01.404</b></td>
</tr>
 
<tr><td colspan=4 align=center><br>
    <input type=button value="Add" class="button" id=AddButtn name=AddButtn
     onclick="tempDisable(this);SubmitAdd();">
    <input type=button value="Close" class="button" 
     onclick="DFrameCloseRefresh();"></td></tr>

</table>

</td></tr>
</table>
</form>

<script type="text/javascript">
var defaultMandatory = '%MRTWEB05.01.405';
if (defaultMandatory.substr(0,1) == '1') {
  setMandatoryFields();
}
if (defaultMandatory.substr(1,1) == '1') {
  setNoChangeField();
}
if(showNWAUTitle(AddForm.d_mrcnunwa,AddForm.d_mrcnenwa,
   AddForm.d_discdate)) {
   document.getElementById('WIESLabel').innerText="New NWAU";
   document.getElementById('mrauc007').title="New NWAU";
   document.getElementById('WIESLabel1').innerText="Original NWAU";
   document.getElementById('mrauc005').title="Original NWAU";
   document.getElementById('WIESLabel2').innerText="NWAU Difference";
   document.getElementById('mrauc008').title="NWAU Difference";
}
function showNWAUTitle(usingNWAU,effdate,ddate) {
  if(usingNWAU.value != "1") {
    return false;
  }
  if(SetDateYYYYMMDD(ddate.value) < effdate.value) {
     return false;
  }
  document.getElementById('using_nwau').value="1";
  return true;
}
</script>
