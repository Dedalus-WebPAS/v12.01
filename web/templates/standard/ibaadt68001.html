<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">

function CalcToDate() {
  ReportForm.maxtdate.value=ReportForm.currdate.value;
  var frdate = "";
  frdate=SetDateDDMMMYYYY(ReportForm.maxtdate.value);

  ReportForm.maxtdate.value=frdate;
  AddSubtractDate(ReportForm.maxtdate,ReportForm.numbdays.value,"S");
  ReportForm.d_keystr02.value = ReportForm.maxtdate.value;

}

function valHfund(ReturnFund,FundName) {
  if(!isWhitespace(ReturnFund.value)) {
     validateCode(16,ReturnFund,FundName);
     ReportForm.healthgr.disabled=true;
  }
  if(isWhitespace(ReturnFund.value)) {
    ReturnFund.value="";
    FundName.value="";
    SetDefaultFundGroup();
  }
}

function SetDefaultFundGroup() {
  ReportForm.healthgr.disabled=false;
  ReportForm.healthfn.className='';
}

function SetHFGroup() {
  if(ReportForm.healthfn.disabled) {
    alert('Either Health Fund code or Health Fund Group can be entered');
  }
  else {
    HFundSearchFrame(healthfn,funddesc,
                     function() { valHfund(healthfn,funddesc);});
  }
}

function SetHFund(ReturnFund) {
  if(!isWhitespace(ReturnFund.value)) {
    ReportForm.healthfn.disabled=true
  }
  if(ReturnFund.selectedIndex == 0) {
    ReportForm.healthfn.disabled=false;
  }
}

function ProcessReport() {
  if (!validateMandatory(ReportForm)) { 
     return; 
  }

  if(ReportForm.multiple.selectedIndex == -1) {
    alert("Please select the " + trim(ReportForm.multiple.title) + " value(s)");
    return;
  }
  if(ReportForm.multipl1.selectedIndex == -1) {
    alert("Please select the " + trim(ReportForm.multipl1.title) + " value(s)");
    return;
  }
  var keycount=0;
  for (i=0; i < ReportForm.multiple.options.length; i++) {
      if(ReportForm.multiple.options[i].selected == true) {
        keycount++;
      }
  }
  for (i=0; i < ReportForm.multipl1.options.length; i++) {
      if(ReportForm.multipl1.options[i].selected == true) {
        keycount++;
      }
  }
  if(keycount>=130) {
    alert("Error a maximum of 130 selections has been exceeded.");
  }

  if (ReportForm.healthfn.disabled==true) {
     ReportForm.keystr05.value="";
     ReportForm.keystr06.value=ReportForm.healthgr.value;
  } else {
    if (ReportForm.healthgr.disabled==true) {
     ReportForm.keystr05.value=ReportForm.healthfn.value;
     ReportForm.keystr06.value="";
    } else {
     ReportForm.keystr05.value="";
     ReportForm.keystr06.value="";
    }
  }
  
  if(ReportForm.d_keystr07.checked==true) {
     ReportForm.keystr07.value="Y";
  } else {
     ReportForm.keystr07.value="N";
  }

  ReportForm.keystr02.value = SetDateDDMMYYYY(ReportForm.d_keystr02.value);
  ReportForm.keystr02.value = ReportForm.numbdays.value;

  SubmitReport(ReportForm);

}

function CheckPastDate(InpFld, Title) {
  if (isWhitespace(InpFld.value)) {
    return true;
  }

  if (checkDate(InpFld,Title)) {
    var InpDate = SetDateYYYYMMDD(InpFld.value);
    var Today = new Date()
    var ThisDay=Today.getDate();
    var ThisMth=parseInt(Today.getMonth(),10) +1;
    var ThisYrs=Today.getFullYear();
    if (ThisDay < 10) ThisDay="0" + ThisDay
    if (ThisMth < 10) ThisMth="0" + ThisMth
    ThisDate="";
    ThisDate=ThisDate.concat(ThisYrs,ThisMth,ThisDay);

    if (InpDate >= ThisDate) {
      alert(Title + " must be in the Past.");
      InpFld.value="";
      InpFld.select();
      InpFld.focus();
      return false;
    }
  }
  return true;
}
function ValidateSelect(IncludeExclude,List) {
  if(IncludeExclude[0].checked != true &&
     List.selectedIndex==0) {
     alert("Invalid option exclude All");
     List.options[0].selected=false;
  }
  if (List.selectedIndex == 0) {  // 'All' option selected
    for (i=1; i < List.options.length; i++) {
      List.options[i].selected = false;  // de-select all other options
    }
  }
}
function ClearSelect(List) {
    for (i=0; i < List.options.length; i++) {
      List.options[i].selected = false;  // de-select all options
    }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ReportLoad();">
<form name=ReportForm method=post action=rshweb02.pbl>
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=001>
<input type=hidden name=updttype value="A">
<input type=hidden name=nextpage value="1">
<input type=hidden name=setdfprg value="IBAADT68">
<input type=hidden name=setdfrep value="01">
<input type=hidden name=schdpgid value="IBAADT68">    
<input type=hidden name=schddesc value="Update Complete Date on Past Future Action">
<input type=hidden name=schdtype value="3">
<input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=1">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=ptcnsmsn value="%STANDARD.01.025.120.243.0.1">
<input type=hidden name=keystr01 value="1">
<input type=hidden name=keystr02 value="">
<input type=hidden name=facode value="FA">
<input type=hidden name=w0code value="w0">
<input type=hidden name=currdate value="%STANDARD.01.013">
<input type=hidden name=maxtdate value="">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>
  Update Complete Date on Past Future Action</td>
</tr>
</table>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text id=schddate name=schddate size=12 title="Schedule Date"
    value="%STANDARD.01.015"
    onblur="checkDate(this,'Schedule Date');">
    <img src=../images/DateLookup.gif class=Icon alt="Show Calendar"
     onclick="DateLookupFrame(schddate);">
    Time
    <input type=text id=schdtime name=schdtime size=12 title="Schedule Time"
    value="%STANDARD.01.016">
    <img src=../images/DateTimeStamp.gif alt="Schedule Time" class=Icon
     onclick="SetCurrentDateTime(schddate,schdtime);">
    <img src=../images/TimeLookup.gif class=Icon alt="Time Select"
     onclick="TimeLookupFrame(schdtime);">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><select name=schdprnt title="Printer" class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBAADT68.01
        </select>
    </td></tr>

<tr><td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy title='Number of Copies' class=Mandatory>
        </select>
    </td></tr>
 
<tr><td class=DataLabel>Re-schedule Type</td> 
    <td class=DataLabel colspan=3> 
    <select name=schdrdat title="Schedule Type" onchange="SetReportDates();"> 
      <option value=""></option> 
    </select> 
    </td></tr> 
 
<tr><td class=DataLabel>Re-schedule Until Date</td> 
    <td class=DataLabel colspan=3> 
    <input type=text id=schdrend name=schdrend size=12 
     onblur="checkDate(this,'Re-schedule Until Date');"> 
    <img src=../images/DateTimeStamp.gif class=Icon alt="Current"
     onclick="SetCurrentDateTime(schdrend,null);"> 
    <img src=../images/DateLookup.gif class=Icon alt="Show Calendar"
     onclick="DateLookupFrame(schdrend);">
    </td></tr>
 
<tr><td colspan=2 align=center><hr width=80%></td></tr>
</table>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>

<tr><td class=DataLabel>Date Older than</td>
    <td><select name=numbdays id=numbdays title="Date Older than" 
         class=Mandatory onchange="CalcToDate();">
        <option></option>
        <option value=" 90">90 Days</option>
        <option value="180">180 Days</option>
        <option value="365">365 Days</option>
        </select>
    </td>
    <td><input type=text name=d_keystr02 id=d_keystr02 size=12
    readonly class="Readonly" tabindex="-1">
    </td>
</tr>

<tr><td class=DataLabel width=25%>Future Action Code</td>
    <td width=12%><input type=radio name=keystr03 value="N" checked
         onclick="ClearSelect(ReportForm.multiple);">&nbsp;Include
        <input type=radio name=keystr03 value="E"
         onclick="ClearSelect(ReportForm.multiple);">&nbsp;Exclude&nbsp;
    </td><td width=15%>
        <select name=multiple id=multiple multiple="multiple"
         title="%STANDARD.01.035.FA" class="SelectMultipleLarge SelectBig"
         onclick="ValidateSelect(ReportForm.keystr03,this);">
        <option value=" ">All</option>
        %RSHWEB02.01.199.012.2
        </select>
    </td><td align=left>Press CTRL or SHIFT to select multiple codes
    </td></tr>

<tr><td class=DataLabel>Occupational Group</td>
    <td><input type=radio name=keystr04 value="N" checked
         onclick="ClearSelect(ReportForm.multipl1);">&nbsp;Include
        <input type=radio name=keystr04 value="E"
         onclick="ClearSelect(ReportForm.multipl1);">&nbsp;Exclude&nbsp;
    </td><td>
        <select name=multipl1 id=multipl1 multiple="multiple"
         title="%STANDARD.01.035.w0" class="SelectMultipleLarge SelectBig"
         onclick="ValidateSelect(ReportForm.keystr04,this);">
        <option value=" ">All</option>
        %RSHWEB02.01.199.013.2
        </select>
    </td><td align=left>Press CTRL or SHIFT to select multiple codes
    </td></tr>

</table>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Health Fund </td>
    <td class=DataField>
    <input type="text" size="6" id=healthfn name="healthfn" maxlength="6"
    title="Health Fund"
    onblur="valHfund(healthfn,funddesc);" />
    <input type="text" size="40" id="funddesc" name="funddesc"
    title="Health Fund" readonly class="Readonly" tabindex="-1" />
    <img src="../images/SearchIcon.gif" id=hfimg border="0" hspace="0"
    class="Icon" notab onclick="SetHFGroup();" />
    <img src="../images/erase.gif" class="Icon" notab
    onclick="clrFields(healthfn,funddesc);SetDefaultFundGroup();">
</td></tr>
<tr><td>OR</td></tr>

<tr><td class=DataLabel>Health Fund Group </td>
    <td class=DataField>
        <select name=healthgr id=healthgr style="width:250px;" class="SelectMed"
         title="Health Fund Group" onchange="SetHFund(healthgr);">
        <option value="All">All</option>
        %RSHWEB02.01.113
        </select>
</td></tr>

        <input type=hidden name=keystr05 value=" ">
        <input type=hidden name=keystr06 value=" ">
        <input type=hidden name=keystr07 value=" ">

<tr><td class=DataLabel>Zero $ Invoice Balance</td>
    <td><input type=checkbox name="d_keystr07" id="d_keystr07"
    value=1 title="Zero $ Invoice balance">
</td></tr>

        <input type=hidden name=keystr09 value="%STANDARD.01.008">
        <input type=hidden name=keystr10 value="Y">
        <input type=hidden name=keystr11 value=" ">

</table>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td align=center colspan=2><br>
      <input type=button value="OK" class="button" name=btn_ok id=btn_ok
       onclick='ProcessReport();'>
      <input type=button value="Cancel" class="button"
       onclick='location.href="../lookups/blank.html"' >
    </td>
</tr>
</table>
</form>

<div id=SetDateRange style="display:none;">
    <input type=text name=datran02 id=datran02 size=12
     onblur="checkDate(this,'Date Older')" class="Mandatory PastDate"
             title="Date Older">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="document.ReportForm.datran02">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Show Calendar" date="document.ReportForm.datran02">
</div>

<div id=SetScheduleRange style="display:none;">
    <select name=datsch01 id=datsch01 title="Schedule Range" class=Mandatory
    onblur="UpReportSchedule(this,document.ReportForm.SampleFrom,document.ReportForm.d_keystr02)">
    <option></option></select>
    Sample
    <input type=hidden name=SampleFrom id=SampleFrom size=12>
    <input type=text name=SampleTo id=SampleTo size=12>
</div>

