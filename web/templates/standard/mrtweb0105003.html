<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript" src="../js/mrtweb01.js"></script>
<script type="text/javascript" src="../js/mrtweb0105.js"></script>
<script type="text/javascript" src="../js/MrtHomeLocns.js"></script>
<script type="text/javascript" src="../js/MrtMultiHomeLocns.js"></script>
<script type="text/javascript">
function HistoryLink(key) {
 LinkUrl="mrtweb01.pbl?reportno=10&template=3" +
         "&mrhiskey=" + key.replace(/ /g,"+") +
         "&urnumber=" + document.PatientLinks.urnumber.value +
         "&superlev=" + document.PatientLinks.superlev.value;
 Left=(document.body.clientWidth-450)/2;
 DFrameLink(LinkUrl,155,Left,450,120);
}
function setUpdateType(type) {
  document.UpdateForm.updttype.value=type;
  p=document.UpdateForm;
  p.redirect.value="mrtweb01.pbl?reportno=05&template=001" +
                   "&urnumber=" + p.urnumber.value.replace(/ /g,"+") +
                   "&admissno=" + p.admissno.value.replace(/ /g,"+") +
                   "&superlev=" + p.superlev.value.replace(/ /g,"+") ;
  if (type=="U") {
    if (validateMandatory(UpdateForm)) {
       document.UpdateForm.submit(); } }
  else {
    if (type=="D") {
     ans=confirm("Are you sure you want to Delete ?")
  if (ans) { document.UpdateForm.submit(); } }
    else {
       document.UpdateForm.submit(); } }
}
function SetPage() {
  SetHospital(UpdateForm);
  SetLocation(UpdateForm);
}
function CheckRetention() {
  p=document.UpdateForm;
  if(!ValidateRecStatus(p.urnumber,p.mrtms004)){
    document.UpdateForm.mrtms004.value="";
    document.UpdateForm.mrtms004.focus();
    return;
  }
}
//----------------------------------------------------------------------------
// Columns Available
//  0 - HTML Link                   
//  1 - Movement Date & Time
//  2 - Due Date & Time
//  3 - Location
//  4 - Requested By
//  5 - Reason
//  6 - Web User
//  7 - History Status
//  8 - Receipt Status
//  9 - Receipt Date
// 10 - Moved by User 
// 11 - Movement Comments
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 document.title="Movement History"
 if(UpdateForm.mrcntrec.value!=1) {   // Display receipt status fields 
   t = new Table(1,0,2,"100%","center",35,35);
   t.addColumn("Movement Date","DateTime",1,1,"left","EditIcon.gif","0",140);
   t.addColumn("Due Date","Date",2,2,"left","","",80);
   t.addColumn("Location","String",3,3,"left","","",130);
   t.addColumn("Movement Comments","String",11,11,"left","","",100);
   t.addColumn("Requested By","String",4,4,"left","","",100);
   t.addColumn("Reason","String",5,5,"left","","",100);
   t.addColumn("Moved by User","String",6,6,"left","","",90);
 } else {
   t = new Table(1,0,2,"100%","center",35,35);
   t.addColumn("Movement Date","DateTime",1,1,"left","EditIcon.gif","0",140);
   t.addColumn("Due Date","Date",2,2,"left","","",70);
   t.addColumn("Location","String",3,3,"left","","",70);
   t.addColumn("Receipt Status","String",8,8,"left","","",55);
   t.addColumn("Receipt Date","DateTime",9,9,"left","","",70);
   t.addColumn("Received By","String",10,10,"left","","",55);
   t.addColumn("Requested By","String",4,4,"left","","",60);
   t.addColumn("Reason","String",5,5,"left","","",60);
   t.addColumn("Moved by User","String",6,6,"left","","",60);
 }
 AddTableRows();
 TableOutput(0,2);    // Order Column,Asc Dsc
 break; }
}
}
</script>
</head>
%START.OF.PAGE
<body onload='PageLoad(event);SetPage();InitTable(0);SetCookie("mrtmovcookie","");'>
<div id="HeadingSection">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%MRTWEB01.05.003";
PatientVIS="%MRTWEB01.05.081";
PatientNAM="%MRTWEB01.05.002";
PatientSTA="%MRTWEB01.05.086.078";
PatientALT="%MRTWEB01.05.084";
PatientSEX="%MRTWEB01.05.019";
PatientDOB="%MRTWEB01.05.020";
PatientAGE="%MRTWEB01.05.021";
PatientLOC="%MRTWEB01.05.083";
PatientPRI="%MRTWEB01.05.086.066.1";
PatientUNT="%MRTWEB01.05.066.0";
DoctorCOD="%MRTWEB01.05.082.003";
DoctorNAM="%MRTWEB01.05.082.002";
PatientAID="%MRTWEB01.05.086.090";
PatientIND="%MRTWEB01.05.086.091";
PatientCUR="%MRTWEB01.05.086.092";
PatientCLC="%MRTWEB01.05.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%MRTWEB01.05.086.094";
PatientCDM="%MRTWEB01.05.086.095";
PatientVDH="%MRTWEB01.05.086.099.015";
InsertPatientHeader()
</script>

<div id=PatientMenu></div>

<form name=UpdateForm method=post action=mrtweb01.pbl style="margin:0">
<input type=hidden name=reportno value="5">
<input type=hidden name=template value="001">
<input type=hidden name=updttype value="">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="%MRTWEB01.05.001.mrtweb01.05.001">
<input type=hidden name=urnumber value="%MRTWEB01.05.101">
<input type=hidden name=mrtms006 value="%MRTWEB01.05.107">
<input type=hidden name=savedkey value="%MRTWEB01.05.122">
<input type=hidden name=admissno value="%MRTWEB01.05.081">
<input type=hidden name=superlev value="%MRTWEB01.05.136">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=wbsehosp value="%STANDARD.01.032">
<input type=hidden name=deflhosp value="%MRTWEB01.05.102.4">
<input type=hidden name=defllocn value="%MRTWEB01.05.102.1"> 
<input type=hidden name=mrcntrec value="%STANDARD.01.025.097.176.0.1">

<table cellspacing=0 cellpadding=0 width=100%>
<tr><td class=HeadingCell align=center>
    Update Medical Records </td>
<!-- Display Multi Hospital for Home Location when ibcnmhos=1 -->
<td class=HeadingCell align=right>%MRTWEB01.05.132</td>
</tr>
<tr><td align=center>
<table width=100%>

<tr valign=top>
    <td class=DataLabel width=10%><div id=HospitalTitle></div></td>
    <td><div id=Hospital></div></td>

    <td class=DataLabel>Home Location</td>
    <td><select name=mrtms001 id=mrtms001 class=Mandatory
         title="Home Location">
        </select></td>

    <td class=DataLabel>Type of Document</td>
    <td><select name=mrtms002 id=mrtms002 class=Mandatory
         title="Type of Document">
          <option></option>
          %MRTWEB01.05.103.2
        </select></td>

    <td class=DataLabel>Volume </td>
    <td><input type=text name=mrtms003 id=mrtms003 class=ReadOnly
       title="Volume Number"
       size=1 maxlength=1 readonly value="%MRTWEB01.05.104">
    </td></tr>

<tr valign=top>
    <td class=DataLabel>Status</td>                               
    <td><select name=mrtms004 id=mrtms004 class=Mandatory title="Status"
         onchange="CheckRetention();">
        <option></option>
        %MRTWEB01.05.105.2
        </select></td>

    <td class=DataLabel>Comments</td>
    <td><input type=text name=mrtms005 id=mrtms005 title="Comments" 
       size=23 maxlength=20 value="%MRTWEB01.05.106"></td>
     
    <td class=DataLabel>Microfilm Address</td>
    <td><input type=text name=mrtms007 id=mrtms007 title="Microfilm Address" 
       size=27 maxlength=25 value="%MRTWEB01.05.124"></td></tr>

<tr valign=top>
  <td class=DataLabel>Created By</td>
    <td>%MRTWEB01.05.144 %MRTWEB01.05.145 %MRTWEB01.05.146</td>
  <td class=DataLabel>Updated By</td>
    <td>%MRTWEB01.05.147 %MRTWEB01.05.148 %MRTWEB01.05.149</td>
</tr>
<tr valign=top style="text-align: center">
  <td colspan=9>
    <br>
    <input type=button value="Update" class="button" 
     onclick='tempDisable(this);setUpdateType("U");'>
    <input type=button value="Cancel" class="button"
     onclick='PatientLinkTo("mrtweb01.pbl",5,1,0,0,0);'>
    <input type=button value="Movements" class="button"
     onclick='PatientLinkTo("mrtweb01.pbl",5,3,0,0,0);'>
    <input type=button value="Visits" class="button"
     onclick='PatientLinkTo("mrtweb01.pbl",5,4,0,0,0);'>
    <input type=button value="Requests" class="button"
     onclick='PatientLinkTo("mrtweb01.pbl",5,5,0,0,0);'>
    <input type=button value="Bar Code Labels" class="button"
     onclick='PatientLinkTo("mrtweb01.pbl",15,1,1,270,130);'>

    <span id="deletebutton" style="display: none;">
      <input type=button value="Delete" class="button" 
      onclick='tempDisable(this);setUpdateType("D");'>
    </span>
    <br><br>
  </td>
</tr>
</tr>
</table>
</table>
</form>
</div>

<span id=TableLocation></span>

<script type="text/javascript">
function AddTableRows() {
 %MRTWEB01.05.112
}
</script>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%MRTWEB01.05.003">
<input type=hidden name=admissno value="%MRTWEB01.05.081">
<input type=hidden name=medrecky value="%MRTWEB01.05.107">
<input type=hidden name=mrtms008 value="%MRTWEB01.05.102.3">
<input type=hidden name=mrtms001 value="%MRTWEB01.05.102.1">
<input type=hidden name=mrtms002 value="%MRTWEB01.05.103.1">
<input type=hidden name=mrtms003 value="%MRTWEB01.05.104">
<input type=hidden name=MenuType value="%MRTWEB01.05.088">
<input type=hidden name=superlev value="%MRTWEB01.05.136">
</form>

<script type="text/javascript">
function init(){
  if(document.PatientLinks.superlev.value=="1"){
     document.all["deletebutton"].style.display="";
     document.UpdateForm.redirect.value+="&superlev=1";}
}
</script>
 
<span id=ShowHospitalTitle style="display:none">
  Home Hospital
</span>

<span id=ShowHospital style="display:none">
  <select name=mrtms008 id=mrtms008 title="Hospital" class="Mandatory"
   onchange="SetLocation(UpdateForm)">
  %MRTWEB01.05.138
  </select>
</span>
<span id=ShowNoHospital style="display:none">
   <input type=hidden name=mrtms008 id=mrtms008 value="    ">
</span>
