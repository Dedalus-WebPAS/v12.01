<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function ProcessReport() {
  f = document.ReportForm;

  if(!validateMandatory(ReportForm)) {return}

  if (SetDateYYYYMMDD(f.filtstrd.value) > SetDateYYYYMMDD(f.prvyrdat.value)) {
    ans=confirm("Warning: 12 months is the usual minimum for clearing " +
                "alerts.\n Are you sure you wish to continue?") 
    if(ans==false) {return;}
  }

  f.keystr01.value = "2";
  f.keystr02.value = f.filtcatg.value;
  f.keystr03.value = f.filtcode.value;
  f.keystr04.value = SetDateYYYYMMDD(f.filtstrd.value);
  f.keystr06.value = "Y";
  f.keystr07.value = " ";
  f.keystr05.value = SetDateYYYYMMDD(f.schddate.value);
  SubmitReport(ReportForm)
}
function ChangeCategory() {
  f = document.ReportForm;

  if (isWhitespace(f.filtcatg.value)) {
    f.filtcode.options.length=0
    f.filtcode.options[f.filtcodeoptions.length]=new Option("","");
    return;
  }

  SelectOptionsHospCatCode2(f.filtcatg,f.blnkhosp,f.filtcode);
}
function InitStartDate() {
  f = document.ReportForm;
  f.filtstrd.value = f.currdate.value;
  ccyy=f.filtstrd.value.substring(7,11)
  if (isLeapYear(ccyy)) {
    AddSubtractDate(f.filtstrd,"366","S");
  }
  else {
    AddSubtractDate(f.filtstrd,"365","S");
  }
  f.prvyrdat.value = f.filtstrd.value;
}
function isLeapYear(year) {
  if (year % 400 === 0) return true;
  if (year % 100 === 0) return false;
  return year % 4 === 0;
}
</script>
</head>
<body onload="PageLoad(event);ReportLoad();InitStartDate();">
%START.OF.PAGE

<form name=ReportForm method=post action=rshweb02.pbl style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=002>
<input type=hidden name=updttype value="A">
<input type=hidden name=setdfprg value="IBAPMS80">
<input type=hidden name=setdfrep value="02">
<input type=hidden name=schdpgid value="IBAPMS80">    
<input type=hidden name=schddesc value="Auto-End Selected Alert Code">
<input type=hidden name=nextpage value="1">
<input type=hidden name=keystr01 value="">
<input type=hidden name=keystr02 value="">
<input type=hidden name=keystr03 value="">
<input type=hidden name=keystr04 value="">
<input type=hidden name=keystr05 value="">
<input type=hidden name=keystr06 value="">
<input type=hidden name=keystr07 value="">
<input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=1">
<input type=hidden name=blnkhosp value=""> 
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden name=prvyrdat value="">
<input type=hidden name=fischdat value="">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>
  Auto-End Selected Alert Code Report</td></tr>

<tr><td>
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text name=schddate id=schddate size=12 title="Schedule Date"
    value="%STANDARD.01.015"
    onblur="checkDate(this,this.title);">
    <img notab src="../images/DateLookup.gif" class=Icon 
     alt="Show Calendar" date="ReportForm.schddate">
    Time
    <input type=text name=schdtime id=schdtime size=12 title="Schedule Time"
    value="%STANDARD.01.016">
    <img notab src="../images/DateTimeStamp.gif" class=Icon
     alt="Current" date="ReportForm.schddate" time="ReportForm.schdtime">
    <img notab src="../images/TimeLookup.gif" class=Icon
     alt="Time Select" time="ReportForm.schdtime">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><select name=schdprnt id=schdprnt title="Printer" class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBAPMS77.01
        </select>
    </td></tr>
<tr><td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy title='Number of Copies'>
        </select>
    </td></tr>
<tr><td class=DataLabel>Re-schedule Type</td> 
    <td class=DataLabel colspan=3> 
    <select name=schdrdat title="Schedule Type" onchange="SetReportDates()"> 
    <option></option> 
    </select> 
    </td></tr> 
 
<tr><td class=DataLabel>Re-schedule Until Date</td> 
    <td class=DataLabel colspan=3> 
    <input type=text name=schdrend size=12 
     onblur="checkDate(this,'Re-schedule Until Date');"> 
    <img notab src="../images/DateTimeStamp.gif" class=Icon
     alt="Current" date="ReportForm.schdrend">
    <img notab src="../images/DateLookup.gif" class=Icon 
     alt="Show Calendar" date="ReportForm.schdrend">
    </td></tr>
 
<tr><td colspan=2 align=center><hr width=80%></td></tr>

<tr><td class=DataLabel>Alert Category</td>
    <td><select name=filtcatg title="Alert Category" class=Mandatory
         onchange="ChangeCategory()">
         <option value=""></option>
         '<option value="H1">%STANDARD.01.017.H1</option>'
         '<option value="H2">%STANDARD.01.017.H2</option>'
         '<option value="H3">%STANDARD.01.017.H3</option>'
         '<option value="H4">%STANDARD.01.017.H4</option>'
         '<option value="H5">%STANDARD.01.017.H5</option>'
         '<option value="H6">%STANDARD.01.017.H6</option>'
         '<option value="H7">%STANDARD.01.017.H7</option>'
         '<option value="H8">%STANDARD.01.017.H8</option>'
         '<option value="H9">%STANDARD.01.017.H9</option>'
        </select>
    </td></tr>

<tr><td class=DataLabel>Alert Code to Auto-End</td>
    <td><select name=filtcode title="Alert Code to Auto-End" class=Mandatory>
         <option value=""></option>
        </select>
    </td></tr>

<tr><td class=DataLabel>Alert Start Date</td>
    <td class=DataLabel>
      <input type=text size=12 maxlength=12 name=filtstrd    
        title="Alert Start Date" class=Mandatory   
        onblur="checkDate(this,this.title)">	  
      <img src="../images/DateLookup.gif" class=Icon	  
        onclick="DateLookupFrame(ReportForm.filtstrd);">
    </td>
</tr>

</table>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td align=center colspan=2><br>
    <input type=button value=Ok class=button id=btnOk
     onclick="tempDisable(this);ProcessReport();">
    <input type=button value=Cancel class=button 
     onclick='location.href="../lookups/blank.html"'>
    </td></tr>
</table>
</td></tr>

</table>
</form>

