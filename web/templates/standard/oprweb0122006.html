<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb0122006.js"></script>
<script type="text/javascript">
function ApproveTheatre(bookreqnum) {
    var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=40" +
                    "&valdcode=" + bookreqnum.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
//alert(returnValue.status);
  if (returnValue.status==0) {
    DFrameExitRefresh();
  }
}
function AllocateUR (bkrqreqn) {
  SetCookie('TheatreRequestRedirect',parent.location.href);
  SetCookie('TheatreRequestNumber',bkrqreqn);
  linkUrl="patweb90.pbl?reportno=1&template=201&srchsnam="
           +document.UpdateForm.bkreq008.value+"&srchgnam="
           +document.UpdateForm.bkreq009.value;

  ParentDFrameLink(linkUrl,0,50,1100,450)
}
function PostData() {

  if(!validateMandatory(UpdateForm)) return;

    document.UpdateForm.submit();

}
function DeleteData() {
  LinkUrl = "oprweb01.pbl?reportno=22&template=9&urnumber=" + 
             document.UpdateForm.urnumber.value.replace(/ /g,"+") +
             "&admissno=" +
             document.UpdateForm.admissno.value.replace(/ /g,"+") +
             "&requestn=" + 
             document.UpdateForm.requestn.value.replace(/ /g,"+");

  Left=(document.body.clientWidth-300)/2
  DFrameLink(LinkUrl,0,Left,300,300)
}
function valDoctorUnit() {
  ValidateHCP(18,0,UpdateForm.bkreq012,UpdateForm.doctnam1);
  selectOptions("30",UpdateForm.bkreq012,UpdateForm.bkreq013);

  for (var i=0; i < document.UpdateForm.bkreq013.length; i++) {
    if (document.UpdateForm.bkreq013.options[i].value.substr(0,3)==
        document.UpdateForm.d_bkreq013.value){
      document.UpdateForm.bkreq013.selectedIndex=i;
    }
  }

}
function displayApproval() {
  if (document.getElementById("opcnutra").value=="1") {
    if (document.UpdateForm.bkreq005.value=="0") {
      document.getElementById("ApprovedByDIV").style.display="none";
      document.UpdateForm.opr01apr.style.display="";
    }
  }
}
function MandatoryTheatreField() {
  f = document.UpdateForm;
  if (VariableNameExists('OTMandatoryonRequest')) {
    if (OTMandatoryonRequest == true) {
      AddClassName(f.bkreq021,"Mandatory");
    }
    else {
      RemoveClassName(f.bkreq021,"Mandatory");
    }
  }
  else {
    AddClassName(f.bkreq021,"Mandatory");
  }
}

</script>
</head>
%START.OF.PAGE
<body  onLoad="PageLoad(event);valDoctorUnit();ValidateHCP(18,0,
                                          document.UpdateForm.bkreq020,
                                          document.UpdateForm.doctnam2);
               validateCode(4,document.UpdateForm.bkreq023,
                              document.UpdateForm.mbsdesc1);
               validateCode(4,document.UpdateForm.bkreq024,
                              document.UpdateForm.mbsdesc2);
               validateCode(4,document.UpdateForm.bkreq025,
                              document.UpdateForm.mbsdesc3);
               displayApproval();
               MandatoryTheatreField();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
<script type="text/javascript">document.write("Update Theatre Request");
</script>
</span>
<div id=PageBodySection style="overflow: auto;">
<form name=UpdateForm action="oprweb01.pbl" method=post style="margin:0">
<input type=hidden name=reportno value=22>
<input type=hidden name=template value=006>
<input type=hidden name=updttype value="U">
<input type=hidden name=urnumber value="%OPRWEB01.22.101">
<input type=hidden name=admissno value="%OPRWEB01.22.102">
<input type=hidden name=requestn value="%OPRWEB01.22.104">
<input type=hidden name=bkreq001 value="%OPRWEB01.22.101">
<input type=hidden name=bkreq002 value="%OPRWEB01.22.102">
<input type=hidden name=bkreq003 value="%OPRWEB01.22.103">
<input type=hidden name=bkreq004 value="%OPRWEB01.22.104">
<input type=hidden name=bkreq005 value="%OPRWEB01.22.105">
<input type=hidden name=bkreq006 value="%OPRWEB01.22.106">
<input type=hidden name=d_bkreq011 value="%OPRWEB01.22.111">
<input type=hidden name=d_bkreq013 value="%OPRWEB01.22.187.1">
<input type=hidden name=d_bkreq058 value="%OPRWEB01.22.158">
<input type=hidden name=dummy>
<input type=hidden name=bkreq035 value="%OPRWEB01.22.135">
<input type=hidden name=bkreq036 value="%OPRWEB01.22.136">
<input type=hidden name=bkreq037 value="%OPRWEB01.22.137">
<input type=hidden name=bkreq038 value="%OPRWEB01.22.138">
<input type=hidden name=bkreq039 value="%OPRWEB01.22.139">
<input type=hidden name=bkreq040 value="%OPRWEB01.22.140">
<input type=hidden name=bkreq041 value="%OPRWEB01.22.141">
<input type=hidden name=bkreq042 value="%OPRWEB01.22.142">
<input type=hidden name=bkreq043 value="%OPRWEB01.22.143">
<input type=hidden name=bkreq044 value="%OPRWEB01.22.144">
<input type=hidden name=bkreq045 value="%OPRWEB01.22.145">
<input type=hidden name=bkreq046 value="%OPRWEB01.22.146">
<input type=hidden name=bkreq047 value="%OPRWEB01.22.147">
<input type=hidden name=bkreq048 value="%OPRWEB01.22.148">
<input type=hidden name=bkreq049 value="%OPRWEB01.22.149">
<input type=hidden name=bkreq050 value="%OPRWEB01.22.150">
<input type=hidden name=bkreq051 value="%OPRWEB01.22.151">
<input type=hidden name=bkreq052 value="%OPRWEB01.22.152">
<input type=hidden name=bkreq053 value="%OPRWEB01.22.153">
<input type=hidden name=bkreq054 value="%OPRWEB01.22.154">
<input type=hidden name=bkreq055 value="%OPRWEB01.22.155">
<input type=hidden name=bkreq056 value="%OPRWEB01.22.156">
<input type=hidden name=bkreq057 value="%OPRWEB01.22.157">
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden name=opcnutra id=opcnutra  value="%OPRWEB01.22.421">
<table align=center cellspacing=0 cellpadding=0 border=0 width=98%>
<tr>
  <td class=DataLabel colspan=2>
    Request Created %OPRWEB01.22.135 at %OPRWEB01.22.136 by %OPRWEB01.22.185
  </td>
</tr>
<tr>
  <td class=DataLabel colspan=2>
    <div id=ApprovedByDIV>
    %OPRWEB01.22.192
    </div>
  </td>
</tr>
<tr>
  <td></td>
  <td></td>
  <td class=DataLabel>
    Priority
  </td>
  <td class=DataField>
    <select name=bkreq007 title="Priority"  class="Mandatory SelectBig">
    <option></option>
    %OPRWEB01.22.160.2
    </select>
  </td>
</tr>

<tr>
  <td class=DataLabel>
    Surname
  </td>
  <td class=DataField>
    <input type=text name=bkreq008 size=50 maxlength=40
     value="%OPRWEB01.22.108" title="Surname">
  </td>
  <td class=DataLabel>
    Clock Start
  </td>
  <td class=DataField>
    <input type=text name=bkreq014 size=12 maxlength=11
     class="readOnly" readOnly
     onblur="checkDate(this,'Date');"
     title="Clock Start Date" value="%OPRWEB01.22.114">
<!--<img src=../images/DateLookup.gif class="Icon"
     onclick='javascript:DateLookupFrame(UpdateForm.bkreq014)'
     tabindex=-1>-->
    Time
    <input type=text name=bkreq015 size=7 class="readOnly" readOnly
     title="Clock Start Time" value="%OPRWEB01.22.115">
<!--<img src=../images/DateTimeStamp.gif class="Icon"
     onclick='javascript:SetCurrentDateTime(UpdateForm.bkreq014,
              UpdateForm.bkreq015)'
     tabindex=-1>
    <img src=../images/TimeLookup.gif class="Icon"
     onclick='javascript:TimeLookupFrame(UpdateForm.bkreq015)'
     tabindex=-1>-->
  </td>
</tr>

<tr>
    <td class=DataLabel>First Given Name</td>
    <td class=DataLabel>
    <input type=text name=bkreq009 size=50 maxlength=40
     value="%OPRWEB01.22.109" title="First Given Name">
    </td>
    <td class="DataLabel">Requesting Doctor</td>
    <td><input type="text" size="10" maxlength="10"
         name="bkreq012" value="%OPRWEB01.22.112"
         onblur="valDoctorUnit();" />
        <input type="text" size="25" notab readonly name="doctnam1" 
         value="%OPRWEB01.22.186"/>
         <img src="../images/SearchIcon.gif" class="Icon"
         onclick="HCPSearchFrame(UpdateForm.bkreq012,UpdateForm.doctnam1,0);" />
    <td>
</tr>

<tr>
  <td></td>
  <td></td>
  <td class=DataLabel>Unit</td>
    <td class=DataField>
    <select name=bkreq013>
    <option></option>
     %OPRWEB01.22.187.2 
    </select>
    </td>
</tr>

<tr>
   <td class=DataLabel>Sex</td>
   <td><div id=sexDIV>
       <select name="bkreq011" title="Patient's Sex">
          <option></option>
          <option value="R">Intersex</option>
          <option value="U">Unknown</option>
          <option value="I">Indeterminate</option>
          <option value="M">Male</option>
          <option value="F">Female</option>
        </select>
       </div>
   </td>
   <td class=DataLabel>Contact</td>
   <td>
   <input type=text name=bkreq016 size=50 maxlength=100
    title="Contact" value="%OPRWEB01.22.116">
   </td>
</tr>

<tr>
  <td class=DataLabel>Date of Birth</td>
  <td><input type=text size=12 name=bkreq010 title="Date of Birth"
       class="PastDate" value="%OPRWEB01.22.110" 
       onblur="checkDate(this,'Date of Birth');" ></td>
    <td class=DataLabel>Patient Location</td>
    <td class=DataLabel>
    <input type=text name=bkreq017 size=50 maxlength=50
     title="Patient Location" value="%OPRWEB01.22.117">
    </td>
</tr>

<tr><td colspan=4 align=center><hr width=100%></td></tr>

<tr><td class=DataLabel>Admitting Point</td>
    <td class=DataField>
    <select name=bkreq018 title="Admitting Point" class="SelectBig">
    <option></option>
    %OPRWEB01.22.161.2 
    </select></td>
    <td class=DataLabel>Duration</td>
    <td class=DataLabel>
    <input type=text name=bkreq030 size=5 maxlength=3 value="%OPRWEB01.22.130"
     title="Duration"> &nbsp; (minutes)
    </td>
</tr>

<tr>
    <td class=DataLabel>Exp. Post Op Ward</td>
    <td class=DataField>
    <select name=bkreq019 title="Exp. Post Op Ward" class="SelectBig">
    <option></option>
    %OPRWEB01.22.119.2
    </select></td>
    <td class=DataLabel>Infection Status</td>
    <td class=DataField>
    <select name=bkreq031 title="Infection Status" class="SelectBig">
    <option></option>
    %OPRWEB01.22.167.2 
    </select></td>
</tr>

<tr>
    <td class="DataLabel">Surgeon</td>
    <td><input type="text" size="10" maxlength="10"
         name="bkreq020" value="%OPRWEB01.22.120"
         onblur="ValidateHCP(18,0,UpdateForm.bkreq020,UpdateForm.doctnam2);" />
        <input type="text" size="25" notab readonly name="doctnam2" />
         <img src="../images/SearchIcon.gif" class="Icon"
         onclick="HCPSearchFrame(UpdateForm.bkreq020,UpdateForm.doctnam2,0);" />
    </td>
    <td class=DataLabel>Equipment Required 1</td>
    <td class=DataField>
    <select name=bkreq032 title="Equipment Required 1" class="SelectBig">
    <option></option>
    %OPRWEB01.22.164.2 
    </select></td>

</tr>


<tr>
    <td class=DataLabel>Theatre</td>
    <td class=DataField>
    <select name=bkreq021 id=bkreq021 title="Theatre" class="SelectBig">
    <option></option>
    %OPRWEB01.22.162
    </select></td>
    <td class=DataLabel>Equipment Required 2</td>
    <td class=DataField>
    <select name=bkreq033 title="Equipment Required 2" class="SelectBig">
    <option></option>
    %OPRWEB01.22.165.2
    </select></td>

</tr>

<tr>
    <td class="DataLabel">Consent Obtained</td>
    <td>
    <select name="bkreq058" class="SelectBig">
    <option></option>
    <option value="N">No</option>
    <option value="Y">Yes</option>
    </select>
    </td>
    <td class=DataLabel>Equipment Required 3</td>
    <td class=DataField>
    <select name=bkreq034 title="Equipment Required 3" class="SelectBig">
    <option></option>
    %OPRWEB01.22.166.2 
    </select></td>

</tr>

<tr>
    <td class=DataLabel>Consent Date</td>
    <td class=DataLabel>
    <input type=text name=bkreq059 size=12 maxlength=11
     onblur="checkDate(this,'Date');" value="%OPRWEB01.22.159"
     title="Consent Date">
    <img src=../images/DateTimeStamp.gif class="Icon"
     onclick='javascript:SetCurrentDateTimeNoFocus(UpdateForm.bkreq059,
              UpdateForm.dummy);'
     tabindex=-1>
    <img src=../images/DateLookup.gif class="Icon"
     onclick='javascript:DateLookupFrame(UpdateForm.bkreq059);'
     tabindex=-1>
    </td>
</tr>

<tr>
    <td class=DataLabel>Anaesthetic Type</td>
    <td class=DataField>
    <select name=bkreq022 title="Anaesthetic Type" class="SelectBig">
    <option></option>
    %OPRWEB01.22.163.2 
    </select></td>

</tr>

<tr>
<td class=DataLabel>MBS Codes</td>
    <td><input type=text name=bkreq023 size=9
           onblur='validateCode(4,UpdateForm.bkreq023,
                   UpdateForm.mbsdesc1,UpdateForm.currdate);'
           title="Expected MBS Item 1" value="%OPRWEB01.22.123">
        <input type=text readonly name=mbsdesc1 size=30
           title="Expected MBS Item 1 Name" tabindex=-1>
     <img src="../images/SearchIcon.gif" class="Icon"
     onclick="MbsSearchFrame(UpdateForm.bkreq023,
              UpdateForm.mbsdesc1,UpdateForm.currdate);"></td>
</tr>

<tr>
<td class=DataLabel></td>
    <td><input type=text name=bkreq024 size=9
           onblur='validateCode(4,UpdateForm.bkreq024,
                   UpdateForm.mbsdesc2,UpdateForm.currdate);'
           title="Expected MBS Item 2" value="%OPRWEB01.22.124">
        <input type=text readonly name=mbsdesc2 size=30
           title="Expected MBS Item 2 Name" tabindex=-1>
     <img src="../images/SearchIcon.gif" class="Icon"
     onclick="MbsSearchFrame(UpdateForm.bkreq024,
              UpdateForm.mbsdesc2,UpdateForm.currdate);"></td>
</tr>

<tr>
<td class=DataLabel></td>
    <td><input type=text name=bkreq025 size=9
           onblur='validateCode(4,UpdateForm.bkreq025,
                   UpdateForm.mbsdesc3,UpdateForm.currdate);'
           title="Expected MBS Item 3" value="%OPRWEB01.22.125">
        <input type=text readonly name=mbsdesc3 size=30
           title="Expected MBS Item 3 Name" tabindex=-1>
     <img src="../images/SearchIcon.gif" class="Icon"
     onclick="MbsSearchFrame(UpdateForm.bkreq025,
              UpdateForm.mbsdesc3,UpdateForm.currdate);"></td>
</tr>

<tr>
    <td class=DataLabel>Full Description</td>
    <td class=DataLabel>
    <input type=text name=bkreq026 size=80 maxlength=80
     title="MBS Full Description 1" value="%OPRWEB01.22.126">
    </td>
</tr>

<tr>
    <td class=DataLabel></td>
    <td class=DataLabel>
    <input type=text name=bkreq027 size=80 maxlength=80
     title="MBS Full Description 2" value="%OPRWEB01.22.127">
    </td>
</tr>

<tr>
    <td class=DataLabel></td>
    <td class=DataLabel>
    <input type=text name=bkreq028 size=80 maxlength=80
     title="MBS Full Description 3" value="%OPRWEB01.22.128">
    </td>
</tr>

<tr>
    <td class=DataLabel>Prosthesis Required</td>
    <td class=DataLabel>
    <input type=text name=bkreq029 size=80 maxlength=40
     value="%OPRWEB01.22.129" title="Prosthesis Required">
    </td>
</tr>

<tr>
   <td class=DataLabel>Comments</td>
   <td colspan=3>
   <textarea wrap=hard cols=60 rows=3 name=opcom012>
%OPRWEB01.22.188.012
   </textarea>
   </td>
</tr>

</table>

<table align=center cellspacing=0 cellpadding=3 border=0 width=100%>
<tr><td colspan=2 align=center><br>
    <input type=button id="opr01aur" name=formactn value="Allocate UR"
    onclick="tempDisable(this);
             AllocateUR(document.UpdateForm.requestn.value);" class="button">
    <input type=button id="opr01sub" name=formactn value="Update" 
    onclick="tempDisable(this);PostData();" class="button">
    <input type=button id="opr01apr" name=ApproveButton value="Approve"
    onclick="tempDisable(this);
             ApproveTheatre(document.getElementById('requestn').value);"
    class="button" style="display:none">
    <input type=button id="opr01del" name=delbuttn value="Delete"
    onclick="tempDisable(this);DeleteData();" class="button">
    <input type=button Value="Cancel" class="button" onclick="DFrameExit();">
    </td></tr>
</table>
</form>
</div>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=22>
<input type=hidden name=template value=006>
<input type=hidden name=urnumber value="%OPRWEB01.22.003">
<input type=hidden name=admissno value="%OPRWEB01.22.081">
<input type=hidden name=MenuType value="">
<input type=hidden name=requestn value="%OPRWEB01.22.104">
</form>

<script type="text/javascript">

for (var i=0; i < document.UpdateForm.bkreq011.length; i++) {
  if (document.UpdateForm.bkreq011.options[i].value==
      document.UpdateForm.d_bkreq011.value){
    document.UpdateForm.bkreq011.selectedIndex=i;
  }
}

for (var i=0; i < document.UpdateForm.bkreq058.length; i++) {
  if (document.UpdateForm.bkreq058.options[i].value==
      document.UpdateForm.d_bkreq058.value){
    document.UpdateForm.bkreq058.selectedIndex=i;
  }
}

</script>
