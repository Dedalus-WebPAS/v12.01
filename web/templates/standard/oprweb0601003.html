<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb06.js"></script>
<script type="text/javascript">
function validateFF() {
  if (!isWhitespace(document.UpdateForm.opsdt001.value)) {

    document.UpdateForm.updatety.value = "O";
    document.UpdateForm.opsdt004.value = document.UpdateForm.stffname.value;
    document.UpdateForm.opsdt005.value = document.UpdateForm.optsm003.value;
    document.UpdateForm.opsdt006.value = document.UpdateForm.optsm004.value;
    document.UpdateForm.opsdt007.value = document.UpdateForm.optsm005.value;
    document.UpdateForm.opsdt008.value = document.UpdateForm.optsm006.value;

    if (document.UpdateForm.optsm009 != undefined) {
      if (document.UpdateForm.optsm009.checked) {
        document.UpdateForm.opsdt011.value = 1;
      } else {
        document.UpdateForm.opsdt011.value = 0;
      }
    }

  }
}
function validateData() {
  strtDate = UpdateForm.optsm003;
  strtTime = UpdateForm.optsm004;
  endDate  = UpdateForm.optsm005;
  endTime  = UpdateForm.optsm006;
  if(!ChkDateTime(strtDate,null,endDate,null)) {
    alert("Start Date must be before End Date");
    UpdateForm.optsm003.select();
    return;
  }
     bool1=isWhitespace(UpdateForm.optsm005.value);
     bool2=!isWhitespace(UpdateForm.optsm006.value); 
     if(bool1&&bool2){
       alert("End time cannot be entered without End Date");
       UpdateForm.optsm005.select();
       return;
     } 
     if((!bool1) && (!bool2)){
       alert("End time must be entered with End Date");
       UpdateForm.optsm006.select();
       return;
     } 

  validateFF();

  UpdateForm.optsm001.disabled=false
  UpdateForm.submit();    
}
function showLayer(UpdateForm) {
  if ((document.UpdateForm.optsm001.value)==0 ||
      (document.UpdateForm.optsm001.value)==1) {
    Layer1.style.display='';
    Layer2.style.display='none'; 
    Layer3.style.display='none'; 
    move(UpdateForm.combo1);
    UpdateForm.combo1.className="Mandatory";
    UpdateForm.combo2.className="";
    UpdateForm.combo3.className="";
    }
  else {
       if ((document.UpdateForm.optsm001.value)==2) {
            Layer2.style.display='';
            Layer1.style.display='none'; 
            Layer3.style.display='none'; 
            move(UpdateForm.combo2);
            UpdateForm.combo1.className="";
            UpdateForm.combo2.className="Mandatory";
            UpdateForm.combo3.className="";}  
         else {
              if ((document.UpdateForm.optsm001.value)==3) {
                   Layer3.style.display='';
                   Layer1.style.display='none'; 
                   Layer2.style.display='none'; 
                   move(UpdateForm.combo3);
                   UpdateForm.combo1.className="";
                   UpdateForm.combo2.className="";
                   UpdateForm.combo3.className="Mandatory";} } }
}
function move(comb) {
    UpdateForm.optsm008.value=comb.value;
}
function valfirst() {
    if(document.UpdateForm.optsm001.value=="")
       alert(" Select StaffType First");
    else return true;
}
function getCode(flag) {
if(valfirst()) {
 if (((document.UpdateForm.optsm001.value)==0) ||
     ((document.UpdateForm.optsm001.value)==1)){
   if(flag==0)
   DoctorSearchFrame(document.UpdateForm.optsm002,document.UpdateForm.stafdesc);
   if(flag==1){
   validateCode(31,document.UpdateForm.optsm002,document.UpdateForm.stafdesc);
      }
   }
else {
  if((document.UpdateForm.optsm001.value)==2) {
    if(flag==0)
    SearchOTNurse(document.UpdateForm.optsm002,document.UpdateForm.stafdesc);
    if(flag==1) {
    validateNurse(document.UpdateForm.optsm002,document.UpdateForm.stafdesc)
    }
  }
  else {
    if(flag==0)
    HCPSearchFrame(document.UpdateForm.optsm002,document.UpdateForm.stafdesc,4);
    if(flag==1) {
    ValidateHCP(18,13,document.UpdateForm.optsm002,document.UpdateForm.stafdesc)
    }
  }
    }
  }
}
function validateNurse() {
  var hcpnurse = chkHcpOTNurse();
  if (hcpnurse==true){
     validateCode('18',document.UpdateForm.optsm002,
                       document.UpdateForm.stafdesc);
  }
  else {
     validateCode('17',document.UpdateForm.optsm002,
                       document.UpdateForm.stafdesc,
                       document.UpdateForm.gnm,
                       SetNurseName);
  }
}
function SetNurseName() {
UpdateForm.stafdesc.value=UpdateForm.gnm.value.replace(/\s*$/g,"")+
                              " " +
                            UpdateForm.stafdesc.value.replace(/\s*$/g,"")
}
function update(type) {
    if(type=="M") {
       if(validateMandatory(UpdateForm)) {
         UpdateForm.updatety.value=type;
         validateData(); 
       }
    }
    else {
      if (UpdateForm.optsm001.value=="0") {
         alert("Cannot Delete Operating Surgeon");
        }
      else {
           ans=confirm("Are you sure you want to delete");
           if(ans) {
             UpdateForm.updatety.value=type;

             if (!isWhitespace(document.UpdateForm.opsdt001.value)) {
               UpdateForm.updatety.value="T";
             }             

             UpdateForm.optsm001.disabled=false
             UpdateForm.submit();
           }
        }
    }
}
function StaffType() {
  if (UpdateForm.optsm001.value=="2") {
    document.all.StaffOption.innerHTML=document.all.NurseType.innerHTML 
    if (UpdateForm.finalcnt.value=="1") UpdateForm.optsm009.checked=1;
   }
  else{
     document.all.StaffOption.innerHTML="";
  }
}
function StaffLook() {
  document.all.StaffCode.innerHTML=document.all.StaffIcon.innerHTML;
}
function init() {
    showLayer(UpdateForm)
    StaffType();
    StaffLook();
}
function displayFF() {
  if (!isWhitespace(document.UpdateForm.opsdt001.value)) {
    document.UpdateForm.optsm001.disabled = false;

    for (var i =0 ; i < document.UpdateForm.optsm001.length; i++) {
      if (document.UpdateForm.optsm001.options[i].value==
          document.UpdateForm.opsdt003.value.substr(1,1)) {
        document.UpdateForm.optsm001.selectedIndex=i; 
      } 
    }    

    staffcodetitleDIV.innerHTML = staffnametitleSPAN.innerHTML;
    StaffCode.innerHTML = staffnamefieldSPAN.innerHTML;  
    document.UpdateForm.stffname.value = document.UpdateForm.opsdt004.value;  
    document.UpdateForm.optsm003.value = document.UpdateForm.opsdt005.value;   
    document.UpdateForm.optsm004.value = document.UpdateForm.opsdt006.value;
    document.UpdateForm.optsm005.value = document.UpdateForm.opsdt007.value;
    document.UpdateForm.optsm006.value = document.UpdateForm.opsdt008.value;

    showLayer(UpdateForm);

    if (document.UpdateForm.combo1 != undefined) {
      for (var i =0 ; i < document.UpdateForm.combo1.length; i++) {
        if (document.UpdateForm.combo1.options[i].value.substr(0,3)==
            document.UpdateForm.opsdt010.value) {
          document.UpdateForm.combo1.selectedIndex=i;
        }
      }
    }
    if (document.UpdateForm.combo2 != undefined) {
      for (var i =0 ; i < document.UpdateForm.combo2.length; i++) {
        if (document.UpdateForm.combo2.options[i].value.substr(0,3)==
            document.UpdateForm.opsdt010.value) {
          document.UpdateForm.combo2.selectedIndex=i;
        }
      }
    }
    if (document.UpdateForm.combo3 != undefined) {
      for (var i =0 ; i < document.UpdateForm.combo3.length; i++) {
        if (document.UpdateForm.combo3.options[i].value.substr(0,3)==
            document.UpdateForm.opsdt010.value) {
          document.UpdateForm.combo3.selectedIndex=i;
        }
      }
    }
  
    StaffType(); 
    if (document.UpdateForm.optsm009 != undefined) {
      if (document.UpdateForm.opsdt011.value == "1") {
        document.UpdateForm.optsm009.checked = true;
      }
    }

    
    document.UpdateForm.optsm001.disabled = true; 
  }


  if (document.UpdateForm.combo1 != undefined) {
    if (document.UpdateForm.combo1.value.substr(6,1) == "R") {
      document.UpdateForm.combo1.disabled = true;
    }
  }
  if (document.UpdateForm.combo2 != undefined) {
    if (document.UpdateForm.combo2.value.substr(6,1) == "R") {
      document.UpdateForm.combo2.disabled = true;
    }
  }
  if (document.UpdateForm.combo3 != undefined) {
    if (document.UpdateForm.combo3.value.substr(6,1) == "R") {
      document.UpdateForm.combo3.disabled = true;
    }
  }
}
//C-0825792 - Check parameter to use pmshcpaf/oprnuraf for OT Nurse
function chkHcpOTNurse(){
  if (document.getElementById('opcnurse')) {
      if (document.getElementById('opcnurse').value == "1") {
        return true;
      }
      else {
        return false;
      }
  }
  else {
      return false;
  }
}
//C-0825792 - Search Nurse from pmshcpaf/oprnuraf for OT Nurse
function SearchOTNurse(NurseId,ReturnNurseName) {
  var hcpnurse = chkHcpOTNurse();
  if (hcpnurse==true){
     HCPSearchFrame(NurseId,ReturnNurseName,20);
  }
  else {
     NurseSearchFrame(NurseId,ReturnNurseName);
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);showLayer(UpdateForm);displayFF();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Staff Members Maintenance
</span>
<form name=UpdateForm action="oprweb06.pbl" method=post 
onsubmit="return validateMandatory(this)">
<input type=hidden name=reportno value=01>
<input type=hidden name=template value=003>
<input type=hidden name=updatety value="">
<input type=hidden name=casekeys value="%OPRWEB06.01.101">
<input type=hidden name=teamnumb value="%OPRWEB06.01.334">
<input type=hidden name=optsm008 > 
<input type=hidden name=finalcnt value="%OPRWEB06.01.310"> 
<input type=hidden name=savkey01 value="%OPRWEB06.01.312">
<input type=hidden name=savkey76 value="%OPRWEB06.01.699.  5">
<input type=hidden name=gnm>
<input type=hidden name=opsdt001 value="%OPRWEB06.01.701">
<input type=hidden name=opsdt002 value="%OPRWEB06.01.702">
<input type=hidden name=opsdt003 value="%OPRWEB06.01.703">
<input type=hidden name=opsdt004 value="%OPRWEB06.01.704">
<input type=hidden name=opsdt005 value="%OPRWEB06.01.705">
<input type=hidden name=opsdt006 value="%OPRWEB06.01.706">
<input type=hidden name=opsdt007 value="%OPRWEB06.01.707">
<input type=hidden name=opsdt008 value="%OPRWEB06.01.708">
<input type=hidden name=opsdt009 value="%OPRWEB06.01.709">
<input type=hidden name=opsdt010 value="%OPRWEB06.01.710">
<input type=hidden name=opsdt011 value="%OPRWEB06.01.711">
<input type=hidden name=opsdt012 value="%OPRWEB06.01.712">
<input type=hidden name=updopsdt value="%OPRWEB06.01.699.  6">
<input type=hidden name=opcnurse id=opcnurse
       value="%STANDARD.01.025.113.051.0.1">

<table align=center cellspacing=0 cellpadding=3 border=0 width=95%>
<tr><td class=DataLabel>Staff Type</td>
    <td class=DataField>
    <select name=optsm001 class=Mandatory disabled>
     %OPRWEB06.01.318.0
    </select>

    </td></tr>
<tr><td class=DataLabel><div id="staffcodetitleDIV">Staff Code</div></td>
   <td>
    <span id=StaffCode></span>
   </td></tr>
<tr><td class=DataLabel>Start Date</td>
    <td class=DataLabel>
    <input type=text size=12 name=optsm003 id=optsm003
     value="%OPRWEB06.01.320"  title="Start Date" class=Mandatory>
    <img src="../images/DateLookup.gif" class=Icon date=UpdateForm.optsm003>
    Time
    <input type=text size=12 name=optsm004 id=optsm004
     value="%OPRWEB06.01.321" title="Start Time" class=Mandatory>
    <img src="../images/DateTimeStamp.gif" class=Icon 
     date=UpdateForm.optsm003 time=UpdateForm.optsm004> 
    <img src="../images/TimeLookup.gif" class=Icon time=UpdateForm.optsm004>
    </td></tr>
<tr><td class=DataLabel>End Date</td>
    <td class=DataLabel>
    <input type=text size=12 name=optsm005
     value="%OPRWEB06.01.322"  title="End Date" >
    <img src="../images/DateLookup.gif" class=Icon date=UpdateForm.optsm005>
    Time
    <input type=text size=12 name=optsm006
     value="%OPRWEB06.01.323" title="End Time" >
    <img src="../images/DateTimeStamp.gif" class=Icon 
     date=UpdateForm.optsm005 time=UpdateForm.optsm006>
    <img src="../images/TimeLookup.gif" class=Icon time=UpdateForm.optsm006>
    </td></tr>
<tr><td class=DataLabel>Staff Category</td>
    <td class=DataField>
    <div id="Layer1" style="display: none;">
    <select name=combo1 onchange="move(UpdateForm.combo1);" title="Staff Category">
    <option></option>
     %OPRWEB06.01.331.2
    </select>
    </div>
    <div id="Layer2" style="display: none;">
    <select name=combo2 onchange="move(UpdateForm.combo2);" title="Staff Category">
    <option></option>
     %OPRWEB06.01.332.2
    </select>
    </div>
    <div id="Layer3" style="display: none;">
    <select name=combo3 onchange="move(UpdateForm.combo3);" title="Staff Category">
    <option></option>
     %OPRWEB06.01.327.9.1.01.2.R
    </select>
    </div>
    </td></tr>
</table>

<span id=StaffOption></span>

<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td colspan=2 align=center>
<br><input type=button value="Update" class="button" id="opr06sub"
     onclick="tempDisable(this);update('M');">
    <input type=button value="Delete" class="button" onclick="update('R');">
    <input type=button value="Cancel" class="button" 
     onclick="DFrameExitRefresh();">
    </td></tr>
</table>
</form>

<span id=NurseType style="display:none">
<table width=95% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel width=24%>Final Instrument Count</td>
    <td class=DataField><input type=checkbox name=optsm009 id=optsm009
         title="Instrument Count" value="1"></td></tr>
</table>
</span>

<span id=StaffIcon style="display:none">
  <input type=text name=optsm002 id=optsm002 size=6 value="%OPRWEB06.01.319.1"
    title="staffcode" class="Mandatory" onblur="getCode(1)">
  <input type=text name=stafdesc id=stafdesc class=ReadOnly readonly
   value="%OPRWEB06.01.319.0">
  <img src="../images/SearchIcon.gif" class=Icon onclick="getCode(0);">
</span>

<span id=StaffNoIcon style="display:none">
  <input type=text name=optsm002 id=optsm002 size=6 value="%OPRWEB06.01.319.1"
   title="staffcode" class="ReadOnly" readonly >
  <input type=text name=stafdesc id=stafdesc class=ReadOnly readonly
   value="%OPRWEB06.01.319.0">
</span>

<span id="staffnametitleSPAN" style="display:none">Staff Member Name</span>

<span id="staffnamefieldSPAN" style="display:none">
  <input type=text name=stffname id=stffname size=80 title="Staff Member Name"
   maxlength=60 class=Mandatory>
</span>
