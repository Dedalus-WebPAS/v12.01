<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/outweb0202.js"></script>
<script type="text/javascript">
function ViewLink(OptionLink) {

switch (OptionLink) {
  case "0":
  {
   if(Reschedule.redirflg.value=="1") {
     location.href="../cgi-bin/outweb02.pbl?reportno=2&template=011&sesskeys="+
                   Reschedule.sesskeys.value.replace(/ /g,"+");
   } else {
     location.href="../cgi-bin/outweb02.pbl?reportno=2&template=4&sesskeys="+
                   Reschedule.sesskeys.value.replace(/ /g,"+");
   }
   break;
   }
  case "1":
   {
   location.href="../cgi-bin/outweb02.pbl?reportno=2&template=5&sesskeys="+
		    Reschedule.sesskeys.value.replace(/ /g,"+") +
                 "&redirflg=" + Reschedule.redirflg.value.replace(/ /g,"+")
   break;
   }
  case "2":
   {
   location.href="../cgi-bin/outweb02.pbl?reportno=2&template=6&sesskeys="+
		    Reschedule.sesskeys.value.replace(/ /g,"+") +
                 "&redirflg=" + Reschedule.redirflg.value.replace(/ /g,"+")
   break;
   }
  }
}
function OnClick(){
if(validateMandatory(Reschedule)) {
Reschedule.redirect.value="outweb02.pbl?reportno=2&template=6" +
	 "&sesskeys=" + Reschedule.sesskeys.value +
         "&redirflg=" + Reschedule.redirflg.value.replace(/ /g,"+")
Reschedule.submit();
}
}
function OnCancel(){
  if(Reschedule.redirflg.value=="1") {
    location.href="../cgi-bin/outweb02.pbl?reportno=2&template=011&sesskeys="+
                  Reschedule.sesskeys.value;
  } else {
    location.href="../cgi-bin/outweb02.pbl?reportno=2&template=4&sesskeys="+
                  Reschedule.sesskeys.value;
  }

}
function setPrinter(CheckBox,SelectList) {
  if (CheckBox.checked) {
    SelectList.className="SelectBig Mandatory"; }
  else {
    SelectList.className="SelectBig"; }
}
function SendLetterRSH02() {
  theForm=document.Reschedule
  validateCatCode(theForm.cat_CV,theForm.d_outbb047,theForm.d_outbb047_des,theForm.d_outbb047_ind)
  if(theForm.d_outbb047_ind.value.substr(7,1) == "C" ||
    (SetDateYYYYMMDD(theForm.clindate.value.substr(4,11)) <
     SetDateYYYYMMDD(theForm.currdate.value))) {   // Ind 8 - Chart Only or
    theForm.outbb067.selectedIndex=3;              // new booking less than
    theForm.outbb067.className="Readonly";         // today set send letter
    theForm.outbb067.disabled=true;                // N/A
  } else {
    if(theForm.outbb067.disabled==true) {          // Defalut send letter to
       theForm.outbb067.selectedIndex=0;           // Blank when re enabled
    }
    theForm.outbb067.className="";
    theForm.outbb067.disabled=false;
    theForm.outbb067.className="";
  }
  SendLetterDate(theForm);
}
function SendLetterDate(theForm) {
  if(theForm.outbb067.value=="1") {                // Yes Send Letter
    theForm.outbb066.className="Mandatory FutureDate";
    theForm.outbb066.readOnly=false;
    if(isWhitespace(theForm.outbb066.value)) {     // Calculate Letter Date
      CalculateLetterDate(theForm)
    }
  } else {
    theForm.outbb066.className="Readonly Date";
    theForm.outbb066.value="";
    theForm.outbb066.readOnly=true;
  }
}
function CalculateLetterDate(theForm) {
  theForm.outbb066.value=theForm.clindate.value.substr(4,11);
  if(isWhitespace(theForm.clindate.value.substr(4,11))) {
    return;
  }
  AddSubtractDate(theForm.outbb066,theForm.othendps.value,"S");
  if(SetDateYYYYMMDD(theForm.outbb066.value) <=
     SetDateYYYYMMDD(theForm.currdate.value)) {
     theForm.outbb066.value=theForm.currdate.value;
  }
}
function ResetLetter(theForm) {
    theForm.outbb067.selectedIndex=0;
    theForm.outbb066.value="";
    theForm.outbb066.readOnly=false;
    theForm.outbb066.className="Date";
}

</script>
%START.OF.PAGE
<body onload="PageLoad(event);showTodayButton();">
<form name=SelectPeriod action=../cgi-bin/outweb02.pbl method=get
    style="margin:0"
    onSubmit="return validateMandatory(this);">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=6>
<input type=hidden name=redirflg value="%OUTWEB02.02.136">
<input type=hidden name=sesskeyt value="%OUTWEB02.02.071">
<input type=hidden name=loctoday value="%OUTWEB02.02.072">
<input type=hidden name=otcndtdy id=otcndtdy
       value="%STANDARD.01.025.032.148.1.1">

<table cellspacing=0 cellpadding=1 bgcolor=#CCCCCC border=0 width=100%>
<tr><td class=HeadingCell align=center colspan=4>
    Clinic for %OUTWEB02.02.006 </td></tr>

<tr><td width=10% class=DataLabel>Views</td>
    <td width=35% class=DataField>
    <select onchange="ViewLink(this.value);" class=SelectMed>
    <option value=0>Bookings Details</option>
    <option value=1>Update Slots</option>
    <option value=2 selected>Reschedule</option>
    </select>
    </td>
    <td class=DataLabel>Date & Start Time</td>
    <td align=right>
    <span id=TodayButSpan style="display:none">
      <input type=button name=btnToday id=btnToday value="Today" class=button
       title="Switch to today's clinic"
       onclick='setTodayDate();'>
    </span>
    <input type=button value="<<" class=SmallButton
     onclick='location.href="%OUTWEB02.02.002"'>
    <select name=sesskeys onchange='document.SelectPeriod.submit();'>
      %OUTWEB02.02.003
	</select>
     <input type=button value=">>" class=SmallButton
	onclick='location.href="%OUTWEB02.02.001"'>
	</td></tr>

<tr><td width=10% class=DataLabel>Clinic Type</td>
    <td width=35% class=DataField>%OUTWEB02.02.027.0</td>
    <td class=DataLabel>Location</td>
    <td class=DataField>%OUTWEB02.02.029.0</td>
    </tr>

<tr><td class=DataLabel>Session Status</td>
    <td class=DataField>%OUTWEB02.02.020.0</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td></tr>

<tr valign=top>
    <td class=DataLabel>Comments</td>
    <td class=DataField>
    %OUTWEB02.02.026
    <td class=DataLabel>Instructions
    </td> <td>
    <b> %OUTWEB02.02.028</b> <br></td> </tr>

    <tr><td></td><td>
    <b>%OUTWEB02.02.021<br>
    %OUTWEB02.02.022 </b>
    </td></tr>
</table>
</form>

<form name=Reschedule action=outweb02.pbl method=get style="margin:0" >
<input type=hidden name=reportno value=8>
<input type=hidden name=template value="">
<input type=hidden name=updatety value=5>
<input type=hidden name=sesskeys value='%OUTWEB02.02.004'>
<input type=hidden name=redirect value="">
<input type=hidden name=redirflg value="%OUTWEB02.02.136">
<input type=hidden name=othendps value="">
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden name=d_outbb047 value="">
<input type=hidden name=cat_CV value="CV">
<input type=hidden name=d_outbb047_des value="">
<input type=hidden name=d_outbb047_ind value="">
<input type=hidden name=srchclid id=srchclid value="%OUTWEB02.02.064">
<input type=hidden name=srchclty id=srchclty value="%OUTWEB02.02.065">
<input type=hidden name=defvisty id=defvisty value="">
<input type=hidden name=srchrefn id=srchrefn value="~~~~~~~~">
<input type=hidden name=deftovrd id=deftovrd value="">

<table width=100% border=1 cellspacing=0 >
<tr>
    <td class=HeadingCell align=center>Slot</td>
    <td class=HeadingCell align=center>Time</td>
    <td class=HeadingCell width=10%>Visit Type</td>
    <td class=HeadingCell>Patient</td>
    <td class=HeadingCell width=20%>Special Arrangement</td>
    <td class=HeadingCell align=center>Mark</td></tr>
%OUTWEB02.02.023.1
</table>
<table width=100% border=0 cellspacing=0 >
<tr><td colspan=2 class=HeadingCell align=center>
    Reschedule to New Session</td></tr>
</table>
<table width=90% align=center border=0 cellspacing=0 >
<tr><td class=DataLabel>Clinic</td>
    <td><input type=text title=Clinic name=clindesc id=clindesc 
         readonly size=30 class=Mandatory>
    </td></tr>
<tr><td>Session Date & Time</td>
    <td><input type=hidden name=newskeys id=newskeys>
	<input type=text name=clindate id=clindate title="Session date & time" 
         readonly size=30 class=Mandatory>
    <img src="../images/LookupIcon.gif" class=Icon
    onclick="ResetLetter(Reschedule);
             ClinicSearchFrame(Reschedule.newskeys,
                               Reschedule.clindesc,
                               Reschedule.clindate,
                               Reschedule.srchclty,
                               Reschedule.srchclid,
                               Reschedule.defvisty,
                               Reschedule.deftovrd,
                               Reschedule.srchrefn);">
     </td>
<tr><td class=DataLabel>Reason for Reschedule</td>
    <td><select name=outbb014 title="Reason for Reschedule" class=Mandatory>
         <option></option>
          %OUTWEB02.02.024.2
	</select>
    </td></tr>
<tr><td class=DataLabel>Print Reschedule Letter</td>
    <td><input type=checkbox name=letprt06 id=letprt06 value="1" checked 
         onclick="setPrinter(this,Reschedule.letpsl06);">
    <td class=DataLabel>Printer</td>
    <td><select name=letpsl06 id=letpsl06 class="SelectBig Mandatory"
          title="Printer">
        <option></option>
        %STANDARD.01.001.OUTWEB03.02
        </select></td></tr>

<tr><td class=DataLabel>Reset Confirmed Appointment</td>
    <td colspan=3><input type="checkbox" name=resetcap value="1" checked>
    </td></tr>

<tr><td class=DataLabel>Send Letter</td>
    <td><select name=outbb067 title="Send Letter"
         onchange="SendLetterDate(Reschedule);">
        <option></option>
        <option value="0">No</option>
        <option value="1">Yes</option>
        <option value="2">N/A</option>
        </select>
    </td>
    <td class=DataLabel>Generate Letter date</td>
    <td><input type=text name=outbb066 id=outbb066 size=12
         onblur="checkDate(this,'Date')" value=""
         class="Date" title="Generate Letter Date">
        <img src="../images/DateLookup.gif" class=Icon
         onclick="DateLookupFrame(Reschedule.outbb066);">
        <img src="../images/DateTimeStamp.gif" class=Icon
         onclick="SetCurrentDateTime(Reschedule.outbb066,null);">
    </td>
</tr>

<tr><td colspan=2 align=center>
    <input type=button class="button" value=Ok id="okbutton"
     onclick="tempDisable(this);OnClick();">
    <input type=button value=Cancel class="button" onclick='OnCancel()'>
    </td></tr>
</table>
</form>
