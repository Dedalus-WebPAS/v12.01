<meta name="TemplateVersion" content="V12.01.01">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link                   
//  1 - Visit Number
//  2 - Visit Date
//  3 - Discharge Date
//  4 - Visit Desc
//  5 - Ward
//  6 - Doctor
//  7 - Admission Type (CMBS Class)
//  8 - Claim Type
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",23,30);
 t.addColumn("Visit Date","DateTime",2,2,"left","AppointmentIcon.gif","0",155)
 t.addColumn("Discharged","Date",3,3,"center","","",70)
 t.addColumn("Visit Type","String",4,4,"left","","",60)
 t.addColumn("Ward","String",5,5,"left","","",80)
 t.addColumn("Unit","String",10,10,"left","","",70)
 t.addColumn("Doctor","String",6,6,"left","","",110)
 t.addColumn("Insurance Class","String",8,8,"left","","",90)
 AddTableRows()
 TableOutput(0,2);    // Order Column,Asc Dsc
 break; }
case 1: {
 t = new Table(1,0,2,"100%","center",25,40);
 t.addColumn("Visit Date","DateTime",2,2,"left","AppointmentIcon.gif","0",110)
 t.addColumn("Discharged","Date",3,3,"center","","",80)
 t.addColumn("Visit Type","String",4,4,"left","","",120)
 t.addColumn(document.PatientLinks.admtype.value,"String",7,7,"left","","",150)
 t.addColumn(document.PatientLinks.claimcode.value,"String",8,8,"left","","",120)
 AddTableRows()
 TableOutput(0,2);    // Order Column,Asc Dsc
 break; }
 }
}
</script>

<script type="text/javascript">
function linkPatient(Urnumber,VisitNo,Type) {
  if (Type=="1" || Type=="3") {
//A&E, OUT, INP
   document.PatientLinks.action="patweb89.pbl"
   document.PatientLinks.reportno.value="1"
   document.PatientLinks.template.value="011"
   document.PatientLinks.admissno.value=VisitNo
   document.PatientLinks.urnumber.value=Urnumber
   document.PatientLinks.target="content"
   document.PatientLinks.submit()
   self.close()
  } else if (Type=="2" ) {
   document.PatientLinks.action="outweb02.pbl"
   document.PatientLinks.reportno.value="3"
   document.PatientLinks.template.value="008"
   document.PatientLinks.admissno.value=VisitNo
   document.PatientLinks.urnumber.value=Urnumber
   document.PatientLinks.target="content"
   document.PatientLinks.submit()
   self.close()
  } else if (Type=="7" ) {
//Booking
   document.PatientLinks.action="patweb89.pbl"
   document.PatientLinks.reportno.value="1"
   document.PatientLinks.template.value="020"
   document.PatientLinks.admissno.value=VisitNo
   document.PatientLinks.urnumber.value=Urnumber
   document.PatientLinks.target="content"
   document.PatientLinks.submit()
   self.close()
  } else {
    alert("Invalid Visit Type");
  }
}
</script>

</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0)">
<div id=HeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB98.01.003";
PatientVIS="%PATWEB98.01.081";
PatientNAM="%PATWEB98.01.002";
PatientSTA="%PATWEB98.01.086.078";
PatientALT="%PATWEB98.01.084";
PatientSEX="%PATWEB98.01.019";
PatientDOB="%PATWEB98.01.020";
PatientAGE="%PATWEB98.01.021";
PatientLOC="%PATWEB98.01.083";
PatientPRI="%PATWEB98.01.086.066.1";
PatientUNT="%PATWEB98.01.066.0";
DoctorCOD="%PATWEB98.01.082.003";
DoctorNAM="%PATWEB98.01.082.002";
PatientAID="%PATWEB98.01.086.090";
PatientIND="%PATWEB98.01.086.091";
PatientCUR="%PATWEB98.01.086.092";
PatientCLC="%PATWEB98.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB98.01.086.094";
PatientCDM="%PATWEB98.01.086.095";
PatientVDH="%PATWEB98.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
</div>
<div id=TableLocation></div>
<script type="text/javascript">
function AddTableRows() {
%PATWEB98.01.301.patweb98.01.001.3.0.1.0.0.1
}
</script>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB98.01.003">
<input type=hidden name=admissno value="%PATWEB98.01.081">
<input type=hidden name=MenuType value="%PATWEB98.01.088">
<input type=hidden name=admtype value="%STANDARD.01.017.A ">
<input type=hidden name=claimcode value="%STANDARD.01.017.CL">
</form>
