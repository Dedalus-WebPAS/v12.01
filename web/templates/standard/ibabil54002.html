<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">

function checkfile(){
if(document.ReportForm.keystr02.value==""){
extract();
}}

var delflag=false;
function ProcessDelete(){
SubmitPage=true;
delflag=true;
document.ReportForm.Keystr07.className="";
document.ReportForm.Keystr07.value=" ";
document.ReportForm.n_Keystr07.value=" ";
ProcessReport();
}

function ItemSearchStart(ReturnCode,ReturnName) {
  DFrameStart()
  window.ReturnCode=ReturnCode ;
  window.ReturnName=ReturnName ;
  window.ReturnFunction="";
  document.getElementById('PopUpFrame').src="../lookups/ItemNoSearchFrame.html"
  SearchFrameShow()
}

function validateAdmission(){
if (document.ReportForm.Keystr05.value!=""){
var serverURL   = "../cgi-bin/comweb80.pbl?reportno=24" +
    "&valdcode=" + document.ReportForm.Keystr05.value.replace(/ /g,"+");
  var returnValue = RSExecute(serverURL);
    ReturnValue=returnValue.return_value.split("|")
if(ReturnValue!="Admission No"){
document.ReportForm.Keystr05.value=" ";
document.ReportForm.Keystr05.focus();
return;
}
else{
return;}
}}

function validateextractfile(){
  document.ReportForm.keystr01.value="2";
  if (document.ReportForm.keystr02.value!=" "){
    var serverURL   = "../cgi-bin/comweb80.pbl?reportno=22" +
    "&valdcode=" + document.ReportForm.keystr02.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    ReturnValue=returnValue.return_value.split("|")

    if(ReturnValue=="File Does Not Exist") {
      document.ReportForm.keystr03.value="Y";
      document.ReportForm.keystr04.value=document.ReportForm.Keystr05.value;

      if(delflag) {
        if (document.ReportForm.ibcnmhos.value=="1") {
          document.ReportForm.keystr05.value="Y";
          document.ReportForm.keystr06.value=document.ReportForm.hospital.value;
          document.ReportForm.keystr07.value="Y";
          document.ReportForm.keystr08.value=" ";
        } else {
          document.ReportForm.keystr05.value="Y";
          document.ReportForm.keystr06.value="Y";
          document.ReportForm.keystr07.value=" ";
          document.ReportForm.keystr08.value=" ";
        }
      } else {
        if (document.ReportForm.ibcnmhos.value=="1") {
          document.ReportForm.keystr05.value="N";
          document.ReportForm.keystr06.value=document.ReportForm.Keystr07.value;
          document.ReportForm.keystr07.value=document.ReportForm.hospital.value;
          document.ReportForm.keystr08.value=document.ReportForm.Keystr08.value;
        } else {
          document.ReportForm.keystr05.value="N";
          document.ReportForm.keystr06.value=document.ReportForm.Keystr07.value;
          document.ReportForm.keystr07.value=document.ReportForm.Keystr08.value;
          document.ReportForm.keystr08.value=" ";
        }
      }

      return;
    }
// ans=confirm("An extraction file with this name exists.Overwrite it?");
//if(ans){

    document.ReportForm.keystr03.value="Y";
    document.ReportForm.keystr04.value="N";
    if(document.ReportForm.append07.checked==true) {
      document.ReportForm.keystr04.value="Y";
    }

    document.ReportForm.keystr05.value="Y";
    document.ReportForm.keystr06.value=document.ReportForm.Keystr05.value;
    if(delflag) {
      if (document.ReportForm.ibcnmhos.value=="1") {
        document.ReportForm.keystr07.value="Y";
        document.ReportForm.keystr08.value=document.ReportForm.hospital.value;
        document.ReportForm.keystr09.value="Y";
        document.ReportForm.keystr10.value=" ";
        document.ReportForm.keystr11.value=" ";
        document.ReportForm.keystr12.value=" ";

        if(document.ReportForm.complete.value!="C") {
          document.ReportForm.redirect.value="rshweb02.pbl?reportno=1&template=2&reportid=ibabil54";
        }
        if(document.ReportForm.complete.value=="C") {
          document.ReportForm.keystr13.value="Y";
        }
      } else {
        document.ReportForm.keystr07.value="Y";
        document.ReportForm.keystr08.value="Y";
        document.ReportForm.keystr09.value=" ";
        document.ReportForm.keystr10.value=" ";
        document.ReportForm.keystr11.value=" ";

        if(document.ReportForm.complete.value!="C") {
          document.ReportForm.redirect.value="rshweb02.pbl?reportno=1&template=2&reportid=ibabil54";
        }
        if(document.ReportForm.complete.value=="C") {
          document.ReportForm.keystr12.value="Y";
        }
      }
      return;
    } else {
      if (document.ReportForm.ibcnmhos.value=="1") {
        document.ReportForm.keystr07.value="N";
        document.ReportForm.keystr08.value=document.ReportForm.Keystr07.value;
        document.ReportForm.keystr09.value=document.ReportForm.hospital.value;
        document.ReportForm.keystr10.value=document.ReportForm.Keystr08.value;
        if(document.ReportForm.complete.value!="C") {
          document.ReportForm.redirect.value="rshweb02.pbl?reportno=1&template=2&reportid=ibabil54";
        }
        if(document.ReportForm.complete.value=="C"){
          document.ReportForm.keystr11.value="Y";
        }
      } else {
        document.ReportForm.keystr07.value="N";
        document.ReportForm.keystr08.value=document.ReportForm.Keystr07.value;
        document.ReportForm.keystr09.value=document.ReportForm.Keystr08.value;
        if(document.ReportForm.complete.value!="C") {
          document.ReportForm.redirect.value="rshweb02.pbl?reportno=1&template=2&reportid=ibabil54";
        }
        if(document.ReportForm.complete.value=="C"){
          document.ReportForm.keystr10.value="Y";
        }
      }
    }
    return;
  }
}

function extract(){
var date=document.ReportForm.schddate.value;
var mon=date.substring(3,6);
var yy=date.substring(9,12);
if(mon=="Jan")mm="01";
if(mon=="Feb")mm="02";
if(mon=="Mar")mm="03";
if(mon=="Apr")mm="04";
if(mon=="May")mm="05";
if(mon=="Jun")mm="06";
if(mon=="Jul")mm="07";
if(mon=="Aug")mm="08";
if(mon=="Sep")mm="09";
if(mon=="Oct")mm="10";
if(mon=="Nov")mm="11";
if(mon=="Dec")mm="12";
document.ReportForm.keystr02.value="CSA"+mm+yy;
}

function ProcessReport(Complete) {
document.ReportForm.complete.value=Complete
SubmitPage=true;
validateextractfile();
if(SubmitPage){
   SubmitReport(ReportForm) }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ReportLoad();extract();
              document.ReportForm.schddate.focus();">
<form name=ReportForm method=post action=rshweb02.pbl style="margin:0">
  <input type=hidden name=reportno value=4>
  <input type=hidden name=template value=001>
  <input type=hidden name=updttype value="A">
  <input type=hidden name=setdfprg value="IBABIL54">
  <input type=hidden name=setdfrep value="02">
  <input type=hidden name=schdpgid value="IBABIL54">
  <input type=hidden name=keystr01 value="2">
  <input type=hidden name=complete value="">
  <input type=hidden name=schddesc 
   value="SA Health Dept.Transmission Correction">
  <input type=hidden name=nextpage value="1">
  <input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=1">
  <input type=hidden name=ibcnmhos value="%RSHWEB02.01.118.000.043.1.1">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>
SA Health Dept. Transmission Correction<td></tr>
<tr><td>
</table>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>

<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text name=schddate size=12 title="Schedule Date"
    value="%STANDARD.01.015"
    onblur="checkDate(this,'Schedule Date');">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Show Calendar" date="ReportForm.schddate">
    Time
    <input type=text name=schdtime size=12 title="Schedule Time"
    value="%STANDARD.01.016">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schddate" time="ReportForm.schdtime">
    <img notab src="../images/TimeLookup.gif" class="Icon"
     alt="Time Select" time="ReportForm.schdtime">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><select name=schdprnt title="Printer" class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBABIL54.02
        </select>
    </td></tr>

<tr><td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy title='Number of Copies' class=Mandatory>
        </select>
    </td></tr>

<tr><td class=DataLabel>Re-schedule Type</td>
    <td class=DataLabel colspan=3>
    <select name=schdrdat title="Schedule Type" onchange=SetReportDates()>
    <option></option>
    </select>
    </td></tr>

<tr><td class=DataLabel>Re-schedule Until Date</td>
    <td class=DataLabel colspan=3>
    <input type=text name=schdrend size=12
     onblur="checkDate(this,'Re-schedule Until Date');">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schdrend">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Show Calendar" date="ReportForm.schdrend">
    </td></tr>

<tr><td colspan=2 align=center><hr width=80%></td></tr>

<tr><td class=DataLabel width=25%>Extract File</td>
    <td><input type=text name=keystr02 size=10 maxlength=8 
         title="Extract File"></td></tr>
    <input type=hidden name=keystr03>
    <input type=hidden name=keystr04>
</table>

<span id=HospitalID></span>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Admission No</td>
    <td><input type=hidden name=keystr05>
    <input type=text name=Keystr05 size=10 maxlength=8
     title="Admission No" onblur="justifyRight(this);
     validateAdmission();" class=Mandatory></td></tr>

    <input type=hidden name=keystr06>
 
<tr><td class=DataLabel width=25%>Item No</td>
    <td><input type=hidden name=keystr07>
    <input type=text name=Keystr07 id=Keystr07 size=3 maxlength=3
     title="Item No" onblur="justifyRight(this);
     validateCode2(23,Keystr07,n_Keystr07);" class=Mandatory>
    <input type=text readonly name=n_Keystr07 id=n_Keystr07 size=60
     title="Item No Description">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="ItemSearchStart(Keystr07,n_Keystr07);">
    <img src="../images/ClearIcon.gif" class=Icon
     onClick="clrFields(Keystr07,n_Keystr07);">
    </td></tr>

<tr><td class=DataLabel width=25%>Append to existing file</td>
    <td><input type=checkbox name=append07 value=1 checked>

    <input type=hidden name=keystr08>
    <input type=hidden name=Keystr08 value="Y">
    <input type=hidden name=keystr09 value=" ">
    <input type=hidden name=keystr10 value=" ">
    <input type=hidden name=keystr11 value=" ">
    <input type=hidden name=keystr12 value=" ">
    <input type=hidden name=keystr13 value=" ">
    <input type=hidden name=keystr14 value=" ">
</table>

<table width=80% align=center border=0 cellspacing=0>
<tr><td align=center colspan=2><br>
    <input type=button value=Ok class="button" onclick='ProcessReport("O");'>
    <input type=button value=Delete class="button" onclick='ProcessDelete();'>
    <input type=button value=Cancel class="button"
     onclick='location.href="../lookups/blank.html"' >
    <input type=button value=Complete class="button" 
     onclick='ProcessReport("C");'>
    </td></tr>
</table>
</form>

<span id=HospID style="display:none;">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
    <tr><td class=DataLabel width=25%>Hospital ID</td>
    <td><select name=hospital title="Hospital ID ">
    %RSHWEB02.01.122
    </select>
    </td></tr>
</table>
</span>

<script language=javascript>
 if (document.ReportForm.ibcnmhos.value==1) {
     HospitalID.innerHTML = HospID.innerHTML; }
</script>
