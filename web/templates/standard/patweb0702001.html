<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript"> 
function ShowPatient(URNo,AdmNo) {
  var sPad = "        ";    
  // Right justify UR number in the 8 character variable
  var sURNo = URNo.toString();
  var sURNo = sPad.substr(0,(8 - sURNo.length)) + sURNo;
  document.PatientForm.urnumber.value = sURNo;

  // Right justify Admission  Number in the 8 character variable
  var sAdmNo = AdmNo.toString();
  var sAdmNo = sPad.substr(0,(8 - sAdmNo.length)) + sAdmNo;
  document.PatientForm.admissno.value = sAdmNo;

  // Check if cancelled outpatient visit
  var serverURL = "../cgi-bin/comweb81.pbl?reportno=59" +
                  "&valdcode=" + sAdmNo.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status == 0) {
    ReturnValue = returnValue.return_value.split("|")
    if (ReturnValue.length > 1) {
      urno = trim(ReturnValue[7]);
      alert('Cancelled Outpatient Visit for UR ' + urno);
      return;
    }
  }

  CheckSwitchOutpatientReferral(sAdmNo);

  document.PatientForm.submit();
}

function CheckSwitchOutpatientReferral(sAdmNo) {
  p = document.PatientForm;

//outpatient vsist
  var serverURL = "../cgi-bin/comweb81.pbl?reportno=62" +
                  "&valdcode=" + sAdmNo.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status == 0) {
    ReturnValue = returnValue.return_value.split("|")
    if (ReturnValue.length != 1) {
     if (p.ptcnvsro.value == '1') {
        p.action="outweb02.pbl";
        p.reportno.value="03";
        p.template.value="020";
      }
      else {
        if (p.ptcnvsro.value == '2') {
          p.action="outweb02.pbl";
          p.reportno.value="03";
          p.template.value="001";
        }
      }
      return true;
    }
  }

  var serverURL = "../cgi-bin/comweb81.pbl?reportno=53" +
                  "&valdcode=" + sAdmNo.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status == 0) {
    ReturnValue = returnValue.return_value.split("|")
    if (ReturnValue.length == 1) {
      return true;
    }

    var ptvitype = ReturnValue[11];
    // Referral Visit
    if (ptvitype == '10') {
      if (p.ptcnvsrr.value == '1') {
        p.action="allweb02.pbl";
        p.reportno.value="02";
        p.template.value="014";
      }
      else {
        if (p.ptcnvsrr.value == '2') {
          p.action="allweb02.pbl";
          p.reportno.value="02";
          p.template.value="002";
        }
      }
    }
  }
  return true;
}

</script>
<link rel="stylesheet" href="../html/bootstrap.min.css">
<style type="text/css">
.table>tbody>tr>td,.table>tbody>tr>th {
  border-top: none;
  font-size: 8pt;
  padding: 1px;
}
.table-hover tbody tr:hover:not(:first-child) {
  background-color: #e6f2ff;
  cursor: default;
}
.table-hover tbody tr:hover:first-child {
  cursor: default;
}
</style>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ExpireCookiePath('CasePath');">
<span class="DFrameTitleBar">
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
<script type="text/javascript">document.write(self.document.title);</script>
</span>

<table class="table table-hover" border=1 width=100% cellspacing=0 align=center>
<tr><td class=HeadingCell width=15% align=center>U/R Number</td>
    <td class=HeadingCell align=center>Patient Details</td>
    <td class=HeadingCell width=15% align=center>Visit No</td>
<tr>
%PATWEB07.02.001
</table>
<table border=0 width=100% cellspacing=0 align=center>
<tr><td align=center>
      <input type=button class="button" value="Cancel" onclick="DFrameExit();">
    </td>
</tr>
</table>

<form name=PatientForm action="patweb98.pbl" method=get target="content">
  <input type=hidden name=reportno value=1>
  <input type=hidden name=template value=1>
  <input type=hidden name=urnumber value="">
  <input type=hidden name=admissno value="">
  <input type=hidden name=ptcnvsro value="%STANDARD.01.025.124.245.0.1">
  <input type=hidden name=ptcnvsrr value="%STANDARD.01.025.124.246.0.1">
</form>
