<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript">
var ItemNo=100;

function GetFavOnloadCookie() {
  if (GetCookieData("favOnloadCookie") != "unknown") {
    ExpireCookiePath("favOnloadCookie");
    filterItems();
  }
}
function ShowNotSavedAlert() {
  alert('Note: Non Billable Items Will not Saved to the Database' +
        ' as "Used" In Theatre Or Added to the Invoice.');
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);GetItemInfo();">
<span class=DFrameTitleBar>
<img border=0 align=right src=../images/ExitIcon.gif 
     onclick="DFrameExitRefresh();">
<script type="text/javascript">
document.write('Charge Favourites');
</script>
</span>

<div id=PageBodySection style="overflow:auto;">

<form name=AddForm method=post action=patweb75.pbl
    onsubmit='return validateMandatory();' style="margin:0">
   <input type=hidden name=reportno value="1">
   <input type=hidden name=template value="007">
   <input type=hidden name=updatety value="A">
   <input type=hidden name=urnumber value='%OPRWEB06.20.003'>
   <input type=hidden name=admissno value='%OPRWEB06.20.081'>
   <input type=hidden name=casekeys value="%OPRWEB06.20.121">
   <input type=hidden name=uniqueky value="%OPRWEB06.20.122">
   <input type=hidden name=teamnumb value="%OPRWEB06.20.123">
   <input type=hidden name=opcnptmc value="%STANDARD.01.025.113. 66.0.1">
   <input type=hidden name=multhosp value="%STANDARD.01.032">
   <input type=hidden name=mdate000 id=mdate000 value="%OPRWEB06.20.116">
   <input type=hidden name=uniqu000 value="">
   <input type=hidden name=nextpage value="0">
   <input type=hidden name=dummy value="">
   <input type=hidden name=cfeetyp value="%STANDARD.01.025.019.212.0.1">
   <input type=hidden name=postflag value="0">
   <input type=hidden name=keynflag value="0">
   <input type=hidden name=redirect value="">
   <input type=hidden name="ptcnhdps" value="%STANDARD.01.025.080.250.1.1">

<table align=center width=100% border=0>
<tr>
    <td width=10%>
      <div id=inctyTitleDIV>
        Incl type &nbsp;&nbsp;
      </div>
    </td>
    <td width=20%>
      <div id=inctyFieldDIV> 
        <select name=incty000 title='Inclusion Type' class='NoAutoFocus'>
          <option value='0'>Included in Contract</option>
          <option value='1'>Bill to Patient</option>
          <option value='2'>Extra to Contract</option>
        </select>
      </div>
    </td>
    <td width=10%>
      <div id=proceTitleDIV>
      Procedure &nbsp;&nbsp;
      </div>
    </td>
    <td width=20%>
      <div id=proceFieldDIV>
        <img src=../images/SearchIcon.gif class='Icon'
         onclick="LookupProc(AddForm.admissno,
                             AddForm.uniqu000,
                             AddForm.proce000,
                             AddForm.incty000,
                             AddForm.procdesc,
                             ItemNo);">
        <input type=text size=9 name=proce000 value="%OPRWEB06.20.118"
         maxlength=9 title='Procedure' class=readonly
         readonly=true >
      </div>
    </td>
</tr>
</table>

<table align=center width=100% border=0>
<tr>
    <td width=50%>&nbsp;<td>
    <td id=descTitleFieldDIV>Description &nbsp;&nbsp;
       <input type=text size=60 name=procdesc id=procdesc
         class="Readonly" readonly
         value="%OPRWEB06.20.128">
    </td>
</tr>
</table>

<table align=center width=100% border=0>
<tr>
  <td width=12%>
     %STANDARD.01.017.w4
  </td>

  <td width=20%>
     <select title="%STANDARD.01.017.w4" name=selcfavg
      onchange="filterItems();">
       <option></option>
       %OPRWEB06.20.126
     </select>
  </td>
  <td width=20%>
  <td width=20%>
</tr>

</table>

%OPRWEB06.20.124.patweb77.19.002

<table align=center width=100% border=0>
<tr><td colspan=2 align=center><br>
    <input type=button id="opr06su1" value="Add Charges" class="button"
     onclick="tempDisable(this);
              document.AddForm.nextpage.value='9';
              locationHref();
              ChargeUserGroupFavs();">
    <input type=button id="opr06sub" value="Add & Finish" class="button" 
     onclick="tempDisable(this);ChargeUserGroupFavs();">
    <input type=button value="Cancel" class="button" 
     onclick='DFrameCloseRefresh()'>
</td></tr>
</table>

</form>

<script type="text/javascript">

 if (document.AddForm.ptcnhdps.value == "1") {
   FilterInc="%OPRWEB06.20.117";
   for (var i =0 ; i < document.AddForm.incty000.length; i++) {
     if (document.AddForm.incty000.options[i].value==trim(FilterInc)) {
         document.AddForm.incty000.selectedIndex=i;
     }
   }

   if (isWhitespace(document.AddForm.uniqu000.value)){
     unique="%OPRWEB06.20.119";
     document.AddForm.uniqu000.value=unique;
   }
 } else {
   inctyTitleDIV.innerHTML = "";
   inctyFieldDIV.innerHTML = "";
   proceTitleDIV.innerHTML = "";
   proceFieldDIV.innerHTML = "";
   descTitleFieldDIV.innerHTML = "";
 }

function LookupProc(admissno,RETuniq,RETproc,IncTy,RETprocd,RETitem){
  var PopUpFrameDoc = DFrameStart();
  window.admissno=admissno;
  window.RETproc=RETproc;
  window.RETuniq=RETuniq;
  window.RETitem=RETitem;
  window.RETprocd=RETprocd;
  PopUpFrameDoc.location.href = "../lookups/NZProcedureSearchFrame.html";
  SearchFrameShow();
}
function UpdateFavGroupLink(linkurl) {
  Left=(document.body.clientWidth-800)/2
  DFrameLink(linkurl,0,Left,800,400)
}
function zeroFill( number, width )
{
  width -= number.toString().length;
  if ( width > 0 )
  {
    return new Array( width + (/\./.test( number ) ? 2 : 1) ).join( '0' ) + number;
  }
  return number + ""; // always return a string
}
function ChargeUserGroupFavs() {

  AssignUniquIncty();
  document.AddForm.submit();
}
function GetItemInfo() {

  for (x=101;x<900;x++) {
     y = zeroFill(x-100,3)
     if (document.getElementById('crchr'+x) == null){break;}

       document.getElementById('mdate'+x).value=
       document.getElementById('mdate000').value;

       document.getElementById('qunty'+x).value=
       trim(document.getElementById('qunty'+x).value);

  }
//alert('crkey'+x);
}

function AssignUniquIncty() {

  if (document.AddForm.ptcnhdps.value != "1") {return;}

  for (x=101;x<900;x++) {
    y = zeroFill(x-100,3)

    if (document.getElementById('crchr'+x) == null){break;}

    document.getElementById('uniqu'+x).value = document.AddForm.uniqu000.value;
    document.getElementById('incty'+x).value = document.AddForm.incty000.value;
  }
}
function filterItems() {

//  if (location.href.indexOf("&selcoccg=") != -1) {
//    locationVar = location.href.substr(0,location.href.indexOf("&selcoccg="));
// } else {
//    locationVar = location.href;
//  }

//  locationVar = locationVar + "&selcoccg=" + 
//               document.AddForm.selcoccg.value.substr(0,3).replace(/ /g,'+') +
//               "&selcfavg=" +
//               document.AddForm.selcfavg.value.substr(0,3).replace(/ /g,'+');


  if (location.href.indexOf("&selcfavg=") != -1) {
    locationVar = location.href.substr(0,location.href.indexOf("&selcfavg="));
  } else {
    locationVar = location.href;
  }

  locationVar = locationVar + "&selcfavg=" +
                document.AddForm.selcfavg.value.substr(0,3).replace(/ /g,'+') +
                "&defaindc=1";

  location.href = locationVar;
}
function locationHref() {

  if (location.href.indexOf("oprweb06.pbl") != -1) {
    locationVar = location.href.substr(location.href.indexOf("oprweb06.pbl"),
                                       location.href.length);
  } else {
    locationVar = location.href;
  }

//  if (locationVar.indexOf("&selcoccg=") != -1) {
//    locationVar = locationVar.substr(0,locationVar.indexOf("&selcoccg="));
//  }

//  locationVar = locationVar + "&selcoccg=" +
//               document.AddForm.selcoccg.value.substr(0,3).replace(/ /g,'+') +
//               "&selcfavg=" +
//               document.AddForm.selcfavg.value.substr(0,3).replace(/ /g,'+');

  if (locationVar.indexOf("&selcfavg=") != -1) {
    locationVar = locationVar.substr(0,locationVar.indexOf("&selcfavg="));
  }

  locationVar = locationVar + "&selcfavg=" +
                document.AddForm.selcfavg.value.substr(0,3).replace(/ /g,'+')  +
                "&defaindc=1";

  document.AddForm.redirect.value = locationVar;
//alert(document.AddForm.redirect.value);
}
</script>
