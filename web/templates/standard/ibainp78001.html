<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function displayOptionTypeSpan() {
  if (ReportForm.optntype.value==1) {
    document.getElementById('StartOptionTypeHeading').innerHTML=
      document.getElementById('StartOperationOptionHeading').innerHTML;
    document.getElementById('StartOptionType').innerHTML=
      document.getElementById('StartOperationOption').innerHTML
    document.getElementById('EndOptionTypeHeading').innerHTML=
      document.getElementById('EndOperationOptionHeading').innerHTML;
    document.getElementById('EndOptionType').innerHTML=
      document.getElementById('EndOperationOption').innerHTML
  }
  else {
    if (ReportForm.optntype.value==3) {
      document.getElementById('StartOptionTypeHeading').innerHTML=
        document.getElementById('StartDoctorOptionHeading').innerHTML;
      document.getElementById('StartOptionType').innerHTML=
        document.getElementById('StartDoctorOption').innerHTML
      document.getElementById('EndOptionTypeHeading').innerHTML=
        document.getElementById('EndDoctorOptionHeading').innerHTML;
      document.getElementById('EndOptionType').innerHTML=
        document.getElementById('EndDoctorOption').innerHTML
    }
    else {
      document.getElementById('StartOptionTypeHeading').innerHTML=
        document.getElementById('nothingdiv').innerHTML;
      document.getElementById('StartOptionType').innerHTML=
        document.getElementById('nothingdiv').innerHTML;
      document.getElementById('EndOptionTypeHeading').innerHTML=
        document.getElementById('nothingdiv').innerHTML;
      document.getElementById('EndOptionType').innerHTML=
        document.getElementById('nothingdiv').innerHTML;
    }
  }
}
function ProcessReport() {
  if (!validateReportForm()) {
    return;
  }
//alert("submit");
 SubmitPage=true
 ReportForm.keystr01.value=ReportForm.repttype.value;
 if (ReportForm.schdrdat.value=="") {
     ReportForm.keystr02.title="From Date"
     ReportForm.keystr03.title="To Date"
     ReportForm.keystr02.value=ReportForm.datran01.value
     ReportForm.keystr03.value=ReportForm.datran02.value
     SubmitPage=CheckDateRange(ReportForm.datran01,ReportForm.datran02)
     if (!SubmitPage) {return;}
 }
 else {
     ReportForm.keystr02.title="From Schedule"
     ReportForm.keystr03.title="To Schedule"
 }

  ReportForm.keystr04.value=ReportForm.optntype.value;    

  if (ReportForm.keystr04.value==1) {
    ReportForm.keystr05.value=document.ReportForm.operstrt.value;
    ReportForm.keystr06.value=document.ReportForm.opernend.value;
    ReportForm.keystr07.value="Y";
    ReportForm.keystr08.value="Y";
  }

  if (ReportForm.keystr04.value==2) {
    ReportForm.keystr05.value="Y";
    ReportForm.keystr06.value="Y";
  }

  if (ReportForm.keystr04.value==3) {
    ReportForm.keystr05.value=document.ReportForm.doctstrt.value;
    ReportForm.keystr06.value=document.ReportForm.doctnend.value;
    ReportForm.keystr07.value="Y";
    ReportForm.keystr08.value="Y";
  }

  if (ReportForm.keystr04.value==1 | ReportForm.keystr04.value==3) {
  SubmitPage=CheckRange(ReportForm.keystr05,ReportForm.keystr06)}

if (SubmitPage) {
  SubmitReport(ReportForm) }
}
function validateReportForm() {
  if (document.ReportForm.optntype.value==1) {
    if (!isWhitespace(document.ReportForm.operstrt.value)&&
        !isWhitespace(document.ReportForm.opernend.value)) {
      if (document.ReportForm.operstrt.value >
          document.ReportForm.opernend.value) {
        alert("From Operation is Greater Than To Operation.");
        return false;
      }
    }
  }

  if (document.ReportForm.optntype.value==3) {
    if (!isWhitespace(document.ReportForm.doctstrt.value)&&
        !isWhitespace(document.ReportForm.doctnend.value)) {
      if (document.ReportForm.doctstrt.value >
          document.ReportForm.doctnend.value) {
        alert("From Doctor is Greater Than To Doctor.");
        return false;
      }
    }
  }

  return true;
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ReportLoad();">
<form name=ReportForm method=post action=rshweb02.pbl style="margin:0">
  <input type=hidden name=reportno value=4>
  <input type=hidden name=template value=001>
  <input type=hidden name=updttype value="A">
  <input type=hidden name=setdfprg value="IBAINP78">
  <input type=hidden name=setdfrep value="01">
  <input type=hidden name=schdpgid value="IBAINP78">    
  <input type=hidden name=schddesc value="Patient Theatre Times Report">    
  <input type=hidden name=nextpage value="1">
  <input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=1">
  <input type=hidden name=keystr01 value="">
  <input type=hidden name=keystr02 value="">
  <input type=hidden name=keystr03 value="">
  <input type=hidden name=keystr04 value="">
  <input type=hidden name=keystr05 value="">
  <input type=hidden name=keystr06 value="">
  <input type=hidden name=keystr07 value="">
  <input type=hidden name=keystr08 value="">
  <input type=hidden name=keystr09 value="">
  <input type=hidden name=keystr10 value="">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>Patient Theatre Times Report</td></tr>
<tr><td>
</table>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text name=schddate size=12 title="Schedule Date"
    value="%STANDARD.01.015"
    onblur="checkDate(this,'Schedule Date');">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schddate">
    Time
    <input type=text name=schdtime size=12 title="Schedule Time"
    value="%STANDARD.01.016">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schddate" time="ReportForm.schdtime">
    <img notab src="../images/TimeLookup.gif" class="Icon" 
     alt="Time Select" time="ReportForm.schdtime">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><select name=schdprnt title="Printer" class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBAMRT39.01
        </select>
    </td></tr>
 
<tr><td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy title='Number of Copies' class=Mandatory>
        </select>
    </td></tr>
 
<tr><td class=DataLabel>Re-schedule Type</td> 
    <td class=DataLabel colspan=3> 
    <select name=schdrdat title="Schedule Type" onchange="SetReportDates()"> 
    <option></option> 
    </select> 
    </td></tr> 
 
<tr><td class=DataLabel>Re-schedule Until Date</td> 
    <td class=DataLabel colspan=3> 
    <input type=text name=schdrend size=12 
     onblur="checkDate(this,'Re-schedule Until Date');"> 
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schdrend">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schdrend">
    </td></tr>
 
<tr><td colspan=2 align=center><hr width=80%></td></tr>

<tr><td class=DataLabel>Report Type</td>
    <td><select name=repttype Title="Report Type" class=Mandatory
    >
    <option></option>
    <option value=1>By Discharge Date</option>
    <option value=2>By Operation Date</option>
    </select>
    </td></tr>

<tr><td class=DataLabel width=25%>Report Date</td>
    <td><span id=DateRange></span>
    </td></tr>

<tr><td class=DataLabel>Option Type</td>
    <td><select name=optntype Title="Option Type" class=Mandatory
     onchange="displayOptionTypeSpan();">
    <option></option>
    <option value=1>By Type of Operation</option>
    <option value=2>By Date Sequence</option>
    <option value=3>By Attending Doctor</option>
    </select>
    </td></tr>

<tr><td class="DataLabel"><div id="StartOptionTypeHeading"></div></td>
    <td><div id="StartOptionType"></div></td></tr>

<tr><td class="DataLabel"><div id="EndOptionTypeHeading"></div></td>
    <td><div id="EndOptionType"></div></td></tr>

</table>

<table width=80%>
<tr><td align=center colspan=3><br>
    <input type=button value=Ok class="button" onclick='ProcessReport();'>
    <input type=button value=Cancel class="button" 
     onclick='location.href="../lookups/blank.html"' >
    </td></tr>
</table>

</form>

<div id=SetDateRange style="display:none;">
    <input type=text size=15 maxlength=12 name=datran01
    onblur="checkDate(this,'Date')" 
    class="Mandatory PastDate" title="From Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.datran01">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.datran01">
    To
    <input type=text size=15 maxlength=12 name=datran02
    onblur="checkDate(this,'Date')" class="Mandatory PastDate" title="To Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.datran02">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.datran02">
</div>

<div id=SetScheduleRange style="display:none;">
    <select name=datsch01 title="Schedule Range" class=Mandatory
    onblur="UpReportSchedule(this,ReportForm.keystr02,ReportForm.keystr03)">
    <option></option></select>
    Sample Range
    <input type=text name=SampleFrom size=12> To
    <input type=text name=SampleTo size=12>
</div>

<div id=StartOperationOptionHeading style="display:none;">
Starting Operation Type
</div>

<div id=EndOperationOptionHeading style="display:none;">
End Operation Type
</div>

<div id=StartDoctorOptionHeading style="display:none;">
Starting Doctor Code
</div>

<div id=EndDoctorOptionHeading style="display:none;">
End Doctor Code
</div>

<div id=StartOperationOption style="display:none;">
<input type=text size=10 name=operstrt
     title="Starting Operation Type" maxlength=9
     onblur="validateCode(4,
                          ReportForm.operstrt,
                          ReportForm.descstrt,
                          ReportForm.datran01);">
    <input type=text size=55 class=ReadOnly Readonly tabindex=-1
     width=30%  name=descstrt title="Starting Operation Type Description">
    <img src="../images/SearchIcon.gif" class=Icon
      onclick="MbsSearchFrame(ReportForm.operstrt,
                              ReportForm.descstrt,
                              ReportForm.datran01);">
</div>

<div id=EndOperationOption style="display:none;">
<input type=text size=10 name=opernend
     title="End Operation Type" maxlength=9
     onblur="validateCode(4,
                          ReportForm.opernend,
                          ReportForm.descnend,
                          ReportForm.datran01);">
    <input type=text size=55 class=ReadOnly Readonly tabindex=-1
     width=30%  name=descnend title="End Operation Type Description">
    <img src="../images/SearchIcon.gif" class=Icon
      onclick="MbsSearchFrame(ReportForm.opernend,
                              ReportForm.descnend,
                              ReportForm.datran01);">
</div>

<div id=StartDoctorOption style="display:none;">
<input type=text name=doctstrt size=6 title='From Doctor Code'
        onblur="validateCode(3,ReportForm.doctstrt,ReportForm.docdscst)">
        <input type=text name=docdscst size=30 class=Readonly readonly
         title='From Doctor Name' tabindex=-1>
        <img src="../images/SearchIcon.gif" class="Icon" alt="Search"
         onclick='DoctorSearchFrame(ReportForm.doctstrt,ReportForm.docdscst)'>
       <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick="clrDoc(ReportForm.doctstrt,ReportForm.docdscst);">
</div>

<div id=EndDoctorOption style="display:none;">
<input type=text name=doctnend size=6 title='To Doctor Code'
        onblur="validateCode(3,ReportForm.doctnend,ReportForm.docdsced)">
        <input type=text name=docdsced size=30 class=Readonly readonly
         title='To Doctor Name' tabindex=-1>
        <img src=../images/SearchIcon.gif class="Icon" alt="Search"
         onclick='DoctorSearchFrame(ReportForm.doctnend,ReportForm.docdsced)'>
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick="clrDoc(ReportForm.doctnend,ReportForm.docdsced);">
</div>

<div id=nothingdiv style="display:none;"></div>
