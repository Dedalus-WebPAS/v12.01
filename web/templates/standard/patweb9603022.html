<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function defaultExp() {
   p=document.pat96olv
   p.no_minutes.value=p.trnlvtyp.value.substr(23,6);
   if((p.trnlvtyp.value.substr(3,1)=='A')||
     (p.trnlvtyp.value.substr(14,1)=='W')){
     document.pat96olv.d_pmlrd006.checked=true
     AbsDiv();
   }
   if(!isWhitespace(p.no_minutes.value)){
       AddSubtractMinute(document.pat96olv.trandate1,
       document.pat96olv.trantime,document.pat96olv.no_minutes,
       'A',document.pat96olv.trnsretn,document.pat96olv.trnsrett)
  }
}
function carerMandatory() {
 if(document.pat96olv.d_pmlrd034.checked == true) {
     document.pat96olv.d_pmlrd034.value="1";
     pat96olv.pmlrd030.className="Mandatory";  //Carer name
     pat96olv.pmlrd031.className="Mandatory MobilePhone";  //Carer Contact number
 } else {
   if(document.pat96olv.pmlrd014.value.substr(3,1)!="C"){
     pat96olv.pmlrd030.className="";  //Carer name
     pat96olv.pmlrd031.className="MobilePhone";  //Carer Contact number
  }
 }
}
function getMnHlReturnTime() {
  if (document.pat96olv.mnhllvin.value=="1") {
    var MnhlReturnDate = new Date();   
    var getMinutesVAR = 0;
    var newMinutesVAR = 0;
    var yearVAR = "    ";
    var monthVAR = "   ";
    var dayVAR = "  ";
    var hourVAR = "  ";
    var minuteVAR = "  ";
    var secondVAR = "  ";
    MnhlReturnDate.setFullYear(document.pat96olv.trandate.value.substr(0,4));
    MnhlReturnDate.setMonth(document.pat96olv.trandate.value.substr(4,2)-1);
    MnhlReturnDate.setDate(document.pat96olv.trandate.value.substr(6,2));
    MnhlReturnDate.setHours(document.pat96olv.trantime.value.substr(0,2));
    MnhlReturnDate.setMinutes(document.pat96olv.trantime.value.substr(3,2));
    MnhlReturnDate.setSeconds(document.pat96olv.trantime.value.substr(6,2));
    getMinutesVAR = MnhlReturnDate.getMinutes();
    newMinutesVAR = getMinutesVAR - 1;
    MnhlReturnDate.setMinutes(newMinutesVAR);

    yearVAR = MnhlReturnDate.getFullYear(); 

    if (MnhlReturnDate.getMonth()==0) {monthVAR="Jan";}
    if (MnhlReturnDate.getMonth()==1) {monthVAR="Feb";}
    if (MnhlReturnDate.getMonth()==2) {monthVAR="Mar";}
    if (MnhlReturnDate.getMonth()==3) {monthVAR="Apr";}
    if (MnhlReturnDate.getMonth()==4) {monthVAR="May";}
    if (MnhlReturnDate.getMonth()==5) {monthVAR="Jun";}
    if (MnhlReturnDate.getMonth()==6) {monthVAR="Jul";}
    if (MnhlReturnDate.getMonth()==7) {monthVAR="Aug";}
    if (MnhlReturnDate.getMonth()==8) {monthVAR="Sep";}
    if (MnhlReturnDate.getMonth()==9) {monthVAR="Oct";}
    if (MnhlReturnDate.getMonth()==10) {monthVAR="Nov";}
    if (MnhlReturnDate.getMonth()==11) {monthVAR="Dec";}

    dayVAR = MnhlReturnDate.getDate();
    dayVAR = dayVAR+"";
    if (dayVAR.length==1) {dayVAR="0"+dayVAR;}

    hourVAR = MnhlReturnDate.getHours();
    hourVAR = hourVAR+"";
    if (hourVAR.length==1) {hourVAR="0"+hourVAR;}

    minuteVAR = MnhlReturnDate.getMinutes();
    minuteVAR = minuteVAR+"";
    if (minuteVAR.length==1) {minuteVAR="0"+minuteVAR;}

    secondVAR = MnhlReturnDate.getSeconds();
    secondVAR = secondVAR+"";
    if (secondVAR.length==1) {secondVAR="0"+secondVAR;}

    document.pat96olv.mnhlredt.value = dayVAR + " " + monthVAR + " " + yearVAR;
    document.pat96olv.mnhlretm.value = hourVAR + ":" + minuteVAR + ":" + 
                                       secondVAR;

//    alert(document.pat96olv.mnhlredt.value + " " + document.pat96olv.mnhlretm.value);

  }
}
function valMnHl() {
  if (document.pat96olv.mnhllvin.value=="1") {
    if (isWhitespace(document.pat96olv.trnlvtyp.value.substr(0,3))&&
        isWhitespace(document.pat96olv.mnhltylv.value)) {
      alert("New Type of Leave must be different to Current Type of Leave.");
      return 0;
    }
    if (document.pat96olv.trnlvtyp.value.substr(0,3)==
        document.pat96olv.mnhltylv.value) {
      alert("New Type of Leave must be different to Current Type of Leave.");
      return 0;
    }
    return 1;
  }
  return 1;
}
function ShowMnHl() {
  if (document.pat96olv.mnhllvin.value=="1") {
    for (var i=0; i < document.pat96olv.trnlvtyp.length; i++) {
      if (document.pat96olv.trnlvtyp.options[i].value.substr(0,3)==
          document.pat96olv.mnhltylv.value){
          document.pat96olv.trnlvtyp.selectedIndex=i;
      }
    }
    document.pat96olv.trnsretn.value=document.pat96olv.mnhlexrd.value;
    document.pat96olv.trnsrett.value=document.pat96olv.mnhlexrt.value;
  }
}
function ContType(type) {
  var ValidCodes = "12345 "
  if (ValidCodes.indexOf(type.value)==-1) {
  alert ("Invalid Contract Type");
  type.value="";
  type.focus();
  }
}

function ContRole(role) {
  var ValidCodes = "AB "
  if (ValidCodes.indexOf(role.value)==-1) {
  alert ("Invalid Contract Role");
  role.value="";
  role.focus();
  }
}
//------------------------------------------------------------
// Contract Type Alert
//------------------------------------------------------------
function ContTypeAlert() {
  alert("Valid Contract Type Number\n\n" +
"1 - B    A (health authority/other external purchaser) contracts B (hospital) for admitted service\n" +
"\n" +
"2 - ABA  Patient admitted by Hospital A. Hospital A contracts Hospital B for admitted or non-admitted patient service.\n" +
"Patient Returns to Hospital A on completion of service by Hospital B.\n" +
"\n" +
"3 - AB   Patient admitted by Hospital A. Hospital A contracts Hospital B for admitted or non-admitted patient service\n" +
"Patient Does not return to Hospital A on conmpletion of service by Hospital B.\n" +
"\n" +
"4 - (A)B Patient not admitted by Hospital A. Hospital A contracts Hospital B for the whole admitted patient service\n" +
"\n" +
"5 - BA   Hospital A, which does not initially admit the patient, contracts Hospital B for an admitted patient service\n" +
"following which the patient is transferred to and admitted by Hospital A." )
}
//
//------------------------------------------------------------
// Contract Role Alert
//------------------------------------------------------------
function ContRoleAlert() {
  alert("Valid Contract Role Character\n\n" +
"A - The Contracting (purchasing) hospital is termed Hospital A.\n" +
"\n" +
"B - The contracted (service provider) hospital is termed Hospital B." )
}
</script>
<style type=text/css> 
.TransferOption {
position: relative; 
}
</style>
<script type="text/javascript">
function DisplayContract() {
  i=document.pat96olv.trnlvtyp.selectedIndex;
  ind=document.pat96olv.trnlvtyp.options[i].value.substring(14,15)
  if (ind=="C" || ind=="S" || ind=="H") {
    ContractHeading.innerHTML=contracthd.innerHTML;
    ContractType.innerHTML=contracttype.innerHTML;
    Contrac1Heading.innerHTML=contracrhd.innerHTML;
    ContractRole.innerHTML=contractrole.innerHTML;
    Contrac2Heading.innerHTML=contracihd.innerHTML;
    ContractId.innerHTML=contractid.innerHTML;
  } else {
    ContractHeading.innerHTML=blanklabel.innerHTML;
    ContractType.innerHTML="";
    Contrac1Heading.innerHTML=blanklabel.innerHTML;
    ContractRole.innerHTML="";
    Contrac2Heading.innerHTML=blanklabel.innerHTML;
    ContractId.innerHTML="";
  }
  if (ind=="S"||ind=="H") {
     document.pat96olv.ptasf001.className="Readonly";
     document.pat96olv.ptasf002.className="Readonly";
     document.pat96olv.ptasf001.value="";
     document.pat96olv.ptasf002.value="";
   } else if (ind=="C"){
     document.pat96olv.ptasf001.className="Mandatory";
     document.pat96olv.ptasf002.className="Mandatory";
  }
}
function init(){
 if(trim(PatientLinks.curstate.value)=="On-Leave"){
     location.href="patweb96.pbl?reportno=03&template=024"
           + "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
           + "&admissno=" + PatientLinks.admissno.value.replace(/ /g,"+")
   return;
 }
   convertDate(document.pat96olv.trandate.value);
   p=document.pat96olv
   care_ind24=p.caretype.value.substr(71,1);
   filterCatCodeList(p.trnlvtyp,"24",care_ind24,"3");

if (document.pat96olv.mehvisfl.value == "1"){
    document.pat96olv.trnsretn.className="Mandatory";  //exp return
    document.pat96olv.trnlvtyp.selectedIndex="0";
  }
 AbscondedDIV.innerHTML=AbscondedQ.innerHTML;
 AbscondedCheckboxDIV.innerHTML=AbscondedCheckbox.innerHTML;
 if(document.pat96olv.genericu.value=="1"){
    document.pat96olv.secureid.value=" "
 }
}
function selectCatCodInd(ReturnCode,ReturnSelect,ReturnDeft,FiltCode,FiltInd,FiltTest){
  if (isWhitespace(ReturnCode.value)) return;;
  if (isWhitespace(FiltInd)) return;;
  if (isWhitespace(FiltTest)) return;;

  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=15" +
                    "&returnfm=1" +
                    "&valdcode=" + ReturnCode.value.replace(/ /g,"+")
  var Pos = (FiltInd - 0)
  Pos= Pos + 2
  FiltVal = FiltCode.value.substr(Pos,1);
  alert(FiltVal);
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnSelect.options.length=0
    ReturnSelect.options[ReturnSelect.options.length]=new Option("","");
    ReturnValue=returnValue.return_value.split("|");
    for (var j=0; j < ReturnValue.length; j++) {
      if (!isWhitespace(ReturnValue[j])) {
          SelectValue=ReturnValue[j].split(",");
          ReturnInd = SelectValue[0].substr(Pos,1);
          if(FiltVal == ReturnInd && FiltTest == 1) {
            if(ReturnDeft.value.substr(0,3) ==  SelectValue[0].substr(0,3)) {
              ReturnSelect.options[ReturnSelect.options.length]=
              new Option(SelectValue[1],SelectValue[0],0,1);
            } else {
              ReturnSelect.options[ReturnSelect.options.length]=
              new Option(SelectValue[1],SelectValue[0]);
            }
          }
      }
    }
  } else {
    ReturnCode.select();
  }
}

function convertDate(datevalue) {
  cent = datevalue.substring(0,2)
  year = datevalue.substring(2,4)
  mon  = datevalue.substring(4,6)
  day  = datevalue.substring(6,8)

  monthName = GetMonthName(mon);

  document.pat96olv.trandate1.value = day + " " + monthName + " " + cent + year;
  defaultExp();
}
function DisplayTrnSrc() {
  var i=document.pat96olv.trnlvtyp.selectedIndex;
  var ind = document.pat96olv.trnlvtyp.options[i].value.substring(14,15);
  if(document.pat96olv.ptcnhdps.value!="3"){
    if (ind != "C") {
      TranSrcDesc.innerHTML="";
      TranSrcField.innerHTML=transferblank.innerHTML;
      document.pat96olv.transrce.value=" ";
    } else {
      TranSrcDesc.innerHTML="Leave Transfer Source";
      TranSrcField.innerHTML=transfersrc.innerHTML;
    }
  }
}
function checkLegalStatus(){
if (document.pat96olv.mehvisfl.value == "0"){
    return;}
legstat=document.pat96olv.mehlegst.value.substr(3,1)
leavtyp=document.pat96olv.trnlvtyp.value.substr(3,1)
if (leavtyp=="H" && legstat!="I"){
    alert("Invalid legal status for type of leave.")
  }
if (leavtyp=="A"){
    document.pat96olv.trnsretn.className="";
   }else{
    document.pat96olv.trnsretn.className="Mandatory";}
}

//Make sure that the time is not in the future
//if the day is the current day
function validateFutureTime() {

  //Gets the current date and time
  var date = document.pat96olv.currentDate;
  var time = document.pat96olv.currentTime;
  SetCurrentDateTimeNoFocus(date,time);

  //Checks if the date is the current date
  if (SetDateYYYYMMDD(date.value) == document.pat96olv.trandate.value) {
  
    //Checks to see if the onleave time is greater than the current time
    if(time.value < document.pat96olv.trantime.value) {

      //Produces and error is it is the case
      alert("On-Leave Date & Time cannot be in the future");
      return false;
    }
  }
  return true;
}

function SubmitTransfer() {


if (!validateFutureTime()) {
  return;
}

if(document.pat96olv.pmlrd030.className=="Mandatory"){
  if(document.pat96olv.pmlrd030.value.length<2){
    alert("Carer Name must be 2 characters or more");
    return;
  }
}
if (validateMandatory(pat96olv)) {
  leavtyp=document.pat96olv.trnlvtyp.value.substr(3,1)
  legstat=document.pat96olv.mehlegst.value.substr(3,1)
  p=document.pat96olv
  if(document.pat96olv.lvrredir.value=="1"){
     document.pat96olv.redirect.value="patweb92.pbl?reportno=01&template=135"+
       "&leavward="+p.leavward.value+"&leavrisk="+p.leavrisk.value+
       "&leavstat="+p.leavstat.value+"&leavcare="+p.leavcare.value+
       "&leavereg="+p.leavereg.value
  }
    SetHousekeeping();
    document.pat96olv.pmlrd002.value=document.pat96olv.trandate1.value;
    document.pat96olv.pmlrd003.value=document.pat96olv.trantime.value;
    document.pat96olv.pmlrd010.value=document.pat96olv.trnlvtyp.value;
    document.pat96olv.pmlrd011.value=document.pat96olv.trnsretn.value;
    document.pat96olv.pmlrd012.value=document.pat96olv.trnsrett.value;
 if(!ChkDateTime(p.pmlrd002,p.pmlrd003,p.trnsretn,p.trnsrett)){
  alert("Expected Return date and time must be after on leave date and time");
  return;
 }
    SubmitHidden(pat96olv);
  }
}
function TOLMand() {
  if (document.pat96olv.stateind.value=="3") {
     document.pat96olv.trnlvtyp.className="Mandatory";
  }
}
function ShowHouse() {
  if(document.pat96olv.ptcnchot.value=="1") {
    Housekeeping1.innerHTML=Displayhousekeeping1.innerHTML;
    Housekeeping2.innerHTML=Displayhousekeeping2.innerHTML;
    Housekeeping3.innerHTML=Displayhousekeeping3.innerHTML;
    Housekeeping4.innerHTML=Displayhousekeeping4.innerHTML;
  }
}
function HouseMandatory() {
  if(document.pat96olv.notifyhs.value=="1") {
     document.pat96olv.pmhrd006.className="Mandatory"
     document.pat96olv.pmhrd006.disabled=false;
  } else {
     document.pat96olv.pmhrd006.selectedIndex=0;
     document.pat96olv.pmhrd006.className="Readonly"
     document.pat96olv.pmhrd006.disabled=true;
  }
}
function SetHousekeeping() {
  if(document.pat96olv.ptcnchot.value=="1" &&
    document.pat96olv.notifyhs.value=="1") {
    i=document.pat96olv.trandate.selectedIndex;
    document.pat96olv.pmhrd004.value=document.pat96olv.trandate.options[i].text;
    document.pat96olv.pmhrd005.value=document.pat96olv.trantime.value;
  }
}
function FilterLeaveType() {
 if(document.pat96olv.mh_visit.value == "1") {
   filterCatCodeList(pat96olv.trnlvtyp,"6","G","1");  // MH Visit
 } else {
   filterCatCodeList(pat96olv.trnlvtyp,"6","M","1");  // Non MH Visit
 }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);FilterLeaveType();CarerName();ShowHouse();
 document.pat96olv.trnlvtyp.focus();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB96.03.003";
PatientVIS="%PATWEB96.03.081";
PatientNAM="%PATWEB96.03.002";
PatientSTA="%PATWEB96.03.086.078";
PatientALT="%PATWEB96.03.084";
PatientSEX="%PATWEB96.03.019";
PatientDOB="%PATWEB96.03.020";
PatientAGE="%PATWEB96.03.021";
PatientLOC="%PATWEB96.03.083";
PatientPRI="%PATWEB96.03.086.066.1";
PatientUNT="%PATWEB96.03.066.0";
DoctorCOD="%PATWEB96.03.082.003";
DoctorNAM="%PATWEB96.03.082.002";
PatientAID="%PATWEB96.03.086.090";
PatientIND="%PATWEB96.03.086.091";
PatientCUR="%PATWEB96.03.086.092";
PatientCLC="%PATWEB96.03.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB96.03.086.094";
PatientCDM="%PATWEB96.03.086.095";
PatientVDH="%PATWEB96.03.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
  <form name=pat96olv id=pat96olv %PATWEB96.03.201.001
  <input type=hidden name=urnumber id=urnumber value="%PATWEB96.03.003">
  <input type=hidden name=admissno id=admissno value="%PATWEB96.03.081">
  <input type=hidden name=trnleave id=trnleave value="1">
  <input type=hidden name=redirect id=redirect value="%PATWEB96.03.001.patweb96.03.004">
  <input type=hidden name=nextpage id=nextpage value="7">
  <input type=hidden name=formactn id=formactn value="OnLeave">
  <input type=hidden name=mehvisfl id=mehvisfl value="%PATWEB96.03.219">
  <input type=hidden name=mehlegst id=mehlegst value="%PATWEB96.03.085.005.3">
  <input type=hidden name=stateind id=stateind value="%PATWEB96.03.227">
  <input type=hidden name=trandate1 id=trandate1>
  <input type=hidden name=ptcnhdps id=ptcnhdps value="%STANDARD.01.025.080.250.1.1">
  <input type=hidden name=ptcnchot id=ptcnchot value="%STANDARD.01.025.114.138.0.1">
  <input type=hidden name=mnhllvin id=mnhllvin value="%PATWEB96.03.235">
  <input type=hidden name=mnhltylv id=mnhltylv value="%PATWEB96.03.236">
  <input type=hidden name=mnhlexrd id=mnhlexrd value="%PATWEB96.03.237">
  <input type=hidden name=mnhlexrt id=mnhlexrt value="%PATWEB96.03.238">
  <input type=hidden name=mnhlredt id=mnhlredt value="">
  <input type=hidden name=currentTime id=currentTime value="">
  <input type=hidden name=currentDate id=currentDate value="">
  <input type=hidden name=mnhlretm id=mnhlretm value="">
  <input type=hidden name=mnhllswd id=mnhllswd value="%PATWEB96.03.212.2">
  <input type=hidden name=mnhllsbd id=mnhllsbd value="%PATWEB96.03.212.1">
  <input type=hidden name=mh_visit id=mh_visit value="%PATWEB96.03.263">
  <input type=hidden name=no_minutes id=no_minutes value="0">
  <input type=hidden name=no_min15 id=no_min15 value="15">
  <input type=hidden name=no_min30 id=no_min30 value="30">
  <input type=hidden name=no_min60 id=no_min60 value="60">
  <input type=hidden name=no_min120 id=no_min120 value="120">
  <input type=hidden name=pmlrd001 id=pmlrd001 value="%PATWEB96.03.081">
  <input type=hidden name=pmlrd002 id=pmlrd002 value="">
  <input type=hidden name=pmlrd003 id=pmlrd003 value="">
  <input type=hidden name=pmlrd004 id=pmlrd004 value="%PATWEB96.03.105.1">
  <input type=hidden name=pmlrd005 id=pmlrd005 value="%PATWEB96.03.106">
  <input type=hidden name=pmlrd010 id=pmlrd010>
  <input type=hidden name=pmlrd011 id=pmlrd011>
  <input type=hidden name=pmlrd012 id=pmlrd012>
  <input type=hidden name=cat_TL id=cat_tl value="TL">
  <input type=hidden name=leavregr id=leavregr value="1">
  <input type=hidden name=pmlrd006 id=pmlrd006 value="L">
  <input type=hidden name=pmwoudf4 id=pmwoudf4 value="%PATWEB96.03.284.1">
  <input type=hidden name=wbsenurs id=wbsenurs value="%STANDARD.01.040">
  <input type=hidden name=caretype id=caretype value="%PATWEB96.03.113.3">
  <input type=hidden name=lvrredir id=lvrredir value="%PATWEB96.03.286">
  <input type=hidden name=leavward id=leavward value="%PATWEB96.03.287">
  <input type=hidden name=leavrisk id=leavrisk value="%PATWEB96.03.288">
  <input type=hidden name=leavstat id=leavstat value="%PATWEB96.03.289">
  <input type=hidden name=leavcare id=leavcare value="%PATWEB96.03.290">
  <input type=hidden name=leavereg id=leavereg value="%PATWEB96.03.291">

<table border=0 width=100% cellspacing=0 cellpadding=1 >
  <tr><td class=HeadingCell align=center width=100% colspan=6>
        Add Leave Register Details - %PATWEB96.03.002 </td></tr>
   <tr><td class=DataLabel >Ward / Bed </td>      
       <td ><input type=text size=25 readonly class=readonly value="%PATWEB96.03.105.0">
       <input type=text size=15 readonly class=readonly value="%PATWEB96.03.106"></td>
       <td><div id=AbscondedDIV></div></td>
       <td><div id=AbscondedCheckboxDIV></div></td>
       </tr>

    <tr><td class=DataLabel>On-Leave Date & Time</td>
    <td><select name=trandate id=trandate class=Mandatory title="On-Leave date"
         onchange=convertDate(document.pat96olv.trandate.value);>
       %PATWEB96.03.202
       </select>
      <input type=text size=8 name=trantime id=trantime class=Mandatory
       title="On-Leave Time" value="%STANDARD.01.016">
      <img src=../images/DateTimeStamp.gif class=Icon
      onclick="SetCurrentDateTime(null,trantime);">
      <img src=../images/TimeLookup.gif class=Icon
      onclick="TimeLookupFrame(trantime);"></td></tr>

       <tr><td class=DataLabel>%STANDARD.01.017.TL</td>
       <td><select name=trnlvtyp id=trnlvtyp class=Mandatory
            title="%STANDARD.01.017.TL" 
	    onchange="defaultExp();">
           <option> </option>
             %STANDARD.01.018.TL.   .9.4
          </select>
         </td></tr>


        <tr><td class=DataLabel>Expected Return Date & Time</td>
        <td colspan=4><input type=text size=12 name=trnsretn id=trnsretn 
                   class="Mandatory" value="%STANDARD.01.015"
                   title="Expected Return Date">
        <img src=../images/DateLookup.gif class=Icon
          onclick="DateLookupFrame(trnsretn);">
        <input type=text size=8 name=trnsrett id=trnsrett class=Mandatory
         title="Expected Return Time" value="">
        <img src=../images/TimeLookup.gif class=Icon
         onclick="TimeLookupFrame(trnsrett);">
      <input type=button class="button" value="15 min" 
       onclick="AddSubtractMinute(document.pat96olv.trandate1,
       document.pat96olv.trantime,document.pat96olv.no_min15,
       'A',document.pat96olv.trnsretn,document.pat96olv.trnsrett);" >
      <input type=button class="button" value="30 min" 
       onclick="AddSubtractMinute(document.pat96olv.trandate1,
       document.pat96olv.trantime,document.pat96olv.no_min30,
       'A',document.pat96olv.trnsretn,
       document.pat96olv.trnsrett);" >
      <input type=button class="button" value="60 min" 
       onclick="AddSubtractMinute(document.pat96olv.trandate1,
       document.pat96olv.trantime,document.pat96olv.no_min60,
      'A',document.pat96olv.trnsretn,
       document.pat96olv.trnsrett);" >
      <input type=button class="button" value="120 min" 
       onclick="AddSubtractMinute(document.pat96olv.trandate1,
       document.pat96olv.trantime,document.pat96olv.no_min120,
      'A',document.pat96olv.trnsretn,
       document.pat96olv.trnsrett);" >
       </tr>
       <tr><td class=DataLabel>%STANDARD.01.017.vd</td>
       <td><select name=pmlrd014 id=pmlrd014 class=Mandatory
            title="%STANDARD.01.017.vd" onchange="CarerName();">
           <option> </option>
           %PATWEB96.03.284.2
          </select>
        <input type=hidden name=pmlrd015 id=pmlrd015 value="%PATWEB96.03.285.1">
           %PATWEB96.03.285.0</td>
       </tr>

   <tr><td class=DataLabel>Destination</td>
     <td colspan=4><input type=text name=pmlrd013 id=pmlrd013 size=100 
          title=Destination class=Mandatory
          maxlength=100">
   </td></tr>

   <tr><td>Carer Consent </td>
      <td colspan=4><input type="checkbox" name="d_pmlrd034" value="0"
           onclick="carerMandatory();"></td></tr>
   <tr><td class=DataLabel>Carer Details</td>
      <td><input type=button class="button" value="Search" 
      onclick="selectCarer();" >Search patient's contacts for carer details</td>

   <tr><td class=DataLabel>or</td></tr>

   <tr><td class=DataLabel>Carer Name</td>
     <td colspan=4><input type=text name=pmlrd030 id=pmlrd030 
        title="Carer Name" size=100 maxlength=100">
   </td></tr>

   <tr><td class=DataLabel>Carer Contact</td>
     <td><input type=text name=pmlrd031 id=pmlrd031 class="MobilePhone" 
        size=20 maxlength=20" title="Carer Contact">
   </td></tr>
         <input type=hidden name=pmlrd032 id=pmlrd032 >
         <input type=hidden name=pmlrd033 id=pmlrd033 >

  <tr><td class=DataLabel>Form</td>
  <td> <select name=statncod onchange=setPrinterMand();>
         <option></option>
         %STANDARD.01.020.  3        
   </select>
  Printer
  <select name=schdprnt>
     %STANDARD.01.001.PATWEB96.03
   </select>
  </td></tr>
  <input type=hidden name=schdcopy id=schdcopy value="1"></td></tr>
  <tr><td>Meds Given</td>
       <td><select name=pmlrd020 title="Meds Given">
          <option value="0">No</option>
          <option value="1">Yes</option>
          <option value="2">N/A</option>
        </select></td></tr>

  <tr><td class=DataLabel>Notes</td>
      <td colspan=4><textarea name=leavecom wrap=hard cols=100 rows=4 tabindex=60></textarea>
   </td></tr>
         <tr><td><div id="Housekeeping1"></div></td>
         <td><div id="Housekeeping2"></div></td>
         <td><div id="Housekeeping3"></div></td>
         <td><div id="Housekeeping4"></div></td></tr>

<tr><td class=DataLabel>User Id </td>
    <td><input type=hidden name=securety value="2">
        <input type=hidden name=triguser value="1">
        <input type=hidden name=genericu value="%PATWEB96.03.256">
        <input type=text size=12 name=secureid class="Mandatory NoAutoFocus"
          tabindex=1 title="User ID" value="%STANDARD.01.043">
    Password
    <input type=password size =12 name=securepw class=Mandatory tabindex=2
         title="Password" onfocus="SetCaretPosition('securepw',-1);"
         onblur="checkPass();">
    </td>

   <tr><td align=center colspan=4><input type=button class="button" value="Add"
         id='addbutton'
         onclick="tempDisable(this);SubmitTransfer(this.form,'OnLeave');">
            <input type=button value=Cancel class="button"
             onclick="history.go(-1);">
       </td></tr>
</table>
</form>
</div>

<form name=PatientLinks id=PatientLinks method=get>
<input type=hidden name=reportno id=reportno value=1>
<input type=hidden name=template id=template value=004>
<input type=hidden name=urnumber id=urnumber value="%PATWEB96.03.003">
<input type=hidden name=admissno id=admissno value="%PATWEB96.03.081">
<input type=hidden name=MenuType id=MenuType value="%PATWEB96.03.088">
<input type=hidden name=alert001 id=alert001 value="">
<input type=hidden name=curstate id=curstate value="%PATWEB96.03.104">
</form>

<span id=blanklabel style="display:none">&nbsp;</span>

<div id="AbscondedQ" style="display:none">
ABSCONDED?
</div>
<div id="Absconded" style="display:none">
<font color=Red><b>ABSCONDED</b>
</div>
<div id="AbscondedCheckbox" style="display:none">
<input type=checkbox value=1 name=d_pmlrd006 id=d_pmlrd006 onclick='AbsDiv()'>
</div>

<div id="Displayhousekeeping1" style="display:none">
Notify Housekeeping
</div>

<div id="Displayhousekeeping2" style="display:none">
  <select name=notifyhs id=notifyhs title="Notify Housekeeping"
   onchange="HouseMandatory();">
  <option> </option>
  <option value="0">No</option>
  <option value="1">Yes</option>
  </select>
</div>
<div id="Displayhousekeeping3" style="display:none">
Housekeeping Status
</div>

<div id="Displayhousekeeping4" style="display:none">
  <input type=hidden name=pmhrd001 id=pmhrd001 value="%PATWEB96.03.599.004">
  <input type=hidden name=pmhrd002 id=pmhrd002 value="%PATWEB96.03.105.1">
  <input type=hidden name=pmhrd003 id=pmhrd003 value="%PATWEB96.03.106">
  <input type=hidden name=pmhrd004 id=pmhrd004 value="">
  <input type=hidden name=pmhrd005 id=pmhrd005 value="">
  <select name=pmhrd006 id=pmhrd006 title="Housekeeping Status" class=Readonly disabled>
    <option> </option>
    %STANDARD.01.007.BV
  </select>
</div>
<script type=text/javascript>
 if(%PATWEB96.03.283==1){
   alert("Leave register table not configured");
   history.go(-1);
 }
 p=document.pat96olv
 if((p.caretype.value.substr(72,1)=='N')&& (isWhitespace(p.wbsenurs.value))){
  if(!confirm("Nurse Code required on Login details to put "+
     "this patient on leave")){
     history.go(-1);
  }
 }

function CarerName(){
   if(document.pat96olv.pmlrd014.value.substr(3,1)=="C"){
     pat96olv.pmlrd030.className="Mandatory";  //Carer name
     pat96olv.pmlrd031.className="Mandatory MobilePhone";  //Carer Contact number
   }
   if((document.pat96olv.pmlrd014.value.substr(3,1)!="C")&&(document.pat96olv.d_pmlrd034.checked==false)){
     pat96olv.pmlrd030.className="";  //Carer name
     pat96olv.pmlrd031.className="MobilePhone";  //Carer Contact number
  }
}
function AbsDiv(){
 if(document.pat96olv.d_pmlrd006.checked==true){
   AbscondedDIV.innerHTML=Absconded.innerHTML;
   document.pat96olv.pmlrd006.value='A';
   document.pat96olv.pmlrd014.className="";
   document.pat96olv.pmlrd013.className="";
   document.pat96olv.trnlvtyp.className="";
   document.pat96olv.trnsretn.className="";
   document.pat96olv.trnsrett.className="";
   document.pat96olv.pmlrd030.className="";  //Carer name
   document.pat96olv.pmlrd031.className="";  //Carer Contact number
   document.pat96olv.trnsretn.value="";
   document.pat96olv.trnsrett.value="";
 } else {
   AbscondedDIV.innerHTML=AbscondedQ.innerHTML;
   document.pat96olv.pmlrd006.value='L';
   document.pat96olv.pmlrd014.className="Mandatory";
   document.pat96olv.trnlvtyp.className="Mandatory";
   document.pat96olv.pmlrd013.className="Mandatory";
   document.pat96olv.trnsretn.className="Mandatory";
   document.pat96olv.trnsrett.className="Mandatory";
   if(document.pat96olv.pmlrd014.value.substr(3,1)=="C"){
     pat96olv.pmlrd030.className="Mandatory";  //Carer name
     pat96olv.pmlrd031.className="Mandatory MobilePhone";  //Carer Contact number
   }
 }
}
function setPrinterMand(){
 if(document.pat96olv.statncod.value!==""){
    document.pat96olv.schdprnt.className="Mandatory";
 }
}
function selectCarer() {
  linkurl="patweb07.pbl?reportno=06&template=010" +
          "&urnumber=" + pat96olv.urnumber.value.replace(/ /g,"+");
  Left=(document.body.clientWidth-780)/2;
  DFrameLink(linkurl,50,Left,780,450);
}
</script>
