<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language="javascript" src="../js/allweb02.js"></script>
<script type="text/javascript">
//------------------------------------------------------------
// Set Link ACC Redirect and Return program after link ACC
//------------------------------------------------------------
function SetLinkACC(CurForm,ReturnCd) {
  if ((CurForm.ptcnueoc.value==1)&&(CurForm.alref035.value.substr(5,1)=='A')) {
       CurForm.redirect.value="eocweb01.pbl?reportno=01&template=006"
             + "&urnumber=" + CurForm.urnumber.value.replace(/ /g,"+")
             + '&returncd=' + ReturnCd
             + "&admissno=";
  }
} //end SetLinkACC
function AddReferral(theForm) {
//  if(!checkIfReferralInDestinationExist())
//  {
//     alert("Warning: Referral in service type is mandatory");
//     return;;
//  }
  window.PageUpdateForm=theForm
  theForm.target="PopUpFrame1";
  if (validateMandatory(theForm)) {
//  setRedirect();

    if(!isWhitespace(theForm.alref039.value) &&
       !isWhitespace(theForm.alref132.value)) {
       if(SetDateYYYYMMDD(theForm.alref039.value) >
          SetDateYYYYMMDD(theForm.alref132.value)) {
          alert(theForm.alref132.title + " must be after " +
          theForm.alref039.title);
          return;
       }
    }

    if (theForm.alref075.value.substr(14,1)=="1") {
      if (theForm.alref074.value.substr(14,1)=="9") {
      alert("Carer Resident Status is incompatible with Carer Availability.\n" +
            "Please select alternate Carer Resident Status value");
        return;
      }
    }

    SetLinkACC(theForm,"AL1");
    theForm.submit(); }
}
function valClaimCode() {
  validateCode(41,UpdateForm.urnumber,UpdateForm.claimc);
  for (var i =0 ; i < document.UpdateForm.alref035.length; i++) {
//    alert(UpdateForm.alref035.options[i].value.substr(0,3));
    if (document.UpdateForm.claimc.value==
        trim(document.UpdateForm.alref035.options[i].value.substr(0,3))){
          document.UpdateForm.alref035.selectedIndex=i;
    }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);valClaimCode();CommonProgramRef();ShowRelationship(document.UpdateForm.alref075);">
<span class=DFrameTitleBar>
<img border=0 align=right src="../images/ExitIcon.gif" onclick="DFrameExit();">
%ALLWEB02.03.125.0  Referral
</span>
<div id=PageBodySection style="overflow: auto;">
<form id=UpdateForm name=UpdateForm action="allweb02.pbl" method=post
 onsubmit='return validateMandatory(UpdateForm);' >
<input type=hidden name=reportno value="2">
<input type=hidden name=updatety value="A">
<input type=hidden name=nextpage value="5">
<input type=hidden name=redirect value="%ALLWEB02.03.001.allweb02.02.001">
<input type=hidden name=urnumber value="%ALLWEB02.03.003">
<input type=hidden name=admissno value="%ALLWEB02.03.081">
<input type=hidden name=MenuType value="%ALLWEB02.03.088">
<input type=hidden name=deptcode value="%ALLWEB02.03.125.1">
<input type=hidden name=deptlcod id=deptlcod value="%ALLWEB02.03.125.3">
<input type=hidden name=uservari value="%ALLWEB02.03.113">
<input type=hidden name=usermemr value="">
<input type=hidden name=alref088 value=" ">
<input type=hidden name=alref135 value="%STANDARD.01.008">
<input type=hidden name=dummy>
<input type="hidden" name="mvmedrec">
<input type="hidden" name="claimc">
<input type=hidden name=ptcnueoc value="%ALLWEB02.03.203">
<input type=hidden name=sacsvisn value="%ALLWEB02.03.207">
<input type=hidden name=wbsesite value="%STANDARD.01.023">
<input type="hidden" name="alref028" value=" " />
<input type="hidden" name="referlin" value="1" />
<input type=hidden name=override value="2">
<input type=hidden name=intrvisn value="%ALLWEB02.03.228">
<input type="hidden" name="d_aldeutrs" id="d_aldeutrs"
 value="%ALLWEB02.03.762.3">
<input type="hidden" name="d_alrestat" id="d_alrestat"
 value="%ALLWEB02.03.199.027">
<input type="hidden" name="d_aldeuprt" id="d_aldeuprt"
 value="%ALLWEB02.03.762.4">

<table align=center cellspacing=0 cellpadding=0 border=0 width=95%>
<tr><td class=DataLabel>Department Code</td>
    <td><input name=allrf001 type=text value="%ALLWEB02.03.125.0" readonly
	  class=Readonly></td>
    <td class=DataLabel>Entered by</td>
    <td><input	type=text value="%ALLWEB02.03.168" readonly 
	  class=Readonly></td></tr>

<tr><td class=DataLabel><div id="tsHeading"></div></td>
      <td><div id="tsField"></div></td>
      <td class=DataLabel><div id="tdHeading"></div></td>
      <td><div id="tdField"></div></td>
      </tr>

<tr><td class=DataLabel><div id="prHeading"></div></td>
    <td><div id="prField"></div></td>
    <td class=DataLabel>Referral Date</td>
    <td class=DataField>
    <input type=text name=alref019 size=12 tabindex=30 id=alref019
     onblur="if(checkDate(this,'Date')){checkTriageDate();}"
     class= "PastDate Mandatory" title="Referral Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref019
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref019>
    </td></tr>

<tr><td class=DataLabel>Referral Source</td>
    <td><select title="Referral Source" name=alref034 tabindex=2
         class="Mandatory SelectBig">
	<option></option>
	 %ALLWEB02.03.134.2
	</select></td>
    <td class=DataLabel>Referred By</td>
    <td><input type=hidden name=alref022 id=alref022
	 value="%ALLWEB02.03.122.1">
	<input type=text name=n_alref022 readonly title="HCP Name"
	 value="%ALLWEB02.03.122.0" notab size=14 id=n_alref022>
	<img src="../images/SearchIcon.gif" class=Icon
	 onclick="HCPSearchFrame(UpdateForm.alref022,UpdateForm.n_alref022,7);">
        <img src="../images/ClearIcon.gif" class=Icon
        onclick="clrFields(alref022,n_alref022);">
	</td></tr>

<tr><td class=DataLabel>Case Manager</td>
    <td><input type=text name=alref086 size=10 maxlength=10 tabindex=3
          value="%ALLWEB02.03.147.1" title="Case Manager" id=alref086
         onblur="ValidateHCP(18,13,alref086,n_alref086);">
        <input type=text name=n_alref086 size=30 readonly title="HCP Name"
         class=Readonly value="%ALLWEB02.03.147.0" id=n_alref086>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(UpdateForm.alref086,UpdateForm.n_alref086,4);">
        </td>
    <td class=DataLabel>Referral In Received Date</td>
    <td class=DataField>
    <input type=text id=alref039 name=alref039 size=12 tabindex=32
     onblur="checkDate(this,'Date')" value="%ALLWEB02.03.139"
     class="Mandatory PastDate" title="Referral In Received Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref039
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref039>
    </td></tr>

<tr><td class=DataLabel>Responsible HCP</td>
    <td><input type=text name=alref038 size=10 maxlength=10 title="HCP"
	 value="%ALLWEB02.03.138.1" tabindex=4 id=alref038
          onblur="ValidateHCP(18,13,alref038,n_alref038);">
	<input type=text name=n_alref038 size=30 readonly title="HCP Name"
	 value="%ALLWEB02.03.138.0" class=Readonly id=n_alref038>
	<img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(UpdateForm.alref038,UpdateForm.n_alref038,4);">
	</td>
    <td class=DataLabel>VINAH Referral</td>
    <td><input type=checkbox name=alref083 title="VINAH Referral"
         checked value="1" tabindex=35>
    </td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td><select title="%STANDARD.01.017.CL" name=alref035 tabindex=5
         class="SelectBig">
	<option></option>
	 %ALLWEB02.03.135.9.1.10.2.X
	</select></td>
    <td class=DataLabel>Living Arrangement</td>
    <td><select title="Living Arrangement" name=alref077 tabindex=36
         class="SelectBig">
        <option></option>
         %ALLWEB02.03.140.38.4
        </select></td>
    </tr>

<tr>
<!--<td></td>
    <td><input type="button" class="Largebutton"
         id="btnReferralInDestination" name="btnReferralInDestination"
         value="Referral In Details"
         onclick="openReferralInDestinationAdd();"/>
    </td>-->

    <td class=DataLabel>%STANDARD.01.017.zU</td>
    <td><select title="%STANDARD.01.017.zU" name=rfdtr001 tabindex=40
         class="Mandatory SelectBig">
        <option></option>
         %STANDARD.01.018.zU.   .9.1.01.2.O
        </select>
    <input type=hidden name=rfdat001 value="">
    <input type=hidden name=rfdpl001 value="">
    <script type="text/javascript">
      SetCurrentDateTimeNoFocus(document.UpdateForm.rfdat001,null);
    </script>
    </td>

    <td class=DataLabel>Accommodation</td>
    <td><select title="Accommodation" name=alref078 tabindex=36
         class="SelectBig">
        <option></option>
         %ALLWEB02.03.140.39.4
        </select></td>
    </tr>

<tr><td class=DataLabel>
    <span id="careplantitlespan" style="display:none">
     Care Plan Documented
    </span>
    </td>
    <td class=DataField>
    <span id="careplanfieldspan" style="display:none">
    <input type=text name=alref096 size=12 onblur="checkDate(this,'Date')"
     value="" class="PastDate" id=alref096
     title="Care Plan Documented">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref096
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref096>
    </span>
    </td>
    <td class=DataLabel>Date of Referral Receipt<br />Acknowledgement</td>
    <td class=DataField>
    <input type=text name=alref132 size=12 tabindex=37 id=alref132
     onblur="checkDate(this,'Date')" value="%ALLWEB02.03.199.003"
     class="PastDate" title="Date of Referral Receipt Acknowledged">
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.alref132
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref132>
    </td></tr>

<tr><td class=DataLabel>&nbsp; </td>
    <td>&nbsp;</td>
    <td class=DataLabel>Referral Acknowledged By</td>
    <td><input type=text name=n_alref135
         value="%STANDARD.01.009" readonly class=Readonly></td>
    </tr>

<tr><td class=DataLabel width=15%>Referral Acknowledgement Received By</td>
    <td><input type=text size=65 maxlength=60 name=alref089 tabindex=11
         value="%ALLWEB02.03.150" title="Acknowledgement Received By">
    </td>
    <td class=DataLabel>Referral Acknowledged Via</td>
    <td><select title="Referral Acknowledged Via" name=alref076 tabindex=38
         class="SelectBig">
        <option></option>
         %ALLWEB02.03.140.37.2
        </select></td>
</tr>

<tr><td class=DataLabel>Activate Referral</td>
    <td class=DataField><input type=checkbox name=alref003 value="1"
                         title="Activate Referral" tabindex=12>
    </td>
    <td class=DataLabel>Carer Availability</td>
    <td><select title="Carer Availability" name=alref075 tabindex=39
         class="SelectBig" onchange="ShowRelationship(this);" 
	id=alref075>
        <option></option>
         %ALLWEB02.03.140.36.4
        </select></td>
    </tr>

<tr><td class=DataLabel>Case Team</td>
   <td><input type=text name=alref087 size=11 maxlength=11 title="Case Team"
        value="%ALLWEB02.03.148.1" tabindex=13 id=alref087
        onblur="validateCode2(7,alref087,n_alref087)">
       <input type=text name=n_alref087 size=38 readonly id=n_alref087
        class=Readonly tabindex=-1 title="Team Description"
        value="%ALLWEB02.03.148.0">
       <img src="../images/SearchIcon.gif" class=Icon
        onclick="TeamSearchFrame(alref087,n_alref087)">
        <img src="../images/ClearIcon.gif" class=Icon
        onclick="clrFields(alref087,n_alref087);">
       </td>
    <td class=DataLabel><div id="CarerRelHeading"></div></td>
    <td><div id="CarerRel"></div></td>
    </tr>

<tr><td class=DataLabel>Comments</td>
    <td><input type=text size=65 maxlength=62 name=alref088 tabindex=14>
    </td>
    <td class=DataLabel><div id="CarerResHeading"></div></td>
    <td><div id="CarerRes"></div></td>
    </tr>

<tr><td colspan=4 align=center><br>
    <input type=button name=formactn value="Add" class="button" tabindex=100
     id="addButton" onclick="tempDisable(this);AddReferral(UpdateForm);">
    <input type=button Value="Cancel" class="button" tabindex=101
     onclick="DFrameCloseRefresh();">
    </td></tr>

</table>
</form>
</div>

<span id="ShowCarerRelHD" style="display:none">
%STANDARD.01.017.lE
</span>

<span id="ShowCarerRel" style="display:none">
  <select title="%STANDARD.01.017.lE" name=alref070 tabindex=39
   class="SelectBig Mandatory">
   <option></option>
   %ALLWEB02.03.140.31.2
   </select>
</span>

<span id="ShowCarerRelBlank" style="display:none">
  <input type="hidden" name="alref070" value=" ">
</span>

<span id="ShowCarerResHD" style="display:none">
%STANDARD.01.017.lI
</span>

<span id="ShowCarerRes" style="display:none">
  <select title="%STANDARD.01.017.lI" name=alref074 tabindex=40
   class="SelectBig Mandatory">
  <option></option>
  %ALLWEB02.03.140.35.2
  </select>
</span>

<span id="ShowCarerResBlank" style="display:none">
   <input type="hidden" name="alref074" value=" ">
</span>

<span id="showtsHeading" style="display:none">
Triage Status
</span>

<span id="showtsField" style="display:none">
<select title="Triage Status" name=alref186 class="Mandatory SelectBig"
 id="alref186" onchange="showPriorityTriage();" id=alref186>
<option></option>
%ALLWEB02.03.199.066.2
</select>
</span>

<span id="showtdHeading" style="display:none">
Triage Date
</span>

<span id="showtdField" style="display:none">
<input type=text name=alref187 id=alref187 size=12 title="Triage Date"
 value="%ALLWEB02.03.199.067" class="PastDate" id=alref187
 onblur="checkTriageDate(this);">
<img src=../images/DateTimeStamp.gif class=Icon
 date=UpdateForm.alref187 time=null>
<img src=../images/DateLookup.gif class=Icon date=UpdateForm.alref187>
</span>

<span id="showprHeading" style="display:none">
Priority
</span>

<span id="showprField" style="display:none">
<select class="Mandatory selectBig" name=alref027 id=alref027
 title="Priority">
<option></option>
 %ALLWEB02.03.127.2
</select>
</span>
