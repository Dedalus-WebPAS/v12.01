<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript">
function init() {
  if (!isWhitespace(AddForm.preftype.value)) {
    AddForm.opreq004[AddForm.preftype.value].checked=true;
    DisplayTrnSrc(AddForm.preftype.value)
  }
  else {
    DisplayTrnSrc('0')
  }
}
function DisplayTrnSrc(type) {
  if (type =="1") {
    TranSrc.innerHTML=itemcode.innerHTML;
    validateItem(document.AddForm);
  } else if (type =="2") {
    TranSrc.innerHTML=equipcode.innerHTML;
  } else {
    TranSrc.innerHTML=traycode.innerHTML;
  }
}
function AddRequisition() {
  f = document.AddForm;
  if (validateMandatory(AddForm)) {
    if (AddForm.opreq004[0].checked==true) {
      if (!ValidateTrayCode(document.AddForm)) {
        return;
      }
    }
    if (AddForm.opreq004[1].checked==true) {
      if (document.AddForm.opcnptmc.value=="1") {
        if (f.ibcnmhos.value == "1" && f.cfeetyp.value == "5") {
          if (!validateItemHosp(f.opreq005,f.d_opreq005,f.opdahosp)) {
            return;
          } 
        }
        else {
          if (!validateCode(40,f.opreq005,f.d_opreq005)) {
            return;
          }
        }
      }
      else {
        if(!validateCode(23,AddForm.opreq005,AddForm.d_opreq005)) {
          return;
        }
      }
    }
    AddForm.submit();
  }
}
function searchItem(f) {
  if (f.opcnptmc.value == "1") {
    if (f.ibcnmhos.value == "1" && f.cfeetyp.value == "5") {
      DefMiscChargeSearchFrame(f.opreq005,
                               f.d_opreq005,
                               f.opdahosp);
    }
    else {
      DefMiscChargeSearchFrame(f.opreq005,
                               f.d_opreq005,
                               f.multhosp);
    }
  }
  else {
    TheatItemSearchFrame(f.opreq005,f.d_opreq005,'7');
  }
}
function validateItem(f) {
  if (isWhitespace(f.opreq005.value)) {
    f.d_opreq005.value = "";
    return;
  }

  if (f.opcnptmc.value=="1") {
    if (f.ibcnmhos.value == "1" && f.cfeetyp.value == "5") {
      validateItemHosp(f.opreq005,f.d_opreq005,f.opdahosp);
    }
    else {
      validateCode(40,f.opreq005,f.d_opreq005);
    }
  }
  else {
    validateCode(23,f.opreq005,f.d_opreq005);
  }
}
function chkquantity() {
  if (checkInteger(AddForm.opreq006,AddForm.opreq006.title)) {
      if (trim(AddForm.opreq006.value)=='0' || isWhitespace(trim(AddForm.opreq006.value))) {
        alert ('Quantity must not be Zero');
        AddForm.opreq006.value='1';} 
  }
}
function TraySearchFrameClick(f) {
  opdahosp = f.opdahosp.value;

  ShowTraySearchFrame(f.opreq005,
                      f.d_opreq005,
                      "7",
                      opdahosp)
}
function ValidateTrayCode(f) {
  opdahosp = f.opdahosp.value;
  if (isWhitespace(f.opreq005.value)) {
    f.d_opreq005.value = "";
    return true;
  }

  return ValidateTrayHospital(f.opreq005,f.d_opreq005,opdahosp);
}
function btnAddClick(f) {
  if (!validateMandatory(f)) {return;}
  if (!ValidateTrayCode(f)) {return;}

  SubmitForm();
}
function validateEquipment(f) {
  if (isWhitespace(f.opreq005.value)) {
    f.d_opreq005.value = "";
    return;
  }

  if (f.ibcnmhos.value == "1") {
    validateEquipmentHospital(f.opreq005,f.d_opreq005,f.opdahosp.value);
  }
  else {
    validateEquipmentHospital(f.opreq005,f.d_opreq005,"");
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img border=0 align=right src=../images/ExitIcon.gif 
     onclick="DFrameExitRefresh();">
<script type="text/javascript">
document.write('Add '+self.document.title);
</script>
</span>
<form name=AddForm method=post action=oprweb06.pbl
    onsubmit='return validateMandatory();' style="margin:0">
   <input type=hidden name=reportno value="14">
   <input type=hidden name=template value="002">
   <input type=hidden name=updatety value="A">
   <input type=hidden name=casekeys value="%OPRWEB06.14.101">
   <input type=hidden name=uniqueky value="%OPRWEB06.14.110">
   <input type=hidden name=teamnumb value="%OPRWEB06.14.301">
   <input type=hidden name=opreq001 value="%OPRWEB06.14.110">
   <input type=hidden name=opreq002 value="%OPRWEB06.14.301">
   <input type=hidden name=opreq007 value="%OPRWEB06.14.327">
   <input type=hidden name=preftype value="%OPRWEB06.14.305">
   <input type=hidden name=opcnptmc value="%STANDARD.01.025.113. 66.0.1">
   <input type=hidden name=multhosp value="%STANDARD.01.032">
   <input type=hidden name=opdahosp value="%OPRWEB06.14.193.1">
   <input type=hidden name=ibcnmhos id=ibcnmhos
    value="%STANDARD.01.025.000.043.1.1">
   <input type=hidden name=cfeetyp id=cfeetyp
    value="%STANDARD.01.025.019.212.1.1">

<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Type
    <td class=DataLabel>
    Tray      <input type=radio name=opreq004 title="type" value=0 
               onclick="DisplayTrnSrc('0');" checked>&nbsp;&nbsp;&nbsp;
    Item      <input type=radio name=opreq004 title="type" value=1 
               onclick="DisplayTrnSrc('1');">&nbsp;&nbsp;&nbsp;
    Equipment <input type=radio name=opreq004 title="type" value=2 
               onclick="DisplayTrnSrc('2');">
    </td></tr>
</table>

<span id=TranSrc></span>

<table align=center width=100% border=0>

<tr><td class=DataLabel>Class </td>
    <td><select name=opreq003 title="Class" class=Mandatory>
        <option></option>
        %OPRWEB06.14.307.2 
        </select>
    </td></tr>

<tr><td class=DataLabel width=20%>Quantity </td>
    <td><input type=text name=opreq006 title="Quantity" 
        class="Mandatory Integer" onblur="chkquantity();"
         min=0 size=8 maxlength=6 value="%OPRWEB06.14.308">
    </td></tr>

<tr><td colspan=2 align=center><br>
    <input type=button id="opr06sub"  value="Add" class="button" 
     onclick="tempDisable(this);AddRequisition();">
    <input type=button value="Close" class="button" 
     onclick='DFrameCloseRefresh()'>
</td></tr>

</table>
</form>

<span id=traycode style="display:none">
<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Tray</td>
    <td><input type=text name=opreq005 title="Tray" class=Mandatory 
         size=15 maxlength=15
         onblur="ValidateTrayCode(document.AddForm);"
         value="%OPRWEB06.14.306.0">
        <input type=text name=d_opreq005 title="Tray Desc"
         size=60 class=Readonly readonly tabindex=-1 value="%OPRWEB06.14.306.1">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="TraySearchFrameClick(document.AddForm);">
    </td></tr>
</table>
</span>

<span id=itemcode style="display:none">
<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Item </td>
    <td><input type=text name=opreq005 title="Item" 
         class=Mandatory size=15 maxlength=15 
         onblur="validateItem(document.AddForm);"
         value="%OPRWEB06.14.306.0">
        <input type=text name=d_opreq005 title="Item Description" 
         size=90 readonly class=Readonly tabindex=-1 value="%OPRWEB06.14.306.1">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="searchItem(document.AddForm);">
    </td></tr>
</table>
</span>

<span id=equipcode style="display:none">
<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Equipment </td>
    <td><input type=text name=opreq005 title="Equipment" 
         class=Mandatory size=15 maxlength=15 value="%OPRWEB06.14.306.0"
         onblur="validateEquipment(AddForm);">
        <input type=text name=d_opreq005 title="Equipment Description" 
         size=60 readonly class=Readonly tabindex=-1 value="%OPRWEB06.14.306.1">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="EquipmentSearchFrame(AddForm.opreq005,
                                       AddForm.d_opreq005,
                                       '7',
                                       AddForm.opdahosp.value);">
    </td></tr>
</table>
</span>
