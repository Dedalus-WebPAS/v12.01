<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/outweb04.js"></script>
<script type="text/javascript">
function updateLetter() {
  if (UpdateForm.rfletchk.checked == true) {
    UpdateForm.otlet008.value = "R";
  } else {
    UpdateForm.otlet008.value = " ";
  }
  if(document.UpdateForm.ptcnsmsn.value == "1") {
    if(document.UpdateForm.d_otlet010.checked==true) {
      document.UpdateForm.otlet010.value="1";
    } else {
      document.UpdateForm.otlet010.value="0";
    }
  }
  updateFormactn04();
}
function checkPaper(chk) {
  if (isWhitespace(chk.value)) { return true; }
  chknum=chk.value - 0; // Convert to Numeric
  if (chknum < 1 || chknum > 999) {
    alert(chk.title + " must be greater than 1 and less than 999");
    chk.value="";
    FocusDelay(chk);
  }
}
function checkTopMargin(chk) {
  if (isWhitespace(chk.value)) { return true; }
  chknum=chk.value - 0; // Convert to Numeric
  if (chknum < 1 || chknum > 99) {
    alert(chk.title + " must be greater than 1 and less than 99");
    chk.value="";
    FocusDelay(chk);
  }
}

function checkBottomMargin(chk) {
  if (isWhitespace(chk.value)) { return true; }
  chknum=chk.value - 0; // Convert to Numeric
  if (chknum < 1 || chknum > 99) {
    alert(chk.title + " must be greater than 1 and less than 99");
    chk.value="";
    FocusDelay(chk);
  }
}

function checkLeftMargin(chk) {
  if (isWhitespace(chk.value)) { return true; }
  chknum=chk.value - 0; // Convert to Numeric
  if (chknum < 1 || chknum > 99) {
    alert(chk.title + " must be greater than 1 and less than 99");
    chk.value="";
    FocusDelay(chk);
  }
}
function checkPageSizeandMargins() {
  if (document.UpdateForm.otlet005.value == "0" ||
      document.UpdateForm.otlet004.value == "0" ||
      document.UpdateForm.otlet003.value == "0" ||
      document.UpdateForm.otlet006.value == "0") {
    alert("Paper size and margins cannot be 0.");
    if (document.UpdateForm.otlet005.value == "0") {
      document.UpdateForm.otlet005.value="";
    }
    if (document.UpdateForm.otlet004.value == "0") {
      document.UpdateForm.otlet004.value="";
    }
    if (document.UpdateForm.otlet003.value == "0") {
      document.UpdateForm.otlet003.value="";
    }
    if (document.UpdateForm.otlet006.value == "0") {
      document.UpdateForm.otlet006.value="";
    }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);checkPageSizeandMargins();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Update Outpatient Letter
</span>
<form name=UpdateForm action="outweb04.pbl" method=post >
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=1>
<input type=hidden name=updttype value="U">
<input type=hidden name=otlet008>
<input type=hidden name=otlet009>
<input type=hidden name=otlet010>
<input type=hidden name=ptcnsmsn value="%STANDARD.01.025.120.243.0.1">

<table width=100% border=0>
<tr><td class=DataLabel width=25%>Letter Number </td>
    <td class=DataLabel>
    <input type=text size=3 maxlength=3 name=otlet001 class=readonly 
     title="Letter Number" value="%OUTWEB04.04.001" readonly> 
    </td></tr>

<tr><td class=DataLabel>Description</td>
    <td class=DataLabel colspan=3>
    <input type=text size=40 maxlength=35 name=otlet002 class=Mandatory
     title="Description" value="%OUTWEB04.04.002">
    </td></tr>

<tr><td class=DataLabel>Paper Length</td>
    <td class=DataLabel>
    <input type=text size=3 maxlength=3 name=otlet005 title="Paper Length"
     class="Mandatory Integer" onblur='checkPaper(UpdateForm.otlet005);'
     value='%OUTWEB04.04.005'>
     &nbsp;&nbsp;Margin Top
    <input type=text size=2 maxlength=2 name=otlet004 title="Top Margin"
     class='Mandatory Integer' onblur='checkTopMargin(UpdateForm.otlet004);'
     value='%OUTWEB04.04.004'>
     &nbsp;&nbsp;Bottom
    <input type=text size=2 maxlength=2 name=otlet003 title="Bottom Margin" 
     class='Mandatory Integer' onblur='checkBottomMargin(UpdateForm.otlet003);'
     value='%OUTWEB04.04.003'>
     &nbsp;&nbsp;Left
    <input type=text size=2 maxlength=2 name=otlet006 title="Left Margin"
     class='Mandatory Integer' onblur='checkLeftMargin(UpdateForm.otlet006);'
     value='%OUTWEB04.04.006'>
    </td></tr>

<tr><td class=DataLabel>Letter for Outpatient Referral</td>
    <td class=DataField><input type=checkbox name=rfletchk value="R"></td></tr>
 
<tr><td class=DataLabel>Active</td>
    <td class=DataField><input type=checkbox name="d_otlet009" value=0>
    </td></tr>
</table>

<div id="DisplaySMS" style="display: none">
<table width=100% border=0>
<tr><td class=DataLabel width=25%>SMS Message</td>
    <td><input type=checkbox name="d_otlet010" value=1
         onclick="SetSMSPaper(UpdateForm);">
    </td></tr>
</table>
</div>

<table width=100% border=0>
<tr><td class=HeadingCell colspan=4 align=center>Letter Text</td></tr>
<tr><td class=DataLabel colspan=4 align=center>
<textarea wrap=hard name=otlecomm title="Letter Text"
 cols=70 rows=14>%OUTWEB04.04.009</textarea>
<a href='javascript:LookupPage(UpdateForm.otlecomm,null,"Lookup_00500000_000")'>
<img src="../images/LookupIcon.gif" border=0></a>
</td></tr>

<tr><td colspan=4 align=center>
    <input type=button class="button" value="Update" id="out04upd"
     onclick="tempDisable(this);updateLetter();">
    <input type=button class="button" value="Delete" id="out04del"
     onclick="tempDisable(this);setFormactn('D');">
    <input type=button value="Cancel" class="button"
     onclick="DFrameExit();">

</td></tr>
</table>
</form>

<script type="text/javascript">
if ("%OUTWEB04.04.010" == "R") {
  UpdateForm.rfletchk.checked=true;
}
if ("%OUTWEB04.04.011" != "1") {
  UpdateForm.d_otlet009.checked=true;
}
if(document.UpdateForm.ptcnsmsn.value == "1") {
  document.getElementById('DisplaySMS').style.display="";
  if ("%OUTWEB04.04.013" == "1") {
    UpdateForm.d_otlet010.checked=true;
  }
  SetSMSPaper(UpdateForm);
}
</script>
