<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb05.js"></script>
<script type="text/javascript" src="../js/TheatreScreensHoverInfo.js"></script>
<script type="text/javascript">
function AssignAddForm() {
  if (parent.document.location.href.indexOf("EventUpdate.php")>0) {
    return;
  }
  parent.AddForm.reportno.value=document.AddForm.reportno.value;
  parent.AddForm.template.value=document.AddForm.template.value;
  parent.AddForm.updttype.value=document.AddForm.updttype.value;
  parent.AddForm.opses003.value=document.AddForm.opses003.value;
  parent.AddForm.respnvar.value=document.AddForm.respnvar.value;
  parent.AddForm.startime.value=document.AddForm.startime.value;
  parent.AddForm.endtime.value=document.AddForm.endtime.value;
  parent.AddForm.sesstime.value="";
  parent.AddForm.duration.value=document.AddForm.duration.value;
  parent.AddForm.overrid1.value=document.AddForm.overrid1.value;
  parent.AddForm.overrid2.value=document.AddForm.overrid2.value;
  parent.AddForm.overrid3.value=document.AddForm.overrid3.value;
  parent.AddForm.overrid4.value=document.AddForm.overrid4.value;
  parent.AddForm.overrid5.value=document.AddForm.overrid5.value;
  parent.AddForm.overrid6.value=document.AddForm.overrid6.value;
  parent.AddForm.opses001.value=document.AddForm.opses001.value;
  parent.AddForm.opses002.value=document.AddForm.opses002.value;
  parent.AddForm.opses007.value=document.AddForm.opses007.value;
  parent.AddForm.opses008.value=document.AddForm.opses008.value;
  parent.AddForm.opses009.value=document.AddForm.opses009.value;
  parent.AddForm.opses010.value=document.AddForm.opses010.value;
  parent.AddForm.opses013.value=document.AddForm.opses013.value;
  parent.AddForm.opses011.value=document.AddForm.opses011.value;
  parent.AddForm.opses012.value=document.AddForm.opses012.value;
  parent.AddForm.opses015.value=document.AddForm.opses015.value;
  parent.AddForm.opses014.value=document.AddForm.opses014.value;
  parent.AddForm.opses064.value=document.AddForm.opses064.value;
  parent.AddForm.opses069.value=document.AddForm.opses069.value;
  parent.AddForm.opses070.value=document.AddForm.opses070.value;
  parent.AddForm.opses071.value=document.AddForm.opses071.value;
  parent.AddForm.opses067.value=document.AddForm.opses067.value;
  parent.AddForm.opses068.value=document.AddForm.opses068.value;
  if(document.AddForm.ibcnmhos.value=="1") {
    parent.AddForm.opses074.value=document.AddForm.opses074.value;
  }
}
function GetOpr() {
   selectOptions2(20,AddForm.opses074,AddForm.opses013);
} 
function DeftHosp() {
  if(document.AddForm.ibcnmhos.value=="1") {
    if(isWhitespace(document.AddForm.opses074.value)) {
      for (var i=0; i < document.AddForm.opses074.length; i++) {
        if (document.AddForm.opses074.options[i].value==
            document.AddForm.wbsehosp.value){
            document.AddForm.opses074.selectedIndex=i;
        }
      }
      GetOpr();
    }
  }
}
function Close() {
  if (parent.document.location.href.indexOf("EventUpdate.php")>0) {
    parent.document.location.href="FutureEvents.php?EventTypeID=1000";
  } else {
    DFrameCloseRefresh();
  }
}
function DefaultParent() {
  var defaultValue;
  var el;
  if (parent.document.location.href.indexOf("EventUpdate.php")>0) {
    document.AddForm.nextpage.value="6";
    document.AddForm.redirect.value="FutureEvents.php?EventTypeID=1000";
  }
  if (parent.document.getElementById("StartDate")) {
    defaultValue=parent.document.getElementById("StartDate").value;
    document.AddForm.opses001.value=defaultValue;
  }
  if (parent.document.getElementById("StartTime")) {
    defaultValue=parent.document.getElementById("StartTime").value;
    document.AddForm.opses002.value=defaultValue;
  }
  if (parent.document.getElementById("EndTime")) {
    defaultValue=parent.document.getElementById("EndTime").value;
    document.AddForm.opses007.value=defaultValue;
    CheckOvernight(document.AddForm.opses002,document.AddForm.opses007,document.AddForm.opses008);
  }
  if (parent.document.getElementById("LocationCode")) {
    el=parent.document.getElementById("LocationCode");
    defaultValue=el.options[el.selectedIndex].value;
    el=document.AddForm.opses013;
    for (var i=0;i<el.options.length;i++) {
      if (trim(el.options[i].value)==trim(defaultValue)) {
       el.selectedIndex=i;
      }
    }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DeftHosp();DefaultParent();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
<script type="text/javascript">document.write(self.document.title);</script>
</span>
<div id=PageBodySection style="overflow: auto;">
<form name=AddForm method=post action=oprweb05.pbl style="margin:0">
<input type=hidden name=reportno value="2">
<input type=hidden name=template value="002">
<input type=hidden name=nextpage value="0">
<input type=hidden name=redirect value="">
<input type=hidden name=updttype value="A">
<input type=hidden name=opses003 value="%OPRWEB05.02.001">
<input type=hidden name=respnvar value="">
<input type=hidden name=startime value="">
<input type=hidden name=endtime value="">
<input type=hidden name=duration value="">
<input type=hidden name=overrid1 value="">
<input type=hidden name=overrid2 value="">
<input type=hidden name=overrid3 value="">
<input type=hidden name=overrid4 value="">
<input type=hidden name=overrid5 value="">
<input type=hidden name=overrid6 value="">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=wbsehosp value="%STANDARD.01.032">
<table cellspacing=0 cellpadding=0 border=0 width=100%>
<tr><td align=center class=Heading>
    <b>AdHoc Session for %OPRWEB05.02.002 (%OPRWEB05.02.001)</b></td>
    </tr>
</table>
<table align=center cellspacing=0 cellpadding=1 width=95% border=0>
<tr><td class=DataLabel>Session Date</td>
    <td><input type=text name=opses001 class=Mandatory title="session Date"
        id=opses001
        size=12 maxlength=12 onblur="checkDate(this,'Session Date');">
    <img src=../images/DateLookup.gif class=Icon
     align=absmiddle onclick="DateLookupFrame(opses001);">
    <img src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="AddForm.opses001">
    </td></tr>

<tr><td class=DataLabel>Start Time</td>
    <td><input type=text name=opses002 class=Mandatory title="Start Time"
         size=6 maxlength=6  id=opses002
         onblur="checkTime(this);CheckOvernight(opses002,opses007,opses008);">
        <img src=../images/TimeLookup.gif class=Icon
      onclick="TimeLookupFrame(opses002);">
    </td></tr>

<tr><td class=DataLabel>End Time</td>
    <td><input type=text name=opses007 class=Mandatory title="End Time"
         size=6 maxlength=6  id=opses007
         onblur="checkTime(this);CheckOvernight(opses002,opses007,opses008);">
        <img src=../images/TimeLookup.gif class=Icon
     onclick="TimeLookupFrame(opses007);">
    </td></tr>

<tr><td colspan=2><hr></td></tr>

<tr><td class=DataLabel>Duration (min)</td>
    <td><input type=text name=opses008 class=Readonly title="Duration"
         size=6 maxlength=3 readonly tabindex=-1
         onclick="CheckOvernight(opses002,opses007,opses008);">
    </td></tr>

<tr><td class=DataLabel>Time for Breaks (min)</td>
    <td><input type=text name=opses009 class=Mandatory title="time for Breaks"
         size=6 maxlength=3>
    </td></tr>

<tr><td class=DataLabel>Prep Time per Patient (min)</td>
    <td><input type=text name=opses010 class=Mandatory 
         title="Prep time per Patient" size=6 maxlength=2>
    </td></tr>

<!-- Multi-Hospital Selection List when IBCNMHOS=1 -->
%OPRWEB05.02.179.2

<tr><td class=DataLabel>Operating Room</td>
    <td><select name=opses013 title="Operating Room">
          <option></option>
          %OPRWEB05.02.114.2            
          </select>
    </td></tr>

<tr><td class=DataLabel>Time Period</td>
    <td><select name=opses011 class=Mandatory title="Time Period">
          <option></option>
          %OPRWEB05.02.112.2            
          </select>
    </td></tr>

<tr><td class=DataLabel>Unit</td>
    <td><select name=opses012 class=Mandatory title="Unit">
          <option></option>
          %OPRWEB05.02.007.2            
          </select>
    </td></tr>
 
<tr><td class=DataLabel>Usual Anaesthetist</td>
    <td><input type=text name=opses015 title="Usual Anaesthetist" id=opses015
         size=6 maxlength=6 onblur="validateCode(31,opses015,name_opses015);">
    <input type=text name=name_opses015 title="Usual Anaesthetist"
     size=22 maxlength=30 class=Readonly readonly tabindex=-1
     id=name_opses015>
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="DoctorSearchFrame(opses015,name_opses015);">
    <img src="../images/erase.gif" class=Icon
    onclick="clrDoc(opses015,name_opses015);">
</td></tr>
 
<tr><td class=DataLabel>Session Co-ordinator</td>
    <td><input type=text name=opses014 title="session Co-ordinator" id=opses014
         size=6 maxlength=6 onblur="validateCode(31,opses014,name_opses014);">
    <input type=text name=name_opses014 title="session Co-ordinator"
     id=name_opses014
     size=22 maxlength=30 class=Readonly readonly tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="DoctorSearchFrame(opses014,name_opses014);">
    <img src="../images/erase.gif" class=Icon
    onclick="clrDoc(opses014,name_opses014);">
</td></tr>

<tr><td class=DataLabel>Extra Doctor</td>
    <td><input type=text name=opses064 title="Extra Doctor" id=opses064
         size=6 maxlength=6 onblur="validateCode(31,opses064,name_opses064);">
    <input type=text name=name_opses064 title="Extra Doctor" id=name_opses064
     size=22 maxlength=30 class=Readonly readonly tabindex=-1>
    <img src="../images/SearchIcon.gif" class=Icon
    onclick="DoctorSearchFrame(opses064,name_opses064);">
    <img src="../images/erase.gif" class=Icon
    onclick="clrDoc(opses064,name_opses064);">
</td></tr>

<tr><td class=DataLabel>Number of Days to Lock Session</td>
    <td><input type=text name=opses069 title="Number of Days to Lock Session" 
         class=DataField size=6 maxlength=2 min=0 
         onblur=checkInteger(this,this.title)>
    </td>
</tr>
<tr><td class=DataLabel>Session Type</td>
    <td><select name=opses070 class=Mandatory title="Session Type">
          <option></option>
          %OPRWEB05.02.169.4
          </select>
          <img src="../images/HelpIcon.gif" class="Icon"
               onmouseover='showPopUp(AddAdHoc);'>
    </td>
</tr>
<tr><td class=DataLabel>%STANDARD.01.017.YD</td>
    <td><select name=opses071 class=Mandatory 
         title="%STANDARD.01.017.YD">
          <option></option>
          %OPRWEB05.02.175.4
          </select>
    </td>
</tr>
<tr><td class=DataLabel>Special Instructions 1</td>
    <td><input type=text name=opses067 title="Special Instructions 1" 
         class=DataField size=60>
    </td>
</tr>
<tr><td class=DataLabel>Special Instructions 2</td>
    <td><input type=text name=opses068 title="Special Instructions 2" 
         class=DataField size=60>
    </td>
</tr>

<tr><td colspan=2 align=center>
    <input type=button value="Add" class="button" id="addbutton"
     onclick="tempDisable(this);validateTheatreAvailability();">
    <input type=button value="Close" class="button" onclick='Close();'>
</td></tr>
</table>
</form>
</div>
<script>

function validateTheatreAvailability() {

  //opses013 - Theatre
  //opses001 - Session Date
  //opses002 - Start Time
  //opses007 - End Time

  if (!validateMandatory(document.AddForm)){
    return;
  }

  if (checkTheatreAvailability(document.AddForm.opses013,
                               document.AddForm.opses001.value,
                               document.AddForm.opses002.value,
                               document.AddForm.opses007.value)) {
      AssignAddForm();
      SubmitHidden(AddForm);}
}

</script>

