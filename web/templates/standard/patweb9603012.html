<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/admission.js"></script>
<script type="text/javascript">
function DisplayContract() {
  i=document.pat96cmb.specialt.selectedIndex;
  ind=document.pat96cmb.specialt.options[i].value.substring(14,15)
  if (ind=="C" || ind=="S" || ind=="H") {
    ContractHeading.innerHTML=contracthd.innerHTML;
    ContractType.innerHTML=contracttype.innerHTML;
    Contrac1Heading.innerHTML=contracrhd.innerHTML;
    ContractRole.innerHTML=contractrole.innerHTML;
    Contrac2Heading.innerHTML=contracihd.innerHTML;
    ContractId.innerHTML=contractid.innerHTML;
  } else {
    ContractHeading.innerHTML=blanklabel.innerHTML;
    ContractType.innerHTML="";
    Contrac1Heading.innerHTML=blanklabel.innerHTML;
    ContractRole.innerHTML="";
    Contrac2Heading.innerHTML=blanklabel.innerHTML;
    ContractId.innerHTML="";
  }
  if (ind=="S"||ind=="H") {
     document.pat96cmb.ptasf001.className="Readonly"; 
     document.pat96cmb.ptasf002.className="Readonly"; 
     document.pat96cmb.ptasf001.value="";
     document.pat96cmb.ptasf002.value="";
   } else if (ind=="C") {
     document.pat96cmb.ptasf001.className="Mandatory";
     document.pat96cmb.ptasf002.className="Mandatory";
  }
}
function setTranAdm() {
  if (admitdate==pat96cmb.trandate.value) {
    if (pat96cmb.ptcnchsd.value==1) {
      ans=confirm("Do you want to change the Transfer Admission Record?")
      if (ans) {
        pat96cmb.ctadmvar.value="1"
        pat96cmb.trantime.value=admittime
      }
    }
  }
}
function SubmitCMBS() {
  if (admitdate==pat96cmb.trandate.value) {
    if (admittime>pat96cmb.trantime.value) {
      alert("Change time cannot be before admission time ("+admittime+")");
      return;
    }
  }
  if (admitstat.substr(0,10)=="Discharged") {
    if (disdate==pat96cmb.trandate.value) {
      if (distime<=pat96cmb.trantime.value) {
        alert("Change time cannot be after discharge time ("+distime+")");
        return;
      }
    }
    if (disdate<pat96cmb.trandate.value) {
      alert("Change date cannot be after discharge date");
      return;
    }
  }
  if (validateMandatory(pat96cmb)) {
    var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=12" +
                    "&urnumber="+pat96cmb.urnumber.value.replace(/ /g,"+") +
                    "&admissno="+pat96cmb.admissno.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|");
      if (ReturnValue[0]!=="OK") {
        if (!confirm("Program details have already been completed;\n" +
                     "FIM scores for this episode will no longer be\n" +
                     "linked to the Program " + ReturnValue[1])) {
          return;
        }
      }
      SubmitHidden(pat96cmb);
    }
  }
}
function ValTime(dateField,timeField) {
  if (!checkTime(timeField,timeField.title)) {
    return;
  }
  SetCurrentDateTimeNoFocus(null,pat96cmb.currtime);
  var curDate = pat96cmb.currdate.value;
  var curTime = trim(pat96cmb.currtime.value.replace(/:/g,"")) - 0;
  var newTime = trim(timeField.value.replace(/:/g,"")) - 0;
  if (dateField.value == curDate) {
    if (newTime > curTime) {
      alert("Time is in the future");
      timeField.focus();
    }
  }   
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisplayContract();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB96.03.003";
PatientVIS="%PATWEB96.03.081";
PatientNAM="%PATWEB96.03.002";
PatientSTA="%PATWEB96.03.086.078";
PatientALT="%PATWEB96.03.084";
PatientSEX="%PATWEB96.03.019";
PatientDOB="%PATWEB96.03.020";
PatientAGE="%PATWEB96.03.021";
PatientLOC="%PATWEB96.03.083";
PatientPRI="%PATWEB96.03.086.066.1";
PatientUNT="%PATWEB96.03.066.0";
DoctorCOD="%PATWEB96.03.082.003";
DoctorNAM="%PATWEB96.03.082.002";
PatientAID="%PATWEB96.03.086.090";
PatientIND="%PATWEB96.03.086.091";
PatientCUR="%PATWEB96.03.086.092";
PatientCLC="%PATWEB96.03.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB96.03.086.094";
PatientCDM="%PATWEB96.03.086.095";
PatientVDH="%PATWEB96.03.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form name=pat96cmb style="margin:0" %PATWEB96.03.201.001
 <input type=hidden name=reportno value="9">
 <input type=hidden name=urnumber value="%PATWEB96.03.003">
 <input type=hidden name=admissno value="%PATWEB96.03.081">
 <input type=hidden name=redirect value="%PATWEB96.03.001.patweb96.03.004">
 <input type=hidden name=nextpage value="7">
 <input type=hidden name=trnleave value="0">
 <input type=hidden name=bedstat1>
 <input type=hidden name=warddesc >
 <input type=hidden name=formactn >
 <input type=hidden name=ctadmvar value="0">
 <input type=hidden name=ptcnchsd value="%PATWEB96.03.226">
 <input type=hidden name=currdate value="%STANDARD.01.013">
 <input type=hidden name=currtime value="">

<table border=0 width=100% cellspacing=0 cellpadding=2 >
  <tr><td class=HeadingCell align=center colspan=4 width=100%>
          Bed Transfer &amp; Leave Maintenance</td></tr>

   <tr><td class=HeadingCell align=center colspan=2>Current Status</td>
       <td class=HeadingCell align=center colspan=2>Change %STANDARD.01.017.A 
           </td></tr>

   <tr><td class=DataLabel>Ward / Bed</td>      
       <td><input type=text size=25 readonly value="%PATWEB96.03.105.0">
           <input type=text size=15 readonly value="%PATWEB96.03.106"></td>
       <td class=DataLabel>%STANDARD.01.017.A </td>
       <td><select name=specialt class="Mandatory" title="%STANDARD.01.017.A "
                   onchange="DisplayContract();">
            <option></option>
             %PATWEB96.03.111.2
           </select></td></tr>

   <tr><td class=DataLabel>Transfer In Date &amp; Time</td>
       <td><input type=text size=11 readonly value="%PATWEB96.03.204" >
           <input type=text size=5 readonly value="%PATWEB96.03.205"></td>
       <td class=DataLabel>Date/Time of Change</td>
       <td><select name=trandate id=trandate class=Mandatory
            title="date of change"
            onchange="setTranAdm();">
            %PATWEB96.03.213
           </select>
           <input type=text size=8 name=trantime id=trantime class=Mandatory 
                  title="Time of Change" value="%STANDARD.01.016" 
                  onblur="ValTime(pat96cmb.trandate,pat96cmb.trantime);">
             <img src="../images/DateTimeStamp.gif" class=Icon
                  onclick="SetCurrentDateTime(null,pat96cmb.trantime);">
             <img src="../images/TimeLookup.gif" class=Icon
                  onclick="TimeLookupFrame(pat96cmb.trantime);"></td></tr>

   <tr><td class=DataLabel>Attending Doctor</td>
       <td><input type=text size=35 readonly value="%PATWEB96.03.108.002"></td>
       <td class=DataLabel><div id=Contrac2Heading></div></td>
       <td><div id=ContractId></div></td></tr>

   <tr><td class=DataLabel>%STANDARD.01.017.A </td>
       <td><input type=text readonly size=30 value="%PATWEB96.03.111.0"></td>
       <td class=DataLabel><div id=ContractHeading></div></td>
       <td><div id=ContractType></div></td></tr>

   <tr><td class=DataLabel>%STANDARD.01.017.CC</td>
       <td><input type=text readonly size=30 value="%PATWEB96.03.113.0"></td>
       <td class=DataLabel><div id=Contrac1Heading></div></td>
       <td><div id=ContractRole></div></td></tr>

   <tr><td class=DataLabel>%STANDARD.01.017.AC</td>
       <td><input type=text readonly size=30 value="%PATWEB96.03.124.0"></td>
       <td align=center colspan=2>
           <input type=button name=formactn value=Update class="button"
                  id='updatebutton'
                  onclick="tempDisable(this);SubmitCMBS();">
           <input type=button value=Cancel class="button"
                  onclick="PatientLinkTo('patweb96.pbl',3,4,0);"></td></tr>

   <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
       <td><input type=text readonly
                  value="%PATWEB96.03.126.0"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td class=DataLabel>Health Fund</td>
       <td><input type="hidden" value="%PATWEB96.03.114.0">
           <input type=text size=35 name="funddesc" maxlength="30" readonly
                  value="%PATWEB96.03.114.1"></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td class=DataLabel>Table</td>
       <td><input type="hidden" value="%PATWEB96.03.115.0">
           <input type="text" size=20 maxlength=30 name="tabldesc" readonly
                  value="%PATWEB96.03.115.1"></td>
       <td colspan=2>&nbsp;</td></tr>
</table>
</form>
</div>

<script type="text/javascript">
  admitdate="%PATWEB96.03.217"
  admittime="%PATWEB96.03.103"
  disdate="%PATWEB96.03.218"
  distime="%PATWEB96.03.302"
  admitstat="%PATWEB96.03.104"
  if (admitstat.substr(0,10)=="Discharged") {
    pat96cmb.redirect.value="%PATWEB96.03.001.patweb96.03.013"
  }
</script>

<span id=blanklabel style="display:none">&nbsp;</span>

<span id=contracthd style="display:none">Contract Type</span>

<span id=contracttype style="display:none">
  <input type="text" name=ptasf001 size=2 maxlength=1 class=Mandatory
         value="%PATWEB96.03.199.001" title="Contract Type"
         onblur="ContType(this);">
    <img src="../images/SearchIcon.gif" class=Icon
         onclick="ContTypeAlert();">
</span>

<span id=contracrhd style="display:none">Contract Role</span>

<span id=contractrole style="display:none">
  <input type="text" name=ptasf002 size=2 maxlength=1 class=Mandatory
         value="%PATWEB96.03.199.002" title="Contract Role"
         onblur="ContRole(this);">
    <img src="../images/SearchIcon.gif" class=Icon
         onclick="ContRoleAlert();">
</span>

<span id=contracihd style="display:none">Contract Id</span>

<span id=contractid style="display:none">
  <select name=ptasf003 title="Contract Spoke Id" class=Mandatory>
   <option> </option>
    %PATWEB96.03.199.003
  </select>
</span>

<form name=PatientLinks method=get>
 <input type=hidden name=reportno value=1>
 <input type=hidden name=template value=004>
 <input type=hidden name=urnumber value="%PATWEB96.03.003">
 <input type=hidden name=admissno value="%PATWEB96.03.081">
 <input type=hidden name=MenuType value="%PATWEB96.03.088">
 <input type=hidden name=alert001 value="">
</form>
