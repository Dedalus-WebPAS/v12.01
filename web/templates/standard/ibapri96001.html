<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function init() {
  ReportShowSpan();
  document.ReportForm.schddate.focus();
}
function ProcessReport() {
  p=document.ReportForm;
  if (validateMandatory(p)) {
    if(((p.keystr02.value==1)&&(p.prcnauda.value==1)) ||
       ((p.keystr02.value==2)&&(p.prcnaudb.value==1)) ||
       ((p.keystr02.value==3)&&(p.prcnaudc.value==1)) ||
       ((p.keystr02.value==4)&&(p.prcnaudd.value==1)) ||
       ((p.keystr02.value==5)&&(p.prcnaude.value==1)) ||
       ((p.keystr02.value==6)&&(p.prcnaudf.value==1)) ||
       ((p.keystr02.value==7)&&(p.prcnaudg.value==1)) ||
       ((p.keystr02.value==8)&&(p.prcnaudh.value==1)) ||
       ((p.keystr02.value==9)&&(p.prcnaudi.value==1))){
       alert("This Audit file is not available.");
       p.keystr02.focus();
       return;
    }
    if (p.keystr01.value==1) {
      if ((!isWhitespace(p.begdate.value)) &&
          (!isWhitespace(p.enddate.value)) &&
          (!CheckDateRange(p.begdate,p.enddate))) {
        p.begdate.focus();
        return;
      }
      if (!validateAuditFile(p.keystr02,p.begdate,
                             p.enddate)) {
        return;
      }
      p.keystr03.value=p.begdate.value;
      p.keystr03.title=p.begdate.title;
      p.keystr04.value=p.enddate.value;
      p.keystr04.title=p.enddate.title;
      p.keystr05.value="Y";
    }
    else {
      p.keystr03.value=p.clearopt.value;
    }
    SubmitReport(p); 
  }
}
function validateAuditFile(option,fromdate,todate) {
  if (isWhitespace(option.value)) return true;;
  if (parseInt(option.value)>=10) {
    var serverURL   = "../cgi-bin/rshweb02.pbl?reportno=10" +
                      "&valdoptn=" + option.value.replace(/ /g,"+") 
  }
  else {
    var tempfrdt=SetDateYYYYMMDD(fromdate.value);
    var temptodt=SetDateYYYYMMDD(todate.value);
    var serverURL   = "../cgi-bin/rshweb02.pbl?reportno=10" +
                      "&valdoptn=" + option.value.replace(/ /g,"+") +
                      "&valdfrdt=" + tempfrdt.replace(/ /g,"+") +
                      "&valdtodt=" + temptodt.replace(/ /g,"+")
  }
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    return true;
  }
  else {
    option.focus();
    return false;
  }
}
function ReportShowSpan() {
  p=document.ReportForm;
  i=p.keystr01.selectedIndex;
  if (p.keystr01.options[i].value==1) {
    document.getElementById('reportOption').innerHTML=document.getElementById('PrintOption').innerHTML;
  }
  else {                                         
    document.getElementById('reportOption').innerHTML=document.getElementById('ClearOption').innerHTML;
 }
}
function checkOption() {
  p=document.ReportForm;
  if (p.keystr01.value==2) {
    return;
  }
  if (parseInt(p.keystr02.value)>=10) {
    p.begdate.className="Readonly";
    p.enddate.className="Readonly";
    p.begdate.readOnly=true;
    p.enddate.readOnly=true;
  }
  else {
    p.begdate.className="";
    p.enddate.className="";
    p.begdate.readOnly=false;
    p.enddate.readOnly=false;
  }
}
</script>
</head>
<body onload="PageLoad(event);ReportLoad();">
%START.OF.PAGE
<form name=ReportForm method=post action=rshweb02.pbl style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=001>
<input type=hidden name=updttype value="A">
<input type=hidden name=setdfprg value="IBAPRI96">
<input type=hidden name=setdfrep value="01">
<input type=hidden name=schdpgid value="IBAPRI96">    
<input type=hidden name=schddesc value="Audit Reports">    
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=1">
<input type=hidden name=prcnauda value="%RSHWEB02.01.140">
<input type=hidden name=prcnaudb value="%RSHWEB02.01.141">
<input type=hidden name=prcnaudc value="%RSHWEB02.01.142">
<input type=hidden name=prcnaudd value="%RSHWEB02.01.143">
<input type=hidden name=prcnaude value="%RSHWEB02.01.144">
<input type=hidden name=prcnaudf value="%RSHWEB02.01.145">
<input type=hidden name=prcnaudg value="%RSHWEB02.01.146">
<input type=hidden name=prcnaudh value="%RSHWEB02.01.147">
<input type=hidden name=prcnaudi value="%RSHWEB02.01.148">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>Audit Reports</td></tr>
</table>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>

<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text name=schddate size=12 title="Schedule Date"
    value="%STANDARD.01.015"
    onblur="checkDate(this,'Schedule Date');">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schddate">
    Time
    <input type=text name=schdtime size=12 title="Schedule Time"
    value="%STANDARD.01.016">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schddate" time="ReportForm.schdtime">
    <img notab src="../images/TimeLookup.gif" class="Icon" 
     alt="Time Select" time="ReportForm.schdtime">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><select name=schdprnt title="Printer" class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBAPRI96.01
        </select></td></tr>
 
<tr><td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy title='Number of Copies' class=Mandatory>
        </select>
    </td></tr>
 
<tr><td class=DataLabel>Schedule Type</td>
    <td class=DataLabel colspan=3>
    <select name=schdrdat title="Schedule Type" onchange="SetReportDates();">
    <option></option>
    </select></td></tr>

<tr><td class=DataLabel>Schedule Until Date</td>
    <td class=DataLabel colspan=3>
    <input type=text name=schdrend size=12
     onblur="checkDate(this,'Schedule Until Date');">  
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schdrend">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schdrend">
    </td></tr>

<tr><td colspan=2 align=center><hr width=80%></td></tr>

<tr><td class=DataLabel>Report Option</td>
    <td><select name=keystr01 title="Report Option" class=Mandatory
                onchange="ReportShowSpan();">
        <option value=1>Print Audit</option>
        <option value=2>Clear Audit</option>
        </select></td></tr>

<tr><td class=DataLabel>Audit Type</td>
    <td><select name=keystr02 title="Audit Type"
                onchange="checkOption();">
        <option value=" ">All                              </option>
        <option value="1">Audit A (Not Used)               </option>
        <option value="2">Audit B (Not Used)               </option>
        <option value="3">Doctor Audit File                </option>
<!--
        <option value="4">Debtors Audit File               </option>
-->
        <option value="4">Audit D (Not Used)               </option>
        <option value="5">Medical Practice Audit File      </option>
        <option value="6">Audit F (Not Used)               </option>
        <option value="7">Spec. Path. Tests Audit File     </option>
        <option value="8">Exception Charging Audit File    </option>
        <option value="9">Item Audit File                  </option>
        <option value="10">Cash Deposit Audit File         </option>
        <option value="11">Cash Deposit Invoiced Audit File</option>
        <option value="12">Deposits Refunded Audit File    </option>
        </select> </td></tr>

</table>


<span id=reportOption></span>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
    <input type=hidden name=keystr03 value="">           
    <input type=hidden name=keystr04 value="">           
    <input type=hidden name=keystr05 value="">           
    <input type=hidden name=keystr06 value="">           
    <input type=hidden name=keystr07 value="">           

<tr><td align=center colspan=2><br>
    <input type=button value=Ok class="button" onclick='ProcessReport();'>
    <input type=button value=Cancel class="button" 
     onclick='location.href="../lookups/blank.html"' >
    </td></tr>
</table>
</form>

<span id=ClearOption style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Clear Options</td>
    <td><select name=clearopt class=Mandatory>
        <option value=" ">                    </option>
        <option value="P">Only Printed records</option>
        <option value="A">All records         </option>
        </select></td></tr>
</table>
</span>

<span id=PrintOption style="display:none">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>From Date</td>
    <td><input type=text size=15 maxlength=12 name=begdate 
    onblur="checkDate(this,'From Date')" title="From Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.begdate">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.begdate">
    To
    <input type=text size=15 maxlength=12 name=enddate
    onblur="checkDate(this,'To Date')" title="To Date">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.enddate">
    <img notab src="../images/DateLookup.gif" class="Icon"
     alt="Calendar" date="ReportForm.enddate">
    </td></tr>
</table>
</span>

