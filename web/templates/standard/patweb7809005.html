<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">

<script type="text/javascript">
function PrintThisPage()
{
  SaveHeight=PageBodySection.style.height
  PageBodySection.style.height="auto"
  SaveOverflowy=PageBodySection.style.overflowY;
  PageBodySection.style.overflowY="hidden";
  PageBodySection.style.overflowX="hidden";
  print();
  PageBodySection.style.height=SaveHeight;
  PageBodySection.style.overflowY=SaveOverflowy;
}
function mandatoryItemCode(ItemCode,ServiceQuantity) {

  if(!isWhitespace(ItemCode.value)) {
    ServiceQuantity.className="Mandatory Integer";
  } else {
    ServiceQuantity.className="Integer";
  }

}
function validateOECMiscServices() {
validateMisc(document.UpdateForm.ptelf023, document.UpdateForm.d_ptelf023,
             document.UpdateForm.multhosp);
validateMisc(document.UpdateForm.ptelf024,document.UpdateForm.d_ptelf024,
             document.UpdateForm.multhosp);
validateMisc(document.UpdateForm.ptelf025,document.UpdateForm.d_ptelf025,
             document.UpdateForm.multhosp);
validateMisc(document.UpdateForm.ptelf026,document.UpdateForm.d_ptelf026,
             document.UpdateForm.multhosp);
validateMisc(document.UpdateForm.ptelf027,document.UpdateForm.d_ptelf027,
             document.UpdateForm.multhosp);

}
function submitFFOECRequest() {

  if (document.getElementById('ptelf011').value.substr(3,1)=='1' &&
      document.getElementById('ptelf012').value <= 0) {
    alert('Planned Length of Stay must be more than 0 for Overnight Patient.');
    return;
  }

  if (document.getElementById('ptelf011').value.substr(3,1)=='2' &&
      document.getElementById('ptelf012').value != 0) {
    alert('Planned Length of Stay must be 0 for Same Day Patient.');
    return;
  }

  if (validateMandatory(UpdateForm)) {UpdateForm.submit();}
}
function HealthFundSearchFrameNoFocusFunc(ReturnCode,ReturnName,
                                      ReturnTCode,ReturnTName,ReturnFunc){
  window.ReturnHFTNoFocus=""; // Var to set no focus on UpdateParent()
  HealthFundSearchFrame(ReturnCode,ReturnName,ReturnTCode,
                        ReturnTName,ReturnFunc);
}
function enableOECNewReq() {
  if (isWhitespace(UpdateForm.ptelf019.value)) {return;}

  var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=61" +
                    "&valdcode=" + UpdateForm.ptelf019.value.replace(/ /g,"+");
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    if (returnValue.return_value != "1") {
      document.getElementById('RequestButton').disabled=true;
      alert('Health Fund/Participant is not enabled for OEC.');
    } else {
      document.getElementById('RequestButton').disabled=false;
    }
  }
}
</script>
</head>
%START.OF.PAGE

<body onload="PageLoad(event);defaultPresentingIllness();switchPresIll();
              validateOECMiscServices();enableOECNewReq();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
<img src="../images/PrinterIcon.gif" class=MenuIcon alt="Print"
Onclick="PrintThisPage();" align ="right">
Free Format OEC Details
</span>
<div id=PageBodySection>
<form name=UpdateForm method=post action=patweb78.pbl style="margin:0">
<input type=hidden name=reportno value="9">
<input type=hidden name=template value="005">
<input type=hidden name=updttype value="A">
<input type=hidden name=redirect value="">
<input type=hidden name=urnumber value="%PATWEB78.09.008">
<input type=hidden name=elgnumbr value="%PATWEB78.09.007">
<input type=hidden name=ptelf001 value="%PATWEB78.09.008">
<input type=hidden name=ptelf003 value="%PATWEB78.09.051">
<input type=hidden name=ptelf004 value="%PATWEB78.09.053">
<input type=hidden name=ptelf005 value="%PATWEB78.09.052">
<input type=hidden name=ptelf008 value="%PATWEB78.09.060">
<input type=hidden name=ptelf009 value="%PATWEB78.09.054">
<input type=hidden name=multhosp value="">
<input type=hidden name=resuboec value="1">
<input type=hidden name=ptelf035 value="%PATWEB78.09.064">
<input type=hidden name=ptelf036 value="%PATWEB78.09.065">
<input type=hidden name=ptelf037 value="%PATWEB78.09.066">
<input type=hidden name=currdate value="%STANDARD.01.015">

<table align=center width=95% border=0 cellpadding=1>
<tr>
  <td class=DataLabel>
    Admission Date
  </td>
  <td>
    <input type="text" size="12" name=ptelf010 class=Mandatory
     value="%PATWEB78.09.010"
     title="Admission Date" onblur="checkDate(this,'Admission Date')">
    <img src=../images/DateLookup.gif border=0 hspace=4
     align=absmiddle onclick="DateLookupFrame(document.UpdateForm.ptelf010);">
    <img src=../images/DateTimeStamp.gif border=0 hspace=4
     align=absmiddle onclick="SetCurrentDateTime(document.UpdateForm.ptelf010,null);">
    <img src="../images/erase.gif" align=absmiddle hspace=0
     onclick="clrFields(document.UpdateForm.ptelf010);
                        document.UpdateForm.ptelf010.focus();">
  </td>
</tr>

<tr>
  <td class=DataLabel>
    %STANDARD.01.017.VI
  </td>
  <td>
    <select name="ptelf011"
     id="ptelf011" title="%STANDARD.01.017.VI" class="Mandatory">
      <option> </option>
      %PATWEB78.09.011.2
    </select>
  </td>
</tr>

<tr>
  <td class=DataLabel>
    Planned Length of Stay
  </td>
  <td>
    <input type="text" size="5" maxlength="5" name="ptelf012"
     id="ptelf012" value="%PATWEB78.09.012"
     title="Planned Length of Stay" class="Integer Mandatory"
     onblur="checkInteger(this,this.value);">
  </td>
</tr>

<tr>
  <td class=DataLabel>
    PEA Indicator
  </td>
  <td>
    <select name=ptelf014 title="PEA Indicator" class="Mandatory">
      <option value=0>No</option>
      <option value=1>Yes</option>
      <option value=2>Query</option>
    </select>
  </td>
</tr>

<tr>
  <td class=DataLabel>
    Emergency Admission
  </td>
  <td>
    <select name=ptelf015 title="Emergency Admission" class="Mandatory">
      <option value=0>No</option>
      <option value=1>Yes</option>
    </select>
  </td>
</tr>

<tr>
  <td class=DataLabel>
    <div id=PresIllCodHdr></div>
  </td>
  <td>
    <div id=PresIllCod></div>
  </td>
  <td align=left colspan=3>
    <input type="checkbox" name="presilsw" value="1"
     title="Presenting Illness MBS"
     onclick="switchPresIll();">
    <b>Switch to MBS Presenting Illness Number &nbsp;</b>
  </td>
</tr>

<tr>
  <td class=DataLabel>
    %STANDARD.01.017.CL
  </td>
  <td>
    <select name="ptelf018" title="%STANDARD.01.017.CL" class="Mandatory"
     onchange="getDVA();">
      <option> </option>
      %PATWEB78.09.018.2
    </select>
  </td>
</tr>

<tr>
  <td class=DataLabel>
    Health Fund
  </td>
  <td class=DataLabel colspan=3>
    <input type="hidden" name="ptelf019" value="%PATWEB78.09.063">
    <input type=text size=35 name="funddesc" maxlength="30"
     readonly class="Mandatory" value="%PATWEB78.09.019" title="Health Fund">
    &nbsp;Level&nbsp;
    <input type="hidden" name="ptelf020" value="%PATWEB78.09.020">
    <input type="text" size=20 maxlength=30 name="tabldesc"
     readonly class="Mandatory" value="%PATWEB78.09.020" 
     title="Health Fund Table">
    <img src=../images/SearchIcon.gif border=0 hspace=0 align=absmiddle
     name="HealthFundIMG"
     onclick="HealthFundSearchFrameNoFocusFunc(document.UpdateForm.ptelf019,
                                               document.UpdateForm.funddesc,
                                               document.UpdateForm.ptelf020,
                                               document.UpdateForm.tabldesc,
                                               enableOECNewReq);">
    <img src="../images/erase.gif" align=absmiddle name="eraseimg"
     onclick="clrFields(document.UpdateForm.ptelf019,
                        document.UpdateForm.funddesc,
                        document.UpdateForm.ptelf020,
                        document.UpdateForm.tabldesc);">
  </td>
</tr>

<tr>
  <td class=DataLabel>
    Member Number
  </td>
  <td>
    <input type=text size=12 maxlength=10 name=ptelf021
     class="Mandatory" title="Member Number" value="%PATWEB78.09.021">
  </td>
</tr>

<tr>
  <td class=DataLabel>
     Diagnosis
  </td>
  <td>
     <input type=text name="ptelf022" size=50 maxlength=50
      title="Diagnosis" class="Mandatory" value="%PATWEB78.09.022">
  </td>
</tr>

<tr><td class=DataLabel colspan=4><hr></td></tr>

      <tr>
        <td>
          Misc Charge Code 1
        </td>
        <td colspan=2 nowrap>
          <input type=text name=ptelf023 title="Item Code" size=9 maxlength=9
            value="%PATWEB78.09.023"
           onblur="validateMisc(document.UpdateForm.ptelf023,
                                document.UpdateForm.d_ptelf023,
                                document.UpdateForm.multhosp);
                   mandatoryItemCode(this,document.UpdateForm.ptelf028);
                   document.UpdateForm.ptelf028.value=1;
                   justifyRight(document.UpdateForm.ptelf028);
          ">
          <input type=text name=d_ptelf023 size=50 readonly
           class=Readonly tabindex=-1 title="Item Description">
          <img src="../images/SearchIcon.gif"
           onclick="MiscChargeSearchFrame(document.UpdateForm.ptelf023,
                                          document.UpdateForm.d_ptelf023);">
          <img src="../images/erase.gif"
           onclick="clrFields(document.UpdateForm.ptelf023,
                              document.UpdateForm.d_ptelf023,
                              document.UpdateForm.ptelf028);
                    mandatoryItemCode(document.UpdateForm.ptelf023,
                                      document.UpdateForm.ptelf028);
          ">
        </td>
        <td>
          No. of Items
          <input type=text name=ptelf028 title="Quantity" size=5 maxlength=3
            value="%PATWEB78.09.024"
            onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
        </td>
      </tr>

      <tr>
        <td>
          Misc Charge Code 2
        </td>
        <td colspan=2>
          <input type=text name=ptelf024 title="Item Code" size=9 maxlength=9
           value="%PATWEB78.09.025"
           onblur="validateMisc(document.UpdateForm.ptelf024,
                                document.UpdateForm.d_ptelf024,
                                document.UpdateForm.multhosp);
                   mandatoryItemCode(this,document.UpdateForm.ptelf029);
                   document.UpdateForm.ptelf029.value=1;
                   justifyRight(document.UpdateForm.ptelf029);
          ">
          <input type=text name=d_ptelf024 size=50 readonly
           class=Readonly tabindex=-1 title="Item Description">
          <img src="../images/SearchIcon.gif"
           onclick="MiscChargeSearchFrame(document.UpdateForm.ptelf024,
                                          document.UpdateForm.d_ptelf024);">
          <img src="../images/erase.gif"
           onclick="clrFields(document.UpdateForm.ptelf024,
                              document.UpdateForm.d_ptelf024,
                              document.UpdateForm.ptelf029);
                    mandatoryItemCode(document.UpdateForm.ptelf024,
                                      document.UpdateForm.ptelf029);
          ">
        </td>
        <td>
          No. of Items
          <input type=text name=ptelf029 title="Quantity" size=5 maxlength=3
            value="%PATWEB78.09.026"
            onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
        </td>
      </tr>

      <tr>
        <td>
          Misc Charge Code 3
        </td>
        <td colspan=2>
          <input type=text name=ptelf025 title="Item Code" size=9 maxlength=9
           value="%PATWEB78.09.027"
           onblur="validateMisc(document.UpdateForm.ptelf025,
                                document.UpdateForm.d_ptelf025,
                                document.UpdateForm.multhosp);
                   mandatoryItemCode(this,document.UpdateForm.ptelf030);
                   document.UpdateForm.ptelf030.value=1;
                   justifyRight(document.UpdateForm.ptelf030);
          ">
          <input type=text name=d_ptelf025 size=50 readonly
           class=Readonly tabindex=-1 title="Item Description">
          <img src="../images/SearchIcon.gif"
           onclick="MiscChargeSearchFrame(document.UpdateForm.ptelf025,
                                          document.UpdateForm.d_ptelf025);">
          <img src="../images/erase.gif"
           onclick="clrFields(document.UpdateForm.ptelf025,
                              document.UpdateForm.d_ptelf025,
                              document.UpdateForm.ptelf030);
                    mandatoryItemCode(document.UpdateForm.ptelf025,
                                      document.UpdateForm.ptelf030);
          ">
        </td>
        <td>
          No. of Items
          <input type=text name=ptelf030 title="Quantity" size=5 maxlength=3
           value="%PATWEB78.09.028"
            onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
        </td>
      </tr>

      <tr>
        <td>
          Misc Charge Code 4
        </td>
        <td colspan=2>
          <input type=text name=ptelf026 title="Item Code" size=9 maxlength=9
           value="%PATWEB78.09.029"
           onblur="validateMisc(document.UpdateForm.ptelf026,
                                document.UpdateForm.d_ptelf026,
                                document.UpdateForm.multhosp);
                   mandatoryItemCode(this,document.UpdateForm.ptelf031);
                   document.UpdateForm.ptelf031.value=1;
                   justifyRight(document.UpdateForm.ptelf031);
          ">
          <input type=text name=d_ptelf026 size=50 readonly
           class=Readonly tabindex=-1 title="Item Description">
          <img src="../images/SearchIcon.gif"
           onclick="MiscChargeSearchFrame(document.UpdateForm.ptelf026,
                                          document.UpdateForm.d_ptelf026);">
          <img src="../images/erase.gif"
           onclick="clrFields(document.UpdateForm.ptelf026,
                              document.UpdateForm.d_ptelf026,
                              document.UpdateForm.ptelf031);
                    mandatoryItemCode(document.UpdateForm.ptelf026,
                                      document.UpdateForm.ptelf031);
          ">
        </td>
        <td>
          No. of Items
          <input type=text name=ptelf031 title="Quantity" size=5 maxlength=3
           value="%PATWEB78.09.030"
            onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
        </td>
      </tr>

      <tr>
        <td>
          Misc Charge Code 5
        </td>
        <td colspan=2>
          <input type=text name=ptelf027 title="Item Code" size=9 maxlength=9
           value="%PATWEB78.09.031"
           onblur="validateMisc(document.UpdateForm.ptelf027,
                                document.UpdateForm.d_ptelf027,
                                document.UpdateForm.multhosp);
                   mandatoryItemCode(this,document.UpdateForm.ptelf032);
                   document.UpdateForm.ptelf032.value=1;
                   justifyRight(document.UpdateForm.ptelf032);
          ">
          <input type=text name=d_ptelf027 size=50 readonly
           class=Readonly tabindex=-1 title="Item Description">
          <img src="../images/SearchIcon.gif"
           onclick="MiscChargeSearchFrame(document.UpdateForm.ptelf027,
                                          document.UpdateForm.d_ptelf027);">
          <img src="../images/erase.gif"
           onclick="clrFields(document.UpdateForm.ptelf027,
                              document.UpdateForm.d_ptelf027,
                              document.UpdateForm.ptelf032);
                    mandatoryItemCode(document.UpdateForm.ptelf027,
                                      document.UpdateForm.ptelf032);
          ">
        </td>
        <td>
          No. of Items
          <input type=text name=ptelf032 title="Quantity" size=5 maxlength=3
           value="%PATWEB78.09.032"
            onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
        </td>
      </tr>

</table>
<table align=center width=95% border=0 cellpadding=1>
<tr>
    <td align=center>
      <input type=button value="New Request" class="button"
       name="RequestButton" id="RequestButton"
       onclick="tempDisable(this);submitFFOECRequest();">
      <input type=button value=Close class="button"
             onclick="DFrameCloseRefresh()">
    </td></tr>
</table>
</form>
</div>

<span id=presillcodhdr style="display:none">
 Presenting Illness Code
</span>

<span id=presillnumhdr style="display:none">
 Presenting Illness Number (MBS)
</span>

<span id=presillcod style="display:none">
  <select name=ptelf016 title="Presenting Illness" class="Mandatory">
  <option value=" "></option>
    %PATWEB78.09.016.2
  </select>
<input type=hidden name=ptelf017 value=" ">
</span>

<span id=presillnum style="display:none">
  <input type=text name=ptelf017 size=10 maxlength=9
   onblur='validateCode(4,document.UpdateForm.ptelf017,
                          document.UpdateForm.mbsdesc1)' class="Mandatory"
   title="Presenting Illness" value="%PATWEB78.09.017">
  <input type=text notab readonly name=mbsdesc1 size=35 class="Readonly">
  <img notab src="../images/SearchIcon.gif"
   onclick="MbsSearchFrame(document.UpdateForm.ptelf017,
                           document.UpdateForm.mbsdesc1,
                           document.UpdateForm.currdate)" name=mbsserch>
  <img src="../images/erase.gif" align=absmiddle
   onclick="clrFields(document.UpdateForm.ptelf017,
                      document.UpdateForm.mbsdesc1);" name=erasembs>
  <input type=hidden name=ptelf016 value=" ">
</span>

<script type="text/javascript">

PEAIndicator = "%PATWEB78.09.061";
for (var i =0 ; i < document.UpdateForm.ptelf014.length; i++) {
  if (PEAIndicator == document.UpdateForm.ptelf014.options[i].value){
    document.UpdateForm.ptelf014.selectedIndex=i;
  }
} 

EmergencyAdmission = "%PATWEB78.09.062";
for (var i =0 ; i < document.UpdateForm.ptelf015.length; i++) {
  if (EmergencyAdmission == document.UpdateForm.ptelf015.options[i].value){
    document.UpdateForm.ptelf015.selectedIndex=i;
  }
}

function defaultPresentingIllness() {

  PresentingIllnessNumber = "%PATWEB78.09.017";

  if (!isWhitespace(PresentingIllnessNumber)) {
    document.UpdateForm.presilsw.checked=true;
  }

}

function switchPresIll() {
  if (document.UpdateForm.presilsw.checked==true) {
    PresIllCodHdr.innerHTML=presillnumhdr.innerHTML;
    PresIllCod.innerHTML=presillnum.innerHTML;
    validateCode(4,document.UpdateForm.ptelf017,document.UpdateForm.mbsdesc1);
  } else {
    PresIllCodHdr.innerHTML=presillcodhdr.innerHTML;
    PresIllCod.innerHTML=presillcod.innerHTML;
  }

}

</script>
