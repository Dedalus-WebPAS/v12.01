<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true"> 
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
function UpdateMessage(ur,adate,atime,atype,vis) {
   linkurl="outweb09.pbl?reportno=02&template=003" +
           "&urnumber=" + ur.replace(/ /g,"+") +
           "&admissno=" + vis.replace(/ /g,"+") +
           "&otdan001=" + ur.replace(/ /g,"+") +
           "&otdan002=" + adate.replace(/ /g,"+") +
           "&otdan003=" + atime.replace(/ /g,"+") +
           "&otdan004=" + atype.replace(/ /g,"+") +
           "&otdan005=" + vis.replace(/ /g,"+") ;
   Left=(document.body.clientWidth-650)/2
   DFrameLink(linkurl,50,Left,650,400)
}
function AddMessage(ur,vis) {
   linkurl="outweb09.pbl?reportno=02&template=002" +
           "&urnumber=" + ur.replace(/ /g,"+") +
           "&admissno=" + vis.replace(/ /g,"+");
   Left=(document.body.clientWidth-650)/2
   DFrameLink(linkurl,50,Left,650,400)
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link                   
//---------------------------------------------------------------------------
function InitTable(TableView) {
 document.title="Appointment Message List";
 switch (TableView) {
 case 0: {
  t = new Table(1,0,2,"100%","center",30,40);
  t.addColumn("Action Date","DateTime",2,2,"left","MaintenanceIcon.gif","0",150)
  t.addColumn("Message","String",7,7,"left","","",150)
  t.addColumn("Requestor","String",11,11,"left","","",100)
  t.addColumn("Completed","String",9,9,"left","","",70)
  t.addColumn("Outcome","String",10,10,"left","","",70)
  t.addColumn("Created By","String",6,6,"left","","",70)
  AddTableRows()
  TableOutput(0,1);    // Order Column,Asc Dsc
  break; }
 }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);">
<div id=HeadingSection>
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Appointment Message List - %OUTWEB09.02.002 - Visit - %OUTWEB09.02.081
</span>
<table width=100% cellspacing=0 cellpadding=0>
<tr><td>&nbsp;</td>
    <td align=right>
    <span id=ShowAddButton style="display: none">
     <input type=button class="button" value="New Message"
     onclick="AddMessage('%OUTWEB09.02.003','%OUTWEB09.02.081');">
    </span>
    </td></tr>
</table>
</div>

<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows() {
%OUTWEB09.02.212
}
//
OPDUser="%STANDARD.01.037.3"
if(OPDUser.substr(3,1)=="O") {
  ShowAddButton.style.display="";
} else {
  ShowAddButton.style.display="none";
}
</script>
