<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<style type="text/css">
html, body {
  height: 100%;
  overflow: none;
}
body {
  padding: 0;
  margin: 0;
}
#silverlightControlHost {
  height: 480px;
  background-color:#efefef;
}
</style>
<script type="text/javascript" src="../js/silverlight/snapWebCam/Silverlight.js"></script>
<script type="text/javascript">
function onSilverlightError(sender, args) {
var appSource = "";
if (sender != null && sender != 0) {
  appSource = sender.getHost().Source;
}
var errorType = args.ErrorType;
var iErrorCode = args.ErrorCode;
if (errorType == "ImageError" || errorType == "MediaError") {
  return;
}
var errMsg = "Unhandled Error in Silverlight Application " +  appSource + "\n" ;
    errMsg += "Code: "+ iErrorCode + "    \n";
    errMsg += "Category: " + errorType + "       \n";
    errMsg += "Message: " + args.ErrorMessage + "     \n";

if (errorType == "ParserError") {
   errMsg += "File: " + args.xamlFile + "     \n";
   errMsg += "Line: " + args.lineNumber + "     \n";
   errMsg += "Position: " + args.charPosition + "     \n";
}
else if (errorType == "RuntimeError") {           
  if (args.lineNumber != 0) {
     errMsg += "Line: " + args.lineNumber + "     \n";
     errMsg += "Position: " +  args.charPosition + "     \n";
     }
    errMsg += "MethodName: " + args.methodName + "     \n";
  }
throw new Error(errMsg);
}
function closeFrameAndRefresh() {
   DFrameExitRefresh();
}
function getParameters() {
  var slc = document.getElementById("silverlightControlHost");
  OS="<object data='data:application/x-silverlight-2,' "+
     "type='application/x-silverlight-2' width='100%' height='95%'>"+
     "<param name='source' value='../js/silverlight/snapWebCam/SilverlightDemo.xap' ></param>"+
     "<param name='onError' value='onSilverlightError' ></param>"+
     "<param name='background' value='white' ></param>"+
     "<param name='windowless' value='true'> </param>"+
     "<param name='minRuntimeVersion' value='4.0.50401.0'></param>"+
     "<param name='autoUpgrade' value='true'></param>"+
     "<param id='parameters' name='InitParams' value='updttype=P,"+
     " urnumber="+document.PatientLinks.urnumber.value.replace(/ /g,"+")+","+
     " admissno="+document.PatientLinks.admissno.value.replace(/ /g,"+")+","+
     " reportno=1, server=cliweb08.pbl, template=040,"+
     " jscallback=closeFrameAndRefresh'></param>"+
     "<p>You need to install Microsoft Silverlight to view this content. "+
     "<a href='http://go.microsoft.com/fwlink/?LinkID=149156&v=4.0.50401.0' "+
     "style='text-decoration:none;'>Get Silverlight!<br />"+
     "<img src='http://go.microsoft.com/fwlink/?LinkID=108181' "+
     "     alt='Get Microsoft Silverlight' "+
     "     style='border-style:none;' /></a></p></object>";
  slc.innerHTML=OS;
}
</script>
%START.OF.PAGE
<body onload="PageLoad(event);getParameters();">                            
<span class=DFrameTitleBar>
  <img align="right" alt="Exit" class="MenuIcon" 
  src="../images/ExitIcon.gif" onclick="DFrameExit();">
</span>
<div style="overflow:none;height:500px;">
<div id="silverlightControlHost">
</div>
<iframe style="visibility:hidden;height:0;width:0;border-width:0;"></iframe>
</div>
<form name=PatientLinks method=get>
  <input type=hidden name=reportno value=1>
  <input type=hidden name=template value=005>
  <input type=hidden name=urnumber value="%CLIWEB08.01.003">
  <input type=hidden name=admissno value="%CLIWEB08.01.081">
  <input type=hidden name=MenuType value="%CLIWEB08.01.088">
</form>

