<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
var SlotCode;
var SlotDate;
var SlotName;
function updateParent(code,name,date,vist,clintcd,clintdes,clinind,clinbst,hic,
                      carer,letdays,nmds,caret,servd,hrisk,isOverBooked,tier,
                      mandref,msttier,defproc) {
    SlotCode=code
    SlotDate=date
    SlotName=name

    var clindate = code.substr(12,8);
    if(!CheckReferralDate(SelectPeriod.srchrefd.value,clindate)) {
      return;
    }

    var FollowEdit=document.getElementById("otcnfoll").value;
    if(parent.document.getElementById("d_followdt")) {
      var bookin_date=parent.document.getElementById("d_followdt").value;
      if(SetDateYYYYMMDD(bookin_date) > clindate) {
        if(FollowEdit==1) {
          if(!confirm("Warning: Follow up date selected is prior to the " +
                "date of the original booking. \nPress CANCEL to " +
                "select another date.")) {
            return;
          }
        }
        if(FollowEdit==2) {
          alert("Error Message: Follow up date selected is prior to the " +
                "date of the original booking. \nPlease select another " +
                "date.");
          return;
        }
      }
    }

    var site = SelectPeriod.site.value;
    if (parent.UpdateContractCodes != undefined) {
      parent.UpdateContractCodes(clintcd,site);
    }

    //Clinic Indicator
    if ( typeof(parent.AddForm)=='object' &&
         typeof(parent.AddForm.clinindc)=='object' ) { 
      parent.AddForm.clinindc.value = clinind;
    }

    //go to the server for a new set of clinic list that
    //are overbooked

    var clinicVisitList = null;  

    if (typeof parent.UpdateForm != 'undefined') {
      if (typeof parent.UpdateForm.outbb047 != 'undefined') {
        clinicVisitList = parent.UpdateForm.outbb047;
      }
    }
    else if (typeof parent.AddForm != 'undefined' ){
      if (typeof parent.AddForm.outbb047 != 'undefined') {
        clinicVisitList = parent.AddForm.outbb047;
      }
    }
//
    if (typeof parent.FollowUpForm != 'undefined' ){
      if (typeof parent.FollowUpForm.d_bulkprocess != 'undefined') {
        if (typeof parent.FollowUpForm.outbb047 != 'undefined') {
          clinicVisitList = parent.FollowUpForm.outbb047;
        }
      }
    }

    if (clinicVisitList != null) {
      var serverURL = "../cgi-bin/comweb80.pbl?reportno=61&valdcode=CV" +
                    "&valdsite=" + SelectPeriod.site.value.replace(/ /g,"+") +
                    "&valdctyp=" + clintcd.replace(/ /g,"+")
      var data = RSExecute(serverURL);
      if (typeof data  != 'undefined'){
        if (data != null) {
          patcodes = eval("("+data.return_value+")");
          //if we get this far lets recreate the clinic visit list

          clinicVisitList.innerHTML = "";
          var option = parent.document.createElement('option');
          option.value = "                 ";
          option.innerHTML = "             ";
          clinicVisitList.appendChild(option);

          if (isOverBooked == "Z") {
            for (var i = 0; i < patcodes.length; i++) {
              if (typeof patcodes[i] != "undefined" && patcodes[i] != null) {
                if (patcodes[i].indicators.substring(2,1) == isOverBooked) {
                  if (trim(patcodes[i].indicators.substring(6,1)) != "U") {
                    var option = parent.document.createElement('option');
                    option.value = patcodes[i].acode+patcodes[i].indicators;
                    option.innerHTML = patcodes[i].tdesc;
                    clinicVisitList.appendChild(option);
                  }
                }
              }
            }
          }
          else {
            for (var i = 0; i < patcodes.length; i++) {
              if (typeof patcodes[i] != "undefined" && patcodes[i] != null) {
                if (trim(patcodes[i].indicators.substring(6,1)) != "U") {
                  var option = parent.document.createElement('option');
                  option.value = patcodes[i].acode+patcodes[i].indicators;
                  option.innerHTML = patcodes[i].tdesc;
                  clinicVisitList.appendChild(option);
                }
              }
            }
          }
        }
      }
    }
    
    var sendLetter = null;

    if (typeof parent.AddForm != 'undefined') {
      sendLetter = parent.AddForm.outbb047;
    }
    else if(typeof parent.UpdateForm != 'undefined') {
      sendLetter = parent.UpdateForm.outbb047;
    }

    if (typeof parent.FollowUpForm != 'undefined' ){
      if (typeof parent.FollowUpForm.d_bulkprocess != 'undefined') {
        if (typeof parent.FollowUpForm.outbb047 != 'undefined') {
          sendLetter = parent.FollowUpForm.outbb047;
        }
      }
    }

    if (sendLetter != null && typeof sendLetter.onchange != 'undefined') {
      if (sendLetter.onchange.toString().indexOf('onchangeHandler') == "-1") {
        setTimeout(function(){ sendLetter.onchange();},200);
      }
    }

    //New Slot key
    if (typeof(parent.AddForm)=='object' && 
       typeof(parent.AddForm.nslotkey)=='object') {
           parent.AddForm.nslotkey.value=code;
        }

    //visit type
     if(typeof(parent.AddForm)=='object' && parent.AddForm.outbb047.type=='select-one') {
         for (var i =0 ; i < parent.AddForm.outbb047.length; i++) {
         if (trim(parent.AddForm.outbb047.options[i].value.substr(0,3))==trim(vist)) {
           parent.AddForm.outbb047.selectedIndex=i }
         }
        }
    //////
     if(typeof(parent.UpdateForm)=='object' && 
        typeof(parent.UpdateForm.outbb047)=='object') {
       if(parent.UpdateForm.outbb047.type=='select-one') {
         for (var i =0 ; i < parent.UpdateForm.outbb047.length; i++) {
         if (trim(parent.UpdateForm.outbb047.options[i].value.substr(0,3))==trim(vist)) {
           parent.UpdateForm.outbb047.selectedIndex=i }
         }
       }
     } 
    /////
     if(typeof(parent.FollowUpForm)=='object' &&
        typeof(parent.FollowUpForm.d_bulkprocess)=='object' &&
        typeof(parent.FollowUpForm.outbb047)=='object') {
       if(parent.FollowUpForm.outbb047.type=='select-one') {
         for (var i =0 ; i < parent.FollowUpForm.outbb047.length; i++) {
         if (trim(parent.FollowUpForm.outbb047.options[i].value.substr(0,3))==trim(vist)) {
           parent.FollowUpForm.outbb047.selectedIndex=i }
         }
       }
     }
    /////
    // Added for diagnosis search
    //
    if (typeof(parent.parent.AddForm)=='object' && 
       typeof(parent.parent.AddForm.defclnty)=='object') {
           parent.parent.AddForm.defclnty.value=clintcd;
        }
    if (typeof(parent.AddForm)=='object' && 
       typeof(parent.AddForm.defclnty)=='object') {
           parent.AddForm.defclnty.value=clintcd;
    }
    if (typeof(parent.AddForm)=='object' && 
       typeof(parent.AddForm.outbb016)=='object') {
       parent.AddForm.outbb016.value=clintcd;
    }
    if (typeof(parent.parent.UpdateForm)=='object' &&
       typeof(parent.parent.UpdateForm.defclnty)=='object' &&
       typeof(parent.parent.UpdateForm.follflag)=='object') {
         parent.parent.UpdateForm.defclnty.value=clintcd;
    }
    if (typeof(parent.UpdateForm)=='object' &&
       typeof(parent.UpdateForm.defclnty)=='object' &&
       typeof(parent.UpdateForm.follflag)=='object') {
         parent.UpdateForm.defclnty.value=clintcd;
    }
    if (typeof(parent.UpdateForm)=='object' &&
       typeof(parent.UpdateForm.outbb016)=='object' &&
       typeof(parent.UpdateForm.follflag)=='object') {
         parent.UpdateForm.outbb016.value=clintcd;
    }
    //
    // Clinic using medclaims
    if (typeof(parent.AddForm)=='object' && 
       typeof(parent.AddForm.otmaumci)=='object') {
           parent.AddForm.otmaumci.value=hic;
    }
    //
    // Collect Carer Details
    if (typeof(parent.AddForm)=='object' && 
       typeof(parent.AddForm.otheccar)=='object') {
           parent.AddForm.otheccar.value=carer;
    }
    //
    // Generate letter days
    if (typeof(parent.AddForm)=='object' &&
       typeof(parent.AddForm.othendps)=='object') {
       parent.AddForm.othendps.value=letdays;
    }
    if (typeof(parent.UpdateStatus)=='object' &&
       typeof(parent.UpdateStatus.othendps)=='object') {
       parent.UpdateStatus.othendps.value=letdays;
    }

    // NMDS Code AddForm
    if (typeof(parent.AddForm)=='object' &&
       typeof(parent.AddForm.outbb068)=='object') {
         for (var i =0 ; i < parent.AddForm.outbb068.length; i++) {
             if (trim(parent.AddForm.outbb068.options[i].value.substr(0,3))==
                 trim(nmds)) {
                 parent.AddForm.outbb068.selectedIndex=i }
         }
    }

    if (typeof(parent.UpdateForm)=='object' &&
       typeof(parent.UpdateForm.clapindc)=='object' &&
       typeof(parent.UpdateForm.outbb068)=='object') {
         for (var i =0 ; i < parent.UpdateForm.outbb068.length; i++) {
             if (trim(parent.UpdateForm.outbb068.options[i].value.substr(0,3))==
                 trim(nmds)) {
                 parent.UpdateForm.outbb068.selectedIndex=i }
         }
    }

    // Mandatory referral
    if (typeof(parent.AddForm)=='object' &&
       typeof(parent.AddForm.othemref)=='object') {
       parent.AddForm.othemref.value=mandref;
    }

    // Tier 2 Code AddForm
    if (typeof(parent.AddForm)=='object' &&
       typeof(parent.AddForm.outbb072)=='object') {
         for (var i =0 ; i < parent.AddForm.outbb072.length; i++) {
             if (trim(parent.AddForm.outbb072.options[i].value.substr(0,3))==
                 trim(tier)) {
                 parent.AddForm.outbb072.selectedIndex=i }
         }
    }

    // Tier 2 Code AddForm
    if (typeof(parent.AddForm)=='object' &&
       typeof(parent.AddForm.outbb072)=='object') {
       if(parent.AddForm.outbb072.type=="hidden") {
         parent.AddForm.outbb072.value=trim(tier);
       }
    }

    if (typeof(parent.UpdateForm)=='object' &&
       typeof(parent.UpdateForm.clapindc)=='object' &&
       typeof(parent.UpdateForm.outbb072)=='object') {
         for (var i =0 ; i < parent.UpdateForm.outbb072.length; i++) {
             if (trim(parent.UpdateForm.outbb072.options[i].value.substr(0,3))==
                 trim(tier)) {
                 parent.UpdateForm.outbb072.selectedIndex=i }
         }
    }

    // Tier 2 Code UpdateForm
    if (typeof(parent.UpdateForm)=='object' &&
       typeof(parent.UpdateForm.outbb072)=='object') {
       if(parent.UpdateForm.outbb072.type=="hidden") {
         parent.UpdateForm.outbb072.value=trim(tier);
       }
    }
   // Tier 2 Code AddForm from MasterClinic - New Appointment
    if (typeof(parent.AddForm)=='object' &&
        typeof(parent.AddForm.d_otmatcod)=='object' &&
        typeof(parent.AddForm.outbb072)=='object') {
        if(parent.AddForm.outbb072.type=="hidden" &&
           parent.AddForm.outbb072.value=="") {
            parent.AddForm.outbb072.value=trim(msttier);
       }
    }
    // Tier 2 Code Addform from SlotTemplate - New Appointment
    if (typeof(parent.AddForm)=='object' &&
       typeof(parent.AddForm.outbb072)=='object') {
       if(parent.AddForm.outbb072.type=="hidden" &&
          tier.value!=undefined) {
         parent.AddForm.outbb072.value=trim(tier);
       }
    }
// Tier 2 Code UpdateForm from MasterClinic
    if (typeof(parent.parent.UpdateForm)=='object' &&
        typeof(parent.parent.UpdateForm.d_otmatcod)=='object' &&
        typeof(parent.parent.UpdateForm.outbb072)=='object') {
        if(parent.parent.UpdateForm.outbb072.type=="hidden" &&
           parent.parent.UpdateForm.outbb072.value=="") {
            parent.parent.UpdateForm.outbb072.value=trim(msttier);
       }
    }
    // Tier 2 Code Addform from SlotTemplate 
    if (typeof(parent.parent.UpdateForm)=='object' &&
       typeof(parent.parent.UpdateForm.outbb072)=='object') {
       if(parent.parent.UpdateForm.outbb072.type=="hidden" &&
          tier.value!=undefined) {
         parent.parent.UpdateForm.outbb072.value=trim(tier);
       }
    }
    // Tier 2 Code UpdateForm from MasterClinic- Follow-up Appointment
    if (typeof(parent.UpdateForm)=='object' &&
        typeof(parent.UpdateForm.d_otmatcod)=='object' &&
        typeof(parent.UpdateForm.outbb072)=='object') {
        if(parent.UpdateForm.outbb072.type=="hidden" &&
           parent.UpdateForm.outbb072.value=="") {
            parent.UpdateForm.outbb072.value=trim(msttier);
       }
    }
    // Tier 2 Code Addform from SlotTemplate - Follow-up Appointment
    if (typeof(parent.parent.UpdateForm)=='object' &&
       typeof(parent.parent.UpdateForm.outbb072)=='object') {
       if(parent.parent.UpdateForm.outbb072.type=="hidden" &&
          tier.value!=undefined) {
         parent.parent.UpdateForm.outbb072.value=trim(tier);
       }
    }

    // Care Type AddForm
   if (typeof(parent.AddForm)=='object' &&
     typeof(parent.AddForm.outbb069)=='object') {
       for (var i =0 ; i < parent.AddForm.outbb069.length; i++) {
       if (trim(parent.AddForm.outbb069.options[i].value.substr(0,3))==
           trim(caret)) {
           parent.AddForm.outbb069.selectedIndex=i }
       }
   }

   if (typeof(parent.UpdateForm)=='object' &&
      typeof(parent.UpdateForm.clapindc)=='object' &&
      typeof(parent.UpdateForm.outbb069)=='object') {
       for (var i =0 ; i < parent.UpdateForm.outbb069.length; i++) {
       if (trim(parent.UpdateForm.outbb069.options[i].value.substr(0,3))==
           trim(caret)) {
           parent.UpdateForm.outbb069.selectedIndex=i }
       }
   }

   // Service Delivery AddForm
   if (typeof(parent.AddForm)=='object' &&
     typeof(parent.AddForm.outbb070)=='object' &&
     typeof(parent.AddForm.d_notbb070)!='object') {
     for (var i =0 ; i < parent.AddForm.outbb070.length; i++) {
       if (trim(parent.AddForm.outbb070.options[i].value.substr(0,3))==
         trim(servd)) {
         parent.AddForm.outbb070.selectedIndex=i 
       }
     }
   }

   if (typeof(parent.UpdateForm)=='object' &&
      typeof(parent.UpdateForm.clapindc)=='object' &&
      typeof(parent.UpdateForm.outbb070)=='object') {
     for (var i =0 ; i < parent.UpdateForm.outbb070.length; i++) {
       if (trim(parent.UpdateForm.outbb070.options[i].value.substr(0,3))==
         trim(servd)) {
         parent.UpdateForm.outbb070.selectedIndex=i
       }
     }
   }

  // Clinical High Risk AddForm
  if (typeof(parent.AddForm)=='object' &&
    typeof(parent.AddForm.d_outbb071)=='object') {
      if(hrisk=="1") {
        parent.AddForm.d_outbb071.checked=true;
        parent.AddForm.d_outbb071.disabled=true;
      } else {
        parent.AddForm.d_outbb071.checked=false;
        parent.AddForm.d_outbb071.disabled=false;
      }
  }

  // Clinical High Risk UpdateForm
  if (typeof(parent.UpdateForm)=='object' &&
    typeof(parent.UpdateForm.outbb071)=='object') {
      if(hrisk=="1") {
        parent.UpdateForm.outbb071.checked=true;
        parent.UpdateForm.outbb071.disabled=true;
      } else {
        parent.UpdateForm.outbb071.disabled=false;
      }
  }

  // Clinical High Risk UpdateForm
  if (typeof(parent.UpdateForm)=='object' &&
   typeof(parent.UpdateForm.d_outbb071)=='object') {
      if(hrisk=="1") {
        parent.UpdateForm.d_outbb071.checked=true;
        parent.UpdateForm.d_outbb071.disabled=true;
      } else {
        parent.UpdateForm.d_outbb071.disabled=false;
      }
  }

  // Generate letter days
  if (typeof(parent.UpdateForm)=='object' &&
    typeof(parent.UpdateForm.othendps)=='object') {
       parent.UpdateForm.othendps.value=letdays;
  }
  //
  // Generate letter days
  if (typeof(parent.Reschedule)=='object' &&
   typeof(parent.Reschedule.othendps)=='object') {
       parent.Reschedule.othendps.value=letdays;
  }
  // Generate letter days
  if (typeof(parent.FollowUpForm)=='object' &&
   typeof(parent.FollowUpForm.othendps)=='object') {
       parent.FollowUpForm.othendps.value=letdays;
  }
  //
  //Dummy hidden field for visit type
  if (typeof(parent.AddForm)=='object' &&
    typeof(parent.AddForm.d_outbb047)=='object') {
       parent.AddForm.d_outbb047.value=trim(vist);
  }
  //
  //Dummy hidden field for visit type
  if (typeof(parent.UpdateForm)=='object' &&
    typeof(parent.UpdateForm.d_outbb047)=='object') {
       parent.UpdateForm.d_outbb047.value=trim(vist);
       if(typeof(parent.SendLetterDNA03)== 'function'){
         parent.ReturnDate.value=SlotDate
         parent.SendLetterDNA03();
       }
  }
  //
  //Dummy hidden field for visit type
  if (typeof(parent.Reschedule)=='object' &&
    typeof(parent.Reschedule.d_outbb047)=='object') {
       parent.Reschedule.d_outbb047.value=trim(vist);
       if(typeof(parent.SendLetterRSH02)== 'function'){
         parent.ReturnDate.value=SlotDate
         parent.SendLetterRSH02();
       }
  }
  //
  //Dummy hidden field for visit type
  if (typeof(parent.UpdateStatus)=='object' &&
    typeof(parent.UpdateStatus.d_outbb047)=='object') {
       parent.UpdateStatus.d_outbb047.value=trim(vist);
       if(typeof(parent.SendLetterRSH01)== 'function'){
         parent.ReturnDate.value=SlotDate
         parent.SendLetterRSH01();
       }
  }
  //

//Dummy hidden field for default procedure  AddForm
 if (document.SelectPeriod.ptcnhdps.value == "1" &&
   typeof(parent.AddForm)=='object' &&
   typeof(parent.AddForm.otprc002)=='object') {
       if(isWhitespace(parent.AddForm.otprc002.value)) {
         parent.AddForm.otprc002.value=trim(defproc);
         valCtypeProcedure(parent.AddForm.defclnty,
                           parent.AddForm.otprc002,
                           parent.AddForm.otprc003);
       }
    }
//Dummy hidden field for default procedure UpdateForm
 if (document.SelectPeriod.ptcnhdps.value == "1" &&
   typeof(parent.UpdateForm)=='object' &&
   typeof(parent.UpdateForm.otprc002)=='object') {
       if(isWhitespace(parent.UpdateForm.otprc002.value)) {
         parent.UpdateForm.otprc002.value=trim(defproc);
         valCtypeProcedure(parent.UpdateForm.defclnty,
                           parent.UpdateForm.otprc002,
                           parent.UpdateForm.otprc003);
       }
    }

  reserveSlot(code,"","","",UpdatePage)

  if (parent.FilterMentalHealth != undefined) {
    parent.FilterMentalHealth(code);
  }
}

function CheckReferralDate(ref,clin)
{
  if (isWhitespace(ref) || isWhitespace(clin)) {
    return true;
  }
  if (ref > clin)
  {
    alert("Appointment Date must not be before Referral Date (" + SetDateDDMMMYYYY(ref) + ")");
    return false;
  }

  return true;
}

function UpdatePage() {
  parent.ReturnCode.value=SlotCode
  parent.ReturnName.value=SlotName
  parent.ReturnDate.value=SlotDate

  if (typeof(parent.ReturnFunction) == 'function'){
     parent.ReturnFunction()
  }
    parent.document.getElementById('PopUpScreen').style.display="none"
} 
function LinkToClinic() {
  var LinkUrl="../cgi-bin/outweb02.pbl?reportno=2&template=5" +
              "&sesskeys=" + SelectPeriod.linksess.value.replace(/ /g,"+") 
//
  if(typeof(parent.AddForm)=='object' &&                   // OP Booking
     typeof(parent.AddForm.slotbtyp)=='object') {
     if(parent.AddForm.slotbtyp.value=="1") {
       LinkUrl+=LinkUrl + 
              "&sloturno=" + parent.AddForm.urnumber.value.replace(/ /g,"+") + 
              "&slotrefn=" + parent.AddForm.refrlvis.value.replace(/ /g,"+") +
              "&slotbtyp=1"

        if (typeof(parent.AddForm.slotrtrn)=='object') {
          SetCookie("AppointmentCookie",parent.location.href); 
        } else {
          SetCookie("AppointmentCookie",parent.parent.location.href);
        }

        SetCookie("AppointmentTypeCookie",parent.location.href);
     } else if (parent.AddForm.slotbtyp.value=="2") {      // Request
       LinkUrl+=LinkUrl + 
              "&sloturno=" + parent.AddForm.urnumber.value.replace(/ /g,"+") + 
              "&slotrefn=" + parent.AddForm.refrlvis.value.replace(/ /g,"+") +
              "&slotbtyp=2" +
              "&slotreqk=" + parent.AddForm.requestk.value.replace(/ /g,"+") 
        SetCookie("AppointmentCookie",parent.parent.location.href);
        SetCookie("AppointmentTypeCookie",parent.location.href);
     }
  } else if(typeof(parent.UpdateForm)=='object' &&
            typeof(parent.UpdateForm.slotbtyp)=='object') {
     if(parent.UpdateForm.slotbtyp.value=="3") {              // Follow Up Appt
       LinkUrl+=LinkUrl + 
             "&sloturno=" + parent.UpdateForm.urnumber.value.replace(/ /g,"+") +
             "&slotcask=" + parent.UpdateForm.casekeys.value.replace(/ /g,"+") +
             "&slotrefn=" + parent.UpdateForm.alrevisn.value.replace(/ /g,"+") +
             "&slotbtyp=3"
        SetCookie("AppointmentCookie",parent.parent.location.href);
        SetCookie("AppointmentTypeCookie",parent.location.href);
     }
     if(parent.UpdateForm.slotbtyp.value=="4") {              // Reschedule Appt
       LinkUrl+=LinkUrl + 
             "&sloturno=" + parent.UpdateForm.urnumber.value.replace(/ /g,"+") +
             "&slotcask=" + parent.UpdateForm.casekeys.value.replace(/ /g,"+") +
             "&slotrefn=" + parent.UpdateForm.alrevisn.value.replace(/ /g,"+") +
             "&slotbtyp=4"
        SetCookie("AppointmentCookie",parent.parent.location.href);
        SetCookie("AppointmentTypeCookie",parent.location.href);
     }
     if(parent.UpdateForm.slotbtyp.value=="5") {              // DNA
       LinkUrl+=LinkUrl +
             "&sloturno=" + parent.UpdateForm.urnumber.value.replace(/ /g,"+") +
             "&slotcask=" + parent.UpdateForm.casekeys.value.replace(/ /g,"+") +
             "&slotrefn=" + parent.UpdateForm.alrevisn.value.replace(/ /g,"+") +
             "&slotbtyp=5"
        SetCookie("AppointmentCookie",parent.parent.location.href);
        SetCookie("AppointmentTypeCookie",parent.location.href);
     }

  } 

//
  getTop().content.location.href=LinkUrl;
}
function LinkToShowDetails() {
  SetCookie("ClinicListCookie",document.SelectPeriod.cllsckie.value);
  var LinkUrl="../cgi-bin/outweb02.pbl?reportno=02&template=19" +
              "&sesskeys=" + SelectPeriod.linksess.value.replace(/ /g,"+") +
              "&srchrefn=" + SelectPeriod.srchrefn.value.replace(/ /g,"+");
    location.href=LinkUrl;
}
function getClinicListCookie() {
  if (GetCookieData("ClinicListCookie") != "unknown") {
    document.SelectPeriod.cllsckie.value=GetCookieData("ClinicListCookie");
    ExpireCookiePath("ClinicListCookie");
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);getClinicListCookie();">
<div id=PageHeadingSection>
<span class=DFrameTitleBar>
  <img align="left" alt="Clinic List - Update Slots" class="MenuIcon Image1"
  src="../images/ListIcon.gif" onclick="LinkToClinic();">
  <img align="right" alt="Exit" class="MenuIcon" 
  src="../images/ExitIcon.gif" onclick="DFrameExit();">
  <script type="text/javascript">document.write(self.document.title);
  </script>
</span>
<form name=SelectPeriod action=outweb02.pbl method=get style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=003>
<input type=hidden name=template value=003>
<input type=hidden name=srchrefn value="%OUTWEB02.02.061">
<input type=hidden name=srchrefd value="%OUTWEB02.02.069">
<input type=hidden name=linksess value="%OUTWEB02.02.004">
<input type=hidden name=cllsckie value="">
<input type=hidden name=d_otmatcod value="">
<input type=hidden name=site value="%STANDARD.01.023">
<input type=hidden name=otcnfoll id=otcnfoll
 value="%STANDARD.01.025.032.147.0.1">
<input type=hidden name=ptcnhdps id=ptcnhdps
 value="%STANDARD.01.025.080.250.1.1">
<table cellspacing=0 cellpadding=1 bgcolor=#CCCCCC border=0 width=100%>
<tr><td class=DataField align=left>%OUTWEB02.02.006 Appointment List &nbsp;</td>
    <td align=middle>
    Show Details
    <input type=checkbox name=showdetl title="Show Details" value="1"
     onclick="LinkToShowDetails();">
    </td>
    <td align=right><input type=button value="<<" class=SmallButton
        onclick='SetCookie("ClinicListCookie",
                                document.SelectPeriod.cllsckie.value);
                 location.href="%OUTWEB02.02.002"'>
        <select name=sesskeys onchange='SetCookie("ClinicListCookie",
                                document.SelectPeriod.cllsckie.value);
                                        document.SelectPeriod.submit();'>
        %OUTWEB02.02.003
        </select>
        <input type=button value=">>" class=SmallButton
        onclick='SetCookie("ClinicListCookie",
                 document.SelectPeriod.cllsckie.value);
                 location.href="%OUTWEB02.02.001"'></td></tr>
</table>
</form>
</div>
<div id=PageBodySection>
<table cellspacing=0 cellpadding=1 width=100% border=1>
<tr>
    <td align=center width=60 nowrap class=HeadingCell>Time</td>
    <td class=HeadingCell>Visit Type</td>
    <td class=HeadingCell>Patient</td>
    <td class=HeadingCell>Status</td>
</tr>

%OUTWEB02.02.008                 
</table>
<table cellspacing=0 cellpadding=1 width=100% border=0>
<tr>
  <td align="middle">
    <input type=button value="Return" 
 onclick='//alert(location.href);
//alert(parent.UpdateForm);
          if (!isWhitespace(document.SelectPeriod.cllsckie.value)) {
//alert(document.SelectPeriod.cllsckie.value);
            location.href=document.SelectPeriod.cllsckie.value;
            return;
          }

          if (parent.UpdateForm!=undefined &&
              parent.ResetLetter!=undefined && 
              parent.ClinicSearch!=undefined) {
            parent.ResetLetter(parent.UpdateForm);parent.ClinicSearch();
          } else {
            if (parent.AddForm!=undefined &&
                parent.ClinicSearch!=undefined) {
              parent.ClinicSearch();
            } else {
              DFrameExit();
            }
          }' 
     class="Largebutton">
  </td>
</tr>
</table>
</div>
<script type="text/javascript">
PageBodySection.style.height=document.body.clientHeight - 
                             PageHeadingSection.clientHeight 
</script>
