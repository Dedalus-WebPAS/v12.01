<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/AutoPostCode.js"> </script>
<script type="text/javascript" src="../js/Comp_MV.js"> </script>

<!-- Motor Vehicle -->

<style type=text/css>

#SelectHeading{
position: absolute;
visibility: hidden;
top: 120px;
left: 320px;
height: 20px;
width: 350px;
overflow: none;
}

#SelectLocation{
position: absolute;
visibility: hidden;
top: 140px;
left: 320px;
height: 150px;
width: 350px;
overflow: auto;
}

</style>

<script type="text/javascript">

function init() {
  var statusInc = document.UpdateForm.pmext055.value.substr(3,1);
  if (statusInc != "C" || document.UpdateForm.ccvistyp.value !== "3") {
    document.getElementById('ReasonForChange').style.display="none";
    RemoveClassName(document.UpdateForm.reasonchange,"Mandatory");
  } else {
    document.getElementById('ReasonForChange').style.display="";
    AddClassName(document.UpdateForm.reasonchange,"Mandatory");
  }
}

function processCompRedirect() {

  var chckcomp = document.UpdateForm.chckcomp.value[0];
  var server = "patweb89";
  var report = "01";
  var retdfrae = "N";
  if (document.UpdateForm.chckcomp.value.length>1){
    pageType = document.UpdateForm.chckcomp.value[1];
  }

  if ( chckcomp == "D") {
    template="082";
    if (pageType=="P") {
      template="080";
    } else if (pageType=="O") {
      template="081";
    }
  } else if ( chckcomp == "A") {
    template="140";
    if (pageType=="P") {
      template="340";
    } else if (pageType=="O") {
      template="240";
    }
  } else if ( chckcomp == "O") {
    template="141";
    if (pageType=="P") {
      template="341";
    } else if (pageType=="O") {
      template="241";
    }
  } else if ( chckcomp == "F") {
    template="143";
    if (pageType=="P") {
      template="343";
    } else if (pageType=="O") {
      template="243";
    }
  } else if ( chckcomp == "H") {
    template="144";
    if (pageType=="P") {
      template="344";
    } else if (pageType=="O") {
      template="244";
    }
  }  else if ( chckcomp == "S") {
    template="145";
    if (pageType=="P") {
      template="345";
    } else if (pageType=="O") {
      template="245";
    }
  } else if ( chckcomp == "V") {
    template="146";
    if (pageType=="P") {
      template="346";
    } else if (pageType=="O") {
      template="246";
    }
  }  else if ( chckcomp == "W") {
    template="147";
    if (pageType=="P") {
      template="347";
    } else if (pageType=="O") {
      template="247";
    }
  }  else if ( chckcomp == "E") {
    template="148";
    if (pageType=="P") {
      template="348";
    } else if (pageType=="O") {
      template="248";
    }
  } else if ( chckcomp == "G") {
    template="149";
    if (pageType=="P") {
      template="349";
    } else if (pageType=="O") {
      template="249";
    }
  } else {
    if (pageType=="O"){

      if(document.UpdateForm.scrname.value=="OCR") {
        server="outweb02";
        report="03";
        template="004";
        document.UpdateForm.retdfrae.value="Y"
      } else if (document.UpdateForm.scrname.value == "OCD"){
        server="outweb02";
        report="03";
        template="006";
        document.UpdateForm.retdfrae.value="Y"
      } else {
        server="outweb02";
        report="03";
        template="001";
      }
    } else if (pageType=="P"){
      server="patweb98";
      template="001";
    } else {
      server="emrweb02";
      template="017";
    }
  }
  document.UpdateForm.redirect.value=server+".pbl?reportno="+report
  + "&template="+template
  + "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+")
  + "&mvmedrec=" + document.UpdateForm.mvmedrec.value + "&admissno="
  + document.PatientLinks.admissno.value.replace(/ /g,"+");

  if (document.UpdateForm.scrname.value != "   ") {
     document.UpdateForm.redirect.value += "&scrname="+
       document.UpdateForm.scrname.value;
  }
}

function SubmitClaim() {
  ReturnPath=GetCookieData('InvoiceReturn');
  if (!isWhitespace(ReturnPath) && ReturnPath!='unknown') {
     document.cookie="InvoiceReturn=;"            // clear cookie
     document.UpdateForm.redirect.value=ReturnPath; // return to invoice scr
 } else if(document.UpdateForm.mvmedrec.value == "1") {
     document.UpdateForm.redirect.value="mrtweb01.pbl?reportno=09&template=004"
     + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
     + "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+")
 } else if (document.UpdateForm.mhadmflg.value == "1") {
     document.UpdateForm.redirect.value="patweb89.pbl?reportno=07&template=001"
     + "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+")
     + "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+")
 } else if (document.UpdateForm.ccvistyp.value == "1") {
     document.UpdateForm.redirect.value="emrweb02.pbl?reportno=01&template=017"
     + "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+")
     + "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+")
 } else if (document.UpdateForm.ccvistyp.value == "2" ||
            document.UpdateForm.ccvisbok.value == "1") {
     document.UpdateForm.redirect.value="outweb02.pbl?reportno=03&template=001"
     + "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+")
     + "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+")
     + "&shwprint=1"
 } else {
     document.UpdateForm.redirect.value="patweb98.pbl?reportno=01&template=043"
     + "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+")
     + "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+")
 }

 processCompRedirect();

 if(valDateRespICWA(true)) {
   if(validateMandatory(UpdateForm)){
     if(document.UpdateForm.d_pmext138.checked==true) {
       document.UpdateForm.pmext138.value="1"
     } else {
       document.UpdateForm.pmext138.value="0";
     }

     if(document.UpdateForm.d_ffaddr.checked==true) {
       document.UpdateForm.pmext080.value=document.UpdateForm.d_pmext080.value;
     } else {
       document.UpdateForm.pmext080.value="";
     }

     if (document.UpdateForm.pmext055.value.substr(3,1) == "C") {
       var AltElection = document.UpdateForm.pmext140.options[document.UpdateForm.pmext140.selectedIndex].text;
       var str1 = "ICWA Claim Confirmed, Primary Claim Type for the Visit will be updated to ";
       var str2 = " and Insurance Company will be updated to the first code connected to ";
       var str3 = " if one exists.";
       if(confirm(str1 + AltElection + str2 + AltElection + str3) == false) {
         return;
       }
     }

     var statusInc = document.UpdateForm.pmext055.value.substr(3,1);
     if (statusInc=="C") {
       UpdateForm.reaschng.value=document.UpdateForm.reasonchange.value.substr(0,3);
     }

     UpdateForm.updatety.value="5";
     document.UpdateForm.submit();
   }
 }
}
</script>
%START.OF.PAGE
<body onLoad="PageLoad(event);GetDefaultIns();init();prtFormCheckType();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
<script type="text/javascript">document.write(self.document.title);</script>
</span>
<div id=PageBodySection>
<form name=UpdateForm action="patweb89.pbl" method=post
 onsubmit='return validateMandatory(this); '>
  <input type=hidden name=reportno value="02">
  <input type=hidden name=template value="342">
  <input type=hidden name=updatety value="5">
  <input type=hidden name=urnumber value="%PATWEB89.01.003">
  <input type=hidden name=pmext017 value="%PATWEB89.01.003">
  <input type=hidden name=pmext018 value="%PATWEB89.01.102">
  <input type=hidden name=admissno value="%PATWEB89.01.101">
  <input type=hidden name=pmext001 value="%PATWEB89.01.101">
  <input type=hidden name=pmext002 value="%PATWEB89.01.988.1">
  <input type=hidden name=claimcod value="%PATWEB89.01.126.3">
  <input type=hidden name=pmext080 value="%PATWEB89.01.384.080">
  <input type=hidden name=pmext138 value="%PATWEB89.01.384.099.040">
  <input type=hidden name=statncod value="%PATWEB89.01.999.004.0">
  <input type=hidden name=statndes value="%PATWEB89.01.999.004.1">
  <input type=hidden name=addeflag value="%PATWEB89.01.999.005">
  <input type=hidden name=finanelc value="%PATWEB89.01.126.1">
  <input type=hidden name=nextpage value=2>
  <input type=hidden name=retdfrae value="N">
  <input type=hidden name=schdcopy value="1">
  <input type=hidden name=mvmedrec value="%PATWEB89.01.902">
  <input type=hidden name=mhadmflg value="%PATWEB89.01.999.008">
  <input type=hidden name=claimtyp value="X">
  <input type=hidden name=returncd value="%PATWEB89.01.933">
  <input type=hidden name=redirect value="%PATWEB89.01.001.patweb98.01.001">
  <input type=hidden name=faxnumbr value=" ">
  <input type=hidden name=ccvistyp value="%PATWEB89.01.205">
  <input type=hidden name=ccvissta value="%PATWEB89.01.924">
  <input type=hidden name=pmext049 value="%PATWEB89.01.999.126">
  <input type=hidden name=admnstat value="%PATWEB89.01.199.020">
  <input type=hidden name=reaschng value=" ">
  <input type=hidden name=chngdsta value="">
  <input type=hidden name=chckcomp value="%PATWEB89.01.999.136">
  <input type=hidden name=scrname  value="%PATWEB89.01.999.137">
  <input type=hidden name=ccvisbok value="%PATWEB89.01.999.128">
  <input type=hidden name=visitty value="%PATWEB89.01.999.129.0">
  <input type=hidden name=visitst value="%PATWEB89.01.999.129.1">

<table align=center width=100% border=1 cellspacing=0 cellpadding=2>
<tr><td class=HeadingCell align=center>
    Motor Vehicle Details</td></tr>
<tr><td>
    <table width=100% border=0>

<tr><td class=DataLabel>Medicare Number</td>
    <td class="DataField">%PATWEB89.01.027 %PATWEB89.01.649</td>
    <td class=DataLabel>Solicitor Details</td>
    <td><input type="text" size="35" maxlength="35" name=pmext065 tabindex=13
      value="%PATWEB89.01.384.065" title="Solicitor Address 1">
    </td>
</tr>

<tr><td class=DataLabel>Claim Number</td>
    <td><input type="text" size="21" name="pmext013" 
         title="Claim Number" tabindex=1 value="%PATWEB89.01.384.013">
         <img src="../images/SearchIcon.gif" class=Icon
         onclick="lookUpMVI();">
    </td>
    <td class=DataLabel>&nbsp;</td>
    <td><input type="text" size="35" maxlength="35" name=pmext066 tabindex=14
      value="%PATWEB89.01.384.066" title="Solicitor Address 2">
    </td>
</tr>

<tr><td class=DataLabel>Alternate Election</td>
    <td><select name="pmext140" title="Alternate Election" tabindex=2
         class=Mandatory value="%PATWEB89.01.384.099.042.1">
        <option> </option>
         %PATWEB89.01.384.099.042.9.1.12.1.A
        </select></td>
    <td class=DataLabel>&nbsp;<br></td>
    <td><input type="text" size="35" maxlength="35" name=pmext067 tabindex=15
      value="%PATWEB89.01.384.067" title="Solicitor Address 3"
      onblur="valSolicitorPostCode();">
    </td>
</tr>

<tr><td class=DataLabel>Settled MVIT</td>
    <td><input type=checkbox tabindex=3
         title="Settled MVIT" name="d_pmext138"></td>
    <td class=DataLabel>State<br></td>
    <td><input type="text" size="35" maxlength="35" name=pmext068 tabindex=16
      value="%PATWEB89.01.384.068" title="Solicitor Address 4">
    </td>
<tr>

<tr><td class=DataLabel>Date of Accident</td>
    <td><input type=text name=pmext010 tabindex=4 class="PastDate Mandatory"
     title="Date of Accident" Size=12 value="%PATWEB89.01.384.010"
     onblur="valDateSentICWA()">
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.pmext010>
    </td>
    <td class=DataLabel>&nbsp;</td>
    <td><input type="text" size="8" maxlength="8" name=pmext069 tabindex=17
      value="%PATWEB89.01.384.069" title="Solicitor Postcode"
      onchange="SetPostCode02();">
    </td>
</tr>

<tr><td class=DataLabel>Accident Type</td>
    <td><select name="pmext139" title="Accident Type" tabindex=5
         class=Mandatory value="%PATWEB89.01.384.099.041.1" >
        <option> </option>
         %PATWEB89.01.384.099.041.2
        </select></td>
   <td class=DataLabel>Solicitor Contact Name</td>
    <td><input type="text" size="55" maxlength="50" name="pmext071" tabindex=18
        value="%PATWEB89.01.384.071" title="Solicitor Contact Name"></td>
</tr>

<tr><td class=DataLabel>Acc.Location</td>
    <td><input type="text" size="60" maxlength="50" tabindex=6 class=Mandatory
         title="Accident Location" name="pmext095"
         value="%PATWEB89.01.384.087"></td>
    <td class=DataLabel>Solicitor Contact Phone</td>
    <td><input type="text" size="25" maxlength="20" name="pmext070" tabindex=19
        value="%PATWEB89.01.384.070" title="Solicitor Contact Phone"></td>
</tr>


<tr><td class=DataLabel>Insurance Company</td>
    <td><select name="pmext012" title="Insurance Company" tabindex=7
         value="%PATWEB89.01.384.012.0" id="pmext012"
         onchange="DisplayIns();">
        <option> </option>
         %PATWEB89.01.999.011.0 
        </select></td>
    <td class=DataLabel>Other Address</td>
    <td><input type=checkbox name=d_ffaddr tabindex=20
     title="Other Address"
     onclick="DispFFAddr();BillMand();"></td>
</tr>

<tr><td>&nbsp;</td>
    <td><input type="text" size="35" maxlength="35" name=insadd1
        class=ReadOnly readonly title="Insurance Address"></td>
    <td><div id=LContactAdd1></div></td>
    <td><div id=FContactAdd1></div></td></tr>

<tr><td>&nbsp;</td>
    <td><input type="text" size="35" maxlength="35" name=insadd2
        class=ReadOnly readonly title="Insurance Address"></td>
    <td><div id=LContactAdd2></div></td>
    <td><div id=FContactAdd2></div></td></tr>

<tr><td>&nbsp;</td>
    <td><input type="text" size="35" maxlength="35" name=insadd3
        class=ReadOnly readonly title="Insurance Address"></td>
    <td><div id=LContactAdd3></div></td>
    <td><div id=FContactAdd3></div></td></tr>

<tr><td>&nbsp;</td>
    <td><input type="text" size="35" maxlength="35" name=insadd4
        class=ReadOnly readonly title="Insurance Suburb"></td>
    <td><div id=LContactAdd4></div></td>
    <td><div id=FContactAdd4></div></td></tr>

<tr><td>&nbsp;</td>
    <td><input type="text" size="8" maxlength="8" name=inspcode
        class=ReadOnly readonly title="Insurance Postcode"></td>
    <td><div id=LContactPCode></div></td>
    <td><div id=FContactPCode></div></td></tr>

<tr><td>Contact Name</td>
    <td><input type="text" size="50" maxlength="50" name=inscname
        class=ReadOnly readonly title="Insurance Contact Name"></td>
    <td><div id=LContactPName></div></td>
    <td><div id=FContactPName></div></td></tr>

<tr><td>Contact Phone</td>
    <td><input type="text" size="20" maxlength="20" name=insctelp
        class=ReadOnly readonly title="Insurance Contact Phone"></td>
    <td><div id=LContactPhone></div></td>
    <td><div id=FContactPhone></div></td></tr>

<tr><td class=DataLabel>Date Sent to ICWA</td>
    <td><input type=text name=pmext039 tabindex=4 class="PastDate"
     title="Date Sent to ICWA" Size=12 value="%PATWEB89.01.384.039" 
     onblur="valDateSentICWA()">
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.pmext039></td>
    <td class=DataLabel>Comments</td>
    <td><input type="text" size="55" maxlength="50" name=pmext059 tabindex=30
        value="%PATWEB89.01.384.059" title="Comments"></td>
</tr>

<tr><td class=DataLabel>Date ICWA Responded</td>
    <td><input type=text name=pmext040 tabindex=4 class="PastDate"
     title="Date ICWA Responded" Size=12 value="%PATWEB89.01.384.040" 
     onblur="valDateRespICWA()">
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.pmext040></td>
    <td class=DataLabel>&nbsp;</td>
    <td><input type="text" size="55" maxlength="50" name=pmext060 tabindex=31
        value="%PATWEB89.01.384.060" title="Comments"></td>
</tr>

<tr><td class=DataLabel>Status</td>
    <td><select name=pmext055 id=pmext055 title="Status" tabindex=34 class="Mandatory" onChange="valStatus()">
        %STANDARD.01.021.Vh
        </select></td>
    <td class=DataLabel>&nbsp;</td>
    <td><input type="text" size="55" maxlength="50" name=pmext061 tabindex=32
         value="%PATWEB89.01.384.061" title="Comments"></td>
</tr>

<tr id=ReasonForChange>
    <td class=DataLabel>%STANDARD.01.035.IZ</td>
    <td><select name=reasonchange id=reasonchange title="Reason for Change" tabindex=33 class="Mandatory">
        <option></option>
        %STANDARD.01.007.IZ
        </select></td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataLabel>&nbsp;</td>
</tr>

</table>
</td></tr>
</table>

<span id="prntclmform"></span>

<table cellspacing=0 cellpadding=1 border=0 align=center width=100%>
<tr><td colspan=4 align=center>
    <input type=button value="Update" tabindex=35 class="button" 
    id="pat89sub" onclick="tempDisable(this);SubmitClaim();">
    <input type=button value="Cancel" tabindex=36 
     onclick="SetCancel();" class="button">
</td></tr>
</table>
</form>
<div id=SelectHeading></div>
<div id=SelectLocation></div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
<input type=hidden name=MenuType value="%PATWEB89.01.088">
</form>

<span id="prntclmforms" style="display: none">
<table cellspacing=0 cellpadding=1 border=0 align=center width=100%>
<tr><td class=DataLabel width=15%>Print %STANDARD.01.017.CL Form</td>
    <td><input type=checkbox name=prtform1 value="1" tabindex=33
         onclick="SetPrinterAlt();">
    </td>
    <td class=DataLabel>Stationery Code</td>
    <td><input type=text name=d_statncod size=30
     class=ReadOnly readonly>
    <input type=hidden name=schform1 value="%PATWEB89.01.999.004.0">
    <input type=hidden name=sfrmdes1></td>
    <td class=DataLabel>Printer</td>
    <td><select name=schdprt1 title="Printer" tabindex=34 disabled>
        <option></option>
         %STANDARD.01.001.ELECTFRM.0X
        </select>
    </td>
</tr>
<tr><td class=DataLabel width=15%>Print Alternate %STANDARD.01.017.CL Form</td>
    <td><input type=checkbox name=prtform2 value="1" tabindex=33
         onclick="SetPrinterAltMVIT();">
    </td>
    <td class=DataLabel>Stationery Code</td>
    <td><select name=schform2 title="Form" tabindex=34 disabled>
        <option></option>
        %STANDARD.01.020.  5
        </td>
    <td class=DataLabel>Printer</td>
    <td><select name=schdprt2 title="Printer" tabindex=34 disabled>
        <option></option>
         %STANDARD.01.001.ELECTFRM.1X
        </select>
    </td>
</tr>
</table>
</span>

<span id=LFAdd1 style="display:none">
     Address
</span>
<span id=LFAdd3 style="display:none">
     Suburb
</span>
<span id=LFAdd4 style="display:none">
     State
</span>
<span id=LFPostCode style="display:none">
     Post Code
</span>
<span id=LFCName style="display:none">
     Contact Name
</span>
<span id=LFCPhone style="display:none">
     Contact Phone
</span>

<span id=FFAdd1 style="display:none">
       <input type="text" size="35" maxlength="35" name=d_pmext080 tabindex=21
      class=Mandatory value="%PATWEB89.01.384.080" title="Free format Address">
</span>

<span id=FFAdd2 style="display:none">
      <input type="text" size="35" maxlength="35" name=pmext081 tabindex=22
      value="%PATWEB89.01.384.081" title="Free format Address">
</span>

<span id=FFAdd3 style="display:none">
      <input type="text" size="35" maxlength="35" name=pmext082 tabindex=23
      value="%PATWEB89.01.384.082"
      onblur="valPostCode();">
</span>

<span id=FFAdd4 style="display:none">
      <input type="text" size="35" maxlength="35" name=pmext083 tabindex=24
      value="%PATWEB89.01.384.083" title="Free format Address">
</span>

<span id=FFPCode style="display:none">
      <input type="text" size="8" maxlength="8" name=pmext084 tabindex=25
      value="%PATWEB89.01.384.084" title="Free format Address"
      onchange="SetPostCode03();">
</span>

<span id=FFCName style="display:none">
      <input type="text" size="50" maxlength="50" name=pmext085 tabindex=26
      value="%PATWEB89.01.384.085" title="Free format Contact Name">
</span>

<span id=FFCPhone style="display:none">
      <input type="text" size="20" maxlength="20" name=pmext086 tabindex=27
      value="%PATWEB89.01.384.086" title="Free format Contact Phone">
</span>


<script type="text/javascript">

if(document.UpdateForm.pmext138.value=="1"){
   document.UpdateForm.d_pmext138.checked=true;
 } else {
   document.UpdateForm.d_pmext138.checked=false;
 }

 address="%PATWEB89.01.384.080";
 if(!isWhitespace(address)) {
   document.UpdateForm.d_ffaddr.checked=true;
 } else {
   document.UpdateForm.d_ffaddr.checked=false;
 }

 ffadd="%PATWEB89.01.384.080";
  if (!isWhitespace(ffadd)) {
    DispFFAddr();
  }
 mandfield=document.UpdateForm.claimcod.value.substr(34,1);
  if (mandfield!="B") {
     if(isWhitespace(address)) {
       document.UpdateForm.pmext012.className="Mandatory";
     }
  } 

function SetCancel() {
 if(!confirm("Warning: Motor Vehicle data will not be updated and\n" +
             "answer to motor vehicle accident question will revert\n" +
             "to 'No!' Ok to Continue ?")){
   return;
 }

 var admissno = document.PatientLinks.admissno.value.replace(/ /g,"+");
 var serverURL = "../cgi-bin/comweb81.pbl?reportno=74&valdadmn="+admissno;
 var returnValue = RSExecute(serverURL);

 ReturnPath=GetCookieData('InvoiceReturn');
 if (!isWhitespace(ReturnPath) && ReturnPath!='unknown') {
   document.cookie="InvoiceReturn=;" // clear cookie
   var link=ReturnPath;              // return to invoice scr
 }
 else {
   var urnumber ="%PATWEB89.01.003";
   var admissno ="%PATWEB89.01.101";
   var link = "patweb98.pbl?reportno=01&template=001&urnumber="+urnumber
             +"&admissno="+admissno;
 }
 if(document.UpdateForm.chckcomp.value.length>1){
   processCompRedirect();
   link = document.UpdateForm.redirect.value;
 }
 parent.location.href= link;
}

function valDateSentICWA() {
  var dateAcc = SetDateYYYYMMDD(document.UpdateForm.pmext010.value);
  var dateSentIC = SetDateYYYYMMDD(document.UpdateForm.pmext039.value);
  var dateRespIC = SetDateYYYYMMDD(document.UpdateForm.pmext040.value);
  if (isWhitespace(dateSentIC)) return; 
  if (dateSentIC < dateAcc) {
    alert("'Date Sent to ICWA' cannot be before 'Date of Accident'.");
    document.UpdateForm.pmext039.value = "";
    return;
  }
  if (!isWhitespace(dateRespIC) && dateRespIC < dateSentIC) {
    alert("'Date ICWA Responded' cannot be before 'Date Sent to ICWA'.");
    document.UpdateForm.pmext040.value = "";
    return;
  }
}

function valDateRespICWA(isSubmit) {
  var dateAcc = SetDateYYYYMMDD(document.UpdateForm.pmext010.value);
  var dateSentIC = SetDateYYYYMMDD(document.UpdateForm.pmext039.value);
  var dateRespIC = SetDateYYYYMMDD(document.UpdateForm.pmext040.value);
  if (isWhitespace(dateSentIC) && !isSubmit) {
    alert("'Date Sent to ICWA' cannot be blank.");
    document.UpdateForm.pmext039.focus();
    return false;
  } else if (isWhitespace(dateSentIC) && !isWhitespace(dateRespIC)) {
    alert("'Date ICWA Responded' cannot be entered if" +
          "'Date Sent to ICWA' is blank'.");
    document.UpdateForm.pmext039.focus();
    return false;
  } else if (!isWhitespace(dateRespIC) && dateRespIC < dateSentIC) {
    alert("'Date ICWA Responded' cannot be before 'Date Sent to ICWA'.");
    document.UpdateForm.pmext040.value = "";
    return false;
  }
  if (isSubmit) {
    if (!isWhitespace(dateSentIC) && dateSentIC < dateAcc) {
      alert("'Date Sent to ICWA' cannot be before 'Date of Accident'.");
      document.UpdateForm.pmext039.value = "";
      return false;
    }
  }
  return true;
}

function valStatus() {
  var statusInc = document.UpdateForm.pmext055.value.substr(3,1);
  var dateSentIC = document.UpdateForm.pmext039.value;
  var dateRespIC = document.UpdateForm.pmext040.value;
  var visType = document.UpdateForm.ccvistyp.value;
  var visStat = document.UpdateForm.ccvissta.value;
  var admnStat = document.UpdateForm.admnstat.value;
  var visitTy = document.UpdateForm.visitty.value;
  var visitSt = document.UpdateForm.visitst.value;
  var currentStatus="%PATWEB89.01.999.125.055.3"
  var status = document.UpdateForm.pmext055;

  if (statusInc == "C" & visitTy == "3" & visitSt == "1") {
    alert("Pre-admission visit cannot have a Confirmed Status");
    for (var i=0; i < status.options.length; i++) {
      if (currentStatus.substr(3,1) == status.options[i].value.substr(3,1)) {
        status.value = status.options[i].value;
        document.UpdateForm.pmext055.focus();
        return;
      }
    }
  }

  if (statusInc == "C" & visitTy == "2" & visitSt != "4") {
    alert("A non-attended Outpatient visit cannot have a Confirmed Status");
    for (var i=0; i < status.options.length; i++) {
      if (currentStatus.substr(3,1) == status.options[i].value.substr(3,1)) {
        status.value = status.options[i].value;
        document.UpdateForm.pmext055.focus();
        return;
      }
    }
  }
 
  if (statusInc == "C" & visitTy == "1" & visitSt == "1") {
    alert("A non-discharged Emergency visit cannot have a Confirmed Status");
    for (var i=0; i < status.options.length; i++) {
      if (currentStatus.substr(3,1) == status.options[i].value.substr(3,1)) {
        status.value = status.options[i].value;
        document.UpdateForm.pmext055.focus();
        return;
      }
    }
  }

  if (statusInc == "C" & visitTy == "1" & visitSt == "4") {
    alert("A non-discharged Emergency visit cannot have a Confirmed Status");
    for (var i=0; i < status.options.length; i++) {
      if (currentStatus.substr(3,1) == status.options[i].value.substr(3,1)) {
        status.value = status.options[i].value;
        document.UpdateForm.pmext055.focus();
        return;
      }
    }
  }

  if (statusInc == "A") {
    if (isWhitespace(dateSentIC)) {
      alert("'Date Sent to ICWA' cannot be blank.");
      focusOnCL("P");
      document.UpdateForm.pmext039.focus();
      return;
    } 
    if (visType !== "3") {
      alert("Patient must have an inpatient visit type.");
      focusOnCL("P");
      return;
    }
  }

  if (statusInc == "D") {
    if (isWhitespace(dateSentIC)) {
      alert("'Date Sent to ICWA' cannot be blank.");
      document.UpdateForm.pmext039.focus();
      focusOnCL("P");
      return;
    } 
    if (visType !== "3") {
      alert("Patient must have a visit type of Inpatient.");
      focusOnCL("P");
      return;
    } 
    if (visStat !== "3") {
      alert("Patient must be discharged.");
      focusOnCL("P");
      return;
    }
  }

  if (statusInc != "P") {
    if (isWhitespace(dateRespIC)) {
      alert("'Date ICWA Responded' cannot be blank.");
      focusOnCL("P");
      return;
    }
  }

  if (statusInc != "C" || visType !== "3") {
    document.getElementById('ReasonForChange').style.display="none";
    RemoveClassName(document.UpdateForm.reasonchange,"Mandatory");
  } else {
    document.getElementById('ReasonForChange').style.display="";
    AddClassName(document.UpdateForm.reasonchange,"Mandatory");
  }  
  document.UpdateForm.chngdsta.value = statusInc;
}

function focusOnCL(clCode) {
  selectedCL="%PATWEB89.01.999.125.055.3"
  var statusCode = selectedCL.substring(0,3);
  var ICWAStatus = document.UpdateForm.pmext055;
  if (!isWhitespace(selectedCL.substr(3,1))) {
    clCode = selectedCL.substr(3,1);
  }

  if (!isWhitespace(document.UpdateForm.chngdsta.value)) {
    clCode = document.UpdateForm.chngdsta.value;
  }

  for (var i = 0; i < document.UpdateForm.pmext055.options.length; i++) {
    if (ICWAStatus.options[i].value.substr(3,1) == clCode) {
      if(isWhitespace(statusCode)) {
        ICWAStatus.value = ICWAStatus.options[i].value;
      } else {
        if(ICWAStatus.options[i].value.substring(0,3)== statusCode) {
          ICWAStatus.value = ICWAStatus.options[i].value;
        }
      }
    }
  }
}

function checkMVITForm() {
  if (document.UpdateForm.statncod.value = ".0" ||
      isWhitespace(document.UpdateForm.statncod.value)) {
    var schForm2 = document.UpdateForm.schform2;
    schForm2.value = "FIN   ";
    document.UpdateForm.schform1.value = "FIN   ";
    var schForm2Text = schForm2.options[schForm2.selectedIndex].text;
    document.UpdateForm.d_statncod.value = schForm2Text;
    document.UpdateForm.sfrmdes1.value = schForm2Text;
  } else {
    document.UpdateForm.schform1.value = document.UpdateForm.statncod.value;
  }
  document.UpdateForm.schform2.value = "ICWA  ";
  document.UpdateForm.prtform1.checked = true;
  document.UpdateForm.prtform2.checked = true;
  SetPrinterAlt();
  SetPrinterAltMVIT();
}

function prtFormCheckType() {
  if (document.UpdateForm.ccvistyp.value == "3") {
    document.getElementById("prntclmform").innerHTML =
    document.getElementById("prntclmforms").innerHTML;
    document.getElementById("prntclmforms").innerHTML = "";
    checkMVITForm();
  }
}

focusOnCL("P");
for (var i=0;i<document.UpdateForm.pmext140.length;i++) {
  if (isWhitespace(document.UpdateForm.pmext140[i].value)) continue;
  var codeSingle = document.UpdateForm.pmext140[i].value.substr(3, 5);
  if (codeSingle.match(/M/g) == null) {
    document.UpdateForm.pmext140.options[i].remove(i);
    i--;
  }
}
ReasonForChange="%PATWEB89.01.999.127";
for (var i=0;i<document.UpdateForm.reasonchange.options.length;i++) {
  if (document.UpdateForm.reasonchange.options[i].value.substr(0,3)
      == ReasonForChange) {
    document.getElementById('reasonchange').value =
    document.getElementById('reasonchange').options[i].value;
  }
}
</script>
