<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/emrweb0201101.js"></script>
<script type="text/javascript">
function init() {
  if (document.HiddenFields.DischargeComplete.value!=1) {
    alert("ED Visit has already been discharged.");
    PageLocation="?reportno=1&template=017" +
                 "&urnumber=" + PatientURN.replace(/ /g,"+") +
                 "&admissno=" + PatientVIS.replace(/ /g,"+")
    location.href="emrweb02.pbl" + PageLocation
    return }
}
function PostDischarge() {
  if (document.UpdateForm.emvis026.value.substr(14,2)!="11") {
    if (isWhitespace(document.UpdateForm.emvis037.value)&&
        isWhitespace(document.UpdateForm.pmsvx075.value)) {
      alert("Either Discharge Diagnosis or ICD10 must be populated.");
      return;
    }
  }

  document.UpdateForm.redirect.value="emrweb02.pbl?reportno=01&template=017" +
        "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+") +
        "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+")

  i=document.UpdateForm.emvis026.selectedIndex
  ind=trim(document.UpdateForm.emvis026.options[i].value.substr(14,4));
  if(ind=="18" || ind=="2" || ind=="14" || ind=="15" || ind=="16"
     || ind=="22" || ind=="25" || ind=="26") {
    document.UpdateForm.emvis133.value=1
    document.UpdateForm.redirect.value="emrweb02.pbl?reportno=01&template=109" +
           "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+") +
           "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+")
  }
  else {
    document.UpdateForm.emvis133.value=0
  }
//
  document.UpdateForm.formactn.value="D "
  document.UpdateForm.updttype.value="DISCH"
  document.UpdateForm.emvis007.value = document.UpdateForm.emvis107.value;
  chckMandatory=validateMandatory(document.UpdateForm)
  if(chckMandatory) {
  document.UpdateForm.submit() }
}
function CheckDepartureA(){
  i=document.UpdateForm.emvis026.selectedIndex
  ind=trim(document.UpdateForm.emvis026.options[i].value.substr(14,4))

// Show Divs
  i=document.UpdateForm.emvis026.selectedIndex
  ind=trim(document.UpdateForm.emvis026.options[i].value.substr(14,4));
  ind2=trim(document.UpdateForm.emvis026.options[i].value.substr(4,1));
    if (ind==19 || ind==4 || ind==17 || ind==20 || ind==21) {
     document.getElementById('Departure').style.display="";
     document.getElementById('Departure').innerHTML=
     document.getElementById('ShowDeparture').innerHTML;
    } else {
     document.getElementById('Departure').style.display="none";
     document.getElementById('Departure').innerHTML=
     document.getElementById('ShowDeparture').innerHTML;
     document.UpdateForm.emvis033.value="";
     document.UpdateForm.name_emvis033n.value=""
    }

// Transfer to another hospital
  if (ind=="19" || ind=="4" || ind=="17" || ind=="20" || ind=="21") {
    document.UpdateForm.emvis033.className="Mandatory"
  }
  else          {
    document.UpdateForm.emvis033.className="Readonly"
                }
//
// Did not wait
//
  if (document.UpdateForm.emvis026.value.substr(14,2)=="11") {
    document.UpdateForm.emvis107.className=""; 
  }
  else
  {
    document.UpdateForm.emvis107.className="Mandatory";
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);CheckDepartureA();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%EMRWEB02.01.003";
PatientVIS="%EMRWEB02.01.081";
PatientNAM="%EMRWEB02.01.002";
PatientSTA="%EMRWEB02.01.086.078";
PatientALT="%EMRWEB02.01.084";
PatientSEX="%EMRWEB02.01.019";
PatientDOB="%EMRWEB02.01.020";
PatientAGE="%EMRWEB02.01.021";
PatientLOC="%EMRWEB02.01.083";
PatientPRI="%EMRWEB02.01.086.066.1";
PatientUNT="%EMRWEB02.01.066.0";
PatientIND="%EMRWEB02.01.086.091";
GpCOD="%EMRWEB02.01.086.084.001";
GpNAM="%EMRWEB02.01.086.084.081";
GpPRAC="%EMRWEB02.01.086.085.001";
GpPRACCNT="%EMRWEB02.01.086.085.002";
GpPRACNAM="%EMRWEB02.01.086.085.005";
PatientARR="%EMRWEB02.01.101.0 %EMRWEB02.01.102";
PatientSEE="%EMRWEB02.01.199.008";
PatientTRI="%EMRWEB02.01.103.3";
PatientECLC="%EMRWEB02.01.484.1";
PatientCLH="%STANDARD.01.017.CL";
PatientEHFT="%EMRWEB02.01.485";
InsertEmergencyHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<table width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td class=HeadingCell align=center>
    Emergency Patient Discharge </td></tr>
</table>

<form name=UpdateForm action=emrweb02.pbl method=post style="margin:0">
 <input type=hidden name=reportno value="01">
 <input type=hidden name=template value="101">
 <input type=hidden name=formactn>
 <input type=hidden name=updttype>
 <input type=hidden name=emvis133>
 <input type=hidden name=admissno value="%EMRWEB02.01.081">
 <input type=hidden name=updateky value="%EMRWEB02.01.404">
 <input type=hidden name=urnumber value="%EMRWEB02.01.003">
 <input type=hidden name=emvis118 value="%EMRWEB02.01.003">
 <input type=hidden name=nextpage value="2">
 <input type=hidden name=redirect value="">
 <input type=hidden name=chkdot value="%EMRWEB02.01.107.001">
 <input type=hidden name=chknur value="%EMRWEB02.01.164.1">
 <input type=hidden name=dummy1
  value="%EMRWEB02.01.104%EMRWEB02.01.105%EMRWEB02.01.174">
 <input type=hidden name=dummy2
  value="%EMRWEB02.01.175%EMRWEB02.01.176%EMRWEB02.01.177">
 <input type=hidden name=waittime value="%EMRWEB02.01.701">
 <input type=hidden name=loadflag >
 <input type=hidden name=reloadfg value="%EMRWEB02.01.446">
 <input type=hidden name=efrbedty value="%EMRWEB02.01.506">
 <input type=hidden name=efrdisch value="%EMRWEB02.01.509">
 <input type=hidden name=efradmis value="%EMRWEB02.01.508">
 <input type=hidden name=attdtype value="%EMRWEB02.01.213.3">
 <input type=hidden name=depttime value="%EMRWEB02.01.125">
 <input type=hidden name=deptdate value="%EMRWEB02.01.124.0">
 <input type=hidden name=ptdocsee value="%EMRWEB02.01.130.0 %EMRWEB02.01.131">
 <input type=hidden name=ptnursee value="%EMRWEB02.01.128.0 %EMRWEB02.01.129">
 <input type=hidden name=pmpxi067 value="%EMRWEB02.01.667.0">
 <input type=hidden name=mapvflag value="0">
 <input type=hidden name=ptcnhdps value="%STANDARD.01.025.080.250.1.1">
 <input type=hidden name=setemrcm value="1">
 <input type=hidden name=emvis007 value="">
 <input type=hidden name=currdate value="%STANDARD.01.013">
 <input type=hidden name=currtime>

<table width=95% align=center border=0 cellspacing=0 cellpadding=1>
<tr valign=top><td>
<table width=95% border=0 cellspacing=0 cellpadding=2>
<tr><td class=DataLabel width=10%>Discharge Date </td>
    <td width=30%><input type=text size=12 name=emvis024 tabindex=1
         class="Mandatory PastDate" title="Discharge Date" 
         onblur="ValDate(UpdateForm.emvis024,UpdateForm.emvis025);">
         <img notab src=../images/DateLookup.gif class=Icon
         onclick="DateLookupFrame(UpdateForm.emvis024);">
        <input class=Mandatory type=text name=emvis025
         size=8 title="Time" tabindex=2
         onblur="ValTime(UpdateForm.emvis024,UpdateForm.emvis025);">
        <img notab src=../images/DateTimeStamp.gif class=Icon
         onclick="SetCurrentDateTime(UpdateForm.emvis024,UpdateForm.emvis025);">
        <img notab src=../images/TimeLookup.gif class=Icon
         onclick="TimeLookupFrame(UpdateForm.emvis025);">
    </td>
      <td class=DataLabel width=10%>
        ED Treating Doctor
      </td>
      <td>
        <input type="text" size=8 maxlength=6 name="emvis106"
         title="ED Treating Doctor" tabindex=7
         onblur="UpCase(this);
         validateCode(31,UpdateForm.emvis106,UpdateForm.doctnam2);">
        <input type=text readonly size=25 notab name=doctnam2
         title="ED Treating Doctor Description">
        <img notab src="../images/SearchIcon.gif" class=Icon
         onclick="DoctorSearchFrame(UpdateForm.emvis106,UpdateForm.doctnam2);">
        <img src=../images/erase.gif class=Icon
         onclick="clrFields(UpdateForm.emvis106,UpdateForm.doctnam2);">
     </td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.017.ED</td>
    <td><select name=emvis026 onchange="CheckDepartureA();"
         class=Mandatory title="%STANDARD.01.017.ED" tabindex=3>
        <option></option>
        %STANDARD.01.007.ED
        </select></td>

      <td class=DataLabel>
        ED Discharge Doctor
      </td>
      <td>
        <input type="text" size=8 maxlength=6 name="emvis107"
         title="ED Discharge Doctor" tabindex=8 class=Mandatory
         onblur="UpCase(this); 
         validateCode(31,UpdateForm.emvis107,UpdateForm.doctnam3);">
        <input type=text readonly size=25 notab name=doctnam3
         title="ED Discharge Doctor Description">
        <img notab src="../images/SearchIcon.gif" class=Icon
         onclick="DoctorSearchFrame(UpdateForm.emvis107,UpdateForm.doctnam3);">
        <img src=../images/erase.gif class=Icon
         onclick="clrFields(UpdateForm.emvis107,UpdateForm.doctnam3);">
     </td>

  </tr>
</table>

<div id=Departure></div>
<table width=95% border=0 cellspacing=0 cellpadding=0>
  <tr>
    <td class=DataLabel width=10%>
      Discharge Diagnosis
    </td>
    <td width=30%>
      <input type=text size=40 maxlength=50 name=emvis037
       title="Discharge Diagnosis" tabindex=4>
    </td>
      <td class=DataLabel width=10%>
        ED Consultant
      </td>
      <td>
        <input type="text" size=8 maxlength=6 name="emvis108"
         title="ED Consultant" tabindex=9
         onblur="UpCase(this);
         validateCode(31,UpdateForm.emvis108,UpdateForm.doctnam4);">
        <input type=text readonly size=25 notab name=doctnam4
         title="ED Consultant Description">
        <img notab src="../images/SearchIcon.gif" class=Icon
         onclick="DoctorSearchFrame(UpdateForm.emvis108,UpdateForm.doctnam4);">
        <img src=../images/erase.gif class=Icon
         onclick="clrFields(UpdateForm.emvis108,UpdateForm.doctnam4);">
     </td>
  </tr>
<tr>
  <td class=DataLabel>
    ICD10
  </td>
  <td>
    <input type=text name=pmsvx075 title="ICD10" size=10 maxlength=9 tabindex=5
     onblur='validateCode(6,UpdateForm.pmsvx075,UpdateForm.drgdesc1);'>
    <input type=text size=30 name=drgdesc1 title="ICD Description" readonly>
    <img src=../images/SearchIcon.gif alt="Disease Search" class=Icon 
     onclick="Icd10DisSearchFrame(UpdateForm.pmsvx075,UpdateForm.drgdesc1,UpdateForm.drgdesc2);">
    <img src=../images/erase.gif class=Icon
     onclick="clrFields(UpdateForm.pmsvx075,UpdateForm.drgdesc1);">
    </td>
</tr>
</table>

<table width=95% border=0 cellspacing=0 cellpadding=0>
<tr valign=top><td class=DataLabel width=10%>Comments</td>
   <td>
          <textarea cols=100 rows=3 name=emcommnt
               onkeydown="LimitText(this,100,300)" tabindex=5
               wrap=hard>%EMRWEB02.01.434.002</textarea></td>
</tr>
</table>

<table width=100% border=0 cellspacing=0 cellpadding=2>

<tr><td colspan=4 align=center><br>
    <input type=button value="Discharge" class="button" id="emr02d"
     onclick="tempDisable(this);PostDischarge();">
    <input type=button value="Cancel" class="button"
     onclick='PatientLinkTo("emrweb02.pbl",1,17,0,0,0);'>
</td></tr>
</table>
</td></tr>
</table>
</form>

<span id=ShowDeparture style="display:none;">
<table width=95% border=0 cellspacing=0 cellpadding=2>
<tr><td class=DataLabel width=10%>Discharge to</td>
    <td><input type=text size=10 maxlength=6 name=emvis033
         title="Transfer Destination" tabindex=4
         onchange="validateCode(9,UpdateForm.emvis033,
                   UpdateForm.name_emvis033n);">
        <input type=text size=30 name=name_emvis033n readonly
         >
        <img src=../images/SearchIcon.gif class=Icon 
         onclick="TransferSourceFrame(UpdateForm.emvis033,
                  UpdateForm.name_emvis033n);">
        <img src=../images/erase.gif class=Icon
         onclick="clrFields(UpdateForm.emvis033,UpdateForm.name_emvis033n);">
        </td>
</tr>

</table>
</span>

<form name=HiddenFields method=get style="margin:0">
<input type=hidden name=DischargeComplete value="%EMRWEB02.01.147">
<input type=hidden name=HospitalAdmission value="%EMRWEB02.01.148">
<input type=hidden name=ExpectedUnit value="%EMRWEB02.01.173.1">
<input type=hidden name=ShowOutstanding value="%EMRWEB02.01.474">
</form>
<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=emrgflag value="Y">
<input type=hidden name=nextpage value="4">
<input type=hidden name=MenuType value="11">
<input type=hidden name=webuseid value="%STANDARD.01.008">
</form>
<script type="text/javascript">
if ( document.UpdateForm.deptdate.value == "") {
  document.UpdateForm.deptdate.value="%EMRWEB02.01.233.0";
  document.UpdateForm.depttime.value="%EMRWEB02.01.243";
}
</script>
