<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script>
function checkoverlap(trntodat,trntotim) {
  admissno=UpdateForm.admissno.value.replace(/ /g,"+")
  var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=2" +
                  "&ptmis001="+trntodat.replace(/ /g,"+") +
                  "&ptmis002="+trntotim.replace(/ /g,"+") +
                  "&admissno="+admissno
  var returnValue = RSExecute(serverURL);
  if(returnValue.status==0){
     return true;
  } else {
     return false;
  }
}
function SubmitUpdate() {
  if (UpdateForm.trntodat.value=="") {
      alert("Date is a required field. Please enter it now.");
      return;
  }

  if (UpdateForm.trntotim.value=="") {
      alert("Time is a required field. Please enter it now.");
      return;
  }

  if (UpdateForm.admidate.value!="")  {
    if (!CheckDateRange(UpdateForm.admidate,UpdateForm.trntodat,UpdateForm.admitime,UpdateForm.trntotim,1))  {
       return; }
  }
  if (UpdateForm.dschdate.value!="")  {
    if (!CheckDateRange(UpdateForm.trntodat,UpdateForm.dschdate,UpdateForm.trntotim,UpdateForm.dschtime,2))  {
       return; }
  }
//
if (document.UpdateForm.trandate.value==document.UpdateForm.admidate.value) {
  if (!checkoverlap(document.UpdateForm.trntodat.value,document.UpdateForm.trntotim.value)){
       return; }
  }
if (validateMandatory(UpdateForm)) {
       document.UpdateForm.submit();
  }
}

function CheckDateRange(FromInput,ToInput,FromTime,ToTime,flag)
{
  if (SetDateYYYYMMDD(FromInput.value) > SetDateYYYYMMDD(ToInput.value))
  {
//    alert("Invalid Range Entered " + FromInput.title + " " + ToInput.title);

        if (flag=="1") {
          alert("Date is prior to Admission date. Please review..");
          return false;
        } else {
          alert("Date is after Discharge date. Please review..");
          return false;
        }

    return false ;
  } else {

    if (SetDateYYYYMMDD(FromInput.value) == SetDateYYYYMMDD(ToInput.value)) {

      if (FromTime.value >= ToTime.value) {
        if (flag=="1") {
          alert("Time is prior to Admission time. Please review..");
          return false;
        } else {
          alert("Time is after Discharge time. Please review..");
          return false;
        }
      }
    }
  }

  return true;
}



</script>
</head>

%START.OF.PAGE
<body onload=PageLoad(event);>
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Modify Date & Time
</span>

<div id=PageBodySection>
<form name=UpdateForm method=post action=patweb98.pbl>
 <input type=hidden name=reportno value="10">
 <input type=hidden name=template value="002">
 <input type=hidden name=urnumber value="%PATWEB98.10.003">
 <input type=hidden name=admissno value="%PATWEB98.10.081">
 <input type=hidden name=updttype value="T">
 <input type=hidden name=transkey value="%PATWEB98.10.215">
 <input type=hidden name=trnsupty value="%PATWEB98.10.206">
 <input type=hidden name=admidate value="%PATWEB98.10.302">
 <input type=hidden name=admitime value="%PATWEB98.10.303">
 <input type=hidden name=dschdate value="%PATWEB98.10.401">
 <input type=hidden name=dschtime value="%PATWEB98.10.402">
 <input type=hidden name=trandate value="%PATWEB98.10.213">
<table align=center width=100% border=0>


   <tr><td class=DataLabel> &nbsp; Ward / Bed </td>
       <td class=DataField>%PATWEB98.10.207 </td></tr>

   <tr><td class=DataLabel> &nbsp; Transfer In Date & Time </td>
       <td class=DataField>%PATWEB98.10.213 @ %PATWEB98.10.214</td></tr>

   <tr><td class=DataLabel> &nbsp; Responsible Clinician</td>
       <td class=DataField>%PATWEB98.10.208 </td></tr>

   <tr><td class=DataLabel> &nbsp; %STANDARD.01.017.A </td>
       <td class=DataField>%PATWEB98.10.209 </td></tr>

   <tr><td class=DataLabel> &nbsp; %STANDARD.01.017.CC</td>
       <td class=DataField>%PATWEB98.10.210 </td></tr>

   <tr><td class=DataLabel> &nbsp; %STANDARD.01.017.AC</td>
       <td class=DataField>%PATWEB98.10.211 </td></tr>

   <tr><td class=DataLabel> &nbsp; %STANDARD.01.017.CL</td>
       <td class=DataField>%PATWEB98.10.212 </td></tr>

<tr><td class=DataLabel> &nbsp; Date</td>
    <td><input type=text name=trntodat size=12 class="Mandatory PastDate"
         title="Transfer Date" value="" id=trntodat>
       <img src=../images/DateLookup.gif class=Icon
       onclick="DateLookupFrame(trntodat);">
       Time
       <input type=text name=trntotim size=8 class=Mandatory id=trntotim
         title="Time" value="">
       <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(trntodat,trntotim);">
       <img src="../images/TimeLookup.gif" class=Icon
       onclick="TimeLookupFrame(trntotim);"></td></tr>

   <tr>
      <td class=DataLabel> &nbsp; Reason for Change </td>
      <td><select name=chngreas class=Mandatory title="Reason for Change">
      <option></option>
      %STANDARD.01.021.IZ
      </select>
      </td>
   </tr>



<tr><td colspan=2 align=center><br>
   <input type=button name=updtbutt value="Update" class="button"
    onClick="SubmitUpdate();">
   <input type=button value="Cancel" class="button"
    onClick=DFrameCloseRefresh();>

</td></tr>
</table>
</form>
</div>
