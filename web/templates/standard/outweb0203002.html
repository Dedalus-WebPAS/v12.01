<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/outweb0203.js"></script>
<script type="text/javascript" src="../js/outweb02.js"></script>
<script type="text/javascript">

var SlotCode;
var SlotDate;
var SlotName;

function updateParent(code,name,date,vist,clintcd,clintdes,clinind,clinbst,hic
                      ,carer,letdays,nmds,caret,servd,hrisk,isOverBooked) {
    SlotCode=code
    SlotDate=date
    SlotName=name

    //Clinic Indicator
    if (typeof(AddForm)=='object' && typeof(AddForm.clinindc)=='object') {
      AddForm.clinindc.value=clinind;
    }

    //go to the server for a new set of clinic list that
    //are overbooked

    var clinicVisitList = null;

    if(typeof UpdateForm != 'undefined') {
      if(typeof UpdateForm.outbb047 != 'undefined') {
        clinicVisitList = UpdateForm.outbb047;
      }
    }else if(typeof AddForm != 'undefined' ){
      if(typeof AddForm.outbb047 != 'undefined') {
        clinicVisitList = AddForm.outbb047;
      }
    }

    if(clinicVisitList != null) {
      var serverURL = "../cgi-bin/comweb80.pbl?reportno=61&valdcode=CV" +
                    "&valdsite=" + UpdateForm.d_site.value.replace(/ /g,"+") +
                    "&valdctyp=" + clintcd.replace(/ /g,"+")
      var data = RSExecute(serverURL);
      if(typeof data  != 'undefined'){
        if(data != null) {
          patcodes = eval("("+data.return_value+")");
          //if we get this far lets recreate the clinic visit list

          clinicVisitList.innerHTML = "";
          var option = document.createElement('option');
          option.value = "                 ";
          option.innerHTML = "             ";
          clinicVisitList.appendChild(option);

          if(isOverBooked == "Z") {
            for(var i = 0; i < patcodes.length; i++) {
              if(typeof patcodes[i] != "undefined" && patcodes[i] != null) {
                if( patcodes[i].indicators.substring(2,1) == isOverBooked ) {
                  if( trim(patcodes[i].indicators.substring(6,1)) != "U" ) {
                    var option = document.createElement('option');
                    option.value = patcodes[i].acode+patcodes[i].indicators;
                    option.innerHTML = patcodes[i].tdesc;
                    clinicVisitList.appendChild(option);
                  }
                }
              }
            }
          }else {
            for(var i = 0; i < patcodes.length; i++) {
              if(typeof patcodes[i] != "undefined" && patcodes[i] != null) {
                if( trim(patcodes[i].indicators.substring(6,1)) != "U" ) {
                  var option = document.createElement('option');
                  option.value = patcodes[i].acode+patcodes[i].indicators;
                  option.innerHTML = patcodes[i].tdesc;
                  clinicVisitList.appendChild(option);
                }
              }
            }
          }
        }
      }
    }

    var sendLetter = null;

    if(typeof AddForm != 'undefined') {
      sendLetter = AddForm.outbb047;
    }else if(typeof UpdateForm != 'undefined') {
      sendLetter = UpdateForm.outbb047;
    }

    if(sendLetter != null && typeof sendLetter.onchange != 'undefined') {
     setTimeout(function(){ sendLetter.onchange();},200);
    }

    //New Slot key
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.nslotkey)=='object') {
           AddForm.nslotkey.value=code;
        }

    //visit type
     if(typeof(AddForm)=='object' && AddForm.outbb047.type=='select-one') {
         for (var i =0 ; i < AddForm.outbb047.length; i++) {
         if (trim(AddForm.outbb047.options[i].value.substr(0,3))==trim(vist)) {
           AddForm.outbb047.selectedIndex=i }
         }
        }
    //////
     if(typeof(UpdateForm)=='object' &&
        typeof(UpdateForm.outbb047)=='object') {
       if(UpdateForm.outbb047.type=='select-one') {
         for (var i =0 ; i < UpdateForm.outbb047.length; i++) {
         if (trim(UpdateForm.outbb047.options[i].value.substr(0,3))==trim(vist)) {
           UpdateForm.outbb047.selectedIndex=i }
         }
       }
     }

    /////
    // Added for diagnosis search
    //
    if (typeof(parent.AddForm)=='object' &&
       typeof(parent.AddForm.defclnty)=='object') {
           parent.AddForm.defclnty.value=clintcd;
        }
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.defclnty)=='object') {
           AddForm.defclnty.value=clintcd;
    }
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.outbb016)=='object') {
       AddForm.outbb016.value=clintcd;
    }
    if (typeof(parent.UpdateForm)=='object' &&
       typeof(parent.UpdateForm.defclnty)=='object' &&
       typeof(parent.UpdateForm.follflag)=='object') {
         parent.UpdateForm.defclnty.value=clintcd;
    }
    if (typeof(UpdateForm)=='object' &&
       typeof(UpdateForm.defclnty)=='object' &&
       typeof(UpdateForm.follflag)=='object') {
         UpdateForm.defclnty.value=clintcd;
    }
    if (typeof(UpdateForm)=='object' &&
       typeof(UpdateForm.outbb016)=='object' &&
       typeof(UpdateForm.follflag)=='object') {
         UpdateForm.outbb016.value=clintcd;
    }
    //
    // Clinic using medclaims
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.otmaumci)=='object') {
           AddForm.otmaumci.value=hic;
    }
    //
    // Collect Carer Details
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.otheccar)=='object') {
           AddForm.otheccar.value=carer;
    }
    //
    // Generate letter days
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.othendps)=='object') {
       AddForm.othendps.value=letdays;
    }
    if (typeof(UpdateStatus)=='object' &&
       typeof(UpdateStatus.othendps)=='object') {
       UpdateStatus.othendps.value=letdays;
    }

    // NMDS Code AddForm
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.outbb068)=='object') {
         for (var i =0 ; i < AddForm.outbb068.length; i++) {
             if (trim(AddForm.outbb068.options[i].value.substr(0,3))==
                 trim(nmds)) {
                 AddForm.outbb068.selectedIndex=i }
         }
    }

    // Care Type AddForm
   if (typeof(AddForm)=='object' &&
     typeof(AddForm.outbb069)=='object') {
       for (var i =0 ; i < AddForm.outbb069.length; i++) {
       if (trim(AddForm.outbb069.options[i].value.substr(0,3))==
           trim(caret)) {
           AddForm.outbb069.selectedIndex=i }
       }
   }
   // Service Delivery AddForm
   if (typeof(AddForm)=='object' &&
     typeof(AddForm.outbb070)=='object') {
     for (var i =0 ; i < AddForm.outbb070.length; i++) {
       if (trim(AddForm.outbb070.options[i].value.substr(0,3))==
         trim(servd)) {
         AddForm.outbb070.selectedIndex=i
       }
     }
   }

  // Clinical High Risk AddForm
  if (typeof(AddForm)=='object' &&
    typeof(AddForm.d_outbb071)=='object') {
      if(hrisk=="1") {
        AddForm.d_outbb071.checked=true;
        AddForm.d_outbb071.disabled=true;
      } else {
        AddForm.d_outbb071.checked=false;
        AddForm.d_outbb071.disabled=false;
      }
  }

  // Clinical High Risk UpdateForm
  if (typeof(UpdateForm)=='object' &&
    typeof(UpdateForm.outbb071)=='object') {
      if(hrisk=="1") {
        UpdateForm.outbb071.checked=true;
        UpdateForm.outbb071.disabled=true;
      } else {
        UpdateForm.outbb071.disabled=false;
      }
  }

  // Clinical High Risk UpdateForm
  if (typeof(UpdateForm)=='object' &&
   typeof(UpdateForm.d_outbb071)=='object') {
      if(hrisk=="1") {
        UpdateForm.d_outbb071.checked=true;
        UpdateForm.d_outbb071.disabled=true;
      } else {
        UpdateForm.d_outbb071.disabled=false;
      }
  }

  // Generate letter days
  if (typeof(UpdateForm)=='object' &&
    typeof(UpdateForm.othendps)=='object') {
       UpdateForm.othendps.value=letdays;
  }
  //
  // Generate letter days
  if (typeof(Reschedule)=='object' &&
   typeof(Reschedule.othendps)=='object') {
       Reschedule.othendps.value=letdays;
  }
  //
  //Dummy hidden field for visit type
  if (typeof(AddForm)=='object' &&
    typeof(AddForm.d_outbb047)=='object') {
       AddForm.d_outbb047.value=trim(vist);
  }
  //
  //Dummy hidden field for visit type
  if (typeof(UpdateForm)=='object' &&
    typeof(UpdateForm.d_outbb047)=='object') {
       UpdateForm.d_outbb047.value=trim(vist);
       if(typeof(SendLetterDNA03)== 'function'){
//         ReturnDate.value=SlotDate
         SendLetterDNA03();
       }
  }
  //
  //Dummy hidden field for visit type
  if (typeof(Reschedule)=='object' &&
    typeof(Reschedule.d_outbb047)=='object') {
       Reschedule.d_outbb047.value=trim(vist);
       if(typeof(SendLetterRSH02)== 'function'){
//         ReturnDate.value=SlotDate
         SendLetterRSH02();
       }
  }
  //
  //Dummy hidden field for visit type
  if (typeof(UpdateStatus)=='object' &&
    typeof(UpdateStatus.d_outbb047)=='object') {
       UpdateStatus.d_outbb047.value=trim(vist);
       if(typeof(SendLetterRSH01)== 'function'){
//         ReturnDate.value=SlotDate
         SendLetterRSH01();
       }
  }
  //
  reserveSlot(code,"","","",UpdatePage)
}
function UpdatePage() {
  document.UpdateForm.newslotk.value=SlotCode
  document.UpdateForm.clindesc.value=SlotName
  document.UpdateForm.clindate.value=SlotDate
  document.getElementById('PopUpScreen').style.display="none"
}

function SetPrinter(SelectList) {
 if (SelectList.className=="Mandatory SelectBig") {
     SelectList.className="SelectBig" }
 else {
     SelectList.className="Mandatory SelectBig" }
}

function submitThisPage() {
  if (isWhitespace(UpdateForm.newslotk.value)) {
    SubmitFinal();}
  else {
    checkSlot(UpdateForm.newslotk.value,UpdateForm.urnumber.value,SubmitFinal);}
}
function SendLetterDNA03() {
  theForm=document.UpdateForm
  validateCatCode(theForm.cat_CV,theForm.d_outbb047,theForm.d_outbb047_des,theForm.d_outbb047_ind)
  if(theForm.d_outbb047_ind.value.substr(7,1) == "C" ||
    (SetDateYYYYMMDD(theForm.clindate.value.substr(4,11)) <
     SetDateYYYYMMDD(theForm.currdate.value))) {   // Ind 8 - Chart Only or
    theForm.outbb067.selectedIndex=3;              // new booking less than
    theForm.outbb067.className="Readonly";         // today set send letter
    theForm.outbb067.disabled=true;                // N/A
  } else {
    if(theForm.outbb067.disabled==true) {          // Defalut send letter to
       theForm.outbb067.selectedIndex=0;           // Blank when re enabled
    }
    theForm.outbb067.className="";
    theForm.outbb067.disabled=false;
    theForm.outbb067.className="";
  }
  SendLetterDate(theForm);
}
function SendLetterDate(theForm) {
  if(theForm.outbb067.value=="1") {                // Yes Send Letter
    theForm.outbb066.className="Mandatory FutureDate";
    theForm.outbb066.readOnly=false;
    if(isWhitespace(theForm.outbb066.value)) {     // Calculate Letter Date
      CalculateLetterDate03(theForm)
    }
  } else {
    theForm.outbb066.className="Readonly Date";
    theForm.outbb066.value="";
    theForm.outbb066.readOnly=true;
  }
}
function SubmitFinal() {
  p = document.UpdateForm;
  if (p.copycomm.checked==true) {
    p.copydnac.value = 1;
  }
  else {
   p.copydnac.value = 0;
  }
    
  if (!validateMandatory(UpdateForm)) {
     return;}

  if (UpdateForm.outbb071!=undefined) {
      UpdateForm.outbb071.disabled=false;
  }
  if (document.UpdateForm.ptcnhdps.value=="3") {
      addContactRedirect();
  } else if (document.UpdateForm.ptcnhdps.value=="1" &&
             document.PatientLinks.othecenc.value == "2") {
      addContactRedirect();
  } else {
      RequestAppRedirect();
  }

//*T0857147-Start
  if (document.UpdateForm.outbb035.selectedIndex > 0) {
    var selOutcome = document.UpdateForm.outbb035;
    var indc4 = selOutcome.value.substr(6,1);  // Outcome indicator 4

    if (!isWhitespace(PatientLinks.refrvisn.value) &&
        !isWhitespace(PatientLinks.refrdept.value) && (indc4=="C")){
      // Redirect to 'Close Referral' screen if appointment is linked to a
      // referral
      document.UpdateForm.nextpage.value="1";
      document.UpdateForm.redirect.value="allweb02.pbl?reportno=2&template=004"
         + "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
         + "&admissno=" + PatientLinks.refrvisn.value.replace(/ /g,"+")
         + "&deptcode=" + PatientLinks.refrdept.value.replace(/ /g,"+");
    }
  }
//*T0857147-End

  UpdateForm.submit();
}

function GetAppointmentKeyCookie() {
//  alert(GetCookieData("appointmentkeycookie"));
  if (GetCookieData("appointmentkeycookie") != "unknown" &&
      !isWhitespace(GetCookieData("appointmentkeycookie"))) {
    appointmentkeycookie = GetCookieData("appointmentkeycookie").split("|");
    ExpireCookiePath("appointmentkeycookie");
    updateParent(appointmentkeycookie[0],appointmentkeycookie[1],
                 appointmentkeycookie[2],appointmentkeycookie[3],
                 appointmentkeycookie[4],appointmentkeycookie[5],
                 appointmentkeycookie[6],appointmentkeycookie[7],
                 appointmentkeycookie[8],appointmentkeycookie[9],
                 appointmentkeycookie[10],appointmentkeycookie[11],
                 appointmentkeycookie[12],appointmentkeycookie[13],
                 appointmentkeycookie[14],appointmentkeycookie[15]);

  }
}
function DefAddedSlot() {
  if(!isWhitespace(document.UpdateForm.d_addslotk.value)) {
    document.UpdateForm.newslotk.value=document.UpdateForm.d_addslotk.value
    document.UpdateForm.clindesc.value=document.UpdateForm.d_addslotk_desc.value
    document.UpdateForm.clindate.value=document.UpdateForm.d_addslotk_date.value
//
//    for (var i =0 ; i < document.UpdateForm.outbb047.length; i++) {
//    if (document.UpdateForm.outbb047.options[i].value.substr(0,3)==
//        document.UpdateForm.d_addslotk_vtype_c.value.substr(0,3)) {
//        document.UpdateForm.outbb047.selectedIndex=i
//    } };
//
    document.UpdateForm.othendps.value=document.UpdateForm.d_addslotk_othendps.value
//    document.UpdateForm.otheclhr.value=document.UpdateForm.d_addslotk_otheclhr.value
  }
}
function CheckRequestApp() {
  if (document.UpdateForm.otcnureq.value == "1" &&
      !isWhitespace(document.UpdateForm.alrevisn.value)) {
    RequestAppointment.innerHTML=ShowRequestAppointment.innerHTML;
  } else {
    RequestAppointment.innerHTML="";
  }
}
function MandReason(req) {
  if(req.checked == true) {
     document.UpdateForm.otart021.className="SelectBig Mandatory";
  } else {
     document.UpdateForm.otart021.className="SelectBig";
  }
}
function RequestAppRedirect() {
  if(document.UpdateForm.requesta == undefined ){
    return;
  }
  if(document.UpdateForm.requesta.checked != true ) {
    return;
  }
  SetCookie("apptcommcookie",document.UpdateForm.apptcomm.value);
  document.UpdateForm.nextpage.value="6";
  document.UpdateForm.redirect.value="outweb08.pbl?reportno=8&template=001" +
          "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
          "&admissno=" + UpdateForm.alrevisn.value.replace(/ /g,"+")
}


</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DefAddedSlot();GetAppointmentKeyCookie();
              CheckRequestApp();">
<span class=DFrameTitleBar>
<img align=right src="../images/ExitIcon.gif" onclick="AppFrameExit()">
Input Non Attendance Details - %OUTWEB02.03.618.1 - %OUTWEB02.03.002 - -  Visit No. %OUTWEB02.03.081
</span>
<div id=PageBodySection style="overflow: auto;">
<form action=outweb02.pbl method=post name=UpdateForm style="margin:0">
<input type=hidden name=reportno id=reportno value="4">
<input type=hidden name=redirect id=redirect value="%OUTWEB02.03.001.outweb02.03.002">
<input type=hidden name=nextpage id=nextpage value="">
<input type=hidden name=updatety id=updatety value="2">
<input type=hidden name=casekeys id=casekeys value="%OUTWEB02.03.366">
<input type=hidden name=urnumber id=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=defclnty id=defclnty value="%OUTWEB02.03.308">
<input type=hidden name=defclnid id=defclnid value="%OUTWEB02.03.303.0">
<input type=hidden name=defvisty id=defvisty value="%OUTWEB02.03.310.1">
<input type=hidden name=clinctyp id=clinctyp value="%OUTWEB02.03.605.1">
<input type=hidden name=othendps id=othendps value="%OUTWEB02.03.658">
<input type=hidden name=currdate id=currdate value="%STANDARD.01.015">
<input type=hidden name=d_outbb047 id=d_outbb047 value="">
<input type=hidden name=cat_CV id=cat_CV value="CV">
<input type=hidden name=d_outbb047_des id=d_outbb047_des value="">
<input type=hidden name=d_outbb047_ind id=d_outbb047_ind value="">
<input type=hidden name=refrdate id=refrdate value="%OUTWEB02.03.632">
<input type=hidden name=alrevisn id=alrevisn value="%OUTWEB02.03.646">
<input type=hidden name=deftovrd id=deftovrd value="">
<input type=hidden name=slotbtyp id=slotbtyp value="5">
<input type=hidden name=d_addslotk id=d_addslotk value="%OUTWEB02.03.674">
<input type=hidden name=d_addslotk_desc id=d_addslotk_desc value="%OUTWEB02.03.675.3">
<input type=hidden name=d_addslotk_date id=d_addslotk_date value="%OUTWEB02.03.675.2">
<input type=hidden name=d_addslotk_vtype_c id=d_addslotk_vtype_c value="%OUTWEB02.03.675.5.3">
<input type=hidden name=d_addslotk_othendps id=d_addslotk_othendps value="%OUTWEB02.03.675.6.035">
<input type=hidden name=d_addslotk_otheclhr id=d_addslotk_otheclhr value="%OUTWEB02.03.675.6.042">
<input type=hidden name=ptcnhdps id=ptcnhdps value="%STANDARD.01.025.080.250.1.1">
<input type=hidden name=otcnureq id=otcnureq value="%STANDARD.01.025.032.136.0.1">
<input type=hidden name=otart001 id=otart001 value="%OUTWEB02.03.003">
<input type=hidden name=otart002 id=otart002 value="%OUTWEB02.03.646">
<input type=hidden name=apptcomm id=apptcomm value="%OUTWEB02.03.377">
<input type=hidden name=copydnac id=copydnac value="1">
<input type=hidden name=d_site id=d_site value="%STANDARD.01.023">

<table cellspacing=0 cellpadding=0 border=0 width=95% align=center>
<tr><td class=DataLabel width=15%>Outcome </td>
    <td width=35%><select name=outbb035 id=outbb035 class=SelectBig>
	<option></option>
	%OUTWEB02.03.354.2
	</select></td></tr>

<tr><td class=DataLabel>Non Attendance Reason</td>
    <td><select name=outbb005 id=outbb005 class="SelectBig Mandatory"
                title="Non Attendance Reason">
	<option></option>
	%OUTWEB02.03.324.2
	</select></td></tr>

<tr>
   <td><table border=0 width=100% class=TableBody cellpadding=0
        cellspacing=0>
   <tr><td class=DataLabel>Comments</td></tr>
   <tr><td colspan=6 align=left>
       <input type=button value="Add" class="button"
        name="AddComm" id="AddComm"
        onclick="tempDisable(this);AddComment();"></td></tr>
   <tr><td>&nbsp;</td></tr>
   <tr><td>&nbsp;</td></tr>
   </table></td>
   <td colspan=6 align=left>
      <textarea wrap=hard name=outptcoa id=outptcoa class=Readonly readonly
       rows=4 cols=70>%OUTWEB02.03.327.016.005</textarea></td>
</tr>

<tr><td class=DataLabel>Print DNA Letter</td>
    <td><input type=checkbox name=letprt10 id=letprt10 value="1" checked
         onclick="SetPrinter(UpdateForm.letpsl10);"></td>
    <td class=DataLabel width=8%>Printer</td>
    <td><select name=letpsl10 id=letpsl10 class="Mandatory SelectBig" title="Printer">
        <option></option>
        %STANDARD.01.001.OUTWEB03.02
        </select></td></tr>

<tr><td class=DataLabel>Other Letter</td>
    <td><input type=checkbox name=letprt11 id=letprt11 value="1"
         onclick="SetPrinter(UpdateForm.letpsl11);">
        Letter
        <select name=lettyp11 id=lettyp11 class="SelectBig" title="Letter">
        <option></option>
        %OUTWEB02.03.642
        </select></td>
    <td class=DataLabel>Printer</td>
    <td><select name=letpsl11 id=letpsl11 class="SelectBig" title="Printer">
        <option></option>
        %STANDARD.01.001.LETTROUT.11
        </select></td></tr>
</table>

<div id=RequestAppointment></div>

<table cellspacing=0 cellpadding=0 border=0 width=95% align=center>
<tr><td class=HeadingCell align=center colspan=4 width=100%>
     Discharge Details</td></tr>

<tr><td class=DataLabel>Discharge Status </td>
    <td><select name=outbb050 id=outbb050 class=SelectBig>
	 <option></option>
	 %OUTWEB02.03.319.2
	 </select></td></tr>

<tr><td class=DataLabel>Presenting Complaint</td>
    <td class=DataField colspan=3>
    <input type=text name=pmsvx052 id=pmsvx052 size=50 maxlength=50                        
      value="%OUTWEB02.03.852"></td></tr>

<tr><td class=DataLabel>Diagnosis</td>
    <td colspan=3>
    <input type=text name=outbb045 id=outbb045 size=12 value="%OUTWEB02.03.364"
     onblur="validateCode(6,UpdateForm.outbb045,UpdateForm.outbb046);">
    <input type=text name=outbb046 id=outbb046 size=70 readonly class=Readonly
     value="%OUTWEB02.03.365">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb045,UpdateForm.outbb046);">
    <img src="../images/LookupIcon.gif" class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb045,UpdateForm.outbb046);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td colspan=3>
    <input type=text name=outbb055 id=outbb055 size=12 value="%OUTWEB02.03.379"
     onblur="validateCode(6,UpdateForm.outbb055,UpdateForm.outbb056);">
    <input type=text name=outbb056 id=outbb056 size=70 readonly class=Readonly 
                                                  value="%OUTWEB02.03.380">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb055,UpdateForm.outbb056);">
    <img src="../images/LookupIcon.gif" class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb055,UpdateForm.outbb056);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td colspan=3>
    <input type=text name=outbb057 id=outbb057 size=12 value="%OUTWEB02.03.381"
     onblur="validateCode(6,UpdateForm.outbb057,UpdateForm.outbb058);">
    <input type=text name=outbb058 id=outbb058 size=70 readonly class=Readonly 
                                                   value="%OUTWEB02.03.382">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb057,UpdateForm.outbb058);">
    <img src="../images/LookupIcon.gif" class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb057,UpdateForm.outbb058);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td colspan=3>
    <input type=text name=outbb059 id=outbb059 size=12 value="%OUTWEB02.03.383"
     onblur="validateCode(6,UpdateForm.outbb059,UpdateForm.outbb060);">
    <input type=text name=outbb060 id=outbb060 size=70 readonly class=Readonly 
                                                   value="%OUTWEB02.03.384">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb059,UpdateForm.outbb060);">
    <img src="../images/LookupIcon.gif" class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb059,UpdateForm.outbb060);">
    </td></tr>

<tr><td class=HeadingCell align=center colspan=4 width=100%>
     New Appointment Details</td></tr>

<tr><td class=DataLabel>Clinic</td>
    <td><input type=hidden name=newslotk id=newslotk>
        <input type=text size=30 name=clindesc id=clindesc readonly>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="ResetLetter(UpdateForm);AppointSearch();">
        <img src="../images/LookupIcon.gif" class=Icon
         onclick="ResetLetter(UpdateForm);ClinicSearch();">
    </td></tr>

<tr><td class=DataLabel>Date</td>
    <td><input type=text size=30 name=clindate id=clindate>
     </td></tr>

<tr><td class=DataLabel>Send Letter</td>
    <td><select name=outbb067 id=outbb067 title="Send Letter"
         onchange="SendLetterDate(UpdateForm);">
        <option></option>
        <option value="0">No</option>
        <option value="1">Yes</option>
        <option value="2">N/A</option>
        </select></td>
    <td class=DataLabel>Generate Letter Date</td>
    <td><input type=text name=outbb066 id=outbb066 size=12
     onblur="checkDate(this,this.title)" value=""
     class="Date" title="Generate Letter Date">
    <img src="../images/DateTimeStamp.gif" class=Icon
     onclick="SetCurrentDateTime(UpdateForm.outbb066,null);">
    <img src="../images/DateLookup.gif" class=Icon
     onclick="DateLookupFrame(UpdateForm.outbb066)"></td>
</tr>
<tr colspan=4><td class=DataLabel>Copy Comments</td>
    <td><input type=checkbox name=copycomm id=copycomm value="1"></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>
</table>

<div id=ShowLinkRef></div>

<table cellspacing=0 cellpadding=0 border=0 width=95% align=center>
<tr><td align=center>
    <input type=button class="button" value="Ok" id="out02sub"
     onclick="tempDisable(this);submitThisPage();">
    <input type=button class="button" Value="Cancel"
     onclick="AppFrameExit()"></td></tr>
</table>
</form>
</div>

<span id=linkreferral style="display:none">
<table border=0 width=95% cellspacing=0 cellpadding=1 align=center>
<tr><td class=DataLabel width=15%>Link Referral Details</td>
    <td><input type=checkbox checked value=1 name=linkrefr id=linkrefr
         title="Link referral details"></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    </tr>
</table>
</span>

<div id=ShowRequestAppointment style="display: none">
<table cellspacing=0 cellpadding=0 border=0 width=95% align=center>
<tr><td width=15% class=DataLabel>Request Appointment</td>
    <td width=35%>
    <input type=checkbox value=1 name="requesta" id="requesta"
     onclick="MandReason(this);">
    </td>
    <td width=8%>Reason</td>
    <td>
    <select class="SelectBig" name=otart021 id=otart021
     title="Reason for Request">
    <option></option>
     %STANDARD.01.007.VU
    </select>

    </td>
    </tr>
</table>
</div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno id=reportno value=1>
<input type=hidden name=template id=template value=004>
<input type=hidden name=urnumber id=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=admissno id=admissno value="%OUTWEB02.03.081">
<input type=hidden name=MenuType id=MenuType value="%OUTWEB02.03.088">
<input type=hidden name=casekeys id=casekeys value="%OUTWEB02.03.366">
<input type=hidden name=othecenc id=othecenc value="%OUTWEB02.03.640.030">
<input type=hidden name=alrevisn id=alrevisn value="%OUTWEB02.03.646">
<input type=hidden name=alenenct id=alenenct value="%OUTWEB02.03.647">
<input type=hidden name=alredept id=alredept value="%OUTWEB02.03.648">
<input type=hidden name=noaddenc id=noaddenc value="1">
<input type=hidden name=refrvisn id=refrvisn value="%OUTWEB02.03.682">
<input type=hidden name=refrdept id=refrdept value="%OUTWEB02.03.683">
</form>

<script type="text/javascript">
DisplayReferral();
document.UpdateForm.copycomm.checked = true;
</script>
