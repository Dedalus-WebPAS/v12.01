<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function linkPatient(Urnumber,VisitNo,VisitType,SecOpt,Casekeys,Site,AAEFlag) {
if (VisitType=="7") {
   document.PatientLinks.action="patweb89.pbl"
   document.PatientLinks.reportno.value="1"
   document.PatientLinks.template.value="20"
   document.PatientLinks.admissno.value=VisitNo
   document.PatientLinks.urnumber.value=Urnumber
//   document.PatientLinks.target="content"
   document.PatientLinks.submit()
}
if (VisitType=="3") {
   document.PatientLinks.action="patweb98.pbl"
   document.PatientLinks.reportno.value="1"
   document.PatientLinks.template.value="2"
   document.PatientLinks.admissno.value=VisitNo
   document.PatientLinks.urnumber.value=Urnumber
//   document.PatientLinks.target="content"
   document.PatientLinks.submit()
}
if (VisitType=="2") {
   if(document.UpdateForm.outpsite.value!=Site) {
     alert("Invalid Outpatient Site Security.")
     return;
   }
   document.PatientLinks.action="outweb02.pbl"
   document.PatientLinks.reportno.value="3"
   document.PatientLinks.template.value="1"
   document.PatientLinks.admissno.value=VisitNo
   document.PatientLinks.urnumber.value=Urnumber
//   document.PatientLinks.target="content"
   document.PatientLinks.submit()
}
if (VisitType=="4") {
   if(document.UpdateForm.outpsite.value!=Site) {
     alert("Invalid Outpatient Site Security.")
     return;
   }
   document.PatientLinks.action="outweb02.pbl"
   document.PatientLinks.reportno.value="3"
   document.PatientLinks.template.value="015"
   document.PatientLinks.admissno.value=VisitNo
   document.PatientLinks.urnumber.value=Urnumber
   document.PatientLinks.submit()
}
if (VisitType=="1") {
   if (AAEFlag=="1") {
     document.PatientLinks.action="patweb98.pbl"
     document.PatientLinks.reportno.value="1"
     document.PatientLinks.template.value="070"
     document.PatientLinks.admissno.value=VisitNo
     document.PatientLinks.urnumber.value=Urnumber
     document.PatientLinks.submit()
   } else {
     if (top.location.pathname.match(/EmergencyMap/g)) {
       document.PatientLinks.action="emrweb02.pbl"
       document.PatientLinks.reportno.value="1"
       document.PatientLinks.template.value="100"
       document.PatientLinks.admissno.value=VisitNo
       document.PatientLinks.urnumber.value=Urnumber
       document.PatientLinks.submit()
     } else {
       document.PatientLinks.action="emrweb02.pbl"
       document.PatientLinks.reportno.value="1"
       document.PatientLinks.template.value="021"
       document.PatientLinks.admissno.value=VisitNo
       document.PatientLinks.urnumber.value=Urnumber
       document.PatientLinks.submit()
     }
  }
}
if (VisitType=="8") {
   document.PatientLinks.action="watweb01.pbl"
   document.PatientLinks.reportno.value="2"
   document.PatientLinks.template.value="001"
   document.PatientLinks.admissno.value=VisitNo
   document.PatientLinks.urnumber.value=Urnumber
   document.PatientLinks.casekeys.value=Casekeys
//   document.PatientLinks.target="content"
   document.PatientLinks.submit()
}
if (VisitType=="6") {
   alert("This is a community health visit.  Details not available");
}

if (VisitType=="9") {
    if(SecOpt=="2")
       {
          document.PatientLinks.action="patweb81.pbl"
          document.PatientLinks.reportno.value="1"
          document.PatientLinks.template.value="1"
          document.PatientLinks.admissno.value=VisitNo
          document.PatientLinks.urnumber.value=Urnumber
//          document.PatientLinks.target="content"
          document.PatientLinks.submit()
        }
   if(SecOpt=="0")
     {
        document.PatientLinks.action="allweb02.pbl"
        document.PatientLinks.reportno.value="2"
        document.PatientLinks.template.value="1"
        document.PatientLinks.admissno.value=VisitNo
        document.PatientLinks.urnumber.value=Urnumber
//        document.PatientLinks.target="content"
        document.PatientLinks.submit()
      }
   if(SecOpt!=="0"&SecOpt!=="2")
      {
       alert("Screen is not viewable by all departments")
      }
}
}
function ShowVisits() {
  document.UpdateForm.submit();
}
function ResetSearch() {
    serverURL   = "../cgi-bin/patweb98.pbl?reportno=01&template=254" +
                  "&filtvtyp=" + UpdateForm.filtvtyp.value +
                  "&norecord=" + UpdateForm.norecord.value +
                  "&admissno=" + UpdateForm.admissno.value.replace(/ /g,"+") +
                  "&urnumber=" + UpdateForm.urnumber.value.replace(/ /g,"+") 
    location.href=serverURL
}
function LinkMedicalRec(VisitNo,Urnumber) {
  LinkUrl="mrtweb01.pbl?reportno=18&template=002" + 
          "&admissno=" + VisitNo.replace(/ /g,"+") +
          "&urnumber=" + Urnumber.replace(/ /g,"+")
  Left=(document.body.clientWidth-700)/2;
  DFrameLink(LinkUrl,50,Left,700,540);
}
function AddMedicalRecLink(Urnumber) {
  var RecordFlag=false
  for (var e = 0; e < document.all.length; e++) {
   if(document.all[e].name!=undefined) {
    var el=document.all[e] ;
      if (el.name.match(/lnkadmis/)){
         if(el.checked==true) {
           var RecordFlag=true;
         }
      }
   }
  }
  if(RecordFlag==false) {
    alert("Error : No visits have been selected");
    return;
  }
  LinkUrl="mrtweb01.pbl?reportno=18&template=001" + 
          "&urnumber=" + Urnumber.value.replace(/ /g,"+")
  Left=(document.body.clientWidth-700)/2;
  DFrameLink(LinkUrl,50,Left,700,340);
}
function MarkMedicalRec() {
  for (var e = 0; e < document.all.length; e++) {
   if(document.all[e].name!=undefined) {
    var el=document.all[e] ;
      if (el.name.match(/lnkadmis/)){
         if(el.checked==true) {
           el.checked=false;
         } else {
           el.checked=true;
         }
      }
   }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload=PageLoad(event);>
<div id=HeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB98.01.003";
PatientVIS="%PATWEB98.01.081";
PatientNAM="%PATWEB98.01.002";
PatientSTA="%PATWEB98.01.086.078";
PatientALT="%PATWEB98.01.084";
PatientSEX="%PATWEB98.01.019";
PatientDOB="%PATWEB98.01.020";
PatientAGE="%PATWEB98.01.021";
PatientLOC="%PATWEB98.01.083";
PatientPRI="%PATWEB98.01.086.066.1";
PatientUNT="%PATWEB98.01.066.0";
DoctorCOD="%PATWEB98.01.082.003";
DoctorNAM="%PATWEB98.01.082.002";
PatientAID="%PATWEB98.01.086.090";
PatientIND="%PATWEB98.01.086.091";
PatientCUR="%PATWEB98.01.086.092";
PatientCLC="%PATWEB98.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB98.01.086.094";
PatientCDM="%PATWEB98.01.086.095";
PatientVDH="%PATWEB98.01.086.099.015";
InsertPatientHeader()
</script>


<div id=PatientMenu></div>
<form name=UpdateForm action=patweb98.pbl style="margin:0">
<input type=hidden name=reportno value="1">
<input type=hidden name=template value="254">
<input type=hidden name=urnumber value="%PATWEB98.01.003">
<input type=hidden name=admissno value="%PATWEB98.01.081">
<input type=hidden name=norecord value="10">
<input type=hidden name=outpsite value="%STANDARD.01.023">

<table cellspacing=0 cellpadding=0 border=1 width=100% class=HeadingCell>
<tr><td align=right class=HeadingCell>Visit Type
     <select class=PMenuSelectList name=filtvtyp onchange='ShowVisits();'>
     <option></option>
     <option value="1">All</option>
     <option value="2">Inpatient</option>
     <option value="3">Outpatient</option>
     <option value="4">Emergency</option>
     <option value="5">Theatre Bookings</option>
     <option value="6">Referrals</option>
     <option value="7">Events</option>
     <option value="8">Waiting Lists</option>
     <option value="9">Cancelled Admissions</option>
     <option value="12">All Cancelled Events</option>
     <option value="10">All Site Outpatient Bookings</option>
     </select>
    <input type=button value=Select name=Mark onclick="MarkMedicalRec();">
    </td></tr>
</table>

<table cellspacing=0 cellpadding=2 border=1 width=100%>
<tr><td class=HeadingCell width=25%>Admission/Visit Date</td>
    <td class=HeadingCell width=5%>Day</td>
    <td class=HeadingCell width=5%>Type</td>
    <td class=HeadingCell width=5%>Unit</td>
    <td class=HeadingCell width=15%>HCP</td>
    <td class=HeadingCell width=10%>Location</td>
    <td class=HeadingCell width=5%>Ins Class</td>
    <td class=HeadingCell width=15%>Status</td>
    <td class=HeadingCell width=10%>Visit No</td>
    <td class=HeadingCell width=5%>Med Rec</td>
</tr>

%PATWEB98.01.327.0.0.0.1.0
</table>

<table cellspacing=0 cellpadding=0 border=0 width=100% bgcolor=#CCCCCC>
<tr><td align=center >
    <input type=button value="Previous" class="button"
     onclick='location.href="%PATWEB98.01.328.254"'>
    <input type=button value="Start" class="button"
     onclick="ResetSearch();">
    <input type=button value="Link Record" class="button"
     onclick="AddMedicalRecLink(UpdateForm.urnumber);">
    <input type=button value="Next" class="button"
     onclick='location.href="%PATWEB98.01.329.254"'>
    </td></tr>
</table>
</form>
</div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB98.01.003">
<input type=hidden name=admissno value="%PATWEB98.01.081">
<input type=hidden name=casekeys value="">
<input type=hidden name=MenuType value="%PATWEB98.01.088">
</form>
<script type="text/javascript">
//
 FilterVis="%PATWEB98.01.330";
 for (var i =0 ; i < document.UpdateForm.filtvtyp.length; i++) {
  if (document.UpdateForm.filtvtyp.options[i].value==trim(FilterVis)) {
       document.UpdateForm.filtvtyp.selectedIndex=i } };
//
</script>
