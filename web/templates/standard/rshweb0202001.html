<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function ViewReport() {
ViewWin=window.open("","ViewWindow",
"top=0,left=0,width=790,height=auto,directories=no,location=no," +
"scrollbars=yes,menubar=yes,status=no,toolbar=yes,resizable=yes")
ViewForm.target="ViewWindow"
document.ViewForm.submit()
}

function updateDescription() {
  var schddesc = document.getElementById('schddesc');
  var descchng = document.getElementById('descchng');
  var schdescr = document.getElementById('schdescr');

  if(validateMandatory(UpdateForm)) {
    schddesc.value = schdescr.value;
    setFormactn('U');
    DFrameExit();
  }
}
function PageLoadExtended() {
  PageLoad();
  loadInputFields();
}
function displayPrinter() {
  var p = document.UpdateForm;
  if (p.d_smsprnt.value == p.d_wbscprin.value) {
    OptPrinter.innerHTML = smsPrinter.innerHTML;
  }
  else {
    OptPrinter.innerHTML = normalPrinter.innerHTML;
  }
}
function disableDeleteButton() {
  if(UpdateForm.schdperm.checked==true) {
    document.getElementById("deleteBtn").disabled=true;
  } else {
    document.getElementById("deleteBtn").disabled=false;
    checkSecurityLevels();
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoadExtended();SetCopies();displayPrinter();
              checkSecurityLevels();disableDeleteButton();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
%RSHWEB02.02.007
</span>
<script type="text/javascript">

SCHHDESC="%RSHWEB02.02.007";

function loadInputFields() {
   var schdescr = document.getElementById('schdescr');
   schdescr.value = SCHHDESC.replace(/^\s+|\s+$/g, '');;
}
</script>

<form name=ViewForm method=get action=rshweb02.pbl style="margin:0">
<input type=hidden name=reportno value="5">
<input type=hidden name=template value="001">
<input type=hidden name=schdcode value="%RSHWEB02.02.001">
</form>

<form name=UpdateForm method=post action=rshweb02.pbl style="margin:0">
<input type=hidden name=reportno value="2">
<input type=hidden name=template value="001">
<input type=hidden name=updttype value="">
<input type=hidden name=schdcode value="%RSHWEB02.02.001">
<input type=hidden id="descchng" name=descchng value="0">
<input type=hidden id="schddesc" name=schddesc value="%RSHWEB02.02.007">
<input type=hidden name=d_wbscprin value="%RSHWEB02.02.029.0">
<input type=hidden name=d_smsprnt value="%STANDARD.01.025.124.105.0.6">

<table align=center width=90% border=0 cellspacing=0 cellpadding=1>
<tr><td class=DataLabel width=25%>Schedule Number</td>
    <td class=DataField colspan=3>%RSHWEB02.02.001</td></tr>

<tr><td class=DataLabel width=20%>Report Description</td>
    <td class=DataField colspan=3>
     <input class="Mandatory" title="Report Description" 
      name="schdescr" id="schdescr" type="text" size="50">
    </td></tr>

<tr><td class=DataLabel>Status</td>
    <td class=DataField>%RSHWEB02.02.002</td>
    <td class=DataLabel>UniCare Program ID </td>
    <td class=DataField>%RSHWEB02.02.008</td></tr>
<tr><td class=DataLabel>User</td>
    <td class=DataField>%RSHWEB02.02.009</td>
    <td class=DataLabel>Output Type  </td>
    <td class=DataField>%RSHWEB02.02.015</td></tr>
<tr><td class=DataLabel>Requested </td>
    <td class=DataField>%RSHWEB02.02.010 at %RSHWEB02.02.011</td>
    <td class=DataLabel>Started</td>
    <td class=DataField>%RSHWEB02.02.012 at %RSHWEB02.02.013 </td></tr>
<tr><td class=DataLabel>Spool File Name</td>
    <td class=DataField colspan=3>%RSHWEB02.02.020</td></tr>

<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel colspan=3>
    <input type=text name=schddate id=schddate size=12 value="%RSHWEB02.02.003"
     onblur="checkDate(this,'Schedule Date');">  
    <img src="../images/DateLookup.gif" class="Icon"
     onclick="DateLookupFrame(schddate);">
    Time
    <input type=text name=schdtime id=schdtime size=12 title="Schedule Time" 
     value="%RSHWEB02.02.004">
    <img src="../images/DateTimeStamp.gif" class="Icon"
     onclick="SetCurrentDateTime(schddate,schdtime);">
    <img src="../images/TimeLookup.gif" class="Icon"
     onclick="TimeLookupFrame(schdtime);">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><div id=OptPrinter></div></td>
</tr>

<tr><td class=DataLabel>Re-schedule Type</td>
    <td class=DataLabel colspan=3>
    <select name=schdrdat>
    <option></option>
    <option value="O1O0O0">Daily</option>
    <option value="O7O0O0">Weekly</option>
    <option value="O14O0O0">Fortnightly</option>
    <option value="O0O1O0">Monthly</option>
    <option value="O0O3O0">Quarterly</option>
    <option value="A1O1O0">Start of Month</option>
    <option value="EO1O0">End of Month</option>
    <option value="A1O3O0">Start of Quarter</option>
    <option value="EO3O0">End of Quarter</option>
    </select>
     Exclude Pub. Hol. 
     <input type=checkbox name=exceptpb value=1>
     Mon-Sun 
     <input type=checkbox name=exceptmo value=1>
     <input type=checkbox name=excepttu value=1>
     <input type=checkbox name=exceptwe value=1>
     <input type=checkbox name=exceptth value=1>
     <input type=checkbox name=exceptfr value=1>
     <input type=checkbox name=exceptsa value=1>
     <input type=checkbox name=exceptsu value=1>
    </td></tr>

<tr><td class=DataLabel>Re-schedule Until Date</td>
    <td class=DataLabel colspan=3>
    <input type=text name=schdrend id=schdrend size=12 
     value="%RSHWEB02.02.024"
     onblur="checkDate(this,'Re-schedule Until Date');">  
    <img src="../images/DateTimeStamp.gif" class="Icon"
     onclick="SetCurrentDateTime(schdrend,null);">
    <img src="../images/DateLookup.gif" class="Icon"
     onclick="DateLookupFrame(schdrend);">
    </td></tr>

<tr><td class=DataLabel>Mark as Permanent</td>
    <td colspan=3><input type=checkbox value="1" name=schdperm
     onclick="disableDeleteButton();">
    </td></tr>
<tr>
  <td class=DataLabel width=25%>No of Copies</td>
  <td width=20%>
    <select name=schdcopy title="Number of Copies" class=Mandatory></select>
  </td>
</tr>
<tr><td class=DataLabel width=25%>Security Level</td>
    <td class=DataField>%RSHWEB02.02.032</td>
</tr>
</table>
<br>
<table align=center width=90% border=0 cellspacing=0 cellpadding=1>
<tr>
  <td colspan=4 align=center>
  <input type=button value=Keystrokes class="button" onclick="ShowKeystrokes();">
  <input type=button value=Update class="button" onclick="updateDescription();">
  <input type=button value=View class="button" onclick="ViewReport();">
  <input type=button value=Delete id="deleteBtn"
   class="button" onclick="setFormactn('D');">
  <input type=button value=Close class="button" onclick='DFrameExit();'>
</td></tr>
</table>
</form>

<span id=smsPrinter style="display:none">
  <input type=text name=d_schdprntdesc title="Printer" readonly class="Readonly"
         value="%RSHWEB02.02.029.1">
  <input type=hidden name=schdprnt value="%RSHWEB02.02.029.0">
</span>

<span id=normalPrinter style="display:none">
  <select name=schdprnt>
      <option></option>
        %RSHWEB02.02.019
  </select>
</span>

<script type="text/javascript">
SetReportCopies(document.UpdateForm.schdcopy,50);
Permanent="%RSHWEB02.02.025"
if (Permanent=="Yes") { 
  document.UpdateForm.schdperm.checked=true 
  document.getElementById("deleteBtn").disabled=true;
}
Reschedule="%RSHWEB02.02.023"
Reschedule=Reschedule.replace(/ /g,"")
for (i=0;i<document.UpdateForm.schdrdat.length;i++) {
  if (document.UpdateForm.schdrdat.options[i].value==Reschedule) {
      document.UpdateForm.schdrdat.options[i].selected=true } }
ExcludeFlags="%RSHWEB02.02.026"
if (ExcludeFlags.substr(0,1)=="1") {
  document.UpdateForm.exceptpb.checked=true } 
if (ExcludeFlags.substr(1,1)=="1") {
  document.UpdateForm.exceptmo.checked=true } 
if (ExcludeFlags.substr(2,1)=="1") {
  document.UpdateForm.excepttu.checked=true } 
if (ExcludeFlags.substr(3,1)=="1") {
  document.UpdateForm.exceptwe.checked=true } 
if (ExcludeFlags.substr(4,1)=="1") {
  document.UpdateForm.exceptth.checked=true } 
if (ExcludeFlags.substr(5,1)=="1") {
  document.UpdateForm.exceptfr.checked=true } 
if (ExcludeFlags.substr(6,1)=="1") {
  document.UpdateForm.exceptsa.checked=true } 
if (ExcludeFlags.substr(7,1)=="1") {
  document.UpdateForm.exceptsu.checked=true } 

function SetCopies(){
  document.UpdateForm.schdcopy.selectedIndex = %RSHWEB02.02.021-1;
}

function ShowKeystrokes(){
  alert("Spoolfile Keystrokes\n"+keystrokes);
}
keystrokes = "%RSHWEB02.02.027";

//Check User Security against the Template Security Level
function checkSecurityLevels() {
  var tempSL = "%RSHWEB02.02.032";
  var userSL = "%RSHWEB02.02.033";

  if (isWhitespace(tempSL)) {
    document.getElementById("deleteBtn").disabled = false;
  } else if (!isWhitespace(tempSL) && !isWhitespace(userSL) && (userSL >= tempSL)) {
    document.getElementById("deleteBtn").disabled = false;
  } else {
    document.getElementById("deleteBtn").disabled = true;
  }

}
</script>
