<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"      content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function FilterSubmit() {
 if(validateMandatory(Filter)) {
   if (document.Filter.healthfd!=undefined) {
     document.Filter.hfundtyp.value=document.Filter.healthfd.value;
   } else if (document.Filter.clamtype!=undefined) {
     document.Filter.hfundtyp.value=
     document.Filter.clamtype.value.substring(0,3);
   }
   document.Filter.submit();
 }
}
function FilterReset() {
  if (document.Filter.healthfd!=undefined) {
    document.Filter.healthfd.value="";
  } else if (document.Filter.clamtype!=undefined) {
    document.Filter.clamtype.value="";
  }
  document.Filter.submit();
}
function ShowSpans() {
  if (document.Filter.ibcnmhos.value==1) {
    HospitalID.innerHTML = HospID.innerHTML;
  } else { HospitalID.innerHTML =""; }

  HosClaimOptions.innerHTML="";
  TableLocation.innerHTML="";

  if (document.Filter.updttype.value=="C") {
    HosClaimOptions.innerHTML=ExtractCL.innerHTML; }

  if (document.Filter.updttype.value=="H") {
    HosClaimOptions.innerHTML=ExtractHF.innerHTML; }


  if (document.Filter.healthfd!=undefined) {
    if(!isWhitespace(document.Filter.healthfd.value)) {
      TableLocation.innerHTML=WaitExtractionEnquiry.innerHTML;
    }
  }

  if (document.Filter.clamtype!=undefined) {
    if(!isWhitespace(document.Filter.clamtype.value)) {
      TableLocation.innerHTML=WaitExtractionEnquiry.innerHTML;
    }
  }

}
function SubmitExtract() {
  if (document.Filter.healthfd!=undefined) {
    if(isWhitespace(document.Filter.healthfd.value)) {
      alert("No Health Fund entered.");
      document.Filter.healthfd.focus();
      return false;
    }
  }
  ans=confirm("Are you sure you want to Extract?\n" +
              "Press OK to continue or Cancel to quit.");
  if (!ans) {
    return false;
  }
  document.Filter.updttype.options[1].value="E";
  document.Filter.updttype.options[2].value="E";
  FilterSubmit();
}
function UpdateExAll() {
// When the 'All' button is pressed, uncheck any 'Delete' checkboxes
  for (var i=0; i < document.Filter.length; i++) {
    var Item = document.Filter.elements[i];
    var MatchAll = "ecclm..."
    var MatchDll = "declm..."
    if (Item.name.match(MatchAll)){
      if (Item.id=="") {
        if (Item.checked==false) { Item.checked=true }
                            else { Item.checked=false } } } 
    if (Item.name.match(MatchDll)){
      if (Item.id=="") {
        if (Item.checked==true) { Item.checked=false } } }
  }
}
function UpdateExCol(extcheckbox) {
// When 'Extract' checkbox is checked, uncheck the corresponding 'Delete'
  for (var i=0; i < document.Filter.length; i++) {
    var Item = document.Filter.elements[i];
    var MatchDel = "declm" + extcheckbox.name.substring(5,8)
    if (Item.name.match(MatchDel)){
      if (Item.id=="") {
        if (Item.checked==true) { Item.checked=false } } } }
}
function UpdateDeCol(delcheckbox) {

  if (delcheckbox.checked==true) {
    if(!confirm("WARNING: Clicking OK will completely remove this claim from Eclipse. \Are you sure you want to continue ?")) {
    delcheckbox.checked=false;
      return;
    }
  }

// When 'Delete' checkbox is checked, uncheck the corresponding 'Extract'
  for (var i=0; i < document.Filter.length; i++) {
    var Item = document.Filter.elements[i];
    var MatchExt = "ecclm" + delcheckbox.name.substring(5,8)
    if (Item.name.match(MatchExt)){
      if (Item.id=="") {
        if (Item.checked==true) { Item.checked=false } } } }

}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ShowSpans();">
<form name=Filter action=hosweb01.pbl method=post style="margin:0">
<table width=100% align=center border=0 cellspacing=0>

  <input type=hidden name=reportno value=8>
  <input type=hidden name=template value=001>
  <input type=hidden name=uncodkey value="">
  <input type=hidden name=prevrecd value="">
  <input type=hidden name=nextpage value="6">
  <input type=hidden name=redirect value="hosweb01.pbl?reportno=8&template=1">
  <input type=hidden name=hfundtyp value="">
  <input type=hidden name=norecord value="10">
  <input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">

<tr><td class=HeadingCell align=center colspan=2>
     Eclipse IHC Claims Extract</td></tr>

<tr><td>
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>

<tr><td colspan=2>&nbsp;
     </td></tr>

</table>

<table width=85% align=center border=0 cellspacing=2 cellpadding=1>

<tr><td colspan=2>
<table width=100% align=center border=0 cellspacing=2 cellpadding=1>

<tr><td class=DataLabel width=25%>Extract By</td>
    <td><select name=updttype title="Extract By" class=Mandatory 
        onchange="FilterReset();">
        <option></option>
        <option value="C">Claim Type</option>
        <option value="H">Health Fund</option>
        </select>
    </td></tr>
</table>
</td></tr>

    <tr><td colspan=2>
        <span id=HospitalID></span>
        </td></tr>

    <tr><td colspan=2>
        <span id=HosClaimOptions></span>
        </td></tr>

    <tr><td colspan=2>
        <span id=TableLocation></span>
        </td></tr>

<tr><td colspan=2 align=center><hr></td></tr>

</table>
</tr></td>
</table>
</form>

<span id=WaitExtractionEnquiry style="display:none">
<table width=100% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td colspan=6 align=center><hr></td></tr>
<tr><td colspan=6 align=center>
   <table cellpadding=1 cellspacing=0 bgcolor=#CCCCCC border=0 width=100%>
   <tr><td class="MaintenanceHeading" align=center width=95%>
     Claims Waiting for Extraction
   </td>
    <td class=DataLabel>Printer</td>
    <td><select name=selprint title="Printer" class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBAPMS04.08
        </select>
    </td>
   <td><input type=button value="Submit" class="SmallButton"
        name=submbutt id=submbutt
        onclick="tempDisable(this);SubmitExtract();"></td>
   </tr>
   </table>
   </tr></td>

</tr>

<tr><td colspan=6 align=center>
  <table cellspacing=0 colspan=4 border=1 width=100% align=center>
      <td class=HeadingCell width=10%>Admission</td>
      <td class=HeadingCell width=10%>Invoice</td>
      <td class=HeadingCell width=10%>U/R</td>
      <td class=HeadingCell width=10%>Invoice Date</td>
      <td class=HeadingCell width=20%>Outstanding Invoice Amount</td>
      <td class=HeadingCell width=10%>Extract
          <input type=button value="All" class="SmallButton"
                 onclick=UpdateExAll();></td>
      <td class=HeadingCell width=10%>Delete</td>
      </tr>
  %HOSWEB01.08.004
  </table>
</tr></td>

<tr><td colspan=6 align=center>
  <table width=100% bgcolor=#CCCCCC align=center><tr>
    <td align=center>&nbsp; </td></tr>
  </table>
</tr></td>
</table>
</span>

<span id=ExtractCL style="display:none;">
<table width=100% align=center border=0 cellspacing=2 cellpadding=1>
    <tr><td width=25% class=DataLabel>%STANDARD.01.017.CL</td>
        <td><select name=clamtype title="%STANDARD.01.017.CL"
                    onchange="FilterSubmit();">
        <option value="">   </option>
         %HOSWEB01.08.003.2
        </select>
    </td></tr>
</table>
</span>

<span id=ExtractHF style="display:none;">
<table width=100% align=center border=0 cellspacing=2 cellpadding=1>
    <tr><td width=25% class=DataLabel>Health Fund</td>
        <td><input type=text name=healthfd size=6 maxlength=6
         title="Health Fund" value="%HOSWEB01.08.007"
         onblur="validateCode(16,Filter.healthfd,Filter.hfundesc,
                              FilterSubmit);">
        <input type=text readonly name=hfundesc size=30 class=readonly readonly
         title="Health Fund Description" value="%HOSWEB01.08.008" tabindex=-1>
        <img src=../images/SearchIcon.gif class=Icon
         onclick="HFundSearchFrame(Filter.healthfd,Filter.hfundesc,
                                   FilterSubmit);">
        <img src="../images/erase.gif" alt="Clear" class="Icon"
         onclick="clrFields(Filter.healthfd,Filter.hfundesc,FilterSubmit);">
        </td>
    </tr>
</table>
</span>

<span id=HospID style="display:none;">
<table width=100% align=center border=0 cellspacing=2 cellpadding=1>
    <tr><td class=DataLabel width=25%>Hospital ID</td>
    <td><select name=hospcode title="Hospital ID "
                    onchange="FilterSubmit();">
    <option value="   ">All</option>
    %HOSWEB01.08.001
    </select>
    </td></tr>
</table>
</span>

<script type="text/javascript">
 for (var i =0 ; i < document.Filter.updttype.length; i++) {
  if (document.Filter.updttype.options[i].value=="%HOSWEB01.08.005") {
       document.Filter.updttype.selectedIndex=i } };
</script>
