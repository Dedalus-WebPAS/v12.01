<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/allweb0401.js"></script>
<script type="text/javascript" src="../js/allweb0105.js"></script>
<script type="text/javascript">
function validateEquip(ReturnCode,ReturnDesc,DepartDesc,
                       Consumable,SerialN,Suppl,unitPrice) {
  if (isWhitespace(ReturnCode.value)) { return true; }
  var serverURL ="../cgi-bin/sinweb04.pbl?reportno=3" +
                 "&functype=1" +
                 "&funccode=" + ReturnCode.value.replace(/ /g,"+");

  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
    ReturnDesc.value=trim(ReturnValue[0])
    DepartDesc.value=trim(ReturnValue[2])
    if (trim(ReturnValue[3])=="1") {
      Consumable.value="Yes";
    } else {
      Consumable.value="No";
    }
    SerialN.value=trim(ReturnValue[4])
    Suppl.value=trim(ReturnValue[5])
    unitPrice.value=trim(ReturnValue[6])
  } else {
    ReturnCode.focus();
    ReturnCode.value="";
    ReturnDesc.value="";
    DepartDesc.value="";
    Consumable.value="";
    SerialN.value="";
    Suppl.value="";
    unitPrice.value="";
    return false;
  }
  return true;
}
function defaultButtons() {
  if(!isWhiteSpace()) {

}
}
function defFreAmt() {
  if(document.AddForm.snord018.value==0) {
    document.AddForm.snord018.value="";
  }
}
function changeExpCstHd() {
  if(document.AddForm.snord004.checked==true) {
    ExpCstHd.innerHTML=expcstgst.innerHTML; 
  } else {
    ExpCstHd.innerHTML=expcst.innerHTML; 
  }
}
function defaultExpCstHd() {
  ExpCstHd.innerHTML=expcstgst.innerHTML;  
}
function defaultGST() {
  document.AddForm.snord004.checked=true;
}
function enableFreight() {
  if(document.AddForm.snord017.checked==true) {
    document.AddForm.snord017.value="1";
    document.AddForm.snord018.disabled=false;
    document.AddForm.snord018.className="Mandatory"
  } else {
    document.AddForm.snord017.value="0";
    document.AddForm.snord018.disabled=true;
    document.AddForm.snord018.className="readonly"
    document.AddForm.snord018.value="";
  }
}
function defaultFreight() {
  document.AddForm.snord017.checked=false;
  document.AddForm.snord018.disabled=true;
  document.AddForm.snord018.className="readonly"
}
function enablePrinter() {
  document.AddForm.selprint.className="";
  document.AddForm.selprint.disabled=false;
}
function disablePrinter() {
  document.AddForm.selprint.value="";
  document.AddForm.selprint.className="readonly";
  document.AddForm.selprint.disabled=true;
}
function defaultPrintFax() {
  document.AddForm.snord011[0].checked=1;
}
function submitForm() {
  if(validateMandatory(document.AddForm)) {
    document.AddForm.submit();
  }
}
function ValEquip() {
  p=document.AddForm;
  validateEquip(p.snord002,p.equpdesc,p.dummy,p.dummy,p.snord003,p.snord012,p.snord007);
  ValidateSupplier(p.snord012,p.dummy1);
}
function calcFGST() {
  if(document.AddForm.snord004.checked==true) {
    a=10/100;
    b=1+a;
    c=document.AddForm.snord018.value/b
    document.AddForm.frghtgst.value=document.AddForm.snord018.value-c
    d=document.AddForm.snord009.value-0
    e=document.AddForm.frghtgst.value-0
    f=d+e
    document.AddForm.snord009.value=f;
    d=document.AddForm.snord010.value-0
    e=document.AddForm.snord018.value-0
    f=d+e
    document.AddForm.snord010.value=f;
  } else {
    document.AddForm.frghtgst.value="";
    d=document.AddForm.snord010.value-0
    e=document.AddForm.snord018.value-0
    f=d+e;
    document.AddForm.snord010.value=f;
  }

}
function calcGST() {
  if(document.AddForm.snord004.checked==true) {
    a=10/100;
    b=1+a;
    c=document.AddForm.snord007.value/b
    document.AddForm.snord008.value=document.AddForm.snord007.value-c;

    document.AddForm.snord009.value=document.AddForm.snord008.value*
                                    document.AddForm.snord006.value

    document.AddForm.snord010.value=document.AddForm.snord007.value*
                                    document.AddForm.snord006.value

  } else {
    document.AddForm.snord008.value="";
    document.AddForm.snord009.value="";
    document.AddForm.snord010.value=document.AddForm.snord007.value*
                                    document.AddForm.snord006.value
  }
  calcFGST();

  RoundNumber(document.AddForm.snord007,2);
  RoundNumber(document.AddForm.snord008,2);
  RoundNumber(document.AddForm.snord009,2);
  RoundNumber(document.AddForm.snord010,2);

  if(document.AddForm.snord007.value==0) {
    document.AddForm.snord007.value="";
  }
  if(document.AddForm.snord008.value==0) {
    document.AddForm.snord008.value="";
  }
  if(document.AddForm.snord009.value==0) {
    document.AddForm.snord009.value="";
  }
  if(document.AddForm.snord010.value==0) {
    document.AddForm.snord010.value="";
  }


}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);
              defaultPrintFax();
              defaultGST();
              defaultFreight();
              defaultExpCstHd();
              calcGST();">
<span class=DFrameTitleBar>
<script type="text/javascript">document.write(self.document.title);</script>
</span>

<form name=AddForm method=post action=sinweb04.pbl style="margin:0">
   <input type=hidden name=reportno value="1">
   <input type=hidden name=template value="002">
   <input type=hidden name=updttype value="A">
   <input type=hidden name=nextpage value="1">
   <input type=hidden name=redirect value="sinweb04.pbl?reportno=1&template=2">
   <input type=hidden name=dummy>
   <input type=hidden name=snord001 value="04678">
   <input type=hidden name=frghtgst>

<table align=center width=98% border=0>
<tr><td>
<table align=center width=100% border=0 cellpadding=0 cellspacing=0>
<tr><td class=DataLabel>Equipment Code</td>
    <td><input type=text size=20 maxlength=10 id=snord002 name=snord002
         title="Equipment Code" tabindex=1 class=Mandatory
         onblur="validateEquip(AddForm.snord002,
                               AddForm.equpdesc,
                               AddForm.dummy,
                               AddForm.dummy,
                               AddForm.snord003,
                               AddForm.snord012,
                               AddForm.snord007);
                 ValidateSupplier(AddForm.snord012,AddForm.dummy1);">
    <input type=text class="ReadOnly" readonly size=37
     title="Item Description" name=equpdesc>
    <img src="../images/SearchIcon.gif" class=Icon name=stepicon
     onclick="EquipSearch(AddForm.snord002,
                          AddForm.equpdesc,
                          AddForm.dummy,
                          AddForm.dummy,
                          ValEquip,
                          AddForm.snord003,
                          AddForm.snord012,
                          AddForm.snord007);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(AddForm.snord002,AddForm.equpdesc);">
    </td>
    <td class=DataLabel>Part Number</td> 
  <td><input type=text name=snord003 title="Part Number" class=Mandatory
       size=30 maxlength=20 tabindex=2>
</td>
</tr>
<tr>
    <td class=DataLabel>Supplier</td>
    <td><input type=text id=snord012 name=snord012 title="Part Number" class=Mandatory
        size=10 maxlength=5 tabindex=3
        onblur="ValidateSupplier(AddForm.snord012,AddForm.dummy1);">
    <input type=text size=50 name=dummy1
                readonly class=Readonly>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick='SuppSearchFrame(AddForm.snord012,AddForm.dummy1)'>
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.snord012,AddForm.dummy1);">
</td>
<td class=DataLabel>Expected Rec. Date</td>
    <td><input type="text" name=snord005 size=10 title="Expected Rec. Date"
         maxlength="11" tabindex=4 class="FutureDate Mandatory">
        <img notab src="../images/DateLookup.gif" class=Icon
         alt="Calendar" date="AddForm.snord005"></td>
</tr>
<tr><td class=DataLabel>GST Applicable</td>
    <td><input type=checkbox id=snord004 name=snord004 title="GST Applicable" value="1"
         onclick="calcGST();changeExpCstHd();" tabindex=5></td>
    <td class=DataLabel>Expected GST on Equipment</td>
    <td><input type="text" name=snord008 title="Expected GST" 
         class="Readonly" readonly size=20 maxlength=16>
    </td>
</tr>
<tr><td class=DataLabel>Quantity Required</td>
    <td><input type="text" id=snord006 name=snord006 title="Quantity Required" 
         class="Number Mandatory" size=16 maxlength=16 tabindex=6
         onblur="calcGST();">
    </td>
    <td class=DataLabel>Total GST</td>
    <td><input type="text" name=snord009 title="Expected GST" 
         class="Readonly" readonly size=20 maxlength=16>
    </td>
</tr>
<tr><td class=DataLabel>Freight</td>
        <td><input type=checkbox id=snord017 name=snord017 title="Freight" value="0"
         tabindex=6 onclick="enableFreight();calcGST();">
        <input type="text" id=snord018 name=snord018 title="Freight Amount" 
         class="Number" size=20 maxlength=16
         onblur="calcGST();
                 RoundNumber(document.AddForm.snord018,2);
                 defFreAmt();"></td>
    <td class=DataLabel>Total Cost</td>
    <td><input type="text" name=snord010 title="Total Cost" 
         class="Readonly" readonly size=20 maxlength=16>
    </td>
</tr>
<tr>
    <td><div id=ExpCstHd></div></td>
    <td><input type="text" id=snord007 name=snord007 title="Expected Cost + GST" 
         class="Number Mandatory" size=20 maxlength=16 tabindex=7
         onblur="calcGST();">
    </td>
</tr>
<tr><td colspan=6 align=center><hr></td></tr>
<tr><td>Print
    <input name=snord011 type=radio value=0 tabindex=8
      onclick="enablePrinter();">
    Fax
    <input name=snord011 type=radio value=1 tabindex=9
     onclick="disablePrinter();"></td>
</tr>
<tr><td class=DataLabel>Printer</td>
    <td><select name=selprint title="Printer" tabindex=10>
        <option></option>
        %STANDARD.01.001.SINWEB04.01
        </select>
    </td>
</tr>
<tr><td colspan=4 align=center><br>
    <input type=button value="Order" class=button tabindex=12 id=btnOrder
     onclick="tempDisable(this);submitForm();">
    <input type=button value="Cancel" class=button tabindex=13
     onclick="StdPageRefresh();">
</td></tr>

</table>
</td></tr>
</table>
</form>

<span id=expcst style="display:none">
Expected Cost
</span>

<span id=expcstgst style="display:none">
Expected Cost + GST
</span>
