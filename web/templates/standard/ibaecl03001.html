<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser"      content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function validateMonthDateRange(fromdate,todate) {

  var monstr = "";

  monstr= fromdate.value.substring(3,6)
  if (monstr=="Jan" || monstr=="JAN" || monstr=="jan") mon="01"
  if (monstr=="Feb" || monstr=="FEB" || monstr=="feb") mon="02"
  if (monstr=="Mar" || monstr=="MAR" || monstr=="mar") mon="03"
  if (monstr=="Apr" || monstr=="APR" || monstr=="apr") mon="04"
  if (monstr=="May" || monstr=="MAY" || monstr=="may") mon="05"
  if (monstr=="Jun" || monstr=="JUN" || monstr=="jun") mon="06"
  if (monstr=="Jul" || monstr=="JUL" || monstr=="jul") mon="07"
  if (monstr=="Aug" || monstr=="AUG" || monstr=="aug") mon="08"
  if (monstr=="Sep" || monstr=="SEP" || monstr=="sep") mon="09"
  if (monstr=="Oct" || monstr=="OCT" || monstr=="oct") mon="10"
  if (monstr=="Nov" || monstr=="NOV" || monstr=="nov") mon="11"
  if (monstr=="Dec" || monstr=="DEC" || monstr=="dec") mon="12"

  var date1 = new Date(mon+"/"+
                       fromdate.value.substr(0,2)+"/"+
                       fromdate.value.substr(7,4));

  monstr= todate.value.substring(3,6)
  if (monstr=="Jan" || monstr=="JAN" || monstr=="jan") mon="01"
  if (monstr=="Feb" || monstr=="FEB" || monstr=="feb") mon="02"
  if (monstr=="Mar" || monstr=="MAR" || monstr=="mar") mon="03"
  if (monstr=="Apr" || monstr=="APR" || monstr=="apr") mon="04"
  if (monstr=="May" || monstr=="MAY" || monstr=="may") mon="05"
  if (monstr=="Jun" || monstr=="JUN" || monstr=="jun") mon="06"
  if (monstr=="Jul" || monstr=="JUL" || monstr=="jul") mon="07"
  if (monstr=="Aug" || monstr=="AUG" || monstr=="aug") mon="08"
  if (monstr=="Sep" || monstr=="SEP" || monstr=="sep") mon="09"
  if (monstr=="Oct" || monstr=="OCT" || monstr=="oct") mon="10"
  if (monstr=="Nov" || monstr=="NOV" || monstr=="nov") mon="11"
  if (monstr=="Dec" || monstr=="DEC" || monstr=="dec") mon="12"

  var date2 = new Date(mon+"/"+
                       todate.value.substr(0,2)+"/"+
                       todate.value.substr(7,4));

  var timeDiff = Math.abs(date2.getTime() - date1.getTime());
  var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));

  if (diffDays > 31) {
    alert("Date range cannot be more than 31 days.");
    return false;
  }

  return true;
}
 function ProcessReport() {

  ReportForm.keystr02.value=ReportForm.timran01.value;
  ReportForm.keystr04.value=ReportForm.timran02.value;
  ReportForm.keystr05.value="Y";


  if (ReportForm.schdrdat.value=="") {
    ReportForm.keystr01.title="From Date";
    ReportForm.keystr03.title="To Date";
    ReportForm.keystr01.value=ReportForm.datran01.value;
    ReportForm.keystr03.value=ReportForm.datran02.value;
    SubmitPage=CheckDateRange(ReportForm.keystr01,ReportForm.keystr03); 
   if(!validateMonthDateRange(ReportForm.keystr01,ReportForm.keystr03)){return;}
  } else {
    ReportForm.keystr01.title="From Schedule";
    ReportForm.keystr03.title="To Schedule"; 
  }

  SubmitReport(ReportForm);
 }
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ReportLoad();document.ReportForm.schddate.focus();">
 <form name="ReportForm" method="post" action="rshweb02.pbl">
  <input type="hidden" name="reportno" value="4" />
  <input type="hidden" name="template" value="001" />
  <input type="hidden" name="updttype" value="A" />
  <input type="hidden" name="setdfprg" value="IBAECL03" />
  <input type="hidden" name="setdfrep" value="01" />
  <input type="hidden" name="schdpgid" value="IBAECL03" />
  <input type="hidden" name="schddesc" 
                       value="Eclipse OEC Date Range Status Request" />
  <input type="hidden" name="nextpage" value="1" />
  <input type="hidden" name="redirect"
                       value="rshweb02.pbl?reportno=1&template=1" />
  <input type="hidden" name="ibcnmhos" value="%RSHWEB02.01.118.000.043.1.1" />
  <input type="hidden" name="ptcnmtid" value="%STANDARD.01.025.124.159.0.1" />

  <input type="hidden" name="keystr01" value="" />
  <input type="hidden" name="keystr02" value="" />  
  <input type="hidden" name="keystr03" value="" />
  <input type="hidden" name="keystr04" value="" />  
  <input type="hidden" name="keystr05" value="" />
  <input type="hidden" name="keystr06" value="" />
  <input type="hidden" name="keystr07" value="" />

  <table width="100%" align="center" border="0" cellspacing="0">
    <tr><td class="HeadingCell" align="center" colspan="2">
            Eclipse OEC Date Range Status Request</td></tr>
  </table>

  <table width="80%" align="center" border="0" cellspacing="2" cellpadding="1">

    <tr><td class="DataLabel" width="25%">Schedule Date</td>
        <td class="DataLabel">
            <input type="text" name="schddate" size="12" title="Schedule Date"
                   value="%STANDARD.01.015"
                   onblur="checkDate(this,'Schedule Date');" />
              <img notab src="../images/DateLookup.gif" class="Icon"
                   alt="Show Calendar" date="ReportForm.schddate" />
            Time
            <input type="text" name="schdtime" size="12" title="Schedule Time"
                   value="%STANDARD.01.016" />
              <img notab src="../images/DateTimeStamp.gif" class="Icon"
                   alt="Current" date="ReportForm.schddate"
                   time="ReportForm.schdtime" />
              <img notab src="../images/TimeLookup.gif" class="Icon"
                   alt="Time Select" time="ReportForm.schdtime" /></td></tr>
    <tr><td class="DataLabel">Printer</td>
        <td><select name="schdprnt" title="Printer" class=Mandatory>
               <option></option>
                  %STANDARD.01.001.ECLWEB01.01
            </select></td></tr>

    <tr><td class="DataLabel">Number of Copies</td>
        <td><select name="schdcopy" title="Number of Copies" class="Mandatory">
            </select></td></tr>

    <tr><td class="DataLabel">Schedule Type</td>
        <td class="DataLabel" colspan="3">
            <select name="schdrdat" title="Schedule Type"
               onchange="SetReportDates()">
               <option></option>
            </select></td></tr>

    <tr><td class="DataLabel">Schedule Until Date</td>
        <td class="DataLabel" colspan="3">
            <input type="text" name="schdrend" size=12
                   onblur="checkDate(this,'Re-schedule Until Date');" />
              <img notab src="../images/DateTimeStamp.gif" class="Icon"
                   alt="Current" date="ReportForm.schdrend" />
              <img notab src="../images/DateLookup.gif" class="Icon"
                   alt="Show Calendar" date="ReportForm.schdrend" /></td></tr>


    <tr><td colspan="2" align="center"><hr width="80%" /></td></tr>

    <tr><td class="DataLabel" width="25%">Date Range </td>
    <td><span id="DateRange"></span></td></tr>

    <tr>
      <td>Time</td>
      <td>
        <input class="Mandatory" type="text" name="timran01" size="8"
         tabindex="2" value="" title="From Time">
        <img src="../images/TimeLookup.gif" class="Icon" tabindex=-1
         onclick="TimeLookupFrame(ReportForm.timran01);">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        &nbsp;&nbsp;&nbsp;&nbsp;
        <input class="Mandatory" type="text" name="timran02" size="8"
         tabindex="2" value="" title="To Time">
        <img src="../images/TimeLookup.gif" class="Icon" tabindex=-1
         onclick="TimeLookupFrame(ReportForm.timran02);">
      </td>
    </tr>

    <tr><td align="center" colspan=2><br />
            <input type="button" value="Ok" class="button"
                   id=okbutton name=okbutton 
                   onclick="tempDisable(this);ProcessReport();" />
            <input type="button" value="Cancel" class="button"
                   onclick='location.href="../lookups/blank.html"' /></td></tr>
  </table>
 </form>

 <div id="SetDateRange" style="display:none;">
     <input type="text" size="15" maxlength="12" name="datran01"
            onblur="checkDate(this,'Date')"
            class="Mandatory PastDate" title="From Date" />
       <img notab src="../images/DateTimeStamp.gif" class="Icon"
        alt="Current" date="ReportForm.datran01" time="ReportForm.timran01"/>
       <img notab src="../images/DateLookup.gif" class="Icon"
            alt="Calendar" date="ReportForm.datran01" />
     To
     <input type="text" size="15" maxlength="12" name="datran02"
            onblur="checkDate(this,'Date')" class="Mandatory PastDate"
            title="To Date" />
       <img notab src="../images/DateTimeStamp.gif" class="Icon"
        alt="Current" date="ReportForm.datran02" time="ReportForm.timran02"/>
       <img notab src="../images/DateLookup.gif" class="Icon"
            alt="Calendar" date="ReportForm.datran02" />
 </div>

 <div id="SetScheduleRange" style="display:none;">
     <select name="datsch01" title="Schedule Range" class="Mandatory"
        onblur="UpReportSchedule(this,ReportForm.keystr01,ReportForm.keystr03)">
        <option></option>
     </select>
     Sample Range
     <input type="text" name="SampleFrom" size="12" />
     To
     <input type="text" name="SampleTo" size="12" />
 </div>

<script language=javascript>
  if (document.ReportForm.ptcnmtid.value!=1) {
    ReportForm.okbutton.disabled=true; 
  }
</script>
