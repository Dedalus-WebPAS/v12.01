<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">

function WardOption(){
  
  if (ReportForm.exadlopt.value==3)  {
    document.getElementById('TimeRange').innerHTML="";
    document.getElementById('Start').innerHTML="";
    document.getElementById('DocType').innerHTML="";  
    document.getElementById('DoctorTypeSpan').innerHTML="";  
  }

  else if ((ReportForm.exadlopt.value==1) || (ReportForm.exadlopt.value==2)){
    document.getElementById('TimeRange').innerHTML=document.getElementById('SetTimeRange').innerHTML;
    document.getElementById('Start').innerHTML="Start Time"; 
    document.getElementById('DocType').innerHTML="";
    document.getElementById('DoctorTypeSpan').innerHTML="";
  }
  else if(ReportForm.exadlopt.value==4){ 
    document.getElementById('DocType').innerHTML="Doctor Type From";
    document.getElementById('DoctorTypeSpan').innerHTML=document.getElementById('SetDoctorType').innerHTML;
  }
}
function ProcessReport() {
     ReportForm.keystr01.value=ReportForm.exadlopt.value;
     ReportForm.keystr02.value=ReportForm.patcmnts.value;
     if (ReportForm.schdrdat.value!="") {
       ReportForm.keystr03.title="From Schedule";
       ReportForm.keystr04.title="To Schedule";
     }
     else{
       ReportForm.keystr03.title="From Date"
       ReportForm.keystr03.value=ReportForm.fromdate.value;
       ReportForm.keystr04.title="To Date"
       ReportForm.keystr04.value=ReportForm.todate.value;
       if (!CheckDateRange(ReportForm.fromdate,ReportForm.todate)){return;}
     }

     if(ReportForm.ibcnmhos.value=="1"){
           if (ReportForm.exadlopt.value==3){
              ReportForm.keystr05.value=ReportForm.booktypf.value;
              ReportForm.keystr06.value=ReportForm.booktypt.value;
              ReportForm.keystr07.value=ReportForm.daigdets.value;
              ReportForm.keystr08.value=ReportForm.hospital.value;
              ReportForm.keystr09.value="Y";
              ReportForm.keystr10.value=" ";
              ReportForm.keystr11.value=" ";
           }
           else{
              if(ReportForm.strttime.value=="")
                ReportForm.keystr05.value=" "
              else    
                ReportForm.keystr05.value=ReportForm.strttime.value;
              
              if(ReportForm.endtime.value=="")
                ReportForm.keystr06.value=" "
              else
                ReportForm.keystr06.value=ReportForm.endtime.value;

              ReportForm.keystr07.value=ReportForm.booktypf.value;
              ReportForm.keystr08.value=ReportForm.booktypt.value;
              
              if(ReportForm.exadlopt.value==4){
                ReportForm.keystr09.value=ReportForm.doctypf.value; 
                ReportForm.keystr10.value=ReportForm.doctypt.value;
                ReportForm.keystr11.value=ReportForm.daigdets.value;
                ReportForm.keystr12.value=ReportForm.hospital.value;
                ReportForm.keystr13.value="Y";
                ReportForm.keystr14.value=" ";
                ReportForm.keystr15.value=" ";
              } else { 
                ReportForm.keystr09.value=ReportForm.daigdets.value;
                ReportForm.keystr10.value=ReportForm.hospital.value;
                ReportForm.keystr11.value="Y";
                ReportForm.keystr12.value=" ";
                ReportForm.keystr13.value=" ";
              } 
           }
     }
     else{
           if (ReportForm.exadlopt.value==3){
              ReportForm.keystr05.value=ReportForm.booktypf.value;
              ReportForm.keystr06.value=ReportForm.booktypt.value;
              ReportForm.keystr07.value=ReportForm.daigdets.value;
              ReportForm.keystr08.value="Y";
              ReportForm.keystr09.value=" ";
              ReportForm.keystr10.value=" ";
            }
           else{
              if(ReportForm.strttime.value=="")
                ReportForm.keystr05.value=" "
              else
                ReportForm.keystr05.value=ReportForm.strttime.value;

              if(ReportForm.endtime.value=="")
                ReportForm.keystr06.value=" "
              else
                ReportForm.keystr06.value=ReportForm.endtime.value;

              ReportForm.keystr07.value=ReportForm.booktypf.value;
              ReportForm.keystr08.value=ReportForm.booktypt.value;
              
              if(ReportForm.exadlopt.value==4){
                ReportForm.keystr09.value=ReportForm.doctypf.value;
                ReportForm.keystr10.value=ReportForm.doctypt.value;
                ReportForm.keystr11.value=ReportForm.daigdets.value; 
                ReportForm.keystr12.value="Y";
                ReportForm.keystr13.value=" ";
                ReportForm.keystr14.value=" ";
              }else {
                ReportForm.keystr09.value=ReportForm.daigdets.value; 
                ReportForm.keystr10.value="Y";
                ReportForm.keystr11.value=" ";
                ReportForm.keystr12.value=" ";
              } 
           }
     }
    
     SubmitReport(ReportForm)
     
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ReportLoad();WardOption();">
<form name=ReportForm method=post action=rshweb02.pbl style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=001>
<input type=hidden name=updttype value="A">
<input type=hidden name=setdfprg value="IBAHMS30">
<input type=hidden name=setdfrep value="01">
<input type=hidden name=schdpgid value="IBAHMS30">    
<input type=hidden name=schddesc value="Expected Admission List">
<input type=hidden name=nextpage value="1">
<input type=hidden name=keystr01 value="">
<input type=hidden name=keystr02 value="">
<input type=hidden name=keystr03 value="">
<input type=hidden name=keystr04 value="">
<input type=hidden name=keystr05 value="">
<input type=hidden name=keystr06 value="">
<input type=hidden name=keystr07 value="">
<input type=hidden name=keystr08 value="">
<input type=hidden name=keystr09 value="">
<input type=hidden name=keystr10 value="">
<input type=hidden name=keystr11 value="">
<input type=hidden name=keystr12 value="">
<input type=hidden name=keystr13 value="">
<input type=hidden name=keystr14 value="">
<input type=hidden name=keystr15 value="">
<input type=hidden name=ibcnmhos value="%RSHWEB02.01.118.000.043.1.1">
<input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=1">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>
    Expected Admission List Report</td></tr>
</table>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text name=schddate size=12 title="Schedule Date"
    value="%STANDARD.01.015"
    onblur="checkDate(this,'Schedule Date');">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schddate">
    Time
    <input type=text name=schdtime size=12 title="Schedule Time"
    value="%STANDARD.01.016">
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schddate" time="ReportForm.schdtime">
    <img notab src="../images/TimeLookup.gif" class="Icon" 
     alt="Time Select" time="ReportForm.schdtime">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><select name=schdprnt title="Printer" class=Mandatory>
        <option></option>
        %STANDARD.01.001.IBAHMS30.01
        </select>
    </td></tr>
<tr><td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy title='Number of Copies'>
        </select>
    </td></tr>
<tr><td class=DataLabel>Re-schedule Type</td> 
    <td class=DataLabel colspan=3> 
    <select name=schdrdat title="Schedule Type" onchange=SetReportDates()> 
    <option></option> 
    </select> 
    </td></tr> 
 
<tr><td class=DataLabel>Re-schedule Until Date</td> 
    <td class=DataLabel colspan=3> 
    <input type=text name=schdrend size=12 
     onblur="checkDate(this,'Re-schedule Until Date');"> 
    <img notab src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current" date="ReportForm.schdrend">
    <img notab src="../images/DateLookup.gif" class="Icon" 
     alt="Show Calendar" date="ReportForm.schdrend">
    </td></tr>
 
<tr><td colspan=2 align=center><hr width=80%></td></tr>

<tr><td class=DataLabel>Expected Admission List Option</td>
    <td><select name=exadlopt class="Mandatory" onchange="WardOption();">
        <option value="1">Time/Doctor/Surname Sequence</option>
        <option value="2">Time/Surname/Sequence</option>
        <option value="3">Surname Sequence</option>
        <option value="4">Doctor Specialty Sequence</option>
        </select>
     </td></tr>

<tr><td class=DataLabel>Do you wish to print patient comments also</td>
    <td><select name=patcmnts class="Mandatory">
        <option value="Y">Yes</option>
        <option value="N">No</option>
        </select>
    </td></tr>

<tr><td class=DataLabel width=25%>Start Date</td>
    <td><span id=DateRange></span>
    </td></tr>

<tr><td class=DataLabel id=Start width=25%>Start Time</td>
    <td><span id=TimeRange></span>
    </td></tr>

<tr><td class=DataLabel>Booking Type From</td>
    <td><select name=booktypf >
         <option value=" ">Start</option>
         %STANDARD.01.007.BK
         </select>
    Booking Type To
        <select name=booktypt>
        <option value=" ">Finish</option>
         %STANDARD.01.007.BK
        </select>
    </td>
    </tr>

<tr><td class=DataLabel id=DocType>Doctor Type</td>
    <td><span id=DoctorTypeSpan></span>
    </td></tr>

<tr><td class=DataLabel>Do you wish to print diagnosis details</td>
    <td><select name=daigdets class="Mandatory">
        <option value="Y">Yes</option>
        <option value="N">No</option>
        </select>
    </td></tr>
</table>

<span id=HospitalID></span>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td align=center colspan=2><br>
    <input type=button value=Ok class="button" name=formactn
     onclick='tempDisable(this);ProcessReport();'>
    <input type=button value=Cancel class="button" 
     onclick='location.href="../lookups/blank.html"' >
    </td></tr>
</table>
</form>

<div id=SetDateRange style="display:none;">
     <input type=text size=15 maxlength=12 name=fromdate
      onblur="checkDate(this,'Date')" class="Mandatory Date" title="Start Date">
     <img src="../images/DateTimeStamp.gif"  class="Icon"
      alt="Current" date="ReportForm.fromdate">
     <img src="../images/DateLookup.gif" class="Icon"
      alt="Calendar" date="ReportForm.fromdate">
      &nbsp;
      End Date 
     <input type=text size=15 maxlength=12 name=todate
      onblur="checkDate(this,'Date')" class="Mandatory Date" title="End Date">
     <img src="../images/DateTimeStamp.gif"  class="Icon"
      alt="Current" date="ReportForm.todate">
     <img src="../images/DateLookup.gif" class="Icon"
      alt="Calendar" date="ReportForm.todate">
</div>

<div id=SetTimeRange style="display:none;" >
    <input type=text name=strttime size=12 value="">
    <img  src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current"  time="ReportForm.strttime">
    <img  src="../images/TimeLookup.gif" class="Icon"
     alt="Time Select" time="ReportForm.strttime">
     &nbsp;
     End Time
    <input type=text name=endtime size=12 value="">
    <img  src="../images/DateTimeStamp.gif" class="Icon"
     alt="Current"  time="ReportForm.endtime">
    <img  src="../images/TimeLookup.gif" class="Icon"
     alt="Time Select" time="ReportForm.endtime">
</div> 

<div id=SetDoctorType style="display:none">
    <select name=doctypf>
      <option value=" ">Start</option>
         %STANDARD.01.007.DT
    </select>
      Doctor Type To
    <select name=doctypt>
      <option value=" ">Finish</option>
         %STANDARD.01.007.DT
    </select>
</div>

<div id=SetScheduleRange style="display:none;">
    <select name=datsch01 title="Schedule Range" class=Mandatory
    onblur="UpReportSchedule(this,ReportForm.keystr03,ReportForm.keystr04);">
    <option></option></select>
    &nbsp;Date From&nbsp;&nbsp;
    <input type=text name=SampleFrom size=12 readonly> 
    &nbsp;&nbsp;Date To&nbsp;&nbsp;
    <input type=text name=SampleTo size=12 readonly>
</div>

<span id=HospID style="display:none;">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Hospital ID</td>
    <td><select name=hospital title="Hospital ID ">
    <option value="">All</option>
    %RSHWEB02.01.122
    </select>
    </td></tr>
</table>
</span>

<script language=javascript>
 if (document.ReportForm.ibcnmhos.value==1) {
     HospitalID.innerHTML = HospID.innerHTML; }
</script>
