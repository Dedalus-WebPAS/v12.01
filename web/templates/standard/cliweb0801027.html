<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/TableSort.js></script>
<script type="text/javascript" src=../js/cliweb08.js></script>
<style type=text/css>
.TableRowDeleted td {
 text-decoration: line-through;
}
</style>
%START.OF.PAGE
<body onload="PageLoad(event);">
<div id=PageHeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%CLIWEB08.01.003";
PatientVIS="%CLIWEB08.01.081";
PatientNAM="%CLIWEB08.01.002";
PatientSTA="%CLIWEB08.01.086.078";
PatientALT="%CLIWEB08.01.084";
PatientSEX="%CLIWEB08.01.019";
PatientDOB="%CLIWEB08.01.020";
PatientAGE="%CLIWEB08.01.021";
PatientLOC="%CLIWEB08.01.083";
PatientPRI="%CLIWEB08.01.086.066.1";
PatientUNT="%CLIWEB08.01.066.0";
DoctorCOD="%CLIWEB08.01.082.003";
DoctorNAM="%CLIWEB08.01.082.002";
PatientAID="%CLIWEB08.01.086.090";
PatientIND="%CLIWEB08.01.086.091";
PatientCUR="%CLIWEB08.01.086.092";
PatientCLC="%CLIWEB08.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%CLIWEB08.01.086.094";
PatientCDM="%CLIWEB08.01.086.095";
PatientVDH="%CLIWEB08.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
</div>
<table cellspacing=0 cellpadding=0 border=0 width=100%>
<tr>
    <td class=HeadingCell width=30%> 
    Add Document :
    <select name=docttype onchange="PMenuLinkTo(this);">
    <option></option>
    <option value="patweb98.pbl|01|320|0|0|0">Create Document</option>
    <option value="cliweb08.pbl|01|002|1|500|300">Upload Document</option>
    <option value="cliweb08.pbl|01|009|1|500|300">Upload Result</option>
    </select>
    </td>
    <td class=HeadingCell align=center></td>
    <td class=HeadingCell align=right width=30%>
    <input type=button class="button" value="Show Drafts" onClick='ShowAll(this);'>
    </td></tr>
</table>
<div id=TableLocation> </div>
<form name=Download action=patweb84.pbl method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%CLIWEB08.01.003">
<input type=hidden name=admissno value="%CLIWEB08.01.081">
</form>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=022>
<input type=hidden name=urnumber value="%CLIWEB08.01.003">
<input type=hidden name=admissno value="%CLIWEB08.01.081">
<input type=hidden name=MenuType value="%CLIWEB08.01.088">
</form>
<script type="text/javascript">
var ShowDrafts=0;
function init() {
//
// Create New Table Object
//  border, cellspacing, cellpadding, width, align
//
 t = new Table(1,0,1,"100%","center",22,22);
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
//
 t.addColumn("Date","DateTime",3,3,"left","ClinicalNote.gif","0","15%")
 t.addColumn("Type","String",11,11,"left nowrap","MaintenanceIcon.gif","1","15%")
 t.addColumn("Subject","String",6,6,"left nowrap","","","25%")
 t.addColumn("From ","String",8,8,"left nowrap","","","15%")
 t.addColumn("To ","String",9,9,"left nowrap","","","15%")
 t.addColumn("Status","Status",16,16,"left nowrap","","","15%")
//
// Add Rows to Table (Output from Web Server)
//
  %CLIWEB08.01.151.cliweb08.01.003

   OrderColumn=0; 
   AscDsc=2;
   TableOutput(OrderColumn,AscDsc);
}
function ShowAll(el) {
  if (ShowDrafts==0) {
    ShowDrafts=1;
    el.value="Hide Drafts";
  } else {
    el.value="Show Drafts";
    ShowDrafts=0;
  }
  TableOutput(OrderColumn,AscDsc);
}
function TableBody() {
 filteredRows=0;
 RowClass="TableRowEven"
 for(var i = 0; i < t.rows.length; i++) {
  if (TableFilter(t.rows[i])){
   filteredRows++;
   if (t.rows[i][16]=='2'&&ShowDrafts==0) continue;
   if (RowClass=="TableRowEven") { RowClass="TableRowOdd" }
   else                          { RowClass="TableRowEven" }
   if (t.rows[i][16]=='1') RowClass+=' TableRowDeleted';
   if (t.rows[i][16]=='2') RowClass+=' TableRowDeleted';
   TableString[TableString.length] = "<tr id='row_"+i+"' height=" + 
                                     t.RowHeight + 
                                     " class='" + 
                                     RowClass + "'>" ;
   for(var j = 0; j < t.columns.length; j++) {
     TableString[TableString.length] = "<td align=" + t.columns[j][4]  ;
     if(t.columns[j][11]!=undefined) {
       if(!isWhitespace(t.rows[i][t.columns[j][11]])) {
         TableString[TableString.length] = " class=" + 
                                           t.rows[i][t.columns[j][11]]  ;
       }
     }
     if(t.columns[j][12]!=undefined) {
       if(!isWhitespace(t.rows[i][t.columns[j][12]])) {
         TableString[TableString.length] = " title=" +
                         t.rows[i][t.columns[j][12]].replace(/ /g,"&nbsp;");
       }
     }
     TableString[TableString.length] = " width=" + t.columns[j][7] + ">" ;
     LinkColumn = t.columns[j][6];
     LinkFlag = 0
     ImgString = t.columns[j][5];
     onmouseind = t.columns[j][10];
     if (LinkColumn != "") {
       if (LinkColumn == "0"){ 
         TableString[TableString.length] = "<a href=\"javascript:ViewDocument('"+i+"')\";>";
         LinkFlag = 1 
       }
       if (LinkColumn == "1"){ 
         TableString[TableString.length] = "<a href=\"javascript:ViewProperties('"+i+"')\";>";
         LinkFlag = 1 
       }
     }

     switch(t.columns[j][1]) {
       case "Status" :  
         StatusValue = t.rows[i][t.columns[j][2]];
         if (StatusValue=='3') TableString[TableString.length] = "Current Draft"
         if (StatusValue=='2') TableString[TableString.length] = "Draft"
         if (StatusValue=='1') TableString[TableString.length] = "Deleted"
         if (StatusValue=='0') TableString[TableString.length] = "Final"
         break;
      
       case "MaxLimit" :  
         FormatIcon(i);
         ThisValue=t.rows[i][t.columns[j][2]];
         MaxValue=t.columns[j][8];
         HighLightColor=t.columns[j][9];
         if (ThisValue>MaxValue) {
            TableString[TableString.length] = "<font color="+HighLightColor+"><b>"
            TableString[TableString.length] = t.rows[i][t.columns[j][2]];
            TableString[TableString.length] = "</font><b>" }
         else {
            TableString[TableString.length] = t.rows[i][t.columns[j][2]]; }
         if ( LinkFlag ) { TableString[TableString.length] = "</a>"; }
         break;
       case "MinLimit" :  
         FormatIcon(i);
         ThisValue=t.rows[i][t.columns[j][2]];
         MaxValue=t.columns[j][8];
         HighLightColor=t.columns[j][9];
         if (ThisValue<MaxValue) {
            TableString[TableString.length] = "<font color=" +
                                              HighLightColor+"><b>"
            TableString[TableString.length] = t.rows[i][t.columns[j][2]];
            TableString[TableString.length] = "</font><b>" }
         else {
            TableString[TableString.length] = t.rows[i][t.columns[j][2]]; }
         if ( LinkFlag ) { TableString[TableString.length] = "</a>"; }
         break;
       case "Date" :  
         FormatIcon(i);
         TableString[TableString.length] = FormatDate(t.rows[i][t.columns[j][2]]);
         break;
       case "DateTime" :  
         FormatIcon(i);
         TableString[TableString.length] = FormatDateTime(t.rows[i][t.columns[j][2]]);
         break;
       case "DateTimeImg" :
         if (t.columns[j][5] == "") {
           ImgString=t.rows[i][t.columns[j][8]];
         }
         else {
           ImgString=t.columns[j][5] +
                       t.rows[i][t.columns[j][8]] + ".gif"
         }
         FormatIcon(i);
         TableString[TableString.length] = FormatDateTime(t.rows[i][t.columns[j][2]]);
         break;
       case "Time" :  
         FormatIcon(i);
         TableString[TableString.length] = FormatTime(t.rows[i][t.columns[j][2]]);
         break;
       case "Name" :  
         FormatIcon(i);
         TableString[TableString.length] = FormatName(t.rows[i][t.columns[j][2]]);
         break;
       case "ImageText" :
         if (t.columns[j][5] == "") {
           ImgString=t.rows[i][t.columns[j][8]];
         }
         else {
           ImgString=t.columns[j][5] +
                       t.rows[i][t.columns[j][8]] + ".gif"
         }
         FormatIcon(i);
         TableString[TableString.length] = (t.rows[i][t.columns[j][2]]);
         break;
       case "NameAll" :  
         FormatIcon(i);
         TableString[TableString.length] = FormatNameAll(t.rows[i][t.columns[j][2]]);
         break;
       case "Graph":  
         TableString[TableString.length] = FormatGraph(t.rows[i][t.columns[j][2]],t.columns[j][5]);
         break;
       case "IconLink":  
         FormatIcon(i);
         break;
       case "Image":  
         if (t.columns[j][5] == "") {
           ImageString=t.rows[i][t.columns[j][2]];
         }
         else {
           ImageString=t.columns[j][5] + t.rows[i][t.columns[j][2]] + ".gif"
         }
         TableString[TableString.length] = FormatImage(ImageString);
         break;
       case "Patient":   
         FormatPatientIcon(t.rows[i][t.columns[j][8]])
         TableString[TableString.length] = t.rows[i][t.columns[j][2]];
         if ( LinkFlag ) { TableString[TableString.length] = "</a>"; }
         break;
       default    :   
         FormatIcon(i);
         TableString[TableString.length] = t.rows[i][t.columns[j][2]];
         if ( LinkFlag ) { TableString[TableString.length] = "</a>"; }
         break;
     }
     if (isWhitespace(t.rows[i][t.columns[j][2]])) {
       TableString[TableString.length] = "&nbsp;" }
     TableString[TableString.length] = "</td>" ;
     }
   TableString[TableString.length] = "</tr>" ;
   }
  }
}
function ViewProperties(i) {
 linkurl="cliweb08.pbl?reportno=1&template=3"+
      "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+") +
      "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+") +
      "&detailky=" + t.rows[i][2];
  Left=(document.body.clientWidth-480)/2
  DFrameLink(linkurl,0,Left,480,500)
}
function ViewDocument(i) {
  viewCliDoc(t.rows[i][2])
  if (t.rows[i][16] == '3') {
    SetCookie('ClinicalDocument',t.rows[i][2]);
    linkurl="patweb98.pbl?reportno=1&template=320"+
            "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+") +
            "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+") 
    location.href=linkurl;
  }
  else {
    SetCookie('ClinicalDocument','');
    myWin=open(t.rows[i][1],"",
    "left=100,top=100,width=830,height=600,scrollbars=yes,status=no,toolbar=no,menubar=no,resizable=yes");
  }
}
function viewCliDoc(obsaudky) {
  var serverURL   = "../cgi-bin/comweb80.pbl?reportno=91" +
                    "&valdcode=" + obsaudky.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
}
</script>

