<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function InitTable() {
 document.title="Research Project Patient List";
 t = new Table(1,0,1,"100%","center",35,35);    // Create New Table Object
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column,Align
//
 t.addColumn("Patient","ImageText",1,1,"left","PatientFolder","0",100,2)
 t.addColumn("Age","String",6,7,"left","","",90)
 t.addColumn("Visit","String",3,3,"left","","",90)
 t.addColumn("Presenting Complaint","String",4,4,"left","","",90)
 t.addColumn("Doctor","String",8,8,"left","","",90)
 t.addColumn("Status","String",5,5,"left","MaintenanceIcon.gif","9",90)
//
 AddTableRows()
 TableOutput(0,1)
}
function listResearch() {
 location.href="emrweb06.pbl?reportno=06&template=003" +
         "&emres001=" + document.UpdateForm.emres001.value.replace(/ /g,"+") +
         "&emres002=" + document.UpdateForm.emres002.value.replace(/ /g,"+")
}
function updatePatient(research,start_date,vis) {
 linkurl="emrweb06.pbl?reportno=06&template=007" +
         "&emres001=" + research.replace(/ /g,"+") +
         "&emres002=" + start_date.replace(/ /g,"+") +
         "&emrvs001=" + research.replace(/ /g,"+") +
         "&emrvs002=" + start_date.replace(/ /g,"+") +
         "&emrvs003=" + vis.replace(/ /g,"+") 
 Left=(document.body.clientWidth-450)/2
 DFrameLink(linkurl,50,Left,450,200)
}
function linkPatient(ur,vis) {
 linkurl="emrweb02.pbl?reportno=01&template=100" +
         "&urnumber=" + ur.replace(/ /g,"+") +
         "&admissno=" + vis.replace(/ /g,"+")
 location.href=linkurl;
}
</script>
</head>
%START.OF.PAGE
<body onload=PageLoad(event);InitTable();>
<div id=HeadingSection>
<table cellpadding=3 border=0 width=100%>
<tr><td class=HeadingCell colspan=3 align=center>
     Research Project Patients</td>
    </tr>
</table>

<form name=UpdateForm method=post action=emrweb06.pbl>
<input type=hidden name=reportno value="6">
<input type=hidden name=template value="006">
<input type=hidden name=updatety value="U">
<input type=hidden name=emres001 value="%EMRWEB06.06.001.1">
<input type=hidden name=emres002 value="%EMRWEB06.06.002">
<input type=hidden name=nextpage value="">
<input type=hidden name=redirect value="">

<table align=center width=80% border=0>
<tr><td class=DataLabel width=20%>Research Code</td>
    <td class=DataField width=20%>%EMRWEB06.06.001.0</td>
    </tr>

<tr><td class=DataLabel>Research Project Start</td>
    <td class=DataField>%EMRWEB06.06.002</td>
    </tr>

<tr><td class=DataLabel>Research Project End</td>
    <td class=DataField>%EMRWEB06.06.003</td>
    </tr>

<tr><td class=DataLabel>Generation Date/Time</td>
    <td class=DataField>%EMRWEB06.06.005 %EMRWEB06.06.006</td>
    </tr>

<tr><td colspan=4 align=center><br>
    <input type=button value="Cancel" class="button"
     onclick="listResearch();">
    </td></tr>
</table>
</form>

<form name=SelectPeriod action=emrweb06.pbl method=get style="margin:0">
<input type=hidden name=reportno value=6>
<input type=hidden name=template value=6>
<input type=hidden name=emres001 value="%EMRWEB06.06.001.1">
<input type=hidden name=emres002 value="%EMRWEB06.06.002">
<table cellpadding=3 bgcolor=#CCCCCC border=0 width=100%>
<tr><td>Project Status
    <select name=filtstat onchange='SelectPeriod.submit();'>
    <option value=" ">All</option>
    <option value="0">Suggested</option>
    <option value="1">Accepted</option>
    <option value="2">Rejected</option>
    </select>
    </td></tr>
</table>
</form>

</div>
<div id="TableLocation"></div>
<script type="text/javascript">
function AddTableRows() {
 %EMRWEB06.06.105
}
 FiltStat="%EMRWEB06.06.102";
 for (var i =0 ; i < document.SelectPeriod.filtstat.length; i++) {
  if (document.SelectPeriod.filtstat.options[i].value==FiltStat.substr(0,1)) {
       document.SelectPeriod.filtstat.selectedIndex=i } };
</script>
