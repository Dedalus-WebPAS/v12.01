<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
function removeAdmission(admn) {
  document.UnadmitForm.admissno.value=admn;
  document.UnadmitForm.redirect.value="patweb09.pbl?reportno=1&template=1"+
           "&batchnum="+document.SelectWard.batchnum.value+
           "&radmdate="+document.SelectWard.ptmis001.value+
           "&radmtime="+document.SelectWard.ptmis002.value+
           "&radmdtim="+document.SelectWard.ptdsc002.value+
           "&radmward="+document.SelectWard.wardcode.value+
           "&radmspec="+document.SelectWard.specialt.value;

  document.UnadmitForm.submit();
}
function setSpeciality() {
 p=document.SelectWard
    j=p.wardcode.value.substr(3,3);
      p.specialt.selectedIndex=0;
      for (var i =0 ; i < p.specialt.length; i++) {
        if (p.specialt.options[i].value.substr(0,3)==
            p.wardcode.value.substr(3,3)) {
          p.specialt.selectedIndex=i;
        }
      }
}
function openAdd() {
  p=document.SelectWard
  if(p.popupadd.value=="1"){
    addVisit();
  }
}
function addVisit() {
  p=document.SelectWard
  if(validateMandatory(p)){
  if(p.ptmis002.value==p.ptdsc002.value){
    alert("Admission and Discharge time cannot be equal.");
    return;
  }
  if(p.ptmis002.value>p.ptdsc002.value){
    alert("Discharge time must be greater than the admission time.");
    return;
  }
  SetCookie("priordatecookie","1");
  linkurl="patweb89.pbl?reportno=1&template=026&recurrfl=1&discflag=1"+
           "&batchnum="+document.SelectWard.batchnum.value;
  Left=(document.body.clientWidth-1200)/2;
  DFrameLink(linkurl,50,Left,1200,800)
 }
}

</script>
%START.OF.PAGE
<body onload="PageLoad(event);initTable();setSpeciality();init();openAdd();">
<div id=HeadingSection>
<form name=UnadmitForm action=patweb96.pbl method=get style=margin:0>
<input type=hidden name=reportno value="1">
<input type=hidden name=template value="1">
<input type=hidden name=updatety value="9">
<input type=hidden name=admissno value="">
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value="2">
</form>
<form name=SelectWard action=patweb09.pbl method=get style=margin:0>
<input type=hidden name=reportno value="1">
<input type=hidden name=template value="1">
<input type=hidden name=batchnum value="%PATWEB09.01.002">
<input type=hidden name=discflag value="%PATWEB09.01.004">
<input type=hidden name=radmdate value="%PATWEB09.01.005">
<input type=hidden name=radmtime value="%PATWEB09.01.006">
<input type=hidden name=radmdtim value="%PATWEB09.01.007">
<input type=hidden name=radmward value="%PATWEB09.01.008">
<input type=hidden name=radmspec value="%PATWEB09.01.009">
<input type=hidden name=popupadd value="%PATWEB09.01.010">

<table width=100% cellspacing=0 border=0 bgcolor=#CCCCCC>
<tr><td class=HeadingCell align=center colspan=10>
     Input Recurring Care</td></tr>


<tr><td class="DataLabel">Admission Date </td>
         <td><input type="text" size="12" name="ptmis001" tabindex="1"
             class="Mandatory PriorDate" title="Admission Date"
             />
         <img notab src="../images/DateLookup.gif" class=Icon
          onclick="DateLookupFrame(SelectWard.ptmis001);" />
       </td><td>
          Admission Time
       </td><td>
       <input class="Mandatory" type="text" name="ptmis002" size="8" tabindex="2"
           title="Admission Time">
        <img notab src="../images/DateTimeStamp.gif" class=Icon
          onclick="SetCurrentDateTime(null,SelectWard.ptmis002);" />
        <img notab src="../images/TimeLookup.gif" class=Icon
          onclick="TimeLookupFrame(SelectWard.ptmis002);" />
       </td><td>
          Discharge Time
       </td><td>
       <input class="Mandatory" type="text" name="ptdsc002" size="8" tabindex="2"
          value="" title="Discharge Time">
        <img notab src="../images/DateTimeStamp.gif" class=Icon
          onclick="SetCurrentDateTime(null,SelectWard.ptdsc002);" />
        <img notab src="../images/TimeLookup.gif" class=Icon
          onclick="TimeLookupFrame(SelectWard.ptdsc002);" />
          </td>
       </tr>

<tr> <td>Ward</td>
        <td><select name=wardcode onchange=setSpeciality(); class=Mandatory
             title='Ward'>
        <option></option>
         %PATWEB09.01.001
        </select>
        </td>
        <td>Ward Classification</td>
        <td><select name=specialt class=Mandatory title='Ward Classification'>
        <option></option>
         %STANDARD.01.018.CG.   .9.1. 6.2.O
        </select>
        </td>
<td></td>
<td></td>
</tr>
<tr><td colspan=10 align=center>
<input type=button value="Add Visits" onclick="addVisit();"></td>
</tr>
</table>
</form>
</div>

<div id="TableLocation" >
</div>
<script type="text/javascript">
function initTable() {
document.title="                       ";
t = new Table(1,0,1,"100%","center",35,35);    // Create New Table Object

 template = 1
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column,Align
//
 t.addColumn("U/R Number","String",1,1,"left","DeleteIcon.gif","9",70)
 t.addColumn("Name","String",0,0,"left","","",180)
 t.addColumn("Date","Date",3,3,"left","","",80)
 t.addColumn("Admission Time","String",4,4,"left","","",80)
 t.addColumn("Discharge Time","String",5,5,"left","","",80)
 t.addColumn("Ward","String",8,8,"left","","",80)
 t.addColumn("Ward Classification","String",7,7,"left","","",80)



// Add Rows to Table (Output from Web Server)
//
%PATWEB09.01.003.patweb98.01.001
//
 OrderColumn=0;
 AscDsc=1;
lastOrderColumn=OrderColumn;
TableOutput(OrderColumn,AscDsc,template);
}
function init(){
  p=document.SelectWard
  if(p.radmdate.value.substr(0,1)!="~"){
    p.ptmis001.value=p.radmdate.value
  }
  if(p.radmtime.value!="~~~~~~~~"){
    p.ptmis002.value=p.radmtime.value
  }
  if(p.radmdtim.value!="~~~~~~~~"){
    p.ptdsc002.value=p.radmdtim.value
  }
  if(p.radmward.value!="~~~"){
     for (var i =0 ; i < p.wardcode.length; i++) {
     if (p.wardcode.options[i].value.substr(0,3)==
        p.radmward.value.substr(0,3)) {
        p.wardcode.selectedIndex=i } };
  }
  if(p.radmspec.value!="~~~"){
     for (var i =0 ; i < p.specialt.length; i++) {
     if (p.specialt.options[i].value.substr(0,3)==
        p.radmspec.value.substr(0,3)) {
        p.specialt.selectedIndex=i } };
  }

}
</script>
