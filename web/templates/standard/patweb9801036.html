<meta name="TemplateVersion" content="V12.01.01">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript" src="../js/UltraGenda.js"> </script>
<script type="text/javascript" src="../js/patweb9801036.js"> </script>
<script type="text/javascript">
function AppointLink(CaseKeys) {
 if(document.PatientLinks.ptcnhdps.value=="1") {
   Site=CaseKeys.substr(0,6);
   if(document.PatientLinks.outpsite.value!=Site) {
      alert("Invalid Outpatient Site Security.");
      return;
   }
 }
 CASEKEYS=CaseKeys.replace(/ /g,"+");
 location.href="outweb02.pbl?reportno=3&template=1&casekeys="+CASEKEYS;
}
function ViewBookNotes(Urnumber,VisitNo) {
  linkurl="patweb89.pbl?reportno=01&template=049" +
          "&urnumber=" + Urnumber.replace(/ /g,"+") +
          "&admissno=" + VisitNo.replace(/ /g,"+");
  Left=(document.body.clientWidth-860)/2;
  DFrameLink(linkurl,100,Left,860,420);
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link                   
//  1 - Day
//  2 - Date & Time
//  3 - Clinic Type
//  4 - Clinic
//  5 - Outcome
//  6 - Visit Type
//  7 - Status
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 t = new Table(1,0,2,"100%","center",35,40);
 t.addColumn("Date","DateTime",2,2,"left","AppointmentIcon.gif","0",150)
 t.addColumn("Day","String",1,1,"left","","",25)
 t.addColumn("Clinic","String",4,4,"left","","",100)
 t.addColumn("Clinic Type","String",3,3,"left","","",90)
 t.addColumn("Visit Type","String",6,6,"left","","",90)
 t.addColumn("Status","String",7,7,"left","","",55)
 t.addColumn("Outcome","String",5,5,"left","","",85)
//
 if(document.PatientLinks.ptcndcdm.value=="1") {
   t.addColumn("CDM","String",8,8,"left","","",70)
 } 
//
 t.addColumn("Booking Comments","Image",9,9,"center","CommentIcon","10",45)
 AddTableRows()
 TableOutput(0,2);    // Order Column,Asc Dsc
 break; }
case 1: {
 t = new Table(1,0,2,"100%","center",25,40);
 t.addColumn("Date","DateTime",2,2,"left","AppointmentIcon.gif","0",150)
 t.addColumn("Day","String",1,1,"left","","",25)
 t.addColumn("Clinic","String",4,4,"left","","",180)
 t.addColumn("Status","String",7,7,"left","","",55)
 t.addColumn("Outcome","String",5,5,"left","","",180)
 AddTableRows()
 TableOutput(0,2);    // Order Column,Asc Dsc
 break; }
 }
}
function GetAppointmentTypeCookie() {
  var aptyckie = "";
  if (GetCookieData("AppointmentTypeCookie") != "unknown" &&
      !isWhitespace(GetCookieData("AppointmentTypeCookie"))) {
    aptyckie = GetCookieData("AppointmentTypeCookie");
    cookieur = getQueryStringURL(aptyckie,"urnumber");
    if(trim(cookieur.replace(/\+/g," ")) !=
       trim(document.PatientLinks.urnumber.value)) {
      return;
    }
    ExpireCookiePath("AppointmentTypeCookie");
    Left=(document.body.clientWidth-900)/2;
    DFrameLink(aptyckie,100,Left,920,900);
  }
}
</script>
</head>
%START.OF.PAGE
<body onload='PageLoad(event);InitTable(0);GetAppointmentTypeCookie();'>
<div id=HeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB98.01.003";
PatientVIS="%PATWEB98.01.081";
PatientNAM="%PATWEB98.01.002";
PatientSTA="%PATWEB98.01.086.078";
PatientALT="%PATWEB98.01.084";
PatientSEX="%PATWEB98.01.019";
PatientDOB="%PATWEB98.01.020";
PatientAGE="%PATWEB98.01.021";
PatientLOC="%PATWEB98.01.083";
PatientPRI="%PATWEB98.01.086.066.1";
PatientUNT="%PATWEB98.01.066.0";
DoctorCOD="%PATWEB98.01.082.003";
DoctorNAM="%PATWEB98.01.082.002";
PatientAID="%PATWEB98.01.086.090";
PatientIND="%PATWEB98.01.086.091";
PatientCUR="%PATWEB98.01.086.092";
PatientCLC="%PATWEB98.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB98.01.086.094";
PatientCDM="%PATWEB98.01.086.095";
PatientVDH="%PATWEB98.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<table width=100% cellspacing=0 cellpadding=0 bgcolor=#cccccc>
<!--
<tr><td>
    <a href=javascript:InitTable(0)>
    <img src=../images/TableViewIcon.gif align=absmiddle 
     alt="Default View" border=0></a>
    <a href=javascript:InitTable(1)>
    <img src=../images/TableViewIcon.gif align=absmiddle 
     alt="Show Visit Types" border=0></a>
</td>
-->
<tr>
<td align=right><input type=button class="Bigbutton" value="New Appointment"
 onclick="PatientLinkTo('outweb02.pbl',5,2,1,920,900);">
</td></tr>
</table>
</div>
<div id=TableLocation></div>
<script type="text/javascript">
function AddTableRows() {
%PATWEB98.01.316
UGAppointmentList(PatientURN,"PATWEB98.01.316");
}
</script>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB98.01.003">
<input type=hidden name=admissno value="%PATWEB98.01.081">
<input type=hidden name=MenuType value="%PATWEB98.01.088">
<input type="hidden" name="ptcndcdm" value="%STANDARD.01.025.116.214.0.1">
<input type=hidden name=outpsite value="%STANDARD.01.023">
<input type=hidden name=ptcnhdps value="%STANDARD.01.025.080.250.1.1">
</form>
