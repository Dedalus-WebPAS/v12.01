<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
</head>
%START.OF.PAGE
<body onload="PageLoad(event);getSortWardCookie();checkShowDischargeDelay();
              showWADischargeFields();">
<!--        Sub-Frame Header Section       -->
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Update Condition - %PATWEB93.05.002
</span>
<!--        Sub-Frame Details Sections     -->
<form name=PatCondPopup style="margin:0" method=post %PATWEB93.05.101
<input type=hidden name=nextpatn value="patweb93.pbl?reportno=05&template=001">
<input type=hidden name=admisdte value="%PATWEB93.05.402">
<input type=hidden name=admistme value="%PATWEB93.05.403">
<input type=hidden name=nextpatm value="1">
<input type=hidden name=d_ptartype value="">
<input type=hidden name=diswafil>
<table border=0 align=center width=100%>
<tr>
    <td class=DataLabel>Last Update</td>
    <td><input type=text class=readonly readonly size=20 name=patconup
               value="%PATWEB93.05.108"></td></tr>
<tr><td class=DataLabel>Condition </td>
    <td><select name=patconcd>
        <option value="   "></option>
        %PATWEB93.05.102
        </select>
    </td></tr> 
<tr><td class=DataLabel>Ambulatory Status</td>
    <td><select name=patconam>
        <option value="   "></option>
        %PATWEB93.05.107
        </select>
    </td></tr>
<tr><td class=DataLabel> Visitors Allowed ?</td>
    <td><input name=patconva type=checkbox value=1>                   
    </td></tr>
<tr><td class=DataLabel> Phone Calls Allowed ?</td>
    <td><input name=patconpa type=checkbox value=1>                   
    </td></tr>
<tr><td class=DataLabel>Discharge Preparation Status</td>
    <td><select name=pmswo007 title="Discharge Preparation Status">
        <option value="   "></option>
        %PATWEB93.05.214.2
        </select>
    </td></tr>
<tr><td class=DataLabel>Expected Discharge Date</td>
    <td><input type=text size=12 name=pmswo005 tabindex=31
         class="FutureDate" value="%PATWEB93.05.205"
         title="Expected Discharge Date">
        <img notab src="../images/DateLookup.gif" class=Icon
         onclick="DateLookupFrame(PatCondPopup.pmswo005);">
        Time
        <input type=text name=pmswo006 size=8 title="Expected Discharge Time"
         value="%PATWEB93.05.213">
        <img notab src="../images/DateTimeStamp.gif" class=Icon 
         onclick="SetCurrentDateTime(PatCondPopup.pmswo005,
                                     PatCondPopup.pmswo006);">
       <img notab src="../images/TimeLookup.gif" class=Icon
        onclick="TimeLookupFrame(PatCondPopup.pmswo006);">
    </td></tr>
<tr><td class=DataLabel> Comments</td>
    <td><input name=patconds size=35 maxlength=35 value="%PATWEB93.05.103"
         onblur="validateFreeTextFields(this);">
    </td></tr>
<span>

</span>
<tr id="clredida">
    <td class=DataLabel>Clinically Ready for Discharge Date</td>
    <td><input type=text size=15 maxlength=12 name=mrfddate
           id=mrfddate title="Clinically Ready for Discharge Date"
           onblur="checkDate(this,'Date');disDelay(this);" class="Date"
           value="%PATWEB93.05.134" >
         <img notab src="../images/DateTimeStamp.gif" class=Icon
              alt="Current"
              onclick="SetCurrentDateTime(mrfddate,null);">
         <img notab src="../images/DateLookup.gif" class=Icon
              alt="Calendar" date="PatCondPopup.mrfddate"></td></tr>
<tr id=rsndisde style="display: none;">
<td class=DataLabel>Reason for Discharge Delay</td>
    <td><select name=vsxdc014 id=vsxdc014 title="Reason for Discharge Delay">
        <option></option>
        %STANDARD.01.007.z1
        </select></td></tr>
<tr id="mcldida1" style="display: none;">
  <td class=DataLabel>Medically Cleared for Discharge Date</td>
    <td><input type=text size=12 name=ptatr014 tabindex=31
         class="Date" value="%PATWEB93.05.136.3  "
         title="Medically Cleared for Discharge Date"
         onblur="checkDate(this,'Date');ShowMedClearDetail();" disabled>
        <img notab src="../images/DateLookup.gif" class=Icon
         onclick="DateLookupFrame(PatCondPopup.ptatr014);">
        Time
        <input type=text name=ptatr015 size=8 
         title="Medically Cleared for Discharge Time" 
         value="%PATWEB93.05.136.4  " disabled>
        <img notab src="../images/DateTimeStamp.gif" class=Icon
         onclick="SetCurrentDateTime(PatCondPopup.ptatr014,
                                     PatCondPopup.ptatr015);">
       <img notab src="../images/TimeLookup.gif" class=Icon
        onclick="TimeLookupFrame(PatCondPopup.ptatr015);">
       <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(PatCondPopup.ptatr014,PatCondPopup.ptatr015);
                  ShowMedClearDetail();">
    </td></tr>
<tr id=mcldida2 style="display: none;">
  <td class=DataLabel>Primary Reason for Discharge Delay</td>
  <td><select name=ptdsc005 id=ptdsc005  
           title="Primary Reason for Discharge Delay" disabled>
        <option value="   "></option>
        %STANDARD.01.007.z1   
        </select>
    </td></tr>
<tr id=mcldida3 style="display: none;">
  <td class=DataLabel>Secondary Reason for Discharge Delay</td>
  <td><select name=ptdsc006 id=ptdsc006
           title="Secondary Reason for Discharge Delay" disabled>
        <option value="   "></option>
        %STANDARD.01.007.z1  
        </select>
    </td></tr>
<tr><td align=center colspan=2>
<input type=button value="Update" class=button id=pat93sub
       onclick="tempDisable(this, 5);checkFields();">
<input type=button value="Cancel" class=button
       onclick="DFrameCloseRefresh();">
</td></tr>

</table>
</form>
 
<script type="text/javascript">
if ("%PATWEB93.05.106.1" == "1")
{
  document.PatCondPopup.patconva.checked="1";
}

if ("%PATWEB93.05.106.2" == "1")
{
  document.PatCondPopup.patconpa.checked="1";
}

function checkFields() {
  if ( validateMandatory(PatCondPopup) && validateExpDiscDate() ) {
    PatCondPopup.submit();
  }
}

function showWADischargeFields() {
  if (ShowWADischargeDelayFields) {
    document.getElementById("mcldida1").style.display = "";
    document.getElementById("mcldida2").style.display = "";
    document.getElementById("mcldida3").style.display = "";
    PatCondPopup.ptatr014.disabled = false;
    PatCondPopup.ptatr015.disabled = false;
    PatCondPopup.ptdsc005.disabled = false;
    PatCondPopup.ptdsc006.disabled = false;
    PatCondPopup.diswafil.value="1";
    ShowMedClearDetail();
  } else {
    PatCondPopup.diswafil.value="";
  }
}

function getSortWardCookie() {
  SortWardCookie=GetCookieData('SortWardCookie');
  SetCookie("SortWardCookie",'0');
  if (SortWardCookie=='1') {
    document.PatCondPopup.nextpatn.value=" ";    
  }
}

function validateExpDiscDate() {
  // Validates expected discharge date/time against admission date/time
  var admDate = SetDateYYYYMMDD(document.PatCondPopup.admisdte.value);
  var admTime = document.PatCondPopup.admistme.value;
  var disDate = SetDateYYYYMMDD(document.PatCondPopup.pmswo005.value);
  var disTime = document.PatCondPopup.pmswo006.value;

  if (disDate != "") {
    if (disDate < admDate) {
      // discharge date before admission date
      alert(document.PatCondPopup.pmswo005.title + 
            " must be after Admission Date");
      document.PatCondPopup.pmswo005.select();
      return false;
    }
    else if (disDate == admDate) {
      // same date; check the time...
      if (disTime != "") {
        if (disTime < admTime) {
          alert(document.PatCondPopup.pmswo006.title + 
                " must be after Admission Time");
          document.PatCondPopup.pmswo006.select();
          return false;
        }
      }
    }
  }

  return true;
}

function validateFreeTextFields(textfieldvar) {
  textfieldvar.value=textfieldvar.value.replace(/</g,"< ");
  textfieldvar.value=textfieldvar.value.replace(/"/g,"'");
  textfieldvar.value=textfieldvar.value.replace(/\\/g,"/");
}

function disDelay(cliDis) {
  if (!isWhitespace(cliDis.value)) {
    document.getElementById("rsndisde").style.display = "";
    document.getElementById("vsxdc014").className = "Mandatory";
    document.getElementById("vsxdc014").disabled = false;
  } else {
    document.getElementById("rsndisde").style.display = "none";
    document.getElementById("vsxdc014").className = "";
    document.getElementById("vsxdc014").disabled = true;
    document.getElementById("vsxdc014").value = "";
  }
}
function checkShowDischargeDelay() {
  if ("%STANDARD.01.025.080.250.1.1" !== "3" ||
      ShowDischargeDelayFields !== true) {
      document.getElementById("clredida").style.display = "none";
      document.getElementById("rsndisde").style.display = "none";
      document.getElementById("mrfddate").disabled = true;
      document.getElementById("vsxdc014").disabled = true;
  }
}

function ShowMedClearDetail() {
  f = document.PatCondPopup;
  if (isWhitespace(f.ptatr014.value)) {
    f.ptatr015.className="";
    f.ptatr015.value="";
    f.ptdsc005.className="";
    f.ptdsc005.selectedIndex=0;
    f.ptdsc006.selectedIndex=0;
    document.getElementById("mcldida2").style.display = "none";
    document.getElementById("mcldida3").style.display = "none";
  }
  else {
    f.ptatr015.className="Mandatory";
    f.ptdsc005.className="Mandatory";
    document.getElementById("mcldida2").style.display = "";
    document.getElementById("mcldida3").style.display = "";
  }
}

disDelay(document.getElementById('mrfddate'));
for (var j=0; j < document.getElementById('vsxdc014').length; j++) {
  if (document.getElementById('vsxdc014').options[j].value.substr(0,3)
      =="%PATWEB93.05.135") {
      document.getElementById('vsxdc014').selectedIndex=j;
  }
}

for (var j=0; j < document.getElementById('ptdsc005').length; j++) {
  if (document.getElementById('ptdsc005').options[j].value.substr(0,3)
      =="%PATWEB93.05.136.5  ") {
      document.getElementById('ptdsc005').selectedIndex=j;
  }
}

for (var j=0; j < document.getElementById('ptdsc006').length; j++) {
  if (document.getElementById('ptdsc006').options[j].value.substr(0,3)
      =="%PATWEB93.05.136.6  ") {
      document.getElementById('ptdsc006').selectedIndex=j;
  }
}

</script>
