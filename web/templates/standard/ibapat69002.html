<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function init() {
  var p = document.ReportForm;
  if(document.getElementById("ptcnsmso").value=="1") {
    sortSelectionList(p.keystr02);
  }
  if (p.ptcnsmsn.value != "1") {  // SMS Notifications not enabled
    // Disable report options and OK button
    DisableFields();
  } 
}

function ProcessReport() {
  if (!validateMandatory(document.ReportForm)) { 
     return; 
  }

  if (document.ReportForm.schdrdat.value == "") {
    document.ReportForm.keystr03.title = "From Date";
    document.ReportForm.keystr04.title = "To Date";
    document.ReportForm.keystr03.value = 
                                   document.getElementById('datran01').value;
    document.ReportForm.keystr04.value = 
                                   document.getElementById('datran02').value;

    if (!CheckDateRange(document.ReportForm.keystr03,
                                     document.ReportForm.keystr04)) {
      return;
    }
  } else {
     document.ReportForm.keystr03.title="From Schedule";
     document.ReportForm.keystr04.title="To Schedule";
  }

  if(ReportForm.multiple.selectedIndex == -1) {
    alert("Please select the " + trim(ReportForm.multiple.title) + " value(s)");
    return;
  }
  if(ReportForm.multipl1.selectedIndex == -1) {
    alert("Please select the " + trim(ReportForm.multipl1.title) + " value(s)");
    return;
  }
  if(ReportForm.multipl2.selectedIndex == -1) {
    alert("Please select the " + trim(ReportForm.multipl2.title) + " value(s)");
    return;
  }
  if(ReportForm.multipl3.selectedIndex == -1) {
    alert("Please select the " + trim(ReportForm.multipl3.title) + " value(s)");
    return;
  }
  if(ReportForm.multipl4.selectedIndex == -1) {
    alert("Please select the " + trim(ReportForm.multipl4.title) + " value(s)");
    return;
  }
  if(ReportForm.multipl5.selectedIndex == -1) {
    alert("Please select the " + trim(ReportForm.multipl5.title) + " value(s)");
    return;
  }
  var keycount=0;
  for (i=0; i < ReportForm.multiple.options.length; i++) {
      if(ReportForm.multiple.options[i].selected == true) {
        keycount++;
      }
  }
  for (i=0; i < ReportForm.multipl1.options.length; i++) {
      if(ReportForm.multipl1.options[i].selected == true) {
        keycount++;
      }
  }
  for (i=0; i < ReportForm.multipl2.options.length; i++) {
      if(ReportForm.multipl2.options[i].selected == true) {
        keycount++;
      }
  }
  for (i=0; i < ReportForm.multipl3.options.length; i++) {
      if(ReportForm.multipl3.options[i].selected == true) {
        keycount++;
      }
  }
  for (i=0; i < ReportForm.multipl4.options.length; i++) {
      if(ReportForm.multipl4.options[i].selected == true) {
        keycount++;
      }
  }
  for (i=0; i < ReportForm.multipl5.options.length; i++) {
      if(ReportForm.multipl5.options[i].selected == true) {
        keycount++;
      }
  }
  if(keycount>=130) {
    alert("Error a maximum of 130 selections has been exceeded.");
  }
  SubmitReport(document.ReportForm);
}

function DisableFields() {
  var p = document.ReportForm;

  p.keystr02.disabled = true;  // SMS Message Type
  document.getElementById('datran01').disabled = true;
  document.getElementById('datran02').disabled = true;
  p.keystr05.disabled = true;
  p.keystr06.disabled = true;
  p.keystr07.disabled = true;
  p.multiple.disabled = true;
  p.keystr09.disabled = true;
  p.multipl1.disabled = true;
  p.keystr11.disabled = true;
  p.multipl2.disabled = true;
  p.keystr13.disabled = true;
  p.multipl3.disabled = true;
  p.keystr15.disabled = true;
  p.multipl4.disabled = true;
  p.keystr17.disabled = true;
  p.multipl5.disabled = true;
  p.btn_ok.disabled = true;
}

function CheckPastDate(InpFld, Title) {
  if (isWhitespace(InpFld.value))
    return true;

  if (checkDate(InpFld,Title)) {
    var InpDate = SetDateYYYYMMDD(InpFld.value);
    var Today = new Date()
    var ThisDay=Today.getDate();
    var ThisMth=parseInt(Today.getMonth(),10) +1;
    var ThisYrs=Today.getFullYear();
    if (ThisDay < 10) ThisDay="0" + ThisDay
    if (ThisMth < 10) ThisMth="0" + ThisMth
    ThisDate="";
    ThisDate=ThisDate.concat(ThisYrs,ThisMth,ThisDay);

    if (InpDate >= ThisDate) {
      alert(Title + " must be in the Past.");
      InpFld.select();
      InpFld.focus();
      return false;
    }
  }

  return true;
}
function ShowHospital() {
  p = document.ReportForm;
  if (p.ibcnmhos.value == "1") {
    document.getElementById('ShowHospital').style.display = "";
    ChangeHospital();
  }
  else {
    document.getElementById('keystr05').disabled = true;
    document.getElementById('ShowHospital').style.display = "none";
  }
}
function ChangeHospital(){
  var p = document.ReportForm;
  selectOptions2('3',p.keystr05,p.keystr06);
  SelectOptionsHospCatCode1(p.acode,p.keystr05,p.multiple);
  SelectOptionsHospCatCode1(p.cccode,p.keystr05,p.multipl1);
  SelectOptionsHospCatCode1(p.clcode,p.keystr05,p.multipl2);
  SelectOptionsHospCatCode1(p.apcode,p.keystr05,p.multipl3);
  SelectOptionsHospCatCode1(p.vicode,p.keystr05,p.multipl4);
  SelectOptionsHospCatCode1(p.pcode,p.keystr05,p.multipl5);
  p.keystr06.options[0].text="All";
  p.multiple.options[0].text="All";
  p.multipl1.options[0].text="All";
  p.multipl2.options[0].text="All";
  p.multipl3.options[0].text="All";
  p.multipl4.options[0].text="All";
  p.multipl5.options[0].text="All";
}
function ValidateSelect(IncludeExclude,List) {
  if(IncludeExclude[0].checked != true &&
     List.selectedIndex==0) {
     alert("Invalid option exclude All");
     List.options[0].selected=false;
  }
  if (List.selectedIndex == 0) {  // 'All' option selected
    for (i=1; i < List.options.length; i++) {
      List.options[i].selected = false;  // de-select all other options
    }
  }
}
function ClearSelect(List) {
    for (i=0; i < List.options.length; i++) {
      List.options[i].selected = false;  // de-select all options
    }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ReportLoad();
              ShowHospital();
              document.ReportForm.schddate.focus();">
<form name=ReportForm method=post action=rshweb02.pbl style="margin:0">
  <input type=hidden name=reportno value=4>
  <input type=hidden name=template value=002>
  <input type=hidden name=updttype value="A">
  <input type=hidden name=nextpage value="1">
  <input type=hidden name=setdfprg value="IBAPAT69">
  <input type=hidden name=setdfrep value="01">
  <input type=hidden name=schdpgid value="IBAPAT69">    
  <input type=hidden name=schddesc value="SMS for Discharged Visits">
  <input type=hidden name=schdtype value="3">
  <input type=hidden name=redirect value="rshweb02.pbl?reportno=1&template=1">
  <input type=hidden name=ptcnsmsn value="%STANDARD.01.025.120.243.0.1">
  <input type=hidden name=keystr01 value="2">
  <input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
  <input type=hidden name=acode value="A ">
  <input type=hidden name=cccode value="CC">
  <input type=hidden name=clcode value="CL">
  <input type=hidden name=apcode value="ap">
  <input type=hidden name=vicode value="VI">
  <input type=hidden name=pcode value="P ">
  <input type=hidden name="ptcnsmso" id="ptcnsmso"
         value="%STANDARD.01.025.128.106.0.1">

<table width=100% align=center border=0 cellspacing=0>
<tr><td class=HeadingCell align=center colspan=2>
  SMS for Discharged Visits</td>
</tr>
</table>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Schedule Date</td>
    <td class=DataLabel>
    <input type=text id=schddate name=schddate size=12 title="Schedule Date"
    value="%STANDARD.01.015"
    onblur="checkDate(this,'Schedule Date');">
    <img src=../images/DateLookup.gif class=Icon alt="Show Calendar"
     onclick="DateLookupFrame(schddate);">
    Time
    <input type=text id=schdtime  name=schdtime size=12 title="Schedule Time"
    value="%STANDARD.01.016">
    <img src=../images/DateTimeStamp.gif alt="Schedule Time" class=Icon
     onclick="SetCurrentDateTime(schddate,schdtime);">
    <img src=../images/TimeLookup.gif class=Icon alt="Time Select"
     onclick="TimeLookupFrame(schdtime);">
    </td></tr>

<tr><td class=DataLabel>Printer</td>
    <td><input type=text name=d_schdprntdesc title="Printer"
          readonly class="Readonly" value="%RSHWEB02.01.199.002">
    </td></tr>
<input type=hidden name=schdprnt value="%STANDARD.01.025.124.105.0.6">

<tr><td class=DataLabel>Number of Copies</td>
    <td><select name=schdcopy title='Number of Copies' class=Mandatory>
        </select>
    </td></tr>
 
<tr><td class=DataLabel>Re-schedule Type</td> 
    <td class=DataLabel colspan=3> 
    <select name=schdrdat title="Schedule Type" onchange="SetReportDates();"> 
      <option value=""></option> 
    </select> 
    </td></tr> 
 
<tr><td class=DataLabel>Re-schedule Until Date</td> 
    <td class=DataLabel colspan=3> 
    <input type=text id=schdrend name=schdrend size=12 
     onblur="checkDate(this,'Re-schedule Until Date');"> 
    <img src=../images/DateTimeStamp.gif class=Icon alt="Current"
     onclick="SetCurrentDateTime(schdrend,null);"> 
    <img src=../images/DateLookup.gif class=Icon alt="Show Calendar"
     onclick="DateLookupFrame(schdrend);">
    </td></tr>
 
<tr><td colspan=2 align=center><hr width=80%></td></tr>
</table>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>SMS Message to Send</td>
    <td><select name=keystr02 title="SMS Message Type" class=Mandatory>
        <option> </option>
        %RSHWEB02.01.194
        </select></td></tr>

</table>

<input type=hidden name=keystr03 value=" ">
<input type=hidden name=keystr04 value=" ">

<span id=DateRange></span>

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>

<tr id=ShowHospital>
  <td class=DataLabel width=25%>Hospital</td>
  <td></td>
  <td><select name=keystr05 id="keystr05" class="SelectBig" title="Hospital"
     onchange="ChangeHospital()">
     <option value=" ">All</option>
       %RSHWEB02.01.122
     </select></td>
</tr>

<tr><td class=DataLabel width=25%>Admitting Ward</td>
    <td width=12%></td>
    <td width=15%>
      <select name=keystr06 title="Admitting Ward" class="SelectBig">
        <option value=" ">All</option>
        %RSHWEB02.01.101
      </select>
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.035.A </td>
    <td><input type=radio name=keystr07 value="N" checked
         onclick="ClearSelect(ReportForm.multiple);">&nbsp;Include
        <input type=radio name=keystr07 value="E"
         onclick="ClearSelect(ReportForm.multiple);">&nbsp;Exclude&nbsp;
    </td><td>
        <select name=multiple id=multiple multiple="multiple"
         title="%STANDARD.01.035.A " class="SelectMultipleLarge SelectBig"
         onclick="ValidateSelect(ReportForm.keystr07,this);">
        <option value=" ">All</option>
        %RSHWEB02.01.198.2
        </select>
    </td><td align=left>Press CTRL or SHIFT to select multiple codes
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.035.CC</td>
    <td><input type=radio name=keystr09 value="N" checked
         onclick="ClearSelect(ReportForm.multipl1);">&nbsp;Include
        <input type=radio name=keystr09 value="E"
         onclick="ClearSelect(ReportForm.multipl1);">&nbsp;Exclude&nbsp;
    </td><td>
        <select name=multipl1 id=multipl1 multiple="multiple"
         title="%STANDARD.01.035.CC" class="SelectMultipleLarge SelectBig"
         onclick="ValidateSelect(ReportForm.keystr09,this);">
        <option value=" ">All</option>
        %RSHWEB02.01.199.001.2
        </select>
    </td><td align=left>Press CTRL or SHIFT to select multiple codes
    </td></tr>

<tr><td class=DataLabel width=25%>%STANDARD.01.035.CL</td>
    <td><input type=radio name=keystr11 value="N" checked
         onclick="ClearSelect(ReportForm.multipl2);">&nbsp;Include
        <input type=radio name=keystr11 value="E"
         onclick="ClearSelect(ReportForm.multipl2);">&nbsp;Exclude&nbsp;
    </td><td>
        <select name=multipl2 id=multipl2 multiple="multiple"
         title="%STANDARD.01.035.CL" class="SelectMultipleLarge SelectBig"
         onclick="ValidateSelect(ReportForm.keystr11,this);">
        <option value=" ">All</option>
        %RSHWEB02.01.185.9.1.10.2.X
        </select>
    </td><td align=left>Press CTRL or SHIFT to select multiple codes
    </td></tr>

<tr><td class=DataLabel width=25%>%STANDARD.01.035.ap</td>
    <td><input type=radio name=keystr13 value="N" checked
         onclick="ClearSelect(ReportForm.multipl3);">&nbsp;Include
        <input type=radio name=keystr13 value="E"
         onclick="ClearSelect(ReportForm.multipl3);">&nbsp;Exclude&nbsp;
    </td><td>
        <select name=multipl3 id=multipl3 multiple="multiple"
         title="%STANDARD.01.035.ap" class="SelectMultipleLarge SelectBig"
         onclick="ValidateSelect(ReportForm.keystr13,this);">
        <option value=" ">All</option>
        %STANDARD.01.007.ap
        </select>
    </td><td align=left>Press CTRL or SHIFT to select multiple codes
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.035.VI</td>
    <td><input type=radio name=keystr15 value="N" checked
         onclick="ClearSelect(ReportForm.multipl4);">&nbsp;Include
        <input type=radio name=keystr15 value="E"
         onclick="ClearSelect(ReportForm.multipl4);">&nbsp;Exclude&nbsp;
    </td><td>
        <select name=multipl4 id=multipl4 multiple="multiple"
         title="%STANDARD.01.035.VI" class="SelectMultipleLarge SelectBig"
         onclick="ValidateSelect(ReportForm.keystr15,this);">
        <option value=" ">All</option>
        %STANDARD.01.007.VI
        </select>
    </td><td align=left>Press CTRL or SHIFT to select multiple codes
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.035.P </td>
    <td><input type=radio name=keystr17 value="N" checked
         onclick="ClearSelect(ReportForm.multipl5);">&nbsp;Include
        <input type=radio name=keystr17 value="E"
         onclick="ClearSelect(ReportForm.multipl5);">&nbsp;Exclude&nbsp;
    </td><td>
        <select name=multipl5 id=multipl5 multiple="multiple"
         title="%STANDARD.01.035.P " class="SelectMultipleLarge SelectBig"
         onclick="ValidateSelect(ReportForm.keystr17,this);">
        <option value=" ">All</option>
        %STANDARD.01.007.P
        </select>
    </td><td align=left>Press CTRL or SHIFT to select multiple codes
    </td></tr>
</table>

<input type=hidden name=keystr19 value="%STANDARD.01.008">
<input type=hidden name=keystr20 value="Y">
<input type=hidden name=keystr21 value=" ">
<input type=hidden name=keystr22 value=" ">

<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td align=center colspan=2><br>
      <input type=button value="OK" class="button" name=btn_ok id=btn_ok
       onclick='ProcessReport();'>
      <input type=button value="Cancel" class="button"
       onclick='location.href="../lookups/blank.html"' >
    </td>
</tr>
</table>
</form>

<div id=SetDateRange style="display:none;">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Discharge Date Range</td>
    <td>
      <input type=text size=12 maxlength=12 name=datran01 id=datran01
       onblur='CheckPastDate(this,"From Date");'
       class="Mandatory" title="From Date">
      <img notab src="../images/DateTimeStamp.gif" class="Icon"
       alt="Current" date="document.ReportForm.datran01">
      <img notab src="../images/DateLookup.gif" class="Icon"
       alt="Calendar" date="document.ReportForm.datran01"> 
      To
      <input type=text size=12 maxlength=12 name=datran02 id=datran02
       onblur='CheckPastDate(this,"To Date");'
       class="Mandatory" title="To Date">
      <img notab src="../images/DateTimeStamp.gif" class="Icon"
       alt="Current" date="document.ReportForm.datran02">
      <img notab src="../images/DateLookup.gif" class="Icon"
       alt="Calendar" date="document.ReportForm.datran02">
    </td>
</tr>
</table>
</div>

<div id=SetScheduleRange style="display:none;">
<table width=80% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=25%>Discharge Date Range</td>
    <td><select name=datsch01 id=datsch01 title="Schedule Range" class=Mandatory
    onblur="UpReportSchedule(this,document.ReportForm.keystr03,
                                     document.ReportForm.keystr04);">
    <option></option></select>
    Sample Range
    <input type=text name=SampleFrom size=12> To
    <input type=text name=SampleTo size=12>
    </td></tr>
</table>
</div>
