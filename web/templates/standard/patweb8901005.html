<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="standard">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/AutoPostCode.js"> </script>
<script type="text/javascript" src="../js/AddressSearch.js"></script>
%START.OF.PAGE

<!--WORKERS COMP-->

<style type=text/css>

#SelectHeading{
position: absolute;
visibility: hidden;
top: 120px;
left: 320px;
height: 20px;
width: 350px;
overflow: none;
}

#SelectLocation{
position: absolute;
visibility: hidden;
top: 140px;
left: 320px;
height: 150px;
width: 350px;
overflow: auto;
}

</style>

<script type="text/javascript">

function setInsurance() {
  document.getElementById('InsuranceDIV').innerHTML=
                document.getElementById('InsuranceSPAN1').innerHTML;
  if (InsuranceKeywordSearch){
    document.getElementById('InsuranceDIV').innerHTML=
                document.getElementById('InsuranceSPAN2').innerHTML;
  }
}

if("%STANDARD.01.025.119.182.0.1" == "1") {  // ptcnepis
  var src="../js/eAdmissionReg.js"
} else {
  var src="../js/DefaultOnline.js";
}
var script = document.createElement("script");
             script.setAttribute("src", src);
             script.setAttribute("type", "text/javascript");
document.getElementsByTagName("head")[0].appendChild(script);

function SetFields() {
 state = UpdateForm.ptclm005;
 suburb = UpdateForm.ptclm004;
 postcode = UpdateForm.ptclm006;
}

function SearchPage(returnName,LookupPage) {
window.returnName=returnName ;
Lookup=open(LookupPage, "LookupWindow",
"width=150,height=200,top=20,left=20,scrollbars=yes,status=no,toolbar=no,menubar=no") ;
}


function PrintScreen(linkurl) {
  PrintWindow=open(linkurl,"PrintScreen",
    "width=400,height=150,top=50,left=50," +
    "titlebar=no,scrollbars=yes,status=no,toolbar=no,menubar=no");
}

function chgName()  {
  if (document.UpdateForm.chckname.value==0) {
  ans=confirm("Save old Name as Alais ?");
  if (ans) {
    document.UpdateForm.chckname.value="1"
    }
  }
}

function CheckFund(fund,selectlist)  {
var found=0
strvar=fund.value;
if(!isWhitespace(strvar)){
for (var i = 0 ; i < selectlist.length; i++) {
strvar=fund.value+"      "   // format as three characters space filled
fund.value=strvar.substr(0,6)
  if (selectlist.options[i].value.substr(0,6)==fund.value) {
         found=1
         selectlist.selectedIndex=i } }
if (found==0) { alert("Invalid Fund Entered")
                fund.focus() }
}
}

function UpdateFund(fund,selectlist) {
  fund.value=selectlist.value.substr(0,6);
}
function SubmitClaim() {
  ReturnPath=GetCookieData('InvoiceReturn');
  if (!isWhitespace(ReturnPath) && ReturnPath!='unknown') {
     document.cookie="InvoiceReturn=;"            // clear cookie
     document.UpdateForm.redirect.value=ReturnPath; // return to invoice scr
 } else if(document.UpdateForm.mvmedrec.value == "1") {
     document.UpdateForm.redirect.value="mrtweb01.pbl?reportno=09&template=004"
     + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
     + "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+");
 } else if (document.UpdateForm.returncd.value == "MEH") {
     document.UpdateForm.redirect.value="patweb89.pbl?reportno=07&template=001"
     + "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+")
     + "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+");
 } else {
     document.UpdateForm.redirect.value="patweb98.pbl?reportno=01&template=043"
     + "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+")
     + "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+");
 }

  if (typeof eAdmCookie!='undefined') {
    if (eAdmCookie!="unknown") {
      document.UpdateForm.redirect.value=eAdmCookie;
    }
  }

  document.UpdateForm.ptclm001.value=
  document.UpdateForm.ptclm001.value.replace(/'/g,"`");
  document.UpdateForm.ptclm002.value=
  document.UpdateForm.ptclm002.value.replace(/'/g,"`");
  document.UpdateForm.ptclm003.value=
  document.UpdateForm.ptclm003.value.replace(/'/g,"`");

  SubmitHidden(UpdateForm);
}

function CheckSuburb(Address) {
  if(Address!="") {
    LookupPostCode(Address);
  }
}

function valWC() {
validateWC(44,UpdateForm.urnumber,UpdateForm.admissno,UpdateForm.ptclm001,
               UpdateForm.ptclm002,UpdateForm.ptclm003,UpdateForm.ptclm004,
               UpdateForm.ptclm005,UpdateForm.ptclm006,UpdateForm.ptclm007,
               UpdateForm.ptclm008,UpdateForm.accepted,UpdateForm.ptclm009,
               document.getElementById('ptclm010'),
               UpdateForm.ptclm011,UpdateForm.ptclm012,
               UpdateForm.ptclm013,UpdateForm.ptclm033,UpdateForm.ptclm034,
               UpdateForm.ptclm035,UpdateForm.ptclm036,
               UpdateForm.dummy);

  for (var i =0 ; i < document.UpdateForm.ptclm009.length; i++) {
    if (document.UpdateForm.accepted.value==
        trim(document.UpdateForm.ptclm009.options[i].value.substr(0,1))){
          document.UpdateForm.ptclm009.selectedIndex=i;
    }
  }
}

function lookUpWC() {
WCRefNoSearchFrame(UpdateForm.urnumber,UpdateForm.ptclm001,UpdateForm.ptclm002,
                    UpdateForm.ptclm003,
                    UpdateForm.ptclm004,UpdateForm.ptclm005,UpdateForm.ptclm006,
                    UpdateForm.ptclm007,UpdateForm.ptclm008,UpdateForm.accepted,
                    document.getElementById('ptclm010'),UpdateForm.ptclm011,
                    UpdateForm.ptclm012,UpdateForm.ptclm013,UpdateForm.ptclm033,
                    UpdateForm.cinjure,UpdateForm.injcode,
                    UpdateForm.ptclm036,UpdateForm.ptclm034,
                    UpdateForm.ptclm035,UpdateForm.ptclm009);
}
function WCRefNoSearchFrame(urnumber,RetEName,RetAdd1,RetAdd2,RetAdd3,
                             RetAdd4,RetPost,
                             RetTele,RetCDat,RetAccPt,RetInsCod,RetClmNo,
                             RetComn1,RetComn2,RetAloc,RetCInj,RetInjCod,
                             RetCName,RetCInjSel,RetInjCodSel,RetAccPtSel) {
  DFrameStart();
  window.urnumber=urnumber;
  window.RetEName=RetEName;     window.RetAdd1=RetAdd1;
  window.RetAdd2=RetAdd2;       window.RetAdd3=RetAdd3;
  window.RetAdd4=RetAdd4;       window.RetPost=RetPost;
  window.RetTele=RetTele;       window.RetCDat=RetCDat;
  window.RetAccPt=RetAccPt;     window.RetInsCod=RetInsCod;
  window.RetClmNo=RetClmNo;     window.RetComn1=RetComn1;
  window.RetComn2=RetComn2;     window.RetAloc=RetAloc;
  window.RetCInj=RetCInj;       window.RetInjCod=RetInjCod;
  window.RetCName=RetCName;     window.RetCInjSel=RetCInjSel; 
  window.RetInjCodSel=RetInjCodSel;
  window.RetAccPtSel=RetAccPtSel;
  window.RetFunctn=getIName;

  document.getElementById('PopUpFrame').src="../lookups/WCRefNoSearchFrame.html";
  SearchFrameShow();
}
function getIName(){
   if(document.getElementById('d_ptclm010')){
     GetInsName(RetInsCod,
              document.getElementById('d_ptclm010'));
   }
}
function reInitialiseDate() {
  if (isWhitespace(document.UpdateForm.ptclm008.value)) {
    document.UpdateForm.ptclm008.value="";
  }
}
function OnlinePreadmissionSJOG() {
  AdmissionID=GetCookieData("AdmissionID")
  if (!isWhitespace(AdmissionID) && AdmissionID != "unknown") {
/* Any Post Preadmission Default Field Processing the following call back function  */
    var cb = function() {
    }
    DefaultOnline("webPASDefaultWCC",AdmissionID,cb);
    SetCookie("AdmissionID","")
  }
}
function GetEmployer() {
  if(!isWhitespace(UpdateForm.ptclm083.value)){
    var serverURL="../cgi-bin/mehweb01.pbl?reportno=13" +
                  "&srefcode=E" +
                  "&valdtype=1" +
                  "&valdcode=" + UpdateForm.ptclm083.value.replace(/ /g,"+")

    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|")
      document.UpdateForm.ptclm001.value=trim(ReturnValue[0]);
      document.UpdateForm.ptclm002.value=trim(ReturnValue[1]);
      document.UpdateForm.ptclm003.value=trim(ReturnValue[2]);
      document.UpdateForm.ptclm004.value=trim(ReturnValue[3]);
      document.UpdateForm.ptclm005.value=trim(ReturnValue[4]);
      document.UpdateForm.ptclm006.value=trim(ReturnValue[5]);
      document.UpdateForm.ptclm007.value=trim(ReturnValue[6]);
      document.UpdateForm.ptclm036.value=trim(ReturnValue[7]);
    }
  }
}
function portalPMI() {
  if(document.getElementById("ptcnepis").value=="1") {
    OnlinePreadmission();
    eAdmPreList();
  } else {
    OnlinePreadmissionSJOG();
  }
}

//
// Functions called from AddressSearch.js
//
function InitAddressSearch() {
  // line 1 - 'ptclm002'
  // line 2 - 'ptclm003'
  // suburb - 'ptclm004'
  // state - 'ptclm005'
  // postcode - 'ptclm006'

  InitAddressSearchFields('trAddrSrch','ptclm002','ptclm003','ptclm004','ptclm005','ptclm006');
}
function ShowAddressSearch() {
  OpenAddressSearch('1',PopulateAddress,ClearSearchAddress);
}
function PopulateAddress(StreetLine, Suburb, State, Postcode) {
  LookupSuburb(Postcode);  // validate Postcode with our Lookup values
  if (SelectPC.length == 0) return;  // no match found

  LookupPostCode(Suburb);  // validate Suburb
  if (SelectPC.length == 0) return;  // no match found

  ToggleFieldReadOnly('ptclm002', true);
  ToggleFieldReadOnly('ptclm003', false);
  ToggleFieldReadOnly('ptclm004', true);
  ToggleFieldReadOnly('ptclm005', true);
  ToggleFieldReadOnly('ptclm006', true);

  SetFieldValue('ptclm002',StreetLine);
  SetFieldValue('ptclm003','');
  SetFieldValue('ptclm004',Suburb);
  SetFieldValue('ptclm005',State);
  SetFieldValue('ptclm006',Postcode);
}
function ClearSearchAddress() {
  ToggleFieldReadOnly('ptclm002', false);
  ToggleFieldReadOnly('ptclm003', false);
  ToggleFieldReadOnly('ptclm004', false);
  ToggleFieldReadOnly('ptclm005', false);
  ToggleFieldReadOnly('ptclm006', false);

  SetFieldValue('ptclm002','');
  SetFieldValue('ptclm003','');
  SetFieldValue('ptclm004','');
  SetFieldValue('ptclm005','');
  SetFieldValue('ptclm006','');
}
</script>
<body onLoad="PageLoad(event);InitPostCodes();setInsurance();
              SetFields();setTimeout('portalPMI()',700);InitAddressSearch();
              document.UpdateForm.ptclm001.focus();">
<div id=PageHeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
</div>
<div id=PageBodySection>
<form name=UpdateForm action="patweb89.pbl" method=post
 onsubmit='return validateMandatory(this); return checkMedicare(ptmas023)'>
<input type=hidden name=reportno value="02">
<input type=hidden name=template value="005">
<input type=hidden name=updatety value="5">
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.101">
<input type=hidden name=chckname>
<input type=hidden name=nextpage value=2>
<input type=hidden name=funddesc value="%PATWEB89.01.040.1">
<input type=hidden name=mvmedrec value="%PATWEB89.01.902">
<input type=hidden name=admcltyp value="%PATWEB89.01.126.3">
<input type=hidden name=claimtyp value="W">
<input type=hidden name=ptclm012 value="">
<input type=hidden name=ptclm013 value="">
<input type=hidden name=accepted>
<input type=hidden name=cinjure>
<input type=hidden name=injcode>
<input type=hidden name=returncd value="%PATWEB89.01.933">
<input type=hidden name=orgntype id=orgntype value="E">
<input type=hidden name=ptcnepis id=ptcnepis
 value="%STANDARD.01.025.119.182.0.1" />
<input type=hidden name=admisnid id=admisnid value="%PATWEB89.01.999.036" />
<input type=hidden name=showflag value="0" />
<input type=hidden name=redirect value="%PATWEB89.01.001.patweb98.01.001">
<input type=hidden name=ptcnuadv id=ptcnuadv
 value="%STANDARD.01.025.123.247.0.1">

<table border=1 width=100% cellspacing=1 cellpadding=1>
<tr><td class=HeadingCell align=center>
    Workers Compensation Claim Details
</td></tr>

<tr><td>
    <table width=100% border=0>
    <tr><td class=DataLabel>Employer Code</td>
        <td><input type="text" size="6" name="ptclm083" id="ptclm083" 
             maxlength="6" onchange="GetEmployer();" value="%PATWEB89.01.386.0"
             title="Employer Code">
           <img src="../images/SearchIcon.gif" class=Icon
            onclick="ExOrgEmployerSearchFrame(ptclm083,ptclm001,orgntype,
                                              ptclm002,ptclm003,ptclm004,
                                              ptclm005,ptclm006,ptclm007,
                                              ptclm036);">
           <img src="../images/ClearIcon.gif" class=Icon
            onclick="clrFields(ptclm083);">
        </td>
    </tr>

    <tr><td class=DataLabel>Employer<br></td>
        <td><input type="text" size="35" name="ptclm001" id="ptclm001"
             tabindex=1 maxlength="30" value="%PATWEB89.01.301" 
             title="Employer Name">
        </td>
        <td class=DataLabel>Date of Accident</td>
        <td><input type="text" size="12" tabindex=9
             name=ptclm008 id=ptclm008 value="%PATWEB89.01.307"
             title="Accident Date" class=PastDate
             onblur="reInitialiseDate();checkDate(this,'Accident Date')">
            <img src=../images/DateLookup.gif class=Icon
             onclick="DateLookupFrame(ptclm008);">
        </td>
    </tr>

    <tr id=trAddrSrch style="display:none">
        <td class=DataLabel nowrap>Search Address</td>
        <td><input type=text readonly size=35 tabindex="-1"
             style="cursor:pointer;text-align:center;"
             value="Click here to search for an address"
             title="Click here to search for an address"
             onclick="ShowAddressSearch();">
        </td>
    </tr>

    <tr><td class=DataLabel>Address</td>
        <td><input type="text" size="35" maxlength="30" tabindex=2
             name="ptclm002" id="ptclm002" value="%PATWEB89.01.302"
             title="Address Line 1" onchange="UpCase(this);">
        </td>
        <td> Accident Location </td>
        <td><input type="text" size="35" maxlength="30" tabindex=9
             name="ptclm033" id="ptclm033" value="%PATWEB89.01.335"
             title="Accident Location">
        </td>
    </tr>

    <tr><td class=DataLabel></td>
	<td><input type="text" size="35" maxlength="30" tabindex=3 
             name="ptclm003" id=ptclm003 value="%PATWEB89.01.303"
             title="Address Line 2" onchange="UpCase(this);"
        ></td>
        <td class=DataLabel>Insurance<br></td>
	<td><div id="InsuranceDIV"></div></td>
    </tr>

    <tr valign=top><td class=DataLabel>Suburb</td>
        <td><input type="text" size="35" maxlength="30" tabindex=4 
             name="ptclm004" id=ptclm004 value="%PATWEB89.01.304" title="Suburb"
             onchange="CheckSuburb(this.value);">
        </td>
	<td class=DataLabel>Insurance Claim No.<br></td>
	<td><input type="text" name="ptclm011" id="ptclm011" size=25 
             maxlength=20 tabindex=11 value="%PATWEB89.01.310" 
             title="Insurance Claim Number">
            <img src="../images/SearchIcon.gif" class=Icon
             onclick="lookUpWC();">
        </td>
    </tr>

    <tr><td class=DataLabel>State</td>
	<td><input type="text" size="35" maxlength="35" tabindex=5  
             name="ptclm005" id=ptclm005 value="%PATWEB89.01.328" title="State">
            Post Code 
            <input type="text" size="8" maxlength="8" tabindex=6
             name="ptclm006" id=ptclm006 value="%PATWEB89.01.305"
             title="Post Code" onchange="LookupSuburb(this.value);">
        </td>
	<td class=DataLabel>Claim Accepted Insurance</td>
        <td><select name="ptclm009" id="ptclm009" tabindex=12 
             title="Claim Accepted Insurance">
              <option></option>
              %PATWEB89.01.308.2
            </select>
        </td>
    </tr>

    <tr><td valign="bottom" class=DataLabel>Employer Phone
        <td><input type="text" size="20" maxlength="20" tabindex=7
             name="ptclm007" id="ptclm007" title="Employer Phone" 
             value="%PATWEB89.01.306">
        </td>
        <td> Contact name </td>
        <td><input type="text" size='45' maxlength="40" tabindex=13 
             name="ptclm036" id="ptclm036" value="%PATWEB89.01.332" 
             title="Contact name">
        </td>
    </tr>

    <tr><td>Cause of Injury</td>
        <td><select name="ptclm034" id="ptclm034" tabindex=7 
             title="Cause of Injury">
              <option></option> 
              %PATWEB89.01.333.2
            </select>
        </td>
        <td> Injury Code </td>
        <td><select name="ptclm035" id="ptclm035" tabindex=14
             title="Injury Code"> 
              <option></option>
              %PATWEB89.01.334.2 
            </select>
        </td>
    </tr>
    </table>
</td></tr>
<tr><td colspan=4 align=center>
      <input type=button value="Update" tabindex=15 class="button" id="pat89sub"
       onclick="tempDisable(this);reInitialiseDate();SubmitClaim()";>
      <input type=button value="Cancel" tabindex=16 class="button"
       onclick="SetCancel()">
    </td>
</tr>
</table>
</form>

<div id=SelectHeading></div>
<div id=SelectLocation></div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
<input type=hidden name=MenuType value="%PATWEB89.01.088">
</form>

<span id="InsuranceSPAN1" style="display:none">
  <select name="ptclm010" id="ptclm010" tabindex=10 title="Insurance">
              <option> </option>
              %PATWEB89.01.309.2
  </select>
</span>

<span id="InsuranceSPAN2" style="display:none"> 
  <input type="text" size="6" name="ptclm010" id="ptclm010"
      value="%PATWEB89.01.309.0" title="Insurance"
      onchange="GetInsName(UpdateForm.ptclm010,UpdateForm.d_ptclm010)"> 
      
  <input type="text" size="35" name="d_ptclm010" id="d_ptclm010"
      tabindex=11 maxlength="30" value="%PATWEB89.01.309.1"
      title="Insurance">
    <img src="../images/SearchIcon.gif" class=Icon
	onclick="InsuranceSearchFrame(ptclm010,d_ptclm010);">
        <img src="../images/ClearIcon.gif" class=Icon
                onclick="clrFields(ptclm010,d_ptclm010);">
</span>

<script type="text/javascript">
function SetCancel() {
  if (!confirm("Warning: Injury/Accident Data will not be Updated!\n Ok to Continue ?")) {
   return;
  } 

  ReturnPath=GetCookieData('InvoiceReturn');
  if (!isWhitespace(ReturnPath) && ReturnPath!='unknown') {
    document.cookie="InvoiceReturn=;" // clear cookie
    var link=ReturnPath;              // return to invoice scr
  }
  else {
    var urnumber ="%PATWEB89.01.003";
    var admissno ="%PATWEB89.01.101";
    var link = "patweb98.pbl?reportno=01&template=001&urnumber="+urnumber
              +"&admissno="+admissno;
  }
  location.href= link;
}


for (var i =0 ; i < document.UpdateForm.ptclm009.length; i++) {
  if (document.UpdateForm.ptclm009.options[i].value=="%PATWEB89.01.308.0") {
    document.UpdateForm.ptclm009.selectedIndex=i;
  } 
};

PmiPatientFolder="%PATWEB89.01.879.3"
PTCNCOMF="%STANDARD.01.025.110.243.0.1"
if (PmiPatientFolder.substr(3,1) != "3" && PTCNCOMF=="2") {
  alert("Patient folder conflict - " +
        "Patient folder details will be updated.");
}

claimindic=document.UpdateForm.admcltyp.value.substr(29,1);
if (claimindic=="W" ) {
  document.UpdateForm.ptclm083.className="Mandatory";
}

</script>
