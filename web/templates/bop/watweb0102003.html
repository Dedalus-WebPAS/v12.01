<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="bop">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/watweb0102.js"></script>
<script type="text/javascript">

//Sets the array to store specialities
var specialtyArray = new Array();
var selectedSpecialty = -1;

function setLastReview(){
  UpdateForm.wattr007.value=""
  UpdateForm.wattr007.className="Mandatory"
}

/*
function checkPriority(){
  if(trim(UpdateForm.wattr014.value.substr(6,1))=="T"){
    UpdateForm.wattr025.className="Mandatory"
  }
  else if(trim(UpdateForm.wattr014.value.substr(6,1))=="P"){
    UpdateForm.wattr025.className="Mandatory"
  }
  else {
    UpdateForm.wattr025.className="";
  }
}
*/
function init() {
  //checkPriority();
  UpdateForm.redirect.value+="watweb01.pbl?reportno=4&template=4&casekeys=" +
                             PatientLinks.casekeys.value.replace(/ /g,"+");
}

function ChgReason() {
  UpdateForm.wathi001.className="Mandatory";
}

function EnterSus() {
  ChgStat();
  i=document.UpdateForm.wattx004.selectedIndex;
  ind=document.UpdateForm.wattx004.options[i].value.substring(3,4);
  if (ind !="R") {
    CASEKEYS=PatientLinks.casekeys.value.replace(/ /g,"+");
    LinkUrl="watweb01.pbl?reportno=5&template=002&casekeys="+CASEKEYS;
    Left=(document.body.clientWidth-650)/2;
    DFrameLink(LinkUrl,50,Left,650,400);
  }
}

function ChgStat() { }

function Listst() {
  i=document.UpdateForm.ListStat.selectedIndex;
  document.UpdateForm.wattx004.value=document.UpdateForm.ListStat.options[i].value.substring(3,6);
}

function UpdateWat() {
  if (document.UpdateForm.wattr025.value=="" &&
      document.UpdateForm.certainty.value!=""){
    alert("Unable to clear Certainty Date " +
           document.UpdateForm.certainty.value +
          ", use supervisor function." ) 
    return;
  }
  datechk=validateOpDate();
  if (!datechk) {
    return;
  }
  datechk2=validateTime();
  if (!datechk2) {
    return;
  }

  document.UpdateForm.wattr017.value = document.UpdateForm.specialt.value;

  if (validateMandatory(UpdateForm)) {
    linkACC();
    document.UpdateForm.submit();
  }
}
//
//------------------------------------------------------------
// Set Link ACC Redirect and Return program after link ACC
//------------------------------------------------------------
function linkACC() {
  if (UpdateForm.wattx026.value.substr(3,1)=='W') {
  UpdateForm.redirect.value="patweb89.pbl?reportno=01&template=005&systflag=4"+
                "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
                "&casekeys=" + PatientLinks.casekeys.value.replace(/ /g,"+") 
  }
}
function validateOpDate(){
  date1=UpdateForm.wattr008.value;
  date2=UpdateForm.wattr028.value;

  if (isWhitespace(UpdateForm.wattr028.value) ||
      isWhitespace(UpdateForm.wattr008.value)) {
    return true;
  }
  else { 
    if(ChkDateTime2(date1,date2)) {
     message=" \"Proposed Operation Date\" should be equal to or greater than ";
     message+="\"Proposed Admission Date\"";
     alert(message);
     return false;
    }
    return true;
  }
}
function ChkDateTime1(strtDate,endDate) {
  var strtDay  = strtDate.substring(0,2);
  var strtMon  = strtDate.substring(3,6);
  var strtYear = strtDate.substring(7,11);

  var endDay   = endDate.substring(0,2);
  var endMon   = endDate.substring(3,6);
  var endYear  = endDate.substring(7,11);

  strtMon = GetMonthNumber(strtMon);
  endMon  = GetMonthNumber(endMon);

  var strtDateTime = strtYear + strtMon + strtDay 
  var endDateTime  = endYear + endMon + endDay 
  if (endDateTime <= strtDateTime ) return false;
  return true;
}
//
function ChkDateTime2(strtDate,endDate) {
  var strtDay  = strtDate.substring(0,2);
  var strtMon  = strtDate.substring(3,6);
  var strtYear = strtDate.substring(7,11);

  var endDay   = endDate.substring(0,2);
  var endMon   = endDate.substring(3,6);
  var endYear  = endDate.substring(7,11);

  strtMon = GetMonthNumber(strtMon);
  endMon  = GetMonthNumber(endMon);

  var strtDateTime = strtYear + strtMon + strtDay
  var endDateTime  = endYear + endMon + endDay
  if (endDateTime >= strtDateTime ) {
     return false;
  }
  return true;
}
function validateTime(){
  date1=UpdateForm.wattr008.value;
  date2=UpdateForm.wattr006.value;

  if (ChkDateTime1(date1,date2)) {
    message=" \"Proposed Admission Date\" cannot be before";
    message+="\"Date on List\"";
    alert(message);
    return false;
  }
  return true;
}

function RemoveQuote(Field) {
  Field.value=Field.value.replace(/\"/g,"");
}
</script>

</head>
%START.OF.PAGE
<body onload="PageLoad(event);createSpecialtyArray();
              buildDrSpecList(UpdateForm.n_wattr012.value,
                              UpdateForm.wattr012.value,
                              UpdateForm.wattr006.value);">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%WATWEB01.02.003";
PatientVIS="%WATWEB01.02.081";
PatientNAM="%WATWEB01.02.002";
PatientSTA="%WATWEB01.02.086.078";
PatientALT="%WATWEB01.02.084";
PatientSEX="%WATWEB01.02.019";
PatientDOB="%WATWEB01.02.020";
PatientAGE="%WATWEB01.02.021";
PatientLOC="%WATWEB01.02.083";
DoctorCOD="%WATWEB01.02.082.003";
DoctorNAM="%WATWEB01.02.082.002";
PatientAID="%WATWEB01.02.086.090";
PatientIND="%WATWEB01.02.086.091";
PatientCUR="%WATWEB01.02.086.092";
PatientCLC="%WATWEB01.02.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%WATWEB01.02.086.094";
PatientCDM="%WATWEB01.02.086.095";
PatientVDH="%WATWEB01.02.086.099.015";
PatientUNT="%WATWEB01.02.066.0";
PatientPRI="%WATWEB01.02.086.066.1";
InsertPatientHeader()
</script>

<div id=PatientMenu></div>
<div id=PageBodySection style="overflow: auto;">

<form name=UpdateForm action="watweb01.pbl" method=post
 onsubmit="Listst();return validateMandatory(this);">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=1>
<input type=hidden name=casekeys value="%WATWEB01.02.101">
<input type=hidden name=updttype value="U">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="">
<input type=hidden name=dummy value="">
<input type=hidden name=wattr017 id=wattr017 value="">
<input type=hidden name=wattx004 value="">
<input type=hidden name=certainty value="%WATWEB01.02.132">

<table border=0 width=100% cellspacing=0 align=center cellpadding=1>
<tr><td class=HeadingCell align=center>
    Update Waiting List Entry - Event Number %WATWEB01.02.125  </td>
</tr>
</table>

<table border=0 width=95% cellspacing=0 cellpadding=1 align=center>
<tr><td class=DataLabel>Referral Date</td>
    <td class=DataField>
    <input type=text name=wattr006 size=12 
     title="Date on List" class=Readonly readonly
     value="%WATWEB01.02.109"  onblur="checkDate(this,'Date')">
    </td></tr>
<tr><td class=DataLabel>Procedure Code        </td>
    <td class=DataField>
    <input type=text  class=Readonly  readonly name=wattr001  
    title="Procedure Code" value=%WATWEB01.02.103 ></td>
    <td class=DataLabel>Proposed Adm. Date   </td>
    <td><input type=text name=wattr008 size=12 maxlength=12 tabindex=11
     title="Proposed Admission Date"
     onblur="checkDate(this,'Date')" value="%WATWEB01.02.111" >
    <img src=../images/DateLookup.gif class=Icon
     date=UpdateForm.wattr008>


<tr><td class=DataLabel>Procedure</td>
    <td class=DataField >
   <input type=text name=wattr003 size=60 tabindex=5
    maxlength=50 value="%WATWEB01.02.106" onblur="RemoveQuote(this);"></td>
    <td class=DataLabel >Preadmission Date </td>
    <td class=DataLabel>
     <input type=text name=wattr022 size=12 maxlength=12 tabindex=70 
      value="%WATWEB01.02.127" onblur="checkDate(this,'Date');">
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.wattr022>
                        Time
    <input type=text name=wattx028 size=8   maxlength=12  tabindex=75    
      title="Preadmission Time" value="%WATWEB01.02.528" >
    <img src=../images/DateTimeStamp.gif  class=Icon
     date=UpdateForm.wattr022 time=UpdateForm.wattx028>
    <img src=../images/TimeLookup.gif class=Icon
     time=UpdateForm.wattx028></td>
    </tr>

<tr valign=top><td class=DataLabel></td>
    <td class=DataField>
    <input type=text name=wattr004 size=60 maxlength=40 tabindex=10
     value="%WATWEB01.02.107" onblur="RemoveQuote(this);"></td>
    <td class=DataLabel>Pre-Anaesthetic Date</td>
    <td class=DataLabel>
    <input type=text name=wattr042 size=12 
     value="%WATWEB01.02.152"  onblur="checkDate(this,'Date');"
     title="Pre-Anaesthetic Date" tabindex=80>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.wattr042>
                        Time
    <input type=text name=wattx031 size=8 maxlength=12  tabindex=80    
      title="Pre-Anaesthetic Time" value="%WATWEB01.02.531" >
    <img src=../images/DateTimeStamp.gif  class=Icon
     date=UpdateForm.wattr042 time=UpdateForm.wattx031>
    <img src=../images/TimeLookup.gif class=Icon
     time=UpdateForm.wattx031>
    </td>
    </tr>

<tr><td class=DataLabel>Duration of Procedure  </td>
    <td class=DataField>
    <input type=text name=wattr002 size=10 tabindex=12 maxlength=5   
       title="Estimated Operating time" class=Integer min=0 
       value=%WATWEB01.02.105></td>
    <td class=DataLabel>Pre-Anaesthetic Status</td>
    <td class=DataLabel>
    <select name=wattx030 class=selectBig title="Pre-Anaesthetic Status"
     tabindex=81>
    <option></option>
    %WATWEB01.02.530.2
    </select>
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.TP</td>
    <td class=DataField>
    <select name=wattr014  class=Mandatory title="%STANDARD.01.017.TP"
       onchange="/*checkPriority();*/" tabindex=13>
    <option></option>
    %WATWEB01.02.117.2
    </select></td>

     <td class=DataLabel>Patient Confirmed  </td>
     <td><input type=text name=wattr023 size=12 maxlength=12 tabindex=85  
     title="Patient Confirmed Date" 
     onblur="checkDate(this,'Date')" onchange=ChgReason();
      value="%WATWEB01.02.128" >
    <img src=../images/DateLookup.gif class=Icon
     date=UpdateForm.wattr023>
<tr><td class=DataLabel>Score</td>
    <td class=DataLabel>
    <input type=text name=wattr047 size=5 maxlength=5 tabindex=15
     class="Integer" min=0 title="Score" value="%WATWEB01.02.157"
     onchange=setLastReview();>
   </td>

    <td class=DataLabel>Reason For Change </td>
    <td class=DataField >
    <select name=wathi001 title="Reason for Change" tabindex=90
     class=selectBig >
    <option></option>
    %WATWEB01.02.314.2
    </select></td>
<tr><td class=DataLabel>Last Review Date</td>
    <td class=DataField>
    <input type=text name=wattr007 size=12 
     value="%WATWEB01.02.110"  onblur="checkDate(this,'Date');"
     title="Date of Change" tabindex=16>
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.wattr007
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.wattr007>
    </td>

    <td class=DataLabel>Proposed Op. Date</td>
    <td class=DataLabel >
    <input type=text name=wattr028 size=12 maxlength=12 tabindex=95 
      title="Date" value="%WATWEB01.02.135" onblur="checkDate(this,'Date');">
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.wattr028>
    Time
    <input type=text name=wattx029 size=8 maxlength=8 tabindex=96 title="Time"
     value="%WATWEB01.02.529">
    <img src=../images/DateTimeStamp.gif class=Icon
     date=UpdateForm.wattr028 time=UpdateForm.wattx029>
    <img src=../images/TimeLookup.gif class=Icon  time=UpdateForm.wattx029>
    </td></tr>
<tr><td class=DataLabel>%STANDARD.01.017.P   </td>
    <td class=DataField>
    <select name=wattr024  tabindex=20 class="selectBig"
     title="%STANDARD.01.017.P ">
    <option></option>
     %WATWEB01.02.131.2
    </select></td>
    <td class=DataLabel> Scheduled Adm. Date </td>
    <td class=DataLabel>
    <input type=text name=bokrx006 size=12 
     value="%WATWEB01.02.706" class=Readonly readonly>
    Confirmed Op. Date
    <input type=text size=12 value="%WATWEB01.02.710"
      class=Readonly readonly>
    </td></td>

<tr><td class=DataLabel>Admitting Point  </td>
    <td class=DataField>
    <select name=wattx006 tabindex=25 class="selectBig"
     title="Admitting Point">
    <option></option>  
    %WATWEB01.02.506.2
    </select></td>
    <valign=top><td class=DataLabel>Comments</td>

<tr><td class=DataLabel>Exp. Post Op Ward  </td>
    <td class=DataField>
    <select name=wattx005 tabindex=30 class="selectBig" 
     title="Exp. Post Op Ward">
    <option></option>  
    %WATWEB01.02.505.2
    </select></td>
    <td class=DataField rowspan=3 colspan=2> 
    <textarea wrap=hard name=wattrcom cols=50 
     tabindex=97 rows=3>%WATWEB01.02.161</textarea></td></tr>

<tr><td class=DataLabel>Planned LOS </td>
    <td class=DataField>
    <input type=text name=wattr013 size=5 maxlength=5 tabindex=35
     class="Integer" min=0 value="%WATWEB01.02.116"
     title="Planned LOS">(days)</td>

<tr><td class=DataLabel >Consultant</td>
    <td class=DataField >
    <input type=text name=wattr012 size=8 maxlength=8 readonly
     title="Consultant" class=readOnly value="%WATWEB01.02.115.003">
    <input type=text name=n_wattr012 size=40 readonly
      title="Consultant Name" value="%WATWEB01.02.115.002"></td>

<tr><td class=DataLabel>Unit</td>
    <td class=DataField>
    <input type=hidden name=wattr011 value="%WATWEB01.02.114.1">
    <input type=text readonly size=30 class=Readonly name=xxxtr011 
        value="%WATWEB01.02.114.0" readonly> </td>
    <valign=top><td class=DataLabel>Preadmission Notes</td><tr>
   
<tr><td class=DataLabel>%STANDARD.01.017.A </td>
    <td class=DataField>
    <select name=specialt id=specialt tabindex=40 class="Mandatory selectBig"
     title="%STANDARD.01.017.A ">
    <option></option>
     %WATWEB01.02.120.2
    </select></td>
    <td class=DataField rowspan=3 colspan=2>
    <textarea wrap=hard name=wtpccomm  tabindex=98
    cols=50 rows=3 tabindex=20>%WATWEB01.02.172</textarea></td></tr>

<tr><td class=DataLabel>Referral Source</td>
    <td class=DataField>
    <select name=wattr050 tabindex=45 class="selectBig Mandatory"
     title="Referral Source">
    <option></option>
    %WATWEB01.02.187.2
    </select></td>


<tr><td class=DataLabel>%STANDARD.01.017.CL  </td>
    <td class=DataField> 
    <select name=wattx026 tabindex=50 class=selectBig  title="">
    <option></option>
    %WATWEB01.02.526.2
    </select></td></tr>

<tr><td class=DataLabel>Certainty Date</td>
    <td class=DataField>
    <input type=text name=wattr025 size=12 class="Mandatory" 
     value="%WATWEB01.02.132"  onblur="checkDate(this,'Date');"
     title="Decision to Admit Date" tabindex=55>
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.wattr025
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.wattr025>
    </td>
    <td class=DataLabel>Principal Purchaser</td>
    <td class=DataField>
    <select name=wattr053 tabindex=98 title="Principal Purchaser" 
            class=Mandatory>
    <option></option>
    %WATWEB01.02.190.2
    </select></td></tr>

<tr><td class=DataLabel>FSA Referral</td>
    <td class=DataField>
    <input type=text name=wattr051 size=12
     value="%WATWEB01.02.188"  onblur="checkDate(this,'Date');"
     title="FSA Referral" tabindex=57>
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.wattr051
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.wattr051>
    </td>
    <td class=DataLabel>FSA Date</td>
    <td class=DataField>
    <input type=text name=wattr052 size=12
     value="%WATWEB01.02.189"  onblur="checkDate(this,'Date');"
     title="FSA Date" tabindex=100>
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.wattr052
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.wattr052>
    </td></tr>
    
<tr><td class=DataLabel>Date Keyed        </td>
    <td class=DataField>
    <input type=text class=Readonly readonly size=12   maxlength=12 
     tabindex=65 value="%WATWEB01.02.126"></td>

<td class=DateLabel>Operator ID </td>
    <td class=DataField>
    <input type=text size=12 maxlength=12 class=Readonly readonly 
    notab value= '%WATWEB01.02.310' ></td></tr>

<tr><td colspan=4>&nbsp;</td></tr>

<tr><td colspan=4 align=center>
    <input type=button class="button" value="Ok" tabindex=130
     onclick="UpdateWat();">
    <input type=button value="Cancel" tabindex=140 class="button" 
     onclick='PatientLinkTo("watweb01.pbl",2,1,0,0,0);'>
   </td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%WATWEB01.02.003">
<input type=hidden name=admissno value="%WATWEB01.02.125">
<input type=hidden name=MenuType value="%WATWEB01.02.088">
<input type=hidden name=casekeys value="%WATWEB01.02.101">
</form>
