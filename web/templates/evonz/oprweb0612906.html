<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="evonz">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/oprweb06.js"> </script>
<script type="text/javascript">
%START.OF.PAGE

function redirectASA (elem) { elem.value = "oprweb01.pbl|04|901|1|400|200" }
function resetASA (elem) { elem.value = "Set ASA Score" }

function init()
{
  setFocusOnTimeArrived();
}

function setFocusOnTimeArrived()
{
   var opard002 = document.getElementById("timecheck02");

   if(opard002)
     opard002.focus();

}

function validateNurse(code,name) {
  validateCode('17',code,name,document.UpdateForm.gnm);
  SetNurseName(name);
}
function SetNurseName(name) {
  name.value=UpdateForm.gnm.value.replace(/\s*$/g,"") + " " +
             name.value.replace(/\s*$/g,"")
}

function chkTime(field){
  if(isWhitespace(field.value))
    return;
  endTime=UpdateForm.opsrg006.value.replace(/:/g,"");
  OperDate=document.UpdateForm.casekeys.value.substring(0,8);
  if(document.UpdateForm.currdate.value > OperDate) {
    return;
  }
}

function ChgSurgeon() {
  UpdateForm.target="PopUpFrame"
  if (UpdateDayProc()) {
    setTimeout('showChgSur()',100);
  }
  UpdateForm.target="";
}

function showChgSur() {
  caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
  teamNumb=UpdateForm.teamnumb.value;
  linkurl="oprweb06.pbl?reportno=12&template=005&casekeys="+caseKeys+
          "&teamnumb="+teamNumb;
  Left=(document.body.clientWidth-750)/2
  DFrameLink(linkurl,100,Left,750,350)
}

// Change Theatre
function ChgOpr() {
  UpdateForm.target="PopUpFrame"
  if (UpdateDayProc()) {
    setTimeout('showChgOpr()',100);
  }
  UpdateForm.target="";
}

function showChgOpr() {
  linkurl="oprweb01.pbl?reportno=4&template=014&casekeys="
           +UpdateForm.casekeys.value; 
  Left=(document.body.clientWidth-350)/2
  DFrameLink(linkurl,100,Left,350,180)
}

function AddMBSItem() {
  UpdateForm.target="PopUpFrame"
  if (UpdateDayProc()) {
      setTimeout('showMBS()',100);
  }
  UpdateForm.target="";
}

function BillMBSItems() {
  document.UpdateForm.updatety.value="B";

  if (UpdateForm.ovrnight.checked == true)
    UpdateForm.opsrg071.value = "1";

  formSubmit();
}

function showMBS() {
  caseKeys=UpdateForm.casekeys.value.replace(/ /g,"+");
  teamNumb=UpdateForm.teamnumb.value;
  Left=(document.body.clientWidth-600)/2
  DFrameLink("oprweb06.pbl?reportno=02&template=002&casekeys="+caseKeys +
             "&teamnumb="+teamNumb,100,Left,600,350);
}

function AddImplant(){
  UpdateForm.target="PopUpFrame"
  if (UpdateDayProc()) {
    setTimeout('showImplant()',100);
  }
  UpdateForm.target="";
}

function showImplant() {
  Left=(document.body.clientWidth-750)/2
  LinkUrl="oprweb06.pbl?reportno=7&template=4&casekeys=" +
           PatientLinks.casekeys.value+"&teamnumb="+
           PatientLinks.teamnumb.value;
  DFrameLink(LinkUrl,100,Left,750,350);
}

function ChkRecovDelay() {
  var timeInRec = UpdateForm.opard077.value;
  var timeThrExit = UpdateForm.opard080.value;
  if ((isWhitespace(timeInRec)) || (isWhitespace(timeThrExit))) {
    UpdateForm.opard084.className="";
    return;
  }

  var recTime = new Date();
  var exitTime = new Date();

  // Set Recovery-Day Time
  recTime.setHours(timeInRec.substr(0,2));
  recTime.setMinutes(timeInRec.substr(3,2));
  recTime.setSeconds(timeInRec.substr(6,2));
  var recTimeSec = recTime.getTime();

  // Set Theatre Exit Time
  exitTime.setHours(timeThrExit.substr(0,2));
  exitTime.setMinutes(timeThrExit.substr(3,2));
  exitTime.setSeconds(timeThrExit.substr(6,2));
  var exitTimeSec = exitTime.getTime();

  // Calculate difference
  var timeDif = exitTimeSec - recTimeSec;
  // If time difference is greater than 6 hours then set 'Recovery Delay 
  // Reason' to be a mandatory field
  if (timeDif > 21600000)              // 6 hours = 21600000 miliseconds
    UpdateForm.opard084.className="Mandatory";
  else
    UpdateForm.opard084.className="";
}
function SetPrinter(SelectList) {
 if (SelectList.className=="SelectBig") {
     SelectList.className="Mandatory SelectBig" }
 else {
     SelectList.className="SelectBig" }
}

// Update Day Procedure Details
function UpdateDayProc() {
   document.UpdateForm.updatety.value="U";

   // Set Anaesthetic Prep Time to be equal to Anaesthetic Start Time.  
   document.UpdateForm.opard041.value = document.UpdateForm.opard042.value;

   // Set Prep Time to be equal to Surgery Start Time. This is required
   // for calculation of Actual Operation Minutes.
   document.UpdateForm.opsrg003.value = document.UpdateForm.opsrg005.value;

   // Set Dressing Time to be equal to Surgery End Time. This is required
   // for calculation of Actual Operation Minutes.
   document.UpdateForm.opsrg004.value = document.UpdateForm.opsrg006.value;

   document.UpdateForm.opard043.value = document.UpdateForm.opard077.value

   if (UpdateForm.ovrnight.checked == true)
     UpdateForm.opsrg071.value = "1";

   return(formSubmit());

}

function chkAnaesTime() {
  if(!isWhitespace(UpdateForm.opard042.value)) {
    if(isWhitespace(UpdateForm.opard002.value)) {
      alert("Arrival Time must be entered first.");
      UpdateForm.opard042.value="";
      UpdateForm.opard002.focus();
      return;
    }
    ArrivT= UpdateForm.opard002.value.replace(/:/g,"");
    AnaesT= UpdateForm.opard042.value.replace(/:/g,"");
    if(AnaesT < ArrivT) {
      if(confirm("Anaesthetic/Prep Time should be greater than Arrival Time."
                 + "\n Do you want to override")) {
        return;
      }
      UpdateForm.opard042.value="";
      UpdateForm.opard042.focus();
    }
  }
}

// Validate Surgery Start Time
function chkSurgStart() {
  if(!isWhitespace(UpdateForm.opsrg005.value)) {
    if(isWhitespace(UpdateForm.opard042.value)) {
      alert("Anaesthetic/Prep Time must be entered first.");
      UpdateForm.opsrg005.value="";
      UpdateForm.opard042.focus(); 
      return;
    }
    var anaeTime = trim(UpdateForm.opard042.value.replace(/:/g,""))
    var surgStrt = trim(UpdateForm.opsrg005.value.replace(/:/g,""))
    anaeTime=anaeTime.substr(0,4)
    surgStrt=surgStrt.substr(0,4)
    anaeTime=anaeTime - 0;
    surgStrt=surgStrt - 0;
    if(anaeTime > surgStrt) {
      if(!confirm("Surgery Start Time should be greater than Anaesthetic/Prep"+
                  " Time.\n Do you want to override")) {
        UpdateForm.opsrg005.value="";
        UpdateForm.opsrg005.focus()
        return;
      }
    }
  }
}

function setETTime(extime) {
  document.UpdateForm.opard080.value=extime.value;
  ChgRTD();
}

function ChgRTD() {
  if(!isWhitespace(UpdateForm.opard080.value)) {
    UpdateForm.opard080.className= "Mandatory"
  }
  else {
    UpdateForm.opard080.className=" "
  }
}

// Refresh Page
function RefreshPage() {
   document.UpdateForm.method="get"
   document.UpdateForm.updatety.value="";
   document.UpdateForm.template.value="906";
   document.UpdateForm.submit();
}
// Link To Procedure List
function goToProcedure() {
  uniqueky=UpdateForm.uniqueky.value.replace(/ /g,"+")
  Urnumber=PatientLinks.urnumber.value.replace(/ /g,"+")
  Admissno=PatientLinks.admissno.value.replace(/ /g,"+")
  UpdateForm.redirect.value="patweb89.pbl?reportno=09&template=4&uniqueky="+
                             uniqueky + "&urnumber=" + Urnumber +
                             "&admissno="+Admissno
  UpdateDayProc();
}
// Link To Staff List
function goToStaff() {
  caseKey=UpdateForm.casekeys.value.replace(/ /g,"+")
  temp=document.UpdateForm.teamnumb.value;
  supr=document.UpdateForm.suprlevl.value;
  UpdateForm.redirect.value="oprweb06.pbl?reportno=12&template=2&casekeys="+
                             caseKey+"&teamnumb="+temp+"&rdirflag=9"+
                             "&suprlevl="+supr;
  UpdateDayProc();
}

// Form Submit
function formSubmit() {
   if(validateMandatory(UpdateForm)) {
      casekey=UpdateForm.casekeys.value.substr(0,23);
      casekey=casekey.replace(/ /g,"+");
      uniqkey=UpdateForm.uniqueky.value
      uniqkey=uniqkey.replace(/ /g,"+");
      if (isWhitespace(UpdateForm.redirect.value)) {
        UpdateForm.redirect.value="oprweb06.pbl?reportno=12&template=906"+
                                  "&uniqueky="+uniqkey+"&teamnumb="; 
      }
      if(checkTimeOrder())
      {
        document.UpdateForm.submit();
        return true;
      }
    }
    else
      return false;
}

function checkTimeOrder()
{

 var arriveTime = UpdateForm.opard002;
 var anseatTime = UpdateForm.opard042;
 var surgStTime = UpdateForm.opsrg005;
 var surgEnTime = UpdateForm.opsrg006;
 var exitThTime = UpdateForm.opard080;
 var dayRecTime = UpdateForm.opard077;

 var arrayObj = new Array();

 arrayObj.push(arriveTime);
 arrayObj.push(anseatTime);
 arrayObj.push(dayRecTime);
 arrayObj.push(exitThTime);

 for(var i = 1; i < arrayObj.length; i++)
 {
   if(arrayObj[i].value != "")
   {
     if(checkTimeEnter(arrayObj[i-1]))
       return false;

     if(UpdateForm.ovrnight.checked != true)
     {
       if(validateGreatestTime(arrayObj[i-1],arrayObj[i]))
          return false;
     }
    }
 }

 return true;

}
function checkTimeEnter(obj)
{
   if(obj.value == 0)
   {
     alert(obj.title+" must be entered first");
     obj.focus();
     obj.select();
     return true;
   }
  return false;
}
//C-0825792 - Check parameter to Use pmshcpaf/oprnuraf for OT Nurse
function chkHcpOTNurse(){
  if (document.getElementById('opcnurse')) {
      if (document.getElementById('opcnurse').value == "1") {
        return true;
      }
      else {
        return false;
      }
  }
  else {
      return false;
  }
}

// Set Team no.
function set(){
 PatientLinks.teamnumb.value=UpdateForm.teamnumb.value;
}

// Procedure Description to be made Mandatory
function ProcMan() {
  if(!isWhitespace(UpdateForm.opard077.value))  
    UpdateForm.opdea014.className="Mandatory";
  else
    UpdateForm.opdea014.className="";
}

// Default field values according to 'No Recovery' checkbox checked status
function SetNoRecovery() {
  var chkbox = UpdateForm.norecovr;
  if (chkbox == undefined)
    return;

  if (chkbox.checked) {
    // Default 'Into/Out Recovery' field with value of 'Patient out of Theatre'
    UpdateForm.opard085.value = UpdateForm.opard077.value;  // Recovery Delay
    UpdateForm.opard085.readOnly = true;
    UpdateForm.opard085.className = "Readonly";
	
    UpdateForm.opard080.value = UpdateForm.opard077.value;  // Out of Recovery
    UpdateForm.opard080.readOnly = true;
    UpdateForm.opard080.className = "Readonly";
  }
  else {
    UpdateForm.opard077.readOnly = false;
    UpdateForm.opard077.className = "";
    UpdateForm.opard085.readOnly = false;
    UpdateForm.opard085.className = "";
    UpdateForm.opard080.readOnly = false;
    UpdateForm.opard080.className = "";
  }
}
// Validate Patient out of Theatre Time
function chkSurgEnd() {
  if(!isWhitespace(UpdateForm.opsrg006.value)) {
    if(isWhitespace(UpdateForm.opsrg005.value)) {
      alert("Surgery Start Time must be entered first.");
      UpdateForm.opsrg006.value="";
      UpdateForm.opsrg005.focus(); 
      return;
    }
    else {
      SetNoRecovery();     
    }
	valPrepDress();
  }
}

// Validate Prep Start/Surgery Start and Dressing/Surgery End Times
function valPrepDress() {
  var prepTime = trim(document.UpdateForm.opsrg005.value.replace(/:/g,""));
  var dressTime = trim(document.UpdateForm.opsrg006.value.replace(/:/g,""));
  if (isWhitespace(dressTime) || isWhitespace(prepTime))
    return;

  if ((dressTime < prepTime) && (UpdateForm.ovrnight.checked != true)) {
    if(confirm("Is Surgery End the day after Surgery Start time?"))
      UpdateForm.ovrnight.checked=true;
    else
      UpdateForm.opsrg006.focus();
      return;
  }

  if ((dressTime >= prepTime) && (UpdateForm.ovrnight.checked == true)) {
    if(!confirm("Warning: The Overnight Indicator is set - Time difference " +
       "between\nSurgery Start time and Surgery End time is greater than " +
       "24 hours!")) {
      UpdateForm.ovrnight.focus();
      return;
    }
  }
}

// Show Billing Comments
function BillingComments() {
  UpdateForm.target="PopUpFrame"
  if (UpdateDayProc()) {
    setTimeout('showBillCommts()',100);
  }
  UpdateForm.target="";
}

function showBillCommts() {
  LinkURL="cliweb06.pbl?reportno=12&template=007&urnumber=" +
           document.PatientLinks.urnumber.value.replace(/ /g,"+") +
          "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+");
  Left=(document.body.clientWidth-880)/2
  DFrameLink(LinkURL,50,Left,880,300);
}

</script>
<script>
function TimeCheck(){

  var fieldElement;
  var theatreDate = "%OPRWEB06.12.401".slice(0,8);
  var fieldName = "timecheck%STANDARD.01.044.113.064.002".replace(" ", "0");

  try{
    if(!this.event.srcElement.value){
      return;
    }
    if(this.event.srcElement.id!=fieldName){
      return;
    }
    if(!Get("discdate").value){
      return;
    }
    fieldElement = Get(fieldName);
    var dateArray = Get("discdate").value.split(" ");
    var monthNumber = new Date(Date.parse(dateArray[1] +" 1, 2012")).getMonth()+1;
    var monthString = monthNumber<10? "0" + monthNumber : "" + monthNumber
    var dDate = dateArray[2] + monthString + dateArray[0];
    if(theatreDate + fieldElement.value > dDate+Get("disctime").value){
       alert(fieldElement.title + " cannot be after the discharge date."+
             "\nDo you want to override?");
       fieldElement.value = "";
       fieldElement.focus();
    }
  }catch(e){}
}
function Get(el){return document.getElementById(el);}
</script>
</head>
<body onload="PageLoad(event);UpdateForm.opard002.focus();set();ProcMan();
             ChkRecovDelay();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB06.12.003";
PatientVIS="%OPRWEB06.12.081";
PatientNAM="%OPRWEB06.12.002";
PatientSTA="%OPRWEB06.12.086.078";
PatientALT="%OPRWEB06.12.084";
PatientSEX="%OPRWEB06.12.019";
PatientDOB="%OPRWEB06.12.020";
PatientAGE="%OPRWEB06.12.021";
PatientLOC="%OPRWEB06.12.083";
PatientPRI="%OPRWEB06.12.086.066.1";
PatientUNT="%OPRWEB06.12.066.0";
DoctorCOD="%OPRWEB06.12.082.003";
DoctorNAM="%OPRWEB06.12.082.002";
PatientAID="%OPRWEB06.12.086.090";
PatientIND="%OPRWEB06.12.086.091";
PatientCUR="%OPRWEB06.12.086.092";
PatientCLC="%OPRWEB06.12.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB06.12.086.094";
PatientCDM="%OPRWEB06.12.086.095";
PatientVDH="%OPRWEB06.12.086.099.015";
InsertPatientHeader()
</script>
<div id="PatientMenu"></div>

<div id=PageBodySection>
<form name=UpdateForm method=post action="oprweb06.pbl" style="margin:0">
<input type=hidden name=reportno value=12>
<input type=hidden name=template value=1>
<input type=hidden name=updatety value="">
<input type=hidden name=urnumber value='%OPRWEB06.12.003'>
<input type=hidden name=casekeys value="%OPRWEB06.12.101">
<input type=hidden name=uniqueky value='%OPRWEB06.12.110'>
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value=1>
<input type=hidden name=gnm>
<input type=hidden name=suprlevl value="%OPRWEB06.12.313">
<input type=hidden name=opdunqid value="">
<input type=hidden name=teamnumb value="%OPRWEB06.12.334">
<input type=hidden name=currdate value="%STANDARD.01.013">

<input type=hidden name=opard041>
<input type=hidden name=opsrg003>
<input type=hidden name=opsrg004>
<input type=hidden name=opsrg071 value=" ">
<input type=hidden name=opard043 value=" ">
<input type=hidden name="discdate" id="discdate" value="%OPRWEB06.12.353">
<input type=hidden name="disctime" id="disctime" value="%OPRWEB06.12.354">

<table border="0" cellpadding="0" cellspacing="0" width="100%" align=center>
<tr><td class=HeadingCell align=left>
    <img src="../images/ListIcon.gif" class=Icon onclick="SessCaseList();"></td>
    <td align=center class=HeadingCell width=85%>Theatre Procedure Details</td>
    <td align=right class=HeadingCell><font color=red>
     %OPRWEB06.12.208</font></td></tr>

</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%" align=center>
<tr><td class=DataLabel>Consultant</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.12.404.003")'>
    %OPRWEB06.12.404.002 </a></td>
    <td class=DataLabel>Operating Surgeon</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.12.311.003")'>
    %OPRWEB06.12.311.002 </a></td>
    <td class=DataField>
    <input type=button value="Change Surgeon" class="button"
     onclick="ChgSurgeon();"></td>
</tr>

<tr><td class=DataLabel>Unit</td>
    <td class="DataField">
       <select name=opses012 title="Unit" class=SelectBig>
        <option></option>
         %OPRWEB06.12.413.2
        </select></td>
    <td class=DataLabel>Theatre</td>
    <td class=DataField>%OPRWEB06.12.302</td>
    <td class=DataField>
       <input type=button value="Change Theatre" class="button" 
        onclick="ChgOpr();"></td></tr> 

<tr><td class=DataLabel>Date </td>
    <td class=DataField>%OPRWEB06.12.406 %OPRWEB06.12.402</td>
    <td class=DataLabel>Time </td>
    <td class=DataField>%OPRWEB06.12.403</td></tr>
</table>

<hr>

<table border="0" cellpadding="0" cellspacing="0" width="100%" align=center>
<tr><td class=DataLabel>Procedure(s)&nbsp;</td>
    <td> <input type=text size=116 name=opdea014 maxlength=80
          title="Procedure Description" value="%OPRWEB06.12.305" readOnly></td></tr>
<tr><td class=DataLabel><i>(read-only)&nbsp;&nbsp;</i></td>
    <td> <input type=text size=116 name=opdea015 maxlength=80
     title="Procedure Description" value="%OPRWEB06.12.343" readOnly></td></tr> 
<tr><td class=DataLabel>&nbsp;&nbsp;</td>
    <td> <input type=text size=116 name=opdea016 maxlength=80
         title="Procedure Description" value="%OPRWEB06.12.344" readOnly>
    </td></tr>
</table>

<br>

<table border="0" cellpadding="0" cellspacing="0" width="70%" align=center>
<tr><td class=DataLabel>Time Arrived</td>
    <td class=DataField>
      <input type=text name=opard002 size=8 maxlength=8 
       title="Time Arrived" value="%OPRWEB06.12.502" tabindex="1" id="timecheck02"
       onblur="checkTime(this,this.title);chkAnaesTime();TimeCheck()">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,UpdateForm.opard002);">
      <img src="../images/TimeLookup.gif" class=Icon
       onclick="TimeLookupFrame(UpdateForm.opard002);"></td>

    <td></td>

    <td></td>

    <td><input class="button" type=button name="procbutton" value="Procedures"
         id="procbutton"
         tabindex="15" onclick="tempDisable(this);goToProcedure();">
    </td></tr>

<tr><td class=DataLabel>Anaesthetic/Prep Time</td>
    <td class=DataField>
      <input type=text name=opard042 size=8 maxlength=8 id="timecheck04"
       title="Anaesthetic/Prep Time" value="%OPRWEB06.12.542" tabindex=2
       onblur="checkTime(this,this.title);chkAnaesTime();TimeCheck()">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,UpdateForm.opard042);">
      <img src="../images/TimeLookup.gif" class=Icon
       onclick="TimeLookupFrame(UpdateForm.opard042);"></td>

    <td class=DataLabel>Anaesthetic Method (for reporting)</td>
    <td class=DataField>
     <select name=opdea003 title="Anaesthetic Method" tabindex="9">
        <option></option>
         %OPRWEB06.12.113.2
      </select></td>

    <td><input class="button" type=button
	name="asabutton" value="Set ASA Score:" tabindex="16"
 	onclick="tempDisable(this);redirectASA(this); PMenuLinkTo(this); resetASA(this)">
    	<select name=oparuc11 title="ASA Score" disabled>
    	<option></option>
         %OPRWEB06.12.545.2
      </select></td></tr>

<tr><td class=DataLabel>Time Out Performed</td>
    <td class=DataField><input type=text name=opard029 size=8 maxlength=8
       title="Anaesthetic/Prep Time" value="%OPRWEB06.12.529" tabindex=3
       onblur="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onClick="SetCurrentDateTime(null,opard029);">
      <img src="../images/TimeLookup.gif" class=Icon
       onclick="TimeLookupFrame(opard029);"></td>

    <td></td><td></td>
    <td><input class="button" type=button value="Staff Members"
        name="staffbutton" id="staffbutton"
        tabindex="17" onclick="tempDisable(this);goToStaff();">
    </td></tr>

<tr><td class=DataLabel>Surgery Start</td>
    <td class=DataField>
      <input type=text name=opsrg005 size=8 maxlength=8 id="timecheck06"
       title="Surgery Start Time" value="%OPRWEB06.12.337" tabindex=4 
       onblur="checkTime(this,this.title);chkSurgStart();TimeCheck()">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,UpdateForm.opsrg005);">
      <img src="../images/TimeLookup.gif" class=Icon
       onclick="TimeLookupFrame(UpdateForm.opsrg005);"></td>
    <td></td><td></td>

    <td><input type=button value="Billing Comments" class="button" tabindex="18"
           name="btnBillcom" id="btnBillcom"
           onclick="tempDisable(this);BillingComments();">
    </td></tr>

<tr><td class=DataLabel>Surgery End</td>
    <td class=DataField>
      <input type=text name=opsrg006 size=8 maxlength=8 id="timecheck07"
       title="Surgery End Time" value="%OPRWEB06.12.338" tabindex="5"
       onblur="checkTime(this,this.title);chkSurgEnd();TimeCheck()">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,UpdateForm.opsrg006);">
      <img src="../images/TimeLookup.gif" class=Icon
       onclick="TimeLookupFrame(UpdateForm.opsrg006);"></td>

    <td class=DataLabel>Overnight Indicator</td>
    <td><input type=checkbox name=ovrnight title="Overninght Indicator"
        tabindex="11" value="1" onblur="valPrepDress();"></td>
    <td></td>

<tr>
 <td class=DataLabel>OT Out / Time in Recovery</td>
    <td class=DataField>
      <input type=text name=opard077 maxlength=8 tabindex=6 id="timecheck12"
       title="Time in Recovery - Day" value="%OPRWEB06.12.577" size=8
       onBlur="checkTime(this,this.title);chkTime(this);ProcMan();ChkRecovDelay();TimeCheck()">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,UpdateForm.opard077);">
      <img src="../images/TimeLookup.gif" class=Icon
       onclick="TimeLookupFrame(UpdateForm.opard077);"></td>

 <td class=DataLabel>PACU/Recovery Not Required</td>
    <td><input type=checkbox name=norecovr title="No Recovery for this Patient"
        tabindex="12" onclick="SetNoRecovery();"></td>

    <td>&nbsp;</td></tr>

<tr><td class=DataLabel>Ready to Depart Time</td>
    <td class=DataField>
	<input type=text name=opard085 size=8 maxlength=8 tabindex="7"
       title="Exit Theatre Complex Time" value="%OPRWEB06.12.585" id="timecheck14"
       onBlur="checkTime(this,this.title);chkTime(this);ChkRecovDelay();TimeCheck()">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard085);">
      <img src="../images/TimeLookup.gif" class=Icon
       onclick="TimeLookupFrame(opard085);"></td>
	   
    <td class=DataLabel>Recovery Delay Reason</td>
    <td class=DataField colspan=2>
      <select name=opard084 title="Recovery Delay Reason" tabindex="14">
        <option></option>
         %OPRWEB06.12.584.2
      </select>
	   
	   </tr>


<tr><td class=DataLabel>Exit Theatre Complex</td>
    <td class=DataField>
      <input type=text name=opard080 size=8 maxlength=8 tabindex="8"
       title="Exit Theatre Complex Time" value="%OPRWEB06.12.580" id="timecheck14"
       onBlur="checkTime(this,this.title);chkTime(this);ChkRecovDelay();TimeCheck()">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,UpdateForm.opard080);">
      <img src="../images/TimeLookup.gif" class=Icon
       onclick="TimeLookupFrame(UpdateForm.opard080);"></td>

    <td></td><td></td>

    <td></td><td></td>
    
    <td>&nbsp;</td></tr>

    <td></td><td></td>
	
    <td></td><td></td>	

</table>

<table border="0" cellpadding="0" cellspacing="0" width="70%" align=center>
<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class=DataLabel>Theatre Comments</td>
    <td class=DataField>
        <div id=CommentText></div> 
    </td></tr>

<tr><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class=DataLabel>Extended Procedure Description</td>
    <td colspan=3>
       <textarea wrap=hard cols=70 rows=6 id=extprcmt name=extprcmt
              title="Extended Procedure Description"
              onkeydown="LimitText(this,999,69930);"
              tabindex=20>%OPRWEB06.12.143.024</textarea>
    </td>
</tr>

<tr><td colspan=2 align=center><br>
    <input type=button value="Refresh" class="button" tabindex="31"
           onclick="RefreshPage();">
    <input type=button value="Save" class="button" tabindex="32" 
           name="btnUpdate" id="btnUpdate"
           onclick="tempDisable(this);UpdateDayProc();">
</td></tr>
</table>
</form>

<form  name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=12>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value='%OPRWEB06.12.003'>
<input type=hidden name=admissno value='%OPRWEB06.12.081'>
<input type=hidden name=MenuType value='%OPRWEB06.12.088'>
<input type=hidden name=casekeys value='%OPRWEB06.12.101'>
<input type=hidden name=sesskeys value='%OPRWEB06.12.102.oprweb01.03.003'>
<input type=hidden name=uniqueky value='%OPRWEB06.12.110'>
<input type=hidden name=teamnumb value='%OPRWEB06.12.334'>
</form>
</div>

<span id=ThtrCom style="display:none">
  <textarea wrap=hard cols=70 rows=3 name=opcom008 tabindex=19 
   onkeydown="LimitText(this,999,69930);"> 
%OPRWEB06.12.143.008
  </textarea>
</span>

<span id=BookCom style="display:none">
  <textarea wrap=hard cols=70 rows=3 name=opcom008 tabindex=19 
   onkeydown="LimitText(this,999,69930);"> 
%OPRWEB06.12.143.009
  </textarea>
</span>

<script type="text/javascript">
if ("%OPRWEB06.12.671" == "Yes") {
  document.UpdateForm.ovrnight.checked=1;
}
var mbsCount = %OPRWEB06.12.201
if (mbsCount >= 1){
  document.UpdateForm.procbutton.className="RedButton";}

var impCount = %OPRWEB06.12.203
if (impCount > 1){
  document.UpdateForm.impbutton.className="RedButton";}

var staffExist = "%OPRWEB06.12.214"
if (staffExist == "1"){
  document.UpdateForm.staffbutton.className="RedButton";}

// Default Comment from Booking
if (%OPRWEB06.12.211 == 0)                       // First display of this page?
  CommentText.innerHTML = BookCom.innerHTML;     // Yes, default from booking
else
  CommentText.innerHTML = ThtrCom.innerHTML;     // No, use Day Proc comments

// Billing Comments exists?
var billCmntsInd = "%OPRWEB06.12.355";
if (billCmntsInd == "1") {
  UpdateForm.btnBillcom.className = UpdateForm.btnBillcom.className +
  " RedButton";
}

// Patient into/out of Recovery times the same?
if (!isWhitespace(UpdateForm.opard077.value)) {
  if (UpdateForm.opard077.value == UpdateForm.opard080.value) {
    UpdateForm.norecovr.checked = true;
	UpdateForm.opard085.readOnly = true;
    UpdateForm.opard085.className = "Readonly";
	document.UpdateForm.opard085.value = document.UpdateForm.opard080.value;
    UpdateForm.opard080.readOnly = true;
    UpdateForm.opard080.className = "Readonly";
  }
}

</script>
