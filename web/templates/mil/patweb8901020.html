<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="mil">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/preadmission.js"></script>
<script type="text/javascript" src="../js/ReportStandard.js"></script>
<script type="text/javascript">
function SubmitAdm() {
  MandatoryOk=true;
  if  (!validateMandatory(UpdateForm)) {
      return;
  }
    p=document.UpdateForm
    validateSuspension(p.urnumber,p.ptmis001,p.datefrom,p.dateto);
    if(p.datefrom.value!='0'){
      if(p.admitbox.value=="1"){
         document.UpdateForm.admitbox.value="0";
         ans=confirm("Warning : Patient has a Suspension record for period \n" +
               "\t" + p.datefrom.value  + " - " + p.dateto.value + "\n" +
               "\tPatient will not be admitted");
         }else{
         ans=confirm("Warning : Patient has a Suspension record for period \n" +
               "\t" + p.datefrom.value  + " - " + p.dateto.value);}
         if (ans!=true) {
            return;
         } 
    }
  if (!isWhitespace(UpdateForm.ptmis013.value)) {
      if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
                          UpdateForm.funddesc,UpdateForm.tabldesc)) {
         ans=confirm("Select another active health fund table? ");
         if (ans==true) {
            return;
         }
      }
  }
  if(document.UpdateForm.mvmedre1.checked == true) {
     document.UpdateForm.mvmedrec.value="1";
  } else {
     document.UpdateForm.mvmedrec.value="0";
  }
  if (MandatoryOk) {
    setRedirect();
    UpdateForm.ptmis004.value=UpdateForm.ptmis068.value;
    UpdateForm.ptmis005.value=UpdateForm.ptmis076.value;
    SubmitHidden(UpdateForm);
   }
}

function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
  selectOptions("30",UpdateForm.ptmis007,UpdateForm.ptmis024);

//  UpdateForm.ptmis024.selectedIndex=1
}
function selectUnit(){
  for (var i =0 ; i < document.UpdateForm.ptmis024.length; i++) {
    if (document.UpdateForm.ptmis024.options[i].value.substr(0,3)== 
                 document.UpdateForm.deftunit.value.substr(0,3)) {
       document.UpdateForm.ptmis024.selectedIndex=i } };
}

function AdmitMandatory() {
 if(document.UpdateForm.admitbox.checked == true) {
     document.UpdateForm.admitbox.value="1";
     UpdateForm.ptmis011.className="Mandatory";  //admission type
     UpdateForm.ptmis009.className="Mandatory";  //admission source
     UpdateForm.ptvis041.className="Mandatory";  //criteria for admission
     UpdateForm.ptmis012.className="Mandatory";  //care type
     UpdateForm.ptmis068.className="Mandatory";  //ward
     UpdateForm.ptmis005.className="mandatory";  //bed
     UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor description
     UpdateForm.ptmis024.className="Mandatory";  //Unit
     UpdateForm.ptmis027.className="Mandatory";  //Financial Class
     UpdateForm.ptmis010.className="Mandatory";  //CMBS Class
     UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
     UpdateForm.ptvis046.className="Mandatory";  //Admitting Point
  } else {
     document.UpdateForm.admitbox.value="0";
     UpdateForm.ptmis011.className="";  //admission type
     UpdateForm.ptmis009.className="";  //admission source
     UpdateForm.ptvis041.className="";  //criteria for admission
     UpdateForm.ptmis012.className="";  //care type
     UpdateForm.ptmis068.className="";  //ward
     UpdateForm.ptmis005.className="";  //bed
     UpdateForm.ptmis007.className="";  //Admitting Doctor
     UpdateForm.doctnam2.className="";  //Admitting Doctor description
     UpdateForm.ptmis024.className="";  //Unit
     UpdateForm.ptmis027.className="";  //Financial Class
     UpdateForm.ptmis010.className="";  //CMBS Class
     UpdateForm.ptvis043.className="";  //Intended Stay
     UpdateForm.ptvis046.className="";  //Admitting Point
  }
}
</script>
</head>
<body onload="PageLoad(event);document.UpdateForm.ptmis001.focus();
 DisplayTrnSrc();defaultWard();valDoctorUnit();selectUnit();
 ShowActiveProgramID();">
%START.OF.PAGE

<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form name=linkForm action=patweb89.pbl method=post style=margin:0>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.101">
</form>
<form name=UpdateForm method=post  action=patweb89.pbl style=margin: style=margin:00>
<input type=hidden name=reportno value="2">
<input type=hidden name=template value="20"> 
<input type="hidden" name="updatety" value="1">
<input type="hidden" name="allocate" value="1">
<input type="hidden" name="redirect" value="%PATWEB89.01.001.patweb98.01.001">
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.701">
<input type="hidden" name="chckname" value="0">
<input type="hidden" name="emradmit" value="0">
<input type="hidden" name="emradmis" value="0">
<input type="hidden" name="newbmand" value="0">
<input type="hidden" name="agebmand" value="0">
<input type="hidden" name="admitnow" value="0">
<input type="hidden" name="ptmis073" value=" ">
<input type="hidden" name="ptmis075" value="N">
<input type="hidden" name="mvmedrec">
<input type=hidden name=cfinan value="%PATWEB89.01.932">
<input type=hidden name=preadbok value="1">
<input type=hidden name=ptmas046 value="0">
<input type=hidden name=exstward value="%PATWEB89.01.449.1">
<input type=hidden name=deftunit value="%PATWEB89.01.124.1">
<input type=hidden name=datefrom>
<input type=hidden name=dateto>

<input type=hidden name=ptcndigp id=ptcndigp
       value="%STANDARD.01.025.124.122.0.1">

<table border=1 colspan=1 width=100% cellspacing=1 cellpadding=1 >
<tr><td class=HeadingCell align=center>
    Patient Pre-Admission Details(from Booking Details)</tr>
<tr>
<tr><td>
      <table border=0 width=100% class=TableBody cellpadding=0 cellspacing=0>
       <tr> <td>&nbsp;</td><td>&nbsp;</td>
        <td align=left><b>Admit Now?</b></td>
        <td align=left>
        <input type="checkbox" name="admitbox" value="0" notab 
           onclick="AdmitMandatory()";>
        </td></tr>
        <tr>  <td class=DataLabel>Admission Date</td>
          <td class=DataLabel>
            <input type="text" size="12" tabindex=1 id=ptmis001
            name=ptmis001 value="%PATWEB89.01.706"
            class=Mandatory title="Admission Date"
            onblur="checkDate(this,'Admission Date')">
     <img src=../images/DateLookup.gif 
        class=Icon onclick="DateLookupFrame(ptmis001);"> 
          Time
            <input type=text size=8 readonly tabindex=2 id=ptmis002
            name=ptmis002 value="%PATWEB89.01.707"
            class=Mandatory title="Admission Time">
      <img src=../images/DateTimeStamp.gif class=Icon
         onclick="SetCurrentDateTime(ptmis001,ptmis002);">
     <img src=../images/TimeLookup.gif class=Icon
        onclick="TimeLookupFrame(ptmis002);"> </td>
       <td>Admitting Point</td>
       <td>
         <select name=ptvis046 tabindex=12 title="Admitting Point"
          onchange="defaultWard()">
            <option></option>
            %PATWEB89.01.290.2
         </select>
       </td>
     </tr>
     <tr><td class=DataLabel>%STANDARD.01.017.P </td>
          <td><select name=ptmis011 tabindex=3  
               title="%STANDARD.01.017.P ">
              <option> </option>
                 %PATWEB89.01.112.2
              </select></td>
       <td class=DataLabel>Ward / Bed </td>
       <td>
         <input type=hidden name=bedstat1 id=bedstat1>
         <input type=hidden name=ptmis004 id=ptmis004>
         <input type=hidden name=ptmis005 title="Ward/Bed" id=ptmis005>
         <input type=hidden name=warddesc id=warddesc>
         <select name=ptmis068 tabindex=14 title="Ward/Bed" id=ptmis068>
         <option> </option>
            %PATWEB89.01.449.2
         </select>
         <input type=text name=ptmis076 maxlength=3 size=3 id=ptmis076>
         <img src=../images/SearchIcon.gif class=Icon
         onclick="WardBedSearchFrame(ptmis068,warddesc,ptmis076,bedstat1);">
       </td>
     </tr>
     <tr>
      <td class=DataLabel>Admission Source</td>
      <td>
         <select name=ptmis009 tabindex=4 title="Admission Source"
          onchange="DisplayTrnSrc()">
         <option> </option>
         %PATWEB89.01.110.2
          </select>
      </td>
      <td class=DataLabel>Admitting Doctor</td>
      <td>
           <input type="text" size=8 maxlength=6 name="ptmis007" tabindex=15
              value="%PATWEB89.01.108.003" title="Admitting Doctor" id=ptmis007
              onchange="UpCase(this);valDoctorUnit();">
           <input type=text readonly size=25 name=doctnam2 id=doctnam2
              value="%PATWEB89.01.108.002">
           <img src="../images/SearchIcon.gif" class=Icon
              onclick="DoctorSearchFrame(ptmis007,doctnam2,valDoctorUnit)"></td></tr>
          <td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>
          <td class=DataLabel>Unit</td>
      <td>
           <select name=ptmis024 tabindex=16 title="Unit">
           <option> </option>
           %PATWEB89.01.124.2
           </select>
      </td></tr>
    <tr><td align=left>Prior Days Hospitalisation</td>
         <td align=left>
           <input type=text name=ptmis031 title='Prior Days Hospitalisation'
            class=Integer size=5 maxlength=3 tabindex=6
            onblur=checkInteger(this,this.title)>
         </td>
      <td class=DataLabel>Diagnosis </td>
      <td>
          <input type=text name="ptmis020" size=50 maxlength=80 tabindex=17
        value="%PATWEB89.01.121">
      </td></tr>
    <tr><!--<td>Mode of Arrival</td>
       <td>
         <select name=ptvis054 tabindex=7>
         <option></option> PATWEB89.01.257.2
         </select>
       </td>-->
      <td class=DataLabel>Provisional DRG</td>
      <td>
        <input type=text name=ptmis066 size=5 maxlength=4 tabindex=18
              onblur='validateCode(5,ptmis066,drgdesc1)' id=ptmis066
              value="%PATWEB89.01.140.0">
        <input type=text readonly name=drgdesc1 size=35 id=drgdesc1
               value="%PATWEB89.01.140.1">
         <img src="../images/SearchIcon.gif" class=Icon
               onclick="DrgSearchFrame(ptmis066,drgdesc1)"> </td></tr>
    <tr><td class=DataLabel>Admission Criteria</td>
    <td>
       <select name=ptvis041 tabindex=8 title="Admission Criteria">
       <option> </option>
       %PATWEB89.01.244.2
       </select>
    </td>
<!--<td class=DataLabel> Diet Code </td>
        <td>
           <select name=ptmis028 tabindex=19>
           <option> </option>
            PATWEB89.01.127.4
            </select>
         </td>--></tr>
     <tr><td class=DataLabel>Care Type</td>
          <td>
            <select name=ptmis012 tabindex=9 title="Care Type">
              <option> </option>
               %PATWEB89.01.113.2
            </select>
   </td>
        <td class=DataLabel>Referring GP</td>
        <td>
          <input type="text" size=10 maxlength=10 name="ptvis028" tabindex=20
               value="%PATWEB89.01.231.1" id=ptvis028
               onblur="ValidateHCP(18,0,ptvis028,doctnam1);">
            <input type="text" size=25 readonly name="doctnam1" id=doctnam1
               value="%PATWEB89.01.231.0">
            <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(UpdateForm.ptvis028,UpdateForm.doctnam1,0);">
      </td></tr>
      <tr><td class=DataLabel> Intended Stay </td>
      <td>
       <select name=ptvis043 tabindex=10 title="Intended Stay">
          <option> </option>
          %PATWEB89.01.246.2
        </select>
      </td>
      <td class=DataLabel>Inform GP</td>
      <td>
        <select name=ptvis022 tabindex=21 title="Inform GP">
          <option> </option>
          <option value="0">No</option>
          <option value="1">Yes</option>
        </select></td></tr>
       <tr><td class=DataLabel> Planned Length of Stay</td>
        <td>
        <input type=text size=5 maxlength=5 name=ptmis030
         tabindex=11 title='Expected Length of Stay'
         value="%PATWEB89.01.129" 
         onblur="checkInteger(this,this.value);">
        </td>
        </tr>
       <tr align=left>
         <td align=center colspan="4">
         <hr>
         </td>
       </tr>

   <tr><td class=DataLabel>Consent</td>
       <td><select name=ptmis037 title="Consent" tabindex=30>
           <option></option>
           %PATWEB89.01.133.2
           </select>
         <input type=text size=12 name=ptvis068 tabindex=31 id=ptvis068
             class="Date" value="%PATWEB89.01.271" title="Consent Date">

         <img notab src=../images/DateLookup.gif 
          class=Icon onclick="DateLookupFrame(ptvis068);">
        <img notab src=../images/DateTimeStamp.gif 
         class=Icon onclick="SetCurrentDateTime(ptvis068,null);">
          </td>
       </td>
       <td class=DataLabel>Religious Visit</td>
       <td>
         <select name=ptmis017 tabindex=35>
          <option value="2">NO</option>
          <option value="1">YES</option>
         </select>
        &nbsp; Ambulance Cover &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
         <select name=ptmis065 tabindex=39 title="Ambulance Cover">
           <option></option>
           %PATWEB89.01.185.2
         </select>
       </td></tr>
    <tr><td class=DataLabel width=15%>Training</td>
        <td><select name=ptvis085 tabindex=32>
         %PATWEB89.01.298.004.2
        <td class=DataLabel> Marketing
        <td><select name=ptvis082 tabindex=36>
         %PATWEB89.01.298.001.2
         </select>
         &nbsp;&nbsp;&nbsp;Pref.Accommodation &nbsp;
         <select name=ptvis093 tabindex=39 title="Pref.Accommodation">
           <option></option>
             %PATWEB89.01.298.012.2
         </select>
       </td></tr>
   <tr> <td class=DataLabel> Research
        <td><select name=ptvis084 tabindex=33>
         %PATWEB89.01.298.003.2
        </td>
        <td class=DataLabel width=15%>Pref. Next of Kin
        <td><select name=ptvis087 tabindex=37 >
         %PATWEB89.01.298.006.2
       </td>
       </tr>
   <tr><td width=15%> Enduring POA
        <td><select name=ptvis086 tabindex=34>
         %PATWEB89.01.298.005.2
        <td class=DataLabel> Emergency Contact
        <td><select name=ptvis088 tabindex=38 >
         %PATWEB89.01.298.007.2
       </td></tr>

   <tr>
      <td class=DataLabel>Program</td>
      <td><input type=text size=8 maxlength=8 name=ptvis099
         title="Program" tabindex=34 value="%PATWEB89.01.298.021.1"
          onchange="findPrgmdesc();">
          <select name=prgmcode Readonly class=readonly tabindex=166
          onchange="savePrgmcode();">
          <option> </option>
           %PATWEB89.01.298.021.2
          </select></td>
   </tr>

   <tr><td class="DataLabel"><div id="ProgramIdTitle"></div></td>
       <td class="DataField"><div id="ProgramIdField"></div></td>
       <td class="DataLabel"></td>
       <td class="DataField"></td>
       <td class="DataLabel"></td>
       <td class="DataField"></td>
       </tr>

       <tr align=left>
         <td align=center colspan="4">
         <hr>
         </td>
       </tr>

       <tr align=left>
         <td class=DataLabel>%STANDARD.01.017.CL</td>
         <td align=left>
          <select name=ptmis027 tabindex=50  
                  title="%STANDARD.01.017.CL">
          <option> </option>
          %PATWEB89.01.126.9.1.10.2.X
          </select>
         </td>
       </tr>

  <tr> <td class=DataLabel>%STANDARD.01.017.A </td>
    <td>
      <select name=ptmis010 tabindex=51 
      title="%STANDARD.01.017.A ">
      <option> </option>
      %PATWEB89.01.111.2
      </select>
    </td>
<tr><td class=DataLabel>Health Fund</td>
        <input type="hidden" name="ptmis013" value="%PATWEB89.01.040.0"
         id=ptmis013>
    <td class=DataLabel colspan=2>
        <input type=text size=35 name="funddesc" maxlength="30"
         id=funddesc
         notab value="%PATWEB89.01.040.1" readonly> Table
        <input type="hidden" name="ptmis014" id=ptmis014 value="%PATWEB89.01.041.0">
        <input type="text" size=20 maxlength=30 name="tabldesc"
         notab value="%PATWEB89.01.041.1" readonly id=tabldesc>
        <img src=../images/SearchIcon.gif class=Icon
         onclick="HealthFundSearchFrameNoFocus(ptmis013,funddesc,
                                               ptmis014,tabldesc);">
        <img src="../images/erase.gif" class=Icon 
         onclick="clrDoc(funddesc,tabldesc);clrDoc(ptmis013,ptmis014);">
    </td>
</tr>

      <tr align=left>
        <td class=DataLabel>Member Number &nbsp; </td>
        <td class=DataLabel>
          <input type=text size=20 maxlength=19 
                 tabindex=52 value="%PATWEB89.01.042" name='ptmis015'>
        </td>
        <td align=left>Move Medical Record</td>
        <td align=left>
        <input type="checkbox" name="mvmedre1" value="1" tabindex=53>
        </td>
        <tr align=left>
          <td colspan=4 align=center><br>
           <input type=button value="Ok" class="button" tabindex=54
            id="pat89sub"
            onclick="tempDisable(this);checkBedStatus(UpdateForm.ptmis068.value,
                 UpdateForm.ptmis076.value,UpdateForm.ptmis001.value,
                 UpdateForm.ptmis030.value,SubmitAdm)";>
            <input type=button value="Cancel" class="button" tabindex=55
             onclick="PatientLinkTo('patweb98.pbl',1,1,0);">
      </table>
</td></tr>
</table>
</form>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
<input type=hidden name=MenuType value="%PATWEB89.01.088">
</form>

<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 tabindex=18 id=ptmis058
         onblur="checkDate(this,'ReferralDate')">
         <img notab src=../images/DateLookup.gif 
          class=Icon onclick="DateLookupFrame(ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
  <td><input type=text size=12 name=ptmis059 tabindex=19 id=ptmis059
         onblur="checkDate(this,'SpecConDate')">
    <img notab src=../images/DateLookup.gif 
          class=Icon onclick="DateLookupFrame(ptmis059);"></td></tr>
</table>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr>
  <td class=DataLabel width=37%>Admission Weight</td>
  <td>
   <input type=text name=ptmis051 size=8 maxlength=6 tabindex=20
    onchange=justifyRight(this);>grams</td></tr>
</table>
</span>

<span id=NewBorn style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
  <td><input type=text name=ptmis041 maxlength=3 size=4 tabindex=21> weeks
    </td></tr>
</table>
</span>

<script type="text/javascript">
 if ("%PATWEB89.01.905" == "1") {
  alert("Warning: Patient is currently admitted");
 }
 if ("%PATWEB89.01.908" == "1") {
  alert("Warning: Patient has a pre-admission record");
 }
</script>
<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</tr>
</span>
<span id=transfersrc style="display:none">
 <td><input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
      title="Transfer Source" tabindex=5 id=trnsfsrc
      value="%PATWEB89.01.193.0"
      onchange="validateCode(9,trnsfsrc,trandesc);">
     <input type=text size=27 name=trandesc notab id=trandesc
      class=Readonly readonly value="%PATWEB89.01.193.1">
     <img src="../images/SearchIcon.gif" class=Icon
      onclick="TransferSourceFrame(trnsfsrc,trandesc)"></td>
</tr>
</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>

<span id="ShowProgramIdTitle" style="display:none">
 %STANDARD.01.035.PK
</span>

<span id="ShowProgramIdField" style="display:none">
  <select name=ptvis110 title="%STANDARD.01.035.PK" tabindex=34
   id="ptvis110" class="">
    <option> </option>
    %STANDARD.01.007.PK
  </select>
</span>

<script type="text/javascript">
function init() {
GPValue="%PATWEB89.01.225.1"
  if(GPValue=="No"){
    GPValue="0";
  }
  else if(GPValue=="Yes"){
    GPValue="1"
  }
  valInformGP(document.UpdateForm.ptvis022,GPValue,document.UpdateForm.ptcndigp.value);
 
  defunit="%PATWEB89.01.124.1"

  for (var i =0 ; i < document.UpdateForm.ptmis024.length; i++) {
    if (document.UpdateForm.ptmis024.options[i].value==defunit.substr(0,3)) {
       document.UpdateForm.ptmis024.selectedIndex=i } };
}
MergePsy="%PATWEB89.01.050"
  if(MergePsy=="Yes"){
    document.UpdateForm.ptmas046.value="1"
  }
 if(MergePsy=="No "){
    document.UpdateForm.ptmas046.value="0"
  }

</script>
