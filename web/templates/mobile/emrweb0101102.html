Content-Type: text/html
Cache-Control: no-cache

<!DOCTYPE HTML>
<html>
<head><title>Emergency Patient List</title>
<!--"TemplateVersion"  : "V12.01.00"
    "TemplateHome"     : "mobile"-->
<script type="text/javascript" src="../html/ipad/ipad.js"></script>
<script type="text/javascript" src="../html/ipad/emrweb0101102.js"></script>
<link rel="stylesheet" href="../html/ipad/ipad.css" type="text/css">
<style type="text/css">
.EMRHeadingCell {
 background-color:#ffff00;
 font-weight:bold;
}
#NextEmergency {
position: absolute;
border:3px solid white;
top: 0px;left:0px;width:207px;height:88px;
clip: rect(0px,207px,88px,0px)
font-size:small;
}
#EmergencyCount {
position: absolute;
top: 138px;left:3px;width:205px;height:40px;
border: 1px black solid;
background-color:#ffff00;
font-size:small;
}

#BlackHole {
position: absolute;
top:98px;left:3px;width:205px;height:40px;
background-color:#000000;
border: 1px black solid;
position: absolute;
font-size:small;
}

#EmergencyMenu {
position: absolute;
width: 1024px;
display: block;
top: 497px;
left: 0px;
}
#OtherLocation {
position: absolute;
border-style: outset;
top: 135px;
left: 505px;
width: 200px;
height: 45px;
}
#SystemComments {
position: absolute;
overflow: auto;
top: 280px;left:310px;width:390px;height:280px;
font-size:small;
}
#SmallTableLocation {
position: absolute;
overflow: auto;
top: 320px;left:310px;width:390px;height:82px;
background-color:#ffffff;
font-size:small;
}
.PatDiv {
top:10px;
7
#CloseIcon {
top:0px;
}
</style>
</head>
%START.OF.PAGE
<body style='background-repeat:no-repeat;background-color:#eeffff;background-image:url(../images/edmap1.png)'>
<script type="text/javascript">
 var obj = new Map();
 immediate = 0
 emergency = 0
 urgent = 20
 semi = 50
 non = 110

<!-- Paste below from site file emergencymap.txt-->

//  Location
//  Description, Code, left, top, right, botton, Start Position Left, Top
 obj.AddLocation("Room 04       ","11 ",807,185,1006,230,807,185);
 obj.AddLocation("Room 05       ","12 ",807,230,1006,275,807,230);

 obj.AddLocation("Room 06       ","13 ",807,285,1006,330,807,285);
 obj.AddLocation("Room 07       ","14 ",807,330,1006,375,807,330);

 obj.AddLocation("Room 08       ","15 ",807,385,1006,430,807,385);
 obj.AddLocation("Room 09       ","16 ",807,480,1006,525,807,480);

 obj.AddLocation("Room 10       ","17 ",807,540,1006,585,807,540);
 obj.AddLocation("Room 11       ","18 ",807,630,1006,675,807,630);

 obj.AddLocation("Other         ","00 ",5,5,205,50,5,5,"HIDE");
 obj.AddLocation("Waiting Room  ","WR ",220,30,1006,176,220,30,"WAIT");

 obj.AddLocation("Dressing Room 1","25 ",5,185,204,230,5,185);
 obj.AddLocation("Plaster Room 1","26 ",5,230,204,275,5,230);

 obj.AddLocation("Plaster Room 3","27 ",5,285,204,330,5,285);
 obj.AddLocation("Resusitation 1","28 ",5,330,204,375,5,330);

 obj.AddLocation("Resusitation 3","29 ",5,385,204,430,5,385);
 obj.AddLocation("ENT/Eye Exam  ","EE ",5,430,204,475,5,430);
 obj.AddLocation("Paediatrics   ","PA ",5,475,204,520,5,475);

 obj.AddLocation("Room 17       ","19i",5,540,204,585,5,540);
 obj.AddLocation("Exam Room 4   ","PO ",5,585,204,630,5,585);
 obj.AddLocation("Exam Room 3   ","20 ",5,630,204,675,5,630);

 obj.AddLocation("Room 5        ","05 ",217,540,406,585,217,540);
 obj.AddLocation("Cubical 6     ","06 ",217,585,406,630,217,585);
 obj.AddLocation("Cubical 7     ","07 ",217,630,406,675,217,630);

 obj.AddLocation("Room 09       ","09 ",419,540,618,585,419,540);
 obj.AddLocation("Room 08       ","08 ",419,585,618,630,419,585);
 obj.AddLocation("Room 10       ","10 ",419,630,618,675,419,630);

 obj.AddLocation("Other         ","OTH",5,5,205,104,5,5);

<!-- Paste above from site file emergencymap.txt -->
//
// Output Expected Patients
//
%EMRWEB01.01.043
//
//  Patients
//  Name, Location Code, U/R, Triage, Arrival, Time,Sex, Age, Complaint, Doctor
%EMRWEB01.01.006
//
// Output Map View
//
ShowMap(immediate,emergency,urgent,semi,non);
//
// Output Hall of Shame
//
// t = new Table(1,0,1,"100%","center","Incomplete Patients")
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column,Align
//
// t.addColumn("Incomplete Patients","String",1,1,"left","EditIcon.gif","0",150)
// t.addColumn("Patients","String",2,2,"right","","",40)
//
// Add Rows to Table (Output from Web Server)
//
//%EMRWEB01.01.032
// TableOutput(1,0)

document.getElementById('SystemComments').innerHTML=
"<table width=100% style='border:1px solid black;' cellspacing=0 cellpadding=2>" +
"<tr><td class=EMRHeadingCell align=left>Emergency Department Notices</td>" + 
"<td bgcolor=white nowrap>%EMRWEB01.01.053</td></tr>"+
"<tr valign=top height=150><td>%EMRWEB01.01.031</td></tr></table>" 

document.getElementById('EmergencyCount').innerHTML=
"<table border=0 cellspacing=0 cellpadding=1 width=100%>" +
"<tr height=20><td>Total :</td><td><b>%EMRWEB01.01.007</td>" +
"    <td>Waiting</td><td><b>%EMRWEB01.01.009</td>" +
"    <td>Unseen</td><td><b>%EMRWEB01.01.010</td>" +
"<tr height=20><td>Inc Dr</td><td><b>%EMRWEB01.01.012</td>" +
"    <td>Nurse </td><td><b>%EMRWEB01.01.013</td>" +
"    <td>PSC </td><td><b>%EMRWEB01.01.014</td>" +
"</tr></table>"

if ("%EMRWEB01.01.037"=="O"){
document.getElementById('BlackHole').innerHTML=
"<table border=0 cellspacing=2 cellpadding=4 width=100%>" +
"<tr height=40 valign=middle><td align=center onclick=OtherLocations()></td>" +
"<td><font color=white size=2>Patients NOT in ED</font></td>" +
"<td><font color=white size=2>%EMRWEB01.01.011</font></td>" +
"</tr></table>"
}
else {
document.getElementById('BlackHole').innerHTML=
"<table border=0 cellspacing=0 cellpadding=4 width=100%>" +
"<tr height=40 valign=middle><td align=center onclick=OtherLocations()></td>" +
"<td><font color=white size=2>Patients NOT in ED</font></td>" +
"<td><font color=white size=2>%EMRWEB01.01.011</font></td>" +
"</tr></table>"
}



//document.getElementById('EmergencyMenu').innerHTML = getTop().document.getElementById('MenuList').innerHTML; 


document.getElementById('NextEmergency').innerHTML=
"<table border=0 style='background-color:#ffff00;border:1px solid black' cellpadding=8 width=207 cellspacing=0>" +
"<tr><td align=center><b>NEXT PATIENT</b></td>" +
"<tr><td style='font-size:8pt'>%EMRWEB01.01.015</td></tr>" +
"<tr><td style='font-size:8pt'>Location:" + '%EMRWEB01.01.017' + "</td></tr>" +
"</table>"
</script>
<script type="text/javascript">
function ShowPatientDetails(PatientNo) {
 var PageLocation;
  if(!isWhitespace(obj.patients[PatientNo][4])) {
    PageLocation="?reportno=1&template=4" +
                 "&urnumber=" + obj.patients[PatientNo][0].replace(/ /g,"+") +
                 "&admissno=" + obj.patients[PatientNo][1].replace(/ /g,"+") ;
  } else {
     PageLocation="?reportno=1&template=11" +
                  "&urnumber=" + obj.patients[PatientNo][0].replace(/ /g,"+") +
                  "&admissno=" + obj.patients[PatientNo][1].replace(/ /g,"+"); 
  }
  globalLinkType=0;
  globalLinkUrl="../cgi-bin/emrweb02.pbl" + PageLocation;
  top.content.location="../cgi-bin/emrweb02.pbl" + PageLocation;
}

function OtherLocations() {
 if(top.content.location.search.substring(1,23)=="reportno=2&template=3"){
 if (IsDirtyTriage(top.content.UpdateForm)==true) { return; }} 
 url = "../cgi-bin/emrweb01.pbl?reportno=01&template=012" 
 parent.content.location=url
}
function SelectPatient(admissno) {
 url = "../cgi-bin/emrweb02.pbl?reportno=01&template=100" +
       "&admissno=" + admissno.replace(/ /g,"+") 
 parent.menu.EmergencyMenu.innerHTML=""
 EmergencyFrameLink(url,1,1,1004,525)
}
function updDoc(doctor) {
if(isWhitespace(doctor.value)){return;}
doctor=doctor.value.toUpperCase()
admissno='%EMRWEB01.01.021';
emcndoct='%EMRWEB01.01.040';
// validate doctor exists in patdo1af
  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=3" +
                    "&valdcode=" + doctor.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status!=0) {  return; }   

// validate doctor exists in emrdocaf
  if (emcndoct==1) {
    var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=11" +
                      "&valdcode=" + doctor.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) { return; }   
  }

  var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=3" +
                    "&admissno=" + admissno +
                    "&doctcode=" + doctor +
                    "&updttype=ALDOC" +
                    "&updateky=1"
  var returnValue = RSExecute(serverURL);

  if(top.content.location.search.substring(1,22)=="reportno=1&template=4"){
    admissno=admissno - 0
    if (top.content.PatientLinks.admissno.value == admissno) {
        top.content.location.reload();
    }
  }

  location.reload();
}
function SelectDoctor(doctcode) {
 if(top.content.location.search.substring(1,23)=="reportno=2&template=3"){
 if (IsDirtyTriage(top.content.UpdateForm)==true) { return; }} 
  var url = "../cgi-bin/emrweb01.pbl?" +
            "reportno=1&template=16" +
            "&doctcode=" + doctcode.replace(/ /g,"+")
 parent.content.location=url
}
function IsDirtyTriage(eForm) {
  for (var i=0; i < eForm.length; i++) {
    var eElem = eForm.elements[i];
    if ("text" == eElem.type || "textarea" == eElem.tagName)
    {
      if (eElem.value != eElem.defaultValue)  {
      return true;}
    }
    else if ("checkbox" == eElem.type || "radio" == eElem.type)
    {
      if (eElem.checked != eElem.defaultChecked) return true;
    }
  }
  return false;
}
</script>
<form name=defPatientLink method=get>
<input type=hidden name=serverid value="emrweb02">
<input type=hidden name=reportno value="01">
<input type=hidden name=template value="100">
<input type=hidden name=nextseq value="%EMRWEB01.01.021">
<input type=hidden name=waiting> 
</form>
