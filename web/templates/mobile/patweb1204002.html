Content-Type: text/html
Cache-Control: no-cache

<!doctype html>
<html>
<head>	
<!--"TemplateVersion"  : "V12.01.00"
    "TemplateHome"     : "mobile"-->
<script type="text/javascript" src="../html/ipad/ipad.js"> </script>
<script type="text/javascript" src="../html/ipad/ipadform.js"> </script>
<!--<script type="text/javascript" src="../html/ipad/patweb1204002.xx"> </script>-->
<link   rel="stylesheet" href="../html/ipad/ipad.css" type="text/css">
<script type="text/javascript">
var flagExpectedType=0;
function setButtons() {
  var statuscheck=false;
  if(document.AddForm.admistat.value == "1") {
    document.getElementById('PreAdmission').style.display="";
    flagExpectedType=1;
    if(document.AddForm.ibcnmhos.value=="1") {
      document.AddForm.ptmis068.className="Mandatory"
    }
    statuscheck=true;
  }
  if(document.AddForm.thetflag.value == "1" &&
    (document.AddForm.bookstat.value == "0" || 
     document.AddForm.bookstat.value == "1")) {
     if(document.AddForm.ptcnbbap.value == "1") {
       document.getElementById('PostOpWardBed').style.display="";
       statuscheck=true;
       if(document.AddForm.ibcnmhos.value=="1") {
         document.AddForm.bokrx002.className="Mandatory"
       }
     } else if(document.AddForm.bookstat.value == "0") {
       document.getElementById('ExpectedWardBed').style.display="";
       flagExpectedType=2;
       statuscheck=true;
       if(document.AddForm.ibcnmhos.value=="1") {
         document.AddForm.ptmis068.className="Mandatory"
       }
     }
  }
  if(document.AddForm.admistat.value == "2" &&
     document.AddForm.bookstat.value == "3" &&
     document.AddForm.ptcnbbap.value == "1") {
       document.getElementById('PostOpWardBed').style.display="";
       statuscheck=true;
       if(document.AddForm.ibcnmhos.value=="1") {
         document.AddForm.bokrx002.className="Mandatory"
       }
  }
  if(statuscheck==false) {
    alertify.alert("Invalid Admission/Booking status for Ward/Bed allocation update");
    DFrameExit();
  }

  var actionBtn = parent.document.getElementById('actionButton');
  if(actionBtn) {
    actionBtn.className = actionBtn.className.replace(/SpanButton/g,"");
    actionBtn.className = actionBtn.className.replace(/Blue/g,"");
    actionBtn.className = actionBtn.className + " SpanButtonBlue";
    actionBtn.innerText = "Save";
    actionBtn.onclick = function() { submitUpdate() }
  }
}
function submitUpdate() {
  if (flagExpectedType==1) {
     wd=document.AddForm.pre_ptmis068;
     bd=document.AddForm.pre_ptmis076;
     document.AddForm.ptmis068.value=wd.options[wd.selectedIndex].value;
     document.AddForm.ptmis076.value=bd.options[bd.selectedIndex].value;
  }
  if (flagExpectedType==2) {
     wd=document.AddForm.exp_ptmis068;
     bd=document.AddForm.exp_ptmis076;
     document.AddForm.ptmis068.value=wd.options[wd.selectedIndex].value;
     document.AddForm.ptmis076.value=bd.options[bd.selectedIndex].value;
  }
  var bool = validateMandatory(AddForm);
  if(bool) {
    theURL=document.AddForm.action;
    var postStr=AJAXPostString2(document.AddForm)
    var xmlHttp = createHttpObject();
    xmlHttp.open("POST", theURL, false);
    xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    xmlHttp.send(postStr);
    if (xmlHttp.status=="200") {
      if (xmlHttp.responseText.match(/PROCESSING|OK/i)) {
        parent.document.location.reload()
        return;
      }
      else {
        alertify.alert(xmlHttp.responseText.replace(/.*alert../i,"").replace(/.\).*/i,""));
      }
    }
    else {
      alertify.alert("Web Service Not Available. Check your Connection and Try Again.");
    }
  }
  return bool
}
</script>

</head>
%START.OF.PAGE
<body onload="setButtons();">
<ul class=sectionList>
  <li class=sectionItem>
  <div style='text-align:center;font-family:Arial;'>
  %PATWEB12.04.002
  (%PATWEB12.04.019,  %PATWEB12.04.020,  %PATWEB12.04.021, %PATWEB12.04.003) <br />
  </div>
  </li>
</ul>
<form name=AddForm method=post action=patweb12.pbl>
<input type=hidden name=reportno value="4">
<input type=hidden name=template value="001">
<input type=hidden name=updttype value="U">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=admistat value="%PATWEB12.04.525">
<input type=hidden name=bookstat value="%PATWEB12.04.526">
<input type=hidden name=thetflag value="%PATWEB12.04.527">
<input type=hidden name=urnumber value="%PATWEB12.04.003">
<input type=hidden name=admissno value="%PATWEB12.04.081">
<input type=hidden name=ptcnbbap value="%STANDARD.01.025.114.137.0.1">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="PROCESSING|OK">
<input type=hidden name=ptmis068 value="">
<input type=hidden name=ptmis076 value="">

<ul class=sectionList id=PreAdmission style='display:none'>
  <li class=sectionItem>
  <span class="titleText">Expected Ward/Bed</span>
  </span></li>
  <li class=sectionItem>
  <span class="labelText">Ward</span>
  <span class="sectionText">
  <select name=pre_ptmis068 title="Expected Ward"
  onchange="selectOptions2('31',AddForm.pre_ptmis068,AddForm.pre_ptmis076);">
  <option></option>
  %PATWEB12.04.521.2
  </select>
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Bed</span>
  <select name=pre_ptmis076 title="Expected Bed">
  <option></option>
  %PATWEB12.04.522.1
  </select>
  </span></li>
</ul>

<ul class=sectionList id=PostOpWardBed style='display:none'>
  <li class=sectionItem>
  <span class="titleText">Post Operation</span></li>
  <li class=sectionItem>
  <span class="labelText">Ward</span>
  <span class="sectionText">
  <select name=bokrx002 title="Expected Post-Op Ward"
  onchange="selectOptions2('31',AddForm.bokrx002,AddForm.bokrx038);">
  <option></option>
  %PATWEB12.04.523.2
  </select>
  </span></li>
  <li class=sectionItem>
  <span class="labelText">Bed</span>
  <select name=bokrx038 title="Expected Post-Op Bed">
  <option></option>
  %PATWEB12.04.524.1
  </select>
  </span></li>
</ul>
<ul class=sectionList id=ExpectedWardBed style='display:none'>
  <li class=sectionItem>
  <span class="labelText">Expected Ward/Bed</span>
  </span></li>
  <li class=sectionItem>
  <span class="labelText">Ward</span>
  <span class="sectionText">
  <select name=exp_ptmis068 title="Expected Ward"
  onchange="selectOptions2('31',AddForm.exp_ptmis068,AddForm.exp_ptmis076);">
  <option></option>
  %PATWEB12.04.542.2
  </select>
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Bed</span>
  <span class="sectionText">
  <select name=exp_ptmis076 title="Expected Bed">
  <option></option>
  %PATWEB12.04.543.1
  </select>
  </span></li>
</ul>
</form>

</body>
