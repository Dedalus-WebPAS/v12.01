Content-Type: text/html
Cache-Control: no-cache

<!doctype html>
<html>
<head>	
<!--"TemplateVersion"  : "V12.01.00"
    "TemplateHome"     : "mobile"-->
<script type="text/javascript" src="../html/ipad/ipad.js"> </script>
<script type="text/javascript" src="../html/ipad/ipadform.js"> </script>
<link   rel="stylesheet" href="../html/ipad/ipad.css" type="text/css">
<script type="text/javascript">
function setButtons() {
  var actionBtn = parent.document.getElementById('actionButton');
  if(actionBtn) {
    actionBtn.className = actionBtn.className.replace(/SpanButton/g,"");
    actionBtn.className = actionBtn.className.replace(/Blue/g,"");
    actionBtn.className = actionBtn.className + " SpanButtonBlue";
    actionBtn.innerText = "Save";
    actionBtn.onclick = function() { submitUpdate() }
  }
}
function submitUpdate() {
  var bool = validateMandatory(UpdateForm);
  if(bool) {
    theURL=document.UpdateForm.action;
    document.UpdateForm.updttype.value='U';
    var postStr=AJAXPostString2(document.UpdateForm)
    var xmlHttp = createHttpObject();
    xmlHttp.open("POST", theURL, false);
    xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    xmlHttp.send(postStr);
    if (xmlHttp.status=="200") {
      if (xmlHttp.responseText.match(/PROCESSING|OK/i)) {
        parent.document.location.reload();
      } else {
        alertify.alert(xmlHttp.responseText.replace(/.*alert../i,"").replace(/.\).*/i,""));
      }
    } else {
      alertify.alert("Web Service Not Available. Check your Connection and Try Again.");
    }
  }
  return bool
}
function SetMandatory() {
 if(!isWhitespace(document.UpdateForm.pmhrd007.value)) {
    document.UpdateForm.pmhrd009.className="Mandatory";
    document.UpdateForm.pmhrd010.className="Mandatory";
    if(isWhitespace(document.UpdateForm.pmhrd009.value)) {
      document.UpdateForm.pmhrd009.value=document.UpdateForm.currdate.value
      document.UpdateForm.pmhrd010.value=document.UpdateForm.currtime.value
    }
 } else {
    document.UpdateForm.pmhrd009.className="";
    document.UpdateForm.pmhrd009.value="";
    document.UpdateForm.pmhrd010.className="";
    document.UpdateForm.pmhrd010.value="";
 } 
}
function dateSelection(el,defaultDate,noDays) {
  var now = new Date();
  if (isWhitespace(defaultDate)) {
    defaultDate=document.getElementById("currdate").value;
  }
  defaultDay=defaultDate.substr(0,2)
  defaultMonth=Mth3Num(defaultDate.substr(3,3))-1 
  defaultYear=defaultDate.substr(7,4) 
  now = new Date(defaultYear,defaultMonth,defaultDay,0,0,0);       // midnight
  var today = new Date(defaultYear,defaultMonth,defaultDay,0,0,0); // midnight
  var tomorrow = new Date(today.getTime()+(1*24*60*60*1000));
  var weekday=new Array(7);
  weekday[0]="Sun";
  weekday[1]="Mon";
  weekday[2]="Tue";
  weekday[3]="Wed";
  weekday[4]="Thu";
  weekday[5]="Fri";
  weekday[6]="Sat";
  for (var i=0;i<noDays;i++) {
     var theDay = new Date(now.getTime()-(i*24*60*60*1000));
     dayVal = "0"+theDay.getDate();
     mthVal = "0"+(theDay.getMonth()+1);
     dayVal=dayVal.substr(dayVal.length-2,2);
     mthVal=mth3Name(mthVal.substr(mthVal.length-2,2));
     dateVal = dayVal+' ' + mthVal + ' ' +  theDay.getFullYear();
     dateName=weekday[theDay.getDay()] + ' ' + dateVal;
     if (i==0) { dateName="Today"; }
     if (i==1) { dateName="Yesterday"; }
     el.options[el.options.length]=new Option(dateName,dateVal);
  }
  var maxIndex=1;
  for (i=0;i<7;i++) {
    cookieName="orderSelectDateIndex"+i;
    usageCount=parseInt(getCookie(cookieName),10);
    if (isNaN(usageCount)) {
      usageCount=0;
      setCookie(cookieName,"0",90);
    }
    if (usageCount>maxIndex) {
      maxIndex=usageCount;
      //document.UpdateForm.selectOrderdte.selectedIndex=i;
    }
  }
}
function setDefaultTime(el,defaultTime) {
  for (i=el.options.length-1;i>0;i--) {
    if (el.options[i].value>defaultTime) {
      el.selectedIndex=i
    }
  }
}
function timeSelection(el,defaultTime,timeInterval) {
  var hr=0;
  var mn=0;
  var defaultOption=0;
  var setCurrent=true;
  if (isWhitespace(defaultTime)) {
    defaultTime=document.getElementById("currtime").value;
  }
  for (var hr=0;hr<24;hr++) {
    for (var mi=0;mi<60;mi=mi+timeInterval) {
      hrVal="00"+hr;
      miVal="00"+mi;
      timeVal=hrVal.substr(hrVal.length-2,2)+":"+miVal.substr(miVal.length-2,2)
      if (timeVal!="00:00") {
        el.options[el.options.length]=new Option(timeVal,timeVal);
        if ((timeVal>defaultTime.substr(0,5))&&setCurrent) {
          defaultOption=el.options.length-1;
          setCurrent=false;
        }
      }
    }
  }
  el.selectedIndex=defaultOption;
}
</script>
</head>
%START.OF.PAGE
<body onload="setButtons();init();">
<form name=UpdateForm method=post action=patweb12.pbl>
<input type=hidden name=reportno value="5">
<input type=hidden name=template value="003">
<input type=hidden name=updttype value="">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="PROCESSING|OK">
<input type=hidden name=bedreqky value="%PATWEB12.05.035">
<input type=hidden name=pmhrd008 value="%STANDARD.01.008">
<input type=hidden id=currdate name=currdate value="%STANDARD.01.015">
<input type=hidden id=currtime name=currtime value="%STANDARD.01.016">

<ul class=sectionList>
  <li class=sectionItem>
  <span class="labelText">Ward</span>
  <span class="sectionText">
    %PATWEB12.05.102
    </span></li>
  <li class=sectionItem>
  <span class="labelText">Bed</span>
  <span class="sectionText">
    %PATWEB12.05.103
    </span></li>
    
  <li class=sectionItem>
  <span class="labelText">Request Date/Time</span>
  <span class="sectionText">
    %PATWEB12.05.104 at %PATWEB12.05.105
    </span></li>

  <li class=sectionItem>
  <span class="labelText">Requested Housekeeping Status</span>
  <span class="sectionText">
    %PATWEB12.05.106.0
    </span></li>

  <li class=sectionItem>
  <span class="labelText">Completed Housekeeping Status</span>
  <span class="sectionText">
    <select name=pmhrd007 title="Completed Housekeeping Status"
     onchange="SetMandatory();">
    <option></option>
    %PATWEB12.05.107.2
    </select>
    </span></li>

  <li class=sectionItem>
  <span class="labelText">Completed Date</span>
  <span class="sectionText">
    <select name=pmhrd009 title="Completed Date" ></select>
    </span></li>
  <li class=sectionItem>
  <span class="labelText">Completed Time</span>
  <span class="sectionText">
    <select name=pmhrd010 title="Completed Time" ></select>
    </span></li>

  <li class=sectionItem>
  <span class="labelText">Satisfactory Status</span>
  <span class="sectionText">
    <select name=pmhrd011 title="Satisfactory Status">
    <option></option>
    %PATWEB12.05.111.2
    </select>
    </span></li>

  <li class=sectionItem>
  <span class="labelText">Cleaner Responsible</span>
  <span class="sectionText">
    <select name=pmhrd014 title="Cleaner Responsible">
    <option></option>
    %PATWEB12.05.114.2
    </select>
    </span></li>

  <li class=sectionItem>
  <span class="labelText">Comment</span>
  <span class="sectionText">
    <input type=text name=pmhrd012 value="%PATWEB12.05.112" size=52 maxlength=50>
    <input type=text name=pmhrd013 value="%PATWEB12.05.113" size=52 maxlength=50>
    </span></li>
</ul>
</form>
<script type="text/javascript">
function init() {
 dateSelection(document.UpdateForm.pmhrd009,'%PATWEB12.05.109',7)
 timeSelection(document.UpdateForm.pmhrd010,'%PATWEB12.05.110',5)
 document.UpdateForm.pmhrd012.value=trim(document.UpdateForm.pmhrd012.value)
 document.UpdateForm.pmhrd013.value=trim(document.UpdateForm.pmhrd013.value)
 if(isWhitespace(document.UpdateForm.pmhrd007.value)) {
   for(var i=0; i < document.UpdateForm.pmhrd007.length; i++) {
     if(document.UpdateForm.pmhrd007.options[i].value.substr(3,1)=="C"){
        document.UpdateForm.pmhrd007.selectedIndex=i;
        SetMandatory();
     }
   }
 }
}
</script>
</body>
