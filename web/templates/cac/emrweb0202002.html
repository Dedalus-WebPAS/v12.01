<meta name="TemplateVersion" content="V12.01.01">
<meta name="TemplateHome" content="cac">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<link rel="stylesheet" href="../html/postcode.css" type="text/css">
<script type="text/javascript" src="../js/IBA_Category_C_.js"></script>
<script type="text/javascript" src="../js/EmrRegistration.js"></script>
<script type="text/javascript" src="../js/emrweb0202002.js"></script>
<script type="text/javascript" src="../js/emrweb0201102.js"></script>
<script type="text/javascript">
//==========================================================================
// Scan all select lists & checkboxes in form & add selected/checked attributes
// to all selectedIndexes & checked checkboxes (needed for IsDirtyNHI())
//==========================================================================
function addSelectedAttr1(eForm) {
  for (var i=0; i < eForm.length; i++) {
    var eElem = eForm.elements[i];
    if (eElem.type == "checkbox" || eElem.type == "radio") {
      if (eElem.checked) {
        eElem.setAttribute('checked','true');
      }
    }
    if (eElem.tagName == "SELECT") {
      for (var j=0; j < eElem.options.length; j++) {
        var option = eElem.options[j]
        if (j==eElem.selectedIndex) {
          option.setAttribute('selected',true);
        }
      }
    }
  }
}
//==========================================================================
// Scan all elements in table and return true if any elements have been changed
//==========================================================================
function IsDirtyNHI1() {
  if (UpdateForm.nzpmichg.value=="1") { return true; }

  for (const arg of arguments) { // loop through function arguments (table ids)
    var table = document.getElementById(arg);
    elements = table.getElementsByTagName('*');
    for (var i=0; i < elements.length; i++) {
      var eElem = elements[i];
      if (eElem.type == "text" || eElem.type == "textarea") {
        if(eElem.name) {
          if(eElem.name=="prcom001") { continue; }
        }
        if (trim(eElem.value) != trim(eElem.defaultValue))  {
          return true; }
      }
      if (eElem.type == "checkbox" || eElem.type == "radio") {
        if (eElem.checked != eElem.defaultChecked && !eElem.disabled) {
          return true; }
      }
      if (eElem.tagName == "SELECT") {
        if (!eElem[eElem.selectedIndex].defaultSelected) {
          return true; }
      }
    }
  }
  return false;
}
function DisplayPresentComplaintAddInfo() {
  f = document.UpdateForm;
  if (f.emcprcmp.value == "1") {
    document.getElementById('PresentComplaintAddInfo').style.display = "";
  }
  else {
    document.getElementById('PresentComplaintAddInfo').style.display = "none";
  }
}
function init() {
  if(!CheckEmrVisit(UpdateForm.urnumber.value,UpdateForm.emvis001.value)){
    PatientLinkTo("emrweb02.pbl",1,1,0,0,0);
  }
}

function UpdateThisVis() {
  var check=false;
  for(var i = 0; i < UpdateForm.emvis003.length; i++)
     if (UpdateForm.emvis003[i].checked==true) {
      check=true;
     }
  if (check==false) {
    alert("Triage Category has not been selected !");
    return true;}

  SetOptOutSMS();
  UpdateVisit();
}

function Validateprecom001() {
    var formatedtext=formateText(UpdateForm.prcom001,'50')
    if ((formatedtext.split(/[\r\n]/).length>6) || 
        (UpdateForm.prcom001.value.length > 300)) {
      alert("Presenting Complaint comments - Max 6 lines."
          + "\nPlease remove extra lines to continue.");
      document.UpdateForm.prcom001.focus();
      return; }
}

function updateNHI01() {
  if(document.getElementById('emr02sub').disabled==true) {
    return;
  }
  if (validateMandatory(UpdateForm)) {
    document.UpdateForm.redirect.value="nhiweb99.pbl?reportno=01&template=010" +
    "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+")  +
    "&admissno=" + document.PatientLinks.admissno.value.replace(/ /g,"+");
    tempDisable(document.getElementById('emr02sub'),5);
    SetOptOutSMS();
    UpdateVisit();
  }
}
function UpdateVisit() {
  if (validateMandatory(UpdateForm)) {
    validateDemographicsConfirmedDate

    if(!IsDirtyNHI1('PatDemo','PMIDet','ResDet')) {
      UpdateForm.nzpmichg.value = '1';
    }

    if (document.UpdateForm.redirect.value.substr(0,12)!=="nhiweb99.pbl") {
      setRedirect();
    }
    document.UpdateForm.formactn.value="N3"
    document.UpdateForm.updttype.value="REGIS"
    UpdateWin=window.open("","HideUpdateWindow",
      "width=10,height=10,top=1024,directories=no,location=no" +
      ",scrollbars=no,status=no,toolbar=no,menubar=no,resizeable=no")
    document.UpdateForm.target="HideUpdateWindow";
    document.UpdateForm.submit()
  }
}
function validateDemographicsConfirmedDate() {
  f = document.UpdateForm;
  if (f.ptcnavcd.value == "1") {
    f.ptmas086.value = f.currdate.value;
    return;
  }
  else {
    if (f.ptcnavcd.value == "2") {
      if (!isWhitespace(f.ptmas086.value)) {
        if (f.ptmas086.value !=
            f.currdate.value ) {
          alert("Warning: Confirm Demographics date has not been updated");
          f.ptmas086.value = f.ptmas086.defaultValue;
        }
      }
      return;
    }
  }
}
// Copy of HCPSearchFrame without all clears that effect GPHCGSearchFrame //
function HCPSearchFrame(ReturnCode,ReturnName,ReturnProv,ReturnPrac,ReturnDesc,ReturnCntr) {
  DFrameStart()
  SearchType="" ;
  window.ReturnFunction="" ;
  for (var i=6; i < HCPSearchFrame.arguments.length; i++) {
    if (typeof(HCPSearchFrame.arguments[i]) == 'function') {
      window.ReturnFunction=HCPSearchFrame.arguments[i] }
    else {
      SearchType=HCPSearchFrame.arguments[i]
    } }

  window.ReturnCode=ReturnCode ;
  window.ReturnName=ReturnName ;
  window.ReturnProv=ReturnProv ;
  window.ReturnPrac=ReturnPrac ;
  window.ReturnDesc=ReturnDesc ;
  window.ReturnCntr=ReturnCntr ;
  document.getElementById('PopUpFrame').src="../lookups/HCPSearchFrame"+SearchType+".html"
  SearchFrameShow()
}
function ReadDocOnly(OptionNumber,OptionType,ReturnCode,ReturnName) {
  ReturnName.value="";
  if (isWhitespace(ReturnCode.value)) return;;
  var serverURL  = "../cgi-bin/patweb80.pbl?reportno=" + OptionNumber +
               "&returnfm=2" + "&valdtype=" + OptionType +
               "&valdcode=" + ReturnCode.value.replace(/ /g,"+")

  var returnValue = RSExecute(serverURL);

  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    ReturnName.value=trim(ReturnValue[0]); }
 else {
    ReturnCode.value="";
    ReturnCode.select();
    return false; }
}
function setRedirect() {
  if (document.UpdateForm.emvis008.value.substr(5,1)=="A") {
     document.UpdateForm.redirect.value="patweb89.pbl?reportno=1&template=005"
     + "&urnumber=" + document.UpdateForm.urnumber.value
     + "&admissno=" + document.UpdateForm.admissno.value 
     + "&systflag=1"  }
  else {
     document.UpdateForm.redirect.value="patweb89.pbl?reportno=1&template=114"
     + "&urnumber=" + document.UpdateForm.urnumber.value
     + "&admissno=" + document.UpdateForm.admissno.value }
}
function validateLocation(SearchField,SearchName) {
  if (isWhitespace(SearchField.value)) {
      SearchName.value="";
      return;;
  }
  SearchField.value=SearchField.value.toUpperCase()
  var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=2" +
                    "&valdcode=" + SearchField.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
    SearchName.value=trim(ReturnValue[1])
    SearchField.value=ReturnValue[0]
  }
  else {
     document.UpdateForm.emvis006.focus();
     document.UpdateForm.emvis006.value="";
     document.UpdateForm.name_emvis006.value="";
  }
}
function showMobilePhoneDet() {
  if(document.getElementById("ptcnsmsn").value == "1") {
    MobilePhone.innerHTML = showMobPhoneOptOut.innerHTML;
    if(document.getElementById('ptmsx050').value=="1") {
      document.getElementById('d_ptmsx050').checked=true;
    }
  }
  else {
    MobilePhone.innerHTML = showMobPhoneOnly.innerHTML;
  }
}
</script>
%START.OF.PAGE
<body onLoad="PageLoad(event);checkReferred();DispPrefGivenName();
              DisplayResidency();
              ChkIdentifyGenderPronounTitle(document.UpdateForm);
              showMobilePhoneDet();DisplayPresentComplaintAddInfo();
              addSelectedAttr1(UpdateForm);"> 
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%EMRWEB02.02.003";
PatientVIS="%EMRWEB02.02.081";
PatientNAM="%EMRWEB02.02.002";
PatientSTA="%EMRWEB02.02.086.078";
PatientALT="%EMRWEB02.02.084";
PatientSEX="%EMRWEB02.02.019";
PatientDOB="%EMRWEB02.02.020";
PatientAGE="%EMRWEB02.02.021";
PatientLOC="%EMRWEB02.02.083";
PatientPRI="%EMRWEB02.02.086.066.1";
PatientUNT="%EMRWEB02.02.066.0";
PatientIND="%EMRWEB02.02.086.091";
GpCOD="%EMRWEB02.02.085.036.001";
GpNAM="%EMRWEB02.02.085.036.081";
GpPRAC="%EMRWEB02.02.086.085.001";
GpPRACCNT="%EMRWEB02.02.086.085.002";
GpPRACNAM="%EMRWEB02.02.086.085.005";
PatientARR="%EMRWEB02.02.101.0 %EMRWEB02.02.102";
PatientSEE="%EMRWEB02.02.130.0 %EMRWEB02.02.131";
PatientTRI="%EMRWEB02.02.103.3";
PatientECLC="%EMRWEB02.02.484.1";
PatientCLH="%STANDARD.01.017.CL";
PatientEHFT="%EMRWEB02.02.485";
InsertEmergencyHeader();
</script>
<form name=UpdateForm action="emrweb02.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="02">
<input type=hidden name=updatety value="4">
<input type=hidden name=emvis006 value="WR">
<input type=hidden name=formactn>
<input type=hidden name=updttype>
<input type=hidden name=urnumber value="%EMRWEB02.02.003">
<input type=hidden name=admissno value="%EMRWEB02.02.081">
<input type=hidden name=updateky value="%EMRWEB02.02.700">
<input type=hidden name=chckname>
<input type=hidden name=redirflg value="1">
<input type=hidden name=nextpage value="3">
<input type=hidden name=ptcnueoc value="%EMRWEB02.02.454">
<input type=hidden name=redirect value="patweb89.pbl?reportno=01&template=113"> 
<input type=hidden name=docdumm1 value="">
<input type=hidden name=docdumm2 value="">
<input type=hidden name=docdumm3 value="">
<input type=hidden name=docdumm4 value="">
<input type=hidden name=dummx value="">
<input type=hidden name=ptcnsmsn id=ptcnsmsn
       value="%STANDARD.01.025.120.243.0.1">
<input type=hidden name=ptmsx050 id=ptmsx050
       value="%EMRWEB02.02.085.066.1">
<input type=hidden name=ptcnnewc id=ptcnnewc
       value="%STANDARD.01.025.118.138.0.1">
<input type=hidden name=pchgdte id=pchgdte value="%EMRWEB02.02.085.070">
<input type=hidden name=ptmautim id=ptmautim value="%EMRWEB02.02.085.071">
<input type=hidden name=ptmauuid id=ptmauuid value="%EMRWEB02.02.085.072.0">
<input type=hidden name=d_ptmauuid id=d_ptmauuid
 value="%EMRWEB02.02.085.072.1">
<input type=hidden name=sjogaudt value="1">
<input type=hidden name=sjogaudi value="1">
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden name=ptcnavcd value="%STANDARD.01.025.125.183.0.1">
<input type=hidden name=ptcnhdps id=ptcnhdps
       value="%STANDARD.01.025.080.250.1.1">
<input type=hidden name=ptcnnmpr value="%STANDARD.01.025.128.226.1.1">
<input type=hidden name=ptcndfgn value="%STANDARD.01.025.120.182.0.1">
<input type=hidden name=nhmas002 value="%EMRWEB02.02.070.004">
<input type=hidden name=nhmas003 value="%EMRWEB02.02.070.005">
<input type=hidden name=nhmas004 value="%EMRWEB02.02.070.006">
<input type=hidden name=nhmas005 value="%EMRWEB02.02.070.007">
<input type=hidden name=emcprcmp id=emcprcmp
 value="%STANDARD.01.025.122.051.1.1">
<input type=hidden name=nzpmichg value="">

<table align=center width=100% cellspacing=0 cellpadding=2>
<tr><td>

<table id=PatDemo align=center width=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=HeadingCell colspan=6 width=100% align=center>
     Patient Demographics </td></tr>
<tr><td class=DataLabel width=11%>Title </td>
    <td width=20%><select title="Patient Title"
        name=ptmas001 tabindex=1 id=ptmas001 >
        <option></option>
        %STANDARD.01.029
        </select>
        </td>
    <td class=DataLabel width=11%>Address Line 1</td>
    <td width=20%><input type=text size=25 maxlength=25  tabindex=6
        name="ptmas008" title="Address Line 1" class=Mandatory
        value="%EMRWEB02.02.012" onclick="updateNHI01()"></td>
    <td class=DataLabel width=11%>Private Phone</td>
    <td width=27%><input type=text size=23 maxlength=20
        name=ptmas012 title="Private Phone No" tabindex=11
        value="%EMRWEB02.02.017" ></td></tr>

<tr><td class=DataLabel> Surname</td>
    <td><input type=text size=40 name=ptmas005 
        title="Patient Surname" maxlength=40 class=Mandatory
        value="%EMRWEB02.02.009" tabindex=2 
        onclick="updateNHI01()"></td>
    <td class=DataLabel>Address Line 2</td>
    <td><input type=text size=25 maxlength=25 
        name=ptmas009 title="Address Line 2" tabindex=7
        value="%EMRWEB02.02.013" 
        onclick="updateNHI01()"></td>
    <td class=DataLabel>Business Phone</td>
    <td><input type=text size=23 maxlength=20 
        name=ptmas013 title="Business Phone No" tabindex=12
        value="%EMRWEB02.02.018" ></td></tr>

<tr><td class=DataLabel>Given Names</td>
    <td><input type=text size=25 maxlength=25 
        title="Patient Given Names" class=Mandatory tabindex=3
        name=ptmas006 value="%EMRWEB02.02.010" 
        onclick="updateNHI01()">
    </td>
    <td class=DataLabel>Suburb  </td>
    <td><input type=text size=25 maxlength=25 
       name=ptmas010 title="Address Line 3" tabindex=8
       value="%EMRWEB02.02.014" readonly
       onclick="updateNHI01()"></td>
    <td class=DataLabel>Mobile Phone</td>
    <td><div id=MobilePhone></div></td>
</tr>

<tr id=PrefGivenName style="display:none">
    <td class=DataLabel>Preferred Given Name</td>
    <td><input type=text size=25 maxlength=25 name=pmpxi083
         title="Preferred Given Name" value="%EMRWEB02.02.698"
         tabindex=3 onchange="UpCase(this);checkPrefGivenName('%EMRWEB02.02.698');"></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.G </td>
    <td><select name="ptmas014" tabindex=4
        title="%STANDARD.01.017.G " class=Mandatory
         onchange="ChkIdentifyGenderPronounTitle(document.UpdateForm);"
         onclick="updateNHI01()">
         <option></option>
           %EMRWEB02.02.086.099.061.9.1.19.3.H
         </select></td>
    <td class=DataLabel>Town / City / Post Code / Country</td>
    <td><input type=text size=25 maxlength=25 
       name=ptmas011 title="Address Line 4" tabindex=9
       value="%EMRWEB02.02.015" 
       onclick="updateNHI01()"></td></tr>

<tr><td class=DataLabel>Date of Birth</td>
    <td><input type=text size=12 name=ptmas016 title="Date of Birth"
         value="%EMRWEB02.02.020" tabindex=5 class=Mandatory
         onclick="updateNHI01()"></td>
    <td class=DataLabel>Domicile</td>
    <td><input type=text size=5 maxlength=4 
       name=ptmas011 title="Domicile" tabindex=10
       onclick="updateNHI01()" value="%EMRWEB02.02.070.015">
    </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>
<tr id=GenderExtra>
  <td><div id=IdenGenLbl></div></td>
  <td><div id=IdenGenDetail></div></td>
  <td><div id=IdenProLbl></div></td>
  <td><div id=IdenProDetail></div></td>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
</tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=0>
<tr>
    <td width=31%>&nbsp;</td>
    <td width=24% id=lstuptdg></td>
    <td width=7%>&nbsp;</td>
    <td class=DataLabel width=11%
        id=DemogDateLbl>Demographics Confirmed Date</td>
      <td class=DataLabel width=10% id=DemogDateLblBlue>
        <font color=#1E90FF>Demographics Confirmed Date</td>
    <td width=20%>
      <input type="text" class="PastDate" name=ptmas086 id=ptmas086
       title="Demographics Confirmed Date" tabindex=14 notab
       value="%EMRWEB02.02.085.059">
      <img class=Icon src="../images/DateTimeStamp.gif" class=icon
       onclick="SetCurrentDateTime(UpdateForm.ptmas086,null);">
      <img class=Icon src="../images/DateLookup.gif" class=icon
       onclick="DateLookupFrame(UpdateForm.ptmas086);">
    </td>
    <td width=7%>&nbsp;</td>
</tr>
</table>

<table id=PMIDet align=center width=100% border=0 cellspacing=0 cellpadding=0>
<tr><td colspan=6 class=HeadingCell align=center >
      PMI Details </td></tr>
<tr><td>

<tr><td class=DataLabel width=11%>Previous Name</td>
    <td width=20%><input type="text" name="ptmas007" title="Previous Name"
         value="%EMRWEB02.02.011" tabindex=15></td>
    <td class=DataLabel width=11%>Marital Status</td>
    <td width=20%><select name=ptmas015 tabindex=21 class=select120
        title="Marital Status">
        <option></option>
         %EMRWEB02.02.069.2
        </select></td>
    <td class=DataLabel width=11%>Religion</td>
    <td width=27%><select name=ptmas019 tabindex=26 class=select120
        title="Religion">
        <option></option>
        %EMRWEB02.02.023.2
        </select></td>
 </tr>

<tr><td class=DataLabel>Ethnicity 1</td>
    <td><select name=ptmas021 tabindex=16 readonly
         title="Ethnicity 1"
         onclick="updateNHI01()">
        <option></option>
        %EMRWEB02.02.070.020.2
        </select>
    </td>
    <td class=DataLabel>Ethnicity 2 </td>
    <td><select name=ptmas021 tabindex=22 readonly
         title="Ethnicity 2"
         onclick="updateNHI01()">
         <option></option>
        %EMRWEB02.02.070.021.2
        </select>
    </td>
    <td class=DataLabel>Ethnicity 3 </td>
    <td><select name=ptmas021 tabindex=27 readonly
         title="Ethnicity 3"
         onclick="updateNHI01()">
         <option></option>
        %EMRWEB02.02.070.022.2
        </select>
    </td></tr>

<tr><td class=DataLabel>Iwi 1</td>
    <td><select title="Iwi 1" name=pmpxi078 tabindex=17>
         <option></option>
        %EMRWEB02.02.686.2
        </select>
    </td>
    <td class=DataLabel>Iwi 2 </td>
    <td><select title="Iwi 2" name=pmpxi079 tabindex=23>
         <option></option>
        %EMRWEB02.02.687.2
        </select>
    </td>
    <td class=DataLabel>Iwi 3 </td>
    <td><select title="Iwi 3" name=pmpxi080 tabindex=28>
         <option></option>
        %EMRWEB02.02.688.2
        </select>
    </td></tr>

<tr><td class=DataLabel>Local GP </td>
    <td><input type="text" size=10 maxlength=10 name=pmpxi059 tabindex=18
         value="%EMRWEB02.02.684.001" title="Local GP"
         onchange="ReadDoc(18,0,pmpxi059,genpname,pmpxi060,
                    genpprac,pmpxi061,genpprov);">
        <input type=text size=25 readonly name=genpname tabindex=-1
            title="Local GP Name"
            value="%EMRWEB02.02.684.081">     
        <img src="../images/SearchIcon.gif" class=Icon
           onclick="GPHCPSearchFrame(pmpxi059,genpname,genpprov,
                   pmpxi060,genpprac,pmpxi061,3)">
        <img src="../images/erase.gif" class=Icon
           onclick="clrFields(pmpxi059,genpname);">
    </td>
    <td class=DataLabel>Folder Selection</td>
    <td><select name=pmpxi077 tabindex=24 title="Folder Selection">
         <option></option>
         %EMRWEB02.02.679.2
         </select></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>

<tr><td class=DataLabel>Practice</td>
    <td><input type=hidden name=pmpxi060 value="%EMRWEB02.02.685.001">
        <input type=text size=25 readonly name=genpprac tabindex=19
            title="Practice"
            value="%EMRWEB02.02.685.005">
        <input type=hidden name=pmpxi061 value="%EMRWEB02.02.661">
        <input type=hidden name=genpprov value="">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="GPHCGSearchFrame(pmpxi059,genpname,genpprov,
                  pmpxi060,genpprac,pmpxi061)">
        <img src="../images/erase.gif" class=Icon
           onclick="clrFields(pmpxi060,genpprac,pmpxi061,genpprov);">
    </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>

<tr><td class=DataLabel>Interpreter Required</td>
    <td><select title="Interpreter Required" name=pmpxi001 tabindex=20>
        %EMRWEB02.02.601.2
        </select>
    </td>
    <td class=DataLabel>Pref Language 1</td>
    <td><select name=pmpxi002 class="select120" tabindex=25
         title="Preferred Language">
        <option></option>
         %EMRWEB02.02.602.2
        </select></td>
    <td class=DataLabel>Pref Language 2</td>
    <td><select name=pmpxi003 class=select120 tabindex=30
         title="Preferred Language">
        <option></option>
         %EMRWEB02.02.603.2
        </select></td>
</tr>
</table>

<table id=ResDet align=center width=100% border=0 cellspacing=0 cellpadding=0>
<tr><td colspan=8 class=HeadingCell align=center >
      Residency Details </td></tr>

<tr><td class=DataLabel width=11%>Country of Birth</td>
    <td width=20%>
        <select name=ptmas018 tabindex=31 class="select120"
         title="Country of Birth">
        <option></option>
        </select></td>
        <script type="text/javascript"> {
         SetCategoryC_(document.UpdateForm.ptmas018,"%EMRWEB02.02.022.1") }
        </script></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>

<tr><td class=DataLabel>Type of Residency</td>
    <td><select name=ptmas020 tabindex=32 class=Mandatory 
         title="Type of Resident" onclick="updateNHI01();">
         <option></option>
         %EMRWEB02.02.024.2
        </select></td>
        <td><div id=ExpiryHeading></div></td>
        <td><div id=ExpiryDate></div></td>
        <td><div id=VisaHeading></div></td>
        <td><div id=Visa></div></td>
        <tr><td><div id=CountryHeading></div></td>
        <td><div id=CountryResidence></div></td>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=11%>Residency Comments</td>
    <td width=40%>
        <input type="text" name="pmres004" size=145 maxlength=127
         title="Residency Comments"  
         value="%EMRWEB02.02.481" tabindex=33>
    </td>
      <td width=8%>&nbsp;</td>
      <td width=8%>&nbsp;</td>
      <td width=8%>&nbsp;</td>
      <td width=8%>&nbsp;</td>
      <td width=8%>&nbsp;</td>
      <td width=9%>&nbsp;</td>
</tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=HeadingCell colspan=6 align=center>
     Emergency Visit Details </td></tr>
<tr><td class=DataLabel width=11%>Arrival Date/Time </td>
    <td width=20%><input type=text size=11 maxlength=11 name="emvis001" 
         title="Arrival Date" class="Mandatory PastDate" tabindex=40>
        <img notab src="../images/DateLookup.gif" class="Icon"
         alt="Show Calendar" date="UpdateForm.emvis001">
        <input type=text size=8 maxlength=8 name="emvis002"  tabindex=41
         title="Arrival Time" class=Mandatory>
        <img notab src="../images/DateTimeStamp.gif" class="Icon"
         alt="Current" date="UpdateForm.emvis001" time="UpdateForm.emvis002">
       <img notab src="../images/TimeLookup.gif" class="Icon"
         alt="Time Select" time="UpdateForm.emvis002">
    </td>

    <td class=DataLabel width=11%>Referral Source</td>
    <td width=20%><select class="Mandatory SelectMed" name=emvis061 tabindex=49 
         title="Referral Source"
         onchange="checkReferred();">
         <option></option>
         %EMRWEB02.02.221.4
         </select></td>
    <td width=11%><div id=TranSrcHeading></div></td>
    <td width=27%><div id=TranSrc></div></td>
</tr>

<tr>
  <td>%STANDARD.01.017.HP</td>
  <td>
    <select name=emvis160 class="Mandatory" tabindex=42 
      title="%STANDARD.01.017.HP">
      <option value=""></option>
      %EMRWEB02.02.281.1.5
    </select>
  </td>

  <td class=DataLabel>Referring HCP</td>
  <td><input type="text" size=8 maxlength=10 name=emvis020 tabindex=50
       title="Referring HCP"
       onchange="ReadDocOnly(18,0,emvis020,doctnam1);">
      <input type=text size=25 readonly name=doctnam1 tabindex=-1
       title="Referring HCP Name">
       <img src="../images/SearchIcon.gif" class=Icon
        onclick="HCPSearchFrame(UpdateForm.emvis020,
                                doctnam1,
                                dummx,
                                dummx,
                                dummx,
                                dummx);">
       <img src="../images/erase.gif" class=Icon
        onclick="clrFields(emvis020,doctnam1);">
  </td></tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=11%>%STANDARD.01.017.CL</td>
    <td width=20%>
        <select class="Mandatory SelectMed" name=emvis008 tabindex=43 
         title="%STANDARD.01.017.CL">
        <option></option>
         %EMRWEB02.02.108.2
        </select>
    </td>
    <td width=11%>Triage Category</td>
    <td width=20%>
     <table border=0 cellspacing=0>
      <td bgcolor=#FF3333><i>1</i></font>
       <input type="radio" name=emvis003 value=1 tabindex=51
             title="Triage Category"></td>
      <td bgcolor=#FF9900><i>2</i><input type=radio name=emvis003 value=2 ></td>
      <td bgcolor=#66FF99><i>3</i><input type=radio name=emvis003 value=3 ></td>
      <td bgcolor=#99CCFF><i>4</i><input type=radio name=emvis003 value=4 ></td>
      <td bgcolor=#FFFFFF><i>5</i><input type=radio name=emvis003 value=5 ></td>
     </table>
    </td>
    <td width=11%></td>
    <td width=27%></td>
</tr>
</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabeld width=11%>Patient Location</td>
    <td width=20%>
       <input type=hidden name=name_emvis006 title="Patient Location"
         value="%EMRWEB02.02.106.0">
        <input type=hidden name=savelocn value="%EMRWEB02.02.106.1">
        <select class=SelectMed name=emvis006 tabindex=44
         title="Patient Location" 
         onchange="validateLocation(emvis006,name_emvis006);">
         <option></option>
         %EMRWEB02.02.106.3
        </select>
    </td>
<!-- Alcohol Involved - CAR 312772 -->
    <td width=11%>%STANDARD.01.017.es</td>
    <td width=20%>
     <select name=emvis067 tabindex=51 title="%STANDARD.01.017.es">
      <option value=""></option>
      %EMRWEB02.02.227.2
     </select>
    </td>
    <td width=11%></td>
    <td width=27%></td>
</tr>

<tr valign=top>
  <td class=DataLabel>Presenting Complaint</td>
    <input type=hidden name=emrviscat value="el">
  <td>
    <input type="text" size=10 tabindex=46 title="Presenting Complaint Code" 
      onKeyUp='UpCase(this);getPresentCom(this,UpdateForm.emvis060,emrviscat);'>
    <select name=emvis060 class="SelectBig" tabindex=47
      title="Presenting Complaint">
    </select>
  </td>
  <td colspan=4>
    <textarea type="text" name=prcom001 wrap=hard cols=50 rows=6 
     tabindex=52 
     onblur="TextareaBlurHandler(this);Validateprecom001();">
    </textarea>
    </select>
  </td>
  <td></td>
  <td></td>
</tr>

<tr valign=top id=PresentComplaintAddInfo>
  <td></td>
  <td></td>
  <td colspan=4>
    <textarea type=text name=vicmt023 id=vicmt023 wrap=hard tabindex=52
     cols=50 rows=6 class=AsciiOnly
     title="Presenting Complaint - Additional Information"
     onkeydown="CheckPresentCompAddInfoTextLimit(this);"
     onblur="TextareaBlurHandler(this);">
    </textarea>
  </td>
</tr>

<tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>   
</table>

<table width=100% border=0>
<tr><td colspan=4 align=center class=DataLabel>
    <input type=button value="New Visit" tabindex=60 id=emr02sub class=button 
     onclick="tempDisable(this,5);UpdateThisVis();">
    <input type=button value="Cancel" tabindex=61 class=button
     onclick="history.go(-1)">
</td></tr>
</table>
</td></tr>
<tr><td>
<div id=SelectHeading></div>
<div id=SelectLocation></div>
</td></tr>
</table>
</form>
<script type="text/javascript">
f = document.UpdateForm;
for (var i=0; i < document.UpdateForm.ptmas001.length; i++) {
  if (document.UpdateForm.ptmas001.options[i].value=="%EMRWEB02.02.005.0"){
      document.UpdateForm.ptmas001.selectedIndex=i;
  }
}
if(document.UpdateForm.emvis061.value.substr(5,1)=="1") {
   document.UpdateForm.emvis032.className="Mandatory";
}

if (isWhitespace(f.pchgdte.value) && isWhitespace(f.ptmauuid.value) &&
    isWhitespace(f.ptmautim.value)) { // all blank
  var lstupd = "Demographics Last Updated by"
} else if (isWhitespace(f.pchgdte.value) && !isWhitespace(f.ptmauuid.value) &&
    isWhitespace(f.ptmautim.value)) { // only userID
  var lstupd = "Demographics Last Updated by " + trim(f.ptmauuid.value) +
  " (" + trim(f.d_ptmauuid.value) + ") "
} else if (!isWhitespace(f.pchgdte.value) && isWhitespace(f.ptmauuid.value) &&
    isWhitespace(f.ptmautim.value)) { // only date
  var lstupd = "Demographics Last Updated on " + f.pchgdte.value
} else if (isWhitespace(f.pchgdte.value) && isWhitespace(f.ptmauuid.value)
  && !isWhitespace(f.ptmautim.value)) { // only time
  var lstupd = "Demographics Last Updated by"
} else if (!isWhitespace(f.ptmauuid.value) && !isWhitespace(f.pchgdte.value) &&
  isWhitespace(f.ptmautim.value)) { // only blank time
  var lstupd = "Demographics Last Updated by " + trim(f.ptmauuid.value) +
  " (" + trim(f.d_ptmauuid.value) + ") " + " on " + f.pchgdte.value
} else if (!isWhitespace(f.ptmauuid.value) && isWhitespace(f.pchgdte.value) &&
  !isWhitespace(f.ptmautim.value)) { // only blank date
  var lstupd = "Demographics Last Updated by"
} else if (isWhitespace(f.ptmauuid.value) && !isWhitespace(f.pchgdte.value) &&
  !isWhitespace(f.ptmautim.value)) { // only blank userID
  var lstupd = "Demographics Last Updated on " + f.pchgdte.value + " at " +
  f.ptmautim.value.substr(0,5)
} else if (!isWhitespace(f.ptmauuid.value) && !isWhitespace(f.pchgdte.value) &&
  !isWhitespace(f.ptmautim.value)) { // nothing blank
   var lstupd = "Demographics Last Updated by " + trim(f.ptmauuid.value) +
  " (" + trim(f.d_ptmauuid.value) + ") " + " on " + f.pchgdte.value + " at "+
  f.ptmautim.value.substr(0,5)
} else {
  var lstupd = ""
}

document.getElementById('lstuptdg').innerText = lstupd;
document.getElementById('lstuptdg').className = "RedText";
document.getElementById('DemogDateLbl').style.display = "none";
document.getElementById('DemogDateLblBlue').style.display = "";
</script>
 
<span id=transferhd style="display:none">
<td width=10% class=DataLabel>Transfer Source</td>
</span>

<span id=transferblank style="display:none">
   <input type=hidden name=emvis032 value="" notab>
</span>

<span id=transfersrc style="display:none">
<td><input type="text" size=5 maxlength=6 name="emvis032" tabindex=21
     value="%EMRWEB02.02.132.1" class="Mandatory"
     onchange='validateCode(9,emvis032,trnsfsrc);'>
     <input type=text  size=15 name=trnsfsrc notab readonly
      value="%EMRWEB02.02.132.0">
     <img src="../images/SearchIcon.gif" class=Icon 
      onclick=" TransferSourceFrame(emvis032,trnsfsrc)"></td>
</span>
<span id=showMobPhoneOnly style="display:none">
  <td>
    <input type=text size=23 maxlength=20
      name=ptmsx042 title="Mobile Phone No" tabindex=13
      value="%EMRWEB02.02.085.043">
  </td>
</span>
<span id=showMobPhoneOptOut style="display:none">
  <td>
    <input type=text size=23 maxlength=20
      name=ptmsx042 class=MobilePhone title="Mobile Phone No" tabindex=13
      value="%EMRWEB02.02.085.043">
    Opt-Out SMS
    <input type=checkbox name="d_ptmsx050" id="d_ptmsx050" value="">
  </td>
</span>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=002>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%EMRWEB02.02.003">
<input type=hidden name=admissno value="%EMRWEB02.02.081">
<input type=hidden name=MenuType value="%EMRWEB02.02.088">
<input type=hidden name=emrgflag value="Y">
<input type=hidden name=nextpage value="4">
</form>
<script type="text/javascript">
function DisplayResidency() {
  i=document.UpdateForm.ptmas020.selectedIndex;
  ind=document.UpdateForm.ptmas020.options[i].value.substring(5,6)
  if (ind=="T") {
    ExpiryHeading.innerHTML=expiryhd.innerHTML;
    ExpiryDate.innerHTML=expirydate.innerHTML;
    VisaHeading.innerHTML=visahd.innerHTML;
    Visa.innerHTML=visano.innerHTML;
    CountryResidence.innerHTML=countryblank.innerHTML;
    CountryHeading.innerHTML="";
    document.UpdateForm.pmres001.value="";
  } else if (ind=="N"){
    CountryResidence.innerHTML=countryresidence.innerHTML;
    CountryHeading.innerHTML=countryheading.innerHTML;
    ExpiryDate.innerHTML=expiryblank.innerHTML;
    ExpiryHeading.innerHTML="";
    Visa.innerHTML=visablank.innerHTML;
    VisaHeading.innerHTML="";
    document.UpdateForm.pmres005.value="";
    document.UpdateForm.pmres002.value="";
    SetCategoryC_(document.UpdateForm.pmres001,"%EMRWEB02.02.478.1")
   } else if (ind=="V") {
    ExpiryHeading.innerHTML=expiryhd.innerHTML;
    ExpiryDate.innerHTML=expirydate.innerHTML;
    VisaHeading.innerHTML=visahd.innerHTML;
    Visa.innerHTML=visano.innerHTML;
    CountryResidence.innerHTML=countryresidence.innerHTML;
    CountryHeading.innerHTML=countryheading.innerHTML;
    SetCategoryC_(document.UpdateForm.pmres001,"%EMRWEB02.02.478.1")
  } else {
    ExpiryDate.innerHTML=expiryblank.innerHTML;
    ExpiryHeading.innerHTML="";
    Visa.innerHTML=visablank.innerHTML;
    VisaHeading.innerHTML="";
    document.UpdateForm.pmres005.value="";
    document.UpdateForm.pmres002.value="";
    CountryResidence.innerHTML=countryblank.innerHTML;
    CountryHeading.innerHTML="";
    document.UpdateForm.pmres001.value="";
  }
}
//
</script>
<span id=expiryhd style="display:none">
<td class=DataLabel>Expiry Date</td>
</span>
<span id=expirydate style="display:none">
    <td><input type=text size=12 name=pmres002 tabindex=32
         class="Mandatory Date" title="Expiry Date" 
        value="%EMRWEB02.02.479" onblur="checkDate(this,'Expiry Date');">
        <img notab src=../images/DateLookup.gif class=Icon
         onclick="DateLookupFrame(pmres002);">
        <img notab src=../images/DateTimeStamp.gif class=Icon 
         onclick="SetCurrentDateTime(pmres002,null);">
    </td></tr>
</span>
<span id=expiryblank style="display:none">
   <input type=hidden name=pmres002>
</span>
<span id=countryblank style="display:none">
   <input type=hidden name=pmres001>
</span>
<span id=countryheading style="display:none">
<td class=DataLabel>Country of Residence</td>
</span>
<span id=countryresidence style="display:none">
    <td><select  name="pmres001" tabindex=32 class="select120 Mandatory"
                 title="Country of Residence">
        <option></option>
        </select>
</span>
<span id=visablank style="display:none">
   <input type=hidden name=pmres005>
</span> 
<span id=visahd style="display:none">
<td class=DataLabel>Passport/Visa Number</td>
</span>
<span id=visano style="display:none">
    <td><input type=text size=12 name=pmres005 tabindex=32
         class="Mandatory" title="Passport/Visa Number" 
         value="%EMRWEB02.02.483">
    </td></tr>
</span>

<span id=idenGenLblShow style="display:none">
  <td class=DataLabel>%STANDARD.01.035.Gi</td>
</span>
<span id=idenGenDetailShow style="display:none">
  <td><select name=pmpxi125 id=pmpxi125 class=Mandatory tabindex=5
       title="%STANDARD.01.035.Gi"
       onchange="IdenGenderChange(document.UpdateForm);">
      <option></option>
       %EMRWEB02.02.086.099.063.9.2
      </select><br>
      <span id=IdenGenFreeTxt></span>
  </td>
</span>
<span id=idenGenDetailBlank style="display:none">
  <td><input type=hidden name=pmpxi125 id=pmpxi125 value=""></td>
  <td><input type=hidden name=pmpxi126 id=pmpxi126 value=""></td>
</span>
<span id=idenGenFreeTxtShow style="display:none">
  <input type=text name=pmpxi126 id=pmpxi126 size=80 maxlength=80
   class=Mandatory tabindex=5
   title="Identifying Gender Free Text"
   value="%EMRWEB02.02.086.099.065">
</span>
<span id=idenGenFreeTxtBlank style="display:none">
  <td><input type=hidden name=pmpxi126 id=pmpxi126 value=""></td>
</span>

<span id=idenProLblShow style="display:none">
  <td class=DataLabel>%STANDARD.01.035.Gp</td>
</span>
<span id=idenProDetailShow style="display:none">
  <td><select name=pmpxi127 id=pmpxi127 class=Mandatory tabindex=10
       title="%STANDARD.01.035.Gp"
       onchange="IdenPronounChange(document.UpdateForm);">
      <option></option>
       %EMRWEB02.02.086.099.064.9.2
      </select><br>
      <span id=IdenProFreeTxt></span>
  </td>
</span>
<span id=idenProDetailBlank style="display:none">
  <td><input type=hidden name=pmpxi127 id=pmpxi127 value=""></td>
  <td><input type=hidden name=pmpxi128 id=pmpxi128 value=""></td>
</span>
<span id=idenProFreeTxtShow style="display:none">
  <input type=text name=pmpxi128 id=pmpxi128 size=80 maxlength=80
   class=Mandatory tabindex=10
   title="Identifying Pronoun Free Text"
   value="%EMRWEB02.02.086.099.066">
</span>
<span id=idenProFreeTxtBlank style="display:none">
  <td><input type=hidden name=pmpxi128 id=pmpxi128 value=""></td>
</span>

<script type="text/javascript">
if (PatientALT.substr(6,1)=="1") {
alert("Warning: Patient is Deceased");
history.go(-1);
}
</script>
