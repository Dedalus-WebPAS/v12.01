<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/outweb05.js"></script>
<script type="text/javascript" src="../js/MrtLocations.js"></script>
<script type="text/javascript" src="../js/MrtMultiLocations.js"></script>
<script type="text/javascript">
function ChkStrt() {
var strttime=AddForm.timedesc.value.replace(/:/g,"")
var fintime=AddForm.othed014.value.replace(/:/g,"")
strttime=trim(strttime);
fintime=trim(fintime);
   if (strttime>fintime) {
       alert ("Booking Finish Time should be greater than Start Time");
       AddForm.othed014.value=" "
      }
}
function ChkFin() {
var endtime=AddForm.othed015.value.replace(/:/g,"")
var fintime=AddForm.othed014.value.replace(/:/g,"")
endtime=trim(endtime);
fintime=trim(fintime);
   if (fintime>endtime) {
       alert ("Booking Finish Time should be less than Session End Time");
       AddForm.othed015.value=" "
      }
}
function CheckSchedule() {
 check=document.AddForm.othed005.value.search('[^a-zA-Z0-9]');
 if (check >= 0) {
   alert("Schedule can only be alphanumeric!");
   document.AddForm.othed005.value="";
   document.AddForm.othed005.focus();
   return;
 }
}
function init() {
  if(document.AddForm.mrcntrak.value!="1") {
    document.AddForm.othed019.className="SelectBig";
  }
  switchOffMultHosp()

}
function AddHeader05() {
  if(AddForm.d_othed022.checked==true) {
    document.AddForm.othed022.value="1";
  } else {
    document.AddForm.othed022.value="0";
  }
  if(AddForm.d_othed025.checked==true) {
    document.AddForm.othed025.value="Y";
  } else {
    document.AddForm.othed025.value="N";
  }
  if(AddForm.d_othed027.checked==true) {
    document.AddForm.othed027.value="1";
  } else {
    document.AddForm.othed027.value="0";
  }
  if(AddForm.d_othed028.checked==true) {
    document.AddForm.othed028.value="1";
  } else {
    document.AddForm.othed028.value="0";
  }
  if(AddForm.d_othed030.checked==true) {
    document.AddForm.othed030.value="1";
  } else {
    document.AddForm.othed030.value="0";
  }
  if(AddForm.d_othed031.checked==true) {
    document.AddForm.othed031.value="1";
  } else {
    document.AddForm.othed031.value="0";
  }
  if(AddForm.d_othed038.checked==true) {
    document.AddForm.othed038.value="1";
  } else {
    document.AddForm.othed038.value="0";
  }
  if(AddForm.d_othed039.checked==true) {
    document.AddForm.othed039.value="1";
  } else {
    document.AddForm.othed039.value="0";
  }

 //Moves value for the additional HCP into input to store in DB
  document.AddForm.othed049.value = document.getElementById("d_othed049").value;
  document.AddForm.othed050.value = document.getElementById("d_othed050").value;
  document.AddForm.othed051.value = document.getElementById("d_othed051").value;
  document.AddForm.othed052.value = document.getElementById("d_othed052").value;

  document.AddForm.othed013.value=trim(document.AddForm.othed013.value);

  document.AddForm.othed053.value = document.getElementById("d_othed053").value;

  SubmitHiddenNew(AddForm);

}

function switchOffMultHosp() {
    var multiHospParam = document.AddForm.ibcnmhos.value;
    var othed018  = document.getElementById('othed018');
    var n_othed018  = document.getElementById('n_othed018');

    if( multiHospParam.replace(/ /g,"")  != "1" ) {
        othed018.style.display = "none";
        othed018.name = "";
        n_othed018.style.display = "none";
    }
}
function CheckAlliedHed(theform) {
  if(theform.othed024.value=="1" ||
     theform.othed024.value=="2") {
     theform.othed023.className="Mandatory"
  } else {
     theform.othed023.className=""
  }
}
function testClinicType() {
  if(isWhitespace(AddForm.othed020.value)) {
     alert("Clinic Type is mandatory for Default Procedure");
     return;
  }
  CtypeprocSearchFrame(AddForm.d_othed053,AddForm.name_othed053)
}
function testvalCtypeProc() {
  if(isWhitespace(AddForm.othed020.value)) {
     alert("Clinic Type is mandatory for Default Procedure");
     return;
  }
  valCtypeProcedure(AddForm.othed020,AddForm.d_othed053,AddForm.name_othed053);
}
function pressAdd() {
  if(!SetAutoOpenClinicsH()) {
    return;
  }
  AddHeader05();
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);SetMRTLocationHeader(AddForm);
              CheckAlliedHed(AddForm);HospitalUsingAutoOpenClinicsH();
              UsingAutoOpenClinicsH();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
%OUTWEB05.05.003 - Add Slot Template Master
</span>
<form name=AddForm method=post action=outweb05.pbl>
<input type=hidden name=reportno value="5">
<input type=hidden name=template value="004">
<input type=hidden name=updttype value="S">
<input type=hidden name=otcli001 value="%OUTWEB05.05.001">
<input type=hidden name=otmas001 value="%OUTWEB05.05.101">
<input type=hidden name=otmas002 value="%OUTWEB05.05.102">
<input type=hidden name=othed001 value="%STANDARD.01.023">
<input type=hidden name=othed002 value="%OUTWEB05.05.001">
<input type=hidden name=othed003 value="%OUTWEB05.05.101">
<input type=hidden name=othed004 value="%OUTWEB05.05.102">
<input type=hidden name=mrcntrak value="%STANDARD.01.025.097.161.0.1">
<input type=hidden name=othed022 value="">
<input type=hidden name=othed025 value="">
<input type=hidden name=othed027 value="">
<input type=hidden name=othed028 value="">
<input type=hidden name=othed030 value="">
<input type=hidden name=othed038 value="">
<input type=hidden name=othed039 value="">
<input type=hidden name=othed031 value="">
<input type=hidden name=othed049 value="">
<input type=hidden name=othed050 value="">
<input type=hidden name=othed051 value="">
<input type=hidden name=othed052 value="">
<input type=hidden name=othed053 value="">
<input type=hidden name="otcnautc" id="otcnautc"
 value="%STANDARD.01.045.OTCNAUTC">
<input type=hidden name="otcnautw" id="otcnautw"
 value="%STANDARD.01.045.OTCNAUTW">
<input type=hidden name="othed045" id="othed045" value="%OUTWEB05.05.194">
<input type=hidden name="d_othed046" id="d_othed046"
 value="%OUTWEB05.05.195">
<input type=hidden name="othed047" id="othed047"
 value="%OUTWEB05.05.196">
<input type=hidden name=ibcnmhos id="ibcnmhos" 
 value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=d_othed019 value="%OUTWEB05.05.164">
<input type=hidden name=dummy value="">

<table align=center width=95% border=0>
<tr valign="top"><td>

<!-- left hand column only -->

  <table align="center" width="100%" border="0">

<tr><td class=DataLabel>Day of Week</td>
    <td><input type=text name="daydesc1" class=Readonly
         title="Day of week" tabindex=-1
         size=10 readonly value="%OUTWEB05.05.156" ></td>
    </tr>

<tr><td class=DataLabel>Schedule</td>
    <td><input type=text name=othed005 title="Schedule" size=4
         maxlength=2 class=Mandatory
         onblur="CheckSchedule();">
        </td>
    </tr>

<tr><td class=DataLabel>Date Clinic Opened</td>
    <td><input type=text size=12 maxlength=8 name=othed006
        title="Date clinic Opened" class=Mandatory>
    <img src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(AddForm.othed006,null);">
    <img src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(AddForm.othed006);">
        </td>
    </tr>

<tr><td class=DataLabel>Comments</td>
    <td><input type=text name=othed008 title="Comments" size=40
         maxlength=40
        value="%OUTWEB05.05.109"></td>
    </tr>

<tr><td class=DataLabel></td>
    <td><input type=text name=othed009 size=40 maxlength=40
      value="%OUTWEB05.05.110"></td>
    </tr>

<tr><td class=DataLabel>Slot Time Allocated</td>
 <td class=DataLabel><input type=text name=othed013 class="Mandatory Integer"
     title="Slot time Allocated" size=3 maxlength=3 min="1"
     value="%OUTWEB05.05.111"> mins</td>
    </tr>

<tr><td class=DataLabel>Bookings Finish Time</td>
    <td><input type=text size=8 maxlength=5   name=othed014
         class=Mandatory
         title="Booking Finish Time" value="%OUTWEB05.05.103" onblur=ChkStrt()>
        <img src=../images/TimeLookup.gif class="Icon"
          onclick="TimeLookupFrame(AddForm.othed014);"></td>
    </tr>

<tr><td class=DataLabel>End of Session Time</td>
    <td><input type=text size=8 name=othed015 class=Mandatory
         title="End of Session Time" maxlength=5 value="%OUTWEB05.05.104"
         onblur=ChkFin()>
        <img src=../images/TimeLookup.gif class="Icon"
          onclick="TimeLookupFrame(AddForm.othed015);"></td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.CT</td>
    <td><select name=othed016 class=Mandatory title="%STANDARD.01.017.CT">
         <option></option>
         %OUTWEB05.05.137.2
         </select></td>
    </tr>

<tr><td class=DataLabel>Clinic Phone Number</td>
    <td><input type=text name=othed032  tabindex=9
         title="Clinic Phone Number"
         size=22 maxlength=20 value="%OUTWEB05.05.182"></td>
    </tr>

<tr><td class=DataLabel>MR Location</td>
    <td><select name=othed019 class="Mandatory SelectBig"
         title="MR Location">
         <option></option>
         </select></td>
    </tr>

<tr><td class=DataLabel>Exclude from Pulling List</td>
    <td><input type=checkbox name=d_othed038 title="Exclude from Pulling List"
         value=1></td>
    </tr>

<tr><td class=DataLabel>Referral Management Department</td>
    <td><select name=othed023  title="Referral Management Department"
         onclick="CheckAlliedHed(document.AddForm);">
         <option></option>
         %OUTWEB05.05.175
         </select></td>
    </tr>

<tr><td class=DataLabel>Enter Doctor Code</td>
    <td><input type=checkbox name=d_othed025 title="Enter Doctor Code" value=Y>
    </td>
    </tr>

<tr><td class=DataLabel>Collect Carer Details</td>
    <td><input type=checkbox name=d_othed027 title="Collect Carer Details"
         value=1></td>
    </tr>

<tr><td class=DataLabel>No. of Days Prior to Send Letter</td>
    <td><input type=text name=othed029 title="No. of Days Prior to Send Letter"
         size=4 maxlength=3 class="Integer" value="">
    </td>
    </tr>

<tr><td class=DataLabel>Using Check in Page</td>
     <td><input type=checkbox name=d_othed031 title="Usinf Check in Page"
         value=1></td>
    </tr>

<tr>
  <td class=DataLabel>Default Procedure</td>
  <td><input type=text name=d_othed053 title="Default Procedure" value="%OUTWEB05.05.199.013.0"
       size=9 maxlength=9 id=d_othed053 onblur="testvalCtypeProc();"> 
      <input type=text name=name_othed053 id=name_othed053 title="Default Procedure"
       readonly class=Readonly size=35 maxlength=35 value="%OUTWEB05.05.199.013.1">
      <img src=../images/LookupIcon.gif class=Icon
         onclick="testClinicType();"></td></tr>

<tr><td class=DataLabel>Last Session Date Opened</td>
    <td class=DataField></td>
    </tr>

<tr><td class=DataLabel><div id="AutoOpenL"></div></td>
    <td><div id="AutoOpenF"></div></td>
    </tr>

<tr><td class=DataLabel><div id="AutoOpenFreqL"></div></td>
    <td colspan=2><div id="AutoOpenFreqF"></div></td>
    </tr>

<tr><td class=DataLabel><div id="AutoOpenWeekL"></div></td>
    <td><div id="AutoOpenWeekF"></div></td>
    </tr>

</table></td>
 
<!-- right hand column -->

<td><table align="center" width="100%" border="0">

<tr><td class=DataLabel>Clinic Id</td>
    <td><input type=text name=clindesc class=Readonly
         title="Clinic" tabindex=-1
         size=8 readonly value="%OUTWEB05.05.001"></td>
    </tr>

<tr><td class=DataLabel>Start Time</td>
    <td><input type=text name=timedesc class=Readonly
         title="Start Time" tabindex=-1
         size=8 readonly value="%OUTWEB05.05.102"></td>

       </tr>

<tr><td class=DataLabel>Date Clinic Closed</td>
    <td><input type=text size=12 maxlength=8 name=othed007
        title="Date Clinic Closed">
    <img src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(AddForm.othed007,null);">
    <img src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(AddForm.othed007);">
    </td></tr>

<tr><td class=DataLabel>Instructions</td>
    <td><input type=text size=40  maxlength=40
         name=othed010 title="Instructions"
         value="%OUTWEB05.05.160"></td></tr>

<tr><td class=DataLabel></td>
    <td><input type=text name=othed011 size=40 maxlength=40
      value="%OUTWEB05.05.161"></td></tr>

<tr><td class=DataLabel></td>
    <td><input type=text size=40 maxlength=40
         name=othed012 title="Instructions"
         value="%OUTWEB05.05.162"></td></tr>

<tr><td>Allow Group Bookings</td>
    <td><input type=checkbox title="Allow Group Bookings"
         value=1 name=d_othed022></td></tr>

<tr><td class=DataLabel>Clinic Type</td>
    <td><select name=othed020  class="Mandatory SelectBig"
         title="Clinic Type">
         <option></option>
         %OUTWEB05.05.105.3
         </select></td>
    </tr>

<tr><td class=DataLabel>Clinic Indicator</td>
    <td><select name=othed021 class="Mandatory SelectBig"
        title="Clinic Indicator">
        <option></option>
        %OUTWEB05.05.106.2
        </select></td>
    </tr>

<tr><td class=DataLabel id=n_othed018>Hospital</td>
    <td><select name=othed018 id=othed018 class="Mandatory SelectBig"
         title="Hospital" onchange="SetMRTLocationHeader(AddForm);
                                    HospitalUsingAutoOpenClinicsH(this);">
         <option></option>
         %OUTWEB05.05.133.2
         </select></td></tr>

<tr><td class=DataLabel>Collect Contact Details</td>
    <td><select name=othed024 title="Collect Contact Details"
         onchange="CheckAlliedHed(document.AddForm);">
         <option value="0">No</option>
         <option value="1">Yes</option>
         <option value="2">Yes plus DNA</option>
         </select></td>
    </tr>

<tr><td class=DataLabel>Default Doctor</td>
    <td><input type=text name=othed026 title="Default Doctor" size=6 maxlength=6
         value="%OUTWEB05.05.122"
         onblur=validateCode(3,AddForm.othed026,AddForm.name_othed026);>
       <input type=text name=name_othed026 class=Readonly readonly
        title="Default Doctor" size=20 maxlength=30 value="%OUTWEB05.05.153">
       <img src="../images/SearchIcon.gif" class="Icon"
       onclick="DoctorSearchFrame(AddForm.othed026,AddForm.name_othed026);">
       <img src="../images/erase.gif" class="Icon"
       onclick="clrDoc(AddForm.othed026,AddForm.name_othed026);">
    </td></tr>

<tr><td>Collect Transport Details</td>
    <td><input type=checkbox name=d_othed028 title="Collect Transport Details"
         value=1></td>
    </tr>

<tr><td class=DataLabel>Confirm PMI Details</td>
     <td><input type=checkbox name=d_othed030 title="Confirm PMI Details"
         value=1></td>
    </tr>

<tr><td class=DataLabel>Referral Mandatory</td>
    <td><input type=checkbox name=d_othed039 title="Referral Mandatory"
         value=1></td>
    </tr>

<tr><td class=DataLabel>Additional HCP</td>
<td class=DataField><input type=checkbox name=addHCPprov
    title="Additional HCP Providers" id=addHCPprov
    onclick="displayAddHCP(this.checked)"></td>
</tr>

<tr>
   <td class=DataLabel><div id=addhcphead01label></div></td>
   <td class=DataField><div id=addhcphead01></div></td>
</tr>
<tr>
   <td class=DataLabel><div id=addhcphead02label></div></td>
   <td class=DataField><div id=addhcphead02></div></td>
</tr>
<tr>
   <td class=DataLabel><div id=addhcphead03label></div></td>
   <td class=DataField><div id=addhcphead03></div></td>
</tr>
<tr>
   <td class=DataLabel><div id=addhcphead04label></div></td>
   <td class=DataField><div id=addhcphead04></div></td>
</tr>

   </table></td>
   </tr>

<!-- end right column -->

<tr><td colspan=4 align=center><br>
    <input type=button value="Add" class="button"
    id="out05sub" onclick="tempDisable(this);pressAdd();">
    <input type=button value="Cancel" class="button"
     onclick=DFrameExitRefresh();>
    </td></tr>
</table>
</form>

<div id="ShowAutoOpenL" style="display:none">
Auto Open Clinic
</div>

<div id="ShowAutoOpenF" style="display:none">
<input type=checkbox name="d_othed045" id="d_othed045"
 tabindex=116 title="Auto Open Clinic" value=1
 onclick="EnableAutoOpenClinicsFieldsH();">
</div>

<div id="ClearAutoOpenF" style="display:none">
<input type=hidden name="othed045" id="othed045" value="">
<input type=hidden name="othed048" id="othed048" value="">
</div>

<div id="ShowAutoOpenFreqL" style="display:none">
Frequency
</div>
<div id="ShowAutoOpenFreqF" style="display:none">
<select name="othed046" id="othed046" class="SelectBig" tabindex=117
 title="Frequency"
 disabled onchange="EnableAutoOpenClinicsFieldsH();">
<option value=" "></option>
<option value="1">Weekly</option>
<option value="2">2 Weekly</option>
<option value="4">4 Weekly</option>
</select>
&nbsp;
Week of Month
&nbsp;
<input type=checkbox name="1_othed047" id="1_othed047" disabled
 tabindex=118 title="Auto Open Week of month 1" value=1>

<input type=checkbox name="2_othed047" id="2_othed047" disabled
 tabindex=119 title="Auto Open Week of month 2" value=1>

<input type=checkbox name="3_othed047" id="3_othed047" disabled
 tabindex=120 title="Auto Open Week of month 3" value=1>

<input type=checkbox name="4_othed047" id="4_othed047" disabled
 tabindex=121 title="Auto Open Week of month 4" value=1>

<input type=checkbox name="5_othed047" id="5_othed047" disabled
 tabindex=122 title="Auto Open Week of month 5" value=1>
</div>

<div id="ShowAutoOpenWeekL" style="display:none">
No. weeks in advance to open
</div>
<div id="ShowAutoOpenWeekF" style="display:none">
<input type=text name=othed048 id=othed048 title="No. weeks in advance to open"
 tabindex=105 size=4 maxlength=3 class="Integer Readonly" readonly
 value="%OUTWEB05.05.197">
</div>

<span id=addHCPSlotslabel01 style="display:none">
  <td class=DataLabel>Additional HCP 1</td>
</span>
<span id=addHCPSlots01 style="display:none">
  <td><input type=text name=d_othed049 title="Additional HCP 1" size=6
             maxlength=6 id=d_othed049
             onblur=validateCode(3,AddForm.d_othed049,AddForm.name_othed049);>
  </td>
  <td><input type=text name=name_othed049 title="Additional HCP 1" size=20
             id=name_othed049 maxlength=30 class=Readonly readonly>
  <img src="../images/SearchIcon.gif" class="Icon"
     onclick="DoctorSearchFrame(AddForm.d_othed049,AddForm.name_othed049);">
  <img src="../images/erase.gif" class="Icon"
       onclick="clrDoc(AddForm.d_othed049,AddForm.name_othed049);"></td>
</span>

<span id=addHCPSlotslabel02 style="display:none">
  <td class=DataLabel>Additional HCP 2</td>
</span>
<span id=addHCPSlots02 style="display:none">
  <td><input type=text name=d_othed050 title="Additional HCP 2" size=6
             maxlength=6 id=d_othed050
             onblur=validateCode(3,AddForm.d_othed050,AddForm.name_othed050);>
  </td>
  <td><input type=text name=name_othed050 title="Additional HCP 2" size=20
             id=name_othed050 maxlength=30 class=Readonly readonly>
  <img src="../images/SearchIcon.gif" class="Icon"
     onclick="DoctorSearchFrame(AddForm.d_othed050,AddForm.name_othed050);">
  <img src="../images/erase.gif" class="Icon"
       onclick="clrDoc(AddForm.d_othed050,AddForm.name_othed050);"></td>
</span>

<span id=addHCPSlotslabel03 style="display:none">
  <td class=DataLabel>Additional HCP 3</td>
</span>
<span id=addHCPSlots03 style="display:none">
  <td><input type=text name=d_othed051 title="Additional HCP 3" size=6
             maxlength=6 id=d_othed051
             onblur=validateCode(3,AddForm.d_othed051,AddForm.name_othed051);>
  </td>
  <td><input type=text name=name_othed051 title="Additional HCP 3" size=20
             id=name_othed051 maxlength=30 class=Readonly readonly>
  <img src="../images/SearchIcon.gif" class="Icon"
     onclick="DoctorSearchFrame(AddForm.d_othed051,AddForm.name_othed051);">
  <img src="../images/erase.gif" class="Icon"
       onclick="clrDoc(AddForm.d_othed051,AddForm.name_othed051);"></td>
</span>

<span id=addHCPSlotslabel04 style="display:none">
  <td class=DataLabel>Additional HCP 4</td>
</span>
<span id=addHCPSlots04 style="display:none">
  <td><input type=text name=d_othed052 title="Additional HCP 4" size=6
             maxlength=6 id=d_othed052
             onblur=validateCode(3,AddForm.d_othed052,AddForm.name_othed052);>
  </td>
  <td><input type=text name=name_othed052 title="Additional HCP 2" size=20
             id=name_othed052 maxlength=30 class=Readonly readonly>
  <img src="../images/SearchIcon.gif" class="Icon"
     onclick="DoctorSearchFrame(AddForm.d_othed052,AddForm.name_othed059);">
  <img src="../images/erase.gif" class="Icon"
       onclick="clrDoc(AddForm.d_othed052,AddForm.name_othed052);"></td>
</span>

<span id=addHCPSlotsBlank style="display:none">
</span>

<script type="text/javascript">
  for (var i=0; i < document.AddForm.othed024.length; i++) {
    if (document.AddForm.othed024.options[i].value=="%OUTWEB05.05.176"){
        document.AddForm.othed024.selectedIndex=i;
    }
  }
 EnterDoc="%OUTWEB05.05.108"
 if(EnterDoc == "Y") {
   document.AddForm.d_othed025.checked=true;
 }
 CollectCar="%OUTWEB05.05.177"
 if(CollectCar == "1") {
   document.AddForm.d_othed027.checked=true;
 }
 CollectTrns="%OUTWEB05.05.178"
 if(CollectTrns == "1") {
   document.AddForm.d_othed028.checked=true;
 }
 if(document.AddForm.ibcnmhos.value!="1") {
   document.AddForm.othed018.className="SelectBig"
 }
 ConfPMI="%OUTWEB05.05.180"
 if(ConfPMI == "1") {
   document.AddForm.d_othed030.checked=true;
 }
 UsingCPage="%OUTWEB05.05.181"
 if(UsingCPage == "1") {
   document.AddForm.d_othed031.checked=true;
 }
 XPull="%OUTWEB05.05.188";
 if (XPull == "1") {
   document.AddForm.d_othed038.checked=true;
 }
 MRef="%OUTWEB05.05.189";
 if (MRef == "1") {
   document.AddForm.d_othed039.checked=true;
 }

 //Loads data regarding addition HCPs and displays if present
 loadAddHCP("%OUTWEB05.05.199.002","othed049");
 loadAddHCP("%OUTWEB05.05.199.003","othed050");
 loadAddHCP("%OUTWEB05.05.199.004","othed051");
 loadAddHCP("%OUTWEB05.05.199.005","othed052");

//  //Moves value for the Default Procedure to input to store in DB
  if(document.AddForm.d_othed053!=undefined) {
      document.AddForm.othed053.value =
         document.getElementById("d_othed053").value;
  }

</script>
