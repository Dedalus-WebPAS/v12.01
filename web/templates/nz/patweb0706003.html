<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<link rel="stylesheet" href="../html/postcode.css" type="text/css">
<script type="text/javascript" src=../js/IBA_Category_C_.js>  </script>
<script type="text/javascript" src=../js/patweb0706.js>  </script>
<script  type="text/javascript">
function defaultValues(){
  p=document.UpdateForm;
  p.pmcex007.value=trim(p.padd1.value);
  p.pmcex008.value=trim(p.padd2.value);
  p.pmcex009.value=trim(p.padd3.value);

  //Removes Domicile from the address and places it in postcode field
  address = removePostCode(p.padd4.value);
  p.pmcex011.value=trim(address[0]);
  p.pmcex012.value=trim(p.ptelep.value);
  p.d_pmcex010.value=address[1];
}

function submitUpdContact() {

  //Checks if the browser is IE
  if (window.document.documentMode == null){
    
    //if not, checks to see if the mobile phone is valid. 
    if(!checkMobilePhone(document.getElementById("pmcex014"))) {

      return;
    }
  }

  p=document.UpdateForm;
  p.pmcex017.value="0";
  if(p.d_pmcex017.checked==true){
    p.pmcex017.value="1";
  }
  p.pmcex018.value="0";
  if(p.d_pmcex018.checked==true){
    p.pmcex018.value="1";
  }
  p.pmcex010.value=p.d_pmcex010.value;
  
  SetSendSMS();

  ValidateContactTypeUpd(p.pmcex001,p.pmcex002,p.pmcex003,p.pmcex018,
    PostUpdContact);
}

function PostUpdContact(){
  setFormactn('U');
}
function showSendSmsDet() {
  if(document.getElementById("ptcnsmsn").value == "1") {
    document.getElementById("ssmslabel").innerHTML="Send SMS";
    if(document.getElementById('pmcex026').value=="1") {
      document.getElementById('d_pmcex022').checked=true;
    }
    mobPhoneField.innerHTML = mobPhoneSendSms.innerHTML;
  }
  else {
    document.getElementById("ssmsfield").innerHTML="";
    mobPhoneField.innerHTML = mobPhoneNoSendSms.innerHTML;
  }
 mobPhChildElement = mobPhoneField.firstElementChild; 

 if(mobPhChildElement == null){

   mobPhChildElement = mobPhoneField.children[0];

 }

 mobPhChildElement.setAttribute("id", "pmcex014");
 mobPhChildElement.value = mobPhChildElement.value.replace(/\s*$/,"");
}
function SetSendSMS() {
  if(document.getElementById("ptcnsmsn").value == "1") {
    if(document.getElementById('d_pmcex022').checked==true) {
      document.getElementById('pmcex026').value="1";
    } else {
      document.getElementById('pmcex026').value="0";
    }
  }
}

</script>
</head>

%START.OF.PAGE
<body onload="PageLoad(event);ContactMandatory(UpdateForm);
              showSendSmsDet();setMandatoryMobPho();setMandTitle(UpdateForm);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
Update Contact
</span>

<div id=PageBodySection>
<form name=UpdateForm method=post action=patweb07.pbl style="margin:0">
<input type=hidden name=reportno value="6">
<input type=hidden name=template value="002">
<input type=hidden name=urnumber value="%PATWEB07.06.003">
<input type=hidden name=updttype value="">
<input type=hidden name=pmcex001 value="%PATWEB07.06.101">
<input type=hidden name=pmcex002 id=pmcex002 value="%PATWEB07.06.102.3">
<input type=hidden name=pmcex003 value="%PATWEB07.06.103">
<input type=hidden name=pmcex010 value="%PATWEB07.06.110">
<input type=hidden name=oldpcode value="%PATWEB07.06.111">
<input type=hidden name=padd1 value="%PATWEB07.06.012">
<input type=hidden name=padd2 value="%PATWEB07.06.013">
<input type=hidden name=padd3 value="%PATWEB07.06.014">
<input type=hidden name=padd4 value="%PATWEB07.06.015">
<input type=hidden name=ppost value="%PATWEB07.06.016">
<input type=hidden name=ptelep value="%PATWEB07.06.017">
<input type=hidden name=ptelem value="%PATWEB07.06.114">
<input type=hidden name=ptcnsmsn id=ptcnsmsn
       value="%STANDARD.01.025.120.243.0.1">
<input type=hidden name=pmcex026 id=pmcex026
       value="%PATWEB07.06.140">
<input type=hidden name=cat_tc value="tc">
<input type=hidden name=dummy value="">
<input type=hidden name=d_relation value="">

<table align=center width=90% border=0>
<tr><td class=DataLabel>Contact Type</td>
    <td><input type=text name=d_pmcex002  title="Contact Type"
        value="%PATWEB07.06.102.0" class=Readonly readonly>
        </td>
    <td class=DataLabel>Relationship</td>
    <td><select name=pmcex015 title="Relationship" tabindex=20>
        <option value=""></option>
         %STANDARD.01.030
        </select></td>
    </tr>

<tr><td class=DataLabel>Title</td>
    <td><select title="Title" name=pmcex004 id=pmcex004 tabindex=2>
        <option></option>
        %STANDARD.01.029
        </select></td>  
    <td class=DataLabel>Home Phone</td>
    <td><input type=text name=pmcex012 title="Home Ph" size=22
         maxlength=20 tabindex=21 value="%PATWEB07.06.112"></td>
    </tr>

<tr><td class=DataLabel>Surname</td>
    <td><input type=text name=pmcex005 title="Surname" 
         size=37 maxlength=35 tabindex=3 value="%PATWEB07.06.105"
         onchange="UpCase(this);">
    </td>
    <td class=DataLabel>Work Phone</td>
    <td><input type=text name=pmcex013 title="Work Ph" size=22
         maxlength=20 tabindex=22 value="%PATWEB07.06.113"></td>
    </tr>

<tr><td class=DataLabel>Given Name</td>
    <td><input type=text name=pmcex006 title="Given Name"
         size=37 maxlength=35 tabindex=4 value="%PATWEB07.06.106"
         onchange="UpCase(this);">
    </td>
    <td class=DataLabel>Mobile Phone</td>
    <td><div id=mobPhoneField></div></td>
</tr>

<tr><td class=DataLabel>Second Given Name</td>
    <td><input type=text name=pmcex019 title="Second Given Name"
         size=37 maxlength=35 tabindex=5 value="%PATWEB07.06.120"
         onchange="UpCase(this);">
    </td>
    <td class=DataLabel>Email</td>
    <td><input type=text name=pmcex016 title="Email" size=30
         maxlength=80 tabindex=24 value="%PATWEB07.06.116"></td>
    </tr>

<tr><td class=DataLabel>Address Line 1</td>
    <td><input type=text size=37 maxlength=35 tabindex=6
        name=pmcex007 title="Address Line 1" value="%PATWEB07.06.107"
        onchange="UpCase(this);"></td>
    <td class=DataLabel>Send Letter
    <input type=hidden name=pmcex017></td>
    <td><input type=checkbox name=d_pmcex017 value="1" tabindex=25></td>
    </tr>

<tr><td class=DataLabel>Address Line 2</td>
    <td><input type=text size=37 maxlength=35 tabindex=7
        name=pmcex008 title="Address Line 2" value="%PATWEB07.06.108"
        onchange="UpCase(this);"></td>
    <td id="ssmslabel" class="DataLabel">&nbsp;</td>
    <td id="ssmsfield">
      <input type=checkbox name="d_pmcex022" id="d_pmcex022" tabindex=25 
	onclick="setMandatoryMobPho()" value="">
    </td>
</tr>

<tr><td class=DataLabel>Suburb</td>
    <td><input type=text size=37 maxlength=35
       name=pmcex009 title="Address Line 3" tabindex=8 value="%PATWEB07.06.109"
       onblur="UpCase(this)"></td>
    <td class=DataLabel>Inactive
    <input type=hidden name=pmcex018></td>
    <td><input type=checkbox name=d_pmcex018 value="1" tabindex=26
         onclick="InactiveDate(UpdateForm);"></td>
    <tr>

<tr><td class=DataLabel>Town/City/Country</td>
    <td><input type=text size=37 maxlength=35
         name=d_pmcex010 title="Address Line 4" tabindex=9 
         onblur="UpCase(this)" value="%PATWEB07.06.110">
    </td>
    <td class=DataLabel>Date Inactive</td>
    <td><input type=text name=pmcex021 size=12 tabindex=27
     onblur="checkDate(this,'Date')" value="%PATWEB07.06.128"
     class="PastDate" title="Date Inactivate">
    <img src=../images/DateTimeStamp.gif class=Icon
     date=UpdateForm.pmcex021 time=null>
    <img src=../images/DateLookup.gif class=Icon
     date=UpdateForm.pmcex021>
    </td>
</tr>

<tr><td class=DataLabel>Post Code</td>
    <td><input type=text size=6 maxlength=8 tabindex=10
        name=pmcex011 title="Post Code" value="%PATWEB07.06.111"
        onblur="UpCase(this)">
    </td>
</tr>

<tr><td class=DataLabel>Created By</td>
    <td>%PATWEB07.06.123 %PATWEB07.06.121 %PATWEB07.06.122</td>
    <td class=DataLabel>Updated By</td>
    <td>%PATWEB07.06.126 %PATWEB07.06.124 %PATWEB07.06.125</td>
    </tr>

<tr><td colspan=4 align=center><br>
   <input type=button value="Update" class="button" tabindex=30
    onclick="submitUpdContact();">&nbsp;
   <input type=button value="Copy Patients Address" class="Largebutton"
    tabindex=31 onclick="defaultValues();">&nbsp;
   <input type=button value="Cancel" class="button" tabindex=32
    onclick="DFrameCloseRefresh();"><br>
   <input type=button value="Delete" class="button" tabindex=33
    onclick="setFormactn('D');">
   </td>
</tr>
</table>
</form>
</div>

<span id=mobPhoneSendSms style="display:none">
  <input type=text name=pmcex014 title="Mobile Ph" size=22
    class=MobilePhone maxlength=20 tabindex=23
    value="%PATWEB07.06.114">
</span>
<span id=mobPhoneNoSendSms style="display:none">
  <input type=text name=pmcex014 title="Mobile Ph" size=22
    maxlength=20 tabindex=23
    value="%PATWEB07.06.114">
</span>

<script type="text/javascript">
  
 sendletter="%PATWEB07.06.117";
 if ( sendletter == "1") {
   document.UpdateForm.d_pmcex017.checked=1;
 }
 inactive="%PATWEB07.06.118";
 if ( inactive == "1") {
   document.UpdateForm.d_pmcex018.checked=1;
 }
 InactiveDate(UpdateForm);

 Relationship="%PATWEB07.06.115";
 for (var i =0 ; i < document.UpdateForm.pmcex015.length; i++) {
  if (document.UpdateForm.pmcex015.options[i].value==Relationship.substr(0,10)){
    document.UpdateForm.pmcex015.selectedIndex=i } 
 }

 Title="%PATWEB07.06.104";
 for (var i =0 ; i < document.UpdateForm.pmcex004.length; i++) {
  if (document.UpdateForm.pmcex004.options[i].value==Title.substr(0,4)){
    document.UpdateForm.pmcex004.selectedIndex=i } 
 }
</script>

