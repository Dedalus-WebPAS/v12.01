<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
//
// Columns Available
//  0 - HTML Link
//  1 - Admission Number
//  2 - Admission Date/Time
//  3 - Patient Name
//  4 - Details text
//  5 - Details icon link
//  6 - Event Type
//  7 - Local ID
//  8 - Status string
//  9 - Status code
// 10 - Status link
// 11 - Diag No.
// 12 - LS Code
// 13 - LS Date
// 14 - Error Count Index
// 15 - Error Number
// 16 - Error/Warning Text
//---------------------------------------------------------------------------
function InitTable(TableView) {
  document.title="NMDS Detail Transmissions";

  switch (TableView) {
    case 0: {
      t = new Table(1,0,2,"100%","center",35,35);
      t.addColumn("Admis No.","String",1,1,"left","PatientFolder.gif","0",35)
      t.addColumn("Admis Date/Time","String",2,2,"left","","",50)
      t.addColumn("Patient","String",3,3,"left","","",100)
      t.addColumn("Details","String",4,4,"center","OPSessionIconSm.gif","5",25)
      t.addColumn("Event Type","String",6,6,"center","","",30)
      t.addColumn("Local ID","String",7,7,"center","","",30)
      t.addColumn("Processing Status","String",8,8,"left","MaintenanceIcon1.gif","10",45)
      t.addColumn("Diag No","String",11,11,"center","","",20)
      t.addColumn("LS Code","String",12,12,"center","","",20)
      t.addColumn("LS Date","DateTime",13,13,"center","","",40)
      t.addColumn("Err Count","String",14,14,"center","","",25)
      t.addColumn("Err Number","String",15,15,"center","","",30)
      t.addColumn("Errors/Warnings Text","String",16,16,"left","","",45)
      AddTableRows()
      TableOutput(0,1);    // Order Column,Asc Dsc
      break; 
    }
  }
}

function RefreshPage() {
  document.SelectPeriod.submit();
}

function ReturnToList() {
  document.PatientLinks.action="nhiweb95.pbl";
  document.PatientLinks.reportno.value="1";
  document.PatientLinks.template.value="001";
  document.PatientLinks.filtrdhb.value=document.SelectPeriod.filtrdhb.value;
  document.PatientLinks.submit();
}

function LinkPatient(URno,Admno) {
  if (URno == undefined || Admno == undefined)
    return;

  document.PatientLinks.action="patweb98.pbl";
  document.PatientLinks.reportno.value="1";
  document.PatientLinks.template.value="002";
  document.PatientLinks.urnumber.value=URno;
  document.PatientLinks.admissno.value=Admno;

  var sFilterVal = (document.SelectPeriod.filtstat.value == " ")?"+":document.SelectPeriod.filtstat.value;

  var sCookieName = "NMDSListPath-" + trim(Admno.replace(/\+/g," "));
  var sReturnURL = "nhiweb95.pbl?reportno=2&template=001" +
    "&recrdkey=" + document.SelectPeriod.recrdkey.value +
    "&filtstat=" + sFilterVal +
    "&filtrdhb=" + document.SelectPeriod.filtrdhb.value;

  SetCookie(sCookieName,sReturnURL);
  saveScrollPosition();
  document.PatientLinks.submit();
}

function LinkStatus(RecordKey) {
  if (isWhitespace(RecordKey))
    return;

  var sURL = "nhiweb95.pbl?reportno=2&template=100&nmdrecky=" + RecordKey;

  Top = (document.body.clientHeight-300)/2;
  Left = (document.body.clientWidth-500)/2;

  saveScrollPosition();
  DFrameLink(sURL,Top,Left,500,300);
}

function LinkDetails(RecordKey) {
  if (isWhitespace(RecordKey)) {
    alert("No record key specified");
    return;
  }

  var sURL = "nhiweb95.pbl?reportno=2&template=101&nmdrecky=" + RecordKey;

  Top = (document.body.scrollTop+150);
  Left = (document.body.clientWidth-750)/2;

  DFrameLink(sURL,Top,Left,750,140);
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);self.focus();InitTable(0);getScrollPosition();">

<form name=SelectPeriod action=nhiweb95.pbl method=get style="margin:0">
<input type=hidden name=reportno value="2">
<input type=hidden name=template value="001">
<input type=hidden name=updttype value=" ">
<input type=hidden name=recrdkey value="%NHIWEB95.02.108">
<input type=hidden name=filtrdhb value="%NHIWEB95.02.104">

<div id=HeadingSection>
<table width="100%" cellpadding=0 cellspacing=0 border=1 bgcolor=#CCCCCC>
<tr>
  <td width=20% class=HeadingCell align=center>Status&nbsp;
    <select name=filtstat onchange="RefreshPage();">
      <option value=" ">All</option>
      <option value="1">Sent</option>
      <option value="2">Error</option>
      <option value="3">Accepted</option>
      <option value="4">Corrected</option>
      <option value="5">File Failure</option>
      <option value="6">Cancelled</option>
      <option value="7">Error and Corrected</option>
    </select>
  </td>
  <td width="70%" class=HeadingCell style="text-align:center">
    NMDS Transmission File - Id. '%NHIWEB95.02.106.ndm'&nbsp;&nbsp;&nbsp;&nbsp;
    Status - %NHIWEB95.02.107.1 
  </td>
  <td class=HeadingCell align=center>
    <input name="btnReturn" type=button class="button" value="Return"
     onclick="ReturnToList();">
  </td>
</tr>
</table>
</div>

<div id=TableLocation></div>

</form>

<script type="text/javascript">
function AddTableRows() {
  %NHIWEB95.02.109
}

var filtStatus = "%NHIWEB95.02.103";
if (!isWhitespace(filtStatus)) {
  for (var i = 0; i < document.SelectPeriod.filtstat.length; i++) {
    if (document.SelectPeriod.filtstat.options[i].value == filtStatus) {
      document.SelectPeriod.filtstat.selectedIndex = i;
    }
  }
}
</script>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value="">
<input type=hidden name=template value="">
<input type=hidden name=urnumber value="">
<input type=hidden name=admissno value="">
<input type=hidden name=filtrdhb value="">
<input type=hidden name=MenuType value="%NHIWEB95.02.088">
</form>

