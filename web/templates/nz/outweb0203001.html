<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="nz">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true"> 
<style type=text/css>
 pre {
 font-family: arial;
 }
</style>
<script type="text/javascript" src="../js/UltraGenda.js"> </script>
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript">
function selectActions() {
  if(document.getElementById('rsch').selected) {
    if(document.PatientLinks.bokstat.value=="4") {
      alert("Error: Appointment has been Attended");
      document.getElementById('viewlink').selectedIndex=0;
      return;
    }
    if(document.PatientLinks.bokstat.value=="5") {
      alert("Error: Appointment has been Non-Attended");
      document.getElementById('viewlink').selectedIndex=0;
      return;
    }
  }
  PMenuLinkTo(document.getElementById('viewlink'));
}

function AttendScreen() {
  if(!isWhitespace(PatientLinks.alrevisn.value) && 
     PatientLinks.othecenc.value=="1"){
     if(isWhitespace(PatientLinks.alenenct.value)) {
       //RemoteTimeSeen();
       SetCookie("TimeSeenOnlyCookieMO","");
       linkUrl="allweb03.pbl?reportno=13&template=001" +
               "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
               "&admissno=" + PatientLinks.alrevisn.value.replace(/ /g,"+") +
               "&deptcode=" + PatientLinks.alredept.value.replace(/ /g,"+") +
               "&bulkenck=" + PatientLinks.alrevisn.value.replace(/ /g,"+") +
                              PatientLinks.admissno.value.replace(/ /g,"+") +
               "&shwupdat=1";
       Left=(document.body.clientWidth-900)/2;
       DFrameLink(linkUrl,0,Left,930,550);
     } else {
        if(confirm("Linked contacts exist for this appointment.\n" +
                   "OK to enter additional contacts, Cancel to abort")) {
           //RemoteTimeSeen();
           linkUrl="allweb03.pbl?reportno=1&template=009" +
                  "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
                  "&admissno=" + PatientLinks.alrevisn.value.replace(/ /g,"+") +
                  "&deptcode=" + PatientLinks.alredept.value.replace(/ /g,"+") +
                  "&bulkenck=" + PatientLinks.alrevisn.value.replace(/ /g,"+") +
                                 PatientLinks.admissno.value.replace(/ /g,"+")
           Left=(document.body.clientWidth-900)/2
           DFrameLink(linkUrl,0,Left,930,550)
        } else {
          PatientLinkTo("outweb02.pbl",3,3,1,920,900);
        }
     }
  } else {
    PatientLinkTo("outweb02.pbl",3,3,1,920,900);
  }
}
function CheckRefStat() {
  if(!isWhitespace(PatientLinks.alrevisn.value) && 
     !isWhitespace(PatientLinks.alrestat.value)) {
     if(PatientLinks.alrestat.value!="0" && 
        PatientLinks.alrestat.value!="1") {
       alert ("This Referral was closed on "+PatientLinks.alredclo.value);
       return;
     }
  }
  PatientLinkTo("outweb02.pbl",3,4,1,850,475);
}
  
function RemoteTimeSeen() {
  if(isWhitespace(PatientLinks.otbbcitm.value)) {
    CheckIn();
  }
  updateTimeSlot(PatientLinks.urnumber.value,PatientLinks.admissno.value,4,
                 PatientLinks.dummy.value,PatientLinks.casekeys.value);
}
function CheckIn() {
  updateTimeSlot(PatientLinks.urnumber.value,PatientLinks.admissno.value,3,
                 PatientLinks.dummy.value,PatientLinks.casekeys.value);
}
//------------------------------------------------------------------------
//             Function to Update Check-In,Time Seen
//------------------------------------------------------------------------
function updateTimeSlot(Urnumber,Admissno,Updttime,val,caseKeys)
{
var serverURL = "../cgi-bin/outweb02.pbl?reportno=9&urnumber="+
Urnumber+"&admissno="+Admissno+"&updttime="+Updttime+"&updatety=3"+
"&casekeys="+caseKeys;
serverURL=serverURL.replace(/ /g,"+")
var returnValue = RSExecute(serverURL);
//var flag=returnValue.status
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    j=0
    for (var i=3; i < updateTimeSlot.arguments.length; i++) {
       if (typeof(updateTimeSlot.arguments[i]) != 'function') {
         j++
         updateTimeSlot.arguments[i].value=ReturnValue[j] } }
      return ReturnValue[0];}
  else {
//  var flag=" ";
//  return flag;
 return val;
  }
}
function AppointLink(CaseKeys){
 Site=CaseKeys.substr(0,6);
 if(document.PatientLinks.outpsite.value!=Site) {
    alert("Invalid Outpatient Site Security.")
    return;
 }
 SESSKEYS=CaseKeys.substr(0,28).replace(/ /g,"+")
 location.href="outweb02.pbl?reportno=2&template=4&sesskeys="+SESSKEYS
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link
//  1 - Day
//  2 - Date & Time
//  3 - Clinic Type
//  4 - Clinic
//  5 - Outcome
//  6 - Visit Type
//  7 - Status
//  8 - Location Type
//  9 - Location
//---------------------------------------------------------------------------
function InitTable() {
 document.title="Same Day Appointments"
 t = new Table(1,0,2,"100%","center",23,35);
 if (PatientLinks.ibcnmhos.value == "1") {
   t.addColumn("Date","DateTime",1,1,"left","AppointmentIcon.gif","0",100)
   t.addColumn("Clinic Type","String",2,2,"left","","",125)
   t.addColumn("Clinic","String",3,3,"left","","",125)
   t.addColumn("Location","String",8,8,"left","","",125)
   t.addColumn("Hospital","String",7,7,"left","","",125)
   t.addColumn("Status","String",6,6,"left","","",60)
 }
 else {
   t.addColumn("Date","DateTime",1,1,"left","AppointmentIcon.gif","0",150)
   t.addColumn("Clinic Type","String",2,2,"left","","",150)
   t.addColumn("Clinic","String",3,3,"left","","",150)
   t.addColumn("Location","String",8,8,"left","","",150)
   t.addColumn("Status","String",6,6,"left","","",40)
 }
 AddTableRows();

 var height = document.body.clientHeight;
 var PageBodySection  = document.getElementById('PageBodySection');
 PageBodySection.style.height = height/2 + "px";

 TableOutput(0,2);    // Order Column,Asc Dsc

 if(PatientLinks.shwprint.value=="1") {
    PatientLinks.shwprint.value="0"
    PatientLinkTo("outweb02.pbl",3,13,1,700,400) }

   if(PatientLinks.showfoll.value=="1") {        // Show Follow Up
      PatientLinks.showfoll.value="0"
      FollowSlotKey=GetContentCookie("AddSlotFollowUp");
      if(FollowSlotKey!="unknown") {
        ExpireCookiePath("AddSlotFollowUp")
        linkurl="outweb02.pbl?reportno=03&template=004" +
               "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
               "&admissno=" + PatientLinks.admissno.value.replace(/ /g,"+") +
               "&addslotk=" + PatientLinks.d_addslotk.value.replace(/ /g,"+")
        Left=(document.body.clientWidth-920)/2
        DFrameLink(linkurl,50,Left,920,900)
      }
   }

//
   if(PatientLinks.showresc.value=="1") {        // Show Reschedule
      PatientLinks.showresc.value="0"
      RescSlotKey=GetContentCookie("AddSlotResc");
      if(RescSlotKey!="unknown") {
        ExpireCookiePath("AddSlotResc")
        linkurl="outweb02.pbl?reportno=03&template=005" +
               "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+") +
               "&admissno=" + PatientLinks.admissno.value.replace(/ /g,"+") +
               "&addslotk=" + PatientLinks.d_addslotk.value.replace(/ /g,"+")
        Left=(document.body.clientWidth-750)/2
        DFrameLink(linkurl,50,Left,750,475)
      }
   }
//
}

function SelectListSearch() {
  var el=window.event.srcElement;
  if (window.event.keyCode<64) {
    AllKeys=""; return }
  if (window.event.keyCode>90) {
    AllKeys=""; return }
  var ThisKey=String.fromCharCode(window.event.keyCode) ;
  AllKeys=AllKeys+ThisKey.toUpperCase()
  for (i=0; i < el.length; i++) {
    TestString=el.options[i].text.toUpperCase()
    if (TestString.match(AllKeys)) {
	el.options[i].selected=true
	el.focus()
	i=el.length } }
}
function TestEvent() {
  AllKeys="";
  KeyPress.TestKeys.onkeyup=SelectListSearch;
}

function fnRefListPath() {
  RefListPath=GetCookieData("RefListPath");
  if (RefListPath != "unknown") {
    location.href=RefListPath }
}

function ShowRefListIcon() {
  RefListPath=GetCookieData("RefListPath");
  if (RefListPath == "unknown") {
    document.RefListIcon.style.visibility="hidden"; }
}
function origApptLink() {
  if (!isWhitespace(document.PatientLinks.origckey.value)) {
    document.PatientLinks.casekeys.value=document.PatientLinks.origckey.value;
    document.PatientLinks.sesskeys.value=document.PatientLinks.origckey.value;
  }
  PMenuLinkTo("outweb02.pbl|02|004|0|0|0");
}
function origApptFollowLink() {
  if (!isWhitespace(document.PatientLinks.origfkey.value)) {
    document.PatientLinks.casekeys.value=document.PatientLinks.origfkey.value;
    document.PatientLinks.sesskeys.value=document.PatientLinks.origfkey.value;
  }
  PMenuLinkTo("outweb02.pbl|02|004|0|0|0");
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ShowRefListIcon();InitTable();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OUTWEB02.03.003";
PatientVIS="%OUTWEB02.03.081";
PatientNAM="%OUTWEB02.03.002";
PatientSTA="%OUTWEB02.03.086.078";
PatientALT="%OUTWEB02.03.084";
PatientSEX="%OUTWEB02.03.019";
PatientDOB="%OUTWEB02.03.020";
PatientAGE="%OUTWEB02.03.021";
PatientLOC="%OUTWEB02.03.083";
PatientUNT="%OUTWEB02.03.066.0";
PatientPRI="%OUTWEB02.03.086.066.1";
DoctorCOD="%OUTWEB02.03.082.003";
DoctorNAM="%OUTWEB02.03.082.002";
PatientAID="%OUTWEB02.03.086.090";
PatientIND="%OUTWEB02.03.086.091";
PatientCUR="%OUTWEB02.03.086.092";
PatientCLC="%OUTWEB02.03.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OUTWEB02.03.086.094";
PatientCDM="%OUTWEB02.03.086.095";
PatientVDH="%OUTWEB02.03.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<table border="0" cellpadding="0" cellspacing="0" width="100%" >
<tr>
    <td class=HeadingCell width=15%>
    <select onChange='selectActions();'
            name=viewlink id=viewlink class=PMenuSelectList>
    <option>---- Actions ----</option>
    <option value="outweb02.pbl|03|009|1|900|900">Update</option>
    <option value="AttendScreen()|||7||">Attendance</option>
    <option value="CheckRefStat()|||7||">Follow Up Appointment</option>
    <option id=rsch value="outweb02.pbl|03|005|1|750|475">Reschedule</option>
    <option value="outweb02.pbl|03|006|1|800|650">Discharge</option>
    <option value="outweb02.pbl|03|013|1|700|400">Labels & Forms</option>
    <option value="outweb02.pbl|03|002|1|800|450">Non-Attendance</option>
    <option value="outweb02.pbl|03|007|1|700|400">Cancellation </option>
    <option value="outweb02.pbl|03|012|0|700|400">Appointment Summary</option>
    <option value="outweb02.pbl|02|004|0|700|400">View Clinic</option>
<script type="text/javascript">
    document.write("<option value='outweb02.pbl|03|016|1|");
    document.write(screen.width*0.9+"|"+screen.height*0.9);
    document.write("'>Supervisor</option>");
</script>
    <option value="allweb02.pbl|04|002|1|920|450">Link Referral</option>
    </select> 
    <img src=../images/ListIcon.gif class=Icon
     alt="Rescheduled appointment Clinic List"
     title="Rescheduled appointment Clinic List"
     id="OrigReschIcon" onclick='origApptLink();'>

    <img src=../images/ListIcon.gif class=Icon
     alt="Original appointment Clinic List"
     title="Original appointment Clinic List"
     id="OrigFollowIcon" onclick='origApptFollowLink();'>
    </td>

    <td class=HeadingCell align=left>    
    <img src=../images/ListIcon.gif class=Icon name=RefListIcon id=RefListIcon
     alt="Referral Letter List" title="Referral Letter List"
     onclick='fnRefListPath();'></td>
    <td class=HeadingCell align=center>Appointment Details - %OUTWEB02.03.618.1
    </td>
    <td class=HeadingCell width=15% align=right>
    <img src=../images/ListIcon.gif class=Icon 
     alt="This appointment Clinic List - %OUTWEB02.03.313 %OUTWEB02.03.304"
     title="This appointment Clinic List - %OUTWEB02.03.313 %OUTWEB02.03.304"
     onclick='PMenuLinkTo("outweb02.pbl|02|004|0|0|0");'></td></tr>
</table>
<table border="0" cellpadding="2" cellspacing="0" width="95%" align=center>
<tr><td class=DataLabel width=20%>Clinic   </td>
    <td class=DataField width=30%>%OUTWEB02.03.303.1	   </td>
    <td class=DataLabel width=20%>Appointment	   </td>
    <td class=DataField width=30%>%OUTWEB02.03.313 %OUTWEB02.03.304
		    at	%OUTWEB02.03.316	   </td></tr>

<tr><td class=DataLabel>Clinic Location</td>
    <td class=DataField>%OUTWEB02.03.640.016.0</td>
    <td class=DataLabel>Interpreter </td>
    <td class=HighLightRed>%OUTWEB02.03.389 &nbsp;</td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.017.CV</td>
    <td class=DataField>%OUTWEB02.03.310.0</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    </tr>

<tr><td class=DataLabel>Special Arrangements	       </td>
    <td class=HighLightRed>%OUTWEB02.03.378.0 </td>
    <td class=DataLabel>Priority	       </td>
    <td class=DataField>%OUTWEB02.03.332.0   &nbsp;</td></tr>

<tr><td class=DataLabel>Referral Source	     </td>
    <td class=DataField>%OUTWEB02.03.320.0	     </td>
    <td class=DataLabel>Unit		 </td>
    <td class=DataField>%OUTWEB02.03.341.0   &nbsp;</td></tr>

<tr><td class=DataLabel>Transport		</td>
    <td class=DataField>%OUTWEB02.03.342.0   &nbsp;</td>
    <td class=DataLabel>Reports Required </td>
    <td class=DataField>%OUTWEB02.03.336.0	  &nbsp;</td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL		 </td>
    <td class=DataField>%OUTWEB02.03.321.0	  &nbsp;</td>
    <td class=DataLabel>Referral Date</td>
    <td class=DataField>%OUTWEB02.03.367</td></tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField> &nbsp;</td>
    <td class=DataLabel>Referral Responsible HCP</td>
    <td class=DataField>%OUTWEB02.03.753.038.0</td></tr>

<tr><td class=DataLabel>ACC Number</td>
    <td class="DataField TextBlue"> %OUTWEB02.03.907 &nbsp;</td>
    <td class=DataLabel>Accident Date</td>
    <td class="DataField TextBlue">%OUTWEB02.03.908 &nbsp;</td></tr>

<tr><td class=DataLabel>Referring GP		     </td>
    <td class=DataField>
      <a href='javascript:HCPViewFrame("%OUTWEB02.03.348.001","%OUTWEB02.03.349","%OUTWEB02.03.356")'>
      %OUTWEB02.03.348.081</a></td>
    <td class=DataLabel>%STANDARD.01.017.sd</td>
    <td class=DataField>%OUTWEB02.03.327.006.9.3</td></tr>

<tr><td class=DataLabel>Booked By</td>
    <td class=DataField>%OUTWEB02.03.870.1</td>
    <td class=DataLabel>Date</td>
    <td class=DataField>%OUTWEB02.03.868 at %OUTWEB02.03.869</td></tr>

<tr valign=top>
    <td class=DataLabel>Presenting Complaint</td>
    <td class=DataField>%OUTWEB02.03.603
    <td class=DataLabel>%STANDARD.01.017.gb</td>
    <td class=DataField>%OUTWEB02.03.687.1</td></tr>

<tr valign=top><td class=DataLabel>Diagnosis</td>
    <td class=DataField>
    %OUTWEB02.03.364  %OUTWEB02.03.365            <br>
    %OUTWEB02.03.379  %OUTWEB02.03.380		  <br>
    %OUTWEB02.03.381  %OUTWEB02.03.382		  <br>
    %OUTWEB02.03.383  %OUTWEB02.03.384		  <br>
    %OUTWEB02.03.385  %OUTWEB02.03.386	
    </td>
    <td class=DataLabel>Procedures</td>
    <td class=DataField>
    %OUTWEB02.03.692.002  %OUTWEB02.03.692.003    <br>
    %OUTWEB02.03.692.004  %OUTWEB02.03.692.005    <br>
    %OUTWEB02.03.692.006  %OUTWEB02.03.692.007    <br>
    %OUTWEB02.03.692.008  %OUTWEB02.03.692.009    <br>
    %OUTWEB02.03.692.010  %OUTWEB02.03.692.011    <br>
    </td></tr>
<tr>
<td>%STANDARD.01.017.HP</td>
<td class=DataField>%OUTWEB02.03.327.013.1  </td>
<td class=DataLabel>Problems</td>
<td class=DataField rowspan=3 valign=top> 
                    %OUTWEB02.03.692.012.1  %OUTWEB02.03.692.012.0 <br>
                    %OUTWEB02.03.692.013.1  %OUTWEB02.03.692.013.0 <br>
                    %OUTWEB02.03.692.014.1  %OUTWEB02.03.692.014.0
</td>
</tr>

<tr><td class=DataLabel>Outcome</td>
    <td class=DataField>%OUTWEB02.03.354.0</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    </tr>

<tr valign=top><td class=DataLabel>Comments</td>
    <td class=DataField colspan=3><pre>%OUTWEB02.03.327.016.099</pre></td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    </tr>
</table>
</div>

<div id=TableLocation></div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=admissno value="%OUTWEB02.03.081">
<input type=hidden name=MenuType value="%OUTWEB02.03.088">
<input type=hidden name=casekeys value="%OUTWEB02.03.366">
<input type=hidden name=sesskeys value="%OUTWEB02.03.366">
<input type=hidden name=shwprint value="%OUTWEB02.03.609">
<input type=hidden name=clnewbok value="1">
<input type=hidden name=waitflag value="%OUTWEB02.03.620">
<input type=hidden name=waitretk value="%OUTWEB02.03.621">
<input type=hidden name=othecenc value="%OUTWEB02.03.640.030">
<input type=hidden name=alrevisn value="%OUTWEB02.03.646">
<input type=hidden name=alredept value="%OUTWEB02.03.648">
<input type=hidden name=alrestat value="%OUTWEB02.03.654">
<input type=hidden name=alredclo value="%OUTWEB02.03.655">
<input type=hidden name=alenenct value="%OUTWEB02.03.647">
<input type=hidden name=dummy value="">
<input type=hidden name=otbbcitm value="%OUTWEB02.03.351">
<input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden name=outpsite value="%STANDARD.01.023">
<input type=hidden name=origckey value="%OUTWEB02.03.685">
<input type=hidden name=day_origckey value="">
<input type=hidden name=dummy_origckey value="">
<input type=hidden name=origfkey value="%OUTWEB02.03.699.001">
<input type=hidden name=day_origfkey value="">
<input type=hidden name=dummy_origfkey value="">
<input type=hidden name=showresc value="%OUTWEB02.03.676">
<input type=hidden name=d_addslotk value="%OUTWEB02.03.674">
<input type=hidden name=showfoll value="%OUTWEB02.03.673">
<input type=hidden name=bokstat value="%OUTWEB02.03.608.1">
</form>

<form name=UpdateStatus action=outweb02.pbl method=post>
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=1>
<input type=hidden name=redirect value="">
<input type=hidden name=updatety value="">
<input type=hidden name=casekeys value="">
<input type=hidden name=sesskeys value="%OUTWEB02.03.366">
<input type=hidden name=sessupdt value="">
<input type=hidden name=bookstat value="">
<input type=hidden name=urnumber value="">
<input type=hidden name=admissno value="">
<input type=hidden name=patfname value="">
<input type=hidden name=dummyadm value="">
<input type=hidden name=dummyclm value="%STANDARD.01.017.CL">
<input type=hidden name=othecenc value="%OUTWEB02.03.640.030">
<input type=hidden name=othedurn value="%OUTWEB02.03.640.013">
<input type=hidden name=xocadoct value="%OUTWEB02.03.649">
<input type=hidden name=xocahcp1 value="%OUTWEB02.03.640.056">
<input type=hidden name=xocahcp2 value="%OUTWEB02.03.640.057">
<input type=hidden name=xocahcp3 value="%OUTWEB02.03.640.058">
<input type=hidden name=xocahcp4 value="%OUTWEB02.03.640.059">
</form>

<form name=SelectPeriod>
<div id="hidesesskeys" style="display: none">
  <select name=sesskeys id=sesskeys>
    <option selected>%OUTWEB02.03.313 %OUTWEB02.03.304</option>
  </select>
</div>
<input type=hidden name=dateclin id=dateclin value="%OUTWEB02.03.304">
<input type=hidden name=xocadoct id=xocadoct value="%OUTWEB02.03.649">
<input type=hidden name=othedurn id=othedurn value="%OUTWEB02.03.640.013">
</form>

<script type="text/javascript">
  if(PatientLinks.waitflag.value == "1" && PatientLinks.shwprint.value=="0") {
       location.href="watweb01.pbl?reportno=2&template=001" +
                "&casekeys=" + PatientLinks.waitretk.value.replace(/ /g,"+")
  }
  if(PatientLinks.waitflag.value == "2" && PatientLinks.shwprint.value=="0") {
       location.href="watweb01.pbl?reportno=2&template=001" +
                "&casekeys=" + PatientLinks.waitretk.value.replace(/ /g,"+")
  }
  if(isWhitespace(document.PatientLinks.origckey.value)) {
    document.getElementById("OrigReschIcon").style.display="none";
  }else{
    var dateSubString = document.PatientLinks.origckey.value.substr(12,8);
    var dateString = SetDateDDMMMYYYY(dateSubString); //DD MMM YYYY
    document.PatientLinks.dummy_origckey.value = dateString;
    DayOfWeek(document.PatientLinks.dummy_origckey,
              document.PatientLinks.day_origckey);
    document.getElementById("OrigReschIcon").title += " - " +
          document.PatientLinks.day_origckey.value + " " + dateString; 
  }
  if(isWhitespace(document.PatientLinks.origfkey.value)) {
    document.getElementById("OrigFollowIcon").style.display="none";
  }else{
    var dateSubString = document.PatientLinks.origfkey.value.substr(12,8);
    var dateString = SetDateDDMMMYYYY(dateSubString); //DD MMM YYYY
    document.PatientLinks.dummy_origfkey.value = dateString;
    DayOfWeek(document.PatientLinks.dummy_origfkey,
              document.PatientLinks.day_origfkey);
    document.getElementById("OrigFollowIcon").title += " - " +
          document.PatientLinks.day_origfkey.value + " " + dateString;
  }
function AddTableRows() {
%OUTWEB02.03.376
UGAppointmentList(PatientURN,"OUTWEB02.03.376","%OUTWEB02.03.304");
}
</script>
