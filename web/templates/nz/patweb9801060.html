<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript" src="../js/TableSort1.js"></script>
<style>
.strikethrough {
  text-decoration: line-through;
}
</style>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create Table0          
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
function InitTable() {
    document.title="ACC Summary"
    t = new Table(1,0,2,"100%","center",30,30);
    t.addColumn("ACC Number","String",0,0,"left","","",75)
    t.addColumn("Accident Description","String",1,1,"left","","",200)
    t.addColumn("Accident Date","DateTime",2,2,"left","","",70)
    t.addColumn("Decline Date","DateTime",3,3,"left","","",70)
    t.addColumn("Status","String",4,5,"left","EditIcon.gif","6",70);
    t.addColumn("Audit","String",8,8,"left","EditIcon.gif","7",70);

    AddTableRows()
    TableOutput(0,2);    // Order Column,Asc Dsc
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link                   
//  1 - Employer Name
//  2 - another link
//  3 - ACC Number/Insurance Claim
//  4 - Date of Accident
//  5 - Visit Type
//  6 - Visit Date
//  7 - Visit Number
//  8 - Acc. Location
//  9 - space
// 10 - Cause of Injury
// 11 - Decline Date
//---------------------------------------------------------------------------
function InitTable1(TableView1) {
  switch (TableView1) {
    case 0: {
    documentTitle2 = "Injury / Accident Alteration";
    t1 = new Table1(1,0,2,"100%","center",30,30);
    t1.addColumn("ACC Number","String",3,3,"left","AppointmentIcon.gif","0",90)
    t1.addColumn("Description of Injury","String",10,10,"left","","",250)
    t1.addColumn("Date of Accident","DateTime",4,4,"left","","",95)
    t1.addColumn("Visit Type","String",5,5,"left","","",80)
    t1.addColumn("Visit Date","DateTime",6,6,"left","","",80)
    t1.addColumn("Visit Number","String",7,7,"left","","",80)
    t1.addColumn("Decline Date","DateTime",11,11,"left","","",80)

    AddTableRows1();
    TableOutput1(0,2);    // Order Column,Asc Dsc
    HeadingDivision1.style.overflowY = 'hidden';
    break; }
  }
}

function linkPatient(Urnumber,VisitNo,VisitType,SecOpt,Casekeys) {
   document.PatientLinks.action="patweb89.pbl"
   document.PatientLinks.reportno.value="1"
   document.PatientLinks.template.value="005"
   document.PatientLinks.admissno.value=VisitNo
   document.PatientLinks.urnumber.value=Urnumber
   document.PatientLinks.systflag.value=VisitType
   document.PatientLinks.submit()
}

function linkInsurance(Insuranc,Viewopts) {
   LinkUrl="patweb87.pbl?reportno=6&template=5" +
         "&insuranc=" + Insuranc.replace(/ /g,"+") +
         "&viewopts=" + Viewopts

   Left=(document.body.clientWidth-430)/2
   DFrameLink(LinkUrl,120,Left,430,300)
}

function EditStatus(UR, VisitNo) {
  linkurl="patweb92.pbl?reportno=20&template=002" +
          "&urnumber=" + UR + "&admissno=" + VisitNo;

  Width = 450;
  Height = 250;
  Top = (document.body.clientHeight-Height)/2;
  Left = (document.body.clientWidth-Width)/2;

  DFrameLink(linkurl,Top,Left,Width,Height);
}

function ACCAuditList(UR, VisitNo, claimnum) {
 var sURL = "patweb92.pbl?reportno=20&template=003";
     sURL += "&urnumber=" + UR + 
             "&admissno=" + VisitNo + 
             "&claimnum=" + claimnum;
 var sRedirectURL = "patweb98.pbl?reportno=01&template=060" + "&urnumber=" + UR;
 sURL += "&redirect=" + encodeURIComponent(sRedirectURL);
 location.href = sURL;
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);InitTable1(0);"
 style="overflow:hidden">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB98.01.003";
PatientVIS="%PATWEB98.01.081";
PatientNAM="%PATWEB98.01.002";
PatientSTA="%PATWEB98.01.086.078";
PatientALT="%PATWEB98.01.084";
PatientSEX="%PATWEB98.01.019";
PatientDOB="%PATWEB98.01.020";
PatientAGE="%PATWEB98.01.021";
PatientLOC="%PATWEB98.01.083";
PatientPRI="%PATWEB98.01.086.066.1";
PatientUNT="%PATWEB98.01.066.0";
DoctorCOD="%PATWEB98.01.082.003";
DoctorNAM="%PATWEB98.01.082.002";
PatientAID="%PATWEB98.01.086.090";
PatientIND="%PATWEB98.01.086.091";
PatientCUR="%PATWEB98.01.086.092";
PatientCLC="%PATWEB98.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB98.01.086.094";
PatientCDM="%PATWEB98.01.086.095";
PatientVDH="%PATWEB98.01.086.099.015";
InsertPatientHeader()
</script>

<div id=PatientMenu></div>

<div id=TableLocation ></div>
<div id=TableLocation1 ></div>

<script type="text/javascript">

function AddTableRows() {
%PATWEB98.01.353
}

function AddTableRows1() {
%PATWEB98.01.354
}

function TableBody() {
 filteredRows=0;
 RowClass="TableRowEven"

 var STATUS_COL_NUM = 4;    // Claim Status column number
 var STATUS_COL_NUM1 = 5;    // Claim Status column number
 var STATUS_COMPLETE = 2;   // Completed
 var STATUS_CANCELLED = 3;  // Cancelled
 var ClaimStatus = "";
 var bShowUpdtIcon = false;
 var CompatibilityMode = false;  // Browser Compatibility Mode

 var sAgentString = window.navigator.userAgent;
 if ( ((sAgentString.indexOf("MSIE 6.0") >= 1 ||
         sAgentString.indexOf("MSIE 7.0") >= 1) &&
         sAgentString.indexOf("compatible") >= 1) ||
       sAgentString.indexOf("Chrome") >= 1 )
 {
    CompatibilityMode = true;
 }

 for(var i = 0; i < t.rows.length; i++) {
  if (TableFilter(t.rows[i])){
   filteredRows++;

   if (RowClass=="TableRowEven") { RowClass="TableRowOdd" }
   else                          { RowClass="TableRowEven" }

   TableString[TableString.length] = "<tr id='row_"+i+"' height=" + t.RowHeight + " class=" + RowClass + ">" ;

   for (var j = 0; j < t.columns.length; j++) {
     if (CompatibilityMode) {
       TableString[TableString.length] = "<td align=" + t.columns[j][4];
     } else {
       TableString[TableString.length] = "<td style='padding:0px 5px' align=" + t.columns[j][4];
     }
     if (t.columns[j][11]!=undefined) {
       if(!isWhitespace(t.rows[i][t.columns[j][11]])) {
         TableString[TableString.length] = " class=" + 
                                           t.rows[i][t.columns[j][11]]  ;
       }
     }
     if(t.columns[j][12]!=undefined) {
       if(!isWhitespace(t.rows[i][t.columns[j][12]])) {
         TableString[TableString.length] = " title=" +
                         t.rows[i][t.columns[j][12]].replace(/ /g,"&nbsp;");
       }
     }

     ClaimStatus = t.rows[i][5];
     bShowUpdtIcon = (ClaimStatus != STATUS_COMPLETE)? true : false;

     if (ClaimStatus == STATUS_CANCELLED) {  // Cancelled Claim Status?
       if (j == STATUS_COL_NUM || j == STATUS_COL_NUM1) {
         TableString[TableString.length] = " style='font:bold'";  // bold text
       }
       else {
         TableString[TableString.length] = " class='strikethrough'";
         //TableString[TableString.length] = " style='text-decoration:line-through'";
       }
     }

     TableString[TableString.length] = " width=" + t.columns[j][7] + ">" ;
     LinkColumn = t.columns[j][6];
     LinkFlag = 0
     ImgString = t.columns[j][5];
     onmouseind = t.columns[j][10];

     if (LinkColumn != "" && j != STATUS_COL_NUM) {
       LinkHref = t.rows[i][t.columns[j][6]];
       if (LinkHref != ""){ 
         TableString[TableString.length] = "<a href=\"" +
                                           LinkHref.replace(/\s*$/,"") + "\">"
         LinkFlag = 1 }
     }

     switch(t.columns[j][1]) {
       case "MaxLimit" :  
         FormatIcon(i);
         ThisValue=t.rows[i][t.columns[j][2]];
         MaxValue=t.columns[j][8];
         HighLightColor=t.columns[j][9];
         if (ThisValue>MaxValue) {
            TableString[TableString.length] = "<font color="+HighLightColor+"><b>"
            TableString[TableString.length] = t.rows[i][t.columns[j][2]];
            TableString[TableString.length] = "</font><b>" }
         else {
            TableString[TableString.length] = t.rows[i][t.columns[j][2]]; }
         if ( LinkFlag ) { TableString[TableString.length] = "</a>"; }
         break;
       case "MinLimit" :  
         FormatIcon(i);
         ThisValue=t.rows[i][t.columns[j][2]];
         MaxValue=t.columns[j][8];
         HighLightColor=t.columns[j][9];
         if (ThisValue<MaxValue) {
            TableString[TableString.length] = "<font color=" +
                                              HighLightColor+"><b>"
            TableString[TableString.length] = t.rows[i][t.columns[j][2]];
            TableString[TableString.length] = "</font><b>" }
         else {
            TableString[TableString.length] = t.rows[i][t.columns[j][2]]; }
         if ( LinkFlag ) { TableString[TableString.length] = "</a>"; }
         break;
       case "Date" :  
         FormatIcon(i);
         TableString[TableString.length] = FormatDate(t.rows[i][t.columns[j][2]]);
         break;
       case "DateTime" :  
         FormatIcon(i);
         TableString[TableString.length] = FormatDateTime(t.rows[i][t.columns[j][2]]);
         break;
       case "DateTimeImg" :
         if (t.columns[j][5] == "") {
           ImgString=t.rows[i][t.columns[j][8]];
         }
         else {
           ImgString=t.columns[j][5] +
                       t.rows[i][t.columns[j][8]] + ".gif"
         }
         FormatIcon(i);
         TableString[TableString.length] = FormatDateTime(t.rows[i][t.columns[j][2]]);
         break;
       case "Time" :  
         FormatIcon(i);
         TableString[TableString.length] = FormatTime(t.rows[i][t.columns[j][2]]);
         break;
       case "Name" :  
         FormatIcon(i);
         TableString[TableString.length] = FormatName(t.rows[i][t.columns[j][2]]);
         break;
       case "ImageText" :
         if (t.columns[j][5] == "") {
           ImgString=t.rows[i][t.columns[j][8]];
         }
         else {
           ImgString=t.columns[j][5] +
                       t.rows[i][t.columns[j][8]] + ".gif"
         }
         FormatIcon(i);
         TableString[TableString.length] = (t.rows[i][t.columns[j][2]]);
         break;
       case "NameAll" :  
         FormatIcon(i);
         TableString[TableString.length] = FormatNameAll(t.rows[i][t.columns[j][2]]);
         break;
       case "Graph":  
         TableString[TableString.length] = FormatGraph(t.rows[i][t.columns[j][2]],t.columns[j][5]);
         break;
       case "IconLink":  
         FormatIcon(i);
         break;
       case "Image":  
         if (t.columns[j][5] == "") {
           ImageString=t.rows[i][t.columns[j][2]];
         }
         else {
           ImageString=t.columns[j][5] + t.rows[i][t.columns[j][2]] + ".gif"
         }
         TableString[TableString.length] = FormatImage(ImageString);
         break;
       case "Patient":   
         FormatPatientIcon(t.rows[i][t.columns[j][8]])
         TableString[TableString.length] = t.rows[i][t.columns[j][2]];
         if ( LinkFlag ) { TableString[TableString.length] = "</a>"; }
         break;
       default    :   
         if (j == STATUS_COL_NUM) {  // Claim Status column
           TableString[TableString.length] = "<span " +
             " style='display:inline-block;width:55px;height:15px;" +
             "vertical-align:text-top'>" + t.rows[i][t.columns[j][2]] +
             "</span>";

           if (bShowUpdtIcon) {
             LinkHref = t.rows[i][t.columns[j][6]];
             if (LinkHref != "") { 
               TableString[TableString.length] = "<a href=\"" +
                 LinkHref.replace(/\s*$/,"") + "\">"
               LinkFlag = 1;
             }
             FormatIcon(i);
           }
         }
         else {
           FormatIcon(i);
           TableString[TableString.length] = t.rows[i][t.columns[j][2]];
         }

         if ( LinkFlag ) { TableString[TableString.length] = "</a>"; }
         break;
       }
       if (isWhitespace(t.rows[i][t.columns[j][2]])) {
         TableString[TableString.length] = "&nbsp;" 
       }
       TableString[TableString.length] = "</td>" ;
     }
     TableString[TableString.length] = "</tr>" ;
   }
  }
}

function SetListHeight1() {
  var TableLocation = document.getElementById('TableLocation');
  var HeadingDivision = document.getElementById('HeadingDivision');
  var BodyDivision = document.getElementById('BodyDivision');

  var height = document.body.clientHeight;

  BodyDivision.style.height = height/2 - TableLocation.offsetTop - HeadingDivision.offsetHeight + "px";

  var TableLocation1 = document.getElementById('TableLocation1');
  var HeadingDivision1 = document.getElementById('HeadingDivision1');
  var BodyDivision1 = document.getElementById('BodyDivision1');

  var zoom = window.devicePixelRatio;
  var margin = 18;

  if (zoom > 1) {  // zoomed-in > 100%
    margin = Math.round(window.devicePixelRatio * 10) + 10;
  }

  BodyDivision1.style.height = height - TableLocation1.offsetTop - HeadingDivision1.offsetHeight - margin + "px";
}
</script>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB98.01.003">
<input type=hidden name=admissno value="%PATWEB98.01.081">
<input type=hidden name=MenuType value="%PATWEB98.01.088">
<input type=hidden name=insuranc value="">
<input type=hidden name=viewopts value="">
<input type=hidden name=systflag value="">
<input type=hidden name=casekeys value="                        ">
</form>
