<meta name="TemplateVersion" content="V12.01.01">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<link rel="stylesheet" href="../html/validate.css" type="text/css">
<script language=javascript src="../js/emr_entry.js"> </script>
<script language=javascript src="../js/EmrMandatory.js"> </script>
<script language=javascript src="../js/emrweb02100.js"> </script>
<script language=javascript>
function DisplayPresentComplaintAddInfo() {
  f = document.triage;
  if (f.emcprcmp.value == "1") {
    document.getElementById('PresentComplaintAddInfo').style.display = "";
  }
  else {
    document.getElementById('PresentComplaintAddInfo').style.display = "none";
  }
  f.vicmt023.value=trim(f.pcompadd.value)
}
function SplitComplaint()  {
words=triage.comptext.value.split(/\s+/);
triage.emvis004.value=""
triage.emvis005.value=""
firstflag=0
for (i=0 ; i<words.length ; i++) {
  if (triage.emvis004.value.length+words[i].length < 50 && firstflag==0 ) {
    triage.emvis004.value+=words[i] + " " }
  else {
    triage.emvis005.value+=words[i] + " "
    firstflag=1 }
  }
triage.comptext.value=triage.emvis004.value+triage.emvis005.value
}
function setFormactn() {
  var cont = workMandatory(triage);
  if(cont != true) {
     return;
     }
  else {
    document.triage.nextpage.value="2"
    document.triage.formactn.value="C1"
    document.triage.updttype.value="TRIAG"
    document.triage.submit()
    }
}
//
function workMandatory(theForm) {
//
  if (isWhitespace(document.triage.emvis060.value)) {
    alert("Presenting Complaint Code is Mandatory");
    return(false);
  }
//
  if (isWhitespace(document.triage.prcom001.value)) {
    alert("Presenting Complaint Comment is Mandatory");
    return(false);
  }
//
   var hasBeenSet=0;  // Radio button has not been selected
   for (var i =0 ; i < document.triage.emvis003.length; i++) {
     if (document.triage.emvis003[i].checked==1) {
       hasBeenSet=1;
     }
   }
   if (!hasBeenSet) {
     alert("Triage Category is Mandatory");
     return false;        //Radio button has bot been selected return false
   }
//
  if (isWhitespace(document.triage.emvis127.value)) {
    alert("Triage Nurse is Mandatory");
    return(false);
  }
//
  if (isWhitespace(document.triage.emvis128.value)) {
    alert("Triage Date is Mandatory");
    return(false);
  }
//
  if (isWhitespace(document.triage.emvis129.value)) {
    alert("Triage Time is Mandatory");
    return(false);
  }
//
  Indicator=document.triage.v060name.value.substr(13,1);
  if (Indicator=="I") { // Injury data
    if (isWhitespace(triage.emvis021.value)) {
       alert("Place Where Injury Occurred is a required field");
       return false;}
    if (isWhitespace(triage.injur006.value)) {
       alert("Activity When Injured is a required field");
       return false;}
    if (isWhitespace(triage.injur004.value)) {
       alert("Injury Cause is a required field");
       return false;}
    if (isWhitespace(triage.injur005.value)) {
       alert("Human Intent is a required field");
       return false;}
    if (isWhitespace(triage.injur002.value)) {
       alert("Description of Injury Event is a required field");
       return false;}
  }
  return true;
}
function DisplayDiv() {
Indicator=document.triage.v060name.value.substr(13,1);
  if (Indicator=="I") {
     document.getElementById("Injury").style.display="";
     document.getElementById("Injury").innerHTML=
     document.getElementById("EmergencyProc").innerHTML;
     }
  else {
     document.getElementById("Injury").style.display="none";
     document.getElementById("Injury").innerHTML="";}
}
function validateNurse() {
  validateCode('17',document.triage.emvis127,
                    document.triage.v127name,
                    document.triage.gnm,
                    SetNurseName);
}
function SetNurseName() {
triage.v127name.value=triage.gnm.value.replace(/\s*$/g,"")+
                              " " +
                            triage.v127name.value.replace(/\s*$/g,"")
}
function CancelGoBack(){
     window.location.href = document.triage.redirect.value;
}
function validateLocation(SearchField) {
  if (isWhitespace(SearchField.value)) {
      return;;
  }
  var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=2" +
                    "&valdcode=" + SearchField.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|")
  }
  else {
     document.triage.emvis006.selectedIndex=0;
     document.triage.emvis006.focus();
  }
}

</script>
<style type=text/css>
select.[Select160] {
width: 160px;
}
</style>
%START.OF.PAGE
<body onload="PageLoad(event);DisplayDiv();DisplayPresentComplaintAddInfo();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%EMRWEB02.01.003";
PatientVIS="%EMRWEB02.01.081";
PatientNAM="%EMRWEB02.01.002";
PatientSTA="%EMRWEB02.01.086.078";
PatientALT="%EMRWEB02.01.084";
PatientSEX="%EMRWEB02.01.019";
PatientDOB="%EMRWEB02.01.020";
PatientAGE="%EMRWEB02.01.021";
PatientLOC="%EMRWEB02.01.083";
PatientPRI="%EMRWEB02.01.086.066.1";
PatientUNT="%EMRWEB02.01.066.0";
PatientIND="%EMRWEB02.01.086.091";
GpCOD="%EMRWEB02.01.086.084.001";
GpNAM="%EMRWEB02.01.086.084.081";
GpPRAC="%EMRWEB02.01.086.085.001";
GpPRACCNT="%EMRWEB02.01.086.085.002";
GpPRACNAM="%EMRWEB02.01.086.085.005";
PatientARR="%EMRWEB02.01.101.0 %EMRWEB02.01.102";
PatientSEE="%EMRWEB02.01.130.0 %EMRWEB02.01.131";
PatientTRI="%EMRWEB02.01.103.3";
PatientECLC="%EMRWEB02.01.484.1";
PatientCLH="%STANDARD.01.017.CL";
PatientEHFT="%EMRWEB02.01.485";
InsertEmergencyHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form name=SelectScreen action="emrweb02.pbl" method=post>
 <input type=hidden name=reportno value=1>
 <input type=hidden name=template value=1>
 <input type=hidden name=admissno value="%EMRWEB02.01.146">
 <input type=hidden name=urnumber value="%EMRWEB02.01.151">
</form>
<form name=dummy action="emrweb02.pbl" method="post">
  <input type=hidden name=reportno value="1">
  <input type=hidden name=urnumber>
  <input type=hidden name=admissno>
  <input type=hidden name=formactn>
  <input type=hidden name=updttype>
  <input type=hidden name=username>
  <input type=hidden name=password>
  <input type=hidden name=updateky value="%EMRWEB02.01.404">
  <input type=hidden name=nextpage value="1">
  <input type=hidden name=redirect value="emrweb01.pbl?reportno=1&template=2">
</form>

<form name=triage action="emrweb02.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="01">
<input type=hidden name=resavail value="%EMRWEB02.01.168">
<input type=hidden name=template value="001">
<input type=hidden name=admissno value="%EMRWEB02.01.146">
<input type=hidden name=urnumber value="%EMRWEB02.01.151">
<input type=hidden name=formactn>
<input type=hidden name=redirect value="emrweb01.pbl?reportno=1&template=2">
<input type=hidden name=updateky value="%EMRWEB02.01.404">
<input type=hidden name=updttype>
<input type=hidden name=nextpage>
<input type="hidden" name="username">
<input type="hidden" name="password">
<input type=hidden name=emvis026 value="%EMRWEB02.01.126.3">
<input type=hidden name=savelocn value="%EMRWEB02.01.106.1">
<input type=hidden name=savelocd value="%EMRWEB02.01.106.0">
<input type=hidden name=emcprcmp id=emcprcmp
 value="%STANDARD.01.025.122.051.1.1">
<input type=hidden name=pcompadd value="%EMRWEB02.01.955.023.0">

<table width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td class=DataLabel width=20%>Presenting Complaint </td>
    <td><input type=text name=emvis060 max=3 size=3 value="%EMRWEB02.01.220.1"
         onchange="UpCase(this);CheckCode(triage.emvis060,triage.v060name)">
    <select name=v060name 
     onchange="UpdateCode(triage.emvis060,triage.v060name);DisplayDiv();">
    <option></option>
    %EMRWEB02.01.220.2
    </select>
    </td></tr>

<tr><td></td>
    <td><textarea wrap=hard name=prcom001 cols=50 rows=6
                  title="Presenting Complaint"
                  onkeydown="ValidateKeyInput(this,6)"
                  onblur="ValidateTextLimits(this,6)"></textarea>
    <input type=hidden name=emvis004 value="%EMRWEB02.01.104">
    <input type=hidden name=emvis005 value="%EMRWEB02.01.105">
    <input type=hidden name=nocodes>
    </td></tr>

<tr valign=top id=PresentComplaintAddInfo>
  <td class=DataLabel></td>
  <td>
    <textarea type=text name=vicmt023 id=vicmt023 wrap=hard
     cols=50 rows=6 class=AsciiOnly
     title="Presenting Complaint - Additional Information"
     onkeydown="CheckPresentCompAddInfoTextLimit(this);"
     onblur="TextareaBlurHandler(this);">
    </textarea>
  </td>
</tr>
</table>
<div id=Triage></div>
<table width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td class=DataLabel width=20%>Triage Category
   <td><table border=0 cellspacing=0>
   <tr>
   <td bgcolor=#FF3333><i>1</i>
   <input type="radio" name=emvis003 value=1 tabindex=20 title="Triage Category"
   ></td>
   <td bgcolor=#FF9900><i>2</i><input type=radio name=emvis003 value=2 ></td>
   <td bgcolor=#66FF99><i>3</i><input type=radio name=emvis003 value=3 ></td>
   <td bgcolor=#99CCFF><i>4</i><input type=radio name=emvis003 value=4 ></td>
   <td bgcolor=#FFFFFF><i>5</i><input type=radio name=emvis003 value=5 ></td>
   </tr></table></td></tr>

<tr><td class=DataLabel>Triage Nurse</td>
    <td><input type="text" name=emvis127 size=6 class=Mandatory
     onblur="UpCase(this);validateNurse(triage.emvis127,triage.v127name);"
     title="Triage Nurse">
    <input type=hidden name=gnm>
    <input type="text" name=v127name size=20 class=Readonly readonly tabindex=-1
     notab>
    <img src=../images/SearchIcon.gif class=Icon
    onclick='NurseSearchFrame(triage.emvis127,triage.v127name);'></td>
</tr>

<tr><td class=DataLabel>Triage Date and Time</td>
    <td colspan=3>
    <select name="emvis128" title="Triage Date">
      %EMRWEB02.01.162.1
    </select>
    <input type=text size=8 maxlength=8 name="emvis129"  tabindex=19
     title="Triage Time">
    <img class=Icon src="../images/stopwat1.gif"
     onclick="defDateTime(triage.emvis128,'Triage Date',
                          triage.emvis129,'Triage Time');">
    <img class=Icon src=../images/TimeLookup.gif 
     onclick="TimeLookupFrame(triage.emvis129);">
    </td></tr>

<tr><td class=DataLabel>Location</td>
    <td><select name=emvis006 tabindex=13 title="Location" class="SelectBig"
         onchange="validateLocation(triage.emvis006);">
        <option></option>
        %EMRWEB02.01.106.2
        </select></td></tr>

    <tr><td class=DataLabel>Doctor Allocated</td>
        <td><select class=Select160 name=emvis007>
            <option></option>
             %EMRWEB02.01.107.2
            </select></td></tr>

    <tr><td class=DataLabel>Tetanus Status</td>
        <td><select class=Select160 name=emvis045>
            <option></option>
             %EMRWEB02.01.205.2
            </select></td></tr>

<tr><td>Comments </td>
    <td><input type=text name=emvis036 size=50 maxlength=50 
               value="%EMRWEB02.01.136"></td>
<tr><td></td>
    <td><input type=text name=emvis037 size=50 maxlength=50 
               value="%EMRWEB02.01.137"></td>
    </tr>
</table>

<div id=Injury></div>

<table width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td align=center>
     <input type=button class="button" value="Update" id="emr02u"
      onclick="tempDisable(this);setFormactn();">
     <input type=button class="button" value="Cancel" 
      onclick="CancelGoBack();">
</td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
</form>
<form name=HiddenFields method=get>
<input type=hidden name=Pres01 value="%EMRWEB02.01.104">
<input type=hidden name=Pres02 value="%EMRWEB02.01.105">
<input type=hidden name=Pres03 value="%EMRWEB02.01.174">
<input type=hidden name=Pres04 value="%EMRWEB02.01.175">
<input type=hidden name=Pres05 value="%EMRWEB02.01.176">
<input type=hidden name=Pres06 value="%EMRWEB02.01.177">
<input type=hidden name=prcom001>
</form>
</div>

<span id=EmergencyProc style="display:none;">
<table align=center cellspacing=1 cellpadding=0 border=0 width=100%>
<tr><td class=DataLabel width=20%>Place Where Injury Occurred</td>
    <td><select name="emvis021" class="SelectBig Mandatory"
         title="Place Where Injury Occurred">
    <option></option>
    %EMRWEB02.01.121.2
     </select></td></tr>
<tr><td class=DataLabel>Activity When Injured</td>
    <td><select name="injur006" class="Mandatory SelectBig"
         title="Activity When Injured">
    <option></option>
      %EMRWEB02.01.183.2
       </select></td></tr>

<tr><td class=DataLabel> Injury Cause</td>
    <td><select name="injur004" class="Mandatory SelectBig"
         title="Injury Cause" >
     <option></option>
     %EMRWEB02.01.181.2
     </select>
     </td></tr>

<tr><td class=DataLabel> Human Intent</td>
    <td><select name="injur005" class="Mandatory SelectBig"
         title="Human Intent">
    <option></option>
     %EMRWEB02.01.182.2
      </select></td></tr>
<tr><td class=DataLabel>
    Desc. of Injury Event</td>
    <td><input type="text" name="injur002" maxlength="50" size="40"
         class=Mandatory
         title="Description of Injury Event" value="">
    <input type="text" name="injur003" maxlength="50" size="40" value="">
    </td></tr>
</table>
</span>

<script language=javascript>
if  ("%EMRWEB02.01.260.1" == "1")  {
  document.triage.emvis100.checked=1
}
//
 var RadioIndex=%EMRWEB02.01.103.1 - 1           // Starts at 0 so sub 1
 if(RadioIndex!=-1) {
 document.triage.emvis003[RadioIndex].checked=1  // Set Current Checked Value
 }
  var strg1= trim(HiddenFields.Pres01.value)
  var strg2= trim(HiddenFields.Pres02.value)
  var strg3= trim(HiddenFields.Pres03.value)
  var strg4= trim(HiddenFields.Pres04.value)
  var strg5= trim(HiddenFields.Pres05.value)
  var strg6= trim(HiddenFields.Pres06.value)
  triage.prcom001.value=strg1 + '\n' +
                            strg2 + '\n' +
                            strg3 + '\n' +
                            strg4 + '\n' +
                            strg5 + '\n' +
                            strg6
  document.HiddenFields.prcom001.value=triage.prcom001.value;
</script>
