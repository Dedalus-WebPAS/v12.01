<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/outweb05.js"></script>
<script type="text/javascript">
function DisplayMedPrac() {
  i=document.UpdateForm.otmas006.selectedIndex;
  ind=document.UpdateForm.otmas006.options[i].value.substring(3,4)
  if (ind=="P") {
    MedPracHeading.innerHTML=medprachd.innerHTML;
    MedicalPrac.innerHTML=medpraccd.innerHTML;
    if(UpdateForm.otmas059.checked==true) {
      UpdateForm.otmas060.className="Readonly";
      UpdateForm.otmas060.disabled=true;
      UpdateForm.otmas065.className="Readonly";
      UpdateForm.otmas065.disabled=true;
    } else {
      UpdateForm.otmas060.className="Readonly";
      UpdateForm.otmas060.disabled=true;
      UpdateForm.otmas065.className="Readonly";
      UpdateForm.otmas065.disabled=true;
    }
  } else {
    MedPracHeading.innerHTML=blanklabel.innerHTML;
    MedicalPrac.innerHTML="";
    UpdateForm.otmas060.className="";
  }
}
function ChkLedger(ledger,account,desc) {
   if (!isWhitespace(ledger.value)) {
      AccountSearchFrame(ledger,account,desc)
   }
   else {
      alert(ledger.title + " field is empty. Please select Ledger first");
      FocusDelay(ledger);
   }
}
function clrAcc(code,desc) {
  code.value="";
  desc.value="";
}

function validateAccount(ledger,account,desc) {
  desc.value="";
  if (isWhitespace(account.value)) return;
  if (isWhitespace(ledger.value)) {
    alert(ledger.title + " field is empty. Please select Ledger first");
    FocusDelay(ledger);
  }
  else {
    acctcode=ledger.value.substr(0,2) + account.value.substr(0,12);
    var serverURL   = "../cgi-bin/patweb80.pbl?reportno=52" +
                    "&valdcode=" + acctcode.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|")
      desc.value=trim(ReturnValue[0])
    }
    else {
      account.value="";
      desc.value="";
      account.select();
      FocusDelay(account);
    }
  }
}

function GetProv() {
  var serverURL = "../cgi-bin/patweb80.pbl?reportno=63" +
        "&mediprac=" + UpdateForm.otmas065.value.replace(/ /g,"+") +
        "&valdcode=" + UpdateForm.clindoct.value.replace(/ /g,"+") +
        "&returnfm=1"
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    UpdateForm.otmas060.value=ReturnValue[1];
  }
}


</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);initCheck();DisplayMedPrac();DispLedgerCost();">
   <form name=LinkForm method=get action=outweb05.pbl style="margin:0">
   <input type=hidden name=reportno value="">
   <input type=hidden name=template value="">
   <input type=hidden name=updttype value="">
   <input type=hidden name="otcli001" value="">
   <input type=hidden name="otcli006" value="">
   <input type=hidden name="srchclid" value="">
   <input type=hidden name="srchdowk" value="">
   <input type=hidden name="srchstim" value="">
   <input type=hidden name="otmas001" value="%OUTWEB05.04.101">
   <input type=hidden name="otmas002" value="%OUTWEB05.04.102">
   <input type=hidden name=viewtype value="">
   </form>
   <form name=UpdateForm method=post action=outweb05.pbl>
   <input type=hidden name=reportno value="4">
   <input type=hidden name=template value="003">
   <input type=hidden name=updttype value="">
   <input type=hidden name=otcli001 value="%OUTWEB05.04.001">
   <input type=hidden name=clindoct value="%OUTWEB05.04.002">
   <input type=hidden name=otcli006 value="%OUTWEB05.04.012.1">
   <input type=hidden name="savclind" value="%OUTWEB05.04.106.1">
   <input type=hidden name=nextpage value="1">
   <input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
   <input type=hidden name=otcnlcst id=otcnlcst
    value="%STANDARD.01.025.032.149.0.1">
   <input type=hidden name=provCode id=provCode>
   <input type=hidden name=provName id=provName>

   <input type=hidden name=redirect 
   value="outweb05.pbl?reportno=04&template=001&otcli001=%OUTWEB05.04.157&otcli006=%OUTWEB05.04.012.1">

<table cellspacing=0 cellpadding=0 width=100% >
<tr><td align=center class=HeadingCell>Open/Delete Sessions - Master -
                                       %OUTWEB05.04.003
    </td></tr>
</table>
<br>
<table cellspacing=0 cellpadding=1 width=95% align=center border=0>
<tr><td class=DataLabel width=16%>Day of Week</td>
    <input type=hidden name="otmas001" value="%OUTWEB05.04.101">
    <td><input type=text name="daydesc1" tabindex=1 class=Readonly readonly
         title="Day of week"
         size=10 readonly value="%OUTWEB05.04.156" ></td>

    <td class=DataLabel width=16%>Clinic Type</td>
    <td><select name=otmas005 tabindex=2 class="Readonly SelectBig" 
         disabled title="Clinic Type">
         <option></option>
         %OUTWEB05.04.105.2               
         </select></td></tr>

<tr><td class=DataLabel>Start Time</td>
    <td><input type=text name=otmas002 class=Readonly tabindex=3 
         title="Start Time"
         size=8 readonly value="%OUTWEB05.04.102"></td>

    <td class=DataLabel>Clinic Indicator</td>
    <td><select name=otmas006 class="Readonly SelectBig"  tabindex=4 
        title="Clinic Indicator" disabled>
        <option></option>
        %OUTWEB05.04.106.2               
        </select></td></tr>

<tr><td class=DataLabel>Date Clinic Opened</td>
    <td><input type=text size=12 maxlength=8 name=otmas052 tabindex=5
         class=Readonly readonly
         title="Date Clinic Opened" value="%OUTWEB05.04.158">
        </td>
    <td class=DataLabel>Date Clinic Closed</td>
    <td><input type=text size=12 maxlength=8 name=otmas053 tabindex=6
         class=Readonly readonly
         title="Date Clinic Closed" value="%OUTWEB05.04.159">
        </td></tr>

<tr><td class=DataLabel>Comments</td>
    <td><input type=text name=otmas009 tabindex=7 title="Comments" size=40 
        maxlength=40 class=Readonly readonly value="%OUTWEB05.04.109">
        </td>
    <td class=DataLabel>Instructions</td>
    <td><input type=text size=40  maxlength=40  tabindex=9
         name=otmas054 title="Instructions" class=Readonly readonly
         value="%OUTWEB05.04.160"></td></tr>

<tr><td class=DataLabel></td>
    <td><input type=text name=otmas010 size=40 maxlength=40 tabindex=8
      value="%OUTWEB05.04.110" class=Readonly readonly></td>
    <td class=DataLabel></td>
    <td><input type=text name=otmas055 size=40 maxlength=40 tabindex=10
      value="%OUTWEB05.04.161" class=Readonly readonly></td></tr>

<tr><td class=DataLabel>Slot Time Allocated</td>
 <td class=DataLabel><input type=text name=otmas011 class=Readonly tabindex=12 
     title="Slot time Allocated" size=3 maxlength=3 readonly
     value="%OUTWEB05.04.111"> mins</td>
       <td class=DataLabel></td>
    <td><input type=text size=40 maxlength=40  tabindex=11
         name=otmas056 title="Instructions" class=Readonly readonly
         value="%OUTWEB05.04.162"></td></tr>

<tr><td class=DataLabel>Bookings Finish Time</td>
    <td><input type=text size=8 maxlength=5  tabindex=13 name=otmas003 
        class=Readonly readonly
        title="Booking Finish Time" value="%OUTWEB05.04.103"> 
        </td>
    <td class=DataLabel><div id=MedPracHeading></div></td>
    <td><div id=MedicalPrac></div></td></tr>

<tr><td class=DataLabel>End of Session Time</td>
    <td><input type=text size=8 name=otmas004 class=Readonly tabindex=14 
         readonly
         title="End of Session Time" maxlength=5 value="%OUTWEB05.04.104">
        </td>
    <td></td>
    <td></td></tr>

<tr><td class=DataLabel>Location Type</td>
    <td><select name=otmas037 tabindex=15 class=Readonly disabled>
         <option></option>
         %OUTWEB05.04.137.2 
         </select></td>
</tr>

<tr><td class=DataLabel>Clinic Phone Number</td>
    <td><input type=text name=othed032 tabindex=35
         title="Clinic Phone Number" class=Readonly disabled
         size=22 maxlength=20 value="%OUTWEB05.04.182"></td>
   </tr>

<tr><td class=DataLabel>Clinic Session</td>
    <td><input type=text name=otmas032 class=Readonly title="Clinic Session"
         readonly
         tabindex=17 size=8 readonly maxlength=8 value="%OUTWEB05.04.132">    
    <input type=text name=name_otmas032 class=Readonly title="Clinic Session"
      tabindex=18 size=16 maxlength=30 readonly value="%OUTWEB05.04.155">  
    </td>
    <td class=DataLabel>Hospital</td>
    <td><select name=otmas033 tabindex=19 class="Readonly SelectBig" 
         disabled title="Hospital">
         <option></option>
         %OUTWEB05.04.133.2 
         </select></td></tr>

<tr><td class=DataLabel>Discharge after DNA's </td>
    <td><input type=text size=2 maxlength=2 name=otmas024 tabindex=20
         class=Readonly readonly value="%OUTWEB05.04.124"></td>
    <td class=DataLabel>Days for Reappointment </td>
    <td><input type=text size=2 name=otmas025 maxlength=2 tabindex=21
         class=Readonly readonly value="%OUTWEB05.04.125"></td></tr>

<tr><td class=DataLabel>MR Location</td>
    <td><select name=otmas057 class="Readonly SelectBig" tabindex=22 
         disabled title="MR Location">
         <option></option>
         %OUTWEB05.04.164
         </select></td>
</tr>

<tr><td class=DataLabel>Enter Doctor Code</td>
    <td class=DataField><input type=checkbox name=otmas008 disabled
        title="Enter Doctor Code"></td>
    <td class=DataLabel><div id=defaultDrLabel></div></td>
    <td class=DataField><div id=defaultDrName></div></td>
</tr>

<tr><td class=DataLabel>Registrar's Clinic</td>
    <td><input type=checkbox name=otmas007  tabindex=23
         disabled  title="Registrar's Clinic" value=Y></td>
    <td class=DataLabel>Suppress Ext. Slot </td>
    <td><input type=checkbox name=otmas018  tabindex=24
         disabled title="Suppress Extended Slot Display" value=Y></td></tr>

<tr><td class=DataLabel>Active</td>
    <td><input type=checkbox name=otmas014 tabindex=25 title="Active" 
         disabled value="0">
    </td>

    <td class=DataLabel>Using Extra Screen When Attending</td>
    <td><input type=checkbox name=otmas021 tabindex=26 disabled 
         title="Using Extra Screen When Attending" value=Y></td>

<tr><td class=DataLabel>Using Medclaims</td>
    <td><input type=checkbox name=otmas059 disabled 
         tabindex=27 title="Using Medclaims" value="1">
         </td>
    <td class=DataLabel>Provider Number</td>
    <td><input type=text size=11 maxlength=10 name=otmas060  tabindex=28
         class=Readonly readonly
         title="Provider Number" value="%OUTWEB05.04.167"></td>
    </tr>

<tr><td class=DataLable>Default CMBS Item Template</td>
    <td><select name=otmas061 title="CMBS Item Template" tabindex=29
         class=Readonly disabled>
         <option></option>
         %OUTWEB05.04.168
         </select></td>

    <td><div id=LedgerHeading></div></td>
    <td><div id=LedgerField></div></td></tr>

<tr><td class=DataLabel>Room Number</td>
    <td><input type=text size=4 maxlength=3 name=otmas062  tabindex=31
         class=Readonly readonly value="%OUTWEB05.04.169"></td>

    <td><div id=CostHeading></div></td>
    <td><div id=CostField></div></td></tr>

<tr>
       <td class=DataLabel>Default Procedure</td>
       <td><input type=text size=9 maxlength=9 name=otmas094 
         class=Readonly readonly value="%OUTWEB05.04.199.013.0">
       <input type=text size=50 name=name_otmas094 title="Default Procedure"
         id=name_otmas094 class=Readonly readonly value="%OUTWEB05.04.199.013.1">

    <td class=DataLabel>Additional HCP</td>
    <td><input type=checkbox title="Additional HCP Providers" id=addHCPprov
               disabled=''></td>
<tr>
</tr>

<tr>
   <td colspan=2>&nbsp;</td>
   <td class=DataLabel><div id=addhcphead01label></div></td>
   <td class=DataField><div><span id=addhcphead01></span>
       <span id=addhcpname01></span></div></td>
</tr>
<tr>
   <td colspan=2>&nbsp;</td>
   <td class=DataLabel><div id=addhcphead02label></div></td>
   <td class=DataField><div><span id=hddhcphead02></span>
       <span id=addhcpname02></span></div></td>
</tr>

<tr>
   <td colspan=2>&nbsp;</td>
   <td class=DataLabel><div id=addhcphead03label></div></td>
   <td class=DataField><div><span id=addhcphead03></span>
       <span id=addhcpname03></span></div></td>
</tr>
<tr>
   <td colspan=2>&nbsp;</td>
   <td class=DataLabel><div id=addhcphead04label></div></td>
   <td class=DataField><div><span id=hddhcphead04></span>
       <span id=addhcpname04></span></div></td>
</tr>

</table>
<br>
<table cellspacing=0 cellpadding=0 width=100% >
<tr><td align=center>
    <input type=button value="Slot Template" class="button"  tabindex=37
   onclick='TemplateA04("%OUTWEB05.04.001","%OUTWEB05.04.012.1");'>
    <input type=button value="Suspend" class="button" tabindex=39
   onclick='SuspClnt04("%OUTWEB05.04.001","%OUTWEB05.04.012.1");'>
    <input type=button value="Clinic Master List" class="BigButton" tabindex=42
    onclick='ScheduleListA04("%OUTWEB05.04.001","%OUTWEB05.04.012.1");'>
    <input type=button value="Unsuspend" class="button" tabindex=43
   onclick='SuspendListA04("%OUTWEB05.04.001","%OUTWEB05.04.012.1","%OUTWEB05.04.101","%OUTWEB05.04.102");'>
    <input type=button value="Open List" class="button" tabindex=44
   onclick='OpenListA04("%OUTWEB05.04.001","%OUTWEB05.04.012.1");'>
</td></tr>
</form>
</table>
<script language="javascript">

function initCheck() {
if  ("%OUTWEB05.04.107" == "Y")
 { document.UpdateForm.otmas007.checked=1 }
if  ("%OUTWEB05.04.114" == "0")
 { document.UpdateForm.otmas014.checked=1 }
if  ("%OUTWEB05.04.118" == "Y")
 { document.UpdateForm.otmas018.checked=1 }
if  ("%OUTWEB05.04.121" == "Y")
 { document.UpdateForm.otmas021.checked=1 }
if  ("%OUTWEB05.04.166" == "1")
 { document.UpdateForm.otmas059.checked=1 }
if(document.UpdateForm.ibcnmhos.value!="1") {
   document.UpdateForm.otmas033.className="SelectBig"
 }

 //Update the enter Dr Code checkbox
 if ("%OUTWEB05.04.108" == "Y") {
   document.UpdateForm.otmas008.checked = 1;
 }

 displayStaticDefaultDrFields("%OUTWEB05.04.153");
 HCP = displayStaticHCPFields("%OUTWEB05.04.199.002",1);
 HCP = displayStaticHCPFields("%OUTWEB05.04.199.003",HCP);
 HCP = displayStaticHCPFields("%OUTWEB05.04.199.004",HCP);
 HCP = displayStaticHCPFields("%OUTWEB05.04.199.005",HCP);

}
</script>

<span id=medprachd style="display:none">
Medical Practice
</span>

<span id=medpraccd style="display:none">
  <select name=otmas065 title="Medical Practice"
   onchange="GetProv()">
  <option> </option>
   %OUTWEB05.04.172.1
  </select>
</span>

<span id=blanklabel style="display:none">&nbsp;</span>

<span id=LedgerHd style="display:none">
    Ledger
</span>

<span id=LedgerFld style="display:none">
     <select name=otmas063  title="Ledger" tabindex=30
     class=Readonly disabled>
     <option></option>
     %OUTWEB05.04.170.1
     </select>
</span>

<span id=LedgerFreeFormat style="display:none">
    <input type=text name=otmas063 size=4 tabindex=30
     title='Ledger' class=Readonly disabled
     value="%OUTWEB05.04.170.0">
</span>

<span id=CostHd style="display:none">
    Cost Centre
</span>

<span id=CostFld style="display:none">
      <input type=text name=otmas064 title="Cost Centre" tabindex=32
      class=Readonly readonly
      value="%OUTWEB05.04.171.0" size=12>
      <input type=text name=creddesc title="Cost Centre"
      class=Readonly readonly
      value="%OUTWEB05.04.171.1" size=35 tabindex=-1>
</span>

<span id=CostFreeFormat style="display:none">
    <input type=text name=otmas064 size=14 tabindex=32
     title='Cost Centre' class=Readonly disabled
     value="%OUTWEB05.04.171.0">
</span>

<span id=CostMandFld style="display:none">
    <input type=text name=otmas064 size=14 tabindex=32
     title='Cost Centre' class=Readonly disabled
     value="%OUTWEB05.04.171.0">
</span>

<span id=LedgerBlank style="display:none">
   <input type=hidden name=otmas063 value="%OUTWEB05.04.170.0">
</span>

<span id=CostBlank style="display:none">
   <input type=hidden name=otmas064 value="%OUTWEB05.04.171.0">
</span>

<span id=defaultDrHidden style="display:none">
   <input type=text name=otmas022 title="Default Doctor" size=6 maxlength=6
          value="%OUTWEB05.04.122" class="ReadOnly" disabled>
   <input type=text name=name_otmas022 class=Readonly readonly
          title="Default Doctor" size=27 maxlength=30 value="%OUTWEB05.04.153">
</span>

