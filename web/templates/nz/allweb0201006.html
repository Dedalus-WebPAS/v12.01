<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/TableSort.js></script>
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<script type="text/javascript" src="../js/allweb0201.js"></script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link          
//  1 - Patient Name              
//  2 - Sex                        
//  3 - DOB                       
//  4 - U/R
//  5 - Referral Date
//  6 - Healthcare Professional
//  7 - HCP Classification     
//  8 - Problem
//  9 - Priority
// 10 - List days
// 11 - Priority sort flag - indicator 1 cat PR
// 12 - Icon suffix indicator
// 13 - Active Referrals HTML Link
//---------------------------------------------------------------------------
function InitTable(TableView) {

   t = new Table(1,0,2,"100%","center");
   t.addColumn("Patient","ImageText",1,1,"left","PatientFolder","0",140,19);
   t.addColumn("Referral Date","Date",5,5,"left","","",40);
   t.addColumn("Healthcare Professional","String",6,6,"left","","",80);
   if(document.getElementById('dispctdl').value == "1") {
     t.addColumn(document.getElementById('hcpcdes1').value,"String",31,31,"left","","",50);
   }
   t.addColumn("Problem","String",7,7,"left","","",60);
   t.addColumn("Referral Comments","String",21,21,"left","","",100);
   if(document.Filter.alcndtrg.value=="1") {
     t.addColumn("Triage Status","String",27,27,"left","","",40)
   }
   t.addColumn("Priority","String",8,10,"center","","",40,"","","",25);
   t.addColumn("Outcome of Priority","String",23,23,"center","","",40);
   t.addColumn("List Days","String",9,9,"left","","",30);
   t.addColumn("Must Be Seen By Date","Date",20,20,"left","","",50);
   t.addColumn("Active Refs","Image",11,11,"left","ViewIcon","12",30,11);
   t.addColumn(MasterReferralDescription,"String",15,15,"left","","",30);
   t.addColumn("Preferred Site","String",17,17,"left","","",70);

   if (document.Filter.ovrdhosp.value == "1") {
      t.addColumn("Hospital","String",26,26,"left","","",50);
   }

   AddTableRows();
   if(document.Filter.alcndtrg.value=="1") {
     TableOutput(10,0);    // Order Column,Asc Dsc
     TableSort(9);
   }

   if((document.Filter.alcndtrg.value=="0") && 
      (document.getElementById("dispctdl").value=="1")) {
     TableOutput(9,1);    // Order Column,Asc Dsc
     TableSort(8);
   } else {
     TableOutput(8,1);    // Order Column,Asc Dsc
     TableSort(7);
   }
   
   adjustRowHeight();
}
//
function FilterSubmit() {
   Filter.submit();
}
//
function AddNewReferral(urn,adn,dpc) {
   AddReferral.doctcode.value=Filter.doctcode.value;
   Left=(document.body.clientWidth-900)/2;
   DFrameSubmit(AddReferral,0,Left,900,900);
}
function AddUserReferral() {
   if(isWhitespace(document.PatientLinks.wbsedall.value)) {
      alert("User does not have a default department.");
      return;
   }
   document.AddReferral.allrf001.value=document.PatientLinks.wbsedall.value;
   Left=(document.body.clientWidth-900)/2;
   DFrameSubmit(AddReferral,0,Left,900,900);
}
//
function UpdateReferral(urn,adn,dpc) {
   PatientLinks.urnumber.value=urn;
   PatientLinks.admissno.value=adn;
   PatientLinks.deptcode.value=dpc;
   PatientLinks.submit();
}
function ListReferral(urn) {
   linkUrl="allweb02.pbl?reportno=02&template=021" +
           "&urnumber=" + urn.replace(/ /g,"+");
   Left=(document.body.clientWidth-750)/2;
   DFrameLink(linkUrl,50,Left,750,900);
}
function HospitalFilter() {
  if(document.Filter.alcndhos.value=="1") {
     document.getElementById("HospTitle").innerHTML=
     document.getElementById("DisplayHospitalTitle").innerHTML;
     document.getElementById("HospField").innerHTML=
     document.getElementById("DisplayHospitalField").innerHTML;
     document.getElementById("SiteTitle").innerHTML=
     document.getElementById("DisplaySiteTitle").innerHTML;
     document.getElementById("SiteField").innerHTML=
     document.getElementById("DisplaySiteField").innerHTML;
     showAllHospOption();
  }
}

function showAllHospOption() {
  if(document.Filter.ovrdhosp.value != "1") {
    hosplist=document.getElementById('id_filthosp');
    hosplist.remove(0);
  }
}

function HCPClassFilter() {
     if(document.Filter.dispctdl.value=="1") {
       document.getElementById("HCPTitle").innerHTML=
       document.getElementById("DisplayHCPTitle").innerHTML;
       document.getElementById("HCPField").innerHTML=
       document.getElementById("DisplayHCPField").innerHTML;
      }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);HospitalFilter();HCPClassFilter();InitTable(0);
 setTimeout('SetClinicTypeList(document.Filter);',100);">
<div id="HeadingSection">
<div id="PHeadingSection">

<form name=PatientLinks action=allweb02.pbl method=get style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=2>
<input type=hidden name=urnumber>
<input type=hidden name=admissno>
<input type=hidden name=deptcode>
<input type=hidden name=wbsedall value="%STANDARD.01.028">
</form>

<form name=Filter action=allweb02.pbl method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=6>
<input type=hidden name=indexkey value="">
<input type=hidden name=usersite value="%STANDARD.01.023">
<input type=hidden name=wbseclid value="%STANDARD.01.026">
<input type=hidden name=defctype value="%ALLWEB02.01.028">
<input type=hidden name=deftclid value="%ALLWEB02.01.027">
<input type=hidden name=alcndhos value="%STANDARD.01.025.106.224.0.1">
<input type=hidden name=ovrdhosp value="%ALLWEB02.01.045">
<input type=hidden name=alcndtrg value="%STANDARD.01.025.121.125.0.1">
<input type=hidden name=dispctdl id=dispctdl value="%ALLWEB02.01.046">
<input type=hidden name=hcpcdes1 id=hcpcdes1 value="%ALLWEB02.01.048">
<table width=100% cellspacing=0 border=0 bgcolor=#cccccc>

<tr>
  <td>Department</td>
  <td>
    <select class=PMenuSelectList name=deptcode onchange="FilterSubmit();">
      <option></option>     
      %ALLWEB02.01.012
    </select>
  </td>
  <td class=DataLabel>HCP</td>
  <td>
    <input type=text name=doctcode value="%ALLWEB02.01.020.0"
     class=DataField size=10 maxlength=10
     onchange="UpCase(this);ValidateHCP(18,14,Filter.doctcode,
               Filter.psevt000,FilterSubmit);">
    <input type=text name=psevt000 title="Attending HCP" readonly
     size=24 value="%ALLWEB02.01.020.1">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="HCPSearchFrame(Filter.doctcode,Filter.psevt000,1,
              FilterSubmit);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(Filter.doctcode,Filter.psevt000,
              FilterSubmit);">
  </td>
  <td>Priority</td>
  <td>
    <select name=priority onchange="Filter.submit();">
      <option value="  ">All</option>
      %ALLWEB02.01.010.2
    </select>
  </td>
</tr>
<tr>
  <td class=DataLabel>Clinic Type</td>
  <td>
    <select name=filtctyp class=SelectBig
      onchange="SetClinicIDList(document.Filter);FilterSubmit();">
      <option value="  ">Select Clinic Type</option>
    </select>
  </td>
  <td class=DataLabel>Clinic ID</td>
  <td>
    <select name=filtclid onchange="FilterSubmit();" class=SelectBig>
      <option value="zzzzzz">Select Clinic ID</option>
    </select>
  </td>
  <td class=DataLabel>Case Team</td>
  <td>
    <input type=text name=filtteam size=10 maxlength=10 title="Case Team"
     value="%ALLWEB02.01.025.1"
     onblur="validateCode2(7,Filter.filtteam,Filter.n_filtteam,
             FilterSubmit);">
    <input type=text name=n_filtteam size=25 readonly class="Readonly"
     value="%ALLWEB02.01.025.0" tabindex=-1 title="Team Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="TeamSearchFrame(Filter.filtteam,Filter.n_filtteam,
              FilterSubmit);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(Filter.filtteam,Filter.n_filtteam,
              FilterSubmit);">
  </td>
</tr>
<tr>
  <td><div id="HospTitle"></div></td>
  <td><div id="HospField"></div></td>
  <td><div id="SiteTitle"></div></td>
  <td><div id="SiteField"></div></td>
  <td><div id="HCPTitle"></div></td>
  <td><div id="HCPField"></div></td>
</tr>
</table>
</form>
</div>

<form name=AddReferral method=get action=allweb02.pbl style="margin:0">
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=2>
<input type=hidden name=doctcode value="">

<table width=100% cellspacing=0 border=1>
<tr>
  <td colspan=2 align=right class=HeadingCell>Add Referral
    <input type=button class=SlimButton value="Add"
     title="Add referral for users department" onclick="AddUserReferral();">
    <select class=PMenuSelectList name=allrf001 
     onmouseover='MenuOver(event,this)' onchange="AddNewReferral();">
      <option></option>
      %ALLWEB02.01.012
    </select>
  </td>
</tr>
<tr>
  <td width=95% class=HeadingCell align=center> 
    %ALLWEB02.01.023.0  Referrals - On Waiting List
  </td> 
</tr>
</table>
</form>
</div>

<div id=DisplayHospitalTitle style="display: none">
<table align=center width=100% border=0 cellspacing=0>
<tr>
  <td>Preferred Hospital</td>
</tr>
</table>
</div>

<div id=DisplayHospitalField style="display: none">
<table align=center width=100% border=0 cellspacing=0>
<tr>
  <td>
    <select name=filthosp id="id_filthosp"
     onchange="FilterSubmit();">
      <option value="   ">All</option>
      %ALLWEB02.01.039
    </select>
  </td>
</tr>
</table>
</div>

<div id=DisplaySiteTitle style="display: none">
<table align=center width=100% border=0 cellspacing=0>
<tr>
  <td>Preferred Site</td>
</tr>
</table>
</div>

<div id=DisplaySiteField style="display: none">
<table align=center width=100% border=0 cellspacing=0>
<tr>
  <td>
    <select name=filtpsit onchange="FilterSubmit();">
      <option></option>
      %ALLWEB02.01.040
    </select>
  </td>
</tr>
</table>
</div>

<div id=DisplayHCPTitle style="display: none">
<table align=center width=100% border=0 cellspacing=0>
<tr>
  %ALLWEB02.01.048
</tr>
</table>
</div>

<div id=DisplayHCPField style="display: none">
<table align=center width=100% border=0 cellspacing=0>
<tr>
  <td>
    <select name=hcpclasf id="id_hcpclasf" onchange="Filter.submit();">
      <option value="  ">All</option>
      %ALLWEB02.01.047.2
    </select>
  </td>
</tr>
</table>
</div>

<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows(){
  %ALLWEB02.01.013.1
}
</script>
