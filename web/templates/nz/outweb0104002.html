<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nz">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/OutpatientSelect.js"></script>
<script type="text/javascript" src="../js/OutpatientTypeClinic.js"></script>
<script language=javascript>
function UpdateReferral() {
 document.UpdateForm.updttype.value="U";
 Submitpage=true;
  if(!isWhitespace(UpdateForm.otrfl030.value)) {
 if (SetDateYYYYMMDD(UpdateForm.otrfl001.value) > SetDateYYYYMMDD(UpdateForm.otrfl030.value)) {
 Submitpage=false;
 alert("Date Letter Recieved must be greater than or equal to Date of Letter");
  }
 }
 if(!isWhitespace(UpdateForm.otrfl031.value)) {
 if (SetDateYYYYMMDD(UpdateForm.otrfl001.value) > SetDateYYYYMMDD(UpdateForm.otrfl031.value)) {
 Submitpage=false;
 alert("Date of Priority must be greater than or equal to Date of Letter");
  }
 }
 if(Submitpage){  
  var Urnumber = UpdateForm.urnumber.value.replace(/ /g,"+");
  var Admissno = UpdateForm.admissno.value.replace(/ /g,"+");
  var Eocrdind = checkMaintainEOC();
  UpdateForm.redirect.value = "outweb01.pbl?reportno=4&template=7" +
             "&urnumber=" + Urnumber + "&admissno=" + Admissno +
             "&eocrdind=" + Eocrdind;
  UpdateForm.nextpage.value = 5;
  setRedirect();
  document.UpdateForm.submit();
 }
}
function setRedirect() {
  strTemplate="" ;
  scrName="";
  checkInd=document.UpdateForm.otrfl041.value.substr(3,5)
  if(checkInd.search(/W/g) >= 0) {
    strTemplate="005"; 
    scrName="WC";}
  if (strTemplate!="") {
    document.UpdateForm.redirect.value="patweb89.pbl?reportno=01" +
               "&template=" + strTemplate +
               "&urnumber=" + UpdateForm.urnumber.value.replace(/ /g,"+") +
               "&admissno=" + UpdateForm.admissno.value.replace(/ /g,"+") +
               "&systflag=2" +
               "&refrflag=1"
    document.UpdateForm.nextpage.value=6;
  }
}

function PrintReferral() {
  var Urnumber = UpdateForm.urnumber.value.replace(/ /g,"+");
  var Admissno = UpdateForm.admissno.value.replace(/ /g,"+");
  var Eocrdind = checkMaintainEOC();
  location.href = "outweb01.pbl?reportno=4&template=7" +
                  "&urnumber=" + Urnumber + "&admissno=" + Admissno +
                  "&eocrdind=" + Eocrdind;
}

function BookPatient() {
  top.content.PatientLinks.bookflag.value="1";
  top.content.PatientLinks.urnumber.value=document.UpdateForm.urnumber.value;
  top.content.PatientLinks.admissno.value=document.UpdateForm.admissno.value;
  PatientLinkTo("patweb98.pbl",1,1,0,0,0);
}
function checkMaintainEOC() {
  if (document.UpdateForm.chkbxeoc.checked == true)
    return 1;
  else
    return 0;
}
function SetList() {
  p=UpdateForm
  p.otrfl027.options.length=1;
  SetClinicType(p.otrfl027,p.defctype.value,p.otrfl003.value);
//
  SetList2();
}
function SetList2() {
  p=UpdateForm
  p.otrfl004.options.length=1;
  SetTypeClinic(p.otrfl004,p.deftclid.value,p.otrfl003.value,p.otrfl027.value);
}
</script>
%START.OF.PAGE
<body onload="PageLoad(event);setTimeout('SetList()',100);">
<span class=DFrameTitleBar>
<img border=0 align=right src=../images/ExitIcon.gif onclick=DFrameExit()>
Update Referral
</span>
<div id=PageBodySection style="overflow: auto;">
<form name=UpdateForm action=outweb01.pbl method=post style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value="%OUTWEB01.04.003">
<input type=hidden name=admissno value="%OUTWEB01.04.081">
<input type=hidden name=nextpage>
<input type=hidden name=updttype value="U">
<input type=hidden name=defctype value="%OUTWEB01.04.127.1">
<input type=hidden name=deftclid value="%OUTWEB01.04.104.1">
<input type=hidden name=redirect>

<table border=0 width="90%" cellspacing=0 cellpadding=2 align=center>
<tr><td class=DataLabel>Date of Letter</td>
    <td>
        <table border="0" cellspacing="0" cellpadding="0" width="100%"><tr>
        <td align="left">
        <input name=otrfl001 type=text title="Date of Letter" size=12 
         value="%OUTWEB01.04.101" class="BackDate" >
        <img src=../images/DateTimeStamp.gif class="Icon"
         alt="Set Today's Date" 
         onclick="SetCurrentDateTime(UpdateForm.otrfl001,null);">
        <img src=../images/CalendarLookup.gif class="Icon"
         alt="Set Date"
         onclick="DateLookupFrame(UpdateForm.otrfl001);">
        </td><td align="right">
        Referral Number&nbsp;&nbsp;
        <input type="text" size="7" value="%OUTWEB01.04.081" class="Readonly" readonly />
        </td></tr></table>
    </td></tr>

<tr><td class=DataLabel>Date Letter Received</td>
    <td><input name=otrfl030 type=text title="Date Letter Received" size=12 
         value="%OUTWEB01.04.130" class="BackDate" >
        <img src=../images/DateTimeStamp.gif class="Icon"
         alt="Set Today's Date" 
         onclick="SetCurrentDateTime(UpdateForm.otrfl030,null);">
        <img src=../images/CalendarLookup.gif class="Icon"
         alt="Set Date" 
         onclick="DateLookupFrame(UpdateForm.otrfl030);"></td></tr>

<tr><td class=DataLabel>Referral Source</td>
    <td><select name=otrfl028 tile="Referral Source">
        <option></option>
        %OUTWEB01.04.128.2 
        </select></td></tr>

<tr><td class=DataLabel>Referring HCP</td>
    <td><input type=text name=otrfl002 size=12 maxlength=10
         value="%OUTWEB01.04.102.001" 
         onblur="ValidateHCP(18,0,UpdateForm.otrfl002,
                             UpdateForm.name_otrfl002);">
        <input type=text name=name_otrfl002 size=22 maxlength=30
         class=Readonly readonly
         value="%OUTWEB01.04.102.081">
     <img src="../images/SearchIcon.gif" class=Icon alt="Search"
     onclick="HCPSearchFrame(UpdateForm.otrfl002,UpdateForm.name_otrfl002,0);">
        <img src="../images/ViewIcon.gif" class=Icon
         onclick="HCPViewFrame(UpdateForm.otrfl002.value);">
        <img src="../images/erase.gif" class=Icon alt="Erase"
         onclick="clrDoc(UpdateForm.otrfl002,UpdateForm.name_otrfl002);">
        </td></tr>

<tr><td class=DataLabel>Preferred Site</td>
    <td class=DataField><select name=otrfl003 title="Preferred Site"
                         onchange="SetList();">
                         <option></option>
              %OUTWEB01.04.103.2 </select></td></tr>

<tr><td class=DataLabel>Clinic Type</td>
    <td class=DataField><select name=otrfl027 title="Clinic Type"
                         onchange="SetList2();">
                        <option></option>
                        </select></td></tr>

<tr><td class=DataLabel>Clinic ID</td>
    <td class=DataField><select name=otrfl004 title="Clinic ID">
                        <option></option>
                        </select></td></tr>

<tr><td class=DataLabel>Reason for Referral</td>
    <td><select name=otrfl019 tile="Reason for Referral">
        <option></option>
<!--                           Cat."OF" Ind.1 = "R" for Reason for Referral -->
        %OUTWEB01.04.119.9.1.01.1.R
        </select></td></tr>

<tr><td class=DataLabel>Diagnosis/Problem</td>
    <td><input type=text name=otrfl006 id="otrfl006" maxlength="50" 
         size=50 value="%OUTWEB01.04.106"> </td></tr>

<tr><td class=DataLabel>Priority</td> 
    <td><select name=otrfl007 class=select150 
         onchange="SetCurrentDateTime(UpdateForm.otrfl031,null);">
                         <option></option>
              %OUTWEB01.04.107.2 </select></td></tr>

<tr><td class=DataLabel>Date of Priority</td>
    <td><input name=otrfl031 type=text size=12 title=Date class=BackDate
         value="%OUTWEB01.04.131" onblur="checkDate(this,'Date of Priority')">
        <img src=../images/DateTimeStamp.gif class="Icon"
         alt="Set Today's Date" 
         onclick="SetCurrentDateTime(UpdateForm.otrfl031,null);">
        <img src=../images/CalendarLookup.gif class="Icon"
         alt="Set Date" 
         onclick="DateLookupFrame(UpdateForm.otrfl031);"></td></tr>

<tr><td class=DataLabel>Prioritising HCP</td>
    <td><input type=text name=otrfl029 size=12 maxlength=10
         value="%OUTWEB01.04.129.001" 
         onblur="ValidateHCP(18,14,UpdateForm.otrfl029,
                             UpdateForm.name_otrfl029);">
        <input type=text name=name_otrfl029 size=22 maxlength=30
         class=Readonly readonly
         value="%OUTWEB01.04.129.081">
     <img src="../images/SearchIcon.gif" class=Icon alt="Search"
     onclick="HCPSearchFrame(UpdateForm.otrfl029,UpdateForm.name_otrfl029,1);">
        <img src="../images/ViewIcon.gif" class=Icon 
         onclick="HCPViewFrame(UpdateForm.otrfl029.value);">
        <img src="../images/erase.gif" class=Icon alt="Erase"
         onclick="clrDoc(UpdateForm.otrfl029,UpdateForm.name_otrfl029);">
     </td></tr>

<tr><td class=DataLabel>Claim Code</td>
    <td><select name=otrfl041 class=select150 >
                         <option></option>
              %OUTWEB01.04.154.2 </select></td></tr>

<tr><td class=DataLabel>Expected Purchaser</td>
    <td><select name=otrfl032 tile="Expected Purchaser">
        <option></option>
        %OUTWEB01.04.132.2
        </select></td></tr>

<tr><td class=DataLabel>Created By</td>
    <td class=DataField>%OUTWEB01.04.160 %OUTWEB01.04.158 %OUTWEB01.04.159
    </td></tr>

<tr><td class=DataLabel>Updated By</td>
    <td class=DataField>%OUTWEB01.04.157 %OUTWEB01.04.155 %OUTWEB01.04.156
    </td></tr>

<tr><td class=DataLabel>Maintain Episodes of Care</td>
    <td><input type=checkbox name=chkbxeoc value=1></td></tr>

<tr><td align=center colspan="2"><hr></td></tr>

<tr><td class=DataLabel>Cancellation Date</td>
    <td><input name=otrfl017 type=text  size=12 title=Date class=BackDate
         value="%OUTWEB01.04.117" onblur="checkDate(this,'Cancellation Date')">
        <img src=../images/DateTimeStamp.gif class="Icon"
         onclick="SetCurrentDateTime(UpdateForm.otrfl017,null);">
        <img src=../images/CalendarLookup.gif class="Icon"
         onclick="DateLookupFrame(UpdateForm.otrfl017);"></td></tr>

<tr><td class=DataLabel>Cancellation Reason</td>
    <td><select name=otrfl018 class=select150>
        <option></option>
        %OUTWEB01.04.118.9.1.01.2.E
        </select></td></tr>

<tr><td colspan=2 align=center>
    <input class="button" type="button" value="Update" 
     onclick='UpdateReferral();'>
    <input class="button" type="button" value="Print"
     onclick='PrintReferral();'>
    <input class="button" type="button" value="Delete"
     onclick="setFormactn('D');">
    <input class="button" type="button" value="Book"
     onclick='BookPatient();'>
    <input class="button" type="button" value="Cancel"
     onclick='DFrameExit();'></td></tr>
</table>
</form>
