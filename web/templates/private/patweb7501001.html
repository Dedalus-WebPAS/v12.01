<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="private">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/patweb7501001.js"></script>
<script type="text/javascript">
//=============================================================================
//        Function Calling Remote Scripting To Get MBS Description 
//=============================================================================
function GetDesc(ReturnCode,ReturnDesc,DateField,Quant,Ref,Sess,Amount,GstA,GstC,Iamnt,PatPr,RebPr,NZUnique,Strttim,Endtime){

  var code=ReturnCode.name;

  if ((isWhitespace(ReturnCode.value))&&(isWhitespace(ReturnDesc.value))) {
    return; 
  }
  var blankflag=false;
  for (var i=0; i < document.AddForm.length; i++) {
    if (document.AddForm.elements[i].name.match(/itemn/)) {
      if (isWhitespace(document.AddForm.elements[i].value)) {
        blankflag=true;   // Found a blank row set true
        break; }}}

  ReturnCode.value=ReturnCode.value.replace(/ /g,"")

  ReturnDesc.value="";
  if (isWhitespace(ReturnCode.value)) { return; }

  var serverURL = "../cgi-bin/patweb80.pbl?reportno=4" +
        "&valdcode=" + ReturnCode.value.replace(/ /g,"+") +
        "&returndt=" + DateField.value.replace(/ /g,"+") +
        "&valdadno=" + AddForm.admissno.value.replace(/ /g,"+") +
        "&valdedat=" + DateField.value.replace(/ /g,"+") +
        "&valdtype=1" +
        "&regimflg=1"

  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    ReturnDesc.value=trim(ReturnValue[0]);
    ReturnDesc.value=ReturnDesc.value.toUpperCase()

    Amount.value=ReturnValue[1];
    Iamnt.value=ReturnValue[1];          // amount for a single item
    justifyLeft(Amount);
    justifyLeft(Iamnt);

    PatPr.value=ReturnValue[12];
    RebPr.value=ReturnValue[13];
    GstA.value=ReturnValue[10];
    GstC.value=ReturnValue[11];

    ReturnCode.className="Mandatory";
    DateField.className="Date Mandatory";

    if (ReturnValue[7]==0||ReturnValue[7]==3) {
//    Sess.className="Integer";
      Sess.value=" "
      Sess.className="ReadOnly";
      Sess.readOnly=true;
      Strttim.disabled=true;
      Strttim.className="ReadOnly";
      Strttim.readOnly=true;
      Endtime.disabled=true;
      Endtime.className="ReadOnly";
      Endtime.readOnly=true;
    } else {
      Sess.className="Integer Mandatory";
      if ((Sess.value=="") || (Sess.value==" ")) {
        Sess.value="1";
      }
      Strttim.disabled=false;
      Strttim.className="";
      Strttim.readOnly=false;
      Endtime.disabled=false;
      Endtime.className="";
      Endtime.readOnly=false;
    }

    if (ReturnValue[7]==3) {
      Ref.value=" "
      Ref.className="ReadOnly";
      Ref.readOnly=true;
    }

    if (ReturnValue[2]==1) {
      ReturnDesc.className="Mandatory"; }
    else {
      ReturnDesc.className="ReadOnly";
      ReturnDesc.readOnly=true;
      Quant.focus();
    }

    if (ReturnValue[3]==1) {
      Amount.className="Number Mandatory"; }
    else {
      if (Iamnt.value==0 && ReturnValue[7]==0) {
        Amount.className="Number Mandatory"; }
      else {
        Amount.className="ReadOnly";
        Amount.readOnly=true; }
    }

// if the amount is zero and keyin amount is set to No, then No quantity.

    if ((ReturnValue[1]==0.00) && (ReturnValue[3]==0)) {
//      Quant.className="ReadOnly";
//      Quant.readOnly=true;
    } else {
        Quant.className="Integer"; }

    if (ReturnValue[4]==1) {
      alert("Warning: This is an Exclusion List Item.");
    }

    if (ReturnValue[5]==1) {
      alert("Warning: MBS Item has been changed.");
    }

    if (ReturnValue[6]==1) {
      alert("Warning: A Prosthetic may need to be entered.");
    }

    if (ReturnValue[8]==1) {
      i=ReturnValue[9];
      alert("Warning: Admission Type Should be " + i);
    }

    if (ReturnValue[8]==2) {
      alert("Warning: Invalid Suggested Admission Type.");
    }

    if (ReturnValue[8]==3) {
      alert("Warning: Item has been Entered in the Previous Invoice.");
    }

    if (ReturnValue[8]==4) {
      alert("Warning: Possible Admission Type Changed Required.");
    }

    if (ReturnValue[8]==5) {
      alert("Warning: Possible Admission Type Changed Required and Item " +
            "has been Entered in Previous Invoice.");
    }

    if (ReturnValue[8]==6) {
     i=ReturnValue[14];
     alert("Warning: Suggested Adm Type: " + i +
           " for this patient is excluded from " + "auto adm type update.");
    }

    if (blankflag) {
      FindBlank() //Re-entering an already entered code, so set focus.
      SetFocus()  // Set the focus
      document.AddForm.counter.value++;
    } else {
//    document.AddForm.counter.value++;
//    AddMBS();
      Quant.select();
    }

    if ((ReturnValue[3]==1)&&(ReturnValue[10]==2)) {
      Amount.className="ReadOnly";
      Amount.readOnly=true;
      window.GstA=GstA;
      window.GstC=GstC;
      window.Amount=Amount;
      window.Iamnt=Iamnt;
      window.PatPr=PatPr;
      window.RebPr=RebPr;
      window.Quant=Quant;
      linkURL="patweb75.pbl?reportno=01&template=004" +
              "&urnumber=" + AddForm.urnumber.value.replace(/ /g,"+") +
              "&admissno=" + AddForm.admissno.value.replace(/ /g,"+")

      Left=(document.body.clientWidth-350)/2
      DFrameLink(linkURL,0,Left,350,150)
      return;
    }

    if (ReturnValue[10]==2) {
      window.GstA=GstA;
      window.GstC=GstC;
      window.Quant=Quant;
      linkURL="patweb75.pbl?reportno=01&template=002" +
              "&urnumber=" + AddForm.urnumber.value.replace(/ /g,"+") +
              "&admissno=" + AddForm.admissno.value.replace(/ /g,"+")

      Left=(document.body.clientWidth-350)/2
      DFrameLink(linkURL,0,Left,350,120)
      return;
    }

    if (ReturnValue[3]==1) {
      Amount.className="ReadOnly";
      window.Amount=Amount;
      window.Iamnt=Iamnt;
      window.PatPr=PatPr;
      window.RebPr=RebPr;
      window.Quant=Quant;

      linkURL="patweb75.pbl?reportno=01&template=003" +
              "&urnumber=" + AddForm.urnumber.value.replace(/ /g,"+") +
              "&admissno=" + AddForm.admissno.value.replace(/ /g,"+")

      Left=(document.body.clientWidth-350)/2
      DFrameLink(linkURL,0,Left,350,120)
      return;
    }
  } else {
    ReturnCode.select();
  }
}
//------------------------------------------------------------------------
// Function : Fee Estimate Regime Search Frame
//------------------------------------------------------------------------
function RegimeSearchFrame(ReturnCode,ReturnName) {
  DFrameStart()
  SearchType="" ;
  window.ReturnFunction="" ;
  for (var i=2; i < RegimeSearchFrame.arguments.length; i++) {
    if (typeof(RegimeSearchFrame.arguments[i]) == 'function') {
      window.ReturnFunction=RegimeSearchFrame.arguments[i] }
    }         
              
  window.ReturnCode=ReturnCode ;
  window.ReturnName=ReturnName ;
  document.getElementById('PopUpFrame').src="../lookups/RegimeSearchFrame.html"
  SearchFrameShow()
}
function RegimeNext() {
  var CodeFld;
  var LastCodeFld;
  for (var i=0; i < document.AddForm.length; i++) {
    if (document.AddForm.elements[i].name.match(/itemn/)) {
      LastCodeFld=document.AddForm.elements[i];
      if (isWhitespace(document.AddForm.elements[i].value)) {
        CodeFld=document.AddForm.elements[i];
        break;
      }
    }
  }

  if (CodeFld==undefined||CodeFld==null) {
    CodeFld=LastCodeFld;
  }

  currentfield=CodeFld.name.substr(5,3);
  RegimeSearchFrame(CodeFld,AddForm.dummy,ValMBS);
}
function subItems() {
  document.AddForm.urnumber.value=
  document.AddForm.urnumber.value.replace(/ /g,"+");
  document.AddForm.admissno.value=
  document.AddForm.admissno.value.replace(/ /g,"+");
  SubmitHidden(AddForm);
}
function DisButton() {
  AddForm.PostButton.disabled=true;
  setTimeout('AddForm.PostButton.disabled=false',6000);
}
function loadOtherChargesCookie() {
  if (GetCookieData("OtherChargesCOOKIE")!="unknown") {
    ExpireCookiePath("OtherChargesCOOKIE");
    MiscNext();
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);setTimeout('AddMBS();loadOtherChargesCookie();',300);">
<div id=PageHeadingSection>
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
src="../images/ExitIcon.gif" onclick="DFrameExit();">
Input %STANDARD.01.025.112.001.0.9/Miscellaneous Items
</span>
</div>

<form  name=AddForm method=post action=patweb75.pbl style="margin:0">
<input type=hidden name=reportno value="1">
<input type=hidden name=template value="001">
<input type=hidden name=updatety value="A">
<input type=hidden name=urnumber value="%PATWEB75.01.003">
<input type=hidden name=admissno value="%PATWEB75.01.081">
<input type=hidden name=admisdat value="%PATWEB75.01.108">
<input type=hidden name=multhosp value="%PATWEB75.01.113">
<input type=hidden name=previtem value="%PATWEB75.01.105">
<input type=hidden name=visittyp value="%PATWEB75.01.111">
<input type=hidden name=nextpage value="0">
<input type=hidden name=cfeetyp value="%STANDARD.01.025.019.212.0.1">
<input type=hidden name=currdate value="">
<input type=hidden name=redirect value="%PATWEB75.01.001.patweb71.01.001">
<input type=hidden name=currentfld> 
<input type=hidden name=regimecode> 
<input type=hidden name=sjogfocs>

<table width=100% border=0 cellpadding=0 cellspacing=0>
    <tr><td class=HeadingCell>
        <img src="../images/ProcedureSearchIcon.gif" class=Icon
    onclick='javascript:MbsProNext(AddForm.admisdat);'>%STANDARD.01.025.112.001.0.9</td>
        <td class=HeadingCell>
        <img src="../images/ProcedureSearchIcon.gif" class=Icon
         onclick='javascript:MiscNext();'>Miscellaneous</td>
        <td class=HeadingCell>
        <img src="../images/ProcedureSearchIcon.gif" class=Icon
         onclick='javascript:RegimeNext();'>Regime</td>
        <td class=HeadingCell width="25%">Counter
        <input type=text name=counter id=counter size=2 maxlength=3 Readonly></td>
    </tr>
</table>

<div id=PageBodySection>
<table width=100% border=0 cellpadding=0 cellspacing=0>
<tr><td>
<table width=100% border=1 align=center cellpadding=0 cellspacing=0>
<tr bgcolor=#CCFFFF>
    <td width=15%><b> Date </b></td>
    <td width=10%><b> Item </b></td>
    <td><b> Description </b></td>
    <td width=5%><b> Quantity </b></td>
    <td width=11%><b> Reference </b></td>
    <td width=5%><b> Session </b></td>
    <td width=10%><b> Start time </b></td>
    <td width=10%><b> End Time </b></td>
    <td width=12%><b> Amount </b></td></tr>
</table>
</td></tr>

<tr><td><div id=RecordCoding></div></td></tr>

<tr><td>
<table align=center width=95% border=0>
    <tr><td colspan=2 align=center><br>
    <input type=button value="Ok" class="button" name=PostButton
     id=PostButton
     onclick="tempDisable(this);DisButton();subItems();">
    <input type=button value="Cancel" class="button" 
     onclick="DFrameClose();">
    </td></tr>
</table>
</td></tr>
</table>
</div>
</form>
