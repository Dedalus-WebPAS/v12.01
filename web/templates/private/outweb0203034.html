Content-Type: text/html
Cache-Control: no-cache

<!DOCTYPE html> 
<head>	
<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="private">
<meta name="TemplateFile"    content="outweb0203034.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../html/ipad/ipad.js"> </script>
<script type="text/javascript" src="../html/ipad/ipadform.js"> </script>
<script type="text/javascript" src="../html/ipad/AutoSuggestionPopup/AutoSuggestionPopup.class.js"></script>
<link   rel="stylesheet" href="../html/ipad/ipad.css" type="text/css">
<link   rel="stylesheet" href="../html/ipad/AutoSuggestionPopup/AutoSuggestionPopup.css" type="text/css">
<script type="text/javascript">
var SearchJSON = new Object();
function setButtons() {
  theForm=document.UpdateForm
  for (i=0; i<theForm.elements.length; i++) {
    el=theForm.elements[i]
    if (el.type=="text")  el.value=trim(el.value);
    if (el.type=="textarea"){
      el.value=el.value.replace(/ *$/gm,'');
      el.value=el.value.replace(/^(\r\n)|(\n)$/gm,'');
    }
  }
  srchperd=top.getCookie("outweb0203035-srchperd");
  el=document.getElementById("srchperd");
  for (var i=0;i<el.options.length;i++) {
    if (srchperd==el.options[i].value) { el.selectedIndex=i; }
  }
  
  var actionBtn = parent.document.getElementById('actionButton');
  if(actionBtn) {
    actionBtn.className = actionBtn.className.replace(/SpanButton/g,"");
    actionBtn.className = actionBtn.className.replace(/Blue/g,"");
    actionBtn.className = actionBtn.className + " SpanButtonBlue";
    actionBtn.innerText = "Save";
    actionBtn.onclick = function() { submitUpdate() }
  }
  ShowAppointments();
}
function submitUpdate() {
  var bool = validateMandatory(UpdateForm);
  if(bool) {
    theURL=document.UpdateForm.action;
    var postStr=AJAXPostString2(document.UpdateForm)
    var xmlHttp = createHttpObject();
    xmlHttp.open("POST", theURL, false);
    xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    xmlHttp.send(postStr);
    if (xmlHttp.status=="200") {
      if (xmlHttp.responseText.match(/PROCESSING|OK/i)) {
        parent.document.location.reload();
      }
      else {
        alertify.alert(xmlHttp.responseText.replace(/.*alert../i,"").replace(/.\).*/i,""));
      }
    }
    else {
      alertify.alert("Web Service Not Available. Check your Connection and Try Again.");
    }
  }
  return bool
}
function PrinterMandatory(CheckBox,SelectList) {
  if (CheckBox.checked) {
    SelectList.className="Mandatory" }
  else {
    SelectList.className="" }
}
function ShowAppointments() {
  SearchJSON = new Object();
  var ListLocation = document.getElementById("SearchResults");
  el = document.getElementById("startnum");
  var startnum=el.value.replace(/ /g,"+");
  el = document.getElementById("clinicty");
  var clinicty=el.value.replace(/ /g,"+");
  el = document.getElementById("clinicid");
  var clinicid=el.value.replace(/ /g,"+");
  el = document.getElementById("visittyp");
  var visittyp=el.options[el.selectedIndex].value.replace(/ /g,"+");
  el = document.getElementById("srchtime");
  var srchtime=el.options[el.selectedIndex].value.replace(/ /g,"+");
  el = document.getElementById("srchperd");
  var srchperd=el.options[el.selectedIndex].value.replace(/ /g,"+");
  el = document.getElementById("srchdate");
  var srchdate="";
  if (el.selectedIndex>0) srchdate=el.options[el.selectedIndex].value.replace(/ /g,"+");
  var SelectOptionStartDate=new Date();
  var FirstAppointment=""
  top.setCookie("outweb0203035-srchperd",srchperd.replace(/\+/g," "));
  var url   = "outweb01.pbl?reportno=2&template=5&norecord=20&srchflag=1"+
              "&startnum="+ startnum +
              "&clinicid="+ clinicid +
              "&clinicty="+ clinicty +
              "&srchperd="+ srchperd +
              "&srchdate="+ srchdate +
              "&visittyp="+ visittyp +
              "&srchtime="+ srchtime ;
  var xmlHttp = createHttpObject();
  xmlHttp.open('GET',url,true);
  xmlHttp.send();
  xmlHttp.onreadystatechange = function() {
    if (xmlHttp.readyState == 4) {
      if (xmlHttp.status == 200) {
        SearchJSON = eval("("+xmlHttp.responseText+")"); //convert text to javascript object
        if (SearchJSON.length==0) {
          ListLocation.innerHTML = "<ul class='sectionList'>"+
                                   "<li class='sectionItem' style='text-align:center'>"+
                                   "No Available Appointments Found</li></ul>";
          return;
        }
        var OS2="<ul class='sectionList'> ";
        for(var i =0; i < SearchJSON.length; i++) {
          if (FirstAppointment=="") FirstAppointment=SearchJSON[i].code;
          OS2 += "<li class=sectionItem onclick=\"AddAppointment("+i+");\" />"+ SearchJSON[i].value +
                 "<br /><span class=subText>"+SearchJSON[i].clinic + 
                                      " - " + SearchJSON[i].type +
                                      " - " + SearchJSON[i].visit + 
                 "</span></li>";
        }
        ListLocation = document.getElementById("SearchResults");
        ListLocation.innerHTML = OS2+"</ul>";
      } else {
        alertify.alert("Web Service Call Failed Error : "+xmlHttp.status);
      }
    }
    if (FirstAppointment!="") {
      var setDay=FirstAppointment.substr(18,2);
      var setMonth=parseInt(FirstAppointment.substr(16,2),10)-1;
      var setYear=FirstAppointment.substr(12,4);
      SelectOptionStartDate = new Date(setYear,setMonth,setDay,0,0,0);       // midnight
    }
    el = document.getElementById("srchdate");
    el.options.length=1;
    dateSelectionList(el,SelectOptionStartDate,"84")
  }
}
function AddAppointment(objectNo) {
  document.UpdateForm.newslotk.value=SearchJSON[objectNo].code;
  document.UpdateForm.clindesc.value=SearchJSON[objectNo].clinic;
  document.UpdateForm.clindate.value=SearchJSON[objectNo].value;
  el=document.UpdateForm.outbb047;
  var visittyp=SearchJSON[objectNo].type;
  for (var i=0;i<el.options.length;i++) {
    if (visittyp.substr(0,3)==el.options[i].value.substr(0,3)) { el.selectedIndex=i; }
  }
  reserveSlot(SearchJSON[objectNo].code,"","","",UpdatePage);
}
function dateSelectionList(el,StartDate,noDays) {
  var theDay;
  var weekday=new Array(7);
  weekday[0]="Sun";
  weekday[1]="Mon";
  weekday[2]="Tue";
  weekday[3]="Wed";
  weekday[4]="Thu";
  weekday[5]="Fri";
  weekday[6]="Sat";
  for (var i=0;i<noDays;i++) {
     theDay = new Date(StartDate.getTime()+(i*24*60*60*1000));
     dayVal = "0"+theDay.getDate();
     mthVal = "0"+(theDay.getMonth()+1);
     dayVal=dayVal.substr(dayVal.length-2,2);
     mthVal=mth3Name(mthVal.substr(mthVal.length-2,2));
     dateVal = dayVal+' ' + mthVal + ' ' +  theDay.getFullYear();
     dateName=weekday[theDay.getDay()] + ' ' + dateVal;
     el.options[el.options.length]=new Option(dateName,dateVal);
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="setButtons();">
<ul class=sectionList>
  <li class=sectionItem>
  <div style='text-align:center;font-family:Arial;'>
  %OUTWEB02.03.002
  (%OUTWEB02.03.019,  %OUTWEB02.03.020,  %OUTWEB02.03.021, %OUTWEB02.03.003) <br />
  </div>
  </li>
</ul>
<form action=outweb02.pbl method=post name=UpdateForm>
<input type=hidden name=reportno value="4">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="PROCESSING|OK">
<input type=hidden name=updatety value="4">
<input type=hidden name=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=casekeys value="%OUTWEB02.03.366">
<input type=hidden name=defclnty value="%OUTWEB02.03.308" id=clinicty>
<input type=hidden name=defclnid value="%OUTWEB02.03.303.0" id=clinicid>
<input type=hidden name=defvisty value="%OUTWEB02.03.310.1">
<input type=hidden name=clinctyp value="%OUTWEB02.03.605.1">
<input type=hidden name=dumdate value="">
<input type=hidden name=dumInput value="">
<input type=hidden name=clinindc value="%OUTWEB02.03.628">
<input type=hidden name=dateclin value="%OUTWEB02.03.304">
<input type=hidden name=refrwarn value="%OUTWEB02.03.630">
<input type=hidden name=refrexpr value="%OUTWEB02.03.631">
<input type=hidden name=refrdate value="%OUTWEB02.03.632">
<input type=hidden name=ibcnumci value="%STANDARD.01.025.000.132.0.1">
<input type=hidden name=otmaumci value="%OUTWEB02.03.634">
<input type=hidden name=startnum id=startnum value=0>
<input type=hidden name=valddate>
<input type=hidden name=datefrom>
<input type=hidden name=dateto>
<input type=hidden name=follflag value="1">
<input type=hidden name=othendps value="%OUTWEB02.03.658">
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden name=slotbtyp value="3">
<input type=hidden name=d_addslotk value="%OUTWEB02.03.674">
<input type=hidden name=d_addslotk_desc value="%OUTWEB02.03.675.3">
<input type=hidden name=d_addslotk_date value="%OUTWEB02.03.675.2">
<input type=hidden name=d_addslotk_vtype_c value="%OUTWEB02.03.675.5.3">
<input type=hidden name=d_addslotk_othendps value="%OUTWEB02.03.675.6.035">
<input type=hidden  name=newslotk value="%OUTWEB02.03.366">


<table border="0" cellspacing=0 cellpadding=1 width=100%>
<tr valign=top>
<td>
<ul class=sectionList>
  <li class=sectionItem>
  <span class="labelText">Clinic</span>
  <span class="sectionText">
    <input type=text size=40  readonly name=clindesc class=Mandatory value="%OUTWEB02.03.303.1">
    <input type=text size=40  readonly name=clindate class=Mandatory>
  </span></li>
  <li class=sectionItem>
  <span class="labelText">Visit Type</span>
  <span class="sectionText">
    <select name=outbb047 title="Visit Type" class="Mandatory"
     onchange="SendLetter03(UpdateForm);"> 
    <option></option>
    %OUTWEB02.03.329
    </select>
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Claim Type</span>
  <span class="sectionText">%OUTWEB02.03.321.0
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Comment</span>
  <span class="sectionText">
  <textarea name=outptcom wrap=hard cols=40 rows=4 >%OUTWEB02.03.377</textarea>
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Presenting Complaint</span>
  <span class="sectionText">
  <input type=text name=pmsvx052 size=40 maxlength=50 value="%OUTWEB02.03.852">
  </span></li>

  <li class=sectionItem>
  <span class="labelText">Diagnosis</span>
  <span class="sectionText">
   <input type=hidden id=outbb045 name=outbb045 value="%OUTWEB02.03.364">
   <input type="text" size="40" id="outbb046" name="outbb046"
    placeholder="Diagnosis" class="searchFormInput"
    searchType="6" returnId="outbb045" onfocus="this.value='';"
    value="%OUTWEB02.03.365" onkeyup="AutoSuggest();">

   <input type=hidden id=outbb055 name=outbb055 value="%OUTWEB02.03.379">
   <input type="text" size="40" id="outbb056" name="outbb056"
    placeholder="Diagnosis" class="searchFormInput"
    searchType="6" returnId="outbb055" onfocus="this.value='';"
    value="%OUTWEB02.03.380" onkeyup="AutoSuggest();">

   <input type=hidden id=outbb057 name=outbb057 value="%OUTWEB02.03.381">
   <input type="text" size="40" id="outbb058" name="outbb058"
    placeholder="Diagnosis" class="searchFormInput"
    searchType="6" returnId="outbb057" onfocus="this.value='';"
    value="%OUTWEB02.03.382" onkeyup="AutoSuggest();">

   <input type=hidden id=outbb059 name=outbb059 value="%OUTWEB02.03.383">
   <input type="text" size="40" id="outbb060" name="outbb060"
    placeholder="Diagnosis" class="searchFormInput"
    searchType="6" returnId="outbb059" onfocus="this.value='';"
    value="%OUTWEB02.03.384" onkeyup="AutoSuggest();">

  </span></li>

  <li class=sectionItem>
  <span class="labelText">Source of Referral</span>
  <span class="sectionText">
  <select name=outbb001 title="Source of Referral">
  <option></option>
  %OUTWEB02.03.320.2
  </select>
  </span></li>


  <li class=sectionItem>
  <span class="labelText">Unit</span>
  <span class="sectionText">
    <select name=outbb022 class=SelectBig title="Unit">
    <option></option>
       %OUTWEB02.03.341.2
    </select>
  </span></li>
  <li class=sectionItem>
  <span class="labelText">Patient Follow Up Letter</span>
  <span class="sectionText">
    <input type=checkbox value=1 name=letprt01
         onClick="PrinterMandatory(this,UpdateForm.letpsl01)">
  </span></li>
  <li class=sectionItem>
  <span class="labelText">Printer</span>
  <span class="sectionText">
    <select class="" name=letpsl01 title="Printer">
	    <option></option>
        %STANDARD.01.001.LETTROUT.01
  	 </select>
  </span></li>
  <li class=sectionItem>
  <span class="labelText">Send Letter</span>
  <span class="sectionText">
    <select name=outbb067 title="Send Letter" onchange="SendLetterDate03(UpdateForm);">
        <option></option>
        <option value="0">No</option>
        <option value="1">Yes</option>
        <option value="2">N/A</option>
        </select>
  </span></li>
  <li class=sectionItem>
  <span class="labelText">Generate Letter Date</span>
  <span class="sectionText">
    <input type=text name=outbb066 size=12
     onblur="checkDate(this,'Date')" value=""
     class="Date" title="Generate Letter Date">
  </span></li>


</form>
</ul>
<form name=SearchForm method=get>
  </td>
  <td width=35%>
  <ul class=sectionList>
    <li class='sectionItem' style='text-align:center'>
    <b >Appointment Search</b><br>
    <select name=visittyp style='width:250px;margin-bottom:10px;'
     onchange='ShowAppointments()' id=visittyp title='Visit Type'>
    <option value="">Select Visit Type</option>
    %OUTWEB02.03.329
    </select>
    <select name=srchperd style='width:250px;margin-bottom:10px;'
     onchange='ShowAppointments()' id=srchperd title='Next Appoinment'>
     <option value="   ">After Today</option>
     <option value="01D">Tomorrow</option>
     <option value="02D">After 2 days</option>
     <option value="03D">After 3 days</option>
     <option value="04D">After 4 days</option>
     <option value="05D">After 5 days</option>
     <option value="06D">After 6 days</option>
     <option value="01W">After 1 week</option>
     <option value="02W">After 2 weeks</option>
     <option value="03W">After 3 weeks</option>
     <option value="04W">After 4 weeks</option>
     <option value="05W">After 5 weeks</option>
     <option value="06W">After 6 weeks</option>
     <option value="07W">After 7 weeks</option>
     <option value="08W">After 8 weeks</option>
     <option value="01M">After 1 month</option>
     <option value="02M">After 2 months</option>
     <option value="03M">After 3 months</option>
     <option value="04M">After 4 months</option>
     <option value="05M">After 5 months</option>
     <option value="06M">After 6 months</option>
     <option value="07M">After 7 months</option>
     <option value="08M">After 8 months</option>
     <option value="09M">After 9 months</option>
     <option value="10M">After 10 months</option>
     <option value="11M">After 11 months</option>
     <option value="12M">After 12 months</option>
    </select>
    <select name=srchtime style='width:250px;margin-bottom:10px;'
     onchange='ShowAppointments()' id=srchtime title='Preferred Time'>
     <option value="00:0024:00">Any Time</option>
     <option value="07:0012:00">Morning</option>
     <option value="12:0018:00">Afternoon</option>
     <option value="18:0024:00">Evening</option>
     <option value="07:0010:00">7am to 10am</option>
     <option value="16:0020:00">4pm to 8pm</option>
     <option value="12:0014:00">Lunch Time</option>
    </select>
    <select name=srchdate style='width:250px;margin-bottom:10px;'
     onchange='ShowAppointments()' id=srchdate title='Available on or After'>
    <option value="">Appointments on or After</option>
    </select>
    </li>
  </ul>
  <div id=SearchResults></div>
  </td>
  </tr>
  </table>
<div id='-suggestion-panel-wrapper' style='display:none;'>
 <div id='-suggestion-panel-wrapper2' style='width:100%'>
  <ul id='-suggestion-table' style='width:100%'></ul>
 </div>
</div>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=admissno value="%OUTWEB02.03.081">
<input type=hidden name=MenuType value="%OUTWEB02.03.088">
<input type=hidden name=casekeys value="%OUTWEB02.03.366">
</form>
</body>

