<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="private">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/preadmission.js"></script>
<script type="text/javascript" src="../js/ReportStandard.js"></script>

<script type="text/javascript">
function SubmitAdm() {
  if(document.UpdateForm.mvmedre1.checked == true) {
     document.UpdateForm.mvmedrec.value="1";
  } else {
     document.UpdateForm.mvmedrec.value="0";
  }
  MandatoryOk=true;
  if  (!validateMandatory(UpdateForm)) {
      return;
  }
  p=document.UpdateForm
  validateSuspension(p.urnumber,p.ptmis001,p.datefrom,p.dateto);
  if(p.datefrom.value!='0'){
    if(p.admitbox.value=="1"){
       document.UpdateForm.admitbox.value="0";
       ans=confirm("Warning : Patient has a Suspension record for period \n" +
             "\t" + p.datefrom.value  + " - " + p.dateto.value + "\n" +
             "\tPatient will not be admitted");
       }else{
       ans=confirm("Warning : Patient has a Suspension record for period \n" +
             "\t" + p.datefrom.value  + " - " + p.dateto.value);}
       if (ans!=true) {
          return;
       }
  }
  if (!isWhitespace(UpdateForm.ptmis013.value)) {
      if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
                          UpdateForm.funddesc,UpdateForm.tabldesc)) {
         ans=confirm("Select another active health fund table? ");
         if (ans==true) {
            return;
         }
      }
  }
  if (MandatoryOk) {
    setRedirect();
    UpdateForm.ptmis004.value=UpdateForm.ptmis068.value;
    checkPrevPRFA();
    if (!CheckValidGPAndPractice()) {
      return;
    }
    CheckPrevDefDetail();
    SubmitHidden(UpdateForm);
   }
}
function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
  selectOptions("30",UpdateForm.ptmis007,UpdateForm.ptmis024);
 UpdateForm.ptmis024.selectedIndex=1
}
function AdmitMandatory() {
 if(document.UpdateForm.admitbox.checked == true) {
     document.UpdateForm.admitbox.value="1";
     UpdateForm.ptmis011.className="Mandatory";  //admission type
     UpdateForm.ptmis009.className="Mandatory";  //admission source
     UpdateForm.ptvis041.className="Mandatory";  //criteria for admission
     UpdateForm.ptmis012.className="Mandatory";  //care type
     UpdateForm.ptmis068.className="Mandatory";  //ward
     UpdateForm.ptmis005.className="mandatory";  //bed
     UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor description
     UpdateForm.ptmis024.className="Mandatory";  //Unit
     UpdateForm.ptmis027.className="Mandatory";  //Financial Class
     UpdateForm.ptmis010.className="Mandatory";  //CMBS Class
     UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
  } else {
     document.UpdateForm.admitbox.value="0";
     UpdateForm.ptmis011.className="";  //admission type
     UpdateForm.ptmis009.className="";  //admission source
     UpdateForm.ptvis041.className="";  //criteria for admission
     UpdateForm.ptmis012.className="";  //care type
     UpdateForm.ptmis068.className="";  //ward
     UpdateForm.ptmis005.className="";  //bed
     UpdateForm.ptmis007.className="";  //Admitting Doctor
     UpdateForm.doctnam2.className="";  //Admitting Doctor description
     UpdateForm.ptmis024.className="";  //Unit
     UpdateForm.ptmis027.className="";  //Financial Class
     UpdateForm.ptmis010.className="";  //CMBS Class
     UpdateForm.ptvis043.className="";  //Intended Stay
  }
//  defaultMoveMedRec(document.UpdateForm.admitbox,document.UpdateForm.mvmedre1);
//  UpdateForm.ptmis001.focus();
}

function valReferGP(){
   p=document.UpdateForm;
   if (!isWhitespace(p.ptvis028.value)) {
      ReadDoc(18,0,p.ptvis028,p.doctnam1,p.ptvis029,p.genpprac,p.ptvis030,p.genpprov);
   }
}

function MyHealthRec() {
  document.getElementById('MyhealthRecLabel').innerHTML=DescriptionPCEHR;
  document.UpdateForm.ptvis115.title=DescriptionPCEHR;
}
function CheckValidGPAndPractice() {
  p=document.UpdateForm;
  var check=false;


  if (isWhitespace(trim(document.UpdateForm.ptvis028.value)) &&
      isWhitespace(trim(document.UpdateForm.ptvis029.value))) {
    return true;
  }

  var serverURL = "../cgi-bin/comweb81.pbl?reportno=38" +
                  "&valddctr="+p.ptvis028.value.replace(/ /g,"+") +
                  "&valdcode="+p.ptvis029.value.replace(/ /g,"+");

  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value;
    if (ReturnValue != "0") {
      alert("ERROR: PMI GP/GP Practice not valid.\n"+
            "Please update via PMI");
    } else {
      check=true;
    }
  }
  return check;
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);
              document.UpdateForm.ptmis001.focus();
              DisplayTrnSrc();
              defaultWard();
              DisplayContract();
              setHF();
              valReferGP();
              MyHealthRec();
              ShowActiveProgramID();displayRegime();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form name=UpdateForm id=UpdateForm method=post action=patweb89.pbl
 style="margin:0">
<input type=hidden name=reportno id=reportno value="2">
<input type="hidden" name="updatety" id="updatety" value="1">
<input type="hidden" name="redirect" id="redirect"
 value="%PATWEB89.01.001.patweb98.01.001">
<input type=hidden name=urnumber id=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno id=admissno value="%PATWEB89.01.101">
<input type="hidden" name="allocate" id="allocate" value="1">
<input type="hidden" name="chckname" id="chckname" value="0">
<input type="hidden" name="emradmit" id="emradmit" value="0">
<input type="hidden" name="emradmis" id="emradmis" value="0">
<input type="hidden" name="admitnow" id="admitnow" value="1">
<input type="hidden" name="newbmand" id="newbmand" value="0">
<input type="hidden" name="agebmand" id="agebmand" value="0">
<input type="hidden" name="ptmis004" id="ptmis004" value="0">
<input type="hidden" name="ptmas046" id="ptmas046" value="0">
<input type="hidden" name="mvmedrec" id="mvmedrec">
<input type="hidden" name="prevdeta" id="prevdeta" value="1">
<input type="hidden" name="cfinan" id="cfinan" value="%PATWEB89.01.932">
<input type="hidden" name="exstward" id="exstward" value="%PATWEB89.01.449.1">
<input type="hidden" name="prevprfa" id="prevprfa"
 value="%PATWEB89.01.999.045. 1">
<input type="hidden" name="prprfad1" id="prprfad1"
 value="%PATWEB89.01.999.045. 2">
<input type="hidden" name="prprfad2" id="prprfad2"
 value="%PATWEB89.01.999.045. 3">
<input type="hidden" name="prprfsub" id="prprfsub"
 value="%PATWEB89.01.999.045. 4">
<input type="hidden" name="prprfpos" id="prprfpos"
 value="%PATWEB89.01.999.045. 5">
<input type="hidden" name="prprfad4" id="prprfad4"
 value="%PATWEB89.01.999.045. 6">
<input type="hidden" name="prprfrel" id="prprfrel"
 value="%PATWEB89.01.999.045. 7">
<input type="hidden" name="prprfnam" id="prprfnam"
 value="%PATWEB89.01.999.045. 8">
<input type="hidden" name="datefrom" id="datefrom">
<input type="hidden" name="dateto" id="dateto">
<input type=hidden name=ptcndigp id=ptcndigp
 value="%STANDARD.01.025.124.122.0.1">
<input type=hidden name=ptcndumh id=ptcndumh
 value="%STANDARD.01.025.124.240.0.1">
<input type="hidden" name="dummy" id="dummy">
<input type=hidden name=copypdef  id=copypdef  value="0">

<table border=1 colspan=1 width=100% cellspacing=1 cellpadding=1 >
<tr><td class=HeadingCell align=center>
    Patient Pre-Admission Details(from Inpatient Details)
</td><tr>

<tr><td>
      <table border=0 width=100% class=TableBody cellpadding=0 cellspacing=0>
     <tr><td>&nbsp;</td><td>&nbsp;</td>
         <td align=left><b>Admit Now?</b></td>
        <td align=left>
        <input type="checkbox" name="admitbox" id="admitbox" value="0"
           onclick='AdmitMandatory();'>
        </td></tr>
        <tr><td class=DataLabel>Admission Date</td>
            <td class=DataLabel><input type="text" size="12" tabindex=1
             name=ptmis001 id=ptmis001 value="%STANDARD.01.015" class=Mandatory 
             title="Admission Date" onblur="checkDate(this,'Admission Date')">
            <img src="../images/DateLookup.gif" class=Icon
             onclick="DateLookupFrame(UpdateForm.ptmis001);"> 
             Time <input type=text name=ptmis002 id=ptmis002 tabindex=2 size=8
                   value="%STANDARD.01.016" class=Mandatory title="Admission 
                    Time">
            <img src="../images/DateTimeStamp.gif" class=Icon 
             onclick="SetCurrentDateTime(null,UpdateForm.ptmis002);">
            <img src="../images/TimeLookup.gif" class=Icon
             onclick="TimeLookupFrame(UpdateForm.ptmis002);"> 
            </td>
       <td>Admitting Point</td>
       <td><select name=ptvis046 id=ptvis046 tabindex=13
            onchange="defaultWard()">
           <option></option>
            %PATWEB89.01.290.2
           </select>
           <input type=hidden name='ptvis047' id='ptvis047' size=3>
       </td></tr>
      <tr><td class=DataLabel>%STANDARD.01.017.P </td>
          <td><select name=ptmis011 id=ptmis011 tabindex=3  
               title="%STANDARD.01.017.P ">
              <option> </option>
                 %PATWEB89.01.112.2
              </select></td>
        <td class=DataLabel>Ward / Bed </td>
       <td>
         <input type=hidden name=bedstat1 id=bedstat1>
         <input type=hidden name=warddesc id=warddesc>
         <select name=ptmis068 id=ptmis068 tabindex=13 title="Ward">
         <option> </option>
            %PATWEB89.01.449.2
         </select>
         <input type=text name=ptmis005 id=ptmis005 maxlength=3 size=3 
                title="Bed">
         <img src="../images/SearchIcon.gif" class=Icon
          onclick="WardBedSearchFrame(UpdateForm.ptmis068,
                                      UpdateForm.warddesc,
                                      UpdateForm.ptmis005,
                                      UpdateForm.bedstat1);">

       </td></tr>
        <tr><td class=DataLabel>Admission Source</td>
            <td><select name=ptmis009 id=ptmis009 tabindex=3
                 onchange="DisplayTrnSrc()" 
                 class=SelectBig>
                <option> </option>
                %PATWEB89.01.110.2
               </select>
            </td>
           <td class=DataLabel>Admitting Doctor</td>
            <td>
               <input type="text" size=8 maxlength=6 name="ptmis007"
                 id="ptmis007" tabindex=13
                 value="%PATWEB89.01.108.003" 
                 title='Admitting Doctor'
                 onblur="UpCase(this);valDoctorUnit();">
               <input type=text readonly size=25 name=doctnam2 id=doctnam2
                 value="%PATWEB89.01.108.002">
               <img src="../images/SearchIcon.gif" class=Icon
                 onclick="DoctorSearchFrame(UpdateForm.ptmis007,
                                            UpdateForm.doctnam2)"></td></tr>
         <tr>
          <td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>
          <td class=DataLabel>Unit</td>
           <td><select name=ptmis024 id=ptmis024 tabindex=14
               title='Unit'>
               <option> </option>
                %PATWEB89.01.124.2
               </select>
           </td><tr>
         <tr><td align=left>Prior Days Hospitalisation</td>
          <td><input type=text name=ptmis031 id=ptmis031 
            title='Prior Days Hospitalisation'
            class=Integer size=5 maxlength=4 tabindex=5
            onblur="checkInteger(this,this.title)" value="%PATWEB89.01.130">
         </td>
         <td class=DataLabel>Diagnosis </td>
         <td><input type=text name="ptmis020" id="ptmis020"
              size=50 maxlength=80 tabindex=15
              value="%PATWEB89.01.121"></td></tr>
       <tr><td>Mode of Arrival</td>
       <td><select name=ptvis054 id=ptvis054 tabindex=6>
           <option></option> %PATWEB89.01.257.2
           </select></td>
       <td class=DataLabel>Provisional DRG</td>
       <td><input type=text name=ptmis066 id=ptmis066 size=5 maxlength=4
            tabindex=16
            onblur='validateCode(5,UpdateForm.ptmis066,UpdateForm.drgdesc1)'
            value="%PATWEB89.01.140.0">
           <input type=text notab readonly name=drgdesc1 id=drgdesc1 size=35 
            value="%PATWEB89.01.140.1">
           <img src="../images/SearchIcon.gif" class=Icon
            onclick="DrgSearchFrame(UpdateForm.ptmis066,UpdateForm.drgdesc1)">
       </td></tr>
       <tr><td class=DataLabel>Criteria for Admission</td>
           <td><select name=ptvis041 id=ptvis041 tabindex=7 
                title="Criteria for Admission" class=SelectBig>
               <option> </option>
                %PATWEB89.01.244.2
               </select>
               </td>
           <td class=DataLabel> Diet Code </td>
       <td><select name=ptmis028 id=ptmis028 tabindex=17>
           <option> </option>
            %PATWEB89.01.127.2
           </select></td></tr>
       <tr><td class=DataLabel>Care Type</td>
            <td><select name=ptmis012 id=ptmis012 tabindex=8 class=SelectBig
                 onchange="displayRegime();">
              <option> </option>
               %PATWEB89.01.113.2
            </select>
        <td class=DataLabel>Referring GP</td>
        <td>
        <input type=hidden name=genpprac id=genpprac>
        <input type=hidden name=ptvis029 id=ptvis029 value="%PATWEB89.01.232.1">
        <input type=hidden name=ptvis030 id=ptvis030 value="%PATWEB89.01.233.1">
        <input type=hidden name=genpprov id=genpprov>
        <input type="text" size=10 maxlength=8 tabindex=17
         name=ptvis028 id=ptvis028 value="%PATWEB89.01.231.1"
         onchange="ReadDoc(18,
                           0,
                           UpdateForm.ptvis028,
                           UpdateForm.doctnam1,
                           UpdateForm.ptvis029,
                           UpdateForm.genpprac,
                           UpdateForm.ptvis030,
                           UpdateForm.genpprov);">
        <input type="text" size=25 readonly name=doctnam1 id=doctnam1
         value="%PATWEB89.01.231.0">
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="GPHCPSearchFrame(UpdateForm.ptvis028,
                                   UpdateForm.doctnam1,
                                   UpdateForm.genpprov,
                                   UpdateForm.ptvis029,
                                   UpdateForm.genpprac,
                                   UpdateForm.ptvis030,
                                   0);">
      </td>
    </tr>
          <tr><td class=DataLabel>Intended Stay </td>
          <td><select name=ptvis043 id=ptvis043 tabindex=9 title="Intended Stay">
          <option> </option>
          %PATWEB89.01.246.2
          </select>
          </td>
           <td class=DataLabel>Inform GP</td>
          <td><select name=ptvis022 id=ptvis022 tabindex=19 title="Inform GP" >
              <option value=" "></option>
              <option value="0">No</option>
              <option value="1">Yes</option>
              </select></td></tr>
       <tr><td class=DataLabel> Planned Length of Stay</td>
        <td>
        <input type=text size=5 maxlength=3 name=ptmis030 id=ptmis030
         tabindex=9  title='Expected Length of Stay' value="%PATWEB89.01.129"
         class=Integer onblur="checkInteger(this,this.value);">
        </td>
           <td class=DataLabel>Religious Visit</td>
       <td><select name=ptmis017 id=ptmis017 tabindex=20>
           <option> </option>
           <option value="0">No</option>
           <option value="1">Yes</option>
           </select>
       </td></tr>
       <tr><td class=DataLabel>Discharge Intention</td>
          <td><select name=ptvis076 id=ptvis076 tabindex=10 
              title="Discharge Intention"> 
              <option> </option>
               %PATWEB89.01.292.2
              </select></td>
       <td>Valuables Location</td>
      <td><input type="text" size=40 maxlength=40 name=ptvis020 id=ptvis020 
           tabindex=21 value="%PATWEB89.01.223">
         </td></tr>

       <tr><td class=DataLabel>Palliative Care Status</td>
          <td><select name=ptvis077 id=ptvis077 tabindex=11 title="Care Type"> 
              <option> </option>
               %PATWEB89.01.293.2
              </select></td>
      <td class=DataLabel>Program</td>
      <td><input type=text size=8 maxlength=8 name=ptvis099 id=ptvis099
           title="Program" tabindex=21 value="%PATWEB89.01.298.021.1"
           onchange="findPrgmdesc();">
          <select name=prgmcode id=prgmcode Readonly class=readonly tabindex=166
           onchange="savePrgmcode();">
          <option> </option>
           %PATWEB89.01.298.021.2
          </select></td>
       </tr>

    <tr><td>3B Days of hospitalisation</td>
      <td>
      <input type=text name=ptmis082 id=ptmis082
       title='3B No. days of hospitalisation'
       class=Integer size=5 maxlength=4 tabindex=12 value="%PATWEB89.01.199.015"
       onblur="checkInteger(this,this.title)">
      </td>
      <td><div id=MyhealthRecLabel 
           title="Consent to upload Episode documents/results to MyHR"></div>
      </td>
        <td><select name=ptvis115 id=ptvis115 tabindex=21>
            <option value=" "></option>
            <option value="1">Yes</option>
            <option value="0">No</option>
            </select></td>
    </tr> 

    <tr><td class="DataLabel"><div id="ProgramIdTitle"></div></td>
        <td class="DataField"><div id="ProgramIdField"></div></td>
        <td class="DataLabel"></td>
        <td class="DataField"></td>
        <td class="DataLabel"></td>
        <td class="DataField"></td>
        </tr>

   <tr align=left><td align=center colspan="4"><hr></td></tr>
 
   <tr align=left><td class=DataLabel>%STANDARD.01.017.CL</td>
       <td align=left><select name=ptmis027 id=ptmis027 tabindex=23 
         title="%STANDARD.01.017.CL" onchange="setHF();">
         <option> </option>
         %PATWEB89.01.126.9.1.10.2.X
         </select>
         </td>

      <td class=DataLabel>Casepayment</td>
      <td>
        <select name=ptmis075 id=ptmis075 tabindex=27>
        <option value="0">No</option>
        <option value="1">Yes</option>
        </select></td></tr>

       <tr><td class=DataLabel>%STANDARD.01.017.A </td>
           <td><select name=ptmis010 id=ptmis010 tabindex=23 
                 title="%STANDARD.01.017.A " onchange="DisplayContract();">
                <option> </option>
                 %PATWEB89.01.111.2
                </select>

      <td class=DataLabel>Casemix Code</td>
      <td class=DataLabel>
      <input type=text name=ptmis073 id=ptmis073 size=10 maxlength=9
       tabindex=28 value=""
       onblur='validateCode(35,UpdateForm.ptmis073,UpdateForm.cmixdesc1)'>
      <input type=text notab readonly name=cmixdesc1 id=cmixdesc1 size=35
       value="">
      <img notab src="../images/SearchIcon.gif" class=Icon
       onclick="CmixSearchFrame(UpdateForm.ptmis073,UpdateForm.cmixdesc1)">
      </td></tr>

<tr>
    <td class=DataLabel>Health Fund </td>
    <td colspan=2><input type=text size=6 maxlength=6 name=ptmis013 id=ptmis013
     title="Health Fund" tabindex=23
     onchange="validateCode(16,UpdateForm.ptmis013,UpdateForm.funddesc);
               checkTableadm();"
     value="%PATWEB89.01.114.0">
    <input type=text size=25 maxlength=30 name=funddesc id=funddesc
     class=readonly Readonly notab value="%PATWEB89.01.114.1">
    Level
        <input name="ptmis014" id="ptmis014" size=8 maxlength=8
         tabindex=24 value="%PATWEB89.01.115.0"
         title="Level"
         onblur="validateHFT(20,
                             UpdateForm.ptmis013,
                             UpdateForm.ptmis014,
                             UpdateForm.funddesc,
                             UpdateForm.tabldesc);">
        <input type="text" size=15 maxlength=17 name="tabldesc" id="tabldesc"
         class=readonly Readonly notab value="%PATWEB89.01.115.1" >
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HealthFundSearchFrame(UpdateForm.ptmis013,
                                        UpdateForm.funddesc,
                                        UpdateForm.ptmis014,
                                        UpdateForm.tabldesc);">
        <img src="../images/erase.gif" class=Icon
         onclick="clrDoc(UpdateForm.ptmis013,UpdateForm.ptmis014);
                  clrDoc(UpdateForm.funddesc,UpdateForm.tabldesc);
                  checkTableadm();">
    </td>
</tr>

    <tr align=left><td class=DataLabel>Member Number &nbsp; </td>
        <td class=DataLabel>
        <input type=text size=20 maxlength=19 
        value="%PATWEB89.01.116" name='ptmis015' id='ptmis015' tabindex=24></td>
        <td align=left>Move Medical Record</td>
        <td align=left>
        <input type="checkbox" name="mvmedre1" id="mvmedre1" value="1"
         tabindex=29>
        </td></tr>

<tr><td class=DataLabel>Continuous Billing</td>
    <td><select name=ptmis081 id=ptmis081 tabindex=25>
        <option> </option>
         %PATWEB89.01.199.014.2
        </select>
    </td>
</tr>

  <tr><td class=DataLabel>GST Applicable</td>
      <td><select name=ptmis074 id=ptmis074 tabindex=26>
          <option> </option>
           %PATWEB89.01.189.2
          </select>
        </td>
        <td class=DataLabel><div id=Contrac2Heading></div></td>
        <td><div id=ContractId></div></td>
      </tr>

     <tr><td class=DataLabel><div id=ContractHeading></div></td>
          <td><div id=ContractType></div></td>
          <td class=DataLabel><div id=Contrac1Heading></div></td>
          <td><div id=ContractRole></div></td>
     </tr>

  <tr><td class=DataLabel></td>
      <td></td>
      <td><div id=RegimeHead1></div></td>
      <td><div id=RegimeCode1></div></td></tr>

  <tr><td class=DataLabel></td>
      <td></td>
      <td><div id=RegimeHead2></div></td>
      <td><div id=RegimeCode2></div></td></tr>

  <tr><td class=DataLabel></td>
      <td></td>
      <td><div id=RegimeHead3></div></td>
      <td><div id=RegimeCode3></div></td></tr>

    <tr align=left><td align=left> </td>
        <td align=left> </td>
    <tr align=left>
       <td colspan=4 align=center><br>
       <input type=button value="Ok" class="button" tabindex=100
        id="pat89sub"
        onclick="tempDisable(this);
                 checkBedStatus(UpdateForm.ptmis068.value,
                                UpdateForm.ptmis005.value,
                                UpdateForm.ptmis001.value,
                                UpdateForm.ptmis030.value,
                                SubmitAdm);">
       <input tabindex=101 type=button value="Cancel" class="button"
             onclick="PatientLinkTo('patweb98.pbl',1,1,0);">
    </table></td></tr>

</table>
</form>
</div>

<form name=linkForm id=linkForm action=patweb89.pbl method=post>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.101">
</form>

<form name=PatientLinks id=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
<input type=hidden name=MenuType value="%PATWEB89.01.088">
</form>

<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 id=ptmis058 tabindex=18
         onblur="checkDate(this,'ReferralDate')">
        <img notab src="../images/DateLookup.gif" class=Icon
         onclick="DateLookupFrame(UpdateForm.ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
    <td><input type=text size=12 name=ptmis059 id=ptmis059 tabindex=19
         onblur="checkDate(this,'SpecConDate')">
        <img notab src="../images/DateLookup.gif" class=Icon
         onclick="DateLookupFrame(UpdateForm.ptmis059);"></td></tr>
</table>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr>
  <td class=DataLabel width=37%>Admission Weight</td>
  <td>
   <input type=text name=ptmis051 id=ptmis051 size=5 maxlength=4 tabindex=20>grams</td></tr>
</table>
</span>

<span id=NewBorn style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
  <td><input type=text name=ptmis041 id=ptmis041 maxlength=3 size=4 tabindex=21> weeks
    </td></tr>
</table>
</span>

<script type="text/javascript">
 if ("%PATWEB89.01.905" == "1") {
  alert("Warning: Patient is currently admitted");
 }
 if ("%PATWEB89.01.908" == "1") {
  alert("Warning: Patient has a pre-admission record");
 }

</script>
<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</span>
<span id=transfersrc style="display:none">
 <td><input type="text" size=7 maxlength=5 name=trnsfsrc id=trnsfsrc
      class=Mandatory
      title="Transfer Source" tabindex=5
      value="%PATWEB89.01.193.0"
      onchange="validateCode(9,UpdateForm.trnsfsrc,UpdateForm.trandesc);">
     <input type=text size=27 name=trandesc id=trandesc notab
      class=Readonly readonly value="%PATWEB89.010193.1">
     <img src="../images/SearchIcon.gif" class=Icon
      onclick="TransferSourceFrame(UpdateForm.trnsfsrc,UpdateForm.trandesc)">
 </td>
</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc id=trnsfsrc>
</span>
<span id=contracthd style="display:none">
Contract Type
</span>

<span id=contracrhd style="display:none">
Contract Role
</span>

<span id=contracihd style="display:none">
 Contract Id
</span>

<span id=contractid style="display:none">
  <select name=ptasf003 id=ptasf003 title="Contract Spoke Id" class=Mandatory tabindex=26>
  <option> </option>
   %PATWEB89.01.199.003.0
  </select>
</span>

<span id=contracttype style="display:none">
  <input type="text" name=ptasf001 id=ptasf001 size=2 maxlength=1  class=Mandatory
   value="%PATWEB89.01.199.001" tabindex=27
   title="Contract Type"
   onblur="ContType(this);">
   <img src="../images/SearchIcon.gif" class=Icon
   onclick="ContTypeAlert();">
</span>

<span id=contractrole style="display:none">
  <input type="text" name=ptasf002 id=ptasf002 size=2 maxlength=1 class=Mandatory
   value="%PATWEB89.01.199.002" tabindex=28
   title="Contract Role"
   onblur="ContRole(this);">
   <img src="../images/SearchIcon.gif" class=Icon
   onclick="ContRoleAlert();">
</span>

<span id=blanklabel style="display:none">&nbsp;</span>

<span id="ShowProgramIdTitle" style="display:none">
 %STANDARD.01.035.PK
</span>

<span id="ShowProgramIdField" style="display:none">
  <select name=ptvis110 id=ptvis110 title="%STANDARD.01.035.PK" tabindex=12
   class="">
    <option> </option>
    %STANDARD.01.007.PK
  </select>
</span>

<span id=regimehd1 style="display:none">
<td class=DataLabel>Regime Code 1</td>
</span>
<span id=regimecod1 style="display:none">
<td><input type="text" size=15 maxlength=10
     name=ptrgm001 tabindex=29
     onblur="validateCode(75,UpdateForm.ptrgm001,UpdateForm.dummy);"
     value="%PATWEB89.01.973. 1">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(UpdateForm.ptrgm001,UpdateForm.dummy);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.ptrgm001,UpdateForm.dummy);">
</td>
</span>

<span id=regimehd2 style="display:none">
<td class=DataLabel>Regime Code 2</td>
</span>
<span id=regimecod2 style="display:none">
<td><input type="text" size=15 maxlength=10
     name=ptrgm002 tabindex=29
     onblur="validateCode(75,UpdateForm.ptrgm002,UpdateForm.dummy);"
     value="%PATWEB89.01.973. 2">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(UpdateForm.ptrgm002,UpdateForm.dummy);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.ptrgm002,UpdateForm.dummy);">
</td>
</span>

<span id=regimehd3 style="display:none">
<td class=DataLabel>Regime Code 3</td>
</span>
<span id=regimecod3 style="display:none">
<td><input type="text" size=15 maxlength=10
     name=ptrgm003 tabindex=29
     onblur="validateCode(75,UpdateForm.ptrgm003,UpdateForm.dummy);"
     value="%PATWEB89.01.973. 3">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(UpdateForm.ptrgm003,UpdateForm.dummy);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.ptrgm003,UpdateForm.dummy);">
</td>
</span>

<span id=regimeblank1 style="display:none">
<td><input type=hidden name=ptrgm001 value=""></td>
</span>

<span id=regimeblank2 style="display:none">
<td><input type=hidden name=ptrgm002 value=""></td>
</span>

<span id=regimeblank3 style="display:none">
<td><input type=hidden name=ptrgm003 value=""></td>
</span>

<script type="text/javascript">
function init() {

RelVisit="%PATWEB89.01.118.1"
 if(RelVisit=="Yes"){
    RelVisit="1"
  }
 if(RelVisit=="No "){
    RelVisit="0";
  }
  for (var i =0 ; i < document.UpdateForm.ptmis017.length; i++) {
    if (document.UpdateForm.ptmis017.options[i].value==RelVisit.substr(0,1)) {
       document.UpdateForm.ptmis017.selectedIndex=i } };
}

CasePaym="%PATWEB89.01.197.1"
  if(CasePaym=="Yes"){
    CasePaym="1"
  }
 if(CasePaym=="No "){
    CasePaym="0";
  }
  for (var i =0 ; i < document.UpdateForm.ptmis075.length; i++) {
    if (document.UpdateForm.ptmis075.options[i].value==CasePaym.substr(0,1)) {
       document.UpdateForm.ptmis075.selectedIndex=i } };

MergePsy="%PATWEB89.01.050"
  if(MergePsy=="Yes"){
    document.UpdateForm.ptmas046.value="1"
  }
 if(MergePsy=="No "){
    document.UpdateForm.ptmas046.value="0"
  }

GPValue="%PATWEB89.01.225.0";
 for (var i =0 ; i < document.UpdateForm.ptvis022.length; i++) {
  if (document.UpdateForm.ptvis022.options[i].value==GPValue.substr(0,1)) {
     document.UpdateForm.ptvis022.selectedIndex=i } };

MyHealthRecVisit=trim("%PATWEB89.01.298.037");
  for (var i =0 ; i < document.UpdateForm.ptvis115.length; i++) {
   if (document.UpdateForm.ptvis115.options[i].value == MyHealthRecVisit) {
       document.UpdateForm.ptvis115.selectedIndex=i } };

var p = document.UpdateForm;
if((p.ptvis022.value!="0")&&(p.ptvis022.value!="1")){
    DefaultInformGP(p.ptvis022,p.ptcndigp.value);}      // inform gp default
if((p.ptvis115.value!="0")&&(p.ptvis115.value!="1")){
    DefaultMYHR(p.ptvis115,p.ptcndumh.value);}      // upload myhr default

//Inform GP - Set mandatory/non-mandatory
if (p.ptcndigp.value > 2){
    p.ptvis022.className="Mandatory";}
else{
    p.ptvis022.className="";}

//Upload myhr - Set mandatory/non-mandatory
if (p.ptcndumh.value > 2){
    p.ptvis115.className="Mandatory";}
else{
    p.ptvis115.className="";}

</script>
