<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="wahealth">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript">
function SelectPatient(emexp001, emexdelt, ETSLocFlg) {
  f = document.UpdateForm;
  f.emexp001.value = emexp001.replace(/ /g,"+")
  f.template.value = "041";
  f.deftview.value = SelectPeriod.deftview.value;

  if (emexdelt == "0") {  // Deleted
    f.template.value = "042";
  }

  if (ETSLocFlg == '1') {
    f.etsvisfl.value = "1";  // set ETS visit flag
  }

  SetCookie("EACRedirectCookie",location.href); 
  f.submit();
}
function setTriage(emexp001, ETSLocFlg) {
  f = document.UpdateForm;
  SetCookie('ExpAdvConCookie','');
  SetCookie('EACTrgCookie',location.href);
  f.formactn.value="SP"
  if (ETSLocFlg == '1') {
    f.template.value = "013";
  }
  else {
    f.template.value = "012";
  }
  f.emexp001.value = emexp001.replace(/ /g,"+")
  f.submit()
}
function ShowCurrentPatient() {
  SetCookiePath("ExpectedPatientListURL");
  Path=GetContentCookie("CurrentPatientListURL");
  if (isWhitespace(Path) || Path=="unknown") {
    linkurl = "emrweb01.pbl?reportno=1&template=032";
  }
  else {
    linkurl = Path;
  }
  location.href = linkurl;
}
function ShowAttendanceList() {
  SetCookiePath("ExpectedPatientListURL");
  Path=GetContentCookie("AttendanceListURL");	  
  if (isWhitespace(Path) || Path=="unknown") {    
    linkurl = "emrweb01.pbl?reportno=2&template=004";    
  }	
  else {    
    linkurl = Path;	
  }	
  location.href = linkurl;
}
function PatientAlerts(URNo) {
  linkurl="patweb98.pbl?reportno=1&template=003" +
          "&urnumber=" + URNo
  location.href=linkurl
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTableFirstTime();">
<div id=HeadingSection>
<form name=SelectPeriod action=emrweb01.pbl method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=49>
<input type=hidden name=viewtype id=viewtype value="%EMRWEB01.01.052">
<input type=hidden name=deftview id=deftview value="%EMRWEB01.01.086">
<input type=hidden name=contfilt id=contfilt value="%EMRWEB01.01.075">
<input type=hidden name=tmethdsc id=tmethdsc
 value="%STANDARD.01.017.EA">

<table border=0 width=100% cellpadding=3 bgcolor=#CCCCCC>
  <tr>
    <td width=10%>
     <img src="../images/TableViewIcon.gif" class=Icon
      alt="Default View" title="Default View"
      onclick='ViewChanged("0");'>
     <img src="../images/TableViewIcon.gif" class=Icon
      alt="View 1" title="View 1"
      onclick='ViewChanged("1");'>
    </td>
    <td id=RemovedPat width=15%>
      Include Removed Patients
      &nbsp;&nbsp;&nbsp;
      <input type=checkbox name=remofilt id=remofilt 
       title="Include Removed Patients"
       value="1" onclick="SelectPeriod.submit();">
    </td>
    <td id=View0 width=25%>
      Contact Type
      &nbsp;&nbsp;&nbsp;
      <select name=d_contfilt id=d_contfilt class="SelectMed"
       onchange="ContactFilterChanged();">
       <option value=" ">All</option>
       <option value="1">Expected</option>
       <option value="2">Advice</option>
       <option value="3">Contact</option>
      </select>
    </td>
    <td align=right>
      <input type=button value="Current Pts" class=button
        name=btnCurrp id=btnCurrp
        onclick="tempDisable(this);ShowCurrentPatient();">
      <input type=button value="Attendance List" class=Bigbutton
        name=btnAttLst id=btnAttLst
        onclick="tempDisable(this);ShowAttendanceList();">
    </td>
    <td width=10%>
    </td>
    <td align=right id=CalendarSel>
      <input type=button value="<<" 
        onclick='location.href="%EMRWEB01.01.068";'
        class=SmallButton>
        %EMRWEB01.01.069
      <input type=button value=">>"
        onclick='location.href="%EMRWEB01.01.067";'
        class=SmallButton>
      <a href='javascript:SelectDateFrame();'>
      <img src="../images/DateLookup.gif" class=Icon 
        alt="Select Date"></a>
      <a href='javascript:SelectView("0");'>
      <img src="../images/DayIcon.gif" class=Icon
        alt="View Today"></a>
      <a href='javascript:SelectView("1");'>
      <img src="../images/WeekIcon.gif" class=Icon
        alt="View This Week"></a>
      <a href='javascript:SelectView("2");'>
      <img src="../images/MonthIcon.gif" class=Icon
        alt="View This Month"></a>
    </td>
  </tr>
</table>
</form>
</div>
<div id=TableLocation></div>
<script type="text/javascript">
function InitTableFirstTime() {
  f = document.SelectPeriod;
  var deftview = f.deftview.value;

  InitTable(deftview);
}
function InitTable(deftview) {
  f = document.SelectPeriod;
  f.deftview.value=deftview;

  if (deftview==0) {
    document.getElementById('RemovedPat').style.display = "";
    document.getElementById('CalendarSel').style.display = "";
  }
  else {
    document.getElementById('RemovedPat').style.display = "none";
    document.getElementById('CalendarSel').style.display = "none";
  }

  document.title="Expected Patient, Advice, Contact List "
  t = new Table(1,0,2,"100%","center",30,70);    // Create New Table Object
//
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column,Align
//
  switch (deftview) {
  case "0": {
   t.addColumn("Notified Date","DateTime",34,34,"center","","",50)
   t.addColumn("Contact Type","String",35,42,"left","","",40)
   t.addColumn("Removal Reason","String",36,36,"left","","",40)
   t.addColumn("Patient","String",2,2,"left","PatientFolder.gif","0",90)
   t.addColumn("Presenting Complaint","String",37,37,"left","","",90)
   t.addColumn("ETA","DateTime",33,33,"left","","",50)
   t.addColumn("Accepting Source","String",28,28,"left","","",50)
   t.addColumn(SelectPeriod.tmethdsc.value,"String",39,39,"left","","",40)
   t.addColumn("Transfer Source","String",40,40,"left","","",55)
   t.addColumn("Created By","String",41,41,"left","","",40)
   t.addColumn("Arrive & Triage","IconLink","","","center nowrap","MaintenanceIcon.gif","38",40)
   AddTableRows(); 
   t.sortTable(5,1);
   TableOutput(1,1);
   break;
  }
  case "1": {
   t.addColumn("Notified Date","DateTime",34,34,"center","","",50)
   t.addColumn("Contact Type","String",35,42,"left","","",40)
   t.addColumn("Patient","String",2,2,"left","PatientFolder.gif","0",90)
   t.addColumn("Presenting Complaint","String",37,37,"left","","",90)
   t.addColumn("ETA","DateTime",33,33,"left","","",50)
   t.addColumn("Accepting Source","String",28,28,"left","","",50)
   t.addColumn(SelectPeriod.tmethdsc.value,"String",39,39,"left","","",40)
   t.addColumn("Transfer Source","String",40,40,"left","","",55)
   t.addColumn("Created By","String",41,41,"left","","",40)
   t.addColumn("Arrive & Triage","IconLink","","","center nowrap","MaintenanceIcon.gif","38",40)
   AddTableRows();
   t.sortTable(4,1);
   TableOutput(1,1);
   break;
  }
  }
}
function AddTableRows() {
  %EMRWEB01.01.074
}
function ContactFilterChanged() {
  f = document.SelectPeriod;
  i = document.getElementById("d_contfilt").selectedIndex;
  f.contfilt.value = document.getElementById("d_contfilt").options[i].value;
  f.submit();
}
function ViewChanged(deftview) {
  f = document.SelectPeriod;
  f.deftview.value = deftview;
  f.submit();
}

f = document.SelectPeriod;
for (var i=0; i < document.getElementById("d_contfilt").length; i++) {
  if (document.getElementById("d_contfilt").options[i].value ==
      f.contfilt.value) {
    document.getElementById("d_contfilt").selectedIndex=i;
  }
}

if ("%EMRWEB01.01.076" == "1") {
  document.getElementById("remofilt").checked = true;   
}

</script>
<form name=UpdateForm action="emrweb02.pbl" method=get>
<input type=hidden name=reportno value="02">
<input type=hidden name=template value="041">
<input type=hidden name=formactn value="SP">
<input type=hidden name=emexp001>
<input type=hidden name=etsvisfl value="">
<input type=hidden name=deftview value="">
</form>
