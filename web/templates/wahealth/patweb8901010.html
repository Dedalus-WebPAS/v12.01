<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function CheckRemove() {
  if (document.UpdateForm.cpadm002[1].checked) {
     document.UpdateForm.cpadm003.className="Mandatory";
     document.UpdateForm.cpadm008.className="Mandatory";
     document.UpdateForm.cpadm009.className="Mandatory";
     document.UpdateForm.cpadm003.disabled=false;
     document.UpdateForm.cpadm008.readOnly=false;
     document.UpdateForm.cpadm009.readOnly=false;
  } else {
     document.UpdateForm.cpadm003.className="readonly";
     document.UpdateForm.cpadm008.className="readonly";
     document.UpdateForm.cpadm009.className="readonly";
     document.UpdateForm.cpadm003.value="";
     document.UpdateForm.cpadm008.value="";
     document.UpdateForm.cpadm009.value="";
     document.UpdateForm.cpadm003.disabled=true;
     document.UpdateForm.cpadm008.readOnly=true;
     document.UpdateForm.cpadm009.readOnly=true;
  }
}
function PostCancel() {
  if(!isWhitespace(document.UpdateForm.d_emviadmn.value)) {
    if(!confirm("Warning - Linked ED visit " +
          document.UpdateForm.d_emviadmn.value +
          " exists." +
          "\nPress Ok to continue, Cancel to Abort.")) {
        return;
    }
  }

  if(validateMandatory(UpdateForm)) {
    document.UpdateForm.submit();
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img border=0 align=right src=../images/ExitIcon.gif 
 onclick=DFrameExit()>
Cancel Pre-Admission 
</span>
  <form name=UpdateForm  action="patweb89.pbl" method=post>
  <input type="hidden" name="reportno" value="2">
  <input type="hidden" name="template" value="010">
  <input type="hidden" name="updatety" value="3">
  <input type="hidden" name="urnumber" value="%PATWEB89.01.003">
  <input type="hidden" name="admissno" value="%PATWEB89.01.101">
  <input type="hidden" name="nextpage" value="1">
  <input type="hidden" name="d_emviadmn" value="%PATWEB89.01.999.022">
  <input type="hidden" name="savtdept" value="%PATWEB89.01.999.028">
<table border=0 colspan=1 width=95% align=center cellspacing=1 cellpadding=1 >
<tr><td colspan=2>
  <table width=100%>
  <tr><td width=50% class=DataLabel>Reason for Patient Cancellation </td>
      <td align=left>
        <select name="ptmis003" class=Mandatory title="Cancellation Reason">
        <option> </option>
        %STANDARD.01.007.PC
        </select>
      </td></tr>
</table>
</td></tr>
<tr><td colspan=2><div id=booking></div></td></tr>
<tr><td colspan=2><div id=waiting></div></td></tr>
<tr><td colspan=2><div id=theatre></div></td></tr>
<tr><td colspan=2 align=center>
    <input type=button value="Cancel Pre-Admission" class="Largebutton"
     id="pat89sub" onclick="tempDisable(this);PostCancel();">
    <input type=button value="Close" class="button" onclick="DFrameExit()">
</td></tr>
</table>
</form>

<div name=bookdets id=bookdets style="display: none;"
 class="DisplayLocation">
<table width=100% >
  <tr><td width=50% class=DataLabel>Booking Cancellation Reason </td> 
      <td align=left><select name="cpadm001" class=Mandatory 
           title="Booking Cancellation Reason">
        <option> </option>
        %STANDARD.01.007.BC
      </select>
      </td></tr>
</table>
</div>

<div name=bookdtbe id=bookdtbe style="display: none;"
 class="DisplayLocation">
<table width=100% >
  <tr><td width=50% class=DataLabel>Booking Cancellation Reason </td>
      <td align=left><select name="cpadm007" class=Mandatory 
           title="Booking Cancellation Reason">
        <option> </option>
        %STANDARD.01.007.BE
      </select>
      </td></tr>
</table>
</div>

<div name=waitdets id=waitdets style="display: none;"
 class="DisplayLocation">
<table width=100%> 
  <tr><td width=50% class=DataLabel>Do you want to return this patient to 
                          the Waiting List? </td>
      <td>Yes<input type=radio name=cpadm002 value="Y" checked
              onclick="CheckRemove();">
          No <input type=radio name=cpadm002 value="N"
              onclick="CheckRemove();">
      </td></tr>

  <tr><td class=DataLabel>Removal Reason </td>
      <td align=left>
      <select name="cpadm003" title="Removal Reason" disabled class=readonly>
        <option> </option>
        %STANDARD.01.007.WR
      </select>
      </td></tr>

  <tr><td class=DataLabel>Date Removed</td>
  <td><input type="text" name="cpadm008" title="Date Removed" size="12"
         readOnly class=readonly
         maxlength="11" onBlur="checkDate(this,'Date Removed');">
        <img notab src="../images/DateLookup.gif" class="Icon"
         alt="Calendar" date="UpdateForm.cpadm008">
        Time
        <input type=text name=cpadm009 size=8 
         title="Removal Time" readOnly class=readonly>
    <img src=../images/DateTimeStamp.gif class=Icon date=UpdateForm.cpadm008
     time=UpdateForm.cpadm009>
    <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle
    onclick="TimeLookupFrame(cpadm009);">
        </td></tr>
</table>
</div>

<div name=theatdets id=theatdets style="display: none;"
 class="DisplayLocation">
<table align=center>
  <tr><td width=50% class=DataLabel>Theatre Booking Cancellation Reason </td>
      <td align=left>
      <select name="cpadm006" title="Theatre Cancellation Reason"
           class=Mandatory>
        <option> </option>
        %STANDARD.01.007.SC
      </select>
      </td></tr>
</table>
</div>

<script type="text/javascript">
function init(){
  if ( "%PATWEB89.01.912.003" == "1")  {
     alert("Warning: Patient has associated theatre bookings.")
     return}
  if ( "%PATWEB89.01.912.001" == "1")  {
    if ( "%PATWEB89.01.913" == "1")  {
      booking.innerHTML=bookdets.innerHTML;
      parent.document.getElementById('PopUpScreen').style.height=
            (parseInt(parent.document.getElementById('PopUpScreen').style.height.substr(0,3)) + 60);
    } else {
      booking.innerHTML=bookdtbe.innerHTML;
      parent.document.getElementById('PopUpScreen').style.height=
            (parseInt(parent.document.getElementById('PopUpScreen').style.height.substr(0,3)) + 60);
    } 

  }

  if ( "%PATWEB89.01.912.002" == "1")  {
   if ( "%PATWEB89.01.913" == "1")  {
    waiting.innerHTML=waitdets.innerHTML;
    parent.document.getElementById('PopUpScreen').style.height=
          (parseInt(parent.document.getElementById('PopUpScreen').style.height.substr(0,3)) + 80);
    }
  }

  if ( "%PATWEB89.01.912.003" == "1")  {
    theatre.innerHTML=theatdets.innerHTML;
    parent.document.getElementById('PopUpScreen').style.height=
          (parseInt(parent.document.getElementById('PopUpScreen').style.height.substr(0,3)) + 70);
  }
}
</script>
