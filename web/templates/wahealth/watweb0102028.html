<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript">
function selectOptions4(OptionNumber,ReturnCode,ReturnCd2,ReturnSelect) {
  var serverURL   = "../cgi-bin/comweb80.pbl?reportno=" + OptionNumber +
                    "&valdcode=" + ReturnCode.value.replace(/ /g,"+") +
                    "&valdcod2=" + ReturnCd2.value.replace(/ /g,"+") +
                    "&valdtype=1"
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnSelect.options.length=0
    ReturnSelect.options[ReturnSelect.options.length]=new Option("","");
    ReturnValue=returnValue.return_value.split("|");
    for (var j=0; j < ReturnValue.length; j++) {
       if (!isWhitespace(ReturnValue[j])) {
         SelectValue=ReturnValue[j].split(",");
         ReturnSelect.options[ReturnSelect.options.length]=
          new Option(SelectValue[1],SelectValue[0]); } } }
  else {
    ReturnCode.select();  }
}

function UpdateDetails() {

  if (validateMandatory(UpdateForm)) {
    document.UpdateForm.submit();
   }
}
function changeHosp(){
  setWardList();
  setPostOpWardList();
  setAdmittingPoint();
  document.UpdateForm.wattr012.value="";
  document.UpdateForm.wattx006.value="";
  valUnit();
}
function setPostOpWardList(){
  selectOptions2("3",UpdateForm.wattr038,UpdateForm.wattx005);
}

function UpdateUnit(){
for (var i =0 ; i < document.UpdateForm.wattr011.length; i++) {
if(trim(UpdateForm.unit.value.substr(0,3))==trim(UpdateForm.wattr011.options[i].value.substr(0,3))) {
       document.UpdateForm.wattr011.selectedIndex=i } };
}
function valUnit() {
//  if (document.UpdateForm.wattr012.value != "") {
//    validateCode(31,UpdateForm.wattr012,UpdateForm.name_wattr012)
    validateDoctorHospital(UpdateForm.wattr012,UpdateForm.name_wattr012,UpdateForm.wattr038)
    UpdateForm.unit.value=UpdateForm.wattr011.value


 selectOptions4("45",UpdateForm.wattr012,UpdateForm.wattr038,UpdateForm.wattr011);

    UpdateUnit();

    if(document.UpdateForm.wattr011.length=="2") {
      UpdateForm.wattr011.selectedIndex=1
      UpdateForm.unit.value=UpdateForm.wattr011.value
    }
    valUnitTeam();
//  }
}
function Chkhosp() {
  if (isWhitespace(document.UpdateForm.wattr038.value)) {
   alert("Intended Hospital must be entered first.");
   return;
  }

 WaitConSearchFrameTMD(UpdateForm.wattr012,UpdateForm.name_wattr012,UpdateForm.wattr011);
}
function valUnitTeam() {
  selectOptions5("46",UpdateForm.wattr012,UpdateForm.wattr011,UpdateForm.wattr038,UpdateForm.wattx035);
  for (var i =0 ; i < document.UpdateForm.wattx035.length; i++) {
    if(trim(UpdateForm.wattx035.options[i].value)==trim(UpdateForm.oldteam.value)) {
     document.UpdateForm.wattx035.selectedIndex=i }
  }
    if (isWhitespace(document.UpdateForm.oldteam)) {
      if (UpdateForm.wattx035.length==2) {
        UpdateForm.wattx035.selectedIndex=1; } }
      if (UpdateForm.wattx035.length>1) {
        UpdateForm.wattx035.className = "Mandatory"; }
      else { UpdateForm.wattx035.className = ""; }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);setWardList();valUnit();setAdmittingPoint();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Change Hospital for %WATWEB01.02.106 from %WATWEB01.02.148.1
</span>
<form name=UpdateForm action="watweb01.pbl" style="margin:0" method=post 
 onsubmit='return validateMandatory(this);'>
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=28>
<input type=hidden name=tmddoctf value="1">
<input type=hidden name=casekeys value="%WATWEB01.02.101">
<input type=hidden name=updttype value="S">
<input type=hidden name=nextpage value="8">
<input type=hidden name=dummy>
<input type=hidden name=dummy2>
<input type=hidden name=unit>
<input type=hidden name=allowahs value="1">
<input type=hidden name=categoap value="ap">
<input type=hidden name=admpoint value="%WATWEB01.02.358">
<input type=hidden name=oldteam value="%WATWEB01.02.535.1">

<table border=0 width=90% cellspacing=0 align=center>
<tr><td class=DataLabel>Intended Hospital</td>
    <td class=DataField >
    <select name=wattr038 title="Intended Hospital"
    class="Mandatory selectBig" tabindex=10 
    onchange="changeHosp();">
    <option></option>
    %WATWEB01.02.148.2
    </select></td>
    <td class=DataLabel>%STANDARD.01.017.WQ</td>
    <td class=DataLabel>
    <select name=reasfc17 title="%STANDARD.01.017.WQ" class=Mandatory >
    <option></option>
    %%STANDARD.01.007.WQ
    </select>
    </td></tr>

<tr valign=top><td class=DataLabel>Responsible Clinician</td>
    <td class=DataField colspan=3>
    <input type=text name=wattr012 size=8 maxlength=8
     title="Consultant" class=Mandatory value="%WATWEB01.02.115.003" onblur="valUnit();">
    <input type=text name=name_wattr012 size=40 readonly
    title="Consultant Name" value="%WATWEB01.02.115.002">
    <a href="javascript:Chkhosp();">
 <img src=../images/SearchIcon.gif class=Icon border=0></a></td>
    </tr>


<tr><td class=DataLabel>Unit</td>
    <td class=DataField colspan=3>
    <select name=wattr011 title="testUnit" class=Mandatory
     onchange="valUnitTeam();">
    <option></option>
    %WATWEB01.02.114.2
    </select></td>
    </tr>
<tr><td class=DataLabel>Team</td>
          <td><select name=wattx035 tabindex=65
               title="Team">
              <option> </option>
              </select>
          </td>
</tr>
<tr><td class=DataLabel>Ward  </td>
    <td class=DataField>
    <select name=wattx037 tabindex=210 class="Mandatory"
     title="Ward" >
    <option></option>
     %WATWEB01.02.537.2
    </select></td></tr>
<tr><td class=DataLabel>Post Op Ward  </td>
    <td class=DataField>
    <select name=wattx005 tabindex=25
     title="Post Op Ward">
    <option></option>
    %WATWEB01.02.505.2
    </select></td>
</tr>
<tr><td class=DataLabel>Admitting Point  </td>
    <td class=DataField>
    <select name=wattx006 tabindex=200 class="selectBig Mandatory"
     title="Admitting Point">
    <option></option>
    %WATWEB01.02.506.2
    </select></td>
</tr>

<tr><td colspan=3 align=center>
    <input type=button class="button" value="Ok" onclick="UpdateDetails();">
    <input type=button value="Cancel" class="button" onclick='DFrameExit()'>
    </td></tr>
</table>
</form>
<script type=text/javascript>
function setWardList(){
  selectOptions2("3",UpdateForm.wattr038,UpdateForm.wattx037);
  ward="%WATWEB01.02.537.0"
  for (var i =0 ; i < document.UpdateForm.wattx037.length; i++) {
    if(trim(UpdateForm.wattx037.options[i].value)==ward) {
     document.UpdateForm.wattx037.selectedIndex=i }
  }
}
function setAdmittingPoint() {
  SelectOptionsHospCatCode(UpdateForm.categoap,UpdateForm.wattr038,UpdateForm.wattx006);
  for (var i =0 ; i < document.UpdateForm.wattx006.length; i++) {
    if(UpdateForm.wattx006.options[i].value.substring(0,3)==
       UpdateForm.admpoint.value) {
     document.UpdateForm.wattx006.selectedIndex=i }
  }
}
</script>

<form name=AddForm method=get>
<input type=hidden name=wattr001 value="%WATWEB01.02.103.0">
<input type=hidden name=wattr011 value="%WATWEB01.02.114.1">
<input type=hidden name=dummy1 value="">
<input type=hidden name=tmddoctf value="1">
<input type=hidden name=wpgrp value="">
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%WATWEB01.02.003">
<input type=hidden name=admissno value="%WATWEB01.02.081">
<input type=hidden name=MenuType value="%WATWEB01.02.088">
<input type=hidden name=casekeys value="%WATWEB01.02.101">
<input type=hidden name=wattrkey value="%WATWEB01.02.101">
<input type=hidden name=nextpage value="8">
<input type=hidden name=sesskeys value="">
</form>
