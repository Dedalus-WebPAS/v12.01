<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="wahealth">
<meta name="HelpFileName"    content="NoContextSet.html"> 
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/outweb0202.js"></script>
<script type="text/javascript" src="../js/outweb02.js"></script>
<script type="text/javascript" src="../js/outweb0202004.js"></script>

<link rel="stylesheet" media="print" href="../html/printWithHeader.css"
      type="text/css">

<style type="text/css">
td { vertical-align: text-top; }

img.ListIcon {
  border:0px;
  cursor:hand;
  margin-top:0px; 
  margin-bottom:2px; 
  margin-left:0px; 
  margin-right:3px; 
  vertical-align: text-top;
}
</style>

<script type="text/javascript">
function SummaryPage() {
  location.href="outweb02.pbl?reportno=1&template=5" +
                "&frstdate=" + UpdateStatus.sesskeys.value.substr(12,8) +
                "&lastdate=" + UpdateStatus.sesskeys.value.substr(12,8) 
}
function UpdateSlot(A,B,C) {
   UpdateStatus.casekeys.value=A
   LinkURL='patweb90.pbl?reportno=1&template=200'
   DFrameLink(LinkURL,25,50,700,420)
}
function InitTable(TableView) {
switch (TableView) {
  // Booking Details
  case "0":
   t = new Table(1,0,2,"100%","center",40,90);
   t.addColumn("Time","Time",1,1,"left","AppointmentIcon.gif","Slot",40)
   t.addColumn("Type","String",34,34,"left","","",35)
   t.addColumn("U/R","String",6,6,"left","","",50)
   t.addColumn("Patient","StringPatient",5,5,"left","PatientFolder","Patient",160)
//
   if (document.UpdateStatus.othecpmi.value=="1") {
     t.addColumn("Confirm PMI","ButtonLinkWide",65,66,"left","","ConfirmPMI",80)
   }
//
   t.addColumn("Check-In","ButtonLink",15,-1,"left","","CheckIn",50)
   t.addColumn("Time Seen","ButtonLink",14,-1,"left","","TimeSeenOnly",50)
   t.addColumn("Departure","ButtonLinkText",75,-1,"left","","Departure",70)
   t.addColumn("Follow Up","ButtonLink",20,-1,"left","","FollowUp",50)
   t.addColumn("Non Attend","ButtonLink",21,-1,"left","","NonAttend",50)
   t.addColumn("Alerts","Image",22,-1,"left","alert","",60)
   t.addColumn(UpdateStatus.dummyclm.value,"String",37,37,"left","","",50)
   t.addColumn("Service Delivery&nbsp;Mode","String",72,72,"left","","",50)
   AddTableRows();
   TableOutput(0,1);    // Order Column,Asc Dsc
   break;

  // Diagnosis Details
  case "1":
   t = new Table(1,0,2,"100%","center",40);
   t.addColumn("Time","Time",1,1,"left","AppointmentIcon.gif","Slot",60)
   t.addColumn("Type","String",34,34,"left","","",50)
   t.addColumn("U/R","String",6,6,"left","","",60)
   t.addColumn("Patient ","StringPatient",5,5,"left","PatientFolder","Patient","23%")
//
   if (document.UpdateStatus.othecpmi.value=="1") {
     t.addColumn("Confirm PMI","ButtonLinkWide",65,66,"left","","ConfirmPMI",85)
   }
//
   t.addColumn("Check-In","ButtonLink",15,-1,"left","","CheckIn",70)
   t.addColumn("Time Seen","ButtonLink",14,-1,"left","","TimeSeenOnly",70)
   t.addColumn("Diagnosis/Complaint","String",22,22,"","","","22%")
   t.addColumn("Appointment Comments","String",36,36,"","","","22%")
   t.addColumn("Alerts","Image",22,-1,"left","alert","","15%")
   AddTableRows();
   TableOutputDynamicRow(0,1,63);    // Order Column,Asc Dsc
   break;

  // Contact Details
  case "2":
   t = new Table(1,0,2,"100%","center",40,45);
   t.addColumn("Time","Time",1,1,"left","AppointmentIcon.gif","Slot",40)
   t.addColumn("Type","String",34,34,"left","","",35)
   t.addColumn("U/R","String",6,6,"left","","",50)
   t.addColumn("Patient ","StringPatient",5,5,"left","PatientFolder","Patient",180)
   t.addColumn("Private","String",25,25,"","","",75)
   t.addColumn("Business","String",26,26,"","","",75)
   t.addColumn("Mobile","String",27,27,"","","",75)
   AddTableRows();
   TableOutput(0,1);    // Order Column,Asc Dsc
   break;

  case "3":
   t = new Table(1,0,2,"100%","center",40,90);
   t.addColumn("Time","Time",1,1,"left","AppointmentIcon.gif","Slot",60)
   t.addColumn("Type","String",34,34,"left","","",35)
   t.addColumn("U/R","String",6,6,"left","","",50)
   t.addColumn("Patient ","StringPatient",5,5,"left","PatientFolder","Patient",140)
//
   if (document.UpdateStatus.othecpmi.value=="1") {
     t.addColumn("Confirm PMI","ButtonLinkWide",65,66,"left","","ConfirmPMI",50)
   }
//
   t.addColumn("Check-In","ButtonLink",15,-1,"left","","CheckIn",50)
   t.addColumn("Diagnosis/Complaint","String",22,22,"","","",70)
   t.addColumn("Appointment Comments","String",36,36,"","","",70)
   t.addColumn("Service Delivery&nbsp;Mode","String",72,72,"left","","",45)
   t.addColumn("Alerts","Image",22,-1,"left","alert","",60)
   t.addColumn("High Risk","String",71,71,"left","","",45)
   AddTableRows();
   TableOutputDynamicRow(0,1,63);    // Order Column,Asc Dsc
   break;
 }
}
function InitTableInq(TableView) {
  switch (TableView) {
    case "0":
      t = new Table(1,0,2,"100%","center",40,90);
      t.addColumn("Time","Time",1,1,"left","","",50)
      t.addColumn("Type","String",34,34,"left","","",35)
      t.addColumn("U/R","String",6,6,"left","","",50)
      t.addColumn("Patient","StringPatient",5,5,"left","","",160)
      if (document.UpdateStatus.othecpmi.value=="1") {
        t.addColumn("Confirm PMI","String",65,66,"left","","",50)
      }
      t.addColumn("Check- In","String",15,-1,"left","","",45)
      t.addColumn("Time Seen","String",14,-1,"left","","",45)
      t.addColumn("Departure","String",75,-1,"left","","",70)
      t.addColumn("Follow Up","String",20,-1,"left","","",45)
      t.addColumn("Non Attend","String",21,-1,"left","","",45)
      t.addColumn("Alerts","Image",22,-1,"left","alert","",60)
      t.addColumn(UpdateStatus.dummyclm.value,"String",37,37,"left","","",25)
      t.addColumn("Service Delivery&nbsp;Mode","String",72,72,"left","","",50)
      AddTableRows();
      TableOutput(0,1);    // Order Column,Asc Dsc
      break;

    case "1":
      t = new Table(1,0,2,"100%","center",40,90);
      t.addColumn("Time","Time",1,1,"left","","",60)
      t.addColumn("Type","String",34,34,"left","","",45)
      t.addColumn("U/R","String",6,6,"left","","",55)
      t.addColumn("Patient","StringPatient",5,5,"left","","",160)
      if (document.UpdateStatus.othecpmi.value=="1") {
        t.addColumn("Confirm PMI","String",65,66,"left","","",50)
      }
      t.addColumn("Check- In","String",15,-1,"left","","",50)
      t.addColumn("Time Seen","String",14,-1,"left","","",50)
      t.addColumn("Diagnosis/Complaint","String",22,22,"","","",80)
      t.addColumn("Appointment Comments","String",36,36,"","","",80)
      t.addColumn("Alerts","Image",22,-1,"left","alert","",60)
      AddTableRows();
      TableOutputDynamicRow(0,1,63);    // Order Column,Asc Dsc
      break;

    case "2":
      t = new Table(1,0,2,"100%","center",40,45);
      t.addColumn("Time","Time",1,1,"left","","",55)
      t.addColumn("Type","String",34,34,"left","","",45)
      t.addColumn("U/R","String",6,6,"left","","",55)
      t.addColumn("Patient ","StringPatient",5,5,"left","","",180)
      t.addColumn("Private","String",25,25,"","","",75)
      t.addColumn("Business","String",26,26,"","","",75)
      t.addColumn("Mobile","String",27,27,"","","",75)
      AddTableRows();
      TableOutput(0,1);    // Order Column,Asc Dsc
      break;
  }
}

function initA(){
  if(document.UpdateStatus.othecenc.value=="1") {
     SelectPeriod.viewlink.options[SelectPeriod.viewlink.options.length]=
     new Option("Bulk Contact","14");
  }
}
function getClinicSearchCookie() {
  document.UpdateStatus.clinsrch.value=GetCookieData("clinicSearchPath");
  document.cookie="clinicSearchPath=;"
}
function GoClinicSearchPath() {
  if (document.UpdateStatus.clinsrch.value != "unknown" &&
      !isWhitespace(document.UpdateStatus.clinsrch.value)) {
    location.href = document.UpdateStatus.clinsrch.value;
  } else {
    GoOutpatientListSTV();
  }
}
function GetAppointmentTypeCookie() {
  var aptyckie = "";
  if (GetCookieData("AppointmentTypeCookie") != "unknown" &&
      !isWhitespace(GetCookieData("AppointmentTypeCookie"))) {
    aptyckie=GetCookieData("AppointmentTypeCookie");
    ExpireCookiePath("AppointmentTypeCookie");
    Left=(document.body.clientWidth-900)/2
    DFrameLink(aptyckie,100,Left,920,550);
  }
}
function CheckLoadTable(TableView,viewopcl) {
  if (viewopcl == "1") {
    LoadTableInq(TableView);
  }
  else {
    LoadTable(TableView);  
  }
}
function displayClinicView() {
  if (document.SelectPeriod.viewopcl.value == "1") {
    ClinicView.innerHTML = clinicviewinq.innerHTML;
  }
  else {
    ClinicView.innerHTML = clinicview.innerHTML;
  }
}

</script>
</head>
%START.OF.PAGE
<body onload='PageLoad(event);
              displayClinicView();
              CheckLoadTable("%OUTWEB02.02.044","%OUTWEB02.02.070");
              SetPageRefreshOut(90);
              getClinicSearchCookie();getScrollPosition();
              GetAppointmentTypeCookie();
              showTodayButton();'
      onunload='saveScrollPosition();'>
<div id=HeadingSection>
<form name=UpdateStatus action=outweb02.pbl method=post style="margin:0">
<input type=hidden name=reportno value=4>
<input type=hidden name=template value=1>
<input type=hidden name=redirect value="">
<input type=hidden name=updatety value="">
<input type=hidden name=casekeys value="">
<input type=hidden name=sesskeys value="%OUTWEB02.02.004">
<input type=hidden name=sessupdt value="">
<input type=hidden name=bookstat value="">
<input type=hidden name=urnumber value="">
<input type=hidden name=admissno value="">
<input type=hidden name=patfname value="">
<input type=hidden name=dummyadm value="">
<input type=hidden name=dummyclm value="%STANDARD.01.017.CL">
<input type=hidden name=othecenc value="%OUTWEB02.02.051">
<input type=hidden name=othedurn value="%OUTWEB02.02.053">
<input type=hidden name=xocadoct value="%OUTWEB02.02.054">
<input type=hidden name=clinsrch value="">
<input type=hidden name=othecpmi value="%OUTWEB02.02.058">
</form>

<form name=SelectPeriod action=outweb02.pbl method=get style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=4>
<input type=hidden name=contview value="%OUTWEB02.02.057">
<input type=hidden name=tablview value="%OUTWEB02.02.044">
<input type=hidden name=deprtred>
<input type=hidden name=viewopcl value="%OUTWEB02.02.070">
<input type=hidden name=sesskeyt value="%OUTWEB02.02.071">
<input type=hidden name=loctoday value="%OUTWEB02.02.072">
<input type=hidden name=otcndtdy id=otcndtdy
       value="%STANDARD.01.025.032.148.1.1">

<table cellspacing=0 cellpadding=1 bgcolor=#CCCCCC border=0 width=100%>
<tr><td class=HeadingCell width=10%>
    <img src="../images/ListIcon.gif" class=Icon title="Clinic Timetable"
     onclick='GoClinicSearchPath();'>
    <img src="../images/RefreshIcon.gif" class=Icon title="Refresh"
     onclick='document.cookie="clinicSearchPath="+escape(document.UpdateStatus.clinsrch.value)+";";location.reload();'></td>
    <td class=HeadingCell align=center>
    Clinic for %OUTWEB02.02.014 (%OUTWEB02.02.018)</td>
    <td class=HeadingCell width=10%></td></tr>
</table>

<table cellspacing=0 cellpadding=1 bgcolor=#CCCCCC border=0 width=100%>
<tr><td width=10% class=DataLabel>Clinic Views</td>
    <td width=35% class=DataField>
      <div id=ClinicView></div>
    </td>
    <td class=DataLabel>Date & Start Time</td>
    <td align=right>
    <span id=TodayButSpan style="display:none">
      <input type=button name=btnToday id=btnToday value="Today" class=button
       title="Switch to today's clinic"
       onclick='setTodayDate();'>
    </span>
    <input type=button value="<<" class=SmallButton
     onclick='location.href="%OUTWEB02.02.002"'>
    <select name=sesskeys onchange='document.SelectPeriod.submit();'>
    %OUTWEB02.02.003
    </select>
    <input type=button value=">>" class=SmallButton
    onclick='location.href="%OUTWEB02.02.001"'>
    </td></tr>

<tr><td class=DataLabel>Clinic Type</td>
    <td class=DataField>%OUTWEB02.02.027.0</td>
    <td class=DataLabel>Location</td>
    <td class=DataField>%OUTWEB02.02.029.0</td></tr>

<tr><td class=DataLabel>Session Status</td>
    <td class=DataField>%OUTWEB02.02.020.0</td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td></tr>

<tr valign=top>
    <td class=DataLabel>Comments</td>
    <td class=DataField>
    %OUTWEB02.02.026
    <td class=DataLabel>Instructions
    </td> <td> 
    <b> %OUTWEB02.02.028</b> <br></td> </tr> 

<tr><td></td><td>
    <b>%OUTWEB02.02.021<br>
    %OUTWEB02.02.022 </b> 
    </td></tr>
</table>

</form>
</div>

<div id=TableLocation></div>

<span id=clinicview style="display:none">
  <select name=viewlink onchange="ViewLink(viewlink.value);" >
    <option value=0>Bookings Details</option>
    <option value=1>Diagnosis Details</option>
    <option value=2>Contact Details</option>
    <option value=18>Clinic View</option>
    <option value=3>Update Slots</option>
    <option value=4>Reschedule</option>
    <option value=5>Update All Non Attended</option>
    <option value=6>Update Comments</option>
    <option value=7>Suspend Clinic</option>
    <option value=8>Print Group Labels</option>
    <option value=9>Clinic Usage</option>
    <option value=13>Confirmed Appointments</option>
    <option value=20>Bulk Process</option>
  </select>
</span>
<span id=clinicviewinq style="display:none">
  <select name=viewlink onchange="ViewLinkInq(viewlink.value);" >
    <option value=0>Bookings Details</option>
    <option value=1>Diagnosis Details</option>
    <option value=2>Contact Details</option>
  </select>
</span>

<script type="text/javascript">
function AddTableRows(){
%OUTWEB02.02.009.outweb02.03.001
}

function BulkProcess()  {
  UpdateStatus.reportno.value="2"
  UpdateStatus.template.value="22"
  location.href="outweb02.pbl?reportno=02&template=022" +
                "&sesskeys=" + UpdateStatus.sesskeys.value.replace(/ /g,"+") +
                "&wacpmich=1";
}

</script>
