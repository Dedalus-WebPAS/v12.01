<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/discharge507.js"></script>
<script type="text/javascript" src="../js/patweb9605.js"></script>
<script type="text/javascript">
function menRedirect() {
  if (document.pat96pdf.mnhlindc.value=="P") {
    document.pat96pdf.redirect.value=document.pat96pdf.mnhlredr.value;
  }
}
function discharge() {
  p=document.pat96pdf

  MandatoryOk=validateMandatory(document.pat96pdf)
//    if (document.pat96pdf.d_movemrec.checked==true) {
//     document.pat96pdf.redirect.value="mrtweb01.pbl?reportno=09&template=004"+
//               "&urnumber="+document.pat96pdf.urnumber.value+
//               "&admissno="+document.pat96pdf.admissno.value
//    }
  if (MandatoryOk) {
    if(isWhitespace(p.ptdslsdn.value)){
      document.pat96pdf.dschdest.value=document.pat96pdf.d_dschdest.value;
    }
// Validate transfer hospital / current hospital
    var serverURL = "../cgi-bin/comweb80.pbl?reportno=73" +
                    "&valdcode="+p.hospval.value.replace(/ /g,"+") +
                    "&valdcod2="+p.trnsfsrc.value.replace(/ /g,"+") +
                    "&valdcod3=DISCHARGE"
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0){
       return false;
    }
// Validate Cat.S/Cat.DD combination
    if ((p.desttyp.value=="1")&&(p.dschdest.value.substr(3,1)=="Z")){
      alert("Error Message\n"+
            "Admitted from a Corrective Institution and has been discharged "+
            "to home. Select OK to amend. ");
      return false;
    }
// Validate Category CL and Ambulatory Patient
    var serverURL = "../cgi-bin/comweb80.pbl?reportno=72" +
                    "&valdcode=DISCHARGE"+
                    "&valddate="+p.trandate1.value.replace(/ /g,"+") +
                    "&valdcod2="+p.admissno.value.replace(/ /g,"+") +
                    "&valdcod3="+p.catcltyp.value.replace(/ /g,"+") +
                    "&valdcod4="+p.dschdest.value.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0){
       return false;
    }
    if (isWhitespace(f.ptdsc003.value)) {
      if (!isWhitespace(f.ptdsc004.value)) {      
        alert("Medical Clear for Discharge Time must not be entered when\n" +
              "Medical Clear for Discharge Date is not entered");
        return false;
      }
    }

    document.pat96pdf.submit();
  }
}
function DisplayTrnSrc() {
  var i=document.pat96pdf.d_dschdest.selectedIndex;
  var ind=document.pat96pdf.d_dschdest.options[i].value.substring(4,5)
  var ind2=document.pat96pdf.d_dschdest.options[i].value.substr(14,1)
  if (ind2=="D") {
      TranSrcDesc.innerHTML=Deathnotif1.innerHTML;
      TranSrcField.innerHTML=Deathnotif2.innerHTML;
  } else {
      if (ind!="1") {
         TranSrcDesc.innerHTML=""
         TranSrcField.innerHTML=transferblank.innerHTML;
         document.pat96pdf.trnsfsrc.value="";
      } else {
         TranSrcDesc.innerHTML="Transfer Destination"
         TranSrcField.innerHTML=transfersrc.innerHTML;
      }
  }
//if(document.pat96pdf.privateh.value=="0"){
//   document.pat96pdf.dschsref.className="";}
}
//
function DisplayAutopsy() {
  // Check indicator for deceased
  i=document.pat96pdf.dschstat.selectedIndex
  ind=document.pat96pdf.dschstat.options[i].value.substring(3,4)
  if (ind=="D") {
    document.pat96pdf.dschdind.value="1"
    Autop.innerHTML=autopsyDiv.innerHTML;
  }
  else {
    Autop.innerHTML="";
    document.pat96pdf.dschdind.value="0"}
}

function moveMREC() {
  var msg="Do you want to move Medical Record?";
  if (confirm(msg)) {
    document.pat96pdf.movemrec.value=1;
  } else {
    document.pat96pdf.movemrec.value=0;
  }
  document.pat96pdf.submit();
}
function ShowACAS() {
   if(document.pat96pdf.statevic.value!="3"){   // Only show for victoria
     return;
   }
   var pattern="1246789FEJ";
   if(pattern.match(document.pat96pdf.acascare.value.substr(14,1))) {
     if(document.pat96pdf.acasage.value=="1") {
       DisplayACAS1.innerHTML=agedcare1.innerHTML;
       DisplayACAS2.innerHTML=agedcare2.innerHTML;
     }
   } else {
      DisplayACAS1.innerHTML="";
      DisplayACAS2.innerHTML="";
   }
}
function CheckMH() {
  if (trim(document.pat96pdf.ptmis024.value.substr(7,1))=="P") {
    MentalHealth.innerHTML=MHfields.innerHTML;
  } else {
    if (trim(document.pat96pdf.mnhlpatn.value)=="1") {
      MentalHealth.innerHTML=MHfields.innerHTML;
    } else {
      MentalHealth.innerHTML="";
    }
  }
}

//TSK 0894483 - Check Indicator 12 to set Depature Means as mandatory
function checkDepartureStatusInd(indicator){
  var val = indicator.value.substring(28,29);
  if(val == 'M'){
    document.getElementById('dschdpmn').className="Mandatory";
  } else {
    document.getElementById('dschdpmn').className="";
  }
}
function ShowMedClearDetail() {
  f = document.pat96pdf;
  if (isWhitespace(f.ptdsc003.value)) {
    f.ptdsc004.value = "";
    f.ptdsc005.selectedIndex = -1;
    f.ptdsc006.selectedIndex = -1;
    document.getElementById('PriReasonDiscDelay').style.display = "none";
    document.getElementById('SecReasonDiscDelay').style.display = "none";
    document.pat96pdf.ptdsc004.className="";
    document.pat96pdf.ptdsc005.className="";
  }
  else {
    document.getElementById('PriReasonDiscDelay').style.display = "";
    document.getElementById('SecReasonDiscDelay').style.display = "";
    document.pat96pdf.ptdsc004.className="Mandatory";
    document.pat96pdf.ptdsc005.className="SelectBig Mandatory";
  }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisplayTrnSrc();ShowACAS();
           menRedirect();CheckMH(); statisticalDischarge();
           checkDepartureStatusInd(document.getElementById('d_dschdest'));
           ShowMedClearDetail();">
<div id=PageHeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB96.11.003";
PatientVIS="%PATWEB96.11.081";
PatientNAM="%PATWEB96.11.002";
PatientSTA="%PATWEB96.11.086.078";
PatientALT="%PATWEB96.11.084";
PatientSEX="%PATWEB96.11.019";
PatientDOB="%PATWEB96.11.020";
PatientAGE="%PATWEB96.11.021";
PatientLOC="%PATWEB96.11.083";
PatientPRI="%PATWEB96.11.086.066.1";
PatientUNT="%PATWEB96.11.066.0";
DoctorCOD="%PATWEB96.11.082.003";
DoctorNAM="%PATWEB96.11.082.002";
PatientAID="%PATWEB96.11.086.090";
PatientIND="%PATWEB96.11.086.091";
PatientCUR="%PATWEB96.11.086.092";
PatientCLC="%PATWEB96.11.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB96.11.086.094";
PatientCDM="%PATWEB96.11.086.095";
PatientVDH="%PATWEB96.11.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form onsubmit='return validateMandatory(this)' name=pat96pdf style="margin:0"
 %PATWEB96.11.201.001
<input type=hidden name=reportno value="6">
<input type=hidden name=urnumber value="%PATWEB96.11.003">
<input type=hidden name=admissno value="%PATWEB96.11.101">
<input type=hidden name=updatety value="1">
<input type=hidden name=movemrec value="0">
<input type=hidden name=redirect value="%PATWEB96.11.001.patweb98.01.001">
<input type=hidden name=nextpage value="2">
<input type=hidden name=patsex   value="%PATWEB96.11.019">
<input type=hidden name=patage   value="%PATWEB96.11.021">
<input type=hidden name=acasage  value="%PATWEB96.11.223">
<input type=hidden name=acascare value="%PATWEB96.11.113.3">
<input type=hidden name=statevic value="%PATWEB96.11.224">
<input type=hidden name=privateh value="%STANDARD.01.025.021.210.1.1">
<input type=hidden name=mnhlindc value="%PATWEB96.11.229">
<input type=hidden name=mnhlredr value="%PATWEB96.11.001.mehweb01.09.001">
<input type=hidden name=ptmis024 value="%PATWEB96.11.124.3">
<input type=hidden name=ismrtmas value="%PATWEB96.11.841">
<input type=hidden name=ptdslsdn value="%PATWEB96.11.231">
<input type=hidden name=dschdest value="%PATWEB96.11.232">
<input type=hidden name=mnhlpatn value="%PATWEB96.11.221">
<input type=hidden name=catcltyp value="%PATWEB96.11.126.1">
<input type=hidden name=catstyp  value="%PATWEB96.11.110.3">
<input type=hidden name=hospval  value="%PATWEB96.11.498.013.1">
<input type=hidden name=desttyp  value="%PATWEB96.11.854">

<table  border=1 width=100% cellspacing=0 cellpadding=0>
  <tr><td class=HeadingCell align=center colspan=4>
      Update Discharge Form</td></tr>
</table>
<table  border=0 width=100% cellspacing=0 cellpadding=4>
  <tr><td class=DataLabel>Discharge Date </td>
      <td>
<input type=text size=15 maxlength=12 name=trandate1 title="Discharge Date"
     readonly class="ReadOnly" value="%PATWEB96.11.301">
</td>
      <td class=DataLabel> Discharge Time</td>
      <td>
          <input type=text size=8 name=trantime  readonly class="ReadOnly" 
              title="Discharge time" value="%PATWEB96.11.302">
      </tr>

  <tr><td class=DataLabel>%STANDARD.01.017.DD </td>
      <td><select name=d_dschdest id=d_dschdest
       onchange="DisplayTrnSrc();checkDepartureStatusInd(this);" 
       class=Mandatory  title="%STANDARD.01.017.DD" value="%PATWEB96.11.304.0">
          <option></option>
          %PATWEB96.11.205
          </select></td>
      <td class=DataLabel><div id=TranSrcDesc></div></td>
      <td><div id=TranSrcField></div></td>
  </tr>
<tr valign=top><td class=DataLabel>Responsible Clinician</td>
   <td class=DataLabel> 
    <input type=text class=readonly readonly name=dschadta size=10
     value="%PATWEB96.11.108.003" notab>
    <input type=text class=readonly readonly name=dschname size=25
     value="%PATWEB96.11.108.002" notab>
   </td> 
   <td class=DataLabel>&nbsp;</td>
   <td>&nbsp;</td>
 </tr>
<tr><td class=DataLabel>Departure Means </td>
    <td><select name=dschdpmn id=dschdpmn title="Departure Means">
        <option></option>
        %PATWEB96.11.329.2
        </select></td></tr>
<!--
<td>Move Medical Record</td>
<td><input type=checkbox name=d_movemrec value="1">
</td></tr>
-->



<!--
<tr><td class=DataLabel>&nbsp;</td>
     <td>&nbsp;</td>
      <td class=DataLabel>Mental Health Legal Status</td>
      <td>
      <select name=dschmhls>
        <option> </option>
        PATWEB96.11.489.2
      </select></td>
    </tr>  
-->


<tr valign=top><td class=DataLabel>Comments</td>
        <td><input type=text name=dschcom1 size=50 maxlength=40
                      value="%PATWEB96.11.131"><br>
                      <input type=text name=dschcom2 size=50 maxlength=30
                      value="%PATWEB96.11.132"></td>
    <td class=DataLabel>Discharge Diagnosis</td>
        <td colspan=3><input type=text name=dschdia1 size=50 maxlength=50
                       value="%PATWEB96.11.305"><br>
                      <input type=text name=dschdia2 size=50 maxlength=50
                       value="%PATWEB96.11.306"></td></tr>

<tr valign=top><td><div id=DisplayACAS1></div></td>
    <td><div id=DisplayACAS2></div></td>
<!--
    <td class=DataLabel>STANDARD.01.017.D5</td>
    <td><select name=dschusr5 title="STANDARD.01.017.D5">
      <option> </option>
      PATWEB96.11.311.2
      </select></td>
-->
    </tr>

<tr><td class=DataLabel width=18%>Medically Cleared for Discharge Date</td>
    <td><input type=text size=15 maxlength=11 name=ptdsc003 id=ptdsc003
         title="Medically Cleared for Discharge Date" class="Date"
         value="%PATWEB96.11.254.009"
         onblur="checkDate(this,'Date');ShowMedClearDetail();">
         <img notab src="../images/DateTimeStamp.gif" class=Icon
          alt="Current"
          onclick="SetCurrentDateTime(pat96pdf.ptdsc003,null);">
         <img notab src="../images/DateLookup.gif" class=Icon
          alt="Calendar" date="pat96pdf.ptdsc003">
    Time
        <input type=text size=8 name=ptdsc004 id=ptdsc004
        title="Medically Cleared for Discharge Time"
        value="%PATWEB96.11.254.010">
        <img src="../images/DateTimeStamp.gif" class=Icon
        onclick="SetCurrentDateTime(null,pat96pdf.ptdsc004);">
        <img src="../images/TimeLookup.gif" class=Icon
        onclick="TimeLookupFrame(pat96pdf.ptdsc004);">
        <img src="../images/ClearIcon.gif" class=Icon
         onclick="clrFields(pat96pdf.ptdsc003,pat96pdf.ptdsc004);
                  ShowMedClearDetail();">
    </td>
</tr>
<tr id=PriReasonDiscDelay>
    <td class=DataLabel>Primary Reason for Discharge Delay</td>
    <td>
      <select name=ptdsc005 id=ptdsc005 class="SelectBig"
       title="Primary Reason for Discharge Delay">
      <option></option>
       %PATWEB96.11.254.001.2
      </select>
    </td>
</tr>
<tr id=SecReasonDiscDelay>
    <td class=DataLabel>Secondary Reason for Discharge Delay</td>
    <td>
      <select name=ptdsc006 id=ptdsc006 class="SelectBig"
       title="Secondary Reason for Discharge Delay">
      <option></option>
       %PATWEB96.11.254.002.2
      </select>
    </td>
</tr>

</table>

<span id=MentalHealth></span>

<table  border=0 width=100% cellspacing=0 cellpadding=4>
  <tr valign=bottom>
    <td colspan=4 width=100% align=center valign=bottom>
     <input type=hidden name=formactn value="Update"> 
     <input type=button value="Update" class=button id=btnUpdate
      onclick="tempDisable(this);discharge();"> 
     <input type=button value="Cancel" class=button
      onclick="history.go(-1)">
 </td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB96.11.003">
<input type=hidden name=admissno value="%PATWEB96.11.081">
<input type=hidden name=MenuType value="%PATWEB96.11.088">
<input type=hidden name=alert001 value="">
</form>

<script type="text/javascript">
if (document.pat96pdf.ismrtmas.value!="1"){
   if(document.pat96pdf.mvmedre1!=undefined) {
    document.pat96pdf.mvmedre1.disabled=true;
   }
}

// document.pat96pdf.dschsref.readonly= true;
// document.pat96pdf.dschsref.ClassName= "Readonly";
// for (var i =0 ; i < document.pat96pdf.trantime.length; i++) {
//   if (document.pat96pdf.trantime.options[i].value=="%PATWEB96.11.103") {
//       document.pat96pdf.trantime.selectedIndex=i } };

//   caretype="%PATWEB96.11.113.3"
//   if(caretype.substr(14,1)==5){
//      document.pat96pdf.dschmhls.className="Mandatory"
//   }
//   privatehosp="%STANDARD.01.025.021.210.1.1"
//   if(privatehosp=="0"){
//      document.pat96pdf.dschsref.className="";
//      document.pat96pdf.dschcrav.className="";
//   }
</script>

<span id=transfersrc style="display:none">
<td><input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
      title="Transfer Destination"
      onblur="validateTransSrc(pat96pdf.trnsfsrc,
                               pat96pdf.trandate1,
                               pat96pdf.trandesc);"
      value="%PATWEB96.11.327.0">
     <input type=text size=27 name=trandesc notab
      class=Readonly readonly value="%PATWEB96.11.327.1">
     <img src="../images/SearchIcon.gif" class=Icon
      onclick="TransferSourceFrame(pat96pdf.trnsfsrc,pat96pdf.trandesc)"></td>
</span>

<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>

<span id=autopsyDiv style="display:none">
<table>
<tr>
<td> Autopsy <input type=checkbox name=dschautp value=1 checked></td>
</tr></table>
</span>

<span id=agedcare1 style="display:none">
    <td class=DataLabel>ACAS Status</td>
</span>

<span id=agedcare2 style="display:none">
    <td><select name=agecaras title="ACAS Status"
        class=Mandatory>
    <option> </option>
     %PATWEB96.11.222.2
     </select></td>
</span>

<span id=Deathnotif1 style="display:none">
<!--   <td class=DataLabel>Death Type</td>      -->
   <td class=DataLabel>Death Notification</td>
</span>

<span id=Deathnotif2 style="display:none">
   <td><select name=dschdety>
       <option> </option>
        %PATWEB96.11.517.2
       </select></td>
</span>

<span id=MHfields style="display:none">
<table  border=0 width=100% cellspacing=0 cellpadding=4>

<tr><td class=HeadingCell align=center colspan=4>
      Mental Health Discharge Form</td>

   <tr><td width=18%>Referral to Further Care</td>
       <td><select name=mehds009 class=Mandatory>
           <option> </option>
            %PATWEB96.11.610.2
           </select></td>
   </tr>
   <tr><td>MH Discharge Status</td>
       <td><select name=mehds020 class=Mandatory>
           <option> </option>
            %PATWEB96.11.621.2
           </select></td>
   </tr>
   <tr><td>Discharge Diagnosis</td>
       <td><input type=text name=mehdi003 size=9 maxlength=9
            value="%PATWEB96.11.704"
            onblur="validateCode(43,
                                 pat96pdf.mehdi003,
                                 pat96pdf.mehdi004);">
           <input type=text name=mehdi004 title="Diagnosis 1" size="30"
            maxlength="30" value="%PATWEB96.11.705">
           <img src="../images/SearchIcon.gif" class=Icon
            onclick='Icd10DisSearchFrame(pat96pdf.mehdi003,pat96pdf.mehdi004)'>
        </td>
   </tr>
   <tr><td>&nbsp;</td>
        <td><input type=text name=mehdi007 size=9 maxlength=9
             value="%PATWEB96.11.708"
             onblur="validateCode(43,
                                  pat96pdf.mehdi007,
                                  pat96pdf.mehdi008);">
            <input type=text name=mehdi008 title="Diagnosis 2" size="30"
             maxlength="30" value="%PATWEB96.11.709">
        <img src=../images/SearchIcon.gif class=Icon
         onclick='Icd10DisSearchFrame(pat96pdf.mehdi007,pat96pdf.mehdi008)'>
        </td>
   </tr>
   <tr><td>&nbsp;</td>
        <td><input type=text name=mehdi035 size=9 maxlength=9
             value="%PATWEB96.11.736"
             onblur="validateCode(43,
                                  pat96pdf.mehdi035,
                                  pat96pdf.mehdi036);">
            <input type=text name=mehdi036 title="Diagnosis 2" size="30"
             maxlength="30" value="%PATWEB96.11.737">
        <img src=../images/SearchIcon.gif class=Icon
         onclick='Icd10DisSearchFrame(pat96pdf.mehdi035,pat96pdf.mehdi036)'>
        </td>
   </tr>
</table>
</span>

<script type="text/javascript">
function statisticalDischarge(){
  p=document.pat96pdf
  if(!isWhitespace(p.ptdslsdn.value)){
    p.d_dschdest.disabled=true;
  }
}
</script>


