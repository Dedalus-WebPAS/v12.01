<meta name="TemplateVersion" content="V12.01.01">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript" src="../js/patweb9810001.js"></script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link                   
//  1 - Date Time
//  2 - Ward Name
//  3 - Bed
//  4 - Ward/Bed
//  5 - Rate
//  6 - Adm type
//  7 - Doctor
//  8 - Code Change
//  9 - Movement
//---------------------------------------------------------------------------

function InitTable() {
document.title="Supervisor Transfer Change for " + 
                document.PatientLinks.dumyname.value;
 t = new Table(1,0,1,"100%","center",40,40);
 t.addColumn("Date & Time","DateTime",1,1,"left","MaintenanceIcon.gif","0",100);
 t.addColumn("Movement","String",9,9,"left","","",60);
 t.addColumn("Ward/Bed","String",4,4,"left","","",90);
 t.addColumn(document.PatientLinks.CLdesc.value,"String",12,12,"left","","",50);
 t.addColumn(document.PatientLinks.admtype.value,"String",6,6,"left","","",100);
 t.addColumn("Resp. Clinician","String",7,7,"left","","",110);
 t.addColumn("Unit","String",10,10,"left","","",70);
 if(document.UpdateForm.ptcnhdps.value==6){
   t.addColumn("Team","String",13,13,"left","","",70);
 }
 t.addColumn("Care Type","String",8,8,"left","","",70);
 t.addColumn("Bed Type","String",11,11,"left","","",80);
 t.addColumn("Registrar","String",14,14,"left","","",100);
 t.addColumn("Resident","String",15,15,"left","","",100);
 t.addColumn("User Id","String",16,16,"left","","",60);
 AddTableRows();
 TableOutput(0,1);    // Order Column,Asc Dsc
}
function LoadWardBeds() {
  var p=document.UpdateForm;
  WardBedSelection(p.trntowrd,p.trntobed,'A',p.d_trntobed);
}
function ChangeTranDateTime(trankey) {
 LinkUrl="patweb98.pbl?reportno=10&template=2" +
         "&transkey=" + trankey.replace(/ /g,"+") +
         "&trnsupty=71";
 Left=(document.body.clientWidth-550)/2;
 DFrameLink(LinkUrl,120,Left,550,350);
}
function ChangeCareDateTime(trankey) {
 LinkUrl="patweb98.pbl?reportno=10&template=2" +
         "&transkey=" + trankey.replace(/ /g,"+") +
         "&trnsupty=72";
 Left=(document.body.clientWidth-550)/2;
 DFrameLink(LinkUrl,120,Left,550,350);
}
function DispAdmError() {
  alert("Cannot alter admission date/time from this screen.");
}
function DispDscError() {
  alert("Cannot alter discharge date/time from this screen.");
}
function DispContractID() {
  i=document.UpdateForm.trntopat.selectedIndex;
  ind=document.UpdateForm.trntopat.options[i].value.substring(14,15);
  ind2=document.UpdateForm.trntopat.options[i].value.substring(14,16);
  hdps=document.UpdateForm.ptcnhdps.value;  // state code
  hdpd=parseInt(document.UpdateForm.trntopat.options[i].value.substr(13,4));

  // only show 'Contract ID' fields for WA (hdps=6) and Admission Type HDP=5
  if (hdps==6) {
    if (ind=="0"||ind=="5"||ind=="9"||ind2=="10"){
      document.getElementById('spContractID').style.display="";
      document.UpdateForm.ptasf003.className="Mandatory";
    }
  }
  else {
    document.getElementById('spContractID').style.display="none";
    document.UpdateForm.ptasf003.className="";
  }
}
function showOffDuty() {
    i=document.UpdateForm.trntoclm.selectedIndex;
    ind=document.UpdateForm.trntoclm.options[i].value.substring(3,4);
    document.UpdateForm.offdutyb.checked=false;
    if (ind=="A") {
        document.getElementById('offduty').style.display="";
        return;
    }
    document.getElementById('offduty').style.display="none";
}
function showFundingSrc(field) {
    i=document.UpdateForm.trntoclm.selectedIndex;
    ind=document.UpdateForm.trntoclm.options[i].value.substring(3,4);

   if (field==undefined) {
//    i=OutputArray.length-1;
//    if(OutputArray[i]!=undefined) {
//      y=OutputArray[i];
//      x=y.substr(40,30);
//      z=trim(document.UpdateForm.keydisch.value);
// 
//     if((trim(x)==z) && (ind=="P")) {
//        document.getElementById('fundingsrc').style.display="";
//        document.UpdateForm.trntofns.className="Mandatory";
//        return;
//     }
//    }

     for (i=0;i<OutputArray.length;i++) {
       y=OutputArray[i];
       x=y.substr(40,30);
       z=trim(document.UpdateForm.keydisch.value);

       if((trim(x)==z) && (ind=="P")) {
         document.getElementById('fundingsrc').style.display="";
         document.UpdateForm.trntofns.className="Mandatory";
         return;
       }
     }
   }
//    if ((field==true) && (ind=="P")) {
    if (ind=="P") {
        document.getElementById('fundingsrc').style.display="";
        document.UpdateForm.trntofns.className="Mandatory";
        return;
    }
    document.getElementById('fundingsrc').style.display="none";
    document.UpdateForm.trntofns.className="";
}

function clearVariables(){

  if(document.getElementById('fundingsrc').style.display=="none"){
     document.getElementById('trntofns').selectedIndex=0;
    i=document.getElementById('trntopat').selectedIndex;
    ind=document.getElementById('trntopat').options[i].value.substring(14,15);
    ind2=document.getElementById('trntopat').options[i].value.substring(14,16);
    if(ind!='0' && ind!='5' && ind!='9' && ind2!='10'){
      document.getElementById('ptasf003').value="";
      document.getElementById('d_ptasf003').value="";
    }
  }    
}
function filterSpecialtyNZ() {
  if (document.UpdateForm.ptcnhdps.value=="1") {
    if (document.UpdateForm.trntopat != undefined) {
      createSpecialtyArray();
      getHCPSpecialtySelectList();
      defaultSpecialty();
    }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DispChangeType();InitTable();
              filterSpecialtyNZ();">

<div id=HeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB98.10.003";
PatientVIS="%PATWEB98.10.081";
PatientNAM="%PATWEB98.10.002";
PatientSTA="%PATWEB98.10.086.078";
PatientALT="%PATWEB98.10.084";
PatientSEX="%PATWEB98.10.019";
PatientDOB="%PATWEB98.10.020";
PatientAGE="%PATWEB98.10.021";
PatientLOC="%PATWEB98.10.083";
PatientPRI="%PATWEB98.10.086.066.1";
PatientUNT="%PATWEB98.10.066.0";
DoctorCOD="%PATWEB98.10.082.003";
DoctorNAM="%PATWEB98.10.082.002";
PatientAID="%PATWEB98.10.086.090";
PatientIND="%PATWEB98.10.086.091";
PatientCUR="%PATWEB98.10.086.092";
PatientCLC="%PATWEB98.10.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB98.10.086.094";
PatientCDM="%PATWEB98.10.086.095";
PatientVDH="%PATWEB98.10.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<form name=UpdateForm action=patweb98.pbl method=get style="margin:0">
<input type=hidden name=reportno value=10>
<input type=hidden name=template value=001>
<input type=hidden name=updttype value=U>
<input type=hidden name=nextpage value=1>
<input type=hidden name=trnsupty value="%PATWEB98.10.206">
<input type=hidden name=urnumber value="%PATWEB98.10.003">
<input type=hidden name=admissno value="%PATWEB98.10.081">
<input type=hidden name=redirect value="%PATWEB98.10.001.patweb98.01.021">
<input type=hidden name=keydisch value="%PATWEB98.10.181">
<input type=hidden name=oldcare value="%PATWEB98.10.313.1">
<input type=hidden name=curclaim value="%PATWEB98.10.326.1">
<input type=hidden name=ptcnhdps value="%STANDARD.01.025.080.250.1.1" />
<!-- parameter below deliberately overwritten as wahealth is set to private-->
<input type=hidden name=chosptyp value="1">
<input type="hidden" name="c_trntopat" id="c_trntopat"
       value="%PATWEB98.10.311.1">
<input type="hidden" name="attddoct" id="attddoct"
       value="%PATWEB98.10.308.003">
<input type="hidden" name="admndate" id="admndate"
       value="%PATWEB98.10.302">

<table width=100% cellspacing=0 cellpadding=0 bgcolor=#cccccc>
<tr>
  <td>
    <div id=TypeOfChange></div>
  </td>
  <td class=DataLabel> &nbsp; Reason for Change
    <select name=chngreas class=Mandatory title="Reason for Change">
      <option></option>
      %STANDARD.01.021.IZ
    </select>
  </td>

  <td align=right>
    <input type=button class="button" value="Update" id=btnUpdate
     onclick="tempDisable(this);clearVariables();UpdateRecords();">
  </td>
</tr>

<div id=Results></div>
</table>
</form>
</div>

<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows() {
%PATWEB98.10.179.1
}
</script>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB98.10.003">
<input type=hidden name=admissno value="%PATWEB98.10.081">
<input type=hidden name=MenuType value="%PATWEB98.10.088">
<input type=hidden name=multifin value="%STANDARD.01.025.118.134.0.1">
<input type=hidden name=dumyname value="%PATWEB98.10.002">
<input type=hidden name=admtype  value="%STANDARD.01.017.A ">
<input type=hidden name=CLdesc   value="%STANDARD.01.017.CL ">
<input type=hidden name="d_wbsehosp" value="%STANDARD.01.032">
</form>

<span id=WardBedChange style="display:none">
  <td class=DataLabel> &nbsp; Ward / Bed
    <input type=hidden name=bedstat1>
    <input type=hidden name=warddesc>
    <select name=trntowrd class=Mandatory title="Ward" 
     onchange="LoadWardBeds();">
      <option></option>
      %PATWEB98.10.205
    </select>
    <input type=hidden name=d_trntobed>
    <select name=trntobed title="Bed" notab></select>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="WardBedSearchFrame(UpdateForm.trntowrd,
                                 UpdateForm.warddesc,
                                 UpdateForm.trntobed,
                                 UpdateForm.bedstat1,
                                 UpdateForm.LoadWardBeds);">
  </td>
</span>

<span id=ClaimTypeChange style="display:none">
  <td class=DataLabel> &nbsp; %STANDARD.01.017.CL 
  <select name=trntoclm class=Mandatory title="%STANDARD.01.017.CL"
   onchange="showFundingSrc();showOffDuty();">
    <option></option>
    %STANDARD.01.007.CL
  </select>

  <span id=fundingsrc style="display:none">
    <td class=DataLabel>Funding Source</td>
    <select name=trntofns title="%STANDARD.01.017.cx" id="trntofns">
      <option></option>
      %PATWEB98.10.598.053.5
    </select>
  </span>

  <span id=offduty style="display:none">
    <td class=DataLabel>Off Duty</td>
    <input type="checkbox" name="offdutyb" value="0">
  </span>
</span>

<span id=PatTypeChange style="display:none">
  <td class=DataLabel> &nbsp; %STANDARD.01.017.A  
  <select name=trntopat class=Mandatory title="%STANDARD.01.017.A "
   id="trntopat" onchange="DispContractID();">
    <option></option>
    %STANDARD.01.007.A 
  </select>
    
  <span id=spContractID style="display:none">
    <td class=DataLabel>&nbsp;</td>
    <td class=DataLabel>Contract ID</td>
    <td>
      <input type="text" size=7 maxlength=5 name=ptasf003 id=ptasf003 
       title="Contract ID"
       onblur="validateCode(9,UpdateForm.ptasf003,UpdateForm.d_ptasf003);"
       value="%PATWEB98.10.399.003.1">
      <input type=text size=27 name=d_ptasf003 id=d_ptasf003 notab
       value="%PATWEB98.10.399.003.2" class=Readonly readonly>
      <img src="../images/SearchIcon.gif" class=icon
       onclick="TransferSourceFrame(UpdateForm.ptasf003,UpdateForm.d_ptasf003)">
    </td>
  </span>
</span>

<span id=DoctorStdChange style="display:none">
  <td class=DataLabel> &nbsp; Responsible Clinician
    <input type=text size=7 name=trntodoc class=Mandatory
     title="Responsible Clinician" onblur="UpCase(this);valDoctorUnit();">
    <input type=text readonly size=35 name=doctnam2>
    <input type=hidden name=dummy value=" ">
    <input type=hidden name=deftunit value="">
    <input type=hidden name=deftteam value="">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="DoctorSearchFrame(UpdateForm.trntodoc,
                                UpdateForm.doctnam2,
                                valDoctorUnit)">
    <img src="../images/erase.gif" class=Icon
     onclick="clrDoc(UpdateForm.trntodoc,UpdateForm.doctnam2);">

    %STANDARD.01.017.AC
    <select name="trntount" class="Mandatory" title="%STANDARD.01.017.AC">
      <option></option>
    </select>
</span>

<span id=DoctorChange style="display:none">
  <td class=DataLabel> &nbsp; Responsible Clinician 
    <input type=text size=7 name=trntodoc class=Mandatory 
     title="Responsible Clinician" onblur="UpCase(this);valDoctorUnit();">
    <input type=text readonly size=35 name=doctnam2>
    <input type=hidden name=dummy value=" ">
    <input type=hidden name=deftunit value="">
    <input type=hidden name=deftteam value="">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="DoctorSearchFrame(UpdateForm.trntodoc,
                                UpdateForm.doctnam2,
                                valDoctorUnit)">
    <img src="../images/erase.gif" class=Icon
     onclick="clrDoc(trntodoc,doctnam2);">

     %STANDARD.01.017.AC 
    <select name="trntount" class="Mandatory" title="%STANDARD.01.017.AC" 
     onchange="valDoctorUnitTeam();">
      <option></option>
    </select>

     Team
    <select name="trntotem" title="Team">
      <option> </option>
    </select>
  </td>
</span>

<span id=RegistrarChange style="display:none">
  <td class=DataLabel> &nbsp; Registrar
    <input type="hidden" name="trntoreg">
    <input type="text" size=20 maxlength=30 name="d_trntoreg" readonly notab>
    <img src="../images/SearchIcon.gif" class=icon
     onclick="HCPSearchFrame(UpdateForm.trntoreg,
                             UpdateForm.d_trntoreg,
                             8);">
    <img src="../images/erase.gif" class=icon
     onclick="clrFields(UpdateForm.trntoreg,UpdateForm.d_trntoreg);">
  </td>
</span>

<span id=ResidentChange style="display:none">
  <td class=DataLabel> &nbsp; Resident
    <input type="hidden" name="trntores">
    <input type="text" size=20 maxlength=30 name="d_trntores" readonly notab>
    <img src="../images/SearchIcon.gif" class=icon
     onclick="HCPSearchFrame(UpdateForm.trntores,UpdateForm.d_trntores,8);">
    <img src="../images/erase.gif" class=icon
     onclick="clrFields(UpdateForm.trntores,UpdateForm.d_trntores);">
  </td>
</span>

<span id=CareTypeChange style="display:none">
  <td class=DataLabel> &nbsp; %STANDARD.01.017.CC 
    <select name=trntocty class=Mandatory title="%STANDARD.01.017.CC ">
      <option></option>
      %STANDARD.01.007.CC 
    </select>
  </td>
</span>

<span id=BedTypeChange style="display:none">
  <td class=DataLabel> &nbsp; %STANDARD.01.017.BT 
    <select name=trntobty class=Mandatory title="%STANDARD.01.017.BT ">
      <option></option>
      %STANDARD.01.007.BT 
    </select>
  </td>
</span>

<span id=DateTimeChange style="display:none">
</span>

