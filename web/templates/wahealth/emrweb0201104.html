<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function changeSenDocDateTime() {
  var validateresult = validateMandatory(document.UpdateForm);
    if (validateresult==true) {
    linkurl="emrweb02.pbl?reportno=1&template=121" +
            "&urnumber=" + document.UpdateForm.urnumber.value +
            "&admissno=" + document.UpdateForm.admissno.value +
            "&suprflag=1";
      Left=(document.body.clientWidth-600)/2;
      DFrameLink(linkurl,100,Left,600,350);
  }
}
function changeIntAssDateTime() {
  var validateresult = validateMandatory(document.UpdateForm);
    if (validateresult==true) {
    linkurl="emrweb02.pbl?reportno=1&template=119" +
            "&urnumber=" + document.UpdateForm.urnumber.value +
            "&admissno=" + document.UpdateForm.admissno.value +
            "&suprflag=1";
      Left=(document.body.clientWidth-600)/2;
      DFrameLink(linkurl,100,Left,600,350);
  }
}
function init() {
PageLocation="?reportno=1&template=4" +
               "&urnumber=" + PatientURN.replace(/ /g,"+") +
               "&admissno=" + PatientVIS.replace(/ /g,"+")
  if(top.content.location.search.substring(1,23)!="reportno=1&template=16"&&
     top.content.location.search.substring(1,23)!="reportno=1&template=17"){
    if (top.content.location.search!=this.location.search) {
      if (top.content.location.search!=PageLocation) {
      top.content.location.href="emrweb02.pbl" + PageLocation } }
  }
}
function validateNurse() {
  validateCode('17',document.UpdateForm.emvis127,
                    document.UpdateForm.dummy1,
                    document.UpdateForm.gnm,
                    SetNurseName);
}
function SetNurseName() {
UpdateForm.dummy1.value=UpdateForm.gnm.value.replace(/\s*$/g,"")+
                              " " +
                            UpdateForm.dummy1.value.replace(/\s*$/g,"");
}

function setRedirect() {
 document.UpdateForm.redirect.value="emrweb02.pbl?reportno=1&template=104;"
}
function changeUndischarge() {
  var validateresult = validateMandatory(document.UpdateForm);
    if (validateresult==true) {
  PatientLinks.reportno.value="01";
  PatientLinks.template.value="108";
  PatientLinks.action="emrweb02.pbl";
  Left=(document.body.clientWidth-600)/2;
  DFrameSubmit(PatientLinks,100,Left,600,300);
  }
}
function changeNurDateTime() {
  var validateresult = validateMandatory(document.UpdateForm);
    if (validateresult==true) {
  PatientLinks.reportno.value="01";
  PatientLinks.template.value="112";
  PatientLinks.action="emrweb02.pbl";
  Left=(document.body.clientWidth-600)/2;
  DFrameSubmit(PatientLinks,100,Left,600,300);
  }
}
function linkAdmission() {
  var validateresult = validateMandatory(document.UpdateForm);
    if (validateresult==true) {
  PatientLinks.reportno.value="01";
  PatientLinks.template.value="114";
  PatientLinks.action="emrweb02.pbl";
  Left=(document.body.clientWidth-750)/2;
  DFrameSubmit(PatientLinks,50,Left,750,500);
  }
}
function changeDocDateTime() {
  var validateresult = validateMandatory(document.UpdateForm);
    if (validateresult==true) {
  PatientLinks.reportno.value="01";
  PatientLinks.template.value="111";
  PatientLinks.action="emrweb02.pbl";
  Left=(document.body.clientWidth-600)/2;
  DFrameSubmit(PatientLinks,100,Left,600,300);
  }
}
function setUndischarge() {
    if(!isWhitespace(document.UpdateForm.username.value)) {
      getUserIDForLoginName(UpdateForm.username,UpdateForm.webuseid);
    }
    var validateresult = validateMandatory(document.UpdateForm);
    if (validateresult==true) {
      document.UpdateForm.nextpage.value="1";
      document.UpdateForm.formactn.value="U ";
      document.UpdateForm.updttype.value="UNDIS";
      document.UpdateForm.emvis033.value = " ";
      document.UpdateForm.emvis037.value = " ";
      document.UpdateForm.pmsvx075.value = " ";
      DFrameHide(UpdateForm);
   }
}
function PostDischarge() {
  document.UpdateForm.redirect.value="emrweb02.pbl?reportno=1&template=104";
  document.UpdateForm.nextpage.value="8";
  document.UpdateForm.suprflag.value="Y";
  document.UpdateForm.formactn.value="D ";
  document.UpdateForm.updttype.value="DISCH";
  var validateresult = validateMandatory(document.UpdateForm);
  if (validateresult==true) {
    SubmitHidden(UpdateForm);
  }
}
function deleteEvent() {
  var validateresult = validateMandatory(document.UpdateForm);
    if (validateresult==true) {
  linkurl="emrweb02.pbl?reportno=1&template=103" +
      "&urnumber=" + document.UpdateForm.urnumber.value +
      "&admissno=" + document.UpdateForm.admissno.value;
  Left=(document.body.clientWidth-420)/2;
  DFrameLink(linkurl,0,Left,420,130);
 }
}
function SyncDates(){
  document.UpdateForm.emvis001.value=document.UpdateForm.emvis128.value;
  document.UpdateForm.emvis002.value=document.UpdateForm.emvis129.value;
  return; 
}
function setFormactn(type) {
    p=document.UpdateForm;
    p.updfield.value=type;
    p.reasonfc.value=document.getElementById('reason'+type).value;
    document.getElementById('reason'+type).className='Mandatory';

    if (type=='01') {
      document.getElementById('emvis001').className='Mandatory';
      document.getElementById('emvis002').className='Mandatory';
    }

    if (type=='02') {
      document.getElementById('emvis128').className='Mandatory';
      document.getElementById('emvis129').className='Mandatory';
    }

    setRedirect();
    document.UpdateForm.nextpage.value="1";
    document.UpdateForm.formactn.value="C1";
    document.UpdateForm.updttype.value="ERROR";
    if(!isWhitespace(document.UpdateForm.username.value)) {
      getUserIDForLoginName(UpdateForm.username,UpdateForm.webuseid);
    }
    var validateresult = validateMandatory(document.UpdateForm);
    if (validateresult==true) {
       SubmitHidden(UpdateForm);
    }
}
function changePatient() {
   PMenuLinkTo('../cgi-bin/emrweb02.pbl|01|008|1|400|150');
}
function changeClinical() {
      var validateresult = validateMandatory(document.UpdateForm);
      if (validateresult==true) {
         PMenuLinkTo('../cgi-bin/emrweb02.pbl|01|110|0|0|0');
      }
}
function changeDischarge() {
    document.UpdateForm.template.value="109";
    document.UpdateForm.reportno.value="1";
    document.UpdateForm.nextpage.value="1";
    document.UpdateForm.formactn.value="";
    document.UpdateForm.updttype.value="";
    document.UpdateForm.suprflag.value="Y";
    var validateresult = validateMandatory(document.UpdateForm);
    if (validateresult==true) {
       document.UpdateForm.submit();
    }
}
function changeInjury() {
  var validateresult = validateMandatory(document.UpdateForm);
    if (validateresult==true) {
  PatientLinks.reportno.value="01";
  PatientLinks.template.value="072";
  PatientLinks.action="emrweb02.pbl";
  Left=(document.body.clientWidth-600)/2;
  DFrameSubmit(PatientLinks,100,Left,600,300);
  }
}
function changeUR() {
  var validateresult = validateMandatory(document.UpdateForm);
    if (validateresult==true) {
  PatientLinks.action="patweb98.pbl";
  PatientLinks.reportno.value="01";
  PatientLinks.template.value="066";
  Left=(document.body.clientWidth-600)/2;
  DFrameSubmit(PatientLinks,100,Left,600,300);
  }
}
function AccessAll() {
  if(!isWhitespace(document.UpdateForm.accessal.value)) {
    document.UpdateForm.username.value=document.UpdateForm.accessal.value;
    document.UpdateForm.username.className="Readonly";
    document.UpdateForm.username.readOnly=true; 
    document.UpdateForm.password.className="Readonly";
    document.UpdateForm.password.readOnly=true;
  } 
}
function ValDate(dateField,timeField) {
   if(!checkDate(dateField,dateField.title)) {
      return;
   }
   CheckFutureDate(UpdateForm,dateField,timeField);

}

function ValTime(dateField,timeField) {
   if(!checkTime(timeField,timeField.title)) {
      return;
   }
   CheckFutureTime(UpdateForm,dateField.value,timeField);
}

function CheckFutureTime(theForm,checkdate,checktime) {
 SetCurrentDateTimeNoFocus(null,theForm.currtime);// UNIX time
 if (SetDateYYYYMMDD(checkdate)==(theForm.currdate.value)) {
   var newttime=trim(checktime.value.replace(/:/g,"")) - 0
   var currentt=trim(theForm.currtime.value.replace(/:/g,"")) - 0
   if(newttime>currentt){
   alert("Time is in the future");
   checktime.value="";
   FocusDelay(checktime);}
 }
}

function CheckFutureDate(theForm,checkdate,checktime) {
 SetCurrentDateTimeNoFocus(null,theForm.currtime);// UNIX time

 if((theForm.currdate.value)<SetDateYYYYMMDD(checkdate.value)) {
   alert("Date is in the future");
   checkdate.focus();
   return false;
 } else {
  if((theForm.currdate.value)==SetDateYYYYMMDD(checkdate.value)) {
     if (!isWhitespace(checktime.value)) {
       var newttime=trim(checktime.value.replace(/:/g,"")) - 0
       var currentt=trim(theForm.currtime.value.replace(/:/g,"")) - 0
       if(newttime>currentt){
       alert("Time is in the future");
       checktime.value="";
       FocusDelay(checktime);}
     }
  }
 }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);AccessAll();self.focus();
              UpdateForm.emvis001.focus();">
<div id=PatientHeading></div>
<div id=PageBodySection>
<script type="text/javascript">
PatientURN="%EMRWEB02.01.003";
PatientVIS="%EMRWEB02.01.081";
PatientNAM="%EMRWEB02.01.002";
PatientSTA="%EMRWEB02.01.086.078";
PatientALT="%EMRWEB02.01.084";
PatientSEX="%EMRWEB02.01.019";
PatientDOB="%EMRWEB02.01.020";
PatientAGE="%EMRWEB02.01.021";
PatientLOC="%EMRWEB02.01.083";
PatientPRI="%EMRWEB02.01.086.066.1";
PatientUNT="%EMRWEB02.01.066.0";
PatientIND="%EMRWEB02.01.086.091";
GpCOD="%EMRWEB02.01.086.084.001";
GpNAM="%EMRWEB02.01.086.084.081";
GpPRAC="%EMRWEB02.01.086.085.001";
GpPRACCNT="%EMRWEB02.01.086.085.002";
GpPRACNAM="%EMRWEB02.01.086.085.005";
PatientARR="%EMRWEB02.01.101.0 %EMRWEB02.01.102";
PatientSEE="%EMRWEB02.01.130.0 %EMRWEB02.01.131";
PatientTRI="%EMRWEB02.01.103.3";
PatientECLC="%EMRWEB02.01.484.1";
PatientCLH="%STANDARD.01.017.CL";
PatientEHFT="%EMRWEB02.01.485";
InsertEmergencyHeader()
</script>
<div id=PatientMenu></div>

<form name=UpdateForm action="emrweb02.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="01">
<input type=hidden name=updfield value="">
<input type=hidden name=reasonfc value="">
<input type=hidden name=resavail value="%EMRWEB02.01.168">
<input type=hidden name=template value="001">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=emvis118 value="%EMRWEB02.01.003">
<input type=hidden name=formactn>
<input type=hidden name=redirect>
<input type=hidden name=updateky value="%EMRWEB02.01.404">
<input type=hidden name=updttype>
<input type=hidden name=pmpxi067 value="%EMRWEB02.01.667.0">
<input type=hidden name=nextpage>
<input type=hidden name=suprflag>
<input type=hidden name=emvis058>
<input type=hidden name=emvis147>
<input type=hidden name=newloctn>
<input type=hidden name=webuseid value="">
<input type=hidden name=calcwait value="">
<input type=hidden name=accessal value="%EMRWEB02.01.487">
<input type=hidden name=emvis033 value="%EMRWEB02.01.133.1">
<input type=hidden name=emvis037 value="%EMRWEB02.01.137">
<input type=hidden name=pmsvx075 value="%EMRWEB02.01.515">
<input type=hidden name=currdate value="%STANDARD.01.013">
<input type=hidden name=currtime>

<table width=100% border=1 cellspacing=0 cellpadding=0>
<tr valign=top><td>
<table width=100% border=0 cellspacing=0 cellpadding=2>
    <tr><td class=DataLabel width=10%>Arrival Date </td>
    <td class=DataLabel width=25%><input type="text" name=emvis001 size="12" 
        class="PastDate" title="Arrival Date"
        id=emvis001      value="%EMRWEB02.01.101.0"
        onblur="ValDate(UpdateForm.emvis001,UpdateForm.emvis002);"
        >
     <img src=../images/DateLookup.gif class="Icon"
      date=document.UpdateForm.emvis001>

        Time
        <input type="text" name=emvis002 size="8" value="%EMRWEB02.01.102"
               onblur="ValTime(UpdateForm.emvis001,UpdateForm.emvis002)"
               id=emvis002 title="Arrival Time">
        <img src=../images/TimeLookup.gif class="Icon"
        onclick="TimeLookupFrame(UpdateForm.emvis002);">
        <img src="../images/stopwat1.gif" class="Icon"
        onclick="SetCurrentDateTime(UpdateForm.emvis001,UpdateForm.emvis002);">
     </td>
     <td>Reason for Change
     <select id=reason01 name=reason01 title="Arrival Date Reason for Change">
         <option></option>
         %STANDARD.01.007.FW
        </select>
     <input type=button class="button" value="Update"
      onclick="setFormactn('01');">
    </td>
    <td width=30%></td>
</tr>

    <tr><td colspan=3><hr></td></tr>

    <tr><td class=DataLabel>Triage Date </td>
        <td class=DataLabel>
        <input type="text" name=emvis128 size="12" value="%EMRWEB02.01.162.0"
         onblur="ValDate(UpdateForm.emvis128,UpdateForm.emvis129);"
         id=emvis128 title="Triage Date">
        <img src=../images/DateLookup.gif class="Icon"
         date=document.UpdateForm.emvis128>
        Time
        <input type="text" name=emvis129 size="8" value="%EMRWEB02.01.163"
         onblur="ValTime(UpdateForm.emvis128,UpdateForm.emvis129);" 
         id=emvis129 title="Triage Time">
        <img src=../images/TimeLookup.gif class="Icon"
         onclick="TimeLookupFrame(UpdateForm.emvis129);">
        <img src="../images/stopwat1.gif" class="Icon"
         onclick="SetCurrentDateTime(UpdateForm.emvis128,UpdateForm.emvis129);">
     </td>
     <td>Reason for Change
     <select id=reason02 name=reason02 title="Triage Date Reason for Change">
         <option></option>
         %STANDARD.01.007.FW
        </select>
     <input type=button class="button" value="Update"
      onclick="setFormactn('02');">
     </td></tr>

    <tr><td colspan=3><hr></td></tr>

    <tr><td class=DataLabel>Triage Category
     <td><table border=0 cellspacing=0>
     <tr>
     <td class=Triage1><i>1</i><input type=radio name=emvis003 value=1></td>
     <td class=Triage2><i>2</i><input type=radio name=emvis003 value=2></td>
     <td class=Triage3><i>3</i><input type=radio name=emvis003 value=3></td>
     <td class=Triage4><i>4</i><input type=radio name=emvis003 value=4></td>
     <td class=Triage5><i>5</i><input type=radio name=emvis003 value=5></td>
     </tr></table></td>
     <td>Reason for Change
     <select name=reason03 title="Triage Category Reason for Change"
         id=reason03>
         <option></option>
         %STANDARD.01.007.FW
        </select>
     <input type=button class="button" value="Update"
       onclick="setFormactn('03');">
     </td></tr>

    <tr><td colspan=3><hr></td></tr>

<tr><td class=DataLabel>Triage Nurse </td>
    <td><input type=hidden name=gnm>
        <input type="text" name=emvis127 size=6 class=Readonly readonly
         onblur="UpCase(this);validateNurse(UpdateForm.emvis127,UpdateForm.dummy1);"
         id=emvis127 title="Triage Nurse" value="%EMRWEB02.01.161.1">
        <input type="text" name=dummy1 size=20 class=Readonly readonly
         tabindex=-1 value="%EMRWEB02.01.161.0">
        <img src=../images/SearchIcon.gif class="Icon" name=nursebut
         onclick='NurseSearchFrame(UpdateForm.emvis127,UpdateForm.dummy1);'>
     <td>Reason for Change
     <select id=reason08 name=reason08 title="Triage Nurse Reason for Change">
     <option></option>
      %STANDARD.01.007.FW
        </select>
     <input type=button class="button" value="Update"
      onclick="setFormactn('08');">
    </td>
</tr>

    <tr><td colspan=3><hr></td></tr>

    <tr><td class=DataLabel>Username</td>
      <td class=DataLabel>
          <input size=12 type=text name=username class=Mandatory
           title="Username">
          Password
          <input size=12 type=password name=password title="Password"
           class=Mandatory></td></tr>

    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>

    <tr><td colspan=5 align=center>
      <input type=button class="BigButton" value="Delete" 
       onclick="deleteEvent();">
      <input type=button class="BigButton" 
       value="Undischarge" onclick="changeUndischarge();">
      <input type=button class="BigButton" 
       value="Change Patient" onclick="changePatient();">
      <input type=button class="BigButton" 
       value="Clinical Screen" onclick="changeClinical();">
      <input type=button class="BigButton" 
       value="Doctor date/time" onclick="changeDocDateTime();">
      <input type=button class="BigButton" 
       value="Nurse date/time" onclick="changeNurDateTime();">
      <input type=button class="BigButton" 
       value="Update Discharge" onclick="changeDischarge();">
      <input type=button class="BigButton" name=injbuttn
       value="Injury Data" onclick="changeInjury();">
      <input type=button class="BigButton" 
       value="Change U/R" onclick="changeUR();">
      <input type=button class="BigButton" 
       value="Link Admission" onclick="linkAdmission();">
      <input type=button class="BigButton" name="intasbut"
       value="Initial Assessor" onclick="changeIntAssDateTime();">
      <input type=button class="BigButton" name="sendcbut"
       value="Senior Doctor" onclick="changeSenDocDateTime();">
        </td></tr>
    </table>
</td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=MenuType value="%EMRWEB02.01.088">
</form>
<script type="text/javascript">
 var RadioIndex=%EMRWEB02.01.103.1 - 1           // Starts at 0 so sub 1
 if(RadioIndex!=-1) {
 document.UpdateForm.emvis003[RadioIndex].checked=1 // Set Current Checked Value
 document.UpdateForm.nursebut.disabled=false;
 document.UpdateForm.emvis127.readOnly=false;
 document.UpdateForm.emvis127.className="Mandatory"
 } 
 CTypeAdm="%EMRWEB02.01.252";
 if ( CTypeAdm == "Yes") {
   document.UpdateForm.emvis147.value=1; }
 else { 
   document.UpdateForm.emvis147.value=0; }
//
 Discharged="%EMRWEB02.01.147";
 if(Discharged==2 || Discharged==3){
   document.UpdateForm.calcwait.value="1";
 }
 if(Discharged=="4") {
   alert("Warning: This visit is cancelled");
 }
 InjData="%EMRWEB02.01.188";
 if ( InjData =="1" ) {
    document.UpdateForm.injbuttn.className="RedButton";
 }
// if(!isWhitespace("%EMRWEB02.01.271.1")) {
//    document.UpdateForm.mhprabut.className="RedButton";
// }
 if(!isWhitespace("%EMRWEB02.01.270.  3")) {
    document.UpdateForm.intasbut.className="RedButton";
 }
 if(!isWhitespace("%EMRWEB02.01.269.  3")) {
    document.UpdateForm.sendcbut.className="RedButton";
 }
</script>
