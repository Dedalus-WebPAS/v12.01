<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="wahealth">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src="../js/preadmission.js">   </script>
<script type="text/javascript">
function SubmitAdm() {
  MandatoryOk=true;
  if (!validateMandatory(document.UpdateForm)) {
     return;
  }

  if (document.UpdateForm.admitbox.value==1) {
    dateDiff=parseInt(SetDateYYYYMMDD(document.UpdateForm.ptmis001.value)) -
             parseInt(DemConDate);
    if (checkDemographicsUpdated(dateDiff,NoDayDemVl,ConfDemogs)){
      return;
    }
  }

  if (!isWhitespace(document.UpdateForm.dispt001.value)) {
    var serverURL   = "../cgi-bin/comweb80.pbl?reportno=44" +
                    "&valdcode=" + UpdateForm.dispt001.value.replace(/ /g,"+") +
                    UpdateForm.ptmis001.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {
      return;
    }
  }


  if(document.UpdateForm.mvmedre1.checked == true) {
     document.UpdateForm.mvmedrec.value="1";
  } else {
     document.UpdateForm.mvmedrec.value="0";
  }
  if (MandatoryOk) {
    SetRedirect();
    UpdateForm.ptmis004.value=UpdateForm.ptmis068.value;
    UpdateForm.ptmis005.value=UpdateForm.ptmis076.value;
    SubmitHidden(UpdateForm);
    }
}
function SetRedirect(){
    document.UpdateForm.redirect.value="patweb89.pbl?reportno=07&template=001"
     + "&urnumber=" + document.UpdateForm.urnumber.value
     + "&admissno=";
}
function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
  selectOptions4("45",UpdateForm.ptmis007,UpdateForm.dummy,UpdateForm.ptmis024);
  if(document.UpdateForm.ptmis024.length=="2"){
    UpdateForm.ptmis024.selectedIndex=1
  }
  valDoctorUnitTeam();
}          
function valDoctorUnitTeam() {
  selectOptions4("46",UpdateForm.ptmis007,UpdateForm.ptmis024,UpdateForm.ptvis124);            
  if(document.UpdateForm.ptvis124.length=="2"){
    UpdateForm.ptvis124.selectedIndex=1
  }
  if (UpdateForm.ptvis124.length>1) {
    UpdateForm.ptvis124.className = "Mandatory"; }
  else { UpdateForm.ptvis124.className = ""; }
}              
function AdmitMandatory() {
  p = document.UpdateForm;
  if (p.admitbox.checked == true) {
     p.admitbox.value="1";
     p.ptmis011.className="Mandatory";  //admission type
     p.ptmis009.className="Mandatory";  //admission source
     p.ptmis024.className="Mandatory";  //Speciality
     p.ptmis012.className="Mandatory";  //care type
     p.ptmis010.className="Mandatory";  //Patient type
     p.ptmis027.className="Mandatory";  //Financial Class
     p.ptvis046.className="Mandatory";  //Admitting Point
     p.ptvis093.className="Mandatory";  //Preferred Accommodation
     p.ptvis104.className="Mandatory";  //Employment Status
     p.ptvis043.className="Mandatory";  //Intended Stay
     p.ptvis022.className="Mandatory";  //Inform GP
     p.ptvis125.className="Mandatory";  //Non WA Hospital Contact

  } else {
     p.admitbox.value="0";
     p.ptmis011.className="";  //admission type
     p.ptmis009.className="";  //admission source
     p.ptmis024.className="";  //Speciality
     p.ptmis012.className="";  //care type
     p.ptmis010.className="";  //Patient type
     p.ptmis027.className="";  //Financial Class
     p.ptvis046.className="";  //Admitting Point
     p.ptvis093.className="";  //Preferred Accommodation
     p.ptvis104.className="";  //Employment Status
     p.ptvis043.className="";  //Intended Stay
     p.ptvis043.className="";  //Intended Stay
     p.ptvis022.className="";  //Inform GP
     p.ptvis125.className="";  //Non WA Hospital Contact
  }
}
function valClaimCode() {
  validateCode(41,UpdateForm.urnumber,UpdateForm.claimc);
  for (var i =0 ; i < document.UpdateForm.ptmis027.length; i++) {
    if (document.UpdateForm.claimc.value==
        trim(document.UpdateForm.ptmis027.options[i].value.substr(0,3))){
          document.UpdateForm.ptmis027.selectedIndex=i;
    }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);document.UpdateForm.ptmis001.focus();
              valClaimCode();showFundingSource();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.03.003";
PatientVIS="%PATWEB89.03.081";
PatientNAM="%PATWEB89.03.002";
PatientSTA="%PATWEB89.03.086.078";
PatientALT="%PATWEB89.03.084";
PatientSEX="%PATWEB89.03.019";
PatientDOB="%PATWEB89.03.020";
PatientAGE="%PATWEB89.03.021";
PatientLOC="%PATWEB89.03.083";
PatientPRI="%PATWEB89.03.086.066.1";
PatientUNT="%PATWEB89.03.066.0";
DoctorCOD="%PATWEB89.03.082.003";
DoctorNAM="%PATWEB89.03.082.002";
PatientAID="%PATWEB89.03.086.090";
PatientIND="%PATWEB89.03.086.091";
PatientCUR="%PATWEB89.03.086.092";
PatientCLC="%PATWEB89.03.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.03.086.094";
PatientCDM="%PATWEB89.03.086.095";
PatientVDH="%PATWEB89.03.086.099.015";
ConfDemogs="%STANDARD.01.045.PTCNCDOA";
NoDayDemVl=trim("%STANDARD.01.045.PTCNNDCD");
DemConDate=SetDateYYYYMMDD("%PATWEB89.03.085.059");
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>

<form name=UpdateForm id=UpdateForm method=post action=patweb89.pbl>
<input type=hidden name=urnumber id=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno id=admissno value="%PATWEB89.03.081">
<input type=hidden name=reportno id=reportno value="2">
<input type=hidden name=template id=template value="001">
<input type=hidden name=mhadmflg id=mhadmflg value="1">
<input type=hidden name=updatety id=updatety value="1">
<input type=hidden name=redirect id=redirect>
<input type=hidden name=allocate id=allocate value="1">
<input type=hidden name=chckname id=chckname value="0">
<input type=hidden name=emradmit id=emradmit value="0">
<input type=hidden name=emradmis id=emradmis value="0">
<input type=hidden name=admitnow id=admitnow value="1">
<input type=hidden name=newbmand id=newbmand value="0">
<input type=hidden name=agebmand id=agebmand value="0">
<input type=hidden name=ptmas046 id=ptmas046 value="0">
<input type=hidden name=mvmedrec id=mvmedrec>
<input type=hidden name=claimc id=claimc>
<input type=hidden name=exstward id=exstward value="%PATWEB89.03.449.1">
<input type=hidden name=ptmis013 id=ptmis013 value="%PATWEB89.03.040.0">
<input type=hidden name=ptmis014 id=ptmis014 value="%PATWEB89.03.041.0">
<input type=hidden name=ptmis015 id=ptmis015 value="%PATWEB89.03.042">
<input type=hidden name=pmsvx142 id=pmsvx142 value="%PATWEB89.03.899.010">
<input type=hidden name=ptcnhdps id=ptcnhdps 
       value="%STANDARD.01.025.080.250.1.1">

<table border=0 colspan=0 width=100% cellspacing=0 cellpadding=0>
<tr><td class=HeadingCell align=center>
    Mental Health Pre-Admission Details (New) </tr>
<tr>
<tr><td>
    <table width=100%  border=0 class=TableBody cellpadding=0 cellspacing=0>
     <tr><td align=left><b>Admit Now?</b></td>
        <td align=left>
        <input type="checkbox" name="admitbox" id="admitbox" value="0" notab
           onclick='AdmitMandatory()'></td>
         <td>&nbsp;</td><td>&nbsp;</td>
        </tr>

     <tr><td class=DataLabel>Admission Date </td>
         <td><input type=text size=12 name=ptmis001 id=ptmis001 tabindex=1
             class="Mandatory Date" title="Admission Date"
             value="%STANDARD.01.015">
         <img notab src="../images/DateLookup.gif" class=Icon
          onclick="DateLookupFrame(ptmis001);">
          Time
       <input class=Mandatory type=text name=ptmis002 id=ptmis002 size=8 tabindex=2
          value="%STANDARD.01.016" title="Admission Time">
        <img notab src="../images/DateTimeStamp.gif" class=Icon
         onclick="SetCurrentDateTime(null,ptmis002);">
       <img notab src="../images/TimeLookup.gif" class=Icon
         onclick="TimeLookupFrame(ptmis002);">
          </td>
    <td>Admitting Point</td>
    <td><select name=ptvis046 id=ptvis046 tabindex=50 title="Admitting Point"
         onchange="defaultWard()">
         <option></option>
          %PATWEB89.03.290.2
        </select>
       </td>

      </tr>

<tr> <td class=DataLabel>%STANDARD.01.017.P </td>
          <td><select name=ptmis011 id=ptmis011 tabindex=3
               title="%STANDARD.01.017.P ">
              <option> </option>
                 %PATWEB89.03.112.2
              </select>
           <span id=BabyAge style="display:none">
               Admission Weight
               <input type=text name=ptmis051 id=ptmis051 size=5 maxlength=4 value=""
                    title="Admission Weight" >grams
           </span>
          </td>
         <td class=DataLabel>Ward / Bed </td>
         <td><input type=hidden name=bedstat1 id=bedstat1>
           <input type=hidden name=ptmis004 id=ptmis004>
           <input type=hidden name=ptmis005 id=ptmis005>
           <input type=hidden name=warddesc id=warddesc>
           <select name=ptmis068 id=ptmis068 tabindex=55 title="Ward" class=Mandatory >
            <option> </option>
            %PATWEB89.03.449.2
           </select>
           <input type=text name=ptmis076 id=ptmis076 notab maxlength=3 size=3
                  title="Bed">
           <img notab src="../images/SearchIcon.gif" border=0 vspace=1
            class=Icon
            onclick="WardBedSearchFrame(ptmis068,warddesc,ptmis076,bedstat1);">
          </td>
</tr>
<tr><td class=DataLabel>%STANDARD.01.017.S </td>
          <td><select name=ptmis009 id=ptmis009 tabindex=4
               onchange="DisplayTransfer();" title="%STANDARD.01.017.S ">
               <option> </option>
               %PATWEB89.03.110.2
               </select></td>
         <td class=DataLabel>%STANDARD.01.017.BP</td>
         <td><select name=ptvis093 id=ptvis093 title="%STANDARD.01.017.BP"
              tabindex=60 >
               <option> </option>
                %PATWEB89.03.298.012.2
             </select>
         </td>
</tr>

<tr id="transferxx" style="display:none">
<td class=DataLabel>Transfer Source</td>
<td><input type="text" size=7 maxlength=5 name=trnsfsrc id=trnsfsrc
      title="Transfer Source" tabindex=5
      onchange="validateCode(9,trnsfsrc,trandesc);">
     <input type=text size=27 name=trandesc id=trandesc notab
      class=Readonly readonly>
     <img src="../images/SearchIcon.gif" class=Icon
      onclick="TransferSourceFrame(trnsfsrc,trandesc)"></td>
</tr>
<tr><td class=DataLabel>Referring Clinician</td>
    <td><input type="text" size=10 maxlength=10 name=ptvis028 id=ptvis028 tabindex=7
               value="%PATWEB89.03.231.1"
        onchange="ReadDoc(18,0,ptvis028,genpname,ptvis029,genpprac,ptvis030,genpprov);">
        <input type=text size=25 notab readonly name=genpname id=genpname
               value="%PATWEB89.03.231.0">
        <img src="../images/SearchIcon.gif" class=Icon
        onclick="GPHCPSearchFrame(ptvis028,genpname,genpprov,ptvis029,genpprac,ptvis030,0)">
        <img src="../images/erase.gif" class=Icon
         onclick="clrFields(ptvis028,genpname);"></td>
    <td class=DataLabel>Post Op Ward/Bed</td>
     <td><input type=hidden name=popwdesc id=popwdesc>
                 <input type=hidden name=popbstat id=popbstat>
                 <select name=ptvis048 id=ptvis048 tabindex=65>
                 <option></option>
                 %PATWEB89.03.251.2
                 </select>
                 <input type=hidden name=dummy id=dummy>
                 <img src="../images/SearchIcon.gif" border=0 vspace=1
             class=Icon
             onclick="WardBedSearchFrame(ptvis048,popwdesc,dummy,popbstat);">
             </td>

</tr>
<tr><td class=DataLabel>Practice</td>
    <td><input type=text name=genpprac id=genpprac size=35 readonly
                 value="%PATWEB89.03.232.0" notab>
          <input type=hidden name=ptvis029 id=ptvis029 value="%PATWEB89.03.232.1">
          <input type=hidden name=ptvis030 id=ptvis030 value="%PATWEB89.03.233.1">
          <input type=hidden name=genpprov id=genpprov value="">
          <img src="../images/SearchIcon.gif" class=Icon
 onclick="GPHCGSearchFrame(ptvis028,genpname,genpprov,ptvis029,genpprac,ptvis030)">
 <img src="../images/erase.gif" class=Icon
  onclick="clrFields(ptvis029,genpprac,ptvis030,genpprov);">
      </td>
     <td class=DataLabel>%STANDARD.01.017.cw</td>
         <td><select name=ptvis125 id=ptvis125 title="%STANDARD.01.017.cw"
              tabindex=100>
               <option> </option>
                %PATWEB89.03.298.047.2
             </select>
         </td>
</tr>
<tr>
    <td class=DataLabel>%STANDARD.01.017.SI</td>
    <td><select name=ptvis103 id=ptvis103 tabindex=8
         title="%STANDARD.01.017.SI">
         <option></option>
          %PATWEB89.03.298.025.4
         </select></td>
        <td align=left>Hosp Last 7 Days</td>
        <td align=left>
        <input type="checkbox" name="prevhosp" id="prevhosp" value="1" tabindex=105>
        </td>
</tr>
<tr><td class=DataLabel>Responsible Clinician</td>
          <td><input type="text" size=8 maxlength=6 name="ptmis007" id="ptmis007" tabindex=10
              title="Responsible Clinician" class=Mandatory
              onchange="UpCase(this);valDoctorUnit();">
              <input type=text readonly size=25 notab name=doctnam2 id=doctnam2
               title="Responsible Clinician">
              <img notab src="../images/SearchIcon.gif" class=Icon
             onclick="DoctorSearchFrame(ptmis007,doctnam2,valDoctorUnit)">
          </td>
    <td class=DataLabel>%STANDARD.01.017.KD</td>
    <td><select name=ptvis104 id=ptvis104 tabindex=110
         title="%STANDARD.01.017.KD">
         <option></option>
          %PATWEB89.03.298.026.2
         </select></td>
</tr>
<tr><td class=DataLabel>%STANDARD.01.017.AC</td>
          <td><select name=ptmis024 id=ptmis024 tabindex=15
               title="%STANDARD.01.017.AC" onchange="valDoctorUnitTeam();">
              <option> </option>
                 %PATWEB89.03.124.2
              </select>
          </td>
         <td class=DataLabel>Diagnosis(text) </td>
         <td><input tabindex=115 type=text name="ptmis020" id="ptmis020" size=50 maxlength=80>
          </td>
</tr>
<tr><td class=DataLabel>Team</td>
          <td><select name=ptvis124 id=ptvis124 tabindex=25 
               title="Team">
              <option> </option>
               %PATWEB89.03.298.046.2
              </select>
          </td>
<td class=DataLabel>Diagnosis(ICD)</td>
      <td><input type=text name=ptvis075 id=ptvis075 title="ICD Code" size=10 tabindex=120
           onblur='validateCode(6,UpdateForm.ptvis075,UpdateForm.drgdesc1)'>
      <input type=text size=30 name=drgdesc1 id=drgdesc1 title="ICD Description"
       value="" readonly>
    <img src="../images/SearchIcon.gif" alt="Disease Search" class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.ptvis075,UpdateForm.drgdesc1,UpdateForm.drgdesc2);">
    </td>
</tr>
<tr><td class=DataLabel>Registrar</td>
    <td><input type=hidden name="ptvis060" id="ptvis060" value="">
        <input type="text" size=20 maxlength=30 name="d_ptvis060" id="d_ptvis060"
         value="" readonly notab>
        <img src="../images/SearchIcon.gif" class=Icon
        onclick="HCPSearchFrame(ptvis060,d_ptvis060,8);">
        <img src="../images/erase.gif" class=Icon
        onclick="clrFields(ptvis060,d_ptvis060);">
</td>
          <td class=DataLabel>%STANDARD.01.017.VI</td>
          <td class=DataLabel>
             <select name=ptvis043 id=ptvis043 tabindex=125 title="%STANDARD.01.017.VI">
             <option> </option>
              %PATWEB89.03.246.2
             </select>
        </td>
</tr>
<tr><td class=DataLabel>Resident</td>
    <td><input type=hidden name="ptvis061" id="ptvis061" value="">
        <input type="text" size=20 maxlength=30 name="d_ptvis061" id="d_ptvis061"
         value="" readonly notab>
        <img src="../images/SearchIcon.gif" class=Icon
        onclick="HCPSearchFrame(ptvis061,d_ptvis061,8);">
        <img src="../images/erase.gif" class=Icon
        onclick="clrFields(ptvis061,d_ptvis061);">
</td>
        <td class=DataLabel> Planned Length of Stay</td>
        <td><input type=text size=5 maxlength=5 name=ptmis030 id=ptmis030
         tabindex=135 title='Planned Length of Stay'
         class=Integer onblur="checkInteger(this,this.value);">
        </td>
</tr>
<tr> <td class=DataLabel>%STANDARD.01.017.CC</td>
          <td><select name=ptmis012 id=ptmis012 tabindex=35 title="%STANDARD.01.017.CC" >
              <option></option>
              %PATWEB89.03.113.2
              </select></td>
      <td class=DataLabel>Inform GP</td>
      <td>
        <select name=ptvis022 id=ptvis022 tabindex=145 title="Inform GP">
        <option value=" ">  </option>
        <option value="0">No</option>
        <option value="1">Yes</option>
        </select>
        </td>
</tr>
<tr> <td class=DataLabel>%STANDARD.01.017.A </td>
          <td><select name=ptmis010 id=ptmis010 tabindex=40
               title="%STANDARD.01.017.A "
               onchange="DisContractWAhealth();" >
              <option> </option>
                 %PATWEB89.03.111.2
              </select></td>
      <td class=DataLabel>Mailing List</td>
      <td>
        <select name=ptmis072 id=ptmis072 tabindex=170>
        <option value="0">NO</option>
        <option value="1" selected>YES</option>
        </select>
        </td>
</tr>
<tr id="contractxx" style="display:none">
  <td>Contract ID</td>
  <td><input type="text" size=7 maxlength=5 name=ptasf003 id=ptasf003
       tabindex=29 onblur="validateCode(9,ptasf003,d_ptasf003);">
      <input type=text size=27 name=d_ptasf003 id=d_ptasf003 notab
       class=Readonly readonly>
      <img src="../images/SearchIcon.gif" class=Icon
       onclick="TransferSourceFrame(ptasf003,d_ptasf003)"></td>
</tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td><table cellspacing=0 cellpadding=0>
        <tr><td><select name=ptmis027 id=ptmis027 title="%STANDARD.01.017.CL"
              tabindex=45 onchange="showFundingSource();">
               <option> </option>
                %PATWEB89.03.126.2
             </select></td>
             <td><div id=FundingHeading></div></td>
             <td><div id=FundingId></div></td>
        </tr></table></td>
    <td>Disaster Code</td>
    <td><select name=dispt001 id=dispt001 tabindex=175 title="Disaster Code"
         onchange="displayDisasterID();">
         <option></option>
          %PATWEB89.03.995
        </select>
       </td>
</tr>
<tr>
        <td align=left>Move Medical Record</td>
        <td align=left>
        <input type="checkbox" name="mvmedre1" id="mvmedre1" value="1" tabindex=185>
        </td>
    <td class=DataLabel><div id=disasteridnumbertitleDIV></div></td>
    <td><div id=disasteridnumberDIV></div></td>
</tr>
<tr>
<tr><td class=DataLabel> Admission Comments </td>
    <td colspan=6 align=left>
<textarea wrap=hard name=adcommnt id=adcommnt rows=3 cols=70 tabindex=195>
</textarea></td></tr>


      <tr align=center>
       <td colspan=4 align=center><br>
       <input tabindex=31 type=button value="Ok" class="button"
        id="pat89sub"
        onclick="tempDisable(this);checkBedStatus(UpdateForm.ptmis068.value,
                 UpdateForm.ptmis076.value,UpdateForm.ptmis001.value,
                 UpdateForm.ptmis030.value,SubmitAdm)">
       <input tabindex=32 type=button value="Cancel" class="button"
             onclick="PatientLinkTo('patweb98.pbl',1,1,0);">
    </table>
</td></tr>
</table>
</form>
<form name=linkForm id=linkForm action=patweb89.pbl method=post>
<input type=hidden name=reportno id=reportno value=1>
<input type=hidden name=template id=template value=1>
<input type=hidden name=urnumber id=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno id=admissno value="%PATWEB89.03.081">
</form>
<form name=PatientLinks id=PatientLinks method=get>
<input type=hidden name=reportno id=reportno value=1>
<input type=hidden name=template id=template value=004>
<input type=hidden name=urnumber id=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno id=admissno value="%PATWEB89.03.101">
<input type=hidden name=MenuType id=MenuType value="%PATWEB89.03.088">
</form>
</div>
<span id=fundinghd style="display:none">
Funding Source
</span>

<span id=fundingid style="display:none">
  <select name=ptvis131 id=ptvis131 title="%STANDARD.01.017.cx"
          tabindex=100>
          <option> </option>
             %PATWEB89.03.298.053.2
         </select>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Admission Weight</td>
    <td><input type=text name=ptmis051 id=ptmis051 size=8 maxlength=6
         onchange="justifyRight(this);">grams</td></tr>
</table>
</span>

<script type="text/javascript">
 if ("%PATWEB89.03.903" == "1") {
  alert("Warning: Patient has a Waiting List Procedure");
 }
 if ("%PATWEB89.03.904" == "1") {
  alert("Warning: Patient has a Booking");
 }
 if ("%PATWEB89.03.905" == "1") {
  alert("Warning: Patient is currently admitted");
 }
 if ("%PATWEB89.03.908" == "1") {
  alert("Warning: Patient has a pre-admission record");
 }
  Day=document.UpdateForm.ptmis001.value.substr(0,2).replace(/ /g,"0")
  Dat=document.UpdateForm.ptmis001.value.substr(2)
  document.UpdateForm.ptmis001.value=Day + Dat
</script>

<span id=transferhd style="display:none">
Transfer Source
</span>
<span id=transfersrc style="display:none">
<input type="text" size=7 maxlength=5 name=trnsfsrc id=trnsfsrc class=Mandatory
 title="Transfer Source" tabindex=5
 onchange="validateCode(9,trnsfsrc,trandesc);">
<input type=text size=27 name=trandesc id=trandesc notab
 class=Readonly readonly>
<img src="../images/SearchIcon.gif"
 onclick="TransferSourceFrame(trnsfsrc,trandesc)">
</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc id=trnsfsrc>
</span>

<span id=blanklabel style="display:none">&nbsp;</span>
<span id=offdutyhd style="display:none">
 Off Duty
</span>

<span id=offdutyid style="display:none">
 <input type="checkbox" name="offdutyb" id="offdutyb" value="0">
</span>


