<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/preadmission.js">   </script>
<script type="text/javascript">
function GetADCookie() {
  if (GetCookieData("dischargedatecookie")!="unknown") {
    if (!isWhitespace(GetCookieData("dischargedatecookie"))){
      document.UpdateForm.ptmis001.value=
      GetCookieData("dischargedatecookie");
      SetCookie("dischargedatecookie","");
    }
  }

  if (GetCookieData("dischargetimecookie")!="unknown") {
    if (!isWhitespace(GetCookieData("dischargetimecookie"))){
      document.UpdateForm.ptmis002.value=
      GetCookieData("dischargetimecookie");
      SetCookie("dischargetimecookie","");
    }
  }

  if (GetCookieData("diagtextcookie")!="unknown") {
    if (!isWhitespace(GetCookieData("diagtextcookie"))){
      document.UpdateForm.ptmis020.value=
      GetCookieData("diagtextcookie");
      SetCookie("diagtextcookie","");
    }
  }

  if (GetCookieData("diagicd10cookie")!="unknown") {
    if (!isWhitespace(GetCookieData("diagicd10cookie"))){
      document.UpdateForm.ptvis075.value=
      GetCookieData("diagicd10cookie");
      validateCode(6,UpdateForm.ptvis075,UpdateForm.drgdesc1);
      SetCookie("diagicd10cookie","");
    }
  }

}
function defaultDisasterCode() {
  if (!isWhitespace(document.UpdateForm.disacode.value)) {
    disastercodeDIV.innerHTML=disastercodeSPAN2.innerHTML;
  } else {
    disastercodeDIV.innerHTML=disastercodeSPAN1.innerHTML;
  }
  displayDisasterID();

}
function SubmitAdm() {
  p=document.UpdateForm
  MandatoryOk=true;
  if (!validateMandatory(document.UpdateForm)) {
     return; 
  }

  if (document.UpdateForm.admitbox.value==1) {
    dateDiff=parseInt(SetDateYYYYMMDD(document.UpdateForm.ptmis001.value)) -
             parseInt(DemConDate);
    if (checkDemographicsUpdated(dateDiff,NoDayDemVl,ConfDemogs)){
      return;
    }
  }

// validate responsible clinician
 if(!isWhitespace(p.ptmis007.value)){
 if(!ValidateHCPDateHospital(18,1,p.ptmis007,p.doctnam2,p.ptmis001,p.wbsehosp)){
    return;
  }
 }
// validate registrar
 if(!isWhitespace(p.ptvis062.value)){
 if(!ValidateHCPDateHospital(18,2,p.ptvis062,p.d_ptvis062,p.ptmis001,p.wbsehosp)){
    return;
  }
 }
// validate resident
 if(!isWhitespace(p.ptvis061.value)){
 if(!ValidateHCPDateHospital(18,2,p.ptvis061,p.d_ptvis061,p.ptmis001,p.wbsehosp)){
    return;
  }
 }
// Validate Cat.KD/Age combination
    var serverURL = "../cgi-bin/comweb80.pbl?reportno=71" +
                    "&valdcode="+p.ptvis104.value.replace(/ /g,"+") +
                    "&valdcod2="+p.urnumber.value.replace(/ /g,"+") +
                    "&valddate="+p.ptmis001.value.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0){
       return false;
    }
    if(p.offdutyb!=undefined){
      if(p.offdutyb.checked==true){
        alert("Error: Claim Type invalid for 'Off Duty' personnel.")
        return;
      }
    }
    if(p.ptmis027.value.substr(3,1)=="P"&&p.dvacardc.value=="1"){
      if(!confirm("\t\tPublic patient with DVA details.\n" +
                  "Select Ok to continue," +
                  " select Cancel to return to page and change Claim " +
                  " Type.")){
        return;
      }
    }

 if((p.restatus.value.substr(5,1)=="S") || (p.restatus.value.substr(5,1)=="O")){
      if(!isWhitespace(p.ptmis027.value)){
       if (p.ptmis027.value.substr(32,1)!="1") {
        ind=p.ptmis027.value.substr(3,1)
        if(ind!="1"&&ind!="E"&&ind!="G"){
          alert("Claim Type must be overseas");
          return;
        }
       }
      }
  }

  if(p.ptmis027.value.substr(14,2)=="21"&&p.pmifundh.value!==""){
    if(!confirm("Warning: Public patient with Private Health Fund details.\n" +
                "Select Ok to continue admission," +
                " select Cancel to return to current admission page" +
                " to update Claim Type.")){
        return;
      }
  }


  if(document.UpdateForm.mvmedre1.checked == true) {
     document.UpdateForm.mvmedrec.value="1";
  } else {
     document.UpdateForm.mvmedrec.value="0";
  }
  if(document.UpdateForm.admitbox.checked == true) {
    if(isWhitespace(p.ptmis020.value)&&isWhitespace(p.ptvis075.value)){
       alert("Diagnosis is a required field.")
       return;
    }
    if(checkMultipleAdmission(UpdateForm)){
      return;
    }
  }
  if (MandatoryOk) {
    setRedirect();
    if(p.prevhosp.checked==true){
      document.UpdateForm.redirect.value="patweb07.pbl?reportno=15&template=001"
      if(document.UpdateForm.pmext049.value == "1") {
        document.UpdateForm.redirect.value+= "&mvithmva=1"+
        "&chckcomp="+document.UpdateForm.ptmis027.value.substr(3,1);
      }
      document.UpdateForm.redirect.value +=
      "&urnumber=" + document.UpdateForm.urnumber.value
      + "&mvmedrec=" + document.UpdateForm.mvmedrec.value + "&admissno=";
    }
    validateBedRequestUpdate(UpdateForm.admissno,UpdateForm.ptmis068,
                             UpdateForm.ptmis076,UpdateForm.bedrqqry);
    UpdateForm.ptmis004.value=UpdateForm.ptmis068.value;
    UpdateForm.ptmis005.value=UpdateForm.ptmis076.value;
    UpdateForm.ptmis009.disabled=false;
    UpdateForm.OKButton.disabled=true;
    SubmitHidden(UpdateForm);
    setTimeout('UpdateForm.OKButton.disabled=false',6000);
   }
}
function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
  selectOptions4("45",UpdateForm.ptmis007,UpdateForm.dummy,UpdateForm.ptmis024);
  selectUnit();
  valDoctorUnitTeam();
}
function valDoctorUnitTeam() {
  selectOptions4("46",UpdateForm.ptmis007,UpdateForm.ptmis024,UpdateForm.ptvis124);
  selectTeam();
}
function selectUnit(){
  for (var i =0 ; i < document.UpdateForm.ptmis024.length; i++) {
    if (document.UpdateForm.ptmis024.options[i].value.substr(0,3)== 
                 document.UpdateForm.deftunit.value.substr(0,3)) {
       document.UpdateForm.ptmis024.selectedIndex=i } };
    if (isWhitespace(document.UpdateForm.deftunit)) {
      if (UpdateForm.ptmis024.length==2) {
        UpdateForm.ptmis024.selectedIndex=1; } }
}
function selectTeam(){
  for (var i =0 ; i < document.UpdateForm.ptvis124.length; i++) {
    if (document.UpdateForm.ptvis124.options[i].value.substr(0,5)== 
                 document.UpdateForm.deftteam.value.substr(0,5)) {
       document.UpdateForm.ptvis124.selectedIndex=i } };
    if (isWhitespace(document.UpdateForm.deftteam)) {
      if (UpdateForm.ptvis124.length==2) {
        UpdateForm.ptvis124.selectedIndex=1; } }
      if (UpdateForm.ptvis124.length>1) {
        UpdateForm.ptvis124.className = "Mandatory"; }
      else { UpdateForm.ptvis124.className = ""; }
}
function DisplaySel() {
  PageLocation="?reportno=1&template=4" +
               "&urnumber=" + PatientURN.replace(/ /g,"+") +
               "&admissno=" + PatientVIS.replace(/ /g,"+")
  if (top.content.location.href!=this.location.href) {
    top.content.location.href="emrweb02.pbl" + PageLocation }
for(var i=0;i<UpdateForm.ptmis009.length;i++) {
   if(trim(UpdateForm.ptmis009.options[i].value.substr(16,2))=="04"){
           UpdateForm.ptmis009.selectedIndex=i;
          }
   }
//
  for (var i =0 ; i < document.UpdateForm.ptmis010.length; i++) {
  if (document.UpdateForm.ptmis010.options[i].value.substr(14,1)=="6") {
     document.UpdateForm.ptmis010.selectedIndex=i 
     break;} };
  for (var i =0 ; i < document.UpdateForm.ptmis011.length; i++) {
  if (document.UpdateForm.ptmis011.options[i].value.substr(14,1)=="6") {
     document.UpdateForm.ptmis011.selectedIndex=i 
     break;} };
  for (var i =0 ; i < document.UpdateForm.ptmis012.length; i++) {
  if (document.UpdateForm.ptmis012.options[i].value.substr(14,2)=="21") {
     document.UpdateForm.ptmis012.selectedIndex=i 
     break;} };
//
   AdmitMandatory();
   for(var i=0;i<UpdateForm.ptmis068.length;i++) {
      if(UpdateForm.ptmis068.options[i].value==UpdateForm.exptward.value) {
           UpdateForm.ptmis068.selectedIndex=i;
          }
     }
   LoadWardBeds();
}
function AdmitMandatory() {
  p=document.UpdateForm
  if(p.admitbox.checked == true) {
     p.admitbox.value="1";
     p.ptmis011.className="Mandatory";  //admission type
     p.ptmis009.className="Mandatory";  //admission source
     p.ptmis024.className="Mandatory";  //Speciality
     p.ptmis012.className="Mandatory";  //care type
     p.ptmis010.className="Mandatory";  //Patient type
     p.ptmis027.className="Mandatory";  //Financial Class
     p.ptvis046.className="Mandatory";  //Admitting Point
     p.ptvis093.className="Mandatory";  //Preferred Accommodation
     p.ptvis104.className="Mandatory";  //Employment Status
     p.ptvis043.className="Mandatory";  //Intended Stay
     p.ptvis022.className="Mandatory";  //Inform GP
     p.ptvis125.className="Mandatory";  //Non WA Hospital Contact
     p.ptvis095.className="Mandatory";  //Usual Accommdation
  } else {
     p.admitbox.value="0";
     p.ptmis011.className="";  //admission type
     p.ptmis009.className="";  //admission source
     p.ptmis024.className="";  //Speciality
     p.ptmis012.className="";  //care type
     p.ptmis010.className="";  //Patient type
     p.ptmis027.className="";  //Financial Class
     p.ptvis046.className="";  //Admitting Point
     p.ptvis093.className="";  //Preferred Accommodation
     p.ptvis104.className="";  //Employment Status
     p.ptvis043.className="";  //Intended Stay
     p.ptvis022.className="";  //Inform GP
     p.ptvis125.className="";  //Non WA Hospital Contact
     p.ptvis095.className="";  //Usual Accommdation

  }
} 
function displayPrev(){
  p=document.UpdateForm
  if(!isWhitespace(p.dispprev.value)){
    document.getElementById('prevhospxx').style.display="";

    if (document.getElementById('ptcnundh').value=='1') {
      document.getElementById('prevhosp').checked=true;
    }

  } else {
    document.getElementById('prevhospxx').style.display="none";
  }
}
function valClaimCode() {
for (var i =0 ; i < document.UpdateForm.ptmis027.length; i++) {
  if (trim(document.UpdateForm.claimc.value)==
      trim(document.UpdateForm.ptmis027.options[i].value.substr(0,3))){
	document.UpdateForm.ptmis027.selectedIndex=i;
  }
}
}
function LoadWardBeds() {
var p=document.UpdateForm;
WardBedSelection(p.ptmis068,p.ptmis076,'A',p.d_ptmis076)
}
function EDCurrent() {
if ( !top.TogglePanel && (document.UpdateForm.bypasscv.value != "1") ) {
  if ( document.UpdateForm.d_emvistat.value=="1" ) {
    alert("ED Visit is still current, Please discharge the ED visit " +
	  " before admitting the patient.");
    PatientLinkTo("emrweb02.pbl",1,17,0,0,0);
  }
}
}
function Cancel() {
if (document.UpdateForm.isedlite.value == "1"){
  PatientLinkTo("emrweb02.pbl",1,209,0,0,0);
}
else {
  PatientLinkTo("emrweb02.pbl",1,109,0,0,0);
}
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisplaySel();document.UpdateForm.ptmis001.focus();
	    valClaimCode();valDoctorUnit();EDCurrent();displayPrev();
	    defaultDisasterCode();DisplayTransfer();showFundingSource();
	    GetADCookie();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
ConfDemogs="%STANDARD.01.045.PTCNCDOA";
NoDayDemVl=trim("%STANDARD.01.045.PTCNNDCD");
DemConDate=SetDateYYYYMMDD("%PATWEB89.01.085.059");
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>

<form name=UpdateForm method=post action=patweb89.pbl style="margin:0">
<input type="hidden" name=urnumber value="%PATWEB89.01.003">
<input type="hidden" name=admissno value="%PATWEB89.01.081">
<input type="hidden" name=emadmiss value="%PATWEB89.01.081">
<input type="hidden" name=reportno value=2>
<input type="hidden" name=template value="001">
<input type="hidden" name="wbsehosp" value="%STANDARD.01.032">
<input type="hidden" name="updatety" value="1">
<input type="hidden" name="redirect">
<input type="hidden" name="dispprev" value="%PATWEB89.01.999.033">
<input type="hidden" name="allocate" value="1">
<input type="hidden" name="chckname" value="0">
<input type="hidden" name="emradmit" value="0">
<input type="hidden" name="emradmis" value="0">
<input type="hidden" name="admitnow" value="1">
<input type="hidden" name="newbmand" value="0">
<input type="hidden" name="agebmand" value="0">
<input type="hidden" name="ptmas046" value="0">
<input type="hidden" name="mvmedrec">
<input type="hidden" name="ptcnbage" value="%STANDARD.01.025.021.046.1.3">
<input type="hidden" name="pbdate"   value="%PATWEB89.01.020">
<input type="hidden" name="dvacardc"   value="%PATWEB89.01.999.002">
<input type="hidden" name="visatype"   value="%PATWEB89.01.999.003.007.3">
<input type="hidden" name="ptcnxcom" value="%STANDARD.01.025.116.222.0.1">
<input type="hidden" name="cfinan" value="%PATWEB89.01.932">
<input type="hidden" name="deftunit" value="%PATWEB89.01.124.1">
<input type="hidden" name="deftteam" value="%PATWEB89.01.298.046.1">
<input type="hidden" name="exptward" value="%PATWEB89.01.917">
<input type="hidden" name="claimc" value="%PATWEB89.01.408.1">
<input type="hidden" name="exstward" value="%PATWEB89.01.449.1">
<input type="hidden" name="ptmis013" value="%PATWEB89.01.040.0">
<input type="hidden" name="ptmis014" value="%PATWEB89.01.041.0">
<input type="hidden" name="ptmis015" value="%PATWEB89.01.042">
<input type="hidden" name="pmsvx142" value="%PATWEB89.01.899.010">
<input type="hidden" name="ismrtmas" value="%PATWEB89.01.999.021">
<input type="hidden" name="d_emvistat" value="%PATWEB89.01.447">
<input type="hidden" name="disacode" value="%PATWEB89.01.996">
<input type="hidden" name="disadesc" value="%PATWEB89.01.999.025">
<input type="hidden" name="mhadmflg">
<input type="hidden" name="restatus" value="%PATWEB89.01.024.3">
<input type="hidden" name="contmult" value="1">
<input type="hidden" name="leavhosp">
<input type="hidden" name="leavadmn">
<input type="hidden" name="leavtype">
<input type="hidden" name="prevemra" value="%PATWEB89.01.081">
<input type="hidden" name="bypasscv" value="%PATWEB89.01.999.032">
<input type="hidden" name="ipadmdat" value="1">
<input type="hidden" name="isedlite" value="%PATWEB89.01.999.035">
<input type="hidden" name="pmifundh" value="%PATWEB89.01.040.0">
<input type="hidden" name="ptcnundh" id="ptcnundh"
  		     value="%STANDARD.01.025.116.247.0.1">
<input type=hidden name=bedrqqry value="">
<input type=hidden name=ptcnhdps id=ptcnhdps 
       value="%STANDARD.01.025.080.250.1.1">
<input type=hidden name=inclcin1>

<table border=0 colspan=0 width=100% cellspacing=0 cellpadding=0 >
<tr><td class=HeadingCell align=center>
  Patient Admission Details  </td></tr>
</table>

<table border=0 colspan=0 width=100% cellspacing=0 cellpadding=0 >
<tr><td align=left><b>Admit Now?</b></td>
  <td align=left>
      <input type="checkbox" name="admitbox" value="0" notab
       onclick='AdmitMandatory()';></td>
  <td>&nbsp;</td>
  <td>&nbsp;</td></tr>

<tr><td class=DataLabel>Admission Date </td>
  <td><input type=text size=12 id=ptmis001 name=ptmis001 tabindex=1 
       class="Mandatory Date" title="Admission Date" 
       value="%PATWEB89.01.935">
      <img notab src=../images/DateLookup.gif class=Icon
       onclick="DateLookupFrame(ptmis001);">     
      Time 
      <input class=Mandatory type=text id=ptmis002 name=ptmis002 size=8 
       tabindex=5 value="%PATWEB89.01.936" title="Admission Time">
      <img notab src=../images/DateTimeStamp.gif class=Icon
       onclick="SetCurrentDateTime(null,ptmis002);">
      <img notab src=../images/TimeLookup.gif class=Icon
       onclick="TimeLookupFrame(ptmis002);"></td>
  <td>Admitting Point</td>
  <td><select name=ptvis046 tabindex=205
       title="Admitting Point" 
       onchange="defaultWard()">
       <option></option>
      %PATWEB89.01.290.2
      </select></td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.P </td>
  <td><select name=ptmis011 tabindex=3 
       title="%STANDARD.01.017.P ">
       <option> </option>
	%PATWEB89.01.112.2
      </select></td>
  <td class=DataLabel>Ward / Bed </td>
  <td><input type=hidden id=bedstat1 name=bedstat1>
      <input type=hidden id=ptmis004 name=ptmis004>
      <input type=hidden id=ptmis005 name=ptmis005 title="Bed">
      <input type=hidden id=warddesc name=warddesc>
      <input type=hidden id=d_ptmis076 name=d_ptmis076>
      <select id=ptmis068 name=ptmis068 tabindex=210 title="Ward" 
       class=Mandatory
       onchange="LoadWardBeds();">
       <option> </option>
	%PATWEB89.01.449.2
      </select>
      <select id=ptmis076 name=ptmis076 title="Bed" notab>
      </select>
      <img notab src=../images/SearchIcon.gif class=Icon
       onclick="WardBedSearchFrame(ptmis068,warddesc,ptmis076,bedstat1,
		LoadWardBeds);"></td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.S </td>
  <td><select name=ptmis009 tabindex=4
       onchange="DisplayTransfer();" title="%STANDARD.01.017.S ">
       <option> </option>
	%PATWEB89.01.110.2
      </select></td>
  <td class=DataLabel>%STANDARD.01.017.BP</td>
  <td><select name=ptvis093 title="%STANDARD.01.017.BP"
       tabindex=215 >
       <option> </option>
	%PATWEB89.01.298.012.2
      </select></td></tr>

<tr id="transferxx" style="display:none">
  <td class=DataLabel>Transfer Source</td>
  <td><input type="text" size=7 maxlength=5 name=trnsfsrc id="trnsfsrc"
       title="Transfer Source" tabindex=5
       onchange="validateCode(9,trnsfsrc,trandesc);">
      <input type=text size=27 name=trandesc id=trandesc notab
       class=Readonly readonly>
      <img src="../images/SearchIcon.gif" class=Icon
       onclick="TransferSourceFrame(trnsfsrc,trandesc)"></td></tr>

<tr><td class=DataLabel>Referring Clinician</td>
  <td><input type="text" size=10 maxlength=10 id=ptvis028 name=ptvis028 
       tabindex=7 value="%PATWEB89.01.567.003.1"
       onchange="ReadDoc(18,0,ptvis028,genpname,ptvis029,genpprac,ptvis030,
			genpprov);">
      <input type=text size=25 notab readonly id=genpname name=genpname
       value="%PATWEB89.01.567.002.1">
      <img src="../images/SearchIcon.gif" class=Icon
      onclick="GPHCPSearchFrame(ptvis028,genpname,genpprov,ptvis029,genpprac,
			ptvis030,0)">
      <img src="../images/erase.gif" class=Icon
       onclick="clrFields(ptvis028,genpname);"></td>
  <td class=DataLabel>Post Op Ward</td>
  <td><input type=hidden id=popwdesc name=popwdesc>
      <input type=hidden id=popbstat name=popbstat>
      <select id=ptvis048 name=ptvis048 tabindex=65>
       <option></option>
       %PATWEB89.01.251.2
      </select>
      <input type=hidden id=dummy name=dummy></td></tr>

<tr><td class=DataLabel>Practice</td>
  <td><input type=text id=genpprac name=genpprac size=35 readonly
       value="%PATWEB89.01.232.0" notab>
      <input type=hidden id=ptvis029 name=ptvis029 value="%PATWEB89.01.232.1">
      <input type=hidden id=ptvis030 name=ptvis030 value="%PATWEB89.01.233.1">
      <input type=hidden id=genpprov name=genpprov value="">
      <img src="../images/SearchIcon.gif" class=Icon
      onclick="GPHCGSearchFrame(ptvis028,genpname,genpprov,ptvis029,
		   genpprac,ptvis030)">
      <img src="../images/erase.gif" class=Icon
       onclick="clrFields(ptvis029,genpprac,ptvis030,genpprov);"></td>
  <td class=DataLabel>%STANDARD.01.035.cw</td>
  <td><select name=ptvis125 title="%STANDARD.01.035.cw"
       tabindex=100>
       <option> </option>
	%PATWEB89.01.298.047.9.2
      </select></td></tr>

<td class=DataLabel>%STANDARD.01.017.SI</td>
  <td><select name=ptvis103 tabindex=8
       title="%STANDARD.01.017.SI">
       <option></option>
	%PATWEB89.01.413.2
       </select></td>
  <td align=left>Hosp Last 7 Days</td>
  <td><table>
      <td align=left>
	  <input type="checkbox" name="prevhosp" id="prevhosp"
	   value="1" tabindex=105></td>
      <td id="prevhospxx" style="display:none" class=DataLabel>
	   Original Adm Date
	   %PATWEB89.01.999.034
	   No of days Hospitalisation
	   %PATWEB89.01.999.033
      </td></table>
  </td></tr>

<tr><td class=DataLabel>Responsible Clinician</td>
  <td><input type="text" size=8 maxlength=6 id=ptmis007 name=ptmis007 
       tabindex=10 title="Responsible Clinician" class=Mandatory
       onchange="UpCase(this);valDoctorUnit();">
      <input type=text readonly size=25 notab id=doctnam2 name=doctnam2
       title="Responsible Clinician">
      <img notab src="../images/SearchIcon.gif" class=Icon
       onclick="DoctorSearchFrame(ptmis007,doctnam2,valDoctorUnit)"></td>
  <td class=DataLabel>%STANDARD.01.035.KP</td>
  <td><select name=ptvis095 tabindex=107
       title="%STANDARD.01.035.KP">
       <option></option>
	%PATWEB89.01.298.017.9.5
       </select></td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.AC</td>
  <td><select name=ptmis024 tabindex=15
       title="%STANDARD.01.017.AC" onchange="valDoctorUnitTeam();">
       <option> </option>
	%PATWEB89.01.124.2
      </select></td>
  <td class=DataLabel>%STANDARD.01.017.KD</td>
  <td><select name=ptvis104 tabindex=110
       title="%STANDARD.01.017.KD">
       <option></option>
	%PATWEB89.01.298.026.2
       </select></td></tr>

<tr><td class=DataLabel>Team</td>
  <td><select name=ptvis124 tabindex=25 
       title="Team">
       <option> </option>
	%PATWEB89.01.298.046.2
      </select></td>
  <td class=DataLabel>Diagnosis(text) </td>
  <td><input tabindex=115 type=text name="ptmis020" size=50 maxlength=80
       value="%PATWEB89.01.437"></td></tr>

<tr><td class=DataLabel>Registrar</td>
  <td><input type=hidden id=ptvis062 name=ptvis062 value="">
      <input type=text size=20 maxlength=30 id=d_ptvis062 name=d_ptvis062
       value="" readonly notab>
      <img src="../images/SearchIcon.gif" class=Icon
       onclick="HCPSearchFrame(ptvis062,d_ptvis062,8);">
      <img src="../images/erase.gif" class=Icon
       onclick="clrFields(ptvis062,d_ptvis062);"></td>
  <td class=DataLabel>Diagnosis(ICD)</td>
  <td><input type=text id=ptvis075 name=ptvis075 title="ICD Code"
       size=10 tabindex=120 value="%PATWEB89.01.291" title="ICD Code"
       onblur="validateCode(6,UpdateForm.ptvis075,UpdateForm.drgdesc1);">
      <input type=text size=30 id=drgdesc1 name=drgdesc1
       title="ICD Description" value="" readonly>
      <img src=../images/SearchIcon.gif alt="Disease Search" class=Icon
       onclick="Icd10DisSearchFrame(UpdateForm.ptvis075,UpdateForm.drgdesc1,
                              UpdateForm.drgdesc2);"></td></tr>

<tr><td class=DataLabel>Resident</td>
  <td><input type=hidden id=ptvis061 name=ptvis061 value="">
      <input type=text size=20 maxlength=30 id=d_ptvis061 name=d_ptvis061
       value="" readonly notab>
      <img src="../images/SearchIcon.gif" class=Icon
      onclick="HCPSearchFrame(ptvis061,d_ptvis061,8);">
      <img src="../images/erase.gif" class=Icon
      onclick="clrFields(ptvis061,d_ptvis061);"></td>
 <td class=DataLabel>%STANDARD.01.017.VI</td>
 <td class=DataLabel>
     <select name=ptvis043 tabindex=125 title="%STANDARD.01.017.VI">
      <option> </option>
       %PATWEB89.01.246.2
     </select></td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CC</td>
  <td><select name=ptmis012 tabindex=35 title="%STANDARD.01.017.CC"
       onchange=checkUnq(); >
       <option></option>
	%PATWEB89.01.113.2
      </select></td>
  <td class=DataLabel> Planned Length of Stay</td>
  <td><input type=text size=5 maxlength=5 id=ptmis030 name=ptmis030
       tabindex=135 title='Planned Length of Stay' min=0
       class=Integer onblur="checkInteger(this,this.value);"></td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.A </td>
  <td><select name=ptmis010 tabindex=35
       title="%STANDARD.01.017.A "
       onchange="DisContractWAhealth();" >
       <option> </option>
	%PATWEB89.01.111.2
      </select></td>
 <td class=DataLabel>Inform GP</td>
 <td><select name=ptvis022 tabindex=145 title="Inform GP">
      <option value=" "></option>
      <option value="0">No</option>
      <option value="1">Yes</option>
      <option value="2">Unknown</option>
      </select></td></tr>

<tr id="contractxx" style="display:none">
  <td>Contract ID</td>
  <td><input type="text" size=7 maxlength=5 id=ptasf003 name=ptasf003 
       title="Contract ID" tabindex=35 
       onblur="validateCode(9,ptasf003,d_ptasf003);">
      <input type=text size=27 id=d_ptasf003 name=d_ptasf003 notab
       class=Readonly readonly>
      <img src="../images/SearchIcon.gif" class=Icon
       onclick="TransferSourceFrame(ptasf003,d_ptasf003)"></td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
  <td><table cellspacing=0 cellpadding=0>
	   <td><select name=ptmis027 title="%STANDARD.01.017.CL"
	    tabindex=45 onchange=showFundingSource();>
	     <option> </option>
	      %PATWEB89.01.126.2
	   </select></td>
	   <td><div id=FundingHeading></div></td>
	   <td><div id=FundingId></div>
	   </td></table></td>
  <td class=DataLabel>Mailing List</td>
  <td><select name=ptmis072 tabindex=170>
       <option value="2"></option>
       <option value="0">No</option>
       <option value="1">Yes</option>
      </select></td></tr>

<tr>
    <td class=DataLabel>
      Has this patient been in a Motor Vehicle Accident?
    </td>
    <td>
      <select class="Mandatory" name=pmext049 tabindex=1
       title="Has this patient been in a Motor Vehicle Accident?">
        %PATWEB89.01.999.125.099.050
      </select>
    </td>
  </tr>

<tr><td align=left>Move Medical Record</td>
  <td align=left>
      <input type="checkbox" name="mvmedre1" value="1" tabindex=185></td>
  <td>Disaster Code</td>
  <td><div id=disastercodeDIV></div></td></tr>

<tr><td></td>
  <td></td>
  <td class=DataLabel><div id=disasteridnumbertitleDIV></div></td>
  <td><div id=disasteridnumberDIV></div></td></tr>

<tr><td class=DataLabel> Admission Comments </td>
  <td colspan=6 align=left>
      <textarea wrap=hard name=adcommnt rows=3 cols=70 tabindex=195>
      </textarea></td></tr>

<tr align=center>
     <td colspan=4 align=center><br>
     <input tabindex=54 type=button value="Ok" class="button" name=OKButton
      onclick="checkBedStatus(UpdateForm.ptmis068.value,
	       UpdateForm.ptmis076.value,UpdateForm.ptmis001.value,
	       UpdateForm.ptmis030.value,UpdateForm.ptmis002.value,
	       SubmitAdm,UpdateForm.admitbox)";>
     <input tabindex=55 type=button value="Cancel" class="button"
      onclick='Cancel();'></td></tr>

</table>
</form>

<script type="text/javascript">
  InformGP="%PATWEB89.01.225.0";
  if(InformGP=="0") {
    document.UpdateForm.ptvis022.selectedIndex=1;
  } else {
      if(InformGP=="1") {
        document.UpdateForm.ptvis022.selectedIndex=2;
  }   else {
        document.UpdateForm.ptvis022.selectedIndex=3;
      }
  }

  var codeList = document.UpdateForm.ptmis027.options;
  for (var i = 0; i < codeList.length; i++) {
    if (isWhitespace(codeList[i].value)) continue;
    var codeSingle = codeList[i].value.substr(3, 5); 
    if (codeSingle.match(/M/g) != null) {
      document.UpdateForm.ptmis027.options[i].remove(i);
        i--;
    }
  }

  MVAccYN="%PATWEB89.01.999.125.049"
  if (MVAccYN == "1") {
    document.UpdateForm.pmext049.value = "1";
  }
</script>

<form name=linkForm action=patweb89.pbl method=post>
<input type="hidden" name=reportno value=1>
<input type="hidden" name=template value=1>
<input type="hidden" name=urnumber value="%PATWEB89.01.003">
<input type="hidden" name=admissno value="%PATWEB89.01.081">
</form>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.101">
<input type=hidden name=MenuType value="%PATWEB89.01.088">
<input type=hidden name=isedlite value="%PATWEB89.01.999.035">
</form>
<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 id=ptmis058 tabindex=19 
         title="Referral Date">
        <img notab src=../images/DateLookup.gif class=Icon
         onclick="DateLookupFrame(ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
    <td><input type=text size=12 name=ptmis059 id=ptmis059 tabindex=20 
         title="Consultation Date">
        <img notab src=../images/DateLookup.gif class=Icon
         onclick="DateLookupFrame(ptmis059);"></td></tr>
</table>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Admission Weight</td>
    <td><input type=text name=ptmis051 size=8 maxlength=6
         onchange=justifyRight(this);>grams</td></tr>
</table>
</span>

<span id=NewBorn style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
    <td><input type=text name=ptmis041 maxlength=3 size=4 tabindex=21> weeks
    </td></tr>
</table>
</span>

<script type="text/javascript">
MergePsy="%PATWEB89.01.050"
  if(MergePsy=="Yes"){
    document.UpdateForm.ptmas046.value="1"
  }
 if(MergePsy=="No "){
    document.UpdateForm.ptmas046.value="0"
  }
 if ("%PATWEB89.01.903" == "1") {
  alert("Warning: Patient has a Waiting List Procedure");
 }
 if ("%PATWEB89.01.904" == "1") {
  alert("Warning: Patient has a Booking");
 }
 currhosp=trim("%PATWEB89.01.999.017")
 curradmn="%PATWEB89.01.999.018"
 if ("%PATWEB89.01.905" == "1") {
  alert("Patient Currently admitted at "+currhosp+" under Admission - "+curradmn);
 }
 if ("%PATWEB89.01.908" == "1") {
  alert("Warning: Patient has a pre-admission record");
 }
 if(!isWhitespace(document.UpdateForm.ptmis001.value)) {
    Day=document.UpdateForm.ptmis001.value.substr(0,2).replace(/ /g,"0")
    Dat=document.UpdateForm.ptmis001.value.substr(2)
    document.UpdateForm.ptmis001.value=Day + Dat
 }
 if (document.UpdateForm.ismrtmas.value!="1"){
      document.UpdateForm.mvmedre1.disabled=true;
 }
 Diagnosis="%PATWEB89.01.496";
 if(!isWhitespace(Diagnosis)) {
   document.UpdateForm.ptvis075.value=Diagnosis;
 }
 validateCode(6,document.UpdateForm.ptvis075,
                document.UpdateForm.drgdesc1);

</script>
<span id=offdutyhd style="display:none">
 Off Duty
</span>

<span id=offdutyid style="display:none">
 <input type="checkbox" name="offdutyb" value="0">
</span>

<span id=fundinghd style="display:none">
Funding Source
</span>

<span id=fundingid style="display:none">
  <select name=ptvis131 title="%STANDARD.01.017.cx"
          tabindex=100>
          <option> </option>
             %PATWEB89.01.298.053.5
         </select>
</span>
<span id=blanklabel style="display:none">&nbsp;</span>

<span id=disasteridnumbertitleSPAN style="display:none">
Disaster Identification #
</span>

<span id=disasteridnumberSPAN style="display:none">
<input type="text" name=dispt002 size=20 maxlength=19
   tabindex=19 title="Disaster Identification Number">
</span>

<span id=disastercodeSPAN1 style="display:none">
<select name=dispt001 tabindex=175 title="Disaster Code"
         onchange="displayDisasterID();">
         <option></option>
          %PATWEB89.01.995
        </select>
</span>

<span id=disastercodeSPAN2 style="display:none">
<input type="text" name=n_dispt001 size=30 class=Readonly readonly
  title="Disaster Code" value="%PATWEB89.01.999.025">
<input type=hidden name=dispt001 value="%PATWEB89.01.996">
</span>

