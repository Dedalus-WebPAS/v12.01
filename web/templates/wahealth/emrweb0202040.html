<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/EmrMandatory.js"></script>
<script type="text/javascript" src="../js/emrweb0202010.js"></script>
<script type="text/javascript">
function CancelAction() {
  if (top.TogglePanel==null) {
    top.location.reload();
  } else {
    top.TogglePanel();
  }
}
function chkFormSend() {
}
function SubmitForm() {
  f = document.UpdateForm;
  var check=false;
  for(var i = 0; i < f.emexp028.length; i++) {
     if (f.emexp028[i].checked==true) {
      check=true;
     }
  }
  if (check==false) {
    alert("Expected Patient, Advice Call or Contact List" +
          " has not been selected !");
    return true;
  }

  if (!CheckLimits2(f.exptcmnt,999,99900)) {
    return;
  }

  setRedirect();
  setFormactn();
}
function IsDirty(eForm) {
  for (var i=0; i < eForm.length; i++) {
    var eElem = eForm.elements[i];
    if ("text" == eElem.type || "textarea" == eElem.tagName)
    {
      if (eElem.value != eElem.defaultValue)  {return true;}
    }
    else if ("checkbox" == eElem.type || "radio" == eElem.type)
    {
      if (eElem.checked != eElem.defaultChecked) return true;
    }
  }
  return false;
}
function Validateprecom001() {
  onblurHandler()
  var formatedtext=formateText(UpdateForm.prcom001,'50')
  if ((formatedtext.split(/[\r\n]/).length>6) || 
        (UpdateForm.prcom001.value.length > 300)) {
    alert("Presenting Complaint comments - Max 6 lines."
           +"\nPlease remove extra rows to continue.");
    document.UpdateForm.prcom001.focus();
    return; }
}
function onblurSpclChar(el) {
  el.value=el.value.replace(/@/g,'');
  el.value=el.value.replace(/\*/g,'');
  el.value=el.value.replace(/\//g,'');
  el.value=el.value.replace(/:/g,'');
  el.value=el.value.replace(/\\/g,'');
  el.value=el.value.replace(/\$/g,'');
  el.value=el.value.replace(/\%/g,'');
  el.value=el.value.replace(/&/g,'');
  el.value=el.value.replace(/#/g,'');
}

function LookupCleanup()
{
  var txtSearch = document.getElementById('txtPresComp');
  if (txtSearch == undefined) return;

  txtSearch.value = ""; 
}
function CheckAmbType() {
  if(document.UpdateForm.emexp014.value.substr(3,1)=="A") {
    document.UpdateForm.emexp026.readOnly=false;
    if(document.UpdateForm.emexp014.value.substr(4,1)=="N") {
      document.UpdateForm.emexp026.className="";
    } else {
      document.UpdateForm.emexp026.className="Mandatory";
    }
  } else {
    document.UpdateForm.emexp026.value="";
    document.UpdateForm.emexp026.className="ReadOnly";
    document.UpdateForm.emexp026.readOnly=true;
  }
}
function checkSOR() {
  if (document.getElementById("emexp019").value.substr(5,1)=="1") {
    document.getElementById("TranSrcHeading").innerHTML =
      document.getElementById("transferhd").innerHTML;
    document.getElementById("TranSrc").innerHTML =
      document.getElementById("transfersrc").innerHTML;
  }
  else {
    document.getElementById("TranSrcHeading").innerHTML="";
    document.getElementById("TranSrc").innerHTML =
      document.getElementById("transferblank").innerHTML;
  } 
}
function checkrR() {
  if (!isWhitespace(document.getElementById("emexp030").value)) {
    documen.tgetElementById("emexp029").value="0";
  } else {
    document.getElementById("emexp029").value="";
  }
}
function initPatientType() {
  f = document.UpdateForm;
  document.getElementById('emex028e').checked = true;
  MandatoryETA();  
}
function MandatoryETA() {
  f = document.UpdateForm;
  if (document.getElementById('emex028e').checked == true) {
    f.emexp022.className="Mandatory"; 
    f.emexp023.className="Mandatory";
  }
  else {
    f.emexp022.className="";
    f.emexp023.className="";
  }
}
function PatientReturnCheck() {
  f = document.UpdateForm;
  if (f.emcnalex.value == '1') {
    PatientReturnWANoVisitCheck(); 
  }
  else {
    PatientReturnWA();
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);CheckAmbType();initPatientType();"> 
<span class=DFrameTitleBar>
Add Expected, Advice, Contact Details
</span>

<form name=UpdateForm action="emrweb02.pbl" method=post style="margin:0">
<input type=hidden name=reportno value="02">
<input type=hidden name=template value="010">
<input type=hidden name=formactn>
<input type=hidden name=updttype>
<input type=hidden name=updateky value="">
<input type=hidden name=nextpage value="0">
<input type=hidden name=redirect>
<input type=hidden name=deceased>
<input type=hidden name=selsex>
<input type=hidden name=gname>
<input type=hidden name=sname>
<input type=hidden name=patgname>
<input type=hidden name=patsname>
<input type=hidden name=dummy>
<input type=hidden name=dummyadm> 
<input type=hidden name=emexpsit value="%STANDARD.01.041">
<input type=hidden name=emexp029 id=emexp029 value="">
<input type=hidden name=ptcnhdps id=ptcnhdps 
       value="%STANDARD.01.025.080.250.1.1">
<input type=hidden name=emcnalex id=emcnalex 
       value="%STANDARD.01.025.122.017.1.1">
  
<table align=center width=98% border=0 cellspacing=0 cellpadding=0>
<tr>
   <td class=DataLabel>Username</td>
   <td><input type=hidden name=securety value="2">
       <input type=text size=12 name=secureid class="Mandatory NoAutoFocus"
          tabindex=1 title="User ID" value="%STANDARD.01.043">
    Password
       <input type=password size =12 name=securepw class=Mandatory tabindex=2
        onfocus="SetCaretPosition('securepw',-1);"
        title="Password" onblur="checkPass();">
   </td>

   <td class=DataLabel>U/R</td> 
   <td><input type=text size=10 maxlength=8 name=emexp018 tabindex=2
        onblur="UpCase(this);justifyRight(this);PatientReturnCheck();">
       <img src="../images/SearchIcon.gif" class=Icon
        onclick="PatientSearchWA();">
   </td>
   <td class=DataLabel>Surname </td>
   <td><input type=text size=25 maxlength=25 name=emexp002 tabindex=3
        onblur="UpCase(this);onblurHandler();onblurSpclChar(this);"></td>
   <td class=DataLabel>Given Name </td>
   <td><input type=text size=25 maxlength=25 name=emexp003 tabindex=4
        onblur="UpCase(this);onblurHandler();onblurSpclChar(this);"></td>
</tr>

<tr><td></td>
    <td></td>
    <td></td>
    <td></td>
    <td class=DataLabel>%STANDARD.01.017.G </td>
    <td><div id="sexfieldDIV">
          <select name=emexp004 class=SelectSml tabindex=5>
            <option> </option>
               %EMRWEB02.02.086.099.061.9.1.19.3.H
          </select>
        </div>
    </td>
    <td class=DataLabel>Date of Birth </td>
    <td><input type=text size=12 maxlength=11 name=emexp005 id=emexp005 
         title="Date of Birth" class="Past Date" tabindex=6
         onblur="checkDate(UpdateForm.emexp005,'Date of Birth')">
        <img src="../images/DateTimeStamp.gif" class=Icon 
         date="UpdateForm.emexp005">
        <img src="../images/DateLookup.gif" class=Icon 
         onclick="DateLookupFrame(UpdateForm.emexp005);">
    </td>
</tr>
</table>
<table align=center width=98% border=0 cellspacing=0 cellpadding=0>
<tr><td colspan=6><hr></td></tr>

<tr>
  <td width=10%>Patient Encounter Type</td>
  <td width=50%>
    <input type=radio name=emexp028 id=emex028e value="1" tabindex=8
     onclick="MandatoryETA();">Expected Patient</input>
    <input type=radio name=emexp028 id=emex028a value="2" tabindex=8
     onclick="MandatoryETA();">Advice Call</input>     
    <input type=radio name=emexp028 id=emex028c value="3" tabindex=8
     onclick="MandatoryETA();">Contact List</input>
  </td>
  <td width=8%>&nbsp;</td> 
  <td width=15%>&nbsp;</td> 
  <td width=17%>&nbsp;</td> 
</tr>
<tr><td>&nbsp;</td></tr>

<tr><td class=DataLabel>Date Notified</td>
    <td>
      <table align=center width=100% border=0 cellspacing=0 cellpadding=0>
       <tr>
         <td>
           <input type="text" name=emexp015 size="12" tabindex=9
            class="Mandatory FutureDate" title="Expected Date" 
            value="%STANDARD.01.015"
            onblur="checkDate(UpdateForm.emexp015,'Expected Date')">
           <img src="../images/DateLookup.gif" class=Icon
            onclick="DateLookupFrame(UpdateForm.emexp015);">
           Time 
           <input type="text" name=emexp016 size="8" tabindex=10
            class=Mandatory title="Expected Time" value="%STANDARD.01.016" 
            onblur="checkTime(UpdateForm.emexp016,'Expected Time')">
           <img src="../images/TimeLookup.gif" class=Icon 
            onclick="TimeLookupFrame(UpdateForm.emexp016);">
           <img src="../images/stopwat1.gif" class=Icon
            onclick="SetCurrentDateTime(UpdateForm.emexp015,
                                        UpdateForm.emexp016);">
         </td>
         <td class=DataLabel>ETA</td>
         <td nowrap>
           <input type="text" name=emexp022 size="12" tabindex=11
            class="Date" title="ETA Date" value=""
            onblur="checkDate(UpdateForm.emexp022,'ETA Date')">
           <img src="../images/DateLookup.gif" class=Icon
            onclick="DateLookupFrame(UpdateForm.emexp022);">
           Time
           <input type="text" name=emexp023 size="8" tabindex=12
            title="ETA Time" value=""
            onblur="checkTime(UpdateForm.emexp023,'Triage Time')">
           <img src="../images/TimeLookup.gif" class=Icon
            onclick="TimeLookupFrame(UpdateForm.emexp023);">
           <img src="../images/DateTimeStamp.gif" class=Icon
            onclick="SetCurrentDateTime(UpdateForm.emexp022,
                                        UpdateForm.emexp023);">
         </td> 
         <td></td> 
         <td></td> 
       </tr>
      </table>
    </td>
    <td class=DataLabel>%STANDARD.01.017.ZQ </td>
    <td><select name=emexp020 class=SelectMed tabindex=13
         title="%STANDARD.01.017.ZQ ">
        <option></option>
        %STANDARD.01.007.ZQ 
        </select></td>
</tr>

<tr><td class=DataLabel>Presenting Complaint</td>
    <td rowspan=2>
    <textarea name=prcom001 wrap=hard valign=top tabindex=16 cols=51 rows=3
      onkeydown="LimitText(this,6,300);"
      onblur="TextareaBlurHandler(this);Validateprecom001();">
    </textarea>
    </td>
    <td class=DataLabel>%STANDARD.01.017.EA </td>
    <td>
      <select name=emexp014 tabindex=17 class="SelectMed"
       title="%STANDARD.01.017.EA " tabindex=17
       onchange="document.UpdateForm.emexp026.disabled=0;CheckAmbType();"
       onFocus="CheckAmbType();" >
      <option></option>
      %STANDARD.01.007.EA   
      </select>
    </td>
</tr>
<tr>
    <td></td>
    <td class=DataLabel>Amb Case No</td>
    <td><input type=text size=20 maxlength=15 name=emexp026 tabindex=18
         value="" title="Amb Case No">
    </td>
</tr>

<tr><td>&nbsp;</td></tr>
<tr>
    <td class=DataLabel valign=top><br>Expected Patient Notes</td>
    <td rowspan=3>
      <!-- cols=104 to allow for the spaces which occupied by the vertical
           scroll bar -->
      <textarea wrap=hard name=exptcmnt id=exptcmnt tabindex=19
       rows=10 cols=100 title="Expected Patient Notes"></textarea>
    </td>
    <td>%STANDARD.01.017.em </td>
    <td>
      <select name=emexp019 id=emexp019 tabindex=20 class="SelectMed"
       title="%STANDARD.01.017.em " tabindex=20
       onchange="checkSOR();">
      <option></option>
      %STANDARD.01.007.em
      </select>
    </td>
</tr>

<tr>
    <td></td>
    <td><span id=TranSrcHeading></span></td>
    <td><span id=TranSrc></span></td>
</tr>

<tr>
    <td></td>
    <td>%STANDARD.01.017.rR </td>
    <td>
      <select name=emexp030 id=emexp030 tabindex=23 class="SelectMed"
       title="%STANDARD.01.017.rR " onchange="checkrR();">
      <option></option>
      %STANDARD.01.007.rR
      </select>
    </td>
</tr>

<tr><td>&nbsp;</td></tr>
<tr>
  <td nowrap>
    Caller Name and Contact Number
  </td>
  <td>
    <input type=text size=80 maxlength=100 name=emexp032 tabindex=24
     title="Caller Name and Contact Number"> 
  </td>
  <td></td>
  <td></td>
</tr>

<tr><td>&nbsp;</td></tr>
<tr><td colspan=6 align=center><br>
    <input type=button value="Add" class=button tabindex=30 id="emr02a"
     onclick='tempDisable(this);SubmitForm();' >
    <input type=button value="Cancel" class=button tabindex=31
     onclick="CancelAction();">
    </td></tr>
</table>
</form>

<span id=sexfieldSPAN1 style="display:none;">
<input type=text size=15 maxlength=20 name=d_emexp004 tabindex=6
 class=Readonly readonly
 value=%EMRWEB02.02.086.099.061.3>
<input type=hidden name=emexp004>
</span>

<span id=sexfieldSPAN2 style="display:none;">
  <select name=emexp004 class=SelectSml tabindex=6>
    <option value=" "></option>
        %EMRWEB02.02.086.099.061.9.1.19.3.H
  </select>
</span>

<span id=transferhd style="display:none">
    <td class=DataLabel>Transfer Source</td>
</span>

<span id=transferblank style="display:none">
    <input type=hidden name=emexp031 value="" notab>
</span>

<span id=transfersrc style="display:none">
    <td nowrap>
     <input type="text" size=8 maxlength=6 name=emexp031
      id=emexp031 tabindex=22 title="Transfer Source" class=Mandatory
      onchange='validateCode(9,UpdateForm.emexp031,
                             UpdateForm.trnsfsrc);'>
     <input type=text  size=20 name=trnsfsrc notab readonly>
     <img class=Icon src="../images/SearchIcon.gif"
      onclick="TransferSourceFrame(UpdateForm.emexp031,
                                   UpdateForm.trnsfsrc)"></td>
</span>
