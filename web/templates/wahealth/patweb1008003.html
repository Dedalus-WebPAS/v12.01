<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function valDoctorUnit() {
  ValidateHCP(18,14,UpdateForm.pmbrq005,UpdateForm.n_pmbrq005);
  selectOptions4("45",UpdateForm.pmbrq005,UpdateForm.dummy,UpdateForm.pmbrq004);
  if(document.UpdateForm.pmbrq004.length=="2"){
    UpdateForm.pmbrq004.selectedIndex=1
  }
  valDoctorUnitTeam();
}
function valDoctorUnitTeam() {
  selectOptions4("46",UpdateForm.pmbrq005,UpdateForm.pmbrq004,UpdateForm.pmbrq018);
  if(document.UpdateForm.pmbrq018.length=="2"){
    UpdateForm.pmbrq018.selectedIndex=1
  }
}

function PostUpdate() {
  if(trim(document.UpdateForm.d_ptvitype.value)=="1") {
   document.UpdateForm.pmbrq014.value=document.UpdateForm.userhosp.value;
  } else {
   document.UpdateForm.pmbrq014.value=document.UpdateForm.d_pmbrq014.value;
  }
  document.UpdateForm.UpdButton.disabled=true;
  setTimeout('document.UpdateForm.UpdButton.disabled=false;',1500);
  setFormactn('U')
}
function SetExpBed() {
 ToggleReadyDT(document.UpdateForm.pmbrq009); // Enable Ready Date if a Ward is Selected 
 if(isWhitespace(document.UpdateForm.pmbrq009.value) ||
    isWhitespace(document.UpdateForm.d_pmbrq010.value)) {
   return;
 }
 selectOptions2('31',document.UpdateForm.pmbrq009,document.UpdateForm.pmbrq010);
 for (var i =0 ; i < document.UpdateForm.pmbrq010.length; i++) {
 if (document.UpdateForm.pmbrq010.options[i].value==
     document.UpdateForm.d_pmbrq010.value) {
     document.UpdateForm.pmbrq010.selectedIndex=i } };
 document.UpdateForm.d_pmbrq010.value="";
}

function ShowReadyDT() {
  if (document.getElementById('ReadyDateTime')) {
    document.getElementById('ReadyDateTime').style.display="";
  }
}

function HideReadyDT() {
  if (document.getElementById('ReadyDateTime')) {
    document.UpdateForm.pmbrq016.value = "";
    document.UpdateForm.pmbrq017.value = "";
    document.getElementById('ReadyDateTime').style.display="none";
  }
}

function ToggleReadyDT(DDLWard) {
  // Show Ward Bed Ready Date & Time
  if (!DDLWard || DDLWard == undefined)
    return;
  if (DDLWard.selectedIndex != 0) {
    ShowReadyDT();
  }
  else {
    HideReadyDT();
  }
}

function IcdDiagnosisSearch() {
  if(trim(UpdateForm.d_ptvitype.value)=="1") {
    EmrDiagnosisSearch2(UpdateForm.pmbrq008,
                        UpdateForm.n_pmbrq008,
                        UpdateForm.dummy);
  }
  else {
    Icd10DisSearchFrame(UpdateForm.pmbrq008,UpdateForm.n_pmbrq008);
  }
}
function EmrDiagnosisSearch2(ReturnCode,ReturnName,ReturnDesc) {
  DFrameStart();
  linkURL="emrweb05.pbl?reportno=7&template=7";
  window.ReturnCode=ReturnCode;
  window.ReturnName=ReturnName;
  document.getElementById('PopUpFrame').src=linkURL;
  SearchFrameShow();
}
function ValidateIcdDiagnosisCode () {
  if(trim(UpdateForm.d_ptvitype.value)=="1") {
    validateCode3(18,UpdateForm.pmbrq008,UpdateForm.n_pmbrq008);
  }
  else {
    validateCode(6,UpdateForm.pmbrq008,UpdateForm.n_pmbrq008);
  }
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
<script type="text/javascript">
  document.write('Ward/Bed Request - %PATWEB10.08.002');</script>
</span>
<form id=UpdateForm name=UpdateForm method=post action=patweb10.pbl>
<input type=hidden id=reportno name=reportno value="8">
<input type=hidden id=template name=template value="003">
<input type=hidden id=updttype name=updttype value=" ">
<input type=hidden id=urnumber name=urnumber value="%PATWEB10.08.003">
<input type=hidden id=admissno name=admissno value="%PATWEB10.08.101">
<input type=hidden id=pmbrq001 name=pmbrq001 value="%PATWEB10.08.101">
<input type=hidden id=d_pmbrq007 name=d_pmbrq007 value="%PATWEB10.08.107.1">
<input type=hidden id=ibcnmhos name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
<input type=hidden id=d_pmbrq010 name=d_pmbrq010 value="">
<input type=hidden id=pmbrq014 name=pmbrq014 value="">
<input type=hidden id=userhosp name=userhosp value="%STANDARD.01.032">
<input type=hidden id=d_ptvitype name=d_ptvitype value="%PATWEB10.08.315">
<input type=hidden id=dummy name=dummy>
<input type=hidden id=d_pmbrq004 name=d_pmbrq004 value="%PATWEB10.08.104.1">
<input type=hidden id=d_pmbrq018 name=d_pmbrq018 value="%PATWEB10.08.136.0">

<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Request Date</td>
    <td><input type=text size=12 id=pmbrq002 name=pmbrq002 class="Readonly" 
         title="Admission Date" readonly value="%PATWEB10.08.102">
         Time
        <input class=Readonly readonly type=text id=pmbrq003 name=pmbrq003 
         size=8
         value="%PATWEB10.08.103" title="Request Time">
    </td>
    </tr>
</table>

<div id="AdmitDetail"></div>

<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Type of Bed Required</td>
    <td><select id=pmbrq006 name=pmbrq006 class=Mandatory 
         title="Type of Bed Required">
        <option></option>
        %PATWEB10.08.106.2
        </select>
    </td></tr>
</table>

<div id="SpecialDetail"></div>

<div id="Hospital"></div>

<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Diagnosis</td>
    <td colspan=2><input type=text size=12 maxlength=10 id=pmbrq008 
     name=pmbrq008
     onchange="ValidateIcdDiagnosisCode();"
     value="%PATWEB10.08.108.1">
    <input type=text id=n_pmbrq008 name=n_pmbrq008 readonly class=Readonly 
     size=50
     tabindex=-1 value="%PATWEB10.08.137.0">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="IcdDiagnosisSearch();">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(UpdateForm.pmbrq008,UpdateForm.n_pmbrq008);">
    </td>
</tr>

<tr><td class=DataLabel valign=top>Notes</td>
    <td colspan=2>
    <textarea id=bedrqcom name=bedrqcom wrap=hard rows=4 cols=70>%PATWEB10.08.124</textarea>
    </td></tr>

<tr><td align=center colspan=3 rows=4><hr></td></tr>

<tr><td class=DataLabel>Expected Ward / Bed </td>
    <td><input type=hidden id=bedstat1 name=bedstat1>
        <input type=hidden id=warddesc name=warddesc>
        <select id=pmbrq009 name=pmbrq009 tabindex=13 title="Ward"
       onfocus="SetExpBed();" 
       onchange="selectOptions2('31',UpdateForm.pmbrq009,UpdateForm.pmbrq010);
                 ToggleReadyDT(this);">
        <option> </option>
         %PATWEB10.08.109.2
        </select>
        <select id=pmbrq010 name=pmbrq010 title="Expected Bed">
        <option></option>
         %PATWEB10.08.130
        </select>
        <img notab src=../images/SearchIcon.gif class=Icon
         id=wardsrch name=wardsrch
         onclick="WardBedSearchFrame(UpdateForm.pmbrq009,UpdateForm.warddesc,
                  UpdateForm.d_pmbrq010,UpdateForm.bedstat1);">
        <img src="../images/ClearIcon.gif" class=Icon
         id=wardbclr name=wardbclr
         onclick="UpdateForm.pmbrq009.selectedIndex=0;
                  UpdateForm.d_pmbrq010.value='';
                  UpdateForm.pmbrq010.options.length=0;HideReadyDT();">
    </td>
    <td class=DataLabel>
      <span id=ReadyDateTime style="display:none">
        &nbsp;&nbsp;Ward Bed Ready Date
        <input type="text" id=pmbrq016 name=pmbrq016 size=12 title="Date"
         value="%PATWEB10.08.134">
        <img src=../images/DateLookup.gif class=Icon
         onclick="DateLookupFrame(UpdateForm.pmbrq016);">Time&nbsp;
        <input type="text" id=pmbrq017 name=pmbrq017 size=8 title="Time"
         value="%PATWEB10.08.135">
        <img src="../images/DateTimeStamp.gif" class=Icon
         onclick="SetCurrentDateTime(UpdateForm.pmbrq016,UpdateForm.pmbrq017);">
        <img src="../images/TimeLookup.gif" class=Icon
         onclick="TimeLookupFrame(UpdateForm.pmbrq017);">
      </span>
    </td>
</tr>

<tr><td class=DataLabel>Created By</td>
    <td>%PATWEB10.08.120 &nbsp;%PATWEB10.08.118 %PATWEB10.08.119</td></tr>

<tr><td class=DataLabel>Allocated By</td>
    <td>%PATWEB10.08.114 &nbsp;%PATWEB10.08.112 %PATWEB10.08.113</td></tr>

<tr><td class=DataLabel><span id=InsertCanBy style="display: none">
                         Cancelled By
                        </span>
    </td><td>
    <span id=InsertCanDet style="display: none">
     %PATWEB10.08.117 &nbsp;%PATWEB10.08.115 %PATWEB10.08.116
     </span>
    </td></tr>

</table>

<table align=center width=100% border=0>
<tr><td align=center><br>
   <span id=InsertUpdButton style="display: none">
   <input type=button value="Update" class=button
    id=UpdButton name=UpdButton onclick="PostUpdate();">
   </span>

   <span id=InsertDelButton style="display: none">
   <input type=button value="Delete" class="button" 
    onclick="setFormactn('D');">
   </span>

   <input type=button value=Close class="button" 
    onclick="DFrameCloseRefresh();">
</td></tr>
</table>
</form>

<span id="ShowHospital" style="display: none">
<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Preferred Hospital</td>
    <td><select id=d_pmbrq014 name=d_pmbrq014 class=Mandatory 
        title="Preferred Hospital">
        <option></option>
        %PATWEB10.08.129.1
        </select>
    </td></tr>
</table>
</span>

<span id="ShowReq" style="display: none">
<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Requesting Department</td>
    <td><select id=pmbrq004 name=pmbrq004 class=Mandatory 
         title="Requesting Department">
        <option></option>
        %PATWEB10.08.104.9.1.02.2.R
        </select>
    </td></tr>

<tr><td class=DataLabel>Requesting Ward</td>
    <td><select id=pmbrq012 name=pmbrq012 title="Requesting Ward">
        <option></option>
        %PATWEB10.08.127
        </select>
    </td></tr>

<tr><td class=DataLabel>Admitting Dr/Unit</td>
   <td><input type=text id=pmbrq005 name=pmbrq005 size=10 maxlength=8 
        title="Admitting Dr/Unit" class=Mandatory value="%PATWEB10.08.105.1"
        onchange="UpCase(this); ValidateHCP(18,14,UpdateForm.pmbrq005,
        UpdateForm.n_pmbrq005);">
       <input type=text id=n_pmbrq005 name=n_pmbrq005 size=35 readonly title="HCP Name"
        class=Readonly tabindex=-1 value="%PATWEB10.08.105.0">
       <img src="../images/SearchIcon.gif" class=Icon
        onclick="HCPSearchFrame(UpdateForm.pmbrq005,UpdateForm.n_pmbrq005,1);">
        <img src="../images/ClearIcon.gif" class=Icon
        onclick="clrFields(UpdateForm.pmbrq005,UpdateForm.n_pmbrq005);">
       </td></tr>
</table>
</span>

<span id="ShowAdm" style="display: none">
<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Admitting Dr</td>
   <td><input type=text id=pmbrq005 name=pmbrq005 size=10 maxlength=8
        title="Admitting Dr" value="%PATWEB10.08.105.1" class=Mandatory
        onchange="UpCase(this); valDoctorUnit();">
       <input type=text id=n_pmbrq005 name=n_pmbrq005 size=35 readonly title="HCP Name"
        class=Readonly tabindex=-1 value="%PATWEB10.08.105.0">
       <img src="../images/SearchIcon.gif" class=Icon
        onclick="HCPSearchFrame(UpdateForm.pmbrq005,UpdateForm.n_pmbrq005,1,valDoctorUnit);">
        <img src="../images/ClearIcon.gif" class=Icon
        onclick="clrFields(UpdateForm.pmbrq005,UpdateForm.n_pmbrq005,
                 UpdateForm.pmbrq004,UpdateForm.pmbrq018);">
       </td></tr>

<tr><td class=DataLabel>Admitting Unit</td>
    <td><select id=pmbrq004 name=pmbrq004 class=Mandatory title="Admitting Unit"
         onchange="valDoctorUnitTeam();">
        <option></option>
        </select>
    </td></tr>

<tr><td class=DataLabel>Admitting Team</td>
    <td><select id=pmbrq018 name=pmbrq018 title="Admitting Team">
        <option></option>
        </select>
    </td></tr>

</table>
</span>

<span id="ShowSpeciality" style="display: none">
<table align=center width=100% border=0>
<tr><td class=DataLabel width=20%>Speciality Bed Required</td>
    <td><select id=pmbrq013 name=pmbrq013 title="Speciality Bed Required">
        <option></option>
        %PATWEB10.08.128.2
        </select>
    </td></tr>
</table>
</span>

<script type="text/javascript">
if(document.UpdateForm.d_pmbrq007.value=="3" ||
   document.UpdateForm.d_pmbrq007.value=="4") {
   document.UpdateForm.pmbrq009.disabled=true;
   document.UpdateForm.pmbrq010.disabled=true;
   document.UpdateForm.wardsrch.disabled=true;
   document.UpdateForm.wardbclr.disabled=true;
   InsertUpdButton.style.display="none";
} else {
   InsertUpdButton.style.display="";
}
if(document.UpdateForm.d_pmbrq007.value==" " ||
   document.UpdateForm.d_pmbrq007.value=="1") {
   InsertDelButton.style.display="";
} else {
   InsertDelButton.style.display="none";
}
if(document.UpdateForm.d_pmbrq007.value=="4") {
   InsertCanBy.style.display="";
   InsertCanDet.style.display="";
} else {
   InsertCanBy.style.display="none";
   InsertCanDet.style.display="none";
}

if(trim(document.UpdateForm.d_ptvitype.value)=="1") {
//  document.getElementById('AdmitDetail').innerHTML=ShowAdm.innerHTML
//  document.getElementById('AdmitDetail').style.display="";

  AdmitDetail.innerHTML=ShowAdm.innerHTML
  document.getElementById('SpecialDetail').innerHTML="";
  document.getElementById('SpecialDetail').style.display="none";
  document.UpdateForm.pmbrq006.className="";

  valDoctorUnit();
  for(var i =0 ; i < document.UpdateForm.pmbrq004.length; i++) {
    if (document.UpdateForm.pmbrq004.options[i].value.substr(0,3)==
        document.UpdateForm.d_pmbrq004.value) {
       document.UpdateForm.pmbrq004.selectedIndex=i } };

  valDoctorUnitTeam();
  for(var i =0 ; i < document.UpdateForm.pmbrq018.length; i++) {
    if (document.UpdateForm.pmbrq018.options[i].value.substr(0,10)==
        document.UpdateForm.d_pmbrq018.value) {
       document.UpdateForm.pmbrq018.selectedIndex=i } };
} else {
  if(document.UpdateForm.ibcnmhos.value=="1") {
    document.getElementById('Hospital').innerHTML=ShowHospital.innerHTML
    document.getElementById('Hospital').style.display="";

    for(var i =0 ; i < document.UpdateForm.d_pmbrq014.length; i++) {
    if (document.UpdateForm.d_pmbrq014.options[i].value=="%PATWEB10.08.129.0") {
       document.UpdateForm.d_pmbrq014.selectedIndex=i } };
  }
  document.getElementById('AdmitDetail').innerHTML=ShowReq.innerHTML
  document.getElementById('AdmitDetail').style.display="";
  document.getElementById('SpecialDetail').innerHTML=ShowSpeciality.innerHTML
  document.getElementById('SpecialDetail').style.display="";
}

if(document.UpdateForm.d_pmbrq007.value=="2") {
  // Show Ward Bed Ready Date & Time if status = 'Allocated'
  document.getElementById('ReadyDateTime').style.display="";
}

ValidateIcdDiagnosisCode();
</script>
