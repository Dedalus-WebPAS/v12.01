<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language="javascript" src="../js/HONOSAlerts.js"></script>
<script language=javascript src="../js/allweb0210.js"></script>
<script type="text/javascript">
 function UpdateHON() {

   f=document.UpdateForm;
   var mhhon039title = "";
   mhhon039title = f.mhhon039.title
   f.mhhon039.title=mhhon039title.replace(/^\s+|\s+$/gm,'');

   if (f.superlev.value == "1") {
     if (f.mhhon096.selectedIndex != "0" ) {
       alert('Reason for Delete may not be entered for Update');
       f.mhhon096.className="";
       return false;
     }
   }
   if(!IsTimestampBetweenRange(f.admndate,f.zerotime,f.discdate,f.zerotime,f.mhhon006,f.zerotime)){
      return false;
   }
   if(!CompareDateToNow(f.mhhon006,f.zerotime)){
      return false;
   }

   if((f.mhhon008.value.substr(3,1) == 'Y')&&(chkDischarge(f))) {
      return false
   }
   
   if (validateMandatory(UpdateForm)) {
       f.updatety.value="Y";
       f.submit();
   }
 }
 function DeleteHON() {
   if (validateMandatory(UpdateForm)) {
     if (confirm("Are you sure you want to Delete ?")) {
       UpdateForm.updatety.value="Z";
       UpdateForm.submit();
     }
   }
 }
 function SubmitHON(){
   if (!isWhitespace(document.UpdateForm.mhhon006.value)&&
       !isWhitespace(document.UpdateForm.mhhon017.value)) {

     var strtDay = document.UpdateForm.mhhon006.value.substring(0,2);
     var strtMon = document.UpdateForm.mhhon006.value.substring(3,6);
     var strtYear = document.UpdateForm.mhhon006.value.substring(7,11);
     strtMon = GetMonthNumber(strtMon);
     var CollDate = strtYear+strtMon+strtDay;
     strtDay = document.UpdateForm.mhhon017.value.substring(0,2);
     strtMon = document.UpdateForm.mhhon017.value.substring(3,6);
     strtYear = document.UpdateForm.mhhon017.value.substring(7,11);
     strtMon = GetMonthNumber(strtMon);
     var CompDate = strtYear+strtMon+strtDay;
     if (CompDate < CollDate) {
       alert("Completion Date must be equal or after Collection Date.");
       return;
     }
   }
   if (!isWhitespace(document.UpdateForm.mhhon006.value)&&
       !isWhitespace(document.UpdateForm.dateclsd.value)) {
     var strtDay = document.UpdateForm.mhhon006.value.substring(0,2);
     var strtMon = document.UpdateForm.mhhon006.value.substring(3,6);
     var strtYear = document.UpdateForm.mhhon006.value.substring(7,11);
     strtMon = GetMonthNumber(strtMon);
     var CollDate = strtYear+strtMon+strtDay;
     var DteClosd = document.UpdateForm.dateclsd.value;
     if (DteClosd < CollDate) {
       alert("HoNOS Date cannot be after Referral Close Date.");
       return;
     }
   }
   if (validateMandatory(document.UpdateForm)) {
     document.UpdateForm.submit();
   }
 }
 function Display8A() {
   i=document.UpdateForm.mhhon039.selectedIndex;
   ind=document.UpdateForm.mhhon039.options[i].value.substring(14,15)
   if (ind!="J") {
     Quest8A.innerHTML=quest8ablank.innerHTML;
     document.UpdateForm.mhhon040.value="";
   } else {
     Quest8A.innerHTML=quest8a.innerHTML;
   }
 }
 function checkRating(field){
   if (isWhitespace(field.value)) {return;}
   if (field.value=="0") {return;}
   if (field.value=="1") {return;}
   if (field.value=="2") {return;}
   if (field.value=="3") {return;}
   if (field.value=="4") {return;}
   if (field.value=="7") {return;}
   alert("'"+field.value+"' - "+"Invalid Rating");
   field.value="";
   field.focus();
 }
 function Set8A(val){
   var mhhon039 = document.UpdateForm.mhhon039;
   if (val!=0){
     return false;
   }
   for (i=0; i<mhhon039.options.length; i++){
      if (mhhon039.options[i].value.substring(3,4)=="X") {
        mhhon039.selectedIndex=i;
        break;
      }
   }
 }

 function SetFOCClass() {
   var indc1 = document.UpdateForm.mhhon008.value.substr(3,1);
   if (indc1 == 'N') {
     document.UpdateForm.mhhon022.className = "Mandatory";
     document.UpdateForm.mhhon031.className = "Mandatory";
     document.UpdateForm.mhhon032.className = "Mandatory";
     document.UpdateForm.mhhon033.className = "Mandatory";
     document.UpdateForm.mhhon034.className = "Mandatory";
     document.UpdateForm.mhhon035.className = "Mandatory";
     document.UpdateForm.mhhon036.className = "Mandatory";
     document.UpdateForm.mhhon037.className = "Mandatory";
     document.UpdateForm.mhhon038.className = "Mandatory";
     document.UpdateForm.mhhon039.className = "Mandatory";
     document.UpdateForm.mhhon041.className = "Mandatory";
     document.UpdateForm.mhhon042.className = "Mandatory";
     document.UpdateForm.mhhon043.className = "Mandatory";
     document.UpdateForm.mhhon044.className = "Mandatory";
     document.UpdateForm.mhhon085.className = "Mandatory";
   }
   else {
     document.UpdateForm.mhhon022.className = "";
     document.UpdateForm.mhhon031.className = "";
     document.UpdateForm.mhhon032.className = "";
     document.UpdateForm.mhhon033.className = "";
     document.UpdateForm.mhhon034.className = "";
     document.UpdateForm.mhhon035.className = "";
     document.UpdateForm.mhhon036.className = "";
     document.UpdateForm.mhhon037.className = "";
     document.UpdateForm.mhhon038.className = "";
     document.UpdateForm.mhhon039.className = "";
     document.UpdateForm.mhhon041.className = "";
     document.UpdateForm.mhhon042.className = "";
     document.UpdateForm.mhhon043.className = "";
     document.UpdateForm.mhhon044.className = "";
     document.UpdateForm.mhhon085.className = "";
   }
 }
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);SetFOCClass();">
<span class=DFrameTitleBar>
  <img align="right" alt="Exit" class="MenuIcon"
       src="../images/ExitIcon.gif" onclick="DFrameExit();">
  Update Psychogeriatric HoNOS 65+ Assessment 
</span>

<div id=PageBodySection >
<form name=UpdateForm method=post action=allweb02.pbl style="margin:0">
  <input type=hidden name=urnumber value="%ALLWEB02.10.003">
  <input type=hidden name=admissno value="%ALLWEB02.10.081">
  <input type=hidden name=mhhon001 value="%ALLWEB02.10.901">
  <input type=hidden name=mhhon002 value="%ALLWEB02.10.902">
  <input type=hidden name=reportno value=10>
  <input type=hidden name=template value="016">
  <input type=hidden name=updatety value=" ">
  <input type=hidden name=inpstats value="%ALLWEB02.10.086.092">
  <input type=hidden name=currdate value="%STANDARD.01.015">
  <input type=hidden name=over24hr value="%ALLWEB02.10.816">
  <input type=hidden name=superlev value="%ALLWEB02.10.811">
  <input type=hidden name=admndate id=admndate value="%ALLWEB02.10.602">
  <input type=hidden name=admntime id=admntime value="%ALLWEB02.10.603">
  <input type=hidden name=discdate id=discdate value="%ALLWEB02.10.701">
  <input type=hidden name=disctime id=disctime value="%ALLWEB02.10.702">
  <input type=hidden name=disctime id=zerotime value="00:00:00">

 <table cellspacing=0 cellpadding=0 border=0 width=100% align=center>
   <tr><td class=DataLabel>Assessment Date</td>
       <td colspan=3><input type=text name=mhhon006 id=mhhon006
            value="%ALLWEB02.10.906"
            title="Assessment Date" class="Mandatory Date" tabindex=1>
             <img src="../images/DateTimeStamp.gif" class=Icon
                  onclick="SetCurrentDateTime(UpdateForm.mhhon006,null);">
             <img src="../images/DateLookup.gif" class=Icon
                  title="Select a Date"
            onclick="DateLookupFrame(UpdateForm.mhhon006);"></td></tr>
   
   <tr><td class=DataLabel>Admission for Assessment Only</td>
       <td><select name="mhhon008" title="Admission for Assessment Only"
            tabindex=2 class="Mandatory" onchange="SetFOCClass();">
             <option></option>
             %ALLWEB02.10.908.2
           </select>
       </td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td class="DataLabel">Focus of Care</td>
       <td><select name="mhhon022" title="Focus of Care" tabindex=3>
             <option></option>
             %ALLWEB02.10.922.2
            </select></td>
       <td colspan=2>&nbsp;</td></tr>

   <tr><td colspan=4><hr></td></tr>

   <tr><td class=DataLabel>1.&nbsp;Overactive, aggressive, disruptive or
                           agitated</td>
       <td><input type=text name=mhhon031 size=4 maxlength=1 title="1"
                  value="%ALLWEB02.10.931" tabindex=10
                  onblur='checkRating(mhhon031);'>
             <img src="../images/HelpIcon.gif" class=Icon
                  onclick="Alert1();"></td>
       <td class=DataLabel>8.&nbsp;Other mental and behavioural problems</td>
       <td><input type=text name=mhhon038 size=4 maxlength=1 title="8"
                  value="%ALLWEB02.10.938" tabindex=40
                  onblur='checkRating(mhhon038);Set8A(this.value);'>
             <img src="../images/HelpIcon.gif" class=Icon
                  onclick="Alert8();"></td></tr>

   <tr><td class=DataLabel>2.&nbsp;Non-accidental self-injury</td>
       <td><input type=text name=mhhon032 size=4 maxlength=1 title="2"
                  value="%ALLWEB02.10.932" tabindex=13
                  onblur='checkRating(mhhon032);'>
             <img src="../images/HelpIcon.gif" class=Icon
                  onclick="Alert2();"></td>
       <td class=DataLabel>8a.</td>
       <td><select name=mhhon039 title="%STANDARD.01.035.hb" tabindex=43
                   onchange="Display8A();">
             <option></option>
             %ALLWEB02.10.817.2 
           </select><div id=Quest8A></div></td></tr>

   <tr><td class=DataLabel>3.&nbsp;Problem drinking or drug-taking</td>
       <td><input type=text name=mhhon033 size=4 maxlength=1 title="3"
                  value="%ALLWEB02.10.933" tabindex=16
                  onblur='checkRating(mhhon033);'>
             <img src="../images/HelpIcon.gif" class=Icon
                  onclick="Alert3();"></td>
   <td class=DataLabel>9.&nbsp;Problems with relationships</td>
       <td><input type=text name=mhhon041 size=4 maxlength=1 title="9"
                  value="%ALLWEB02.10.941" tabindex=46
                  onblur='checkRating(mhhon041);'>
             <img src="../images/HelpIcon.gif" class=Icon
                  onclick="Alert9();"></td></tr>

   <tr><td class=DataLabel>4.&nbsp;Cognitive problems</td>
       <td><input type=text name=mhhon034 size=4 maxlength=1 title="4"
                  value="%ALLWEB02.10.934" tabindex=19
                  onblur='checkRating(mhhon034);'>
             <img src="../images/HelpIcon.gif" class=Icon
                   onclick="Alert4();"></td>
       <td class=DataLabel>10.&nbsp;Problems with activities of daily living</td>
       <td><input type=text name=mhhon042 size=4 maxlength=1 title="10"
                  value="%ALLWEB02.10.942" tabindex=49
                  onblur='checkRating(mhhon042);'>
             <img src="../images/HelpIcon.gif" class=Icon
                  onclick="Alert10();"></td></tr>

   <tr><td class=DataLabel>5.&nbsp;Physical illness or disability problems</td>
       <td><input type=text name=mhhon035 size=4 maxlength=1 title="5"
                  value="%ALLWEB02.10.935" tabindex=22
                  onblur='checkRating(mhhon035);'>
            <img src="../images/HelpIcon.gif" class=Icon
                  onclick="Alert5();"></td>
       <td class=DataLabel>11.&nbsp;Problems with living conditions</td>
       <td><input type=text name=mhhon043 size=4 maxlength=1 title="11"
                  value="%ALLWEB02.10.943" tabindex=52
                  onblur='checkRating(mhhon043);'>
            <img src="../images/HelpIcon.gif" class=Icon
                 onclick="Alert11();"></td></tr>

   <tr><td class=DataLabel>6.&nbsp;Problems with hallucinations and
                 delusions</td>
       <td><input type=text name=mhhon036 size=4 maxlength=1 title="6"
                  value="%ALLWEB02.10.936" tabindex=25
                  onblur='checkRating(mhhon036);'>
             <img src="../images/HelpIcon.gif" class=Icon
                  onclick="Alert6();"></td>
       <td class=DataLabel>12.&nbsp;Problems with occupation and activities</td>
       <td><input type=text name=mhhon044 size=4 maxlength=1 title="12"
                  value="%ALLWEB02.10.944" tabindex=55
                  onblur='checkRating(mhhon044);'>
             <img src="../images/HelpIcon.gif" class=Icon
                  onclick="Alert12();"></td></tr>

   <tr><td class=DataLabel>7.&nbsp;Problems with depressed mood</td>
       <td><input type=text name=mhhon037 size=4 maxlength=1 title="7"
                  value="%ALLWEB02.10.937" tabindex=28
                  onblur='checkRating(mhhon037);'>
             <img src="../images/HelpIcon.gif" class=Icon
                  onclick="Alert7();"></td>
       <td class=DataLabel>HoNOS Version</td>
       <td><select name=mhhon085 tabindex=58 title="HoNOS Version">
             <option></option>
             %ALLWEB02.10.985.2
           </select></td></tr>

   <tr><td class="HeadingCell" align=center colspan=4>
           <div id="reasonHeading"></div></td></tr>

   <tr><td class=DataLabel><div id="reasonHead"></div></td>
       <td colspan=3><div id="reasonCode"></div></td></tr>

   <tr><td>&nbsp;</td></tr>

   <tr><td colspan=4 align=center>
         <input type=button id=btnUpdate value="Update" class="button"
          tabindex=100
          onclick="tempDisable(this);UpdateHON();">
         <span id="deleteButton" style="display: none">
         <input type=button id=btnDelete value="Delete" class="button"
          tabindex=101
          onclick='tempDisable(this);
                   UpdateForm.mhhon096.className="Mandatory";
                   DeleteHON();'>
         </span>
         <input type=button value=Cancel class="button"
          onclick="DFrameCloseRefresh();"></td></tr>
 </table>
</form>
</div>

<form name=PatientLinks method=get>
 <input type=hidden name=reportno value=1>
 <input type=hidden name=template value="004">
 <input type=hidden name=urnumber value="%ALLWEB02.10.003">
 <input type=hidden name=admissno value="%ALLWEB02.10.081">
 <input type=hidden name=MenuType value="%ALLWEB02.10.088">
 <input type=hidden name=webuseid value="%STANDARD.01.008">
</form>

<span id="reasonhdg" style="display:none">&nbsp;</span>
<span id="reasonhd" style="display:none">Reason For Delete</span>
<span id="reasoncd" style="display:none">
 <select name="mhhon096" title="Reason for Delete" tabindex=70>
      <option></option>
       %ALLWEB02.10.814.2
     </select>
</span>

<span id=quest8a style="display:none">
 <input type=text size=40 maxlength=35 name=mhhon040 class=Mandatory>
</span>

<span id=quest8ablank style="display:none">
 <input type=hidden name=mhhon040 class="">
</span>

<script type="text/javascript">

 for (var i=0 ; i < UpdateForm.mhhon022.length; i++) {
   if (UpdateForm.mhhon022.options[i].value.substring(0,3)
                                       =="%ALLWEB02.10.922.1") {
     UpdateForm.mhhon022.selectedIndex=i; }
 }
 for (var i=0 ; i < UpdateForm.mhhon085.length; i++) {
   if (UpdateForm.mhhon085.options[i].value.substring(0,3)
                                       =="%ALLWEB02.10.985.1") {
     UpdateForm.mhhon085.selectedIndex=i; }
 }
 if (UpdateForm.superlev.value == "1") {
   reasonHeading.innerHTML=reasonhdg.innerHTML;
   reasonHead.innerHTML=reasonhd.innerHTML;
   reasonCode.innerHTML=reasoncd.innerHTML;
   deleteButton.style.display="";
 }

 //AttachEventHandler('mhhon006','blur',CheckAssmntDate);
</script>

