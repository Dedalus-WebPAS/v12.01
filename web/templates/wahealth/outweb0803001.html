<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/OutExtraTemplates.js"></script>
<script type="text/javascript" src="../js/outweb0803001.js"></script>
</head>
%START.OF.PAGE
<script type="text/javascript">
function displayDisasterID() {
 p=document.AddForm
  if (!isWhitespace(document.AddForm.dispt001.value)) {
    disasteridnumbertitleDIV.innerHTML=disasteridnumbertitleSPAN.innerHTML;
    disasteridnumberDIV.innerHTML=disasteridnumberSPAN.innerHTML;
  } else {
    disasteridnumbertitleDIV.innerHTML="";
    disasteridnumberDIV.innerHTML="";
  }

  if (!isWhitespace(disasteridnumberDIV.innerHTML)) {
    var serverURL   = "../cgi-bin/patweb80.pbl?reportno=98" +
                    "&valdcode=" + AddForm.urnumber.value.replace(/ /g,"+") +
                    AddForm.dispt001.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|");
      if (!isWhitespace(ReturnValue[0])) {
        p.dispt002.value=ReturnValue;
        p.dispt002.className="Readonly";
        p.dispt002.readOnly=true;
      }
    }
  }
}

function valClaimCode() {
  validateCode(41,AddForm.urnumber,AddForm.claimc);
  for (var i =0 ; i < document.AddForm.outbb002.length; i++) {
    if (document.AddForm.claimc.value==
        trim(document.AddForm.outbb002.options[i].value.substr(0,3))){
          document.AddForm.outbb002.selectedIndex=i;
    }
  }
  showFundingSource(AddForm);
}
function SendLetter(theForm) {
 if(theForm.outbb047.value.substr(10,1) == "C" ) { // Ind 8 - Chart Only    
    theForm.sendlett.selectedIndex=3;              // set send letter to N/A
    theForm.sendlett.className="Readonly";        
    theForm.sendlett.disabled=true;       
  } else {
    if(theForm.sendlett.disabled==true) {          // Defalut send letter to
       theForm.sendlett.selectedIndex=0;           // Blank when re enabled
    }
    theForm.sendlett.className="";
    theForm.sendlett.disabled=false;
  }
    if((theForm.lastbdat.value) < SetDateYYYYMMDD(theForm.currdate.value)) {
      theForm.sendlett.className="Readonly";       // CAR 271432
      theForm.sendlett.disabled=true;
    }
}
function DisplayWarning(){
  if(AddForm.outbb070.value.substr(3,1)=="W"){
     alert("Warning: This code is only to be used \n"
           +"when the patient or carer is not present.");
  }
}
function DisabledFields(){
  f = document.AddForm;
  f.outbb068.disabled = true;
  f.outbb072.disabled = true;
  f.outbb069.disabled = true;
}
function ReEnableFields(){
  f = document.AddForm;
  f.outbb068.disabled = false;
  f.outbb072.disabled = false;
  f.outbb069.disabled = false;
}
function valReferralClaim() {
  var claimCodeVal = AddForm.outbb002.value.substr(0,3);
  var serverURL = "../cgi-bin/outweb02.pbl?reportno=9&updatety=19" +
                  "&admissno="+PatientLinks.admissno.value.replace(/ /g,"+") +
                  "&outbb002="+claimCodeVal +
                  "&urnumber="+PatientLinks.urnumber.value.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    if (ReturnValue[0] === '1') {
      var categoryName = ReturnValue[3].trim();
      var ans=confirm("The Outpatient Appointment " + categoryName +
      " does not match the Referral " + categoryName + ".\n\n" +
      "Outpatient Appointment " + categoryName + " = " + ReturnValue[2] +
      "\n" +
      "Referral " + categoryName + " = " + ReturnValue[1] + "\n\n" +
      "Press OK to update the Referral " + categoryName + " code.\n" +
      "Press Cancel to leave the Referral " +categoryName+ " code unchanged.");
      if (ans) {
        var fundingSourceVal = AddForm.pmsvx141.value.substr(0,3);
        var serverURL = "../cgi-bin/outweb02.pbl?reportno=9&updatety=20" +
                        "&admissno="+PatientLinks.admissno.value.replace(/ /g,"+") +
                        "&outbb002="+claimCodeVal+"&pmsvx141="+fundingSourceVal +
                        "&urnumber="+PatientLinks.urnumber.value.replace(/ /g,"+");
        var returnValue = RSExecute(serverURL);
      }
    }
  }
}
</script>
<body onload="PageLoad(event);
              valClaimCode();
              GetBookings();
              DisplayCarer();
              SetAppointDefaults();
              SendLetter(AddForm);
              DisabledFields();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Make A Series Appointment
</span>

<div id=PageBodySection style="overflow: auto;">
<form name=AddForm action=outweb08.pbl method=post style="margin:0"
 onSubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value="04">
<input type=hidden name=template value="001">
<input type=hidden name=urnumber value="%OUTWEB08.03.003">
<input type=hidden name=admissno value="%OUTWEB08.03.081">
<input type=hidden name=bookflag value="%OUTWEB08.03.214">
<input type=hidden name=refrlvis value="%OUTWEB08.03.353.001">
<input type=hidden name=refrdate value="%OUTWEB08.03.353.019">
<input type=hidden name=refrexpd value="%OUTWEB08.03.353.087">
<input type=hidden name=refrclin value="%OUTWEB08.03.353.088.1">
<input type=hidden name=refrctyp value="%OUTWEB08.03.353.067.1">
<input type=hidden name=refrprty value="%OUTWEB08.03.353.027.3">
<input type=hidden name=refrclmc value="%OUTWEB08.03.353.035.1">
<input type=hidden name=refrfsrc value="%OUTWEB08.03.599.009.1">
<input type=hidden name=refrfgpc value="%OUTWEB08.03.353.022.1">
<input type=hidden name=refrfgpn value="%OUTWEB08.03.353.022.0">
<input type=hidden name=refrpcom value="%OUTWEB08.03.353.081">
<input type=hidden name=refrsrce value="%OUTWEB08.03.353.034.3">
<input type=hidden name=refrprb1 value="">
<input type=hidden name=refrprb2 value="">
<input type=hidden name=refrprb3 value="">
<input type=hidden name=refdia1c value="%OUTWEB08.03.353.031.1">
<input type=hidden name=refdia1d value="%OUTWEB08.03.353.031.0">
<input type=hidden name=refdia2c value="%OUTWEB08.03.353.032.1">
<input type=hidden name=refdia2d value="%OUTWEB08.03.353.032.0">
<input type=hidden name=refdia3c value="%OUTWEB08.03.353.033.1">
<input type=hidden name=refdia3d value="%OUTWEB08.03.353.033.0">
<input type=hidden name=updttype value="5">
<input type=hidden name=nextpage value="8">
<input type=hidden name=redirect value="%OUTWEB08.03.001.patweb98.01.001">
<input type=hidden name=dummy value="">
<input type=hidden name=firstbok value="">
<input type=hidden name=lastbdat value="">
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden name=seriflag value="1">
<input type=hidden name=claimc>
<input type=hidden name=clinctyp value="%OUTWEB08.03.205.1">
<input type=hidden name=otheccar value="%OUTWEB08.03.218">
<input type=hidden name=ptcnxcom value="%STANDARD.01.025.116.222.0.1">
<input type=hidden name=outbb013 value="">
<input type=hidden name=outbb001 value="">
<input type=hidden name=tmotfrst value="30">
<input type=hidden name=tmotnext value="30">

<table cellspacing=0 cellpadding=1 border=0 width=95% align=center>
<tr><td>
<div id=Appointments></div>
</td></tr>

<tr><td class=DataLabel width=20%>Visit Type</td>
    <td class=DataField colspan=3>
    <select name=outbb047 title="Visit Type" class="SelectBig Mandatory"
     tabindex=1 onchange="SendLetter(AddForm);">
    <option> </option>
    %OUTWEB08.03.199
    </select>
    </td></tr>

<tr valign=top>
    <td class=DataLabel>Presenting Complaint</td>
    <td class=DataField colspan=3>
    <input type=text name=pmsvx052 size=50 maxlength=50 value="" tabindex=2>
    </td></tr>

<tr valign=top>
    <td class=DataLabel>Diagnosis</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb045 id=outbb045 value="" tabindex=3
     onblur="validateCode(6,AddForm.outbb045,AddForm.outbb046);">
    <input type=text name=outbb046 id=outbb046 readonly class=Readonly
     tabindex=-1 size=65 maxlength=50 value="">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb045,AddForm.outbb046);">
    <img src="../images/LookupIcon.gif" class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb045,AddForm.outbb046);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb055 id=outbb055 value="" tabindex=4
     onblur="validateCode(6,AddForm.outbb055,AddForm.outbb056);">
    <input type=text name=outbb056 id=outbb056 readonly class=Readonly
     tabindex=-1 size=65 maxlength=50 value="">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb055,AddForm.outbb056);">
    <img src="../images/LookupIcon.gif" class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb055,AddForm.outbb056);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb057 id=outbb057 value="" tabindex=5
     onblur="validateCode(6,AddForm.outbb057,AddForm.outbb058);">
    <input type=text name=outbb058 id=outbb058 readonly class=Readonly
     tabindex=-1 size=65 maxlength=50 value="">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb057,AddForm.outbb058);">
    <img src="../images/LookupIcon.gif" class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb057,AddForm.outbb058);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb059 id=outbb059 value="" tabindex=6
     onblur="validateCode(6,AddForm.outbb059,AddForm.outbb060);">
    <input type=text name=outbb060 id=outbb060 readonly class=Readonly
     tabindex=-1 size=65 maxlength=50 value="">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb059,AddForm.outbb060);">
    <img src="../images/LookupIcon.gif" class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb059,AddForm.outbb060);">
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField>
    <table cellspacing=0 cellpadding=0>
    <tr><td>
       <select name=outbb002 class="Mandatory SelectBig" tabindex=7
        title="%STANDARD.01.017.CL"
        onchange="showFundingSource(AddForm);">
        <option></option>
        %OUTWEB08.03.197.2
        </select>
        </td>
        <td><div id=FundingHeading></div></td>
        <td><div id=FundingId></div></td></tr>
        </table>
    </td>
    <td class=DataLabel>Referring GP</td>
    <td class=DataField>
    <input type=hidden name=dummy1 id=dummy1 value="6">
    <input type=hidden name=outbb029 id=outbb029>
    <input type=text readonly name=name_outbb029 tabindex=-1
     value="%OUTWEB08.03.148.004" class=Readonly>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="HCPSearchFrame(AddForm.outbb029,
                             AddForm.name_outbb029,
                             AddForm.dummy1.value)">
    <img src="../images/erase.gif" class=Icon 
     onclick="clrFields(AddForm.outbb029,AddForm.name_outbb029);"></td>
    </td></tr>

<tr><td class=DataLabel>Has this patient been in a Motor Vehicle Accident?</td>
    <td><select class="Mandatory" name=opwamvny tabindex=1
                title="Has this patient been in a Motor Vehicle Accidenti?">
           <option value="0">No</option>
           <option value="1">Yes</option>
        </select>
    </td>
</tr>

<tr><td class=DataLabel>NMDS Code</td>
    <td class=DataField><select name=outbb068 class=SelectBig tabindex=8>
        <option></option>
        %OUTWEB08.03.222.2
        </select>
    </td>
    <td class=DataLabel>Transport</td>
    <td class=DataField><select name=outbb023 class=selectBig tabindex=21>
        <option></option>
        %OUTWEB08.03.142.2
        </select></td>
    </tr>

<tr><td class=DataLabel>Tier 2 Code</td>
    <td class=DataField><select name=outbb072 tabindex=8
        class="SelectBig" title="Tier 2 Code">
        <option></option>
        %OUTWEB08.03.230.2
        </select>
    </td>
    <td class=DataLabel>Service Delivery Mode</td>
    <td class=DataField><select name=outbb070 class=SelectBig tabindex=22
     onchange="DisplayWarning();">
        <option></option>
        %OUTWEB08.03.224.2
        </select>
        </td>
    </tr>

<tr><td class=DataLabel>Care Type</td>
    <td class=DataField><select name=outbb069 class=SelectBig tabindex=9>
        <option></option>
        %OUTWEB08.03.223.2
        </select>
    </td>
    <td>Disaster Code</td>
    <td><select name=dispt001 title="Disaster Code" tabindex=23
         onchange="displayDisasterID();">
         <option></option>
          %OUTWEB08.03.226
        </select>
       </td>

    </tr>

<tr><td class=DataLabel>Clinical High Risk</td>
    <td><input type=checkbox value=1 name=outbb071 tabindex=10></td>
    <td class=DataLabel><div id=disasteridnumbertitleDIV></div></td>
    <td><div id=disasteridnumberDIV></div></td>
</tr>

<tr><td class=DataLabel>Notify GP</td>
    <td><input type=checkbox value=1 name=outbb036 tabindex=12></td>
    <td class=DataLabel>Send Letter</td>
    <td><select name=sendlett tabindex=25
         title="Send Letter - Generate letter date will be calculated">
        <option></option>
        <option value="0">No</option>
        <option value="1">Yes</option>
        <option value="2">N/A</option>
        </select>
    </td>
    </tr>

<tr><td>Interpreter Required</td>
    <td><input type="hidden" name="pmsvx093" value="">
        <input type="checkbox" name="d_pmsvx093" value="1" tabindex=13>
    &nbsp;
    <span class="Red">%OUTWEB08.03.086.002.0</span>
    </td>
    <td></td>
    <td></td>
    </tr>

<tr valign=top><td class=DataLabel>Appointment Comments</td>
    <td class=DataField colspan=3>
    <textarea name=outptcom wrap=hard cols=70 rows=3 tabindex=60></textarea>
    </td></tr>

<tr valign=top><td class=DataLabel>Patient Instructions (Printable)</td>
    <td class=DataField colspan=3>
    <textarea name=patinstr wrap=hard cols=60 rows=3 tabindex=61
     onkeydown="LimitText(this,99,200);"></textarea>
    </td></tr>

</table>
     
<div id=ShowCarer></div>

<table border=0 width=90% cellspacing=0 cellpadding=0 align=center>
<tr><td colspan=4 align=center>
    <input type=button class=button value="Ok" tabindex=100
     name=okbutton id=okbutton
     onclick="tempDisable(this);valReferralClaim();SubmitFinal();">
    <input type=button class=button Value="Cancel" tabindex=101
     onclick="DFrameClose()">
    </td></tr>

</form>
</table>
</div>

<span id=sendcarer style="display:none">
<table border=0 width=90% cellspacing=0 cellpadding=0 align=center>
<tr><td width=15% class=DataLabel>Send Correspondence to Carer</td>
    <td class=DataField><input type=checkbox value=1 name=outbb065 checked
                         tabindex=90>
    </td></tr>
</table>
</span>

<span id=disasteridnumbertitleSPAN style="display:none">
Disaster Identification #
</span>

<span id=disasteridnumberSPAN style="display:none">
<input type="text" name=dispt002 size=20 maxlength=19
   tabindex=24 title="Disaster Identification Number">
</span>

<span id=offdutyhd style="display:none">
&nbsp;Off Duty&nbsp;
</span>

<span id=offdutyid style="display:none">
<input type="checkbox" name="offdutyb" value="0 tabindex=7">
</span>

<span id=blanklabel style="display:none">
<input type=hidden name=pmsvx141 value=" ">
</span>

<span id=fundinghd style="display:none">
&nbsp;Funding Source&nbsp;
</span>

<span id=fundingidshow style="display:none">
<select name=pmsvx141 title="%STANDARD.01.017.cx" tabindex=7>
<option> </option>
%OUTWEB08.03.599.009.4
</select>
</span>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value="%OUTWEB08.03.003">
<input type=hidden name=admissno value="%OUTWEB08.03.081">
<input type=hidden name=MenuType value="%OUTWEB08.03.088">
</form>

<script type="text/javascript">
 filterCatCodeList(document.AddForm.outbb002,"1","M","1");
 ClinicalRisk="%OUTWEB08.03.225"
 if(ClinicalRisk=="1") {
   document.AddForm.outbb071.checked=true;
   document.AddForm.outbb071.disabled=true;
 }
 PMIInterpreter="%OUTWEB08.03.086.001.0";
 if (PMIInterpreter != "1") {
    AddForm.d_pmsvx093.disabled=true;
 } else {
    AddForm.d_pmsvx093.checked=true;
 }
</script>
