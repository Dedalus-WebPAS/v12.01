<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/AutoPostCode.js"> </script>
<script type="text/javascript" src="../js/patweb1004002.js"> </script>
<script type="text/javascript">
function LinkDFExit() {
 if(document.AddForm.trnsflag.value!="0") {
   location.href="outweb02.pbl?reportno=03&template=013" +
                 "&admissno=" + AddForm.pmtsp002.value.replace(/ /g,"+") +
                 "&waitflag=" + AddForm.waitflag.value.replace(/ /g,"+")
   parent.document.getElementById('PopUpScreen').style.width=700;
   parent.document.getElementById('PopUpScreen').style.height=400;
   Left=(parent.document.body.clientWidth-700)/2;
   parent.document.getElementById('PopUpScreen').style.left=Left;
 } else {
   if(document.AddForm.opupdate.value=="1") {
     linkURL="outweb02.pbl?reportno=3&template=1" +
               "&urnumber=" + AddForm.urnumber.value.replace(/ /g,"+") +
               "&admissno=" + AddForm.admissno.value.replace(/ /g,"+");
     parent.location.href=linkURL;
   } else { 
     DFrameClose();
   }
 }  
} 
function BookAllTransport() {
  document.AddForm.updttype.value="S";   // Series
  AddTransportRed();
}
//
function AddTransportRed() {
  if(!validateMandatory(AddForm)) {
    return;
  }
  if(document.AddForm.trnsflag.value!="0") {
    AddForm.redirect.value="outweb02.pbl?reportno=03&template=013" +
                 "&admissno=" + AddForm.pmtsp002.value.replace(/ /g,"+") +
                 "&waitflag=" + AddForm.waitflag.value.replace(/ /g,"+");
    AddForm.nextpage.value="1";
    parent.document.getElementById('PopUpScreen').style.width=700;
    parent.document.getElementById('PopUpScreen').style.height=400;
    Left=(parent.document.body.clientWidth-700)/2;
    parent.document.getElementById('PopUpScreen').style.left=Left;
  }
  if(document.AddForm.opupdate.value=="1") {
    document.AddForm.nextpage.value="4";
    AddForm.redirect.value="outweb02.pbl?reportno=3&template=1" +
               "&urnumber=" + AddForm.urnumber.value.replace(/ /g,"+") +
               "&admissno=" + AddForm.admissno.value.replace(/ /g,"+")
  }
  AddTransport();
}
function CheckSeries() {
  if(document.AddForm.trnsflag.value=="2") {
    if(!confirm("Warning - This is a series booking.\n" +
            "Click OK to continue, CANCEL to exit")) {
            LinkDFExit()
   
    } 
    document.AddForm.pmtsp004.className="Readonly";
    document.AddForm.pmtsp004.readOnly=true;
    document.AddForm.pmtsp005.className="Readonly";
    document.AddForm.pmtsp005.readOnly=true;
    InsertBookAll.style.display="";
  } else if(document.AddForm.isseries.value=="2") {
    if(!confirm("Warning - This is a series booking.\n" +
            "Click OK to continue, CANCEL to exit")) {
             LinkDFExit();
    } else {
      InsertBookAll.style.display="";
    } 
  } else if(document.AddForm.isseries.value=="1") {
     if(!confirm("Warning - This is a series booking.\n" +
        "Click OK to continue, CANCEL to exit")) {
        LinkDFExit();
    }
  }
}
function PickSelfOVL() {
  document.AddForm.pmtsp006.value=trim(document.hiddenovl.padd1ovl.value);
  document.AddForm.pmtsp007.value=trim(document.hiddenovl.padd2ovl.value);
  document.AddForm.pmtsp008.value=trim(document.hiddenovl.padd3ovl.value);
  document.AddForm.pmtsp009.value=trim(document.hiddenovl.padd4ovl.value);
  document.AddForm.pmtsp010.value=trim(document.hiddenovl.ppostovl.value);
  document.AddForm.pmtsp011.value=trim(document.hiddenovl.ptelepov.value);
  document.AddForm.pmtsp012.value=trim(document.hiddenovl.ptelebov.value);
  document.AddForm.pmtsp013.value=trim(document.hiddenovl.ptelemov.value);
}
function ReturnSelfOVL() {
  document.AddForm.pmtsp016.value=trim(document.hiddenovl.padd1ovl.value);
  document.AddForm.pmtsp017.value=trim(document.hiddenovl.padd2ovl.value);
  document.AddForm.pmtsp018.value=trim(document.hiddenovl.padd3ovl.value);
  document.AddForm.pmtsp019.value=trim(document.hiddenovl.padd4ovl.value);
  document.AddForm.pmtsp020.value=trim(document.hiddenovl.ppostovl.value);
  document.AddForm.pmtsp021.value=trim(document.hiddenovl.ptelepov.value);
  document.AddForm.pmtsp022.value=trim(document.hiddenovl.ptelebov.value);
  document.AddForm.pmtsp023.value=trim(document.hiddenovl.ptelemov.value);
}
</script>
%START.OF.PAGE
</HEAD>
<body onload="PageLoad(event);CheckAppDate();CheckSeries();showFundingSource();
              InitPostCodes();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="LinkDFExit();">
Add Transport Details - Visit %PATWEB10.04.081 - %PATWEB10.04.212.1
</span>

<div id=PageBodySection style="overflow: auto;">
<form name=AddForm method=post action=patweb10.pbl style="margin:0"
  onsubmit='return validateMandatory(this);'>
<input type=hidden name=reportno value="4">
<input type=hidden name=template value="003">
<input type=hidden name=updttype value="A">
<input type=hidden name=admissno value="%PATWEB10.04.081">
<input type=hidden name=urnumber value="%PATWEB10.04.003">
<input type=hidden name=pmtsp001 value="%PATWEB10.04.003">
<input type=hidden name=pmtsp002 value="%PATWEB10.04.081">
<input type=hidden name=pmtsp026 value="">
<input type=hidden name=pmtsp040 value="">
<input type=hidden name=pmtsp046 value="">
<input type=hidden name=pmtsp048 value="">
<input type=hidden name=trnsflag value="%PATWEB10.04.210">
<input type=hidden name=waitflag value="%PATWEB10.04.211">
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value="0">
<input type=hidden name=isseries value="%PATWEB10.04.212.2">
<input type=hidden name=d_outbb002 value="%PATWEB10.04.321.3">
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden name=opupdate value="%PATWEB10.04.224">
<input type=hidden name=outtrans id=outtrans value="%PATWEB10.04.342.1">
<input type=hidden name=outspecr id=outspecr value="%PATWEB10.04.378.1">
<input type=hidden name=arqtrans id=arqtrans value="%PATWEB10.04.226.1">
<input type=hidden name=arqspecr id=arqspecr value="%PATWEB10.04.227.1">

<table align=center cellspacing=0 cellpadding=1 width=100% border=1>
<tr><td class=HeadingCell align=center>Pick Up Address</td>
    <td class=HeadingCell align=center>Return Address</td></tr>

<tr><td>
    <table border=0 width=100% cellspacing=0>
    <tr><td class=DataLabel>Address</td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp006 tabindex=1
             value="%PATWEB10.04.106" onchange="UpCase(this);"></td>
        <td class=DataLabel>Private Ph</td>
        <td><input type="text" size=15 maxlength=20 name=pmtsp011 tabindex=7
             value="%PATWEB10.04.111"></td></tr>

    <tr><td class=DataLabel></td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp007 tabindex=2
             value="%PATWEB10.04.107" onchange="UpCase(this);"></td>
        <td class=DataLabel>Work Ph</td>
        <td><input type="text" size=15 maxlength=20 name=pmtsp012 tabindex=8
             value="%PATWEB10.04.112"></td></tr>

    <tr><td class=DataLabel>Suburb</td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp008 tabindex=3
             value="%PATWEB10.04.108" onchange="UpCase(this);"
             onblur="SetFields1();"></td>
        <td>Mobile</td>
        <td><input type="text" size=15 maxlength=20 name=pmtsp013 tabindex=9
             value="%PATWEB10.04.113"></td></tr>

    <tr><td class=DataLabel>State</td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp009 tabindex=4
             value="%PATWEB10.04.109">
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        </tr>

    <tr><td>Post Code</td>
        <td><input type="text" size=4 maxlength=8 name=pmtsp010 tabindex=5
             value="%PATWEB10.04.110"></td>
        <td></td></tr>

    <tr><td class=DataLabel>Run Number</td>
        <td><input type=text size=5 name=pmtsp051 maxlength=3
          title="Run Number(Pick Up)"
          tabindex=6 value="%PATWEB10.04.151"></td>
        <td>Carrier</td>
        <td><select name=pmtsp038 tabindex=11 title="Carrier (Pick Up)"
            class=Mandatory>
            <option></option>
            %PATWEB10.04.138.2
            </select></td>

    <tr><td colspan=4 align=right>
        <input type=button class="button" value="Clear" tabindex=12
         onclick="PickClear();">
        <input type=button class="button" value="Default" tabindex=13
         onclick="if (document.hiddenvalues.ppost.value == '8888    ') {
                    PickSelfOVL();
                  } else {
                    PickSelf();
                  }">
    </td></tr>
    </table></td>

    <td>
    <table border=0 width=100% cellspacing=0>
    <tr><td class=DataLabel>Address</td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp016 tabindex=20
             value="%PATWEB10.04.116" onchange="UpCase(this);"></td>
        <td class=DataLabel>Private Ph</td>
        <td><input type="text" size=15 maxlength=20 name=pmtsp021 tabindex=26
             value="%PATWEB10.04.121"></td></tr>

    <tr><td class=DataLabel></td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp017 tabindex=21
             value="%PATWEB10.04.117" onchange="UpCase(this);"></td>
        <td class=DataLabel>Work Ph</td>
        <td><input type="text" size=15 maxlength=20 name=pmtsp022 tabindex=27
             value="%PATWEB10.04.122"></td></tr>

    <tr><td class=DataLabel>Suburb</td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp018 tabindex=22
             value="%PATWEB10.04.118" onchange="UpCase(this);"
             onblur="SetFields2();"></td>
        <td>Mobile</td>
        <td><input type="text" size=15 maxlength=20 name=pmtsp023 tabindex=28
             value="%PATWEB10.04.123"></td></tr>

    <tr><td class=DataLabel>State</td>
        <td><input type="text" size=33 maxlength=35 name=pmtsp019 tabindex=23
             value="%PATWEB10.04.119">
        </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        </tr>

    <tr><td>Post Code</td>
        <td><input type="text" size=4 maxlength=8 name=pmtsp020 tabindex=24
             value="%PATWEB10.04.120"></td>
        <td>Same as Pick Up</td>
        <td><input type=checkbox name=d_pmtsp026 value="1" tabindex=30
             onclick="SamePick();"></td></tr>

    <tr><td class=DataLabel>Run Number</td>
    <td><input type=text size=5 name=pmtsp052 maxlength=3
          title="Run Number (Return)"
          tabindex=25 value="%PATWEB10.04.158"></td>
        <td>Carrier</td>
        <td><select name=pmtsp053 tabindex=31 title="Carrier (Return)"
            class=Mandatory>
            <option></option>
            %PATWEB10.04.159.2
            </select></td>
        </tr>

    <tr><td colspan=4 align=right>
        <input type=button class="button" name=returnbut tabindex=32
         value="Clear" onclick="ReturnClear();">
        <input type=button class="button" name=returndef tabindex=33
         value="Default" 
         onclick="if (document.hiddenvalues.ppost.value == '8888    ') {
                    ReturnSelfOVL();
                  } else {
                    ReturnSelf();
                  }">
    </td></tr>
    </table>
</td></tr>

<tr><td class=HeadingCell align=center colspan=2>Destination Address</td>
    </tr>
</table>

<table align=center cellspacing=0 cellpadding=1 width=100% border=0>
<tr><td class=DataLabel>Clinic</td>
    <td><input type="text" size=33 name=dummy3 tabindex=-1
         class="Readonly" readonly value="%PATWEB10.04.303.1"></td>
    <td class=DataLabel>Mobility</td>
    <td><select name=pmtsp039 tabindex=50 title="Mobility" class="Mandatory">
        <option></option>
        %PATWEB10.04.139.2
        </select></td>
    </tr>

<tr><td class=DataLabel>Clinic Location</td>
    <td><input type="text" size=33 name=dummy4 tabindex=-1
         class="Readonly" readonly value="%PATWEB10.04.223.0"></td>
    <td class=DataLabel>Aids</td>
    <td><select name=pmtsp041 tabindex=51>
        <option></option>
        %PATWEB10.04.141.9.1.10.2.X
        </select></td>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td><input type="text" size=33 name=dummy5 tabindex=-1
         class="Readonly" readonly value="%PATWEB10.04.321.0"></td>
    <td class=DataLabel>Special Arrangements</td>
    <td><select name=pmtsp043 tabindex=52>
        <option></option>
        %PATWEB10.04.143.2
        </select></td>
    </tr>

<tr><td class=DataLabel><div id=FundingHeading></div></td>
    <td><div id=FundingId></div></td>
    <td class=DataLabel>Cognitive State</td>
    <td><select name=pmtsp042 tabindex=53>
        <option></option>
        %PATWEB10.04.142.2
        </select></td>
    </tr>

<tr><td class=DataLabel>Interpreter Required</td>
    <td>%PATWEB10.04.693.2</td>
    <td class=DataLabel>Transport Booked</td>
    <td><input type=checkbox name=d_pmtsp040 tabindex=54></td>
    </tr>

<tr><td>Appointment Date</td>
    <td><input type=text size=12 name=dummy1 readonly tabindex=-1
        class="Readonly Date" title="Appointment Date"
        value="%PATWEB10.04.304">
        Time
        <input type=text class="Readonly" name=dummy2 size=8 readonly
         tabindex=-1 value="%PATWEB10.04.316" title="Appointment Time">
    </td>
    <td class=DataLabel>Transport Date</td>
         <td><input type=text size=12 name=pmtsp004 tabindex=55
             class="Mandatory Date" title="Transport Date"
             value="%PATWEB10.04.304">
         <img notab src=../images/DateLookup.gif class="Icon"
          onclick="DateLookupFrame(AddForm.pmtsp004);">
          Time
      <input class=Mandatory type=text name=pmtsp005 size=8 tabindex=56
          value="%PATWEB10.04.316" title="Transport Time">
       <img notab src=../images/DateTimeStamp.gif class="Icon"
        onclick="SetCurrentDateTime(AddForm.pmtsp004,AddForm.pmtsp005);">
       <img notab src=../images/TimeLookup.gif class="Icon"
        onclick="TimeLookupFrame(AddForm.pmtsp005);">
          </td>
    </tr>

<tr><td class=HeadingCell align=center colspan=6>Comments</td>
    </tr>

<tr><td class=DataLabel align=center colspan=6>
    <textarea name=transcom wrap=hard cols=60 
     rows=4 tabindex=60></textarea>
</td></tr>

<tr><td colspan=6 align=center><br>
    <input type=button value=Add class="button"  tabindex=71
     onclick="AddTransportRed();">

    <span id=InsertBookAll style="display: none">
    <input type=button value="Book All" class="button"  tabindex=72
     onclick="BookAllTransport();">
    </span>

    <input type=button value=Close class="button" tabindex=73 
     onclick="LinkDFExit();">
    </td></tr>
    
</table>
</form>
</div>

<form name=hiddenvalues>
<input type=hidden name=padd1 value="%PATWEB10.04.012">
<input type=hidden name=padd2 value="%PATWEB10.04.013">
<input type=hidden name=padd3 value="%PATWEB10.04.014">
<input type=hidden name=padd4 value="%PATWEB10.04.015">
<input type=hidden name=ppost value="%PATWEB10.04.016">
<input type=hidden name=ptelep value="%PATWEB10.04.017">
<input type=hidden name=pteleb value="%PATWEB10.04.018">
<Input type=hidden name=ptelem value="%PATWEB10.04.085.043">
</form>

<form name=hiddenovl>
<input type=hidden name=padd1ovl value="%PATWEB10.04.707">
<input type=hidden name=padd2ovl value="%PATWEB10.04.708">
<input type=hidden name=padd3ovl value="%PATWEB10.04.709">
<input type=hidden name=padd4ovl value="%PATWEB10.04.710">
<input type=hidden name=ppostovl value="%PATWEB10.04.711">
<input type=hidden name=ptelepov value="%PATWEB10.04.712">
<input type=hidden name=ptelebov value="%PATWEB10.04.713">
<Input type=hidden name=ptelemov value="%PATWEB10.04.714">
</form>

<span id=fundinghd style="display:none">
Funding Source
</span>

<span id=fundingidshown style="display:none">
<input type="text" size=33 name=dummy6 tabindex=-1
 class="Readonly" readonly value="%PATWEB10.04.699.009.0">
</span>

<script type="text/javascript">
 PickUp="%PATWEB10.04.126"
 if(PickUp == "1") {
   document.AddForm.d_pmtsp026.checked=true;
 }
 Booked="%PATWEB10.04.140"
 if(Booked == "1") {
   document.AddForm.d_pmtsp040.checked=true;
 }
 Amb="%PATWEB10.04.146"
 if(Amb == "1") {
   document.AddForm.d_pmtsp046.checked=true;
   document.AddForm.pmtsp047.readonly=false;
   document.AddForm.pmtsp047.className="mandatory";
 }
 M40="%PATWEB10.04.148"
 if(M40 == "1") {
   document.AddForm.d_pmtsp048.checked=true;
   document.AddForm.pmtsp049.readonly=false;
   document.AddForm.pmtsp049.className="mandatory";
 }

 if (!isWhitespace(document.getElementById('outtrans').value)) {
   for (var i=0; i < document.AddForm.pmtsp038.length; i++) {
     if (document.AddForm.pmtsp038.options[i].value.substr(0,3) ==
         document.getElementById('outtrans').value) {
       document.AddForm.pmtsp038.selectedIndex=i
     }
   }
   for (var i=0; i < document.AddForm.pmtsp053.length; i++) {
     if (document.AddForm.pmtsp053.options[i].value.substr(0,3) ==
         document.getElementById('outtrans').value) {
       document.AddForm.pmtsp053.selectedIndex=i
     }
   }
 } else {
   for (var i=0; i < document.AddForm.pmtsp038.length; i++) {
     if (document.AddForm.pmtsp038.options[i].value.substr(0,3) ==
         document.getElementById('arqtrans').value) {
       document.AddForm.pmtsp038.selectedIndex=i
     }
   }
   for (var i=0; i < document.AddForm.pmtsp053.length; i++) {
     if (document.AddForm.pmtsp053.options[i].value.substr(0,3) ==
         document.getElementById('arqtrans').value) {
       document.AddForm.pmtsp053.selectedIndex=i
     }
   }
 }

 if (!isWhitespace(document.getElementById('outspecr').value)) {
   for (var i=0; i < document.AddForm.pmtsp043.length; i++) {
     if (document.AddForm.pmtsp043.options[i].value.substr(0,3) ==
         document.getElementById('outspecr').value) {
       document.AddForm.pmtsp043.selectedIndex=i
     }
   }
 } else {
   for (var i=0; i < document.AddForm.pmtsp043.length; i++) {
     if (document.AddForm.pmtsp043.options[i].value.substr(0,3) ==
         document.getElementById('arqspecr').value) {
       document.AddForm.pmtsp043.selectedIndex=i
     }
   }
 }

</script>
