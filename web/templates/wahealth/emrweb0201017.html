<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<link rel="stylesheet" href="../html/postcode.css" type="text/css">
<script type="text/javascript" src="../js/IBA_Category_C_.js"></script>
<script type="text/javascript" src="../js/IBA_Category_LA.js"></script>
<script type="text/javascript" src="../js/AutoPostCode.js"></script>
<script type="text/javascript" src="../js/EmrRegistration.js"></script>
<script type="text/javascript" src="../js/emrweb0201102.js"></script>
<script type="text/javascript">
function redirectZeroAdm() {
  if (document.UpdateForm.admissno.value=="       0") {
    alert("Emergency Visit not found.");
    location.href="patweb98.pbl?reportno=1&template=052" +
            "&urnumber="+document.UpdateForm.urnumber.value +
            "&admissno="+document.UpdateForm.admissno.value
  }
}
function showFundingSource() {
  i=document.UpdateForm.emvis008.selectedIndex;
  ind=document.UpdateForm.emvis008.options[i].value.substring(3,4)
  if (ind=="A") {
    document.getElementById("FundingHeading").innerHTML=
    document.getElementById("offdutyhd").innerHTML;
    document.getElementById("FundingId").innerHTML=
    document.getElementById("offdutyid").innerHTML;
  } else {
    if (ind=="P") {
      document.getElementById("FundingHeading").innerHTML=
      document.getElementById("fundinghd").innerHTML;
      document.getElementById("FundingId").innerHTML=
      document.getElementById("fundingidshow").innerHTML;
      document.UpdateForm.pmsvx141.className="Mandatory";
    } else {
      document.getElementById("FundingHeading").innerHTML="";
      document.getElementById("FundingId").innerHTML="";
    }
  }
}
function defaultDisasterCode() {

  if (document.UpdateForm.urnumber.value=="       0") {
     document.UpdateForm.dispt001.disabled=true;
     return;
  }

  if (!isWhitespace(document.UpdateForm.disacode.value)) {
  for (var i =0 ; i < document.UpdateForm.dispt001.length; i++) {
     if (document.UpdateForm.dispt001.options[i].value==
         document.UpdateForm.disacode.value) {
         document.UpdateForm.dispt001.selectedIndex=i
     }
    }
  }

  displayDisasterID();

  if (!isWhitespace(document.UpdateForm.dispt001.value)) {
    document.UpdateForm.dispt001.className = "Readonly";
    document.UpdateForm.dispt001.onfocus =
    function () {this.defaultIndex=this.selectedIndex};
    document.UpdateForm.dispt001.onchange =
    function () {this.selectedIndex=this.defaultIndex};
  }

}
function displayDisasterID() {
 p=document.UpdateForm
  if (!isWhitespace(document.UpdateForm.dispt001.value)) {
    document.getElementById("disasteridnumbertitleDIV").innerHTML=
    document.getElementById("disasteridnumbertitleSPAN").innerHTML;
    document.getElementById("disasteridnumberDIV").innerHTML=
    document.getElementById("disasteridnumberSPAN").innerHTML;
  } else {
    document.getElementById("disasteridnumbertitleDIV").innerHTML="";
    document.getElementById("disasteridnumberDIV").innerHTML="";
  }

  if (!isWhitespace(document.getElementById("disasteridnumberDIV").innerHTML)) {
    var serverURL   = "../cgi-bin/patweb80.pbl?reportno=98" +
                    "&valdcode=" + UpdateForm.urnumber.value.replace(/ /g,"+") +
                    UpdateForm.dispt001.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|");
      if (!isWhitespace(ReturnValue[0])) {
        p.dispt002.value=ReturnValue;
        p.dispt002.className="Readonly";
        p.dispt002.readOnly=true;
      }
    }
  }
}
function UpdatePage() {
  setRedirectAdm();
  document.UpdateForm.UpdateButton.disabled=true;
  document.UpdateForm.formactn.value="C1"
  document.UpdateForm.updttype.value="UPDAT"
  document.UpdateForm.target="PopUpFrame";

// this checks to see if it is being used outside the MAPVIEW
  if (isWhitespace(top.menu.location.search)) {
    document.UpdateForm.nextpage.value=9;
  }

    setTimeout('document.UpdateForm.UpdateButton.disabled=false',1000);
  if (validateMandatory(document.UpdateForm)) { 
    document.UpdateForm.submit();
  }
}
// Do VEMD Error 132 check
//   If Referred by is a 5 - Emergency department review from this hospital
//   then Type of visit must be either 2 - return visit-planned
//                                  or 4 - outpatient/outpatient clinic
//   AND vis versa
// Do VEMD E142
//   Display warning if Type of visit is 10 - Dead on Arrival
//
function valEmrVisit() {
  if(document.UpdateForm.offdutyb!=undefined){
    if(document.UpdateForm.offdutyb.checked==true){
      alert("Error: Claim Type invalid for 'Off Duty' personnel.")
      return;
    }
  }
 

  if (!isWhitespace(document.UpdateForm.dispt001.value)) {
    var serverURL   = "../cgi-bin/comweb80.pbl?reportno=44" +
                    "&valdcode=" + UpdateForm.dispt001.value.replace(/ /g,"+") +
                    UpdateForm.emvis001.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {
      return;
    }
  }

  validateSuspension(UpdateForm.urnumber,UpdateForm.emvis001,UpdateForm.datefrom,UpdateForm.dateto);

  if( UpdateForm.datefrom.value != "0" ){
         if(!confirm("Error : Patient has a Suspension record for period \n" +
               "\t" + UpdateForm.datefrom.value  + " - " + UpdateForm.dateto.value + "\n" +
               "\nWould you like to continue with the Registration?")) {
          return;
        }
  }

  i=document.UpdateForm.emvis061.selectedIndex;
  SrcInd=trim(document.UpdateForm.emvis061.options[i].value.substr(14,4));
  UpdatePage();
}
function showFundingSource() {
  ind=document.UpdateForm.d_emvis008.value.substring(3,4);
  if (ind=="P") {
    document.getElementById("FundingHeading").innerHTML=
    document.getElementById("fundinghd").innerHTML;
    document.getElementById("FundingId").innerHTML=
    document.getElementById("fundingidshow").innerHTML;
  }
}
function displayPrev(){
  p=document.UpdateForm
  if(!isWhitespace(p.dispprev.value)&&p.dispprev.value!="0   "){
    document.getElementById('prevhospxx').style.display="";
  } else {
    document.getElementById('prevhospxx').style.display="none";
  }
}
function assignICD10DIV() {
  if (!isWhitespace(document.getElementById('5_emvcd005').value)) {
    document.getElementById("ICD10DescTD").innerHTML = 
    document.getElementById("icd10_5_SPAN").innerHTML;
    return;
  }
  if (!isWhitespace(document.getElementById('1_emvcd005').value)) {
    document.getElementById("ICD10DescTD").innerHTML = 
    document.getElementById("icd10_1_SPAN").innerHTML;
    return;
  }
}
</script>
%START.OF.PAGE
<body onload="PageLoad(event);showFundingSource();displayPrev();
              assignICD10DIV();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%EMRWEB02.01.003";
PatientVIS="%EMRWEB02.01.081";
PatientNAM="%EMRWEB02.01.002";
PatientSTA="%EMRWEB02.01.086.078";
PatientALT="%EMRWEB02.01.084";
PatientSEX="%EMRWEB02.01.019";
PatientDOB="%EMRWEB02.01.020";
PatientAGE="%EMRWEB02.01.021";
PatientLOC="%EMRWEB02.01.083";
PatientPRI="%EMRWEB02.01.086.066.1";
PatientUNT="%EMRWEB02.01.066.0";
PatientIND="%EMRWEB02.01.086.091";
GpCOD="%EMRWEB02.01.086.084.001";
GpNAM="%EMRWEB02.01.086.084.081";
GpPRAC="%EMRWEB02.01.086.085.001";
GpPRACCNT="%EMRWEB02.01.086.085.002";
GpPRACNAM="%EMRWEB02.01.086.085.005";
PatientARR="%EMRWEB02.01.101.0 %EMRWEB02.01.102";
PatientSEE="%EMRWEB02.01.130.0 %EMRWEB02.01.131";
PatientTRI="%EMRWEB02.01.103.3";
PatientECLC="%EMRWEB02.01.484.1";
PatientCLH="%STANDARD.01.017.CL";
PatientEHFT="%EMRWEB02.01.485";
InsertEmergencyHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form name=UpdateForm action="emrweb02.pbl" method=post>
  <input type=hidden name=reportno value="01">
  <input type=hidden name=updatety value="4">
  <input type=hidden name=formactn value="C1">
  <input type=hidden name=updttype value="TRIAG">
  <input type=hidden name=updateky value="%EMRWEB02.01.404">
  <input type=hidden name=admissno value="%EMRWEB02.01.146">
  <input type=hidden name=urnumber value="%EMRWEB02.01.003">
  <input type=hidden name=emvis118 value="%EMRWEB02.01.003">
  <input type=hidden name=emvis147>
  <input type=hidden name=dummyadm><input type=hidden name=fpatname>
  <input type=hidden name=chckname><input type=hidden name=redirflg value="1">
  <input type=hidden name=mvmedrec>
  <input type=hidden name=datefrom>
  <input type=hidden name=dateto>
  <input type=hidden name=dontchec value=1>
  <input type=hidden name=nextpage value="11"><input type=hidden name=redirect>
  <input type=hidden name=ptcnueoc value="%EMRWEB02.01.454">
  <input type=hidden name=ptcnxcom value="%STANDARD.01.025.116.222.0.1">
  <input type="hidden" name="savealia" value="0">
  <input type="hidden" name="aliasset" value="0">
  <input type="hidden" name="prevaddr" value="0">
  <input type="hidden" name="preaddset" value="0">
  <input type="hidden" name="claimc">
  <input type="hidden" name=deftclam value="%EMRWEB02.01.108.1">
  <input type=hidden name=ptcnhdps value="%STANDARD.01.025.080.250.1.1">
  <input type="hidden" name="ptcnusgn"  value="%STANDARD.01.025.114.219.0.1">
  <input type="hidden" name="disacode" value="%EMRWEB02.01.498">
  <input type="hidden" name="ptype" value="%EMRWEB02.01.024.3">
  <input type="hidden" name="precinwa" value="1">
  <input type="hidden" name="setemrcm" value="1">
  <input type="hidden" name="d_emvis061" value="%EMRWEB02.01.221.3">
  <input type="hidden" name="d_emvis008" value="%EMRWEB02.01.274.3">
  <input type="hidden" name=dispprev value="%EMRWEB02.01.535">

<table align=center width=100% border=0 cellspacing=0 cellpadding=0>
  <tr>
    <td class=HeadingCell colspan=6 align=center>
      Emergency Visit Details 
    </td>
  </tr>

</table>

<table align=center width=90% border=0 cellspacing=0 cellpadding=0>

  <tr>
    <td class=DataLabel width="25%">
     %STANDARD.01.017.CL 
    </td>
    <td class=DataField width="20%">
      %EMRWEB02.01.108.0
    </td> 
    <td class=DataLabel>
      Arrival Date
    </td>
    <td class=DataField>
      %EMRWEB02.01.101.0
    </td>
    <td class=DataLabel>
      Senior Doctor
    </td>
    <td class=DataField>
      %EMRWEB02.01.269.002
    </td>
  </tr>

  <tr>
    <td class=DataLabel>Has this patient been in a Motor Vehicle Accident?</td>
    <td class=DataField>%EMRWEB02.01.936.099.051</td>
    <td class=DataLabel><div id=FundingHeading></div>
    </td>
    <td class=DataField><div id=FundingId></div>
    </td>
    <td class=DataLabel>

    </td>
    <td>
    </td>
  </tr>

  <tr>
    <td class=DataLabel>
      Arrival Transport
    </td>
    <td class=DataField>
      %EMRWEB02.01.113.0
    </td>
    <td class=DataLabel>
      Triage Category
    </td>
    <td class=DataField>
        %EMRWEB02.01.103.1
    </td>
    <td class=DataLabel>
      Treating Doctor
    </td>
    <td class=DataField>
        %EMRWEB02.01.107.003
    </td>
  </tr>

  <tr>
    <td class=DataLabel>
      Non WA Hosp Contact
    </td>
    <td class=DataField>
      %EMRWEB02.01.513.0
    </td>
    <td class=DataLabel>
      Presenting Complaint
    </td>
    <td class=DataField>
        %EMRWEB02.01.104
    </td>
    <td class=DataLabel>
      Treating Nurse
    </td>
    <td class=DataField>
        %EMRWEB02.01.164.0
    </td>
  </tr>

  <tr>
    <td class=DataLabel>
      Hospital Last 7 Days
    </td>
    <td class=DataField>
      <span id="prevhospxx" style="display:none">
      <b>Yes</b> 
      </span>
    </td>
    <td class=DataLabel>
      Location
    </td>
    <td class=DataField>
      %EMRWEB02.01.106.0
    </td>
  </tr>

  <tr>
    <td class=DataLabel>
      %STANDARD.01.017.KD
    </td>
    <td class=DataField>
      %EMRWEB02.01.536.0
    </td>
    <td class=DataLabel>
      Disaster Code
    </td>
    <td class=DataField>
      %EMRWEB02.01.499
    </td>
  </tr>


  <tr>
    <td class=DataLabel>
      Source of Referral
    </td>
    <td class=DataField>
      %EMRWEB02.01.221.0
    </td>
    <td class=DataLabel>
      Disaster Identification #
    </td>
    <td class=DataField>
        <script type="text/javascript">

    var serverURL   = "../cgi-bin/patweb80.pbl?reportno=98" +
                    "&valdcode=" + UpdateForm.urnumber.value.replace(/ /g,"+") +
                    UpdateForm.disacode.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|");
      if (!isWhitespace(ReturnValue[0])) {
        document.writeln(ReturnValue[0]);
      } else {
        document.writeln("&nbsp;");
      }
    }

        </script>
    </td>
  </tr>

  <tr><td class=DataLabel>Consent upload to My Health Record?</td>
      <td class=DataField>
        <script type="text/javascript">
            patientConsentMyHR = trim("%EMRWEB02.01.043.0");
            visitConsentMyHR   = trim("%EMRWEB02.01.290.0");
            visitConsent = visitConsentMyHR || patientConsentMyHR || "Yes (implied)";
            document.writeln(visitConsent);
        </script>
      </td>
      <td class=DataLabel></td>
      <td class=DataField></td>
  </tr>

  <tr>
    <td class=DataLabel width=25%>
      Comments
    </td>
  </tr>
  <tr>
    <td colspan=2 class=DataField>
        %EMRWEB02.01.434.002
    </td>
  </tr>

  <tr>
    <td class=DataLabel id="tranhead">
      Transfer Source
    </td>
    <td class=DataField id="transrce">
      %EMRWEB02.01.132.0
    </td>
  </tr>

</table>

<table align=center width=100% border=0 cellspacing=0 cellpadding=0>
  <tr>
    <td class=HeadingCell colspan=6 align=center>
      Emergency Discharge Details
    </td>
  </tr>
</table>

<table align=center width=90% border=0 cellspacing=0 cellpadding=0>

  <tr>
    <td class=DataLabel width="25%">
      Discharge Date
    </td>
    <td class=DataField width="20%">
      %EMRWEB02.01.124.0
    </td>
    <td class=DataLabel width=15%>
      ED Ready to Discharge
    </td>
    <td class=DataField>
      %EMRWEB02.01.231.0 &nbsp; %EMRWEB02.01.241
    </td>
  </tr>

  <tr>
    <td class=DataLabel>
      Emergency Discharge Status
    </td>
    <td class=DataField>
      %EMRWEB02.01.126.0
    </td>
    <td class=DataLabel>
      Referred to on Departure
    </td>
    <td class=DataField>
      %EMRWEB02.01.211.0
    </td>
  </tr>

  <tr>
    <td class=DataLabel>
      Transfer Destination
    </td>
    <td class=DataField>
      %EMRWEB02.01.133.0
    </td>
    <td class=DataLabel>
      Departure Means
    </td>
    <td class=DataField>
      %EMRWEB02.01.579.0
    </td>
  </tr>

  <tr>
    <td class=DataLabel>
      Relative Contacted
    </td>
    <td class=DataField>
      %EMRWEB02.01.854
    </td>
    <td class=DataLabel>
      %STANDARD.01.017.EW
    </td>
    <td class=DataField>
      %EMRWEB02.01.115.0
    </td>
    <td class=DataLabel>
      &nbsp;
    </td>
    <td class=DataField>
      &nbsp;
    </td>
  </tr>

  <tr>
    <td class=DataLabel>
      Discharge Diagnosis
    </td>
    <td class=DataField>
      %EMRWEB02.01.137
    </td>
  </tr>

  <tr>
    <td class=DataLabel>
      ICD10
    </td>
    <td class=DataField id=ICD10DescTD>
    <input type=hidden name=icdcode value="%EMRWEB02.01.515">
    <input type=hidden name=icddesc value="">
    </td>
    <script type="text/javascript">
      validateCode(6,UpdateForm.icdcode,UpdateForm.icddesc)
      document.getElementById("ICD10DescTD").innerHTML=UpdateForm.icddesc.value;
//      document.writeln(UpdateForm.icddesc.value);
    </script>
    <td class=DataLabel>
      Discharge Comments
    </td>
    <td colspan=3 class=DataField>
        %EMRWEB02.01.434.019
    </td>
  </tr>

<tr><td class=DataLabel>%STANDARD.01.035.EB</td>
    <td class=DataField>%EMRWEB02.01.528.04.EB.8</td>
	<td class=DataLabel></td>
	<td class=DataField></td>
	</tr>
	
<tr><td class=DataLabel>%STANDARD.01.035.EB</td>
    <td class=DataField>%EMRWEB02.01.528.05.EB.8</td>
	<td class=DataLabel></td>
	<td class=DataField></td>
	</tr>
	
<tr><td class=DataLabel>%STANDARD.01.035.EB</td>
    <td class=DataField>%EMRWEB02.01.528.06.EB.8</td>
	<td class=DataLabel></td>
	<td class=DataField></td>
	</tr>
	
</table>
</form>
</div>

<script type="text/javascript">
  if(document.UpdateForm.d_emvis061.value.substr(5,1) != "1") {
    document.getElementById("tranhead").style.visibility="hidden";
    document.getElementById("transrce").style.visibility="hidden";
  }
</script>

<form name=HiddenFields method=get>
<input type=hidden name=cob value="%EMRWEB02.01.022.1">
<input type=hidden name=pl1 value="%EMRWEB02.01.602.1">
<input type=hidden name=pl2 value="%EMRWEB02.01.603.1">
</form>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=MenuType value="%EMRWEB02.01.088">
<input type=hidden name=emrgflag value="Y">
<input type=hidden name=nextpage value="4">
<input type=hidden name=webuseid value="%STANDARD.01.008">
</form>

<span id=fundinghd style="display:none">
Funding Source
</span>

<span id=fundingidshow style="display:none">
%EMRWEB02.01.514.0
</span>

 <span id=icd10_5_SPAN style="display:none;">
 <input type=hidden name=5_emvcd005 id=5_emvcd005 value="%EMRWEB02.01.913. 5.1">
 %EMRWEB02.01.913. 5.2
 </span>

 <span id=icd10_1_SPAN style="display:none;">
 <input type=hidden name=1_emvcd005 id=1_emvcd005 value="%EMRWEB02.01.913. 1.1">
 %EMRWEB02.01.913. 1.2
 </span>
 
