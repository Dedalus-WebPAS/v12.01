<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="wahealth">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/OutExtraTemplates.js"></script>
<script type="text/javascript" src="../js/outweb0203021.js"></script>
<script type="text/javascript" src="../js/outweb02.js"></script>
<script type="text/javascript">
function CheckBatch() {
  if (document.UpdateForm.clinindc.value=="P" &&
      document.UpdateForm.ibcnumci.value=="1" &&
      document.UpdateForm.otmaumci.value=="1") {
    // if batched then Actual doctor seen is readonly
      if (document.UpdateForm.btchflag.value == "1") {
        document.UpdateForm.outbb031.readOnly=true;
        document.UpdateForm.outbb031.className="Readonly";
      }
  }
}
function CheckFundingSource() {
  if(UpdateForm.offdutyb!=undefined){
    if(UpdateForm.offdutyb.checked==true){
      alert("Error: Claim Type invalid for 'Off Duty' personnel.")
      return;
    }
  }
  var validDate = valReferralClaim();
  if (validDate) {
    UpdateRecords();
  }
}
function CpmiClinicListRedirect() {
  if(parent.document.getElementById("checkinpage")) {
    if(parent.document.getElementById("checkinpage").value=="1") {
      ClinicList=GetContentCookie("OutpatientClinicList");
      if (ClinicList!="unknown") {
          document.UpdateForm.redirect.value=ClinicList;
          document.UpdateForm.nextpage.value="6";
          return;
      }
      OutpatientList=GetContentCookie("OutpatientList");
      if (OutpatientList!="unknown") {
          document.UpdateForm.redirect.value=OutpatientList;
          document.UpdateForm.nextpage.value="6";
          return;
      } 
    }
  }
}
function CancelButton() {
  if(parent.document.getElementById("checkinpage")) {
    if(parent.document.getElementById("checkinpage").value=="1") {
      ClinicList=GetContentCookie("OutpatientClinicList");
      if (ClinicList!="unknown") {
         if(confirm("Are you sure you want to Close?")) {
           ExpireCookiePath("OutpatientClinicList");
           getTop().content.location.href=ClinicList;
         }
         return;
      }
      OutpatientList=GetContentCookie("OutpatientList");
      if (OutpatientList!="unknown") {
         if(confirm("Are you sure you want to Close?")) {
           getTop().content.location.href=OutpatientList;
         }
         return;
      }
    }
  }
  DFrameCloseRefresh();
}
function valReferralClaim() {
  var currentDate = UpdateForm.CurrDate.value
  var bookedDate = UpdateForm.startdate.value;
  if (SetDateYYYYMMDD(currentDate) >= SetDateYYYYMMDD(bookedDate)) {
    var claimCodeVal = UpdateForm.outbb002.value.substr(0,3);
    var serverURL = "../cgi-bin/outweb02.pbl?reportno=9&updatety=19" +
                    "&admissno="+PatientLinks.admissno.value.replace(/ /g,"+") +
                    "&outbb002="+claimCodeVal +
                    "&urnumber="+PatientLinks.urnumber.value.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|");
      if (ReturnValue[0] === '1') {
        var categoryName = ReturnValue[3].trim();
        var ans=confirm("The Outpatient Appointment " + categoryName +
        " does not match the Referral " + categoryName + ".\n\n" +
        "Outpatient Appointment " + categoryName + " = " + ReturnValue[2] +
        "\n" +
        "Referral " + categoryName + " = " + ReturnValue[1] + "\n\n" +
        "Press OK to update the Referral " + categoryName + " code.\n" +
        "Press Cancel to leave the Referral " +categoryName+ " code unchanged.");
        if (ans) {

          var fundingSourceVal = " ";
          if (UpdateForm.pmsvx141 !== undefined) {
            fundingSourceVal = UpdateForm.pmsvx141.value.substr(0,3);
          }
          var serverURL = "../cgi-bin/outweb02.pbl?reportno=9&updatety=20" +
                          "&admissno="+PatientLinks.admissno.value.replace(/ /g,"+") +
                          "&outbb002="+claimCodeVal+"&pmsvx141="+fundingSourceVal +
                          "&urnumber="+PatientLinks.urnumber.value.replace(/ /g,"+");
          var returnValue = RSExecute(serverURL);
        }
      }
    }
    return 1;
  } else {
    alert("Booking can't be attended in future.");
    return 0;
  }
}
</script>

</head>
%START.OF.PAGE
<body onload="PageLoad(event);CheckBatch();setTimeout('SetDefaultField()',100);
 showFundingSource(UpdateForm);CpmiClinicListRedirect();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Check In Details - %OUTWEB02.03.303.1 - %OUTWEB02.03.605.0
- %OUTWEB02.03.618.1 - %OUTWEB02.03.002
</span>
<div id=PageBodySection style="overflow: auto;">
<form action=outweb02.pbl name=UpdateForm method=post 
 onsubmit="return validateMandatory(this);">
<input type=hidden name=reportno value="4">
<input type=hidden name=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=admissno value="%OUTWEB02.03.081">
<input type=hidden name=redirect value="%OUTWEB02.03.001.outweb02.03.003">
<input type=hidden name=updatety value="1">
<input type=hidden name=casekeys value="%OUTWEB02.03.366">
<input type=hidden name=nextpage value="0">
<input type=hidden name=otcnocrd value="%OUTWEB02.03.612">
<input type=hidden name=otcnocdd value="%OUTWEB02.03.613">
<input type=hidden name=deptflag value="%OUTWEB02.03.617">
<input type=hidden name=clinctyp value="%OUTWEB02.03.605.1">
<input type=hidden name=CurrTime value="1">
<input type=hidden name=CurrDate value="1">
<input type=hidden name=startdate value="%OUTWEB02.03.304">
<input type=hidden name=dumdate value="">
<input type=hidden name=dumInput value="">
<input type=hidden name=clinindc value="%OUTWEB02.03.628">
<input type=hidden name=clinprac value="%OUTWEB02.03.637">
<input type=hidden name=dateclin value="%OUTWEB02.03.304">
<input type=hidden name=ibcnumci value="%STANDARD.01.025.000.132.0.1">
<input type=hidden name=otmaumci value="%OUTWEB02.03.634">
<input type=hidden name=btchflag value="%OUTWEB02.03.638">
<input type=hidden name=othekdoc value="%OUTWEB02.03.640.031">
<input type=hidden name=c_othedefd value="%OUTWEB02.03.640.032.1">
<input type=hidden name=n_othedefd value="%OUTWEB02.03.640.032.0">
<input type=hidden name=s_othedefd value="%OUTWEB02.03.640.032.2">
<input type=hidden name=ptcnxcom value="%STANDARD.01.025.116.222.0.1">
<input type=hidden name=ptcnhdps value="%STANDARD.01.025.080.250.1.1">

<table cellspacing=0 cellpadding=1 border=0 width=95% align=center >
<tr><td width=15% class=DataLabel>Date </td>
    <td class=DataLabel>
    <input type=text size=11 value="%OUTWEB02.03.304" readonly class=Readonly>
    <td class=DataLabel>Check in Time</td>
    <td class=DataField>
    <input type=text name=outbb032 value="%OUTWEB02.03.351" size=8
     title="Check In Time" onblur="ChkChkIn();">
    <img src=../images/DateTimeStamp.gif class="Icon"
    onclick="SetCurrentDateTimeMin(null,UpdateForm.outbb032);">
    <img src=../images/TimeLookup.gif class="Icon"
    onclick="TimeLookupFrameMin(UpdateForm.outbb032);">
</td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField>
    <table cellspacing=0 cellpadding=0>
        <tr><td>
        <select name=outbb002 class="Mandatory SelectBig"
        title="%STANDARD.01.017.CL" onchange="showFundingSource(UpdateForm);">
        <option></option>
        %OUTWEB02.03.321.9.1.10.2.X
        </select>
        </td>
        <td><div id=FundingHeading></div></td>
        <td><div id=FundingId></div></td>
    </table>
    </td>
    <td class=DataLabel>Unit</td>
    <td class=DataField>
    <select name=outbb022 class=SelectBig title="Unit">
    <option></option>
       %OUTWEB02.03.341.2
 </select></td></tr>

<tr><td class=DataLabel>Has this patient been in a Motor Vehicle Accident?</td>
    <td><select class="Mandatory" name=opwamvny tabindex=1
                title="Has this patient been in a Motor Vehicle Accidenti?">
         %OUTWEB02.03.699.012.099.050
        </select>
    </td>
</tr>

<tr valign=top>
    <td class=DataLabel>Presenting Complaint</td>
    <td class=DataField colspan=3>
    <input type=text name=pmsvx052 size=50 maxlength=50                        
      value="%OUTWEB02.03.852">
</td></tr>

<tr valign=top>
    <td class=DataLabel>Diagnosis</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb045 value="%OUTWEB02.03.364"
     onblur="validateCode(6,UpdateForm.outbb045,UpdateForm.outbb046);">
    <input type=text name=outbb046 size=80 class=Readonly readonly maxlength=50
     value="%OUTWEB02.03.365">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb045,UpdateForm.outbb046);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb045,UpdateForm.outbb046);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb055 value="%OUTWEB02.03.379"
     onblur="validateCode(6,UpdateForm.outbb055,UpdateForm.outbb056);">
    <input type=text name=outbb056 size=80 class=Readonly readonly maxlength=50 
                                     value="%OUTWEB02.03.380">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb055,UpdateForm.outbb056);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb055,UpdateForm.outbb056);">
    </td></tr>

<tr><td>&nbsp;</td>
   <td class=DataField colspan=3>
   <input type=text size=15 name=outbb057 value="%OUTWEB02.03.381"
    onblur="validateCode(6,UpdateForm.outbb057,UpdateForm.outbb058);">
   <input type=text size=80 maxlength=50 name=outbb058 
                             class=Readonly readonly value="%OUTWEB02.03.382">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb057,UpdateForm.outbb058);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb057,UpdateForm.outbb058);">
    </td></tr>
<tr><td>&nbsp;</td><td class=DataField colspan=3>
    <input type=text size=15 name=outbb059 value="%OUTWEB02.03.383"
     onblur="validateCode(6,UpdateForm.outbb059,UpdateForm.outbb060);">
    <input type=text size=80 maxlength=50 name=outbb060  
                          class=Readonly readonly value="%OUTWEB02.03.384">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(UpdateForm.outbb059,UpdateForm.outbb060);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(UpdateForm.outbb059,UpdateForm.outbb060);">
    </td></tr>

      <tr>
        <td>
          <table border=0 width=100% class=TableBody cellpadding=0
                 cellspacing=0>
            <tr><td class=DataLabel>Appointment Comments</td></tr>
            <tr><td colspan=6 align=left>
                <input type=button value="Add" class="button"
                 name="AddComm" id="AddComm"
                 onclick="tempDisable(this);AddComment();"></td></tr>
            <tr><td>&nbsp;</td></tr>
            <tr><td>&nbsp;</td></tr>
          </table>
        </td>
        <td colspan=6 align=left>
          <textarea wrap=hard name=outptcoa class=Readonly readonly
           rows=4 cols=70>%OUTWEB02.03.327.016.005</textarea>
        </td>
      </tr>

<tr valign=top>
    <td class=DataLabel>Patient Instructions (Printable)</td>
    <td colspan=3><textarea wrap=hard name=patinstr
    onkeydown="LimitText(this,99,200);"
    rows=4 cols=60 >%OUTWEB02.03.680</textarea></td></tr>


<tr><td colspan=4 align=center>
    <input type=button class="button" value="Ok" id="out02sub"
     onclick="tempDisable(this);CheckFundingSource();">
    <input type=button class="button" Value="Cancel"
     onclick="CancelButton();">
    </td></tr>
</table>
</form>
</div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OUTWEB02.03.003">
<input type=hidden name=admissno value="%OUTWEB02.03.081">
<input type=hidden name=MenuType value="%OUTWEB02.03.088">
<input type=hidden name=casekeys value="%OUTWEB02.03.366">
</form>

<span id=offdutyhd style="display:none">
&nbsp;Off Duty&nbsp;
</span>

<span id=offdutyid style="display:none">
<input type="checkbox" name="offdutyb" value="0">
</span>

<span id=blanklabel style="display:none">
<input type=hidden name=pmsvx141 value=" ">
</span>

<span id=fundinghd style="display:none">
&nbsp;Funding Source&nbsp;
</span>

<span id=fundingid style="display:none">
<select name=pmsvx141 title="%STANDARD.01.017.cx">
<option> </option>
%OUTWEB02.03.899.009.5
</select>
</span>
<script>
  filterCatCodeList(document.UpdateForm.outbb002,"1","M","1");
</script>
