<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="wahealth">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<link rel="stylesheet" href="../html/postcode.css" type="text/css">
<script type="text/javascript" src="../js/emrweb0201100.js"></script>
<style type="text/css">
  table {
    padding: 0.25em;
  }
  td:first-child {
    padding-top: 3px;
  }
  td {
    padding: 3px 3px;
  }
  textarea {
    font-family: 'Trebuchet MS', Helvetica, sans-serif;
    resize: none;
  }
  input.Bigbutton {
      font-size:8pt;
      cursor: pointer;
      width:95px;
  }
  #txtarea1 {
    margin-top: 3px;
  }
  .FDVLabel {
    padding-left: 20em;
  }
  #pmsvx122 {
    margin-left: 2em;
  }
</style>
<script type="text/javascript">
function checkDateFunction(fieldvar,stringtitle) {
  if(isWhitespace(fieldvar.value)) {
    return;
  } else {
    checkDate(fieldvar,stringtitle);
  }
}
function PrintEMGRegForm() {
  PatientLinks.reportno.value="01";
  PatientLinks.template.value="007";
  PatientLinks.action="emrweb02.pbl";
  Left=(document.body.clientWidth-300)/2;
  DFrameSubmit(PatientLinks,82,Left,350,180);
}

//Dischage text functions
 function initA() {
  var p = document.UpdateForm;

  if (p.hasdraft.value == "1") {       // Draft Discharge Text exists
    document.getElementById('divText').innerHTML =
      document.getElementById('txtDraft').innerHTML;
    document.getElementById('divDschTextStat').innerHTML = "<b>Draft</b>";
  }
  else if (p.hasfinal.value == "1") {  // Final Discharge Text exists
    document.getElementById('divText').innerHTML =
      document.getElementById('txtFinal').innerHTML;
    document.getElementById('divDschTextStat').innerHTML = "<b>Final</b>";
  }
  else {
    document.getElementById('divText').innerHTML=
      document.getElementById('txtBlank').innerHTML;
  }
}

function EditDischText() {
  var p = document.UpdateForm;

  if (p.hasdraft.value == "1") {  // Draft Discharge Text exists
    document.PatientLinks.notetype.value="014";
    document.PatientLinks.notenumb.value="     1";
  } 

  document.PatientLinks.reportno.value="06"
  document.PatientLinks.template.value="006"
  document.PatientLinks.action="cliweb06.pbl"

  Width = 900;
  Height = 300;
  Left = (document.body.clientWidth-Width)/2;
  Top = (document.body.clientHeight-Height)/2;

  DFrameSubmit(document.PatientLinks,Top,Left,Width,Height);
}
function PrintDischText() {
  PatientLinks.reportno.value="01";
  PatientLinks.template.value="014";
  PatientLinks.action="emrweb02.pbl";
  Left=(document.body.clientWidth-300)/2;
  DFrameSubmit(PatientLinks,82,Left,350,180);
} 

function formatNotes() {
if(!IEBrowser) {
  el = document.getElementById("discnote");
  el.value = el.value.replace(/(\x0A[0-9][0-9] (jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec))/ig,
                              '\x0D_______________________________________________\x0D$&');
  el = document.getElementById("dismnote");
  el.value = el.value.replace(/(\x0A[0-9][0-9] (jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec))/ig,
                              '\x0D_______________________________________________\x0D$&');
  el = document.getElementById("medichis");
  el.value = el.value.replace(/(\x0A[0-9][0-9] (jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec))/ig,
                              '\x0D_______________________________________________\x0D$&');
 } else {
  el = document.getElementById("discnote");
  el.value = el.value.replace(/(\x0D\x0A[0-9][0-9] (jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec))/ig,
                              '\x0D_______________________________________________$&');
  el = document.getElementById("dismnote");
  el.value = el.value.replace(/(\x0D\x0A[0-9][0-9] (jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec))/ig,
                              '\x0D_______________________________________________$&');
  el = document.getElementById("medichis");
  el.value = el.value.replace(/(\x0D\x0A[0-9][0-9] (jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec))/ig,
                              '\x0D_______________________________________________$&');
 }
}
function EditClinNote() {
  document.PatientLinks.reportno.value="06"
  document.PatientLinks.template.value="010"
  document.PatientLinks.action="cliweb06.pbl" 
  Left=(document.body.clientWidth-900)/2
  DFrameSubmit(document.PatientLinks,0,Left,900,300);
}
function EditMgtNote() {
  document.PatientLinks.reportno.value="06"
  document.PatientLinks.template.value="001"
  document.PatientLinks.action="cliweb06.pbl" 
  Left=(document.body.clientWidth-900)/2
  DFrameSubmit(document.PatientLinks,0,Left,900,300);
}
function EditHistNote() {
  document.PatientLinks.reportno.value="03"
  document.PatientLinks.template.value="001"
  document.PatientLinks.action="cliweb06.pbl" 
  Left=(document.body.clientWidth-900)/2
  DFrameSubmit(document.PatientLinks,0,Left,900,300);
}
function AddClinNote(template) {
  switch (template) {
    case 'MEDICAL': vsctm001="MED                        0          A    "; break;
    case 'NURSING': vsctm001="NUR                        0          A    "; break;
    case 'OTHER':   vsctm001="OTH                        0          A    "; break;
    default:        vsctm001="";
  }
  document.PatientLinks.reportno.value="06"
  document.PatientLinks.template.value="011"
  document.PatientLinks.action="cliweb06.pbl"
  document.PatientLinks.vsctm001.value = vsctm001
  Left=(document.body.clientWidth-900)/2
  DFrameSubmit(document.PatientLinks,0,Left,900,300);
}
function GetChar(event){
      var x = event.keyCode;
      alert ("The Unicode key code is: " + x);
}

function flagFDV(){
  fdv = document.getElementById('pmsvx122').value;

  if (fdv[5]=='F') {
    document.getElementById('fdvtitle').style.color = "red";
  } else {
    document.getElementById('fdvtitle').style.color = "black";
  }
}

function updateFDV() {

  var key = document.UpdateForm.admissno.value;
  var val = document.UpdateForm.pmsvx122.value;
  var linkurl="emrweb08.pbl?reportno=53"+
              "&updfield=19&valdcode=" + key.replace(/ /g,"+") +
              "&valvxudf=" + val.replace(/ /g,"+");
  var retnval=RSExecute(linkurl);

  if (val[3]=='X'){
    alert('Complete FDV Pathway');
  }
}

</script>
%START.OF.PAGE
<body onLoad="PageLoad(event);formatNotes();initA();flagFDV();" 
      onunload="unlockClinNotes();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%EMRWEB02.01.003";
PatientVIS="%EMRWEB02.01.081";
PatientNAM="%EMRWEB02.01.002";
PatientSTA="%EMRWEB02.01.086.078";
PatientALT="%EMRWEB02.01.084";
PatientSEX="%EMRWEB02.01.019";
PatientDOB="%EMRWEB02.01.020";
PatientAGE="%EMRWEB02.01.021";
PatientLOC="%EMRWEB02.01.083";
PatientPRI="%EMRWEB02.01.086.066.1";
PatientUNT="%EMRWEB02.01.066.0";
PatientIND="%EMRWEB02.01.086.091";
GpCOD="%EMRWEB02.01.086.084.001";
GpNAM="%EMRWEB02.01.086.084.081";
GpPRAC="%EMRWEB02.01.086.085.001";
GpPRACCNT="%EMRWEB02.01.086.085.002";
GpPRACNAM="%EMRWEB02.01.086.085.005";
PatientARR="%EMRWEB02.01.101.0 %EMRWEB02.01.102";
PatientSEE="%EMRWEB02.01.130.0 %EMRWEB02.01.131";
PatientTRI="%EMRWEB02.01.103.3";
PatientECLC="%EMRWEB02.01.484.1";
PatientCLH="%STANDARD.01.017.CL";
PatientEHFT="%EMRWEB02.01.485";
InsertEmergencyHeader();
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<table width=100% align=center border=0 cellspacing=0 cellpadding=0>
<tr><td class=HeadingCell align=center>
    Emergency Patient Clinical Details</td>
    <td class=HeadingCell align=right width=5%>
    <a href="javascript:NextPatient('%EMRWEB02.01.578.emrweb02.01.100');">
    <img src='../images/ShowIcon.gif' border=0 align=left
     alt="Select next emergency patient by visit date/time."
     title="Select next emergency patient by visit date/time."></a>
    </td></tr>
</table>
<form name=UpdateForm id=UpdateForm action="emrweb02.pbl" method=post
 style="margin:0" onsubmit='return validateMandatory(this);'>
<input type=hidden name=reportno id=reportno value="01">
<input type=hidden name=updttype id=updttype value="TRIAG">
<input type=hidden name=resavail id=resavail value="0">
<input type=hidden name=template id=template value="100">
<input type=hidden name=admissno id=admissno value="%EMRWEB02.01.081">
<input type=hidden name=urnumber id=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=emvis118 id=emvis118 value="%EMRWEB02.01.003">
<input type=hidden name=formactn id=formactn value=" "> 
<input type=hidden name=nextpage id=nextpage value=0>
<input type=hidden name=redirect id=redirect>
<input type=hidden name=updateky id=updateky value="%EMRWEB02.01.404">
<input type=hidden name=username id="username">
<input type=hidden name=password id="password">
<input type=hidden name=dummy1 id=dummy1>
<input type=hidden name=dummy2 id=dummy2>
<input type=hidden name=emvis004 id=emvis004>
<input type=hidden name=emvis005 id=emvis005>
<input type=hidden name=emvis135 id=emvis135>
<input type=hidden name=emvis136 id=emvis136>
<input type=hidden name=emvis137 id=emvis137>
<input type=hidden name=emvis138 id=emvis138>
<input type=hidden name=emvis147 id=emvis147>
<input type=hidden name=emdct001 id=emdct001>
<input type=hidden name=emdct002 id=emdct002>
<input type=hidden name=emdct003 id=emdct003>
<input type=hidden name=emdct004 id=emdct004>
<input type=hidden name=emdct005 id=emdct005>
<input type=hidden name=emdct006 id=emdct006>
<input type=hidden name=emdct007 id=emdct007>
<input type=hidden name=emdct008 id=emdct008>
<input type=hidden name=emdct009 id=emdct009>
<input type=hidden name=emvis026 id=emvis026 value=" ">
<input type=hidden name=emvis006 id=emvis006 value="%EMRWEB02.01.106.1">
<input type=hidden name=temdiag id=temdiag value="">
<input type=hidden name=emcndoct id=emcndoct value="%EMRWEB02.01.455">
<input type=hidden name=patlocot id=patlocot value="%EMRWEB02.01.580">
<input type=hidden name=hasdraft id=hasdraft value="%EMRWEB02.01.921.014">
<input type=hidden name=hasfinal id=hasfinal value="%EMRWEB02.01.921.015">

<table width=100% align=center border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=5%>Triage Date </td>
    <td class=DataLabel width=40%><input type="text" name=emvis128 id=emvis128 size="12"
     title="Triage Date" value="%EMRWEB02.01.162.0" readonly>
    Time
    <input type="text" name=emvis129 id=emvis129 size="8"
     value="%EMRWEB02.01.163" readonly>
    </td>
    <td width=10%>&nbsp;</td>
    <td  width=45% align=right>
    <input type=button class="Bigbutton" 
     value="Nurse Handover" onclick='DoctorData();'>
    <input type=button class="Bigbutton" value="Doctor Handover"
     onclick='NurseData();'>
    </td></tr>

<tr valign=top><td class=DataLabel>Presenting Complaint</td>
   <td><input type=hidden name=el id=el value="el">
       <input type=text name=emvis060 id=emvis060 max=3 readonly size=3
         title="Presenting Compliant" value="%EMRWEB02.01.220.1"
         onblur="validateCatCode(el,emvis060,v060name);">
       <input type=text name=v060name id=v060name readonly value="%EMRWEB02.01.220.0">
       <span class="DataLabel FDVLabel" id=fdvtitle>FDV Related</span>
       <select name=pmsvx122 id=pmsvx122 title="FDV Related?" 
               class="Select200" tabindex=91 onchange="flagFDV();updateFDV();">
         <option></option>
         %EMRWEB02.01.599.008.9.5
       </select>
       <br>
       <textarea id=txtarea1 wrap=hard name=prcom001 id=prcom001 cols=50 readonly rows=5 
         onchange="setPreXml('%EMRWEB02.01.081');"></textarea>
   </td>
   <td class=DataLabel valign=top>Management Notes<br>
        <input type=button class="button" value="Add Mgt Note"
         onclick='AddManagementNotes();'><br><br>
        <input type=button class="button" value="Edit Notes"
         onclick='EditMgtNote();'>
      </td>
      <td class=DataLabel valign=top>
      <textarea name=dismnote id=dismnote rows=5 wrap=hard readonly
       cols=60>%EMRWEB02.01.471.002.0</textarea>
   </td></tr>

<tr><td valign=top rowspan=2>Notes for this <br>Attendance<br>
       <input type=button class="Bigbutton" value="Documents"
        onclick='DocumentLink();'><br>
       <input type=button class="Bigbutton" value="Print"
        onclick='PrintEMGRegForm();'><br><br>
       <input type=button class="Bigbutton" value="Add Medical Note"
        onclick='AddClinNote("MEDICAL");' ><br>
       <input type=button class="Bigbutton" value="Add Nursing Note"
        onclick='AddClinNote("NURSING");' ><br>
       <input type=button class="Bigbutton" value="Add Other Note"
        onclick='AddClinNote("OTHER");'><br><br>
       <input type=button class="Bigbutton" value="Edit Notes"
        onclick='EditClinNote();'>
    </td>
    <td valign=top rowspan=2><textarea id=discnote name=discnote
        rows=23 wrap=hard readonly cols=100>%EMRWEB02.01.471.001.1</textarea>
    </td>
    <td valign=top>Past Medical History<br>
        <input type=button class="button" value="Add History"
         onclick='AddList();'><br><br>
        <input type=button class="button" value="Edit Notes"
         onclick='EditHistNote();'>
    </td>
    <td valign=top><textarea readonly cols=85 rows=20
         name=medichis id=medichis></textarea>
    </td></tr>


<tr><td valign=top><input type=button class="button" value="Consult"
        onclick='ConsultantLink();'></td>
    <td valign=top>
    <div id=ConsultantSection style="height:80px;overflow: auto;">
    <table width=100% align=center border=1 cellspacing=0 cellpadding=0>
    %EMRWEB02.01.598
    </table>
    </div>
    </td>
    </tr>

<tr>
    <td valign=top rowspan=2>Discharge Text <br><div id=divDschTextStat></div><br>
       <input type=button class="Bigbutton" value="Edit" 
        onclick='EditDischText();'> <br>
       <!--<input type=button class="Bigbutton" value="Print" 
        onclick='PrintDischText();'>-->
    </td>
    <td valign=top rowspan=2><div id="divText"></div></td> 
    <td valign=top><input type=button class="button" value="Diagnosis"
        onclick='DiagnosisLink();'></td>

    <td valign=top><textarea readonly wrap=hard cols=85 rows=5 name=patdiag id=patdiag align=right
        onfocus="lockDiagnosis();" onkeydown="LimitText(this,8,10000);"
        onblur="diagNoteXml('%EMRWEB02.01.081');"></textarea>
    </td>

</tr>

<tr>
    <td>Ward Allocated Date</td>
    <td>
    <input type="text" name=dummy id=dummy size="12" class="Readonly"
     title="Triage Date" value="%EMRWEB02.01.532.1" readonly>
    Time
    <input type="text" name=dummy1 id=dummy1 size="8" value="%EMRWEB02.01.532.2" 
     readonly class="Readonly">
    Allocated Ward&nbsp;
    <input type="text" name=dummy1 id=dummy1 size="30" value="%EMRWEB02.01.532.0" 
     readonly class="Readonly">
    <!--<input size="10" placeholder="Write.." onkeydown="GetChar(event);">-->
    </td>
    </tr>

</table>
</form>
</div>

<form name=SelectScreen id=SelectScreen action="emrweb02.pbl" method=post
 style="margin:0">
 <input type=hidden name=reportno id=reportno value=1>
 <input type=hidden name=template id=template value=1>
 <input type=hidden name=admissno id=admissno value="%EMRWEB02.01.081">
 <input type=hidden name=urnumber id=urnumber value="%EMRWEB02.01.003">
</form>
<form name=AddDiagnosis id=AddDiagnosis method=post action=emrweb06.pbl
 style="margin:0">
<input type=hidden name=reportno id=reportno value="2">
<input type=hidden name=template id=template value="002">
<input type=hidden name=updatety id=updatety value="A">
<input type=hidden name=nextpage id=nextpage value="1">
<input type=hidden name=redirect id=redirect value="%EMRWEB02.01.001.emrweb02.01.100">
<input type=hidden name=urnumber id=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno id=admissno value="%EMRWEB02.01.081">
<input type=hidden name=emvcd001 id=emvcd001 value="%EMRWEB02.01.081">
<input type=hidden name=emvcd002 id=emvcd002 value="005">
<input type=hidden name=emvcd004 id=emvcd004 value="5">
<input type=hidden name=emuty001 id=emuty001 value="EMRD">
<input type=hidden name=emvcd005 id=emvcd005 value="">
<input type=hidden name=emvcd006 id=emvcd006 value="   ">
<input type=hidden name=emvcd031 id=emvcd031 value="1">
<input type=hidden name=updateky id=updateky value="%EMRWEB02.01.449">
<input type=hidden name=webuseri id=webuseri value="%STANDARD.01.008">
</form>
<form name=PatientLinks id=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno id=reportno value=1>
<input type=hidden name=template id=template value=004>
<input type=hidden name=regexstm id=regexstm value=102>
<input type=hidden name=newstand id=newstand value=1>
<input type=hidden name=urnumber id=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno id=admissno value="%EMRWEB02.01.081">
<input type=hidden name=nextpage id=nextpage value="4">
<input type=hidden name=emrgflag id=emrgflag value="Y">
<input type=hidden name=MenuType id=MenuType value="11">
<input type=hidden name=webuseid id=webuseid value="%STANDARD.01.008">
<input type=hidden name=showspec id=showspec value="1">
<input type=hidden name=notetype id=notetype value="">
<input type=hidden name=notenumb id=notenumb value="">
<input type=hidden name=vsctm001 id=vsctm001 value="">
</form>
<form name=HiddenFields id=HiddenFields style="margin:0">
<input type=hidden name=InjuryIndicator id=InjuryIndicator value="%EMRWEB02.01.447">
<input type=hidden name=DoctorCode id=DoctorCode value="%EMRWEB02.01.107.001">
<input type=hidden name=DischargeComplete id=DischargeComplete value="%EMRWEB02.01.147">
<input type=hidden name=Diag01 id=Diag01 value="%EMRWEB02.01.437">
<input type=hidden name=Diag02 id=Diag02 value="%EMRWEB02.01.438">
<input type=hidden name=Diag03 id=Diag03 value="%EMRWEB02.01.439">
<input type=hidden name=Diag04 id=Diag04 value="%EMRWEB02.01.440">
<input type=hidden name=Diag05 id=Diag05 value="%EMRWEB02.01.441">
<input type=hidden name=Diag06 id=Diag06 value="%EMRWEB02.01.442">
<input type=hidden name=Diag07 id=Diag07 value="%EMRWEB02.01.443">
<input type=hidden name=Diag08 id=Diag08 value="%EMRWEB02.01.444">
<input type=hidden name=Diag09 id=Diag09 value="%EMRWEB02.01.445">
<input type=hidden name=Pres01 id=Pres01 value="%EMRWEB02.01.104">
<input type=hidden name=Pres02 id=Pres02 value="%EMRWEB02.01.105">
<input type=hidden name=Pres03 id=Pres03 value="%EMRWEB02.01.174">
<input type=hidden name=Pres04 id=Pres04 value="%EMRWEB02.01.175">
<input type=hidden name=Pres05 id=Pres05 value="%EMRWEB02.01.176">
<input type=hidden name=Pres06 id=Pres06 value="%EMRWEB02.01.177">
<input type=hidden name=prcom001 id=prcom001>
<input type=hidden name=vicmt002 id=vicmt002>
<input type=hidden name=deptdate id=deptdate value="">
<input type=hidden name=depttime id=depttime value="">
<input type=hidden name=deptstat id=deptstat value="">
<input type=hidden name=ptcnbedm id=ptcnbedm value="%STANDARD.01.025.112.106.0.1">
</form>

<span id=txtDraft style="display:none">
<textarea rows=7 wrap=hard readonly cols=100>
%EMRWEB02.01.922.014.0.1
</textarea>
</span>

<span id=txtFinal style="display:none">
<textarea rows=7 wrap=hard readonly cols=100>
%EMRWEB02.01.922.015.0.1
</textarea>
</span>

<span id=txtBlank style="display:none">
<textarea rows=7 wrap=hard readonly cols=100>
</textarea>
</span>

<script type="text/javascript">
if(EmergencyFullScreens) {
  top.document.all.menu.height='744';
  top.document.all.content.height='0';
}
 CTypeAdm="%EMRWEB02.01.252";
 if ( CTypeAdm == "Yes") {
   document.UpdateForm.emvis147.value=1; }
 else { 
   document.UpdateForm.emvis147.value=0; }
 MedNoteLine="%EMRWEB02.01.436"
 NoteArray=MedNoteLine.split("|");
 NewNotes=NoteArray[0]
 for (var j=1; j < NoteArray.length; j++) {
//if (!isWhitespace(NoteArray[j])) {
       NewNotes=NewNotes+"\n"+NoteArray[j];
//} 
 }
 document.UpdateForm.medichis.value=NewNotes;

VisitStatus="%EMRWEB02.01.147";
if ( VisitStatus !== "1") {
  document.HiddenFields.deptdate.value="%EMRWEB02.01.124.0";
  document.HiddenFields.depttime.value="%EMRWEB02.01.125";
  document.HiddenFields.deptstat.value="%EMRWEB02.01.126.0";
}
</script>
