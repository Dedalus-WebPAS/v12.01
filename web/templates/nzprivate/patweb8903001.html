<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nzprivate">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script language="JavaScript" src="../js/preadmission.js">    </script>
<script language="JavaScript">    
function updateDiag() {
  p=document.UpdateForm
  p.nzspr010.value=p.mbsdesc1.value
}
function SetWardBed() {
 if(document.UpdateForm.admitbox.checked == true) {
     document.UpdateForm.admitbox.value="1";
//     document.UpdateForm.ptmis068.className="Mandatory";
  } else {
     document.UpdateForm.admitbox.value="0";
//     UpdateForm.ptmis068.className="";                   
  }
}

function checkboxtabindex() {
  var d = document.getElementById("d_ptmis079");
  d.tabIndex = 36;
  d = document.getElementById("d_nzspr013");
  d.tabIndex = 37;
  d = document.getElementById("d_nzspr016");
  d.tabIndex = 40;

  if (document.getElementById("ptmis079").value=="1") {
    document.getElementById("d_ptmis079").checked=true;
  }

  if (document.getElementById("nzspr013").value=="1") {
    document.getElementById("d_nzspr013").checked=true;
  }

  if (document.getElementById("nzspr016").value=="1") {
    document.getElementById("d_nzspr016").checked=true;
  }

}

function SubmitAdm() {
    p=document.UpdateForm
    validateSuspension(p.urnumber,p.ptmis001,p.datefrom,p.dateto);
    p.ptmis020.value=p.nzspr010.value;
    if(p.datefrom.value!='0'){
      if(p.admitbox.value=="1"){
         document.UpdateForm.admitbox.value="0";
         ans=confirm("Warning : Patient has a Suspension record for period \n" +
               "\t" + p.datefrom.value  + " - " + p.dateto.value + "\n" +
               "\tPatient will not be admitted");
         }else{
         ans=confirm("Warning : Patient has a Suspension record for period \n" +
               "\t" + p.datefrom.value  + " - " + p.dateto.value);}
         if (ans!=true) {
            return;
         } 
    }
  document.UpdateForm.ptmis004.value = document.UpdateForm.ptmis068.value;
  document.UpdateForm.ptmis005.value = document.UpdateForm.ptmis076.value;
  if(document.UpdateForm.ptmis027.value.substr(9,1)=="P"||
     document.UpdateForm.ptmis027.value.substr(9,1)=="F"){
     document.UpdateForm.redirect.value="patweb89.pbl?reportno=09&template=001"
     + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
     + "&admissno=";}
  else if (document.UpdateForm.admitbox.value == "1") {
     document.UpdateForm.admitbox.value;
     document.UpdateForm.redirect.value="patweb98.pbl?reportno=01&template=043"
     + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
     + "&admissno=";
  }
  else {
    document.UpdateForm.redirect.value="patweb98.pbl?reportno=01&template=001"
    + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
    + "&admissno=";
  }
  SetLinkACC(UpdateForm,"PRE");
  if(document.UpdateForm.ptmis027.value.substr(9,1)=="P"||
     document.UpdateForm.ptmis027.value.substr(9,1)=="F"){
    if(document.UpdateForm.nzspr007.value==""){
      if(!valContract(document.UpdateForm)){return;}}
  }

  if (document.getElementById("d_ptmis079").checked==true) {
    document.getElementById("ptmis079").value="1";
  } else {
    document.getElementById("ptmis079").value="0";
  }

  if (document.getElementById("d_nzspr013").checked==true) {
    document.getElementById("nzspr013").value="1";
  } else {
    document.getElementById("nzspr013").value="0";
  }

  if (document.getElementById("d_nzspr016").checked==true) {
    document.getElementById("nzspr016").value="1";
  } else {
    document.getElementById("nzspr016").value="0";
  }

  if(validateMandatory(UpdateForm)){
    SubmitHidden(UpdateForm);}
}
function valClaimCode() {
  if(document.UpdateForm.nwbclaim.value!=""){
     return;}
  validateCode(41,UpdateForm.urnumber,UpdateForm.claimc);
  for (var i =0 ; i < document.UpdateForm.ptmis027.length; i++) {
    if (document.UpdateForm.claimc.value==
        trim(document.UpdateForm.ptmis027.options[i].value.substr(0,3))){
          document.UpdateForm.ptmis027.selectedIndex=i;
    }
  }
  setClaim();
}

function setClaim(){
 if(document.UpdateForm.ptmis027.value.substr(9,1)=="P"||
  document.UpdateForm.ptmis027.value.substr(9,1)=="F"){
     document.UpdateForm.ptmis013.className="Mandatory";
     document.UpdateForm.ptmis026.className="Mandatory";
     document.UpdateForm.nzspr007.className="Mandatory";
//     document.UpdateForm.ptmis068.className="Mandatory";
  } else {
     document.UpdateForm.ptmis013.className="";
     document.UpdateForm.ptmis026.className="";
     document.UpdateForm.nzspr007.className="";
//     document.UpdateForm.ptmis068.className="";
  }
     PatientInsHeading.innerHTML=patientinshd.innerHTML;
     //PatientIns.innerHTML=patientins.innerHTML;
     InsurerHeading.innerHTML=insurerhd.innerHTML;
     Insurer.innerHTML=insurer.innerHTML;
     ApprovalSightedHeading.innerHTML=approvalsightedhd.innerHTML;
     //ApprovalSighted.innerHTML=approvalsighted.innerHTML;
     ClaimNumberHeading.innerHTML=claimnumberhd.innerHTML;
     ClaimNumber.innerHTML=claimnumber.innerHTML;
     ApprovalDateHeading.innerHTML=approvaldatehd.innerHTML;
     ApprovalDate.innerHTML=approvaldate.innerHTML;
     CommentsHeading.innerHTML=commentshd.innerHTML;
     Comments.innerHTML=comments.innerHTML;

 document.UpdateForm.nzspr015.className="";
 document.UpdateForm.nzspr017.className="";
 if(document.UpdateForm.ptmis027.value.substr(11,1)=="A"){
     document.UpdateForm.nzspr015.className="Mandatory";
   }else{
     if(document.UpdateForm.ptmis027.value.substr(11,1)=="B"){
         document.UpdateForm.nzspr017.className="Mandatory";
       }else{
         if(document.UpdateForm.ptmis027.value.substr(11,1)=="C"){
             document.UpdateForm.nzspr015.className="Mandatory";
             document.UpdateForm.nzspr017.className="Mandatory";
         }
     }
  }
}
function InsuranceUpd() {
  f = document.UpdateForm;
  ind7 = f.ptmis027.value.substr(9,1);
  ind10 = f.ptmis027.value.substr(12,1);
  ind27 = f.ptmis027.value.substr(44,1);
//alert('ind7=' + ind7 + ' ind10=' + ind10 + ' ind27=' + ind27);
  if (ind10=="A") {
    if (document.getElementById("d_nzspr013").checked==true) {
      f.nzspr014.className="Mandatory";
      f.nzspr014.disabled=false;
      f.nzspr015.className="Mandatory";
      f.nzspr015.disabled=false;
      f.nzspr017.disabled=false;
      f.nzspr024.disabled=false;
      f.d_nzspr016.disabled=false;
    }
    else {
      if (ind27=="I") {
        f.nzspr014.className="Mandatory";
        f.nzspr014.disabled=false;
      }
      else {
        f.nzspr014.className="";
        f.nzspr014.disabled=true;
        f.nzspr014.value="";
        InsurerField.innerHTML="";
      }
      f.nzspr015.className="";
      f.nzspr015.disabled=true;
      f.nzspr017.disabled=true;
      f.nzspr024.disabled=true;
      f.d_nzspr016.disabled=true;
      f.d_nzspr016.checked=false;
    }
  }
  else {
    if (ind27=="I") {
      f.nzspr014.className="Mandatory";
      f.nzspr014.disabled=false;
    }
    f.nzspr015.disabled=false;
    f.d_nzspr016.disabled=false;
    f.nzspr017.disabled=false;
    f.nzspr024.disabled=false;
  }
  CheckIns();
}
</script>
%START.OF.PAGE
<body onload="PageLoad(event); valClaimCode();DisplayTrnSrc();
              UpdateForm.ptmis001.focus();checkboxtabindex();
              createSpecialtyArray();getHCPSpecialtySelectList();
              defaultSpecialty();InsuranceUpd();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.03.003";
PatientVIS="%PATWEB89.03.081";
PatientNAM="%PATWEB89.03.002";
PatientSTA="%PATWEB89.03.086.078";
PatientALT="%PATWEB89.03.084";
PatientSEX="%PATWEB89.03.019";
PatientDOB="%PATWEB89.03.020";
PatientAGE="%PATWEB89.03.021";
PatientLOC="%PATWEB89.03.083";
PatientPRI="%PATWEB89.03.086.066.1";
PatientUNT="%PATWEB89.03.066.0";
DoctorCOD="%PATWEB89.03.082.003";
DoctorNAM="%PATWEB89.03.082.002";
PatientAID="%PATWEB89.03.086.090";
PatientIND="%PATWEB89.03.086.091";
PatientCUR="%PATWEB89.03.086.092";
PatientCLC="%PATWEB89.03.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.03.086.094";
PatientCDM="%PATWEB89.03.086.095";
PatientVDH="%PATWEB89.03.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form name=linkForm action=patweb89.pbl method=post style=margin:0>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.101">
</form>
<form name=Lookup action=patweb94.pbl method=post style=margin:0>
<input type=hidden name=reportno value=9>
<input type=hidden name=template value=1>
<input type=hidden name=valcateg>
<input type=hidden name=valdtype>
<input type=hidden name=valdcode>
</form>
<form name=UpdateForm method=post>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.101">
<input type="hidden" name="updatety" value="1">
<input type="hidden" name="reportno" value="2">
<input type="hidden" name="redirect">
<input type="hidden" name="allocate" value="1">
<input type="hidden" name="chckname" value="0">
<input type="hidden" name="emradmit" value="0">
<input type="hidden" name="emradmis" value="0">
<input type="hidden" name="newbmand" value="0">
<input type="hidden" name="agebmand" value="0">
<input type="hidden" name="ptcnueoc" value="%PATWEB89.03.925">
<input type="hidden" name="claimc">
<input type="hidden" name="nwbclaim" value="%PATWEB89.03.126.1">
<input type="hidden" name="datefrom">
<input type="hidden" name="dateto">
<input type="hidden" name="nzhosp">
<input type="hidden" name="exstward" value="%PATWEB89.03.449.1">
<input type="hidden" name="ptcnhpcd" value="%PATWEB89.03.930">
<input type=hidden name=retcount value="">
<input type=hidden name=retcontr value="">
<input type=hidden name=retcdesc value="">
<input type=hidden name=residadm value="%PATWEB89.03.959">
<input type=hidden name=refvisno value="%PATWEB89.03.960">
<input type=hidden name=refrdate value="%PATWEB89.03.999.101">
<input type="hidden" name="nzspr007" title="Contract Procedure Code">
<input type="hidden" name="c_ptmis010" id="c_ptmis010"
       value="%PATWEB89.03.111.1">
<input type="hidden" name="ptmis079" value="%PATWEB89.03.199.009" id=ptmis079>
<input type="hidden" name="nzspr013" value="%PATWEB89.03.955.013" id=nzspr013>
<input type="hidden" name="nzspr016" value="%PATWEB89.03.955.016" id=nzspr016>
<input type=hidden name=ptmis020 value="%PATWEB89.03.955.010">
<input type="hidden" name="ptmis050" value="%PATWEB89.03.982">

<table border=0 width=100% cellspacing=1 cellpadding=1>
<tr><td class=HeadingCell align=center colspan=4>
    Patient Pre-Admission Details (New) </tr>
<tr><td >
    <table width=100%  border=0 class=TableBody cellpadding=0 cellspacing=0>
    <tr><td class=DataLabel>Admission Date </td>
        <td><input type=text size=12 name=ptmis001 tabindex=1
              class=Mandatory title="Admission Date" id=ptmis001
              value="%STANDARD.01.015" 
              onblur="checkDate(this,'AdmissionDate');
                      getHCPSpecialtySelectList();defaultSpecialty();">
         <img notab src=../images/CalendarLookup.gif class=Icon
          onclick="DateLookupFrame(ptmis001);">     
          Time <input type=text name=ptmis002 size=8 tabindex=2 id=ptmis002
               value="%STANDARD.01.016" class="Mandatory" 
               title="Admission Time" onblur="checkTime(this,'AdmissionTime');">
        <img notab src=../images/DateTimeStamp.gif class=Icon
         onclick="SetCurrentDateTime(null,ptmis002);">
       <img notab src=../images/TimeLookup.gif class=Icon 
        onclick="TimeLookupFrame(ptmis002);">
      </td>
      <td class=DataLabel>%STANDARD.01.017.CL</td>
      <td><select name=ptmis027 title="%STANDARD.01.017.CL" tabindex=27
           class="Mandatory" onchange="setClaim();InsuranceUpd();">
           <option> </option>
           %PATWEB89.03.126.2
           </select></td>
      </tr>

      <tr><td class=DataLabel>Referral Source</td>
          <td><select name=ptmis009 onchange="DisplayTrnSrc()" tabindex=3
               class="Mandatory" title="Referral Source">
                 <option> </option>
                 %PATWEB89.03.110.4
                 </select></td>
           <td class=DataLabel>Admitting Doctor</td>
          <td><input type="text" size=8 maxlength=6 name="ptmis007" tabindex=28
               onblur="UpCase(this); validateCode(31,ptmis007,doctnam2);
                       getHCPSpecialtySelectList();defaultSpecialty();"
               class="Mandatory" title="Admitting Doctor" id="ptmis007"
               value="%PATWEB89.03.108.003">
              <input type=text readonly size=25 notab name=doctnam2
               value="%PATWEB89.03.108.002" id=doctnam2>
              <img notab src="../images/SearchIcon.gif" class=Icon
               onclick="DoctorSearchFrame(ptmis007,doctnam2)"> 
          </td></tr>

      <tr><td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>
        <td class=DataLabel>Primary Procedure</td>
        <td class=DataLabel>
        <input type=text name=ptmis026 size=10 maxlength=9 tabindex=30
        id=ptmis026 onblur='validateCode(4,ptmis026,mbsdesc1,ptmis001,updateDiag)'>
        <input type=text notab readonly name=mbsdesc1 size=35 id=mbsdesc1 value="">
        <img notab src="../images/SearchIcon.gif" class=Icon
        onclick="MbsSearchFrame(ptmis026,mbsdesc1,ptmis001)"> </td>
      </tr>

      <tr><td>Admitting Point</td>
       <td><select name=ptvis046  onchange="defaultWard()" class=Mandatory
            tabindex=5 title="Admitting Point">
           <option></option>
            %PATWEB89.03.290.4
        </select></td>
        <td class=DataLabel>Full Description</td>
        <td><input type=text name=nzspr010 title="Procedure Description"
             size=80 maxlength=80 tabindex=31>
        </td>
     </tr>

     <tr><td class=DataLabel>Ward / Bed </td>
         <td><input type=hidden name=bedstat1 id=bedstat1>
           <input type=hidden name=ptmis004 id=ptmis004>
           <input type=hidden name=ptmis005 title="Bed" id=ptmis005>
           <input type=hidden name=warddesc id=warddesc>
           <select name=ptmis068 class=Mandatory tabindex=6 id=ptmis068>
            <option value="" title=Ward> </option>
            %PATWEB89.03.449.2
           </select>
           <input type=text name=ptmis076 maxlength=3 size=3 tabindex=7
                  title="Bed" onchange="UpCase(this);" id=ptmis076>
           <img notab src=../images/SearchIcon.gif class=Icon
            onclick="WardBedSearchFrame(ptmis068,warddesc,ptmis076,bedstat1);">
          </td>
      <td class=DataLabel>Contract</td>
      <td><input type=text size=6 maxlength=6 name=ptmis013 tabindex=32
         title="Health Fund" id=ptmis013
         onchange="validateCode(16,document.UpdateForm.ptmis013,funddesc);"
                   value="%PATWEB89.03.040.0">
        <input type=text size=35 name="funddesc" maxlength="30" 
         value="%PATWEB89.03.040.1" readonly notab id=funddesc>
        <input type="hidden" name="dummy" id=dummy>
        <img src=../images/SearchIcon.gif class=Icon
         onclick="HFundSearchFrame(ptmis013,funddesc,dummy,dummy);">
        <img src="../images/erase.gif" class=Icon
         onclick="clrFields(ptmis013,funddesc,dummy,dummy);">
      </td>
      </tr>

      <tr><td class=DataLabel> Intended Stay </td>
        <td><input type=text size=5 maxlength=5 name=ptmis030 tabindex=8
         title='Expected Length of Stay' value="%PATWEB89.03.129"
         onblur="checkInteger(this,this.value);">
        </td>
      <td class=DataLabel>Approval Number</td>
      <td class=DataLabel>
        <input type=text name=nzspr015 size=20 maxlength=20 tabindex=33
         title="Approval Number"></td>
    </tr>

      <tr><td class=DataLabel>%STANDARD.01.017.A </td>
          <td><select name=ptmis010 title="%STANDARD.01.017.A " 
               tabindex=9 class="Mandatory" id=ptmis010>
              <option></option>
                 %PATWEB89.03.111.4
              </select></td>
        <td><div id=ClaimNumberHeading></div></td>
        <td><div id=ClaimNumber></div></td>
      </tr>

      <tr><td class=DataLabel>Readmission Indicator</td>
          <td><select name=ptmis042 tabindex=10>
                <option> </option>
                 %PATWEB89.03.138.2
              </select></td>
        <td><div id=ApprovalDateHeading></div> </td>
        <td><div id=ApprovalDate></div></td>
       </tr>

       <tr><td class=DataLabel>Diet</td>
          <td><select name=ptmis028 tabindex=11>
              <option></option>
              %PATWEB89.03.065.2 
              </select></td>
         <td>&nbsp;</td>
         <td>&nbsp;</td>
        </tr>

       <tr><td>&nbsp;</td><td>&nbsp;</td>
        <td class=DataLabel>Credit Card Details on File</td>
        <td><input type=checkbox name="d_ptmis079" id="d_ptmis079" /></td>
        </tr>

    <tr><td class=DataLabel>Admit Now</td>
        <td><input type=checkbox value="0" name="admitbox" tabindex=12
             onclick="SetWardBed();"></td>
         <td><div id=PatientInsHeading></div></td>
        <td><input type=checkbox name="d_nzspr013" id="d_nzspr013"
             onclick="InsuranceUpd();" />
    </tr>

    <tr><td>&nbsp;</td><td>&nbsp;</td><td><div id="InsurerHeading"></div></td>
          <td><table><tr><td><div id="Insurer"></div></td>
                         <td><div id="InsurerField"></div></td></tr></table>
          </td></tr>

     <tr><td>&nbsp;</td><td>&nbsp;</td>
        <td><div id=ApprovalSightedHeading></div></td>
        <td><input type=checkbox
                  name="d_nzspr016" id="d_nzspr016" />
        </td>
    </tr>

     <tr><td>&nbsp;</td><td>&nbsp;</td><td><div id=CommentsHeading></div></td>
         <td><div id=Comments></div></td></tr>

     <tr><td>&nbsp;</td><td>&nbsp;</td>
       <td>&nbsp;</td>
       <td>&nbsp;</td>
     </tr>

       <tr><td align=center colspan=4>
       <input type=button value="Ok" class=button id="pat89sub" tabindex=45
         onclick="tempDisable(this);
           if(checkAdmissionDate()){
             checkBedStatus(ptmis068.value,ptmis076.value,
                            ptmis001.value,ptmis030.value,
                            SubmitAdm);}";>
       <input type=button value="Cancel" class=button tabindex=46
             onclick="PatientLinkTo('patweb98.pbl',1,1,0);"></td></tr>
    </table>
  </form>
</td></tr>
</table>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.101">
<input type=hidden name=MenuType value="%PATWEB89.03.088">
</form>
</div>
<script language="Javascript">
//
 if ("%PATWEB89.03.903" == "1") {
  alert("Warning: Patient has a Waiting List Procedure");
 }
 if ("%PATWEB89.03.904" == "1") {
  alert("Warning: Patient has a Booking");
 }
 if ("%PATWEB89.03.905" == "1") {
  alert("Warning: Patient is currently admitted");
 }
 if ("%PATWEB89.03.908" == "1") {
  alert("Warning: Patient has a pre-admission record");
 }
</script>
<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</tr>
</span>
<span id=transfersrc style="display:none">
<td><input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
      title="Transfer Source" tabindex=4 id=trnsfsrc
      onchange="validateCode(9,trnsfsrc,trandesc);">
     <input type=text size=27 name=trandesc notab id=trandesc
      class=Readonly readonly>
     <img src="../images/SearchIcon.gif" class=Icon
      onclick="TransferSourceFrame(trnsfsrc,trandesc)"></td>
</tr>
</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>
<span id=patientinshd style="display:none">
<td class=DataLabel>Patient Insurance</td>
</tr>
</span>

<div id="insurerhd" style="display:none">
<td class=DataLabel>Insurer</td>
</div>

<div id="insurer" style="display:none">
    <select name=nzspr014 title="Insurer" tabindex=38
     onchange="CheckIns();">
    <option></option>
    %PATWEB89.03.955.014.2
    </select>
</div>

<div id="InsurerText" style="display:none">
   <input type="text" size=60 maxlength=50 name=icomment id=icomment tabindex=39
        class=Mandatory title="Insurer Free text">
</div>

<span id=insurerblank style="display:none">
   <input type=hidden name=nzspr014>
</span>
<span id=approvalsightedhd style="display:none">
<td class=DataLabel>Prior Approval Sighted</td>
</tr>
</span>
<span id=claimnumberhd style="display:none">
<td class=DataLabel>Claim Number</td>
</tr>
</span>
<span id=claimnumber style="display:none">
    <td class=DataLabel>
        <input type=text name=nzspr017 size=20 maxlength=20 tabindex=34
         title="Claim Number"></td>
</span>
<span id=claimnumberblank style="display:none">
   <input type=hidden name=nzspr017>
</span>
<span id=approvaldatehd style="display:none">
<td class=DataLabel>Approval Expiry Date</td>
</tr>
</span>
<span id=approvaldate style="display:none">
        <td><input type=text size=12 name=nzspr024 title="Approval Expiry Date"
              tabindex=35 id=nzspr024
              onblur="checkDate(this,'ApprovalDate')";>
         <img notab src=../images/CalendarLookup.gif class=Icon
          onclick="DateLookupFrame(nzspr024);">
        <img notab src=../images/DateTimeStamp.gif class=Icon
         onclick="SetCurrentDateTime(nzspr024,null);">
      </td></tr>
</span>
<span id=approvaldateblank style="display:none">
   <input type=hidden name=nzspr024>
</span>
<span id=commentshd style="display:none">
<td class=DataLabel>Comments</td>
</tr>
</span>
<span id=comments style="display:none">
    <td><input type=text name=nzspr019 size=50 maxlength=30 tabindex=41> </td>
    </td></tr>
</span>
<span id=commentsblank style="display:none">
   <input type=hidden name=nzspr019>
</span>
