<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nzprivate">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript">
function linkPatient(VisitNo,Urnumber,VisitType) {
  if (VisitType=="3") {
      document.PatientLinks.action="patweb71.pbl"
      document.PatientLinks.reportno.value="1"
      document.PatientLinks.template.value="032"
      document.PatientLinks.updttype.value=" "
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.submit()
  }
  if (VisitType=="2") {
      document.PatientLinks.action="outweb07.pbl"
      document.PatientLinks.reportno.value="1"
      document.PatientLinks.template.value="001"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.submit()
  }
  if (VisitType=="1") {
      document.PatientLinks.action="emrweb04.pbl"
      document.PatientLinks.reportno.value="1"
      document.PatientLinks.template.value="001"
      document.PatientLinks.admissno.value=VisitNo
      document.PatientLinks.urnumber.value=Urnumber
      document.PatientLinks.submit()
  }
}
function ShowVisits() {
  document.SelectPeriod.gosubflg.value="1";
   if ((document.SelectPeriod.filtvtyp.value=="1") ||
       (document.SelectPeriod.filtvtyp.value=="2")) {
     document.SelectPeriod.filtoptn.value="1";
  }
  InvoicePendingFilt=0;
  //document.SelectPeriod.submit();
  var h = document.getElementsByTagName("head")[0];
  var s = document.createElement("script");
  var theURL= "../cgi-bin/patweb71.pbl?reportno=08&template=004" +
   "&gosubflg=1" + 
   "&viewtype=" + SelectPeriod.viewtype.value +
   "&filtvtyp=" + SelectPeriod.filtvtyp.options[SelectPeriod.filtvtyp.selectedIndex].value +
   "&filthfnd=" + SelectPeriod.filthfnd.options[SelectPeriod.filthfnd.selectedIndex].value +
   "&filtclam=" + SelectPeriod.filtclam.options[SelectPeriod.filtclam.selectedIndex].value +
   "&filtoptn=" + SelectPeriod.filtoptn.options[SelectPeriod.filtoptn.selectedIndex].value ;
  if (SelectPeriod.lastdate!=undefined) {
    theURL+="&lastdate=" + SelectPeriod.lastdate.options[SelectPeriod.lastdate.selectedIndex].value ;
  } else {
    theURL+="&vyearmth=" + SelectPeriod.vyearmth.options[SelectPeriod.vyearmth.selectedIndex].value ;
  }
  var xmlHttp = createHttpObject();
  xmlHttp.open("GET", theURL, false);
  xmlHttp.send();
  if (xmlHttp.responseText!=""&&xmlHttp.status == 200) {
    s.type="text/javascript";
    h.appendChild(s);
    s.text=xmlHttp.responseText;
    InitTable(0);
  } else {
    alert("Web Service Not available : "+xmlHttp.responseText);
  }
}
function SetInvPndCookies() {
  var el,vl;

  el=document.SelectPeriod.filtvtyp;
  vl=el.options[el.selectedIndex].value;
  SetCookie("InvoicePendingVT",vl);

  el=document.SelectPeriod.filtclam;
  vl=el.options[el.selectedIndex].value;
  SetCookie("InvoicePendingCT",vl);

  el=document.SelectPeriod.filthfnd;
  vl=el.options[el.selectedIndex].value;
  SetCookie("InvoicePendingHF",vl);

  el=document.SelectPeriod.filtoptn;
  vl=el.options[el.selectedIndex].value;
  SetCookie("InvoicePendingOP",vl);

  SetCookie("InvoicePendingPath",location.href);
}
function GetRequest(name){
  if(name=(new RegExp('[?&]'+encodeURIComponent(name)+'=([^&]*)')).exec(location.search))
  return decodeURIComponent(name[1]);
}
function RetInvPndCookies() {
  InvoicePendingVT=GetCookieData("InvoicePendingVT");
  InvoicePendingCT=GetCookieData("InvoicePendingCT");
  InvoicePendingHF=GetCookieData("InvoicePendingHF");
  InvoicePendingOP=GetCookieData("InvoicePendingOP");
  InvoicePendingFilt=0;
  if ((InvoicePendingVT!="" && InvoicePendingVT!="unknown") ||
      (InvoicePendingCT!="" && InvoicePendingCT!="unknown") ||
      (InvoicePendingHF!="" && InvoicePendingHF!="unknown") ||
      (InvoicePendingOP!="" && InvoicePendingOP!="unknown")) {
       InvoicePendingFilt=1;
  }
  if (InvoicePendingVT!="" && InvoicePendingVT!="unknown") {
    for (var i=0; i<document.SelectPeriod.filtvtyp.length; i++) {
      if (document.SelectPeriod.filtvtyp.options[i].value==InvoicePendingVT) {
        document.SelectPeriod.filtvtyp.selectedIndex=i;
      }
    }
  }
  if (InvoicePendingCT!="" && InvoicePendingCT!="unknown") {
    for (var i=0; i<document.SelectPeriod.filtclam.length; i++) {
      if (document.SelectPeriod.filtclam.options[i].value==InvoicePendingCT) {
        document.SelectPeriod.filtclam.selectedIndex=i;
      }
    }
  }
  if (InvoicePendingHF!="" && InvoicePendingHF!="unknown") {
    for (var i=0; i<document.SelectPeriod.filthfnd.length; i++) {
      if (document.SelectPeriod.filthfnd.options[i].value==InvoicePendingHF) {
        document.SelectPeriod.filthfnd.selectedIndex=i;
      }
    }
  }
  if (InvoicePendingOP!="" && InvoicePendingOP!="unknown") {
    for (var i=0; i<document.SelectPeriod.filtoptn.length; i++) {
      if (document.SelectPeriod.filtoptn.options[i].value==InvoicePendingOP) {
        document.SelectPeriod.filtoptn.selectedIndex=i;
      }
    }
  }
  document.cookie="InvoicePendingVT=";
  document.cookie="InvoicePendingCT=";
  document.cookie="InvoicePendingHF=";
  document.cookie="InvoicePendingOP=";
  document.cookie="InvoicePendingPath=";
  ShowVisits();
}
function SelectView(ViewType)
{
  document.SelectPeriod.viewtype.value=ViewType
  if (document.SelectPeriod.lastdate!=undefined)
    document.SelectPeriod.lastdate.value="";

  if (document.SelectPeriod.vyearmth!=undefined)
    document.SelectPeriod.vyearmth.value="";
  document.SelectPeriod.submit();
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);RetInvPndCookies();">

<form name="PatientLinks" method="get" style="margin:0">
 <input type="hidden" name="reportno" value="8">
 <input type="hidden" name="template" value="004">
 <input type="hidden" name="urnumber" value="%PATWEB71.08.003">
 <input type="hidden" name="admissno" value="%PATWEB71.08.081">
 <input type="hidden" name="updttype" value="">
 <input type="hidden" name="MenuType" value="%PATWEB71.08.088">
 <input type="hidden" name="chngdate" value="%PATWEB71.08.208">
</form>

<form name="SelectPeriod" action="patweb71.pbl" method=get style="margin:0">
  <input type="hidden" name="reportno" value="8">
  <input type="hidden" name="template" value="002">
  <input type="hidden" name="updttype" value=" ">
  <input type="hidden" name="viewtype" id="viewtype" value="%PATWEB71.08.220">
  <input type="hidden" name="catCLdes" id=catCLdes value="%STANDARD.01.017.CL">
  <input type="hidden" name="ptcnhitc" id=ptcnhitc 
                       value="%STANDARD.01.025.112.102.0.1">
  <input type="hidden" name="ptcnhdps" id=ptcnhdps
                       value="%STANDARD.01.025.080.250.1.1">
  <input type="hidden" name="gosubflg" id=gosubflg value="%PATWEB71.08.221">

  <table cellpadding=3 bgcolor=#CCCCCC border=0 width=100%>
  <tr><td>Visit Type&nbsp;
          <select name="filtvtyp" id="filtvtyp" class="PMenuSelectList" title="Visit Type">
            <option value="0">All</option>
<!--        <option value="1">Emergency</option>-->
            <option value="2">Outpatient</option>
            <option value="3">Inpatient</option>
          </select>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          %STANDARD.01.017.CL&nbsp;
          <select name="filtclam" id="filtclam" class="SelectMed" title="%STANDARD.01.017.CL">
            <option>All</option>
            %PATWEB71.08.206.2
          </select>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          Contract&nbsp;
          <select name="filthfnd" id="filthfnd"  class="SelectMed" title="Health Fund">
            <option>All</option>
            %PATWEB71.08.213
          </select>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          Option&nbsp;
          <select name="filtoptn" id="filtoptn" class="PMenuSelectList" title="Option">
            <option value="0">Discharged Only</option>
            <option value="1">All Patients</option>
          </select>&nbsp;&nbsp;

          <input type=button value="Go" class=SlimButton onclick="ShowVisits();"></td>

      <td align=right nowrap>
        <input type=button value="<<" class=SmallButton
         onclick='location.href="%PATWEB71.08.218"'>
        %PATWEB71.08.217
        <input type=button value=">>" class=SmallButton
         onclick='location.href="%PATWEB71.08.219"'>
        <a href='javascript:SelectDateFrame();'>
        <img src="../images/DateLookup.gif" border=0
         alt="Select Date" title="Select Date" align=absmiddle></a>
        <a href='javascript:SelectView("0");'>
        <img src=../images/DayIcon.gif border=0
         alt="View Today" title="View Today" align=absmiddle></a>
        <a href='javascript:SelectView("1");'>
        <img src=../images/WeekIcon.gif border=0
         alt="View This Week" title="View This Week" align=absmiddle></a>
        <a href='javascript:SelectView("2");'>
        <img src=../images/MonthIcon.gif border=0
         alt="View This Month" title="View This Month" align=absmiddle></a>
      </td>
  </tr>
  </table>
</form>

<div id="TableLocation"></div>

<span id=WaitBoxDisplay class=WaitBox style="display:none">
<img class=WaitImage src="../images/wait.gif">
<p>Please Wait ...</p>
</span>

<div id=PageLayer class=DimmedLayer style="display:none"></div>

<script type="text/javascript">
function InitTable(TableView) {
 ShowWaitScreen();

 window.setTimeout(function() {
   switch (TableView) {
     case 0: {
      document.title="Invoice Pending List"
      t = new Table(1,0,1,"100%","center",35,35);    // Create New Table Object
      template = 2
    // Add Columns in Order Required
    // Heading,Type,Display Column,Sort Column,Align
      t.addColumn("Visit No.","String",1,1,"left","EditIcon.gif","0",70)
      t.addColumn("Patient Name","String",4,4,"left","","",325)
      t.addColumn("Visit Date","Date",5,5,"left","","",65)
      t.addColumn("Disch. Date","Date",6,6,"left","","",65)
      t.addColumn("Visit Type","String",3,3,"left","","",20)
      t.addColumn(document.SelectPeriod.catCLdes.value,"String",7,7,"left","","",55)
      t.addColumn("Contract","String",10,10,"left","","",50)
    // Add Rows to Table (Output from Web Server)
    //
      AddTableRows();
      t.sortTable(1,1);                              // Patient Name
      OrderColumn=3;
      AscDsc=1;
      lastOrderColumn=OrderColumn;
      TableOutput(OrderColumn,AscDsc,template);      // Discharge Date
      HideWaitScreen();
      break; }
   }
 },50);
}

FilterVis="%PATWEB71.08.204";
for (var i =0 ; i < document.SelectPeriod.filtvtyp.length; i++) {
  if (document.SelectPeriod.filtvtyp.options[i].value==trim(FilterVis)) {
      document.SelectPeriod.filtvtyp.selectedIndex=i;
  }
}
FilterOpt="%PATWEB71.08.207";
for (var i =0 ; i < document.SelectPeriod.filtoptn.length; i++) {
  if (document.SelectPeriod.filtoptn.options[i].value==trim(FilterOpt)) {
      document.SelectPeriod.filtoptn.selectedIndex=i;
  }
}

//function AddTableRows() {
   //PATWEB71.08.214
//}
</script>
