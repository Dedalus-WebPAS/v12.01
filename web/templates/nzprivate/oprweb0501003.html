<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nzprivate">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb05.js"></script>
<script type="text/javascript" src="../js/TheatreScreensHoverInfo.js"></script>
<script type="text/javascript">
function checkIfActive(action) {
  var activeFlag = document.getElementById("opsem013");
  var actionDescription = "";
  var actionFunction = null;
  var SessionTypeActive = document.UpdateForm.opsem017.value.substr(38,1);
                                                                         
  if ((action == 0) && (document.UpdateForm.actvstat.value !=0)) {
       alert("Error: The Operating Room is Inactive. Please update prior to opening Sessions.");
   return;
  }

  //which action was choosen? Open or Delete                            
  actionDescription =  ( action == 0 ) ? "Open" : "Delete";            
                                                                      
  if (activeFlag) //check if the active checkbox exist on the tempalte  
  {                                                                    
    if (activeFlag.checked) //is it checked?                          
    {                                                                
      //which action to take? open or delete session                
      actionFunction =  ( action == 0 ) ? OpenSess01 : DelSess01;  
                                                                  
      if ( action == 0 && SessionTypeActive == "I")              
      {                                                         
        alert("Session Type is no longer active, unable to open sessions"); 
        return;                                                            
      }                                                                   
      //execute the action                    


      actionFunction(CLINIC,DAYNUMBER,STARTTIME,HOSPITAL,THEATRE);
    }                                                            
    else                                                        
      alert("Session Inactive! You can't "+actionDescription+" sessions.");
  }                                                                       
}

function FormatDataFields(){
   UpdateForm.opsem003.value = UpdateForm.opsem003.value + ":00";
   UpdateForm.opsem008.value = UpdateForm.opsem008.value + ":00";
   UpdateForm.opsem004.value = UpdateForm.opsem004.value.replace(/ /g,"");
   UpdateForm.opsem009.value = UpdateForm.opsem009.value.replace(/ /g,"");
   UpdateForm.opsem010.value = UpdateForm.opsem010.value.replace(/ /g,"");
}
function GetOpr() {
   selectOptions2(20,UpdateForm.opsem019,UpdateForm.opsem007);
}
function ChkTime() {
 var startTime = trim(UpdateForm.opsem003.value.replace(/:/g,""));
 var endTime = trim(UpdateForm.opsem008.value.replace(/:/g,""));
  if (startTime > endTime) {
     alert(" Session Start Time cannot be greater than Session End Time");
     UpdateForm.opsem008.value=""
     UpdateForm.opsem004.value=""
     return false;
      }
     return true;
}

function init()
{
  FormatDataFields();
  populateSpecialInstruction();
  if (document.UpdateForm.ibcnmhos.value == 1)
  {
    document.getElementById('multihosp').style.visibility = "visible";
    // GetOpr();
  }
}


function populateSpecialInstruction()
{
   var opsem014 = document.getElementById("opsem014");
   var opsem015 = document.getElementById("opsem015");

   opsem014.value = SPECIALINSTRUCTION1;
   opsem015.value = SPECIALINSTRUCTION2;

   if (opsem014.value.replace(/ /g,"").length ==  0)
       opsem014.value = "";
   else
      opsem014.value = SPECIALINSTRUCTION1;
   
   if (opsem015.value.replace(/ /g,"").length == 0)
       opsem015.value = "";
   else
       opsem015.value = SPECIALINSTRUCTION2;
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);">
<script type="text/javascript">
CLINIC="%OPRWEB05.01.001";
DAYNUMBER="%OPRWEB05.01.003.1";
STARTTIME="%OPRWEB05.01.004";
HOSPITAL="%OPRWEB05.01.026";
THEATRE="%OPRWEB05.01.008.1";
SPECIALINSTRUCTION1 = "%OPRWEB05.01.017";
SPECIALINSTRUCTION2 = "%OPRWEB05.01.018";


</script>

<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Update Session for %OPRWEB05.01.002
</span>

<div id=PageBodySection>
   <form name=UpdateForm method=post action=oprweb05.pbl>
   <input type=hidden name=reportno value="1">
   <input type=hidden name=template value="003">
   <input type=hidden name=updttype value="">
   <input type=hidden name=opsem001 value="%OPRWEB05.01.001">
   <input type=hidden name=name_opsem001 value="%OPRWEB05.01.002">
   <input type=hidden name=sesmtime value="%OPRWEB05.01.004">
   <input type=hidden name=sesmthet value="%OPRWEB05.01.008.1">
   <input type=hidden name=actvstat value="%OPRWEB05.01.008.3">
   <input type=hidden name=sesmhosp value="%OPRWEB05.01.026">
   <input type=hidden name=ibcnmhos value="%STANDARD.01.025.000.043.1.1">
   <input type=hidden name=unit value="">
<table align=center cellspacing=0 cellpadding=1 width=90% border=0>

<tr><td class=DataLabel>Day of Week</td>
    <td><input type=hidden name=opsem002 value="%OPRWEB05.01.003.1">
    <input type=text name=daydesc1 class=Readonly title="Day of Week"
     size=10 readonly value="%OPRWEB05.01.003.0">
    </td></tr>

<tr><td class=DataLabel>Start Time</td>
    <td><input type=text size=8 name=opsem003 class=Mandatory title="Start Time"
         id=opsem003 value="%OPRWEB05.01.004">
        <img src=../images/TimeLookup.gif class=Icon
  onclick="TimeLookupFrame(opsem003);">
    </td></tr>

<tr><td class=DataLabel>End Time</td>
    <td><input type=text size=8 name=opsem008 class=Mandatory title="End Time"
       id=opsem008 value="%OPRWEB05.01.009"
       onblur="checkTime(this);CalcDura(opsem003,opsem008,opsem004);ChkTime();"> 
        <img src=../images/TimeLookup.gif class=Icon
  onclick="TimeLookupFrame(opsem008);">
    </td></tr>

<tr><td colspan=2><hr></td></tr>

<tr><td class=DataLabel>Duration (min)</td>
    <td><input type=text name=opsem004 class=Readonly title="Duration"
         size=6 maxlength=6 readonly value="%OPRWEB05.01.005"  
         onclick="CalcDura(opsem003,opsem008,opsem004);" tabindex=-1>
    </td></tr>

<tr><td class=DataLabel>Time for Breaks (min)</td>
    <td><input type=text name=opsem009 title="time for Breaks"
         size=6 maxlength=6 value="%OPRWEB05.01.010"> 
    </td></tr>

<tr><td class=DataLabel>Prep Time per Patient (min)</td>
    <td><input type=text name=opsem010 
         title="Prep time per Patient" size=6 maxlength=6
         value="%OPRWEB05.01.011">
    </td></tr>

<!-- Multi-Hospital Selection List when IBCNMHOS=1
% OPRWEB05.01.024 -->

<tr id="multihosp" style="visibility:hidden;">
    <td class="DataLabel">Hospital</td>
    <td><input type="text" value="%OPRWEB05.01.025.0" size="50"
        readonly class="readonly"/>
        <input type="hidden" name="opsem019" value="%OPRWEB05.01.026" />
     </td></tr> 

<tr><td class=DataLabel>Operating Room</td>
    <td><select name=opsem007 title="Operating Room">
          <option></option>
          %OPRWEB05.01.008.2            
          </select>
    </td></tr>

<tr><td class=DataLabel>Time Period</td>
    <td><select name=opsem005 class=Mandatory title="Time Period">
          <option></option>
          %OPRWEB05.01.006.2            
          </select>
    </td></tr>

<tr><td class=DataLabel>Unit</td> 
    <td><select name=opsem006 class=Mandatory title="Unit">
          <option></option>
          %OPRWEB05.01.007.2
          </select>
    </td></tr>
 
<tr><td class=DataLabel>Usual Anaesthetist</td>
    <td><input type=text name=opsem011 title="Usual Anaesthetist"
         id=opsem011 size=6 maxlength=6 value="%OPRWEB05.01.012.003"
         onblur="validateCode(31,opsem011,name_opsem011);">     
    <input type=text name=name_opsem011 title="Usual Anaesthetist"
     size=22 maxlength=30 value="%OPRWEB05.01.012.002" readonly class=Readonly
     tabindex=-1 id=name_opsem011 >
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="DoctorSearchFrame(opsem011,name_opsem011);">
    <img src="../images/erase.gif" class=Icon 
     onclick="clrDoc(opsem011,name_opsem011);">
</td></tr>

<tr><td class=DataLabel>Extra Doctor</td>
    <td><input type=text name=opsem012 title="Extra Doctor" size=6 maxlength=6
         value="%OPRWEB05.01.013.003" id=opsem012
         onblur="validateCode(31,opsem012,name_opsem012);">
    <input type=text name=name_opsem012 title="Extra Doctor" readonly 
     class=Readonly size=22 maxlength=30  value="%OPRWEB05.01.013.002"
     tabindex=-1 id=name_opsem012>      
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="DoctorSearchFrame(opsem012,name_opsem012);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrDoc(opsem012,name_opsem012);">
</td></tr>

<tr><td class=DataLabel>Active</td>
    <td><input type=checkbox name=opsem013 title="Active" value="2"
               id=opsem013>
    </td></tr>

<tr><td class=DataLabel>Number of Days to Lock Session</td>
    <td><input type=text size=6 name=opsem016 class=DataField maxlength=2 
         title="Number of Days to Lock Session" value='%OPRWEB05.01.019'
         min=0 onblur=checkInteger(this,this.title)>
</td></tr>

<tr><td class=DataLabel>Session Type</td>
    <td><select name=opsem017 class=Mandatory title="Session Type">
         <option></option>
         %OPRWEB05.01.020.2
        </select>
        <img src="../images/HelpIcon.gif" class="Icon"
             onmouseover="showPopUp(UpdateSessionMaint);">
</td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.YD</td>
    <td><select name=opsem018 class=Mandatory 
         title="%STANDARD.01.017.YD">
         <option></option>
         %OPRWEB05.01.021.2
        </select>
</td></tr>

<tr><td class=DataLabel>Special Instructions 1 </td>
    <td><input type=text class=DataField name=opsem014 size=50 maxlength=50
               id=opsem014> 
</td></tr>

<tr><td class=DataLabel>Special Instructions 2 </td>
    <td><input type=text class=DataField name=opsem015 size=50 maxlength=50
               id=opsem015> 
</td></tr>

<tr><td class=DataLabel>Update Instructions/Anaesthetist into Future</td>
    <td><input type=checkbox name=specupdt value="1">
</td></tr>

<tr><td colspan=2 align=center>
<input type=button value="Update" class="button" 
       onclick="setFormactn('U');">
<input type=button value="Open Sessions" class="button"
 onclick="checkIfActive(0);">
<input type=button value="Delete Sessions" class="button" 
 onclick="checkIfActive(1);">
<input type=button value="Delete" class="button" onclick=setFormactn('D');>
<input type=button value="Cancel" class="button" onclick=DFrameClose();>
</td></tr>
</table>
</form>
</div>

<script language="javascript">
if  ("%OPRWEB05.01.014" == "0")
 {
    document.UpdateForm.opsem013.checked=1
 }
</script>
