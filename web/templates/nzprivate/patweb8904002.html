<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nzprivate">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/admission.js"></script>
<script type="text/javascript">
function updateDiag() {
  p=document.UpdateForm
  p.nzspr010.value=p.mbsdesc1.value
}
function SetRedirect(){
  if (document.UpdateForm.mehvisfl.value == "1") {
    document.UpdateForm.redirect.value="mehweb01.pbl?reportno=01&template=001"
    + "&urnumber=" + document.PatientLinks.urnumber.value.replace(/ /g,"+")
    + "&admissno=" + document.PatientLinks.admissno.value + "&admissno=";
    SetLinkACC(UpdateForm,"MEH");
  }
  else {
    SetLinkACC(UpdateForm,"ADM");
  }
}
function checkboxtabindex() {
  var d = document.getElementById("d_ptmis079");
  d.tabIndex = 28;
  var d = document.getElementById("d_nzspr013");
  d.tabIndex = 29;
  var d = document.getElementById("d_nzspr016");
  d.tabIndex = 32;

  if (document.getElementById("ptmis079").value=="1") {
    document.getElementById("d_ptmis079").checked=true;
  }

  if (document.getElementById("nzspr013").value=="1") {
    document.getElementById("d_nzspr013").checked=true;
  }

  if (document.getElementById("nzspr016").value=="1") {
    document.getElementById("d_nzspr016").checked=true;
  }

}
function CheckIns() {
  f = document.UpdateForm;
  if(document.UpdateForm.nzspr014.value.substr(3,1)=="O") {
    if (document.getElementById("icomment") !=undefined) {
      savicomm = document.getElementById("icomment").value;
    }
    InsurerField.innerHTML=InsurerText.innerHTML;
    f.icomment.value=trim(savicomm);
  }
  else {
    InsurerField.innerHTML="";
  }
}
function SubmitAdm() {
  p=document.UpdateForm;
  validateSuspension(p.urnumber,p.ptmis001,p.datefrom,p.dateto);
  if (p.datefrom.value!='0') {
    alert("Error : Patient has a Suspension record for period \n" +
          "\t" + p.datefrom.value  + " - " + p.dateto.value + "\n" +
          "\tPatient will not be admitted");
    return;
  }
  SetRedirect();
  if (document.UpdateForm.ptmis027.value.substr(9,1)=="F" ||
      document.UpdateForm.ptmis027.value.substr(9,1)=="P") {
    document.UpdateForm.redirect.value="patweb89.pbl?reportno=09&template=001"
    + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
    + "&admissno=";

    if (document.UpdateForm.nzspr007.value=="") {
      document.UpdateForm.ptmis068.disabled=false;
      document.UpdateForm.ptmis068.value=document.UpdateForm.ptmis004.value;
      if (!valContract(document.UpdateForm)) {
        document.UpdateForm.ptmis068.disabled=true;
        return;
      }
    }
  }

  if (document.getElementById("d_ptmis079").checked==true) {
    document.getElementById("ptmis079").value="1";
  } else {
    document.getElementById("ptmis079").value="0";
  }

  if (document.getElementById("d_nzspr013").checked==true) {
    document.getElementById("nzspr013").value="1";
  } else {
    document.getElementById("nzspr013").value="0";
    document.getElementById("nzspr014").disabled=false;
    document.getElementById("nzspr015").disabled=false;
  }

  if (document.getElementById("d_nzspr016").checked==true) {
    document.getElementById("nzspr016").value="1";
  } else {
    document.getElementById("nzspr016").value="0";
  }
  validateBedRequestUpdate(UpdateForm.admissno,UpdateForm.ptmis004,
                           UpdateForm.ptmis005,UpdateForm.bedrqqry);
  SubmitHidden(UpdateForm);
}
function InsuranceUpd() {
  f = document.UpdateForm;
  ind7 = f.ptmis027.value.substr(9,1);
  ind10 = f.ptmis027.value.substr(12,1);
  ind27 = f.ptmis027.value.substr(74,1);
//alert('ind7=' + ind7 + ' ind10=' + ind10 + ' ind27=' + ind27);
  if (ind10=="A") {
    if (document.getElementById("d_nzspr013").checked==true) {
      f.nzspr014.className="Mandatory";
      f.nzspr014.disabled=false;
      f.nzspr015.className="Mandatory";
      f.nzspr015.disabled=false;
      f.nzspr017.disabled=false;
      f.nzspr024.disabled=false;
      f.d_nzspr016.disabled=false;
    }
    else {
      if (ind27=="I") {
        f.nzspr014.className="Mandatory";
        f.nzspr014.disabled=false;
      }
      else {
        f.nzspr014.className="";
        f.nzspr014.disabled=true;
        f.nzspr014.value="";
        InsurerField.innerHTML="";
      }
      f.nzspr015.className="";
      f.nzspr015.disabled=true;
      f.nzspr017.disabled=true;
      f.nzspr024.disabled=true;
      f.d_nzspr016.disabled=true;
      f.d_nzspr016.checked=false;
      f.nzspr015.value="";
    }
  }
  else {
    if (ind27=="I") {
      f.nzspr014.className="Mandatory";
      f.nzspr014.disabled=false;
    }
    f.nzspr015.disabled=false;
    f.d_nzspr016.disabled=false;
    f.nzspr017.disabled=false;
    f.nzspr024.disabled=false;
  }
  CheckIns();
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisplayTrnSrc();UpdateForm.ptmis001.focus();
              checkboxtabindex();CheckIns();
              createSpecialtyArray();getHCPSpecialtySelectList();
              defaultSpecialty();InsuranceUpd();
              validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2)">
<div id=PageHeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.04.003";
PatientVIS="%PATWEB89.04.081";
PatientNAM="%PATWEB89.04.002";
PatientSTA="%PATWEB89.04.086.078";
PatientALT="%PATWEB89.04.084";
PatientSEX="%PATWEB89.04.019";
PatientDOB="%PATWEB89.04.020";
PatientAGE="%PATWEB89.04.021";
PatientLOC="%PATWEB89.04.083";
PatientPRI="%PATWEB89.04.086.066.1";
PatientUNT="%PATWEB89.04.066.0";
DoctorCOD="%PATWEB89.04.082.003";
DoctorNAM="%PATWEB89.04.082.002";
PatientAID="%PATWEB89.04.086.090";
PatientIND="%PATWEB89.04.086.091";
PatientCUR="%PATWEB89.04.086.092";
PatientCLC="%PATWEB89.04.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.04.086.094";
PatientCDM="%PATWEB89.04.086.095";
PatientVDH="%PATWEB89.04.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
</div>
<div id=PageBodySection>
<form name=linkForm action=patweb89.pbl method=post style=margin:0>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.04.003">
<input type=hidden name=admissno value="%PATWEB89.04.101">
</form>
<form name=Lookup action=patweb94.pbl method=post style=margin:0>
<input type=hidden name=reportno value=9>
<input type=hidden name=template value=1>
<input type=hidden name=valcateg>
<input type=hidden name=valdtype>
<input type=hidden name=valdcode>
</form>
<form name=UpdateForm method=post action=patweb89.pbl>
<input type=hidden name=reportno value="2">
<input type=hidden name=template value="1">
<input type=hidden name=updatety value="2">
<input type=hidden name=urnumber value="%PATWEB89.04.003">
<input type=hidden name=admissno value="%PATWEB89.04.101">
<input type=hidden name=allocate value="1">
<input type=hidden name=redirect value="%PATWEB89.04.001.patweb98.01.043">
<input type=hidden name=chckname value="0">
<input type=hidden name=emradmit value="0">
<input type=hidden name=emradmis value="0">
<input type=hidden name=newbmand value="0">
<input type=hidden name=agebmand value="0">
<input type=hidden name=datefrom>
<input type=hidden name=dateto>
<input type=hidden name=ptmis068 disabled>
<input type=hidden name=mehvisfl value="%PATWEB89.04.923">
<input type=hidden name=ptcnueoc value="%PATWEB89.04.925">
<input type=hidden name=exstward value="%PATWEB89.04.158">
<input type=hidden name=retcount value="">
<input type=hidden name=retcontr value="">
<input type=hidden name=retcdesc value="">
<input type=hidden name=nzhosp>
<input type=hidden name=ptmis027 value="%PATWEB89.04.126.3">
<input type="hidden" name="c_ptmis010" id="c_ptmis010"
       value="%PATWEB89.04.111.1">
<input type="hidden" name="ptmis079" id="ptmis079" value="%PATWEB89.04.199.009">
<input type="hidden" name="nzspr013" id="nzspr013" value="%PATWEB89.04.955.013">
<input type="hidden" name="nzspr016" id="nzspr016" value="%PATWEB89.04.955.016">
<input type=hidden name=bedrqqry value="">

<table border=1 colspan=1 width=100% cellspacing=1 cellpadding=1 >
<tr><td class=HeadingCell align=center>
    Patient Admission Details</tr>
<tr>
<tr><td>
    <table width=100%  border=0 class=TableBody cellpadding=2 cellspacing=2>
<tr><td width=50%>
    <table border=0 width=100% class=TableBody cellpadding=0 cellspacing=0>
       <tr><td class=DataLabel>Admission Date</td>
           <td class=DataLabel><input type="text" size="12" tabindex=1
            name=ptmis001 value="%PATWEB89.04.102" class="Mandatory" 
            title="Admission Date" id=ptmis001
            onblur="checkDate(this,'Admission Date');
                    getHCPSpecialtySelectList();defaultSpecialty();">
        <img src=../images/CalendarLookup.gif class=Icon
        onclick="DateLookupFrame(ptmis001);">
       Time 
       <input type=text name=ptmis002 size=8  class="Mandatory" 
        title="Admission Time" tabindex=2 id=ptmis002
        value="%PATWEB89.04.103" onblur="checkTime(this,'AdmissionTime');">
        <img src=../images/DateTimeStamp.gif class=Icon 
         onclick="SetCurrentDateTime(null,ptmis002);">
        <img src=../images/TimeLookup.gif class=Icon 
        onclick="TimeLookupFrame(ptmis002);">
          </td>
         <td class=DataLabel>%STANDARD.01.017.CL</td>
         <td><select name=d_ptmis027 disabled title="%STANDARD.01.017.CL"> 
             <option> </option>
          %PATWEB89.04.126.2
          </select>
          </td>
      </tr>

      <tr><td class=DataLabel>Referral Source</td>
          <td><select name=ptmis009 class="Mandatory" tabindex=3
               onchange="DisplayTrnSrc()" title="Referral Source">
                 <option> </option>
                 %PATWEB89.04.110.2
                 </select></td>
          <td class=DataLabel>Admitting Doctor</td>
          <td><input type="text" size=8 maxlength=6 name="ptmis007" tabindex=24
               value="%PATWEB89.04.108.003" class="Mandatory"
               title="Admitting Doctor" id="ptmis007"
               onblur="UpCase(this); validateCode(31,ptmis007,doctnam2);
                       getHCPSpecialtySelectList();defaultSpecialty();">
              <input type=text readonly size=25 name=doctnam2
               id=doctnam2 value="%PATWEB89.04.108.002">
              <img src="../images/SearchIcon.gif" class=Icon
               onclick="DoctorSearchFrame(ptmis007,doctnam2)"></td>
         </tr>


        <tr><td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>
        <td class=DataLabel>Primary Procedure</td>
        <td class=DataLabel>
        <input type=text name=ptmis026 size=10 maxlength=9
        readonly class=readonly onblur='validateCode(4,ptmis026,mbsdesc1,updateDiag)'
         value="%PATWEB89.04.125">
        <input type=text notab readonly name=mbsdesc1 size=35 
         value="%PATWEB89.04.180" class=readonly>
        </td>


        <tr><td>Admitting Point</td>
        <td><select name="ptvis046" class=Mandatory tabindex=5
            title='Admitting Point' onchange="defaultWard()">
            <option></option>
            %PATWEB89.04.290.2
          </select>
        </td>
        <td class=DataLabel>Full Description</td>
        <td><input type=text name=nzspr010 title="Procedure Description"
             size=80 maxlength=120 value="%PATWEB89.04.955.010"
             readonly class=readonly></td>
        </tr>

          <td class=DataLabel>Ward / Bed </td>
          <td><input type=hidden name=bedstat1 id=bedstat1>
             <input type=hidden name=warddesc id=warddesc>
             <select name=ptmis004 class=Mandatory title="Ward" id=ptmis004 tabindex=6>
              <option> </option>
              %PATWEB89.04.449.2
             </select>
             <input type=text name=ptmis005 maxlength=3 size=3 id=ptmis005
              onchange="UpCase(this);" value="%PATWEB89.04.194">
             <img src=../images/SearchIcon.gif class=Icon
            onclick="WardBedSearchFrame(ptmis004,warddesc,ptmis005,bedstat1);">
           </td>
    <td class=DataLabel>Contract</td>
    <td><input type=text size=6 maxlength=6 name=ptmis013
         class=ReadOnly title="Health Fund"
         onchange="validateCode(16,document.UpdateForm.ptmis013,funddesc);"
                   value="%PATWEB89.04.114.0">
        <input type=text size=35 name="funddesc" maxlength="30"
         value="%PATWEB89.04.114.1" readonly class=readonly notab>
        <input type=hidden name="dummy">
    </td>
  </tr>

  <tr><td class=DataLabel>Intended Stay</td>
        <td>
        <input type=text size=5 maxlength=5 name=ptmis030 tabindex=7
         title='Expected Length of Stay'
         class=Integer onblur="checkInteger(this,this.value);"
         value="%PATWEB89.04.129">
        </td>
        <td class=DataLabel>Approval Number</td>
        <td class=DataLabel>
        <input type=text name=nzspr015 size=20 maxlength=20 tabindex=25
         title="Approval Number" id=nzspr015
         value="%PATWEB89.04.955.015"></td>
      </tr>

      <tr><td class=DataLabel>%STANDARD.01.017.A </td>
          <td><select name=ptmis010 title="%STANDARD.01.017.A "
               tabindex=8 class="Mandatory" id=ptmis010>
              <option></option>
                 %PATWEB89.04.111.2
              </select></td>

       <td><div id=ClaimNumberHeading></div></td> 
        <td><div id=ClaimNumber></div></td>
      </tr>
        
      <tr><td class=DataLabel>Readmission Indicator</td>
          <td><select name=ptmis042 title="Readmission Indicator" tabindex=9>
                <option> </option>
                 %PATWEB89.04.138.2
              </select></td>
        <td><div id=ApprovalDateHeading></div></td>
        <td><div id=ApprovalDate></div></td></tr>
        </tr>

      <td class=DataLabel>Diet</td>
          <td><select name=ptmis028 tabindex=10>
              <option></option>
              %PATWEB89.04.127.2
              </select></td>
         <td>&nbsp;</td>
         <td>&nbsp;</td>
       </tr>

    <tr><td></td><td></td>
        <td class=DataLabel>Credit Card Details on File</td>
        <td><input type=checkbox name="d_ptmis079" id="d_ptmis079" /></td>
    </tr>

    <tr><td>&nbsp;</td><td>&nbsp;</td><td><div id=PatientInsHeading></div></td>
        <td><input type=checkbox name="d_nzspr013" id="d_nzspr013" 
            onclick="InsuranceUpd();"/>
        </td>
     </tr>

    <tr><td>&nbsp;</td><td>&nbsp;</td><td><div id=InsurerHeading></div></td>
          <td><table><tr><td><div id="Insurer"></div></td>
                         <td><div id="InsurerField"></div></td></tr></table>
          </td></tr>

    <tr><td>&nbsp;</td><td>&nbsp;</td><td><div id=ApprovalSightedHeading></div>
        </td>  
        <td><input type=checkbox
                  name="d_nzspr016" id="d_nzspr016" />
        </td>
     </tr>

     <tr><td>&nbsp;</td><td>&nbsp;</td><td><div id=CommentsHeading></div></td>
         <td><div id=Comments></div></td></tr>

<tr><td>&nbsp;</td><td>&nbsp;</td>
    <td class=DataLabel>Assigned Contract Procedure Code</td>
<td><input type=text name="nzspr007" title="Contract Procedure Code"
           value="%PATWEB89.04.955.007" readonly class="Readonly"
           title="Assigned Procedure"></td></tr>
</table>
</td>
      <tr align=center>
       <td colspan=4 align=center><br>
       <input type=button value="Admit" class=button tabindex=40
        id="pat89sub"
        onclick="tempDisable(this);checkBedStatus(UpdateForm.ptmis004.value,
                 UpdateForm.ptmis005.value,UpdateForm.ptmis001.value,
                 UpdateForm.ptmis030.value,SubmitAdm)";>
    </table>
  </td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.04.003">
<input type=hidden name=admissno value="%PATWEB89.04.081">
<input type=hidden name=MenuType value="%PATWEB89.04.088">
<input type=hidden name=admisflg value="1">
</form>
<script language=javascript>
for (var i=0;i<document.UpdateForm.ptmis004.length;i++){
if (document.UpdateForm.ptmis004.options[i].value=="%PATWEB89.04.158"){
    document.UpdateForm.ptmis004.selectedIndex=i}};
//
</script>
</div>
<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</tr>
</span>
<span id=transfersrc style="display:none">
 <td><input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
      title="Transfer Source" tabindex=4
      value="%PATWEB89.04.193.0" id=trnsfsrc
      onchange="validateCode(9,trnsfsrc,trandesc);">
     <input type=text size=27 name=trandesc notab id=trandesc
      class=Readonly readonly value="%PATWEB89.04.193.1">
     <img src="../images/SearchIcon.gif" class=Icon
      onclick="TransferSourceFrame(trnsfsrc,trandesc)"></td>
</tr>
</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>
<span id=patientinshd style="display:none">
<td class=DataLabel>Patient Insurance</td>
</tr>
</span>
<div id=insurerhd style="display:none">
<td class=DataLabel>Insurer</td>
</tr>
</div>
<div id=insurer style="display:none">
    <select name=nzspr014 title="Insurer" tabindex=30 id=nzspr014
     value="%PATWEB89.04.955.014.0" onchange="CheckIns();">
    <option value=""></option>
    %PATWEB89.04.955.014.2
    </select></td></tr>
</div>

<div id="InsurerText" style="display:none">
   <input type="text" size=60 maxlength=50 name=icomment id=icomment tabindex=31
         class=Mandatory value="%PATWEB89.04.999.012" title="Insurer Free Text">
</div>

<span id=insurerblank style="display:none">
   <input type=hidden name=nzspr014>
</span>
<span id=approvalsightedhd style="display:none">
<td class=DataLabel>Prior Approval Sighted</td>
</tr>
</span>
<span id=claimnumberhd style="display:none">
<td class=DataLabel>Claim Number</td>
</tr>
</span>
<span id=claimnumber style="display:none">
    <td class=DataLabel>
        <input type=text name=nzspr017 size=20 maxlength=20 tabindex=26
         title="Claim Number" value="%PATWEB89.04.955.017"></td>
</span>
<span id=claimnumberblank style="display:none">
   <input type=hidden name=nzspr017 value="%PATWEB89.04.955.017">
</span>
<span id=approvaldatehd style="display:none">
<td class=DataLabel>Approval Expiry Date</td>
</tr>
</span>
<span id=approvaldate style="display:none">
        <td><input type=text size=12 name=nzspr024 title="Approval Expiry Date"
              onblur="checkDate(this,'ApprovalDate')"; id=nzspr024
              tabindex=27 value="%PATWEB89.04.955.030">
         <img notab src=../images/CalendarLookup.gif class=Icon
          onclick="DateLookupFrame(nzspr024);">
        <img notab src=../images/DateTimeStamp.gif class=Icon
         onclick="SetCurrentDateTime(nzspr024,null);">
      </td></tr>
</span>
<span id=approvaldateblank style="display:none">
   <input type=hidden name=nzspr024 value="%PATWEB89.04.955.024">
</span>
<span id=commentshd style="display:none">
<td class=DataLabel>Comments</td>
</tr>
</span>
<span id=comments style="display:none">
    <td><input type=text name=nzspr019 size=50 maxlength=30 tabindex=33
         id=nzspr019 value="%PATWEB89.04.955.019"> </td>
    </td></tr>
</span>
<span id=commentsblank style="display:none">
   <input type=hidden name=nzspr019 value="%PATWEB89.04.955.019">
</span>
<script language="Javascript">
 setClaim();
 document.UpdateForm.ptmis013.className="ReadOnly"
 document.UpdateForm.ptmis026.className="ReadOnly"
 document.UpdateForm.nzspr010.className="ReadOnly"
 document.UpdateForm.nzspr007.className="ReadOnly"
if ("%PATWEB89.04.905" == "1") {
  alert("Warning: Patient is currently admitted");
} 
</script>
