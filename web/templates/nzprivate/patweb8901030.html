<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nzprivate">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/admission.js"></script>
<script type="text/javascript">
function updateDiag() {
  p=document.UpdateForm
  p.nzspr010.value=p.mbsdesc1.value
}
function ShowAdmissionWeight(theForm) {
  BabyAge.style.display="none";
  document.UpdateForm.ptmis051.className="";
  document.UpdateForm.ptmis051.min="0";
  document.UpdateForm.agebmand.value=0;
//
  if(isWhitespace(theForm.ptcnbage.value) ||
     isWhitespace(theForm.pbdate.value) ||
     isWhitespace(theForm.d_ptmis001.value)) {
     return;
  }
//
  Bday = new Date();
  Bday.setFullYear(theForm.pbdate.value.substring(6,11));
  monstr= theForm.pbdate.value.substring(3,6)
  if (monstr=="Jan" || monstr=="JAN" || monstr=="jan") mon=00
  if (monstr=="Feb" || monstr=="FEB" || monstr=="feb") mon=01
  if (monstr=="Mar" || monstr=="MAR" || monstr=="mar") mon=02
  if (monstr=="Apr" || monstr=="APR" || monstr=="apr") mon=03
  if (monstr=="May" || monstr=="MAY" || monstr=="may") mon=04
  if (monstr=="Jun" || monstr=="JUN" || monstr=="jun") mon=05
  if (monstr=="Jul" || monstr=="JUL" || monstr=="jul") mon=06
  if (monstr=="Aug" || monstr=="AUG" || monstr=="aug") mon=07
  if (monstr=="Sep" || monstr=="SEP" || monstr=="sep") mon=08
  if (monstr=="Oct" || monstr=="OCT" || monstr=="oct") mon=09
  if (monstr=="Nov" || monstr=="NOV" || monstr=="nov") mon=10
  if (monstr=="Dec" || monstr=="DEC" || monstr=="dec") mon=11
  Bday.setMonth(mon);
  Bday.setDate(theForm.pbdate.value.substring(0,2));
//
  Adat = new Date();
  Adat.setFullYear(theForm.d_ptmis001.value.substring(6,11));
  monstr= theForm.d_ptmis001.value.substring(3,6)
  if (monstr=="Jan" || monstr=="JAN" || monstr=="jan") mon=00
  if (monstr=="Feb" || monstr=="FEB" || monstr=="feb") mon=01
  if (monstr=="Mar" || monstr=="MAR" || monstr=="mar") mon=02
  if (monstr=="Apr" || monstr=="APR" || monstr=="apr") mon=03
  if (monstr=="May" || monstr=="MAY" || monstr=="may") mon=04
  if (monstr=="Jun" || monstr=="JUN" || monstr=="jun") mon=05
  if (monstr=="Jul" || monstr=="JUL" || monstr=="jul") mon=06
  if (monstr=="Aug" || monstr=="AUG" || monstr=="aug") mon=07
  if (monstr=="Sep" || monstr=="SEP" || monstr=="sep") mon=08
  if (monstr=="Oct" || monstr=="OCT" || monstr=="oct") mon=09
  if (monstr=="Nov" || monstr=="NOV" || monstr=="nov") mon=10
  if (monstr=="Dec" || monstr=="DEC" || monstr=="dec") mon=11
  Adat.setMonth(mon);
  Adat.setDate(theForm.d_ptmis001.value.substring(0,2));
//
  if (Adat.getTime() >= Bday.getTime()) {
    daysold = Adat.getTime() - Bday.getTime();
    daysold = Math.floor(daysold / (1000 * 60 * 60 * 24));
  } else {
    return;
  }
//
  if(daysold <= theForm.ptcnbage.value) {
    BabyAge.style.display="";
    document.UpdateForm.ptmis051.className="Mandatory Number";
    document.UpdateForm.ptmis051.min="1";
    document.UpdateForm.agebmand.value=1;
  }
}
function SubmitUpd() {
  isChangedExpectedDate();
  document.UpdateForm.ptmis020.value=document.UpdateForm.nzspr010.value;
  MandatoryOk=validateMandatory(document.UpdateForm)
  if (MandatoryOk) {
    SetLinkACC(UpdateForm,"ADM");
    if (document.getElementById("d_nzspr013").checked==true) {
       document.getElementById("nzspr013").value="1";
    } else {
       document.getElementById("nzspr013").value="0";
    }
    if(document.UpdateForm.ptmis027.value.substr(9,1)=="P"||
       document.UpdateForm.ptmis027.value.substr(9,1)=="F"){
      if(document.UpdateForm.nzspr007.value==""){
        if(!valContract(document.UpdateForm)){return;}}
    }
    document.UpdateForm.submit();
   }
}
function FollowUpConvertToNumeric()
{
  var ptmis080 = document.getElementById("ptmis080");
  FollowUp == "Yes" ?  ptmis080.value = 1 : ptmis080.value = 0;
}

function checkboxtabindex() {
  var d = document.getElementById("d_ptmis080");
  d.tabIndex = 8;
  var d = document.getElementById("d_ptmis079");
  d.tabIndex = 18;
  var d = document.getElementById("d_nzspr013");
  d.tabIndex = 19;
  var d = document.getElementById("d_nzspr016");
  d.tabIndex = 22;

  if (document.getElementById("nzspr013").value=="1") {
    document.getElementById("d_nzspr013").checked=true;
  }
}
function CheckIns() {
  f = document.UpdateForm;
  if(f.nzspr014.value.substr(3,1)=="O") {
    savicomm = "";
    if (document.getElementById("icomment") !=undefined) {
      savicomm = document.getElementById("icomment").value;
    }
    InsurerField.innerHTML=InsurerText.innerHTML;
    f.icomment.value=trim(savicomm);
  }
  else {
    InsurerField.innerHTML="";
  }
}
function InsuranceUpd() {
  f = document.UpdateForm;
  ind7 = f.ptmis027.value.substr(9,1);
  ind10 = f.ptmis027.value.substr(12,1);
  ind27 = f.ptmis027.value.substr(74,1);
//alert('ind7=' + ind7 + ' ind10=' + ind10 + ' ind27=' + ind27);
  if (ind10=="A") {
    if (document.getElementById("d_nzspr013").checked==true) {
      f.nzspr014.className="Mandatory";
      f.nzspr014.disabled=false;
      f.nzspr015.className="Mandatory";
      f.nzspr015.disabled=false;
      f.nzspr017.disabled=false;
      f.nzspr024.disabled=false;
      f.d_nzspr016.disabled=false;
    }
    else {
      if (ind27=="I") {
        f.nzspr014.className="Mandatory";
        f.nzspr014.disabled=false;
      }
      else {
        f.nzspr014.className="";
        f.nzspr014.disabled=true;
        f.nzspr014.value="";
        InsurerField.innerHTML="";
      }
      f.nzspr015.className="";
      f.nzspr015.disabled=true;
      f.nzspr017.disabled=true;
      f.nzspr024.disabled=true;
      f.d_nzspr016.disabled=true;
      f.d_nzspr016.checked=false;
    }
  }
  else {
    if (ind27=="I") {
      f.nzspr014.className="Mandatory";
      f.nzspr014.disabled=false;
    }
    f.nzspr015.disabled=false;
    f.d_nzspr016.disabled=false;
    f.nzspr017.disabled=false;
    f.nzspr024.disabled=false;
  }
  CheckIns();
}
</script>
</head>
%START.OF.PAGE
<body onload="FollowUpConvertToNumeric();PageLoad(event);DisplayTrnSrc();UpdateForm.ptmis009.focus();
checkboxtabindex();CheckIns();InsuranceUpd();"> 
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
FollowUp = "%PATWEB89.01.199.010";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<form name=linkForm action=patweb89.pbl method=post style=margin:0>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.101">
</form>
<form name=UpdateForm method=post style=margin:0>
<input type=hidden name=reportno value="2">
<input type=hidden name=template value="030">
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
<input type="hidden" name="updatety" value="6">
<input type="hidden" name="allocate" value="1">
<input type="hidden" name="redirect" value="%PATWEB89.01.001.patweb89.09.001">
<input type="hidden" name="chckname" value="0">
<input type="hidden" name="emradmit" value="0">
<input type="hidden" name="emradmis" value="0">
<input type="hidden" name="newbmand" value="0">
<input type="hidden" name="agebmand" value="0">
<input type="hidden" name="ptcnueoc" value="%PATWEB89.01.925">
<input type="hidden" name="ptmis027" value="%PATWEB89.01.126.3">
<input type=hidden name=retcount value="">
<input type=hidden name=retcontr value="">
<input type=hidden name=retcdesc value="">
<input type=hidden name=nzhosp value="">
<input type="hidden" name="ptcnbage" value="%STANDARD.01.025.021.046.1.3">
<input type="hidden" name="pbdate"   value="%PATWEB89.01.020">
<input type="hidden" name="ptmis020" value="%PATWEB89.01.121">
<input type="hidden" name="chdisdte" id=chdisdte value="1">
<input type=hidden name=o_ptmis030 value="%PATWEB89.01.129">
<input type=hidden name=admnstat value="%PATWEB89.01.924">
<input type=hidden name="nzspr013" id="nzspr013" value="%PATWEB89.01.955.013">
<table border=1 colspan=1 width=100% cellspacing=1 cellpadding=1 >

<tr><td class=HeadingCell align=center>
    Update Admission Details</tr>
<tr>
<tr><td>
    <table width=100%  border=0 class=TableBody cellpadding=2 cellspacing=2>
<tr><td width=50%>
    <table border=0 width=100% class=TableBody cellpadding=0 cellspacing=0>
       <tr><td class=DataLabel>Admission Date</td>
           <td class=DataLabel><input type="text" readonly 
            size="12" name=d_ptmis001 value="%PATWEB89.01.102" 
            title="Admission Date" class="Mandatory Readonly"
            onblur="checkDate(this,'Admission Date')">
       Time 
       <input type=text name=ptmis002 size=8 
        title="Admission Time" class="Readonly" readonly
        value="%PATWEB89.01.103" onblur="checkTime(this,'AdmissionTime');">
          </td>
      <td class=DataLabel>%STANDARD.01.017.CL</td>
      <td><input type=text class=readonly readonly size=30
              value="%PATWEB89.01.126.0">
       </td></tr>

      <tr><td class=DataLabel>Referral Source</td>
          <td><select name=ptmis009 title="Referral Source" tabindex=1
               onchange="DisplayTrnSrc()" class="Mandatory">
                 <option> </option>
                 %PATWEB89.01.110.2
                 </select></td>
          <td class=DataLabel>Admitting Doctor</td>
          <td><input type="text" size=8 maxlength=6 class=readonly
               readonly name=ptmis007
               value="%PATWEB89.01.108.003" title="Admitting Doctor"
               onblur="UpCase(this); validateCode(3,ptmis007,doctnam2)">
              <input type=text size=25 name=doctnam2
               class=readonly readonly value="%PATWEB89.01.108.002"></td>
      </tr>

      <tr><td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>
        <td class=DataLabel>Primary Procedure</td>
        <td class=DataLabel>
        <input type=text name=ptmis026 size=10 maxlength=9 
        onblur='validateCode(4,ptmis026,mbsdesc1,updateDiag)'
        value="%PATWEB89.01.125" readonly class=readonly>
        <input type=text notab readonly name=mbsdesc1 size=35
        value="%PATWEB89.01.180" class=readonly>
       </td>
      </tr>

      <tr><td>Admitting Point</td>
          <td><select name=ptvis046 class=Mandatory tabindex=3>
               <option> </option>
                %PATWEB89.01.290.2
               </select>
          </td>
          <td class=DataLabel>Full Description</td>
          <td><input type=text name=nzspr010 title="Procedure Description"
               size=80 maxlength=80 value="%PATWEB89.01.955.010"
               class=readonly readonly>
          </td>
       </tr>

      <tr><td class=DataLabel>Ward / Bed </td>
          <td><input type=hidden name=bedstat1>
             <input type=hidden name=warddesc>
             <input  type=hidden name=ptmis068 value="%PATWEB89.01.449.1">
             <select name=ptmis004 disabled>
              <option> </option>
              %PATWEB89.01.449.2
             </select>
             <input type=text name=ptmis005 maxlength=3 size=3 
               value="%PATWEB89.01.106" readonly class=readonly></td>
        <td class=DataLabel>Contract</td>
        <td><input type=text size=6 maxlength=6 name=ptmis013
         title="Health Fund" readonly class=readonly
         onchange="validateCode(16,document.UpdateForm.ptmis013,funddesc);"
                   value="%PATWEB89.01.114.0">
        <input type=text size=35 name="funddesc" maxlength="30" 
         value="%PATWEB89.01.114.1" readonly notab>
        <input type="hidden" name="dummy">
        </td>
      </tr>

      <tr><td class=DataLabel>Intended Length of Stay</td>
        <td>
        <input type=text size=5 maxlength=5 name=ptmis030 tabindex=5
         title='Intended Length of Stay'
         class=Integer onblur="checkInteger(this,this.value);"
             value="%PATWEB89.01.129">
        </td>
        <td class=DataLabel>Approval Number</td>
        <td class=DataLabel>
        <input type=text name=nzspr015 size=20 maxlength=20 tabindex=15
         title="Approval Number" value="%PATWEB89.01.955.015"></td>
    </tr>

      <tr><td class=DataLabel>%STANDARD.01.017.A </td>
          <td><input type=text class=readonly readonly
                 value="%PATWEB89.01.111.0">
          </td>
         <td><div id=ClaimNumberHeading></div></td>
         <td><div id=ClaimNumber></div></td>
      </tr>

      <tr><td class=DataLabel>Readmission Indicator</td>
          <td><select name=ptmis042 title="Readmission Indicator" tabindex=6>
                <option> </option>
                 %PATWEB89.01.138.2
              </select></td>
         <td><div id=ApprovalDateHeading></div></td>
         <td><div id=ApprovalDate></div></td>
      </tr>

      <tr><td class=DataLabel>Diet</td>
          <td><select name=ptmis028 tabindex=7>
              <option></option>
              PATWEB89.01.065.2
              %PATWEB89.01.127.2
              </select></td>
         <td>&nbsp;</td>
         <td>&nbsp;</td>
      </tr>

     <tr><td>&nbsp;</td><td>&nbsp;</td>
        <td class=DataLabel>Credit Card Details on File</td>
        <td><input type="hidden" value="%PATWEB89.01.199.009"  name="ptmis079"
                      id="ptmis079" class="CheckBox" />
        </td>
      </tr>

      <tr><td class=DataLabel>Follow-up for Implant Invoicing</td>
               <td><input type="hidden" value="" 
                     class="CheckBox" name="ptmis080" id="ptmis080" /></td>
        <td><div id=PatientInsHeading></div></td>
        <td><input type="CheckBox" id="d_nzspr013" name="d_nzspr013" 
             onclick="InsuranceUpd();" />
        </td>
    </tr>
    <tr><td>&nbsp;</td><td>&nbsp;</td><td><div id=InsurerHeading></div></td>
          <td><table><tr><td><div id="Insurer"></div></td>
                         <td><div id="InsurerField"></div></td></tr></table>
          </td></tr>

    <tr><td>&nbsp;</td><td>&nbsp;</td><td><div id=ApprovalSightedHeading></div>
        </td>
        <td><input type="hidden" class="CheckBox" id="nzspr016" name="nzspr016"
                    value="%PATWEB89.01.955.016" />
        </td>
    </tr>

     <tr><td>&nbsp;</td><td>&nbsp;</td><td><div id=CommentsHeading></div></td>
         <td><div id=Comments></div></td></tr>

    <tr><td>&nbsp;</td><td>&nbsp;</td>
    <td class=DataLabel>Assigned Contract Procedure Code</td>
    <td><input type=text name="nzspr007" title="Contract Procedure Code" 
           tabindex=30
           value="%PATWEB89.01.955.007" readonly class="Readonly"></td></tr>

<tr><td colspan=2 rowspan=4>
         <table width=100%>
<tr><td>
<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Admission Weight</td>
    <td><input type=text name=ptmis051 size=8 maxlength=6 title="Admission Weight" 
         value="%PATWEB89.01.186" onchange=justifyRight(this);>grams</td></tr>
</table>
</span>
</td></tr>
<tr><td><div id=NewBorn></div>
</td></tr>
<tr><td rowspan=2>
<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058  id=ptmis058
         onblur="checkDate(this,'ReferralDate')">
         <img notab src=../images/CalendarLookup.gif class=Icon
          onclick="DateLookupFrame(ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
    <td><input type=text size=12 name=ptmis059  id=ptmis059
         onblur="checkDate(this,'SpecConDate')">
         <img notab src=../images/CalendarLookup.gif class=Icon
          onclick="DateLookupFrame(ptmis059);"></td></tr>
</table>
</span>
</td><tr>
</table>
</td><td></tr>

</table>
</td>
</tr>

      <tr align=center>
       <td colspan=4 align=center><br>
       <input type=button value="Update" class=button tabindex=43 
        id="pat89sub" onclick="tempDisable(this);SubmitUpd()">
       <input type=button value="Cancel" class=button tabindex=44
        onclick="history.go(-1);">
    </table>
</td></tr>
</table>
</form>
<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
<input type=hidden name=MenuType value="%PATWEB89.01.088">
</form>
<script language=javascript>
//
for (var i=0;i<document.UpdateForm.ptmis004.length;i++){
if (document.UpdateForm.ptmis004.options[i].value=="%PATWEB89.01.105.1"){
    document.UpdateForm.ptmis004.selectedIndex=i}};
//
ShowAdmissionWeight(UpdateForm);
</script>
<span id=transferhd style="display:none" class=DataLabel>
Transfer Source
</span>
<span id=transfersrc style="display:none">
<input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
      title="Transfer Source" tabindex=2 id=trsnfsrc
      value="%PATWEB89.01.193.0"
      onchange="validateCode(9,trnsfsrc,trandesc);">
     <input type=text size=27 name=trandesc notab id=trandesc
      class=Readonly readonly value="%PATWEB89.01.193.1">
     <img src="../images/SearchIcon.gif" class=Icon
      onclick="TransferSourceFrame(trnsfsrc,trandesc)">
</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>
<span id=patientinshd style="display:none" class=DataLabel>
Patient Insurance
</span>
<div id=insurerhd style="display:none" class=DataLabel>
Insurer
</div>

<div id=insurer style="display:none">
    <select name=nzspr014 title="Insurer" tabindex=20 
     value="%PATWEB89.01.955.014.0" onchange="CheckIns();">
    <option></option>
    %PATWEB89.01.955.014.2
    </select>
</div>

<div id="InsurerText" style="display:none">
   <input type="text" size=60 maxlength=50 name=icomment id=icomment tabindex=21
         class=Mandatory value="%PATWEB89.01.999.012" title="Insurer Free text">
</div>

<span id=insurerblank style="display:none">
   <input type=hidden name=nzspr014>
</span>
<span id=approvalsightedhd style="display:none" class=DataLabel>
Prior Approval Sighted
</span>
<span id=claimnumberhd style="display:none" class=DataLabel>
Claim Number
</span>
<span id=claimnumber style="display:none" class=DataLabel>
        <input type=text name=nzspr017 size=20 maxlength=20 tabindex=16
         title="Claim Number" value="%PATWEB89.01.955.017">
</span>
<span id=claimnumberblank style="display:none">
   <input type=hidden name=nzspr017 value="%PATWEB89.01.955.017">
</span>
<span id=approvaldatehd style="display:none" class=DataLabel>
Approval Expiry Date
</span>
<span id=approvaldate style="display:none">
        <input type=text size=12 name=nzspr024 title="Approval Expiry Date"
              tabindex=17 id=nzspr024
              onblur="checkDate(this,'ApprovalDate');"
              value="%PATWEB89.01.955.030">
         <img notab src=../images/CalendarLookup.gif class=Icon
          onclick="DateLookupFrame(nzspr024);">
        <img notab src=../images/DateTimeStamp.gif class=Icon
         onclick="SetCurrentDateTime(nzspr024,null);">
</span>
<span id=approvaldateblank style="display:none">
   <input type=hidden name=nzspr024 value="%PATWEB89.01.955.024">
</span>
<span id=commentshd style="display:none" class=DataLabel>
Comments
</span>
<span id=comments style="display:none">
    <input type=text name=nzspr019 size=50 maxlength=30 tabindex=29
         value="%PATWEB89.01.955.019">
</span>
<span id=commentsblank style="display:none">
   <input type=hidden name=nzspr019 value="%PATWEB89.01.955.019">
</span>
<script language=javascript>
 setClaim();
 document.UpdateForm.ptmis026.className="readonly";
 document.UpdateForm.ptmis013.className="readonly";
 document.UpdateForm.funddesc.className="readonly";
</script>
