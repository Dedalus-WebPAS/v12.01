<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nzprivate">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"      content="true">
<script type="text/javascript" src="../js/rcpweb03.js"></script>
<script type="text/javascript">
function init() {
if (!isWhitespace(AddForm.rcpbk001.value)) {   // Receipt Number Allocated
  if (AddForm.rcpbk007.value==1) {             // Received from Health Fund
    AddForm.patdebtr.checked=false;
    AddForm.hlthfund.value=AddForm.rcpbk008.value;
  }
  else if (AddForm.rcpbk007.value==2) {        // Received from Insurance  
    AddForm.patdebtr.checked=false;
    AddForm.hlthfund.value="";
    AddForm.hfundgrp.value="";
  }
  else if (AddForm.rcpbk007.value==3) {        // Received from Govt Agency
    AddForm.patdebtr.checked=false;
    AddForm.hlthfund.value="";
    AddForm.hfundgrp.value="";
  }
  else if (AddForm.rcpbk007.value==4) {        // Received from Fund Group
    AddForm.patdebtr.checked=false;
    AddForm.hlthfund.value="";
    AddForm.hfundgrp.value=AddForm.rcpbk008.value;
  }
  else {                                       // Receiver from Patient
    AddForm.patdebtr.checked=true;
    AddForm.hlthfund.value="";
    AddForm.hfundgrp.value="";
  }
  // disable receipt header
  GetCookieCashierPassword();
  AddForm.allctbut.disabled=false;            // Allocate Button
  AddForm.allctbut.className="RedButton";
  document.AddForm.allctbut.focus();
  AddForm.rcpbk004.className="Readonly";      // Drawer
  AddForm.rcpbk004.disabled=true;
  AddForm.password.className="Readonly";      // Password
  AddForm.password.readOnly=true;
  AddForm.rcpbk014.className="Readonly";      // cheque account number
  AddForm.rcpbk014.readOnly=true;
  AddForm.rcpbk014.disabled=true;             
  AddForm.patdebtr.disabled=true;             // Received From Patient debtor
  AddForm.hlthfund.className="Readonly";      // Received From Health fund
  AddForm.hlthfund.readOnly=true;
  AddForm.hlthbutt.disabled=true;
  AddForm.clhfbutt.disabled=true;
  AddForm.hfundgrp.className="Readonly";      // Health Fund Group
  AddForm.hfundgrp.readOnly=true;
  AddForm.hfundgrp.disabled=true;             
  AddForm.rcpbk002.className="Readonly";      // Payment Date
  AddForm.rcpbk002.readOnly=true;
  AddForm.currbutt.disabled=true;
  AddForm.cldtbutt.disabled=true;
  document.AddForm.allctbut.tabIndex=1;
  document.AddForm.rcpbt023.tabIndex=2;                // Payment Type
  document.AddForm.canclbut.tabIndex=3;
}
else {                                        // Receipt Not Allocated yet
  GetCookieCashierPassword();
  if (isWhitespace(AddForm.rcpbk014.value)) {
    for (var i=0; i < AddForm.rcpbk014.length; i++) {
      if (AddForm.rcpbk014.options[i].value==AddForm.defchqno.value){
        AddForm.rcpbk014.selectedIndex=i; }
    }
  }
  checkOtherFields();
  AddForm.rcpbk002.value=AddForm.currdate.value;
  AddForm.allctbut.disabled=true;
  AddForm.allctbut.className="button";
  AddForm.rcpbk004.tabIndex=1;                // Drawer
  AddForm.password.tabIndex=2;                // Password
  AddForm.patdebtr.tabIndex=3;                // Received From Patient debtor
  AddForm.hlthfund.tabIndex=4;                // Received From Health fund
  AddForm.hfundgrp.tabIndex=5;                // Health Fund Group
  AddForm.rcpbk002.tabIndex=6;                // Payment Date
  AddForm.rcpbt023.tabIndex=7;                // Payment Type
  AddForm.canclbut.tabIndex=8;
}
}
//------------------------------------------------------------
//  Function : When Patient/Debtor box is checked  
//  Health Fund, Insr, and Gov't Agency are disabled
//------------------------------------------------------------
function checkOtherFields() {
  if (AddForm.patdebtr.checked==true) {
    AddForm.hlthfund.value="";
    AddForm.hlthfund.className="Readonly";      // Received From Health fund
    AddForm.hlthfund.readOnly=true;
    AddForm.hlthfund.tabIndex=-1;
    AddForm.hlthbutt.disabled=true;
    AddForm.clhfbutt.disabled=true;
    AddForm.hfundgrp.selectedIndex=0;
    AddForm.hfundgrp.className="Readonly";      // Health Fund Group
    AddForm.hfundgrp.readOnly=true;
    AddForm.hfundgrp.disabled=true;             
  }
  else {
    AddForm.hlthfund.className="";      // Received From Health fund
    AddForm.hlthfund.readOnly=false;
    AddForm.hlthfund.tabIndex=4;
    AddForm.hlthbutt.disabled=false;
    AddForm.clhfbutt.disabled=false;
    AddForm.hfundgrp.className="";      // Health Fund Group
    AddForm.hfundgrp.readOnly=false;
    AddForm.hfundgrp.disabled=false;             
  }
}
//------------------------------------------------------------
//  Function : Show Add Receipt Type Dframe
//------------------------------------------------------------
function AddReceipt() {
  if (isWhitespace(AddForm.rcpbt023.value)) {
    return;
  }
  if (ValidateReceipt()) {
     linkurl="rcpweb03.pbl?reportno=2&template=002" +
             "&paymtype=" + AddForm.rcpbt023.value.replace(/ /g,"+") +
             "&hlthfund=" + AddForm.hlthfund.value.replace(/ /g,"+") +
             "&hfundgrp=" + AddForm.hfundgrp.value.replace(/ /g,"+");
     ShowDetail(linkurl);
  }
}
function ShowDetail(linkurl) {
  var width = 440;
  var left=(document.body.clientWidth-width)/2;
  DFrameLink(linkurl,150,left,width,400);
}
//------------------------------------------------------------
//  Function : Show Update/Delete Receipt Type Dframe
//------------------------------------------------------------
function UpdateReceipt(receiptno,uniqueno,paycode) {
     linkurl="rcpweb03.pbl?reportno=2&template=003" +
             "&paymtype=" + paycode.replace(/ /g,"+") +
             "&rcpbk001=" + receiptno.replace(/ /g,"+") +
             "&rcpbt003=" + uniqueno.replace(/ /g,"+") +
             "&printflg=" + AddForm.printflg.value.replace(/ /g,"+") +
             "&selprint=" + AddForm.selprint.value.replace(/ /g,"+") +
             "&nocopies=" + AddForm.nocopies.value.replace(/ /g,"+");
     ShowDetail(linkurl);
}
//------------------------------------------------------------
//  Function : Cancel All Receipt Details Entered
//------------------------------------------------------------
function CancelReceipt(drawer) {
  if (isWhitespace(AddForm.rcpbk001.value)) {
     linkurl="rcpweb03.pbl?reportno=2&template=001" +
             "&rcpbk004=" + drawer.value.replace(/ /g,"+");
     location.href=linkurl;
  }
  else {
    AddForm.updttype.value="C";
    AddForm.submit();
  }
}
</script>
</head>
%START.OF.PAGE
<body onload=PageLoad(event);>
<form name=AddForm method=get action=rcpweb03.pbl>
<table width=100% align=center border=0 cellspacing=0>
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=001>
<input type=hidden name=updttype>
<input type=hidden name=nextpage value=1>
<input type=hidden name=redirect value="rcpweb03.pbl?reportno=2&template=1">
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden name=dummy>
<input type=hidden name=accmtotl value="%RCPWEB03.02.306">
<input type=hidden name=defchqno value="%RCPWEB03.02.309">
<input type=hidden name=rcpbk001 value="%RCPWEB03.02.001">
<input type=hidden name=rcpbk003 value="%RCPWEB03.02.003">
<input type=hidden name=rcpbk007 value="%RCPWEB03.02.007">
<input type=hidden name=rcpbk008 value="%RCPWEB03.02.008">
<input type=hidden name=printflg value="%RCPWEB03.02.336">
<input type=hidden name=selprint value="%RCPWEB03.02.337">
<input type=hidden name=nocopies value="%RCPWEB03.02.338">

<tr><td class=HeadingCell align=center colspan=2>
     Input Receipts</td></tr>
<tr><td>
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td colspan=8>&nbsp;</td></tr>
<tr><td class=DataLabel width=12%>Cash Drawer</td>
    <td width=35%><select name=rcpbk004 title="Cash Drawer" class=Mandatory 
                onchange="getChqAcct(document.AddForm.rcpbk004,
                                     document.AddForm.rcpbk014,
                                     document.AddForm.defchqno);
                          checkPR(document.AddForm.rcpbk004,
                                  document.AddForm.password);">
        <option value=""></option>
        %RCPWEB03.02.301.1
        </select></td>
    <td class=DataLabel width=7%>Password</td>
    <td><input size=12 type=password name=password title="Password" 
               onblur="checkPasswrd(document.AddForm.rcpbk004,
                                    document.AddForm.password);"></td>
</tr>
</table>
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=12%>Cheque Account</td>
    <td><select name=rcpbk014 title="Cheque Account Number" class=Mandatory>
        <option value=""></option>
        %RCPWEB03.02.327
        </select>
    </td>
</tr>
</table>
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td class=DataLabel width=12%>Cashier</td>
    <td><input size=20 type=text name=wusrname title="Cashier" 
               value="%RCPWEB03.02.303" class=readOnly readonly tabindex=-1>
    </td>
    <td colspan=6>&nbsp;</td>     
</tr>
<tr><td class=DataLabel width=12%>Received From</td>
    <td width=15%>Patient/Debtor&nbsp;<input type=checkbox name=patdebtr 
             title="Patient/Debtor" value="1" 
             onclick="checkOtherFields();"></td>
    <td width=7%>Contract</td>
    <td><input type=text name=hlthfund title="Contract"
               size=6 maxlength=6 onblur='validateCode(16,
                                          document.AddForm.hlthfund,
                                          document.AddForm.dummy)'>
        <img src=../images/SearchIcon.gif class=Icon name=hlthbutt
             onclick="HFundSearchFrame(document.AddForm.hlthfund,
                                       document.AddForm.dummy);">
        <img src="../images/erase.gif" name=clhfbutt
             onClick="clrFields(document.AddForm.hlthfund);">
    </td>
    <td>Fund Group</td>
    <td><select name=hfundgrp title="Fund Group">
        <option value=""></option>
        %RCPWEB03.02.368.2
        </select>
    </td>
<!--
    <td>Insurance</td>
    <td><input type=text name=insrcode title="Insurance"
               size=6 maxlength=6 onblur="validateCode(36,
                                          document.AddForm.insrcode,
                                          document.AddForm.dummy);">
        <img src="../images/SearchIcon.gif" name=insrbutt
             onclick="InsuranceCodeSearch(document.AddForm.insrcode,
                                          document.AddForm.dummy);">
        <img src="../images/erase.gif" name=clicbutt
             onClick="clrFields(document.AddForm.insrcode);">
    </td>
    <td>Gov't Agency</td>
    <td><select name=govtagnc title="Gov't Agency">
        <option value=""></option>
         RCPWEB03.02.304
        </select>
    </td>
-->
<input type=hidden name=insrcode value="">
<input type=hidden name=govtagnc value="">
</tr>
<tr><td class=DataLabel>Date of Payment</td>
    <td><input type=text name=rcpbk002 title="Date of Payment"
               value="%RCPWEB03.02.002"
               size=12 maxlength=12 class="PastDate Mandatory"
               onblur="checkDate(this,'Date of Payment');">
        <img notab src="../images/DateTimeStamp.gif" class="Icon" name=currbutt
             alt="Current" date="AddForm.rcpbk002">
        <img notab src="../images/DateLookup.gif" class="Icon" name=cldtbutt
             alt="Show Calendar" date="AddForm.rcpbk002"></td>
    <td colspan=6>&nbsp;</td>     
</tr>
</table>
<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
<tr><td colspan=2>&nbsp;</td>
    <td width=12%>Receipt Number</td>
    <td align=right width=8%>&nbsp;<b>%RCPWEB03.02.001</b></td>
</tr>
<tr><td>&nbsp;</td>
    <td align=center>
    <input type=button value=Allocate class=RedButton name=allctbut
     id=allctbut
     onclick='tempDisable(this);allocatePayment();'>
    <input type=button value=Cancel class=button name=canclbut
     id=canclbut
     onclick='tempDisable(this);CancelReceipt(document.AddForm.rcpbk004);'>
    </td>
    <td>Accumulative Total</td>
    <td align=right><b>$%RCPWEB03.02.306</b></td>
</tr>
<tr><td colspan=5 align=center><hr width=100%></td></tr>
</table>

<table width=95% align=center border=0 cellspacing=2 cellpadding=1>
    <tr><td class=HeadingCell width=12%>&nbsp;Payment Type</td>
    <td class=HeadingCell width=10% align=right>Amount&nbsp;</td>
    <td class=HeadingCell width=75%>&nbsp;Reference</td></tr>
    %RCPWEB03.02.305.1
<tr><td><select name=rcpbt023 id=rcpbt023 title="Payment Type" class=Mandatory
                onchange="AddReceipt();">
        <option value=""></option>
        %RCPWEB03.02.123.2
        </select></td>
    <td colspan=2>&nbsp;</td>
</tr>
</table>
</tr></td>
</table>
</form>
