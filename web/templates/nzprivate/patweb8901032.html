<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nzprivate">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/preadmission.js">    </script>
<script type="text/javascript">    
function updateDiag() {
 p=document.UpdateForm
 p.nzspr010.value=p.mbsdesc1.value;
}
function checkboxtabindex() {
  var d = document.getElementById("d_ptmis079");
  d.tabIndex = 30;
  d = document.getElementById("d_nzspr013");
  d.tabIndex = 31;
  d = document.getElementById("d_nzspr016");
  d.tabIndex = 34;

  if (document.getElementById("ptmis079").value=="1") {
    document.getElementById("d_ptmis079").checked=true;
  }

  if (document.getElementById("nzspr013").value=="1") {
    document.getElementById("d_nzspr013").checked=true;
  }

  if (document.getElementById("nzspr016").value=="1") {
    document.getElementById("d_nzspr016").checked=true;
  }

}
function SubmitAdm() {
  p=document.UpdateForm;
  validateSuspension(p.urnumber,p.ptmis001,p.datefrom,p.dateto);
  p.ptmis020.value=p.nzspr010.value;
  if(p.datefrom.value!='0'){
       ans=confirm("Warning : Patient has a Suspension record for period \n" +
             "\t" + p.datefrom.value  + " - " + p.dateto.value);
       if (ans!=true) {
          return; }
  } 
  document.UpdateForm.redirect.value="patweb98.pbl?reportno=01&template=001"
  + "&urnumber=" + document.UpdateForm.urnumber.value
  + "&admissno=";
  SetLinkACC(UpdateForm,"PRE");
  if(document.UpdateForm.ptmis027.value.substr(9,1)=="P"||
  document.UpdateForm.ptmis027.value.substr(9,1)=="F"){
    document.UpdateForm.ptmis004.value=document.UpdateForm.ptmis068.value
    if(document.UpdateForm.nzspr007.value==""){
      if(!valContract(document.UpdateForm)){
       return;}}
   }

  if (document.getElementById("d_ptmis079").checked==true) {
    document.getElementById("ptmis079").value="1";
  } else {
    document.getElementById("ptmis079").value="0";
  }

  if (document.getElementById("d_nzspr013").checked==true) {
      document.getElementById("nzspr013").value="1";
  } else {
      document.getElementById("nzspr013").value="0";
      document.UpdateForm.nzspr014.disabled=false;
      document.UpdateForm.nzspr015.disabled=false;
    if (document.UpdateForm.ptmis027.value.substr(12,1)=="A") {
        Insurer.innerHTML=insurerblank.innerHTML;
    }
  }

  if (document.getElementById("d_nzspr016").checked==true) {
    document.getElementById("nzspr016").value="1";
  } else {
    document.getElementById("nzspr016").value="0";
  }

  SubmitHidden(UpdateForm);
}
function InsuranceUpd() {
  f = document.UpdateForm;
  ind7 = f.ptmis027.value.substr(9,1);
  ind10 = f.ptmis027.value.substr(12,1);
  ind27 = f.ptmis027.value.substr(44,1);
//alert('ind7=' + ind7 + ' ind10=' + ind10 + ' ind27=' + ind27);
  if (ind10=="A") {
    if (document.getElementById("d_nzspr013").checked==true) {
      f.nzspr014.className="Mandatory";
      f.nzspr014.disabled=false;
      f.nzspr015.className="Mandatory";
      f.nzspr015.disabled=false;
      f.nzspr017.disabled=false;
      f.nzspr024.disabled=false;
      f.d_nzspr016.disabled=false;
    }
    else {
      if (ind27=="I") {
        f.nzspr014.className="Mandatory";
        f.nzspr014.disabled=false;
      }
      else {
        f.nzspr014.className="";
        f.nzspr014.disabled=true;
        f.nzspr014.value="";
        InsurerField.innerHTML="";
      }
      f.nzspr015.className="";
      f.nzspr015.disabled=true;
      f.nzspr017.disabled=true;
      f.nzspr024.disabled=true;
      f.d_nzspr016.disabled=true;
      f.d_nzspr016.checked=false;
    }
  }
  else {
    if (ind27=="I") {
      f.nzspr014.className="Mandatory";
      f.nzspr014.disabled=false;
    }
    f.nzspr015.disabled=false;
    f.d_nzspr016.disabled=false;
    f.nzspr017.disabled=false;
    f.nzspr024.disabled=false;
  }
  CheckIns();
}
function setCntr() {
 if(document.UpdateForm.ptmis027.value.substr(9,1)==" ") {
        document.UpdateForm.nzspr017.className="";
        document.UpdateForm.nzspr024.className="";
        document.UpdateForm.nzspr015.className="";
        document.UpdateForm.nzspr017.disabled=false;
        document.UpdateForm.nzspr024.disabled=false;
        document.UpdateForm.nzspr015.disabled=false;

       document.UpdateForm.ptmis013.value="";
       document.UpdateForm.funddesc.value="";
 }
}

function clearClaim() {
//  if (document.UpdateForm.ptmis027.value.substr(12,1)!="A") {
     if (document.getElementById("d_nzspr013").checked!=true) {
       document.UpdateForm.nzspr017.value="";
       document.UpdateForm.nzspr024.value="";
       document.UpdateForm.nzspr015.value="";
    }
// }
}

</script>
%START.OF.PAGE
<body onload="PageLoad(event);DisplayTrnSrc();UpdateForm.ptmis001.focus();
              checkboxtabindex();CheckIns();setCntr();
              createSpecialtyArray();getHCPSpecialtySelectList();
              defaultSpecialty();InsuranceUpd();
              validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form name=linkForm action=patweb89.pbl method=post style=margin:0>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.101">
</form>
<form name=Lookup action=patweb94.pbl method=post style=margin:0>
<input type=hidden name=reportno value=9>
<input type=hidden name=template value=1>
<input type=hidden name=valcateg>
<input type=hidden name=valdtype>
<input type=hidden name=valdcode>
</form>
<form name=UpdateForm method=post onSubmit='return validateMandatory(this);'>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.101">
<input type="hidden" name="updatety" value="6">
<input type="hidden" name="reportno" value="2">
<input type="hidden" name="template" value="032">
<input type="hidden" name="redirect">
<input type="hidden" name="allocate" value="1">
<input type="hidden" name="chckname" value="0">
<input type="hidden" name="emradmit" value="0">
<input type="hidden" name="emradmis" value="0">
<input type="hidden" name="newbmand" value="0">
<input type="hidden" name="agebmand" value="0">
<input type="hidden" name="ptcnueoc" value="%PATWEB89.01.925">
<input type="hidden" name="exstward" value="%PATWEB89.01.158">
<input type="hidden" name="datefrom">
<input type="hidden" name="dateto">
<input type=hidden name=retcount value="">
<input type=hidden name=retcontr value="">
<input type=hidden name=retcdesc value="">
<input type=hidden name=nzhosp value="">
<input type="hidden" name="nzspr007">
<input type="hidden" name=bdmnindc value="1">
<input type="hidden" name=pswdindc value="0">
<input type="hidden" name=prnxindi>
<input type="hidden" name="c_ptmis010" id="c_ptmis010"
       value="%PATWEB89.01.111.1">
<input type="hidden" name="ptmis079" id="ptmis079" value="%PATWEB89.01.199.009">
<input type="hidden" name="nzspr013" id="nzspr013" value="%PATWEB89.01.955.013">
<input type="hidden" name="nzspr016" id="nzspr016" value="%PATWEB89.01.955.016">

<table border=1 colspan=1 width=100% cellspacing=1 cellpadding=1 >
<tr><td class=HeadingCell align=center colspan=2>
    Update Pre-Admission Details </tr>
<tr>
<tr><td>
    <table width=100%  border=0 class=TableBody cellpadding=2 cellspacing=2>
<tr><td width=50%>
    <table width=100% border=0 class=TableBody cellpadding=0 cellspacing=0>
     <tr><td class=DataLabel>Admission Date </td>
         <td><input type=text size=12 name=ptmis001 tabindex=1 
              class=Mandatory title="Admission Date" 
              value="%PATWEB89.01.102" id=ptmis001
              onblur="checkDate(this,'AdmissionDate');
                      getHCPSpecialtySelectList();defaultSpecialty();">
         <img notab src=../images/CalendarLookup.gif class=Icon
          onclick="DateLookupFrame(ptmis001);">     
          Time <input type=text name=ptmis002 size=8 tabindex=2 id=ptmis002
               value="%PATWEB89.01.103" class="Mandatory" 
               title="Admission Time" onblur="checkTime(this,'AdmissionTime');">
      <img notab src=../images/DateTimeStamp.gif class=Icon 
       onclick="SetCurrentDateTime(null,ptmis002);">
       <img notab src=../images/TimeLookup.gif class=Icon 
       onclick="TimeLookupFrame(ptmis002);">
       </td>
       <td class=DataLabel>%STANDARD.01.017.CL</td>
       <td align=left><select name=ptmis027 tabindex=22 class="Mandatory"
         title="%STANDARD.01.017.CL" 
         onchange="setClaim();InsuranceUpd();setCntr();clearClaim();">
         <option> </option>
         %PATWEB89.01.126.2
         </select>
         </td>
      </tr>

      <tr><td class=DataLabel>Referral Source</td>
          <td><select name=ptmis009 onchange="DisplayTrnSrc()" tabindex=2
               class="Mandatory" title="Referral Source">
                 <option> </option>
                 %PATWEB89.01.110.2
                 </select></td>
          <td class=DataLabel>Admitting Doctor</td>
          <td><input type="text" size=8 maxlength=6 name="ptmis007" 
                value="%PATWEB89.01.108.003" class="Mandatory" 
                title="Admitting Doctor" tabindex=23 id="ptmis007"
               onblur="UpCase(this); validateCode(31,ptmis007,doctnam2);
                       getHCPSpecialtySelectList();defaultSpecialty();">
              <input type=text readonly size=25 notab name=doctnam2
                value="%PATWEB89.01.108.002" id=doctnam2>  
              <img notab src="../images/SearchIcon.gif" class=Icon
               onclick="DoctorSearchFrame(ptmis007,doctnam2)"> 
          </td>
       </tr>

      <tr><td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>
        <td class=DataLabel>Primary Procedure</td>
        <td class=DataLabel>
        <input type=text name=ptmis026 size=10 maxlength=9 tabindex=24
        onblur='validateCode(4,ptmis026,mbsdesc1,ptmis001,updateDiag)'
        value="%PATWEB89.01.125" id=ptmis026>
        <input type=text notab readonly name=mbsdesc1 size=35 
        value="%PATWEB89.01.180" id=mbsdesc1>
        <img notab src="../images/SearchIcon.gif" class=Icon
        onclick="MbsSearchFrame(ptmis026,mbsdesc1,ptmis001)"> </td>
      </tr>

      <tr><td>Admitting Point</td>
       <td><select name=ptvis046 onchange="defaultWard()" tabindex=4
            class=Mandatory title="Admitting Point">
           <option> </option>
            %PATWEB89.01.290.2
           </select>
       </td>
    <td class=DataLabel>Full Description</td>
    <td><input type=text name=nzspr010 title="Procedure Description"
         tabindex=25
         size=120 maxlength=80 value="%PATWEB89.01.121">
<!-- adiag1 default -->
    <input type=hidden name=ptmis020 value="%PATWEB89.01.121">
<!-- adiag2 default -->
    <input type=hidden name=ptmis021 value="%PATWEB89.01.122">
        </td>
     </tr>

     <tr><td class=DataLabel>Ward / Bed </td>
         <td><input type=hidden name=bedstat1 id=bedstat1>
           <input type=hidden name=warddesc id=warddesc>
           <input type=hidden name=ptmis004 id=ptmis004>
           <select name=ptmis068 class=Mandatory tabindex=5 id=ptmis068>
            <option title=Ward> </option>
            %PATWEB89.01.449.2
           </select>
           <input type=text name=ptmis076 maxlength=3 size=3 id=ptmis076
             value="%PATWEB89.01.194" onchange="UpCase(this);">
           <img notab src=../images/SearchIcon.gif class=Icon
            onclick="WardBedSearchFrame(ptmis068,warddesc,ptmis076,bedstat1);">
          </td>
        <td class=DataLabel>Contract</td>
        <td><input type=text size=6 maxlength=6 name=ptmis013
         title="Health Fund" tabindex=26 id=ptmis013
         onchange="validateCode(16,document.UpdateForm.ptmis013,funddesc);"
                   value="%PATWEB89.01.114.0">
        <input type=text size=35 name="funddesc" maxlength="30"
         value="%PATWEB89.01.114.1" readonly notab id=funddesc>
        <input type="hidden" name="dummy" id=dummy>
        <img src=../images/SearchIcon.gif class=Icon 
         onclick="HFundSearchFrameNoFocus(ptmis013,funddesc,
                                               dummy,dummy);">
        <img src="../images/erase.gif" class=Icon
         onclick="clrFields(ptmis013,funddesc,dummy,dummy);">
        </td>
    </tr>
         <tr><td class=DataLabel> Intended Stay </td>
          <td class=DataLabel>
          <input type=text size=5 maxlength=5 name=ptmis030 tabindex=6
           title='Intended Length of Stay'
           class=Integer onblur="checkInteger(this,this.value);"
             value="%PATWEB89.01.129">
        </td>
        <td class=DataLabel>Approval Number</td>
        <td class=DataLabel>
        <input type=text name=nzspr015 size=20 maxlength=20 tabindex=27
         title="Approval Number" value="%PATWEB89.01.955.015"></td>
      </tr>

      <tr><td class=DataLabel>%STANDARD.01.017.A </td>
          <input type=hidden name=admiscat value="A ">
          <td><select name=ptmis010 tabindex=7 id=ptmis010
               title="%STANDARD.01.017.A " class="Mandatory">
              <option> </option>
                 %PATWEB89.01.111.2
              </select>
          </td>
        <td><div id=ClaimNumberHeading></div></td>
        <td><div id=ClaimNumber></div></td></tr>
      </tr>

      <tr><td class=DataLabel>Readmission Indicator</td>
          <td><select name=ptmis042 tabindex=8>
                <option> </option>
                 %PATWEB89.01.138.2
              </select></td>
        <td><div id=ApprovalDateHeading></div></td>
        <td><div id=ApprovalDate></div></td>
      </tr>

      <td class=DataLabel>Diet</td>
          <td><select name=ptmis028 tabindex=9>
              <option></option>
              %PATWEB89.01.127.2 
              </select>
          </td>
         <td>&nbsp;</td>
         <td>&nbsp;</td>
        </tr>

    <tr><td>&nbsp;</td><td>&nbsp;</td>
        <td class=DataLabel>Credit Card Details on File</td>
        <td><input type=checkbox name="d_ptmis079" id="d_ptmis079" /></td>
     </tr>

    <tr><td>&nbsp;</td><td>&nbsp;</td><td><div id=PatientInsHeading></div></td>
        <td><input type=checkbox name="d_nzspr013" id="d_nzspr013" 
             onclick="InsuranceUpd();"/>
        </td>
    </tr>

    <tr><td>&nbsp;</td><td>&nbsp;</td><td><div id=InsurerHeading></div></td>
          <td><table><tr><td><div id="Insurer"></div></td>
                         <td><div id="InsurerField"></div></td></tr></table>
          </td></tr>

    <tr><td>&nbsp;</td><td>&nbsp;</td><td><div id=ApprovalSightedHeading></div>
        </td>
        <td><input type=checkbox
                  name="d_nzspr016" id="d_nzspr016" />
        </td>
    </tr>

     <tr><td>&nbsp;</td><td>&nbsp;</td><td><div id=CommentsHeading></div></td>
         <td><div id=Comments></div></td></tr>

<tr><td>&nbsp;</td>
    <td>&nbsp;</td>
<td class=DataLabel>Assigned Contract Procedure Code</td>
<td><input type=text name="d_nzspr007" title="Contract Procedure Code"
           value="%PATWEB89.01.955.007" readonly class="Readonly"></td</tr>
</table>
</tr>

      <tr align=center>
       <td align=center colspan=4><br>
       <input type=button value="Ok" class=button id="pat89sub" tabindex=40
        onclick="tempDisable(this);checkBedStatus(UpdateForm.ptmis068.value,
                 UpdateForm.ptmis076.value,UpdateForm.ptmis001.value,
                 UpdateForm.ptmis030.value,SubmitAdm)";>
    </table>
</td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.101">
<input type=hidden name=MenuType value="%PATWEB89.01.088">
</form>
<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</tr>
</span>
<span id=transfersrc style="display:none">
<td><input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
      title="Transfer Source" tabindex=3 id=trnsfsrc
      value="%PATWEB89.01.193.0"
      onchange="validateCode(9,trnsfsrc,trandesc);">
     <input type=text size=27 name=trandesc notab id=trandesc
      class=Readonly readonly value="%PATWEB89.01.193.1">
     <img src="../images/SearchIcon.gif" class=Icon
      onclick="TransferSourceFrame(trnsfsrc,trandesc)"></td>
</tr>
</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>
<span id=patientinshd style="display:none">
<td class=DataLabel>Patient Insurance</td>
</tr>
</span>
<div id=insurerhd style="display:none">
<td class=DataLabel>Insurer</td>
</tr>
</div>

<div id=insurer style="display:none">
    <select name=nzspr014 title="Insurer" tabindex=32
     value="%PATWEB89.01.955.014.0" onchange="CheckIns();">
    <option> </option>
    %PATWEB89.01.955.014.2
    </select></td></tr>
</div>

<div id="InsurerText" style="display:none">
    <input type=text size=60 maxlength=50 name=icomment id=icomment tabindex=33
        class=Mandatory value="%PATWEB89.01.999.012" title="Insurer Free text">
</div>

<span id=insurerblank style="display:none">
   <input type=hidden name=nzspr014>
</span>
<span id=approvalsightedhd style="display:none">
<td class=DataLabel>Prior Approval Sighted</td>
</tr>
</span>
<span id=claimnumberhd style="display:none">
<td class=DataLabel>Claim Number</td>
</tr>
</span>
<span id=claimnumber style="display:none">
    <td class=DataLabel>
        <input type=text name=nzspr017 size=20 maxlength=20 tabindex=28
         title="Claim Number" value="%PATWEB89.01.955.017"></td>
</span>
<span id=claimnumberblank style="display:none">
   <input type=hidden name=nzspr017 value="%PATWEB89.01.955.017"></td>
</span>
<span id=approvaldatehd style="display:none">
<td class=DataLabel>Approval Expiry Date</td>
</tr>
</span>
<span id=approvaldate style="display:none">
        <td><input type=text size=12 name=nzspr024 title="Approval Expiry Date"
          tabindex=29 id=nzspr024
          onblur="checkDate(this,'ApprovalDate')"; value="%PATWEB89.01.955.030">
         <img notab src=../images/CalendarLookup.gif class=Icon
          onclick="DateLookupFrame(nzspr024);">
        <img notab src=../images/DateTimeStamp.gif class=Icon
         onclick="SetCurrentDateTime(nzspr024,null);">
      </td></tr>
</span>
<span id=approvaldateblank style="display:none">
   <input type=hidden name=nzspr024>
</span>
<span id=commentshd style="display:none">
<td class=DataLabel>Comments</td>
</tr>
</span>
<span id=comments style="display:none">
    <td><input type=text name=nzspr019 size=50 maxlength=30 tabindex=35
         value="%PATWEB89.01.955.019"> </td>
    </td></tr>
</span>
<span id=commentsblank style="display:none">
   <input type=hidden name=nzspr019 value="%PATWEB89.01.955.019">
</span>
<script language="javascript">
setClaim();
function init(){
  expward="%PATWEB89.01.158"
  for (var i =0 ; i < document.UpdateForm.ptmis068.length; i++) {
    if (document.UpdateForm.ptmis068.options[i].value==expward) {
       document.UpdateForm.ptmis068.selectedIndex=i } };
}
</script>
