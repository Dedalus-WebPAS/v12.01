<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nzprivate">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/preadmission.js"></script>
<script type="text/javascript">   
function updateDiag() {
 p=document.UpdateForm;
 p.nzspr010.value=p.mbsdesc1.value;
}
function SetWardBed() {
 if(document.UpdateForm.admitbox.checked == true) {
     document.UpdateForm.admitbox.value="1";
     document.UpdateForm.ptmis068.className="Mandatory";
  } else {
     document.UpdateForm.admitbox.value="0";
     UpdateForm.ptmis068.className="";                   
  }
}
function checkboxtabindex() {
  var d = document.getElementById("d_ptmis079");
  d.tabIndex = 21;
  var d = document.getElementById("d_nzspr013");
  d.tabIndex = 22;
  var d = document.getElementById("d_nzspr016");
  d.tabIndex = 25;

  if (document.getElementById("nzspr013").value=="1") {
    document.getElementById("d_nzspr013").checked=true;
  }

  if (document.getElementById("nzspr016").value=="1") {
    document.getElementById("d_nzspr016").checked=true;
  }
}

function SubmitAdm() {
    p=document.UpdateForm
    validateSuspension(p.urnumber,p.ptmis001,p.datefrom,p.dateto);
    p.ptmis020.value=p.nzspr010.value;
    if(p.datefrom.value!='0'){
      if(p.admitbox.value=="1"){
         document.UpdateForm.admitbox.value="0";
         ans=confirm("Warning : Patient has a Suspension record for period \n" +
               "\t" + p.datefrom.value  + " - " + p.dateto.value + "\n" +
               "\tPatient will not be admitted");
         }else{
         ans=confirm("Warning : Patient has a Suspension record for period \n" +
               "\t" + p.datefrom.value  + " - " + p.dateto.value);}
         if (ans!=true) {
            return;
         } 
    }
  if(document.UpdateForm.ptmis027.value.substr(9,1)=="F"||
     document.UpdateForm.ptmis027.value.substr(9,1)=="P"){
    if(document.UpdateForm.nzspr007.value==""){
      if(!valContract(document.UpdateForm)){return;}}
  }
  MandatoryOk=validateMandatory(document.UpdateForm)
  if (MandatoryOk) {
    UpdateForm.ptmis004.value=UpdateForm.ptmis068.value;
    UpdateForm.ptmis005.value=UpdateForm.ptmis076.value;
    SetLinkACC(UpdateForm,"PR2");
  if(document.UpdateForm.ptmis027.value.substr(9,1)=="F"||
  document.UpdateForm.ptmis027.value.substr(9,1)=="P"){
     document.UpdateForm.redirect.value="patweb89.pbl?reportno=09&template=001"
     + "&urnumber=" + document.UpdateForm.urnumber.value.replace(/ /g,"+")
     + "&admissno=";}

     if (document.getElementById("d_nzspr013").checked==true) {
       document.getElementById("nzspr013").value="1";
     } else {
       document.getElementById("nzspr013").value="0";
     }

     if (document.getElementById("d_nzspr016").checked==true) {
       document.getElementById("nzspr016").value="1";
     } else {
       document.getElementById("nzspr016").value="0";
     }

    SubmitHidden(UpdateForm);
    }
}
function InsuranceUpd() {
  f = document.UpdateForm;
  ind7 = f.ptmis027.value.substr(9,1);
  ind10 = f.ptmis027.value.substr(12,1);
  ind27 = f.ptmis027.value.substr(44,1);
//alert('ind7=' + ind7 + ' ind10=' + ind10 + ' ind27=' + ind27);
  if (ind10=="A") {
    if (document.getElementById("d_nzspr013").checked==true) {
      f.nzspr014.className="Mandatory";
      f.nzspr014.disabled=false;
      f.nzspr015.className="Mandatory";
      f.nzspr015.disabled=false;
      f.nzspr017.disabled=false;
      f.nzspr024.disabled=false;
      f.d_nzspr016.disabled=false;
    }
    else {
      if (ind27=="I") {
        f.nzspr014.className="Mandatory";
        f.nzspr014.disabled=false;
      }
      else {
        f.nzspr014.className="";
        f.nzspr014.disabled=true;
        f.nzspr014.value="";
        InsurerField.innerHTML="";
      }
      f.nzspr015.className="";
      f.nzspr015.disabled=true;
      f.nzspr017.disabled=true;
      f.nzspr024.disabled=true;
      f.d_nzspr016.disabled=true;
      f.d_nzspr016.checked=false;
    }
  }
  else {
    if (ind27=="I") {
      f.nzspr014.className="Mandatory";
      f.nzspr014.disabled=false;
    }
    f.nzspr015.disabled=false;
    f.d_nzspr016.disabled=false;
    f.nzspr017.disabled=false;
    f.nzspr024.disabled=false;
  }
  CheckIns();
}
</script>
%START.OF.PAGE
<body onload="PageLoad(event);defaultWard();DisplayTrnSrc();setClaim();
              UpdateForm.ptmis001.focus();checkboxtabindex();
              createSpecialtyArray();getHCPSpecialtySelectList();
              defaultSpecialty();InsuranceUpd();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>

<form name=linkForm action=patweb89.pbl method=post style=margin:0>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.101">
</form>

<form name=Lookup action=patweb94.pbl method=post style=margin:0>
<input type=hidden name=reportno value=9>
<input type=hidden name=template value=1>
<input type=hidden name=valcateg>
<input type=hidden name=valdtype>
<input type=hidden name=valdcode>
</form>

<form name=UpdateForm method=post action=patweb89.pbl>
<input type=hidden name="reportno" value="2">
<input type=hidden name="template" value="20">
<input type=hidden name="updatety" value="1">
<input type=hidden name="redirect" value="%PATWEB89.01.001.patweb98.01.001">
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.701">
<input type=hidden name="allocate" value="1">
<input type=hidden name="chckname" value="0">
<input type=hidden name="emradmit" value="0">
<input type=hidden name="emradmis" value="0">
<input type=hidden name="admitnow" value="1">
<input type=hidden name="newbmand" value="0">
<input type=hidden name="agebmand" value="0">
<input type=hidden name="preadbok" value="1">
<input type=hidden name="datefrom">
<input type=hidden name="dateto">
<input type=hidden name="ptcnueoc" value="%PATWEB89.01.925">
<input type=hidden name="exstward" value="%PATWEB89.01.449.1">
<input type=hidden name="nzhosp">
<input type=hidden name=retcount value="">
<input type=hidden name=retcontr value="">
<input type=hidden name=retcdesc value="">
<input type=hidden name="nzspr007" title="Contract Procedure Code">
<input type=hidden name="c_ptmis010" id="c_ptmis010" value="%PATWEB89.01.111.1">
<input type=hidden name=ptvis048 value="%PATWEB89.01.251.0">
<input type=hidden name=ptvis049 value="%PATWEB89.01.252.0">
<input type=hidden name="nzspr013" id="nzspr013" value="%PATWEB89.01.955.013">
<input type=hidden name="nzspr016" id="nzspr016" value="%PATWEB89.01.955.016">
<input type=hidden name=ptmis004 id=ptmis004>
<input type=hidden name=ptmis005 id=ptmis005>
<input type=hidden name=warddesc id=warddesc>
<input type=hidden name=bedstat1 id=bedstat1>
<input type=hidden name=dummy id=dummy>
<input type=hidden name=stopdwaw value="1">

<table border=1 colspan=1 width=100% cellspacing=1 cellpadding=1>
<tr><td class=HeadingCell align=center>
    Patient Pre-Admission Details (Booking Details) </tr>
<tr>
<tr><td>
    <table width=100%  border=0 class=TableBody cellpadding=0 cellspacing=0>
    <tr><td class=DataLabel>Admission Date</td>
        <td><input type="text" size="12" value="%PATWEB89.01.102" tabindex=1
             name=ptmis001 onblur="checkDate(this,'Admission Date')
                           getHCPSpecialtySelectList();defaultSpecialty();" 
             class="Mandatory" title="Admission Date" id=ptmis001>
            <img src="../images/CalendarLookup.gif" class=Icon
             onclick="DateLookupFrame(ptmis001);">
            Time <input type=text name=ptmis002 size=8 value="%PATWEB89.01.103"
                  onblur="checkTime(this,'AdmissionTime');" tabindex=2
                   class="Mandatory" title="Admission Time" id=ptmis002>
            <img src="../images/DateTimeStamp.gif" class=Icon
             onclick="SetCurrentDateTime(null,ptmis002);">
            <img src="../images/TimeLookup.gif" class=Icon
             onclick="TimeLookupFrame(ptmis002);">
        </td>
         <td class=DataLabel>%STANDARD.01.017.CL</td>
         <td> <select name=ptmis027  class="Mandatory" tabindex=13
              title="%STANDARD.01.017.CL" onchange="setClaim();InsuranceUpd();">
          <option> </option>
          %PATWEB89.01.126.2
          </select>
         </td>
       </tr>

      <tr><td class=DataLabel>Referral Source</td>
          <td><select name=ptmis009 class="Mandatory" onchange="DisplayTrnSrc()"
               title="Referral Source" tabindex=3>
                 <option> </option>
                 %PATWEB89.01.110.2
                 </select></td>
          <td class=DataLabel>Admitting Doctor</td>
          <td><input type="text" size=8 maxlength=6 name="ptmis007" tabindex=14
               value="%PATWEB89.01.108.003" class="Mandatory"
               title="Admitting Doctor" id="ptmis007"
               onblur="UpCase(this); validateCode(31,ptmis007,doctnam2);
                       getHCPSpecialtySelectList();defaultSpecialty();">
              <input type=text readonly size=25 name="doctnam2"
               id=doctnam2 value="%PATWEB89.01.108.002">
              <img src="../images/SearchIcon.gif" class=Icon
               onclick="DoctorSearchFrame(ptmis007,doctnam2)">
              <img src="../images/erase.gif" class=Icon
               onclick="clrFields(ptmis007,doctnam2);">
          </td>
        </tr>

      <tr><td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>
          <td class=DataLabel>Primary Procedure</td>
          <td class=DataLabel>
            <input type=text name=ptmis026 size=10 maxlength=9 tabindex=15
             onblur="validateCode(4,ptmis026,mbsdesc1,ptmis001,nzspr010,updateDiag);"
             id=ptmis026 value="%PATWEB89.01.125">
            <input type=text notab readonly name=mbsdesc1 size=35 
             id=mbsdesc1 value="%PATWEB89.01.180">
            <img notab src="../images/SearchIcon.gif" class=Icon
             onclick="MbsSearchFrame(ptmis026,mbsdesc1,ptmis001)">
            <img src="../images/erase.gif" class=Icon
             onclick="clrFields(ptmis026,mbsdesc1,nzspr010);">
          </td>
      </tr>

      <tr><td>Admitting Point</td>
          <td><select name=ptvis046 onchange="defaultWard()" 
                tabindex=5 class=Mandatory>
               <option></option>
               %PATWEB89.01.290.2
            </select></td>
    <td class=DataLabel>Full Description</td>
    <td><input type=text name=nzspr010 title="Procedure Description" tabindex=16
         size=120 maxlength=80 value="%PATWEB89.01.955.010">
<!-- adiag1 default -->
    <input type=hidden name=ptmis020 value="%PATWEB89.01.955.010">
<!-- adiag2 default -->
    <input type=hidden name=ptmis021 value="%PATWEB89.01.122">
    </td>
       </tr>

       <tr><td class=DataLabel>Ward / Bed </td>
          <td>
           <select name=ptmis068 id=ptmis068 title="Ward" class=Mandatory tabindex=6>
            <option> </option>
            %PATWEB89.01.449.2
           </select>
           <input type=text name=ptmis076 id=ptmis076 maxlength=3 size=3 tabindex=7
            onchange="UpCase(this);">
           <img src="../images/SearchIcon.gif" class=Icon
            onclick="WardBedSearchFrame(ptmis068,warddesc,ptmis076,bedstat1);">
          </td>
         <td class=DataLabel>Contract</td>
        <td><input type=text size=6 maxlength=6 name=ptmis013
         title="Contract" tabindex=17 id=ptmis013
         onblur="validateCode(16,document.UpdateForm.ptmis013,document.UpdateForm.funddesc);"
                   value="%PATWEB89.01.040.0">
        <input type=text size=35 name="funddesc" id=funddesc maxlength="30"
         value="%PATWEB89.01.040.1" readonly notab>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HFundSearchFrameNoFocus(ptmis013,funddesc,dummy,dummy);">
        <img src="../images/erase.gif" class=Icon
         onclick="clrFields(ptmis013,funddesc,dummy,dummy);">
    </td>
    </tr>

    <tr><td class=DataLabel> Intended Stay</td>
        <td><input type=text size=5 maxlength=5 name=ptmis030 tabindex=8
         title="Intended Stay" value="%PATWEB89.01.129"
         onblur="checkInteger(this,this.value);">
        </td>
    <td class=DataLabel>Approval Number</td>
    <td class=DataLabel>
        <input type=text name=nzspr015 size=20 maxlength=20 tabindex=18
         title="Approval Number"></td>
    </tr>

    <tr><td class=DataLabel>%STANDARD.01.017.A </td>
          <td><select name=ptmis010 title="%STANDARD.01.017.A " tabindex=9
               class="Mandatory" id=ptmis010>
              <option></option>
                 %PATWEB89.01.111.4
              </select></td>
        <td><div id=ClaimNumberHeading></div></td>
        <td><div id=ClaimNumber></div></td>
    </tr>

      <tr><td class=DataLabel>Readmission Indicator</td>
          <td><select name=ptmis042 tabindex=10>
                <option> </option>
                 %PATWEB89.01.138.2
              </select></td>
        <td><div id=ApprovalDateHeading></div></td>
        <td><div id=ApprovalDate></div></td>
      </tr>

      <td class=DataLabel>Diet</td>
          <td><select name=ptmis028 tabindex=11>
              <option></option>
              %PATWEB89.01.065.2
              </select></td>
         <td>&nbsp;</td>
         <td>&nbsp;</td>
      </tr>

       <tr><td>&nbsp;</td><td>&nbsp;</td>
        <td class=DataLabel>Credit Card Details on File</td>
        <td><input type=hidden class="CheckBox" value="%PATWEB89.01.199.009" 
                   id="ptmis079" name="ptmis079" /></td>
      </tr>

      <tr><td class=DataLabel>Admit Now</td>
          <td><input type=checkbox value="1" name="admitbox" tabindex=12></td>
          <td><div id=PatientInsHeading></div></td>
          <td><input type=checkbox id="d_nzspr013" name="d_nzspr013" 
               onclick="InsuranceUpd();"/></td>
    </tr>

    <tr><td>&nbsp;</td><td>&nbsp;</td><td><div id=InsurerHeading></div></td>
          <td><table><tr><td><div id="Insurer"></div></td>
                         <td><div id="InsurerField"></div></td></tr></table>
          </td></tr>

    <tr><td>&nbsp;</td><td>&nbsp;</td>
        <td><div id=ApprovalSightedHeading></div></td>
        <td><input type=checkbox id="d_nzspr016" name="d_nzspr016"/></td>
    </tr>

     <tr><td>&nbsp;</td><td>&nbsp;</td><td><div id=CommentsHeading></div></td>
         <td><div id=Comments></div></td></tr>
</table>
</td></tr>
<tr align=center>
<td colspan=4 align=center><br>
<input type=button value="Ok" class=button id="pat89sub" tabindex=35
         onclick="tempDisable(this);checkBedStatus(UpdateForm.ptmis068.value,
                 UpdateForm.ptmis076.value,UpdateForm.ptmis001.value,
                 UpdateForm.ptmis030.value,SubmitAdm)";>
</td></tr>
</table>
</td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
<input type=hidden name=MenuType value="%PATWEB89.01.088">
</form>

</div>
<script type="text/javascript">
 if ("%PATWEB89.01.905" == "1") {
  alert("Warning: Patient is currently admitted");
 }
 if ("%PATWEB89.01.908" == "1") {
  alert("Warning: Patient has a pre-admission record");
 }
</script>
<span id=transferhd style="display:none">
<td class=DataLabel>Transfer Source</td>
</tr>
</span>
<span id=transfersrc style="display:none">
<td><input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
      title="Transfer Source" tabindex=4 id=trnsfsrc
      value="%PATWEB89.01.193.0"
      onchange="validateCode(9,trnsfsrc,trandesc);">
     <input type=text size=27 name=trandesc notab id=trandesc
      class=Readonly readonly value="%PATWEB89.01.193.1">
     <img src="../images/SearchIcon.gif" class=Icon
      onclick="TransferSourceFrame(trnsfsrc,trandesc)"></td>
</tr>
</span>
<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>
<span id=patientinshd style="display:none">
<td class=DataLabel>Patient Insurance</td>
</tr>
</span>
<div id=insurerhd style="display:none">
<td class=DataLabel>Insurer</td>
</tr>
</div>

<div id=insurer style="display:none">
    <select name=nzspr014 title="Insurer" tabindex=23
     onchange="CheckIns();">
    <option></option>
    %PATWEB89.01.955.014.2
    </select></td></tr>
</div>

<div id="InsurerText" style="display:none">
   <input type="text" size=60 maxlength=50 name=icomment id=icomment tabindex=24
        class=Mandatory title="Insurer Free text">
</div>

<span id=insurerblank style="display:none">
   <input type=hidden name=nzspr014>
</span>
<span id=approvalsightedhd style="display:none">
<td class=DataLabel>Prior Approval Sighted</td>
</tr>
</span>
<span id=claimnumberhd style="display:none">
<td class=DataLabel>Claim Number</td>
</tr>
</span>
<span id=claimnumber style="display:none">
    <td class=DataLabel>
        <input type=text name=nzspr017 title="Claim Number" tabindex=19
         size=20 maxlength=20></td>
</span>
<span id=claimnumberblank style="display:none">
   <input type=hidden name=nzspr017>
</span>
<span id=approvaldatehd style="display:none">
<td class=DataLabel>Approval Expiry Date</td>
</tr>
</span>
<span id=approvaldate style="display:none">
        <td><input type=text size=12 name=nzspr024 title="Approval Expiry Date"
             tabindex=20 onblur="checkDate(this,'ApprovalDate')"; id=nzspr024>
         <img notab src="../images/CalendarLookup.gif" class=Icon
          onclick="DateLookupFrame(nzspr024);">
        <img notab src="../images/DateTimeStamp.gif" class=Icon
         onclick="SetCurrentDateTime(nzspr024,null);">
      </td></tr>
</span>
<span id=approvaldateblank style="display:none">
   <input type=hidden name=nzspr024>
</span>
<span id=commentshd style="display:none">
<td class=DataLabel>Comments</td>
</tr>
</span>
<span id=comments style="display:none">
    <td><input type=text name=nzspr019 size=50 maxlength=30 tabindex=30> </td>
    </td></tr>
</span>
<span id=commentsblank style="display:none">
   <input type=hidden name=nzspr019>
</span>
