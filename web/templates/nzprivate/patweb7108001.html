<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="nzprivate">
<meta name="CrossBrowser" content="true">
<meta name="HelpFileName" content="NoContextSet.html">
<script type="text/javascript">
function linkPatient(VisitNo,Urnumber,VisitType) {
  if (VisitType=="3") {
      document.PatientLinks.action="patweb71.pbl";
      document.PatientLinks.reportno.value="1";
      document.PatientLinks.template.value="032";
      document.PatientLinks.updttype.value=" ";
      document.PatientLinks.admissno.value=VisitNo;
      document.PatientLinks.urnumber.value=Urnumber;
      document.PatientLinks.submit();
  }
  if (VisitType=="2") {
      document.PatientLinks.action="outweb07.pbl";
      document.PatientLinks.reportno.value="1";
      document.PatientLinks.template.value="001";
      document.PatientLinks.admissno.value=VisitNo;
      document.PatientLinks.urnumber.value=Urnumber;
      document.PatientLinks.submit();
  }
  if (VisitType=="1") {
      document.PatientLinks.action="emrweb04.pbl";
      document.PatientLinks.reportno.value="1";
      document.PatientLinks.template.value="001";
      document.PatientLinks.admissno.value=VisitNo;
      document.PatientLinks.urnumber.value=Urnumber;
      document.PatientLinks.submit();
  }
}
function ShowVisits() {
   if ((document.UpdateForm.filtvtyp.value=="1") ||
       (document.UpdateForm.filtvtyp.value=="2")) {
        document.UpdateForm.filtoptn.value="0";
  }
  InvoicePendingFilt=0;
  //document.UpdateForm.submit();
  var theURL= "../cgi-bin/patweb71.pbl?reportno=08&template=003" +
              "&filtvtyp=" + UpdateForm.filtvtyp.value +
              "&filthfnd=" + UpdateForm.filthfnd.value +
              "&filtclam=" + UpdateForm.filtclam.value +
              "&filtoptn=" + UpdateForm.filtoptn.value +
              "&startnum=" + UpdateForm.startnum.value +
              "&norecord=" + UpdateForm.norecord.value;
  var xmlHttp = createHttpObject();
  xmlHttp.open("GET", theURL, false);
  xmlHttp.send();
  if (xmlHttp.status=="200") {
    var el=document.getElementById("TableView")
    el.innerHTML=xmlHttp.responseText;
  } else {
    alert("Web Service Not Available or Configured")
  }
}
function ResetSearch() {
  serverURL = "../cgi-bin/patweb71.pbl?reportno=08&template=001" +
              "&filtvtyp=" + UpdateForm.filtvtyp.value +
              "&filthfnd=" + UpdateForm.filthfnd.value +
              "&filtclam=" + UpdateForm.filtclam.value +
              "&filtoptn=" + UpdateForm.filtoptn.value +
              "&norecord=" + UpdateForm.norecord.value
    location.href=serverURL
}
function SetInvPndCookies() {
  var StartNum=GetRequest("startnum");
  if (StartNum!="undefined") {
    SetCookie("InvoicePendingSN",StartNum);
  } else {
    SetCookie("InvoicePendingSN","");
  }
  SetCookie("InvoicePendingVT",document.UpdateForm.filtvtyp.value);
  SetCookie("InvoicePendingVT",document.UpdateForm.filtvtyp.value);
  SetCookie("InvoicePendingCT",document.UpdateForm.filtclam.value);
  SetCookie("InvoicePendingHF",document.UpdateForm.filthfnd.value);
  SetCookie("InvoicePendingOP",document.UpdateForm.filtoptn.value);
  SetCookie("InvoicePendingPath",location.href);
}
function GetRequest(name){
  if(name=(new RegExp('[?&]'+encodeURIComponent(name)+'=([^&]*)')).exec(location.search))
  return decodeURIComponent(name[1]);
}
function RetInvPndCookies() {
  InvoicePendingSN=GetCookieData("InvoicePendingSN");
  InvoicePendingVT=GetCookieData("InvoicePendingVT");
  InvoicePendingCT=GetCookieData("InvoicePendingCT");
  InvoicePendingHF=GetCookieData("InvoicePendingHF");
  InvoicePendingOP=GetCookieData("InvoicePendingOP");

  InvoicePendingFilt=0;
  if ((InvoicePendingVT!="" && InvoicePendingVT!="unknown") ||
      (InvoicePendingSN!="" && InvoicePendingSN!="unknown") ||
      (InvoicePendingCT!="" && InvoicePendingCT!="unknown") ||
      (InvoicePendingHF!="" && InvoicePendingHF!="unknown") ||
      (InvoicePendingOP!="" && InvoicePendingOP!="unknown")) {
       InvoicePendingFilt=1;
  }
  if (InvoicePendingSN!="" && InvoicePendingSN!="unknown") {
     document.UpdateForm.startnum.value=InvoicePendingSN;
  } else {
     document.UpdateForm.startnum.value=GetRequest("startnum");
  }
  if (InvoicePendingVT!="" && InvoicePendingVT!="unknown") {
    for (var i=0; i<document.UpdateForm.filtvtyp.length; i++) {
      if (document.UpdateForm.filtvtyp.options[i].value==InvoicePendingVT) {
          document.UpdateForm.filtvtyp.selectedIndex=i;
      }
    }
  }
  if (InvoicePendingCT!="" && InvoicePendingCT!="unknown") {
    for (var i=0; i<document.UpdateForm.filtclam.length; i++) {
      if (document.UpdateForm.filtclam.options[i].value==InvoicePendingCT) {
          document.UpdateForm.filtclam.selectedIndex=i;
      }
    }
  }
  if (InvoicePendingHF!="" && InvoicePendingHF!="unknown") {
    for (var i=0; i<document.UpdateForm.filthfnd.length; i++) {
      if (document.UpdateForm.filthfnd.options[i].value==InvoicePendingHF) {
          document.UpdateForm.filthfnd.selectedIndex=i;
      }
    }
  }
  if (InvoicePendingOP!="" && InvoicePendingOP!="unknown") {
    for (var i=0; i<document.UpdateForm.filtoptn.length; i++) {
      if (document.UpdateForm.filtoptn.options[i].value==InvoicePendingOP) {
          document.UpdateForm.filtoptn.selectedIndex=i;
      }
    }
  }
  document.cookie="InvoicePendingSN=";
  document.cookie="InvoicePendingVT=";
  document.cookie="InvoicePendingCT=";
  document.cookie="InvoicePendingHF=";
  document.cookie="InvoicePendingOP=";
  document.cookie="InvoicePendingPath=";
  ShowVisits();
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);RetInvPndCookies();">
<form name="UpdateForm" action="patweb71.pbl" style="margin:0">
 <input type="hidden" name="reportno" value="8">
 <input type="hidden" name="template" value="001">
 <input type="hidden" name="updttype" value=" ">
 <input type="hidden" name="norecord" value="10">
 <input type="hidden" name="startnum" value="0">

 <table width="100%" cellpadding="0" cellspacing="0" border="0" bgcolor="#CCCCCC">

  <tr><td colspan="8" align="center" class="HeadingCell">
          Invoice Pending List</td></tr>

  <tr><td class="DataLabel">Visit Type</td>
      <td class="DataField">
          <select name="filtvtyp" class="PMenuSelectList" title="Visit Type"
                  onchange="ShowVisits();">
            <option value="0">All</option>
            <option value="1">Emergency</option>
            <option value="2">Outpatient</option>
            <option value="3">Inpatient</option>
          </select></td>
      <td class="DataLabel">%STANDARD.01.017.CL</td>
      <td class="DataField">
          <select name="filtclam" class="SelectMed" title="%STANDARD.01.017.CL"
                  onchange="ShowVisits();">
            <option>All</option>
              %PATWEB71.08.206.2
          </select></td>
      <td class="DataLabel">Contract</td>
      <td class="DataField">
          <select name="filthfnd" class="SelectMed" title="Contract"
                  onchange="ShowVisits();">
            <option>All</option>
              %PATWEB71.08.205.2
          </select></td>
      <td class="DataLabel">Option</td>
      <td class="DataField">
          <select name="filtoptn" class="PMenuSelectList" title="Option"
                  onchange="ShowVisits();">
            <option value="0">All Patients</option>
            <option value="1">Discharged Only</option>
          </select></td></tr>
 </table>
 <div id="TableView"></div>

</form>

<form name="PatientLinks" method="get">
 <input type="hidden" name="reportno" value="8">
 <input type="hidden" name="template" value="004">
 <input type="hidden" name="urnumber" value="%PATWEB71.08.003">
 <input type="hidden" name="admissno" value="%PATWEB71.08.081">
 <input type="hidden" name="updttype" value="">
 <input type="hidden" name="MenuType" value="%PATWEB71.08.088">
 <input type="hidden" name="chngdate" value="%PATWEB71.08.208">
</form>

<script type="text/javascript">
 FilterVis="%PATWEB71.08.204";
 for (var i =0 ; i < document.UpdateForm.filtvtyp.length; i++) {
   if (document.UpdateForm.filtvtyp.options[i].value==trim(FilterVis)) {
       document.UpdateForm.filtvtyp.selectedIndex=i;
   }
 }
 FilterOpt="%PATWEB71.08.207";
 for (var i =0 ; i < document.UpdateForm.filtoptn.length; i++) {
   if (document.UpdateForm.filtoptn.options[i].value==trim(FilterOpt)) {
       document.UpdateForm.filtoptn.selectedIndex=i;
   }
 }
</script>
