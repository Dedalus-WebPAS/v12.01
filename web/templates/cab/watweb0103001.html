<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="cab">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript">
function SelectSubmit() {
  document.SelectPeriod.submit();
}

function TableSort(OrderColumn) {
 if ( lastOrderColumn == OrderColumn ) {
   if (AscDsc==1) {AscDsc=2;} else {AscDsc=1;} }
 else {
   AscDsc=1; }
 TableOutput(OrderColumn,AscDsc);
 highlightProcedureGroup();
}

function highlightProcedureGroup() {
  for(var i = 0; i < t.rows.length; i++) {
    if(t.rows[i][40].replace(/ /g,"") == 1) {
      var tmp = document.getElementById('row_'+i);

      if(typeof tmp != 'undefined') {
        tmp.style.backgroundColor = "yellow";
      }
    }
  }
}

function highlightReason() {
 for(var i =0; i < t.rows.length; i++) {
   if(t.rows[i][39].replace(/ /g,"") == 'H') {
     var value = t.rows[i][36];
     var tmp  = "<span style='color:red;'>"+value+"</span>";
     t.rows[i][36] = tmp;
   }
 }
 TableOutput(2,1);
 highlightProcedureGroup();
}


//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link                   8 - Procedure Code
//  1 - Patient Name                9 - Procedure Description
//  2 - UR                         10 - Reason/Diagnosis
//  3 - Sex                        11 - Rank
//  4 - Age                        12 - Est Length of Stay
//  5 - Date on List               13 - Doctor Code 
//  6 - Date on Last review        14 - Doctor Name
//  7 - Scheduled Admission Date   15 - Urgency Description
//                                 16 - Urgency Overdue
//                                 17 - Urgency Overdue Status
//                                 18 - Urgency Status
//                                 19 - Referral Source
//                                 20 - Unit
//                                 21 - Doctor Name
//                                 22 - Days On List
//                                 23 - Not ready for Care
//                                 24 - Since Urgency
//                                 25 - Expected Ward
//                                 26 - Proposed Operation Date 
//                                 27 - PreAdmission Status
//---------------------------------------------------------------------------
function InitTable(TableView) {
switch (TableView) {
case 0: {
 t.addColumn("Patient","ImageText",1,1,"left","PatientFolder","0",150,30)
 t.addColumn("Unique Id.","String",34,34,"left","","",65)
 t.addColumn("Expected Due Date","Date",7,7,"left","","",65)
 t.addColumn("Listing Status","String",35,35,"left","","",60)
 t.addColumn("Procedure","String",9,9,"left","","",120)
 t.addColumn("Doctor","String",14,14,"left","","",120);
 t.addColumn("Removal Reason","String",36,36,"left","","",120);
 t.addColumn("Paperwork Date","Date",38,38,"left","","",65);
 t.addColumn("Gravida","String",37,37,"left","","",80);
 t.addColumn("Expected Ward","String",29,29,"left","","",60); 
  
 AddTableRows();
 t.sortTable(4,1);    // By Status
 t.sortTable(1,1);    // By Date
 TableOutput(2,1);    // By Category
 highlightProcedureGroup();
 break; }
case 1: {
 t.addColumn("Patient","ImageText",1,1,"left","PatientFolder","0",180,30)
 t.addColumn("Date on List","Date",5,5,"left","","",70)
 t.addColumn("Doctor","String",14,14,"left","","",100)
 t.addColumn("Days on List","String",22,22,"right","","",50)
 t.addColumn("Not Ready for Care","String",23,23,"right","","",70)   
 t.addColumn(document.PatientLinks.priocat.value+" Reassignment","String",24,24,"right","","",90)        
 t.addColumn("Expected Ward","String",29,29,"left","","",60)
 AddTableRows()
 TableOutput(1,1);    // By Date on List
 highlightProcedureGroup();
 break; }
case 2: {
 t.addColumn("Unit","String",20,20,"left","","",130)
 t.addColumn("Date on List","Date",5,5,"left","","",70)
 t.addColumn("Procedure","String",9,9,"left","","",160)
 t.addColumn("Patient","ImageText",1,1,"left","PatientFolder","0",180,30)
 t.addColumn("Overdue","Image",17,17,"center","WaitingStatus","",40)
 t.addColumn("Admitting Point","String",25,25,"left","","",50)
 AddTableRows()
 TableOutput(1,1);    // By Date on List
 highlightProcedureGroup();
 break; }
 }
}
</script>
</head>
%START.OF.PAGE
<body>
<div id=HeadingSection>

<form name=SelectPeriod id=SelectPeriod action=watweb01.pbl method=get 
 style="margin:0">
<input type=hidden name=reportno value=3>
<input type=hidden name=template value=1>
<input type=hidden name=viewtype value="%WATWEB01.03.010">

<table cellpadding=1 cellspacing=1 bgcolor=#CCCCCC border=1 width=100%>
<tr><td>
 <table cellpadding=1 cellspacing=1 bgcolor=#CCCCCC border=0 width=100%>
 <tr><td>
     <a href=javascript:InitTable(0)>
     <img src=../images/TableViewIcon.gif align=absmiddle 
      alt="Default View" title="Default View" border=0></a>
     <a href=javascript:InitTable(1)>
     <img src=../images/TableViewIcon.gif align=absmiddle 
      alt="Show Doctors" title="Show Doctors" border=0></a>
     <a href=javascript:InitTable(2)>
     <img src=../images/TableViewIcon.gif align=absmiddle 
      alt="Show Units" title="Show Units" border=0></a>
   </td><td>
&nbsp;Status
   <select name=statcode onchange=SelectPeriod.submit(this)>
   <option value="  "></option>
   %WATWEB01.03.014
   </select>
&nbsp;Unit
   <select name=unitcode onchange=SelectPeriod.submit(this)>
   <option value="   ">All</option>
   %WATWEB01.03.013
   </select>

     Doctor Code
     <input type=text name=doctcode id=doctcode size=6 maxlength=6
     value="%WATWEB01.03.019.003" >
     Doctor Name
     <input type=text name=name_doctcode id=name_doctcode size=15 maxlength=10
     value="%WATWEB01.03.019.002" >
     <img src=../images/SearchIcon.gif class=Icon
     onclick= "DoctorSearchFrame(doctcode,name_doctcode,SelectSubmit);">
     <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(doctcode,name_doctcode,SelectSubmit);">

  <input type=button value="<<" class=smallbutton
  onclick='%WATWEB01.03.002'>
  %WATWEB01.03.007
  <input type=button value=">>" class=smallbutton
  onclick='%WATWEB01.03.001'>
  </td><td align=right>
  <a href='javascript:SelectDateFrame();'>
  <img src="../images/DateLookup.gif" border=0
   alt="Select Date" title="Select Date" align=absmiddle></a>
  <a href='javascript:SelectView("0");'>
  <img src=../images/DayIcon.gif border=0
   alt="View Today" title="View Today" align=absmiddle></a>
  <a href='javascript:SelectView("4");'>
  <img src=../images/WeekIcon.gif border=0 
   alt="View This Week" title="View This Week" align=absmiddle></a>
  <a href='javascript:SelectView("2");'>
  <img src=../images/MonthIcon.gif border=0 
   alt="View This Month" title="View This Month" align=absmiddle></a>
</td></tr>
<tr><td>
    </td>
  <td colspan=3>

&nbsp;%STANDARD.01.017.TP
  <select name=catecode onchange=SelectPeriod.submit(this)>
  <option value="      ">All           </option>
  %WATWEB01.03.017
  </select>
  &nbsp;Listing Status<select name=listcode onchange=SelectPeriod.submit(this)>
  <option value="      ">All           </option>
  %WATWEB01.03.018
  </select>
  &nbsp;Removal Reason
  <select name="remstats" onchange=SelectPeriod.submit(this)>
    <option value="     ">All </option>
   %WATWEB01.03.026
  </select>
  </td>
 <td>
 </td></tr>
 </table>
</td></tr>
</table>
</form>

</div>

<div id=TableLocation></div>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=priocat value="%STANDARD.01.017.TP">
</form>

<script type='text/javascript'>
 //cabrini mate list
function serializeForm() {
  var form = document.getElementById('SelectPeriod');
  var sForm = new Array();

  for(var i = 0; i < form.length; i++) {
     var el = "";
     if(form[i].name == "") continue;
     switch(form[i].type) {
       case "select":
       case "select-one":
          if(form[i].name=='lastdate' 
             || form[i].name=='vyearmth'){
                el = form[i].name+"="+form[i][form[i].selectedIndex].value; 
          } else {
          	el = form[i].name+"="+form[i][form[i].selectedIndex].value.substr(0,3); 
          }
          break;
       case "text":
       case "hidden":
          el = form[i].name+"="+form[i].value;
          break;
     }
     sForm.push(el);
  }

  return sForm;
}

var count = 0;
var timerId = "";

window.onload = function () {
  if(typeof dynamicAddTableRows != 'undefined') {
    AddTableRows = dynamicAddTableRows;
    PageLoad();InitTable(0);SetReturnPathCookie();highlightReason()
    window.status = "";
  }else { 
     timerId = setTimeout(function(){
       count += 100;
       if( (count) == 80000) {
         alert('Warning: Connection to  timed out');
         window.status = "Connection failed  "+((count/10)/100)+"s";
         clearTimeout(timerId);
         return;
       }else {
         window.status = "Connecting "+((count/10)/100)+"s";
       }
       window.onload();
     },100);
  }
}

 var enddate = "";

 if(SelectPeriod.lastdate) {
    if(SelectPeriod.lastdate[SelectPeriod.lastdate.selectedIndex+1]) {
      enddate = SelectPeriod.lastdate[SelectPeriod.lastdate.selectedIndex+1].value;
    }
 }
 
 
 var nArray = serializeForm();
 var param = nArray.join('&');
 
   var url = "../cgi-bin/CabMateProxy.php?enddate="+enddate+
            "&"+param.replace(/ /g,'');
   var head = document.getElementsByTagName("head")[0];
   script = document.createElement('script');
   script.id = 'importedScriptId';
   script.type = 'text/javascript';
   script.src =  url;
   head.appendChild(script);

 var t = new Table(1,0,2,"100%","center",35,45);

</script>
