<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="cab">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb0111.js"></script>
<script type="text/javascript" >
function RemoveQuote(Field) {
    Field.value=Field.value.replace(/\"/g,"");
}
function changeOperation(theForm) { 
for (var i = 0; i < theForm.operpref.length; i++) {
 if (theForm.operpref.options[i].selected == true) {
  theForm.elements["operdes1"].value=theForm.operpref.options[i].text }
 }
}
function changeAdmitDate(theForm) {   
for (var i = 0; i < theForm.patadmdt.length; i++) {
 if (theForm.patadmdt.options[i].selected == true) {
  theForm.elements["operdes3"].value="Admit:"+theForm.patadmdt.options[i].text }
  }
}
function CancelBooking(linkurl) {
  Left=(document.body.clientWidth-640)/2
  DFrameLink(linkurl,0,Left,640,290)
}
function Check(){
 if(!validateMandatory(UpdateForm))
   return;
 UpdateForm.bkrec006.disabled=false
 UpdateForm.bkrec007.disabled=false
 UpdateForm.patadmdt.disabled=false
 UpdateForm.bkrec005.disabled=false

 if(document.UpdateForm.opdausr1.disabled!=true) {
   document.UpdateForm.operusr1.value=
   document.UpdateForm.opdausr1.value.substr(0,3);
 }

 if(isWhitespace(UpdateForm.patadmdt.value)) {
       UpdateForm.redirect.value="oprweb01.pbl?reportno=04&template=001"+
                  "&caseuniq="+UpdateForm.caseuniq.value.replace(/ /g,"+")
       UpdateForm.submit();
       return;
 }

 if(ChkDateTime(UpdateForm.patadmdt,null,UpdateForm.bookdate,null)){
       UpdateForm.redirect.value="oprweb01.pbl?reportno=04&template=001"+
                  "&caseuniq="+UpdateForm.caseuniq.value.replace(/ /g,"+")
       UpdateForm.submit();
    }
 else {
       alert("Theatre Booking cannot be before Admission Date");
      }
}
function checkWatEntry(){
   if (UpdateForm.bkrec006.value != "") {
     UpdateForm.bkrec015.focus()
   }else {
     UpdateForm.bkrec006.focus()
   }
}
function DisableIcon(field) {
  if (field.disabled == true) {
    alert(field.title+" is for display only")
    UpdateForm.bkrec015.focus()
  }
}
function SetPreAssDate() {
  if(checkDate(UpdateForm.patadmdt,'Confirmed Admission Date')) { 
    if(UpdateForm.patadmdt.defaultValue!=UpdateForm.patadmdt.value) {
      UpdateForm.patadmdt.defaultValue=UpdateForm.patadmdt.value;
      UpdateForm.bkrec006.value=UpdateForm.patadmdt.value;
    }
  }
}
function SetPreAssTime() {
  if(checkTime(UpdateForm.bkrec005,'Confirmed Admission Time')) { 
    if(UpdateForm.bkrec005.defaultValue!=UpdateForm.bkrec005.value) {
      UpdateForm.bkrec005.defaultValue=UpdateForm.bkrec005.value;
      UpdateForm.bkrec007.value=UpdateForm.bkrec005.value;
    }
  }
}
//------------------------------------------------------------
// Validate Operation Duration Average
//------------------------------------------------------------
function validateOprDurAve(ReturnCode,ReturnCod2,ReturnCod3,
                           ReturnDoct,ReturnName) {

    if (document.UpdateForm.opcnopav.value != "1") { return;}

//  var rcarray=[ReturnCode.value,ReturnCod2.value,ReturnCod3.value];

//  rcarray.reverse();

//  alert(rcarray[0]+" "+rcarray[1]+" "+rcarray[2]);

//  if (ReturnRadio[0].checked==true) {
    var serverURL   = "../cgi-bin/comweb80.pbl?reportno=67" +
                    "&valdcode=" + ReturnCode.value.replace(/ /g,"+") +
                    "&valdcod2=" + ReturnDoct.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|")
      if (!isWhitespace(ReturnValue[0])) {
        x=trim(ReturnValue[0])
      }
    } else {
        x=0;
    }

    var serverURL   = "../cgi-bin/comweb80.pbl?reportno=67" +
                    "&valdcode=" + ReturnCod2.value.replace(/ /g,"+") +
                    "&valdcod2=" + ReturnDoct.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|")
      if (!isWhitespace(ReturnValue[0])) {
        y=trim(ReturnValue[0])
      }
    } else {
        y=0;
    }

    var serverURL   = "../cgi-bin/comweb80.pbl?reportno=67" +
                    "&valdcode=" + ReturnCod3.value.replace(/ /g,"+") +
                    "&valdcod2=" + ReturnDoct.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|")
      if (!isWhitespace(ReturnValue[0])) {
        z=trim(ReturnValue[0])
      }
    } else {
        z=0;
    }

    rcarray=[x,y,z];

//    alert(rcarray[0]+" "+rcarray[1]+" "+rcarray[2]);
//    New Calculation of Duration via MBS Averages, refer iAssist 0877873
//    rcarray.sort(function(a,b){return a-b});

//    alert(rcarray[0]+" "+rcarray[1]+" "+rcarray[2]);

//    if (ReturnRadio[0].checked==true) {
//      ReturnName.value=parseInt(rcarray[0])*0.25 +
//                       parseInt(rcarray[1])*0.50 +
//                       parseInt(rcarray[2]);
      ReturnName.value=parseInt(rcarray[0]) +
                       parseInt(rcarray[1]) +
                       parseInt(rcarray[2]);
      ReturnName.value=parseInt(ReturnName.value,10);
//    }

//    if (ReturnRadio[1].checked==true) {
//      ReturnName.value=parseInt(rcarray[2]);
//      ReturnName.value=parseInt(ReturnName.value,10);
//    }

    return;
//  }

//  if (ReturnRadio[1].checked==true) {
//    var serverURL   = "../cgi-bin/comweb80.pbl?reportno=67" +
//                    "&valdcode=" + ReturnCode.value.replace(/ /g,"+") +
//                    "&valdcod2=" + ReturnDoct.value.replace(/ /g,"+");
//    var returnValue = RSExecute(serverURL);
//    if (returnValue.status==0) {
//      ReturnValue=returnValue.return_value.split("|")
//      if (!isWhitespace(ReturnValue[0])) {
//        ReturnName.value=trim(ReturnValue[0])
//      }
//    } else {
//        ReturnName.value=0;
//    }
//    return;
//  }
}

function defaultDuraCalc() {
  document.UpdateForm.duracalc[0].checked=false;
  document.UpdateForm.duracalc[1].checked=false;
}
function checkCertType1(){
  ct1=document.UpdateForm.operprv1;
  if(isWhitespace(ct1.value)) {
    crTypeDesc1.innerHTML=certtype1blank.innerHTML;
  } else {
          validateCode(4,
                       UpdateForm.operprv1,
                       UpdateForm.mbsdesc1,
                       UpdateForm.bookdate,
                       UpdateForm.dummy1,
                       UpdateForm.dummy2,
                       UpdateForm.dummy3,
                       UpdateForm.dummy4,
                       UpdateForm.dummy5,
                       UpdateForm.dummy6,
                       UpdateForm.dummy7,
                       UpdateForm.dummy8,
                       UpdateForm.dummy9,
                       UpdateForm.dummy10,
                       UpdateForm.certType1);

           if(!isWhitespace(UpdateForm.certType1.value)) {
            crDesc=UpdateForm.certType1.value;
            crTypeDesc1.innerHTML=document.UpdateForm.certType1.value;
           } else {
              crTypeDesc1.innerHTML=certtype1blank.innerHTML;
           }
      }
}
function checkCertType2(){
  ct2=document.UpdateForm.operprv2;
  if(isWhitespace(ct2.value)) {
    crTypeDesc2.innerHTML=certtype2blank.innerHTML;
  } else {
          validateCode(4,
                       UpdateForm.operprv2,
                       UpdateForm.mbsdesc2,
                       UpdateForm.bookdate,
                       UpdateForm.dummy1,
                       UpdateForm.dummy2,
                       UpdateForm.dummy3,
                       UpdateForm.dummy4,
                       UpdateForm.dummy5,
                       UpdateForm.dummy6,
                       UpdateForm.dummy7,
                       UpdateForm.dummy8,
                       UpdateForm.dummy9,
                       UpdateForm.dummy10,
                       UpdateForm.certType2);

           if(!isWhitespace(UpdateForm.certType2.value)) {
            crDesc=UpdateForm.certType2.value;
            crTypeDesc2.innerHTML=document.UpdateForm.certType2.value;
           } else {
              crTypeDesc2.innerHTML=certtype2blank.innerHTML;
           }
      }
}
function checkCertType3(){
  ct3=document.UpdateForm.operprv3;
  if(isWhitespace(ct3.value)) {
    crTypeDesc3.innerHTML=certtype3blank.innerHTML;
  } else {
          validateCode(4,
                       UpdateForm.operprv3,
                       UpdateForm.mbsdesc2,
                       UpdateForm.bookdate,
                       UpdateForm.dummy1,
                       UpdateForm.dummy2,
                       UpdateForm.dummy3,
                       UpdateForm.dummy4,
                       UpdateForm.dummy5,
                       UpdateForm.dummy6,
                       UpdateForm.dummy7,
                       UpdateForm.dummy8,
                       UpdateForm.dummy9,
                       UpdateForm.dummy10,
                       UpdateForm.certType3);

           if(!isWhitespace(UpdateForm.certType3.value)) {
            crDesc=UpdateForm.certType3.value;
            crTypeDesc3.innerHTML=document.UpdateForm.certType3.value;
           } else {
              crTypeDesc3.innerHTML=certtype3blank.innerHTML;
           }
      }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);checkWatEntry();
              validateOprDurAve(document.UpdateForm.operprv1,
                                document.UpdateForm.operprv2,
                                document.UpdateForm.operprv3,
                                document.UpdateForm.surgcalc,
                                document.UpdateForm.operexpd);
              dispCertType1(document.UpdateForm.certType1);
              dispCertType2(document.UpdateForm.certType2);
              dispCertType3(document.UpdateForm.certType3);
              UpdateForm.patclaim.focus();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB01.11.203";
PatientVIS="%OPRWEB01.11.281";
PatientNAM="%OPRWEB01.11.202";
PatientSTA="%OPRWEB01.11.286.078";
PatientALT="%OPRWEB01.11.284";
PatientSEX="%OPRWEB01.11.219";
PatientDOB="%OPRWEB01.11.220";
PatientAGE="%OPRWEB01.11.221";
PatientLOC="%OPRWEB01.11.283";
PatientPRI="%OPRWEB01.11.286.066.1";
PatientUNT="%OPRWEB01.11.266.0";
DoctorCOD="%OPRWEB01.11.282.003";
DoctorNAM="%OPRWEB01.11.282.002";
PatientAID="%OPRWEB01.11.286.090";
PatientIND="%OPRWEB01.11.286.091";
PatientCUR="%OPRWEB01.11.286.092";
PatientCLC="%OPRWEB01.11.286.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB01.11.286.094";
PatientCDM="%OPRWEB01.11.286.095";
PatientVDH="%OPRWEB01.11.286.099.015";
PatCrtType1="%OPRWEB01.11.794";
PatCrtType2="%OPRWEB01.11.795";
PatCrtType3="%OPRWEB01.11.796";
InsertPatientHeader()
</script>

<div id=PatientMenu></div>
<div id=PageBodySection>

<form name=UpdateForm onSubmit="return validateMandatory(this);"
 action=oprweb01.pbl method=post style="margin:0">
<input type=hidden name=reportno value=12>
<input type=hidden name=template value=1>
<input type=hidden name=casekeys value="%OPRWEB01.11.001">
<input type=hidden name=caseuniq value="%OPRWEB01.11.710">
<input type=hidden name=bookdate value="%OPRWEB01.11.102">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect >
<input type=hidden name=uvthindi value="1">
<input type=hidden name=operusr1 value="%OPRWEB01.11.716.1">
<input type=hidden name=currflag value="%OPRWEB01.11.067">
<input type=hidden name=pthvflag value="%OPRWEB01.11.068">
<input type="hidden" name="surgcalc" value="%OPRWEB01.11.190.003">
<input type=hidden name=firstbok value="1">
<input type=hidden name=opcnopav value="%STANDARD.01.025.113. 41.0.1">
<input type=hidden name=dummy1>
<input type=hidden name=dummy2>
<input type=hidden name=dummy3>
<input type=hidden name=dummy4>
<input type=hidden name=dummy5>
<input type=hidden name=dummy6>
<input type=hidden name=dummy7>
<input type=hidden name=dummy8>
<input type=hidden name=dummy9>
<input type=hidden name=dummy10>
<input type=hidden name=certType1 value="%OPRWEB01.11.794">
<input type=hidden name=certType2 value="%OPRWEB01.11.795">
<input type=hidden name=certType3 value="%OPRWEB01.11.796">

<table border="0" cellpadding="0" cellspacing="0" width="95%" align=center>
<tr><td align=center class=HeadingCell>Update Booking Form</td></tr>
</table>

<table border="0" cellpadding="0" cellspacing="0" width="95%" align=center>
<tr><td width=15% class=DataLabel>Surgeon   </td>
    <td ><a href='javascript:DoctorViewFrame("%OPRWEB01.11.104.003")'>
         <b>%OPRWEB01.11.104.002 &nbsp;</b></a></td>
    <td width=15%>Anaesthetist   </td>
    <td><a href='javascript:DoctorViewFrame("%OPRWEB01.11.116.003")'>
         %OPRWEB01.11.116.002</a></td></tr>

<tr><td class=DataLabel>Unit  </td>
    <td class=DataField> %OPRWEB01.11.113.0</td></tr>

<tr><td width=15% class=DataLabel>Theatre  </td>
    <td class=DataField> %OPRWEB01.11.114.0 </td>
    <td class=DataLabel>Session Type       </td>
    <td class=DataField>%OPRWEB01.11.169.0  </td></tr>

<tr><td class=DataLabel>Date  </td>
    <td class=DataField>%OPRWEB01.11.106 %OPRWEB01.11.102</td>
    <td class=DataLabel>Time  </td>
    <td class=DataField> %OPRWEB01.11.103 to %OPRWEB01.11.108</td></tr>
<tr><td colspan=4 align=center><hr width=100%></td></tr>
<tr><td class=DataLabel>%STANDARD.01.017.OY</td>
    <td class=DataField>
    <select name=opertype title="STANDARD.01.017.OY" class=Mandatory>
    <option></option>
    %OPRWEB01.11.714.2
    </select>
</td></tr>
<tr><td class=DataLabel>Pre-Assesment</td>
    <td class=DataLabel>
    <input type=text name=bkrec006 id=bkrec006 size=12 maxlength=11 class=""
     value="%OPRWEB01.11.808" onblur="checkDate(this,'Date')"
     title="Pre-Assesment Date" tabindex=1 >
    <img src=../images/DateLookup.gif border=0 hspace=4 align=absmiddle
    onclick='javascript:DateLookupFrame(bkrec006)'
     onFocus='javascript:DisableIcon(bkrec006)' tabindex=-1>
    Time
    <input type=text name=bkrec007 size=7 id=bkrec007
     title="Pre-Assesment Time" tabindex=2 value="%OPRWEB01.11.809">
    <img src=../images/DateTimeStamp.gif  border=0 hspace=4 align=absmiddle  
    onClick="SetCurrentDateTime(bkrec006,bkrec007);"
    onFocus='javascript:DisableIcon(bkrec007)' tabindex=-1>
    <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle  
    onclick="TimeLookupFrame(bkrec007);"
    onFocus='javascript:DisableIcon(bkrec007)' tabindex=-1> 
    </td>
    <td class=DataLabel>Confirmed Admission</td>
    <td class=DataLabel>
     <input type=text name=patadmdt id=patadmdt 
            size=12 maxlength=11 class=Mandatory
     onblur="SetPreAssDate();" title="Confirmed Admission" 
     value="%OPRWEB01.11.806">
     <img src=../images/DateLookup.gif border=0 hspace=4 align=absmiddle
     onclick='javascript:DateLookupFrame(patadmdt)'
     onFocus='javascript:DisableIcon(patadmdt)' tabindex=-1>
    Time
    <input type=text name=bkrec005 id=bkrec005 
           size=7 title="Admission Time" class=Mandatory
     value='%OPRWEB01.11.807' tabindex=4 onblur="SetPreAssTime();">
    <img src=../images/DateTimeStamp.gif  border=0 hspace=4 align=absmiddle
     onclick='javascript:SetCurrentDateTime(patadmdt,bkrec005)'
     onFocus='javascript:DisableIcon(bkrec005)' tabindex=-1>
    <img src=../images/TimeLookup.gif border=0 hspace=4 align=absmiddle
    onclick='javascript:TimeLookupFrame(bkrec005)'
     onFocus='javascript:DisableIcon(bkrec005)' tabindex=-1>
    </td></tr>

<tr><td class=DataLabel>Admitting Point</td>
    <td class=DataField>
    <select name=bokrx003 title="Admitting Point"  class=Mandatory>
    <option></option>
    %OPRWEB01.11.603.2
    </select></td>
    <td class=DataLabel>Planned Length of Stay </td>
    <td class=DataLabel>
    <input type=text name=bkrec033 size=4 maxlength=3 class=Integer
           title="Planned Length of Stay"  
           tabindex=6>(days)</td></tr>

<tr><td class=DataLabel>Exp. Admitting Ward</td>
    <td class=Datalabel>
    <select name=bkrec015 title="Exp. Admitting Ward" tabindex=5 class=Mandatory
     onchange="selectOptions2('31',UpdateForm.bkrec015,UpdateForm.bkrec018);">
    <option></option>
    %OPRWEB01.11.841.2
    </select>
    Bed
    <select name=bkrec018 title="Expected Bed" tabindex=5>
    <option></option>
    %OPRWEB01.11.842.1
    </select>
    </td>
    <td class=DataLabel>Exp.Post Op Ward</td>
    <td class=DataLabel>
    <select name=bokrx002 title="Exp.Post Op Ward" tabindex=5
     onchange="selectOptions2('31',UpdateForm.bokrx002,UpdateForm.bokrx038);">
    <option></option>
    %OPRWEB01.11.602.2
    </select>
    Bed
    <select name=bokrx038 title="Expected Post-Op Bed" tabindex=5>
    <option></option>
    %OPRWEB01.11.638.1
    </select>
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.P </td>
    <td class=DataField>
    <select name=bkrec019
            title="%STANDARD.01.017.P "
            tabindex=7>
    <option></option>
    %OPRWEB01.11.823.2
    </select></td>
<!--
    <td class=DataLabel>Unit</td>
    <td class=DataField>
    <select name=bkrec021
            title="Unit"
            class=Mandatory
            tabindex=8>
    <option></option>
    OPRWEB01.11.825.2
    </select></td>-->
</tr>
<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField>
 <select name="patclaim" title="%STANDARD.01.017.CL" class=Mandatory tabindex=9>
     <option></option>
     %OPRWEB01.11.827.9.1.10.2.X
     </select></td>
     <td class=DataLabel>Admission Source</td>
     <td class=DataField>
     <select name="bokrx031" 
             title="Admission Source">
     <option></option>
     %OPRWEB01.11.631.2
     </select></td></tr>

<tr valign=top>
    <td class=DataLabel>Anaesthetic Type</td>
    <td><select name="operanae" title="Anaesthetic" tabindex=10>
    <option></option>
    %OPRWEB01.11.006.2
    </select></td>
    <td class=DataLabel> Duration </td>
    <td><input type=text name="operexpd" size=6 maxlength=4 min=0
             title="Operation Expected Duration" class="Mandatory Integer"
             value="%OPRWEB01.11.038"> (minutes)
<!--
        Calculate Minutes <input type=radio name=duracalc
                       onclick='validateOprDurAve(operprv1,operprv2,operprv3,
                                                  surgcalc,operexpd,duracalc);'>
        Single Procedure Only <input type=radio name=duracalc
                       onclick='validateOprDurAve(operprv1,operprv2,operprv3,
                                                  surgcalc,operexpd,duracalc);'>
-->
<!--
    <td><select name="operexpd" 
             title="Operation Expected Duration"
             class=Mandatory
             tabindex=11>
    <option value=""></option>
    <option value="  10">10 min</option>
    <option value="  20">20 Min</option>
    <option value="  30">30 min</option>
    <option value="  40">40 min</option>
    <option value="  50">50 min</option>
    <option value="  60">60 min</option>
    <option value="  70">70 min</option>
    <option value="  80">80 min</option>
    <option value="  90">90 min</option>
    <option value=" 100">100 min</option>
    <option value=" 110">110 min</option>
    <option value=" 120">120 Min</option>
    <option value=" 130">130 min</option>
    <option value=" 140">140 min</option>
    <option value=" 150">150 min</option>
    <option value=" 160">160 min</option>
    <option value=" 170">170 min</option>
    <option value=" 180">180 min</option>
    <option value=" 190">190 min</option>
    <option value=" 200">200 min</option>
    <option value=" 210">210 min</option>
    <option value=" 220">220 min</option>
    <option value=" 230">230 min</option>
    <option value=" 240">240 min</option>
    <option value=" 250">250 min</option>
    <option value=" 260">260 min</option>
    <option value=" 270">270 min</option>
    <option value=" 280">280 min</option>
    <option value=" 290">290 min</option>
    <option value=" 300">300 min</option>
    </select>
-->
    </td></tr>

<tr><td class=DataLabel>MBS Codes</td>
    <td><input type=text name=operprv1 size=9 
           onblur='validateMBSCode(17,
                                   UpdateForm.operprv1,
                                   UpdateForm.mbsdesc1,
                                   UpdateForm.casekeys,
                                   UpdateForm.bookdate);
                   validateOprDurAve(UpdateForm.operprv1,
                                     UpdateForm.operprv2,
                                     UpdateForm.operprv3,
                                     UpdateForm.surgcalc,
                                     UpdateForm.operexpd);
                   checkCertType1()';
           title="Expected MBS Item 1"
           tabindex=12>
        <input type=text  readonly name=mbsdesc1 size=35
           title="Expected MBS Item 1 Name " class=ReadOnly
           value="%OPRWEB01.11.721.0" >
     <img src="../images/SearchIcon.gif" class=Icon
           onClick="MbsSearchFrame(UpdateForm.operprv1,
                                   UpdateForm.mbsdesc1,
                                   UpdateForm.bookdate)">
             <font color=red><span id=crTypeDesc1></span></font></td>
<td class=DataLabel>%STANDARD.01.017.Y6</td>
    <td class=DataField>
    <select name=opdausr1 title="%STANDARD.01.017.Y6">
    <option></option>
    %STANDARD.01.007.Y6
    </select></td>
</tr>

<tr><td></td>
    <td><input type=text name=operprv2 size=9
           onblur='validateCode(4,
                                UpdateForm.operprv2,
                                UpdateForm.mbsdesc2,
                                UpdateForm.bookdate,
                                UpdateForm.dummy1,
                                UpdateForm.dummy2,
                                UpdateForm.dummy3,
                                UpdateForm.dummy4,
                                UpdateForm.dummy5,
                                UpdateForm.dummy6,
                                UpdateForm.dummy7,
                                UpdateForm.dummy8,
                                UpdateForm.dummy9,
                                UpdateForm.dummy10,
                                UpdateForm.certType2);
                   checkCertType2();
                   validateOprDurAve(UpdateForm.operprv1,
                                     UpdateForm.operprv2,
                                     UpdateForm.operprv3,
                                     UpdateForm.surgcalc,
                                     UpdateForm.operexpd);'
           title="Expected MBS Item 2"
           tabindex=13>
        <input type=text readonly name=mbsdesc2 size=35
           title="Expected MBS Item 2 Name" class=ReadOnly
           value="%OPRWEB01.11.722.0">
         <img src="../images/SearchIcon.gif" class=Icon
           onClick="MbsSearchFrame(UpdateForm.operprv2,
                                   UpdateForm.mbsdesc2,
                                   UpdateForm.bookdate)">
             <font color=red><span id=crTypeDesc2></span></font></td>
    <td class=DataLabel>Infection Status </td>
    <td><select name="operknow" 
             title="Infection Status">
    <option></option>
    %OPRWEB01.11.740.2
    </select>
    </td></tr>


<tr><td></td>
    <td><input type=text name=operprv3 size=9
           onblur='validateCode(4,
                                UpdateForm.operprv3,
                                UpdateForm.mbsdesc3,
                                UpdateForm.bookdate,
                                UpdateForm.dummy1,
                                UpdateForm.dummy2,
                                UpdateForm.dummy3,
                                UpdateForm.dummy4,
                                UpdateForm.dummy5,
                                UpdateForm.dummy6,
                                UpdateForm.dummy7,
                                UpdateForm.dummy8,
                                UpdateForm.dummy9,
                                UpdateForm.dummy10,
                                UpdateForm.certType3);
                   checkCertType3();
                   validateOprDurAve(UpdateForm.operprv1,
                                     UpdateForm.operprv2,
                                     UpdateForm.operprv3,
                                     UpdateForm.surgcalc,
                                     UpdateForm.operexpd);'
           title="Expected MBS Item 3"
           tabindex=14>
    <input type=text readonly name=mbsdesc3 size=35
           title="Expected MBS Item 3 Name" class=ReadOnly 
           value="%OPRWEB01.11.723.0">
    <img src="../images/SearchIcon.gif" class=Icon
           onClick="MbsSearchFrame(UpdateForm.operprv3,
                                   UpdateForm.mbsdesc3,
                                   UpdateForm.bookdate)">
             <font color=red><span id=crTypeDesc3></span></font></td>
    <td class=DataLabel>Equipment Req 1</td>
    <td><select name="opdea032" 
             title="Equipment Required 1">
    <option></option>
    %OPRWEB01.11.745.5
    </select>
    </td></tr>

<tr valign=top>
    <td class=DataLabel>Full Description</td>
    <td><input type="text" size="55" maxlength=80 name="operdes1" 
           title="Operation Description 1"
           tabindex=15 onblur="RemoveQuote(this);"></td>
    <td class=DataLabel>Equipment Req 2</td>
    <td><select name="opdea033" 
             title="Equipment Required 2">
    <option></option>
    %OPRWEB01.11.746.2
    </select>
    </td></tr>

<tr><td></td><td><input type="text" size="55" maxlength=80 name="operdes2" 
           title="Operation Description 2" tabindex=17 
           onblur="RemoveQuote(this);"></td>
<!-- title="Operation Description 2" value="OPRWEB01.11.050" -->
    <td class=DataLabel>Equipment Req 3</td>
    <td><select name="opdea035" 
             title="Equipment Required 3">
    <option></option>
    %OPRWEB01.11.749.2
    </select>
    </td></tr>

<tr><td></td><td><input type="text" size="55" maxlength=80 name="operdes3" 
           title="Operation Description 2" onblur="RemoveQuote(this);"
           tabindex=18> </td>
    <td class=DataLabel>Equipment Loaned</td>
    <td><select name="opdea034" 
             title="Equipment Loaned">
    <option></option>
    %OPRWEB01.11.747.2
    </select>
    </td></tr>

<tr><td class=DataLabel>Prosthesis Required</td>
    <td colspan=3>
    <input type="text" size="40" maxlength=40 name=opercomm
           title="Operation Comment" tabindex=19 value='%OPRWEB01.11.728'>
    </td>
</tr>
<tr valign=top><td class=DataLabel>Comments
    <td colspan=3>
<textarea wrap=hard cols=60 rows=3 name=opcom009>%OPRWEB01.11.743.009</textarea>
    </tr>

<tr><td colspan=4 align="center">
    <input type=button id="opr01sub" class="button" value="Ok"
     onclick="tempDisable(this);Check();">
    <input type=button class="button" value="Cancel" onclick="history.go(-1)">
    </td></tr>
</table>
</form>
</div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=9>
<input type=hidden name=template value=002>
<input type=hidden name=urnumber value="%OPRWEB01.11.203">
<input type=hidden name=admissno value="%OPRWEB01.11.281">
<input type=hidden name=MenuType value="%OPRWEB01.11.288">
<input type=hidden name=casekeys value="%OPRWEB01.11.001">
</form>
<SCRIPT LANGUAGE=javascript>
   document.UpdateForm.bkrec033.value="%OPRWEB01.11.830" ;
   document.UpdateForm.operprv1.value="%OPRWEB01.11.046" ;
   document.UpdateForm.operprv2.value="%OPRWEB01.11.047" ;
   document.UpdateForm.operprv3.value="%OPRWEB01.11.048" ;
   document.UpdateForm.operdes1.value="%OPRWEB01.11.751" ;
   document.UpdateForm.operdes2.value="%OPRWEB01.11.752" ;
   document.UpdateForm.operdes3.value="%OPRWEB01.11.753" ;
   for (var i =0 ; i < document.UpdateForm.patadmdt.length; i++) {
     if (document.UpdateForm.patadmdt.options[i].value=="%OPRWEB01.11.036") {
         document.UpdateForm.patadmdt.selectedIndex=i } };
// for (var i =0 ; i < document.UpdateForm.operexpd.length; i++) {
//   if (document.UpdateForm.operexpd.options[i].value=="%OPRWEB01.11.038") {
//       document.UpdateForm.operexpd.selectedIndex=i } };

/*
   for (var i =0 ; i < document.UpdateForm.bkrec019.length; i++) {
     if (document.UpdateForm.bkrec019.options[i].value=="%OPRWEB01.11.423.0") {
         document.UpdateForm.bkrec019.selectedIndex=i } };
   for (var i =0 ; i < document.UpdateForm.bkrec021.length; i++) {
     if (document.UpdateForm.bkrec021.options[i].value=="%OPRWEB01.11.413.0") {
         document.UpdateForm.bkrec021.selectedIndex=i } };
*/

   for (var i =0 ; i < document.UpdateForm.opdausr1.length; i++) {
     if (document.UpdateForm.opdausr1.options[i].value.substr(0,3)==
         document.UpdateForm.operusr1.value) {
         document.UpdateForm.opdausr1.selectedIndex=i } };

   if (document.UpdateForm.pthvflag.value=="0") {
    document.UpdateForm.opdausr1.className="readonly";
    document.UpdateForm.opdausr1.disabled=true;
   }

   document.UpdateForm.patclaim.focus();

function dispCertType1(certType1){
  if(isWhitespace(document.UpdateForm.certType1.value)) {
    crTypeDesc1.innerHTML=certtype1blank.innerHTML;
  } else {
    crTypeDesc1.innerHTML=document.UpdateForm.certType1.value;
  }
}
function dispCertType2(certType2){
  if(isWhitespace(document.UpdateForm.certType2.value)) {
    crTypeDesc2.innerHTML=certtype2blank.innerHTML;
  } else {
    crTypeDesc2.innerHTML=document.UpdateForm.certType2.value;
  }
}
function dispCertType3(certType3){
  if(isWhitespace(document.UpdateForm.certType3.value)) {
    crTypeDesc3.innerHTML=certtype3blank.innerHTML;
  } else {
    crTypeDesc3.innerHTML=document.UpdateForm.certType3.value;
  }
}
</SCRIPT>

<span id=certtype1 style="display:none"></span>
<span id=certtype1blank style="display:none">&nbsp;</span>
<span id=certtype2 style="display:none"></span>
<span id=certtype2blank style="display:none">&nbsp;</span>
<span id=certtype3 style="display:none"></span>
<span id=certtype3blank style="display:none">&nbsp;</span>
</span>

