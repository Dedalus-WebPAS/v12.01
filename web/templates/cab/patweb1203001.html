<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="cab">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/patweb1203.js"></script>
<style type="text/css">
  #box1{
        position: absolute;
        top: 100px;
        left: 100px;
        border-style: outset;
        background-color: #fff8ff;
        padding: 3px;
        visibility: hidden;
       }
  #box2{
        position: absolute;
        top: 100px;
        left: 100px;
        border-style: outset;
        background-color: #fff8ff;
        padding: 3px;
        visibility: hidden;
        color: red;
       }
  span.ProgressBar {
    color:black;
    background-image:url(../images/ProgressBar.gif);
    height:10px;
    width:200px;
    text-align:center;
  }
  #PageSearchResults {
    border:2px solid #cccccc;
    position:absolute;
    background-color: #fff8ff;
    top:35px;
    width:365px;
    height:250px;
    left:218px;
    visibility: hidden;
  }
</style>
<script type="text/javascript">
function BBRefresh(timeOut) {
    window.setInterval('AJAXRefresh1()',timeOut * 60 * 1000);
}
// Get Cached Result and Trigger background Refresh of Cache
function AJAXRefresh1() {
   theURL = "patweb12.php?reportno=3&template=10"
   AJAXRefresh(theURL);
   setTimeout(function () { CheckCache() },100);
}
function CheckCache() {
   if (isWhitespace(document.SearchForm.bedboard.value)) document.SearchForm.bedboard.value="1"
   theURL = "patweb12.php?reportno=3&template=10&newcache=true&gencache=true"
   theURL = theURL + '&hospcode='+document.SearchForm.hospcode.value +
                     '&bedboard='+document.SearchForm.bedboard.value +
                     '&httprand='+Math.random();
   var xmlHttp = createHttpObject();
   xmlHttp.open("GET", theURL, true);
   xmlHttp.send();
}
function AJAXRefresh2() {
  theURL = "patweb12.php?reportno=3&template=10&newcache=true"
  AJAXRefresh(theURL);
}
function AJAXRefresh(theURL) {
   startDate = new Date();
   startTime = startDate.getTime();
   ProgressBar.innerHTML='Loading Page ....';
   ProgressBar.style.backgroundImage='url(../images/ProgressBar.gif)';
   if (isWhitespace(document.SearchForm.bedboard.value)) document.SearchForm.bedboard.value="1"
   theURL = theURL + '&hospcode='+document.SearchForm.hospcode.value +
                     '&bedboard='+document.SearchForm.bedboard.value +
                     '&httprand='+Math.random();
   var xmlHttp = createHttpObject();
   xmlHttp.open("GET", theURL, true);
   xmlHttp.onreadystatechange=function() {
    if (xmlHttp.readyState==4) {
      if (xmlHttp.responseText!="") {
        startDate = new Date();
        endTime = startDate.getTime();
        ServerTime=((endTime-startTime)/1000) 
        PageBodySection.innerHTML   = xmlHttp.responseText;
        ProgressBar.style.backgroundImage='url()';
        startDate = new Date();
        endTime = startDate.getTime();
        PageTime=((endTime-startTime)/1000)
        ProgressBar.innerHTML='Server: '+ServerTime+'  Client: '+PageTime;
        document.SearchForm.unallocp.value=UnallocatedCount.innerHTML;

//      var divcounter = 1;
//      while (document.getElementById('fldiv'+divcounter)!=null) {
//        JSFX_FloatDivYDIV("fldiv"+divcounter, 0,0,PageBodySection).floatIt();
//        divcounter = divcounter + 1;
//      }
      }
    }
  }
  xmlHttp.send();
}

function changeDivSize() {
    var patDiv = document.getElementById('PageBodySection');
    var patHeader = document.getElementById('PageHeadingSection');

    if(typeof patDiv != 'undefined' && typeof patHeader != 'undefined') {
        patDiv.style.height = document.body.offsetHeight - patHeader.offsetHeight;
    }
}
function floatColumnHeader() {

  var divcounter = 1;
  while (document.getElementById('fldiv'+divcounter)!=null) {
//alert(PageBodySection.scrollTop);
    document.getElementById('fldiv'+divcounter).style.top=
    PageBodySection.scrollTop;

    divcounter = divcounter + 1;
  }

}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);AJAXRefresh1();BBRefresh(%STANDARD.01.025.114.142.0.3);changeDivSize();"
      onresize="changeDivSize();">
<div id="PageHeadingSection">
<form name="SearchForm" onsubmit="AJAXSearch(); return false;" style="margin:0">
<input type="hidden" name="reportno" value="3">
<input type="hidden" name="template" value="1">
<input type="hidden" name="hospcode" value="%PATWEB12.03.044">
<input type="hidden" name="bedboard" value="%PATWEB12.03.045">

<table class="StandardTable" cellspacing=0>
<tr><td class="HeadingCell" colspan="2" align="center">Bed Board View</td>
    <td align=right class="HeadingCell">
    <span id=ProgressBar class=ProgressBar>Loading Page... </span>
    </td></tr>

<tr><td class="HeadingCell">    
    <input type=button value="Refresh" onclick='AJAXRefresh1();'>
    <img src="../images/HelpIcon.gif" class="Icon"
                           onclick="ShowBedLegend();"/>&nbsp;Legend
    </td>
    <td class=HeadingCell>Surname
        <input type="text" name="srchsnam" size="22" maxlength="20"
         value="%PATWEB12.03.013" onblur="UpCase(this)">
        Given Name
        <input type="text" name="srchgnam" size="27" maxlength="25"
         value="%PATWEB12.03.014" onblur="UpCase(this)">
        <input type="submit" class="button" value="Search">
    </td>
    <td class="HeadingCell" align="right">
    Patients in Un-Allocated Beds
    <input type="text" name="unallocp" size="4" class="Readonly" readonly>
    </tr>
</table>
</form>
</div>

<div id="box1"></div>
<div id="box2"></div>
<div id="PageSearchResults"></div>
<div id="PageBodySection" onscroll="floatColumnHeader()"> </div>
