<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="bhs">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">`
<script type="text/javascript"> 
function ProcessSubmit() {
  document.UpdateForm.submit();
}
function DeleteBooking(){
    LinkUrl="patweb92.pbl?reportno=06&template=005&urnumber=" + 
            document.UpdateForm.urnumber.value.replace(/ /g,"+") +
            "&admissno=" + document.UpdateForm.admissno.value.replace(/ /g,"+");
    Left=(document.body.clientWidth-700)/2;
    DFrameLink(LinkUrl,100,Left,700,250);
}
  function CheckBooking() {
    if (UpdateForm.bkrec008.value.substr(14,3)=="MAT") {
     LinkUrl="oprweb01.pbl?reportno=7&template=2&admissno="
                  + document.UpdateForm.admissno.value.replace(/ /g,"+") 
                  + "&urnumber=" +document.UpdateForm.urnumber.value.replace(/ /g,"+");
       alert(LinkUrl);
     location.href=LinkUrl;
//     DFrameLink(LinkUrl,50,0,740,390);
    }
  }
function valDoctorUnit() {
  validateCode(31,UpdateForm.bkrec002,UpdateForm.n_bkrec002);
  selectOptions("30",UpdateForm.bkrec002,UpdateForm.bkrec021);
  UpdateForm.bkrec021.selectedIndex=1
}
function valClaimCode() {
  if (UpdateForm.bkrec023.value=="") {
  validateCode(41,LinkForm.urnumber,UpdateForm.claimc);
  for (var i =0 ; i < document.UpdateForm.bkrec023.length; i++) {
    if (document.UpdateForm.claimc.value==
        trim(document.UpdateForm.bkrec023.options[i].value.substr(0,3))){
          document.UpdateForm.bkrec023.selectedIndex=i;
    }
  } }
}
function init(){
for (var i =0 ; i < document.UpdateForm.bkrec015.length; i++) {
    if (trim(document.UpdateForm.exptward.value)==
        trim(document.UpdateForm.bkrec015.options[i].value.substr(0,3))){
          document.UpdateForm.bkrec015.selectedIndex=i;
    }
 }
}

function removeTheatreIfMedicalType()
{
  var bktype = document.getElementById("bktype");
  var selectionList = document.getElementById("bkrec008");

  if(bktype)
  {
    //if its not a theatre booking - remove it
    if(bktype.value.substr(14,3)  != "THE")
    {
      //scan the whole drop down
      for(var i = 0; i < selectionList.length; i++)
      {
        //checking for Theatre booking type
        if(selectionList[i].value.substr(14,3) == "THE")
        {
           selectionList.remove(i); //if we remove one element
           i--;//we also need need to reduce the counter
        }
      }
    }
  }
}

function PageLoadExtended()
{
  PageLoad();
  valClaimCode();
  removeTheatreIfMedicalType();
}
</script>
%START.OF.PAGE
</head>
<body onload="PageLoadExtended();">
<div id=PageHeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB01.07.003";
PatientVIS="%OPRWEB01.07.081";
PatientNAM="%OPRWEB01.07.002";
PatientSTA="%OPRWEB01.07.086.078";
PatientALT="%OPRWEB01.07.084";
PatientSEX="%OPRWEB01.07.019";
PatientDOB="%OPRWEB01.07.020";
PatientAGE="%OPRWEB01.07.021";
PatientLOC="%OPRWEB01.07.083";
PatientPRI="%OPRWEB01.07.086.066.1";
PatientUNT="%OPRWEB01.07.066.0";
DoctorCOD="%OPRWEB01.07.082.003";
DoctorNAM="%OPRWEB01.07.082.002";
PatientAID="%OPRWEB01.07.086.090";
PatientIND="%OPRWEB01.07.086.091";
PatientCUR="%OPRWEB01.07.086.092";
PatientCLC="%OPRWEB01.07.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB01.07.086.094";
PatientCDM="%OPRWEB01.07.086.095";
PatientVDH="%OPRWEB01.07.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
</div>
<div id=PageBodySection>
<form name=LinkForm action=oprweb01.pbl method=get target=content
 style="margin:0">
<input type=hidden name=reportno value=9>
<input type=hidden name=template value=2>
<input type=hidden name=urnumber value="%OPRWEB01.07.003">
<input type=hidden name=sesskeys value="">
</form>

<form name=UpdateForm action=oprweb01.pbl method=post style="margin:0"
 onsubmit="return validateMandatory(this);">
<input type=hidden name=reportno value=7>
<input type=hidden name=template value=1>
<input type=hidden name=setbookf value=1>
<input type=hidden name=updttype value=U>
<input type=hidden name=urnumber value="%OPRWEB01.07.003">
<input type=hidden name=claimc>
<input type=hidden name=exptward value="%OPRWEB01.07.119">
<input type=hidden name=admissno value="%OPRWEB01.07.081">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="%OPRWEB01.07.001.patweb98.01.001">
<input type="hidden" name="bktype"   value="%OPRWEB01.07.111.3" />

<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td>&nbsp;</td></tr>
<tr><td class=DataLabel>Booking Type</td>
   <td class=DataField colspan=3>
   <select name=bkrec008 onchange="CheckBooking();"
    class=Mandatory title="Booking Type">
   <option></option>
    %OPRWEB01.07.111.2
   </select></td></tr>

<tr><td class=DataLabel>Coded Diagnosis</td>
   <td class=DataField colspan=3>
   <input type=text size=12 name=bkrec035 value="%OPRWEB01.07.131">
   <input type=text name=bkrec036 size=70 maxlength=50 value="%OPRWEB01.07.132">
   <a href="javascript:Icd10ProSearchFrame(UpdateForm.bkrec035,
                                           UpdateForm.bkrec036);">
   <img src=../images/SearchIcon.gif class=Icon>
   </a></td></tr>

<tr><td class=DataLabel>Diagnosis</td>
   <td class=DataField colspan=3>
   <input type=text name=bkrec037 size=70 maxlength=50 value="%OPRWEB01.07.133">
   </td></tr>

<tr><td class=DataLabel>Pre-Assessment</td>
    <td class=DataLabel colspan=3>
    <input type=text name=bkrec006 size=12 value="%OPRWEB01.07.108"
     title="Pre-Assessment Date">
    <img src="../images/DateLookup.gif" class=Icon date=UpdateForm.bkrec006>
    Time
    <input type=text name=bkrec007 size=10 value="%OPRWEB01.07.109"
     title="Pre-Assessment Time">
    <img src="../images/DateTimeStamp.gif" class=Icon date=UpdateForm.bkrec006
     time=UpdateForm.bkrec007>  
    <img src="../images/TimeLookup.gif" class=Icon time=UpdateForm.bkrec007>  
    </td></tr>

<tr><td class=DataLabel>Scheduled Admission</td>
    <td class=DataLabel>
    <input type=text name=bkrec004 size=12 value="%OPRWEB01.07.106"  
     class=Mandatory title="Scheduled Admission Date">
    <img src="../images/DateLookup.gif" class=Icon date=UpdateForm.bkrec004>
    Time
    <input type=text name=bkrec005 size=10  value="%OPRWEB01.07.107"
    class=Mandatory title="Scheduled Admission Time">
    <img src="../images/DateTimeStamp.gif" class=Icon date=UpdateForm.bkrec004
     time=UpdateForm.bkrec005>  
    <img src="../images/TimeLookup.gif" class=Icon time=UpdateForm.bkrec005>  
    </td>

<tr><td class=DataLabel>Expected Ward</td>
    <td class=DataField>
    <select name=bkrec015 class=Mandatory title="Expected Ward">
    <option></option>
     %OPRWEB01.07.202.2
    </select></td>
    <td class=DataLabel>Intended Length of Stay </td>
    <td class=DataLabel>
    <input type=text name=bkrec033 size=4 maxlength=5
     value="%OPRWEB01.07.130">(days)</td></tr>

<tr><td class=DataLabel>Consultant</td>
    <td class=DataField >
    <input type=text name=bkrec002 size=8 maxlength=8 class=Mandatory
     value="%OPRWEB01.07.104.003" title="Consultant"
     onchange="valDoctorUnit();">
    <input type=text name=n_bkrec002 size=40 value="%OPRWEB01.07.104.002">
    <a href="javascript:DoctorSearchFrame(UpdateForm.bkrec002,
                                          UpdateForm.n_bkrec002)">
    <img src="../images/SearchIcon.gif" class=Icon></a></td></tr>
<tr><td class=DataLabel>Unit</td>
    <td class=DataField>
    <select name=bkrec021>
    <option></option>
     %OPRWEB01.07.125.2
    </select></td></tr>
<tr><td class=DataLabel>Referring Doctor</td>
    <td class=DataField colspan=3>
    <input type=text name=bkrec003 size=8 maxlength=8 
           value="%OPRWEB01.07.105.003">
    <input type=text name=n_bkrec003 size=40
           value="%OPRWEB01.07.105.002">
    <a href="javascript:DoctorSearchFrame(UpdateForm.bkrec003,
                                          UpdateForm.n_bkrec003)">
    <img src="../images/SearchIcon.gif" class=Icon></a></td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.P </td>
    <td class=DataField>
    <select name=bkrec019 class=Mandatory title="%STANDARD.01.017.P ">
    <option></option>
     %OPRWEB01.07.123.2 
    </select></td>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField colspan=3>
    <select name=bkrec023 class=Mandatory title="%STANDARD.01.017.CL">
    <option></option>
    %OPRWEB01.07.127.9.1.10.2.X
    </select></td></tr>


<tr valign=top><td class=DataLabel>Comments</td>
    <td class=DataField colspan=3>
    <input type=text name=bkrec038  size=50 maxlength=40 
           value="%OPRWEB01.07.134">
    </td></tr>

<tr><td class=DataLabel>Admitting Point</td>
    <td class=DataField>
    <select name=bokrx003>
    <option></option>
    %OPRWEB01.07.203.2
    </select></td></tr>

<tr><td>&nbsp;</td></tr>
<tr><td colspan=4 align=center> 
    <input type=button value=Ok class="button" id=btnOk
     onclick="tempDisable(this);ProcessSubmit();">
    <input type=button value=Cancel class="button" onclick='history.go(-2);'>
    <input type=button value=Delete class="button" onclick='DeleteBooking();'>
    </td></tr>

</table>
</form>
</div>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OPRWEB01.07.003">
<input type=hidden name=admissno value="%OPRWEB01.07.081">
<input type=hidden name=MenuType value="%OPRWEB01.07.088">
</form>


