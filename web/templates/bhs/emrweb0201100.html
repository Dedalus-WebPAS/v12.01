<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="bhs">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<link rel="stylesheet" href="../html/postcode.css" type="text/css">
<script type="text/javascript" src="../js/emrweb0201100.js"></script>
<script type="text/javascript" src="../js/EmergencyPrimaryDiagSearch.js"></script>
<script type="text/javascript">
function submitFreeFormat() {
  if (isWhitespace(document.UpdateForm.emvcd005.value)&&
      !isWhitespace(document.UpdateForm.emvcd033.value)) {
    alert("Primary Diagnosis selection field is mandatory.");
  } else {
    submitPrimaryDiag();
  }
}

function submitPrimaryDiag() {
  var diagCookieName = "diagnosisCookie-" + trim(UpdateForm.admissno.value);

  if (isWhitespace(document.UpdateForm.diagnosisSearch.value)) {
    UpdateFieldVCD(UpdateForm.admissno,
      "          "+UpdateForm.emvcd003.value,
      " ",
      function () {
        SetCookie(diagCookieName,document.UpdateForm.diagnosisSearch.value);
        StdPageRefresh();
      }
    );
  } else {
    if (!isWhitespace(document.UpdateForm.emvcd005.value)) {
      validateEMRDiagnosis(validateEMRDiagnosisRetFuncTrue,validateEMRDiagnosisRetFuncFalse);
    }
  }
}

function validateEMRDiagnosisRetFuncTrue() {
  var diagCookieName = "diagnosisCookie-" + trim(UpdateForm.admissno.value);

  UpdateFieldVCD(UpdateForm.admissno,
    UpdateForm.emvcd005.value.substring(0,10)+UpdateForm.emvcd003.value, 
    UpdateForm.emvcd033.value,
    function () {
      SetCookie(diagCookieName,document.UpdateForm.diagnosisSearch.value);
      StdPageRefresh();
    }
  );
}

function validateEMRDiagnosisRetFuncFalse() {
  document.UpdateForm.diagnosisSearch.focus();
}

function UpdateFieldVCD(Visit,ReturnCode,ReturnDesc) {
  ReturnFunction="" ;
  for (var i=3; i < UpdateFieldVCD.arguments.length; i++) {
    if (typeof(UpdateFieldVCD.arguments[i]) == 'function') {
      ReturnFunction=UpdateFieldVCD.arguments[i] }
    else {
      UpdateFieldVCD.arguments[i].value=""; }  
  }

  var serverURL  = "../cgi-bin/emrweb08.pbl?reportno=24" +
               "&admissno=" + Visit.value.replace(/ /g,"+") +
               "&valdcode=" + ReturnCode.replace(/ /g,"+") +
               "&valddesc=" + escape(ReturnDesc.replace(/ /g,"+")) +
               "&emvcd031=" + UpdateForm.emvcd031.value;

  if (IEBrowser) {
    var returnValue = RSExecute(serverURL);

    if (returnValue.status==0) {
      if (returnValue.return_value=="1") {
        alert("Only Free Format Description from Primary Diagnosis is defaulted to Bed Request.");
      }
    }
    else {
      ReturnCode.focus();
    }

    if (typeof(ReturnFunction) == 'function') { ReturnFunction() }
  }
  else {
    var returnValue = RSExecuteFetch(serverURL);

    returnValue.then(
      function (returnValue) {
        returnValue = ParseFetchData(returnValue);  // parse fetch() result

        if (returnValue.status==0) {
          if (returnValue.return_value=="1") {
            alert("Only Free Format Description from Primary Diagnosis is defaulted to Bed Request.");
          }
        }
        else {
          ReturnCode.focus();
        }

        if (typeof(ReturnFunction) == 'function') { ReturnFunction() }
      }
    );
  }
}

function validateEMRDiagnosis(RetFuncTrue,RetFuncFalse) {
  var serverURL="../cgi-bin/emrweb08.pbl?reportno=23" +
                "&emvcd001="+UpdateForm.emvcd001.value.replace(/ /g,"+") +
                "&emvcd002="+UpdateForm.emvcd002.value.replace(/ /g,"+") +
                "&emvcd003="+UpdateForm.emvcd003.value.replace(/ /g,"+") +
       "&emvcd005="+UpdateForm.emvcd005.value.substring(0,10).replace(/ /g,"+");

  if (IEBrowser) {
    var returnValue = RSExecute(serverURL);

    if (returnValue.status==0) {
      if (returnValue.return_value==1) {
        alert("Error: Diagnosis Record already exists.");
        if (typeof(RetFuncFalse) == 'function') { RetFuncFalse() }
        return false;
      }
    }
    if (typeof(RetFuncTrue) == 'function') { RetFuncTrue() }
  }
  else {
    var returnValue = RSExecuteFetch(serverURL);

    returnValue.then(
      function (returnValue) {
        returnValue = ParseFetchData(returnValue);  // parse fetch() result

        if (returnValue.status==0) {
          if (returnValue.return_value==1) {
            alert("Error: Diagnosis Record already exists.");
            if (typeof(RetFuncFalse) == 'function') { RetFuncFalse() }
            return false;
          }
        }
        if (typeof(RetFuncTrue) == 'function') { RetFuncTrue() }
      }
    );
  }
}

function checkDateFunction(fieldvar,stringtitle) {
  if(isWhitespace(fieldvar.value)) {
    return;
  } else {
    checkDate(fieldvar,stringtitle);
  }
}

function AdmDoctor() {
 validateCode(31,UpdateForm.emvis106,UpdateForm.n_emvis106);
 UpdateFieldEMR(document.UpdateForm.admissno,1,UpdateForm.emvis106);
 UpdatePreAdmReq(document.UpdateForm.admissno);
}

function ClrAdmDoctor() {
 UpdateForm.emvis106.value="";
 UpdateForm.n_emvis106.value="";
 UpdateFieldEMR(document.UpdateForm.admissno,1,UpdateForm.emvis106);
 UpdatePreAdmReq(document.UpdateForm.admissno);
}

function updateCB() {
  if (document.UpdateForm.emvis091.checked==true) {
    document.UpdateForm.emvis091.value="1";
  } else {
    document.UpdateForm.emvis091.value="0";
  }
}

function updateDrAdmitting()
{
 updateCB();
 UpdateFieldEMR(document.UpdateForm.admissno,3,document.UpdateForm.emvis091);
}

</script>
%START.OF.PAGE
<body onLoad="PageLoad(event);" onunload="unlockClinNotes();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%EMRWEB02.01.003";
PatientVIS="%EMRWEB02.01.081";
PatientNAM="%EMRWEB02.01.002";
PatientSTA="%EMRWEB02.01.086.078";
PatientALT="%EMRWEB02.01.084";
PatientSEX="%EMRWEB02.01.019";
PatientDOB="%EMRWEB02.01.020";
PatientAGE="%EMRWEB02.01.021";
PatientLOC="%EMRWEB02.01.083";
PatientPRI="%EMRWEB02.01.086.066.1";
PatientUNT="%EMRWEB02.01.066.0";
PatientIND="%EMRWEB02.01.086.091";
GpCOD="%EMRWEB02.01.086.084.001";
GpNAM="%EMRWEB02.01.086.084.081";
GpPRAC="%EMRWEB02.01.086.085.001";
GpPRACCNT="%EMRWEB02.01.086.085.002";
GpPRACNAM="%EMRWEB02.01.086.085.005";
PatientARR="%EMRWEB02.01.101.0 %EMRWEB02.01.102";
PatientSEE="%EMRWEB02.01.130.0 %EMRWEB02.01.131";
PatientTRI="%EMRWEB02.01.103.3";
PatientECLC="%EMRWEB02.01.484.1";
PatientCLH="%STANDARD.01.017.CL";
PatientEHFT="%EMRWEB02.01.485";
InsertEmergencyHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<table width=100% align=center border=0 cellspacing=0 cellpadding=0>
<tr><td class=HeadingCell align=center>
    Emergency Patient Clinical Details</td>
    <td class=HeadingCell align=right width=5%>
    <a href="javascript:NextPatient('%EMRWEB02.01.476.emrweb02.01.100');">
    <img src='../images/ShowIcon.gif' border=0 align=left
     alt="Select next emergency patient by visit date/time."
     title="Select next emergency patient by visit date/time."></a>
    <a href='javascript:print();'>
    <img src='../images/PrinterIcon.gif' border=0 align=absmiddle
     alt="Print Page" title="Print Page"></a></td></tr>
</table>
<form name=SelectScreen id=SelectScreen action="emrweb02.pbl" method=post
 style="margin:0">
 <input type=hidden name=reportno id=reportno value=1>
 <input type=hidden name=template id=template value=1>
 <input type=hidden name=admissno id=admissno value="%EMRWEB02.01.081">
 <input type=hidden name=urnumber id=urnumber value="%EMRWEB02.01.003">
</form>
<form name=UpdateForm id=UpdateForm action="emrweb02.pbl" method=post
 style="margin:0" onsubmit='return validateMandatory(this);'>
<input type=hidden name=reportno id=reportno value="01">
<input type=hidden name=updttype id=updttype value="TRIAG">
<input type=hidden name=resavail id=resavail value="0">
<input type=hidden name=template id=template value="100">
<input type=hidden name=admissno id=admissno value="%EMRWEB02.01.081">
<input type=hidden name=urnumber id=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=emvis118 id=emvis118 value="%EMRWEB02.01.003">
<input type=hidden name=formactn id=formactn value=" ">
<input type=hidden name=nextpage id=nextpage value=0>
<input type=hidden name=redirect id=redirect>
<input type=hidden name=updateky id=updateky value="%EMRWEB02.01.404">
<input type=hidden name="username" id="username">
<input type=hidden name="password" id="password">
<input type=hidden name=dummy1 id=dummy1>
<input type=hidden name=dummy2 id=dummy2>
<input type=hidden name=emvis004 id=emvis004>
<input type=hidden name=emvis005 id=emvis005>
<input type=hidden name=emvis135 id=emvis135>
<input type=hidden name=emvis136 id=emvis136>
<input type=hidden name=emvis137 id=emvis137>
<input type=hidden name=emvis138 id=emvis138>
<input type=hidden name=emvis147 id=emvis147>
<input type=hidden name=emdct001 id=emdct001>
<input type=hidden name=emdct002 id=emdct002>
<input type=hidden name=emdct003 id=emdct003>
<input type=hidden name=emdct004 id=emdct004>
<input type=hidden name=emdct005 id=emdct005>
<input type=hidden name=emdct006 id=emdct006>
<input type=hidden name=emdct007 id=emdct007>
<input type=hidden name=emdct008 id=emdct008>
<input type=hidden name=emdct009 id=emdct009>
<input type=hidden name=emvis026 id=emvis026 value=" ">
<input type=hidden name=emvis006 id=emvis006 value="%EMRWEB02.01.106.1">
<input type=hidden name=emvis007 id=emvis007 value="%EMRWEB02.01.107.001">
<input type=hidden name=temdiag id=temdiag value="">
<input type=hidden name=patdiag id=patdiag>

<table width=99% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel>Triage Dte </td>
    <td class=DataLabel>
      <input type="text" name=emvis128 id=emvis128 size="12"
       title="Triage Data" value="%EMRWEB02.01.162.0" readonly>
    Time
      <input type="text" name=emvis129 id=emvis129 size="8"
       value="%EMRWEB02.01.163" readonly>
    </td>
    <td align=right>
      <input type=button class="button" name=mhprabut id=mhprabut
       value="MH Practitioner" onclick="changeMHDocDateTime();">
      <input type=button class="Bigbutton" 
       value="Nurse Handover" onclick='DoctorData();'>
      <input type=button class="Bigbutton" value="Doctor Handover"
       onclick='NurseData();'>
    </td>
</tr>

<tr valign=top><td class=DataLabel>Presenting Complaint</td>
    <td colspan=2>
    <table cellspacing=0 cellpadding=0>
    <tr valign=top>
        <td><input type=hidden name=el id=el value="el">
        <input type=text name=emvis060 id=emvis060 max=3 readonly size=3
         title="Presenting Compliant"
         value="%EMRWEB02.01.220.1"
         onblur="validateCatCode(el,emvis060,v060name);">
        <input type=text name=v060name id=v060name readonly
         value="%EMRWEB02.01.220.0"></td>
        <td><textarea wrap=hard name=prcom001 id=prcom001 cols=50 readonly 
             rows=3 onchange="setPreXml('%EMRWEB02.01.081');"></textarea>
        </td>
        <td><div id="AmbulanceHandover"></div></td>
    </tr>
    </table>
    </td>
</tr>

<tr valign=top><td class=DataLabel>Medical History </td>
    <td colspan=2>
    <table cellspacing=0 cellpadding=0>
    <tr valign=bottom>
    <td>
      <textarea class=Readonly cols=100 rows=4 name=medichis id=medichis readonly>
      </textarea>
    </td>
    <td>
      <input type=button class="button" value="Add" onclick='AddList();'>
    </td>
    </tr>
    </table>
    </td>
</tr>

<tr valign=top><td class=DataLabel>Clinical Notes</td>
   <td colspan=2>
   <table cellspacing=0 cellpadding=0>
   <tr valign=bottom>
          <td><textarea cols=100 rows=4 name=vicmt001 id=vicmt001 
               onfocus="lockClinical();"
               onblur="clinNoteXml('%EMRWEB02.01.081');" 
               onkeydown="LimitText(this,100,10000)"
               wrap=hard>%EMRWEB02.01.434.001</textarea></td>

          <td><input type=button class="button" value="Print" 
              onclick='PrintNotes();'>
              <input type=button class="button" value="Template" 
              onclick='AddNotes();'>
         </td></tr>
   </table>
   </td>
</tr>

<tr>
  <td colspan=3>
    <table width=100% border=0 cellspacing=0 cellpadding=0>
    <tr>
      <td class=DataLabel width=15% nowrap>Primary Diagnosis Search</td>
      <td>
	<input type=hidden name=emvcd001 id=emvcd001 value="%EMRWEB02.01.081">
	<input type=hidden name=emvcd002 id=emvcd002 value="005">
	<input type=hidden name=emvcd003 id=emvcd003 value="%EMRWEB02.01.197">
	<input type=hidden name=emvcd004 id=emvcd004 value="5">
	<input type=hidden name=emvcd006 id=emvcd006 value="   ">
	<input type=hidden name=emvcd031 id=emvcd031 value="1">
	<input type=text
	 onKeyUp="getDiagnosis(this,UpdateForm.emvcd005,UpdateForm.emvcd033);"
	 class=SelectBig name=diagnosisSearch id=diagnosisSearch>
	<select name=emvcd005 id=emvcd005 class=SelectHugE
	 onchange="document.UpdateForm.emvcd033.value=trim(this.value.substring(9,80))+' ';">
	</select>
	<input type=button class="SlimButton" value="Add"
	 onclick='submitFreeFormat();'>
	<input type=button class="button" value="Multi Diagnosis"
	 onclick='DiagnosisLink();'>
      </td>
    </tr>
    <tr>
      <td class=DataLabel nowrap>Primary Diagnosis Free Format Desc&nbsp;</td>
      <td><input type=text name=emvcd033 id=emvcd033 maxlength=100 size=100
           onblur='submitFreeFormat();'>
    </tr>
    </table>
  </td>
</tr>
</table>

<table width=99% align=center border=0 cellspacing=1 cellpadding=1>
<tr valign=top>
  <td>
    <table width=100% border=0 cellspacing=2 cellpadding=0>
    <tr>
      <td style="vertical-align:top">
       <!-- <input type=button class=SlimButton value="Procs"
         onclick='ProcedureLink();'> -->
      </td>
      <td align=right>
        <textarea cols=45 rows=3 readonly>%EMRWEB02.01.402.004.0</textarea>
      </td>
    </tr>
    <tr>
      <td colspan=2>
        <input type=button class=button name=btnCross id=btnCross value="Cross Consult" 
         title="Cross Consult" onclick='ConsultantLink();'>
      </td>
    </tr>
    </table>
  </td>

  <td style="width:450px">
    <table width=100% border=0 cellspacing=2 cellpadding=0>
    <tr>
      <td class=DataLabel>%STANDARD.01.017.et</td>
      <td colspan=3><select class="SelectMed" name=d_emvis068 id=d_emvis068 
	   title="%STANDARD.01.017.et"
	   onchange="UpdateFieldEMR(document.UpdateForm.admissno,2,this);">
	   <option></option>
	   %EMRWEB02.01.228.2
	  </select>
	 <span id=InsertReqButton style="display: none">
	 <input type=button class="button" value="Ward/Bed Req." name=reqbuttn id=reqbuttn 
          onclick="BedReqLink();">
	 </span>
	 <input type=button class="button" value="Injury Data" name=injbuttn id=injbuttn
	  onclick='InjuryData();'>
      </td>
    </tr>
    <tr>
      <td class=DataLabel>Admitting Dr/Unit</td>
      <td colspan=3><input type="text" size=8 maxlength=6 name="emvis106" id="emvis106"
	   title="Admitting Dr/Unit" value="%EMRWEB02.01.266.003"
	   onblur="UpCase(this);AdmDoctor();">
	  <input type=text readonly size=25 notab name=n_emvis106 id=n_emvis106
	   title="Admitting Dr/Unit" value="%EMRWEB02.01.266.002">
	  <img notab src="../images/SearchIcon.gif" class=Icon
	   onclick="DoctorSearchFrame(emvis106,n_emvis106,AdmDoctor)">
	  <img src="../images/erase.gif" class=Icon
	   onclick="ClrAdmDoctor();">
      </td>
    </tr>
    <tr>
      <td class=DataLabel nowrap>Admitting Dr/Unit Contacted</td>
      <td style="width:100px">
        <input type=checkbox name=emvis091 id=emvis091 title="Admitting Dr/Unit Contacted"
	 onblur='updateDrAdmitting();'>
      </td>
      <td class=DataLabel nowrap>
        <span id=InsertExpWardTitle style="display: none">Expected Ward&nbsp;</span>
      </td>
      <td class=DataLabel style="width:80px">
        <span id=InsertExpWardDet style="display: none">&nbsp;%EMRWEB02.01.486</span>
      </td>
    </tr>
    <tr><td><div id="DecisionToAdmitLabel"></div></td>
        <td colspan=3><div id="DecisionToAdmitField"></div></td>
        </tr>
    </table>
  </td>
</tr>
</table>

<table width=99% align=center border=0 cellspacing=1 cellpadding=1>
<tr>
  <td>
    <input type=hidden name=AC id=AC value="AC">
    <input type=hidden name=DEL id=DEL value="DEL">
    <table width=100% border=0 cellspacing=0 cellpadding=0>
    <tr>
      <td class=DataLabel style="width:15px">Expected Unit</td>
      <td>
        <table width=100% border=0 cellspacing=2 cellpadding=1>
        <tr>
          <td>
            <input name=emvis134 id=emvis134 title="Expected Unit" size=1 maxlength=3
             value="%EMRWEB02.01.173.1" onblur="UpCase(this); 
             validateCatCode1(AC,emvis134,unitdesc,emvis073,emvis083);">
            <input name=unitdesc id=unitdesc size=24 Class=Readonly readonly
             value='%EMRWEB02.01.173.0'>
            <img src=../images/SelectLink.gif class=Icon
             onclick="LookupPage(emvis134,unitdesc,'Lookup_CodeCTAC_000',emvis134);">
            <img src="../images/erase.gif" class=Icon
             onclick="validateCatCode1(AC,DEL,unitdesc,emvis073,emvis083);">
          </td>
          <td class=DataLabel>Unit Req. Date</td>
          <td>
            <input type=text name=emvis073 id=emvis073 title="Unit Request Date"
             value="%EMRWEB02.01.233.0" readonly class=Readonly size=8>Time
            <input type="text" name=emvis083 id=emvis083 size=8
             value="%EMRWEB02.01.243" readonly class=Readonly>
          </td>
        </tr>
        </table>
      </td>
    </tr>
    </table>
  </td>

  <td style="width:430px">
    <table width=100% border=0 cellspacing=2 cellpadding=0>
    <tr>
      <td class=DataLabel style="width:115px">ED Ready to Discharge</td>
      <td>
        <input type="text" title="ED Ready to Discharge Date"
         size=11 max=11 name=emvis071 id=emvis071
         value="%EMRWEB02.01.231.0"
         onblur="validateDepDate(emvis071,emvis081);"/>
	<img notab src=../images/DateLookup.gif class=Icon 
         alt="Show Calendar" title="Show Calendar"
	 onclick="DateLookupFrame(emvis071);">
	<input type="text" title="ED Ready to Discharge Time"
	 size="6" name=emvis081 id=emvis081 value="%EMRWEB02.01.241"
	 onblur="validateDepDate(emvis071,emvis081);"/>
	<img notab src=../images/DateTimeStamp.gif class=Icon
         alt="Current" title="Current"
	 onclick="SetCurrentDateTime(emvis071,emvis081);">
	<img notab src=../images/TimeLookup.gif class=Icon
         alt="Time Select" title="Time Select"
	 onclick="TimeLookupFrame(emvis081);">
      </td>
    </tr>
    </table>
  </td>
</tr>
</table>
</form>
</div>

<span id="ShowAmbulanceHandover" style="display:none">
   &nbsp;&nbsp;
   Ambulance Handover Complete<br/>
   &nbsp;&nbsp;
   <input type=text size=11 max=11 name="emvis156" id="emvis156"
    value="%EMRWEB02.01.277" onblur="AmbHandoverDate();"
    title="Ambulance Handover Date" class="PastDate Mandatory">
   <img notab src="../images/DateLookup.gif" class="Icon"
    alt="Show Calendar" title="Show Calendar" date="UpdateForm.emvis156">
   <input type=text size=8 maxlength=8 name="emvis157" id="emvis157"
    value="%EMRWEB02.01.278"
    onblur="AmbHandoverTime();" title="Ambulance Handover Time" 
    class="Mandatory">
   <img notab src="../images/DateTimeStamp.gif" class="Icon"
    alt="Current" title="Current"
    date="UpdateForm.emvis156" time="UpdateForm.emvis157">
   <img notab src="../images/TimeLookup.gif" class="Icon"
    alt="Time Select" title="Time Select" time="UpdateForm.emvis157">
</span>

<span id="ShowDecisionToAdmitLabel" style="display:none">
  Clinical Decision to Admit
</span>

<span id="ShowDecisionToAdmitField" style="display:none">
   <input type=text size=11 max=11 name="emvis158" id="emvis158"
    value="%EMRWEB02.01.279" onblur="DecisionToAdmitDate();"
    title="Clinical Decision to Admit Date" class="PastDate">
   <img notab src="../images/DateLookup.gif" class="Icon"
    alt="Show Calendar" title="Show Calendar" date="UpdateForm.emvis158">
   <input type=text size=6 max=8 name="emvis159" id="emvis159"
    value="%EMRWEB02.01.280" onblur="DecisionToAdmitTime();"
    title="Clinical Decision To Admit Time" class="">
   <img notab src="../images/DateTimeStamp.gif" class="Icon"
    alt="Current" title="Current"
    date="UpdateForm.emvis158" time="UpdateForm.emvis159">
   <img notab src="../images/TimeLookup.gif" class="Icon"
    alt="Time Select" title="Time Select" time="UpdateForm.emvis159">
</span>

<form name=AddDiagnosis id=AddDiagnosis method=post action=emrweb06.pbl
 style="margin:0">
<input type=hidden name=reportno id=reportno value="2">
<input type=hidden name=template id=template value="002">
<input type=hidden name=updatety id=updatety value="A">
<input type=hidden name=nextpage id=nextpage value="1">
<input type=hidden name=redirect id=redirect
 value="%EMRWEB02.01.001.emrweb02.01.100">
<input type=hidden name=urnumber id=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno id=admissno value="%EMRWEB02.01.081">
<input type=hidden name=emvcd001 id=emvcd001 value="%EMRWEB02.01.081">
<input type=hidden name=emvcd002 id=emvcd002 value="005">
<input type=hidden name=emvcd004 id=emvcd004 value="5">
<input type=hidden name=emuty001 id=emuty001 value="EMRD">
<input type=hidden name=emvcd005 id=emvcd005 value="">
<input type=hidden name=emvcd006 id=emvcd006 value="   ">
<input type=hidden name=emvcd031 id=emvcd031 value="1">
<input type=hidden name=updateky id=updateky value="%EMRWEB02.01.449">
<input type=hidden name=webuseri id=webuseri value="%STANDARD.01.008">
</form>
<form name=PatientLinks id=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno id=reportno value=1>
<input type=hidden name=template id=template value=004>
<input type=hidden name=regexstm id=regexstm value=102>
<input type=hidden name=newstand id=newstand value=1>
<input type=hidden name=urnumber id=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno id=admissno value="%EMRWEB02.01.081">
<input type=hidden name=nextpage id=nextpage value="4">
<input type=hidden name=emrgflag id=emrgflag value="Y">
<input type=hidden name=MenuType id=MenuType value="11">
<input type=hidden name=webuseid id=webuseid value="%STANDARD.01.008">
</form>
<form name=HiddenFields id=HiddenFields style="margin:0">
<input type=hidden name=InjuryIndicator id=InjuryIndicator
 value="%EMRWEB02.01.447">
<input type=hidden name=DoctorCode id=DoctorCode value="%EMRWEB02.01.107.001">
<input type=hidden name=DischargeComplete id=DischargeComplete
 value="%EMRWEB02.01.147">
<input type=hidden name=Diag01 id=Diag01 value="%EMRWEB02.01.437">
<input type=hidden name=Diag02 id=Diag02 value="%EMRWEB02.01.438">
<input type=hidden name=Diag03 id=Diag03 value="%EMRWEB02.01.439">
<input type=hidden name=Diag04 id=Diag04 value="%EMRWEB02.01.440">
<input type=hidden name=Diag05 id=Diag05 value="%EMRWEB02.01.441">
<input type=hidden name=Diag06 id=Diag06 value="%EMRWEB02.01.442">
<input type=hidden name=Diag07 id=Diag07 value="%EMRWEB02.01.443">
<input type=hidden name=Diag08 id=Diag08 value="%EMRWEB02.01.444">
<input type=hidden name=Diag09 id=Diag09 value="%EMRWEB02.01.445">
<input type=hidden name=Pres01 id=Pres01 value="%EMRWEB02.01.104">
<input type=hidden name=Pres02 id=Pres02 value="%EMRWEB02.01.105">
<input type=hidden name=Pres03 id=Pres03 value="%EMRWEB02.01.174">
<input type=hidden name=Pres04 id=Pres04 value="%EMRWEB02.01.175">
<input type=hidden name=Pres05 id=Pres05 value="%EMRWEB02.01.176">
<input type=hidden name=Pres06 id=Pres06 value="%EMRWEB02.01.177">
<input type=hidden name=prcom001 id=prcom001>
<input type=hidden name=ptcnbedm id=ptcnbedm
 value="%STANDARD.01.025.112.106.0.1">
<input type=hidden name=PrimaryDiagnosis id=PrimaryDiagnosis
 value="%EMRWEB02.01.187">
<input type=hidden name=PrimaryDiagnCode id=PrimaryDiagnCode
 value="%EMRWEB02.01.196">
<input type=hidden name=PrimaryDiagnFtxt id=PrimaryDiagnFtxt
 value="%EMRWEB02.01.195">
<input type=hidden name=PrimaryDiagnKeyw id=PrimaryDiagnKeyw
 value="%EMRWEB02.01.490">
<input type=hidden name=emvis001 id=emvis001
  value="%EMRWEB02.01.101.0">
<input type=hidden name=emvis002 id=emvis002 value="%EMRWEB02.01.102">
<input type=hidden name=emvis013 id=emvis013 value="%EMRWEB02.01.113.3">
<input type=hidden name=ptcnhdps id=ptcnhdps
 value="%STANDARD.01.025.080.250.1.1">
<input type=hidden name=emvis177 id=emvis177
 value="%EMRWEB02.01.296.3">
</form>
<script type="text/javascript">
  if (EmergencyFullScreens) {
    top.document.all.menu.height='744';
    top.document.all.content.height='0';
  }

  CTypeAdm="%EMRWEB02.01.252";
  if (CTypeAdm == "Yes") {
    document.UpdateForm.emvis147.value=1;
  }
  else { 
    document.UpdateForm.emvis147.value=0;
  }

  MedNoteLine="%EMRWEB02.01.436";
  NoteArray=MedNoteLine.split("|");
  NewNotes=NoteArray[0];

  for (var j=1; j < NoteArray.length; j++) {
    if (!isWhitespace(NoteArray[j])) {
      NewNotes=NewNotes+"\n"+NoteArray[j];
    } 
  }
  document.UpdateForm.medichis.value=NewNotes;

  InjData="%EMRWEB02.01.188";
  if (InjData == "1") {
    document.UpdateForm.injbuttn.className="RedButton";
  }

  if (!isWhitespace("%EMRWEB02.01.271.1")) {
    document.UpdateForm.mhprabut.className="RedButton";
  }

  CrossConsult="%EMRWEB02.01.543";
  if (CrossConsult == "1") {
    document.UpdateForm.btnCross.className="RedButton";
  }

  RequestWrdBd="%EMRWEB02.01.544";
  if (RequestWrdBd == "1") {
    document.UpdateForm.reqbuttn.className="RedButton";
  }

  if (document.HiddenFields.ptcnbedm.value == "1") {
    InsertExpWardTitle.style.display="";
    InsertExpWardDet.style.display="";
    InsertReqButton.style.display="";
  } else {
    InsertExpWardTitle.style.display="none";
    InsertExpWardDet.style.display="none";
    InsertReqButton.style.display="none";
  }

  if ("%EMRWEB02.01.251" == "Yes") {
    document.UpdateForm.emvis091.checked=true;
    document.UpdateForm.emvis091.value="1";
  } else {
    document.UpdateForm.emvis091.checked=false;
    document.UpdateForm.emvis091.value="0";
  }

  var diagCookieName = "diagnosisCookie-" + trim(UpdateForm.admissno.value);
  var diagCookieVal = GetCookieData(diagCookieName);

  if (!isWhitespace(document.HiddenFields.PrimaryDiagnosis.value)) {
    document.UpdateForm.diagnosisSearch.value =
      document.HiddenFields.PrimaryDiagnCode.value.substring(0,2);

//    if (diagCookieVal != "unknown") {
//      document.UpdateForm.diagnosisSearch.value = diagCookieVal;
//    }

    getDiagnosis(UpdateForm.diagnosisSearch,
                 UpdateForm.emvcd005,
                 UpdateForm.emvcd033,
                 SelectDiagList);
  }

  CheckAmbHandover();
  CheckDecisionToAdmit();

  if (!isWhitespace(document.UpdateForm.diagnosisSearch.value)) {
    diagCookieName = "diagnosisCookie-" + trim(UpdateForm.admissno.value);
    SetCookie(diagCookieName,document.UpdateForm.diagnosisSearch.value);    
  }

function SelectDiagList() {
  for (var i=0; i < document.UpdateForm.emvcd005.length; i++) {
    if (document.UpdateForm.emvcd005.options[i].value.substring(0,10)==
        document.HiddenFields.PrimaryDiagnCode.value) {
      document.UpdateForm.emvcd005.selectedIndex=i;
    }
  }

  document.UpdateForm.emvcd033.value =
    document.HiddenFields.PrimaryDiagnFtxt.value;
}
</script>
