<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="bhs">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/EmrMandatory.js"></script>
<script type="text/javascript" src="../js/emrweb0202012.js"></script>
<script type="text/javascript">
function CancelLink() {
  if (!isWhitespace(document.getElementById("eacregck").value)) {
    location.href = document.getElementById("eacregck").value;
  } else {
document.LinkForm.emexp001.value=document.UpdateForm.emexp001.value.replace(/ /g,"+")
document.LinkForm.submit();
  }
}
function getExpAdvConCookie(){
  if (GetCookieData("ExpAdvConCookie")!="unknown") {
    document.getElementById("eacindct").value="1";
    ExpireCookiePath("ExpAdvConCookie");
  }
}
function getEACTrgCookie() {
  if (GetCookieData("EACTrgCookie")!="unknown") {
    document.getElementById("eacregck").value=GetCookieData("EACTrgCookie");
    ExpireCookiePath("EACTrgCookie");
  }
}
function TriageComplete() {
 UpdateForm.AddButton.disabled=true;
 document.UpdateForm.redirect.value="emrweb02.pbl?reportno=2&template=3"
 if (isWhitespace(document.getElementById('emvis128').value) ||
     isWhitespace(document.getElementById('emvis129').value)) {
   alert("Triage Date and Time Required")
   UpdateForm.AddButton.disabled=false;
   return;
 }

 if(!VEMDMandatory()) {
   UpdateForm.AddButton.disabled=false;
   return;
 }

 if (setFormactn()) {
   UpdateForm.AddButton.disabled=false;
 } else {
   setTimeout('UpdateForm.AddButton.disabled=false;',2000);
 }
}
function disableFormBeforeTriagedBy() {
  DisableForm(document.getElementById('UpdateForm'));
  document.getElementById('emvis128').className='ReadOnly';
  document.getElementById('emvis128').value='';
  document.getElementById('emvis129').className='ReadOnly';
  document.getElementById('emvis129').value='';
  document.getElementById('emvis060').className='SelectBig ReadOnly';
  document.getElementById('prcom001').className='ReadOnly';
  document.getElementById('emvis127').disabled=false;
  document.getElementById('dummy1').disabled=false;
}
function enableFormBeforeTriagedBy() {
  document.getElementById('emvis128').className='Mandatory';
  document.getElementById('emvis129').className='Mandatory';
  document.getElementById('emvis060').className='SelectBig Mandatory';
  document.getElementById('prcom001').className='AsciiOnly PresComExp';
  var form = document.getElementById("UpdateForm");
  var elements = form.elements;
  for (var i = 0, len = elements.length; i < len; ++i) {
      elements[i].disabled = false;
  }
  SetCurrentDateTime(document.getElementById('emvis128'),
                    document.getElementById('emvis129'));
}
function SetNurseName() {
  UpdateForm.dummy1.value=UpdateForm.gnm.value.replace(/\s*$/g,"")+
  " " + UpdateForm.dummy1.value.replace(/\s*$/g,"")
  enableFormBeforeTriagedBy();
}
</script>
<style type="text/css">
textarea.PresComExp:focus {height:8em;}
</style>
</head>
%START.OF.PAGE
<body onLoad="PageLoad(event);
        getPresentCom(UpdateForm.test,UpdateForm.emvis060,UpdateForm.emrviscat);
        DisplayDiv();getExpAdvConCookie();getEACTrgCookie();
        disableFormBeforeTriagedBy();VEMDFields();">
<span class=DFrameTitleBar>
Emergency Triage
</span>
<div id=PageBodySection style="overflow: auto;">
<form name=UpdateForm action="emrweb02.pbl" method=post style="margin:0"
 id="UpdateForm">
  <input type=hidden name=reportno value="02">
  <input type=hidden name=template value="001">
  <input type=hidden name=formactn>
  <input type=hidden name=updttype>
  <input type=hidden name=updateky value="">
  <input type=hidden name=nextpage value="7">
  <input type=hidden name=returnfm value=1>
  <input type=hidden name=redirect>
  <input type=hidden name=selsex>
  <input type=hidden name=gname>
  <input type=hidden name=sname>
  <input type=hidden name=dummy>
  <input type=hidden name=dummyadm>
  <input type=hidden name=dummsrch value="1">
  <input type=hidden name=fpatname>
  <input type=hidden name=urnumber>
  <input type=hidden name=emvis004>
  <input type=hidden name=emvis005>
  <input type=hidden name=emvis135>
  <input type=hidden name=emvis136>
  <input type=hidden name=emvis137>
  <input type=hidden name=emvis138>
  <input type=hidden name=emexp001 value="%EMRWEB02.02.410">
  <input type=hidden name=patsname value="%EMRWEB02.02.411">
  <input type=hidden name=patgname value="%EMRWEB02.02.412">
  <input type=hidden name=eacindct id=eacindct value="">
  <input type=hidden name=eacregck id=eacregck value="">
  <input type=hidden name="currdate" id="currdate" value="%STANDARD.01.013">
  <input type=hidden name="ptcnhdps" id="ptcnhdps"
   value="%STANDARD.01.025.080.250.1.1">
 
<table align=center width=95% border=0 cellspacing=0 cellpadding=1>
<tr><td>Triaged By </td>
    <td><input type=text name=emvis127 size=6 class=Mandatory id="emvis127"
        onblur="UpCase(this);
        if(isWhitespace(document.getElementById('emvis127').value)) {
        disableFormBeforeTriagedBy();}
        validateNurse(UpdateForm.emvis127,UpdateForm.dummy1);" 
        title="Triage Nurse" tabindex=1>
        <input type=text name=dummy1 size=20 class=Readonly readonly
         id=dummy1>
        <input type=hidden name=gnm>
        <img src=../images/SearchIcon.gif class=Icon
         onclick='NurseSearchFrame(UpdateForm.emvis127,UpdateForm.dummy1);'>
        </td>
    <td class=DataLabel>U/R 
       <input type=text size=10 maxlength=8 name=emvis118 tabindex=2
       value="%EMRWEB02.02.435" onblur="justifyRight(this);PatientReturn();">
       <img src=../images/SearchIcon.gif class=Icon
       onclick="PatientSearch();">
    </td>
    <td class=DataLabel>Surname </td>
    <td><input type=text size=25 max=25  name=emvis111 tabindex=3
        value="%EMRWEB02.02.411"></td>
    <td class=DataLabel>Given Name </td>
    <td><input type=text size=25 max=25  name=emvis112 tabindex=4
        value="%EMRWEB02.02.412"></td>
</tr>
<tr><td class=DataLabel>Triage Date and Time</td>
   <td>
   <input type="text" name=emvis128 id=emvis128 size="12" tabindex=6
   title="Triage Date" onblur="checkDate(this,'Date');"
   class="Mandatory BackDate">
   <img notab src=../images/DateLookup.gif class="Icon"
    onclick="DateLookupFrame(UpdateForm.emvis128);">
   <input type="text" name=emvis129 id=emvis129 size="8" tabindex=6
    title="Triage Time" class="Mandatory Time"
   onblur="checkTime(this,'Triage Time');"
   value="">
   <img notab src=../images/DateTimeStamp.gif class=Icon
   onclick="SetCurrentDateTime(UpdateForm.emvis128,UpdateForm.emvis129);">
   <img notab src=../images/TimeLookup.gif class=Icon
   onclick="TimeLookupFrame(UpdateForm.emvis129);"></td>
    <td></td>
    <td class=DataLabel>Sex</td>
    <td><select name=emexp004 class=SelectSml tabindex=5>
        <option> </option>
        <option value="U">Unknown</option>
        <option value="I">Indeterminate</option>
        <option value="M">Male</option>
        <option value="F">Female</option>
        </select></td>
    <td class=DataLabel>Date of Birth </td>
    <td><input type=text size=12 max=11 name=emexp005  
         value="%EMRWEB02.02.414" tabindex=6
         title="Date of Birth" class="Past Date">
        <img class=Icon src=../images/DateTimeStamp.gif 
         date=document.UpdateForm.emexp005>
        <img class=Icon src=../images/DateLookup.gif 
         date=document.UpdateForm.emexp005>
        </td></tr>
</table>

<table align=center width=95% border=0 cellspacing=0 cellpadding=1>

<tr valign=top><td class=DataLabel width=15%>Presenting Complaint </td>
    <td>
    <input type=hidden name=emrviscat value="el">
    <input type="text" size=10 tabindex=7 name=test 
       value="%EMRWEB02.02.416.0"
       onKeyUp='UpCase(this);getPresentCom(this,UpdateForm.emvis060,
                UpdateForm.emrviscat);'
       onBlur='DisplayDiv()'>
    <select name=emvis060 class=SelectBig title="Presenting Complaint"
     id=emvis060 onchange="DisplayDiv();">
    </select>
    </td>
    <td colspan=5>
    <textarea name=prcom001 wrap=hard tabindex=8 id=prcom001
     style="overflow-y:hidden"
     onkeydown="ValidateKeyInput(this,6,300);"
     cols=50 rows=2 
     onblur="TextareaBlurHandler(this);ValidateTextLimits(this,6,300);">
    </textarea>
    </td></tr>

</table>

<div id=Triage></div>

<table align=center width=95% border=0 cellspacing=0 cellpadding=1>
<tr><td class=DataLabel width=15%>Location</td>
    <td>
    <input type=text name=emvis006 tabindex=9 size=5 
     value="%EMRWEB02.02.472"
     onblur="validateLocation(UpdateForm.emvis006,UpdateForm.name_emvis006);">
    <input type=text name=name_emvis006 readonly class=Readonly>
    </td>
    <td class=DataLabel>Number of Labels</td>
    <td><select name=nolabels width=50%>
        <option></option>
         %STANDARD.01.027.1.1
    </select>
    Type
    <select name=labeltyp class=SelectBig>
         %STANDARD.01.019.LABELEMR.1
         %STANDARD.01.019.LABELKNX.1
         %STANDARD.01.019.LABELHEC.1
    </select>
    Printer
        <select name=lblprint colspan=2 class=SelectBig>
        %EMRWEB02.02.145.EMRWEB03.01
        </select>
        </td></tr>

<tr><td width=15%>Triage Category</td>
    <td><table border=0 cellspacing=0>
    <tr>
    <td class=Triage1><i>1</i>
    <input type=radio name=emvis003 value=1 tabindex=15 title="Triage Category"
    onclick="CheckMan();"></td>
    <td class=Triage2><i>2</i><input type=radio name=emvis003 value=2
    onclick="unCheck();"></td>
    <td class=Triage3><i>3</i><input type=radio name=emvis003 value=3
    onclick="unCheck();"></td>
    <td class=Triage4><i>4</i><input type=radio name=emvis003 value=4
    onclick="unCheck();"></td>
    <td class=Triage5><i>5</i><input type=radio name=emvis003 value=5
    onclick="unCheck();"></td>
    <td class=Triage6><i>6</i><input type=radio name=emvis003 value=6
    onclick="unCheck();"></td>
    </tr></table></td>
    <td class=DataLabel>Number of Copies</td>
    <td><select name=nolabelf>
    <option></option>
    <option value="  1" selected>  1</option>
    <option value="  2">  2</option>
    <option value="  3">  3</option>
    <option value="  4">  4</option>
    <option value="  5">  5</option>
    <option value="  6">  6</option>
    <option value="  7">  7</option>
    <option value="  8">  8</option>
    <option value="  9">  9</option>
    <option value=" 10"> 10</option>
    </select>
    Form
    <select name=statncod class=SelectBig>
    <option></option>
     %STANDARD.01.020.  7
    </select>
    Printer
    <select name=frmprint class=SelectBig>
     %EMRWEB02.02.145.EMRWEB03.02
    </select>
    </tr>

<tr><td class=DataLabel>%STANDARD.01.017.eu</td>
    <td>
    <input type=hidden name=name_emvis069>
    <select name=emvis069 tabindex=18 title="%STANDARD.01.017.eu" 
         class="SelectBig">
        <option></option>
        %EMRWEB02.02.229.2
        </select>
    <td></td>
    </tr>

<tr><td class="DataLabel">
    <div id="servicename" style="display: none">%STANDARD.01.035.YW</div></td>
    <td class="DataField">
       <div id="servicefield" style="display: none">
       <select name=emvis177 id="emvis177" tabindex=24
        title="%STANDARD.01.035.YW" class="SelectBig"
        onchange="VEMDPatientLoc();">
       <option></option>
        %EMRWEB02.02.296.4
        </select>
        </div></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td></tr>

<tr><td class="DataLabel">
    <div id="locationname" style="display: none">%STANDARD.01.035.YX</div></td>
    <td class="DataField">
       <div id="locationfield" style="display: none">
       <select name=emvis178 id="emvis178" tabindex=25
        title="%STANDARD.01.035.YX" class="SelectBig"
        onchange="VEMDPatientSource();">
       <option></option>
        %EMRWEB02.02.297.4
        </select>
        </div></td>
    <td><div id="sourcename" style="display: none">Source</div></td>
    <td><div id="sourcefield" style="display: none">
        <input type=text size=6 maxlength=6 name=trnsfsrc id="trnsfsrc"
         title="Source" value="" tabindex=26 class=""
         onchange="validateCode(9,UpdateForm.trnsfsrc,
                   UpdateForm.name_trnsfsrc);">
        <input type=text size=30 name=name_trnsfsrc readonly tabindex=-1
         id="name_trnsfsrc" class="readonly" value="">
        <img src=../images/SearchIcon.gif class=Icon tabindex=27
         onclick="TransferSourceFrame(UpdateForm.trnsfsrc,
                  UpdateForm.name_trnsfsrc);">
        </div>
    </td>
    <td></td>
    <td></td></tr>

<tr><td colspan=6 align=center>
    <input type=button value="Add" class="button" tabindex=50 name="AddButton"
     onclick="setRedirect();TriageComplete();">
    <input type=button value="Cancel" class="button" tabindex=51
     onclick="CancelLink();">
    </td></tr>
</table>
</form>
</div>

<form name=LinkForm action="emrweb02.pbl" method=get style="margin:0">
<input type=hidden name=reportno value="02">
<input type=hidden name=template value="011">
<input type=hidden name=formactn value="SP">
<input type=hidden name=emexp001>
</form>

<span id=EmergencyProc style="display:none;">
<table align=center cellspacing=1 cellpadding=0 border=0 width=95%>
<tr><td class=DataLabel width=15%>Place Where Injury Occurred</td>
    <td><select name="emvis021" class=SelectBig tabindex=10
         title="Place Where Injury Occurred">
    <option></option>
    %EMRWEB02.02.121.2
     </select>
    </td>
    <td class=DataLabel>Activity When Injured</td>
    <td><select name="injur006" class=SelectBig title="Activity When Injured"
         tabindex=11>
    <option></option>
      %EMRWEB02.02.183.2
       </select>
</td>
    <td class=DataLabel> Injury Cause</td>
    <td><select name="injur004" class=SelectBig title="Injury Cause"
         tabindex=12>
    <option></option>
     %EMRWEB02.02.181.2
     </select>
    </td></tr>

<tr valign=top><td class=DataLabel> Human Intent</td>
    <td><select name="injur005" class=SelectBig title="Human Intent"
         tabindex=13>
    <option></option>
     %EMRWEB02.02.182.2
      </select>
</td>
    <td class=DataLabel>
    Desc. of Injury Event</td>
    <td colspan=3><input type="text" name="injur002" maxlength="50" size="40"
         title="Description of Injury Event" value="" tabindex=14>
    <input type="text" name="injur003" maxlength="50" size="40" value=""
     tabindex=14>
</td></tr>
</table>
</span>
<script type="text/javascript">
function init(){
if (document.UpdateForm.ptcnhdps.value=="3") {
    intersexoption = document.createElement("option");
    intersexoption.text = "Other";
    intersexoption.value = "R";
    document.UpdateForm.emexp004.add(intersexoption);
  } else {
    intersexoption = document.createElement("option");
    intersexoption.text = "Intersex";
    intersexoption.value = "R";
    document.UpdateForm.emexp004.add(intersexoption);
  }

for (var i =0 ; i < document.UpdateForm.emexp004.length; i++) {
if  (document.UpdateForm.emexp004.options[i].value== "%EMRWEB02.02.413") {
       document.UpdateForm.emexp004.selectedIndex=i }
 }
var str1= trim("%EMRWEB02.02.417");
    if(!isWhitespace(str1)) { str1+="\n"}
var str2= trim("%EMRWEB02.02.418");
    if(!isWhitespace(str2)) { str2+="\n"}
var str3= trim("%EMRWEB02.02.419");
    if(!isWhitespace(str3)) { str3+="\n"}
var str4= trim("%EMRWEB02.02.420");
    if(!isWhitespace(str4)) { str4+="\n"}
var str5= trim("%EMRWEB02.02.421");
    if(!isWhitespace(str5)) { str5+="\n"}
var str6= trim("%EMRWEB02.02.422");
UpdateForm.prcom001.value=str1+str2+str3+str4+str5+str6
var ExpectedLocation="%EMRWEB02.02.472"
if(!isWhitespace(ExpectedLocation)) {
  validateLocation(document.UpdateForm.emvis006,document.UpdateForm.name_emvis006);
}
   if(!CheckEmrVisit(UpdateForm.emvis118.value)) {
       UpdateForm.emvis111.value="";
       UpdateForm.gname.value="";
       UpdateForm.sname.value="";
       UpdateForm.selsex.value="";
       UpdateForm.emvis112.value="";
       UpdateForm.emexp004.selectedIndex=0;
       UpdateForm.emvis118.value="";
       UpdateForm.emvis118.focus();
       UpdateForm.emexp005.value="";
       return;
   }
}
function DisplayDiv() {
Indicator=document.UpdateForm.emvis060.value.substr(13,1);
  if (Indicator=="I") {
     document.all.Triage.style.display="";
     document.all.Triage.innerHTML=document.all.EmergencyProc.innerHTML;
     }
  else {
     document.all.Triage.style.display="none";
     document.all.Triage.innerHTML="";}
}
</script>
