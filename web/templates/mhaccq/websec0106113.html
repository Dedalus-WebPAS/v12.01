Content-Type: text/html
Cache-Control: no-cache

%START.OF.PAGE
<!DOCTYPE html>
<html>
<head>
<title>Admission Confirmation Email</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="ServerID"       content="%STANDARD.01.004">
<meta name="ServerName"     content="%STANDARD.01.005">
<meta name="ServerVersion"  content="%STANDARD.01.006">
<meta name="ServerOption"   content="%STANDARD.01.002">
<meta name="ServerTemplate" content="%STANDARD.01.003">
<meta name="TemplateFile"   content="websec0106113.html">
<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome"    content="mhaccq">
<meta name="HelpFileName"    content="NoContextSet.html">
<meta name="CrossBrowser"    content="true">
<script type="text/javascript" src=../js/Standard.js></script>
<script type="text/javascript" src=../js/Custom.js></script>
<script type="text/javascript" src=../js/json2.js></script>
<link rel="stylesheet" href="../html/standard.css" type="text/css">
<link rel="stylesheet" href="../html/custom.css" type="text/css">
<style type=text/css>
.FreeTextEditor {
  width:800px;
  height:600px;
  background-color:white;
  border:3px outset silver;
}
.FreeTextEditorHeading {
 font-weight:bold;
 background-color: #99CCFF;
 padding-top:3px;
 padding-bottom:3px;
 text-align:center;
}
.FreeTextEditorFooter {
 text-align:center;
 padding:10px;
}
.Label {
  font-weight:bold;
}
</style>
<script type=text/javascript>
function SaveFreeText() {
  var ed = tinyMCE.get('content');
  var url="PortalConfiguration.php" 
  var f=document.getElementById('from');
  var s=document.getElementById('subject');
  var qry="reportno=14"+
          "&content="+encodeURIComponent(ed.getContent())+
          "&from="+encodeURIComponent(f.value)+
          "&subject="+encodeURIComponent(s.value);
  var xmlHttp = createHttpObject();
  xmlHttp.open("POST",url,false);
  xmlHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
  xmlHttp.send(qry);
  if (xmlHttp.status == 200) {
    if (xmlHttp.responseText=="COMPLETE") {
      alert("Update Complete");
      location.reload();
      return;
    } 
  } else {
    alert("ERROR : A problem occurred saving the records Try Again.");
    return;
  }
}
function init() {
  var theURL   = "PortalConfiguration.php?reportno=14" 
  var xmlHttp=new XMLHttpRequest(); // Firefox, Opera 8.0+, Safari
  xmlHttp.open("GET", theURL, false);
  xmlHttp.send();
  if (xmlHttp.status == 200) {
    var mail = JSON.parse(xmlHttp.responseText);
    var el=document.getElementById('content');
    el.value = mail[0].content;
    el=document.getElementById('subject');
    el.value = mail[0].subject;
    el=document.getElementById('from');
    el.value = mail[0].from;
  }

  LoadTinyMCEResource(InitTinyMCE);
}
function InitTinyMCE() {
  var ToolBar="fontselect fontsizeselect | bold italic underline strikethrough"+
               " alignleft aligncenter alignright alignjustify | link image ";
  tinymce.init({ 
    selector: "textarea.TinyMCE",
    plugins: [ "table link image" ],
    table_default_styles: {
        width: '100%', border: '1px solid silver'
    },
    table_default_attributes: {
        border: '1', cellspacing: '0',cellpadding: '1'
    },
    height:'430px',
    toolbar: ToolBar,
    statusbar: false
  });
}
</script>
</head>
<body onload="PageLoad(event);">
<form name=PageEdit action=PortalConfiguration.php method=POST>
<input type=hidden name=reportno value=1>
<table>
<tr valign=top>
  <td width=35%>
    <table width=100% cellpadding=4 border=1 style='border:1px #ccc solid'>
    <tr class=FreeTextEditorHeading><td colspan=2>Admission Confirmation Email</td></tr>
    <tr><td>&nbsp;</td><td></td></tr>
    <tr>
      <td class=Label>Subject</td>
      <td><input type=text id=subject name=subject size=60></td>
    </tr>
    <tr>
      <td class=Label>From</td>
      <td><input type=text id=from name=from size=60></td>
    </tr>
    <tr><td>&nbsp;</td><td></td></tr>
    <tr class=FreeTextEditorHeading><td colspan=2>Mail Merge Fields</td></tr>
    <tr class=FreeTextEditorHeading><td>Field Tag </td><td>Description</td></tr>
    <tr><td class=Label>$FirstName</td><td>Patients First Name</td></tr>
    <tr><td class=Label>$Surname  </td><td>Patients Surname</td></tr>
    <tr><td class=Label>$Email    </td><td>Patients Email Address</td></tr>
    <tr><td class=Label>$EmailLogo</td><td>URL for Email Logo</td></tr>
    <tr><td class=Label>$HospitalName</td><td>Name of Hospital Selected</td></tr>
    </table>
  </td>
  <td>
    <div id=freeTextEditor class=FreeTextEditor>
      <div class=FreeTextEditorHeading>Admission Confirmation Email Text</div>
      <textarea class=TinyMCE id=content name=content style='width:100%;'></textarea>
      <div class=FreeTextEditorFooter>
      <input type=button class=button value=Save onclick='SaveFreeText();'>
      <input type=button class=button value=Cancel onclick='location.reload();'>
      </div>
    </div>
  </td>
</tr>
</table>
</form>
