<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="sjog-wa">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/preadmission.js"></script>
<script type="text/javascript" src="../js/OECpreadmission.js"></script>
<script type="text/javascript" src="../js/DefaultOnlineAdm.js"></script>
%START.OF.PAGE
<script type="text/javascript">
function switchPresIll() {
  if (document.UpdateForm.presilsw.checked==true) {

    PresIllCodHdr.innerHTML=presillnumhdr.innerHTML;
    PresIllCod.innerHTML=presillnum.innerHTML;
  } else {
    PresIllCodHdr.innerHTML=presillcodhdr.innerHTML;
    PresIllCod.innerHTML=presillcod.innerHTML;
  }

}
function OECRequired() {
 if(document.UpdateForm.oecchbox.checked == true) {

     if (UpdateForm.ptvis043.className=="Mandatory") {
       UpdateForm.ptvis043.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptvis043.className="OECRequired";  //Intended Stay
     }

     if (UpdateForm.ptmis007.className=="Mandatory") {
       UpdateForm.ptmis007.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis007.className="OECRequired";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="Mandatory") {
       UpdateForm.doctnam2.className="OECRequired Mandatory";
     } else {
       UpdateForm.doctnam2.className="OECRequired";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis020.className=="Mandatory") {
       UpdateForm.ptmis020.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis020.className="OECRequired";  //Diagnosis
     }

     if (UpdateForm.ptmis027.className=="Mandatory") {
       UpdateForm.ptmis027.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis027.className="OECRequired";  //Claim Type
     }

     if (UpdateForm.funddesc.className=="Mandatory") {
       UpdateForm.ptmis013.className="OECRequired Mandatory";  //HF
       UpdateForm.funddesc.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis013.className="OECRequired";  //HF
       UpdateForm.funddesc.className="OECRequired";  //Health Fund Code
     }

     if (UpdateForm.tabldesc.className=="Mandatory") {
       UpdateForm.ptmis014.className="OECRequired Mandatory";  //HF Level
       UpdateForm.tabldesc.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis014.className="OECRequired";  //HF Level
       UpdateForm.tabldesc.className="OECRequired";  //Health Fund Code
     }

     UpdateForm.ptmis030.className="OECRequired Integer";    //Planned Length
     UpdateForm.ptvis076.className="OECRequired";            //Discharge Inten
     UpdateForm.ptmis015.className="OECRequired";            //Member Nunber

  } else {

     if (UpdateForm.ptvis043.className=="OECRequired Mandatory") {
       UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
     } else {
       UpdateForm.ptvis043.className="";  //Intended Stay
     }

     if (UpdateForm.ptmis007.className=="OECRequired Mandatory") {
       UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     } else {
       UpdateForm.ptmis007.className="";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="OECRequired Mandatory") {
       UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor Desc
     } else {
       UpdateForm.doctnam2.className="";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis020.className=="OECRequired Mandatory") {
       UpdateForm.ptmis020.className="Mandatory";  //Diagnosis
     } else {
       UpdateForm.ptmis020.className="";  //Diagnosis
     }

     if (UpdateForm.ptmis027.className=="OECRequired Mandatory") {
       UpdateForm.ptmis027.className="Mandatory";  //Claim Type
     } else {
       UpdateForm.ptmis027.className="";  //Claim Type
     }

     if (UpdateForm.funddesc.className=="OECRequired Mandatory") {
       UpdateForm.ptmis013.className="Mandatory";  //HF
       UpdateForm.funddesc.className="Mandatory";  //Health Fund
     } else {
       UpdateForm.ptmis013.className="";           //HF
       UpdateForm.funddesc.className="";  //Health Fund
     }

     if (UpdateForm.tabldesc.className=="OECRequired Mandatory") {
       UpdateForm.ptmis014.className="Mandatory";  //HF Level
       UpdateForm.tabldesc.className="Mandatory";  //Health Fund
     } else {
       UpdateForm.ptmis014.className="";  //HF Level
       UpdateForm.tabldesc.className="";  //Health Fund
     }

     UpdateForm.ptmis030.className="Integer";    //Planned Length of Stay
     UpdateForm.ptvis076.className="";           //Discharge Inten
     UpdateForm.ptmis015.className="";           //Member Number

     setHF();

  }
}
function ShowOESmbs() {
  if(document.UpdateForm.showmbsc.checked == true) {
    OESMBSitems.innerHTML=oesmbsitems.innerHTML;
  } else {
    OESMBSitems.innerHTML=blanklabel.innerHTML;
  }
}
function ShowOECFields() {
  if(document.UpdateForm.oecchbox.checked == true) {
    PreExistAilHdr.innerHTML=preexisthdr.innerHTML;
    PreExistAilmnt.innerHTML=preexistail.innerHTML;
    EmerAdmHdr.innerHTML=emeradmnhdr.innerHTML;
    EmerAdmssn.innerHTML=emeradmissn.innerHTML;
    PresIllCodHdr.innerHTML=presillcodhdr.innerHTML;
    PresIllCod.innerHTML=presillcod.innerHTML;
    SwiPresIll.innerHTML=swipresill.innerHTML;
    LongLine.innerHTML=longline.innerHTML;
    OESMBSitems.innerHTML=blanklabel.innerHTML;
    OESHeadings.innerHTML=oesheadings.innerHTML;
    OESServices.innerHTML=oesservices.innerHTML;
  } else {
    PreExistAilHdr.innerHTML=blanklabel.innerHTML;
    PreExistAilmnt.innerHTML=blanklabel.innerHTML;
    EmerAdmHdr.innerHTML=blanklabel.innerHTML;
    EmerAdmssn.innerHTML=blanklabel.innerHTML;
    PresIllCodHdr.innerHTML=blanklabel.innerHTML;
    PresIllCod.innerHTML=blanklabel.innerHTML;
    SwiPresIll.innerHTML=blanklabel.innerHTML;
    LongLine.innerHTML=blanklabel.innerHTML;
    OESMBSitems.innerHTML=blanklabel.innerHTML;
    OESHeadings.innerHTML=blanklabel.innerHTML;
    OESServices.innerHTML=blanklabel.innerHTML;
  }
}
function getPortalCookie() {
  if (GetCookieData("sjogwaPortalCOOKIE") != 'unknown') {
    ExpireCookiePath("sjogwaPortalCOOKIE");
    sjogprtl = "1";
  }
}

var sjogprtl = "";
getPortalCookie();

if("%STANDARD.01.025.119.182.0.1"=="1" &&
   sjogprtl != "1") {
  var src="../js/eAdmissionReg.js"
} else {
  var src="../js/DefaultOnlineAdm.js";
}
var script = document.createElement("script");
             script.setAttribute("src", src);
             script.setAttribute("type", "text/javascript");
document.getElementsByTagName("head")[0].appendChild(script);
function displayWardDiet() {
  if (document.UpdateForm.ptcndwdc.value=="1") {
    warddietcodetitleDIV.innerHTML=warddietcodetitleSPAN.innerHTML;
    warddietcodeDIV.innerHTML=warddietcodeSPAN.innerHTML;
    dietcommenttitleDIV.innerHTML=dietcommenttitleSPAN.innerHTML;
    dietcommentfieldDIV.innerHTML=dietcommentfieldSPAN.innerHTML;
  }
}
function displayDisaster() {
  if (document.UpdateForm.ptcnudpd.value=="1") {
    disastercodetitleDIV.innerHTML=disastercodetitleSPAN.innerHTML;
    disastercodeDIV.innerHTML=disastercodeSPAN.innerHTML;
  }
}
function SubmitAdm() {
  MandatoryOk=true;
  if (!validateMandatory(document.UpdateForm)) {
    return;
  }

  if (document.UpdateForm.admitbox.value==1) {
    dateDiff=parseInt(SetDateYYYYMMDD(document.UpdateForm.ptmis001.value)) -
             parseInt(DemConDate);
    if (checkDemographicsUpdated(dateDiff,NoDayDemVl,ConfDemogs)){
      return;
    }
  }

  if (document.UpdateForm.oecchbox.checked==true) {
    if (!validateOECRequired(document.UpdateForm)) {
       return;
    }
    if (!validateParticipant(document.UpdateForm.ptmis013.value,"OEC")) {
       return;
    }
  }
  if (!isWhitespace(UpdateForm.ptmis013.value)) {
    if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
                        UpdateForm.funddesc,UpdateForm.tabldesc)) {
      ans=confirm("Select another active health fund table? ");
      if (ans==true) {
        return;
      } 
    } 
  }

  if (UpdateForm.oes01007!=undefined) {

    if (!chkDOS(UpdateForm.oes01007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes02007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes03007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes04007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes05007)) {
      return;
    }
  }

 if (UpdateForm.extrprov!=undefined) {

  if (!isWhitespace(UpdateForm.extrprov.value)) {
    document.UpdateForm.oeceprov.value="1";
  }

  if (!isWhitespace(UpdateForm.extrprv2.value)) {
    document.UpdateForm.oeceprv2.value="1";
  }

  if (!isWhitespace(UpdateForm.extrprv3.value)) {
    document.UpdateForm.oeceprv3.value="1";
  }

  if (!isWhitespace(UpdateForm.extrprv4.value)) {
    document.UpdateForm.oeceprv4.value="1";
  }

  if (!isWhitespace(UpdateForm.extrprv5.value)) {
    document.UpdateForm.oeceprv5.value="1";
  }
 }

  if (document.UpdateForm.dispt001!=undefined &&
      !isWhitespace(document.UpdateForm.dispt001.value)) {
    var serverURL   = "../cgi-bin/comweb80.pbl?reportno=44" +
                    "&valdcode=" + UpdateForm.dispt001.value.replace(/ /g,"+") +
                    UpdateForm.ptmis001.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {
      return;
    }
  }

  if (document.UpdateForm.mvmedre1.checked == true) {
     document.UpdateForm.mvmedrec.value="1";
  } else {
     document.UpdateForm.mvmedrec.value="0";
  }
  if(document.UpdateForm.oecchbox.checked == true) {
     document.UpdateForm.ptvis109.value="1";
  }
  if (MandatoryOk) {
    ans="True";
    CheckPreadmitDate();
    if (ans==false){
      return;
    }
    setRedirectDefaultPrintPage();
    UpdateForm.ptmis004.value=UpdateForm.ptmis068.value;
    UpdateForm.ptmis005.value=UpdateForm.ptmis076.value;

    if(document.UpdateForm.ptcnepis.value=="1") {
      if (!isWhitespace(document.UpdateForm.admisnid.value)) {
        SetCookie("eAdmission",eAdmCookie);
      }
    }

    UpdHealthFund();
    SubmitHidden(UpdateForm);
  }
}
function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
  selectOptions("30",UpdateForm.ptmis007,UpdateForm.ptmis024);
  UpdateForm.ptmis024.selectedIndex=1
}
function AdmitMandatory() {
 if(document.UpdateForm.admitbox.checked == true) {
     document.UpdateForm.admitbox.value="1";
     UpdateForm.ptmis011.className="Mandatory";  //admission type
     UpdateForm.ptmis009.className="Mandatory";  //admission source
     UpdateForm.ptvis041.className="Mandatory";  //criteria for admission
     UpdateForm.ptmis012.className="Mandatory";  //care type
     UpdateForm.ptmis068.className="Mandatory";  //ward
     UpdateForm.ptmis024.className="Mandatory";  //Unit
     UpdateForm.ptmis010.className="Mandatory";  //CMBS Class
     UpdateForm.ptvis046.className="Mandatory";  //Admitting Point
     UpdateForm.ptmis028.className="Mandatory";  //Diet
     UpdateForm.ptvis028.className="Mandatory";  //Referring GP
     UpdateForm.ptvis102.className="Mandatory";  //SOR Professional
     UpdateForm.ptvis103.className="Mandatory";  //SOR Transport   
     UpdateForm.ptmis074.className="Mandatory";  //GST Applicable  
     UpdateForm.ptvis093.className="Mandatory";  //Preferred Accom 
     UpdateForm.ptmis064.className="Mandatory";  //Food Allergy

     var className = (UpdateForm.ptcndigp.value >= 3) ? "Mandatory" : "";
     UpdateForm.ptvis022.className = className;  //Inform GP
     if (className == "Mandatory") {
       UpdateForm.ptvis022.options[0].value = " ";
     }

     if (UpdateForm.ptmis007.className=="OECRequired") {
       UpdateForm.ptmis007.className="OECRequired Mandatory";  //Admitting Doc
     } else {
       UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     }

     if (UpdateForm.ptmis020.className=="OECRequired") {
       UpdateForm.ptmis020.className="OECRequired Mandatory";  //Admitting Doc
     } else {
       UpdateForm.ptmis020.className="Mandatory";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="OECRequired") {
       UpdateForm.doctnam2.className="OECRequired Mandatory";  //Admitting Doc
     } else {
       UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis027.className=="OECRequired") {
       UpdateForm.ptmis027.className="OECRequired Mandatory";  //Admitting Doc
     } else {
       UpdateForm.ptmis027.className="Mandatory";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptvis043.className=="OECRequired") {
       UpdateForm.ptvis043.className="OECRequired Mandatory";  //Intended Stay
     } else {
       UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
     }

  } else {
     document.UpdateForm.admitbox.value="0";
     UpdateForm.ptmis011.className="";  //admission type
     UpdateForm.ptmis009.className="";  //admission source
     UpdateForm.ptvis041.className="";  //criteria for admission
     UpdateForm.ptmis012.className="";  //care type
     UpdateForm.ptmis068.className="";  //ward
     UpdateForm.ptmis024.className="";  //Unit
     UpdateForm.ptmis010.className="";  //CMBS Class
     UpdateForm.ptvis046.className="";  //Admitting Point
     UpdateForm.ptmis028.className="";  //Diet
     UpdateForm.ptvis028.className="";  //Referring GP
     UpdateForm.ptvis102.className="";  //SOR Professional
     UpdateForm.ptvis103.className="";  //SOR Transport   
     UpdateForm.ptmis074.className="";  //GST Applicable  
     UpdateForm.ptvis093.className="";  //Preferred Accom 
     UpdateForm.ptmis064.className="";  //Food Allergy
     UpdateForm.ptvis022.className="";  //Inform GP
     UpdateForm.ptvis022.options[0].value = "2";

     if (UpdateForm.ptmis007.className=="OECRequired Mandatory") {
       UpdateForm.ptmis007.className="OECRequired";  //Admitting Doctor
     } else {
       UpdateForm.ptmis007.className="";  //Admitting Doctor
     }

     if (UpdateForm.ptmis020.className=="OECRequired Mandatory") {
       UpdateForm.ptmis020.className="OECRequired";  //Admitting Doctor
     } else {
       UpdateForm.ptmis020.className="";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="OECRequired Mandatory") {
       UpdateForm.doctnam2.className="OECRequired";  //Admitting Doctor Desc
     } else {
       UpdateForm.doctnam2.className="";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis027.className=="OECRequired Mandatory") {
       UpdateForm.ptmis027.className="OECRequired";  //Claim Type
     } else {
       UpdateForm.ptmis027.className="";  //Claim Type
     }

     if (UpdateForm.ptvis043.className=="OECRequired Mandatory") {
       UpdateForm.ptvis043.className="OECRequired";  //Intended Stay
     } else {
       UpdateForm.ptvis043.className="";  //Intended Stay
     }

  }
}
function valClaimCode() {
  validateCode(41,UpdateForm.urnumber,UpdateForm.claimc);
  if(document.UpdateForm.claimc.value!=""){
  for (var i =0 ; i < document.UpdateForm.ptmis027.length; i++) {
    if (document.UpdateForm.claimc.value==
        trim(document.UpdateForm.ptmis027.options[i].value.substr(0,3))){
           document.UpdateForm.ptmis027.selectedIndex=i;
    }
  }
 }
}
function PageInit() {
  DisContractWA();
  DisplayTrnSrc();
  document.UpdateForm.ptmis001.focus();
  valClaimCode();
  setHF();
  setTimeout('portalADM()',700);
}
function portalADM() {
  if(document.getElementById("ptcnepis").value=="1" &&
     sjogprtl != "1") {
    OnlinePreadmission();
    eAdmPreList();
  } else {
    OnlinePreadmissionSJOG();
  }
}
function OnlinePreadmissionSJOG() {
  if (isWhitespace(document.UpdateForm.admisnid.value)){
    return;
  }
  AdmissionID=GetCookieData("AdmissionID")
  if (!isWhitespace(AdmissionID)&&AdmissionID!="unknown") {
    DefaultOnlineAdm(AdmissionID);
    UpdateProcessedSJOG(AdmissionID)
    var el=document.getElementById("ptmis027");
    var checkInd=el.options[el.selectedIndex].value.substr(3,5);
    if (checkInd.search(/W/g) >= 0) return;
    if (checkInd.search(/M/g) >= 0) return;
    SetCookie("AdmissionID","")
  }
}
function UpdateProcessedSJOG(AdmissionID) {
  UpdateForm.ptmis054.value=AdmissionID; //User UK GP Fund Holder Field to Store
  theURL="preadm01.php"+
         "?reportno=3" +
         "&status=3" +
         "&admissionid="+AdmissionID +
         "&urnumber="+PatientURN;
  xmlHttp = createHttpObject();
  xmlHttp.open("GET", theURL, false);
  xmlHttp.send();
  if (!isWhitespace(xmlHttp.responseText)) {
    alert(xmlHttp.responseText)
  }
}
</script>
</head>
<body onload="PageLoad(event);PageInit();displayDisaster();displayWardDiet();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.03.003";
PatientVIS="%PATWEB89.03.081";
PatientNAM="%PATWEB89.03.002";
PatientSTA="%PATWEB89.03.086.078";
PatientALT="%PATWEB89.03.084";
PatientSEX="%PATWEB89.03.019";
PatientDOB="%PATWEB89.03.020";
PatientAGE="%PATWEB89.03.021";
PatientLOC="%PATWEB89.03.083";
PatientPRI="%PATWEB89.03.086.066.1";
PatientUNT="%PATWEB89.03.066.0";
DoctorCOD="%PATWEB89.03.082.003";
DoctorNAM="%PATWEB89.03.082.002";
PatientAID="%PATWEB89.03.086.090";
PatientIND="%PATWEB89.03.086.091";
PatientCUR="%PATWEB89.03.086.092";
PatientCLC="%PATWEB89.03.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.03.086.094";
PatientCDM="%PATWEB89.03.086.095";
PatientVDH="%PATWEB89.03.086.099.015";
ConfDemogs="%STANDARD.01.045.PTCNCDOA";
NoDayDemVl=trim("%STANDARD.01.045.PTCNNDCD");
DemConDate=SetDateYYYYMMDD("%PATWEB89.03.085.059");
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>

<form name=UpdateForm method=post action=patweb89.pbl style=margin:0>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.081">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value="001">
<input type=hidden name=updatety value="1">
<input type=hidden name=redirect>
<input type=hidden name=allocate value="1">
<input type=hidden name=chckname value="0">
<input type=hidden name=emradmit value="0">
<input type=hidden name=emradmis value="0">
<input type=hidden name=admitnow value="1">
<input type=hidden name=newbmand value="0">
<input type=hidden name=agebmand value="0">
<input type=hidden name=ptmas046 value="0">
<input type=hidden name=updhfund value="">
<input type=hidden name=mvmedrec>
<input type=hidden name=cfinan value="%PATWEB89.03.932">
<input type=hidden name=claimc>
<input type=hidden name=exstward value="%PATWEB89.03.449.1">
<input type=hidden name=dummy>
<input type=hidden name=mothadmn value="%PATWEB89.03.982">
<input type=hidden name=boarderf value="%PATWEB89.03.983">
<input type=hidden name=pswdindc value="0">
<input type=hidden name=ptcnwauc value="%STANDARD.01.025.103.245.0.1">
<input type=hidden name=ptmis054 value="">
<input type=hidden name=catmhlsa value="%STANDARD.01.025.069.190.0.2">
<input type=hidden name=mhadmflg value="0">
<input type=hidden name=ptcnudpd value="%STANDARD.01.025.118.153.0.1">
<input type=hidden name=admisnid id=admisnid value="%PATWEB89.03.999.036">
<input type=hidden name=bedstat1 id=bedstat1>
<input type=hidden name=ptmis004 id=ptmis004 title="Ward">
<input type=hidden name=ptmis005 id=ptmis005 title="Bed">
<input type=hidden name=warddesc id=warddesc>
<input type=hidden name=ptvis029 id=ptvis029 value="%PATWEB89.03.232.1">
<input type=hidden name=ptvis030 id=ptvis030 value="%PATWEB89.03.233.1">
<input type=hidden name=pmihfund value="%PATWEB89.03.040.0">
<input type=hidden name=pmihftab value="%PATWEB89.03.041.0">
<input type=hidden name=pmihndmm value="%PATWEB89.03.042">
<input type=hidden name=genpprov id=genpprov value="">
<input type=hidden name=popwdesc id=popwdesc>
<input type=hidden name=popbstat id=popbstat>
<input type=hidden name=ptcndigp value="%STANDARD.01.025.124.122.0.1">
<input type=hidden name=ptcndwdc value="%STANDARD.01.025.124.148.0.1">
<input type=hidden name=ptcnpmhf id=ptcnpmhf
                                 value="%STANDARD.01.025.124.157.0.1">
<input type="hidden" name="ptcnepis" id="ptcnepis"
 value="%STANDARD.01.025.119.182.0.1" />
<input type="hidden" name="showflag" value="0" />
<input type=hidden name=ptpra001 value=""
                                     title="Person Responsible for Account" />
<input type=hidden name=ptpra002 value=""
                                     title="PRFA Address" />
<input type=hidden name=ptpra004 value=""
                                     title="PRFA Suburb" />
<input type=hidden name=state    value=""
                                     title="PRFA State" />
<input type=hidden name=ptpra006 value=""
                                     title="PRFA Post code" />
<input type=hidden name=ptpra007 value=""
                                     title="PRFA Home Phone" />
<input type=hidden name=ptpra008 value=""
                                     title="PRFA Work Phone" />
<input type=hidden name=ptpra009 value=""
                                     title="PRFA Relationship" />
<input type=hidden name=ptpra010 value=""
                                     title="PRFA Mobile" />
<input type="hidden" name="ptvis109">
<input type=hidden name=oeceprov>
<input type=hidden name=oeceprv2>
<input type=hidden name=oeceprv3>
<input type=hidden name=oeceprv4>
<input type=hidden name=oeceprv5>
<input type="hidden" name="patsurnm"
       title="Patient Surname" value="%PATWEB89.03.009">
<input type="hidden" name="patgivnm"
       title="Patient Given Name" value="%PATWEB89.03.010">
<input type="hidden" name="patntdob"
       title="Patient Date of Birth" value="%PATWEB89.03.020">
<input type=hidden name=ptcnhdps id=ptcnhdps 
       value="%STANDARD.01.025.080.250.1.1">

<table border=0 colspan=0 width=100% cellspacing=0 cellpadding=0 >
<tr><td class=HeadingCell align=center>
    Patient Pre-Admission Details (New) </td>
</tr>
<tr><td>
    <table class=TableBody width=100% border=0 cellpadding=0 cellspacing=0>
     <tr><td>&nbsp;</td><td>&nbsp;</td>
         <td align=left><b>Admit Now?</b></td>
        <td align=left>
        <input type="checkbox" name="admitbox" value="0" notab
           onclick='AdmitMandatory()';>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <b>Patient OEC Consent</b>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <input type="checkbox" name="oecchbox" value="0" notab
           onclick='ShowOECFields();OECRequired();'>
        </td></tr>

     <tr><td class=DataLabel>Admission Date </td>
         <td><input type=text size=12 name=ptmis001 tabindex=1  id=ptmis001
             class="Mandatory Date" title="Admission Date" 
             value="%STANDARD.01.015">
         <img notab src=../images/DateLookup.gif 
          class=Icon onclick="DateLookupFrame(ptmis001);">     
          Time 
       <input class=Mandatory type=text name=ptmis002 size=8 tabindex=2
          value="%STANDARD.01.016" title="Admission Time" id=ptmis002>
        <img notab src=../images/DateTimeStamp.gif 
         class=Icon onclick="SetCurrentDateTime(null,ptmis002);">
       <img notab src=../images/TimeLookup.gif class=Icon
        onclick="TimeLookupFrame(ptmis002);">
          </td>

       <td>Admitting Point</td>
         <td><select name=ptvis046 tabindex=13 title="Admitting Point"
                     onChange="defaultWard()">
           <option></option>
            %PATWEB89.03.290.2
         </select></td></tr>

      <tr><td class=DataLabel>%STANDARD.01.017.P </td>
          <td><select name=ptmis011 tabindex=3  
               title="%STANDARD.01.017.P ">
              <option> </option>
                 %PATWEB89.03.112.2
              </select></td>
       <td class=DataLabel>Ward / Bed </td>
         <td>
           <select name=ptmis068 tabindex=13 title="Ward" id=ptmis068>
            <option> </option>
            %PATWEB89.03.449.2
           </select>
           <input type=text name=ptmis076 readonly maxlength=3 size=3
                  title="Bed" id=ptmis076>
           <img notab src=../images/SearchIcon.gif class=Icon
            onclick="WardBedSearchFrame(ptmis068,warddesc,ptmis076,bedstat1);">
          </td></tr>
          <tr><td class=DataLabel>Admission Source</td>
          <td><select name=ptmis009 tabindex=4 
               onchange="DisplayTrnSrc()" title="Admission Source">
               <option> </option>
               %PATWEB89.03.110.2
               </select></td>
          <td class=DataLabel>Admitting Doctor</td>
          <td><input type="text" size=8 maxlength=6 name="ptmis007" tabindex=13
              title="Admitting Doctor" value="%PATWEB89.03.108.003"
              onblur="UpCase(this);valDoctorUnit();" id=ptmis007>
              <input type=text readonly size=25 notab name=doctnam2 id=doctnam2
               title="Admitting Doctor" value="%PATWEB89.03.108.002">
              <img notab src="../images/SearchIcon.gif" class=Icon
             onclick="DoctorSearchFrame(ptmis007,doctnam2)">
          </td></tr>

<tr>
    <td class=DataLabel>%STANDARD.01.017.SH</td>
    <td><select name=ptvis102 tabindex=5 class=SelectBig
         title="%STANDARD.01.017.SH">
         <option></option>
          %PATWEB89.03.298.024.5
         </select></td>
          <td class=DataLabel>Unit</td>
          <td><select name=ptmis024 tabindex=14
               title="Unit">
              <option> </option>
                 %PATWEB89.03.124.2
              </select>    
          </td></tr>

<tr>
    <td class=DataLabel>%STANDARD.01.017.SI</td>
    <td><select name=ptvis103 tabindex=6 class=SelectBig
         title="%STANDARD.01.017.SI">
         <option></option>
          %PATWEB89.03.298.025.5
         </select></td>
          <td class=DataLabel>Diagnosis </td>
          <td><input tabindex=15 type=text name="ptmis020" size=50 
               title='Diagnosis' maxlength=80>
          </td>
</tr>
     <tr><td class=DataLabel></td>
          <td>
          </td>
          <td class=DataLabel>Provisional DRG</td>
          <td class=DataLabel>
            <input type=text name=ptmis066 size=5 maxlength=4 tabindex=16
             id=ptmis066 onblur="validateCode(5,ptmis066,drgdesc1);"
             title="Provisional DRG" value="%PATWEB89.03.140.0">
            <input type=text notab readonly name=drgdesc1
             id=drgdesc1 size=35 value="%PATWEB89.03.140.1">
            <img notab src="../images/SearchIcon.gif" class=Icon
             onclick="DrgSearchFrame(ptmis066,drgdesc1)">
          </td></tr>
     <tr><td class=DataLabel><div id=TranSrcHeading></div></td>
         <td><div id=TranSrc></div></td>
         <td class=DataLabel> Admission Diet</td>
        <td>
           <select name=ptmis028 tabindex=17 title="Admission Diet">
           <option> </option>
            %PATWEB89.03.127.5
            </select>
         %STANDARD.01.017.U9
         <select name=ptmis064 tabindex=17 onchange="setAlert();"
          title="%STANDARD.01.017.U9">
           <option></option>
            %PATWEB89.03.155.5
         </select></td></tr>

     <tr><td align=left>Prior Days Hospitalisation</td>
         <td align=left>
           <input type=text name=ptmis031 title='Prior Days Hospitalisation'
            class=Integer size=5 maxlength=4 tabindex=7
            onblur="checkInteger(this,this.title);">
         </td>
         <td class=DataLabel><div id=warddietcodetitleDIV></div></td>
         <td><div id=warddietcodeDIV></div></td>
     </tr>

      <tr><td class=DataLabel>Admission Criteria</td>
          <td>
          <select name=ptvis041 tabindex=9 title="Criteria for Admission">
          <option> </option>
          %PATWEB89.03.244.2
          </select>
          </td>
          <td class=DataLabel><div id=dietcommenttitleDIV></div></td>
          <td><div id=dietcommentfieldDIV></div></td>
      </tr>

     <tr><td class=DataLabel>Care Type</td>
          <td><select name=ptmis012 tabindex=9 title="Care Type"
               onchange="displayRegime();"> 
              <option> </option>
               %PATWEB89.03.113.2
              </select></td>
        <td class=DataLabel>Referring GP</td>
        <td><input type="text" size=10 maxlength=10 name="ptvis028" tabindex=18
             id=ptvis028 onblur="ValidateHCP(18,0,ptvis028,doctnam1);"
             value="%PATWEB89.03.231.1" title="Referring GP">
            <input type="text" size=25 notab readonly name="doctnam1"
             id=doctnam1 value="%PATWEB89.03.231.0">
            <img src="../images/SearchIcon.gif" class=Icon
         onclick="HCPSearchFrame(UpdateForm.ptvis028,UpdateForm.doctnam1,0);">
          <td></tr>

      <tr><td class=DataLabel> Intended Stay </td>
          <td class=DataLabel>
             <select name=ptvis043 tabindex=10 title="Intended Stay">
             <option> </option>
              %PATWEB89.03.246.2
             </select>
        </td>
    <td class=DataLabel>Practice</td>
    <td><input type=text name=genpprac size=35 readonly id=genpprac
                 value="%PATWEB89.03.232.0">
          <img src="../images/SearchIcon.gif" class=Icon
 onclick="GPHCGSearchFrame(ptvis028,doctnam1,genpprov,ptvis029,genpprac,ptvis030)">
 <img src="../images/erase.gif" class=Icon onclick="clrFields(ptvis029,genpprac,ptvis030,genpprov);">
      </td>
</tr>
       <tr><td class=DataLabel> Planned Length of Stay</td>
        <td>
        <input type=text size=5 maxlength=5 name=ptmis030
         tabindex=10 title='Planned Length of Stay'
         class=Integer onblur="checkInteger(this,this.value);">
        </td>

      <td class=DataLabel>Inform GP</td>
      <td>
        <select name=ptvis022 tabindex=19 title="Inform GP">
          <option value="2"> </option>
          <option value="0">No</option>
          <option value="1">Yes</option>
        </select>
        </td></tr>

       <tr><td class=DataLabel>Discharge Intention</td>
          <td><select name=ptvis076 tabindex=10 title="Discharge Intention"> 
              <option> </option>
               %PATWEB89.03.292.2
              </select></td>
       <td class=DataLabel>Religious Visit</td>
       <td>
         <select name=ptmis017 tabindex=20 title="Religious Visit">
          <option value="3">Unk</option>
          <option value="2">No</option>
          <option value="1">Yes</option>
         </select>
       </td></tr>

       <tr><td class=DataLabel>Palliative Care Status</td>
          <td><select name=ptvis077 tabindex=10 title="Care Type"> 
              <option> </option>
               %PATWEB89.03.293.4
              </select></td>
        <td class=DataLabel>Research Contact</td>
        <td class=DataField><select name=ptvis084 tabindex=21 
                             title="Research Contact">
         %PATWEB89.03.298.003.2</select></td>
       </tr>

       <tr><td class=DataLabel>Preferred Accommodation</td>
          <td><select name=ptvis093 tabindex=11 title="Preferred Accommodation">
              <option> </option>
               %PATWEB89.03.298.012.2
              </select></td>
        <td class=DataLabel>Research Use</td>
        <td class=DataField><select name=ptvis085 tabindex=21 
                             title="Research Use">
         %PATWEB89.03.298.004.2</select></td>
       </tr>

<tr><td class=DataLabel>Exp.Post Op Ward/Bed</td>
     <td>
		 <select name=ptvis048 id=ptvis048 tabindex=12>
		 <option></option>
		 %PATWEB89.03.251.2
		 </select>
		 <input type=text name=ptvis049 maxlength=3 size=3 id=ptvis049
		  value="%PATWEB89.03.252.0" tabindex=12>
		 <img src=../images/SearchIcon.gif class=Icon
		 onclick="WardBedSearchFrame(ptvis048,popwdesc,ptvis049,popbstat);">
	     </td>
           <td class=DataLabel>Foundation</td>
           <td><select name=ptmis071 tabindex=21 title="Foundation">
               <option value="0">No</option>
               <option value="1">Yes</option>
               </select></td>
	       </tr>

         <tr>
    <td class=DataLabel><div id=disastercodetitleDIV></div></td>
    <td><div id=disastercodeDIV></div></td>
      <td class=DataLabel>Mailing List</td>
      <td>
        <select name=ptmis072 tabindex=21 title="Mailing List">
        <option value="0">No</option>
        <option value="1">Yes</option>
        </select>
        </td>
       </tr>
     <tr>
    <td class=DataLabel><div id=disasteridnumbertitleDIV></div></td>
    <td><div id=disasteridnumberDIV></div></td>
         <td class=DataLabel>Valuables Location</td>
         <td><input type="text" size=40 maxlength=40 name=ptvis020
             tabindex=21 value="%PATWEB89.03.223"></td>
         </tr>

     <tr><td class=DataLabel>3B Days of hospitalisation</td>
         <td>
	 <input type=text name=ptmis082 title='3B days of hospitalisation'
           class=Integer size=5 maxlength=4 tabindex=12 
           onblur="checkInteger(this,this.title);">
	 </td>
      <td class=DataLabel>Program</td>
      <td><input type=text size=8 maxlength=8 name=ptvis099
         title="Program" tabindex=21 value="%PATWEB89.03.298.021.1"
          onchange="findPrgmdesc();">
          <select name=prgmcode Readonly class=readonly tabindex=166
          onchange="savePrgmcode();">
          <option> </option>
           %PATWEB89.03.298.021.2
          </select></td>
         </tr>

	       <tr align=left>
		 <td align=center colspan="4">
		 <hr>
		 </td>
	       </tr>

	     <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
		  <td><select name=ptmis027 title="%STANDARD.01.017.CL" 
                                id=ptmis027 tabindex=22 
         onchange="if (document.UpdateForm.ptmis013.className != 'OECRequired') 
                   {setHF();}">
			<option> </option>
			 %PATWEB89.03.126.9.1.10.2.X
		      </select>
		   </td>

            <td class=DataLabel>Casepayment</td>
            <td><select name=ptmis075 tabindex=29 title="Casepayment">
            <option> </option>
             %PATWEB89.03.197.2
            </select>
            </td>
</tr>

	      <tr><td class=DataLabel>%STANDARD.01.017.A </td>
		  <td><select name=ptmis010 tabindex=23  
		       title="%STANDARD.01.017.A "
		       onchange="DisContractWA();" > 
		      <option> </option>
			 %PATWEB89.03.111.5
		      </select></td>
              <td class=DataLabel>Casemix Code</td>
              <td class=DataLabel>
              <input type=text name=ptmis073 size=10 maxlength=9 tabindex=30
                 id=ptmis073 onblur="validateCode(35,ptmis073,cmixdesc1);"
                 title="Casemix Code">
              <input type=text notab readonly name=cmixdesc1
                 id=cmixdesc1 size=35 value="">
              <img notab src="../images/SearchIcon.gif" class=Icon
                 onclick="CmixSearchFrame(ptmis073,cmixdesc1)">
              </td>
</tr>


	<tr>
	    <td class=DataLabel>Health Fund </td>
	    <td width=35%><input type=text size=6 maxlength=6 name=ptmis013
		 id=ptmis013 title="Health Fund" tabindex=24
		 onchange="validateCode(16,document.UpdateForm.ptmis013,funddesc);
			   checkTableadm();" value="%PATWEB89.03.040.0">
		<input type=text size=25 maxlength=30 name=funddesc class=readonly
		 id=funddesc Readonly notab value="%PATWEB89.03.040.1">
	    Level
		<input name="ptmis014" size=8 maxlength=8 id=ptmis014
		 tabindex=25 value="%PATWEB89.03.041.0"
		 title="Level"
		 onblur="validateHFT(20,ptmis013,ptmis014,funddesc,tabldesc);">
		<input type="text" size=15 maxlength=17 name="tabldesc" id=tabldesc
		 class=readonly Readonly notab value="%PATWEB89.03.041.1" >
		<img src=../images/SearchIcon.gif class=Icon
		 onclick="HealthFundSearchFrame(ptmis013,funddesc,ptmis014,tabldesc);">
		<img src="../images/erase.gif" class=Icon
		 onclick="clrDoc(ptmis013,ptmis014);clrDoc(funddesc,tabldesc);
			  checkTableadm();">
	    </td>
	    <td><div id=RegimeHead1></div></td>
	    <td><div id=RegimeCode1></div></td>  
	</tr>

	  <tr><td class=DataLabel> Member Number </td>
	      <td><input type=text size=20 maxlength=19 name=ptmis015 
                   tabindex=26 title="Member Number" value="%PATWEB89.03.042">
	      </td>
	      <td><div id=RegimeHead2></div></td>
	      <td><div id=RegimeCode2></div></td>
	      </tr>

	  <tr><td class=DataLabel>GST Applicable</td>
	      <td><select name=ptmis074 tabindex=27>
		  <option> </option>
		   %PATWEB89.03.189.2
		  </select>
	      </td>
	      <td><div id=RegimeHead3></div></td>
	      <td><div id=RegimeCode3></div></td>
	      </tr>
	     <tr><td align=left>Move Medical Record</td>
		<td align=left>
		<input type="checkbox" name="mvmedre1" value="1" tabindex=28>
		</td>
                <td class=DataLabel>Continuous Billing</td>
            <td><select name=ptmis081 tabindex=31>
            <option> </option>
             %PATWEB89.03.199.014.2
            </select>
            </td>
                </tr>

  <tr><td></td>
      <td></td>
      <td class=DataLabel><div id=PreExistAilHdr></div></td>
      <td><div id=PreExistAilmnt></div></td>
      </tr>

  <tr><td></td>
      <td></td>
      <td class=DataLabel><div id=EmerAdmHdr></div></td>
      <td><div id=EmerAdmssn></div></td>
      </tr>

  <tr><td></td>
      <td align=right><div id=SwiPresIll></div></td>
      <td class=DataLabel><div id=PresIllCodHdr></div></td>
      <td><div id=PresIllCod></div></td>
      </tr>

  <tr><td>&nbsp;</td></tr>

  <tr><td><div id=AddMBScodes></div></td>
  <tr><td align=center colspan="4"><div id=LongLine></div></td>
  <tr><td align=center colspan="4"><div id=OESMBSitems></div></td></tr>
  <tr><td align=center colspan="5"><div id=OESHeadings></div></td></tr>
  <tr><td align=center colspan="4"><div id=OESServices></div></td>

	  <tr><td>&nbsp;</td>
	      <td>&nbsp;</td>
	      <td><div id=UserNameHead></div></td>
	      <td><div id=UserNameCode></div></td>
	  <tr><td>&nbsp;</td>
	      <td>&nbsp;</td>
	      <td><div id=PasswordHead></div></td>
      <td><div id=PasswordCode></div></td>

  <tr><td class=DataLabel><div id=ContractHeading></div></td>
          <td><div id=ContractType></div></td>
          <td class=DataLabel><div id=Contrac1Heading></div></td>
          <td><div id=ContractRole></div></td>
      </tr>
      <tr><td>&nbsp;</td>
          <td>&nbsp;</td>
      <td class=DataLabel><div id=Contrac2Heading></div></td>
      <td><div id=ContractId></div></td>
      </tr>

      <tr align=center>
       <td colspan=4 align=center><br>
       <input tabindex=31 type=button value="Ok" class=button
        id="pat89sub"
        onclick="tempDisable(this);checkBedStatus(UpdateForm.ptmis068.value,
                 UpdateForm.ptmis076.value,UpdateForm.ptmis001.value,
                 UpdateForm.ptmis030.value,UpdateForm.ptmis002.value,
                 UpdateForm.ptrgm001.value,UpdateForm.ptrgm002.value,
                 UpdateForm.ptrgm003.value,SubmitAdm)";>
       <input tabindex=31 type=button value="Cancel" class=button
             onclick="PatientLinkTo('patweb98.pbl',1,1,0);">
    </table>
</td></tr>
</table>
</form>

<form name=linkForm action=patweb89.pbl method=post>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.081">
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.03.003">
<input type=hidden name=admissno value="%PATWEB89.03.101">
<input type=hidden name=MenuType value="%PATWEB89.03.088">
<input type=hidden name=ptcnbman value="%STANDARD.01.025.112.107.0.1">
</form>

</div>
<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 tabindex=19 id=ptmis058
         title="Referral Date">
         <img notab src=../images/DateLookup.gif 
          class=Icon onclick="DateLookupFrame(ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
    <td><input type=text size=12 name=ptmis059 tabindex=20 id=ptmis059
         title="Consultation Date">
         <img notab src=../images/DateLookup.gif 
          class=Icon onclick="DateLookupFrame(ptmis059);"></td></tr>
</table>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Admission Weight</td>
    <td><input type=text name=ptmis051 size=5 maxlength=4>grams</td></tr>
</table>
</span>

<span id=NewBorn style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
    <td><input type=text name=ptmis041 maxlength=3 size=4 tabindex=21> weeks
    </td></tr>
</table>
</span>
<span id=regimehd1 style="display:none">
<td class=DataLabel>Regime Code 1</td>
</span>
<span id=regimecod1 style="display:none">
<td><input type="text" size=15 maxlength=10
     name=ptrgm001 tabindex=30 id=ptrgm001
     onblur="validateCode(75,UpdateForm.ptrgm001,UpdateForm.dummy);">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(ptrgm001,dummy);">
    <img src="../images/erase.gif" class=Icon onclick="clrFields(ptrgm001,dummy);">
</td>
</span>

<span id=regimehd2 style="display:none">
<td class=DataLabel>Regime Code 2</td>
</span>
<span id=regimecod2 style="display:none">
<td><input type="text" size=15 maxlength=10
     name=ptrgm002 tabindex=30 id=ptrgm002
     onblur="validateCode(75,UpdateForm.ptrgm002,UpdateForm.dummy);">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(ptrgm002,dummy);">
    <img src="../images/erase.gif" class=Icon onclick="clrFields(ptrgm002,dummy);">
</td>
</span>

<span id=regimehd3 style="display:none">
<td class=DataLabel>Regime Code 3</td>
</span>
<span id=regimecod3 style="display:none">
<td><input type="text" size=15 maxlength=10
     name=ptrgm003 tabindex=30 id=ptrgm003
     onblur="validateCode(75,UpdateForm.ptrgm003,UpdateForm.dummy);">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(ptrgm003,dummy);">
    <img src="../images/erase.gif" class=Icon onclick="clrFields(ptrgm003,dummy);">
</td>
</span>

<span id=regimeblank1 style="display:none">
<td><input type=hidden name=ptrgm001 value=""></td>
</span>

<span id=regimeblank2 style="display:none">
<td><input type=hidden name=ptrgm002 value=""></td>
</span>

<span id=regimeblank3 style="display:none">
<td><input type=hidden name=ptrgm003 value=""></td>
</span>

<span id=usernamehd style="display:none">
<td class=DataLabel>User Name</td>
</span>

<span id=usernamcd style="display:none">
<td><input size=12 type=text name=username class=Mandatory title="UserName">
</td>
</span>

<span id=passwordhd style="display:none">
<td class=DataLabel>Password</td>
</span>

<span id=passwordcd style="display:none">
<td><input size=12 type=password name=password onblur="checkPass();"
     class=Mandatory title="Password"></td>
</span>
<span id=blanklabel style="display:none">&nbsp;</span> 
<script type="text/javascript">
displayRegime();

MergePsy="%PATWEB89.03.050"
if(MergePsy=="Yes"){
  document.UpdateForm.ptmas046.value="1"
}
if(MergePsy=="No "){
  document.UpdateForm.ptmas046.value="0"
}
if ("%PATWEB89.03.903" == "1") {
  alert("Warning: Patient has a Waiting List Procedure");
}
if ("%PATWEB89.03.904" == "1") {
  alert("Warning: Patient has a Booking");
}
if ("%PATWEB89.03.905" == "1") {
  alert("Warning: Patient is currently admitted");
}
if ("%PATWEB89.03.908" == "1") {
  alert("Warning: Patient has a pre-admission record");
}
Day=document.UpdateForm.ptmis001.value.substr(0,2).replace(/ /g,"0")
Dat=document.UpdateForm.ptmis001.value.substr(2)
document.UpdateForm.ptmis001.value=Day + Dat

var p = document.UpdateForm;
var informGP = "%PATWEB89.03.225.1";               //ptvis022
valInformGP(p.ptvis022,informGP,p.ptcndigp.value);

document.UpdateForm.ptvis084.selectedIndex=2;
document.UpdateForm.ptvis085.selectedIndex=2;
</script>

<span id=transferhd style="display:none">
Transfer Source
</span>

<span id=transfersrc style="display:none">
  <input type="text" size=7 maxlength=5 name=trnsfsrc class=Mandatory
   title="Transfer Source" tabindex=5 id=trnsfsrc
   onchange="validateCode(9,trnsfsrc,trandesc);">
  <input type=text size=27 name=trandesc notab id=trandesc
   class=Readonly readonly>
  <img src="../images/SearchIcon.gif" class=Icon
   onclick="TransferSourceFrame(trnsfsrc,trandesc)">
</span>

<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>

<span id=preexisthdr style="display:none">
 <b>PEA Indicator</b>
</span>

<span id=emeradmnhdr style="display:none">
 <b>Emergency Admission</b>
</span>

<span id=presillcodhdr style="display:none">
 <b>Presenting Illness Code</b>
</span>

<span id=presillnumhdr style="display:none">
 <b>Presenting Illness Number (MBS)</b>
</span>

<span id=swipresillhdr style="display:none">
 <b>Switch to MBS Presenting Illness Number &nbsp;</b>
</span>

<span id=preexistail style="display:none">
  <select name=ptelg014 title="PEA Indicator" class="OECRequired">
  <option value="0">No</option>
  <option value="1">Yes</option>
  </select>
</span>

<span id=emeradmissn style="display:none">
  <select name=ptelg033 title="Emergency Admission" class="OECRequired">
  <option value="0">No</option>
  <option value="1">Yes</option>
  </select>
</span>

<span id=presillcod style="display:none">
  <select name=ptvis111 title="Presenting Illness" class="OECRequired">
  <option value=" "></option>
   %PATWEB89.03.298.034.2
  </select>
</span>

<span id=swipresill style="display:none">
 <b>Switch to MBS Presenting Illness Number &nbsp;</b>
 <input type="checkbox" name="presilsw" value="1" title="Presenting Illness MBS"
       onclick="switchPresIll();"> &nbsp; &nbsp;
</span>

<span id=presillnum style="display:none">
    <input type=text name=ptmis026 size=10 maxlength=9 id=ptmis026
     onblur='validateCode(4,ptmis026,mbsdesc1,ptmis001)' class="OECRequired">
    <input type=text notab readonly name=mbsdesc1 size=35 id=mbsdesc1
     class="OECRequired">
    <img notab src="../images/SearchIcon.gif" class=Icon
     onClick="MbsSearchFrame(ptmis026,mbsdesc1,ptmis001)">
        <img src="../images/erase.gif" class=Icon
         onClick="clrFields(ptmis026,mbsdesc1);">
</span>

<span id=addmbscodes style="display:none">
  <tr><td class=DataLabel>Show Extra MBS Codes</td>
      <td><input type="checkbox" name="showmbsc" value="1"
       onclick="ShowOESmbs();">
      </td></tr>
</table>
</span>

<span id=oesheadings style="display:none">
<table border=0 colspan=0 width=70% cellspacing=0 cellpadding=0 >
  <tr><td width=20%><b>Date</b></td>
      <td width=12%><b>Type</b></td>
      <td width=60%><b>Item / Description</b></td>
                   <td><b>Quantity</b></td></tr>
</table>
</span>

<span id=oesservices style="display:none">
<table border=0 colspan=0 width=70% cellspacing=0 cellpadding=0 >
  <tr><td width=20%>
     <input type=text size=12 name=oes01007 id=oes01007
      class="FutureDate" title="OES Service 1 Date"
      onblur=checkDate(this,this.title);>
     <img notab src=../images/DateTimeStamp.gif 
      class=Icon onClick="SetCurrentDateTime(oes01007,null);">
     <img notab src=../images/DateLookup.gif 
      class=Icon onclick="DateLookupFrame(oes01007);">
     </td>
  <input type=hidden name=oes01004 value="6">
      <td width=12%><b>Misc.Item</b></td>
      <td>
    <input type=text name=oes01005 id=oes01005 title="Item Code" size=10 maxlength=10
     onBlur="validateItemCode(document.UpdateForm.oes01004,
                              document.UpdateForm.oes01005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes01005);
             mandatoryItemCode(this,document.UpdateForm.oes01007,
                                    document.UpdateForm.oes01006);
             document.UpdateForm.oes01006.value=1;
             justifyRight(document.UpdateForm.oes01006);">
    <input type=text name=d_oes01005 size=50 readonly id=d_oes01005
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes01004,
                                  document.UpdateForm.oes01005,
                                  document.UpdateForm.d_oes01005);">
    <img src="../images/erase.gif" class=Icon 
     onClick="clrFields(oes01005,d_oes01005);
                            mandatoryItemCode(document.UpdateForm.oes01005,
                                              document.UpdateForm.oes01007,
                                              document.UpdateForm.oes01006);">
                   </td>
                   <td>
    <input type=text name=oes01006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes02007 id=oes02007
      class="FutureDate" title="OES Service 2 Date"
      onblur=checkDate(this,this.title);>
     <img notab src=../images/DateTimeStamp.gif 
      class=Icon onClick="SetCurrentDateTime(oes02007,null);">
     <img notab src=../images/DateLookup.gif 
      class=Icon onclick="DateLookupFrame(oes02007);">
                   </td>
  <input type=hidden name=oes02004 value="6">
      <td width=12%><b>Misc.Item</b></td>
      <td>
    <input type=text name=oes02005 id=oes02005 title="Item Code" size=10 maxlength=10
     onBlur="validateItemCode(document.UpdateForm.oes02004,
                              document.UpdateForm.oes02005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes02005);
             mandatoryItemCode(this,document.UpdateForm.oes02007,
                                    document.UpdateForm.oes02006);
             document.UpdateForm.oes02006.value=1;
             justifyRight(document.UpdateForm.oes02006);">
    <input type=text name=d_oes02005 size=50 readonly id=d_oes02005
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes02004,
                                  document.UpdateForm.oes02005,
                                  document.UpdateForm.d_oes02005);">
    <img src="../images/erase.gif" class=Icon 
     onClick="clrFields(oes02005,d_oes02005);
                            mandatoryItemCode(document.UpdateForm.oes02005,
                                              document.UpdateForm.oes02007,
                                              document.UpdateForm.oes02006);">
                   </td>
                   <td>
    <input type=text name=oes02006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes03007 id=oes03007
      class="FutureDate" title="OES Service 3 Date"
      onblur=checkDate(this,this.title);>
     <img notab src=../images/DateTimeStamp.gif 
      class=Icon onClick="SetCurrentDateTime(oes03007,null);">
     <img notab src=../images/DateLookup.gif 
      class=Icon onclick="DateLookupFrame(oes03007);">
     </td>
  <input type=hidden name=oes03004 value="6">
      <td width=12%><b>Misc.Item</b></td>
      <td>
    <input type=text name=oes03005 id=oes03005 title="Item Code" size=10 maxlength=10
     onBlur="validateItemCode(document.UpdateForm.oes03004,
                              document.UpdateForm.oes03005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes03005);
             mandatoryItemCode(this,document.UpdateForm.oes03007,
                                    document.UpdateForm.oes03006);
             document.UpdateForm.oes03006.value=1;
             justifyRight(document.UpdateForm.oes03006);">
    <input type=text name=d_oes03005 size=50 readonly id=d_oes03005
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes03004,
                                  document.UpdateForm.oes03005,
                                  document.UpdateForm.d_oes03005);">
    <img src="../images/erase.gif" class=Icon
     onClick="clrFields(oes03005,d_oes03005);
                            mandatoryItemCode(document.UpdateForm.oes03005,
                                              document.UpdateForm.oes03007,
                                              document.UpdateForm.oes03006);">
                   </td>
                   <td>
    <input type=text name=oes03006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes04007 id=oes04007
      class="FutureDate" title="OES Service 4 Date"
      onblur=checkDate(this,this.title);>
     <img notab src=../images/DateTimeStamp.gif 
      class=Icon onClick="SetCurrentDateTime(oes04007,null);">
     <img notab src=../images/DateLookup.gif 
      class=Icon onclick="DateLookupFrame(oes04007);">
     </td>
  <input type=hidden name=oes04004 value="6">
      <td width=12%><b>Misc.Item</b></td>
      <td>
    <input type=text name=oes04005 title="Item Code" size=10 maxlength=10
     onBlur="validateItemCode(document.UpdateForm.oes04004,
                              document.UpdateForm.oes04005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes04005);
             mandatoryItemCode(this,document.UpdateForm.oes04007,
                                    document.UpdateForm.oes04006);
             document.UpdateForm.oes04006.value=1;
             justifyRight(document.UpdateForm.oes04006);">
    <input type=text name=d_oes04005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif"
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes04004,
                                  document.UpdateForm.oes04005,
                                  document.UpdateForm.d_oes04005);">
    <img src="../images/erase.gif" onClick="clrFields(oes04005,d_oes04005);
                            mandatoryItemCode(document.UpdateForm.oes04005,
                                              document.UpdateForm.oes04007,
                                              document.UpdateForm.oes04006);">
                   </td>
                   <td>
    <input type=text name=oes04006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
  <tr><td>
     <input type=text size=12 name=oes05007
      class="FutureDate" title="OES Service 5 Date"
      onblur=checkDate(this,this.title);>
     <img notab src=../images/DateTimeStamp.gif border=0 hspace=4
      class=Icon onClick="SetCurrentDateTime(oes05007,null);">
     <img notab src=../images/DateLookup.gif border=0 hspace=4
      class=Icon onclick="DateLookupFrame(oes05007);">
     </td>
  <input type=hidden name=oes05004 value="6">
      <td width=12%><b>Misc.Item</b></td>
      <td>
    <input type=text name=oes05005 title="Item Code" size=10 maxlength=10
     onBlur="validateItemCode(document.UpdateForm.oes05004,
                              document.UpdateForm.oes05005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes05005);
             mandatoryItemCode(this,document.UpdateForm.oes05007,
                                    document.UpdateForm.oes05006);
             document.UpdateForm.oes05006.value=1;
             justifyRight(document.UpdateForm.oes05006);">
    <input type=text name=d_oes05005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif"
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes05004,
                                  document.UpdateForm.oes05005,
                                  document.UpdateForm.d_oes05005);">
    <img src="../images/erase.gif" onClick="clrFields(oes05005,d_oes05005);
                            mandatoryItemCode(document.UpdateForm.oes05005,
                                              document.UpdateForm.oes05007,
                                              document.UpdateForm.oes05006);">
                   </td>
                   <td>
    <input type=text name=oes05006 title="Quantity" size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
</table>
</span>

<span id=oesmbsitems style="display:none">
<table border=0 colspan=0 width=70% cellspacing=0 cellpadding=0 >
  <input type=hidden name=mbstypes value="3">
  <tr><td width=20%></td>
      <td width=12%><b>MBS Item</b></td>
    <td>
    <input type=text name=extrprov title="Item Code" size=10 maxlength=10
     onBlur="validateItemCode(document.UpdateForm.mbstypes,
                              document.UpdateForm.extrprov,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_extrprov);">
    <input type=text name=d_extrprov size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif"
     onclick="ItemCodeSearchFrame(document.UpdateForm.mbstypes,
                                  document.UpdateForm.extrprov,
                                  document.UpdateForm.d_extrprov);">
    <img src="../images/erase.gif" onClick="clrFields(extrprov,d_extrprov);">
                   </td></tr>

  <tr><td width=20%></td>
      <td width=12%><b>MBS Item</b></td>
    <td>
    <input type=text name=extrprv2 title="Item Code" size=10 maxlength=10
     onBlur="validateItemCode(document.UpdateForm.mbstypes,
                              document.UpdateForm.extrprv2,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_extrprv2);">
    <input type=text name=d_extrprv2 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif"
     onclick="ItemCodeSearchFrame(document.UpdateForm.mbstypes,
                                  document.UpdateForm.extrprv2,
                                  document.UpdateForm.d_extrprv2);">
    <img src="../images/erase.gif" onClick="clrFields(extrprv2,d_extrprv2);">
                   </td></tr>
  <tr><td width=20%></td>
      <td width=12%><b>MBS Item</b></td>
    <td>
    <input type=text name=extrprv3 title="Item Code" size=10 maxlength=10
     onBlur="validateItemCode(document.UpdateForm.mbstypes,
                              document.UpdateForm.extrprv3,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_extrprv3);">
    <input type=text name=d_extrprv3 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif"
     onclick="ItemCodeSearchFrame(document.UpdateForm.mbstypes,
                                  document.UpdateForm.extrprv3,
                                  document.UpdateForm.d_extrprv3);">
    <img src="../images/erase.gif" onClick="clrFields(extrprv3,d_extrprv3);">
                   </td></tr>
  <tr><td width=20%></td>
      <td width=12%><b>MBS Item</b></td>
    <td>
    <input type=text name=extrprv4 title="Item Code" size=10 maxlength=10
     onBlur="validateItemCode(document.UpdateForm.mbstypes,
                              document.UpdateForm.extrprv4,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_extrprv4);">
    <input type=text name=d_extrprv4 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif"
     onclick="ItemCodeSearchFrame(document.UpdateForm.mbstypes,
                                  document.UpdateForm.extrprv4,
                                  document.UpdateForm.d_extrprv4);">
    <img src="../images/erase.gif" onClick="clrFields(extrprv4,d_extrprv4);">
                   </td></tr>
  <tr><td width=20%></td>
      <td width=12%><b>MBS Item</b></td>
    <td>
    <input type=text name=extrprv5 title="Item Code" size=10 maxlength=10
     onBlur="validateItemCode(document.UpdateForm.mbstypes,
                              document.UpdateForm.extrprv5,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_extrprv5);">
    <input type=text name=d_extrprv5 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif"
     onclick="ItemCodeSearchFrame(document.UpdateForm.mbstypes,
                                  document.UpdateForm.extrprv5,
                                  document.UpdateForm.d_extrprv5);">
    <img src="../images/erase.gif" onClick="clrFields(extrprv5,d_extrprv5);">
                   </td></tr>
    <tr><td align=center colspan="4"><hr width=100%></td></tr>

</table>
</span>

<span id=contracthd style="display:none">
Contract Type
</span>

<span id=contracrhd style="display:none">
Contract Role
</span>

<span id=contracihd style="display:none">
 Contract Id
</span>

<span id=contractid style="display:none">
  <select name=ptasf003 title="Contract Spoke Id" class=Mandatory
   tabindex=24>
  <option> </option>
   %PATWEB89.03.199.003
  </select>
</span>

<span id=contracttype style="display:none">
  <input type="text" name=ptasf001 size=2 maxlength=1 class=Mandatory
   value="%PATWEB89.03.199.001" tabindex=25
   title="Contract Type"
   onblur="ContType(this);">
   <img src="../images/SearchIcon.gif" class=Icon
   onclick="ContTypeAlert();">
</span>

<span id=contractrole style="display:none">
  <input type="text" name=ptasf002 size=2 maxlength=1 class=Mandatory
   value="%PATWEB89.03.199.002" tabindex=26
   title="Contract Role"
   onblur="ContRole(this);">
   <img src="../images/SearchIcon.gif" class=Icon
   onclick="ContRoleAlert();">
</span>

<span id=disasteridnumbertitleSPAN style="display:none">
Disaster Identification #
</span>

<span id=disasteridnumberSPAN style="display:none">
<input type="text" name=dispt002 size=20 maxlength=19
   tabindex=12 title="Disaster Identification Number">
</span>

<span id=disastercodeSPAN style="display:none">
<select name=dispt001 tabindex=12 title="Disaster Code"
         onchange="displayDisasterID();">
         <option></option>
          %PATWEB89.03.995
        </select>
</span>

<span id=disastercodetitleSPAN style="display:none">
Disaster Code
</span>

<span id=warddietcodetitleSPAN style="display:none">
Ward Diet
</span>

<span id=warddietcodeSPAN style="display:none">
  <select name=dietdtyp tabindex=17 title="Ward Diet">
         <option> </option>
          %PATWEB89.03.999.062.5
  </select>
</span>

<span id=dietcommenttitleSPAN style="display:none">
Diet Comment
</span>

<span id=dietcommentfieldSPAN style="display:none">
  <input type="text" name=dietcomm size=40 maxlength=40
   tabindex=17 title="Diet Comment">
</span>

<span id=longline style="display:none"><hr></span>
