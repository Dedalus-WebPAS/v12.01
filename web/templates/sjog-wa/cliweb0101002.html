<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="sjog-wa">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src=../js/cliweb0101.js></script>

<script type="text/javascript">
  function submitAlert(){
    if(document.AddForm.admalert.value=="1"){
       document.AddForm.nextpage.value="6"
    }
    if (document.AddForm.ptalcode!=undefined) {
      for (var i=0; i < document.AddForm.ptalcode.length; i++) {
        if (document.AddForm.ptalcode[i].checked==true) {
          document.AddForm.alert002.value=
          document.AddForm.ptalcode[i].value.substr(2,3);
          if(!checkAlertValid(AddForm)){
             return;
          }
        }
      }
    }
    if (document.AddForm.ptalcode==undefined) {
      if(!checkAlertValid(AddForm)){
         return;
      }
    }
    if(!CheckDateRules()){
       return false;
    } 
    if(validateMandatory(AddForm)) {
      document.AddForm.submit();
    }
  }

function CheckDateRules(){

  var start = new Date(document.AddForm.alert003.value);
  var middle = new Date(document.AddForm.alert008.value);
  var end = new Date(document.AddForm.alert011.value);
  var errorString = ""

  if((start>middle)&&(start!=NaN)&&(middle!=NaN)){
      errorString+="Next Review Date cannot be before Date Activated\n";
  }
  if((start>end)&&(start!="")&&(end!="")){
      errorString+="End Date cannot be before Date Activated\n";
  }
  if((middle>end)&&(middle!="")&&(end!="")){
      errorString+="End Date cannot be before Next Review Date\n";
  }
  
  if(errorString!=""){
     alert("Please fix the following before proceeding:\n"+errorString);
     return false;
  }
  return true;
}

function AlrComToggle(comtindc) {
  if (document.getElementById(comtindc).checked==true) {
    if (document.getElementById(comtindc).value.substr(5,1)==1) {
       document.getElementById('alcommnt').className="Readonly";
       document.getElementById('alcommnt').readOnly=true;
       document.getElementById('alcommnt').value="";
    } else {
       document.getElementById('alcommnt').className="";
       document.getElementById('alcommnt').readOnly=false;
    }
  }
//
  if (document.getElementById(comtindc).value.substr(5,1)==2) {
    if (document.getElementById(comtindc).checked==true) {
      for (var i=0; i < document.AddForm.ptalcode.length; i++) {
        document.AddForm.ptalcode[i].checked=false;
        document.AddForm.ptalcode[i].disabled=true;
      }
      document.getElementById(comtindc).checked=true;
      document.getElementById(comtindc).disabled=false;
    }
    if (document.getElementById(comtindc).checked==false) {
      for (var i=0; i < document.AddForm.ptalcode.length; i++) {
        document.AddForm.ptalcode[i].checked=false;
        document.AddForm.ptalcode[i].disabled=false;
      }
    }
  }
}

function checkComments() {
  if (document.getElementById('alert002').value.substr(11,1)==1) {
     document.getElementById('alcommnt').className="Readonly";
     document.getElementById('alcommnt').readOnly=true;
     document.getElementById('alcommnt').value="";
  } else {
     document.getElementById('alcommnt').className="";
     document.getElementById('alcommnt').readOnly=false;
  }
}

function checkmulticombo() {
  if (document.getElementById('catgindc').value.substr(9,1)==1) {
    allergentext.innerHTML=allergentextSPAN.innerHTML;
    othertext.innerHTML=othertextSPAN.innerHTML;
  }
  if (document.getElementById('catgindc').value.substr(10,1)==1) {
    multicombo.innerHTML=multicomboSPAN.innerHTML;
  } else {
    multicombo.innerHTML=singlalertSPAN.innerHTML;
  }
}

//TSK 0891498
function checkInfectionStatusInd(indicator){
  var val = indicator.value.substring(14,15);
  if(val == 'S'){
    document.getElementById('alert005').className="Mandatory";
  } else {
    document.getElementById('alert005').className="";
  }
}

</script>

%START.OF.PAGE
</HEAD>
<body onload="PageLoad(event);checkmulticombo();">

<span class=DFrameTitleBar>
  <img align="right" alt="Exit" class="MenuIcon" 
   src="../images/ExitIcon.gif" onclick="DFrameExit();">
  Add Alert
</span>

<div id="PageBodySection">

<form name=AddForm method=post action=cliweb01.pbl>
  <input type=hidden name=reportno value="1">
  <input type=hidden name=template value="002">
  <input type=hidden name=updttype value="A">
  <input type=hidden name=urnumber value="%CLIWEB01.01.003">
  <input type=hidden name=admissno value="%CLIWEB01.01.081">
  <input type=hidden name=alert001 value="%CLIWEB01.01.107">
  <input type=hidden name=nextpage value="5">
  <input type=hidden name=admalert value="%CLIWEB01.01.119">
  <input type=hidden name=catgindc id=catgindc value="%CLIWEB01.01.145">

  <table align=center cellspacing=0 cellpadding=1 width=95% border=0>

  <tr><td width=20%>&nbsp;</td>
      <td class=HighLightRed><div id=allergentext></div></td>
      <td>&nbsp;</td>
  </tr>

  <tr>
    <td class=DataLabel>Alert</td>
    <td><div id=multicombo></div></td>
    <td class=DataLabel><div id=othertext></div></td>
  </tr>

<tr><td class=DataLabel>Alert Requested By</td>
    <td colspan=4><input type=text name=alert012 id=alert012 size=10 maxlength=8
        title="Alert Requested By"
        onblur="ValidateHCP(18,12,alert012,d_alert012);">
       <input type=text size=35 name=d_alert012 id=d_alert012
        class=Readonly readonly>
    <img src=../images/SearchIcon.gif class=Icon
     onclick="HCPSearchFrame(alert012,d_alert012,7);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(alert012,d_alert012);">
    </td></tr>

  <tr>
    <td class=DataLabel>Date Activated</td>
    <td>
      <input type=text name=alert003 size=12 maxlength=12 
       class="Mandatory PastDate"
       title="Date Activated">
      <img src=../images/DateTimeStamp.gif class=Icon
       onclick="SetCurrentDateTime(AddForm.alert003,null);">
      <img src=../images/DateLookup.gif class=Icon
       onclick="DateLookupFrame(AddForm.alert003);">
    </td>
  </tr>

  <tr>
    <td class=DataLabel>Next Review Date</td>
   <td>
      <input type=text name=alert008 size=12 maxlength=12
       title="Next Review Date" class="Date">
      <img src=../images/DateTimeStamp.gif class=Icon
       onclick="SetCurrentDateTime(AddForm.alert008,null);">
      <img src=../images/DateLookup.gif class=Icon
       onclick="DateLookupFrame(AddForm.alert008);">
    </td>
  </tr>

  <tr>
    <td class=DataLabel>End Date</td>
    <td>
      <input type=text name=alert011 size=12 maxlength=12 title="End Date"
      class="PastDate">       
      <img src=../images/DateTimeStamp.gif class=Icon
       onclick="SetCurrentDateTime(AddForm.alert011,null);">
      <img src=../images/DateLookup.gif class=Icon
       onclick="DateLookupFrame(AddForm.alert011);">
    </td>
  </tr>

  <tr>
    <td class=DataLabel>%STANDARD.01.017.wn</td>
    <td>
      <select name=alert005 id=alert005 title="%STANDARD.01.017.wn">
        <option></option>
        %CLIWEB01.01.104.2
      </select>
    </td>
  </tr>

  <tr>
    <td class=DataLabel>Site</td>
    <td>
      <input type=text name=alert007 size=20 maxlength=20>
    </td>
  </tr>

  <tr valign=top>
    <td class=DataLabel>Severity Level</td>
    <td>
      <select name=alert006>
        <option value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
      </select>
    </td>
  </tr>

  <tr>
    <td colspan=3 class=DataLabel>Reaction Comment/lab. No</td>
  </tr>

  <tr>
    <td colspan=3 align=center>
    <textarea wrap=hard name=alcommnt id=alcommnt rows=4 cols=70>
     %CLIWEB01.01.111</textarea>
    </td>
  </tr>

  <tr>
    <td colspan=3 align=center>
      <br>
      <input type=button name=formactn value=Add class="button"
       onclick="submitAlert();">
      <input type=button value=Close class="button" onclick="DFrameClose()">
    </td>
  </tr>
</table>
</form>
</div>

<span id=singlalertSPAN style="display:none;">
      <select name=alert002 id=alert002 title="Alert Code" class=Mandatory
        onchange="checkComments();checkInfectionStatusInd(this);">
        <option selected></option>
        %CLIWEB01.01.113  
      </select>
</span>

<span id=multicomboSPAN style="display:none;">
  <input type=hidden name=alert002 value="">
      <div class="CheckBoxComboMandatory" style="height:65;width:250px;">
       %CLIWEB01.01.146.2
      </div>
</span>

<span id=allergentextSPAN style="display:none;">
      Multiple Allergens may be selected by checking all applicable checkboxes
</span>

<span id=othertextSPAN style="display:none;">
      "Other" must be selected by itself and detailed in the comments section.
</span>
