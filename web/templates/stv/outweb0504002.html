<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="stv">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/outweb05.js"></script>
<script type="text/javascript" src="../js/MrtLocations.js"></script>
<script type="text/javascript" src="../js/MrtMultiLocations.js"></script>
<script type="text/javascript">
function ClearLedger() {
  if(isWhitespace(document.AddForm.otmas063.value)) {
          document.AddForm.otmas063.value="";}
}
function init() {
  if(document.AddForm.ibcnmhos.value!="1") {
    document.AddForm.otmas033.className="SelectBig"
  }
  if(document.AddForm.mrcntrak.value!="1") {
    document.AddForm.otmas057.className="";
  }
}
function DisplayMedPrac() {
  i=document.AddForm.otmas006.selectedIndex;
  ind=document.AddForm.otmas006.options[i].value.substring(3,4)
  if (ind=="P") {
    document.getElementById("MedPracHeading").innerHTML=
    document.getElementById("medprachd").innerHTML;
    document.getElementById("MedicalPrac").innerHTML=
    document.getElementById("medpraccd").innerHTML;
    if(AddForm.otmas059.checked==true) {
      AddForm.otmas060.className="Mandatory";
      AddForm.otmas065.className="Mandatory";
    } else {
      AddForm.otmas060.className="";
      AddForm.otmas065.className="";
    }
  } else {
    document.getElementById("MedPracHeading").innerHTML=
    document.getElementById("blanklabel").innerHTML;
    document.getElementById("MedicalPrac").innerHTML="";
    AddForm.otmas060.className="";
  }
}
function ChkBookStrt() {
  if (!checkTime(AddForm.otmas003,AddForm.otmas003.title)) {
    return false;
  }

  var strttime=AddForm.otmas002.value.replace(/:/g,"")
  var fintime=AddForm.otmas003.value.replace(/:/g,"")
  if (isWhitespace(fintime)) return false;

  strttime=trim(strttime);
  fintime=trim(fintime);
  if (strttime>fintime) {
    alert("Booking Finish Time should be greater than Start Time");
    AddForm.otmas003.value = "";
  }
}
function ChkBookSessEnd() {
  if (!checkTime(AddForm.otmas004, AddForm.otmas004.title)) {
    return false;
  }

  var endtime=AddForm.otmas004.value.replace(/:/g,"")
  var fintime=AddForm.otmas003.value.replace(/:/g,"")
  if (isWhitespace(endtime)) return false;

  endtime=trim(endtime);
  fintime=trim(fintime);
  if (fintime>endtime) {
    alert("Booking Finish Time should be less than Session End Time");
    AddForm.otmas004.value = "";
  }
}
function ChkLedger(ledger,account,desc) {
  if (!isWhitespace(ledger.value)) {
    AccountSearchFrame(ledger,account,desc)
  }
  else {
    alert(ledger.title + " field is empty. Please select Ledger first");
    FocusDelay(ledger);
  }
}
function clrAcc(code,desc) {
  code.value="";
  desc.value="";
}
function validateAccount(ledger,account,desc) {
  desc.value="";
  if (isWhitespace(account.value)) return;
  if (isWhitespace(ledger.value)) {
    alert(ledger.title + " field is empty. Please select Ledger first");
    FocusDelay(ledger);
  }
  else {
    acctcode=ledger.value.substr(0,2) + account.value.substr(0,12);
    var serverURL   = "../cgi-bin/patweb80.pbl?reportno=52" +
                    "&valdcode=" + acctcode.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|")
      desc.value=trim(ReturnValue[0])
    }
    else {
      account.value="";
      desc.value="";
      account.select();
      FocusDelay(account);
    }
  }
}
function GetProv() {
  var serverURL = "../cgi-bin/patweb80.pbl?reportno=62" +
        "&valdcode=" + AddForm.otmas065.value.replace(/ /g,"+");

  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {
    ReturnValue=returnValue.return_value.split("|");
    AddForm.otmas060.value=ReturnValue[1];
  }
}
// function written by Prasad
function AddClinic(AddForm)
{
  if(validateMandatory(AddForm))
  {
    AddForm.otmas033.disabled=false;
    if(!SetAutoOpenClinics()) {
    return;
    }
    AddForm.submit();
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);SetMRTLocation(AddForm);DispLedgerCost();
              ClearLedger();UsingAutoOpenClinics();">
   <form name=LinkForm method=get action=outweb05.pbl style="margin:0"
   onsubmit='return validateMandatory(this);'>
   <input type=hidden name=reportno value="">
   <input type=hidden name=template value="">
   <input type=hidden name=updttype value="">
   <input type=hidden name=otcli001 value="%OUTWEB05.04.001">
   <input type=hidden name=otcli006 value="%OUTWEB05.04.012.1">
   </form>
   <form name=AddForm method=post action=outweb05.pbl style="margin:0">
   <input type=hidden name=reportno value="4">
   <input type=hidden name=template value="002">
   <input type=hidden name=updttype value="A">
   <input type=hidden name=otcli001 value="%OUTWEB05.04.001">
   <input type=hidden name=otcli006 value="%OUTWEB05.04.012.1">
   <input type=hidden name=nextpage value="1">
   <input type=hidden name=ibcnmhos id="ibcnmhos"
    value="%STANDARD.01.025.000.043.1.1">
   <input type=hidden name=mrcntrak value="%STANDARD.01.025.097.161.0.1">
   <input type=hidden name=ibcnumci value="%STANDARD.01.025.000.132.0.1">
   <input type=hidden name=redirect
value="outweb05.pbl?reportno=04&template=003&otcli001=%OUTWEB05.04.157&otcli006=%OUTWEB05.04.012.1&otmas001=">
   <input type=hidden name=d_otmas057 value="">
   <input type=hidden name="otcnautc" id="otcnautc"
    value="%STANDARD.01.045.OTCNAUTC">
   <input type=hidden name="otcnautw" id="otcnautw"
    value="%STANDARD.01.045.OTCNAUTW">
   <input type=hidden name="otmas086" id="otmas086" value="">
   <input type=hidden name="d_otmas087" id="d_otmas087" value="">
   <input type=hidden name="otmas088" id="otmas088" value="">
   <input type=hidden name=otcnlcst id=otcnlcst
    value="%STANDARD.01.025.032.149.0.1">

<table cellspacing=0 cellpadding=0 width=100% >
<tr><td align=center class=HeadingCell>%OUTWEB05.04.003 - Master
    </td>
</tr>   
</table>
<br>
<table cellspacing=0 cellpadding=1 width=95% align=center border=0>
<tr><td class=DataLabel width=16%>Day of Week</td>
    <td><select name=otmas001 tabindex=1 class=Mandatory title="Day of Week">
         <option></option>
         <option value="1">Monday</option>
         <option value="2">Tuesday</option>
         <option value="3">Wednesday</option>
         <option value="4">Thursday</option>
         <option value="5">Friday</option>
         <option value="6">Saturday</option>
         <option value="7">Sunday</option>
         </select></td>

    <td class=DataLabel width=16%>Clinic Type</td>
    <td><select name=otmas005 tabindex=2 class=Mandatory title="Clinic Type">
         <option></option>
         %OUTWEB05.04.105.3 
         </select></td></tr>

<tr><td class=DataLabel>Start Time</td>
    <td><input type=text tabindex=3 size=8 name=otmas002 class=Mandatory 
         title="Start Time" onblur="checkTime(this, this.title);">
        <img src=../images/TimeLookup.gif class=Icon
         time=AddForm.otmas002></td>

    <td class=DataLabel>Clinic Indicator</td>
    <td><select name=otmas006 tabindex=4 class=Mandatory 
         title="Clinic Indicator" onchange="DisplayMedPrac()">
         <option></option>
         %OUTWEB05.04.106.2               
         </select></td></tr>

<tr><td class=DataLabel>Date Clinic Opened</td>
    <td><input type=text size=12 tabindex=5 name=otmas052 
         title="Date Clinic Opened" class=Mandatory>
        <img src=../images/DateTimeStamp.gif class=Icon
         date=AddForm.otmas052>
        <img class=Icon src=../images/DateLookup.gif class=Icon
         date=AddForm.otmas052></td>

    <td class=DataLabel>Date Clinic Closed</td>
    <td><input type=text size=12 name=otmas053 tabindex=6 
         title="Date Clinic Closed">
       <img src=../images/DateTimeStamp.gif class=Icon
         date=AddForm.otmas053>
        <img src=../images/DateLookup.gif class=Icon
         date=AddForm.otmas053></td></tr>

<tr><td class=DataLabel>Comments</td>
    <td><input type=text name=otmas009 title="Comments" tabindex=7 
        size=40 maxlength=40></td>
    <td class=DataLabel>Instructions</td>
    <td><input type=text size=40 maxlength=40 tabindex=9
         name=otmas054 title="Instructions"></td></tr>

<tr><td class=DataLabel></td>
    <td><input type=text name=otmas010 size=40 tabindex=8 maxlength=40></td>
    <td class=DataLabel></td>
    <td><input type=text name=otmas055 size=40 tabindex=10 maxlength=40></td></tr>

<tr><td class=DataLabel>Slot Time Allocated</td>
    <td class=DataLabel><input type=text name=otmas011 tabindex=12
       class=Mandatory title="Slot Allocation" size=3  maxlength=3> mins </td>
    <td class=DataLabel></td>
    <td><input type=text size=40 name=otmas056 maxlength=40 tabindex=11
         title="Instructions"></td></tr>

<tr><td class=DataLabel>Bookings Finish Time</td>
    <td><input type=text size=8 name=otmas003 class=Mandatory 
         title="Booking Finish Time" tabindex=12 onblur="ChkBookStrt();">
         <img src=../images/TimeLookup.gif class="Icon"
         onclick="TimeLookupFrame(AddForm.otmas003);"></td>
    <td class=DataLabel><div id=MedPracHeading></div></td>
    <td><div id=MedicalPrac></div></td></tr>

<tr><td class=DataLabel>End of Session Time</td>
    <td><input type=text size=8 name=otmas004 class=Mandatory 
         title="End of Session Time" tabindex=13 onblur="ChkBookSessEnd();">
         <img src=../images/TimeLookup.gif class="Icon"
         onclick="TimeLookupFrame(AddForm.otmas004);"></td>
    <td></td>
    <td></td></tr>

<tr><td class=DataLabel>Location Type</td>
    <td><select name=otmas037 tabindex=14 title="Location Type">
         <option></option>
         %OUTWEB05.04.137.2 
         </select></td></tr>

<tr><td class=DataLabel>Clinic Phone Number</td>
    <td><input type=text name=otmas075  tabindex=10
         title="Clinic Phone Number"
         size=22 maxlength=20></td>
    </tr>

<tr><td class=DataLabel>Clinic Session</td>
    <td><input type=text name=otmas032 tabindex=16 class=Mandatory 
         title="Clinic session"
         onblur="UpCase(this);
         validateCode(25,AddForm.otmas032,AddForm.name_otmas032);"
         size=8 maxlength=6 value="%OUTWEB05.04.001">
        <input type=text name=name_otmas032 class=Mandatory 
         title="Clinic session" tabindex=17 size=20 maxlength=30 value="%OUTWEB05.04.003">
    <img src="../images/SearchIcon.gif" class="Icon"
    onclick="ClinicSessionSearchFrame(AddForm.otmas032,AddForm.name_otmas032);">
    <img src="../images/erase.gif" class="Icon"
     onclick="clrDoc(AddForm.otmas032,AddForm.name_otmas032);">
    </td>
    <td class=DataLabel>Hospital</td>
    <td><select name=otmas033 tabindex=18 class="SelectBig Mandatory" 
         title="Hospital" disabled onchange="SetMRTLocation(AddForm);">
         <option></option>
         %OUTWEB05.04.133.2 
         </select></td></tr>

<tr><td class=DataLabel>Discharge after DNA's </td>
    <td><input type=text size=4 name=otmas024 tabindex=19 maxlength=2>
    </td>
    <td class=DataLabel>Days for Reappointment </td>
    <td><input type=text size=4 name=otmas025 maxlength=2 tabindex=20>
    </td></tr>
<tr><td class=DataLabel>MR Location</td>
    <td><select name=otmas057 class=Mandatory tabindex=21 title="MR Location">
         <option></option>
         </select></td></tr>

<tr><td class=DataLabel>Enter Doctor Code</td>
    <td><input type=checkbox name=otmas008 title="Enter Doctor Code" value=Y>
    </td>
    <td class=DataLabel>Default Doctor</td>
    <td><input type=text name=otmas022 title="Default Doctor" size=6 maxlength=6
         onblur=validateCode(3,AddForm.otmas022,AddForm.name_otmas022);>
    <input type=text name=name_otmas022 title="Default Doctor"
     size=27 maxlength=30 class=Readonly readonly>
    <img src="../images/SearchIcon.gif" class="Icon"
    onclick="DoctorSearchFrame(AddForm.otmas022,AddForm.name_otmas022);">
    <img src="../images/erase.gif" class="Icon"
    onclick="clrDoc(AddForm.otmas022,AddForm.name_otmas022);">
    </td>
</tr>
   
<tr><td class=DataLabel>Registrar's Clinic</td>
    <td><input type=checkbox tabindex=22 name=otmas007 title="Registrar's Clinic" value=Y>
    </td>

    <td class=DataLabel>Suppress Ext. Slot Display </td>
    <td><input type=checkbox name=otmas018 tabindex=23 
         title="Suppress Extended Slot Display" value=Y>
    </td></tr>

<tr><td colspan=4 align=center>
<tr><td class=DataLabel >Active</td>
    <td colspan=1>
       <input type=checkbox name=otmas014 tabindex=24 title="Active" value="0" checked>
    </td>

    <td class=DataLabel>Using Extra Screen When Attending</td>
    <td><input type=checkbox name=otmas021 tabindex=26
         title="Using Extra Screen When Attending" value=Y>
    </td></tr>

<tr><td class=DataLabel>Using Bulk Billing</td>
    <td><input type=checkbox name=otmas059  
         tabindex=27 title="Using Bulk Billing" value="1"
         onclick="DisplayMedPrac();"></td>
    <td class=DataLabel>Provider Number</td>
    <td><input type=text size=11 maxlength=10 name=otmas060  tabindex=28
         value="%OUTWEB05.04.167"
         onblur="CheckProvNo(AddForm.ibcnumci,AddForm.otmas060);"></td>
    </tr>

<tr><td class=DataLable>Default CMBS Item Template</td>
    <td><select name=otmas061  title="CMBS Item Template" tabindex=29>
         <option></option>
         %OUTWEB05.04.168
         </select></td>

    <td><div id=LedgerHeading></div></td>
    <td><div id=LedgerField></div></td></tr>

<tr><td class=DataLabel>Apply CMBS Template</td>
    <td><input type=checkbox name=otmas066 tabindex=31 value="1"></td>
    <td><div id=CostHeading></div></td>
    <td><div id=CostField></div></td></tr>

<tr><td class=DataLabel>Referral Management Department</td>
    <td><select name=otmas068  title="Referral Management Department" tabindex=33
         onchange="CheckAllied(document.AddForm);">
         <option></option>
         %OUTWEB05.04.175
         </select></td>
    <td class=DataLabel>Collect Contact Details</td>
     <td><input type=checkbox name=otmas069 
          onclick="CheckAllied(document.AddForm)"
         tabindex=34 title="Collect Contact Details"
         value=1></td>
    </tr>

<tr><td class=DataLabel>Room Number</td>
    <td><input type=text size=4 maxlength=3 name=otmas062  tabindex=35
                   value="%OUTWEB05.04.169"></td>
    <td class=DataLabel>Collect Carer Details</td>
     <td><input type=checkbox name=otmas070
         tabindex=36 title="Collect Carer Details"
         value=1></td>
    </tr>

<tr><td class=DataLabel>Collect Transport Details</td>
     <td><input type=checkbox name=otmas071
         tabindex=37 title="Collect Transport Details"
         value=1></td>
    <td class=DataLabel>&nbsp;</td>
    <td>&nbsp;</td>
    </tr>

<tr><td class=DataLabel>Last Session Date Opened</td>
    <td class=DataField></td>
    </tr>

<tr><td class=DataLabel><div id="AutoOpenL"></div></td>
    <td><div id="AutoOpenF"></div></td>
    </tr>

<tr><td class=DataLabel><div id="AutoOpenFreqL"></div></td>
    <td><div id="AutoOpenFreqF"></div></td>
    </tr>

<tr><td class=DataLabel><div id="AutoOpenWeekL"></div></td>
    <td><div id="AutoOpenWeekF"></div></td>
    </tr>

<tr><td colspan=4 align=center><br>
    <input type=button value="Add" class="button" tabindex=40 onclick='AddClinic(AddForm);'>    
    <input type=button value="Cancel" class="button" tabindex=41 
     onclick='ScheduleList04("%OUTWEB05.04.001","%OUTWEB05.04.012.1");'>
    </td></tr>
</table>
</form>

<script type="text/javascript">
 var HospID="%STANDARD.01.032";
 for (var i =0 ; i < document.AddForm.otmas033.length; i++) {
  if (document.AddForm.otmas033.options[i].value==HospID.substr(0,3)) {
       document.AddForm.otmas033.selectedIndex=i } };
</script>

<div id="ShowAutoOpenL" style="display:none">
Auto Open Clinic
</div>

<div id="ShowAutoOpenF" style="display:none">
<input type=checkbox name="d_otmas086" id="d_otmas086"
tabindex=116 title="Auto Open Clinic" value=1
onclick="EnableAutoOpenClinicsFields();">
</div>

<div id="ClearAutoOpenF" style="display:none">
<input type=hidden name="otmas087" id="otmas087" value="">
<input type=hidden name="otmas089" id="otmas089" value="">
</div>

<div id="ShowAutoOpenFreqL" style="display:none">
Frequency
</div>
<div id="ShowAutoOpenFreqF" style="display:none">
<select name="otmas087" id="otmas087" class="SelectBig" tabindex=117
 title="Frequency"
 disabled onchange="EnableAutoOpenClinicsFields();">
<option value=" "></option>
<option value="1">Weekly</option>
<option value="2">2 Weekly</option>
<option value="4">4 Weekly</option>
</select>
&nbsp;
Week of Month
&nbsp;
<input type=checkbox name="1_otmas088" id="1_otmas088" disabled
 tabindex=118 title="Auto Open Week of month 1" value=1>

<input type=checkbox name="2_otmas088" id="2_otmas088" disabled
 tabindex=119 title="Auto Open Week of month 2" value=1>

<input type=checkbox name="3_otmas088" id="3_otmas088" disabled
 tabindex=120 title="Auto Open Week of month 3" value=1>

<input type=checkbox name="4_otmas088" id="4_otmas088" disabled
 tabindex=121 title="Auto Open Week of month 4" value=1>

<input type=checkbox name="5_otmas088" id="5_otmas088" disabled
 tabindex=122 title="Auto Open Week of month 5" value=1>
</div>

<div id="ShowAutoOpenWeekL" style="display:none">
No. weeks in advance to open
</div>
<div id="ShowAutoOpenWeekF" style="display:none">
<input type=text name=otmas089 id=otmas089 title="No. weeks in advance to open"
 tabindex=105 size=4 maxlength=3 class="Integer Readonly" readonly
 value="">
</div>

<span id=medprachd style="display:none">
Medical Practice
</span>

<span id=medpraccd style="display:none">
  <select name=otmas065 title="Medical Practice"
   onchange="GetProv()">
  <option> </option>
   %OUTWEB05.04.172.1
  </select>
</span>

<span id=blanklabel style="display:none">&nbsp;</span>


<span id=LedgerHd style="display:none">
    Ledger
</span>

<span id=LedgerFld style="display:none">
        <select name=otmas063  title="Ledger" tabindex=30
         onclick="clrAcc(AddForm.otmas064,AddForm.creddesc);">
         <option></option>
         %OUTWEB05.04.170.1
         </select>
</span>

<span id=LedgerFreeFormat style="display:none">
    <input type=text name=otmas063 size=4 maxlength=2 tabindex=30
     title='Ledger'
     value="%OUTWEB05.04.170.0">
</span>

<span id=CostHd style="display:none">
    Cost Centre
</span>

<span id=CostFld style="display:none">
         <input type=text name=otmas064 title="Cost Centre" tabindex=32
          onblur="validateAccount(AddForm.otmas063,AddForm.otmas064,AddForm.creddesc);"
          value="%OUTWEB05.04.171.0" size=12>
         <input type=text name=creddesc title="Cost Centre" class=ReadOnly
          readonly
          value="%OUTWEB05.04.171.1" size=35 tabindex=-1>
         <img src=../images/SearchIcon.gif class=Icon
       onclick="ChkLedger(AddForm.otmas063,AddForm.otmas064,AddForm.creddesc);">
         <img src="../images/erase.gif" class=Icon
          onclick="clrAcc(AddForm.otmas064,AddForm.creddesc);">
</span>

<span id=CostFreeFormat style="display:none">
    <input type=text name=otmas064 size=14 maxlength=12
     title='Cost Centre' tabindex=32
     value="%OUTWEB05.04.171.0">
</span>

<span id=CostMandFld style="display:none">
    <input type=text name=otmas064 size=14 maxlength=12
     title='Cost Centre' class=Mandatory tabindex=32
     value="%OUTWEB05.04.171.0">
</span>

<span id=LedgerBlank style="display:none">
   <input type=hidden name=otmas063 value="%OUTWEB05.04.170.0">
</span>

<span id=CostBlank style="display:none">
   <input type=hidden name=otmas064 value="%OUTWEB05.04.171.0">
</span>



