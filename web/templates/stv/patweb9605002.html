<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="stv">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/discharge507.js"></script>
<script type="text/javascript" src="../js/patweb9605.js"></script>
<script type="text/javascript">
function discharge() {
   var serverURL = "../cgi-bin/comweb80.pbl?reportno=66" +
                   "&admissno="+pat96pdf.admissno.value.replace(/ /g,"+")
   var returnValue = RSExecute(serverURL);
   if (returnValue.status!=0){
      return false;
   }
  MandatoryOk=validateMandatory(document.pat96pdf)
  if (MandatoryOk) {
    if(!validateMRFD(document.pat96pdf.d_adate,document.pat96pdf.mrfddate)) {
      return;
    }
    SubmitHidden(pat96pdf);
   }
}
function DisplayTrnSrc() {
  var i=document.pat96pdf.dschdest.selectedIndex;
  var ind=document.pat96pdf.dschdest.options[i].value.substring(4,5)
  var ind1=document.pat96pdf.dschdest.options[i].value.substring(3,4)
  var hdp=document.pat96pdf.dschdest.options[i].value.substring(14,15)
  if (ind1!="D" && hdp!="G") { // organ procurement shouldn't clear notif
      document.pat96pdf.dschdety.value="   "
  }
  if(ind1=='D') {
     document.pat96pdf.dschdety.value="H  "
     for (var i =0 ; i < document.pat96pdf.dschdety.length; i++) {
     if (document.pat96pdf.dschdety.options[i].value.substr(0,3)=="H  ") {
         document.pat96pdf.dschdety.selectedIndex=i } };
  }
  if (ind!="1") {
    TranSrcDesc.innerHTML=""
    TranSrcField.innerHTML=transferblank.innerHTML;
    document.pat96pdf.trnsfsrc.value="";
  } else {
    TranSrcDesc.innerHTML="Transfer Destination"
    TranSrcField.innerHTML=transfersrc.innerHTML;
  }
  if (ind1=="Z")
   {
     document.pat96pdf.dschsref.className="Mandatory"
     document.pat96pdf.dschsref.readOnly=false;
   }
   else{
     document.pat96pdf.dschsref.value= "";
     document.pat96pdf.dschsref.className="ReadOnly";
     document.pat96pdf.dschsref.readOnly= true;
   }
  deceasedIndicator = document.pat96pdf.dschdest.value.substr(3,1);
  checkDeceasedINP(deceasedIndicator);
}
function DisplayAutopsy() {
  // Check indicator for deceased
  i=document.pat96pdf.dschstat.selectedIndex
  ind=document.pat96pdf.dschstat.options[i].value.substring(3,4)
  if (ind=="D") {
    document.pat96pdf.dschdind.value="1"
    Autop.innerHTML=autopsyDiv.innerHTML;
  }
  else {
    Autop.innerHTML="";
    document.pat96pdf.dschdind.value="0"}
}
function moveMREC() {
  var msg="Do you want to move Medical Record?";
  if (confirm(msg)) {
    document.pat96pdf.movemrec.value=1;
  } else {
    document.pat96pdf.movemrec.value=0;
  }
  document.pat96pdf.submit();
}
function ShowACAS() {
   if(document.pat96pdf.statevic.value!="3"){   // Only show for victoria
     return;
   }
   var pattern="1246789FEJKM";
   if((pattern.match(document.pat96pdf.acascare.value.substr(14,1))) ||
     (document.pat96pdf.acascare.value.substr(14,2))=="R1" ||
     (document.pat96pdf.acascare.value.substr(14,2))=="R2") {
     if(document.pat96pdf.acasage.value=="1") {
       DisplayACAS1.innerHTML=agedcare1.innerHTML;
       DisplayACAS2.innerHTML=agedcare2.innerHTML;
     }
   } else {
      DisplayACAS1.innerHTML="";
      DisplayACAS2.innerHTML="";
   }
}
function CarerAvailMand() {
  document.pat96pdf.dschcrav.className="";
  cutdate="20140701";
  if (SetDateYYYYMMDD(document.pat96pdf.trandate1.value) < cutdate) {
    var pattern="126789PKFE";
    if ((pattern.match(document.pat96pdf.acascare.value.substr(14,1))) ||
       (document.pat96pdf.acascare.value.substr(14,2))=="10" ||
       (document.pat96pdf.acascare.value.substr(14,2))=="R1" ||
       (document.pat96pdf.acascare.value.substr(14,2))=="R2") {
      document.pat96pdf.dschcrav.className="Mandatory";
      return true;
    }
  }

  cutdate="20150701";
  if (SetDateYYYYMMDD(document.pat96pdf.trandate1.value) < cutdate) {
    var pattern="P689";
    if ((pattern.match(document.pat96pdf.acascare.value.substr(14,1))) ||
       (document.pat96pdf.acascare.value.substr(14,2))=="1 " ||
       (document.pat96pdf.acascare.value.substr(14,2))=="MC") {
      document.pat96pdf.dschcrav.className="Mandatory";
      return true;
    }
  }

  ac = document.pat96pdf.acascare.value;
  dd = document.pat96pdf.dschdest.value;
  var pattern="P1689";
  if((((pattern.match(ac.substr(14,1))) && ((ac.substr(14,2))!="10")) ||
      ((ac.substr(14,2))=="MC")) && (dd.substr(14,1)=="H")) {
      document.pat96pdf.dschcrav.className="Mandatory";
      return true;
  }
  else{
      document.pat96pdf.dschcrav.className="";
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);ShowACAS();CarerAvailMand();
              checkShowDischargeDelay();">
<div id=PageHeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB96.05.003";
PatientVIS="%PATWEB96.05.081";
PatientNAM="%PATWEB96.05.002";
PatientSTA="%PATWEB96.05.086.078";
PatientALT="%PATWEB96.05.084";
PatientSEX="%PATWEB96.05.019";
PatientDOB="%PATWEB96.05.020";
PatientAGE="%PATWEB96.05.021";
PatientLOC="%PATWEB96.05.083";
PatientPRI="%PATWEB96.05.086.066.1";
PatientUNT="%PATWEB96.05.066.0";
DoctorCOD="%PATWEB96.05.082.003";
DoctorNAM="%PATWEB96.05.082.002";
PatientAID="%PATWEB96.05.086.090";
PatientIND="%PATWEB96.05.086.091";
PatientCUR="%PATWEB96.05.086.092";
PatientCLC="%PATWEB96.05.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB96.05.086.094";
PatientCDM="%PATWEB96.05.086.095";
PatientVDH="%PATWEB96.05.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<form onsubmit='return validateMandatory(this)' name=pat96pdf id=pat96pdf
 style="margin:0" %PATWEB96.05.201.001
<input type=hidden name=reportno id=reportno value=6>
<input type=hidden name=urnumber id=urnumber value="%PATWEB96.05.003">
<input type=hidden name=admissno id=admissno value="%PATWEB96.05.101">
<input type=hidden name=movemrec id=movemrec value="0">
<input type=hidden name=redirect id=redirect
 value="%PATWEB96.05.001.patweb98.01.001">
<input type=hidden name=nextpage id=nextpage value="7">
<input type=hidden name=formactn id=formactn value="Discharge">
<input type=hidden name=patsex id=patsex   value="%PATWEB96.05.019">
<input type=hidden name=patage id=patage   value="%PATWEB96.05.021">
<input type=hidden name=acasage id=acasage  value="%PATWEB96.05.223">
<input type=hidden name=acascare id=acascare value="%PATWEB96.05.113.3">
<input type=hidden name=statevic id=statevic value="%PATWEB96.05.224">
<input type="hidden" name="d_adate" id="d_adate" value="%PATWEB96.05.102">

<table  border=0 width=100% cellspacing=0 cellpadding=0>
<tr><td class=HeadingCell align=center colspan=4>
      Patient Discharge Form</td>
</tr>
</table>

<table  border=0 width=100% cellspacing=0 cellpadding=4>
<tr><td class=DataLabel width=18%>Discharge Date </td>
    <td><input type=text size=15 maxlength=12 name=trandate1 id=trandate1 
         title="Discharge Date" value="%PATWEB96.05.219"
         onblur="CarerAvailMand();" class="Mandatory PastDate" >
         <img notab src="../images/DateTimeStamp.gif" class="Icon"
          alt="Current" 
          onclick="SetCurrentDateTime(pat96pdf.trandate1,null);">
         <img notab src="../images/DateLookup.gif" class="Icon"
          alt="Calendar" date="pat96pdf.trandate1">
    </td>

    <td class=DataLabel> Discharge Time</td>  
    <td><input type=text size=8 name=trantime id=trantime  class="Mandatory" 
        title="Discharge Time"  value="%PATWEB96.05.220">
        <img src="../images/DateTimeStamp.gif" class=Icon
        onclick="SetCurrentDateTime(null,pat96pdf.trantime);">
        <img src="../images/TimeLookup.gif" class=Icon
        onclick="TimeLookupFrame(pat96pdf.trantime);"></td></tr>

<tr><td class=DataLabel>Discharge Destination </td>
    <td><select name=dschdest id=dschdest 
         onchange="DisplayTrnSrc();CarerAvailMand();" class=Mandatory  
         title="Discharge Destination">
        <option></option>
        %PATWEB96.05.304.2
        </select></td>
    <td class=DataLabel><div id=TranSrcDesc></div></td>
    <td><div id=TranSrcField></div></td>
</tr>
<tr valign=top><td class=DataLabel>Discharge Consultant</td>
    <td class=DataLabel> 
    <input type=text name=dschadta id=dschadta size=10
        value="%PATWEB96.05.108.003"
        class=Readonly readonly notab>
    <input type=text name=dschname id=dschname size=25
        value="%PATWEB96.05.108.002"
        class=Readonly readonly notab>
   </td> 
   <td class=DataLabel>Death Type</td>
   <td><select name=dschdety id=dschdety>
       <option> </option>
        %PATWEB96.05.517.2
       </select></td>        
</tr>

<tr><td class=DataLabel>Intention to Re-admit</td>
    <td><select name=dschirad id=dschirad title="Intention to readmit"
         class=Mandatory>
        <option> </option>
        %PATWEB96.05.445.2
     </select></td>
     <td class=DataLabel>Mental Health Legal Status</td>
     <td><select name=dschmhls id=dschmhls title="Mental Health Legal Status"
         class=Mandatory>
         <option> </option>
         %PATWEB96.05.489.2
        </select></td>
</tr>
<tr><td class=DataLabel>Separation Referral</td>
    <td>
    <input type=text name=dschsref id=dschsref size=4
     readOnly class=ReadOnly maxlength=4 
    title="Separation Referral"
         onblur='SeparationRef(pat96pdf.dschsref,
                               pat96pdf.patsex.value,
                               pat96pdf.patage);'>
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="SeparationAlert();"></td>
<!--<td class=DataLabel>Reason for Critical Care Transfer</td>
    <td><select name=dschrcct id=dschrcct>
        <option> </option>
        PATWEB96.05.448.2
        </select></td>-->
     <td class=DataLabel id=clredida>Clinically Ready for Discharge Date</td>
     <td id=clredida2><input type=text size=15 maxlength=12 name=mrfddate
         id=mrfddate title="Clinically Ready for Discharge Date"
         value="%PATWEB96.05.247"
         onblur="checkDate(this,'Date');disDelay(this);" class="Date" >
         <img notab src="../images/DateTimeStamp.gif" class=Icon
          alt="Current"
          onclick="SetCurrentDateTime(pat96pdf.mrfddate,null);">
         <img notab src="../images/DateLookup.gif" class=Icon
          alt="Calendar" date="pat96pdf.mrfddate"></td>
     <tr id=rsndisde style="display: none;"><td class=DataLabel>&nbsp;</td>
     <td>&nbsp;</td>
     <td class=DataLabel>Reason for Discharge Delay</td>
     <td><select name=vsxdc014 id=vsxdc014 title="Reason for Discharge Delay">
         <option></option>
         %STANDARD.01.007.z1
         </select></td></tr></span>

</tr>  

<tr valign=top><td class=DataLabel>Carer Availability</td>
    <td><select name=dschcrav id=dschcrav title="Carer Availability">
      <option> </option>
      %PATWEB96.05.447.2
      </select></td>

    <td><div id=DisplayACAS1></div></td> 
    <td><div id=DisplayACAS2></div></td> 
    </tr>

<tr valign=top><td class=DataLabel>Comments</td>
    <td ><input type=text name=dschcom1 id=dschcom1 size=50 maxlength=40><br>
         <input type=text name=dschcom2 id=dschcom2 size=50 maxlength=30></td>
    <td class=DataLabel>Discharge Diagnosis</td>
    <td ><input type=text name=dschdia1 id=dschdia1 size=50 maxlength=50><br>
         <input type=text name=dschdia2 id=dschdia2 size=50 maxlength=50>
    </td>
</tr>

<tr valign=top><td class=DataLabel>%STANDARD.01.017.D5</td>
    <td><select name=dschusr5 id=dschusr5 title="%STANDARD.01.017.D5">
      <option> </option>
      %PATWEB96.05.311.2
      </select></td>
</tr>

<tr valign=top><td class=DataLabel>Clinical Group</td>
  <td >
    <input type=text name=dschclgp id=dschclgp size=20 maxlength=12
     value="%PATWEB96.05.234.0">
  </td>
</tr>

<tr valign=bottom>
    <td colspan=4 width=100% align=center valign=bottom>
     <input type=button value="Discharge" class="button" id='disbutton'
      onclick="tempDisable(this);discharge();">
     <input type=button value="Cancel" class="button" onclick="history.go(-1)">
</td></tr>

</table>
</form>
</div>

<form name=PatientLinks id=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB96.05.003">
<input type=hidden name=admissno value="%PATWEB96.05.081">
<input type=hidden name=MenuType value="%PATWEB96.05.088">
<input type=hidden name=alert001 value="">
</form>
<script type="text/javascript">
   for (var i =0 ; i < document.pat96pdf.trantime.length; i++) {
     if (document.pat96pdf.trantime.options[i].value=="%PATWEB96.05.103") {
         document.pat96pdf.trantime.selectedIndex=i } };

   caretype="%PATWEB96.05.113.3"
   if(caretype.substr(14,1)==5){
      document.pat96pdf.dschmhls.className="Mandatory"
   }
</script>
<script type="text/javascript">
   document.pat96pdf.dschsref.readonly= true;
   document.pat96pdf.dschsref.ClassName= "Readonly";
   for (var i =0 ; i < document.pat96pdf.trantime.length; i++) {
     if (document.pat96pdf.trantime.options[i].value=="%PATWEB96.05.103") {
         document.pat96pdf.trantime.selectedIndex=i } };

   disDelay(document.getElementById('mrfddate'));
   for (var j=0; j < document.getElementById('vsxdc014').length; j++) {
     if (document.getElementById('vsxdc014').options[j].value.substr(0,3)
         =="%PATWEB96.05.255") {
         document.getElementById('vsxdc014').selectedIndex=j;
     }
   }
</script>

<span id=transfersrc style="display:none">
   <input type="text" size=7 maxlength=5 name=trnsfsrc id=trnsfsrc
    class=Mandatory
    title="Transfer Destination"
    onblur="validateTransSrc(pat96pdf.trnsfsrc,
                             pat96pdf.trandate1,
                             pat96pdf.trandesc);">
   <input type=text size=27 name=trandesc id=trandesc notab
    class=Readonly readonly>
   <img src="../images/SearchIcon.gif" class=Icon
    onclick="TransferSourceFrame(pat96pdf.trnsfsrc,pat96pdf.trandesc)">
</span>

<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc id=trnsfsrc>
</span>

<span id=autopsyDiv style="display:none">
<table>
<tr>
<td> Autopsy <input type=checkbox name=dschautp id=dschautp value=1 checked></td>
</tr></table>
</span>

<span id=agedcare1 style="display:none">
    <td class=DataLabel>ACAS Status</td>
</span>

<span id=agedcare2 style="display:none">
    <td><select name=agecaras id=agecaras title="ACAS Status"
        class=Mandatory>
    <option> </option>
     %PATWEB96.05.222.2
     </select></td>
</span>
