<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="stv">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb06.js"></script>
<script type="text/javascript" >
function validateData() {
  if(validateMandatory(AddForm)) {
     bool1=isWhitespace(AddForm.optsm005.value);
     bool2=!isWhitespace(AddForm.optsm006.value); 
     if(bool1&&bool2){
      alert("End Date must be entered with End Time");
      AddForm.optsm005.select();
      return;
     }
     if((!bool1) && (!bool2)){
       alert("End Time must be entered with End Date");
       AddForm.optsm006.focus();
       return;
     }   
    strtDate = AddForm.optsm003;
    strtTime = AddForm.optsm004;
    endDate  = AddForm.optsm005;
    endTime  = AddForm.optsm006;
    if(!ChkDateTime(strtDate,strtTime,endDate,endTime)) {
       alert("Start Date/Time must be before End Date/Time");
       AddForm.optsm003.select();
       return;
     }
     AssignVal();
     document.AddForm.nextpage.value="6"
     document.AddForm.redirect.value="oprweb06.pbl?reportno=1&template=001&"+
                             "uniqueky="+document.AddForm.uniqueky.value +
                             "&teamnumb="+document.AddForm.teamnumb.value;
     AddForm.submit();    
  }
}   
function valfirst() {
  if(document.AddForm.optsm001.value=="")
    alert(" Select StaffType First");
  else return true;
}
function validateNurse() {
  validateCode('17',document.AddForm.optsm002,
                    document.AddForm.stafdesc,
                    document.AddForm.gnm,
                    SetNurseName);
}
function SetNurseName() {
AddForm.stafdesc.value=AddForm.gnm.value.replace(/\s*$/g,"")+
                              " " +
                            AddForm.stafdesc.value.replace(/\s*$/g,"")
}
function SearchCode(flag) {
if(valfirst()) {
   if ((document.AddForm.optsm001.value)==1) {
      if(flag==0)  
      DoctorSearchFrame(document.AddForm.optsm002,document.AddForm.stafdesc); 
      if(flag==1){
        validateCode(3,document.AddForm.optsm002,document.AddForm.stafdesc);
      }
   }
else { 
      if((document.AddForm.optsm001.value)==2) {
        if(flag==0)
        NurseSearchFrame(document.AddForm.optsm002,document.AddForm.stafdesc); 
        if(flag==1) {
        validateNurse(document.AddForm.optsm002,document.AddForm.stafdesc) 
        }
      }
      else {
        if(flag==0)
        HCPSearchFrame(document.AddForm.optsm002,document.AddForm.stafdesc,4);
        if(flag==1) {
        ValidateHCP(18,13,document.AddForm.optsm002,document.AddForm.stafdesc)
        }
      }
    }
  }
}
function StaffType() {
  if (AddForm.optsm001.value=="2") {
    document.all.StaffOption.innerHTML=document.all.NurseType.innerHTML }
  else{
     document.all.StaffOption.innerHTML="";
   }
}
function showLayer(AddForm) {
  if ((document.AddForm.optsm001.value)==1) {
    document.all.StaffTypeOption.innerHTML=document.all.StaffCat1.innerHTML }
  else {
    if ((document.AddForm.optsm001.value)==2) {
       document.all.StaffTypeOption.innerHTML=document.all.StaffCat2.innerHTML }
    else {
      if ((document.AddForm.optsm001.value)==3) { 
       document.all.StaffTypeOption.innerHTML=document.all.StaffCat3.innerHTML }
      } 
   }
  document.AddForm.optsm002.value="";
  document.AddForm.stafdesc.value="";
}
function SubmitMain() {
    parent.UpdateForm.updatety.value="U"
    casekey=parent.UpdateForm.casekeys.value.substr(0,26);
    casekey=casekey.replace(/ /g,"+");
    parent.UpdateForm.redirect.value="oprweb06.pbl?reportno=1&template=1&"+
                                     "casekeys="+casekey+"&teamnumb=";
    parent.UpdateForm.submit();
}
function AssignVal() {
         AddForm.teamnumb.value=parent.UpdateForm.teamnumb.value;
         AddForm.opsrg003.value=parent.UpdateForm.opsrg003.value
         AddForm.opsrg005.value=parent.UpdateForm.opsrg005.value
         AddForm.opsrg006.value=parent.UpdateForm.opsrg006.value
         AddForm.opsrg004.value=parent.UpdateForm.opsrg004.value
         AddForm.opsrg007.value=parent.UpdateForm.opsrg007.value
         AddForm.opsrg008.value=parent.UpdateForm.opsrg008.value
         AddForm.opsrg050.value=parent.UpdateForm.opsrg050.value
         AddForm.opsrg051.value=parent.UpdateForm.opsrg051.value
         AddForm.opsrg052.value=parent.UpdateForm.opsrg052.value
         AddForm.opsrg060.value=parent.UpdateForm.opsrg060.value
         AddForm.opsrg071.value=parent.UpdateForm.opsrg071.value
         AddForm.opdea014.value=parent.UpdateForm.opdea014.value
         AddForm.opdea015.value=parent.UpdateForm.opdea015.value
         AddForm.opdea016.value=parent.UpdateForm.opdea016.value
         AddForm.optsm007.value=parent.UpdateForm.optsm007.value
    }
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);" onsubmit='return validateMandatory(this);'>
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="SubmitMain();">
Staff Members Maintenance
</span>

<form  id=AddForm name=AddForm action="oprweb06.pbl" method=post
 onsubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=002>
<input type=hidden name=updatety value="S">
<input type=hidden name=casekeys value="%OPRWEB06.01.101">
<input type=hidden name=uniqueky value='%OPRWEB06.01.110'>
<input type=hidden name=teamnumb value="%OPRWEB06.01.334">
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value="">
<input type=hidden name=opsrg003>
<input type=hidden name=opsrg004>
<input type=hidden name=opsrg005>
<input type=hidden name=opsrg006>
<input type=hidden name=opsrg007>
<input type=hidden name=opsrg008>
<input type=hidden name=opsrg050>
<input type=hidden name=opsrg051>
<input type=hidden name=opsrg052>
<input type=hidden name=opsrg060>
<input type=hidden name=opsrg071>
<input type=hidden name=opdea014>
<input type=hidden name=opdea015>
<input type=hidden name=opdea016>
<input type=hidden name=optsm007>
<input type=hidden name=gnm>

<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td class=DataLabel width=21%>Staff Type</td>
    <td class=DataField>
    <select id=optsm001 name=optsm001 class=Mandatory title="Staff Type"
      onchange="showLayer(AddForm);StaffType()">
    <option selected ></option>
     %OPRWEB06.01.318.1    
    </select></td></tr>
<tr><td class=DataLabel>Staff Code</td>
    <td><input type=text id=optsm002  name=optsm002 size=6 title="Staff Code" 
class=Mandatory onchange="SearchCode(1);">
    <input type=text id=stafdesc name=stafdesc class=ReadOnly readonly> 
    <img src=../images/SearchIcon.gif class=Icon onclick="SearchCode(0);">
    </td></tr>
<tr><td class=DataLabel>Start Date</td>
    <td class=DataLabel>
    <input type=text size=12 name=optsm003 title="Start Date" class=Mandatory
     value="%OPRWEB06.01.104" id=optsm003>
    <img src=../images/DateLookup.gif class=Icon date=AddForm.optsm003>
    Time <input type=text size=12 name=optsm004 id=optsm004 
      title="Start Time" class=Mandatory value="%OPRWEB06.01.111">
    <img src=../images/DateTimeStamp.gif class=Icon  
     date=AddForm.optsm003 time=AddForm.optsm004 >
    <img src=../images/TimeLookup.gif class=Icon time=AddForm.optsm004>
    </td></tr>
<tr><td class=DataLabel>End Date</td>
    <td class=DataLabel>
    <input type=text size=12 id=optsm005 name=optsm005 title="End Date">
    <img src=../images/DateLookup.gif class=Icon date=AddForm.optsm005>
    Time <input type=text size=12 id=optsm006 name=optsm006 title="End Time">
    <img src=../images/DateTimeStamp.gif class=Icon
     date=AddForm.optsm005  time=AddForm.optsm006>
    <img src=../images/TimeLookup.gif class=Icon time=AddForm.optsm006>
    </td></tr>
</table>
<span id=StaffTypeOption></span>
<span id=StaffOption></span>
<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td class=DataLabel width=21%>Time Out</td>
    <td class=DataField><input type=checkbox id=optsm010 name=optsm010
         title="Time Out" value="1"></td></tr>

<tr><td colspan=2 align=center>
<br><input type=button value="Add" class="button" id="opr06sub" 
    onclick="tempDisable(this);validateData();">
  <input type=button value="Cancel" class="button" onclick="SubmitMain()">
    </td></tr>
</table>
</form>
<span id=NurseType style="display:none">
<table width=95% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel width=21%>Final Instrument Count</td>
    <td class=DataField><input type=checkbox id=optsm009 name=optsm009
         title="Instrument Count" value="1"></td></tr>
</table>
</span>
<span id=StaffCat1 style="display:none">
<table width=95% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel width=21%>Staff Category</td>
    <td class=DataField>
    <select name=optsm008 title="Staff Category" class=Mandatory >
    <option selected></option>
     %OPRWEB06.01.331.2
    </select>
</td></tr>
</table>
</span>
<span id=StaffCat2 style="display:none">
<table width=95% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel width=21%>Staff Category</td>
    <td class=DataField>
    <select name=optsm008 title="Staff Category" class=Mandatory >
    <option selected></option>
     %OPRWEB06.01.332.2
    </select>
</td></tr>
</table>
</span>
<span id=StaffCat3 style="display:none">
<table width=95% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel width=21%>Staff Category</td>
    <td class=DataField>
    <select name=optsm008 title="Staff Category" class=Mandatory >
    <option selected></option>
<!-- %OPRWEB06.01.327.2  -->
<!--          Cat."OF" reject Ind.1 = "R" (Reason for Referral) -->
     %OPRWEB06.01.327.9.1.01.2.R
    </select>
</td></tr>
</table>
</span>
