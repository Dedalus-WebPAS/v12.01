<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="stv">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb06.js"></script>
<script type="text/javascript" >
function validateData() {
  if(validateMandatory(AddForm)) {
     bool1=isWhitespace(AddForm.optsm005.value);
     bool2=!isWhitespace(AddForm.optsm006.value); 
     if(bool1&&bool2){
      alert("End Date must be entered with End Time");
      AddForm.optsm005.select();
      return;
     }
     if((!bool1) && (!bool2)){
       alert("End Time must be entered with End Date");
       AddForm.optsm006.focus();
       return;
     }   
    strtDate = AddForm.optsm003;
    strtTime = AddForm.optsm004;
    endDate  = AddForm.optsm005;
    endTime  = AddForm.optsm006;
    if(!ChkDateTime(strtDate,strtTime,endDate,endTime)) {
       alert("Start Date/Time must be before End Date/Time");
       AddForm.optsm003.select();
       return;
     }
     var uniqkey=AddForm.uniqueky.value;
     uniqkey=uniqkey.replace(/ /g,"+");
     var teamnumb=AddForm.teamnumb.value;
     AddForm.redirect.value="oprweb06.pbl?reportno=12&template=002"+
                            "&uniqueky="+uniqkey+"&teamnumb="+teamnumb;
     AddForm.submit();    
  }
}   
function valfirst() {
  if(document.AddForm.optsm001.value=="")
    alert(" Select StaffType First");
  else return true;
}
function validateNurse() {
  validateCode('17',document.AddForm.optsm002,
                    document.AddForm.stafdesc,
                    document.AddForm.gnm,
                    SetNurseName);
}
function SetNurseName() {
AddForm.stafdesc.value=AddForm.gnm.value.replace(/\s*$/g,"")+
                              " " +
                            AddForm.stafdesc.value.replace(/\s*$/g,"")
}
function SearchCode(flag) {
if(valfirst()) {
   if ((document.AddForm.optsm001.value)==1) {
      if(flag==0)  
      DoctorSearchFrame(document.AddForm.optsm002,document.AddForm.stafdesc); 
      if(flag==1){
        validateCode(3,document.AddForm.optsm002,document.AddForm.stafdesc);
      }
   }
else { 
      if((document.AddForm.optsm001.value)==2) {
        if(flag==0)
        NurseSearchFrame(document.AddForm.optsm002,document.AddForm.stafdesc); 
        if(flag==1) {
        validateNurse(document.AddForm.optsm002,document.AddForm.stafdesc) 
        }
      }
      else {
        if(flag==0)
        HCPSearchFrame(document.AddForm.optsm002,document.AddForm.stafdesc,0);
        if(flag==1) {
        ValidateHCP(18,0,document.AddForm.optsm002,document.AddForm.stafdesc)
        }
      }
    }
  }
}
function StaffType() {
  if (AddForm.optsm001.value=="2") {
    document.all.StaffOption.innerHTML=document.all.NurseType.innerHTML }
  else{
     document.all.StaffOption.innerHTML="";
   }
}
function showLayer(AddForm) {
  if ((document.AddForm.optsm001.value)==1) {
    document.all.StaffTypeOption.innerHTML=document.all.StaffCat1.innerHTML }
  else {
    if ((document.AddForm.optsm001.value)==2) {
       document.all.StaffTypeOption.innerHTML=document.all.StaffCat2.innerHTML }
    else {
      if ((document.AddForm.optsm001.value)==3) { 
       document.all.StaffTypeOption.innerHTML=document.all.StaffCat3.innerHTML }
      } 
   } 
  document.AddForm.optsm002.value="";
  document.AddForm.stafdesc.value="";
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);" onsubmit='return validateMandatory(this);'>
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Day Procedures - Add Staff Member 
</span>

<form  id=AddForm name=AddForm action="oprweb06.pbl" method=post
 onsubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value=12>
<input type=hidden name=template value=003>
<input type=hidden name=updatety value="S">
<input type=hidden name=casekeys value="%OPRWEB06.12.101">
<input type=hidden name=teamnumb value="%OPRWEB06.12.334">
<input type=hidden name=uniqueky value='%OPRWEB06.12.110'>
<input type=hidden name=nextpage value="0">
<input type=hidden name=redirect>
<input type=hidden name=gnm>

<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td class=DataLabel width=21%>Staff Type</td>
    <td class=DataField>
    <select id=optsm001 name=optsm001 class=Mandatory title="Staff Type"
      onchange="showLayer(AddForm);StaffType()">
    <option selected ></option>
     %OPRWEB06.12.318.1    
    </select></td></tr>
<tr><td class=DataLabel>Staff Code</td>
    <td><input type=text  id=optsm002 name=optsm002  size=6 title="Staff Code" 
class=Mandatory onchange="SearchCode(1);">
    <input type=text id=stafdesc name=stafdesc class=ReadOnly readonly> 
    <img src=../images/SearchIcon.gif class=Icon onclick="SearchCode(0);">
    </td></tr>
<tr><td class=DataLabel>Start Date</td>
    <td class=DataLabel>
    <input type=text size=12 name=optsm003 title="Start Date" class=Mandatory
     id=optsm003 value="%OPRWEB06.12.104">
    <img src=../images/DateLookup.gif class=Icon date=AddForm.optsm003>
    Time <input type=text size=12 name=optsm004 
      title="Start Time" class=Mandatory value="%OPRWEB06.12.111">
    <img src=../images/DateTimeStamp.gif class=Icon  
     date=AddForm.optsm003 time=AddForm.optsm004 >
    <img src=../images/TimeLookup.gif class=Icon time=AddForm.optsm004>
    </td></tr>
<tr><td class=DataLabel>End Date</td>
    <td class=DataLabel>
    <input type=text size=12 id=optsm005 name=optsm005 title="End Date">
    <img src=../images/DateLookup.gif class=Icon date=AddForm.optsm005>
    Time <input type=text size=12 id=optsm006 name=optsm006 title="End Time">
    <img src=../images/DateTimeStamp.gif class=Icon
     date=AddForm.optsm005  time=AddForm.optsm006>
    <img src=../images/TimeLookup.gif class=Icon time=AddForm.optsm006>
    </td></tr>
</table>
<span id=StaffTypeOption></span>
<span id=StaffOption></span>
<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td class=DataLabel width=21%>Time Out</td>
    <td class=DataField><input type=checkbox name=optsm010
         title="Time Out" value="1"></td></tr>

<tr><td colspan=2 align=center>
<br><input type=button id="opr06sub" value="Add" class="button" 
    onclick="tempDisable(this);validateData();">
    <input type=button value="Cancel" class="button" 
     onclick="DFrameCloseRefresh();">
    </td></tr>
</table>
</form>
<span id=NurseType style="display:none">
<table width=95% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel width=21%>Final Instrument Count</td>
    <td class=DataField><input type=checkbox name=optsm009
         title="Instrument Count" value="1"></td></tr>
</table>
</span>
<span id=StaffCat1 style="display:none">
<table width=95% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel width=21%>Staff Category</td>
    <td class=DataField>
    <select name=optsm008 title="Staff Category" class=Mandatory >
    <option selected></option>
     %OPRWEB06.12.331.2
    </select>
</td></tr>
</table>
</span>
<span id=StaffCat2 style="display:none">
<table width=95% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel width=21%>Staff Category</td>
    <td class=DataField>
    <select name=optsm008 title="Staff Category" class=Mandatory >
    <option selected></option>
     %OPRWEB06.12.332.2
    </select>
</td></tr>
</table>
</span>
<span id=StaffCat3 style="display:none">
<table width=95% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel width=21%>Staff Category</td>
    <td class=DataField>
    <select name=optsm008 title="Staff Category" class=Mandatory >
    <option selected></option>
<!-- %OPRWEB06.12.327.2  -->
<!--          Cat."OF" reject Ind.1 = "R" (Reason for Referral) -->
     %OPRWEB06.12.327.9.1.01.2.R
    </select>
</td></tr>
</table>
</span>
