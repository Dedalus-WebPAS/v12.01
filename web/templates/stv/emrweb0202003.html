<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="stv">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/EmrMandatory.js"></script>
<script type="text/javascript" src="../js/emrweb0202003.js"></script>
<script type="text/javascript">
function TriageComplete() {
 UpdateForm.AddButton.disabled=true;
 document.UpdateForm.redirect.value="emrweb02.pbl?reportno=2&template=3"

 if (document.getElementById('entalcdt')!= null &&
     document.getElementById('entalcdt').checked == true) {
    document.UpdateForm.redirect.value="emrweb02.pbl?reportno=1&template=701"
    document.UpdateForm.nextpage.value="21";
 }

 SetCurrentDateTimeNoFocus(document.getElementById('emvis080'),
                    document.getElementById('emvis090'));

 if (isWhitespace(document.getElementById('emvis128').value) ||
     isWhitespace(document.getElementById('emvis129').value)) {
   alert("Triage Date and Time Required")
   UpdateForm.AddButton.disabled=false;
   return;
 }
 
 //TSK-0841640
 if ((EMRAlcoholData) &&
     (document.getElementById('emvis067')) &&
      isWhitespace(document.getElementById('emvis067').value )){
      alert(document.getElementById('emvis067').title + " is Required");
      document.UpdateForm.AddButton.disabled=false;
      return;
 }

 if (isWhitespace(document.getElementById('emexp004').value)){
     alert(document.getElementById('emexp004').title + " is Required");
     document.UpdateForm.AddButton.disabled=false;
     return;
 }

 if(!VEMDMandatory()) {
   UpdateForm.AddButton.disabled=false;
   return;
 }

 if (setFormactn()) { 
   UpdateForm.AddButton.disabled=false; 
 } else {
   setTimeout('UpdateForm.AddButton.disabled=false;',2000);
 }
}

function Validateprecom001() {
  var formatedtext=formateText(UpdateForm.prcom001,UpdateForm.prcom001.cols);

  UpdateForm.prcom001.value = formatedtext;

  if (formatedtext.split(/[\r?\n]/).length > 6) {
    alert("Presenting Complaint Comments - Max 6 lines." +
          "\nPlease remove extra line(s) to continue.");
    FocusDelay(document.UpdateForm.prcom001);
    return;
  }
  else if (formatedtext.replace(/\r?\n/gm,"").length > 300) {
    alert("Presenting Complaint Comments - Max 300 characters." +
          "\nPlease remove the extra character(s) to continue.");
    FocusDelay(document.UpdateForm.prcom001);
    return;
  }
}
function onblurSpclChar(el) {
  el.value=el.value.replace(/@/g,'');
  el.value=el.value.replace(/\*/g,'');
  el.value=el.value.replace(/\//g,'');
  el.value=el.value.replace(/:/g,'');
  el.value=el.value.replace(/\\/g,'');
  el.value=el.value.replace(/\$/g,'');
  el.value=el.value.replace(/\%/g,'');
  el.value=el.value.replace(/&/g,'');
  el.value=el.value.replace(/#/g,'');
}
function disableFormBeforeTriagedBy() {

  DisableForm(document.getElementById('UpdateForm'));
  document.getElementById('emvis128').className='ReadOnly';
  document.getElementById('emvis128').value='';
  document.getElementById('emvis129').className='ReadOnly';
  document.getElementById('emvis129').value='';
  document.getElementById('emvis060').className='SelectBig ReadOnly';
  document.getElementById('prcom001').className='ReadOnly';

  document.getElementById('emvis127').disabled=false;
  document.getElementById('dummy1').disabled=false;
  document.getElementById('emvis067').className='ReadOnly';
  document.getElementById('emvis067').value='';
  document.getElementById('entalcdt').checked=false;

}
function enableFormBeforeTriagedBy() {
  document.getElementById('emvis128').className='Mandatory';
  document.getElementById('emvis129').className='Mandatory';
  document.getElementById('emvis060').className='SelectBig Mandatory';
  document.getElementById('prcom001').className='';

  if (EMRAlcoholData) {
       document.getElementById('emvis067').className='Mandatory';
  }

  var form = document.getElementById("UpdateForm");
  var elements = form.elements;
  for (var i = 0, len = elements.length; i < len; ++i) {
      elements[i].disabled = false;
  }

  SetCurrentDateTime(document.getElementById('emvis128'),
                    document.getElementById('emvis129'));

}
function SetNurseName() {
UpdateForm.dummy1.value=UpdateForm.gnm.value.replace(/\s*$/g,"")+
                              " " +
                            UpdateForm.dummy1.value.replace(/\s*$/g,"")
  enableFormBeforeTriagedBy();
}
function validateEMRAlcoholData() {
  if (EMRAlcoholData) {
    alcoholtitleDIV.style.display="";    
    alcoholfieldDIV.style.display="";
    alcoholenterDIV.style.display="";
  }
}
function enableEDN() {
  if (document.UpdateForm.emvis067.value.substr(3,1)=="Y") {
    document.getElementById('entalcdt').checked=true;  //TSK-0841640
    document.getElementById('entalcdt').disabled=false;
  } else {
   document.getElementById('entalcdt').checked=false;
   document.getElementById('entalcdt').disabled=true;
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);
              validateEMRAlcoholData();
              disableFormBeforeTriagedBy();refreshTop();VEMDFields();">
<span class=DFrameTitleBar>
Emergency Triage
</span>
<div id=PageBodySection style="overflow: auto;">
<form name=UpdateForm id=UpdateForm  action="emrweb02.pbl" method=post>
  <input type=hidden name=reportno value="02">
  <input type=hidden name=template value="001">
  <input type=hidden name=formactn>
  <input type=hidden name=updttype>
  <input type=hidden name=updateky value="">
  <input type=hidden name=nextpage value="7">
  <input type=hidden name=returnfm value=1>
  <input type=hidden name=redirect>
  <input type=hidden name=deceased>
  <input type=hidden name=selsex>
  <input type=hidden name=gname>
  <input type=hidden name=sname>
  <input type=hidden name=dummyadm>
  <input type=hidden name=dummy>
  <input type=hidden name=dummsrch value="1">
  <input type=hidden name=fpatname>
  <input type=hidden name=urnumber>
  <input type=hidden name=emvis004>
  <input type=hidden name=emvis005>
  <input type=hidden name=emvis135>
  <input type=hidden name=emvis136>
  <input type=hidden name=emvis137>
  <input type=hidden name=emvis138>
  <input type=hidden name=patsname>
  <input type=hidden name=patgname>
  <input type=hidden name=pfgname>
  <input type=hidden name=pfsname>
  <input type=hidden name=emexp001 value="">
  <input type=hidden name=emvis080 id=emvis080>
  <input type=hidden name=emvis090 id=emvis090> 
  <input type=hidden name="currdate" id="currdate" value="%STANDARD.01.013">
  <input type=hidden name="ptcnhdps" id="ptcnhdps" 
   value="%STANDARD.01.025.080.250.1.1">
  <input type=hidden name=ptcnnmpr value="%STANDARD.01.025.128.226.1.1">

<table align=center width=95% border=0 cellspacing=0 cellpadding=1>
<tr><td>Triaged By </td>
    <td><input type="text" name=emvis127 id=emvis127 
         tabindex=1 size=6 class=Mandatory 
     onblur="UpCase(this);
             if (isWhitespace(document.getElementById('emvis127').value)) {
               disableFormBeforeTriagedBy();
             }
             validateNurse(UpdateForm.emvis127,UpdateForm.dummy1);
             document.getElementById('entalcdt').disabled=true;" 
             title="Triage Nurse">
    <input type=hidden name=gnm>
    <input type="text" name=dummy1 id=dummy1 size=20 class=Readonly readonly>
    <img src=../images/SearchIcon.gif class=Icon
    onclick='NurseSearchFrame(UpdateForm.emvis127,UpdateForm.dummy1);'></td>
    <td class=DataLabel>U/R
        <input type="text" size=10 maxlength=8 name=emvis118 tabindex=4
        onblur="justifyRight(this);PatientReturnAU();">
        <img src=../images/SearchIcon.gif class=Icon onclick="PatientSearchAU();">
    <td class=DataLabel>Surname</td>
    <td><input type=text size=25 max=25  name=emvis111 tabindex=4 
         onblur="UpCase(this);TextBlurHandler(this);onblurSpclChar(this);"></td>
    <td class=DataLabel>Given Name</td>
    <td><input type=text size=25 max=25  name=emvis112 tabindex=5
         onblur="UpCase(this);TextBlurHandler(this);onblurSpclChar(this);"></td></tr>

<tr id=PrefNamesBoth style="display:none">
    <td>&nbsp;</td><td>&nbsp;</td>
    <td>&nbsp;</td>
    <td class=DataLabel>Preferred Surname</td>
    <td><input type=text size=20 maxlength=20 name=pmpxi82b id=pmpxi82b
         title="Preferred Surname" tabindex=3 class=Readonly></td>
    <td class=DataLabel>Preferred Given Name</td>
    <td><input type=text size=25 maxlength=25 name=pmpxi83b id=pmpxi83b
         title="Preferred Given Name" tabindex=3 class=Readonly></td>
</tr>

<tr id=PrefNamesGiven style="display:none">
    <td>&nbsp;</td><td>&nbsp;</td>
    <td>&nbsp;</td><td>&nbsp;</td>
    <td>&nbsp;</td>
    <td class=DataLabel>Preferred Given Name</td>
    <td><input type=text size=25 maxlength=25 name=pmpxi83g id=pmpxi83g
         title="Preferred Given Name" tabindex=3 class=Readonly></td>
</tr>

<tr id=PrefNamesSurname style="display:none">
    <td>&nbsp;</td><td>&nbsp;</td>
    <td>&nbsp;</td>
    <td class=DataLabel>Preferred Surname</td>
    <td><input type=text size=20 maxlength=20 name=pmpxi82s id=pmpxi82s
         title="Preferred Surname" tabindex=3 class=Readonly></td>
    <td>&nbsp;</td><td>&nbsp;</td>
</tr>

<tr><td class=DataLabel>Triage Date and Time</td>
   <td><input type="text" name=emvis128 id=emvis128 size="12" tabindex=6
   class="Mandatory BackDate" title="Triage Date" 
   onblur="checkDate(this,'Date');"
   value="">
   <img notab src=../images/DateLookup.gif class=Icon
   onclick="DateLookupFrame(UpdateForm.emvis128);">
   <input type="text" name=emvis129 id=emvis129 size="8" tabindex=6
   class='Mandatory Time' title="Triage Time" 
   onblur="checkTime(this,'Triage Time');"
   value="">
   <img notab src=../images/DateTimeStamp.gif class=Icon
   onclick="SetCurrentDateTime(UpdateForm.emvis128,UpdateForm.emvis129);">
   <img notab src=../images/TimeLookup.gif class=Icon
   onclick="TimeLookupFrame(UpdateForm.emvis129);"></td>
    <td></td>
    <td class=DataLabel>%STANDARD.01.017.G </td>
    <td><select name=emexp004 id=emexp004 class="SelectSml Mandatory"
         tabindex=6 title="Patient's Sex">
        <option></option>
            %EMRWEB02.02.086.099.061.9.1.19.3.H
        </select></td>
    <td class=DataLabel>Date of Birth </td>
    <td><input type="text" size=12 max=11 name=emexp005  
         title="Date of Birth" class="Past Date" tabindex=7>
        <img src=../images/DateLookup.gif class=Icon 
         date=document.UpdateForm.emexp005>
        </td></tr>

<tr valign=top><td class=DataLabel width=15%>Presenting Complaint </td>
    <td>
    <input type=hidden name=emrviscat value="el">
    <input type="text" size=10 tabindex=11 
      onKeyUp='UpCase(this);getPresentCom(this,UpdateForm.emvis060,
               UpdateForm.emrviscat);'
      onBlur='DisplayDiv()'>
    <select name=emvis060 id=emvis060 title="Presenting Complaint"
     class="SelectBig Mandatory" onchange="DisplayDiv();">
    </select></td>
    <td colspan=4>
      <textarea type="text" name=prcom001 id=prcom001 wrap=hard tabindex=12
       cols=50 rows=6 style="overflow-y:hidden"
       title="Presenting Complaint Comments"
       onkeydown="ValidateKeyInput(this);"
       onblur="TextareaBlurHandler(this);ValidateTextLimits(this);">
      </textarea>
    </td></tr>
</table>

<div id=Triage></div>

<table align=center width=95% align=center border=0 cellspacing=0 cellpadding=1>
<tr><td class=DataLabel width=15%>Location</td>
    <td width=24%><input type="text" name=emvis006 tabindex=13 size=5
     onblur="validateLocation(UpdateForm.emvis006,UpdateForm.name_emvis006);">
    <input type=text name=name_emvis006 readonly class=Readonly>
    </td>
    <td class=DataLabel>Number of Labels</td>
    <td width=30%>
        <input type=hidden name=labeltyp value="LABELEMR01">
        <select name=nolabels width=50%>
        <option></option>
        <option value=" 1">1</option>
        <option value=" 2">2</option>
        <option value=" 3">3</option>
        <option value=" 4">4</option>
        <option value=" 5">5</option>
        <option value=" 10">10</option>
        <option value=" 20">20</option>
        <option value=" 30">30</option>
        <option value=" 40">40</option>
        <option value=" 50">50</option>
        <option value=" 60">60</option>
        <option value=" 70">70</option>
        <option value=" 80">80</option>
        <option value=" 90">90</option>
        <option value=" 99">99</option>
        </select>
    Printer
        <select name=lblprint colspan=2>
        %EMRWEB02.02.145.EMRWEB03.01
        </select>
        </td></tr>

<tr><td width=15%>Triage Category</td>
   <td><table border=0 cellspacing=0>
   <tr>
   <td class=Triage1><i>1</i>
   <input type="radio" name=emvis003 value=1 tabindex=20 title="Triage Category"
   onclick="CheckMan();"></td>
   <td class=Triage2><i>2</i><input type=radio name=emvis003 value=2
   onclick="unCheck();"></td>
   <td class=Triage3><i>3</i><input type=radio name=emvis003 value=3
   onclick="unCheck();"></td>
   <td class=Triage4><i>4</i><input type=radio name=emvis003 value=4
   onclick="unCheck();"></td>
   <td class=Triage5><i>5</i><input type=radio name=emvis003 value=5
   onclick="unCheck();"></td>
   </tr></table></td>
    <td>
        <div id=alcoholtitleDIV style="display:none;">
        %STANDARD.01.035.es 
        </div></td>
        <td>
        <table width=100% border=0 cellspacing=0><tr><td width=40%>
        <div id=alcoholfieldDIV style="display:none;">
        <select name=emvis067 id=emvis067 title="%STANDARD.01.035.es" 
         class="SelectMed Mandatory" tabindex=23 
         onchange="enableEDN();">
        <option></option>
        %STANDARD.01.007.es 
        </select> 
        </div>
        </td>
        <td>
        <div id=alcoholenterDIV style="display:none;">
        Enter Details Now
        <input type=checkbox name=entalcdt id=entalcdt value="1" disabled> 
        </div>
        </td>
        </tr>
        </table>
    </td>
    <td class=DataLabel>Research</td>
    <td>
    <input type=hidden name=name_emvis069>
    <select name=emvis069 tabindex=23 title="Research" class="SelectBig">
        <option></option>
        %EMRWEB02.02.229.2
        </select></td></tr>

<tr><td class="DataLabel">
    <div id="servicename" style="display: none">%STANDARD.01.035.YW</div></td>
    <td class="DataField">
       <div id="servicefield" style="display: none">
       <select name=emvis177 id="emvis177" tabindex=24 
        title="%STANDARD.01.035.YW" class="SelectBig"
        onchange="VEMDPatientLoc();">
       <option></option>
        %EMRWEB02.02.296.4
        </select>
        </div></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td></tr>

<tr><td class="DataLabel">
    <div id="locationname" style="display: none">%STANDARD.01.035.YX</div></td>
    <td class="DataField">
       <div id="locationfield" style="display: none">
       <select name=emvis178 id="emvis178" tabindex=25 
        title="%STANDARD.01.035.YX" class="SelectBig"
        onchange="VEMDPatientSource();">
       <option></option>
        %EMRWEB02.02.297.4
        </select>
        </div></td>
    <td><div id="sourcename" style="display: none">Source</div></td>
    <td><div id="sourcefield" style="display: none">
        <input type=text size=6 maxlength=6 name=trnsfsrc id="trnsfsrc"
         title="Source" value="" tabindex=26 class=""
       onchange="validateCode(9,UpdateForm.trnsfsrc,UpdateForm.name_trnsfsrc);">
        <input type=text size=30 name=name_trnsfsrc readonly tabindex=-1
         id="name_trnsfsrc" class="readonly" value="">
        <img src=../images/SearchIcon.gif class=Icon tabindex=27
         onclick="TransferSourceFrame(UpdateForm.trnsfsrc,
                  UpdateForm.name_trnsfsrc);">
        </div>
    </td>
    <td></td>
    <td></td></tr>

<tr><td colspan=6 align=center>
    <input type=button value="Add" class="button" tabindex=50 name="AddButton"
     onclick="TriageComplete();">
    <input type=reset value="Cancel" class="button" tabindex=51>
    </td></tr>
</table>
</form>
</div>

<span id=EmergencyProc style="display:none;">
<table align=center cellspacing=1 cellpadding=0 border=0 width=95%>
<tr><td class=DataLabel width=15%>Place Where Injury Occurred</td>
    <td><select name="emvis021" class=SelectBig tabindex=15
         title="Place Where Injury Occurred">
    <option></option>
    %EMRWEB02.02.121.2
     </select></td>
    <td class=DataLabel>Activity When Injured</td>
    <td><select name="injur006" class=SelectBig title="Activity When Injured"
         tabindex=16>
    <option></option>
      %EMRWEB02.02.183.2
       </select></td>
    <td class=DataLabel> Injury Cause</td>
    <td><select name="injur004" class=SelectBig title="Injury Cause" 
         tabindex=17>
     <option></option>
     %EMRWEB02.02.181.2
     </select>
     </td></tr>

<tr valign=top><td class=DataLabel> Human Intent</td>
    <td><select name="injur005" class=SelectBig title="Human Intent"
         tabindex=18>
    <option></option>
     %EMRWEB02.02.182.2
      </select></td>
    <td class=DataLabel>
    Desc. of Injury Event</td>
    <td colspan=3><input type="text" name="injur002" maxlength="50" size="40"
         title="Description of Injury Event" value="" tabindex=19>
    <input type="text" name="injur003" maxlength="50" size="40" value=""
     tabindex=19></td></tr>
</table>
</span>
