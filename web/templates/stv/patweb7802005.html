<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="stv">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/patweb7802.js"></script>
<script type="text/javascript">
function UpdateConsDetails() {
  if (!validateMandatory(UpdateForm))
    return;

  var oldDoct = trim(document.UpdateForm.origdoct.value);
  var oldRefd = trim(document.UpdateForm.origrefd.value);
  var newDoct = trim(document.UpdateForm.ptcrc001.value);
  var newRefd = trim(document.UpdateForm.ptcrc002.value);

  // Check if still the same consultatnts combination
  if (oldDoct == newDoct && oldRefd == newRefd) {    // Same combination
    document.UpdateForm.updttype.value = "U";
    EnableSpec();
    document.UpdateForm.submit();
  }
  else {                                             // Different combination
    if (!chkCombination()) {                           // Invalid combination
      alert("Combination Already Exists");
      document.UpdateForm.ptcrc001.focus();
      return;
    }
    else {                                           // Valid combination
      document.UpdateForm.updttype.value = "S";
      EnableSpec();
      document.UpdateForm.submit();
    }
  }
}

function chkDelete() {
  var oldDoct = trim(document.UpdateForm.origdoct.value);
  var oldRefd = trim(document.UpdateForm.origrefd.value);
  var oldDate = document.UpdateForm.origdate.value;
  var newDoct = trim(document.UpdateForm.ptcrc001.value);
  var newRefd = trim(document.UpdateForm.ptcrc002.value);
  var newDate = document.UpdateForm.ptcrc005.value;

  // Allow delete only when all of the Index components are unchanged
  if (oldDoct == newDoct && oldRefd == newRefd && oldDate == newDate) 
    document.UpdateForm.deleteButton.disabled = false;
  else 
    document.UpdateForm.deleteButton.disabled = true;
}

</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);
              setFocus();
              validateCode(40,UpdateForm.ptcrc007,UpdateForm.n_ptcrc007);">
<span class=DFrameTitleBar id=DFrameHeading>
<img align="right" alt="Exit" class="MenuIcon" 
 src="../images/ExitIcon.gif" onclick="DFrameExitRefresh();">
 Update/Delete Consultation                     
</span>
<div id=PageHeadingSection>
<form name=UpdateForm action=patweb78.pbl method=post style="margin:0">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=005>
<input type=hidden name=urnumber value="%PATWEB78.02.003">
<input type=hidden name=admissno value="%PATWEB78.02.081">
<input type=hidden name=updttype value="">
<input type=hidden name=strtdate value="%PATWEB78.02.211">
<input type=hidden name=stopdate value="%PATWEB78.02.207">
<input type=hidden name=ptcrc003 value="%PATWEB78.02.210">
<input type=hidden name=origdoct value="%PATWEB78.02.202.001">
<input type=hidden name=origrefd value="%PATWEB78.02.203.001">
<input type=hidden name=origdate value="%PATWEB78.02.208">
<input type=hidden name=dispspec id=dispspec value="%PATWEB78.02.214">
<input type=hidden name=CATEG_AC value="AC">
 
<table width=90% border=0 cellpadding=1 cellspacing=0 align=center>
  <tr><td class=DataLabel>Referring Consultant
      <td class=DataField>
        <input type=text name=ptcrc001 size=6 maxlength=6 class=Readonly
         title='Referring Consultant' value="%PATWEB78.02.202.001" readonly
         onblur="UpCase(this);ValidateHCP(18,0,ptcrc001,name_ptcrc001);
                 chkDelete();">
        <input notab type=text name=name_ptcrc001 size=22 maxlength=30
         readonly class=Readonly value="%PATWEB78.02.202.081"></td></tr>
  <tr><td class=DataLabel>Referred Consultant
      <td class=DataField>
        <input type=text name=ptcrc002 size=6 maxlength=6 class=Readonly
         title='Referred Consultant' value="%PATWEB78.02.203.001" readonly>
         
        <input notab type=text name=name_ptcrc002 size=22 maxlength=30
         readonly class=Readonly value="%PATWEB78.02.203.081"></td></tr>

  <tr><td class=DataLabel><span id=SpecialityLbl></span></td>
      <td class=DataField><span id=SpecialityVal></span></td></tr>

  <tr><td class=DataLabel>Comments
      <td class=DataField>
        <input type=text name=ptcrc004 size=40 maxlength=40
         value="%PATWEB78.02.204" readonly class=Readonly>
      </td></tr>

</table>
<br>
</div>
<div id=PageBodySection>
<table width=90% border=0 cellpadding=0 cellspacing=0 align=center>
<tr><td class=DataLabel>Date</td>
    <td class=DataField>
      <input type=text size=11 maxlength=12 name=ptcrc005 title="Date Seen"
       value="%PATWEB78.02.208" class=Mandatory 
       onblur="valDateUpd(this,document.UpdateForm.origdate);chkDelete();">
      <img notab src="../images/DateTimeStamp.gif" class=Icon 
       onclick="SetCurrentDateTime(UpdateForm.ptcrc005,null);">
      <img notab src="../images/DateLookup.gif" class=Icon
       onclick="DateLookupFrame(UpdateForm.ptcrc005);"></td>       
    </tr><tr>
    <td class=DataLabel>Time Spent</td>
    <td class=DataField>
      <input type=text size=8 name=ptcrc006 min=0.01 max=999.99
       title="Hours" value="%PATWEB78.02.209" class=Mandatory
       onblur="this.value=replaceColon(this.value);
               if (!isWhitespace(this.value) && checkNumber(this)){
                 this.value=parseFloat(this.value).toFixed(2);
                 this.value=pad(this.value,5);
                 if (!validateHoursandMins(this.value)) {
                   this.focus();
                 }
               }">&nbsp;HH:MM&nbsp;
    </td>
    </tr>
    <tr>
    <td class=DataLabel>Service Code</td>
    <td><input type=text size=10 maxlength=9 name=ptcrc007 
         value="%PATWEB78.02.213" onblur="UpCase(this);
           validateCode(40,UpdateForm.ptcrc007,UpdateForm.n_ptcrc007);">
         <input type=text size=30 notab readonly name=n_ptcrc007 class=Readonly
          value="%PATWEB78.02.214">
         <img src='../images/SearchIcon.gif' class=Icon  
          onclick="DefMiscChargeSearchFrame(UpdateForm.ptcrc007,
                                            UpdateForm.n_ptcrc007);">
         <img src='../images/erase.gif' class=Icon 
          onclick="clrDoc(UpdateForm.ptcrc007,UpdateForm.n_ptcrc007);">
          <td></tr>
</table>
</div>
<div id=ButtonSection>
<table width=90% border=0 align=center>
<tr><td><hr></td></tr>
<tr><td align=center>
    <input type=button value="Update" class=button id=btnUpdate
     onclick='tempDisable(this);UpdateConsDetails()'>
    <input type=button value="Delete" class=button name=deleteButton
     id=btnDelete  
     onclick='tempDisable(this);EnableSpec();setFormactn("D")'>
    <input type=button value="Cancel" class="button" 
     onclick='DFrameCloseRefresh()'>
</td></tr>
</table>
</div>
</form>

<span id="spSpecLbl" style="display:none">Speciality</span>
<span id="spSpecVal" style="display:none">
  <select name=ptcrc008 title="Speciality" >
    <option> </option>
    %PATWEB78.02.215.2
  </select>
</span>

<script type="text/javascript">
  PageBodySection.style.height=document.body.clientHeight - 
                             PageHeadingSection.clientHeight; 

  var hDispSpec = document.getElementById('dispspec');
  if (hDispSpec.value == '1') {
    var spLbl = document.getElementById('spSpecLbl');
    var spVal = document.getElementById('spSpecVal');
    var SpecLbl = document.getElementById('SpecialityLbl');
    var SpecVal = document.getElementById('SpecialityVal');

    if (spLbl && spVal && SpecLbl && SpecVal) {
      SpecLbl.innerHTML = spLbl.innerHTML;
      SpecVal.innerHTML = spVal.innerHTML;
      spVal.innerHTML = "";
    }
  }

</script>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=2>
<input type=hidden name=template value=005>
<input type=hidden name=urnumber value="%PATWEB78.02.003">
<input type=hidden name=admissno value="%PATWEB78.02.081">
<input type=hidden name=MenuType value="%PATWEB78.02.088">
</form>
