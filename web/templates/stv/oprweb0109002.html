<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="stv">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function RemoveQuote(Field) {
  Field.value=Field.value.replace(/\"/g,"");
}
function changeOperation(theForm) {
  for (var i = 0; i < theForm.operpref.length; i++) {
    if (theForm.operpref.options[i].selected == true) {
      theForm.elements["operdes1"].value=theForm.operpref.options[i].text
    }
  }
}
function changeAdmitDate(theForm) {
  for (var i = 0; i < theForm.patadmdt.length; i++) {
     if (theForm.patadmdt.options[i].selected == true) {
       theForm.elements["operdes3"].value=
                                "Admit:"+theForm.patadmdt.options[i].text
     }
  }
}
function Check() {

  if (!isWhitespace(document.AddForm.requestn.value)) {
    var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=43" +
                      "&valdcode=" + 
                       document.AddForm.requestn.value.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {

      if (!isWhitespace(document.AddForm.nextlink.value)) {
        location.href=document.AddForm.nextlink.value;
      } else {
        window.history.go(-1);
      }

      return;
    }
  }

  if (AddForm.deceased.value=="Yes") {
    var i=AddForm.bkrec028.selectedIndex
    if (AddForm.bkrec028.options[i].value.substr(28,1)!="D") {
      alert("Patient is Deceased.\n\n" +
            "Please correct care type to continue with booking");
      return;                 
    }
  }
  if (!validateMandatory(AddForm)) {
    return;
  }
  AddForm.bkrec006.disabled=false
  AddForm.bkrec007.disabled=false
  AddForm.patadmdt.disabled=false
  AddForm.bkrec005.disabled=false
//
  if (!CheckBookDate()) {
    return;
  }
//
  if (document.AddForm.opdausr1.disabled!=true) {
    document.AddForm.operusr1.value=document.AddForm.opdausr1.value.substr(0,3);
  }
//
  var timecalc = parseInt(AddForm.operexpd.value) +
                 parseInt(AddForm.sesendtm.value) +
                 parseInt(AddForm.sesprptm.value)
  if (timecalc > AddForm.sesdurtm.value) {
    if (confirm("Session will be Overbooked, Ok to Continue")) {
      formSubmit();
    } else {
      document.CancelBook.submit();
    }
  } else {
      formSubmit();
  }
}
function chkDOL() {
  if (!isWhitespace(AddForm.listdate.value)) {
    if (!ChkDateTime(AddForm.listdate,null,AddForm.patadmdt,null)) {
      alert("Confirmed admission date cannot be before Date on List");
    }
  }
}
function formSubmit() {
  p=document.AddForm
  validateSuspension(p.urnumber,p.opdadate,p.datefrom,p.dateto);
  if (p.datefrom.value!='0'){
    ans=confirm("Warning : Patient has a Suspension record for period \n" +
                "\t" + p.datefrom.value + " - " + p.dateto.value);
    if (ans!=true) {
      return;
    }
  }
  validateWLKeySuspension(p.wattrkey,p.patadmdt,p.datefromwl,p.datetowl);
  if (p.datefromwl.value!='0'){
    alert("Error: Patient has a Suspension record for period \n" +
          "\t" + p.datefromwl.value + " - " + p.datetowl.value);
    return;
  }
  if (!isWhitespace(AddForm.listdate.value)) {
    if (!ChkDateTime(AddForm.listdate,null,AddForm.patadmdt,null)) {
      alert("Confirmed admission date cannot be before Date on List");
      return; 
    }
  }
  if (!isWhitespace(AddForm.listdate.value)) {
    if (AddForm.ptcnhdps.value=="3") {
      if (ChkDateTime(AddForm.bookdate,AddForm.booktime,AddForm.bkrec034,null)) {
        alert("Date booking keyed cannot be after Theatre date.")
        return;
      }
      if (days_between(document.AddForm.bkrec034.value,
                       document.AddForm.bookdate.value)>365) {
        alert("Error: Over one year difference between data entry and Theatre date");
         return;
      }
    }
  }
  if (ChkDateTime(AddForm.patadmdt,null,AddForm.bookdate,null)) {
    CaseList=GetContentCookie("CasePath");
    if (CaseList!="unknown") {
      AddForm.nextlink.value=CaseList;
    }
    AddForm.submit();
  } else {
    alert("Theatre Booking cannot be before Admission Date");
  }
}
function setCombo() {
  MenuOver(AddForm.operknow);
}
function checkWatEntry() {
  if (AddForm.bkrec006.value != "") {
    AddForm.bkrec006.disabled=true
    AddForm.bokrx002.focus()
  } else {
    AddForm.bkrec006.focus()
  }
  if (AddForm.bkrec007.value != "") {
    AddForm.bkrec007.disabled=true
  }
  if (AddForm.patadmdt.value != "") {
    AddForm.patadmdt.disabled=true
  }
  if (AddForm.bkrec005.value != "") {
    AddForm.bkrec005.disabled=true
  }
  AddForm.watread1.disabled=true;
}
function DisableIcon(field) {
  if (field.disabled == true) {
    alert(field.title+" is for display only")
    AddForm.bokrx002.focus()
  }
}
// Check if booking date is in the past (warning)
function CheckBookDate() {
  var strtDay = document.AddForm.bookdate.value.substring(0,2);
  var strtMon = document.AddForm.bookdate.value.substring(3,6);
  var strtYear = document.AddForm.bookdate.value.substring(7,11);
  strtMon = GetMonthNumber(strtMon);

  var strtDate = strtYear + strtMon + strtDay
  if (!CheckFuture(strtDate)) {
    if (!confirm("Warning: Booking date is prior to current date.")) {
      return false;
    }
  }
  return true;
}
function valClaimCode() {
  if (document.AddForm.patclaim.value=="") {
    validateCode(41,AddForm.urnumber,AddForm.claimc);
    for (var i =0 ; i < document.AddForm.patclaim.length; i++) {
//    alert(AddForm.patclaim.options[i].value.substr(0,3));
      if (document.AddForm.claimc.value==
          trim(document.AddForm.patclaim.options[i].value.substr(0,3))) {
        document.AddForm.patclaim.selectedIndex=i;
      }
    }
  }
}
function GetTheatreRequestCookies() {
  if (GetCookieData("BookTheatreReqVisitnoCookie")!="unknown") {
    document.AddForm.bkthvick.value=
    GetCookieData("BookTheatreReqVisitnoCookie");
  }
  ExpireCookiePath("BookTheatreReqVisitnoCookie");
  if (GetCookieData("BookTheatreReqReqnumCookie")!="unknown") {
    document.AddForm.requestn.value=
    GetCookieData("BookTheatreReqReqnumCookie");
  }
  ExpireCookiePath("BookTheatreReqReqnumCookie");
  if (GetCookieData("TheatreRequestRedirect")!="unknown" &&
      !isWhitespace(GetCookieData("TheatreRequestRedirect"))) {
    document.AddForm.nextlink.value=
    GetCookieData("TheatreRequestRedirect");
  }
  ExpireCookiePath("TheatreRequestRedirect");

  if (!isWhitespace(document.AddForm.requestn.value)) {
    var serverURL   = "../cgi-bin/comweb80.pbl?reportno=93" +
               "&valdcode=" + document.AddForm.requestn.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
//      alert(returnValue.return_value);
      document.AddForm.opcom009.value=returnValue.return_value;
    }
    var serverURL   = "../cgi-bin/comweb80.pbl?reportno=94" +
               "&valdcode=" + document.AddForm.requestn.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|")
      assignTheatreReqDefaults(ReturnValue);
      document.getElementById('thetrqin').value="1";
    }
  }
}
function assignTheatreReqDefaults(ReturnValue) {
  if (!isWhitespace(ReturnValue[0])) {
    for (var i =0 ; i < document.AddForm.bokrx003.length; i++) {
      if (document.AddForm.bokrx003.options[i].value.substr(0,3) ==
          ReturnValue[0]) {
        document.AddForm.bokrx003.selectedIndex=i
      }
    }
  }

  if (!isWhitespace(ReturnValue[1])) {
    for (var i =0 ; i < document.AddForm.bokrx002.length; i++) {
      if (document.AddForm.bokrx002.options[i].value.substr(0,3) ==
          ReturnValue[1]) {
        document.AddForm.bokrx002.selectedIndex=i
      }
    }
  }

  if (!isWhitespace(ReturnValue[2])) {
    for (var i =0 ; i < document.AddForm.operanae.length; i++) {
      if (document.AddForm.operanae.options[i].value.substr(0,3) ==
          ReturnValue[2]) {
        document.AddForm.operanae.selectedIndex=i
      }
    }
  }

  if (!isWhitespace(ReturnValue[3])) {
    document.AddForm.operprv1.value=ReturnValue[3];
    validateCode(4,
                 document.AddForm.operprv1,
                 document.AddForm.mbsdesc1,
                 document.AddForm.bookdate);
  }

  if (!isWhitespace(ReturnValue[4])) {
    document.AddForm.operprv2.value=ReturnValue[4];
    validateCode(4,
                 document.AddForm.operprv2,
                 document.AddForm.mbsdesc2,
                 document.AddForm.bookdate);
  }

  if (!isWhitespace(ReturnValue[5])) {
    document.AddForm.operprv3.value=ReturnValue[5];
    validateCode(4,
                 document.AddForm.operprv3,
                 document.AddForm.mbsdesc3,
                 document.AddForm.bookdate);
  }

  if (!isWhitespace(ReturnValue[6])) {
    document.AddForm.operdes1.value=ReturnValue[6];
  }

  if (!isWhitespace(ReturnValue[7])) {
    document.AddForm.operdes2.value=ReturnValue[7];
  }

  if (!isWhitespace(ReturnValue[8])) {
    document.AddForm.operdes3.value=ReturnValue[8];
  }

  if (!isWhitespace(ReturnValue[9])) {
    document.AddForm.opercomm.value=ReturnValue[9];
  }

  if (!isWhitespace(ReturnValue[10])) {
    for (var i =0 ; i < document.AddForm.operknow.length; i++) {
      if (document.AddForm.operknow.options[i].value.substr(0,3) ==
          ReturnValue[10]) {
        document.AddForm.operknow.selectedIndex=i
      }
    }
  }

  if (!isWhitespace(ReturnValue[11])) {
    for (var i =0 ; i < document.AddForm.opdea032.length; i++) {
      if (document.AddForm.opdea032.options[i].value.substr(0,3) ==
          ReturnValue[11]) {
        document.AddForm.opdea032.selectedIndex=i
      }
    }
  }

  if (!isWhitespace(ReturnValue[12])) {
    for (var i =0 ; i < document.AddForm.opdea033.length; i++) {
      if (document.AddForm.opdea033.options[i].value.substr(0,3) ==
          ReturnValue[12]) {
        document.AddForm.opdea033.selectedIndex=i
      }
    }
  }

  if (!isWhitespace(ReturnValue[13])) {
    for (var i =0 ; i < document.AddForm.opdea035.length; i++) {
      if (document.AddForm.opdea035.options[i].value.substr(0,3) ==
          ReturnValue[13]) {
        document.AddForm.opdea035.selectedIndex=i
      }
    }
  }

  if (!isWhitespace(ReturnValue[14])) {
    for (var i =0 ; i < document.AddForm.opdea038.length; i++) {
      if (document.AddForm.opdea038.options[i].value.substr(0,1) ==
          ReturnValue[14]) {
        document.AddForm.opdea038.selectedIndex=i
      }
    }
  }

  if (!isWhitespace(ReturnValue[15])) {
    document.AddForm.opdea039.value=ReturnValue[15].substr(6,2) +
                                    ReturnValue[15].substr(4,2) +
                                    ReturnValue[15].substr(0,4);
    checkDate(document.AddForm.opdea039,'Consent Date')
  }

  if (!isWhitespace(ReturnValue[16])) {
    document.getElementById('thetrqvl').value=ReturnValue[16]
  }
}
function getWaitingListBookingCookie() {
  document.getElementById("walibkck").value=
  GetCookieData("WaitingListBookingCookie");
  ExpireCookiePath("WaitingListBookingCookie");

//alert(document.getElementById("walibkck").value);
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);checkWatEntry();setCombo();
              GetTheatreRequestCookies();ChkInp();valClaimCode();
              getWaitingListBookingCookie();">
<div id=PageHeadingSection>
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB01.09.003";
PatientVIS="%OPRWEB01.09.081";
PatientNAM="%OPRWEB01.09.002";
PatientSTA="%OPRWEB01.09.086.078";
PatientALT="%OPRWEB01.09.084";
PatientSEX="%OPRWEB01.09.019";
PatientDOB="%OPRWEB01.09.020";
PatientAGE="%OPRWEB01.09.021";
PatientLOC="%OPRWEB01.09.083";
PatientPRI="%OPRWEB01.09.086.066.1";
PatientUNT="%OPRWEB01.09.066.0";
DoctorCOD="%OPRWEB01.09.082.003";
DoctorNAM="%OPRWEB01.09.082.002";
PatientAID="%OPRWEB01.09.086.090";
PatientIND="%OPRWEB01.09.086.091";
PatientCUR="%OPRWEB01.09.086.092";
PatientCLC="%OPRWEB01.09.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB01.09.086.094";
PatientCDM="%OPRWEB01.09.086.095";
PatientVDH="%OPRWEB01.09.086.099.015";
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
</div>

<div id=PageBodySection>
 <form name=AddForm method=post action=oprweb01.pbl>
  <input type=hidden name=reportno value=10>
  <input type=hidden name=template value=1>
  <input type=hidden name=urnumber value="%OPRWEB01.09.003">
  <input type=hidden name=admissno value="%OPRWEB01.09.081">
  <input type=hidden name=nextlink value="%OPRWEB01.09.102.oprweb01.03.003">
  <input type=hidden name=bkrec008 value="THE">
  <input type=hidden name=sesskeys value="%OPRWEB01.09.101">
  <input type=hidden name=wattrkey value="%OPRWEB01.09.301">
  <input type=hidden name=casekeys value="%OPRWEB01.09.301">
  <input type=hidden name=bookdate value="%OPRWEB01.09.202">
  <input type=hidden name=booktime value="%OPRWEB01.09.203">
  <input type=hidden name=admisnum>
  <input type=hidden name=ptcnubap value="%STANDARD.01.025.114.086.0.1">
  <input type=hidden name=admndate value="%OPRWEB01.09.702">
  <input type=hidden name=admntime value="%OPRWEB01.09.703">
  <input type=hidden name=bkrec002 value="%OPRWEB01.09.204.003">
  <input type=hidden name=sesdurtm value="%OPRWEB01.09.209">
  <input type=hidden name=sesprptm value="%OPRWEB01.09.211">
  <input type=hidden name=sesendtm value="%OPRWEB01.09.218">
  <input type=hidden name=ptmis027 value="%OPRWEB01.09.726.1">
  <input type=hidden name=ptmis068 value="%OPRWEB01.09.705.1">
  <input type=hidden name=ptvis043 value="%OPRWEB01.09.729">
  <input type=hidden name=ptmis009 value="%OPRWEB01.09.710.1">
  <input type=hidden name=ptmas024 value="%OPRWEB01.09.712.1">
  <input type=hidden name=admpoint value="%OPRWEB01.09.503.1">
  <input type=hidden name=listdate value="%OPRWEB01.09.309">
  <input type=hidden name=caretype value="%OPRWEB01.09.713.3">
  <input type=hidden name=ptcnhdps value="%OPRWEB01.09.801">
  <input type=hidden name=admstats value="%OPRWEB01.09.704">
  <input type=hidden name=currflag value="%OPRWEB01.09.802">
  <input type=hidden name=opdadate value="%OPRWEB01.09.202">
  <input type=hidden name=deceased value="%OPRWEB01.09.033">
  <input type=hidden name=datefrom>
  <input type=hidden name=dateto>
  <input type=hidden name=datefromwl>
  <input type=hidden name=datetowl>
  <input type=hidden name=claimc>
  <input type=hidden name=operusr1 value="%OPRWEB01.09.616.1">
  <input type=hidden name=pthvflag value="%OPRWEB01.09.807">
  <input type=hidden name=usewatmt value="1">
  <input type=hidden name=nextpage value="1">
  <input type=hidden name=redirect>
  <input type=hidden name=bkthvick value=" ">
  <input type=hidden name=requestn value=" ">
  <input type=hidden name=thetrqin id=thetrqin value=" ">
  <input type=hidden name=thetrqvl id=thetrqvl value=" ">
  <input type=hidden name=walibkck id=walibkck value="">

  <table border="0" cellpadding="0" cellspacing="0" width="100%">
   <tr><td align=center class=HeadingCell>Theatre Booking Form</td></tr>
  </table>

  <table border="0" cellpadding="0" cellspacing="0" width="95%" align=center>
   <tr><td width=15% class=DataLabel>Surgeon</td>
       <td><a href='javascript:DoctorViewFrame("%OPRWEB01.09.204.003")'>
              <strong>%OPRWEB01.09.204.002 &nbsp;</strong></a></td>
       <td width=15%>Anaesthetist</td>
       <td><a href='javascript:DoctorViewFrame("%OPRWEB01.09.216.003")'>
              %OPRWEB01.09.216.002</a></td></tr>

   <tr><td class=DataLabel>Unit</td>
       <td class=DataField>%OPRWEB01.09.213  </td>
       <td colspan="2">&nbsp;</td></tr>

   <tr><td class=DataLabel>Theatre</td>
       <td class=DataField> %OPRWEB01.09.214.0 </td>
       <td class=DataLabel>Session Type</td>
       <td class=DataField>%OPRWEB01.09.269.0  </td></tr>

   <tr><td class=DataLabel>Date</td>
       <td class=DataField>%OPRWEB01.09.206 %OPRWEB01.09.202</td>
       <td class=DataLabel>Time</td>
       <td class=DataField> %OPRWEB01.09.203 to %OPRWEB01.09.208</td></tr>

   <tr><td colspan=4 align=center><hr></td></tr>

   <tr><td class=DataLabel>Pre-Admission</td>
       <td><input type=text name=bkrec006 size=12 maxlength=11 tabindex=1
                  title="Pre-Admission Date" value="%OPRWEB01.09.327"
                  onblur="checkDate(this,'Date');">
             <img src="../images/DateLookup.gif" border=0 hspace=4
                  align=absmiddle tabindex=-1
                  onclick="javascript:DateLookupFrame(AddForm.bkrec006);"
                  onfocus="javascript:DisableIcon(AddForm.bkrec006);">
           Time
           <input type=text name=bkrec007 size=7 tabindex=2
                  title="Pre-Admission Time" value="%OPRWEB01.09.428">
             <img src="../images/DateTimeStamp.gif" border=0 hspace=4
                  align=absmiddle tabindex=-1
                  onclick="javascript:SetCurrentDateTime(AddForm.bkrec006,
                                                         AddForm.bkrec007);"
                  onfocus="javascript:DisableIcon(AddForm.bkrec007);">
             <img src="../images/TimeLookup.gif" border=0 hspace=4
                  align=absmiddle tabindex=-1
                  onclick="javascript:TimeLookupFrame(AddForm.bkrec007);"
                  onfocus="javascript:DisableIcon(AddForm.bkrec007);"></td>
       <td class=DataLabel>Confirmed Admission</td>
       <td><input type=text name=patadmdt size=12 maxlength=11 class=Mandatory
                  tabindex=3 title="Admission Date" value="%OPRWEB01.09.506"
                  onblur="checkDate(this,'Date');chkDOL();">
             <img src="../images/DateLookup.gif" border=0 hspace=4
                  align=absmiddle tabindex=-1
                  onclick="javascript:DateLookupFrame(AddForm.patadmdt);"
                  onfocus="javascript:DisableIcon(AddForm.patadmdt);">
           Time
           <input type=text name=bkrec005 size=6 tabindex=4 title="Admission Time"
                  class=Mandatory>
             <img src="../images/DateTimeStamp.gif" border=0 hspace=4
                  align=absmiddle tabindex=-1
                  onclick="javascript:SetCurrentDateTime(AddForm.patadmdt,
                                                         AddForm.bkrec005);"
                  onfocus="javascript:DisableIcon(AddForm.bkrec005);">
             <img src="../images/TimeLookup.gif" border=0 hspace=4
                  align=absmiddle tabindex=-1
                  onclick="javascript:TimeLookupFrame(AddForm.bkrec005);"
                  onfocus="javascript:DisableIcon(AddForm.bkrec005);"></td></tr>

   <tr><td class=DataLabel>Pre-Admission Status</td>
       <td><select name=watread1 title="Pre-Admission Status" tabindex=5>
            <option></option>
              %OPRWEB01.09.412.2
           </select></td>
       <td class=DataLabel>Proposed Admission</td>
       <td><input type=text name=watread2 size=12 maxlength=11 class=Readonly
                  readonly title="Proposed Admission Date" value="%OPRWEB01.09.311"
                  onblur="checkDate(this,'Date');"></td></tr>

   <tr><td class=DataLabel>Admitting Point</td>
       <td><select name=bokrx003 title="Admitting Point" class=Mandatory
                   tabindex=6>
            <option></option>
             %OPRWEB01.09.406.2
           </select></td>
       <td class=DataLabel>Proposed Operation</td>
       <td><input type=text name=watread3 readonly size=12 maxlength=11
                  class=Readonly readonly title="Proposed Operation Date"
                  value="%OPRWEB01.09.335"
                  onblur="checkDate(this,'Date');"></td></tr>

   <tr><td class=DataLabel>Exp.Post Op Ward</td>
       <td><select name=bokrx002 title="Exp.Post Op Ward" tabindex=7>
            <option></option>
             %OPRWEB01.09.405.2
           </select></td>
       <td class=DataLabel>Planned Length of Stay </td>
       <td><input type=text name=bkrec033 size=4 maxlength=3 class=Integer
                  tabindex=8 value=%OPRWEB01.09.316
                  title="Planned Length of Stay">
           (days)</td></tr>

   <tr><td class=DataLabel>%STANDARD.01.017.P </td>
       <td><select name=bkrec019 title="%STANDARD.01.017.P " tabindex=9>
            <option></option>
             %STANDARD.01.007.P 
           </select></td>
       <td class=DataLabel>%STANDARD.01.017.Y6</td>
       <td><select name=opdausr1 title="%STANDARD.01.017.Y6" tabindex=10>
            <option></option>
             %STANDARD.01.007.Y6
           </select></td></tr>

   <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
       <td><select name="patclaim" title="%STANDARD.01.017.CL" class=Mandatory
                   tabindex=11>
            <option></option>
             %OPRWEB01.09.115.2
           </select></td>
       <td class=DataLabel>Admission Source</td>
       <td><select name="opdea037" title="Admission Source" class=Mandatory
                   tabindex=12>
            <option></option>
             %OPRWEB01.09.655.2
           </select></td></tr>

   <tr><td class=DataLabel>Consent Obtained </td>
       <td><select name=opdea038 tabindex=14 maxlength=3 class=Mandatory
                   title="Consent Obtained"
                   onchange="changeConsent();">
            <option></option>
            <option value="No "> No </option>
            <option value="Yes"> Yes </option>
           </select></td>
       <td class=DataLabel>Consent Date</td>
       <td><input type=text name=opdea039 size=12 tabindex=15 class= "PastDate"
                  title="Consent Date" value="%OPRWEB01.09.394"
                  onblur="checkDate(this,'Date');">
             <img src="../images/DateTimeStamp.gif" class=Icon
                  date=AddForm.opdea039 time=null>
             <img src="../images/DateLookup.gif" class=Icon date=AddForm.opdea039>
       </td></tr>

   <tr><td class=DataLabel>Anaesthetic Type</td>
       <td><select name="operanae" title="Anaesthetic" class=Mandatory tabindex=16>
            <option></option>
             %OPRWEB01.09.106.2
           </select></td>
       <td class=DataLabel> Duration </td>
       <td><select name="operexpd" title="Operation Expected Duration"
                   class=Mandatory tabindex=17>
            <option value=""></option>
            <option value="  10">10 min</option>
            <option value="  15">15 Min</option>
            <option value="  20">20 Min</option>
            <option value="  30">30 min</option>
            <option value="  40">40 min</option>
            <option value="  50">50 min</option>
            <option value="  60">60 min</option>
            <option value="  70">70 min</option>
            <option value="  80">80 min</option>
            <option value="  90">90 min</option>
            <option value=" 100">100 min</option>
            <option value=" 110">110 min</option>
            <option value=" 120">120 Min</option>
            <option value=" 130">130 min</option>
            <option value=" 140">140 min</option>
            <option value=" 150">150 min</option>
            <option value=" 160">160 min</option>
            <option value=" 170">170 min</option>
            <option value=" 180">180 min</option>
            <option value=" 190">190 min</option>
            <option value=" 200">200 min</option>
            <option value=" 210">210 min</option>
            <option value=" 220">220 min</option>
            <option value=" 230">230 min</option>
            <option value=" 240">240 min</option>
            <option value=" 250">250 min</option>
            <option value=" 260">260 min</option>
            <option value=" 270">270 min</option>
            <option value=" 280">280 min</option>
            <option value=" 290">290 min</option>
            <option value=" 300">300 min</option>
            <option value=" 310">310 min</option>
            <option value=" 320">320 Min</option>
            <option value=" 330">330 min</option>
            <option value=" 340">340 min</option>
            <option value=" 350">350 min</option>
            <option value=" 360">360 min</option>
            <option value=" 370">370 min</option>
            <option value=" 380">380 min</option>
            <option value=" 390">390 min</option>
            <option value=" 400">400 min</option>
            <option value=" 410">410 min</option>
            <option value=" 420">420 min</option>
            <option value=" 430">430 min</option>
            <option value=" 440">440 min</option>
            <option value=" 450">450 min</option>
           </select></td></tr>

   <tr><td class=DataLabel>MBS Codes</td>
       <td><input type=text name=operprv1 size=9 value="%OPRWEB01.09.303"
                  tabindex=18 title="Expected MBS Item 1"
                  onblur="validateCode(4,
                                       AddForm.operprv1,
                                       AddForm.mbsdesc1,
                                       AddForm.bookdate);">
           <input type=text readonly name=mbsdesc1 size=30 tabindex=-1
                  title="Expected MBS Item 1 Name" value="%OPRWEB01.09.306">
             <img src="../images/SearchIcon.gif" tabindex=-1 class=Icon
                  onclick="MbsSearchFrame(AddForm.operprv1,
                                          AddForm.mbsdesc1,
                                          AddForm.bookdate);"></td>
       <td class=DataLabel> Blood Type </td>
       <td><select name="bokrx032" title="Blood Type" tabindex=19>
            <option></option>
             %OPRWEB01.09.532.2
           </select></td></tr>

   <tr><td class=DataLabel>&nbsp;</td>
       <td><input type=text name=operprv2 size=9 tabindex=20
                  title="Expected MBS Item 2"
                  onblur="validateCode(4,
                                       AddForm.operprv2,
                                       AddForm.mbsdesc2,
                                       AddForm.bookdate);">
           <input type=text readonly name=mbsdesc2 size=30 tabindex=-1
                  title="Expected MBS Item 2 Name">
             <img src="../images/SearchIcon.gif" tabindex=-1 class=Icon
                  onclick="MbsSearchFrame(AddForm.operprv2,
                                          AddForm.mbsdesc2,
                                          AddForm.bookdate);"></td>
       <td class=DataLabel>Infection Status</td>
       <td><select name="operknow" title="Infection Status" tabindex=21>
            <option></option>
             %OPRWEB01.09.640.2
           </select></td></tr>

   <tr><td class=DataLabel>&nbsp;</td>
       <td><input type=text name=operprv3 size=9 tabindex=22
                  title="Expected MBS Item 3"
                  onblur="validateCode(4,
                                       AddForm.operprv3,
                                       AddForm.mbsdesc3,
                                       AddForm.bookdate);">
           <input type=text readonly name=mbsdesc3 size=30 tabindex=-1
                  title="Expected MBS Item 3 Name">
             <img src="../images/SearchIcon.gif" tabindex=-1 class=Icon
                  onclick="MbsSearchFrame(AddForm.operprv3,
                                          AddForm.mbsdesc3,
                                          AddForm.bookdate);"></td>
       <td class=DataLabel>Equipment Required 1</td>
       <td><select name="opdea032" title="Equipment Required 1" tabindex=23>
            <option></option>
             %OPRWEB01.09.410.2
           </select></td></tr>

   <tr><td class=DataLabel>Full Description</td>
       <td><input type="text" size="55" maxlength=80 name="operdes1" tabindex=24
                  value="%OPRWEB01.09.306" title="Operation Description 1"
                  onblur="RemoveQuote(this);"></td>
       <td class=DataLabel>Equipment Required 2</td>
       <td><select name="opdea033" title="Equipment Required 2" tabindex=25>
            <option></option>
             %OPRWEB01.09.411.2
           </select></td></tr>

   <tr><td class=DataLabel>&nbsp;</td>
       <td><input type="text" size="55" maxlength=80 tabindex=26 name="operdes2"
                  title="Operation Description 2"
                  onblur="RemoveQuote(this);"></td>
       <td class=DataLabel>Equipment Required 3</td>
       <td><select name="opdea035" title="Equipment Required 3" tabindex=28>
            <option></option>
             %OPRWEB01.09.427.2
           </select></td></tr>

   <tr><td class=DataLabel>&nbsp;</td>
       <td><input type="text" size="55" maxlength=80 name="operdes3"
                  tabindex=29 title="Operation Description 3"
                  onblur="RemoveQuote(this);"></td>
       <td class=DataLabel>Equipment Loaned</td>
       <td><select name="opdea034" tabindex=30 title="Equipment Loaned">
            <option></option>
             %OPRWEB01.09.647.2
           </select></td></tr>

   <tr><td class=DataLabel>Prosthesis Required</td>
       <td><input type="text" size="45" maxlength=40 name="opercomm" tabindex=31
                  title="Prosthesis Comment "></td>
       <td class=DataLabel>Operating Unit</td>
       <td><select name=opdea036 title="Operating Unit" class="Mandatory"
                   tabindex=32>
            <option></option>
             %OPRWEB01.09.213.2
          </select></td></tr>

   <tr><td class=DataLabel>Date Booking Keyed</td>
       <td><input type=text size=12 tabindex=33 name=bkrec034 class=Mandatory
                  title="Date Booking Keyed" value="%STANDARD.01.015">
             <img src="../images/DateLookup.gif" border=0 hspace=4
                  align=absmiddle
                  onclick="DateLookupFrame(AddForm.bkrec034);"></td>
       <td class=DataLabel>%STANDARD.01.017.CC</td>
       <td><select name=bkrec028 title="%STANDARD.01.017.CC" tabindex=34>
            <option></option>
             %STANDARD.01.007.CC
           </select></td></tr>

   <tr><td class=DataLabel>Comments</td>
       <td colspan=3>
         <textarea name=opcom009 tabindex=35 wrap=hard cols=70 rows=3>%OPRWEB01.09.819.watweb01.20.003.001</textarea></td></tr>

   <tr><td colspan=4>&nbsp;</td></tr>

   <tr><td colspan=4 align="center">
         <input type=button id="opr01sub" class="button" value="Ok" tabindex=40
          onclick="tempDisable(this);Check();">
         <input type=button class="button" value="Cancel" tabindex=41
            onclick="if (document.getElementById('walibkck').value !=
                         'unknown') {
                       location.href=document.getElementById('walibkck').value;
                     }
                     else if (!isWhitespace(document.AddForm.nextlink.value)) {
                       location.href=document.AddForm.nextlink.value;
                     } else {
                       window.history.go(-1);}"></td></tr>
  </table>
 </form>
</div>

<form name=PatientLinks method=get>
 <input type=hidden name=reportno value=9>
 <input type=hidden name=template value=002>
 <input type=hidden name=urnumber value="%OPRWEB01.09.003">
 <input type=hidden name=admissno value="%OPRWEB01.09.081">
 <input type=hidden name=MenuType value="%OPRWEB01.09.088">
 <input type=hidden name=casekeys value="%OPRWEB01.09.101">
 <input type=hidden name=sesskeys value="%OPRWEB01.09.101">
</form>

<form name=CancelBook method=get>
 <input type=hidden name=reportno value=3>
 <input type=hidden name=template value=003>
 <input type=hidden name=sesskeys value="%OPRWEB01.09.101">
</form>

<form name=LinkForm method=get action=oprweb02.pbl>
 <input type=hidden name=reportno value=03>
 <input type=hidden name=template value=001>
 <input type=hidden name=urnumber value="%OPRWEB01.09.003">
 <input type=hidden name=admissno value="%OPRWEB01.09.081">
</form>

<script type="text/javascript">
for (var i =0 ; i < document.AddForm.bokrx002.length; i++) {
   if (document.AddForm.bokrx002.options[i].value=="%OPRWEB01.09.405.1") {
     document.AddForm.bokrx002.selectedIndex=i
   }
}

//alert("a"+%OPRWEB01.09.305+"b")
for (var i =0 ; i < document.AddForm.operexpd.length; i++) {
   x=trim(document.AddForm.operexpd.options[i].value)
   if (x==trim(%OPRWEB01.09.305)) {
     document.AddForm.operexpd.options[i].selected=true;
     break;
   }
}

function AdmissionLinkSearchFrame(urnumb,session,RETadmis,RETdate,RETtime,
                                  RETacare,RETaclaim) {
  DFrameStart();
  window.urnumber=urnumb;
  window.sesskeys=session;
  document.getElementById('PopUpFrame').src=
                                   "../lookups/AdmissionLinkSearchFrame.html";
  SearchFrameShow();
}
function ChkInp() {
  if (AddForm.pthvflag.value!="1") {
    document.AddForm.opdausr1.className="readonly";
    document.AddForm.opdausr1.disabled=true;
    }
  if (AddForm.currflag.value=="2") {
     if (confirm("Use the current Admission or Create a new booking\n" +
                 "   Ok to use the Current, Cancel to Create New")) {
       AdmissionLinkSearchFrame(AddForm.urnumber,AddForm.sesskeys,AddForm.admissno,
                                 AddForm.admndate,AddForm.admntime);
       return;
     }
  }
  if (AddForm.currflag.value!="1") {
    return;
  }
  if (AddForm.admissno.value=="") {
    return;
  }
  if (document.AddForm.admstats.value=="Pre-Admission       ") {
    if (!confirm("Use the current Pre-Admission or Create a new booking\n" +
                 "   Ok to use the Current, Cancel to Create New")) {
      return;
    }
  } else { 
      if (!confirm("Use the current Admission or Create a new booking\n" +
                   "   Ok to use the Current, Cancel to Create New")) {
        return;
      }
  }
  if (document.AddForm.ptcnhdps.value=="3") {
     if (document.AddForm.caretype.value.substr(14,1)!="4"&&
       document.AddForm.caretype.value.substr(14,1)!="5"&&
       document.AddForm.caretype.value.substr(14,1)!="8" &&
       document.AddForm.caretype.value.substr(14,2)!="10") {
       alert("Unable to use the current admission, invalid care type.")
       return; }
  }
  defaultAdmission();
}
function defaultAdmission() {
  AddForm.admisnum.value=AddForm.admissno.value
  AddForm.patadmdt.value=AddForm.admndate.value
  AddForm.bkrec005.value=AddForm.admntime.value
//Intended Length of Stay
  AddForm.bkrec033.value=AddForm.ptvis043.value
//Financial Class
  for (var i =0 ; i < document.AddForm.patclaim.length; i++) {
     if (document.AddForm.patclaim.options[i].value.substr(0,3)==
                                  document.AddForm.ptmis027.value.substr(0,3)) {
       document.AddForm.patclaim.selectedIndex=i
     }
  }
//Admitting Point
  for (var i =0 ; i < document.AddForm.bokrx003.length; i++) {
     if (document.AddForm.bokrx003.options[i].value.substr(0,3)==
                                  document.AddForm.admpoint.value.substr(0,3)) {
       document.AddForm.bokrx003.selectedIndex=i
     }
  }
//Expected Ward
  for (var i =0 ; i < document.AddForm.bokrx002.length; i++) {
     if (document.AddForm.bokrx002.options[i].value.substr(0,3)==
                                  document.AddForm.ptmis068.value.substr(0,3)) {
       document.AddForm.bokrx002.selectedIndex=i
     }
  }
//Admission Source
  for (var i =0 ; i < document.AddForm.opdea037.length; i++) {
     if (document.AddForm.opdea037.options[i].value.substr(0,3)==
                                  document.AddForm.ptmis009.value.substr(0,3)) {
       document.AddForm.opdea037.selectedIndex=i
     }
  }
//Patient Type
  for (var i =0 ; i < document.AddForm.bkrec019.length; i++) {
     if (document.AddForm.bkrec019.options[i].value.substr(0,3)==
                                  document.AddForm.ptmas024.value.substr(0,3)) {
       document.AddForm.bkrec019.selectedIndex=i
     }
  }
//Unplanned Visit To Theatre
  for (var i =0 ; i < document.AddForm.opdausr1.length; i++) {
     if (document.AddForm.opdausr1.options[i].value.substr(0,3)==
                                  document.AddForm.operusr1.value.substr(0,3)) {
       document.AddForm.opdausr1.selectedIndex=i
     }
  }
}
ibcnmhos="%OPRWEB01.09.799.008"
if (ibcnmhos=="1"){
  AddForm.bokrx002.className="Mandatory"
}
Consent="%OPRWEB01.09.393";
for (var i =0 ; i < document.AddForm.opdea038.length; i++) {
  if (document.AddForm.opdea038.options[i].value==Consent) {
    document.AddForm.opdea038.selectedIndex=i
  }
}
function changeConsent() {
  if (AddForm.opdea038.value == "Yes") {
    document.AddForm.opdea039.value="%STANDARD.01.015";
    AddForm.opdea039.select();
    AddForm.opdea039.focus();
  } else {
    document.AddForm.opdea039.value="          ";
    AddForm.operanae.focus();
  }
}
if ("%OPRWEB01.09.033" == "Yes") {
  AddForm.bkrec028.className="Mandatory";
} else {
  AddForm.bkrec028.className="";
}
//if (AddForm.deceased.value=="No ") {
//  acare="%OPRWEB01.09.713.1";
//  if (!isWhitespace(acare)) {
//    for (var i =0 ; i < document.AddForm.bkrec028.length; i++) {
//       if (document.AddForm.bkrec028.options[i].value.substr(0,3)==acare) {
//         document.AddForm.bkrec028.selectedIndex=i }
//    }
//  }
//}
</script>
