<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="stv">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/oprweb06.js"></script>
<script type="text/javascript">
function validateData() {
  strtDate = UpdateForm.optsm003;
  strtTime = UpdateForm.optsm004;
  endDate  = UpdateForm.optsm005;
  endTime  = UpdateForm.optsm006;
  if(!ChkDateTime(strtDate,null,endDate,null)) {
    alert("Start Date must be before End Date");
    UpdateForm.optsm003.select();
    return;
  }
     bool1=isWhitespace(UpdateForm.optsm005.value);
     bool2=!isWhitespace(UpdateForm.optsm006.value); 
     if(bool1&&bool2){
       alert("End time cannot be entered without End Date");
       UpdateForm.optsm005.select();
       return;
     } 
     if((!bool1) && (!bool2)){
       alert("End time must be entered with End Date");
       UpdateForm.optsm006.select();
       return;
     } 
  UpdateForm.optsm001.disabled=false
  UpdateForm.submit();    
}
function showLayer(UpdateForm) {
  if ((document.UpdateForm.optsm001.value)==0 || 
      (document.UpdateForm.optsm001.value)==1) {
    Layer1.style.display='';
    Layer2.style.display='none'; 
    Layer3.style.display='none'; 
    move(UpdateForm.combo1);
    UpdateForm.combo1.className="Mandatory"
  }
  else {
       if ((document.UpdateForm.optsm001.value)==2) {
            Layer2.style.display='';
            Layer1.style.display='none'; 
            Layer3.style.display='none'; 
            move(UpdateForm.combo2);
            UpdateForm.combo2.className="Mandatory"}  
         else {
              if ((document.UpdateForm.optsm001.value)==3) {
                   Layer3.style.display='';
                   Layer1.style.display='none'; 
                   Layer2.style.display='none'; 
                   move(UpdateForm.combo3);
                   UpdateForm.combo3.className="Mandatory"} } }
}
function move(comb) {
    UpdateForm.optsm008.value=comb.value;
}
function valfirst() {
    if(document.UpdateForm.optsm001.value=="")
       alert(" Select StaffType First");
    else return true;
}
function getCode(flag) {
if(valfirst()) {
 if (((document.UpdateForm.optsm001.value)==0) || 
     ((document.UpdateForm.optsm001.value)==1)){
   if(flag==0)
   DoctorSearchFrame(document.UpdateForm.optsm002,document.UpdateForm.stafdesc);
   if(flag==1){
   validateCode(3,document.UpdateForm.optsm002,document.UpdateForm.stafdesc);
      }
   }
else {
  if((document.UpdateForm.optsm001.value)==2) {
    if(flag==0)
    NurseSearchFrame(document.UpdateForm.optsm002,document.UpdateForm.stafdesc);
    if(flag==1) {
    validateNurse(document.UpdateForm.optsm002,document.UpdateForm.stafdesc)
    }
  }
  else {
    if(flag==0)
    HCPSearchFrame(document.UpdateForm.optsm002,document.UpdateForm.stafdesc,0);
    if(flag==1) {
    ValidateHCP(18,0,document.UpdateForm.optsm002,document.UpdateForm.stafdesc)
    }
  }
    }
  }
}
function validateNurse() {
  validateCode('17',document.UpdateForm.optsm002,
                    document.UpdateForm.stafdesc,
                    document.UpdateForm.gnm,
                    SetNurseName);
}
function SetNurseName() {
UpdateForm.stafdesc.value=UpdateForm.gnm.value.replace(/\s*$/g,"")+
                              " " +
                            UpdateForm.stafdesc.value.replace(/\s*$/g,"")
}
function update(type) {
    if(type=="M") {
       if(validateMandatory(UpdateForm)) {
         UpdateForm.updatety.value=type;
         validateData(); 
       }
    }
    else {
      if (UpdateForm.optsm001.value=="0") {
         alert("Cannot Delete Operating Surgeon");
        }
      else {
           ans=confirm("Are you sure you want to delete");
           if(ans) {
             UpdateForm.updatety.value=type;
             UpdateForm.optsm001.disabled=false
             UpdateForm.submit();
           }
        }
    }
}
function StaffType() {
  if (UpdateForm.optsm001.value=="2") {
    document.all.StaffOption.innerHTML=document.all.NurseType.innerHTML 
    if (UpdateForm.finalcnt.value=="1") UpdateForm.optsm009.checked=1;
   }
  else{
     document.all.StaffOption.innerHTML="";
  }
}
function StaffLook() {
//  if (UpdateForm.optsm001.value=="0") 
    document.all.StaffCode.innerHTML=document.all.StaffIcon.innerHTML;
//  else 
//    document.all.StaffCode.innerHTML=document.all.StaffNoIcon.innerHTML;
}
function init() {
    showLayer(UpdateForm)
    StaffType();
    StaffLook();
    if(document.UpdateForm.timeoutt.value=="1") {
      document.UpdateForm.optsm010.checked=true
    }
}

function valDoctor(dcode) {
  var code = dcode.value.toUpperCase();
  document.UpdateForm.optsm002.value = code;
  getCode(1);
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);showLayer(UpdateForm);">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Day Procedures - Staff Member Maintenance
</span>
<form id=UpdateForm name=UpdateForm action="oprweb06.pbl" method=post 
onsubmit="return validateMandatory(this)">
<input type=hidden name=reportno value=12>
<input type=hidden name=template value=004>
<input type=hidden name=updatety value="">
<input type=hidden name=casekeys value="%OPRWEB06.12.101">
<input type=hidden name=teamnumb value="%OPRWEB06.12.334">
<input type=hidden name=optsm008 > 
<input type=hidden name=finalcnt value="%OPRWEB06.12.310"> 
<input type=hidden name=timeoutt value="%OPRWEB06.12.349">
<input type=hidden name=savkey01 value="%OPRWEB06.12.312">
<input type=hidden name=gnm>

<table align=center cellspacing=0 cellpadding=3 border=0 width=95%>
<tr><td class=DataLabel>Staff Type</td>
    <td class=DataField colspan=2>
    <select name=optsm001 class=Mandatory disabled>
     %OPRWEB06.12.318.0
    </select></td></tr>
<tr><td class=DataLabel>Staff Code</td>
    <td><span id=StaffCode></span></td>
</tr>

<tr><td class=DataLabel>Start Date</td>
    <td class=DataLabel colspan=2>
    <input type=text size=12 name=optsm003
     value="%OPRWEB06.12.320"  title="start date" class=Mandatory>
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.optsm003>
    Time
    <input type=text size=12 name=optsm004
     value="%OPRWEB06.12.321" title="start Time" class=Mandatory>
    <img src=../images/DateTimeStamp.gif class=Icon 
     date=UpdateForm.optsm003 time=UpdateForm.optsm004> 
    <img src=../images/TimeLookup.gif class=Icon time=UpdateForm.optsm004>
    </td></tr>
<tr><td class=DataLabel>End Date</td>
    <td class=DataLabel colspan=2>
    <input type=text size=12 name=optsm005
     value="%OPRWEB06.12.322"  title="End Date" >
    <img src=../images/DateLookup.gif class=Icon date=UpdateForm.optsm005>
    Time
    <input type=text size=12 name=optsm006
     value="%OPRWEB06.12.323" title="End Time" >
    <img src=../images/DateTimeStamp.gif class=Icon 
     date=UpdateForm.optsm005 time=UpdateForm.optsm006>
    <img src=../images/TimeLookup.gif class=Icon time=UpdateForm.optsm006>
    </td></tr>
<tr><td class=DataLabel>Staff Category</td>
    <td class=DataField colspan=2>
    <div id="Layer1" style="display: none;">
    <select id=combo1 name=combo1 onchange=move(combo1) title="Staff Category">
    <option></option>
     %OPRWEB06.12.331.2
    </select>
    </div>
    <div id="Layer2" style="display: none;">
    <select id=combo2 name=combo2 onchange=move(combo2) title="Staff Category">
    <option></option>
     %OPRWEB06.12.332.2
    </select>
    </div>
    <div id="Layer3" style="display: none;">
    <select id=comboo3 name=combo3 onchange=move(combo3) title="Staff Category">
    <option></option>
<!-- %OPRWEB06.12.327.2  -->
<!--          Cat."OF" reject Ind.1 = "R" (Reason for Referral) -->
     %OPRWEB06.12.327.9.1.01.2.R
    </select>
    </div>
    </td></tr>
</table>
<span id=StaffOption></span>
<table align=center cellspacing=0 cellpadding=2 border=0 width=95%>
<tr><td class=DataLabel width=22%>Time Out</td>
    <td class=DataField><input type=checkbox name=optsm010
         title="Time Out" value="1"></td></tr>
  
<tr><td colspan=3 align=center>
<br><input type=button id="opr06sub" value="Update" class="button" 
    onClick="tempDisable(this);update('M');">
    <input type=button value="Delete" class="button" onClick="update('R')">
    <input type=button value="Cancel" class="button" 
     onClick="DFrameExitRefresh();">
    </td></tr>
</table>
</form>
<span id=NurseType style="display:none">
<table width=95% align=center border=0 cellspacing=1 cellpadding=1>
<tr><td class=DataLabel width=22%>Final Instrument Count</td>
    <td class=DataField><input type=checkbox name=optsm009
         title="Instrument Count" value="1"></td></tr>
</table>
</span>

<span id=StaffIcon style="display:none">
    <input type=text  name=optsm002 size=6 value="%OPRWEB06.12.319.1"
     title="Staff Code" class="Mandatory" onblur="valDoctor(this);">
    <input type=text name=stafdesc class=ReadOnly readonly
     value="%OPRWEB06.12.319.0">
    <img src=../images/SearchIcon.gif class=Icon onClick="getCode(0);">
</span>
<span id=StaffNoIcon style="display:none">
    <input type=text  name=optsm002 size=6 value="%OPRWEB06.12.319.1"
     title="Staff Code" class="ReadOnly" readonly >
    <input type=text name=stafdesc class=ReadOnly readonly
     value="%OPRWEB06.12.319.0">
</span>
