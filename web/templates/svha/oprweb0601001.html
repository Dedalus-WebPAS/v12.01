<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="svha">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"></script>
<script type="text/javascript" src="../js/oprweb06.js"></script>
<script type="text/javascript">
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link
//  1 - Staff
//  2 - Name
//  3 - Start Time
//  4 - End Time
//  5 - Supervisor/Level
//---------------------------------------------------------------------------
function InitTable(TableView) {
    switch (TableView) {
      case 0: {
       document.title="Staff Members"
       t = new Table(1,0,2,"100%","center",25,30);
       t.addColumn("Staff","String",6,6,"left","MaintenanceIcon.gif","0",160)
       t.addColumn("Name","String",2,2,"left","","",150)
       t.addColumn("Count","String",7,7,"left","","",40)
       t.addColumn("Start Time","String",3,3,"left","","",80)
       t.addColumn("End Time","String",4,4,"left","DateTimeStamp.gif","8",80)
       AddTableRows();
       TableOutput(0,2);    // Order Column,Asc Dsc
       break; }
    }
}
// Add Team
function AddTeam() {
   if(UpdateForm.teamnumb.length==9){
      alert("Cannot add more than 9 Teams");
      return;  
    }
    if(!confirm("Are you sure you want to add a new team?")) {
      return;
    }
    if(!validateMandatory(UpdateForm)) {
      return;
    }
    document.UpdateForm.teamnumb.className=""
    document.UpdateForm.teamnumb.value=""; 
    document.UpdateForm.updatety.value="A";
    formSubmit();
} 
// Update Team
function UpdateTeam() {
  if (UpdateForm.ovrnight.checked == true) {
    UpdateForm.opsrg071.value = "1";
  }

  if (!checkVisitDatesTimes()) { return; }

  document.UpdateForm.updatety.value="U";
  formSubmit();
}
// Delete Team
function DeleteTeam() {
   if(!CheckTeamNumber())
        return;
   if(confirm("Are you sure you want to delete")) {
       document.UpdateForm.updatety.value="D";
       formSubmit();
    }
}
// Avoid deletion of First Team
function CheckTeamNumber(){
   if(UpdateForm.teamnumb.selectedIndex==0){
      alert("Cannot delete first Team");
      return false; 
   }
   index=UpdateForm.teamnumb.selectedIndex;
   SelectedValue=UpdateForm.teamnumb.options[index].value; 
   if(SelectedValue!=UpdateForm.teamnumb.length){
      message="Can delete only highest Team number which is "+
              UpdateForm.teamnumb.length+" in this case";
      alert( message);
      return false;
   } 
   return true;
}
// Refresh Page
function RefreshPage() {
   document.UpdateForm.method="get"
   document.UpdateForm.updatety.value="";
   document.UpdateForm.submit();
}
// Link To Add Staff
function goToStaff() {
    if (UpdateForm.ovrnight.checked == true) 
      UpdateForm.opsrg071.value = "1";
    temp=document.UpdateForm.teamnumb.value;
    supr=document.UpdateForm.suprlevl.value;
    linkurl="oprweb06.pbl?reportno=1&template=2&casekeys="+
    UpdateForm.casekeys.value+"&teamnumb="+temp+"&suprlevl="+supr;
    Left=(document.body.clientWidth-750)/2
    DFrameLink(linkurl,100,Left,750,350)
}
//  Update Staff End Time and Date
function UpdateEndTime(linkkeys) {
   casekey=UpdateForm.casekeys.value.substr(0,26);
   casekey=casekey.replace(/ /g,"+");
   uniqkey=UpdateForm.uniqueky.value
   uniqkey=uniqkey.replace(/ /g,"+");
   document.UpdateForm.redirect.value="oprweb06.pbl?reportno=1&template=001&"+
                             "uniqueky="+uniqkey;
   document.UpdateForm.opdunqid.value=linkkeys;
   document.UpdateForm.nextpage.value=1;
   document.UpdateForm.updatety.value="E";
   formSubmit();
}
// Link to Update Staff
function UpdateLink(scasekey,staftype,stafcode,stardate,startime) {
   temp=document.UpdateForm.teamnumb.value;
   supr=document.UpdateForm.suprlevl.value;
   linkurl="oprweb06.pbl?reportno=1&template=3&casekeys="+
   scasekey+"&teamnumb="+temp+"&optsm001="+
   staftype+"&optsm002="+stafcode+"&optsm003="+
   stardate+"&optsm004="+startime+
   "&suprlevl="+supr;
   Left=(document.body.clientWidth-750)/2
   DFrameLink(linkurl,100,Left,750,350)
}
function UpdateLinkFF(scasekey,staftype,stafcode,stardate,startime) {
   temp=document.UpdateForm.teamnumb.value;
   supr=document.UpdateForm.suprlevl.value;
   linkurl="oprweb06.pbl?reportno=12&template=4&casekeys="+
   scasekey+"&teamnumb="+temp+"&optsm001="+
   staftype+"&optsm002="+stafcode+"&optsm003="+
   stardate+"&optsm004="+startime+
   "&suprlevl="+supr+
   "&opsdt001="+document.UpdateForm.uniqueky.value+
   "&opsdt002="+document.UpdateForm.teamnumb.value+
   "&opsdt003="+staftype+
   "&opsdt004="+stafcode+
   "&opsdt005="+stardate+
   "&opsdt006="+startime;
   Left=(document.body.clientWidth-750)/2
   DFrameLink(linkurl,100,Left,750,350)
}
// Form Submit
function formSubmit() {
   if(validateMandatory(UpdateForm)) {
      casekey=UpdateForm.casekeys.value.substr(0,26);
      casekey=casekey.replace(/ /g,"+");
      uniqkey=UpdateForm.uniqueky.value
      uniqkey=uniqkey.replace(/ /g,"+");
      if(UpdateForm.suprlevl.value=="S") {
      UpdateForm.redirect.value="oprweb01.pbl?reportno=4&template=013&"+
                                 "casekeys="+casekey; }
      else {
      UpdateForm.redirect.value="oprweb06.pbl?reportno=1&template=001&"+
                                 "uniqueky="+uniqkey+"&teamnumb="; }
      document.UpdateForm.submit();
    }
}
// Set Team no.
function set(){
 PatientLinks.teamnumb.value=UpdateForm.teamnumb.value;
}
// Validate Surgical Time
function ChkPrep() {
if(isWhitespace(UpdateForm.opsrg003.value)) {
   alert("Time into OR missing. Please enter it now");
   document.UpdateForm.opsrg003.focus();
   return;
  }
if(!isWhitespace(UpdateForm.opsrg005.value)) {
var prepTime = trim(UpdateForm.opsrg003.value.replace(/:/g,""))
var surgStrt = trim(UpdateForm.opsrg005.value.replace(/:/g,""))
prepTime=prepTime.substr(0,4)
surgStrt=surgStrt.substr(0,4)
prepTime=prepTime - 0;
surgStrt=surgStrt - 0;
  if(prepTime > surgStrt) {
//
     if(!confirm("Surgery Start Time cannot be less than Time into OR" +
        "\n Do you want to override?")) {
        UpdateForm.opsrg005.value="";
        document.UpdateForm.opsrg005.focus();
        return;
     }
//
     }
  }
//
var MaxDelay=(parseInt(prepTime) + 15)
var Minutes=parseInt(MaxDelay) % 100
var Hour=parseInt(MaxDelay) / 100
  if (Minutes>=60) {
     Minutes=Minutes - 60
     Hour=parseInt(Hour) + 1
     MaxDelay = (Hour*100) + Minutes
  }
  if (MaxDelay < surgStrt) {
     UpdateForm.opsrg007.className="Mandatory"
  } else {
     UpdateForm.opsrg007.className=""
  }
//
}
function ManInfection() {
if(!isWhitespace(UpdateForm.opsrg005.value)) {
// Bug SV46
  UpdateForm.opsrg060.className="Mandatory";
 }
}
function ChkStart() {
if(isWhitespace(UpdateForm.opsrg005.value)) {
   alert("Surgery Start Time missing. Please enter it now");
   document.UpdateForm.opsrg005.focus();
   return;
  }
if(!isWhitespace(UpdateForm.opsrg006.value)) {
  surgStrt = trim(UpdateForm.opsrg005.value.replace(/:/g,""))
  surgEnd  = trim(UpdateForm.opsrg006.value.replace(/:/g,""))
  if(surgStrt < surgEnd) {
    CheckFutureTime(UpdateForm,document.UpdateForm.opsedate.value,document.UpdateForm.opsrg006);
  }
  if(surgStrt > surgEnd) {
    if (confirm("Is Surgery End the day after Surgery Start time?")) {
     UpdateForm.dateflag.value="1";
     UpdateForm.ovrnight.checked=true;
    }
    else {
        CheckFutureTime(UpdateForm,document.UpdateForm.opsedate.value,document.UpdateForm.opsrg006);
          UpdateForm.dateflag.value="0";
          document.UpdateForm.opsrg006.focus();
        }
     }
  }
}
function ChkEnd() {
  if(isWhitespace(UpdateForm.opsrg006.value)) {
    alert("Surgery End Time missing. Please enter it now"); 
    document.UpdateForm.opsrg006.focus();
    return;
  }
} 
// Help for Infection Control
function AlertICC() {
alert("A  DIRTY\n" +
      "    Operations in which a perforated viscus or\n" + 
      "    pus is found\n" +
      "B  CONTAMINATED\n" +
      "    Operations breaching the G.I.T, R.T. and\n" +
      "    G./U.T. or in which a major break in aseptic\n" +
      "    technique occurs, and traumatic wounds\n" +
      "C  CLEAN\n" +
      "    All other operations where the criteria set out\n" +
      "    in 1 and 2 do not apply");
}
// Validate Prep Time > Anasthetic Time
function ChkAnas() {
  if (!isWhitespace(UpdateForm.opsrg003.value)) {
    var anastime=trim(UpdateForm.anaestim.value.replace(/:/g,""));
    var prepstrt=trim(UpdateForm.opsrg003.value.replace(/:/g,""));
    if (anastime > prepstrt) {
      if(!confirm("Time into OR should be after Anaesthesia Start Time " +
                UpdateForm.anaestim.value + "\n Do you want to override?")) {
        UpdateForm.opsrg003.value=""
        document.UpdateForm.opsrg003.focus();
        return;
      }
    }
  }
}
// Change Theatre
function ChgOpr() {
linkurl="oprweb01.pbl?reportno=4&template=014&casekeys="
         +UpdateForm.casekeys.value; 
  Left=(document.body.clientWidth-350)/2
  DFrameLink(linkurl,100,Left,350,180)
 }
// Procedure Description to be made Mandatory
function ProcMan() {
  if (!isWhitespace(UpdateForm.opsrg005.value)) {
    UpdateForm.opsrg060.className="Mandatory";
  }
}
function checkVisitDatesTimes() {
  if (!CheckDateRange(document.getElementById('admndate'),
                      document.getElementById('opsedate'))) {
    return false;
  } 

  if (SetDateYYYYMMDD(document.getElementById('admndate').value) == 
      SetDateYYYYMMDD(document.getElementById('opsedate').value)) {
    if (!isWhitespace(document.getElementById('opsrg005').value)) {
      if ((document.getElementById('opsrg005').value < 
          document.getElementById('admntime').value) &&
         (document.getElementById('ovrnight').checked==false)) {
        alert('Invalid Range Entered Admission Time and Surgery Start');
        return false;
      }
    } 
  }

  if (!isWhitespace(document.getElementById('discdate').value)) {

    if (document.getElementById('ovrnight').checked==true) {
      AddSubtractDate(document.getElementById('opsework'),"1","A");       
    }

    if (!CheckDateRange(document.getElementById('opsework'),
                        document.getElementById('discdate'))) {
      document.getElementById('opsework').value=
      document.getElementById('opsework').defaultValue;
      return false;
    } 

    if (SetDateYYYYMMDD(document.getElementById('opsework').value) ==
        SetDateYYYYMMDD(document.getElementById('discdate').value)) {
      if (!isWhitespace(document.getElementById('opsrg006').value)) {
        if (document.getElementById('disctime').value <
            document.getElementById('opsrg006').value) {
          alert('Invalid Range Entered Surgery End and Discharge Time');
          document.getElementById('opsework').value=
          document.getElementById('opsework').defaultValue;
          return false;
        }
      }
    }
  }

  return true;
}
function ValidateSurgeryStart(Field) {
  var inpTIOR = document.getElementById('opsrg003');  // Time into OR

  if (!isWhitespace(Field.value)) {
    inpTIOR.className = "Mandatory";
  }
  else {
    inpTIOR.className = "";
  }
}
function ValidateTimeIOR(e, Field) {
  if (isWhitespace(Field.value)) return;

  var evt = e ? e : window.event;
  var inpSurgStart = document.getElementById('opsrg005');  // Surgery Start

  if (isWhitespace(inpSurgStart.value))
    return;

  // 'Time into OR' must be prior to the 'Surgery Start' time
  if (Field.value >= inpSurgStart.value) {
    alert(Field.title + " must be prior to " + inpSurgStart.title);
    FocusDelay(Field);
    Field.select();
    CancelEvent(evt);
  }
}
function ValidateSurgicalTeamTO(e, Field) {
  if (isWhitespace(Field.value)) return;

  var evt = e ? e : window.event;

  // validate against 'Time into OR'
  var inpTIOR = document.getElementById('opsrg003');
  if (!isWhitespace(inpTIOR.value)) {
    if (!document.getElementById('ovrnight').checked &&
        !(Field.value > inpTIOR.value)) {
      alert(Field.title + " must be later than " + inpTIOR.title);
      FocusDelay(Field);
      Field.select();
      CancelEvent(evt);
      return;
    }
  }
  
  // validate against 'Surgery Start'
  var inpSurgStart = document.getElementById('opsrg005');
  if (!isWhitespace(inpTIOR.value) && !isWhitespace(inpSurgStart.value)) {
    if (!document.getElementById('ovrnight').checked &&
        !(Field.value < inpSurgStart.value)) {
      alert(Field.title + " must be prior to " + inpSurgStart.title);
      FocusDelay(Field);
      Field.select();
      CancelEvent(evt);
      return;
    }
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);set();ProcMan();LoadDefTeam();
 ValidateSurgeryStart(UpdateForm.opsrg005);">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB06.01.003";
PatientVIS="%OPRWEB06.01.081";
PatientNAM="%OPRWEB06.01.002";
PatientSTA="%OPRWEB06.01.086.078";
PatientALT="%OPRWEB06.01.084";
PatientSEX="%OPRWEB06.01.019";
PatientDOB="%OPRWEB06.01.020";
PatientAGE="%OPRWEB06.01.021";
PatientLOC="%OPRWEB06.01.083";
PatientPRI="%OPRWEB06.01.086.066.1";
PatientUNT="%OPRWEB06.01.066.0";
DoctorCOD="%OPRWEB06.01.082.003";
DoctorNAM="%OPRWEB06.01.082.002";
PatientAID="%OPRWEB06.01.086.090";
PatientIND="%OPRWEB06.01.086.091";
PatientCUR="%OPRWEB06.01.086.092";
PatientCLC="%OPRWEB06.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB06.01.086.094";
PatientCDM="%OPRWEB06.01.086.095";
PatientVDH="%OPRWEB06.01.086.099.015";
InsertPatientHeader()
</script>
<div id="PatientMenu"></div>

<div id="TheatreCaseHeading"></div>
<script type="text/javascript">
TheatreHeading="Theatre Details"
CombinedCMBS="%STANDARD.01.025.113.003.0.1"
NoDressingTime="1"
InsertTheatreCaseHead()
</script>

<form name=UpdateForm method=post action="oprweb06.pbl" style="margin:0">
<input type=hidden name=reportno id=reportno value=1>
<input type=hidden name=template id=template value=1>
<input type=hidden name=updatety id=updatety value="">
<input type=hidden name=urnumber id=urnumber value='%OPRWEB06.01.003'>
<input type=hidden name=casekeys id=casekeys value="%OPRWEB06.01.101">
<input type=hidden name=uniqueky id=uniqueky value='%OPRWEB06.01.110'>
<input type=hidden name=opsedate id=opsedate value='%OPRWEB06.01.402'
 title="Session Date">
<input type=hidden name=opsework id=opsework value='%OPRWEB06.01.402'
 title="Session Date">
<input type=hidden name=currdate id=currdate value='%STANDARD.01.013'>
<input type=hidden name=currtime id=currtime>
<input type=hidden name=recordty id=recordty value="">
<input type=hidden name=rcounter id=rcounter value="">
<input type=hidden name=redirect id=redirect value="">
<input type=hidden name=nextpage id=nextpage value=1>
<input type=hidden name=anaestim id=anaestim value="%OPRWEB06.01.542">
<input type=hidden name=dateflag id=dateflag>
<input type=hidden name=suprlevl id=suprlevl value="%OPRWEB06.01.313">
<input type=hidden name=surgc001 id=surgc001 value="">
<input type=hidden name=opdunqid id=opdunqid value="">
<input type=hidden name=opsrg071 id=opsrg071 value=" ">
<input type=hidden name=opsedtcm id=opsedtcm value="%OPRWEB06.01.483">
<input type=hidden name=admndate id=admndate value="%OPRWEB06.01.351"
 title="Admission Date">
<input type=hidden name=admntime id=admntime value="%OPRWEB06.01.352">
<input type=hidden name=discdate id=discdate value="%OPRWEB06.01.353"
 title="Discharge Date">
<input type=hidden name=disctime id=disctime value="%OPRWEB06.01.354">
<input type=hidden name=updatmmb id=updatmmb value="1">
<input type=hidden name=opard002 id=opard002 value="%OPRWEB06.01.502">

<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td class=DataLabel width=6%>Theatre</td>
    <td class=DataField width=12%>%OPRWEB06.01.302</td> 
    <td class=DataLabel width=10%>Date </td>
    <td class=DataField width=14%>%OPRWEB06.01.406 %OPRWEB06.01.402</td>
    <td class=DataLabel width=10%>Unit</td>
    <td class="DataField" width=15%>%OPRWEB06.01.413.0 </td></tr>
<tr><td class=DataLabel>Consultant</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.01.404.003")'>
    %OPRWEB06.01.404.002 </a></td>
    <td class=DataLabel>Operating Surgeon</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.01.311.003")'>
    %OPRWEB06.01.311.002 </a></td>
    <td class=DataLabel>Supervisor Level</td>
    <td><select name=optsm007 id=optsm007 class=SelectBig>
        <option></option>
         %OPRWEB06.01.325.2
        </select></td></tr>
<tr><td class=DataLabel>Anaesthetist</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.01.416.003")'>
    %OPRWEB06.01.416.002 </a></td></tr>

<tr><td colspan=6></td></tr>
</table>

<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td class=DataLabel>Procedure&nbsp;</td>
    <td> <input type=text size=116 name=opdea014 id=opdea014 maxlength=80
          title="Procedure Description" value="%OPRWEB06.01.305"></td></tr>
<tr><td class=DataLabel>&nbsp;&nbsp;</td>
    <td> <input type=text size=116 name=opdea015 id=opdea015 maxlength=80
     title="Procedure Description" value="%OPRWEB06.01.343"></td></tr> 
<tr><td class=DataLabel>&nbsp;&nbsp;</td>
    <td> <input type=text size=116 name=opdea016 id=opdea016 maxlength=80
         title="Procedure Description" value="%OPRWEB06.01.344">
    </td></tr>
</table>
<hr>
<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr valign=top><td class=DataLabel>Team No</td>
   <td class=DataField>
   <select name=teamnumb id=teamnumb title="Theatre Team" class=Mandatory tabindex=1
    onchange="RefreshPage()">
    %OPRWEB06.01.148
   </select></td>
   <td class=DataLabel>Overnight Indicator</td>
   <td><input type=checkbox name=ovrnight id=ovrnight
        title="Overninght Indicator" value="1"></td>
    <td class="DataLabel" >Prep.Soln.</td>
   <td><select name=opsrg050 id=opsrg050 title="Prep.Soln code1" class=SelectBig tabindex=8>
        <option></option>
        %OPRWEB06.01.250.2
        </select></td></tr>
<tr><td class=DataLabel>Time into OR</td>
    <td class=DataField><input type=text name=opsrg003 id=opsrg003
     size=8 maxlength=8 value="%OPRWEB06.01.335" title="Time into OR"
     onblur="checkTime(this,'Time into OR');ChkAnas();
             CheckFutureTime(UpdateForm,document.UpdateForm.opsedate.value,opsrg003);ValidateTimeIOR(event,this);"
     tabindex=2>
    <img src="../images/DateTimeStamp.gif" class=Icon time=UpdateForm.opsrg003>
    <img src="../images/TimeLookup.gif" class=Icon time=UpdateForm.opsrg003>
    </td>
    <td class=DataLabel>&nbsp;</td>
    <td class=DataField>&nbsp;</td>
    <td class="DataLabel" >Prep.Soln.</td>
    <td><select name=opsrg051 id=opsrg051 title="Prep.Soln code2"
         class=SelectBig tabindex=9>
        <option></option>
         %OPRWEB06.01.251.2
        </select></td></tr>

<tr><td class=DataLabel>Surgical Team Time Out</td>
    <td class=DataField><input type=text name=opard029 id=opard029 tabindex=5
       size=8 maxlength=8 title="Surgical Team Time Out"
       value="%OPRWEB06.01.529"
       onblur="if (checkTime(this,this.title)) {
                 ValidateSurgicalTeamTO(event,this);
               }">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,opard029);">
      <img src="../images/TimeLookup.gif" class=Icon
       onclick="TimeLookupFrame(opard029);"></td>

      <td class=DataLabel>Surgery Delay</td>
      <td class=DataField>
      <select name=opsrg007 id=opsrg007 tabindex=6 title="Surgery Delay">
      <option></option>
      %OPRWEB06.01.339.2
      </select></td>
      <td class="DataLabel">Prep.Soln.</td>
      <td><select name=opsrg052 id=opsrg052 title="Prep.Soln code3" class=SelectBig
         tabindex=10>
        <option></option>
         %OPRWEB06.01.252.2
        </select></td></tr>

<tr><td class=DataLabel>Surgery Start</td>
    <td class=DataField>
    <input type=text name=opsrg005 id=opsrg005 size=8 maxlength=8 tabindex=3
     value="%OPRWEB06.01.337" title="Surgery Start"
     onblur="checkTime(this,'Surgery Start');ChkPrep();ManInfection();
     CheckFutureTime(UpdateForm,document.UpdateForm.opsedate.value,opsrg005);"
     onchange="ValidateSurgeryStart(this);">
    <img src="../images/DateTimeStamp.gif" class=Icon time=UpdateForm.opsrg005>
    <img src="../images/TimeLookup.gif" class=Icon time=UpdateForm.opsrg005>
    </td>
    <td class=DataLabel>Count Correct </td>
    <td class=DataField>
    <select name=opsrg008 id=opsrg008 title="Count Correct" tabindex=7>
    <option></option>
    <option value=1>No</option>
    <option value=2>Yes</option>
    </select></td>
    <td class="DataLabel">Infection Control Class</td>
    <td><select name=opsrg060 id=opsrg060 title="Infection Control Class" tabindex=11>
        <option></option>
         %OPRWEB06.01.260.2
        </select>
        <img src="../images/HelpIcon.gif" class=Icon onclick="AlertICC();">
    </td></tr>

<tr><td class=DataLabel>Surgery End</td>
    <td class=DataField>
    <input type=text name=opsrg006 id=opsrg006 size=8 maxlength=8 tabindex=4
     value="%OPRWEB06.01.338" title="Surgery End"
     onblur="checkTime(this,'Surgery End');ChkStart();">
    <img src="../images/DateTimeStamp.gif" class=Icon time=UpdateForm.opsrg006>
    <img src="../images/TimeLookup.gif" class=Icon time=UpdateForm.opsrg006>
    </td></tr>

<tr><td colspan=4 align=center>
    <input class="button" type=button value="Add Staff" onclick="goToStaff();">
    <input type=button value="Add Team" class="button" id="opr06sub1"
     onclick="tempDisable(this);AddTeam();">
    <input type=button value="Change Theatre" class="Bigbutton"
     onclick="ChgOpr();">
    </td>
    <td colspan=4>
    <input type=button value=Update class="button" id="opr06sub2" 
     onclick="tempDisable(this);CheckDefaultTeamCompleted();UpdateTeam();">
    <input type=button value=Delete class="button" onclick="DeleteTeam();">
    <input type=button value=Cancel class="button" onclick="RefreshPage();">
</td></tr>
</table>
</form>

<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows() {
%OPRWEB06.01.329
%OPRWEB06.01.360
CorrectCount = "%OPRWEB06.01.340";
UpdateForm.opsrg008.selectedIndex = CorrectCount; 
}
</script>

<form name=PatientLinks id=PatientLinks method=get>
<input type=hidden name=reportno id=reportno value=1>
<input type=hidden name=template id=template value=001>
<input type=hidden name=urnumber id=urnumber value='%OPRWEB06.01.003'>
<input type=hidden name=admissno id=admissno value='%OPRWEB06.01.081'>
<input type=hidden name=MenuType id=MenuType value='%OPRWEB06.01.088'>
<input type=hidden name=casekeys id=casekeys value='%OPRWEB06.01.101'>
<input type=hidden name=sesskeys id=sesskeys value='%OPRWEB06.01.102.oprweb01.03.003'>
<input type=hidden name=uniqueky id=uniqueky value='%OPRWEB06.01.110'>
<input type=hidden name=teamnumb id=teamnumb value='%OPRWEB06.01.334'>
</form>

<script type="text/javascript">
if (document.UpdateForm.suprlevl!=undefined) {
  if (document.ShowActionMenu.sactions!=undefined) {
    if (document.UpdateForm.suprlevl.value=="S") {
      document.ShowActionMenu.sactions.disabled=true;
    }
  }
}

if ("%OPRWEB06.01.271" == "Yes") {
  document.UpdateForm.ovrnight.checked=1;
}
</script>
