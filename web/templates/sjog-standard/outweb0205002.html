<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="sjog-standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/OutExtraTemplates.js"></script>
<script type="text/javascript" src="../js/outweb0205.js"></script>
<script type="text/javascript">

var SlotCode;
var SlotDate;
var SlotName;

function defaultDisasterCode() {
  if (document.AddForm.ptcnudpd.value!="1") {return;}

  if (!isWhitespace(document.AddForm.disacode.value)) {
    document.getElementById("disastercodetitleDIV").innerHTML=
    document.getElementById("disastercodetitleSPAN").innerHTML;
    document.getElementById("disastercodeDIV").innerHTML=
    document.getElementById("disastercodeSPAN2").innerHTML;
  } else {
    document.getElementById("disastercodetitleDIV").innerHTML=
    document.getElementById("disastercodetitleSPAN").innerHTML;
    document.getElementById("disastercodeDIV").innerHTML=
    document.getElementById("disastercodeSPAN1").innerHTML;
  }

  displayDisasterID();

}
function displayDisasterID() {
 p=document.AddForm
  if (!isWhitespace(document.AddForm.dispt001.value)) {
    document.getElementById("disasteridnumbertitleDIV").innerHTML=
    document.getElementById("disasteridnumbertitleSPAN").innerHTML;
    document.getElementById("disasteridnumberDIV").innerHTML=
    document.getElementById("disasteridnumberSPAN").innerHTML;
  } else {
    document.getElementById("disasteridnumbertitleDIV").innerHTML="";
    document.getElementById("disasteridnumberDIV").innerHTML="";
  }

  if (!isWhitespace(disasteridnumberDIV.innerHTML)) {
    var serverURL   = "../cgi-bin/patweb80.pbl?reportno=98" +
                    "&valdcode=" + AddForm.urnumber.value.replace(/ /g,"+") +
                    AddForm.dispt001.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status==0) {
      ReturnValue=returnValue.return_value.split("|");
      if (!isWhitespace(ReturnValue[0])) {
        p.dispt002.value=ReturnValue;
        p.dispt002.className="Readonly";
        p.dispt002.readOnly=true;
      }
    }
  }
}

function updateParent(code,name,date,vist,clintcd,clintdes,clinind,clinbst,hic
                      ,carer,letdays,nmds,caret,servd,hrisk,isOverBooked,tier
                      ,mandref,msttier) {
    SlotCode=code
    SlotDate=date
    SlotName=name

    //Clinic Indicator
    if (typeof(AddForm)=='object' && typeof(AddForm.clinindc)=='object') {
      AddForm.clinindc.value=clinind;
    }

    //go to the server for a new set of clinic list that
    //are overbooked

    var clinicVisitList = null;

    if(typeof AddForm != 'undefined') {
      if(typeof AddForm.outbb047 != 'undefined') {
        clinicVisitList = AddForm.outbb047;
      }
    }else if(typeof AddForm != 'undefined' ){
      if(typeof AddForm.outbb047 != 'undefined') {
        clinicVisitList = AddForm.outbb047;
      }
    }

    if(clinicVisitList != null) {
      var data = RSExecute("../cgi-bin/comweb80.pbl?reportno=61&valdcode=CV");
      if(typeof data  != 'undefined'){
        if(data != null) {
          patcodes = eval("("+data.return_value+")");
          //if we get this far lets recreate the clinic visit list

          clinicVisitList.innerHTML = "";
          var option = document.createElement('option');
          option.value = "                 ";
          option.innerHTML = "             ";
          clinicVisitList.appendChild(option);

          if(isOverBooked == "Z") {
            for(var i = 0; i < patcodes.length; i++) {
              if(typeof patcodes[i] != "undefined" && patcodes[i] != null) {
                if( patcodes[i].indicators.substring(2,1) == isOverBooked ) {
                  if( trim(patcodes[i].indicators.substring(6,1)) != "U" ) {
                    var option = document.createElement('option');
                    option.value = patcodes[i].acode+patcodes[i].indicators;
                    option.innerHTML = patcodes[i].tdesc;
                    clinicVisitList.appendChild(option);
                  }
                }
              }
            }
          }else {
            for(var i = 0; i < patcodes.length; i++) {
              if(typeof patcodes[i] != "undefined" && patcodes[i] != null) {
                if( trim(patcodes[i].indicators.substring(6,1)) != "U" ) {
                  var option = document.createElement('option');
                  option.value = patcodes[i].acode+patcodes[i].indicators;
                  option.innerHTML = patcodes[i].tdesc;
                  clinicVisitList.appendChild(option);
                }
              }
            }
          }
        }
      }
    }

    var sendLetter = null;

    if(typeof AddForm != 'undefined') {
      sendLetter = AddForm.outbb047;
    }else if(typeof UpdateForm != 'undefined') {
      sendLetter = UpdateForm.outbb047;
    }

    if(sendLetter != null && typeof sendLetter.onchange != 'undefined') {
     setTimeout(function(){ sendLetter.onchange();},200);
    }

    //New Slot key
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.nslotkey)=='object') {
           AddForm.nslotkey.value=code;
        }

    //visit type
     if(typeof(AddForm)=='object' && AddForm.outbb047.type=='select-one') {
         for (var i =0 ; i < AddForm.outbb047.length; i++) {
         if (trim(AddForm.outbb047.options[i].value.substr(0,3))==trim(vist)) {
           AddForm.outbb047.selectedIndex=i }
         }
        }
    //////
     if(typeof(UpdateForm)=='object' &&
        typeof(UpdateForm.outbb047)=='object') {
       if(UpdateForm.outbb047.type=='select-one') {
         for (var i =0 ; i < UpdateForm.outbb047.length; i++) {
         if (trim(UpdateForm.outbb047.options[i].value.substr(0,3))==trim(vist)) {
           UpdateForm.outbb047.selectedIndex=i }
         }
       }
     }

    /////
    // Added for diagnosis search
    //
    if (typeof(parent.AddForm)=='object' &&
       typeof(parent.AddForm.defclnty)=='object') {
           parent.AddForm.defclnty.value=clintcd;
        }
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.defclnty)=='object') {
           AddForm.defclnty.value=clintcd;
    }
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.outbb016)=='object') {
       AddForm.outbb016.value=clintcd;
    }
    if (typeof(parent.UpdateForm)=='object' &&
       typeof(parent.UpdateForm.defclnty)=='object' &&
       typeof(parent.UpdateForm.follflag)=='object') {
         parent.UpdateForm.defclnty.value=clintcd;
    }
    if (typeof(UpdateForm)=='object' &&
       typeof(UpdateForm.defclnty)=='object' &&
       typeof(UpdateForm.follflag)=='object') {
         UpdateForm.defclnty.value=clintcd;
    }
    if (typeof(UpdateForm)=='object' &&
       typeof(UpdateForm.outbb016)=='object' &&
       typeof(UpdateForm.follflag)=='object') {
         UpdateForm.outbb016.value=clintcd;
    }
    //
    // Clinic using medclaims
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.otmaumci)=='object') {
           AddForm.otmaumci.value=hic;
    }
    //
    // Collect Carer Details
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.otheccar)=='object') {
           AddForm.otheccar.value=carer;
    }
    //
    // Generate letter days
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.othendps)=='object') {
       AddForm.othendps.value=letdays;
    }
    if (typeof(UpdateStatus)=='object' &&
       typeof(UpdateStatus.othendps)=='object') {
       UpdateStatus.othendps.value=letdays;
    }

    // NMDS Code AddForm
    if (typeof(AddForm)=='object' &&
       typeof(AddForm.outbb068)=='object') {
         for (var i =0 ; i < AddForm.outbb068.length; i++) {
             if (trim(AddForm.outbb068.options[i].value.substr(0,3))==
                 trim(nmds)) {
                 AddForm.outbb068.selectedIndex=i }
         }
    }

    // Care Type AddForm
   if (typeof(AddForm)=='object' &&
     typeof(AddForm.outbb069)=='object') {
       for (var i =0 ; i < AddForm.outbb069.length; i++) {
       if (trim(AddForm.outbb069.options[i].value.substr(0,3))==
           trim(caret)) {
           AddForm.outbb069.selectedIndex=i }
       }
   }
   // Service Delivery AddForm
   if (typeof(AddForm)=='object' &&
     typeof(AddForm.outbb070)=='object') {
     for (var i =0 ; i < AddForm.outbb070.length; i++) {
       if (trim(AddForm.outbb070.options[i].value.substr(0,3))==
         trim(servd)) {
         AddForm.outbb070.selectedIndex=i
       }
     }
   }

  // Clinical High Risk AddForm
  if (typeof(AddForm)=='object' &&
    typeof(AddForm.d_outbb071)=='object') {
      if(hrisk=="1") {
        AddForm.d_outbb071.checked=true;
        AddForm.d_outbb071.disabled=true;
      } else {
        AddForm.d_outbb071.checked=false;
        AddForm.d_outbb071.disabled=false;
      }
  }

  // Clinical High Risk UpdateForm
  if (typeof(UpdateForm)=='object' &&
    typeof(UpdateForm.outbb071)=='object') {
      if(hrisk=="1") {
        UpdateForm.outbb071.checked=true;
        UpdateForm.outbb071.disabled=true;
      } else {
        UpdateForm.outbb071.disabled=false;
      }
  }

  // Clinical High Risk UpdateForm
  if (typeof(UpdateForm)=='object' &&
   typeof(UpdateForm.d_outbb071)=='object') {
      if(hrisk=="1") {
        UpdateForm.d_outbb071.checked=true;
        UpdateForm.d_outbb071.disabled=true;
      } else {
        UpdateForm.d_outbb071.disabled=false;
      }
  }

  // Tier 2 Code AddForm from MasterClinic
  if (typeof(AddForm)=='object' &&
    typeof(AddForm.d_otmatcod)=='object' &&
        typeof(AddForm.outbb072)=='object') {
        if(AddForm.outbb072.type=="hidden" &&
           AddForm.outbb072.value=="") {
            AddForm.outbb072.value=msttier;
      }
  }
  // Tier 2 Code AddForm from Slottemplate
  if (typeof(AddForm)=='object' &&
    typeof(AddForm.outbb072)=='object') {
       if(AddForm.outbb072.type=="hidden") {
         AddForm.outbb072.value=trim(tier);
      }
  }

  // Generate letter days
  if (typeof(UpdateForm)=='object' &&
    typeof(UpdateForm.othendps)=='object') {
       UpdateForm.othendps.value=letdays;
  }
  //
  // Generate letter days
  if (typeof(Reschedule)=='object' &&
   typeof(Reschedule.othendps)=='object') {
       Reschedule.othendps.value=letdays;
  }
  //
  //Dummy hidden field for visit type
  if (typeof(AddForm)=='object' &&
    typeof(AddForm.d_outbb047)=='object') {
       AddForm.d_outbb047.value=trim(vist);
  }
  //
  //Dummy hidden field for visit type
  if (typeof(UpdateForm)=='object' &&
    typeof(UpdateForm.d_outbb047)=='object') {
       UpdateForm.d_outbb047.value=trim(vist);
       if(typeof(SendLetterDNA03)== 'function'){
         ReturnDate.value=SlotDate
         SendLetterDNA03();
       }
  }
  //
  //Dummy hidden field for visit type
  if (typeof(Reschedule)=='object' &&
    typeof(Reschedule.d_outbb047)=='object') {
       Reschedule.d_outbb047.value=trim(vist);
       if(typeof(SendLetterRSH02)== 'function'){
         ReturnDate.value=SlotDate
         SendLetterRSH02();
       }
  }
  //
  //Dummy hidden field for visit type
  if (typeof(UpdateStatus)=='object' &&
    typeof(UpdateStatus.d_outbb047)=='object') {
       UpdateStatus.d_outbb047.value=trim(vist);
       if(typeof(SendLetterRSH01)== 'function'){
         ReturnDate.value=SlotDate
         SendLetterRSH01();
       }
  }
  //
  reserveSlot(code,"","","",UpdatePage)
}
function UpdatePage() {
  document.AddForm.newslotk.value=SlotCode
  document.AddForm.clindesc.value=SlotName
  document.AddForm.clindate.value=SlotDate
  document.getElementById('PopUpScreen').style.display="none"
}


//-----------------------------------------------------------------
// Function To check Referral Letters
//-----------------------------------------------------------------
function checkRefLetter(urnumber) {
  if (isWhitespace(urnumber)) return;;
  ReturnFunction="" ;
  for (var i=1; i < checkRefLetter.arguments.length; i++) {
   if (typeof(checkRefLetter.arguments[i]) == 'function') {
     ReturnFunction=checkRefLetter.arguments[i] } }
  var serverURL = "../cgi-bin/outweb02.pbl?reportno=9&updatety=6" +
                  "&urnumber="+urnumber.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  ReturnValue=returnValue.return_value.split("|");
  if (returnValue.status==0) {

    if (ReturnValue[0] == 1) {    // Unbooked referral exists
 
      // Construct warning message
      if (isWhitespace(ReturnValue[1])) 
        { ReturnValue[1] = "Unknown Date"; }
      if (isWhitespace(ReturnValue[2])) 
        { ReturnValue[2] = "Unknown"; }
      if (isWhitespace(ReturnValue[3])) 
        { ReturnValue[3] = "Unknown"; }
      var message = "Warning : Referral Letter Exists for " + ReturnValue[1] +
                    "; Clinic Type " + ReturnValue[2] + "; Clinic Id " +
                    ReturnValue[3] + "\nClick OK to continue " +
                    "without selecting the letter, Cancel to select letter.";

      ans=confirm(message)
      if (!ans) { 
        DFrameExit();
        PatientLinkTo("allweb02.pbl",2,22,0,0,0);
      }
    }

    if (typeof(ReturnFunction) == 'function') { ReturnFunction() } 
  }
}

function SubmitFinal() {
   p=document.AddForm
  if(p.otcnureq.value == "1") {
    if(!CheckAppRequest(p.urnumber,p.newslotk,p.outbb022,p.refrlvis,p.requestk)) {
      return;
    }
  }
  setRedirect()
  if (!validateMandatory(AddForm)) {
     return;
  }
  p=document.AddForm
  p.dummydat.value=p.clindate.value.substr(4,11);
  validateSuspension(p.urnumber,p.dummydat,p.datefrom,p.dateto);
  if(p.datefrom.value!='0'){
       ans=confirm("Warning : Patient has a Suspension record for period \n" +
             "\t" + p.datefrom.value  + " - " + p.dateto.value);
       if (ans!=true) {
          return; }
  }
//
  if (document.AddForm.dispt001!=undefined &&
      !isWhitespace(document.AddForm.dispt001.value)) {
    var serverURL   = "../cgi-bin/comweb80.pbl?reportno=44" +
                    "&valdcode=" + AddForm.dispt001.value.replace(/ /g,"+") +
                    AddForm.clindate.value.substr(4,11).replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {
      return;
    }
  }
//
  if(AddForm.bookflag.value == 2) {               // Check if referral is valid
    AddForm.checkdat.value=AddForm.clindate.value.substr(4,11);

    if(!CheckDateRange(AddForm.refrdate,AddForm.checkdat)) {
       alert("Invalid referral date range for this booking.");
       return;
    }
    if(!isWhitespace(AddForm.refrexpd.value)) {
      if(!CheckDateRange(AddForm.checkdat,AddForm.refrexpd)) {
        alert("Invalid referral date range for this booking.");
        return;
      }
    }
    AddForm.submit() ;
  } else {
      AddForm.submit() 
  }
}
function setRedirect() {
  if (document.AddForm.ptcnxcom != undefined) {
    if (document.AddForm.ptcnxcom.value == "1") {
      setRedirectXCom();
      return;
    }
  }

  strTemplate="" ;
  scrName="";
  checkInd=document.AddForm.outbb002.value.substr(3,5)
  if(checkInd.search(/W/g) >= 0) {
    strTemplate="041";
    scrName="WC";}
  if(checkInd.search(/M/g) >= 0) {
    strTemplate="042";
    scrName="TAC";}
  if(checkInd.search(/V/g) >= 0) {
    strTemplate="043";
    scrName="VA";}
  if(checkInd.search(/D/g) >= 0) {
    strTemplate="081";
    scrName="DF";}
  checkInd=document.AddForm.outbb002.value.substr(8,1)
  if(checkInd.search(/C/g) >= 0) {
    strTemplate="048";
    scrName="CT";}
  if (strTemplate=="") {
    if ((document.AddForm.ptcnueoc.value==1) &&
        (document.AddForm.outbb002.value.substr(5,1)=='A')) {
      scrName="ACC";
      document.AddForm.redirect.value="eocweb01.pbl?reportno=1&template=006"
        + "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
        + "&returncd=OUT";
    }
    else {
      document.AddForm.redirect.value="outweb02.pbl?reportno=3&template=1" +
                                      "&shwprint=1" 
    if (!isWhitespace(document.AddForm.waitflag.value)) {
    document.AddForm.redirect.value=document.AddForm.redirect.value +
               "&waitflag=" + document.AddForm.waitflag.value
    }
    }
  }
  else {
    document.AddForm.redirect.value="patweb89.pbl?reportno=01" +
               "&template=" + strTemplate +
               "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")  
    if (!isWhitespace(document.AddForm.waitflag.value)) {
    document.AddForm.redirect.value=document.AddForm.redirect.value +
               "&waitflag=" + document.AddForm.waitflag.value
    }
  }
  if(chkExtraTempl(document.AddForm,"B",document.AddForm.newslotk.value,
                PatientLinks.urnumber.value.replace(/ /g,"+"),scrName)) {
    document.AddForm.redirect.value = document.AddForm.redirect.value +
                                      "&shwprint=1"
  }
}
function setRedirectXCom() {
  strTemplate="" ;
  scrName="";
  checkComp=document.AddForm.outbb002.value.substr(3,1)
    if (checkComp=="D") {
     strTemplate="081";
     scrName="DF";}
    if (checkComp=="A") {
     strTemplate="240";
     scrName="AD"; }
   if (checkComp=="O") {
     strTemplate="241";
     scrName="OD"; }
   if (checkComp=="M") {
     strTemplate="242";
     scrName="MV"; }
   if (checkComp=="F") {
     strTemplate="243";
     scrName="FD"; }
   if (checkComp=="H") {
     strTemplate="244";
     scrName="PR"; }
   if (checkComp=="S") {
     strTemplate="245";
     scrName="SH"; }
   if (checkComp=="V") {
     strTemplate="246";
     scrName="WV"; }
   if (checkComp=="W") {
     strTemplate="247";
     scrName="WW"; }
   if (checkComp=="E") {
     strTemplate="248";
     scrName="OS"; }
   if (checkComp=="G") {
     strTemplate="249";
     scrName="OV"; }

  if (strTemplate=="") {
    if ((document.AddForm.ptcnueoc.value==1) &&
        (document.AddForm.outbb002.value.substr(5,1)=='A')) {
      scrName="ACC";
      document.AddForm.redirect.value="eocweb01.pbl?reportno=1&template=006"
        + "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
        + "&returncd=OUT";
    }
    else {
      document.AddForm.redirect.value="outweb02.pbl?reportno=3&template=1" +
                                      "&shwprint=1"
    if (!isWhitespace(document.AddForm.waitflag.value)) {
    document.AddForm.redirect.value=document.AddForm.redirect.value +
               "&waitflag=" + document.AddForm.waitflag.value
    }
    }
  }
  else {
    document.AddForm.redirect.value="patweb89.pbl?reportno=01" +
               "&template=" + strTemplate +
               "&urnumber=" + PatientLinks.urnumber.value.replace(/ /g,"+")
    if (!isWhitespace(document.AddForm.waitflag.value)) {
    document.AddForm.redirect.value=document.AddForm.redirect.value +
               "&waitflag=" + document.AddForm.waitflag.value
    }
  }
  if(chkExtraTempl(document.AddForm,"B",document.AddForm.newslotk.value,
                PatientLinks.urnumber.value.replace(/ /g,"+"),scrName)) {
    document.AddForm.redirect.value = document.AddForm.redirect.value +
                                      "&shwprint=1"
  }
}

function ClinicSearch() {
   if (!isWhitespace(AddForm.newslotk.value)) {
     cancelSlot(AddForm.newslotk.value,ClinicSearchLink)
   }
}
function ClinicSearchLink() {
    if(!isWhitespace(AddForm.defclnty.value)) {
      AddForm.outbb016.value=AddForm.defclnty.value
    } else {
      AddForm.outbb016.value=trim(AddForm.outbb016.value)
    }
   AddForm.srchclid.value=AddForm.defclnid.value;
   window.ReturnFunction="" ;
   window.ReturnFunction=DisplayXCmbs;
   ClinicSearchFrame(AddForm.newslotk,AddForm.clindesc,AddForm.clindate, 
        AddForm.outbb016,AddForm.srchclid,AddForm.defvisty,
        AddForm.deftovrd,AddForm.refrlvis)
}
function AppointSearch() {
   if (!isWhitespace(AddForm.newslotk.value)) {
     cancelSlot(AddForm.newslotk.value,AppointSearchLink)
   }
}
function AppointSearchLink() {
   window.ReturnFunction="" ;
   window.ReturnFunction=DisplayXCmbs;
   AppointmentSearchFrame(AddForm.newslotk,AddForm.clindesc,AddForm.clindate,
                AddForm.defclnty,AddForm.defclnid,AddForm.defvisty,
                AddForm.deftovrd,AddForm.refrlvis);
}
function OpenSearchPage() {

  if (GetCookieData("appointmentkeycookie") != "unknown" &&
      !isWhitespace(GetCookieData("appointmentkeycookie"))) {
    appointmentkeycookie = GetCookieData("appointmentkeycookie").split("|");
    ExpireCookiePath("appointmentkeycookie");
    ExpireCookiePath("AppointmentTypeCookie");
    updateParent(appointmentkeycookie[0],appointmentkeycookie[1],
                 appointmentkeycookie[2],appointmentkeycookie[3],
                 appointmentkeycookie[4],appointmentkeycookie[5],
                 appointmentkeycookie[6],appointmentkeycookie[7],
                 appointmentkeycookie[8],appointmentkeycookie[9],
                 appointmentkeycookie[10],appointmentkeycookie[11],
                 appointmentkeycookie[12],appointmentkeycookie[13],
                 appointmentkeycookie[14],appointmentkeycookie[15]);
  } else {


  if(AddForm.otcncsum.value=="1") {
    if(!isWhitespace(AddForm.defclnty.value)) {
      AddForm.outbb016.value=AddForm.defclnty.value
    } else {
      AddForm.outbb016.value=trim(AddForm.outbb016.value)
    }
    AddForm.srchclid.value=AddForm.defclnid.value;
    window.ReturnFunction="" ;
    window.ReturnFunction=DisplayXCmbs;
    ClinicSearchFrame(AddForm.newslotk,AddForm.clindesc,AddForm.clindate, 
                      AddForm.outbb016,AddForm.srchclid,AddForm.defvisty,
                      AddForm.deftovrd,AddForm.refrlvis)
  } else {
    AppointmentSearchFrame(AddForm.newslotk,AddForm.clindesc,AddForm.clindate,
                           AddForm.defclnty,AddForm.defclnid,AddForm.defvisty,
                           AddForm.deftovrd,AddForm.refrlvis);
  }
  }
}
</script>
%START.OF.PAGE
<script type="text/javascript">
function SetAppointDefaults(refletter) {
  if (refletter == 1) {  // New Appointment from Refferal Letters
    document.AddForm.defclnty.value="%OUTWEB02.05.327.1";
    document.AddForm.defclnid.value="%OUTWEB02.05.304.1";
    document.AddForm.outbb013.value="%OUTWEB02.05.307.3";
    document.AddForm.outbb029.value="%OUTWEB02.05.302.001";
    document.AddForm.name_outbb029.value="%OUTWEB02.05.302.081";
    document.AddForm.pmsvx052.value="%OUTWEB02.05.306";
  } else if (refletter == 2) {
    document.AddForm.defclnty.value="%OUTWEB02.05.353.067.1";
    document.AddForm.defclnid.value="%OUTWEB02.05.353.088.1";
    document.AddForm.defvisty.value="%OUTWEB02.05.353.095";
    document.AddForm.defclaim.value="%OUTWEB02.05.353.035.1";
    document.AddForm.defprob1.value="%OUTWEB02.05.353.028.0";
    document.AddForm.defprob2.value="%OUTWEB02.05.353.029.0";
    document.AddForm.defprob3.value="%OUTWEB02.05.353.030.0";
    document.AddForm.outbb045.value="%OUTWEB02.05.353.031.1";
    document.AddForm.outbb046.value="%OUTWEB02.05.353.031.0";
    document.AddForm.outbb055.value="%OUTWEB02.05.353.032.1";
    document.AddForm.outbb056.value="%OUTWEB02.05.353.032.0";
    document.AddForm.outbb057.value="%OUTWEB02.05.353.033.1";
    document.AddForm.outbb058.value="%OUTWEB02.05.353.033.0";
    for (var i=0; i < document.AddForm.outbb002.length; i++) {
     if (document.AddForm.outbb002.options[i].value.substr(0,3)==
         document.AddForm.defclaim.value.substr(0,3)){
         document.AddForm.outbb002.selectedIndex=i;
     }
    }
//    document.AddForm.outbb013.value="%OUTWEB02.05.353.027.3";
    var priority = "%OUTWEB02.05.353.027.3";
    for (var i=0; i < document.AddForm.outbb013.length; i++) {
      if (document.AddForm.outbb013.options[i].value.substr(0,3)==
          priority.substr(0,3)){
          document.AddForm.outbb013.selectedIndex=i;
      }
    }
//
    var sourceofref="%OUTWEB02.05.353.034.3";
    for (var i=0; i < document.AddForm.outbb001.length; i++) {
     if (document.AddForm.outbb001.options[i].value.substr(0,3)==
         sourceofref.substr(0,3)){
         document.AddForm.outbb001.selectedIndex=i;
     }
    }
//
    document.AddForm.outbb029.value="%OUTWEB02.05.353.022.1";
    document.AddForm.name_outbb029.value="%OUTWEB02.05.353.022.0";
    document.AddForm.pmsvx052.value="%OUTWEB02.05.353.081";
    var problems="";
    if(!isWhitespace(document.AddForm.defprob1.value)) {
       problems+=trim(document.AddForm.defprob1.value);
    }
    if(!isWhitespace(document.AddForm.defprob2.value)) {
      if(problems!="") { problems+=" ; ";}
      problems+=trim(document.AddForm.defprob2.value);
    }
    if(!isWhitespace(document.AddForm.defprob3.value)) {
      if(problems!="") { problems+=" ; ";}
       problems+=trim(document.AddForm.defprob3.value);
    }
    document.AddForm.outptcom.value=problems
  } else if (refletter == 3) {              // Appointment Request
    document.AddForm.slotbtyp.value="2";
    document.AddForm.defclnty.value="%OUTWEB02.05.362.010.1"; // Clinic Type
    document.AddForm.defclnid.value="%OUTWEB02.05.362.011.1"; // Clinic Id
    document.AddForm.defvisty.value="%OUTWEB02.05.362.012.1"; // Slot Type
    document.AddForm.outbb013.value="%OUTWEB02.05.362.016.3"; // Priority
    document.AddForm.defclaim.value="%OUTWEB02.05.362.015.1"; // Claim Code
    for (var i=0; i < document.AddForm.outbb002.length; i++) {
     if (document.AddForm.outbb002.options[i].value.substr(0,3)==
         document.AddForm.defclaim.value.substr(0,3)){
         document.AddForm.outbb002.selectedIndex=i;
     }
    }
    document.AddForm.pmsvx052.value="%OUTWEB02.05.362.014";   // Presenting C
    document.AddForm.outbb023.value="%OUTWEB02.05.362.013.3"; // Transport
    document.AddForm.outbb054.value="%OUTWEB02.05.362.018.3"; // Special Arr
    document.AddForm.outbb001.value="%OUTWEB02.05.362.017.3"; // Source of Ref
    document.AddForm.outbb022.value="%OUTWEB02.05.362.006.3"; // Unit
    document.AddForm.outptcom.value=document.getElementById("apprcomm").value;
    document.AddForm.outbb029.value="%OUTWEB02.05.353.022.1";
    document.AddForm.name_outbb029.value="%OUTWEB02.05.353.022.0";
  } else {
    if(document.AddForm.waitflag.value=="1") {
      document.AddForm.defclnty.value="%STANDARD.01.025.111.012.0.6";
      document.AddForm.outbb002.value="%OUTWEB02.05.256.3";
      document.AddForm.outptcom.value="%OUTWEB02.05.257";
    }
    if(document.AddForm.waitflag.value=="2") {
      document.AddForm.defclnty.value="%STANDARD.01.025.111.018.0.6";
      document.AddForm.outbb002.value="%OUTWEB02.05.256.3";
      document.AddForm.outptcom.value="%OUTWEB02.05.257";
    }
    if(document.AddForm.defclnty.value=="000000") {
       document.AddForm.defclnty.value="        ";
    }
    checkRefLetter(document.AddForm.urnumber.value);
  }
  document.AddForm.pmsvx052.value=trim(document.AddForm.pmsvx052.value);
}
function valClaimCode() {
  if(document.AddForm.bookflag.value=="2") {
    if(!isWhitespace(document.AddForm.defclaim.value)) {
    return;
    }
  }
  if(document.AddForm.bookflag.value=="3") {
    if(!isWhitespace(document.AddForm.defclaim.value)) {
    return;
    }
  }
  validateCode(41,AddForm.urnumber,AddForm.claimc);
  for (var i =0 ; i < document.AddForm.outbb002.length; i++) {
    if (document.AddForm.claimc.value==
        trim(document.AddForm.outbb002.options[i].value.substr(0,3))){
          document.AddForm.outbb002.selectedIndex=i;
    }
  }
}

function dispAttendingDrNSW(){
 //Show Attending doctor field for NSW only
 if (document.getElementById('ptcnhdps').value == '2'){
    nswAttendingDoctorDL.innerHTML=nswAttendingDoctorLabel.innerHTML;
    nswAttendingDoctorDF.innerHTML=nswAttendingDoctorData.innerHTML;
 }
 else {
    nswAttendingDoctorDL.innerHTML=blankSPAN.innerHTML;
    nswAttendingDoctorDF.innerHTML=blankSPAN.innerHTML;
 }

}
</script>
</head>
<body onload="PageLoad(event);clrFields();valClaimCode();
      SetAppointDefaults(%OUTWEB02.05.214);
      OpenSearchPage();defaultDisasterCode();dispAttendingDrNSW();">         
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Make New Appointment
</span>

<div id=PageBodySection style="overflow: auto;">

<form name=AddForm action=outweb02.pbl method=post style="margin:0"
 onsubmit='return validateMandatory(this)'>
<input type=hidden name=reportno value="06">
<input type=hidden name=template value="004">
<input type=hidden name=urnumber value="%OUTWEB02.05.003">
<input type=hidden name=updatety value="5">
<input type=hidden name=nextpage value="6">
<input type=hidden name=redirect value="">
<input type=hidden name=defclnty value="%OUTWEB02.05.108">
<input type=hidden name=defclnid value="%OUTWEB02.05.103.0">
<input type=hidden name=defvisty value="%OUTWEB02.05.110.1">
<input type=hidden name=defclaim value="">
<input type=hidden name=dummy    value="">
<input type=hidden name=dummydat value="">
<input type=hidden name=outbb016 value="" >
<input type=hidden name=srchclid value="%OUTWEB02.05.103.0">
<input type=hidden name=bookflag value="%OUTWEB02.05.214">
<input type=hidden name=admissno value="%OUTWEB02.05.081">
<input type=hidden name=refrlvis value="%OUTWEB02.05.353.001">
<input type=hidden name=refrdate value="%OUTWEB02.05.353.019">
<input type=hidden name=refrexpd value="%OUTWEB02.05.353.087">
<input type=hidden name=refrclin value="%OUTWEB02.05.353.088.1">
<input type=hidden name=refrctyp value="%OUTWEB02.05.353.067.1">
<input type=hidden name=tmplredi value="">
<input type=hidden name=ptcnueoc value="%OUTWEB02.05.216">
<input type=hidden name=clinctyp value="%OUTWEB02.05.205.1">
<input type=hidden name=claimc>
<input type=hidden name=waitlkey value="%OUTWEB02.05.219">
<input type=hidden name=waitflag value="%OUTWEB02.05.220">
<input type=hidden name=otcncsum value="%OUTWEB02.05.222">
<input type=hidden name=checkdat value="">
<input type=hidden name=dumdate value="">
<input type=hidden name=dumInput value="">
<input type=hidden name=clinindc value="">
<input type=hidden name=ptcnuebb value="%STANDARD.01.025.127.122.0.1">
<input type=hidden name=dateclin value="%OUTWEB02.05.104">
<input type=hidden name=nslotkey value="">
<input type=hidden name=ibcnumci value="%STANDARD.01.025.000.132.0.1">
<input type=hidden name=otmaumci value="">
<input type=hidden name=otheccar value="">
<input type=hidden name=datefrom>
<input type=hidden name=dateto>
<input type=hidden name=deftovrd value="">
<input type=hidden name=defprob1 value="">
<input type=hidden name=defprob2 value="">
<input type=hidden name=defprob3 value="">
<input type=hidden name=requestk value="%OUTWEB02.05.362.041">
<input type=hidden name=otcnureq value="%STANDARD.01.025.032.136.0.1">
<input type=hidden name=othendps value="%OUTWEB02.05.258">
<input type=hidden name=currdate value="%STANDARD.01.015">
<input type=hidden name=ptcnxcom value="%STANDARD.01.025.116.222.0.1">
<input type=hidden name=outbb072 value="%OUTWEB02.05.240.047.1">
<input type=hidden name=d_otmatcod value="">
<input type=hidden name=slotbtyp value="1">
<input type=hidden name=disacode value="%OUTWEB02.05.264">
<input type=hidden name=disadesc value="%OUTWEB02.05.278">
<input type=hidden name=ptcnudpd value="%STANDARD.01.025.118.153.0.1">
<input type=hidden name=ptcnhdps id=ptcnhdps
                                 value="%STANDARD.01.025.080.250.1.1">

<table cellspacing=0 cellpadding=0 border=0 width=95% align=center >
<tr><td class=DataLabel width=15%>Clinic</td>
    <td class=DataField>
    <input type=hidden name=newslotk value="DEFAULT">
    <input type=text size=25 name=clindesc class=Mandatory title="Clinic"
       readonly value="%OUTWEB02.05.103.1">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="AppointSearch();">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="ClinicSearch();"></td>
    <td class=DataLabel>Date</td>
    <td class=DataField>
    <input type=text size=30 name=clindate class=Mandatory title="date"
     readonly value="%OUTWEB02.05.113 %OUTWEB02.05.104 %OUTWEB02.05.107">
    </td></tr>

<tr><td class=DataLabel>Visit Type</td>
    <td class=DataField colspan=3>
    <select name=outbb047 title="Visit Type" class="SelectBig Mandatory"
     onchange="DisplayXCmbs();">
    <option> </option>
    %OUTWEB02.05.199
    </select>
    </td></tr>

<tr valign=top>
    <td class=DataLabel>Presenting Complaint</td>
    <td class=DataField colspan=3>
    <input type=text name=pmsvx052 size=50 maxlength=50 value="">
    </td></tr>

<tr valign=top>
    <td class=DataLabel>Diagnosis</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb045 value=""
     onblur="validateCode(6,AddForm.outbb045,AddForm.outbb046);">
    <input type=text name=outbb046 size=65 maxlength=50
     readonly class=Readonly value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb045,AddForm.outbb046);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb045,AddForm.outbb046);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb055 value=""
     onblur="validateCode(6,AddForm.outbb055,AddForm.outbb056);">
    <input type=text name=outbb056 readonly class=Readonly 
                                   size=65 maxlength=50 value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb055,AddForm.outbb056);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb055,AddForm.outbb056);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb057 value=""
     onblur="validateCode(6,AddForm.outbb057,AddForm.outbb058);">
    <input type=text size=65 maxlength=50 name=outbb058 
                             readonly class=Readonly value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb057,AddForm.outbb058);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb057,AddForm.outbb058);">
    </td></tr>

<tr><td>&nbsp;</td>
    <td class=DataField colspan=3>
    <input type=text size=15 name=outbb059 value=""
     onblur="validateCode(6,AddForm.outbb059,AddForm.outbb060);">
    <input type=text size=65 maxlength=50 name=outbb060 
                                  readonly class=Readonly value="">
    <img src=../images/SearchIcon.gif class=Icon
     onclick="Icd10DisSearchFrame(AddForm.outbb059,AddForm.outbb060);">
    <img src=../images/LookupIcon.gif class=Icon
     onclick="CtypediagSearchFrame(AddForm.outbb059,AddForm.outbb060);">
    </td></tr>

<tr><td class=DataLabel>Transport</td>
    <td class=DataField><select name=outbb023 class=selectBig>
        <option></option>
        %OUTWEB02.05.142.2
        </select></td>
    <td class=DataLabel>Priority</td>
    <td class=DataField><select name=outbb013 class=SelectBig>
	<option></option>
	%OUTWEB02.05.132.2
	</select>
    </td></tr>

<tr><td class=DataLabel>%STANDARD.01.017.CL</td>
    <td class=DataField><select name=outbb002 class="Mandatory SelectBig"
        title="%STANDARD.01.017.CL" onchange="DisplayXCmbs();">
        <option></option>
        %OUTWEB02.05.197.9.1.10.2.X
        </select></td>
    <td class=DataLabel>Unit</td>
    <td class=DataField><select name=outbb022 class="SelectBig"
                         title="Unit">
	<option></option>
	%OUTWEB02.05.141.2
	</select></td></tr>

<tr><td class=DataLabel>Source of Referral</td>
    <td class=DataField><select name=outbb001 class="Mandatory SelectBig"
        title="Source of Referral">
        <option></option>
        %OUTWEB02.05.120.2
        </select></td>
    <td class=DataLabel>Reports Required</td>
    <td class=DataField><select name=outbb017 class=SelectBig>
        <option></option>
        %OUTWEB02.05.136.2
        </select></td></tr>

<tr><td class=DataLabel>NMDS Code</td>
    <td class=DataField><select name=outbb068 class=SelectBig>
        <option></option>
        %OUTWEB02.05.127.004.2
        </select>
    </td>
    <td class=DataLabel>Service Delivery Mode</td>
    <td class=DataField><select name=outbb070 class=SelectBig>
        <option></option>
        %OUTWEB02.05.127.006.2
        </select>
        </td>
    </tr>

<tr> <td class=DataLabel>Care Type</td>
    <td class=DataField><select name=outbb069 class=SelectBig>
        <option></option>
        %OUTWEB02.05.127.005.2
        </select>
    </td>
    <td><div id=nswAttendingDoctorDL></div></td>
    <td><div id=nswAttendingDoctorDF></div></td>
    </tr>

<tr><td class=DataLabel>Special Arrangements</td>
    <td class=DataField><select name=outbb054 class=SelectBig>
    <option> </option>
    %OUTWEB02.05.178.2
    </select></td>
    <td class=DataLabel>Referring GP</td>
    <td class=DataField>
    <input type=hidden name=dummy1 value="6">
    <input type=hidden name=outbb029 >
    <input type=text readonly name=name_outbb029 value="%OUTWEB02.05.148.004" class=Readonly>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="HCPSearchFrame(AddForm.outbb029,AddForm.name_outbb029,AddForm.dummy1.value)">
    <img src="../images/erase.gif" class=Icon 
     onclick="clrFields(AddForm.outbb029,AddForm.name_outbb029);">
    </td></tr>

<tr>
    <td class=DataLabel><div id=disastercodetitleDIV></div></td>
    <td>
    <div id=disastercodeDIV></div>
    </td>
    <td clss=DataLabel><div id=disasteridnumbertitleDIV></div></td>
    <td><div id=disasteridnumberDIV></div></td>
</tr>

<tr><td class=DataLabel>Notify GP</td>
    <td><input type=checkbox value=1 name=outbb036></td></tr>

<tr><td class=DataLabel>Send Letter</td>
    <td><select name=outbb067 title="Send Letter"
         onchange="SendLetterDate(AddForm);">
        <option></option>
        <option value="0">No</option>
        <option value="1">Yes</option>
        <option value="2">N/A</option>
        </select>
    </td>
    <td class=DataLabel>Generate Letter date</td>
    <td><input type=text name=outbb066 size=12
     onblur="checkDate(this,'Date')" value=""
     class="Date" title="Generate Letter Date">
    <img src=../images/DateTimeStamp.gif class=Icon date=AddForm.outbb066
     time=null>
    <img src=../images/DateLookup.gif class=Icon date=AddForm.outbb066>
</td>
</tr>

<tr valign=top><td class=DataLabel>Comments</td>
    <td class=DataField colspan=3>
    <textarea name=outptcom wrap=hard cols=70 rows=3></textarea>
    </td></tr>
</table>

<div id=ShowXCmbs></div>
<div id=ShowCarer></div>

<table border=0 width=95% cellspacing=0 cellpadding=0 align=center>
<tr><td colspan=4 align=center>
    <input type=button class="button" value="Ok" id="out02sub"
    onclick="tempDisable(this);checkSlot(AddForm.newslotk.value,
            AddForm.urnumber.value,SubmitFinal);">
    <input type=button class="button" value="Cancel" onclick='DFrameClose();'>
    </td></tr>
</table>
</form>
</div>

<span id=extracmbs style="display:none">
<table border=0 width=95% cellspacing=0 cellpadding=0 align=center>

<tr><td width=15% class=DataLabel>CMBS Code</td>
    <td class=DataField>
    <input type=hidden name=otbit001 title="Item Type" value="MBS">
    <input type=text size=9 name=otbit002 title="Item Code" value=""
     onchange="validatePMBS(AddForm.otbit002,AddForm.mbsdesc1,
               AddForm.otbit001,AddForm.otbit003,
               AddForm.dateclin,AddForm.mbsamnt1);">
    <input type=text size=3 name=otbit003 title="Sub-Item Code" value=""
     onchange="validatePMBS(AddForm.otbit002,AddForm.mbsdesc1,
               AddForm.otbit001,AddForm.otbit003,
               AddForm.dateclin,AddForm.mbsamnt1);">
    <input type=text size=30 name=mbsdesc1 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt1 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
     onclick="PriMbsSearchFrame(AddForm.otbit001,AddForm.otbit002,
              AddForm.otbit003,AddForm.dumdate,
              AddForm.mbsdesc1,AddForm.dumInput,TypeDesc1);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.otbit002,AddForm.otbit003,
              AddForm.mbsdesc1,AddForm.mbsamnt1,AddForm.otbit016);">
    <input type=text maxlength=20 size=22 name=otbit016 title="Provider Usage" 
     tabindex=91 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit004 title="Item Type 2" value="MBS">
    <input type=text size=9 name=otbit005 title="Item Code 2" value=""
     onchange="validatePMBS(AddForm.otbit005,AddForm.mbsdesc2,
               AddForm.otbit004,AddForm.otbit006,
               AddForm.dateclin,AddForm.mbsamnt2);">
    <input type=text size=3 name=otbit006 title="Sub-Item Code 2" value=""
     onchange="validatePMBS(AddForm.otbit005,AddForm.mbsdesc2,
               AddForm.otbit004,AddForm.otbit006,
               AddForm.dateclin,AddForm.mbsamnt2);">
    <input type=text size=30 name=mbsdesc2 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt2 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick="PriMbsSearchFrame(AddForm.otbit004,AddForm.otbit005,
             AddForm.otbit006,AddForm.dumdate,
             AddForm.mbsdesc2,AddForm.dumInput,TypeDesc2);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.otbit005,AddForm.otbit006,
              AddForm.mbsdesc2,AddForm.mbsamnt2,AddForm.otbit017);">
    <input type=text maxlength=20 size=22 name=otbit017 title="Provider Usage 2"
     tabindex=92 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit007 title="Item Type 3" value="MBS">
    <input type=text size=9 name=otbit008 title="Item Code 3" value=""
     onchange="validatePMBS(AddForm.otbit008,AddForm.mbsdesc3,
               AddForm.otbit007,AddForm.otbit009,
               AddForm.dateclin,AddForm.mbsamnt3);">
    <input type=text size=3 name=otbit009 title="Sub-Item Code 3" value=""
     onchange="validatePMBS(AddForm.otbit008,AddForm.mbsdesc3,
               AddForm.otbit007,AddForm.otbit009,
               AddForm.dateclin,AddForm.mbsamnt3);">
    <input type=text size=30 name=mbsdesc3 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt3 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick="PriMbsSearchFrame(AddForm.otbit007,AddForm.otbit008,
             AddForm.otbit009,AddForm.dumdate,
             AddForm.mbsdesc3,AddForm.dumInput,TypeDesc3);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.otbit008,AddForm.otbit009,
              AddForm.mbsdesc3,AddForm.mbsamnt3,AddForm.otbit018);">
    <input type=text maxlength=20 size=22 name=otbit018 title="Provider Usage 3"
     tabindex=93 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit010 title="Item Type 4" value="MBS">
    <input type=text size=9 name=otbit011 title="Item Code 4" value=""
     onchange="validatePMBS(AddForm.otbit011,AddForm.mbsdesc4,
               AddForm.otbit010,AddForm.otbit012,
               AddForm.dateclin,AddForm.mbsamnt4);">
    <input type=text size=3 name=otbit012 title="Sub-Item Code 4" value=""
     onchange="validatePMBS(AddForm.otbit011,AddForm.mbsdesc4,
               AddForm.otbit010,AddForm.otbit012,
               AddForm.dateclin,AddForm.mbsamnt4);">
    <input type=text size=30 name=mbsdesc4 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt4 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick="PriMbsSearchFrame(AddForm.otbit010,AddForm.otbit011,
             AddForm.otbit012,AddForm.dumdate,
             AddForm.mbsdesc4,AddForm.dumInput,TypeDesc4);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.otbit011,AddForm.otbit012,
              AddForm.mbsdesc4,AddForm.mbsamnt4,AddForm.otbit019);">
    <input type=text maxlength=20 size=22 name=otbit019 title="Provider Usage 4"
     tabindex=94 value="">
    </td>
    </tr>

<tr><td class=DataLabel>&nbsp;</td>
    <td class=DataField>
    <input type=hidden name=otbit013 title="Item Type 5" value="MBS">
    <input type=text size=9 name=otbit014 title="Item Code 5" value=""
     onchange="validatePMBS(AddForm.otbit014,AddForm.mbsdesc5,
               AddForm.otbit013,AddForm.otbit015,
               AddForm.dateclin,AddForm.mbsamnt5);">
    <input type=text size=3 name=otbit015 title="Sub-Item Code 5" value=""
     onchange="validatePMBS(AddForm.otbit014,AddForm.mbsdesc5,
               AddForm.otbit013,AddForm.otbit015,
               AddForm.dateclin,AddForm.mbsamnt5);">
    <input type=text size=30 name=mbsdesc5 value=""
     readonly class=Readonly tabindex=-1>
    <input type=text size=11 name=mbsamnt5 value=""
     readonly class=Readonly tabindex=-1>
    <img src=../images/SearchIcon.gif class=Icon
    onclick="PriMbsSearchFrame(AddForm.otbit013,AddForm.otbit014,
             AddForm.otbit015,AddForm.dumdate,
             AddForm.mbsdesc5,AddForm.dumInput,TypeDesc5);">
    <img src="../images/ClearIcon.gif" class=Icon
     onclick="clrFields(AddForm.otbit014,AddForm.otbit015,
              AddForm.mbsdesc5,AddForm.mbsamnt5,AddForm.otbit020);">
    <input type=text maxlength=20 size=22 name=otbit020 title="Provider Usage 5"
     tabindex=95 value="">
    </td>
    </tr>

<tr><td>Use CMBS Template</td>
    <td><input type=checkbox value=1 name=cmbsload onclick="TemplateCmbs();">
    &nbsp;
    <select class="SelectBig" name=cmbstemp title="CMBS Template"
         onchange="TemplateCmbs();">
          <option></option>
          %OUTWEB02.05.229
          </select></td>
    </tr>

<tr><td>Print Medicare Claims</td>
    <td><input type=checkbox value=1 name=claimprt>
    &nbsp;
    <select class="SelectBig" name=claimpsl title="Printer">
          <option></option>
          %STANDARD.01.001.OUTCLAIM.03
          </select></td>
    <tr>
</table>
</span>

<span id=sendcarer style="display:none">
<table border=0 width=95% cellspacing=0 cellpadding=0 align=center>
<tr><td width=15% class=DataLabel>Send Correspondence to Carer</td>
    <td class=DataField><input type=checkbox value=1 name=outbb065 checked>
    </td></tr>
</table>
</span>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%OUTWEB02.05.003">
<input type=hidden name=admissno value="%OUTWEB02.05.081">
<input type=hidden name=MenuType value="%OUTWEB02.05.088">
<input type=hidden name=casekeys value="%OUTWEB02.05.166">
</form>

<script type="text/javascript">
DisplayXCmbs();
</script>

<span id=disasteridnumbertitleSPAN style="display:none">
Disaster Identification #
</span>

<span id=disasteridnumberSPAN style="display:none">
<input type="text" name=dispt002 size=20 maxlength=19
   tabindex=26 title="Disaster Identification Number">
</span>

<span id=disastercodeSPAN1 style="display:none">
  <select name=dispt001 tabindex=25 title="Disaster Code" class=SelectBig
   onchange="displayDisasterID();">
    <option></option>
    %OUTWEB02.05.260
  </select>
</span>

<span id=disastercodeSPAN2 style="display:none">
<input type="text" name=n_dispt001 size=30 class=Readonly readonly
  title="Disaster Code" value="%OUTWEB02.05.278" tabindex=-1>
<input type=hidden name=dispt001 value="%OUTWEB02.05.264">
</span>

<span id=disastercodetitleSPAN style="display:none">
Disaster Code
</span>

<span id="ApptReqComm" style="display:none">
<textarea name="apprcomm" id="apprcomm" wrap=hard cols=60 rows=3
tabindex=60>%OUTWEB02.05.299.002</textarea>
</span>

<span id=nswAttendingDoctorLabel style="display:none">
    Attending Doctor </span>

<span id=nswAttendingDoctorData style="display:none">
    <input type=text name=outbb006 id=outbb006
     title="Attending Doctor" size=8 maxlength=6
     onblur="validateCode(31,AddForm.outbb006,AddForm.n_outbb006);">
    <input type=text name=n_outbb006 id=n_outbb006 class=ReadOnly readonly
     title="Attending Doctor" size=30>
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="DoctorSearchFrame(AddForm.outbb006,AddForm.n_outbb006);">
    <img src="../images/erase.gif" alt="Clear" class=Icon
     onclick="clrFields(AddForm.outbb006,AddForm.n_outbb006);"></span>

<span id=blankSPAN style="display:none">&nbsp;</span>
