<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="sjog-standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/TableSort.js"> </script>
<script type="text/javascript" src="../js/oprweb06.js"> </script>
<script type="text/javascript">
function showChgSur() {
  caseKeys=document.UpdateForm.casekeys.value.replace(/ /g,"+");
  teamNumb=document.UpdateForm.teamnumb.value;
  linkurl="oprweb06.pbl?reportno=12&template=005&casekeys="+caseKeys+
          "&teamnumb="+teamNumb;
  Left=(document.body.clientWidth-750)/2
  DFrameLink(linkurl,100,Left,750,350)
}
function warnProcDesc(){
  if(!isWhitespace(document.UpdateForm.opsrg006.value)){
    alert("Has the procedure description been updated?");
    document.UpdateForm.opdea014.className="Mandatory";
  } else {
    document.UpdateForm.opdea014.className="";
  }
}

function ShowPop() {
  PopScreen=GetCookieData("TheDetPopup");
  if (PopScreen!="unknown") {
     if(PopScreen=="1") {
       showMBS();
     } else if(PopScreen=="2") {
       showImplant();
     } else if(PopScreen=="3") {
       showExpItem();
     } else if(PopScreen=="4") {
       showChgSur();
     } else if(PopScreen=="5") {
       showChgOpr();
     }
  }
  ExpireCookiePath("TheDetPopup")
}
function ChgSurgeon() {
  if (UpdateTeam()) {
    SetCookie("TheDetPopup","4","15");
  }
}
//----------------------------------------------------------------------------
// Create New Table Object
// Border, Cellspacing, Cellpadding, Width, Align, Heading Height, Row Height
//----------------------------------------------------------------------------
// Add Columns in Order Required
// Heading,Type,Display Column,Sort Column, Align, Icon, Link Column
// Columns Available
//  0 - HTML Link
//  1 - Staff
//  2 - Name
//  3 - Start Time
//  4 - End Time
//  5 - Supervisor/Level
//---------------------------------------------------------------------------
function InitTable(TableView) {
    switch (TableView) {
      case 0: {
       document.title="Staff Members"
       t = new Table(1,0,2,"100%","center",25,30);
       t.addColumn("Staff","String",6,6,"left","MaintenanceIcon.gif","0",160)
       t.addColumn("Name","String",2,2,"left","","",150)
       t.addColumn("Count","String",7,7,"left","","",40)
       t.addColumn("Start Time","String",3,3,"left","","",80)
       t.addColumn("End Time","String",4,4,"left","DateTimeStamp.gif","8",80)
       AddTableRows();
       TableOutput(0,2);    // Order Column,Asc Dsc
       break; }
    }
}
// Add Team
function AddTeam() {
   if(document.UpdateForm.teamnumb.length==9){
      alert("Cannot add more than 9 Teams");
      return;  
    }
    if(!validateMandatory(document.UpdateForm)) {
      return;
    }
    document.UpdateForm.teamnumb.className=""
    document.UpdateForm.teamnumb.value=""; 
    document.UpdateForm.updatety.value="A";
 // hidden fields on this page to stop js error when adding staff
 // shouldn't get values submitted though
    document.UpdateForm.opsrg003.value="";
    document.UpdateForm.opsrg004.value="";
    formSubmit();
} 
// Update Team
function UpdateTeam() {

   if (!checkVisitDatesTimes()) {return;}

   // Set Prep Time to be equal to Surgery Start Time. This is required
   // for calculation of Actual Operation Minutes.
   document.UpdateForm.opsrg003.value = document.UpdateForm.opsrg005.value;

   // Set Dressing Time to be equal to Surgery End Time. This is required
   // for calculation of Actual Operation Minutes.
   document.UpdateForm.opsrg004.value = document.UpdateForm.opsrg006.value;

   if (document.UpdateForm.ovrnight.checked == true) 
     document.UpdateForm.opsrg071.value = "1";

   if (document.UpdateForm.d_opsrg074.checked == true)
     document.UpdateForm.opsrg074.value = "1";

   if (document.UpdateForm.d_opsrg075.checked == true)
     document.UpdateForm.opsrg075.value = "1";
     
   document.UpdateForm.updatety.value="U";
   return(formSubmit());
}

// Delete Team
function DeleteTeam() {
   if(!CheckTeamNumber())
        return;
   if(confirm("Are you sure you want to delete")) {
       document.UpdateForm.updatety.value="D";
       formSubmit();
    }
}
// Avoid deletion of First Team
function CheckTeamNumber(){
   if(document.UpdateForm.teamnumb.selectedIndex==0){
      alert("Cannot delete first Team");
      return false; 
   }
   index=document.UpdateForm.teamnumb.selectedIndex;
   SelectedValue=document.UpdateForm.teamnumb.options[index].value; 
   if(SelectedValue!=document.UpdateForm.teamnumb.length){
      message="Can delete only highest Team number which is "+
              document.UpdateForm.teamnumb.length+" in this case";
      alert( message);
      return false;
   } 
   return true;
}
// Refresh Page
function RefreshPage() {
   document.UpdateForm.method="get"
   document.UpdateForm.updatety.value="";
   document.UpdateForm.submit();
}
// Link To Add Staff
function goToStaff() {
    if (document.UpdateForm.ovrnight.checked == true) 
      document.UpdateForm.opsrg071.value = "1";

    if (document.UpdateForm.d_opsrg074.checked == true)
      document.UpdateForm.opsrg074.value = "1";

    if (document.UpdateForm.d_opsrg075.checked == true)
      document.UpdateForm.opsrg075.value = "1";

    temp=document.UpdateForm.teamnumb.value;
    supr=document.UpdateForm.suprlevl.value;
    linkurl="oprweb06.pbl?reportno=1&template=2&casekeys="+
    document.UpdateForm.casekeys.value+"&teamnumb="+temp+"&suprlevl="+supr;
    Left=(document.body.clientWidth-750)/2
    DFrameLink(linkurl,100,Left,750,350)
}
//  Update Staff End Time and Date
function UpdateEndTime(linkkeys) {
   casekey=document.UpdateForm.casekeys.value.substr(0,26);
   casekey=casekey.replace(/ /g,"+");
   uniqkey=document.UpdateForm.uniqueky.value
   uniqkey=uniqkey.replace(/ /g,"+");
   document.UpdateForm.redirect.value="oprweb06.pbl?reportno=1&template=001&"+
                             "uniqueky="+uniqkey;
   document.UpdateForm.opdunqid.value=linkkeys;
   document.UpdateForm.nextpage.value=1;
   document.UpdateForm.updatety.value="E";
   formSubmit();
}
// Link to Update Staff
function UpdateLink(scasekey,staftype,stafcode,stardate,startime) {
   temp=document.UpdateForm.teamnumb.value;
   supr=document.UpdateForm.suprlevl.value;
   linkurl="oprweb06.pbl?reportno=1&template=3&casekeys="+
   scasekey+"&teamnumb="+temp+"&optsm001="+
   staftype+"&optsm002="+stafcode+"&optsm003="+
   stardate+"&optsm004="+startime+
   "&suprlevl="+supr;
   Left=(document.body.clientWidth-750)/2
   DFrameLink(linkurl,100,Left,750,350)
}
// Form Submit
function formSubmit() {
   if(validateMandatory(document.UpdateForm)) {
      casekey=document.UpdateForm.casekeys.value.substr(0,26);
      casekey=casekey.replace(/ /g,"+");
      uniqkey=document.UpdateForm.uniqueky.value
      uniqkey=uniqkey.replace(/ /g,"+");
      if(document.UpdateForm.suprlevl.value=="S") {
      document.UpdateForm.redirect.value="oprweb01.pbl?reportno=4&template=013&"+
                                 "casekeys="+casekey; }
      else {
      document.UpdateForm.redirect.value="oprweb06.pbl?reportno=1&template=001&"+
                                 "uniqueky="+uniqkey+"&teamnumb="; }
      document.UpdateForm.submit();
      return true;
    }
    return false;
}
// Set Team no.
function set(){
 PatientLinks.teamnumb.value=document.UpdateForm.teamnumb.value;
}
function ManInfection() {
if(!isWhitespace(document.UpdateForm.opsrg006.value)) {
// Bug SV46
  document.UpdateForm.opsrg060.className="Mandatory";
 }
}
function ChkStart() {
  if(isWhitespace(document.UpdateForm.opsrg005.value)) {
    alert("Start Time missing. Please enter it now");
    document.UpdateForm.opsrg005.focus();
    return;
  }
  if(!isWhitespace(document.UpdateForm.opsrg006.value)) {
  surgStrt = trim(document.UpdateForm.opsrg005.value.replace(/:/g,""))
  surgEnd  = trim(document.UpdateForm.opsrg006.value.replace(/:/g,""))
  if(surgStrt < surgEnd) {
    CheckFutureTime(document.UpdateForm,document.UpdateForm.opsedate.value,document.UpdateForm.opsrg006);
  }
  if(surgStrt > surgEnd) {
    if (confirm("Is Surgery End the day after Surgery Start Time?")){
     document.UpdateForm.dateflag.value="1";
     document.UpdateForm.ovrnight.checked=true;
     }
    else {
        CheckFutureTime(document.UpdateForm,document.UpdateForm.opsedate.value,document.UpdateForm.opsrg006);
          document.UpdateForm.dateflag.value="0";
          document.UpdateForm.opsrg006.focus();
        }
     }
  }
}
function ChkEnd() {
  if (isWhitespace(document.UpdateForm.opsrg006.value)) {
    alert("End Time missing. Please enter it now"); 
    document.UpdateForm.opsrg006.focus();
    return;
  }
} 
// Help for Infection Control
function AlertICC() {
alert("Class I - CLEAN\n" +
      "    An uninfected operative wound in which no\n" +
      "    inflammation is encountered and the respiratory,\n" +
      "    alimentary, genital, or uninfected urinary tract\n" +
      "    is not entered.\n" +
      "    In addition, clean wounds are primarily closed and, if\n" +
      "    necessary, drained with closed drainage. Operative\n" +
      "    incisional wounds that follow non-penetrating (blunt)\n" +
      "    trauma should be included in this category if they\n" +
      "    meet the criteria.\n" +
      "    \n" +
      "Class II - CLEAN-CONTAMINATED\n" +
      "    An operative wound in which the\n" +
      "    respiratory, alimentary, genital, or urinary\n" +
      "    tracts are entered under controlled  \n" +
      "    conditions and without unusual contamination.\n" +
      "    Specifically, operations involving the biliary tract,\n" +
      "    appendix, vagina and oropharynx are included in this\n" +
      "    category, provided no evidence of infection or major\n" +
      "    break in technique is encountered.\n" +
      "    \n" +
      "Class III - CONTAMINATED\n" +
      "    Open, fresh, accidental wounds.\n" +
      "    In addition, operations with major breaks\n" +
      "    in sterile technique (e.g. open cardiac massage) or gross\n" +
      "    spillage from the gastrointestinal tract, and incisions\n" +
      "    in which acute, non-purulent inflammation is encountered\n" +
      "    are included in this category.\n" +
      "    \n" +
      "Class IV - DIRTY INFECTED\n" +
      "    Old traumatic wounds with retained devitalized\n" +
      "    tissue and those that involve existing\n" +
      "    clinical infection or perforated viscera.\n" +
      "    This definition suggests that the organisms causing\n" +
      "    postoperative infection were present in the operative\n" +
      "    field before the operation.");
}
// Validate Surgery Start Time > Time Out Performed
function ChkTimeout() {
  if (!isWhitespace(document.UpdateForm.opsrg005.value) ) {
    var timeouttime=trim(document.UpdateForm.opard029.value.replace(/:/g,""));
    var prepstrt=trim(document.UpdateForm.opsrg005.value.replace(/:/g,""));
    if (timeouttime > prepstrt) {
      if(!confirm("Time Out time should be before Surgery Start time " +
                document.UpdateForm.opsrg005.value + "\n Do you want to override")) {
        document.UpdateForm.opard029.value=""
        document.UpdateForm.opsrg029.focus();
        return;
      }
    }
  }
}
// Change Theatre
function ChgOpr() {
linkurl="oprweb01.pbl?reportno=4&template=014&casekeys="
         + document.UpdateForm.casekeys.value; 
  Left=(document.body.clientWidth-350)/2
  DFrameLink(linkurl,100,Left,350,180)
 }
// Procedure Description to be made Mandatory
function ProcMan() {
if(!isWhitespace(document.UpdateForm.opsrg006.value)) {
//  Bug SV46
   document.UpdateForm.opdea014.className="Mandatory";
 }
}
// Validate Surgical Time / Anaesthetic Commenced
function ChkAnae() {
  if(isWhitespace(document.UpdateForm.anaestim.value)) {
   alert("Anaesthetic Commenced missing. Please enter it now");
   return;
  }
if(!isWhitespace(document.UpdateForm.opsrg005.value)) {
var anaeComm = trim(document.UpdateForm.anaestim.value.replace(/:/g,""))
var surgStrt = trim(document.UpdateForm.opsrg005.value.replace(/:/g,""))
anaeComm=anaeComm.substr(0,4)
surgStrt=surgStrt.substr(0,4)
anaeComm=anaeComm - 0;
surgStrt=surgStrt - 0;
  if (anaeComm > surgStrt) {
     if(!confirm("Surgery Start Time cannot be less than " +
                 "Anaesthetic Commenced Time" +
        "\n Do you want to override")) {
        document.UpdateForm.opsrg005.value="";
        document.UpdateForm.opsrg005.focus();
        return;
     }
  }
}
//
var MaxDelay=(parseInt(anaeComm) + 15)
var Minutes=parseInt(MaxDelay) % 100
var Hour=parseInt(MaxDelay) / 100
  if (Minutes>=60) {
     Minutes=Minutes - 60
     Hour=parseInt(Hour) + 1
     MaxDelay = (Hour*100) + Minutes
  }
  if (MaxDelay < surgStrt) {
     document.UpdateForm.opsrg007.className="Mandatory"
  } else {
     document.UpdateForm.opsrg007.className=""
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);InitTable(0);set();ProcMan();ShowPop();LoadDefTeam();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%OPRWEB06.01.003";
PatientVIS="%OPRWEB06.01.081";
PatientNAM="%OPRWEB06.01.002";
PatientSTA="%OPRWEB06.01.086.078";
PatientALT="%OPRWEB06.01.084";
PatientSEX="%OPRWEB06.01.019";
PatientDOB="%OPRWEB06.01.020";
PatientAGE="%OPRWEB06.01.021";
PatientLOC="%OPRWEB06.01.083";
PatientPRI="%OPRWEB06.01.086.066.1";
PatientUNT="%OPRWEB06.01.066.0";
DoctorCOD="%OPRWEB06.01.082.003";
DoctorNAM="%OPRWEB06.01.082.002";
PatientAID="%OPRWEB06.01.086.090";
PatientIND="%OPRWEB06.01.086.091";
PatientCUR="%OPRWEB06.01.086.092";
PatientCLC="%OPRWEB06.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%OPRWEB06.01.086.094";
PatientCDM="%OPRWEB06.01.086.095";
PatientVDH="%OPRWEB06.01.086.099.015";
InsertPatientHeader()
</script>
<div id="PatientMenu"></div>

<div id="TheatreCaseHeading"></div>
<script type="text/javascript">
TheatreHeading="Theatre Details"
CombinedCMBS="%STANDARD.01.025.113.003.0.1"
NoDressingTime="1"
InsertTheatreCaseHeadSJOGWA()
</script>

<form name=UpdateForm method=post action="oprweb06.pbl">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=updatety value="">
<input type=hidden name=urnumber value='%OPRWEB06.01.003'>
<input type=hidden name=casekeys value="%OPRWEB06.01.101">
<input type=hidden name=uniqueky value='%OPRWEB06.01.110'>
<input type=hidden name=opsedate value='%OPRWEB06.01.402'>
<input type=hidden name=currdate value='%STANDARD.01.013'>
<input type=hidden name=currtime>
<input type=hidden name=recordty value="">
<input type=hidden name=rcounter value="">
<input type=hidden name=redirect value="">
<input type=hidden name=nextpage value=1>
<input type=hidden name=anaestim value="%OPRWEB06.01.542">
<input type=hidden name=dateflag>
<input type=hidden name=suprlevl value="%OPRWEB06.01.313">
<input type=hidden name=surgc001 value="">
<input type=hidden name=opdunqid value="">
<input type=hidden name=opsrg071 value=" ">
<input type=hidden name=opsrg074 value=" ">
<input type=hidden name=opsrg075 value=" ">
<input type=hidden name=opsedtcm id=opsedtcm value="%OPRWEB06.01.483">
<input type=hidden name=opsework id=opsework value='%OPRWEB06.01.402'
 title="Session Date">
<input type=hidden name=admndate id=admndate value="%OPRWEB06.01.351"
 title="Admission Date">
<input type=hidden name=admntime id=admntime value="%OPRWEB06.01.352">
<input type=hidden name=discdate id=discdate value="%OPRWEB06.01.353"
 title="Discharge Date">
<input type=hidden name=disctime id=disctime value="%OPRWEB06.01.354">
<input type=hidden name=opard002 value="%OPRWEB06.01.502">
<input type=hidden name=opsrg003>
<input type=hidden name=opsrg004>

<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td class=DataLabel width=6%>Theatre</td>
    <td class=DataField width=12%>%OPRWEB06.01.302</td> 
    <td class=DataLabel width=10%>Date </td>
    <td class=DataField width=14%>%OPRWEB06.01.406 %OPRWEB06.01.402</td>
    <td class=DataLabel width=10%>Unit</td>
    <td class="DataField" width=15%>%OPRWEB06.01.413.0 </td></tr>
<tr><td class=DataLabel>Consultant</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.01.404.003")'>
    %OPRWEB06.01.404.002 </a></td>
    <td class=DataLabel>Operating Surgeon</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.01.311.003")'>
    %OPRWEB06.01.311.002 </a></td>
    <td class=DataLabel>Supervisor Level</td>
    <td><select name=optsm007 class=SelectBig>
        <option></option>
         %OPRWEB06.01.325.2
        </select></td></tr>
<tr><td class=DataLabel>Anaesthetist</td>
    <td class=DataField>
    <a href='javascript:DoctorViewFrame("%OPRWEB06.01.416.003")'>
    %OPRWEB06.01.416.002 </a></td>
    <td></td><td></td><td></td>
    <td class=DataField>
    <input type=button value="Change Surgeon" class="Bigbutton"
     onclick="showChgSur();"></td>
</tr>

<tr><td colspan=6>
<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr><td class=DataLabel>Procedure&nbsp;</td>
    <td> <input type=text size=116 name=opdea014 maxlength=80
          title="Procedure Description" value="%OPRWEB06.01.305"></td></tr>
<tr><td class=DataLabel>&nbsp;&nbsp;</td>
    <td> <input type=text size=116 name=opdea015 maxlength=80
     title="Procedure Description" value="%OPRWEB06.01.343"></td></tr> 
<tr><td class=DataLabel>&nbsp;&nbsp;</td>
    <td> <input type=text size=116 name=opdea016 maxlength=80
         title="Procedure Description" value="%OPRWEB06.01.344">
    </td></tr>
</table>
</td></tr>
</table>
<hr>
<table border="0" cellpadding="1" cellspacing="0" width="100%" align=center>
<tr valign=top><td class=DataLabel>Team No</td>
   <td class=DataField>
   <select name=teamnumb title="Theatre Team" class=Mandatory tabindex=-1
    onchange="RefreshPage()">
    %OPRWEB06.01.148
   </select></td>
   <td class=DataLabel>Did this case run over midnight?</td>
   <td><input type=checkbox name=ovrnight title="Overninght Indicator"
        value="1" ></td>
    <td class="DataLabel" >Prep.Soln.</td>
   <td><select name=opsrg050 title="Prep.Soln code1" class=SelectBig tabindex=50>
        <option></option>
        %OPRWEB06.01.250.2
        </select></td></tr>
<tr><td class=DataLabel title='Time "Time out" procedure commences'>
     Time Out Performed</td>
    <td class=DataField><input type=text name=opard029 size=8 maxlength=8
       title="Anaesthetic/Prep Time" value="%OPRWEB06.01.529" tabindex=1
       onblur="checkTime(this,this.title);ChkTimeout();
     CheckFutureTime(UpdateForm,UpdateForm.opsedate.value,UpdateForm.opard029);">
      <img src="../images/DateTimeStamp.gif" class=Icon align=absmiddle
       onclick="SetCurrentDateTime(null,UpdateForm.opard029);">
      <img src=../images/TimeLookup.gif border=0 class=Icon align=absmiddle
       onclick="TimeLookupFrame(UpdateForm.opard029);"></td>
 
    <td></td><td></td>
    <td class="DataLabel" >Prep.Soln.</td>
    <td><select name=opsrg051 title="Prep.Soln code2" class=SelectBig
          tabindex=55>
        <option></option>
         %OPRWEB06.01.251.2
        </select></td></tr>

<tr><td class=DataLabel title='Earliest time of pt. positioning, skin prep or draping'>
    Surgery Start</td>
    <td class=DataField>
    <input type=text name=opsrg005 size=8 maxlength=8 tabindex=5
     value="%OPRWEB06.01.337"
     onblur="checkTime(this);ChkAnae();
     CheckFutureTime(UpdateForm,UpdateForm.opsedate.value,opsrg005);">
    <img src="../images/DateTimeStamp.gif" class=Icon time=UpdateForm.opsrg005>
    <img src="../images/TimeLookup.gif" class=Icon time=UpdateForm.opsrg005>
    </td>
    <td class=DataLabel>%STANDARD.01.017.TV</td>
    <td class=DataField>
    <select name=opsrg007 tabindex=45 title="%STANDARD.01.017.TV">
    <option></option>
    %OPRWEB06.01.339.2
    </select></td>
    <td class="DataLabel" >Prep.Soln.</td>
    <td><select name=opsrg052 title="Prep.Soln code3" class=SelectBig
         tabindex=50>
        <option></option>
         %OPRWEB06.01.252.2
        </select></td></tr>

<tr><td class=DataLabel  title='Latest time of suturing, dressing or plastering complete'>
    Surgery End</td>
    <td class=DataField>
    <input type=text name=opsrg006 size=8 maxlength=8 tabindex=10
     value="%OPRWEB06.01.338" 
     onblur="checkTime(this);ChkStart();ManInfection();warnProcDesc();">
    <img src="../images/DateTimeStamp.gif" class=Icon time=UpdateForm.opsrg006>
    <img src="../images/TimeLookup.gif" class=Icon time=UpdateForm.opsrg006>
    </td>
    <td class=DataLabel>Count Correct </td>
    <td class=DataField>
    <select name=opsrg008 title="Count Correct" tabindex=48>
    <option></option>
    <option value=1>No</option>
    <option value=2>Yes</option>
    </select></td>
    <td class="DataLabel">Infection Control Class</td>
    <td><select name=opsrg060 title="Infection Control Class" tabindex=60>
        <option></option>
         %OPRWEB06.01.260.2
        </select>
        <img src=../images/HelpIcon.gif class=Icon onclick="AlertICC();">
    </td></tr>
<tr><td class=DataLabel title='Time patient departs the Operating/Procedure Room'>
    Pt Departure - Operating Room</td>
    <td class=DataField>
      <input type=text name=opard104 size=8 maxlength=8 tabindex=15
       title="Pt Departure - Operating Room" value="%OPRWEB06.01.599.004"
       onblur="checkTime(this,this.title);">
      <img src="../images/DateTimeStamp.gif" class=Icon
       onclick="SetCurrentDateTime(null,UpdateForm.opard104);">
      <img src=../images/TimeLookup.gif border=0 class=Icon align=absmiddle
       onclick="TimeLookupFrame(UpdateForm.opard104);"></td>
   <td></td><td></td>
   <td class=DataLabel>Case Abandoned</td>
   <td><input type=checkbox name=d_opsrg074 title="Case Abandoned"
        value="1"></td>
    </tr>
<tr><td class=DataLabel>Straight to DPU</td>
    <td><input type=checkbox name=d_opsrg075 title="Straight to DPU"
         value="1" ></td>


<tr><td colspan=4 align=center>
     <input class="button" type=button value="Add Staff" onclick="goToStaff();">
     <input type=button value="Change Theatre" class="Bigbutton" 
      onclick="ChgOpr();">
     <input type=button value="Add Default Team" class="Bigbutton" 
      id="opr06sub3" onclick="tempDisable(this);UpdateTeam();">
    </td>
    <td colspan=4>
    <input type=button value=Update class="button" id="opr06sub2"
     onclick="tempDisable(this);CheckDefaultTeamCompleted();UpdateTeam();">
    <input type=button value=Delete class="button" onclick="DeleteTeam();">
    <input type=button value=Cancel class="button" onclick="RefreshPage();">
</td></tr>
</table>
</form>

<div id=TableLocation></div>

<script type="text/javascript">
function AddTableRows() {
%OPRWEB06.01.329
CorrectCount="%OPRWEB06.01.340"
document.UpdateForm.opsrg008.selectedIndex =CorrectCount ; 
}
</script>
<form  name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=001>
<input type=hidden name=urnumber value='%OPRWEB06.01.003'>
<input type=hidden name=admissno value='%OPRWEB06.01.081'>
<input type=hidden name=MenuType value='%OPRWEB06.01.088'>
<input type=hidden name=casekeys value='%OPRWEB06.01.101'>
<input type=hidden name=sesskeys value='%OPRWEB06.01.102.oprweb01.03.003'>
<input type=hidden name=uniqueky value='%OPRWEB06.01.110'>
<input type=hidden name=teamnumb value='%OPRWEB06.01.334'>
</form>
<script type="text/javascript">
if (document.UpdateForm.suprlevl!=undefined) {
  if (document.ShowActionMenu.sactions!=undefined) {
    if (document.UpdateForm.suprlevl.value=="S") {
      document.ShowActionMenu.sactions.disabled=true;
    }
  }
}

if ("%OPRWEB06.01.271" == "Yes") {
  document.UpdateForm.ovrnight.checked=1;
}
if ("%OPRWEB06.01.274" == "Yes") {
  document.UpdateForm.d_opsrg074.checked=1;
}
if ("%OPRWEB06.01.275" == "Yes") {
  document.UpdateForm.d_opsrg075.checked=1;
}
</script>
