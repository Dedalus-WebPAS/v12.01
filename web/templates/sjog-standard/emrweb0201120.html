<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="sjog-standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript">
function DefaultDateTimeFields() {
  if (isWhitespace(document.UpdateForm.ptcnnssi.value) ||
      document.UpdateForm.ptcnnssi.value == "00000000000000000000") {
      document.UpdateForm.doctdate.value=document.UpdateForm.d_emviud09.value;
      document.UpdateForm.docttime.value=document.UpdateForm.d_emviut09.value;
  }
  if (isWhitespace(UpdateForm.frstdoct.value) &&
      isWhitespace(UpdateForm.doctdate.value)) {
    SetCurrentDateTime(eval(UpdateForm.doctdate),eval(UpdateForm.docttime));
  }
}
function UpdateDoct() {
 if(!isWhitespace(parent.document.UpdateForm.username.value)) {
 getUserIDForLoginName(parent.document.UpdateForm.username,UpdateForm.webuseid);
 }
 document.UpdateForm.frstdoct.className="Mandatory";
 document.UpdateForm.doctdate.className="Mandatory";
 document.UpdateForm.docttime.className="Mandatory";
 if(validateMandatory(UpdateForm)) {
   document.UpdateForm.submit();
   if (window.parent.parent.parent.content!=undefined) {
      window.parent.parent.parent.content.setTimeout('window.location.reload()',
                                                      3000);
   }
 }
}
function DeleteDoct() {
 if(!isWhitespace(parent.document.UpdateForm.username.value)) {
   document.UpdateForm.webuseid.value=parent.document.UpdateForm.username.value;
 }
 document.UpdateForm.frstdoct.value="";
 document.UpdateForm.n_frstdoct.value="";
 document.UpdateForm.frstdoct.className="";
 document.UpdateForm.doctdate.value="";
 document.UpdateForm.doctdate.className="";
 document.UpdateForm.docttime.value="";
 document.UpdateForm.docttime.className="";
 if(!validateMandatory(UpdateForm)) { 
   return;
 }
 if(confirm("Are you sure you want to delete the Senior Doctor?")) {
   document.UpdateForm.submit();
 }
}
function doctorName(doctor) {
if (isWhitespace(doctor.value)) { return;;}
doctor=doctor.value.toUpperCase()
admissno=document.PatientLinks.admissno.value;
user=document.PatientLinks.webuseid.value;
//  validate doctor exists in patdo1af
  var serverURL   = "../cgi-bin/patweb80.pbl?reportno=3" +
                    "&valdcode=" + doctor.replace(/ /g,"+")
  var returnValue = RSExecute(serverURL);
  if (returnValue.status!=0) {
    UpdateForm.frstdoct.value="";
    UpdateForm.n_frstdoct.value="";
    UpdateForm.frstdoct.focus();
    return;
  }
//  validate doctor exists in emrdocaf
  if (UpdateForm.emcndoct.value==1) {
    var serverURL   = "../cgi-bin/emrweb08.pbl?reportno=11" +
                      "&valdcode=" + doctor.replace(/ /g,"+")
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {
      UpdateForm.frstdoct.value="";
      UpdateForm.n_frstdoct.value="";
      UpdateForm.frstdoct.focus();
      return;
    }
  }
  ReturnValue=returnValue.return_value.split("|");
  UpdateForm.n_frstdoct.value=ReturnValue[0];
}
function init() {
  if(document.UpdateForm.suprflag.value=="1") {
     document.getElementById("InsertDeleteButton").style.display="";
     document.getElementById("InsertUpdateButton").style.display="";
     document.getElementById("InsertReason").innerHTML=
     document.getElementById("ShowReason").innerHTML;
  } else {
     document.getElementById("InsertReason").innerHTML="";
     if(isWhitespace(UpdateForm.d_frstdoct.value)) {
       document.getElementById("InsertUpdateButton").style.display="";
     } else {
       document.UpdateForm.frstdoct.readOnly=true;
       document.UpdateForm.frstdoct.className="Readonly";
       document.UpdateForm.doctdate.readOnly=true;
       document.UpdateForm.doctdate.className="Readonly";
       document.UpdateForm.docttime.readOnly=true;
       document.UpdateForm.docttime.className="Readonly";
       document.UpdateForm.cancbutt.focus();
     }
  }
}
function CheckClear() {
  if(document.UpdateForm.frstdoct.className=="Readonly") {
    alert(document.UpdateForm.frstdoct.title + "is a readonly field");
    return;
  }
  clrFields(UpdateForm.frstdoct,UpdateForm.n_frstdoct);
}
function CheckSearch() {
  if(document.UpdateForm.frstdoct.className=="Readonly") {
    alert(document.UpdateForm.frstdoct.title + "is a readonly field");
    return;
  }
  if (UpdateForm.emcndoct.value==1) {
    DoctorEmrSearchFrame(UpdateForm.frstdoct,UpdateForm.n_frstdoct);
  }
  else {
    DoctorSearchFrame(UpdateForm.frstdoct,UpdateForm.n_frstdoct);
  }
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DefaultDateTimeFields();">
<span class=DFrameTitleBar>
<img align="right" alt="Exit" class="MenuIcon"
 src="../images/ExitIcon.gif" onclick="DFrameExit();">
Change Senior Doctor Seen Date/Time
</span>
<form name="UpdateForm" action="emrweb02.pbl" method="post" style="margin:0">
<input type="hidden" name="reportno" value="22">
<input type="hidden" name="template" value="120">
<input type="hidden" name="admissno" value="%EMRWEB02.01.081">
<input type="hidden" name="urnumber" value="%EMRWEB02.01.003">
<input type="hidden" name="updttype" value="OTDOC">
<input type=hidden name="webuseid" value="%STANDARD.01.008">
<input type=hidden name="d_frstdoct" value="%EMRWEB02.01.269.003">
<input type=hidden name="suprflag" value="%EMRWEB02.01.495">
<input type=hidden name=emcndoct value="%EMRWEB02.01.455">
<input type=hidden name=d_emviud09 value="%EMRWEB02.01.239.0">
<input type=hidden name=d_emviut09 value="%EMRWEB02.01.249">

<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td>

<table width="95%" align=center border="0" cellspacing="0">
<tr><td class=DataLabel width=35%>Senior Doctor</td>
    <td class=DataLabel><input type=text name=frstdoct size=10 maxlength=6
         value="%EMRWEB02.01.269.003"
         onblur="UpCase(this);doctorName(UpdateForm.frstdoct);" >
        <input type=text name=n_frstdoct size=18 readonly 
         title="Senior Doctor Name" value="%EMRWEB02.01.269.002" class=Readonly>
        <img src="../images/SearchIcon.gif" class=Icon
          onclick="CheckSearch();">
        <img src="../images/erase.gif" class=Icon
         onclick="CheckClear();">
    </td></tr>

<tr><td class=DataLabel>Senior Doctor Seen Date </td>
    <td class=DataLabel>
        <input type="text" name=doctdate size="12"
         class="BackDate" title="Senior Doctor Date"
         value="%EMRWEB02.01.240.0">
        <img notab src=../images/DateLookup.gif class=Icon
         align=absmiddle onclick="DateLookupFrame(doctdate);">
        Time
        <input type="text" name=docttime size="8"
         class='Time' title="Senior Doctor Time"
         value="%EMRWEB02.01.250">
        <img notab src=../images/DateTimeStamp.gif class=Icon
         onclick="SetCurrentDateTime(UpdateForm.doctdate,UpdateForm.docttime);">
        <img notab src=../images/TimeLookup.gif class=Icon
         onclick="TimeLookupFrame(UpdateForm.docttime);">
    </td></tr>
</table>

<div id=InsertReason></div>

<table width="95%" align=center border="0" cellspacing="0">
<tr><td align=center> 
    <span id=InsertUpdateButton style="display: none">
    <input type="button" value="Update" class="button" id="emr02upd"
     onclick="tempDisable(this);UpdateDoct();">
    </span>

    <span id=InsertDeleteButton style="display: none">
    <input type="button" value="Delete" class="button" id="emr02del"
     onclick="tempDisable(this);DeleteDoct();">
    </span>

    <input type="button" value="Cancel" class="button"
     name="cancbutt" onclick="DFrameClose();">
</td></tr>
</table>

</td></tr>
</table>
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=MenuType value="%EMRWEB02.01.088">
<input type=hidden name=webuseid value="%STANDARD.01.008">
</form>

<div id=ShowReason style="display: none">
<table width="95%" align=center border="0" cellspacing="0">
<tr><td class=DataLabel width=35%>Reason for Change</td>
    <td><select name=reasonfc title="Reason for Change" class="Mandatory">
         <option></option>
         %STANDARD.01.007.FW
        </select></td></tr>
</table>
</div>
