<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="sjog-standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/preadmission.js"></script>
<script type="text/javascript" src="../js/OECpreadmission.js"></script>
<script type="text/javascript">
function switchPresIll() {
  if (document.UpdateForm.presilsw.checked==true) {
    PresIllCodHdr.innerHTML=presillnumhdr.innerHTML;
    PresIllCod.innerHTML=presillnum.innerHTML;
  } else {
    PresIllCodHdr.innerHTML=presillcodhdr.innerHTML;
    PresIllCod.innerHTML=presillcod.innerHTML;
  }
}
function OECRequired() {
 if(document.UpdateForm.oecchbox.checked == true) {

     if (UpdateForm.ptvis043.className=="Mandatory") {
       UpdateForm.ptvis043.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptvis043.className="OECRequired";  //Intended Stay
     }

     if (UpdateForm.ptmis007.className=="Mandatory") {
       UpdateForm.ptmis007.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis007.className="OECRequired";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="Mandatory") {
       UpdateForm.doctnam2.className="OECRequired Mandatory";
     } else {
       UpdateForm.doctnam2.className="OECRequired";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis020.className=="Mandatory") {
       UpdateForm.ptmis020.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis020.className="OECRequired";  //Diagnosis
     }

     if (UpdateForm.ptmis027.className=="Mandatory") {
       UpdateForm.ptmis027.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis027.className="OECRequired";  //Claim Type
     }

     if (UpdateForm.funddesc.className=="Mandatory") {
       UpdateForm.ptmis013.className="OECRequired Mandatory";  //HF
       UpdateForm.funddesc.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis013.className="OECRequired";  //HF
       UpdateForm.funddesc.className="OECRequired";  //Health Fund Code
     }

     if (UpdateForm.tabldesc.className=="Mandatory") {
       UpdateForm.ptmis014.className="OECRequired Mandatory";  //HF Level
       UpdateForm.tabldesc.className="OECRequired Mandatory";
     } else {
       UpdateForm.ptmis014.className="OECRequired";            //HF Level
       UpdateForm.tabldesc.className="OECRequired";  //Health Fund Code
     }

     UpdateForm.ptmis030.className="OECRequired Integer";    //Planned Length
     UpdateForm.ptvis076.className="OECRequired";            //Discharge Inten
     UpdateForm.ptmis015.className="OECRequired";            //Member Nunber

  } else {

     if (UpdateForm.ptvis043.className=="OECRequired Mandatory") {
       UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
     } else {
       UpdateForm.ptvis043.className="";  //Intended Stay
     }

     if (UpdateForm.ptmis007.className=="OECRequired Mandatory") {
       UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     } else {
       UpdateForm.ptmis007.className="";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="OECRequired Mandatory") {
       UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor Desc
     } else {
       UpdateForm.doctnam2.className="";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis020.className=="OECRequired Mandatory") {
       UpdateForm.ptmis020.className="Mandatory";  //Diagnosis
     } else {
       UpdateForm.ptmis020.className="";  //Diagnosis
     }

     if (UpdateForm.ptmis027.className=="OECRequired Mandatory") {
       UpdateForm.ptmis027.className="Mandatory";  //Claim Type
     } else {
       UpdateForm.ptmis027.className="";  //Claim Type
     }

     if (UpdateForm.funddesc.className=="OECRequired Mandatory") {
       UpdateForm.ptmis013.className="Mandatory";  //HF
       UpdateForm.funddesc.className="Mandatory";  //Health Fund
     } else {
       UpdateForm.ptmis013.className="";  //HF
       UpdateForm.funddesc.className="";  //Health Fund
     }

     if (UpdateForm.tabldesc.className=="OECRequired Mandatory") {
       UpdateForm.ptmis014.className="Mandatory";  //HF Level
       UpdateForm.tabldesc.className="Mandatory";  //Health Fund
     } else {
       UpdateForm.ptmis014.className="";  //HF Level
       UpdateForm.tabldesc.className="";  //Health Fund
     }

     UpdateForm.ptmis030.className="Integer";    //Planned Length of Stay
     UpdateForm.ptvis076.className="";           //Discharge Inten
     UpdateForm.ptmis015.className="";           //Member Number
  }
}
function ShowOESmbs() {
  if(document.UpdateForm.showmbsc.checked == true) {
    OESMBSitems.innerHTML=oesmbsitems.innerHTML;
  } else {
    OESMBSitems.innerHTML=blanklabel.innerHTML;
  }
}
function ShowOECFields() {
  if(document.UpdateForm.oecchbox.checked == true) {
    PreExistAilHdr.innerHTML=preexisthdr.innerHTML;
    PreExistAilmnt.innerHTML=preexistail.innerHTML;
    EmerAdmHdr.innerHTML=emeradmnhdr.innerHTML;
    EmerAdmssn.innerHTML=emeradmissn.innerHTML;
    PresIllCodHdr.innerHTML=presillcodhdr.innerHTML;
    PresIllCod.innerHTML=presillcod.innerHTML;
    SwiPresIll.innerHTML=swipresill.innerHTML;
    LongLine.innerHTML=longline.innerHTML;
    OESMBSitems.innerHTML=blanklabel.innerHTML;
    OESHeadings.innerHTML=oesheadings.innerHTML;
    OESServices.innerHTML=oesservices.innerHTML;
  } else {
    PreExistAilHdr.innerHTML=blanklabel.innerHTML;
    PreExistAilmnt.innerHTML=blanklabel.innerHTML;
    EmerAdmHdr.innerHTML=blanklabel.innerHTML;
    EmerAdmssn.innerHTML=blanklabel.innerHTML;
    PresIllCodHdr.innerHTML=blanklabel.innerHTML;
    PresIllCod.innerHTML=blanklabel.innerHTML;
    SwiPresIll.innerHTML=blanklabel.innerHTML;
    LongLine.innerHTML=blanklabel.innerHTML;
    OESMBSitems.innerHTML=blanklabel.innerHTML;
    OESHeadings.innerHTML=blanklabel.innerHTML;
    OESServices.innerHTML=blanklabel.innerHTML;
  }
}
function displayWardDiet() {
  if (document.UpdateForm.ptcndwdc.value=="1") {
    warddietcodetitleDIV.innerHTML=warddietcodetitleSPAN.innerHTML;
    warddietcodeDIV.innerHTML=warddietcodeSPAN.innerHTML;
    dietcommenttitleDIV.innerHTML=dietcommenttitleSPAN.innerHTML;
    dietcommentfieldDIV.innerHTML=dietcommentfieldSPAN.innerHTML;
  }
}
function defaultDisasterCode() {
  if (document.UpdateForm.ptcnudpd.value!="1") {return;}

  disastercodetitleDIV.innerHTML=disastercodetitleSPAN.innerHTML;

  if (!isWhitespace(document.UpdateForm.disacode.value)) {
    disastercodeDIV.innerHTML=disastercodeSPAN2.innerHTML;
  } else {
    disastercodeDIV.innerHTML=disastercodeSPAN1.innerHTML;
  }
  displayDisasterID();

}
function checkBedStatus(wardcode,beddcode) {
  admissno=PatientLinks.admissno.value.replace(/ /g,"+")
  ReturnFunction="" ;
  var admisdte="";
  var staydays="0";
  var admistme="";
  var ptrgm001="";
  var ptrgm002="";
  var ptrgm003="";
  var prnxindi="";
  for (var i=2; i < checkBedStatus.arguments.length; i++) {
   if (typeof(checkBedStatus.arguments[i]) == 'function') {
     ReturnFunction=checkBedStatus.arguments[i] } }

  // Receive optional parameters
  if (checkBedStatus.arguments.length >= 9) {
    admisdte=checkBedStatus.arguments[2].replace(/ /g,"+");
    staydays=checkBedStatus.arguments[3].replace(/ /g,"+");
    admistme=checkBedStatus.arguments[4].replace(/ /g,"+");
    ptrgm001=checkBedStatus.arguments[5].replace(/ /g,"+");
    ptrgm002=checkBedStatus.arguments[6].replace(/ /g,"+");
    ptrgm003=checkBedStatus.arguments[7].replace(/ /g,"+");
    prnxindi="0";
  }
  var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=1" +
                  "&wardcode="+wardcode.replace(/ /g,"+") +
                  "&beddcode="+beddcode.replace(/ /g,"+") +
                  "&admissno="+admissno.replace(/ /g,"+") +
                  "&admisdte="+admisdte.replace(/ /g,"+") +
                  "&admistme="+admistme.replace(/ /g,"+") +
                  "&staydays="+staydays.replace(/ /g,"+");
  var returnValue = RSExecute(serverURL);
  if (returnValue.status==0) {

    if (isWhitespace(document.UpdateForm.ptmis068.value)) {
      if (typeof(ReturnFunction) == 'function') {
        ReturnFunction()
        return;
      }
    }

    if (isWhitespace(document.UpdateForm.ptmis076.value)) {
      if (typeof(ReturnFunction) == 'function') {
        ReturnFunction()
        return;
      }
    }

    if (UpdateForm.pswdindc.value==0) {
      var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=5" +
                      "&wardcode="+wardcode.replace(/ /g,"+") +
                      "&beddcode="+beddcode.replace(/ /g,"+") +
                      "&admissno="+admissno.replace(/ /g,"+") +
                      "&admisdte="+admisdte.replace(/ /g,"+") +
                      "&staydays="+staydays.replace(/ /g,"+") +
                      "&admistme="+admistme.replace(/ /g,"+") +
                      "&ptrgm001="+ptrgm001.replace(/ /g,"+") +
                      "&ptrgm002="+ptrgm002.replace(/ /g,"+") +
                      "&ptrgm003="+ptrgm003.replace(/ /g,"+") +
                      "&prnxindi="+prnxindi.replace(/ /g,"+")
      var returnValue = RSExecute(serverURL);
      if (returnValue.status==0) {
        if (returnValue.return_value==1) {
          if (!confirm("Warning: Pre-Adm/Admission will override a previous bed managment record.")) {
            return;
          }
        }
        prevretval=returnValue.return_value;
        prnxindi="1";
        var serverURL = "../cgi-bin/patweb96.pbl?reportno=12&remoteno=5" +
                        "&wardcode="+wardcode.replace(/ /g,"+") +
                        "&beddcode="+beddcode.replace(/ /g,"+") +
                        "&admissno="+admissno.replace(/ /g,"+") +
                        "&admisdte="+admisdte.replace(/ /g,"+") +
                        "&staydays="+staydays.replace(/ /g,"+") +
                        "&admistme="+admistme.replace(/ /g,"+") +
                        "&ptrgm001="+ptrgm001.replace(/ /g,"+") +
                        "&ptrgm002="+ptrgm002.replace(/ /g,"+") +
                        "&ptrgm003="+ptrgm003.replace(/ /g,"+") +
                        "&prnxindi="+prnxindi.replace(/ /g,"+")
        var returnValue = RSExecute(serverURL);
        if (returnValue.status==0) {
          if (returnValue.return_value==1) {
            if (!confirm("Warning: Pre-Adm/Adm will override a following bed managment record.")) {
              return;
            }
          }

          if (prevretval==1 || returnValue.return_value==1) {
            UpdateForm.pswdindc.value="1";
            PasswordHead.innerHTML=passwordhd.innerHTML;
            PasswordCode.innerHTML=passwordcd.innerHTML;
            UserNameHead.innerHTML=usernamehd.innerHTML;
            UserNameCode.innerHTML=usernamcd.innerHTML;
            return;
          }
          if (typeof(ReturnFunction) == 'function') {
            ReturnFunction()
          }
        }
      }
    } else {
      if (typeof(ReturnFunction) == 'function') {
        ReturnFunction()
      }
    }
  }
}
function SubmitAdm() {
  MandatoryOk=true;
  if (!validateMandatory(document.UpdateForm)) {
     return; 
  }

  if (document.UpdateForm.admitbox.value==1) {
    dateDiff=parseInt(SetDateYYYYMMDD(document.UpdateForm.ptmis001.value)) -
             parseInt(DemConDate);
    if (checkDemographicsUpdated(dateDiff,NoDayDemVl,ConfDemogs)){
      return;
    }
  }

  if (document.UpdateForm.oecchbox.checked==true) {
    if (!validateOECRequired(document.UpdateForm)) {
       return;
    }
    if (!validateParticipant(document.UpdateForm.ptmis013.value,"OEC")) {
       return;
    }
  }

  if (!isWhitespace(UpdateForm.ptmis013.value)) {
     if (!validateHFT(20,UpdateForm.ptmis013,UpdateForm.ptmis014,
                         UpdateForm.funddesc,UpdateForm.tabldesc)) {
        ans=confirm("Select another active health fund table? ");
        if (ans==true) {
           return;
        } 
     } 
  }
  if (UpdateForm.oes01007!=undefined) {

    if (!chkDOS(UpdateForm.oes01007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes02007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes03007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes04007)) {
      return;
    }

    if (!chkDOS(UpdateForm.oes05007)) {
      return;
    }
  }

 if (UpdateForm.extrprov!=undefined) {

  if (!isWhitespace(UpdateForm.extrprov.value)) {
    document.UpdateForm.oeceprov.value="1";
  }

  if (!isWhitespace(UpdateForm.extrprv2.value)) {
    document.UpdateForm.oeceprv2.value="1";
  }

  if (!isWhitespace(UpdateForm.extrprv3.value)) {
    document.UpdateForm.oeceprv3.value="1";
  }

  if (!isWhitespace(UpdateForm.extrprv4.value)) {
    document.UpdateForm.oeceprv4.value="1";
  }

  if (!isWhitespace(UpdateForm.extrprv5.value)) {
    document.UpdateForm.oeceprv5.value="1";
  }
 }
  if(document.UpdateForm.mvmedre1.checked == true) {
     document.UpdateForm.mvmedrec.value="1";
  } else {
     document.UpdateForm.mvmedrec.value="0";
  }

  if (document.UpdateForm.dispt001!=undefined &&
      !isWhitespace(document.UpdateForm.dispt001.value)) {
    var serverURL   = "../cgi-bin/comweb80.pbl?reportno=44" +
                    "&valdcode=" + UpdateForm.dispt001.value.replace(/ /g,"+") +
                    UpdateForm.ptmis001.value.replace(/ /g,"+");
    var returnValue = RSExecute(serverURL);
    if (returnValue.status!=0) {
      return;
    }
  }
  if(document.UpdateForm.oecchbox.checked == true) {
     document.UpdateForm.ptvis109.value="1";
  }
  if (MandatoryOk) {
    UpdHealthFund();
    setRedirect();
    validateBedRequestUpdate(UpdateForm.admissno,UpdateForm.ptmis068,
                             UpdateForm.ptmis076,UpdateForm.bedrqqry);
    WardbedreqUpdate(UpdateForm.admissno,UpdateForm.ptmis068,
                     UpdateForm.ptmis076,UpdateForm.bedrqqry);
    UpdateForm.ptmis004.value=UpdateForm.ptmis068.value;
    UpdateForm.ptmis005.value=UpdateForm.ptmis076.value;
    UpdateForm.ptmis009.disabled=false;
    UpdateForm.OKButton.disabled=true;
    SubmitHidden(UpdateForm);
    setTimeout('UpdateForm.OKButton.disabled=false',6000);
   }
}
function valDoctorUnit() {
  validateCode(31,UpdateForm.ptmis007,UpdateForm.doctnam2);
  selectOptions("30",UpdateForm.ptmis007,UpdateForm.ptmis024);
  if (!isWhitespace(document.UpdateForm.ptmis007.value)) {
    UpdateForm.ptmis024.selectedIndex=1;
  } else {
    UpdateForm.ptmis024.selectedIndex=0;
  }
}
function DisplaySel() {
  PageLocation="?reportno=1&template=4" +
               "&urnumber=" + PatientURN.replace(/ /g,"+") +
               "&admissno=" + PatientVIS.replace(/ /g,"+")
  if (top.content.location.href!=this.location.href) {
    top.content.location.href="emrweb02.pbl" + PageLocation }
for(var i=0;i<UpdateForm.ptmis009.length;i++) {
   if(trim(UpdateForm.ptmis009.options[i].value.substr(13,1))=="E"){
           UpdateForm.ptmis009.selectedIndex=i;
          }
   }
      for (var i =0 ; i < document.UpdateForm.ptmis011.length; i++) {
      if (document.UpdateForm.ptmis011.options[i].value.substr(13,1)=="E") {
         document.UpdateForm.ptmis011.selectedIndex=i 
         break;} };
   AdmitMandatory();
   for(var i=0;i<UpdateForm.ptmis068.length;i++) {
      if(UpdateForm.ptmis068.options[i].value==UpdateForm.exptward.value) {
           UpdateForm.ptmis068.selectedIndex=i;
          }
     }
}
function AdmitMandatory() {
     UpdateForm.ptmis011.className="Mandatory";  //admission type
     UpdateForm.ptmis009.className="Mandatory";  //admission source
     UpdateForm.ptvis041.className="Mandatory";  //criteria for admission
     UpdateForm.ptmis012.className="Mandatory";  //care type
     UpdateForm.ptmis068.className="Mandatory";  //ward
     UpdateForm.ptmis005.className="mandatory";  //bed
     UpdateForm.ptmis024.className="Mandatory";  //Unit
     UpdateForm.ptmis010.className="Mandatory";  //CMBS Class
     UpdateForm.ptvis046.className="Mandatory";  //Admitting Point
     UpdateForm.ptmis028.className="Mandatory";  //Diet
     UpdateForm.ptvis102.className="Mandatory";  //SOR Professional
     UpdateForm.ptvis103.className="Mandatory";  //SOR Transport
     UpdateForm.ptmis074.className="Mandatory";  //GST Applicable
     UpdateForm.ptvis093.className="Mandatory";  //Preferred Accom
     UpdateForm.ptmis064.className="Mandatory";  //Food Allergy

     var className = (UpdateForm.ptcndigp.value >= 3) ? "Mandatory" : "";
     UpdateForm.ptvis022.className = className;  //Inform GP
     if (className == "Mandatory") {
       UpdateForm.ptvis022.options[0].value = " ";
     }

     if (UpdateForm.ptmis007.className=="OECRequired") {
       UpdateForm.ptmis007.className="OECRequired Mandatory";  //Admitting Doc
     } else {
       UpdateForm.ptmis007.className="Mandatory";  //Admitting Doctor
     }

     if (UpdateForm.doctnam2.className=="OECRequired") {
       UpdateForm.doctnam2.className="OECRequired Mandatory";  //Admitting Doc
     } else {
       UpdateForm.doctnam2.className="Mandatory";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptmis027.className=="OECRequired") {
       UpdateForm.ptmis027.className="OECRequired Mandatory";  //Admitting Doc
     } else {
       UpdateForm.ptmis027.className="Mandatory";  //Admitting Doctor Desc
     }

     if (UpdateForm.ptvis043.className=="OECRequired") {
       UpdateForm.ptvis043.className="OECRequired Mandatory";  //Intended Stay
     } else {
       UpdateForm.ptvis043.className="Mandatory";  //Intended Stay
     }

  } 
function valClaimCode() {
  validateCode(41,UpdateForm.urnumber,UpdateForm.claimc);
  for (var i =0 ; i < document.UpdateForm.ptmis027.length; i++) {
    if (document.UpdateForm.claimc.value==
        trim(document.UpdateForm.ptmis027.options[i].value.substr(0,3))){
          document.UpdateForm.ptmis027.selectedIndex=i;
    }
  }
}
function defaultAdmDateTime() {
  if (!isWhitespace(document.getElementById('d_emviddat').value) &&
      !isWhitespace(document.getElementById('d_emvidtim').value)) {
    document.getElementById('ptmis001').value=
    document.getElementById('d_emviddat').value;
    document.getElementById('ptmis002').value=
    document.getElementById('d_emvidtim').value;
  } 
}
</script>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);DisplaySel();document.UpdateForm.ptmis001.focus();
              valClaimCode();valDoctorUnit();displayRegime();
              defaultDisasterCode();displayWardDiet();setHF();
              defaultAdmDateTime();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%PATWEB89.01.003";
PatientVIS="%PATWEB89.01.081";
PatientNAM="%PATWEB89.01.002";
PatientSTA="%PATWEB89.01.086.078";
PatientALT="%PATWEB89.01.084";
PatientSEX="%PATWEB89.01.019";
PatientDOB="%PATWEB89.01.020";
PatientAGE="%PATWEB89.01.021";
PatientLOC="%PATWEB89.01.083";
PatientPRI="%PATWEB89.01.086.066.1";
PatientUNT="%PATWEB89.01.066.0";
DoctorCOD="%PATWEB89.01.082.003";
DoctorNAM="%PATWEB89.01.082.002";
PatientAID="%PATWEB89.01.086.090";
PatientIND="%PATWEB89.01.086.091";
PatientCUR="%PATWEB89.01.086.092";
PatientCLC="%PATWEB89.01.086.093.1";
PatientCLH="%STANDARD.01.017.CL";
PatientHFT="%PATWEB89.01.086.094";
PatientCDM="%PATWEB89.01.086.095";
PatientVDH="%PATWEB89.01.086.099.015";
ConfDemogs="%STANDARD.01.045.PTCNCDOA";
NoDayDemVl=trim("%STANDARD.01.045.PTCNNDCD");
DemConDate=SetDateYYYYMMDD("%PATWEB89.01.085.059");
InsertPatientHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>

<form name=UpdateForm method=post action=patweb89.pbl style="margin:0">
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
<input type=hidden name=emadmiss value="%PATWEB89.01.081">
<input type=hidden name=reportno value=2>
<input type=hidden name=template value="001">
<input type=hidden name=updatety value="1">
<input type=hidden name=redirect>
<input type=hidden name=allocate value="1">
<input type=hidden name=chckname value="0">
<input type=hidden name=emradmit value="0">
<input type=hidden name=emradmis value="0">
<input type=hidden name=admitnow value="1">
<input type=hidden name=newbmand value="0">
<input type=hidden name=agebmand value="0">
<input type=hidden name=ptmas046 value="0">
<input type=hidden name=mvmedrec>
<input type=hidden name=cfinan value="%PATWEB89.01.932">
<input type=hidden name=admitbox value="1">
<input type=hidden name=exptward value="%PATWEB89.01.917">
<input type=hidden name=claimc value="">
<input type=hidden name=exstward value="%PATWEB89.01.449.1">
<input type=hidden name=dummy id=dummy> 
<input type=hidden name=bdmnindc value="1">
<input type=hidden name=pswdindc value="0">
<input type=hidden name=catmhlsa value="%STANDARD.01.025.069.190.0.2">
<input type=hidden name=mhadmflg value="0">
<input type=hidden name=disacode value="%PATWEB89.01.996">
<input type=hidden name=disadesc value="%PATWEB89.01.999.025">
<input type=hidden name=ptcnudpd value="%STANDARD.01.025.118.153.0.1">
<input type=hidden name=ipadmdat id=ipadmdat value="1">
<input type=hidden name=d_emviddat id=d_emviddat value="%PATWEB89.01.424.0">
<input type=hidden name=d_emvidtim id=d_emvidtim value="%PATWEB89.01.425">
<input type=hidden name=bedstat1 id=bedstat1>
<input type=hidden name=ptmis004>
<input type=hidden name=ptmis005 title="Bed">
<input type=hidden name=warddesc id=warddesc>
<input type=hidden name=ptvis029 id=ptvis029 value="%PATWEB89.01.232.1">
<input type=hidden name=ptvis030 id=ptvis030 value="%PATWEB89.01.233.1">
<input type=hidden name=genpprov id=genpprov value="">
<input type=hidden name=ptcndigp value="%STANDARD.01.025.124.122.0.1">
<input type=hidden name=ptcndwdc value="%STANDARD.01.025.124.148.0.1">
<input type=hidden name=updhfund value="">
<input type=hidden name=pmihfund value="%PATWEB89.01.040.0">
<input type=hidden name=pmihftab value="%PATWEB89.01.041.0">
<input type=hidden name=pmihndmm value="%PATWEB89.01.042">
<input type=hidden name=ptcnpmhf id="ptcnpmhf"
     value="%STANDARD.01.025.124.157.0.1">
<input type=hidden name=bedrqqry value="">
<input type="hidden" name="ptvis109">
<input type=hidden name=oeceprov>
<input type=hidden name=oeceprv2>
<input type=hidden name=oeceprv3>
<input type=hidden name=oeceprv4>
<input type=hidden name=oeceprv5>
<input type="hidden" name="patsurnm"
       title="Patient Surname" value="%PATWEB89.01.009">
<input type="hidden" name="patgivnm"
       title="Patient Given Name" value="%PATWEB89.01.010">
<input type="hidden" name="patntdob"
       title="Patient Date of Birth" value="%PATWEB89.01.020">
<input type=hidden name=d_pvitype value="%PATWEB89.01.205">
<input type=hidden name=d_pmbrexst value="%PATWEB89.01.999.102">
<input type=hidden name=d_pmbrewrd value="%PATWEB89.01.999.103">
<input type=hidden name=d_pmbrebed value="%PATWEB89.01.999.104">
<input type=hidden name=d_pmbrrhcp value="%PATWEB89.01.999.105">
<input type=hidden name=d_pmbrdiag value="%PATWEB89.01.999.106.0">
<input type=hidden name=d_pmbrsbed value="%PATWEB89.01.999.107.0">
<input type=hidden name=ptcnhdps id=ptcnhdps 
       value="%STANDARD.01.025.080.250.1.1">

<table width=100% border=0 cellspacing=0 cellpadding=0 >
<tr><td class=HeadingCell align=center>
    Patient Admission Details  </td>
</tr>
<tr><td>
    <table width=100% border=0 class=TableBody cellpadding=0 cellspacing=0>
     <tr> <td>&nbsp;</td><td>&nbsp;</td>
         <td align=left><b></b></td>
        <td align=left>
        <b>Patient OEC Consent</b>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <input type="checkbox" name="oecchbox" value="0" notab
           onclick='ShowOECFields();OECRequired();'>
        </td></tr>
     <tr><td class=DataLabel>Admission Date </td>
         <td><input type=text size=12 name=ptmis001 id=ptmis001 tabindex=1 
             class="Mandatory Date" title="Admission Date" 
             value="%PATWEB89.01.935">
         <img notab src="../images/DateLookup.gif" class=Icon
          onclick="DateLookupFrame(UpdateForm.ptmis001);">     
          Time 
       <input class=Mandatory type=text name=ptmis002 id=ptmis002 size=8 
          tabindex=2 value="%PATWEB89.01.936" title="Admission Time">
        <img notab src="../images/DateTimeStamp.gif" class=Icon 
          onclick="SetCurrentDateTime(null,UpdateForm.ptmis002);">
        <img notab src="../images/TimeLookup.gif" class=Icon
          onclick="TimeLookupFrame(UpdateForm.ptmis002);">
          </td>

       <td>Admitting Point</td>
       <td>
         <select name=ptvis046 tabindex=12
           title="Admitting Point" 
           onchange="defaultWard()">
           <option></option>
            %PATWEB89.01.290.2
         </select>
      </td>
      </tr>

      <tr><td class=DataLabel>%STANDARD.01.017.P </td>
          <td><select name=ptmis011 tabindex=3  
               title="%STANDARD.01.017.P ">
              <option> </option>
                 %PATWEB89.01.112.2
              </select></td>
       <td class=DataLabel>Ward / Bed </td>
         <td>
           <select name=ptmis068 id=ptmis068 tabindex=13 title="Ward">
            <option> </option>
            %PATWEB89.01.449.2
           </select>
           <input type=text name=ptmis076 id=ptmis076 readonly
             maxlength=3 size=3 title="Bed">
           <img notab src="../images/SearchIcon.gif" class=Icon
            onclick="WardBedSearchFrame(UpdateForm.ptmis068,
                                        UpdateForm.warddesc,
                                        UpdateForm.ptmis076,
                                        UpdateForm.bedstat1);">
          </td></tr>
          <tr><td class=DataLabel>Admission Source</td>
          <td><select name=ptmis009 tabindex=4 
               onchange="DisplayTrnSrc()" title="Admission Source">
               <option> </option>
               %PATWEB89.01.110.2
               </select></td>
          <td class=DataLabel>Admitting Doctor</td>
          <td><input type=text size=8 maxlength=6 name=ptmis007 id=ptmis007
              tabindex=13
              title="Admitting Doctor" value="%PATWEB89.01.566.003"
              onblur="UpCase(this);valDoctorUnit();">
              <input type=text readonly size=25 notab name=doctnam2 id=doctnam2
               title="Admitting Doctor" value="%PATWEB89.01.566.002">
              <img notab src="../images/SearchIcon.gif" class=Icon
             onclick="DoctorSearchFrame(UpdateForm.ptmis007,UpdateForm.doctnam2)">
          </td></tr>
<tr>
    <td class=DataLabel>%STANDARD.01.017.SH</td>
    <td><select name=ptvis102 tabindex=5 class=SelectBig
         title="%STANDARD.01.017.SH">
         <option></option>
          %PATWEB89.01.298.024.2
         </select></td>
    <td class=DataLabel>Unit</td>
    <td><select name=ptmis024 tabindex=14
         title="Unit">
        <option> </option>
          %PATWEB89.01.914.2
        </select>    
    </td>
    <td><div id=SpecialtyHdr></div></td> 
    <td><div id=SpecialtyDesc></div></td> 
</tr>
<tr>
    <td class=DataLabel>%STANDARD.01.017.SI</td>
    <td><select name=ptvis103 tabindex=6 class=SelectBig
         title="%STANDARD.01.017.SI">
         <option></option>
          %PATWEB89.01.298.025.2
         </select></td>
          <td class=DataLabel>Diagnosis </td>
          <td><input tabindex=15 type=text name="ptmis020" size=50 maxlength=80
               class=Mandatory>
          </td></tr>

      <tr><td><div id=TranSrcHeading></div></td>
          <td><div id=TranSrc></div></td>
          <td class=DataLabel>Provisional DRG</td>
          <td class=DataLabel>
            <input type=text name=ptmis066 id=ptmis066 size=5 maxlength=4
             tabindex=16
             onblur="validateCode(5,UpdateForm.ptmis066,UpdateForm.drgdesc1);">
            <input type=text notab readonly name=drgdesc1 id=drgdesc1
             size=35 value="">
            <img notab src="../images/SearchIcon.gif" class=Icon
             onclick="DrgSearchFrame(UpdateForm.ptmis066,UpdateForm.drgdesc1)">
          </td></tr>

      <tr><td align=left>No of days of hospitalisation</td>
          <td align=left>
            <input type=text name=ptmis031 title='No of days of hospitalisation'
             class=Integer size=5 maxlength=4 tabindex=6
             onblur="checkInteger(this,this.title);">
          </td>
          <td class=DataLabel>Admission Diet</td>
          <td>
           <select name=ptmis028 tabindex=17 title="Diet Code">
           <option> </option>
            %PATWEB89.01.127.4
            </select>
         %STANDARD.01.017.U9
         <select name=ptmis064 tabindex=17 title="%STANDARD.01.017.U9"
           onchange="setAlert();">
           <option></option>
            %PATWEB89.01.155.5
         </select></td></tr>

      <tr><td class=DataLabel>Admission Criteria</td>
          <td>
          <select name=ptvis041 tabindex=8 title="Admission Criteria">
          <option> </option>
          %PATWEB89.01.244.2
          </select>
          </td>
         <td class=DataLabel><div id=warddietcodetitleDIV></div></td>
         <td><div id=warddietcodeDIV></div></td>
      </tr>

     <tr><td class=DataLabel>Care Type</td>
          <td><select name=ptmis012 tabindex=9 title="Care Type"
               onchange="displayRegime();"> 
              <option> </option>
               %PATWEB89.01.113.2
              </select></td>
          <td class=DataLabel><div id=dietcommenttitleDIV></div></td>
          <td><div id=dietcommentfieldDIV></div></td>
  </tr>

      <tr><td class=DataLabel> Intended Stay </td>
          <td class=DataLabel>
             <select name=ptvis043 tabindex=10 title="Intended Stay">
             <option> </option>
              %PATWEB89.01.246.2
             </select>
        </td>
              <td class=DataLabel>Referring GP</td>
         <td><input type="text" size=10 maxlength=10 name=ptvis028 id=ptvis028
               tabindex=17
               value="%PATWEB89.01.231.1" title="Referring GP"
               onblur="ValidateHCP(18,0,UpdateForm.ptvis028,UpdateForm.doctnam1);">
              <input type="text" size=25 name=doctnam1 id=doctnam1 
               class=readonly notab readonly
               value="%PATWEB89.01.231.0">
              <img src="../images/SearchIcon.gif" class=Icon
                onclick="HCPSearchFrame(UpdateForm.ptvis028,UpdateForm.doctnam1,0);">
               </td>
      </tr>

       <tr><td class=DataLabel> Planned Length of Stay</td>
        <td>
        <input type=text size=5 maxlength=5 name=ptmis030 id=ptmis030
         tabindex=11 title='Planned Length of Stay'
         class=Integer onblur="checkInteger(this,this.value);">
        </td>
    <td class=DataLabel>Practice</td>
    <td><input type=text name=genpprac id=genpprac size=35 readonly
                 value="%PATWEB89.01.232.0">
          <img src="../images/SearchIcon.gif" class=Icon
            onclick="GPHCGSearchFrame(UpdateForm.ptvis028,
                                      UpdateForm.doctnam1,
                                      UpdateForm.genpprov,
                                      UpdateForm.ptvis029,
                                      UpdateForm.genpprac,
                                      UpdateForm.ptvis030)">
          <img src="../images/erase.gif" class=Icon 
            onclick="clrFields(UpdateForm.ptvis029,
                               UpdateForm.genpprac,
                               UpdateForm.ptvis030,
                               UpdateForm.genpprov);">
    </td>
       </tr>

       <tr><td class=DataLabel>Discharge Intention</td>
          <td><select name=ptvis076 tabindex=10 title="Care Type">
              <option> </option>
               %PATWEB89.01.292.2
              </select></td>
      <td class=DataLabel>Inform GP</td>
      <td>
        <select name=ptvis022 tabindex=19 title="Inform GP">
          <option value="2"> </option>
          <option value="0">No</option>
          <option value="1">Yes</option>
        </select>
        </td>
       </tr>

       <tr><td class=DataLabel>Palliative Care Status</td>
          <td><select name=ptvis077 tabindex=10 title="Care Type">
              <option> </option>
               %PATWEB89.01.293.4
              </select></td>
       <td class=DataLabel>Religious Visit</td>
       <td>
         <select name=ptmis017 tabindex=35>
          <option value="3">Unk</option>
          <option value="2">No</option>
          <option value="1">Yes</option>
         </select>
       </td>
       </tr>

       <tr><td class=DataLabel>Preferred Accommodation</td>
          <td><select name=ptvis093 tabindex=11 title="Preferred Accommodation">
              <option> </option>
               %PATWEB89.01.298.012.2
              </select></td>
        <td class=DataLabel>Research Contact</td>
        <td class=DataField><select name=ptvis084 tabindex=35>
         %PATWEB89.01.298.003.2</select></td>
       </tr>

       <tr>
       <td><div id=disastercodetitleDIV></div></td>
       <td><div id=disastercodeDIV></div></td>
       <td class=DataLabel>Research Use</td>
        <td class=DataField><select name=ptvis085 tabindex=35>
         %PATWEB89.01.298.004.2</select></td>
       </tr>

       <tr>
         <td class=DataLabel><div id=disasteridnumbertitleDIV></div></td>
         <td><div id=disasteridnumberDIV></div></td>
           <td class=DataLabel>Foundation</td>
           <td><select name=ptmis071 tabindex=21>
               <option value="0">No</option>
               <option value="1">Yes</option>
               </select></td>
       </tr>

       <tr><td class=DataLabel>&nbsp;</td>
           <td class=DataField>&nbsp;</td>
       <td class=DataLabel>Mailing List</td>
       <td>
        <select name=ptmis072 tabindex=21>
        <option value="0">No</option>
        <option value="1">Yes</option>
        </select>
        </td>
       </tr>

       <tr><td class=DataLabel>3B Days of hospitalisation</td>
	   <td><input type=text name=ptmis082 title='3B days of hospitalisation'
                size=5 maxlength=4 tabindex=12 value="%PATWEB89.01.199.015"
                class=Integer id=ptmis082
                onblur="checkInteger(this,this.title);">
           </td>
           <td class=DataLabel>Valuables Location</td>
           <td><input type="text" size=40 maxlength=40 name=ptvis020
                tabindex=21 value="%PATWEB89.01.223"></td>
       </tr>

       <tr><td class=DataLabel>&nbsp;</td>
           <td class=DataField>&nbsp;</td>
        <td class=DataLabel>Program</td>
        <td><input type=text size=8 maxlength=8 name=ptvis099 tabindex=11
         title="Program" tabindex=21 value="%PATWEB89.01.298.021.1"
          onchange="findPrgmdesc();">
          <select name=prgmcode Readonly class=readonly tabindex=166
          onchange="savePrgmcode();">
          <option> </option>
           %PATWEB89.01.298.021.2
          </select></td>
             </tr>

       <tr align=left>
         <td align=center colspan="4">
         <hr>
         </td>
       </tr>

     <tr><td class=DataLabel>%STANDARD.01.017.CL</td>
          <td><select name=ptmis027 id=ptmis027 title="%STANDARD.01.017.CL" 
               tabindex=50 onchange="setHF();">
                <option> </option>
                 %PATWEB89.01.915.2
              </select>
           </td>
         <td class=DataLabel>Casepayment</td>
        <td><select name=ptmis075 tabindex=27>
          <option> </option>
           %PATWEB89.01.197.2
          </select>
        </td>
         </tr>

      <tr><td class=DataLabel>%STANDARD.01.017.A </td>
          <td><select name=ptmis010 tabindex=51  
               title="%STANDARD.01.017.A "> 
              <option> </option>
                 %PATWEB89.01.111.4
              </select></td>
          <td class=DataLabel>Casemix Code</td>
          <td class=DataLabel>
              <input type=text name=ptmis073 id=ptmis073 size=10 maxlength=9
               tabindex=28
               onblur="validateCode(35,UpdateForm.ptmis073,UpdateForm.cmixdesc1);">
              <input type=text notab readonly name=cmixdesc1 id=cmixdesc1
               size=35 value="">
              <img notab src="../images/SearchIcon.gif" class=Icon
               onclick="CmixSearchFrame(UpdateForm.ptmis073,UpdateForm.cmixdesc1)">
          </td>

<tr>
    <td class=DataLabel>Health Fund </td>
    <td width=35%><input type=text size=6 maxlength=6 name=ptmis013
         id=ptmis013 title="Health Fund" tabindex=31
         onchange="validateCode(16,UpdateForm.ptmis013,
                                   UpdateForm.funddesc);
                   checkTableadm();" value="%PATWEB89.01.040.0">
        <input type=text size=25 maxlength=30 name=funddesc id=funddesc
         class=readonly Readonly notab value="%PATWEB89.01.040.1">
    Level
        <input name=ptmis014 id=ptmis014  size=8 maxlength=8
         tabindex=32 value="%PATWEB89.01.041.0"
         title="Level"
         onblur="validateHFT(20,
                             UpdateForm.ptmis013,
                             UpdateForm.ptmis014,
                             UpdateForm.funddesc,
                             UpdateForm.tabldesc);">
        <input type="text" size=15 maxlength=17 name=tabldesc id=tabldesc
         class=readonly Readonly notab value="%PATWEB89.01.041.1" >
        <img src="../images/SearchIcon.gif" class=Icon
         onclick="HealthFundSearchFrame(UpdateForm.ptmis013,
                                        UpdateForm.funddesc,
                                        UpdateForm.ptmis014,
                                        UpdateForm.tabldesc);">
        <img src="../images/erase.gif" class=Icon 
         onclick="clrDoc(UpdateForm.ptmis013,
                         UpdateForm.ptmis014);
                  clrDoc(UpdateForm.funddesc,UpdateForm.tabldesc);
                  checkTableadm();">
    </td>
      <td><div id=RegimeHead1></div></td>
      <td><div id=RegimeCode1></div></td></tr>


  <tr><td class=DataLabel> Member Number </td>
      <td><input type=text size=20 maxlength=19 name=ptmis015 tabindex=52
       value="%PATWEB89.01.042">
      </td>
      <td><div id=RegimeHead2></div></td>
      <td><div id=RegimeCode2></div></td></tr>

    <tr><td align=left>Move Medical Record</td>
        <td align=left>
        <input type="checkbox" name="mvmedre1" value="1" tabindex=53>
        </td>
      <td><div id=RegimeHead3></div></td>
      <td><div id=RegimeCode3></div></td></tr>

  <tr><td class=DataLabel>GST Applicable</td>
      <td><select name=ptmis074 tabindex=24>
          <option> </option>
           %PATWEB89.01.189.2
          </select>
        </td>
      <td><div id=UserNameHead></div></td>
      <td><div id=UserNameCode></div></td>

<tr><td class=DataLabel>Continuous Billing</td>
    <td><select name=ptmis081 tabindex=27>
        <option> </option>
         %PATWEB89.01.199.014.2
        </select>
    </td>

      <td><div id=PasswordHead></div></td>
      <td><div id=PasswordCode></div></td>


<!-- END HEALTH FUND STUFF -->

  <tr><td></td>
      <td></td>
      <td class=DataLabel><div id=PreExistAilHdr></div></td>
      <td><div id=PreExistAilmnt></div></td>
      </tr>

  <tr><td></td>
      <td></td>
      <td class=DataLabel><div id=EmerAdmHdr></div></td>
      <td><div id=EmerAdmssn></div></td>
      </tr>

  <tr><td></td>
      <td align=right><div id=SwiPresIll></div></td>
      <td class=DataLabel><div id=PresIllCodHdr></div></td>
      <td nowrap><div id=PresIllCod></div></td>
      </tr>

  <tr><td>&nbsp;</td></tr>

  <tr><td><div id=AddMBScodes></div></td>
  <tr><td align=center colspan="4"><div id=LongLine></div></td>
  <tr><td align=center colspan="4"><div id=OESMBSitems></div></td></tr>
  <tr><td align=center colspan="5"><div id=OESHeadings></div></td></tr>
  <tr><td align=center colspan="4"><div id=OESServices></div></td>

      <tr align=center>
       <td colspan=4 align=center><br>
       <input tabindex=54 type=button value="Ok" class="button" name=OKButton
        id=OKButton
        onclick="tempDisable(this);
                 checkBedStatus(UpdateForm.ptmis068.value,
                                UpdateForm.ptmis076.value,
                                UpdateForm.ptmis001.value,
                                UpdateForm.ptmis030.value,
                                SubmitAdm)";>
       <input tabindex=55 type=button value="Cancel" class="button"
             onclick='fnPatientLink("%PATWEB89.01.003","%PATWEB89.01.081");'>
    </table>
</td></tr>
</table>
</form>

<form name=linkForm action=patweb89.pbl method=post>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=1>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.081">
</form>

<form name=PatientLinks method=get>
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=urnumber value="%PATWEB89.01.003">
<input type=hidden name=admissno value="%PATWEB89.01.101">
<input type=hidden name=MenuType value="%PATWEB89.01.088">
<input type=hidden name=ptcnbman value="%STANDARD.01.025.112.107.0.1">
</form>

<span id=WaitingList style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Date of Referral</td>
    <td><input type=text size=12 name=ptmis058 id=ptmis058 tabindex=19 
         title="Referral Date">
         <img notab src="../images/DateLookup.gif" class=Icon
           onclick="DateLookupFrame(UpdateForm.ptmis058);"></td></tr>
<tr><td class=DataLabel>Date of 1st Spec Consult</td>
    <td><input type=text size=12 name=ptmis059 id=ptmis059 tabindex=20 
         title="Consultation Date">
         <img notab src="../images/DateLookup.gif" class=Icon
           onclick="DateLookupFrame(UpdateForm.ptmis059);"></td></tr>
</table>
</span>

<span id=BabyAge style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Admission Weight</td>
    <td><input type=text name=ptmis051 size=8 maxlength=6
         onchange="justifyRight(this);">grams</td></tr>
</table>
</span>

<span id=NewBorn style="display:none">
<table width=100% height=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=DataLabel width=37%>Gestation Period</td>
    <td><input type=text name=ptmis041 maxlength=3 size=4 tabindex=21> weeks
    </td></tr>
</table>
</span>

<span id=transferhd style="display:none">
Transfer Source
</span>

<span id=transfersrc style="display:none">
  <input type="text" size=7 maxlength=5 name=trnsfsrc id=trnsfsrc
   class=Mandatory title="Transfer Source" tabindex=5
   onchange="validateCode(9,UpdateForm.trnsfsrc,UpdateForm.trandesc);">
  <input type=text size=27 name=trandesc id=trandesc notab
   class=Readonly readonly>
  <img src="../images/SearchIcon.gif" class=Icon
   onclick="TransferSourceFrame(UpdateForm.trnsfsrc,UpdateForm.trandesc)">
</span>

<span id=transferblank style="display:none">
   <input type=hidden name=trnsfsrc>
</span>

<span id=preexisthdr style="display:none">
 <b>PEA Indicator</b>
</span>

<span id=emeradmnhdr style="display:none">
 <b>Emergency Admission</b>
</span>

<span id=presillcodhdr style="display:none">
 <b>Presenting Illness Code</b>
</span>

<span id=presillnumhdr style="display:none">
 <b>Presenting Illness Number (MBS)</b>
</span>

<span id=swipresillhdr style="display:none">
 <b>Switch to MBS Presenting Illness Number &nbsp;</b>
</span>

<span id=preexistail style="display:none">
  <select name=ptelg014 title="PEA Indicator" class="OECRequired">
  <option value="0">No</option>
  <option value="1">Yes</option>
  </select>
</span>

<span id=emeradmissn style="display:none">
  <select name=ptelg033 title="Emergency Admission" class="OECRequired">
  <option value="0">No</option>
  <option value="1">Yes</option>
  </select>
</span>

<span id=presillcod style="display:none">
  <select name=ptvis111 title="Presenting Illness" class="OECRequired">
  <option value=" "></option>
   %PATWEB89.01.298.034.2
  </select>
</span>

<span id=swipresill style="display:none">
 <b>Switch to MBS Presenting Illness Number &nbsp;</b>
 <input type="checkbox" name="presilsw" value="1" title="Presenting Illness MBS"
       onclick="switchPresIll();"> &nbsp; &nbsp;
</span>

<span id=presillnum style="display:none">
    <input type=text name=ptmis026 id=ptmis026 size=10 maxlength=9
     class="OECRequired"
     onblur='validateCode(4,UpdateForm.ptmis026,
                          UpdateForm.mbsdesc1,
                          UpdateForm.ptmis001)'>
    <input type=text notab readonly name=mbsdesc1 id=mbsdesc1 size=35
     class="OECRequired">
    <img notab src="../images/SearchIcon.gif" class=Icon
     onclick="MbsSearchFrame(UpdateForm.ptmis026,
                             UpdateForm.mbsdesc1,
                             UpdateForm.ptmis001)">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.ptmis026,UpdateForm.mbsdesc1);">
</span>

<span id=addmbscodes style="display:none">
  <tr><td class=DataLabel>Show Extra MBS Codes</td>
      <td><input type="checkbox" name="showmbsc" value="1"
       onclick="ShowOESmbs();">
      </td></tr>
</table>
</span>

<span id=oesheadings style="display:none">
<table border=0 colspan=0 width=70% cellspacing=0 cellpadding=0 >
  <tr><td width=20%><b>Date</b></td>
      <td width=12%><b>Type</b></td>
      <td width=60%><b>Item / Description</b></td>
                   <td><b>Quantity</b></td></tr>
</table>
</span>

<span id=oesservices style="display:none">
<table border=0 colspan=0 width=70% cellspacing=0 cellpadding=0 >
  <tr><td width=20% nowrap>
     <input type=text size=12 name=oes01007 id=oes01007
      class="FutureDate" title="OES Service 1 Date"
      onblur="checkDate(this,this.title);">
     <img notab src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(UpdateForm.oes01007,null);">
     <img notab src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(UpdateForm.oes01007);">
     </td>
  <input type=hidden name=oes01004 id=oes01004 value="6">
      <td width=12%><b>Misc.Item</b></td>
      <td>
    <input type=text name=oes01005 id=oes01005 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes01004,
                              document.UpdateForm.oes01005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes01005);
             mandatoryItemCode(this,document.UpdateForm.oes01007,
                                    document.UpdateForm.oes01006);
             document.UpdateForm.oes01006.value=1;
             justifyRight(document.UpdateForm.oes01006);">
    <input type=text name=d_oes01005 id=d_oes01005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes01004,
                                  document.UpdateForm.oes01005,
                                  document.UpdateForm.d_oes01005);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.oes01005,UpdateForm.d_oes01005);
              mandatoryItemCode(document.UpdateForm.oes01005,
                                document.UpdateForm.oes01007,
                                document.UpdateForm.oes01006);">
      </td>
    <td>
    <input type=text name=oes01006 id=oes01006 title="Quantity" size=5
     maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
    </td></tr>

  <tr><td>
     <input type=text size=12 name=oes02007 id=oes02007
      class="FutureDate" title="OES Service 2 Date"
      onblur="checkDate(this,this.title);">
     <img notab src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(UpdateForm.oes02007,null);">
     <img notab src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(UpdateForm.oes02007);">
     </td>
  <input type=hidden name=oes02004 id=oes02004 value="6">
      <td width=12%><b>Misc.Item</b></td>
      <td>
    <input type=text name=oes02005 id=oes02005 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes02004,
                              document.UpdateForm.oes02005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes02005);
             mandatoryItemCode(this,document.UpdateForm.oes02007,
                                    document.UpdateForm.oes02006);
             document.UpdateForm.oes02006.value=1;
             justifyRight(document.UpdateForm.oes02006);">
    <input type=text name=d_oes02005 id=d_oes02005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes02004,
                                  document.UpdateForm.oes02005,
                                  document.UpdateForm.d_oes02005);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.oes02005,UpdateForm.d_oes02005);
              mandatoryItemCode(document.UpdateForm.oes02005,
                                document.UpdateForm.oes02007,
                                document.UpdateForm.oes02006);">
    </td>
    <td>
    <input type=text name=oes02006 id=oes02006 title="Quantity"
     size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
     </td></tr>

  <tr><td>
     <input type=text size=12 name=oes03007 id=oes03007
      class="FutureDate" title="OES Service 3 Date"
      onblur="checkDate(this,this.title);">
     <img notab src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(UpdateForm.oes03007,null);">
     <img notab src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(UpdateForm.oes03007);">
     </td>
  <input type=hidden name=oes03004 id=oes03004 value="6">
      <td width=12%><b>Misc.Item</b></td>
      <td>
    <input type=text name=oes03005 id=oes03005 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes03004,
                              document.UpdateForm.oes03005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes03005);
             mandatoryItemCode(this,document.UpdateForm.oes03007,
                                    document.UpdateForm.oes03006);
             document.UpdateForm.oes03006.value=1;
             justifyRight(document.UpdateForm.oes03006);">
    <input type=text name=d_oes03005 id=d_oes03005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes03004,
                                  document.UpdateForm.oes03005,
                                  document.UpdateForm.d_oes03005);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.oes03005,UpdateForm.d_oes03005);
              mandatoryItemCode(document.UpdateForm.oes03005,
                                document.UpdateForm.oes03007,
                                document.UpdateForm.oes03006);">
   </td>
   <td>
    <input type=text name=oes03006 id=oes03006 title="Quantity"
     size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
  </td></tr>
  <tr><td>
     <input type=text size=12 name=oes04007 id=oes04007
      class="FutureDate" title="OES Service 4 Date"
      onblur="checkDate(this,this.title);">
     <img notab src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(UpdateForm.oes04007,null);">
     <img notab src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(UpdateForm.oes04007);">
     </td>
  <input type=hidden name=oes04004 id=oes04004 value="6">
      <td width=12%><b>Misc.Item</b></td>
      <td>
    <input type=text name=oes04005 id=oes04005 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes04004,
                              document.UpdateForm.oes04005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes04005);
             mandatoryItemCode(this,document.UpdateForm.oes04007,
                                    document.UpdateForm.oes04006);
             document.UpdateForm.oes04006.value=1;
             justifyRight(document.UpdateForm.oes04006);">
    <input type=text name=d_oes04005 id=d_oes04005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes04004,
                                  document.UpdateForm.oes04005,
                                  document.UpdateForm.d_oes04005);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.oes04005,UpdateForm.d_oes04005);
              mandatoryItemCode(document.UpdateForm.oes04005,
                                document.UpdateForm.oes04007,
                                document.UpdateForm.oes04006);">
   </td>
   <td>
    <input type=text name=oes04006 id=oes04006 title="Quantity"
     size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
   </td></tr>

  <tr><td>
     <input type=text size=12 name=oes05007 id=oes05007
      class="FutureDate" title="OES Service 5 Date"
      onblur="checkDate(this,this.title);">
     <img notab src="../images/DateTimeStamp.gif" class=Icon
      onclick="SetCurrentDateTime(UpdateForm.oes05007,null);">
     <img notab src="../images/DateLookup.gif" class=Icon
      onclick="DateLookupFrame(UpdateForm.oes05007);">
     </td>
  <input type=hidden name=oes05004 id=oes05004 value="6">
      <td width=12%><b>Misc.Item</b></td>
      <td>
    <input type=text name=oes05005 id=oes05005 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.oes05004,
                              document.UpdateForm.oes05005,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_oes05005);
             mandatoryItemCode(this,document.UpdateForm.oes05007,
                                    document.UpdateForm.oes05006);
             document.UpdateForm.oes05006.value=1;
             justifyRight(document.UpdateForm.oes05006);">
    <input type=text name=d_oes05005 id=d_oes05005 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.oes05004,
                                  document.UpdateForm.oes05005,
                                  document.UpdateForm.d_oes05005);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.oes05005,UpdateForm.d_oes05005);
              mandatoryItemCode(document.UpdateForm.oes05005,
                                document.UpdateForm.oes05007,
                                document.UpdateForm.oes05006);">
   </td>
   <td>
    <input type=text name=oes05006 id=oes05006 title="Quantity"
     size=5 maxlength=3
     onblur="if(checkInteger(this,this.value)){justifyRight(this);}">
                   </td></tr>
</table>
</span>

<span id=oesmbsitems style="display:none">
<table border=0 colspan=0 width=70% cellspacing=0 cellpadding=0 >
  <input type=hidden name=mbstypes id=mbstypes value="3">
  <tr><td width=20%></td>
      <td width=12%><b>MBS Item</b></td>
    <td>
    <input type=text name=extrprov id=extrprov title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.mbstypes,
                              document.UpdateForm.extrprov,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_extrprov);">
    <input type=text name=d_extrprov id=d_extrprov size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.mbstypes,
                                  document.UpdateForm.extrprov,
                                  document.UpdateForm.d_extrprov);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.extrprov,UpdateForm.d_extrprov);">
  </td></tr>
  <tr><td width=20%></td>
      <td width=12%><b>MBS Item</b></td>
    <td>
    <input type=text name=extrprv2 id=extrprv2 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.mbstypes,
                              document.UpdateForm.extrprv2,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_extrprv2);">
    <input type=text name=d_extrprv2 id=d_extrprv2 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.mbstypes,
                                  document.UpdateForm.extrprv2,
                                  document.UpdateForm.d_extrprv2);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.extrprv2,UpdateForm.d_extrprv2);">
  </td></tr>
  <tr><td width=20%></td>
      <td width=12%><b>MBS Item</b></td>
    <td>
    <input type=text name=extrprv3 id=extrprv3 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.mbstypes,
                              document.UpdateForm.extrprv3,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_extrprv3);">
    <input type=text name=d_extrprv3 id=d_extrprv3 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.mbstypes,
                                  document.UpdateForm.extrprv3,
                                  document.UpdateForm.d_extrprv3);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.extrprv3,UpdateForm.d_extrprv3);">
  </td></tr>
  <tr><td width=20%></td>
      <td width=12%><b>MBS Item</b></td>
    <td>
    <input type=text name=extrprv4 id=extrprv4 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.mbstypes,
                              document.UpdateForm.extrprv4,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_extrprv4);">
    <input type=text name=d_extrprv4 id=d_extrprv4 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.mbstypes,
                                  document.UpdateForm.extrprv4,
                                  document.UpdateForm.d_extrprv4);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.extrprv4,UpdateForm.d_extrprv4);">
  </td></tr>
  <tr><td width=20%></td>
      <td width=12%><b>MBS Item</b></td>
    <td>
    <input type=text name=extrprv5 id=extrprv5 title="Item Code"
     size=10 maxlength=10
     onblur="validateItemCode(document.UpdateForm.mbstypes,
                              document.UpdateForm.extrprv5,
                              document.UpdateForm.ptmis027,
                              document.UpdateForm.ptmis013,
                              document.UpdateForm.ptmis014,
                              document.UpdateForm.d_extrprv5);">
    <input type=text name=d_extrprv5 id=d_extrprv5 size=50 readonly
     class=Readonly tabindex=-1 title="Item Description">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="ItemCodeSearchFrame(document.UpdateForm.mbstypes,
                                  document.UpdateForm.extrprv5,
                                  document.UpdateForm.d_extrprv5);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.extrprv5,UpdateForm.d_extrprv5);">
    </td></tr>
    <tr><td align=center colspan="4"><hr width=100%></td></tr>

</table>
</span>

<span id=longline style="display:none"><hr></span>
<span id=blanklabel style="display:none">&nbsp;</span>

<span id=showSpecialtyHdr style="display:none">
Bed Req Inpatient Specialty
</span>
<span id=showSpecialtyDesc style="display:none">
  <input type="text" name=pmbrsbed size=20 class=readonly Readonly 
         title="Bed Req Inpatient Specialty" value="";>
</span>
</span>
<span id=showSpecialtyBlank style="display:none">
</span>

<script type="text/javascript">
  var p = document.UpdateForm;
  var informGP = "%PATWEB89.01.225.0";               //ptvis022
  valInformGP(p.ptvis022,informGP.value,p.ptcndigp.value);


  MergePsy="%PATWEB89.01.050"
  if(MergePsy=="Yes"){
    document.UpdateForm.ptmas046.value="1"
  }
  if(MergePsy=="No "){
    document.UpdateForm.ptmas046.value="0"
  }
  if ("%PATWEB89.01.903" == "1") {
    alert("Warning: Patient has a Waiting List Procedure");
  }
  if ("%PATWEB89.01.904" == "1") {
    alert("Warning: Patient has a Booking");
  }
  if ("%PATWEB89.01.905" == "1") {
    alert("Warning: Patient is currently admitted");
  }
  if ("%PATWEB89.01.908" == "1") {
    alert("Warning: Patient has a pre-admission record");
  }
  if(!isWhitespace(document.UpdateForm.ptmis001.value)) {
    Day=document.UpdateForm.ptmis001.value.substr(0,2).replace(/ /g,"0")
    Dat=document.UpdateForm.ptmis001.value.substr(2)
    document.UpdateForm.ptmis001.value=Day + Dat
  }
  document.UpdateForm.ptvis084.selectedIndex=2;
  document.UpdateForm.ptvis085.selectedIndex=2;

  for (var i=0 ; i < p.ptvis046.length; i++) {
    ind1 = p.ptvis046.options[i].value.substr(3,1);
    if (ind1 == "E") {
      p.ptvis046.selectedIndex = i;
      break;
    }
  }
// Emergency & Bed Request exists
  if (p.d_pvitype.value == 1 && p.d_pmbrexst.value == 1) {
    for (var i=0 ; i < p.ptmis068.length; i++) {
      if (p.ptmis068.options[i].value == p.d_pmbrewrd.value) {
        p.ptmis068.selectedIndex = i;
      }
    }
    p.ptmis076.value = p.d_pmbrebed.value;
    if (!isWhitespace(p.d_pmbrrhcp.value)) {
      p.ptmis007.value = p.d_pmbrrhcp.value;
      valDoctorUnit();
    }
    if (!isWhitespace(p.d_pmbrdiag.value)) {
      p.ptmis020.value = p.d_pmbrdiag.value;
    }
    SpecialtyHdr.innerHTML = showSpecialtyHdr.innerHTML;
    SpecialtyDesc.innerHTML = showSpecialtyDesc.innerHTML;
    p.pmbrsbed.value = p.d_pmbrsbed.value
  }
  else {
    SpecialtyHdr.innerHTML = showSpecialtyBlank.innerHTML;
    SpecialtyDesc.innerHTML = showSpecialtyBlank.innerHTML;
  }


</script>

<span id=regimehd1 style="display:none">
<td class=DataLabel>Regime Code 1</td>
</span>
<span id=regimecod1 style="display:none">
<td><input type="text" size=15 maxlength=10
     name=ptrgm001 id=ptrgm001 tabindex=53
     onblur="validateCode(75,UpdateForm.ptrgm001,UpdateForm.dummy);"
     value="%PATWEB89.01.973. 1">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(UpdateForm.ptrgm001,UpdateForm.dummy);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.ptrgm001,UpdateForm.dummy);">
</td>
</span>

<span id=regimehd2 style="display:none">
<td class=DataLabel>Regime Code 2</td>
</span>
<span id=regimecod2 style="display:none">
<td><input type="text" size=15 maxlength=10
     name=ptrgm002 id=ptrgm002 tabindex=53
     onblur="validateCode(75,UpdateForm.ptrgm002,UpdateForm.dummy);"
     value="%PATWEB89.01.973. 2">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(UpdateForm.ptrgm002,UpdateForm.dummy);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.ptrgm002,UpdateForm.dummy);">
</td>
</span>

<span id=regimehd3 style="display:none">
<td class=DataLabel>Regime Code 3</td>
</span>
<span id=regimecod3 style="display:none">
<td><input type="text" size=15 maxlength=10
     name=ptrgm003 id=ptrgm003 tabindex=53
     onblur="validateCode(75,UpdateForm.ptrgm003,UpdateForm.dummy);"
     value="%PATWEB89.01.973. 3">
    <img src="../images/SearchIcon.gif" class=Icon
     onclick="RegimeSearchFrame(UpdateForm.ptrgm003,UpdateForm.dummy);">
    <img src="../images/erase.gif" class=Icon
     onclick="clrFields(UpdateForm.ptrgm003,UpdateForm.dummy);">
</td>
</span>

<span id=regimeblank1 style="display:none">
<td><input type=hidden name=ptrgm001 value=""></td>
</span>

<span id=regimeblank2 style="display:none">
<td><input type=hidden name=ptrgm002 value=""></td>
</span>

<span id=regimeblank3 style="display:none">
<td><input type=hidden name=ptrgm003 value=""></td>
</span>

<span id=usernamehd style="display:none">
<td class=DataLabel>User Name</td>
</span>

<span id=usernamcd style="display:none">
<td><input size=12 type=text name=username class=Mandatory title="UserName">
</td>
</span>

<span id=passwordhd style="display:none">
<td class=DataLabel>Password</td>
</span>

<span id=passwordcd style="display:none">
<td><input size=12 type=Password name=password onblur="checkPass();"
     class=Mandatory title="Password"></td>
</span>

<span id=disasteridnumbertitleSPAN style="display:none">
Disaster Identification #
</span>

<span id=disasteridnumberSPAN style="display:none">
<input type="text" name=dispt002 size=20 maxlength=19
   tabindex=11 title="Disaster Identification Number">
</span>

<span id=disastercodeSPAN1 style="display:none">
<select name=dispt001 tabindex=11 title="Disaster Code"
 onchange="displayDisasterID();">
  <option></option>
  %PATWEB89.01.995
</select>
</span>

<span id=disastercodeSPAN2 style="display:none">
<input type="text" name=n_dispt001 size=30 class=Readonly readonly
  title="Disaster Code" value="%PATWEB89.01.999.025">
<input type=hidden name=dispt001 value="%PATWEB89.01.996">
</span>

  <span id=disastercodetitleSPAN style="display:none">
    Disaster Code
  </span>

<span id=warddietcodetitleSPAN style="display:none">
Ward Diet
</span>

<span id=warddietcodeSPAN style="display:none">
  <select name=dietdtyp tabindex=17 title="Ward Diet"
         onchange="">
         <option> </option>
          %PATWEB89.01.999.062.5
  </select>
</span>

<span id=dietcommenttitleSPAN style="display:none">
Diet Comment
</span>

<span id=dietcommentfieldSPAN style="display:none">
  <input type="text" name=dietcomm size=40 maxlength=40
   tabindex=17 title="Diet Comment" value="%PATWEB89.01.999.063">
</span>

