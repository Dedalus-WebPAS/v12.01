<meta name="TemplateVersion" content="V12.01.00">
<meta name="TemplateHome" content="sjog-standard">
<meta name="HelpFileName" content="NoContextSet.html">
<meta name="CrossBrowser" content="true">
<script type="text/javascript" src="../js/emrweb0201101.js"></script>
<script type="text/javascript" src="../js/EmergencyPrimaryDiagSearch.js"></script>
<script type="text/javascript">
function AdmDoctor() {
  if(document.UpdateForm.d_emvis091.checked==true) {
     document.UpdateForm.emvis091.value="1";
  } else {
     document.UpdateForm.emvis091.value="0";
  }
}
function displaySpecialistField() {
  if (document.UpdateForm.emvis051.value.substr(3,1) == "S") {
    RDMSTitleDIV.innerHTML=RDMSTitleSPAN.innerHTML;
    RDMSFieldDIV.innerHTML=RDMSFieldSPAN.innerHTML;
    ValidateHCP(18,0,UpdateForm.emvis019,UpdateForm.n_emvis019);
  } else {
    RDMSTitleDIV.innerHTML="";
    RDMSFieldDIV.innerHTML="";
  }
}
function validateEMRDiagnosis(RetFuncTrue) {
  var serverURL="../cgi-bin/emrweb08.pbl?reportno=23" +
                "&emvcd001="+UpdateForm.emvcd001.value.replace(/ /g,"+") +
                "&emvcd002="+UpdateForm.emvcd002.value.replace(/ /g,"+") +
                "&emvcd003="+UpdateForm.emvcd003.value.replace(/ /g,"+") +
       "&emvcd005="+UpdateForm.emvcd005.value.substring(0,10).replace(/ /g,"+");

  if (IEBrowser) {
    var returnValue=RSExecute(serverURL);

    if (returnValue.status==0) {
      if (returnValue.return_value==1) {
        alert("Error: Diagnosis Record already exists.");
        return false;
      }
    }

    if (typeof(RetFuncTrue) == 'function') { RetFuncTrue() }
  }
  else {
    var returnValue = RSExecuteFetch(serverURL);

    returnValue.then(
      function (returnValue) {
        returnValue = ParseFetchData(returnValue);  // parse fetch() result

        if (returnValue.status==0) {
          if (returnValue.return_value==1) {
            alert("Error: Diagnosis Record already exists.");
            return false;
          }
        }

        if (typeof(RetFuncTrue) == 'function') { RetFuncTrue() }
      }
    );
  }
}

function init()
{
  var emvistat = document.HiddenFields.DischargeComplete.value;
  if (emvistat != 2 && emvistat != 3) {
    alert('Patient is not Discharged');
    CancelButton();
    return;
  }
  document.getElementById("Diagnosis").style.display="";
  document.getElementById("Diagnosis").innerHTML =
    document.getElementById("DiagnosisSearch").innerHTML;

  if (!isWhitespace(document.HiddenFields.PrimaryDiagnosis.value)) {
    document.UpdateForm.diagnosisSearch.value =
      document.HiddenFields.PrimaryDiagnCode.value.substring(0,2);

    getDiagnosis(UpdateForm.diagnosisSearch,
                 UpdateForm.emvcd005,
                 UpdateForm.emvcd033,
                 SelectDiagList);
  }
  document.UpdateForm.brcom001.value=document.UpdateForm.dummy1.value +
                                     document.UpdateForm.dummy2.value;

  if (document.HiddenFields.DischargeComplete.value != 1)
  {
    PageLocation="?reportno=1&template=109" +
                 "&urnumber=" + PatientURN.replace(/ /g,"+") +
                 "&admissno=" + PatientVIS.replace(/ /g,"+");
    return;
  }

  if (top.content.location.href != this.location.href) 
    top.content.location.href="emrweb02.pbl" + PageLocation 

//  if (trim(UpdateForm.waittime.value) <= 240) 
//    document.UpdateForm.emvis147.value=1 
//  else
    document.getElementById('emvis147').value=0

  if (isWhitespace(document.HiddenFields.HospitalAdmission.value)) 
  {
    if (!isWhitespace(document.HiddenFields.ExpectedUnit.value)) 
    {
      if (document.UpdateForm.ptcnhdps.value=="3") //victoria
        alert('Warning : Patient must be admitted before being Discharged.');
      else 
      {
        alert('Patient must be admitted before Discharge.');
        DisableForm(document.UpdateForm);
      }
    }
  }

  if (trim(document.UpdateForm.attdtype.value.substr(14,4))=='10') 
  {
    for (var i=0; i<document.UpdateForm.emvis051.length; i++) 
    {
      ind=trim(document.UpdateForm.emvis051.options[i].value.substr(14,4));

      if (ind=='19')
        document.UpdateForm.emvis051.selectedIndex=i; 
    }

    for (var i=0; i<document.UpdateForm.emvis049.length; i++) 
    {
      ind=trim(document.UpdateForm.emvis049.options[i].value.substr(14,4));

      if (ind=='9')
        document.UpdateForm.emvis049.selectedIndex=i; 
    }
  }
  else 
  {
    if (isWhitespace(document.UpdateForm.chkdot.value)) 
    {
      alert("WARNING : Attending Doctor Not Entered")
    }
  }

  if (document.HiddenFields.ShowOutstanding.value=="1") 
  {
    var linkurl = "../cgi-bin/emrweb02.pbl?reportno=1&template=051" +
                  "&admissno=" + UpdateForm.admissno.value.replace(/ /g,"+")+
                  "&urnumber=" + UpdateForm.urnumber.value.replace(/ /g,"+");

    Left=(document.body.clientWidth-600)/2;
    DFrameLink(linkurl,0,Left,600,300);
  }
}

function SelectDiagList() {
  for (var i=0; i < document.UpdateForm.emvcd005.length; i++) {
    if (document.UpdateForm.emvcd005.options[i].value.substring(0,10)==
        document.HiddenFields.PrimaryDiagnCode.value) {
      document.UpdateForm.emvcd005.selectedIndex=i;
    }
  }

  document.UpdateForm.emvcd033.value =
    document.HiddenFields.PrimaryDiagnFtxt.value;
}

function makeMandatoryFieldsOnLoad()
{
    // mandatory fields list
    var arrayMandatoryFields = ["emvis024","emvis025","emvis026"];

    var emvis026 = document.getElementById("emvis026");
    var transferIndicator = 0;
    var transferIndex = emvis026.selectedIndex;

    var printercheckbox = document.getElementById("printcheck");
    var printerDropDown = document.getElementById("frmprint");

    if (DiagnosisRequired()) {
      arrayMandatoryFields.push("emvcd005");
      arrayMandatoryFields.push("diagnosisSearch");
    }

    if(emvis026)
    {
      transferIndicator = trim(emvis026.options[transferIndex].value.substr(14,4));

      if(transferIndicator == "4")
      {
        //when indicator is 4, set departure details to mandatory on discharge
        arrayMandatoryFields.push("emvis033");
        arrayMandatoryFields.push("emvis050");
        arrayMandatoryFields.push("emvis049");
        arrayMandatoryFields.push("emvis052"); 
        arrayMandatoryFields.push("name_emvis033n");
      
        IBA.HEA.Knox.switchAllMandatoryFieldsOn(arrayMandatoryFields);
       }
    }
}

function dischargeMandatoryFields()
{
    // mandatory fields list
    var arrayMandatoryFields = ["emvis024","emvis025","emvis026"];

    var emvis026 = document.getElementById("emvis026");
    var transferIndicator = 0;
    var transferIndex = emvis026.selectedIndex;

    var printercheckbox = document.getElementById("printcheck");
    var printerDropDown = document.getElementById("frmprint");

    var reason07 = document.getElementById("reason07");
    var reason10 = document.getElementById("reason10");
    if(reason07.className=="Mandatory") {
        arrayMandatoryFields.push("reason07");
    }
    if(reason10.className=="Mandatory") {
        arrayMandatoryFields.push("reason10");
    }

    if(emvis026)
    {
      transferIndicator = trim(emvis026.options[transferIndex].value.substr(14,4));

      if(transferIndicator == "4")
      {
        //when indicator is 4, set departure details to mandatory on discharge
        arrayMandatoryFields.push("emvis033");
        arrayMandatoryFields.push("emvis050");
        arrayMandatoryFields.push("emvis049");
        arrayMandatoryFields.push("emvis052");
      }
    }

    //printer checkbox exist on screen
    if(printercheckbox)
    {
      //is checked?
      if(printercheckbox.checked)
      {
        //make fields mandatory
        arrayMandatoryFields.push("frmprint");
        arrayMandatoryFields.push("statncod");
      }
    } 

    // Validate Diagnosis required
    if (DiagnosisRequired()) {
      arrayMandatoryFields.push("emvcd005");
      arrayMandatoryFields.push("diagnosisSearch");
    }

    // scan through all the fields and switch the mandatory fields on
    // using the arrayMandatoryFields list
    for(var i = 0; i < arrayMandatoryFields.length;i++)
    {
      if( !IBA.HEA.Knox.checkMandatory( document.getElementById( arrayMandatoryFields[i] ) ) )
      {
        IBA.HEA.Knox.switchAllMandatoryFieldsOn(arrayMandatoryFields);
        alert("Please populate all mandatory fields");
        return;
      }
    }
   
    //everything OK, convert html checkboxes to cgi
    IBA.HEA.Knox.sendCheckBoxes();
    IBA.HEA.Knox.updateDisc();
}
function checkTrans()
{
 IBA.HEA.Knox.checkTransferToSource();
 makeMandatoryFieldsOnLoad();
 deceasedIndicator = document.UpdateForm.emvis026.value.substr(3,1);
 checkDeceasedEMR(deceasedIndicator);
}
function CancelButton() {
  fnPatientLink("%EMRWEB02.01.003","%EMRWEB02.01.081");
}
function DisplayPresentComplaintAddInfo() {
  f = document.UpdateForm;
  if (f.emcprcmp.value == "1") {
    document.getElementById('PresentComplaintAddInfo').style.display = "";
  }
  else {
    document.getElementById('PresentComplaintAddInfo').style.display = "none";
  }
}
function DiagnosisRequired() {
  var depstat = document.getElementById("emvis026");  // 'Departure Status'
  var tcindc3 = depstat.value.substr(5,1);

  if (tcindc3 == "N") return false;  // Diagnosis not required

  if (isWhitespace(document.getElementById("chkdot").value)) {  // No doctor
    if (!isWhitespace(document.getElementById("chknur").value)) {  // Nurse seen
      var fd178man = document.getElementById("fd178man");  // field 178
      if (fd178man.value == "1") {  // mandatory check
        var tcindc9 = depstat.value.substr(11,1);
        if (tcindc9 == "N") return true;  // mandatory for the Nurse
      }
    }
  }
  else {  // Doctor allocated
    var fd169man = document.getElementById("fd169man");  // field 169
    if (fd169man.value == "1") {  // mandatory check
      var fd169mfd = document.getElementById("fd169mfd");  
      if (fd169mfd.value == "1") return true;  // mandatory for discharge
    }
  }

  return false;
}
</script>
<style type="text/css" >
input.checkbox{margin-left:-4px;}
</style>
</head>
%START.OF.PAGE
<body onload="PageLoad(event);IBA.HEA.Knox.validateCheckBoxes();
              IBA.HEA.Knox.checkLMOName();
              IBA.HEA.Knox.checkTransferToSource();
              displaySpecialistField();
              makeMandatoryFieldsOnLoad();
              DisplayPresentComplaintAddInfo();">
<div id=PatientHeading></div>
<script type="text/javascript">
PatientURN="%EMRWEB02.01.003";
PatientVIS="%EMRWEB02.01.081";
PatientNAM="%EMRWEB02.01.002";
PatientSTA="%EMRWEB02.01.086.078";
PatientALT="%EMRWEB02.01.084";
PatientSEX="%EMRWEB02.01.019";
PatientDOB="%EMRWEB02.01.020";
PatientAGE="%EMRWEB02.01.021";
PatientLOC="%EMRWEB02.01.083";
PatientPRI="%EMRWEB02.01.086.066.1";
PatientUNT="%EMRWEB02.01.066.0";
PatientIND="%EMRWEB02.01.086.091";
GpCOD="%EMRWEB02.01.086.084.001";
GpNAM="%EMRWEB02.01.086.084.081";
GpPRAC="%EMRWEB02.01.086.085.001";
GpPRACCNT="%EMRWEB02.01.086.085.002";
GpPRACNAM="%EMRWEB02.01.086.085.005";
PatientARR="%EMRWEB02.01.101.0 %EMRWEB02.01.102";
PatientSEE="%EMRWEB02.01.199.008";
PatientTRI="%EMRWEB02.01.103.3";
PatientECLC="%EMRWEB02.01.484.1";
PatientCLH="%STANDARD.01.017.CL";
PatientEHFT="%EMRWEB02.01.485";
LMO_code="%EMRWEB02.01.659";
LMO_desc="%EMRWEB02.01.684.004";
InsertEmergencyHeader()
</script>
<div id=PatientMenu></div>
<div id=PageBodySection>
<table width=100% border=0 cellspacing=0 cellpadding=0>
<tr><td class=HeadingCell align=center>
    Emergency Patient Discharge </td></tr>
</table>
<form name=UpdateForm action=emrweb02.pbl method=post style="margin:0">
<input type=hidden name=reportno value="01">
<input type=hidden name=template value="101">
<input type=hidden name=formactn>
<input type=hidden name=updttype>
<input type=hidden name=emvis133>
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=updateky value="%EMRWEB02.01.404">
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=emvis118 value="%EMRWEB02.01.003">
<input type=hidden name=nextpage value="1">
<input type=hidden name=redirect value="%EMRWEB02.01.001.emrweb01.01.001">
<input type=hidden name=chkdot id=chkdot value="%EMRWEB02.01.107.001">
<input type=hidden name=chknur id=chknur value="%EMRWEB02.01.164.1">
<input type=hidden name=dummy1
value="%EMRWEB02.01.104%EMRWEB02.01.105%EMRWEB02.01.174">
<input type=hidden name=dummy2
value="%EMRWEB02.01.175%EMRWEB02.01.176%EMRWEB02.01.177">
<input type=hidden name=waittime value="%EMRWEB02.01.701">
<input type=hidden name=loadflag >
<input type=hidden name=reloadfg value="%EMRWEB02.01.446">
<input type=hidden name=efrbedty value="%EMRWEB02.01.506">
<input type=hidden name=efrdisch value="%EMRWEB02.01.509">
<input type=hidden name=efradmis value="%EMRWEB02.01.508">
<input type=hidden name=attdtype value="%EMRWEB02.01.213.3">
<input type=hidden name=depttime value="%EMRWEB02.01.125">
<input type=hidden name=deptdate value="%EMRWEB02.01.124.0">
<input type=hidden name=ptdocsee value="%EMRWEB02.01.130.0 %EMRWEB02.01.131">
<input type=hidden name=ptnursee value="%EMRWEB02.01.128.0 %EMRWEB02.01.129">
<input type=hidden name=pmpxi067 value="%EMRWEB02.01.667.0">
<input type=hidden name=webuseid value="%STANDARD.01.008">
<input type=hidden name=mapvflag value="0">
<input type=hidden name=ptcnhdps value="%STANDARD.01.025.080.250.1.1">
<input type=hidden name=emvis116 value=" ">
<input type=hidden name=emvis134 value="%EMRWEB02.01.803">
<input type=hidden name=emvis147 id=emvis147 value=" ">
<input type=hidden name=emvis073 value=" ">
<input type=hidden name=nolabelf id=nolabelf value=" ">
<input type=hidden name=emrcl006 id=emrcl006 value="%EMRWEB02.01.806" />
<input type=hidden name=emrcl008 id=emrcl008 value="%EMRWEB02.01.808" />
<input type=hidden name=emrcl007 id=emrcl007 value="%EMRWEB02.01.807" />
<input type=hidden name=d_emrcl033 id=d_emrcl033 value="%EMRWEB02.01.833" />
<input type=hidden name=d_emrcl053 id=d_emrcl053 value="%EMRWEB02.01.853" />
<input type=hidden name=discstat value="%EMRWEB02.01.147" />
<input type=hidden name=emvis091>
<input type=hidden name=d_emvis024 value="%EMRWEB02.01.124.0">
<input type=hidden name=d_emvis025 value="%EMRWEB02.01.125">
<input type=hidden name=d_emvis026 value="%EMRWEB02.01.126.1">
<input type=hidden name=updfld01 value="">
<input type=hidden name=reasfc01 value="">
<input type=hidden name=updfld02 value="">
<input type=hidden name=reasfc02 value="">
<input type=hidden name=currdate value="%STANDARD.01.013">
<input type=hidden name=currtime value=""> 
<input type=hidden name=catmhlsa value="%STANDARD.01.025.069.190.0.2">
<input type=hidden name=d_catgAC value="%EMRWEB02.01.901.024.3">
<input type=hidden name=d_catgCC value="%EMRWEB02.01.901.013.3">
<input type=hidden name=d_actvls value="%EMRWEB02.01.902.058">
<input type=hidden name=mhdlukey value="%EMRWEB02.01.904.040">
<input type=hidden name=emcprcmp id=emcprcmp
 value="%STANDARD.01.025.122.051.1.1">
<input type=hidden name=fd169man id=fd169man value="%EMRWEB02.01.599.013.169.0">
<input type=hidden name=fd169mfd id=fd169mfd value="%EMRWEB02.01.599.013.169.1">
<input type=hidden name=fd178man id=fd178man value="%EMRWEB02.01.599.013.178.0">
<input type=hidden name=fd178mfd id=fd178mfd value="%EMRWEB02.01.599.013.178.1">

<table width=95% align=center border=0 cellspacing=0 cellpadding=0>
<tr valign=top><td>
<table width=100% border=0 cellspacing=0 cellpadding=2>
<tr valign=top><td class=DataLabel width=15%>Presenting Complaint </td>
    <td><input type=text name=emvis060 max=3 size=3 value="%EMRWEB02.01.220.1"
       readonly class="Readonly">
        <input type=text name=v060name value="%EMRWEB02.01.220.0" readonly 
         class="Readonly">
    </td>
    <td colspan=2>
      <textarea type=text name=brcom001 id=brcom001 wrap=hard
       cols=50 rows=6 style="overflow-y:hidden" class="Readonly"
       title="Presenting Complaint Comments">
      </textarea>
    </td>
</tr>

<tr valign=top id=PresentComplaintAddInfo>
    <td class=DataLabel></td>
    <td>&nbsp;</td>
    <td colspan=2>
      <textarea type=text name=brcom002 id=brcom002 wrap=hard
       cols=50 rows=6 class="Readonly"
       title="Presenting Complaint - Additional Information"
      >%EMRWEB02.01.955.023.0
      </textarea>
    </td>
</tr>

<tr><td class=DataLabel>Departure Date </td>
    <td><input type=text size=12 name="emvis024" id="emvis024"
         class="PastDate"  title="Departure Date" 
         onblur="ShowDeptDateReason();" value="%EMRWEB02.01.124.0">
         <img notab src=../images/DateLookup.gif class="Icon"
          onclick="DateLookupFrame(UpdateForm.emvis024);">
        <input type=text name="emvis025" id="emvis025"
         onblur="ShowDeptDateReason();"
         size=6 value="%EMRWEB02.01.125" title="Time">
        <img notab src=../images/DateTimeStamp.gif class=Icon
         onclick="SetCurrentDateTime(UpdateForm.emvis024,UpdateForm.emvis025);">
        <img notab src=../images/TimeLookup.gif class=Icon
         onclick="TimeLookupFrame(UpdateForm.emvis025);">
    </td>
    <td class=DataLabel width="136">Reason for Change</td>
    <td><select name=reason07 id=reason07
        title="Departure date/time Reason for Change" 
        disabled onchange="DeptDateReason();">
         <option></option>
         %STANDARD.01.007.FW
        </select></td>
    </tr>

<tr><td class=DataLabel width=15%>Departure Status</td>
    <td><select name="emvis026" id="emvis026" 
                onchange="checkTrans();ShowDeptStatReason();"
         title="Departure Status">
        <option>
        </option>
        %EMRWEB02.01.126.2
        </select>
    </td>
    <td class=DataLabel width="136">Reason for Change</td>
    <td><select name=reason10 id=reason10
         title="Departure status Reason for Change" 
         disabled onchange="DeptStatReason();">
         <option></option>
         %STANDARD.01.007.FW
        </select></td>
    </tr>

<tr><td class=DataLabel width=15%>ED Ready to Discharge</td>
    <td><input type="text"  title="ED Ready to Discharge Date"
         size="12" id="emvis071" name="emvis071" value="%EMRWEB02.01.231.0"/>
        <img notab src=../images/DateLookup.gif class="Icon"
         onclick="DateLookupFrame(UpdateForm.emvis071);">
        <input type="text" title="ED Ready to Discharge Time"
          size="6" id="emvis081" name="emvis081" value="%EMRWEB02.01.241"/>
        <img notab src=../images/DateTimeStamp.gif class=Icon
         onclick="SetCurrentDateTime(UpdateForm.emvis071,UpdateForm.emvis081);">
        <img notab src=../images/TimeLookup.gif class=Icon
         onclick="TimeLookupFrame(UpdateForm.emvis081);">
    </td>
    <td class=DataLabel width="136">Referred to on Departure</td>
    <td><select name="emvis051" id="emvis051" 
         onchange="displaySpecialistField();"
         title="Referred to on Departure">
        <option></option>
        %EMRWEB02.01.211.2
        </select>
    </td>
    </tr>
<tr>
  <td width=15%></td>
  <td></td>
  <td><div id=RDMSTitleDIV></div></td>
  <td><div id=RDMSFieldDIV></div></td>
</tr>

<div id=Departure></div>

<tr>
 <td class="DataLabel" width=15%>Relative Contacted</td>
 <td>
 <select name="emrcl035" id="emrcl035">
        <option></option>
        %EMRWEB02.01.850
        </select>&nbsp;Time&nbsp;
           <input type="text" name="emrcl037" id="emrcl037" 
            title="Relative Contact Time"
            size="6" value="%EMRWEB02.01.837"/>
 <img notab src=../images/DateTimeStamp.gif class=Icon
  onclick="SetCurrentDateTime(null,UpdateForm.emrcl037);">
 </td>
 <td class="DataLabel">Review Date</td> 
 <td><input type="text" title="Review Date"
      name="emrcl041" id="" size="10" value="%EMRWEB02.01.841" />
     <img notab src=../images/DateLookup.gif class="Icon"
      onclick="DateLookupFrame(UpdateForm.emrcl041);" />
     <img notab src=../images/DateTimeStamp.gif class=Icon
      onclick="SetCurrentDateTime(UpdateForm.emrcl041);" />
 </td>
</tr>
<tr>
 <td width=15%></td>
 <td><input type="text" name="emrcl036" id="emrcl036" size="40" 
      maxlength="50" value="%EMRWEB02.01.836"/></td>
 <td class="DataLabel">Review Reason</td> 
 <td><input type="text" name="emrcl042" id="emrcl042" size="45" maxlength="50" 
      value="%EMRWEB02.01.842"/></td>
</tr>
<tr>
 <td class="DataLabel" width=15%>Ring Patient</td>
 <td align="left"><input class="checkbox" type="checkbox" id="d_emrcl008" 
  name="d_emrcl008"/></td>
 <td class="DataLabel">Admitting Doctor</td>
 <td><input type="text" size=8 maxlength=6 name="emvis106"
      title="Admitting Doctor" value="%EMRWEB02.01.266.003"
      onblur="UpCase(this);
              validateCode(31,UpdateForm.emvis106,UpdateForm.n_emvis106);">
     <input type=text readonly size=20 notab name=n_emvis106
      title="Admitting Doctor" value="%EMRWEB02.01.266.002">
     <img notab src="../images/SearchIcon.gif" class="Icon"
      onclick="DoctorSearchFrame(UpdateForm.emvis106,UpdateForm.n_emvis106,
               AdmDoctor)">
     <img src="../images/erase.gif" class="Icon"
      onclick="clrFields(UpdateForm.emvis106,UpdateForm.n_emvis106);"> </td>
</tr>
<tr> <td class="DataLabel" width=15%>LMO Contacted</td>
 <td><input class="checkbox" type="checkbox" id="d_emrcl006" name="d_emrcl006"/></td>
<td width="138">Admitting Dr Contacted</td>
    <td><input type=checkbox name=d_emvis091 title="Admitting Dr Contacted"
         onclick="AdmDoctor();">
    </td>
</tr>
<tr>
 <td class="DataLabel">LMO Name</td>
 <td>
   <input type="text" name="emrcl033" id="emrcl033" size="8" readonly />
   <input type="text" name="name_emrcl033n" id="name_emrcl033n" size="20" 
    readonly  />
   <img src="../images/erase.gif" class="Icon" 
    onclick="UpdateForm.emrcl033.value='';UpdateForm.name_emrcl033n.value='';"/>
   <img src="../images/SearchIcon.gif" class="Icon" 
    onclick="DoctorSearchFrameAll(UpdateForm.emrcl033,
             UpdateForm.name_emrcl033n);"/>
 </td>
 <td>Expected Ward</td>
 <td>%EMRWEB02.01.486</td>
</tr>
<tr>
 <td></td>
 <td>
   <input type="text" size="50" name="emrcl032" id="emrcl032" 
    value="%EMRWEB02.01.832" />
 </td>
 <td class="DataLabel">Print Triage Form</td>
 <td>
  <input class="checkbox" name="printcheck" id="printcheck" type="checkbox"
   onclick="IBA.HEA.KNox.validatePrinterCheckBox();"/>
  &nbsp; <select id="statncod" name="statncod" width="20%" >
        <option></option>
        %STANDARD.01.020.  7
        </select>
</td>
</tr>
<tr>
  <td class="DataLabel">LMO Contacted Via</td>
  <td><select name="emrcl034" id="emrcl034">
       <option></option>
        %EMRWEB02.01.851.2
       </select>
</td>
    <td>Printer</td>
    <td>
       <select name="frmprint" id="frmprint" style="margin-left:25px;" >
       <option></option>
       %EMRWEB02.01.145.EMRWEB03.02
       </select>
    </td>

</tr>
<tr>
  <td width="142" class="DataLabel">Spec/Other Hosp Contacted</td>
  <td>
    <input type="checkbox" class="checkbox" id="d_emrcl007" name="d_emrcl007" />&nbsp;
    <input type="text" name="emrcl038" id="emrcl038" value="%EMRWEB02.01.838" 
     size="50" />
  </td>
  <td class=DataLabel><div id=divRefToCareLbl></div></td>
  <td><div id=divRefToCareDat></div></td>
</tr>

<tr>
  <td width="142" class="DataLabel">Spec/Other Hosp Contacted Via</td>
  <td width="352">
    <select name="emrcl039" id="emrcl039">
      <option></option>
      %EMRWEB02.01.852.2
    </select>
  Time <input type="text" name="emrcl040" id="emrcl040"
        title="Spec/Other Hosp Contacted Time" size="6"
        value="%EMRWEB02.01.840"/>
    <img src="../images/DateTimeStamp.gif" class="Icon"
     onclick="SetCurrentDateTime(null,UpdateForm.emrcl040)"/>
  </td>
  <td class=DataLabel><div id=divMHDisStatLbl></div></td>
  <td><div id=divMHDisStatDat></div></td>
</tr>

</table>

<div id=Diagnosis></div>

<table width=100% border=0 cellspacing=0 cellpadding=0>
<tr><td>&nbsp;</td></tr>
<tr><td colspan=4 align=center>
    <input type="button" value="Update" class="button" id="updbutton"
     onclick="validateEMRDiagnosis(function () {
               tempDisable(this);
               dischargeMandatoryFields();});">
    <input type=button value="Cancel" class="button"
     onclick='CancelButton();'>
</td>
</tr>
</table>
</td></tr>
</table>
</form>

<span id="ShowDeparture" name="ShowDeparture" style="display:none">
<table width=100% border=0 cellspacing=0 cellpadding="1" >
<tr>
 <td width="142" class="DataLabel">Transfer Destination </td>
 <td width="352" >

  <input type="text" size="6" name="emvis033" id="emvis033"
   title="Transfer Destination" value="%EMRWEB02.01.133.1" 
   onchange="validateCode(9,this,UpdateForm.name_emvis033n);" />&nbsp;

  <input type="text" size="20" name="name_emvis033n" id="name_emvis033n" 
   readonly
   value="%EMRWEB02.01.133.0"/>&nbsp;

  <img src="../images/SearchIcon.gif" class="Icon"
   onclick="TransferSourceFrame(UpdateForm.emvis033,
            UpdateForm.name_emvis033n);"/>

 </td>
 <td width="138" class="DataLabel">Reason for Transfer</td>
 <td><select name="emvis052" id="emvis052" title="Reason for Transfer">
     <option></option>
        %EMRWEB02.01.212.2
     </select>
 </td>
</tr>
<tr>
 <td class="DataLabel">Escort Source</td>
 <td><select name="emvis050" id="emvis050" title="Escort Source">
        <option></option>
        %EMRWEB02.01.210.2
        </select>
 </td>
 <td class="DataLabel">Transport Mode</td>
 <td><select class="SelectBig" name="emvis049" id="emvis049"
      onchange="IBA.HEA.Knox.checkAmbBooking();">
        <option></option>
        %EMRWEB02.01.209.2
        </select>
 </td>
</tr>
<tr>
 <td class="DataLabel">&nbsp;</td>
 <td>&nbsp;</td>
 <td class="DataLabel">Ambulance Booking Time</td>
 <td><input type="text" name=emvis087 size="8" value="%EMRWEB02.01.247"
      title="Ambulance Booking Time" onblur="checkTime(this,this.title);">
        <img notab src=../images/DateTimeStamp.gif class=Icon
         onclick="SetCurrentDateTime(null,UpdateForm.emvis087);">
        <img notab src=../images/TimeLookup.gif class=Icon
         onclick="TimeLookupFrame(UpdateForm.emvis087);">
 </td>
</tr>
</table>
</span>

<span id="ShowDepartureBlank" name="ShowDeparture" style="display:none">
<input type=hidden name="emvis033" value=" ">
<input type=hidden name="emvis049" value=" ">
<input type=hidden name="emvis050" value=" ">
<input type=hidden name="emvis052" value=" ">
<input type=hidden name="emvis087" value=" ">
</span>

<span id=ShowDiagnosis style="display:none;">
<table width=100% border=0 cellspacing=0 cellpadding=1>
<tr><td class=DataLabel width=15%>Primary Diagnosis</td>
    <td><input type=text name=d_emvcd005 title="Primary Diagnosis"
         size=72 value="%EMRWEB02.01.187" class=ReadOnly readonly>
    </tr>
<tr><td class=DataLabel width=15%>Primary Diagnosis Free Format Desc</td>
    <td><input type=text name=d_emvcd033 
         title="Primary Diagnosis Free Format Desc"
         size=72 value="%EMRWEB02.01.195" class=ReadOnly readonly>
    </tr>
</table>
</span>

<span id=DiagnosisSearch style="display:none;">
<table width=100% border=0 cellspacing=0 cellpadding=2>
<tr><td class=DataLabel width=15%>Primary Diagnosis Search</td>
    <td><input type=hidden name=emvcd001 value="%EMRWEB02.01.081">
        <input type=hidden name=emvcd002 value="005">
        <input type=hidden name=emvcd003 value="%EMRWEB02.01.197">
        <input type=hidden name=emvcd004 value="5">
        <input type=hidden name=emvcd006 value="   ">
        <input type=hidden name=emvcd031 value="1">
        <input type=hidden name=heaindic value="1">
        <input type=text name=diagnosisSearch id=diagnosisSearch class=SelectBig
         title="Primary Diagnosis Search"
         onKeyUp='getDiagnosis(this,UpdateForm.emvcd005,UpdateForm.emvcd033);' >
    <select name=emvcd005 id=emvcd005 class=SelectXlrg
     onchange="document.UpdateForm.emvcd033.value=trim(this.value.substring(9,80))+' ';">
    </select>
    </td>
</tr>
<tr>
  <td class=DataLabel width=15%>Primary Diagnosis Free Format Desc</td>
  <td><input type=text name=emvcd033 id=emvcd033 maxlength=100 size=100>
</tr>
</table>
</span>

<span id=RDMSTitleSPAN style="display:none;">
Specialist
</span>

<span id=RDMSFieldSPAN style="display:none;">
  <input type=text name=emvis019 size=10 maxlength=8
   value="%EMRWEB02.01.119.  1" title="Specialist"
   onblur="ValidateHCP(18,0,UpdateForm.emvis019,UpdateForm.n_emvis019);">
  <input type=text name=n_emvis019 size=30 readonly title="Specialist Name "
   class=Readonly>
  <img src="../images/erase.gif" class="Icon"
   onclick="UpdateForm.emvis019.value='';UpdateForm.n_emvis019.value='';"/>
  <img src="../images/SearchIcon.gif" class=Icon
   onclick="HCPSearchFrame(UpdateForm.emvis019,UpdateForm.n_emvis019,0);">
</span>

<span id=spnRefToCareLbl style="display:none;">
Referral to Further Care
</span>

<span id=spnRefToCareDat style="display:none;">
  <select name=mehds009 class="Mandatory" title="Referral to Further Care">
    <option></option>
    %EMRWEB02.01.903.010.2
  </select>
</span>

<span id=spnMHDisStatLbl style="display:none;">
MH Discharge Status
</span>

<span id=spnMHDisStatDat style="display:none;">
  <select name=mehds020 class="Mandatory" title="MH Discharge Status">
    <option></option>
    %EMRWEB02.01.903.021.2
  </select>
</span>

<form name=HiddenFields method=get style="margin:0">
<input type=hidden name=DischargeComplete value="%EMRWEB02.01.147">
<input type=hidden name=HospitalAdmission value="%EMRWEB02.01.148">
<input type=hidden name=ExpectedUnit value="%EMRWEB02.01.173.1">
<input type=hidden name=ShowOutstanding value="%EMRWEB02.01.474">
<input type=hidden name=PrimaryDiagnosis value="%EMRWEB02.01.187">
<input type=hidden name=PrimaryDiagnCode value="%EMRWEB02.01.196">
<input type=hidden name=PrimaryDiagnFtxt value="%EMRWEB02.01.195">
<input type=hidden name=PrimaryDiagnKeyw value="%EMRWEB02.01.490">
</form>

<form name=PatientLinks method=get style="margin:0">
<input type=hidden name=reportno value=1>
<input type=hidden name=template value=004>
<input type=hidden name=regexstm value=102>
<input type=hidden name=newstand value=1>
<input type=hidden name=urnumber value="%EMRWEB02.01.003">
<input type=hidden name=admissno value="%EMRWEB02.01.081">
<input type=hidden name=emrgflag value="Y">
<input type=hidden name=nextpage value="4">
<input type=hidden name=MenuType value="11">
</form>

<script type="text/javascript">
if ( document.UpdateForm.deptdate.value == "") {
  document.UpdateForm.deptdate.value="%EMRWEB02.01.233.0";
  document.UpdateForm.depttime.value="%EMRWEB02.01.243";
}

if ( document.UpdateForm.emvis134.value=="") {
  document.UpdateForm.emvis073.selectedIndex=0;
  document.UpdateForm.emvis073.className="ReadOnly";
  document.UpdateForm.emvis073.readOnly=true;
  document.UpdateForm.emvis073.disabled=true;
  document.UpdateForm.emvis083.value="";
  document.UpdateForm.emvis083.className="ReadOnly";
  document.UpdateForm.emvis083.readOnly=true;
}
if ("%EMRWEB02.01.251" == "Yes") {
   document.UpdateForm.emvis091.value="1";
} else {
   document.UpdateForm.emvis091.value="0";
}
if ("%EMRWEB02.01.251" == "Yes") {
   document.UpdateForm.d_emvis091.checked=true;
}
AdmDoctor();
setMHLSCollect();
</script>
